(self.webpackChunkcruise_car_map=self.webpackChunkcruise_car_map||[]).push([[684],{95906:function(se){"use strict";(function($,C){se.exports=C()})(this,function(){function $(ee){var fe=[];return ee.AMapUI&&fe.push(C(ee.AMapUI)),ee.Loca&&fe.push(P(ee.Loca)),Promise.all(fe)}function C(ee){return new Promise(function(fe,be){var Ie=[];if(ee.plugins)for(var Oe=0;Oe<ee.plugins.length;Oe+=1)G.AMapUI.plugins.indexOf(ee.plugins[Oe])==-1&&Ie.push(ee.plugins[Oe]);if(Z.AMapUI===D.failed)be("\u524D\u6B21\u8BF7\u6C42 AMapUI \u5931\u8D25");else if(Z.AMapUI===D.notload){Z.AMapUI=D.loading,G.AMapUI.version=ee.version||G.AMapUI.version,Oe=G.AMapUI.version;var He=document.body||document.head,st=document.createElement("script");st.type="text/javascript",st.src="https://webapi.amap.com/ui/"+Oe+"/main.js",st.onerror=function(De){Z.AMapUI=D.failed,be("\u8BF7\u6C42 AMapUI \u5931\u8D25")},st.onload=function(){if(Z.AMapUI=D.loaded,Ie.length)window.AMapUI.loadUI(Ie,function(){for(var De=0,je=Ie.length;De<je;De++){var we=Ie[De].split("/").slice(-1)[0];window.AMapUI[we]=arguments[De]}for(fe();F.AMapUI.length;)F.AMapUI.splice(0,1)[0]()});else for(fe();F.AMapUI.length;)F.AMapUI.splice(0,1)[0]()},He.appendChild(st)}else Z.AMapUI===D.loaded?ee.version&&ee.version!==G.AMapUI.version?be("\u4E0D\u5141\u8BB8\u591A\u4E2A\u7248\u672C AMapUI \u6DF7\u7528"):Ie.length?window.AMapUI.loadUI(Ie,function(){for(var De=0,je=Ie.length;De<je;De++){var we=Ie[De].split("/").slice(-1)[0];window.AMapUI[we]=arguments[De]}fe()}):fe():ee.version&&ee.version!==G.AMapUI.version?be("\u4E0D\u5141\u8BB8\u591A\u4E2A\u7248\u672C AMapUI \u6DF7\u7528"):F.AMapUI.push(function(De){De?be(De):Ie.length?window.AMapUI.loadUI(Ie,function(){for(var je=0,we=Ie.length;je<we;je++){var Te=Ie[je].split("/").slice(-1)[0];window.AMapUI[Te]=arguments[je]}fe()}):fe()})})}function P(ee){return new Promise(function(fe,be){if(Z.Loca===D.failed)be("\u524D\u6B21\u8BF7\u6C42 Loca \u5931\u8D25");else if(Z.Loca===D.notload){Z.Loca=D.loading,G.Loca.version=ee.version||G.Loca.version;var Ie=G.Loca.version,Oe=G.AMap.version.startsWith("2"),He=Ie.startsWith("2");if(Oe&&!He||!Oe&&He)be("JSAPI \u4E0E Loca \u7248\u672C\u4E0D\u5BF9\u5E94\uFF01\uFF01");else{Oe=G.key,He=document.body||document.head;var st=document.createElement("script");st.type="text/javascript",st.src="https://webapi.amap.com/loca?v="+Ie+"&key="+Oe,st.onerror=function(De){Z.Loca=D.failed,be("\u8BF7\u6C42 AMapUI \u5931\u8D25")},st.onload=function(){for(Z.Loca=D.loaded,fe();F.Loca.length;)F.Loca.splice(0,1)[0]()},He.appendChild(st)}}else Z.Loca===D.loaded?ee.version&&ee.version!==G.Loca.version?be("\u4E0D\u5141\u8BB8\u591A\u4E2A\u7248\u672C Loca \u6DF7\u7528"):fe():ee.version&&ee.version!==G.Loca.version?be("\u4E0D\u5141\u8BB8\u591A\u4E2A\u7248\u672C Loca \u6DF7\u7528"):F.Loca.push(function(De){De?be(De):be()})})}if(!window)throw Error("AMap JSAPI can only be used in Browser.");var D;(function(ee){ee.notload="notload",ee.loading="loading",ee.loaded="loaded",ee.failed="failed"})(D||(D={}));var G={key:"",AMap:{version:"1.4.15",plugins:[]},AMapUI:{version:"1.1",plugins:[]},Loca:{version:"1.3.2"}},Z={AMap:D.notload,AMapUI:D.notload,Loca:D.notload},F={AMap:[],AMapUI:[],Loca:[]},z=[],q=function(ee){typeof ee=="function"&&(Z.AMap===D.loaded?ee(window.AMap):z.push(ee))};return{load:function(ee){return new Promise(function(fe,be){if(Z.AMap==D.failed)be("");else if(Z.AMap==D.notload){var Ie=ee.key,Oe=ee.version,He=ee.plugins;Ie?(window.AMap&&location.host!=="lbs.amap.com"&&be("\u7981\u6B62\u591A\u79CDAPI\u52A0\u8F7D\u65B9\u5F0F\u6DF7\u7528"),G.key=Ie,G.AMap.version=Oe||G.AMap.version,G.AMap.plugins=He||G.AMap.plugins,Z.AMap=D.loading,Oe=document.body||document.head,window.___onAPILoaded=function(De){if(delete window.___onAPILoaded,De)Z.AMap=D.failed,be(De);else for(Z.AMap=D.loaded,$(ee).then(function(){fe(window.AMap)}).catch(be);z.length;)z.splice(0,1)[0]()},He=document.createElement("script"),He.type="text/javascript",He.src="https://webapi.amap.com/maps?callback=___onAPILoaded&v="+G.AMap.version+"&key="+Ie+"&plugin="+G.AMap.plugins.join(","),He.onerror=function(De){Z.AMap=D.failed,be(De)},Oe.appendChild(He)):be("\u8BF7\u586B\u5199key")}else if(Z.AMap==D.loaded)if(ee.key&&ee.key!==G.key)be("\u591A\u4E2A\u4E0D\u4E00\u81F4\u7684 key");else if(ee.version&&ee.version!==G.AMap.version)be("\u4E0D\u5141\u8BB8\u591A\u4E2A\u7248\u672C JSAPI \u6DF7\u7528");else{if(Ie=[],ee.plugins)for(Oe=0;Oe<ee.plugins.length;Oe+=1)G.AMap.plugins.indexOf(ee.plugins[Oe])==-1&&Ie.push(ee.plugins[Oe]);Ie.length?window.AMap.plugin(Ie,function(){$(ee).then(function(){fe(window.AMap)}).catch(be)}):$(ee).then(function(){fe(window.AMap)}).catch(be)}else if(ee.key&&ee.key!==G.key)be("\u591A\u4E2A\u4E0D\u4E00\u81F4\u7684 key");else if(ee.version&&ee.version!==G.AMap.version)be("\u4E0D\u5141\u8BB8\u591A\u4E2A\u7248\u672C JSAPI \u6DF7\u7528");else{var st=[];if(ee.plugins)for(Oe=0;Oe<ee.plugins.length;Oe+=1)G.AMap.plugins.indexOf(ee.plugins[Oe])==-1&&st.push(ee.plugins[Oe]);q(function(){st.length?window.AMap.plugin(st,function(){$(ee).then(function(){fe(window.AMap)}).catch(be)}):$(ee).then(function(){fe(window.AMap)}).catch(be)})}})},reset:function(){delete window.AMap,delete window.AMapUI,delete window.Loca,G={key:"",AMap:{version:"1.4.15",plugins:[]},AMapUI:{version:"1.1",plugins:[]},Loca:{version:"1.3.2"}},Z={AMap:D.notload,AMapUI:D.notload,Loca:D.notload},F={AMap:[],AMapUI:[],Loca:[]}}}})},1891:function(){window._iconfont_svg_string_3580659='<svg><symbol id="l7-icon-area1" viewBox="0 0 1024 1024"><path d="M796.444444 56.888889a113.777778 113.777778 0 0 1 43.064889 219.136l38.798223 466.261333a113.777778 113.777778 0 1 1-133.518223 145.237334H279.210667a113.777778 113.777778 0 1 1-60.302223-137.272889L697.856 227.555556A113.777778 113.777778 0 0 1 796.444444 56.888889z m56.888889 750.933333a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222z m-682.666666 0a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222z m577.592889-534.072889L269.198222 796.444444c4.152889 7.168 7.509333 14.791111 10.012445 22.812445h465.578666a114.119111 114.119111 0 0 1 65.479111-71.224889l-38.798222-466.261333a112.924444 112.924444 0 0 1-23.210666-7.964445zM796.444444 125.155556a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222z"  ></path></symbol><symbol id="l7-icon-area" viewBox="0 0 1024 1024"><path d="M796.444444 56.888889a113.777778 113.777778 0 0 1 43.008 219.136l38.855112 466.261333a113.777778 113.777778 0 0 1-16.497778 224.540445L853.333333 967.111111a113.777778 113.777778 0 0 1-108.544-79.644444H279.210667a113.834667 113.834667 0 0 1-100.067556 79.36L170.666667 967.111111a113.777778 113.777778 0 0 1-17.066667-226.304l30.492444-351.175111a113.777778 113.777778 0 0 1 34.986667-218.680889L227.555556 170.666667a113.777778 113.777778 0 0 1 99.896888 59.221333l355.84-71.395556a113.777778 113.777778 0 0 1 104.675556-101.262222L796.444444 56.888889z m56.888889 750.933333a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222z m-682.666666 0a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222z m526.051555-582.314666L340.650667 296.903111a113.891556 113.891556 0 0 1-88.462223 98.645333l-30.947555 355.84c27.477333 13.653333 48.64 38.115556 58.026667 67.754667h465.521777a114.119111 114.119111 0 0 1 65.536-71.168l-38.855111-466.261333a113.948444 113.948444 0 0 1-74.752-56.206222zM227.555556 238.933333a45.511111 45.511111 0 1 0 0 91.022223 45.511111 45.511111 0 0 0 0-91.022223z m568.888888-113.777777a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222z"  ></path></symbol><symbol id="l7-icon-delete" viewBox="0 0 1024 1024"><path d="M705.422222 85.333333a34.133333 34.133333 0 0 1 34.133334 34.133334V227.555556h136.533333a34.133333 34.133333 0 0 1 0 68.266666h-25.543111l-24.348445 610.076445a34.133333 34.133333 0 0 1-34.133333 32.768H231.936a34.133333 34.133333 0 0 1-34.076444-32.768L173.340444 295.822222H147.911111a34.133333 34.133333 0 1 1 0-68.266666H284.444444V119.466667a34.133333 34.133333 0 0 1 34.133334-34.133334h386.844444zM241.720889 295.822222l22.983111 574.577778h494.535111l23.04-574.577778H241.720889zM671.288889 153.6H352.711111V227.555556h318.577778V153.6z"  ></path></symbol><symbol id="l7-icon-color" viewBox="0 0 1024 1024"><path d="M512 56.888889c9.841778 0 19.626667 0.341333 29.354667 0.910222 69.176889 4.437333 119.068444 62.577778 124.302222 131.072l0.455111 9.386667c0.739556 44.600889 15.303111 84.935111 44.999111 114.631111 27.022222 27.022222 62.805333 41.528889 102.570667 44.430222l12.060444 0.568889c72.476444 1.194667 135.793778 52.451556 140.458667 124.757333 1.137778 18.261333 1.251556 36.807111 0.170667 55.637334-13.198222 233.585778-211.399111 424.220444-445.326223 428.714666L512 967.111111a455.111111 455.111111 0 0 1-455.054222-464.156444c4.551111-233.927111 195.185778-432.128 428.771555-445.326223C494.535111 57.116444 503.296 56.888889 512 56.888889z m0 68.266667a385.706667 385.706667 0 0 0-22.414222 0.625777C291.726222 136.988444 129.080889 305.948444 125.155556 504.263111c-4.152889 212.366222 163.100444 387.185778 372.508444 394.353778l13.425778 0.227555 8.533333-0.113777c198.371556-3.811556 367.331556-166.456889 378.538667-364.373334a396.174222 396.174222 0 0 0-0.170667-47.331555c-1.991111-31.232-29.127111-56.604444-67.128889-60.472889l-8.248889-0.455111-14.051555-0.682667c-56.547556-4.209778-107.406222-25.884444-145.806222-64.284444-38.855111-38.798222-60.416-90.225778-64.284445-145.749334l-0.910222-21.333333c-2.901333-38.001778-28.785778-66.048-60.302222-68.096A433.891556 433.891556 0 0 0 512 125.155556zM438.044444 682.666667a68.266667 68.266667 0 1 1 0 136.533333 68.266667 68.266667 0 0 1 0-136.533333z m-170.666666-227.555556a68.266667 68.266667 0 1 1 0 136.533333 68.266667 68.266667 0 0 1 0-136.533333z m142.222222-227.555555a68.266667 68.266667 0 1 1 0 136.533333 68.266667 68.266667 0 0 1 0-136.533333z"  ></path></symbol><symbol id="l7-icon-base-map" viewBox="0 0 1024 1024"><path d="M923.761778 115.029333A34.133333 34.133333 0 0 1 967.111111 147.911111v624.128a34.133333 34.133333 0 0 1-22.186667 32.028445l-278.755555 103.992888a34.133333 34.133333 0 0 1-23.665778 0.056889L381.724444 812.714667a34.133333 34.133333 0 0 0-23.665777 0.113777L102.968889 908.060444a34.133333 34.133333 0 0 1-45.738667-26.965333L56.888889 876.088889V251.960889a34.133333 34.133333 0 0 1 22.186667-32.028445l278.755555-103.992888a34.133333 34.133333 0 0 1 20.992-0.967112l266.183111 72.988445a34.133333 34.133333 0 0 0 18.204445 0zM403.911111 192.625778v555.576889l216.177778 79.075555V251.960889l-216.177778-59.335111z m-68.266667 4.380444L125.155556 275.569778v551.310222l210.432-78.506667V197.006222zM898.844444 192.853333l-210.545777 58.936889v575.089778l210.545777-78.563556V192.853333z"  ></path></symbol><symbol id="l7-icon-dot" viewBox="0 0 1024 1024"><path d="M341.333333 739.555556a113.777778 113.777778 0 0 1 8.533334 227.271111L341.333333 967.111111a113.777778 113.777778 0 0 1-8.533333-227.271111L341.333333 739.555556z m0 68.266666a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222zM910.222222 341.333333a113.777778 113.777778 0 0 1 8.533334 227.271111L910.222222 568.888889a113.777778 113.777778 0 0 1-8.533333-227.271111L910.222222 341.333333z m0 68.266667a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222zM227.555556 56.888889a113.777778 113.777778 0 0 1 8.533333 227.271111L227.555556 284.444444a113.777778 113.777778 0 0 1-8.533334-227.271111L227.555556 56.888889z m0 68.266667a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222z"  ></path></symbol><symbol id="l7-icon-display" viewBox="0 0 1024 1024"><path d="M512 170.666667c284.444444 0 455.111111 227.555556 455.111111 341.333333s-170.666667 341.333333-455.111111 341.333333-455.111111-227.555556-455.111111-341.333333 170.666667-341.333333 455.111111-341.333333z m0 68.266666C303.729778 238.933333 125.155556 401.237333 125.155556 512c0 110.762667 178.574222 273.066667 386.844444 273.066667s386.844444-162.304 386.844444-273.066667c0-110.762667-178.574222-273.066667-386.844444-273.066667zM512 341.333333a170.666667 170.666667 0 1 1 0 341.333334 170.666667 170.666667 0 0 1 0-341.333334z m0 68.266667a102.4 102.4 0 1 0 0 204.8 102.4 102.4 0 0 0 0-204.8z"  ></path></symbol><symbol id="l7-icon-enlarge" viewBox="0 0 1024 1024"><path d="M546.133333 147.911111l-0.056889 329.955556H876.088889a34.133333 34.133333 0 0 1 0 68.266666H546.076444v329.955556a34.133333 34.133333 0 0 1-68.266666 0V546.133333H147.911111a34.133333 34.133333 0 1 1 0-68.266666h329.898667V147.911111a34.133333 34.133333 0 0 1 68.266666 0z"  ></path></symbol><symbol id="l7-icon-export-picture" viewBox="0 0 1024 1024"><path d="M883.873684 161.684211a32.336842 32.336842 0 0 1 32.336842 32.336842v582.063158a32.336842 32.336842 0 0 1-32.336842 32.336842H86.231579a32.336842 32.336842 0 0 1-32.336842-32.336842V194.021053a32.336842 32.336842 0 0 1 32.336842-32.336842h797.642105z m-32.336842 64.673684H118.568421v517.389473h170.792421a32.175158 32.175158 0 0 1 0.431158-0.646736l3.772632-4.473264 330.320842-330.374736a32.336842 32.336842 0 0 1 38.588631-5.389474l4.473263 3.018105 184.589474 147.725474V226.357895z m-202.428631 248.131368L379.850105 743.747368H851.536842v-107.304421l-202.428631-161.953684zM323.368421 323.368421a107.789474 107.789474 0 1 1 0 215.578947 107.789474 107.789474 0 0 1 0-215.578947z m0 64.673684a43.115789 43.115789 0 1 0 0 86.231579 43.115789 43.115789 0 0 0 0-86.231579z"  ></path></symbol><symbol id="l7-icon-exit-fullscreen" viewBox="0 0 1024 1024"><path d="M841.955556 591.644444a34.133333 34.133333 0 0 1 5.518222 67.811556l-5.518222 0.455111h-133.745778l192 192.056889a34.133333 34.133333 0 0 1-38.343111 55.182222l-5.176889-2.958222-4.721778-3.982222L659.911111 708.266667V841.955556a34.133333 34.133333 0 0 1-28.615111 33.678222L625.777778 876.088889a34.133333 34.133333 0 0 1-33.678222-28.615111L591.644444 841.955556V625.777778a34.133333 34.133333 0 0 1 28.615112-33.678222L625.777778 591.644444h216.177778z m-443.733334 0a34.133333 34.133333 0 0 1 33.678222 28.615112L432.355556 625.777778v216.177778a34.133333 34.133333 0 0 1-67.811556 5.518222L364.088889 841.955556v-133.745778l-192.056889 192a34.133333 34.133333 0 0 1-52.224-43.52l3.982222-4.721778L315.847111 659.911111H182.044444a34.133333 34.133333 0 0 1-33.678222-28.615111L147.911111 625.777778a34.133333 34.133333 0 0 1 28.615111-33.678222L182.044444 591.644444H398.222222zM167.310222 119.808l4.721778 3.982222L364.088889 315.847111V182.044444a34.133333 34.133333 0 0 1 28.615111-33.678222L398.222222 147.911111a34.133333 34.133333 0 0 1 33.678222 28.615111L432.355556 182.044444V398.222222a34.133333 34.133333 0 0 1-28.615112 33.678222L398.222222 432.355556H182.044444a34.133333 34.133333 0 0 1-5.518222-67.811556L182.044444 364.088889h133.802667L123.790222 172.032a34.133333 34.133333 0 0 1 43.52-52.224z m732.899556 3.982222a34.133333 34.133333 0 0 1 3.982222 43.52l-3.982222 4.721778L708.266667 364.088889H841.955556a34.133333 34.133333 0 0 1 33.678222 28.615111L876.088889 398.222222a34.133333 34.133333 0 0 1-28.615111 33.678222L841.955556 432.355556H625.777778a34.133333 34.133333 0 0 1-33.678222-28.615112L591.644444 398.222222V182.044444a34.133333 34.133333 0 0 1 67.811556-5.518222l0.455111 5.518222v133.802667l192.056889-192.056889a34.133333 34.133333 0 0 1 48.241778 0z"  ></path></symbol><symbol id="l7-icon-line" viewBox="0 0 1024 1024"><path d="M853.333333 56.888889a113.777778 113.777778 0 0 1 8.533334 227.271111L853.333333 284.444444c-19.000889 0-36.864-4.664889-52.622222-12.856888l-529.123555 529.066666a113.777778 113.777778 0 0 1-92.387556 166.115556L170.666667 967.111111a113.777778 113.777778 0 0 1-8.533334-227.271111L170.666667 739.555556c19.000889 0 36.864 4.664889 52.622222 12.856888l529.123555-529.066666a113.777778 113.777778 0 0 1 92.387556-166.115556L853.333333 56.888889zM170.666667 807.822222a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222z m682.666666-682.666666a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222z"  ></path></symbol><symbol id="l7-icon-layer" viewBox="0 0 1024 1024"><path d="M767.089778 625.777778l180.167111 82.773333a34.133333 34.133333 0 0 1 4.892444 59.278222l-4.892444 2.730667-420.977778 193.422222a34.133333 34.133333 0 0 1-22.983111 1.991111l-5.575111-1.991111-420.977778-193.422222a34.133333 34.133333 0 0 1-4.892444-59.278222l4.892444-2.730667L256.853333 625.777778l81.749334 37.546666L172.771556 739.555556 512 895.374222 851.171556 739.555556l-165.831112-76.231112 81.749334-37.546666z m0-227.555556l180.167111 82.773334a34.133333 34.133333 0 0 1 4.892444 59.278222l-4.892444 2.730666-420.977778 193.422223a34.133333 34.133333 0 0 1-22.983111 1.991111l-5.575111-1.991111-420.977778-193.422223a34.133333 34.133333 0 0 1-4.892444-59.278222l4.892444-2.730666L256.853333 398.222222l81.749334 37.546667-165.831111 76.174222L512 667.818667l339.171556-155.875556-165.831112-76.174222L767.089778 398.222222zM497.720889 60.017778a34.133333 34.133333 0 0 1 28.558222 0l420.977778 193.422222a34.133333 34.133333 0 0 1 0 62.008889l-420.977778 193.422222a34.133333 34.133333 0 0 1-28.558222 0l-420.977778-193.422222a34.133333 34.133333 0 0 1 0-62.008889zM512 128.568889L172.771556 284.387556 512 440.263111l339.171556-155.875555L512 128.568889z"  ></path></symbol><symbol id="l7-icon-narrow" viewBox="0 0 1024 1024"><path d="M910.222222 512a34.133333 34.133333 0 0 1-34.133333 34.133333H147.911111a34.133333 34.133333 0 1 1 0-68.266666h728.177778a34.133333 34.133333 0 0 1 34.133333 34.133333z"  ></path></symbol><symbol id="l7-icon-fullscreen" viewBox="0 0 1024 1024"><path d="M645.176889 597.674667l4.721778 3.982222L841.955556 793.6l0.056888-133.688889a34.133333 34.133333 0 0 1 28.615112-33.678222L876.088889 625.777778a34.133333 34.133333 0 0 1 33.678222 28.615111L910.222222 659.911111v216.177778a34.133333 34.133333 0 0 1-28.615111 33.678222L876.088889 910.222222h-216.177778a34.133333 34.133333 0 0 1-5.518222-67.811555l5.518222-0.455111h133.745778l-192-192.056889a34.133333 34.133333 0 0 1 43.52-52.224z m-222.833778 3.982222a34.133333 34.133333 0 0 1 3.982222 43.52l-3.982222 4.721778L230.286222 841.955556H364.088889a34.133333 34.133333 0 0 1 33.678222 28.615111L398.222222 876.088889a34.133333 34.133333 0 0 1-28.615111 33.678222L364.088889 910.222222H147.911111a34.133333 34.133333 0 0 1-33.678222-28.615111L113.777778 876.088889v-216.177778a34.133333 34.133333 0 0 1 67.811555-5.518222l0.455111 5.518222-0.056888 133.745778 192.113777-192a34.133333 34.133333 0 0 1 48.241778 0zM364.088889 113.777778a34.133333 34.133333 0 0 1 5.518222 67.811555L364.088889 182.044444H230.343111l192 192.056889a34.133333 34.133333 0 0 1-43.52 52.224l-4.721778-3.982222-192.113777-192.056889L182.044444 364.088889a34.133333 34.133333 0 0 1-28.615111 33.678222L147.911111 398.222222a34.133333 34.133333 0 0 1-33.678222-28.615111L113.777778 364.088889V147.911111a34.133333 34.133333 0 0 1 28.615111-33.678222L147.911111 113.777778h216.177778z m512 0a34.133333 34.133333 0 0 1 33.678222 28.615111L910.222222 147.911111v216.177778a34.133333 34.133333 0 0 1-67.811555 5.518222L841.955556 364.088889l-0.056889-133.745778-192 192a34.133333 34.133333 0 0 1-52.224-43.52l3.982222-4.721778L793.6 182.044444H659.911111a34.133333 34.133333 0 0 1-33.678222-28.615111L625.777778 147.911111a34.133333 34.133333 0 0 1 28.615111-33.678222L659.911111 113.777778h216.177778z"  ></path></symbol><symbol id="l7-icon-hide" viewBox="0 0 1024 1024"><path d="M875.52 87.836444a34.133333 34.133333 0 0 1 7.281778 43.121778l-3.527111 5.006222-682.666667 796.444445a34.133333 34.133333 0 0 1-55.409778-39.367111l3.527111-5.006222 97.166223-113.379556C123.164444 697.969778 56.888889 582.940444 56.888889 512c0-113.777778 170.666667-341.333333 455.111111-341.333333a496.64 496.64 0 0 1 208.952889 45.112889l106.439111-124.188445a34.133333 34.133333 0 0 1 48.128-3.754667z m-38.684444 202.524445C921.031111 362.951111 967.111111 452.835556 967.111111 512c0 113.777778-170.666667 341.333333-455.111111 341.333333-50.631111 0-97.678222-7.224889-140.8-19.740444l50.232889-58.595556A417.393778 417.393778 0 0 0 512 785.066667c208.270222 0 386.844444-162.304 386.844444-273.066667 0-52.849778-40.675556-117.418667-105.813333-170.496l43.804445-51.2zM512 238.933333C303.729778 238.933333 125.155556 401.237333 125.155556 512c0 66.787556 64.853333 152.291556 162.133333 209.692444L377.173333 616.675556a170.666667 170.666667 0 0 1 217.713778-253.895112l78.620445-91.704888A432.924444 432.924444 0 0 0 512 238.933333z m166.684444 236.088889a170.666667 170.666667 0 0 1-177.664 207.303111l177.607112-207.303111zM512 409.6a102.4 102.4 0 0 0-88.746667 153.486222L548.864 416.426667A102.172444 102.172444 0 0 0 512 409.6z"  ></path></symbol><symbol id="l7-icon-rectangle" viewBox="0 0 1024 1024"><path d="M170.666667 56.888889a113.777778 113.777778 0 0 1 108.544 79.644444H853.333333a34.133333 34.133333 0 0 1 33.678223 28.615111L887.466667 170.666667v574.122666a113.777778 113.777778 0 1 1-142.677334 142.734223L170.666667 887.466667a34.133333 34.133333 0 0 1-33.678223-28.615111L136.533333 853.333333V279.210667A113.777778 113.777778 0 0 1 170.666667 56.888889z m682.666666 750.933333a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222z m-34.133333-603.022222H279.210667a114.062222 114.062222 0 0 1-74.353778 74.410667L204.8 819.2h539.989333a114.062222 114.062222 0 0 1 74.410667-74.410667V204.8zM170.666667 125.155556a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222z"  ></path></symbol><symbol id="l7-icon-ranging" viewBox="0 0 1024 1024"><path d="M723.171556 50.403556l250.424888 250.424888a31.061333 31.061333 0 0 1 0 43.918223L344.746667 973.596444a31.061333 31.061333 0 0 1-43.918223 0L50.403556 723.171556a31.061333 31.061333 0 0 1 0-43.918223L679.253333 50.403556a31.061333 31.061333 0 0 1 43.918223 0z m-21.959112 74.524444l-39.765333 39.822222 98.986667 98.872889a34.133333 34.133333 0 0 1-44.088889 51.882667l-4.209778-3.640889-98.929778-98.929778-63.886222 63.886222 62.179556 62.122667a34.133333 34.133333 0 0 1-44.088889 51.882667L563.2 387.242667 501.077333 325.063111 437.191111 388.949333l98.986667 98.929778a34.133333 34.133333 0 0 1-44.088889 51.882667l-4.209778-3.640889-98.929778-98.929778-63.886222 63.886222L387.242667 563.2a34.133333 34.133333 0 0 1-44.088889 51.882667l-4.209778-3.584-62.122667-62.179556-63.886222 63.886222 98.986667 98.929778a34.133333 34.133333 0 0 1-44.088889 51.882667l-4.209778-3.640889-98.929778-98.929778-39.765333 39.822222 197.802667 197.745778 576.284444-576.284444-197.802667-197.745778z"  ></path></symbol><symbol id="l7-icon-reposition" viewBox="0 0 1024 1024"><path d="M512 56.888889a34.133333 34.133333 0 0 1 34.133333 34.133333v24.177778A398.336 398.336 0 0 1 908.856889 477.866667h24.177778a34.133333 34.133333 0 0 1 0 68.266666h-24.177778A398.336 398.336 0 0 1 546.133333 908.856889L546.133333 932.977778a34.133333 34.133333 0 0 1-68.266666 0v-24.177778A398.336 398.336 0 0 1 115.2 546.133333L91.022222 546.133333a34.133333 34.133333 0 1 1 0-68.266666h24.177778A398.336 398.336 0 0 1 477.866667 115.2V91.022222A34.133333 34.133333 0 0 1 512 56.888889z m34.190222 126.862222L546.133333 193.422222a34.133333 34.133333 0 1 1-68.266666 0v-9.671111A330.069333 330.069333 0 0 0 183.751111 477.866667h9.671111a34.133333 34.133333 0 1 1 0 68.266666l-9.671111 0.056889A330.069333 330.069333 0 0 0 477.866667 840.248889V830.577778a34.133333 34.133333 0 0 1 68.266666 0l0.056889 9.671111A330.069333 330.069333 0 0 0 840.248889 546.133333L830.577778 546.133333a34.133333 34.133333 0 0 1 0-68.266666h9.671111A330.069333 330.069333 0 0 0 546.133333 183.751111zM512 341.333333a170.666667 170.666667 0 1 1 0 341.333334 170.666667 170.666667 0 0 1 0-341.333334z m0 68.266667a102.4 102.4 0 1 0 0 204.8 102.4 102.4 0 0 0 0-204.8z"  ></path></symbol><symbol id="l7-icon-round" viewBox="0 0 1024 1024"><path d="M512 56.888889a455.111111 455.111111 0 0 1 391.395556 687.502222 113.777778 113.777778 0 0 1-159.061334 158.890667A455.111111 455.111111 0 0 1 120.604444 279.608889 113.777778 113.777778 0 0 1 279.608889 120.604444 452.835556 452.835556 0 0 1 512 56.888889z m0 68.266667a384.910222 384.910222 0 0 0-191.715556 50.744888A113.777778 113.777778 0 0 1 175.957333 320.284444a386.844444 386.844444 0 0 0 527.815111 527.758223 113.777778 113.777778 0 0 1 144.270223-144.440889A386.844444 386.844444 0 0 0 512 125.155556z m299.406222 640.739555a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222zM212.593778 167.082667a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222z"  ></path></symbol><symbol id="l7-icon-guanbi" viewBox="0 0 1024 1024"><path d="M576 512l277.333333 277.333333-64 64-277.333333-277.333333L234.666667 853.333333 170.666667 789.333333l277.333333-277.333333L170.666667 234.666667 234.666667 170.666667l277.333333 277.333333L789.333333 170.666667 853.333333 234.666667 576 512z"  ></path></symbol></svg>',function(se){try{let fe=function(){F||(F=!0,G())},be=function(){try{Z.documentElement.doScroll("left")}catch(Ie){return void setTimeout(be,50)}fe()};var q=fe,ee=be,C=(C=document.getElementsByTagName("script"))[C.length-1],$=C.getAttribute("data-injectcss"),C=C.getAttribute("data-disable-injectsvg");if(!C){var P,D,G,Z,F,z=function(Oe,He){He.parentNode.insertBefore(Oe,He)};if($&&!se.__iconfont__svg__cssinject__){se.__iconfont__svg__cssinject__=!0;try{document.write("<style>.svgfont {display: inline-block;width: 1em;height: 1em;fill: currentColor;vertical-align: -0.1em;font-size:16px;}</style>")}catch(Ie){console&&console.log(Ie)}}P=function(){var Oe,He=document.createElement("div");He.innerHTML=se._iconfont_svg_string_3580659,(He=He.getElementsByTagName("svg")[0])&&(He.setAttribute("aria-hidden","true"),He.style.position="absolute",He.style.width=0,He.style.height=0,He.style.overflow="hidden",He=He,(Oe=document.body).firstChild?z(He,Oe.firstChild):Oe.appendChild(He))},document.addEventListener?~["complete","loaded","interactive"].indexOf(document.readyState)?setTimeout(P,0):(D=function(){document.removeEventListener("DOMContentLoaded",D,!1),P()},document.addEventListener("DOMContentLoaded",D,!1)):document.attachEvent&&(G=P,Z=se.document,F=!1,be(),Z.onreadystatechange=function(){Z.readyState=="complete"&&(Z.onreadystatechange=null,fe())})}}catch(fe){}}(window)},19945:function(se,$,C){"use strict";C.d($,{lg:function(){return y6},Ie:function(){return vg},ns:function(){return Bd},dW:function(){return mg},xs:function(){return U6}});var P={};C.r(P),C.d(P,{add:function(){return MA},adjoint:function(){return Yg},clone:function(){return Xa},copy:function(){return Iu},create:function(){return Qn},determinant:function(){return EA},equals:function(){return gu},exactEquals:function(){return Hu},frob:function(){return TA},fromQuat:function(){return fv},fromQuat2:function(){return Dp},fromRotation:function(){return If},fromRotationTranslation:function(){return SA},fromRotationTranslationScale:function(){return cv},fromRotationTranslationScaleOrigin:function(){return Ml},fromScaling:function(){return K0},fromTranslation:function(){return Yf},fromValues:function(){return X0},fromXRotation:function(){return ff},fromYRotation:function(){return hf},fromZRotation:function(){return bA},frustum:function(){return Fp},getRotation:function(){return lv},getScaling:function(){return CA},getTranslation:function(){return Np},identity:function(){return uv},invert:function(){return kp},lookAt:function(){return eh},mul:function(){return fc},multiply:function(){return Ga},multiplyScalar:function(){return Bp},multiplyScalarAndAdd:function(){return Vu},ortho:function(){return Lh},orthoNO:function(){return J0},orthoZO:function(){return Ph},perspective:function(){return Xf},perspectiveFromFieldOfView:function(){return Ih},perspectiveNO:function(){return hv},perspectiveZO:function(){return Mh},rotate:function(){return Xl},rotateX:function(){return cc},rotateY:function(){return Q0},rotateZ:function(){return q0},scale:function(){return So},set:function(){return xA},str:function(){return wA},sub:function(){return LA},subtract:function(){return IA},targetTo:function(){return Oh},translate:function(){return qs},transpose:function(){return Th}});var D={};C.r(D),C.d(D,{add:function(){return Xb},angle:function(){return cg},bezier:function(){return oS},ceil:function(){return Qb},clone:function(){return $b},copy:function(){return Wb},create:function(){return oA},cross:function(){return e1},dist:function(){return yS},distance:function(){return Xy},div:function(){return mS},divide:function(){return Yy},dot:function(){return Jy},equals:function(){return vS},exactEquals:function(){return dS},floor:function(){return qb},forEach:function(){return bS},fromValues:function(){return Lu},hermite:function(){return aS},inverse:function(){return nS},len:function(){return xS},length:function(){return Hy},lerp:function(){return iS},max:function(){return Jb},min:function(){return Kb},mul:function(){return gS},multiply:function(){return Wy},negate:function(){return Ky},normalize:function(){return sA},random:function(){return sS},rotateX:function(){return cS},rotateY:function(){return fS},rotateZ:function(){return hS},round:function(){return eS},scale:function(){return tS},scaleAndAdd:function(){return rS},set:function(){return Yb},sqrDist:function(){return _S},sqrLen:function(){return ES},squaredDistance:function(){return Qy},squaredLength:function(){return qy},str:function(){return pS},sub:function(){return fg},subtract:function(){return $y},transformMat3:function(){return uS},transformMat4:function(){return fp},transformQuat:function(){return lS},zero:function(){return AS}});var G={},Z={},F=function(i){return Z[i]},z=function(i,t){Z[i]=t},q=function(i){return G[i]},ee=function(i,t){G[i]=t},fe={},be={},Ie=34,Oe=10,He=13;function st(e){return new Function("d","return {"+e.map(function(i,t){return JSON.stringify(i)+": d["+t+'] || ""'}).join(",")+"}")}function De(e,i){var t=st(e);return function(r,n){return i(t(r),n,e)}}function je(e){var i=Object.create(null),t=[];return e.forEach(function(r){for(var n in r)n in i||t.push(i[n]=n)}),t}function we(e,i){var t=e+"",r=t.length;return r<i?new Array(i-r+1).join(0)+t:t}function Te(e){return e<0?"-"+we(-e,6):e>9999?"+"+we(e,6):we(e,4)}function le(e){var i=e.getUTCHours(),t=e.getUTCMinutes(),r=e.getUTCSeconds(),n=e.getUTCMilliseconds();return isNaN(e)?"Invalid Date":Te(e.getUTCFullYear(),4)+"-"+we(e.getUTCMonth()+1,2)+"-"+we(e.getUTCDate(),2)+(n?"T"+we(i,2)+":"+we(t,2)+":"+we(r,2)+"."+we(n,3)+"Z":r?"T"+we(i,2)+":"+we(t,2)+":"+we(r,2)+"Z":t||i?"T"+we(i,2)+":"+we(t,2)+"Z":"")}function Re(e){var i=new RegExp('["'+e+`
\r]`),t=e.charCodeAt(0);function r(O,B){var W,he,ae=n(O,function(Se,Fe){if(W)return W(Se,Fe-1);he=Se,W=B?De(Se,B):st(Se)});return ae.columns=he||[],ae}function n(O,B){var W=[],he=O.length,ae=0,Se=0,Fe,Qe=he<=0,qe=!1;O.charCodeAt(he-1)===Oe&&--he,O.charCodeAt(he-1)===He&&--he;function yt(){if(Qe)return be;if(qe)return qe=!1,fe;var Ot,jt=ae,or;if(O.charCodeAt(jt)===Ie){for(;ae++<he&&O.charCodeAt(ae)!==Ie||O.charCodeAt(++ae)===Ie;);return(Ot=ae)>=he?Qe=!0:(or=O.charCodeAt(ae++))===Oe?qe=!0:or===He&&(qe=!0,O.charCodeAt(ae)===Oe&&++ae),O.slice(jt+1,Ot-1).replace(/""/g,'"')}for(;ae<he;){if((or=O.charCodeAt(Ot=ae++))===Oe)qe=!0;else if(or===He)qe=!0,O.charCodeAt(ae)===Oe&&++ae;else if(or!==t)continue;return O.slice(jt,Ot)}return Qe=!0,O.slice(jt,he)}for(;(Fe=yt())!==be;){for(var Et=[];Fe!==fe&&Fe!==be;)Et.push(Fe),Fe=yt();B&&(Et=B(Et,Se++))==null||W.push(Et)}return W}function a(O,B){return O.map(function(W){return B.map(function(he){return I(W[he])}).join(e)})}function u(O,B){return B==null&&(B=je(O)),[B.map(I).join(e)].concat(a(O,B)).join(`
`)}function f(O,B){return B==null&&(B=je(O)),a(O,B).join(`
`)}function g(O){return O.map(x).join(`
`)}function x(O){return O.map(I).join(e)}function I(O){return O==null?"":O instanceof Date?le(O):i.test(O+="")?'"'+O.replace(/"/g,'""')+'"':O}return{parse:r,parseRows:n,format:u,formatBody:f,formatRows:g,formatRow:x,formatValue:I}}var ye=Re(","),_e=ye.parse,ne=ye.parseRows,Y=ye.format,Le=ye.formatBody,de=ye.formatRows,Ee=ye.formatRow,ge=ye.formatValue,X=C(74710),Me=C(8014),Ae=C(94169),me=C(57338),ue=C(74809),ke=C(29161),Ze=C(69984),oe=C(4014),Dt=C(7953);function Rt(e){try{return Function.toString.call(e).indexOf("[native code]")!==-1}catch(i){return typeof e=="function"}}var cr=C(25807);function Ut(e,i,t){return(0,cr.Z)()?Ut=Reflect.construct.bind():Ut=function(n,a,u){var f=[null];f.push.apply(f,a);var g=Function.bind.apply(n,f),x=new g;return u&&(0,Dt.Z)(x,u.prototype),x},Ut.apply(null,arguments)}function $r(e){var i=typeof Map=="function"?new Map:void 0;return $r=function(r){if(r===null||!Rt(r))return r;if(typeof r!="function")throw new TypeError("Super expression must either be null or a function");if(typeof i!="undefined"){if(i.has(r))return i.get(r);i.set(r,n)}function n(){return Ut(r,arguments,(0,oe.Z)(this).constructor)}return n.prototype=Object.create(r.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),(0,Dt.Z)(n,r)},$r(e)}var ln={REGISTERED_PROTOCOLS:{}};function Sr(e){var i=Qr();return function(){var r=(0,oe.Z)(e),n;if(i){var a=(0,oe.Z)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return(0,Ze.Z)(this,n)}}function Qr(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var Jr=function(i){return ln.REGISTERED_PROTOCOLS[i.substring(0,i.indexOf("://"))]},_r=function(e){(0,ke.Z)(t,e);var i=Sr(t);function t(r,n,a,u){var f;return(0,ue.Z)(this,t),f=i.call(this,"AJAXError: ".concat(n," (").concat(r,"): ").concat(a)),f.status=r,f.statusText=n,f.url=a,f.body=u,f}return(0,me.Z)(t)}($r(Error));function Gn(e,i){var t=new XMLHttpRequest,r=Array.isArray(e.url)?e.url[0]:e.url;t.open(e.method||"GET",r,!0),e.type==="arrayBuffer"&&(t.responseType="arraybuffer");for(var n in e.headers)e.headers.hasOwnProperty(n)&&t.setRequestHeader(n,e.headers[n]);return e.type==="json"&&(t.responseType="text",t.setRequestHeader("Accept","application/json")),t.withCredentials=e.credentials==="include",t.onerror=function(){i(new Error(t.statusText))},t.onload=function(){if((t.status>=200&&t.status<300||t.status===0)&&t.response!==null){var a=t.response;if(e.type==="json")try{a=JSON.parse(t.response)}catch(f){return i(f)}i(null,a,t.getResponseHeader("Cache-Control"),t.getResponseHeader("Expires"),t)}else{var u=new Blob([t.response],{type:t.getResponseHeader("Content-Type")});i(new _r(t.status,t.statusText,r.toString(),u))}},t.cancel=t.abort,t.send(e.body),t}function ti(e){return new Promise(function(i,t){Gn(e,function(r,n,a,u,f){r?t({err:r,data:null,xhr:f}):i({err:null,data:n,cacheControl:a,expires:u,xhr:f})})})}function Vn(e,i){return Gn(e,i)}var Xr=function(i,t){var r=Jr(i.url)||Vn;return r((0,X.Z)((0,X.Z)({},i),{},{type:"json"}),t)},sn=function(i,t){var r=Jr(i.url)||Vn;return r((0,X.Z)((0,X.Z)({},i),{},{type:"arrayBuffer"}),t)},_n=function(i,t){return Vn(_objectSpread(_objectSpread({},i),{},{method:"POST"}),t)},Di=function(i,t){return Vn((0,X.Z)((0,X.Z)({},i),{},{method:"GET"}),t)};function ri(e){var i=window.document.createElement("a");return i.href=e,i.protocol===window.document.location.protocol&&i.host===window.document.location.host}var Pt="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";function J(e,i){var t=new window.Image,r=window.URL||window.webkitURL;t.crossOrigin="anonymous",t.onload=function(){i(null,t),r.revokeObjectURL(t.src),t.onload=null,window.requestAnimationFrame(function(){t.src=Pt})},t.onerror=function(){return i(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))};var n=new Blob([new Uint8Array(e)],{type:"image/png"});t.src=e.byteLength?r.createObjectURL(n):Pt}function ze(e,i){var t=new Blob([new Uint8Array(e)],{type:"image/png"});createImageBitmap(t).then(function(r){i(null,r)}).catch(function(r){i(new Error("Could not load image because of ".concat(r.message,". Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.")))})}var $e=function(i,t,r){var n=function(u,f){if(u)t(u);else if(f){var g=typeof createImageBitmap=="function",x=r?r(f):f;g?ze(x,t):J(x,t)}};return i.type==="json"?Xr(i,n):sn(i,n)},At=function(i,t){var r=typeof createImageBitmap=="function";r?ze(i,t):J(i,t)},Lt=function(e){return e.CENTER="center",e.TOP="top",e["TOP-LEFT"]="top-left",e["TOP-RIGHT"]="top-right",e.BOTTOM="bottom",e["BOTTOM-LEFT"]="bottom-left",e["BOTTOM-RIGHT"]="bottom-right",e.LEFT="left",e.RIGHT="right",e}({}),wt={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function yr(e,i,t){var r=e.classList;for(var n in wt)wt.hasOwnProperty(n)&&r.remove("l7-".concat(t,"-anchor-").concat(n));r.add("l7-".concat(t,"-anchor-").concat(i))}function vt(e,i,t){e.prototype=i.prototype=t,t.constructor=e}function Tt(e,i){var t=Object.create(e.prototype);for(var r in i)t[r]=i[r];return t}function Qt(){}var xr=.7,kr=1/xr,Wr="\\s*([+-]?\\d+)\\s*",an="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",Br="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",en=/^#([0-9a-f]{3,8})$/,Zn=new RegExp("^rgb\\("+[Wr,Wr,Wr]+"\\)$"),zn=new RegExp("^rgb\\("+[Br,Br,Br]+"\\)$"),li=new RegExp("^rgba\\("+[Wr,Wr,Wr,an]+"\\)$"),sa=new RegExp("^rgba\\("+[Br,Br,Br,an]+"\\)$"),Oa=new RegExp("^hsl\\("+[an,Br,Br]+"\\)$"),Gr=new RegExp("^hsla\\("+[an,Br,Br,an]+"\\)$"),Ds={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};vt(Qt,go,{copy:function(e){return Object.assign(new this.constructor,this,e)},displayable:function(){return this.rgb().displayable()},hex:Co,formatHex:Co,formatHsl:xn,formatRgb:xs,toString:xs});function Co(){return this.rgb().formatHex()}function xn(){return Zi(this).formatHsl()}function xs(){return this.rgb().formatRgb()}function go(e){var i,t;return e=(e+"").trim().toLowerCase(),(i=en.exec(e))?(t=i[1].length,i=parseInt(i[1],16),t===6?Ns(i):t===3?new Es(i>>8&15|i>>4&240,i>>4&15|i&240,(i&15)<<4|i&15,1):t===8?Po(i>>24&255,i>>16&255,i>>8&255,(i&255)/255):t===4?Po(i>>12&15|i>>8&240,i>>8&15|i>>4&240,i>>4&15|i&240,((i&15)<<4|i&15)/255):null):(i=Zn.exec(e))?new Es(i[1],i[2],i[3],1):(i=zn.exec(e))?new Es(i[1]*255/100,i[2]*255/100,i[3]*255/100,1):(i=li.exec(e))?Po(i[1],i[2],i[3],i[4]):(i=sa.exec(e))?Po(i[1]*255/100,i[2]*255/100,i[3]*255/100,i[4]):(i=Oa.exec(e))?da(i[1],i[2]/100,i[3]/100,1):(i=Gr.exec(e))?da(i[1],i[2]/100,i[3]/100,i[4]):Ds.hasOwnProperty(e)?Ns(Ds[e]):e==="transparent"?new Es(NaN,NaN,NaN,0):null}function Ns(e){return new Es(e>>16&255,e>>8&255,e&255,1)}function Po(e,i,t,r){return r<=0&&(e=i=t=NaN),new Es(e,i,t,r)}function hl(e){return e instanceof Qt||(e=go(e)),e?(e=e.rgb(),new Es(e.r,e.g,e.b,e.opacity)):new Es}function yu(e,i,t,r){return arguments.length===1?hl(e):new Es(e,i,t,r==null?1:r)}function Es(e,i,t,r){this.r=+e,this.g=+i,this.b=+t,this.opacity=+r}vt(Es,yu,Tt(Qt,{brighter:function(e){return e=e==null?kr:Math.pow(kr,e),new Es(this.r*e,this.g*e,this.b*e,this.opacity)},darker:function(e){return e=e==null?xr:Math.pow(xr,e),new Es(this.r*e,this.g*e,this.b*e,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:fs,formatHex:fs,formatRgb:Ou,toString:Ou}));function fs(){return"#"+Al(this.r)+Al(this.g)+Al(this.b)}function Ou(){var e=this.opacity;return e=isNaN(e)?1:Math.max(0,Math.min(1,e)),(e===1?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(e===1?")":", "+e+")")}function Al(e){return e=Math.max(0,Math.min(255,Math.round(e)||0)),(e<16?"0":"")+e.toString(16)}function da(e,i,t,r){return r<=0?e=i=t=NaN:t<=0||t>=1?e=i=NaN:i<=0&&(e=NaN),new no(e,i,t,r)}function Zi(e){if(e instanceof no)return new no(e.h,e.s,e.l,e.opacity);if(e instanceof Qt||(e=go(e)),!e)return new no;if(e instanceof no)return e;e=e.rgb();var i=e.r/255,t=e.g/255,r=e.b/255,n=Math.min(i,t,r),a=Math.max(i,t,r),u=NaN,f=a-n,g=(a+n)/2;return f?(i===a?u=(t-r)/f+(t<r)*6:t===a?u=(r-i)/f+2:u=(i-t)/f+4,f/=g<.5?a+n:2-a-n,u*=60):f=g>0&&g<1?0:u,new no(u,f,g,e.opacity)}function Fs(e,i,t,r){return arguments.length===1?Zi(e):new no(e,i,t,r==null?1:r)}function no(e,i,t,r){this.h=+e,this.s=+i,this.l=+t,this.opacity=+r}vt(no,Fs,Tt(Qt,{brighter:function(e){return e=e==null?kr:Math.pow(kr,e),new no(this.h,this.s,this.l*e,this.opacity)},darker:function(e){return e=e==null?xr:Math.pow(xr,e),new no(this.h,this.s,this.l*e,this.opacity)},rgb:function(){var e=this.h%360+(this.h<0)*360,i=isNaN(e)||isNaN(this.s)?0:this.s,t=this.l,r=t+(t<.5?t:1-t)*i,n=2*t-r;return new Es(ts(e>=240?e-240:e+120,n,r),ts(e,n,r),ts(e<120?e+240:e-120,n,r),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var e=this.opacity;return e=isNaN(e)?1:Math.max(0,Math.min(1,e)),(e===1?"hsl(":"hsla(")+(this.h||0)+", "+(this.s||0)*100+"%, "+(this.l||0)*100+"%"+(e===1?")":", "+e+")")}}));function ts(e,i,t){return(e<60?i+(t-i)*e/60:e<180?t:e<240?i+(t-i)*(240-e)/60:i)*255}function Oo(e){return typeof e=="string"?!!d3.color(e):!1}function Ni(e){var i=go(e),t=[0,0,0,0];return i!=null&&(t[0]=i.r/255,t[1]=i.g/255,t[2]=i.b/255,t[3]=i.opacity),t}function io(e){var i=e&&e[0],t=e&&e[1],r=e&&e[2],n=i+t*256+r*65536-1;return n}function bs(e){return[e+1&255,e+1>>8&255,e+1>>8>>8&255]}function Wo(e){var i=window.document.createElement("canvas"),t=i.getContext("2d");i.width=256,i.height=1;for(var r=null,n=t.createLinearGradient(0,0,256,1),a=e.positions[0],u=e.positions[e.positions.length-1],f=0;f<e.colors.length;++f){var g=(e.positions[f]-a)/(u-a);n.addColorStop(g,e.colors[f])}return t.fillStyle=n,t.fillRect(0,0,256,1),r=new Uint8ClampedArray(t.getImageData(0,0,256,1).data),i=null,t=null,{data:r,width:256,height:1}}function Ru(e,i){var t=window.document.createElement("canvas"),r=t.getContext("2d");t.width=256,t.height=1;for(var n=r.createLinearGradient(0,0,256,1),a=i[1]-i[0],u=0;u<e.colors.length;++u){var f=Math.max((e.positions[u]-i[0])/a,0);n.addColorStop(f,e.colors[u])}r.fillStyle=n,r.fillRect(0,0,256,1);var g=r.getImageData(0,0,256,1).data,x=uo(r,g);return t=null,r=null,x}function Sa(e){var i=window.document.createElement("canvas"),t=i.getContext("2d");i.width=256,i.height=1;var r=t.createImageData(256,1);return r.data.fill(0),e.positions.forEach(function(n,a){var u=Ni(e.colors[a]);r.data[n*4+0]=u[0]*255,r.data[n*4+1]=u[1]*255,r.data[n*4+2]=u[2]*255,r.data[n*4+3]=u[3]*255}),i=null,t=null,r}function ya(e){var i=window.document.createElement("canvas"),t=i.getContext("2d");t.globalAlpha=1,i.width=256,i.height=1;for(var r=256/e.colors.length,n=0;n<e.colors.length;n++)t.beginPath(),t.lineWidth=2,t.strokeStyle=e.colors[n],t.moveTo(n*r,0),t.lineTo((n+1)*r,0),t.stroke();var a=t.getImageData(0,0,256,1).data,u=uo(t,a);return i=null,t=null,u}function Ku(e,i){var t=window.document.createElement("canvas"),r=t.getContext("2d");r.globalAlpha=1,t.width=256,t.height=1;var n=i[1]-i[0];e.positions.length-e.colors.length!==1&&console.warn("positions \u7684\u6570\u5B57\u4E2A\u6570\u5E94\u5F53\u6BD4 colors \u7684\u6837\u5F0F\u591A\u4E00\u4E2A,poisitions \u7684\u9996\u5C3E\u503C\u4E00\u822C\u4E3A\u6570\u636E\u7684\u6700\u5927\u6700\u65B0\u503C");for(var a=0;a<e.colors.length;a++)r.beginPath(),r.lineWidth=2,r.strokeStyle=e.colors[a],r.moveTo((e.positions[a]-i[0])/n*255,0),r.lineTo((e.positions[a+1]-i[0])/n*255,0),r.stroke();var u=r.getImageData(0,0,256,1).data,f=uo(r,u);return t=null,r=null,f}function uo(e,i){for(var t=e.createImageData(256,1),r=0;r<t.data.length;r+=4)t.data[r+0]=i[r+0],t.data[r+1]=i[r+1],t.data[r+2]=i[r+2],t.data[r+3]=i[r+3];return t}function Js(e){switch(e.type){case"cat":return[0,255];default:return[0,1]}}var Ca={BACK:1029,FRONT:1028};function uu(e){switch(e){case"GAODE1.x":return Ca.BACK;case"GAODE2.x":return Ca.BACK;case"MAPBOX":return Ca.FRONT;case"SIMPLE":return Ca.FRONT;case"GLOBEL":return Ca.BACK;case"DEBAULT":return Ca.FRONT;default:return Ca.FRONT}}var Mr=C(42371),vn=C(39718),lo=C(61400),eu=C.n(lo),tu=C(20250),Ss=C.n(tu),Bs=C(41571),ja=C.n(Bs),Yc=C(44231),Cs=C.n(Yc),rs=C(26561),Ll=C.n(rs),zi=C(98621),Pl=C.n(zi),Ro=C(93544),pl=C.n(Ro),Ai=C(68868),_u=C.n(Ai),vf=C(19308),ku=C.n(vf),ns=C(7941),Mt=C.n(ns),Ve=C(18397),Gt=C.n(Ve),ce=C(28440),Be=C.n(ce),Ye=C(24602),zt=C.n(Ye),hr=C(63536),Lr=C.n(hr),dn=C(46700),Mn=C.n(dn),vi=C(21691),co=C.n(vi),is=C(53592),ws=C.n(is),Xc=C(9363),Zs=C.n(Xc),ua=C(20816),Jl=C.n(ua),qa=C(16513),gf=C.n(qa),dl=C(34301),wa=C.n(dl),In={isNil:pl(),merge:Be(),throttle:Mn(),isString:Mt(),debounce:ja(),pull:Lr(),isTypedArray:Gt(),isPlainObject:ku(),isNumber:_u(),isBoolean:Ll(),isEqual:Pl(),cloneDeep:Ss(),uniq:co(),clamp:eu(),upperFirst:ws(),get:Cs(),mergeWith:zt(),isFunction:Zs(),isObject:Jl(),isUndefined:gf(),camelCase:wa()},Ju=In.pull;function zs(e){var i=e;return typeof e=="string"&&(i=window.document.getElementById(e)),i}function lu(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}function cu(e){return lu(e).split(/\s+/)}function xu(e){var i,t,r=(i=document)===null||i===void 0||(t=i.documentElement)===null||t===void 0?void 0:t.style;if(!r)return e[0];for(var n in e)if(e[n]&&e[n]in r)return e[n];return e[0]}function ci(e,i,t){var r=window.document.createElement(e);return i&&(r.className=i||""),t&&t.appendChild(r),r}function as(e){var i=e.parentNode;i&&i.removeChild(e)}function Ha(e,i){if(e.classList!==void 0)for(var t=cu(i),r=0,n=t.length;r<n;r++)e.classList.add(t[r]);else if(!mo(e,i)){var a=mf(e);fu(e,(a?a+" ":"")+i)}}function Ra(e,i){if(e.classList!==void 0){var t=cu(i);t.forEach(function(r){e.classList.remove(r)})}else fu(e,lu((" "+mf(e)+" ").replace(" "+i+" "," ")))}function mo(e,i){if(e.classList!==void 0)return e.classList.contains(i);var t=mf(e);return t.length>0&&new RegExp("(^|\\s)"+i+"(\\s|$)").test(t)}function fu(e,i){e instanceof HTMLElement?e.className=i:e.className.baseVal=i}function mf(e){return e instanceof SVGElement&&(e=e.correspondingElement),e.className.baseVal===void 0?e.className:e.className.baseVal}function Ol(e){for(;e&&e.firstChild;)e.removeChild(e.firstChild)}var Qc=xu(["transform","WebkitTransform"]);function kf(e,i){e.style[Qc]=i}function Yo(){if(typeof Event=="function")window.dispatchEvent(new Event("resize"));else{var e=window.document.createEvent("UIEvents");e.initUIEvent("resize",!0,!1,window,0),window.dispatchEvent(e)}}function Us(e){var i=["padding: "+(e.height/2-8)+"px "+e.width/2+"px;","line-height: "+e.height+"px;","background-image: url("+e.toDataURL()+");"];console.log(`%c
`,i.join(""))}function ko(){var e,i=window.document.querySelector('meta[name="viewport"]');if(!i)return 1;var t=(e=i.content)===null||e===void 0?void 0:e.split(","),r=t.find(function(n){var a=n.split("="),u=(0,vn.Z)(a,1),f=u[0];return f==="initial-scale"});return r?r.split("=")[1]*1:1}var la=ko()<1?1:window.devicePixelRatio;function os(e,i){e.setAttribute("style","".concat(e.style.cssText).concat(i))}function Rl(e){return e.split(";").map(function(i){return i.trim()}).filter(function(i){return i})}function Ta(e,i){var t,r=Rl((t=e.getAttribute("style"))!==null&&t!==void 0?t:""),n=Rl(i),a=Ju.apply(void 0,[r].concat((0,Mr.Z)(n)));e.setAttribute("style",a.join(";"))}function Sn(e){return Object.entries(e).map(function(i){var t=(0,vn.Z)(i,2),r=t[0],n=t[1];return"".concat(r,": ").concat(n)}).join(";")}function vl(e,i){return{left:e.left-i.left,top:e.top-i.top,right:i.left+i.width-e.left-e.width,bottom:i.top+i.height-e.top-e.height}}function ec(e,i){e.checked=i,i?e.setAttribute("checked","true"):e.removeAttribute("checked")}function Ka(e){e.innerHTML=""}function hs(e){e.setAttribute("draggable","false")}function gl(e,i){if(typeof i=="string"){var t=document.createElement("div");for(t.innerHTML=i;t.firstChild;)e.append(t.firstChild)}else Array.isArray(i)?e.append.apply(e,(0,Mr.Z)(i)):e.append(i)}function vc(e,i){for(var t=Array.isArray(i)?i:[i],r=e;r instanceof Element&&r!==window.document.body;){var n,a;if(t.find(function(u){var f;return(f=r)===null||f===void 0?void 0:f.matches(u)}))return r;r=(n=(a=r)===null||a===void 0?void 0:a.parentElement)!==null&&n!==void 0?n:null}}var gc;function yf(e){return typeof ImageBitmap!="undefined"&&e instanceof ImageBitmap}function ea(){return typeof importScripts=="function"}var Du=ea()?function(){return self.worker&&self.worker.referrer}:function(){return(window.location.protocol==="blob:"?window.parent:window).location.href},na=(gc=navigator)===null||gc===void 0?void 0:gc.userAgent,Za=!!na.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/),Do=na.indexOf("Android")>-1||na.indexOf("Adr")>-1;function n0(){for(var e=na,i=["Android","iPhone","SymbianOS","Windows Phone","iPad","iPod"],t=!0,r=0,n=i;r<n.length;r++){var a=n[r];if(e.indexOf(a)>0){t=!1;break}}return t}function fi(e,i){e.forEach(function(t){i[t]&&(i[t]=i[t].bind(i))})}var As=null,ia=C(86461),Ts=C(8822);function _a(e){return typeof e=="number"}var ps=2*Math.PI*6378137/2;function ml(e,i){var t=(0,vn.Z)(i,4),r=t[0],n=t[1],a=t[2],u=t[3];return e.lng>r&&e.lng<=a&&e.lat>n&&e.lat<=u}function ru(e){var i=[1/0,1/0,-1/0,-1/0];return e.forEach(function(t){var r=t.coordinates;Mi(i,r)}),i}function Mi(e,i){return Array.isArray(i[0])?i.forEach(function(t){Mi(e,t)}):(e[0]>i[0]&&(e[0]=i[0]),e[1]>i[1]&&(e[1]=i[1]),e[2]<i[0]&&(e[2]=i[0]),e[3]<i[1]&&(e[3]=i[1])),e}function ss(e,i){return nu(e,i)}function nu(e,i){return Array.isArray(e[0])?e.map(function(t){return nu(t,i)}):i(e)}function No(e){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{enable:!0,decimal:1};e=tc(e,i);var r=e[0],n=e[1],a=r*ps/180,u=Math.log(Math.tan((90+n)*Math.PI/360))/(Math.PI/180);return u=u*ps/180,t.enable&&(a=Number(a.toFixed(t.decimal)),u=Number(u.toFixed(t.decimal))),e.length===3?[a,u,e[2]]:[a,u]}function ds(e){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:6,t=e[0],r=e[1],n=t/ps*180,a=r/ps*180;return a=180/Math.PI*(2*Math.atan(Math.exp(a*Math.PI/180))-Math.PI/2),i!=null&&(n=Number(n.toFixed(i)),a=Number(a.toFixed(i))),e.length===3?[n,a,e[2]]:[n,a]}function Fo(e){if(e==null)throw new Error("lng is required");return(e>180||e<-180)&&(e=e%360,e>180&&(e=-360+e),e<-180&&(e=360+e),e===0&&(e=0)),e}function i0(e){if(e==null)throw new Error("lat is required");return(e>90||e<-90)&&(e=e%180,e>90&&(e=-180+e),e<-90&&(e=180+e),e===0&&(e=0)),e}function tc(e,i){if(i===!1)return e;var t=Fo(e[0]),r=i0(e[1]);return r>85&&(r=85),r<-85&&(r=-85),e.length===3?[t,r,e[2]]:[t,r]}function va(e){var i=85.0511287798,t=Math.max(Math.min(i,e[1]),-i),r=256<<20,n=Math.PI/180,a=e[0]*n,u=t*n;u=Math.log(Math.tan(Math.PI/4+u/2));var f=.5/Math.PI,g=.5,x=-.5/Math.PI;return n=.5,a=r*(f*a+g),u=r*(x*u+n),[Math.floor(a),Math.floor(u)]}function Bo(e){var i=.5/Math.PI,t=.5,r=-.5/Math.PI,n=.5,a=256<<20,u=_slicedToArray(e,2),f=u[0],g=u[1];f=(f/a-t)/i,g=(g/a-n)/r,g=(Math.atan(Math.pow(Math.E,g))-Math.PI/4)*2,n=Math.PI/180;var x=g/n,I=f/n;return[I,x]}function Ms(e,i){var t=85.0511287798,r=Math.PI/180,n=6378137;return i=Math.max(Math.min(t,i),-t),e*=r,i*=r,i=Math.log(Math.tan(Math.PI/4+i/2)),[e*n,i*n]}function fo(e,i){var t=Math.PI/180,r=6378137,n=e/r/t,a=2*(Math.atan(Math.exp(i/r))-Math.PI/4)/t;return[n,a]}function Xo(e,i,t){var r=degreesToRadians(i[1]-e[1]),n=degreesToRadians(i[0]-e[0]),a=degreesToRadians(e[1]),u=degreesToRadians(i[1]),f=Math.pow(Math.sin(r/2),2)+Math.pow(Math.sin(n/2),2)*Math.cos(a)*Math.cos(u);return radiansToLength(2*Math.atan2(Math.sqrt(f),Math.sqrt(1-f)),t="meters")}function hu(e){var i=Math.PI/180,t=85.0511287798,r=6378137,n=Math.max(Math.min(t,e[1]),-t),a=Math.sin(n*i),u=r*e[0]*i,f=r*Math.log((1+a)/(1-a))/2;return[u,f]}function Au(e,i){var t=Math.abs(e[1][1]-e[0][1])*i,r=Math.abs(e[1][0]-e[0][0])*i;return[[e[0][0]-r,e[0][1]-t],[e[1][0]+r,e[1][1]+t]]}function zr(e,i){return e[0][0]<=i[0][0]&&e[0][1]<=i[0][1]&&e[1][0]>=i[1][0]&&e[1][1]>=i[1][1]}function Ja(e){return[[e[0],e[1]],[e[2],e[3]]]}function mc(e){var i=kl(e,[0,0]);return[e[0]/i,e[1]/i]}function kl(e,i){return Math.sqrt(Math.pow(e[0]-i[0],2)+Math.pow(e[1]-i[1],2))}function yo(e,i){return e[0]*i[0]+e[1]*i[1]}function Nu(e){return Math.sqrt(e[0]*e[0]+e[1]*e[1])}function Eu(e,i){return Math.acos(yo(e,i)/(Nu(e)*Nu(i)))*180/Math.PI}function qc(e,i){return i[0]>0?i[1]>0?90-Math.atan(i[1]/i[0])*180/Math.PI:90+Math.atan(-i[1]/i[0])*180/Math.PI:i[1]<0?180+(90-Math.atan(i[1]/i[0])*180/Math.PI):270+Math.atan(i[1]/-i[0])*180/Math.PI}function vs(e){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:100;if(!(!e||e.length<2)){for(var t=[0,1],r=0,n=[],a=0;a<e.length-1;a++){var u=e[a],f=e[a+1],g=kl(u,f);r+=g;var x=[u[0]-f[0],u[1]-f[1]],I=qc(t,x);if(a>0){var O=n[a-1].rotation;O-I>360-O+I&&(I=I+360)}n.push({start:u,end:f,dis:g,rotation:I,duration:0})}return n.map(function(B){B.duration=i*(B.dis/r)}),n}}function Is(e){if(_a(e[0]))return e;if(_a(e[0][0]))throw new Error("\u5F53\u524D\u6570\u636E\u4E0D\u652F\u6301\u6807\u6CE8");if(_a(e[0][0][0])){var i=e,t=0,r=0,n=0;return i.forEach(function(a){a.forEach(function(u){t+=u[0],r+=u[1],n++})}),[t/n,r/n,0]}else throw new Error("\u5F53\u524D\u6570\u636E\u4E0D\u652F\u6301\u6807\u6CE8")}function Dl(e){for(var i=e[0],t=e[1],r=e[0],n=e[1],a=0,u=0,f=0,g=0;g<e.length;g+=2){var x=e[g],I=e[g+1];x&&I&&(i=Math.max(x,i),t=Math.max(I,t),r=Math.min(x,r),n=Math.min(I,n),a+=x,u+=I,f++)}return{center:[a/f,u/f],radius:Math.sqrt(Math.pow(i-r,2)+Math.pow(t-n,2))/2}}function el(e){return(0,ia.Z)((0,Ts.uf)([(0,Ts.Tu)(e)]))}function Kc(e){var i=131,t=137,r=0;e+="x";for(var n=Math.floor(9007199254740991/t),a=0;a<e.length;a++)r>n&&(r=Math.floor(r/t)),r=r*i+e.charCodeAt(a);return r}function Df(e){e=e.toString();for(var i=5381,t=e.length;t;)i=i*33^e.charCodeAt(--t);return i>>>0}function yl(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var i=Math.random()*16|0,t=e==="x"?i:i&3|8;return t.toString(16)})}var bu=function(e){return e["GAODE1.x"]="GAODE1.x",e["GAODE2.x"]="GAODE2.x",e.MAPBOX="MAPBOX",e.DEFAULT="DEFAUlTMAP",e.SIMPLE="SIMPLE",e.GLOBEL="GLOBEL",e}({});function wo(e,i,t,r,n){var a=arguments.length>5&&arguments[5]!==void 0?arguments[5]:30,u=arguments.length>6?arguments[6]:void 0,f=t;return u&&(f=Math.round(t*(a-1))/(a-1)),r?Fu(e,i,f,r,n):Fu(e,i,f,.314,n)}function _l(e,i){var t=1-i;return(e[0]*t+e[1]*i)*t+(e[1]*t+e[2]*i)*i}function Zo(e,i){return Math.sqrt(Math.pow(e[0]-i[0],2)+Math.pow(e[1]-i[1],2))}function Su(e,i,t){var r=[i[0]-e[0],i[1]-e[1]],n=Zo(r,[0,0]),a=Math.atan2(r[1],r[0]),u=n/2/Math.cos(t),f=a+t,g=[u*Math.cos(f)+e[0],u*Math.sin(f)+e[1]];return g}function Fu(e,i,t,r,n){if(n===MapType["GAODE2.x"]){var a=amap2Project(e[0],e[1]),u=amap2Project(i[0],i[1]),f=Su(a,u,r),g=[a[0],f[0],u[0]],x=[a[1],f[1],u[1]];return[].concat(_toConsumableArray(amap2UnProject(_l(g,t),_l(x,t))),[0])}else{var I=Su(e,i,r),O=[e[0],I[0],i[0]],B=[e[1],I[1],i[1]];return[_l(O,t),_l(B,t),0]}}function Jc(e,i,t,r,n){var a=arguments.length>5&&arguments[5]!==void 0?arguments[5]:30,u=arguments.length>6?arguments[6]:void 0,f=t;return u&&(f=Math.round(t*29)/29),_o(e,i,f,n)}function xl(e,i){var t=[i[0]-e[0],i[1]-e[1]],r=calDistance(t,[0,0]),n=Math.atan2(t[1],t[0]),a=.314,u=r/2/Math.cos(a),f=n+a,g=[u*Math.cos(f)+e[0],u*Math.sin(f)+e[1]];return g}function Bu(e,i){var t=1-i;return(e[0]*t+e[1]*i)*t+(e[1]*t+e[2]*i)*i}function pu(e,i){var t=[e[0]-i[0],e[1]-i[1]],r=[Math.sin(t[0]/2),Math.sin(t[1]/2)],n=r[1]*r[1]+Math.cos(e[1])*Math.cos(i[1])*r[0]*r[0];return 2*Math.atan2(Math.sqrt(n),Math.sqrt(1-n))}function _o(e,i,t,r){var n=[degreesToRadians(e[0]),degreesToRadians(e[1])],a=[degreesToRadians(i[0]),degreesToRadians(i[1])];if(r==="GAODE2.x"){var u=xl(n,a),f=[n[0],u[0],a[0]],g=[n[1],u[1],a[1]];return[Bu(f,t),Bu(g,t),0]}else{var x=pu(n,a);if(Math.abs(x-Math.PI)<.001)return[(1-t)*n[0]+t*a[0],(1-t)*n[1]+t*a[1]];var I=Math.sin((1-t)*x)/Math.sin(x),O=Math.sin(t*x)/Math.sin(x),B=[Math.sin(n[0]),Math.sin(n[1])],W=[Math.cos(n[0]),Math.cos(n[1])],he=[Math.sin(a[0]),Math.sin(a[1])],ae=[Math.cos(a[0]),Math.cos(a[1])],Se=I*W[1]*W[0]+O*ae[1]*ae[0],Fe=I*W[1]*B[0]+O*ae[1]*he[0],Qe=I*B[1]+O*he[1];return[radiansToDegrees(Math.atan2(Fe,Se)),radiansToDegrees(Math.atan2(Qe,Math.sqrt(Se*Se+Fe*Fe)))]}}function Cu(e,i){for(var t=0,r=[],n=0;n<e.length-1;n++){var a=e[n],u=e[n+1],f=a0(a,u),g=t;t+=f,r.push({p1:a,p2:u,totalDistance:t,distance:f,lastTotalDistance:g})}for(var x=t*i,I,O,B=0,W=r;B<W.length;B++){var he=W[B],ae=he.totalDistance;if(ae>x){var Se=he.p1,Fe=he.p2,Qe=(x-he.lastTotalDistance)/he.distance,qe=ho(Fe,Se,Qe);I=qe[0],O=qe[1];break}}return{lng:I,lat:O,height:0}}function ho(e,i,t){return[e[0]*t+i[0]*(1-t),e[1]*t+i[1]*(1-t)]}function a0(e,i){return Math.sqrt(Math.pow(e[0]-i[0],2)+Math.pow(e[1]-i[1],2))}function tl(e,i){var t=i.featureId,r=e.data.dataArray;return typeof t=="number"&&(r=r.filter(function(n){var a=n.id;return a===t})),r.map(function(n){var a=zo(n,i);return _objectSpread(_objectSpread({},n),a)})}function rc(e,i){return new Promise(function(t){e.inited?t(tl(e,i)):e.once("update",function(){t(tl(e,i))})})}function zo(e,i){var t=i.offset,r=i.shape,n=i.thetaOffset,a=i.mapVersion,u=i.segmentNumber,f=u===void 0?30:u,g=i.autoFit,x=g===void 0?!0:g,I=e.coordinates;if(r==="line")return pathLineAtOffset(I,t);var O=I[0],B=I[1],W=typeof n=="string"?e[n]||0:n,he;switch(r){case"arc":he=arcLineAtOffset;break;case"greatcircle":he=greatCircleLineAtOffset;break;default:he=arcLineAtOffset}var ae=he(O,B,t,W,a,f,x),Se=_slicedToArray(ae,3),Fe=Se[0],Qe=Se[1],qe=Se[2];return{lng:Fe,lat:Qe,height:qe}}var Qo=function(){function e(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:50,t=arguments.length>1?arguments[1]:void 0;(0,ue.Z)(this,e),this.limit=i,this.destroy=t||this.defaultDestroy,this.order=[],this.clear()}return(0,me.Z)(e,[{key:"clear",value:function(){var t=this;this.order.forEach(function(r){t.delete(r)}),this.cache={},this.order=[]}},{key:"get",value:function(t){var r=this.cache[t];return r&&(this.deleteOrder(t),this.appendOrder(t)),r}},{key:"set",value:function(t,r){this.cache[t]?(this.delete(t),this.cache[t]=r,this.appendOrder(t)):(Object.keys(this.cache).length===this.limit&&this.delete(this.order[0]),this.cache[t]=r,this.appendOrder(t))}},{key:"delete",value:function(t){var r=this.cache[t];r&&(this.deleteCache(t),this.deleteOrder(t),this.destroy(r,t))}},{key:"deleteCache",value:function(t){delete this.cache[t]}},{key:"deleteOrder",value:function(t){var r=this.order.findIndex(function(n){return n===t});r>=0&&this.order.splice(r,1)}},{key:"appendOrder",value:function(t){this.order.push(t)}},{key:"defaultDestroy",value:function(t,r){return null}}]),e}();function Gs(e){if(e.length===0)throw new Error("max requires at least one data point");for(var i=e[0],t=1;t<e.length;t++)e[t]>i&&(i=e[t]);return i*1}function js(e){if(e.length===0)throw new Error("min requires at least one data point");for(var i=e[0],t=1;t<e.length;t++)e[t]<i&&(i=e[t]);return i*1}function yc(e){if(e.length===0)return 0;for(var i=e[0]*1,t=1;t<e.length;t++)i+=e[t]*1;return i}function Ls(e){if(e.length===0)throw new Error("mean requires at least one data point");return yc(e)/e.length}function El(e){if(e.length===0)throw new Error("mean requires at least one data point");if(e.length<3)return e[0];e.sort();for(var i=e[0],t=NaN,r=0,n=1,a=1;a<e.length+1;a++)e[a]!==i?(n>r&&(r=n,t=i),n=1,i=e[a]):n++;return t*1}var To={min:js,max:Gs,mean:Ls,sum:yc,mode:El};function Vs(e,i){return e.map(function(t){return t[i]})}function Va(e,i){return To[e](i)}var ur=C(97100),bt=C(9967),Ce=C(80268),Hs=C(96026),nt=C.n(Hs),rl=C(39511),xa=C(40666),$s=C.n(xa),ai=function(e){return e.Realtime="realtime",e.Overlap="overlap",e.Replace="replace",e}({}),ca=function(e){return e.Loading="Loading",e.Loaded="Loaded",e.Failure="Failure",e.Cancelled="Cancelled",e}({}),bi=0,$a=1,Ii=2;function Hn(e){e.forEach(function(i){i.isCurrent&&(i.isVisible=i.isLoaded)})}function mi(e){e.forEach(function(i){i.properties.state=bi}),e.forEach(function(i){i.isCurrent&&!_i(i)&&di(i)}),e.forEach(function(i){i.isVisible=!!(i.properties.state&Ii)})}function Wi(e){e.forEach(function(t){t.properties.state=bi}),e.forEach(function(t){t.isCurrent&&_i(t)});var i=e.slice().sort(function(t,r){return t.z-r.z});i.forEach(function(t){t.isVisible=!!(t.properties.state&Ii),t.children.length&&(t.isVisible||t.properties.state&$a)?t.children.forEach(function(r){r.properties.state=$a}):t.isCurrent&&di(t)})}function _i(e){for(;e;){if(e.isLoaded)return e.properties.state|=Ii,!0;e=e.parent}return!1}function di(e){e.children.forEach(function(i){i.isLoaded?i.properties.state|=Ii:di(i)})}var wn,Yn=256,Li=[-1/0,-1/0,1/0,1/0],qn=.2,Ui=5,Gi=(wn={},(0,Ce.Z)(wn,ai.Realtime,Hn),(0,Ce.Z)(wn,ai.Overlap,mi),(0,Ce.Z)(wn,ai.Replace,Wi),wn),Nn=function(){};function Yi(e,i,t){var r=Math.floor((e+180)/360*Math.pow(2,t)),n=Math.floor((1-Math.log(Math.tan(i*Math.PI/180)+1/Math.cos(i*Math.PI/180))/Math.PI)/2*Math.pow(2,t));return[r,n]}function $n(e,i,t){var r=e/Math.pow(2,t)*360-180,n=Math.PI-2*Math.PI*i/Math.pow(2,t),a=180/Math.PI*Math.atan(.5*(Math.exp(n)-Math.exp(-n)));return[r,a]}var Pi=function(i,t,r){var n=$n(i,t,r),a=(0,vn.Z)(n,2),u=a[0],f=a[1],g=$n(i+1,t+1,r),x=(0,vn.Z)(g,2),I=x[0],O=x[1];return[u,O,I,f]};function Oi(e){var i=e.zoom,t=e.latLonBounds,r=e.maxZoom,n=r===void 0?1/0:r,a=e.minZoom,u=a===void 0?0:a,f=e.zoomOffset,g=f===void 0?0:f,x=e.extent,I=x===void 0?Li:x,O=Math.ceil(i)+g;if(Number.isFinite(u)&&O<u)return[];Number.isFinite(n)&&O>n&&(O=n);for(var B=(0,vn.Z)(t,4),W=B[0],he=B[1],ae=B[2],Se=B[3],Fe=[Math.max(W,I[0]),Math.max(he,I[1]),Math.min(ae,I[2]),Math.min(Se,I[3])],Qe=[],qe=Yi(Fe[0],Fe[1],O),yt=(0,vn.Z)(qe,2),Et=yt[0],Ot=yt[1],jt=Yi(Fe[2],Fe[3],O),or=(0,vn.Z)(jt,2),ar=or[0],br=or[1],pr=Et;pr<=ar;pr++)for(var jr=br;jr<=Ot;jr++)Qe.push({x:pr,y:jr,z:O});var nn=(ar+Et)/2,yn=(Ot+br)/2,ma=function(Lo,Rs){return Math.abs(Lo-nn)+Math.abs(Rs-yn)};return Qe.sort(function(Ho,Lo){return ma(Ho.x,Ho.y)-ma(Lo.x,Lo.y)}),Qe}var Qi=function(i,t,r){var n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!0,a=Math.pow(2,r),u=a-1,f=a,g=i,x=t;return n&&(g<0?g=g+f:g>u&&(g=g%f)),{warpX:g,warpY:x}};function qi(e){var i=hi();return function(){var r=(0,oe.Z)(e),n;if(i){var a=(0,oe.Z)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return(0,Ze.Z)(this,n)}}function hi(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var Si=function(e){(0,ke.Z)(t,e);var i=qi(t);function t(r){var n;(0,ue.Z)(this,t),n=i.call(this),(0,Ce.Z)((0,bt.Z)(n),"tileSize",256),(0,Ce.Z)((0,bt.Z)(n),"isVisible",!1),(0,Ce.Z)((0,bt.Z)(n),"isCurrent",!1),(0,Ce.Z)((0,bt.Z)(n),"isVisibleChange",!1),(0,Ce.Z)((0,bt.Z)(n),"loadedLayers",0),(0,Ce.Z)((0,bt.Z)(n),"isLayerLoaded",!1),(0,Ce.Z)((0,bt.Z)(n),"isLoad",!1),(0,Ce.Z)((0,bt.Z)(n),"isChildLoad",!1),(0,Ce.Z)((0,bt.Z)(n),"parent",null),(0,Ce.Z)((0,bt.Z)(n),"children",[]),(0,Ce.Z)((0,bt.Z)(n),"data",null),(0,Ce.Z)((0,bt.Z)(n),"properties",{}),(0,Ce.Z)((0,bt.Z)(n),"loadDataId",0);var a=r.x,u=r.y,f=r.z,g=r.tileSize,x=r.warp,I=x===void 0?!0:x;return n.x=a,n.y=u,n.z=f,n.warp=I||!0,n.tileSize=g,n}return(0,me.Z)(t,[{key:"isLoading",get:function(){return this.loadStatus===ca.Loading}},{key:"isLoaded",get:function(){return this.loadStatus===ca.Loaded}},{key:"isFailure",get:function(){return this.loadStatus===ca.Failure}},{key:"setTileLayerLoaded",value:function(){this.isLayerLoaded=!0}},{key:"isCancelled",get:function(){return this.loadStatus===ca.Cancelled}},{key:"isDone",get:function(){return[ca.Loaded,ca.Cancelled,ca.Failure].includes(this.loadStatus)}},{key:"bounds",get:function(){return Pi(this.x,this.y,this.z)}},{key:"bboxPolygon",get:function(){var n=(0,vn.Z)(this.bounds,4),a=n[0],u=n[1],f=n[2],g=n[3],x=[(f-a)/2,(g-u)/2],I=(0,rl.Z)(this.bounds,{properties:{key:this.key,id:this.key,bbox:this.bounds,center:x,meta:`
      `.concat(this.key,`
      `)}});return I}},{key:"key",get:function(){var n="".concat(this.x,"_").concat(this.y,"_").concat(this.z);return n}},{key:"layerLoad",value:function(){this.loadedLayers++,this.emit("layerLoaded")}},{key:"loadData",value:function(){var r=(0,ur.Z)(nt().mark(function a(u){var f,g,x,I,O,B,W,he,ae,Se,Fe,Qe,qe,yt,Et,Ot,jt;return nt().wrap(function(ar){for(;;)switch(ar.prev=ar.next){case 0:return f=u.getData,g=u.onLoad,x=u.onError,this.loadDataId++,I=this.loadDataId,this.isLoading&&this.abortLoad(),this.abortController=new AbortController,this.loadStatus=ca.Loading,O=null,ar.prev=7,W=this.x,he=this.y,ae=this.z,Se=this.bounds,Fe=this.tileSize,Qe=this.warp,qe=Qi(W,he,ae,Qe),yt=qe.warpX,Et=qe.warpY,Ot=this.abortController.signal,jt={x:yt,y:Et,z:ae,bounds:Se,tileSize:Fe,signal:Ot,warp:Qe},ar.next=14,f(jt,this);case 14:O=ar.sent,ar.next=20;break;case 17:ar.prev=17,ar.t0=ar.catch(7),B=ar.t0;case 20:if(I===this.loadDataId){ar.next=22;break}return ar.abrupt("return");case 22:if(!(this.isCancelled&&!O)){ar.next=24;break}return ar.abrupt("return");case 24:if(!(B||!O)){ar.next=28;break}return this.loadStatus=ca.Failure,x(B,this),ar.abrupt("return");case 28:this.loadStatus=ca.Loaded,this.data=O,g(this);case 31:case"end":return ar.stop()}},a,this,[[7,17]])}));function n(a){return r.apply(this,arguments)}return n}()},{key:"reloadData",value:function(n){this.isLoading&&this.abortLoad(),this.loadData(n)}},{key:"abortLoad",value:function(){this.isLoaded||this.isCancelled||(this.loadStatus=ca.Cancelled,this.abortController.abort(),this.xhrCancel&&this.xhrCancel())}}]),t}(xa.EventEmitter),Ci=function(i,t){var r=Ja(i),n=Au(r,t),a=360*3-180,u=85.0511287798065,f=[Math.max(n[0][0],-a),Math.max(n[0][1],-u),Math.min(n[1][0],a),Math.min(n[1][1],u)];return f},ji=function(i,t){var r=Ja(i),n=Ja(t),a=zr(r,n);return a};function si(e,i){var t=typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=wu(e))||i&&e&&typeof e.length=="number"){t&&(e=t);var r=0,n=function(){};return{s:n,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(x){throw x},f:n}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var a=!0,u=!1,f;return{s:function(){t=t.call(e)},n:function(){var x=t.next();return a=x.done,x},e:function(x){u=!0,f=x},f:function(){try{!a&&t.return!=null&&t.return()}finally{if(u)throw f}}}}function wu(e,i){if(e){if(typeof e=="string")return qo(e,i);var t=Object.prototype.toString.call(e).slice(8,-1);if(t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set")return Array.from(e);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return qo(e,i)}}function qo(e,i){(i==null||i>e.length)&&(i=e.length);for(var t=0,r=new Array(i);t<i;t++)r[t]=e[t];return r}function nl(e){var i=Zu();return function(){var r=(0,oe.Z)(e),n;if(i){var a=(0,oe.Z)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return(0,Ze.Z)(this,n)}}function Zu(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var Fn=In.throttle,Ko=function(e){return e.TilesLoadStart="tiles-load-start",e.TileLoaded="tile-loaded",e.TileError="tile-error",e.TileUnload="tile-unload",e.TileUpdate="tile-update",e.TilesLoadFinished="tiles-load-finished",e}({}),Ws=function(e){(0,ke.Z)(t,e);var i=nl(t);function t(r){var n;return(0,ue.Z)(this,t),n=i.call(this),(0,Ce.Z)((0,bt.Z)(n),"currentTiles",[]),(0,Ce.Z)((0,bt.Z)(n),"cacheTiles",new Map),(0,Ce.Z)((0,bt.Z)(n),"throttleUpdate",Fn(function(a,u){n.update(a,u)},16)),(0,Ce.Z)((0,bt.Z)(n),"onTileLoad",function(a){n.emit(Ko.TileLoaded,a),n.updateTileVisible(),n.loadFinished()}),(0,Ce.Z)((0,bt.Z)(n),"onTileError",function(a,u){n.emit(Ko.TileError,{error:a,tile:u}),n.updateTileVisible(),n.loadFinished()}),(0,Ce.Z)((0,bt.Z)(n),"onTileUnload",function(a){n.emit(Ko.TileUnload,a),n.loadFinished()}),n.options={tileSize:256,minZoom:0,maxZoom:1/0,zoomOffset:0,extent:Li,getTileData:Nn,warp:!0,updateStrategy:ai.Replace},n.updateOptions(r),n}return(0,me.Z)(t,[{key:"isLoaded",get:function(){return this.currentTiles.every(function(n){return n.isDone})}},{key:"tiles",get:function(){var n=Array.from(this.cacheTiles.values()).sort(function(a,u){return a.z-u.z});return n}},{key:"updateOptions",value:function(n){var a=n.minZoom===void 0?this.options.minZoom:Math.ceil(n.minZoom),u=n.maxZoom===void 0?this.options.maxZoom:Math.floor(n.maxZoom);this.options=(0,X.Z)((0,X.Z)((0,X.Z)({},this.options),n),{},{minZoom:a,maxZoom:u})}},{key:"update",value:function(n,a){var u=this,f=Math.max(0,Math.ceil(n));if(!(this.lastViewStates&&this.lastViewStates.zoom===f&&ji(this.lastViewStates.latLonBoundsBuffer,a))){var g=Ci(a,qn);this.lastViewStates={zoom:f,latLonBounds:a,latLonBoundsBuffer:g},this.currentZoom=f;var x=!1,I=this.getTileIndices(f,g).filter(function(O){return u.options.warp||O.x>=0&&O.x<Math.pow(2,f)});this.emit(Ko.TilesLoadStart),this.currentTiles=I.map(function(O){var B=O.x,W=O.y,he=O.z,ae=u.getTile(B,W,he);if(ae){var Se,Fe,Qe=((Se=ae)===null||Se===void 0?void 0:Se.isFailure)||((Fe=ae)===null||Fe===void 0?void 0:Fe.isCancelled);return Qe&&ae.loadData({getData:u.options.getTileData,onLoad:u.onTileLoad,onError:u.onTileError}),ae}return ae=u.createTile(B,W,he),x=!0,ae}),x&&this.resizeCacheTiles(),this.updateTileVisible(),this.pruneRequests()}}},{key:"reloadAll",value:function(){var n=si(this.cacheTiles),a;try{for(n.s();!(a=n.n()).done;){var u=(0,vn.Z)(a.value,2),f=u[0],g=u[1];if(!this.currentTiles.includes(g)){this.cacheTiles.delete(f),this.onTileUnload(g);return}this.onTileUnload(g),g.loadData({getData:this.options.getTileData,onLoad:this.onTileLoad,onError:this.onTileError})}}catch(x){n.e(x)}finally{n.f()}}},{key:"reloadTileById",value:function(n,a,u){var f=this.cacheTiles.get("".concat(a,",").concat(u,",").concat(n));f&&(this.onTileUnload(f),f.loadData({getData:this.options.getTileData,onLoad:this.onTileLoad,onError:this.onTileError}))}},{key:"reloadTileByLnglat",value:function(n,a,u){var f=this.getTileByLngLat(n,a,u);f&&this.reloadTileById(f.z,f.x,f.y)}},{key:"reloadTileByExtent",value:function(n,a){var u=this,f=this.getTileIndices(a,n);f.forEach(function(g){u.reloadTileById(g.z,g.x,g.y)})}},{key:"pruneRequests",value:function(){var n=[],a=si(this.cacheTiles.values()),u;try{for(a.s();!(u=a.n()).done;){var f=u.value;f.isLoading&&!f.isCurrent&&!f.isVisible&&n.push(f)}}catch(x){a.e(x)}finally{a.f()}for(;n.length>0;){var g=n.shift();g.abortLoad()}}},{key:"getTileByLngLat",value:function(n,a,u){var f=this.options.zoomOffset,g=Math.ceil(u)+f,x=Yi(n,a,g),I=this.tiles.filter(function(O){return O.key==="".concat(x[0],"_").concat(x[1],"_").concat(g)});return I[0]}},{key:"getTileExtent",value:function(n,a){return this.getTileIndices(a,n)}},{key:"getTileByZXY",value:function(n,a,u){var f=this.tiles.filter(function(g){return g.key==="".concat(a,"_").concat(u,"_").concat(n)});return f[0]}},{key:"clear",value:function(){var n=si(this.cacheTiles.values()),a;try{for(n.s();!(a=n.n()).done;){var u=a.value;u.isLoading?u.abortLoad():this.onTileUnload(u)}}catch(f){n.e(f)}finally{n.f()}this.lastViewStates=void 0,this.cacheTiles.clear(),this.currentTiles=[]}},{key:"destroy",value:function(){this.clear(),this.removeAllListeners()}},{key:"updateTileVisible",value:function(){var n=this.options.updateStrategy,a=new Map,u=si(this.cacheTiles.values()),f;try{for(u.s();!(f=u.n()).done;){var g=f.value;a.set(g.key,g.isVisible),g.isCurrent=!1,g.isVisible=!1}}catch(he){u.e(he)}finally{u.f()}var x=si(this.currentTiles),I;try{for(x.s();!(I=x.n()).done;){var O=I.value;O.isCurrent=!0,O.isVisible=!0}}catch(he){x.e(he)}finally{x.f()}var B=Array.from(this.cacheTiles.values());typeof n=="function"?n(B):Gi[n](B);var W=!1;Array.from(this.cacheTiles.values()).forEach(function(he){he.isVisible!==a.get(he.key)?(he.isVisibleChange=!0,W=!0):he.isVisibleChange=!1}),W&&this.emit(Ko.TileUpdate)}},{key:"getTileIndices",value:function(n,a){var u=this.options,f=u.tileSize,g=u.extent,x=u.zoomOffset,I=Math.floor(this.options.maxZoom),O=Math.ceil(this.options.minZoom),B=Oi({maxZoom:I,minZoom:O,zoomOffset:x,tileSize:f,zoom:n,latLonBounds:a,extent:g});return B}},{key:"getTileId",value:function(n,a,u){var f="".concat(n,",").concat(a,",").concat(u);return f}},{key:"loadFinished",value:function(){var n=!this.currentTiles.some(function(a){return!a.isDone});return n&&this.emit(Ko.TilesLoadFinished),n}},{key:"getTile",value:function(n,a,u){var f=this.getTileId(n,a,u),g=this.cacheTiles.get(f);return g}},{key:"createTile",value:function(n,a,u){var f=this.getTileId(n,a,u),g=new Si({x:n,y:a,z:u,tileSize:this.options.tileSize,warp:this.options.warp});return this.cacheTiles.set(f,g),g.loadData({getData:this.options.getTileData,onLoad:this.onTileLoad,onError:this.onTileError}),g}},{key:"resizeCacheTiles",value:function(){var n=Ui*this.currentTiles.length,a=this.cacheTiles.size>n;if(a){var u=si(this.cacheTiles),f;try{for(u.s();!(f=u.n()).done;){var g=(0,vn.Z)(f.value,2),x=g[0],I=g[1];if(!I.isVisible&&!this.currentTiles.includes(I)&&(this.cacheTiles.delete(x),this.onTileUnload(I)),this.cacheTiles.size<=n)break}}catch(O){u.e(O)}finally{u.f()}}this.rebuildTileTree()}},{key:"rebuildTileTree",value:function(){var n=si(this.cacheTiles.values()),a;try{for(n.s();!(a=n.n()).done;){var u=a.value;u.parent=null,u.children.length=0}}catch(O){n.e(O)}finally{n.f()}var f=si(this.cacheTiles.values()),g;try{for(f.s();!(g=f.n()).done;){var x=g.value,I=this.getNearestAncestor(x.x,x.y,x.z);x.parent=I,I!=null&&I.children&&I.children.push(x)}}catch(O){f.e(O)}finally{f.f()}}},{key:"getNearestAncestor",value:function(n,a,u){for(;u>this.options.minZoom;){n=Math.floor(n/2),a=Math.floor(a/2),u=u-1;var f=this.getTile(n,a,u);if(f)return f}return null}}]),t}($s());function du(e){return/(?=.*{box})(?=.*{z})(?=.*{x})(?=.*({y}|{-y}))/.test(e)}function gs(e){var i=[],t=/\{([a-z])-([a-z])\}/.exec(e);if(t){var r=t[1].charCodeAt(0),n=t[2].charCodeAt(0),a;for(a=r;a<=n;++a)i.push(e.replace(t[0],String.fromCharCode(a)));return i}if(t=/\{(\d+)-(\d+)\}/.exec(e),t){for(var u=parseInt(t[2],10),f=parseInt(t[1],10);f<=u;f++)i.push(e.replace(t[0],f.toString()));return i}return i.push(e),i}function bl(e,i){if(!e||!e.length)throw new Error("url is not allowed to be empty");var t=i.x,r=i.y,n=i.z,a=gs(e),u=Math.abs(t+r)%a.length,f=Jr(a[u])?"".concat(a[u],"/{z}/{x}/{y}"):a[u];return f.replace(/\{x\}/g,t.toString()).replace(/\{y\}/g,r.toString()).replace(/\{z\}/g,n.toString()).replace(/\{bbox\}/g,Pi(t,r,n).join(",")).replace(/\{-y\}/g,(Math.pow(2,n)-r-1).toString())}function ms(e,i){var t=i.x,r=i.y,n=i.z,a=i.layer,u=i.version,f=u===void 0?"1.0.0":u,g=i.style,x=g===void 0?"default":g,I=i.format,O=i.service,B=O===void 0?"WMTS":O,W=i.tileMatrixset,he="".concat(e,"&SERVICE=").concat(B,"&REQUEST=GetTile&VERSION=").concat(f,"&LAYER=").concat(a,"&STYLE=").concat(x,"&TILEMATRIXSET=").concat(W,"&FORMAT=").concat(I,"&TILECOL=").concat(t,"&TILEROW=").concat(r,"&TILEMATRIX=").concat(n);return he}function ka(e,i){if(!e)throw new Error(i||"web worker helper assertion failed.")}var il={self:typeof self!="undefined"&&self,window:typeof window!="undefined"&&window,document:typeof document!="undefined"&&document},ef=il.self||il.window||{},o=il.window||il.self||{},s=il.self||il.window||{},d=il.document||{},_=typeof importScripts=="function",w=typeof window!="undefined"&&typeof window.orientation!="undefined",j=function(){function e(i,t){var r=this;this.name=i,this.workerThread=t,this.isRunning=!0,this.resolve=function(){},this.reject=function(){},this.result=new Promise(function(n,a){r.resolve=n,r.reject=a})}return e.prototype.postMessage=function(i,t){this.workerThread.postMessage({source:"Main thread",type:i,payload:t})},e.prototype.done=function(i){ka(this.isRunning,"WorkerJob isRunning false."),this.isRunning=!1,this.resolve(i)},e.prototype.error=function(i){ka(this.isRunning,"WorkerJob isRunning false."),this.isRunning=!1,this.reject(i)},e}(),re=j,Pe=new Map;function tt(e){ka(e.source&&!e.url||!e.source&&e.url);var i=Pe.get(e.source||e.url);return i||(e.url&&(i=It(e.url),Pe.set(e.url,i)),e.source&&(i=tr(e.source),Pe.set(e.source,i))),ka(i),i}function It(e){if(!e.startsWith("http"))return e;var i=ot(e);return tr(i)}function tr(e){var i=new Blob([e],{type:"application/javascript"});return URL.createObjectURL(i)}function ot(e){return`try {
  importScripts('`+e+`');
} catch (error) {
  console.error(error);
  throw error;
}`}function Zt(e,i,t){i===void 0&&(i=!0);var r=t||new Set;if(e){if(Jt(e))r.add(e);else if(Jt(e.buffer))r.add(e.buffer);else if(!ArrayBuffer.isView(e)){if(i&&typeof e=="object")for(var n in e)Zt(e[n],i,r)}}return t===void 0?Array.from(r):[]}function Jt(e){return e?e instanceof ArrayBuffer||typeof MessagePort!="undefined"&&e instanceof MessagePort||typeof ImageBitmap!="undefined"&&e instanceof ImageBitmap||typeof OffscreenCanvas!="undefined"&&e instanceof OffscreenCanvas:!1}var gr=function(){},v=function(){function e(i){this.terminated=!1,this.loadableURL="";var t=i.name,r=i.source,n=i.url;ka(r||n),this.name=t,this.source=r,this.url=n,this.onMessage=gr,this.onError=function(a){return console.log(a)},this.worker=this.createBrowserWorker()}return e.isSupported=function(){return typeof Worker!="undefined"},e.prototype.destroy=function(){this.onMessage=gr,this.onError=gr,this.worker.terminate(),this.terminated=!0},Object.defineProperty(e.prototype,"isRunning",{get:function(){return!!this.onMessage},enumerable:!1,configurable:!0}),e.prototype.postMessage=function(i,t){t=t||Zt(i),this.worker.postMessage(i,t)},e.prototype.getErrorFromErrorEvent=function(i){var t="Failed to load ";return t+="worker "+this.name+" from "+this.url+". ",i.message&&(t+=i.message+" in "),i.lineno&&(t+=":"+i.lineno+":"+i.colno),new Error(t)},e.prototype.createBrowserWorker=function(){var i=this;this.loadableURL=tt({source:this.source,url:this.url});var t=new Worker(this.loadableURL,{name:this.name});return t.onmessage=function(r){r.data?i.onMessage(r.data):i.onError(new Error("No data received"))},t.onerror=function(r){i.onError(i.getErrorFromErrorEvent(r)),i.terminated=!0},t.onmessageerror=function(r){return console.error("worker "+i.name+", message error: "+r)},t},e}(),Ln=v,jn=function(){return jn=Object.assign||function(e){for(var i,t=1,r=arguments.length;t<r;t++){i=arguments[t];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(e[n]=i[n])}return e},jn.apply(this,arguments)},Xe=function(e,i,t,r){function n(a){return a instanceof t?a:new t(function(u){u(a)})}return new(t||(t=Promise))(function(a,u){function f(I){try{x(r.next(I))}catch(O){u(O)}}function g(I){try{x(r.throw(I))}catch(O){u(O)}}function x(I){I.done?a(I.value):n(I.value).then(f,g)}x((r=r.apply(e,i||[])).next())})},Ma=function(e,i){var t={label:0,sent:function(){if(a[0]&1)throw a[1];return a[1]},trys:[],ops:[]},r,n,a,u;return u={next:f(0),throw:f(1),return:f(2)},typeof Symbol=="function"&&(u[Symbol.iterator]=function(){return this}),u;function f(x){return function(I){return g([x,I])}}function g(x){if(r)throw new TypeError("Generator is already executing.");for(;t;)try{if(r=1,n&&(a=x[0]&2?n.return:x[0]?n.throw||((a=n.return)&&a.call(n),0):n.next)&&!(a=a.call(n,x[1])).done)return a;switch(n=0,a&&(x=[x[0]&2,a.value]),x[0]){case 0:case 1:a=x;break;case 4:return t.label++,{value:x[1],done:!1};case 5:t.label++,n=x[1],x=[0];continue;case 7:x=t.ops.pop(),t.trys.pop();continue;default:if(a=t.trys,!(a=a.length>0&&a[a.length-1])&&(x[0]===6||x[0]===2)){t=0;continue}if(x[0]===3&&(!a||x[1]>a[0]&&x[1]<a[3])){t.label=x[1];break}if(x[0]===6&&t.label<a[1]){t.label=a[1],a=x;break}if(a&&t.label<a[2]){t.label=a[2],t.ops.push(x);break}a[2]&&t.ops.pop(),t.trys.pop();continue}x=i.call(e,t)}catch(I){x=[6,I],n=0}finally{r=a=0}if(x[0]&5)throw x[1];return{value:x[0]?x[1]:void 0,done:!0}}},ao=function(){function e(i){this.name="unnamed",this.maxConcurrency=1,this.maxMobileConcurrency=1,this.onDebug=function(){},this.reuseWorkers=!0,this.props={},this.jobQueue=[],this.idleQueue=[],this.count=0,this.isDestroyed=!1,this.source=i.source,this.url=i.url,this.setProps(i)}return e.prototype.destroy=function(){this.idleQueue.forEach(function(i){return i.destroy()}),this.isDestroyed=!0},e.prototype.setProps=function(i){this.props=jn(jn({},this.props),i),i.name!==void 0&&(this.name=i.name),i.maxConcurrency!==void 0&&(this.maxConcurrency=i.maxConcurrency),i.maxMobileConcurrency!==void 0&&(this.maxMobileConcurrency=i.maxMobileConcurrency),i.reuseWorkers!==void 0&&(this.reuseWorkers=i.reuseWorkers),i.onDebug!==void 0&&(this.onDebug=i.onDebug)},e.prototype.startJob=function(i,t,r){return t===void 0&&(t=function(n,a,u){return n.done(u)}),r===void 0&&(r=function(n,a){return n.error(a)}),Xe(this,void 0,void 0,function(){var n,a=this;return Ma(this,function(u){switch(u.label){case 0:return n=new Promise(function(f){return a.jobQueue.push({name:i,onMessage:t,onError:r,onStart:f}),a}),this.startQueuedJob(),[4,n];case 1:return[2,u.sent()]}})})},e.prototype.startQueuedJob=function(){return Xe(this,void 0,void 0,function(){var i,t,r;return Ma(this,function(n){switch(n.label){case 0:if(!this.jobQueue.length)return[2];if(i=this.getAvailableWorker(),!i)return[2];if(t=this.jobQueue.shift(),!t)return[3,4];this.onDebug({message:"Starting job",name:t.name,backlog:this.jobQueue.length,workerThread:i}),r=new re(t.name,i),i.onMessage=function(a){return t.onMessage(r,a.type,a.payload)},i.onError=function(a){return t.onError(r,a)},t.onStart(r),n.label=1;case 1:return n.trys.push([1,,3,4]),[4,r.result];case 2:return n.sent(),[3,4];case 3:return this.returnWorkerToQueue(i),[7];case 4:return[2]}})})},e.prototype.returnWorkerToQueue=function(i){var t=this.isDestroyed||!this.reuseWorkers||this.count>this.getMaxConcurrency();t?(i.destroy(),this.count--):this.idleQueue.push(i),this.isDestroyed||this.startQueuedJob()},e.prototype.getAvailableWorker=function(){if(this.idleQueue.length>0)return this.idleQueue.shift()||null;if(this.count<this.getMaxConcurrency()){this.count++;var i=this.name.toLowerCase()+" (#"+this.count+" of "+this.maxConcurrency+")";return new Ln({name:i,source:this.source,url:this.url})}return null},e.prototype.getMaxConcurrency=function(){return w?this.maxMobileConcurrency:this.maxConcurrency},e}(),xo=ao,aa=function(){return aa=Object.assign||function(e){for(var i,t=1,r=arguments.length;t<r;t++){i=arguments[t];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(e[n]=i[n])}return e},aa.apply(this,arguments)},Da=function(e){var i=typeof Symbol=="function"&&Symbol.iterator,t=i&&e[i],r=0;if(t)return t.call(e);if(e&&typeof e.length=="number")return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(i?"Object is not iterable.":"Symbol.iterator is not defined.")},us={maxConcurrency:3,maxMobileConcurrency:1,onDebug:function(){},reuseWorkers:!0},Ea=function(){function e(i){this.workerPools=new Map,this.props=aa({},us),this.setProps(i),this.workerPools=new Map}return e.isSupported=function(){return Ln.isSupported()},e.getWorkerFarm=function(i){return i===void 0&&(i={}),e.workerFarm=e.workerFarm||new e({}),e.workerFarm.setProps(i),e.workerFarm},e.prototype.destroy=function(){var i,t;try{for(var r=Da(this.workerPools.values()),n=r.next();!n.done;n=r.next()){var a=n.value;a.destroy()}}catch(u){i={error:u}}finally{try{n&&!n.done&&(t=r.return)&&t.call(r)}finally{if(i)throw i.error}}},e.prototype.setProps=function(i){var t,r;this.props=aa(aa({},this.props),i);try{for(var n=Da(this.workerPools.values()),a=n.next();!a.done;a=n.next()){var u=a.value;u.setProps(this.getWorkerPoolProps())}}catch(f){t={error:f}}finally{try{a&&!a.done&&(r=n.return)&&r.call(n)}finally{if(t)throw t.error}}},e.prototype.getWorkerPool=function(i){var t=i.name,r=i.source,n=i.url,a=this.workerPools.get(t);return a||(a=new xo({name:t,source:r,url:n}),a.setProps(this.getWorkerPoolProps()),this.workerPools.set(t,a)),a},e.prototype.getWorkerPoolProps=function(){return{maxConcurrency:this.props.maxConcurrency,maxMobileConcurrency:this.props.maxMobileConcurrency,reuseWorkers:this.props.reuseWorkers,onDebug:this.props.onDebug}},e}(),Vr=null,hn=new Map,Wn=function(){function e(){}return Object.defineProperty(e,"onmessage",{set:function(i){self.onmessage=function(t){if(Kn(t)){var r=t.data,n=r.type,a=r.payload;i(n,a)}}},enumerable:!1,configurable:!0}),e.addEventListener=function(i){var t=hn.get(i);t||(t=function(r){if(Kn(r)){var n=r.data,a=n.type,u=n.payload;i(a,u)}}),self.addEventListener("message",t)},e.removeEventListener=function(i){var t=hn.get(i);hn.delete(i),self.removeEventListener("message",t)},e.postMessage=function(i,t){if(self){var r={source:"Worker thread",type:i,payload:t},n=Zt(t);self.postMessage(r,n)}},e}(),kn=null;function Kn(e){var i=e.type,t=e.data;return i==="message"&&t&&typeof t.source=="string"&&t.source==="Main thread"}function Pn(e){return JSON.parse(Fi(e))}function Fi(e){var i=new Set;return JSON.stringify(e,function(t,r){if(typeof r=="object"&&r!==null){if(i.has(r))try{return JSON.parse(JSON.stringify(r))}catch(n){return}i.add(r)}return r})}function wi(e){return""+e.name}function An(e,i){i===void 0&&(i={});var t=i[e.id]||{},r=e.name+".worker.js",n=t.workerUrl;return i._workerType==="test"&&(n=e.module+"/dist/"+r),n||(n="https://unpkg.com/"+e.module+"/dist/"+r),assert(n),n}var Ue=function(e,i,t,r){function n(a){return a instanceof t?a:new t(function(u){u(a)})}return new(t||(t=Promise))(function(a,u){function f(I){try{x(r.next(I))}catch(O){u(O)}}function g(I){try{x(r.throw(I))}catch(O){u(O)}}function x(I){I.done?a(I.value):n(I.value).then(f,g)}x((r=r.apply(e,i||[])).next())})},al=function(e,i){var t={label:0,sent:function(){if(a[0]&1)throw a[1];return a[1]},trys:[],ops:[]},r,n,a,u;return u={next:f(0),throw:f(1),return:f(2)},typeof Symbol=="function"&&(u[Symbol.iterator]=function(){return this}),u;function f(x){return function(I){return g([x,I])}}function g(x){if(r)throw new TypeError("Generator is already executing.");for(;t;)try{if(r=1,n&&(a=x[0]&2?n.return:x[0]?n.throw||((a=n.return)&&a.call(n),0):n.next)&&!(a=a.call(n,x[1])).done)return a;switch(n=0,a&&(x=[x[0]&2,a.value]),x[0]){case 0:case 1:a=x;break;case 4:return t.label++,{value:x[1],done:!1};case 5:t.label++,n=x[1],x=[0];continue;case 7:x=t.ops.pop(),t.trys.pop();continue;default:if(a=t.trys,!(a=a.length>0&&a[a.length-1])&&(x[0]===6||x[0]===2)){t=0;continue}if(x[0]===3&&(!a||x[1]>a[0]&&x[1]<a[3])){t.label=x[1];break}if(x[0]===6&&t.label<a[1]){t.label=a[1],a=x;break}if(a&&t.label<a[2]){t.label=a[2],t.ops.push(x);break}a[2]&&t.ops.pop(),t.trys.pop();continue}x=i.call(e,t)}catch(I){x=[6,I],n=0}finally{r=a=0}if(x[0]&5)throw x[1];return{value:x[0]?x[1]:void 0,done:!0}}};function Bi(e,i){return WorkerFarm.isSupported()?e.worker&&(i==null?void 0:i.worker):!1}function lt(e,i,t,r){return t===void 0&&(t={}),r===void 0&&(r={}),Ue(this,void 0,void 0,function(){var n,a,u,f,g,x,I,O;return al(this,function(B){switch(B.label){case 0:return n=getWorkerName(e),a=getWorkerURL(e,t),u=WorkerFarm.getWorkerFarm(t),f=u.getWorkerPool({name:n,url:a}),g=t.jobName||e.name,[4,f.startJob(g,ni.bind(null,r))];case 1:return x=B.sent(),I=removeNontransferableOptions(t),x.postMessage("process",{input:i,options:I}),[4,x.result];case 2:return O=B.sent(),[2,O.result]}})})}function ni(e,i,t,r){return Ue(this,void 0,void 0,function(){var n,a,u,f,g,x,I;return al(this,function(O){switch(O.label){case 0:switch(n=t,n){case"done":return[3,1];case"error":return[3,2];case"process":return[3,3]}return[3,8];case 1:return i.done(r),[3,9];case 2:return i.error(new Error(r.error)),[3,9];case 3:a=r.id,u=r.input,f=r.options,O.label=4;case 4:return O.trys.push([4,6,,7]),e.process?[4,e.process(u,f)]:(i.postMessage("error",{id:a,error:"Worker not set up to process on main thread"}),[2]);case 5:return g=O.sent(),i.postMessage("done",{id:a,result:g}),[3,7];case 6:return x=O.sent(),I=x instanceof Error?x.message:"unknown error",i.postMessage("error",{id:a,error:I}),[3,7];case 7:return[3,9];case 8:console.warn("process-on-worker: unknown message "+t),O.label=9;case 9:return[2]}})})}var _c=function(){function e(){this._values=[],this._settlers=[],this._closed=!1}return e.prototype[Symbol.asyncIterator]=function(){return this},e.prototype.push=function(i){return this.enqueue(i)},e.prototype.enqueue=function(i){if(this._closed)throw new Error("Closed");if(this._settlers.length>0){if(this._values.length>0)throw new Error("Illegal internal state");var t=this._settlers.shift();i instanceof Error?t.reject(i):t.resolve({value:i})}else this._values.push(i)},e.prototype.close=function(){for(;this._settlers.length>0;){var i=this._settlers.shift();i.resolve({done:!0})}this._closed=!0},e.prototype.next=function(){var i=this;if(this._values.length>0){var t=this._values.shift();return t instanceof Error?Promise.reject(t):Promise.resolve({done:!1,value:t})}if(this._closed){if(this._settlers.length>0)throw new Error("Illegal internal state");return Promise.resolve({done:!0,value:void 0})}return new Promise(function(r,n){i._settlers.push({resolve:r,reject:n})})},e}(),xh=null,xc=function(e,i,t,r){function n(a){return a instanceof t?a:new t(function(u){u(a)})}return new(t||(t=Promise))(function(a,u){function f(I){try{x(r.next(I))}catch(O){u(O)}}function g(I){try{x(r.throw(I))}catch(O){u(O)}}function x(I){I.done?a(I.value):n(I.value).then(f,g)}x((r=r.apply(e,i||[])).next())})},o0=function(e,i){var t={label:0,sent:function(){if(a[0]&1)throw a[1];return a[1]},trys:[],ops:[]},r,n,a,u;return u={next:f(0),throw:f(1),return:f(2)},typeof Symbol=="function"&&(u[Symbol.iterator]=function(){return this}),u;function f(x){return function(I){return g([x,I])}}function g(x){if(r)throw new TypeError("Generator is already executing.");for(;t;)try{if(r=1,n&&(a=x[0]&2?n.return:x[0]?n.throw||((a=n.return)&&a.call(n),0):n.next)&&!(a=a.call(n,x[1])).done)return a;switch(n=0,a&&(x=[x[0]&2,a.value]),x[0]){case 0:case 1:a=x;break;case 4:return t.label++,{value:x[1],done:!1};case 5:t.label++,n=x[1],x=[0];continue;case 7:x=t.ops.pop(),t.trys.pop();continue;default:if(a=t.trys,!(a=a.length>0&&a[a.length-1])&&(x[0]===6||x[0]===2)){t=0;continue}if(x[0]===3&&(!a||x[1]>a[0]&&x[1]<a[3])){t.label=x[1];break}if(x[0]===6&&t.label<a[1]){t.label=a[1],a=x;break}if(a&&t.label<a[2]){t.label=a[2],t.ops.push(x);break}a[2]&&t.ops.pop(),t.trys.pop();continue}x=i.call(e,t)}catch(I){x=[6,I],n=0}finally{r=a=0}if(x[0]&5)throw x[1];return{value:x[0]?x[1]:void 0,done:!0}}},tf=function(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i=e[Symbol.asyncIterator],t;return i?i.call(e):(e=typeof __values=="function"?__values(e):e[Symbol.iterator](),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(a){t[a]=e[a]&&function(u){return new Promise(function(f,g){u=e[a](u),n(f,g,u.done,u.value)})}}function n(a,u,f,g){Promise.resolve(g).then(function(x){a({value:x,done:f})},u)}},et=0,Ec,_f;function s0(e,i){var t=this;if(typeof self!="undefined"){var r={process:Nf};WorkerBody.onmessage=function(n,a){return xc(t,void 0,void 0,function(){var u,f,g,x,I,O,B,W,he,ae,Se;return o0(this,function(Fe){switch(Fe.label){case 0:switch(Fe.trys.push([0,19,,20]),u=n,u){case"process":return[3,1];case"process-in-batches":return[3,3];case"input-batch":return[3,16];case"input-done":return[3,17]}return[3,18];case 1:if(!e)throw new Error("Worker does not support atomic processing");return[4,e(a.input,a.options||{},r)];case 2:return f=Fe.sent(),WorkerBody.postMessage("done",{result:f}),[3,18];case 3:if(!i)throw new Error("Worker does not support batched processing");Ec=new AsyncQueue,_f=a.options||{},g=i(Ec,_f,r),Fe.label=4;case 4:Fe.trys.push([4,9,10,15]),x=tf(g),Fe.label=5;case 5:return[4,x.next()];case 6:if(I=Fe.sent(),!!I.done)return[3,8];O=I.value,WorkerBody.postMessage("output-batch",{result:O}),Fe.label=7;case 7:return[3,5];case 8:return[3,15];case 9:return B=Fe.sent(),ae={error:B},[3,15];case 10:return Fe.trys.push([10,,13,14]),I&&!I.done&&(Se=x.return)?[4,Se.call(x)]:[3,12];case 11:Fe.sent(),Fe.label=12;case 12:return[3,14];case 13:if(ae)throw ae.error;return[7];case 14:return[7];case 15:return WorkerBody.postMessage("done",{}),[3,18];case 16:return Ec.push(a.input),[3,18];case 17:return Ec.close(),[3,18];case 18:return[3,20];case 19:return W=Fe.sent(),he=W instanceof Error?W.message:"",WorkerBody.postMessage("error",{error:he}),[3,20];case 20:return[2]}})})}}}function Nf(e,i){return i===void 0&&(i={}),new Promise(function(t,r){var n=et++,a=function(f,g){if(g.id===n)switch(f){case"done":WorkerBody.removeEventListener(a),t(g.result);break;case"error":WorkerBody.removeEventListener(a),r(g.error);break;default:}};WorkerBody.addEventListener(a);var u={id:n,input:e,options:i};WorkerBody.postMessage("process",u)})}var rf=function(e,i,t,r){function n(a){return a instanceof t?a:new t(function(u){u(a)})}return new(t||(t=Promise))(function(a,u){function f(I){try{x(r.next(I))}catch(O){u(O)}}function g(I){try{x(r.throw(I))}catch(O){u(O)}}function x(I){I.done?a(I.value):n(I.value).then(f,g)}x((r=r.apply(e,i||[])).next())})},u0=function(e,i){var t={label:0,sent:function(){if(a[0]&1)throw a[1];return a[1]},trys:[],ops:[]},r,n,a,u;return u={next:f(0),throw:f(1),return:f(2)},typeof Symbol=="function"&&(u[Symbol.iterator]=function(){return this}),u;function f(x){return function(I){return g([x,I])}}function g(x){if(r)throw new TypeError("Generator is already executing.");for(;t;)try{if(r=1,n&&(a=x[0]&2?n.return:x[0]?n.throw||((a=n.return)&&a.call(n),0):n.next)&&!(a=a.call(n,x[1])).done)return a;switch(n=0,a&&(x=[x[0]&2,a.value]),x[0]){case 0:case 1:a=x;break;case 4:return t.label++,{value:x[1],done:!1};case 5:t.label++,n=x[1],x=[0];continue;case 7:x=t.ops.pop(),t.trys.pop();continue;default:if(a=t.trys,!(a=a.length>0&&a[a.length-1])&&(x[0]===6||x[0]===2)){t=0;continue}if(x[0]===3&&(!a||x[1]>a[0]&&x[1]<a[3])){t.label=x[1];break}if(x[0]===6&&t.label<a[1]){t.label=a[1],a=x;break}if(a&&t.label<a[2]){t.label=a[2],t.ops.push(x);break}a[2]&&t.ops.pop(),t.trys.pop();continue}x=i.call(e,t)}catch(I){x=[6,I],n=0}finally{r=a=0}if(x[0]&5)throw x[1];return{value:x[0]?x[1]:void 0,done:!0}}},xf={};function z0(e,i,t){return i===void 0&&(i=null),t===void 0&&(t={}),rf(this,void 0,void 0,function(){return u0(this,function(r){switch(r.label){case 0:return i&&(e=l0(e,i,t)),xf[e]=xf[e]||zu(e),[4,xf[e]];case 1:return[2,r.sent()]}})})}function l0(e,i,t){if(e.startsWith("http"))return e;var r=t.modules||{};return r[e]?r[e]:t.CDN?(assert(t.CDN.startsWith("http")),t.CDN+"/"+i+"/dist/libs/"+e):isWorker?"../src/libs/"+e:"modules/"+i+"/src/libs/"+e}function zu(e){return rf(this,void 0,void 0,function(){var i,t,r;return u0(this,function(n){switch(n.label){case 0:return e.endsWith("wasm")?[4,fetch(e)]:[3,3];case 1:return i=n.sent(),[4,i.arrayBuffer()];case 2:return[2,n.sent()];case 3:return isWorker?[2,importScripts(e)]:[4,fetch(e)];case 4:return t=n.sent(),[4,t.text()];case 5:return r=n.sent(),[2,Uo(r,e)]}})})}function Uo(e,i){if(isWorker)return eval.call(global,e),null;var t=document.createElement("script");t.id=i;try{t.appendChild(document.createTextNode(e))}catch(r){t.text=e}return document.body.appendChild(t),null}var Ff="0.0.3",Eh={id:"null",name:"null",module:"web-worker-helper",options:{}};function Bf(e){var i=e.color;return!i||!i.length?[1,1,1,1]:i}function Nl(e,i,t){return t.length===2?[t[0],t[1],0]:[t[0],t[1],t[2]]}function bc(e){var i=e.filter;return i?[1]:[0]}function nf(e,i){return[i]}var c0=C(80569),fa=C.n(c0),za=1e-6,Go=typeof Float32Array!="undefined"?Float32Array:Array,Zf=Math.random;function U0(e){Go=e}var zf=Math.PI/180;function f0(e){return e*zf}function Uf(e,i){return Math.abs(e-i)<=za*Math.max(1,Math.abs(e),Math.abs(i))}Math.hypot||(Math.hypot=function(){for(var e=0,i=arguments.length;i--;)e+=arguments[i]*arguments[i];return Math.sqrt(e)});function Xi(){var e=new Go(2);return Go!=Float32Array&&(e[0]=0,e[1]=0),e}function Gf(e){var i=new glMatrix.ARRAY_TYPE(2);return i[0]=e[0],i[1]=e[1],i}function Fl(e,i){var t=new Go(2);return t[0]=e,t[1]=i,t}function iu(e,i){return e[0]=i[0],e[1]=i[1],e}function nc(e,i,t){return e[0]=i,e[1]=t,e}function oo(e,i,t){return e[0]=i[0]+t[0],e[1]=i[1]+t[1],e}function Uu(e,i,t){return e[0]=i[0]-t[0],e[1]=i[1]-t[1],e}function Bl(e,i,t){return e[0]=i[0]*t[0],e[1]=i[1]*t[1],e}function Ef(e,i,t){return e[0]=i[0]/t[0],e[1]=i[1]/t[1],e}function Mo(e,i){return e[0]=Math.ceil(i[0]),e[1]=Math.ceil(i[1]),e}function ol(e,i){return e[0]=Math.floor(i[0]),e[1]=Math.floor(i[1]),e}function ls(e,i,t){return e[0]=Math.min(i[0],t[0]),e[1]=Math.min(i[1],t[1]),e}function ic(e,i,t){return e[0]=Math.max(i[0],t[0]),e[1]=Math.max(i[1],t[1]),e}function Sc(e,i){return e[0]=Math.round(i[0]),e[1]=Math.round(i[1]),e}function Zl(e,i,t){return e[0]=i[0]*t,e[1]=i[1]*t,e}function h0(e,i,t,r){return e[0]=i[0]+t[0]*r,e[1]=i[1]+t[1]*r,e}function jf(e,i){var t=i[0]-e[0],r=i[1]-e[1];return Math.hypot(t,r)}function af(e,i){var t=i[0]-e[0],r=i[1]-e[1];return t*t+r*r}function Vf(e){var i=e[0],t=e[1];return Math.hypot(i,t)}function Cc(e){var i=e[0],t=e[1];return i*i+t*t}function Tu(e,i){return e[0]=-i[0],e[1]=-i[1],e}function wc(e,i){return e[0]=1/i[0],e[1]=1/i[1],e}function Gu(e,i){var t=i[0],r=i[1],n=t*t+r*r;return n>0&&(n=1/Math.sqrt(n)),e[0]=i[0]*n,e[1]=i[1]*n,e}function sl(e,i){return e[0]*i[0]+e[1]*i[1]}function Tc(e,i,t){var r=i[0]*t[1]-i[1]*t[0];return e[0]=e[1]=0,e[2]=r,e}function Sl(e,i,t,r){var n=i[0],a=i[1];return e[0]=n+r*(t[0]-n),e[1]=a+r*(t[1]-a),e}function A0(e,i){i=i||1;var t=glMatrix.RANDOM()*2*Math.PI;return e[0]=Math.cos(t)*i,e[1]=Math.sin(t)*i,e}function G0(e,i,t){var r=i[0],n=i[1];return e[0]=t[0]*r+t[2]*n,e[1]=t[1]*r+t[3]*n,e}function ac(e,i,t){var r=i[0],n=i[1];return e[0]=t[0]*r+t[2]*n+t[4],e[1]=t[1]*r+t[3]*n+t[5],e}function bh(e,i,t){var r=i[0],n=i[1];return e[0]=t[0]*r+t[3]*n+t[6],e[1]=t[1]*r+t[4]*n+t[7],e}function Sh(e,i,t){var r=i[0],n=i[1];return e[0]=t[0]*r+t[4]*n+t[12],e[1]=t[1]*r+t[5]*n+t[13],e}function j0(e,i,t,r){var n=i[0]-t[0],a=i[1]-t[1],u=Math.sin(r),f=Math.cos(r);return e[0]=n*f-a*u+t[0],e[1]=n*u+a*f+t[1],e}function p0(e,i){var t=e[0],r=e[1],n=i[0],a=i[1],u=Math.sqrt(t*t+r*r)*Math.sqrt(n*n+a*a),f=u&&(t*n+r*a)/u;return Math.acos(Math.min(Math.max(f,-1),1))}function d0(e){return e[0]=0,e[1]=0,e}function Ch(e){return"vec2("+e[0]+", "+e[1]+")"}function mA(e,i){return e[0]===i[0]&&e[1]===i[1]}function V0(e,i){var t=e[0],r=e[1],n=i[0],a=i[1];return Math.abs(t-n)<=glMatrix.EPSILON*Math.max(1,Math.abs(t),Math.abs(n))&&Math.abs(r-a)<=glMatrix.EPSILON*Math.max(1,Math.abs(r),Math.abs(a))}var wh=null,oc=Uu,H0=null,bf=null,yA=null,_A=null,$0=null,Mc=function(){var e=Xi();return function(i,t,r,n,a,u){var f,g;for(t||(t=2),r||(r=0),n?g=Math.min(n*t+r,i.length):g=i.length,f=r;f<g;f+=t)e[0]=i[f],e[1]=i[f+1],a(e,e,u),i[f]=e[0],i[f+1]=e[1];return i}}(),Ic=Xi(),Sf=Xi(),Eo=Xi(),Ys=Xi(),zl=Xi();function sc(e,i,t,r,n){oo(e,t,r),Gu(e,e),i=Fl(-e[1],e[0]);var a=Fl(-t[1],t[0]);return[n/sl(i,a),i]}function ul(e,i){return nc(e,-i[1],i[0])}function Ul(e,i,t){return oc(e,i,t),Gu(e,e),e}function Lc(e,i){return e[0]===i[0]&&e[1]===i[1]}function of(e){for(var i=new Map,t=0;t<e.length;t++){var r=e[0].toString()+"-"+e[1].toString();i.get(r)?(e.splice(t,1),t++):i.set(r,r)}return e}var Gl=function(){function e(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};(0,ue.Z)(this,e),(0,Ce.Z)(this,"lastFlip",-1),(0,Ce.Z)(this,"miter",Fl(0,0)),(0,Ce.Z)(this,"started",!1),(0,Ce.Z)(this,"dash",!1),(0,Ce.Z)(this,"totalDistance",0),(0,Ce.Z)(this,"currentIndex",0),this.join=i.join||"miter",this.cap=i.cap||"butt",this.miterLimit=i.miterLimit||10,this.thickness=i.thickness||1,this.dash=i.dash||!1,this.complex={positions:[],indices:[],normals:[],startIndex:0,indexes:[]}}return(0,me.Z)(e,[{key:"extrude_gaode2",value:function(t,r){var n=this.complex;if(t.length<=1)return n;this.lastFlip=-1,this.started=!1,this.normal=null,this.totalDistance=0;for(var a=t.length,u=n.startIndex,f=1;f<a;f++){var g,x,I,O=t[f-1];O.push((g=r[f-1][2])!==null&&g!==void 0?g:0);var B=r[f-1],W=t[f];W.push((x=r[f][2])!==null&&x!==void 0?x:0);var he=r[f],ae=f<t.length-1?[].concat((0,Mr.Z)(t[f+1]),[(I=r[f+1][2])!==null&&I!==void 0?I:0]):null,Se=f<r.length-1?r[f+1]:null,Fe=this.segment_gaode2(n,u,O,W,ae,B,he,Se);u+=Fe}if(this.dash)for(var Qe=0;Qe<n.positions.length/6;Qe++)n.positions[Qe*6+5]=this.totalDistance;return n.startIndex=n.positions.length/6,n}},{key:"simpleExtrude_gaode2",value:function(t,r){var n=this.complex;if(t.length<=1)return n;this.lastFlip=-1,this.started=!1,this.normal=null,this.totalDistance=0;for(var a=t.length,u=n.startIndex,f=1;f<a;f++){var g,x,I,O=t[f-1];O.push((g=r[f-1][2])!==null&&g!==void 0?g:0);var B=r[f-1],W=t[f];W.push((x=r[f][2])!==null&&x!==void 0?x:0);var he=r[f],ae=f<t.length-1?[].concat((0,Mr.Z)(t[f+1]),[(I=r[f+1][2])!==null&&I!==void 0?I:0]):null,Se=f<r.length-1?r[f+1]:null,Fe=this.simpleSegment(n,u,O,W,ae,B,he,Se);u+=Fe}if(this.dash)for(var Qe=0;Qe<n.positions.length/6;Qe++)n.positions[Qe*6+5]=this.totalDistance;return n.startIndex=n.positions.length/6,n}},{key:"extrude",value:function(t){var r=this.complex;if(t.length<=1)return r;this.lastFlip=-1,this.started=!1,this.normal=null,this.totalDistance=0;for(var n=t.length,a=r.startIndex,u=1;u<n;u++){var f=t[u-1],g=t[u],x=u<t.length-1?t[u+1]:null,I=this.segment(r,a,f,g,x);a+=I}if(this.dash)for(var O=0;O<r.positions.length/6;O++)r.positions[O*6+5]=this.totalDistance;return r.startIndex=r.positions.length/6,r}},{key:"simpleExtrude",value:function(t){var r=this.complex;if(t.length<=1)return r;this.lastFlip=-1,this.started=!1,this.normal=null,this.totalDistance=0;for(var n=t.length,a=r.startIndex,u=1;u<n;u++){var f=t[u-1],g=t[u],x=u<t.length-1?t[u+1]:null,I=this.simpleSegment(r,a,f,g,x);a+=I}if(this.dash)for(var O=0;O<r.positions.length/6;O++)r.positions[O*6+5]=this.totalDistance;return r.startIndex=r.positions.length/6,r}},{key:"segment_gaode2",value:function(t,r,n,a,u,f,g,x){var I=0,O=t.indices,B=t.positions,W=t.normals,he=this.cap==="square",ae=this.join==="bevel",Se=va([g[0],g[1]]),Fe=va([f[0],f[1]]);Ul(Eo,a,n);var Qe=0;if(this.dash&&(Qe=this.lineSegmentDistance(Se,Fe),this.totalDistance+=Qe),this.normal||(this.normal=Xi(),ul(this.normal,Eo)),!this.started)if(this.started=!0,he){var qe=Xi(),yt=Xi();oo(qe,this.normal,Eo),oo(yt,this.normal,Eo),W.push(yt[0],yt[1],0),W.push(qe[0],qe[1],0),B.push(n[0],n[1],n[2]|0,this.totalDistance-Qe,-this.thickness,n[2]|0),this.complex.indexes.push(this.currentIndex),B.push(n[0],n[1],n[2]|0,this.totalDistance-Qe,this.thickness,n[2]|0),this.complex.indexes.push(this.currentIndex),this.currentIndex++}else this.extrusions(B,W,n,this.normal,this.thickness,this.totalDistance-Qe);if(O.push(r+0,r+1,r+2),u){Lc(a,u)&&oo(u,a,Gu(u,Uu(u,a,n))),Ul(Ys,u,a);var jt=sc(zl,Xi(),Eo,Ys,this.thickness),or=(0,vn.Z)(jt,2),ar=or[0],br=or[1],pr=sl(zl,this.normal)<0?-1:1,jr=ae;if(!jr&&this.join==="miter"){var nn=ar;nn>this.miterLimit&&(jr=!0)}jr?(W.push(this.normal[0],this.normal[1],0),W.push(br[0],br[1],0),B.push(a[0],a[1],a[2]|0,this.totalDistance,-this.thickness*pr,a[2]|0),this.complex.indexes.push(this.currentIndex),B.push(a[0],a[1],a[2]|0,this.totalDistance,this.thickness*pr,a[2]|0),this.complex.indexes.push(this.currentIndex),this.currentIndex++,O.push.apply(O,(0,Mr.Z)(this.lastFlip!==-pr?[r,r+2,r+3]:[r+2,r+1,r+3])),O.push(r+2,r+3,r+4),ul(Ic,Ys),iu(this.normal,Ic),W.push(this.normal[0],this.normal[1],0),B.push(a[0],a[1],a[2]|0,this.totalDistance,-this.thickness*pr,a[2]|0),this.complex.indexes.push(this.currentIndex),this.currentIndex++,I+=3):(this.extrusions(B,W,a,br,ar,this.totalDistance),O.push.apply(O,(0,Mr.Z)(this.lastFlip===1?[r,r+2,r+3]:[r+2,r+1,r+3])),pr=-1,iu(this.normal,br),I+=2),this.lastFlip=pr}else{if(ul(this.normal,Eo),he){var Et=Xi(),Ot=Xi();oc(Ot,Eo,this.normal),oo(Et,Eo,this.normal),W.push(Ot[0],Ot[1],0),W.push(Et[0],Et[1],0),B.push(a[0],a[1],a[2]|0,this.totalDistance,this.thickness,a[2]|0),this.complex.indexes.push(this.currentIndex),B.push(a[0],a[1],a[2]|0,this.totalDistance,this.thickness,a[2]|0),this.complex.indexes.push(this.currentIndex),this.currentIndex++}else this.extrusions(B,W,a,this.normal,this.thickness,this.totalDistance);O.push.apply(O,(0,Mr.Z)(this.lastFlip===1?[r,r+2,r+3]:[r+2,r+1,r+3])),I+=2}return I}},{key:"simpleSegment",value:function(t,r,n,a,u){var f=0,g=t.indices,x=t.positions,I=t.normals,O=va([a[0],a[1]]),B=va([n[0],n[1]]);Ul(Eo,O,B);var W=0;if(this.dash&&(W=this.lineSegmentDistance(O,B),this.totalDistance+=W),this.normal||(this.normal=Xi(),ul(this.normal,Eo)),this.started||(this.started=!0,this.extrusions(x,I,n,this.normal,this.thickness,this.totalDistance-W)),g.push(r+0,r+1,r+2),!u)ul(this.normal,Eo),this.extrusions(x,I,a,this.normal,this.thickness,this.totalDistance),g.push.apply(g,(0,Mr.Z)(this.lastFlip===1?[r,r+2,r+3]:[r+2,r+1,r+3])),f+=2;else{var he=va([u[0],u[1]]);Lc(O,he)&&oo(he,O,Gu(he,Uu(he,O,B))),Ul(Ys,he,O);var ae=sc(zl,Xi(),Eo,Ys,this.thickness),Se=(0,vn.Z)(ae,2),Fe=Se[0],Qe=Se[1],qe=sl(zl,this.normal)<0?-1:1;this.extrusions(x,I,a,Qe,Fe,this.totalDistance),g.push.apply(g,(0,Mr.Z)(this.lastFlip===1?[r,r+2,r+3]:[r+2,r+1,r+3])),qe=-1,iu(this.normal,Qe),f+=2,this.lastFlip=qe}return f}},{key:"segment",value:function(t,r,n,a,u){var f=0,g=t.indices,x=t.positions,I=t.normals,O=this.cap==="square",B=this.join==="bevel",W=va([a[0],a[1]]),he=va([n[0],n[1]]);Ul(Eo,W,he);var ae=0;if(this.dash&&(ae=this.lineSegmentDistance(W,he),this.totalDistance+=ae),this.normal||(this.normal=Xi(),ul(this.normal,Eo)),!this.started)if(this.started=!0,O){var Se=Xi(),Fe=Xi();oo(Se,this.normal,Eo),oo(Fe,this.normal,Eo),I.push(Fe[0],Fe[1],0),I.push(Se[0],Se[1],0),x.push(n[0],n[1],n[2]|0,this.totalDistance-ae,-this.thickness,n[2]|0),this.complex.indexes.push(this.currentIndex),x.push(n[0],n[1],n[2]|0,this.totalDistance-ae,this.thickness,n[2]|0),this.complex.indexes.push(this.currentIndex),this.currentIndex++}else this.extrusions(x,I,n,this.normal,this.thickness,this.totalDistance-ae);if(g.push(r+0,r+1,r+2),u){var yt=va([u[0],u[1]]);Lc(W,yt)&&oo(yt,W,Gu(yt,Uu(yt,W,he))),Ul(Ys,yt,W);var Et=sc(zl,Xi(),Eo,Ys,this.thickness),Ot=(0,vn.Z)(Et,2),jt=Ot[0],or=Ot[1],ar=sl(zl,this.normal)<0?-1:1,br=B;if(!br&&this.join==="miter"){var pr=jt;pr>this.miterLimit&&(br=!0)}br?(I.push(this.normal[0],this.normal[1],0),I.push(or[0],or[1],0),x.push(a[0],a[1],a[2]|0,this.totalDistance,-this.thickness*ar,a[2]|0),this.complex.indexes.push(this.currentIndex),x.push(a[0],a[1],a[2]|0,this.totalDistance,this.thickness*ar,a[2]|0),this.complex.indexes.push(this.currentIndex),this.currentIndex++,g.push.apply(g,(0,Mr.Z)(this.lastFlip!==-ar?[r,r+2,r+3]:[r+2,r+1,r+3])),g.push(r+2,r+3,r+4),ul(Ic,Ys),iu(this.normal,Ic),I.push(this.normal[0],this.normal[1],0),x.push(a[0],a[1],a[2]|0,this.totalDistance,-this.thickness*ar,a[2]|0),this.complex.indexes.push(this.currentIndex),this.currentIndex++,f+=3):(this.extrusions(x,I,a,or,jt,this.totalDistance),g.push.apply(g,(0,Mr.Z)(this.lastFlip===1?[r,r+2,r+3]:[r+2,r+1,r+3])),ar=-1,iu(this.normal,or),f+=2),this.lastFlip=ar}else{if(ul(this.normal,Eo),O){var Qe=Xi(),qe=Xi();oc(qe,Eo,this.normal),oo(Qe,Eo,this.normal),I.push(qe[0],qe[1],0),I.push(Qe[0],Qe[1],0),x.push(a[0],a[1],a[2]|0,this.totalDistance,this.thickness,a[2]|0),this.complex.indexes.push(this.currentIndex),x.push(a[0],a[1],a[2]|0,this.totalDistance,this.thickness,a[2]|0),this.complex.indexes.push(this.currentIndex),this.currentIndex++}else this.extrusions(x,I,a,this.normal,this.thickness,this.totalDistance);g.push.apply(g,(0,Mr.Z)(this.lastFlip===1?[r,r+2,r+3]:[r+2,r+1,r+3])),f+=2}return f}},{key:"extrusions",value:function(t,r,n,a,u,f){r.push(a[0],a[1],0),r.push(a[0],a[1],0),t.push(n[0],n[1],n[2]|0,f,-u,n[2]|0),this.complex.indexes.push(this.currentIndex),t.push(n[0],n[1],n[2]|0,f,u,n[2]|0),this.complex.indexes.push(this.currentIndex),this.currentIndex++}},{key:"lineSegmentDistance",value:function(t,r){var n=r[0]-t[0],a=r[1]-t[1];return Math.sqrt(n*n+a*a)}}]),e}();function Cl(e){var i=e.coordinates,t=e.originCoordinates,r=e.version,n=new Gl({dash:!0,join:"bevel"});if(r==="GAODE2.x"){var a=i;Array.isArray(a[0][0])||(a=[i]);var u=t;Array.isArray(u[0][0])||(u=[t]);for(var f=0;f<a.length;f++){var g=a[f],x=u[f];n.extrude_gaode2(g,x)}}else{var I=i;I[0]&&!Array.isArray(I[0][0])&&(I=[i]),I.forEach(function(B){n.extrude(B)})}var O=n.complex;return{vertices:O.positions,indices:O.indices,normals:O.normals,indexes:O.indexes,size:6}}function ha(e){var i=Is(e.coordinates);return{vertices:[].concat((0,Mr.Z)(i),(0,Mr.Z)(i),(0,Mr.Z)(i),(0,Mr.Z)(i)),indices:[0,1,2,2,3,0],size:i.length}}function Pc(e){var i=e.coordinates,t=fa().flatten(i),r=t.vertices,n=t.dimensions,a=t.holes,u=fa()(r,a,n);return{indices:u,vertices:r,size:n}}var jl=function(){var e=(0,ur.Z)(nt().mark(function i(t){var r,n,a,u,f,g,x,I,O;return nt().wrap(function(W){for(;;)switch(W.prev=W.next){case 0:return r=t.descriptors,n=t.features,a=t.enablePicking,u=t.iconMap,f={a_Color:Bf,a_Position:Nl,filter:bc,a_vertexId:nf,a_PickingColor:function(ae){var Se=ae.id;return a?bs(Se):[0,0,0]},a_DistanceAndIndex:function(ae,Se,Fe,Qe,qe,yt){return yt===void 0?[Fe[3],10]:[Fe[3],yt]},a_Total_Distance:function(ae,Se,Fe){return[Fe[5]]},a_Size:function(ae){var Se=ae.size,Fe=Se===void 0?1:Se;return Array.isArray(Fe)?[Fe[0],Fe[1]]:[Fe,0]},a_Normal:function(ae,Se,Fe,Qe,qe){return qe},a_Miter:function(ae,Se,Fe){return[Fe[4]]},a_iconMapUV:function(ae){var Se=ae.texture,Fe=u[Se]||{x:0,y:0},Qe=Fe.x,qe=Fe.y;return[Qe,qe]}},g={sizePerElement:0,elements:[]},x=0,I=[],O=3,n.forEach(function(he,ae){var Se=Cl(he),Fe=Se.indices,Qe=Se.vertices,qe=Se.normals,yt=Se.size,Et=Se.indexes;Fe.forEach(function(ar){I.push(ar+x)}),O=yt;var Ot=Qe.length/yt;g.sizePerElement=O,g.elements.push({featureIdx:ae,vertices:Qe,normals:qe,offset:x}),x+=Ot;for(var jt=function(br){var pr=(qe==null?void 0:qe.slice(br*3,br*3+3))||[],jr=Qe.slice(br*yt,br*yt+yt),nn=0;Et&&Et[br]!==void 0&&(nn=Et[br]),r.forEach(function(yn){if(yn&&f[yn.name]){var ma;(ma=yn.buffer.data).push.apply(ma,(0,Mr.Z)(f[yn.name](he,ae,jr,br,pr,nn)))}})},or=0;or<Ot;or++)jt(or)}),W.abrupt("return",{descriptors:r,featureLayout:g,indices:I});case 8:case"end":return W.stop()}},i)}));return function(t){return e.apply(this,arguments)}}(),uc=function(){var e=(0,ur.Z)(nt().mark(function i(t){var r,n,a,u,f,g,x,I,O;return nt().wrap(function(W){for(;;)switch(W.prev=W.next){case 0:return r=t.descriptors,n=t.features,a=t.enablePicking,u=t.shape2d,f={a_Color:Bf,a_Position:Nl,filter:bc,a_vertexId:nf,a_PickingColor:function(ae){var Se=ae.id;return a?bs(Se):[0,0,0]},a_Shape:function(ae){var Se=ae.shape,Fe=Se===void 0?2:Se,Qe=u.indexOf(Fe);return[Qe]},a_Extrude:function(ae,Se,Fe,Qe){var qe=[1,1,0,-1,1,0,-1,-1,0,1,-1,0],yt=Qe%4*3;return[qe[yt],qe[yt+1],qe[yt+2]]},a_Size:function(ae){var Se=ae.size,Fe=Se===void 0?5:Se;return Array.isArray(Fe)?[Fe[0]]:[Fe]}},g={sizePerElement:0,elements:[]},x=0,I=[],O=3,n.forEach(function(he,ae){var Se=ha(he),Fe=Se.indices,Qe=Se.vertices,qe=Se.normals,yt=Se.size,Et=Se.indexes;Fe.forEach(function(ar){I.push(ar+x)}),O=yt;var Ot=Qe.length/yt;g.sizePerElement=O,g.elements.push({featureIdx:ae,vertices:Qe,normals:qe,offset:x}),x+=Ot;for(var jt=function(br){var pr=(qe==null?void 0:qe.slice(br*3,br*3+3))||[],jr=Qe.slice(br*yt,br*yt+yt),nn=0;Et&&Et[br]!==void 0&&(nn=Et[br]),r.forEach(function(yn){if(yn&&f[yn.name]){var ma;(ma=yn.buffer.data).push.apply(ma,(0,Mr.Z)(f[yn.name](he,ae,jr,br,pr,nn)))}})},or=0;or<Ot;or++)jt(or)}),W.abrupt("return",{descriptors:r,featureLayout:g,indices:I});case 8:case"end":return W.stop()}},i)}));return function(t){return e.apply(this,arguments)}}(),Vl=function(){var e=(0,ur.Z)(nt().mark(function i(t){var r,n,a,u,f,g,x,I;return nt().wrap(function(B){for(;;)switch(B.prev=B.next){case 0:return r=t.descriptors,n=t.features,a=t.enablePicking,u={a_Color:Bf,a_Position:Nl,filter:bc,a_vertexId:nf,a_PickingColor:function(he){var ae=he.id;return a?bs(ae):[0,0,0]}},f={sizePerElement:0,elements:[]},g=0,x=[],I=3,n.forEach(function(W,he){var ae=Pc(W),Se=ae.indices,Fe=ae.vertices,Qe=ae.normals,qe=ae.size,yt=ae.indexes;Se.forEach(function(or){x.push(or+g)}),I=qe;var Et=Fe.length/qe;f.sizePerElement=I,f.elements.push({featureIdx:he,vertices:Fe,normals:Qe,offset:g}),g+=Et;for(var Ot=function(ar){var br=(Qe==null?void 0:Qe.slice(ar*3,ar*3+3))||[],pr=Fe.slice(ar*qe,ar*qe+qe),jr=0;yt&&yt[ar]!==void 0&&(jr=yt[ar]),r.forEach(function(nn){if(nn&&u[nn.name]){var yn;(yn=nn.buffer.data).push.apply(yn,(0,Mr.Z)(u[nn.name](W,he,pr,ar,br,jr)))}})},jt=0;jt<Et;jt++)Ot(jt)}),B.abrupt("return",{descriptors:r,featureLayout:f,indices:x});case 8:case"end":return B.stop()}},i)}));return function(t){return e.apply(this,arguments)}}(),Hl={pointFill:uc,line:jl,polygonFill:Vl},v0=(0,X.Z)({},Hl);function g0(e){return Xs.apply(this,arguments)}function Xs(){return Xs=_asyncToGenerator(_regeneratorRuntime.mark(function e(i){var t,r;return _regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(t=i.workerType,r=i.data,!v0[t]){a.next=3;break}return a.abrupt("return",v0[t](r));case 3:return a.abrupt("return",Promise.reject(new Error('Worker with type "'.concat(t,'" non-existent.'))));case 4:case"end":return a.stop()}},e)})),Xs.apply(this,arguments)}var Oc=new Map;function wl(e,i){Oc.set(e,i)}function ju(e){var i=Oc.get(e);return i}var Mu="l7-worker",Hf=3,au=!0;function sf(e){registerWorkerSource(Mu,e)}function $l(){var e=getWorkerSource(Mu);if(!e)throw new Error("get worker failed by workerName: ".concat(Mu,"."));return e}function Wl(e,i){return Ps.apply(this,arguments)}function Ps(){return Ps=_asyncToGenerator(_regeneratorRuntime.mark(function e(i,t){var r,n,a,u,f;return _regeneratorRuntime.wrap(function(x){for(;;)switch(x.prev=x.next){case 0:return r=$l(),n=WorkerFarm.getWorkerFarm({maxConcurrency:Hf,reuseWorkers:au}),a=n.getWorkerPool({name:Mu,source:r}),x.next=5,a.startJob(Mu,function(I,O,B){return I.done(B)});case 5:return u=x.sent,u.postMessage("process",{input:{workerType:i,data:t}}),x.next=9,u.result;case 9:return f=x.sent,x.abrupt("return",f.result);case 11:case"end":return x.stop()}},e)})),Ps.apply(this,arguments)}var Rc=C(19947),kc=C.n(Rc);function Tl(e,i){return e.map(function(t){return t[i]*1})}function m0(e){return e===void 0?!1:!Array.isArray(e)&&e.data!==void 0}function uf(e){return Array.isArray(e)?e.length===0?!1:!!m0(e[0]):!1}function lf(e){return Array.isArray(e)?e.length===0||typeof e[0]=="number":!1}function Cf(e){var i=Object.isFrozen(e)?In.cloneDeep(e):e;return kc()(i,!0),i}function ys(e,i){var t=i.x,r=i.y,n=i.x1,a=i.y1,u=i.coordinates,f=i.geometry,g=[];if(!Array.isArray(e))return{dataArray:[]};if(f)return e.filter(function(Fe){return Fe[f]&&Fe[f].type&&Fe[f].coordinates&&Fe[f].coordinates.length>0}).forEach(function(Fe,Qe){var qe=Cf(Fe[f]);(0,Ae.nG)(qe,function(yt){var Et=(0,Me.r7)(yt),Ot=(0,X.Z)((0,X.Z)({},Fe),{},{_id:Qe,coordinates:Et});g.push(Ot)})}),{dataArray:g};for(var x=0;x<e.length;x++){var I=e[x],O=[];if(u){var B="Polygon";Array.isArray(u[0])||(B="Point"),Array.isArray(u[0])&&!Array.isArray(u[0][0])&&(B="LineString");var W=Cf({type:B,coordinates:I[u]});O=W.coordinates}else if(t&&r&&n&&a){var he=[parseFloat(I[t]),parseFloat(I[r])],ae=[parseFloat(I[n]),parseFloat(I[a])];O=[he,ae]}else t&&r&&(O=[parseFloat(I[t]),parseFloat(I[r])]);var Se=(0,X.Z)((0,X.Z)({},I),{},{_id:x,coordinates:O});g.push(Se)}return{dataArray:g}}function ll(e,i){var t=_e(e);return ys(t,i)}var Ia=C(91002);function Jo(e){for(var i=e.toString(),t=5381,r=i.length;r;)t=t*33^i.charCodeAt(--r);return t>>>0}function lc(e,i){return i===void 0?null:(0,Ia.Z)(e.properties[i])*1==="number"?e.properties[i]*1:e.properties&&e.properties[i]?Jo(e.properties[i]+"")%1000019:null}function cl(e,i){var t=[],r={};return e.features?(e.features=e.features.filter(function(n){var a=n.geometry;return n!=null&&a&&a.type&&a.coordinates&&a.coordinates.length>0}),e=Cf(e),e.features.length===0?{dataArray:[],featureKeys:r}:((0,Ae.nG)(e,function(n,a){var u=lc(n,i==null?void 0:i.featureId);u===null&&(u=a);var f=u,g=(0,Me.r7)(n),x=(0,X.Z)((0,X.Z)({},n.properties),{},{coordinates:g,_id:f});t.push(x)}),{dataArray:t,featureKeys:r})):(e.features=[],{dataArray:[]})}function wf(e,i,t,r){for(var n=r,a=t-i>>1,u=t-i,f,g=e[i],x=e[i+1],I=e[t],O=e[t+1],B=i+3;B<t;B+=3){var W=W0(e[B],e[B+1],g,x,I,O);if(W>n)f=B,n=W;else if(W===n){var he=Math.abs(B-a);he<u&&(f=B,u=he)}}n>r&&(f-i>3&&wf(e,i,f,r),e[f+2]=n,t-f>3&&wf(e,f,t,r))}function W0(e,i,t,r,n,a){var u=n-t,f=a-r;if(u!==0||f!==0){var g=((e-t)*u+(i-r)*f)/(u*u+f*f);g>1?(t=n,r=a):g>0&&(t+=u*g,r+=f*g)}return u=e-t,f=i-r,u*u+f*f}function Dc(e,i,t,r){var n={id:typeof e=="undefined"?null:e,type:i,geometry:t,tags:r,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return Tf(n),n}function Tf(e){var i=e.geometry,t=e.type;if(t==="Point"||t==="MultiPoint"||t==="LineString")$f(e,i);else if(t==="Polygon"||t==="MultiLineString")for(var r=0;r<i.length;r++)$f(e,i[r]);else if(t==="MultiPolygon")for(r=0;r<i.length;r++)for(var n=0;n<i[r].length;n++)$f(e,i[r][n])}function $f(e,i){for(var t=0;t<i.length;t+=3)e.minX=Math.min(e.minX,i[t]),e.minY=Math.min(e.minY,i[t+1]),e.maxX=Math.max(e.maxX,i[t]),e.maxY=Math.max(e.maxY,i[t+1])}function Y0(e,i){var t=[];if(e.type==="FeatureCollection")for(var r=0;r<e.features.length;r++)cf(t,e.features[r],i,r);else e.type==="Feature"?cf(t,e,i):cf(t,{geometry:e},i);return t}function cf(e,i,t,r){if(i.geometry){var n=i.geometry.coordinates,a=i.geometry.type,u=Math.pow(t.tolerance/((1<<t.maxZoom)*t.extent),2),f=[],g=i.id;if(t.promoteId?g=i.properties[t.promoteId]:t.generateId&&(g=r||0),a==="Point")Mf(n,f);else if(a==="MultiPoint")for(var x=0;x<n.length;x++)Mf(n[x],f);else if(a==="LineString")Wa(n,f,u,!1);else if(a==="MultiLineString")if(t.lineMetrics){for(x=0;x<n.length;x++)f=[],Wa(n[x],f,u,!1),e.push(Dc(g,"LineString",f,i.properties));return}else Nc(n,f,u,!1);else if(a==="Polygon")Nc(n,f,u,!0);else if(a==="MultiPolygon")for(x=0;x<n.length;x++){var I=[];Nc(n[x],I,u,!0),f.push(I)}else if(a==="GeometryCollection"){for(x=0;x<i.geometry.geometries.length;x++)cf(e,{id:g,geometry:i.geometry.geometries[x],properties:i.properties},t,r);return}else throw new Error("Input data is not a valid GeoJSON object.");e.push(Dc(g,a,f,i.properties))}}function Mf(e,i){i.push(Yl(e[0])),i.push(Qs(e[1])),i.push(0)}function Wa(e,i,t,r){for(var n,a,u=0,f=0;f<e.length;f++){var g=Yl(e[f][0]),x=Qs(e[f][1]);i.push(g),i.push(x),i.push(0),f>0&&(r?u+=(n*x-g*a)/2:u+=Math.sqrt(Math.pow(g-n,2)+Math.pow(x-a,2))),n=g,a=x}var I=i.length-3;i[2]=1,wf(i,0,I,t),i[I+2]=1,i.size=Math.abs(u),i.start=0,i.end=i.size}function Nc(e,i,t,r){for(var n=0;n<e.length;n++){var a=[];Wa(e[n],a,t,r),i.push(a)}}function Yl(e){return e/360+.5}function Qs(e){var i=Math.sin(e*Math.PI/180),t=.5-.25*Math.log((1+i)/(1-i))/Math.PI;return t<0?0:t>1?1:t}function vu(e,i,t,r,n,a,u,f){if(t/=i,r/=i,a>=t&&u<r)return e;if(u<t||a>=r)return null;for(var g=[],x=0;x<e.length;x++){var I=e[x],O=I.geometry,B=I.type,W=n===0?I.minX:I.minY,he=n===0?I.maxX:I.maxY;if(W>=t&&he<r){g.push(I);continue}else if(he<t||W>=r)continue;var ae=[];if(B==="Point"||B==="MultiPoint")Os(O,ae,t,r,n);else if(B==="LineString")Wf(O,ae,t,r,n,!1,f.lineMetrics);else if(B==="MultiLineString")xe(O,ae,t,r,n,!1);else if(B==="Polygon")xe(O,ae,t,r,n,!0);else if(B==="MultiPolygon")for(var Se=0;Se<O.length;Se++){var Fe=[];xe(O[Se],Fe,t,r,n,!0),Fe.length&&ae.push(Fe)}if(ae.length){if(f.lineMetrics&&B==="LineString"){for(Se=0;Se<ae.length;Se++)g.push(Dc(I.id,B,ae[Se],I.tags));continue}(B==="LineString"||B==="MultiLineString")&&(ae.length===1?(B="LineString",ae=ae[0]):B="MultiLineString"),(B==="Point"||B==="MultiPoint")&&(B=ae.length===3?"Point":"MultiPoint"),g.push(Dc(I.id,B,ae,I.tags))}}return g.length?g:null}function Os(e,i,t,r,n){for(var a=0;a<e.length;a+=3){var u=e[a+n];u>=t&&u<=r&&(i.push(e[a]),i.push(e[a+1]),i.push(e[a+2]))}}function Wf(e,i,t,r,n,a,u){for(var f=y0(e),g=n===0?mt:nr,x=e.start,I,O,B=0;B<e.length-3;B+=3){var W=e[B],he=e[B+1],ae=e[B+2],Se=e[B+3],Fe=e[B+4],Qe=n===0?W:he,qe=n===0?Se:Fe,yt=!1;u&&(I=Math.sqrt(Math.pow(W-Se,2)+Math.pow(he-Fe,2))),Qe<t?qe>t&&(O=g(f,W,he,Se,Fe,t),u&&(f.start=x+I*O)):Qe>r?qe<r&&(O=g(f,W,he,Se,Fe,r),u&&(f.start=x+I*O)):Ke(f,W,he,ae),qe<t&&Qe>=t&&(O=g(f,W,he,Se,Fe,t),yt=!0),qe>r&&Qe<=r&&(O=g(f,W,he,Se,Fe,r),yt=!0),!a&&yt&&(u&&(f.end=x+I*O),i.push(f),f=y0(e)),u&&(x+=I)}var Et=e.length-3;W=e[Et],he=e[Et+1],ae=e[Et+2],Qe=n===0?W:he,Qe>=t&&Qe<=r&&Ke(f,W,he,ae),Et=f.length-3,a&&Et>=3&&(f[Et]!==f[0]||f[Et+1]!==f[1])&&Ke(f,f[0],f[1],f[2]),f.length&&i.push(f)}function y0(e){var i=[];return i.size=e.size,i.start=e.start,i.end=e.end,i}function xe(e,i,t,r,n,a){for(var u=0;u<e.length;u++)Wf(e[u],i,t,r,n,a,!1)}function Ke(e,i,t,r){e.push(i),e.push(t),e.push(r)}function mt(e,i,t,r,n,a){var u=(a-i)/(r-i);return e.push(a),e.push(t+(n-t)*u),e.push(1),u}function nr(e,i,t,r,n,a){var u=(a-t)/(n-t);return e.push(i+(r-i)*u),e.push(a),e.push(1),u}function Ar(e,i){var t=i.buffer/i.extent,r=e,n=vu(e,1,-1-t,t,0,-1,2,i),a=vu(e,1,1-t,2+t,0,-1,2,i);return(n||a)&&(r=vu(e,1,-t,1+t,0,-1,2,i)||[],n&&(r=er(n,1).concat(r)),a&&(r=r.concat(er(a,-1)))),r}function er(e,i){for(var t=[],r=0;r<e.length;r++){var n=e[r],a=n.type,u;if(a==="Point"||a==="MultiPoint"||a==="LineString")u=sr(n.geometry,i);else if(a==="MultiLineString"||a==="Polygon"){u=[];for(var f=0;f<n.geometry.length;f++)u.push(sr(n.geometry[f],i))}else if(a==="MultiPolygon")for(u=[],f=0;f<n.geometry.length;f++){for(var g=[],x=0;x<n.geometry[f].length;x++)g.push(sr(n.geometry[f][x],i));u.push(g)}t.push(Dc(n.id,a,u,n.tags))}return t}function sr(e,i){var t=[];t.size=e.size,e.start!==void 0&&(t.start=e.start,t.end=e.end);for(var r=0;r<e.length;r+=3)t.push(e[r]+i,e[r+1],e[r+2]);return t}function wr(e,i){if(e.transformed)return e;var t=1<<e.z,r=e.x,n=e.y,a,u,f;for(a=0;a<e.features.length;a++){var g=e.features[a],x=g.geometry,I=g.type;if(g.geometry=[],I===1)for(u=0;u<x.length;u+=2)g.geometry.push(Pr(x[u],x[u+1],i,t,r,n));else for(u=0;u<x.length;u++){var O=[];for(f=0;f<x[u].length;f+=2)O.push(Pr(x[u][f],x[u][f+1],i,t,r,n));g.geometry.push(O)}}return e.transformed=!0,e}function Pr(e,i,t,r,n,a){return[Math.round(t*(e*r-n)),Math.round(t*(i*r-a))]}function Nr(e,i,t,r,n){for(var a=i===n.maxZoom?0:n.tolerance/((1<<i)*n.extent),u={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:t,y:r,z:i,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},f=0;f<e.length;f++){u.numFeatures++,Dr(u,e[f],a,n);var g=e[f].minX,x=e[f].minY,I=e[f].maxX,O=e[f].maxY;g<u.minX&&(u.minX=g),x<u.minY&&(u.minY=x),I>u.maxX&&(u.maxX=I),O>u.maxY&&(u.maxY=O)}return u}function Dr(e,i,t,r){var n=i.geometry,a=i.type,u=[];if(a==="Point"||a==="MultiPoint")for(var f=0;f<n.length;f+=3)u.push(n[f]),u.push(n[f+1]),e.numPoints++,e.numSimplified++;else if(a==="LineString")Or(u,n,e,t,!1,!1);else if(a==="MultiLineString"||a==="Polygon")for(f=0;f<n.length;f++)Or(u,n[f],e,t,a==="Polygon",f===0);else if(a==="MultiPolygon")for(var g=0;g<n.length;g++){var x=n[g];for(f=0;f<x.length;f++)Or(u,x[f],e,t,!0,f===0)}if(u.length){var I=i.tags||null;if(a==="LineString"&&r.lineMetrics){I={};for(var O in i.tags)I[O]=i.tags[O];I.mapbox_clip_start=n.start/n.size,I.mapbox_clip_end=n.end/n.size}var B={geometry:u,type:a==="Polygon"||a==="MultiPolygon"?3:a==="LineString"||a==="MultiLineString"?2:1,tags:I};i.id!==null&&(B.id=i.id),e.features.push(B)}}function Or(e,i,t,r,n,a){var u=r*r;if(r>0&&i.size<(n?u:r)){t.numPoints+=i.length/3;return}for(var f=[],g=0;g<i.length;g+=3)(r===0||i[g+2]>u)&&(t.numSimplified++,f.push(i[g]),f.push(i[g+1])),t.numPoints++;n&&qr(f,a),e.push(f)}function qr(e,i){for(var t=0,r=0,n=e.length,a=n-2;r<n;a=r,r+=2)t+=(e[r]-e[a])*(e[r+1]+e[a+1]);if(t>0===i)for(r=0,n=e.length;r<n/2;r+=2){var u=e[r],f=e[r+1];e[r]=e[n-2-r],e[r+1]=e[n-1-r],e[n-2-r]=u,e[n-1-r]=f}}function Tr(e,i){return new Zr(e,i)}function Zr(e,i){i=this.options=lr(Object.create(this.options),i);var t=i.debug;if(t&&console.time("preprocess data"),i.maxZoom<0||i.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(i.promoteId&&i.generateId)throw new Error("promoteId and generateId cannot be used together.");var r=Y0(e,i);this.tiles={},this.tileCoords=[],t&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",i.indexMaxZoom,i.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),r=Ar(r,i),r.length&&this.splitTile(r,0,0,0),t&&(r.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}Zr.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},Zr.prototype.splitTile=function(e,i,t,r,n,a,u){for(var f=[e,i,t,r],g=this.options,x=g.debug;f.length;){r=f.pop(),t=f.pop(),i=f.pop(),e=f.pop();var I=1<<i,O=Vt(i,t,r),B=this.tiles[O];if(!B&&(x>1&&console.time("creation"),B=this.tiles[O]=Nr(e,i,t,r,g),this.tileCoords.push({z:i,x:t,y:r}),x)){x>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",i,t,r,B.numFeatures,B.numPoints,B.numSimplified),console.timeEnd("creation"));var W="z"+i;this.stats[W]=(this.stats[W]||0)+1,this.total++}if(B.source=e,n){if(i===g.maxZoom||i===n)continue;var he=1<<n-i;if(t!==Math.floor(a/he)||r!==Math.floor(u/he))continue}else if(i===g.indexMaxZoom||B.numPoints<=g.indexMaxPoints)continue;if(B.source=null,e.length!==0){x>1&&console.time("clipping");var ae=.5*g.buffer/g.extent,Se=.5-ae,Fe=.5+ae,Qe=1+ae,qe,yt,Et,Ot,jt,or;qe=yt=Et=Ot=null,jt=vu(e,I,t-ae,t+Fe,0,B.minX,B.maxX,g),or=vu(e,I,t+Se,t+Qe,0,B.minX,B.maxX,g),e=null,jt&&(qe=vu(jt,I,r-ae,r+Fe,1,B.minY,B.maxY,g),yt=vu(jt,I,r+Se,r+Qe,1,B.minY,B.maxY,g),jt=null),or&&(Et=vu(or,I,r-ae,r+Fe,1,B.minY,B.maxY,g),Ot=vu(or,I,r+Se,r+Qe,1,B.minY,B.maxY,g),or=null),x>1&&console.timeEnd("clipping"),f.push(qe||[],i+1,t*2,r*2),f.push(yt||[],i+1,t*2,r*2+1),f.push(Et||[],i+1,t*2+1,r*2),f.push(Ot||[],i+1,t*2+1,r*2+1)}}},Zr.prototype.getTile=function(e,i,t){var r=this.options,n=r.extent,a=r.debug;if(e<0||e>24)return null;var u=1<<e;i=(i%u+u)%u;var f=Vt(e,i,t);if(this.tiles[f])return wr(this.tiles[f],n);a>1&&console.log("drilling down to z%d-%d-%d",e,i,t);for(var g=e,x=i,I=t,O;!O&&g>0;)g--,x=Math.floor(x/2),I=Math.floor(I/2),O=this.tiles[Vt(g,x,I)];return!O||!O.source?null:(a>1&&console.log("found parent tile z%d-%d-%d",g,x,I),a>1&&console.time("drilling down"),this.splitTile(O.source,g,x,I,e,i,t),a>1&&console.timeEnd("drilling down"),this.tiles[f]?wr(this.tiles[f],n):null)};function Vt(e,i,t){return((1<<e)*t+i)*32+e}function lr(e,i){for(var t in i)e[t]=i[t];return e}var Rr=function(){function e(i,t,r,n){(0,ue.Z)(this,e),(0,Ce.Z)(this,"vectorLayerCache",{}),this.x=t,this.y=r,this.z=n,this.vectorTile=i}return(0,me.Z)(e,[{key:"getTileData",value:function(t){if(!t||!this.vectorTile.layers[t])return[];if(this.vectorLayerCache[t])return this.vectorLayerCache[t];var r=this.vectorTile.layers[t];return r.features}},{key:"getFeatureById",value:function(){throw new Error("Method not implemented.")}}]),e}(),tn={tileSize:256,minZoom:0,maxZoom:1/0,zoomOffset:0};function mr(e){for(var i=0,t=0,r=e.length,n=r-1,a,u;t<r;n=t++)a=e[t],u=e[n],i+=(u.x-a.x)*(a.y+u.y);return i}function cn(e){var i=e.length;if(i<=1)return[e];for(var t=[],r,n,a=0;a<i;a++){var u=mr(e[a]);u!==0&&(n===void 0&&(n=u<0),n===u<0?(r&&t.push(r),r=[e[a]]):r.push(e[a]))}return r&&t.push(r),t}var Cr=["Unknown","Point","LineString","Polygon"];function Hr(e,i,t,r,n){var a=n.geometry,u=n.type,f=n.tags,g=n.id,x=e*Math.pow(2,r),I=e*i,O=e*t,B=Cr[u],W,he;function ae(Qe){for(var qe=0;qe<Qe.length;qe++){var yt=Qe[qe];if(yt[3])break;var Et=180-(yt[1]+O)*360/x,Ot=(yt[0]+I)*360/x-180,jt=360/Math.PI*Math.atan(Math.exp(Et*Math.PI/180))-90;Qe[qe]=[Ot,jt,0,1]}}switch(u){case 1:var Se=[];for(W=0;W<a.length;W++)Se[W]=a[W][0];a=Se,ae(a);break;case 2:for(W=0;W<a.length;W++)ae(a[W]);break;case 3:for(a=cn(a),W=0;W<a.length;W++)for(he=0;he<a[W].length;he++)ae(a[W][he]);break}a.length===1?a=a[0]:B="Multi"+B;var Fe={type:"Feature",geometry:{type:B,coordinates:a},properties:f,id:g,tileOrigin:[0,0],coord:""};return Fe}var Er=function(){var e=(0,ur.Z)(nt().mark(function i(t,r,n,a){return nt().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return f.abrupt("return",new Promise(function(g){var x=r.getTile(t.z,t.x,t.y),I=x?x.features.map(function(W){return Hr(a,n.x,n.y,n.z,W)}):[],O={layers:{defaultLayer:{features:I}}},B=new Rr(O,t.x,t.y,t.z);g(B)}));case 1:case"end":return f.stop()}},i)}));return function(t,r,n,a){return e.apply(this,arguments)}}();function Yr(e){var i={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!0,debug:0};return e===void 0||typeof e.geojsonvtOptions=="undefined"?i:(0,X.Z)((0,X.Z)({},i),e.geojsonvtOptions)}function Cn(e,i){var t=Yr(i),r=t.extent||4096,n=Tr(e,t),a=function(g,x){return Er(x,n,g,r)},u=(0,X.Z)((0,X.Z)((0,X.Z)({},tn),i),{},{getTileData:a});return{data:e,dataArray:[],tilesetOptions:u,isTile:!0}}function Xn(e,i){var t=i.extent,r=t===void 0?[121.168,30.2828,121.384,30.4219]:t,n=i.requestParameters,a=n===void 0?{}:n,u=new Promise(function(g){e instanceof HTMLImageElement||yf(e)?g([e]):Ir(e,a,function(x){g(x)})}),f={originData:e,images:u,_id:1,dataArray:[{_id:0,coordinates:[[r[0],r[1]],[r[2],r[3]]]}]};return f}function Ir(e,i,t){var r=[];if(typeof e=="string")$e((0,X.Z)((0,X.Z)({},i),{},{url:e}),function(u,f){f&&(r.push(f),t(r))});else{var n=e.length,a=0;e.forEach(function(u){$e((0,X.Z)((0,X.Z)({},i),{},{url:u}),function(f,g){a++,g&&r.push(g),a===n&&t(r)})})}return Xn}var Fr=function(){var e=(0,ur.Z)(nt().mark(function i(t,r,n,a){var u,f;return nt().wrap(function(x){for(;;)switch(x.prev=x.next){case 0:return u={x:r.x,y:r.y,z:r.z},f=bl(t,u),x.abrupt("return",new Promise(function(I){a?a(u,function(O,B){if(O||!B){var W={layers:{defaultLayer:{features:[]}}},he=new Rr(W,r.x,r.y,r.z);I(he)}else{var ae={layers:{defaultLayer:{features:B.features}}},Se=new Rr(ae,r.x,r.y,r.z);I(Se)}}):Di((0,X.Z)((0,X.Z)({},n),{},{url:f}),function(O,B){if(O||!B){var W={layers:{defaultLayer:{features:[]}}},he=new Rr(W,r.x,r.y,r.z);I(he)}else{var ae=JSON.parse(B),Se={layers:{defaultLayer:{features:ae}}},Fe=new Rr(Se,r.x,r.y,r.z);I(Fe)}})}));case 3:case"end":return x.stop()}},i)}));return function(t,r,n,a){return e.apply(this,arguments)}}();function vr(e,i){var t=function(a,u){return Fr(e,u,i==null?void 0:i.requestParameters,i.getCustomData)},r=(0,X.Z)((0,X.Z)({},i),{},{getTileData:t});return{dataArray:[],tilesetOptions:r,isTile:!0}}var On=C(8332),Bn=C(88959),gn=C.n(Bn),xi=function(){function e(i,t,r,n){(0,ue.Z)(this,e),(0,Ce.Z)(this,"vectorLayerCache",{}),this.x=t,this.y=r,this.z=n,this.vectorTile=new On.VectorTile(new(gn())(i))}return(0,me.Z)(e,[{key:"getTileData",value:function(t){if(!t||!this.vectorTile.layers[t])return[];if(this.vectorLayerCache[t])return this.vectorLayerCache[t];var r=this.vectorTile.layers[t];if(Array.isArray(r.features))return this.vectorLayerCache[t]=r.features,r.features;for(var n=[],a=0;a<r.length;a++){var u=r.feature(a),f=u.toGeoJSON(this.x,this.y,this.z);n.push((0,X.Z)((0,X.Z)({},f),{},{properties:(0,X.Z)({id:f.id},f.properties)}))}return this.vectorLayerCache[t]=n,n}},{key:"getFeatureById",value:function(){throw new Error("Method not implemented.")}}]),e}(),Jn={tileSize:256,minZoom:0,maxZoom:1/0,zoomOffset:0,warp:!0},yi=function(){var e=(0,ur.Z)(nt().mark(function i(t,r,n,a,u){var f;return nt().wrap(function(x){for(;;)switch(x.prev=x.next){case 0:return f=bl(t,r),x.abrupt("return",new Promise(function(I){if(u)u({x:n.x,y:n.y,z:n.z},function(B,W){if(B||!W)I(void 0);else{var he=new xi(W,n.x,n.y,n.z);I(he)}});else{var O=sn((0,X.Z)((0,X.Z)({},a),{},{url:f}),function(B,W){if(B||!W)I(void 0);else{var he=new xi(W,n.x,n.y,n.z);I(he)}});n.xhrCancel=function(){return O.cancel()}}}));case 2:case"end":return x.stop()}},i)}));return function(t,r,n,a,u){return e.apply(this,arguments)}}();function ta(e,i){var t=Array.isArray(e)?e[0]:e,r=function(u,f){return yi(t,u,f,i==null?void 0:i.requestParameters,i==null?void 0:i.getCustomData)},n=(0,X.Z)((0,X.Z)((0,X.Z)({},Jn),i),{},{getTileData:r});return{data:t,dataArray:[],tilesetOptions:n,isTile:!0}}function bo(e,i,t){switch(e){case"+":return i+t;case"-":return i-t;case"*":return i*t;case"/":return i/t;case"%":return i%t;case"^":return Math.pow(i,t);case"abs":return Math.abs(i);case"floor":return Math.floor(i);case"round":return Math.round(i);case"ceil":return Math.ceil(i);case"sin":return Math.sin(i);case"cos":return Math.cos(i);case"atan":return t===-1?Math.atan(i):Math.atan2(i,t);case"min":return Math.min(i,t);case"max":return Math.max(i,t);case"log10":return Math.log(i);case"log2":return Math.log2(i);default:return console.warn("Calculate symbol err! Return default 0"),0}}function ro(e,i){for(var t=i[0],r=t.width,n=t.height,a=i.map(function(W){return W.rasterData}),u=r*n,f=[],g=JSON.stringify(e),x=0;x<u;x++){var I=JSON.parse(g),O=Ti(I,a,x);if(typeof O=="number")f.push(O);else{var B=Na(I);f.push(B)}}return f}function Ti(e,i,t){if(e.length===2&&e[0]==="band"&&typeof e[1]=="number")try{return i[e[1]][t]}catch(r){return console.warn("Raster Data err!"),0}e.map(function(r,n){if(Array.isArray(r)&&r.length>0)switch(r[0]){case"band":try{e[n]=i[r[1]][t]}catch(a){console.warn("Raster Data err!"),e[n]=0}break;default:Ti(r,i,t)}})}function Io(e){var i=(0,vn.Z)(e,3),t=i[0],r=i[1],n=r===void 0?-1:r,a=i[2],u=a===void 0?-1:a;if(t===void 0)return console.warn("Express err!"),["+",0,0];var f=t.replace(/\s+/g,"");return[f,n,u]}function Na(e){var i=Io(e),t=i[0],r=i[1],n=i[2];return Array.isArray(r)&&(r=Na(e[1])),Array.isArray(n)&&(n=Na(e[2])),bo(t,r,n)}var Ao={nd:{type:"operation",expression:["/",["-",["band",1],["band",0]],["+",["band",1],["band",0]]]},rgb:{type:"function",method:jo}};function jo(e,i){for(var t=e[0].rasterData,r=e[1].rasterData,n=e[2].rasterData,a=[],u=(i==null?void 0:i.countCut)||[2,98],f=(0,vn.Z)(u,2),g=f[0],x=f[1],I=(i==null?void 0:i.RMinMax)||Fa(t,g,x),O=(i==null?void 0:i.GMinMax)||Fa(r,g,x),B=(i==null?void 0:i.BMinMax)||Fa(n,g,x),W=0;W<t.length;W++)a.push(Math.max(0,t[W]-I[0])),a.push(Math.max(0,r[W]-O[0])),a.push(Math.max(0,n[W]-B[0]));return{rasterData:a,rMinMax:I,gMinMax:O,bMinMax:B}}function Fa(e,i,t){var r=e.slice().sort(function(f,g){return f-g}),n=r.length,a=r[Math.ceil(n*i/100)],u=r[Math.ceil(n*t/100)];return[a,u]}function Ua(e,i,t){return Tn.apply(this,arguments)}function Tn(){return Tn=(0,ur.Z)(nt().mark(function e(i,t,r){var n,a,u,f,g,x;return nt().wrap(function(O){for(;;)switch(O.prev=O.next){case 0:if(i.length!==0){O.next=2;break}return O.abrupt("return",{rasterData:[0],width:1,heigh:1});case 2:return O.next=4,Promise.all(i.map(function(B){var W=B.data,he=B.bands,ae=he===void 0?[0]:he;return t(W,ae)}));case 4:n=O.sent,a=[],n.forEach(function(B){Array.isArray(B)?a.push.apply(a,(0,Mr.Z)(B)):a.push(B)}),u=a[0],f=u.width,g=u.height,O.t0=(0,Ia.Z)(r),O.next=O.t0==="function"?11:O.t0==="object"?13:15;break;case 11:return x=r(a),O.abrupt("break",16);case 13:return Array.isArray(r)?x={rasterData:ro(r,a)}:x=ga(r,a),O.abrupt("break",16);case 15:x={rasterData:a[0].rasterData};case 16:return O.abrupt("return",(0,X.Z)((0,X.Z)({},x),{},{width:f,height:g}));case 17:case"end":return O.stop()}},e)})),Tn.apply(this,arguments)}function ga(e,i){var t=Ao[e.type];if(t.type==="function")return t.method(i,e==null?void 0:e.options);if(t.type==="operation")return e.type==="rgb"?un(t.expression,i):{rasterData:ro(t.expression,i)}}function un(e,i){e.r===void 0&&console.warn("Channel R lost in Operation! Use band[0] to fill!"),e.g===void 0&&console.warn("Channel G lost in Operation! Use band[0] to fill!"),e.b===void 0&&console.warn("Channel B lost in Operation! Use band[0] to fill!");var t=ro(e.r||["band",0],i),r=ro(e.g||["band",0],i),n=ro(e.b||["band",0],i);return[t,r,n]}function Aa(e,i,t,r){return ra.apply(this,arguments)}function ra(){return ra=(0,ur.Z)(nt().mark(function e(i,t,r,n){var a;return nt().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return f.next=2,Ua(i,t,r);case 2:a=f.sent,n(null,{data:a});case 4:case"end":return f.stop()}},e)})),ra.apply(this,arguments)}function Rn(e,i){var t=i.extent,r=i.width,n=i.height,a=i.min,u=i.max,f=i.format,g=i.operation,x,I,O;if(f===void 0||lf(e))x=Array.from(e),I=r,O=n;else{var B=Array.isArray(e)?e:[e];x=Ua(B,f,g)}var W={_id:1,dataArray:[{_id:1,data:x,width:I,height:O,min:a,max:u,coordinates:[[t[0],t[1]],[t[2],t[3]]]}]};return W}var gi=C(78892),dr=C(99311),Ri=C(11922),Xt={IEventEmitter:Symbol.for("IEventEmitter"),ISceneService:Symbol.for("ISceneService"),IGlobalConfigService:Symbol.for("IGlobalConfigService"),ICameraService:Symbol.for("ICameraService"),ICoordinateSystemService:Symbol.for("ICoordinateSystemService"),ILayerService:Symbol.for("ILayerService"),IDebugService:Symbol.for("IDebugService"),ILayerMappingService:Symbol.for("ILayerMappingService"),ILayerStyleService:Symbol.for("ILayerStyleService"),IMapService:Symbol.for("IMapService"),IMarkerService:Symbol.for("IMarkerService"),IPopupService:Symbol.for("PopupService"),IFactoryMapService:Symbol.for("Factory<IMapService>"),IRendererService:Symbol.for("IRendererService"),IShaderModuleService:Symbol.for("IShaderModuleService"),IIconService:Symbol.for("IIconService"),IFontService:Symbol.for("IFontService"),IInteractionService:Symbol.for("IInteractionService"),IPickingService:Symbol.for("IPickingService"),IControlService:Symbol.for("IControlService"),IStyleAttributeService:Symbol.for("IStyleAttributeService"),ILayer:Symbol.for("ILayer"),ILayerPlugin:Symbol.for("ILayerPlugin"),INormalPass:Symbol.for("INormalPass"),IPostProcessor:Symbol.for("IPostProcessor"),IPostProcessingPass:Symbol.for("IPostProcessingPass"),IFactoryPostProcessingPass:Symbol.for("Factory<IPostProcessingPass>"),IFactoryNormalPass:Symbol.for("Factory<IFactoryNormalPass>"),IMultiPassRenderer:Symbol.for("IMultiPassRenderer"),SceneID:Symbol.for("SceneID"),MapConfig:Symbol.for("MapConfig")},es=1e20,ct=function(){function e(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=i.fontSize,r=t===void 0?24:t,n=i.buffer,a=n===void 0?3:n,u=i.radius,f=u===void 0?8:u,g=i.cutoff,x=g===void 0?.25:g,I=i.fontFamily,O=I===void 0?"sans-serif":I,B=i.fontWeight,W=B===void 0?"normal":B,he=i.fontStyle,ae=he===void 0?"normal":he;(0,ue.Z)(this,e),(0,Ce.Z)(this,"buffer",void 0),(0,Ce.Z)(this,"cutoff",void 0),(0,Ce.Z)(this,"radius",void 0),(0,Ce.Z)(this,"size",void 0),(0,Ce.Z)(this,"ctx",void 0),(0,Ce.Z)(this,"gridOuter",void 0),(0,Ce.Z)(this,"gridInner",void 0),(0,Ce.Z)(this,"f",void 0),(0,Ce.Z)(this,"z",void 0),(0,Ce.Z)(this,"v",void 0),this.buffer=a,this.cutoff=x,this.radius=f;var Se=this.size=r+a*4,Fe=this._createCanvas(Se),Qe=this.ctx=Fe.getContext("2d",{willReadFrequently:!0});Qe.font="".concat(ae," ").concat(W," ").concat(r,"px ").concat(O),Qe.textBaseline="alphabetic",Qe.textAlign="left",Qe.fillStyle="black",this.gridOuter=new Float64Array(Se*Se),this.gridInner=new Float64Array(Se*Se),this.f=new Float64Array(Se),this.z=new Float64Array(Se+1),this.v=new Uint16Array(Se)}return(0,me.Z)(e,[{key:"_createCanvas",value:function(t){var r=document.createElement("canvas");return r.width=r.height=t,r}},{key:"draw",value:function(t){var r=this.ctx.measureText(t),n=r.width,a=r.actualBoundingBoxAscent,u=r.actualBoundingBoxDescent,f=r.actualBoundingBoxLeft,g=r.actualBoundingBoxRight,x=Math.ceil(a),I=0,O=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(g-f))),B=Math.min(this.size-this.buffer,x+Math.ceil(u)),W=O+2*this.buffer,he=B+2*this.buffer,ae=Math.max(W*he,0),Se=new Uint8ClampedArray(ae),Fe={data:Se,width:W,height:he,glyphWidth:O,glyphHeight:B,glyphTop:x,glyphLeft:I,glyphAdvance:n};if(O===0||B===0)return Fe;var Qe=this.buffer,qe=this.gridInner,yt=this.gridOuter,Et=this.ctx;Et.clearRect(Qe,Qe,O,B),Et.fillText(t,Qe,Qe+x);var Ot=Et.getImageData(Qe,Qe,O,B);yt.fill(es,0,ae),qe.fill(0,0,ae);for(var jt=0;jt<B;jt++)for(var or=0;or<O;or++){var ar=Ot.data[4*(jt*O+or)+3]/255;if(ar!==0){var br=(jt+Qe)*W+or+Qe;if(ar===1)yt[br]=0,qe[br]=es;else{var pr=.5-ar;yt[br]=pr>0?pr*pr:0,qe[br]=pr<0?pr*pr:0}}}ft(yt,0,0,W,he,W,this.f,this.v,this.z),ft(qe,Qe,Qe,O,B,W,this.f,this.v,this.z);for(var jr=0;jr<ae;jr++){var nn=Math.sqrt(yt[jr])-Math.sqrt(qe[jr]);Se[jr]=Math.round(255-255*(nn/this.radius+this.cutoff))}return Fe}}]),e}();function ft(e,i,t,r,n,a,u,f,g){for(var x=i;x<i+r;x++)xt(e,t*a+x,a,n,u,f,g);for(var I=t;I<t+n;I++)xt(e,I*a+i,1,r,u,f,g)}function xt(e,i,t,r,n,a,u){a[0]=0,u[0]=-es,u[1]=es,n[0]=e[i];for(var f=1,g=0,x=0;f<r;f++){n[f]=e[i+f*t];var I=f*f;do{var O=a[g];x=(n[f]-n[O]+I-O*O)/(f-O)/2}while(x<=u[g]&&--g>-1);g++,a[g]=f,u[g]=x,u[g+1]=es}for(var B=0,W=0;B<r;B++){for(;u[W+1]<B;)W++;var he=a[W],ae=B-he;e[i+B*t]=n[he]+ae*ae}}function Ur(e,i){var t=typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=Un(e))||i&&e&&typeof e.length=="number"){t&&(e=t);var r=0,n=function(){};return{s:n,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(x){throw x},f:n}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var a=!0,u=!1,f;return{s:function(){t=t.call(e)},n:function(){var x=t.next();return a=x.done,x},e:function(x){u=!0,f=x},f:function(){try{!a&&t.return!=null&&t.return()}finally{if(u)throw f}}}}function Un(e,i){if(e){if(typeof e=="string")return at(e,i);var t=Object.prototype.toString.call(e).slice(8,-1);if(t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set")return Array.from(e);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return at(e,i)}}function at(e,i){(i==null||i>e.length)&&(i=e.length);for(var t=0,r=new Array(i);t<i;t++)r[t]=e[t];return r}var We=30;function St(e){var i=e.characterSet,t=e.getFontWidth,r=e.fontHeight,n=e.buffer,a=e.maxCanvasWidth,u=e.mapping,f=u===void 0?{}:u,g=e.xOffset,x=g===void 0?0:g,I=e.yOffset,O=I===void 0?0:I,B=0,W=x;Array.from(i).forEach(function(ae,Se){if(!f[ae]){var Fe=t(ae,Se);W+We>a&&(W=0,B++),f[ae]={x:W,y:O+B*We,width:We,height:We,advance:Fe},W+=We}});var he=r+n*2;return{mapping:f,xOffset:W,yOffset:O+B*he,canvasHeight:h(O+(B+1)*he)}}function kt(e,i,t){var r=0,n=0,a=0,u=[],f={},g=Ur(e),x;try{for(g.s();!(x=g.n()).done;){var I=x.value;if(!f[I.id]){var O=I.size;r+O+i>t&&(Ft(f,u,n),r=0,n=a+n+i,a=0,u=[]),u.push({icon:I,xOffset:r}),r=r+O+i,a=Math.max(a,O)}}}catch(W){g.e(W)}finally{g.f()}u.length>0&&Ft(f,u,n);var B=h(a+n+i);return{mapping:f,canvasHeight:B}}function Ft(e,i,t){var r=Ur(i),n;try{for(r.s();!(n=r.n()).done;){var a=n.value,u=a.icon,f=a.xOffset;e[u.id]=(0,X.Z)((0,X.Z)({},u),{},{x:f,y:t,image:u.image,width:u.width,height:u.height})}}catch(g){r.e(g)}finally{r.f()}}function h(e){return Math.pow(2,Math.ceil(Math.log2(e)))}var c,p;function m(e,i){var t=typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=E(e))||i&&e&&typeof e.length=="number"){t&&(e=t);var r=0,n=function(){};return{s:n,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(x){throw x},f:n}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var a=!0,u=!1,f;return{s:function(){t=t.call(e)},n:function(){var x=t.next();return a=x.done,x},e:function(x){u=!0,f=x},f:function(){try{!a&&t.return!=null&&t.return()}finally{if(u)throw f}}}}function E(e,i){if(e){if(typeof e=="string")return S(e,i);var t=Object.prototype.toString.call(e).slice(8,-1);if(t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set")return Array.from(e);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return S(e,i)}}function S(e,i){(i==null||i>e.length)&&(i=e.length);for(var t=0,r=new Array(i);t<i;t++)r[t]=e[t];return r}function M(e){var i=k();return function(){var r=(0,oe.Z)(e),n;if(i){var a=(0,oe.Z)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return(0,Ze.Z)(this,n)}}function k(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var V=Wt(),te="sans-serif",ve="normal",Ne=24,ut=3,gt=.25,rt=8,_t=1024,$t=1,qt=1,Yt=3,rr=null;function Wt(){for(var e=[],i=32;i<128;i++)e.push(String.fromCharCode(i));return e}function rn(e,i,t,r){e.font="".concat(r," ").concat(t,"px ").concat(i),e.fillStyle="black",e.textBaseline="middle"}function En(e,i){for(var t=0;t<e.length;t++)i.data[4*t+3]=e[t]}var Kr=(c=(0,dr.b2)(),c(p=function(e){(0,ke.Z)(t,e);var i=M(t);function t(){var r;(0,ue.Z)(this,t);for(var n=arguments.length,a=new Array(n),u=0;u<n;u++)a[u]=arguments[u];return r=i.call.apply(i,[this].concat(a)),(0,Ce.Z)((0,bt.Z)(r),"fontAtlas",void 0),(0,Ce.Z)((0,bt.Z)(r),"iconFontMap",void 0),(0,Ce.Z)((0,bt.Z)(r),"iconFontGlyphs",{}),(0,Ce.Z)((0,bt.Z)(r),"fontOptions",void 0),(0,Ce.Z)((0,bt.Z)(r),"key",void 0),(0,Ce.Z)((0,bt.Z)(r),"cache",new Qo(Yt)),r}return(0,me.Z)(t,[{key:"scale",get:function(){return qt}},{key:"canvas",get:function(){var n=this.cache.get(this.key);return n&&n.data}},{key:"mapping",get:function(){var n=this.cache.get(this.key);return n&&n.mapping||{}}},{key:"getCanvasByKey",value:function(n){var a=this.cache.get(n);return a&&a.data}},{key:"getMappingByKey",value:function(n){var a=this.cache.get(n);return a&&a.mapping||{}}},{key:"init",value:function(){this.cache.clear(),this.fontOptions={fontFamily:te,fontWeight:ve,characterSet:V,fontSize:Ne,buffer:ut,sdf:!0,cutoff:gt,radius:rt,iconfont:!1},this.key="",this.iconFontMap=new Map}},{key:"addIconGlyphs",value:function(n){var a=this;n.forEach(function(u){a.iconFontGlyphs[u.name]=u.unicode})}},{key:"addIconFont",value:function(n,a){this.iconFontMap.set(n,a)}},{key:"getIconFontKey",value:function(n){return this.iconFontMap.get(n)||n}},{key:"getGlyph",value:function(n){return this.iconFontGlyphs[n]?String.fromCharCode(parseInt(this.iconFontGlyphs[n],16)):""}},{key:"setFontOptions",value:function(n){this.fontOptions=(0,X.Z)((0,X.Z)({},this.fontOptions),n),this.key=this.getKey();var a=this.getNewChars(this.key,this.fontOptions.characterSet),u=this.cache.get(this.key);if(!(u&&a.length===0)){var f=this.generateFontAtlas(this.key,a,u);this.fontAtlas=f,this.cache.set(this.key,f)}}},{key:"addFontFace",value:function(n,a){var u=this,f=document.createElement("style");f.type="text/css",f.innerText=`
        @font-face{
            font-family: '`.concat(n,`';
            src: url('`).concat(a,`') format('woff2'),
            url('`).concat(a,`') format('woff'),
            url('`).concat(a,`') format('truetype');
        }`),f.onload=function(){if(document.fonts)try{document.fonts.load("24px ".concat(n),"L7text"),document.fonts.ready.then(function(){u.emit("fontloaded",{fontFamily:n})})}catch(g){console.warn("\u5F53\u524D\u73AF\u5883\u4E0D\u652F\u6301 document.fonts !"),console.warn("\u5F53\u524D\u73AF\u5883\u4E0D\u652F\u6301 iconfont !"),console.warn(g)}},document.getElementsByTagName("head")[0].appendChild(f)}},{key:"destroy",value:function(){this.cache.clear(),this.iconFontMap.clear()}},{key:"generateFontAtlas",value:function(n,a,u){var f=this.fontOptions,g=f.fontFamily,x=f.fontWeight,I=f.fontSize,O=f.buffer,B=f.sdf,W=f.radius,he=f.cutoff,ae=f.iconfont,Se=u&&u.data;Se||(Se=window.document.createElement("canvas"),Se.width=_t);var Fe=Se.getContext("2d",{willReadFrequently:!0});rn(Fe,g,I,x);var Qe=St((0,X.Z)({getFontWidth:function(Wg){return Fe.measureText(Wg).width},fontHeight:I*qt,buffer:O,characterSet:a,maxCanvasWidth:_t},u&&{mapping:u.mapping,xOffset:u.xOffset,yOffset:u.yOffset})),qe=Qe.mapping,yt=Qe.canvasHeight,Et=Qe.xOffset,Ot=Qe.yOffset,jt=Fe.getImageData(0,0,Se.width,Se.height);if(Se.height=yt,Fe.putImageData(jt,0,0),rn(Fe,g,I,x),B){var or=new ct({fontSize:I,buffer:O,radius:W,cutoff:he,fontFamily:g,fontWeight:x}),ar=m(a),br;try{for(ar.s();!(br=ar.n()).done;){var pr=br.value,jr=void 0;if(ae){var nn=String.fromCharCode(parseInt(pr.replace("&#x","").replace(";",""),16));jr=or.draw(nn)}else jr=or.draw(pr);var yn=jr,ma=yn.data,Ho=yn.width,Lo=yn.height,Rs=Fe.getImageData(0,0,Ho,Lo);En(ma,Rs),Fe.putImageData(Rs,qe[pr].x,qe[pr].y)}}catch(gA){ar.e(gA)}finally{ar.f()}}else{var ks=m(a),Wc;try{for(ks.s();!(Wc=ks.n()).done;){var Rp=Wc.value;Fe.fillText(Rp,qe[Rp].x,qe[Rp].y+I*$t)}}catch(gA){ks.e(gA)}finally{ks.f()}}return{xOffset:Et,yOffset:Ot,mapping:qe,data:Se,width:Se.width,height:Se.height}}},{key:"getKey",value:function(){var n=this.fontOptions,a=n.fontFamily,u=n.fontWeight;return"".concat(a,"_").concat(u)}},{key:"getNewChars",value:function(n,a){var u=this.cache.get(n);if(!u)return a;var f=[],g=u.mapping,x=new Set(Object.keys(g)),I=new Set(a);return I.forEach(function(O){x.has(O)||f.push(O)}),f}}]),t}(xa.EventEmitter))||p),pn,La;function oa(e){var i=pa();return function(){var r=(0,oe.Z)(e),n;if(i){var a=(0,oe.Z)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return(0,Ze.Z)(this,n)}}function pa(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var Vi=3,ui=1024,ki=64,Ya=(pn=(0,dr.b2)(),pn(La=function(e){(0,ke.Z)(t,e);var i=oa(t);function t(){var r;(0,ue.Z)(this,t);for(var n=arguments.length,a=new Array(n),u=0;u<n;u++)a[u]=arguments[u];return r=i.call.apply(i,[this].concat(a)),(0,Ce.Z)((0,bt.Z)(r),"canvasHeight",128),(0,Ce.Z)((0,bt.Z)(r),"texture",void 0),(0,Ce.Z)((0,bt.Z)(r),"canvas",void 0),(0,Ce.Z)((0,bt.Z)(r),"iconData",void 0),(0,Ce.Z)((0,bt.Z)(r),"iconMap",void 0),(0,Ce.Z)((0,bt.Z)(r),"ctx",void 0),(0,Ce.Z)((0,bt.Z)(r),"loadingImageCount",0),r}return(0,me.Z)(t,[{key:"isLoading",value:function(){return this.loadingImageCount===0}},{key:"init",value:function(){this.iconData=[],this.iconMap={},this.canvas=window.document.createElement("canvas"),this.canvas.width=128,this.canvas.height=128,this.ctx=this.canvas.getContext("2d")}},{key:"addImage",value:function(){var r=(0,ur.Z)(nt().mark(function a(u,f){var g,x;return nt().wrap(function(O){for(;;)switch(O.prev=O.next){case 0:return g=new Image,this.loadingImageCount++,this.hasImage(u)?console.warn("Image Id already exists"):this.iconData.push({id:u,size:ki}),this.updateIconMap(),O.next=6,this.loadImage(f);case 6:g=O.sent,x=this.iconData.find(function(B){return B.id===u}),x&&(x.image=g,x.width=g.width,x.height=g.height),this.update();case 10:case"end":return O.stop()}},a,this)}));function n(a,u){return r.apply(this,arguments)}return n}()},{key:"addImageMini",value:function(n,a,u){var f=this,g=u.getSceneConfig().canvas,x=g.createImage();if(this.loadingImageCount++,this.hasImage(n))throw new Error("Image Id already exists");this.iconData.push({id:n,size:ki}),this.updateIconMap(),this.loadImageMini(a,g).then(function(I){x=I;var O=f.iconData.find(function(B){return B.id===n});O&&(O.image=x,O.width=x.width,O.height=x.height),f.update()})}},{key:"getTexture",value:function(){return this.texture}},{key:"getIconMap",value:function(){return this.iconMap}},{key:"getCanvas",value:function(){return this.canvas}},{key:"hasImage",value:function(n){return this.iconMap.hasOwnProperty(n)}},{key:"removeImage",value:function(n){this.hasImage(n)&&(this.iconData=this.iconData.filter(function(a){return a.id!==n}),delete this.iconMap[n],this.update())}},{key:"destroy",value:function(){this.removeAllListeners("imageUpdate"),this.iconData=[],this.iconMap={}}},{key:"loadImage",value:function(n){return new Promise(function(a,u){if(n instanceof HTMLImageElement){a(n);return}var f=new Image;f.crossOrigin="anonymous",f.onload=function(){a(f)},f.onerror=function(){u(new Error("Could not load image at "+n))},f.src=n instanceof File?URL.createObjectURL(n):n})}},{key:"update",value:function(){this.updateIconMap(),this.updateIconAtlas(),this.loadingImageCount--,this.loadingImageCount===0&&this.emit("imageUpdate")}},{key:"updateIconAtlas",value:function(){var n=this;this.canvas.width=ui,this.canvas.height=this.canvasHeight,Object.keys(this.iconMap).forEach(function(a){var u=n.iconMap[a],f=u.x,g=u.y,x=u.image,I=u.width,O=I===void 0?64:I,B=u.height,W=B===void 0?64:B,he=Math.max(O,W),ae=he/ki,Se=W/ae,Fe=O/ae;x&&n.ctx.drawImage(x,f+(ki-Fe)/2,g+(ki-Se)/2,Fe,Se)})}},{key:"updateIconMap",value:function(){var n=kt(this.iconData,Vi,ui),a=n.mapping,u=n.canvasHeight;this.iconMap=a,this.canvasHeight=u}},{key:"loadImageMini",value:function(n,a){return new Promise(function(u,f){var g=a.createImage();g.crossOrigin="anonymous",g.onload=function(){u(g)},g.onerror=function(){f(new Error("Could not load image at "+n))},g.src=n})}}]),t}(xa.EventEmitter))||La);function Qn(){var e=new Go(16);return Go!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0),e[0]=1,e[5]=1,e[10]=1,e[15]=1,e}function Xa(e){var i=new Go(16);return i[0]=e[0],i[1]=e[1],i[2]=e[2],i[3]=e[3],i[4]=e[4],i[5]=e[5],i[6]=e[6],i[7]=e[7],i[8]=e[8],i[9]=e[9],i[10]=e[10],i[11]=e[11],i[12]=e[12],i[13]=e[13],i[14]=e[14],i[15]=e[15],i}function Iu(e,i){return e[0]=i[0],e[1]=i[1],e[2]=i[2],e[3]=i[3],e[4]=i[4],e[5]=i[5],e[6]=i[6],e[7]=i[7],e[8]=i[8],e[9]=i[9],e[10]=i[10],e[11]=i[11],e[12]=i[12],e[13]=i[13],e[14]=i[14],e[15]=i[15],e}function X0(e,i,t,r,n,a,u,f,g,x,I,O,B,W,he,ae){var Se=new Go(16);return Se[0]=e,Se[1]=i,Se[2]=t,Se[3]=r,Se[4]=n,Se[5]=a,Se[6]=u,Se[7]=f,Se[8]=g,Se[9]=x,Se[10]=I,Se[11]=O,Se[12]=B,Se[13]=W,Se[14]=he,Se[15]=ae,Se}function xA(e,i,t,r,n,a,u,f,g,x,I,O,B,W,he,ae,Se){return e[0]=i,e[1]=t,e[2]=r,e[3]=n,e[4]=a,e[5]=u,e[6]=f,e[7]=g,e[8]=x,e[9]=I,e[10]=O,e[11]=B,e[12]=W,e[13]=he,e[14]=ae,e[15]=Se,e}function uv(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function Th(e,i){if(e===i){var t=i[1],r=i[2],n=i[3],a=i[6],u=i[7],f=i[11];e[1]=i[4],e[2]=i[8],e[3]=i[12],e[4]=t,e[6]=i[9],e[7]=i[13],e[8]=r,e[9]=a,e[11]=i[14],e[12]=n,e[13]=u,e[14]=f}else e[0]=i[0],e[1]=i[4],e[2]=i[8],e[3]=i[12],e[4]=i[1],e[5]=i[5],e[6]=i[9],e[7]=i[13],e[8]=i[2],e[9]=i[6],e[10]=i[10],e[11]=i[14],e[12]=i[3],e[13]=i[7],e[14]=i[11],e[15]=i[15];return e}function kp(e,i){var t=i[0],r=i[1],n=i[2],a=i[3],u=i[4],f=i[5],g=i[6],x=i[7],I=i[8],O=i[9],B=i[10],W=i[11],he=i[12],ae=i[13],Se=i[14],Fe=i[15],Qe=t*f-r*u,qe=t*g-n*u,yt=t*x-a*u,Et=r*g-n*f,Ot=r*x-a*f,jt=n*x-a*g,or=I*ae-O*he,ar=I*Se-B*he,br=I*Fe-W*he,pr=O*Se-B*ae,jr=O*Fe-W*ae,nn=B*Fe-W*Se,yn=Qe*nn-qe*jr+yt*pr+Et*br-Ot*ar+jt*or;return yn?(yn=1/yn,e[0]=(f*nn-g*jr+x*pr)*yn,e[1]=(n*jr-r*nn-a*pr)*yn,e[2]=(ae*jt-Se*Ot+Fe*Et)*yn,e[3]=(B*Ot-O*jt-W*Et)*yn,e[4]=(g*br-u*nn-x*ar)*yn,e[5]=(t*nn-n*br+a*ar)*yn,e[6]=(Se*yt-he*jt-Fe*qe)*yn,e[7]=(I*jt-B*yt+W*qe)*yn,e[8]=(u*jr-f*br+x*or)*yn,e[9]=(r*br-t*jr-a*or)*yn,e[10]=(he*Ot-ae*yt+Fe*Qe)*yn,e[11]=(O*yt-I*Ot-W*Qe)*yn,e[12]=(f*ar-u*pr-g*or)*yn,e[13]=(t*pr-r*ar+n*or)*yn,e[14]=(ae*qe-he*Et-Se*Qe)*yn,e[15]=(I*Et-O*qe+B*Qe)*yn,e):null}function Yg(e,i){var t=i[0],r=i[1],n=i[2],a=i[3],u=i[4],f=i[5],g=i[6],x=i[7],I=i[8],O=i[9],B=i[10],W=i[11],he=i[12],ae=i[13],Se=i[14],Fe=i[15];return e[0]=f*(B*Fe-W*Se)-O*(g*Fe-x*Se)+ae*(g*W-x*B),e[1]=-(r*(B*Fe-W*Se)-O*(n*Fe-a*Se)+ae*(n*W-a*B)),e[2]=r*(g*Fe-x*Se)-f*(n*Fe-a*Se)+ae*(n*x-a*g),e[3]=-(r*(g*W-x*B)-f*(n*W-a*B)+O*(n*x-a*g)),e[4]=-(u*(B*Fe-W*Se)-I*(g*Fe-x*Se)+he*(g*W-x*B)),e[5]=t*(B*Fe-W*Se)-I*(n*Fe-a*Se)+he*(n*W-a*B),e[6]=-(t*(g*Fe-x*Se)-u*(n*Fe-a*Se)+he*(n*x-a*g)),e[7]=t*(g*W-x*B)-u*(n*W-a*B)+I*(n*x-a*g),e[8]=u*(O*Fe-W*ae)-I*(f*Fe-x*ae)+he*(f*W-x*O),e[9]=-(t*(O*Fe-W*ae)-I*(r*Fe-a*ae)+he*(r*W-a*O)),e[10]=t*(f*Fe-x*ae)-u*(r*Fe-a*ae)+he*(r*x-a*f),e[11]=-(t*(f*W-x*O)-u*(r*W-a*O)+I*(r*x-a*f)),e[12]=-(u*(O*Se-B*ae)-I*(f*Se-g*ae)+he*(f*B-g*O)),e[13]=t*(O*Se-B*ae)-I*(r*Se-n*ae)+he*(r*B-n*O),e[14]=-(t*(f*Se-g*ae)-u*(r*Se-n*ae)+he*(r*g-n*f)),e[15]=t*(f*B-g*O)-u*(r*B-n*O)+I*(r*g-n*f),e}function EA(e){var i=e[0],t=e[1],r=e[2],n=e[3],a=e[4],u=e[5],f=e[6],g=e[7],x=e[8],I=e[9],O=e[10],B=e[11],W=e[12],he=e[13],ae=e[14],Se=e[15],Fe=i*u-t*a,Qe=i*f-r*a,qe=i*g-n*a,yt=t*f-r*u,Et=t*g-n*u,Ot=r*g-n*f,jt=x*he-I*W,or=x*ae-O*W,ar=x*Se-B*W,br=I*ae-O*he,pr=I*Se-B*he,jr=O*Se-B*ae;return Fe*jr-Qe*pr+qe*br+yt*ar-Et*or+Ot*jt}function Ga(e,i,t){var r=i[0],n=i[1],a=i[2],u=i[3],f=i[4],g=i[5],x=i[6],I=i[7],O=i[8],B=i[9],W=i[10],he=i[11],ae=i[12],Se=i[13],Fe=i[14],Qe=i[15],qe=t[0],yt=t[1],Et=t[2],Ot=t[3];return e[0]=qe*r+yt*f+Et*O+Ot*ae,e[1]=qe*n+yt*g+Et*B+Ot*Se,e[2]=qe*a+yt*x+Et*W+Ot*Fe,e[3]=qe*u+yt*I+Et*he+Ot*Qe,qe=t[4],yt=t[5],Et=t[6],Ot=t[7],e[4]=qe*r+yt*f+Et*O+Ot*ae,e[5]=qe*n+yt*g+Et*B+Ot*Se,e[6]=qe*a+yt*x+Et*W+Ot*Fe,e[7]=qe*u+yt*I+Et*he+Ot*Qe,qe=t[8],yt=t[9],Et=t[10],Ot=t[11],e[8]=qe*r+yt*f+Et*O+Ot*ae,e[9]=qe*n+yt*g+Et*B+Ot*Se,e[10]=qe*a+yt*x+Et*W+Ot*Fe,e[11]=qe*u+yt*I+Et*he+Ot*Qe,qe=t[12],yt=t[13],Et=t[14],Ot=t[15],e[12]=qe*r+yt*f+Et*O+Ot*ae,e[13]=qe*n+yt*g+Et*B+Ot*Se,e[14]=qe*a+yt*x+Et*W+Ot*Fe,e[15]=qe*u+yt*I+Et*he+Ot*Qe,e}function qs(e,i,t){var r=t[0],n=t[1],a=t[2],u,f,g,x,I,O,B,W,he,ae,Se,Fe;return i===e?(e[12]=i[0]*r+i[4]*n+i[8]*a+i[12],e[13]=i[1]*r+i[5]*n+i[9]*a+i[13],e[14]=i[2]*r+i[6]*n+i[10]*a+i[14],e[15]=i[3]*r+i[7]*n+i[11]*a+i[15]):(u=i[0],f=i[1],g=i[2],x=i[3],I=i[4],O=i[5],B=i[6],W=i[7],he=i[8],ae=i[9],Se=i[10],Fe=i[11],e[0]=u,e[1]=f,e[2]=g,e[3]=x,e[4]=I,e[5]=O,e[6]=B,e[7]=W,e[8]=he,e[9]=ae,e[10]=Se,e[11]=Fe,e[12]=u*r+I*n+he*a+i[12],e[13]=f*r+O*n+ae*a+i[13],e[14]=g*r+B*n+Se*a+i[14],e[15]=x*r+W*n+Fe*a+i[15]),e}function So(e,i,t){var r=t[0],n=t[1],a=t[2];return e[0]=i[0]*r,e[1]=i[1]*r,e[2]=i[2]*r,e[3]=i[3]*r,e[4]=i[4]*n,e[5]=i[5]*n,e[6]=i[6]*n,e[7]=i[7]*n,e[8]=i[8]*a,e[9]=i[9]*a,e[10]=i[10]*a,e[11]=i[11]*a,e[12]=i[12],e[13]=i[13],e[14]=i[14],e[15]=i[15],e}function Xl(e,i,t,r){var n=r[0],a=r[1],u=r[2],f=Math.hypot(n,a,u),g,x,I,O,B,W,he,ae,Se,Fe,Qe,qe,yt,Et,Ot,jt,or,ar,br,pr,jr,nn,yn,ma;return f<za?null:(f=1/f,n*=f,a*=f,u*=f,g=Math.sin(t),x=Math.cos(t),I=1-x,O=i[0],B=i[1],W=i[2],he=i[3],ae=i[4],Se=i[5],Fe=i[6],Qe=i[7],qe=i[8],yt=i[9],Et=i[10],Ot=i[11],jt=n*n*I+x,or=a*n*I+u*g,ar=u*n*I-a*g,br=n*a*I-u*g,pr=a*a*I+x,jr=u*a*I+n*g,nn=n*u*I+a*g,yn=a*u*I-n*g,ma=u*u*I+x,e[0]=O*jt+ae*or+qe*ar,e[1]=B*jt+Se*or+yt*ar,e[2]=W*jt+Fe*or+Et*ar,e[3]=he*jt+Qe*or+Ot*ar,e[4]=O*br+ae*pr+qe*jr,e[5]=B*br+Se*pr+yt*jr,e[6]=W*br+Fe*pr+Et*jr,e[7]=he*br+Qe*pr+Ot*jr,e[8]=O*nn+ae*yn+qe*ma,e[9]=B*nn+Se*yn+yt*ma,e[10]=W*nn+Fe*yn+Et*ma,e[11]=he*nn+Qe*yn+Ot*ma,i!==e&&(e[12]=i[12],e[13]=i[13],e[14]=i[14],e[15]=i[15]),e)}function cc(e,i,t){var r=Math.sin(t),n=Math.cos(t),a=i[4],u=i[5],f=i[6],g=i[7],x=i[8],I=i[9],O=i[10],B=i[11];return i!==e&&(e[0]=i[0],e[1]=i[1],e[2]=i[2],e[3]=i[3],e[12]=i[12],e[13]=i[13],e[14]=i[14],e[15]=i[15]),e[4]=a*n+x*r,e[5]=u*n+I*r,e[6]=f*n+O*r,e[7]=g*n+B*r,e[8]=x*n-a*r,e[9]=I*n-u*r,e[10]=O*n-f*r,e[11]=B*n-g*r,e}function Q0(e,i,t){var r=Math.sin(t),n=Math.cos(t),a=i[0],u=i[1],f=i[2],g=i[3],x=i[8],I=i[9],O=i[10],B=i[11];return i!==e&&(e[4]=i[4],e[5]=i[5],e[6]=i[6],e[7]=i[7],e[12]=i[12],e[13]=i[13],e[14]=i[14],e[15]=i[15]),e[0]=a*n-x*r,e[1]=u*n-I*r,e[2]=f*n-O*r,e[3]=g*n-B*r,e[8]=a*r+x*n,e[9]=u*r+I*n,e[10]=f*r+O*n,e[11]=g*r+B*n,e}function q0(e,i,t){var r=Math.sin(t),n=Math.cos(t),a=i[0],u=i[1],f=i[2],g=i[3],x=i[4],I=i[5],O=i[6],B=i[7];return i!==e&&(e[8]=i[8],e[9]=i[9],e[10]=i[10],e[11]=i[11],e[12]=i[12],e[13]=i[13],e[14]=i[14],e[15]=i[15]),e[0]=a*n+x*r,e[1]=u*n+I*r,e[2]=f*n+O*r,e[3]=g*n+B*r,e[4]=x*n-a*r,e[5]=I*n-u*r,e[6]=O*n-f*r,e[7]=B*n-g*r,e}function Yf(e,i){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=i[0],e[13]=i[1],e[14]=i[2],e[15]=1,e}function K0(e,i){return e[0]=i[0],e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=i[1],e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=i[2],e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function If(e,i,t){var r=t[0],n=t[1],a=t[2],u=Math.hypot(r,n,a),f,g,x;return u<za?null:(u=1/u,r*=u,n*=u,a*=u,f=Math.sin(i),g=Math.cos(i),x=1-g,e[0]=r*r*x+g,e[1]=n*r*x+a*f,e[2]=a*r*x-n*f,e[3]=0,e[4]=r*n*x-a*f,e[5]=n*n*x+g,e[6]=a*n*x+r*f,e[7]=0,e[8]=r*a*x+n*f,e[9]=n*a*x-r*f,e[10]=a*a*x+g,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e)}function ff(e,i){var t=Math.sin(i),r=Math.cos(i);return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=r,e[6]=t,e[7]=0,e[8]=0,e[9]=-t,e[10]=r,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function hf(e,i){var t=Math.sin(i),r=Math.cos(i);return e[0]=r,e[1]=0,e[2]=-t,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=t,e[9]=0,e[10]=r,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function bA(e,i){var t=Math.sin(i),r=Math.cos(i);return e[0]=r,e[1]=t,e[2]=0,e[3]=0,e[4]=-t,e[5]=r,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function SA(e,i,t){var r=i[0],n=i[1],a=i[2],u=i[3],f=r+r,g=n+n,x=a+a,I=r*f,O=r*g,B=r*x,W=n*g,he=n*x,ae=a*x,Se=u*f,Fe=u*g,Qe=u*x;return e[0]=1-(W+ae),e[1]=O+Qe,e[2]=B-Fe,e[3]=0,e[4]=O-Qe,e[5]=1-(I+ae),e[6]=he+Se,e[7]=0,e[8]=B+Fe,e[9]=he-Se,e[10]=1-(I+W),e[11]=0,e[12]=t[0],e[13]=t[1],e[14]=t[2],e[15]=1,e}function Dp(e,i){var t=new Go(3),r=-i[0],n=-i[1],a=-i[2],u=i[3],f=i[4],g=i[5],x=i[6],I=i[7],O=r*r+n*n+a*a+u*u;return O>0?(t[0]=(f*u+I*r+g*a-x*n)*2/O,t[1]=(g*u+I*n+x*r-f*a)*2/O,t[2]=(x*u+I*a+f*n-g*r)*2/O):(t[0]=(f*u+I*r+g*a-x*n)*2,t[1]=(g*u+I*n+x*r-f*a)*2,t[2]=(x*u+I*a+f*n-g*r)*2),SA(e,i,t),e}function Np(e,i){return e[0]=i[12],e[1]=i[13],e[2]=i[14],e}function CA(e,i){var t=i[0],r=i[1],n=i[2],a=i[4],u=i[5],f=i[6],g=i[8],x=i[9],I=i[10];return e[0]=Math.hypot(t,r,n),e[1]=Math.hypot(a,u,f),e[2]=Math.hypot(g,x,I),e}function lv(e,i){var t=new Go(3);CA(t,i);var r=1/t[0],n=1/t[1],a=1/t[2],u=i[0]*r,f=i[1]*n,g=i[2]*a,x=i[4]*r,I=i[5]*n,O=i[6]*a,B=i[8]*r,W=i[9]*n,he=i[10]*a,ae=u+I+he,Se=0;return ae>0?(Se=Math.sqrt(ae+1)*2,e[3]=.25*Se,e[0]=(O-W)/Se,e[1]=(B-g)/Se,e[2]=(f-x)/Se):u>I&&u>he?(Se=Math.sqrt(1+u-I-he)*2,e[3]=(O-W)/Se,e[0]=.25*Se,e[1]=(f+x)/Se,e[2]=(B+g)/Se):I>he?(Se=Math.sqrt(1+I-u-he)*2,e[3]=(B-g)/Se,e[0]=(f+x)/Se,e[1]=.25*Se,e[2]=(O+W)/Se):(Se=Math.sqrt(1+he-u-I)*2,e[3]=(f-x)/Se,e[0]=(B+g)/Se,e[1]=(O+W)/Se,e[2]=.25*Se),e}function cv(e,i,t,r){var n=i[0],a=i[1],u=i[2],f=i[3],g=n+n,x=a+a,I=u+u,O=n*g,B=n*x,W=n*I,he=a*x,ae=a*I,Se=u*I,Fe=f*g,Qe=f*x,qe=f*I,yt=r[0],Et=r[1],Ot=r[2];return e[0]=(1-(he+Se))*yt,e[1]=(B+qe)*yt,e[2]=(W-Qe)*yt,e[3]=0,e[4]=(B-qe)*Et,e[5]=(1-(O+Se))*Et,e[6]=(ae+Fe)*Et,e[7]=0,e[8]=(W+Qe)*Ot,e[9]=(ae-Fe)*Ot,e[10]=(1-(O+he))*Ot,e[11]=0,e[12]=t[0],e[13]=t[1],e[14]=t[2],e[15]=1,e}function Ml(e,i,t,r,n){var a=i[0],u=i[1],f=i[2],g=i[3],x=a+a,I=u+u,O=f+f,B=a*x,W=a*I,he=a*O,ae=u*I,Se=u*O,Fe=f*O,Qe=g*x,qe=g*I,yt=g*O,Et=r[0],Ot=r[1],jt=r[2],or=n[0],ar=n[1],br=n[2],pr=(1-(ae+Fe))*Et,jr=(W+yt)*Et,nn=(he-qe)*Et,yn=(W-yt)*Ot,ma=(1-(B+Fe))*Ot,Ho=(Se+Qe)*Ot,Lo=(he+qe)*jt,Rs=(Se-Qe)*jt,ks=(1-(B+ae))*jt;return e[0]=pr,e[1]=jr,e[2]=nn,e[3]=0,e[4]=yn,e[5]=ma,e[6]=Ho,e[7]=0,e[8]=Lo,e[9]=Rs,e[10]=ks,e[11]=0,e[12]=t[0]+or-(pr*or+yn*ar+Lo*br),e[13]=t[1]+ar-(jr*or+ma*ar+Rs*br),e[14]=t[2]+br-(nn*or+Ho*ar+ks*br),e[15]=1,e}function fv(e,i){var t=i[0],r=i[1],n=i[2],a=i[3],u=t+t,f=r+r,g=n+n,x=t*u,I=r*u,O=r*f,B=n*u,W=n*f,he=n*g,ae=a*u,Se=a*f,Fe=a*g;return e[0]=1-O-he,e[1]=I+Fe,e[2]=B-Se,e[3]=0,e[4]=I-Fe,e[5]=1-x-he,e[6]=W+ae,e[7]=0,e[8]=B+Se,e[9]=W-ae,e[10]=1-x-O,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function Fp(e,i,t,r,n,a,u){var f=1/(t-i),g=1/(n-r),x=1/(a-u);return e[0]=a*2*f,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=a*2*g,e[6]=0,e[7]=0,e[8]=(t+i)*f,e[9]=(n+r)*g,e[10]=(u+a)*x,e[11]=-1,e[12]=0,e[13]=0,e[14]=u*a*2*x,e[15]=0,e}function hv(e,i,t,r,n){var a=1/Math.tan(i/2),u;return e[0]=a/t,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=a,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=-1,e[12]=0,e[13]=0,e[15]=0,n!=null&&n!==1/0?(u=1/(r-n),e[10]=(n+r)*u,e[14]=2*n*r*u):(e[10]=-1,e[14]=-2*r),e}var Xf=hv;function Mh(e,i,t,r,n){var a=1/Math.tan(i/2),u;return e[0]=a/t,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=a,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=-1,e[12]=0,e[13]=0,e[15]=0,n!=null&&n!==1/0?(u=1/(r-n),e[10]=n*u,e[14]=n*r*u):(e[10]=-1,e[14]=-r),e}function Ih(e,i,t,r){var n=Math.tan(i.upDegrees*Math.PI/180),a=Math.tan(i.downDegrees*Math.PI/180),u=Math.tan(i.leftDegrees*Math.PI/180),f=Math.tan(i.rightDegrees*Math.PI/180),g=2/(u+f),x=2/(n+a);return e[0]=g,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=x,e[6]=0,e[7]=0,e[8]=-((u-f)*g*.5),e[9]=(n-a)*x*.5,e[10]=r/(t-r),e[11]=-1,e[12]=0,e[13]=0,e[14]=r*t/(t-r),e[15]=0,e}function J0(e,i,t,r,n,a,u){var f=1/(i-t),g=1/(r-n),x=1/(a-u);return e[0]=-2*f,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*g,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=2*x,e[11]=0,e[12]=(i+t)*f,e[13]=(n+r)*g,e[14]=(u+a)*x,e[15]=1,e}var Lh=J0;function Ph(e,i,t,r,n,a,u){var f=1/(i-t),g=1/(r-n),x=1/(a-u);return e[0]=-2*f,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*g,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=x,e[11]=0,e[12]=(i+t)*f,e[13]=(n+r)*g,e[14]=a*x,e[15]=1,e}function eh(e,i,t,r){var n,a,u,f,g,x,I,O,B,W,he=i[0],ae=i[1],Se=i[2],Fe=r[0],Qe=r[1],qe=r[2],yt=t[0],Et=t[1],Ot=t[2];return Math.abs(he-yt)<za&&Math.abs(ae-Et)<za&&Math.abs(Se-Ot)<za?uv(e):(I=he-yt,O=ae-Et,B=Se-Ot,W=1/Math.hypot(I,O,B),I*=W,O*=W,B*=W,n=Qe*B-qe*O,a=qe*I-Fe*B,u=Fe*O-Qe*I,W=Math.hypot(n,a,u),W?(W=1/W,n*=W,a*=W,u*=W):(n=0,a=0,u=0),f=O*u-B*a,g=B*n-I*u,x=I*a-O*n,W=Math.hypot(f,g,x),W?(W=1/W,f*=W,g*=W,x*=W):(f=0,g=0,x=0),e[0]=n,e[1]=f,e[2]=I,e[3]=0,e[4]=a,e[5]=g,e[6]=O,e[7]=0,e[8]=u,e[9]=x,e[10]=B,e[11]=0,e[12]=-(n*he+a*ae+u*Se),e[13]=-(f*he+g*ae+x*Se),e[14]=-(I*he+O*ae+B*Se),e[15]=1,e)}function Oh(e,i,t,r){var n=i[0],a=i[1],u=i[2],f=r[0],g=r[1],x=r[2],I=n-t[0],O=a-t[1],B=u-t[2],W=I*I+O*O+B*B;W>0&&(W=1/Math.sqrt(W),I*=W,O*=W,B*=W);var he=g*B-x*O,ae=x*I-f*B,Se=f*O-g*I;return W=he*he+ae*ae+Se*Se,W>0&&(W=1/Math.sqrt(W),he*=W,ae*=W,Se*=W),e[0]=he,e[1]=ae,e[2]=Se,e[3]=0,e[4]=O*Se-B*ae,e[5]=B*he-I*Se,e[6]=I*ae-O*he,e[7]=0,e[8]=I,e[9]=O,e[10]=B,e[11]=0,e[12]=n,e[13]=a,e[14]=u,e[15]=1,e}function wA(e){return"mat4("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+", "+e[8]+", "+e[9]+", "+e[10]+", "+e[11]+", "+e[12]+", "+e[13]+", "+e[14]+", "+e[15]+")"}function TA(e){return Math.hypot(e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8],e[9],e[10],e[11],e[12],e[13],e[14],e[15])}function MA(e,i,t){return e[0]=i[0]+t[0],e[1]=i[1]+t[1],e[2]=i[2]+t[2],e[3]=i[3]+t[3],e[4]=i[4]+t[4],e[5]=i[5]+t[5],e[6]=i[6]+t[6],e[7]=i[7]+t[7],e[8]=i[8]+t[8],e[9]=i[9]+t[9],e[10]=i[10]+t[10],e[11]=i[11]+t[11],e[12]=i[12]+t[12],e[13]=i[13]+t[13],e[14]=i[14]+t[14],e[15]=i[15]+t[15],e}function IA(e,i,t){return e[0]=i[0]-t[0],e[1]=i[1]-t[1],e[2]=i[2]-t[2],e[3]=i[3]-t[3],e[4]=i[4]-t[4],e[5]=i[5]-t[5],e[6]=i[6]-t[6],e[7]=i[7]-t[7],e[8]=i[8]-t[8],e[9]=i[9]-t[9],e[10]=i[10]-t[10],e[11]=i[11]-t[11],e[12]=i[12]-t[12],e[13]=i[13]-t[13],e[14]=i[14]-t[14],e[15]=i[15]-t[15],e}function Bp(e,i,t){return e[0]=i[0]*t,e[1]=i[1]*t,e[2]=i[2]*t,e[3]=i[3]*t,e[4]=i[4]*t,e[5]=i[5]*t,e[6]=i[6]*t,e[7]=i[7]*t,e[8]=i[8]*t,e[9]=i[9]*t,e[10]=i[10]*t,e[11]=i[11]*t,e[12]=i[12]*t,e[13]=i[13]*t,e[14]=i[14]*t,e[15]=i[15]*t,e}function Vu(e,i,t,r){return e[0]=i[0]+t[0]*r,e[1]=i[1]+t[1]*r,e[2]=i[2]+t[2]*r,e[3]=i[3]+t[3]*r,e[4]=i[4]+t[4]*r,e[5]=i[5]+t[5]*r,e[6]=i[6]+t[6]*r,e[7]=i[7]+t[7]*r,e[8]=i[8]+t[8]*r,e[9]=i[9]+t[9]*r,e[10]=i[10]+t[10]*r,e[11]=i[11]+t[11]*r,e[12]=i[12]+t[12]*r,e[13]=i[13]+t[13]*r,e[14]=i[14]+t[14]*r,e[15]=i[15]+t[15]*r,e}function Hu(e,i){return e[0]===i[0]&&e[1]===i[1]&&e[2]===i[2]&&e[3]===i[3]&&e[4]===i[4]&&e[5]===i[5]&&e[6]===i[6]&&e[7]===i[7]&&e[8]===i[8]&&e[9]===i[9]&&e[10]===i[10]&&e[11]===i[11]&&e[12]===i[12]&&e[13]===i[13]&&e[14]===i[14]&&e[15]===i[15]}function gu(e,i){var t=e[0],r=e[1],n=e[2],a=e[3],u=e[4],f=e[5],g=e[6],x=e[7],I=e[8],O=e[9],B=e[10],W=e[11],he=e[12],ae=e[13],Se=e[14],Fe=e[15],Qe=i[0],qe=i[1],yt=i[2],Et=i[3],Ot=i[4],jt=i[5],or=i[6],ar=i[7],br=i[8],pr=i[9],jr=i[10],nn=i[11],yn=i[12],ma=i[13],Ho=i[14],Lo=i[15];return Math.abs(t-Qe)<=za*Math.max(1,Math.abs(t),Math.abs(Qe))&&Math.abs(r-qe)<=za*Math.max(1,Math.abs(r),Math.abs(qe))&&Math.abs(n-yt)<=za*Math.max(1,Math.abs(n),Math.abs(yt))&&Math.abs(a-Et)<=za*Math.max(1,Math.abs(a),Math.abs(Et))&&Math.abs(u-Ot)<=za*Math.max(1,Math.abs(u),Math.abs(Ot))&&Math.abs(f-jt)<=za*Math.max(1,Math.abs(f),Math.abs(jt))&&Math.abs(g-or)<=za*Math.max(1,Math.abs(g),Math.abs(or))&&Math.abs(x-ar)<=za*Math.max(1,Math.abs(x),Math.abs(ar))&&Math.abs(I-br)<=za*Math.max(1,Math.abs(I),Math.abs(br))&&Math.abs(O-pr)<=za*Math.max(1,Math.abs(O),Math.abs(pr))&&Math.abs(B-jr)<=za*Math.max(1,Math.abs(B),Math.abs(jr))&&Math.abs(W-nn)<=za*Math.max(1,Math.abs(W),Math.abs(nn))&&Math.abs(he-yn)<=za*Math.max(1,Math.abs(he),Math.abs(yn))&&Math.abs(ae-ma)<=za*Math.max(1,Math.abs(ae),Math.abs(ma))&&Math.abs(Se-Ho)<=za*Math.max(1,Math.abs(Se),Math.abs(Ho))&&Math.abs(Fe-Lo)<=za*Math.max(1,Math.abs(Fe),Math.abs(Lo))}var fc=Ga,LA=IA,_0,PA,Av=(_0=(0,dr.b2)(),_0(PA=function(){function e(){(0,ue.Z)(this,e),(0,Ce.Z)(this,"viewport",void 0),(0,Ce.Z)(this,"overridedViewProjectionMatrix",void 0),(0,Ce.Z)(this,"jitteredViewProjectionMatrix",void 0),(0,Ce.Z)(this,"jitteredProjectionMatrix",void 0),(0,Ce.Z)(this,"viewMatrixInverse",void 0),(0,Ce.Z)(this,"cameraPosition",void 0)}return(0,me.Z)(e,[{key:"init",value:function(){}},{key:"update",value:function(t){this.viewport=t,this.viewMatrixInverse=Qn(),kp(this.viewMatrixInverse,t.getViewMatrix()),this.cameraPosition=[this.viewMatrixInverse[12],this.viewMatrixInverse[13],this.viewMatrixInverse[14]]}},{key:"getProjectionMatrix",value:function(){return this.jitteredProjectionMatrix||this.viewport.getProjectionMatrix()}},{key:"getModelMatrix",value:function(){return this.viewport.getModelMatrix()}},{key:"getViewMatrix",value:function(){return this.viewport.getViewMatrix()}},{key:"getViewMatrixUncentered",value:function(){return this.viewport.getViewMatrixUncentered()}},{key:"getViewProjectionMatrixUncentered",value:function(){return this.viewport.getViewProjectionMatrixUncentered()}},{key:"getViewProjectionMatrix",value:function(){return this.overridedViewProjectionMatrix||this.jitteredViewProjectionMatrix||this.viewport.getViewProjectionMatrix()}},{key:"getZoom",value:function(){return this.viewport.getZoom()}},{key:"getZoomScale",value:function(){return this.viewport.getZoomScale()}},{key:"getCenter",value:function(){var t=this.viewport.getCenter(),r=(0,vn.Z)(t,2),n=r[0],a=r[1];return[n,a]}},{key:"getFocalDistance",value:function(){return this.viewport.getFocalDistance()}},{key:"getCameraPosition",value:function(){return this.cameraPosition}},{key:"projectFlat",value:function(t,r){return this.viewport.projectFlat(t,r)}},{key:"setViewProjectionMatrix",value:function(t){this.overridedViewProjectionMatrix=t}},{key:"jitterProjectionMatrix",value:function(t,r){var n=Yf(Qn(),[t,r,0]);this.jitteredProjectionMatrix=Ga(Qn(),n,this.viewport.getProjectionMatrix()),this.jitteredViewProjectionMatrix=Ga(Qn(),this.jitteredProjectionMatrix,this.viewport.getViewMatrix())}},{key:"clearJitterProjectionMatrix",value:function(){this.jitteredProjectionMatrix=void 0,this.jitteredViewProjectionMatrix=void 0}}]),e}())||PA),Rh=function(e){return e.TOPRIGHT="topright",e.TOPLEFT="topleft",e.BOTTOMRIGHT="bottomright",e.BOTTOMLEFT="bottomleft",e.TOPCENTER="topcenter",e.BOTTOMCENTER="bottomcenter",e.LEFTCENTER="leftcenter",e.RIGHTCENTER="rightcenter",e.LEFTTOP="lefttop",e.RIGHTTOP="righttop",e.LEFTBOTTOM="leftbottom",e.RIGHTBOTTOM="rightbottom",e}({}),OA,Zp;function pv(e,i){var t=typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=dv(e))||i&&e&&typeof e.length=="number"){t&&(e=t);var r=0,n=function(){};return{s:n,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(x){throw x},f:n}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var a=!0,u=!1,f;return{s:function(){t=t.call(e)},n:function(){var x=t.next();return a=x.done,x},e:function(x){u=!0,f=x},f:function(){try{!a&&t.return!=null&&t.return()}finally{if(u)throw f}}}}function dv(e,i){if(e){if(typeof e=="string")return RA(e,i);var t=Object.prototype.toString.call(e).slice(8,-1);if(t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set")return Array.from(e);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return RA(e,i)}}function RA(e,i){(i==null||i>e.length)&&(i=e.length);for(var t=0,r=new Array(i);t<i;t++)r[t]=e[t];return r}var Xg={topleft:"column",topright:"column",bottomright:"column",bottomleft:"column",leftcenter:"column",rightcenter:"column",topcenter:"row",bottomcenter:"row",lefttop:"row",righttop:"row",leftbottom:"row",rightbottom:"row"},kA=(OA=(0,dr.b2)(),OA(Zp=function(){function e(){(0,ue.Z)(this,e),(0,Ce.Z)(this,"container",void 0),(0,Ce.Z)(this,"controlCorners",void 0),(0,Ce.Z)(this,"controlContainer",void 0),(0,Ce.Z)(this,"scene",void 0),(0,Ce.Z)(this,"mapsService",void 0),(0,Ce.Z)(this,"controls",[]),(0,Ce.Z)(this,"unAddControls",[])}return(0,me.Z)(e,[{key:"init",value:function(t,r){this.container=t.container,this.scene=r,this.mapsService=r.get(Xt.IMapService),this.initControlPos()}},{key:"addControl",value:function(t,r){var n=r.get(Xt.IMapService);n.map?(t.addTo(this.scene),this.controls.push(t)):this.unAddControls.push(t)}},{key:"getControlByName",value:function(t){return this.controls.find(function(r){return r.controlOption.name===t})}},{key:"removeControl",value:function(t){var r=this.controls.indexOf(t);return r>-1&&this.controls.splice(r,1),t.remove(),this}},{key:"addControls",value:function(){var t=this;this.unAddControls.forEach(function(r){r.addTo(t.scene),t.controls.push(r)}),this.unAddControls=[]}},{key:"destroy",value:function(){var t=pv(this.controls),r;try{for(t.s();!(r=t.n()).done;){var n=r.value;n.remove()}}catch(a){t.e(a)}finally{t.f()}this.controls=[],this.clearControlPos()}},{key:"initControlPos",value:function(){var t=this.controlCorners={},r="l7-",n=this.controlContainer=ci("div",r+"control-container",this.container);function a(){var f=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],g=f.map(function(x){return r+x}).join(" ");t[f.filter(function(x){return!["row","column"].includes(x)}).join("")]=ci("div",g,n)}function u(f){var g=f.replace(/^(top|bottom|left|right|center)/,"$1-").split("-");return[].concat((0,Mr.Z)(g),[Xg[f]])}Object.values(Rh).forEach(function(f){a(u(f))}),this.checkCornerOverlap()}},{key:"clearControlPos",value:function(){for(var t in this.controlCorners)this.controlCorners[t]&&as(this.controlCorners[t]);this.controlContainer&&as(this.controlContainer)}},{key:"checkCornerOverlap",value:function(){var t=this,r=window.MutationObserver;if(r)for(var n=function(){var g=u[a],x=g.match(/^(top|bottom)(left|right)$/);if(x){var I=(0,vn.Z)(x,3),O=I[1],B=I[2],W=t.controlCorners["".concat(O).concat(B)],he=new r(function(ae){var Se=(0,vn.Z)(ae,1),Fe=Se[0].target;W&&(W.style[O]=Fe.clientHeight+"px")});he.observe(t.controlCorners["".concat(B).concat(O)],{childList:!0,attributes:!0})}},a=0,u=Object.keys(this.controlCorners);a<u.length;a++)n()}}]),e}())||Zp),zp,DA,Up=(zp=(0,dr.b2)(),zp(DA=function(){function e(){(0,ue.Z)(this,e),(0,Ce.Z)(this,"container",void 0),(0,Ce.Z)(this,"scene",void 0),(0,Ce.Z)(this,"mapsService",void 0),(0,Ce.Z)(this,"markers",[]),(0,Ce.Z)(this,"markerLayers",[]),(0,Ce.Z)(this,"unAddMarkers",[]),(0,Ce.Z)(this,"unAddMarkerLayers",[])}return(0,me.Z)(e,[{key:"addMarkerLayer",value:function(t){this.mapsService.map&&this.mapsService.getMarkerContainer()?(this.markerLayers.push(t),t.addTo(this.scene)):this.unAddMarkerLayers.push(t)}},{key:"removeMarkerLayer",value:function(t){t.destroy(),this.markerLayers.indexOf(t);var r=this.markerLayers.indexOf(t);r>-1&&this.markerLayers.splice(r,1)}},{key:"addMarker",value:function(t){this.mapsService.map&&this.mapsService.getMarkerContainer()?(this.markers.push(t),t.addTo(this.scene)):this.unAddMarkers.push(t)}},{key:"addMarkers",value:function(){var t=this;this.unAddMarkers.forEach(function(r){r.addTo(t.scene),t.markers.push(r)}),this.unAddMarkers=[]}},{key:"addMarkerLayers",value:function(){var t=this;this.unAddMarkerLayers.forEach(function(r){t.markerLayers.push(r),r.addTo(t.scene)}),this.unAddMarkers=[]}},{key:"removeMarker",value:function(t){t.remove(),this.markers.indexOf(t);var r=this.markers.indexOf(t);r>-1&&this.markers.splice(r,1)}},{key:"removeAllMarkers",value:function(){this.destroy()}},{key:"init",value:function(t){this.scene=t,this.mapsService=t.get(Xt.IMapService)}},{key:"destroy",value:function(){this.markers.forEach(function(t){t.remove()}),this.markers=[],this.markerLayers.forEach(function(t){t.destroy()}),this.markerLayers=[]}},{key:"removeMakerLayerMarker",value:function(t){t.destroy()}}]),e}())||DA),NA,vv,gv=(NA=(0,dr.b2)(),NA(vv=function(){function e(){(0,ue.Z)(this,e),(0,Ce.Z)(this,"scene",void 0),(0,Ce.Z)(this,"mapsService",void 0),(0,Ce.Z)(this,"popups",[]),(0,Ce.Z)(this,"unAddPopups",[])}return(0,me.Z)(e,[{key:"isMarkerReady",get:function(){return this.mapsService.map&&this.mapsService.getMarkerContainer()}},{key:"removePopup",value:function(t){t!=null&&t.isOpen()&&t.remove();var r=this.popups.indexOf(t);r>-1&&this.popups.splice(r,1);var n=this.unAddPopups.indexOf(t);n>-1&&this.unAddPopups.splice(n,1)}},{key:"destroy",value:function(){this.popups.forEach(function(t){return t.remove()})}},{key:"addPopup",value:function(t){var r=this;t&&t.getOptions().autoClose&&[].concat((0,Mr.Z)(this.popups),(0,Mr.Z)(this.unAddPopups)).forEach(function(n){n.getOptions().autoClose&&r.removePopup(n)}),this.isMarkerReady?(t.addTo(this.scene),this.popups.push(t)):this.unAddPopups.push(t),t.on("close",function(){r.removePopup(t)})}},{key:"initPopup",value:function(){var t=this;this.unAddPopups.length&&this.unAddPopups.forEach(function(r){t.addPopup(r),t.unAddPopups=[]})}},{key:"init",value:function(t){this.scene=t,this.mapsService=t.get(Xt.IMapService)}}]),e}())||vv),Af=function(e){return e.normal="normal",e.additive="additive",e.subtractive="subtractive",e.min="min",e.max="max",e.none="none",e}({}),x0=function(e){return e.MULTIPLE="MULTIPLE",e.SINGLE="SINGLE",e}({}),kh=function(e){return e.AND="and",e.OR="or",e}({}),cs=function(e){return e.INIT="init",e.UPDATE="update",e}({}),mv={MapToken:"\u60A8\u6B63\u5728\u4F7F\u7528 Demo \u6D4B\u8BD5 Token, \u751F\u4EA7\u73AF\u5883\u52A1\u5FC5\u81EA\u884C\u6CE8\u518C Token \u786E\u4FDD\u670D\u52A1\u7A33\u5B9A \u9AD8\u5FB7\u5730\u56FE\u7533\u8BF7\u5730\u5740 https://lbs.amap.com/api/javascript-api/guide/abc/prepare  Mapbox\u5730\u56FE\u7533\u8BF7\u5730\u5740 https://docs.mapbox.com/help/glossary/access-token/",SDK:"\u8BF7\u786E\u8BA4\u5F15\u5165\u4E86mapbox-gl api\u4E14\u5728L7\u4E4B\u524D\u5F15\u5165"},Gp=mv,jp,E0,Dh=In.merge,yv={id:"map",logoPosition:"bottomleft",logoVisible:!0,antialias:!0,stencil:!0,preserveDrawingBuffer:!1,pickBufferScale:1,fitBoundsOptions:{animate:!1}},Qg={colors:["rgb(103,0,31)","rgb(178,24,43)","rgb(214,96,77)","rgb(244,165,130)","rgb(253,219,199)","rgb(247,247,247)","rgb(209,229,240)","rgb(146,197,222)","rgb(67,147,195)","rgb(33,102,172)","rgb(5,48,97)"],size:10,shape:"circle",scales:{},shape2d:["circle","triangle","square","pentagon","hexagon","octogon","hexagram","rhombus","vesica"],shape3d:["cylinder","triangleColumn","hexagonColumn","squareColumn"],minZoom:-1,maxZoom:24,visible:!0,autoFit:!1,pickingBuffer:0,enablePropagation:!1,zIndex:0,blend:"normal",maskLayers:[],enableMask:!0,maskOperation:kh.AND,pickedFeatureID:-1,enableMultiPassRenderer:!1,enablePicking:!0,active:!1,activeColor:"#2f54eb",enableHighlight:!1,enableSelect:!1,highlightColor:"#2f54eb",activeMix:0,selectColor:"blue",selectMix:0,enableTAA:!1,jitterScale:1,enableLighting:!1,animateOption:{enable:!1,interval:.2,duration:4,trailLength:.15},forward:!0},FA=(jp=(0,dr.b2)(),jp(E0=function(){function e(){(0,ue.Z)(this,e),(0,Ce.Z)(this,"sceneConfigCache",{}),(0,Ce.Z)(this,"layerConfigCache",{}),(0,Ce.Z)(this,"layerAttributeConfigCache",{})}return(0,me.Z)(e,[{key:"getSceneConfig",value:function(t){return this.sceneConfigCache[t]}},{key:"getSceneWarninfo",value:function(t){return Gp[t]}},{key:"setSceneConfig",value:function(t,r){this.sceneConfigCache[t]=(0,X.Z)((0,X.Z)({},yv),r)}},{key:"getLayerConfig",value:function(t){return this.layerConfigCache[t]}},{key:"setLayerConfig",value:function(t,r,n){this.layerConfigCache[r]=(0,X.Z)({},Dh({},this.sceneConfigCache[t],Qg,n))}},{key:"getAttributeConfig",value:function(t){return this.layerAttributeConfigCache[t]}},{key:"setAttributeConfig",value:function(t,r){this.layerAttributeConfigCache[t]=(0,X.Z)((0,X.Z)({},this.layerAttributeConfigCache[t]),r)}},{key:"clean",value:function(){this.sceneConfigCache={},this.layerConfigCache={}}}]),e}())||E0);function Ki(e,i,t,r){t&&Object.defineProperty(e,i,{enumerable:t.enumerable,configurable:t.configurable,writable:t.writable,value:t.initializer?t.initializer.call(r):void 0})}function Hi(e,i,t,r,n){var a={};return Object.keys(r).forEach(function(u){a[u]=r[u]}),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=t.slice().reverse().reduce(function(u,f){return f(e,i,u)||u},a),n&&a.initializer!==void 0&&(a.value=a.initializer?a.initializer.call(n):void 0,a.initializer=void 0),a.initializer===void 0&&(Object.defineProperty(e,i,a),a=null),a}function Nh(){var e=new Go(4);return Go!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0,e[3]=0),e}function BA(e){var i=new glMatrix.ARRAY_TYPE(4);return i[0]=e[0],i[1]=e[1],i[2]=e[2],i[3]=e[3],i}function Fh(e,i,t,r){var n=new Go(4);return n[0]=e,n[1]=i,n[2]=t,n[3]=r,n}function th(e,i){return e[0]=i[0],e[1]=i[1],e[2]=i[2],e[3]=i[3],e}function qg(e,i,t,r,n){return e[0]=i,e[1]=t,e[2]=r,e[3]=n,e}function Kg(e,i,t){return e[0]=i[0]+t[0],e[1]=i[1]+t[1],e[2]=i[2]+t[2],e[3]=i[3]+t[3],e}function Jg(e,i,t){return e[0]=i[0]-t[0],e[1]=i[1]-t[1],e[2]=i[2]-t[2],e[3]=i[3]-t[3],e}function em(e,i,t){return e[0]=i[0]*t[0],e[1]=i[1]*t[1],e[2]=i[2]*t[2],e[3]=i[3]*t[3],e}function tm(e,i,t){return e[0]=i[0]/t[0],e[1]=i[1]/t[1],e[2]=i[2]/t[2],e[3]=i[3]/t[3],e}function Vp(e,i){return e[0]=Math.ceil(i[0]),e[1]=Math.ceil(i[1]),e[2]=Math.ceil(i[2]),e[3]=Math.ceil(i[3]),e}function rm(e,i){return e[0]=Math.floor(i[0]),e[1]=Math.floor(i[1]),e[2]=Math.floor(i[2]),e[3]=Math.floor(i[3]),e}function ZA(e,i,t){return e[0]=Math.min(i[0],t[0]),e[1]=Math.min(i[1],t[1]),e[2]=Math.min(i[2],t[2]),e[3]=Math.min(i[3],t[3]),e}function _v(e,i,t){return e[0]=Math.max(i[0],t[0]),e[1]=Math.max(i[1],t[1]),e[2]=Math.max(i[2],t[2]),e[3]=Math.max(i[3],t[3]),e}function xv(e,i){return e[0]=Math.round(i[0]),e[1]=Math.round(i[1]),e[2]=Math.round(i[2]),e[3]=Math.round(i[3]),e}function Bh(e,i,t){return e[0]=i[0]*t,e[1]=i[1]*t,e[2]=i[2]*t,e[3]=i[3]*t,e}function Ev(e,i,t,r){return e[0]=i[0]+t[0]*r,e[1]=i[1]+t[1]*r,e[2]=i[2]+t[2]*r,e[3]=i[3]+t[3]*r,e}function bv(e,i){var t=i[0]-e[0],r=i[1]-e[1],n=i[2]-e[2],a=i[3]-e[3];return Math.hypot(t,r,n,a)}function Sv(e,i){var t=i[0]-e[0],r=i[1]-e[1],n=i[2]-e[2],a=i[3]-e[3];return t*t+r*r+n*n+a*a}function nm(e){var i=e[0],t=e[1],r=e[2],n=e[3];return Math.hypot(i,t,r,n)}function Cv(e){var i=e[0],t=e[1],r=e[2],n=e[3];return i*i+t*t+r*r+n*n}function _x(e,i){return e[0]=-i[0],e[1]=-i[1],e[2]=-i[2],e[3]=-i[3],e}function wv(e,i){return e[0]=1/i[0],e[1]=1/i[1],e[2]=1/i[2],e[3]=1/i[3],e}function Tv(e,i){var t=i[0],r=i[1],n=i[2],a=i[3],u=t*t+r*r+n*n+a*a;return u>0&&(u=1/Math.sqrt(u)),e[0]=t*u,e[1]=r*u,e[2]=n*u,e[3]=a*u,e}function im(e,i){return e[0]*i[0]+e[1]*i[1]+e[2]*i[2]+e[3]*i[3]}function xx(e,i,t,r){var n=t[0]*r[1]-t[1]*r[0],a=t[0]*r[2]-t[2]*r[0],u=t[0]*r[3]-t[3]*r[0],f=t[1]*r[2]-t[2]*r[1],g=t[1]*r[3]-t[3]*r[1],x=t[2]*r[3]-t[3]*r[2],I=i[0],O=i[1],B=i[2],W=i[3];return e[0]=O*x-B*g+W*f,e[1]=-(I*x)+B*u-W*a,e[2]=I*g-O*u+W*n,e[3]=-(I*f)+O*a-B*n,e}function Ex(e,i,t,r){var n=i[0],a=i[1],u=i[2],f=i[3];return e[0]=n+r*(t[0]-n),e[1]=a+r*(t[1]-a),e[2]=u+r*(t[2]-u),e[3]=f+r*(t[3]-f),e}function Hp(e,i){i=i||1;var t,r,n,a,u,f;do t=glMatrix.RANDOM()*2-1,r=glMatrix.RANDOM()*2-1,u=t*t+r*r;while(u>=1);do n=glMatrix.RANDOM()*2-1,a=glMatrix.RANDOM()*2-1,f=n*n+a*a;while(f>=1);var g=Math.sqrt((1-u)/f);return e[0]=i*t,e[1]=i*r,e[2]=i*n*g,e[3]=i*a*g,e}function rh(e,i,t){var r=i[0],n=i[1],a=i[2],u=i[3];return e[0]=t[0]*r+t[4]*n+t[8]*a+t[12]*u,e[1]=t[1]*r+t[5]*n+t[9]*a+t[13]*u,e[2]=t[2]*r+t[6]*n+t[10]*a+t[14]*u,e[3]=t[3]*r+t[7]*n+t[11]*a+t[15]*u,e}function Mv(e,i,t){var r=i[0],n=i[1],a=i[2],u=t[0],f=t[1],g=t[2],x=t[3],I=x*r+f*a-g*n,O=x*n+g*r-u*a,B=x*a+u*n-f*r,W=-u*r-f*n-g*a;return e[0]=I*x+W*-u+O*-g-B*-f,e[1]=O*x+W*-f+B*-u-I*-g,e[2]=B*x+W*-g+I*-f-O*-u,e[3]=i[3],e}function Iv(e){return e[0]=0,e[1]=0,e[2]=0,e[3]=0,e}function $p(e){return"vec4("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+")"}function Wp(e,i){return e[0]===i[0]&&e[1]===i[1]&&e[2]===i[2]&&e[3]===i[3]}function b0(e,i){var t=e[0],r=e[1],n=e[2],a=e[3],u=i[0],f=i[1],g=i[2],x=i[3];return Math.abs(t-u)<=glMatrix.EPSILON*Math.max(1,Math.abs(t),Math.abs(u))&&Math.abs(r-f)<=glMatrix.EPSILON*Math.max(1,Math.abs(r),Math.abs(f))&&Math.abs(n-g)<=glMatrix.EPSILON*Math.max(1,Math.abs(n),Math.abs(g))&&Math.abs(a-x)<=glMatrix.EPSILON*Math.max(1,Math.abs(a),Math.abs(x))}var am=null,om=null,Lv=null,sm=null,bx=null,nh=null,zA=null,Zh=function(){var e=Nh();return function(i,t,r,n,a,u){var f,g;for(t||(t=4),r||(r=0),n?g=Math.min(n*t+r,i.length):g=i.length,f=r;f<g;f+=t)e[0]=i[f],e[1]=i[f+1],e[2]=i[f+2],e[3]=i[f+3],a(e,e,u),i[f]=e[0],i[f+1]=e[1],i[f+2]=e[2],i[f+3]=e[3];return i}}(),S0=Math.PI/180,um=512,Yp=4003e4;function Pv(e){var i=e.latitude,t=i===void 0?0:i,r=e.zoom,n=r===void 0?0:r,a=e.scale,u=e.highPrecision,f=u===void 0?!1:u,g=e.flipY,x=g===void 0?!1:g;a=a!==void 0?a:Math.pow(2,n);var I={},O=um*a,B=Math.cos(t*S0),W=O/360,he=W/B,ae=O/Yp/B;if(I.pixelsPerMeter=[ae,-ae,ae],I.metersPerPixel=[1/ae,-1/ae,1/ae],I.pixelsPerDegree=[W,-he,ae],I.degreesPerPixel=[1/W,-1/he,1/ae],f){var Se=S0*Math.tan(t*S0)/B,Fe=W*Se/2,Qe=O/Yp*Se,qe=Qe/he*ae;I.pixelsPerDegree2=[0,-Fe,Qe],I.pixelsPerMeter2=[qe,0,qe],x&&(I.pixelsPerDegree2[1]=-I.pixelsPerDegree2[1],I.pixelsPerMeter2[1]=-I.pixelsPerMeter2[1])}return x&&(I.pixelsPerMeter[1]=-I.pixelsPerMeter[1],I.metersPerPixel[1]=-I.metersPerPixel[1],I.pixelsPerDegree[1]=-I.pixelsPerDegree[1],I.degreesPerPixel[1]=-I.degreesPerPixel[1]),I}var Fc=function(e){return e[e.LNGLAT=1]="LNGLAT",e[e.LNGLAT_OFFSET=2]="LNGLAT_OFFSET",e[e.VECTOR_TILE=3]="VECTOR_TILE",e[e.IDENTITY=4]="IDENTITY",e[e.P20=5]="P20",e[e.P20_OFFSET=6]="P20_OFFSET",e[e.METER_OFFSET=7]="METER_OFFSET",e[e.P20_2=8]="P20_2",e}({}),pf={CoordinateSystem:"u_CoordinateSystem",ViewportCenter:"u_ViewportCenter",ViewportCenterProjection:"u_ViewportCenterProjection",PixelsPerDegree:"u_PixelsPerDegree",PixelsPerDegree2:"u_PixelsPerDegree2",PixelsPerMeter:"u_PixelsPerMeter",Mvp:"u_Mvp"},C0,ih,ah,Lf,zh,UA=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0],oh=(C0=(0,dr.b2)(),ih=(0,dr.f3)(Xt.ICameraService),C0(ah=(Lf=function(){function e(){(0,ue.Z)(this,e),(0,Ce.Z)(this,"needRefresh",!0),Ki(this,"cameraService",zh,this),(0,Ce.Z)(this,"coordinateSystem",void 0),(0,Ce.Z)(this,"viewportCenter",void 0),(0,Ce.Z)(this,"viewportCenterProjection",void 0),(0,Ce.Z)(this,"pixelsPerDegree",void 0),(0,Ce.Z)(this,"pixelsPerDegree2",void 0),(0,Ce.Z)(this,"pixelsPerMeter",void 0)}return(0,me.Z)(e,[{key:"refresh",value:function(t){var r=this.cameraService.getZoom(),n=this.cameraService.getZoomScale(),a=t||this.cameraService.getCenter(),u=Pv({latitude:a[1],zoom:r}),f=u.pixelsPerMeter,g=u.pixelsPerDegree;this.viewportCenter=a,this.viewportCenterProjection=[0,0,0,0],this.pixelsPerMeter=f,this.pixelsPerDegree=g,this.pixelsPerDegree2=[0,0,0],this.coordinateSystem===Fc.LNGLAT||this.coordinateSystem===Fc.P20?this.cameraService.setViewProjectionMatrix(void 0):this.coordinateSystem===Fc.LNGLAT_OFFSET?this.calculateLnglatOffset(a,r):this.coordinateSystem===Fc.P20_OFFSET&&this.calculateLnglatOffset(a,r,n,!0),this.needRefresh=!1}},{key:"getCoordinateSystem",value:function(){return this.coordinateSystem}},{key:"setCoordinateSystem",value:function(t){this.coordinateSystem=t}},{key:"getViewportCenter",value:function(){return this.viewportCenter}},{key:"getViewportCenterProjection",value:function(){return this.viewportCenterProjection}},{key:"getPixelsPerDegree",value:function(){return this.pixelsPerDegree}},{key:"getPixelsPerDegree2",value:function(){return this.pixelsPerDegree2}},{key:"getPixelsPerMeter",value:function(){return this.pixelsPerMeter}},{key:"calculateLnglatOffset",value:function(t,r,n,a){var u=Pv({latitude:t[1],zoom:r,scale:n,flipY:a,highPrecision:!0}),f=u.pixelsPerMeter,g=u.pixelsPerDegree,x=u.pixelsPerDegree2,I=this.cameraService.getViewMatrix(),O=this.cameraService.getProjectionMatrix(),B=Ga([],O,I),W=this.cameraService.projectFlat([Math.fround(t[0]),Math.fround(t[1])],Math.pow(2,r));this.viewportCenterProjection=rh([],[W[0],W[1],0,1],B),I=this.cameraService.getViewMatrixUncentered()||I,B=Ga([],O,I),B=Ga([],B,UA),this.cameraService.setViewProjectionMatrix(B),this.pixelsPerMeter=f,this.pixelsPerDegree=g,this.pixelsPerDegree2=x}}]),e}(),zh=Hi(Lf.prototype,"cameraService",[ih],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Lf))||ah),GA,jA;function Bc(e){var i=Zc();return function(){var r=(0,oe.Z)(e),n;if(i){var a=(0,oe.Z)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return(0,Ze.Z)(this,n)}}function Zc(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var zc=(GA=(0,dr.b2)(),GA(jA=function(e){(0,ke.Z)(t,e);var i=Bc(t);function t(){var r;(0,ue.Z)(this,t);for(var n=arguments.length,a=new Array(n),u=0;u<n;u++)a[u]=arguments[u];return r=i.call.apply(i,[this].concat(a)),(0,Ce.Z)((0,bt.Z)(r),"renderMap",new Map),(0,Ce.Z)((0,bt.Z)(r),"enable",!1),(0,Ce.Z)((0,bt.Z)(r),"renderEnable",!1),(0,Ce.Z)((0,bt.Z)(r),"cacheLogs",{}),r}return(0,me.Z)(t,[{key:"setEnable",value:function(n){this.enable=!!n}},{key:"log",value:function(n,a){var u=this;if(this.enable){var f=n.split("."),g=null;f.forEach(function(x,I){g!==null?(g[x]||(g[x]={}),I!==f.length-1&&(g=g[x])):(u.cacheLogs[x]||(u.cacheLogs[x]={}),I!==f.length-1&&(g=u.cacheLogs[x])),I===f.length-1&&(g[x]=(0,X.Z)((0,X.Z)({time:Date.now()},g[x]),a))})}}},{key:"getLog",value:function(n){var a=this;switch((0,Ia.Z)(n)){case"string":return this.cacheLogs[n];case"object":return n.map(function(u){return a.cacheLogs[u]}).filter(function(u){return u!==void 0});case"undefined":return this.cacheLogs}}},{key:"removeLog",value:function(n){delete this.cacheLogs[n]}},{key:"generateRenderUid",value:function(){return this.renderEnable?yl():""}},{key:"renderDebug",value:function(n){this.renderEnable=n}},{key:"renderStart",value:function(n){if(!(!this.renderEnable||!this.enable)){var a=this.renderMap.get(n)||{};this.renderMap.set(n,(0,X.Z)((0,X.Z)({},a),{},{renderUid:n,renderStart:Date.now()}))}}},{key:"renderEnd",value:function(n){if(!(!this.renderEnable||!this.enable)){var a=this.renderMap.get(n);if(a){var u=a.renderStart,f=Date.now();this.emit("renderEnd",(0,X.Z)((0,X.Z)({},a),{},{renderEnd:f,renderDuration:f-u})),this.renderMap.delete(n)}}}},{key:"destroy",value:function(){this.cacheLogs=null,this.renderMap.clear()}}]),t}(xa.EventEmitter))||jA),Qf=C(83959),w0=C.n(Qf),$u=function(e){return e.Hover="hover",e.Click="click",e.Select="select",e.Active="active",e.Drag="drag",e}({}),Xp,VA,Qp,HA,qp;function Kp(e){var i=lm();return function(){var r=(0,oe.Z)(e),n;if(i){var a=(0,oe.Z)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return(0,Ze.Z)(this,n)}}function lm(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var Ov={panstart:"dragstart",panmove:"dragging",panend:"dragend",pancancel:"dragcancel"},$A=(Xp=(0,dr.b2)(),VA=(0,dr.f3)(Xt.IMapService),Xp(Qp=(HA=function(e){(0,ke.Z)(t,e);var i=Kp(t);function t(){var r;(0,ue.Z)(this,t);for(var n=arguments.length,a=new Array(n),u=0;u<n;u++)a[u]=arguments[u];return r=i.call.apply(i,[this].concat(a)),(0,Ce.Z)((0,bt.Z)(r),"indragging",!1),Ki((0,bt.Z)(r),"mapService",qp,(0,bt.Z)(r)),(0,Ce.Z)((0,bt.Z)(r),"hammertime",void 0),(0,Ce.Z)((0,bt.Z)(r),"lastClickTime",0),(0,Ce.Z)((0,bt.Z)(r),"lastClickXY",[-1,-1]),(0,Ce.Z)((0,bt.Z)(r),"clickTimer",void 0),(0,Ce.Z)((0,bt.Z)(r),"$containter",void 0),(0,Ce.Z)((0,bt.Z)(r),"onDrag",function(f){var g=r.interactionEvent(f);g.type=Ov[g.type],g.type==="dragging"?r.indragging=!0:r.indragging=!1,r.emit($u.Drag,g)}),(0,Ce.Z)((0,bt.Z)(r),"onHammer",function(f){f.srcEvent.stopPropagation();var g=r.interactionEvent(f);r.emit($u.Hover,g)}),(0,Ce.Z)((0,bt.Z)(r),"onTouch",function(f){var g=f.touches[0];r.onHover({x:g.pageX,y:g.pageY,type:"touch"})}),(0,Ce.Z)((0,bt.Z)(r),"onHover",function(f){var g=f.clientX,x=f.clientY,I=g,O=x,B=f.type,W=r.mapService.getMapContainer();if(W){var he=W.getBoundingClientRect(),ae=he.top,Se=he.left;I=I-Se-W.clientLeft,O=O-ae-W.clientTop}var Fe=r.mapService.containerToLngLat([I,O]);if(B==="click"){r.isDoubleTap(I,O,Fe);return}if(B==="touch"){r.isDoubleTap(I,O,Fe);return}B!=="click"&&B!=="dblclick"&&r.emit($u.Hover,{x:I,y:O,lngLat:Fe,type:B,target:f})}),r}return(0,me.Z)(t,[{key:"init",value:function(){this.addEventListenerOnMap(),this.$containter=this.mapService.getMapContainer()}},{key:"destroy",value:function(){this.hammertime&&this.hammertime.destroy(),this.removeEventListenerOnMap(),this.off($u.Hover)}},{key:"triggerHover",value:function(n){var a=n.x,u=n.y;this.emit($u.Hover,{x:a,y:u})}},{key:"triggerSelect",value:function(n){this.emit($u.Select,{featureId:n})}},{key:"triggerActive",value:function(n){this.emit($u.Active,{featureId:n})}},{key:"handleMiniEvent",value:function(n){this.onHover({clientX:n.touches[0].pageX,clientY:n.touches[0].pageY,type:"touch"})}},{key:"addEventListenerOnMap",value:function(){var n=this.mapService.getMapContainer();if(n){var a=new(w0()).Manager(n);a.add(new(w0()).Tap({event:"dblclick",taps:2})),a.add(new(w0()).Tap({event:"click"})),a.add(new(w0()).Pan({threshold:0,pointers:0})),a.add(new(w0()).Press({})),a.on("dblclick click",this.onHammer),a.on("panstart panmove panend pancancel",this.onDrag),n.addEventListener("mousemove",this.onHover),n.addEventListener("mousedown",this.onHover,!0),n.addEventListener("mouseup",this.onHover),n.addEventListener("contextmenu",this.onHover),this.hammertime=a}}},{key:"removeEventListenerOnMap",value:function(){var n=this.mapService.getMapContainer();n&&(n.removeEventListener("mousemove",this.onHover),this.hammertime.off("dblclick click",this.onHammer),this.hammertime.off("panstart panmove panend pancancel",this.onDrag),n.removeEventListener("mousedown",this.onHover),n.removeEventListener("mouseup",this.onHover),n.removeEventListener("contextmenu",this.onHover))}},{key:"interactionEvent",value:function(n){var a=n.type,u=n.pointerType,f,g;u==="touch"?(g=Math.floor(n.pointers[0].clientY),f=Math.floor(n.pointers[0].clientX)):(g=Math.floor(n.srcEvent.y),f=Math.floor(n.srcEvent.x));var x=this.mapService.getMapContainer();if(x){var I=x.getBoundingClientRect(),O=I.top,B=I.left;f-=B,g-=O}var W=this.mapService.containerToLngLat([f,g]);return{x:f,y:g,lngLat:W,type:a,target:n.srcEvent}}},{key:"isDoubleTap",value:function(n,a,u){var f=this,g=new Date().getTime(),x="click";g-this.lastClickTime<400&&Math.abs(this.lastClickXY[0]-n)<10&&Math.abs(this.lastClickXY[1]-a)<10?(this.lastClickTime=0,this.lastClickXY=[-1,-1],this.clickTimer&&clearTimeout(this.clickTimer),x="dblclick",this.emit($u.Hover,{x:n,y:a,lngLat:u,type:x})):(this.lastClickTime=g,this.lastClickXY=[n,a],this.clickTimer=setTimeout(function(){x="click",f.emit($u.Hover,{x:n,y:a,lngLat:u,type:x})},400))}}]),t}($s()),qp=Hi(HA.prototype,"mapService",[VA],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),HA))||Qp),WA=0;function Jp(e){var i=e;if(typeof e=="string"&&(i=document.getElementById(e)),i){var t=document.createElement("div");return t.style.cssText+=`
      position: absolute;
      z-index:2;
      height: 100%;
      width: 100%;
      pointer-events: none;
    `,t.id="l7-scene-".concat(WA++),t.classList.add("l7-scene"),i.appendChild(t),t}return null}function ed(e){var i,t=!0;if((e==null||(i=e.target)===null||i===void 0?void 0:i.target)instanceof HTMLElement)for(var r,n=e==null||(r=e.target)===null||r===void 0?void 0:r.target;n;){var a,u=Array.from(n.classList);if(u.includes("l7-marker")||u.includes("l7-popup")){t=!1;break}n=(a=n)===null||a===void 0?void 0:a.parentElement}return t}var Ge=function(e){return e[e.DEPTH_BUFFER_BIT=256]="DEPTH_BUFFER_BIT",e[e.STENCIL_BUFFER_BIT=1024]="STENCIL_BUFFER_BIT",e[e.COLOR_BUFFER_BIT=16384]="COLOR_BUFFER_BIT",e[e.POINTS=0]="POINTS",e[e.LINES=1]="LINES",e[e.LINE_LOOP=2]="LINE_LOOP",e[e.LINE_STRIP=3]="LINE_STRIP",e[e.TRIANGLES=4]="TRIANGLES",e[e.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",e[e.TRIANGLE_FAN=6]="TRIANGLE_FAN",e[e.ZERO=0]="ZERO",e[e.ONE=1]="ONE",e[e.SRC_COLOR=768]="SRC_COLOR",e[e.ONE_MINUS_SRC_COLOR=769]="ONE_MINUS_SRC_COLOR",e[e.SRC_ALPHA=770]="SRC_ALPHA",e[e.ONE_MINUS_SRC_ALPHA=771]="ONE_MINUS_SRC_ALPHA",e[e.DST_ALPHA=772]="DST_ALPHA",e[e.ONE_MINUS_DST_ALPHA=773]="ONE_MINUS_DST_ALPHA",e[e.DST_COLOR=774]="DST_COLOR",e[e.ONE_MINUS_DST_COLOR=775]="ONE_MINUS_DST_COLOR",e[e.SRC_ALPHA_SATURATE=776]="SRC_ALPHA_SATURATE",e[e.FUNC_ADD=32774]="FUNC_ADD",e[e.BLEND_EQUATION=32777]="BLEND_EQUATION",e[e.BLEND_EQUATION_RGB=32777]="BLEND_EQUATION_RGB",e[e.BLEND_EQUATION_ALPHA=34877]="BLEND_EQUATION_ALPHA",e[e.FUNC_SUBTRACT=32778]="FUNC_SUBTRACT",e[e.FUNC_REVERSE_SUBTRACT=32779]="FUNC_REVERSE_SUBTRACT",e[e.MAX_EXT=32776]="MAX_EXT",e[e.MIN_EXT=32775]="MIN_EXT",e[e.BLEND_DST_RGB=32968]="BLEND_DST_RGB",e[e.BLEND_SRC_RGB=32969]="BLEND_SRC_RGB",e[e.BLEND_DST_ALPHA=32970]="BLEND_DST_ALPHA",e[e.BLEND_SRC_ALPHA=32971]="BLEND_SRC_ALPHA",e[e.CONSTANT_COLOR=32769]="CONSTANT_COLOR",e[e.ONE_MINUS_CONSTANT_COLOR=32770]="ONE_MINUS_CONSTANT_COLOR",e[e.CONSTANT_ALPHA=32771]="CONSTANT_ALPHA",e[e.ONE_MINUS_CONSTANT_ALPHA=32772]="ONE_MINUS_CONSTANT_ALPHA",e[e.BLEND_COLOR=32773]="BLEND_COLOR",e[e.ARRAY_BUFFER=34962]="ARRAY_BUFFER",e[e.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",e[e.ARRAY_BUFFER_BINDING=34964]="ARRAY_BUFFER_BINDING",e[e.ELEMENT_ARRAY_BUFFER_BINDING=34965]="ELEMENT_ARRAY_BUFFER_BINDING",e[e.STREAM_DRAW=35040]="STREAM_DRAW",e[e.STATIC_DRAW=35044]="STATIC_DRAW",e[e.DYNAMIC_DRAW=35048]="DYNAMIC_DRAW",e[e.BUFFER_SIZE=34660]="BUFFER_SIZE",e[e.BUFFER_USAGE=34661]="BUFFER_USAGE",e[e.CURRENT_VERTEX_ATTRIB=34342]="CURRENT_VERTEX_ATTRIB",e[e.FRONT=1028]="FRONT",e[e.BACK=1029]="BACK",e[e.FRONT_AND_BACK=1032]="FRONT_AND_BACK",e[e.CULL_FACE=2884]="CULL_FACE",e[e.BLEND=3042]="BLEND",e[e.DITHER=3024]="DITHER",e[e.STENCIL_TEST=2960]="STENCIL_TEST",e[e.DEPTH_TEST=2929]="DEPTH_TEST",e[e.SCISSOR_TEST=3089]="SCISSOR_TEST",e[e.POLYGON_OFFSET_FILL=32823]="POLYGON_OFFSET_FILL",e[e.SAMPLE_ALPHA_TO_COVERAGE=32926]="SAMPLE_ALPHA_TO_COVERAGE",e[e.SAMPLE_COVERAGE=32928]="SAMPLE_COVERAGE",e[e.NO_ERROR=0]="NO_ERROR",e[e.INVALID_ENUM=1280]="INVALID_ENUM",e[e.INVALID_VALUE=1281]="INVALID_VALUE",e[e.INVALID_OPERATION=1282]="INVALID_OPERATION",e[e.OUT_OF_MEMORY=1285]="OUT_OF_MEMORY",e[e.CW=2304]="CW",e[e.CCW=2305]="CCW",e[e.LINE_WIDTH=2849]="LINE_WIDTH",e[e.ALIASED_POINT_SIZE_RANGE=33901]="ALIASED_POINT_SIZE_RANGE",e[e.ALIASED_LINE_WIDTH_RANGE=33902]="ALIASED_LINE_WIDTH_RANGE",e[e.CULL_FACE_MODE=2885]="CULL_FACE_MODE",e[e.FRONT_FACE=2886]="FRONT_FACE",e[e.DEPTH_RANGE=2928]="DEPTH_RANGE",e[e.DEPTH_WRITEMASK=2930]="DEPTH_WRITEMASK",e[e.DEPTH_CLEAR_VALUE=2931]="DEPTH_CLEAR_VALUE",e[e.DEPTH_FUNC=2932]="DEPTH_FUNC",e[e.STENCIL_CLEAR_VALUE=2961]="STENCIL_CLEAR_VALUE",e[e.STENCIL_FUNC=2962]="STENCIL_FUNC",e[e.STENCIL_FAIL=2964]="STENCIL_FAIL",e[e.STENCIL_PASS_DEPTH_FAIL=2965]="STENCIL_PASS_DEPTH_FAIL",e[e.STENCIL_PASS_DEPTH_PASS=2966]="STENCIL_PASS_DEPTH_PASS",e[e.STENCIL_REF=2967]="STENCIL_REF",e[e.STENCIL_VALUE_MASK=2963]="STENCIL_VALUE_MASK",e[e.STENCIL_WRITEMASK=2968]="STENCIL_WRITEMASK",e[e.STENCIL_BACK_FUNC=34816]="STENCIL_BACK_FUNC",e[e.STENCIL_BACK_FAIL=34817]="STENCIL_BACK_FAIL",e[e.STENCIL_BACK_PASS_DEPTH_FAIL=34818]="STENCIL_BACK_PASS_DEPTH_FAIL",e[e.STENCIL_BACK_PASS_DEPTH_PASS=34819]="STENCIL_BACK_PASS_DEPTH_PASS",e[e.STENCIL_BACK_REF=36003]="STENCIL_BACK_REF",e[e.STENCIL_BACK_VALUE_MASK=36004]="STENCIL_BACK_VALUE_MASK",e[e.STENCIL_BACK_WRITEMASK=36005]="STENCIL_BACK_WRITEMASK",e[e.VIEWPORT=2978]="VIEWPORT",e[e.SCISSOR_BOX=3088]="SCISSOR_BOX",e[e.COLOR_CLEAR_VALUE=3106]="COLOR_CLEAR_VALUE",e[e.COLOR_WRITEMASK=3107]="COLOR_WRITEMASK",e[e.UNPACK_ALIGNMENT=3317]="UNPACK_ALIGNMENT",e[e.PACK_ALIGNMENT=3333]="PACK_ALIGNMENT",e[e.MAX_TEXTURE_SIZE=3379]="MAX_TEXTURE_SIZE",e[e.MAX_VIEWPORT_DIMS=3386]="MAX_VIEWPORT_DIMS",e[e.SUBPIXEL_BITS=3408]="SUBPIXEL_BITS",e[e.RED_BITS=3410]="RED_BITS",e[e.GREEN_BITS=3411]="GREEN_BITS",e[e.BLUE_BITS=3412]="BLUE_BITS",e[e.ALPHA_BITS=3413]="ALPHA_BITS",e[e.DEPTH_BITS=3414]="DEPTH_BITS",e[e.STENCIL_BITS=3415]="STENCIL_BITS",e[e.POLYGON_OFFSET_UNITS=10752]="POLYGON_OFFSET_UNITS",e[e.POLYGON_OFFSET_FACTOR=32824]="POLYGON_OFFSET_FACTOR",e[e.TEXTURE_BINDING_2D=32873]="TEXTURE_BINDING_2D",e[e.SAMPLE_BUFFERS=32936]="SAMPLE_BUFFERS",e[e.SAMPLES=32937]="SAMPLES",e[e.SAMPLE_COVERAGE_VALUE=32938]="SAMPLE_COVERAGE_VALUE",e[e.SAMPLE_COVERAGE_INVERT=32939]="SAMPLE_COVERAGE_INVERT",e[e.COMPRESSED_TEXTURE_FORMATS=34467]="COMPRESSED_TEXTURE_FORMATS",e[e.DONT_CARE=4352]="DONT_CARE",e[e.FASTEST=4353]="FASTEST",e[e.NICEST=4354]="NICEST",e[e.GENERATE_MIPMAP_HINT=33170]="GENERATE_MIPMAP_HINT",e[e.BYTE=5120]="BYTE",e[e.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",e[e.SHORT=5122]="SHORT",e[e.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",e[e.INT=5124]="INT",e[e.UNSIGNED_INT=5125]="UNSIGNED_INT",e[e.FLOAT=5126]="FLOAT",e[e.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",e[e.ALPHA=6406]="ALPHA",e[e.RGB=6407]="RGB",e[e.RGBA=6408]="RGBA",e[e.LUMINANCE=6409]="LUMINANCE",e[e.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",e[e.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",e[e.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",e[e.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",e[e.FRAGMENT_SHADER=35632]="FRAGMENT_SHADER",e[e.VERTEX_SHADER=35633]="VERTEX_SHADER",e[e.MAX_VERTEX_ATTRIBS=34921]="MAX_VERTEX_ATTRIBS",e[e.MAX_VERTEX_UNIFORM_VECTORS=36347]="MAX_VERTEX_UNIFORM_VECTORS",e[e.MAX_VARYING_VECTORS=36348]="MAX_VARYING_VECTORS",e[e.MAX_COMBINED_TEXTURE_IMAGE_UNITS=35661]="MAX_COMBINED_TEXTURE_IMAGE_UNITS",e[e.MAX_VERTEX_TEXTURE_IMAGE_UNITS=35660]="MAX_VERTEX_TEXTURE_IMAGE_UNITS",e[e.MAX_TEXTURE_IMAGE_UNITS=34930]="MAX_TEXTURE_IMAGE_UNITS",e[e.MAX_FRAGMENT_UNIFORM_VECTORS=36349]="MAX_FRAGMENT_UNIFORM_VECTORS",e[e.SHADER_TYPE=35663]="SHADER_TYPE",e[e.DELETE_STATUS=35712]="DELETE_STATUS",e[e.LINK_STATUS=35714]="LINK_STATUS",e[e.VALIDATE_STATUS=35715]="VALIDATE_STATUS",e[e.ATTACHED_SHADERS=35717]="ATTACHED_SHADERS",e[e.ACTIVE_UNIFORMS=35718]="ACTIVE_UNIFORMS",e[e.ACTIVE_ATTRIBUTES=35721]="ACTIVE_ATTRIBUTES",e[e.SHADING_LANGUAGE_VERSION=35724]="SHADING_LANGUAGE_VERSION",e[e.CURRENT_PROGRAM=35725]="CURRENT_PROGRAM",e[e.NEVER=512]="NEVER",e[e.LESS=513]="LESS",e[e.EQUAL=514]="EQUAL",e[e.LEQUAL=515]="LEQUAL",e[e.GREATER=516]="GREATER",e[e.NOTEQUAL=517]="NOTEQUAL",e[e.GEQUAL=518]="GEQUAL",e[e.ALWAYS=519]="ALWAYS",e[e.KEEP=7680]="KEEP",e[e.REPLACE=7681]="REPLACE",e[e.INCR=7682]="INCR",e[e.DECR=7683]="DECR",e[e.INVERT=5386]="INVERT",e[e.INCR_WRAP=34055]="INCR_WRAP",e[e.DECR_WRAP=34056]="DECR_WRAP",e[e.VENDOR=7936]="VENDOR",e[e.RENDERER=7937]="RENDERER",e[e.VERSION=7938]="VERSION",e[e.NEAREST=9728]="NEAREST",e[e.LINEAR=9729]="LINEAR",e[e.NEAREST_MIPMAP_NEAREST=9984]="NEAREST_MIPMAP_NEAREST",e[e.LINEAR_MIPMAP_NEAREST=9985]="LINEAR_MIPMAP_NEAREST",e[e.NEAREST_MIPMAP_LINEAR=9986]="NEAREST_MIPMAP_LINEAR",e[e.LINEAR_MIPMAP_LINEAR=9987]="LINEAR_MIPMAP_LINEAR",e[e.TEXTURE_MAG_FILTER=10240]="TEXTURE_MAG_FILTER",e[e.TEXTURE_MIN_FILTER=10241]="TEXTURE_MIN_FILTER",e[e.TEXTURE_WRAP_S=10242]="TEXTURE_WRAP_S",e[e.TEXTURE_WRAP_T=10243]="TEXTURE_WRAP_T",e[e.TEXTURE_2D=3553]="TEXTURE_2D",e[e.TEXTURE=5890]="TEXTURE",e[e.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",e[e.TEXTURE_BINDING_CUBE_MAP=34068]="TEXTURE_BINDING_CUBE_MAP",e[e.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",e[e.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",e[e.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",e[e.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",e[e.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",e[e.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z",e[e.MAX_CUBE_MAP_TEXTURE_SIZE=34076]="MAX_CUBE_MAP_TEXTURE_SIZE",e[e.TEXTURE0=33984]="TEXTURE0",e[e.TEXTURE1=33985]="TEXTURE1",e[e.TEXTURE2=33986]="TEXTURE2",e[e.TEXTURE3=33987]="TEXTURE3",e[e.TEXTURE4=33988]="TEXTURE4",e[e.TEXTURE5=33989]="TEXTURE5",e[e.TEXTURE6=33990]="TEXTURE6",e[e.TEXTURE7=33991]="TEXTURE7",e[e.TEXTURE8=33992]="TEXTURE8",e[e.TEXTURE9=33993]="TEXTURE9",e[e.TEXTURE10=33994]="TEXTURE10",e[e.TEXTURE11=33995]="TEXTURE11",e[e.TEXTURE12=33996]="TEXTURE12",e[e.TEXTURE13=33997]="TEXTURE13",e[e.TEXTURE14=33998]="TEXTURE14",e[e.TEXTURE15=33999]="TEXTURE15",e[e.TEXTURE16=34e3]="TEXTURE16",e[e.TEXTURE17=34001]="TEXTURE17",e[e.TEXTURE18=34002]="TEXTURE18",e[e.TEXTURE19=34003]="TEXTURE19",e[e.TEXTURE20=34004]="TEXTURE20",e[e.TEXTURE21=34005]="TEXTURE21",e[e.TEXTURE22=34006]="TEXTURE22",e[e.TEXTURE23=34007]="TEXTURE23",e[e.TEXTURE24=34008]="TEXTURE24",e[e.TEXTURE25=34009]="TEXTURE25",e[e.TEXTURE26=34010]="TEXTURE26",e[e.TEXTURE27=34011]="TEXTURE27",e[e.TEXTURE28=34012]="TEXTURE28",e[e.TEXTURE29=34013]="TEXTURE29",e[e.TEXTURE30=34014]="TEXTURE30",e[e.TEXTURE31=34015]="TEXTURE31",e[e.ACTIVE_TEXTURE=34016]="ACTIVE_TEXTURE",e[e.REPEAT=10497]="REPEAT",e[e.CLAMP_TO_EDGE=33071]="CLAMP_TO_EDGE",e[e.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT",e[e.FLOAT_VEC2=35664]="FLOAT_VEC2",e[e.FLOAT_VEC3=35665]="FLOAT_VEC3",e[e.FLOAT_VEC4=35666]="FLOAT_VEC4",e[e.INT_VEC2=35667]="INT_VEC2",e[e.INT_VEC3=35668]="INT_VEC3",e[e.INT_VEC4=35669]="INT_VEC4",e[e.BOOL=35670]="BOOL",e[e.BOOL_VEC2=35671]="BOOL_VEC2",e[e.BOOL_VEC3=35672]="BOOL_VEC3",e[e.BOOL_VEC4=35673]="BOOL_VEC4",e[e.FLOAT_MAT2=35674]="FLOAT_MAT2",e[e.FLOAT_MAT3=35675]="FLOAT_MAT3",e[e.FLOAT_MAT4=35676]="FLOAT_MAT4",e[e.SAMPLER_2D=35678]="SAMPLER_2D",e[e.SAMPLER_CUBE=35680]="SAMPLER_CUBE",e[e.VERTEX_ATTRIB_ARRAY_ENABLED=34338]="VERTEX_ATTRIB_ARRAY_ENABLED",e[e.VERTEX_ATTRIB_ARRAY_SIZE=34339]="VERTEX_ATTRIB_ARRAY_SIZE",e[e.VERTEX_ATTRIB_ARRAY_STRIDE=34340]="VERTEX_ATTRIB_ARRAY_STRIDE",e[e.VERTEX_ATTRIB_ARRAY_TYPE=34341]="VERTEX_ATTRIB_ARRAY_TYPE",e[e.VERTEX_ATTRIB_ARRAY_NORMALIZED=34922]="VERTEX_ATTRIB_ARRAY_NORMALIZED",e[e.VERTEX_ATTRIB_ARRAY_POINTER=34373]="VERTEX_ATTRIB_ARRAY_POINTER",e[e.VERTEX_ATTRIB_ARRAY_BUFFER_BINDING=34975]="VERTEX_ATTRIB_ARRAY_BUFFER_BINDING",e[e.COMPILE_STATUS=35713]="COMPILE_STATUS",e[e.LOW_FLOAT=36336]="LOW_FLOAT",e[e.MEDIUM_FLOAT=36337]="MEDIUM_FLOAT",e[e.HIGH_FLOAT=36338]="HIGH_FLOAT",e[e.LOW_INT=36339]="LOW_INT",e[e.MEDIUM_INT=36340]="MEDIUM_INT",e[e.HIGH_INT=36341]="HIGH_INT",e[e.FRAMEBUFFER=36160]="FRAMEBUFFER",e[e.RENDERBUFFER=36161]="RENDERBUFFER",e[e.RGBA4=32854]="RGBA4",e[e.RGB5_A1=32855]="RGB5_A1",e[e.RGB565=36194]="RGB565",e[e.DEPTH_COMPONENT16=33189]="DEPTH_COMPONENT16",e[e.STENCIL_INDEX=6401]="STENCIL_INDEX",e[e.STENCIL_INDEX8=36168]="STENCIL_INDEX8",e[e.DEPTH_STENCIL=34041]="DEPTH_STENCIL",e[e.RENDERBUFFER_WIDTH=36162]="RENDERBUFFER_WIDTH",e[e.RENDERBUFFER_HEIGHT=36163]="RENDERBUFFER_HEIGHT",e[e.RENDERBUFFER_INTERNAL_FORMAT=36164]="RENDERBUFFER_INTERNAL_FORMAT",e[e.RENDERBUFFER_RED_SIZE=36176]="RENDERBUFFER_RED_SIZE",e[e.RENDERBUFFER_GREEN_SIZE=36177]="RENDERBUFFER_GREEN_SIZE",e[e.RENDERBUFFER_BLUE_SIZE=36178]="RENDERBUFFER_BLUE_SIZE",e[e.RENDERBUFFER_ALPHA_SIZE=36179]="RENDERBUFFER_ALPHA_SIZE",e[e.RENDERBUFFER_DEPTH_SIZE=36180]="RENDERBUFFER_DEPTH_SIZE",e[e.RENDERBUFFER_STENCIL_SIZE=36181]="RENDERBUFFER_STENCIL_SIZE",e[e.FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE=36048]="FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE",e[e.FRAMEBUFFER_ATTACHMENT_OBJECT_NAME=36049]="FRAMEBUFFER_ATTACHMENT_OBJECT_NAME",e[e.FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL=36050]="FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL",e[e.FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE=36051]="FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE",e[e.COLOR_ATTACHMENT0=36064]="COLOR_ATTACHMENT0",e[e.DEPTH_ATTACHMENT=36096]="DEPTH_ATTACHMENT",e[e.STENCIL_ATTACHMENT=36128]="STENCIL_ATTACHMENT",e[e.DEPTH_STENCIL_ATTACHMENT=33306]="DEPTH_STENCIL_ATTACHMENT",e[e.NONE=0]="NONE",e[e.FRAMEBUFFER_COMPLETE=36053]="FRAMEBUFFER_COMPLETE",e[e.FRAMEBUFFER_INCOMPLETE_ATTACHMENT=36054]="FRAMEBUFFER_INCOMPLETE_ATTACHMENT",e[e.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT=36055]="FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT",e[e.FRAMEBUFFER_INCOMPLETE_DIMENSIONS=36057]="FRAMEBUFFER_INCOMPLETE_DIMENSIONS",e[e.FRAMEBUFFER_UNSUPPORTED=36061]="FRAMEBUFFER_UNSUPPORTED",e[e.FRAMEBUFFER_BINDING=36006]="FRAMEBUFFER_BINDING",e[e.RENDERBUFFER_BINDING=36007]="RENDERBUFFER_BINDING",e[e.MAX_RENDERBUFFER_SIZE=34024]="MAX_RENDERBUFFER_SIZE",e[e.INVALID_FRAMEBUFFER_OPERATION=1286]="INVALID_FRAMEBUFFER_OPERATION",e[e.UNPACK_FLIP_Y_WEBGL=37440]="UNPACK_FLIP_Y_WEBGL",e[e.UNPACK_PREMULTIPLY_ALPHA_WEBGL=37441]="UNPACK_PREMULTIPLY_ALPHA_WEBGL",e[e.CONTEXT_LOST_WEBGL=37442]="CONTEXT_LOST_WEBGL",e[e.UNPACK_COLORSPACE_CONVERSION_WEBGL=37443]="UNPACK_COLORSPACE_CONVERSION_WEBGL",e[e.BROWSER_DEFAULT_WEBGL=37444]="BROWSER_DEFAULT_WEBGL",e}({}),T0,Uh,td,YA,Rv,rd,XA,M0,nd,id,ad,od,kv,Dv=(T0=(0,dr.b2)(),Uh=(0,dr.f3)(Xt.IMapService),td=(0,dr.f3)(Xt.IRendererService),YA=(0,dr.f3)(Xt.IGlobalConfigService),Rv=(0,dr.f3)(Xt.IInteractionService),rd=(0,dr.f3)(Xt.ILayerService),T0(XA=(M0=function(){function e(){var i=this;(0,ue.Z)(this,e),(0,Ce.Z)(this,"pickedColors",void 0),(0,Ce.Z)(this,"pickedTileLayers",[]),Ki(this,"mapService",nd,this),Ki(this,"rendererService",id,this),Ki(this,"configService",ad,this),Ki(this,"interactionService",od,this),Ki(this,"layerService",kv,this),(0,Ce.Z)(this,"pickingFBO",void 0),(0,Ce.Z)(this,"width",0),(0,Ce.Z)(this,"height",0),(0,Ce.Z)(this,"alreadyInPicking",!1),(0,Ce.Z)(this,"pickBufferScale",1),(0,Ce.Z)(this,"pickFromPickingFBO",function(t,r){var n=r.x,a=r.y,u=r.lngLat,f=r.type,g=r.target,x=!1,I=i.rendererService,O=I.readPixels,B=I.getContainer,W=i.getContainerSize(B()),he=W.width,ae=W.height;he*=la,ae*=la;var Se=t.getLayerConfig(),Fe=Se.enableHighlight,Qe=Se.enableSelect,qe=n*la,yt=a*la;if(qe>he-1*la||qe<0||yt>ae-1*la||yt<0)return!1;var Et=O({x:Math.floor(qe/i.pickBufferScale),y:Math.floor((ae-(a+1)*la)/i.pickBufferScale),width:1,height:1,data:new Uint8Array(1*1*4),framebuffer:i.pickingFBO});if(i.pickedColors=Et,Et[0]!==0||Et[1]!==0||Et[2]!==0){var Ot=io(Et),jt=t.layerPickService.getFeatureById(Ot);Ot!==t.getCurrentPickId()&&f==="mousemove"&&(f="mouseenter");var or={x:n,y:a,type:f,lngLat:u,featureId:Ot,feature:jt,target:g};jt&&(x=!0,t.setCurrentPickId(Ot),i.triggerHoverOnLayer(t,or))}else{var ar={x:n,y:a,lngLat:u,type:t.getCurrentPickId()!==null&&f==="mousemove"?"mouseout":"un"+f,featureId:null,target:g,feature:null};i.triggerHoverOnLayer(t,(0,X.Z)((0,X.Z)({},ar),{},{type:"unpick"})),i.triggerHoverOnLayer(t,ar),t.setCurrentPickId(null)}if(Fe&&t.layerPickService.highlightPickedFeature(Et),Qe&&f==="click"&&(Et==null?void 0:Et.toString())!==[0,0,0,0].toString()){var br=io(Et);t.getCurrentSelectedId()===null||br!==t.getCurrentSelectedId()?(t.layerPickService.selectFeature(Et),t.setCurrentSelectedId(br)):(t.layerPickService.selectFeature(new Uint8Array([0,0,0,0])),t.setCurrentSelectedId(null))}return x})}return(0,me.Z)(e,[{key:"init",value:function(t){var r=this.rendererService,n=r.createTexture2D,a=r.createFramebuffer,u=r.getContainer,f=this.getContainerSize(u()),g=f.width,x=f.height;g*=la,x*=la,this.pickBufferScale=this.configService.getSceneConfig(t).pickBufferScale||1,this.pickingFBO=a({color:n({width:Math.round(g/this.pickBufferScale),height:Math.round(x/this.pickBufferScale),wrapS:Ge.CLAMP_TO_EDGE,wrapT:Ge.CLAMP_TO_EDGE})}),this.interactionService.on($u.Hover,this.pickingAllLayer.bind(this))}},{key:"boxPickLayer",value:function(){var i=(0,ur.Z)(nt().mark(function r(n,a,u){var f=this,g,x,I;return nt().wrap(function(B){for(;;)switch(B.prev=B.next){case 0:g=this.rendererService,x=g.useFramebuffer,I=g.clear,this.resizePickingFBO(),x(this.pickingFBO,function(){I({framebuffer:f.pickingFBO,color:[0,0,0,0],stencil:0,depth:1}),n.hooks.beforePickingEncode.call(),n.renderModels({ispick:!0}),n.hooks.afterPickingEncode.call();var W=f.pickBox(n,a);u(W)});case 3:case"end":return B.stop()}},r,this)}));function t(r,n,a){return i.apply(this,arguments)}return t}()},{key:"pickBox",value:function(t,r){var n=this,a=r.map(function(br){var pr=br<0?0:br;return Math.floor(pr*la/n.pickBufferScale)}),u=(0,vn.Z)(a,4),f=u[0],g=u[1],x=u[2],I=u[3],O=this.rendererService,B=O.readPixels,W=O.getContainer,he=this.getContainerSize(W()),ae=he.width,Se=he.height;if(ae*=la,Se*=la,f>(ae-1)*la/this.pickBufferScale||x<0||g>(Se-1)*la/this.pickBufferScale||I<0)return[];for(var Fe=Math.min(ae/this.pickBufferScale,x)-f,Qe=Math.min(Se/this.pickBufferScale,I)-g,qe=B({x:f,y:Math.floor(Se/this.pickBufferScale-(I+1)),width:Fe,height:Qe,data:new Uint8Array(Fe*Qe*4),framebuffer:this.pickingFBO}),yt=[],Et={},Ot=0;Ot<qe.length/4;Ot=Ot+1){var jt=qe.slice(Ot*4,Ot*4+4),or=io(jt);if(or!==-1&&!Et[or]){var ar=t.layerPickService.getFeatureById(or);yt.push((0,X.Z)((0,X.Z)({},ar),{},{pickedFeatureIdx:or})),Et[or]=!0}}return yt}},{key:"handleCursor",value:function(t,r){var n=t.getLayerConfig(),a=n.cursor,u=a===void 0?"":a,f=n.cursorEnabled;if(f){var g=this.mapService.version,x=g==="GAODE2.x"?this.mapService.getMapContainer():this.mapService.getMarkerContainer(),I=x==null?void 0:x.style.getPropertyValue("cursor");r==="unmousemove"&&I!==""?x==null||x.style.setProperty("cursor",""):r==="mousemove"&&(x==null||x.style.setProperty("cursor",u))}}},{key:"destroy",value:function(){this.pickingFBO.destroy(),this.pickingFBO=null}},{key:"getContainerSize",value:function(t){return t.getContext?{width:t.width/la,height:t.height/la}:t.getBoundingClientRect()}},{key:"pickingAllLayer",value:function(){var i=(0,ur.Z)(nt().mark(function r(n){return nt().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:if(!(!this.layerService.needPick(n.type)||!this.isPickingAllLayer())){u.next=2;break}return u.abrupt("return");case 2:return this.alreadyInPicking=!0,u.next=5,this.pickingLayers(n);case 5:this.layerService.renderLayers(),this.alreadyInPicking=!1;case 7:case"end":return u.stop()}},r,this)}));function t(r){return i.apply(this,arguments)}return t}()},{key:"isPickingAllLayer",value:function(){return!(this.alreadyInPicking||this.layerService.alreadyInRendering||this.interactionService.indragging||!this.layerService.getShaderPickStat())}},{key:"resizePickingFBO",value:function(){var t=this.rendererService.getContainer,r=this.getContainerSize(t()),n=r.width,a=r.height;n*=la,a*=la,(this.width!==n||this.height!==a)&&(this.pickingFBO.resize({width:Math.round(n/this.pickBufferScale),height:Math.round(a/this.pickBufferScale)}),this.width=n,this.height=a)}},{key:"pickingLayers",value:function(){var i=(0,ur.Z)(nt().mark(function r(n){var a=this,u,f,g;return nt().wrap(function(I){for(;;)switch(I.prev=I.next){case 0:u=this.rendererService,f=u.useFramebuffer,g=u.clear,this.resizePickingFBO(),f(this.pickingFBO,function(){var O=a.layerService.getRenderList();O.filter(function(B){return B.needPick(n.type)}).reverse().some(function(B){g({framebuffer:a.pickingFBO,color:[0,0,0,0],stencil:0,depth:1}),B.layerPickService.pickRender(n);var W=a.pickFromPickingFBO(B,n);return a.layerService.pickedLayerId=W?+B.id:-1,W&&!B.getLayerConfig().enablePropagation})});case 3:case"end":return I.stop()}},r,this)}));function t(r){return i.apply(this,arguments)}return t}()},{key:"triggerHoverOnLayer",value:function(t,r){ed(r)&&(this.handleCursor(t,r.type),t.emit(r.type,r))}}]),e}(),nd=Hi(M0.prototype,"mapService",[Uh],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),id=Hi(M0.prototype,"rendererService",[td],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ad=Hi(M0.prototype,"configService",[YA],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),od=Hi(M0.prototype,"interactionService",[Rv],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),kv=Hi(M0.prototype,"layerService",[rd],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),M0))||XA),Nv=function(){function e(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;(0,ue.Z)(this,e),(0,Ce.Z)(this,"autoStart",void 0),(0,Ce.Z)(this,"startTime",0),(0,Ce.Z)(this,"oldTime",0),(0,Ce.Z)(this,"running",!1),(0,Ce.Z)(this,"elapsedTime",0),this.autoStart=i}return(0,me.Z)(e,[{key:"start",value:function(){this.startTime=(typeof performance=="undefined"?Date:performance).now(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}},{key:"stop",value:function(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}},{key:"getElapsedTime",value:function(){return this.getDelta(),this.elapsedTime}},{key:"getDelta",value:function(){var t=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){var r=(typeof performance=="undefined"?Date:performance).now();t=(r-this.oldTime)/1e3,this.oldTime=r,this.elapsedTime+=t}return t}}]),e}(),sd,Fv,Bv,QA,Gh,sh,Zv,qA,ud;function ld(e,i){var t=typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=zv(e))||i&&e&&typeof e.length=="number"){t&&(e=t);var r=0,n=function(){};return{s:n,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(x){throw x},f:n}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var a=!0,u=!1,f;return{s:function(){t=t.call(e)},n:function(){var x=t.next();return a=x.done,x},e:function(x){u=!0,f=x},f:function(){try{!a&&t.return!=null&&t.return()}finally{if(u)throw f}}}}function zv(e,i){if(e){if(typeof e=="string")return cd(e,i);var t=Object.prototype.toString.call(e).slice(8,-1);if(t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set")return Array.from(e);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return cd(e,i)}}function cd(e,i){(i==null||i>e.length)&&(i=e.length);for(var t=0,r=new Array(i);t<i;t++)r[t]=e[t];return r}function Uv(e){var i=cm();return function(){var r=(0,oe.Z)(e),n;if(i){var a=(0,oe.Z)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return(0,Ze.Z)(this,n)}}function cm(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var fd=In.throttle,fm=(sd=(0,dr.b2)(),Fv=(0,dr.f3)(Xt.IRendererService),Bv=(0,dr.f3)(Xt.IMapService),QA=(0,dr.f3)(Xt.IDebugService),sd(Gh=(sh=function(e){(0,ke.Z)(t,e);var i=Uv(t);function t(){var r;(0,ue.Z)(this,t);for(var n=arguments.length,a=new Array(n),u=0;u<n;u++)a[u]=arguments[u];return r=i.call.apply(i,[this].concat(a)),(0,Ce.Z)((0,bt.Z)(r),"pickedLayerId",-1),(0,Ce.Z)((0,bt.Z)(r),"clock",new Nv),(0,Ce.Z)((0,bt.Z)(r),"alreadyInRendering",!1),(0,Ce.Z)((0,bt.Z)(r),"layers",[]),(0,Ce.Z)((0,bt.Z)(r),"layerList",[]),(0,Ce.Z)((0,bt.Z)(r),"layerRenderID",void 0),(0,Ce.Z)((0,bt.Z)(r),"sceneInited",!1),(0,Ce.Z)((0,bt.Z)(r),"animateInstanceCount",0),(0,Ce.Z)((0,bt.Z)(r),"shaderPicking",!0),(0,Ce.Z)((0,bt.Z)(r),"enableRender",!0),Ki((0,bt.Z)(r),"renderService",Zv,(0,bt.Z)(r)),Ki((0,bt.Z)(r),"mapService",qA,(0,bt.Z)(r)),Ki((0,bt.Z)(r),"debugService",ud,(0,bt.Z)(r)),(0,Ce.Z)((0,bt.Z)(r),"reRender",fd(function(){r.renderLayers()},32)),(0,Ce.Z)((0,bt.Z)(r),"throttleRenderLayers",fd(function(){r.renderLayers()},16)),r}return(0,me.Z)(t,[{key:"needPick",value:function(n){return this.layerList.some(function(a){return a.needPick(n)})}},{key:"add",value:function(n){var a=this;this.layers.push(n),this.sceneInited&&n.init().then(function(){a.renderLayers()})}},{key:"addMask",value:function(n){var a=this;this.sceneInited&&n.init().then(function(){a.renderLayers()})}},{key:"initLayers",value:function(){var r=(0,ur.Z)(nt().mark(function a(){var u=this;return nt().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:this.sceneInited=!0,this.layers.forEach(function(){var x=(0,ur.Z)(nt().mark(function I(O){return nt().wrap(function(W){for(;;)switch(W.prev=W.next){case 0:if(O.startInit){W.next=4;break}return W.next=3,O.init();case 3:u.updateLayerRenderList();case 4:case"end":return W.stop()}},I)}));return function(I){return x.apply(this,arguments)}}());case 2:case"end":return g.stop()}},a,this)}));function n(){return r.apply(this,arguments)}return n}()},{key:"getSceneInited",value:function(){return this.sceneInited}},{key:"getRenderList",value:function(){return this.layerList}},{key:"getLayers",value:function(){return this.layers}},{key:"getLayer",value:function(n){return this.layers.find(function(a){return a.id===n})}},{key:"getLayerByName",value:function(n){return this.layers.find(function(a){return a.name===n})}},{key:"remove",value:function(){var r=(0,ur.Z)(nt().mark(function a(u,f){var g,x;return nt().wrap(function(O){for(;;)switch(O.prev=O.next){case 0:f?(g=f.layerChildren.indexOf(u),g>-1&&f.layerChildren.splice(g,1)):(x=this.layers.indexOf(u),x>-1&&this.layers.splice(x,1)),u.destroy(),this.reRender(),this.emit("layerChange",this.layers);case 4:case"end":return O.stop()}},a,this)}));function n(a,u){return r.apply(this,arguments)}return n}()},{key:"removeAllLayers",value:function(){var r=(0,ur.Z)(nt().mark(function a(){return nt().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:this.destroy(),this.reRender();case 2:case"end":return f.stop()}},a,this)}));function n(){return r.apply(this,arguments)}return n}()},{key:"setEnableRender",value:function(n){this.enableRender=n}},{key:"renderLayers",value:function(){var r=(0,ur.Z)(nt().mark(function a(){var u,f,g,x,I,O;return nt().wrap(function(W){for(;;)switch(W.prev=W.next){case 0:if(!(this.alreadyInRendering||!this.enableRender)){W.next=2;break}return W.abrupt("return");case 2:this.updateLayerRenderList(),u=this.debugService.generateRenderUid(),this.debugService.renderStart(u),this.alreadyInRendering=!0,this.clear(),f=ld(this.layerList),W.prev=8,f.s();case 10:if((g=f.n()).done){W.next=23;break}if(x=g.value,I=x.getLayerConfig(),O=I.enableMask,x.masks.filter(function(he){return he.inited}).length>0&&O&&this.renderMask(x.masks),!x.getLayerConfig().enableMultiPassRenderer){W.next=19;break}return W.next=17,x.renderMultiPass();case 17:W.next=21;break;case 19:return W.next=21,x.render();case 21:W.next=10;break;case 23:W.next=28;break;case 25:W.prev=25,W.t0=W.catch(8),f.e(W.t0);case 28:return W.prev=28,f.f(),W.finish(28);case 31:this.debugService.renderEnd(u),this.alreadyInRendering=!1;case 33:case"end":return W.stop()}},a,this,[[8,25,28,31]])}));function n(){return r.apply(this,arguments)}return n}()},{key:"renderMask",value:function(n){var a=0;this.renderService.clear({stencil:0,depth:1,framebuffer:null});var u=n.length>1?x0.MULTIPLE:x0.SINGLE,f=ld(n),g;try{for(f.s();!(g=f.n()).done;){var x=g.value;x.render({isStencil:!0,stencilType:u,stencilIndex:a++})}}catch(I){f.e(I)}finally{f.f()}}},{key:"beforeRenderData",value:function(){var r=(0,ur.Z)(nt().mark(function a(u){var f;return nt().wrap(function(x){for(;;)switch(x.prev=x.next){case 0:return x.next=2,u.hooks.beforeRenderData.promise();case 2:f=x.sent,f&&this.renderLayers();case 4:case"end":return x.stop()}},a,this)}));function n(a){return r.apply(this,arguments)}return n}()},{key:"renderTileLayerMask",value:function(n){var a=0,u=n.getLayerConfig(),f=u.enableMask,g=f===void 0?!0:f,x=n.tileMask?1:0,I=n.masks.filter(function(ae){return ae.inited});x=x+(g?I.length:1);var O=x>1?x0.MULTIPLE:x0.SINGLE;if((n.tileMask||I.length&&g)&&this.renderService.clear({stencil:0,depth:1,framebuffer:null}),I.length&&g){var B=ld(I),W;try{for(B.s();!(W=B.n()).done;){var he=W.value;he.render({isStencil:!0,stencilType:O,stencilIndex:a++})}}catch(ae){B.e(ae)}finally{B.f()}}n.tileMask&&n.tileMask.render({isStencil:!0,stencilType:O,stencilIndex:a++,stencilOperation:kh.OR})}},{key:"renderTileLayer",value:function(){var r=(0,ur.Z)(nt().mark(function a(u){return nt().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:if(this.renderTileLayerMask(u),!u.getLayerConfig().enableMultiPassRenderer){g.next=6;break}return g.next=4,u.renderMultiPass();case 4:g.next=8;break;case 6:return g.next=8,u.render();case 8:case"end":return g.stop()}},a,this)}));function n(a){return r.apply(this,arguments)}return n}()},{key:"updateLayerRenderList",value:function(){var n=this;this.layerList=[],this.layers.filter(function(a){return a.inited}).filter(function(a){return a.isVisible()}).sort(function(a,u){return a.zIndex-u.zIndex}).forEach(function(a){n.layerList.push(a)})}},{key:"destroy",value:function(){this.layers.forEach(function(n){n.destroy()}),this.layers=[],this.layerList=[],this.emit("layerChange",this.layers)}},{key:"startAnimate",value:function(){this.animateInstanceCount++===0&&(this.clock.start(),this.runRender())}},{key:"stopAnimate",value:function(){--this.animateInstanceCount===0&&(this.stopRender(),this.clock.stop())}},{key:"getOESTextureFloat",value:function(){return this.renderService.extensionObject.OES_texture_float}},{key:"enableShaderPick",value:function(){this.shaderPicking=!0}},{key:"disableShaderPick",value:function(){this.shaderPicking=!1}},{key:"getShaderPickStat",value:function(){return this.shaderPicking}},{key:"clear",value:function(){var n=Ni(this.mapService.bgColor);this.renderService.clear({color:n,depth:1,stencil:0,framebuffer:null})}},{key:"runRender",value:function(){this.renderLayers(),this.layerRenderID=window.requestAnimationFrame(this.runRender.bind(this))}},{key:"stopRender",value:function(){window.cancelAnimationFrame(this.layerRenderID)}}]),t}(xa.EventEmitter),Zv=Hi(sh.prototype,"renderService",[Fv],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),qA=Hi(sh.prototype,"mapService",[Bv],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ud=Hi(sh.prototype,"debugService",[QA],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),sh))||Gh),hc=C(52528),Gv=In.isNil,hm=function(){function e(i){var t=this;(0,ue.Z)(this,e),(0,Ce.Z)(this,"name",void 0),(0,Ce.Z)(this,"type",void 0),(0,Ce.Z)(this,"scale",void 0),(0,Ce.Z)(this,"descriptor",void 0),(0,Ce.Z)(this,"featureBufferLayout",[]),(0,Ce.Z)(this,"needRescale",!1),(0,Ce.Z)(this,"needRemapping",!1),(0,Ce.Z)(this,"needRegenerateVertices",!1),(0,Ce.Z)(this,"featureRange",{startIndex:0,endIndex:1/0}),(0,Ce.Z)(this,"vertexAttribute",void 0),(0,Ce.Z)(this,"defaultCallback",function(r){if(r.length===0){var n;return((n=t.scale)===null||n===void 0?void 0:n.defaultValues)||[]}return r.map(function(a,u){var f,g=(f=t.scale)===null||f===void 0?void 0:f.scalers[u].func,x=g(a);return x})}),this.setProps(i)}return(0,me.Z)(e,[{key:"setProps",value:function(t){Object.assign(this,t)}},{key:"mapping",value:function(t){var r;if((r=this.scale)!==null&&r!==void 0&&r.callback){var n,a=(n=this.scale)===null||n===void 0?void 0:n.callback.apply(n,(0,Mr.Z)(t));if(!Gv(a))return[a]}return this.defaultCallback(t)}},{key:"resetDescriptor",value:function(){this.descriptor&&(this.descriptor.buffer.data=[])}}]),e}(),Am=["buffer","update","name"],jv=["buffer","update","name"],jh,KA,I0,JA,hd,ep,pm=(jh={},(0,Ce.Z)(jh,Ge.FLOAT,4),(0,Ce.Z)(jh,Ge.UNSIGNED_BYTE,1),(0,Ce.Z)(jh,Ge.UNSIGNED_SHORT,2),jh),tp=(KA=(0,dr.b2)(),I0=(0,dr.f3)(Xt.IRendererService),KA(JA=(hd=function(){function e(){(0,ue.Z)(this,e),(0,Ce.Z)(this,"attributesAndIndices",void 0),Ki(this,"rendererService",ep,this),(0,Ce.Z)(this,"attributes",[]),(0,Ce.Z)(this,"triangulation",void 0),(0,Ce.Z)(this,"featureLayout",{sizePerElement:0,elements:[]})}return(0,me.Z)(e,[{key:"registerStyleAttribute",value:function(t){var r=this.getLayerStyleAttribute(t.name||"");return r?r.setProps(t):(r=new hm(t),this.attributes.push(r)),r}},{key:"unRegisterStyleAttribute",value:function(t){var r=this.attributes.findIndex(function(n){return n.name===t});r>-1&&this.attributes.splice(r,1)}},{key:"updateScaleAttribute",value:function(t){this.attributes.forEach(function(r){var n,a=r.name,u=(n=r.scale)===null||n===void 0?void 0:n.field;(t[a]||u&&t[u])&&(r.needRescale=!0,r.needRemapping=!0,r.needRegenerateVertices=!0)})}},{key:"updateStyleAttribute",value:function(t,r,n){var a=this.getLayerStyleAttribute(t);a||(a=this.registerStyleAttribute((0,X.Z)((0,X.Z)({},r),{},{name:t})));var u=r.scale;u&&a&&(a.scale=u,a.needRescale=!0,a.needRemapping=!0,a.needRegenerateVertices=!0,n&&n.featureRange&&(a.featureRange=n.featureRange))}},{key:"getLayerStyleAttributes",value:function(){return this.attributes}},{key:"getLayerStyleAttribute",value:function(t){return this.attributes.find(function(r){return r.name===t})}},{key:"getLayerAttributeScale",value:function(t){var r,n=this.getLayerStyleAttribute(t),a=n==null||(r=n.scale)===null||r===void 0?void 0:r.scalers;return a&&a[0]?a[0].func:null}},{key:"updateAttributeByFeatureRange",value:function(t,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,a=arguments.length>3?arguments[3]:void 0,u=arguments.length>4?arguments[4]:void 0,f=this.attributes.find(function(Et){return Et.name===t});if(f&&f.descriptor){var g=f.descriptor,x=g.update,I=g.buffer,O=g.size,B=O===void 0?0:O,W=pm[I.type||Ge.FLOAT];if(x){var he=this.featureLayout,ae=he.elements,Se=he.sizePerElement,Fe=ae.slice(n,a);if(!Fe.length)return;var Qe=Fe[0].offset,qe=Qe*B*W,yt=Fe.map(function(Et,Ot){for(var jt=Et.featureIdx,or=Et.vertices,ar=Et.normals,br=or.length/Se,pr=[],jr=0;jr<br;jr++){var nn=ar?ar.slice(jr*3,jr*3+3):[];pr.push.apply(pr,(0,Mr.Z)(x(r[jt],jt,or.slice(jr*Se,jr*Se+Se),Ot,nn)))}return pr}).reduce(function(Et,Ot){return Et.push.apply(Et,(0,Mr.Z)(Ot)),Et},[]);f.vertexAttribute.updateBuffer({data:yt,offset:qe}),u==null||u.emit("legend:".concat(t),{type:t,attr:f})}}}},{key:"createAttributesAndIndices",value:function(t,r,n){var a=this;this.featureLayout={sizePerElement:0,elements:[]},r&&(this.triangulation=r);var u=this.attributes.map(function(Fe){return Fe.resetDescriptor(),Fe.descriptor}),f=0,g=0,x=[],I=3;t.forEach(function(Fe,Qe){var qe=a.triangulation(Fe,n),yt=qe.indices,Et=qe.vertices,Ot=qe.normals,jt=qe.size,or=qe.indexes,ar=qe.count;typeof ar=="number"&&(g+=ar),yt.forEach(function(nn){x.push(nn+f)}),I=jt;var br=Et.length/jt;a.featureLayout.sizePerElement=I,a.featureLayout.elements.push({featureIdx:Qe,vertices:Et,normals:Ot,offset:f}),f+=br;for(var pr=function(yn){var ma=(Ot==null?void 0:Ot.slice(yn*3,yn*3+3))||[],Ho=Et.slice(yn*jt,yn*jt+jt),Lo=0;or&&or[yn]!==void 0&&(Lo=or[yn]),u.forEach(function(Rs,ks){if(Rs&&Rs.update){var Wc;(Wc=Rs.buffer.data).push.apply(Wc,(0,Mr.Z)(Rs.update(Fe,Qe,Ho,yn,ma,Lo)))}})},jr=0;jr<br;jr++)pr(jr)});var O=this.rendererService,B=O.createAttribute,W=O.createBuffer,he=O.createElements,ae={};u.forEach(function(Fe,Qe){if(Fe){var qe=Fe.buffer,yt=Fe.update,Et=Fe.name,Ot=(0,hc.Z)(Fe,Am),jt=B((0,X.Z)({buffer:W(qe)},Ot));ae[Fe.name||""]=jt,a.attributes[Qe].vertexAttribute=jt}});var Se=he({data:x,type:Ge.UNSIGNED_INT,count:x.length});return this.attributesAndIndices={attributes:ae,elements:Se,count:g},this.attributesAndIndices}},{key:"createAttributes",value:function(t,r){var n=this;this.featureLayout={sizePerElement:0,elements:[]},r&&(this.triangulation=r);var a=this.attributes.map(function(W){return W.resetDescriptor(),W.descriptor}),u=0,f=[],g=3;t.forEach(function(W,he){var ae=n.triangulation(W),Se=ae.indices,Fe=ae.vertices,Qe=ae.normals,qe=ae.size,yt=ae.indexes;Se.forEach(function(or){f.push(or+u)}),g=qe;var Et=Fe.length/qe;n.featureLayout.sizePerElement=g,n.featureLayout.elements.push({featureIdx:he,vertices:Fe,normals:Qe,offset:u}),u+=Et;for(var Ot=function(ar){var br=(Qe==null?void 0:Qe.slice(ar*3,ar*3+3))||[],pr=Fe.slice(ar*qe,ar*qe+qe),jr=0;yt&&yt[ar]!==void 0&&(jr=yt[ar]),a.forEach(function(nn,yn){if(nn&&nn.update){var ma;(ma=nn.buffer.data).push.apply(ma,(0,Mr.Z)(nn.update(W,he,pr,ar,br,jr)))}})},jt=0;jt<Et;jt++)Ot(jt)});var x=this.rendererService,I=x.createAttribute,O=x.createBuffer,B={};return a.forEach(function(W,he){if(W){var ae=W.buffer,Se=W.update,Fe=W.name,Qe=(0,hc.Z)(W,jv),qe=I((0,X.Z)({buffer:O(ae)},Qe));B[W.name||""]=qe,n.attributes[he].vertexAttribute=qe}}),{attributes:B}}},{key:"clearAllAttributes",value:function(){var t;this.attributes.forEach(function(r){r.vertexAttribute&&r.vertexAttribute.destroy()}),(t=this.attributesAndIndices)===null||t===void 0||t.elements.destroy(),this.attributes=[]}}]),e}(),ep=Hi(hd.prototype,"rendererService",[I0],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),hd))||JA),Ad=C(97671);function rp(e,i,t,r){function n(a){return a instanceof t?a:new t(function(u){u(a)})}return new(t||(t=Promise))(function(a,u){function f(I){try{x(r.next(I))}catch(O){u(O)}}function g(I){try{x(r.throw(I))}catch(O){u(O)}}function x(I){I.done?a(I.value):n(I.value).then(f,g)}x((r=r.apply(e,i||[])).next())})}function L0(e,i){var t={label:0,sent:function(){if(a[0]&1)throw a[1];return a[1]},trys:[],ops:[]},r,n,a,u;return u={next:f(0),throw:f(1),return:f(2)},typeof Symbol=="function"&&(u[Symbol.iterator]=function(){return this}),u;function f(x){return function(I){return g([x,I])}}function g(x){if(r)throw new TypeError("Generator is already executing.");for(;t;)try{if(r=1,n&&(a=x[0]&2?n.return:x[0]?n.throw||((a=n.return)&&a.call(n),0):n.next)&&!(a=a.call(n,x[1])).done)return a;switch(n=0,a&&(x=[x[0]&2,a.value]),x[0]){case 0:case 1:a=x;break;case 4:return t.label++,{value:x[1],done:!1};case 5:t.label++,n=x[1],x=[0];continue;case 7:x=t.ops.pop(),t.trys.pop();continue;default:if(a=t.trys,!(a=a.length>0&&a[a.length-1])&&(x[0]===6||x[0]===2)){t=0;continue}if(x[0]===3&&(!a||x[1]>a[0]&&x[1]<a[3])){t.label=x[1];break}if(x[0]===6&&t.label<a[1]){t.label=a[1],a=x;break}if(a&&t.label<a[2]){t.label=a[2],t.ops.push(x);break}a[2]&&t.ops.pop(),t.trys.pop();continue}x=i.call(e,t)}catch(I){x=[6,I],n=0}finally{r=a=0}if(x[0]&5)throw x[1];return{value:x[0]?x[1]:void 0,done:!0}}}function Vh(e,i){var t=typeof Symbol=="function"&&e[Symbol.iterator];if(!t)return e;var r=t.call(e),n,a=[],u;try{for(;(i===void 0||i-- >0)&&!(n=r.next()).done;)a.push(n.value)}catch(f){u={error:f}}finally{try{n&&!n.done&&(t=r.return)&&t.call(r)}finally{if(u)throw u.error}}return a}function np(e,i,t){if(t||arguments.length===2)for(var r=0,n=i.length,a;r<n;r++)(a||!(r in i))&&(a||(a=Array.prototype.slice.call(i,0,r)),a[r]=i[r]);return e.concat(a||Array.prototype.slice.call(i))}function uh(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var pd={exports:{}},Hh={exports:{}},$h={exports:{}};(function(e,i){Object.defineProperty(i,"__esModule",{value:!0}),i.default=t;function t(r){return r&&typeof r.length=="number"&&r.length>=0&&r.length%1===0}e.exports=i.default})($h,$h.exports);var Wu={},dd={exports:{}},P0={exports:{}};(function(e,i){Object.defineProperty(i,"__esModule",{value:!0}),i.default=function(t){return function(){for(var r=[],n=arguments.length;n--;)r[n]=arguments[n];var a=r.pop();return t.call(this,r,a)}},e.exports=i.default})(P0,P0.exports);var qf={};Object.defineProperty(qf,"__esModule",{value:!0}),qf.fallback=Vv,qf.wrap=ip;var vd=qf.hasQueueMicrotask=typeof queueMicrotask=="function"&&queueMicrotask,dm=qf.hasSetImmediate=typeof setImmediate=="function"&&setImmediate,gd=qf.hasNextTick=typeof Ad=="object"&&typeof Ad.nextTick=="function";function Vv(e){setTimeout(e,0)}function ip(e){return function(i){for(var t=[],r=arguments.length-1;r-- >0;)t[r]=arguments[r+1];return e(function(){return i.apply(void 0,t)})}}var Wh;vd?Wh=queueMicrotask:dm?Wh=setImmediate:gd?Wh=Ad.nextTick:Wh=Vv,qf.default=ip(Wh),function(e,i){Object.defineProperty(i,"__esModule",{value:!0}),i.default=g;var t=P0.exports,r=f(t),n=qf,a=f(n),u=Wu;function f(O){return O&&O.__esModule?O:{default:O}}function g(O){return(0,u.isAsync)(O)?function(){for(var B=[],W=arguments.length;W--;)B[W]=arguments[W];var he=B.pop(),ae=O.apply(this,B);return x(ae,he)}:(0,r.default)(function(B,W){var he;try{he=O.apply(this,B)}catch(ae){return W(ae)}if(he&&typeof he.then=="function")return x(he,W);W(null,he)})}function x(O,B){return O.then(function(W){I(B,null,W)},function(W){I(B,W&&W.message?W:new Error(W))})}function I(O,B,W){try{O(B,W)}catch(he){(0,a.default)(function(ae){throw ae},he)}}e.exports=i.default}(dd,dd.exports),Object.defineProperty(Wu,"__esModule",{value:!0}),Wu.isAsyncIterable=Wu.isAsyncGenerator=Wu.isAsync=void 0;var md=dd.exports,vm=gm(md);function gm(e){return e&&e.__esModule?e:{default:e}}function lh(e){return e[Symbol.toStringTag]==="AsyncFunction"}function yd(e){return e[Symbol.toStringTag]==="AsyncGenerator"}function _d(e){return typeof e[Symbol.asyncIterator]=="function"}function xd(e){if(typeof e!="function")throw new Error("expected a function");return lh(e)?(0,vm.default)(e):e}Wu.default=xd,Wu.isAsync=lh,Wu.isAsyncGenerator=yd,Wu.isAsyncIterable=_d;var Kf={exports:{}};(function(e,i){Object.defineProperty(i,"__esModule",{value:!0}),i.default=t;function t(r,n){if(n===void 0&&(n=r.length),!n)throw new Error("arity is undefined");function a(){for(var u=this,f=[],g=arguments.length;g--;)f[g]=arguments[g];return typeof f[n-1]=="function"?r.apply(this,f):new Promise(function(x,I){f[n-1]=function(O){for(var B=[],W=arguments.length-1;W-- >0;)B[W]=arguments[W+1];if(O)return I(O);x(B.length>1?B:B[0])},r.apply(u,f)})}return a}e.exports=i.default})(Kf,Kf.exports),function(e,i){Object.defineProperty(i,"__esModule",{value:!0});var t=$h.exports,r=g(t),n=Wu,a=g(n),u=Kf.exports,f=g(u);function g(x){return x&&x.__esModule?x:{default:x}}i.default=(0,f.default)(function(x,I,O){var B=(0,r.default)(I)?[]:{};x(I,function(W,he,ae){(0,a.default)(W)(function(Se){for(var Fe,Qe=[],qe=arguments.length-1;qe-- >0;)Qe[qe]=arguments[qe+1];Qe.length<2&&(Fe=Qe,Qe=Fe[0]),B[he]=Qe,ae(Se)})},function(W){return O(W,B)})},3),e.exports=i.default}(Hh,Hh.exports);var Ed={exports:{}},ap={exports:{}},bd={exports:{}},Yh={exports:{}};(function(e,i){Object.defineProperty(i,"__esModule",{value:!0}),i.default=t;function t(r){function n(){for(var a=[],u=arguments.length;u--;)a[u]=arguments[u];if(r!==null){var f=r;r=null,f.apply(this,a)}}return Object.assign(n,r),n}e.exports=i.default})(Yh,Yh.exports);var Sd={exports:{}},Cd={exports:{}};(function(e,i){Object.defineProperty(i,"__esModule",{value:!0}),i.default=function(t){return t[Symbol.iterator]&&t[Symbol.iterator]()},e.exports=i.default})(Cd,Cd.exports),function(e,i){Object.defineProperty(i,"__esModule",{value:!0}),i.default=I;var t=$h.exports,r=u(t),n=Cd.exports,a=u(n);function u(O){return O&&O.__esModule?O:{default:O}}function f(O){var B=-1,W=O.length;return function(){return++B<W?{value:O[B],key:B}:null}}function g(O){var B=-1;return function(){var he=O.next();return he.done?null:(B++,{value:he.value,key:B})}}function x(O){var B=O?Object.keys(O):[],W=-1,he=B.length;return function ae(){var Se=B[++W];return Se==="__proto__"?ae():W<he?{value:O[Se],key:Se}:null}}function I(O){if((0,r.default)(O))return f(O);var B=(0,a.default)(O);return B?g(B):x(O)}e.exports=i.default}(Sd,Sd.exports);var ch={exports:{}};(function(e,i){Object.defineProperty(i,"__esModule",{value:!0}),i.default=t;function t(r){return function(){for(var n=[],a=arguments.length;a--;)n[a]=arguments[a];if(r===null)throw new Error("Callback was already called.");var u=r;r=null,u.apply(this,n)}}e.exports=i.default})(ch,ch.exports);var op={exports:{}},Xh={exports:{}};(function(e,i){Object.defineProperty(i,"__esModule",{value:!0});var t={};i.default=t,e.exports=i.default})(Xh,Xh.exports),function(e,i){Object.defineProperty(i,"__esModule",{value:!0}),i.default=a;var t=Xh.exports,r=n(t);function n(u){return u&&u.__esModule?u:{default:u}}function a(u,f,g,x){var I=!1,O=!1,B=!1,W=0,he=0;function ae(){W>=f||B||I||(B=!0,u.next().then(function(Qe){var qe=Qe.value,yt=Qe.done;if(!(O||I)){if(B=!1,yt){I=!0,W<=0&&x(null);return}W++,g(qe,he,Se),he++,ae()}}).catch(Fe))}function Se(Qe,qe){if(W-=1,!O){if(Qe)return Fe(Qe);if(Qe===!1){I=!0,O=!0;return}if(qe===r.default||I&&W<=0)return I=!0,x(null);ae()}}function Fe(Qe){O||(B=!1,I=!0,x(Qe))}ae()}e.exports=i.default}(op,op.exports),function(e,i){Object.defineProperty(i,"__esModule",{value:!0});var t=Yh.exports,r=W(t),n=Sd.exports,a=W(n),u=ch.exports,f=W(u),g=Wu,x=op.exports,I=W(x),O=Xh.exports,B=W(O);function W(he){return he&&he.__esModule?he:{default:he}}i.default=function(he){return function(ae,Se,Fe){if(Fe=(0,r.default)(Fe),he<=0)throw new RangeError("concurrency limit cannot be less than 1");if(!ae)return Fe(null);if((0,g.isAsyncGenerator)(ae))return(0,I.default)(ae,he,Se,Fe);if((0,g.isAsyncIterable)(ae))return(0,I.default)(ae[Symbol.asyncIterator](),he,Se,Fe);var Qe=(0,a.default)(ae),qe=!1,yt=!1,Et=0,Ot=!1;function jt(ar,br){if(!yt)if(Et-=1,ar)qe=!0,Fe(ar);else if(ar===!1)qe=!0,yt=!0;else{if(br===B.default||qe&&Et<=0)return qe=!0,Fe(null);Ot||or()}}function or(){for(Ot=!0;Et<he&&!qe;){var ar=Qe();if(ar===null){qe=!0,Et<=0&&Fe(null);return}Et+=1,Se(ar.value,ar.key,(0,f.default)(jt))}Ot=!1}or()}},e.exports=i.default}(bd,bd.exports),function(e,i){Object.defineProperty(i,"__esModule",{value:!0});var t=bd.exports,r=g(t),n=Wu,a=g(n),u=Kf.exports,f=g(u);function g(I){return I&&I.__esModule?I:{default:I}}function x(I,O,B,W){return(0,r.default)(O)(I,(0,a.default)(B),W)}i.default=(0,f.default)(x,4),e.exports=i.default}(ap,ap.exports),function(e,i){Object.defineProperty(i,"__esModule",{value:!0});var t=ap.exports,r=u(t),n=Kf.exports,a=u(n);function u(g){return g&&g.__esModule?g:{default:g}}function f(g,x,I){return(0,r.default)(g,1,x,I)}i.default=(0,a.default)(f,3),e.exports=i.default}(Ed,Ed.exports),function(e,i){Object.defineProperty(i,"__esModule",{value:!0}),i.default=f;var t=Hh.exports,r=u(t),n=Ed.exports,a=u(n);function u(g){return g&&g.__esModule?g:{default:g}}function f(g,x){return(0,r.default)(a.default,g,x)}e.exports=i.default}(pd,pd.exports);var sp=uh(pd.exports),Uc=function(){function e(){this.args=[],this.tasks=[]}return e.prototype.call=function(){for(var i=arguments,t=[],r=0;r<arguments.length;r++)t[r]=i[r];return this.args=t,sp(this.tasks)},e.prototype.tap=function(i,t){var r=this;this.tasks.push(function(n){t.apply(void 0,np([],Vh(r.args),!1)),n(null,i)})},e}(),Qh={exports:{}},up={exports:{}};(function(e,i){Object.defineProperty(i,"__esModule",{value:!0});var t=$h.exports,r=Se(t),n=Xh.exports,a=Se(n),u=ap.exports,f=Se(u),g=Yh.exports,x=Se(g),I=ch.exports,O=Se(I),B=Wu,W=Se(B),he=Kf.exports,ae=Se(he);function Se(yt){return yt&&yt.__esModule?yt:{default:yt}}function Fe(yt,Et,Ot){Ot=(0,x.default)(Ot);var jt=0,or=0,ar=yt.length,br=!1;ar===0&&Ot(null);function pr(jr,nn){jr===!1&&(br=!0),br!==!0&&(jr?Ot(jr):(++or===ar||nn===a.default)&&Ot(null))}for(;jt<ar;jt++)Et(yt[jt],jt,(0,O.default)(pr))}function Qe(yt,Et,Ot){return(0,f.default)(yt,1/0,Et,Ot)}function qe(yt,Et,Ot){var jt=(0,r.default)(yt)?Fe:Qe;return jt(yt,(0,W.default)(Et),Ot)}i.default=(0,ae.default)(qe,3),e.exports=i.default})(up,up.exports),function(e,i){Object.defineProperty(i,"__esModule",{value:!0}),i.default=f;var t=up.exports,r=u(t),n=Hh.exports,a=u(n);function u(g){return g&&g.__esModule?g:{default:g}}function f(g,x){return(0,a.default)(r.default,g,x)}e.exports=i.default}(Qh,Qh.exports);var mm=uh(Qh.exports),Sx=function(){function e(){this.tasks=[]}return e.prototype.promise=function(){return mm(this.tasks)},e.prototype.tapPromise=function(i,t){var r=this;this.tasks.push(function(n){return rp(r,void 0,void 0,function(){return L0(this,function(a){switch(a.label){case 0:return[4,t()];case 1:return a.sent(),n(null,i),[2]}})})})},e}(),wd={exports:{}};(function(e,i){Object.defineProperty(i,"__esModule",{value:!0});var t=Yh.exports,r=I(t),n=ch.exports,a=I(n),u=Wu,f=I(u),g=Kf.exports,x=I(g);function I(B){return B&&B.__esModule?B:{default:B}}function O(B,W){if(W=(0,r.default)(W),!Array.isArray(B))return W(new Error("First argument to waterfall must be an array of functions"));if(!B.length)return W();var he=0;function ae(Fe){var Qe=(0,f.default)(B[he++]);Qe.apply(void 0,Fe.concat([(0,a.default)(Se)]))}function Se(Fe){for(var Qe=[],qe=arguments.length-1;qe-- >0;)Qe[qe]=arguments[qe+1];if(Fe!==!1){if(Fe||he===B.length)return W.apply(void 0,[Fe].concat(Qe));ae(Qe)}}ae([])}i.default=(0,x.default)(O),e.exports=i.default})(wd,wd.exports);var Hv=uh(wd.exports),Cx=function(){function e(){this.tasks=[]}return e.prototype.call=function(){return Hv(this.tasks)},e.prototype.tap=function(i,t){this.tasks.length===0?this.tasks.push(function(r){var n=t();r(n?null:!1,n)}):this.tasks.push(function(r,n){var a=t.apply(void 0,np([],Vh(r),!1));n(a?null:!1,i)})},e}(),$v=function(){function e(){this.tasks=[]}return e.prototype.call=function(){return sp(this.tasks)},e.prototype.tap=function(i,t){this.tasks.push(function(r){var n=t();r(n,i)})},e}(),ym=function(){function e(){this.args=[],this.tasks=[]}return e.prototype.promise=function(){for(var i=arguments,t=[],r=0;r<arguments.length;r++)t[r]=i[r];return this.args=t,sp(this.tasks)},e.prototype.tapPromise=function(i,t){var r=this;this.tasks.push(function(n){return rp(r,void 0,void 0,function(){return L0(this,function(a){switch(a.label){case 0:return[4,t.apply(void 0,np([],Vh(this.args),!1))];case 1:return a.sent(),n(null,i),[2]}})})})},e}(),_m=function(){function e(){this.args=[],this.tasks=[]}return e.prototype.promise=function(){for(var i=arguments,t=[],r=0;r<arguments.length;r++)t[r]=i[r];return this.args=t,sp(this.tasks)},e.prototype.tapPromise=function(i,t){var r=this;this.tasks.push(function(n){return rp(r,void 0,void 0,function(){var a;return L0(this,function(u){switch(u.label){case 0:return[4,t.apply(void 0,np([],Vh(this.args),!1))];case 1:return a=u.sent(),n(a,i),[2]}})})})},e}(),l=function(){function e(){this.tasks=[]}return e.prototype.promise=function(){return Hv(this.tasks)},e.prototype.tapPromise=function(i,t){this.tasks.length===0?this.tasks.push(function(r){t().then(function(n){r(null,n)})}):this.tasks.push(function(r,n){t(r).then(function(a){n(null,a)})})},e}(),A=C(67499),y=C.n(A),b,T,L,R,U,H,N,Q,K,ie,pe,pt,it,Nt,dt,Je,ht,Ht,Bt,ir,Kt,fr,Ct,oi,bn,Ei,$i,on,ii,Dn,Pa,ba,Ji,mu,_s;function ou(e){var i=Qa();return function(){var r=(0,oe.Z)(e),n;if(i){var a=(0,oe.Z)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return(0,Ze.Z)(this,n)}}function Qa(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var po=(b=(0,dr.b2)(),T=(0,dr.f3)(Xt.SceneID),L=(0,dr.f3)(Xt.IIconService),R=(0,dr.f3)(Xt.IFontService),U=(0,dr.f3)(Xt.IControlService),H=(0,dr.f3)(Xt.IGlobalConfigService),N=(0,dr.f3)(Xt.IMapService),Q=(0,dr.f3)(Xt.ICoordinateSystemService),K=(0,dr.f3)(Xt.IRendererService),ie=(0,dr.f3)(Xt.ILayerService),pe=(0,dr.f3)(Xt.IDebugService),pt=(0,dr.f3)(Xt.ICameraService),it=(0,dr.f3)(Xt.IInteractionService),Nt=(0,dr.f3)(Xt.IPickingService),dt=(0,dr.f3)(Xt.IShaderModuleService),Je=(0,dr.f3)(Xt.IMarkerService),ht=(0,dr.f3)(Xt.IPopupService),b(Ht=(Bt=function(e){(0,ke.Z)(t,e);var i=ou(t);function t(){var r;return(0,ue.Z)(this,t),r=i.call(this),(0,Ce.Z)((0,bt.Z)(r),"destroyed",!1),(0,Ce.Z)((0,bt.Z)(r),"loaded",!1),Ki((0,bt.Z)(r),"id",ir,(0,bt.Z)(r)),Ki((0,bt.Z)(r),"iconService",Kt,(0,bt.Z)(r)),Ki((0,bt.Z)(r),"fontService",fr,(0,bt.Z)(r)),Ki((0,bt.Z)(r),"controlService",Ct,(0,bt.Z)(r)),Ki((0,bt.Z)(r),"configService",oi,(0,bt.Z)(r)),Ki((0,bt.Z)(r),"map",bn,(0,bt.Z)(r)),Ki((0,bt.Z)(r),"coordinateSystemService",Ei,(0,bt.Z)(r)),Ki((0,bt.Z)(r),"rendererService",$i,(0,bt.Z)(r)),Ki((0,bt.Z)(r),"layerService",on,(0,bt.Z)(r)),Ki((0,bt.Z)(r),"debugService",ii,(0,bt.Z)(r)),Ki((0,bt.Z)(r),"cameraService",Dn,(0,bt.Z)(r)),Ki((0,bt.Z)(r),"interactionService",Pa,(0,bt.Z)(r)),Ki((0,bt.Z)(r),"pickingService",ba,(0,bt.Z)(r)),Ki((0,bt.Z)(r),"shaderModuleService",Ji,(0,bt.Z)(r)),Ki((0,bt.Z)(r),"markerService",mu,(0,bt.Z)(r)),Ki((0,bt.Z)(r),"popupService",_s,(0,bt.Z)(r)),(0,Ce.Z)((0,bt.Z)(r),"inited",!1),(0,Ce.Z)((0,bt.Z)(r),"initPromise",void 0),(0,Ce.Z)((0,bt.Z)(r),"rendering",!1),(0,Ce.Z)((0,bt.Z)(r),"$container",void 0),(0,Ce.Z)((0,bt.Z)(r),"canvas",void 0),(0,Ce.Z)((0,bt.Z)(r),"markerContainer",void 0),(0,Ce.Z)((0,bt.Z)(r),"hooks",void 0),(0,Ce.Z)((0,bt.Z)(r),"handleWindowResized",function(){r.emit("resize"),r.$container&&(r.initContainer(),Yo(),r.coordinateSystemService.needRefresh=!0,r.render())}),(0,Ce.Z)((0,bt.Z)(r),"handleMapCameraChanged",function(n){r.cameraService.update(n),r.render()}),r.hooks={init:new ym},r}return(0,me.Z)(t,[{key:"init",value:function(n){var a=this;this.configService.setSceneConfig(this.id,n),this.shaderModuleService.registerBuiltinModules(),this.iconService.init(),this.iconService.on("imageUpdate",function(){return a.render()}),this.fontService.init(),this.hooks.init.tapPromise("initMap",(0,ur.Z)(nt().mark(function u(){return nt().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return a.debugService.log("map.mapInitStart",{type:a.map.version}),g.next=3,new Promise(function(x){a.map.onCameraChanged(function(I){a.cameraService.init(),a.cameraService.update(I),x()}),a.map.init()});case 3:a.map.onCameraChanged(a.handleMapCameraChanged),a.map.addMarkerContainer(),a.markerService.addMarkers(),a.markerService.addMarkerLayers(),a.popupService.initPopup(),a.interactionService.init(),a.interactionService.on($u.Drag,a.addSceneEvent.bind(a));case 10:case"end":return g.stop()}},u)}))),this.hooks.init.tapPromise("initRenderer",(0,ur.Z)(nt().mark(function u(){var f,g,x;return nt().wrap(function(O){for(;;)switch(O.prev=O.next){case 0:if(g=((f=a.map)===null||f===void 0?void 0:f.getOverlayContainer())||void 0,g?a.$container=g:a.$container=Jp(a.configService.getSceneConfig(a.id).id||""),!a.$container){O.next=13;break}return a.canvas=ci("canvas","",a.$container),a.setCanvas(),O.next=7,a.rendererService.init(a.canvas,a.configService.getSceneConfig(a.id),n.gl);case 7:a.registerContextLost(),a.initContainer(),y()(a.$container,a.handleWindowResized),window.matchMedia&&((x=window.matchMedia("screen and (-webkit-min-device-pixel-ratio: 1.5)"))===null||x===void 0||x.addListener(a.handleWindowResized)),O.next=14;break;case 13:console.error("\u5BB9\u5668 id \u4E0D\u5B58\u5728");case 14:a.pickingService.init(a.id);case 15:case"end":return O.stop()}},u)}))),this.render()}},{key:"registerContextLost",value:function(){var n=this,a=this.rendererService.getCanvas();a&&a.addEventListener("webglcontextlost",function(){return n.emit("webglcontextlost")})}},{key:"initMiniScene",value:function(n){var a=this;this.configService.setSceneConfig(this.id,n),this.shaderModuleService.registerBuiltinModules(),this.iconService.init(),this.iconService.on("imageUpdate",function(){return a.render()}),this.fontService.init(),this.hooks.init.tapPromise("initMap",(0,ur.Z)(nt().mark(function u(){return nt().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return g.next=2,new Promise(function(x){a.map.onCameraChanged(function(I){a.cameraService.init(),a.cameraService.update(I),a.map.version!=="GAODE2.x"&&x()}),a.map.initMiniMap()});case 2:a.map.onCameraChanged(a.handleMapCameraChanged),a.interactionService.init(),a.interactionService.on($u.Drag,a.addSceneEvent.bind(a));case 5:case"end":return g.stop()}},u)}))),this.hooks.init.tapPromise("initRenderer",(0,ur.Z)(nt().mark(function u(){var f;return nt().wrap(function(x){for(;;)switch(x.prev=x.next){case 0:if(f=n.canvas,a.$container=f||null,!a.$container){x.next=7;break}return x.next=5,a.rendererService.init(n.canvas,a.configService.getSceneConfig(a.id),void 0);case 5:x.next=8;break;case 7:console.error("\u5BB9\u5668 id \u4E0D\u5B58\u5728");case 8:a.pickingService.init(a.id);case 9:case"end":return x.stop()}},u)}))),this.initPromise=this.hooks.init.promise(),this.render()}},{key:"addLayer",value:function(n){this.layerService.sceneService=this,this.layerService.add(n)}},{key:"addMask",value:function(n){this.layerService.sceneService=this,this.layerService.addMask(n)}},{key:"render",value:function(){var r=(0,ur.Z)(nt().mark(function a(){return nt().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:if(!(this.rendering||this.destroyed)){f.next=2;break}return f.abrupt("return");case 2:if(this.rendering=!0,this.inited){f.next=16;break}return f.next=6,this.hooks.init.promise();case 6:return this.destroyed&&this.destroy(),f.next=9,this.layerService.initLayers();case 9:this.layerService.renderLayers(),this.controlService.addControls(),this.loaded=!0,this.emit("loaded"),this.inited=!0,f.next=20;break;case 16:return f.next=18,this.layerService.initLayers();case 18:return f.next=20,this.layerService.renderLayers();case 20:this.rendering=!1;case 21:case"end":return f.stop()}},a,this)}));function n(){return r.apply(this,arguments)}return n}()},{key:"addFontFace",value:function(n,a){this.fontService.addFontFace(n,a)}},{key:"getSceneContainer",value:function(){return this.$container}},{key:"exportPng",value:function(){var r=(0,ur.Z)(nt().mark(function a(u){var f,g,x;return nt().wrap(function(O){for(;;)switch(O.prev=O.next){case 0:return g=(f=this.$container)===null||f===void 0?void 0:f.getElementsByTagName("canvas")[0],O.next=3,this.render();case 3:return x=u==="jpg"?g==null?void 0:g.toDataURL("image/jpeg"):g==null?void 0:g.toDataURL("image/png"),O.abrupt("return",x);case 5:case"end":return O.stop()}},a,this)}));function n(a){return r.apply(this,arguments)}return n}()},{key:"getSceneConfig",value:function(){return this.configService.getSceneConfig(this.id)}},{key:"getPointSizeRange",value:function(){return this.rendererService.getPointSizeRange()}},{key:"addMarkerContainer",value:function(){var n=this.$container.parentElement;n!==null&&(this.markerContainer=ci("div","l7-marker-container",n))}},{key:"getMarkerContainer",value:function(){return this.markerContainer}},{key:"destroy",value:function(){var n=this,a,u;if(!this.inited){this.destroyed=!0;return}if((0,A.unbind)(this.$container,this.handleWindowResized),window.matchMedia){var f;(f=window.matchMedia("screen and (min-resolution: 2dppx)"))===null||f===void 0||f.removeListener(this.handleWindowResized)}this.pickingService.destroy(),this.layerService.destroy(),this.interactionService.destroy(),this.controlService.destroy(),this.markerService.destroy(),this.fontService.destroy(),this.iconService.destroy(),this.removeAllListeners(),this.inited=!1,this.map.destroy(),setTimeout(function(){var g;(g=n.$container)===null||g===void 0||g.removeChild(n.canvas),n.canvas=null,n.rendererService.destroy()}),(a=this.$container)===null||a===void 0||(u=a.parentNode)===null||u===void 0||u.removeChild(this.$container),this.emit("destroy")}},{key:"initContainer",value:function(){var n,a,u=la,f=((n=this.$container)===null||n===void 0?void 0:n.clientWidth)||400,g=((a=this.$container)===null||a===void 0?void 0:a.clientHeight)||300,x=this.canvas;x&&(x.width=f*u,x.height=g*u),this.rendererService.viewport({x:0,y:0,width:u*f,height:u*g})}},{key:"setCanvas",value:function(){var n,a,u=la,f=((n=this.$container)===null||n===void 0?void 0:n.clientWidth)||400,g=((a=this.$container)===null||a===void 0?void 0:a.clientHeight)||300,x=this.canvas;x.width=f*u,x.height=g*u,x.style.width="100%",x.style.height="100%"}},{key:"addSceneEvent",value:function(n){this.emit(n.type,n)}}]),t}(xa.EventEmitter),ir=Hi(Bt.prototype,"id",[T],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Kt=Hi(Bt.prototype,"iconService",[L],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),fr=Hi(Bt.prototype,"fontService",[R],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ct=Hi(Bt.prototype,"controlService",[U],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),oi=Hi(Bt.prototype,"configService",[H],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),bn=Hi(Bt.prototype,"map",[N],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ei=Hi(Bt.prototype,"coordinateSystemService",[Q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),$i=Hi(Bt.prototype,"rendererService",[K],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),on=Hi(Bt.prototype,"layerService",[ie],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ii=Hi(Bt.prototype,"debugService",[pe],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Dn=Hi(Bt.prototype,"cameraService",[pt],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Pa=Hi(Bt.prototype,"interactionService",[it],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ba=Hi(Bt.prototype,"pickingService",[Nt],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ji=Hi(Bt.prototype,"shaderModuleService",[dt],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),mu=Hi(Bt.prototype,"markerService",[Je],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),_s=Hi(Bt.prototype,"popupService",[ht],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Bt))||Ht);function Vo(e){var i=0;switch(e){case"vec2":case"ivec2":i=2;break;case"vec3":case"ivec3":i=3;break;case"vec4":case"ivec4":case"mat2":i=4;break;case"mat3":i=9;break;case"mat4":i=16;break;default:}return i}var Gc=/uniform\s+(bool|float|int|vec2|vec3|vec4|ivec2|ivec3|ivec4|mat2|mat3|mat4|sampler2D|samplerCube)\s+([\s\S]*?);/g;function Ql(e){var i={};return e=e.replace(Gc,function(t,r,n){var a=n.split(":"),u=a[0].trim(),f="";switch(a.length>1&&(f=a[1].trim()),r){case"bool":f=f==="true";break;case"float":case"int":f=Number(f);break;case"vec2":case"vec3":case"vec4":case"ivec2":case"ivec3":case"ivec4":case"mat2":case"mat3":case"mat4":f?f=f.replace("[","").replace("]","").split(",").reduce(function(g,x){return g.push(Number(x.trim())),g},[]):f=new Array(Vo(r)).fill(0);break;default:}return i[u]=f,"uniform ".concat(r," ").concat(u,`;
`)}),{content:e,uniforms:i}}var qh,O0,Kh=In.uniq,fh="#define PI 3.14159265359",Wv=`#define SHIFT_RIGHT17 1.0 / 131072.0
#define SHIFT_RIGHT18 1.0 / 262144.0
#define SHIFT_RIGHT19 1.0 / 524288.0
#define SHIFT_RIGHT20 1.0 / 1048576.0
#define SHIFT_RIGHT21 1.0 / 2097152.0
#define SHIFT_RIGHT22 1.0 / 4194304.0
#define SHIFT_RIGHT23 1.0 / 8388608.0
#define SHIFT_RIGHT24 1.0 / 16777216.0

#define SHIFT_LEFT17 131072.0
#define SHIFT_LEFT18 262144.0
#define SHIFT_LEFT19 524288.0
#define SHIFT_LEFT20 1048576.0
#define SHIFT_LEFT21 2097152.0
#define SHIFT_LEFT22 4194304.0
#define SHIFT_LEFT23 8388608.0
#define SHIFT_LEFT24 16777216.0

vec2 unpack_float(float packedValue) {
  int packedIntValue = int(packedValue);
  int v0 = packedIntValue / 256;
  return vec2(v0, packedIntValue - v0 * 256);
}

vec4 decode_color(vec2 encodedColor) {
  return vec4(
    unpack_float(encodedColor[0]) / 255.0,
    unpack_float(encodedColor[1]) / 255.0
  );
}
`,Yv=`#define ambientRatio 0.5
#define diffuseRatio 0.3
#define specularRatio 0.2


float calc_lighting(vec4 pos) {

    vec3 worldPos = vec3(pos * u_ModelMatrix);

    vec3 worldNormal = a_Normal;
      // //cal light weight
    vec3 viewDir = normalize(u_CameraPosition - worldPos);

    vec3 lightDir = normalize(vec3(1, -10.5, 12));

    vec3 halfDir = normalize(viewDir+lightDir);
      // //lambert
    float lambert = dot(worldNormal, lightDir);
        //specular
    float specular = pow(max(0.0, dot(worldNormal, halfDir)), 32.0);
        //sum to light weight
    float lightWeight = ambientRatio + diffuseRatio * lambert + specularRatio * specular;

    return lightWeight;
}
`,Xv=`// Blinn-Phong model
// apply lighting in vertex shader instead of fragment shader
// @see https://learnopengl.com/Advanced-Lighting/Advanced-Lighting
uniform float u_Ambient : 1.0;
uniform float u_Diffuse : 1.0;
uniform float u_Specular : 1.0;
uniform int u_NumOfDirectionalLights : 1;
uniform int u_NumOfSpotLights : 0;

#define SHININESS 32.0
#define MAX_NUM_OF_DIRECTIONAL_LIGHTS 3
#define MAX_NUM_OF_SPOT_LIGHTS 3

struct DirectionalLight {
  vec3 direction;
  vec3 ambient;
  vec3 diffuse;
  vec3 specular;
};

struct SpotLight {
  vec3 position;
  vec3 direction;
  vec3 ambient;
  vec3 diffuse;
  vec3 specular;
  float constant;
  float linear;
  float quadratic;
  float angle;
  float blur;
  float exponent;
};

uniform DirectionalLight u_DirectionalLights[MAX_NUM_OF_DIRECTIONAL_LIGHTS];
uniform SpotLight u_SpotLights[MAX_NUM_OF_SPOT_LIGHTS];

vec3 calc_directional_light(DirectionalLight light, vec3 normal, vec3 viewDir) {
  vec3 lightDir = normalize(light.direction);
  // diffuse shading
  float diff = max(dot(normal, lightDir), 0.0);
  // Blinn-Phong specular shading
  vec3 halfwayDir = normalize(lightDir + viewDir);
  float spec = pow(max(dot(normal, halfwayDir), 0.0), SHININESS);

  vec3 ambient = light.ambient * u_Ambient;
  vec3 diffuse = light.diffuse * diff * u_Diffuse;
  vec3 specular = light.specular * spec * u_Specular;

  return ambient + diffuse + specular;
}

// vec3 calc_spot_light(SpotLight light, vec3 normal, vec3 fragPos, vec3 viewDir) {
//   vec3 lightDir = normalize(light.position - fragPos);
//   // diffuse shading
//   float diff = max(dot(normal, lightDir), 0.0);
//   // specular shading
//   vec3 reflectDir = reflect(-lightDir, normal);
//   float spec = pow(max(dot(viewDir, reflectDir), 0.0), SHININESS);
//   // attenuation
//   float distance = length(light.position - fragPos);
//   float attenuation = 1.0 / (light.constant + light.linear * distance +
//           light.quadratic * (distance * distance));

//   vec3 ambient = light.ambient * u_Ambient;
//   vec3 diffuse = light.diffuse * diff * u_Diffuse;
//   vec3 specular = light.specular * spec * u_Specular;

//   float spotEffect = dot(normalize(light.direction), -lightDir);
//   float spotCosCutoff = cos(light.angle / 180.0 * PI);
//   float spotCosOuterCutoff = cos((light.angle + light.blur) / 180.0 * PI);
//   float spotCosInnerCutoff = cos((light.angle - light.blur) / 180.0 * PI);
//   if (spotEffect > spotCosCutoff) {
//     spotEffect = pow(smoothstep(spotCosOuterCutoff, spotCosInnerCutoff, spotEffect), light.exponent);
//   } else {
//     spotEffect = 0.0;
//   }

//   return ambient + attenuation * (spotEffect * diffuse + specular);
// }

vec3 calc_lighting(vec3 position, vec3 normal, vec3 viewDir) {
  vec3 weight = vec3(0.0);
  for (int i = 0; i < MAX_NUM_OF_DIRECTIONAL_LIGHTS; i++) {
    if (i >= u_NumOfDirectionalLights) {
      break;
    }
    weight += calc_directional_light(u_DirectionalLights[i], normal, viewDir);
  }
  // for (int i = 0; i < MAX_NUM_OF_SPOT_LIGHTS; i++) {
  //   if (i >= u_NumOfSpotLights) {
  //     break;
  //   }
  //   weight += calc_spot_light(u_SpotLights[i], normal, position, viewDir);
  // }
  return weight;
}
`,Qv=`varying vec4 v_PickingResult;
uniform vec4 u_HighlightColor : [0, 0, 0, 0];
uniform vec4 u_SelectColor : [0, 0, 0, 0];
uniform float u_PickingStage : 0.0;
uniform float u_shaderPick;

uniform float u_activeMix: 0;

#define PICKING_NONE 0.0
#define PICKING_ENCODE 1.0
#define PICKING_HIGHLIGHT 2.0
#define COLOR_SCALE 1. / 255.

#define HIGHLIGHT 1.0
#define SELECT 2.0

/*
 * Returns highlight color if this item is selected.
 */
vec4 filterHighlightColor(vec4 color, float weight) {
  // float selected = v_PickingResult.a;
  bool selected = bool(v_PickingResult.a);

  // if (selected == SELECT) {
  if (selected) {
  //   // \u70B9\u51FB\u9009\u4E2D\u72B6\u6001
  //   vec4 selectColor = u_SelectColor * COLOR_SCALE;
  //   return selectColor;
  // } else if (selected == HIGHLIGHT) {
  //   // hover \u9AD8\u4EAE\u72B6\u6001
    vec4 highLightColor = u_HighlightColor * COLOR_SCALE;

    float highLightAlpha = highLightColor.a;
    float highLightRatio = highLightAlpha / (highLightAlpha + color.a * (1.0 - highLightAlpha));

    vec3 resultRGB = mix(color.rgb, highLightColor.rgb, highLightRatio);
    return vec4(mix(resultRGB * weight, color.rgb, u_activeMix), color.a);
  } else {
    return color;
  }
}

/*
 * Returns picking color if picking enabled else unmodified argument.
 */
vec4 filterPickingColor(vec4 color) {
  vec3 pickingColor = v_PickingResult.rgb;
  if (u_PickingStage == PICKING_ENCODE && length(pickingColor) < 0.001) {
    discard;
  }
  return u_PickingStage == PICKING_ENCODE ? vec4(pickingColor, step(0.001,color.a)): color;
}

/*
 * Returns picking color if picking is enabled if not
 * highlight color if this item is selected, otherwise unmodified argument.
 */
vec4 filterColor(vec4 color) {
  // \u8FC7\u6EE4\u591A\u4F59\u7684 shader \u8BA1\u7B97
  // return color;
  if(u_shaderPick < 0.5) {
    return color; // \u6682\u65F6\u53BB\u9664 \u76F4\u63A5\u53D6\u6D88\u8BA1\u7B97\u5728\u9009\u4E2D\u65F6\u62D6\u62FD\u5730\u56FE\u4F1A\u6709\u95EE\u9898
  } else {
    return filterPickingColor(filterHighlightColor(color, 1.0));
  }
  
}

vec4 filterColorAlpha(vec4 color, float alpha) {
  // \u8FC7\u6EE4\u591A\u4F59\u7684 shader \u8BA1\u7B97
  // return color;
  if(u_shaderPick < 0.5) {
    return color; // \u6682\u65F6\u53BB\u9664 \u76F4\u63A5\u53D6\u6D88\u8BA1\u7B97\u5728\u9009\u4E2D\u65F6\u62D6\u62FD\u5730\u56FE\u4F1A\u6709\u95EE\u9898
  } else {
    return filterPickingColor(filterHighlightColor(color, alpha));
  }
}

`,Tx=`attribute vec3 a_PickingColor;
varying vec4 v_PickingResult;

uniform vec3 u_PickingColor : [0, 0, 0];
uniform vec3 u_CurrentSelectedId : [0, 0, 0];
uniform vec4 u_HighlightColor : [0, 0, 0, 0];
uniform vec4 u_SelectColor : [0, 0, 0, 0];
uniform float u_PickingStage : 0.0;
uniform float u_PickingThreshold : 1.0;
uniform float u_PickingBuffer: 0.0;
uniform float u_shaderPick;
uniform float u_EnableSelect: 0.0;

#define PICKING_NONE 0.0
#define PICKING_ENCODE 1.0
#define PICKING_HIGHLIGHT 2.0
#define COLOR_SCALE 1. / 255.

#define NORMAL 0.0
#define HIGHLIGHT 1.0
#define SELECT 2.0

bool isVertexPicked(vec3 vertexColor) {
  return
    abs(vertexColor.r - u_PickingColor.r) < u_PickingThreshold &&
    abs(vertexColor.g - u_PickingColor.g) < u_PickingThreshold &&
    abs(vertexColor.b - u_PickingColor.b) < u_PickingThreshold;
}

// \u5224\u65AD\u5F53\u524D\u70B9\u662F\u5426\u5DF2\u7ECF\u88AB select \u9009\u4E2D
bool isVertexSelected(vec3 vertexColor) {
  return
    abs(vertexColor.r - u_CurrentSelectedId.r) < u_PickingThreshold &&
    abs(vertexColor.g - u_CurrentSelectedId.g) < u_PickingThreshold &&
    abs(vertexColor.b - u_CurrentSelectedId.b) < u_PickingThreshold;
}

void setPickingColor(vec3 pickingColor) {
  if(u_shaderPick < 0.5) {
    return;
  }
  // compares only in highlight stage

  v_PickingResult.a = float((u_PickingStage == PICKING_HIGHLIGHT) && isVertexPicked(pickingColor));

  // if (u_EnableSelect == 1.0 && u_PickingStage == PICKING_HIGHLIGHT && isVertexSelected(pickingColor)) {
  //   // \u9009\u4E2D\u6001
  //   v_PickingResult.a = SELECT;
  // } else if (u_PickingStage == PICKING_HIGHLIGHT && isVertexPicked(pickingColor)) {
  //   // \u9AD8\u4EAE\u6001
  //   v_PickingResult.a = HIGHLIGHT;
  // } else {
  //   v_PickingResult.a = NORMAL;
  // }

  // Stores the picking color so that the fragment shader can render it during picking
  v_PickingResult.rgb = pickingColor * COLOR_SCALE;
}

float setPickingSize(float x) {
   return u_PickingStage == PICKING_ENCODE ? x + u_PickingBuffer : x;
}

float setPickingOrder(float z) {
   bool selected = bool(v_PickingResult.a);
   return selected ? z + 1. : 0.;
}
`,Mx=`
#define E 2.718281828459045
vec2 ProjectFlat(vec2 lnglat){
  float maxs=85.0511287798;
  float lat=max(min(maxs,lnglat.y),-maxs);
  float scale= 268435456.;
  float d=PI/180.;
  float x=lnglat.x*d;
  float y=lat*d;
  y=log(tan((PI/4.)+(y/2.)));

  float a=.5/PI,
  b=.5,
  c=-.5/PI;
  d=.5;
  x=scale*(a*x+b);
  y=scale*(c*y+d);
  return vec2(x,y);
}

vec2 unProjectFlat(vec2 px){
  float a=.5/PI;
  float b=.5;
  float c=-.5/PI;
  float d=.5;
  float scale = 268435456.;
  float x=(px.x/scale-b)/a;
  float y=(px.y/scale-d)/c;
  y=(atan(pow(E,y))-(PI/4.))*2.;
  d=PI/180.;
  float lat=y/d;
  float lng=x/d;
  return vec2(lng,lat);
}

float pixelDistance(vec2 from, vec2 to) {
 vec2 a1 = ProjectFlat(from);
 vec2 b1 = ProjectFlat(to);
 return distance(a1, b1);
}

// gaode2.0
vec2 customProject(vec2 lnglat) { // \u7ECF\u7EAC\u5EA6 => \u5E73\u9762\u5750\u6807
  float t = lnglat.x;
  float e = lnglat.y;
  float Sm = 180.0 / PI;
  float Tm = 6378137.0;
  float Rm = PI / 180.0;
  float r = 85.0511287798;
  e = max(min(r, e), -r);
  t *= Rm;
  e *= Rm;
  e = log(tan(PI / 4.0 + e / 2.0));
  return vec2(t * Tm, e * Tm);
}

vec2 unProjCustomCoord(vec2 point) { // \u5E73\u9762\u5750\u6807 => \u7ECF\u7EAC\u5EA6
  float Sm = 57.29577951308232; //180 / Math.PI
  float Tm = 6378137.0;
  float t = point.x;
  float e = point.y;
  return vec2(t / Tm * Sm, (2.0 * atan(exp(e / Tm)) - PI / 2.0) * Sm);
}


float customPixelDistance(vec2 from, vec2 to) {
 vec2 a1 = ProjectFlat(from);
 vec2 b1 = ProjectFlat(to);
 return distance(a1, b1);
}`,Ix=`#define TILE_SIZE 512.0
#define PI 3.1415926536
#define WORLD_SCALE TILE_SIZE / (PI * 2.0)

#define COORDINATE_SYSTEM_LNGLAT 1.0        // mapbox
#define COORDINATE_SYSTEM_LNGLAT_OFFSET 2.0 // mapbox offset
#define COORDINATE_SYSTEM_VECTOR_TILE 3.0
#define COORDINATE_SYSTEM_IDENTITY 4.0
#define COORDINATE_SYSTEM_P20 5.0           // amap
#define COORDINATE_SYSTEM_P20_OFFSET 6.0    // amap offset
#define COORDINATE_SYSTEM_METER_OFFSET 7.0

#define COORDINATE_SYSTEM_P20_2 8.0         // amap2.0

uniform mat4 u_ViewMatrix;
uniform mat4 u_ProjectionMatrix;
uniform mat4 u_ViewProjectionMatrix;
uniform float u_Zoom : 1;
uniform float u_ZoomScale : 1;

uniform float u_CoordinateSystem;
uniform vec2 u_ViewportCenter;
uniform vec4 u_ViewportCenterProjection;
uniform vec3 u_PixelsPerDegree;
uniform vec3 u_PixelsPerDegree2;
uniform vec3 u_PixelsPerMeter;

uniform vec2 u_ViewportSize;
uniform float u_DevicePixelRatio;
uniform float u_FocalDistance;
uniform vec3 u_CameraPosition;
uniform mat4 u_Mvp;

// web mercator coords -> world coords
vec2 project_mercator(vec2 lnglat) {
  float x = lnglat.x;
  return vec2(
    radians(x) + PI,
    PI - log(tan(PI * 0.25 + radians(lnglat.y) * 0.5))
  );
}

float project_scale(float meters) {
  return meters * u_PixelsPerMeter.z;
}


// offset coords -> world coords
vec4 project_offset(vec4 offset) {
  float dy = offset.y;
  dy = clamp(dy, -1., 1.);
  vec3 pixels_per_unit = u_PixelsPerDegree + u_PixelsPerDegree2 * dy;
  return vec4(offset.xyz * pixels_per_unit, offset.w);
}

vec3 project_normal(vec3 normal) {
  vec4 normal_modelspace = u_ModelMatrix * vec4(normal, 0.0);
  return normalize(normal_modelspace.xyz * u_PixelsPerMeter);
}

vec3 project_offset_normal(vec3 vector) {
  if (u_CoordinateSystem < COORDINATE_SYSTEM_LNGLAT + 0.01 && u_CoordinateSystem >COORDINATE_SYSTEM_LNGLAT - 0.01
    || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
    // normals generated by the polygon tesselator are in lnglat offsets instead of meters
    return normalize(vector * u_PixelsPerDegree);
  }
  return project_normal(vector);
}
// || u_CoordinateSystem < COORDINATE_SYSTEM_P20_OFFSET + 0.01 && u_CoordinateSystem >COORDINATE_SYSTEM_P20_OFFSET - 0.01
// reverse Y
vec3 reverse_offset_normal(vec3 vector) {
  if (u_CoordinateSystem == COORDINATE_SYSTEM_P20 ||u_CoordinateSystem == COORDINATE_SYSTEM_P20_OFFSET ) {
    return vector * vec3(1.0, -1.0, 1.0);
  }

  if (u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.0
    return vector;
  }
  return vector;
}

vec4 project_mvt_offset_position(vec4 position) {
  float a = COORDINATE_SYSTEM_LNGLAT_OFFSET;
  float b = COORDINATE_SYSTEM_P20_OFFSET;
  float c = COORDINATE_SYSTEM_LNGLAT;
  if (u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET || u_CoordinateSystem == COORDINATE_SYSTEM_P20_OFFSET) {
    return project_offset(vec4(0.0, 0.0, position.z, position.w));
  }
  if (u_CoordinateSystem < COORDINATE_SYSTEM_LNGLAT + 0.01 && u_CoordinateSystem >COORDINATE_SYSTEM_LNGLAT - 0.01) {
    return vec4(
      project_mercator(position.xy) * WORLD_SCALE * u_ZoomScale,
      project_scale(position.z),
      position.w
    );
  }
  return position;
}

vec4 project_position(vec4 position) {
  float a = COORDINATE_SYSTEM_LNGLAT_OFFSET;
  float b = COORDINATE_SYSTEM_P20_OFFSET;
  float c = COORDINATE_SYSTEM_LNGLAT;
  if (u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET
    || u_CoordinateSystem == COORDINATE_SYSTEM_P20_OFFSET) {
    float X = position.x - u_ViewportCenter.x;
    float Y = position.y - u_ViewportCenter.y;
    return project_offset(vec4(X, Y, position.z, position.w));
  }
  if (u_CoordinateSystem < COORDINATE_SYSTEM_LNGLAT + 0.01 && u_CoordinateSystem >COORDINATE_SYSTEM_LNGLAT - 0.01) {
    return vec4(
      project_mercator(position.xy) * WORLD_SCALE * u_ZoomScale,
      project_scale(position.z),
      position.w
    );
  }

  if (u_CoordinateSystem == COORDINATE_SYSTEM_P20) {
    return vec4(
      (project_mercator(position.xy) * WORLD_SCALE * u_ZoomScale - vec2(215440491., 106744817.)) * vec2(1., -1.),
      project_scale(position.z),
      position.w
    );
  }

  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) {
    // return vec4(
    //   (position.xy * WORLD_SCALE * u_ZoomScale) * vec2(1., -1.), 
    //   project_scale(position.z), 
    //   position.w);

     return vec4(
      position.xy, 
      project_scale(position.z), 
      position.w);
  }
  return position;

  // TODO: \u74E6\u7247\u5750\u6807\u7CFB & \u5E38\u89C4\u4E16\u754C\u5750\u6807\u7CFB
}
vec2 project_pixel_size_to_clipspace(vec2 pixels) {
  vec2 offset = pixels / u_ViewportSize * u_DevicePixelRatio * 2.0;
  return offset * u_FocalDistance;
}

float project_pixel_allmap(float pixel) {
  if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {
    return pixel * pow(2.0, u_Zoom);
  }
  return pixel * u_FocalDistance ;
}

// \u9002\u914D\u7EB9\u7406\u8D34\u56FE\u7684\u7B49\u50CF\u7D20\u5927\u5C0F
float project_pixel_texture(float pixel) {
  // mapbox zoom > 12
  if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
    return pixel * pow(0.5, u_Zoom) * u_FocalDistance ;
  }

  // amap2 zoom > 12
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) {
    return pixel * pow(2.0, (19.0 - 3.0 - u_Zoom))* u_FocalDistance ;
  }

  // amap zoom > 12
  if (u_CoordinateSystem == COORDINATE_SYSTEM_P20_OFFSET) {
    return pixel * pow(0.5, u_Zoom)* u_FocalDistance ;
  }
  
  // amap zoom < 12
  if (u_CoordinateSystem == COORDINATE_SYSTEM_P20) {
    return pixel * pow(2.0, (20.0 - u_Zoom))* u_FocalDistance ;
  }
  return pixel * 2.0 *  u_FocalDistance;;
}

// \u5728\u4E0D\u8BBA\u4EC0\u4E48\u5E95\u56FE\u4E0B\u9700\u8981\u7EDF\u4E00\u5904\u7406\u7684\u65F6\u5019\u4F7F\u7528
float project_float_pixel(float pixel) {
  if (u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
    // mapbox P20 \u5750\u6807\u7CFB\u4E0B\uFF0C\u4E3A\u4E86\u548C Web \u58A8\u5361\u6258\u5750\u6807\u7CFB\u7EDF\u4E00\uFF0Czoom \u9ED8\u8BA4\u51CF1
    return pixel * pow(2.0, (19.0 - u_Zoom))  * u_FocalDistance ;
  }
  if (u_CoordinateSystem == COORDINATE_SYSTEM_P20 || u_CoordinateSystem == COORDINATE_SYSTEM_P20_OFFSET) {
    // amap P20 \u5750\u6807\u7CFB\u4E0B\uFF0C\u4E3A\u4E86\u548C Web \u58A8\u5361\u6258\u5750\u6807\u7CFB\u7EDF\u4E00\uFF0Czoom \u9ED8\u8BA4\u51CF1
    return pixel * pow(2.0, (19.0 - u_Zoom));
  }
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) {
    // amap2 P20_2 \u5750\u6807\u7CFB\u4E0B\uFF0C\u4E3A\u4E86\u548C Web \u58A8\u5361\u6258\u5750\u6807\u7CFB\u7EDF\u4E00\uFF0Czoom \u9ED8\u8BA4\u51CF3
    return pixel * pow(2.0, (19.0 - 3.0 - u_Zoom))* u_FocalDistance ;
  }
  return pixel * u_FocalDistance;
}

float project_pixel(float pixel) {
  if (u_CoordinateSystem == COORDINATE_SYSTEM_P20 || u_CoordinateSystem == COORDINATE_SYSTEM_P20_OFFSET) {
    // amap P20 \u5750\u6807\u7CFB\u4E0B\uFF0C\u4E3A\u4E86\u548C Web \u58A8\u5361\u6258\u5750\u6807\u7CFB\u7EDF\u4E00\uFF0Czoom \u9ED8\u8BA4\u51CF1
    return pixel * pow(2.0, (19.0 - u_Zoom)) * u_FocalDistance ;
  }
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) {
    // amap2 P20_2 \u5750\u6807\u7CFB\u4E0B\uFF0C\u4E3A\u4E86\u548C Web \u58A8\u5361\u6258\u5750\u6807\u7CFB\u7EDF\u4E00\uFF0Czoom \u9ED8\u8BA4\u51CF3
    return pixel * pow(2.0, (19.0 - 3.0 - u_Zoom)) * u_FocalDistance ;
  }
  return pixel * u_FocalDistance;
}
vec2 project_pixel(vec2 pixel) {
  if (u_CoordinateSystem == COORDINATE_SYSTEM_P20 || u_CoordinateSystem == COORDINATE_SYSTEM_P20_OFFSET) {
    // P20 \u5750\u6807\u7CFB\u4E0B\uFF0C\u4E3A\u4E86\u548C Web \u58A8\u5361\u6258\u5750\u6807\u7CFB\u7EDF\u4E00\uFF0Czoom \u9ED8\u8BA4\u51CF1
    return pixel * pow(2.0, (19.0 - u_Zoom)) * u_FocalDistance ;
  }
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) {
    // P20_2 \u5750\u6807\u7CFB\u4E0B\uFF0C\u4E3A\u4E86\u548C Web \u58A8\u5361\u6258\u5750\u6807\u7CFB\u7EDF\u4E00\uFF0Czoom \u9ED8\u8BA4\u51CF3
    return pixel * pow(2.0, (19.0 - 3.0 - u_Zoom)) * u_FocalDistance ;
  }
  return pixel * -1. * u_FocalDistance;
}
vec3 project_pixel(vec3 pixel) {
  if (u_CoordinateSystem == COORDINATE_SYSTEM_P20 || u_CoordinateSystem == COORDINATE_SYSTEM_P20_OFFSET) {
    // P20 \u5750\u6807\u7CFB\u4E0B\uFF0C\u4E3A\u4E86\u548C Web \u58A8\u5361\u6258\u5750\u6807\u7CFB\u7EDF\u4E00\uFF0Czoom \u9ED8\u8BA4\u51CF1
    return pixel * pow(2.0, (19.0 - u_Zoom)) *  u_FocalDistance ;
  }
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) {
    // P20_2 \u5750\u6807\u7CFB\u4E0B\uFF0C\u4E3A\u4E86\u548C Web \u58A8\u5361\u6258\u5750\u6807\u7CFB\u7EDF\u4E00\uFF0Czoom \u9ED8\u8BA4\u51CF3
    return pixel * pow(2.0, (19.0 - 3.0 - u_Zoom))  * u_FocalDistance ;
  }
  return pixel * -1. * u_FocalDistance;
}

vec4 project_common_position_to_clipspace(vec4 position, mat4 viewProjectionMatrix, vec4 center) {
  if (u_CoordinateSystem == COORDINATE_SYSTEM_METER_OFFSET ||
    u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
    // Needs to be divided with project_uCommonUnitsPerMeter
    position.w *= u_PixelsPerMeter.z;
  }

  return viewProjectionMatrix * position + center;
}

// Projects from common space coordinates to clip space
vec4 project_common_position_to_clipspace(vec4 position) {
  return project_common_position_to_clipspace(
    position,
    u_ViewProjectionMatrix,
    u_ViewportCenterProjection
  );
}

vec4 unproject_clipspace_to_position(vec4 clipspacePos, mat4 u_InverseViewProjectionMatrix) {
  vec4 pos = u_InverseViewProjectionMatrix * (clipspacePos - u_ViewportCenterProjection);

  if (u_CoordinateSystem == COORDINATE_SYSTEM_METER_OFFSET ||
    u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
    // Needs to be divided with project_uCommonUnitsPerMeter
     pos.w = pos.w / u_PixelsPerMeter.z;
  }
  return pos;
}


bool isEqual( float a,  float b) {
    return  a< b + 0.001 && a > b - 0.001;
}

// \u652F\u6301 GaodeV2\u3001Mapbox
vec4 project_common_position_to_clipspace_v2(vec4 position) {
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    return u_Mvp * position;
  } else {
    return project_common_position_to_clipspace(position);
  }
}`,Lx=`vec2 rotate_matrix(vec2 v, float a) {
    float b = a / 180.0 * 3.1415926535897932384626433832795;
    float s = sin(b);
    float c = cos(b);
    mat2 m = mat2(c, s, -s, c);
    return m * v;
}`,Px=`/**
 * 2D signed distance field functions
 * @see http://www.iquilezles.org/www/articles/distfunctions2d/distfunctions2d.htm
 */

float ndot(vec2 a, vec2 b ) { return a.x*b.x - a.y*b.y; }

float sdCircle(vec2 p, float r) {
  return length(p) - r;
}

float sdEquilateralTriangle(vec2 p) {
  float k = sqrt(3.0);
  p.x = abs(p.x) - 1.0;
  p.y = p.y + 1.0/k;
  if( p.x + k*p.y > 0.0 ) p = vec2(p.x-k*p.y,-k*p.x-p.y)/2.0;
  p.x -= clamp( p.x, -2.0, 0.0 );
  return -length(p)*sign(p.y);
}

float sdBox(vec2 p, vec2 b) {
  vec2 d = abs(p)-b;
  return length(max(d,vec2(0))) + min(max(d.x,d.y),0.0);
}

float sdPentagon(vec2 p, float r) {
  vec3 k = vec3(0.809016994,0.587785252,0.726542528);
  p.x = abs(p.x);
  p -= 2.0*min(dot(vec2(-k.x,k.y),p),0.0)*vec2(-k.x,k.y);
  p -= 2.0*min(dot(vec2( k.x,k.y),p),0.0)*vec2( k.x,k.y);
  p -= vec2(clamp(p.x,-r*k.z,r*k.z),r);
  return length(p)*sign(p.y);
}

float sdHexagon(vec2 p, float r) {
  vec3 k = vec3(-0.866025404,0.5,0.577350269);
  p = abs(p);
  p -= 2.0*min(dot(k.xy,p),0.0)*k.xy;
  p -= vec2(clamp(p.x, -k.z*r, k.z*r), r);
  return length(p)*sign(p.y);
}

float sdOctogon(vec2 p, float r) {
  vec3 k = vec3(-0.9238795325, 0.3826834323, 0.4142135623 );
  p = abs(p);
  p -= 2.0*min(dot(vec2( k.x,k.y),p),0.0)*vec2( k.x,k.y);
  p -= 2.0*min(dot(vec2(-k.x,k.y),p),0.0)*vec2(-k.x,k.y);
  p -= vec2(clamp(p.x, -k.z*r, k.z*r), r);
  return length(p)*sign(p.y);
}

float sdHexagram(vec2 p, float r) {
  vec4 k=vec4(-0.5,0.8660254038,0.5773502692,1.7320508076);
  p = abs(p);
  p -= 2.0*min(dot(k.xy,p),0.0)*k.xy;
  p -= 2.0*min(dot(k.yx,p),0.0)*k.yx;
  p -= vec2(clamp(p.x,r*k.z,r*k.w),r);
  return length(p)*sign(p.y);
}

float sdRhombus(vec2 p, vec2 b) {
  vec2 q = abs(p);
  float h = clamp((-2.0*ndot(q,b)+ndot(b,b))/dot(b,b),-1.0,1.0);
  float d = length( q - 0.5*b*vec2(1.0-h,1.0+h) );
  return d * sign( q.x*b.y + q.y*b.x - b.x*b.y );
}

float sdVesica(vec2 p, float r, float d) {
  p = abs(p);
  float b = sqrt(r*r-d*d); // can delay this sqrt
  return ((p.y-b)*d>p.x*b)
          ? length(p-vec2(0.0,b))
          : length(p-vec2(-d,0.0))-r;
}
`,Ox=/precision\s+(high|low|medium)p\s+float/,Rx=`#ifdef GL_FRAGMENT_PRECISION_HIGH
 precision highp float;
 #else
 precision mediump float;
#endif
`,kx=/#pragma include (["^+"]?["[a-zA-Z_0-9](.*)"]*?)/g,Dx=/void\s+main\s*\([^)]*\)\s*\{\n?/,W6=/}\n?[^{}]*$/,Nx=(qh=(0,dr.b2)(),qh(O0=function(){function e(){(0,ue.Z)(this,e),(0,Ce.Z)(this,"moduleCache",{}),(0,Ce.Z)(this,"rawContentCache",{})}return(0,me.Z)(e,[{key:"registerBuiltinModules",value:function(){this.destroy(),this.registerModule("common",{vs:fh,fs:fh}),this.registerModule("decode",{vs:Wv,fs:""}),this.registerModule("projection",{vs:Ix,fs:""}),this.registerModule("project",{vs:Mx,fs:""}),this.registerModule("sdf_2d",{vs:"",fs:Px}),this.registerModule("lighting",{vs:Xv,fs:""}),this.registerModule("light",{vs:Yv,fs:""}),this.registerModule("picking",{vs:Tx,fs:Qv}),this.registerModule("rotation_2d",{vs:Lx,fs:""})}},{key:"registerModule",value:function(t,r){var n=r.vs,a=r.fs,u=r.uniforms,f=r.inject,g=Ql(n),x=g.content,I=g.uniforms,O=Ql(a),B=O.content,W=O.uniforms;this.rawContentCache[t]={fs:B,inject:f,uniforms:(0,X.Z)((0,X.Z)((0,X.Z)({},I),W),u),vs:x}}},{key:"destroy",value:function(){this.moduleCache={},this.rawContentCache={}}},{key:"getModule",value:function(t){var r=this,n=this.rawContentCache[t].vs,a=this.rawContentCache[t].fs,u=this.rawContentCache[t].inject,f={};u!=null&&u["vs:#decl"]&&(n=(u==null?void 0:u["vs:#decl"])+n,f=Ql(u==null?void 0:u["vs:#decl"]).uniforms),u!=null&&u["vs:#main-start"]&&(n=n.replace(Dx,function(Se){return Se+(u==null?void 0:u["vs:#main-start"])}));var g=this.processModule(n,[],"vs"),x=g.content,I=g.includeList,O=this.processModule(a,[],"fs"),B=O.content,W=O.includeList,he="",ae=Kh(I.concat(W).concat(t)).reduce(function(Se,Fe){return(0,X.Z)((0,X.Z)({},Se),r.rawContentCache[Fe].uniforms)},(0,X.Z)({},f));return Ox.test(B)||(he=he+Rx),he=he+B,this.moduleCache[t]={fs:he.trim(),uniforms:ae,vs:x.trim()},this.moduleCache[t]}},{key:"processModule",value:function(t,r,n){var a=this,u=t.replace(kx,function(f,g){var x=g.split(" "),I=x[0].replace(/"/g,"");if(r.indexOf(I)>-1)return"";var O=a.rawContentCache[I][n];r.push(I);var B=a.processModule(O,r,n),W=B.content;return W});return{content:u,includeList:r}}},{key:"injectDefines",value:function(t){var r=Object.keys(t).reduce(function(n,a){return n+"#define ".concat(a.toUpperCase()," ").concat(t[a],`;
`)},`
`);return r}}]),e}())||O0);function Fx(e,i){for(;!Object.prototype.hasOwnProperty.call(e,i)&&(e=(0,oe.Z)(e),e!==null););return e}function R0(){return typeof Reflect!="undefined"&&Reflect.get?R0=Reflect.get.bind():R0=function(i,t,r){var n=Fx(i,t);if(n){var a=Object.getOwnPropertyDescriptor(n,t);return a.get?a.get.call(arguments.length<3?i:r):a.value}},R0.apply(this,arguments)}var Jh=function(e){return e.Normal="normal",e.PostProcessing="post-processing",e}({}),xm,Em,Td=(xm=(0,dr.b2)(),xm(Em=function(){function e(){(0,ue.Z)(this,e),(0,Ce.Z)(this,"shaderModuleService",void 0),(0,Ce.Z)(this,"rendererService",void 0),(0,Ce.Z)(this,"cameraService",void 0),(0,Ce.Z)(this,"mapService",void 0),(0,Ce.Z)(this,"interactionService",void 0),(0,Ce.Z)(this,"layerService",void 0),(0,Ce.Z)(this,"config",void 0)}return(0,me.Z)(e,[{key:"getName",value:function(){return""}},{key:"getType",value:function(){return Jh.Normal}},{key:"init",value:function(t,r){this.config=r,this.rendererService=t.getContainer().get(Xt.IRendererService),this.cameraService=t.getContainer().get(Xt.ICameraService),this.mapService=t.getContainer().get(Xt.IMapService),this.interactionService=t.getContainer().get(Xt.IInteractionService),this.layerService=t.getContainer().get(Xt.ILayerService),this.shaderModuleService=t.getContainer().get(Xt.IShaderModuleService)}},{key:"render",value:function(t){}}]),e}())||Em),bm,Sm;function Bx(e){var i=Zx();return function(){var r=(0,oe.Z)(e),n;if(i){var a=(0,oe.Z)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return(0,Ze.Z)(this,n)}}function Zx(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var zx=(bm=(0,dr.b2)(),bm(Sm=function(e){(0,ke.Z)(t,e);var i=Bx(t);function t(){return(0,ue.Z)(this,t),i.apply(this,arguments)}return(0,me.Z)(t,[{key:"getName",value:function(){return"clear"}},{key:"init",value:function(n,a){R0((0,oe.Z)(t.prototype),"init",this).call(this,n,a)}},{key:"render",value:function(){this.rendererService.clear({color:[0,0,0,0],depth:1,framebuffer:null})}}]),t}(Td))||Sm),Cm,wm,Tm,qv,Mm;function Ux(e,i){var t=typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=Gx(e))||i&&e&&typeof e.length=="number"){t&&(e=t);var r=0,n=function(){};return{s:n,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(x){throw x},f:n}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var a=!0,u=!1,f;return{s:function(){t=t.call(e)},n:function(){var x=t.next();return a=x.done,x},e:function(x){u=!0,f=x},f:function(){try{!a&&t.return!=null&&t.return()}finally{if(u)throw f}}}}function Gx(e,i){if(e){if(typeof e=="string")return Im(e,i);var t=Object.prototype.toString.call(e).slice(8,-1);if(t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set")return Array.from(e);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return Im(e,i)}}function Im(e,i){(i==null||i>e.length)&&(i=e.length);for(var t=0,r=new Array(i);t<i;t++)r[t]=e[t];return r}var jx=(Cm=(0,dr.b2)(),wm=(0,dr.f3)(Xt.IPostProcessor),Cm(Tm=(qv=function(){function e(){(0,ue.Z)(this,e),(0,Ce.Z)(this,"passes",[]),Ki(this,"postProcessor",Mm,this),(0,Ce.Z)(this,"layer",void 0),(0,Ce.Z)(this,"renderFlag",void 0),(0,Ce.Z)(this,"width",0),(0,Ce.Z)(this,"height",0)}return(0,me.Z)(e,[{key:"setLayer",value:function(t){this.layer=t}},{key:"setRenderFlag",value:function(t){this.renderFlag=t}},{key:"getRenderFlag",value:function(){return this.renderFlag}},{key:"getPostProcessor",value:function(){return this.postProcessor}},{key:"render",value:function(){var i=(0,ur.Z)(nt().mark(function r(){var n,a,u;return nt().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:n=Ux(this.passes),g.prev=1,n.s();case 3:if((a=n.n()).done){g.next=9;break}return u=a.value,g.next=7,u.render(this.layer);case 7:g.next=3;break;case 9:g.next=14;break;case 11:g.prev=11,g.t0=g.catch(1),n.e(g.t0);case 14:return g.prev=14,n.f(),g.finish(14);case 17:return g.next=19,this.postProcessor.render(this.layer);case 19:case"end":return g.stop()}},r,this,[[1,11,14,17]])}));function t(){return i.apply(this,arguments)}return t}()},{key:"resize",value:function(t,r){(this.width!==t||this.height!==r)&&(this.postProcessor.resize(t,r),this.width=t,this.height=r)}},{key:"add",value:function(t,r){t.getType()===Jh.PostProcessing?this.postProcessor.add(t,this.layer,r):(t.init(this.layer,r),this.passes.push(t))}},{key:"insert",value:function(t,r,n){t.init(this.layer,r),this.passes.splice(n,0,t)}},{key:"destroy",value:function(){this.passes.length=0}}]),e}(),Mm=Hi(qv.prototype,"postProcessor",[wm],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),qv))||Tm),Lm,Pm;function Vx(e){var i=Hx();return function(){var r=(0,oe.Z)(e),n;if(i){var a=(0,oe.Z)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return(0,Ze.Z)(this,n)}}function Hx(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var $x=(Lm=(0,dr.b2)(),Lm(Pm=function(e){(0,ke.Z)(t,e);var i=Vx(t);function t(){var r;(0,ue.Z)(this,t);for(var n=arguments.length,a=new Array(n),u=0;u<n;u++)a[u]=arguments[u];return r=i.call.apply(i,[this].concat(a)),(0,Ce.Z)((0,bt.Z)(r),"pickingFBO",void 0),(0,Ce.Z)((0,bt.Z)(r),"layer",void 0),(0,Ce.Z)((0,bt.Z)(r),"width",0),(0,Ce.Z)((0,bt.Z)(r),"height",0),(0,Ce.Z)((0,bt.Z)(r),"alreadyInRendering",!1),(0,Ce.Z)((0,bt.Z)(r),"pickFromPickingFBO",function(f){var g=f.x,x=f.y,I=f.lngLat,O=f.type;if(!(!r.layer.isVisible()||!r.layer.needPick(O))){var B=r.rendererService,W=B.getViewportSize,he=B.readPixels,ae=B.useFramebuffer,Se=W(),Fe=Se.width,Qe=Se.height,qe=r.layer.getLayerConfig(),yt=qe.enableHighlight,Et=qe.enableSelect,Ot=g*la,jt=x*la;if(!(Ot>Fe||Ot<0||jt>Qe||jt<0)){var or;ae(r.pickingFBO,function(){var ar;if(or=he({x:Math.round(Ot),y:Math.round(Qe-(x+1)*la),width:1,height:1,data:new Uint8Array(1*1*4),framebuffer:r.pickingFBO}),or[0]!==0||or[1]!==0||or[2]!==0){var br=io(or),pr=r.layer.getSource().getFeatureById(br),jr={x:g,y:x,type:O,lngLat:I,featureId:br,feature:pr};pr&&(r.layer.setCurrentPickId(br),r.triggerHoverOnLayer(jr))}else{var nn={x:g,y:x,lngLat:I,type:r.layer.getCurrentPickId()===null?"un"+O:"mouseout",featureId:null,feature:null};r.triggerHoverOnLayer((0,X.Z)((0,X.Z)({},nn),{},{type:"unpick"})),r.triggerHoverOnLayer(nn),r.layer.setCurrentPickId(null)}yt&&r.highlightPickedFeature(or),Et&&O==="click"&&((ar=or)===null||ar===void 0?void 0:ar.toString())!==[0,0,0,0].toString()&&r.selectFeature(or)})}}}),r}return(0,me.Z)(t,[{key:"getType",value:function(){return Jh.Normal}},{key:"getName",value:function(){return"pixelPicking"}},{key:"init",value:function(n,a){R0((0,oe.Z)(t.prototype),"init",this).call(this,n,a),this.layer=n;var u=this.rendererService,f=u.createTexture2D,g=u.createFramebuffer,x=u.getViewportSize,I=x(),O=I.width,B=I.height;this.pickingFBO=g({color:f({width:O,height:B,wrapS:Ge.CLAMP_TO_EDGE,wrapT:Ge.CLAMP_TO_EDGE})}),this.interactionService.on($u.Hover,this.pickFromPickingFBO),this.interactionService.on($u.Select,this.selectFeatureHandle.bind(this)),this.interactionService.on($u.Active,this.highlightFeatureHandle.bind(this))}},{key:"render",value:function(n){var a=this;if(!this.alreadyInRendering){var u=this.rendererService,f=u.getViewportSize,g=u.useFramebuffer,x=u.clear,I=f(),O=I.width,B=I.height;this.alreadyInRendering=!0,(this.width!==O||this.height!==B)&&(this.pickingFBO.resize({width:O,height:B}),this.width=O,this.height=B),g(this.pickingFBO,function(){x({framebuffer:a.pickingFBO,color:[0,0,0,0],stencil:0,depth:1});var W=a.layer.multiPassRenderer.getRenderFlag();a.layer.multiPassRenderer.setRenderFlag(!1),n.hooks.beforePickingEncode.call(),n.render(),n.hooks.afterPickingEncode.call(),a.layer.multiPassRenderer.setRenderFlag(W),a.alreadyInRendering=!1})}}},{key:"triggerHoverOnLayer",value:function(n){this.layer.emit(n.type,n)}},{key:"highlightPickedFeature",value:function(n){var a=(0,vn.Z)(n,3),u=a[0],f=a[1],g=a[2];this.layer.hooks.beforeHighlight.call([u,f,g]),this.layerService.renderLayers()}},{key:"selectFeature",value:function(n){var a=(0,vn.Z)(n,3),u=a[0],f=a[1],g=a[2];this.layer.hooks.beforeSelect.call([u,f,g]),this.layerService.renderLayers()}},{key:"selectFeatureHandle",value:function(n){var a=n.featureId,u=bs(a);this.selectFeature(new Uint8Array(u))}},{key:"highlightFeatureHandle",value:function(n){var a=n.featureId,u=bs(a);this.highlightPickedFeature(new Uint8Array(u))}}]),t}(Td))||Pm),Om,Rm,km,Kv,Dm,Wx=In.camelCase,Yx=In.isNil,Xx=In.upperFirst,Qx=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,Jf=(Om=(0,dr.b2)(),Rm=(0,dr.f3)(Xt.IShaderModuleService),Om(km=(Kv=function(){function e(){(0,ue.Z)(this,e),Ki(this,"shaderModuleService",Dm,this),(0,Ce.Z)(this,"rendererService",void 0),(0,Ce.Z)(this,"config",void 0),(0,Ce.Z)(this,"quad",Qx),(0,Ce.Z)(this,"enabled",!0),(0,Ce.Z)(this,"renderToScreen",!1),(0,Ce.Z)(this,"model",void 0),(0,Ce.Z)(this,"name",void 0),(0,Ce.Z)(this,"optionsToUpdate",{})}return(0,me.Z)(e,[{key:"getName",value:function(){return this.name}},{key:"setName",value:function(t){this.name=t}},{key:"getType",value:function(){return Jh.PostProcessing}},{key:"init",value:function(t,r){this.config=r,this.rendererService=t.getContainer().get(Xt.IRendererService),this.shaderModuleService=t.getContainer().get(Xt.IShaderModuleService);var n=this.rendererService,a=n.createAttribute,u=n.createBuffer,f=n.createModel,g=this.setupShaders(),x=g.vs,I=g.fs,O=g.uniforms;this.model=f({vs:x,fs:I,attributes:{a_Position:a({buffer:u({data:[-4,-4,4,-4,0,4],type:Ge.FLOAT}),size:2})},uniforms:(0,X.Z)((0,X.Z)({u_Texture:null},O),this.config&&this.convertOptionsToUniforms(this.config)),depth:{enable:!1},count:3,blend:{enable:this.getName()==="copy"}})}},{key:"render",value:function(t,r){var n=this,a=t.multiPassRenderer.getPostProcessor(),u=this.rendererService,f=u.useFramebuffer,g=u.getViewportSize,x=u.clear,I=g(),O=I.width,B=I.height;f(this.renderToScreen?null:a.getWriteFBO(),function(){x({framebuffer:a.getWriteFBO(),color:[0,0,0,0],depth:1,stencil:0});var W=(0,X.Z)({u_BloomFinal:0,u_Texture:a.getReadFBO(),u_ViewportSize:[O,B]},n.convertOptionsToUniforms(n.optionsToUpdate));r&&(W.u_BloomFinal=1,W.u_Texture2=r),n.model.draw({uniforms:W})})}},{key:"isEnabled",value:function(){return this.enabled}},{key:"setEnabled",value:function(t){this.enabled=t}},{key:"setRenderToScreen",value:function(t){this.renderToScreen=t}},{key:"updateOptions",value:function(t){this.optionsToUpdate=(0,X.Z)((0,X.Z)({},this.optionsToUpdate),t)}},{key:"setupShaders",value:function(){throw new Error("Method not implemented.")}},{key:"convertOptionsToUniforms",value:function(t){var r={};return Object.keys(t).forEach(function(n){Yx(t[n])||(r["u_".concat(Xx(Wx(n)))]=t[n])}),r}}]),e}(),Dm=Hi(Kv.prototype,"shaderModuleService",[Rm],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Kv))||km),Nm,Fm;function qx(e){var i=Kx();return function(){var r=(0,oe.Z)(e),n;if(i){var a=(0,oe.Z)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return(0,Ze.Z)(this,n)}}function Kx(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var Jx=`varying vec2 v_UV;

uniform float u_BloomFinal: 0.0;
uniform sampler2D u_Texture;
uniform sampler2D u_Texture2;

uniform vec2 u_ViewportSize: [1.0, 1.0];
uniform float u_radius: 5.0;
uniform float u_intensity: 0.3;
uniform float u_baseRadio: 0.5;

// https://github.com/Jam3/glsl-fast-gaussian-blur/blob/master/9.glsl
vec4 blur9(sampler2D image, vec2 uv, vec2 resolution, vec2 direction) {
  vec4 color = vec4(0.0);
  vec2 off1 = vec2(1.3846153846) * direction;
  vec2 off2 = vec2(3.2307692308) * direction;
  color += texture2D(image, uv) * 0.2270270270;
  color += texture2D(image, uv + (off1 / resolution)) * 0.3162162162;
  color += texture2D(image, uv - (off1 / resolution)) * 0.3162162162;
  color += texture2D(image, uv + (off2 / resolution)) * 0.0702702703;
  color += texture2D(image, uv - (off2 / resolution)) * 0.0702702703;
  return color;
}

float luminance(vec4 color) {
  return  0.2125 * color.r + 0.7154 * color.g + 0.0721 * color.b;
}

void main() {
  // vec4 baseColor = texture2D(u_Texture, v_UV);

  float r = sqrt(u_radius);

  vec4 c1 = blur9(u_Texture, v_UV, u_ViewportSize, vec2(u_radius, 0.0));
  // c1 *= luminance(c1);
  vec4 c2 = blur9(u_Texture, v_UV, u_ViewportSize, vec2(0.0, u_radius));
  // c2 *= luminance(c2);
  vec4 c3 = blur9(u_Texture, v_UV, u_ViewportSize, vec2(r, r));
  // c3 *= luminance(c3);
  vec4 c4 = blur9(u_Texture, v_UV, u_ViewportSize, vec2(r, -r));
  // c4 *= luminance(c4);
  vec4 inbloomColor = (c1 + c2 + c3 + c4) * 0.25;

  // float lum = luminance(inbloomColor);
  // inbloomColor.rgb *= lum;

  if(u_BloomFinal > 0.0) {
    vec4 baseColor = texture2D(u_Texture2, v_UV);
    float baselum = luminance(baseColor);
    gl_FragColor = mix(inbloomColor, baseColor, u_baseRadio);
    if(baselum <= 0.2) {
      gl_FragColor = inbloomColor * u_intensity;
    }
  } else {
    gl_FragColor = inbloomColor;
  }
}`,eE=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,Jv=In.isNil,tE=(Nm=(0,dr.b2)(),Nm(Fm=function(e){(0,ke.Z)(t,e);var i=qx(t);function t(){return(0,ue.Z)(this,t),i.apply(this,arguments)}return(0,me.Z)(t,[{key:"setupShaders",value:function(){this.shaderModuleService.registerModule("blur-pass",{vs:eE,fs:Jx});var n=this.shaderModuleService.getModule("blur-pass"),a=n.vs,u=n.fs,f=n.uniforms,g=this.rendererService.getViewportSize(),x=g.width,I=g.height;return{vs:a,fs:u,uniforms:(0,X.Z)((0,X.Z)({},f),{},{u_ViewportSize:[x,I]})}}},{key:"convertOptionsToUniforms",value:function(n){var a={};return Jv(n.bloomRadius)||(a.u_radius=n.bloomRadius),Jv(n.bloomIntensity)||(a.u_intensity=n.bloomIntensity),Jv(n.bloomBaseRadio)||(a.u_baseRadio=n.bloomBaseRadio),a}}]),t}(Jf))||Fm),Bm,Zm;function rE(e){var i=nE();return function(){var r=(0,oe.Z)(e),n;if(i){var a=(0,oe.Z)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return(0,Ze.Z)(this,n)}}function nE(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var iE=`varying vec2 v_UV;

uniform sampler2D u_Texture;

uniform vec2 u_ViewportSize: [1.0, 1.0];
uniform vec2 u_BlurDir: [1.0, 0.0];

// https://github.com/Jam3/glsl-fast-gaussian-blur/blob/master/9.glsl
vec4 blur9(sampler2D image, vec2 uv, vec2 resolution, vec2 direction) {
  vec4 color = vec4(0.0);
  vec2 off1 = vec2(1.3846153846) * direction;
  vec2 off2 = vec2(3.2307692308) * direction;
  color += texture2D(image, uv) * 0.2270270270;
  color += texture2D(image, uv + (off1 / resolution)) * 0.3162162162;
  color += texture2D(image, uv - (off1 / resolution)) * 0.3162162162;
  color += texture2D(image, uv + (off2 / resolution)) * 0.0702702703;
  color += texture2D(image, uv - (off2 / resolution)) * 0.0702702703;
  return color;
}

void main() {
  gl_FragColor = blur9(u_Texture, v_UV, u_ViewportSize, u_BlurDir);
}`,aE=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,oE=In.isNil,sE=(Bm=(0,dr.b2)(),Bm(Zm=function(e){(0,ke.Z)(t,e);var i=rE(t);function t(){return(0,ue.Z)(this,t),i.apply(this,arguments)}return(0,me.Z)(t,[{key:"setupShaders",value:function(){this.shaderModuleService.registerModule("blur-pass",{vs:aE,fs:iE});var n=this.shaderModuleService.getModule("blur-pass"),a=n.vs,u=n.fs,f=n.uniforms,g=this.rendererService.getViewportSize(),x=g.width,I=g.height;return{vs:a,fs:u,uniforms:(0,X.Z)((0,X.Z)({},f),{},{u_ViewportSize:[x,I]})}}},{key:"convertOptionsToUniforms",value:function(n){var a={};return oE(n.blurRadius)||(a.u_BlurDir=[n.blurRadius,0]),a}}]),t}(Jf))||Zm),zm,Um;function uE(e){var i=lE();return function(){var r=(0,oe.Z)(e),n;if(i){var a=(0,oe.Z)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return(0,Ze.Z)(this,n)}}function lE(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var cE=`varying vec2 v_UV;

uniform sampler2D u_Texture;

uniform vec2 u_ViewportSize: [1.0, 1.0];
uniform vec2 u_BlurDir: [1.0, 0.0];

// https://github.com/Jam3/glsl-fast-gaussian-blur/blob/master/9.glsl
vec4 blur9(sampler2D image, vec2 uv, vec2 resolution, vec2 direction) {
  vec4 color = vec4(0.0);
  vec2 off1 = vec2(1.3846153846) * direction;
  vec2 off2 = vec2(3.2307692308) * direction;
  color += texture2D(image, uv) * 0.2270270270;
  color += texture2D(image, uv + (off1 / resolution)) * 0.3162162162;
  color += texture2D(image, uv - (off1 / resolution)) * 0.3162162162;
  color += texture2D(image, uv + (off2 / resolution)) * 0.0702702703;
  color += texture2D(image, uv - (off2 / resolution)) * 0.0702702703;
  return color;
}

void main() {
  gl_FragColor = blur9(u_Texture, v_UV, u_ViewportSize, u_BlurDir);
}`,fE=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,hE=In.isNil,AE=(zm=(0,dr.b2)(),zm(Um=function(e){(0,ke.Z)(t,e);var i=uE(t);function t(){return(0,ue.Z)(this,t),i.apply(this,arguments)}return(0,me.Z)(t,[{key:"setupShaders",value:function(){this.shaderModuleService.registerModule("blur-pass",{vs:fE,fs:cE});var n=this.shaderModuleService.getModule("blur-pass"),a=n.vs,u=n.fs,f=n.uniforms,g=this.rendererService.getViewportSize(),x=g.width,I=g.height;return{vs:a,fs:u,uniforms:(0,X.Z)((0,X.Z)({},f),{},{u_ViewportSize:[x,I]})}}},{key:"convertOptionsToUniforms",value:function(n){var a={};return hE(n.blurRadius)||(a.u_BlurDir=[0,n.blurRadius]),a}}]),t}(Jf))||Um),Gm,jm;function pE(e){var i=dE();return function(){var r=(0,oe.Z)(e),n;if(i){var a=(0,oe.Z)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return(0,Ze.Z)(this,n)}}function dE(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var vE=`varying vec2 v_UV;

uniform sampler2D u_Texture;
uniform vec2 u_ViewportSize: [1.0, 1.0];
uniform vec2 u_Center : [0.5, 0.5];
uniform float u_Angle : 0;
uniform float u_Size : 8;

#pragma include "common"

float scale = PI / u_Size;

float pattern(float u_Angle, vec2 texSize, vec2 texCoord) {
  float s = sin(u_Angle), c = cos(u_Angle);
  vec2 tex = texCoord * texSize - u_Center * texSize;
  vec2 point = vec2(
    c * tex.x - s * tex.y,
    s * tex.x + c * tex.y
  ) * scale;
  return (sin(point.x) * sin(point.y)) * 4.0;
}

// https://github.com/evanw/glfx.js/blob/master/src/filters/fun/colorhalftone.js
vec4 colorHalftone_filterColor(vec4 color, vec2 texSize, vec2 texCoord) {
  vec3 cmy = 1.0 - color.rgb;
  float k = min(cmy.x, min(cmy.y, cmy.z));
  cmy = (cmy - k) / (1.0 - k);
  cmy = clamp(
    cmy * 10.0 - 3.0 + vec3(
      pattern(u_Angle + 0.26179, texSize, texCoord),
      pattern(u_Angle + 1.30899, texSize, texCoord),
      pattern(u_Angle, texSize, texCoord)
    ),
    0.0,
    1.0
  );
  k = clamp(k * 10.0 - 5.0 + pattern(u_Angle + 0.78539, texSize, texCoord), 0.0, 1.0);
  return vec4(1.0 - cmy - k, color.a);
}

void main() {
  gl_FragColor = vec4(texture2D(u_Texture, v_UV));
  gl_FragColor = colorHalftone_filterColor(gl_FragColor, u_ViewportSize, v_UV);
}`,gE=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,mE=(Gm=(0,dr.b2)(),Gm(jm=function(e){(0,ke.Z)(t,e);var i=pE(t);function t(){return(0,ue.Z)(this,t),i.apply(this,arguments)}return(0,me.Z)(t,[{key:"setupShaders",value:function(){this.shaderModuleService.registerModule("colorhalftone-pass",{vs:gE,fs:vE});var n=this.shaderModuleService.getModule("colorhalftone-pass"),a=n.vs,u=n.fs,f=n.uniforms,g=this.rendererService.getViewportSize(),x=g.width,I=g.height;return{vs:a,fs:u,uniforms:(0,X.Z)((0,X.Z)({},f),{},{u_ViewportSize:[x,I]})}}}]),t}(Jf))||jm),Vm,Hm;function yE(e){var i=_E();return function(){var r=(0,oe.Z)(e),n;if(i){var a=(0,oe.Z)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return(0,Ze.Z)(this,n)}}function _E(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var xE=`varying vec2 v_UV;

uniform sampler2D u_Texture;

void main() {
  gl_FragColor = vec4(texture2D(u_Texture, v_UV));
}`,EE=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,bE=(Vm=(0,dr.b2)(),Vm(Hm=function(e){(0,ke.Z)(t,e);var i=yE(t);function t(){return(0,ue.Z)(this,t),i.apply(this,arguments)}return(0,me.Z)(t,[{key:"setupShaders",value:function(){return this.shaderModuleService.registerModule("copy-pass",{vs:EE,fs:xE}),this.shaderModuleService.getModule("copy-pass")}}]),t}(Jf))||Hm),$m,Wm;function SE(e){var i=CE();return function(){var r=(0,oe.Z)(e),n;if(i){var a=(0,oe.Z)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return(0,Ze.Z)(this,n)}}function CE(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var wE=`varying vec2 v_UV;

uniform sampler2D u_Texture;
uniform vec2 u_ViewportSize: [1.0, 1.0];
uniform vec2 u_Center : [0.5, 0.5];
uniform float u_Scale : 10;

// https://github.com/evanw/glfx.js/blob/master/src/filters/fun/hexagonalpixelate.js
vec4 hexagonalPixelate_sampleColor(sampler2D texture, vec2 texSize, vec2 texCoord) {
  vec2 tex = (texCoord * texSize - u_Center * texSize) / u_Scale;
  tex.y /= 0.866025404;
  tex.x -= tex.y * 0.5;
  vec2 a;
  if (tex.x + tex.y - floor(tex.x) - floor(tex.y) < 1.0) {
    a = vec2(floor(tex.x), floor(tex.y));
  }
  else a = vec2(ceil(tex.x), ceil(tex.y));
  vec2 b = vec2(ceil(tex.x), floor(tex.y));
  vec2 c = vec2(floor(tex.x), ceil(tex.y));
  vec3 TEX = vec3(tex.x, tex.y, 1.0 - tex.x - tex.y);
  vec3 A = vec3(a.x, a.y, 1.0 - a.x - a.y);
  vec3 B = vec3(b.x, b.y, 1.0 - b.x - b.y);
  vec3 C = vec3(c.x, c.y, 1.0 - c.x - c.y);
  float alen = length(TEX - A);
  float blen = length(TEX - B);
  float clen = length(TEX - C);
  vec2 choice;
  if (alen < blen) {
    if (alen < clen) choice = a;
    else choice = c;
  } else {
    if (blen < clen) choice = b;
    else choice = c;
  }
  choice.x += choice.y * 0.5;
  choice.y *= 0.866025404;
  choice *= u_Scale / texSize;
  return texture2D(texture, choice + u_Center);
}

void main() {
  gl_FragColor = vec4(texture2D(u_Texture, v_UV));
  gl_FragColor = hexagonalPixelate_sampleColor(u_Texture, u_ViewportSize, v_UV);
}`,TE=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,ME=($m=(0,dr.b2)(),$m(Wm=function(e){(0,ke.Z)(t,e);var i=SE(t);function t(){return(0,ue.Z)(this,t),i.apply(this,arguments)}return(0,me.Z)(t,[{key:"setupShaders",value:function(){this.shaderModuleService.registerModule("hexagonalpixelate-pass",{vs:TE,fs:wE});var n=this.shaderModuleService.getModule("hexagonalpixelate-pass"),a=n.vs,u=n.fs,f=n.uniforms,g=this.rendererService.getViewportSize(),x=g.width,I=g.height;return{vs:a,fs:u,uniforms:(0,X.Z)((0,X.Z)({},f),{},{u_ViewportSize:[x,I]})}}}]),t}(Jf))||Wm),Ym,Xm;function IE(e){var i=LE();return function(){var r=(0,oe.Z)(e),n;if(i){var a=(0,oe.Z)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return(0,Ze.Z)(this,n)}}function LE(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var PE=`varying vec2 v_UV;

uniform sampler2D u_Texture;
uniform vec2 u_ViewportSize: [1.0, 1.0];
uniform float u_Strength : 0.6;

vec4 ink_sampleColor(sampler2D texture, vec2 texSize, vec2 texCoord) {
  vec2 dx = vec2(1.0 / texSize.x, 0.0);
  vec2 dy = vec2(0.0, 1.0 / texSize.y);
  vec4 color = texture2D(texture, texCoord);
  float bigTotal = 0.0;
  float smallTotal = 0.0;
  vec3 bigAverage = vec3(0.0);
  vec3 smallAverage = vec3(0.0);
  for (float x = -2.0; x <= 2.0; x += 1.0) {
    for (float y = -2.0; y <= 2.0; y += 1.0) {
      vec3 sample = texture2D(texture, texCoord + dx * x + dy * y).rgb;
      bigAverage += sample;
      bigTotal += 1.0;
      if (abs(x) + abs(y) < 2.0) {
        smallAverage += sample;
        smallTotal += 1.0;
      }
    }
  }
  vec3 edge = max(vec3(0.0), bigAverage / bigTotal - smallAverage / smallTotal);
  float power = u_Strength * u_Strength * u_Strength * u_Strength * u_Strength;
  return vec4(color.rgb - dot(edge, edge) * power * 100000.0, color.a);
}

void main() {
  gl_FragColor = vec4(texture2D(u_Texture, v_UV));
  gl_FragColor = ink_sampleColor(u_Texture, u_ViewportSize, v_UV);
}`,OE=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,RE=(Ym=(0,dr.b2)(),Ym(Xm=function(e){(0,ke.Z)(t,e);var i=IE(t);function t(){return(0,ue.Z)(this,t),i.apply(this,arguments)}return(0,me.Z)(t,[{key:"setupShaders",value:function(){this.shaderModuleService.registerModule("ink-pass",{vs:OE,fs:PE});var n=this.shaderModuleService.getModule("ink-pass"),a=n.vs,u=n.fs,f=n.uniforms,g=this.rendererService.getViewportSize(),x=g.width,I=g.height;return{vs:a,fs:u,uniforms:(0,X.Z)((0,X.Z)({},f),{},{u_ViewportSize:[x,I]})}}}]),t}(Jf))||Xm),Qm,qm;function kE(e){var i=DE();return function(){var r=(0,oe.Z)(e),n;if(i){var a=(0,oe.Z)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return(0,Ze.Z)(this,n)}}function DE(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var NE=`varying vec2 v_UV;

uniform sampler2D u_Texture;
uniform float u_Amount : 0.5;

float rand(vec2 co) {
  return fract(sin(dot(co.xy ,vec2(12.9898,78.233))) * 43758.5453);
}

// https://github.com/evanw/glfx.js/blob/master/src/filters/adjust/noise.js
vec4 noise_filterColor(vec4 color, vec2 texCoord) {
  float diff = (rand(texCoord) - 0.5) * u_Amount;
  color.r += diff;
  color.g += diff;
  color.b += diff;
  return color;
}

void main() {
  gl_FragColor = vec4(texture2D(u_Texture, v_UV));
  gl_FragColor = noise_filterColor(gl_FragColor, v_UV);
}`,FE=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,BE=(Qm=(0,dr.b2)(),Qm(qm=function(e){(0,ke.Z)(t,e);var i=kE(t);function t(){return(0,ue.Z)(this,t),i.apply(this,arguments)}return(0,me.Z)(t,[{key:"setupShaders",value:function(){return this.shaderModuleService.registerModule("noise-pass",{vs:FE,fs:NE}),this.shaderModuleService.getModule("noise-pass")}}]),t}(Jf))||qm),Km,Jm;function ZE(e){var i=zE();return function(){var r=(0,oe.Z)(e),n;if(i){var a=(0,oe.Z)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return(0,Ze.Z)(this,n)}}function zE(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var UE=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,GE=`varying vec2 v_UV;

uniform sampler2D u_Texture;

uniform float u_Amount : 0.5;

// https://github.com/evanw/glfx.js/blob/master/src/filters/adjust/sepia.js
vec4 sepia_filterColor(vec4 color) {
  float r = color.r;
  float g = color.g;
  float b = color.b;
  color.r =
    min(1.0, (r * (1.0 - (0.607 * u_Amount))) + (g * (0.769 * u_Amount)) + (b * (0.189 * u_Amount)));
  color.g = min(1.0, (r * 0.349 * u_Amount) + (g * (1.0 - (0.314 * u_Amount))) + (b * 0.168 * u_Amount));
  color.b = min(1.0, (r * 0.272 * u_Amount) + (g * 0.534 * u_Amount) + (b * (1.0 - (0.869 * u_Amount))));
  return color;
}

void main() {
  gl_FragColor = vec4(texture2D(u_Texture, v_UV));
  gl_FragColor = sepia_filterColor(gl_FragColor);
}`,jE=(Km=(0,dr.b2)(),Km(Jm=function(e){(0,ke.Z)(t,e);var i=ZE(t);function t(){return(0,ue.Z)(this,t),i.apply(this,arguments)}return(0,me.Z)(t,[{key:"setupShaders",value:function(){return this.shaderModuleService.registerModule("sepia-pass",{vs:UE,fs:GE}),this.shaderModuleService.getModule("sepia-pass")}}]),t}(Jf))||Jm),ey,ty,ry,ny,eA,iy,VE=(ey=(0,dr.b2)(),ty=(0,dr.f3)(Xt.IRendererService),ry=(0,dr.zY)(),ey(ny=(eA=function(){function e(){(0,ue.Z)(this,e),Ki(this,"rendererService",iy,this),(0,Ce.Z)(this,"passes",[]),(0,Ce.Z)(this,"readFBO",void 0),(0,Ce.Z)(this,"writeFBO",void 0)}return(0,me.Z)(e,[{key:"getReadFBO",value:function(){return this.readFBO}},{key:"getWriteFBO",value:function(){return this.writeFBO}},{key:"getCurrentFBOTex",value:function(){var t=this.rendererService,r=t.getViewportSize,n=t.createTexture2D,a=r(),u=a.width,f=a.height;return n({x:0,y:0,width:u,height:f,copy:!0})}},{key:"getReadFBOTex",value:function(){var t=this,r=this.rendererService.useFramebuffer;return new Promise(function(n){r(t.readFBO,(0,ur.Z)(nt().mark(function a(){return nt().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:n(t.getCurrentFBOTex());case 1:case"end":return f.stop()}},a)})))})}},{key:"renderBloomPass",value:function(){var i=(0,ur.Z)(nt().mark(function r(n,a){var u,f;return nt().wrap(function(x){for(;;)switch(x.prev=x.next){case 0:return x.next=2,this.getReadFBOTex();case 2:u=x.sent,f=0;case 4:if(!(f<4)){x.next=11;break}return x.next=7,a.render(n,u);case 7:this.swap(),f++,x.next=4;break;case 11:case"end":return x.stop()}},r,this)}));function t(r,n){return i.apply(this,arguments)}return t}()},{key:"render",value:function(){var i=(0,ur.Z)(nt().mark(function r(n){var a,u;return nt().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:a=0;case 1:if(!(a<this.passes.length)){g.next=15;break}if(u=this.passes[a],u.setRenderToScreen(this.isLastEnabledPass(a)),u.getName()!=="bloom"){g.next=9;break}return g.next=7,this.renderBloomPass(n,u);case 7:g.next=12;break;case 9:return g.next=11,u.render(n);case 11:a!==this.passes.length-1&&this.swap();case 12:a++,g.next=1;break;case 15:case"end":return g.stop()}},r,this)}));function t(r){return i.apply(this,arguments)}return t}()},{key:"resize",value:function(t,r){this.readFBO.resize({width:t,height:r}),this.writeFBO.resize({width:t,height:r})}},{key:"add",value:function(t,r,n){t.init(r,n),this.passes.push(t)}},{key:"insert",value:function(t,r,n,a){t.init(n,a),this.passes.splice(r,0,t)}},{key:"getPostProcessingPassByName",value:function(t){return this.passes.find(function(r){return r.getName()===t})}},{key:"init",value:function(){var t=this.rendererService,r=t.createFramebuffer,n=t.createTexture2D;this.readFBO=r({color:n({width:1,height:1,wrapS:Ge.CLAMP_TO_EDGE,wrapT:Ge.CLAMP_TO_EDGE})}),this.writeFBO=r({color:n({width:1,height:1,wrapS:Ge.CLAMP_TO_EDGE,wrapT:Ge.CLAMP_TO_EDGE})})}},{key:"isLastEnabledPass",value:function(t){for(var r=t+1;r<this.passes.length;r++)if(this.passes[r].isEnabled())return!1;return!0}},{key:"swap",value:function(){var t=this.readFBO;this.readFBO=this.writeFBO,this.writeFBO=t}}]),e}(),iy=Hi(eA.prototype,"rendererService",[ty],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Hi(eA.prototype,"init",[ry],Object.getOwnPropertyDescriptor(eA.prototype,"init"),eA.prototype),eA))||ny),ay,oy;function HE(e){var i=$E();return function(){var r=(0,oe.Z)(e),n;if(i){var a=(0,oe.Z)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return(0,Ze.Z)(this,n)}}function $E(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var WE=(ay=(0,dr.b2)(),ay(oy=function(e){(0,ke.Z)(t,e);var i=HE(t);function t(){return(0,ue.Z)(this,t),i.apply(this,arguments)}return(0,me.Z)(t,[{key:"getType",value:function(){return Jh.Normal}},{key:"getName",value:function(){return"render"}},{key:"init",value:function(n,a){R0((0,oe.Z)(t.prototype),"init",this).call(this,n,a)}},{key:"render",value:function(n){var a=this.rendererService,u=a.useFramebuffer,f=a.clear,g=n.multiPassRenderer.getPostProcessor().getReadFBO();u(g,function(){f({color:[0,0,0,0],depth:1,stencil:0,framebuffer:g}),n.multiPassRenderer.setRenderFlag(!1),n.models.forEach(function(x){x.draw({uniforms:n.layerModel.getUninforms()})}),n.multiPassRenderer.setRenderFlag(!0)})}}]),t}(Td))||oy),sy,uy,ly,eg,cy;function YE(e){var i=XE();return function(){var r=(0,oe.Z)(e),n;if(i){var a=(0,oe.Z)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return(0,Ze.Z)(this,n)}}function XE(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var QE=`uniform float u_opacity : 1.0;
uniform float u_MixRatio : 0.5;

uniform sampler2D u_Diffuse1;
uniform sampler2D u_Diffuse2;

varying vec2 v_UV;

void main() {
  vec4 texel1 = texture2D(u_Diffuse1, v_UV);
  vec4 texel2 = texture2D(u_Diffuse2, v_UV);
  gl_FragColor = u_opacity * mix(texel1, texel2, u_MixRatio);
}
`,fy=`varying vec2 v_UV;

uniform sampler2D u_Texture;

void main() {
  gl_FragColor = vec4(texture2D(u_Texture, v_UV));
}`,qE=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`;function hy(e,i){for(var t=0,r=1/i,n=e;n>0;)t=t+r*(n%i),n=Math.floor(n/i),r=r/i;return t}var KE=1,JE=(sy=(0,dr.b2)(),uy=(0,dr.f3)(Xt.IShaderModuleService),sy(ly=(eg=function(e){(0,ke.Z)(t,e);var i=YE(t);function t(){var r;(0,ue.Z)(this,t);for(var n=arguments.length,a=new Array(n),u=0;u<n;u++)a[u]=arguments[u];return r=i.call.apply(i,[this].concat(a)),Ki((0,bt.Z)(r),"shaderModuleService",cy,(0,bt.Z)(r)),(0,Ce.Z)((0,bt.Z)(r),"haltonSequence",[]),(0,Ce.Z)((0,bt.Z)(r),"accumulatingId",0),(0,Ce.Z)((0,bt.Z)(r),"frame",0),(0,Ce.Z)((0,bt.Z)(r),"timer",void 0),(0,Ce.Z)((0,bt.Z)(r),"sampleRenderTarget",void 0),(0,Ce.Z)((0,bt.Z)(r),"prevRenderTarget",void 0),(0,Ce.Z)((0,bt.Z)(r),"outputRenderTarget",void 0),(0,Ce.Z)((0,bt.Z)(r),"copyRenderTarget",void 0),(0,Ce.Z)((0,bt.Z)(r),"blendModel",void 0),(0,Ce.Z)((0,bt.Z)(r),"outputModel",void 0),(0,Ce.Z)((0,bt.Z)(r),"copyModel",void 0),r}return(0,me.Z)(t,[{key:"getType",value:function(){return Jh.Normal}},{key:"getName",value:function(){return"taa"}},{key:"init",value:function(n,a){R0((0,oe.Z)(t.prototype),"init",this).call(this,n,a);var u=this.rendererService,f=u.createFramebuffer,g=u.createTexture2D;this.sampleRenderTarget=f({color:g({width:1,height:1,wrapS:Ge.CLAMP_TO_EDGE,wrapT:Ge.CLAMP_TO_EDGE})}),this.prevRenderTarget=f({color:g({width:1,height:1,wrapS:Ge.CLAMP_TO_EDGE,wrapT:Ge.CLAMP_TO_EDGE})}),this.outputRenderTarget=f({color:g({width:1,height:1,wrapS:Ge.CLAMP_TO_EDGE,wrapT:Ge.CLAMP_TO_EDGE})}),this.copyRenderTarget=f({color:g({width:1,height:1,wrapS:Ge.CLAMP_TO_EDGE,wrapT:Ge.CLAMP_TO_EDGE})});for(var x=0;x<30;x++)this.haltonSequence.push([hy(x,2),hy(x,3)]);this.blendModel=this.createTriangleModel("blend-pass",QE),this.outputModel=this.createTriangleModel("copy-pass",fy,{blend:{enable:!0,func:{srcRGB:Ge.ONE,dstRGB:Ge.ONE_MINUS_SRC_ALPHA,srcAlpha:Ge.ONE,dstAlpha:Ge.ONE_MINUS_SRC_ALPHA},equation:{rgb:Ge.FUNC_ADD,alpha:Ge.FUNC_ADD}}}),this.copyModel=this.createTriangleModel("copy-pass",fy)}},{key:"render",value:function(n){var a=this,u=this.rendererService,f=u.clear,g=u.getViewportSize,x=u.useFramebuffer,I=g(),O=I.width,B=I.height;this.sampleRenderTarget.resize({width:O,height:B}),this.prevRenderTarget.resize({width:O,height:B}),this.outputRenderTarget.resize({width:O,height:B}),this.copyRenderTarget.resize({width:O,height:B}),this.resetFrame(),this.stopAccumulating();var W=n.multiPassRenderer.getPostProcessor().getReadFBO();x(W,function(){f({color:[0,0,0,0],depth:1,stencil:0,framebuffer:W}),n.multiPassRenderer.setRenderFlag(!1),n.render(),n.multiPassRenderer.setRenderFlag(!0)});var he=function ae(Se){!a.accumulatingId||Se!==a.accumulatingId||a.isFinished()||(a.doRender(n),window.requestAnimationFrame(function(){ae(Se)}))};this.accumulatingId=KE++,this.timer=window.setTimeout(function(){he(a.accumulatingId)},50)}},{key:"doRender",value:function(n){var a=this,u=this.rendererService,f=u.clear,g=u.getViewportSize,x=u.useFramebuffer,I=g(),O=I.width,B=I.height,W=n.getLayerConfig(),he=W.jitterScale,ae=he===void 0?1:he,Se=this.haltonSequence[this.frame%this.haltonSequence.length];this.cameraService.jitterProjectionMatrix((Se[0]*2-1)/O*ae,(Se[1]*2-1)/B*ae),n.multiPassRenderer.setRenderFlag(!1),n.hooks.beforeRender.call(),x(this.sampleRenderTarget,function(){f({color:[0,0,0,0],depth:1,stencil:0,framebuffer:a.sampleRenderTarget}),n.render()}),n.hooks.afterRender.call(),n.multiPassRenderer.setRenderFlag(!0);var Fe=n.getLayerConfig();x(this.outputRenderTarget,function(){a.blendModel.draw({uniforms:{u_opacity:Fe.opacity||1,u_MixRatio:a.frame===0?1:.9,u_Diffuse1:a.sampleRenderTarget,u_Diffuse2:a.frame===0?n.multiPassRenderer.getPostProcessor().getReadFBO():a.prevRenderTarget}})}),this.frame===0&&f({color:[0,0,0,0],depth:1,stencil:0,framebuffer:this.copyRenderTarget}),this.frame>=1&&(x(this.copyRenderTarget,function(){a.outputModel.draw({uniforms:{u_Texture:a.outputRenderTarget}})}),x(n.multiPassRenderer.getPostProcessor().getReadFBO(),function(){a.copyModel.draw({uniforms:{u_Texture:a.copyRenderTarget}})}),n.multiPassRenderer.getPostProcessor().render(n));var Qe=this.prevRenderTarget;this.prevRenderTarget=this.outputRenderTarget,this.outputRenderTarget=Qe,this.frame++,this.cameraService.clearJitterProjectionMatrix()}},{key:"isFinished",value:function(){return this.frame>=this.haltonSequence.length}},{key:"resetFrame",value:function(){this.frame=0}},{key:"stopAccumulating",value:function(){this.accumulatingId=0,window.clearTimeout(this.timer)}},{key:"createTriangleModel",value:function(n,a,u){this.shaderModuleService.registerModule(n,{vs:qE,fs:a});var f=this.shaderModuleService.getModule(n),g=f.vs,x=f.fs,I=f.uniforms,O=this.rendererService,B=O.createAttribute,W=O.createBuffer,he=O.createModel;return he((0,X.Z)({vs:g,fs:x,attributes:{a_Position:B({buffer:W({data:[-4,-4,4,-4,0,4],type:Ge.FLOAT}),size:2})},uniforms:(0,X.Z)({},I),depth:{enable:!1},count:3},u))}}]),t}(Td),cy=Hi(eg.prototype,"shaderModuleService",[uy],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),eg))||ly),lp=new dr.W2;lp.bind(Xt.IGlobalConfigService).to(FA).inSingletonScope(),(0,dr.GW)((0,dr.b2)(),xa.EventEmitter),lp.bind(Xt.IEventEmitter).to(xa.EventEmitter);var Ay=(0,Ri.Z)(lp,!1),tg=function(i){var t=Ay.lazyInject(i);return function(r,n,a){t.call(this,r,n),a&&(a.initializer=function(){return r[n]})}},Y6=function(i){var t=Ay.lazyMultiInject(i);return function(r,n,a){t.call(this,r,n),a&&(a.initializer=function(){return r[n]})}},ql=lp,e3=0;function t3(){var e=new dr.W2;return e.parent=lp,e.bind(Xt.SceneID).toConstantValue("".concat(e3++)),e.bind(Xt.IShaderModuleService).to(Nx).inSingletonScope(),e.bind(Xt.ILayerService).to(fm).inSingletonScope(),e.bind(Xt.IDebugService).to(zc).inSingletonScope(),e.bind(Xt.ISceneService).to(po).inSingletonScope(),e.bind(Xt.ICameraService).to(Av).inSingletonScope(),e.bind(Xt.ICoordinateSystemService).to(oh).inSingletonScope(),e.bind(Xt.IInteractionService).to($A).inSingletonScope(),e.bind(Xt.IPickingService).to(Dv).inSingletonScope(),e.bind(Xt.IControlService).to(kA).inSingletonScope(),e.bind(Xt.IMarkerService).to(Up).inSingletonScope(),e.bind(Xt.IIconService).to(Ya).inSingletonScope(),e.bind(Xt.IFontService).to(Kr).inSingletonScope(),e.bind(Xt.IPopupService).to(gv).inSingletonScope(),e.bind(Xt.INormalPass).to(zx).whenTargetNamed("clear"),e.bind(Xt.INormalPass).to($x).whenTargetNamed("pixelPicking"),e.bind(Xt.INormalPass).to(WE).whenTargetNamed("render"),e.bind(Xt.INormalPass).to(JE).whenTargetNamed("taa"),e.bind(Xt.IFactoryNormalPass).toFactory(function(i){return function(t){return i.container.getNamed(Xt.INormalPass,t)}}),e.bind(Xt.IPostProcessingPass).to(bE).whenTargetNamed("copy"),e.bind(Xt.IPostProcessingPass).to(tE).whenTargetNamed("bloom"),e.bind(Xt.IPostProcessingPass).to(sE).whenTargetNamed("blurH"),e.bind(Xt.IPostProcessingPass).to(AE).whenTargetNamed("blurV"),e.bind(Xt.IPostProcessingPass).to(BE).whenTargetNamed("noise"),e.bind(Xt.IPostProcessingPass).to(jE).whenTargetNamed("sepia"),e.bind(Xt.IPostProcessingPass).to(mE).whenTargetNamed("colorHalftone"),e.bind(Xt.IPostProcessingPass).to(ME).whenTargetNamed("hexagonalPixelate"),e.bind(Xt.IPostProcessingPass).to(RE).whenTargetNamed("ink"),e.bind(Xt.IFactoryPostProcessingPass).toFactory(function(i){return function(t){var r=i.container.getNamed(Xt.IPostProcessingPass,t);return r.setName(t),r}}),e}function cp(e){var i=new dr.W2;return i.parent=e,i.bind(Xt.IStyleAttributeService).to(tp).inSingletonScope(),i.bind(Xt.IMultiPassRenderer).to(jx).inSingletonScope(),i.bind(Xt.IPostProcessor).to(VE).inSingletonScope(),i}var r3=null;function X6(e){return r3.indexOf(e)}var py=In.clamp,n3=2,Q6=4,i3=64,q6=128,a3=256,o3=512,K6=8192,J6=16384,eL=32768,s3=null,dy=131072,tL=262144,u3=524288,rL=1048576,l3=2097152,nL=4194304,c3=8388608,f3=16777216,h3=null;function Md(e,i){return e=py(Math.floor(e),0,255),i=py(Math.floor(i),0,255),256*e+i}function iL(e){var i=e.color,t=e.radius,r=e.tileX,n=e.tileY,a=e.shape,u=e.opacity,f=e.stroke,g=e.strokeWidth,x=e.strokeOpacity,I=[],O=[],B=[],W=[Md(i[0],i[1]),Md(i[2],i[3])],he=[Md(f[0],f[1]),Md(f[2],f[3])];return[[-1,-1],[1,-1],[1,1],[-1,1]].forEach(function(ae){var Se=_slicedToArray(ae,2),Fe=Se[0],Qe=Se[1];I.push([].concat(W,[(Fe+1)*c3+(Qe+1)*l3+getShapeIndex(a)*dy+t,(r+512)*u3+(n+512)*i3])),O.push([].concat(he,[g,x])),B.push([u,0,0,0])}),{packedBuffer:I,packedBuffer2:O,packedBuffer3:B}}function aL(e,i){if(e===0&&!i)return 0;if(e===1&&i)return 4294967295;var t=i?1:0,r=Math.floor(e*127);return r*h3+t*f3+r*dy+t*s3+r*o3+t*a3+r*n3+t}var hh={ProjectionMatrix:"u_ProjectionMatrix",ViewMatrix:"u_ViewMatrix",ViewProjectionMatrix:"u_ViewProjectionMatrix",Zoom:"u_Zoom",ZoomScale:"u_ZoomScale",FocalDistance:"u_FocalDistance",CameraPosition:"u_CameraPosition"},Ks={MapInitStart:"mapInitStart",LayerInitStart:"layerInitStart",LayerInitEnd:"layerInitEnd",SourceInitStart:"sourceInitStart",SourceInitEnd:"sourceInitEnd",ScaleInitStart:"scaleInitStart",ScaleInitEnd:"scaleInitEnd",MappingStart:"mappingStart",MappingEnd:"mappingEnd",BuildModelStart:"buildModelStart",BuildModelEnd:"buildModelEnd"},so=function(e){return e.LINEAR="linear",e.SEQUENTIAL="sequential",e.POWER="power",e.LOG="log",e.IDENTITY="identity",e.TIME="time",e.QUANTILE="quantile",e.QUANTIZE="quantize",e.THRESHOLD="threshold",e.CAT="cat",e.DIVERGING="diverging",e}({}),tA=function(e){return e.CONSTANT="constant",e.VARIABLE="variable",e}({}),mn=function(e){return e[e.Attribute=0]="Attribute",e[e.InstancedAttribute=1]="InstancedAttribute",e[e.Uniform=2]="Uniform",e}({}),vy=["mapload","mapchange","mapAfterFrameChange"],Id=["loaded","fontloaded","maploaded","resize","destroy","dragstart","dragging","dragend","dragcancel"],Yu=function(e){return e.IMAGE="image",e.CUSTOMIMAGE="customImage",e.ARRAYBUFFER="arraybuffer",e.RGB="rgb",e.TERRAINRGB="terrainRGB",e.CUSTOMRGB="customRGB",e.CUSTOMARRAYBUFFER="customArrayBuffer",e.CUSTOMTERRAINRGB="customTerrainRGB",e}({}),A3=function(){var e=(0,ur.Z)(nt().mark(function i(t,r,n,a){return nt().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return f.abrupt("return",new Promise(function(g,x){r({x:t.x,y:t.y,z:t.z},function(I,O){if(I||O.length===0){x(I);return}O&&Aa([{data:O,bands:[0]}],n,a,function(B,W){B?x(B):W&&g(W)})})}));case 1:case"end":return f.stop()}},i)}));return function(t,r,n,a){return e.apply(this,arguments)}}(),p3=function(){var e=(0,ur.Z)(nt().mark(function i(t,r){return nt().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",new Promise(function(u,f){r({x:t.x,y:t.y,z:t.z},function(g,x){if(g||!x){f(g);return}x instanceof ArrayBuffer?At(x,function(I,O){I&&f(I),u(O)}):x instanceof HTMLImageElement?u(x):f(g)})}));case 1:case"end":return a.stop()}},i)}));return function(t,r){return e.apply(this,arguments)}}();function v3(e,i){return Array.isArray(e)?typeof e[0]=="string"?e.map(function(t){return bl(t,i)}):e.map(function(t){return{url:bl(t.url,i),bands:t.bands||[0]}}):bl(e,i)}function g3(e){return typeof e=="string"?[{url:e,bands:[0]}]:typeof e[0]=="string"?e.map(function(i){return{url:i,bands:[0]}}):e}function gy(e,i){e.xhrCancel=function(){i.map(function(t){t.abort()})}}var m3=function(){var e=(0,ur.Z)(nt().mark(function i(t,r,n,a,u){var f,g,x,I,O,B;return nt().wrap(function(he){for(;;)switch(he.prev=he.next){case 0:if(f=g3(r.url),!(f.length>1)){he.next=15;break}return he.next=4,y3(f,r);case 4:if(g=he.sent,x=g.rasterFiles,I=g.xhrList,O=g.errList,gy(t,I),!(O.length>0)){he.next=12;break}return n(O,null),he.abrupt("return");case 12:Aa(x,a,u,n),he.next=17;break;case 15:B=sn(r,function(ae,Se){if(ae)n(ae);else if(Se){var Fe=[{data:Se,bands:f[0].bands}];Aa(Fe,a,u,n)}}),gy(t,[B]);case 17:case"end":return he.stop()}},i)}));return function(t,r,n,a,u){return e.apply(this,arguments)}}();function y3(e,i){return rg.apply(this,arguments)}function rg(){return rg=(0,ur.Z)(nt().mark(function e(i,t){var r,n,a,u,f,g,x,I,O,B,W;return nt().wrap(function(ae){for(;;)switch(ae.prev=ae.next){case 0:r=[],n=[],a=[],u=0;case 4:if(!(u<i.length)){ae.next=20;break}return f=i[u],g=(0,X.Z)((0,X.Z)({},t),{},{url:f.url}),x=f.bands,ae.next=10,ti((0,X.Z)((0,X.Z)({},g),{},{type:"arrayBuffer"}));case 10:I=ae.sent,O=I.err,B=I.data,W=I.xhr,O&&a.push(O),n.push(W),r.push({data:B,bands:x});case 17:u++,ae.next=4;break;case 20:return ae.abrupt("return",{rasterFiles:r,xhrList:n,errList:a});case 21:case"end":return ae.stop()}},e)})),rg.apply(this,arguments)}var _3=function(){var e=(0,ur.Z)(nt().mark(function i(t,r,n,a,u){var f;return nt().wrap(function(x){for(;;)switch(x.prev=x.next){case 0:return f={url:v3(t,r)},x.abrupt("return",new Promise(function(I,O){m3(n,f,function(B,W){B?O(B):W&&I(W)},a,u)}));case 2:case"end":return x.stop()}},i)}));return function(t,r,n,a,u){return e.apply(this,arguments)}}(),yy=function(){var e=(0,ur.Z)(nt().mark(function i(t,r,n,a){var u,f,g,x;return nt().wrap(function(O){for(;;)switch(O.prev=O.next){case 0:return f=Array.isArray(t)?t[0]:t,a.wmtsOptions?(g=(a==null?void 0:a.getURLFromTemplate)||ms,u=g(f,(0,X.Z)((0,X.Z)({},r),a.wmtsOptions))):(x=(a==null?void 0:a.getURLFromTemplate)||bl,u=x(f,r)),O.abrupt("return",new Promise(function(B,W){var he,ae=$e({url:u,type:(a==null||(he=a.requestParameters)===null||he===void 0?void 0:he.type)||"arrayBuffer"},function(Se,Fe){Se?W(Se):Fe&&B(Fe)},a.transformResponse);n.xhrCancel=function(){return ae.cancel()}}));case 3:case"end":return O.stop()}},i)}));return function(t,r,n,a){return e.apply(this,arguments)}}(),_y=function(){return{rasterData:new Uint8Array([0]),width:1,height:1}},x3={tileSize:256,minZoom:0,maxZoom:1/0,zoomOffset:0,warp:!0},oL=[Yu.ARRAYBUFFER,Yu.RGB];function E3(e){return!!(Array.isArray(e)&&e.length===0||!Array.isArray(e)&&typeof e!="string")}function b3(e){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(E3(e))throw new Error("tile server url is error");var t=(i==null?void 0:i.dataType)||Yu.IMAGE;t===Yu.RGB&&(t=Yu.ARRAYBUFFER);var r=function(u,f){switch(t){case Yu.IMAGE:return yy(e,u,f,i);case Yu.CUSTOMIMAGE:case Yu.CUSTOMTERRAINRGB:return p3(f,i==null?void 0:i.getCustomData);case Yu.ARRAYBUFFER:return _3(e,u,f,(i==null?void 0:i.format)||_y,i==null?void 0:i.operation);case Yu.CUSTOMARRAYBUFFER:case Yu.CUSTOMRGB:return A3(f,i==null?void 0:i.getCustomData,(i==null?void 0:i.format)||_y,i==null?void 0:i.operation);default:return yy(e,u,f,i)}},n=(0,X.Z)((0,X.Z)((0,X.Z)({},x3),i),{},{getTileData:r});return{data:e,dataArray:[],tilesetOptions:n,isTile:!0}}var S3=["extent","min","max","width","height","format","operation"];function C3(e,i){var t=i.extent,r=i.min,n=i.max,a=i.width,u=i.height,f=i.format,g=i.operation,x=(0,hc.Z)(i,S3),I;if(f===void 0||lf(e))I=Array.from(e);else{var O=Array.isArray(e)?e:[e];I=Ua(O,f,g)}var B={_id:1,dataArray:[(0,X.Z)((0,X.Z)({_id:1,data:I,width:a,height:u},x),{},{min:r,max:n,coordinates:[[t[0],t[1]],[t[2],t[3]]]})]};return B}var w3={tileSize:256,minZoom:0,maxZoom:1/0,zoomOffset:0},T3=function(){var e=(0,ur.Z)(nt().mark(function i(t){return nt().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",new Promise(function(a){var u=(0,vn.Z)(t.bounds,4),f=u[0],g=u[1],x=u[2],I=u[3],O={layers:{testTile:{features:[{type:"Feature",properties:{key:t.x+"/"+t.y+"/"+t.z,x:(f+x)/2,y:(g+I)/2},geometry:{type:"LineString",coordinates:[[x,I],[x,g],[f,g],[f,g]]}}]}}};a(O)}));case 1:case"end":return n.stop()}},i)}));return function(t){return e.apply(this,arguments)}}();function M3(e,i){var t=function(a){return T3(a)},r=(0,X.Z)((0,X.Z)((0,X.Z)({},w3),i),{},{getTileData:t});return{data:e,dataArray:[],tilesetOptions:r,isTile:!0}}var I3=C(77028),L3=C.n(I3);function xy(e,i){var t=i.radius,r=t===void 0?40:t,n=i.maxZoom,a=n===void 0?18:n,u=i.minZoom,f=u===void 0?0:u,g=i.zoom,x=g===void 0?2:g;if(e.pointIndex){var I=e.pointIndex.getClusters(e.extent,Math.floor(x));return e.dataArray=P3(I),e}var O=new(L3())({radius:r,minZoom:f,maxZoom:a}),B={type:"FeatureCollection",features:[]};return B.features=e.dataArray.map(function(W){return{type:"Feature",geometry:{type:"Point",coordinates:W.coordinates},properties:(0,X.Z)({},W)}}),O.load(B.features),O}function P3(e){return e.map(function(i,t){return(0,X.Z)({coordinates:i.geometry.coordinates,_id:t+1},i.properties)})}function O3(e){if(e.length===0)throw new Error("max requires at least one data point");for(var i=e[0],t=1;t<e.length;t++)e[t]>i&&(i=e[t]);return i}function R3(e){if(e.length===0)throw new Error("min requires at least one data point");for(var i=e[0],t=1;t<e.length;t++)e[t]<i&&(i=e[t]);return i}function Ey(e){if(e.length===0)return 0;for(var i=e[0],t=0,r,n=1;n<e.length;n++)r=i+e[n]*1,Math.abs(i)>=Math.abs(e[n])?t+=i-r+e[n]:t+=e[n]-r+i,i=r;return i+t*1}function k3(e){if(e.length===0)throw new Error("mean requires at least one data point");return Ey(e)/e.length}var D3={min:R3,max:O3,mean:k3,sum:Ey};function N3(e){var i=F3();return function(){var r=(0,oe.Z)(e),n;if(i){var a=(0,oe.Z)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return(0,Ze.Z)(this,n)}}function F3(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var B3=In.cloneDeep,by=In.isFunction,Z3=In.isString,z3=In.mergeWith;function U3(e,i){if(Array.isArray(i))return i}var G3=function(e){(0,ke.Z)(t,e);var i=N3(t);function t(r,n){var a;return(0,ue.Z)(this,t),a=i.call(this),(0,Ce.Z)((0,bt.Z)(a),"type","source"),(0,Ce.Z)((0,bt.Z)(a),"isTile",!1),(0,Ce.Z)((0,bt.Z)(a),"inited",!1),(0,Ce.Z)((0,bt.Z)(a),"hooks",{init:new Uc}),(0,Ce.Z)((0,bt.Z)(a),"parser",{type:"geojson"}),(0,Ce.Z)((0,bt.Z)(a),"transforms",[]),(0,Ce.Z)((0,bt.Z)(a),"cluster",!1),(0,Ce.Z)((0,bt.Z)(a),"clusterOptions",{enable:!1,radius:40,maxZoom:20,zoom:-99,method:"count"}),(0,Ce.Z)((0,bt.Z)(a),"invalidExtent",!1),(0,Ce.Z)((0,bt.Z)(a),"dataArrayChanged",!1),(0,Ce.Z)((0,bt.Z)(a),"cfg",{autoRender:!0}),a.originData=r,a.initCfg(n),a.init().then(function(){a.inited=!0,a.emit("update",{type:"inited"})}),a}return(0,me.Z)(t,[{key:"getSourceCfg",value:function(){return this.cfg}},{key:"getClusters",value:function(n){return this.clusterIndex.getClusters(this.caculClusterExtent(2),n)}},{key:"getClustersLeaves",value:function(n){return this.clusterIndex.getLeaves(n,1/0)}},{key:"getParserType",value:function(){return this.parser.type}},{key:"updateClusterData",value:function(n){var a=this,u=this.clusterOptions,f=u.method,g=f===void 0?"sum":f,x=u.field,I=this.clusterIndex.getClusters(this.caculClusterExtent(2),Math.floor(n));this.clusterOptions.zoom=n,I.forEach(function(O){O.id||(O.properties.point_count=1)}),(x||by(g))&&(I=I.map(function(O){var B=O.id;if(B){var W=a.clusterIndex.getLeaves(B,1/0),he=W.map(function(Fe){return Fe.properties}),ae;if(Z3(g)&&x){var Se=Tl(he,x);ae=D3[g](Se)}by(g)&&(ae=g(he)),O.properties.stat=ae}else O.properties.point_count=1;return O})),this.data=F("geojson")({type:"FeatureCollection",features:I}),this.executeTrans()}},{key:"getFeatureById",value:function(n){var a=this.parser,u=a.type,f=u===void 0?"geojson":u,g=a.geometry;if(f==="geojson"&&!this.cluster){var x=n<this.originData.features.length?this.originData.features[n]:"null",I=B3(x);if(I!=null&&I.properties&&(this.transforms.length!==0||this.dataArrayChanged)){var O=this.data.dataArray.find(function(B){return B._id===n});I.properties=O}return I}else return f==="json"&&g?this.data.dataArray.find(function(B){return B._id===n}):n<this.data.dataArray.length?this.data.dataArray[n]:"null"}},{key:"updateFeaturePropertiesById",value:function(n,a){this.data.dataArray=this.data.dataArray.map(function(u){return u._id===n?(0,X.Z)((0,X.Z)({},u),a):u}),this.dataArrayChanged=!0,this.emit("update",{type:"update"})}},{key:"getFeatureId",value:function(n,a){var u=this.data.dataArray.find(function(f){return f[n]===a});return u==null?void 0:u._id}},{key:"setData",value:function(n,a){var u=this;this.originData=n,this.dataArrayChanged=!1,this.initCfg(a),this.init().then(function(){u.emit("update",{type:"update"})})}},{key:"reloadAllTile",value:function(){var n;(n=this.tileset)===null||n===void 0||n.reloadAll()}},{key:"reloadTilebyId",value:function(n,a,u){var f;(f=this.tileset)===null||f===void 0||f.reloadTileById(n,a,u)}},{key:"reloadTileByLnglat",value:function(n,a,u){var f;(f=this.tileset)===null||f===void 0||f.reloadTileByLnglat(n,a,u)}},{key:"getTileExtent",value:function(n,a){var u;return(u=this.tileset)===null||u===void 0?void 0:u.getTileExtent(n,a)}},{key:"getTileByZXY",value:function(n,a,u){var f;return(f=this.tileset)===null||f===void 0?void 0:f.getTileByZXY(n,a,u)}},{key:"reloadTileByExtent",value:function(n,a){var u;(u=this.tileset)===null||u===void 0||u.reloadTileByExtent(n,a)}},{key:"destroy",value:function(){var n;this.removeAllListeners(),this.originData=null,this.clusterIndex=null,this.data=null,(n=this.tileset)===null||n===void 0||n.destroy()}},{key:"processData",value:function(){var r=(0,ur.Z)(nt().mark(function a(){var u=this;return nt().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return g.abrupt("return",new Promise(function(x,I){try{u.excuteParser(),u.initCluster(),u.executeTrans(),x({})}catch(O){I(O)}}));case 1:case"end":return g.stop()}},a)}));function n(){return r.apply(this,arguments)}return n}()},{key:"initCfg",value:function(n){this.cfg=z3(this.cfg,n,U3);var a=this.cfg;a&&(a.parser&&(this.parser=a.parser),a.transforms&&(this.transforms=a.transforms),this.cluster=a.cluster||!1,a.clusterOptions&&(this.cluster=!0,this.clusterOptions=(0,X.Z)((0,X.Z)({},this.clusterOptions),a.clusterOptions)))}},{key:"init",value:function(){var r=(0,ur.Z)(nt().mark(function a(){return nt().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return this.inited=!1,f.next=3,this.processData();case 3:this.inited=!0;case 4:case"end":return f.stop()}},a,this)}));function n(){return r.apply(this,arguments)}return n}()},{key:"excuteParser",value:function(){var n=this.parser,a=n.type||"geojson",u=F(a);this.data=u(this.originData,n),this.tileset=this.initTileset(),!n.cancelExtent&&(this.extent=ru(this.data.dataArray),this.setCenter(this.extent),this.invalidExtent=this.extent[0]===this.extent[2]||this.extent[1]===this.extent[3])}},{key:"setCenter",value:function(n){this.center=[(n[0]+n[2])/2,(n[1]+n[3])/2],(isNaN(this.center[0])||isNaN(this.center[1]))&&(this.center=[108.92361111111111,34.54083333333333])}},{key:"initTileset",value:function(){var n=this.data.tilesetOptions;if(n){if(this.isTile=!0,this.tileset)return this.tileset.updateOptions(n),this.tileset;var a=new Ws((0,X.Z)({},n));return a}}},{key:"executeTrans",value:function(){var n=this,a=this.transforms;a.forEach(function(u){var f=u.type,g=q(f)(n.data,u);Object.assign(n.data,g)})}},{key:"initCluster",value:function(){if(this.cluster){var n=this.clusterOptions||{};this.clusterIndex=xy(this.data,n)}}},{key:"caculClusterExtent",value:function(n){var a=[[-1/0,-1/0],[1/0,1/0]];return this.invalidExtent||(a=Au(Ja(this.extent),n)),a[0].concat(a[1])}}]),t}(xa.EventEmitter);function j3(e,i){var t=i.callback;return t&&(e.dataArray=e.dataArray.filter(t)),e}function Sy(e,i){var t=typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=V3(e))||i&&e&&typeof e.length=="number"){t&&(e=t);var r=0,n=function(){};return{s:n,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(x){throw x},f:n}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var a=!0,u=!1,f;return{s:function(){t=t.call(e)},n:function(){var x=t.next();return a=x.done,x},e:function(x){u=!0,f=x},f:function(){try{!a&&t.return!=null&&t.return()}finally{if(u)throw f}}}}function V3(e,i){if(e){if(typeof e=="string")return Cy(e,i);var t=Object.prototype.toString.call(e).slice(8,-1);if(t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set")return Array.from(e);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return Cy(e,i)}}function Cy(e,i){(i==null||i>e.length)&&(i=e.length);for(var t=0,r=new Array(i);t<i;t++)r[t]=e[t];return r}var ng=6378e3;function H3(e,i){var t=e.dataArray,r=i.size,n=r===void 0?10:r,a=n/(2*Math.PI*ng)*(256<<20)/2,u=$3(t,n),f=u.gridHash,g=u.gridOffset,x=Q3(f,g,i);return{yOffset:a,xOffset:a,radius:a,type:"grid",dataArray:x}}function $3(e,i){var t=1/0,r=-1/0,n,a=Sy(e),u;try{for(a.s();!(u=a.n()).done;){var f=u.value;n=f.coordinates[1],Number.isFinite(n)&&(t=n<t?n:t,r=n>r?n:r)}}catch(qe){a.e(qe)}finally{a.f()}var g=(t+r)/2,x=W3(i,g);if(x.xOffset<=0||x.yOffset<=0)return{gridHash:{},gridOffset:x};var I={},O=Sy(e),B;try{for(O.s();!(B=O.n()).done;){var W=B.value,he=W.coordinates[1],ae=W.coordinates[0];if(Number.isFinite(he)&&Number.isFinite(ae)){var Se=Math.floor((he+90)/x.yOffset),Fe=Math.floor((ae+180)/x.xOffset),Qe="".concat(Se,"-").concat(Fe);I[Qe]=I[Qe]||{count:0,points:[]},I[Qe].count+=1,I[Qe].points.push(W)}}}catch(qe){O.e(qe)}finally{O.f()}return{gridHash:I,gridOffset:x}}function W3(e,i){var t=Y3(e),r=X3(i,e);return{yOffset:t,xOffset:r}}function Y3(e){return e/ng*(180/Math.PI)}function X3(e,i){return i/ng*(180/Math.PI)/Math.cos(e*Math.PI/180)}function Q3(e,i,t){return Object.keys(e).reduce(function(r,n,a){var u=n.split("-"),f=parseInt(u[0],10),g=parseInt(u[1],10),x={};if(t.field&&t.method){var I=Vs(e[n].points,t.field);x[t.method]=To[t.method](I)}return Object.assign(x,{_id:a,coordinates:va([-180+i.xOffset*(g+.5),-90+i.yOffset*(f+.5)]),rawData:e[n].points,count:e[n].count}),r.push(x),r},[])}var rA=Math.PI/3,q3=[0,rA,2*rA,3*rA,4*rA,5*rA];function K3(e){return e[0]}function J3(e){return e[1]}function eb(){var e=0,i=0,t=1,r=1,n=K3,a=J3,u,f,g;function x(O){var B={},W=[],he,ae=O.length;for(he=0;he<ae;++he)if(!(isNaN(Fe=+n.call(null,Se=O[he],he,O))||isNaN(Qe=+a.call(null,Se,he,O)))){var Se,Fe,Qe,qe=Math.round(Qe=Qe/g),yt=Math.round(Fe=Fe/f-(qe&1)/2),Et=Qe-qe;if(Math.abs(Et)*3>1){var Ot=Fe-yt,jt=yt+(Fe<yt?-1:1)/2,or=qe+(Qe<qe?-1:1),ar=Fe-jt,br=Qe-or;Ot*Ot+Et*Et>ar*ar+br*br&&(yt=jt+(qe&1?1:-1)/2,qe=or)}var pr=yt+"-"+qe,jr=B[pr];jr?jr.push(Se):(W.push(jr=B[pr]=[Se]),jr.x=(yt+(qe&1)/2)*f,jr.y=qe*g)}return W}function I(O){var B=0,W=0;return q3.map(function(he){var ae=Math.sin(he)*O,Se=-Math.cos(he)*O,Fe=ae-B,Qe=Se-W;return B=ae,W=Se,[Fe,Qe]})}return x.hexagon=function(O){return"m"+I(O==null?u:+O).join("l")+"z"},x.centers=function(){for(var O=[],B=Math.round(i/g),W=Math.round(e/f),he=B*g;he<r+u;he+=g,++B)for(var ae=W*f+(B&1)*f/2;ae<t+f/2;ae+=f)O.push([ae,he]);return O},x.mesh=function(){var O=I(u).slice(0,4).join("l");return x.centers().map(function(B){return"M"+B+"m"+O}).join("")},x.x=function(O){return arguments.length?(n=O,x):n},x.y=function(O){return arguments.length?(a=O,x):a},x.radius=function(O){return arguments.length?(u=+O,f=u*2*Math.sin(rA),g=u*1.5,x):u},x.size=function(O){return arguments.length?(e=i=0,t=+O[0],r=+O[1],x):[t-e,r-i]},x.extent=function(O){return arguments.length?(e=+O[0][0],i=+O[0][1],t=+O[1][0],r=+O[1][1],x):[[e,i],[t,r]]},x.radius(1)}var tb=6378e3;function rb(e,i){var t=e.dataArray,r=i.size,n=r===void 0?10:r,a=i.method,u=a===void 0?"sum":a,f=n/(2*Math.PI*tb)*(256<<20)/2,g=t.map(function(B){var W=va(B.coordinates),he=(0,vn.Z)(W,2),ae=he[0],Se=he[1];return(0,X.Z)((0,X.Z)({},B),{},{coordinates:[ae,Se]})}),x=eb().radius(f).x(function(B){return B.coordinates[0]}).y(function(B){return B.coordinates[1]}),I=x(g),O={dataArray:I.map(function(B,W){var he;if(i.field&&u){var ae=Vs(B,i.field);B[u]=To[u](ae)}return he={},(0,Ce.Z)(he,i.method,B[u]),(0,Ce.Z)(he,"count",B.length),(0,Ce.Z)(he,"rawData",B),(0,Ce.Z)(he,"coordinates",[B.x,B.y]),(0,Ce.Z)(he,"_id",W),he}),radius:f,xOffset:f,yOffset:f,type:"hexagon"};return O}function nb(e,i){var t=i.sourceField,r=i.targetField,n=i.data,a={};return n.forEach(function(u){a[u[t]]=u}),e.dataArray=e.dataArray.map(function(u){var f=u[r];return(0,X.Z)((0,X.Z)({},u),a[f])}),e}function ib(e,i){var t=i.callback;return t&&(e.dataArray=e.dataArray.map(t)),e}z("rasterTile",b3),z("mvt",ta),z("geojsonvt",Cn),z("testTile",M3),z("geojson",cl),z("jsonTile",vr),z("image",Xn),z("csv",ll),z("json",ys),z("raster",Rn),z("rasterRgb",C3),ee("cluster",xy),ee("filter",j3),ee("join",nb),ee("map",ib),ee("grid",H3),ee("hexagon",rb);var wy=G3;function sL(e){var i=ab();return function(){var r=_getPrototypeOf(e),n;if(i){var a=_getPrototypeOf(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return _possibleConstructorReturn(this,n)}}function ab(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var uL=null;function lL(e){var i=ob();return function(){var r=_getPrototypeOf(e),n;if(i){var a=_getPrototypeOf(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return _possibleConstructorReturn(this,n)}}function ob(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var cL=In.merge,fL=null,hL=C(1891);function sb(e){var i=ub();return function(){var r=(0,oe.Z)(e),n;if(i){var a=(0,oe.Z)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return(0,Ze.Z)(this,n)}}function ub(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var Ty=function(e){(0,ke.Z)(t,e);var i=sb(t);function t(r){var n;return(0,ue.Z)(this,t),n=i.call(this),t.controlCount++,n.controlOption=(0,X.Z)((0,X.Z)({},n.getDefault(r)),r||{}),n}return(0,me.Z)(t,[{key:"getOptions",value:function(){return this.controlOption}},{key:"setOptions",value:function(n){var a=this.getDefault(n);Object.entries(n).forEach(function(u){var f=(0,vn.Z)(u,2),g=f[0],x=f[1];x===void 0&&(n[g]=a[g])}),"position"in n&&this.setPosition(n.position),"className"in n&&this.setClassName(n.className),"style"in n&&this.setStyle(n.style),this.controlOption=(0,X.Z)((0,X.Z)({},this.controlOption),n)}},{key:"addTo",value:function(n){this.mapsService=n.get(Xt.IMapService),this.renderService=n.get(Xt.IRendererService),this.layerService=n.get(Xt.ILayerService),this.controlService=n.get(Xt.IControlService),this.configService=n.get(Xt.IGlobalConfigService),this.scene=n.get(Xt.ISceneService),this.sceneContainer=n,this.isShow=!0,this.container=this.onAdd(),Ha(this.container,"l7-control");var a=this.controlOption,u=a.className,f=a.style;return u&&this.setClassName(u),f&&this.setStyle(f),this.insertContainer(),this.emit("add",this),this}},{key:"remove",value:function(){if(!this.mapsService)return this;as(this.container),this.onRemove(),this.emit("remove",this)}},{key:"onAdd",value:function(){return ci("div")}},{key:"onRemove",value:function(){}},{key:"show",value:function(){var n=this.container;Ra(n,"l7-control--hide"),this.isShow=!0,this.emit("show",this)}},{key:"hide",value:function(){var n=this.container;Ha(n,"l7-control--hide"),this.isShow=!1,this.emit("hide",this)}},{key:"getDefault",value:function(n){return{position:Rh.TOPRIGHT,name:"".concat(t.controlCount)}}},{key:"getContainer",value:function(){return this.container}},{key:"getIsShow",value:function(){return this.isShow}},{key:"_refocusOnMap",value:function(n){if(this.mapsService&&n&&n.screenX>0&&n.screenY>0){var a=this.mapsService.getContainer();a!==null&&a.focus()}}},{key:"setPosition",value:function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Rh.TOPLEFT,a=this.controlService;return a&&a.removeControl(this),this.controlOption.position=n,a&&a.addControl(this,this.sceneContainer),this}},{key:"setClassName",value:function(n){var a=this.container,u=this.controlOption.className;u&&Ra(a,u),n&&Ha(a,n)}},{key:"setStyle",value:function(n){var a=this.container;n?a.setAttribute("style",n):a.removeAttribute("style")}},{key:"insertContainer",value:function(){var n=this.controlOption.position,a=this.container;if(n instanceof Element)n.appendChild(a);else{var u=this.controlService.controlCorners[n];["bottomleft","bottomright","righttop","rightbottom"].includes(n)?u.insertBefore(a,u.firstChild):u.appendChild(a)}}},{key:"checkUpdateOption",value:function(n,a){return a.some(function(u){return u in n})}}]),t}($s());(0,Ce.Z)(Ty,"controlCount",0);function AL(e){var i=lb();return function(){var r=_getPrototypeOf(e),n;if(i){var a=_getPrototypeOf(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return _possibleConstructorReturn(this,n)}}function lb(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var pL=null;function cb(e){var i=fb();return function(){var r=(0,oe.Z)(e),n;if(i){var a=(0,oe.Z)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return(0,Ze.Z)(this,n)}}function fb(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var hb=function(e){(0,ke.Z)(t,e);var i=cb(t);function t(r,n){var a;return(0,ue.Z)(this,t),a=i.call(this),(0,Ce.Z)((0,bt.Z)(a),"isShow",!1),(0,Ce.Z)((0,bt.Z)(a),"timeout",null),(0,Ce.Z)((0,bt.Z)(a),"show",function(){return a.isShow||!a.contentDOM.innerHTML||(a.resetPopperPosition(),Ra(a.popperDOM,"l7-popper-hide"),a.isShow=!0,a.option.unique&&t.conflictPopperList.forEach(function(u){u!==(0,bt.Z)(a)&&u.isShow&&u.hide()}),a.emit("show"),window.addEventListener("pointerdown",a.onPopperUnClick)),(0,bt.Z)(a)}),(0,Ce.Z)((0,bt.Z)(a),"hide",function(){return a.isShow&&(Ha(a.popperDOM,"l7-popper-hide"),a.isShow=!1,a.emit("hide"),window.removeEventListener("pointerdown",a.onPopperUnClick)),(0,bt.Z)(a)}),(0,Ce.Z)((0,bt.Z)(a),"setHideTimeout",function(){a.timeout||(a.timeout=window.setTimeout(function(){a.isShow&&(a.hide(),a.timeout=null)},300))}),(0,Ce.Z)((0,bt.Z)(a),"clearHideTimeout",function(){a.timeout&&(window.clearTimeout(a.timeout),a.timeout=null)}),(0,Ce.Z)((0,bt.Z)(a),"onBtnClick",function(){a.isShow?a.hide():a.show()}),(0,Ce.Z)((0,bt.Z)(a),"onPopperUnClick",function(u){vc(u.target,[".l7-button-control",".l7-popper-content"])||a.hide()}),(0,Ce.Z)((0,bt.Z)(a),"onBtnMouseLeave",function(){a.setHideTimeout()}),(0,Ce.Z)((0,bt.Z)(a),"onBtnMouseMove",function(){a.clearHideTimeout(),!a.isShow&&a.show()}),a.button=r,a.option=n,a.init(),n.unique&&t.conflictPopperList.push((0,bt.Z)(a)),a}return(0,me.Z)(t,[{key:"buttonRect",get:function(){return this.button.getBoundingClientRect()}},{key:"getPopperDOM",value:function(){return this.popperDOM}},{key:"getIsShow",value:function(){return this.isShow}},{key:"getContent",value:function(){return this.content}},{key:"setContent",value:function(n){typeof n=="string"?this.contentDOM.innerHTML=n:n instanceof HTMLElement&&(Ka(this.contentDOM),this.contentDOM.appendChild(n)),this.content=n}},{key:"init",value:function(){var n=this.option.trigger;this.popperDOM=this.createPopper(),n==="click"?this.button.addEventListener("click",this.onBtnClick):(this.button.addEventListener("mousemove",this.onBtnMouseMove),this.button.addEventListener("mouseleave",this.onBtnMouseLeave),this.popperDOM.addEventListener("mousemove",this.onBtnMouseMove),this.popperDOM.addEventListener("mouseleave",this.onBtnMouseLeave))}},{key:"destroy",value:function(){this.button.removeEventListener("click",this.onBtnClick),this.button.removeEventListener("mousemove",this.onBtnMouseMove),this.button.removeEventListener("mousemove",this.onBtnMouseLeave),this.popperDOM.removeEventListener("mousemove",this.onBtnMouseMove),this.popperDOM.removeEventListener("mouseleave",this.onBtnMouseLeave),as(this.popperDOM)}},{key:"resetPopperPosition",value:function(){var n={},a=this.option,u=a.container,f=a.offset,g=f===void 0?[0,0]:f,x=a.placement,I=(0,vn.Z)(g,2),O=I[0],B=I[1],W=this.button.getBoundingClientRect(),he=u.getBoundingClientRect(),ae=vl(W,he),Se=ae.left,Fe=ae.right,Qe=ae.top,qe=ae.bottom,yt=!1,Et=!1;/^(left|right)/.test(x)?(x.includes("left")?n.right="".concat(W.width+Fe,"px"):x.includes("right")&&(n.left="".concat(W.width+Se,"px")),x.includes("start")?n.top="".concat(Qe,"px"):x.includes("end")?n.bottom="".concat(qe,"px"):(n.top="".concat(Qe+W.height/2,"px"),Et=!0,n.transform="translate(".concat(O,"px, calc(").concat(B,"px - 50%))"))):/^(top|bottom)/.test(x)&&(x.includes("top")?n.bottom="".concat(W.height+qe,"px"):x.includes("bottom")&&(n.top="".concat(W.height+Qe,"px")),x.includes("start")?n.left="".concat(Se,"px"):x.includes("end")?n.right="".concat(Fe,"px"):(n.left="".concat(Se+W.width/2,"px"),yt=!0,n.transform="translate(calc(".concat(O,"px - 50%), ").concat(B,"px)"))),n.transform="translate(calc(".concat(O,"px - ").concat(yt?"50%":"0%","), calc(").concat(B,"px - ").concat(Et?"50%":"0%",")");var Ot=x.split("-");Ot.length&&Ha(this.popperDOM,Ot.map(function(jt){return"l7-popper-".concat(jt)}).join(" ")),os(this.popperDOM,Sn(n))}},{key:"createPopper",value:function(){var n=this.option,a=n.container,u=n.className,f=u===void 0?"":u,g=n.content,x=ci("div","l7-popper l7-popper-hide ".concat(f)),I=ci("div","l7-popper-content"),O=ci("div","l7-popper-arrow");return x.appendChild(I),x.appendChild(O),a.appendChild(x),this.popperDOM=x,this.contentDOM=I,g&&this.setContent(g),x}}]),t}(xa.EventEmitter);(0,Ce.Z)(hb,"conflictPopperList",[]);function dL(e){var i=Ab();return function(){var r=_getPrototypeOf(e),n;if(i){var a=_getPrototypeOf(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return _possibleConstructorReturn(this,n)}}function Ab(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var vL={topleft:"right-start",topcenter:"bottom",topright:"left-start",bottomleft:"right-end",bottomcenter:"top",bottomright:"left-end",lefttop:"bottom-start",leftcenter:"right",leftbottom:"top-start",righttop:"bottom-end",rightcenter:"left",rightbottom:"top-end"},gL=null;function mL(e){var i=pb();return function(){var r=_getPrototypeOf(e),n;if(i){var a=_getPrototypeOf(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return _possibleConstructorReturn(this,n)}}function pb(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var db=function(e){return e.ActiveOptionClassName="l7-select-control-item-active",e.OptionValueAttrKey="data-option-value",e.OptionIndexAttrKey="data-option-index",e}(db||{}),yL=null,_L=function(i){var t=document.createElementNS("http://www.w3.org/2000/svg","svg");t.classList.add("l7-iconfont"),t.setAttribute("aria-hidden","true");var r=document.createElementNS("http://www.w3.org/2000/svg","use");return r.setAttributeNS("http://www.w3.org/1999/xlink","href","#".concat(i)),t.appendChild(r),t};function xL(e){var i=vb();return function(){var r=_getPrototypeOf(e),n;if(i){var a=_getPrototypeOf(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return _possibleConstructorReturn(this,n)}}function vb(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var EL=null;function gb(e,i){var t=typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=mb(e))||i&&e&&typeof e.length=="number"){t&&(e=t);var r=0,n=function(){};return{s:n,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(x){throw x},f:n}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var a=!0,u=!1,f;return{s:function(){t=t.call(e)},n:function(){var x=t.next();return a=x.done,x},e:function(x){u=!0,f=x},f:function(){try{!a&&t.return!=null&&t.return()}finally{if(u)throw f}}}}function mb(e,i){if(e){if(typeof e=="string")return My(e,i);var t=Object.prototype.toString.call(e).slice(8,-1);if(t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set")return Array.from(e);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return My(e,i)}}function My(e,i){(i==null||i>e.length)&&(i=e.length);for(var t=0,r=new Array(i);t<i;t++)r[t]=e[t];return r}var Iy=[["requestFullscreen","exitFullscreen","fullscreenElement","fullscreenEnabled","fullscreenchange","fullscreenerror"],["webkitRequestFullscreen","webkitExitFullscreen","webkitFullscreenElement","webkitFullscreenEnabled","webkitfullscreenchange","webkitfullscreenerror"],["webkitRequestFullScreen","webkitCancelFullScreen","webkitCurrentFullScreenElement","webkitCancelFullScreen","webkitfullscreenchange","webkitfullscreenerror"],["mozRequestFullScreen","mozCancelFullScreen","mozFullScreenElement","mozFullScreenEnabled","mozfullscreenchange","mozfullscreenerror"],["msRequestFullscreen","msExitFullscreen","msFullscreenElement","msFullscreenEnabled","MSFullscreenChange","MSFullscreenError"]],e0=function(){if(typeof document=="undefined")return!1;for(var e=Iy[0],i={},t=0,r=Iy;t<r.length;t++){var n=r[t],a=n==null?void 0:n[1];if(a in document){var u=gb(n.entries()),f;try{for(u.s();!(f=u.n()).done;){var g=(0,vn.Z)(f.value,2),x=g[0],I=g[1];i[e[x]]=I}}catch(O){u.e(O)}finally{u.f()}return i}}return!1}(),Ly={change:e0.fullscreenchange,error:e0.fullscreenerror},jc={request:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document.documentElement,t=arguments.length>1?arguments[1]:void 0;return new Promise(function(r,n){var a=function f(){jc.off("change",f),r()};jc.on("change",a);var u=i[e0.requestFullscreen](t);u instanceof Promise&&u.then(a).catch(n)})},exit:function(){return new Promise(function(i,t){if(!jc.isFullscreen){i();return}var r=function a(){jc.off("change",a),i()};jc.on("change",r);var n=document[e0.exitFullscreen]();n instanceof Promise&&n.then(r).catch(t)})},toggle:function(i,t){return jc.isFullscreen?jc.exit():jc.request(i,t)},onchange:function(i){jc.on("change",i)},onerror:function(i){jc.on("error",i)},on:function(i,t){var r=Ly[i];r&&document.addEventListener(r,t,!1)},off:function(i,t){var r=Ly[i];r&&document.removeEventListener(r,t,!1)},raw:e0};Object.defineProperties(jc,{isFullscreen:{get:function(){return!!document[e0.fullscreenElement]}},element:{enumerable:!0,get:function(){var i;return(i=document[e0.fullscreenElement])!==null&&i!==void 0?i:void 0}},isEnabled:{enumerable:!0,get:function(){return!!document[e0.fullscreenEnabled]}}}),e0||(jc={isEnabled:!1});var bL=null;function SL(e){var i=yb();return function(){var r=_getPrototypeOf(e),n;if(i){var a=_getPrototypeOf(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return _possibleConstructorReturn(this,n)}}function yb(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var CL=null;function wL(e){var i=_b();return function(){var r=_getPrototypeOf(e),n;if(i){var a=_getPrototypeOf(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return _possibleConstructorReturn(this,n)}}function _b(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var TL=null;function ML(e){var i=xb();return function(){var r=_getPrototypeOf(e),n;if(i){var a=_getPrototypeOf(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return _possibleConstructorReturn(this,n)}}function xb(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}function IL(e){return e&&e.layer}var LL=null;function Eb(e){var i=bb();return function(){var r=(0,oe.Z)(e),n;if(i){var a=(0,oe.Z)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return(0,Ze.Z)(this,n)}}function bb(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var Sb=function(e){(0,ke.Z)(t,e);var i=Eb(t);function t(){return(0,ue.Z)(this,t),i.apply(this,arguments)}return(0,me.Z)(t,[{key:"getDefault",value:function(){return{position:Rh.BOTTOMLEFT,name:"logo",href:"https://l7.antv.antgroup.com/",img:"https://gw.alipayobjects.com/mdn/rms_816329/afts/img/A*GRb1TKp4HcMAAAAAAAAAAAAAARQnAQ"}}},{key:"onAdd",value:function(){var n=ci("div","l7-control-logo");return this.setLogoContent(n),n}},{key:"onRemove",value:function(){return null}},{key:"setOptions",value:function(n){R0((0,oe.Z)(t.prototype),"setOptions",this).call(this,n),this.checkUpdateOption(n,["img","href"])&&(Ka(this.container),this.setLogoContent(this.container))}},{key:"setLogoContent",value:function(n){var a=this.controlOption,u=a.href,f=a.img,g=ci("img");if(g.setAttribute("src",f),g.setAttribute("aria-label","AntV logo"),hs(g),u){var x=ci("a","l7-control-logo-link");x.target="_blank",x.href=u,x.rel="noopener nofollow",x.setAttribute("rel","noopener nofollow"),x.appendChild(g),n.appendChild(x)}else n.appendChild(g)}}]),t}(Ty),PL={normal:{text:"\u6807\u51C6",img:"https://mdn.alipayobjects.com/huamei_qa8qxu/afts/img/A*qdFDSbvIalgAAAAAAAAAAAAADmJ7AQ/original"},light:{text:"\u6708\u5149\u94F6",img:"https://mdn.alipayobjects.com/huamei_qa8qxu/afts/img/A*d-vcRLzu8WIAAAAAAAAAAAAADmJ7AQ/original"},dark:{text:"\u5E7B\u5F71\u9ED1",img:"https://mdn.alipayobjects.com/huamei_qa8qxu/afts/img/A*HMbRTI3XnpIAAAAAAAAAAAAADmJ7AQ/original"},fresh:{text:"\u8349\u8272\u9752",img:"https://mdn.alipayobjects.com/huamei_qa8qxu/afts/img/A*kqaGQ5kjSiAAAAAAAAAAAAAADmJ7AQ/original"},grey:{text:"\u96C5\u58EB\u7070",img:"https://mdn.alipayobjects.com/huamei_qa8qxu/afts/img/A*XegrTpZIbqAAAAAAAAAAAAAADmJ7AQ/original"},graffiti:{text:"\u6D82\u9E26",img:"https://mdn.alipayobjects.com/huamei_qa8qxu/afts/img/A*G5g9SZ_Jg4cAAAAAAAAAAAAADmJ7AQ/original"},macaron:{text:"\u9A6C\u5361\u9F99",img:"https://mdn.alipayobjects.com/huamei_qa8qxu/afts/img/A*irVvQbDpQMwAAAAAAAAAAAAADmJ7AQ/original"},darkblue:{text:"\u6781\u591C\u84DD",img:"https://mdn.alipayobjects.com/huamei_qa8qxu/afts/img/A*lKRzQYB4iR0AAAAAAAAAAAAADmJ7AQ/original"},wine:{text:"\u9171\u7C7D",img:"https://mdn.alipayobjects.com/huamei_qa8qxu/afts/img/A*orY0T7QL-lwAAAAAAAAAAAAADmJ7AQ/original"}},OL={normal:{text:"\u6807\u51C6",img:"https://mdn.alipayobjects.com/huamei_qa8qxu/afts/img/A*kIyZTok4Uk0AAAAAAAAAAAAADmJ7AQ/original"},light:{text:"\u4EAE",img:"https://mdn.alipayobjects.com/huamei_qa8qxu/afts/img/A*Z3JRQKDI-cIAAAAAAAAAAAAADmJ7AQ/original"},dark:{text:"\u6697",img:"https://mdn.alipayobjects.com/huamei_qa8qxu/afts/img/A*d7HCQbfmyaoAAAAAAAAAAAAADmJ7AQ/original"},satellite:{text:"\u536B\u661F",img:"https://mdn.alipayobjects.com/huamei_qa8qxu/afts/img/A*TytUT6pS9okAAAAAAAAAAAAADmJ7AQ/original"},outdoors:{text:"\u6237\u5916",img:"https://mdn.alipayobjects.com/huamei_qa8qxu/afts/img/A*hWwFSYJEFWsAAAAAAAAAAAAADmJ7AQ/original"}};function RL(e){var i=Cb();return function(){var r=_getPrototypeOf(e),n;if(i){var a=_getPrototypeOf(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return _possibleConstructorReturn(this,n)}}function Cb(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var kL=null;function DL(e){var i=wb();return function(){var r=_getPrototypeOf(e),n;if(i){var a=_getPrototypeOf(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return _possibleConstructorReturn(this,n)}}function wb(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var NL=null;function FL(e){var i=Tb();return function(){var r=_getPrototypeOf(e),n;if(i){var a=_getPrototypeOf(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return _possibleConstructorReturn(this,n)}}function Tb(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var BL=null;function ZL(e){var i=Mb();return function(){var r=_getPrototypeOf(e),n;if(i){var a=_getPrototypeOf(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return _possibleConstructorReturn(this,n)}}function Mb(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var zL=null;function UL(e){var i=Ib();return function(){var r=_getPrototypeOf(e),n;if(i){var a=_getPrototypeOf(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return _possibleConstructorReturn(this,n)}}function Ib(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var GL=null;function jL(e){var i=Lb();return function(){var r=_getPrototypeOf(e),n;if(i){var a=_getPrototypeOf(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return _possibleConstructorReturn(this,n)}}function Lb(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var VL=In.get,HL=null;function Pb(e,i){var t=typeof my!="undefined"&&!!my&&typeof my.showToast=="function"&&my.isFRM!==!0,r=typeof wx!="undefined"&&wx!==null&&(typeof wx.request!="undefined"||typeof wx.miniProgram!="undefined");if(!(t||r)&&(i||(i=document),!!i)){var n=i.head||i.getElementsByTagName("head")[0];if(!n){n=i.createElement("head");var a=i.body||i.getElementsByTagName("body")[0];a?a.parentNode.insertBefore(n,a):i.documentElement.appendChild(n)}var u=i.createElement("style");return u.type="text/css",u.styleSheet?u.styleSheet.cssText=e:u.appendChild(i.createTextNode(e)),n.appendChild(u),u}}Pb(`.l7-marker-container {
  position: absolute;
  width: 100%;
  height: 100%;
  overflow: hidden;
}
.l7-marker {
  position: absolute !important;
  top: 0;
  left: 0;
  z-index: 5;
  cursor: pointer;
}
.l7-marker-cluster {
  width: 40px;
  height: 40px;
  background-color: rgba(181, 226, 140, 0.6);
  background-clip: padding-box;
  border-radius: 20px;
}
.l7-marker-cluster div {
  width: 30px;
  height: 30px;
  margin-top: 5px;
  margin-left: 5px;
  font: 12px 'Helvetica Neue', Arial, Helvetica, sans-serif;
  text-align: center;
  background-color: rgba(110, 204, 57, 0.6);
  border-radius: 15px;
}
.l7-marker-cluster span {
  line-height: 30px;
}
.l7-touch .l7-control-attribution,
.l7-touch .l7-control-layers,
.l7-touch .l7-bar {
  -webkit-box-shadow: none;
          box-shadow: none;
}
.l7-touch .l7-control-layers,
.l7-touch .l7-bar {
  background-clip: padding-box;
  border: 2px solid rgba(0, 0, 0, 0.2);
}
.mapboxgl-ctrl-logo,
.amap-logo {
  display: none !important;
}
.l7-select-box {
  border: 3px dashed gray;
  border-radius: 2px;
  position: absolute;
  z-index: 999;
  -webkit-box-sizing: border-box;
          box-sizing: border-box;
}
.l7-control-container {
  font: 12px/1.5 'Helvetica Neue', Arial, Helvetica, sans-serif;
}
.l7-control-container .l7-control {
  position: relative;
  z-index: 999;
  float: left;
  clear: both;
  color: #595959;
  font-size: 12px;
  pointer-events: visiblePainted;
  /* IE 9-10 doesn't have auto */
  pointer-events: auto;
}
.l7-control-container .l7-control.l7-control--hide {
  display: none;
}
.l7-control-container .l7-top {
  top: 0;
  display: -webkit-box;
  display: -ms-flexbox;
  display: flex;
  position: absolute;
  z-index: 999;
  pointer-events: none;
}
.l7-control-container .l7-top .l7-control:not(.l7-control--hide) {
  margin-top: 8px;
}
.l7-control-container .l7-right {
  right: 0;
  display: -webkit-box;
  display: -ms-flexbox;
  display: flex;
  position: absolute;
  z-index: 999;
  pointer-events: none;
}
.l7-control-container .l7-right .l7-control:not(.l7-control--hide) {
  margin-right: 8px;
}
.l7-control-container .l7-bottom {
  bottom: 0;
  display: -webkit-box;
  display: -ms-flexbox;
  display: flex;
  position: absolute;
  z-index: 999;
  pointer-events: none;
}
.l7-control-container .l7-bottom .l7-control:not(.l7-control--hide) {
  margin-bottom: 8px;
}
.l7-control-container .l7-left {
  left: 0;
  display: -webkit-box;
  display: -ms-flexbox;
  display: flex;
  position: absolute;
  z-index: 999;
  pointer-events: none;
}
.l7-control-container .l7-left .l7-control:not(.l7-control--hide) {
  margin-left: 8px;
}
.l7-control-container .l7-center {
  position: absolute;
  display: -webkit-box;
  display: -ms-flexbox;
  display: flex;
  -webkit-box-pack: center;
      -ms-flex-pack: center;
          justify-content: center;
}
.l7-control-container .l7-center.l7-top,
.l7-control-container .l7-center.l7-bottom {
  width: 100%;
}
.l7-control-container .l7-center.l7-left,
.l7-control-container .l7-center.l7-right {
  height: 100%;
}
.l7-control-container .l7-center .l7-control {
  margin-right: 8px;
  margin-bottom: 8px;
}
.l7-control-container .l7-row {
  -webkit-box-orient: horizontal;
  -webkit-box-direction: normal;
      -ms-flex-direction: row;
          flex-direction: row;
}
.l7-control-container .l7-row.l7-top {
  -webkit-box-align: start;
      -ms-flex-align: start;
          align-items: flex-start;
}
.l7-control-container .l7-row.l7-bottom {
  -webkit-box-align: end;
      -ms-flex-align: end;
          align-items: flex-end;
}
.l7-control-container .l7-column {
  -webkit-box-orient: vertical;
  -webkit-box-direction: normal;
      -ms-flex-direction: column;
          flex-direction: column;
}
.l7-control-container .l7-column.l7-left {
  -webkit-box-align: start;
      -ms-flex-align: start;
          align-items: flex-start;
}
.l7-control-container .l7-column.l7-right {
  -webkit-box-align: end;
      -ms-flex-align: end;
          align-items: flex-end;
}
.l7-button-control {
  min-width: 28px;
  height: 28px;
  background-color: #fff;
  border-width: 0;
  border-radius: 2px;
  outline: 0;
  cursor: pointer;
  -webkit-transition: all 0.2s;
  transition: all 0.2s;
  display: -webkit-box;
  display: -ms-flexbox;
  display: flex;
  -webkit-box-pack: center;
      -ms-flex-pack: center;
          justify-content: center;
  -webkit-box-align: center;
      -ms-flex-align: center;
          align-items: center;
  padding: 0 6px;
  -webkit-box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.15);
          box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.15);
  line-height: 16px;
}
.l7-button-control .l7-iconfont {
  fill: #595959;
  color: #595959;
  width: 16px;
  height: 16px;
}
.l7-button-control.l7-button-control--row {
  padding: 0 16px 0 13px;
}
.l7-button-control.l7-button-control--row * + .l7-button-control__text {
  margin-left: 8px;
}
.l7-button-control.l7-button-control--column {
  height: 44px;
  -webkit-box-orient: vertical;
  -webkit-box-direction: normal;
      -ms-flex-direction: column;
          flex-direction: column;
}
.l7-button-control.l7-button-control--column .l7-iconfont {
  margin-top: 3px;
}
.l7-button-control.l7-button-control--column .l7-button-control__text {
  margin-top: 3px;
  font-size: 10px;
  -webkit-transform: scale(0.83333);
          transform: scale(0.83333);
}
.l7-button-control:not(:disabled):hover {
  background-color: #f3f3f3;
}
.l7-button-control:not(:disabled):active {
  background-color: #f3f3f3;
}
.l7-button-control:disabled {
  background-color: #fafafa;
  color: #bdbdbd;
  cursor: not-allowed;
}
.l7-button-control:disabled .l7-iconfont {
  fill: #bdbdbd;
  color: #bdbdbd;
}
.l7-button-control:disabled:hover {
  background-color: #fafafa;
}
.l7-button-control:disabled:active {
  background-color: #fafafa;
}
.l7-popper {
  position: absolute;
  display: -webkit-box;
  display: -ms-flexbox;
  display: flex;
  -webkit-box-pack: center;
      -ms-flex-pack: center;
          justify-content: center;
  -webkit-box-align: center;
      -ms-flex-align: center;
          align-items: center;
  z-index: 5;
  color: #595959;
}
.l7-popper.l7-popper-hide {
  display: none;
}
.l7-popper .l7-popper-content {
  min-height: 28px;
  background: #fff;
  border-radius: 2px;
  -webkit-box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.15);
          box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.15);
}
.l7-popper .l7-popper-arrow {
  width: 0;
  height: 0;
  border-width: 4px;
  border-style: solid;
  border-top-color: transparent;
  border-bottom-color: transparent;
  border-left-color: transparent;
  border-right-color: transparent;
  -webkit-box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.15);
          box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.15);
}
.l7-popper.l7-popper-left {
  -webkit-box-orient: horizontal;
  -webkit-box-direction: normal;
      -ms-flex-direction: row;
          flex-direction: row;
}
.l7-popper.l7-popper-left .l7-popper-arrow {
  border-left-color: #fff;
  margin: 10px 0;
}
.l7-popper.l7-popper-right {
  -webkit-box-orient: horizontal;
  -webkit-box-direction: reverse;
      -ms-flex-direction: row-reverse;
          flex-direction: row-reverse;
}
.l7-popper.l7-popper-right .l7-popper-arrow {
  border-right-color: #fff;
  margin: 10px 0;
}
.l7-popper.l7-popper-top {
  -webkit-box-orient: vertical;
  -webkit-box-direction: normal;
      -ms-flex-direction: column;
          flex-direction: column;
}
.l7-popper.l7-popper-top .l7-popper-arrow {
  border-top-color: #fff;
  margin: 0 10px;
}
.l7-popper.l7-popper-bottom {
  -webkit-box-orient: vertical;
  -webkit-box-direction: reverse;
      -ms-flex-direction: column-reverse;
          flex-direction: column-reverse;
}
.l7-popper.l7-popper-bottom .l7-popper-arrow {
  border-bottom-color: #fff;
  margin: 0 10px;
}
.l7-popper.l7-popper-start {
  -webkit-box-align: start;
      -ms-flex-align: start;
          align-items: flex-start;
}
.l7-popper.l7-popper-end {
  -webkit-box-align: end;
      -ms-flex-align: end;
          align-items: flex-end;
}
.l7-select-control--normal {
  padding: 4px 0;
}
.l7-select-control--normal .l7-select-control-item {
  height: 24px;
  line-height: 24px;
  display: -webkit-box;
  display: -ms-flexbox;
  display: flex;
  -webkit-box-align: center;
      -ms-flex-align: center;
          align-items: center;
  padding: 0 16px;
  font-size: 12px;
}
.l7-select-control--normal .l7-select-control-item > * + * {
  margin-left: 6px;
}
.l7-select-control--normal .l7-select-control-item input[type='checkbox'] {
  height: 14px;
  width: 14px;
}
.l7-select-control--normal .l7-select-control-item:hover {
  background-color: #f3f3f3;
}
.l7-select-control--image {
  padding: 12px 12px 0 12px;
  width: 474px;
  height: 320px;
  overflow: auto;
  display: -webkit-box;
  display: -ms-flexbox;
  display: flex;
  -ms-flex-wrap: wrap;
      flex-wrap: wrap;
  -webkit-box-sizing: border-box;
          box-sizing: border-box;
  -webkit-box-align: start;
      -ms-flex-align: start;
          align-items: flex-start;
}
.l7-select-control--image .l7-select-control-item {
  margin-right: 12px;
  border-radius: 2px;
  overflow: hidden;
  border: 1px solid #fff;
  -webkit-box-sizing: content-box;
          box-sizing: content-box;
  width: calc((100% - 36px) / 3);
  display: -webkit-box;
  display: -ms-flexbox;
  display: flex;
  -webkit-box-orient: vertical;
  -webkit-box-direction: normal;
      -ms-flex-direction: column;
          flex-direction: column;
  -webkit-box-pack: center;
      -ms-flex-pack: center;
          justify-content: center;
  margin-bottom: 12px;
  position: relative;
  font-size: 12px;
}
.l7-select-control--image .l7-select-control-item img {
  width: 142px;
  height: 80px;
}
.l7-select-control--image .l7-select-control-item input[type='checkbox'] {
  position: absolute;
  right: 0;
  top: 0;
}
.l7-select-control--image .l7-select-control-item .l7-select-control-item-row {
  display: -webkit-box;
  display: -ms-flexbox;
  display: flex;
  -webkit-box-pack: center;
      -ms-flex-pack: center;
          justify-content: center;
  -webkit-box-align: center;
      -ms-flex-align: center;
          align-items: center;
  line-height: 26px;
}
.l7-select-control--image .l7-select-control-item .l7-select-control-item-row > * + * {
  margin-left: 8px;
}
.l7-select-control--image .l7-select-control-item.l7-select-control-item-active {
  border-color: #0370fe;
}
.l7-select-control--image .l7-select-control-item:nth-child(3n) {
  margin-right: 0;
}
.l7-select-control-item {
  cursor: pointer;
}
.l7-select-control-item input[type='checkbox'] {
  margin: 0;
  cursor: pointer;
}
.l7-select-control--multiple .l7-select-control-item:hover {
  background-color: transparent;
}
.l7-control-logo {
  width: 89px;
  height: 16px;
  -webkit-user-select: none;
     -moz-user-select: none;
      -ms-user-select: none;
          user-select: none;
}
.l7-control-logo img {
  height: 100%;
  width: 100%;
}
.l7-control-logo .l7-control-logo-link {
  display: block;
  cursor: pointer;
}
.l7-control-logo .l7-control-logo-link img {
  cursor: pointer;
}
.l7-control-mouse-location {
  background-color: #fff;
  border-radius: 2px;
  -webkit-box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.15);
          box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.15);
  padding: 2px 4px;
  min-width: 130px;
}
.l7-control-zoom {
  overflow: hidden;
  border-radius: 2px;
  -webkit-box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.15);
          box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.15);
}
.l7-control-zoom .l7-button-control {
  font-size: 16px;
  border-bottom: 1px solid #f0f0f0;
  border-radius: 0;
  -webkit-box-shadow: 0 0 0;
          box-shadow: 0 0 0;
}
.l7-control-zoom .l7-button-control .l7-iconfont {
  width: 14px;
  height: 14px;
}
.l7-control-zoom .l7-button-control:last-child {
  border-bottom: 0;
}
.l7-control-zoom .l7-control-zoom__number {
  color: #595959;
  padding: 0;
}
.l7-control-zoom .l7-control-zoom__number:hover {
  background-color: #fff;
}
.l7-control-scale {
  display: -webkit-box;
  display: -ms-flexbox;
  display: flex;
  -webkit-box-orient: vertical;
  -webkit-box-direction: normal;
      -ms-flex-direction: column;
          flex-direction: column;
}
.l7-control-scale .l7-control-scale-line {
  -webkit-box-sizing: border-box;
          box-sizing: border-box;
  padding: 2px 5px 1px;
  overflow: hidden;
  color: #595959;
  font-size: 10px;
  line-height: 1.1;
  white-space: nowrap;
  background: #fff;
  border: 2px solid #000;
  border-top: 0;
  -webkit-transition: width 0.1s;
  transition: width 0.1s;
}
.l7-control-scale .l7-control-scale-line + .l7-control-scale .l7-control-scale-line {
  margin-top: -2px;
  border-top: 2px solid #777;
  border-bottom: none;
}
.l7-right .l7-control-scale {
  display: -webkit-box;
  display: -ms-flexbox;
  display: flex;
  -webkit-box-align: end;
      -ms-flex-align: end;
          align-items: flex-end;
}
.l7-right .l7-control-scale .l7-control-scale-line {
  text-align: right;
}
.l7-popup {
  position: absolute;
  top: 0;
  left: 0;
  z-index: 5;
  display: -webkit-box;
  display: -ms-flexbox;
  display: flex;
  will-change: transform;
  pointer-events: none;
}
.l7-popup.l7-popup-hide {
  display: none;
}
.l7-popup .l7-popup-content {
  position: relative;
  padding: 16px;
  font-size: 14px;
  background: #fff;
  border-radius: 3px;
  -webkit-box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
          box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
}
.l7-popup .l7-popup-content .l7-popup-content__title {
  margin-bottom: 8px;
  font-weight: bold;
}
.l7-popup .l7-popup-content .l7-popup-close-button,
.l7-popup .l7-popup-content .l7-popup-content__title,
.l7-popup .l7-popup-content .l7-popup-content__panel {
  white-space: normal;
  -webkit-user-select: text;
     -moz-user-select: text;
      -ms-user-select: text;
          user-select: text;
  pointer-events: initial;
}
.l7-popup .l7-popup-content .l7-popup-close-button {
  position: absolute;
  top: 0;
  right: 0;
  width: 18px;
  height: 18px;
  padding: 0;
  font-size: 14px;
  line-height: 18px;
  text-align: center;
  background-color: transparent;
  border: 0;
  border-radius: 0 3px 0 0;
  cursor: pointer;
}
.l7-popup .l7-popup-tip {
  position: relative;
  z-index: 1;
  width: 0;
  height: 0;
  border: 10px solid transparent;
}
.l7-popup.l7-popup-anchor-bottom,
.l7-popup.l7-popup-anchor-bottom-left,
.l7-popup.l7-popup-anchor-bottom-right {
  -webkit-box-orient: vertical;
  -webkit-box-direction: reverse;
      -ms-flex-direction: column-reverse;
          flex-direction: column-reverse;
}
.l7-popup.l7-popup-anchor-bottom .l7-popup-tip,
.l7-popup.l7-popup-anchor-bottom-left .l7-popup-tip,
.l7-popup.l7-popup-anchor-bottom-right .l7-popup-tip {
  bottom: 1px;
}
.l7-popup.l7-popup-anchor-top,
.l7-popup.l7-popup-anchor-top-left,
.l7-popup.l7-popup-anchor-top-right {
  -webkit-box-orient: vertical;
  -webkit-box-direction: normal;
      -ms-flex-direction: column;
          flex-direction: column;
}
.l7-popup.l7-popup-anchor-top .l7-popup-tip,
.l7-popup.l7-popup-anchor-top-left .l7-popup-tip,
.l7-popup.l7-popup-anchor-top-right .l7-popup-tip {
  top: 1px;
}
.l7-popup.l7-popup-anchor-left {
  -webkit-box-orient: horizontal;
  -webkit-box-direction: normal;
      -ms-flex-direction: row;
          flex-direction: row;
}
.l7-popup.l7-popup-anchor-right {
  -webkit-box-orient: horizontal;
  -webkit-box-direction: reverse;
      -ms-flex-direction: row-reverse;
          flex-direction: row-reverse;
}
.l7-popup-anchor-top .l7-popup-tip {
  position: relative;
  -webkit-align-self: center;
  -ms-flex-item-align: center;
      align-self: center;
  border-top: none;
  border-bottom-color: #fff;
}
.l7-popup-anchor-top-left .l7-popup-tip {
  -webkit-align-self: flex-start;
  -ms-flex-item-align: start;
      align-self: flex-start;
  border-top: none;
  border-bottom-color: #fff;
  border-left: none;
}
.l7-popup-anchor-top-right .l7-popup-tip {
  -webkit-align-self: flex-end;
  -ms-flex-item-align: end;
      align-self: flex-end;
  border-top: none;
  border-right: none;
  border-bottom-color: #fff;
}
.l7-popup-anchor-bottom .l7-popup-tip {
  -webkit-align-self: center;
  -ms-flex-item-align: center;
      align-self: center;
  border-top-color: #fff;
  border-bottom: none;
}
.l7-popup-anchor-bottom-left .l7-popup-tip {
  -webkit-align-self: flex-start;
  -ms-flex-item-align: start;
      align-self: flex-start;
  border-top-color: #fff;
  border-bottom: none;
  border-left: none;
}
.l7-popup-anchor-bottom-right .l7-popup-tip {
  -webkit-align-self: flex-end;
  -ms-flex-item-align: end;
      align-self: flex-end;
  border-top-color: #fff;
  border-right: none;
  border-bottom: none;
}
.l7-popup-anchor-left .l7-popup-tip {
  -webkit-align-self: center;
  -ms-flex-item-align: center;
      align-self: center;
  border-right-color: #fff;
  border-left: none;
}
.l7-popup-anchor-right .l7-popup-tip {
  right: 1px;
  -webkit-align-self: center;
  -ms-flex-item-align: center;
      align-self: center;
  border-right: none;
  border-left-color: #fff;
}
.l7-popup-anchor-top-left .l7-popup-content {
  border-top-left-radius: 0;
}
.l7-popup-anchor-top-right .l7-popup-content {
  border-top-right-radius: 0;
}
.l7-popup-anchor-bottom-left .l7-popup-content {
  border-bottom-left-radius: 0;
}
.l7-popup-anchor-bottom-right .l7-popup-content {
  border-bottom-right-radius: 0;
}
.l7-popup-track-pointer {
  display: none;
}
.l7-popup-track-pointer * {
  -webkit-user-select: none;
     -moz-user-select: none;
      -ms-user-select: none;
          user-select: none;
  pointer-events: none;
}
.l7-map:hover .l7-popup-track-pointer {
  display: -webkit-box;
  display: -ms-flexbox;
  display: flex;
}
.l7-map:active .l7-popup-track-pointer {
  display: none;
}
.l7-layer-popup__row {
  font-size: 12px;
}
.l7-layer-popup__row + .l7-layer-popup__row {
  margin-top: 4px;
}
`);var k0,Py=(k0={},(0,Ce.Z)(k0,Af.additive,{enable:!0,func:{srcRGB:Ge.ONE,dstRGB:Ge.ONE,srcAlpha:1,dstAlpha:1}}),(0,Ce.Z)(k0,Af.none,{enable:!1}),(0,Ce.Z)(k0,Af.normal,{enable:!0,func:{srcRGB:Ge.SRC_ALPHA,dstRGB:Ge.ONE_MINUS_SRC_ALPHA,srcAlpha:1,dstAlpha:1}}),(0,Ce.Z)(k0,Af.subtractive,{enable:!0,func:{srcRGB:Ge.ONE,dstRGB:Ge.ONE,srcAlpha:Ge.ZERO,dstAlpha:Ge.ONE_MINUS_SRC_COLOR},equation:{rgb:Ge.FUNC_SUBTRACT,alpha:Ge.FUNC_SUBTRACT}}),(0,Ce.Z)(k0,Af.max,{enable:!0,func:{srcRGB:Ge.ONE,dstRGB:Ge.ONE},equation:{rgb:Ge.MAX_EXT}}),(0,Ce.Z)(k0,Af.min,{enable:!0,func:{srcRGB:Ge.ONE,dstRGB:Ge.ONE},equation:{rgb:Ge.MIN_EXT}}),k0);function Oy(e){return e.map(function(i){return typeof i=="string"&&(i=[i,{}]),i})}function Ry(e,i,t,r){var n=e.multiPassRenderer,a=e.getLayerConfig(),u=a.enableTAA;return u?n.add(r("taa")):n.add(r("render")),Oy(i).forEach(function(f){var g=(0,vn.Z)(f,2),x=g[0],I=g[1];n.add(t(x),I)}),n.add(t("copy")),n}var Ob=function(){function e(i){(0,ue.Z)(this,e),this.layer=i}return(0,me.Z)(e,[{key:"pickRender",value:function(t){var r=this.layer.getContainer(),n=r.get(Xt.ILayerService),a=this.layer;if(a.tileLayer)return a.tileLayer.pickRender(t);a.hooks.beforePickingEncode.call(),n.renderTileLayerMask(a),a.renderModels({ispick:!0}),a.hooks.afterPickingEncode.call()}},{key:"pick",value:function(t,r){var n=this.layer.getContainer(),a=n.get(Xt.IPickingService);return t.type==="RasterLayer"?this.pickRasterLayer(t,r):(this.pickRender(r),a.pickFromPickingFBO(t,r))}},{key:"pickRasterLayer",value:function(t,r,n){var a=this.layer.getContainer(),u=a.get(Xt.IPickingService),f=a.get(Xt.IMapService),g=this.layer.getSource().extent,x=ml(r.lngLat,g),I={x:r.x,y:r.y,type:r.type,lngLat:r.lngLat,target:r,rasterValue:null},O=n||t;if(x){var B=this.readRasterValue(t,g,f,r.x,r.y);return I.rasterValue=B,u.triggerHoverOnLayer(O,I),!0}else return I.type=r.type==="mousemove"?"mouseout":"un"+r.type,u.triggerHoverOnLayer(O,(0,X.Z)((0,X.Z)({},I),{},{type:"unpick"})),u.triggerHoverOnLayer(O,I),!1}},{key:"readRasterValue",value:function(t,r,n,a,u){var f=t.getSource().data.dataArray[0],g=(0,vn.Z)(r,4),x=g[0],I=x===void 0?0:x,O=g[1],B=O===void 0?0:O,W=g[2],he=W===void 0?10:W,ae=g[3],Se=ae===void 0?-10:ae,Fe=n.lngLatToContainer([I,B]),Qe=n.lngLatToContainer([he,Se]),qe=Qe.x-Fe.x,yt=Fe.y-Qe.y,Et=[(a-Fe.x)/qe,(u-Qe.y)/yt],Ot=f.width||1,jt=f.height||1,or=Math.floor(Et[0]*Ot),ar=Math.floor(Et[1]*jt),br=Math.max(0,ar-1)*Ot+or,pr=f.data[br];return pr}},{key:"selectFeature",value:function(t){var r=this.layer,n=(0,vn.Z)(t,3),a=n[0],u=n[1],f=n[2];r.hooks.beforeSelect.call([a,u,f])}},{key:"highlightPickedFeature",value:function(t){var r=(0,vn.Z)(t,3),n=r[0],a=r[1],u=r[2];this.layer.hooks.beforeHighlight.call([n,a,u])}},{key:"getFeatureById",value:function(t){return this.layer.getSource().getFeatureById(t)}}]),e}(),Rb=function(){function e(i){(0,ue.Z)(this,e),this.layer=i;var t=this.layer.getContainer();this.rendererService=t.get(Xt.IRendererService)}return(0,me.Z)(e,[{key:"getColorTexture",value:function(t,r){var n=this.getTextureKey(t,r);return this.key===n?this.colorTexture:(this.createColorTexture(t,r),this.key=n,this.colorTexture)}},{key:"createColorTexture",value:function(t,r){var n=this.rendererService.createTexture2D,a=this.getColorRampBar(t,r),u=n({data:new Uint8Array(a.data),width:a.width,height:a.height,flipY:!1});return this.colorTexture=u,u}},{key:"setColorTexture",value:function(t,r,n){this.key=this.getTextureKey(r,n),this.colorTexture=t}},{key:"destroy",value:function(){var t;(t=this.colorTexture)===null||t===void 0||t.destroy()}},{key:"getColorRampBar",value:function(t,r){switch(t.type){case"cat":return Sa(t);case"quantize":return ya(t);case"custom":return Ku(t,r);case"linear":return Ru(t,r);default:return Wo(t)}}},{key:"getTextureKey",value:function(t,r){var n;return"".concat(t.colors.join("_"),"_").concat(t==null||(n=t.positions)===null||n===void 0?void 0:n.join("_"),"_").concat(t.type,"_").concat(r==null?void 0:r.join("_"))}}]),e}(),kb=["passes"],Db=["moduleName","vertexShader","fragmentShader","inject","triangulation","segmentNumber"],ky,ig,Dy;function Nb(e,i){var t=typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=Fb(e))||i&&e&&typeof e.length=="number"){t&&(e=t);var r=0,n=function(){};return{s:n,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(x){throw x},f:n}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var a=!0,u=!1,f;return{s:function(){t=t.call(e)},n:function(){var x=t.next();return a=x.done,x},e:function(x){u=!0,f=x},f:function(){try{!a&&t.return!=null&&t.return()}finally{if(u)throw f}}}}function Fb(e,i){if(e){if(typeof e=="string")return Ny(e,i);var t=Object.prototype.toString.call(e).slice(8,-1);if(t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set")return Array.from(e);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return Ny(e,i)}}function Ny(e,i){(i==null||i>e.length)&&(i=e.length);for(var t=0,r=new Array(i);t<i;t++)r[t]=e[t];return r}function Bb(e){var i=Zb();return function(){var r=(0,oe.Z)(e),n;if(i){var a=(0,oe.Z)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return(0,Ze.Z)(this,n)}}function Zb(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var ag=In.isEqual,Fy=In.isFunction,By=In.isNumber,Xu=In.isObject,zb=In.isPlainObject,Ub=In.isUndefined,Zy=0,nA=(ky=tg(Xt.IGlobalConfigService),ig=function(e){(0,ke.Z)(t,e);var i=Bb(t);function t(){var r,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return(0,ue.Z)(this,t),r=i.call(this),(0,Ce.Z)((0,bt.Z)(r),"id","".concat(Zy++)),(0,Ce.Z)((0,bt.Z)(r),"name","".concat(Zy)),(0,Ce.Z)((0,bt.Z)(r),"visible",!0),(0,Ce.Z)((0,bt.Z)(r),"zIndex",0),(0,Ce.Z)((0,bt.Z)(r),"inited",!1),(0,Ce.Z)((0,bt.Z)(r),"layerModelNeedUpdate",!1),(0,Ce.Z)((0,bt.Z)(r),"pickedFeatureID",null),(0,Ce.Z)((0,bt.Z)(r),"selectedFeatureID",null),(0,Ce.Z)((0,bt.Z)(r),"styleNeedUpdate",!1),(0,Ce.Z)((0,bt.Z)(r),"forceRender",!1),(0,Ce.Z)((0,bt.Z)(r),"clusterZoom",0),(0,Ce.Z)((0,bt.Z)(r),"defaultSourceConfig",{data:[],options:{parser:{type:"json"}}}),(0,Ce.Z)((0,bt.Z)(r),"dataState",{dataSourceNeedUpdate:!1,dataMappingNeedUpdate:!1,filterNeedUpdate:!1,featureScaleNeedUpdate:!1,StyleAttrNeedUpdate:!1}),(0,Ce.Z)((0,bt.Z)(r),"hooks",{init:new _m,afterInit:new $v,beforeRender:new $v,beforeRenderData:new l,afterRender:new Uc,beforePickingEncode:new Uc,afterPickingEncode:new Uc,beforeHighlight:new Uc(["pickedColor"]),afterHighlight:new Uc,beforeSelect:new Uc(["pickedColor"]),afterSelect:new Uc,beforeDestroy:new Uc,afterDestroy:new Uc}),(0,Ce.Z)((0,bt.Z)(r),"models",[]),(0,Ce.Z)((0,bt.Z)(r),"startInit",!1),(0,Ce.Z)((0,bt.Z)(r),"layerChildren",[]),(0,Ce.Z)((0,bt.Z)(r),"masks",[]),Ki((0,bt.Z)(r),"configService",Dy,(0,bt.Z)(r)),(0,Ce.Z)((0,bt.Z)(r),"animateOptions",{enable:!1}),(0,Ce.Z)((0,bt.Z)(r),"currentPickId",null),(0,Ce.Z)((0,bt.Z)(r),"encodeStyleAttribute",{}),(0,Ce.Z)((0,bt.Z)(r),"enableShaderEncodeStyles",[]),(0,Ce.Z)((0,bt.Z)(r),"enableDataEncodeStyles",[]),(0,Ce.Z)((0,bt.Z)(r),"enablg",[]),(0,Ce.Z)((0,bt.Z)(r),"pendingStyleAttributes",[]),(0,Ce.Z)((0,bt.Z)(r),"scaleOptions",{}),(0,Ce.Z)((0,bt.Z)(r),"animateStatus",!1),(0,Ce.Z)((0,bt.Z)(r),"isDestroyed",!1),(0,Ce.Z)((0,bt.Z)(r),"encodeDataLength",0),(0,Ce.Z)((0,bt.Z)(r),"sourceEvent",function(){r.dataState.dataSourceNeedUpdate=!0;var a=r.getLayerConfig();a&&a.autoFit&&r.fitBounds(a.fitBoundsOptions);var u=r.layerSource.getSourceCfg().autoRender;u&&r.reRender()}),r.name=n.name||r.id,r.zIndex=n.zIndex||0,r.rawConfig=n,r}return(0,me.Z)(t,[{key:"addMask",value:function(n){this.masks.push(n),this.enableMask()}},{key:"removeMask",value:function(n){var a=this.masks.indexOf(n);a>-1&&this.masks.splice(a,1)}},{key:"disableMask",value:function(){this.updateLayerConfig({enableMask:!1})}},{key:"enableMask",value:function(){this.updateLayerConfig({enableMask:!0})}},{key:"addMaskLayer",value:function(n){this.masks.push(n)}},{key:"removeMaskLayer",value:function(n){var a=this.masks.indexOf(n);a>-1&&this.masks.splice(a,1),n.destroy()}},{key:"getAttribute",value:function(n){return this.styleAttributeService.getLayerStyleAttribute(n)}},{key:"getLayerConfig",value:function(){return this.configService.getLayerConfig(this.id)}},{key:"updateLayerConfig",value:function(n){var a=this;if(Object.keys(n).map(function(f){f in a.rawConfig&&(a.rawConfig[f]=n[f])}),!this.startInit)this.needUpdateConfig=(0,X.Z)((0,X.Z)({},this.needUpdateConfig),n);else{var u=this.container.get(Xt.SceneID);this.configService.setLayerConfig(u,this.id,(0,X.Z)((0,X.Z)((0,X.Z)({},this.configService.getLayerConfig(this.id)),this.needUpdateConfig),n)),this.needUpdateConfig={}}}},{key:"setContainer",value:function(n,a){this.container=n,this.sceneContainer=a}},{key:"getContainer",value:function(){return this.container}},{key:"addPlugin",value:function(n){return this.plugins.push(n),this}},{key:"init",value:function(){var r=(0,ur.Z)(nt().mark(function a(){var u=this,f,g,x,I,O,B,W;return nt().wrap(function(ae){for(;;)switch(ae.prev=ae.next){case 0:f=this.container.get(Xt.SceneID),this.startInit=!0,this.configService.setLayerConfig(f,this.id,this.rawConfig),this.layerType=this.rawConfig.layerType,this.iconService=this.container.get(Xt.IIconService),this.fontService=this.container.get(Xt.IFontService),this.rendererService=this.container.get(Xt.IRendererService),this.layerService=this.container.get(Xt.ILayerService),this.debugService=this.container.get(Xt.IDebugService),this.interactionService=this.container.get(Xt.IInteractionService),this.pickingService=this.container.get(Xt.IPickingService),this.mapService=this.container.get(Xt.IMapService),g=this.getLayerConfig(),x=g.enableMultiPassRenderer,I=g.passes,x&&I!==null&&I!==void 0&&I.length&&I.length>0&&this.mapService.on("mapAfterFrameChange",function(){u.renderLayers()}),this.cameraService=this.container.get(Xt.ICameraService),this.coordinateService=this.container.get(Xt.ICoordinateSystemService),this.shaderModuleService=this.container.get(Xt.IShaderModuleService),this.postProcessingPassFactory=this.container.get(Xt.IFactoryPostProcessingPass),this.normalPassFactory=this.container.get(Xt.IFactoryNormalPass),this.styleAttributeService=this.container.get(Xt.IStyleAttributeService),x&&(this.multiPassRenderer=this.container.get(Xt.IMultiPassRenderer),this.multiPassRenderer.setLayer(this)),this.pendingStyleAttributes.forEach(function(Se){var Fe=Se.attributeName,Qe=Se.attributeField,qe=Se.attributeValues,yt=Se.updateOptions;u.styleAttributeService.updateStyleAttribute(Fe,{scale:(0,X.Z)({field:Qe},u.splitValuesAndCallbackInAttribute(qe,Qe?void 0:u.getLayerConfig()[Fe]))},yt)}),this.pendingStyleAttributes=[],this.plugins=this.container.getAll(Xt.ILayerPlugin),O=Nb(this.plugins);try{for(O.s();!(B=O.n()).done;)W=B.value,W.apply(this,{rendererService:this.rendererService,mapService:this.mapService,styleAttributeService:this.styleAttributeService,normalPassFactory:this.normalPassFactory,postProcessingPassFactory:this.postProcessingPassFactory})}catch(Se){O.e(Se)}finally{O.f()}return this.layerPickService=new Ob(this),this.textureService=new Rb(this),this.log(Ks.LayerInitStart),ae.next=31,this.hooks.init.promise();case 31:this.log(Ks.LayerInitEnd),this.inited=!0,this.emit("inited",{target:this,type:"inited"}),this.emit("add",{target:this,type:"add"}),this.hooks.afterInit.call();case 36:case"end":return ae.stop()}},a,this)}));function n(){return r.apply(this,arguments)}return n}()},{key:"log",value:function(n){var a,u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"init";if(!(this.tileLayer||this.isTileLayer)){var f="".concat(this.id,".").concat(u,".").concat(n),g={id:this.id,type:this.type};(a=this.debugService)===null||a===void 0||a.log(f,g)}}},{key:"updateModelData",value:function(n){n.attributes&&n.elements?this.models.map(function(a){a.updateAttributesAndElements(n.attributes,n.elements)}):console.warn("data error")}},{key:"setLayerPickService",value:function(n){this.layerPickService=n}},{key:"prepareBuildModel",value:function(){Object.keys(this.needUpdateConfig||{}).length!==0&&this.updateLayerConfig({});var n=this.getLayerConfig(),a=n.animateOption;a!=null&&a.enable&&(this.layerService.startAnimate(),this.animateStatus=!0)}},{key:"color",value:function(n,a,u){return this.updateStyleAttribute("color",n,a,u),this}},{key:"texture",value:function(n,a,u){return this.updateStyleAttribute("texture",n,a,u),this}},{key:"rotate",value:function(n,a,u){return this.updateStyleAttribute("rotate",n,a,u),this}},{key:"size",value:function(n,a,u){return this.updateStyleAttribute("size",n,a,u),this}},{key:"filter",value:function(n,a,u){var f=this.updateStyleAttribute("filter",n,a,u);return this.dataState.dataSourceNeedUpdate=f&&this.inited,this}},{key:"shape",value:function(n,a,u){this.shapeOption={field:n,values:a};var f=this.updateStyleAttribute("shape",n,a,u);return this.dataState.dataSourceNeedUpdate=f&&this.inited,this}},{key:"label",value:function(n,a,u){return this.pendingStyleAttributes.push({attributeName:"label",attributeField:n,attributeValues:a,updateOptions:u}),this}},{key:"animate",value:function(n){var a={};return Xu(n)?(a.enable=!0,a=(0,X.Z)((0,X.Z)({},a),n)):a.enable=n,this.updateLayerConfig({animateOption:a}),this}},{key:"source",value:function(n,a){return(n==null?void 0:n.type)==="source"?(this.setSource(n),this):(this.sourceOption={data:n,options:a},this.clusterZoom=0,this)}},{key:"setData",value:function(n,a){var u=this;return this.inited?(this.log(Ks.SourceInitStart,cs.UPDATE),this.layerSource.setData(n,a),this.log(Ks.SourceInitEnd,cs.UPDATE)):this.on("inited",function(){u.log(Ks.SourceInitStart,cs.UPDATE);var f=u.getSource();f?u.layerSource.setData(n,a):u.source(new wy(n,a)),u.layerSource.once("update",function(){u.log(Ks.SourceInitEnd,cs.UPDATE)})}),this}},{key:"style",value:function(n){var a=this,u=n.passes,f=(0,hc.Z)(n,kb);u&&Oy(u).forEach(function(x){var I=a.multiPassRenderer.getPostProcessor().getPostProcessingPassByName(x[0]);I&&I.updateOptions(x[1])}),f.borderColor&&(f.stroke=f.borderColor),f.borderWidth&&(f.strokeWidth=f.borderWidth);var g=f;return Object.keys(f).forEach(function(x){var I=f[x];Array.isArray(I)&&I.length===2&&!By(I[0])&&!By(I[1])&&(g[x]={field:I[0],value:I[1]})}),this.encodeStyle(g),this.updateLayerConfig(g),this}},{key:"encodeStyle",value:function(n){var a=this;Object.keys(n).forEach(function(u){[].concat((0,Mr.Z)(a.enableShaderEncodeStyles),(0,Mr.Z)(a.enableDataEncodeStyles)).includes(u)&&zb(n[u])&&(n[u].field||n[u].value)&&!ag(a.encodeStyleAttribute[u],n[u])?(a.encodeStyleAttribute[u]=n[u],a.updateStyleAttribute(u,n[u].field,n[u].value),a.inited&&(a.dataState.dataMappingNeedUpdate=!0)):a.encodeStyleAttribute[u]&&(delete a.encodeStyleAttribute[u],a.dataState.dataSourceNeedUpdate=!0)})}},{key:"scale",value:function(n,a){var u=(0,X.Z)({},this.scaleOptions);if(Xu(n)?this.scaleOptions=(0,X.Z)((0,X.Z)({},this.scaleOptions),n):this.scaleOptions[n]=a,this.styleAttributeService&&!ag(u,this.scaleOptions)){var f=Xu(n)?n:(0,Ce.Z)({},n,a);this.styleAttributeService.updateScaleAttribute(f)}return this}},{key:"renderLayers",value:function(){this.rendering=!0,this.layerService.reRender(),this.rendering=!1}},{key:"render",value:function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.tileLayer?(this.tileLayer.render(),this):(this.layerService.beforeRenderData(this),this.encodeDataLength<=0&&!this.forceRender?this:(this.renderModels(n),this))}},{key:"renderMultiPass",value:function(){var r=(0,ur.Z)(nt().mark(function a(){return nt().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:if(!(this.encodeDataLength<=0&&!this.forceRender)){f.next=2;break}return f.abrupt("return");case 2:if(!(this.multiPassRenderer&&this.multiPassRenderer.getRenderFlag())){f.next=7;break}return f.next=5,this.multiPassRenderer.render();case 5:f.next=8;break;case 7:this.multiPassRenderer?this.renderModels():this.renderModels();case 8:case"end":return f.stop()}},a,this)}));function n(){return r.apply(this,arguments)}return n}()},{key:"active",value:function(n){var a={};return a.enableHighlight=Xu(n)?!0:n,Xu(n)?(a.enableHighlight=!0,n.color&&(a.highlightColor=n.color),n.mix&&(a.activeMix=n.mix)):a.enableHighlight=!!n,this.updateLayerConfig(a),this}},{key:"setActive",value:function(n,a){var u=this;if(Xu(n)){var f=n.x,g=f===void 0?0:f,x=n.y,I=x===void 0?0:x;this.updateLayerConfig({highlightColor:Xu(a)?a.color:this.getLayerConfig().highlightColor,activeMix:Xu(a)?a.mix:this.getLayerConfig().activeMix}),this.pick({x:g,y:I})}else this.updateLayerConfig({pickedFeatureID:n,highlightColor:Xu(a)?a.color:this.getLayerConfig().highlightColor,activeMix:Xu(a)?a.mix:this.getLayerConfig().activeMix}),this.hooks.beforeHighlight.call(bs(n)).then(function(){setTimeout(function(){u.reRender()},1)})}},{key:"select",value:function(n){var a={};return a.enableSelect=Xu(n)?!0:n,Xu(n)?(a.enableSelect=!0,n.color&&(a.selectColor=n.color),n.mix&&(a.selectMix=n.mix)):a.enableSelect=!!n,this.updateLayerConfig(a),this}},{key:"setSelect",value:function(n,a){var u=this;if(Xu(n)){var f=n.x,g=f===void 0?0:f,x=n.y,I=x===void 0?0:x;this.updateLayerConfig({selectColor:Xu(a)?a.color:this.getLayerConfig().selectColor,selectMix:Xu(a)?a.mix:this.getLayerConfig().selectMix}),this.pick({x:g,y:I})}else this.updateLayerConfig({pickedFeatureID:n,selectColor:Xu(a)?a.color:this.getLayerConfig().selectColor,selectMix:Xu(a)?a.mix:this.getLayerConfig().selectMix}),this.hooks.beforeSelect.call(bs(n)).then(function(){setTimeout(function(){u.reRender()},1)})}},{key:"setBlend",value:function(n){return this.updateLayerConfig({blend:n}),this.reRender(),this}},{key:"show",value:function(){return this.updateLayerConfig({visible:!0}),this.reRender(),this.emit("show"),this}},{key:"hide",value:function(){return this.updateLayerConfig({visible:!1}),this.reRender(),this.emit("hide"),this}},{key:"setIndex",value:function(n){return this.zIndex=n,this.layerService.updateLayerRenderList(),this.layerService.renderLayers(),this}},{key:"setCurrentPickId",value:function(n){this.currentPickId=n}},{key:"getCurrentPickId",value:function(){return this.currentPickId}},{key:"setCurrentSelectedId",value:function(n){this.selectedFeatureID=n}},{key:"getCurrentSelectedId",value:function(){return this.selectedFeatureID}},{key:"isVisible",value:function(){var n=this.mapService.getZoom(),a=this.getLayerConfig(),u=a.visible,f=a.minZoom,g=f===void 0?-1/0:f,x=a.maxZoom,I=x===void 0?1/0:x;return!!u&&n>=g&&n<I}},{key:"setMultiPass",value:function(n,a){if(this.updateLayerConfig({enableMultiPassRenderer:n}),a&&this.updateLayerConfig({passes:a}),n){var u=this.getLayerConfig(),f=u.passes,g=f===void 0?[]:f;this.multiPassRenderer=Ry(this,g,this.postProcessingPassFactory,this.normalPassFactory),this.multiPassRenderer.setRenderFlag(!0);var x=this.rendererService.getViewportSize(),I=x.width,O=x.height;this.multiPassRenderer.resize(I,O)}return this}},{key:"setMinZoom",value:function(n){return this.updateLayerConfig({minZoom:n}),this}},{key:"getMinZoom",value:function(){var n=this.getLayerConfig(),a=n.minZoom;return a}},{key:"getMaxZoom",value:function(){var n=this.getLayerConfig(),a=n.maxZoom;return a}},{key:"get",value:function(n){var a=this.getLayerConfig();return a[n]}},{key:"setMaxZoom",value:function(n){return this.updateLayerConfig({maxZoom:n}),this}},{key:"setAutoFit",value:function(n){return this.updateLayerConfig({autoFit:n}),this}},{key:"fitBounds",value:function(n){if(!this.inited)return this.updateLayerConfig({autoFit:!0}),this;var a=this.getSource(),u=a.extent,f=u.some(function(g){return Math.abs(g)===1/0});return f?this:(this.mapService.fitBounds([[u[0],u[1]],[u[2],u[3]]],n),this)}},{key:"destroy",value:function(){var n,a,u,f,g=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(!this.isDestroyed){this.layerChildren.map(function(O){return O.destroy(!1)}),this.layerChildren=[];var x=this.getLayerConfig(),I=x.maskfence;I&&(this.masks.map(function(O){return O.destroy(!1)}),this.masks=[]),this.hooks.beforeDestroy.call(),this.layerSource.off("update",this.sourceEvent),(n=this.multiPassRenderer)===null||n===void 0||n.destroy(),this.textureService.destroy(),this.styleAttributeService.clearAllAttributes(),this.hooks.afterDestroy.call(),(a=this.layerModel)===null||a===void 0||a.clearModels(g),(u=this.tileLayer)===null||u===void 0||u.destroy(),this.models=[],(f=this.debugService)===null||f===void 0||f.removeLog(this.id),this.emit("remove",{target:this,type:"remove"}),this.emit("destroy",{target:this,type:"destroy"}),this.removeAllListeners(),this.isDestroyed=!0}}},{key:"clear",value:function(){this.styleAttributeService.clearAllAttributes()}},{key:"clearModels",value:function(){var n;this.models.forEach(function(a){return a.destroy()}),(n=this.layerModel)===null||n===void 0||n.clearModels(),this.models=[]}},{key:"isDirty",value:function(){return!!(this.styleAttributeService.getLayerStyleAttributes()||[]).filter(function(n){return n.needRescale||n.needRemapping||n.needRegenerateVertices}).length}},{key:"setSource",value:function(n){var a=this;if(this.layerSource&&this.layerSource.off("update",this.sourceEvent),this.layerSource=n,this.clusterZoom=0,this.inited&&this.layerSource.cluster){var u=this.mapService.getZoom();this.layerSource.updateClusterData(u)}this.layerSource.inited&&this.sourceEvent(),this.layerSource.on("update",function(f){var g=f.type;if(a.coordCenter===void 0){var x,I=a.layerSource.center;a.coordCenter=I,(x=a.mapService)!==null&&x!==void 0&&x.setCoordCenter&&a.mapService.setCoordCenter(I)}if(g==="update"){if(a.tileLayer){a.tileLayer.reload();return}a.sourceEvent()}})}},{key:"getSource",value:function(){return this.layerSource}},{key:"getScaleOptions",value:function(){return this.scaleOptions}},{key:"setEncodedData",value:function(n){this.encodedData=n,this.encodeDataLength=n.length}},{key:"getEncodedData",value:function(){return this.encodedData}},{key:"getScale",value:function(n){return this.styleAttributeService.getLayerAttributeScale(n)}},{key:"getLegend",value:function(n){var a,u,f,g=this.styleAttributeService.getLayerStyleAttribute(n),x=(g==null||(a=g.scale)===null||a===void 0?void 0:a.scalers)||[];return{type:(u=x[0].option)===null||u===void 0?void 0:u.type,field:g==null||(f=g.scale)===null||f===void 0?void 0:f.field,items:this.getLegendItems(n)}}},{key:"getLegendItems",value:function(n){var a=this.styleAttributeService.getLayerAttributeScale(n);if(!a)return[];if(a.invertExtent){var u=a.range().map(function(x){return(0,Ce.Z)({value:a.invertExtent(x)},n,x)});return u}else if(a.ticks){var f=a.ticks().map(function(x){return(0,Ce.Z)({value:x},n,a(x))});return f}else if(a!=null&&a.domain){var g=a.domain().filter(function(x){return!Ub(x)}).map(function(x){return(0,Ce.Z)({value:x},n,a(x))});return g}return[]}},{key:"pick",value:function(n){var a=n.x,u=n.y;this.interactionService.triggerHover({x:a,y:u})}},{key:"boxSelect",value:function(n,a){this.pickingService.boxPickLayer(this,n,a)}},{key:"buildLayerModel",value:function(){var r=(0,ur.Z)(nt().mark(function a(u){var f=this,g,x,I,O,B,W,he,ae,Se,Fe,Qe,qe;return nt().wrap(function(Et){for(;;)switch(Et.prev=Et.next){case 0:return g=u.moduleName,x=u.vertexShader,I=u.fragmentShader,O=u.inject,B=u.triangulation,W=u.segmentNumber,he=(0,hc.Z)(u,Db),this.shaderModuleService.registerModule(g,{vs:x,fs:I,inject:O}),ae=this.shaderModuleService.getModule(g),Se=ae.vs,Fe=ae.fs,Qe=ae.uniforms,qe=this.rendererService.createModel,Et.abrupt("return",new Promise(function(Ot){var jt=f.styleAttributeService.createAttributesAndIndices(f.encodedData,B,W),or=jt.attributes,ar=jt.elements,br=jt.count,pr=(0,X.Z)({attributes:or,uniforms:Qe,fs:Fe,vs:Se,elements:ar,blend:Py[Af.normal]},he);br&&(pr.count=br);var jr=qe(pr);Ot(jr)}));case 5:case"end":return Et.stop()}},a,this)}));function n(a){return r.apply(this,arguments)}return n}()},{key:"createAttributes",value:function(n){var a=n.triangulation,u=this.styleAttributeService.createAttributes(this.encodedData,a),f=u.attributes;return f}},{key:"getTime",value:function(){return this.layerService.clock.getDelta()}},{key:"setAnimateStartTime",value:function(){this.animateStartTime=this.layerService.clock.getElapsedTime()}},{key:"stopAnimate",value:function(){this.animateStatus&&(this.layerService.stopAnimate(),this.animateStatus=!1,this.updateLayerConfig({animateOption:{enable:!1}}))}},{key:"getLayerAnimateTime",value:function(){return this.layerService.clock.getElapsedTime()-this.animateStartTime}},{key:"needPick",value:function(n){var a=this.getLayerConfig(),u=a.enableHighlight,f=u===void 0?!0:u,g=a.enableSelect,x=g===void 0?!0:g,I=this.eventNames().indexOf(n)!==-1||this.eventNames().indexOf("un"+n)!==-1;return(n==="click"||n==="dblclick")&&x&&(I=!0),n==="mousemove"&&(f||this.eventNames().indexOf("mouseenter")!==-1||this.eventNames().indexOf("unmousemove")!==-1||this.eventNames().indexOf("mouseout")!==-1)&&(I=!0),this.isVisible()&&I}},{key:"buildModels",value:function(){var r=(0,ur.Z)(nt().mark(function a(){return nt().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:throw new Error("Method not implemented.");case 1:case"end":return f.stop()}},a)}));function n(){return r.apply(this,arguments)}return n}()},{key:"rebuildModels",value:function(){var r=(0,ur.Z)(nt().mark(function a(){return nt().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return f.next=2,this.buildModels();case 2:case"end":return f.stop()}},a,this)}));function n(){return r.apply(this,arguments)}return n}()},{key:"renderMulPass",value:function(){var r=(0,ur.Z)(nt().mark(function a(u){return nt().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return g.next=2,u.render();case 2:case"end":return g.stop()}},a)}));function n(a){return r.apply(this,arguments)}return n}()},{key:"renderModels",value:function(){var n=this,a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.encodeDataLength<=0&&!this.forceRender?(this.clearModels(),this):(this.hooks.beforeRender.call(),this.models.forEach(function(u){u.draw({uniforms:n.layerModel.getUninforms(),blend:n.layerModel.getBlend(),stencil:n.layerModel.getStencil(a)},(a==null?void 0:a.ispick)||!1)}),this.hooks.afterRender.call(),this)}},{key:"updateStyleAttribute",value:function(n,a,u,f){var g=this.configService.getAttributeConfig(this.id)||{};return ag(g[n],{field:a,values:u})?!1:(["color","size","texture","rotate","filter","label","shape"].indexOf(n)!==-1&&this.configService.setAttributeConfig(this.id,(0,Ce.Z)({},n,{field:a,values:u})),this.startInit?this.styleAttributeService.updateStyleAttribute(n,{scale:(0,X.Z)({field:a},this.splitValuesAndCallbackInAttribute(u,this.getLayerConfig()[a]))},f):this.pendingStyleAttributes.push({attributeName:n,attributeField:a,attributeValues:u,updateOptions:f}),!0)}},{key:"getLayerAttributeConfig",value:function(){return this.configService.getAttributeConfig(this.id)}},{key:"getShaderPickStat",value:function(){return this.layerService.getShaderPickStat()}},{key:"setEarthTime",value:function(n){console.warn("empty fn")}},{key:"processData",value:function(n){return n}},{key:"getModelType",value:function(){throw new Error("Method not implemented.")}},{key:"getDefaultConfig",value:function(){return{}}},{key:"initLayerModels",value:function(){var r=(0,ur.Z)(nt().mark(function a(){return nt().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return this.models.forEach(function(g){return g.destroy()}),this.models=[],f.next=4,this.layerModel.initModels();case 4:this.models=f.sent;case 5:case"end":return f.stop()}},a,this)}));function n(){return r.apply(this,arguments)}return n}()},{key:"reRender",value:function(){this.inited&&this.layerService.reRender()}},{key:"splitValuesAndCallbackInAttribute",value:function(n){return{values:Fy(n)?void 0:n,callback:Fy(n)?n:void 0}}}]),t}(xa.EventEmitter),Dy=Hi(ig.prototype,"configService",[ky],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ig);function Gb(e,i){return{enable:e,mask:255,func:{cmp:Ge.EQUAL,ref:i?1:0,mask:1}}}function zy(e){return e.maskOperation===kh.OR?{enable:!0,mask:255,func:{cmp:Ge.ALWAYS,ref:1,mask:255},opFront:{fail:Ge.KEEP,zfail:Ge.REPLACE,zpass:Ge.REPLACE}}:{enable:!0,mask:255,func:{cmp:e.stencilType===x0.SINGLE||e.stencilIndex===0?Ge.ALWAYS:Ge.LESS,ref:e.stencilType===x0.SINGLE?1:e.stencilIndex===0?2:1,mask:255},opFront:{fail:Ge.KEEP,zfail:Ge.REPLACE,zpass:Ge.REPLACE}}}function jb(e){switch(e){case"rotation":return{name:"Rotation",type:mn.Attribute,descriptor:{name:"a_Rotation",buffer:{usage:Ge.DYNAMIC_DRAW,data:[],type:Ge.FLOAT},size:1,update:function(t){var r=t.rotation,n=r===void 0?0:r;return Array.isArray(n)?[n[0]]:[n]}}};case"stroke":return{name:"stroke",type:mn.Attribute,descriptor:{name:"a_Stroke",buffer:{usage:Ge.DYNAMIC_DRAW,data:[],type:Ge.FLOAT},size:4,update:function(t){var r=t.stroke,n=r===void 0?[1,1,1,1]:r;return n}}};case"opacity":return{name:"opacity",type:mn.Attribute,descriptor:{name:"a_Opacity",buffer:{usage:Ge.STATIC_DRAW,data:[],type:Ge.FLOAT},size:1,update:function(t){var r=t.opacity,n=r===void 0?1:r;return[n]}}};case"extrusionBase":return{name:"extrusionBase",type:mn.Attribute,descriptor:{name:"a_ExtrusionBase",buffer:{usage:Ge.STATIC_DRAW,data:[],type:Ge.FLOAT},size:1,update:function(t){var r=t.extrusionBase,n=r===void 0?0:r;return[n]}}};case"offsets":return{name:"offsets",type:mn.Attribute,descriptor:{name:"a_Offsets",buffer:{usage:Ge.STATIC_DRAW,data:[],type:Ge.FLOAT},size:2,update:function(t){var r=t.offsets;return r}}};case"thetaOffset":return{name:"thetaOffset",type:mn.Attribute,descriptor:{name:"a_ThetaOffset",buffer:{usage:Ge.STATIC_DRAW,data:[],type:Ge.FLOAT},size:1,update:function(t){var r=t.thetaOffset,n=r===void 0?1:r;return[n]}}};default:return}}var Vb={opacity:1,stroke:[1,0,0,1],offsets:[0,0],rotation:0,extrusionBase:0,strokeOpacity:1,thetaOffset:.314},Ld={opacity:"float",stroke:"vec4",offsets:"vec2",textOffset:"vec2",rotation:"float",extrusionBase:"float",strokeOpacity:"float",thetaOffset:"float"},Uy,og,Gy,vo=(Uy=tg(Xt.IGlobalConfigService),og=function(){function e(i){(0,ue.Z)(this,e),(0,Ce.Z)(this,"preStyleAttribute",{}),(0,Ce.Z)(this,"encodeStyleAttribute",{}),Ki(this,"configService",Gy,this),this.layer=i,this.rendererService=i.getContainer().get(Xt.IRendererService),this.pickingService=i.getContainer().get(Xt.IPickingService),this.shaderModuleService=i.getContainer().get(Xt.IShaderModuleService),this.styleAttributeService=i.getContainer().get(Xt.IStyleAttributeService),this.mapService=i.getContainer().get(Xt.IMapService),this.iconService=i.getContainer().get(Xt.IIconService),this.fontService=i.getContainer().get(Xt.IFontService),this.cameraService=i.getContainer().get(Xt.ICameraService),this.layerService=i.getContainer().get(Xt.ILayerService),this.registerStyleAttribute(),this.registerBuiltinAttributes(),this.startModelAnimate();var t=this.rendererService.createTexture2D;this.createTexture2D=t}return(0,me.Z)(e,[{key:"getBlend",value:function(){var t=this.layer.getLayerConfig(),r=t.blend,n=r===void 0?"normal":r;return Py[Af[n]]}},{key:"getStencil",value:function(t){var r=this.layer.getLayerConfig(),n=r.mask,a=n===void 0?!1:n,u=r.maskInside,f=u===void 0?!0:u,g=r.enableMask,x=r.maskOperation,I=x===void 0?kh.AND:x;if(this.layer.type==="MaskLayer")return zy({isStencil:!0,stencilType:x0.SINGLE});if(t.isStencil)return zy((0,X.Z)((0,X.Z)({},t),{},{maskOperation:I}));var O=a||g&&this.layer.masks.length!==0||this.layer.tileMask!==void 0;return Gb(O,f)}},{key:"getDefaultStyle",value:function(){return{}}},{key:"getUninforms",value:function(){throw new Error("Method not implemented.")}},{key:"getAnimateUniforms",value:function(){return{}}},{key:"needUpdate",value:function(){var i=(0,ur.Z)(nt().mark(function r(){return nt().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",!1);case 1:case"end":return a.stop()}},r)}));function t(){return i.apply(this,arguments)}return t}()},{key:"buildModels",value:function(){var i=(0,ur.Z)(nt().mark(function r(){return nt().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:throw new Error("Method not implemented.");case 1:case"end":return a.stop()}},r)}));function t(){return i.apply(this,arguments)}return t}()},{key:"initModels",value:function(){var i=(0,ur.Z)(nt().mark(function r(){return nt().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:throw new Error("Method not implemented.");case 1:case"end":return a.stop()}},r)}));function t(){return i.apply(this,arguments)}return t}()},{key:"clearModels",value:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0}},{key:"getAttribute",value:function(){throw new Error("Method not implemented.")}},{key:"render",value:function(t){throw new Error("Method not implemented.")}},{key:"registerBuiltinAttributes",value:function(){throw new Error("Method not implemented.")}},{key:"animateOption2Array",value:function(t){return[t.enable?0:1,t.duration||4,t.interval||.2,t.trailLength||.1]}},{key:"startModelAnimate",value:function(){var t=this.layer.getLayerConfig(),r=t.animateOption;r.enable&&this.layer.setAnimateStartTime()}},{key:"getInject",value:function(){var t=this.layer.encodeStyleAttribute,r="";this.layer.enableShaderEncodeStyles.forEach(function(a){t[a]&&(r+="#define USE_ATTRIBUTE_".concat(a.toUpperCase(),` 0.0; 

`)),r+=`
          #ifdef USE_ATTRIBUTE_`.concat(a.toUpperCase(),`
      attribute `).concat(Ld[a]," a_").concat(a.charAt(0).toUpperCase()+a.slice(1),`;
    #else
      uniform `).concat(Ld[a]," u_").concat(a,`;
    #endif

    `)});var n="";return this.layer.enableShaderEncodeStyles.forEach(function(a){n+=`

#ifdef USE_ATTRIBUTE_`.concat(a.toUpperCase(),`
  `).concat(Ld[a]," ").concat(a,"  = a_").concat(a.charAt(0).toUpperCase()+a.slice(1),`;
#else
  `).concat(Ld[a]," ").concat(a," = u_").concat(a,`;
#endif

`)}),{"vs:#decl":r,"vs:#main-start":n}}},{key:"getStyleAttribute",value:function(){var t=this,r={};return this.layer.enableShaderEncodeStyles.forEach(function(n){if(!t.layer.encodeStyleAttribute[n]){var a=t.layer.getLayerConfig()[n],u=typeof a=="undefined"?Vb[n]:a;n==="stroke"&&(u=Ni(u)),r["u_"+n]=u}}),r}},{key:"registerStyleAttribute",value:function(){var t=this;Object.keys(this.layer.encodeStyleAttribute).forEach(function(r){var n=jb(r);n&&t.styleAttributeService.registerStyleAttribute(n)})}},{key:"updateEncodeAttribute",value:function(t,r){this.encodeStyleAttribute[t]=r}}]),e}(),Gy=Hi(og.prototype,"configService",[Uy],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),og),sg=100,$L=36,WL=40;function jy(e){return e/180*Math.acos(-1)}function Vy(e){var i=jy(e[0])+Math.PI/2,t=jy(e[1]),r=sg+Math.random()*.4,n=r*Math.cos(t)*Math.cos(i),a=r*Math.cos(t)*Math.sin(i),u=r*Math.sin(t);return[a,u,n]}function YL(e,i){var t=mat4.create(),r=mat4.create(),n=vec3.fromValues(0,1,0),a=vec3.fromValues(0,0,0);i=i||{},e=typeof e!="undefined"?e:1;for(var u=typeof i.segments!="undefined"?i.segments:32,f=2+u,g=2*f,x=[],I=[],O=[],B=[],W=[],he=[],ae=0;ae<=f;ae++){for(var Se=ae/f,Fe=Se*Math.PI,Qe=0;Qe<=g;Qe++){var qe=Qe/g,yt=qe*Math.PI*2;mat4.identity(r),mat4.rotateZ(r,r,-Fe),mat4.identity(t),mat4.rotateY(t,t,yt),vec3.transformMat4(a,n,r),vec3.transformMat4(a,a,t),vec3.scale(a,a,-e),O.push(a.slice()),B.push.apply(B,_toConsumableArray(a.slice())),vec3.normalize(a,a),W.push.apply(W,_toConsumableArray(a.slice())),he.push([qe,1-Se]),B.push(qe,1-Se)}if(ae>0)for(var Et=O.length,Ot=Et-2*(g+1);Ot+g+2<Et;Ot++)x.push([Ot,Ot+1,Ot+g+1]),I.push(Ot,Ot+1,Ot+g+1),x.push([Ot+g+1,Ot+1,Ot+g+2]),I.push(Ot+g+1,Ot+1,Ot+g+2)}return{cells:x,positions:O,uvs:he,positionsArr:B,indicesArr:I,normalArr:W}}var Pd=Xi(),XL=Xi(),su=Xi(),D0=Xi(),iA=Xi();function ug(e,i,t,r,n){oo(e,t,r),Gu(e,e),i=Fl(-e[1],e[0]);var a=Fl(-t[1],t[0]);return[n/sl(i,a),i]}function N0(e,i){return nc(e,-i[1],i[0])}function aA(e,i,t){return oc(e,i,t),Gu(e,e),e}function lg(e,i){return e[0]===i[0]&&e[1]===i[1]}function QL(e){for(var i=new Map,t=0;t<e.length;t++){var r=e[0].toString()+"-"+e[1].toString();i.get(r)?(e.splice(t,1),t++):i.set(r,r)}return e}var Hb=function(){function e(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};(0,ue.Z)(this,e),(0,Ce.Z)(this,"lastFlip",-1),(0,Ce.Z)(this,"miter",Fl(0,0)),(0,Ce.Z)(this,"started",!1),(0,Ce.Z)(this,"dash",!1),(0,Ce.Z)(this,"totalDistance",0),(0,Ce.Z)(this,"currentIndex",0),this.join=i.join||"miter",this.cap=i.cap||"butt",this.miterLimit=i.miterLimit||10,this.thickness=i.thickness||1,this.dash=i.dash||!1,this.complex={positions:[],indices:[],normals:[],startIndex:0,indexes:[]}}return(0,me.Z)(e,[{key:"simpleExtrude",value:function(t){var r=this.complex;if(t.length<=1)return r;this.lastFlip=-1,this.started=!1,this.normal=null,this.totalDistance=0;for(var n=t.length,a=r.startIndex,u=1;u<n;u++){var f=t[u-1],g=t[u],x=u<t.length-1?t[u+1]:null,I=this.simpleSegment(r,a,f,g,x);a+=I}if(this.dash)for(var O=0;O<r.positions.length/6;O++)r.positions[O*6+5]=this.totalDistance;return r.startIndex=r.positions.length/6,r}},{key:"simpleExtrude_gaode2",value:function(t,r){var n=this.complex;if(t.length<=1)return n;this.lastFlip=-1,this.started=!1,this.normal=null,this.totalDistance=0;for(var a=t.length,u=n.startIndex,f=1;f<a;f++){var g,x,I,O=t[f-1];O.push((g=r[f-1][2])!==null&&g!==void 0?g:0);var B=r[f-1],W=t[f];W.push((x=r[f][2])!==null&&x!==void 0?x:0);var he=r[f],ae=f<t.length-1?[].concat((0,Mr.Z)(t[f+1]),[(I=r[f+1][2])!==null&&I!==void 0?I:0]):null,Se=f<r.length-1?r[f+1]:null,Fe=this.simpleSegment(n,u,O,W,ae,B,he,Se);u+=Fe}if(this.dash)for(var Qe=0;Qe<n.positions.length/6;Qe++)n.positions[Qe*6+5]=this.totalDistance;return n.startIndex=n.positions.length/6,n}},{key:"extrude_gaode2",value:function(t,r){var n=this.complex;if(t.length<=1)return n;this.lastFlip=-1,this.started=!1,this.normal=null,this.totalDistance=0;for(var a=t.length,u=n.startIndex,f=1;f<a;f++){var g,x,I,O=t[f-1];O.push((g=r[f-1][2])!==null&&g!==void 0?g:0);var B=r[f-1],W=t[f];W.push((x=r[f][2])!==null&&x!==void 0?x:0);var he=r[f],ae=f<t.length-1?[].concat((0,Mr.Z)(t[f+1]),[(I=r[f+1][2])!==null&&I!==void 0?I:0]):null,Se=f<r.length-1?r[f+1]:null,Fe=this.segment_gaode2(n,u,O,W,ae,B,he,Se);u+=Fe}if(this.dash)for(var Qe=0;Qe<n.positions.length/6;Qe++)n.positions[Qe*6+5]=this.totalDistance;return n.startIndex=n.positions.length/6,n}},{key:"extrude",value:function(t){var r=this.complex;if(t.length<=1)return r;this.lastFlip=-1,this.started=!1,this.normal=null,this.totalDistance=0;for(var n=t.length,a=r.startIndex,u=1;u<n;u++){var f=t[u-1],g=t[u],x=u<t.length-1?t[u+1]:null,I=this.segment(r,a,f,g,x);a+=I}if(this.dash)for(var O=0;O<r.positions.length/6;O++)r.positions[O*6+5]=this.totalDistance;return r.startIndex=r.positions.length/6,r}},{key:"simpleSegment",value:function(t,r,n,a,u){var f=0,g=t.indices,x=t.positions,I=t.normals,O=va([a[0],a[1]]),B=va([n[0],n[1]]);aA(su,O,B);var W=0;if(this.dash&&(W=this.lineSegmentDistance(O,B),this.totalDistance+=W),this.normal||(this.normal=Xi(),N0(this.normal,su)),this.started||(this.started=!0,this.extrusions(x,I,n,this.normal,this.thickness,this.totalDistance-W)),g.push(r+0,r+1,r+2),!u)N0(this.normal,su),this.extrusions(x,I,a,this.normal,this.thickness,this.totalDistance),g.push.apply(g,(0,Mr.Z)(this.lastFlip===1?[r,r+2,r+3]:[r+2,r+1,r+3])),f+=2;else{var he=va([u[0],u[1]]);lg(O,he)&&oo(he,O,Gu(he,Uu(he,O,B))),aA(D0,he,O);var ae=ug(iA,Xi(),su,D0,this.thickness),Se=(0,vn.Z)(ae,2),Fe=Se[0],Qe=Se[1],qe=sl(iA,this.normal)<0?-1:1;this.extrusions(x,I,a,Qe,Fe,this.totalDistance),g.push.apply(g,(0,Mr.Z)(this.lastFlip===1?[r,r+2,r+3]:[r+2,r+1,r+3])),qe=-1,iu(this.normal,Qe),f+=2,this.lastFlip=qe}return f}},{key:"segment_gaode2",value:function(t,r,n,a,u,f,g,x){var I=0,O=t.indices,B=t.positions,W=t.normals,he=this.cap==="square",ae=this.join==="bevel",Se=va([g[0],g[1]]),Fe=va([f[0],f[1]]);aA(su,a,n);var Qe=0;if(this.dash&&(Qe=this.lineSegmentDistance(Se,Fe),this.totalDistance+=Qe),this.normal||(this.normal=Xi(),N0(this.normal,su)),!this.started)if(this.started=!0,he){var qe=Xi(),yt=Xi();oo(qe,this.normal,su),oo(yt,this.normal,su),W.push(yt[0],yt[1],0),W.push(qe[0],qe[1],0),B.push(n[0],n[1],n[2]|0,this.totalDistance-Qe,-this.thickness,n[2]|0),this.complex.indexes.push(this.currentIndex),B.push(n[0],n[1],n[2]|0,this.totalDistance-Qe,this.thickness,n[2]|0),this.complex.indexes.push(this.currentIndex),this.currentIndex++}else this.extrusions(B,W,n,this.normal,this.thickness,this.totalDistance-Qe);if(O.push(r+0,r+1,r+2),u){lg(a,u)&&oo(u,a,Gu(u,Uu(u,a,n))),aA(D0,u,a);var jt=ug(iA,Xi(),su,D0,this.thickness),or=(0,vn.Z)(jt,2),ar=or[0],br=or[1],pr=sl(iA,this.normal)<0?-1:1,jr=ae;if(!jr&&this.join==="miter"){var nn=ar;nn>this.miterLimit&&(jr=!0)}jr?(W.push(this.normal[0],this.normal[1],0),W.push(br[0],br[1],0),B.push(a[0],a[1],a[2]|0,this.totalDistance,-this.thickness*pr,a[2]|0),this.complex.indexes.push(this.currentIndex),B.push(a[0],a[1],a[2]|0,this.totalDistance,this.thickness*pr,a[2]|0),this.complex.indexes.push(this.currentIndex),this.currentIndex++,O.push.apply(O,(0,Mr.Z)(this.lastFlip!==-pr?[r,r+2,r+3]:[r+2,r+1,r+3])),O.push(r+2,r+3,r+4),N0(Pd,D0),iu(this.normal,Pd),W.push(this.normal[0],this.normal[1],0),B.push(a[0],a[1],a[2]|0,this.totalDistance,-this.thickness*pr,a[2]|0),this.complex.indexes.push(this.currentIndex),this.currentIndex++,I+=3):(this.extrusions(B,W,a,br,ar,this.totalDistance),O.push.apply(O,(0,Mr.Z)(this.lastFlip===1?[r,r+2,r+3]:[r+2,r+1,r+3])),pr=-1,iu(this.normal,br),I+=2),this.lastFlip=pr}else{if(N0(this.normal,su),he){var Et=Xi(),Ot=Xi();oc(Ot,su,this.normal),oo(Et,su,this.normal),W.push(Ot[0],Ot[1],0),W.push(Et[0],Et[1],0),B.push(a[0],a[1],a[2]|0,this.totalDistance,this.thickness,a[2]|0),this.complex.indexes.push(this.currentIndex),B.push(a[0],a[1],a[2]|0,this.totalDistance,this.thickness,a[2]|0),this.complex.indexes.push(this.currentIndex),this.currentIndex++}else this.extrusions(B,W,a,this.normal,this.thickness,this.totalDistance);O.push.apply(O,(0,Mr.Z)(this.lastFlip===1?[r,r+2,r+3]:[r+2,r+1,r+3])),I+=2}return I}},{key:"segment",value:function(t,r,n,a,u){var f=0,g=t.indices,x=t.positions,I=t.normals,O=this.cap==="square",B=this.join==="bevel",W=va([a[0],a[1]]),he=va([n[0],n[1]]);aA(su,W,he);var ae=0;if(this.dash&&(ae=this.lineSegmentDistance(W,he),this.totalDistance+=ae),this.normal||(this.normal=Xi(),N0(this.normal,su)),!this.started)if(this.started=!0,O){var Se=Xi(),Fe=Xi();oo(Se,this.normal,su),oo(Fe,this.normal,su),I.push(Fe[0],Fe[1],0),I.push(Se[0],Se[1],0),x.push(n[0],n[1],n[2]|0,this.totalDistance-ae,-this.thickness,n[2]|0),this.complex.indexes.push(this.currentIndex),x.push(n[0],n[1],n[2]|0,this.totalDistance-ae,this.thickness,n[2]|0),this.complex.indexes.push(this.currentIndex),this.currentIndex++}else this.extrusions(x,I,n,this.normal,this.thickness,this.totalDistance-ae);if(g.push(r+0,r+1,r+2),u){var yt=va([u[0],u[1]]);lg(W,yt)&&oo(yt,W,Gu(yt,Uu(yt,W,he))),aA(D0,yt,W);var Et=ug(iA,Xi(),su,D0,this.thickness),Ot=(0,vn.Z)(Et,2),jt=Ot[0],or=Ot[1],ar=sl(iA,this.normal)<0?-1:1,br=B;if(!br&&this.join==="miter"){var pr=jt;pr>this.miterLimit&&(br=!0)}br?(I.push(this.normal[0],this.normal[1],0),I.push(or[0],or[1],0),x.push(a[0],a[1],a[2]|0,this.totalDistance,-this.thickness*ar,a[2]|0),this.complex.indexes.push(this.currentIndex),x.push(a[0],a[1],a[2]|0,this.totalDistance,this.thickness*ar,a[2]|0),this.complex.indexes.push(this.currentIndex),this.currentIndex++,g.push.apply(g,(0,Mr.Z)(this.lastFlip!==-ar?[r,r+2,r+3]:[r+2,r+1,r+3])),g.push(r+2,r+3,r+4),N0(Pd,D0),iu(this.normal,Pd),I.push(this.normal[0],this.normal[1],0),x.push(a[0],a[1],a[2]|0,this.totalDistance,-this.thickness*ar,a[2]|0),this.complex.indexes.push(this.currentIndex),this.currentIndex++,f+=3):(this.extrusions(x,I,a,or,jt,this.totalDistance),g.push.apply(g,(0,Mr.Z)(this.lastFlip===1?[r,r+2,r+3]:[r+2,r+1,r+3])),ar=-1,iu(this.normal,or),f+=2),this.lastFlip=ar}else{if(N0(this.normal,su),O){var Qe=Xi(),qe=Xi();oc(qe,su,this.normal),oo(Qe,su,this.normal),I.push(qe[0],qe[1],0),I.push(Qe[0],Qe[1],0),x.push(a[0],a[1],a[2]|0,this.totalDistance,this.thickness,a[2]|0),this.complex.indexes.push(this.currentIndex),x.push(a[0],a[1],a[2]|0,this.totalDistance,this.thickness,a[2]|0),this.complex.indexes.push(this.currentIndex),this.currentIndex++}else this.extrusions(x,I,a,this.normal,this.thickness,this.totalDistance);g.push.apply(g,(0,Mr.Z)(this.lastFlip===1?[r,r+2,r+3]:[r+2,r+1,r+3])),f+=2}return f}},{key:"extrusions",value:function(t,r,n,a,u,f){r.push(a[0],a[1],0),r.push(a[0],a[1],0),t.push(n[0],n[1],n[2]|0,f,-u,n[2]|0),this.complex.indexes.push(this.currentIndex),t.push(n[0],n[1],n[2]|0,f,u,n[2]|0),this.complex.indexes.push(this.currentIndex),this.currentIndex++}},{key:"lineSegmentDistance",value:function(t,r){var n=r[0]-t[0],a=r[1]-t[1];return Math.sqrt(n*n+a*a)}}]),e}();function oA(){var e=new Go(3);return Go!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0),e}function $b(e){var i=new Go(3);return i[0]=e[0],i[1]=e[1],i[2]=e[2],i}function Hy(e){var i=e[0],t=e[1],r=e[2];return Math.hypot(i,t,r)}function Lu(e,i,t){var r=new Go(3);return r[0]=e,r[1]=i,r[2]=t,r}function Wb(e,i){return e[0]=i[0],e[1]=i[1],e[2]=i[2],e}function Yb(e,i,t,r){return e[0]=i,e[1]=t,e[2]=r,e}function Xb(e,i,t){return e[0]=i[0]+t[0],e[1]=i[1]+t[1],e[2]=i[2]+t[2],e}function $y(e,i,t){return e[0]=i[0]-t[0],e[1]=i[1]-t[1],e[2]=i[2]-t[2],e}function Wy(e,i,t){return e[0]=i[0]*t[0],e[1]=i[1]*t[1],e[2]=i[2]*t[2],e}function Yy(e,i,t){return e[0]=i[0]/t[0],e[1]=i[1]/t[1],e[2]=i[2]/t[2],e}function Qb(e,i){return e[0]=Math.ceil(i[0]),e[1]=Math.ceil(i[1]),e[2]=Math.ceil(i[2]),e}function qb(e,i){return e[0]=Math.floor(i[0]),e[1]=Math.floor(i[1]),e[2]=Math.floor(i[2]),e}function Kb(e,i,t){return e[0]=Math.min(i[0],t[0]),e[1]=Math.min(i[1],t[1]),e[2]=Math.min(i[2],t[2]),e}function Jb(e,i,t){return e[0]=Math.max(i[0],t[0]),e[1]=Math.max(i[1],t[1]),e[2]=Math.max(i[2],t[2]),e}function eS(e,i){return e[0]=Math.round(i[0]),e[1]=Math.round(i[1]),e[2]=Math.round(i[2]),e}function tS(e,i,t){return e[0]=i[0]*t,e[1]=i[1]*t,e[2]=i[2]*t,e}function rS(e,i,t,r){return e[0]=i[0]+t[0]*r,e[1]=i[1]+t[1]*r,e[2]=i[2]+t[2]*r,e}function Xy(e,i){var t=i[0]-e[0],r=i[1]-e[1],n=i[2]-e[2];return Math.hypot(t,r,n)}function Qy(e,i){var t=i[0]-e[0],r=i[1]-e[1],n=i[2]-e[2];return t*t+r*r+n*n}function qy(e){var i=e[0],t=e[1],r=e[2];return i*i+t*t+r*r}function Ky(e,i){return e[0]=-i[0],e[1]=-i[1],e[2]=-i[2],e}function nS(e,i){return e[0]=1/i[0],e[1]=1/i[1],e[2]=1/i[2],e}function sA(e,i){var t=i[0],r=i[1],n=i[2],a=t*t+r*r+n*n;return a>0&&(a=1/Math.sqrt(a)),e[0]=i[0]*a,e[1]=i[1]*a,e[2]=i[2]*a,e}function Jy(e,i){return e[0]*i[0]+e[1]*i[1]+e[2]*i[2]}function e1(e,i,t){var r=i[0],n=i[1],a=i[2],u=t[0],f=t[1],g=t[2];return e[0]=n*g-a*f,e[1]=a*u-r*g,e[2]=r*f-n*u,e}function iS(e,i,t,r){var n=i[0],a=i[1],u=i[2];return e[0]=n+r*(t[0]-n),e[1]=a+r*(t[1]-a),e[2]=u+r*(t[2]-u),e}function aS(e,i,t,r,n,a){var u=a*a,f=u*(2*a-3)+1,g=u*(a-2)+a,x=u*(a-1),I=u*(3-2*a);return e[0]=i[0]*f+t[0]*g+r[0]*x+n[0]*I,e[1]=i[1]*f+t[1]*g+r[1]*x+n[1]*I,e[2]=i[2]*f+t[2]*g+r[2]*x+n[2]*I,e}function oS(e,i,t,r,n,a){var u=1-a,f=u*u,g=a*a,x=f*u,I=3*a*f,O=3*g*u,B=g*a;return e[0]=i[0]*x+t[0]*I+r[0]*O+n[0]*B,e[1]=i[1]*x+t[1]*I+r[1]*O+n[1]*B,e[2]=i[2]*x+t[2]*I+r[2]*O+n[2]*B,e}function sS(e,i){i=i||1;var t=Zf()*2*Math.PI,r=Zf()*2-1,n=Math.sqrt(1-r*r)*i;return e[0]=Math.cos(t)*n,e[1]=Math.sin(t)*n,e[2]=r*i,e}function fp(e,i,t){var r=i[0],n=i[1],a=i[2],u=t[3]*r+t[7]*n+t[11]*a+t[15];return u=u||1,e[0]=(t[0]*r+t[4]*n+t[8]*a+t[12])/u,e[1]=(t[1]*r+t[5]*n+t[9]*a+t[13])/u,e[2]=(t[2]*r+t[6]*n+t[10]*a+t[14])/u,e}function uS(e,i,t){var r=i[0],n=i[1],a=i[2];return e[0]=r*t[0]+n*t[3]+a*t[6],e[1]=r*t[1]+n*t[4]+a*t[7],e[2]=r*t[2]+n*t[5]+a*t[8],e}function lS(e,i,t){var r=t[0],n=t[1],a=t[2],u=t[3],f=i[0],g=i[1],x=i[2],I=n*x-a*g,O=a*f-r*x,B=r*g-n*f,W=n*B-a*O,he=a*I-r*B,ae=r*O-n*I,Se=u*2;return I*=Se,O*=Se,B*=Se,W*=2,he*=2,ae*=2,e[0]=f+I+W,e[1]=g+O+he,e[2]=x+B+ae,e}function cS(e,i,t,r){var n=[],a=[];return n[0]=i[0]-t[0],n[1]=i[1]-t[1],n[2]=i[2]-t[2],a[0]=n[0],a[1]=n[1]*Math.cos(r)-n[2]*Math.sin(r),a[2]=n[1]*Math.sin(r)+n[2]*Math.cos(r),e[0]=a[0]+t[0],e[1]=a[1]+t[1],e[2]=a[2]+t[2],e}function fS(e,i,t,r){var n=[],a=[];return n[0]=i[0]-t[0],n[1]=i[1]-t[1],n[2]=i[2]-t[2],a[0]=n[2]*Math.sin(r)+n[0]*Math.cos(r),a[1]=n[1],a[2]=n[2]*Math.cos(r)-n[0]*Math.sin(r),e[0]=a[0]+t[0],e[1]=a[1]+t[1],e[2]=a[2]+t[2],e}function hS(e,i,t,r){var n=[],a=[];return n[0]=i[0]-t[0],n[1]=i[1]-t[1],n[2]=i[2]-t[2],a[0]=n[0]*Math.cos(r)-n[1]*Math.sin(r),a[1]=n[0]*Math.sin(r)+n[1]*Math.cos(r),a[2]=n[2],e[0]=a[0]+t[0],e[1]=a[1]+t[1],e[2]=a[2]+t[2],e}function cg(e,i){var t=e[0],r=e[1],n=e[2],a=i[0],u=i[1],f=i[2],g=Math.sqrt(t*t+r*r+n*n),x=Math.sqrt(a*a+u*u+f*f),I=g*x,O=I&&Jy(e,i)/I;return Math.acos(Math.min(Math.max(O,-1),1))}function AS(e){return e[0]=0,e[1]=0,e[2]=0,e}function pS(e){return"vec3("+e[0]+", "+e[1]+", "+e[2]+")"}function dS(e,i){return e[0]===i[0]&&e[1]===i[1]&&e[2]===i[2]}function vS(e,i){var t=e[0],r=e[1],n=e[2],a=i[0],u=i[1],f=i[2];return Math.abs(t-a)<=za*Math.max(1,Math.abs(t),Math.abs(a))&&Math.abs(r-u)<=za*Math.max(1,Math.abs(r),Math.abs(u))&&Math.abs(n-f)<=za*Math.max(1,Math.abs(n),Math.abs(f))}var fg=$y,gS=Wy,mS=Yy,yS=Xy,_S=Qy,xS=Hy,ES=qy,bS=function(){var e=oA();return function(i,t,r,n,a,u){var f,g;for(t||(t=3),r||(r=0),n?g=Math.min(n*t+r,i.length):g=i.length,f=r;f<g;f+=t)e[0]=i[f],e[1]=i[f+1],e[2]=i[f+2],a(e,e,u),i[f]=e[0],i[f+1]=e[1],i[f+2]=e[2];return i}}();function qL(e){var i=e[0][0],t=e[0][e[0].length-1];i[0]===t[0]&&i[1]===t[1]&&(e[0]=e[0].slice(0,e[0].length-1));for(var r=e[0].length,n=earcut.flatten(e),a=n.vertices,u=n.dimensions,f=[],g=[],x=0;x<a.length/u;x++)u===2?f.push(a[x*2],a[x*2+1],1):f.push(a[x*3],a[x*3+1],1);var I=earcut(n.vertices,n.holes,n.dimensions);g.push.apply(g,_toConsumableArray(I));for(var O=function(){var he=n.vertices.slice(B*u,(B+1)*u),ae=n.vertices.slice((B+1)*u,(B+2)*u);ae.length===0&&(ae=n.vertices.slice(0,u));var Se=f.length/3;f.push(he[0],he[1],1,ae[0],ae[1],1,he[0],he[1],0,ae[0],ae[1],0),g.push.apply(g,_toConsumableArray([0,2,1,2,3,1].map(function(Fe){return Fe+Se})))},B=0;B<r;B++)O();return{positions:f,index:g}}function KL(e){var i=earcut.flatten(e),t=earcut(i.vertices,i.holes,i.dimensions);return{positions:i.vertices,index:t}}function t1(e){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,t=e[0][0],r=e[0][e[0].length-1];t[0]===r[0]&&t[1]===r[1]&&(e[0]=e[0].slice(0,e[0].length-1));for(var n=e[0].length,a=fa().flatten(e),u=a.vertices,f=a.dimensions,g=[],x=[],I=[],O=0;O<u.length/f;O++)g.push(u[O*f],u[O*f+1],1,-1,-1),I.push(0,0,1);var B=fa()(a.vertices,a.holes,a.dimensions);x.push.apply(x,(0,Mr.Z)(B));for(var W=function(){var Se=a.vertices.slice(he*f,(he+1)*f),Fe=a.vertices.slice((he+1)*f,(he+2)*f);Fe.length===0&&(Fe=a.vertices.slice(0,f));var Qe=g.length/5;g.push(Se[0],Se[1],1,0,0,Fe[0],Fe[1],1,.1,0,Se[0],Se[1],0,0,.8,Fe[0],Fe[1],0,.1,.8);var qe=SS([Fe[0],Fe[1],1],[Se[0],Se[1],0],[Se[0],Se[1],1],i);I.push.apply(I,(0,Mr.Z)(qe).concat((0,Mr.Z)(qe),(0,Mr.Z)(qe),(0,Mr.Z)(qe))),x.push.apply(x,(0,Mr.Z)([1,2,0,3,2,1].map(function(yt){return yt+Qe})))},he=0;he<n;he++)W();return{positions:g,index:x,normals:I}}function SS(e,i,t){var r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,n=oA(),a=oA(),u=oA();r&&(e=No(e),i=No(i),t=No(t));var f=Lu.apply(D,(0,Mr.Z)(e)),g=Lu.apply(D,(0,Mr.Z)(i)),x=Lu.apply(D,(0,Mr.Z)(t));fg(n,x,g),fg(a,f,g),e1(u,n,a);var I=oA();return sA(I,u),I}var Vc,hp=function(e){return e.CYLINDER="cylinder",e.SQUARECOLUMN="squareColumn",e.TRIANGLECOLUMN="triangleColumn",e.HEXAGONCOLUMN="hexagonColumn",e.PENTAGONCOLUMN="pentagonColumn",e}({}),Ap=function(e){return e.CIRCLE="circle",e.SQUARE="square",e.TRIANGLE="triangle",e.HEXAGON="hexagon",e.PENTAGON="pentagon",e}({});function pp(e){for(var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,t=Math.PI*2/e,r=[],n=0;n<e;n++)r.push(t*n+i*Math.PI/12);var a=r.map(function(u){var f=Math.sin(u+Math.PI/4),g=Math.cos(u+Math.PI/4);return[f,g,0]});return a}function r1(){return pp(30)}function n1(){return pp(4)}function i1(){return pp(3)}function a1(){return pp(6,1)}function o1(){return pp(5)}var hg=(Vc={},(0,Ce.Z)(Vc,Ap.CIRCLE,r1),(0,Ce.Z)(Vc,Ap.HEXAGON,a1),(0,Ce.Z)(Vc,Ap.TRIANGLE,i1),(0,Ce.Z)(Vc,Ap.SQUARE,n1),(0,Ce.Z)(Vc,Ap.PENTAGON,o1),(0,Ce.Z)(Vc,hp.CYLINDER,r1),(0,Ce.Z)(Vc,hp.HEXAGONCOLUMN,a1),(0,Ce.Z)(Vc,hp.TRIANGLECOLUMN,i1),(0,Ce.Z)(Vc,hp.SQUARECOLUMN,n1),(0,Ce.Z)(Vc,hp.PENTAGONCOLUMN,o1),Vc),Od={};function Rd(e){var i=Is(e.coordinates);return{vertices:[].concat((0,Mr.Z)(i),(0,Mr.Z)(i),(0,Mr.Z)(i),(0,Mr.Z)(i)),indices:[0,1,2,2,3,0],size:i.length}}function s1(e){var i=Is(e.coordinates),t=Vy(i);return{vertices:[].concat((0,Mr.Z)(t),(0,Mr.Z)(t),(0,Mr.Z)(t),(0,Mr.Z)(t)),indices:[0,1,2,2,3,0],size:t.length}}function u1(e){var i=e.shape,t=OS(i,!1),r=t.positions,n=t.index,a=t.normals;return{vertices:r,indices:n,normals:a,size:5}}function CS(e){var i=Is(e.coordinates);return{vertices:(0,Mr.Z)(i),indices:[0],size:i.length}}function Ag(e){var i=e.coordinates,t=e.originCoordinates,r=e.version,n=new Hb({dash:!0,join:"bevel"});if(r==="GAODE2.x"){var a=i;Array.isArray(a[0][0])||(a=[i]);var u=t;Array.isArray(u[0][0])||(u=[t]);for(var f=0;f<a.length;f++){var g=a[f],x=u[f];n.extrude_gaode2(g,x)}}else{var I=i;I[0]&&!Array.isArray(I[0][0])&&(I=[i]),I.forEach(function(B){n.extrude(B)})}var O=n.complex;return{vertices:O.positions,indices:O.indices,normals:O.normals,indexes:O.indexes,size:6}}function wS(e){var i=e.coordinates.flat(),t=1,r=1;return{vertices:[1,0,0].concat((0,Mr.Z)(i),[1,2,-3],(0,Mr.Z)(i),[1,1,-3],(0,Mr.Z)(i),[0,1,0],(0,Mr.Z)(i),[0,0,0],(0,Mr.Z)(i),[1,0,0],(0,Mr.Z)(i),[1,2,-3],(0,Mr.Z)(i),[1,1,-3],(0,Mr.Z)(i),[0,1,0],(0,Mr.Z)(i),[0,0,0],(0,Mr.Z)(i)),normals:[-t,2*r,1,2*r,-r,1,r,-r,1,r,-r,1,-t,-r,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],indices:[0,1,2,0,2,3,0,3,4,5,6,7,5,7,8,5,8,9],size:7}}function JL(e){var i=e.coordinates.flat(),t=1,r=1;return{vertices:[1,0,0].concat(_toConsumableArray(i),[1,2,-3],_toConsumableArray(i),[1,1,-3],_toConsumableArray(i),[0,1,0],_toConsumableArray(i),[0,0,0],_toConsumableArray(i)),normals:[-t,2*r,1,2*r,-r,1,r,-r,1,r,-r,1,-t,-r,1],indices:[0,1,1,2,2,3,3,4,4,0],size:7}}function TS(e){var i=e.coordinates,t=[];if(!Array.isArray(i[0]))return{vertices:[],indices:[],normals:[],size:6,count:0};var r=MS(i),n=r.results,a=r.totalDistance;return n.map(function(u){t.push(u[0],u[1],u[2],u[3],0,a)}),{vertices:t,indices:[],normals:[],size:6,count:n.length}}function eP(e){var i=e.coordinates,t=[];if(!Array.isArray(i[0]))return{vertices:[],indices:[],size:4,count:0};var r=IS(i),n=r.results;return n.map(function(a){t.push(a[0],a[1],a[2],a[3])}),{vertices:t,indices:[],size:4,count:n.length}}function l1(e,i){var t=i[0]-e[0],r=i[1]-e[1];return Math.sqrt(t*t+r*r)}function uA(e,i){return e.length<3&&e.push(0),i!==void 0&&e.push(i),e}function MS(e){var i=e;Array.isArray(i)&&Array.isArray(i[0])&&Array.isArray(i[0][0])&&(i=e.flat());var t=0;if(i.length<2)return{results:i,totalDistance:0};var r=[],n=uA(i[0],t);r.push(n);for(var a=1;a<i.length-1;a++){var u=l1(i[a-1],i[a]);t+=u;var f=uA(i[a],t);r.push(f),r.push(f)}var g=l1(i[i.length-2],i[i.length-1]);return t+=g,r.push(uA(i[i.length-1],t)),{results:r,totalDistance:t}}function IS(e){if(e.length<2)return{results:e};var i=[],t=uA(e[0]);i.push(t);for(var r=1;r<e.length-1;r++){var n=uA(e[r]);i.push(n),i.push(n)}return i.push(uA(e[e.length-1])),{results:i}}function pg(e){var i=e.coordinates,t=fa().flatten(i),r=t.vertices,n=t.dimensions,a=t.holes;return{indices:fa()(r,a,n),vertices:r,size:n}}function LS(e){var i=e.coordinates,t=fa().flatten(i),r=t.vertices,n=t.dimensions,a=t.holes;return{indices:fa()(r,a,n),vertices:PS(r),size:n+4}}function PS(e){for(var i=[],t=Dl(e),r=t.center,n=t.radius,a=0;a<e.length;a+=2){var u=e[a],f=e[a+1];i.push.apply(i,[u,f,0].concat((0,Mr.Z)(r),[n]))}return i}function c1(e){var i=e.coordinates,t=t1(i,!0),r=t.positions,n=t.index,a=t.normals;return{vertices:r,indices:n,normals:a,size:5}}function tP(e){var i=e.shape,t=kS(i),r=t.positions,n=t.index;return{vertices:r,indices:n,size:3}}function kd(e){var i=e.coordinates,t=[].concat((0,Mr.Z)(i[0]),[0,0,1,i[1][0],i[0][1],0,1,1],(0,Mr.Z)(i[1]),[0,1,0],(0,Mr.Z)(i[0]),[0,0,1],(0,Mr.Z)(i[1]),[0,1,0,i[0][0],i[1][1],0,0,0]),r=[0,1,2,3,4,5];return{vertices:t,indices:r,size:5}}function Dd(e,i){for(var t=i||30,r=e.coordinates,n=[],a=[],u=function(x){n.push(x,1,x,r[0][0],r[0][1],r[1][0],r[1][1],x,-1,x,r[0][0],r[0][1],r[1][0],r[1][1]),x!==t-1&&a.push.apply(a,(0,Mr.Z)([0,1,2,1,3,2].map(function(I){return x*2+I})))},f=0;f<t;f++)u(f);return{vertices:n,indices:a,size:7}}function rP(e){var i=e.coordinates;i.length===2&&i.push(0);var t=Nd(-1,1),r=Nd(1,1),n=Nd(-1,-1),a=Nd(1,-1),u=[].concat(_toConsumableArray(i),_toConsumableArray(t),_toConsumableArray(i),_toConsumableArray(n),_toConsumableArray(i),_toConsumableArray(a),_toConsumableArray(i),_toConsumableArray(r)),f=[0,1,2,3,0,2];return{vertices:u,indices:f,size:5}}function OS(e){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(Od&&Od[e])return Od[e];var t=hg[e]?hg[e]():hg.cylinder(),r=t1([t],i);return Od[e]=r,r}function nP(e,i){for(var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:3,r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,n=new Float32Array(e.length/t*3),a,u,f,g=vec3.create(),x=vec3.create(),I=vec3.create(),O=0,B=i.length;O<B;O+=3){a=i[O+0]*3,u=i[O+1]*3,f=i[O+2]*3;var W=[e[a],e[a+1]],he=[e[u],e[u+1]],ae=[e[f],e[f+1]];r&&(W=lngLatToMeters(W),he=lngLatToMeters(he),ae=lngLatToMeters(ae));var Se=W,Fe=_slicedToArray(Se,2),Qe=Fe[0],qe=Fe[1],yt=vec3.fromValues(Qe,qe,e[a+2]),Et=he,Ot=_slicedToArray(Et,2),jt=Ot[0],or=Ot[1],ar=vec3.fromValues(jt,or,e[u+2]),br=ae,pr=_slicedToArray(br,2),jr=pr[0],nn=pr[1],yn=vec3.fromValues(jr,nn,e[f+2]);vec3.sub(g,yn,ar),vec3.sub(x,yt,ar),vec3.cross(I,g,x),n[a]+=g[0],n[a+1]+=g[1],n[a+2]+=g[2],n[u]+=g[0],n[u+1]+=g[1],n[u+2]+=g[2],n[f]+=g[0],n[f+1]+=g[1],n[f+2]+=g[2]}return RS(n),n}function RS(e){for(var i=0,t=e.length;i<t;i+=3){var r=vec3.fromValues(e[i],e[i+1],e[i+2]),n=vec3.create();vec3.normalize(n,r),e.set(n,i)}}function iP(e){var i=e[0][0],t=e[0][e[0].length-1];return i[0]===t[0]&&i[1]===t[1]}function kS(e){var i=["cylinder","triangleColumn","hexagonColumn","squareColumn"],t=geometryShape[e]?geometryShape[e]():geometryShape.circle(),r=i.indexOf(e)===-1?fillPolygon([t]):extrudePolygon([t]);return r}function Nd(e,i){var t=(e+1)/2,r=(i+1)/2;return[t,r]}function aP(){var e=primitiveSphere(EARTH_RADIUS,{segments:EARTH_SEGMENTS}),i=e.positionsArr,t=e.indicesArr,r=e.normalArr;return{vertices:i,indices:t,size:5,normals:r}}function oP(){var e=primitiveSphere(EARTH_RADIUS+EARTH_RADIUS_OUTER,{segments:EARTH_SEGMENTS}),i=e.positionsArr,t=e.indicesArr,r=e.normalArr;return{vertices:i,indices:t,size:5,normals:r}}function DS(e){var i=NS();return function(){var r=(0,oe.Z)(e),n;if(i){var a=(0,oe.Z)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return(0,Ze.Z)(this,n)}}function NS(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var FS=`varying vec4 v_dash_array;
varying vec4 v_color;
varying float v_distance_ratio;

uniform float segmentNumber;


#pragma include "picking"

void main() {
  gl_FragColor = v_color;

  float flag = 0.;
  float dashLength = mod(v_distance_ratio, v_dash_array.x + v_dash_array.y + v_dash_array.z + v_dash_array.w);
  if(dashLength < v_dash_array.x || (dashLength > (v_dash_array.x + v_dash_array.y) && dashLength <  v_dash_array.x + v_dash_array.y + v_dash_array.z)) {
    flag = 1.;
  };
  gl_FragColor.a *=flag;
  
  gl_FragColor = filterColor(gl_FragColor);
}`,BS=`
attribute vec4 a_Color;
attribute vec3 a_Position;
attribute vec4 a_Instance;
attribute float a_Size;
uniform mat4 u_ModelMatrix;

uniform float segmentNumber;
varying vec4 v_color;


uniform vec4 u_dash_array: [10.0, 5., 0, 0];
uniform float u_lineDir: 1.0;
varying vec4 v_dash_array;
varying float v_distance_ratio;

uniform float u_thetaOffset: 0.314;

#pragma include "projection"
#pragma include "project"
#pragma include "picking"

float bezier3(vec3 arr, float t) {
  float ut = 1. - t;
  return (arr.x * ut + arr.y * t) * ut + (arr.y * ut + arr.z * t) * t;
}
vec2 midPoint(vec2 source, vec2 target, float arcThetaOffset) {
  vec2 center = target - source;
  float r = length(center);
  float theta = atan(center.y, center.x);
  float thetaOffset = arcThetaOffset;
  float r2 = r / 2.0 / cos(thetaOffset);
  float theta2 = theta + thetaOffset;
  vec2 mid = vec2(r2*cos(theta2) + source.x, r2*sin(theta2) + source.y);
  if(u_lineDir == 1.0) { // \u6B63\u5411
    return mid;
  } else { // \u9006\u5411
    // (mid + vmin)/2 = (s + t)/2
    vec2 vmid = source + target - mid;
    return vmid;
  }
  // return mid;
}
float getSegmentRatio(float index) {
  // dash: index / (segmentNumber - 1.);
  // normal: smoothstep(0.0, 1.0, index / (segmentNumber - 1.));
  return index / (segmentNumber - 1.);
}
vec2 interpolate (vec2 source, vec2 target, float t, float arcThetaOffset) {
  // if the angularDist is PI, linear interpolation is applied. otherwise, use spherical interpolation
  vec2 mid = midPoint(source, target, arcThetaOffset);
  vec3 x = vec3(source.x, mid.x, target.x);
  vec3 y = vec3(source.y, mid.y, target.y);
  return vec2(bezier3(x ,t), bezier3(y,t));
}
vec2 getExtrusionOffset(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
   dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
  vec2 offset = dir_screenspace * offset_direction * setPickingSize(a_Size) / 2.0;
  return offset;
}
vec2 getNormal(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
   dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
   return reverse_offset_normal(vec3(dir_screenspace,1.0)).xy * sign(offset_direction);
}

void main() {
  v_color = vec4(a_Color.xyz, a_Color.w * opacity);
  
  vec2 source = a_Instance.rg;  // \u8D77\u59CB\u70B9
  vec2 target =  a_Instance.ba; // \u7EC8\u70B9
  float segmentIndex = a_Position.x;
  float segmentRatio = getSegmentRatio(segmentIndex);

  float indexDir = mix(-1.0, 1.0, step(segmentIndex, 0.0));
  float nextSegmentRatio = getSegmentRatio(segmentIndex + indexDir);

  vec2 s = source;
  vec2 t = target;
  
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    s = unProjCustomCoord(source);
    t = unProjCustomCoord(target);
  }
  float total_Distance = pixelDistance(s, t) / 2.0 * PI;
  v_dash_array = pow(2.0, 20.0 - u_Zoom) * u_dash_array / total_Distance;

  v_distance_ratio = segmentIndex / segmentNumber;

  vec4 curr = project_position(vec4(interpolate(source, target, segmentRatio, u_thetaOffset), 0.0, 1.0));
  vec4 next = project_position(vec4(interpolate(source, target, nextSegmentRatio, u_thetaOffset), 0.0, 1.0));
 
  
  vec2 offset = project_pixel(getExtrusionOffset((next.xy - curr.xy) * indexDir, a_Position.y));

  gl_Position = project_common_position_to_clipspace_v2(vec4(curr.xy + offset, 0, 1.0));

  gl_PointSize = 5.0;
  setPickingColor(a_PickingColor);
}
`,ZS=`
#define Animate 0.0
#define LineTexture 1.0
uniform float u_textureBlend;
uniform float u_blur : 0.9;
uniform float u_line_type: 0.0;
// varying vec2 v_normal;
varying vec4 v_dash_array;
varying vec4 v_color;

uniform float u_time;
uniform vec4 u_animate: [ 1., 2., 1.0, 0.2 ];

uniform float u_line_texture;
uniform sampler2D u_texture;
uniform vec2 u_textSize;

uniform float segmentNumber;
varying vec2 v_iconMapUV;
varying vec4 v_lineData;


#pragma include "picking"

void main() {
  float animateSpeed = 0.0; // \u8FD0\u52A8\u901F\u5EA6
  gl_FragColor = v_color;
  

  if(u_animate.x == Animate && u_line_texture != LineTexture) {
      animateSpeed = u_time / u_animate.y;
      float alpha =1.0 - fract( mod(1.0- v_lineData.b, u_animate.z)* (1.0/ u_animate.z) + u_time / u_animate.y);
      alpha = (alpha + u_animate.w -1.0) / u_animate.w;
      // alpha = smoothstep(0., 1., alpha);
      alpha = clamp(alpha, 0.0, 1.0);
      gl_FragColor.a *= alpha;
  }

  // \u5F53\u5B58\u5728\u8D34\u56FE\u65F6\u5728\u5E95\u8272\u4E0A\u8D34\u4E0A\u8D34\u56FE
  if(u_line_texture == LineTexture) { // while load texture
    float arcRadio = smoothstep( 0.0, 1.0, (v_lineData.r / segmentNumber));
    // float arcRadio = smoothstep( 0.0, 1.0, d_distance_ratio);

    float count = v_lineData.g; // \u8D34\u56FE\u5728\u5F27\u7EBF\u4E0A\u91CD\u590D\u7684\u6570\u91CF

    float time = 0.0;
    if(u_animate.x == Animate) {
      time = u_time / u_animate.y;
    }
    float redioCount = arcRadio * count;

    float u = fract(redioCount - time);
    float v = v_lineData.a; // \u6A2A\u5411 v
    vec2 uv= v_iconMapUV / u_textSize + vec2(u, v) / u_textSize * 64.;

    vec4 pattern = texture2D(u_texture, uv);

    if(u_animate.x == Animate) {
      float currentPlane = floor(redioCount - time);
      float textureStep = floor(count * u_animate.z);
      float a = mod(currentPlane, textureStep);
      if(a < textureStep - 1.0) {
        pattern = vec4(0.0);
      }
    }

    if(u_textureBlend == 0.0) { // normal
      pattern.a = 0.0;
      gl_FragColor = filterColor(gl_FragColor + pattern);
    } else { // replace
        pattern.a *= v_color.a;
        if(gl_FragColor.a <= 0.0) {
          pattern.a = 0.0;
        }
        gl_FragColor = filterColor(pattern);
    }
    
  } else {
     gl_FragColor = filterColor(gl_FragColor);
  }
}`,zS=`#define Animate 0.0
#define LineTexture 1.0

attribute vec4 a_Color;
attribute vec3 a_Position;
attribute vec4 a_Instance;
attribute float a_Size;
uniform mat4 u_ModelMatrix;

uniform float segmentNumber;
uniform vec4 u_animate: [ 1., 2., 1.0, 0.2 ];
varying vec4 v_color;

uniform float u_lineDir: 1.0;

uniform float u_icon_step: 100;
uniform float u_line_texture: 0.0;
attribute vec2 a_iconMapUV;
varying vec2 v_iconMapUV;
varying vec4 v_lineData;
varying vec2 v_distance_ratio;


#pragma include "projection"
#pragma include "project"
#pragma include "picking"

float bezier3(vec3 arr, float t) {
  float ut = 1. - t;
  return (arr.x * ut + arr.y * t) * ut + (arr.y * ut + arr.z * t) * t;
}
vec2 midPoint(vec2 source, vec2 target, float arcThetaOffset) {
  vec2 center = target - source;
  float r = length(center);
  float theta = atan(center.y, center.x);
  float thetaOffset = arcThetaOffset;
  float r2 = r / 2.0 / cos(thetaOffset);
  float theta2 = theta + thetaOffset;
  vec2 mid = vec2(r2*cos(theta2) + source.x, r2*sin(theta2) + source.y);
  if(u_lineDir == 1.0) { // \u6B63\u5411
    return mid;
  } else { // \u9006\u5411
    // (mid + vmin)/2 = (s + t)/2
    vec2 vmid = source + target - mid;
    return vmid;
  }
  // return mid;
}
float getSegmentRatio(float index) {
    // dash: index / (segmentNumber - 1.);
    // normal: smoothstep(0.0, 1.0, index / (segmentNumber - 1.));
    return smoothstep(0.0, 1.0, index / (segmentNumber - 1.));
    //  return index / (segmentNumber - 1.);
}
vec2 interpolate (vec2 source, vec2 target, float t, float arcThetaOffset) {
  // if the angularDist is PI, linear interpolation is applied. otherwise, use spherical interpolation
  vec2 mid = midPoint(source, target, arcThetaOffset);
  vec3 x = vec3(source.x, mid.x, target.x);
  vec3 y = vec3(source.y, mid.y, target.y);
  return vec2(bezier3(x ,t), bezier3(y,t));
}
vec2 getExtrusionOffset(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
   dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
  vec2 offset = dir_screenspace * offset_direction * setPickingSize(a_Size) / 2.0;
  return offset;
}
vec2 getNormal(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
   dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
   return reverse_offset_normal(vec3(dir_screenspace,1.0)).xy * sign(offset_direction);
}

void main() {
  v_color = a_Color;
  v_color.a = v_color.a * opacity;

  vec2 source = a_Instance.rg;  // \u8D77\u59CB\u70B9
  vec2 target =  a_Instance.ba; // \u7EC8\u70B9
  float segmentIndex = a_Position.x;
  float segmentRatio = getSegmentRatio(segmentIndex);

  float indexDir = mix(-1.0, 1.0, step(segmentIndex, 0.0));
  float nextSegmentRatio = getSegmentRatio(segmentIndex + indexDir);
  float d_distance_ratio;
  
  if(u_animate.x == Animate) {
      d_distance_ratio = segmentIndex / segmentNumber;
      if(u_lineDir != 1.0) {
        d_distance_ratio = 1.0 - d_distance_ratio;
      }
  }

 v_lineData.b = d_distance_ratio;

  vec4 curr = project_position(vec4(interpolate(source, target, segmentRatio, thetaOffset), 0.0, 1.0));
  vec4 next = project_position(vec4(interpolate(source, target, nextSegmentRatio, thetaOffset), 0.0, 1.0));

  
  vec2 offset = project_pixel(getExtrusionOffset((next.xy - curr.xy) * indexDir, a_Position.y));


  float d_segmentIndex = a_Position.x + 1.0; // \u5F53\u524D\u9876\u70B9\u5728\u5F27\u7EBF\u4E2D\u6240\u5904\u7684\u5206\u6BB5\u4F4D\u7F6E
 v_lineData.r = d_segmentIndex;

  if(LineTexture == u_line_texture) { // \u5F00\u542F\u8D34\u56FE\u6A21\u5F0F

    float arcDistrance = length(source - target); // \u8D77\u59CB\u70B9\u548C\u7EC8\u70B9\u7684\u8DDD\u79BB
    if(u_CoordinateSystem == COORDINATE_SYSTEM_P20) { // amap
      arcDistrance *= 1000000.0;
    }
    if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) { // mapbox
      // arcDistrance *= 8.0;
      arcDistrance = project_pixel_allmap(arcDistrance);
    }
    v_iconMapUV = a_iconMapUV;

    float pixelLen = project_pixel_texture(u_icon_step); // \u8D34\u56FE\u6CBF\u5F27\u7EBF\u65B9\u5411\u7684\u957F\u5EA6 - \u968F\u5730\u56FE\u7F29\u653E\u6539\u53D8
    float texCount = floor(arcDistrance/pixelLen); // \u8D34\u56FE\u5728\u5F27\u7EBF\u4E0A\u91CD\u590D\u7684\u6570\u91CF
    v_lineData.g = texCount;

    float lineOffsetWidth = length(offset + offset * sign(a_Position.y)); // \u7EBF\u6A2A\u5411\u504F\u79FB\u7684\u8DDD\u79BB
    float linePixelSize = project_pixel(a_Size); // \u5B9A\u70B9\u4F4D\u7F6E\u504F\u79FB
    v_lineData.a = lineOffsetWidth/linePixelSize; // \u7EBF\u56FE\u5C42\u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\u503C
  }

  gl_Position = project_common_position_to_clipspace_v2(vec4(curr.xy + offset, 0, 1.0));

  setPickingColor(a_PickingColor);
}
`,US=`varying vec4 v_color;

#pragma include "picking"

void main() {
// \u5F53\u524D\u9876\u70B9\u5728\u5F27\u7EBF\u4E2D\u6240\u5904\u7684\u5206\u6BB5\u4F4D\u7F6E

  gl_FragColor = v_color;
  gl_FragColor = filterColor(gl_FragColor);
}`,GS=`
attribute vec4 a_Color;
attribute vec3 a_Position;
attribute vec4 a_Instance;
attribute float a_Size;
uniform mat4 u_ModelMatrix;

uniform float segmentNumber;
varying vec4 v_color;
varying float v_segmentIndex;

uniform float u_lineDir: 1.0;

uniform float u_thetaOffset: 0.314;
uniform vec4 u_sourceColor;
uniform vec4 u_targetColor;




#pragma include "projection"
#pragma include "project"
#pragma include "picking"

float bezier3(vec3 arr, float t) {
  float ut = 1. - t;
  return (arr.x * ut + arr.y * t) * ut + (arr.y * ut + arr.z * t) * t;
}
vec2 midPoint(vec2 source, vec2 target, float arcThetaOffset) {
  vec2 center = target - source;
  float r = length(center);
  float theta = atan(center.y, center.x);
  float thetaOffset = arcThetaOffset;
  float r2 = r / 2.0 / cos(thetaOffset);
  float theta2 = theta + thetaOffset;
  vec2 mid = vec2(r2*cos(theta2) + source.x, r2*sin(theta2) + source.y);
  if(u_lineDir == 1.0) { // \u6B63\u5411
    return mid;
  } else { // \u9006\u5411
    // (mid + vmin)/2 = (s + t)/2
    vec2 vmid = source + target - mid;
    return vmid;
  }
  // return mid;
}
float getSegmentRatio(float index) {
    return smoothstep(0.0, 1.0, index / (segmentNumber - 1.));
}
vec2 interpolate (vec2 source, vec2 target, float t, float arcThetaOffset) {
  // if the angularDist is PI, linear interpolation is applied. otherwise, use spherical interpolation
  vec2 mid = midPoint(source, target, arcThetaOffset);
  vec3 x = vec3(source.x, mid.x, target.x);
  vec3 y = vec3(source.y, mid.y, target.y);
  return vec2(bezier3(x ,t), bezier3(y,t));
}
vec2 getExtrusionOffset(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
   dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
  vec2 offset = dir_screenspace * offset_direction * setPickingSize(a_Size) / 2.0;
  return offset;
}
vec2 getNormal(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
   dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
   return reverse_offset_normal(vec3(dir_screenspace,1.0)).xy * sign(offset_direction);
}

void main() {
  v_color = a_Color;

  vec2 source = a_Instance.rg;  // \u8D77\u59CB\u70B9
  vec2 target =  a_Instance.ba; // \u7EC8\u70B9
  float segmentIndex = a_Position.x;
  float segmentRatio = getSegmentRatio(segmentIndex);

  float indexDir = mix(-1.0, 1.0, step(segmentIndex, 0.0));
  float nextSegmentRatio = getSegmentRatio(segmentIndex + indexDir);
  float d_distance_ratio;
  vec4 curr = project_position(vec4(interpolate(source, target, segmentRatio, u_thetaOffset), 0.0, 1.0));
  vec4 next = project_position(vec4(interpolate(source, target, nextSegmentRatio, u_thetaOffset), 0.0, 1.0));
  // v_normal = getNormal((next.xy - curr.xy) * indexDir, a_Position.y);
  //unProjCustomCoord
  
  vec2 offset = project_pixel(getExtrusionOffset((next.xy - curr.xy) * indexDir, a_Position.y));


  float d_segmentIndex = a_Position.x + 1.0; // \u5F53\u524D\u9876\u70B9\u5728\u5F27\u7EBF\u4E2D\u6240\u5904\u7684\u5206\u6BB5\u4F4D\u7F6E

  v_color = mix(u_sourceColor, u_targetColor, d_segmentIndex/segmentNumber);
  v_color.a *= opacity;

  gl_Position = project_common_position_to_clipspace_v2(vec4(curr.xy + offset, 0, 1.0));

  setPickingColor(a_PickingColor);
}
`,jS={solid:0,dash:1},sP=In.isNumber,VS=function(e){(0,ke.Z)(t,e);var i=DS(t);function t(){var r;(0,ue.Z)(this,t);for(var n=arguments.length,a=new Array(n),u=0;u<n;u++)a[u]=arguments[u];return r=i.call.apply(i,[this].concat(a)),(0,Ce.Z)((0,bt.Z)(r),"updateTexture",function(){var f=r.rendererService.createTexture2D;if(r.texture){r.texture.update({data:r.iconService.getCanvas()}),r.layer.render();return}r.texture=f({data:r.iconService.getCanvas(),mag:Ge.NEAREST,min:Ge.NEAREST,premultiplyAlpha:!1,width:1024,height:r.iconService.canvasHeight||128})}),r}return(0,me.Z)(t,[{key:"getUninforms",value:function(){var n=this.layer.getLayerConfig(),a=n.opacity,u=a===void 0?1:a,f=n.sourceColor,g=n.targetColor,x=n.textureBlend,I=x===void 0?"normal":x,O=n.lineType,B=O===void 0?"solid":O,W=n.dashArray,he=W===void 0?[10,5]:W,ae=n.forward,Se=ae===void 0?!0:ae,Fe=n.lineTexture,Qe=Fe===void 0?!1:Fe,qe=n.iconStep,yt=qe===void 0?100:qe,Et=n.segmentNumber,Ot=Et===void 0?30:Et;he.length===2&&he.push(0,0);var jt=0,or=[0,0,0,0],ar=[0,0,0,0];return f&&g&&(or=Ni(f),ar=Ni(g),jt=1),this.rendererService.getDirty()&&this.texture.bind(),(0,X.Z)({u_textureBlend:I==="normal"?0:1,segmentNumber:Ot,u_line_type:jS[B||"solid"],u_dash_array:he,u_blur:.9,u_lineDir:Se?1:-1,u_texture:this.texture,u_line_texture:Qe?1:0,u_icon_step:yt,u_textSize:[1024,this.iconService.canvasHeight||128],u_linearColor:jt,u_sourceColor:or,u_targetColor:ar},this.getStyleAttribute())}},{key:"getAnimateUniforms",value:function(){var n=this.layer.getLayerConfig(),a=n.animateOption;return{u_animate:this.animateOption2Array(a),u_time:this.layer.getLayerAnimateTime()}}},{key:"initModels",value:function(){var r=(0,ur.Z)(nt().mark(function a(){return nt().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return this.updateTexture(),this.iconService.on("imageUpdate",this.updateTexture),f.abrupt("return",this.buildModels());case 3:case"end":return f.stop()}},a,this)}));function n(){return r.apply(this,arguments)}return n}()},{key:"clearModels",value:function(){var n;(n=this.texture)===null||n===void 0||n.destroy(),this.iconService.off("imageUpdate",this.updateTexture)}},{key:"getShaders",value:function(){var n=this.layer.getLayerConfig(),a=n.sourceColor,u=n.targetColor,f=n.lineType;return f==="dash"?{frag:FS,vert:BS,type:"Dash"}:a&&u?{frag:US,vert:GS,type:"Linear"}:{frag:ZS,vert:zS,type:""}}},{key:"buildModels",value:function(){var r=(0,ur.Z)(nt().mark(function a(){var u,f,g,x,I,O,B,W;return nt().wrap(function(ae){for(;;)switch(ae.prev=ae.next){case 0:return u=this.layer.getLayerConfig(),f=u.segmentNumber,g=f===void 0?30:f,x=this.getShaders(),I=x.frag,O=x.vert,B=x.type,ae.next=4,this.layer.buildLayerModel({moduleName:"lineArc2d"+B,vertexShader:O,fragmentShader:I,inject:this.getInject(),triangulation:Dd,depth:{enable:!1},segmentNumber:g});case 4:return W=ae.sent,ae.abrupt("return",[W]);case 6:case"end":return ae.stop()}},a,this)}));function n(){return r.apply(this,arguments)}return n}()},{key:"registerBuiltinAttributes",value:function(){var n=this;this.styleAttributeService.registerStyleAttribute({name:"size",type:mn.Attribute,descriptor:{name:"a_Size",buffer:{usage:Ge.DYNAMIC_DRAW,data:[],type:Ge.FLOAT},size:1,update:function(u){var f=u.size,g=f===void 0?1:f;return Array.isArray(g)?[g[0]]:[g]}}}),this.styleAttributeService.registerStyleAttribute({name:"instance",type:mn.Attribute,descriptor:{name:"a_Instance",buffer:{usage:Ge.STATIC_DRAW,data:[],type:Ge.FLOAT},size:4,update:function(u,f,g){return[g[3],g[4],g[5],g[6]]}}}),this.styleAttributeService.registerStyleAttribute({name:"uv",type:mn.Attribute,descriptor:{name:"a_iconMapUV",buffer:{usage:Ge.DYNAMIC_DRAW,data:[],type:Ge.FLOAT},size:2,update:function(u){var f=n.iconService.getIconMap(),g=u.texture,x=f[g]||{x:0,y:0},I=x.x,O=x.y;return[I,O]}}})}}]),t}(vo);function HS(e){var i=$S();return function(){var r=(0,oe.Z)(e),n;if(i){var a=(0,oe.Z)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return(0,Ze.Z)(this,n)}}function $S(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var WS=`#define LineTypeSolid 0.0
#define LineTypeDash 1.0
#define Animate 0.0
#define LineTexture 1.0

uniform float u_textureBlend;
uniform float u_blur : 0.9;
uniform float u_line_type: 0.0;
// varying vec2 v_normal;
varying vec4 v_dash_array;
varying vec4 v_color;
varying vec4 v_line_data;

uniform float u_line_texture: 0.0;
uniform sampler2D u_texture;
uniform vec2 u_textSize;
varying float v_segmentIndex;
uniform float segmentNumber;


varying vec2 v_iconMapUV;

uniform float u_time;
uniform vec4 u_animate: [ 1., 2., 1.0, 0.2 ];


#pragma include "picking"

void main() {
  float animateSpeed = 0.0; // \u8FD0\u52A8\u901F\u5EA6
  float d_distance_ratio = v_line_data.g; // \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B
  gl_FragColor = v_color;

  if(u_line_type == LineTypeDash) {
    float flag = 0.;
    float dashLength = mod(d_distance_ratio, v_dash_array.x + v_dash_array.y + v_dash_array.z + v_dash_array.w);
    if(dashLength < v_dash_array.x || (dashLength > (v_dash_array.x + v_dash_array.y) && dashLength <  v_dash_array.x + v_dash_array.y + v_dash_array.z)) {
      flag = 1.;
    }
    gl_FragColor.a *=flag;
  }

  if(u_animate.x == Animate && u_line_texture != LineTexture) {
      animateSpeed = u_time / u_animate.y;
      float alpha =1.0 - fract( mod(1.0- d_distance_ratio, u_animate.z)* (1.0/ u_animate.z) + u_time / u_animate.y);

      alpha = (alpha + u_animate.w -1.0) / u_animate.w;
      // alpha = smoothstep(0., 1., alpha);
      alpha = clamp(alpha, 0.0, 1.0);
      gl_FragColor.a *= alpha;

      // u_animate 
      // x enable
      // y duration
      // z interval
      // w trailLength
  }

  if(u_line_texture == LineTexture && u_line_type != LineTypeDash) { // while load texture
    // float arcRadio = smoothstep( 0.0, 1.0, (v_segmentIndex / segmentNumber));
    float arcRadio = v_segmentIndex / (segmentNumber - 1.0);
    float count = v_line_data.b; // // \u8D34\u56FE\u5728\u5F27\u7EBF\u4E0A\u91CD\u590D\u7684\u6570\u91CF

    float time = 0.0;
    if(u_animate.x == Animate) {
      time = u_time / u_animate.y;
    }
    float redioCount = arcRadio * count;

    float u = fract(redioCount - time);

    float v = v_line_data.a;  // \u7EBF\u56FE\u5C42\u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\u503C
    vec2 uv= v_iconMapUV / u_textSize + vec2(u, v) / u_textSize * 64.;
    vec4 pattern = texture2D(u_texture, uv);

    if(u_animate.x == Animate) {
      float currentPlane = floor(redioCount - time);
      float textureStep = floor(count * u_animate.z);
      float a = mod(currentPlane, textureStep);
      if(a < textureStep - 1.0) {
        pattern = vec4(0.0);
      }
    }

    if(u_textureBlend == 0.0) { // normal
      pattern.a = 0.0;
      gl_FragColor = filterColor(gl_FragColor + pattern);
    } else { // replace
        pattern.a *= v_color.a;
        if(gl_FragColor.a <= 0.0) {
          pattern.a = 0.0;
          discard;
        } else {
          gl_FragColor = filterColor(pattern);
        }
    }

  } else {
    gl_FragColor = filterColor(gl_FragColor);
  }
}
`,YS=`#define LineTypeSolid 0.0
#define LineTypeDash 1.0
#define Animate 0.0
#define LineTexture 1.0
attribute vec3 a_Position;
attribute vec4 a_Instance;
attribute vec4 a_Color;
attribute float a_Size;

uniform float u_globel;
uniform float u_globel_radius;
uniform float u_global_height: 10;
uniform mat4 u_ModelMatrix;

uniform float segmentNumber;
uniform vec4 u_animate: [ 1., 2., 1.0, 0.2 ];
varying vec4 v_color;

uniform float u_line_type: 0.0;
uniform vec4 u_dash_array: [10.0, 5., 0, 0];
varying vec4 v_dash_array;

uniform float u_icon_step: 100;
uniform float u_line_texture: 0.0;
varying float v_segmentIndex;

attribute vec2 a_iconMapUV;
varying vec2 v_iconMapUV;
varying vec4 v_line_data;

#pragma include "projection"
#pragma include "project"
#pragma include "picking"

float maps (float value, float start1, float stop1, float start2, float stop2) {
  return start2 + (stop2 - start2) * ((value - start1) / (stop1 - start1));
}

float getSegmentRatio(float index) {
  return smoothstep(0.0, 1.0, index / (segmentNumber - 1.0));
}

float paraboloid(vec2 source, vec2 target, float ratio) {
  vec2 x = mix(source, target, ratio);
  vec2 center = mix(source, target, 0.5);
  float dSourceCenter = distance(source, center);
  float dXCenter = distance(x, center);
  return (dSourceCenter + dXCenter) * (dSourceCenter - dXCenter);
}

vec3 getPos(vec2 source, vec2 target, float segmentRatio) {
  float vertex_height = paraboloid(source, target, segmentRatio);

  return vec3(
    mix(source, target, segmentRatio),
    sqrt(max(0.0, vertex_height))
  );
}
vec2 getExtrusionOffset(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
  dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);

  vec2 offset = dir_screenspace * offset_direction * setPickingSize(a_Size) / 2.0;

  return offset;
}
vec2 getNormal(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
  dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
  return reverse_offset_normal(vec3(dir_screenspace,1.0)).xy * sign(offset_direction);
}

float torad(float deg) {
  return (deg / 180.0) * acos(-1.0);
}

vec3 lglt2xyz(vec2 lnglat) {
  float pi = 3.1415926;
  // + Math.PI/2 \u662F\u4E3A\u4E86\u5BF9\u9F50\u5750\u6807
  float lng = torad(lnglat.x) + pi / 2.0;
  float lat = torad(lnglat.y);

  // \u624B\u52A8\u589E\u52A0\u4E00\u4E9B\u504F\u79FB\uFF0C\u51CF\u8F7B\u9762\u7684\u51B2\u7A81
  float radius = u_globel_radius;

  float z = radius * cos(lat) * cos(lng);
  float x = radius * cos(lat) * sin(lng);
  float y = radius * sin(lat);
  return vec3(x, y, z);
}

void main() {

  v_color = a_Color;
  v_color.a = v_color.a * opacity;
  vec2 source = project_position(vec4(a_Instance.rg, 0, 0)).xy;
  vec2 target = project_position(vec4(a_Instance.ba, 0, 0)).xy;
  float segmentIndex = a_Position.x;
  float segmentRatio = getSegmentRatio(segmentIndex);
  float indexDir = mix(-1.0, 1.0, step(segmentIndex, 0.0));

  float d_distance_ratio;
   if(u_line_type == LineTypeDash) {
    d_distance_ratio = segmentIndex / segmentNumber;
    vec2 s = source;
    vec2 t = target;
    
    if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
      s = unProjCustomCoord(source);
      t = unProjCustomCoord(target);
    }
    float total_Distance = pixelDistance(s, t) / 2.0 * PI;
    v_dash_array = pow(2.0, 20.0 - u_Zoom) * u_dash_array / (total_Distance / segmentNumber * segmentIndex);
  }
    if(u_animate.x == Animate) {
      d_distance_ratio = segmentIndex / segmentNumber;
  }
  v_line_data.g = d_distance_ratio; // \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B

  float nextSegmentRatio = getSegmentRatio(segmentIndex + indexDir);
  vec3 curr = getPos(source, target, segmentRatio);
  vec3 next = getPos(source, target, nextSegmentRatio);
  vec2 offset = getExtrusionOffset((next.xy - curr.xy) * indexDir, a_Position.y);
  // v_normal = getNormal((next.xy - curr.xy) * indexDir, a_Position.y);


  v_segmentIndex = a_Position.x;
  if(LineTexture == u_line_texture && u_line_type != LineTypeDash) { // \u5F00\u542F\u8D34\u56FE\u6A21\u5F0F  

    float arcDistrance = length(source - target);
    float pixelLen =  project_pixel_texture(u_icon_step);
    v_line_data.b = floor(arcDistrance/pixelLen); // \u8D34\u56FE\u5728\u5F27\u7EBF\u4E0A\u91CD\u590D\u7684\u6570\u91CF

    vec2 projectOffset = project_pixel(offset);
    float lineOffsetWidth = length(projectOffset + projectOffset * sign(a_Position.y)); // \u7EBF\u6A2A\u5411\u504F\u79FB\u7684\u8DDD\u79BB
    float linePixelSize = project_pixel(a_Size);  // \u5B9A\u70B9\u4F4D\u7F6E\u504F\u79FB\uFF0C\u6309\u5730\u56FE\u7B49\u7EA7\u7F29\u653E\u540E\u7684\u8DDD\u79BB
    v_line_data.a = lineOffsetWidth/linePixelSize;  // \u7EBF\u56FE\u5C42\u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\u503C

    v_iconMapUV = a_iconMapUV;
  }


  gl_Position = project_common_position_to_clipspace_v2(vec4(curr.xy + project_pixel(offset), curr.z * thetaOffset, 1.0));

  // \u5730\u7403\u6A21\u5F0F
  if(u_globel > 0.0) {
    vec3 startLngLat = lglt2xyz(a_Instance.rg);
    vec3 endLngLat = lglt2xyz(a_Instance.ba);
    float globalRadius = length(startLngLat);

    vec3 lineDir = normalize(endLngLat - startLngLat);
    vec3 midPointDir = normalize((startLngLat + endLngLat)/2.0);

    // \u7EBF\u7684\u504F\u79FB
    vec3 lnglatOffset = cross(lineDir, midPointDir) * a_Position.y;
    // \u8BA1\u7B97\u8D77\u59CB\u70B9\u548C\u7EC8\u6B62\u70B9\u7684\u8DDD\u79BB
    float lnglatLength = length(a_Instance.rg - a_Instance.ba)/50.0;
    // \u8BA1\u7B97\u98DE\u7EBF\u5404\u4E2A\u8282\u70B9\u76F8\u5E94\u7684\u9AD8\u5EA6
    float lineHeight = u_global_height * (-4.0*segmentRatio*segmentRatio + 4.0 * segmentRatio) * lnglatLength;
    // \u5730\u7403\u70B9\u4F4D
    vec3 globalPoint = normalize(mix(startLngLat, endLngLat, segmentRatio)) * (globalRadius + lineHeight) + lnglatOffset * a_Size;
    
    gl_Position = u_ViewProjectionMatrix * vec4(globalPoint, 1.0);
  }
 

  setPickingColor(a_PickingColor);
}
`,XS=`
#define Animate 0.0
uniform float u_time;
uniform vec4 u_animate: [ 1., 2., 1.0, 0.2 ];
varying vec4 v_Color;

varying float v_distance_ratio;
#pragma include "picking"

void main() {

  float animateSpeed = 0.0; // \u8FD0\u52A8\u901F\u5EA6
  gl_FragColor = v_Color;

  if(u_animate.x == Animate) {
      animateSpeed = u_time / u_animate.y;
      float alpha =1.0 - fract( mod(1.0- v_distance_ratio, u_animate.z)* (1.0/ u_animate.z) + u_time / u_animate.y);

      alpha = (alpha + u_animate.w -1.0) / u_animate.w;
      // alpha = smoothstep(0., 1., alpha);
      alpha = clamp(alpha, 0.0, 1.0);
      gl_FragColor.a *= alpha;

      // u_animate 
      // x enable
      // y duration
      // z interval
      // w trailLength
  }

  gl_FragColor = filterColor(gl_FragColor);
}
`,QS=`#define LineTypeSolid 0.0
#define LineTypeDash 1.0
#define Animate 0.0
#define LineTexture 1.0
attribute vec3 a_Position;
attribute vec4 a_Instance;
attribute vec4 a_Color;
attribute float a_Size;
attribute vec2 a_iconMapUV;

uniform float u_globel;
uniform float u_globel_radius;
uniform float u_global_height: 10;
uniform mat4 u_ModelMatrix;

uniform float segmentNumber;
uniform vec4 u_animate: [ 1., 2., 1.0, 0.2 ];
uniform vec4 u_sourceColor;
uniform vec4 u_targetColor;

uniform float u_line_type: 0.0;
uniform vec4 u_dash_array: [10.0, 5., 0, 0];
uniform float u_icon_step: 100;
uniform float u_line_texture: 0.0;
varying float v_distance_ratio;

varying vec4 v_dash_array;
varying vec4 v_color;
varying vec2 v_iconMapUV;
varying vec4 v_Color;

#pragma include "projection"
#pragma include "project"
#pragma include "picking"

float maps (float value, float start1, float stop1, float start2, float stop2) {
  return start2 + (stop2 - start2) * ((value - start1) / (stop1 - start1));
}

float getSegmentRatio(float index) {
  return smoothstep(0.0, 1.0, index / (segmentNumber - 1.0));
}

float paraboloid(vec2 source, vec2 target, float ratio) {
  vec2 x = mix(source, target, ratio);
  vec2 center = mix(source, target, 0.5);
  float dSourceCenter = distance(source, center);
  float dXCenter = distance(x, center);
  return (dSourceCenter + dXCenter) * (dSourceCenter - dXCenter);
}

vec3 getPos(vec2 source, vec2 target, float segmentRatio) {
  float vertex_height = paraboloid(source, target, segmentRatio);

  return vec3(
    mix(source, target, segmentRatio),
    sqrt(max(0.0, vertex_height))
  );
}
vec2 getExtrusionOffset(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
  dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);

  vec2 offset = dir_screenspace * offset_direction * setPickingSize(a_Size) / 2.0;

  return offset;
}
vec2 getNormal(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
  dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
  return reverse_offset_normal(vec3(dir_screenspace,1.0)).xy * sign(offset_direction);
}

float torad(float deg) {
  return (deg / 180.0) * acos(-1.0);
}

vec3 lglt2xyz(vec2 lnglat) {
  float pi = 3.1415926;
  // + Math.PI/2 \u662F\u4E3A\u4E86\u5BF9\u9F50\u5750\u6807
  float lng = torad(lnglat.x) + pi / 2.0;
  float lat = torad(lnglat.y);

  // \u624B\u52A8\u589E\u52A0\u4E00\u4E9B\u504F\u79FB\uFF0C\u51CF\u8F7B\u9762\u7684\u51B2\u7A81
  float radius = u_globel_radius;

  float z = radius * cos(lat) * cos(lng);
  float x = radius * cos(lat) * sin(lng);
  float y = radius * sin(lat);
  return vec3(x, y, z);
}

void main() {
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97

  v_color = a_Color;
  vec2 source = project_position(vec4(a_Instance.rg, 0, 0)).xy;
  vec2 target = project_position(vec4(a_Instance.ba, 0, 0)).xy;
  float segmentIndex = a_Position.x;
  float segmentRatio = getSegmentRatio(segmentIndex);
  float indexDir = mix(-1.0, 1.0, step(segmentIndex, 0.0));

  float d_distance_ratio;
   if(u_line_type == LineTypeDash) {
    d_distance_ratio = segmentIndex / segmentNumber;
    // float total_Distance = pixelDistance(a_Instance.rg, a_Instance.ba) / 2.0 * PI;
    vec2 s = source;
    vec2 t = target;
    
    if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
      s = unProjCustomCoord(source);
      t = unProjCustomCoord(target);
    }
    float total_Distance = pixelDistance(s, t) / 2.0 * PI;
    v_dash_array = pow(2.0, 20.0 - u_Zoom) * u_dash_array / (total_Distance / segmentNumber * segmentIndex);
  }
    if(u_animate.x == Animate) {
      v_distance_ratio = segmentIndex / segmentNumber;
  }


  float nextSegmentRatio = getSegmentRatio(segmentIndex + indexDir);
  vec3 curr = getPos(source, target, segmentRatio);
  vec3 next = getPos(source, target, nextSegmentRatio);
  vec2 offset = getExtrusionOffset((next.xy - curr.xy) * indexDir, a_Position.y);

  float animateSpeed = 0.0; // \u8FD0\u52A8\u901F\u5EA6
  v_Color = mix(u_sourceColor, u_targetColor, a_Position.x/segmentNumber);

  v_Color.a *= opacity;

  gl_Position = project_common_position_to_clipspace_v2(vec4(curr.xy + project_pixel(offset), curr.z, 1.0));

  // \u5730\u7403\u6A21\u5F0F
  if(u_globel > 0.0) {
    vec3 startLngLat = lglt2xyz(a_Instance.rg);
    vec3 endLngLat = lglt2xyz(a_Instance.ba);
    float globalRadius = length(startLngLat);

    vec3 lineDir = normalize(endLngLat - startLngLat);
    vec3 midPointDir = normalize((startLngLat + endLngLat)/2.0);

    // \u7EBF\u7684\u504F\u79FB
    vec3 lnglatOffset = cross(lineDir, midPointDir) * a_Position.y;
    // \u8BA1\u7B97\u8D77\u59CB\u70B9\u548C\u7EC8\u6B62\u70B9\u7684\u8DDD\u79BB
    float lnglatLength = length(a_Instance.rg - a_Instance.ba)/50.0;
    // \u8BA1\u7B97\u98DE\u7EBF\u5404\u4E2A\u8282\u70B9\u76F8\u5E94\u7684\u9AD8\u5EA6
    float lineHeight = u_global_height * (-4.0*segmentRatio*segmentRatio + 4.0 * segmentRatio) * lnglatLength;
    // \u5730\u7403\u70B9\u4F4D
    vec3 globalPoint = normalize(mix(startLngLat, endLngLat, segmentRatio)) * (globalRadius + lineHeight) + lnglatOffset * a_Size;
    
    gl_Position = u_ViewProjectionMatrix * vec4(globalPoint, 1.0);
  }
 

  setPickingColor(a_PickingColor);
}
`,qS={solid:0,dash:1},KS=function(e){(0,ke.Z)(t,e);var i=HS(t);function t(){var r;(0,ue.Z)(this,t);for(var n=arguments.length,a=new Array(n),u=0;u<n;u++)a[u]=arguments[u];return r=i.call.apply(i,[this].concat(a)),(0,Ce.Z)((0,bt.Z)(r),"updateTexture",function(){var f=r.rendererService.createTexture2D;if(r.texture){r.texture.update({data:r.iconService.getCanvas()}),r.layer.render();return}r.texture=f({data:r.iconService.getCanvas(),mag:Ge.NEAREST,min:Ge.NEAREST,premultiplyAlpha:!1,width:1024,height:r.iconService.canvasHeight||128})}),r}return(0,me.Z)(t,[{key:"getUninforms",value:function(){var n=this.layer.getLayerConfig(),a=n.sourceColor,u=n.targetColor,f=n.textureBlend,g=f===void 0?"normal":f,x=n.lineType,I=x===void 0?"solid":x,O=n.dashArray,B=O===void 0?[10,5]:O,W=n.lineTexture,he=W===void 0?!1:W,ae=n.iconStep,Se=ae===void 0?100:ae,Fe=n.segmentNumber,Qe=Fe===void 0?30:Fe,qe=n.globalArcHeight,yt=qe===void 0?10:qe;B.length===2&&B.push(0,0);var Et=0,Ot=[0,0,0,0],jt=[0,0,0,0];return a&&u&&(Ot=Ni(a),jt=Ni(u),Et=1),this.rendererService.getDirty()&&this.texture.bind(),(0,X.Z)({u_globel:this.mapService.version==="GLOBEL"?1:0,u_globel_radius:sg,u_global_height:yt,u_textureBlend:g==="normal"?0:1,segmentNumber:Qe,u_line_type:qS[I]||0,u_dash_array:B,u_texture:this.texture,u_line_texture:he?1:0,u_icon_step:Se,u_textSize:[1024,this.iconService.canvasHeight||128],u_linearColor:Et,u_sourceColor:Ot,u_targetColor:jt},this.getStyleAttribute())}},{key:"getAnimateUniforms",value:function(){var n=this.layer.getLayerConfig(),a=n.animateOption;return{u_animate:this.animateOption2Array(a),u_time:this.layer.getLayerAnimateTime()}}},{key:"initModels",value:function(){var r=(0,ur.Z)(nt().mark(function a(){return nt().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return this.updateTexture(),this.iconService.on("imageUpdate",this.updateTexture),f.abrupt("return",this.buildModels());case 3:case"end":return f.stop()}},a,this)}));function n(){return r.apply(this,arguments)}return n}()},{key:"clearModels",value:function(){var n;(n=this.texture)===null||n===void 0||n.destroy(),this.iconService.off("imageUpdate",this.updateTexture)}},{key:"getShaders",value:function(){var n=this.layer.getLayerConfig(),a=n.sourceColor,u=n.targetColor;return a&&u?{frag:XS,vert:QS,type:"Linear"}:{frag:WS,vert:YS,type:""}}},{key:"buildModels",value:function(){var r=(0,ur.Z)(nt().mark(function a(){var u,f,g,x,I,O,B,W;return nt().wrap(function(ae){for(;;)switch(ae.prev=ae.next){case 0:return u=this.layer.getLayerConfig(),f=u.segmentNumber,g=f===void 0?30:f,x=this.getShaders(),I=x.frag,O=x.vert,B=x.type,ae.next=4,this.layer.buildLayerModel({moduleName:"lineArc3d"+B,vertexShader:O,fragmentShader:I,inject:this.getInject(),triangulation:Dd,segmentNumber:g});case 4:return W=ae.sent,ae.abrupt("return",[W]);case 6:case"end":return ae.stop()}},a,this)}));function n(){return r.apply(this,arguments)}return n}()},{key:"registerBuiltinAttributes",value:function(){var n=this;this.styleAttributeService.registerStyleAttribute({name:"size",type:mn.Attribute,descriptor:{name:"a_Size",buffer:{usage:Ge.DYNAMIC_DRAW,data:[],type:Ge.FLOAT},size:1,update:function(u){var f=u.size,g=f===void 0?1:f;return Array.isArray(g)?[g[0]]:[g]}}}),this.styleAttributeService.registerStyleAttribute({name:"instance",type:mn.Attribute,descriptor:{name:"a_Instance",buffer:{usage:Ge.STATIC_DRAW,data:[],type:Ge.FLOAT},size:4,update:function(u,f,g){return[g[3],g[4],g[5],g[6]]}}}),this.styleAttributeService.registerStyleAttribute({name:"uv",type:mn.Attribute,descriptor:{name:"a_iconMapUV",buffer:{usage:Ge.DYNAMIC_DRAW,data:[],type:Ge.FLOAT},size:2,update:function(u){var f=n.iconService.getIconMap(),g=u.texture,x=f[g]||{x:0,y:0},I=x.x,O=x.y;return[I,O]}}})}}]),t}(vo);function JS(e){var i=eC();return function(){var r=(0,oe.Z)(e),n;if(i){var a=(0,oe.Z)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return(0,Ze.Z)(this,n)}}function eC(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var tC=`#define LineTypeSolid 0.0
#define LineTypeDash 1.0
#define Animate 0.0
#define LineTexture 1.0

uniform float u_textureBlend;
uniform float u_blur : 0.9;
uniform float u_line_type: 0.0;
// varying vec2 v_normal;
varying vec4 v_dash_array;
varying vec4 v_color;
varying vec4 v_line_data;

uniform float u_line_texture: 0.0;
uniform sampler2D u_texture;
uniform vec2 u_textSize;
varying float v_segmentIndex;
uniform float segmentNumber;


varying vec2 v_iconMapUV;

uniform float u_time;
uniform vec4 u_animate: [ 1., 2., 1.0, 0.2 ];


#pragma include "picking"

void main() {
  float animateSpeed = 0.0; // \u8FD0\u52A8\u901F\u5EA6
  float d_distance_ratio = v_line_data.g; // \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B
  gl_FragColor = v_color;

  if(u_line_type == LineTypeDash) {
    float flag = 0.;
    float dashLength = mod(d_distance_ratio, v_dash_array.x + v_dash_array.y + v_dash_array.z + v_dash_array.w);
    if(dashLength < v_dash_array.x || (dashLength > (v_dash_array.x + v_dash_array.y) && dashLength <  v_dash_array.x + v_dash_array.y + v_dash_array.z)) {
      flag = 1.;
    }
    gl_FragColor.a *=flag;
  }

  if(u_animate.x == Animate && u_line_texture != LineTexture) {
      animateSpeed = u_time / u_animate.y;
      float alpha =1.0 - fract( mod(1.0- d_distance_ratio, u_animate.z)* (1.0/ u_animate.z) + u_time / u_animate.y);

      alpha = (alpha + u_animate.w -1.0) / u_animate.w;
      // alpha = smoothstep(0., 1., alpha);
      alpha = clamp(alpha, 0.0, 1.0);
      gl_FragColor.a *= alpha;

      // u_animate 
      // x enable
      // y duration
      // z interval
      // w trailLength
  }

  if(u_line_texture == LineTexture && u_line_type != LineTypeDash) { // while load texture
    // float arcRadio = smoothstep( 0.0, 1.0, (v_segmentIndex / segmentNumber));
    float arcRadio = v_segmentIndex / (segmentNumber - 1.0);
    float count = v_line_data.b; // // \u8D34\u56FE\u5728\u5F27\u7EBF\u4E0A\u91CD\u590D\u7684\u6570\u91CF

    float time = 0.0;
    if(u_animate.x == Animate) {
      time = u_time / u_animate.y;
    }
    float redioCount = arcRadio * count;

    float u = fract(redioCount - time);

    float v = v_line_data.a;  // \u7EBF\u56FE\u5C42\u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\u503C
    vec2 uv= v_iconMapUV / u_textSize + vec2(u, v) / u_textSize * 64.;
    vec4 pattern = texture2D(u_texture, uv);

    if(u_animate.x == Animate) {
      float currentPlane = floor(redioCount - time);
      float textureStep = floor(count * u_animate.z);
      float a = mod(currentPlane, textureStep);
      if(a < textureStep - 1.0) {
        pattern = vec4(0.0);
      }
    }

    if(u_textureBlend == 0.0) { // normal
      pattern.a = 0.0;
      gl_FragColor = filterColor(gl_FragColor + pattern);
    } else { // replace
        pattern.a *= v_color.a;
        if(gl_FragColor.a <= 0.0) {
          pattern.a = 0.0;
          discard;
        } else {
          gl_FragColor = filterColor(pattern);
        }
    }

  } else {
    gl_FragColor = filterColor(gl_FragColor);
  }
}
`,rC=`#define LineTypeSolid 0.0
#define LineTypeDash 1.0
#define Animate 0.0
#define LineTexture 1.0
attribute vec3 a_Position;
attribute vec4 a_Instance;
attribute vec4 a_Color;
attribute float a_Size;

uniform float u_globel;
uniform float u_globel_radius;
uniform float u_global_height: 10;
uniform mat4 u_ModelMatrix;

uniform float segmentNumber;
uniform vec4 u_animate: [ 1., 2., 1.0, 0.2 ];
varying vec4 v_color;

uniform float u_line_type: 0.0;
uniform vec4 u_dash_array: [10.0, 5., 0, 0];
varying vec4 v_dash_array;

uniform float u_icon_step: 100;
uniform float u_line_texture: 0.0;
varying float v_segmentIndex;

attribute vec2 a_iconMapUV;
varying vec2 v_iconMapUV;
varying vec4 v_line_data;

#pragma include "projection"
#pragma include "project"
#pragma include "picking"

float maps (float value, float start1, float stop1, float start2, float stop2) {
  return start2 + (stop2 - start2) * ((value - start1) / (stop1 - start1));
}

float getSegmentRatio(float index) {
  return smoothstep(0.0, 1.0, index / (segmentNumber - 1.0));
}

float paraboloid(vec2 source, vec2 target, float ratio) {
  vec2 x = mix(source, target, ratio);
  vec2 center = mix(source, target, 0.5);
  float dSourceCenter = distance(source, center);
  float dXCenter = distance(x, center);
  return (dSourceCenter + dXCenter) * (dSourceCenter - dXCenter);
}

vec3 getPos(vec2 source, vec2 target, float segmentRatio) {
  float vertex_height = paraboloid(source, target, segmentRatio);

  return vec3(
    mix(source, target, segmentRatio),
    sqrt(max(0.0, vertex_height))
  );
}
vec2 getExtrusionOffset(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
  dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);

  vec2 offset = dir_screenspace * offset_direction * setPickingSize(a_Size) / 2.0;

  return offset;
}
vec2 getNormal(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
  dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
  return reverse_offset_normal(vec3(dir_screenspace,1.0)).xy * sign(offset_direction);
}

float torad(float deg) {
  return (deg / 180.0) * acos(-1.0);
}

vec3 lglt2xyz(vec2 lnglat) {
  float pi = 3.1415926;
  // + Math.PI/2 \u662F\u4E3A\u4E86\u5BF9\u9F50\u5750\u6807
  float lng = torad(lnglat.x) + pi / 2.0;
  float lat = torad(lnglat.y);

  // \u624B\u52A8\u589E\u52A0\u4E00\u4E9B\u504F\u79FB\uFF0C\u51CF\u8F7B\u9762\u7684\u51B2\u7A81
  float radius = u_globel_radius;

  float z = radius * cos(lat) * cos(lng);
  float x = radius * cos(lat) * sin(lng);
  float y = radius * sin(lat);
  return vec3(x, y, z);
}

void main() {

  v_color = a_Color;
  v_color.a = v_color.a * opacity;
  vec2 source = project_position(vec4(a_Instance.rg, 0, 0)).xy;
  vec2 target = project_position(vec4(a_Instance.ba, 0, 0)).xy;
  float segmentIndex = a_Position.x;
  float segmentRatio = getSegmentRatio(segmentIndex);
  float indexDir = mix(-1.0, 1.0, step(segmentIndex, 0.0));

  float d_distance_ratio;
   if(u_line_type == LineTypeDash) {
    d_distance_ratio = segmentIndex / segmentNumber;
    vec2 s = source;
    vec2 t = target;
    
    if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
      s = unProjCustomCoord(source);
      t = unProjCustomCoord(target);
    }
    float total_Distance = pixelDistance(s, t) / 2.0 * PI;
    v_dash_array = pow(2.0, 20.0 - u_Zoom) * u_dash_array / (total_Distance / segmentNumber * segmentIndex);
  }
    if(u_animate.x == Animate) {
      d_distance_ratio = segmentIndex / segmentNumber;
  }
  v_line_data.g = d_distance_ratio; // \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B

  float nextSegmentRatio = getSegmentRatio(segmentIndex + indexDir);
  vec3 curr = getPos(source, target, segmentRatio);
  vec3 next = getPos(source, target, nextSegmentRatio);
  vec2 offset = getExtrusionOffset((next.xy - curr.xy) * indexDir, a_Position.y);
  // v_normal = getNormal((next.xy - curr.xy) * indexDir, a_Position.y);


  v_segmentIndex = a_Position.x;
  if(LineTexture == u_line_texture && u_line_type != LineTypeDash) { // \u5F00\u542F\u8D34\u56FE\u6A21\u5F0F  

    float arcDistrance = length(source - target);
    float pixelLen =  project_pixel_texture(u_icon_step);
    v_line_data.b = floor(arcDistrance/pixelLen); // \u8D34\u56FE\u5728\u5F27\u7EBF\u4E0A\u91CD\u590D\u7684\u6570\u91CF

    vec2 projectOffset = project_pixel(offset);
    float lineOffsetWidth = length(projectOffset + projectOffset * sign(a_Position.y)); // \u7EBF\u6A2A\u5411\u504F\u79FB\u7684\u8DDD\u79BB
    float linePixelSize = project_pixel(a_Size);  // \u5B9A\u70B9\u4F4D\u7F6E\u504F\u79FB\uFF0C\u6309\u5730\u56FE\u7B49\u7EA7\u7F29\u653E\u540E\u7684\u8DDD\u79BB
    v_line_data.a = lineOffsetWidth/linePixelSize;  // \u7EBF\u56FE\u5C42\u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\u503C

    v_iconMapUV = a_iconMapUV;
  }


  gl_Position = project_common_position_to_clipspace_v2(vec4(curr.xy + project_pixel(offset), curr.z * thetaOffset, 1.0));

  // \u5730\u7403\u6A21\u5F0F
  if(u_globel > 0.0) {
    vec3 startLngLat = lglt2xyz(a_Instance.rg);
    vec3 endLngLat = lglt2xyz(a_Instance.ba);
    float globalRadius = length(startLngLat);

    vec3 lineDir = normalize(endLngLat - startLngLat);
    vec3 midPointDir = normalize((startLngLat + endLngLat)/2.0);

    // \u7EBF\u7684\u504F\u79FB
    vec3 lnglatOffset = cross(lineDir, midPointDir) * a_Position.y;
    // \u8BA1\u7B97\u8D77\u59CB\u70B9\u548C\u7EC8\u6B62\u70B9\u7684\u8DDD\u79BB
    float lnglatLength = length(a_Instance.rg - a_Instance.ba)/50.0;
    // \u8BA1\u7B97\u98DE\u7EBF\u5404\u4E2A\u8282\u70B9\u76F8\u5E94\u7684\u9AD8\u5EA6
    float lineHeight = u_global_height * (-4.0*segmentRatio*segmentRatio + 4.0 * segmentRatio) * lnglatLength;
    // \u5730\u7403\u70B9\u4F4D
    vec3 globalPoint = normalize(mix(startLngLat, endLngLat, segmentRatio)) * (globalRadius + lineHeight) + lnglatOffset * a_Size;
    
    gl_Position = u_ViewProjectionMatrix * vec4(globalPoint, 1.0);
  }
 

  setPickingColor(a_PickingColor);
}
`,nC=`
#define Animate 0.0
uniform float u_time;
uniform vec4 u_animate: [ 1., 2., 1.0, 0.2 ];
varying vec4 v_Color;

varying float v_distance_ratio;
#pragma include "picking"

void main() {

  float animateSpeed = 0.0; // \u8FD0\u52A8\u901F\u5EA6
  gl_FragColor = v_Color;

  if(u_animate.x == Animate) {
      animateSpeed = u_time / u_animate.y;
      float alpha =1.0 - fract( mod(1.0- v_distance_ratio, u_animate.z)* (1.0/ u_animate.z) + u_time / u_animate.y);

      alpha = (alpha + u_animate.w -1.0) / u_animate.w;
      // alpha = smoothstep(0., 1., alpha);
      alpha = clamp(alpha, 0.0, 1.0);
      gl_FragColor.a *= alpha;

      // u_animate 
      // x enable
      // y duration
      // z interval
      // w trailLength
  }

  gl_FragColor = filterColor(gl_FragColor);
}
`,iC=`#define LineTypeSolid 0.0
#define LineTypeDash 1.0
#define Animate 0.0
#define LineTexture 1.0
attribute vec3 a_Position;
attribute vec4 a_Instance;
attribute vec4 a_Color;
attribute float a_Size;
attribute vec2 a_iconMapUV;

uniform float u_globel;
uniform float u_globel_radius;
uniform float u_global_height: 10;
uniform mat4 u_ModelMatrix;

uniform float segmentNumber;
uniform vec4 u_animate: [ 1., 2., 1.0, 0.2 ];
uniform vec4 u_sourceColor;
uniform vec4 u_targetColor;

uniform float u_line_type: 0.0;
uniform vec4 u_dash_array: [10.0, 5., 0, 0];
uniform float u_icon_step: 100;
uniform float u_line_texture: 0.0;
varying float v_distance_ratio;

varying vec4 v_dash_array;
varying vec4 v_color;
varying vec2 v_iconMapUV;
varying vec4 v_Color;

#pragma include "projection"
#pragma include "project"
#pragma include "picking"

float maps (float value, float start1, float stop1, float start2, float stop2) {
  return start2 + (stop2 - start2) * ((value - start1) / (stop1 - start1));
}

float getSegmentRatio(float index) {
  return smoothstep(0.0, 1.0, index / (segmentNumber - 1.0));
}

float paraboloid(vec2 source, vec2 target, float ratio) {
  vec2 x = mix(source, target, ratio);
  vec2 center = mix(source, target, 0.5);
  float dSourceCenter = distance(source, center);
  float dXCenter = distance(x, center);
  return (dSourceCenter + dXCenter) * (dSourceCenter - dXCenter);
}

vec3 getPos(vec2 source, vec2 target, float segmentRatio) {
  float vertex_height = paraboloid(source, target, segmentRatio);

  return vec3(
    mix(source, target, segmentRatio),
    sqrt(max(0.0, vertex_height))
  );
}
vec2 getExtrusionOffset(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
  dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);

  vec2 offset = dir_screenspace * offset_direction * setPickingSize(a_Size) / 2.0;

  return offset;
}
vec2 getNormal(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
  dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
  return reverse_offset_normal(vec3(dir_screenspace,1.0)).xy * sign(offset_direction);
}

float torad(float deg) {
  return (deg / 180.0) * acos(-1.0);
}

vec3 lglt2xyz(vec2 lnglat) {
  float pi = 3.1415926;
  // + Math.PI/2 \u662F\u4E3A\u4E86\u5BF9\u9F50\u5750\u6807
  float lng = torad(lnglat.x) + pi / 2.0;
  float lat = torad(lnglat.y);

  // \u624B\u52A8\u589E\u52A0\u4E00\u4E9B\u504F\u79FB\uFF0C\u51CF\u8F7B\u9762\u7684\u51B2\u7A81
  float radius = u_globel_radius;

  float z = radius * cos(lat) * cos(lng);
  float x = radius * cos(lat) * sin(lng);
  float y = radius * sin(lat);
  return vec3(x, y, z);
}

void main() {
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97

  v_color = a_Color;
  vec2 source = project_position(vec4(a_Instance.rg, 0, 0)).xy;
  vec2 target = project_position(vec4(a_Instance.ba, 0, 0)).xy;
  float segmentIndex = a_Position.x;
  float segmentRatio = getSegmentRatio(segmentIndex);
  float indexDir = mix(-1.0, 1.0, step(segmentIndex, 0.0));

  float d_distance_ratio;
   if(u_line_type == LineTypeDash) {
    d_distance_ratio = segmentIndex / segmentNumber;
    // float total_Distance = pixelDistance(a_Instance.rg, a_Instance.ba) / 2.0 * PI;
    vec2 s = source;
    vec2 t = target;
    
    if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
      s = unProjCustomCoord(source);
      t = unProjCustomCoord(target);
    }
    float total_Distance = pixelDistance(s, t) / 2.0 * PI;
    v_dash_array = pow(2.0, 20.0 - u_Zoom) * u_dash_array / (total_Distance / segmentNumber * segmentIndex);
  }
    if(u_animate.x == Animate) {
      v_distance_ratio = segmentIndex / segmentNumber;
  }


  float nextSegmentRatio = getSegmentRatio(segmentIndex + indexDir);
  vec3 curr = getPos(source, target, segmentRatio);
  vec3 next = getPos(source, target, nextSegmentRatio);
  vec2 offset = getExtrusionOffset((next.xy - curr.xy) * indexDir, a_Position.y);

  float animateSpeed = 0.0; // \u8FD0\u52A8\u901F\u5EA6
  v_Color = mix(u_sourceColor, u_targetColor, a_Position.x/segmentNumber);

  v_Color.a *= opacity;

  gl_Position = project_common_position_to_clipspace_v2(vec4(curr.xy + project_pixel(offset), curr.z, 1.0));

  // \u5730\u7403\u6A21\u5F0F
  if(u_globel > 0.0) {
    vec3 startLngLat = lglt2xyz(a_Instance.rg);
    vec3 endLngLat = lglt2xyz(a_Instance.ba);
    float globalRadius = length(startLngLat);

    vec3 lineDir = normalize(endLngLat - startLngLat);
    vec3 midPointDir = normalize((startLngLat + endLngLat)/2.0);

    // \u7EBF\u7684\u504F\u79FB
    vec3 lnglatOffset = cross(lineDir, midPointDir) * a_Position.y;
    // \u8BA1\u7B97\u8D77\u59CB\u70B9\u548C\u7EC8\u6B62\u70B9\u7684\u8DDD\u79BB
    float lnglatLength = length(a_Instance.rg - a_Instance.ba)/50.0;
    // \u8BA1\u7B97\u98DE\u7EBF\u5404\u4E2A\u8282\u70B9\u76F8\u5E94\u7684\u9AD8\u5EA6
    float lineHeight = u_global_height * (-4.0*segmentRatio*segmentRatio + 4.0 * segmentRatio) * lnglatLength;
    // \u5730\u7403\u70B9\u4F4D
    vec3 globalPoint = normalize(mix(startLngLat, endLngLat, segmentRatio)) * (globalRadius + lineHeight) + lnglatOffset * a_Size;
    
    gl_Position = u_ViewProjectionMatrix * vec4(globalPoint, 1.0);
  }
 

  setPickingColor(a_PickingColor);
}
`,aC={solid:0,dash:1},oC=function(e){(0,ke.Z)(t,e);var i=JS(t);function t(){var r;(0,ue.Z)(this,t);for(var n=arguments.length,a=new Array(n),u=0;u<n;u++)a[u]=arguments[u];return r=i.call.apply(i,[this].concat(a)),(0,Ce.Z)((0,bt.Z)(r),"updateTexture",function(){var f=r.rendererService.createTexture2D;if(r.texture){r.texture.update({data:r.iconService.getCanvas()}),r.layer.render();return}r.texture=f({data:r.iconService.getCanvas(),mag:Ge.NEAREST,min:Ge.NEAREST,premultiplyAlpha:!1,width:1024,height:r.iconService.canvasHeight||128})}),r}return(0,me.Z)(t,[{key:"getUninforms",value:function(){var n=this.layer.getLayerConfig(),a=n.opacity,u=a===void 0?1:a,f=n.sourceColor,g=n.targetColor,x=n.textureBlend,I=x===void 0?"normal":x,O=n.lineType,B=O===void 0?"solid":O,W=n.dashArray,he=W===void 0?[10,5]:W,ae=n.lineTexture,Se=ae===void 0?!1:ae,Fe=n.iconStep,Qe=Fe===void 0?100:Fe,qe=n.segmentNumber,yt=qe===void 0?30:qe,Et=n.globalArcHeight,Ot=Et===void 0?10:Et;he.length===2&&he.push(0,0);var jt=0,or=[0,0,0,0],ar=[0,0,0,0];return f&&g&&(or=Ni(f),ar=Ni(g),jt=1),this.rendererService.getDirty()&&this.texture.bind(),{u_globel:1,u_globel_radius:sg,u_global_height:Ot,u_opacity:u,u_textureBlend:I==="normal"?0:1,segmentNumber:yt,u_line_type:aC[B]||0,u_dash_array:he,u_texture:this.texture,u_line_texture:Se?1:0,u_icon_step:Qe,u_textSize:[1024,this.iconService.canvasHeight||128],u_linearColor:jt,u_sourceColor:or,u_targetColor:ar}}},{key:"getAnimateUniforms",value:function(){var n=this.layer.getLayerConfig(),a=n.animateOption;return{u_animate:this.animateOption2Array(a),u_time:this.layer.getLayerAnimateTime()}}},{key:"initModels",value:function(){var r=(0,ur.Z)(nt().mark(function a(){return nt().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return this.updateTexture(),this.iconService.on("imageUpdate",this.updateTexture),f.abrupt("return",this.buildModels());case 3:case"end":return f.stop()}},a,this)}));function n(){return r.apply(this,arguments)}return n}()},{key:"clearModels",value:function(){var n;(n=this.texture)===null||n===void 0||n.destroy(),this.iconService.off("imageUpdate",this.updateTexture)}},{key:"getShaders",value:function(){var n=this.layer.getLayerConfig(),a=n.sourceColor,u=n.targetColor;return a&&u?{frag:nC,vert:iC,type:"Linear"}:{frag:tC,vert:rC,type:""}}},{key:"buildModels",value:function(){var r=(0,ur.Z)(nt().mark(function a(){var u,f,g,x,I,O,B,W;return nt().wrap(function(ae){for(;;)switch(ae.prev=ae.next){case 0:return u=this.layer.getLayerConfig(),f=u.segmentNumber,g=f===void 0?30:f,x=this.getShaders(),I=x.frag,O=x.vert,B=x.type,ae.next=4,this.layer.buildLayerModel({moduleName:"lineEarthArc3d"+B,vertexShader:O,fragmentShader:I,triangulation:Dd,depth:{enable:!0},segmentNumber:g});case 4:return W=ae.sent,ae.abrupt("return",[W]);case 6:case"end":return ae.stop()}},a,this)}));function n(){return r.apply(this,arguments)}return n}()},{key:"registerBuiltinAttributes",value:function(){var n=this;this.styleAttributeService.registerStyleAttribute({name:"size",type:mn.Attribute,descriptor:{name:"a_Size",buffer:{usage:Ge.DYNAMIC_DRAW,data:[],type:Ge.FLOAT},size:1,update:function(u){var f=u.size,g=f===void 0?1:f;return Array.isArray(g)?[g[0]]:[g]}}}),this.styleAttributeService.registerStyleAttribute({name:"instance",type:mn.Attribute,descriptor:{name:"a_Instance",buffer:{usage:Ge.STATIC_DRAW,data:[],type:Ge.FLOAT},size:4,update:function(u,f,g){return[g[3],g[4],g[5],g[6]]}}}),this.styleAttributeService.registerStyleAttribute({name:"uv",type:mn.Attribute,descriptor:{name:"a_iconMapUV",buffer:{usage:Ge.DYNAMIC_DRAW,data:[],type:Ge.FLOAT},size:2,update:function(u){var f=n.iconService.getIconMap(),g=u.texture,x=f[g]||{x:0,y:0},I=x.x,O=x.y;return[I,O]}}})}}]),t}(vo);function sC(e){var i=uC();return function(){var r=(0,oe.Z)(e),n;if(i){var a=(0,oe.Z)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return(0,Ze.Z)(this,n)}}function uC(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var lC=`#extension GL_OES_standard_derivatives : enable

varying vec4 v_color;


// line texture

#pragma include "picking"

void main() {
gl_FragColor = v_color;
gl_FragColor = filterColor(gl_FragColor);
}
`,cC=`attribute vec4 a_Color;
attribute vec2 a_Size;
attribute vec4 a_Instance;
attribute vec3 a_Normal;
attribute vec3 a_Position;

uniform mat4 u_ModelMatrix;


#pragma include "projection"
#pragma include "picking"
varying vec4 v_color;
uniform float u_gap_width: 1.0;
uniform float u_stroke_width: 1.0;
uniform float u_stroke_opacity: 1.0;


void main() {

// \u900F\u660E\u5EA6\u8BA1\u7B97
  vec2 source = a_Instance.rg;  // \u8D77\u59CB\u70B9
  vec2 target =  a_Instance.ba; // \u7EC8\u70B9
  vec2 flowlineDir = normalize(target - source);
  vec2 perpendicularDir = vec2(-flowlineDir.y, flowlineDir.x);


  vec2 position = mix(source, target, a_Position.x);
  
  float lengthCommon = length(project_position(vec4(target,0,1)) - project_position(vec4(source,0,1)));  //    
  vec2 offsetDistances = a_Size.x * project_pixel(a_Position.yz);
  vec2 limitedOffsetDistances = clamp(   
   offsetDistances,
   project_pixel(-lengthCommon*.8), project_pixel(lengthCommon*.8)
  );


  float startOffsetCommon = project_pixel(offsets[0]);
  float endOffsetCommon = project_pixel(offsets[1]);
  float endpointOffset = mix(
    clamp(startOffsetCommon, 0.0, lengthCommon*.2),
    -clamp(endOffsetCommon, 0.0, lengthCommon*.2),
    a_Position.x
  );

  vec2 normalsCommon =  u_stroke_width * project_pixel(a_Normal.xy);

  float gapCommon =  project_pixel(u_gap_width);
  vec3 offsetCommon = vec3(
    flowlineDir * (limitedOffsetDistances[1] + normalsCommon.y + endpointOffset * 1.05) -
    perpendicularDir * (limitedOffsetDistances[0] + gapCommon + normalsCommon.x),
    0.0
  );


  vec4 project_pos = project_position(vec4(position.xy, 0, 1.0));

  vec4 fillColor = vec4(a_Color.rgb, a_Color.a * opacity);
  v_color = mix(fillColor, vec4(u_stroke.xyz, u_stroke.w * fillColor.w * u_stroke_opacity), a_Normal.z);

  gl_Position = project_common_position_to_clipspace_v2(vec4(project_pos.xy + offsetCommon.xy, 0., 1.0));



  setPickingColor(a_PickingColor);
}
`,fC=function(e){(0,ke.Z)(t,e);var i=sC(t);function t(){return(0,ue.Z)(this,t),i.apply(this,arguments)}return(0,me.Z)(t,[{key:"getUninforms",value:function(){var n=this.layer.getLayerConfig(),a=n.gapWidth,u=a===void 0?2:a,f=n.strokeWidth,g=f===void 0?1:f,x=n.stroke,I=x===void 0?"#000":x,O=n.strokeOpacity,B=O===void 0?1:O;return(0,X.Z)({u_gap_width:u,u_stroke_width:g,u_stroke:Ni(I),u_stroke_opacity:B},this.getStyleAttribute())}},{key:"initModels",value:function(){var r=(0,ur.Z)(nt().mark(function a(){return nt().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return f.abrupt("return",this.buildModels());case 1:case"end":return f.stop()}},a,this)}));function n(){return r.apply(this,arguments)}return n}()},{key:"buildModels",value:function(){var r=(0,ur.Z)(nt().mark(function a(){var u;return nt().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return g.next=2,this.layer.buildLayerModel({moduleName:"flow_line",vertexShader:cC,fragmentShader:lC,inject:this.getInject(),triangulation:wS,primitive:Ge.TRIANGLES,depth:{enable:!1},pick:!1});case 2:return u=g.sent,g.abrupt("return",[u]);case 4:case"end":return g.stop()}},a,this)}));function n(){return r.apply(this,arguments)}return n}()},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"size",type:mn.Attribute,descriptor:{name:"a_Size",buffer:{usage:Ge.DYNAMIC_DRAW,data:[],type:Ge.FLOAT},size:2,update:function(a){var u=a.size,f=u===void 0?1:u;return Array.isArray(f)?[f[0],f[1]]:[f,0]}}}),this.styleAttributeService.registerStyleAttribute({name:"instance",type:mn.Attribute,descriptor:{name:"a_Instance",buffer:{usage:Ge.STATIC_DRAW,data:[],type:Ge.FLOAT},size:4,update:function(a,u,f){return[f[3],f[4],f[5],f[6]]}}}),this.styleAttributeService.registerStyleAttribute({name:"normal",type:mn.Attribute,descriptor:{name:"a_Normal",buffer:{usage:Ge.STATIC_DRAW,data:[],type:Ge.FLOAT},size:3,update:function(a,u,f,g,x){return x}}})}}]),t}(vo);function hC(e){var i=AC();return function(){var r=(0,oe.Z)(e),n;if(i){var a=(0,oe.Z)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return(0,Ze.Z)(this,n)}}function AC(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var pC=`#define LineTypeSolid 0.0
#define LineTypeDash 1.0
#define Animate 0.0
#define LineTexture 1.0

uniform float u_textureBlend;
uniform float u_blur : 0.9;
uniform float u_line_type: 0.0;
// varying vec2 v_normal;
varying vec4 v_dash_array;
varying float v_distance_ratio;
varying vec4 v_color;

uniform float u_time;
uniform vec4 u_animate: [ 1., 2., 1.0, 0.2 ];

uniform float u_line_texture: 0.0;
uniform sampler2D u_texture;
uniform vec2 u_textSize;
uniform float segmentNumber;

varying vec2 v_iconMapUV;

uniform float u_linearColor: 0;
uniform vec4 u_sourceColor;
uniform vec4 u_targetColor;
varying vec4 v_line_data;

#pragma include "picking"
#pragma include "project"
#pragma include "projection"

void main() {

  float animateSpeed = 0.0;
  float d_segmentIndex = v_line_data.g;
  
  // \u8BBE\u7F6E\u5F27\u7EBF\u7684\u5E95\u8272
  if(u_linearColor == 1.0) { // \u4F7F\u7528\u6E10\u53D8\u989C\u8272
    gl_FragColor = mix(u_sourceColor, u_targetColor, d_segmentIndex/segmentNumber);
     gl_FragColor.a *= v_color.a;
  } else { // \u4F7F\u7528 color \u65B9\u6CD5\u4F20\u5165\u7684\u989C\u8272
     gl_FragColor = v_color;
  }

  // float blur = 1.- smoothstep(u_blur, 1., length(v_normal.xy));
  // float blur = smoothstep(1.0, u_blur, length(v_normal.xy));
  if(u_line_type == LineTypeDash) {
    float dashLength = mod(v_distance_ratio, v_dash_array.x + v_dash_array.y + v_dash_array.z + v_dash_array.w);
    if(dashLength < v_dash_array.x || (dashLength > (v_dash_array.x + v_dash_array.y) && dashLength <  v_dash_array.x + v_dash_array.y + v_dash_array.z)) {
      // \u5B9E\u7EBF\u90E8\u5206
    } else {
      // \u865A\u7EBF\u90E8\u5206
      discard;
    };
  }

  // \u8BBE\u7F6E\u5F27\u7EBF\u7684\u52A8\u753B\u6A21\u5F0F
  if(u_animate.x == Animate) {
      animateSpeed = u_time / u_animate.y;
      float alpha =1.0 - fract( mod(1.0- v_distance_ratio, u_animate.z)* (1.0/ u_animate.z) + u_time / u_animate.y);
      alpha = (alpha + u_animate.w -1.0) / u_animate.w;
      alpha = smoothstep(0., 1., alpha);
      gl_FragColor.a *= alpha;
  }

  // \u8BBE\u7F6E\u5F27\u7EBF\u7684\u8D34\u56FE
  if(LineTexture == u_line_texture && u_line_type != LineTypeDash) { 
    float arcRadio = smoothstep( 0.0, 1.0, (d_segmentIndex / (segmentNumber - 1.0)));
    // float arcRadio = d_segmentIndex / (segmentNumber - 1.0);
    float count = v_line_data.b; // \u8D34\u56FE\u5728\u5F27\u7EBF\u4E0A\u91CD\u590D\u7684\u6570\u91CF
    float u = fract(arcRadio * count - animateSpeed * count);
    // float u = fract(arcRadio * count - animateSpeed);
    if(u_animate.x == Animate) {
      u = gl_FragColor.a/v_color.a;
    }

    float v = v_line_data.a; // \u7EBF\u56FE\u5C42\u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\u503C

    vec2 uv= v_iconMapUV / u_textSize + vec2(u, v) / u_textSize * 64.;
    vec4 pattern = texture2D(u_texture, uv);
    
    // \u8BBE\u7F6E\u8D34\u56FE\u548C\u5E95\u8272\u7684\u53E0\u52A0\u6A21\u5F0F
    if(u_textureBlend == 0.0) { // normal
      pattern.a = 0.0;
      gl_FragColor = filterColor(gl_FragColor + pattern);
    } else { // replace
        pattern.a *= v_color.a;
        if(gl_FragColor.a <= 0.0) {
          pattern.a = 0.0;
        }
        gl_FragColor = filterColor(pattern);
    }
  } else {
    gl_FragColor = filterColor(gl_FragColor);
  }

  // gl_FragColor = filterColor(gl_FragColor);
}`,dC=`#define LineTypeSolid 0.0
#define LineTypeDash 1.0
#define Animate 0.0
#define LineTexture 1.0

attribute vec4 a_Color;
attribute vec3 a_Position;
attribute vec4 a_Instance;
attribute float a_Size;
uniform mat4 u_ModelMatrix;

uniform float segmentNumber;
uniform vec4 u_animate: [ 1., 2., 1.0, 0.2 ];
varying vec4 v_color;

varying float v_distance_ratio;
uniform float u_line_type: 0.0;
uniform vec4 u_dash_array: [10.0, 5., 0, 0];
varying vec4 v_dash_array;

uniform float u_icon_step: 100;
uniform float u_line_texture: 0.0;

attribute vec2 a_iconMapUV;
varying vec2 v_iconMapUV;
varying vec4 v_line_data;


#pragma include "projection"
#pragma include "project"
#pragma include "picking"

float maps (float value, float start1, float stop1, float start2, float stop2) {
    return start2 + (stop2 - start2) * ((value - start1) / (stop1 - start1));
}

float getSegmentRatio(float index) {
    return index / (segmentNumber - 1.);
}

float paraboloid(vec2 source, vec2 target, float ratio) {
    vec2 x = mix(source, target, ratio);
    vec2 center = mix(source, target, 0.5);
    float dSourceCenter = distance(source, center);
    float dXCenter = distance(x, center);
    return (dSourceCenter + dXCenter) * (dSourceCenter - dXCenter);
}

vec3 getPos(vec2 source, vec2 target, float segmentRatio) {
     float vertex_height = paraboloid(source, target, segmentRatio);

    return vec3(
    mix(source, target, segmentRatio),
    sqrt(max(0.0, vertex_height))
    );
}
vec2 getExtrusionOffset(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
   dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
  vec2 offset = dir_screenspace * offset_direction * setPickingSize(a_Size)/ 2.0;
  return offset;
}
vec2 getNormal(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
   dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
   return reverse_offset_normal(vec3(dir_screenspace,1.0)).xy * sign(offset_direction);
}
float getAngularDist (vec2 source, vec2 target) {
  vec2 delta = source - target;
  vec2 sin_half_delta = sin(delta / 2.0);
  float a =
    sin_half_delta.y * sin_half_delta.y +
    cos(source.y) * cos(target.y) *
    sin_half_delta.x * sin_half_delta.x;
  return 2.0 * atan(sqrt(a), sqrt(1.0 - a));
}

vec2 midPoint(vec2 source, vec2 target) {
  vec2 center = target - source;
  float r = length(center);
  float theta = atan(center.y, center.x);
  float thetaOffset = 0.314;
  float r2 = r / 2.0 / cos(thetaOffset);
  float theta2 = theta + thetaOffset;
  vec2 mid = vec2(r2*cos(theta2) + source.x, r2*sin(theta2) + source.y);
  return mid;
}
float bezier3(vec3 arr, float t) {
  float ut = 1. - t;
  return (arr.x * ut + arr.y * t) * ut + (arr.y * ut + arr.z * t) * t;
}

vec2 interpolate (vec2 source, vec2 target, float angularDist, float t) {
  // if the angularDist is PI, linear interpolation is applied. otherwise, use spherical interpolation
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    vec2 mid = midPoint(source, target);
    vec3 x = vec3(source.x, mid.x, target.x);
    vec3 y = vec3(source.y, mid.y, target.y);
    return vec2(bezier3(x ,t), bezier3(y,t));
  }else {
    if(abs(angularDist - PI) < 0.001) {
      return (1.0 - t) * source + t * target;
    }
    float a = sin((1.0 - t) * angularDist) / sin(angularDist);
    float b = sin(t * angularDist) / sin(angularDist);
    vec2 sin_source = sin(source);
    vec2 cos_source = cos(source);
    vec2 sin_target = sin(target);
    vec2 cos_target = cos(target);
    float x = a * cos_source.y * cos_source.x + b * cos_target.y * cos_target.x;
    float y = a * cos_source.y * sin_source.x + b * cos_target.y * sin_target.x;
    float z = a * sin_source.y + b * sin_target.y;
    return vec2(atan(y, x), atan(z, sqrt(x * x + y * y)));
  }
}

void main() {
  v_color = a_Color;
  v_color.a = v_color.a * opacity;
  vec2 source = radians(a_Instance.rg);
  vec2 target = radians(a_Instance.ba);
  float angularDist = getAngularDist(source, target);
  float segmentIndex = a_Position.x;
  float segmentRatio = getSegmentRatio(segmentIndex);
  float indexDir = mix(-1.0, 1.0, step(segmentIndex, 0.0));

  if(u_line_type == LineTypeDash) {
    v_distance_ratio = segmentIndex / segmentNumber;
    vec2 s = source;
    vec2 t = target;
    
    if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
      s = unProjCustomCoord(source);
      t = unProjCustomCoord(target);
    }
    float total_Distance = pixelDistance(s, t) / 2.0 * PI;
    total_Distance = total_Distance*16.0; // total_Distance*16.0 \u8C03\u6574\u9ED8\u8BA4\u7684\u6548\u679C
    v_dash_array = pow(2.0, 20.0 - u_Zoom) * u_dash_array / total_Distance;
  }

  if(u_animate.x == Animate) {
      v_distance_ratio = segmentIndex / segmentNumber;
  }

  float nextSegmentRatio = getSegmentRatio(segmentIndex + indexDir);
  v_distance_ratio = segmentIndex / segmentNumber;
  vec4 curr = project_position(vec4(degrees(interpolate(source, target, angularDist, segmentRatio)), 0.0, 1.0));
  vec4 next = project_position(vec4(degrees(interpolate(source, target, angularDist, nextSegmentRatio)), 0.0, 1.0));
  // v_normal = getNormal((next.xy - curr.xy) * indexDir, a_Position.y);
  vec2 offset = project_pixel(getExtrusionOffset((next.xy - curr.xy) * indexDir, a_Position.y));
  //  vec4 project_pos = project_position(vec4(curr.xy, 0, 1.0));
  // gl_Position = project_common_position_to_clipspace(vec4(curr.xy + offset, curr.z, 1.0));

v_line_data.g = a_Position.x; // \u8BE5\u9876\u70B9\u5728\u5F27\u7EBF\u4E0A\u7684\u5206\u6BB5\u6392\u5E8F
  if(LineTexture == u_line_texture) { // \u5F00\u542F\u8D34\u56FE\u6A21\u5F0F  
    // float mapZoomScale = u_CoordinateSystem !== COORDINATE_SYSTEM_P20_2?10000000.0:1.0;
    float d_arcDistrance = length(source - target);
    if(u_CoordinateSystem == COORDINATE_SYSTEM_P20) { // amap
      d_arcDistrance = d_arcDistrance * 1000000.0;
    }
    if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) { // mapbox
      d_arcDistrance = project_pixel_allmap(d_arcDistrance);
    }
    float d_pixelLen = project_pixel(u_icon_step)/8.0;
v_line_data.b = floor(d_arcDistrance/d_pixelLen); // \u8D34\u56FE\u5728\u5F27\u7EBF\u4E0A\u91CD\u590D\u7684\u6570\u91CF

    float lineOffsetWidth = length(offset + offset * sign(a_Position.y)); // \u7EBF\u6A2A\u5411\u504F\u79FB\u7684\u8DDD\u79BB
    float linePixelSize = project_pixel(a_Size);  // \u5B9A\u70B9\u4F4D\u7F6E\u504F\u79FB\uFF0C\u6309\u5730\u56FE\u7B49\u7EA7\u7F29\u653E\u540E\u7684\u8DDD\u79BB
v_line_data.a = lineOffsetWidth/linePixelSize;  // \u7EBF\u56FE\u5C42\u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\u503C

    v_iconMapUV = a_iconMapUV;
  }



  gl_Position = project_common_position_to_clipspace_v2(vec4(curr.xy + offset, 0, 1.0));
  setPickingColor(a_PickingColor);
}

`,vC={solid:0,dash:1},gC=function(e){(0,ke.Z)(t,e);var i=hC(t);function t(){var r;(0,ue.Z)(this,t);for(var n=arguments.length,a=new Array(n),u=0;u<n;u++)a[u]=arguments[u];return r=i.call.apply(i,[this].concat(a)),(0,Ce.Z)((0,bt.Z)(r),"updateTexture",function(){var f=r.rendererService.createTexture2D;if(r.texture){r.texture.update({data:r.iconService.getCanvas()}),r.layer.render();return}r.texture=f({data:r.iconService.getCanvas(),mag:Ge.NEAREST,min:Ge.NEAREST,premultiplyAlpha:!1,width:1024,height:r.iconService.canvasHeight||128})}),r}return(0,me.Z)(t,[{key:"getUninforms",value:function(){var n=this.layer.getLayerConfig(),a=n.sourceColor,u=n.targetColor,f=n.textureBlend,g=f===void 0?"normal":f,x=n.lineType,I=x===void 0?"solid":x,O=n.dashArray,B=O===void 0?[10,5]:O,W=n.lineTexture,he=W===void 0?!1:W,ae=n.iconStep,Se=ae===void 0?100:ae,Fe=n.segmentNumber,Qe=Fe===void 0?30:Fe;B.length===2&&B.push(0,0),this.rendererService.getDirty()&&this.texture.bind();var qe=0,yt=[0,0,0,0],Et=[0,0,0,0];return a&&u&&(yt=Ni(a),Et=Ni(u),qe=1),(0,X.Z)({u_textureBlend:g==="normal"?0:1,segmentNumber:Qe,u_line_type:vC[I]||0,u_dash_array:B,u_texture:this.texture,u_line_texture:he?1:0,u_icon_step:Se,u_textSize:[1024,this.iconService.canvasHeight||128],u_linearColor:qe,u_sourceColor:yt,u_targetColor:Et},this.getStyleAttribute())}},{key:"getAnimateUniforms",value:function(){var n=this.layer.getLayerConfig(),a=n.animateOption;return{u_animate:this.animateOption2Array(a),u_time:this.layer.getLayerAnimateTime()}}},{key:"initModels",value:function(){var r=(0,ur.Z)(nt().mark(function a(){return nt().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return this.updateTexture(),this.iconService.on("imageUpdate",this.updateTexture),f.abrupt("return",this.buildModels());case 3:case"end":return f.stop()}},a,this)}));function n(){return r.apply(this,arguments)}return n}()},{key:"clearModels",value:function(){var n;(n=this.texture)===null||n===void 0||n.destroy(),this.iconService.off("imageUpdate",this.updateTexture)}},{key:"buildModels",value:function(){var r=(0,ur.Z)(nt().mark(function a(){var u;return nt().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return g.next=2,this.layer.buildLayerModel({moduleName:"lineGreatCircle",vertexShader:dC,fragmentShader:pC,triangulation:Dd,inject:this.getInject(),depth:{enable:!1}});case 2:return u=g.sent,g.abrupt("return",[u]);case 4:case"end":return g.stop()}},a,this)}));function n(){return r.apply(this,arguments)}return n}()},{key:"registerBuiltinAttributes",value:function(){var n=this;this.styleAttributeService.registerStyleAttribute({name:"size",type:mn.Attribute,descriptor:{name:"a_Size",buffer:{usage:Ge.DYNAMIC_DRAW,data:[],type:Ge.FLOAT},size:1,update:function(u){var f=u.size,g=f===void 0?1:f;return Array.isArray(g)?[g[0]]:[g]}}}),this.styleAttributeService.registerStyleAttribute({name:"instance",type:mn.Attribute,descriptor:{name:"a_Instance",buffer:{usage:Ge.STATIC_DRAW,data:[],type:Ge.FLOAT},size:4,update:function(u,f,g){return[g[3],g[4],g[5],g[6]]}}}),this.styleAttributeService.registerStyleAttribute({name:"uv",type:mn.Attribute,descriptor:{name:"a_iconMapUV",buffer:{usage:Ge.DYNAMIC_DRAW,data:[],type:Ge.FLOAT},size:2,update:function(u){var f=n.iconService.getIconMap(),g=u.texture,x=f[g]||{x:0,y:0},I=x.x,O=x.y;return[I,O]}}})}}]),t}(vo),uP=function(e){return e[e.solid=0]="solid",e[e.dash=1]="dash",e}({}),Fd=function(e){return e.VERTICAL="vertical",e.HORIZONTAL="horizontal",e}({}),mC=function(e){return e.NORMAL="normal",e.REPLACE="replace",e}({}),dg=function(e){return e[e.pixel=0]="pixel",e[e.meter=1]="meter",e}({}),lP=function(e){return e.ALWAYS="always",e.DRAGEND="dragend",e}({});function yC(e){var i=_C();return function(){var r=(0,oe.Z)(e),n;if(i){var a=(0,oe.Z)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return(0,Ze.Z)(this,n)}}function _C(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var xC=`#define LineTypeSolid 0.0
varying vec4 v_color;

// dash
varying vec4 v_dash_array;
varying float v_d_distance_ratio;

#pragma include "picking"

uniform float u_time;
uniform vec4 u_animate: [ 1., 2., 1.0, 0.2 ]; // \u63A7\u5236\u8FD0\u52A8

// [animate, duration, interval, trailLength],
void main() {

  gl_FragColor = v_color;

  float dashLength = mod(v_d_distance_ratio, v_dash_array.x + v_dash_array.y + v_dash_array.z + v_dash_array.w);
  if(dashLength < v_dash_array.x || (dashLength > (v_dash_array.x + v_dash_array.y) && dashLength <  v_dash_array.x + v_dash_array.y + v_dash_array.z)) {
    // \u5B9E\u7EBF\u90E8\u5206
  } else {
    // \u865A\u7EBF\u90E8\u5206
    discard;
  };

  gl_FragColor = filterColor(gl_FragColor);
}
`,EC=`#define LineTypeSolid 0.0
#define LineTypeDash 1.0
#define Animate 0.0

attribute float a_Miter;
attribute vec4 a_Color;
attribute vec2 a_Size;
attribute vec3 a_Normal;
attribute vec3 a_Position;

attribute vec2 a_iconMapUV;

// dash line
attribute float a_Total_Distance;
attribute vec2 a_DistanceAndIndex;
uniform float u_raisingHeight: 0.0;
uniform float u_heightfixed: 0.0;

uniform mat4 u_ModelMatrix;

uniform vec4 u_dash_array: [10.0, 5., 0, 0];

uniform float u_vertexScale: 1.0;

#pragma include "projection"
#pragma include "picking"

varying vec4 v_color;
varying vec4 v_dash_array;
varying float v_d_distance_ratio;


void main() {

  v_dash_array = pow(2.0, 20.0 - u_Zoom) * u_dash_array / a_Total_Distance;
  v_color = vec4(a_Color.xyz, a_Color.w * opacity);

  vec3 size = a_Miter * setPickingSize(a_Size.x) * reverse_offset_normal(a_Normal);
  vec2 offset = project_pixel(size.xy);
  v_d_distance_ratio = a_DistanceAndIndex.x / a_Total_Distance;


  vec4 project_pos = project_position(vec4(a_Position.xy, 0, 1.0));
  
 float h = float(a_Position.z) * u_vertexScale; // \u7EBF\u9876\u70B9\u7684\u9AD8\u5EA6 - \u517C\u5BB9\u4E0D\u5B58\u5728\u7B2C\u4E09\u4E2A\u6570\u503C\u7684\u60C5\u51B5 vertex height
  float lineHeight = a_Size.y; // size \u7B2C\u4E8C\u4E2A\u53C2\u6570\u4EE3\u8868\u7684\u9AD8\u5EA6 [linewidth, lineheight]

  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    lineHeight *= 0.2; // \u4FDD\u6301\u548C amap/mapbox \u4E00\u81F4\u7684\u6548\u679C
    h *= 0.2;
    if(u_heightfixed < 1.0) {
      lineHeight = project_pixel(a_Size.y);
    }
    gl_Position = u_Mvp * (vec4(project_pos.xy + offset, lineHeight + h + u_raisingHeight, 1.0));
  } else {
    // mapbox -  amap
    
    // \u517C\u5BB9 mapbox \u5728\u7EBF\u9AD8\u5EA6\u4E0A\u7684\u6548\u679C\u8868\u73B0\u57FA\u672C\u4E00\u81F4
    if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
      // mapbox
      // \u4FDD\u6301\u9AD8\u5EA6\u76F8\u5BF9\u4E0D\u53D8
      float mapboxZoomScale = 4.0/pow(2.0, 21.0 - u_Zoom);
      h *= mapboxZoomScale;
      h += u_raisingHeight * mapboxZoomScale;
      if(u_heightfixed > 0.0) {
        lineHeight *= mapboxZoomScale;
      }
      
    } else {
      // amap
      h += u_raisingHeight;
      // lineHeight \u9876\u70B9\u504F\u79FB\u9AD8\u5EA6
      if(u_heightfixed < 1.0) {
        lineHeight *= pow(2.0, 20.0 - u_Zoom);
      }
    }

    gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, lineHeight + h, 1.0));
  }

  setPickingColor(a_PickingColor);
}
`,bC=`#extension GL_OES_standard_derivatives : enable
#define Animate 0.0
#define LineTexture 1.0
uniform float u_textureBlend;

uniform float u_strokeWidth: 0.0;

uniform vec3 u_blur;
varying vec4 v_color;
varying vec4 v_stroke;

// line texture
uniform float u_line_texture;
uniform sampler2D u_texture;
uniform vec2 u_textSize;
varying vec2 v_iconMapUV;
varying vec4 v_texture_data;


#pragma include "picking"

uniform float u_time;
uniform vec4 u_animate: [ 1, 2., 1.0, 0.2 ]; // \u63A7\u5236\u8FD0\u52A8
// [animate, duration, interval, trailLength],
void main() {
  float animateSpeed = 0.0; // \u8FD0\u52A8\u901F\u5EA6
  float d_distance_ratio = v_texture_data.r; // \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B
  gl_FragColor = v_color;
  // anti-alias
  // float blur = 1.0 - smoothstep(u_blur, 1., length(v_normal.xy));
  if(u_animate.x == Animate) {
      animateSpeed = u_time / u_animate.y;
       float alpha =1.0 - fract( mod(1.0- d_distance_ratio, u_animate.z)* (1.0/ u_animate.z) + animateSpeed);
      alpha = (alpha + u_animate.w -1.0) / u_animate.w;
      alpha = smoothstep(0., 1., alpha);
      gl_FragColor.a *= alpha;
  }

  if(u_line_texture == LineTexture) { // while load texture
    float aDistance = v_texture_data.g;      // \u5F53\u524D\u9876\u70B9\u7684\u8DDD\u79BB
    float d_texPixelLen = v_texture_data.b;  // \u8D34\u56FE\u7684\u50CF\u7D20\u957F\u5EA6\uFF0C\u6839\u636E\u5730\u56FE\u5C42\u7EA7\u7F29\u653E
    float u = fract(mod(aDistance, d_texPixelLen)/d_texPixelLen - animateSpeed);
    float v = v_texture_data.a;  // \u7EBF\u56FE\u5C42\u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\u503C

    // v = max(smoothstep(0.95, 1.0, v), v);
    vec2 uv= v_iconMapUV / u_textSize + vec2(u, v) / u_textSize * 64.;
     vec4 pattern = texture2D(u_texture, uv);

    if(u_textureBlend == 0.0) { // normal
      pattern.a = 0.0;
      gl_FragColor += pattern;
    } else { // replace
        pattern.a *= v_color.a;
        if(gl_FragColor.a <= 0.0) {
          pattern.a = 0.0;
        }
        gl_FragColor = pattern;
    }
  } 

  float v = v_texture_data.a;
  float strokeWidth = min(0.5, u_strokeWidth);
  // \u7ED8\u5236 border
  if(strokeWidth > 0.01) {
    float borderOuterWidth = strokeWidth / 2.0;


    if(v >= 1.0 - strokeWidth || v <= strokeWidth) {
      if(v > strokeWidth) { // \u5916\u4FA7
        float linear = smoothstep(0.0, 1.0, (v - (1.0 - strokeWidth))/strokeWidth);
        //  float linear = step(0.0, (v - (1.0 - borderWidth))/borderWidth);
        gl_FragColor.rgb = mix(gl_FragColor.rgb, v_stroke.rgb, linear);
      } else if(v <= strokeWidth) {
        float linear = smoothstep(0.0, 1.0, v/strokeWidth);
        gl_FragColor.rgb = mix(v_stroke.rgb, gl_FragColor.rgb, linear);
      }
    }

    if(v < borderOuterWidth) {
      gl_FragColor.a = mix(0.0, gl_FragColor.a, v/borderOuterWidth);
    } else if(v > 1.0 - borderOuterWidth) {
      gl_FragColor.a = mix(gl_FragColor.a, 0.0, (v - (1.0 - borderOuterWidth))/borderOuterWidth);
    }
  }

  // blur
  float blurV = v_texture_data.a;
  if(blurV < 0.5) {
    gl_FragColor.a *= mix(u_blur.r, u_blur.g, blurV/0.5);
  } else {
    gl_FragColor.a *= mix(u_blur.g, u_blur.b, (blurV - 0.5)/0.5);
  }
  
  gl_FragColor = filterColor(gl_FragColor);
}
`,f1=`
#define Animate 0.0

attribute float a_Miter;
attribute vec4 a_Color;
attribute vec2 a_Size;
attribute vec3 a_Normal;
attribute vec3 a_Position;

attribute vec2 a_iconMapUV;

// dash line
attribute float a_Total_Distance;
attribute vec2 a_DistanceAndIndex;

uniform mat4 u_ModelMatrix;

uniform vec4 u_animate: [ 1., 2., 1.0, 0.2 ];
uniform float u_icon_step: 100;

uniform float u_heightfixed: 0.0;
uniform float u_vertexScale: 1.0;
uniform float u_raisingHeight: 0.0;

#pragma include "projection"
#pragma include "picking"

varying vec4 v_color;
varying vec4 v_stroke;

// texV \u7EBF\u56FE\u5C42 - \u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\uFF08\u7EBF\u7684\u5BBD\u5EA6\u65B9\u5411\uFF09
varying vec2 v_iconMapUV;


uniform float u_linearColor: 0;
uniform float u_arrow: 0.0;
uniform float u_arrowHeight: 3.0;
uniform float u_arrowWidth: 2.0;
uniform float u_tailWidth: 1.0;

varying vec4 v_texture_data;

vec2 calculateArrow(vec2 offset) {
  /*
  * \u5728\u652F\u6301\u7BAD\u5934\u7684\u65F6\u5019\uFF0C\u7B2C\u4E8C\u3001\u7B2C\u4E09\u7EC4\u9876\u70B9\u662F\u989D\u5916\u63D2\u5165\u7528\u4E8E\u6784\u5EFA\u9876\u70B9\u7684
  */
  float arrowFlag = -1.0;
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) {
    // \u9AD8\u5FB7 2.0 \u7684\u65CB\u8F6C\u89D2\u5EA6\u4E0D\u540C
    arrowFlag = 1.0;
  }
  float pi = arrowFlag * 3.1415926/2.;
  if(a_Miter < 0.) {
    // \u6839\u636E\u7EBF\u7684\u4E24\u4FA7\u504F\u79FB\u4E0D\u540C\u3001\u65CB\u8F6C\u7684\u65B9\u5411\u76F8\u53CD
    pi = -pi;
  }
  highp float angle_sin = sin(pi);
  highp float angle_cos = cos(pi);
  // \u8BA1\u7B97\u5782\u76F4\u4E0E\u7EBF\u65B9\u5411\u7684\u65CB\u8F6C\u77E9\u9635
  mat2 rotation_matrix = mat2(angle_cos, -1.0 * angle_sin, angle_sin, angle_cos);
  float arrowWidth = u_arrowWidth;
  float arrowHeight = u_arrowHeight;

  vec2 arrowOffset = vec2(0.0);
  /*
  * a_DistanceAndIndex.y \u7528\u4E8E\u6807\u8BB0\u5F53\u524D\u9876\u70B9\u5C5E\u4E8E\u54EA\u4E00\u7EC4\uFF08\u4E24\u4E2A\u9876\u70B9\u4E00\u7EC4\uFF0C\u6784\u6210\u7EBF\u7684\u5176\u5B9E\u662F\u77E9\u5F62\uFF0C\u6700\u7B80\u9700\u8981\u56DB\u4E2A\u9876\u70B9\u3001\u4E24\u7EC4\u9876\u70B9\u6784\u6210\uFF09
  */
  if(a_DistanceAndIndex.y == 0.0) {
    // \u7BAD\u5934\u5C16\u90E8
    offset = vec2(0.0);
  } else if(a_DistanceAndIndex.y == 1.0) {
    // \u7BAD\u5934\u4E24\u4FA7
    arrowOffset = rotation_matrix*(offset * arrowHeight);
    offset += arrowOffset; // \u6CBF\u7EBF\u504F\u79FB
    offset = offset * arrowWidth; // \u5782\u76F4\u7EBF\u5411\u5916\u504F\u79FB\uFF08\u662F\u6784\u5EFA\u7BAD\u5934\u4E24\u4FA7\u7684\u9876\u70B9\uFF09
  } else if(a_DistanceAndIndex.y == 2.0 || a_DistanceAndIndex.y == 3.0 || a_DistanceAndIndex.y == 4.0) {
    // \u504F\u79FB\u5176\u4F59\u7684\u70B9\u4F4D\uFF08\u5C06\u957F\u5EA6\u8BA9\u4F4D\u7ED9\u7BAD\u5934\uFF09
    arrowOffset = rotation_matrix*(offset * arrowHeight) * arrowWidth;
    offset += arrowOffset;// \u6CBF\u7EBF\u504F\u79FB
  }

  return offset;
}

void main() {
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97

  
  float d_texPixelLen;    // \u8D34\u56FE\u7684\u50CF\u7D20\u957F\u5EA6\uFF0C\u6839\u636E\u5730\u56FE\u5C42\u7EA7\u7F29\u653E

  v_iconMapUV = a_iconMapUV;
  d_texPixelLen = project_float_pixel(u_icon_step);
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) {
    d_texPixelLen *= 10.0;
  }

  v_color = a_Color;
  v_color.a *= opacity;
  v_stroke = stroke;

  vec3 size = a_Miter * setPickingSize(a_Size.x) * reverse_offset_normal(a_Normal);
  
  vec2 offset = project_pixel(size.xy);

  float lineDistance = a_DistanceAndIndex.x;
  float currentLinePointRatio = lineDistance / a_Total_Distance;
 
  if(u_arrow > 0.0) {
      //  \u8BA1\u7B97\u7BAD\u5934
    offset = calculateArrow(offset);

    if(a_DistanceAndIndex.y > 4.0) {
      offset *= mix(1.0, u_tailWidth, currentLinePointRatio);
    }
  }

  float lineOffsetWidth = length(offset + offset * sign(a_Miter)); // \u7EBF\u6A2A\u5411\u504F\u79FB\u7684\u8DDD\u79BB\uFF08\u5411\u4E24\u4FA7\u504F\u79FB\u7684\u548C\uFF09
  float linePixelSize = project_pixel(a_Size.x) * 2.0;  // \u5B9A\u70B9\u4F4D\u7F6E\u504F\u79FB\uFF0C\u6309\u5730\u56FE\u7B49\u7EA7\u7F29\u653E\u540E\u7684\u8DDD\u79BB \u5355\u4FA7 * 2
  float texV = lineOffsetWidth/linePixelSize; // \u7EBF\u56FE\u5C42\u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\u503C
  
  v_texture_data = vec4(currentLinePointRatio, lineDistance, d_texPixelLen, texV);
  // \u8BBE\u7F6E\u6570\u636E\u96C6\u7684\u53C2\u6570

  vec4 project_pos = project_position(vec4(a_Position.xy, 0, 1.0));

  // gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, a_Size.y, 1.0));

  float h = float(a_Position.z) * u_vertexScale; // \u7EBF\u9876\u70B9\u7684\u9AD8\u5EA6 - \u517C\u5BB9\u4E0D\u5B58\u5728\u7B2C\u4E09\u4E2A\u6570\u503C\u7684\u60C5\u51B5 vertex height
  float lineHeight = a_Size.y; // size \u7B2C\u4E8C\u4E2A\u53C2\u6570\u4EE3\u8868\u7684\u9AD8\u5EA6 [linewidth, lineheight]

  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    lineHeight *= 0.2; // \u4FDD\u6301\u548C amap/mapbox \u4E00\u81F4\u7684\u6548\u679C
    h *= 0.2;
    if(u_heightfixed < 1.0) {
      lineHeight = project_pixel(a_Size.y);
    }
    gl_Position = u_Mvp * (vec4(project_pos.xy + offset, lineHeight + h + u_raisingHeight, 1.0));
  } else {
    // mapbox -  amap
    
    // \u517C\u5BB9 mapbox \u5728\u7EBF\u9AD8\u5EA6\u4E0A\u7684\u6548\u679C\u8868\u73B0\u57FA\u672C\u4E00\u81F4
    if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
      // mapbox
      // \u4FDD\u6301\u9AD8\u5EA6\u76F8\u5BF9\u4E0D\u53D8
      float mapboxZoomScale = 4.0/pow(2.0, 21.0 - u_Zoom);
      h *= mapboxZoomScale;
      h += u_raisingHeight * mapboxZoomScale;
      if(u_heightfixed > 0.0) {
        lineHeight *= mapboxZoomScale;
      }
      
    } else {
      // amap
      h += u_raisingHeight;
      // lineHeight \u9876\u70B9\u504F\u79FB\u9AD8\u5EA6
      if(u_heightfixed < 1.0) {
        lineHeight *= pow(2.0, 20.0 - u_Zoom);
      }
    }

    gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, lineHeight + h, 1.0));
  }

  setPickingColor(a_PickingColor);
}
`,SC=`varying vec4 v_color;
varying vec4 v_texture_data;
uniform float u_linearDir: 1.0;
uniform float u_linearColor: 0;
uniform vec4 u_sourceColor;
uniform vec4 u_targetColor;

#pragma include "picking"


void main() {
  float linearRadio = v_texture_data.r; // \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B
  if(u_linearDir < 1.0) {
    linearRadio = v_texture_data.a;
  }

  if(u_linearColor == 1.0) { // \u4F7F\u7528\u6E10\u53D8\u989C\u8272
    gl_FragColor = mix(u_sourceColor, u_targetColor, linearRadio);
    gl_FragColor.a *= v_color.a;
  } else { // \u4F7F\u7528 color \u65B9\u6CD5\u4F20\u5165\u7684\u989C\u8272
     gl_FragColor = v_color;
  }

  gl_FragColor = filterColor(gl_FragColor);
}
`,CC={solid:0,dash:1},h1=function(e){(0,ke.Z)(t,e);var i=yC(t);function t(){var r;(0,ue.Z)(this,t);for(var n=arguments.length,a=new Array(n),u=0;u<n;u++)a[u]=arguments[u];return r=i.call.apply(i,[this].concat(a)),(0,Ce.Z)((0,bt.Z)(r),"textureEventFlag",!1),(0,Ce.Z)((0,bt.Z)(r),"texture",r.createTexture2D({data:[0,0,0,0],mag:Ge.NEAREST,min:Ge.NEAREST,premultiplyAlpha:!1,width:1,height:1})),(0,Ce.Z)((0,bt.Z)(r),"updateTexture",function(){var f=r.rendererService.createTexture2D;if(r.texture){r.texture.update({data:r.iconService.getCanvas()}),r.layer.render();return}r.texture=f({data:r.iconService.getCanvas(),mag:Ge.NEAREST,min:Ge.NEAREST,premultiplyAlpha:!1,width:1024,height:r.iconService.canvasHeight||128})}),r}return(0,me.Z)(t,[{key:"getUninforms",value:function(){var n=this.layer.getLayerConfig(),a=n.sourceColor,u=n.targetColor,f=n.textureBlend,g=f===void 0?"normal":f,x=n.lineType,I=x===void 0?"solid":x,O=n.dashArray,B=O===void 0?[10,5,0,0]:O,W=n.lineTexture,he=W===void 0?!1:W,ae=n.iconStep,Se=ae===void 0?100:ae,Fe=n.vertexHeightScale,Qe=Fe===void 0?20:Fe,qe=n.strokeWidth,yt=qe===void 0?0:qe,Et=n.raisingHeight,Ot=Et===void 0?0:Et,jt=n.heightfixed,or=jt===void 0?!1:jt,ar=n.linearDir,br=ar===void 0?Fd.VERTICAL:ar,pr=n.blur,jr=pr===void 0?[1,1,1]:pr,nn=n.arrow,yn=nn===void 0?{enable:!1,arrowWidth:2,arrowHeight:3,tailWidth:1}:nn;B.length===2&&B.push(0,0),this.rendererService.getDirty()&&this.texture&&this.texture.bind();var ma=0,Ho=[0,0,0,0],Lo=[0,0,0,0];return a&&u&&(Ho=Ni(a),Lo=Ni(u),ma=1),(0,X.Z)({u_textureBlend:g===mC.NORMAL?0:1,u_line_type:CC[I],u_dash_array:B,u_blur:jr,u_texture:this.texture,u_line_texture:he?1:0,u_icon_step:Se,u_textSize:[1024,this.iconService.canvasHeight||128],u_strokeWidth:yt,u_linearDir:br===Fd.VERTICAL?1:0,u_linearColor:ma,u_sourceColor:Ho,u_targetColor:Lo,u_heightfixed:Number(or),u_vertexScale:Qe,u_raisingHeight:Number(Ot),u_arrow:Number(yn.enable),u_arrowHeight:yn.arrowHeight||3,u_arrowWidth:yn.arrowWidth||2,u_tailWidth:yn.tailWidth===void 0?1:yn.tailWidth},this.getStyleAttribute())}},{key:"getAnimateUniforms",value:function(){var n=this.layer.getLayerConfig(),a=n.animateOption;return{u_animate:this.animateOption2Array(a),u_time:this.layer.getLayerAnimateTime()}}},{key:"initModels",value:function(){var r=(0,ur.Z)(nt().mark(function a(){return nt().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return this.textureEventFlag||(this.textureEventFlag=!0,this.updateTexture(),this.iconService.on("imageUpdate",this.updateTexture)),f.abrupt("return",this.buildModels());case 2:case"end":return f.stop()}},a,this)}));function n(){return r.apply(this,arguments)}return n}()},{key:"clearModels",value:function(){var n;(n=this.texture)===null||n===void 0||n.destroy(),this.iconService.off("imageUpdate",this.updateTexture)}},{key:"buildModels",value:function(){var r=(0,ur.Z)(nt().mark(function a(){var u,f,g,x,I,O,B,W;return nt().wrap(function(ae){for(;;)switch(ae.prev=ae.next){case 0:return u=this.layer.getLayerConfig(),f=u.depth,g=f===void 0?!1:f,x=this.getShaders(),I=x.frag,O=x.vert,B=x.type,this.layer.triangulation=Cl,ae.next=5,this.layer.buildLayerModel({moduleName:"line"+B,vertexShader:O,fragmentShader:I,triangulation:Cl,inject:this.getInject(),depth:{enable:g}});case 5:return W=ae.sent,ae.abrupt("return",[W]);case 7:case"end":return ae.stop()}},a,this)}));function n(){return r.apply(this,arguments)}return n}()},{key:"getShaders",value:function(){var n=this.layer.getLayerConfig(),a=n.sourceColor,u=n.targetColor,f=n.lineType;return f==="dash"?{frag:xC,vert:EC,type:"Dash"}:a&&u?{frag:SC,vert:f1,type:"Linear"}:{frag:bC,vert:f1,type:""}}},{key:"registerBuiltinAttributes",value:function(){var n=this;this.styleAttributeService.registerStyleAttribute({name:"distanceAndIndex",type:mn.Attribute,descriptor:{name:"a_DistanceAndIndex",buffer:{usage:Ge.STATIC_DRAW,data:[],type:Ge.FLOAT},size:2,update:function(u,f,g,x,I,O){return O===void 0?[g[3],10]:[g[3],O]}}}),this.styleAttributeService.registerStyleAttribute({name:"total_distance",type:mn.Attribute,descriptor:{name:"a_Total_Distance",buffer:{usage:Ge.STATIC_DRAW,data:[],type:Ge.FLOAT},size:1,update:function(u,f,g){return[g[5]]}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:mn.Attribute,descriptor:{name:"a_Size",buffer:{usage:Ge.DYNAMIC_DRAW,data:[],type:Ge.FLOAT},size:2,update:function(u){var f=u.size,g=f===void 0?1:f;return Array.isArray(g)?[g[0],g[1]]:[g,0]}}}),this.styleAttributeService.registerStyleAttribute({name:"normal",type:mn.Attribute,descriptor:{name:"a_Normal",buffer:{usage:Ge.STATIC_DRAW,data:[],type:Ge.FLOAT},size:3,update:function(u,f,g,x,I){return I}}}),this.styleAttributeService.registerStyleAttribute({name:"miter",type:mn.Attribute,descriptor:{name:"a_Miter",buffer:{usage:Ge.STATIC_DRAW,data:[],type:Ge.FLOAT},size:1,update:function(u,f,g){return[g[4]]}}}),this.styleAttributeService.registerStyleAttribute({name:"uv",type:mn.Attribute,descriptor:{name:"a_iconMapUV",buffer:{usage:Ge.DYNAMIC_DRAW,data:[],type:Ge.FLOAT},size:2,update:function(u){var f=n.iconService.getIconMap(),g=u.texture,x=f[g]||{x:0,y:0},I=x.x,O=x.y;return[I,O]}}})}}]),t}(vo);function wC(e){var i=TC();return function(){var r=(0,oe.Z)(e),n;if(i){var a=(0,oe.Z)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return(0,Ze.Z)(this,n)}}function TC(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var MC=`
varying vec4 v_Color;
#pragma include "picking"
void main() {

  gl_FragColor = v_Color; // \u5168\u5C40\u900F\u660E\u5EA6
  gl_FragColor = filterColor(gl_FragColor);
}
`,IC=`
attribute float a_Miter;
attribute vec2 a_Size;
attribute vec3 a_Normal;
attribute vec3 a_Position;

// dash line
attribute float a_Total_Distance;
attribute vec2 a_DistanceAndIndex;

uniform mat4 u_ModelMatrix;


uniform float u_heightfixed: 0.0;
uniform float u_vertexScale: 1.0;
uniform float u_raisingHeight: 0.0;
uniform sampler2D u_texture;
uniform float u_linearDir: 1.0;
varying vec4 v_Color;


#pragma include "projection"
#pragma include "picking"


void main() {


  vec3 size = a_Miter * setPickingSize(a_Size.x) * reverse_offset_normal(a_Normal);
  
  vec2 offset = project_pixel(size.xy);

  float lineDistance = a_DistanceAndIndex.x;
  float currentLinePointRatio = lineDistance / a_Total_Distance;
 

  float lineOffsetWidth = length(offset + offset * sign(a_Miter)); // \u7EBF\u6A2A\u5411\u504F\u79FB\u7684\u8DDD\u79BB\uFF08\u5411\u4E24\u4FA7\u504F\u79FB\u7684\u548C\uFF09
  float linePixelSize = project_pixel(a_Size.x) * 2.0;  // \u5B9A\u70B9\u4F4D\u7F6E\u504F\u79FB\uFF0C\u6309\u5730\u56FE\u7B49\u7EA7\u7F29\u653E\u540E\u7684\u8DDD\u79BB \u5355\u4FA7 * 2
  float texV = lineOffsetWidth/linePixelSize; // \u7EBF\u56FE\u5C42\u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\u503C

  float linearRadio =currentLinePointRatio; // \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B
  if(u_linearDir < 1.0) {
    linearRadio = texV;
  }

  v_Color = texture2D(u_texture, vec2(linearRadio, 0.5));

  v_Color.a *= opacity; // \u5168\u5C40\u900F\u660E\u5EA6



  vec4 project_pos = project_position(vec4(a_Position.xy, 0, 1.0));

  // gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, a_Size.y, 1.0));

  float h = float(a_Position.z) * u_vertexScale; // \u7EBF\u9876\u70B9\u7684\u9AD8\u5EA6 - \u517C\u5BB9\u4E0D\u5B58\u5728\u7B2C\u4E09\u4E2A\u6570\u503C\u7684\u60C5\u51B5 vertex height
  float lineHeight = a_Size.y; // size \u7B2C\u4E8C\u4E2A\u53C2\u6570\u4EE3\u8868\u7684\u9AD8\u5EA6 [linewidth, lineheight]

  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    lineHeight *= 0.2; // \u4FDD\u6301\u548C amap/mapbox \u4E00\u81F4\u7684\u6548\u679C
    h *= 0.2;
    if(u_heightfixed < 1.0) {
      lineHeight = project_pixel(a_Size.y);
    }
    gl_Position = u_Mvp * (vec4(project_pos.xy + offset, lineHeight + h + u_raisingHeight, 1.0));
  } else {
    // mapbox -  amap
    
    // \u517C\u5BB9 mapbox \u5728\u7EBF\u9AD8\u5EA6\u4E0A\u7684\u6548\u679C\u8868\u73B0\u57FA\u672C\u4E00\u81F4
    if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
      // mapbox
      // \u4FDD\u6301\u9AD8\u5EA6\u76F8\u5BF9\u4E0D\u53D8
      float mapboxZoomScale = 4.0/pow(2.0, 21.0 - u_Zoom);
      h *= mapboxZoomScale;
      h += u_raisingHeight * mapboxZoomScale;
      if(u_heightfixed > 0.0) {
        lineHeight *= mapboxZoomScale;
      }
      
    } else {
      // amap
      h += u_raisingHeight;
      // lineHeight \u9876\u70B9\u504F\u79FB\u9AD8\u5EA6
      if(u_heightfixed < 1.0) {
        lineHeight *= pow(2.0, 20.0 - u_Zoom);
      }
    }

    gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, lineHeight + h, 1.0));
  }

  setPickingColor(a_PickingColor);
}
`,cP=In.isNumber,LC=function(e){(0,ke.Z)(t,e);var i=wC(t);function t(){var r;(0,ue.Z)(this,t);for(var n=arguments.length,a=new Array(n),u=0;u<n;u++)a[u]=arguments[u];return r=i.call.apply(i,[this].concat(a)),(0,Ce.Z)((0,bt.Z)(r),"updateTexture",function(){var f=r.rendererService.createTexture2D;r.colorTexture&&r.colorTexture.destroy();var g=r.layer.getLayerConfig(),x=g.rampColors,I=Wo(x);r.colorTexture=f({data:new Uint8Array(I.data),width:I.width,height:I.height,wrapS:Ge.CLAMP_TO_EDGE,wrapT:Ge.CLAMP_TO_EDGE,min:Ge.NEAREST,mag:Ge.NEAREST,flipY:!1})}),r}return(0,me.Z)(t,[{key:"getUninforms",value:function(){var n=this.layer.getLayerConfig(),a=n.opacity,u=a===void 0?1:a,f=n.vertexHeightScale,g=f===void 0?20:f,x=n.raisingHeight,I=x===void 0?0:x,O=n.heightfixed,B=O===void 0?!1:O,W=n.linearDir,he=W===void 0?Fd.VERTICAL:W;return this.rendererService.getDirty()&&this.colorTexture.bind(),(0,X.Z)({u_linearDir:he===Fd.VERTICAL?1:0,u_texture:this.colorTexture,u_heightfixed:Number(B),u_vertexScale:g,u_raisingHeight:Number(I)},this.getStyleAttribute())}},{key:"initModels",value:function(){var r=(0,ur.Z)(nt().mark(function a(){return nt().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return this.updateTexture(),f.abrupt("return",this.buildModels());case 2:case"end":return f.stop()}},a,this)}));function n(){return r.apply(this,arguments)}return n}()},{key:"clearModels",value:function(){var n;(n=this.colorTexture)===null||n===void 0||n.destroy()}},{key:"buildModels",value:function(){var r=(0,ur.Z)(nt().mark(function a(){var u,f,g,x;return nt().wrap(function(O){for(;;)switch(O.prev=O.next){case 0:return u=this.layer.getLayerConfig(),f=u.depth,g=f===void 0?!1:f,this.layer.triangulation=Ag,O.next=4,this.layer.buildLayerModel({moduleName:"lineRampColors",vertexShader:IC,fragmentShader:MC,triangulation:Ag,inject:this.getInject(),depth:{enable:g}});case 4:return x=O.sent,O.abrupt("return",[x]);case 6:case"end":return O.stop()}},a,this)}));function n(){return r.apply(this,arguments)}return n}()},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"distanceAndIndex",type:mn.Attribute,descriptor:{name:"a_DistanceAndIndex",buffer:{usage:Ge.STATIC_DRAW,data:[],type:Ge.FLOAT},size:2,update:function(a,u,f,g,x,I){return I===void 0?[f[3],10]:[f[3],I]}}}),this.styleAttributeService.registerStyleAttribute({name:"total_distance",type:mn.Attribute,descriptor:{name:"a_Total_Distance",buffer:{usage:Ge.STATIC_DRAW,data:[],type:Ge.FLOAT},size:1,update:function(a,u,f){return[f[5]]}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:mn.Attribute,descriptor:{name:"a_Size",buffer:{usage:Ge.DYNAMIC_DRAW,data:[],type:Ge.FLOAT},size:2,update:function(a){var u=a.size,f=u===void 0?1:u;return Array.isArray(f)?[f[0],f[1]]:[f,0]}}}),this.styleAttributeService.registerStyleAttribute({name:"normal",type:mn.Attribute,descriptor:{name:"a_Normal",buffer:{usage:Ge.STATIC_DRAW,data:[],type:Ge.FLOAT},size:3,update:function(a,u,f,g,x){return x}}}),this.styleAttributeService.registerStyleAttribute({name:"miter",type:mn.Attribute,descriptor:{name:"a_Miter",buffer:{usage:Ge.STATIC_DRAW,data:[],type:Ge.FLOAT},size:1,update:function(a,u,f){return[f[4]]}}})}}]),t}(vo);function PC(e){var i=OC();return function(){var r=(0,oe.Z)(e),n;if(i){var a=(0,oe.Z)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return(0,Ze.Z)(this,n)}}function OC(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var RC=`
varying vec4 v_color;
void main() {
  gl_FragColor = v_color;

}
`,kC=`uniform vec4 u_sourceColor;
uniform vec4 u_targetColor;
varying float v_distanceScale;
varying vec4 v_color;
void main() {
  gl_FragColor = mix(u_sourceColor, u_targetColor, v_distanceScale);
  gl_FragColor.a *= v_color.a; // \u5168\u5C40\u900F\u660E\u5EA6
}
`,A1=`attribute vec4 a_Color;
attribute vec2 a_Size;
attribute vec3 a_Position;

attribute float a_Total_Distance;
attribute float a_Distance;

uniform mat4 u_ModelMatrix;


uniform float u_vertexScale: 1.0;
uniform vec4 u_sourceColor;
uniform vec4 u_targetColor;



#pragma include "projection"

varying vec4 v_color;
varying float v_distanceScale;

void main() {

  v_color = a_Color; 
  v_distanceScale = a_Distance / a_Total_Distance;
  v_color.a = v_color.a * opacity;
  vec4 project_pos = project_position(vec4(a_Position.xy, 0, 1.0));

  float h = float(a_Position.z) * u_vertexScale; // \u7EBF\u9876\u70B9\u7684\u9AD8\u5EA6 - \u517C\u5BB9\u4E0D\u5B58\u5728\u7B2C\u4E09\u4E2A\u6570\u503C\u7684\u60C5\u51B5

  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    gl_Position = u_Mvp * (vec4(project_pos.xy, project_pixel(a_Size.y) + h * 0.2, 1.0));
  } else {
    float lineHeight = a_Size.y;
    // \u517C\u5BB9 mapbox \u5728\u7EBF\u9AD8\u5EA6\u4E0A\u7684\u6548\u679C\u8868\u73B0\u57FA\u672C\u4E00\u81F4
    if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
      // \u4FDD\u6301\u9AD8\u5EA6\u76F8\u5BF9\u4E0D\u53D8
      h *= 2.0/pow(2.0, 20.0 - u_Zoom);
    }

    // amap1.x
    if(u_CoordinateSystem == COORDINATE_SYSTEM_P20 || u_CoordinateSystem == COORDINATE_SYSTEM_P20_OFFSET) {
      // \u4FDD\u6301\u9AD8\u5EA6\u76F8\u5BF9\u4E0D\u53D8
      lineHeight *= pow(2.0, 20.0 - u_Zoom);
    }

    gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy, lineHeight + h, 1.0));
    gl_PointSize = 10.0;
  }
}
`,fP=In.isNumber,DC=function(e){(0,ke.Z)(t,e);var i=PC(t);function t(){return(0,ue.Z)(this,t),i.apply(this,arguments)}return(0,me.Z)(t,[{key:"getUninforms",value:function(){var n=this.layer.getLayerConfig(),a=n.opacity,u=a===void 0?1:a,f=n.sourceColor,g=n.targetColor,x=n.vertexHeightScale,I=x===void 0?20:x,O=0,B=[0,0,0,0],W=[0,0,0,0];return f&&g&&(B=Ni(f),W=Ni(g),O=1),(0,X.Z)({u_linearColor:O,u_sourceColor:B,u_targetColor:W,u_vertexScale:I},this.getStyleAttribute())}},{key:"initModels",value:function(){var r=(0,ur.Z)(nt().mark(function a(){return nt().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return f.abrupt("return",this.buildModels());case 1:case"end":return f.stop()}},a,this)}));function n(){return r.apply(this,arguments)}return n}()},{key:"getShaders",value:function(){var n=this.layer.getLayerConfig(),a=n.sourceColor,u=n.targetColor;return a&&u?{frag:kC,vert:A1,type:"lineSimpleLinear"}:{frag:RC,vert:A1,type:"lineSimpleNormal"}}},{key:"buildModels",value:function(){var r=(0,ur.Z)(nt().mark(function a(){var u,f,g,x,I;return nt().wrap(function(B){for(;;)switch(B.prev=B.next){case 0:return u=this.getShaders(),f=u.frag,g=u.vert,x=u.type,B.next=3,this.layer.buildLayerModel({moduleName:x,vertexShader:g,fragmentShader:f,triangulation:TS,inject:this.getInject(),primitive:Ge.LINES,depth:{enable:!1},pick:!1});case 3:return I=B.sent,B.abrupt("return",[I]);case 5:case"end":return B.stop()}},a,this)}));function n(){return r.apply(this,arguments)}return n}()},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"distance",type:mn.Attribute,descriptor:{name:"a_Distance",buffer:{usage:Ge.STATIC_DRAW,data:[],type:Ge.FLOAT},size:1,update:function(a,u,f){return[f[3]]}}}),this.styleAttributeService.registerStyleAttribute({name:"total_distance",type:mn.Attribute,descriptor:{name:"a_Total_Distance",buffer:{usage:Ge.STATIC_DRAW,data:[],type:Ge.FLOAT},size:1,update:function(a,u,f){return[f[5]]}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:mn.Attribute,descriptor:{name:"a_Size",buffer:{usage:Ge.DYNAMIC_DRAW,data:[],type:Ge.FLOAT},size:2,update:function(a){var u=a.size,f=u===void 0?1:u;return Array.isArray(f)?[f[0],f[1]]:[f,0]}}})}}]),t}(vo);function NC(e){var i=FC();return function(){var r=(0,oe.Z)(e),n;if(i){var a=(0,oe.Z)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return(0,Ze.Z)(this,n)}}function FC(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var BC=`#define Animate 0.0
#define LineTexture 1.0

// line texture
uniform float u_line_texture;
uniform sampler2D u_texture;
uniform vec2 u_textSize;
uniform float u_linearColor: 0;
uniform vec4 u_sourceColor;
uniform vec4 u_targetColor;
uniform float u_opacity : 1.0;
uniform float u_textureBlend;
uniform float u_iconStepCount;
uniform float u_time;
uniform vec4 u_animate: [ 1., 2., 1.0, 0.2 ]; // \u63A7\u5236\u8FD0\u52A8

varying vec2 v_iconMapUV;
varying float v_blur;
varying float v_radio;
varying vec4 v_color;
varying vec4 v_dataset;

#pragma include "picking"

void main() {
  float opacity = u_opacity;
  float animateSpeed = 0.0; // \u8FD0\u52A8\u901F\u5EA6
  float d_distance_ratio = v_dataset.r; // \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B
  float v = v_dataset.a;

  if(u_linearColor == 1.0) { // \u4F7F\u7528\u6E10\u53D8\u989C\u8272
    gl_FragColor = mix(u_sourceColor, u_targetColor, v);
  } else { // \u4F7F\u7528 color \u65B9\u6CD5\u4F20\u5165\u7684\u989C\u8272
     gl_FragColor = v_color;
  }

  gl_FragColor.a *= opacity; // \u5168\u5C40\u900F\u660E\u5EA6
  if(u_animate.x == Animate) {
      animateSpeed = u_time / u_animate.y;
       float alpha =1.0 - fract( mod(1.0- d_distance_ratio, u_animate.z)* (1.0/ u_animate.z) + animateSpeed);
      alpha = (alpha + u_animate.w -1.0) / u_animate.w;
      alpha = smoothstep(0., 1., alpha);
      gl_FragColor.a *= alpha;
  }

  if(u_line_texture == LineTexture) { // while load texture
    float aDistance = v_dataset.g;      // \u5F53\u524D\u9876\u70B9\u7684\u8DDD\u79BB
    float d_texPixelLen = v_dataset.b;  // \u8D34\u56FE\u7684\u50CF\u7D20\u957F\u5EA6\uFF0C\u6839\u636E\u5730\u56FE\u5C42\u7EA7\u7F29\u653E
    float u = fract(mod(aDistance, d_texPixelLen)/d_texPixelLen - animateSpeed);
    float v = v_dataset.a;  // \u7EBF\u56FE\u5C42\u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\u503C

    // \u8BA1\u7B97\u7EB9\u7406\u95F4\u9694 start
    float flag = 0.0;
    if(u > 1.0/u_iconStepCount) {
      flag = 1.0;
    }
    u = fract(u*u_iconStepCount);
    // \u8BA1\u7B97\u7EB9\u7406\u95F4\u9694 end

    vec2 uv= v_iconMapUV / u_textSize + vec2(u, v) / u_textSize * 64.;
    vec4 pattern = texture2D(u_texture, uv);

    // Tip: \u5224\u65AD\u7EB9\u7406\u95F4\u9694
    if(flag > 0.0) {
      pattern = vec4(0.0);
    }

    if(u_textureBlend == 0.0) { // normal
      pattern.a = 0.0;
      gl_FragColor = filterColor(gl_FragColor + pattern);
    } else { // replace
        pattern.a *= opacity;
        if(gl_FragColor.a <= 0.0) {
          pattern.a = 0.0;
        }
        gl_FragColor = filterColor(pattern);
    }
  }
  

  // blur - AA
  if(v < v_blur) {
    gl_FragColor.a = mix(0.0, gl_FragColor.a, v/v_blur);
  } else if(v > 1.0 - v_blur) {
    gl_FragColor.a = mix(gl_FragColor.a, 0.0, (v - (1.0 - v_blur))/v_blur);
  }

  gl_FragColor = filterColor(gl_FragColor);
}
`,ZC=`#define Animate 0.0

attribute float a_Miter;
attribute vec4 a_Color;
attribute vec2 a_Size;
attribute vec3 a_Normal;
attribute vec3 a_Position;
attribute vec2 a_iconMapUV;
attribute float a_Total_Distance;
attribute float a_Distance;

uniform mat4 u_ModelMatrix;

uniform vec4 u_animate: [ 1., 2., 1.0, 0.2 ];
uniform float u_icon_step: 100;
uniform float u_heightfixed;
uniform float u_linearColor: 0;

#pragma include "projection"
#pragma include "light"
#pragma include "picking"

// texV \u7EBF\u56FE\u5C42 - \u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\uFF08\u7EBF\u7684\u5BBD\u5EA6\u65B9\u5411\uFF09
varying vec2 v_iconMapUV;
varying vec4 v_color;
varying float v_blur;
varying float v_radio;
varying vec4 v_dataset;

void main() {


  float d_distance_ratio; // \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B
  float d_texPixelLen;    // \u8D34\u56FE\u7684\u50CF\u7D20\u957F\u5EA6\uFF0C\u6839\u636E\u5730\u56FE\u5C42\u7EA7\u7F29\u653E

  v_iconMapUV = a_iconMapUV;
  if(u_heightfixed < 1.0) {     // \u9AD8\u5EA6\u968F zoom \u8C03\u6574
    d_texPixelLen = project_pixel(u_icon_step);
  } else {
    d_texPixelLen = u_icon_step;
  }
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) {
    d_texPixelLen *= 10.0;
  }

  if(u_animate.x == Animate || u_linearColor == 1.0) {
      d_distance_ratio = a_Distance / a_Total_Distance;
  }

  float miter = (a_Miter + 1.0)/2.0;
  // \u8BBE\u7F6E\u6570\u636E\u96C6\u7684\u53C2\u6570
  v_dataset[0] = d_distance_ratio; // \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B
  v_dataset[1] = a_Distance;       // \u5F53\u524D\u9876\u70B9\u7684\u8DDD\u79BB
  v_dataset[2] = d_texPixelLen;    // \u8D34\u56FE\u7684\u50CF\u7D20\u957F\u5EA6\uFF0C\u6839\u636E\u5730\u56FE\u5C42\u7EA7\u7F29\u653E
  v_dataset[3] = miter;          // \u7EBF\u56FE\u5C42\u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\u503C 0 - 1

  vec4 project_pos = project_position(vec4(a_Position.xy, 0, 1.0));

  float originSize = a_Size.x;  // \u56FA\u5B9A\u9AD8\u5EA6
  if(u_heightfixed < 1.0) {     // \u9AD8\u5EA6\u968F zoom \u8C03\u6574
    originSize = project_float_pixel(a_Size.x);
  }

  float wallHeight = originSize * miter;
  float lightWeight = calc_lighting(vec4(project_pos.xy, wallHeight, 1.0));

  v_blur = min(project_float_pixel(2.0) / originSize, 0.05);
  v_color = vec4(a_Color.rgb * lightWeight, a_Color.w);

  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    gl_Position = u_Mvp * (vec4(project_pos.xy, wallHeight, 1.0));
  } else {
    gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy, wallHeight, 1.0));
  }

  setPickingColor(a_PickingColor);
}
`,hP=In.isNumber,zC=function(e){(0,ke.Z)(t,e);var i=NC(t);function t(){var r;(0,ue.Z)(this,t);for(var n=arguments.length,a=new Array(n),u=0;u<n;u++)a[u]=arguments[u];return r=i.call.apply(i,[this].concat(a)),(0,Ce.Z)((0,bt.Z)(r),"updateTexture",function(){var f=r.rendererService.createTexture2D;if(r.texture){r.texture.update({data:r.iconService.getCanvas()}),r.layer.render();return}r.texture=f({data:r.iconService.getCanvas(),mag:Ge.NEAREST,min:Ge.NEAREST,premultiplyAlpha:!1,width:1024,height:r.iconService.canvasHeight||128})}),r}return(0,me.Z)(t,[{key:"getUninforms",value:function(){var n=this.layer.getLayerConfig(),a=n.sourceColor,u=n.targetColor,f=n.textureBlend,g=f===void 0?"normal":f,x=n.heightfixed,I=x===void 0?!1:x,O=n.lineTexture,B=O===void 0?!1:O,W=n.iconStep,he=W===void 0?100:W,ae=n.iconStepCount,Se=ae===void 0?1:ae;this.rendererService.getDirty()&&this.texture.bind();var Fe=0,Qe=[0,0,0,0],qe=[0,0,0,0];return a&&u&&(Qe=Ni(a),qe=Ni(u),Fe=1),(0,X.Z)({u_heightfixed:Number(I),u_textureBlend:g==="normal"?0:1,u_texture:this.texture,u_line_texture:B?1:0,u_iconStepCount:Se,u_icon_step:he,u_textSize:[1024,this.iconService.canvasHeight||128],u_linearColor:Fe,u_sourceColor:Qe,u_targetColor:qe},this.getStyleAttribute())}},{key:"getAnimateUniforms",value:function(){var n=this.layer.getLayerConfig(),a=n.animateOption;return{u_animate:this.animateOption2Array(a),u_time:this.layer.getLayerAnimateTime()}}},{key:"initModels",value:function(){var r=(0,ur.Z)(nt().mark(function a(){return nt().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return this.updateTexture(),this.iconService.on("imageUpdate",this.updateTexture),f.abrupt("return",this.buildModels());case 3:case"end":return f.stop()}},a,this)}));function n(){return r.apply(this,arguments)}return n}()},{key:"clearModels",value:function(){var n;(n=this.texture)===null||n===void 0||n.destroy(),this.iconService.off("imageUpdate",this.updateTexture)}},{key:"buildModels",value:function(){var r=(0,ur.Z)(nt().mark(function a(){var u;return nt().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return g.next=2,this.layer.buildLayerModel({moduleName:"lineWall",vertexShader:ZC,fragmentShader:BC,triangulation:Ag,inject:this.getInject(),depth:{enable:!1},blend:this.getBlend()});case 2:return u=g.sent,g.abrupt("return",[u]);case 4:case"end":return g.stop()}},a,this)}));function n(){return r.apply(this,arguments)}return n}()},{key:"registerBuiltinAttributes",value:function(){var n=this;this.styleAttributeService.registerStyleAttribute({name:"distance",type:mn.Attribute,descriptor:{name:"a_Distance",buffer:{usage:Ge.STATIC_DRAW,data:[],type:Ge.FLOAT},size:1,update:function(u,f,g){return[g[3]]}}}),this.styleAttributeService.registerStyleAttribute({name:"total_distance",type:mn.Attribute,descriptor:{name:"a_Total_Distance",buffer:{usage:Ge.STATIC_DRAW,data:[],type:Ge.FLOAT},size:1,update:function(u,f,g){return[g[5]]}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:mn.Attribute,descriptor:{name:"a_Size",buffer:{usage:Ge.DYNAMIC_DRAW,data:[],type:Ge.FLOAT},size:2,update:function(u){var f=u.size,g=f===void 0?1:f;return Array.isArray(g)?[g[0],g[1]]:[g,0]}}}),this.styleAttributeService.registerStyleAttribute({name:"normal",type:mn.Attribute,descriptor:{name:"a_Normal",buffer:{usage:Ge.STATIC_DRAW,data:[],type:Ge.FLOAT},size:3,update:function(u,f,g,x,I){return I}}}),this.styleAttributeService.registerStyleAttribute({name:"miter",type:mn.Attribute,descriptor:{name:"a_Miter",buffer:{usage:Ge.STATIC_DRAW,data:[],type:Ge.FLOAT},size:1,update:function(u,f,g){return[g[4]]}}}),this.styleAttributeService.registerStyleAttribute({name:"uv",type:mn.Attribute,descriptor:{name:"a_iconMapUV",buffer:{usage:Ge.DYNAMIC_DRAW,data:[],type:Ge.FLOAT},size:2,update:function(u){var f=n.iconService.getIconMap(),g=u.texture,x=f[g]||{x:0,y:0},I=x.x,O=x.y;return[I,O]}}})}}]),t}(vo),UC={arc:VS,arc3d:KS,greatcircle:gC,wall:zC,line:h1,simple:DC,linearline:LC,earthArc3d:oC,flowline:fC},GC=UC;function jC(e){var i=VC();return function(){var r=(0,oe.Z)(e),n;if(i){var a=(0,oe.Z)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return(0,Ze.Z)(this,n)}}function VC(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var vg=function(e){(0,ke.Z)(t,e);var i=jC(t);function t(){var r;(0,ue.Z)(this,t);for(var n=arguments.length,a=new Array(n),u=0;u<n;u++)a[u]=arguments[u];return r=i.call.apply(i,[this].concat(a)),(0,Ce.Z)((0,bt.Z)(r),"type","LineLayer"),(0,Ce.Z)((0,bt.Z)(r),"enableShaderEncodeStyles",["opacity","offsets","stroke","thetaOffset"]),(0,Ce.Z)((0,bt.Z)(r),"arrowInsertCount",0),(0,Ce.Z)((0,bt.Z)(r),"defaultSourceConfig",{data:[{lng1:100,lat1:30,lng2:130,lat2:30}],options:{parser:{type:"json",x:"lng1",y:"lat1",x1:"lng2",y1:"lat2"}}}),r}return(0,me.Z)(t,[{key:"buildModels",value:function(){var r=(0,ur.Z)(nt().mark(function a(){var u;return nt().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return u=this.getModelType(),this.layerModel=new GC[u](this),g.next=4,this.initLayerModels();case 4:case"end":return g.stop()}},a,this)}));function n(){return r.apply(this,arguments)}return n}()},{key:"getDefaultConfig",value:function(){var n=this.getModelType(),a={line:{},linearline:{},simple:{},wall:{},arc3d:{blend:"additive"},arc:{blend:"additive"},greatcircle:{blend:"additive"},tileLine:{},earthArc3d:{},flowline:{}};return a[n]}},{key:"getModelType",value:function(){var n;if(this.layerType)return this.layerType;var a=this.styleAttributeService.getLayerStyleAttribute("shape"),u=a==null||(n=a.scale)===null||n===void 0?void 0:n.field;return u||"line"}},{key:"processData",value:function(n){if(this.getModelType()!=="simple")return n;var a=[];return n.map(function(u){if(Array.isArray(u.coordinates)&&Array.isArray(u.coordinates[0])&&Array.isArray(u.coordinates[0][0])){var f=(0,X.Z)({},u);u.coordinates.map(function(g){a.push((0,X.Z)((0,X.Z)({},f),{},{coordinates:g}))})}else a.push(u)}),a}}]),t}(nA);function HC(e){var i=$C();return function(){var r=(0,oe.Z)(e),n;if(i){var a=(0,oe.Z)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return(0,Ze.Z)(this,n)}}function $C(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var WC=`
uniform float u_additive;
uniform float u_stroke_opacity : 1;

uniform vec4 u_stroke_color : [0.0, 0.0, 0.0, 0.0];

varying vec4 v_color;
varying float v_blur;
varying float v_innerRadius;

#pragma include "picking"
void main() {
  vec2 center = vec2(0.5);

  // Tip: \u7247\u5143\u5230\u4E2D\u5FC3\u70B9\u7684\u8DDD\u79BB 0 - 1
  float fragmengTocenter = distance(center, gl_PointCoord) * 2.0;
  // Tip: \u7247\u5143\u7684\u526A\u5207\u6210\u5706\u5F62
  float circleClipOpacity = 1.0 - smoothstep(v_blur, 1.0, fragmengTocenter);


  if(v_innerRadius < 0.99) {
    // \u5F53\u5B58\u5728 stroke \u4E14 stroke > 0.01
    float blurWidth = (1.0 - v_blur)/2.0;
    vec4 stroke = vec4(u_stroke_color.rgb, u_stroke_opacity);
    if(fragmengTocenter > v_innerRadius + blurWidth) {
      gl_FragColor = stroke;
    } else if(fragmengTocenter > v_innerRadius - blurWidth){
      float mixR = (fragmengTocenter - (v_innerRadius - blurWidth)) / (blurWidth * 2.0);
      gl_FragColor = mix(v_color, stroke, mixR);
    } else {
      gl_FragColor = v_color;
    }
  } else {
    // \u5F53\u4E0D\u5B58\u5728 stroke \u6216 stroke <= 0.01
    gl_FragColor = v_color;
  }

  gl_FragColor = filterColor(gl_FragColor);
  
  if(u_additive > 0.0) {
    gl_FragColor *= circleClipOpacity;
  } else {
    gl_FragColor.a *= circleClipOpacity;
  }

}
`,YC=`
attribute vec3 a_Position;
uniform mat4 u_ModelMatrix;

attribute float a_Size;
attribute vec4 a_Color;
varying vec4 v_color;

uniform float u_opacity : 1;
uniform vec2 u_offsets;
uniform float u_stroke_width;

varying float v_blur;
varying float v_innerRadius;



#pragma include "projection"
#pragma include "picking"
#pragma include "project"
void main() {
  v_color = vec4(a_Color.xyz, a_Color.w * u_opacity);
  v_blur = 1.0 - max(2.0/a_Size, 0.05);
  v_innerRadius = max((a_Size - u_stroke_width) / a_Size, 0.0);
  
  vec2 offset = project_pixel(u_offsets);
  
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    gl_Position = u_Mvp * vec4(a_Position.xy + offset, a_Position.z, 1.0);
  } else { // else
    vec4 project_pos = project_position(vec4(a_Position, 1.0)) + vec4(a_Size / 2.,-a_Size /2.,0.,0.);
    gl_Position = project_common_position_to_clipspace(vec4(vec2(project_pos.xy+offset),project_pos.z,project_pos.w));
  }
  
  gl_PointSize = a_Size * 2.0 * u_DevicePixelRatio;
  setPickingColor(a_PickingColor);
}
`;function p1(e){var i=e.coordinates;return{vertices:(0,Mr.Z)(i),indices:[0],size:i.length}}var XC=function(e){(0,ke.Z)(t,e);var i=HC(t);function t(){return(0,ue.Z)(this,t),i.apply(this,arguments)}return(0,me.Z)(t,[{key:"getDefaultStyle",value:function(){return{blend:"additive"}}},{key:"getUninforms",value:function(){var n=this.layer.getLayerConfig(),a=n.opacity,u=a===void 0?1:a,f=n.offsets,g=f===void 0?[0,0]:f,x=n.blend,I=n.strokeOpacity,O=I===void 0?1:I,B=n.strokeWidth,W=B===void 0?0:B,he=n.stroke,ae=he===void 0?"#fff":he;return{u_additive:x==="additive"?1:0,u_opacity:u,u_offsets:g,u_stroke_opacity:O,u_stroke_width:W,u_stroke_color:Ni(ae)}}},{key:"initModels",value:function(){var r=(0,ur.Z)(nt().mark(function a(){return nt().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return f.abrupt("return",this.buildModels());case 1:case"end":return f.stop()}},a,this)}));function n(){return r.apply(this,arguments)}return n}()},{key:"buildModels",value:function(){var r=(0,ur.Z)(nt().mark(function a(){var u;return nt().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return this.layer.triangulation=p1,g.next=3,this.layer.buildLayerModel({moduleName:"pointSimple",vertexShader:YC,fragmentShader:WC,triangulation:p1,depth:{enable:!1},primitive:Ge.POINTS});case 3:return u=g.sent,g.abrupt("return",[u]);case 5:case"end":return g.stop()}},a,this)}));function n(){return r.apply(this,arguments)}return n}()},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"size",type:mn.Attribute,descriptor:{name:"a_Size",buffer:{usage:Ge.DYNAMIC_DRAW,data:[],type:Ge.FLOAT},size:1,update:function(a){var u=a.size,f=u===void 0?1:u;return Array.isArray(f)?[f[0]]:[f]}}})}}]),t}(vo);function QC(e){var i=qC();return function(){var r=(0,oe.Z)(e),n;if(i){var a=(0,oe.Z)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return(0,Ze.Z)(this,n)}}function qC(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var KC=`varying vec4 v_color;
uniform float u_opacity: 1.0;

uniform float u_pickLight: 0.0;

#pragma include "picking"


uniform float u_linearColor: 0;
uniform vec4 u_sourceColor;
uniform vec4 u_targetColor;

uniform float u_opacitylinear: 0.0;
uniform float u_opacitylinear_dir: 1.0;
varying float v_lightWeight;
varying float v_barLinearZ;
void main() {

   gl_FragColor = v_color;

  // \u5F00\u542F\u900F\u660E\u5EA6\u6E10\u53D8
  if(u_opacitylinear > 0.0) {
    gl_FragColor.a *= u_opacitylinear_dir > 0.0 ? (1.0 - v_barLinearZ): v_barLinearZ;
  }

  // picking
  if(u_pickLight > 0.0) {
    gl_FragColor = filterColorAlpha(gl_FragColor, v_lightWeight);
  } else {
    gl_FragColor = filterColor(gl_FragColor);
  }
}
`,JC=`precision highp float;

#define pi 3.1415926535
#define ambientRatio 0.5
#define diffuseRatio 0.3
#define specularRatio 0.2

attribute vec3 a_Position;
attribute vec3 a_Pos;
attribute vec4 a_Color;
attribute vec3 a_Size;
attribute vec3 a_Normal;

uniform float u_heightfixed: 0.0; // \u9ED8\u8BA4\u4E0D\u56FA\u5B9A
uniform float u_globel;
uniform float u_r;
uniform mat4 u_ModelMatrix;

varying vec4 v_color;

uniform float u_opacity : 1;
uniform float u_lightEnable: 1;
varying float v_lightWeight;
varying float v_barLinearZ;
// \u7528\u4E8E\u5C06\u5728\u9876\u70B9\u7740\u8272\u5668\u4E2D\u8BA1\u7B97\u597D\u7684\u6837\u5F0F\u503C\u4F20\u9012\u7ED9\u7247\u5143


#pragma include "projection"
#pragma include "light"
#pragma include "picking"

float getYRadian(float x, float z) {
  if(x > 0.0 && z > 0.0) {
    return atan(x/z);
  } else if(x > 0.0 && z <= 0.0){
    return atan(-z/x) + pi/2.0;
  } else if(x <= 0.0 && z <= 0.0) {
    return  pi + atan(x/z); //atan(x/z) + 
  } else {
    return atan(z/-x) + pi*3.0/2.0;
  }
}

float getXRadian(float y, float r) {
  return atan(y/r);
}

void main() {

  
  float textureOffset = 0.0; // \u5728 cell \u4E2D\u53D6\u503C\u7684\u504F\u79FB\u91CF

  textureOffset = opacityAndOffset.g;
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
  vec3 size = a_Size * a_Position;

  // a_Position.z \u662F\u5728\u6784\u5EFA\u7F51\u683C\u7684\u65F6\u5019\u4F20\u5165\u7684\u6807\u51C6\u503C 0 - 1\uFF0C\u5728\u63D2\u503C\u5668\u63D2\u503C\u53EF\u4EE5\u83B7\u53D6 0\uFF5E1 \u7EBF\u6027\u6E10\u53D8\u7684\u503C
  v_barLinearZ =  a_Position.z;

  vec3 offset = size; // \u63A7\u5236\u5706\u67F1\u4F53\u7684\u5927\u5C0F - \u4ECE\u6807\u51C6\u5355\u4F4D\u5706\u67F1\u4F53\u8FDB\u884C\u504F\u79FB
  if(u_heightfixed < 1.0) { // \u5706\u67F1\u4F53\u4E0D\u56FA\u5B9A\u9AD8\u5EA6
    
    if (u_CoordinateSystem == COORDINATE_SYSTEM_P20 || u_CoordinateSystem == COORDINATE_SYSTEM_P20_OFFSET) {
      // P20 \u5750\u6807\u7CFB\u4E0B\uFF0C\u4E3A\u4E86\u548C Web \u58A8\u5361\u6258\u5750\u6807\u7CFB\u7EDF\u4E00\uFF0Czoom \u9ED8\u8BA4\u51CF1
      offset = offset * pow(2.0, (19.0 - u_Zoom));
    }
    if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) {
      // P20_2 \u5750\u6807\u7CFB\u4E0B\uFF0C\u4E3A\u4E86\u548C Web \u58A8\u5361\u6258\u5750\u6807\u7CFB\u7EDF\u4E00\uFF0Czoom \u9ED8\u8BA4\u51CF3
      offset = offset * pow(2.0, (19.0 - 3.0 - u_Zoom));
    }
  } else {// \u5706\u67F1\u4F53\u56FA\u5B9A\u9AD8\u5EA6 \uFF08 \u5904\u7406 mapbox \uFF09
    if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
      offset *= 4.0/pow(2.0, 21.0 - u_Zoom);
    }
  }


  vec4 project_pos = project_position(vec4(a_Pos.xy, 0., 1.0));

  // u_r \u63A7\u5236\u5706\u67F1\u7684\u751F\u957F
  vec4 pos = vec4(project_pos.xy + offset.xy, offset.z * u_r, 1.0);

  // \u5706\u67F1\u5149\u7167\u6548\u679C
  float lightWeight = 1.0;
  if(u_lightEnable > 0.0) { // \u53D6\u6D88\u4E09\u5143\u8868\u8FBE\u5F0F\uFF0C\u589E\u5F3A\u5065\u58EE\u6027
    lightWeight = calc_lighting(pos);
  }
  v_lightWeight = lightWeight;
  // \u8BBE\u7F6E\u5706\u67F1\u7684\u5E95\u8272
  if(u_linearColor == 1.0) { // \u4F7F\u7528\u6E10\u53D8\u989C\u8272
    v_color = mix(u_sourceColor, u_targetColor, barLinearZ);
    v_color.rgb *= lightWeight;
  } else { // \u4F7F\u7528 color \u65B9\u6CD5\u4F20\u5165\u7684\u989C\u8272
     v_color = a_Color;
  }
  v_color.a *= u_opacity;

    
  // \u5728\u5730\u7403\u6A21\u5F0F\u4E0B\uFF0C\u5C06\u539F\u672C\u5782\u76F4\u4E8E xy \u5E73\u9762\u7684\u5706\u67F1\u8C03\u6574\u59FF\u6001\u5230\u9002\u5E94\u5706\u7684\u89D2\u5EA6
  //\u65CB\u8F6C\u77E9\u9635mx\uFF0C\u521B\u5EFA\u7ED5x\u8F74\u65CB\u8F6C\u77E9\u9635
  float r = sqrt(a_Pos.z*a_Pos.z + a_Pos.x*a_Pos.x);
  float xRadian = getXRadian(a_Pos.y, r);
  float xcos = cos(xRadian);//\u6C42\u89E3\u65CB\u8F6C\u89D2\u5EA6\u4F59\u5F26\u503C
  float xsin = sin(xRadian);//\u6C42\u89E3\u65CB\u8F6C\u89D2\u5EA6\u6B63\u5F26\u503C
  mat4 mx = mat4(
    1,0,0,0,  
    0,xcos,-xsin,0,  
    0,xsin,xcos,0,  
    0,0,0,1);

  //\u65CB\u8F6C\u77E9\u9635my\uFF0C\u521B\u5EFA\u7ED5y\u8F74\u65CB\u8F6C\u77E9\u9635
  float yRadian = getYRadian(a_Pos.x, a_Pos.z);
  float ycos = cos(yRadian);//\u6C42\u89E3\u65CB\u8F6C\u89D2\u5EA6\u4F59\u5F26\u503C
  float ysin = sin(yRadian);//\u6C42\u89E3\u65CB\u8F6C\u89D2\u5EA6\u6B63\u5F26\u503C
  mat4 my = mat4(
    ycos,0,-ysin,0,  
    0,1,0,0,  
    ysin,0,ycos,0,  
    0,0,0,1);

  gl_Position = u_ViewProjectionMatrix * vec4(( my * mx *  vec4(a_Position * a_Size, 1.0)).xyz + a_Pos, 1.0);
  

  setPickingColor(a_PickingColor);
}
`,ew=In.isNumber,tw=function(e){(0,ke.Z)(t,e);var i=QC(t);function t(){var r;(0,ue.Z)(this,t);for(var n=arguments.length,a=new Array(n),u=0;u<n;u++)a[u]=arguments[u];return r=i.call.apply(i,[this].concat(a)),(0,Ce.Z)((0,bt.Z)(r),"raiseCount",0),(0,Ce.Z)((0,bt.Z)(r),"raiseRepeat",0),r}return(0,me.Z)(t,[{key:"getUninforms",value:function(){var n=this.layer.getLayerConfig(),a=n.animateOption,u=a===void 0?{enable:!1,speed:.01,repeat:!1}:a,f=n.opacity,g=f===void 0?1:f,x=n.sourceColor,I=n.targetColor,O=n.pickLight,B=O===void 0?!1:O,W=n.heightfixed,he=W===void 0?!1:W,ae=n.opacityLinear,Se=ae===void 0?{enable:!1,dir:"up"}:ae,Fe=n.lightEnable,Qe=Fe===void 0?!0:Fe,qe=0,yt=[0,0,0,0],Et=[0,0,0,0];if(x&&I&&(yt=Ni(x),Et=Ni(I),qe=1),this.raiseCount<1&&this.raiseRepeat>0&&u.enable){var Ot=u.speed,jt=Ot===void 0?.01:Ot;this.raiseCount+=jt,this.raiseCount>=1&&(this.raiseRepeat>1?(this.raiseCount=0,this.raiseRepeat--):this.raiseCount=1)}return{u_pickLight:Number(B),u_heightfixed:Number(he),u_r:u.enable&&this.raiseRepeat>0?this.raiseCount:1,u_opacity:ew(g)?g:1,u_linearColor:qe,u_sourceColor:yt,u_targetColor:Et,u_opacitylinear:Number(Se.enable),u_opacitylinear_dir:Se.dir==="up"?1:0,u_lightEnable:Number(Qe)}}},{key:"initModels",value:function(){var r=(0,ur.Z)(nt().mark(function a(){return nt().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return f.abrupt("return",this.buildModels());case 1:case"end":return f.stop()}},a,this)}));function n(){return r.apply(this,arguments)}return n}()},{key:"buildModels",value:function(){var r=(0,ur.Z)(nt().mark(function a(){var u,f,g,x;return nt().wrap(function(O){for(;;)switch(O.prev=O.next){case 0:return u=this.layer.getLayerConfig(),f=u.animateOption.repeat,g=f===void 0?1:f,this.raiseRepeat=g,O.next=4,this.layer.buildLayerModel({moduleName:"pointEarthExtrude",vertexShader:JC,fragmentShader:KC,triangulation:u1,depth:{enable:!0},cull:{enable:!0,face:uu(this.mapService.version)},blend:this.getBlend()});case 4:return x=O.sent,O.abrupt("return",[x]);case 6:case"end":return O.stop()}},a,this)}));function n(){return r.apply(this,arguments)}return n}()},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"size",type:mn.Attribute,descriptor:{name:"a_Size",buffer:{usage:Ge.DYNAMIC_DRAW,data:[],type:Ge.FLOAT},size:3,update:function(a){var u=a.size;if(u){var f=[];return Array.isArray(u)&&(f=u.length===2?[u[0],u[0],u[1]]:u),Array.isArray(u)||(f=[u,u,u]),f}else return[2,2,2]}}}),this.styleAttributeService.registerStyleAttribute({name:"normal",type:mn.Attribute,descriptor:{name:"a_Normal",buffer:{usage:Ge.STATIC_DRAW,data:[],type:Ge.FLOAT},size:3,update:function(a,u,f,g,x){return x}}}),this.styleAttributeService.registerStyleAttribute({name:"pos",type:mn.Attribute,descriptor:{name:"a_Pos",buffer:{usage:Ge.DYNAMIC_DRAW,data:[],type:Ge.FLOAT},size:3,update:function(a){var u=Is(a.coordinates);return Vy([u[0],u[1]])}}})}}]),t}(vo);function rw(e){var i=nw();return function(){var r=(0,oe.Z)(e),n;if(i){var a=(0,oe.Z)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return(0,Ze.Z)(this,n)}}function nw(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var iw=`uniform float u_additive;
uniform float u_opacity : 1;
uniform float u_stroke_opacity : 1;
uniform float u_stroke_width : 2;

varying vec4 v_data;
varying vec4 v_color;
varying float v_radius;

#pragma include "sdf_2d"
#pragma include "picking"


void main() {
  int shape = int(floor(v_data.w + 0.5));

  vec4 strokeColor = textrueStroke == vec4(0) ? v_color : textrueStroke;

  lowp float antialiasblur = v_data.z;
  float r = v_radius / (v_radius + strokeWidth);

  float outer_df;
  float inner_df;
  // 'circle', 'triangle', 'square', 'pentagon', 'hexagon', 'octogon', 'hexagram', 'rhombus', 'vesica'
  if (shape == 0) {
    outer_df = sdCircle(v_data.xy, 1.0);
    inner_df = sdCircle(v_data.xy, r);
  } else if (shape == 1) {
    outer_df = sdEquilateralTriangle(1.1 * v_data.xy);
    inner_df = sdEquilateralTriangle(1.1 / r * v_data.xy);
  } else if (shape == 2) {
    outer_df = sdBox(v_data.xy, vec2(1.));
    inner_df = sdBox(v_data.xy, vec2(r));
  } else if (shape == 3) {
    outer_df = sdPentagon(v_data.xy, 0.8);
    inner_df = sdPentagon(v_data.xy, r * 0.8);
  } else if (shape == 4) {
    outer_df = sdHexagon(v_data.xy, 0.8);
    inner_df = sdHexagon(v_data.xy, r * 0.8);
  } else if (shape == 5) {
    outer_df = sdOctogon(v_data.xy, 1.0);
    inner_df = sdOctogon(v_data.xy, r);
  } else if (shape == 6) {
    outer_df = sdHexagram(v_data.xy, 0.52);
    inner_df = sdHexagram(v_data.xy, r * 0.52);
  } else if (shape == 7) {
    outer_df = sdRhombus(v_data.xy, vec2(1.0));
    inner_df = sdRhombus(v_data.xy, vec2(r));
  } else if (shape == 8) {
    outer_df = sdVesica(v_data.xy, 1.1, 0.8);
    inner_df = sdVesica(v_data.xy, r * 1.1, r * 0.8);
  }

  if(outer_df > antialiasblur + 0.018) discard;

  float opacity_t = smoothstep(0.0, antialiasblur, outer_df);

  float color_t = strokeWidth < 0.01 ? 0.0 : smoothstep(
    antialiasblur,
    0.0,
    inner_df
  );

  if(strokeWidth < 0.01) {
    gl_FragColor = vec4(v_color.rgb, v_color.a * u_opacity);
  } else {
    gl_FragColor = mix(vec4(v_color.rgb, v_color.a * u_opacity), u_stroke_color * u_stroke_opacity, color_t);
  }

  if(u_additive > 0.0) {
    gl_FragColor *= opacity_t;
    gl_FragColor = filterColorAlpha(gl_FragColor, gl_FragColor.a);
  } else {
    gl_FragColor.a *= opacity_t;
    gl_FragColor = filterColor(gl_FragColor);
  }
}
`,aw=`attribute vec4 a_Color;
attribute vec3 a_Position;
attribute vec3 a_Extrude;
attribute float a_Size;
attribute float a_Shape;
uniform mat4 u_ModelMatrix;


varying vec4 v_data;
varying vec4 v_color;
varying float v_radius;

uniform float u_opacity : 1;
uniform float u_stroke_opacity : 1;
uniform float u_stroke_width : 2;
uniform vec4 u_stroke_color : [0.0, 0.0, 0.0, 0.0];
uniform vec2 u_offsets;

uniform float u_blur : 0.0;

#pragma include "projection"
#pragma include "picking"


void main() {
  vec3 extrude = a_Extrude;
  float shape_type = a_Shape;
  /*
  *  setPickingSize \u8BBE\u7F6E\u62FE\u53D6\u5927\u5C0F
  */
  float newSize = setPickingSize(a_Size);
  // float newSize = setPickingSize(a_Size) * 0.00001038445708445579;

  // unpack color(vec2)
  v_color = a_Color;

  // radius(16-bit)
  v_radius = newSize;

  // anti-alias
  //  float antialiased_blur = -max(u_blur, antialiasblur);
  float antialiasblur = -max(2.0 / u_DevicePixelRatio / newSize, u_blur);

  // TODP: /abs(extrude.x) \u662F\u4E3A\u4E86\u517C\u5BB9\u5730\u7403\u6A21\u5F0F
  v_data = vec4(extrude.x/abs(extrude.x), extrude.y/abs(extrude.y), antialiasblur,shape_type);


  gl_Position = u_ViewProjectionMatrix * vec4(a_Position + extrude * newSize * 0.1 + u_offsets, 1.0);

  setPickingColor(a_PickingColor);
}
`,ow=function(e){(0,ke.Z)(t,e);var i=rw(t);function t(){return(0,ue.Z)(this,t),i.apply(this,arguments)}return(0,me.Z)(t,[{key:"getUninforms",value:function(){var n=this.layer.getLayerConfig(),a=n.opacity,u=a===void 0?1:a,f=n.strokeOpacity,g=f===void 0?1:f,x=n.strokeWidth,I=x===void 0?0:x,O=n.stroke,B=O===void 0?"rgba(0,0,0,0)":O,W=n.blend,he=n.blur,ae=he===void 0?0:he;return{u_blur:ae,u_additive:W==="additive"?1:0,u_opacity:u,u_stroke_opacity:g,u_stroke_width:I,u_stroke_color:Ni(B)}}},{key:"getAnimateUniforms",value:function(){var n=this.layer.getLayerConfig(),a=n.animateOption,u=a===void 0?{enable:!1}:a;return{u_animate:this.animateOption2Array(u),u_time:this.layer.getLayerAnimateTime()}}},{key:"initModels",value:function(){var r=(0,ur.Z)(nt().mark(function a(){return nt().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return f.abrupt("return",this.buildModels());case 1:case"end":return f.stop()}},a,this)}));function n(){return r.apply(this,arguments)}return n}()},{key:"buildModels",value:function(){var r=(0,ur.Z)(nt().mark(function a(){var u;return nt().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return this.layer.triangulation=s1,g.next=3,this.layer.buildLayerModel({moduleName:"pointEarthFill",vertexShader:aw,fragmentShader:iw,triangulation:s1,depth:{enable:!0},blend:this.getBlend()});case 3:return u=g.sent,g.abrupt("return",[u]);case 5:case"end":return g.stop()}},a,this)}));function n(){return r.apply(this,arguments)}return n}()},{key:"animateOption2Array",value:function(n){return[n.enable?0:1,n.speed||1,n.rings||3,0]}},{key:"registerBuiltinAttributes",value:function(){var n=this;this.styleAttributeService.registerStyleAttribute({name:"extrude",type:mn.Attribute,descriptor:{name:"a_Extrude",buffer:{usage:Ge.DYNAMIC_DRAW,data:[],type:Ge.FLOAT},size:3,update:function(u,f,g,x){var I=(0,vn.Z)(g,3),O=I[0],B=I[1],W=I[2],he=Lu(0,0,1),ae=Lu(O,0,W),Se=O>=0?cg(he,ae):Math.PI*2-cg(he,ae),Fe=Math.PI*2-Math.asin(B/100),Qe=Qn();Q0(Qe,Qe,Se),cc(Qe,Qe,Fe);var qe=Lu(1,1,0);fp(qe,qe,Qe),sA(qe,qe);var yt=Lu(-1,1,0);fp(yt,yt,Qe),sA(yt,yt);var Et=Lu(-1,-1,0);fp(Et,Et,Qe),sA(Et,Et);var Ot=Lu(1,-1,0);fp(Ot,Ot,Qe),sA(Ot,Ot);var jt=[].concat((0,Mr.Z)(qe),(0,Mr.Z)(yt),(0,Mr.Z)(Et),(0,Mr.Z)(Ot)),or=x%4*3;return[jt[or],jt[or+1],jt[or+2]]}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:mn.Attribute,descriptor:{name:"a_Size",buffer:{usage:Ge.DYNAMIC_DRAW,data:[],type:Ge.FLOAT},size:1,update:function(u){var f=u.size,g=f===void 0?5:f;return Array.isArray(g)?[g[0]]:[g]}}}),this.styleAttributeService.registerStyleAttribute({name:"shape",type:mn.Attribute,descriptor:{name:"a_Shape",buffer:{usage:Ge.DYNAMIC_DRAW,data:[],type:Ge.FLOAT},size:1,update:function(u){var f=u.shape,g=f===void 0?2:f,x=n.layer.getLayerConfig().shape2d,I=x.indexOf(g);return[I]}}})}}]),t}(vo);function sw(e){var i=uw();return function(){var r=(0,oe.Z)(e),n;if(i){var a=(0,oe.Z)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return(0,Ze.Z)(this,n)}}function uw(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var lw=`varying vec4 v_color;
varying float v_lightWeight;
uniform float u_pickLight: 0.0;

#pragma include "picking"


void main() {

  gl_FragColor = v_color;
  // \u5F00\u542F\u900F\u660E\u5EA6\u6E10\u53D8
  // picking
  if(u_pickLight > 0.0) {
    gl_FragColor = filterColorAlpha(gl_FragColor, v_lightWeight);
  } else {
    gl_FragColor = filterColor(gl_FragColor);
  }
}
`,cw=`precision highp float;

#define pi 3.1415926535
#define ambientRatio 0.5
#define diffuseRatio 0.3
#define specularRatio 0.2

attribute vec3 a_Position;
attribute vec3 a_Pos;
attribute vec4 a_Color;
attribute vec3 a_Size;
attribute vec3 a_Normal;

uniform float u_heightfixed: 0.0; // \u9ED8\u8BA4\u4E0D\u56FA\u5B9A
uniform float u_r;
uniform mat4 u_ModelMatrix;

varying vec4 v_color;
varying float v_lightWeight;
varying float v_barLinearZ;

uniform float u_opacity : 1;
uniform float u_lightEnable: 1;
uniform float u_opacitylinear: 0.0;
uniform vec4 u_sourceColor;
uniform vec4 u_targetColor;
uniform float u_opacitylinear_dir: 1.0;
uniform float  u_linearColor: 0.0;


#pragma include "projection"
#pragma include "light"
#pragma include "picking"

float getYRadian(float x, float z) {
  if(x > 0.0 && z > 0.0) {
    return atan(x/z);
  } else if(x > 0.0 && z <= 0.0){
    return atan(-z/x) + pi/2.0;
  } else if(x <= 0.0 && z <= 0.0) {
    return  pi + atan(x/z); //atan(x/z) + 
  } else {
    return atan(z/-x) + pi*3.0/2.0;
  }
}

float getXRadian(float y, float r) {
  return atan(y/r);
}

void main() {


  vec3 size = a_Size * a_Position;

  vec3 offset = size; // \u63A7\u5236\u5706\u67F1\u4F53\u7684\u5927\u5C0F - \u4ECE\u6807\u51C6\u5355\u4F4D\u5706\u67F1\u4F53\u8FDB\u884C\u504F\u79FB

  if(u_heightfixed < 1.0) { // \u5706\u67F1\u4F53\u4E0D\u56FA\u5B9A\u9AD8\u5EA6
    
    if (u_CoordinateSystem == COORDINATE_SYSTEM_P20 || u_CoordinateSystem == COORDINATE_SYSTEM_P20_OFFSET) {
      // P20 \u5750\u6807\u7CFB\u4E0B\uFF0C\u4E3A\u4E86\u548C Web \u58A8\u5361\u6258\u5750\u6807\u7CFB\u7EDF\u4E00\uFF0Czoom \u9ED8\u8BA4\u51CF1
      offset = offset * pow(2.0, (19.0 - u_Zoom));
    }
    if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) {
      // P20_2 \u5750\u6807\u7CFB\u4E0B\uFF0C\u4E3A\u4E86\u548C Web \u58A8\u5361\u6258\u5750\u6807\u7CFB\u7EDF\u4E00\uFF0Czoom \u9ED8\u8BA4\u51CF3
      offset = offset * pow(2.0, (19.0 - 3.0 - u_Zoom));
    }
  } else {// \u5706\u67F1\u4F53\u56FA\u5B9A\u9AD8\u5EA6 \uFF08 \u5904\u7406 mapbox \uFF09
    if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
      offset *= 4.0/pow(2.0, 21.0 - u_Zoom);
    }
  }


  vec4 project_pos = project_position(vec4(a_Pos.xy, 0., 1.0));

  // u_r \u63A7\u5236\u5706\u67F1\u7684\u751F\u957F
  vec4 pos = vec4(project_pos.xy + offset.xy, offset.z * u_r, 1.0);

  // // \u5706\u67F1\u5149\u7167\u6548\u679C
  float lightWeight = 1.0;

  if(u_lightEnable > 0.0) { // \u53D6\u6D88\u4E09\u5143\u8868\u8FBE\u5F0F\uFF0C\u589E\u5F3A\u5065\u58EE\u6027
    lightWeight = calc_lighting(pos);
  }

  v_lightWeight = lightWeight;

  v_color = a_Color;

    // \u8BBE\u7F6E\u5706\u67F1\u7684\u5E95\u8272
  if(u_linearColor == 1.0) { // \u4F7F\u7528\u6E10\u53D8\u989C\u8272
    v_color = mix(u_sourceColor, u_targetColor, a_Position.z);
    v_color.a =  v_color.a * u_opacity;
  } else {
    v_color = vec4(a_Color.rgb * lightWeight, a_Color.w * u_opacity);
  }

    if(u_opacitylinear > 0.0) {
    v_color.a *= u_opacitylinear_dir > 0.0 ? (1.0 - a_Position.z): a_Position.z;
  }


  // gl_Position = project_common_position_to_clipspace(pos);

  gl_Position = project_common_position_to_clipspace_v2(pos);

  setPickingColor(a_PickingColor);
}
`,d1=function(e){(0,ke.Z)(t,e);var i=sw(t);function t(){var r;(0,ue.Z)(this,t);for(var n=arguments.length,a=new Array(n),u=0;u<n;u++)a[u]=arguments[u];return r=i.call.apply(i,[this].concat(a)),(0,Ce.Z)((0,bt.Z)(r),"raiseCount",0),(0,Ce.Z)((0,bt.Z)(r),"raiseRepeat",0),r}return(0,me.Z)(t,[{key:"getUninforms",value:function(){var n=this.layer.getLayerConfig(),a=n.animateOption,u=a===void 0?{enable:!1,speed:.01,repeat:!1}:a,f=n.opacity,g=f===void 0?1:f,x=n.sourceColor,I=n.targetColor,O=n.pickLight,B=O===void 0?!1:O,W=n.heightfixed,he=W===void 0?!1:W,ae=n.opacityLinear,Se=ae===void 0?{enable:!1,dir:"up"}:ae,Fe=n.lightEnable,Qe=Fe===void 0?!0:Fe,qe=0,yt=[0,0,0,0],Et=[0,0,0,0];if(x&&I&&(yt=Ni(x),Et=Ni(I),qe=1),this.raiseCount<1&&this.raiseRepeat>0&&u.enable){var Ot=u.speed,jt=Ot===void 0?.01:Ot;this.raiseCount+=jt,this.raiseCount>=1&&(this.raiseRepeat>1?(this.raiseCount=0,this.raiseRepeat--):this.raiseCount=1)}return{u_pickLight:Number(B),u_heightfixed:Number(he),u_r:u.enable&&this.raiseRepeat>0?this.raiseCount:1,u_opacity:g,u_linearColor:qe,u_sourceColor:yt,u_targetColor:Et,u_opacitylinear:Number(Se.enable),u_opacitylinear_dir:Se.dir==="up"?1:0,u_lightEnable:Number(Qe)}}},{key:"initModels",value:function(){var r=(0,ur.Z)(nt().mark(function a(){return nt().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return f.abrupt("return",this.buildModels());case 1:case"end":return f.stop()}},a,this)}));function n(){return r.apply(this,arguments)}return n}()},{key:"buildModels",value:function(){var r=(0,ur.Z)(nt().mark(function a(){var u,f,g,x,I,O;return nt().wrap(function(W){for(;;)switch(W.prev=W.next){case 0:return u=this.layer.getLayerConfig(),f=u.depth,g=f===void 0?!0:f,x=u.animateOption.repeat,I=x===void 0?1:x,this.raiseRepeat=I,W.next=4,this.layer.buildLayerModel({moduleName:"pointExtrude",vertexShader:cw,fragmentShader:lw,triangulation:u1,cull:{enable:!0,face:uu(this.mapService.version)},depth:{enable:g}});case 4:return O=W.sent,W.abrupt("return",[O]);case 6:case"end":return W.stop()}},a,this)}));function n(){return r.apply(this,arguments)}return n}()},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"size",type:mn.Attribute,descriptor:{name:"a_Size",buffer:{usage:Ge.DYNAMIC_DRAW,data:[],type:Ge.FLOAT},size:3,update:function(a){var u=a.size;if(u){var f=[];return Array.isArray(u)&&(f=u.length===2?[u[0],u[0],u[1]]:u),Array.isArray(u)||(f=[u,u,u]),f}else return[2,2,2]}}}),this.styleAttributeService.registerStyleAttribute({name:"normal",type:mn.Attribute,descriptor:{name:"a_Normal",buffer:{usage:Ge.STATIC_DRAW,data:[],type:Ge.FLOAT},size:3,update:function(a,u,f,g,x){return x}}}),this.styleAttributeService.registerStyleAttribute({name:"pos",type:mn.Attribute,descriptor:{name:"a_Pos",buffer:{usage:Ge.DYNAMIC_DRAW,data:[],type:Ge.FLOAT},size:3,update:function(a){var u=Is(a.coordinates);return[u[0],u[1],0]}}})}}]),t}(vo);function fw(e){var i=hw();return function(){var r=(0,oe.Z)(e),n;if(i){var a=(0,oe.Z)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return(0,Ze.Z)(this,n)}}function hw(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var v1=`
uniform float u_additive;


varying vec4 v_data;
varying vec4 v_color;
varying float v_radius;
uniform float u_time;
uniform vec4 u_animate: [ 1., 2., 1.0, 0.2 ];

#pragma include "sdf_2d"
#pragma include "picking"

void main() {

  lowp float antialiasblur = v_data.z;
  float r = v_radius / (v_radius);

  float outer_df;
  float inner_df;
  // 'circle', 'triangle', 'square', 'pentagon', 'hexagon', 'octogon', 'hexagram', 'rhombus', 'vesica'
  
  outer_df = sdCircle(v_data.xy, 1.0);
  inner_df = sdCircle(v_data.xy, r);


  float opacity_t = smoothstep(0.0, antialiasblur, outer_df);

  float color_t = smoothstep(
    antialiasblur,
    0.0,
    inner_df
  );
  float PI = 3.14159;
  float N_RINGS = 3.0;
  float FREQ = 1.0;

  gl_FragColor = v_color;

  float d = length(v_data.xy);
  if(d > 0.5) {
    discard;
  }
  float intensity = clamp(cos(d * PI), 0.0, 1.0) * clamp(cos(2.0 * PI * (d * 2.0 * u_animate.z - u_animate.y * u_time)), 0.0, 1.0);
  
  // \u6839\u636E\u53E0\u52A0\u6A21\u5F0F\u9009\u62E9\u6548\u679C
  if(u_additive > 0.0) {
    gl_FragColor *= intensity;
    // \u4F18\u5316\u6C34\u6CE2\u70B9 blend additive \u6A21\u5F0F\u4E0B\u6709\u7684\u62FE\u53D6\u6548\u679C 
    gl_FragColor = filterColorAlpha(gl_FragColor, gl_FragColor.a);
  } else {
    gl_FragColor = vec4(gl_FragColor.xyz, gl_FragColor.a * intensity);
    gl_FragColor = filterColor(gl_FragColor);
  }
}
`,Aw=`uniform float u_additive;
uniform float u_stroke_opacity : 1;
uniform float u_stroke_width : 2;

varying vec4 v_data;
varying vec4 v_color;
varying float v_radius;
varying vec4 v_stroke;


#pragma include "sdf_2d"
#pragma include "picking"


void main() {
  int shape = int(floor(v_data.w + 0.5));
  lowp float antialiasblur = v_data.z;
  float r = v_radius / (v_radius + u_stroke_width);

  float outer_df;
  float inner_df;
  // 'circle', 'triangle', 'square', 'pentagon', 'hexagon', 'octogon', 'hexagram', 'rhombus', 'vesica'
  if (shape == 0) {
    outer_df = sdCircle(v_data.xy, 1.0);
    inner_df = sdCircle(v_data.xy, r);
  } else if (shape == 1) {
    outer_df = sdEquilateralTriangle(1.1 * v_data.xy);
    inner_df = sdEquilateralTriangle(1.1 / r * v_data.xy);
  } else if (shape == 2) {
    outer_df = sdBox(v_data.xy, vec2(1.));
    inner_df = sdBox(v_data.xy, vec2(r));
  } else if (shape == 3) {
    outer_df = sdPentagon(v_data.xy, 0.8);
    inner_df = sdPentagon(v_data.xy, r * 0.8);
  } else if (shape == 4) {
    outer_df = sdHexagon(v_data.xy, 0.8);
    inner_df = sdHexagon(v_data.xy, r * 0.8);
  } else if (shape == 5) {
    outer_df = sdOctogon(v_data.xy, 1.0);
    inner_df = sdOctogon(v_data.xy, r);
  } else if (shape == 6) {
    outer_df = sdHexagram(v_data.xy, 0.52);
    inner_df = sdHexagram(v_data.xy, r * 0.52);
  } else if (shape == 7) {
    outer_df = sdRhombus(v_data.xy, vec2(1.0));
    inner_df = sdRhombus(v_data.xy, vec2(r));
  } else if (shape == 8) {
    outer_df = sdVesica(v_data.xy, 1.1, 0.8);
    inner_df = sdVesica(v_data.xy, r * 1.1, r * 0.8);
  }

  float opacity_t = smoothstep(0.0, antialiasblur, outer_df);

  float color_t = u_stroke_width < 0.01 ? 0.0 : smoothstep(
    antialiasblur,
    0.0,
    inner_df
  );

  if(u_stroke_width < 0.01) {
    gl_FragColor = v_color;
  } else {
    gl_FragColor = mix(v_color, v_stroke * u_stroke_opacity, color_t);
  }

  if(u_additive > 0.0) {
    gl_FragColor *= opacity_t;
    gl_FragColor = filterColorAlpha(gl_FragColor, gl_FragColor.a);
  } else {
    gl_FragColor.a *= opacity_t;
    gl_FragColor = filterColor(gl_FragColor);
  }
   // \u4F5C\u4E3A mask \u6A21\u677F\u65F6\u9700\u8981\u4E22\u5F03\u900F\u660E\u7684\u50CF\u7D20
  if(gl_FragColor.a < 0.01) {
    discard;
  } 
}
`,gg=`attribute vec4 a_Color;
attribute vec3 a_Position;
attribute vec3 a_Extrude;
attribute float a_Size;
attribute float a_Shape;
uniform mat4 u_ModelMatrix;

uniform int u_size_unit;

varying vec4 v_data;
varying vec4 v_color;
varying float v_radius;
varying vec4 v_stroke;
uniform float u_stroke_width: 2;
uniform vec3 u_blur_height_fixed: [0, 0, 0];


#pragma include "projection"
#pragma include "picking"
#pragma include "rotation_2d"


void main() {
  // \u900F\u660E\u5EA6\u8BA1\u7B97
   v_stroke = stroke;  
  vec3 extrude = a_Extrude;
  float shape_type = a_Shape;
  /*
  *  setPickingSize \u8BBE\u7F6E\u62FE\u53D6\u5927\u5C0F
  *  u_meter2coord \u5728\u7B49\u9762\u79EF\u5927\u5C0F\u7684\u65F6\u5019\u8BBE\u7F6E\u5355\u4F4D
  */
  float newSize = setPickingSize(a_Size);
  // float newSize = setPickingSize(a_Size) * 0.00001038445708445579;



  // unpack color(vec2)
  v_color = vec4(a_Color.xyz, a_Color.w * opacity);

  if(u_size_unit == 1) {
    newSize = newSize  * u_PixelsPerMeter.z;
  }

   v_radius = newSize;

  // anti-alias
  //  float antialiased_blur = -max(u_blur, antialiasblur);
  float antialiasblur = -max(2.0 / u_DevicePixelRatio / newSize, u_blur_height_fixed.x);

  vec2 offset = (extrude.xy * (newSize + u_stroke_width) + u_offsets);
  vec3 aPosition = a_Position;

  offset = project_pixel(offset);
  offset = rotate_matrix(offset,rotation);
  
  // TODP: /abs(extrude.x) \u662F\u4E3A\u4E86\u517C\u5BB9\u5730\u7403\u6A21\u5F0F
  v_data = vec4(extrude.x/abs(extrude.x), extrude.y/abs(extrude.y), antialiasblur,shape_type);


  // vec4 project_pos = project_position(vec4(a_Position.xy, 0.0, 1.0));
  vec4 project_pos = project_position(vec4(aPosition.xy, 0.0, 1.0));
  // gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, project_pixel(setPickingOrder(0.0)), 1.0));

  float raisingHeight = u_blur_height_fixed.y;

  if(u_blur_height_fixed.z < 1.0) { // false
    raisingHeight = project_pixel(u_blur_height_fixed.y);
  } else {
     if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
      float mapboxZoomScale = 4.0/pow(2.0, 21.0 - u_Zoom);
      raisingHeight = u_blur_height_fixed.y * mapboxZoomScale;
    }
  }
  
  gl_Position = project_common_position_to_clipspace_v2(vec4(project_pos.xy + offset, raisingHeight, 1.0));

  setPickingColor(a_PickingColor);
}
`,g1=function(e){(0,ke.Z)(t,e);var i=fw(t);function t(){return(0,ue.Z)(this,t),i.apply(this,arguments)}return(0,me.Z)(t,[{key:"getUninforms",value:function(){var n=this.layer.getLayerConfig(),a=n.strokeOpacity,u=a===void 0?1:a,f=n.strokeWidth,g=f===void 0?0:f,x=n.blend,I=n.blur,O=I===void 0?0:I,B=n.raisingHeight,W=B===void 0?0:B,he=n.heightfixed,ae=he===void 0?!1:he,Se=n.unit,Fe=Se===void 0?"pixel":Se;return(0,X.Z)({u_blur_height_fixed:[O,Number(W),Number(ae)],u_additive:x==="additive"?1:0,u_stroke_opacity:u,u_stroke_width:g,u_size_unit:dg[Fe]},this.getStyleAttribute())}},{key:"getAnimateUniforms",value:function(){var n=this.layer.getLayerConfig(),a=n.animateOption,u=a===void 0?{enable:!1}:a;return{u_animate:this.animateOption2Array(u),u_time:this.layer.getLayerAnimateTime()}}},{key:"getAttribute",value:function(){return this.styleAttributeService.createAttributesAndIndices(this.layer.getEncodedData(),ha)}},{key:"initModels",value:function(){var r=(0,ur.Z)(nt().mark(function a(){return nt().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return f.abrupt("return",this.buildModels());case 1:case"end":return f.stop()}},a,this)}));function n(){return r.apply(this,arguments)}return n}()},{key:"buildModels",value:function(){var r=(0,ur.Z)(nt().mark(function a(){var u,f,g,x,I,O,B,W;return nt().wrap(function(ae){for(;;)switch(ae.prev=ae.next){case 0:return u=this.layer.getLayerConfig(),f=u.animateOption,g=f===void 0?{enable:!1}:f,x=this.getShaders(g),I=x.frag,O=x.vert,B=x.type,this.layer.triangulation=ha,ae.next=5,this.layer.buildLayerModel({moduleName:B,vertexShader:O,fragmentShader:I,inject:this.getInject(),triangulation:ha,depth:{enable:!1}});case 5:return W=ae.sent,ae.abrupt("return",[W]);case 7:case"end":return ae.stop()}},a,this)}));function n(){return r.apply(this,arguments)}return n}()},{key:"getShaders",value:function(n){if(n.enable)switch(n.type){case"wave":return{frag:v1,vert:gg,type:"pointWave"};default:return{frag:v1,vert:gg,type:"pointWave"}}else return{frag:Aw,vert:gg,type:"pointFill"}}},{key:"animateOption2Array",value:function(n){return[n.enable?0:1,n.speed||1,n.rings||3,0]}},{key:"registerBuiltinAttributes",value:function(){var n=this.layer.getLayerConfig().shape2d;this.styleAttributeService.registerStyleAttribute({name:"extrude",type:mn.Attribute,descriptor:{name:"a_Extrude",buffer:{usage:Ge.DYNAMIC_DRAW,data:[],type:Ge.FLOAT},size:3,update:function(u,f,g,x){var I=[1,1,0,-1,1,0,-1,-1,0,1,-1,0],O=x%4*3;return[I[O],I[O+1],I[O+2]]}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:mn.Attribute,descriptor:{name:"a_Size",buffer:{usage:Ge.DYNAMIC_DRAW,data:[],type:Ge.FLOAT},size:1,update:function(u){var f=u.size,g=f===void 0?5:f;return Array.isArray(g)?[g[0]]:[g]}}}),this.styleAttributeService.registerStyleAttribute({name:"shape",type:mn.Attribute,descriptor:{name:"a_Shape",buffer:{usage:Ge.DYNAMIC_DRAW,data:[],type:Ge.FLOAT},size:1,update:function(u){var f=u.shape,g=f===void 0?2:f,x=n.indexOf(g);return[x]}}})}}]),t}(vo);function pw(e){var i=dw();return function(){var r=(0,oe.Z)(e),n;if(i){var a=(0,oe.Z)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return(0,Ze.Z)(this,n)}}function dw(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var vw=`uniform sampler2D u_texture;
uniform vec2 u_textSize;
uniform float u_opacity : 1;

#pragma include "sdf_2d"
#pragma include "picking"
varying vec2 v_uv; // \u672C\u8EAB\u7684 uv \u5750\u6807
varying vec2 v_Iconuv;
varying float v_opacity;

void main() {

  vec2 pos = v_Iconuv / u_textSize + v_uv / u_textSize * 64.;
  gl_FragColor = texture2D(u_texture, pos);
  gl_FragColor.a *= v_opacity;

  gl_FragColor = filterColor(gl_FragColor);
}
`,gw=`attribute vec4 a_Color;
attribute vec3 a_Position;
attribute vec3 a_Extrude;
attribute float a_Size;
attribute vec2 a_Uv;

uniform mat4 u_ModelMatrix;

uniform mat2 u_RotateMatrix;
uniform int u_size_unit;

varying vec2 v_uv; // \u672C\u8EAB\u7684 uv \u5750\u6807
varying vec2 v_Iconuv; // icon \u8D34\u56FE\u7684 uv \u5750\u6807

uniform float u_raisingHeight: 0.0;
uniform float u_heightfixed: 0.0;
varying float v_opacity;
// uniform vec2 u_offsets; // shader \u6CE8\u5165


#pragma include "projection"
#pragma include "picking"
#pragma include "rotation_2d"

void main() {
  vec3 extrude = a_Extrude;
  v_uv = (a_Extrude.xy + 1.0)/2.0;
  v_uv.y = 1.0 - v_uv.y;
  v_Iconuv = a_Uv;
  v_opacity = opacity;
  float newSize = a_Size;
  if(u_size_unit == 1) {
    newSize = newSize  * u_PixelsPerMeter.z;
  }
  
  // vec2 offset = (u_RotateMatrix * extrude.xy * (a_Size) + textrueOffsets);
  vec2 offset = (extrude.xy * (newSize) + offsets);

  offset = rotate_matrix(offset,rotation);

  vec3 aPosition = a_Position;

  offset = project_pixel(offset);

  vec4 project_pos = project_position(vec4(aPosition.xy, 0.0, 1.0));
  float raisingHeight = u_raisingHeight;
  if(u_heightfixed < 1.0) { // height fixed
    raisingHeight = project_pixel(u_raisingHeight);
  } else {
    if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
      float mapboxZoomScale = 4.0/pow(2.0, 21.0 - u_Zoom);
      raisingHeight = u_raisingHeight * mapboxZoomScale;
    }
  }

  gl_Position = project_common_position_to_clipspace_v2(vec4(project_pos.xy + offset, 0.0, 1.0));

  setPickingColor(a_PickingColor);
}
`,mw=function(e){(0,ke.Z)(t,e);var i=pw(t);function t(){var r;(0,ue.Z)(this,t);for(var n=arguments.length,a=new Array(n),u=0;u<n;u++)a[u]=arguments[u];return r=i.call.apply(i,[this].concat(a)),(0,Ce.Z)((0,bt.Z)(r),"meter2coord",1),(0,Ce.Z)((0,bt.Z)(r),"isMeter",!1),(0,Ce.Z)((0,bt.Z)(r),"radian",0),(0,Ce.Z)((0,bt.Z)(r),"updateTexture",function(){var f=r.rendererService.createTexture2D;if(r.texture){r.texture.update({data:r.iconService.getCanvas(),mag:"linear",min:"linear mipmap nearest",mipmap:!0}),r.layerService.throttleRenderLayers();return}r.texture=f({data:r.iconService.getCanvas(),mag:Ge.LINEAR,min:Ge.LINEAR_MIPMAP_LINEAR,premultiplyAlpha:!1,width:1024,height:r.iconService.canvasHeight||128,mipmap:!0})}),r}return(0,me.Z)(t,[{key:"getUninforms",value:function(){var n=this.layer.getLayerConfig(),a=n.raisingHeight,u=a===void 0?0:a,f=n.heightfixed,g=f===void 0?!1:f,x=n.unit,I=x===void 0?"pixel":x;return this.rendererService.getDirty()&&this.texture.bind(),(0,X.Z)({u_raisingHeight:Number(u),u_heightfixed:Number(g),u_size_unit:dg[I],u_texture:this.texture,u_textSize:[1024,this.iconService.canvasHeight||128]},this.getStyleAttribute())}},{key:"getAttribute",value:function(){return this.styleAttributeService.createAttributesAndIndices(this.layer.getEncodedData(),Rd)}},{key:"initModels",value:function(){var r=(0,ur.Z)(nt().mark(function a(){return nt().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return this.iconService.on("imageUpdate",this.updateTexture),this.updateTexture(),f.abrupt("return",this.buildModels());case 3:case"end":return f.stop()}},a,this)}));function n(){return r.apply(this,arguments)}return n}()},{key:"buildModels",value:function(){var r=(0,ur.Z)(nt().mark(function a(){var u;return nt().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return g.next=2,this.layer.buildLayerModel({moduleName:"pointFillImage",vertexShader:gw,fragmentShader:vw,triangulation:Rd,depth:{enable:!1},inject:this.getInject(),cull:{enable:!0,face:uu(this.mapService.version)}});case 2:return u=g.sent,g.abrupt("return",[u]);case 4:case"end":return g.stop()}},a,this)}));function n(){return r.apply(this,arguments)}return n}()},{key:"clearModels",value:function(){var n;this.iconService.off("imageUpdate",this.updateTexture),(n=this.texture)===null||n===void 0||n.destroy()}},{key:"registerBuiltinAttributes",value:function(){var n=this;this.styleAttributeService.registerStyleAttribute({name:"uv",type:mn.Attribute,descriptor:{name:"a_Uv",buffer:{usage:Ge.DYNAMIC_DRAW,data:[],type:Ge.FLOAT},size:2,update:function(u){var f=n.iconService.getIconMap(),g=u.shape,x=f[g]||{x:-64,y:-64},I=x.x,O=x.y;return[I,O]}}}),this.styleAttributeService.registerStyleAttribute({name:"extrude",type:mn.Attribute,descriptor:{name:"a_Extrude",buffer:{usage:Ge.DYNAMIC_DRAW,data:[],type:Ge.FLOAT},size:3,update:function(u,f,g,x){var I=[1,1,0,-1,1,0,-1,-1,0,1,-1,0],O=x%4*3;return[I[O],I[O+1],I[O+2]]}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:mn.Attribute,descriptor:{name:"a_Size",buffer:{usage:Ge.DYNAMIC_DRAW,data:[],type:Ge.FLOAT},size:1,update:function(u){var f=u.size,g=f===void 0?5:f;return Array.isArray(g)?[g[0]]:[g]}}})}}]),t}(vo);function yw(e){var i=_w();return function(){var r=(0,oe.Z)(e),n;if(i){var a=(0,oe.Z)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return(0,Ze.Z)(this,n)}}function _w(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var xw=`
uniform sampler2D u_texture;
varying vec4 v_color;
varying vec2 v_uv;
varying float v_opacity;
uniform vec2 u_textSize;

#pragma include "picking"

void main(){
      vec2 pos = v_uv / u_textSize + gl_PointCoord / u_textSize * 64.;
      vec4 textureColor;

      // Y = 0.299R + 0.587G + 0.114B // \u4EAE\u5EA6\u63D0\u53D6
     
      textureColor = texture2D(u_texture, pos);

      // Tip: \u53BB\u9664\u8FB9\u7F18\u90E8\u5206 mipmap \u5BFC\u81F4\u7684\u6DF7\u5408\u53D8\u6697
      float fragmengTocenter = distance(vec2(0.5), gl_PointCoord);
      if(fragmengTocenter >= 0.5) {
            float luma = 0.299 * textureColor.r + 0.587 * textureColor.g + 0.114 * textureColor.b;
            textureColor.a *= luma;
      }
      
      

      if(all(lessThan(v_color, vec4(1.0+0.00001))) && all(greaterThan(v_color, vec4(1.0-0.00001))) || v_color==vec4(1.0)){
            gl_FragColor= textureColor;
      }else {
            gl_FragColor= step(0.01, textureColor.z) * v_color;
      }
      gl_FragColor.a *= v_opacity;
      if (gl_FragColor.a < 0.01) {
         discard;
      }
      gl_FragColor = filterColor(gl_FragColor);
}
`,Ew=`precision highp float;
attribute vec3 a_Position;
attribute vec4 a_Color;
attribute vec2 a_Uv;
attribute float a_Size;
varying vec4 v_color;
varying vec2 v_uv;
varying float v_opacity;
uniform mat4 u_ModelMatrix;


uniform float u_raisingHeight: 0.0;
uniform float u_heightfixed: 0.0;

#pragma include "projection"
#pragma include "picking"

void main() {

  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
  v_color = a_Color;
  v_opacity = opacity;
  v_uv = a_Uv;
  vec4 project_pos = project_position(vec4(a_Position, 1.0));
   
  vec2 offset = project_pixel(offsets);

  float raisingHeight = u_raisingHeight;
  if(u_heightfixed < 1.0) { // false
    raisingHeight = project_pixel(u_raisingHeight);
  } else {
     if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
      float mapboxZoomScale = 4.0/pow(2.0, 21.0 - u_Zoom);
      raisingHeight = u_raisingHeight * mapboxZoomScale;
    }
  }


  gl_Position = project_common_position_to_clipspace_v2(vec4(project_pos.xy + offset, raisingHeight, 1.0));

  gl_PointSize = a_Size * 2.0 * u_DevicePixelRatio;
  setPickingColor(a_PickingColor);
}
`,m1=function(e){(0,ke.Z)(t,e);var i=yw(t);function t(){var r;(0,ue.Z)(this,t);for(var n=arguments.length,a=new Array(n),u=0;u<n;u++)a[u]=arguments[u];return r=i.call.apply(i,[this].concat(a)),(0,Ce.Z)((0,bt.Z)(r),"updateTexture",function(){var f=r.rendererService.createTexture2D;if(r.texture){r.texture.update({data:r.iconService.getCanvas(),mag:"linear",min:"linear mipmap nearest",mipmap:!0}),setTimeout(function(){r.layerService.throttleRenderLayers()});return}r.texture=f({data:r.iconService.getCanvas(),mag:Ge.LINEAR,min:Ge.LINEAR_MIPMAP_LINEAR,premultiplyAlpha:!1,width:1024,height:r.iconService.canvasHeight||128,mipmap:!0})}),r}return(0,me.Z)(t,[{key:"getUninforms",value:function(){var n=this.layer.getLayerConfig(),a=n.opacity,u=a===void 0?1:a,f=n.offsets,g=f===void 0?[0,0]:f,x=n.raisingHeight,I=x===void 0?0:x,O=n.heightfixed,B=O===void 0?!1:O;return this.rendererService.getDirty()&&this.texture.bind(),(0,X.Z)({u_raisingHeight:Number(I),u_heightfixed:Number(B),u_texture:this.texture,u_textSize:[1024,this.iconService.canvasHeight||128]},this.getStyleAttribute())}},{key:"initModels",value:function(){var r=(0,ur.Z)(nt().mark(function a(){return nt().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return this.iconService.on("imageUpdate",this.updateTexture),this.updateTexture(),f.abrupt("return",this.buildModels());case 3:case"end":return f.stop()}},a,this)}));function n(){return r.apply(this,arguments)}return n}()},{key:"clearModels",value:function(){var n;(n=this.texture)===null||n===void 0||n.destroy(),this.iconService.off("imageUpdate",this.updateTexture)}},{key:"buildModels",value:function(){var r=(0,ur.Z)(nt().mark(function a(){var u;return nt().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return g.next=2,this.layer.buildLayerModel({moduleName:"pointImage",vertexShader:Ew,fragmentShader:xw,triangulation:CS,inject:this.getInject(),depth:{enable:!1},primitive:Ge.POINTS});case 2:return u=g.sent,g.abrupt("return",[u]);case 4:case"end":return g.stop()}},a,this)}));function n(){return r.apply(this,arguments)}return n}()},{key:"registerBuiltinAttributes",value:function(){var n=this;this.styleAttributeService.registerStyleAttribute({name:"size",type:mn.Attribute,descriptor:{name:"a_Size",buffer:{usage:Ge.DYNAMIC_DRAW,data:[],type:Ge.FLOAT},size:1,update:function(u){var f=u.size,g=f===void 0?5:f;return Array.isArray(g)?[g[0]]:[g]}}}),this.styleAttributeService.registerStyleAttribute({name:"uv",type:mn.Attribute,descriptor:{name:"a_Uv",buffer:{usage:Ge.DYNAMIC_DRAW,data:[],type:Ge.FLOAT},size:2,update:function(u){var f=n.iconService.getIconMap(),g=u.shape,x=f[g]||{x:-64,y:-64},I=x.x,O=x.y;return[I,O]}}})}}]),t}(vo);function bw(e){var i=Sw();return function(){var r=(0,oe.Z)(e),n;if(i){var a=(0,oe.Z)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return(0,Ze.Z)(this,n)}}function Sw(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var Cw=`varying vec4 v_color;
void main() {
  gl_FragColor = v_color;
}
`,ww=`
attribute vec3 a_Position;
uniform mat4 u_ModelMatrix;

attribute float a_Size;
attribute vec4 a_Color;

varying vec4 v_color;

#pragma include "projection"
#pragma include "project"

void main() {
  v_color = vec4(a_Color.xyz, a_Color.w * opacity);

  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    gl_Position = u_Mvp * vec4(a_Position.xy, a_Position.z, 1.0);
  } else {
    vec4 project_pos = project_position(vec4(a_Position, 1.0)) + vec4(a_Size / 2.,-a_Size /2.,0.,0.);
    gl_Position = project_common_position_to_clipspace(vec4(vec2(project_pos.xy),project_pos.z,project_pos.w));
  }

  gl_PointSize = a_Size * 2.0 * u_DevicePixelRatio;
}
`,AP=In.isNumber;function y1(e){var i=e.coordinates;return{vertices:(0,Mr.Z)(i),indices:[0],size:i.length}}var _1=function(e){(0,ke.Z)(t,e);var i=bw(t);function t(){return(0,ue.Z)(this,t),i.apply(this,arguments)}return(0,me.Z)(t,[{key:"getDefaultStyle",value:function(){return{blend:"additive"}}},{key:"getUninforms",value:function(){var n=this.layer.getLayerConfig(),a=n.opacity,u=a===void 0?1:a;return(0,X.Z)({},this.getStyleAttribute())}},{key:"initModels",value:function(){var r=(0,ur.Z)(nt().mark(function a(){return nt().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return f.abrupt("return",this.buildModels());case 1:case"end":return f.stop()}},a,this)}));function n(){return r.apply(this,arguments)}return n}()},{key:"buildModels",value:function(){var r=(0,ur.Z)(nt().mark(function a(){var u;return nt().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return this.layer.triangulation=y1,g.next=3,this.layer.buildLayerModel({moduleName:"pointNormal",vertexShader:ww,fragmentShader:Cw,triangulation:y1,inject:this.getInject(),depth:{enable:!1},primitive:Ge.POINTS,pick:!1});case 3:return u=g.sent,g.abrupt("return",[u]);case 5:case"end":return g.stop()}},a,this)}));function n(){return r.apply(this,arguments)}return n}()},{key:"clearModels",value:function(){}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"size",type:mn.Attribute,descriptor:{name:"a_Size",buffer:{usage:Ge.DYNAMIC_DRAW,data:[],type:Ge.FLOAT},size:1,update:function(a){var u=a.size,f=u===void 0?1:u;return Array.isArray(f)?[f[0]]:[f]}}})}}]),t}(vo);function Tw(e){var i=Mw();return function(){var r=(0,oe.Z)(e),n;if(i){var a=(0,oe.Z)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return(0,Ze.Z)(this,n)}}function Mw(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var Iw=`
uniform float u_additive;
uniform float u_opacity: 1.0;

varying vec4 v_data;
varying vec4 v_color;
varying float v_radius;
varying vec2 v_exteude;
#pragma include "sdf_2d"
#pragma include "picking"

void main() {

  lowp float antialiasblur = v_data.z;
  float r = v_radius / (v_radius);

  float outer_df = sdCircle(v_data.xy, 1.0);
  float inner_df = sdCircle(v_data.xy, r);

  float opacity_t = smoothstep(0.0, antialiasblur, outer_df);

  gl_FragColor = vec4(v_color.rgb, v_color.a * u_opacity);

  if(u_additive > 0.0) {
    gl_FragColor *= opacity_t;
  } else {
    gl_FragColor.a *= opacity_t;
  }

  if(gl_FragColor.a > 0.0) {
    gl_FragColor = filterColor(gl_FragColor);
  }

  vec2 extrude =  v_exteude;
  vec2 dir = normalize(extrude);
  vec2 baseDir = vec2(1.0, 0.0);
  float pi = 3.14159265359;
  float flag = sign(dir.y);
  float rades = dot(dir, baseDir);
  float radar_v = (flag - 1.0) * -0.5 * acos(rades)/pi;
  // simple AA
  if(radar_v > 0.99) {
    radar_v = 1.0 - (radar_v - 0.99)/0.01;
  }

  gl_FragColor.a *= radar_v;
}
`,Lw=`attribute vec4 a_Color;
attribute vec3 a_Position;
attribute vec3 a_Extrude;
attribute float a_Size;
uniform float u_speed: 1.0;
uniform float u_time;

uniform mat4 u_ModelMatrix;

uniform int u_size_unit;

varying vec4 v_data;
varying vec4 v_color;
varying float v_radius;
varying vec2 v_exteude;

#pragma include "projection"
#pragma include "picking"

void main() {
  vec3 extrude = a_Extrude;
  float newSize = setPickingSize(a_Size);

  float time = u_time * u_speed;
  mat2 rotateMatrix = mat2( 
    cos(time), sin(time), 
    -sin(time), cos(time)
  );
  v_exteude = rotateMatrix * a_Extrude.xy;

  // unpack color(vec2)
  v_color = a_Color;

  // anti-alias
  float blur = 0.0;
  float antialiasblur = -max(2.0 / u_DevicePixelRatio / a_Size, blur);

  if(u_size_unit == 1) {
    newSize = newSize  * u_PixelsPerMeter.z;
  }
  // radius(16-bit)
  v_radius = newSize;

  vec2 offset = (extrude.xy * (newSize));
  vec3 aPosition = a_Position;
  
    // \u4E0D\u4EE5\u7C73\u4E3A\u5B9E\u9645\u5355\u4F4D
  offset = project_pixel(offset);
  
  v_data = vec4(extrude.x, extrude.y, antialiasblur, -1.0);

  vec4 project_pos = project_position(vec4(aPosition.xy, 0.0, 1.0));
  gl_Position = project_common_position_to_clipspace_v2(vec4(project_pos.xy + offset, project_pixel(setPickingOrder(0.0)), 1.0));

  setPickingColor(a_PickingColor);
}
`,Pw=function(e){(0,ke.Z)(t,e);var i=Tw(t);function t(){return(0,ue.Z)(this,t),i.apply(this,arguments)}return(0,me.Z)(t,[{key:"getUninforms",value:function(){var n=this.layer.getLayerConfig(),a=n.opacity,u=a===void 0?1:a,f=n.blend,g=n.speed,x=g===void 0?1:g,I=n.unit,O=I===void 0?"pixel":I;return{u_size_unit:dg[O],u_speed:x,u_additive:f==="additive"?1:0,u_opacity:u}}},{key:"getAnimateUniforms",value:function(){var n=this.layer.getLayerConfig(),a=n.animateOption,u=a===void 0?{enable:!1}:a;return{u_animate:this.animateOption2Array(u),u_time:this.layer.getLayerAnimateTime()}}},{key:"getAttribute",value:function(){return this.styleAttributeService.createAttributesAndIndices(this.layer.getEncodedData(),Rd)}},{key:"initModels",value:function(){var r=(0,ur.Z)(nt().mark(function a(){return nt().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return f.abrupt("return",this.buildModels());case 1:case"end":return f.stop()}},a,this)}));function n(){return r.apply(this,arguments)}return n}()},{key:"buildModels",value:function(){var r=(0,ur.Z)(nt().mark(function a(){var u;return nt().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return g.next=2,this.layer.buildLayerModel({moduleName:"pointRadar",vertexShader:Lw,fragmentShader:Iw,triangulation:Rd,depth:{enable:!1}});case 2:return u=g.sent,g.abrupt("return",[u]);case 4:case"end":return g.stop()}},a,this)}));function n(){return r.apply(this,arguments)}return n}()},{key:"animateOption2Array",value:function(n){return[n.enable?0:1,n.speed||1,n.rings||3,0]}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"extrude",type:mn.Attribute,descriptor:{name:"a_Extrude",buffer:{usage:Ge.DYNAMIC_DRAW,data:[],type:Ge.FLOAT},size:3,update:function(a,u,f,g){var x=[1,1,0,-1,1,0,-1,-1,0,1,-1,0],I=g%4*3;return[x[I],x[I+1],x[I+2]]}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:mn.Attribute,descriptor:{name:"a_Size",buffer:{usage:Ge.DYNAMIC_DRAW,data:[],type:Ge.FLOAT},size:1,update:function(a){var u=a.size,f=u===void 0?5:u;return Array.isArray(f)?[f[0]]:[f]}}})}}]),t}(vo);function Ow(e,i){var t=typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=Rw(e))||i&&e&&typeof e.length=="number"){t&&(e=t);var r=0,n=function(){};return{s:n,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(x){throw x},f:n}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var a=!0,u=!1,f;return{s:function(){t=t.call(e)},n:function(){var x=t.next();return a=x.done,x},e:function(x){u=!0,f=x},f:function(){try{!a&&t.return!=null&&t.return()}finally{if(u)throw f}}}}function Rw(e,i){if(e){if(typeof e=="string")return x1(e,i);var t=Object.prototype.toString.call(e).slice(8,-1);if(t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set")return Array.from(e);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return x1(e,i)}}function x1(e,i){(i==null||i>e.length)&&(i=e.length);for(var t=0,r=new Array(i);t<i;t++)r[t]=e[t];return r}var kw=function(){function e(i,t,r){(0,ue.Z)(this,e),(0,Ce.Z)(this,"boxCells",[]);var n=this.boxCells;this.xCellCount=Math.ceil(i/r),this.yCellCount=Math.ceil(t/r);for(var a=0;a<this.xCellCount*this.yCellCount;a++)n.push([]);this.boxKeys=[],this.bboxes=[],this.width=i,this.height=t,this.xScale=this.xCellCount/i,this.yScale=this.yCellCount/t,this.boxUid=0}return(0,me.Z)(e,[{key:"insert",value:function(t,r,n,a,u){this.forEachCell(r,n,a,u,this.insertBoxCell,this.boxUid++),this.boxKeys.push(t),this.bboxes.push(r),this.bboxes.push(n),this.bboxes.push(a),this.bboxes.push(u)}},{key:"query",value:function(t,r,n,a,u){return this.queryHitTest(t,r,n,a,!1,u)}},{key:"hitTest",value:function(t,r,n,a,u){return this.queryHitTest(t,r,n,a,!0,u)}},{key:"insertBoxCell",value:function(t,r,n,a,u,f){this.boxCells[u].push(f)}},{key:"queryHitTest",value:function(t,r,n,a,u,f){if(n<0||t>this.width||a<0||r>this.height)return u?!1:[];var g=[];if(t<=0&&r<=0&&this.width<=n&&this.height<=a){if(u)return!0;for(var x=0;x<this.boxKeys.length;x++)g.push({key:this.boxKeys[x],x1:this.bboxes[x*4],y1:this.bboxes[x*4+1],x2:this.bboxes[x*4+2],y2:this.bboxes[x*4+3]});return f?g.filter(f):g}var I={hitTest:u,seenUids:{box:{},circle:{}}};return this.forEachCell(t,r,n,a,this.queryCell,g,I,f),u?g.length>0:g}},{key:"queryCell",value:function(t,r,n,a,u,f,g,x){var I=g.seenUids,O=this.boxCells[u];if(O!==null){var B=this.bboxes,W=Ow(O),he;try{for(W.s();!(he=W.n()).done;){var ae=he.value;if(!I.box[ae]){I.box[ae]=!0;var Se=ae*4;if(t<=B[Se+2]&&r<=B[Se+3]&&n>=B[Se+0]&&a>=B[Se+1]&&(!x||x(this.boxKeys[ae]))){if(g.hitTest)return f.push(!0),!0;f.push({key:this.boxKeys[ae],x1:B[Se],y1:B[Se+1],x2:B[Se+2],y2:B[Se+3]})}}}}catch(Fe){W.e(Fe)}finally{W.f()}}return!1}},{key:"forEachCell",value:function(t,r,n,a,u,f,g,x){for(var I=this.convertToXCellCoord(t),O=this.convertToYCellCoord(r),B=this.convertToXCellCoord(n),W=this.convertToYCellCoord(a),he=I;he<=B;he++)for(var ae=O;ae<=W;ae++){var Se=this.xCellCount*ae+he;if(u.call(this,t,r,n,a,Se,f,g,x))return}}},{key:"convertToXCellCoord",value:function(t){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(t*this.xScale)))}},{key:"convertToYCellCoord",value:function(t){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(t*this.yScale)))}}]),e}(),Dw=kw,Nw=function(){function e(i,t){(0,ue.Z)(this,e),(0,Ce.Z)(this,"viewportPadding",100),this.width=i,this.height=t,this.viewportPadding=Math.max(i,t),this.grid=new Dw(i+this.viewportPadding,t+this.viewportPadding,25),this.screenRightBoundary=i+this.viewportPadding,this.screenBottomBoundary=t+this.viewportPadding,this.gridRightBoundary=i+2*this.viewportPadding,this.gridBottomBoundary=t+2*this.viewportPadding}return(0,me.Z)(e,[{key:"placeCollisionBox",value:function(t){var r=t.x1+t.anchorPointX+this.viewportPadding,n=t.y1+t.anchorPointY+this.viewportPadding,a=t.x2+t.anchorPointX+this.viewportPadding,u=t.y2+t.anchorPointY+this.viewportPadding;return!this.isInsideGrid(r,n,a,u)||this.grid.hitTest(r,n,a,u)?{box:[]}:{box:[r,n,a,u]}}},{key:"insertCollisionBox",value:function(t,r){var n={featureIndex:r};this.grid.insert(n,t[0],t[1],t[2],t[3])}},{key:"project",value:function(t,r,n){var a=Fh(r,n,0,1),u=Nh(),f=X0.apply(P,(0,Mr.Z)(t));return rh(u,a,f),{x:(u[0]/u[3]+1)/2*this.width+this.viewportPadding,y:(-u[1]/u[3]+1)/2*this.height+this.viewportPadding}}},{key:"isInsideGrid",value:function(t,r,n,a){return n>=0&&t<this.gridRightBoundary&&a>=0&&r<this.gridBottomBoundary}}]),e}();function E1(e,i){var t=typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=Fw(e))||i&&e&&typeof e.length=="number"){t&&(e=t);var r=0,n=function(){};return{s:n,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(x){throw x},f:n}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var a=!0,u=!1,f;return{s:function(){t=t.call(e)},n:function(){var x=t.next();return a=x.done,x},e:function(x){u=!0,f=x},f:function(){try{!a&&t.return!=null&&t.return()}finally{if(u)throw f}}}}function Fw(e,i){if(e){if(typeof e=="string")return b1(e,i);var t=Object.prototype.toString.call(e).slice(8,-1);if(t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set")return Array.from(e);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return b1(e,i)}}function b1(e,i){(i==null||i>e.length)&&(i=e.length);for(var t=0,r=new Array(i);t<i;t++)r[t]=e[t];return r}function S1(e){var i=.5,t=.5;switch(e){case"right":case"top-right":case"bottom-right":i=1;break;case"left":case"top-left":case"bottom-left":i=0;break;default:i=.5}switch(e){case"bottom":case"bottom-right":case"bottom-left":t=1;break;case"top":case"top-right":case"top-left":t=0;break;default:t=.5}return{horizontalAlign:i,verticalAlign:t}}function C1(e,i,t,r,n){if(n){var a=e[r],u=a.glyph;if(u)for(var f=i[u].advance*a.scale,g=(e[r].x+f)*n,x=t;x<=r;x++)e[x].x-=g}}function w1(e,i,t,r,n,a,u){var f=(i-t)*n,g=(-r*u+.5)*a,x=E1(e),I;try{for(x.s();!(I=x.n()).done;){var O=I.value;O.x+=f,O.y+=g}}catch(B){x.e(B)}finally{x.f()}}function Bw(e,i,t,r,n,a,u){var f=-8,g=0,x=f,I=0,O=e.positionedGlyphs,B=a==="right"?1:a==="left"?0:.5,W=O.length;t.forEach(function(Qe){if(Qe.split("").forEach(function(yt){var Et=i[yt],Ot=0;Et&&(O.push({glyph:yt,x:g,y:x+Ot,vertical:!1,scale:1,metrics:Et}),g+=Et.advance+u)}),O.length!==W){var qe=g-u;I=Math.max(qe,I),C1(O,i,W,O.length-1,B)}g=0,x-=r+5});var he=S1(n),ae=he.horizontalAlign,Se=he.verticalAlign;w1(O,B,ae,Se,I,r,t.length);var Fe=x-f;e.top+=-Se*Fe,e.bottom=e.top-Fe,e.left+=-ae*I,e.right=e.left+I}function Zw(e,i,t,r,n,a,u){var f=-8,g=0,x=f,I=0,O=e.positionedGlyphs,B=a==="right"?1:a==="left"?0:.5,W=O.length;t.forEach(function(Qe){var qe=i[Qe],yt=0;if(qe&&(O.push({glyph:Qe,x:qe.advance/2,y:x+yt,vertical:!1,scale:1,metrics:qe}),g+=qe.advance+u),O.length!==W){var Et=g-u;I=Math.max(Et,I),C1(O,i,W,O.length-1,B)}g=0,x-=r+5});var he=S1(n),ae=he.horizontalAlign,Se=he.verticalAlign;w1(O,B,ae,Se,I,r,t.length);var Fe=x-f;e.top+=-Se*Fe,e.bottom=e.top-Fe,e.left+=-ae*I,e.right=e.left+I}function zw(e,i,t,r,n,a){var u=arguments.length>6&&arguments[6]!==void 0?arguments[6]:[0,0],f=arguments.length>7?arguments[7]:void 0,g=e.split(`
`),x=[],I={positionedGlyphs:x,top:u[1],bottom:u[1],left:u[0],right:u[0],lineCount:g.length,text:e};return f?Zw(I,i,g,t,r,n,a):Bw(I,i,g,t,r,n,a),x.length?I:!1}function Uw(e){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[0,0],t=arguments.length>2?arguments[2]:void 0,r=e.positionedGlyphs,n=r===void 0?[]:r,a=[],u=E1(n),f;try{for(u.s();!(f=u.n()).done;){var g=f.value,x=g.metrics,I=4,O=x.advance*g.scale/2,B=t?[g.x+O,g.y]:[0,0],W=t?[0,0]:[g.x+O+i[0],g.y+i[1]],he=(0-I)*g.scale-O+W[0],ae=(0-I)*g.scale+W[1],Se=he+x.width*g.scale,Fe=ae+x.height*g.scale,Qe={x:he,y:ae},qe={x:Se,y:ae},yt={x:he,y:Fe},Et={x:Se,y:Fe};a.push({tl:Qe,tr:qe,bl:yt,br:Et,tex:x,glyphOffset:B})}}catch(Ot){u.e(Ot)}finally{u.f()}return a}function Gw(e,i){var t=typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=jw(e))||i&&e&&typeof e.length=="number"){t&&(e=t);var r=0,n=function(){};return{s:n,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(x){throw x},f:n}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var a=!0,u=!1,f;return{s:function(){t=t.call(e)},n:function(){var x=t.next();return a=x.done,x},e:function(x){u=!0,f=x},f:function(){try{!a&&t.return!=null&&t.return()}finally{if(u)throw f}}}}function jw(e,i){if(e){if(typeof e=="string")return T1(e,i);var t=Object.prototype.toString.call(e).slice(8,-1);if(t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set")return Array.from(e);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return T1(e,i)}}function T1(e,i){(i==null||i>e.length)&&(i=e.length);for(var t=0,r=new Array(i);t<i;t++)r[t]=e[t];return r}function Vw(e){var i=Hw();return function(){var r=(0,oe.Z)(e),n;if(i){var a=(0,oe.Z)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return(0,Ze.Z)(this,n)}}function Hw(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var M1=`#define SDF_PX 8.0
#define EDGE_GAMMA 0.105
#define FONT_SIZE 48.0
uniform sampler2D u_sdf_map;
uniform float u_gamma_scale : 0.5;
uniform float u_stroke_width : 2.0;
uniform float u_halo_blur : 0.5;
uniform float u_DevicePixelRatio;

varying vec4 v_color;
varying vec4 v_stroke_color;
varying vec2 v_uv;
varying float v_gamma_scale;
varying float v_fontScale;


#pragma include "picking"
void main() {
  // get style data mapping

  // get sdf from atlas
  float dist = texture2D(u_sdf_map, v_uv).a;

  lowp float buff = (6.0 - u_stroke_width / v_fontScale) / SDF_PX;
  highp float gamma = (u_halo_blur * 1.19 / SDF_PX + EDGE_GAMMA) / (v_fontScale * u_gamma_scale) / 1.0;

  highp float gamma_scaled = gamma * v_gamma_scale;

  highp float alpha = smoothstep(buff - gamma_scaled, buff + gamma_scaled, dist);

  gl_FragColor = mix(v_color, v_stroke_color, smoothstep(0., 0.5, 1.- dist));

  gl_FragColor.a *= alpha;
   // \u4F5C\u4E3A mask \u6A21\u677F\u65F6\u9700\u8981\u4E22\u5F03\u900F\u660E\u7684\u50CF\u7D20
  if (gl_FragColor.a < 0.01) {
    discard;
  }
  gl_FragColor = filterColor(gl_FragColor);
}
`,I1=`#define SDF_PX 8.0
#define EDGE_GAMMA 0.105
#define FONT_SIZE 24.0
attribute vec3 a_Position;
attribute vec2 a_tex;
attribute vec2 a_textOffsets;
attribute vec4 a_Color;
attribute float a_Size;

uniform vec2 u_sdf_map_size;
uniform mat4 u_ModelMatrix;

uniform float u_raisingHeight: 0.0;

varying vec2 v_uv;
varying float v_gamma_scale;
varying vec4 v_color;
varying vec4 v_stroke_color;
varying float v_fontScale;
uniform float u_stroke_width : 2;
uniform vec4 u_stroke_color : [0.0, 0.0, 0.0, 0.0];



#pragma include "projection"
#pragma include "picking"
#pragma include "rotation_2d"

void main() {
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
  
  v_uv = a_tex / u_sdf_map_size;



  v_color = vec4(a_Color.xyz, a_Color.w * opacity);
  v_stroke_color = vec4(u_stroke_color.xyz, u_stroke_color.w * opacity);

  // \u6587\u672C\u7F29\u653E\u6BD4\u4F8B
  float fontScale = a_Size / FONT_SIZE;
  v_fontScale = fontScale;

  vec4 project_pos = project_position(vec4(a_Position, 1.0));
  // vec4 projected_position  = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));

  vec2 offset = rotate_matrix(a_textOffsets,rotation);
  
  // gl_Position = vec4(projected_position.xy / projected_position.w + rotation_matrix * a_textOffsets * fontScale / u_ViewportSize * 2.0 * u_DevicePixelRatio, 0.0, 1.0);

  float raiseHeight = u_raisingHeight;
  if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
    float mapboxZoomScale = 4.0/pow(2.0, 21.0 - u_Zoom);
    raiseHeight = u_raisingHeight * mapboxZoomScale;
  }

  vec4 projected_position = project_common_position_to_clipspace_v2(vec4(project_pos.xyz + vec3(0.0, 0.0, raiseHeight), 1.0));

  gl_Position = vec4(
    projected_position.xy / projected_position.w + offset * fontScale / u_ViewportSize * 2.0 * u_DevicePixelRatio, 0.0, 1.0);
  v_gamma_scale = gl_Position.w;
  setPickingColor(a_PickingColor);

}
`,dp=In.isEqual;function L1(e){var i=this,t=e.id,r=[],n=[];if(!i.glyphInfoMap||!i.glyphInfoMap[t])return{vertices:[],indices:[],size:7};var a=i.glyphInfoMap[t].centroid,u=a.length===2?[a[0],a[1],0]:a;return i.glyphInfoMap[t].glyphQuads.forEach(function(f,g){r.push.apply(r,(0,Mr.Z)(u).concat([f.tex.x,f.tex.y+f.tex.height,f.tl.x,f.tl.y],(0,Mr.Z)(u),[f.tex.x+f.tex.width,f.tex.y+f.tex.height,f.tr.x,f.tr.y],(0,Mr.Z)(u),[f.tex.x+f.tex.width,f.tex.y,f.br.x,f.br.y],(0,Mr.Z)(u),[f.tex.x,f.tex.y,f.bl.x,f.bl.y])),n.push(0+g*4,1+g*4,2+g*4,2+g*4,3+g*4,0+g*4)}),{vertices:r,indices:n,size:7}}var P1=function(e){(0,ke.Z)(t,e);var i=Vw(t);function t(){var r;(0,ue.Z)(this,t);for(var n=arguments.length,a=new Array(n),u=0;u<n;u++)a[u]=arguments[u];return r=i.call.apply(i,[this].concat(a)),(0,Ce.Z)((0,bt.Z)(r),"glyphInfoMap",{}),(0,Ce.Z)((0,bt.Z)(r),"currentZoom",-1),(0,Ce.Z)((0,bt.Z)(r),"textureHeight",0),(0,Ce.Z)((0,bt.Z)(r),"textCount",0),(0,Ce.Z)((0,bt.Z)(r),"preTextStyle",{}),(0,Ce.Z)((0,bt.Z)(r),"mapping",(0,ur.Z)(nt().mark(function f(){return nt().wrap(function(x){for(;;)switch(x.prev=x.next){case 0:return r.initGlyph(),r.updateTexture(),x.next=4,r.reBuildModel();case 4:case"end":return x.stop()}},f)}))),r}return(0,me.Z)(t,[{key:"getUninforms",value:function(){var n=this.layer.getLayerConfig(),a=n.stroke,u=a===void 0?"#fff":a,f=n.strokeWidth,g=f===void 0?0:f,x=n.halo,I=x===void 0?.5:x,O=n.gamma,B=O===void 0?2:O,W=n.raisingHeight,he=W===void 0?0:W,ae=this.getFontServiceMapping(),Se=this.getFontServiceCanvas();return ae&&Object.keys(ae).length!==this.textCount&&Se&&(this.updateTexture(),this.textCount=Object.keys(ae).length),this.preTextStyle=this.getTextStyle(),(0,X.Z)({u_raisingHeight:Number(he),u_stroke_width:g,u_stroke_color:Ni(u),u_sdf_map:this.texture,u_halo_blur:I,u_gamma_scale:B,u_sdf_map_size:[(Se==null?void 0:Se.width)||1,(Se==null?void 0:Se.height)||1]},this.getStyleAttribute())}},{key:"initModels",value:function(){var r=(0,ur.Z)(nt().mark(function a(){return nt().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return this.bindEvent(),this.extent=this.textExtent(),this.rawEncodeData=this.layer.getEncodedData(),this.preTextStyle=this.getTextStyle(),f.abrupt("return",this.buildModels());case 5:case"end":return f.stop()}},a,this)}));function n(){return r.apply(this,arguments)}return n}()},{key:"buildModels",value:function(){var r=(0,ur.Z)(nt().mark(function a(){var u,f,g,x;return nt().wrap(function(O){for(;;)switch(O.prev=O.next){case 0:return u=this.layer.getLayerConfig(),f=u.textAllowOverlap,g=f===void 0?!1:f,this.initGlyph(),this.updateTexture(),g||this.filterGlyphs(),O.next=6,this.layer.buildLayerModel({moduleName:"pointText",vertexShader:I1,fragmentShader:M1,inject:this.getInject(),triangulation:L1.bind(this),depth:{enable:!1}});case 6:return x=O.sent,O.abrupt("return",[x]);case 8:case"end":return O.stop()}},a,this)}));function n(){return r.apply(this,arguments)}return n}()},{key:"needUpdate",value:function(){var r=(0,ur.Z)(nt().mark(function a(){var u,f,g,x,I,O,B,W,he,ae,Se,Fe;return nt().wrap(function(qe){for(;;)switch(qe.prev=qe.next){case 0:if(u=this.getTextStyle(),f=u.textAllowOverlap,g=f===void 0?!1:f,x=u.textAnchor,I=x===void 0?"center":x,O=u.textOffset,B=u.padding,W=u.fontFamily,he=u.fontWeight,!(!dp(B,this.preTextStyle.padding)||!dp(O,this.preTextStyle.textOffset)||!dp(I,this.preTextStyle.textAnchor)||!dp(W,this.preTextStyle.fontFamily)||!dp(he,this.preTextStyle.fontWeight))){qe.next=5;break}return qe.next=4,this.mapping();case 4:return qe.abrupt("return",!0);case 5:if(!g){qe.next=7;break}return qe.abrupt("return",!1);case 7:if(ae=this.mapService.getZoom(),Se=this.mapService.getBounds(),Fe=zr(this.extent,Se),!(Math.abs(this.currentZoom-ae)>.5||!Fe||g!==this.preTextStyle.textAllowOverlap)){qe.next=14;break}return qe.next=13,this.reBuildModel();case 13:return qe.abrupt("return",!0);case 14:return qe.abrupt("return",!1);case 15:case"end":return qe.stop()}},a,this)}));function n(){return r.apply(this,arguments)}return n}()},{key:"clearModels",value:function(){var n;(n=this.texture)===null||n===void 0||n.destroy(),this.layer.off("remapping",this.mapping)}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"textOffsets",type:mn.Attribute,descriptor:{name:"a_textOffsets",buffer:{usage:Ge.STATIC_DRAW,data:[],type:Ge.FLOAT},size:2,update:function(a,u,f){return[f[5],f[6]]}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:mn.Attribute,descriptor:{name:"a_Size",buffer:{usage:Ge.DYNAMIC_DRAW,data:[],type:Ge.FLOAT},size:1,update:function(a){var u=a.size,f=u===void 0?12:u;return Array.isArray(f)?[f[0]]:[f]}}}),this.styleAttributeService.registerStyleAttribute({name:"textUv",type:mn.Attribute,descriptor:{name:"a_tex",buffer:{usage:Ge.DYNAMIC_DRAW,data:[],type:Ge.FLOAT},size:2,update:function(a,u,f){return[f[3],f[4]]}}})}},{key:"bindEvent",value:function(){this.layer.isTileLayer||this.layer.on("remapping",this.mapping)}},{key:"textExtent",value:function(){var n=this.mapService.getBounds();return Au(n,.5)}},{key:"initTextFont",value:function(){var n=this.getTextStyle(),a=n.fontWeight,u=n.fontFamily,f=this.rawEncodeData,g=[];f.forEach(function(x){var I=x.shape,O=I===void 0?"":I;O=O.toString();var B=Gw(O),W;try{for(B.s();!(W=B.n()).done;){var he=W.value;g.indexOf(he)===-1&&g.push(he)}}catch(ae){B.e(ae)}finally{B.f()}}),this.fontService.setFontOptions({characterSet:g,fontWeight:a,fontFamily:u,iconfont:!1})}},{key:"initIconFontTex",value:function(){var n=this.getTextStyle(),a=n.fontWeight,u=n.fontFamily,f=this.rawEncodeData,g=[];f.forEach(function(x){var I=x.shape,O=I===void 0?"":I;O="".concat(O),g.indexOf(O)===-1&&g.push(O)}),this.fontService.setFontOptions({characterSet:g,fontWeight:a,fontFamily:u,iconfont:!0})}},{key:"getTextStyle",value:function(){var n=this.layer.getLayerConfig(),a=n.fontWeight,u=a===void 0?"400":a,f=n.fontFamily,g=f===void 0?"sans-serif":f,x=n.textAllowOverlap,I=x===void 0?!1:x,O=n.padding,B=O===void 0?[0,0]:O,W=n.textAnchor,he=W===void 0?"center":W,ae=n.textOffset,Se=ae===void 0?[0,0]:ae,Fe=n.opacity,Qe=Fe===void 0?1:Fe,qe=n.strokeOpacity,yt=qe===void 0?1:qe,Et=n.strokeWidth,Ot=Et===void 0?0:Et,jt=n.stroke,or=jt===void 0?"#000":jt;return{fontWeight:u,fontFamily:g,textAllowOverlap:I,padding:B,textAnchor:he,textOffset:Se,opacity:Qe,strokeOpacity:yt,strokeWidth:Ot,stroke:or}}},{key:"generateGlyphLayout",value:function(n){var a=this,u=this.getFontServiceMapping(),f=this.layer.getLayerConfig(),g=f.spacing,x=g===void 0?2:g,I=f.textAnchor,O=I===void 0?"center":I,B=f.textOffset,W=this.rawEncodeData;this.glyphInfo=W.map(function(he){var ae=he.shape,Se=ae===void 0?"":ae,Fe=he.id,Qe=he.size,qe=Qe===void 0?1:Qe,yt=he.textOffset?he.textOffset:B||[0,0],Et=he.textAnchor?he.textAnchor:O||"center",Ot=zw(Se.toString(),u,qe,Et,"left",x,yt,n),jt=Uw(Ot,yt,!1);return he.shaping=Ot,he.glyphQuads=jt,he.centroid=Is(he.coordinates),he.originCentroid=he.version==="GAODE2.x"?Is(he.originCoordinates):he.originCentroid=he.centroid,a.glyphInfoMap[Fe]={shaping:Ot,glyphQuads:jt,centroid:Is(he.coordinates)},he})}},{key:"getFontServiceMapping",value:function(){var n=this.layer.getLayerConfig(),a=n.fontWeight,u=a===void 0?"400":a,f=n.fontFamily,g=f===void 0?"sans-serif":f;return this.fontService.getMappingByKey("".concat(g,"_").concat(u))}},{key:"getFontServiceCanvas",value:function(){var n=this.layer.getLayerConfig(),a=n.fontWeight,u=a===void 0?"400":a,f=n.fontFamily,g=f===void 0?"sans-serif":f;return this.fontService.getCanvasByKey("".concat(g,"_").concat(u))}},{key:"filterGlyphs",value:function(){var n=this,a=this.layer.getLayerConfig(),u=a.padding,f=u===void 0?[0,0]:u,g=a.textAllowOverlap,x=g===void 0?!1:g;if(!x){this.glyphInfoMap={},this.currentZoom=this.mapService.getZoom(),this.extent=this.textExtent();var I=this.rendererService.getViewportSize(),O=I.width,B=I.height,W=new Nw(O,B),he=this.glyphInfo.filter(function(ae){var Se=ae.shaping,Fe=ae.id,Qe=Fe===void 0?0:Fe,qe=ae.version==="GAODE2.x"?ae.originCentroid:ae.centroid,yt=ae.size,Et=yt/16,Ot=n.mapService.lngLatToContainer(qe),jt=W.placeCollisionBox({x1:Se.left*Et-f[0],x2:Se.right*Et+f[0],y1:Se.top*Et-f[1],y2:Se.bottom*Et+f[1],anchorPointX:Ot.x,anchorPointY:Ot.y}),or=jt.box;return or&&or.length?(W.insertCollisionBox(or,Qe),!0):!1});he.forEach(function(ae){n.glyphInfoMap[ae.id]=ae})}}},{key:"initGlyph",value:function(){var n=this.layer.getLayerConfig(),a=n.iconfont,u=a===void 0?!1:a;u?this.initIconFontTex():this.initTextFont(),this.generateGlyphLayout(u)}},{key:"updateTexture",value:function(){var n=this.rendererService.createTexture2D,a=this.getFontServiceCanvas();this.textureHeight=a.height,this.texture&&this.texture.destroy(),this.texture=n({data:a,mag:Ge.LINEAR,min:Ge.LINEAR,width:a.width,height:a.height})}},{key:"reBuildModel",value:function(){var r=(0,ur.Z)(nt().mark(function a(){var u;return nt().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return this.filterGlyphs(),g.next=3,this.layer.buildLayerModel({moduleName:"pointText",vertexShader:I1,fragmentShader:M1,triangulation:L1.bind(this),inject:this.getInject(),depth:{enable:!1}});case 3:u=g.sent,this.layer.models=[u];case 5:case"end":return g.stop()}},a,this)}));function n(){return r.apply(this,arguments)}return n}()}]),t}(vo),$w={fillImage:mw,fill:g1,radar:Pw,image:m1,normal:_1,simplePoint:XC,extrude:d1,text:P1,earthFill:ow,earthExtrude:tw},Ww=$w;function Yw(e,i){var t=typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=Xw(e))||i&&e&&typeof e.length=="number"){t&&(e=t);var r=0,n=function(){};return{s:n,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(x){throw x},f:n}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var a=!0,u=!1,f;return{s:function(){t=t.call(e)},n:function(){var x=t.next();return a=x.done,x},e:function(x){u=!0,f=x},f:function(){try{!a&&t.return!=null&&t.return()}finally{if(u)throw f}}}}function Xw(e,i){if(e){if(typeof e=="string")return O1(e,i);var t=Object.prototype.toString.call(e).slice(8,-1);if(t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set")return Array.from(e);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return O1(e,i)}}function O1(e,i){(i==null||i>e.length)&&(i=e.length);for(var t=0,r=new Array(i);t<i;t++)r[t]=e[t];return r}function Qw(e){var i=qw();return function(){var r=(0,oe.Z)(e),n;if(i){var a=(0,oe.Z)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return(0,Ze.Z)(this,n)}}function qw(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var Bd=function(e){(0,ke.Z)(t,e);var i=Qw(t);function t(){var r;(0,ue.Z)(this,t);for(var n=arguments.length,a=new Array(n),u=0;u<n;u++)a[u]=arguments[u];return r=i.call.apply(i,[this].concat(a)),(0,Ce.Z)((0,bt.Z)(r),"type","PointLayer"),(0,Ce.Z)((0,bt.Z)(r),"enableShaderEncodeStyles",["opacity","offsets","stroke","rotation"]),(0,Ce.Z)((0,bt.Z)(r),"enableDataEncodeStyles",["textOffset","textAnchor"]),(0,Ce.Z)((0,bt.Z)(r),"defaultSourceConfig",{data:[],options:{parser:{type:"json",x:"lng",y:"lat"}}}),r}return(0,me.Z)(t,[{key:"buildModels",value:function(){var r=(0,ur.Z)(nt().mark(function a(){var u;return nt().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return u=this.getModelType(),this.layerModel&&this.layerModel.clearModels(),this.layerModel=new Ww[u](this),g.next=5,this.initLayerModels();case 5:case"end":return g.stop()}},a,this)}));function n(){return r.apply(this,arguments)}return n}()},{key:"rebuildModels",value:function(){var r=(0,ur.Z)(nt().mark(function a(){return nt().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return f.next=2,this.buildModels();case 2:case"end":return f.stop()}},a,this)}));function n(){return r.apply(this,arguments)}return n}()},{key:"getModelTypeWillEmptyData",value:function(){if(this.shapeOption){var n=this.shapeOption,a=n.field,u=n.values,f=this.getLayerConfig(),g=f.shape2d,x=this.iconService.getIconMap();if(a&&(g==null?void 0:g.indexOf(a))!==-1)return"fill";if(u==="text")return"text";if(u&&u instanceof Array){var I=Yw(u),O;try{for(I.s();!(O=I.n()).done;){var B=O.value;if(typeof B=="string"&&x.hasOwnProperty(B))return"image"}}catch(W){I.e(W)}finally{I.f()}}}return"normal"}},{key:"getDefaultConfig",value:function(){var n=this.getModelType(),a={fillImage:{},normal:{blend:"additive"},radar:{},simplePoint:{},fill:{blend:"normal"},extrude:{},image:{},text:{blend:"normal"},tile:{},tileText:{},earthFill:{},earthExtrude:{}};return a[n]}},{key:"getModelType",value:function(){var n=this.getEncodedData(),a=this.getLayerConfig(),u=a.shape2d,f=a.shape3d,g=a.billboard,x=g===void 0?!0:g,I=this.iconService.getIconMap(),O=n.find(function(W){return W.hasOwnProperty("shape")});if(O){var B=O.shape;return B==="dot"?"normal":B==="simple"?"simplePoint":B==="radar"?"radar":this.layerType==="fillImage"||x===!1?"fillImage":(u==null?void 0:u.indexOf(B))!==-1?this.mapService.version==="GLOBEL"?"earthFill":"fill":(f==null?void 0:f.indexOf(B))!==-1?this.mapService.version==="GLOBEL"?"earthExtrude":"extrude":I.hasOwnProperty(B)?"image":"text"}else return this.getModelTypeWillEmptyData()}}]),t}(nA);function Kw(e){var i=Jw();return function(){var r=(0,oe.Z)(e),n;if(i){var a=(0,oe.Z)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return(0,Ze.Z)(this,n)}}function Jw(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var e4=`uniform vec4 u_sourceColor;
uniform vec4 u_targetColor;
uniform float u_linearColor: 0;

uniform float u_topsurface: 1.0;
uniform float u_sidesurface: 1.0;

varying vec4 v_Color;

#pragma include "picking"

void main() {


     // top face
    if(u_topsurface < 1.0) {
      discard;
    }

    gl_FragColor = v_Color;
  

  gl_FragColor = filterColor(gl_FragColor);
}
`,t4=`precision highp float;

#define ambientRatio 0.5
#define diffuseRatio 0.3
#define specularRatio 0.2

attribute vec4 a_Color;
attribute vec3 a_Position;
attribute vec3 a_Normal;
attribute float a_Size;
attribute vec3 a_uvs;
uniform mat4 u_ModelMatrix;

uniform vec4 u_sourceColor;
uniform vec4 u_targetColor;
uniform float u_linearColor: 0;

uniform float u_topsurface: 1.0;
uniform float u_sidesurface: 1.0;

varying vec4 v_Color;
uniform float u_heightfixed: 0.0; // \u9ED8\u8BA4\u4E0D\u56FA\u5B9A
uniform float u_raisingHeight: 0.0;

#pragma include "projection"
#pragma include "light"
#pragma include "picking"

void main() {
 
  float isSide = a_Position.z;
 float topU = a_uvs[0];
 float topV = 1.0 - a_uvs[1];
 float sidey = a_uvs[2];

  vec4 pos = vec4(a_Position.xy, a_Position.z * a_Size, 1.0);
  float lightWeight = calc_lighting(pos);

  vec4 project_pos = project_position(pos);

  if(u_heightfixed > 0.0) { // \u5224\u65AD\u51E0\u4F55\u4F53\u662F\u5426\u56FA\u5B9A\u9AD8\u5EA6
    project_pos.z = a_Position.z * a_Size;
    project_pos.z += u_raisingHeight;

    if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
      float mapboxZoomScale = 4.0/pow(2.0, 21.0 - u_Zoom);
      project_pos.z *= mapboxZoomScale;
      project_pos.z += u_raisingHeight * mapboxZoomScale;
    }
  }


 gl_Position = project_common_position_to_clipspace_v2(vec4(project_pos.xyz, 1.0));

  // Tip: \u90E8\u5206\u673A\u578B GPU \u8BA1\u7B97\u7CBE\u5EA6\u517C\u5BB9
  if(isSide < 0.999) {
    // side face
    // if(u_sidesurface < 1.0) {
    //   discard;
    // }

    if(u_linearColor == 1.0) {
      vec4 linearColor = mix(u_targetColor, u_sourceColor, sidey);
      linearColor.rgb *= lightWeight;
      v_Color = linearColor;
    } else {
      v_Color = a_Color;
    }

  } else {
    v_Color = a_Color;
  }

  v_Color = vec4(v_Color.rgb * lightWeight, v_Color.w * opacity);


  setPickingColor(a_PickingColor);
}
`,r4=`uniform sampler2D u_texture;
uniform float u_opacity: 1.0;
uniform vec4 u_sourceColor;
uniform vec4 u_targetColor;
uniform float u_linearColor: 0;

uniform float u_topsurface: 1.0;
uniform float u_sidesurface: 1.0;

varying vec4 v_Color;
varying vec3 v_uvs;
varying vec2 v_texture_data;


#pragma include "picking"

void main() {
  float opacity = u_opacity;
  float isSide = v_texture_data.x;
  float lightWeight = v_texture_data.y;
  float topU = v_uvs[0];
  float topV = 1.0 - v_uvs[1];
  float sidey = v_uvs[2];
  // Tip: \u90E8\u5206\u673A\u578B GPU \u8BA1\u7B97\u7CBE\u5EA6\u517C\u5BB9
  if(isSide < 0.999) {// \u662F\u5426\u662F\u8FB9\u7F18
    // side face
    if(u_sidesurface < 1.0) {
      discard;
    }

    if(u_linearColor == 1.0) {
      vec4 linearColor = mix(u_targetColor, u_sourceColor, sidey);
      linearColor.rgb *= lightWeight;
      gl_FragColor = linearColor;
    } else {
      gl_FragColor = v_Color;
    }
  } else {

     // top face
    if(u_topsurface < 1.0) {
      discard;
    }

    gl_FragColor = texture2D(u_texture, vec2(topU, topV));
    // gl_FragColor = vec4(1.0, 0., 0., 1.0);
  }
  

  gl_FragColor.a *= opacity;
  gl_FragColor = filterColor(gl_FragColor);
}
`,n4=`precision highp float;

#define ambientRatio 0.5
#define diffuseRatio 0.3
#define specularRatio 0.2

attribute vec4 a_Color;
attribute vec3 a_Position;
attribute vec3 a_Normal;
attribute float a_Size;
attribute vec3 a_uvs;
uniform mat4 u_ModelMatrix;

uniform sampler2D u_texture;


uniform vec4 u_sourceColor;
uniform vec4 u_targetColor;
uniform float u_topsurface: 1.0;
uniform float u_sidesurface: 1.0;
varying vec4 v_Color;
uniform float u_heightfixed: 0.0; // \u9ED8\u8BA4\u4E0D\u56FA\u5B9A
uniform float u_raisingHeight: 0.0;
uniform float u_linearColor: 0.0;

varying vec2 v_texture_data;
varying vec3 v_uvs;

#pragma include "projection"
#pragma include "light"
#pragma include "picking"

void main() {
 
  vec4 pos = vec4(a_Position.xy, a_Position.z * a_Size, 1.0);
  float lightWeight = calc_lighting(pos);
  vec4 project_pos = project_position(pos);
  v_uvs = a_uvs;

  v_texture_data = vec2(a_Position.z, lightWeight);

  if(u_heightfixed > 0.0) { // \u5224\u65AD\u51E0\u4F55\u4F53\u662F\u5426\u56FA\u5B9A\u9AD8\u5EA6
    project_pos.z = a_Position.z * a_Size;
    project_pos.z += u_raisingHeight;

    if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
      float mapboxZoomScale = 4.0/pow(2.0, 21.0 - u_Zoom);
      project_pos.z *= mapboxZoomScale;
      project_pos.z += u_raisingHeight * mapboxZoomScale;
    }
  }


    gl_Position = project_common_position_to_clipspace_v2(vec4(project_pos.xyz, 1.0));



  setPickingColor(a_PickingColor);
}
`,i4=`uniform float u_opacity: 1.0;
uniform vec4 u_sourceColor;
uniform vec4 u_targetColor;
uniform float u_linearColor: 0;

uniform float u_topsurface: 1.0;
uniform float u_sidesurface: 1.0;

varying vec4 v_Color;
varying vec3 v_uvs;
varying vec2 v_texture_data;

#pragma include "picking"

void main() {
  float opacity = u_opacity;
  float isSide =  v_texture_data.x;
  float sidey = v_uvs[2];
  float lightWeight = v_texture_data.y;

  // Tip: \u90E8\u5206\u673A\u578B GPU \u8BA1\u7B97\u7CBE\u5EA6\u517C\u5BB9
  if(isSide < 0.999) {
    // side face
    if(u_sidesurface < 1.0) {
      discard;
    }
    
    if( u_linearColor == 1.0) {
      // side use linear
      vec4 linearColor = mix(u_targetColor, u_sourceColor, sidey);
      linearColor.rgb *= lightWeight;
      gl_FragColor = linearColor;
    } else {
      // side notuse linear
       gl_FragColor = v_Color;
    }
  } else {
    // top face
    if(u_topsurface < 1.0) {
      discard;
    }
    gl_FragColor = v_Color;
  }

  gl_FragColor.a *= opacity;
  gl_FragColor = filterColorAlpha(gl_FragColor, lightWeight);
}
`,a4=`precision highp float;

#define ambientRatio 0.5
#define diffuseRatio 0.3
#define specularRatio 0.2

attribute vec4 a_Color;
attribute vec3 a_Position;
attribute vec3 a_Normal;
attribute float a_Size;
attribute vec3 a_uvs;
uniform mat4 u_ModelMatrix;


uniform float u_heightfixed: 0.0; // \u9ED8\u8BA4\u4E0D\u56FA\u5B9A
uniform float u_raisingHeight: 0.0;

varying vec2 v_texture_data;
varying vec3 v_uvs;
varying vec4 v_Color;


#pragma include "projection"
#pragma include "light"
#pragma include "picking"

void main() {


  v_uvs = a_uvs;
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
  vec4 pos = vec4(a_Position.xy, a_Position.z * a_Size, 1.0);
  vec4 project_pos = project_position(pos);

  if(u_heightfixed > 0.0) { // \u5224\u65AD\u51E0\u4F55\u4F53\u662F\u5426\u56FA\u5B9A\u9AD8\u5EA6
    project_pos.z = a_Position.z * a_Size;
    project_pos.z += u_raisingHeight;
    if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
      float mapboxZoomScale = 4.0/pow(2.0, 21.0 - u_Zoom);
      project_pos.z *= mapboxZoomScale;
      project_pos.z += u_raisingHeight * mapboxZoomScale;
    }
  }

  gl_Position = project_common_position_to_clipspace_v2(vec4(project_pos.xyz, 1.0));
  float lightWeight = calc_lighting(pos);
  v_texture_data = vec2(a_Position.z,lightWeight);

  v_Color = vec4(a_Color.rgb * lightWeight, a_Color.w);

  setPickingColor(a_PickingColor);
}
`,o4=function(e){(0,ke.Z)(t,e);var i=Kw(t);function t(){return(0,ue.Z)(this,t),i.apply(this,arguments)}return(0,me.Z)(t,[{key:"getUninforms",value:function(){var n=this.layer.getLayerConfig(),a=n.heightfixed,u=a===void 0?!1:a,f=n.raisingHeight,g=f===void 0?0:f,x=n.topsurface,I=x===void 0?!0:x,O=n.sidesurface,B=O===void 0?!0:O,W=n.sourceColor,he=n.targetColor,ae=0,Se=[1,1,1,1],Fe=[1,1,1,1];return W&&he&&(Se=Ni(W),Fe=Ni(he),ae=1),(0,X.Z)({u_topsurface:Number(I),u_sidesurface:Number(B),u_heightfixed:Number(u),u_raisingHeight:Number(g),u_linearColor:ae,u_sourceColor:Se,u_targetColor:Fe,u_texture:this.texture},this.getStyleAttribute())}},{key:"initModels",value:function(){var r=(0,ur.Z)(nt().mark(function a(){return nt().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return f.next=2,this.loadTexture();case 2:return f.abrupt("return",this.buildModels());case 3:case"end":return f.stop()}},a,this)}));function n(){return r.apply(this,arguments)}return n}()},{key:"buildModels",value:function(){var r=(0,ur.Z)(nt().mark(function a(){var u,f,g,x,I;return nt().wrap(function(B){for(;;)switch(B.prev=B.next){case 0:return u=this.getShaders(),f=u.frag,g=u.vert,x=u.type,B.next=3,this.layer.buildLayerModel({moduleName:x,vertexShader:g,fragmentShader:f,inject:this.getInject(),triangulation:c1});case 3:return I=B.sent,B.abrupt("return",[I]);case 5:case"end":return B.stop()}},a,this)}));function n(){return r.apply(this,arguments)}return n}()},{key:"getShaders",value:function(){var n=this.layer.getLayerConfig(),a=n.pickLight,u=n.mapTexture;return u?{frag:r4,vert:n4,type:"polygonExtrudeTexture"}:a?{frag:i4,vert:a4,type:"polygonExtrudePickLight"}:{frag:e4,vert:t4,type:"polygonExtrude"}}},{key:"clearModels",value:function(){var n;(n=this.texture)===null||n===void 0||n.destroy()}},{key:"registerBuiltinAttributes",value:function(){var n=this.layer.getSource().extent,a=n,u=this.layer.coordCenter||this.layer.getSource().center,f=a[2]-a[0],g=a[3]-a[1];if(this.mapService.version==="GAODE2.x"){var x=this.mapService.coordToAMap2RelativeCoordinates([n[0],n[1]],u),I=(0,vn.Z)(x,2),O=I[0],B=I[1],W=this.mapService.coordToAMap2RelativeCoordinates([n[2],n[3]],u),he=(0,vn.Z)(W,2),ae=he[0],Se=he[1];f=ae-O,g=Se-B,a=[O,B,ae,Se]}this.styleAttributeService.registerStyleAttribute({name:"uvs",type:mn.Attribute,descriptor:{name:"a_uvs",buffer:{usage:Ge.STATIC_DRAW,data:[],type:Ge.FLOAT},size:3,update:function(Qe,qe,yt){var Et=yt[0],Ot=yt[1];return[(Et-a[0])/f,(Ot-a[1])/g,yt[4]]}}}),this.styleAttributeService.registerStyleAttribute({name:"normal",type:mn.Attribute,descriptor:{name:"a_Normal",buffer:{usage:Ge.STATIC_DRAW,data:[],type:Ge.FLOAT},size:3,update:function(Qe,qe,yt,Et,Ot){return Ot}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:mn.Attribute,descriptor:{name:"a_Size",buffer:{usage:Ge.DYNAMIC_DRAW,data:[],type:Ge.FLOAT},size:1,update:function(Qe){var qe=Qe.size,yt=qe===void 0?10:qe;return Array.isArray(yt)?[yt[0]]:[yt]}}})}},{key:"loadTexture",value:function(){var r=(0,ur.Z)(nt().mark(function a(){var u=this,f,g,x;return nt().wrap(function(O){for(;;)switch(O.prev=O.next){case 0:if(f=this.layer.getLayerConfig(),g=f.mapTexture,x=this.rendererService.createTexture2D,this.texture=x({height:0,width:0}),!g){O.next=5;break}return O.abrupt("return",new Promise(function(B,W){var he=new Image;he.crossOrigin="anonymous",he.src=g,he.onload=function(){return u.texture=x({data:he,width:he.width,height:he.height,wrapS:Ge.CLAMP_TO_EDGE,wrapT:Ge.CLAMP_TO_EDGE,min:Ge.LINEAR,mag:Ge.LINEAR}),B(null)},he.onerror=function(){W(new Error("image load error"))}}));case 5:case"end":return O.stop()}},a,this)}));function n(){return r.apply(this,arguments)}return n}()}]),t}(vo);function s4(e){var i=u4();return function(){var r=(0,oe.Z)(e),n;if(i){var a=(0,oe.Z)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return(0,Ze.Z)(this,n)}}function u4(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var l4=`
uniform float u_opacity: 1.0;
varying vec4 v_Color;
varying vec2 v_texture_data;


#pragma include "picking"

void main() {

  gl_FragColor = v_Color;
  gl_FragColor = filterColor(gl_FragColor);
}
`,c4=`precision highp float;

#define ambientRatio 0.5
#define diffuseRatio 0.3
#define specularRatio 0.2

attribute vec4 a_Color;
attribute vec3 a_Position;
attribute vec3 a_Normal;
attribute float a_Size;
uniform mat4 u_ModelMatrix;




varying vec4 v_Color;

#pragma include "projection"
#pragma include "light"
#pragma include "picking"

void main() {
 
  vec4 pos = vec4(a_Position.xy, a_Position.z * a_Size + (1.0 - a_Position.z) * extrusionBase, 1.0);
  float lightWeight = calc_lighting(pos);
  vec4 project_pos = project_position(pos);
  v_Color = a_Color;
  v_Color = vec4(v_Color.rgb * lightWeight, v_Color.w * opacity);

  gl_Position = project_common_position_to_clipspace_v2(vec4(project_pos.xyz, 1.0));

  setPickingColor(a_PickingColor);
}
`,f4=function(e){(0,ke.Z)(t,e);var i=s4(t);function t(){return(0,ue.Z)(this,t),i.apply(this,arguments)}return(0,me.Z)(t,[{key:"getUninforms",value:function(){return(0,X.Z)({},this.getStyleAttribute())}},{key:"initModels",value:function(){var r=(0,ur.Z)(nt().mark(function a(){return nt().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return f.abrupt("return",this.buildModels());case 1:case"end":return f.stop()}},a,this)}));function n(){return r.apply(this,arguments)}return n}()},{key:"buildModels",value:function(){var r=(0,ur.Z)(nt().mark(function a(){var u,f,g,x,I;return nt().wrap(function(B){for(;;)switch(B.prev=B.next){case 0:return u=this.getShaders(),f=u.frag,g=u.vert,x=u.type,B.next=3,this.layer.buildLayerModel({moduleName:x,vertexShader:g,fragmentShader:f,inject:this.getInject(),triangulation:c1});case 3:return I=B.sent,B.abrupt("return",[I]);case 5:case"end":return B.stop()}},a,this)}));function n(){return r.apply(this,arguments)}return n}()},{key:"getShaders",value:function(){return{frag:l4,vert:c4,type:"polygonExtrude"}}},{key:"clearModels",value:function(){var n;(n=this.texture)===null||n===void 0||n.destroy()}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"normal",type:mn.Attribute,descriptor:{name:"a_Normal",buffer:{usage:Ge.STATIC_DRAW,data:[],type:Ge.FLOAT},size:3,update:function(a,u,f,g,x){return x}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:mn.Attribute,descriptor:{name:"a_Size",buffer:{usage:Ge.DYNAMIC_DRAW,data:[],type:Ge.FLOAT},size:1,update:function(a){var u=a.size,f=u===void 0?10:u;return Array.isArray(f)?[f[0]]:[f]}}})}}]),t}(vo);function h4(e){var i=A4();return function(){var r=(0,oe.Z)(e),n;if(i){var a=(0,oe.Z)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return(0,Ze.Z)(this,n)}}function A4(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var p4=`varying vec4 v_color;
#pragma include "picking"

void main() {
  gl_FragColor = v_color;
  gl_FragColor = filterColor(gl_FragColor);
}
`,d4=`#pragma include "picking"
uniform float u_opacitylinear: 0.0;
uniform float u_dir: 1.0;
varying vec3 v_linear;
varying vec2 v_pos;
varying vec4 v_Color;


void main() {
   gl_FragColor = v_Color;
  if(u_opacitylinear > 0.0) {
    gl_FragColor.a *= u_dir == 1.0 ? 1.0 - length(v_pos - v_linear.xy)/v_linear.z : length(v_pos - v_linear.xy)/v_linear.z;
  }
  gl_FragColor = filterColor(gl_FragColor);
}
`,v4=`attribute vec4 a_Color;
attribute vec3 a_Position;

uniform mat4 u_ModelMatrix;

uniform float u_raisingHeight: 0.0;

varying vec4 v_Color;


#pragma include "projection"
#pragma include "picking"

uniform float u_opacitylinear: 0.0;

attribute vec3 a_linear;
varying vec3 v_linear;
varying vec2 v_pos;

void main() {
  if(u_opacitylinear > 0.0) {
    v_linear = a_linear;
    v_pos = a_Position.xy;
  }
  v_Color = vec4(a_Color.xyz, a_Color.w * opacity);
  vec4 project_pos = project_position(vec4(a_Position, 1.0));
  project_pos.z += u_raisingHeight;

  if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
    float mapboxZoomScale = 4.0/pow(2.0, 21.0 - u_Zoom);
    project_pos.z *= mapboxZoomScale;
    project_pos.z += u_raisingHeight * mapboxZoomScale;
  }

   gl_Position = project_common_position_to_clipspace_v2(vec4(project_pos.xyz, 1.0));
  setPickingColor(a_PickingColor);
}`,g4=`attribute vec4 a_Color;
attribute vec3 a_Position;

uniform mat4 u_ModelMatrix;


uniform float u_raisingHeight: 0.0;

varying vec4 v_color;


#pragma include "projection"
#pragma include "picking"

void main() {
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97

  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97

  v_color = vec4(a_Color.xyz, a_Color.w * opacity);
  vec4 project_pos = project_position(vec4(a_Position, 1.0));
  // gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));

  project_pos.z += u_raisingHeight;

  if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
    float mapboxZoomScale = 4.0/pow(2.0, 21.0 - u_Zoom);
    project_pos.z *= mapboxZoomScale;
    project_pos.z += u_raisingHeight * mapboxZoomScale;
  }

 
  gl_Position = project_common_position_to_clipspace_v2(vec4(project_pos.xyz, 1.0));

  setPickingColor(a_PickingColor);
}

`,m4=function(e){(0,ke.Z)(t,e);var i=h4(t);function t(){return(0,ue.Z)(this,t),i.apply(this,arguments)}return(0,me.Z)(t,[{key:"getUninforms",value:function(){var n=this.layer.getLayerConfig(),a=n.raisingHeight,u=a===void 0?0:a,f=n.opacityLinear,g=f===void 0?{enable:!1,dir:"in"}:f;return(0,X.Z)({u_raisingHeight:Number(u),u_opacitylinear:Number(g.enable),u_dir:g.dir==="in"?1:0},this.getStyleAttribute())}},{key:"initModels",value:function(){var r=(0,ur.Z)(nt().mark(function a(){return nt().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return f.abrupt("return",this.buildModels());case 1:case"end":return f.stop()}},a,this)}));function n(){return r.apply(this,arguments)}return n}()},{key:"buildModels",value:function(){var r=(0,ur.Z)(nt().mark(function a(){var u,f,g,x,I,O;return nt().wrap(function(W){for(;;)switch(W.prev=W.next){case 0:return u=this.getModelParams(),f=u.frag,g=u.vert,x=u.triangulation,I=u.type,this.layer.triangulation=x,W.next=4,this.layer.buildLayerModel({moduleName:I,vertexShader:g,fragmentShader:f,inject:this.getInject(),triangulation:x,primitive:Ge.TRIANGLES,depth:{enable:!1}});case 4:return O=W.sent,W.abrupt("return",[O]);case 6:case"end":return W.stop()}},a,this)}));function n(){return r.apply(this,arguments)}return n}()},{key:"registerBuiltinAttributes",value:function(){var n=this.layer.getLayerConfig(),a=n.opacityLinear,u=a===void 0?{enable:!1,dir:"in"}:a;u.enable&&this.styleAttributeService.registerStyleAttribute({name:"linear",type:mn.Attribute,descriptor:{name:"a_linear",buffer:{usage:Ge.STATIC_DRAW,data:[],type:Ge.FLOAT},size:3,update:function(g,x,I){return[I[3],I[4],I[5]]}}})}},{key:"getModelParams",value:function(){var n=this.layer.getLayerConfig(),a=n.opacityLinear,u=a===void 0?{enable:!1}:a;return u.enable?{frag:d4,vert:v4,type:"polygonLinear",triangulation:LS}:{frag:p4,vert:g4,type:"polygonFill",triangulation:Pc}}}]),t}(vo);function y4(e){var i=_4();return function(){var r=(0,oe.Z)(e),n;if(i){var a=(0,oe.Z)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return(0,Ze.Z)(this,n)}}function _4(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var x4=`
uniform float u_time: 0.0;
uniform float u_opacity: 1.0;

varying vec2 v_uv;

float coast2water_fadedepth = 0.10;
float large_waveheight      = .750; // change to adjust the "heavy" waves
float large_wavesize        = 3.4;  // factor to adjust the large wave size
float small_waveheight      = 0.6;  // change to adjust the small random waves
float small_wavesize        = 0.5;   // factor to ajust the small wave size
float water_softlight_fact  = 15.;  // range [1..200] (should be << smaller than glossy-fact)
float water_glossylight_fact= 120.; // range [1..200]
float particle_amount       = 70.;
// vec3 watercolor             = vec3(0.43, 0.60, 0.66); // 'transparent' low-water color (RGB)
// vec3 watercolor2            = vec3(0.06, 0.07, 0.11); // deep-water color (RGB, should be darker than the low-water color)
uniform vec4 u_watercolor;
uniform vec4 u_watercolor2;
vec3 water_specularcolor    = vec3(1.3, 1.3, 0.9);    // specular Color (RGB) of the water-highlights
#define light                 vec3(-0., sin(u_time*0.5)*.5 + .35, 2.8) // position of the sun

uniform sampler2D u_texture1;
uniform sampler2D u_texture2;
uniform sampler2D u_texture3;

  

float hash( float n ) {
    return fract(sin(n)*43758.5453123);
}

// 2d noise function
float noise1( in vec2 x ) {
  vec2 p  = floor(x);
  vec2 f  = smoothstep(0.0, 1.0, fract(x));
  float n = p.x + p.y*57.0;
  return mix(mix( hash(n+  0.0), hash(n+  1.0),f.x),
    mix( hash(n+ 57.0), hash(n+ 58.0),f.x),f.y);
}

float noise(vec2 p) {
    return texture2D(u_texture2,p*vec2(1./256.)).x;
}

vec4 highness(vec2 p) {
    vec4 t = texture2D(u_texture1,fract(p));
    float clipped = -2.0-smoothstep(3.,10.,t.a)*6.9-smoothstep(10.,100.,t.a)*89.9-smoothstep(0.,10000.,t.a)*10000.0;
    return clamp(t, 0.0,3.0)+clamp(t/3.0-1.0, 0.0,1.0)+clamp(t/16.0-1.0, 0.0,1.0);
}

float height_map( vec2 p ) {
    vec4 height=highness(p);
    /*
    height = -0.5+
        0.5*smoothstep(-100.,0.,-height)+
        2.75*smoothstep(0.,2.,height)+
        1.75*smoothstep(2.,4.,height)+
        2.75*smoothstep(4.,16.,height)+
        1.5*smoothstep(16.,1000.,height);
    */

    mat2 m = mat2( 0.9563*1.4,  -0.2924*1.4,  0.2924*1.4,  0.9563*1.4 );
    //p = p*6.;
    float f = 0.6000*noise1( p ); p = m*p*1.1*6.;
    f += 0.2500*noise( p ); p = m*p*1.32;
    f += 0.1666*noise( p ); p = m*p*1.11;
    f += 0.0834*noise( p ); p = m*p*1.12;
    f += 0.0634*noise( p ); p = m*p*1.13;
    f += 0.0444*noise( p ); p = m*p*1.14;
    f += 0.0274*noise( p ); p = m*p*1.15;
    f += 0.0134*noise( p ); p = m*p*1.16;
    f += 0.0104*noise( p ); p = m*p*1.17;
    f += 0.0084*noise( p );
    f = .25*f+dot(height,vec4(-.03125,-.125,.25,.25))*.5;
        const float FLAT_LEVEL = 0.92525;
        //f = f*0.25+height*0.75;
    if (f<FLAT_LEVEL)
        f = f;
    else
        f = pow((f-FLAT_LEVEL)/(1.-FLAT_LEVEL), 2.)*(1.-FLAT_LEVEL)*2.0+FLAT_LEVEL; // makes a smooth coast-increase
    return clamp(f, 0., 10.);
}

vec3 plasma_quintic( float x ) {
    x = clamp( x, 0.0, 1.0);
    vec4 x1 = vec4( 1.0, x, x * x, x * x * x ); // 1 x x2 x3
    vec4 x2 = x1 * x1.w * x; // x4 x5 x6 x7
    return vec3(
        dot( x1.xyzw, vec4( +0.063861086, +1.992659096, -1.023901152, -0.490832805 ) ) + dot( x2.xy, vec2( +1.308442123, -0.914547012 ) ),
        dot( x1.xyzw, vec4( +0.049718590, -0.791144343, +2.892305078, +0.811726816 ) ) + dot( x2.xy, vec2( -4.686502417, +2.717794514 ) ),
        dot( x1.xyzw, vec4( +0.513275779, +1.580255060, -5.164414457, +4.559573646 ) ) + dot( x2.xy, vec2( -1.916810682, +0.570638854 ) ) );
}

vec4 color(vec2 p){
    vec4 c1 = vec4(1.7,1.6,.9,1);
    vec4 c2 = vec4(.2,.94,.1,1);
    vec4 c3 = vec4(.3,.2,.0,1);
    vec4 c4 = vec4(.99,.99,1.6,1);
    vec4 v = highness(p);
    float los = smoothstep(0.1,1.1,v.b);
    float his = smoothstep(3.5,6.5,v.b);
    float ces = smoothstep(1.,5.,v.a);
    vec4 lo = mix(c1,c2,los);
    vec4 hi = mix(c3,c4,his);
    vec4 ce = mix(lo,hi,ces);

    return vec4(plasma_quintic(ces),1).ragb;
}

vec3 terrain_map( vec2 p )
{
  return color(p).rgb*0.75+0.25*vec3(0.7, .55, .4)+texture2D(u_texture3, fract(p*5.)).rgb*.5; // test-terrain is simply 'sandstone'
}

const mat2 m = mat2( 0.72, -1.60,  1.60,  0.72 );

float water_map( vec2 p, float height ) {
    vec2 p2 = p*large_wavesize;
    vec2 shift1 = 0.001*vec2( u_time*160.0*2.0, u_time*120.0*2.0 );
    vec2 shift2 = 0.001*vec2( u_time*190.0*2.0, -u_time*130.0*2.0 );

    // coarse crossing 'ocean' waves...
    float f = 0.6000*noise( p );
    f += 0.2500*noise( p*m );
    f += 0.1666*noise( p*m*m );
    float wave = sin(p2.x*0.622+p2.y*0.622+shift2.x*4.269)*large_waveheight*f*height*height ;

    p *= small_wavesize;
    f = 0.;
    float amp = 1.0, s = .5;
    for (int i=0; i<9; i++)
    { p = m*p*.947; f -= amp*abs(sin((noise( p+shift1*s )-.5)*2.)); amp = amp*.59; s*=-1.329; }
    
    return wave+f*small_waveheight;
}

float nautic(vec2 p) {
    p *= 18.;
    float f = 0.;
    float amp = 1.0, s = .5;
    for (int i=0; i<3; i++)
    { p = m*p*1.2; f += amp*abs(smoothstep(0., 1., noise( p+u_time*s ))-.5); amp = amp*.5; s*=-1.227; }
    return pow(1.-f, 5.);
}

float particles(vec2 p) {
    p *= 200.;
    float f = 0.;
    float amp = 1.0, s = 1.5;
    for (int i=0; i<3; i++)
    { p = m*p*1.2; f += amp*noise( p+u_time*s ); amp = amp*.5; s*=-1.227; }
    return pow(f*.35, 7.)*particle_amount;
}

float test_shadow( vec2 xy, float height) {
    vec3 r0 = vec3(xy, height);
    vec3 rd = normalize( light - r0 );
    
    float hit = 1.0;
    float t   = 0.001;
    for (int j=1; j<25; j++)
    {
        vec3 p = r0 + t*rd;
        float h = height_map( p.xy );
        float height_diff = p.z - h;
        if (height_diff<0.0)
        {
            return 0.0;
        }
        t += 0.01+height_diff*.02;
        hit = min(hit, 2.*height_diff/t); // soft shaddow   
    }
    return hit;
}

vec3 CalcTerrain(vec2 uv, float height) {
    vec3 col = terrain_map( uv );
    vec2 iResolution = vec2(512.);
    float h1 = height_map(uv-vec2(0., 0.5)/ iResolution.xy);
    float h2 = height_map(uv+vec2(0., 0.5)/ iResolution.xy);
    float h3 = height_map(uv-vec2(0.5, 0.)/ iResolution.xy);
    float h4 = height_map(uv+vec2(0.5, 0.)/ iResolution.xy);
    vec3 norm = normalize(vec3(h3-h4, h1-h2, 1.));
    vec3 r0 = vec3(uv, height);
    vec3 rd = normalize( light - r0 );
    float grad = dot(norm, rd);
    col *= grad+pow(grad, 8.);
    float terrainshade = test_shadow( uv, height );
    col = mix(col*.25, col, terrainshade);
    return col;
}


void main() {
  vec3 watercolor = u_watercolor.rgb;
  vec3 watercolor2 = u_watercolor2.rgb;
  vec2 uv = v_uv;
  float WATER_LEVEL = 0.84; // Water level (range: 0.0 - 2.0)
  float deepwater_fadedepth   = 0.4 + coast2water_fadedepth;
  float height = height_map( uv );
  vec3 col;

    float waveheight = clamp(WATER_LEVEL*3.-1.5, 0., 1.);
    float level = WATER_LEVEL + .2*water_map(uv*15. + vec2(u_time*.1), waveheight);
    if (height > level)
    {
        col = CalcTerrain(uv, height);
    }
    if (height <= level)
    {
        vec2 dif = vec2(.0, .01);
        vec2 pos = uv*15. + vec2(u_time*.01);
        float h1 = water_map(pos-dif,waveheight);
        float h2 = water_map(pos+dif,waveheight);
        float h3 = water_map(pos-dif.yx,waveheight);
        float h4 = water_map(pos+dif.yx,waveheight);
        vec3 normwater = normalize(vec3(h3-h4, h1-h2, .125)); // norm-vector of the 'bumpy' water-plane
        uv += normwater.xy*.002*(level-height);
        
        col = CalcTerrain(uv, height);

        float coastfade = clamp((level-height)/coast2water_fadedepth, 0., 1.);
        float coastfade2= clamp((level-height)/deepwater_fadedepth, 0., 1.);
        float intensity = col.r*.2126+col.g*.7152+col.b*.0722;
        watercolor = mix(watercolor*intensity, watercolor2, smoothstep(0., 1., coastfade2));

        vec3 r0 = vec3(uv, WATER_LEVEL);
        vec3 rd = normalize( light - r0 ); // ray-direction to the light from water-position
        float grad     = dot(normwater, rd); // dot-product of norm-vector and light-direction
        float specular = pow(grad, water_softlight_fact);  // used for soft highlights                          
        float specular2= pow(grad, water_glossylight_fact); // used for glossy highlights
        float gradpos  = dot(vec3(0., 0., 1.), rd);
        float specular1= smoothstep(0., 1., pow(gradpos, 5.));  // used for diffusity (some darker corona around light's specular reflections...)                          
        float watershade  = test_shadow( uv, level );
        watercolor *= 2.2+watershade;
        watercolor += (.2+.8*watershade) * ((grad-1.0)*.5+specular) * .25;
        watercolor /= (1.+specular1*1.25);
        watercolor += watershade*specular2*water_specularcolor;
        watercolor += watershade*coastfade*(1.-coastfade2)*(vec3(.5, .6, .7)*nautic(uv)+vec3(1., 1., 1.)*particles(uv));
        
        col = mix(col, watercolor, coastfade);
    }
    

  float opacity = u_opacity;
  gl_FragColor = vec4(col, opacity);  
}
`,E4=`attribute vec2 a_uv;
attribute vec3 a_Position;
uniform mat4 u_ModelMatrix;


varying vec2 v_uv;

#pragma include "projection"

void main() {
  v_uv = a_uv;

  vec4 project_pos = project_position(vec4(a_Position, 1.0));
  gl_Position = project_common_position_to_clipspace_v2(vec4(project_pos.xyz, 1.0));
}

`,b4=In.isNumber,S4=function(e){(0,ke.Z)(t,e);var i=y4(t);function t(){return(0,ue.Z)(this,t),i.apply(this,arguments)}return(0,me.Z)(t,[{key:"getUninforms",value:function(){var n=this.layer.getLayerConfig(),a=n.opacity,u=a===void 0?1:a,f=n.watercolor,g=f===void 0?"#6D99A8":f,x=n.watercolor2,I=x===void 0?"#0F121C":x;return{u_texture1:this.texture1,u_texture2:this.texture2,u_texture3:this.texture3,u_watercolor:Ni(g),u_watercolor2:Ni(I),u_opacity:b4(u)?u:1}}},{key:"getAnimateUniforms",value:function(){return{u_time:this.layer.getLayerAnimateTime()}}},{key:"initModels",value:function(){var r=(0,ur.Z)(nt().mark(function a(){return nt().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return this.loadTexture(),f.abrupt("return",this.buildModels());case 2:case"end":return f.stop()}},a,this)}));function n(){return r.apply(this,arguments)}return n}()},{key:"buildModels",value:function(){var r=(0,ur.Z)(nt().mark(function a(){var u;return nt().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return g.next=2,this.layer.buildLayerModel({moduleName:"polygonOcean",vertexShader:E4,fragmentShader:x4,triangulation:pg,primitive:Ge.TRIANGLES,depth:{enable:!1}});case 2:return u=g.sent,g.abrupt("return",[u]);case 4:case"end":return g.stop()}},a,this)}));function n(){return r.apply(this,arguments)}return n}()},{key:"clearModels",value:function(){var n,a,u;(n=this.texture1)===null||n===void 0||n.destroy(),(a=this.texture2)===null||a===void 0||a.destroy(),(u=this.texture3)===null||u===void 0||u.destroy()}},{key:"registerBuiltinAttributes",value:function(){var n=this.layer.getSource().extent,a=(0,vn.Z)(n,4),u=a[0],f=a[1],g=a[2],x=a[3],I=g-u,O=x-f;this.styleAttributeService.registerStyleAttribute({name:"oceanUv",type:mn.Attribute,descriptor:{name:"a_uv",buffer:{usage:Ge.STATIC_DRAW,data:[],type:Ge.FLOAT},size:2,update:function(W,he,ae,Se){var Fe=W.version==="GAODE2.x"?W.originCoordinates[0][Se]:ae,Qe=(0,vn.Z)(Fe,2),qe=Qe[0],yt=Qe[1];return[(qe-u)/I,(yt-f)/O]}}})}},{key:"loadTexture",value:function(){var n=this,a=this.rendererService.createTexture2D,u={height:0,width:0};this.texture1=a(u),this.texture2=a(u),this.texture3=a(u),f(function(x){n.texture1=g(x[0]),n.texture2=g(x[1]),n.texture3=g(x[2]),n.layerService.reRender()});function f(x){var I=0,O=[],B=["https://gw.alipayobjects.com/mdn/rms_816329/afts/img/A*EojwT4VzSiYAAAAAAAAAAAAAARQnAQ","https://gw.alipayobjects.com/mdn/rms_816329/afts/img/A*MJ22QbpuCzIAAAAAAAAAAAAAARQnAQ","https://gw.alipayobjects.com/mdn/rms_816329/afts/img/A*-z2HSIVDsHIAAAAAAAAAAAAAARQnAQ"];B.map(function(W){var he=new Image;he.crossOrigin="",he.src=W,O.push(he),he.onload=function(){I++,I===3&&x(O)}})}function g(x){return a({data:x,width:x.width,height:x.height,wrapS:Ge.MIRRORED_REPEAT,wrapT:Ge.MIRRORED_REPEAT,min:Ge.LINEAR,mag:Ge.LINEAR})}}}]),t}(vo);function C4(e){var i=w4();return function(){var r=(0,oe.Z)(e),n;if(i){var a=(0,oe.Z)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return(0,Ze.Z)(this,n)}}function w4(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var T4=`uniform sampler2D u_texture;
uniform float u_time: 0.0;
uniform float u_speed: 1.0;
uniform float u_opacity: 1.0;

varying vec4 v_Color;
varying vec2 v_uv;

float rand(vec2 n) { return 0.5 + 0.5 * fract(sin(dot(n.xy, vec2(12.9898, 78.233)))* 43758.5453); }

float water(vec3 p) {
  float t = u_time * u_speed;
  p.z += t * 2.; p.x += t * 2.;
  vec3 c1 = texture2D(u_texture, p.xz / 30.).xyz;
  p.z += t * 3.; p.x += t * 0.52;
  vec3 c2 = texture2D(u_texture, p.xz / 30.).xyz;
  p.z += t * 4.; p.x += t * 0.8;
  vec3 c3 = texture2D(u_texture, p.xz / 30.).xyz;
  c1 += c2 - c3;
  float z = (c1.x + c1.y + c1.z) / 3.;
  return p.y + z / 4.;
}

float map(vec3 p) {
  float d = 100.0;
  d = water(p);
  return d;
}

float intersect(vec3 ro, vec3 rd) {
  float d = 0.0;
  for (int i = 0; i <= 100; i++) {
    float h = map(ro + rd * d);
    if (h < 0.1) return  d;
    d += h;
  }
  return 0.0;
}

vec3 norm(vec3 p) {
  float eps = .1;
  return normalize(vec3(
    map(p + vec3(eps, 0, 0)) - map(p + vec3(-eps, 0, 0)),
    map(p + vec3(0, eps, 0)) - map(p + vec3(0, -eps, 0)),
    map(p + vec3(0, 0, eps)) - map(p + vec3(0, 0, -eps))
  ));
} 

float calSpc() {
  vec3 l1 = normalize(vec3(1, 1, 1));
  vec3 ro = vec3(-3, 20, -8);
  vec3 rc = vec3(0, 0, 0);
  vec3 ww = normalize(rc - ro);
  vec3 uu = normalize(cross(vec3(0,1,0), ww));
  vec3 vv = normalize(cross(rc - ro, uu));
  vec3 rd = normalize(uu * v_uv.x + vv * v_uv.y + ww);
  float d = intersect(ro, rd);
  vec3 p = ro + rd * d;
  vec3 n = norm(p);
  float spc = pow(max(0.0, dot(reflect(l1, n), rd)), 30.0);
  return spc;
}

void main() {
  float opacity = u_opacity;
  gl_FragColor = v_Color;
  gl_FragColor.a *= opacity;

  float spc = calSpc();
  gl_FragColor += spc * 0.4;
}
`,M4=`attribute vec4 a_Color;
attribute vec2 a_uv;
attribute vec3 a_Position;
uniform mat4 u_ModelMatrix;


varying vec4 v_Color;
varying vec2 v_uv;
uniform float u_opacity: 1.0;


#pragma include "projection"

void main() {
  v_uv = a_uv;

  v_Color = a_Color;
  vec4 project_pos = project_position(vec4(a_Position, 1.0));

  gl_Position = project_common_position_to_clipspace_v2(vec4(project_pos.xyz, 1.0));
}

`,I4=In.isNumber,L4=function(e){(0,ke.Z)(t,e);var i=C4(t);function t(){return(0,ue.Z)(this,t),i.apply(this,arguments)}return(0,me.Z)(t,[{key:"getUninforms",value:function(){var n=this.layer.getLayerConfig(),a=n.opacity,u=a===void 0?1:a,f=n.speed,g=f===void 0?.5:f;return{u_texture:this.texture,u_speed:g,u_opacity:I4(u)?u:1}}},{key:"getAnimateUniforms",value:function(){return{u_time:this.layer.getLayerAnimateTime()}}},{key:"initModels",value:function(){var r=(0,ur.Z)(nt().mark(function a(){return nt().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return this.loadTexture(),f.abrupt("return",this.buildModels());case 2:case"end":return f.stop()}},a,this)}));function n(){return r.apply(this,arguments)}return n}()},{key:"buildModels",value:function(){var r=(0,ur.Z)(nt().mark(function a(){var u;return nt().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return g.next=2,this.layer.buildLayerModel({moduleName:"polygonWater",vertexShader:M4,fragmentShader:T4,triangulation:pg,primitive:Ge.TRIANGLES,depth:{enable:!1}});case 2:return u=g.sent,g.abrupt("return",[u]);case 4:case"end":return g.stop()}},a,this)}));function n(){return r.apply(this,arguments)}return n}()},{key:"clearModels",value:function(){var n;(n=this.texture)===null||n===void 0||n.destroy()}},{key:"registerBuiltinAttributes",value:function(){var n=this.layer.getSource().extent,a=(0,vn.Z)(n,4),u=a[0],f=a[1],g=a[2],x=a[3],I=g-u,O=x-f;this.styleAttributeService.registerStyleAttribute({name:"waterUv",type:mn.Attribute,descriptor:{name:"a_uv",buffer:{usage:Ge.STATIC_DRAW,data:[],type:Ge.FLOAT},size:2,update:function(W,he,ae,Se){var Fe=W.version==="GAODE2.x"?W.originCoordinates[0][Se]:ae,Qe=(0,vn.Z)(Fe,2),qe=Qe[0],yt=Qe[1];return[(qe-u)/I,(yt-f)/O]}}})}},{key:"loadTexture",value:function(){var n=this,a=this.layer.getLayerConfig(),u=a.waterTexture,f=this.rendererService.createTexture2D;this.texture=f({height:0,width:0});var g=new Image;g.crossOrigin="",u?(console.warn("L7 recommend\uFF1Ahttps://gw.alipayobjects.com/mdn/rms_816329/afts/img/A*EojwT4VzSiYAAAAAAAAAAAAAARQnAQ"),g.src=u):g.src="https://gw.alipayobjects.com/mdn/rms_816329/afts/img/A*EojwT4VzSiYAAAAAAAAAAAAAARQnAQ",g.onload=function(){n.texture=f({data:g,width:g.width,height:g.height,wrapS:Ge.MIRRORED_REPEAT,wrapT:Ge.MIRRORED_REPEAT,min:Ge.LINEAR,mag:Ge.LINEAR}),n.layerService.reRender()}}}]),t}(vo),P4={fill:m4,line:h1,extrude:o4,text:P1,point_fill:g1,point_image:m1,point_normal:_1,point_extrude:d1,water:L4,ocean:S4,extrusion:f4},O4=P4;function R4(e){var i=k4();return function(){var r=(0,oe.Z)(e),n;if(i){var a=(0,oe.Z)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return(0,Ze.Z)(this,n)}}function k4(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var mg=function(e){(0,ke.Z)(t,e);var i=R4(t);function t(){var r;(0,ue.Z)(this,t);for(var n=arguments.length,a=new Array(n),u=0;u<n;u++)a[u]=arguments[u];return r=i.call.apply(i,[this].concat(a)),(0,Ce.Z)((0,bt.Z)(r),"type","PolygonLayer"),(0,Ce.Z)((0,bt.Z)(r),"enableShaderEncodeStyles",["opacity","extrusionBase","rotation","offsets","stroke"]),r}return(0,me.Z)(t,[{key:"buildModels",value:function(){var r=(0,ur.Z)(nt().mark(function a(){var u;return nt().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return u=this.getModelType(),this.layerModel=new O4[u](this),g.next=4,this.initLayerModels();case 4:case"end":return g.stop()}},a,this)}));function n(){return r.apply(this,arguments)}return n}()},{key:"getModelType",value:function(){var n,a=this.styleAttributeService.getLayerStyleAttribute("shape"),u=a==null||(n=a.scale)===null||n===void 0?void 0:n.field;return u==="fill"||!u?"fill":u==="extrude"?"extrude":u==="extrusion"?"extrusion":u==="water"?"water":u==="ocean"?"ocean":u==="line"?"line":this.getPointModelType()}},{key:"getPointModelType",value:function(){var n=this.getEncodedData(),a=this.getLayerConfig(),u=a.shape2d,f=a.shape3d,g=this.iconService.getIconMap(),x=n.find(function(O){return O.hasOwnProperty("shape")});if(x){var I=x.shape;return I==="dot"?"point_normal":(u==null?void 0:u.indexOf(I))!==-1?"point_fill":(f==null?void 0:f.indexOf(I))!==-1?"point_extrude":g.hasOwnProperty(I)?"point_image":"text"}else return"fill"}}]),t}(nA);function D4(e){var i=N4();return function(){var r=(0,oe.Z)(e),n;if(i){var a=(0,oe.Z)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return(0,Ze.Z)(this,n)}}function N4(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var F4=`uniform float u_opacity : 1.0;
uniform vec4 u_color;

void main() {
  gl_FragColor = u_color;
  gl_FragColor.a *= u_opacity;
}
`,B4=`attribute vec3 a_Position;
uniform mat4 u_ModelMatrix;


#pragma include "projection"

void main() {
  vec4 project_pos = project_position(vec4(a_Position, 1.0));

  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    gl_Position = u_Mvp * (vec4(project_pos.xyz, 1.0));
  } else {
    gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));
  }
}

`,Z4=In.isNumber,z4=function(e){(0,ke.Z)(t,e);var i=D4(t);function t(){return(0,ue.Z)(this,t),i.apply(this,arguments)}return(0,me.Z)(t,[{key:"getUninforms",value:function(){var n=this.layer.getLayerConfig(),a=n.opacity,u=a===void 0?1:a,f=n.color,g=f===void 0?"#000":f;return{u_opacity:Z4(u)?u:0,u_color:Ni(g)}}},{key:"initModels",value:function(){var r=(0,ur.Z)(nt().mark(function a(){return nt().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return f.abrupt("return",this.buildModels());case 1:case"end":return f.stop()}},a,this)}));function n(){return r.apply(this,arguments)}return n}()},{key:"buildModels",value:function(){var r=(0,ur.Z)(nt().mark(function a(){var u;return nt().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return g.next=2,this.layer.buildLayerModel({moduleName:"mask",vertexShader:B4,fragmentShader:F4,triangulation:pg,depth:{enable:!1},pick:!1});case 2:return u=g.sent,g.abrupt("return",[u]);case 4:case"end":return g.stop()}},a,this)}));function n(){return r.apply(this,arguments)}return n}()},{key:"clearModels",value:function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;n&&this.layerService.clear()}},{key:"registerBuiltinAttributes",value:function(){return""}}]),t}(vo),U4={fill:z4},G4=U4;function j4(e){var i=V4();return function(){var r=(0,oe.Z)(e),n;if(i){var a=(0,oe.Z)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return(0,Ze.Z)(this,n)}}function V4(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var R1=function(e){(0,ke.Z)(t,e);var i=j4(t);function t(){var r;(0,ue.Z)(this,t);for(var n=arguments.length,a=new Array(n),u=0;u<n;u++)a[u]=arguments[u];return r=i.call.apply(i,[this].concat(a)),(0,Ce.Z)((0,bt.Z)(r),"type","MaskLayer"),r}return(0,me.Z)(t,[{key:"buildModels",value:function(){var r=(0,ur.Z)(nt().mark(function a(){var u;return nt().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return u=this.getModelType(),this.layerModel=new G4[u](this),g.next=4,this.initLayerModels();case 4:case"end":return g.stop()}},a,this)}));function n(){return r.apply(this,arguments)}return n}()},{key:"getModelType",value:function(){return"fill"}}]),t}(nA),k1,D1,N1,F1,Zd,B1,Z1,H4=In.cloneDeep,$4=(k1=(0,dr.b2)(),D1=(0,dr.f3)(Xt.IMapService),N1=(0,dr.f3)(Xt.IFontService),k1(F1=(Zd=function(){function e(){(0,ue.Z)(this,e),Ki(this,"mapService",B1,this),Ki(this,"fontService",Z1,this)}return(0,me.Z)(e,[{key:"apply",value:function(t,r){var n=this,a=r.styleAttributeService;t.hooks.init.tapPromise("DataMappingPlugin",(0,ur.Z)(nt().mark(function u(){return nt().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:t.log(Ks.MappingStart,cs.INIT),n.generateMaping(t,{styleAttributeService:a}),t.log(Ks.MappingEnd,cs.INIT);case 3:case"end":return g.stop()}},u)}))),t.hooks.beforeRenderData.tapPromise("DataMappingPlugin",function(){var u=(0,ur.Z)(nt().mark(function f(g){var x;return nt().wrap(function(O){for(;;)switch(O.prev=O.next){case 0:if(g){O.next=2;break}return O.abrupt("return",g);case 2:return t.dataState.dataMappingNeedUpdate=!1,t.log(Ks.MappingStart,cs.UPDATE),x=n.generateMaping(t,{styleAttributeService:a}),t.log(Ks.MappingEnd,cs.UPDATE),O.abrupt("return",x);case 7:case"end":return O.stop()}},f)}));return function(f){return u.apply(this,arguments)}}()),t.hooks.beforeRender.tap("DataMappingPlugin",function(){var u=t.getSource();if(!(t.layerModelNeedUpdate||!u||!u.inited)){var f=a.getLayerStyleAttributes()||[],g=a.getLayerStyleAttribute("filter"),x=u.data.dataArray;if(!(Array.isArray(x)&&x.length===0)){var I=f.filter(function(W){return W.needRemapping}),O=x;if(g!=null&&g.needRemapping&&g!==null&&g!==void 0&&g.scale&&(O=x.filter(function(W){return n.applyAttributeMapping(g,W)[0]})),I.length){var B=n.mapping(t,I,O,t.getEncodedData());t.setEncodedData(B)}}}})}},{key:"generateMaping",value:function(t,r){var n=this,a=r.styleAttributeService,u=a.getLayerStyleAttributes()||[],f=a.getLayerStyleAttribute("filter"),g=t.getSource().data.dataArray,x=g;f!=null&&f.scale&&(x=g.filter(function(O){return n.applyAttributeMapping(f,O)[0]})),x=t.processData(x);var I=this.mapping(t,u,x,void 0);return t.setEncodedData(I),g.length===0&&t.encodeDataLength===0?!1:(t.emit("dataUpdate",null),!0)}},{key:"mapping",value:function(t,r,n,a){var u=this,f=t.getLayerConfig(),g=f.arrow,x=g===void 0?{enable:!1}:g,I=r.filter(function(B){return B.scale!==void 0}).filter(function(B){return B.name!=="filter"}),O=n.map(function(B,W){var he=a?a[W]:{},ae=(0,X.Z)({id:B._id,coordinates:B.coordinates},he);if(I.forEach(function(Qe){var qe=u.applyAttributeMapping(Qe,B);(Qe.name==="color"||Qe.name==="stroke")&&(qe=qe.map(function(yt){return Ni(yt)})),ae[Qe.name]=Array.isArray(qe)&&qe.length===1?qe[0]:qe,Qe.name==="shape"&&(ae.shape=u.fontService.getIconFontKey(ae[Qe.name]))}),x.enable&&ae.shape==="line"){var Se=ae.coordinates;if(t.arrowInsertCount<t.encodeDataLength){var Fe=u.getArrowPoints(Se[0],Se[1]);ae.coordinates.splice(1,0,Fe,Fe),t.arrowInsertCount++}}return ae});return r.forEach(function(B){B.needRemapping=!1}),this.adjustData2Amap2Coordinates(O,t),this.adjustData2SimpleCoordinates(O),O}},{key:"adjustData2Amap2Coordinates",value:function(t,r){var n=this;if(t.length>0&&this.mapService.version==="GAODE2.x"){var a=r.coordCenter||r.getSource().center;t.filter(function(u){return!u.originCoordinates}).map(function(u){u.version="GAODE2.x",u.originCoordinates=H4(u.coordinates),u.coordinates=n.mapService.coordToAMap2RelativeCoordinates(u.coordinates,a)})}}},{key:"adjustData2SimpleCoordinates",value:function(t){var r=this;t.length>0&&this.mapService.version==="SIMPLE"&&t.map(function(n){n.simpleCoordinate||(n.coordinates=r.unProjectCoordinates(n.coordinates),n.simpleCoordinate=!0)})}},{key:"unProjectCoordinates",value:function(t){var r=this;if(typeof t[0]=="number")return this.mapService.simpleMapCoord.unproject(t);if(t[0]&&t[0][0]instanceof Array){var n=[];return t.map(function(u){var f=[];u.map(function(g){f.push(r.mapService.simpleMapCoord.unproject(g))}),n.push(f)}),n}else{var a=[];return t.map(function(u){a.push(r.mapService.simpleMapCoord.unproject(u))}),a}}},{key:"applyAttributeMapping",value:function(t,r){var n;if(!t.scale)return[];var a=(t==null||(n=t.scale)===null||n===void 0?void 0:n.scalers)||[],u=[];a.forEach(function(g){var x,I=g.field;(r.hasOwnProperty(I)||((x=t.scale)===null||x===void 0?void 0:x.type)==="variable")&&u.push(r[I])});var f=t.mapping?t.mapping(u):[];return f}},{key:"getArrowPoints",value:function(t,r){var n=[r[0]-t[0],r[1]-t[1]],a=mc(n),u=[t[0]+a[0]*1e-4,t[1]+a[1]*1e-4];return u}}]),e}(),B1=Hi(Zd.prototype,"mapService",[D1],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Z1=Hi(Zd.prototype,"fontService",[N1],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Zd))||F1),z1,U1,W4=(z1=(0,dr.b2)(),z1(U1=function(){function e(){(0,ue.Z)(this,e)}return(0,me.Z)(e,[{key:"apply",value:function(t){var r=this;this.mapService=t.getContainer().get(Xt.IMapService),t.hooks.init.tapPromise("DataSourcePlugin",(0,ur.Z)(nt().mark(function n(){var a,u,f,g;return nt().wrap(function(I){for(;;)switch(I.prev=I.next){case 0:if(t.log(Ks.SourceInitStart,cs.INIT),a=t.getSource(),a||(u=t.sourceOption||t.defaultSourceConfig,f=u.data,g=u.options,a=new wy(f,g),t.setSource(a)),!a.inited){I.next=8;break}r.updateClusterData(t),t.log(Ks.SourceInitEnd,cs.INIT),I.next=10;break;case 8:return I.next=10,new Promise(function(O){a.on("update",function(B){B.type==="inited"&&(r.updateClusterData(t),t.log(Ks.SourceInitEnd,cs.INIT)),O(null)})});case 10:case"end":return I.stop()}},n)}))),t.hooks.beforeRenderData.tapPromise("DataSourcePlugin",(0,ur.Z)(nt().mark(function n(){var a,u,f;return nt().wrap(function(x){for(;;)switch(x.prev=x.next){case 0:return a=r.updateClusterData(t),u=t.dataState.dataSourceNeedUpdate,t.dataState.dataSourceNeedUpdate=!1,f=a||u,x.abrupt("return",f);case 5:case"end":return x.stop()}},n)})))}},{key:"updateClusterData",value:function(t){if(t.isTileLayer||t.tileLayer||!t.getSource())return!1;var r=t.getSource(),n=r.cluster,a=r.clusterOptions.zoom,u=a===void 0?0:a,f=this.mapService.getZoom()-1,g=t.dataState.dataSourceNeedUpdate;return n&&g&&r.updateClusterData(Math.floor(f)),n&&Math.abs(t.clusterZoom-f)>=1?(u!==Math.floor(f)&&r.updateClusterData(Math.floor(f)),t.clusterZoom=f,!0):!1}}]),e}())||U1),Qu=C(57965);function G1(e,i,t,r,n){var a=e*e,u=a*e;return((1-3*e+3*a-u)*i+(4-6*a+3*u)*t+(1+3*e+3*a-3*u)*r+u*n)/6}function Y4(e){var i=e.length-1;return function(t){var r=t<=0?t=0:t>=1?(t=1,i-1):Math.floor(t*i),n=e[r],a=e[r+1],u=r>0?e[r-1]:2*n-a,f=r<i-1?e[r+2]:2*a-n;return G1((t-r/i)*i,u,n,a,f)}}function X4(e){var i=e.length;return function(t){var r=Math.floor(((t%=1)<0?++t:t)*i),n=e[(r+i-1)%i],a=e[r%i],u=e[(r+1)%i],f=e[(r+2)%i];return G1((t-r/i)*i,n,a,u,f)}}function yg(e){return function(){return e}}function j1(e,i){return function(t){return e+t*i}}function Q4(e,i,t){return e=Math.pow(e,t),i=Math.pow(i,t)-e,t=1/t,function(r){return Math.pow(e+r*i,t)}}function pP(e,i){var t=i-e;return t?j1(e,t>180||t<-180?t-360*Math.round(t/360):t):constant(isNaN(e)?i:e)}function q4(e){return(e=+e)==1?V1:function(i,t){return t-i?Q4(i,t,e):yg(isNaN(i)?t:i)}}function V1(e,i){var t=i-e;return t?j1(e,t):yg(isNaN(e)?i:e)}var H1=function e(i){var t=q4(i);function r(n,a){var u=t((n=yu(n)).r,(a=yu(a)).r),f=t(n.g,a.g),g=t(n.b,a.b),x=V1(n.opacity,a.opacity);return function(I){return n.r=u(I),n.g=f(I),n.b=g(I),n.opacity=x(I),n+""}}return r.gamma=e,r}(1);function $1(e){return function(i){var t=i.length,r=new Array(t),n=new Array(t),a=new Array(t),u,f;for(u=0;u<t;++u)f=yu(i[u]),r[u]=f.r||0,n[u]=f.g||0,a[u]=f.b||0;return r=e(r),n=e(n),a=e(a),f.opacity=1,function(g){return f.r=r(g),f.g=n(g),f.b=a(g),f+""}}}var K4=$1(Y4),dP=$1(X4),Hc="$";function zd(){}zd.prototype=W1.prototype={constructor:zd,has:function(e){return Hc+e in this},get:function(e){return this[Hc+e]},set:function(e,i){return this[Hc+e]=i,this},remove:function(e){var i=Hc+e;return i in this&&delete this[i]},clear:function(){for(var e in this)e[0]===Hc&&delete this[e]},keys:function(){var e=[];for(var i in this)i[0]===Hc&&e.push(i.slice(1));return e},values:function(){var e=[];for(var i in this)i[0]===Hc&&e.push(this[i]);return e},entries:function(){var e=[];for(var i in this)i[0]===Hc&&e.push({key:i.slice(1),value:this[i]});return e},size:function(){var e=0;for(var i in this)i[0]===Hc&&++e;return e},empty:function(){for(var e in this)if(e[0]===Hc)return!1;return!0},each:function(e){for(var i in this)i[0]===Hc&&e(this[i],i.slice(1),this)}};function W1(e,i){var t=new zd;if(e instanceof zd)e.each(function(f,g){t.set(g,f)});else if(Array.isArray(e)){var r=-1,n=e.length,a;if(i==null)for(;++r<n;)t.set(r,e[r]);else for(;++r<n;)t.set(i(a=e[r],r,e),a)}else if(e)for(var u in e)t.set(u,e[u]);return t}var _g=W1;function vP(){var e=[],i=[],t,r,n;function a(f,g,x,I){if(g>=e.length)return t!=null&&f.sort(t),r!=null?r(f):f;for(var O=-1,B=f.length,W=e[g++],he,ae,Se=map(),Fe,Qe=x();++O<B;)(Fe=Se.get(he=W(ae=f[O])+""))?Fe.push(ae):Se.set(he,[ae]);return Se.each(function(qe,yt){I(Qe,yt,a(qe,g,x,I))}),Qe}function u(f,g){if(++g>e.length)return f;var x,I=i[g-1];return r!=null&&g>=e.length?x=f.entries():(x=[],f.each(function(O,B){x.push({key:B,values:u(O,g)})})),I!=null?x.sort(function(O,B){return I(O.key,B.key)}):x}return n={object:function(f){return a(f,0,J4,eT)},map:function(f){return a(f,0,Y1,X1)},entries:function(f){return u(a(f,0,Y1,X1),0)},key:function(f){return e.push(f),n},sortKeys:function(f){return i[e.length-1]=f,n},sortValues:function(f){return t=f,n},rollup:function(f){return r=f,n}}}function J4(){return{}}function eT(e,i,t){e[i]=t}function Y1(){return map()}function X1(e,i,t){e.set(i,t)}function Ud(){}var Ah=_g.prototype;Ud.prototype=tT.prototype={constructor:Ud,has:Ah.has,add:function(e){return e+="",this[Hc+e]=e,this},remove:Ah.remove,clear:Ah.clear,values:Ah.keys,size:Ah.size,empty:Ah.empty,each:Ah.each};function tT(e,i){var t=new Ud;if(e instanceof Ud)e.each(function(a){t.add(a)});else if(e){var r=-1,n=e.length;if(i==null)for(;++r<n;)t.add(e[r]);else for(;++r<n;)t.add(i(e[r],r,e))}return t}var gP=null,Q1=Array.prototype,q1=Q1.map,ph=Q1.slice;function F0(e,i){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(i).domain(e);break}return this}function K1(e,i){switch(arguments.length){case 0:break;case 1:this.interpolator(e);break;default:this.interpolator(i).domain(e);break}return this}var J1={name:"implicit"};function Gd(){var e=_g(),i=[],t=[],r=J1;function n(a){var u=a+"",f=e.get(u);if(!f){if(r!==J1)return r;e.set(u,f=i.push(a))}return t[(f-1)%t.length]}return n.domain=function(a){if(!arguments.length)return i.slice();i=[],e=_g();for(var u=-1,f=a.length,g,x;++u<f;)e.has(x=(g=a[u])+"")||e.set(x,i.push(g));return n},n.range=function(a){return arguments.length?(t=ph.call(a),n):t.slice()},n.unknown=function(a){return arguments.length?(r=a,n):r},n.copy=function(){return Gd(i,t).unknown(r)},F0.apply(n,arguments),n}function e_(){var e=ordinal().unknown(void 0),i=e.domain,t=e.range,r=[0,1],n,a,u=!1,f=0,g=0,x=.5;delete e.unknown;function I(){var O=i().length,B=r[1]<r[0],W=r[B-0],he=r[1-B];n=(he-W)/Math.max(1,O-f+g*2),u&&(n=Math.floor(n)),W+=(he-W-n*(O-f))*x,a=n*(1-f),u&&(W=Math.round(W),a=Math.round(a));var ae=sequence(O).map(function(Se){return W+n*Se});return t(B?ae.reverse():ae)}return e.domain=function(O){return arguments.length?(i(O),I()):i()},e.range=function(O){return arguments.length?(r=[+O[0],+O[1]],I()):r.slice()},e.rangeRound=function(O){return r=[+O[0],+O[1]],u=!0,I()},e.bandwidth=function(){return a},e.step=function(){return n},e.round=function(O){return arguments.length?(u=!!O,I()):u},e.padding=function(O){return arguments.length?(f=Math.min(1,g=+O),I()):f},e.paddingInner=function(O){return arguments.length?(f=Math.min(1,O),I()):f},e.paddingOuter=function(O){return arguments.length?(g=+O,I()):g},e.align=function(O){return arguments.length?(x=Math.max(0,Math.min(1,O)),I()):x},e.copy=function(){return e_(i(),r).round(u).paddingInner(f).paddingOuter(g).align(x)},initRange.apply(I(),arguments)}function t_(e){var i=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,delete e.paddingOuter,e.copy=function(){return t_(i())},e}function mP(){return t_(e_.apply(null,arguments).paddingInner(1))}function yP(e,i){return(isNumberArray(i)?numberArray:r_)(e,i)}function r_(e,i){var t=i?i.length:0,r=e?Math.min(t,e.length):0,n=new Array(r),a=new Array(t),u;for(u=0;u<r;++u)n[u]=bg(e[u],i[u]);for(;u<t;++u)a[u]=i[u];return function(f){for(u=0;u<r;++u)a[u]=n[u](f);return a}}function rT(e,i){var t=new Date;return e=+e,i=+i,function(r){return t.setTime(e*(1-r)+i*r),t}}function jd(e,i){return e=+e,i=+i,function(t){return e*(1-t)+i*t}}function nT(e,i){var t={},r={},n;(e===null||typeof e!="object")&&(e={}),(i===null||typeof i!="object")&&(i={});for(n in i)n in e?t[n]=bg(e[n],i[n]):r[n]=i[n];return function(a){for(n in t)r[n]=t[n](a);return r}}var xg=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Eg=new RegExp(xg.source,"g");function iT(e){return function(){return e}}function aT(e){return function(i){return e(i)+""}}function oT(e,i){var t=xg.lastIndex=Eg.lastIndex=0,r,n,a,u=-1,f=[],g=[];for(e=e+"",i=i+"";(r=xg.exec(e))&&(n=Eg.exec(i));)(a=n.index)>t&&(a=i.slice(t,a),f[u]?f[u]+=a:f[++u]=a),(r=r[0])===(n=n[0])?f[u]?f[u]+=n:f[++u]=n:(f[++u]=null,g.push({i:u,x:jd(r,n)})),t=Eg.lastIndex;return t<i.length&&(a=i.slice(t),f[u]?f[u]+=a:f[++u]=a),f.length<2?g[0]?aT(g[0].x):iT(i):(i=g.length,function(x){for(var I=0,O;I<i;++I)f[(O=g[I]).i]=O.x(x);return f.join("")})}function sT(e,i){i||(i=[]);var t=e?Math.min(i.length,e.length):0,r=i.slice(),n;return function(a){for(n=0;n<t;++n)r[n]=e[n]*(1-a)+i[n]*a;return r}}function uT(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function bg(e,i){var t=typeof i,r;return i==null||t==="boolean"?yg(i):(t==="number"?jd:t==="string"?(r=go(i))?(i=r,H1):oT:i instanceof go?H1:i instanceof Date?rT:uT(i)?sT:Array.isArray(i)?r_:typeof i.valueOf!="function"&&typeof i.toString!="function"||isNaN(i)?nT:jd)(e,i)}function lT(e,i){return e=+e,i=+i,function(t){return Math.round(e*(1-t)+i*t)}}function cT(e){return function(){return e}}function fT(e){return+e}var n_=[0,1];function fl(e){return e}function Sg(e,i){return(i-=e=+e)?function(t){return(t-e)/i}:cT(isNaN(i)?NaN:.5)}function i_(e){var i=e[0],t=e[e.length-1],r;return i>t&&(r=i,i=t,t=r),function(n){return Math.max(i,Math.min(t,n))}}function hT(e,i,t){var r=e[0],n=e[1],a=i[0],u=i[1];return n<r?(r=Sg(n,r),a=t(u,a)):(r=Sg(r,n),a=t(a,u)),function(f){return a(r(f))}}function AT(e,i,t){var r=Math.min(e.length,i.length)-1,n=new Array(r),a=new Array(r),u=-1;for(e[r]<e[0]&&(e=e.slice().reverse(),i=i.slice().reverse());++u<r;)n[u]=Sg(e[u],e[u+1]),a[u]=t(i[u],i[u+1]);return function(f){var g=(0,Qu.b4)(e,f,1,r)-1;return a[g](n[g](f))}}function Vd(e,i){return i.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function Cg(){var e=n_,i=n_,t=bg,r,n,a,u=fl,f,g,x;function I(){return f=Math.min(e.length,i.length)>2?AT:hT,g=x=null,O}function O(B){return isNaN(B=+B)?a:(g||(g=f(e.map(r),i,t)))(r(u(B)))}return O.invert=function(B){return u(n((x||(x=f(i,e.map(r),jd)))(B)))},O.domain=function(B){return arguments.length?(e=q1.call(B,fT),u===fl||(u=i_(e)),I()):e.slice()},O.range=function(B){return arguments.length?(i=ph.call(B),I()):i.slice()},O.rangeRound=function(B){return i=ph.call(B),t=lT,I()},O.clamp=function(B){return arguments.length?(u=B?i_(e):fl,O):u!==fl},O.interpolate=function(B){return arguments.length?(t=B,I()):t},O.unknown=function(B){return arguments.length?(a=B,O):a},function(B,W){return r=B,n=W,I()}}function a_(e,i){return Cg()(e,i)}var pT=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function Hd(e){if(!(i=pT.exec(e)))throw new Error("invalid format: "+e);var i;return new wg({fill:i[1],align:i[2],sign:i[3],symbol:i[4],zero:i[5],width:i[6],comma:i[7],precision:i[8]&&i[8].slice(1),trim:i[9],type:i[10]})}Hd.prototype=wg.prototype;function wg(e){this.fill=e.fill===void 0?" ":e.fill+"",this.align=e.align===void 0?">":e.align+"",this.sign=e.sign===void 0?"-":e.sign+"",this.symbol=e.symbol===void 0?"":e.symbol+"",this.zero=!!e.zero,this.width=e.width===void 0?void 0:+e.width,this.comma=!!e.comma,this.precision=e.precision===void 0?void 0:+e.precision,this.trim=!!e.trim,this.type=e.type===void 0?"":e.type+""}wg.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function dT(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)}function $d(e,i){if((t=(e=i?e.toExponential(i-1):e.toExponential()).indexOf("e"))<0)return null;var t,r=e.slice(0,t);return[r.length>1?r[0]+r.slice(2):r,+e.slice(t+1)]}function lA(e){return e=$d(Math.abs(e)),e?e[1]:NaN}function vT(e,i){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(lA(i)/3)))*3-lA(Math.abs(e)))}function gT(e,i){return function(t,r){for(var n=t.length,a=[],u=0,f=e[0],g=0;n>0&&f>0&&(g+f+1>r&&(f=Math.max(1,r-g)),a.push(t.substring(n-=f,n+f)),!((g+=f+1)>r));)f=e[u=(u+1)%e.length];return a.reverse().join(i)}}function mT(e){return function(i){return i.replace(/[0-9]/g,function(t){return e[+t]})}}function yT(e){e:for(var i=e.length,t=1,r=-1,n;t<i;++t)switch(e[t]){case".":r=n=t;break;case"0":r===0&&(r=t),n=t;break;default:if(!+e[t])break e;r>0&&(r=0);break}return r>0?e.slice(0,r)+e.slice(n+1):e}var o_;function _T(e,i){var t=$d(e,i);if(!t)return e+"";var r=t[0],n=t[1],a=n-(o_=Math.max(-8,Math.min(8,Math.floor(n/3)))*3)+1,u=r.length;return a===u?r:a>u?r+new Array(a-u+1).join("0"):a>0?r.slice(0,a)+"."+r.slice(a):"0."+new Array(1-a).join("0")+$d(e,Math.max(0,i+a-1))[0]}function s_(e,i){var t=$d(e,i);if(!t)return e+"";var r=t[0],n=t[1];return n<0?"0."+new Array(-n).join("0")+r:r.length>n+1?r.slice(0,n+1)+"."+r.slice(n+1):r+new Array(n-r.length+2).join("0")}var u_={"%":function(e,i){return(e*100).toFixed(i)},b:function(e){return Math.round(e).toString(2)},c:function(e){return e+""},d:dT,e:function(e,i){return e.toExponential(i)},f:function(e,i){return e.toFixed(i)},g:function(e,i){return e.toPrecision(i)},o:function(e){return Math.round(e).toString(8)},p:function(e,i){return s_(e*100,i)},r:s_,s:_T,X:function(e){return Math.round(e).toString(16).toUpperCase()},x:function(e){return Math.round(e).toString(16)}};function l_(e){return e}var c_=Array.prototype.map,f_=["y","z","a","f","p","n","\xB5","m","","k","M","G","T","P","E","Z","Y"];function xT(e){var i=e.grouping===void 0||e.thousands===void 0?l_:gT(c_.call(e.grouping,Number),e.thousands+""),t=e.currency===void 0?"":e.currency[0]+"",r=e.currency===void 0?"":e.currency[1]+"",n=e.decimal===void 0?".":e.decimal+"",a=e.numerals===void 0?l_:mT(c_.call(e.numerals,String)),u=e.percent===void 0?"%":e.percent+"",f=e.minus===void 0?"-":e.minus+"",g=e.nan===void 0?"NaN":e.nan+"";function x(O){O=Hd(O);var B=O.fill,W=O.align,he=O.sign,ae=O.symbol,Se=O.zero,Fe=O.width,Qe=O.comma,qe=O.precision,yt=O.trim,Et=O.type;Et==="n"?(Qe=!0,Et="g"):u_[Et]||(qe===void 0&&(qe=12),yt=!0,Et="g"),(Se||B==="0"&&W==="=")&&(Se=!0,B="0",W="=");var Ot=ae==="$"?t:ae==="#"&&/[boxX]/.test(Et)?"0"+Et.toLowerCase():"",jt=ae==="$"?r:/[%p]/.test(Et)?u:"",or=u_[Et],ar=/[defgprs%]/.test(Et);qe=qe===void 0?6:/[gprs]/.test(Et)?Math.max(1,Math.min(21,qe)):Math.max(0,Math.min(20,qe));function br(pr){var jr=Ot,nn=jt,yn,ma,Ho;if(Et==="c")nn=or(pr)+nn,pr="";else{pr=+pr;var Lo=pr<0||1/pr<0;if(pr=isNaN(pr)?g:or(Math.abs(pr),qe),yt&&(pr=yT(pr)),Lo&&+pr==0&&he!=="+"&&(Lo=!1),jr=(Lo?he==="("?he:f:he==="-"||he==="("?"":he)+jr,nn=(Et==="s"?f_[8+o_/3]:"")+nn+(Lo&&he==="("?")":""),ar){for(yn=-1,ma=pr.length;++yn<ma;)if(Ho=pr.charCodeAt(yn),48>Ho||Ho>57){nn=(Ho===46?n+pr.slice(yn+1):pr.slice(yn))+nn,pr=pr.slice(0,yn);break}}}Qe&&!Se&&(pr=i(pr,1/0));var Rs=jr.length+pr.length+nn.length,ks=Rs<Fe?new Array(Fe-Rs+1).join(B):"";switch(Qe&&Se&&(pr=i(ks+pr,ks.length?Fe-nn.length:1/0),ks=""),W){case"<":pr=jr+pr+nn+ks;break;case"=":pr=jr+ks+pr+nn;break;case"^":pr=ks.slice(0,Rs=ks.length>>1)+jr+pr+nn+ks.slice(Rs);break;default:pr=ks+jr+pr+nn;break}return a(pr)}return br.toString=function(){return O+""},br}function I(O,B){var W=x((O=Hd(O),O.type="f",O)),he=Math.max(-8,Math.min(8,Math.floor(lA(B)/3)))*3,ae=Math.pow(10,-he),Se=f_[8+he/3];return function(Fe){return W(ae*Fe)+Se}}return{format:x,formatPrefix:I}}var Wd,Tg,h_;ET({decimal:".",thousands:",",grouping:[3],currency:["$",""],minus:"-"});function ET(e){return Wd=xT(e),Tg=Wd.format,h_=Wd.formatPrefix,Wd}function bT(e,i){return e=Math.abs(e),i=Math.abs(i)-e,Math.max(0,lA(i)-lA(e))+1}function ST(e){return Math.max(0,-lA(Math.abs(e)))}function CT(e,i,t,r){var n=(0,Qu.ly)(e,i,t),a;switch(r=Hd(r==null?",f":r),r.type){case"s":{var u=Math.max(Math.abs(e),Math.abs(i));return r.precision==null&&!isNaN(a=vT(n,u))&&(r.precision=a),h_(r,u)}case"":case"e":case"g":case"p":case"r":{r.precision==null&&!isNaN(a=bT(n,Math.max(Math.abs(e),Math.abs(i))))&&(r.precision=a-(r.type==="e"));break}case"f":case"%":{r.precision==null&&!isNaN(a=ST(n))&&(r.precision=a-(r.type==="%")*2);break}}return Tg(r)}function vp(e){var i=e.domain;return e.ticks=function(t){var r=i();return(0,Qu.sd)(r[0],r[r.length-1],t==null?10:t)},e.tickFormat=function(t,r){var n=i();return CT(n[0],n[n.length-1],t==null?10:t,r)},e.nice=function(t){t==null&&(t=10);var r=i(),n=0,a=r.length-1,u=r[n],f=r[a],g;return f<u&&(g=u,u=f,f=g,g=n,n=a,a=g),g=(0,Qu.G9)(u,f,t),g>0?(u=Math.floor(u/g)*g,f=Math.ceil(f/g)*g,g=(0,Qu.G9)(u,f,t)):g<0&&(u=Math.ceil(u*g)/g,f=Math.floor(f*g)/g,g=(0,Qu.G9)(u,f,t)),g>0?(r[n]=Math.floor(u/g)*g,r[a]=Math.ceil(f/g)*g,i(r)):g<0&&(r[n]=Math.ceil(u*g)/g,r[a]=Math.floor(f*g)/g,i(r)),e},e}function A_(){var e=a_(fl,fl);return e.copy=function(){return Vd(e,A_())},F0.apply(e,arguments),vp(e)}function wT(e){var i;function t(r){return isNaN(r=+r)?i:r}return t.invert=t,t.domain=t.range=function(r){return arguments.length?(e=map.call(r,number),t):e.slice()},t.unknown=function(r){return arguments.length?(i=r,t):i},t.copy=function(){return wT(e).unknown(i)},e=arguments.length?map.call(e,number):[0,1],linearish(t)}function p_(e,i){e=e.slice();var t=0,r=e.length-1,n=e[t],a=e[r],u;return a<n&&(u=t,t=r,r=u,u=n,n=a,a=u),e[t]=i.floor(n),e[r]=i.ceil(a),e}function d_(e){return Math.log(e)}function v_(e){return Math.exp(e)}function TT(e){return-Math.log(-e)}function MT(e){return-Math.exp(-e)}function IT(e){return isFinite(e)?+("1e"+e):e<0?0:e}function LT(e){return e===10?IT:e===Math.E?Math.exp:function(i){return Math.pow(e,i)}}function PT(e){return e===Math.E?Math.log:e===10&&Math.log10||e===2&&Math.log2||(e=Math.log(e),function(i){return Math.log(i)/e})}function g_(e){return function(i){return-e(-i)}}function OT(e){var i=e(d_,v_),t=i.domain,r=10,n,a;function u(){return n=PT(r),a=LT(r),t()[0]<0?(n=g_(n),a=g_(a),e(TT,MT)):e(d_,v_),i}return i.base=function(f){return arguments.length?(r=+f,u()):r},i.domain=function(f){return arguments.length?(t(f),u()):t()},i.ticks=function(f){var g=t(),x=g[0],I=g[g.length-1],O;(O=I<x)&&(B=x,x=I,I=B);var B=n(x),W=n(I),he,ae,Se,Fe=f==null?10:+f,Qe=[];if(!(r%1)&&W-B<Fe){if(B=Math.round(B)-1,W=Math.round(W)+1,x>0){for(;B<W;++B)for(ae=1,he=a(B);ae<r;++ae)if(Se=he*ae,!(Se<x)){if(Se>I)break;Qe.push(Se)}}else for(;B<W;++B)for(ae=r-1,he=a(B);ae>=1;--ae)if(Se=he*ae,!(Se<x)){if(Se>I)break;Qe.push(Se)}}else Qe=(0,Qu.sd)(B,W,Math.min(W-B,Fe)).map(a);return O?Qe.reverse():Qe},i.tickFormat=function(f,g){if(g==null&&(g=r===10?".0e":","),typeof g!="function"&&(g=Tg(g)),f===1/0)return g;f==null&&(f=10);var x=Math.max(1,r*f/i.ticks().length);return function(I){var O=I/a(Math.round(n(I)));return O*r<r-.5&&(O*=r),O<=x?g(I):""}},i.nice=function(){return t(p_(t(),{floor:function(f){return a(Math.floor(n(f)))},ceil:function(f){return a(Math.ceil(n(f)))}}))},i}function m_(){var e=OT(Cg()).domain([1,10]);return e.copy=function(){return Vd(e,m_()).base(e.base())},F0.apply(e,arguments),e}function y_(e){return function(i){return Math.sign(i)*Math.log1p(Math.abs(i/e))}}function __(e){return function(i){return Math.sign(i)*Math.expm1(Math.abs(i))*e}}function RT(e){var i=1,t=e(y_(i),__(i));return t.constant=function(r){return arguments.length?e(y_(i=+r),__(i)):i},linearish(t)}function kT(){var e=RT(transformer());return e.copy=function(){return copy(e,kT()).constant(e.constant())},initRange.apply(e,arguments)}function x_(e){return function(i){return i<0?-Math.pow(-i,e):Math.pow(i,e)}}function DT(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function NT(e){return e<0?-e*e:e*e}function FT(e){var i=e(fl,fl),t=1;function r(){return t===1?e(fl,fl):t===.5?e(DT,NT):e(x_(t),x_(1/t))}return i.exponent=function(n){return arguments.length?(t=+n,r()):t},vp(i)}function Mg(){var e=FT(Cg());return e.copy=function(){return Vd(e,Mg()).exponent(e.exponent())},F0.apply(e,arguments),e}function _P(){return Mg.apply(null,arguments).exponent(.5)}function E_(){var e=[],i=[],t=[],r;function n(){var u=0,f=Math.max(1,i.length);for(t=new Array(f-1);++u<f;)t[u-1]=(0,Qu.VR)(e,u/f);return a}function a(u){return isNaN(u=+u)?r:i[(0,Qu.b4)(t,u)]}return a.invertExtent=function(u){var f=i.indexOf(u);return f<0?[NaN,NaN]:[f>0?t[f-1]:e[0],f<t.length?t[f]:e[e.length-1]]},a.domain=function(u){if(!arguments.length)return e.slice();e=[];for(var f=0,g=u.length,x;f<g;++f)x=u[f],x!=null&&!isNaN(x=+x)&&e.push(x);return e.sort(Qu.j2),n()},a.range=function(u){return arguments.length?(i=ph.call(u),n()):i.slice()},a.unknown=function(u){return arguments.length?(r=u,a):r},a.quantiles=function(){return t.slice()},a.copy=function(){return E_().domain(e).range(i).unknown(r)},F0.apply(a,arguments)}function b_(){var e=0,i=1,t=1,r=[.5],n=[0,1],a;function u(g){return g<=g?n[(0,Qu.b4)(r,g,0,t)]:a}function f(){var g=-1;for(r=new Array(t);++g<t;)r[g]=((g+1)*i-(g-t)*e)/(t+1);return u}return u.domain=function(g){return arguments.length?(e=+g[0],i=+g[1],f()):[e,i]},u.range=function(g){return arguments.length?(t=(n=ph.call(g)).length-1,f()):n.slice()},u.invertExtent=function(g){var x=n.indexOf(g);return x<0?[NaN,NaN]:x<1?[e,r[0]]:x>=t?[r[t-1],i]:[r[x-1],r[x]]},u.unknown=function(g){return arguments.length&&(a=g),u},u.thresholds=function(){return r.slice()},u.copy=function(){return b_().domain([e,i]).range(n).unknown(a)},F0.apply(vp(u),arguments)}function S_(){var e=[.5],i=[0,1],t,r=1;function n(a){return a<=a?i[(0,Qu.b4)(e,a,0,r)]:t}return n.domain=function(a){return arguments.length?(e=ph.call(a),r=Math.min(e.length,i.length-1),n):e.slice()},n.range=function(a){return arguments.length?(i=ph.call(a),r=Math.min(e.length,i.length-1),n):i.slice()},n.invertExtent=function(a){var u=i.indexOf(a);return[e[u-1],e[u]]},n.unknown=function(a){return arguments.length?(t=a,n):t},n.copy=function(){return S_().domain(e).range(i).unknown(t)},F0.apply(n,arguments)}var Ig=new Date,Lg=new Date;function Il(e,i,t,r){function n(a){return e(a=arguments.length===0?new Date:new Date(+a)),a}return n.floor=function(a){return e(a=new Date(+a)),a},n.ceil=function(a){return e(a=new Date(a-1)),i(a,1),e(a),a},n.round=function(a){var u=n(a),f=n.ceil(a);return a-u<f-a?u:f},n.offset=function(a,u){return i(a=new Date(+a),u==null?1:Math.floor(u)),a},n.range=function(a,u,f){var g=[],x;if(a=n.ceil(a),f=f==null?1:Math.floor(f),!(a<u)||!(f>0))return g;do g.push(x=new Date(+a)),i(a,f),e(a);while(x<a&&a<u);return g},n.filter=function(a){return Il(function(u){if(u>=u)for(;e(u),!a(u);)u.setTime(u-1)},function(u,f){if(u>=u)if(f<0)for(;++f<=0;)for(;i(u,-1),!a(u););else for(;--f>=0;)for(;i(u,1),!a(u););})},t&&(n.count=function(a,u){return Ig.setTime(+a),Lg.setTime(+u),e(Ig),e(Lg),Math.floor(t(Ig,Lg))},n.every=function(a){return a=Math.floor(a),!isFinite(a)||!(a>0)?null:a>1?n.filter(r?function(u){return r(u)%a===0}:function(u){return n.count(0,u)%a===0}):n}),n}var Pg=Il(function(e){e.setMonth(0,1),e.setHours(0,0,0,0)},function(e,i){e.setFullYear(e.getFullYear()+i)},function(e,i){return i.getFullYear()-e.getFullYear()},function(e){return e.getFullYear()});Pg.every=function(e){return!isFinite(e=Math.floor(e))||!(e>0)?null:Il(function(i){i.setFullYear(Math.floor(i.getFullYear()/e)*e),i.setMonth(0,1),i.setHours(0,0,0,0)},function(i,t){i.setFullYear(i.getFullYear()+t*e)})};var cA=Pg,xP=Pg.range,C_=Il(function(e){e.setDate(1),e.setHours(0,0,0,0)},function(e,i){e.setMonth(e.getMonth()+i)},function(e,i){return i.getMonth()-e.getMonth()+(i.getFullYear()-e.getFullYear())*12},function(e){return e.getMonth()}),BT=C_,EP=C_.range,Yd=1e3,gp=6e4,w_=36e5,T_=864e5,M_=6048e5;function dh(e){return Il(function(i){i.setDate(i.getDate()-(i.getDay()+7-e)%7),i.setHours(0,0,0,0)},function(i,t){i.setDate(i.getDate()+t*7)},function(i,t){return(t-i-(t.getTimezoneOffset()-i.getTimezoneOffset())*gp)/M_})}var Og=dh(0),Xd=dh(1),ZT=dh(2),zT=dh(3),fA=dh(4),UT=dh(5),GT=dh(6),bP=Og.range,SP=Xd.range,CP=ZT.range,wP=zT.range,TP=fA.range,MP=UT.range,IP=GT.range,I_=Il(function(e){e.setHours(0,0,0,0)},function(e,i){e.setDate(e.getDate()+i)},function(e,i){return(i-e-(i.getTimezoneOffset()-e.getTimezoneOffset())*gp)/T_},function(e){return e.getDate()-1}),Rg=I_,LP=I_.range,L_=Il(function(e){e.setTime(e-e.getMilliseconds()-e.getSeconds()*Yd-e.getMinutes()*gp)},function(e,i){e.setTime(+e+i*w_)},function(e,i){return(i-e)/w_},function(e){return e.getHours()}),jT=L_,PP=L_.range,P_=Il(function(e){e.setTime(e-e.getMilliseconds()-e.getSeconds()*Yd)},function(e,i){e.setTime(+e+i*gp)},function(e,i){return(i-e)/gp},function(e){return e.getMinutes()}),VT=P_,OP=P_.range,O_=Il(function(e){e.setTime(e-e.getMilliseconds())},function(e,i){e.setTime(+e+i*Yd)},function(e,i){return(i-e)/Yd},function(e){return e.getUTCSeconds()}),HT=O_,RP=O_.range,Qd=Il(function(){},function(e,i){e.setTime(+e+i)},function(e,i){return i-e});Qd.every=function(e){return e=Math.floor(e),!isFinite(e)||!(e>0)?null:e>1?Il(function(i){i.setTime(Math.floor(i/e)*e)},function(i,t){i.setTime(+i+t*e)},function(i,t){return(t-i)/e}):Qd};var $T=Qd,kP=Qd.range;function vh(e){return Il(function(i){i.setUTCDate(i.getUTCDate()-(i.getUTCDay()+7-e)%7),i.setUTCHours(0,0,0,0)},function(i,t){i.setUTCDate(i.getUTCDate()+t*7)},function(i,t){return(t-i)/M_})}var R_=vh(0),qd=vh(1),WT=vh(2),YT=vh(3),hA=vh(4),XT=vh(5),QT=vh(6),DP=R_.range,NP=qd.range,FP=WT.range,BP=YT.range,ZP=hA.range,zP=XT.range,UP=QT.range,k_=Il(function(e){e.setUTCHours(0,0,0,0)},function(e,i){e.setUTCDate(e.getUTCDate()+i)},function(e,i){return(i-e)/T_},function(e){return e.getUTCDate()-1}),D_=k_,GP=k_.range,kg=Il(function(e){e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},function(e,i){e.setUTCFullYear(e.getUTCFullYear()+i)},function(e,i){return i.getUTCFullYear()-e.getUTCFullYear()},function(e){return e.getUTCFullYear()});kg.every=function(e){return!isFinite(e=Math.floor(e))||!(e>0)?null:Il(function(i){i.setUTCFullYear(Math.floor(i.getUTCFullYear()/e)*e),i.setUTCMonth(0,1),i.setUTCHours(0,0,0,0)},function(i,t){i.setUTCFullYear(i.getUTCFullYear()+t*e)})};var mp=kg,jP=kg.range;function Dg(e){if(0<=e.y&&e.y<100){var i=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return i.setFullYear(e.y),i}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function Ng(e){if(0<=e.y&&e.y<100){var i=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return i.setUTCFullYear(e.y),i}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function yp(e,i,t){return{y:e,m:i,d:t,H:0,M:0,S:0,L:0}}function qT(e){var i=e.dateTime,t=e.date,r=e.time,n=e.periods,a=e.days,u=e.shortDays,f=e.months,g=e.shortMonths,x=_p(n),I=xp(n),O=_p(a),B=xp(a),W=_p(u),he=xp(u),ae=_p(f),Se=xp(f),Fe=_p(g),Qe=xp(g),qe={a:Lo,A:Rs,b:ks,B:Wc,c:null,d:U_,e:U_,f:_M,g:LM,G:OM,H:gM,I:mM,j:yM,L:G_,m:xM,M:EM,p:Rp,q:gA,Q:Y_,s:X_,S:bM,u:SM,U:CM,V:wM,w:TM,W:MM,x:null,X:null,y:IM,Y:PM,Z:RM,"%":W_},yt={a:Wg,A:G6,b:j6,B:V6,c:null,d:V_,e:V_,f:FM,g:WM,G:XM,H:kM,I:DM,j:NM,L:H_,m:BM,M:ZM,p:H6,q:$6,Q:Y_,s:X_,S:zM,u:UM,U:GM,V:jM,w:VM,W:HM,x:null,X:null,y:$M,Y:YM,Z:QM,"%":W_},Et={a:br,A:pr,b:jr,B:nn,c:yn,d:Z_,e:Z_,f:AM,g:B_,G:F_,H:z_,I:z_,j:lM,L:hM,m:uM,M:cM,p:ar,q:sM,Q:dM,s:vM,S:fM,u:rM,U:nM,V:iM,w:tM,W:aM,x:ma,X:Ho,y:B_,Y:F_,Z:oM,"%":pM};qe.x=Ot(t,qe),qe.X=Ot(r,qe),qe.c=Ot(i,qe),yt.x=Ot(t,yt),yt.X=Ot(r,yt),yt.c=Ot(i,yt);function Ot(ei,Ba){return function(to){var fn=[],Kl=-1,$o=0,pc=ei.length,dc,_h,yx;for(to instanceof Date||(to=new Date(+to));++Kl<pc;)ei.charCodeAt(Kl)===37&&(fn.push(ei.slice($o,Kl)),(_h=N_[dc=ei.charAt(++Kl)])!=null?dc=ei.charAt(++Kl):_h=dc==="e"?" ":"0",(yx=Ba[dc])&&(dc=yx(to,_h)),fn.push(dc),$o=Kl+1);return fn.push(ei.slice($o,Kl)),fn.join("")}}function jt(ei,Ba){return function(to){var fn=yp(1900,void 0,1),Kl=or(fn,ei,to+="",0),$o,pc;if(Kl!=to.length)return null;if("Q"in fn)return new Date(fn.Q);if("s"in fn)return new Date(fn.s*1e3+("L"in fn?fn.L:0));if(Ba&&!("Z"in fn)&&(fn.Z=0),"p"in fn&&(fn.H=fn.H%12+fn.p*12),fn.m===void 0&&(fn.m="q"in fn?fn.q:0),"V"in fn){if(fn.V<1||fn.V>53)return null;"w"in fn||(fn.w=1),"Z"in fn?($o=Ng(yp(fn.y,0,1)),pc=$o.getUTCDay(),$o=pc>4||pc===0?qd.ceil($o):qd($o),$o=D_.offset($o,(fn.V-1)*7),fn.y=$o.getUTCFullYear(),fn.m=$o.getUTCMonth(),fn.d=$o.getUTCDate()+(fn.w+6)%7):($o=Dg(yp(fn.y,0,1)),pc=$o.getDay(),$o=pc>4||pc===0?Xd.ceil($o):Xd($o),$o=Rg.offset($o,(fn.V-1)*7),fn.y=$o.getFullYear(),fn.m=$o.getMonth(),fn.d=$o.getDate()+(fn.w+6)%7)}else("W"in fn||"U"in fn)&&("w"in fn||(fn.w="u"in fn?fn.u%7:"W"in fn?1:0),pc="Z"in fn?Ng(yp(fn.y,0,1)).getUTCDay():Dg(yp(fn.y,0,1)).getDay(),fn.m=0,fn.d="W"in fn?(fn.w+6)%7+fn.W*7-(pc+5)%7:fn.w+fn.U*7-(pc+6)%7);return"Z"in fn?(fn.H+=fn.Z/100|0,fn.M+=fn.Z%100,Ng(fn)):Dg(fn)}}function or(ei,Ba,to,fn){for(var Kl=0,$o=Ba.length,pc=to.length,dc,_h;Kl<$o;){if(fn>=pc)return-1;if(dc=Ba.charCodeAt(Kl++),dc===37){if(dc=Ba.charAt(Kl++),_h=Et[dc in N_?Ba.charAt(Kl++):dc],!_h||(fn=_h(ei,to,fn))<0)return-1}else if(dc!=to.charCodeAt(fn++))return-1}return fn}function ar(ei,Ba,to){var fn=x.exec(Ba.slice(to));return fn?(ei.p=I[fn[0].toLowerCase()],to+fn[0].length):-1}function br(ei,Ba,to){var fn=W.exec(Ba.slice(to));return fn?(ei.w=he[fn[0].toLowerCase()],to+fn[0].length):-1}function pr(ei,Ba,to){var fn=O.exec(Ba.slice(to));return fn?(ei.w=B[fn[0].toLowerCase()],to+fn[0].length):-1}function jr(ei,Ba,to){var fn=Fe.exec(Ba.slice(to));return fn?(ei.m=Qe[fn[0].toLowerCase()],to+fn[0].length):-1}function nn(ei,Ba,to){var fn=ae.exec(Ba.slice(to));return fn?(ei.m=Se[fn[0].toLowerCase()],to+fn[0].length):-1}function yn(ei,Ba,to){return or(ei,i,Ba,to)}function ma(ei,Ba,to){return or(ei,t,Ba,to)}function Ho(ei,Ba,to){return or(ei,r,Ba,to)}function Lo(ei){return u[ei.getDay()]}function Rs(ei){return a[ei.getDay()]}function ks(ei){return g[ei.getMonth()]}function Wc(ei){return f[ei.getMonth()]}function Rp(ei){return n[+(ei.getHours()>=12)]}function gA(ei){return 1+~~(ei.getMonth()/3)}function Wg(ei){return u[ei.getUTCDay()]}function G6(ei){return a[ei.getUTCDay()]}function j6(ei){return g[ei.getUTCMonth()]}function V6(ei){return f[ei.getUTCMonth()]}function H6(ei){return n[+(ei.getUTCHours()>=12)]}function $6(ei){return 1+~~(ei.getUTCMonth()/3)}return{format:function(ei){var Ba=Ot(ei+="",qe);return Ba.toString=function(){return ei},Ba},parse:function(ei){var Ba=jt(ei+="",!1);return Ba.toString=function(){return ei},Ba},utcFormat:function(ei){var Ba=Ot(ei+="",yt);return Ba.toString=function(){return ei},Ba},utcParse:function(ei){var Ba=jt(ei+="",!0);return Ba.toString=function(){return ei},Ba}}}var N_={"-":"",_:" ",0:"0"},Pu=/^\s*\d+/,KT=/^%/,JT=/[\\^$*+?|[\]().{}]/g;function eo(e,i,t){var r=e<0?"-":"",n=(r?-e:e)+"",a=n.length;return r+(a<t?new Array(t-a+1).join(i)+n:n)}function eM(e){return e.replace(JT,"\\$&")}function _p(e){return new RegExp("^(?:"+e.map(eM).join("|")+")","i")}function xp(e){for(var i={},t=-1,r=e.length;++t<r;)i[e[t].toLowerCase()]=t;return i}function tM(e,i,t){var r=Pu.exec(i.slice(t,t+1));return r?(e.w=+r[0],t+r[0].length):-1}function rM(e,i,t){var r=Pu.exec(i.slice(t,t+1));return r?(e.u=+r[0],t+r[0].length):-1}function nM(e,i,t){var r=Pu.exec(i.slice(t,t+2));return r?(e.U=+r[0],t+r[0].length):-1}function iM(e,i,t){var r=Pu.exec(i.slice(t,t+2));return r?(e.V=+r[0],t+r[0].length):-1}function aM(e,i,t){var r=Pu.exec(i.slice(t,t+2));return r?(e.W=+r[0],t+r[0].length):-1}function F_(e,i,t){var r=Pu.exec(i.slice(t,t+4));return r?(e.y=+r[0],t+r[0].length):-1}function B_(e,i,t){var r=Pu.exec(i.slice(t,t+2));return r?(e.y=+r[0]+(+r[0]>68?1900:2e3),t+r[0].length):-1}function oM(e,i,t){var r=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(i.slice(t,t+6));return r?(e.Z=r[1]?0:-(r[2]+(r[3]||"00")),t+r[0].length):-1}function sM(e,i,t){var r=Pu.exec(i.slice(t,t+1));return r?(e.q=r[0]*3-3,t+r[0].length):-1}function uM(e,i,t){var r=Pu.exec(i.slice(t,t+2));return r?(e.m=r[0]-1,t+r[0].length):-1}function Z_(e,i,t){var r=Pu.exec(i.slice(t,t+2));return r?(e.d=+r[0],t+r[0].length):-1}function lM(e,i,t){var r=Pu.exec(i.slice(t,t+3));return r?(e.m=0,e.d=+r[0],t+r[0].length):-1}function z_(e,i,t){var r=Pu.exec(i.slice(t,t+2));return r?(e.H=+r[0],t+r[0].length):-1}function cM(e,i,t){var r=Pu.exec(i.slice(t,t+2));return r?(e.M=+r[0],t+r[0].length):-1}function fM(e,i,t){var r=Pu.exec(i.slice(t,t+2));return r?(e.S=+r[0],t+r[0].length):-1}function hM(e,i,t){var r=Pu.exec(i.slice(t,t+3));return r?(e.L=+r[0],t+r[0].length):-1}function AM(e,i,t){var r=Pu.exec(i.slice(t,t+6));return r?(e.L=Math.floor(r[0]/1e3),t+r[0].length):-1}function pM(e,i,t){var r=KT.exec(i.slice(t,t+1));return r?t+r[0].length:-1}function dM(e,i,t){var r=Pu.exec(i.slice(t));return r?(e.Q=+r[0],t+r[0].length):-1}function vM(e,i,t){var r=Pu.exec(i.slice(t));return r?(e.s=+r[0],t+r[0].length):-1}function U_(e,i){return eo(e.getDate(),i,2)}function gM(e,i){return eo(e.getHours(),i,2)}function mM(e,i){return eo(e.getHours()%12||12,i,2)}function yM(e,i){return eo(1+Rg.count(cA(e),e),i,3)}function G_(e,i){return eo(e.getMilliseconds(),i,3)}function _M(e,i){return G_(e,i)+"000"}function xM(e,i){return eo(e.getMonth()+1,i,2)}function EM(e,i){return eo(e.getMinutes(),i,2)}function bM(e,i){return eo(e.getSeconds(),i,2)}function SM(e){var i=e.getDay();return i===0?7:i}function CM(e,i){return eo(Og.count(cA(e)-1,e),i,2)}function j_(e){var i=e.getDay();return i>=4||i===0?fA(e):fA.ceil(e)}function wM(e,i){return e=j_(e),eo(fA.count(cA(e),e)+(cA(e).getDay()===4),i,2)}function TM(e){return e.getDay()}function MM(e,i){return eo(Xd.count(cA(e)-1,e),i,2)}function IM(e,i){return eo(e.getFullYear()%100,i,2)}function LM(e,i){return e=j_(e),eo(e.getFullYear()%100,i,2)}function PM(e,i){return eo(e.getFullYear()%1e4,i,4)}function OM(e,i){var t=e.getDay();return e=t>=4||t===0?fA(e):fA.ceil(e),eo(e.getFullYear()%1e4,i,4)}function RM(e){var i=e.getTimezoneOffset();return(i>0?"-":(i*=-1,"+"))+eo(i/60|0,"0",2)+eo(i%60,"0",2)}function V_(e,i){return eo(e.getUTCDate(),i,2)}function kM(e,i){return eo(e.getUTCHours(),i,2)}function DM(e,i){return eo(e.getUTCHours()%12||12,i,2)}function NM(e,i){return eo(1+D_.count(mp(e),e),i,3)}function H_(e,i){return eo(e.getUTCMilliseconds(),i,3)}function FM(e,i){return H_(e,i)+"000"}function BM(e,i){return eo(e.getUTCMonth()+1,i,2)}function ZM(e,i){return eo(e.getUTCMinutes(),i,2)}function zM(e,i){return eo(e.getUTCSeconds(),i,2)}function UM(e){var i=e.getUTCDay();return i===0?7:i}function GM(e,i){return eo(R_.count(mp(e)-1,e),i,2)}function $_(e){var i=e.getUTCDay();return i>=4||i===0?hA(e):hA.ceil(e)}function jM(e,i){return e=$_(e),eo(hA.count(mp(e),e)+(mp(e).getUTCDay()===4),i,2)}function VM(e){return e.getUTCDay()}function HM(e,i){return eo(qd.count(mp(e)-1,e),i,2)}function $M(e,i){return eo(e.getUTCFullYear()%100,i,2)}function WM(e,i){return e=$_(e),eo(e.getUTCFullYear()%100,i,2)}function YM(e,i){return eo(e.getUTCFullYear()%1e4,i,4)}function XM(e,i){var t=e.getUTCDay();return e=t>=4||t===0?hA(e):hA.ceil(e),eo(e.getUTCFullYear()%1e4,i,4)}function QM(){return"+0000"}function W_(){return"%"}function Y_(e){return+e}function X_(e){return Math.floor(+e/1e3)}var AA,Q_,qM,KM,JM;eI({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function eI(e){return AA=qT(e),Q_=AA.format,qM=AA.parse,KM=AA.utcFormat,JM=AA.utcParse,AA}var Ep=1e3,bp=Ep*60,Sp=bp*60,Cp=Sp*24,tI=Cp*7,q_=Cp*30,Fg=Cp*365;function rI(e){return new Date(e)}function nI(e){return e instanceof Date?+e:+new Date(+e)}function K_(e,i,t,r,n,a,u,f,g){var x=a_(fl,fl),I=x.invert,O=x.domain,B=g(".%L"),W=g(":%S"),he=g("%I:%M"),ae=g("%I %p"),Se=g("%a %d"),Fe=g("%b %d"),Qe=g("%B"),qe=g("%Y"),yt=[[u,1,Ep],[u,5,5*Ep],[u,15,15*Ep],[u,30,30*Ep],[a,1,bp],[a,5,5*bp],[a,15,15*bp],[a,30,30*bp],[n,1,Sp],[n,3,3*Sp],[n,6,6*Sp],[n,12,12*Sp],[r,1,Cp],[r,2,2*Cp],[t,1,tI],[i,1,q_],[i,3,3*q_],[e,1,Fg]];function Et(jt){return(u(jt)<jt?B:a(jt)<jt?W:n(jt)<jt?he:r(jt)<jt?ae:i(jt)<jt?t(jt)<jt?Se:Fe:e(jt)<jt?Qe:qe)(jt)}function Ot(jt,or,ar,br){if(jt==null&&(jt=10),typeof jt=="number"){var pr=Math.abs(ar-or)/jt,jr=(0,Qu.YF)(function(nn){return nn[2]}).right(yt,pr);jr===yt.length?(br=(0,Qu.ly)(or/Fg,ar/Fg,jt),jt=e):jr?(jr=yt[pr/yt[jr-1][2]<yt[jr][2]/pr?jr-1:jr],br=jr[1],jt=jr[0]):(br=Math.max((0,Qu.ly)(or,ar,jt),1),jt=f)}return br==null?jt:jt.every(br)}return x.invert=function(jt){return new Date(I(jt))},x.domain=function(jt){return arguments.length?O(q1.call(jt,nI)):O().map(rI)},x.ticks=function(jt,or){var ar=O(),br=ar[0],pr=ar[ar.length-1],jr=pr<br,nn;return jr&&(nn=br,br=pr,pr=nn),nn=Ot(jt,br,pr,or),nn=nn?nn.range(br,pr+1):[],jr?nn.reverse():nn},x.tickFormat=function(jt,or){return or==null?Et:g(or)},x.nice=function(jt,or){var ar=O();return(jt=Ot(jt,ar[0],ar[ar.length-1],or))?O(p_(ar,jt)):x},x.copy=function(){return Vd(x,K_(e,i,t,r,n,a,u,f,g))},x}function iI(){return F0.apply(K_(cA,BT,Og,Rg,jT,VT,HT,$T,Q_).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function VP(){return initRange.apply(calendar(utcYear,utcMonth,utcWeek,utcDay,utcHour,utcMinute,utcSecond,utcMillisecond,utcFormat).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function Kd(){var e=0,i=1,t,r,n,a,u=fl,f=!1,g;function x(I){return isNaN(I=+I)?g:u(n===0?.5:(I=(a(I)-t)*n,f?Math.max(0,Math.min(1,I)):I))}return x.domain=function(I){return arguments.length?(t=a(e=+I[0]),r=a(i=+I[1]),n=t===r?0:1/(r-t),x):[e,i]},x.clamp=function(I){return arguments.length?(f=!!I,x):f},x.interpolator=function(I){return arguments.length?(u=I,x):u},x.unknown=function(I){return arguments.length?(g=I,x):g},function(I){return a=I,t=I(e),r=I(i),n=t===r?0:1/(r-t),x}}function wp(e,i){return i.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function J_(){var e=vp(Kd()(fl));return e.copy=function(){return wp(e,J_())},K1.apply(e,arguments)}function aI(){var e=loggish(Kd()).domain([1,10]);return e.copy=function(){return wp(e,aI()).base(e.base())},initInterpolator.apply(e,arguments)}function oI(){var e=symlogish(Kd());return e.copy=function(){return wp(e,oI()).constant(e.constant())},initInterpolator.apply(e,arguments)}function e2(){var e=powish(Kd());return e.copy=function(){return wp(e,e2()).exponent(e.exponent())},initInterpolator.apply(e,arguments)}function HP(){return e2.apply(null,arguments).exponent(.5)}function sI(){var e=[],i=identity;function t(r){if(!isNaN(r=+r))return i((bisect(e,r)-1)/(e.length-1))}return t.domain=function(r){if(!arguments.length)return e.slice();e=[];for(var n=0,a=r.length,u;n<a;++n)u=r[n],u!=null&&!isNaN(u=+u)&&e.push(u);return e.sort(ascending),t},t.interpolator=function(r){return arguments.length?(i=r,t):i},t.copy=function(){return sI(i).domain(e)},initInterpolator.apply(t,arguments)}function Jd(){var e=0,i=.5,t=1,r,n,a,u,f,g=fl,x,I=!1,O;function B(W){return isNaN(W=+W)?O:(W=.5+((W=+x(W))-n)*(W<n?u:f),g(I?Math.max(0,Math.min(1,W)):W))}return B.domain=function(W){return arguments.length?(r=x(e=+W[0]),n=x(i=+W[1]),a=x(t=+W[2]),u=r===n?0:.5/(n-r),f=n===a?0:.5/(a-n),B):[e,i,t]},B.clamp=function(W){return arguments.length?(I=!!W,B):I},B.interpolator=function(W){return arguments.length?(g=W,B):g},B.unknown=function(W){return arguments.length?(O=W,B):O},function(W){return x=W,r=W(e),n=W(i),a=W(t),u=r===n?0:.5/(n-r),f=n===a?0:.5/(a-n),B}}function t2(){var e=vp(Jd()(fl));return e.copy=function(){return wp(e,t2())},K1.apply(e,arguments)}function uI(){var e=loggish(Jd()).domain([.1,1,10]);return e.copy=function(){return copy(e,uI()).base(e.base())},initInterpolator.apply(e,arguments)}function lI(){var e=symlogish(Jd());return e.copy=function(){return copy(e,lI()).constant(e.constant())},initInterpolator.apply(e,arguments)}function r2(){var e=powish(Jd());return e.copy=function(){return copy(e,r2()).exponent(e.exponent())},initInterpolator.apply(e,arguments)}function $P(){return r2.apply(null,arguments).exponent(.5)}function n2(e){var i,t=[];function r(n){return n==null?i:n}return r.invert=r,r.domain=r.range=function(n){return n?(t=n,n):t},r.unknown=function(n){return n?(i=n,n):i},r.copy=function(){return n2(e).unknown(i)},r}var Ac,i2,a2,Bg=In.isNil,cI=In.isString,fI=In.uniq,hI=/^(?:(?!0000)[0-9]{4}([-/.]+)(?:(?:0?[1-9]|1[0-2])\1(?:0?[1-9]|1[0-9]|2[0-8])|(?:0?[13-9]|1[0-2])\1(?:29|30)|(?:0?[13578]|1[02])\1(?:31))|(?:[0-9]{2}(?:0[48]|[2468][048]|[13579][26])|(?:0[48]|[2468][048]|[13579][26])00)([-/.]?)0?2\2(?:29))(\s+([01]|([01][0-9]|2[0-3])):([0-9]|[0-5][0-9]):([0-9]|[0-5][0-9]))?$/,AI=(Ac={},(0,Ce.Z)(Ac,so.LINEAR,A_),(0,Ce.Z)(Ac,so.POWER,Mg),(0,Ce.Z)(Ac,so.LOG,m_),(0,Ce.Z)(Ac,so.IDENTITY,n2),(0,Ce.Z)(Ac,so.SEQUENTIAL,J_),(0,Ce.Z)(Ac,so.TIME,iI),(0,Ce.Z)(Ac,so.QUANTILE,E_),(0,Ce.Z)(Ac,so.QUANTIZE,b_),(0,Ce.Z)(Ac,so.THRESHOLD,S_),(0,Ce.Z)(Ac,so.CAT,Gd),(0,Ce.Z)(Ac,so.DIVERGING,t2),Ac),pI=(i2=(0,dr.b2)(),i2(a2=function(){function e(){(0,ue.Z)(this,e),(0,Ce.Z)(this,"scaleOptions",{})}return(0,me.Z)(e,[{key:"apply",value:function(t,r){var n=this,a=r.styleAttributeService;t.hooks.init.tapPromise("FeatureScalePlugin",(0,ur.Z)(nt().mark(function u(){var f,g,x;return nt().wrap(function(O){for(;;)switch(O.prev=O.next){case 0:if(t.log(Ks.ScaleInitStart,cs.INIT),n.scaleOptions=t.getScaleOptions(),g=a.getLayerStyleAttributes(),x=(f=t.getSource())===null||f===void 0?void 0:f.data.dataArray,!(Array.isArray(x)&&x.length===0)){O.next=8;break}return O.abrupt("return");case 8:n.caculateScalesForAttributes(g||[],x);case 9:t.log(Ks.ScaleInitEnd,cs.INIT);case 10:case"end":return O.stop()}},u)}))),t.hooks.beforeRenderData.tapPromise("FeatureScalePlugin",function(){var u=(0,ur.Z)(nt().mark(function f(g){var x,I;return nt().wrap(function(B){for(;;)switch(B.prev=B.next){case 0:if(g){B.next=2;break}return B.abrupt("return",g);case 2:if(t.log(Ks.ScaleInitStart,cs.UPDATE),n.scaleOptions=t.getScaleOptions(),x=a.getLayerStyleAttributes(),I=t.getSource().data.dataArray,!(Array.isArray(I)&&I.length===0)){B.next=8;break}return B.abrupt("return",!0);case 8:return n.caculateScalesForAttributes(x||[],I),t.log(Ks.ScaleInitEnd,cs.UPDATE),t.layerModelNeedUpdate=!0,B.abrupt("return",!0);case 12:case"end":return B.stop()}},f)}));return function(f){return u.apply(this,arguments)}}()),t.hooks.beforeRender.tap("FeatureScalePlugin",function(){if(!t.layerModelNeedUpdate){n.scaleOptions=t.getScaleOptions();var u=a.getLayerStyleAttributes(),f=t.getSource().data.dataArray;if(!(Array.isArray(f)&&f.length===0)&&u){var g=u.filter(function(x){return x.needRescale});g.length&&n.caculateScalesForAttributes(g,f)}}})}},{key:"isNumber",value:function(t){return!isNaN(parseFloat(t))&&isFinite(t)}},{key:"caculateScalesForAttributes",value:function(t,r){var n=this;t.forEach(function(a){if(a.scale){var u=a.scale,f=a.scale.field;u.names=n.parseFields(Bg(f)?[]:f);var g=[];u.names.forEach(function(x){var I;g.push(n.createScale(x,a.name,(I=a.scale)===null||I===void 0?void 0:I.values,r))}),g.some(function(x){return x.type===tA.VARIABLE})?(u.type=tA.VARIABLE,g.forEach(function(x){if(!u.callback&&u.values!=="text"){var I;switch((I=x.option)===null||I===void 0?void 0:I.type){case so.LOG:case so.LINEAR:case so.POWER:if(u.values&&u.values.length>2){var O=x.scale.ticks(u.values.length);x.scale.domain(O)}u.values?x.scale.range(u.values):x.scale.range(x.option.domain);break;case so.QUANTILE:case so.QUANTIZE:case so.THRESHOLD:x.scale.range(u.values);break;case so.IDENTITY:break;case so.CAT:u.values?x.scale.range(u.values):x.scale.range(x.option.domain);break;case so.DIVERGING:case so.SEQUENTIAL:x.scale.interpolator(K4(u.values));break}}if(u.values==="text"){var B;x.scale.range((B=x.option)===null||B===void 0?void 0:B.domain)}})):(u.type=tA.CONSTANT,u.defaultValues=g.map(function(x,I){return x.scale(u.names[I])})),u.scalers=g.map(function(x){return{field:x.field,func:x.scale,option:x.option}}),a.needRescale=!1}})}},{key:"parseFields",value:function(t){return Array.isArray(t)?t:cI(t)?t.split("*"):[t]}},{key:"createScale",value:function(t,r,n,a){var u,f,g=this.scaleOptions[r]&&((u=this.scaleOptions[r])===null||u===void 0?void 0:u.field)===t?this.scaleOptions[r]:this.scaleOptions[t],x={field:t,scale:void 0,type:tA.VARIABLE,option:g};if(!a||!a.length)return g&&g.type?x.scale=this.createDefaultScale(g):(x.scale=Gd([t]),x.type=tA.CONSTANT),x;var I=(f=a.find(function(W){return!Bg(W[t])}))===null||f===void 0?void 0:f[t];if(this.isNumber(t)||Bg(I)&&!g)x.scale=Gd([t]),x.type=tA.CONSTANT;else{var O=g&&g.type||this.getDefaultType(I);n==="text"&&(O=so.CAT),n===void 0&&(O=so.IDENTITY);var B=this.createScaleConfig(O,t,g,a);x.scale=this.createDefaultScale(B),x.option=B}return x}},{key:"getDefaultType",value:function(t){var r=so.LINEAR;return typeof t=="string"&&(r=hI.test(t)?so.TIME:so.CAT),r}},{key:"createScaleConfig",value:function(t,r,n,a){var u={type:t},f=(a==null?void 0:a.map(function(I){return I[r]}))||[];if(n!=null&&n.domain)u.domain=n==null?void 0:n.domain;else if(t===so.CAT||t===so.IDENTITY)u.domain=fI(f);else if(t===so.QUANTILE)u.domain=f;else if(t===so.DIVERGING){var g=(0,Qu.We)(f),x=(n==null?void 0:n.neutral)!==void 0?n==null?void 0:n.neutral:(g[0]+g[1])/2;u.domain=[g[0],x,g[1]]}else u.domain=(0,Qu.We)(f);return(0,X.Z)((0,X.Z)({},u),n)}},{key:"createDefaultScale",value:function(t){var r=t.type,n=t.domain,a=t.unknown,u=t.clamp,f=t.nice,g=AI[r]();return n&&g.domain&&g.domain(n),a&&g.unknown(a),u!==void 0&&g.clamp&&g.clamp(u),f!==void 0&&g.nice&&g.nice(f),g}}]),e}())||a2),o2,s2,dI=(o2=(0,dr.b2)(),o2(s2=function(){function e(){(0,ue.Z)(this,e)}return(0,me.Z)(e,[{key:"apply",value:function(t){t.hooks.beforeRender.tap("LayerAnimateStylePlugin",function(){var r=t.animateStatus;r&&t.models.forEach(function(n){n.addUniforms((0,X.Z)({},t.layerModel.getAnimateUniforms()))})})}}]),e}())||s2),u2,l2,vI=(u2=(0,dr.b2)(),u2(l2=function(){function e(){(0,ue.Z)(this,e)}return(0,me.Z)(e,[{key:"apply",value:function(t){t.hooks.afterInit.tap("LayerMaskPlugin",function(){var r=t.getLayerConfig(),n=r.maskLayers,a=r.enableMask;if(!t.tileLayer&&n&&n.length>0){var u;(u=t.masks).push.apply(u,(0,Mr.Z)(n)),t.updateLayerConfig({mask:a})}})}}]),e}())||l2),gI=function(){function e(i){var t=i.rendererService,r=i.layerService,n=i.parent;(0,ue.Z)(this,e),(0,Ce.Z)(this,"tileResource",new Map),(0,Ce.Z)(this,"layerTiles",[]),this.rendererService=t,this.layerService=r,this.parent=n}return(0,me.Z)(e,[{key:"tiles",get:function(){return this.layerTiles}},{key:"hasTile",value:function(t){return this.layerTiles.some(function(r){return r.key===t})}},{key:"addTile",value:function(t){this.layerTiles.push(t)}},{key:"getTile",value:function(t){return this.layerTiles.find(function(r){return r.key===t})}},{key:"getVisibleTileBylngLat",value:function(t){return this.layerTiles.find(function(r){return r.isLoaded&&r.visible&&r.lnglatInBounds(t)})}},{key:"removeTile",value:function(t){var r=this.layerTiles.findIndex(function(a){return a.key===t}),n=this.layerTiles.splice(r,1);n[0]&&n[0].destroy()}},{key:"updateTileVisible",value:function(t){var r=this.getTile(t.key);if(t.isVisible)if(t.parent){var n=this.isChildrenLoaded(t.parent);r==null||r.updateVisible(n)}else r==null||r.updateVisible(!0);else if(t.parent){var a=this.isChildrenLoaded(t.parent);r==null||r.updateVisible(!a)}else r==null||r.updateVisible(!1)}},{key:"isParentLoaded",value:function(t){var r=t.parent;if(!r)return!0;var n=this.getTile(r==null?void 0:r.key);return!!(n!=null&&n.isLoaded)}},{key:"isChildrenLoaded",value:function(t){var r=this,n=t==null?void 0:t.children;return n.length===0?!0:n.every(function(a){var u=r.getTile(a==null?void 0:a.key);return u?(u==null?void 0:u.isLoaded)===!0:!0})}},{key:"render",value:function(){var i=(0,ur.Z)(nt().mark(function r(){var n=this,a,u;return nt().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return a=this.getRenderLayers(),u=a.map(function(){var x=(0,ur.Z)(nt().mark(function I(O){return nt().wrap(function(W){for(;;)switch(W.prev=W.next){case 0:return W.next=2,n.layerService.renderTileLayer(O);case 2:case"end":return W.stop()}},I)}));return function(I){return x.apply(this,arguments)}}()),g.next=4,Promise.all(u);case 4:case"end":return g.stop()}},r,this)}));function t(){return i.apply(this,arguments)}return t}()},{key:"getRenderLayers",value:function(){var t=this.layerTiles.filter(function(n){return n.visible&&n.isLoaded}),r=[];return t.map(function(n){return r.push.apply(r,(0,Mr.Z)(n.getLayers()))}),r}},{key:"getLayers",value:function(){var t=this.layerTiles.filter(function(n){return n.isLoaded}),r=[];return t.map(function(n){return r.push.apply(r,(0,Mr.Z)(n.getLayers()))}),r}},{key:"getTiles",value:function(){return this.layerTiles}},{key:"destroy",value:function(){this.layerTiles.forEach(function(t){return t.destroy()}),this.tileResource.clear()}}]),e}(),mI=C(35486),yI=function(){function e(){(0,ue.Z)(this,e)}return(0,me.Z)(e,[{key:"getCombineFeature",value:function(t){var r=null,n=t[0];return t.map(function(a){var u=Ts.yu(a.coordinates);r===null?r=u:r=(0,mI.Z)(r,u)}),n&&(r.properties=(0,X.Z)({},n)),r}}]),e}(),Tp="select",Mp="active",_I=function(){function e(i){var t=i.layerService,r=i.tileLayerService,n=i.parent;(0,ue.Z)(this,e),(0,Ce.Z)(this,"tilePickID",new Map),this.layerService=t,this.tileLayerService=r,this.parent=n,this.tileSourceService=new yI}return(0,me.Z)(e,[{key:"pickRender",value:function(t){var r=this.tileLayerService.getVisibleTileBylngLat(t.lngLat);if(r){var n=r.getMainLayer();n==null||n.layerPickService.pickRender(t)}}},{key:"pick",value:function(t,r){var n=this.parent.getContainer(),a=n.get(Xt.IPickingService);if(t.type==="RasterLayer"){var u=this.tileLayerService.getVisibleTileBylngLat(r.lngLat);if(u&&u.getMainLayer()!==void 0){var f=u.getMainLayer();return f.layerPickService.pickRasterLayer(f,r,this.parent)}return!1}return this.pickRender(r),a.pickFromPickingFBO(t,r)}},{key:"selectFeature",value:function(t){var r=(0,vn.Z)(t,3),n=r[0],a=r[1],u=r[2],f=this.color2PickId(n,a,u);this.tilePickID.set(Tp,f),this.updateHighLight(n,a,u,Tp)}},{key:"highlightPickedFeature",value:function(t){var r=(0,vn.Z)(t,3),n=r[0],a=r[1],u=r[2],f=this.color2PickId(n,a,u);this.tilePickID.set(Mp,f),this.updateHighLight(n,a,u,Mp)}},{key:"updateHighLight",value:function(t,r,n,a){this.tileLayerService.tiles.map(function(u){var f=u.getMainLayer();switch(a){case Tp:f==null||f.hooks.beforeSelect.call([t,r,n]);break;case Mp:f==null||f.hooks.beforeHighlight.call([t,r,n]);break}})}},{key:"setPickState",value:function(){var t=this.tilePickID.get(Tp),r=this.tilePickID.get(Mp);if(t){var n=this.pickId2Color(t),a=(0,vn.Z)(n,3),u=a[0],f=a[1],g=a[2];this.updateHighLight(u,f,g,Tp);return}if(r){var x=this.pickId2Color(r),I=(0,vn.Z)(x,3),O=I[0],B=I[1],W=I[2];this.updateHighLight(O,B,W,Mp);return}}},{key:"color2PickId",value:function(t,r,n){return io(new Uint8Array([t,r,n]))}},{key:"pickId2Color",value:function(t){return bs(t)}},{key:"getFeatureById",value:function(t){var r=this.tileLayerService.getTiles().filter(function(a){return a.visible}),n=[];return r.forEach(function(a){n.push.apply(n,(0,Mr.Z)(a.getFeatureById(t)))}),n}},{key:"pickRasterLayer",value:function(t,r,n){return!1}}]),e}();function xI(e){return e==="PolygonLayer"?mg:e==="LineLayer"?vg:Bd}function EI(e){return["PolygonLayer","LineLayer"].indexOf(e)!==-1}function bI(e){var i=SI();return function(){var r=(0,oe.Z)(e),n;if(i){var a=(0,oe.Z)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return(0,Ze.Z)(this,n)}}function SI(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var gh=function(e){(0,ke.Z)(t,e);var i=bI(t);function t(r,n){var a;return(0,ue.Z)(this,t),a=i.call(this),(0,Ce.Z)((0,bt.Z)(a),"visible",!0),(0,Ce.Z)((0,bt.Z)(a),"layers",[]),(0,Ce.Z)((0,bt.Z)(a),"isLoaded",!1),(0,Ce.Z)((0,bt.Z)(a),"tileMaskLayers",[]),a.parent=n,a.sourceTile=r,a.x=r.x,a.y=r.y,a.z=r.z,a.key="".concat(a.x,"_").concat(a.y,"_").concat(a.z),a}return(0,me.Z)(t,[{key:"getLayers",value:function(){return this.layers}},{key:"styleUpdate",value:function(){}},{key:"lnglatInBounds",value:function(n){var a=(0,vn.Z)(this.sourceTile.bounds,4),u=a[0],f=a[1],g=a[2],x=a[3],I=n.lng,O=n.lat;return I>=u&&I<=g&&O>=f&&O<=x}},{key:"getLayerOptions",value:function(){var n,a=this.parent.getLayerConfig();return(0,X.Z)((0,X.Z)({},a),{},{textAllowOverlap:!0,autoFit:!1,maskLayers:this.getMaskLayer(),tileMask:EI(this.parent.type),mask:a.mask||((n=a.maskLayers)===null||n===void 0?void 0:n.length)!==0&&a.enableMask})}},{key:"getMaskLayer",value:function(){var n=this,a=this.parent.getLayerConfig(),u=a.maskLayers,f=[];return u==null||u.forEach(function(g){if(!g.tileLayer)return f.push(g),g;var x=g.tileLayer,I=x.getTile(n.sourceTile.key),O=I==null?void 0:I.getLayers()[0];O&&f.push(O)}),f}},{key:"addTileMask",value:function(){var r=(0,ur.Z)(nt().mark(function a(){var u,f,g;return nt().wrap(function(I){for(;;)switch(I.prev=I.next){case 0:return u=new mg({visible:!1,enablePicking:!1}).source({type:"FeatureCollection",features:[this.sourceTile.bboxPolygon]},{parser:{type:"geojson",featureId:"id"}}).shape("fill").style({opacity:.5}),f=cp(this.parent.sceneContainer),u.setContainer(f,this.parent.sceneContainer),I.next=5,u.init();case 5:return this.tileMask=u,g=this.getMainLayer(),g!==void 0&&(g.tileMask=u),I.abrupt("return",u);case 9:case"end":return I.stop()}},a,this)}));function n(){return r.apply(this,arguments)}return n}()},{key:"addMask",value:function(){var r=(0,ur.Z)(nt().mark(function a(u,f){var g;return nt().wrap(function(I){for(;;)switch(I.prev=I.next){case 0:return g=cp(this.parent.sceneContainer),f.setContainer(g,this.parent.sceneContainer),I.next=4,f.init();case 4:u.addMask(f),this.tileMaskLayers.push(f);case 6:case"end":return I.stop()}},a,this)}));function n(a,u){return r.apply(this,arguments)}return n}()},{key:"addLayer",value:function(){var r=(0,ur.Z)(nt().mark(function a(u){var f;return nt().wrap(function(x){for(;;)switch(x.prev=x.next){case 0:return u.isTileLayer=!0,f=cp(this.parent.sceneContainer),u.setContainer(f,this.parent.sceneContainer),this.layers.push(u),x.next=6,u.init();case 6:case"end":return x.stop()}},a,this)}));function n(a){return r.apply(this,arguments)}return n}()},{key:"updateVisible",value:function(n){this.visible=n,this.updateOptions("visible",n)}},{key:"updateOptions",value:function(n,a){this.layers.forEach(function(u){u.updateLayerConfig((0,Ce.Z)({},n,a))})}},{key:"getMainLayer",value:function(){return this.layers[0]}},{key:"getFeatures",value:function(n){return[]}},{key:"getFeatureById",value:function(n){return[]}},{key:"destroy",value:function(){var n;(n=this.tileMask)===null||n===void 0||n.destroy(),this.layers.forEach(function(a){return a.destroy()})}}]),t}(xa.EventEmitter);function CI(e){var i=wI();return function(){var r=(0,oe.Z)(e),n;if(i){var a=(0,oe.Z)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return(0,Ze.Z)(this,n)}}function wI(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var TI=function(e){(0,ke.Z)(t,e);var i=CI(t);function t(){return(0,ue.Z)(this,t),i.apply(this,arguments)}return(0,me.Z)(t,[{key:"initTileLayer",value:function(){var r=(0,ur.Z)(nt().mark(function a(){var u,f,g,x;return nt().wrap(function(O){for(;;)switch(O.prev=O.next){case 0:return u=this.getSourceOption(),f=u.data.features[0].properties,g=new vg().source(u.data,u.options).size(1).shape("line").color("red"),x=new Bd({minZoom:this.z-1,maxZoom:this.z+1,textAllowOverlap:!0}).source([f],{parser:{type:"json",x:"x",y:"y"}}).size(20).color("red").shape(this.key).style({stroke:"#fff",strokeWidth:2}),O.next=6,this.addLayer(g);case 6:return O.next=8,this.addLayer(x);case 8:this.isLoaded=!0;case 9:case"end":return O.stop()}},a,this)}));function n(){return r.apply(this,arguments)}return n}()},{key:"getSourceOption",value:function(){var n=this.parent.getSource(),a=this.sourceTile.data.layers.testTile.features;return{data:{type:"FeatureCollection",features:a},options:{parser:{type:"geojson"},transforms:n.transforms}}}}]),t}(gh);function MI(e){var i=II();return function(){var r=(0,oe.Z)(e),n;if(i){var a=(0,oe.Z)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return(0,Ze.Z)(this,n)}}function II(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var LI=`precision mediump float;
uniform float u_opacity: 1.0;
uniform sampler2D u_texture;
varying vec2 v_texCoord;
void main() {
  vec4 color = texture2D(u_texture,vec2(v_texCoord.x,v_texCoord.y));
  gl_FragColor = color;
  gl_FragColor.a *= u_opacity;
  if(gl_FragColor.a < 0.01)
    discard;
}
`,PI=`precision highp float;
uniform mat4 u_ModelMatrix;

attribute vec3 a_Position;
attribute vec2 a_Uv;
varying vec2 v_texCoord;
#pragma include "projection"
void main() {
   v_texCoord = a_Uv;
   vec4 project_pos = project_position(vec4(a_Position, 1.0));
   gl_Position = project_common_position_to_clipspace_v2(vec4(project_pos.xy,0., 1.0));
 
}
`,OI=function(e){(0,ke.Z)(t,e);var i=MI(t);function t(){return(0,ue.Z)(this,t),i.apply(this,arguments)}return(0,me.Z)(t,[{key:"getUninforms",value:function(){var n=this.layer.getLayerConfig(),a=n.opacity;return{u_opacity:a||1,u_texture:this.texture}}},{key:"initModels",value:function(){var r=(0,ur.Z)(nt().mark(function a(){var u,f,g,x;return nt().wrap(function(O){for(;;)switch(O.prev=O.next){case 0:return u=this.layer.getSource(),f=this.rendererService.createTexture2D,this.texture=f({height:0,width:0}),O.next=5,u.data.images;case 5:return g=O.sent,this.texture=f({data:g[0],width:g[0].width,height:g[0].height,mag:Ge.LINEAR,min:Ge.LINEAR}),O.next=9,this.layer.buildLayerModel({moduleName:"rasterImage",vertexShader:PI,fragmentShader:LI,triangulation:kd,primitive:Ge.TRIANGLES,blend:{enable:!0},depth:{enable:!1}});case 9:return x=O.sent,O.abrupt("return",[x]);case 11:case"end":return O.stop()}},a,this)}));function n(){return r.apply(this,arguments)}return n}()},{key:"clearModels",value:function(){var n;(n=this.texture)===null||n===void 0||n.destroy()}},{key:"buildModels",value:function(){var r=(0,ur.Z)(nt().mark(function a(){return nt().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return f.abrupt("return",this.initModels());case 1:case"end":return f.stop()}},a,this)}));function n(){return r.apply(this,arguments)}return n}()},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"uv",type:mn.Attribute,descriptor:{name:"a_Uv",buffer:{usage:Ge.DYNAMIC_DRAW,data:[],type:Ge.FLOAT},size:2,update:function(a,u,f){return[f[3],f[4]]}}})}}]),t}(vo),RI={image:OI},kI=RI;function DI(e){var i=NI();return function(){var r=(0,oe.Z)(e),n;if(i){var a=(0,oe.Z)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return(0,Ze.Z)(this,n)}}function NI(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var FI=function(e){(0,ke.Z)(t,e);var i=DI(t);function t(){var r;(0,ue.Z)(this,t);for(var n=arguments.length,a=new Array(n),u=0;u<n;u++)a[u]=arguments[u];return r=i.call.apply(i,[this].concat(a)),(0,Ce.Z)((0,bt.Z)(r),"type","ImageLayer"),r}return(0,me.Z)(t,[{key:"buildModels",value:function(){var r=(0,ur.Z)(nt().mark(function a(){var u;return nt().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return u=this.getModelType(),this.layerModel=new kI[u](this),g.next=4,this.initLayerModels();case 4:case"end":return g.stop()}},a,this)}));function n(){return r.apply(this,arguments)}return n}()},{key:"getDefaultConfig",value:function(){var n=this.getModelType(),a={image:{}};return a[n]}},{key:"getModelType",value:function(){return"image"}}]),t}(nA);function BI(e){var i=ZI();return function(){var r=(0,oe.Z)(e),n;if(i){var a=(0,oe.Z)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return(0,Ze.Z)(this,n)}}function ZI(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var zI=function(e){(0,ke.Z)(t,e);var i=BI(t);function t(){return(0,ue.Z)(this,t),i.apply(this,arguments)}return(0,me.Z)(t,[{key:"initTileLayer",value:function(){var r=(0,ur.Z)(nt().mark(function a(){var u,f,g,x;return nt().wrap(function(O){for(;;)switch(O.prev=O.next){case 0:return u=this.parent.getLayerAttributeConfig(),f=this.getLayerOptions(),g=this.getSourceOption(),x=new FI((0,X.Z)({},f)).source(g.data,g.options),u&&Object.keys(u).forEach(function(B){var W,he,ae=B;x[ae]((W=u[ae])===null||W===void 0?void 0:W.field,(he=u[ae])===null||he===void 0?void 0:he.values)}),O.next=7,this.addLayer(x);case 7:this.isLoaded=!0;case 8:case"end":return O.stop()}},a,this)}));function n(){return r.apply(this,arguments)}return n}()},{key:"getSourceOption",value:function(){var n=this.parent.getSource();return{data:this.sourceTile.data,options:{parser:{type:"image",extent:this.sourceTile.bounds},transforms:n.transforms}}}}]),t}(gh);function UI(e){var i=GI();return function(){var r=(0,oe.Z)(e),n;if(i){var a=(0,oe.Z)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return(0,Ze.Z)(this,n)}}function GI(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var jI=function(e){(0,ke.Z)(t,e);var i=UI(t);function t(){return(0,ue.Z)(this,t),i.apply(this,arguments)}return(0,me.Z)(t,[{key:"initTileLayer",value:function(){var r=(0,ur.Z)(nt().mark(function a(){var u,f,g,x;return nt().wrap(function(O){for(;;)switch(O.prev=O.next){case 0:return u=this.parent.getLayerAttributeConfig(),f=this.getLayerOptions(),g=this.getSourceOption(),x=new R1((0,X.Z)({},f)).source(g.data,g.options),u&&Object.keys(u).forEach(function(B){var W,he,ae=B;x[ae]((W=u[ae])===null||W===void 0?void 0:W.field,(he=u[ae])===null||he===void 0?void 0:he.values)}),O.next=7,this.addLayer(x);case 7:this.isLoaded=!0;case 8:case"end":return O.stop()}},a,this)}));function n(){return r.apply(this,arguments)}return n}()},{key:"getFeatures",value:function(n){if(!n)return[];var a=this.sourceTile.data;return a.getTileData(n)}},{key:"getSourceOption",value:function(){var n=this.parent.getSource(),a=this.parent.getLayerConfig(),u=a.sourceLayer,f=a.featureId,g=this.getFeatures(u);return{data:{type:"FeatureCollection",features:g},options:{parser:{type:"geojson",featureId:f},transforms:n.transforms}}}}]),t}(gh);function VI(e){var i=HI();return function(){var r=(0,oe.Z)(e),n;if(i){var a=(0,oe.Z)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return(0,Ze.Z)(this,n)}}function HI(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var $I=`precision mediump float;
uniform float u_opacity: 1.0;
uniform sampler2D u_texture;
uniform sampler2D u_colorTexture;
uniform float u_min;
uniform float u_max;
uniform vec2 u_domain;
uniform float u_noDataValue;
uniform bool u_clampLow: true;
uniform bool u_clampHigh: true;
varying vec2 v_texCoord;
bool isnan_emu(float x) { return (x > 0.0 || x < 0.0) ? x != x : x != 0.0; }


void main() {

  float value = texture2D(u_texture,vec2(v_texCoord.x,v_texCoord.y)).r;
  if (value == u_noDataValue || isnan_emu(value))
      discard;
  else if ((!u_clampLow && value < u_domain[0]) || (!u_clampHigh && value > u_domain[1]))
     discard;
  else {
    float normalisedValue =(value - u_domain[0]) / (u_domain[1] -u_domain[0]);
    vec4 color = texture2D(u_colorTexture,vec2(normalisedValue, 0));
    
    gl_FragColor = color;
    gl_FragColor.a =  gl_FragColor.a * u_opacity ;
    if(gl_FragColor.a < 0.01)
      discard;
   
  }
}
`,WI=`precision highp float;
uniform mat4 u_ModelMatrix;

attribute vec3 a_Position;
attribute vec2 a_Uv;
varying vec2 v_texCoord;
#pragma include "projection"
void main() {
   v_texCoord = a_Uv;
   vec4 project_pos = project_position(vec4(a_Position, 1.0));

    gl_Position = project_common_position_to_clipspace_v2(vec4(project_pos.xy,0., 1.0));
}
`,c2=function(e){(0,ke.Z)(t,e);var i=VI(t);function t(){return(0,ue.Z)(this,t),i.apply(this,arguments)}return(0,me.Z)(t,[{key:"getUninforms",value:function(){var n=this.layer.getLayerConfig(),a=n.opacity,u=a===void 0?1:a,f=n.clampLow,g=f===void 0?!0:f,x=n.clampHigh,I=x===void 0?!0:x,O=n.noDataValue,B=O===void 0?-9999999:O,W=n.domain,he=n.rampColors,ae=W||Js(he);return this.colorTexture=this.layer.textureService.getColorTexture(he,ae),{u_opacity:u||1,u_texture:this.texture,u_domain:ae,u_clampLow:g,u_clampHigh:typeof I!="undefined"?I:g,u_noDataValue:B,u_colorTexture:this.colorTexture}}},{key:"getRasterData",value:function(){var r=(0,ur.Z)(nt().mark(function a(u){var f,g,x,I;return nt().wrap(function(B){for(;;)switch(B.prev=B.next){case 0:if(!Array.isArray(u.data)){B.next=4;break}return B.abrupt("return",{data:u.data,width:u.width,height:u.height});case 4:return B.next=6,u.data;case 6:return f=B.sent,g=f.rasterData,x=f.width,I=f.height,B.abrupt("return",{data:Array.from(g),width:x,height:I});case 11:case"end":return B.stop()}},a)}));function n(a){return r.apply(this,arguments)}return n}()},{key:"initModels",value:function(){var r=(0,ur.Z)(nt().mark(function a(){var u,f,g,x,I,O,B,W;return nt().wrap(function(ae){for(;;)switch(ae.prev=ae.next){case 0:return u=this.layer.getSource(),f=this.rendererService.createTexture2D,g=u.data.dataArray[0],ae.next=5,this.getRasterData(g);case 5:return x=ae.sent,I=x.data,O=x.width,B=x.height,this.texture=f({data:I,width:O,height:B,format:Ge.LUMINANCE,type:Ge.FLOAT}),ae.next=12,this.layer.buildLayerModel({moduleName:"rasterImageData",vertexShader:WI,fragmentShader:$I,triangulation:kd,primitive:Ge.TRIANGLES,depth:{enable:!1}});case 12:return W=ae.sent,ae.abrupt("return",[W]);case 14:case"end":return ae.stop()}},a,this)}));function n(){return r.apply(this,arguments)}return n}()},{key:"buildModels",value:function(){var r=(0,ur.Z)(nt().mark(function a(){return nt().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return f.abrupt("return",this.initModels());case 1:case"end":return f.stop()}},a,this)}));function n(){return r.apply(this,arguments)}return n}()},{key:"clearModels",value:function(){var n,a;(n=this.texture)===null||n===void 0||n.destroy(),(a=this.colorTexture)===null||a===void 0||a.destroy()}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"uv",type:mn.Attribute,descriptor:{name:"a_Uv",buffer:{usage:Ge.DYNAMIC_DRAW,data:[],type:Ge.FLOAT},size:2,update:function(a,u,f){return[f[3],f[4]]}}})}}]),t}(vo),YI=["data"],XI=["rasterData"];function QI(e){var i=qI();return function(){var r=(0,oe.Z)(e),n;if(i){var a=(0,oe.Z)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return(0,Ze.Z)(this,n)}}function qI(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var KI=`precision highp float;
uniform mat4 u_ModelMatrix;

attribute vec3 a_Position;
attribute vec2 a_Uv;
varying vec2 v_texCoord;
#pragma include "projection"
void main() {
   v_texCoord = a_Uv;
   vec4 project_pos = project_position(vec4(a_Position, 1.0));

    gl_Position = project_common_position_to_clipspace_v2(vec4(project_pos.xy,0., 1.0));
}
`,JI=`precision mediump float;
uniform vec2 u_rminmax: vec2(0,255); 
uniform vec2 u_gminmax: vec2(0,255);
uniform vec2 u_bminmax: vec2(0,255);
uniform float u_opacity: 1.0;
uniform sampler2D u_texture;
uniform float u_noDataValue : 0.0;
varying vec2 v_texCoord;

void main() {
  vec3 rgb = texture2D(u_texture,vec2(v_texCoord.x,v_texCoord.y)).rgb;
  if(rgb == vec3(u_noDataValue)) {
    gl_FragColor = vec4(0.0, 0, 0, 0.0);
  } else {
    gl_FragColor = vec4(rgb.r / (u_rminmax.y -u_rminmax.x), rgb.g /(u_gminmax.y -u_gminmax.x), rgb.b/ (u_bminmax.y - u_bminmax.x), u_opacity);
  }
  if(gl_FragColor.a < 0.01)
    discard;
 
}`,e5=function(e){(0,ke.Z)(t,e);var i=QI(t);function t(){var r;(0,ue.Z)(this,t);for(var n=arguments.length,a=new Array(n),u=0;u<n;u++)a[u]=arguments[u];return r=i.call.apply(i,[this].concat(a)),(0,Ce.Z)((0,bt.Z)(r),"dataOption",{}),r}return(0,me.Z)(t,[{key:"getUninforms",value:function(){var n=this.layer.getLayerConfig(),a=n.opacity,u=a===void 0?1:a,f=n.noDataValue,g=f===void 0?0:f,x=this.dataOption,I=x.rMinMax,O=x.gMinMax,B=x.bMinMax;return{u_opacity:u||1,u_texture:this.texture,u_noDataValue:g,u_rminmax:I,u_gminmax:O,u_bminmax:B}}},{key:"getRasterData",value:function(){var r=(0,ur.Z)(nt().mark(function a(u){var f,g,x,I,O;return nt().wrap(function(W){for(;;)switch(W.prev=W.next){case 0:if(!Array.isArray(u.data)){W.next=4;break}return f=u.data,g=(0,hc.Z)(u,YI),this.dataOption=g,W.abrupt("return",(0,X.Z)({data:f},g));case 4:return W.next=6,u.data;case 6:if(x=W.sent,I=x.rasterData,O=(0,hc.Z)(x,XI),this.dataOption=O,!Array.isArray(I)){W.next=14;break}return W.abrupt("return",(0,X.Z)({data:I},O));case 14:return W.abrupt("return",(0,X.Z)({data:Array.from(I)},O));case 15:case"end":return W.stop()}},a,this)}));function n(a){return r.apply(this,arguments)}return n}()},{key:"initModels",value:function(){var r=(0,ur.Z)(nt().mark(function a(){var u,f,g,x,I,O,B,W;return nt().wrap(function(ae){for(;;)switch(ae.prev=ae.next){case 0:return u=this.layer.getSource(),f=this.rendererService.createTexture2D,g=u.data.dataArray[0],ae.next=5,this.getRasterData(g);case 5:return x=ae.sent,I=x.data,O=x.width,B=x.height,this.texture=f({data:I,width:O,height:B,format:Ge.RGB,type:Ge.FLOAT}),ae.next=12,this.layer.buildLayerModel({moduleName:"rasterImageDataRGBA",vertexShader:KI,fragmentShader:JI,triangulation:kd,primitive:Ge.TRIANGLES,depth:{enable:!1}});case 12:return W=ae.sent,ae.abrupt("return",[W]);case 14:case"end":return ae.stop()}},a,this)}));function n(){return r.apply(this,arguments)}return n}()},{key:"buildModels",value:function(){var r=(0,ur.Z)(nt().mark(function a(){return nt().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return f.abrupt("return",this.initModels());case 1:case"end":return f.stop()}},a,this)}));function n(){return r.apply(this,arguments)}return n}()},{key:"clearModels",value:function(){var n;(n=this.texture)===null||n===void 0||n.destroy()}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"uv",type:mn.Attribute,descriptor:{name:"a_Uv",buffer:{usage:Ge.DYNAMIC_DRAW,data:[],type:Ge.FLOAT},size:2,update:function(a,u,f){return[f[3],f[4]]}}})}}]),t}(vo);function t5(e){var i=r5();return function(){var r=(0,oe.Z)(e),n;if(i){var a=(0,oe.Z)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return(0,Ze.Z)(this,n)}}function r5(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var n5=`precision mediump float;
uniform float u_opacity: 1.0;

uniform sampler2D u_texture;
uniform sampler2D u_colorTexture;

varying vec2 v_texCoord;

uniform vec2 u_domain;
uniform float u_noDataValue;
uniform bool u_clampLow: true;
uniform bool u_clampHigh: true;
uniform vec4 u_unpack;

float getElevation(vec2 coord, float bias) {
    // Convert encoded elevation value to meters
    vec4 data = texture2D(u_texture, coord,bias) * 255.0;
    data.a = -1.0;
    return dot(data, u_unpack);
}

vec4 getColor(float value) {
   float normalisedValue =(value- u_domain[0]) / (u_domain[1] - u_domain[0]);
    vec2 coord = vec2(normalisedValue, 0);
    return texture2D(u_colorTexture, coord);
}

void main() {
  float value = getElevation(v_texCoord,0.0);
  if (value == u_noDataValue) {
    gl_FragColor = vec4(0.0, 0, 0, 0.0);
  } else if ((!u_clampLow && value < u_domain[0]) || (!u_clampHigh && value > u_domain[1])) {
     gl_FragColor = vec4(0.0, 0, 0, 0.0);
  } else {
   
    gl_FragColor = getColor(value);
    gl_FragColor.a =  gl_FragColor.a * u_opacity ;
      if(gl_FragColor.a < 0.01)
      discard;
  }
}
`,i5=`precision highp float;
uniform mat4 u_ModelMatrix;

attribute vec3 a_Position;
attribute vec2 a_Uv;
varying vec2 v_texCoord;
#pragma include "projection"
void main() {
   v_texCoord = a_Uv;
   vec4 project_pos = project_position(vec4(a_Position, 1.0));
   gl_Position = project_common_position_to_clipspace_v2(vec4(project_pos.xy,0., 1.0));
}
`,a5=function(e){(0,ke.Z)(t,e);var i=t5(t);function t(){return(0,ue.Z)(this,t),i.apply(this,arguments)}return(0,me.Z)(t,[{key:"getUninforms",value:function(){var n=this.layer.getLayerConfig(),a=n.opacity,u=n.clampLow,f=u===void 0?!0:u,g=n.clampHigh,x=g===void 0?!0:g,I=n.noDataValue,O=I===void 0?-9999999:I,B=n.domain,W=n.rampColors,he=n.colorTexture,ae=n.rScaler,Se=ae===void 0?6553.6:ae,Fe=n.gScaler,Qe=Fe===void 0?25.6:Fe,qe=n.bScaler,yt=qe===void 0?.1:qe,Et=n.offset,Ot=Et===void 0?1e4:Et,jt=B||Js(W),or=he;return he?this.layer.textureService.setColorTexture(he,W,jt):or=this.layer.textureService.getColorTexture(W,jt),{u_opacity:a||1,u_texture:this.texture,u_domain:jt,u_clampLow:f,u_clampHigh:typeof x!="undefined"?x:f,u_noDataValue:O,u_unpack:[Se,Qe,yt,Ot],u_colorTexture:or}}},{key:"initModels",value:function(){var r=(0,ur.Z)(nt().mark(function a(){var u,f,g,x;return nt().wrap(function(O){for(;;)switch(O.prev=O.next){case 0:return u=this.layer.getSource(),f=this.rendererService.createTexture2D,O.next=4,u.data.images;case 4:return g=O.sent,this.texture=f({data:g[0],width:g[0].width,height:g[0].height,min:Ge.LINEAR,mag:Ge.LINEAR}),O.next=8,this.layer.buildLayerModel({moduleName:"RasterTileDataImage",vertexShader:i5,fragmentShader:n5,triangulation:kd,primitive:Ge.TRIANGLES,depth:{enable:!1}});case 8:return x=O.sent,O.abrupt("return",[x]);case 10:case"end":return O.stop()}},a,this)}));function n(){return r.apply(this,arguments)}return n}()},{key:"clearModels",value:function(){var n;(n=this.texture)===null||n===void 0||n.destroy()}},{key:"buildModels",value:function(){var r=(0,ur.Z)(nt().mark(function a(){return nt().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return f.abrupt("return",this.initModels());case 1:case"end":return f.stop()}},a,this)}));function n(){return r.apply(this,arguments)}return n}()},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"uv",type:mn.Attribute,descriptor:{name:"a_Uv",buffer:{usage:Ge.DYNAMIC_DRAW,data:[],type:Ge.FLOAT},size:2,update:function(a,u,f){return[f[3],f[4]]}}})}}]),t}(vo),o5={raster:c2,rasterRgb:e5,raster3d:c2,rasterTerrainRgb:a5},s5=o5;function u5(e){var i=l5();return function(){var r=(0,oe.Z)(e),n;if(i){var a=(0,oe.Z)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return(0,Ze.Z)(this,n)}}function l5(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var Zg=function(e){(0,ke.Z)(t,e);var i=u5(t);function t(){var r;(0,ue.Z)(this,t);for(var n=arguments.length,a=new Array(n),u=0;u<n;u++)a[u]=arguments[u];return r=i.call.apply(i,[this].concat(a)),(0,Ce.Z)((0,bt.Z)(r),"type","RasterLayer"),r}return(0,me.Z)(t,[{key:"buildModels",value:function(){var r=(0,ur.Z)(nt().mark(function a(){var u;return nt().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return u=this.getModelType(),this.layerModel=new s5[u](this),g.next=4,this.initLayerModels();case 4:case"end":return g.stop()}},a,this)}));function n(){return r.apply(this,arguments)}return n}()},{key:"getDefaultConfig",value:function(){var n=this.getModelType(),a={raster:{},rasterRgb:{},raster3d:{},rasterTerrainRgb:{}};return a[n]}},{key:"getModelType",value:function(){var n=this.layerSource.getParserType();switch(n){case"raster":return"raster";case"rasterRgb":return"rasterRgb";case"image":return"rasterTerrainRgb";default:return"raster"}}}]),t}(nA),c5=["rasterData"];function f5(e){var i=h5();return function(){var r=(0,oe.Z)(e),n;if(i){var a=(0,oe.Z)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return(0,Ze.Z)(this,n)}}function h5(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var A5=function(e){(0,ke.Z)(t,e);var i=f5(t);function t(){return(0,ue.Z)(this,t),i.apply(this,arguments)}return(0,me.Z)(t,[{key:"initTileLayer",value:function(){var r=(0,ur.Z)(nt().mark(function a(){var u,f,g,x;return nt().wrap(function(O){for(;;)switch(O.prev=O.next){case 0:return u=this.parent.getLayerAttributeConfig(),f=this.getLayerOptions(),g=this.getSourceOption(),x=new Zg((0,X.Z)({},f)).source(g.data,g.options),u&&Object.keys(u).forEach(function(B){var W,he,ae=B;x[ae]((W=u[ae])===null||W===void 0?void 0:W.field,(he=u[ae])===null||he===void 0?void 0:he.values)}),O.next=7,this.addLayer(x);case 7:this.isLoaded=!0;case 8:case"end":return O.stop()}},a,this)}));function n(){return r.apply(this,arguments)}return n}()},{key:"getSourceOption",value:function(){var n=this.parent.getSource(),a=this.sourceTile.data.data,u=a.rasterData,f=(0,hc.Z)(a,c5);return{data:u,options:{parser:(0,X.Z)({type:"rasterRgb",extent:this.sourceTile.bounds},f),transforms:n.transforms}}}}]),t}(gh);function p5(e){var i=d5();return function(){var r=(0,oe.Z)(e),n;if(i){var a=(0,oe.Z)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return(0,Ze.Z)(this,n)}}function d5(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var v5=function(e){(0,ke.Z)(t,e);var i=p5(t);function t(){return(0,ue.Z)(this,t),i.apply(this,arguments)}return(0,me.Z)(t,[{key:"initTileLayer",value:function(){var r=(0,ur.Z)(nt().mark(function a(){var u,f,g,x;return nt().wrap(function(O){for(;;)switch(O.prev=O.next){case 0:return u=this.parent.getLayerAttributeConfig(),f=this.getLayerOptions(),g=this.getSourceOption(),x=new Zg((0,X.Z)({},f)).source(g.data,g.options),u&&Object.keys(u).forEach(function(B){var W,he,ae=B;x[ae]((W=u[ae])===null||W===void 0?void 0:W.field,(he=u[ae])===null||he===void 0?void 0:he.values)}),O.next=7,this.addLayer(x);case 7:this.isLoaded=!0;case 8:case"end":return O.stop()}},a,this)}));function n(){return r.apply(this,arguments)}return n}()},{key:"getSourceOption",value:function(){var n=this.parent.getSource();return{data:this.sourceTile.data,options:{parser:{type:"image",extent:this.sourceTile.bounds},transforms:n.transforms}}}}]),t}(gh),g5=["rasterData"];function m5(e){var i=y5();return function(){var r=(0,oe.Z)(e),n;if(i){var a=(0,oe.Z)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return(0,Ze.Z)(this,n)}}function y5(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var _5={positions:[0,1],colors:["#000","#fff"]},x5=function(e){(0,ke.Z)(t,e);var i=m5(t);function t(){return(0,ue.Z)(this,t),i.apply(this,arguments)}return(0,me.Z)(t,[{key:"initTileLayer",value:function(){var r=(0,ur.Z)(nt().mark(function a(){var u,f,g,x,I,O,B;return nt().wrap(function(he){for(;;)switch(he.prev=he.next){case 0:return u=this.parent.getLayerAttributeConfig(),f=this.getLayerOptions(),g=this.getSourceOption(),x=this.getLayerOptions(),I=x.rampColors,O=x.domain,this.colorTexture=this.parent.textureService.getColorTexture(I,O),B=new Zg((0,X.Z)((0,X.Z)({},f),{},{colorTexture:this.colorTexture})).source(g.data,g.options),u&&Object.keys(u).forEach(function(ae){var Se,Fe,Qe=ae;B[Qe]((Se=u[Qe])===null||Se===void 0?void 0:Se.field,(Fe=u[Qe])===null||Fe===void 0?void 0:Fe.values)}),he.next=9,this.addLayer(B);case 9:this.isLoaded=!0;case 10:case"end":return he.stop()}},a,this)}));function n(){return r.apply(this,arguments)}return n}()},{key:"getSourceOption",value:function(){var n=this.parent.getSource(),a=this.sourceTile.data.data,u=a.rasterData,f=(0,hc.Z)(a,g5);return{data:u,options:{parser:(0,X.Z)({type:"raster",extent:this.sourceTile.bounds},f),transforms:n.transforms}}}},{key:"styleUpdate",value:function(){for(var n=this,a=arguments.length,u=new Array(a),f=0;f<a;f++)u[f]=arguments[f];var g=u,x=g.rampColors,I=x===void 0?_5:x,O=g.domain;this.colorTexture=this.parent.textureService.getColorTexture(I,O||Js(I)),this.layers.forEach(function(B){return B.style({colorTexture:n.colorTexture})})}},{key:"destroy",value:function(){this.layers.forEach(function(n){return n.destroy()})}}]),t}(gh);function E5(e){var i=b5();return function(){var r=(0,oe.Z)(e),n;if(i){var a=(0,oe.Z)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return(0,Ze.Z)(this,n)}}function b5(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var ev=function(e){(0,ke.Z)(t,e);var i=E5(t);function t(){return(0,ue.Z)(this,t),i.apply(this,arguments)}return(0,me.Z)(t,[{key:"initTileLayer",value:function(){var r=(0,ur.Z)(nt().mark(function a(){var u,f,g,x,I;return nt().wrap(function(B){for(;;)switch(B.prev=B.next){case 0:if(u=this.parent.getLayerAttributeConfig(),f=this.getLayerOptions(),g=xI(this.parent.type),x=this.getSourceOption(),x){B.next=8;break}return this.isLoaded=!0,this.emit("loaded"),B.abrupt("return");case 8:return I=new g((0,X.Z)({},f)).source(x.data,x.options),Object.keys(u).forEach(function(W){var he,ae,Se=W;I[Se]((he=u[Se])===null||he===void 0?void 0:he.field,(ae=u[Se])===null||ae===void 0?void 0:ae.values)}),B.next=12,this.addLayer(I);case 12:if(!f.tileMask){B.next=15;break}return B.next=15,this.addTileMask();case 15:this.setLayerMinMaxZoom(I),this.isLoaded=!0,this.emit("loaded");case 18:case"end":return B.stop()}},a,this)}));function n(){return r.apply(this,arguments)}return n}()},{key:"getSourceOption",value:function(){var n=this.parent.getSource(),a=this.parent.getLayerConfig(),u=a.sourceLayer,f=u===void 0?"defaultLayer":u,g=a.featureId,x=g===void 0?"id":g,I=this.getFeatures(f);return{data:{type:"FeatureCollection",features:I},options:{parser:{type:"geojson",featureId:x},transforms:n.transforms}}}},{key:"setLayerMinMaxZoom",value:function(n){n.getModelType()==="text"&&n.updateLayerConfig({maxZoom:this.z+1,minZoom:this.z-1})}},{key:"getFeatures",value:function(n){var a=this.sourceTile.data;return a.getTileData(n)}},{key:"getFeatureById",value:function(n){var a=this.getMainLayer();if(!a)return[];var u=a.getSource().data.dataArray.filter(function(f){return f._id===n});return u}}]),t}(gh);function S5(e){var i=e.type;switch(i){case"PolygonLayer":return ev;case"LineLayer":return ev;case"PointLayer":return ev;case"TileDebugLayer":return TI;case"MaskLayer":return jI;case"RasterLayer":var t=e.getSource().parser.dataType;switch(t){case Yu.RGB:case Yu.CUSTOMRGB:return A5;case Yu.ARRAYBUFFER:case Yu.CUSTOMARRAYBUFFER:return x5;case Yu.TERRAINRGB:case Yu.CUSTOMTERRAINRGB:return v5;default:return zI}default:return ev}}var C5=["shape","color","size","style","animate","filter","rotate","scale","setBlend","setSelect","setActive","disableMask","enableMask"],w5=In.debounce,f2=function(){function e(i){var t=this;(0,ue.Z)(this,e),(0,Ce.Z)(this,"initedTileset",!1),(0,Ce.Z)(this,"mapchange",function(){var n;if(t.parent.isVisible()!==!1){var a=t.getCurrentView(),u=a.latLonBounds,f=a.zoom;if(t.mapService.version==="GAODE1.x"){var g=t.parent.getLayerConfig(),x=g.visible;f<2&&x?(t.parent.updateLayerConfig({visible:!1}),t.layerService.reRender()):f>=2&&!x&&(t.parent.updateLayerConfig({visible:!0}),t.layerService.reRender())}t.lastViewStates&&t.lastViewStates.zoom===f&&t.lastViewStates.latLonBounds.toString()===u.toString()||(t.lastViewStates={zoom:f,latLonBounds:u},(n=t.tilesetManager)===null||n===void 0||n.throttleUpdate(f,u))}}),(0,Ce.Z)(this,"viewchange",w5(this.mapchange,24)),this.parent=i;var r=this.parent.getContainer();this.rendererService=r.get(Xt.IRendererService),this.layerService=r.get(Xt.ILayerService),this.mapService=r.get(Xt.IMapService),this.pickingService=r.get(Xt.IPickingService),this.tileLayerService=new gI({rendererService:this.rendererService,layerService:this.layerService,parent:i}),this.tilePickService=new _I({tileLayerService:this.tileLayerService,layerService:this.layerService,parent:i}),this.parent.setLayerPickService(this.tilePickService),this.proxy(i),this.initTileSetManager()}return(0,me.Z)(e,[{key:"initTileSetManager",value:function(){var t,r=this.parent.getSource();if(this.tilesetManager=r.tileset,this.initedTileset||(this.bindTilesetEvent(),this.initedTileset=!0),this.parent.isVisible()!==!1){var n=this.getCurrentView(),a=n.latLonBounds,u=n.zoom;(t=this.tilesetManager)===null||t===void 0||t.update(u,a)}}},{key:"getCurrentView",value:function(){var t=this.mapService.getBounds(),r=[t[0][0],t[0][1],t[1][0],t[1][1]],n=this.mapService.getZoom();return{latLonBounds:r,zoom:n}}},{key:"bindTilesetEvent",value:function(){var t=this;this.tilesetManager.on("tile-loaded",function(r){}),this.tilesetManager.on("tile-unload",function(r){t.tileUnLoad(r)}),this.tilesetManager.on("tile-error",function(r,n){t.tileError(r)}),this.tilesetManager.on("tile-update",function(){t.tileUpdate()}),this.mapService.on("zoomend",this.mapchange),this.mapService.on("moveend",this.viewchange)}},{key:"render",value:function(){this.tileLayerService.render()}},{key:"getLayers",value:function(){return this.tileLayerService.getLayers()}},{key:"getTiles",value:function(){return this.tileLayerService.getTiles()}},{key:"getTile",value:function(t){return this.tileLayerService.getTile(t)}},{key:"tileLoaded",value:function(t){}},{key:"tileError",value:function(t){console.warn("error:",t)}},{key:"destroy",value:function(){var t;this.mapService.off("zoomend",this.mapchange),this.mapService.off("moveend",this.viewchange),(t=this.tilesetManager)===null||t===void 0||t.destroy(),this.tileLayerService.destroy()}},{key:"reload",value:function(){var t;this.tilesetManager.clear();var r=this.getCurrentView(),n=r.latLonBounds,a=r.zoom;(t=this.tilesetManager)===null||t===void 0||t.update(a,n)}},{key:"tileUnLoad",value:function(t){this.tileLayerService.removeTile(t.key)}},{key:"tileUpdate",value:function(){var i=(0,ur.Z)(nt().mark(function r(){var n=this,a,u;return nt().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:if(this.tilesetManager){g.next=2;break}return g.abrupt("return");case 2:return a=this.parent.getMinZoom(),u=this.parent.getMaxZoom(),g.next=6,Promise.all(this.tilesetManager.tiles.filter(function(x){return x.isLoaded}).filter(function(x){return x.isVisibleChange}).filter(function(x){return x.data}).filter(function(x){return x.z>=a&&x.z<u}).map(function(){var x=(0,ur.Z)(nt().mark(function I(O){var B,W;return nt().wrap(function(ae){for(;;)switch(ae.prev=ae.next){case 0:if(n.tileLayerService.hasTile(O.key)){ae.next=9;break}return B=S5(n.parent),W=new B(O,n.parent),ae.next=5,W.initTileLayer();case 5:n.tilePickService.setPickState(),W.getLayers().length!==0&&(n.tileLayerService.addTile(W),n.tileLayerService.updateTileVisible(O),n.layerService.reRender()),ae.next=12;break;case 9:n.tileLayerService.updateTileVisible(O),n.tilePickService.setPickState(),n.layerService.reRender();case 12:case"end":return ae.stop()}},I)}));return function(I){return x.apply(this,arguments)}}()));case 6:this.tilesetManager.isLoaded&&this.parent.emit("tiles-loaded",this.tilesetManager.currentTiles);case 7:case"end":return g.stop()}},r,this)}));function t(){return i.apply(this,arguments)}return t}()},{key:"setPickState",value:function(t){}},{key:"pickRender",value:function(t){this.tilePickService.pickRender(t)}},{key:"selectFeature",value:function(t){this.tilePickService.selectFeature(t)}},{key:"highlightPickedFeature",value:function(t){this.tilePickService.highlightPickedFeature(t)}},{key:"proxy",value:function(t){var r=this;C5.forEach(function(n){var a=t[n].bind(t);t[n]=function(){for(var u=arguments.length,f=new Array(u),g=0;g<u;g++)f[g]=arguments[g];return a.apply(void 0,f),r.getLayers().map(function(x){x[n].apply(x,f)}),n==="style"&&r.getTiles().forEach(function(x){return x.styleUpdate.apply(x,f)}),t}})}}]),e}(),h2,A2,T5=(h2=(0,dr.b2)(),h2(A2=function(){function e(){(0,ue.Z)(this,e)}return(0,me.Z)(e,[{key:"build",value:function(){var i=(0,ur.Z)(nt().mark(function r(n){return nt().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return n.prepareBuildModel(),u.next=3,n.buildModels();case 3:case"end":return u.stop()}},r)}));function t(r){return i.apply(this,arguments)}return t}()},{key:"initLayerModel",value:function(){var i=(0,ur.Z)(nt().mark(function r(n){return nt().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.next=2,this.build(n);case 2:n.styleNeedUpdate=!1;case 3:case"end":return u.stop()}},r,this)}));function t(r){return i.apply(this,arguments)}return t}()},{key:"prepareLayerModel",value:function(){var i=(0,ur.Z)(nt().mark(function r(n){return nt().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.next=2,this.build(n);case 2:n.styleNeedUpdate=!1;case 3:case"end":return u.stop()}},r,this)}));function t(r){return i.apply(this,arguments)}return t}()},{key:"apply",value:function(t){var r=this;t.hooks.init.tapPromise("LayerModelPlugin",(0,ur.Z)(nt().mark(function n(){return nt().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:if(!t.getSource().isTile){u.next=4;break}return t.prepareBuildModel(),t.tileLayer=new f2(t),u.abrupt("return");case 4:return t.log(Ks.BuildModelStart,cs.INIT),u.next=7,r.initLayerModel(t);case 7:t.log(Ks.BuildModelEnd,cs.INIT);case 8:case"end":return u.stop()}},n)}))),t.hooks.beforeRenderData.tapPromise("LayerModelPlugin",function(){var n=(0,ur.Z)(nt().mark(function a(u){return nt().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:if(u){g.next=2;break}return g.abrupt("return",!1);case 2:if(!t.getSource().isTile){g.next=5;break}return t.tileLayer=new f2(t),g.abrupt("return",!1);case 5:return t.log(Ks.BuildModelStart,cs.UPDATE),g.next=8,r.prepareLayerModel(t);case 8:return t.log(Ks.BuildModelEnd,cs.UPDATE),g.abrupt("return",!0);case 10:case"end":return g.stop()}},a)}));return function(a){return n.apply(this,arguments)}}())}}]),e}())||A2),p2,d2,M5=(p2=(0,dr.b2)(),p2(d2=function(){function e(){(0,ue.Z)(this,e)}return(0,me.Z)(e,[{key:"apply",value:function(t){t.hooks.afterInit.tap("LayerStylePlugin",function(){var r=t.getLayerConfig(),n=r.autoFit,a=r.fitBoundsOptions;n&&t.fitBounds(a),t.styleNeedUpdate=!1})}}]),e}())||d2),v2,g2,I5=["type"],m2={directional:{lights:"u_DirectionalLights",num:"u_NumOfDirectionalLights"},spot:{lights:"u_SpotLights",num:"u_NumOfSpotLights"}},L5={type:"directional",direction:[1,10.5,12],ambient:[.2,.2,.2],diffuse:[.6,.6,.6],specular:[.1,.1,.1]},P5={direction:[0,0,0],ambient:[0,0,0],diffuse:[0,0,0],specular:[0,0,0]},O5={position:[0,0,0],direction:[0,0,0],ambient:[0,0,0],diffuse:[0,0,0],specular:[0,0,0],constant:1,linear:0,quadratic:0,angle:14,exponent:40,blur:5};function R5(e){var i={u_DirectionalLights:new Array(3).fill((0,X.Z)({},P5)),u_NumOfDirectionalLights:0,u_SpotLights:new Array(3).fill((0,X.Z)({},O5)),u_NumOfSpotLights:0};return(!e||!e.length)&&(e=[L5]),e.forEach(function(t){var r=t.type,n=r===void 0?"directional":r,a=(0,hc.Z)(t,I5),u=m2[n].lights,f=m2[n].num,g=i[f];i[u][g]=(0,X.Z)((0,X.Z)({},i[u][g]),a),i[f]++}),i}var k5=(v2=(0,dr.b2)(),v2(g2=function(){function e(){(0,ue.Z)(this,e)}return(0,me.Z)(e,[{key:"apply",value:function(t){t.hooks.beforeRender.tap("LightingPlugin",function(){var r=t.getLayerConfig(),n=r.enableLighting;n&&t.models.forEach(function(a){return a.addUniforms((0,X.Z)({},R5()))})})}}]),e}())||g2),y2,_2,D5=(y2=(0,dr.b2)(),y2(_2=function(){function e(){(0,ue.Z)(this,e)}return(0,me.Z)(e,[{key:"apply",value:function(t,r){var n=this,a=r.rendererService,u=r.postProcessingPassFactory,f=r.normalPassFactory;t.hooks.init.tapPromise("MultiPassRendererPlugin",function(){var g=t.getLayerConfig(),x=g.enableMultiPassRenderer,I=g.passes,O=I===void 0?[]:I;n.enabled=!!x&&t.getLayerConfig().enableMultiPassRenderer!==!1,n.enabled&&(t.multiPassRenderer=Ry(t,O,u,f),t.multiPassRenderer.setRenderFlag(!0))}),t.hooks.beforeRender.tap("MultiPassRendererPlugin",function(){if(n.enabled){var g=a.getViewportSize(),x=g.width,I=g.height;t.multiPassRenderer.resize(x,I)}})}}]),e}())||_2),x2,E2,tv={NONE:0,ENCODE:1,HIGHLIGHT:2},N5=(x2=(0,dr.b2)(),x2(E2=function(){function e(){(0,ue.Z)(this,e)}return(0,me.Z)(e,[{key:"apply",value:function(t,r){var n=r.styleAttributeService;t.hooks.init.tapPromise("PixelPickingPlugin",function(){var a=t.getLayerConfig(),u=a.enablePicking;n.registerStyleAttribute({name:"pickingColor",type:mn.Attribute,descriptor:{name:"a_PickingColor",buffer:{data:[],type:Ge.FLOAT},size:3,update:function(g){var x=g.id;return u?bs(x):[0,0,0]}}})}),t.hooks.beforePickingEncode.tap("PixelPickingPlugin",function(){var a=t.getLayerConfig(),u=a.enablePicking;u&&t.isVisible()&&t.models.forEach(function(f){return f.addUniforms({u_PickingStage:tv.ENCODE})})}),t.hooks.afterPickingEncode.tap("PixelPickingPlugin",function(){var a=t.getLayerConfig(),u=a.enablePicking;u&&t.isVisible()&&t.models.forEach(function(f){return f.addUniforms({u_PickingStage:tv.HIGHLIGHT})})}),t.hooks.beforeHighlight.tap("PixelPickingPlugin",function(a){var u=t.getLayerConfig(),f=u.highlightColor,g=u.activeMix,x=g===void 0?0:g,I=typeof f=="string"?Ni(f):f||[1,0,0,1];t.updateLayerConfig({pickedFeatureID:io(new Uint8Array(a))}),t.models.forEach(function(O){return O.addUniforms({u_PickingStage:tv.HIGHLIGHT,u_PickingColor:a,u_HighlightColor:I.map(function(B){return B*255}),u_activeMix:x})})}),t.hooks.beforeSelect.tap("PixelPickingPlugin",function(a){var u=t.getLayerConfig(),f=u.selectColor,g=u.selectMix,x=g===void 0?0:g,I=typeof f=="string"?Ni(f):f||[1,0,0,1];t.updateLayerConfig({pickedFeatureID:io(new Uint8Array(a))}),t.models.forEach(function(O){return O.addUniforms({u_PickingStage:tv.HIGHLIGHT,u_PickingColor:a,u_HighlightColor:I.map(function(B){return B*255}),u_activeMix:x,u_CurrentSelectedId:a,u_SelectColor:I.map(function(B){return B*255}),u_EnableSelect:1})})})}}]),e}())||E2),F5=["mvt","geojsonvt","testTile"];function B5(e){var i=e.getSource();return F5.includes(i.parser.type)}function WP(e){return e.getContext?{width:e.width/DOM.DPR,height:e.height/DOM.DPR}:e.getBoundingClientRect()}var b2,S2,Z5=(b2=(0,dr.b2)(),b2(S2=function(){function e(){(0,ue.Z)(this,e)}return(0,me.Z)(e,[{key:"apply",value:function(t,r){var n=this,a=r.styleAttributeService;t.hooks.init.tapPromise("RegisterStyleAttributePlugin",function(){B5(t)||n.registerBuiltinAttributes(a,t)})}},{key:"registerBuiltinAttributes",value:function(t,r){if(r.type==="MaskLayer"){this.registerPositionAttribute(t);return}this.registerPositionAttribute(t),this.registerColorAttribute(t),this.registerVertexIdAttribute(t)}},{key:"registerPositionAttribute",value:function(t){t.registerStyleAttribute({name:"position",type:mn.Attribute,descriptor:{name:"a_Position",buffer:{data:[],type:Ge.FLOAT},size:3,update:function(n,a,u){return u.length===2?[u[0],u[1],0]:[u[0],u[1],u[2]]}}})}},{key:"registerFilterAttribute",value:function(t){t.registerStyleAttribute({name:"filter",type:mn.Attribute,descriptor:{name:"filter",buffer:{usage:Ge.DYNAMIC_DRAW,data:[],type:Ge.FLOAT},size:1,update:function(n){var a=n.filter;return a?[1]:[0]}}})}},{key:"registerColorAttribute",value:function(t){t.registerStyleAttribute({name:"color",type:mn.Attribute,descriptor:{name:"a_Color",buffer:{usage:Ge.DYNAMIC_DRAW,data:[],type:Ge.FLOAT},size:4,update:function(n){var a=n.color;return!a||!a.length?[1,1,1,1]:a}}})}},{key:"registerVertexIdAttribute",value:function(t){t.registerStyleAttribute({name:"vertexId",type:mn.Attribute,descriptor:{name:"a_vertexId",buffer:{usage:Ge.DYNAMIC_DRAW,data:[],type:Ge.FLOAT},size:1,update:function(n,a){return[a]}}})}}]),e}())||S2),C2,w2,T2,M2,I2,L2,pA,P2,O2,R2,k2,z5=(C2=(0,dr.b2)(),w2=(0,dr.f3)(Xt.ICameraService),T2=(0,dr.f3)(Xt.ICoordinateSystemService),M2=(0,dr.f3)(Xt.IRendererService),I2=(0,dr.f3)(Xt.IMapService),C2(L2=(pA=function(){function e(){(0,ue.Z)(this,e),Ki(this,"cameraService",P2,this),Ki(this,"coordinateSystemService",O2,this),Ki(this,"rendererService",R2,this),Ki(this,"mapService",k2,this)}return(0,me.Z)(e,[{key:"apply",value:function(t){var r=this,n=this.mapService.version,a=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],u=[0,0];t.hooks.beforeRender.tap("ShaderUniformPlugin",function(){var f=t.getLayerConfig().tileOrigin;r.coordinateSystemService.refresh(f),n==="GAODE2.x"&&(r.setLayerCenter(t),a=r.mapService.map.customCoords.getMVPMatrix(),u=r.mapService.getCustomCoordCenter());var g=r.rendererService.getViewportSize(),x=g.width,I=g.height;t.models.forEach(function(O){var B;O.addUniforms((B={},(0,Ce.Z)(B,hh.ProjectionMatrix,r.cameraService.getProjectionMatrix()),(0,Ce.Z)(B,hh.ViewMatrix,r.cameraService.getViewMatrix()),(0,Ce.Z)(B,hh.ViewProjectionMatrix,r.cameraService.getViewProjectionMatrix()),(0,Ce.Z)(B,hh.Zoom,r.cameraService.getZoom()),(0,Ce.Z)(B,hh.ZoomScale,r.cameraService.getZoomScale()),(0,Ce.Z)(B,hh.FocalDistance,r.cameraService.getFocalDistance()),(0,Ce.Z)(B,hh.CameraPosition,r.cameraService.getCameraPosition()),(0,Ce.Z)(B,pf.CoordinateSystem,r.coordinateSystemService.getCoordinateSystem()),(0,Ce.Z)(B,pf.ViewportCenter,r.coordinateSystemService.getViewportCenter()),(0,Ce.Z)(B,pf.ViewportCenterProjection,r.coordinateSystemService.getViewportCenterProjection()),(0,Ce.Z)(B,pf.PixelsPerDegree,r.coordinateSystemService.getPixelsPerDegree()),(0,Ce.Z)(B,pf.PixelsPerDegree2,r.coordinateSystemService.getPixelsPerDegree2()),(0,Ce.Z)(B,pf.PixelsPerMeter,r.coordinateSystemService.getPixelsPerMeter()),(0,Ce.Z)(B,pf.Mvp,a),(0,Ce.Z)(B,"u_sceneCenterMercator",u),(0,Ce.Z)(B,"u_ViewportSize",[x,I]),(0,Ce.Z)(B,"u_ModelMatrix",r.cameraService.getModelMatrix()),(0,Ce.Z)(B,"u_DevicePixelRatio",window.devicePixelRatio),(0,Ce.Z)(B,"u_PickingBuffer",t.getLayerConfig().pickingBuffer||0),(0,Ce.Z)(B,"u_shaderPick",Number(t.getShaderPickStat())),B))})})}},{key:"setLayerCenter",value:function(t){t.coordCenter===void 0&&(t.coordCenter=t.getSource().center),this.mapService.setCoordCenter&&this.mapService.setCoordCenter(t.coordCenter)}}]),e}(),P2=Hi(pA.prototype,"cameraService",[w2],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),O2=Hi(pA.prototype,"coordinateSystemService",[T2],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),R2=Hi(pA.prototype,"rendererService",[M2],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),k2=Hi(pA.prototype,"mapService",[I2],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),pA))||L2),D2,N2,U5=(D2=(0,dr.b2)(),D2(N2=function(){function e(){(0,ue.Z)(this,e)}return(0,me.Z)(e,[{key:"apply",value:function(t){t.hooks.beforeRender.tap("UpdateModelPlugin",function(){t.layerModel&&t.layerModel.needUpdate().then(function(r){r&&t.renderLayers()})}),t.hooks.afterRender.tap("UpdateModelPlugin",function(){t.layerModelNeedUpdate=!1})}}]),e}())||N2),F2,B2,G5=(F2=(0,dr.b2)(),F2(B2=function(){function e(){(0,ue.Z)(this,e)}return(0,me.Z)(e,[{key:"apply",value:function(t,r){var n=this,a=r.styleAttributeService;t.hooks.init.tapPromise("UpdateStyleAttributePlugin",function(){n.initStyleAttribute(t,{styleAttributeService:a})}),t.hooks.beforeRender.tap("UpdateStyleAttributePlugin",function(){t.layerModelNeedUpdate||t.inited&&n.updateStyleAttribute(t,{styleAttributeService:a})})}},{key:"updateStyleAttribute",value:function(t,r){var n=r.styleAttributeService,a=n.getLayerStyleAttributes()||[],u=n.getLayerStyleAttribute("filter");if(u&&u.needRegenerateVertices){t.layerModelNeedUpdate=!0,a.forEach(function(f){return f.needRegenerateVertices=!1});return}a.filter(function(f){return f.needRegenerateVertices}).forEach(function(f){n.updateAttributeByFeatureRange(f.name,t.getEncodedData(),f.featureRange.startIndex,f.featureRange.endIndex,t),f.needRegenerateVertices=!1})}},{key:"initStyleAttribute",value:function(t,r){var n=r.styleAttributeService,a=n.getLayerStyleAttributes()||[];a.filter(function(u){return u.needRegenerateVertices}).forEach(function(u){n.updateAttributeByFeatureRange(u.name,t.getEncodedData(),u.featureRange.startIndex,u.featureRange.endIndex),u.needRegenerateVertices=!1})}}]),e}())||B2);ql.bind(Xt.ILayerPlugin).to(W4).inRequestScope(),ql.bind(Xt.ILayerPlugin).to(Z5).inRequestScope(),ql.bind(Xt.ILayerPlugin).to(pI).inRequestScope(),ql.bind(Xt.ILayerPlugin).to($4).inRequestScope(),ql.bind(Xt.ILayerPlugin).to(M5).inRequestScope(),ql.bind(Xt.ILayerPlugin).to(vI).inRequestScope(),ql.bind(Xt.ILayerPlugin).to(G5).inRequestScope(),ql.bind(Xt.ILayerPlugin).to(U5).inRequestScope(),ql.bind(Xt.ILayerPlugin).to(D5).inRequestScope(),ql.bind(Xt.ILayerPlugin).to(z5).inRequestScope(),ql.bind(Xt.ILayerPlugin).to(dI).inRequestScope(),ql.bind(Xt.ILayerPlugin).to(k5).inRequestScope(),ql.bind(Xt.ILayerPlugin).to(N5).inRequestScope(),ql.bind(Xt.ILayerPlugin).to(T5).inRequestScope();var Z2,zg,z2,j5=(Z2=tg(Xt.IGlobalConfigService),zg=function(){function e(i){(0,ue.Z)(this,e),Ki(this,"configService",z2,this),this.config=i}return(0,me.Z)(e,[{key:"setContainer",value:function(t,r,n,a){t.bind(Xt.MapConfig).toConstantValue((0,X.Z)((0,X.Z)({},this.config),{},{id:r,canvas:n,hasBaseMap:a})),t.bind(Xt.IMapService).to(this.getServiceConstructor()).inSingletonScope()}},{key:"getServiceConstructor",value:function(){throw new Error("Method not implemented.")}}]),e}(),z2=Hi(zg.prototype,"configService",[Z2],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),zg),V5=C(95906),U2=C.n(V5);function Ip(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function rv(e,i){var t=rh([],i,e);return Bh(t,t,1/t[3]),t}function YP(e,i){var t=e%i;return t<0?i+t:t}function XP(e,i,t){return t*i+(1-t)*e}function mh(e,i){if(!e)throw new Error(i||"viewport-mercator-project: assertion failed.")}var df=Math.PI,G2=df/4,t0=df/180,j2=180/df,Ug=512,Gg=4003e4,H5=1.5;function V2(e){return Math.pow(2,e)}function $5(e){return Math.log2(e)}function nv(e,i){var t=(0,vn.Z)(e,2),r=t[0],n=t[1];mh(Number.isFinite(r)&&Number.isFinite(i)),mh(Number.isFinite(n)&&n>=-90&&n<=90,"invalid latitude"),i*=Ug;var a=r*t0,u=n*t0,f=i*(a+df)/(2*df),g=i*(df-Math.log(Math.tan(G2+u*.5)))/(2*df);return[f,g]}function jg(e,i){var t=(0,vn.Z)(e,2),r=t[0],n=t[1];i*=Ug;var a=r/i*(2*df)-df,u=2*(Math.atan(Math.exp(df-n/i*(2*df)))-G2);return[a*j2,u*j2]}function QP(e){var i=e.latitude;assert(Number.isFinite(i));var t=Math.cos(i*t0);return $5(Gg*t)-9}function H2(e){var i=e.latitude,t=e.longitude,r=e.zoom,n=e.scale,a=e.highPrecision,u=a===void 0?!1:a;n=n!==void 0?n:V2(r),mh(Number.isFinite(i)&&Number.isFinite(t)&&Number.isFinite(n));var f={},g=Ug*n,x=Math.cos(i*t0),I=g/360,O=I/x,B=g/Gg/x;if(f.pixelsPerMeter=[B,-B,B],f.metersPerPixel=[1/B,-1/B,1/B],f.pixelsPerDegree=[I,-O,B],f.degreesPerPixel=[1/I,-1/O,1/B],u){var W=t0*Math.tan(i*t0)/x,he=I*W/2,ae=g/Gg*W,Se=ae/O*B;f.pixelsPerDegree2=[0,-he,ae],f.pixelsPerMeter2=[Se,0,Se]}return f}function qP(e,i){var t=_slicedToArray(e,3),r=t[0],n=t[1],a=t[2],u=_slicedToArray(i,3),f=u[0],g=u[1],x=u[2],I=1,O=H2({longitude:r,latitude:n,scale:I,highPrecision:!0}),B=O.pixelsPerMeter,W=O.pixelsPerMeter2,he=nv(e,I);he[0]+=f*(B[0]+W[0]*g),he[1]+=g*(B[1]+W[1]*g);var ae=jg(he,I),Se=(a||0)+(x||0);return Number.isFinite(a)||Number.isFinite(x)?[ae[0],ae[1],Se]:ae}function W5(e){var i=e.height,t=e.pitch,r=e.bearing,n=e.altitude,a=e.center,u=a===void 0?null:a,f=e.flipY,g=f===void 0?!1:f,x=Ip();return qs(x,x,[0,0,-n]),So(x,x,[1,1,1/i]),cc(x,x,-t*t0),q0(x,x,r*t0),g&&So(x,x,[1,-1,1]),u&&qs(x,x,Ky([],u)),x}function Y5(e){var i=e.width,t=e.height,r=e.altitude,n=r===void 0?H5:r,a=e.pitch,u=a===void 0?0:a,f=e.nearZMultiplier,g=f===void 0?1:f,x=e.farZMultiplier,I=x===void 0?1:x,O=u*t0,B=Math.atan(.5/n),W=Math.sin(B)*n/Math.sin(Math.PI/2-O-B),he=Math.cos(Math.PI/2-O)*W+n;return{fov:2*Math.atan(t/2/n),aspect:i/t,focalDistance:n,near:g,far:he*I}}function X5(e){var i=e.width,t=e.height,r=e.pitch,n=e.altitude,a=e.nearZMultiplier,u=e.farZMultiplier,f=Y5({width:i,height:t,altitude:n,pitch:r,nearZMultiplier:a,farZMultiplier:u}),g=f.fov,x=f.aspect,I=f.near,O=f.far,B=Xf([],g,x,I,O);return B}function Q5(e,i){var t=(0,vn.Z)(e,3),r=t[0],n=t[1],a=t[2],u=a===void 0?0:a;return mh(Number.isFinite(r)&&Number.isFinite(n)&&Number.isFinite(u)),rv(i,[r,n,u,1])}function $2(e,i){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,r=(0,vn.Z)(e,3),n=r[0],a=r[1],u=r[2];if(mh(Number.isFinite(n)&&Number.isFinite(a),"invalid pixel coordinate"),Number.isFinite(u)){var f=rv(i,[n,a,u,1]);return f}var g=rv(i,[n,a,0,1]),x=rv(i,[n,a,1,1]),I=g[2],O=x[2],B=I===O?0:((t||0)-I)/(O-I);return Sl([],g,x,B)}var W2=Ip(),q5=function(){function e(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=i.width,r=i.height,n=i.viewMatrix,a=n===void 0?W2:n,u=i.projectionMatrix,f=u===void 0?W2:u;(0,ue.Z)(this,e),this.width=t||1,this.height=r||1,this.scale=1,this.pixelsPerMeter=1,this.viewMatrix=a,this.projectionMatrix=f;var g=Ip();Ga(g,g,this.projectionMatrix),Ga(g,g,this.viewMatrix),this.viewProjectionMatrix=g;var x=Ip();So(x,x,[this.width/2,-this.height/2,1]),qs(x,x,[1,-1,0]),Ga(x,x,this.viewProjectionMatrix);var I=kp(Ip(),x);if(!I)throw new Error("Pixel project matrix not invertible");this.pixelProjectionMatrix=x,this.pixelUnprojectionMatrix=I,this.equals=this.equals.bind(this),this.project=this.project.bind(this),this.unproject=this.unproject.bind(this),this.projectPosition=this.projectPosition.bind(this),this.unprojectPosition=this.unprojectPosition.bind(this),this.projectFlat=this.projectFlat.bind(this),this.unprojectFlat=this.unprojectFlat.bind(this)}return(0,me.Z)(e,[{key:"equals",value:function(t){return t instanceof e?t.width===this.width&&t.height===this.height&&gu(t.projectionMatrix,this.projectionMatrix)&&gu(t.viewMatrix,this.viewMatrix):!1}},{key:"project",value:function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=r.topLeft,a=n===void 0?!0:n,u=this.projectPosition(t),f=Q5(u,this.pixelProjectionMatrix),g=(0,vn.Z)(f,2),x=g[0],I=g[1],O=a?I:this.height-I;return t.length===2?[x,O]:[x,O,f[2]]}},{key:"unproject",value:function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=r.topLeft,a=n===void 0?!0:n,u=r.targetZ,f=(0,vn.Z)(t,3),g=f[0],x=f[1],I=f[2],O=a?x:this.height-x,B=u&&u*this.pixelsPerMeter,W=$2([g,O,I],this.pixelUnprojectionMatrix,B),he=this.unprojectPosition(W),ae=(0,vn.Z)(he,3),Se=ae[0],Fe=ae[1],Qe=ae[2];return Number.isFinite(I)?[Se,Fe,Qe]:Number.isFinite(u)?[Se,Fe,u]:[Se,Fe]}},{key:"projectPosition",value:function(t){var r=this.projectFlat(t),n=(0,vn.Z)(r,2),a=n[0],u=n[1],f=(t[2]||0)*this.pixelsPerMeter;return[a,u,f]}},{key:"unprojectPosition",value:function(t){var r=this.unprojectFlat(t),n=(0,vn.Z)(r,2),a=n[0],u=n[1],f=(t[2]||0)/this.pixelsPerMeter;return[a,u,f]}},{key:"projectFlat",value:function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.scale;return t}},{key:"unprojectFlat",value:function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.scale;return t}}]),e}();function K5(e){var i=e.width,t=e.height,r=e.bounds,n=e.minExtent,a=n===void 0?0:n,u=e.maxZoom,f=u===void 0?24:u,g=e.padding,x=g===void 0?0:g,I=e.offset,O=I===void 0?[0,0]:I,B=(0,vn.Z)(r,2),W=(0,vn.Z)(B[0],2),he=W[0],ae=W[1],Se=(0,vn.Z)(B[1],2),Fe=Se[0],Qe=Se[1];if(Number.isFinite(x)){var qe=x;x={top:qe,bottom:qe,left:qe,right:qe}}else mh(Number.isFinite(x.top)&&Number.isFinite(x.bottom)&&Number.isFinite(x.left)&&Number.isFinite(x.right));var yt=new Y2({width:i,height:t,longitude:0,latitude:0,zoom:0}),Et=yt.project([he,Qe]),Ot=yt.project([Fe,ae]),jt=[Math.max(Math.abs(Ot[0]-Et[0]),a),Math.max(Math.abs(Ot[1]-Et[1]),a)],or=[i-x.left-x.right-Math.abs(O[0])*2,t-x.top-x.bottom-Math.abs(O[1])*2];mh(or[0]>0&&or[1]>0);var ar=or[0]/jt[0],br=or[1]/jt[1],pr=(x.right-x.left)/2/ar,jr=(x.bottom-x.top)/2/br,nn=[(Ot[0]+Et[0])/2+pr,(Ot[1]+Et[1])/2+jr],yn=yt.unproject(nn),ma=yt.zoom+Math.log2(Math.abs(Math.min(ar,br)));return{longitude:yn[0],latitude:yn[1],zoom:Math.min(ma,f)}}var Y2=function(e){(0,ke.Z)(i,e);function i(){var t,r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=r.width,a=r.height,u=r.latitude,f=u===void 0?0:u,g=r.longitude,x=g===void 0?0:g,I=r.zoom,O=I===void 0?0:I,B=r.pitch,W=B===void 0?0:B,he=r.bearing,ae=he===void 0?0:he,Se=r.altitude,Fe=Se===void 0?1.5:Se,Qe=r.nearZMultiplier,qe=r.farZMultiplier;(0,ue.Z)(this,i),n=n||1,a=a||1;var yt=V2(O);Fe=Math.max(.75,Fe);var Et=nv([x,f],yt);Et[2]=0;var Ot=X5({width:n,height:a,pitch:W,bearing:ae,altitude:Fe,nearZMultiplier:Qe||1/a,farZMultiplier:qe||1.01}),jt=W5({height:a,center:Et,pitch:W,bearing:ae,altitude:Fe,flipY:!0});return t=(0,Ze.Z)(this,(0,oe.Z)(i).call(this,{width:n,height:a,viewMatrix:jt,projectionMatrix:Ot})),t.latitude=f,t.longitude=x,t.zoom=O,t.pitch=W,t.bearing=ae,t.altitude=Fe,t.scale=yt,t.center=Et,t.pixelsPerMeter=H2((0,bt.Z)((0,bt.Z)(t))).pixelsPerMeter[2],Object.freeze((0,bt.Z)((0,bt.Z)(t))),t}return(0,me.Z)(i,[{key:"projectFlat",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.scale;return nv(r,n)}},{key:"unprojectFlat",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.scale;return jg(r,n)}},{key:"getMapCenterByLngLatPosition",value:function(r){var n=r.lngLat,a=r.pos,u=$2(a,this.pixelUnprojectionMatrix),f=nv(n,this.scale),g=oo([],f,Tu([],u)),x=oo([],this.center,g);return jg(x,this.scale)}},{key:"getLocationAtPoint",value:function(r){var n=r.lngLat,a=r.pos;return this.getMapCenterByLngLatPosition({lngLat:n,pos:a})}},{key:"fitBounds",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},a=this.width,u=this.height,f=K5(Object.assign({width:a,height:u,bounds:r},n)),g=f.longitude,x=f.latitude,I=f.zoom;return new i({width:a,height:u,longitude:g,latitude:x,zoom:I})}}]),i}(q5),J5=function(){function e(){(0,ue.Z)(this,e)}return(0,me.Z)(e,[{key:"syncWithMapCamera",value:function(t){var r=t.center,n=t.zoom,a=t.pitch,u=t.bearing,f=t.viewportHeight,g=t.viewportWidth,x=this.viewport?{width:this.viewport.width,height:this.viewport.height,longitude:this.viewport.center[0],latitude:this.viewport.center[1],zoom:this.viewport.zoom,pitch:this.viewport.pitch,bearing:this.viewport.bearing}:{};this.viewport=new Y2((0,X.Z)((0,X.Z)({},x),{},{width:g,height:f,longitude:r&&r[0],latitude:r&&r[1],zoom:n,pitch:a,bearing:u}))}},{key:"getZoom",value:function(){return this.viewport.zoom}},{key:"getZoomScale",value:function(){return Math.pow(2,this.getZoom())}},{key:"getCenter",value:function(){return[this.viewport.longitude,this.viewport.latitude]}},{key:"getProjectionMatrix",value:function(){return this.viewport.projectionMatrix}},{key:"getModelMatrix",value:function(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}},{key:"getViewMatrix",value:function(){return this.viewport.viewMatrix}},{key:"getViewMatrixUncentered",value:function(){return this.viewport.viewMatrixUncentered}},{key:"getViewProjectionMatrix",value:function(){return this.viewport.viewProjectionMatrix}},{key:"getViewProjectionMatrixUncentered",value:function(){return this.viewport.viewProjectionMatrix}},{key:"getFocalDistance",value:function(){return 1}},{key:"projectFlat",value:function(t,r){return this.viewport.projectFlat(t,r)}}]),e}(),e6=function(){function e(i){(0,ue.Z)(this,e),(0,Ce.Z)(this,"size",1e4),this.size=i||1e4}return(0,me.Z)(e,[{key:"setSize",value:function(t){this.size=t}},{key:"getSize",value:function(){return[this.size,this.size]}},{key:"mercatorXfromLng",value:function(t){return(180+t)/360*this.size}},{key:"mercatorYfromLat",value:function(t){return(1-(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+t*Math.PI/360)))/360)*this.size}},{key:"lngFromMercatorX",value:function(t){return t/this.size*360-180}},{key:"latFromMercatorY",value:function(t){var r=180-(1-t/this.size)*360;return 360/Math.PI*Math.atan(Math.exp(r*Math.PI/180))-90}},{key:"project",value:function(t){var r=this.mercatorXfromLng(t[0]),n=this.mercatorYfromLat(t[1]);return[r,n]}},{key:"unproject",value:function(t){var r=this.lngFromMercatorX(t[0]),n=this.latFromMercatorY(t[1]);return[r,n]}}]),e}();function X2(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},i={top:0,right:0,bottom:0,left:0};if(typeof e=="number")return{top:e,right:e,bottom:e,left:e};if(Array.isArray(e)){if(e.length===4)return{top:e[0],right:e[1],bottom:e[2],left:e[3]};if(e.length===2)return{top:e[0],right:e[1],bottom:e[0],left:e[1]}}return(0,X.Z)((0,X.Z)({},i),e)}var t6={normal:"amap://styles/normal",light:"amap://styles/c422f5c0cfced5be9fe3a83f05f28a68?isPublic=true",dark:"amap://styles/c9f1d10cae34f8ab05e425462c5a58d7?isPublic=true",blank:"amap://styles/07c17002b38775b32a7a76c66cf90e99?isPublic=true",fresh:"amap://styles/fresh",grey:"amap://styles/grey",graffiti:"amap://styles/graffiti",macaron:"amap://styles/macaron",darkblue:"amap://styles/darkblue",wine:"amap://styles/wine"},r6=["id","style","minZoom","maxZoom","token","mapInstance","plugin"],Q2,q2,K2,J2,ex,tx,dA,rx,nx,ix,ax;function n6(e,i){var t=typeof my!="undefined"&&!!my&&typeof my.showToast=="function"&&my.isFRM!==!0,r=typeof wx!="undefined"&&wx!==null&&(typeof wx.request!="undefined"||typeof wx.miniProgram!="undefined");if(!(t||r)&&(i||(i=document),!!i)){var n=i.head||i.getElementsByTagName("head")[0];if(!n){n=i.createElement("head");var a=i.body||i.getElementsByTagName("body")[0];a?a.parentNode.insertBefore(n,a):i.documentElement.appendChild(n)}var u=i.createElement("style");return u.type="text/css",u.styleSheet?u.styleSheet.cssText=e:u.appendChild(i.createTextNode(e)),n.appendChild(u),u}}n6(`.amap-logo{
 display: none !important;
}
`);var i6={contextmenu:"rightclick"},a6={contextmenu:"rightclick",camerachange:"viewchange"},ox={"GAODE1.x":i6,"GAODE2.x":a6},o6=0;window.forceWebGL=!0;var sx="15cd8a57710d40c9b7c0e3cc120f1200",s6="1.4.15",u6="amap-script",Vg=!1,iv=[],l6=12,c6=(Q2=(0,dr.b2)(),q2=(0,dr.f3)(Xt.IGlobalConfigService),K2=(0,dr.f3)(Xt.MapConfig),J2=(0,dr.f3)(Xt.ICoordinateSystemService),ex=(0,dr.f3)(Xt.IEventEmitter),Q2(tx=(dA=function(){function e(){var i=this;(0,ue.Z)(this,e),(0,Ce.Z)(this,"version",bu["GAODE1.x"]),(0,Ce.Z)(this,"simpleMapCoord",new e6),(0,Ce.Z)(this,"bgColor","rgba(0, 0, 0, 0)"),Ki(this,"configService",rx,this),Ki(this,"config",nx,this),Ki(this,"coordinateSystemService",ix,this),Ki(this,"eventEmitter",ax,this),(0,Ce.Z)(this,"handleCameraChanged",function(t){var r=t.camera,n=r.fov,a=r.near,u=r.far,f=r.height,g=r.pitch,x=r.rotation,I=r.aspect,O=r.position,B=i.getCenter(),W=B.lng,he=B.lat;if(i.emit("mapchange"),i.cameraChangedCallback){i.viewport.syncWithMapCamera({aspect:I,bearing:360-x,far:u,fov:n,cameraHeight:f,near:a,pitch:g,zoom:i.map.getZoom()-1,center:[W,he],offsetOrigin:[O.x,O.y]});var ae=i.config.offsetZoom,Se=ae===void 0?l6:ae;i.viewport.getZoom()>Se?i.coordinateSystemService.setCoordinateSystem(Fc.P20_OFFSET):i.coordinateSystemService.setCoordinateSystem(Fc.P20),i.cameraChangedCallback(i.viewport)}})}return(0,me.Z)(e,[{key:"setBgColor",value:function(t){this.bgColor=t}},{key:"addMarkerContainer",value:function(){var t=this.map.getContainer();if(t!==null){var r=t.getElementsByClassName("amap-maps")[0];this.markerContainer=ci("div","l7-marker-container",r)}}},{key:"getMarkerContainer",value:function(){return this.markerContainer}},{key:"on",value:function(t,r){vy.indexOf(t)!==-1?this.eventEmitter.on(t,r):this.map.on(ox[this.version][t]||t,r)}},{key:"off",value:function(t,r){vy.indexOf(t)!==-1?this.eventEmitter.off(t,r):this.map.off(ox[this.version][t]||t,r)}},{key:"getContainer",value:function(){return this.map.getContainer()}},{key:"getMapCanvasContainer",value:function(){var t;return(t=this.map.getContainer())===null||t===void 0?void 0:t.getElementsByClassName("amap-maps")[0]}},{key:"getSize",value:function(){var t=this.map.getSize();return[t.getWidth(),t.getHeight()]}},{key:"getType",value:function(){return"amap"}},{key:"getZoom",value:function(){return this.map.getZoom()-1}},{key:"setZoom",value:function(t){return this.map.setZoom(t+1)}},{key:"getCenter",value:function(t){if(t!=null&&t.padding){var r=this.getCenter(),n=X2(t.padding),a=this.lngLatToPixel([r.lng,r.lat]),u=[(n.right-n.left)/2,(n.bottom-n.top)/2],f=this.pixelToLngLat([a.x-u[0],a.y-u[1]]);return f}var g=this.map.getCenter();return{lng:g.getLng(),lat:g.getLat()}}},{key:"setCenter",value:function(t,r){if(r!=null&&r.padding){var n=X2(r.padding),a=this.lngLatToPixel(t),u=[(n.right-n.left)/2,(n.bottom-n.top)/2],f=this.pixelToLngLat([a.x+u[0],a.y+u[1]]);this.map.setCenter([f.lng,f.lat])}else this.map.setCenter(t)}},{key:"getPitch",value:function(){return this.map.getPitch()}},{key:"getRotation",value:function(){return 360-this.map.getRotation()}},{key:"getBounds",value:function(){var t=this.map.getBounds().toBounds(),r=t.getNorthEast(),n=t.getSouthWest(),a=this.getCenter(),u=a.lng>r.getLng()||a.lng<n.getLng()?180-r.getLng():r.getLng(),f=a.lng<n.getLng()?n.getLng()-180:n.getLng();return[[f,n.getLat()],[u,r.getLat()]]}},{key:"getMinZoom",value:function(){var t=this.map.get("zooms");return t[0]-1}},{key:"getMaxZoom",value:function(){var t=this.map.get("zooms");return t[1]-1}},{key:"setRotation",value:function(t){return this.map.setRotation(t)}},{key:"setPitch",value:function(t){return this.map.setPitch(t)}},{key:"zoomIn",value:function(){this.map.zoomIn()}},{key:"zoomOut",value:function(){this.map.zoomOut()}},{key:"panTo",value:function(t){this.map.panTo(t)}},{key:"panBy",value:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;this.map.panBy(t,r)}},{key:"fitBounds",value:function(t){this.map.setBounds(new AMap.Bounds([t[0][0],t[0][1],t[1][0],t[1][1]]))}},{key:"setZoomAndCenter",value:function(t,r){this.map.setZoomAndCenter(t+1,r)}},{key:"setMapStyle",value:function(t){this.map.setMapStyle(this.getMapStyleValue(t))}},{key:"setMapStatus",value:function(t){this.map.setStatus(t)}},{key:"getMapStyleConfig",value:function(){return t6}},{key:"getMapStyleValue",value:function(t){return this.getMapStyleConfig()[t]||t}},{key:"getMapStyle",value:function(){return this.map.getMapStyle()}},{key:"pixelToLngLat",value:function(t){var r=this.map.pixelToLngLat(new AMap.Pixel(t[0],t[1]));return{lng:r.getLng(),lat:r.getLat()}}},{key:"lngLatToPixel",value:function(t){var r=this.map.lnglatToPixel(new AMap.LngLat(t[0],t[1]));return{x:r.getX(),y:r.getY()}}},{key:"containerToLngLat",value:function(t){var r=new AMap.Pixel(t[0],t[1]),n=this.map.containerToLngLat(r);return{lng:n==null?void 0:n.getLng(),lat:n==null?void 0:n.getLat()}}},{key:"lngLatToContainer",value:function(t){var r=new AMap.LngLat(t[0],t[1]),n=this.map.lngLatToContainer(r);return{x:n.getX(),y:n.getY()}}},{key:"lngLatToCoord",value:function(t){var r=this.map.lngLatToGeodeticCoord(t),n=r.x,a=r.y;return[n,-a]}},{key:"lngLatToMercator",value:function(t,r){return{x:0,y:0,z:0}}},{key:"getModelMatrix",value:function(t,r,n){var a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:[1,1,1],u=this.viewport.projectFlat(t),f=Qn();return qs(f,f,Lu(u[0],u[1],r)),So(f,f,Lu(a[0],a[1],a[2])),cc(f,f,n[0]),Q0(f,f,n[1]),q0(f,f,n[2]),f}},{key:"init",value:function(){var i=(0,ur.Z)(nt().mark(function r(){var n=this,a,u,f,g,x,I,O,B,W,he,ae,Se,Fe,Qe;return nt().wrap(function(yt){for(;;)switch(yt.prev=yt.next){case 0:return a=this.config,u=a.id,f=a.style,g=f===void 0?"light":f,x=a.minZoom,I=x===void 0?0:x,O=a.maxZoom,B=O===void 0?18:O,W=a.token,he=W===void 0?sx:W,ae=a.mapInstance,Se=a.plugin,Fe=Se===void 0?[]:Se,Qe=(0,hc.Z)(a,r6),yt.next=3,new Promise(function(Et){var Ot=function(){if(ae)n.map=ae,n.$mapContainer=n.map.getContainer(),setTimeout(function(){n.map.on("camerachange",n.handleCameraChanged),Et()},30);else{n.$mapContainer=n.creatMapContainer(u);var or=(0,X.Z)({mapStyle:n.getMapStyleValue(g),zooms:[I,B],viewMode:"3D"},Qe);or.zoom&&(or.zoom+=1);var ar=new AMap.Map(n.$mapContainer,or);ar.on("camerachange",n.handleCameraChanged),ar.on("camerachange",function(){setTimeout(function(){return n.handleAfterMapChange()})}),n.map=ar,setTimeout(function(){Et()},10)}};!Vg&&!ae?(he===sx&&console.warn("%c".concat(n.configService.getSceneWarninfo("MapToken"),"!"),"color: #873bf4;font-weigh:900;font-size: 16px;"),Vg=!0,Fe.push("Map3D"),U2().load({key:he,version:s6,plugins:Fe}).then(function(){Ot(),iv.length&&(iv.forEach(function(jt){return jt()}),iv=[])}).catch(function(jt){throw new Error(jt)})):Vg&&window.AMap||ae?Ot():iv.push(Ot)});case 3:this.viewport=new J5;case 4:case"end":return yt.stop()}},r,this)}));function t(){return i.apply(this,arguments)}return t}()},{key:"meterToCoord",value:function(t,r){var n=AMap.GeometryUtil.distance(Ut(AMap.LngLat,(0,Mr.Z)(t)),Ut(AMap.LngLat,(0,Mr.Z)(r))),a=this.lngLatToCoord(t),u=(0,vn.Z)(a,2),f=u[0],g=u[1],x=this.lngLatToCoord(r),I=(0,vn.Z)(x,2),O=I[0],B=I[1],W=Math.sqrt(Math.pow(f-O,2)+Math.pow(g-B,2));return W/n}},{key:"updateView",value:function(t){}},{key:"getOverlayContainer",value:function(){}},{key:"exportMap",value:function(t){var r,n=(r=this.getContainer())===null||r===void 0?void 0:r.getElementsByClassName("amap-layer")[0],a=t==="jpg"?n==null?void 0:n.toDataURL("image/jpeg"):n==null?void 0:n.toDataURL("image/png");return a}},{key:"emit",value:function(t){for(var r,n=arguments.length,a=new Array(n>1?n-1:0),u=1;u<n;u++)a[u-1]=arguments[u];(r=this.eventEmitter).emit.apply(r,[t].concat(a))}},{key:"once",value:function(t){for(var r,n=arguments.length,a=new Array(n>1?n-1:0),u=1;u<n;u++)a[u-1]=arguments[u];(r=this.eventEmitter).once.apply(r,[t].concat(a))}},{key:"destroy",value:function(){var t,r;(t=this.$mapContainer)===null||t===void 0||(r=t.parentNode)===null||r===void 0||r.removeChild(this.$mapContainer),delete window.initAMap;var n=document.getElementById(u6);n&&document.head.removeChild(n),this.map.destroy()}},{key:"getMapContainer",value:function(){return this.$mapContainer}},{key:"onCameraChanged",value:function(t){this.cameraChangedCallback=t}},{key:"handleAfterMapChange",value:function(){this.emit("mapAfterFrameChange")}},{key:"creatMapContainer",value:function(t){var r=t;typeof t=="string"&&(r=document.getElementById(t));var n=document.createElement("div");return n.style.cssText+=`
       position: absolute;
       top: 0;
       height: 100%;
       width: 100%;
     `,n.id="l7_amap_div"+o6++,r.appendChild(n),n}}]),e}(),rx=Hi(dA.prototype,"configService",[q2],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),nx=Hi(dA.prototype,"config",[K2],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ix=Hi(dA.prototype,"coordinateSystemService",[J2],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ax=Hi(dA.prototype,"eventEmitter",[ex],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),dA))||tx),f6=function(){function e(){(0,ue.Z)(this,e),(0,Ce.Z)(this,"projectionMatrix",Qn()),(0,Ce.Z)(this,"viewMatrix",Qn()),(0,Ce.Z)(this,"viewProjectionMatrix",Qn()),(0,Ce.Z)(this,"ViewProjectionMatrixUncentered",Qn()),(0,Ce.Z)(this,"viewUncenteredMatrix",Qn())}return(0,me.Z)(e,[{key:"syncWithMapCamera",value:function(t){var r=t.zoom,n=r===void 0?1:r,a=t.center,u=a===void 0?[0,0]:a,f=t.offsetOrigin,g=f===void 0?[0,0]:f,x=t.cameraPosition,I=x===void 0?[0,0,0]:x,O=t.up,B=O===void 0?[0,1,0]:O,W=t.lookAt,he=W===void 0?[0,0,0]:W,ae=t.aspect,Se=ae===void 0?1:ae,Fe=t.near,Qe=Fe===void 0?.1:Fe,qe=t.far,yt=qe===void 0?1e3:qe,Et=t.fov,Ot=Et===void 0?45:Et;this.zoom=n,this.center=u,Xf(this.projectionMatrix,Ot/180*Math.PI,Se,Qe,yt);var jt=Lu.apply(D,(0,Mr.Z)(I)),or=Lu.apply(D,(0,Mr.Z)(he)),ar=Lu.apply(D,(0,Mr.Z)(B));eh(this.viewMatrix,jt,or,ar),this.viewUncenteredMatrix=Xa(this.viewMatrix),qs(this.viewMatrix,this.viewMatrix,Lu(-g[0],g[1],0)),Ga(this.viewProjectionMatrix,this.projectionMatrix,this.viewMatrix),Ga(this.ViewProjectionMatrixUncentered,this.projectionMatrix,this.viewMatrix)}},{key:"getZoom",value:function(){return this.zoom}},{key:"getZoomScale",value:function(){return 1048576}},{key:"getCenter",value:function(){var t=(0,vn.Z)(this.center,2),r=t[0],n=t[1];return[r,n]}},{key:"getProjectionMatrix",value:function(){return this.projectionMatrix}},{key:"getModelMatrix",value:function(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}},{key:"getViewMatrix",value:function(){return this.viewMatrix}},{key:"getViewMatrixUncentered",value:function(){return this.viewUncenteredMatrix}},{key:"getViewProjectionMatrix",value:function(){return this.viewProjectionMatrix}},{key:"getViewProjectionMatrixUncentered",value:function(){return this.ViewProjectionMatrixUncentered}},{key:"getFocalDistance",value:function(){return 1.2}},{key:"projectFlat",value:function(t){var r=85.0511287798,n=Math.max(Math.min(r,t[1]),-r),a=256<<20,u=Math.PI/180,f=t[0]*u,g=n*u;g=Math.log(Math.tan(Math.PI/4+g/2));var x=.5/Math.PI,I=.5,O=-.5/Math.PI;return u=.5,f=a*(x*f+I)-215440491,g=-(a*(O*g+u)-106744817),[f,g]}}]),e}(),h6=["id","style","minZoom","maxZoom","token","mapInstance","plugin","version"],ux,lx;function A6(e){var i=p6();return function(){var r=(0,oe.Z)(e),n;if(i){var a=(0,oe.Z)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return(0,Ze.Z)(this,n)}}function p6(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}function d6(e,i){var t=typeof my!="undefined"&&!!my&&typeof my.showToast=="function"&&my.isFRM!==!0,r=typeof wx!="undefined"&&wx!==null&&(typeof wx.request!="undefined"||typeof wx.miniProgram!="undefined");if(!(t||r)&&(i||(i=document),!!i)){var n=i.head||i.getElementsByTagName("head")[0];if(!n){n=i.createElement("head");var a=i.body||i.getElementsByTagName("body")[0];a?a.parentNode.insertBefore(n,a):i.documentElement.appendChild(n)}var u=i.createElement("style");return u.type="text/css",u.styleSheet?u.styleSheet.cssText=e:u.appendChild(i.createTextNode(e)),n.appendChild(u),u}}d6(`.amap-logo{
 display: none !important;
}
`);var cx=[108.92361,34.54083];window.forceWebGL=!0;var fx="f59bcf249433f8b05caaee19f349b3d7",hx="2.0",KP=!1,JP=null,v6=(ux=(0,dr.b2)(),ux(lx=function(e){(0,ke.Z)(t,e);var i=A6(t);function t(){var r;(0,ue.Z)(this,t);for(var n=arguments.length,a=new Array(n),u=0;u<n;u++)a[u]=arguments[u];return r=i.call.apply(i,[this].concat(a)),(0,Ce.Z)((0,bt.Z)(r),"version","GAODE2.x"),(0,Ce.Z)((0,bt.Z)(r),"handleViewChanged",function(f){var g=r.map.customCoords.getCameraParams(),x=g.fov,I=g.near,O=g.far,B=g.aspect,W=g.position,he=g.lookAt,ae=g.up;r.emit("mapchange");var Se=r.map.customCoords.getCenter();r.cameraChangedCallback&&(r.viewport.syncWithMapCamera({aspect:B,far:O,fov:x,cameraPosition:W,lookAt:he,up:ae,near:I,zoom:r.map.getZoom()-1,center:Se,offsetOrigin:[W[0],W[1]]}),r.coordinateSystemService.setCoordinateSystem(Fc.P20_2),r.cameraChangedCallback(r.viewport))}),r}return(0,me.Z)(t,[{key:"setCustomCoordCenter",value:function(n){this.sceneCenter=n,this.sceneCenterMercator=Ms.apply(void 0,(0,Mr.Z)(n))}},{key:"getCustomCoordCenter",value:function(){return this.sceneCenterMercator}},{key:"lngLatToCoordByLayer",value:function(n,a){var u=a||this.sceneCenterMercator,f=this._sub(Ms(n[0],n[1]),u);return n[2]&&f.push(n[2]),f}},{key:"coordToAMap2RelativeCoordinates",value:function(n,a){var u=this,f=Ms(a[0],a[1]);return typeof n[0]=="number"?this.lngLatToCoordByLayer(n,f):n.map(function(g){return Array.isArray(g)&&typeof g[0]=="number"?u.lngLatToCoordByLayer(g,f):g.map(function(x){return u.lngLatToCoordByLayer(x,f)})})}},{key:"setCoordCenter",value:function(n){this.map.customCoords.setCenter(n||cx),this.setCustomCoordCenter(n||cx)}},{key:"lngLatToCoord",value:function(n){return this.sceneCenter||(this.map.customCoords.setCenter(n),this.setCustomCoordCenter(n)),this._sub(Ms(n[0],n[1]),this.sceneCenterMercator)}},{key:"lngLatToCoords",value:function(n){var a=this;return n.map(function(u){return typeof u[0]=="number"?a.lngLatToCoord(u):u.map(function(f){return a.lngLatToCoord(f)})})}},{key:"addMarkerContainer",value:function(){if(this.map){var n=this.map.getContainer();if(n!==null){var a=n.getElementsByClassName("amap-maps")[0];a.style.zIndex="auto",this.markerContainer=ci("div","l7-marker-container2",a)}}}},{key:"updateView",value:function(n){}},{key:"getOverlayContainer",value:function(){}},{key:"getType",value:function(){return"amap2"}},{key:"getBounds",value:function(){var n=this.map.getBounds(),a=n.getNorthEast(),u=n.getSouthWest(),f=this.getCenter(),g=f.lng>a.getLng()||f.lng<u.getLng()?180-a.getLng():a.getLng(),x=f.lng<u.getLng()?u.getLng()-180:u.getLng();return[[x,u.getLat()],[g,a.getLat()]]}},{key:"getMinZoom",value:function(){var n=this.map.getZooms();return n[0]-1}},{key:"getMaxZoom",value:function(){var n=this.map.getZooms();return n[1]-1}},{key:"lngLatToContainer",value:function(n){var a=this.map.lngLatToContainer(n);return{x:a.getX(),y:a.getY()}}},{key:"lngLatToPixel",value:function(n){var a=this.map.lngLatToPixel(new AMap.LngLat(n[0],n[1]));return{x:a.getX(),y:a.getY()}}},{key:"getModelMatrix",value:function(n,a,u){var f=arguments.length>3&&arguments[3]!==void 0?arguments[3]:[1,1,1],g=this.map.customCoords.lngLatToCoord(n),x=Qn();return qs(x,x,Lu(g[0],g[1],a)),So(x,x,Lu(f[0],f[1],f[2])),cc(x,x,u[0]),Q0(x,x,u[1]),q0(x,x,u[2]),x}},{key:"init",value:function(){var r=(0,ur.Z)(nt().mark(function a(){var u,f,g,x,I,O,B,W,he,ae,Se,Fe,Qe,qe,yt,Et,Ot,jt,or,ar,br,pr;return nt().wrap(function(nn){for(;;)switch(nn.prev=nn.next){case 0:if(u=this.config,f=u.id,g=u.style,x=g===void 0?"light":g,I=u.minZoom,O=I===void 0?0:I,B=u.maxZoom,W=B===void 0?18:B,he=u.token,ae=he===void 0?fx:he,Se=u.mapInstance,Fe=u.plugin,Qe=Fe===void 0?[]:Fe,qe=u.version,yt=qe===void 0?hx:qe,Et=(0,hc.Z)(u,h6),this.viewport=new f6,window.AMap||Se){nn.next=6;break}return Qe.push("Map3D"),nn.next=6,U2().load({key:ae,version:hx,plugins:Qe});case 6:Se?(this.map=Se,this.$mapContainer=this.map.getContainer(),jt=this.map.getCenter(),(Ot=this.map.customCoords)===null||Ot===void 0||Ot.setCenter([jt.lng,jt.lat]),this.setCustomCoordCenter([jt.lng,jt.lat]),this.map.on("viewchange",this.handleViewChanged)):(this.$mapContainer=this.creatMapContainer(f),ar=(0,X.Z)({mapStyle:this.getMapStyleValue(x),zooms:[O,W],viewMode:"3D"},Et),ar.zoom&&(ar.zoom+=1),ae===fx&&(window._AMapSecurityConfig={securityJsCode:"2653011adeb04230b3a26cc9a780a800"},console.warn("%c".concat(this.configService.getSceneWarninfo("MapToken"),"!"),"color: #873bf4;font-weigh:900;font-size: 16px;")),br=new AMap.Map(this.$mapContainer,ar),this.map=br,pr=br.getCenter(),(or=this.map.customCoords)===null||or===void 0||or.setCenter([pr.lng,pr.lat]),this.setCustomCoordCenter([pr.lng,pr.lat]),br.on("viewchange",this.handleViewChanged)),this.initViewPort();case 8:case"end":return nn.stop()}},a,this)}));function n(){return r.apply(this,arguments)}return n}()},{key:"getMapContainer",value:function(){return this.$mapContainer}},{key:"onCameraChanged",value:function(n){this.cameraChangedCallback=n}},{key:"initViewPort",value:function(){var n,a=(n=this.map.customCoords)===null||n===void 0?void 0:n.getCameraParams(),u=a.fov,f=a.near,g=a.far,x=a.aspect,I=a.position,O=a.lookAt,B=a.up;this.emit("mapchange");var W=this.map.customCoords.getCenter(),he=this.map.getZoom();this.cameraChangedCallback&&(this.viewport.syncWithMapCamera({aspect:x,far:g,fov:u,cameraPosition:I,lookAt:O,near:f,up:B,zoom:he-1,center:W,offsetOrigin:[I[0],I[1]]}),this.coordinateSystemService.setCoordinateSystem(Fc.P20_2),this.cameraChangedCallback(this.viewport))}},{key:"_sub",value:function(n,a){var u=[0,0];return u[0]=n[0]-a[0],u[1]=n[1]-a[1],u}}]),t}(c6))||lx);function g6(e){var i=m6();return function(){var r=(0,oe.Z)(e),n;if(i){var a=(0,oe.Z)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return(0,Ze.Z)(this,n)}}function m6(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var y6=function(e){(0,ke.Z)(t,e);var i=g6(t);function t(){return(0,ue.Z)(this,t),i.apply(this,arguments)}return(0,me.Z)(t,[{key:"getServiceConstructor",value:function(){return v6}}]),t}(j5),_6=C(96377),x6=C.n(_6),E6=function(){function e(i,t){(0,ue.Z)(this,e);var r=t.buffer,n=t.offset,a=t.stride,u=t.normalized,f=t.size,g=t.divisor;this.buffer=r,this.attribute={buffer:r.get(),offset:n||0,stride:a||0,normalized:u||!1,divisor:g||0},f&&(this.attribute.size=f)}return(0,me.Z)(e,[{key:"get",value:function(){return this.attribute}},{key:"updateBuffer",value:function(t){this.buffer.subData(t)}},{key:"destroy",value:function(){this.buffer.destroy()}}]),e}(),r0,Lp,B0,$c,Pp,Z0,Op,av,Pf,yh,qu,Of,Rf,ov,b6=(r0={},(0,Ce.Z)(r0,Ge.POINTS,"points"),(0,Ce.Z)(r0,Ge.LINES,"lines"),(0,Ce.Z)(r0,Ge.LINE_LOOP,"line loop"),(0,Ce.Z)(r0,Ge.LINE_STRIP,"line strip"),(0,Ce.Z)(r0,Ge.TRIANGLES,"triangles"),(0,Ce.Z)(r0,Ge.TRIANGLE_FAN,"triangle fan"),(0,Ce.Z)(r0,Ge.TRIANGLE_STRIP,"triangle strip"),r0),Ax=(Lp={},(0,Ce.Z)(Lp,Ge.STATIC_DRAW,"static"),(0,Ce.Z)(Lp,Ge.DYNAMIC_DRAW,"dynamic"),(0,Ce.Z)(Lp,Ge.STREAM_DRAW,"stream"),Lp),Hg=(B0={},(0,Ce.Z)(B0,Ge.BYTE,"int8"),(0,Ce.Z)(B0,Ge.INT,"int32"),(0,Ce.Z)(B0,Ge.UNSIGNED_BYTE,"uint8"),(0,Ce.Z)(B0,Ge.UNSIGNED_SHORT,"uint16"),(0,Ce.Z)(B0,Ge.UNSIGNED_INT,"uint32"),(0,Ce.Z)(B0,Ge.FLOAT,"float"),B0),S6=($c={},(0,Ce.Z)($c,Ge.ALPHA,"alpha"),(0,Ce.Z)($c,Ge.LUMINANCE,"luminance"),(0,Ce.Z)($c,Ge.LUMINANCE_ALPHA,"luminance alpha"),(0,Ce.Z)($c,Ge.RGB,"rgb"),(0,Ce.Z)($c,Ge.RGBA,"rgba"),(0,Ce.Z)($c,Ge.RGBA4,"rgba4"),(0,Ce.Z)($c,Ge.RGB5_A1,"rgb5 a1"),(0,Ce.Z)($c,Ge.RGB565,"rgb565"),(0,Ce.Z)($c,Ge.DEPTH_COMPONENT,"depth"),(0,Ce.Z)($c,Ge.DEPTH_STENCIL,"depth stencil"),$c),C6=(Pp={},(0,Ce.Z)(Pp,Ge.DONT_CARE,"dont care"),(0,Ce.Z)(Pp,Ge.NICEST,"nice"),(0,Ce.Z)(Pp,Ge.FASTEST,"fast"),Pp),px=(Z0={},(0,Ce.Z)(Z0,Ge.NEAREST,"nearest"),(0,Ce.Z)(Z0,Ge.LINEAR,"linear"),(0,Ce.Z)(Z0,Ge.LINEAR_MIPMAP_LINEAR,"mipmap"),(0,Ce.Z)(Z0,Ge.NEAREST_MIPMAP_LINEAR,"nearest mipmap linear"),(0,Ce.Z)(Z0,Ge.LINEAR_MIPMAP_NEAREST,"linear mipmap nearest"),(0,Ce.Z)(Z0,Ge.NEAREST_MIPMAP_NEAREST,"nearest mipmap nearest"),Z0),dx=(Op={},(0,Ce.Z)(Op,Ge.REPEAT,"repeat"),(0,Ce.Z)(Op,Ge.CLAMP_TO_EDGE,"clamp"),(0,Ce.Z)(Op,Ge.MIRRORED_REPEAT,"mirror"),Op),w6=(av={},(0,Ce.Z)(av,Ge.NONE,"none"),(0,Ce.Z)(av,Ge.BROWSER_DEFAULT_WEBGL,"browser"),av),T6=(Pf={},(0,Ce.Z)(Pf,Ge.NEVER,"never"),(0,Ce.Z)(Pf,Ge.ALWAYS,"always"),(0,Ce.Z)(Pf,Ge.LESS,"less"),(0,Ce.Z)(Pf,Ge.LEQUAL,"lequal"),(0,Ce.Z)(Pf,Ge.GREATER,"greater"),(0,Ce.Z)(Pf,Ge.GEQUAL,"gequal"),(0,Ce.Z)(Pf,Ge.EQUAL,"equal"),(0,Ce.Z)(Pf,Ge.NOTEQUAL,"notequal"),Pf),vx=(yh={},(0,Ce.Z)(yh,Ge.FUNC_ADD,"add"),(0,Ce.Z)(yh,Ge.MIN_EXT,"min"),(0,Ce.Z)(yh,Ge.MAX_EXT,"max"),(0,Ce.Z)(yh,Ge.FUNC_SUBTRACT,"subtract"),(0,Ce.Z)(yh,Ge.FUNC_REVERSE_SUBTRACT,"reverse subtract"),yh),sv=(qu={},(0,Ce.Z)(qu,Ge.ZERO,"zero"),(0,Ce.Z)(qu,Ge.ONE,"one"),(0,Ce.Z)(qu,Ge.SRC_COLOR,"src color"),(0,Ce.Z)(qu,Ge.ONE_MINUS_SRC_COLOR,"one minus src color"),(0,Ce.Z)(qu,Ge.SRC_ALPHA,"src alpha"),(0,Ce.Z)(qu,Ge.ONE_MINUS_SRC_ALPHA,"one minus src alpha"),(0,Ce.Z)(qu,Ge.DST_COLOR,"dst color"),(0,Ce.Z)(qu,Ge.ONE_MINUS_DST_COLOR,"one minus dst color"),(0,Ce.Z)(qu,Ge.DST_ALPHA,"dst alpha"),(0,Ce.Z)(qu,Ge.ONE_MINUS_DST_ALPHA,"one minus dst alpha"),(0,Ce.Z)(qu,Ge.CONSTANT_COLOR,"constant color"),(0,Ce.Z)(qu,Ge.ONE_MINUS_CONSTANT_COLOR,"one minus constant color"),(0,Ce.Z)(qu,Ge.CONSTANT_ALPHA,"constant alpha"),(0,Ce.Z)(qu,Ge.ONE_MINUS_CONSTANT_ALPHA,"one minus constant alpha"),(0,Ce.Z)(qu,Ge.SRC_ALPHA_SATURATE,"src alpha saturate"),qu),M6=(Of={},(0,Ce.Z)(Of,Ge.NEVER,"never"),(0,Ce.Z)(Of,Ge.ALWAYS,"always"),(0,Ce.Z)(Of,Ge.LESS,"less"),(0,Ce.Z)(Of,Ge.LEQUAL,"lequal"),(0,Ce.Z)(Of,Ge.GREATER,"greater"),(0,Ce.Z)(Of,Ge.GEQUAL,"gequal"),(0,Ce.Z)(Of,Ge.EQUAL,"equal"),(0,Ce.Z)(Of,Ge.NOTEQUAL,"notequal"),Of),vA=(Rf={},(0,Ce.Z)(Rf,Ge.ZERO,"zero"),(0,Ce.Z)(Rf,Ge.KEEP,"keep"),(0,Ce.Z)(Rf,Ge.REPLACE,"replace"),(0,Ce.Z)(Rf,Ge.INVERT,"invert"),(0,Ce.Z)(Rf,Ge.INCR,"increment"),(0,Ce.Z)(Rf,Ge.DECR,"decrement"),(0,Ce.Z)(Rf,Ge.INCR_WRAP,"increment wrap"),(0,Ce.Z)(Rf,Ge.DECR_WRAP,"decrement wrap"),Rf),I6=(ov={},(0,Ce.Z)(ov,Ge.FRONT,"front"),(0,Ce.Z)(ov,Ge.BACK,"back"),ov),L6=function(){function e(i,t){(0,ue.Z)(this,e),(0,Ce.Z)(this,"isDestroyed",!1);var r=t.data,n=t.usage,a=t.type;this.buffer=i.buffer({data:r,usage:Ax[n||Ge.STATIC_DRAW],type:Hg[a||Ge.UNSIGNED_BYTE]})}return(0,me.Z)(e,[{key:"get",value:function(){return this.buffer}},{key:"destroy",value:function(){this.isDestroyed||this.buffer.destroy(),this.isDestroyed=!0}},{key:"subData",value:function(t){var r=t.data,n=t.offset;this.buffer.subdata(r,n)}}]),e}(),P6=function(){function e(i,t){(0,ue.Z)(this,e);var r=t.data,n=t.usage,a=t.type,u=t.count;this.elements=i.elements({data:r,usage:Ax[n||Ge.STATIC_DRAW],type:Hg[a||Ge.UNSIGNED_BYTE],count:u})}return(0,me.Z)(e,[{key:"get",value:function(){return this.elements}},{key:"subData",value:function(t){var r=t.data;this.elements.subdata(r)}},{key:"destroy",value:function(){}}]),e}(),O6=function(){function e(i,t){(0,ue.Z)(this,e);var r=t.width,n=t.height,a=t.color,u=t.colors,f={width:r,height:n};Array.isArray(u)&&(f.colors=u.map(function(g){return g.get()})),a&&typeof a!="boolean"&&(f.color=a.get()),this.framebuffer=i.framebuffer(f)}return(0,me.Z)(e,[{key:"get",value:function(){return this.framebuffer}},{key:"destroy",value:function(){this.framebuffer.destroy()}},{key:"resize",value:function(t){var r=t.width,n=t.height;this.framebuffer.resize(r,n)}}]),e}(),R6=In.isPlainObject,k6=In.isTypedArray,D6=function(){function e(i,t){(0,ue.Z)(this,e),(0,Ce.Z)(this,"destroyed",!1),(0,Ce.Z)(this,"uniforms",{}),this.reGl=i;var r=t.vs,n=t.fs,a=t.attributes,u=t.uniforms,f=t.primitive,g=t.count,x=t.elements,I=t.depth,O=t.cull,B=t.instances,W={};this.options=t,u&&(this.uniforms=this.extractUniforms(u),Object.keys(u).forEach(function(Se){W[Se]=i.prop(Se)}));var he={};Object.keys(a).forEach(function(Se){he[Se]=a[Se].get()});var ae={attributes:he,frag:n,uniforms:W,vert:r,colorMask:i.prop("colorMask"),lineWidth:1,blend:{enable:i.prop("blend.enable"),func:i.prop("blend.func"),equation:i.prop("blend.equation"),color:i.prop("blend.color")},stencil:{enable:i.prop("stencil.enable"),mask:i.prop("stencil.mask"),func:i.prop("stencil.func"),opFront:i.prop("stencil.opFront"),opBack:i.prop("stencil.opBack")},primitive:b6[f===void 0?Ge.TRIANGLES:f]};B&&(ae.instances=B),g?ae.count=g:x&&(ae.elements=x.get()),this.initDepthDrawParams({depth:I},ae),this.initCullDrawParams({cull:O},ae),this.drawCommand=i(ae),this.drawParams=ae}return(0,me.Z)(e,[{key:"updateAttributesAndElements",value:function(t,r){var n={};Object.keys(t).forEach(function(a){n[a]=t[a].get()}),this.drawParams.attributes=n,this.drawParams.elements=r.get(),this.drawCommand=this.reGl(this.drawParams)}},{key:"updateAttributes",value:function(t){var r={};Object.keys(t).forEach(function(n){r[n]=t[n].get()}),this.drawParams.attributes=r,this.drawCommand=this.reGl(this.drawParams)}},{key:"addUniforms",value:function(t){this.uniforms=(0,X.Z)((0,X.Z)({},this.uniforms),this.extractUniforms(t))}},{key:"draw",value:function(t,r){if(!(this.drawParams.attributes&&Object.keys(this.drawParams.attributes).length===0)){var n=(0,X.Z)((0,X.Z)({},this.uniforms),this.extractUniforms(t.uniforms||{})),a={};Object.keys(n).forEach(function(u){var f=(0,Ia.Z)(n[u]);f==="boolean"||f==="number"||Array.isArray(n[u])||n[u].BYTES_PER_ELEMENT?a[u]=n[u]:a[u]=n[u].get()}),a.blend=r?this.getBlendDrawParams({blend:{enable:!1}}):this.getBlendDrawParams(t),a.stencil=this.getStencilDrawParams(t),a.colorMask=this.getColorMaskDrawParams(t,r),this.drawCommand(a)}}},{key:"destroy",value:function(){var t,r;(t=this.drawParams)===null||t===void 0||(r=t.elements)===null||r===void 0||r.destroy(),this.options.attributes&&Object.values(this.options.attributes).forEach(function(n){n==null||n.destroy()}),this.destroyed=!0}},{key:"initDepthDrawParams",value:function(t,r){var n=t.depth;n&&(r.depth={enable:n.enable===void 0?!0:!!n.enable,mask:n.mask===void 0?!0:!!n.mask,func:T6[n.func||Ge.LESS],range:n.range||[0,1]})}},{key:"getBlendDrawParams",value:function(t){var r=t.blend,n=r||{},a=n.enable,u=n.func,f=n.equation,g=n.color,x=g===void 0?[0,0,0,0]:g;return{enable:!!a,func:{srcRGB:sv[u&&u.srcRGB||Ge.SRC_ALPHA],srcAlpha:sv[u&&u.srcAlpha||Ge.SRC_ALPHA],dstRGB:sv[u&&u.dstRGB||Ge.ONE_MINUS_SRC_ALPHA],dstAlpha:sv[u&&u.dstAlpha||Ge.ONE_MINUS_SRC_ALPHA]},equation:{rgb:vx[f&&f.rgb||Ge.FUNC_ADD],alpha:vx[f&&f.alpha||Ge.FUNC_ADD]},color:x}}},{key:"getStencilDrawParams",value:function(t){var r=t.stencil,n=r||{},a=n.enable,u=n.mask,f=u===void 0?-1:u,g=n.func,x=g===void 0?{cmp:Ge.ALWAYS,ref:0,mask:-1}:g,I=n.opFront,O=I===void 0?{fail:Ge.KEEP,zfail:Ge.KEEP,zpass:Ge.KEEP}:I,B=n.opBack,W=B===void 0?{fail:Ge.KEEP,zfail:Ge.KEEP,zpass:Ge.KEEP}:B;return{enable:!!a,mask:f,func:(0,X.Z)((0,X.Z)({},x),{},{cmp:M6[x.cmp]}),opFront:{fail:vA[O.fail],zfail:vA[O.zfail],zpass:vA[O.zpass]},opBack:{fail:vA[W.fail],zfail:vA[W.zfail],zpass:vA[W.zpass]}}}},{key:"getColorMaskDrawParams",value:function(t,r){var n=t.stencil,a=n!=null&&n.enable&&n.opFront&&!r?[!1,!1,!1,!1]:[!0,!0,!0,!0];return a}},{key:"initCullDrawParams",value:function(t,r){var n=t.cull;if(n){var a=n.enable,u=n.face,f=u===void 0?Ge.BACK:u;r.cull={enable:!!a,face:I6[f]}}}},{key:"extractUniforms",value:function(t){var r=this,n={};return Object.keys(t).forEach(function(a){r.extractUniformsRecursively(a,t[a],n,"")}),n}},{key:"extractUniformsRecursively",value:function(t,r,n,a){var u=this;if(r===null||typeof r=="number"||typeof r=="boolean"||Array.isArray(r)&&typeof r[0]=="number"||k6(r)||r===""||"resize"in r){n["".concat(a&&a+".").concat(t)]=r;return}R6(r)&&Object.keys(r).forEach(function(f){u.extractUniformsRecursively(f,r[f],n,"".concat(a&&a+".").concat(t))}),Array.isArray(r)&&r.forEach(function(f,g){Object.keys(f).forEach(function(x){u.extractUniformsRecursively(x,f[x],n,"".concat(a&&a+".").concat(t,"[").concat(g,"]"))})})}}]),e}(),N6=function(){function e(i,t){(0,ue.Z)(this,e),(0,Ce.Z)(this,"isDestroy",!1);var r=t.data,n=t.type,a=n===void 0?Ge.UNSIGNED_BYTE:n,u=t.width,f=t.height,g=t.flipY,x=g===void 0?!1:g,I=t.format,O=I===void 0?Ge.RGBA:I,B=t.mipmap,W=B===void 0?!1:B,he=t.wrapS,ae=he===void 0?Ge.CLAMP_TO_EDGE:he,Se=t.wrapT,Fe=Se===void 0?Ge.CLAMP_TO_EDGE:Se,Qe=t.aniso,qe=Qe===void 0?0:Qe,yt=t.alignment,Et=yt===void 0?1:yt,Ot=t.premultiplyAlpha,jt=Ot===void 0?!1:Ot,or=t.mag,ar=or===void 0?Ge.NEAREST:or,br=t.min,pr=br===void 0?Ge.NEAREST:br,jr=t.colorSpace,nn=jr===void 0?Ge.BROWSER_DEFAULT_WEBGL:jr,yn=t.x,ma=yn===void 0?0:yn,Ho=t.y,Lo=Ho===void 0?0:Ho,Rs=t.copy,ks=Rs===void 0?!1:Rs;this.width=u,this.height=f;var Wc={width:u,height:f,type:Hg[a],format:S6[O],wrapS:dx[ae],wrapT:dx[Fe],mag:px[ar],min:px[pr],alignment:Et,flipY:x,colorSpace:w6[nn],premultiplyAlpha:jt,aniso:qe,x:ma,y:Lo,copy:ks};r&&(Wc.data=r),typeof W=="number"?Wc.mipmap=C6[W]:typeof W=="boolean"&&(Wc.mipmap=W),this.texture=i.texture(Wc)}return(0,me.Z)(e,[{key:"get",value:function(){return this.texture}},{key:"update",value:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.texture(t)}},{key:"bind",value:function(){this.texture._texture.bind()}},{key:"resize",value:function(t){var r=t.width,n=t.height;this.texture.resize(r,n),this.width=r,this.height=n}},{key:"getSize",value:function(){return[this.width,this.height]}},{key:"destroy",value:function(){if(!this.isDestroy){var t;(t=this.texture)===null||t===void 0||t.destroy()}this.isDestroy=!0}}]),e}(),gx,mx,F6=(gx=(0,dr.b2)(),gx(mx=function(){function e(){var i=this;(0,ue.Z)(this,e),(0,Ce.Z)(this,"createModel",function(t){return new D6(i.gl,t)}),(0,Ce.Z)(this,"createAttribute",function(t){return new E6(i.gl,t)}),(0,Ce.Z)(this,"createBuffer",function(t){return new L6(i.gl,t)}),(0,Ce.Z)(this,"createElements",function(t){return new P6(i.gl,t)}),(0,Ce.Z)(this,"createTexture2D",function(t){return new N6(i.gl,t)}),(0,Ce.Z)(this,"createFramebuffer",function(t){return new O6(i.gl,t)}),(0,Ce.Z)(this,"useFramebuffer",function(t,r){i.gl({framebuffer:t?t.get():null})(r)}),(0,Ce.Z)(this,"clear",function(t){var r,n=t.color,a=t.depth,u=t.stencil,f=t.framebuffer,g=f===void 0?null:f,x={color:n,depth:a,stencil:u};x.framebuffer=g===null?g:g.get(),(r=i.gl)===null||r===void 0||r.clear(x)}),(0,Ce.Z)(this,"viewport",function(t){var r=t.x,n=t.y,a=t.width,u=t.height;i.gl._gl.viewport(r,n,a,u),i.width=a,i.height=u,i.gl._refresh()}),(0,Ce.Z)(this,"readPixels",function(t){var r=t.framebuffer,n=t.x,a=t.y,u=t.width,f=t.height,g={x:n,y:a,width:u,height:f};return r&&(g.framebuffer=r.get()),i.gl.read(g)}),(0,Ce.Z)(this,"getViewportSize",function(){return{width:i.gl._gl.drawingBufferWidth,height:i.gl._gl.drawingBufferHeight}}),(0,Ce.Z)(this,"getContainer",function(){var t;return(t=i.canvas)===null||t===void 0?void 0:t.parentElement}),(0,Ce.Z)(this,"getCanvas",function(){return i.canvas}),(0,Ce.Z)(this,"getGLContext",function(){return i.gl._gl}),(0,Ce.Z)(this,"destroy",function(){var t,r,n;i.canvas=null,(t=i.gl)===null||t===void 0||(r=t._gl)===null||r===void 0||(n=r.getExtension("WEBGL_lose_context"))===null||n===void 0||n.loseContext(),i.gl.destroy(),i.gl=null})}return(0,me.Z)(e,[{key:"init",value:function(){var i=(0,ur.Z)(nt().mark(function r(n,a,u){var f=this;return nt().wrap(function(x){for(;;)switch(x.prev=x.next){case 0:if(this.canvas=n,!u){x.next=5;break}this.gl=u,x.next=8;break;case 5:return x.next=7,new Promise(function(I,O){x6()({canvas:f.canvas,attributes:{alpha:!0,antialias:a.antialias,premultipliedAlpha:!0,preserveDrawingBuffer:a.preserveDrawingBuffer,stencil:a.stencil},extensions:["OES_element_index_uint","OES_standard_derivatives","ANGLE_instanced_arrays"],optionalExtensions:["oes_texture_float_linear","OES_texture_float","EXT_texture_filter_anisotropic","EXT_blend_minmax","WEBGL_depth_texture","WEBGL_lose_context"],profile:!0,onDone:function(W,he){(W||!he)&&O(W),I(he)}})});case 7:this.gl=x.sent;case 8:this.extensionObject={OES_texture_float:this.testExtension("OES_texture_float")};case 9:case"end":return x.stop()}},r,this)}));function t(r,n,a){return i.apply(this,arguments)}return t}()},{key:"getPointSizeRange",value:function(){return this.gl._gl.getParameter(this.gl._gl.ALIASED_POINT_SIZE_RANGE)}},{key:"testExtension",value:function(t){return!!this.getGLContext().getExtension(t)}},{key:"setState",value:function(){this.gl({cull:{enable:!1,face:"back"},viewport:{x:0,y:0,height:this.width,width:this.height},blend:{enable:!0,equation:"add"},framebuffer:null}),this.gl._refresh()}},{key:"setBaseState",value:function(){this.gl({cull:{enable:!1,face:"back"},viewport:{x:0,y:0,height:this.width,width:this.height},blend:{enable:!1,equation:"add"},framebuffer:null}),this.gl._refresh()}},{key:"setCustomLayerDefaults",value:function(){var t=this.getGLContext();t.disable(t.CULL_FACE)}},{key:"setDirty",value:function(t){this.isDirty=t}},{key:"getDirty",value:function(){return this.isDirty}}]),e}())||mx);function B6(e){var i=Z6();return function(){var r=(0,oe.Z)(e),n;if(i){var a=(0,oe.Z)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return(0,Ze.Z)(this,n)}}function Z6(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var $g=["selectstart","selecting","selectend"],z6=function(e){(0,ke.Z)(t,e);var i=B6(t);function t(r){var n,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return(0,ue.Z)(this,t),n=i.call(this),(0,Ce.Z)((0,bt.Z)(n),"isEnable",!1),(0,Ce.Z)((0,bt.Z)(n),"onDragStart",function(u){n.box.style.display="block",n.startEvent=n.endEvent=u,n.syncBoxBound(),n.emit("selectstart",n.getLngLatBox(),n.startEvent,n.endEvent)}),(0,Ce.Z)((0,bt.Z)(n),"onDragging",function(u){n.endEvent=u,n.syncBoxBound(),n.emit("selecting",n.getLngLatBox(),n.startEvent,n.endEvent)}),(0,Ce.Z)((0,bt.Z)(n),"onDragEnd",function(u){n.endEvent=u,n.box.style.display="none",n.emit("selectend",n.getLngLatBox(),n.startEvent,n.endEvent)}),n.scene=r,n.options=a,n}return(0,me.Z)(t,[{key:"container",get:function(){return this.scene.getMapService().getMarkerContainer()}},{key:"enable",value:function(){if(!this.isEnable){var n=this.options.className;if(this.scene.setMapStatus({dragEnable:!1}),this.container.style.cursor="crosshair",!this.box){var a=ci("div",void 0,this.container);a.classList.add("l7-select-box"),n&&a.classList.add(n),a.style.display="none",this.box=a}this.scene.on("dragstart",this.onDragStart),this.scene.on("dragging",this.onDragging),this.scene.on("dragend",this.onDragEnd),this.isEnable=!0}}},{key:"disable",value:function(){this.isEnable&&(this.scene.setMapStatus({dragEnable:!0}),this.container.style.cursor="auto",this.scene.off("dragstart",this.onDragStart),this.scene.off("dragging",this.onDragging),this.scene.off("dragend",this.onDragEnd),this.isEnable=!1)}},{key:"syncBoxBound",value:function(){var n=this.startEvent,a=n.x,u=n.y,f=this.endEvent,g=f.x,x=f.y,I=Math.min(a,g),O=Math.min(u,x),B=Math.abs(a-g),W=Math.abs(u-x);this.box.style.top="".concat(O,"px"),this.box.style.left="".concat(I,"px"),this.box.style.width="".concat(B,"px"),this.box.style.height="".concat(W,"px")}},{key:"getLngLatBox",value:function(){var n=this.startEvent.lngLat,a=n.lng,u=n.lat,f=this.endEvent.lngLat,g=f.lng,x=f.lat;return el([[a,u],[g,x]])}}]),t}(xa.EventEmitter),U6=function(){function e(i){(0,ue.Z)(this,e);var t=i.id,r=i.map,n=i.canvas,a=i.hasBaseMap,u=t3();this.container=u,r.setContainer(u,t,n,a),u.bind(Xt.IRendererService).to(F6).inSingletonScope(),this.sceneService=u.get(Xt.ISceneService),this.mapService=u.get(Xt.IMapService),this.iconService=u.get(Xt.IIconService),this.fontService=u.get(Xt.IFontService),this.controlService=u.get(Xt.IControlService),this.layerService=u.get(Xt.ILayerService),this.debugService=u.get(Xt.IDebugService),this.debugService.setEnable(i.debug),this.markerService=u.get(Xt.IMarkerService),this.interactionService=u.get(Xt.IInteractionService),this.popupService=u.get(Xt.IPopupService),this.boxSelect=new z6(this,{}),this.initComponent(t),this.sceneService.init(i),this.initControl()}return(0,me.Z)(e,[{key:"map",get:function(){return this.mapService.map}},{key:"loaded",get:function(){return this.sceneService.loaded}},{key:"getServiceContainer",value:function(){return this.container}},{key:"getSize",value:function(){return this.mapService.getSize()}},{key:"getMinZoom",value:function(){return this.mapService.getMinZoom()}},{key:"getMaxZoom",value:function(){return this.mapService.getMaxZoom()}},{key:"getType",value:function(){return this.mapService.getType()}},{key:"getMapContainer",value:function(){return this.mapService.getMapContainer()}},{key:"getMapCanvasContainer",value:function(){return this.mapService.getMapCanvasContainer()}},{key:"getMapService",value:function(){return this.mapService}},{key:"getDebugService",value:function(){return this.debugService}},{key:"exportPng",value:function(){var i=(0,ur.Z)(nt().mark(function r(n){return nt().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.abrupt("return",this.sceneService.exportPng(n));case 1:case"end":return u.stop()}},r,this)}));function t(r){return i.apply(this,arguments)}return t}()},{key:"exportMap",value:function(){var i=(0,ur.Z)(nt().mark(function r(n){return nt().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.abrupt("return",this.sceneService.exportPng(n));case 1:case"end":return u.stop()}},r,this)}));function t(r){return i.apply(this,arguments)}return t}()},{key:"registerRenderService",value:function(t){var r=this;if(this.sceneService.loaded){var n=new t(this);n.init()}else this.on("loaded",function(){var a=new t(r);a.init()})}},{key:"setBgColor",value:function(t){this.mapService.setBgColor(t)}},{key:"addLayer",value:function(t){var r=this,n=cp(this.container);if(t.setContainer(n,this.container),this.sceneService.addLayer(t),t.inited){var a=this.initMask(t);this.addMask(a,t.id)}else t.on("inited",function(){var u=r.initMask(t);r.addMask(u,t.id)})}},{key:"initMask",value:function(t){var r=t.getLayerConfig(),n=r.mask,a=r.maskfence,u=r.maskColor,f=u===void 0?"#000":u,g=r.maskOpacity,x=g===void 0?0:g;if(!(!n||!a)){var I=new R1().source(a).shape("fill").style({color:f,opacity:x});return I}}},{key:"addMask",value:function(t,r){if(t){var n=this.getLayer(r);if(n){var a=cp(this.container);t.setContainer(a,this.container),n.addMaskLayer(t),this.sceneService.addMask(t)}else console.warn("parent layer not find!")}}},{key:"getPickedLayer",value:function(){return this.layerService.pickedLayerId}},{key:"getLayers",value:function(){return this.layerService.getLayers()}},{key:"getLayer",value:function(t){return this.layerService.getLayer(t)}},{key:"getLayerByName",value:function(t){return this.layerService.getLayerByName(t)}},{key:"removeLayer",value:function(){var i=(0,ur.Z)(nt().mark(function r(n,a){return nt().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return f.next=2,this.layerService.remove(n,a);case 2:case"end":return f.stop()}},r,this)}));function t(r,n){return i.apply(this,arguments)}return t}()},{key:"removeAllLayer",value:function(){var i=(0,ur.Z)(nt().mark(function r(){return nt().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,this.layerService.removeAllLayers();case 2:case"end":return a.stop()}},r,this)}));function t(){return i.apply(this,arguments)}return t}()},{key:"render",value:function(){this.sceneService.render()}},{key:"setEnableRender",value:function(t){this.layerService.setEnableRender(t)}},{key:"addIconFont",value:function(t,r){this.fontService.addIconFont(t,r)}},{key:"addIconFonts",value:function(t){var r=this;t.forEach(function(n){var a=(0,vn.Z)(n,2),u=a[0],f=a[1];r.fontService.addIconFont(u,f)})}},{key:"addFontFace",value:function(t,r){var n=this;this.fontService.once("fontloaded",function(a){n.emit("fontloaded",a)}),this.fontService.addFontFace(t,r)}},{key:"addImage",value:function(){var i=(0,ur.Z)(nt().mark(function r(n,a){return nt().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return f.next=2,this.iconService.addImage(n,a);case 2:case"end":return f.stop()}},r,this)}));function t(r,n){return i.apply(this,arguments)}return t}()},{key:"hasImage",value:function(t){return this.iconService.hasImage(t)}},{key:"removeImage",value:function(t){this.iconService.removeImage(t)}},{key:"addIconFontGlyphs",value:function(t,r){this.fontService.addIconGlyphs(r)}},{key:"addControl",value:function(t){this.controlService.addControl(t,this.container)}},{key:"removeControl",value:function(t){this.controlService.removeControl(t)}},{key:"getControlByName",value:function(t){return this.controlService.getControlByName(t)}},{key:"addMarker",value:function(t){this.markerService.addMarker(t)}},{key:"addMarkerLayer",value:function(t){this.markerService.addMarkerLayer(t)}},{key:"removeMarkerLayer",value:function(t){this.markerService.removeMarkerLayer(t)}},{key:"removeAllMarkers",value:function(){this.markerService.removeAllMarkers()}},{key:"removeAllMakers",value:function(){console.warn("removeAllMakers \u5DF2\u5E9F\u5F03\uFF0C\u8BF7\u4F7F\u7528 removeAllMarkers"),this.markerService.removeAllMarkers()}},{key:"addPopup",value:function(t){this.popupService.addPopup(t)}},{key:"removePopup",value:function(t){this.popupService.removePopup(t)}},{key:"on",value:function(t,r){if($g.includes(t)){var n;(n=this.boxSelect)===null||n===void 0||n.on(t,r)}else Id.includes(t)?this.sceneService.on(t,r):this.mapService.on(t,r)}},{key:"once",value:function(t,r){if($g.includes(t)){var n;(n=this.boxSelect)===null||n===void 0||n.once(t,r)}else Id.includes(t)?this.sceneService.once(t,r):this.mapService.once(t,r)}},{key:"emit",value:function(t,r){Id.indexOf(t)===-1?this.mapService.on(t,r):this.sceneService.emit(t,r)}},{key:"off",value:function(t,r){if($g.includes(t)){var n;(n=this.boxSelect)===null||n===void 0||n.off(t,r)}else Id.includes(t)?this.sceneService.off(t,r):this.mapService.off(t,r)}},{key:"getZoom",value:function(){return this.mapService.getZoom()}},{key:"getCenter",value:function(t){return this.mapService.getCenter(t)}},{key:"setCenter",value:function(t,r){return this.mapService.setCenter(t,r)}},{key:"getPitch",value:function(){return this.mapService.getPitch()}},{key:"setPitch",value:function(t){return this.mapService.setPitch(t)}},{key:"getRotation",value:function(){return this.mapService.getRotation()}},{key:"getBounds",value:function(){return this.mapService.getBounds()}},{key:"setRotation",value:function(t){this.mapService.setRotation(t)}},{key:"zoomIn",value:function(){this.mapService.zoomIn()}},{key:"zoomOut",value:function(){this.mapService.zoomOut()}},{key:"panTo",value:function(t){this.mapService.panTo(t)}},{key:"panBy",value:function(t,r){this.mapService.panBy(t,r)}},{key:"getContainer",value:function(){return this.mapService.getContainer()}},{key:"setZoom",value:function(t){this.mapService.setZoom(t)}},{key:"fitBounds",value:function(t,r){var n=this.sceneService.getSceneConfig(),a=n.fitBoundsOptions,u=n.animate;this.mapService.fitBounds(t,r||(0,X.Z)((0,X.Z)({},a),{},{animate:u}))}},{key:"setZoomAndCenter",value:function(t,r){this.mapService.setZoomAndCenter(t,r)}},{key:"setMapStyle",value:function(t){this.mapService.setMapStyle(t)}},{key:"setMapStatus",value:function(t){this.mapService.setMapStatus(t)}},{key:"pixelToLngLat",value:function(t){return this.mapService.pixelToLngLat(t)}},{key:"lngLatToPixel",value:function(t){return this.mapService.lngLatToPixel(t)}},{key:"containerToLngLat",value:function(t){return this.mapService.containerToLngLat(t)}},{key:"lngLatToContainer",value:function(t){return this.mapService.lngLatToContainer(t)}},{key:"destroy",value:function(){this.sceneService.destroy()}},{key:"registerPostProcessingPass",value:function(t,r){this.container.bind(Xt.IPostProcessingPass).to(t).whenTargetNamed(r)}},{key:"enableShaderPick",value:function(){this.layerService.enableShaderPick()}},{key:"diasbleShaderPick",value:function(){this.layerService.disableShaderPick()}},{key:"enableBoxSelect",value:function(){var t=this,r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.boxSelect.enable(),r&&this.boxSelect.once("selectend",function(){t.disableBoxSelect()})}},{key:"disableBoxSelect",value:function(){this.boxSelect.disable()}},{key:"getProtocol",value:function(t){return ln.REGISTERED_PROTOCOLS[t]}},{key:"getPointSizeRange",value:function(){return this.sceneService.getPointSizeRange()}},{key:"initComponent",value:function(t){this.controlService.init({container:zs(t)},this.container),this.markerService.init(this.container),this.popupService.init(this.container)}},{key:"initControl",value:function(){var t=this.sceneService.getSceneConfig(),r=t.logoVisible,n=t.logoPosition;r&&this.addControl(new Sb({position:n}))}}],[{key:"addProtocol",value:function(t,r){ln.REGISTERED_PROTOCOLS[t]=r}},{key:"removeProtocol",value:function(t){delete ln.REGISTERED_PROTOCOLS[t]}}]),e}(),e8="2.19.10"},19947:function(se){se.exports=$;function $(D,G){var Z=D&&D.type,F;if(Z==="FeatureCollection")for(F=0;F<D.features.length;F++)$(D.features[F],G);else if(Z==="GeometryCollection")for(F=0;F<D.geometries.length;F++)$(D.geometries[F],G);else if(Z==="Feature")$(D.geometry,G);else if(Z==="Polygon")C(D.coordinates,G);else if(Z==="MultiPolygon")for(F=0;F<D.coordinates.length;F++)C(D.coordinates[F],G);return D}function C(D,G){if(D.length!==0){P(D[0],G);for(var Z=1;Z<D.length;Z++)P(D[Z],!G)}}function P(D,G){for(var Z=0,F=0,z=0,q=D.length,ee=q-1;z<q;ee=z++){var fe=(D[z][0]-D[ee][0])*(D[ee][1]+D[z][1]),be=Z+fe;F+=Math.abs(Z)>=Math.abs(fe)?Z-be+fe:fe-be+Z,Z=be}Z+F>=0!=!!G&&D.reverse()}},59263:function(se){"use strict";se.exports=$;function $(C,P){this.x=C,this.y=P}$.prototype={clone:function(){return new $(this.x,this.y)},add:function(C){return this.clone()._add(C)},sub:function(C){return this.clone()._sub(C)},multByPoint:function(C){return this.clone()._multByPoint(C)},divByPoint:function(C){return this.clone()._divByPoint(C)},mult:function(C){return this.clone()._mult(C)},div:function(C){return this.clone()._div(C)},rotate:function(C){return this.clone()._rotate(C)},rotateAround:function(C,P){return this.clone()._rotateAround(C,P)},matMult:function(C){return this.clone()._matMult(C)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(C){return this.x===C.x&&this.y===C.y},dist:function(C){return Math.sqrt(this.distSqr(C))},distSqr:function(C){var P=C.x-this.x,D=C.y-this.y;return P*P+D*D},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(C){return Math.atan2(this.y-C.y,this.x-C.x)},angleWith:function(C){return this.angleWithSep(C.x,C.y)},angleWithSep:function(C,P){return Math.atan2(this.x*P-this.y*C,this.x*C+this.y*P)},_matMult:function(C){var P=C[0]*this.x+C[1]*this.y,D=C[2]*this.x+C[3]*this.y;return this.x=P,this.y=D,this},_add:function(C){return this.x+=C.x,this.y+=C.y,this},_sub:function(C){return this.x-=C.x,this.y-=C.y,this},_mult:function(C){return this.x*=C,this.y*=C,this},_div:function(C){return this.x/=C,this.y/=C,this},_multByPoint:function(C){return this.x*=C.x,this.y*=C.y,this},_divByPoint:function(C){return this.x/=C.x,this.y/=C.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var C=this.y;return this.y=this.x,this.x=-C,this},_rotate:function(C){var P=Math.cos(C),D=Math.sin(C),G=P*this.x-D*this.y,Z=D*this.x+P*this.y;return this.x=G,this.y=Z,this},_rotateAround:function(C,P){var D=Math.cos(C),G=Math.sin(C),Z=P.x+D*(this.x-P.x)-G*(this.y-P.y),F=P.y+G*(this.x-P.x)+D*(this.y-P.y);return this.x=Z,this.y=F,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},$.convert=function(C){return C instanceof $?C:Array.isArray(C)?new $(C[0],C[1]):C}},8332:function(se,$,C){se.exports.VectorTile=C(29148),C(82442),C(37815)},29148:function(se,$,C){"use strict";var P=C(37815);se.exports=D;function D(Z,F){this.layers=Z.readFields(G,{},F)}function G(Z,F,z){if(Z===3){var q=new P(z,z.readVarint()+z.pos);q.length&&(F[q.name]=q)}}},82442:function(se,$,C){"use strict";var P=C(59263);se.exports=D;function D(q,ee,fe,be,Ie){this.properties={},this.extent=fe,this.type=0,this._pbf=q,this._geometry=-1,this._keys=be,this._values=Ie,q.readFields(G,this,ee)}function G(q,ee,fe){q==1?ee.id=fe.readVarint():q==2?Z(fe,ee):q==3?ee.type=fe.readVarint():q==4&&(ee._geometry=fe.pos)}function Z(q,ee){for(var fe=q.readVarint()+q.pos;q.pos<fe;){var be=ee._keys[q.readVarint()],Ie=ee._values[q.readVarint()];ee.properties[be]=Ie}}D.types=["Unknown","Point","LineString","Polygon"],D.prototype.loadGeometry=function(){var q=this._pbf;q.pos=this._geometry;for(var ee=q.readVarint()+q.pos,fe=1,be=0,Ie=0,Oe=0,He=[],st;q.pos<ee;){if(be<=0){var De=q.readVarint();fe=De&7,be=De>>3}if(be--,fe===1||fe===2)Ie+=q.readSVarint(),Oe+=q.readSVarint(),fe===1&&(st&&He.push(st),st=[]),st.push(new P(Ie,Oe));else if(fe===7)st&&st.push(st[0].clone());else throw new Error("unknown command "+fe)}return st&&He.push(st),He},D.prototype.bbox=function(){var q=this._pbf;q.pos=this._geometry;for(var ee=q.readVarint()+q.pos,fe=1,be=0,Ie=0,Oe=0,He=1/0,st=-1/0,De=1/0,je=-1/0;q.pos<ee;){if(be<=0){var we=q.readVarint();fe=we&7,be=we>>3}if(be--,fe===1||fe===2)Ie+=q.readSVarint(),Oe+=q.readSVarint(),Ie<He&&(He=Ie),Ie>st&&(st=Ie),Oe<De&&(De=Oe),Oe>je&&(je=Oe);else if(fe!==7)throw new Error("unknown command "+fe)}return[He,De,st,je]},D.prototype.toGeoJSON=function(q,ee,fe){var be=this.extent*Math.pow(2,fe),Ie=this.extent*q,Oe=this.extent*ee,He=this.loadGeometry(),st=D.types[this.type],De,je;function we(Re){for(var ye=0;ye<Re.length;ye++){var _e=Re[ye],ne=180-(_e.y+Oe)*360/be;Re[ye]=[(_e.x+Ie)*360/be-180,360/Math.PI*Math.atan(Math.exp(ne*Math.PI/180))-90]}}switch(this.type){case 1:var Te=[];for(De=0;De<He.length;De++)Te[De]=He[De][0];He=Te,we(He);break;case 2:for(De=0;De<He.length;De++)we(He[De]);break;case 3:for(He=F(He),De=0;De<He.length;De++)for(je=0;je<He[De].length;je++)we(He[De][je]);break}He.length===1?He=He[0]:st="Multi"+st;var le={type:"Feature",geometry:{type:st,coordinates:He},properties:this.properties};return"id"in this&&(le.id=this.id),le};function F(q){var ee=q.length;if(ee<=1)return[q];for(var fe=[],be,Ie,Oe=0;Oe<ee;Oe++){var He=z(q[Oe]);He!==0&&(Ie===void 0&&(Ie=He<0),Ie===He<0?(be&&fe.push(be),be=[q[Oe]]):be.push(q[Oe]))}return be&&fe.push(be),fe}function z(q){for(var ee=0,fe=0,be=q.length,Ie=be-1,Oe,He;fe<be;Ie=fe++)Oe=q[fe],He=q[Ie],ee+=(He.x-Oe.x)*(Oe.y+He.y);return ee}},37815:function(se,$,C){"use strict";var P=C(82442);se.exports=D;function D(F,z){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=F,this._keys=[],this._values=[],this._features=[],F.readFields(G,this,z),this.length=this._features.length}function G(F,z,q){F===15?z.version=q.readVarint():F===1?z.name=q.readString():F===5?z.extent=q.readVarint():F===2?z._features.push(q.pos):F===3?z._keys.push(q.readString()):F===4&&z._values.push(Z(q))}function Z(F){for(var z=null,q=F.readVarint()+F.pos;F.pos<q;){var ee=F.readVarint()>>3;z=ee===1?F.readString():ee===2?F.readFloat():ee===3?F.readDouble():ee===4?F.readVarint64():ee===5?F.readVarint():ee===6?F.readSVarint():ee===7?F.readBoolean():null}return z}D.prototype.feature=function(F){if(F<0||F>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[F];var z=this._pbf.readVarint()+this._pbf.pos;return new P(this._pbf,z,this.extent,this._keys,this._values)}},76314:function(se,$,C){"use strict";var P;P={value:!0};var D=C(9750);function G(Z){var F=[1/0,1/0,-1/0,-1/0];return D.coordEach(Z,function(z){F[0]>z[0]&&(F[0]=z[0]),F[1]>z[1]&&(F[1]=z[1]),F[2]<z[0]&&(F[2]=z[0]),F[3]<z[1]&&(F[3]=z[1])}),F}G.default=G,$.Z=G},78161:function(se,$){"use strict";Object.defineProperty($,"__esModule",{value:!0}),$.earthRadius=63710088e-1,$.factors={centimeters:$.earthRadius*100,centimetres:$.earthRadius*100,degrees:$.earthRadius/111325,feet:$.earthRadius*3.28084,inches:$.earthRadius*39.37,kilometers:$.earthRadius/1e3,kilometres:$.earthRadius/1e3,meters:$.earthRadius,metres:$.earthRadius,miles:$.earthRadius/1609.344,millimeters:$.earthRadius*1e3,millimetres:$.earthRadius*1e3,nauticalmiles:$.earthRadius/1852,radians:1,yards:$.earthRadius*1.0936},$.unitsFactors={centimeters:100,centimetres:100,degrees:1/111325,feet:3.28084,inches:39.37,kilometers:1/1e3,kilometres:1/1e3,meters:1,metres:1,miles:1/1609.344,millimeters:1e3,millimetres:1e3,nauticalmiles:1/1852,radians:1/$.earthRadius,yards:1.0936133},$.areaFactors={acres:247105e-9,centimeters:1e4,centimetres:1e4,feet:10.763910417,hectares:1e-4,inches:1550.003100006,kilometers:1e-6,kilometres:1e-6,meters:1,metres:1,miles:386e-9,millimeters:1e6,millimetres:1e6,yards:1.195990046};function C(de,Ee,ge){ge===void 0&&(ge={});var X={type:"Feature"};return(ge.id===0||ge.id)&&(X.id=ge.id),ge.bbox&&(X.bbox=ge.bbox),X.properties=Ee||{},X.geometry=de,X}$.feature=C;function P(de,Ee,ge){switch(ge===void 0&&(ge={}),de){case"Point":return D(Ee).geometry;case"LineString":return z(Ee).geometry;case"Polygon":return Z(Ee).geometry;case"MultiPoint":return be(Ee).geometry;case"MultiLineString":return fe(Ee).geometry;case"MultiPolygon":return Ie(Ee).geometry;default:throw new Error(de+" is invalid")}}$.geometry=P;function D(de,Ee,ge){if(ge===void 0&&(ge={}),!de)throw new Error("coordinates is required");if(!Array.isArray(de))throw new Error("coordinates must be an Array");if(de.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!_e(de[0])||!_e(de[1]))throw new Error("coordinates must contain numbers");var X={type:"Point",coordinates:de};return C(X,Ee,ge)}$.point=D;function G(de,Ee,ge){return ge===void 0&&(ge={}),ee(de.map(function(X){return D(X,Ee)}),ge)}$.points=G;function Z(de,Ee,ge){ge===void 0&&(ge={});for(var X=0,Me=de;X<Me.length;X++){var Ae=Me[X];if(Ae.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var me=0;me<Ae[Ae.length-1].length;me++)if(Ae[Ae.length-1][me]!==Ae[0][me])throw new Error("First and last Position are not equivalent.")}var ue={type:"Polygon",coordinates:de};return C(ue,Ee,ge)}$.polygon=Z;function F(de,Ee,ge){return ge===void 0&&(ge={}),ee(de.map(function(X){return Z(X,Ee)}),ge)}$.polygons=F;function z(de,Ee,ge){if(ge===void 0&&(ge={}),de.length<2)throw new Error("coordinates must be an array of two or more positions");var X={type:"LineString",coordinates:de};return C(X,Ee,ge)}$.lineString=z;function q(de,Ee,ge){return ge===void 0&&(ge={}),ee(de.map(function(X){return z(X,Ee)}),ge)}$.lineStrings=q;function ee(de,Ee){Ee===void 0&&(Ee={});var ge={type:"FeatureCollection"};return Ee.id&&(ge.id=Ee.id),Ee.bbox&&(ge.bbox=Ee.bbox),ge.features=de,ge}$.featureCollection=ee;function fe(de,Ee,ge){ge===void 0&&(ge={});var X={type:"MultiLineString",coordinates:de};return C(X,Ee,ge)}$.multiLineString=fe;function be(de,Ee,ge){ge===void 0&&(ge={});var X={type:"MultiPoint",coordinates:de};return C(X,Ee,ge)}$.multiPoint=be;function Ie(de,Ee,ge){ge===void 0&&(ge={});var X={type:"MultiPolygon",coordinates:de};return C(X,Ee,ge)}$.multiPolygon=Ie;function Oe(de,Ee,ge){ge===void 0&&(ge={});var X={type:"GeometryCollection",geometries:de};return C(X,Ee,ge)}$.geometryCollection=Oe;function He(de,Ee){if(Ee===void 0&&(Ee=0),Ee&&!(Ee>=0))throw new Error("precision must be a positive number");var ge=Math.pow(10,Ee||0);return Math.round(de*ge)/ge}$.round=He;function st(de,Ee){Ee===void 0&&(Ee="kilometers");var ge=$.factors[Ee];if(!ge)throw new Error(Ee+" units is invalid");return de*ge}$.radiansToLength=st;function De(de,Ee){Ee===void 0&&(Ee="kilometers");var ge=$.factors[Ee];if(!ge)throw new Error(Ee+" units is invalid");return de/ge}$.lengthToRadians=De;function je(de,Ee){return Te(De(de,Ee))}$.lengthToDegrees=je;function we(de){var Ee=de%360;return Ee<0&&(Ee+=360),Ee}$.bearingToAzimuth=we;function Te(de){var Ee=de%(2*Math.PI);return Ee*180/Math.PI}$.radiansToDegrees=Te;function le(de){var Ee=de%360;return Ee*Math.PI/180}$.degreesToRadians=le;function Re(de,Ee,ge){if(Ee===void 0&&(Ee="kilometers"),ge===void 0&&(ge="kilometers"),!(de>=0))throw new Error("length must be a positive number");return st(De(de,Ee),ge)}$.convertLength=Re;function ye(de,Ee,ge){if(Ee===void 0&&(Ee="meters"),ge===void 0&&(ge="kilometers"),!(de>=0))throw new Error("area must be a positive number");var X=$.areaFactors[Ee];if(!X)throw new Error("invalid original units");var Me=$.areaFactors[ge];if(!Me)throw new Error("invalid final units");return de/X*Me}$.convertArea=ye;function _e(de){return!isNaN(de)&&de!==null&&!Array.isArray(de)}$.isNumber=_e;function ne(de){return!!de&&de.constructor===Object}$.isObject=ne;function Y(de){if(!de)throw new Error("bbox is required");if(!Array.isArray(de))throw new Error("bbox must be an Array");if(de.length!==4&&de.length!==6)throw new Error("bbox must be an Array of 4 or 6 numbers");de.forEach(function(Ee){if(!_e(Ee))throw new Error("bbox must only contain numbers")})}$.validateBBox=Y;function Le(de){if(!de)throw new Error("id is required");if(["string","number"].indexOf(typeof de)===-1)throw new Error("id must be a number or a string")}$.validateId=Le},9750:function(se,$,C){"use strict";Object.defineProperty($,"__esModule",{value:!0});var P=C(78161);function D(le,Re,ye){if(le!==null)for(var _e,ne,Y,Le,de,Ee,ge,X=0,Me=0,Ae,me=le.type,ue=me==="FeatureCollection",ke=me==="Feature",Ze=ue?le.features.length:1,oe=0;oe<Ze;oe++){ge=ue?le.features[oe].geometry:ke?le.geometry:le,Ae=ge?ge.type==="GeometryCollection":!1,de=Ae?ge.geometries.length:1;for(var Dt=0;Dt<de;Dt++){var Rt=0,cr=0;if(Le=Ae?ge.geometries[Dt]:ge,Le!==null){Ee=Le.coordinates;var Ut=Le.type;switch(X=ye&&(Ut==="Polygon"||Ut==="MultiPolygon")?1:0,Ut){case null:break;case"Point":if(Re(Ee,Me,oe,Rt,cr)===!1)return!1;Me++,Rt++;break;case"LineString":case"MultiPoint":for(_e=0;_e<Ee.length;_e++){if(Re(Ee[_e],Me,oe,Rt,cr)===!1)return!1;Me++,Ut==="MultiPoint"&&Rt++}Ut==="LineString"&&Rt++;break;case"Polygon":case"MultiLineString":for(_e=0;_e<Ee.length;_e++){for(ne=0;ne<Ee[_e].length-X;ne++){if(Re(Ee[_e][ne],Me,oe,Rt,cr)===!1)return!1;Me++}Ut==="MultiLineString"&&Rt++,Ut==="Polygon"&&cr++}Ut==="Polygon"&&Rt++;break;case"MultiPolygon":for(_e=0;_e<Ee.length;_e++){for(cr=0,ne=0;ne<Ee[_e].length;ne++){for(Y=0;Y<Ee[_e][ne].length-X;Y++){if(Re(Ee[_e][ne][Y],Me,oe,Rt,cr)===!1)return!1;Me++}cr++}Rt++}break;case"GeometryCollection":for(_e=0;_e<Le.geometries.length;_e++)if(D(Le.geometries[_e],Re,ye)===!1)return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function G(le,Re,ye,_e){var ne=ye;return D(le,function(Y,Le,de,Ee,ge){Le===0&&ye===void 0?ne=Y:ne=Re(ne,Y,Le,de,Ee,ge)},_e),ne}function Z(le,Re){var ye;switch(le.type){case"FeatureCollection":for(ye=0;ye<le.features.length&&Re(le.features[ye].properties,ye)!==!1;ye++);break;case"Feature":Re(le.properties,0);break}}function F(le,Re,ye){var _e=ye;return Z(le,function(ne,Y){Y===0&&ye===void 0?_e=ne:_e=Re(_e,ne,Y)}),_e}function z(le,Re){if(le.type==="Feature")Re(le,0);else if(le.type==="FeatureCollection")for(var ye=0;ye<le.features.length&&Re(le.features[ye],ye)!==!1;ye++);}function q(le,Re,ye){var _e=ye;return z(le,function(ne,Y){Y===0&&ye===void 0?_e=ne:_e=Re(_e,ne,Y)}),_e}function ee(le){var Re=[];return D(le,function(ye){Re.push(ye)}),Re}function fe(le,Re){var ye,_e,ne,Y,Le,de,Ee,ge,X,Me,Ae=0,me=le.type==="FeatureCollection",ue=le.type==="Feature",ke=me?le.features.length:1;for(ye=0;ye<ke;ye++){for(de=me?le.features[ye].geometry:ue?le.geometry:le,ge=me?le.features[ye].properties:ue?le.properties:{},X=me?le.features[ye].bbox:ue?le.bbox:void 0,Me=me?le.features[ye].id:ue?le.id:void 0,Ee=de?de.type==="GeometryCollection":!1,Le=Ee?de.geometries.length:1,ne=0;ne<Le;ne++){if(Y=Ee?de.geometries[ne]:de,Y===null){if(Re(null,Ae,ge,X,Me)===!1)return!1;continue}switch(Y.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":{if(Re(Y,Ae,ge,X,Me)===!1)return!1;break}case"GeometryCollection":{for(_e=0;_e<Y.geometries.length;_e++)if(Re(Y.geometries[_e],Ae,ge,X,Me)===!1)return!1;break}default:throw new Error("Unknown Geometry Type")}}Ae++}}function be(le,Re,ye){var _e=ye;return fe(le,function(ne,Y,Le,de,Ee){Y===0&&ye===void 0?_e=ne:_e=Re(_e,ne,Y,Le,de,Ee)}),_e}function Ie(le,Re){fe(le,function(ye,_e,ne,Y,Le){var de=ye===null?null:ye.type;switch(de){case null:case"Point":case"LineString":case"Polygon":return Re(P.feature(ye,ne,{bbox:Y,id:Le}),_e,0)===!1?!1:void 0}var Ee;switch(de){case"MultiPoint":Ee="Point";break;case"MultiLineString":Ee="LineString";break;case"MultiPolygon":Ee="Polygon";break}for(var ge=0;ge<ye.coordinates.length;ge++){var X=ye.coordinates[ge],Me={type:Ee,coordinates:X};if(Re(P.feature(Me,ne),_e,ge)===!1)return!1}})}function Oe(le,Re,ye){var _e=ye;return Ie(le,function(ne,Y,Le){Y===0&&Le===0&&ye===void 0?_e=ne:_e=Re(_e,ne,Y,Le)}),_e}function He(le,Re){Ie(le,function(ye,_e,ne){var Y=0;if(ye.geometry){var Le=ye.geometry.type;if(!(Le==="Point"||Le==="MultiPoint")){var de,Ee=0,ge=0,X=0;if(D(ye,function(Me,Ae,me,ue,ke){if(de===void 0||_e>Ee||ue>ge||ke>X){de=Me,Ee=_e,ge=ue,X=ke,Y=0;return}var Ze=P.lineString([de,Me],ye.properties);if(Re(Ze,_e,ne,ke,Y)===!1)return!1;Y++,de=Me})===!1)return!1}}})}function st(le,Re,ye){var _e=ye,ne=!1;return He(le,function(Y,Le,de,Ee,ge){ne===!1&&ye===void 0?_e=Y:_e=Re(_e,Y,Le,de,Ee,ge),ne=!0}),_e}function De(le,Re){if(!le)throw new Error("geojson is required");Ie(le,function(ye,_e,ne){if(ye.geometry!==null){var Y=ye.geometry.type,Le=ye.geometry.coordinates;switch(Y){case"LineString":if(Re(ye,_e,ne,0,0)===!1)return!1;break;case"Polygon":for(var de=0;de<Le.length;de++)if(Re(P.lineString(Le[de],ye.properties),_e,ne,de)===!1)return!1;break}}})}function je(le,Re,ye){var _e=ye;return De(le,function(ne,Y,Le,de){Y===0&&ye===void 0?_e=ne:_e=Re(_e,ne,Y,Le,de)}),_e}function we(le,Re){if(Re=Re||{},!P.isObject(Re))throw new Error("options is invalid");var ye=Re.featureIndex||0,_e=Re.multiFeatureIndex||0,ne=Re.geometryIndex||0,Y=Re.segmentIndex||0,Le=Re.properties,de;switch(le.type){case"FeatureCollection":ye<0&&(ye=le.features.length+ye),Le=Le||le.features[ye].properties,de=le.features[ye].geometry;break;case"Feature":Le=Le||le.properties,de=le.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":de=le;break;default:throw new Error("geojson is invalid")}if(de===null)return null;var Ee=de.coordinates;switch(de.type){case"Point":case"MultiPoint":return null;case"LineString":return Y<0&&(Y=Ee.length+Y-1),P.lineString([Ee[Y],Ee[Y+1]],Le,Re);case"Polygon":return ne<0&&(ne=Ee.length+ne),Y<0&&(Y=Ee[ne].length+Y-1),P.lineString([Ee[ne][Y],Ee[ne][Y+1]],Le,Re);case"MultiLineString":return _e<0&&(_e=Ee.length+_e),Y<0&&(Y=Ee[_e].length+Y-1),P.lineString([Ee[_e][Y],Ee[_e][Y+1]],Le,Re);case"MultiPolygon":return _e<0&&(_e=Ee.length+_e),ne<0&&(ne=Ee[_e].length+ne),Y<0&&(Y=Ee[_e][ne].length-Y-1),P.lineString([Ee[_e][ne][Y],Ee[_e][ne][Y+1]],Le,Re)}throw new Error("geojson is invalid")}function Te(le,Re){if(Re=Re||{},!P.isObject(Re))throw new Error("options is invalid");var ye=Re.featureIndex||0,_e=Re.multiFeatureIndex||0,ne=Re.geometryIndex||0,Y=Re.coordIndex||0,Le=Re.properties,de;switch(le.type){case"FeatureCollection":ye<0&&(ye=le.features.length+ye),Le=Le||le.features[ye].properties,de=le.features[ye].geometry;break;case"Feature":Le=Le||le.properties,de=le.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":de=le;break;default:throw new Error("geojson is invalid")}if(de===null)return null;var Ee=de.coordinates;switch(de.type){case"Point":return P.point(Ee,Le,Re);case"MultiPoint":return _e<0&&(_e=Ee.length+_e),P.point(Ee[_e],Le,Re);case"LineString":return Y<0&&(Y=Ee.length+Y),P.point(Ee[Y],Le,Re);case"Polygon":return ne<0&&(ne=Ee.length+ne),Y<0&&(Y=Ee[ne].length+Y),P.point(Ee[ne][Y],Le,Re);case"MultiLineString":return _e<0&&(_e=Ee.length+_e),Y<0&&(Y=Ee[_e].length+Y),P.point(Ee[_e][Y],Le,Re);case"MultiPolygon":return _e<0&&(_e=Ee.length+_e),ne<0&&(ne=Ee[_e].length+ne),Y<0&&(Y=Ee[_e][ne].length-Y),P.point(Ee[_e][ne][Y],Le,Re)}throw new Error("geojson is invalid")}$.coordAll=ee,$.coordEach=D,$.coordReduce=G,$.featureEach=z,$.featureReduce=q,$.findPoint=Te,$.findSegment=we,$.flattenEach=Ie,$.flattenReduce=Oe,$.geomEach=fe,$.geomReduce=be,$.lineEach=De,$.lineReduce=je,$.propEach=Z,$.propReduce=F,$.segmentEach=He,$.segmentReduce=st},97683:function(se,$,C){"use strict";var P=C(44532),D=C(71262),G=D(P("String.prototype.indexOf"));se.exports=function(F,z){var q=P(F,!!z);return typeof q=="function"&&G(F,".prototype.")>-1?D(q):q}},71262:function(se,$,C){"use strict";var P=C(36723),D=C(44532),G=C(59662),Z=D("%TypeError%"),F=D("%Function.prototype.apply%"),z=D("%Function.prototype.call%"),q=D("%Reflect.apply%",!0)||P.call(z,F),ee=D("%Object.defineProperty%",!0),fe=D("%Math.max%");if(ee)try{ee({},"a",{value:1})}catch(Ie){ee=null}se.exports=function(Oe){if(typeof Oe!="function")throw new Z("a function is required");var He=q(P,z,arguments);return G(He,1+fe(0,Oe.length-(arguments.length-1)),!0)};var be=function(){return q(P,F,arguments)};ee?ee(se.exports,"apply",{value:be}):se.exports.apply=be},24538:function(se,$,C){"use strict";var P=C(79535),D=C(93285),G=C(76469),Z=C(45229).orient2d;D.default&&(D=D.default),se.exports=F,se.exports.default=F;function F(ye,_e,ne){_e=Math.max(0,_e===void 0?2:_e),ne=ne||0;var Y=st(ye),Le=new P(16);Le.toBBox=function(cr){return{minX:cr[0],minY:cr[1],maxX:cr[0],maxY:cr[1]}},Le.compareMinX=function(cr,Ut){return cr[0]-Ut[0]},Le.compareMinY=function(cr,Ut){return cr[1]-Ut[1]},Le.load(ye);for(var de=[],Ee=0,ge;Ee<Y.length;Ee++){var X=Y[Ee];Le.remove(X),ge=De(X,ge),de.push(ge)}var Me=new P(16);for(Ee=0;Ee<de.length;Ee++)Me.insert(He(de[Ee]));for(var Ae=_e*_e,me=ne*ne;de.length;){var ue=de.shift(),ke=ue.p,Ze=ue.next.p,oe=je(ke,Ze);if(!(oe<me)){var Dt=oe/Ae;X=z(Le,ue.prev.p,ke,Ze,ue.next.next.p,Dt,Me),X&&Math.min(je(X,ke),je(X,Ze))<=Dt&&(de.push(ue),de.push(De(X,ue)),Le.remove(X),Me.remove(ue),Me.insert(He(ue)),Me.insert(He(ue.next)))}}ue=ge;var Rt=[];do Rt.push(ue.p),ue=ue.next;while(ue!==ge);return Rt.push(ue.p),Rt}function z(ye,_e,ne,Y,Le,de,Ee){for(var ge=new D([],q),X=ye.data;X;){for(var Me=0;Me<X.children.length;Me++){var Ae=X.children[Me],me=X.leaf?we(Ae,ne,Y):ee(ne,Y,Ae);me>de||ge.push({node:Ae,dist:me})}for(;ge.length&&!ge.peek().node.children;){var ue=ge.pop(),ke=ue.node,Ze=we(ke,_e,ne),oe=we(ke,Y,Le);if(ue.dist<Ze&&ue.dist<oe&&be(ne,ke,Ee)&&be(Y,ke,Ee))return ke}X=ge.pop(),X&&(X=X.node)}return null}function q(ye,_e){return ye.dist-_e.dist}function ee(ye,_e,ne){if(fe(ye,ne)||fe(_e,ne))return 0;var Y=Te(ye[0],ye[1],_e[0],_e[1],ne.minX,ne.minY,ne.maxX,ne.minY);if(Y===0)return 0;var Le=Te(ye[0],ye[1],_e[0],_e[1],ne.minX,ne.minY,ne.minX,ne.maxY);if(Le===0)return 0;var de=Te(ye[0],ye[1],_e[0],_e[1],ne.maxX,ne.minY,ne.maxX,ne.maxY);if(de===0)return 0;var Ee=Te(ye[0],ye[1],_e[0],_e[1],ne.minX,ne.maxY,ne.maxX,ne.maxY);return Ee===0?0:Math.min(Y,Le,de,Ee)}function fe(ye,_e){return ye[0]>=_e.minX&&ye[0]<=_e.maxX&&ye[1]>=_e.minY&&ye[1]<=_e.maxY}function be(ye,_e,ne){for(var Y=Math.min(ye[0],_e[0]),Le=Math.min(ye[1],_e[1]),de=Math.max(ye[0],_e[0]),Ee=Math.max(ye[1],_e[1]),ge=ne.search({minX:Y,minY:Le,maxX:de,maxY:Ee}),X=0;X<ge.length;X++)if(Oe(ge[X].p,ge[X].next.p,ye,_e))return!1;return!0}function Ie(ye,_e,ne){return Z(ye[0],ye[1],_e[0],_e[1],ne[0],ne[1])}function Oe(ye,_e,ne,Y){return ye!==Y&&_e!==ne&&Ie(ye,_e,ne)>0!=Ie(ye,_e,Y)>0&&Ie(ne,Y,ye)>0!=Ie(ne,Y,_e)>0}function He(ye){var _e=ye.p,ne=ye.next.p;return ye.minX=Math.min(_e[0],ne[0]),ye.minY=Math.min(_e[1],ne[1]),ye.maxX=Math.max(_e[0],ne[0]),ye.maxY=Math.max(_e[1],ne[1]),ye}function st(ye){for(var _e=ye[0],ne=ye[0],Y=ye[0],Le=ye[0],de=0;de<ye.length;de++){var Ee=ye[de];Ee[0]<_e[0]&&(_e=Ee),Ee[0]>Y[0]&&(Y=Ee),Ee[1]<ne[1]&&(ne=Ee),Ee[1]>Le[1]&&(Le=Ee)}var ge=[_e,ne,Y,Le],X=ge.slice();for(de=0;de<ye.length;de++)G(ye[de],ge)||X.push(ye[de]);return Re(X)}function De(ye,_e){var ne={p:ye,prev:null,next:null,minX:0,minY:0,maxX:0,maxY:0};return _e?(ne.next=_e.next,ne.prev=_e,_e.next.prev=ne,_e.next=ne):(ne.prev=ne,ne.next=ne),ne}function je(ye,_e){var ne=ye[0]-_e[0],Y=ye[1]-_e[1];return ne*ne+Y*Y}function we(ye,_e,ne){var Y=_e[0],Le=_e[1],de=ne[0]-Y,Ee=ne[1]-Le;if(de!==0||Ee!==0){var ge=((ye[0]-Y)*de+(ye[1]-Le)*Ee)/(de*de+Ee*Ee);ge>1?(Y=ne[0],Le=ne[1]):ge>0&&(Y+=de*ge,Le+=Ee*ge)}return de=ye[0]-Y,Ee=ye[1]-Le,de*de+Ee*Ee}function Te(ye,_e,ne,Y,Le,de,Ee,ge){var X=ne-ye,Me=Y-_e,Ae=Ee-Le,me=ge-de,ue=ye-Le,ke=_e-de,Ze=X*X+Me*Me,oe=X*Ae+Me*me,Dt=Ae*Ae+me*me,Rt=X*ue+Me*ke,cr=Ae*ue+me*ke,Ut=Ze*Dt-oe*oe,$r,ln,Sr,Qr,Jr=Ut,_r=Ut;Ut===0?(ln=0,Jr=1,Qr=cr,_r=Dt):(ln=oe*cr-Dt*Rt,Qr=Ze*cr-oe*Rt,ln<0?(ln=0,Qr=cr,_r=Dt):ln>Jr&&(ln=Jr,Qr=cr+oe,_r=Dt)),Qr<0?(Qr=0,-Rt<0?ln=0:-Rt>Ze?ln=Jr:(ln=-Rt,Jr=Ze)):Qr>_r&&(Qr=_r,-Rt+oe<0?ln=0:-Rt+oe>Ze?ln=Jr:(ln=-Rt+oe,Jr=Ze)),$r=ln===0?0:ln/Jr,Sr=Qr===0?0:Qr/_r;var Gn=(1-$r)*ye+$r*ne,ti=(1-$r)*_e+$r*Y,Vn=(1-Sr)*Le+Sr*Ee,Xr=(1-Sr)*de+Sr*ge,sn=Vn-Gn,_n=Xr-ti;return sn*sn+_n*_n}function le(ye,_e){return ye[0]===_e[0]?ye[1]-_e[1]:ye[0]-_e[0]}function Re(ye){ye.sort(le);for(var _e=[],ne=0;ne<ye.length;ne++){for(;_e.length>=2&&Ie(_e[_e.length-2],_e[_e.length-1],ye[ne])<=0;)_e.pop();_e.push(ye[ne])}for(var Y=[],Le=ye.length-1;Le>=0;Le--){for(;Y.length>=2&&Ie(Y[Y.length-2],Y[Y.length-1],ye[Le])<=0;)Y.pop();Y.push(ye[Le])}return Y.pop(),_e.pop(),_e.concat(Y)}},57965:function(se,$,C){"use strict";C.d($,{j2:function(){return P},b4:function(){return q},YF:function(){return D},We:function(){return ee},TS:function(){return Re},VR:function(){return _e},G9:function(){return je},ly:function(){return we},sd:function(){return De}});function P(ne,Y){return ne<Y?-1:ne>Y?1:ne>=Y?0:NaN}function D(ne){return ne.length===1&&(ne=G(ne)),{left:function(Y,Le,de,Ee){for(de==null&&(de=0),Ee==null&&(Ee=Y.length);de<Ee;){var ge=de+Ee>>>1;ne(Y[ge],Le)<0?de=ge+1:Ee=ge}return de},right:function(Y,Le,de,Ee){for(de==null&&(de=0),Ee==null&&(Ee=Y.length);de<Ee;){var ge=de+Ee>>>1;ne(Y[ge],Le)>0?Ee=ge:de=ge+1}return de}}}function G(ne){return function(Y,Le){return P(ne(Y),Le)}}var Z=D(P),F=Z.right,z=Z.left,q=F;function ee(ne,Y){var Le=ne.length,de=-1,Ee,ge,X;if(Y==null){for(;++de<Le;)if((Ee=ne[de])!=null&&Ee>=Ee)for(ge=X=Ee;++de<Le;)(Ee=ne[de])!=null&&(ge>Ee&&(ge=Ee),X<Ee&&(X=Ee))}else for(;++de<Le;)if((Ee=Y(ne[de],de,ne))!=null&&Ee>=Ee)for(ge=X=Ee;++de<Le;)(Ee=Y(ne[de],de,ne))!=null&&(ge>Ee&&(ge=Ee),X<Ee&&(X=Ee));return[ge,X]}var fe=Array.prototype,be=fe.slice,Ie=fe.map,Oe=Math.sqrt(50),He=Math.sqrt(10),st=Math.sqrt(2);function De(ne,Y,Le){var de,Ee=-1,ge,X,Me;if(Y=+Y,ne=+ne,Le=+Le,ne===Y&&Le>0)return[ne];if((de=Y<ne)&&(ge=ne,ne=Y,Y=ge),(Me=je(ne,Y,Le))===0||!isFinite(Me))return[];if(Me>0)for(ne=Math.ceil(ne/Me),Y=Math.floor(Y/Me),X=new Array(ge=Math.ceil(Y-ne+1));++Ee<ge;)X[Ee]=(ne+Ee)*Me;else for(ne=Math.floor(ne*Me),Y=Math.ceil(Y*Me),X=new Array(ge=Math.ceil(ne-Y+1));++Ee<ge;)X[Ee]=(ne-Ee)/Me;return de&&X.reverse(),X}function je(ne,Y,Le){var de=(Y-ne)/Math.max(0,Le),Ee=Math.floor(Math.log(de)/Math.LN10),ge=de/Math.pow(10,Ee);return Ee>=0?(ge>=Oe?10:ge>=He?5:ge>=st?2:1)*Math.pow(10,Ee):-Math.pow(10,-Ee)/(ge>=Oe?10:ge>=He?5:ge>=st?2:1)}function we(ne,Y,Le){var de=Math.abs(Y-ne)/Math.max(0,Le),Ee=Math.pow(10,Math.floor(Math.log(de)/Math.LN10)),ge=de/Ee;return ge>=Oe?Ee*=10:ge>=He?Ee*=5:ge>=st&&(Ee*=2),Y<ne?-Ee:Ee}function Te(){var ne=identity,Y=extent,Le=sturges;function de(Ee){var ge,X=Ee.length,Me,Ae=new Array(X);for(ge=0;ge<X;++ge)Ae[ge]=ne(Ee[ge],ge,Ee);var me=Y(Ae),ue=me[0],ke=me[1],Ze=Le(Ae,ue,ke);Array.isArray(Ze)||(Ze=tickStep(ue,ke,Ze),Ze=range(Math.ceil(ue/Ze)*Ze,ke,Ze));for(var oe=Ze.length;Ze[0]<=ue;)Ze.shift(),--oe;for(;Ze[oe-1]>ke;)Ze.pop(),--oe;var Dt=new Array(oe+1),Rt;for(ge=0;ge<=oe;++ge)Rt=Dt[ge]=[],Rt.x0=ge>0?Ze[ge-1]:ue,Rt.x1=ge<oe?Ze[ge]:ke;for(ge=0;ge<X;++ge)Me=Ae[ge],ue<=Me&&Me<=ke&&Dt[bisect(Ze,Me,0,oe)].push(Ee[ge]);return Dt}return de.value=function(Ee){return arguments.length?(ne=typeof Ee=="function"?Ee:constant(Ee),de):ne},de.domain=function(Ee){return arguments.length?(Y=typeof Ee=="function"?Ee:constant([Ee[0],Ee[1]]),de):Y},de.thresholds=function(Ee){return arguments.length?(Le=typeof Ee=="function"?Ee:Array.isArray(Ee)?constant(slice.call(Ee)):constant(Ee),de):Le},de}function le(ne,Y,Le){return ne=map.call(ne,number).sort(ascending),Math.ceil((Le-Y)/(2*(quantile(ne,.75)-quantile(ne,.25))*Math.pow(ne.length,-1/3)))}function Re(ne){for(var Y=ne.length,Le,de=-1,Ee=0,ge,X;++de<Y;)Ee+=ne[de].length;for(ge=new Array(Ee);--Y>=0;)for(X=ne[Y],Le=X.length;--Le>=0;)ge[--Ee]=X[Le];return ge}function ye(ne){return ne===null?NaN:+ne}function _e(ne,Y,Le){if(Le==null&&(Le=ye),!!(de=ne.length)){if((Y=+Y)<=0||de<2)return+Le(ne[0],0,ne);if(Y>=1)return+Le(ne[de-1],de-1,ne);var de,Ee=(de-1)*Y,ge=Math.floor(Ee),X=+Le(ne[ge],ge,ne),Me=+Le(ne[ge+1],ge+1,ne);return X+(Me-X)*(Ee-ge)}}},19545:function(se,$,C){var P=C(64253),D=C(76051),G=C(6392),Z=C(11644),F=C(61245),z=C(5012),q=Date.prototype.getTime;function ee(Oe,He,st){var De=st||{};return(De.strict?G(Oe,He):Oe===He)?!0:!Oe||!He||typeof Oe!="object"&&typeof He!="object"?De.strict?G(Oe,He):Oe==He:Ie(Oe,He,De)}function fe(Oe){return Oe==null}function be(Oe){return!(!Oe||typeof Oe!="object"||typeof Oe.length!="number"||typeof Oe.copy!="function"||typeof Oe.slice!="function"||Oe.length>0&&typeof Oe[0]!="number")}function Ie(Oe,He,st){var De,je;if(typeof Oe!=typeof He||fe(Oe)||fe(He)||Oe.prototype!==He.prototype||D(Oe)!==D(He))return!1;var we=Z(Oe),Te=Z(He);if(we!==Te)return!1;if(we||Te)return Oe.source===He.source&&F(Oe)===F(He);if(z(Oe)&&z(He))return q.call(Oe)===q.call(He);var le=be(Oe),Re=be(He);if(le!==Re)return!1;if(le||Re){if(Oe.length!==He.length)return!1;for(De=0;De<Oe.length;De++)if(Oe[De]!==He[De])return!1;return!0}if(typeof Oe!=typeof He)return!1;try{var ye=P(Oe),_e=P(He)}catch(ne){return!1}if(ye.length!==_e.length)return!1;for(ye.sort(),_e.sort(),De=ye.length-1;De>=0;De--)if(ye[De]!=_e[De])return!1;for(De=ye.length-1;De>=0;De--)if(je=ye[De],!ee(Oe[je],He[je],st))return!1;return!0}se.exports=ee},51494:function(se,$,C){"use strict";var P=C(38262)(),D=C(44532),G=P&&D("%Object.defineProperty%",!0);if(G)try{G({},"a",{value:1})}catch(q){G=!1}var Z=D("%SyntaxError%"),F=D("%TypeError%"),z=C(67747);se.exports=function(ee,fe,be){if(!ee||typeof ee!="object"&&typeof ee!="function")throw new F("`obj` must be an object or a function`");if(typeof fe!="string"&&typeof fe!="symbol")throw new F("`property` must be a string or a symbol`");if(arguments.length>3&&typeof arguments[3]!="boolean"&&arguments[3]!==null)throw new F("`nonEnumerable`, if provided, must be a boolean or null");if(arguments.length>4&&typeof arguments[4]!="boolean"&&arguments[4]!==null)throw new F("`nonWritable`, if provided, must be a boolean or null");if(arguments.length>5&&typeof arguments[5]!="boolean"&&arguments[5]!==null)throw new F("`nonConfigurable`, if provided, must be a boolean or null");if(arguments.length>6&&typeof arguments[6]!="boolean")throw new F("`loose`, if provided, must be a boolean");var Ie=arguments.length>3?arguments[3]:null,Oe=arguments.length>4?arguments[4]:null,He=arguments.length>5?arguments[5]:null,st=arguments.length>6?arguments[6]:!1,De=!!z&&z(ee,fe);if(G)G(ee,fe,{configurable:He===null&&De?De.configurable:!He,enumerable:Ie===null&&De?De.enumerable:!Ie,value:be,writable:Oe===null&&De?De.writable:!Oe});else if(st||!Ie&&!Oe&&!He)ee[fe]=be;else throw new Z("This environment does not support defining a property as non-configurable, non-writable, or non-enumerable.")}},8263:function(se,$,C){"use strict";var P=C(64253),D=typeof Symbol=="function"&&typeof Symbol("foo")=="symbol",G=Object.prototype.toString,Z=Array.prototype.concat,F=C(51494),z=function(be){return typeof be=="function"&&G.call(be)==="[object Function]"},q=C(38262)(),ee=function(be,Ie,Oe,He){if(Ie in be){if(He===!0){if(be[Ie]===Oe)return}else if(!z(He)||!He())return}q?F(be,Ie,Oe,!0):F(be,Ie,Oe)},fe=function(be,Ie){var Oe=arguments.length>2?arguments[2]:{},He=P(Ie);D&&(He=Z.call(He,Object.getOwnPropertySymbols(Ie)));for(var st=0;st<He.length;st+=1)ee(be,He[st],Ie[He[st]],Oe[He[st]])};fe.supportsDescriptors=!!q,se.exports=fe},12009:function(se){function $(C,P,D,G){this.dataset=[],this.epsilon=1,this.minPts=2,this.distance=this._euclideanDistance,this.clusters=[],this.noise=[],this._visited=[],this._assigned=[],this._datasetLength=0,this._init(C,P,D,G)}$.prototype.run=function(C,P,D,G){this._init(C,P,D,G);for(var Z=0;Z<this._datasetLength;Z++)if(this._visited[Z]!==1){this._visited[Z]=1;var F=this._regionQuery(Z);if(F.length<this.minPts)this.noise.push(Z);else{var z=this.clusters.length;this.clusters.push([]),this._addToCluster(Z,z),this._expandCluster(z,F)}}return this.clusters},$.prototype._init=function(C,P,D,G){if(C){if(!(C instanceof Array))throw Error("Dataset must be of type array, "+typeof C+" given");this.dataset=C,this.clusters=[],this.noise=[],this._datasetLength=C.length,this._visited=new Array(this._datasetLength),this._assigned=new Array(this._datasetLength)}P&&(this.epsilon=P),D&&(this.minPts=D),G&&(this.distance=G)},$.prototype._expandCluster=function(C,P){for(var D=0;D<P.length;D++){var G=P[D];if(this._visited[G]!==1){this._visited[G]=1;var Z=this._regionQuery(G);Z.length>=this.minPts&&(P=this._mergeArrays(P,Z))}this._assigned[G]!==1&&this._addToCluster(G,C)}},$.prototype._addToCluster=function(C,P){this.clusters[P].push(C),this._assigned[C]=1},$.prototype._regionQuery=function(C){for(var P=[],D=0;D<this._datasetLength;D++){var G=this.distance(this.dataset[C],this.dataset[D]);G<this.epsilon&&P.push(D)}return P},$.prototype._mergeArrays=function(C,P){for(var D=P.length,G=0;G<D;G++){var Z=P[G];C.indexOf(Z)<0&&C.push(Z)}return C},$.prototype._euclideanDistance=function(C,P){for(var D=0,G=Math.min(C.length,P.length);G--;)D+=(C[G]-P[G])*(C[G]-P[G]);return Math.sqrt(D)},se.exports&&(se.exports=$)},72561:function(se){function $(C,P,D){this.k=3,this.dataset=[],this.assignments=[],this.centroids=[],this.init(C,P,D)}$.prototype.init=function(C,P,D){this.assignments=[],this.centroids=[],typeof C!="undefined"&&(this.dataset=C),typeof P!="undefined"&&(this.k=P),typeof D!="undefined"&&(this.distance=D)},$.prototype.run=function(C,P){this.init(C,P);for(var D=this.dataset.length,G=0;G<this.k;G++)this.centroids[G]=this.randomCentroid();for(var Z=!0;Z;){Z=this.assign();for(var F=0;F<this.k;F++){for(var z=new Array(be),q=0,ee=0;ee<be;ee++)z[ee]=0;for(var fe=0;fe<D;fe++){var be=this.dataset[fe].length;if(F===this.assignments[fe]){for(var ee=0;ee<be;ee++)z[ee]+=this.dataset[fe][ee];q++}}if(q>0){for(var ee=0;ee<be;ee++)z[ee]/=q;this.centroids[F]=z}else this.centroids[F]=this.randomCentroid(),Z=!0}}return this.getClusters()},$.prototype.randomCentroid=function(){var C=this.dataset.length-1,P,D;do D=Math.round(Math.random()*C),P=this.dataset[D];while(this.centroids.indexOf(P)>=0);return P},$.prototype.assign=function(){for(var C=!1,P=this.dataset.length,D,G=0;G<P;G++)D=this.argmin(this.dataset[G],this.centroids,this.distance),D!=this.assignments[G]&&(this.assignments[G]=D,C=!0);return C},$.prototype.getClusters=function(){for(var C=new Array(this.k),P,D=0;D<this.assignments.length;D++)P=this.assignments[D],typeof C[P]=="undefined"&&(C[P]=[]),C[P].push(D);return C},$.prototype.argmin=function(C,P,D){for(var G=Number.MAX_VALUE,Z=0,F=P.length,z,q=0;q<F;q++)z=D(C,P[q]),z<G&&(G=z,Z=q);return Z},$.prototype.distance=function(C,P){for(var D=0,G=Math.min(C.length,P.length);G--;){var Z=C[G]-P[G];D+=Z*Z}return Math.sqrt(D)},se.exports&&(se.exports=$)},88521:function(se,$,C){if(se.exports)var P=C(18909);function D(G,Z,F,z){this.epsilon=1,this.minPts=1,this.distance=this._euclideanDistance,this._reachability=[],this._processed=[],this._coreDistance=0,this._orderedList=[],this._init(G,Z,F,z)}D.prototype.run=function(G,Z,F,z){this._init(G,Z,F,z);for(var q=0,ee=this.dataset.length;q<ee;q++)if(this._processed[q]!==1){this._processed[q]=1,this.clusters.push([q]);var fe=this.clusters.length-1;this._orderedList.push(q);var be=new P(null,null,"asc"),Ie=this._regionQuery(q);this._distanceToCore(q)!==void 0&&(this._updateQueue(q,Ie,be),this._expandCluster(fe,be))}return this.clusters},D.prototype.getReachabilityPlot=function(){for(var G=[],Z=0,F=this._orderedList.length;Z<F;Z++){var z=this._orderedList[Z],q=this._reachability[z];G.push([z,q])}return G},D.prototype._init=function(G,Z,F,z){if(G){if(!(G instanceof Array))throw Error("Dataset must be of type array, "+typeof G+" given");this.dataset=G,this.clusters=[],this._reachability=new Array(this.dataset.length),this._processed=new Array(this.dataset.length),this._coreDistance=0,this._orderedList=[]}Z&&(this.epsilon=Z),F&&(this.minPts=F),z&&(this.distance=z)},D.prototype._updateQueue=function(G,Z,F){var z=this;this._coreDistance=this._distanceToCore(G),Z.forEach(function(q){if(z._processed[q]===void 0){var ee=z.distance(z.dataset[G],z.dataset[q]),fe=Math.max(z._coreDistance,ee);z._reachability[q]===void 0?(z._reachability[q]=fe,F.insert(q,fe)):fe<z._reachability[q]&&(z._reachability[q]=fe,F.remove(q),F.insert(q,fe))}})},D.prototype._expandCluster=function(G,Z){for(var F=Z.getElements(),z=0,q=F.length;z<q;z++){var ee=F[z];if(this._processed[ee]===void 0){var fe=this._regionQuery(ee);this._processed[ee]=1,this.clusters[G].push(ee),this._orderedList.push(ee),this._distanceToCore(ee)!==void 0&&(this._updateQueue(ee,fe,Z),this._expandCluster(G,Z))}}},D.prototype._distanceToCore=function(G){for(var Z=this.epsilon,F=0;F<Z;F++){var z=this._regionQuery(G,F);if(z.length>=this.minPts)return F}},D.prototype._regionQuery=function(G,Z){Z=Z||this.epsilon;for(var F=[],z=0,q=this.dataset.length;z<q;z++)this.distance(this.dataset[G],this.dataset[z])<Z&&F.push(z);return F},D.prototype._euclideanDistance=function(G,Z){for(var F=0,z=Math.min(G.length,Z.length);z--;)F+=(G[z]-Z[z])*(G[z]-Z[z]);return Math.sqrt(F)},se.exports&&(se.exports=D)},18909:function(se){function $(C,P,D){this._queue=[],this._priorities=[],this._sorting="desc",this._init(C,P,D)}$.prototype.insert=function(C,P){for(var D=this._queue.length,G=D;G--;){var Z=this._priorities[G];this._sorting==="desc"?P>Z&&(D=G):P<Z&&(D=G)}this._insertAt(C,P,D)},$.prototype.remove=function(C){for(var P=this._queue.length;P--;){var D=this._queue[P];if(C===D){this._queue.splice(P,1),this._priorities.splice(P,1);break}}},$.prototype.forEach=function(C){this._queue.forEach(C)},$.prototype.getElements=function(){return this._queue},$.prototype.getElementPriority=function(C){return this._priorities[C]},$.prototype.getPriorities=function(){return this._priorities},$.prototype.getElementsWithPriorities=function(){for(var C=[],P=0,D=this._queue.length;P<D;P++)C.push([this._queue[P],this._priorities[P]]);return C},$.prototype._init=function(C,P,D){if(C&&P){if(this._queue=[],this._priorities=[],C.length!==P.length)throw new Error("Arrays must have the same length");for(var G=0;G<C.length;G++)this.insert(C[G],P[G])}D&&(this._sorting=D)},$.prototype._insertAt=function(C,P,D){this._queue.length===D?(this._queue.push(C),this._priorities.push(P)):(this._queue.splice(D,0,C),this._priorities.splice(D,0,P))},se.exports&&(se.exports=$)},70298:function(se,$,C){se.exports&&(se.exports={DBSCAN:C(12009),KMEANS:C(72561),OPTICS:C(88521),PriorityQueue:C(18909)})},80569:function(se){"use strict";se.exports=$,se.exports.default=$;function $(Ae,me,ue){ue=ue||2;var ke=me&&me.length,Ze=ke?me[0]*ue:Ae.length,oe=C(Ae,0,Ze,ue,!0),Dt=[];if(!oe||oe.next===oe.prev)return Dt;var Rt,cr,Ut,$r,ln,Sr,Qr;if(ke&&(oe=q(Ae,me,oe,ue)),Ae.length>80*ue){Rt=Ut=Ae[0],cr=$r=Ae[1];for(var Jr=ue;Jr<Ze;Jr+=ue)ln=Ae[Jr],Sr=Ae[Jr+1],ln<Rt&&(Rt=ln),Sr<cr&&(cr=Sr),ln>Ut&&(Ut=ln),Sr>$r&&($r=Sr);Qr=Math.max(Ut-Rt,$r-cr),Qr=Qr!==0?32767/Qr:0}return D(oe,Dt,ue,Rt,cr,Qr,0),Dt}function C(Ae,me,ue,ke,Ze){var oe,Dt;if(Ze===Me(Ae,me,ue,ke)>0)for(oe=me;oe<ue;oe+=ke)Dt=Ee(oe,Ae[oe],Ae[oe+1],Dt);else for(oe=ue-ke;oe>=me;oe-=ke)Dt=Ee(oe,Ae[oe],Ae[oe+1],Dt);return Dt&&le(Dt,Dt.next)&&(ge(Dt),Dt=Dt.next),Dt}function P(Ae,me){if(!Ae)return Ae;me||(me=Ae);var ue=Ae,ke;do if(ke=!1,!ue.steiner&&(le(ue,ue.next)||Te(ue.prev,ue,ue.next)===0)){if(ge(ue),ue=me=ue.prev,ue===ue.next)break;ke=!0}else ue=ue.next;while(ke||ue!==me);return me}function D(Ae,me,ue,ke,Ze,oe,Dt){if(Ae){!Dt&&oe&&Oe(Ae,ke,Ze,oe);for(var Rt=Ae,cr,Ut;Ae.prev!==Ae.next;){if(cr=Ae.prev,Ut=Ae.next,oe?Z(Ae,ke,Ze,oe):G(Ae)){me.push(cr.i/ue|0),me.push(Ae.i/ue|0),me.push(Ut.i/ue|0),ge(Ae),Ae=Ut.next,Rt=Ut.next;continue}if(Ae=Ut,Ae===Rt){Dt?Dt===1?(Ae=F(P(Ae),me,ue),D(Ae,me,ue,ke,Ze,oe,2)):Dt===2&&z(Ae,me,ue,ke,Ze,oe):D(P(Ae),me,ue,ke,Ze,oe,1);break}}}}function G(Ae){var me=Ae.prev,ue=Ae,ke=Ae.next;if(Te(me,ue,ke)>=0)return!1;for(var Ze=me.x,oe=ue.x,Dt=ke.x,Rt=me.y,cr=ue.y,Ut=ke.y,$r=Ze<oe?Ze<Dt?Ze:Dt:oe<Dt?oe:Dt,ln=Rt<cr?Rt<Ut?Rt:Ut:cr<Ut?cr:Ut,Sr=Ze>oe?Ze>Dt?Ze:Dt:oe>Dt?oe:Dt,Qr=Rt>cr?Rt>Ut?Rt:Ut:cr>Ut?cr:Ut,Jr=ke.next;Jr!==me;){if(Jr.x>=$r&&Jr.x<=Sr&&Jr.y>=ln&&Jr.y<=Qr&&je(Ze,Rt,oe,cr,Dt,Ut,Jr.x,Jr.y)&&Te(Jr.prev,Jr,Jr.next)>=0)return!1;Jr=Jr.next}return!0}function Z(Ae,me,ue,ke){var Ze=Ae.prev,oe=Ae,Dt=Ae.next;if(Te(Ze,oe,Dt)>=0)return!1;for(var Rt=Ze.x,cr=oe.x,Ut=Dt.x,$r=Ze.y,ln=oe.y,Sr=Dt.y,Qr=Rt<cr?Rt<Ut?Rt:Ut:cr<Ut?cr:Ut,Jr=$r<ln?$r<Sr?$r:Sr:ln<Sr?ln:Sr,_r=Rt>cr?Rt>Ut?Rt:Ut:cr>Ut?cr:Ut,Gn=$r>ln?$r>Sr?$r:Sr:ln>Sr?ln:Sr,ti=st(Qr,Jr,me,ue,ke),Vn=st(_r,Gn,me,ue,ke),Xr=Ae.prevZ,sn=Ae.nextZ;Xr&&Xr.z>=ti&&sn&&sn.z<=Vn;){if(Xr.x>=Qr&&Xr.x<=_r&&Xr.y>=Jr&&Xr.y<=Gn&&Xr!==Ze&&Xr!==Dt&&je(Rt,$r,cr,ln,Ut,Sr,Xr.x,Xr.y)&&Te(Xr.prev,Xr,Xr.next)>=0||(Xr=Xr.prevZ,sn.x>=Qr&&sn.x<=_r&&sn.y>=Jr&&sn.y<=Gn&&sn!==Ze&&sn!==Dt&&je(Rt,$r,cr,ln,Ut,Sr,sn.x,sn.y)&&Te(sn.prev,sn,sn.next)>=0))return!1;sn=sn.nextZ}for(;Xr&&Xr.z>=ti;){if(Xr.x>=Qr&&Xr.x<=_r&&Xr.y>=Jr&&Xr.y<=Gn&&Xr!==Ze&&Xr!==Dt&&je(Rt,$r,cr,ln,Ut,Sr,Xr.x,Xr.y)&&Te(Xr.prev,Xr,Xr.next)>=0)return!1;Xr=Xr.prevZ}for(;sn&&sn.z<=Vn;){if(sn.x>=Qr&&sn.x<=_r&&sn.y>=Jr&&sn.y<=Gn&&sn!==Ze&&sn!==Dt&&je(Rt,$r,cr,ln,Ut,Sr,sn.x,sn.y)&&Te(sn.prev,sn,sn.next)>=0)return!1;sn=sn.nextZ}return!0}function F(Ae,me,ue){var ke=Ae;do{var Ze=ke.prev,oe=ke.next.next;!le(Ze,oe)&&Re(Ze,ke,ke.next,oe)&&Y(Ze,oe)&&Y(oe,Ze)&&(me.push(Ze.i/ue|0),me.push(ke.i/ue|0),me.push(oe.i/ue|0),ge(ke),ge(ke.next),ke=Ae=oe),ke=ke.next}while(ke!==Ae);return P(ke)}function z(Ae,me,ue,ke,Ze,oe){var Dt=Ae;do{for(var Rt=Dt.next.next;Rt!==Dt.prev;){if(Dt.i!==Rt.i&&we(Dt,Rt)){var cr=de(Dt,Rt);Dt=P(Dt,Dt.next),cr=P(cr,cr.next),D(Dt,me,ue,ke,Ze,oe,0),D(cr,me,ue,ke,Ze,oe,0);return}Rt=Rt.next}Dt=Dt.next}while(Dt!==Ae)}function q(Ae,me,ue,ke){var Ze=[],oe,Dt,Rt,cr,Ut;for(oe=0,Dt=me.length;oe<Dt;oe++)Rt=me[oe]*ke,cr=oe<Dt-1?me[oe+1]*ke:Ae.length,Ut=C(Ae,Rt,cr,ke,!1),Ut===Ut.next&&(Ut.steiner=!0),Ze.push(De(Ut));for(Ze.sort(ee),oe=0;oe<Ze.length;oe++)ue=fe(Ze[oe],ue);return ue}function ee(Ae,me){return Ae.x-me.x}function fe(Ae,me){var ue=be(Ae,me);if(!ue)return me;var ke=de(ue,Ae);return P(ke,ke.next),P(ue,ue.next)}function be(Ae,me){var ue=me,ke=Ae.x,Ze=Ae.y,oe=-1/0,Dt;do{if(Ze<=ue.y&&Ze>=ue.next.y&&ue.next.y!==ue.y){var Rt=ue.x+(Ze-ue.y)*(ue.next.x-ue.x)/(ue.next.y-ue.y);if(Rt<=ke&&Rt>oe&&(oe=Rt,Dt=ue.x<ue.next.x?ue:ue.next,Rt===ke))return Dt}ue=ue.next}while(ue!==me);if(!Dt)return null;var cr=Dt,Ut=Dt.x,$r=Dt.y,ln=1/0,Sr;ue=Dt;do ke>=ue.x&&ue.x>=Ut&&ke!==ue.x&&je(Ze<$r?ke:oe,Ze,Ut,$r,Ze<$r?oe:ke,Ze,ue.x,ue.y)&&(Sr=Math.abs(Ze-ue.y)/(ke-ue.x),Y(ue,Ae)&&(Sr<ln||Sr===ln&&(ue.x>Dt.x||ue.x===Dt.x&&Ie(Dt,ue)))&&(Dt=ue,ln=Sr)),ue=ue.next;while(ue!==cr);return Dt}function Ie(Ae,me){return Te(Ae.prev,Ae,me.prev)<0&&Te(me.next,Ae,Ae.next)<0}function Oe(Ae,me,ue,ke){var Ze=Ae;do Ze.z===0&&(Ze.z=st(Ze.x,Ze.y,me,ue,ke)),Ze.prevZ=Ze.prev,Ze.nextZ=Ze.next,Ze=Ze.next;while(Ze!==Ae);Ze.prevZ.nextZ=null,Ze.prevZ=null,He(Ze)}function He(Ae){var me,ue,ke,Ze,oe,Dt,Rt,cr,Ut=1;do{for(ue=Ae,Ae=null,oe=null,Dt=0;ue;){for(Dt++,ke=ue,Rt=0,me=0;me<Ut&&(Rt++,ke=ke.nextZ,!!ke);me++);for(cr=Ut;Rt>0||cr>0&&ke;)Rt!==0&&(cr===0||!ke||ue.z<=ke.z)?(Ze=ue,ue=ue.nextZ,Rt--):(Ze=ke,ke=ke.nextZ,cr--),oe?oe.nextZ=Ze:Ae=Ze,Ze.prevZ=oe,oe=Ze;ue=ke}oe.nextZ=null,Ut*=2}while(Dt>1);return Ae}function st(Ae,me,ue,ke,Ze){return Ae=(Ae-ue)*Ze|0,me=(me-ke)*Ze|0,Ae=(Ae|Ae<<8)&16711935,Ae=(Ae|Ae<<4)&252645135,Ae=(Ae|Ae<<2)&858993459,Ae=(Ae|Ae<<1)&1431655765,me=(me|me<<8)&16711935,me=(me|me<<4)&252645135,me=(me|me<<2)&858993459,me=(me|me<<1)&1431655765,Ae|me<<1}function De(Ae){var me=Ae,ue=Ae;do(me.x<ue.x||me.x===ue.x&&me.y<ue.y)&&(ue=me),me=me.next;while(me!==Ae);return ue}function je(Ae,me,ue,ke,Ze,oe,Dt,Rt){return(Ze-Dt)*(me-Rt)>=(Ae-Dt)*(oe-Rt)&&(Ae-Dt)*(ke-Rt)>=(ue-Dt)*(me-Rt)&&(ue-Dt)*(oe-Rt)>=(Ze-Dt)*(ke-Rt)}function we(Ae,me){return Ae.next.i!==me.i&&Ae.prev.i!==me.i&&!ne(Ae,me)&&(Y(Ae,me)&&Y(me,Ae)&&Le(Ae,me)&&(Te(Ae.prev,Ae,me.prev)||Te(Ae,me.prev,me))||le(Ae,me)&&Te(Ae.prev,Ae,Ae.next)>0&&Te(me.prev,me,me.next)>0)}function Te(Ae,me,ue){return(me.y-Ae.y)*(ue.x-me.x)-(me.x-Ae.x)*(ue.y-me.y)}function le(Ae,me){return Ae.x===me.x&&Ae.y===me.y}function Re(Ae,me,ue,ke){var Ze=_e(Te(Ae,me,ue)),oe=_e(Te(Ae,me,ke)),Dt=_e(Te(ue,ke,Ae)),Rt=_e(Te(ue,ke,me));return!!(Ze!==oe&&Dt!==Rt||Ze===0&&ye(Ae,ue,me)||oe===0&&ye(Ae,ke,me)||Dt===0&&ye(ue,Ae,ke)||Rt===0&&ye(ue,me,ke))}function ye(Ae,me,ue){return me.x<=Math.max(Ae.x,ue.x)&&me.x>=Math.min(Ae.x,ue.x)&&me.y<=Math.max(Ae.y,ue.y)&&me.y>=Math.min(Ae.y,ue.y)}function _e(Ae){return Ae>0?1:Ae<0?-1:0}function ne(Ae,me){var ue=Ae;do{if(ue.i!==Ae.i&&ue.next.i!==Ae.i&&ue.i!==me.i&&ue.next.i!==me.i&&Re(ue,ue.next,Ae,me))return!0;ue=ue.next}while(ue!==Ae);return!1}function Y(Ae,me){return Te(Ae.prev,Ae,Ae.next)<0?Te(Ae,me,Ae.next)>=0&&Te(Ae,Ae.prev,me)>=0:Te(Ae,me,Ae.prev)<0||Te(Ae,Ae.next,me)<0}function Le(Ae,me){var ue=Ae,ke=!1,Ze=(Ae.x+me.x)/2,oe=(Ae.y+me.y)/2;do ue.y>oe!=ue.next.y>oe&&ue.next.y!==ue.y&&Ze<(ue.next.x-ue.x)*(oe-ue.y)/(ue.next.y-ue.y)+ue.x&&(ke=!ke),ue=ue.next;while(ue!==Ae);return ke}function de(Ae,me){var ue=new X(Ae.i,Ae.x,Ae.y),ke=new X(me.i,me.x,me.y),Ze=Ae.next,oe=me.prev;return Ae.next=me,me.prev=Ae,ue.next=Ze,Ze.prev=ue,ke.next=ue,ue.prev=ke,oe.next=ke,ke.prev=oe,ke}function Ee(Ae,me,ue,ke){var Ze=new X(Ae,me,ue);return ke?(Ze.next=ke.next,Ze.prev=ke,ke.next.prev=Ze,ke.next=Ze):(Ze.prev=Ze,Ze.next=Ze),Ze}function ge(Ae){Ae.next.prev=Ae.prev,Ae.prev.next=Ae.next,Ae.prevZ&&(Ae.prevZ.nextZ=Ae.nextZ),Ae.nextZ&&(Ae.nextZ.prevZ=Ae.prevZ)}function X(Ae,me,ue){this.i=Ae,this.x=me,this.y=ue,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}$.deviation=function(Ae,me,ue,ke){var Ze=me&&me.length,oe=Ze?me[0]*ue:Ae.length,Dt=Math.abs(Me(Ae,0,oe,ue));if(Ze)for(var Rt=0,cr=me.length;Rt<cr;Rt++){var Ut=me[Rt]*ue,$r=Rt<cr-1?me[Rt+1]*ue:Ae.length;Dt-=Math.abs(Me(Ae,Ut,$r,ue))}var ln=0;for(Rt=0;Rt<ke.length;Rt+=3){var Sr=ke[Rt]*ue,Qr=ke[Rt+1]*ue,Jr=ke[Rt+2]*ue;ln+=Math.abs((Ae[Sr]-Ae[Jr])*(Ae[Qr+1]-Ae[Sr+1])-(Ae[Sr]-Ae[Qr])*(Ae[Jr+1]-Ae[Sr+1]))}return Dt===0&&ln===0?0:Math.abs((ln-Dt)/Dt)};function Me(Ae,me,ue,ke){for(var Ze=0,oe=me,Dt=ue-ke;oe<ue;oe+=ke)Ze+=(Ae[Dt]-Ae[oe])*(Ae[oe+1]+Ae[Dt+1]),Dt=oe;return Ze}$.flatten=function(Ae){for(var me=Ae[0][0].length,ue={vertices:[],holes:[],dimensions:me},ke=0,Ze=0;Ze<Ae.length;Ze++){for(var oe=0;oe<Ae[Ze].length;oe++)for(var Dt=0;Dt<me;Dt++)ue.vertices.push(Ae[Ze][oe][Dt]);Ze>0&&(ke+=Ae[Ze-1].length,ue.holes.push(ke))}return ue}},67499:function(se){function $(P){var D=P.target||P.srcElement;D.__resizeRAF__&&cancelAnimationFrame(D.__resizeRAF__),D.__resizeRAF__=requestAnimationFrame(function(){var G=D.__resizeTrigger__,Z=G&&G.__resizeListeners__;Z&&Z.forEach(function(F){F.call(G,P)})})}var C=function(D,G){var Z=this,F=Z.document,z,q=F.attachEvent;typeof navigator!="undefined"&&(z=navigator.userAgent.match(/Trident/)||navigator.userAgent.match(/Edge/));function ee(){this.contentDocument.defaultView.__resizeTrigger__=this.__resizeElement__,this.contentDocument.defaultView.addEventListener("resize",$)}if(!D.__resizeListeners__)if(D.__resizeListeners__=[],q)D.__resizeTrigger__=D,D.attachEvent("onresize",$);else{getComputedStyle(D).position==="static"&&(D.style.position="relative");var fe=D.__resizeTrigger__=F.createElement("object");fe.setAttribute("style","position: absolute; top: 0; left: 0; height: 100%; width: 100%; pointer-events: none; z-index: -1; opacity: 0;"),fe.setAttribute("class","resize-sensor"),fe.setAttribute("tabindex","-1"),fe.setAttribute("title",""),fe.__resizeElement__=D,fe.onload=ee,fe.type="text/html",z&&D.appendChild(fe),fe.data="about:blank",z||D.appendChild(fe)}D.__resizeListeners__.push(G)};se.exports=typeof window=="undefined"?C:C.bind(window),se.exports.unbind=function(P,D){var G=document.attachEvent,Z=P.__resizeListeners__||[];if(D){var F=Z.indexOf(D);F!==-1&&Z.splice(F,1)}else Z=P.__resizeListeners__=[];if(!Z.length){if(G)P.detachEvent("onresize",$);else if(P.__resizeTrigger__){var z=P.__resizeTrigger__.contentDocument,q=z&&z.defaultView;q&&(q.removeEventListener("resize",$),delete q.__resizeTrigger__),P.__resizeTrigger__=!P.removeChild(P.__resizeTrigger__)}delete P.__resizeListeners__}}},40666:function(se){"use strict";var $=Object.prototype.hasOwnProperty,C="~";function P(){}Object.create&&(P.prototype=Object.create(null),new P().__proto__||(C=!1));function D(z,q,ee){this.fn=z,this.context=q,this.once=ee||!1}function G(z,q,ee,fe,be){if(typeof ee!="function")throw new TypeError("The listener must be a function");var Ie=new D(ee,fe||z,be),Oe=C?C+q:q;return z._events[Oe]?z._events[Oe].fn?z._events[Oe]=[z._events[Oe],Ie]:z._events[Oe].push(Ie):(z._events[Oe]=Ie,z._eventsCount++),z}function Z(z,q){--z._eventsCount===0?z._events=new P:delete z._events[q]}function F(){this._events=new P,this._eventsCount=0}F.prototype.eventNames=function(){var q=[],ee,fe;if(this._eventsCount===0)return q;for(fe in ee=this._events)$.call(ee,fe)&&q.push(C?fe.slice(1):fe);return Object.getOwnPropertySymbols?q.concat(Object.getOwnPropertySymbols(ee)):q},F.prototype.listeners=function(q){var ee=C?C+q:q,fe=this._events[ee];if(!fe)return[];if(fe.fn)return[fe.fn];for(var be=0,Ie=fe.length,Oe=new Array(Ie);be<Ie;be++)Oe[be]=fe[be].fn;return Oe},F.prototype.listenerCount=function(q){var ee=C?C+q:q,fe=this._events[ee];return fe?fe.fn?1:fe.length:0},F.prototype.emit=function(q,ee,fe,be,Ie,Oe){var He=C?C+q:q;if(!this._events[He])return!1;var st=this._events[He],De=arguments.length,je,we;if(st.fn){switch(st.once&&this.removeListener(q,st.fn,void 0,!0),De){case 1:return st.fn.call(st.context),!0;case 2:return st.fn.call(st.context,ee),!0;case 3:return st.fn.call(st.context,ee,fe),!0;case 4:return st.fn.call(st.context,ee,fe,be),!0;case 5:return st.fn.call(st.context,ee,fe,be,Ie),!0;case 6:return st.fn.call(st.context,ee,fe,be,Ie,Oe),!0}for(we=1,je=new Array(De-1);we<De;we++)je[we-1]=arguments[we];st.fn.apply(st.context,je)}else{var Te=st.length,le;for(we=0;we<Te;we++)switch(st[we].once&&this.removeListener(q,st[we].fn,void 0,!0),De){case 1:st[we].fn.call(st[we].context);break;case 2:st[we].fn.call(st[we].context,ee);break;case 3:st[we].fn.call(st[we].context,ee,fe);break;case 4:st[we].fn.call(st[we].context,ee,fe,be);break;default:if(!je)for(le=1,je=new Array(De-1);le<De;le++)je[le-1]=arguments[le];st[we].fn.apply(st[we].context,je)}}return!0},F.prototype.on=function(q,ee,fe){return G(this,q,ee,fe,!1)},F.prototype.once=function(q,ee,fe){return G(this,q,ee,fe,!0)},F.prototype.removeListener=function(q,ee,fe,be){var Ie=C?C+q:q;if(!this._events[Ie])return this;if(!ee)return Z(this,Ie),this;var Oe=this._events[Ie];if(Oe.fn)Oe.fn===ee&&(!be||Oe.once)&&(!fe||Oe.context===fe)&&Z(this,Ie);else{for(var He=0,st=[],De=Oe.length;He<De;He++)(Oe[He].fn!==ee||be&&!Oe[He].once||fe&&Oe[He].context!==fe)&&st.push(Oe[He]);st.length?this._events[Ie]=st.length===1?st[0]:st:Z(this,Ie)}return this},F.prototype.removeAllListeners=function(q){var ee;return q?(ee=C?C+q:q,this._events[ee]&&Z(this,ee)):(this._events=new P,this._eventsCount=0),this},F.prototype.off=F.prototype.removeListener,F.prototype.addListener=F.prototype.on,F.prefixed=C,F.EventEmitter=F,se.exports=F},98269:function(se){"use strict";var $="Function.prototype.bind called on incompatible ",C=Object.prototype.toString,P=Math.max,D="[object Function]",G=function(q,ee){for(var fe=[],be=0;be<q.length;be+=1)fe[be]=q[be];for(var Ie=0;Ie<ee.length;Ie+=1)fe[Ie+q.length]=ee[Ie];return fe},Z=function(q,ee){for(var fe=[],be=ee||0,Ie=0;be<q.length;be+=1,Ie+=1)fe[Ie]=q[be];return fe},F=function(z,q){for(var ee="",fe=0;fe<z.length;fe+=1)ee+=z[fe],fe+1<z.length&&(ee+=q);return ee};se.exports=function(q){var ee=this;if(typeof ee!="function"||C.apply(ee)!==D)throw new TypeError($+ee);for(var fe=Z(arguments,1),be,Ie=function(){if(this instanceof be){var je=ee.apply(this,G(fe,arguments));return Object(je)===je?je:this}return ee.apply(q,G(fe,arguments))},Oe=P(0,ee.length-fe.length),He=[],st=0;st<Oe;st++)He[st]="$"+st;if(be=Function("binder","return function ("+F(He,",")+"){ return binder.apply(this,arguments); }")(Ie),ee.prototype){var De=function(){};De.prototype=ee.prototype,be.prototype=new De,De.prototype=null}return be}},36723:function(se,$,C){"use strict";var P=C(98269);se.exports=Function.prototype.bind||P},8325:function(se){"use strict";var $=function(){return typeof function(){}.name=="string"},C=Object.getOwnPropertyDescriptor;if(C)try{C([],"length")}catch(D){C=null}$.functionsHaveConfigurableNames=function(){if(!$()||!C)return!1;var G=C(function(){},"name");return!!G&&!!G.configurable};var P=Function.prototype.bind;$.boundFunctionsHaveNames=function(){return $()&&typeof P=="function"&&function(){}.bind().name!==""},se.exports=$},15468:function(se,$,C){var P=C(19545),D=function(z){this.precision=z&&z.precision?z.precision:17,this.direction=z&&z.direction?z.direction:!1,this.pseudoNode=z&&z.pseudoNode?z.pseudoNode:!1,this.objectComparator=z&&z.objectComparator?z.objectComparator:F};D.prototype.compare=function(z,q){if(z.type!==q.type||!Z(z,q))return!1;switch(z.type){case"Point":return this.compareCoord(z.coordinates,q.coordinates);case"LineString":return this.compareLine(z.coordinates,q.coordinates,0,!1);case"Polygon":return this.comparePolygon(z,q);case"Feature":return this.compareFeature(z,q);default:if(z.type.indexOf("Multi")===0){var ee=this,fe=G(z),be=G(q);return fe.every(function(Ie){return this.some(function(Oe){return ee.compare(Ie,Oe)})},be)}}return!1};function G(z){return z.coordinates.map(function(q){return{type:z.type.replace("Multi",""),coordinates:q}})}function Z(z,q){return z.hasOwnProperty("coordinates")?z.coordinates.length===q.coordinates.length:z.length===q.length}D.prototype.compareCoord=function(z,q){if(z.length!==q.length)return!1;for(var ee=0;ee<z.length;ee++)if(z[ee].toFixed(this.precision)!==q[ee].toFixed(this.precision))return!1;return!0},D.prototype.compareLine=function(z,q,ee,fe){if(!Z(z,q))return!1;var be=this.pseudoNode?z:this.removePseudo(z),Ie=this.pseudoNode?q:this.removePseudo(q);if(!(fe&&!this.compareCoord(be[0],Ie[0])&&(Ie=this.fixStartIndex(Ie,be),!Ie))){var Oe=this.compareCoord(be[ee],Ie[ee]);return this.direction||Oe?this.comparePath(be,Ie):this.compareCoord(be[ee],Ie[Ie.length-(1+ee)])?this.comparePath(be.slice().reverse(),Ie):!1}},D.prototype.fixStartIndex=function(z,q){for(var ee,fe=-1,be=0;be<z.length;be++)if(this.compareCoord(z[be],q[0])){fe=be;break}return fe>=0&&(ee=[].concat(z.slice(fe,z.length),z.slice(1,fe+1))),ee},D.prototype.comparePath=function(z,q){var ee=this;return z.every(function(fe,be){return ee.compareCoord(fe,this[be])},q)},D.prototype.comparePolygon=function(z,q){if(this.compareLine(z.coordinates[0],q.coordinates[0],1,!0)){var ee=z.coordinates.slice(1,z.coordinates.length),fe=q.coordinates.slice(1,q.coordinates.length),be=this;return ee.every(function(Ie){return this.some(function(Oe){return be.compareLine(Ie,Oe,1,!0)})},fe)}else return!1},D.prototype.compareFeature=function(z,q){return z.id!==q.id||!this.objectComparator(z.properties,q.properties)||!this.compareBBox(z,q)?!1:this.compare(z.geometry,q.geometry)},D.prototype.compareBBox=function(z,q){return!!(!z.bbox&&!q.bbox||z.bbox&&q.bbox&&this.compareCoord(z.bbox,q.bbox))},D.prototype.removePseudo=function(z){return z};function F(z,q){return P(z,q,{strict:!0})}se.exports=D},56898:function(se,$,C){var P=C(79535),D=C(78161),G=C(9750),Z=C(76314).Z,F=G.featureEach,z=G.coordEach,q=D.polygon,ee=D.featureCollection;function fe(be){var Ie=new P(be);return Ie.insert=function(Oe){if(Oe.type!=="Feature")throw new Error("invalid feature");return Oe.bbox=Oe.bbox?Oe.bbox:Z(Oe),P.prototype.insert.call(this,Oe)},Ie.load=function(Oe){var He=[];return Array.isArray(Oe)?Oe.forEach(function(st){if(st.type!=="Feature")throw new Error("invalid features");st.bbox=st.bbox?st.bbox:Z(st),He.push(st)}):F(Oe,function(st){if(st.type!=="Feature")throw new Error("invalid features");st.bbox=st.bbox?st.bbox:Z(st),He.push(st)}),P.prototype.load.call(this,He)},Ie.remove=function(Oe,He){if(Oe.type!=="Feature")throw new Error("invalid feature");return Oe.bbox=Oe.bbox?Oe.bbox:Z(Oe),P.prototype.remove.call(this,Oe,He)},Ie.clear=function(){return P.prototype.clear.call(this)},Ie.search=function(Oe){var He=P.prototype.search.call(this,this.toBBox(Oe));return ee(He)},Ie.collides=function(Oe){return P.prototype.collides.call(this,this.toBBox(Oe))},Ie.all=function(){var Oe=P.prototype.all.call(this);return ee(Oe)},Ie.toJSON=function(){return P.prototype.toJSON.call(this)},Ie.fromJSON=function(Oe){return P.prototype.fromJSON.call(this,Oe)},Ie.toBBox=function(Oe){var He;if(Oe.bbox)He=Oe.bbox;else if(Array.isArray(Oe)&&Oe.length===4)He=Oe;else if(Array.isArray(Oe)&&Oe.length===6)He=[Oe[0],Oe[1],Oe[3],Oe[4]];else if(Oe.type==="Feature")He=Z(Oe);else if(Oe.type==="FeatureCollection")He=Z(Oe);else throw new Error("invalid geojson");return{minX:He[0],minY:He[1],maxX:He[2],maxY:He[3]}},Ie}se.exports=fe,se.exports.default=fe},44532:function(se,$,C){"use strict";var P,D=SyntaxError,G=Function,Z=TypeError,F=function(X){try{return G('"use strict"; return ('+X+").constructor;")()}catch(Me){}},z=Object.getOwnPropertyDescriptor;if(z)try{z({},"")}catch(X){z=null}var q=function(){throw new Z},ee=z?function(){try{return arguments.callee,q}catch(X){try{return z(arguments,"callee").get}catch(Me){return q}}}():q,fe=C(9997)(),be=C(77916)(),Ie=Object.getPrototypeOf||(be?function(X){return X.__proto__}:null),Oe={},He=typeof Uint8Array=="undefined"||!Ie?P:Ie(Uint8Array),st={"%AggregateError%":typeof AggregateError=="undefined"?P:AggregateError,"%Array%":Array,"%ArrayBuffer%":typeof ArrayBuffer=="undefined"?P:ArrayBuffer,"%ArrayIteratorPrototype%":fe&&Ie?Ie([][Symbol.iterator]()):P,"%AsyncFromSyncIteratorPrototype%":P,"%AsyncFunction%":Oe,"%AsyncGenerator%":Oe,"%AsyncGeneratorFunction%":Oe,"%AsyncIteratorPrototype%":Oe,"%Atomics%":typeof Atomics=="undefined"?P:Atomics,"%BigInt%":typeof BigInt=="undefined"?P:BigInt,"%BigInt64Array%":typeof BigInt64Array=="undefined"?P:BigInt64Array,"%BigUint64Array%":typeof BigUint64Array=="undefined"?P:BigUint64Array,"%Boolean%":Boolean,"%DataView%":typeof DataView=="undefined"?P:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":Error,"%eval%":eval,"%EvalError%":EvalError,"%Float32Array%":typeof Float32Array=="undefined"?P:Float32Array,"%Float64Array%":typeof Float64Array=="undefined"?P:Float64Array,"%FinalizationRegistry%":typeof FinalizationRegistry=="undefined"?P:FinalizationRegistry,"%Function%":G,"%GeneratorFunction%":Oe,"%Int8Array%":typeof Int8Array=="undefined"?P:Int8Array,"%Int16Array%":typeof Int16Array=="undefined"?P:Int16Array,"%Int32Array%":typeof Int32Array=="undefined"?P:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":fe&&Ie?Ie(Ie([][Symbol.iterator]())):P,"%JSON%":typeof JSON=="object"?JSON:P,"%Map%":typeof Map=="undefined"?P:Map,"%MapIteratorPrototype%":typeof Map=="undefined"||!fe||!Ie?P:Ie(new Map()[Symbol.iterator]()),"%Math%":Math,"%Number%":Number,"%Object%":Object,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":typeof Promise=="undefined"?P:Promise,"%Proxy%":typeof Proxy=="undefined"?P:Proxy,"%RangeError%":RangeError,"%ReferenceError%":ReferenceError,"%Reflect%":typeof Reflect=="undefined"?P:Reflect,"%RegExp%":RegExp,"%Set%":typeof Set=="undefined"?P:Set,"%SetIteratorPrototype%":typeof Set=="undefined"||!fe||!Ie?P:Ie(new Set()[Symbol.iterator]()),"%SharedArrayBuffer%":typeof SharedArrayBuffer=="undefined"?P:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":fe&&Ie?Ie(""[Symbol.iterator]()):P,"%Symbol%":fe?Symbol:P,"%SyntaxError%":D,"%ThrowTypeError%":ee,"%TypedArray%":He,"%TypeError%":Z,"%Uint8Array%":typeof Uint8Array=="undefined"?P:Uint8Array,"%Uint8ClampedArray%":typeof Uint8ClampedArray=="undefined"?P:Uint8ClampedArray,"%Uint16Array%":typeof Uint16Array=="undefined"?P:Uint16Array,"%Uint32Array%":typeof Uint32Array=="undefined"?P:Uint32Array,"%URIError%":URIError,"%WeakMap%":typeof WeakMap=="undefined"?P:WeakMap,"%WeakRef%":typeof WeakRef=="undefined"?P:WeakRef,"%WeakSet%":typeof WeakSet=="undefined"?P:WeakSet};if(Ie)try{null.error}catch(X){var De=Ie(Ie(X));st["%Error.prototype%"]=De}var je=function X(Me){var Ae;if(Me==="%AsyncFunction%")Ae=F("async function () {}");else if(Me==="%GeneratorFunction%")Ae=F("function* () {}");else if(Me==="%AsyncGeneratorFunction%")Ae=F("async function* () {}");else if(Me==="%AsyncGenerator%"){var me=X("%AsyncGeneratorFunction%");me&&(Ae=me.prototype)}else if(Me==="%AsyncIteratorPrototype%"){var ue=X("%AsyncGenerator%");ue&&Ie&&(Ae=Ie(ue.prototype))}return st[Me]=Ae,Ae},we={"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},Te=C(36723),le=C(68854),Re=Te.call(Function.call,Array.prototype.concat),ye=Te.call(Function.apply,Array.prototype.splice),_e=Te.call(Function.call,String.prototype.replace),ne=Te.call(Function.call,String.prototype.slice),Y=Te.call(Function.call,RegExp.prototype.exec),Le=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,de=/\\(\\)?/g,Ee=function(Me){var Ae=ne(Me,0,1),me=ne(Me,-1);if(Ae==="%"&&me!=="%")throw new D("invalid intrinsic syntax, expected closing `%`");if(me==="%"&&Ae!=="%")throw new D("invalid intrinsic syntax, expected opening `%`");var ue=[];return _e(Me,Le,function(ke,Ze,oe,Dt){ue[ue.length]=oe?_e(Dt,de,"$1"):Ze||ke}),ue},ge=function(Me,Ae){var me=Me,ue;if(le(we,me)&&(ue=we[me],me="%"+ue[0]+"%"),le(st,me)){var ke=st[me];if(ke===Oe&&(ke=je(me)),typeof ke=="undefined"&&!Ae)throw new Z("intrinsic "+Me+" exists, but is not available. Please file an issue!");return{alias:ue,name:me,value:ke}}throw new D("intrinsic "+Me+" does not exist!")};se.exports=function(Me,Ae){if(typeof Me!="string"||Me.length===0)throw new Z("intrinsic name must be a non-empty string");if(arguments.length>1&&typeof Ae!="boolean")throw new Z('"allowMissing" argument must be a boolean');if(Y(/^%?[^%]*%?$/,Me)===null)throw new D("`%` may not be present anywhere but at the beginning and end of the intrinsic name");var me=Ee(Me),ue=me.length>0?me[0]:"",ke=ge("%"+ue+"%",Ae),Ze=ke.name,oe=ke.value,Dt=!1,Rt=ke.alias;Rt&&(ue=Rt[0],ye(me,Re([0,1],Rt)));for(var cr=1,Ut=!0;cr<me.length;cr+=1){var $r=me[cr],ln=ne($r,0,1),Sr=ne($r,-1);if((ln==='"'||ln==="'"||ln==="`"||Sr==='"'||Sr==="'"||Sr==="`")&&ln!==Sr)throw new D("property names with quotes must have matching quotes");if(($r==="constructor"||!Ut)&&(Dt=!0),ue+="."+$r,Ze="%"+ue+"%",le(st,Ze))oe=st[Ze];else if(oe!=null){if(!($r in oe)){if(!Ae)throw new Z("base intrinsic for "+Me+" exists, but the property is not available.");return}if(z&&cr+1>=me.length){var Qr=z(oe,$r);Ut=!!Qr,Ut&&"get"in Qr&&!("originalValue"in Qr.get)?oe=Qr.get:oe=oe[$r]}else Ut=le(oe,$r),oe=oe[$r];Ut&&!Dt&&(st[Ze]=oe)}}return oe}},67747:function(se,$,C){"use strict";var P=C(44532),D=P("%Object.getOwnPropertyDescriptor%",!0);if(D)try{D([],"length")}catch(G){D=null}se.exports=D},51831:function(se,$,C){"use strict";C.d($,{jf:function(){return Ou},mD:function(){return Es}});var P=function(Mt){Mt=Mt||{};var Ve=typeof Mt!="undefined"?Mt:{},Gt={},ce;for(ce in Ve)Ve.hasOwnProperty(ce)&&(Gt[ce]=Ve[ce]);var Be=[],Ye="";function zt(ot){return Ve.locateFile?Ve.locateFile(ot,Ye):Ye+ot}var hr;typeof document!="undefined"&&document.currentScript&&(Ye=document.currentScript.src),Ye.indexOf("blob:")!==0?Ye=Ye.substr(0,Ye.lastIndexOf("/")+1):Ye="",hr=function(Zt,Jt,gr){var v=new XMLHttpRequest;v.open("GET",Zt,!0),v.responseType="arraybuffer",v.onload=function(){if(v.status==200||v.status==0&&v.response){Jt(v.response);return}var jn=Xo(Zt);if(jn){Jt(jn.buffer);return}gr()},v.onerror=gr,v.send(null)};var Lr=Ve.print||console.log.bind(console),dn=Ve.printErr||console.warn.bind(console);for(ce in Gt)Gt.hasOwnProperty(ce)&&(Ve[ce]=Gt[ce]);Gt=null,Ve.arguments&&(Be=Ve.arguments);var Mn=0,vi=function(ot){Mn=ot},co=function(){return Mn},is=8;function ws(ot,Zt,Jt,gr){switch(Jt=Jt||"i8",Jt.charAt(Jt.length-1)==="*"&&(Jt="i32"),Jt){case"i1":as[ot>>0]=Zt;break;case"i8":as[ot>>0]=Zt;break;case"i16":Ra[ot>>1]=Zt;break;case"i32":fu[ot>>2]=Zt;break;case"i64":ps=[Zt>>>0,(_a=Zt,+gc(_a)>=1?_a>0?(Du(+ea(_a/4294967296),4294967295)|0)>>>0:~~+yf((_a-+(~~_a>>>0))/4294967296)>>>0:0)],fu[ot>>2]=ps[0],fu[ot+4>>2]=ps[1];break;case"float":Ol[ot>>2]=Zt;break;case"double":Qc[ot>>3]=Zt;break;default:tr("invalid type for setValue: "+Jt)}}function Xc(ot,Zt,Jt){switch(Zt=Zt||"i8",Zt.charAt(Zt.length-1)==="*"&&(Zt="i32"),Zt){case"i1":return as[ot>>0];case"i8":return as[ot>>0];case"i16":return Ra[ot>>1];case"i32":return fu[ot>>2];case"i64":return fu[ot>>2];case"float":return Ol[ot>>2];case"double":return Qc[ot>>3];default:tr("invalid type for getValue: "+Zt)}return null}var Zs=!1;function ua(ot,Zt){ot||tr("Assertion failed: "+Zt)}function Jl(ot){var Zt=Ve["_"+ot];return ua(Zt,"Cannot call unknown function "+ot+", make sure it is exported"),Zt}function qa(ot,Zt,Jt,gr,v){var Ln={string:function(us){var Ea=0;if(us!=null&&us!==0){var Vr=(us.length<<2)+1;Ea=s(Vr),zs(us,Ea,Vr)}return Ea},array:function(us){var Ea=s(us.length);return cu(us,Ea),Ea}};function jn(us){return Zt==="string"?In(us):Zt==="boolean"?!!us:us}var Xe=Jl(ot),Ma=[],ao=0;if(gr)for(var xo=0;xo<gr.length;xo++){var aa=Ln[Jt[xo]];aa?(ao===0&&(ao=_()),Ma[xo]=aa(gr[xo])):Ma[xo]=gr[xo]}var Da=Xe.apply(null,Ma);return Da=jn(Da),ao!==0&&d(ao),Da}function gf(ot,Zt,Jt,gr){Jt=Jt||[];var v=Jt.every(function(jn){return jn==="number"}),Ln=Zt!=="string";return Ln&&v&&!gr?Jl(ot):function(){return qa(ot,Zt,Jt,arguments,gr)}}var dl=typeof TextDecoder!="undefined"?new TextDecoder("utf8"):void 0;function wa(ot,Zt,Jt){for(var gr=Zt+Jt,v=Zt;ot[v]&&!(v>=gr);)++v;if(v-Zt>16&&ot.subarray&&dl)return dl.decode(ot.subarray(Zt,v));for(var Ln="";Zt<v;){var jn=ot[Zt++];if(!(jn&128)){Ln+=String.fromCharCode(jn);continue}var Xe=ot[Zt++]&63;if((jn&224)==192){Ln+=String.fromCharCode((jn&31)<<6|Xe);continue}var Ma=ot[Zt++]&63;if((jn&240)==224?jn=(jn&15)<<12|Xe<<6|Ma:jn=(jn&7)<<18|Xe<<12|Ma<<6|ot[Zt++]&63,jn<65536)Ln+=String.fromCharCode(jn);else{var ao=jn-65536;Ln+=String.fromCharCode(55296|ao>>10,56320|ao&1023)}}return Ln}function In(ot,Zt){return ot?wa(Ha,ot,Zt):""}function Ju(ot,Zt,Jt,gr){if(!(gr>0))return 0;for(var v=Jt,Ln=Jt+gr-1,jn=0;jn<ot.length;++jn){var Xe=ot.charCodeAt(jn);if(Xe>=55296&&Xe<=57343){var Ma=ot.charCodeAt(++jn);Xe=65536+((Xe&1023)<<10)|Ma&1023}if(Xe<=127){if(Jt>=Ln)break;Zt[Jt++]=Xe}else if(Xe<=2047){if(Jt+1>=Ln)break;Zt[Jt++]=192|Xe>>6,Zt[Jt++]=128|Xe&63}else if(Xe<=65535){if(Jt+2>=Ln)break;Zt[Jt++]=224|Xe>>12,Zt[Jt++]=128|Xe>>6&63,Zt[Jt++]=128|Xe&63}else{if(Jt+3>=Ln)break;Zt[Jt++]=240|Xe>>18,Zt[Jt++]=128|Xe>>12&63,Zt[Jt++]=128|Xe>>6&63,Zt[Jt++]=128|Xe&63}}return Zt[Jt]=0,Jt-v}function zs(ot,Zt,Jt){return Ju(ot,Ha,Zt,Jt)}var lu=typeof TextDecoder!="undefined"?new TextDecoder("utf-16le"):void 0;function cu(ot,Zt){as.set(ot,Zt)}function xu(ot,Zt){return ot%Zt>0&&(ot+=Zt-ot%Zt),ot}var ci,as,Ha,Ra,mo,fu,mf,Ol,Qc;function kf(ot){ci=ot,Ve.HEAP8=as=new Int8Array(ot),Ve.HEAP16=Ra=new Int16Array(ot),Ve.HEAP32=fu=new Int32Array(ot),Ve.HEAPU8=Ha=new Uint8Array(ot),Ve.HEAPU16=mo=new Uint16Array(ot),Ve.HEAPU32=mf=new Uint32Array(ot),Ve.HEAPF32=Ol=new Float32Array(ot),Ve.HEAPF64=Qc=new Float64Array(ot)}var Yo=5267040,Us=24128,ko=Ve.TOTAL_MEMORY||33554432;Ve.buffer?ci=Ve.buffer:ci=new ArrayBuffer(ko),ko=ci.byteLength,kf(ci),fu[Us>>2]=Yo;function la(ot){for(;ot.length>0;){var Zt=ot.shift();if(typeof Zt=="function"){Zt();continue}var Jt=Zt.func;typeof Jt=="number"?Zt.arg===void 0?Ve.dynCall_v(Jt):Ve.dynCall_vi(Jt,Zt.arg):Jt(Zt.arg===void 0?null:Zt.arg)}}var os=[],Rl=[],Ta=[],Sn=[];function vl(){if(Ve.preRun)for(typeof Ve.preRun=="function"&&(Ve.preRun=[Ve.preRun]);Ve.preRun.length;)gl(Ve.preRun.shift());la(os)}function ec(){la(Rl)}function Ka(){la(Ta)}function hs(){if(Ve.postRun)for(typeof Ve.postRun=="function"&&(Ve.postRun=[Ve.postRun]);Ve.postRun.length;)vc(Ve.postRun.shift());la(Sn)}function gl(ot){os.unshift(ot)}function vc(ot){Sn.unshift(ot)}var gc=Math.abs,yf=Math.ceil,ea=Math.floor,Du=Math.min,na=0,Za=null,Do=null;function n0(ot){na++,Ve.monitorRunDependencies&&Ve.monitorRunDependencies(na)}function fi(ot){if(na--,Ve.monitorRunDependencies&&Ve.monitorRunDependencies(na),na==0&&(Za!==null&&(clearInterval(Za),Za=null),Do)){var Zt=Do;Do=null,Zt()}}Ve.preloadedImages={},Ve.preloadedAudios={};var As=null,ia="data:application/octet-stream;base64,";function Ts(ot){return String.prototype.startsWith?ot.startsWith(ia):ot.indexOf(ia)===0}var _a,ps;As="data:application/octet-stream;base64,AAAAAAAAAAAAAAAAAQAAAAIAAAADAAAABAAAAAUAAAAGAAAAAQAAAAQAAAADAAAABgAAAAUAAAACAAAAAAAAAAIAAAADAAAAAQAAAAQAAAAGAAAAAAAAAAUAAAADAAAABgAAAAQAAAAFAAAAAAAAAAEAAAACAAAABAAAAAUAAAAGAAAAAAAAAAIAAAADAAAAAQAAAAUAAAACAAAAAAAAAAEAAAADAAAABgAAAAQAAAAGAAAAAAAAAAUAAAACAAAAAQAAAAQAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAEAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAIAAAADAAAAAAAAAAAAAAACAAAAAAAAAAEAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAABAAAAAYAAAAAAAAABQAAAAAAAAAAAAAABAAAAAUAAAAAAAAAAAAAAAAAAAACAAAAAAAAAAYAAAAAAAAABgAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAgAAAAMAAAAEAAAABQAAAAYAAAABAAAAAgAAAAMAAAAEAAAABQAAAAYAAAAAAAAAAgAAAAMAAAAEAAAABQAAAAYAAAAAAAAAAQAAAAMAAAAEAAAABQAAAAYAAAAAAAAAAQAAAAIAAAAEAAAABQAAAAYAAAAAAAAAAQAAAAIAAAADAAAABQAAAAYAAAAAAAAAAQAAAAIAAAADAAAABAAAAAYAAAAAAAAAAQAAAAIAAAADAAAABAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAwAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAgAAAAIAAAAAAAAAAAAAAAYAAAAAAAAAAwAAAAIAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAFAAAABAAAAAAAAAABAAAAAAAAAAAAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAYAAAAAAAAABAAAAAAAAAAGAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAFAAAAAgAAAAQAAAADAAAACAAAAAEAAAAHAAAABgAAAAkAAAAAAAAAAwAAAAIAAAACAAAABgAAAAoAAAALAAAAAAAAAAEAAAAFAAAAAwAAAA0AAAABAAAABwAAAAQAAAAMAAAAAAAAAAQAAAB/AAAADwAAAAgAAAADAAAAAAAAAAwAAAAFAAAAAgAAABIAAAAKAAAACAAAAAAAAAAQAAAABgAAAA4AAAALAAAAEQAAAAEAAAAJAAAAAgAAAAcAAAAVAAAACQAAABMAAAADAAAADQAAAAEAAAAIAAAABQAAABYAAAAQAAAABAAAAAAAAAAPAAAACQAAABMAAAAOAAAAFAAAAAEAAAAHAAAABgAAAAoAAAALAAAAGAAAABcAAAAFAAAAAgAAABIAAAALAAAAEQAAABcAAAAZAAAAAgAAAAYAAAAKAAAADAAAABwAAAANAAAAGgAAAAQAAAAPAAAAAwAAAA0AAAAaAAAAFQAAAB0AAAADAAAADAAAAAcAAAAOAAAAfwAAABEAAAAbAAAACQAAABQAAAAGAAAADwAAABYAAAAcAAAAHwAAAAQAAAAIAAAADAAAABAAAAASAAAAIQAAAB4AAAAIAAAABQAAABYAAAARAAAACwAAAA4AAAAGAAAAIwAAABkAAAAbAAAAEgAAABgAAAAeAAAAIAAAAAUAAAAKAAAAEAAAABMAAAAiAAAAFAAAACQAAAAHAAAAFQAAAAkAAAAUAAAADgAAABMAAAAJAAAAKAAAABsAAAAkAAAAFQAAACYAAAATAAAAIgAAAA0AAAAdAAAABwAAABYAAAAQAAAAKQAAACEAAAAPAAAACAAAAB8AAAAXAAAAGAAAAAsAAAAKAAAAJwAAACUAAAAZAAAAGAAAAH8AAAAgAAAAJQAAAAoAAAAXAAAAEgAAABkAAAAXAAAAEQAAAAsAAAAtAAAAJwAAACMAAAAaAAAAKgAAAB0AAAArAAAADAAAABwAAAANAAAAGwAAACgAAAAjAAAALgAAAA4AAAAUAAAAEQAAABwAAAAfAAAAKgAAACwAAAAMAAAADwAAABoAAAAdAAAAKwAAACYAAAAvAAAADQAAABoAAAAVAAAAHgAAACAAAAAwAAAAMgAAABAAAAASAAAAIQAAAB8AAAApAAAALAAAADUAAAAPAAAAFgAAABwAAAAgAAAAHgAAABgAAAASAAAANAAAADIAAAAlAAAAIQAAAB4AAAAxAAAAMAAAABYAAAAQAAAAKQAAACIAAAATAAAAJgAAABUAAAA2AAAAJAAAADMAAAAjAAAALgAAAC0AAAA4AAAAEQAAABsAAAAZAAAAJAAAABQAAAAiAAAAEwAAADcAAAAoAAAANgAAACUAAAAnAAAANAAAADkAAAAYAAAAFwAAACAAAAAmAAAAfwAAACIAAAAzAAAAHQAAAC8AAAAVAAAAJwAAACUAAAAZAAAAFwAAADsAAAA5AAAALQAAACgAAAAbAAAAJAAAABQAAAA8AAAALgAAADcAAAApAAAAMQAAADUAAAA9AAAAFgAAACEAAAAfAAAAKgAAADoAAAArAAAAPgAAABwAAAAsAAAAGgAAACsAAAA+AAAALwAAAEAAAAAaAAAAKgAAAB0AAAAsAAAANQAAADoAAABBAAAAHAAAAB8AAAAqAAAALQAAACcAAAAjAAAAGQAAAD8AAAA7AAAAOAAAAC4AAAA8AAAAOAAAAEQAAAAbAAAAKAAAACMAAAAvAAAAJgAAACsAAAAdAAAARQAAADMAAABAAAAAMAAAADEAAAAeAAAAIQAAAEMAAABCAAAAMgAAADEAAAB/AAAAPQAAAEIAAAAhAAAAMAAAACkAAAAyAAAAMAAAACAAAAAeAAAARgAAAEMAAAA0AAAAMwAAAEUAAAA2AAAARwAAACYAAAAvAAAAIgAAADQAAAA5AAAARgAAAEoAAAAgAAAAJQAAADIAAAA1AAAAPQAAAEEAAABLAAAAHwAAACkAAAAsAAAANgAAAEcAAAA3AAAASQAAACIAAAAzAAAAJAAAADcAAAAoAAAANgAAACQAAABIAAAAPAAAAEkAAAA4AAAARAAAAD8AAABNAAAAIwAAAC4AAAAtAAAAOQAAADsAAABKAAAATgAAACUAAAAnAAAANAAAADoAAAB/AAAAPgAAAEwAAAAsAAAAQQAAACoAAAA7AAAAPwAAAE4AAABPAAAAJwAAAC0AAAA5AAAAPAAAAEgAAABEAAAAUAAAACgAAAA3AAAALgAAAD0AAAA1AAAAMQAAACkAAABRAAAASwAAAEIAAAA+AAAAKwAAADoAAAAqAAAAUgAAAEAAAABMAAAAPwAAAH8AAAA4AAAALQAAAE8AAAA7AAAATQAAAEAAAAAvAAAAPgAAACsAAABUAAAARQAAAFIAAABBAAAAOgAAADUAAAAsAAAAVgAAAEwAAABLAAAAQgAAAEMAAABRAAAAVQAAADEAAAAwAAAAPQAAAEMAAABCAAAAMgAAADAAAABXAAAAVQAAAEYAAABEAAAAOAAAADwAAAAuAAAAWgAAAE0AAABQAAAARQAAADMAAABAAAAALwAAAFkAAABHAAAAVAAAAEYAAABDAAAANAAAADIAAABTAAAAVwAAAEoAAABHAAAAWQAAAEkAAABbAAAAMwAAAEUAAAA2AAAASAAAAH8AAABJAAAANwAAAFAAAAA8AAAAWAAAAEkAAABbAAAASAAAAFgAAAA2AAAARwAAADcAAABKAAAATgAAAFMAAABcAAAANAAAADkAAABGAAAASwAAAEEAAAA9AAAANQAAAF4AAABWAAAAUQAAAEwAAABWAAAAUgAAAGAAAAA6AAAAQQAAAD4AAABNAAAAPwAAAEQAAAA4AAAAXQAAAE8AAABaAAAATgAAAEoAAAA7AAAAOQAAAF8AAABcAAAATwAAAE8AAABOAAAAPwAAADsAAABdAAAAXwAAAE0AAABQAAAARAAAAEgAAAA8AAAAYwAAAFoAAABYAAAAUQAAAFUAAABeAAAAZQAAAD0AAABCAAAASwAAAFIAAABgAAAAVAAAAGIAAAA+AAAATAAAAEAAAABTAAAAfwAAAEoAAABGAAAAZAAAAFcAAABcAAAAVAAAAEUAAABSAAAAQAAAAGEAAABZAAAAYgAAAFUAAABXAAAAZQAAAGYAAABCAAAAQwAAAFEAAABWAAAATAAAAEsAAABBAAAAaAAAAGAAAABeAAAAVwAAAFMAAABmAAAAZAAAAEMAAABGAAAAVQAAAFgAAABIAAAAWwAAAEkAAABjAAAAUAAAAGkAAABZAAAAYQAAAFsAAABnAAAARQAAAFQAAABHAAAAWgAAAE0AAABQAAAARAAAAGoAAABdAAAAYwAAAFsAAABJAAAAWQAAAEcAAABpAAAAWAAAAGcAAABcAAAAUwAAAE4AAABKAAAAbAAAAGQAAABfAAAAXQAAAE8AAABaAAAATQAAAG0AAABfAAAAagAAAF4AAABWAAAAUQAAAEsAAABrAAAAaAAAAGUAAABfAAAAXAAAAE8AAABOAAAAbQAAAGwAAABdAAAAYAAAAGgAAABiAAAAbgAAAEwAAABWAAAAUgAAAGEAAAB/AAAAYgAAAFQAAABnAAAAWQAAAG8AAABiAAAAbgAAAGEAAABvAAAAUgAAAGAAAABUAAAAYwAAAFAAAABpAAAAWAAAAGoAAABaAAAAcQAAAGQAAABmAAAAUwAAAFcAAABsAAAAcgAAAFwAAABlAAAAZgAAAGsAAABwAAAAUQAAAFUAAABeAAAAZgAAAGUAAABXAAAAVQAAAHIAAABwAAAAZAAAAGcAAABbAAAAYQAAAFkAAAB0AAAAaQAAAG8AAABoAAAAawAAAG4AAABzAAAAVgAAAF4AAABgAAAAaQAAAFgAAABnAAAAWwAAAHEAAABjAAAAdAAAAGoAAABdAAAAYwAAAFoAAAB1AAAAbQAAAHEAAABrAAAAfwAAAGUAAABeAAAAcwAAAGgAAABwAAAAbAAAAGQAAABfAAAAXAAAAHYAAAByAAAAbQAAAG0AAABsAAAAXQAAAF8AAAB1AAAAdgAAAGoAAABuAAAAYgAAAGgAAABgAAAAdwAAAG8AAABzAAAAbwAAAGEAAABuAAAAYgAAAHQAAABnAAAAdwAAAHAAAABrAAAAZgAAAGUAAAB4AAAAcwAAAHIAAABxAAAAYwAAAHQAAABpAAAAdQAAAGoAAAB5AAAAcgAAAHAAAABkAAAAZgAAAHYAAAB4AAAAbAAAAHMAAABuAAAAawAAAGgAAAB4AAAAdwAAAHAAAAB0AAAAZwAAAHcAAABvAAAAcQAAAGkAAAB5AAAAdQAAAH8AAABtAAAAdgAAAHEAAAB5AAAAagAAAHYAAAB4AAAAbAAAAHIAAAB1AAAAeQAAAG0AAAB3AAAAbwAAAHMAAABuAAAAeQAAAHQAAAB4AAAAeAAAAHMAAAByAAAAcAAAAHkAAAB3AAAAdgAAAHkAAAB0AAAAeAAAAHcAAAB1AAAAcQAAAHYAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAABAAAABQAAAAEAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAACAAAABQAAAAEAAAAAAAAA/////wEAAAAAAAAAAwAAAAQAAAACAAAAAAAAAAAAAAABAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAMAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAFAAAAAQAAAAAAAAAAAAAAAQAAAAMAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAEAAAADAAAAAAAAAAAAAAABAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAADAAAABQAAAAEAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAABAAAAAAAAAP////8DAAAAAAAAAAUAAAACAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAEAAAABQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAAFAAAABQAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAD/////AwAAAAAAAAAFAAAAAgAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAAAAAABAAAAAwAAAAAAAAAAAAAAAQAAAAAAAAADAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAQAAAAMAAAAAAAAAAAAAAAEAAAAAAAAAAwAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAADAAAAAAAAAP////8DAAAAAAAAAAUAAAACAAAAAAAAAAAAAAADAAAAAAAAAAAAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAUAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAFAAAABQAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAwAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAADAAAAAwAAAAMAAAAAAAAAAwAAAAAAAAAAAAAA/////wMAAAAAAAAABQAAAAIAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAA/////wMAAAAAAAAABQAAAAIAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAMAAAADAAAAAAAAAAAAAAADAAAAAwAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAMAAAADAAAAAwAAAAMAAAAAAAAAAwAAAAAAAAD/////AwAAAAAAAAAFAAAAAgAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAAAAAADAAAAAAAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAAAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAAAAAD/////AwAAAAAAAAAFAAAAAgAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAADAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAFAAAAAAAAAAAAAAADAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAADAAAAAQAAAAAAAAABAAAAAAAAAAAAAAABAAAAAwAAAAEAAAAAAAAAAQAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAADAAAAAAAAAP////8DAAAAAAAAAAUAAAACAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAAAAAAAAAAADAAAAAwAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAUAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAFAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAA/////wMAAAAAAAAABQAAAAIAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAAFAAAAAAAAAAAAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAEAAAADAAAAAQAAAAAAAAABAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAADAAAAAQAAAAAAAAABAAAAAAAAAAMAAAADAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAEAAAAAAAAAAwAAAAUAAAABAAAAAAAAAP////8DAAAAAAAAAAUAAAACAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAABAAAAAUAAAABAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAIAAAAFAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAEAAAADAAAAAQAAAAAAAAABAAAAAAAAAAUAAAAAAAAAAAAAAAUAAAAFAAAAAAAAAAAAAAD/////AQAAAAAAAAADAAAABAAAAAIAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAUAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAFAAAAAAAAAAAAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAUAAAABAAAAAAAAAAAAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAAAAAAEAAAD//////////wEAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAADAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAsAAAACAAAAAAAAAAAAAAABAAAAAgAAAAYAAAAEAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAYAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAcAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAACAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAYAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAKAAAAAgAAAAAAAAAAAAAAAQAAAAEAAAAFAAAABgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAALAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAABAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAABwAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAsAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACgAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAACAAAAAAAAAAAAAAABAAAAAwAAAAcAAAAGAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAABwAAAAEAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAGAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAADgAAAAIAAAAAAAAAAAAAAAEAAAAAAAAACQAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACgAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAMAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAABwAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAsAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAKAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADQAAAAIAAAAAAAAAAAAAAAEAAAAEAAAACAAAAAoAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAALAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAACQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAGAAAAAgAAAAAAAAAAAAAAAQAAAAsAAAAPAAAACAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAkAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAOAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAEAAAAAAAAAAQAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAIAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAABQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAgAAAAAAAAAAAAAAAQAAAAwAAAAQAAAADAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAoAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAJAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAPAAAAAAAAAAEAAAABAAAAAAAAAAAAAAAAAAAADwAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAADQAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAACAAAAAAAAAAAAAAABAAAACgAAABMAAAAIAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAkAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAEQAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEQAAAAAAAAABAAAAAQAAAAAAAAAAAAAAAAAAAA8AAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAQAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAACQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAANAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAAAAIAAAAAAAAAAAAAAAEAAAANAAAAEQAAAA0AAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAARAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAEwAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAA4AAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAATAAAAAAAAAAEAAAABAAAAAAAAAAAAAAAAAAAAEQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAA0AAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAARAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAkAAAACAAAAAAAAAAAAAAABAAAADgAAABIAAAAPAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAADwAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABIAAAAAAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAASAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAEwAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAABEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAATAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAABIAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAATAAAAAgAAAAAAAAAAAAAAAQAAAP//////////EwAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAATAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAEgAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAASAAAAAAAAABgAAAAAAAAAIQAAAAAAAAAeAAAAAAAAACAAAAADAAAAMQAAAAEAAAAwAAAAAwAAADIAAAADAAAACAAAAAAAAAAFAAAABQAAAAoAAAAFAAAAFgAAAAAAAAAQAAAAAAAAABIAAAAAAAAAKQAAAAEAAAAhAAAAAAAAAB4AAAAAAAAABAAAAAAAAAAAAAAABQAAAAIAAAAFAAAADwAAAAEAAAAIAAAAAAAAAAUAAAAFAAAAHwAAAAEAAAAWAAAAAAAAABAAAAAAAAAAAgAAAAAAAAAGAAAAAAAAAA4AAAAAAAAACgAAAAAAAAALAAAAAAAAABEAAAADAAAAGAAAAAEAAAAXAAAAAwAAABkAAAADAAAAAAAAAAAAAAABAAAABQAAAAkAAAAFAAAABQAAAAAAAAACAAAAAAAAAAYAAAAAAAAAEgAAAAEAAAAKAAAAAAAAAAsAAAAAAAAABAAAAAEAAAADAAAABQAAAAcAAAAFAAAACAAAAAEAAAAAAAAAAAAAAAEAAAAFAAAAEAAAAAEAAAAFAAAAAAAAAAIAAAAAAAAABwAAAAAAAAAVAAAAAAAAACYAAAAAAAAACQAAAAAAAAATAAAAAAAAACIAAAADAAAADgAAAAEAAAAUAAAAAwAAACQAAAADAAAAAwAAAAAAAAANAAAABQAAAB0AAAAFAAAAAQAAAAAAAAAHAAAAAAAAABUAAAAAAAAABgAAAAEAAAAJAAAAAAAAABMAAAAAAAAABAAAAAIAAAAMAAAABQAAABoAAAAFAAAAAAAAAAEAAAADAAAAAAAAAA0AAAAFAAAAAgAAAAEAAAABAAAAAAAAAAcAAAAAAAAAGgAAAAAAAAAqAAAAAAAAADoAAAAAAAAAHQAAAAAAAAArAAAAAAAAAD4AAAADAAAAJgAAAAEAAAAvAAAAAwAAAEAAAAADAAAADAAAAAAAAAAcAAAABQAAACwAAAAFAAAADQAAAAAAAAAaAAAAAAAAACoAAAAAAAAAFQAAAAEAAAAdAAAAAAAAACsAAAAAAAAABAAAAAMAAAAPAAAABQAAAB8AAAAFAAAAAwAAAAEAAAAMAAAAAAAAABwAAAAFAAAABwAAAAEAAAANAAAAAAAAABoAAAAAAAAAHwAAAAAAAAApAAAAAAAAADEAAAAAAAAALAAAAAAAAAA1AAAAAAAAAD0AAAADAAAAOgAAAAEAAABBAAAAAwAAAEsAAAADAAAADwAAAAAAAAAWAAAABQAAACEAAAAFAAAAHAAAAAAAAAAfAAAAAAAAACkAAAAAAAAAKgAAAAEAAAAsAAAAAAAAADUAAAAAAAAABAAAAAQAAAAIAAAABQAAABAAAAAFAAAADAAAAAEAAAAPAAAAAAAAABYAAAAFAAAAGgAAAAEAAAAcAAAAAAAAAB8AAAAAAAAAMgAAAAAAAAAwAAAAAAAAADEAAAADAAAAIAAAAAAAAAAeAAAAAwAAACEAAAADAAAAGAAAAAMAAAASAAAAAwAAABAAAAADAAAARgAAAAAAAABDAAAAAAAAAEIAAAADAAAANAAAAAMAAAAyAAAAAAAAADAAAAAAAAAAJQAAAAMAAAAgAAAAAAAAAB4AAAADAAAAUwAAAAAAAABXAAAAAwAAAFUAAAADAAAASgAAAAMAAABGAAAAAAAAAEMAAAAAAAAAOQAAAAEAAAA0AAAAAwAAADIAAAAAAAAAGQAAAAAAAAAXAAAAAAAAABgAAAADAAAAEQAAAAAAAAALAAAAAwAAAAoAAAADAAAADgAAAAMAAAAGAAAAAwAAAAIAAAADAAAALQAAAAAAAAAnAAAAAAAAACUAAAADAAAAIwAAAAMAAAAZAAAAAAAAABcAAAAAAAAAGwAAAAMAAAARAAAAAAAAAAsAAAADAAAAPwAAAAAAAAA7AAAAAwAAADkAAAADAAAAOAAAAAMAAAAtAAAAAAAAACcAAAAAAAAALgAAAAMAAAAjAAAAAwAAABkAAAAAAAAAJAAAAAAAAAAUAAAAAAAAAA4AAAADAAAAIgAAAAAAAAATAAAAAwAAAAkAAAADAAAAJgAAAAMAAAAVAAAAAwAAAAcAAAADAAAANwAAAAAAAAAoAAAAAAAAABsAAAADAAAANgAAAAMAAAAkAAAAAAAAABQAAAAAAAAAMwAAAAMAAAAiAAAAAAAAABMAAAADAAAASAAAAAAAAAA8AAAAAwAAAC4AAAADAAAASQAAAAMAAAA3AAAAAAAAACgAAAAAAAAARwAAAAMAAAA2AAAAAwAAACQAAAAAAAAAQAAAAAAAAAAvAAAAAAAAACYAAAADAAAAPgAAAAAAAAArAAAAAwAAAB0AAAADAAAAOgAAAAMAAAAqAAAAAwAAABoAAAADAAAAVAAAAAAAAABFAAAAAAAAADMAAAADAAAAUgAAAAMAAABAAAAAAAAAAC8AAAAAAAAATAAAAAMAAAA+AAAAAAAAACsAAAADAAAAYQAAAAAAAABZAAAAAwAAAEcAAAADAAAAYgAAAAMAAABUAAAAAAAAAEUAAAAAAAAAYAAAAAMAAABSAAAAAwAAAEAAAAAAAAAASwAAAAAAAABBAAAAAAAAADoAAAADAAAAPQAAAAAAAAA1AAAAAwAAACwAAAADAAAAMQAAAAMAAAApAAAAAwAAAB8AAAADAAAAXgAAAAAAAABWAAAAAAAAAEwAAAADAAAAUQAAAAMAAABLAAAAAAAAAEEAAAAAAAAAQgAAAAMAAAA9AAAAAAAAADUAAAADAAAAawAAAAAAAABoAAAAAwAAAGAAAAADAAAAZQAAAAMAAABeAAAAAAAAAFYAAAAAAAAAVQAAAAMAAABRAAAAAwAAAEsAAAAAAAAAOQAAAAAAAAA7AAAAAAAAAD8AAAADAAAASgAAAAAAAABOAAAAAwAAAE8AAAADAAAAUwAAAAMAAABcAAAAAwAAAF8AAAADAAAAJQAAAAAAAAAnAAAAAwAAAC0AAAADAAAANAAAAAAAAAA5AAAAAAAAADsAAAAAAAAARgAAAAMAAABKAAAAAAAAAE4AAAADAAAAGAAAAAAAAAAXAAAAAwAAABkAAAADAAAAIAAAAAMAAAAlAAAAAAAAACcAAAADAAAAMgAAAAMAAAA0AAAAAAAAADkAAAAAAAAALgAAAAAAAAA8AAAAAAAAAEgAAAADAAAAOAAAAAAAAABEAAAAAwAAAFAAAAADAAAAPwAAAAMAAABNAAAAAwAAAFoAAAADAAAAGwAAAAAAAAAoAAAAAwAAADcAAAADAAAAIwAAAAAAAAAuAAAAAAAAADwAAAAAAAAALQAAAAMAAAA4AAAAAAAAAEQAAAADAAAADgAAAAAAAAAUAAAAAwAAACQAAAADAAAAEQAAAAMAAAAbAAAAAAAAACgAAAADAAAAGQAAAAMAAAAjAAAAAAAAAC4AAAAAAAAARwAAAAAAAABZAAAAAAAAAGEAAAADAAAASQAAAAAAAABbAAAAAwAAAGcAAAADAAAASAAAAAMAAABYAAAAAwAAAGkAAAADAAAAMwAAAAAAAABFAAAAAwAAAFQAAAADAAAANgAAAAAAAABHAAAAAAAAAFkAAAAAAAAANwAAAAMAAABJAAAAAAAAAFsAAAADAAAAJgAAAAAAAAAvAAAAAwAAAEAAAAADAAAAIgAAAAMAAAAzAAAAAAAAAEUAAAADAAAAJAAAAAMAAAA2AAAAAAAAAEcAAAAAAAAAYAAAAAAAAABoAAAAAAAAAGsAAAADAAAAYgAAAAAAAABuAAAAAwAAAHMAAAADAAAAYQAAAAMAAABvAAAAAwAAAHcAAAADAAAATAAAAAAAAABWAAAAAwAAAF4AAAADAAAAUgAAAAAAAABgAAAAAAAAAGgAAAAAAAAAVAAAAAMAAABiAAAAAAAAAG4AAAADAAAAOgAAAAAAAABBAAAAAwAAAEsAAAADAAAAPgAAAAMAAABMAAAAAAAAAFYAAAADAAAAQAAAAAMAAABSAAAAAAAAAGAAAAAAAAAAVQAAAAAAAABXAAAAAAAAAFMAAAADAAAAZQAAAAAAAABmAAAAAwAAAGQAAAADAAAAawAAAAMAAABwAAAAAwAAAHIAAAADAAAAQgAAAAAAAABDAAAAAwAAAEYAAAADAAAAUQAAAAAAAABVAAAAAAAAAFcAAAAAAAAAXgAAAAMAAABlAAAAAAAAAGYAAAADAAAAMQAAAAAAAAAwAAAAAwAAADIAAAADAAAAPQAAAAMAAABCAAAAAAAAAEMAAAADAAAASwAAAAMAAABRAAAAAAAAAFUAAAAAAAAAXwAAAAAAAABcAAAAAAAAAFMAAAAAAAAATwAAAAAAAABOAAAAAAAAAEoAAAADAAAAPwAAAAEAAAA7AAAAAwAAADkAAAADAAAAbQAAAAAAAABsAAAAAAAAAGQAAAAFAAAAXQAAAAEAAABfAAAAAAAAAFwAAAAAAAAATQAAAAEAAABPAAAAAAAAAE4AAAAAAAAAdQAAAAQAAAB2AAAABQAAAHIAAAAFAAAAagAAAAEAAABtAAAAAAAAAGwAAAAAAAAAWgAAAAEAAABdAAAAAQAAAF8AAAAAAAAAWgAAAAAAAABNAAAAAAAAAD8AAAAAAAAAUAAAAAAAAABEAAAAAAAAADgAAAADAAAASAAAAAEAAAA8AAAAAwAAAC4AAAADAAAAagAAAAAAAABdAAAAAAAAAE8AAAAFAAAAYwAAAAEAAABaAAAAAAAAAE0AAAAAAAAAWAAAAAEAAABQAAAAAAAAAEQAAAAAAAAAdQAAAAMAAABtAAAABQAAAF8AAAAFAAAAcQAAAAEAAABqAAAAAAAAAF0AAAAAAAAAaQAAAAEAAABjAAAAAQAAAFoAAAAAAAAAaQAAAAAAAABYAAAAAAAAAEgAAAAAAAAAZwAAAAAAAABbAAAAAAAAAEkAAAADAAAAYQAAAAEAAABZAAAAAwAAAEcAAAADAAAAcQAAAAAAAABjAAAAAAAAAFAAAAAFAAAAdAAAAAEAAABpAAAAAAAAAFgAAAAAAAAAbwAAAAEAAABnAAAAAAAAAFsAAAAAAAAAdQAAAAIAAABqAAAABQAAAFoAAAAFAAAAeQAAAAEAAABxAAAAAAAAAGMAAAAAAAAAdwAAAAEAAAB0AAAAAQAAAGkAAAAAAAAAdwAAAAAAAABvAAAAAAAAAGEAAAAAAAAAcwAAAAAAAABuAAAAAAAAAGIAAAADAAAAawAAAAEAAABoAAAAAwAAAGAAAAADAAAAeQAAAAAAAAB0AAAAAAAAAGcAAAAFAAAAeAAAAAEAAAB3AAAAAAAAAG8AAAAAAAAAcAAAAAEAAABzAAAAAAAAAG4AAAAAAAAAdQAAAAEAAABxAAAABQAAAGkAAAAFAAAAdgAAAAEAAAB5AAAAAAAAAHQAAAAAAAAAcgAAAAEAAAB4AAAAAQAAAHcAAAAAAAAAcgAAAAAAAABwAAAAAAAAAGsAAAAAAAAAZAAAAAAAAABmAAAAAAAAAGUAAAADAAAAUwAAAAEAAABXAAAAAwAAAFUAAAADAAAAdgAAAAAAAAB4AAAAAAAAAHMAAAAFAAAAbAAAAAEAAAByAAAAAAAAAHAAAAAAAAAAXAAAAAEAAABkAAAAAAAAAGYAAAAAAAAAdQAAAAAAAAB5AAAABQAAAHcAAAAFAAAAbQAAAAEAAAB2AAAAAAAAAHgAAAAAAAAAXwAAAAEAAABsAAAAAQAAAHIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAEAAAABAAAAAQAAAAAAAAAAAAAAAQAAAAAAAAABAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAGAAAAAgAAAAUAAAABAAAABAAAAAAAAAAAAAAABQAAAAMAAAABAAAABgAAAAQAAAACAAAAAAAAAH6iBfbytuk/Gq6akm/58z/Xrm0Liez0P5doSdOpSwRAWs602ULg8D/dT7Rcbo/1v1N1RQHFNOM/g9Snx7HW3L8HWsP8Q3jfP6VwOLosutk/9rjk1YQcxj+gnmKMsNn6P/HDeuPFY+M/YHwDjqKhB0Ci19/fCVrbP4UxKkDWOP6/pvljWa09tL9wi7wrQXjnv/Z6yLImkM2/3yTlOzY14D+m+WNZrT20PzwKVQnrQwNA9nrIsiaQzT/g40rFrRQFwPa45NWEHMa/kbslHEZq97/xw3rjxWPjv4cLC2SMBci/otff3wla27+rKF5oIAv0P1N1RQHFNOO/iDJPGyWHBUAHWsP8Q3jfvwQf/by16gXAfqIF9vK26b8XrO0Vh0r+v9eubQuJ7PS/BxLrA0ZZ479azrTZQuDwv1MK1EuItPw/yscgV9Z6FkAwHBR2WjQMQJNRzXsQ5vY/GlUHVJYKF0DONuFv2lMNQNCGZ28QJfk/0WUwoIL36D8ggDOMQuATQNqMOeAy/wZAWFYOYM+M2z/LWC4uH3oSQDE+LyTsMgRAkJzhRGWFGEDd4soovCQQQKqk0DJMEP8/rGmNdwOLBUAW2X/9xCbjP4hu3dcqJhNAzuYItRvdB0CgzW3zJW/sPxotm/Y2TxRAQAk9XmdDDEC1Kx9MKgT3P1M+NctcghZAFVqcLlb0C0Bgzd3sB2b2P77mZDPUWhZAFROHJpUGCEDAfma5CxXtPz1DWq/zYxRAmhYY5824F0DOuQKWSbAOQNCMqrvu3fs/L6DR22K2wT9nAAxPBU8RQGiN6mW43AFAZhu25b633D8c1YgmzowSQNM25BRKWARArGS08/lNxD+LFssHwmMRQLC5aNcxBgJABL9HT0WRF0CjCmJmOGEOQHsuaVzMP/s/TWJCaGGwBUCeu1PAPLzjP9nqN9DZOBNAKE4JcydbCkCGtbd1qjPzP8dgm9U8jhVAtPeKTkVwDkCeCLss5l37P401XMPLmBdAFd29VMVQDUBg0yA55h75Pz6odcYLCRdApBM4rBrkAkDyAVWgQxbRP4XDMnK20hFAymLlF7EmzD8GUgo9XBHlP3lbK7T9COc/k+OhPthhy7+YGEpnrOvCPzBFhLs15u4/epbqB6H4uz9IuuLF5svev6lzLKY31es/CaQ0envF5z8ZY0xlUADXv7zaz7HYEuI/CfbK1sn16T8uAQfWwxLWPzKn/YuFN94/5KdbC1AFu793fyCSnlfvPzK2y4doAMY/NRg5t1/X6b/shq4QJaHDP5yNIAKPOeI/vpn7BSE30r/X4YQrO6nrv78Ziv/Thto/DqJ1Y6+y5z9l51NaxFrlv8QlA65HOLS/86dxiEc96z+Hj0+LFjneP6LzBZ8LTc2/DaJ1Y6+y579l51NaxFrlP8QlA65HOLQ/8qdxiEc967+Jj0+LFjnev6LzBZ8LTc0/1qdbC1AFuz93fyCSnlfvvzK2y4doAMa/NRg5t1/X6T/vhq4QJaHDv5yNIAKPOeK/wJn7BSE30j/W4YQrO6nrP78Ziv/Thtq/CaQ0envF578XY0xlUADXP7zaz7HYEuK/CvbK1sn16b8rAQfWwxLWvzKn/YuFN96/zWLlF7EmzL8GUgo9XBHlv3lbK7T9COe/kOOhPthhyz+cGEpnrOvCvzBFhLs15u6/c5bqB6H4u79IuuLF5sveP6lzLKY31eu/AQAAAP////8HAAAA/////zEAAAD/////VwEAAP////9hCQAA/////6dBAAD/////kcsBAP/////3kAwA/////8H2VwAAAAAAAAAAAAAAAAACAAAA/////w4AAAD/////YgAAAP////+uAgAA/////8ISAAD/////ToMAAP////8ilwMA/////+4hGQD/////gu2vAAAAAAAAAAAAAAAAAAAAAAACAAAA//////////8BAAAAAwAAAP//////////////////////////////////////////////////////////////////////////AQAAAAAAAAACAAAA////////////////AwAAAP//////////////////////////////////////////////////////////////////////////AQAAAAAAAAACAAAA////////////////AwAAAP//////////////////////////////////////////////////////////////////////////AQAAAAAAAAACAAAA////////////////AwAAAP//////////////////////////////////////////////////////////AgAAAP//////////AQAAAAAAAAD/////////////////////AwAAAP////////////////////////////////////////////////////8DAAAA/////////////////////wAAAAD/////////////////////AQAAAP///////////////wIAAAD///////////////////////////////8DAAAA/////////////////////wAAAAD///////////////8CAAAAAQAAAP////////////////////////////////////////////////////8DAAAA/////////////////////wAAAAD///////////////8CAAAAAQAAAP////////////////////////////////////////////////////8DAAAA/////////////////////wAAAAD///////////////8CAAAAAQAAAP////////////////////////////////////////////////////8DAAAA/////////////////////wAAAAD///////////////8CAAAAAQAAAP////////////////////////////////////////////////////8BAAAAAgAAAP///////////////wAAAAD/////////////////////AwAAAP////////////////////////////////////////////////////8BAAAAAgAAAP///////////////wAAAAD/////////////////////AwAAAP////////////////////////////////////////////////////8BAAAAAgAAAP///////////////wAAAAD/////////////////////AwAAAP////////////////////////////////////////////////////8BAAAAAgAAAP///////////////wAAAAD/////////////////////AwAAAP///////////////////////////////wIAAAD///////////////8BAAAA/////////////////////wAAAAD/////////////////////AwAAAP////////////////////////////////////////////////////8DAAAA/////////////////////wAAAAABAAAA//////////8CAAAA//////////////////////////////////////////////////////////8DAAAA////////////////AgAAAAAAAAABAAAA//////////////////////////////////////////////////////////////////////////8DAAAA////////////////AgAAAAAAAAABAAAA//////////////////////////////////////////////////////////////////////////8DAAAA////////////////AgAAAAAAAAABAAAA//////////////////////////////////////////////////////////////////////////8DAAAAAQAAAP//////////AgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAACAAAAAAAAAAIAAAABAAAAAQAAAAIAAAACAAAAAAAAAAUAAAAFAAAAAAAAAAIAAAACAAAAAwAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAgAAAAEAAAACAAAAAgAAAAIAAAAAAAAABQAAAAYAAAAAAAAAAgAAAAIAAAADAAAAAgAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAgAAAAAAAAACAAAAAQAAAAMAAAACAAAAAgAAAAAAAAAFAAAABwAAAAAAAAACAAAAAgAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAACAAAAAAAAAAIAAAABAAAABAAAAAIAAAACAAAAAAAAAAUAAAAIAAAAAAAAAAIAAAACAAAAAwAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAIAAAAAAAAAAgAAAAEAAAAAAAAAAgAAAAIAAAAAAAAABQAAAAkAAAAAAAAAAgAAAAIAAAADAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAKAAAAAgAAAAIAAAAAAAAAAwAAAA4AAAACAAAAAAAAAAIAAAADAAAAAAAAAAAAAAACAAAAAgAAAAMAAAAGAAAAAAAAAAAAAAAAAAAAAAAAAAsAAAACAAAAAgAAAAAAAAADAAAACgAAAAIAAAAAAAAAAgAAAAMAAAABAAAAAAAAAAIAAAACAAAAAwAAAAcAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAIAAAACAAAAAAAAAAMAAAALAAAAAgAAAAAAAAACAAAAAwAAAAIAAAAAAAAAAgAAAAIAAAADAAAACAAAAAAAAAAAAAAAAAAAAAAAAAANAAAAAgAAAAIAAAAAAAAAAwAAAAwAAAACAAAAAAAAAAIAAAADAAAAAwAAAAAAAAACAAAAAgAAAAMAAAAJAAAAAAAAAAAAAAAAAAAAAAAAAA4AAAACAAAAAgAAAAAAAAADAAAADQAAAAIAAAAAAAAAAgAAAAMAAAAEAAAAAAAAAAIAAAACAAAAAwAAAAoAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAIAAAACAAAAAAAAAAMAAAAGAAAAAgAAAAAAAAACAAAAAwAAAA8AAAAAAAAAAgAAAAIAAAADAAAACwAAAAAAAAAAAAAAAAAAAAAAAAAGAAAAAgAAAAIAAAAAAAAAAwAAAAcAAAACAAAAAAAAAAIAAAADAAAAEAAAAAAAAAACAAAAAgAAAAMAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAcAAAACAAAAAgAAAAAAAAADAAAACAAAAAIAAAAAAAAAAgAAAAMAAAARAAAAAAAAAAIAAAACAAAAAwAAAA0AAAAAAAAAAAAAAAAAAAAAAAAACAAAAAIAAAACAAAAAAAAAAMAAAAJAAAAAgAAAAAAAAACAAAAAwAAABIAAAAAAAAAAgAAAAIAAAADAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAJAAAAAgAAAAIAAAAAAAAAAwAAAAUAAAACAAAAAAAAAAIAAAADAAAAEwAAAAAAAAACAAAAAgAAAAMAAAAPAAAAAAAAAAAAAAAAAAAAAAAAABAAAAACAAAAAAAAAAIAAAABAAAAEwAAAAIAAAACAAAAAAAAAAUAAAAKAAAAAAAAAAIAAAACAAAAAwAAABAAAAAAAAAAAAAAAAAAAAAAAAAAEQAAAAIAAAAAAAAAAgAAAAEAAAAPAAAAAgAAAAIAAAAAAAAABQAAAAsAAAAAAAAAAgAAAAIAAAADAAAAEQAAAAAAAAAAAAAAAAAAAAAAAAASAAAAAgAAAAAAAAACAAAAAQAAABAAAAACAAAAAgAAAAAAAAAFAAAADAAAAAAAAAACAAAAAgAAAAMAAAASAAAAAAAAAAAAAAAAAAAAAAAAABMAAAACAAAAAAAAAAIAAAABAAAAEQAAAAIAAAACAAAAAAAAAAUAAAANAAAAAAAAAAIAAAACAAAAAwAAABMAAAAAAAAAAAAAAAAAAAAAAAAADwAAAAIAAAAAAAAAAgAAAAEAAAASAAAAAgAAAAIAAAAAAAAABQAAAA4AAAAAAAAAAgAAAAIAAAADAAAAAgAAAAEAAAAAAAAAAQAAAAIAAAAAAAAAAAAAAAIAAAABAAAAAAAAAAEAAAACAAAAAQAAAAAAAAACAAAAAAAAAAUAAAAEAAAAAAAAAAEAAAAFAAAAAAAAAAAAAAAFAAAABAAAAAAAAAABAAAABQAAAAQAAAAAAAAABQAAAAAAAAACAAAAAQAAAAAAAAABAAAAAgAAAAAAAAAAAAAAAgAAAAEAAAAAAAAAAQAAAAIAAAABAAAAAAAAAAIAAAACAAAAAAAAAAEAAAAAAAAAAAAAAAUAAAAEAAAAAAAAAAEAAAAFAAAAAAAAAAAAAAAFAAAABAAAAAAAAAABAAAABQAAAAQAAAAAAAAABQAAAAUAAAAAAAAAAQAAAAAAAAAAAAAAOgehWlKfUEEz1zLi+JsiQa2og3wcMfVAWCbHorc0yEDi+Yn/Y6mbQJ11/mfsnG9At6bnG4UQQkBvMCQWKqUUQJVmwwswmOc/3hVgVBL3uj//qqOEOdGOPw/WDN4gnGE/H3ANkCUgND+AA8btKgAHPwTXBqJVSdo+XfRQAqsKrj4fc+zLYbSPQklEmCZHv2FCUP+uDso1NEKYtPhwphUHQptxnyFXYdpB7CddZAMmrkGAt1AxSTqBQUibBVdTsFNBSuX3MV+AJkFocv82SLf5QAqmgj7AY81A23VDSEnLoEDGEJVSeDFzQDYrqvBk70VA8U157pcRGUBWfEF+ZKbsP7KBdLHZTpFAqKYk69AqekDbeGY41MdjQD8AZzHK501A1vcrrjubNkD5LnquvBYhQCbiRRD71QlAqt72EbOH8z8Eu+jL1YbdP4uaox/xUcY/abedg1XfsD+BsUdzJ4KZP5wE9YFySIM/rW1kAKMpbT+rZFthVRhWPy4PKlXIs0A/qMZLlwDnMEHByqEF0I0ZQQYSFD8lUQNBPpY+dFs07UAH8BZImBPWQN9RY0I0sMBA2T7kLfc6qUByFYvfhBKTQMq+0Mis1XxA0XQbeQXMZUBJJ5aEGXpQQP7/SY0a6ThAaMD92b/UIkAs8s8yqXoMQNIegOvCk/U/aOi7NZJP4D8AAAAA/////wAAAAAAAAAAAAAAAAAAAAAAAAAA/////////////////////////////////////wAAAAD/////AAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAA/////wAAAAAAAAAAAQAAAAEAAAAAAAAAAAAAAP////8AAAAABQAAAAAAAAAAAAAAAAAAAAAAAAD/////BQAAAAUAAAAAAAAAAAAAAAAAAAAAAAAA/////wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAP////////////////////////////////////8AAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD/////////////////////////////////////AAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAABQAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA/////////////////////////////////////wAAAAABAAAAAQAAAAEAAAABAAAAAQAAAAEAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAEAAAABAAAAAQAAAAAAAAABAAAAAAAAAAUAAAABAAAAAQAAAAAAAAAAAAAAAQAAAAEAAAAAAAAAAQAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQEAAAAAAAEAAQAAAQEAAAAAAAEAAAABAAAAAQABAAAAAAAAAAAAAAAAAAAAAAcAAAAHAAAAAQAAAAIAAAAEAAAAAwAAAAAAAAAAAAAABwAAAAMAAAABAAAAAgAAAAUAAAAEAAAAAAAAAAAAAAAEAAAABAAAAAAAAAACAAAAAQAAAAMAAAAOAAAABgAAAAsAAAACAAAABwAAAAEAAAAYAAAABQAAAAoAAAABAAAABgAAAAAAAAAmAAAABwAAAAwAAAADAAAACAAAAAIAAAAxAAAACQAAAA4AAAAAAAAABQAAAAQAAAA6AAAACAAAAA0AAAAEAAAACQAAAAMAAAA/AAAACwAAAAYAAAAPAAAACgAAABAAAABIAAAADAAAAAcAAAAQAAAACwAAABEAAABTAAAACgAAAAUAAAATAAAADgAAAA8AAABhAAAADQAAAAgAAAARAAAADAAAABIAAABrAAAADgAAAAkAAAASAAAADQAAABMAAAB1AAAADwAAABMAAAARAAAAEgAAABAAAAAGAAAAAgAAAAMAAAAFAAAABAAAAAAAAAAAAAAAAAAAAAYAAAACAAAAAwAAAAEAAAAFAAAABAAAAAAAAAAAAAAABwAAAAUAAAADAAAABAAAAAEAAAAAAAAAAgAAAAAAAAACAAAAAwAAAAEAAAAFAAAABAAAAAYAAAAAAAAAAAAAAGFsZ29zLmMAaDNOZWlnaGJvclJvdGF0aW9ucwBjb29yZGlqay5jAF91cEFwN0NoZWNrZWQAX3VwQXA3ckNoZWNrZWQAZGlyZWN0ZWRFZGdlLmMAZGlyZWN0ZWRFZGdlVG9Cb3VuZGFyeQBhZGphY2VudEZhY2VEaXJbdG1wRmlqay5mYWNlXVtmaWprLmZhY2VdID09IEtJAGZhY2VpamsuYwBfZmFjZUlqa1BlbnRUb0NlbGxCb3VuZGFyeQBhZGphY2VudEZhY2VEaXJbY2VudGVySUpLLmZhY2VdW2ZhY2UyXSA9PSBLSQBfZmFjZUlqa1RvQ2VsbEJvdW5kYXJ5AGgzSW5kZXguYwBjb21wYWN0Q2VsbHMAbGF0TG5nVG9DZWxsAGNlbGxUb0NoaWxkUG9zAHZhbGlkYXRlQ2hpbGRQb3MAbGF0TG5nLmMAY2VsbEFyZWFSYWRzMgBwb2x5Z29uLT5uZXh0ID09IE5VTEwAbGlua2VkR2VvLmMAYWRkTmV3TGlua2VkUG9seWdvbgBuZXh0ICE9IE5VTEwAbG9vcCAhPSBOVUxMAGFkZE5ld0xpbmtlZExvb3AAcG9seWdvbi0+Zmlyc3QgPT0gTlVMTABhZGRMaW5rZWRMb29wAGNvb3JkICE9IE5VTEwAYWRkTGlua2VkQ29vcmQAbG9vcC0+Zmlyc3QgPT0gTlVMTABpbm5lckxvb3BzICE9IE5VTEwAbm9ybWFsaXplTXVsdGlQb2x5Z29uAGJib3hlcyAhPSBOVUxMAGNhbmRpZGF0ZXMgIT0gTlVMTABmaW5kUG9seWdvbkZvckhvbGUAY2FuZGlkYXRlQkJveGVzICE9IE5VTEwAcmV2RGlyICE9IElOVkFMSURfRElHSVQAbG9jYWxpai5jAGNlbGxUb0xvY2FsSWprAGJhc2VDZWxsICE9IG9yaWdpbkJhc2VDZWxsACEob3JpZ2luT25QZW50ICYmIGluZGV4T25QZW50KQBiYXNlQ2VsbCA9PSBvcmlnaW5CYXNlQ2VsbABiYXNlQ2VsbCAhPSBJTlZBTElEX0JBU0VfQ0VMTABsb2NhbElqa1RvQ2VsbAAhX2lzQmFzZUNlbGxQZW50YWdvbihiYXNlQ2VsbCkAYmFzZUNlbGxSb3RhdGlvbnMgPj0gMABncmlkUGF0aENlbGxzADAAdmVydGV4LmMAY2VsbFRvVmVydGV4AGdyYXBoLT5idWNrZXRzICE9IE5VTEwAdmVydGV4R3JhcGguYwBpbml0VmVydGV4R3JhcGgAbm9kZSAhPSBOVUxMAGFkZFZlcnRleE5vZGU=";var ml=24144;function ru(ot){return ot}function Mi(ot){var Zt=/\b__Z[\w\d_]+/g;return ot.replace(Zt,function(Jt){var gr=Jt;return Jt===gr?Jt:gr+" ["+Jt+"]"})}function ss(){var ot=new Error;if(!ot.stack){try{throw new Error(0)}catch(Zt){ot=Zt}if(!ot.stack)return"(no stack trace available)"}return ot.stack.toString()}function nu(){var ot=ss();return Ve.extraStackTrace&&(ot+=`
`+Ve.extraStackTrace()),Mi(ot)}function No(ot,Zt,Jt,gr){tr("Assertion failed: "+In(ot)+", at: "+[Zt?In(Zt):"unknown filename",Jt,gr?In(gr):"unknown function"])}function ds(){return as.length}function Fo(ot,Zt,Jt){Ha.set(Ha.subarray(Zt,Zt+Jt),ot)}function i0(ot){return Ve.___errno_location&&(fu[Ve.___errno_location()>>2]=ot),ot}function tc(ot){tr("OOM")}function va(ot){try{var Zt=new ArrayBuffer(ot);return Zt.byteLength!=ot?void 0:(new Int8Array(Zt).set(as),Gs(Zt),kf(Zt),1)}catch(Jt){}}function Bo(ot){var Zt=ds(),Jt=16777216,gr=2147483648-Jt;if(ot>gr)return!1;for(var v=16777216,Ln=Math.max(Zt,v);Ln<ot;)Ln<=536870912?Ln=xu(2*Ln,Jt):Ln=Math.min(xu((3*Ln+2147483648)/4,Jt),gr);var jn=va(Ln);return!!jn}var Ms=typeof atob=="function"?atob:function(ot){var Zt="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",Jt="",gr,v,Ln,jn,Xe,Ma,ao,xo=0;ot=ot.replace(/[^A-Za-z0-9\+\/\=]/g,"");do jn=Zt.indexOf(ot.charAt(xo++)),Xe=Zt.indexOf(ot.charAt(xo++)),Ma=Zt.indexOf(ot.charAt(xo++)),ao=Zt.indexOf(ot.charAt(xo++)),gr=jn<<2|Xe>>4,v=(Xe&15)<<4|Ma>>2,Ln=(Ma&3)<<6|ao,Jt=Jt+String.fromCharCode(gr),Ma!==64&&(Jt=Jt+String.fromCharCode(v)),ao!==64&&(Jt=Jt+String.fromCharCode(Ln));while(xo<ot.length);return Jt};function fo(ot){try{for(var Zt=Ms(ot),Jt=new Uint8Array(Zt.length),gr=0;gr<Zt.length;++gr)Jt[gr]=Zt.charCodeAt(gr);return Jt}catch(v){throw new Error("Converting base64 string to bytes failed.")}}function Xo(ot){if(Ts(ot))return fo(ot.slice(ia.length))}var hu={Math,Int8Array,Int32Array,Uint8Array,Float32Array,Float64Array},Au={a:tr,b:vi,c:co,d:No,e:i0,f:ds,g:Fo,h:Bo,i:tc,j:ru,k:Mi,l:va,m:ss,n:nu,o:ml,p:Us},zr=function(ot,Zt,Jt){"almost asm";var gr=new ot.Int8Array(Jt),v=new ot.Int32Array(Jt),Ln=new ot.Uint8Array(Jt),jn=new ot.Float32Array(Jt),Xe=new ot.Float64Array(Jt),Ma=Zt.o|0,ao=Zt.p|0,xo=ot.Math.floor,aa=ot.Math.abs,Da=ot.Math.sqrt,us=ot.Math.pow,Ea=ot.Math.cos,Vr=ot.Math.sin,hn=ot.Math.tan,Wn=ot.Math.acos,kn=ot.Math.asin,Kn=ot.Math.atan,Pn=ot.Math.atan2,Fi=ot.Math.ceil,wi=ot.Math.imul,An=ot.Math.min,Ue=ot.Math.max,al=ot.Math.clz32,Bi=Zt.b,lt=Zt.c,ni=Zt.d,_c=Zt.e,xh=Zt.f,xc=Zt.g,o0=Zt.h,tf=Zt.i,et=24160;function Ec(h){return gr=new Int8Array(h),Ln=new Uint8Array(h),v=new Int32Array(h),jn=new Float32Array(h),Xe=new Float64Array(h),Jt=h,!0}function _f(h){h=h|0;var c=0;return c=et,et=et+h|0,et=et+15&-16,c|0}function s0(){return et|0}function Nf(h){h=h|0,et=h}function rf(h,c){h=h|0,c=c|0,et=h}function u0(h,c){h=h|0,c=c|0;var p=0,m=0,E=0;return(h|0)<0?(c=2,c|0):(h|0)>13780509?(c=Mf(15,c)|0,c|0):(p=((h|0)<0)<<31>>31,E=Ri(h|0,p|0,3,0)|0,m=lt()|0,p=un(h|0,p|0,1,0)|0,p=Ri(E|0,m|0,p|0,lt()|0)|0,p=un(p|0,lt()|0,1,0)|0,h=lt()|0,v[c>>2]=p,v[c+4>>2]=h,c=0,c|0)}function xf(h,c,p,m){return h=h|0,c=c|0,p=p|0,m=m|0,z0(h,c,p,m,0)|0}function z0(h,c,p,m,E){h=h|0,c=c|0,p=p|0,m=m|0,E=E|0;var S=0,M=0,k=0,V=0,te=0;if(V=et,et=et+16|0,M=V,!(l0(h,c,p,m,E)|0))return m=0,et=V,m|0;do if((p|0)>=0){if((p|0)>13780509){if(S=Mf(15,M)|0,S|0)break;k=M,M=v[k>>2]|0,k=v[k+4>>2]|0}else S=((p|0)<0)<<31>>31,te=Ri(p|0,S|0,3,0)|0,k=lt()|0,S=un(p|0,S|0,1,0)|0,S=Ri(te|0,k|0,S|0,lt()|0)|0,S=un(S|0,lt()|0,1,0)|0,k=lt()|0,v[M>>2]=S,v[M+4>>2]=k,M=S;if(St(m|0,0,M<<3|0)|0,E|0){St(E|0,0,M<<2|0)|0,S=zu(h,c,p,m,E,M,k,0)|0;break}S=ga(M,4)|0,S?(te=zu(h,c,p,m,S,M,k,0)|0,Tn(S),S=te):S=13}else S=2;while(0);return te=S,et=V,te|0}function l0(h,c,p,m,E){h=h|0,c=c|0,p=p|0,m=m|0,E=E|0;var S=0,M=0,k=0,V=0,te=0,ve=0,Ne=0,ut=0,gt=0,rt=0,_t=0;if(_t=et,et=et+16|0,gt=_t,rt=_t+8|0,ut=gt,v[ut>>2]=h,v[ut+4>>2]=c,(p|0)<0)return rt=2,et=_t,rt|0;if(S=m,v[S>>2]=h,v[S+4>>2]=c,S=(E|0)!=0,S&&(v[E>>2]=0),ha(h,c)|0)return rt=9,et=_t,rt|0;v[rt>>2]=0;e:do if((p|0)>=1)if(S)for(ve=1,te=0,Ne=0,ut=1,S=h;;){if(!(te|Ne)){if(S=Uo(S,c,4,rt,gt)|0,S|0)break e;if(c=gt,S=v[c>>2]|0,c=v[c+4>>2]|0,ha(S,c)|0){S=9;break e}}if(S=Uo(S,c,v[22384+(Ne<<2)>>2]|0,rt,gt)|0,S|0)break e;if(c=gt,S=v[c>>2]|0,c=v[c+4>>2]|0,h=m+(ve<<3)|0,v[h>>2]=S,v[h+4>>2]=c,v[E+(ve<<2)>>2]=ut,h=te+1|0,M=(h|0)==(ut|0),k=Ne+1|0,V=(k|0)==6,ha(S,c)|0){S=9;break e}if(ut=ut+(V&M&1)|0,(ut|0)>(p|0)){S=0;break}else ve=ve+1|0,te=M?0:h,Ne=M?V?0:k:Ne}else for(ve=1,te=0,Ne=0,ut=1,S=h;;){if(!(te|Ne)){if(S=Uo(S,c,4,rt,gt)|0,S|0)break e;if(c=gt,S=v[c>>2]|0,c=v[c+4>>2]|0,ha(S,c)|0){S=9;break e}}if(S=Uo(S,c,v[22384+(Ne<<2)>>2]|0,rt,gt)|0,S|0)break e;if(c=gt,S=v[c>>2]|0,c=v[c+4>>2]|0,h=m+(ve<<3)|0,v[h>>2]=S,v[h+4>>2]=c,h=te+1|0,M=(h|0)==(ut|0),k=Ne+1|0,V=(k|0)==6,ha(S,c)|0){S=9;break e}if(ut=ut+(V&M&1)|0,(ut|0)>(p|0)){S=0;break}else ve=ve+1|0,te=M?0:h,Ne=M?V?0:k:Ne}else S=0;while(0);return rt=S,et=_t,rt|0}function zu(h,c,p,m,E,S,M,k){h=h|0,c=c|0,p=p|0,m=m|0,E=E|0,S=S|0,M=M|0,k=k|0;var V=0,te=0,ve=0,Ne=0,ut=0,gt=0,rt=0,_t=0,$t=0,qt=0;if(_t=et,et=et+16|0,gt=_t+8|0,rt=_t,V=es(h|0,c|0,S|0,M|0)|0,ve=lt()|0,Ne=m+(V<<3)|0,$t=Ne,qt=v[$t>>2]|0,$t=v[$t+4>>2]|0,te=(qt|0)==(h|0)&($t|0)==(c|0),!((qt|0)==0&($t|0)==0|te))do V=un(V|0,ve|0,1,0)|0,V=Xt(V|0,lt()|0,S|0,M|0)|0,ve=lt()|0,Ne=m+(V<<3)|0,qt=Ne,$t=v[qt>>2]|0,qt=v[qt+4>>2]|0,te=($t|0)==(h|0)&(qt|0)==(c|0);while(!(($t|0)==0&(qt|0)==0|te));if(V=E+(V<<2)|0,te&&(v[V>>2]|0)<=(k|0)||(qt=Ne,v[qt>>2]=h,v[qt+4>>2]=c,v[V>>2]=k,(k|0)>=(p|0)))return qt=0,et=_t,qt|0;switch(te=k+1|0,v[gt>>2]=0,V=Uo(h,c,2,gt,rt)|0,V|0){case 9:{ut=9;break}case 0:{V=rt,V=zu(v[V>>2]|0,v[V+4>>2]|0,p,m,E,S,M,te)|0,V||(ut=9);break}default:}e:do if((ut|0)==9){switch(v[gt>>2]=0,V=Uo(h,c,3,gt,rt)|0,V|0){case 9:break;case 0:{if(V=rt,V=zu(v[V>>2]|0,v[V+4>>2]|0,p,m,E,S,M,te)|0,V|0)break e;break}default:break e}switch(v[gt>>2]=0,V=Uo(h,c,1,gt,rt)|0,V|0){case 9:break;case 0:{if(V=rt,V=zu(v[V>>2]|0,v[V+4>>2]|0,p,m,E,S,M,te)|0,V|0)break e;break}default:break e}switch(v[gt>>2]=0,V=Uo(h,c,5,gt,rt)|0,V|0){case 9:break;case 0:{if(V=rt,V=zu(v[V>>2]|0,v[V+4>>2]|0,p,m,E,S,M,te)|0,V|0)break e;break}default:break e}switch(v[gt>>2]=0,V=Uo(h,c,4,gt,rt)|0,V|0){case 9:break;case 0:{if(V=rt,V=zu(v[V>>2]|0,v[V+4>>2]|0,p,m,E,S,M,te)|0,V|0)break e;break}default:break e}switch(v[gt>>2]=0,V=Uo(h,c,6,gt,rt)|0,V|0){case 9:break;case 0:{if(V=rt,V=zu(v[V>>2]|0,v[V+4>>2]|0,p,m,E,S,M,te)|0,V|0)break e;break}default:break e}return qt=0,et=_t,qt|0}while(0);return qt=V,et=_t,qt|0}function Uo(h,c,p,m,E){h=h|0,c=c|0,p=p|0,m=m|0,E=E|0;var S=0,M=0,k=0,V=0,te=0,ve=0,Ne=0,ut=0,gt=0,rt=0;if(p>>>0>6)return E=1,E|0;if(Ne=(v[m>>2]|0)%6|0,v[m>>2]=Ne,(Ne|0)>0){S=0;do p=Tc(p)|0,S=S+1|0;while((S|0)<(v[m>>2]|0))}if(Ne=ft(h|0,c|0,45)|0,lt()|0,ve=Ne&127,ve>>>0>121)return E=5,E|0;V=Xs(h,c)|0,S=ft(h|0,c|0,52)|0,lt()|0,S=S&15;e:do if(!S)te=8;else{for(;;){if(M=(15-S|0)*3|0,k=ft(h|0,c|0,M|0)|0,lt()|0,k=k&7,(k|0)==7){c=5;break}if(rt=(au(S)|0)==0,S=S+-1|0,ut=xt(7,0,M|0)|0,c=c&~(lt()|0),gt=xt(v[(rt?432:16)+(k*28|0)+(p<<2)>>2]|0,0,M|0)|0,M=lt()|0,p=v[(rt?640:224)+(k*28|0)+(p<<2)>>2]|0,h=gt|h&~ut,c=M|c,!p){p=0;break e}if(!S){te=8;break e}}return c|0}while(0);(te|0)==8&&(rt=v[848+(ve*28|0)+(p<<2)>>2]|0,gt=xt(rt|0,0,45)|0,h=gt|h,c=lt()|0|c&-1040385,p=v[4272+(ve*28|0)+(p<<2)>>2]|0,(rt&127|0)==127&&(rt=xt(v[848+(ve*28|0)+20>>2]|0,0,45)|0,c=lt()|0|c&-1040385,p=v[4272+(ve*28|0)+20>>2]|0,h=wl(rt|h,c)|0,c=lt()|0,v[m>>2]=(v[m>>2]|0)+1)),k=ft(h|0,c|0,45)|0,lt()|0,k=k&127;e:do if(fa(k)|0){t:do if((Xs(h,c)|0)==1){if((ve|0)!=(k|0))if(f0(k,v[7696+(ve*28|0)>>2]|0)|0){h=Mu(h,c)|0,M=1,c=lt()|0;break}else ni(23313,22416,436,22424);switch(V|0){case 3:{h=wl(h,c)|0,c=lt()|0,v[m>>2]=(v[m>>2]|0)+1,M=0;break t}case 5:{h=Mu(h,c)|0,c=lt()|0,v[m>>2]=(v[m>>2]|0)+5,M=0;break t}case 0:return rt=9,rt|0;default:return rt=1,rt|0}}else M=0;while(0);if((p|0)>0){S=0;do h=Oc(h,c)|0,c=lt()|0,S=S+1|0;while((S|0)!=(p|0))}if((ve|0)!=(k|0)){if(!(za(k)|0)){if((M|0)!=0|(Xs(h,c)|0)!=5)break;v[m>>2]=(v[m>>2]|0)+1;break}switch(Ne&127){case 8:case 118:break e;default:}(Xs(h,c)|0)!=3&&(v[m>>2]=(v[m>>2]|0)+1)}}else if((p|0)>0){S=0;do h=wl(h,c)|0,c=lt()|0,S=S+1|0;while((S|0)!=(p|0))}while(0);return v[m>>2]=((v[m>>2]|0)+p|0)%6|0,rt=E,v[rt>>2]=h,v[rt+4>>2]=c,rt=0,rt|0}function Ff(h,c,p,m){h=h|0,c=c|0,p=p|0,m=m|0;var E=0,S=0,M=0,k=0,V=0,te=0;for(k=et,et=et+16|0,S=k,M=k+8|0,E=(ha(h,c)|0)==0,E=E?1:2;;){if(v[M>>2]=0,te=(Uo(h,c,E,M,S)|0)==0,V=S,te&((v[V>>2]|0)==(p|0)?(v[V+4>>2]|0)==(m|0):0)){h=4;break}if(E=E+1|0,E>>>0>=7){E=7,h=4;break}}return(h|0)==4?(et=k,E|0):0}function Eh(h,c,p,m){h=h|0,c=c|0,p=p|0,m=m|0;var E=0,S=0,M=0,k=0,V=0,te=0,ve=0,Ne=0,ut=0,gt=0,rt=0;if(rt=et,et=et+16|0,ut=rt,gt=rt+8|0,Ne=ut,v[Ne>>2]=h,v[Ne+4>>2]=c,!p)return gt=m,v[gt>>2]=h,v[gt+4>>2]=c,gt=0,et=rt,gt|0;v[gt>>2]=0;e:do if(ha(h,c)|0)h=9;else{if(S=(p|0)>0,S){E=0,Ne=h;do{if(h=Uo(Ne,c,4,gt,ut)|0,h|0)break e;if(c=ut,Ne=v[c>>2]|0,c=v[c+4>>2]|0,E=E+1|0,ha(Ne,c)|0){h=9;break e}}while((E|0)<(p|0));if(ve=m,v[ve>>2]=Ne,v[ve+4>>2]=c,ve=p+-1|0,S){te=0,h=1;do{if(E=22384+(te<<2)|0,(te|0)==5)for(M=v[E>>2]|0,S=0,E=h;;){if(h=ut,h=Uo(v[h>>2]|0,v[h+4>>2]|0,M,gt,ut)|0,h|0)break e;if((S|0)!=(ve|0))if(V=ut,k=v[V>>2]|0,V=v[V+4>>2]|0,h=m+(E<<3)|0,v[h>>2]=k,v[h+4>>2]=V,!(ha(k,V)|0))h=E+1|0;else{h=9;break e}else h=E;if(S=S+1|0,(S|0)>=(p|0))break;E=h}else for(M=ut,V=v[E>>2]|0,k=0,E=h,S=v[M>>2]|0,M=v[M+4>>2]|0;;){if(h=Uo(S,M,V,gt,ut)|0,h|0)break e;if(M=ut,S=v[M>>2]|0,M=v[M+4>>2]|0,h=m+(E<<3)|0,v[h>>2]=S,v[h+4>>2]=M,h=E+1|0,ha(S,M)|0){h=9;break e}if(k=k+1|0,(k|0)>=(p|0))break;E=h}te=te+1|0}while(te>>>0<6);h=ut,M=Ne,E=v[h>>2]|0,S=c,h=v[h+4>>2]|0}else M=Ne,E=Ne,S=c,h=c}else M=m,v[M>>2]=h,v[M+4>>2]=c,M=h,E=h,S=c,h=c;h=(M|0)==(E|0)&(S|0)==(h|0)?0:9}while(0);return gt=h,et=rt,gt|0}function Bf(h,c,p,m){h=h|0,c=c|0,p=p|0,m=m|0;var E=0,S=0,M=0,k=0,V=0,te=0;if(k=et,et=et+48|0,E=k+16|0,S=k+8|0,M=k,p|0)return M=15,et=k,M|0;if(te=h,V=v[te+4>>2]|0,p=S,v[p>>2]=v[te>>2],v[p+4>>2]=V,Tr(S,E),c=oo(E,c,M)|0,!c){if(p=v[S>>2]|0,S=v[h+8>>2]|0,(S|0)>0){E=v[h+12>>2]|0,c=0;do p=(v[E+(c<<3)>>2]|0)+p|0,c=c+1|0;while((c|0)<(S|0))}c=M,E=v[c>>2]|0,c=v[c+4>>2]|0,S=((p|0)<0)<<31>>31,(c|0)<(S|0)|(c|0)==(S|0)&E>>>0<p>>>0?(c=M,v[c>>2]=p,v[c+4>>2]=S,c=S):p=E,V=un(p|0,c|0,12,0)|0,te=lt()|0,c=M,v[c>>2]=V,v[c+4>>2]=te,c=m,v[c>>2]=V,v[c+4>>2]=te,c=0}return te=c,et=k,te|0}function Nl(h,c,p,m,E,S,M){h=h|0,c=c|0,p=p|0,m=m|0,E=E|0,S=S|0,M=M|0;var k=0,V=0,te=0,ve=0,Ne=0,ut=0,gt=0,rt=0,_t=0,$t=0,qt=0,Yt=0,rr=0,Wt=0,rn=0,En=0,Kr=0,pn=0,La=0,oa=0,pa=0,Vi=0,ui=0,ki=0,Ya=0,Qn=0,Xa=0,Iu=0,X0=0;if(Ya=et,et=et+64|0,pa=Ya+48|0,Vi=Ya+32|0,ui=Ya+24|0,rn=Ya+8|0,En=Ya,V=v[h>>2]|0,(V|0)<=0)return ki=0,et=Ya,ki|0;for(Kr=h+4|0,pn=pa+8|0,La=Vi+8|0,oa=rn+8|0,k=0,rr=0;;){te=v[Kr>>2]|0,Yt=te+(rr<<4)|0,v[pa>>2]=v[Yt>>2],v[pa+4>>2]=v[Yt+4>>2],v[pa+8>>2]=v[Yt+8>>2],v[pa+12>>2]=v[Yt+12>>2],(rr|0)==(V+-1|0)?(v[Vi>>2]=v[te>>2],v[Vi+4>>2]=v[te+4>>2],v[Vi+8>>2]=v[te+8>>2],v[Vi+12>>2]=v[te+12>>2]):(Yt=te+(rr+1<<4)|0,v[Vi>>2]=v[Yt>>2],v[Vi+4>>2]=v[Yt+4>>2],v[Vi+8>>2]=v[Yt+8>>2],v[Vi+12>>2]=v[Yt+12>>2]),V=Uu(pa,Vi,m,ui)|0;e:do if(V)te=0,k=V;else if(te=ui,V=v[te>>2]|0,te=v[te+4>>2]|0,(te|0)>0|(te|0)==0&V>>>0>0){qt=0,Yt=0;t:for(;;){if(X0=+Xe[pa>>3],$t=Aa(V|0,te|0,qt|0,Yt|0)|0,Iu=+($t>>>0)+4294967296*+(lt()|0),Qn=+(V>>>0)+4294967296*+(te|0),Xa=+(qt>>>0)+4294967296*+(Yt|0),Xe[rn>>3]=X0*Iu/Qn+ +Xe[Vi>>3]*Xa/Qn,Xe[oa>>3]=+Xe[pn>>3]*Iu/Qn+ +Xe[La>>3]*Xa/Qn,V=sf(rn,m,En)|0,V|0){k=V;break}$t=En,_t=v[$t>>2]|0,$t=v[$t+4>>2]|0,ut=es(_t|0,$t|0,c|0,p|0)|0,ve=lt()|0,V=M+(ut<<3)|0,Ne=V,te=v[Ne>>2]|0,Ne=v[Ne+4>>2]|0;r:do if((te|0)==0&(Ne|0)==0)Wt=V,ki=16;else for(gt=0,rt=0;;){if((gt|0)>(p|0)|(gt|0)==(p|0)&rt>>>0>c>>>0){k=1;break t}if((te|0)==(_t|0)&(Ne|0)==($t|0))break r;if(V=un(ut|0,ve|0,1,0)|0,ut=Xt(V|0,lt()|0,c|0,p|0)|0,ve=lt()|0,rt=un(rt|0,gt|0,1,0)|0,gt=lt()|0,V=M+(ut<<3)|0,Ne=V,te=v[Ne>>2]|0,Ne=v[Ne+4>>2]|0,(te|0)==0&(Ne|0)==0){Wt=V,ki=16;break}}while(0);if((ki|0)==16&&(ki=0,!((_t|0)==0&($t|0)==0))&&(rt=Wt,v[rt>>2]=_t,v[rt+4>>2]=$t,rt=S+(v[E>>2]<<3)|0,v[rt>>2]=_t,v[rt+4>>2]=$t,rt=E,rt=un(v[rt>>2]|0,v[rt+4>>2]|0,1,0)|0,_t=lt()|0,$t=E,v[$t>>2]=rt,v[$t+4>>2]=_t),qt=un(qt|0,Yt|0,1,0)|0,Yt=lt()|0,te=ui,V=v[te>>2]|0,te=v[te+4>>2]|0,!((te|0)>(Yt|0)|(te|0)==(Yt|0)&V>>>0>qt>>>0)){te=1;break e}}te=0}else te=1;while(0);if(rr=rr+1|0,!te){ki=21;break}if(V=v[h>>2]|0,(rr|0)>=(V|0)){k=0,ki=21;break}}return(ki|0)==21?(et=Ya,k|0):0}function bc(h,c,p,m){h=h|0,c=c|0,p=p|0,m=m|0;var E=0,S=0,M=0,k=0,V=0,te=0,ve=0,Ne=0,ut=0,gt=0,rt=0,_t=0,$t=0,qt=0,Yt=0,rr=0,Wt=0,rn=0,En=0,Kr=0,pn=0,La=0,oa=0,pa=0,Vi=0,ui=0,ki=0,Ya=0,Qn=0,Xa=0,Iu=0;if(Iu=et,et=et+112|0,ki=Iu+80|0,V=Iu+72|0,Ya=Iu,Qn=Iu+56|0,p|0)return Xa=15,et=Iu,Xa|0;if(te=h+8|0,Xa=Ua((v[te>>2]<<5)+32|0)|0,!Xa)return Xa=13,et=Iu,Xa|0;if(Zr(h,Xa),Vi=h,ui=v[Vi+4>>2]|0,p=V,v[p>>2]=v[Vi>>2],v[p+4>>2]=ui,Tr(V,ki),p=oo(ki,c,Ya)|0,p)Vi=0,ui=0;else{if(p=v[V>>2]|0,S=v[te>>2]|0,(S|0)>0){M=v[h+12>>2]|0,E=0;do p=(v[M+(E<<3)>>2]|0)+p|0,E=E+1|0;while((E|0)!=(S|0));E=p}else E=p;p=Ya,S=v[p>>2]|0,p=v[p+4>>2]|0,M=((E|0)<0)<<31>>31,(p|0)<(M|0)|(p|0)==(M|0)&S>>>0<E>>>0?(p=Ya,v[p>>2]=E,v[p+4>>2]=M,p=M):E=S,Vi=un(E|0,p|0,12,0)|0,ui=lt()|0,p=Ya,v[p>>2]=Vi,v[p+4>>2]=ui,p=0}if(p|0)return Tn(Xa),Xa=p,et=Iu,Xa|0;if(E=ga(Vi,8)|0,!E)return Tn(Xa),Xa=13,et=Iu,Xa|0;if(k=ga(Vi,8)|0,!k)return Tn(Xa),Tn(E),Xa=13,et=Iu,Xa|0;oa=ki,v[oa>>2]=0,v[oa+4>>2]=0,oa=h,pa=v[oa+4>>2]|0,p=V,v[p>>2]=v[oa>>2],v[p+4>>2]=pa,p=Nl(V,Vi,ui,c,ki,E,k)|0;e:do if(p)Tn(E),Tn(k),Tn(Xa);else{t:do if((v[te>>2]|0)>0){for(M=h+12|0,S=0;p=Nl((v[M>>2]|0)+(S<<3)|0,Vi,ui,c,ki,E,k)|0,S=S+1|0,!(p|0);)if((S|0)>=(v[te>>2]|0))break t;Tn(E),Tn(k),Tn(Xa);break e}while(0);(ui|0)>0|(ui|0)==0&Vi>>>0>0&&St(k|0,0,Vi<<3|0)|0,pa=ki,oa=v[pa+4>>2]|0;t:do if((oa|0)>0|(oa|0)==0&(v[pa>>2]|0)>>>0>0){Kr=E,pn=k,La=E,oa=k,pa=E,p=E,Wt=E,rn=k,En=k,E=k;r:for(;;){for($t=0,qt=0,Yt=0,rr=0,S=0,M=0;;){k=Ya,V=k+56|0;do v[k>>2]=0,k=k+4|0;while((k|0)<(V|0));if(c=Kr+($t<<3)|0,te=v[c>>2]|0,c=v[c+4>>2]|0,l0(te,c,1,Ya,0)|0){k=Ya,V=k+56|0;do v[k>>2]=0,k=k+4|0;while((k|0)<(V|0));k=ga(7,4)|0,k|0&&(zu(te,c,1,Ya,k,7,0,0)|0,Tn(k))}for(_t=0;;){rt=Ya+(_t<<3)|0,gt=v[rt>>2]|0,rt=v[rt+4>>2]|0;n:do if((gt|0)==0&(rt|0)==0)k=S,V=M;else{if(ve=es(gt|0,rt|0,Vi|0,ui|0)|0,te=lt()|0,k=m+(ve<<3)|0,c=k,V=v[c>>2]|0,c=v[c+4>>2]|0,!((V|0)==0&(c|0)==0)){Ne=0,ut=0;do{if((Ne|0)>(ui|0)|(Ne|0)==(ui|0)&ut>>>0>Vi>>>0)break r;if((V|0)==(gt|0)&(c|0)==(rt|0)){k=S,V=M;break n}k=un(ve|0,te|0,1,0)|0,ve=Xt(k|0,lt()|0,Vi|0,ui|0)|0,te=lt()|0,ut=un(ut|0,Ne|0,1,0)|0,Ne=lt()|0,k=m+(ve<<3)|0,c=k,V=v[c>>2]|0,c=v[c+4>>2]|0}while(!((V|0)==0&(c|0)==0))}(gt|0)==0&(rt|0)==0?(k=S,V=M):(Ps(gt,rt,Qn)|0,Vt(h,Xa,Qn)|0&&(ut=un(S|0,M|0,1,0)|0,M=lt()|0,Ne=k,v[Ne>>2]=gt,v[Ne+4>>2]=rt,S=pn+(S<<3)|0,v[S>>2]=gt,v[S+4>>2]=rt,S=ut),k=S,V=M)}while(0);if(_t=_t+1|0,_t>>>0>=7)break;S=k,M=V}if($t=un($t|0,qt|0,1,0)|0,qt=lt()|0,Yt=un(Yt|0,rr|0,1,0)|0,rr=lt()|0,M=ki,S=v[M>>2]|0,M=v[M+4>>2]|0,(rr|0)<(M|0)|(rr|0)==(M|0)&Yt>>>0<S>>>0)S=k,M=V;else break}if((M|0)>0|(M|0)==0&S>>>0>0){S=0,M=0;do rr=Kr+(S<<3)|0,v[rr>>2]=0,v[rr+4>>2]=0,S=un(S|0,M|0,1,0)|0,M=lt()|0,rr=ki,Yt=v[rr+4>>2]|0;while((M|0)<(Yt|0)|((M|0)==(Yt|0)?S>>>0<(v[rr>>2]|0)>>>0:0))}if(rr=ki,v[rr>>2]=k,v[rr+4>>2]=V,(V|0)>0|(V|0)==0&k>>>0>0)_t=E,$t=En,qt=pa,Yt=rn,rr=pn,E=Wt,En=p,rn=La,Wt=_t,p=$t,pa=oa,oa=qt,La=Yt,pn=Kr,Kr=rr;else break t}Tn(La),Tn(oa),Tn(Xa),p=1;break e}else p=k;while(0);Tn(Xa),Tn(E),Tn(p),p=0}while(0);return Xa=p,et=Iu,Xa|0}function nf(h,c,p){h=h|0,c=c|0,p=p|0;var m=0,E=0,S=0,M=0,k=0,V=0,te=0,ve=0;if(ve=et,et=et+176|0,V=ve,(c|0)<1)return yi(p,0,0),te=0,et=ve,te|0;for(k=h,k=ft(v[k>>2]|0,v[k+4>>2]|0,52)|0,lt()|0,yi(p,(c|0)>6?c:6,k&15),k=0;m=h+(k<<3)|0,m=Rc(v[m>>2]|0,v[m+4>>2]|0,V)|0,!(m|0);){if(m=v[V>>2]|0,(m|0)>0){M=0;do S=V+8+(M<<4)|0,M=M+1|0,m=V+8+(((M|0)%(m|0)|0)<<4)|0,E=Io(p,m,S)|0,E?ro(p,E)|0:Ti(p,S,m)|0,m=v[V>>2]|0;while((M|0)<(m|0))}if(k=k+1|0,(k|0)>=(c|0)){m=0,te=13;break}}return(te|0)==13?(et=ve,m|0):(ta(p),te=m,et=ve,te|0)}function c0(h,c,p){h=h|0,c=c|0,p=p|0;var m=0,E=0,S=0,M=0;if(S=et,et=et+32|0,m=S,E=S+16|0,h=nf(h,c,E)|0,h|0)return p=h,et=S,p|0;if(v[p>>2]=0,v[p+4>>2]=0,v[p+8>>2]=0,h=bo(E)|0,h|0)do{c=y0(p)|0;do xe(c,h)|0,M=h+16|0,v[m>>2]=v[M>>2],v[m+4>>2]=v[M+4>>2],v[m+8>>2]=v[M+8>>2],v[m+12>>2]=v[M+12>>2],ro(E,h)|0,h=Na(E,m)|0;while(h|0);h=bo(E)|0}while(h|0);return ta(E),h=mt(p)|0,h?(Ke(p),M=h,et=S,M|0):(M=0,et=S,M|0)}function fa(h){return h=h|0,h>>>0>121?(h=0,h|0):(h=v[7696+(h*28|0)+16>>2]|0,h|0)}function za(h){return h=h|0,(h|0)==4|(h|0)==117|0}function Go(h){return h=h|0,v[11120+((v[h>>2]|0)*216|0)+((v[h+4>>2]|0)*72|0)+((v[h+8>>2]|0)*24|0)+(v[h+12>>2]<<3)>>2]|0}function Zf(h){return h=h|0,v[11120+((v[h>>2]|0)*216|0)+((v[h+4>>2]|0)*72|0)+((v[h+8>>2]|0)*24|0)+(v[h+12>>2]<<3)+4>>2]|0}function U0(h,c){h=h|0,c=c|0,h=7696+(h*28|0)|0,v[c>>2]=v[h>>2],v[c+4>>2]=v[h+4>>2],v[c+8>>2]=v[h+8>>2],v[c+12>>2]=v[h+12>>2]}function zf(h,c){h=h|0,c=c|0;var p=0,m=0;if(c>>>0>20)return c=-1,c|0;do if((v[11120+(c*216|0)>>2]|0)!=(h|0))if((v[11120+(c*216|0)+8>>2]|0)!=(h|0))if((v[11120+(c*216|0)+16>>2]|0)!=(h|0))if((v[11120+(c*216|0)+24>>2]|0)!=(h|0))if((v[11120+(c*216|0)+32>>2]|0)!=(h|0))if((v[11120+(c*216|0)+40>>2]|0)!=(h|0))if((v[11120+(c*216|0)+48>>2]|0)!=(h|0))if((v[11120+(c*216|0)+56>>2]|0)!=(h|0))if((v[11120+(c*216|0)+64>>2]|0)!=(h|0))if((v[11120+(c*216|0)+72>>2]|0)!=(h|0))if((v[11120+(c*216|0)+80>>2]|0)!=(h|0))if((v[11120+(c*216|0)+88>>2]|0)!=(h|0))if((v[11120+(c*216|0)+96>>2]|0)!=(h|0))if((v[11120+(c*216|0)+104>>2]|0)!=(h|0))if((v[11120+(c*216|0)+112>>2]|0)!=(h|0))if((v[11120+(c*216|0)+120>>2]|0)!=(h|0))if((v[11120+(c*216|0)+128>>2]|0)!=(h|0))if((v[11120+(c*216|0)+136>>2]|0)==(h|0))h=2,p=1,m=2;else{if((v[11120+(c*216|0)+144>>2]|0)==(h|0)){h=0,p=2,m=0;break}if((v[11120+(c*216|0)+152>>2]|0)==(h|0)){h=0,p=2,m=1;break}if((v[11120+(c*216|0)+160>>2]|0)==(h|0)){h=0,p=2,m=2;break}if((v[11120+(c*216|0)+168>>2]|0)==(h|0)){h=1,p=2,m=0;break}if((v[11120+(c*216|0)+176>>2]|0)==(h|0)){h=1,p=2,m=1;break}if((v[11120+(c*216|0)+184>>2]|0)==(h|0)){h=1,p=2,m=2;break}if((v[11120+(c*216|0)+192>>2]|0)==(h|0)){h=2,p=2,m=0;break}if((v[11120+(c*216|0)+200>>2]|0)==(h|0)){h=2,p=2,m=1;break}if((v[11120+(c*216|0)+208>>2]|0)==(h|0)){h=2,p=2,m=2;break}else h=-1;return h|0}else h=2,p=1,m=1;else h=2,p=1,m=0;else h=1,p=1,m=2;else h=1,p=1,m=1;else h=1,p=1,m=0;else h=0,p=1,m=2;else h=0,p=1,m=1;else h=0,p=1,m=0;else h=2,p=0,m=2;else h=2,p=0,m=1;else h=2,p=0,m=0;else h=1,p=0,m=2;else h=1,p=0,m=1;else h=1,p=0,m=0;else h=0,p=0,m=2;else h=0,p=0,m=1;else h=0,p=0,m=0;while(0);return c=v[11120+(c*216|0)+(p*72|0)+(h*24|0)+(m<<3)+4>>2]|0,c|0}function f0(h,c){return h=h|0,c=c|0,(v[7696+(h*28|0)+20>>2]|0)==(c|0)?(c=1,c|0):(c=(v[7696+(h*28|0)+24>>2]|0)==(c|0),c|0)}function Uf(h,c){return h=h|0,c=c|0,v[848+(h*28|0)+(c<<2)>>2]|0}function Xi(h,c){return h=h|0,c=c|0,(v[848+(h*28|0)>>2]|0)==(c|0)?(c=0,c|0):(v[848+(h*28|0)+4>>2]|0)==(c|0)?(c=1,c|0):(v[848+(h*28|0)+8>>2]|0)==(c|0)?(c=2,c|0):(v[848+(h*28|0)+12>>2]|0)==(c|0)?(c=3,c|0):(v[848+(h*28|0)+16>>2]|0)==(c|0)?(c=4,c|0):(v[848+(h*28|0)+20>>2]|0)==(c|0)?(c=5,c|0):((v[848+(h*28|0)+24>>2]|0)==(c|0)?6:7)|0}function Gf(){return 122}function Fl(h){h=h|0;var c=0,p=0,m=0;c=0;do xt(c|0,0,45)|0,m=lt()|0|134225919,p=h+(c<<3)|0,v[p>>2]=-1,v[p+4>>2]=m,c=c+1|0;while((c|0)!=122);return 0}function iu(h){return h=h|0,+Xe[h+16>>3]<+Xe[h+24>>3]|0}function nc(h,c){h=h|0,c=c|0;var p=0,m=0,E=0;return p=+Xe[c>>3],!(p>=+Xe[h+8>>3])||!(p<=+Xe[h>>3])?(c=0,c|0):(m=+Xe[h+16>>3],p=+Xe[h+24>>3],E=+Xe[c+8>>3],c=E>=p,h=E<=m&1,m<p?c&&(h=1):c||(h=0),c=(h|0)!=0,c|0)}function oo(h,c,p){h=h|0,c=c|0,p=p|0;var m=0,E=0,S=0,M=0,k=0,V=0,te=0,ve=0,Ne=0,ut=0,gt=0,rt=0,_t=0,$t=0;rt=et,et=et+288|0,ve=rt+264|0,Ne=rt+96|0,te=rt,k=te,V=k+96|0;do v[k>>2]=0,k=k+4|0;while((k|0)<(V|0));return c=uf(c,te)|0,c|0?(gt=c,et=rt,gt|0):(V=te,te=v[V>>2]|0,V=v[V+4>>2]|0,Ps(te,V,ve)|0,Rc(te,V,Ne)|0,M=+cl(ve,Ne+8|0),Xe[ve>>3]=+Xe[h>>3],V=ve+8|0,Xe[V>>3]=+Xe[h+16>>3],Xe[Ne>>3]=+Xe[h+8>>3],te=Ne+8|0,Xe[te>>3]=+Xe[h+24>>3],E=+cl(ve,Ne),$t=+Xe[V>>3]-+Xe[te>>3],S=+aa(+$t),_t=+Xe[ve>>3]-+Xe[Ne>>3],m=+aa(+_t),!($t==0|_t==0)&&($t=+Ur(+S,+m),$t=+Fi(+(E*E/+Un(+($t/+Un(+S,+m)),3)/(M*(M*2.59807621135)*.8))),Xe[Ma>>3]=$t,ut=~~$t>>>0,gt=+aa($t)>=1?$t>0?~~+An(+xo($t/4294967296),4294967295)>>>0:~~+Fi(($t-+(~~$t>>>0))/4294967296)>>>0:0,(v[Ma+4>>2]&2146435072|0)!=2146435072)?(Ne=(ut|0)==0&(gt|0)==0,c=p,v[c>>2]=Ne?1:ut,v[c+4>>2]=Ne?0:gt,c=0):c=1,gt=c,et=rt,gt|0)}function Uu(h,c,p,m){h=h|0,c=c|0,p=p|0,m=m|0;var E=0,S=0,M=0,k=0,V=0,te=0,ve=0;te=et,et=et+288|0,M=te+264|0,k=te+96|0,V=te,E=V,S=E+96|0;do v[E>>2]=0,E=E+4|0;while((E|0)<(S|0));return p=uf(p,V)|0,p|0?(m=p,et=te,m|0):(p=V,E=v[p>>2]|0,p=v[p+4>>2]|0,Ps(E,p,M)|0,Rc(E,p,k)|0,ve=+cl(M,k+8|0),ve=+Fi(+(+cl(h,c)/(ve*2))),Xe[Ma>>3]=ve,p=~~ve>>>0,E=+aa(ve)>=1?ve>0?~~+An(+xo(ve/4294967296),4294967295)>>>0:~~+Fi((ve-+(~~ve>>>0))/4294967296)>>>0:0,(v[Ma+4>>2]&2146435072|0)==2146435072?(m=1,et=te,m|0):(V=(p|0)==0&(E|0)==0,v[m>>2]=V?1:p,v[m+4>>2]=V?0:E,m=0,et=te,m|0))}function Bl(h,c,p,m){h=h|0,c=c|0,p=p|0,m=m|0,v[h>>2]=c,v[h+4>>2]=p,v[h+8>>2]=m}function Ef(h,c){h=h|0,c=c|0;var p=0,m=0,E=0,S=0,M=0,k=0,V=0,te=0,ve=0,Ne=0,ut=0;Ne=c+8|0,v[Ne>>2]=0,V=+Xe[h>>3],M=+aa(+V),te=+Xe[h+8>>3],k=+aa(+te)/.8660254037844386,M=M+k*.5,p=~~M,h=~~k,M=M-+(p|0),k=k-+(h|0);do if(M<.5)if(M<.3333333333333333)if(v[c>>2]=p,k<(M+1)*.5){v[c+4>>2]=h;break}else{h=h+1|0,v[c+4>>2]=h;break}else if(ut=1-M,h=(!(k<ut)&1)+h|0,v[c+4>>2]=h,ut<=k&k<M*2){p=p+1|0,v[c>>2]=p;break}else{v[c>>2]=p;break}else{if(!(M<.6666666666666666))if(p=p+1|0,v[c>>2]=p,k<M*.5){v[c+4>>2]=h;break}else{h=h+1|0,v[c+4>>2]=h;break}if(k<1-M){if(v[c+4>>2]=h,M*2+-1<k){v[c>>2]=p;break}}else h=h+1|0,v[c+4>>2]=h;p=p+1|0,v[c>>2]=p}while(0);do if(V<0)if(h&1){ve=(h+1|0)/2|0,ve=Aa(p|0,((p|0)<0)<<31>>31|0,ve|0,((ve|0)<0)<<31>>31|0)|0,p=~~(+(p|0)-((+(ve>>>0)+4294967296*+(lt()|0))*2+1)),v[c>>2]=p;break}else{ve=(h|0)/2|0,ve=Aa(p|0,((p|0)<0)<<31>>31|0,ve|0,((ve|0)<0)<<31>>31|0)|0,p=~~(+(p|0)-(+(ve>>>0)+4294967296*+(lt()|0))*2),v[c>>2]=p;break}while(0);ve=c+4|0,te<0&&(p=p-((h<<1|1|0)/2|0)|0,v[c>>2]=p,h=0-h|0,v[ve>>2]=h),m=h-p|0,(p|0)<0?(E=0-p|0,v[ve>>2]=m,v[Ne>>2]=E,v[c>>2]=0,h=m,p=0):E=0,(h|0)<0&&(p=p-h|0,v[c>>2]=p,E=E-h|0,v[Ne>>2]=E,v[ve>>2]=0,h=0),S=p-E|0,m=h-E|0,(E|0)<0&&(v[c>>2]=S,v[ve>>2]=m,v[Ne>>2]=0,h=m,p=S,E=0),m=(h|0)<(p|0)?h:p,m=(E|0)<(m|0)?E:m,!((m|0)<=0)&&(v[c>>2]=p-m,v[ve>>2]=h-m,v[Ne>>2]=E-m)}function Mo(h){h=h|0;var c=0,p=0,m=0,E=0,S=0,M=0;c=v[h>>2]|0,M=h+4|0,p=v[M>>2]|0,(c|0)<0&&(p=p-c|0,v[M>>2]=p,S=h+8|0,v[S>>2]=(v[S>>2]|0)-c,v[h>>2]=0,c=0),(p|0)<0?(c=c-p|0,v[h>>2]=c,S=h+8|0,E=(v[S>>2]|0)-p|0,v[S>>2]=E,v[M>>2]=0,p=0):(E=h+8|0,S=E,E=v[E>>2]|0),(E|0)<0&&(c=c-E|0,v[h>>2]=c,p=p-E|0,v[M>>2]=p,v[S>>2]=0,E=0),m=(p|0)<(c|0)?p:c,m=(E|0)<(m|0)?E:m,!((m|0)<=0)&&(v[h>>2]=c-m,v[M>>2]=p-m,v[S>>2]=E-m)}function ol(h,c){h=h|0,c=c|0;var p=0,m=0;m=v[h+8>>2]|0,p=+((v[h+4>>2]|0)-m|0),Xe[c>>3]=+((v[h>>2]|0)-m|0)-p*.5,Xe[c+8>>3]=p*.8660254037844386}function ls(h,c,p){h=h|0,c=c|0,p=p|0,v[p>>2]=(v[c>>2]|0)+(v[h>>2]|0),v[p+4>>2]=(v[c+4>>2]|0)+(v[h+4>>2]|0),v[p+8>>2]=(v[c+8>>2]|0)+(v[h+8>>2]|0)}function ic(h,c,p){h=h|0,c=c|0,p=p|0,v[p>>2]=(v[h>>2]|0)-(v[c>>2]|0),v[p+4>>2]=(v[h+4>>2]|0)-(v[c+4>>2]|0),v[p+8>>2]=(v[h+8>>2]|0)-(v[c+8>>2]|0)}function Sc(h,c){h=h|0,c=c|0;var p=0,m=0;p=wi(v[h>>2]|0,c)|0,v[h>>2]=p,p=h+4|0,m=wi(v[p>>2]|0,c)|0,v[p>>2]=m,h=h+8|0,c=wi(v[h>>2]|0,c)|0,v[h>>2]=c}function Zl(h){h=h|0;var c=0,p=0,m=0,E=0,S=0,M=0,k=0;M=v[h>>2]|0,k=(M|0)<0,m=(v[h+4>>2]|0)-(k?M:0)|0,S=(m|0)<0,E=(S?0-m|0:0)+((v[h+8>>2]|0)-(k?M:0))|0,p=(E|0)<0,h=p?0:E,c=(S?0:m)-(p?E:0)|0,E=(k?0:M)-(S?m:0)-(p?E:0)|0,p=(c|0)<(E|0)?c:E,p=(h|0)<(p|0)?h:p,m=(p|0)>0,h=h-(m?p:0)|0,c=c-(m?p:0)|0;e:do switch(E-(m?p:0)|0){case 0:switch(c|0){case 0:return k=h|0?(h|0)==1?1:7:0,k|0;case 1:return k=h|0?(h|0)==1?3:7:2,k|0;default:break e}case 1:switch(c|0){case 0:return k=h|0?(h|0)==1?5:7:4,k|0;case 1:{if(!h)h=6;else break e;return h|0}default:break e}default:}while(0);return k=7,k|0}function h0(h){h=h|0;var c=0,p=0,m=0,E=0,S=0,M=0,k=0;M=h+8|0,E=v[M>>2]|0,S=(v[h>>2]|0)-E|0,k=h+4|0,E=(v[k>>2]|0)-E|0;do if(S>>>0>715827881|E>>>0>715827881){if(p=(S|0)>0,p){if((2147483647-S|0)<(S|0)||(2147483647-(S<<1)|0)<(S|0))return k=1,k|0}else if((-2147483648-S|0)>(S|0)||(-2147483648-(S<<1)|0)>(S|0))return k=1,k|0;if(c=S*3|0,(E|0)>0){if((2147483647-E|0)<(E|0))return k=1,k|0}else if((-2147483648-E|0)>(E|0))return k=1,k|0;if(m=E<<1,(S|0)>-1){if((c|-2147483648|0)>=(E|0))return k=1,k|0}else if((c^-2147483648|0)<(E|0))return k=1,k|0;if(p){if((2147483647-S|0)<(m|0))c=1;else{p=m;break}return c|0}else{if((-2147483648-S|0)>(m|0))c=1;else{p=m;break}return c|0}}else p=E<<1,c=S*3|0;while(0);m=Fa(+(c-E|0)/7)|0,v[h>>2]=m,E=Fa(+(p+S|0)/7)|0,v[k>>2]=E,v[M>>2]=0,p=(E|0)<(m|0),c=p?m:E,p=p?E:m;do if((p|0)<0){if((c|0)>0){if((c|-2147483648|0)<(p|0)&((p|0)!=-2147483648&(2147483647-c|0)>=(p|0)))break;ni(23313,22444,355,22455)}if((p|0)==-2147483648|(-2147483648-c|0)>(p|0)&&ni(23313,22444,355,22455),(c|0)>-1){if((c|-2147483648|0)<(p|0))break;ni(23313,22444,355,22455)}else{if((c^-2147483648|0)>=(p|0))break;ni(23313,22444,355,22455)}}while(0);return c=E-m|0,(m|0)<0?(p=0-m|0,v[k>>2]=c,v[M>>2]=p,v[h>>2]=0,m=0):(c=E,p=0),(c|0)<0&&(m=m-c|0,v[h>>2]=m,p=p-c|0,v[M>>2]=p,v[k>>2]=0,c=0),S=m-p|0,E=c-p|0,(p|0)<0?(v[h>>2]=S,v[k>>2]=E,v[M>>2]=0,c=E,E=S,p=0):E=m,m=(c|0)<(E|0)?c:E,m=(p|0)<(m|0)?p:m,(m|0)<=0?(k=0,k|0):(v[h>>2]=E-m,v[k>>2]=c-m,v[M>>2]=p-m,k=0,k|0)}function jf(h){h=h|0;var c=0,p=0,m=0,E=0,S=0,M=0,k=0;M=h+8|0,E=v[M>>2]|0,S=(v[h>>2]|0)-E|0,k=h+4|0,E=(v[k>>2]|0)-E|0;do if(S>>>0>715827881|E>>>0>715827881){if(p=(S|0)>0,p){if((2147483647-S|0)<(S|0))return k=1,k|0}else if((-2147483648-S|0)>(S|0))return k=1,k|0;if(c=S<<1,(E|0)>0){if((2147483647-E|0)<(E|0)||(2147483647-(E<<1)|0)<(E|0))return k=1,k|0}else if((-2147483648-E|0)>(E|0)||(-2147483648-(E<<1)|0)>(E|0))return k=1,k|0;if(m=E*3|0,p){if((2147483647-c|0)<(E|0))return k=1,k|0}else if((-2147483648-c|0)>(E|0))return k=1,k|0;if((E|0)>-1){if((m|-2147483648|0)<(S|0)){p=m;break}else c=1;return c|0}else{if((m^-2147483648|0)<(S|0))c=1;else{p=m;break}return c|0}}else p=E*3|0,c=S<<1;while(0);m=Fa(+(c+E|0)/7)|0,v[h>>2]=m,E=Fa(+(p-S|0)/7)|0,v[k>>2]=E,v[M>>2]=0,p=(E|0)<(m|0),c=p?m:E,p=p?E:m;do if((p|0)<0){if((c|0)>0){if((c|-2147483648|0)<(p|0)&((p|0)!=-2147483648&(2147483647-c|0)>=(p|0)))break;ni(23313,22444,404,22469)}if((p|0)==-2147483648|(-2147483648-c|0)>(p|0)&&ni(23313,22444,404,22469),(c|0)>-1){if((c|-2147483648|0)<(p|0))break;ni(23313,22444,404,22469)}else{if((c^-2147483648|0)>=(p|0))break;ni(23313,22444,404,22469)}}while(0);return c=E-m|0,(m|0)<0?(p=0-m|0,v[k>>2]=c,v[M>>2]=p,v[h>>2]=0,m=0):(c=E,p=0),(c|0)<0&&(m=m-c|0,v[h>>2]=m,p=p-c|0,v[M>>2]=p,v[k>>2]=0,c=0),S=m-p|0,E=c-p|0,(p|0)<0?(v[h>>2]=S,v[k>>2]=E,v[M>>2]=0,c=E,E=S,p=0):E=m,m=(c|0)<(E|0)?c:E,m=(p|0)<(m|0)?p:m,(m|0)<=0?(k=0,k|0):(v[h>>2]=E-m,v[k>>2]=c-m,v[M>>2]=p-m,k=0,k|0)}function af(h){h=h|0;var c=0,p=0,m=0,E=0,S=0,M=0,k=0;M=h+8|0,p=v[M>>2]|0,c=(v[h>>2]|0)-p|0,k=h+4|0,p=(v[k>>2]|0)-p|0,m=Fa(+((c*3|0)-p|0)/7)|0,v[h>>2]=m,c=Fa(+((p<<1)+c|0)/7)|0,v[k>>2]=c,v[M>>2]=0,p=c-m|0,(m|0)<0?(S=0-m|0,v[k>>2]=p,v[M>>2]=S,v[h>>2]=0,c=p,m=0,p=S):p=0,(c|0)<0&&(m=m-c|0,v[h>>2]=m,p=p-c|0,v[M>>2]=p,v[k>>2]=0,c=0),S=m-p|0,E=c-p|0,(p|0)<0?(v[h>>2]=S,v[k>>2]=E,v[M>>2]=0,c=E,E=S,p=0):E=m,m=(c|0)<(E|0)?c:E,m=(p|0)<(m|0)?p:m,!((m|0)<=0)&&(v[h>>2]=E-m,v[k>>2]=c-m,v[M>>2]=p-m)}function Vf(h){h=h|0;var c=0,p=0,m=0,E=0,S=0,M=0,k=0;M=h+8|0,p=v[M>>2]|0,c=(v[h>>2]|0)-p|0,k=h+4|0,p=(v[k>>2]|0)-p|0,m=Fa(+((c<<1)+p|0)/7)|0,v[h>>2]=m,c=Fa(+((p*3|0)-c|0)/7)|0,v[k>>2]=c,v[M>>2]=0,p=c-m|0,(m|0)<0?(S=0-m|0,v[k>>2]=p,v[M>>2]=S,v[h>>2]=0,c=p,m=0,p=S):p=0,(c|0)<0&&(m=m-c|0,v[h>>2]=m,p=p-c|0,v[M>>2]=p,v[k>>2]=0,c=0),S=m-p|0,E=c-p|0,(p|0)<0?(v[h>>2]=S,v[k>>2]=E,v[M>>2]=0,c=E,E=S,p=0):E=m,m=(c|0)<(E|0)?c:E,m=(p|0)<(m|0)?p:m,!((m|0)<=0)&&(v[h>>2]=E-m,v[k>>2]=c-m,v[M>>2]=p-m)}function Cc(h){h=h|0;var c=0,p=0,m=0,E=0,S=0,M=0,k=0;c=v[h>>2]|0,M=h+4|0,p=v[M>>2]|0,k=h+8|0,m=v[k>>2]|0,E=p+(c*3|0)|0,v[h>>2]=E,p=m+(p*3|0)|0,v[M>>2]=p,c=(m*3|0)+c|0,v[k>>2]=c,m=p-E|0,(E|0)<0?(c=c-E|0,v[M>>2]=m,v[k>>2]=c,v[h>>2]=0,p=m,m=0):m=E,(p|0)<0&&(m=m-p|0,v[h>>2]=m,c=c-p|0,v[k>>2]=c,v[M>>2]=0,p=0),S=m-c|0,E=p-c|0,(c|0)<0?(v[h>>2]=S,v[M>>2]=E,v[k>>2]=0,m=S,c=0):E=p,p=(E|0)<(m|0)?E:m,p=(c|0)<(p|0)?c:p,!((p|0)<=0)&&(v[h>>2]=m-p,v[M>>2]=E-p,v[k>>2]=c-p)}function Tu(h){h=h|0;var c=0,p=0,m=0,E=0,S=0,M=0,k=0;E=v[h>>2]|0,M=h+4|0,c=v[M>>2]|0,k=h+8|0,p=v[k>>2]|0,m=(c*3|0)+E|0,E=p+(E*3|0)|0,v[h>>2]=E,v[M>>2]=m,c=(p*3|0)+c|0,v[k>>2]=c,p=m-E|0,(E|0)<0?(c=c-E|0,v[M>>2]=p,v[k>>2]=c,v[h>>2]=0,E=0):p=m,(p|0)<0&&(E=E-p|0,v[h>>2]=E,c=c-p|0,v[k>>2]=c,v[M>>2]=0,p=0),S=E-c|0,m=p-c|0,(c|0)<0?(v[h>>2]=S,v[M>>2]=m,v[k>>2]=0,E=S,c=0):m=p,p=(m|0)<(E|0)?m:E,p=(c|0)<(p|0)?c:p,!((p|0)<=0)&&(v[h>>2]=E-p,v[M>>2]=m-p,v[k>>2]=c-p)}function wc(h,c){h=h|0,c=c|0;var p=0,m=0,E=0,S=0,M=0,k=0;(c+-1|0)>>>0>=6||(E=(v[15440+(c*12|0)>>2]|0)+(v[h>>2]|0)|0,v[h>>2]=E,k=h+4|0,m=(v[15440+(c*12|0)+4>>2]|0)+(v[k>>2]|0)|0,v[k>>2]=m,M=h+8|0,c=(v[15440+(c*12|0)+8>>2]|0)+(v[M>>2]|0)|0,v[M>>2]=c,p=m-E|0,(E|0)<0?(c=c-E|0,v[k>>2]=p,v[M>>2]=c,v[h>>2]=0,m=0):(p=m,m=E),(p|0)<0&&(m=m-p|0,v[h>>2]=m,c=c-p|0,v[M>>2]=c,v[k>>2]=0,p=0),S=m-c|0,E=p-c|0,(c|0)<0?(v[h>>2]=S,v[k>>2]=E,v[M>>2]=0,m=S,c=0):E=p,p=(E|0)<(m|0)?E:m,p=(c|0)<(p|0)?c:p,!((p|0)<=0)&&(v[h>>2]=m-p,v[k>>2]=E-p,v[M>>2]=c-p))}function Gu(h){h=h|0;var c=0,p=0,m=0,E=0,S=0,M=0,k=0;E=v[h>>2]|0,M=h+4|0,c=v[M>>2]|0,k=h+8|0,p=v[k>>2]|0,m=c+E|0,E=p+E|0,v[h>>2]=E,v[M>>2]=m,c=p+c|0,v[k>>2]=c,p=m-E|0,(E|0)<0?(c=c-E|0,v[M>>2]=p,v[k>>2]=c,v[h>>2]=0,m=0):(p=m,m=E),(p|0)<0&&(m=m-p|0,v[h>>2]=m,c=c-p|0,v[k>>2]=c,v[M>>2]=0,p=0),S=m-c|0,E=p-c|0,(c|0)<0?(v[h>>2]=S,v[M>>2]=E,v[k>>2]=0,m=S,c=0):E=p,p=(E|0)<(m|0)?E:m,p=(c|0)<(p|0)?c:p,!((p|0)<=0)&&(v[h>>2]=m-p,v[M>>2]=E-p,v[k>>2]=c-p)}function sl(h){h=h|0;var c=0,p=0,m=0,E=0,S=0,M=0,k=0;c=v[h>>2]|0,M=h+4|0,m=v[M>>2]|0,k=h+8|0,p=v[k>>2]|0,E=m+c|0,v[h>>2]=E,m=p+m|0,v[M>>2]=m,c=p+c|0,v[k>>2]=c,p=m-E|0,(E|0)<0?(c=c-E|0,v[M>>2]=p,v[k>>2]=c,v[h>>2]=0,m=0):(p=m,m=E),(p|0)<0&&(m=m-p|0,v[h>>2]=m,c=c-p|0,v[k>>2]=c,v[M>>2]=0,p=0),S=m-c|0,E=p-c|0,(c|0)<0?(v[h>>2]=S,v[M>>2]=E,v[k>>2]=0,m=S,c=0):E=p,p=(E|0)<(m|0)?E:m,p=(c|0)<(p|0)?c:p,!((p|0)<=0)&&(v[h>>2]=m-p,v[M>>2]=E-p,v[k>>2]=c-p)}function Tc(h){switch(h=h|0,h|0){case 1:{h=5;break}case 5:{h=4;break}case 4:{h=6;break}case 6:{h=2;break}case 2:{h=3;break}case 3:{h=1;break}default:}return h|0}function Sl(h){switch(h=h|0,h|0){case 1:{h=3;break}case 3:{h=2;break}case 2:{h=6;break}case 6:{h=4;break}case 4:{h=5;break}case 5:{h=1;break}default:}return h|0}function A0(h){h=h|0;var c=0,p=0,m=0,E=0,S=0,M=0,k=0;c=v[h>>2]|0,M=h+4|0,p=v[M>>2]|0,k=h+8|0,m=v[k>>2]|0,E=p+(c<<1)|0,v[h>>2]=E,p=m+(p<<1)|0,v[M>>2]=p,c=(m<<1)+c|0,v[k>>2]=c,m=p-E|0,(E|0)<0?(c=c-E|0,v[M>>2]=m,v[k>>2]=c,v[h>>2]=0,p=m,m=0):m=E,(p|0)<0&&(m=m-p|0,v[h>>2]=m,c=c-p|0,v[k>>2]=c,v[M>>2]=0,p=0),S=m-c|0,E=p-c|0,(c|0)<0?(v[h>>2]=S,v[M>>2]=E,v[k>>2]=0,m=S,c=0):E=p,p=(E|0)<(m|0)?E:m,p=(c|0)<(p|0)?c:p,!((p|0)<=0)&&(v[h>>2]=m-p,v[M>>2]=E-p,v[k>>2]=c-p)}function G0(h){h=h|0;var c=0,p=0,m=0,E=0,S=0,M=0,k=0;E=v[h>>2]|0,M=h+4|0,c=v[M>>2]|0,k=h+8|0,p=v[k>>2]|0,m=(c<<1)+E|0,E=p+(E<<1)|0,v[h>>2]=E,v[M>>2]=m,c=(p<<1)+c|0,v[k>>2]=c,p=m-E|0,(E|0)<0?(c=c-E|0,v[M>>2]=p,v[k>>2]=c,v[h>>2]=0,E=0):p=m,(p|0)<0&&(E=E-p|0,v[h>>2]=E,c=c-p|0,v[k>>2]=c,v[M>>2]=0,p=0),S=E-c|0,m=p-c|0,(c|0)<0?(v[h>>2]=S,v[M>>2]=m,v[k>>2]=0,E=S,c=0):m=p,p=(m|0)<(E|0)?m:E,p=(c|0)<(p|0)?c:p,!((p|0)<=0)&&(v[h>>2]=E-p,v[M>>2]=m-p,v[k>>2]=c-p)}function ac(h,c){h=h|0,c=c|0;var p=0,m=0,E=0,S=0,M=0,k=0;return M=(v[h>>2]|0)-(v[c>>2]|0)|0,k=(M|0)<0,m=(v[h+4>>2]|0)-(v[c+4>>2]|0)-(k?M:0)|0,S=(m|0)<0,E=(k?0-M|0:0)+(v[h+8>>2]|0)-(v[c+8>>2]|0)+(S?0-m|0:0)|0,h=(E|0)<0,c=h?0:E,p=(S?0:m)-(h?E:0)|0,E=(k?0:M)-(S?m:0)-(h?E:0)|0,h=(p|0)<(E|0)?p:E,h=(c|0)<(h|0)?c:h,m=(h|0)>0,c=c-(m?h:0)|0,p=p-(m?h:0)|0,h=E-(m?h:0)|0,h=(h|0)>-1?h:0-h|0,p=(p|0)>-1?p:0-p|0,c=(c|0)>-1?c:0-c|0,c=(p|0)>(c|0)?p:c,((h|0)>(c|0)?h:c)|0}function bh(h,c){h=h|0,c=c|0;var p=0;p=v[h+8>>2]|0,v[c>>2]=(v[h>>2]|0)-p,v[c+4>>2]=(v[h+4>>2]|0)-p}function Sh(h,c){h=h|0,c=c|0;var p=0,m=0,E=0,S=0,M=0,k=0;m=v[h>>2]|0,v[c>>2]=m,E=v[h+4>>2]|0,M=c+4|0,v[M>>2]=E,k=c+8|0,v[k>>2]=0,p=(E|0)<(m|0),h=p?m:E,p=p?E:m;do if((p|0)<0){if((h|0)>0){if((h|-2147483648|0)<(p|0)&((p|0)!=-2147483648&(2147483647-h|0)>=(p|0)))break;return h=1,h|0}if((p|0)==-2147483648|(-2147483648-h|0)>(p|0))return c=1,c|0;if((h|0)>-1){if((h|-2147483648|0)<(p|0))break;return h=1,h|0}else{if((h^-2147483648|0)<(p|0))h=1;else break;return h|0}}while(0);return h=E-m|0,(m|0)<0?(p=0-m|0,v[M>>2]=h,v[k>>2]=p,v[c>>2]=0,m=0):(h=E,p=0),(h|0)<0&&(m=m-h|0,v[c>>2]=m,p=p-h|0,v[k>>2]=p,v[M>>2]=0,h=0),S=m-p|0,E=h-p|0,(p|0)<0?(v[c>>2]=S,v[M>>2]=E,v[k>>2]=0,h=E,E=S,p=0):E=m,m=(h|0)<(E|0)?h:E,m=(p|0)<(m|0)?p:m,(m|0)<=0?(c=0,c|0):(v[c>>2]=E-m,v[M>>2]=h-m,v[k>>2]=p-m,c=0,c|0)}function j0(h){h=h|0;var c=0,p=0,m=0,E=0;c=h+8|0,E=v[c>>2]|0,p=E-(v[h>>2]|0)|0,v[h>>2]=p,m=h+4|0,h=(v[m>>2]|0)-E|0,v[m>>2]=h,v[c>>2]=0-(h+p)}function p0(h){h=h|0;var c=0,p=0,m=0,E=0,S=0,M=0,k=0;p=v[h>>2]|0,c=0-p|0,v[h>>2]=c,M=h+8|0,v[M>>2]=0,k=h+4|0,m=v[k>>2]|0,E=m+p|0,(p|0)>0?(v[k>>2]=E,v[M>>2]=p,v[h>>2]=0,c=0,m=E):p=0,(m|0)<0?(S=c-m|0,v[h>>2]=S,p=p-m|0,v[M>>2]=p,v[k>>2]=0,E=S-p|0,c=0-p|0,(p|0)<0?(v[h>>2]=E,v[k>>2]=c,v[M>>2]=0,m=c,p=0):(m=0,E=S)):E=c,c=(m|0)<(E|0)?m:E,c=(p|0)<(c|0)?p:c,!((c|0)<=0)&&(v[h>>2]=E-c,v[k>>2]=m-c,v[M>>2]=p-c)}function d0(h,c,p,m,E){h=h|0,c=c|0,p=p|0,m=m|0,E=E|0;var S=0,M=0,k=0,V=0,te=0,ve=0,Ne=0;if(Ne=et,et=et+64|0,ve=Ne,k=Ne+56|0,!(!0&(c&2013265920|0)==134217728&(!0&(m&2013265920|0)==134217728)))return E=5,et=Ne,E|0;if((h|0)==(p|0)&(c|0)==(m|0))return v[E>>2]=0,E=0,et=Ne,E|0;if(M=ft(h|0,c|0,52)|0,lt()|0,M=M&15,te=ft(p|0,m|0,52)|0,lt()|0,(M|0)!=(te&15|0))return E=12,et=Ne,E|0;if(S=M+-1|0,M>>>0>1){Gl(h,c,S,ve)|0,Gl(p,m,S,k)|0,te=ve,V=v[te>>2]|0,te=v[te+4>>2]|0;e:do if((V|0)==(v[k>>2]|0)&&(te|0)==(v[k+4>>2]|0)){M=(M^15)*3|0,S=ft(h|0,c|0,M|0)|0,lt()|0,S=S&7,M=ft(p|0,m|0,M|0)|0,lt()|0,M=M&7;do if((S|0)==0|(M|0)==0)v[E>>2]=1,S=0;else if((S|0)==7)S=5;else{if((S|0)==1|(M|0)==1&&ha(V,te)|0){S=5;break}if((v[15536+(S<<2)>>2]|0)!=(M|0)&&(v[15568+(S<<2)>>2]|0)!=(M|0))break e;v[E>>2]=1,S=0}while(0);return E=S,et=Ne,E|0}while(0)}S=ve,M=S+56|0;do v[S>>2]=0,S=S+4|0;while((S|0)<(M|0));return xf(h,c,1,ve)|0,c=ve,!((v[c>>2]|0)==(p|0)&&(v[c+4>>2]|0)==(m|0))&&(c=ve+8|0,!((v[c>>2]|0)==(p|0)&&(v[c+4>>2]|0)==(m|0)))&&(c=ve+16|0,!((v[c>>2]|0)==(p|0)&&(v[c+4>>2]|0)==(m|0)))&&(c=ve+24|0,!((v[c>>2]|0)==(p|0)&&(v[c+4>>2]|0)==(m|0)))&&(c=ve+32|0,!((v[c>>2]|0)==(p|0)&&(v[c+4>>2]|0)==(m|0)))&&(c=ve+40|0,!((v[c>>2]|0)==(p|0)&&(v[c+4>>2]|0)==(m|0)))?(S=ve+48|0,S=((v[S>>2]|0)==(p|0)?(v[S+4>>2]|0)==(m|0):0)&1):S=1,v[E>>2]=S,E=0,et=Ne,E|0}function Ch(h,c,p,m,E){return h=h|0,c=c|0,p=p|0,m=m|0,E=E|0,p=Ff(h,c,p,m)|0,(p|0)==7?(E=11,E|0):(m=xt(p|0,0,56)|0,c=c&-2130706433|(lt()|0)|268435456,v[E>>2]=h|m,v[E+4>>2]=c,E=0,E|0)}function mA(h,c,p){return h=h|0,c=c|0,p=p|0,!0&(c&2013265920|0)==268435456?(v[p>>2]=h,v[p+4>>2]=c&-2130706433|134217728,p=0,p|0):(p=6,p|0)}function V0(h,c,p){h=h|0,c=c|0,p=p|0;var m=0,E=0,S=0;return E=et,et=et+16|0,m=E,v[m>>2]=0,!0&(c&2013265920|0)==268435456?(S=ft(h|0,c|0,56)|0,lt()|0,m=Uo(h,c&-2130706433|134217728,S&7,m,p)|0,et=E,m|0):(m=6,et=E,m|0)}function wh(h,c){h=h|0,c=c|0;var p=0;switch(p=ft(h|0,c|0,56)|0,lt()|0,p&7){case 0:case 7:return p=0,p|0;default:}return p=c&-2130706433|134217728,!(!0&(c&2013265920|0)==268435456)||!0&(c&117440512|0)==16777216&(ha(h,p)|0)!=0?(p=0,p|0):(p=of(h,p)|0,p|0)}function oc(h,c,p){h=h|0,c=c|0,p=p|0;var m=0,E=0,S=0,M=0;return E=et,et=et+16|0,m=E,!0&(c&2013265920|0)==268435456?(S=c&-2130706433|134217728,M=p,v[M>>2]=h,v[M+4>>2]=S,v[m>>2]=0,c=ft(h|0,c|0,56)|0,lt()|0,m=Uo(h,S,c&7,m,p+8|0)|0,et=E,m|0):(m=6,et=E,m|0)}function H0(h,c,p){h=h|0,c=c|0,p=p|0;var m=0,E=0;return E=(ha(h,c)|0)==0,c=c&-2130706433,m=p,v[m>>2]=E?h:0,v[m+4>>2]=E?c|285212672:0,m=p+8|0,v[m>>2]=h,v[m+4>>2]=c|301989888,m=p+16|0,v[m>>2]=h,v[m+4>>2]=c|318767104,m=p+24|0,v[m>>2]=h,v[m+4>>2]=c|335544320,m=p+32|0,v[m>>2]=h,v[m+4>>2]=c|352321536,p=p+40|0,v[p>>2]=h,v[p+4>>2]=c|369098752,0}function bf(h,c,p){h=h|0,c=c|0,p=p|0;var m=0,E=0,S=0,M=0;return M=et,et=et+16|0,E=M,S=c&-2130706433|134217728,!0&(c&2013265920|0)==268435456?(m=ft(h|0,c|0,56)|0,lt()|0,m=vr(h,S,m&7)|0,(m|0)==-1?(v[p>>2]=0,S=6,et=M,S|0):(Wl(h,S,E)|0&&ni(23313,22484,282,22499),c=ft(h|0,c|0,52)|0,lt()|0,c=c&15,ha(h,S)|0?Sf(E,c,m,2,p):sc(E,c,m,2,p),S=0,et=M,S|0)):(S=6,et=M,S|0)}function yA(h,c,p){h=h|0,c=c|0,p=p|0;var m=0,E=0;m=et,et=et+16|0,E=m,_A(h,c,p,E),Ef(E,p+4|0),et=m}function _A(h,c,p,m){h=h|0,c=c|0,p=p|0,m=m|0;var E=0,S=0,M=0,k=0,V=0;if(k=et,et=et+16|0,V=k,$0(h,p,V),S=+Wn(+(1-+Xe[V>>3]*.5)),S<1e-16){v[m>>2]=0,v[m+4>>2]=0,v[m+8>>2]=0,v[m+12>>2]=0,et=k;return}if(V=v[p>>2]|0,E=+Xe[15920+(V*24|0)>>3],E=+Ia(E-+Ia(+W0(15600+(V<<4)|0,h))),au(c)|0?M=+Ia(E+-.3334731722518321):M=E,E=+hn(+S)/.381966011250105,(c|0)>0){h=0;do E=E*2.6457513110645907,h=h+1|0;while((h|0)!=(c|0))}S=+Ea(+M)*E,Xe[m>>3]=S,M=+Vr(+M)*E,Xe[m+8>>3]=M,et=k}function $0(h,c,p){h=h|0,c=c|0,p=p|0;var m=0,E=0,S=0;if(S=et,et=et+32|0,E=S,Fr(h,E),v[c>>2]=0,Xe[p>>3]=5,m=+Ir(16400,E),m<+Xe[p>>3]&&(v[c>>2]=0,Xe[p>>3]=m),m=+Ir(16424,E),m<+Xe[p>>3]&&(v[c>>2]=1,Xe[p>>3]=m),m=+Ir(16448,E),m<+Xe[p>>3]&&(v[c>>2]=2,Xe[p>>3]=m),m=+Ir(16472,E),m<+Xe[p>>3]&&(v[c>>2]=3,Xe[p>>3]=m),m=+Ir(16496,E),m<+Xe[p>>3]&&(v[c>>2]=4,Xe[p>>3]=m),m=+Ir(16520,E),m<+Xe[p>>3]&&(v[c>>2]=5,Xe[p>>3]=m),m=+Ir(16544,E),m<+Xe[p>>3]&&(v[c>>2]=6,Xe[p>>3]=m),m=+Ir(16568,E),m<+Xe[p>>3]&&(v[c>>2]=7,Xe[p>>3]=m),m=+Ir(16592,E),m<+Xe[p>>3]&&(v[c>>2]=8,Xe[p>>3]=m),m=+Ir(16616,E),m<+Xe[p>>3]&&(v[c>>2]=9,Xe[p>>3]=m),m=+Ir(16640,E),m<+Xe[p>>3]&&(v[c>>2]=10,Xe[p>>3]=m),m=+Ir(16664,E),m<+Xe[p>>3]&&(v[c>>2]=11,Xe[p>>3]=m),m=+Ir(16688,E),m<+Xe[p>>3]&&(v[c>>2]=12,Xe[p>>3]=m),m=+Ir(16712,E),m<+Xe[p>>3]&&(v[c>>2]=13,Xe[p>>3]=m),m=+Ir(16736,E),m<+Xe[p>>3]&&(v[c>>2]=14,Xe[p>>3]=m),m=+Ir(16760,E),m<+Xe[p>>3]&&(v[c>>2]=15,Xe[p>>3]=m),m=+Ir(16784,E),m<+Xe[p>>3]&&(v[c>>2]=16,Xe[p>>3]=m),m=+Ir(16808,E),m<+Xe[p>>3]&&(v[c>>2]=17,Xe[p>>3]=m),m=+Ir(16832,E),m<+Xe[p>>3]&&(v[c>>2]=18,Xe[p>>3]=m),m=+Ir(16856,E),!(m<+Xe[p>>3])){et=S;return}v[c>>2]=19,Xe[p>>3]=m,et=S}function Mc(h,c,p,m,E){h=h|0,c=c|0,p=p|0,m=m|0,E=E|0;var S=0,M=0;if(S=+Yr(h),S<1e-16){c=15600+(c<<4)|0,v[E>>2]=v[c>>2],v[E+4>>2]=v[c+4>>2],v[E+8>>2]=v[c+8>>2],v[E+12>>2]=v[c+12>>2];return}if(M=+Pn(+ +Xe[h+8>>3],+ +Xe[h>>3]),(p|0)>0){h=0;do S=S/2.6457513110645907,h=h+1|0;while((h|0)!=(p|0))}m?(S=S/3,p=(au(p)|0)==0,S=+Kn(+((p?S:S/2.6457513110645907)*.381966011250105))):(S=+Kn(+(S*.381966011250105)),au(p)|0&&(M=+Ia(M+.3334731722518321))),Dc(15600+(c<<4)|0,+Ia(+Xe[15920+(c*24|0)>>3]-M),S,E)}function Ic(h,c,p){h=h|0,c=c|0,p=p|0;var m=0,E=0;m=et,et=et+16|0,E=m,ol(h+4|0,E),Mc(E,v[h>>2]|0,c,0,p),et=m}function Sf(h,c,p,m,E){h=h|0,c=c|0,p=p|0,m=m|0,E=E|0;var S=0,M=0,k=0,V=0,te=0,ve=0,Ne=0,ut=0,gt=0,rt=0,_t=0,$t=0,qt=0,Yt=0,rr=0,Wt=0,rn=0,En=0,Kr=0,pn=0,La=0,oa=0,pa=0,Vi=0,ui=0,ki=0,Ya=0,Qn=0;if(ki=et,et=et+272|0,S=ki+256|0,Yt=ki+240|0,pa=ki,Vi=ki+224|0,ui=ki+208|0,rr=ki+176|0,Wt=ki+160|0,rn=ki+192|0,En=ki+144|0,Kr=ki+128|0,pn=ki+112|0,La=ki+96|0,oa=ki+80|0,v[S>>2]=c,v[Yt>>2]=v[h>>2],v[Yt+4>>2]=v[h+4>>2],v[Yt+8>>2]=v[h+8>>2],v[Yt+12>>2]=v[h+12>>2],Eo(Yt,S,pa),v[E>>2]=0,Yt=m+p+((m|0)==5&1)|0,(Yt|0)<=(p|0)){et=ki;return}V=v[S>>2]|0,te=Vi+4|0,ve=rr+4|0,Ne=p+5|0,ut=16880+(V<<2)|0,gt=16960+(V<<2)|0,rt=Kr+8|0,_t=pn+8|0,$t=La+8|0,qt=ui+4|0,k=p;e:for(;;){M=pa+(((k|0)%5|0)<<4)|0,v[ui>>2]=v[M>>2],v[ui+4>>2]=v[M+4>>2],v[ui+8>>2]=v[M+8>>2],v[ui+12>>2]=v[M+12>>2];do;while((Ys(ui,V,0,1)|0)==2);if((k|0)>(p|0)&(au(c)|0)!=0){if(v[rr>>2]=v[ui>>2],v[rr+4>>2]=v[ui+4>>2],v[rr+8>>2]=v[ui+8>>2],v[rr+12>>2]=v[ui+12>>2],ol(te,Wt),m=v[rr>>2]|0,S=v[17040+(m*80|0)+(v[Vi>>2]<<2)>>2]|0,v[rr>>2]=v[18640+(m*80|0)+(S*20|0)>>2],M=v[18640+(m*80|0)+(S*20|0)+16>>2]|0,(M|0)>0){h=0;do Gu(ve),h=h+1|0;while((h|0)<(M|0))}switch(M=18640+(m*80|0)+(S*20|0)+4|0,v[rn>>2]=v[M>>2],v[rn+4>>2]=v[M+4>>2],v[rn+8>>2]=v[M+8>>2],Sc(rn,(v[ut>>2]|0)*3|0),ls(ve,rn,ve),Mo(ve),ol(ve,En),Ya=+(v[gt>>2]|0),Xe[Kr>>3]=Ya*3,Xe[rt>>3]=0,Qn=Ya*-1.5,Xe[pn>>3]=Qn,Xe[_t>>3]=Ya*2.598076211353316,Xe[La>>3]=Qn,Xe[$t>>3]=Ya*-2.598076211353316,v[17040+((v[rr>>2]|0)*80|0)+(v[ui>>2]<<2)>>2]|0){case 1:{h=pn,m=Kr;break}case 3:{h=La,m=pn;break}case 2:{h=Kr,m=La;break}default:{h=12;break e}}Cn(Wt,En,m,h,oa),Mc(oa,v[rr>>2]|0,V,1,E+8+(v[E>>2]<<4)|0),v[E>>2]=(v[E>>2]|0)+1}if((k|0)<(Ne|0)&&(ol(qt,rr),Mc(rr,v[ui>>2]|0,V,1,E+8+(v[E>>2]<<4)|0),v[E>>2]=(v[E>>2]|0)+1),v[Vi>>2]=v[ui>>2],v[Vi+4>>2]=v[ui+4>>2],v[Vi+8>>2]=v[ui+8>>2],v[Vi+12>>2]=v[ui+12>>2],k=k+1|0,(k|0)>=(Yt|0)){h=3;break}}if((h|0)==3){et=ki;return}else(h|0)==12&&ni(22522,22569,571,22579)}function Eo(h,c,p){h=h|0,c=c|0,p=p|0;var m=0,E=0,S=0,M=0,k=0,V=0;V=et,et=et+128|0,m=V+64|0,E=V,S=m,M=20240,k=S+60|0;do v[S>>2]=v[M>>2],S=S+4|0,M=M+4|0;while((S|0)<(k|0));S=E,M=20304,k=S+60|0;do v[S>>2]=v[M>>2],S=S+4|0,M=M+4|0;while((S|0)<(k|0));k=(au(v[c>>2]|0)|0)==0,m=k?m:E,E=h+4|0,A0(E),G0(E),au(v[c>>2]|0)|0&&(Tu(E),v[c>>2]=(v[c>>2]|0)+1),v[p>>2]=v[h>>2],c=p+4|0,ls(E,m,c),Mo(c),v[p+16>>2]=v[h>>2],c=p+20|0,ls(E,m+12|0,c),Mo(c),v[p+32>>2]=v[h>>2],c=p+36|0,ls(E,m+24|0,c),Mo(c),v[p+48>>2]=v[h>>2],c=p+52|0,ls(E,m+36|0,c),Mo(c),v[p+64>>2]=v[h>>2],p=p+68|0,ls(E,m+48|0,p),Mo(p),et=V}function Ys(h,c,p,m){h=h|0,c=c|0,p=p|0,m=m|0;var E=0,S=0,M=0,k=0,V=0,te=0,ve=0,Ne=0,ut=0,gt=0,rt=0;if(rt=et,et=et+32|0,ut=rt+12|0,k=rt,gt=h+4|0,Ne=v[16960+(c<<2)>>2]|0,ve=(m|0)!=0,Ne=ve?Ne*3|0:Ne,E=v[gt>>2]|0,te=h+8|0,M=v[te>>2]|0,ve){if(S=h+12|0,m=v[S>>2]|0,E=M+E+m|0,(E|0)==(Ne|0))return gt=1,et=rt,gt|0;V=S}else V=h+12|0,m=v[V>>2]|0,E=M+E+m|0;if((E|0)<=(Ne|0))return gt=0,et=rt,gt|0;do if((m|0)>0){if(m=v[h>>2]|0,(M|0)>0){S=18640+(m*80|0)+60|0,m=h;break}m=18640+(m*80|0)+40|0,p?(Bl(ut,Ne,0,0),ic(gt,ut,k),sl(k),ls(k,ut,gt),S=m,m=h):(S=m,m=h)}else S=18640+((v[h>>2]|0)*80|0)+20|0,m=h;while(0);if(v[m>>2]=v[S>>2],E=S+16|0,(v[E>>2]|0)>0){m=0;do Gu(gt),m=m+1|0;while((m|0)<(v[E>>2]|0))}return h=S+4|0,v[ut>>2]=v[h>>2],v[ut+4>>2]=v[h+4>>2],v[ut+8>>2]=v[h+8>>2],c=v[16880+(c<<2)>>2]|0,Sc(ut,ve?c*3|0:c),ls(gt,ut,gt),Mo(gt),ve?m=((v[te>>2]|0)+(v[gt>>2]|0)+(v[V>>2]|0)|0)==(Ne|0)?1:2:m=2,gt=m,et=rt,gt|0}function zl(h,c){h=h|0,c=c|0;var p=0;do p=Ys(h,c,0,1)|0;while((p|0)==2);return p|0}function sc(h,c,p,m,E){h=h|0,c=c|0,p=p|0,m=m|0,E=E|0;var S=0,M=0,k=0,V=0,te=0,ve=0,Ne=0,ut=0,gt=0,rt=0,_t=0,$t=0,qt=0,Yt=0,rr=0,Wt=0,rn=0,En=0,Kr=0,pn=0,La=0,oa=0,pa=0;if(La=et,et=et+240|0,S=La+224|0,rn=La+208|0,En=La,Kr=La+192|0,pn=La+176|0,$t=La+160|0,qt=La+144|0,Yt=La+128|0,rr=La+112|0,Wt=La+96|0,v[S>>2]=c,v[rn>>2]=v[h>>2],v[rn+4>>2]=v[h+4>>2],v[rn+8>>2]=v[h+8>>2],v[rn+12>>2]=v[h+12>>2],ul(rn,S,En),v[E>>2]=0,_t=m+p+((m|0)==6&1)|0,(_t|0)<=(p|0)){et=La;return}V=v[S>>2]|0,te=p+6|0,ve=16960+(V<<2)|0,Ne=qt+8|0,ut=Yt+8|0,gt=rr+8|0,rt=Kr+4|0,M=0,k=p,m=-1;e:for(;;){if(S=(k|0)%6|0,h=En+(S<<4)|0,v[Kr>>2]=v[h>>2],v[Kr+4>>2]=v[h+4>>2],v[Kr+8>>2]=v[h+8>>2],v[Kr+12>>2]=v[h+12>>2],h=M,M=Ys(Kr,V,0,1)|0,(k|0)>(p|0)&(au(c)|0)!=0&&(h|0)!=1&&(v[Kr>>2]|0)!=(m|0)){switch(ol(En+(((S+5|0)%6|0)<<4)+4|0,pn),ol(En+(S<<4)+4|0,$t),oa=+(v[ve>>2]|0),Xe[qt>>3]=oa*3,Xe[Ne>>3]=0,pa=oa*-1.5,Xe[Yt>>3]=pa,Xe[ut>>3]=oa*2.598076211353316,Xe[rr>>3]=pa,Xe[gt>>3]=oa*-2.598076211353316,S=v[rn>>2]|0,v[17040+(S*80|0)+(((m|0)==(S|0)?v[Kr>>2]|0:m)<<2)>>2]|0){case 1:{h=Yt,m=qt;break}case 3:{h=rr,m=Yt;break}case 2:{h=qt,m=rr;break}default:{h=8;break e}}Cn(pn,$t,m,h,Wt),!(Xn(pn,Wt)|0)&&!(Xn($t,Wt)|0)&&(Mc(Wt,v[rn>>2]|0,V,1,E+8+(v[E>>2]<<4)|0),v[E>>2]=(v[E>>2]|0)+1)}if((k|0)<(te|0)&&(ol(rt,pn),Mc(pn,v[Kr>>2]|0,V,1,E+8+(v[E>>2]<<4)|0),v[E>>2]=(v[E>>2]|0)+1),k=k+1|0,(k|0)>=(_t|0)){h=3;break}else m=v[Kr>>2]|0}if((h|0)==3){et=La;return}else(h|0)==8&&ni(22606,22569,736,22651)}function ul(h,c,p){h=h|0,c=c|0,p=p|0;var m=0,E=0,S=0,M=0,k=0,V=0;V=et,et=et+160|0,m=V+80|0,E=V,S=m,M=20368,k=S+72|0;do v[S>>2]=v[M>>2],S=S+4|0,M=M+4|0;while((S|0)<(k|0));S=E,M=20448,k=S+72|0;do v[S>>2]=v[M>>2],S=S+4|0,M=M+4|0;while((S|0)<(k|0));k=(au(v[c>>2]|0)|0)==0,m=k?m:E,E=h+4|0,A0(E),G0(E),au(v[c>>2]|0)|0&&(Tu(E),v[c>>2]=(v[c>>2]|0)+1),v[p>>2]=v[h>>2],c=p+4|0,ls(E,m,c),Mo(c),v[p+16>>2]=v[h>>2],c=p+20|0,ls(E,m+12|0,c),Mo(c),v[p+32>>2]=v[h>>2],c=p+36|0,ls(E,m+24|0,c),Mo(c),v[p+48>>2]=v[h>>2],c=p+52|0,ls(E,m+36|0,c),Mo(c),v[p+64>>2]=v[h>>2],c=p+68|0,ls(E,m+48|0,c),Mo(c),v[p+80>>2]=v[h>>2],p=p+84|0,ls(E,m+60|0,p),Mo(p),et=V}function Ul(h,c){return h=h|0,c=c|0,c=ft(h|0,c|0,52)|0,lt()|0,c&15|0}function Lc(h,c){return h=h|0,c=c|0,c=ft(h|0,c|0,45)|0,lt()|0,c&127|0}function of(h,c){h=h|0,c=c|0;var p=0,m=0,E=0,S=0,M=0,k=0;if(!(!0&(c&-16777216|0)==134217728)||(M=ft(h|0,c|0,45)|0,lt()|0,M=M&127,M>>>0>121))return c=0,c|0;p=ft(h|0,c|0,52)|0,lt()|0,p=p&15;do if(p|0){for(E=1,m=0;;){if(S=ft(h|0,c|0,(15-E|0)*3|0)|0,lt()|0,S=S&7,(S|0)!=0&(m^1))if((S|0)==1&(fa(M)|0)!=0){k=0,m=13;break}else m=1;if((S|0)==7){k=0,m=13;break}if(E>>>0<p>>>0)E=E+1|0;else{m=9;break}}if((m|0)==9){if((p|0)==15)k=1;else break;return k|0}else if((m|0)==13)return k|0}while(0);for(;;){if(k=ft(h|0,c|0,(14-p|0)*3|0)|0,lt()|0,!((k&7|0)==7&!0)){k=0,m=13;break}if(p>>>0<14)p=p+1|0;else{k=1,m=13;break}}return(m|0)==13?k|0:0}function Gl(h,c,p,m){h=h|0,c=c|0,p=p|0,m=m|0;var E=0,S=0;if(S=ft(h|0,c|0,52)|0,lt()|0,S=S&15,p>>>0>15)return m=4,m|0;if((S|0)<(p|0))return m=12,m|0;if((S|0)==(p|0))return v[m>>2]=h,v[m+4>>2]=c,m=0,m|0;if(E=xt(p|0,0,52)|0,E=E|h,h=lt()|0|c&-15728641,(S|0)>(p|0))do c=xt(7,0,(14-p|0)*3|0)|0,p=p+1|0,E=c|E,h=lt()|0|h;while((p|0)<(S|0));return v[m>>2]=E,v[m+4>>2]=h,m=0,m|0}function Cl(h,c,p,m){h=h|0,c=c|0,p=p|0,m=m|0;var E=0,S=0,M=0;if(S=ft(h|0,c|0,52)|0,lt()|0,S=S&15,!((p|0)<16&(S|0)<=(p|0)))return m=4,m|0;E=p-S|0,p=ft(h|0,c|0,45)|0,lt()|0;e:do if(!(fa(p&127)|0))p=Or(7,0,E,((E|0)<0)<<31>>31)|0,E=lt()|0;else{t:do if(S|0){for(p=1;M=xt(7,0,(15-p|0)*3|0)|0,!!((M&h|0)==0&((lt()|0)&c|0)==0);)if(p>>>0<S>>>0)p=p+1|0;else break t;p=Or(7,0,E,((E|0)<0)<<31>>31)|0,E=lt()|0;break e}while(0);p=Or(7,0,E,((E|0)<0)<<31>>31)|0,p=Ri(p|0,lt()|0,5,0)|0,p=un(p|0,lt()|0,-5,-1)|0,p=gi(p|0,lt()|0,6,0)|0,p=un(p|0,lt()|0,1,0)|0,E=lt()|0}while(0);return M=m,v[M>>2]=p,v[M+4>>2]=E,M=0,M|0}function ha(h,c){h=h|0,c=c|0;var p=0,m=0,E=0;if(E=ft(h|0,c|0,45)|0,lt()|0,!(fa(E&127)|0))return E=0,E|0;E=ft(h|0,c|0,52)|0,lt()|0,E=E&15;e:do if(!E)p=0;else for(m=1;;){if(p=ft(h|0,c|0,(15-m|0)*3|0)|0,lt()|0,p=p&7,p|0)break e;if(m>>>0<E>>>0)m=m+1|0;else{p=0;break}}while(0);return E=(p|0)==0&1,E|0}function Pc(h,c,p,m){h=h|0,c=c|0,p=p|0,m=m|0;var E=0,S=0,M=0,k=0;if(M=et,et=et+16|0,S=M,ys(S,h,c,p),c=S,h=v[c>>2]|0,c=v[c+4>>2]|0,(h|0)==0&(c|0)==0)return et=M,0;E=0,p=0;do k=m+(E<<3)|0,v[k>>2]=h,v[k+4>>2]=c,E=un(E|0,p|0,1,0)|0,p=lt()|0,ll(S),k=S,h=v[k>>2]|0,c=v[k+4>>2]|0;while(!((h|0)==0&(c|0)==0));return et=M,0}function jl(h,c,p,m){return h=h|0,c=c|0,p=p|0,m=m|0,(m|0)<(p|0)?(p=c,m=h,Bi(p|0),m|0):(p=xt(-1,-1,((m-p|0)*3|0)+3|0)|0,m=xt(~p|0,~(lt()|0)|0,(15-m|0)*3|0)|0,p=~(lt()|0)&c,m=~m&h,Bi(p|0),m|0)}function uc(h,c,p,m){h=h|0,c=c|0,p=p|0,m=m|0;var E=0;return E=ft(h|0,c|0,52)|0,lt()|0,E=E&15,(p|0)<16&(E|0)<=(p|0)?((E|0)<(p|0)&&(E=xt(-1,-1,((p+-1-E|0)*3|0)+3|0)|0,E=xt(~E|0,~(lt()|0)|0,(15-p|0)*3|0)|0,c=~(lt()|0)&c,h=~E&h),E=xt(p|0,0,52)|0,p=c&-15728641|(lt()|0),v[m>>2]=h|E,v[m+4>>2]=p,m=0,m|0):(m=4,m|0)}function Vl(h,c,p,m){h=h|0,c=c|0,p=p|0,m=m|0;var E=0,S=0,M=0,k=0,V=0,te=0,ve=0,Ne=0,ut=0,gt=0,rt=0,_t=0,$t=0,qt=0,Yt=0,rr=0,Wt=0,rn=0,En=0,Kr=0,pn=0;if((p|0)==0&(m|0)==0)return Kr=0,Kr|0;if(E=h,S=v[E>>2]|0,E=v[E+4>>2]|0,!0&(E&15728640|0)==0){if(!((m|0)>0|(m|0)==0&p>>>0>0)||(Kr=c,v[Kr>>2]=S,v[Kr+4>>2]=E,(p|0)==1&(m|0)==0))return Kr=0,Kr|0;E=1;do rn=h+(E<<3)|0,En=v[rn+4>>2]|0,Kr=c+(E<<3)|0,v[Kr>>2]=v[rn>>2],v[Kr+4>>2]=En,E=E+1|0;while(0<(m|0)|(m|0)==0&E>>>0<p>>>0);return E=0,E|0}if(Wt=p<<3,En=Ua(Wt)|0,!En)return Kr=13,Kr|0;if(We(En|0,h|0,Wt|0)|0,rn=ga(p,8)|0,!rn)return Tn(En),Kr=13,Kr|0;e:do if(p|0){t:for(;;){E=En,qt=v[E>>2]|0,E=v[E+4>>2]|0,Yt=ft(qt|0,E|0,52)|0,lt()|0,Yt=Yt&15,rr=Yt+-1|0,$t=(p|0)>0;r:do if((Yt|0)!=0&$t){if(gt=((p|0)<0)<<31>>31,rt=xt(rr|0,0,52)|0,_t=lt()|0,rr>>>0>15){if(!((qt|0)==0&(E|0)==0)){Kr=17;break t}for(S=0;;){if(S=S+1|0,(S|0)>=(p|0))break r;if(m=En+(S<<3)|0,_t=v[m>>2]|0,m=v[m+4>>2]|0,!((_t|0)==0&(m|0)==0)){E=m,Kr=17;break t}}}for(S=0,h=qt,m=E;;){if(!((h|0)==0&(m|0)==0)){if(!(!0&(m&117440512|0)==0)){Kr=22;break t}if(k=ft(h|0,m|0,52)|0,lt()|0,k=k&15,(k|0)<(rr|0)){E=12,Kr=28;break t}if((k|0)!=(rr|0)&&(h=h|rt,m=m&-15728641|_t,k>>>0>=Yt>>>0)){M=rr;do ut=xt(7,0,(14-M|0)*3|0)|0,M=M+1|0,h=ut|h,m=lt()|0|m;while(M>>>0<k>>>0)}if(M=es(h|0,m|0,p|0,gt|0)|0,lt()|0,te=rn+(M<<3)|0,k=te,V=v[k>>2]|0,k=v[k+4>>2]|0,(V|0)==0&(k|0)==0)M=te;else for(ut=0;;){if((ut|0)>(p|0)){Kr=32;break t}if((V|0)==(h|0)&(k&-117440513|0)==(m|0)){ve=ft(V|0,k|0,56)|0,lt()|0,ve=ve&7,Ne=ve+1|0,pn=ft(V|0,k|0,45)|0,lt()|0;n:do if(!(fa(pn&127)|0))k=7;else{if(V=ft(V|0,k|0,52)|0,lt()|0,V=V&15,!V){k=6;break}for(k=1;;){if(pn=xt(7,0,(15-k|0)*3|0)|0,!((pn&h|0)==0&((lt()|0)&m|0)==0)){k=7;break n}if(k>>>0<V>>>0)k=k+1|0;else{k=6;break}}}while(0);if((ve+2|0)>>>0>k>>>0){Kr=42;break t}pn=xt(Ne|0,0,56)|0,m=lt()|0|m&-117440513,Ne=te,v[Ne>>2]=0,v[Ne+4>>2]=0,h=pn|h}else M=(M+1|0)%(p|0)|0;if(te=rn+(M<<3)|0,k=te,V=v[k>>2]|0,k=v[k+4>>2]|0,(V|0)==0&(k|0)==0){M=te;break}else ut=ut+1|0}pn=M,v[pn>>2]=h,v[pn+4>>2]=m}if(S=S+1|0,(S|0)>=(p|0))break r;m=En+(S<<3)|0,h=v[m>>2]|0,m=v[m+4>>2]|0}}while(0);if((p+5|0)>>>0<11){Kr=85;break}if(_t=ga((p|0)/6|0,8)|0,!_t){Kr=49;break}r:do if($t){ut=0,Ne=0;do{if(k=rn+(ut<<3)|0,m=k,S=v[m>>2]|0,m=v[m+4>>2]|0,!((S|0)==0&(m|0)==0)){V=ft(S|0,m|0,56)|0,lt()|0,V=V&7,h=V+1|0,te=m&-117440513,pn=ft(S|0,m|0,45)|0,lt()|0;n:do if(fa(pn&127)|0){if(ve=ft(S|0,m|0,52)|0,lt()|0,ve=ve&15,ve|0)for(M=1;;){if(pn=xt(7,0,(15-M|0)*3|0)|0,!((S&pn|0)==0&(te&(lt()|0)|0)==0))break n;if(M>>>0<ve>>>0)M=M+1|0;else break}m=xt(h|0,0,56)|0,S=m|S,m=lt()|0|te,h=k,v[h>>2]=S,v[h+4>>2]=m,h=V+2|0}while(0);(h|0)==7&&(pn=_t+(Ne<<3)|0,v[pn>>2]=S,v[pn+4>>2]=m&-117440513,Ne=Ne+1|0)}ut=ut+1|0}while((ut|0)!=(p|0));if($t){if(ut=((p|0)<0)<<31>>31,gt=xt(rr|0,0,52)|0,rt=lt()|0,rr>>>0>15){if(!((qt|0)==0&(E|0)==0)){E=4,Kr=84;break t}for(E=0;;){if(E=E+1|0,(E|0)>=(p|0)){S=0,E=Ne;break r}if(pn=En+(E<<3)|0,!((v[pn>>2]|0)==0&(v[pn+4>>2]|0)==0)){E=4,Kr=84;break t}}}for(ve=0,S=0,te=qt;;){do if(!((te|0)==0&(E|0)==0)){if(k=ft(te|0,E|0,52)|0,lt()|0,k=k&15,(k|0)<(rr|0)){E=12,Kr=84;break t}do if((k|0)==(rr|0))m=te,k=E;else{if(m=te|gt,h=E&-15728641|rt,k>>>0<Yt>>>0){k=h;break}M=rr;do pn=xt(7,0,(14-M|0)*3|0)|0,M=M+1|0,m=pn|m,h=lt()|0|h;while(M>>>0<k>>>0);k=h}while(0);for(M=es(m|0,k|0,p|0,ut|0)|0,lt()|0,h=0;;){if((h|0)>(p|0)){Kr=77;break t}if(pn=rn+(M<<3)|0,V=v[pn+4>>2]|0,(V&-117440513|0)==(k|0)&&(v[pn>>2]|0)==(m|0)){Kr=79;break}if(M=(M+1|0)%(p|0)|0,pn=rn+(M<<3)|0,(v[pn>>2]|0)==(m|0)&&(v[pn+4>>2]|0)==(k|0))break;h=h+1|0}if((Kr|0)==79&&(Kr=0,!0&(V&117440512|0)==100663296))break;pn=c+(S<<3)|0,v[pn>>2]=te,v[pn+4>>2]=E,S=S+1|0}while(0);if(E=ve+1|0,(E|0)>=(p|0)){E=Ne;break r}pn=En+(E<<3)|0,ve=E,te=v[pn>>2]|0,E=v[pn+4>>2]|0}}else S=0,E=Ne}else S=0,E=0;while(0);if(St(rn|0,0,Wt|0)|0,We(En|0,_t|0,E<<3|0)|0,Tn(_t),E)c=c+(S<<3)|0,p=E;else break e}if((Kr|0)==17)!0&(E&117440512|0)==0?(E=4,Kr=28):Kr=22;else if((Kr|0)==32)ni(23313,22674,362,22684);else{if((Kr|0)==42)return Tn(En),Tn(rn),pn=10,pn|0;if((Kr|0)==49)return Tn(En),Tn(rn),pn=13,pn|0;if((Kr|0)==77)ni(23313,22674,462,22684);else{if((Kr|0)==84)return Tn(_t),Tn(En),Tn(rn),pn=E,pn|0;if((Kr|0)==85){We(c|0,En|0,p<<3|0)|0;break}}}if((Kr|0)==22)return Tn(En),Tn(rn),pn=5,pn|0;if((Kr|0)==28)return Tn(En),Tn(rn),pn=E,pn|0}while(0);return Tn(En),Tn(rn),pn=0,pn|0}function Hl(h,c,p,m,E,S,M){h=h|0,c=c|0,p=p|0,m=m|0,E=E|0,S=S|0,M=M|0;var k=0,V=0,te=0,ve=0,Ne=0,ut=0,gt=0,rt=0,_t=0;if(_t=et,et=et+16|0,rt=_t,!((p|0)>0|(p|0)==0&c>>>0>0))return rt=0,et=_t,rt|0;if((M|0)>=16)return rt=12,et=_t,rt|0;ut=0,gt=0,Ne=0,k=0;e:for(;;){if(te=h+(ut<<3)|0,V=v[te>>2]|0,te=v[te+4>>2]|0,ve=ft(V|0,te|0,52)|0,lt()|0,(ve&15|0)>(M|0)){k=12,V=11;break}if(ys(rt,V,te,M),ve=rt,te=v[ve>>2]|0,ve=v[ve+4>>2]|0,(te|0)==0&(ve|0)==0)V=Ne;else{V=Ne;do{if(!((k|0)<(S|0)|(k|0)==(S|0)&V>>>0<E>>>0)){V=10;break e}Ne=m+(V<<3)|0,v[Ne>>2]=te,v[Ne+4>>2]=ve,V=un(V|0,k|0,1,0)|0,k=lt()|0,ll(rt),Ne=rt,te=v[Ne>>2]|0,ve=v[Ne+4>>2]|0}while(!((te|0)==0&(ve|0)==0))}if(ut=un(ut|0,gt|0,1,0)|0,gt=lt()|0,(gt|0)<(p|0)|(gt|0)==(p|0)&ut>>>0<c>>>0)Ne=V;else{k=0,V=11;break}}return(V|0)==10?(rt=14,et=_t,rt|0):(V|0)==11?(et=_t,k|0):0}function v0(h,c,p,m,E){h=h|0,c=c|0,p=p|0,m=m|0,E=E|0;var S=0,M=0,k=0,V=0,te=0,ve=0,Ne=0,ut=0;ut=et,et=et+16|0,Ne=ut;e:do if((p|0)>0|(p|0)==0&c>>>0>0){for(te=0,M=0,S=0,ve=0;;){if(V=h+(te<<3)|0,k=v[V>>2]|0,V=v[V+4>>2]|0,!((k|0)==0&(V|0)==0)&&(V=(Cl(k,V,m,Ne)|0)==0,k=Ne,M=un(v[k>>2]|0,v[k+4>>2]|0,M|0,S|0)|0,S=lt()|0,!V)){S=12;break}if(te=un(te|0,ve|0,1,0)|0,ve=lt()|0,!((ve|0)<(p|0)|(ve|0)==(p|0)&te>>>0<c>>>0))break e}return et=ut,S|0}else M=0,S=0;while(0);return v[E>>2]=M,v[E+4>>2]=S,E=0,et=ut,E|0}function g0(h,c){return h=h|0,c=c|0,c=ft(h|0,c|0,52)|0,lt()|0,c&1|0}function Xs(h,c){h=h|0,c=c|0;var p=0,m=0,E=0;if(E=ft(h|0,c|0,52)|0,lt()|0,E=E&15,!E)return E=0,E|0;for(m=1;;){if(p=ft(h|0,c|0,(15-m|0)*3|0)|0,lt()|0,p=p&7,p|0){m=5;break}if(m>>>0<E>>>0)m=m+1|0;else{p=0,m=5;break}}return(m|0)==5?p|0:0}function Oc(h,c){h=h|0,c=c|0;var p=0,m=0,E=0,S=0,M=0,k=0,V=0;if(V=ft(h|0,c|0,52)|0,lt()|0,V=V&15,!V)return k=c,V=h,Bi(k|0),V|0;for(k=1,p=0;;){S=(15-k|0)*3|0,m=xt(7,0,S|0)|0,E=lt()|0,M=ft(h|0,c|0,S|0)|0,lt()|0,S=xt(Tc(M&7)|0,0,S|0)|0,M=lt()|0,h=S|h&~m,c=M|c&~E;e:do if(!p)if((S&m|0)==0&(M&E|0)==0)p=0;else if(m=ft(h|0,c|0,52)|0,lt()|0,m=m&15,!m)p=1;else{p=1;t:for(;;){switch(M=ft(h|0,c|0,(15-p|0)*3|0)|0,lt()|0,M&7){case 1:break t;case 0:break;default:{p=1;break e}}if(p>>>0<m>>>0)p=p+1|0;else{p=1;break e}}for(p=1;;)if(M=(15-p|0)*3|0,E=ft(h|0,c|0,M|0)|0,lt()|0,S=xt(7,0,M|0)|0,c=c&~(lt()|0),M=xt(Tc(E&7)|0,0,M|0)|0,h=h&~S|M,c=c|(lt()|0),p>>>0<m>>>0)p=p+1|0;else{p=1;break}}while(0);if(k>>>0<V>>>0)k=k+1|0;else break}return Bi(c|0),h|0}function wl(h,c){h=h|0,c=c|0;var p=0,m=0,E=0,S=0,M=0;if(m=ft(h|0,c|0,52)|0,lt()|0,m=m&15,!m)return p=c,m=h,Bi(p|0),m|0;for(p=1;S=(15-p|0)*3|0,M=ft(h|0,c|0,S|0)|0,lt()|0,E=xt(7,0,S|0)|0,c=c&~(lt()|0),S=xt(Tc(M&7)|0,0,S|0)|0,h=S|h&~E,c=lt()|0|c,p>>>0<m>>>0;)p=p+1|0;return Bi(c|0),h|0}function ju(h,c){h=h|0,c=c|0;var p=0,m=0,E=0,S=0,M=0,k=0,V=0;if(V=ft(h|0,c|0,52)|0,lt()|0,V=V&15,!V)return k=c,V=h,Bi(k|0),V|0;for(k=1,p=0;;){S=(15-k|0)*3|0,m=xt(7,0,S|0)|0,E=lt()|0,M=ft(h|0,c|0,S|0)|0,lt()|0,S=xt(Sl(M&7)|0,0,S|0)|0,M=lt()|0,h=S|h&~m,c=M|c&~E;e:do if(!p)if((S&m|0)==0&(M&E|0)==0)p=0;else if(m=ft(h|0,c|0,52)|0,lt()|0,m=m&15,!m)p=1;else{p=1;t:for(;;){switch(M=ft(h|0,c|0,(15-p|0)*3|0)|0,lt()|0,M&7){case 1:break t;case 0:break;default:{p=1;break e}}if(p>>>0<m>>>0)p=p+1|0;else{p=1;break e}}for(p=1;;)if(E=(15-p|0)*3|0,S=xt(7,0,E|0)|0,M=c&~(lt()|0),c=ft(h|0,c|0,E|0)|0,lt()|0,c=xt(Sl(c&7)|0,0,E|0)|0,h=h&~S|c,c=M|(lt()|0),p>>>0<m>>>0)p=p+1|0;else{p=1;break}}while(0);if(k>>>0<V>>>0)k=k+1|0;else break}return Bi(c|0),h|0}function Mu(h,c){h=h|0,c=c|0;var p=0,m=0,E=0,S=0,M=0;if(m=ft(h|0,c|0,52)|0,lt()|0,m=m&15,!m)return p=c,m=h,Bi(p|0),m|0;for(p=1;M=(15-p|0)*3|0,S=xt(7,0,M|0)|0,E=c&~(lt()|0),c=ft(h|0,c|0,M|0)|0,lt()|0,c=xt(Sl(c&7)|0,0,M|0)|0,h=c|h&~S,c=lt()|0|E,p>>>0<m>>>0;)p=p+1|0;return Bi(c|0),h|0}function Hf(h,c){h=h|0,c=c|0;var p=0,m=0,E=0,S=0,M=0,k=0,V=0,te=0,ve=0;if(V=et,et=et+64|0,k=V+40|0,m=V+24|0,E=V+12|0,S=V,xt(c|0,0,52)|0,p=lt()|0|134225919,!c)return(v[h+4>>2]|0)>2||(v[h+8>>2]|0)>2||(v[h+12>>2]|0)>2?(M=0,k=0,Bi(M|0),et=V,k|0):(xt(Go(h)|0,0,45)|0,M=lt()|0|p,k=-1,Bi(M|0),et=V,k|0);if(v[k>>2]=v[h>>2],v[k+4>>2]=v[h+4>>2],v[k+8>>2]=v[h+8>>2],v[k+12>>2]=v[h+12>>2],M=k+4|0,(c|0)>0)for(h=-1;v[m>>2]=v[M>>2],v[m+4>>2]=v[M+4>>2],v[m+8>>2]=v[M+8>>2],c&1?(af(M),v[E>>2]=v[M>>2],v[E+4>>2]=v[M+4>>2],v[E+8>>2]=v[M+8>>2],Cc(E)):(Vf(M),v[E>>2]=v[M>>2],v[E+4>>2]=v[M+4>>2],v[E+8>>2]=v[M+8>>2],Tu(E)),ic(m,E,S),Mo(S),ve=(15-c|0)*3|0,te=xt(7,0,ve|0)|0,p=p&~(lt()|0),ve=xt(Zl(S)|0,0,ve|0)|0,h=ve|h&~te,p=lt()|0|p,(c|0)>1;)c=c+-1|0;else h=-1;e:do if((v[M>>2]|0)<=2&&(v[k+8>>2]|0)<=2&&(v[k+12>>2]|0)<=2){if(m=Go(k)|0,c=xt(m|0,0,45)|0,c=c|h,h=lt()|0|p&-1040385,S=Zf(k)|0,!(fa(m)|0)){if((S|0)<=0)break;for(E=0;;){if(m=ft(c|0,h|0,52)|0,lt()|0,m=m&15,m)for(p=1;ve=(15-p|0)*3|0,k=ft(c|0,h|0,ve|0)|0,lt()|0,te=xt(7,0,ve|0)|0,h=h&~(lt()|0),ve=xt(Tc(k&7)|0,0,ve|0)|0,c=c&~te|ve,h=h|(lt()|0),p>>>0<m>>>0;)p=p+1|0;if(E=E+1|0,(E|0)==(S|0))break e}}E=ft(c|0,h|0,52)|0,lt()|0,E=E&15;t:do if(E){p=1;r:for(;;){switch(ve=ft(c|0,h|0,(15-p|0)*3|0)|0,lt()|0,ve&7){case 1:break r;case 0:break;default:break t}if(p>>>0<E>>>0)p=p+1|0;else break t}if(f0(m,v[k>>2]|0)|0)for(p=1;k=(15-p|0)*3|0,te=xt(7,0,k|0)|0,ve=h&~(lt()|0),h=ft(c|0,h|0,k|0)|0,lt()|0,h=xt(Sl(h&7)|0,0,k|0)|0,c=c&~te|h,h=ve|(lt()|0),p>>>0<E>>>0;)p=p+1|0;else for(p=1;ve=(15-p|0)*3|0,k=ft(c|0,h|0,ve|0)|0,lt()|0,te=xt(7,0,ve|0)|0,h=h&~(lt()|0),ve=xt(Tc(k&7)|0,0,ve|0)|0,c=c&~te|ve,h=h|(lt()|0),p>>>0<E>>>0;)p=p+1|0}while(0);if((S|0)>0){p=0;do c=Oc(c,h)|0,h=lt()|0,p=p+1|0;while((p|0)!=(S|0))}}else c=0,h=0;while(0);return te=h,ve=c,Bi(te|0),et=V,ve|0}function au(h){return h=h|0,(h|0)%2|0|0}function sf(h,c,p){h=h|0,c=c|0,p=p|0;var m=0,E=0;return E=et,et=et+16|0,m=E,c>>>0>15?(m=4,et=E,m|0):(v[h+4>>2]&2146435072|0)==2146435072||(v[h+8+4>>2]&2146435072|0)==2146435072?(m=3,et=E,m|0):(yA(h,c,m),c=Hf(m,c)|0,m=lt()|0,v[p>>2]=c,v[p+4>>2]=m,(c|0)==0&(m|0)==0&&ni(23313,22674,786,22697),m=0,et=E,m|0)}function $l(h,c,p){h=h|0,c=c|0,p=p|0;var m=0,E=0,S=0,M=0;if(E=p+4|0,S=ft(h|0,c|0,52)|0,lt()|0,S=S&15,M=ft(h|0,c|0,45)|0,lt()|0,m=(S|0)==0,fa(M&127)|0){if(m)return M=1,M|0;m=1}else{if(m)return M=0,M|0;!(v[E>>2]|0)&&!(v[p+8>>2]|0)?m=(v[p+12>>2]|0)!=0&1:m=1}for(p=1;p&1?Cc(E):Tu(E),M=ft(h|0,c|0,(15-p|0)*3|0)|0,lt()|0,wc(E,M&7),p>>>0<S>>>0;)p=p+1|0;return m|0}function Wl(h,c,p){h=h|0,c=c|0,p=p|0;var m=0,E=0,S=0,M=0,k=0,V=0,te=0,ve=0;if(ve=et,et=et+16|0,V=ve,te=ft(h|0,c|0,45)|0,lt()|0,te=te&127,te>>>0>121)return v[p>>2]=0,v[p+4>>2]=0,v[p+8>>2]=0,v[p+12>>2]=0,te=5,et=ve,te|0;e:do if(fa(te)|0&&(S=ft(h|0,c|0,52)|0,lt()|0,S=S&15,(S|0)!=0)){m=1;t:for(;;){switch(k=ft(h|0,c|0,(15-m|0)*3|0)|0,lt()|0,k&7){case 5:break t;case 0:break;default:{m=c;break e}}if(m>>>0<S>>>0)m=m+1|0;else{m=c;break e}}for(E=1,m=c;c=(15-E|0)*3|0,M=xt(7,0,c|0)|0,k=m&~(lt()|0),m=ft(h|0,m|0,c|0)|0,lt()|0,m=xt(Sl(m&7)|0,0,c|0)|0,h=h&~M|m,m=k|(lt()|0),E>>>0<S>>>0;)E=E+1|0}else m=c;while(0);if(k=7696+(te*28|0)|0,v[p>>2]=v[k>>2],v[p+4>>2]=v[k+4>>2],v[p+8>>2]=v[k+8>>2],v[p+12>>2]=v[k+12>>2],!($l(h,m,p)|0))return te=0,et=ve,te|0;if(M=p+4|0,v[V>>2]=v[M>>2],v[V+4>>2]=v[M+4>>2],v[V+8>>2]=v[M+8>>2],S=ft(h|0,m|0,52)|0,lt()|0,k=S&15,S&1?(Tu(M),S=k+1|0):S=k,!(fa(te)|0))m=0;else{e:do if(!k)m=0;else for(c=1;;){if(E=ft(h|0,m|0,(15-c|0)*3|0)|0,lt()|0,E=E&7,E|0){m=E;break e}if(c>>>0<k>>>0)c=c+1|0;else{m=0;break}}while(0);m=(m|0)==4&1}if(!(Ys(p,S,m,0)|0))(S|0)!=(k|0)&&(v[M>>2]=v[V>>2],v[M+4>>2]=v[V+4>>2],v[M+8>>2]=v[V+8>>2]);else{if(fa(te)|0)do;while(Ys(p,S,0,0)|0);(S|0)!=(k|0)&&Vf(M)}return te=0,et=ve,te|0}function Ps(h,c,p){h=h|0,c=c|0,p=p|0;var m=0,E=0,S=0;return S=et,et=et+16|0,m=S,E=Wl(h,c,m)|0,E|0?(et=S,E|0):(E=ft(h|0,c|0,52)|0,lt()|0,Ic(m,E&15,p),E=0,et=S,E|0)}function Rc(h,c,p){h=h|0,c=c|0,p=p|0;var m=0,E=0,S=0,M=0,k=0;if(M=et,et=et+16|0,S=M,m=Wl(h,c,S)|0,m|0)return S=m,et=M,S|0;m=ft(h|0,c|0,45)|0,lt()|0,m=(fa(m&127)|0)==0,E=ft(h|0,c|0,52)|0,lt()|0,E=E&15;e:do if(!m){if(E|0)for(m=1;;){if(k=xt(7,0,(15-m|0)*3|0)|0,!((k&h|0)==0&((lt()|0)&c|0)==0))break e;if(m>>>0<E>>>0)m=m+1|0;else break}return Sf(S,E,0,5,p),k=0,et=M,k|0}while(0);return sc(S,E,0,6,p),k=0,et=M,k|0}function kc(h,c,p){h=h|0,c=c|0,p=p|0;var m=0,E=0,S=0;if(E=ft(h|0,c|0,45)|0,lt()|0,!(fa(E&127)|0))return E=2,v[p>>2]=E,0;if(E=ft(h|0,c|0,52)|0,lt()|0,E=E&15,!E)return E=5,v[p>>2]=E,0;for(m=1;;){if(S=xt(7,0,(15-m|0)*3|0)|0,!((S&h|0)==0&((lt()|0)&c|0)==0)){m=2,h=6;break}if(m>>>0<E>>>0)m=m+1|0;else{m=5,h=6;break}}return(h|0)==6&&(v[p>>2]=m),0}function Tl(h,c,p){h=h|0,c=c|0,p=p|0;var m=0,E=0,S=0,M=0,k=0,V=0,te=0,ve=0,Ne=0;Ne=et,et=et+128|0,te=Ne+112|0,S=Ne+96|0,ve=Ne,E=ft(h|0,c|0,52)|0,lt()|0,k=E&15,v[te>>2]=k,M=ft(h|0,c|0,45)|0,lt()|0,M=M&127;e:do if(fa(M)|0){if(k|0)for(m=1;;){if(V=xt(7,0,(15-m|0)*3|0)|0,!((V&h|0)==0&((lt()|0)&c|0)==0)){E=0;break e}if(m>>>0<k>>>0)m=m+1|0;else break}if(E&1)E=1;else return V=xt(k+1|0,0,52)|0,ve=lt()|0|c&-15728641,te=xt(7,0,(14-k|0)*3|0)|0,ve=Tl((V|h)&~te,ve&~(lt()|0),p)|0,et=Ne,ve|0}else E=0;while(0);if(m=Wl(h,c,S)|0,!m){E?(Eo(S,te,ve),V=5):(ul(S,te,ve),V=6);e:do if(fa(M)|0)if(!k)h=5;else for(m=1;;){if(M=xt(7,0,(15-m|0)*3|0)|0,!((M&h|0)==0&((lt()|0)&c|0)==0)){h=2;break e}if(m>>>0<k>>>0)m=m+1|0;else{h=5;break}}else h=2;while(0);St(p|0,-1,h<<2|0)|0;e:do if(E)for(S=0;;){if(M=ve+(S<<4)|0,zl(M,v[te>>2]|0)|0,M=v[M>>2]|0,k=v[p>>2]|0,(k|0)==-1|(k|0)==(M|0))m=p;else{E=0;do{if(E=E+1|0,E>>>0>=h>>>0){m=1;break e}m=p+(E<<2)|0,k=v[m>>2]|0}while(!((k|0)==-1|(k|0)==(M|0)))}if(v[m>>2]=M,S=S+1|0,S>>>0>=V>>>0){m=0;break}}else for(S=0;;){if(M=ve+(S<<4)|0,Ys(M,v[te>>2]|0,0,1)|0,M=v[M>>2]|0,k=v[p>>2]|0,(k|0)==-1|(k|0)==(M|0))m=p;else{E=0;do{if(E=E+1|0,E>>>0>=h>>>0){m=1;break e}m=p+(E<<2)|0,k=v[m>>2]|0}while(!((k|0)==-1|(k|0)==(M|0)))}if(v[m>>2]=M,S=S+1|0,S>>>0>=V>>>0){m=0;break}}while(0)}return ve=m,et=Ne,ve|0}function m0(){return 12}function uf(h,c){h=h|0,c=c|0;var p=0,m=0,E=0,S=0,M=0,k=0,V=0;if(h>>>0>15)return k=4,k|0;if(xt(h|0,0,52)|0,k=lt()|0|134225919,!h){p=0,m=0;do fa(m)|0&&(xt(m|0,0,45)|0,M=k|(lt()|0),h=c+(p<<3)|0,v[h>>2]=-1,v[h+4>>2]=M,p=p+1|0),m=m+1|0;while((m|0)!=122);return p=0,p|0}p=0,M=0;do{if(fa(M)|0){for(xt(M|0,0,45)|0,m=1,E=-1,S=k|(lt()|0);V=xt(7,0,(15-m|0)*3|0)|0,E=E&~V,S=S&~(lt()|0),(m|0)!=(h|0);)m=m+1|0;V=c+(p<<3)|0,v[V>>2]=E,v[V+4>>2]=S,p=p+1|0}M=M+1|0}while((M|0)!=122);return p=0,p|0}function lf(h,c,p,m){h=h|0,c=c|0,p=p|0,m=m|0;var E=0,S=0,M=0,k=0,V=0,te=0,ve=0,Ne=0,ut=0,gt=0,rt=0,_t=0,$t=0,qt=0,Yt=0;if(Yt=et,et=et+16|0,$t=Yt,qt=ft(h|0,c|0,52)|0,lt()|0,qt=qt&15,p>>>0>15)return qt=4,et=Yt,qt|0;if((qt|0)<(p|0))return qt=12,et=Yt,qt|0;if((qt|0)!=(p|0))if(S=xt(p|0,0,52)|0,S=S|h,k=lt()|0|c&-15728641,(qt|0)>(p|0)){V=p;do _t=xt(7,0,(14-V|0)*3|0)|0,V=V+1|0,S=_t|S,k=lt()|0|k;while((V|0)<(qt|0));_t=S}else _t=S;else _t=h,k=c;rt=ft(_t|0,k|0,45)|0,lt()|0;e:do if(fa(rt&127)|0){if(V=ft(_t|0,k|0,52)|0,lt()|0,V=V&15,V|0)for(S=1;;){if(rt=xt(7,0,(15-S|0)*3|0)|0,!((rt&_t|0)==0&((lt()|0)&k|0)==0)){te=33;break e}if(S>>>0<V>>>0)S=S+1|0;else break}if(rt=m,v[rt>>2]=0,v[rt+4>>2]=0,(qt|0)>(p|0)){for(rt=c&-15728641,gt=qt;;){if(ut=gt,gt=gt+-1|0,gt>>>0>15|(qt|0)<(gt|0)){te=19;break}if((qt|0)!=(gt|0))if(S=xt(gt|0,0,52)|0,S=S|h,V=lt()|0|rt,(qt|0)<(ut|0))Ne=S;else{te=gt;do Ne=xt(7,0,(14-te|0)*3|0)|0,te=te+1|0,S=Ne|S,V=lt()|0|V;while((te|0)<(qt|0));Ne=S}else Ne=h,V=c;if(ve=ft(Ne|0,V|0,45)|0,lt()|0,!(fa(ve&127)|0))S=0;else{ve=ft(Ne|0,V|0,52)|0,lt()|0,ve=ve&15;t:do if(!ve)S=0;else for(te=1;;){if(S=ft(Ne|0,V|0,(15-te|0)*3|0)|0,lt()|0,S=S&7,S|0)break t;if(te>>>0<ve>>>0)te=te+1|0;else{S=0;break}}while(0);S=(S|0)==0&1}if(V=ft(h|0,c|0,(15-ut|0)*3|0)|0,lt()|0,V=V&7,(V|0)==7){E=5,te=42;break}if(S=(S|0)!=0,(V|0)==1&S){E=5,te=42;break}if(Ne=V+(((V|0)!=0&S)<<31>>31)|0,Ne|0&&(te=qt-ut|0,te=Or(7,0,te,((te|0)<0)<<31>>31)|0,ve=lt()|0,S?(S=Ri(te|0,ve|0,5,0)|0,S=un(S|0,lt()|0,-5,-1)|0,S=gi(S|0,lt()|0,6,0)|0,S=un(S|0,lt()|0,1,0)|0,V=lt()|0):(S=te,V=ve),ut=Ne+-1|0,ut=Ri(te|0,ve|0,ut|0,((ut|0)<0)<<31>>31|0)|0,ut=un(S|0,V|0,ut|0,lt()|0)|0,Ne=lt()|0,ve=m,ve=un(ut|0,Ne|0,v[ve>>2]|0,v[ve+4>>2]|0)|0,Ne=lt()|0,ut=m,v[ut>>2]=ve,v[ut+4>>2]=Ne),(gt|0)<=(p|0)){te=37;break}}if((te|0)==19)ni(23313,22674,1099,22710);else if((te|0)==37){M=m,E=v[M+4>>2]|0,M=v[M>>2]|0;break}else if((te|0)==42)return et=Yt,E|0}else E=0,M=0}else te=33;while(0);e:do if((te|0)==33)if(rt=m,v[rt>>2]=0,v[rt+4>>2]=0,(qt|0)>(p|0)){for(S=qt;;){if(E=ft(h|0,c|0,(15-S|0)*3|0)|0,lt()|0,E=E&7,(E|0)==7){E=5;break}if(M=qt-S|0,M=Or(7,0,M,((M|0)<0)<<31>>31)|0,E=Ri(M|0,lt()|0,E|0,0)|0,M=lt()|0,rt=m,M=un(v[rt>>2]|0,v[rt+4>>2]|0,E|0,M|0)|0,E=lt()|0,rt=m,v[rt>>2]=M,v[rt+4>>2]=E,S=S+-1|0,(S|0)<=(p|0))break e}return et=Yt,E|0}else E=0,M=0;while(0);return Cl(_t,k,qt,$t)|0&&ni(23313,22674,1063,22725),qt=$t,$t=v[qt+4>>2]|0,((E|0)>-1|(E|0)==-1&M>>>0>4294967295)&(($t|0)>(E|0)|(($t|0)==(E|0)?(v[qt>>2]|0)>>>0>M>>>0:0))?(qt=0,et=Yt,qt|0):(ni(23313,22674,1139,22710),0)}function Cf(h,c,p,m,E,S){h=h|0,c=c|0,p=p|0,m=m|0,E=E|0,S=S|0;var M=0,k=0,V=0,te=0,ve=0,Ne=0,ut=0,gt=0,rt=0,_t=0;if(Ne=et,et=et+16|0,M=Ne,E>>>0>15)return S=4,et=Ne,S|0;if(k=ft(p|0,m|0,52)|0,lt()|0,k=k&15,(k|0)>(E|0))return S=12,et=Ne,S|0;if(Cl(p,m,E,M)|0&&ni(23313,22674,1063,22725),ve=M,te=v[ve+4>>2]|0,!(((c|0)>-1|(c|0)==-1&h>>>0>4294967295)&((te|0)>(c|0)|((te|0)==(c|0)?(v[ve>>2]|0)>>>0>h>>>0:0))))return S=2,et=Ne,S|0;ve=E-k|0,E=xt(E|0,0,52)|0,V=lt()|0|m&-15728641,te=S,v[te>>2]=E|p,v[te+4>>2]=V,te=ft(p|0,m|0,45)|0,lt()|0;e:do if(fa(te&127)|0){if(k|0)for(M=1;;){if(te=xt(7,0,(15-M|0)*3|0)|0,!((te&p|0)==0&((lt()|0)&m|0)==0))break e;if(M>>>0<k>>>0)M=M+1|0;else break}if((ve|0)<1)return S=0,et=Ne,S|0;for(te=k^15,m=-1,V=1,M=1;;){k=ve-V|0,k=Or(7,0,k,((k|0)<0)<<31>>31)|0,p=lt()|0;do if(M)if(M=Ri(k|0,p|0,5,0)|0,M=un(M|0,lt()|0,-5,-1)|0,M=gi(M|0,lt()|0,6,0)|0,E=lt()|0,(c|0)>(E|0)|(c|0)==(E|0)&h>>>0>M>>>0){c=un(h|0,c|0,-1,-1)|0,c=Aa(c|0,lt()|0,M|0,E|0)|0,M=lt()|0,ut=S,rt=v[ut>>2]|0,ut=v[ut+4>>2]|0,_t=(te+m|0)*3|0,gt=xt(7,0,_t|0)|0,ut=ut&~(lt()|0),m=gi(c|0,M|0,k|0,p|0)|0,h=lt()|0,E=un(m|0,h|0,2,0)|0,_t=xt(E|0,lt()|0,_t|0)|0,ut=lt()|0|ut,E=S,v[E>>2]=_t|rt&~gt,v[E+4>>2]=ut,h=Ri(m|0,h|0,k|0,p|0)|0,h=Aa(c|0,M|0,h|0,lt()|0)|0,M=0,c=lt()|0;break}else{_t=S,gt=v[_t>>2]|0,_t=v[_t+4>>2]|0,rt=xt(7,0,(te+m|0)*3|0)|0,_t=_t&~(lt()|0),M=S,v[M>>2]=gt&~rt,v[M+4>>2]=_t,M=1;break}else gt=S,E=v[gt>>2]|0,gt=v[gt+4>>2]|0,m=(te+m|0)*3|0,ut=xt(7,0,m|0)|0,gt=gt&~(lt()|0),_t=gi(h|0,c|0,k|0,p|0)|0,M=lt()|0,m=xt(_t|0,M|0,m|0)|0,gt=lt()|0|gt,rt=S,v[rt>>2]=m|E&~ut,v[rt+4>>2]=gt,M=Ri(_t|0,M|0,k|0,p|0)|0,h=Aa(h|0,c|0,M|0,lt()|0)|0,M=0,c=lt()|0;while(0);if((ve|0)>(V|0))m=~V,V=V+1|0;else{c=0;break}}return et=Ne,c|0}while(0);if((ve|0)<1)return _t=0,et=Ne,_t|0;for(E=k^15,M=1;;)if(rt=ve-M|0,rt=Or(7,0,rt,((rt|0)<0)<<31>>31)|0,_t=lt()|0,V=S,p=v[V>>2]|0,V=v[V+4>>2]|0,k=(E-M|0)*3|0,m=xt(7,0,k|0)|0,V=V&~(lt()|0),ut=gi(h|0,c|0,rt|0,_t|0)|0,gt=lt()|0,k=xt(ut|0,gt|0,k|0)|0,V=lt()|0|V,te=S,v[te>>2]=k|p&~m,v[te+4>>2]=V,_t=Ri(ut|0,gt|0,rt|0,_t|0)|0,h=Aa(h|0,c|0,_t|0,lt()|0)|0,c=lt()|0,(ve|0)<=(M|0)){c=0;break}else M=M+1|0;return et=Ne,c|0}function ys(h,c,p,m){h=h|0,c=c|0,p=p|0,m=m|0;var E=0,S=0;E=ft(c|0,p|0,52)|0,lt()|0,E=E&15,(c|0)==0&(p|0)==0|((m|0)>15|(E|0)>(m|0))?(m=-1,E=-1,c=0,p=0):(S=jl(c,p,E+1|0,m)|0,p=(lt()|0)&-15728641,c=xt(m|0,0,52)|0,c=S|c,p=p|(lt()|0),S=(ha(c,p)|0)==0,m=S?-1:m),S=h,v[S>>2]=c,v[S+4>>2]=p,v[h+8>>2]=E,v[h+12>>2]=m}function ll(h){h=h|0;var c=0,p=0,m=0,E=0,S=0,M=0,k=0,V=0,te=0;if(p=h,c=v[p>>2]|0,p=v[p+4>>2]|0,!((c|0)==0&(p|0)==0)&&(m=ft(c|0,p|0,52)|0,lt()|0,m=m&15,k=xt(1,0,(m^15)*3|0)|0,c=un(k|0,lt()|0,c|0,p|0)|0,p=lt()|0,k=h,v[k>>2]=c,v[k+4>>2]=p,k=h+8|0,M=v[k>>2]|0,!((m|0)<(M|0)))){for(V=h+12|0,S=m;;){if((S|0)==(M|0)){m=5;break}if(te=(S|0)==(v[V>>2]|0),E=(15-S|0)*3|0,m=ft(c|0,p|0,E|0)|0,lt()|0,m=m&7,te&((m|0)==1&!0)){m=7;break}if(!((m|0)==7&!0)){m=10;break}if(te=xt(1,0,E|0)|0,c=un(c|0,p|0,te|0,lt()|0)|0,p=lt()|0,te=h,v[te>>2]=c,v[te+4>>2]=p,(S|0)>(M|0))S=S+-1|0;else{m=10;break}}if((m|0)==5){te=h,v[te>>2]=0,v[te+4>>2]=0,v[k>>2]=-1,v[V>>2]=-1;return}else if((m|0)==7){M=xt(1,0,E|0)|0,M=un(c|0,p|0,M|0,lt()|0)|0,k=lt()|0,te=h,v[te>>2]=M,v[te+4>>2]=k,v[V>>2]=S+-1;return}else if((m|0)==10)return}}function Ia(h){h=+h;var c=0;return c=h<0?h+6.283185307179586:h,+(h>=6.283185307179586?c+-6.283185307179586:c)}function Jo(h,c){return h=h|0,c=c|0,+aa(+(+Xe[h>>3]-+Xe[c>>3]))<17453292519943298e-27?(c=+aa(+(+Xe[h+8>>3]-+Xe[c+8>>3]))<17453292519943298e-27,c|0):(c=0,c|0)}function lc(h,c){h=h|0,c=c|0;var p=0,m=0,E=0,S=0;return E=+Xe[c>>3],m=+Xe[h>>3],S=+Vr(+((E-m)*.5)),p=+Vr(+((+Xe[c+8>>3]-+Xe[h+8>>3])*.5)),p=S*S+p*(+Ea(+E)*+Ea(+m)*p),+(+Pn(+ +Da(+p),+ +Da(+(1-p)))*2)}function cl(h,c){h=h|0,c=c|0;var p=0,m=0,E=0,S=0;return E=+Xe[c>>3],m=+Xe[h>>3],S=+Vr(+((E-m)*.5)),p=+Vr(+((+Xe[c+8>>3]-+Xe[h+8>>3])*.5)),p=S*S+p*(+Ea(+E)*+Ea(+m)*p),+(+Pn(+ +Da(+p),+ +Da(+(1-p)))*2*6371.007180918475)}function wf(h,c){h=h|0,c=c|0;var p=0,m=0,E=0,S=0;return E=+Xe[c>>3],m=+Xe[h>>3],S=+Vr(+((E-m)*.5)),p=+Vr(+((+Xe[c+8>>3]-+Xe[h+8>>3])*.5)),p=S*S+p*(+Ea(+E)*+Ea(+m)*p),+(+Pn(+ +Da(+p),+ +Da(+(1-p)))*2*6371.007180918475*1e3)}function W0(h,c){h=h|0,c=c|0;var p=0,m=0,E=0,S=0,M=0;return S=+Xe[c>>3],m=+Ea(+S),E=+Xe[c+8>>3]-+Xe[h+8>>3],M=m*+Vr(+E),p=+Xe[h>>3],+ +Pn(+M,+(+Vr(+S)*+Ea(+p)-+Ea(+E)*(m*+Vr(+p))))}function Dc(h,c,p,m){h=h|0,c=+c,p=+p,m=m|0;var E=0,S=0,M=0,k=0;if(p<1e-16){v[m>>2]=v[h>>2],v[m+4>>2]=v[h+4>>2],v[m+8>>2]=v[h+8>>2],v[m+12>>2]=v[h+12>>2];return}S=c<0?c+6.283185307179586:c,S=c>=6.283185307179586?S+-6.283185307179586:S;do if(S<1e-16)c=+Xe[h>>3]+p,Xe[m>>3]=c,E=m;else{if(E=+aa(+(S+-3.141592653589793))<1e-16,c=+Xe[h>>3],E){c=c-p,Xe[m>>3]=c,E=m;break}if(M=+Ea(+p),p=+Vr(+p),c=M*+Vr(+c)+ +Ea(+S)*(p*+Ea(+c)),c=c>1?1:c,c=+kn(+(c<-1?-1:c)),Xe[m>>3]=c,+aa(+(c+-1.5707963267948966))<1e-16){Xe[m>>3]=1.5707963267948966,Xe[m+8>>3]=0;return}if(+aa(+(c+1.5707963267948966))<1e-16){Xe[m>>3]=-1.5707963267948966,Xe[m+8>>3]=0;return}if(k=+Ea(+c),S=p*+Vr(+S)/k,p=+Xe[h>>3],c=(M-+Vr(+c)*+Vr(+p))/+Ea(+p)/k,M=S>1?1:S,c=c>1?1:c,c=+Xe[h+8>>3]+ +Pn(+(M<-1?-1:M),+(c<-1?-1:c)),c>3.141592653589793)do c=c+-6.283185307179586;while(c>3.141592653589793);if(c<-3.141592653589793)do c=c+6.283185307179586;while(c<-3.141592653589793);Xe[m+8>>3]=c;return}while(0);if(+aa(+(c+-1.5707963267948966))<1e-16){Xe[E>>3]=1.5707963267948966,Xe[m+8>>3]=0;return}if(+aa(+(c+1.5707963267948966))<1e-16){Xe[E>>3]=-1.5707963267948966,Xe[m+8>>3]=0;return}if(c=+Xe[h+8>>3],c>3.141592653589793)do c=c+-6.283185307179586;while(c>3.141592653589793);if(c<-3.141592653589793)do c=c+6.283185307179586;while(c<-3.141592653589793);Xe[m+8>>3]=c}function Tf(h,c){return h=h|0,c=c|0,h>>>0>15?(c=4,c|0):(Xe[c>>3]=+Xe[20528+(h<<3)>>3],c=0,c|0)}function $f(h,c){return h=h|0,c=c|0,h>>>0>15?(c=4,c|0):(Xe[c>>3]=+Xe[20656+(h<<3)>>3],c=0,c|0)}function Y0(h,c){return h=h|0,c=c|0,h>>>0>15?(c=4,c|0):(Xe[c>>3]=+Xe[20784+(h<<3)>>3],c=0,c|0)}function cf(h,c){return h=h|0,c=c|0,h>>>0>15?(c=4,c|0):(Xe[c>>3]=+Xe[20912+(h<<3)>>3],c=0,c|0)}function Mf(h,c){h=h|0,c=c|0;var p=0;return h>>>0>15?(c=4,c|0):(p=Or(7,0,h,((h|0)<0)<<31>>31)|0,p=Ri(p|0,lt()|0,120,0)|0,h=lt()|0,v[c>>2]=p|2,v[c+4>>2]=h,c=0,c|0)}function Wa(h,c,p){h=h|0,c=c|0,p=p|0;var m=0,E=0,S=0,M=0,k=0,V=0,te=0,ve=0,Ne=0,ut=0;return ut=+Xe[c>>3],ve=+Xe[h>>3],V=+Vr(+((ut-ve)*.5)),S=+Xe[c+8>>3],te=+Xe[h+8>>3],M=+Vr(+((S-te)*.5)),k=+Ea(+ve),Ne=+Ea(+ut),M=V*V+M*(Ne*k*M),M=+Pn(+ +Da(+M),+ +Da(+(1-M)))*2,V=+Xe[p>>3],ut=+Vr(+((V-ut)*.5)),m=+Xe[p+8>>3],S=+Vr(+((m-S)*.5)),E=+Ea(+V),S=ut*ut+S*(Ne*E*S),S=+Pn(+ +Da(+S),+ +Da(+(1-S)))*2,V=+Vr(+((ve-V)*.5)),m=+Vr(+((te-m)*.5)),m=V*V+m*(k*E*m),m=+Pn(+ +Da(+m),+ +Da(+(1-m)))*2,E=(M+S+m)*.5,+(+Kn(+ +Da(+(+hn(+(E*.5))*+hn(+((E-M)*.5))*+hn(+((E-S)*.5))*+hn(+((E-m)*.5)))))*4)}function Nc(h,c,p){h=h|0,c=c|0,p=p|0;var m=0,E=0,S=0,M=0,k=0;if(k=et,et=et+192|0,S=k+168|0,M=k,E=Ps(h,c,S)|0,E|0)return p=E,et=k,p|0;if(Rc(h,c,M)|0&&ni(23313,22742,386,22751),c=v[M>>2]|0,(c|0)>0){if(m=+Wa(M+8|0,M+8+(((c|0)!=1&1)<<4)|0,S)+0,(c|0)!=1){h=1;do E=h,h=h+1|0,m=m+ +Wa(M+8+(E<<4)|0,M+8+(((h|0)%(c|0)|0)<<4)|0,S);while((h|0)<(c|0))}}else m=0;return Xe[p>>3]=m,p=0,et=k,p|0}function Yl(h,c,p){return h=h|0,c=c|0,p=p|0,h=Nc(h,c,p)|0,h|0||(Xe[p>>3]=+Xe[p>>3]*6371.007180918475*6371.007180918475),h|0}function Qs(h,c,p){return h=h|0,c=c|0,p=p|0,h=Nc(h,c,p)|0,h|0||(Xe[p>>3]=+Xe[p>>3]*6371.007180918475*6371.007180918475*1e3*1e3),h|0}function vu(h,c,p){h=h|0,c=c|0,p=p|0;var m=0,E=0,S=0,M=0,k=0,V=0,te=0,ve=0;if(k=et,et=et+176|0,M=k,h=bf(h,c,M)|0,h|0)return M=h,et=k,M|0;if(Xe[p>>3]=0,h=v[M>>2]|0,(h|0)<=1)return M=0,et=k,M|0;c=h+-1|0,h=0,m=+Xe[M+8>>3],E=+Xe[M+16>>3],S=0;do h=h+1|0,te=m,m=+Xe[M+8+(h<<4)>>3],ve=+Vr(+((m-te)*.5)),V=E,E=+Xe[M+8+(h<<4)+8>>3],V=+Vr(+((E-V)*.5)),V=ve*ve+V*(+Ea(+m)*+Ea(+te)*V),S=S+ +Pn(+ +Da(+V),+ +Da(+(1-V)))*2;while((h|0)<(c|0));return Xe[p>>3]=S,M=0,et=k,M|0}function Os(h,c,p){h=h|0,c=c|0,p=p|0;var m=0,E=0,S=0,M=0,k=0,V=0,te=0,ve=0;if(k=et,et=et+176|0,M=k,h=bf(h,c,M)|0,h|0)return M=h,S=+Xe[p>>3],S=S*6371.007180918475,Xe[p>>3]=S,et=k,M|0;if(Xe[p>>3]=0,h=v[M>>2]|0,(h|0)<=1)return M=0,S=0,S=S*6371.007180918475,Xe[p>>3]=S,et=k,M|0;c=h+-1|0,h=0,m=+Xe[M+8>>3],E=+Xe[M+16>>3],S=0;do h=h+1|0,te=m,m=+Xe[M+8+(h<<4)>>3],ve=+Vr(+((m-te)*.5)),V=E,E=+Xe[M+8+(h<<4)+8>>3],V=+Vr(+((E-V)*.5)),V=ve*ve+V*(+Ea(+te)*+Ea(+m)*V),S=S+ +Pn(+ +Da(+V),+ +Da(+(1-V)))*2;while((h|0)!=(c|0));return Xe[p>>3]=S,M=0,ve=S,ve=ve*6371.007180918475,Xe[p>>3]=ve,et=k,M|0}function Wf(h,c,p){h=h|0,c=c|0,p=p|0;var m=0,E=0,S=0,M=0,k=0,V=0,te=0,ve=0;if(k=et,et=et+176|0,M=k,h=bf(h,c,M)|0,h|0)return M=h,S=+Xe[p>>3],S=S*6371.007180918475,S=S*1e3,Xe[p>>3]=S,et=k,M|0;if(Xe[p>>3]=0,h=v[M>>2]|0,(h|0)<=1)return M=0,S=0,S=S*6371.007180918475,S=S*1e3,Xe[p>>3]=S,et=k,M|0;c=h+-1|0,h=0,m=+Xe[M+8>>3],E=+Xe[M+16>>3],S=0;do h=h+1|0,te=m,m=+Xe[M+8+(h<<4)>>3],ve=+Vr(+((m-te)*.5)),V=E,E=+Xe[M+8+(h<<4)+8>>3],V=+Vr(+((E-V)*.5)),V=ve*ve+V*(+Ea(+te)*+Ea(+m)*V),S=S+ +Pn(+ +Da(+V),+ +Da(+(1-V)))*2;while((h|0)!=(c|0));return Xe[p>>3]=S,M=0,ve=S,ve=ve*6371.007180918475,ve=ve*1e3,Xe[p>>3]=ve,et=k,M|0}function y0(h){h=h|0;var c=0,p=0,m=0;return c=ga(1,12)|0,c||ni(22832,22787,49,22845),p=h+4|0,m=v[p>>2]|0,m|0?(m=m+8|0,v[m>>2]=c,v[p>>2]=c,c|0):(v[h>>2]|0&&ni(22862,22787,61,22885),m=h,v[m>>2]=c,v[p>>2]=c,c|0)}function xe(h,c){h=h|0,c=c|0;var p=0,m=0;return m=Ua(24)|0,m||ni(22899,22787,78,22913),v[m>>2]=v[c>>2],v[m+4>>2]=v[c+4>>2],v[m+8>>2]=v[c+8>>2],v[m+12>>2]=v[c+12>>2],v[m+16>>2]=0,c=h+4|0,p=v[c>>2]|0,p|0?(v[p+16>>2]=m,v[c>>2]=m,m|0):(v[h>>2]|0&&ni(22928,22787,82,22913),v[h>>2]=m,v[c>>2]=m,m|0)}function Ke(h){h=h|0;var c=0,p=0,m=0,E=0;if(h)for(m=1;;){if(c=v[h>>2]|0,c|0)do{if(p=v[c>>2]|0,p|0)do E=p,p=v[p+16>>2]|0,Tn(E);while(p|0);E=c,c=v[c+8>>2]|0,Tn(E)}while(c|0);if(c=h,h=v[h+8>>2]|0,m||Tn(c),h)m=0;else break}}function mt(h){h=h|0;var c=0,p=0,m=0,E=0,S=0,M=0,k=0,V=0,te=0,ve=0,Ne=0,ut=0,gt=0,rt=0,_t=0,$t=0,qt=0,Yt=0,rr=0,Wt=0,rn=0,En=0,Kr=0,pn=0,La=0,oa=0,pa=0,Vi=0,ui=0,ki=0,Ya=0,Qn=0;if(E=h+8|0,v[E>>2]|0)return Qn=1,Qn|0;if(m=v[h>>2]|0,!m)return Qn=0,Qn|0;c=m,p=0;do p=p+1|0,c=v[c+8>>2]|0;while(c|0);if(p>>>0<2)return Qn=0,Qn|0;ki=Ua(p<<2)|0,ki||ni(22948,22787,317,22967),ui=Ua(p<<5)|0,ui||ni(22989,22787,321,22967),v[h>>2]=0,En=h+4|0,v[En>>2]=0,v[E>>2]=0,p=0,Vi=0,rn=0,Ne=0;e:for(;;){if(ve=v[m>>2]|0,ve){S=0,M=ve;do{if(V=+Xe[M+8>>3],c=M,M=v[M+16>>2]|0,te=(M|0)==0,E=te?ve:M,k=+Xe[E+8>>3],+aa(+(V-k))>3.141592653589793){Qn=14;break}S=S+(k-V)*(+Xe[c>>3]+ +Xe[E>>3])}while(!te);if((Qn|0)==14){Qn=0,S=0,c=ve;do Wt=+Xe[c+8>>3],pa=c+16|0,oa=v[pa>>2]|0,oa=oa|0?oa:ve,rr=+Xe[oa+8>>3],S=S+(+Xe[c>>3]+ +Xe[oa>>3])*((rr<0?rr+6.283185307179586:rr)-(Wt<0?Wt+6.283185307179586:Wt)),c=v[(c|0?pa:m)>>2]|0;while(c|0)}S>0?(v[ki+(Vi<<2)>>2]=m,Vi=Vi+1|0,E=rn,c=Ne):Qn=19}else Qn=19;if((Qn|0)==19){Qn=0;do if(p){if(c=p+8|0,v[c>>2]|0){Qn=21;break e}if(p=ga(1,12)|0,!p){Qn=23;break e}v[c>>2]=p,E=p+4|0,M=p,c=Ne}else if(Ne){E=En,M=Ne+8|0,c=m,p=h;break}else if(v[h>>2]|0){Qn=27;break e}else{E=En,M=h,c=m,p=h;break}while(0);if(v[M>>2]=m,v[E>>2]=m,M=ui+(rn<<5)|0,te=v[m>>2]|0,te){for(ve=ui+(rn<<5)+8|0,Xe[ve>>3]=17976931348623157e292,Ne=ui+(rn<<5)+24|0,Xe[Ne>>3]=17976931348623157e292,Xe[M>>3]=-17976931348623157e292,ut=ui+(rn<<5)+16|0,Xe[ut>>3]=-17976931348623157e292,qt=17976931348623157e292,Yt=-17976931348623157e292,E=0,gt=te,V=17976931348623157e292,_t=17976931348623157e292,$t=-17976931348623157e292,k=-17976931348623157e292;S=+Xe[gt>>3],Wt=+Xe[gt+8>>3],gt=v[gt+16>>2]|0,rt=(gt|0)==0,rr=+Xe[(rt?te:gt)+8>>3],S<V&&(Xe[ve>>3]=S,V=S),Wt<_t&&(Xe[Ne>>3]=Wt,_t=Wt),S>$t?Xe[M>>3]=S:S=$t,Wt>k&&(Xe[ut>>3]=Wt,k=Wt),qt=Wt>0&Wt<qt?Wt:qt,Yt=Wt<0&Wt>Yt?Wt:Yt,E=E|+aa(+(Wt-rr))>3.141592653589793,!rt;)$t=S;E&&(Xe[ut>>3]=Yt,Xe[Ne>>3]=qt)}else v[M>>2]=0,v[M+4>>2]=0,v[M+8>>2]=0,v[M+12>>2]=0,v[M+16>>2]=0,v[M+20>>2]=0,v[M+24>>2]=0,v[M+28>>2]=0;E=rn+1|0}if(pa=m+8|0,m=v[pa>>2]|0,v[pa>>2]=0,m)rn=E,Ne=c;else{Qn=45;break}}if((Qn|0)==21)ni(22765,22787,35,22799);else if((Qn|0)==23)ni(22819,22787,37,22799);else if((Qn|0)==27)ni(22862,22787,61,22885);else if((Qn|0)==45){e:do if((Vi|0)>0){for(pa=(E|0)==0,La=E<<2,oa=(h|0)==0,pn=0,c=0;;){if(Kr=v[ki+(pn<<2)>>2]|0,pa)Qn=73;else{if(rn=Ua(La)|0,!rn){Qn=50;break}if(En=Ua(La)|0,!En){Qn=52;break}t:do if(oa)p=0;else{for(E=0,p=0,M=h;m=ui+(E<<5)|0,nr(v[M>>2]|0,m,v[Kr>>2]|0)|0?(v[rn+(p<<2)>>2]=M,v[En+(p<<2)>>2]=m,rt=p+1|0):rt=p,M=v[M+8>>2]|0,M;)E=E+1|0,p=rt;if((rt|0)>0)if(m=v[rn>>2]|0,(rt|0)==1)p=m;else for(ut=0,gt=-1,p=m,Ne=m;;){for(te=v[Ne>>2]|0,m=0,M=0;E=v[v[rn+(M<<2)>>2]>>2]|0,(E|0)==(te|0)?ve=m:ve=m+((nr(E,v[En+(M<<2)>>2]|0,v[te>>2]|0)|0)&1)|0,M=M+1|0,(M|0)!=(rt|0);)m=ve;if(E=(ve|0)>(gt|0),p=E?Ne:p,m=ut+1|0,(m|0)==(rt|0))break t;ut=m,gt=E?ve:gt,Ne=v[rn+(m<<2)>>2]|0}else p=0}while(0);if(Tn(rn),Tn(En),p){if(E=p+4|0,m=v[E>>2]|0,m)p=m+8|0;else if(v[p>>2]|0){Qn=70;break}v[p>>2]=Kr,v[E>>2]=Kr}else Qn=73}if((Qn|0)==73){if(Qn=0,c=v[Kr>>2]|0,c|0)do En=c,c=v[c+16>>2]|0,Tn(En);while(c|0);Tn(Kr),c=1}if(pn=pn+1|0,(pn|0)>=(Vi|0)){Ya=c;break e}}(Qn|0)==50?ni(23004,22787,249,23023):(Qn|0)==52?ni(23042,22787,252,23023):(Qn|0)==70&&ni(22862,22787,61,22885)}else Ya=0;while(0);return Tn(ki),Tn(ui),Qn=Ya,Qn|0}return 0}function nr(h,c,p){h=h|0,c=c|0,p=p|0;var m=0,E=0,S=0,M=0,k=0,V=0,te=0,ve=0;if(!(nc(c,p)|0)||(c=iu(c)|0,m=+Xe[p>>3],E=+Xe[p+8>>3],E=c&E<0?E+6.283185307179586:E,h=v[h>>2]|0,!h))return h=0,h|0;if(c){c=0,te=E,p=h;e:for(;;){for(;M=+Xe[p>>3],E=+Xe[p+8>>3],p=p+16|0,ve=v[p>>2]|0,ve=ve|0?ve:h,S=+Xe[ve>>3],k=+Xe[ve+8>>3],M>S?(V=M,M=k):(V=S,S=M,M=E,E=k),m=m==S|m==V?m+2220446049250313e-31:m,!!(m<S|m>V);)if(p=v[p>>2]|0,!p){p=22;break e}if(k=M<0?M+6.283185307179586:M,M=E<0?E+6.283185307179586:E,te=k==te|M==te?te+-2220446049250313e-31:te,V=k+(M-k)*((m-S)/(V-S)),(V<0?V+6.283185307179586:V)>te&&(c=c^1),p=v[p>>2]|0,!p){p=22;break}}if((p|0)==22)return c|0}else{c=0,te=E,p=h;e:for(;;){for(;M=+Xe[p>>3],E=+Xe[p+8>>3],p=p+16|0,ve=v[p>>2]|0,ve=ve|0?ve:h,S=+Xe[ve>>3],k=+Xe[ve+8>>3],M>S?(V=M,M=k):(V=S,S=M,M=E,E=k),m=m==S|m==V?m+2220446049250313e-31:m,!!(m<S|m>V);)if(p=v[p>>2]|0,!p){p=22;break e}if(te=M==te|E==te?te+-2220446049250313e-31:te,M+(E-M)*((m-S)/(V-S))>te&&(c=c^1),p=v[p>>2]|0,!p){p=22;break}}if((p|0)==22)return c|0}return 0}function Ar(h,c,p,m,E){h=h|0,c=c|0,p=p|0,m=m|0,E=E|0;var S=0,M=0,k=0,V=0,te=0,ve=0,Ne=0,ut=0,gt=0,rt=0,_t=0,$t=0,qt=0,Yt=0;if(Yt=et,et=et+32|0,qt=Yt+16|0,$t=Yt,S=ft(h|0,c|0,52)|0,lt()|0,S=S&15,gt=ft(p|0,m|0,52)|0,lt()|0,(S|0)!=(gt&15|0))return qt=12,et=Yt,qt|0;if(te=ft(h|0,c|0,45)|0,lt()|0,te=te&127,ve=ft(p|0,m|0,45)|0,lt()|0,ve=ve&127,te>>>0>121|ve>>>0>121)return qt=5,et=Yt,qt|0;if(gt=(te|0)!=(ve|0),gt){if(k=Xi(te,ve)|0,(k|0)==7)return qt=1,et=Yt,qt|0;V=Xi(ve,te)|0,(V|0)==7?ni(23066,23090,161,23100):(rt=k,M=V)}else rt=0,M=0;Ne=fa(te)|0,ut=fa(ve)|0,v[qt>>2]=0,v[qt+4>>2]=0,v[qt+8>>2]=0,v[qt+12>>2]=0;do if(rt){if(ve=v[4272+(te*28|0)+(rt<<2)>>2]|0,k=(ve|0)>0,ut)if(k){te=0,V=p,k=m;do V=ju(V,k)|0,k=lt()|0,M=Sl(M)|0,(M|0)==1&&(M=Sl(1)|0),te=te+1|0;while((te|0)!=(ve|0));ve=M,te=V,V=k}else ve=M,te=p,V=m;else if(k){te=0,V=p,k=m;do V=Mu(V,k)|0,k=lt()|0,M=Sl(M)|0,te=te+1|0;while((te|0)!=(ve|0));ve=M,te=V,V=k}else ve=M,te=p,V=m;if($l(te,V,qt)|0,gt||ni(23115,23090,191,23100),k=(Ne|0)!=0,M=(ut|0)!=0,k&M&&ni(23142,23090,192,23100),k){if(M=Xs(h,c)|0,(M|0)==7){S=5;break}if(gr[21872+(M*7|0)+rt>>0]|0){S=1;break}V=v[21040+(M*28|0)+(rt<<2)>>2]|0,te=V}else if(M){if(M=Xs(te,V)|0,(M|0)==7){S=5;break}if(gr[21872+(M*7|0)+ve>>0]|0){S=1;break}te=0,V=v[21040+(ve*28|0)+(M<<2)>>2]|0}else te=0,V=0;if((te|V|0)<0)S=5;else{if((V|0)>0){k=qt+4|0,M=0;do sl(k),M=M+1|0;while((M|0)!=(V|0))}if(v[$t>>2]=0,v[$t+4>>2]=0,v[$t+8>>2]=0,wc($t,rt),S|0)for(;au(S)|0?Cc($t):Tu($t),(S|0)>1;)S=S+-1|0;if((te|0)>0){S=0;do sl($t),S=S+1|0;while((S|0)!=(te|0))}_t=qt+4|0,ls(_t,$t,_t),Mo(_t),_t=51}}else if($l(p,m,qt)|0,(Ne|0)!=0&(ut|0)!=0)if((ve|0)!=(te|0)&&ni(23173,23090,261,23100),M=Xs(h,c)|0,S=Xs(p,m)|0,(M|0)==7|(S|0)==7)S=5;else if(gr[21872+(M*7|0)+S>>0]|0)S=1;else if(M=v[21040+(M*28|0)+(S<<2)>>2]|0,(M|0)>0){k=qt+4|0,S=0;do sl(k),S=S+1|0;while((S|0)!=(M|0));_t=51}else _t=51;else _t=51;while(0);return(_t|0)==51&&(S=qt+4|0,v[E>>2]=v[S>>2],v[E+4>>2]=v[S+4>>2],v[E+8>>2]=v[S+8>>2],S=0),qt=S,et=Yt,qt|0}function er(h,c,p,m){h=h|0,c=c|0,p=p|0,m=m|0;var E=0,S=0,M=0,k=0,V=0,te=0,ve=0,Ne=0,ut=0,gt=0,rt=0,_t=0,$t=0,qt=0,Yt=0,rr=0;if(_t=et,et=et+48|0,te=_t+36|0,M=_t+24|0,k=_t+12|0,V=_t,E=ft(h|0,c|0,52)|0,lt()|0,E=E&15,ut=ft(h|0,c|0,45)|0,lt()|0,ut=ut&127,ut>>>0>121)return m=5,et=_t,m|0;if(ve=fa(ut)|0,xt(E|0,0,52)|0,$t=lt()|0|134225919,S=m,v[S>>2]=-1,v[S+4>>2]=$t,!E)return E=Zl(p)|0,(E|0)==7||(E=Uf(ut,E)|0,(E|0)==127)?($t=1,et=_t,$t|0):(gt=xt(E|0,0,45)|0,rt=lt()|0,ut=m,rt=v[ut+4>>2]&-1040385|rt,$t=m,v[$t>>2]=v[ut>>2]|gt,v[$t+4>>2]=rt,$t=0,et=_t,$t|0);for(v[te>>2]=v[p>>2],v[te+4>>2]=v[p+4>>2],v[te+8>>2]=v[p+8>>2],p=E;;){if(S=p,p=p+-1|0,v[M>>2]=v[te>>2],v[M+4>>2]=v[te+4>>2],v[M+8>>2]=v[te+8>>2],au(S)|0){if(E=h0(te)|0,E|0){p=13;break}v[k>>2]=v[te>>2],v[k+4>>2]=v[te+4>>2],v[k+8>>2]=v[te+8>>2],Cc(k)}else{if(E=jf(te)|0,E|0){p=13;break}v[k>>2]=v[te>>2],v[k+4>>2]=v[te+4>>2],v[k+8>>2]=v[te+8>>2],Tu(k)}if(ic(M,k,V),Mo(V),E=m,Yt=v[E>>2]|0,E=v[E+4>>2]|0,rr=(15-S|0)*3|0,qt=xt(7,0,rr|0)|0,E=E&~(lt()|0),rr=xt(Zl(V)|0,0,rr|0)|0,E=lt()|0|E,$t=m,v[$t>>2]=rr|Yt&~qt,v[$t+4>>2]=E,(S|0)<=1){p=14;break}}e:do if((p|0)!=13&&(p|0)==14)if((v[te>>2]|0)<=1&&(v[te+4>>2]|0)<=1&&(v[te+8>>2]|0)<=1){p=Zl(te)|0,E=Uf(ut,p)|0,(E|0)==127?V=0:V=fa(E)|0;t:do if(p){if(ve){if(E=Xs(h,c)|0,(E|0)==7){E=5;break e}if(S=v[21248+(E*28|0)+(p<<2)>>2]|0,(S|0)>0){E=p,p=0;do E=Tc(E)|0,p=p+1|0;while((p|0)!=(S|0))}else E=p;if((E|0)==1){E=9;break e}p=Uf(ut,E)|0,(p|0)==127&&ni(23200,23090,411,23230),fa(p)|0?ni(23245,23090,412,23230):(rt=p,gt=S,Ne=E)}else rt=E,gt=0,Ne=p;if(k=v[4272+(ut*28|0)+(Ne<<2)>>2]|0,(k|0)<=-1&&ni(23276,23090,419,23230),!V){if((gt|0)<0){E=5;break e}if(gt|0){S=m,E=0,p=v[S>>2]|0,S=v[S+4>>2]|0;do p=wl(p,S)|0,S=lt()|0,rr=m,v[rr>>2]=p,v[rr+4>>2]=S,E=E+1|0;while((E|0)<(gt|0))}if((k|0)<=0){E=rt,p=58;break}for(S=m,E=0,p=v[S>>2]|0,S=v[S+4>>2]|0;;)if(p=wl(p,S)|0,S=lt()|0,rr=m,v[rr>>2]=p,v[rr+4>>2]=S,E=E+1|0,(E|0)==(k|0)){E=rt,p=58;break t}}if(M=Xi(rt,ut)|0,(M|0)==7&&ni(23066,23090,428,23230),E=m,p=v[E>>2]|0,E=v[E+4>>2]|0,(k|0)>0){S=0;do p=wl(p,E)|0,E=lt()|0,rr=m,v[rr>>2]=p,v[rr+4>>2]=E,S=S+1|0;while((S|0)!=(k|0))}if(E=Xs(p,E)|0,(E|0)==7&&ni(23313,23090,440,23230),p=za(rt)|0,p=v[(p?21664:21456)+(M*28|0)+(E<<2)>>2]|0,(p|0)<0&&ni(23313,23090,454,23230),!p)E=rt,p=58;else{M=m,E=0,S=v[M>>2]|0,M=v[M+4>>2]|0;do S=Oc(S,M)|0,M=lt()|0,rr=m,v[rr>>2]=S,v[rr+4>>2]=M,E=E+1|0;while((E|0)<(p|0));E=rt,p=58}}else if((ve|0)!=0&(V|0)!=0){if(p=Xs(h,c)|0,S=m,S=Xs(v[S>>2]|0,v[S+4>>2]|0)|0,(p|0)==7|(S|0)==7){E=5;break e}if(S=v[21248+(p*28|0)+(S<<2)>>2]|0,(S|0)<0){E=5;break e}if(!S)p=59;else{k=m,p=0,M=v[k>>2]|0,k=v[k+4>>2]|0;do M=wl(M,k)|0,k=lt()|0,rr=m,v[rr>>2]=M,v[rr+4>>2]=k,p=p+1|0;while((p|0)<(S|0));p=58}}else p=58;while(0);if((p|0)==58&&V&&(p=59),(p|0)==59&&(rr=m,(Xs(v[rr>>2]|0,v[rr+4>>2]|0)|0)==1)){E=9;break}rr=m,qt=v[rr>>2]|0,rr=v[rr+4>>2]&-1040385,Yt=xt(E|0,0,45)|0,rr=rr|(lt()|0),E=m,v[E>>2]=qt|Yt,v[E+4>>2]=rr,E=0}else E=1;while(0);return rr=E,et=_t,rr|0}function sr(h,c,p,m,E,S){h=h|0,c=c|0,p=p|0,m=m|0,E=E|0,S=S|0;var M=0,k=0;return k=et,et=et+16|0,M=k,E?h=15:(h=Ar(h,c,p,m,M)|0,h||(bh(M,S),h=0)),et=k,h|0}function wr(h,c,p,m,E){h=h|0,c=c|0,p=p|0,m=m|0,E=E|0;var S=0,M=0;return M=et,et=et+16|0,S=M,m?p=15:(p=Sh(p,S)|0,p||(p=er(h,c,S,E)|0)),et=M,p|0}function Pr(h,c,p,m,E){h=h|0,c=c|0,p=p|0,m=m|0,E=E|0;var S=0,M=0,k=0,V=0;return V=et,et=et+32|0,M=V+12|0,k=V,S=Ar(h,c,h,c,M)|0,S|0?(k=S,et=V,k|0):(h=Ar(h,c,p,m,k)|0,h|0?(k=h,et=V,k|0):(M=ac(M,k)|0,k=E,v[k>>2]=M,v[k+4>>2]=((M|0)<0)<<31>>31,k=0,et=V,k|0))}function Nr(h,c,p,m,E){h=h|0,c=c|0,p=p|0,m=m|0,E=E|0;var S=0,M=0,k=0,V=0;return V=et,et=et+32|0,M=V+12|0,k=V,S=Ar(h,c,h,c,M)|0,!S&&(S=Ar(h,c,p,m,k)|0,!S)?(m=ac(M,k)|0,m=un(m|0,((m|0)<0)<<31>>31|0,1,0)|0,M=lt()|0,k=E,v[k>>2]=m,v[k+4>>2]=M,k=0,et=V,k|0):(k=S,et=V,k|0)}function Dr(h,c,p,m,E){h=h|0,c=c|0,p=p|0,m=m|0,E=E|0;var S=0,M=0,k=0,V=0,te=0,ve=0,Ne=0,ut=0,gt=0,rt=0,_t=0,$t=0,qt=0,Yt=0,rr=0,Wt=0,rn=0,En=0,Kr=0,pn=0;if(Kr=et,et=et+48|0,M=Kr+24|0,k=Kr+12|0,En=Kr,S=Ar(h,c,h,c,M)|0,!S&&(S=Ar(h,c,p,m,k)|0,!S)){Wt=ac(M,k)|0,rn=((Wt|0)<0)<<31>>31,v[M>>2]=0,v[M+4>>2]=0,v[M+8>>2]=0,v[k>>2]=0,v[k+4>>2]=0,v[k+8>>2]=0,Ar(h,c,h,c,M)|0&&ni(23313,23090,691,23299),Ar(h,c,p,m,k)|0&&ni(23313,23090,696,23299),j0(M),j0(k),Wt?(Ne=v[M>>2]|0,rt=+(Wt|0),qt=M+4|0,ut=v[qt>>2]|0,Yt=M+8|0,gt=v[Yt>>2]|0,rr=M,m=Ne,S=ut,p=gt,_t=+((v[k>>2]|0)-Ne|0)/rt,$t=+((v[k+4>>2]|0)-ut|0)/rt,rt=+((v[k+8>>2]|0)-gt|0)/rt):(S=M+4|0,p=M+8|0,qt=S,Yt=p,rr=M,m=v[M>>2]|0,S=v[S>>2]|0,p=v[p>>2]|0,_t=0,$t=0,rt=0),v[En>>2]=m,gt=En+4|0,v[gt>>2]=S,ut=En+8|0,v[ut>>2]=p;e:do if((Wt|0)<0)S=0;else for(ve=0,Ne=0,S=m;;){te=+(Ne>>>0)+4294967296*+(ve|0),pn=_t*te+ +(S|0),V=$t*te+ +(v[qt>>2]|0),te=rt*te+ +(v[Yt>>2]|0),p=~~+at(+pn),M=~~+at(+V),S=~~+at(+te),pn=+aa(+(+(p|0)-pn)),V=+aa(+(+(M|0)-V)),te=+aa(+(+(S|0)-te));do if(pn>V&pn>te)p=0-(M+S)|0,m=M;else if(k=0-p|0,V>te){m=k-S|0;break}else{m=M,S=k-M|0;break}while(0);if(v[En>>2]=p,v[gt>>2]=m,v[ut>>2]=S,p0(En),S=er(h,c,En,E+(Ne<<3)|0)|0,S|0)break e;if(!((ve|0)<(rn|0)|(ve|0)==(rn|0)&Ne>>>0<Wt>>>0)){S=0;break e}S=un(Ne|0,ve|0,1,0)|0,k=lt()|0,ve=k,Ne=S,S=v[rr>>2]|0}while(0);return En=S,et=Kr,En|0}return En=S,et=Kr,En|0}function Or(h,c,p,m){h=h|0,c=c|0,p=p|0,m=m|0;var E=0,S=0,M=0;if((p|0)==0&(m|0)==0)return E=0,S=1,Bi(E|0),S|0;S=h,E=c,h=1,c=0;do M=(p&1|0)==0&!0,h=Ri((M?1:S)|0,(M?0:E)|0,h|0,c|0)|0,c=lt()|0,p=ct(p|0,m|0,1)|0,m=lt()|0,S=Ri(S|0,E|0,S|0,E|0)|0,E=lt()|0;while(!((p|0)==0&(m|0)==0));return Bi(c|0),h|0}function qr(h,c,p){h=h|0,c=c|0,p=p|0;var m=0,E=0,S=0,M=0,k=0,V=0,te=0,ve=0,Ne=0,ut=0;if(!(nc(c,p)|0)||(c=iu(c)|0,m=+Xe[p>>3],E=+Xe[p+8>>3],E=c&E<0?E+6.283185307179586:E,ut=v[h>>2]|0,(ut|0)<=0))return ut=0,ut|0;if(Ne=v[h+4>>2]|0,c){c=0,ve=E,p=-1,h=0;e:for(;;){for(te=h;M=+Xe[Ne+(te<<4)>>3],E=+Xe[Ne+(te<<4)+8>>3],h=(p+2|0)%(ut|0)|0,S=+Xe[Ne+(h<<4)>>3],k=+Xe[Ne+(h<<4)+8>>3],M>S?(V=M,M=k):(V=S,S=M,M=E,E=k),m=m==S|m==V?m+2220446049250313e-31:m,!!(m<S|m>V);)if(p=te+1|0,(p|0)>=(ut|0)){p=22;break e}else h=te,te=p,p=h;if(k=M<0?M+6.283185307179586:M,M=E<0?E+6.283185307179586:E,ve=k==ve|M==ve?ve+-2220446049250313e-31:ve,V=k+(M-k)*((m-S)/(V-S)),(V<0?V+6.283185307179586:V)>ve&&(c=c^1),h=te+1|0,(h|0)>=(ut|0)){p=22;break}else p=te}if((p|0)==22)return c|0}else{c=0,ve=E,p=-1,h=0;e:for(;;){for(te=h;M=+Xe[Ne+(te<<4)>>3],E=+Xe[Ne+(te<<4)+8>>3],h=(p+2|0)%(ut|0)|0,S=+Xe[Ne+(h<<4)>>3],k=+Xe[Ne+(h<<4)+8>>3],M>S?(V=M,M=k):(V=S,S=M,M=E,E=k),m=m==S|m==V?m+2220446049250313e-31:m,!!(m<S|m>V);)if(p=te+1|0,(p|0)>=(ut|0)){p=22;break e}else h=te,te=p,p=h;if(ve=M==ve|E==ve?ve+-2220446049250313e-31:ve,M+(E-M)*((m-S)/(V-S))>ve&&(c=c^1),h=te+1|0,(h|0)>=(ut|0)){p=22;break}else p=te}if((p|0)==22)return c|0}return 0}function Tr(h,c){h=h|0,c=c|0;var p=0,m=0,E=0,S=0,M=0,k=0,V=0,te=0,ve=0,Ne=0,ut=0,gt=0,rt=0,_t=0,$t=0,qt=0,Yt=0;if(rt=v[h>>2]|0,!rt){v[c>>2]=0,v[c+4>>2]=0,v[c+8>>2]=0,v[c+12>>2]=0,v[c+16>>2]=0,v[c+20>>2]=0,v[c+24>>2]=0,v[c+28>>2]=0;return}if(_t=c+8|0,Xe[_t>>3]=17976931348623157e292,$t=c+24|0,Xe[$t>>3]=17976931348623157e292,Xe[c>>3]=-17976931348623157e292,qt=c+16|0,Xe[qt>>3]=-17976931348623157e292,!((rt|0)<=0)){for(ut=v[h+4>>2]|0,te=17976931348623157e292,ve=-17976931348623157e292,Ne=0,h=-1,S=17976931348623157e292,M=17976931348623157e292,V=-17976931348623157e292,m=-17976931348623157e292,gt=0;p=+Xe[ut+(gt<<4)>>3],k=+Xe[ut+(gt<<4)+8>>3],h=h+2|0,E=+Xe[ut+(((h|0)==(rt|0)?0:h)<<4)+8>>3],p<S&&(Xe[_t>>3]=p,S=p),k<M&&(Xe[$t>>3]=k,M=k),p>V?Xe[c>>3]=p:p=V,k>m&&(Xe[qt>>3]=k,m=k),te=k>0&k<te?k:te,ve=k<0&k>ve?k:ve,Ne=Ne|+aa(+(k-E))>3.141592653589793,h=gt+1|0,(h|0)!=(rt|0);)Yt=gt,V=p,gt=h,h=Yt;Ne&&(Xe[qt>>3]=ve,Xe[$t>>3]=te)}}function Zr(h,c){h=h|0,c=c|0;var p=0,m=0,E=0,S=0,M=0,k=0,V=0,te=0,ve=0,Ne=0,ut=0,gt=0,rt=0,_t=0,$t=0,qt=0,Yt=0,rr=0,Wt=0,rn=0,En=0,Kr=0;if(rt=v[h>>2]|0,rt){if(_t=c+8|0,Xe[_t>>3]=17976931348623157e292,$t=c+24|0,Xe[$t>>3]=17976931348623157e292,Xe[c>>3]=-17976931348623157e292,qt=c+16|0,Xe[qt>>3]=-17976931348623157e292,(rt|0)>0){for(E=v[h+4>>2]|0,ut=17976931348623157e292,gt=-17976931348623157e292,m=0,p=-1,V=17976931348623157e292,te=17976931348623157e292,Ne=-17976931348623157e292,M=-17976931348623157e292,Yt=0;S=+Xe[E+(Yt<<4)>>3],ve=+Xe[E+(Yt<<4)+8>>3],En=p+2|0,k=+Xe[E+(((En|0)==(rt|0)?0:En)<<4)+8>>3],S<V&&(Xe[_t>>3]=S,V=S),ve<te&&(Xe[$t>>3]=ve,te=ve),S>Ne?Xe[c>>3]=S:S=Ne,ve>M&&(Xe[qt>>3]=ve,M=ve),ut=ve>0&ve<ut?ve:ut,gt=ve<0&ve>gt?ve:gt,m=m|+aa(+(ve-k))>3.141592653589793,p=Yt+1|0,(p|0)!=(rt|0);)En=Yt,Ne=S,Yt=p,p=En;m&&(Xe[qt>>3]=gt,Xe[$t>>3]=ut)}}else v[c>>2]=0,v[c+4>>2]=0,v[c+8>>2]=0,v[c+12>>2]=0,v[c+16>>2]=0,v[c+20>>2]=0,v[c+24>>2]=0,v[c+28>>2]=0;if(En=h+8|0,p=v[En>>2]|0,!((p|0)<=0)){rn=h+12|0,Wt=0;do if(E=v[rn>>2]|0,m=Wt,Wt=Wt+1|0,$t=c+(Wt<<5)|0,qt=v[E+(m<<3)>>2]|0,qt){if(Yt=c+(Wt<<5)+8|0,Xe[Yt>>3]=17976931348623157e292,h=c+(Wt<<5)+24|0,Xe[h>>3]=17976931348623157e292,Xe[$t>>3]=-17976931348623157e292,rr=c+(Wt<<5)+16|0,Xe[rr>>3]=-17976931348623157e292,(qt|0)>0){for(rt=v[E+(m<<3)+4>>2]|0,ut=17976931348623157e292,gt=-17976931348623157e292,E=0,m=-1,_t=0,V=17976931348623157e292,te=17976931348623157e292,ve=-17976931348623157e292,M=-17976931348623157e292;S=+Xe[rt+(_t<<4)>>3],Ne=+Xe[rt+(_t<<4)+8>>3],m=m+2|0,k=+Xe[rt+(((m|0)==(qt|0)?0:m)<<4)+8>>3],S<V&&(Xe[Yt>>3]=S,V=S),Ne<te&&(Xe[h>>3]=Ne,te=Ne),S>ve?Xe[$t>>3]=S:S=ve,Ne>M&&(Xe[rr>>3]=Ne,M=Ne),ut=Ne>0&Ne<ut?Ne:ut,gt=Ne<0&Ne>gt?Ne:gt,E=E|+aa(+(Ne-k))>3.141592653589793,m=_t+1|0,(m|0)!=(qt|0);)Kr=_t,_t=m,ve=S,m=Kr;E&&(Xe[rr>>3]=gt,Xe[h>>3]=ut)}}else v[$t>>2]=0,v[$t+4>>2]=0,v[$t+8>>2]=0,v[$t+12>>2]=0,v[$t+16>>2]=0,v[$t+20>>2]=0,v[$t+24>>2]=0,v[$t+28>>2]=0,p=v[En>>2]|0;while((Wt|0)<(p|0))}}function Vt(h,c,p){h=h|0,c=c|0,p=p|0;var m=0,E=0,S=0;if(!(qr(h,c,p)|0))return E=0,E|0;if(E=h+8|0,(v[E>>2]|0)<=0)return E=1,E|0;for(m=h+12|0,h=0;;){if(S=h,h=h+1|0,qr((v[m>>2]|0)+(S<<3)|0,c+(h<<5)|0,p)|0){h=0,m=6;break}if((h|0)>=(v[E>>2]|0)){h=1,m=6;break}}return(m|0)==6?h|0:0}function lr(){return 8}function Rr(){return 16}function tn(){return 168}function mr(){return 8}function cn(){return 16}function Cr(){return 12}function Hr(){return 8}function Er(h){return h=h|0,+(+((v[h>>2]|0)>>>0)+4294967296*+(v[h+4>>2]|0))}function Yr(h){h=h|0;var c=0,p=0;return p=+Xe[h>>3],c=+Xe[h+8>>3],+ +Da(+(p*p+c*c))}function Cn(h,c,p,m,E){h=h|0,c=c|0,p=p|0,m=m|0,E=E|0;var S=0,M=0,k=0,V=0,te=0,ve=0,Ne=0,ut=0;te=+Xe[h>>3],V=+Xe[c>>3]-te,k=+Xe[h+8>>3],M=+Xe[c+8>>3]-k,Ne=+Xe[p>>3],S=+Xe[m>>3]-Ne,ut=+Xe[p+8>>3],ve=+Xe[m+8>>3]-ut,S=(S*(k-ut)-(te-Ne)*ve)/(V*ve-M*S),Xe[E>>3]=te+V*S,Xe[E+8>>3]=k+M*S}function Xn(h,c){return h=h|0,c=c|0,+aa(+(+Xe[h>>3]-+Xe[c>>3]))<11920928955078125e-23?(c=+aa(+(+Xe[h+8>>3]-+Xe[c+8>>3]))<11920928955078125e-23,c|0):(c=0,c|0)}function Ir(h,c){h=h|0,c=c|0;var p=0,m=0,E=0;return E=+Xe[h>>3]-+Xe[c>>3],m=+Xe[h+8>>3]-+Xe[c+8>>3],p=+Xe[h+16>>3]-+Xe[c+16>>3],+(E*E+m*m+p*p)}function Fr(h,c){h=h|0,c=c|0;var p=0,m=0,E=0;p=+Xe[h>>3],m=+Ea(+p),p=+Vr(+p),Xe[c+16>>3]=p,p=+Xe[h+8>>3],E=m*+Ea(+p),Xe[c>>3]=E,p=m*+Vr(+p),Xe[c+8>>3]=p}function vr(h,c,p){h=h|0,c=c|0,p=p|0;var m=0,E=0,S=0;if(S=et,et=et+16|0,E=S,m=ha(h,c)|0,(p+-1|0)>>>0>5||(m=(m|0)!=0,(p|0)==1&m))return E=-1,et=S,E|0;do if(On(h,c,E)|0)m=-1;else if(m){m=((v[21936+(p<<2)>>2]|0)+5-(v[E>>2]|0)|0)%5|0;break}else{m=((v[21968+(p<<2)>>2]|0)+6-(v[E>>2]|0)|0)%6|0;break}while(0);return E=m,et=S,E|0}function On(h,c,p){h=h|0,c=c|0,p=p|0;var m=0,E=0,S=0,M=0,k=0,V=0,te=0;if(te=et,et=et+32|0,M=te+16|0,k=te,m=Wl(h,c,M)|0,m|0)return p=m,et=te,p|0;S=Lc(h,c)|0,V=Xs(h,c)|0,U0(S,k),m=zf(S,v[M>>2]|0)|0;e:do if(fa(S)|0){do switch(S|0){case 4:{h=0;break}case 14:{h=1;break}case 24:{h=2;break}case 38:{h=3;break}case 49:{h=4;break}case 58:{h=5;break}case 63:{h=6;break}case 72:{h=7;break}case 83:{h=8;break}case 97:{h=9;break}case 107:{h=10;break}case 117:{h=11;break}default:{m=1;break e}}while(0);if(E=v[22e3+(h*24|0)+8>>2]|0,c=v[22e3+(h*24|0)+16>>2]|0,h=v[M>>2]|0,(h|0)!=(v[k>>2]|0)&&(k=za(S)|0,h=v[M>>2]|0,k|(h|0)==(c|0)&&(m=(m+1|0)%6|0)),(V|0)==3&(h|0)==(c|0)){m=(m+5|0)%6|0,E=22;break}(V|0)==5&(h|0)==(E|0)&&(m=(m+1|0)%6|0),E=22}else E=22;while(0);return(E|0)==22&&(v[p>>2]=m,m=0),p=m,et=te,p|0}function Bn(h,c,p,m){h=h|0,c=c|0,p=p|0,m=m|0;var E=0,S=0,M=0,k=0,V=0,te=0,ve=0,Ne=0,ut=0,gt=0,rt=0,_t=0,$t=0,qt=0,Yt=0,rr=0;if(rr=et,et=et+32|0,Yt=rr+24|0,$t=rr+20|0,rt=rr+8|0,gt=rr+16|0,ut=rr,V=(ha(h,c)|0)==0,V=V?6:5,ve=ft(h|0,c|0,52)|0,lt()|0,ve=ve&15,V>>>0<=p>>>0)return m=2,et=rr,m|0;Ne=(ve|0)==0,!Ne&&(_t=xt(7,0,(ve^15)*3|0)|0,(_t&h|0)==0&((lt()|0)&c|0)==0)?E=p:S=4;e:do if((S|0)==4){if(E=(ha(h,c)|0)!=0,((E?4:5)|0)<(p|0)||On(h,c,Yt)|0||(S=(v[Yt>>2]|0)+p|0,E?E=22288+(((S|0)%5|0)<<2)|0:E=22320+(((S|0)%6|0)<<2)|0,_t=v[E>>2]|0,(_t|0)==7))return m=1,et=rr,m|0;v[$t>>2]=0,E=Uo(h,c,_t,$t,rt)|0;do if(!E){if(k=rt,te=v[k>>2]|0,k=v[k+4>>2]|0,M=k>>>0<c>>>0|(k|0)==(c|0)&te>>>0<h>>>0,S=M?te:h,M=M?k:c,!Ne&&(Ne=xt(7,0,(ve^15)*3|0)|0,(te&Ne|0)==0&(k&(lt()|0)|0)==0))E=p;else{if(k=(p+-1+V|0)%(V|0)|0,E=ha(h,c)|0,(k|0)<0&&ni(23313,23315,245,23324),V=(E|0)!=0,((V?4:5)|0)<(k|0)&&ni(23313,23315,245,23324),On(h,c,Yt)|0&&ni(23313,23315,245,23324),E=(v[Yt>>2]|0)+k|0,V?E=22288+(((E|0)%5|0)<<2)|0:E=22320+(((E|0)%6|0)<<2)|0,k=v[E>>2]|0,(k|0)==7&&ni(23313,23315,245,23324),v[gt>>2]=0,E=Uo(h,c,k,gt,ut)|0,E|0)break;te=ut,V=v[te>>2]|0,te=v[te+4>>2]|0;do if(te>>>0<M>>>0|(te|0)==(M|0)&V>>>0<S>>>0){if(ha(V,te)|0?S=Ff(V,te,h,c)|0:S=v[22384+((((v[gt>>2]|0)+(v[22352+(k<<2)>>2]|0)|0)%6|0)<<2)>>2]|0,E=ha(V,te)|0,(S+-1|0)>>>0>5){E=-1,S=V,M=te;break}if(E=(E|0)!=0,(S|0)==1&E){E=-1,S=V,M=te;break}do if(On(V,te,Yt)|0)E=-1;else if(E){E=((v[21936+(S<<2)>>2]|0)+5-(v[Yt>>2]|0)|0)%5|0;break}else{E=((v[21968+(S<<2)>>2]|0)+6-(v[Yt>>2]|0)|0)%6|0;break}while(0);S=V,M=te}else E=p;while(0);k=rt,te=v[k>>2]|0,k=v[k+4>>2]|0}if((S|0)==(te|0)&(M|0)==(k|0)){if(V=(ha(te,k)|0)!=0,V?h=Ff(te,k,h,c)|0:h=v[22384+((((v[$t>>2]|0)+(v[22352+(_t<<2)>>2]|0)|0)%6|0)<<2)>>2]|0,E=ha(te,k)|0,(h+-1|0)>>>0<=5&&(qt=(E|0)!=0,!((h|0)==1&qt)))do if(On(te,k,Yt)|0)E=-1;else if(qt){E=((v[21936+(h<<2)>>2]|0)+5-(v[Yt>>2]|0)|0)%5|0;break}else{E=((v[21968+(h<<2)>>2]|0)+6-(v[Yt>>2]|0)|0)%6|0;break}while(0);else E=-1;E=E+1|0,E=(E|0)==6|V&(E|0)==5?0:E}c=M,h=S;break e}while(0);return m=E,et=rr,m|0}while(0);return qt=xt(E|0,0,56)|0,Yt=lt()|0|c&-2130706433|536870912,v[m>>2]=qt|h,v[m+4>>2]=Yt,m=0,et=rr,m|0}function gn(h,c,p){h=h|0,c=c|0,p=p|0;var m=0,E=0,S=0;return S=(ha(h,c)|0)==0,m=Bn(h,c,0,p)|0,E=(m|0)==0,S?!E||(m=Bn(h,c,1,p+8|0)|0,m|0)||(m=Bn(h,c,2,p+16|0)|0,m|0)||(m=Bn(h,c,3,p+24|0)|0,m|0)||(m=Bn(h,c,4,p+32|0)|0,m)?(S=m,S|0):Bn(h,c,5,p+40|0)|0:!E||(m=Bn(h,c,1,p+8|0)|0,m|0)||(m=Bn(h,c,2,p+16|0)|0,m|0)||(m=Bn(h,c,3,p+24|0)|0,m|0)||(m=Bn(h,c,4,p+32|0)|0,m|0)?(S=m,S|0):(S=p+40|0,v[S>>2]=0,v[S+4>>2]=0,S=0,S|0)}function xi(h,c,p){h=h|0,c=c|0,p=p|0;var m=0,E=0,S=0,M=0,k=0,V=0;return V=et,et=et+192|0,E=V,S=V+168|0,M=ft(h|0,c|0,56)|0,lt()|0,M=M&7,k=c&-2130706433|134217728,m=Wl(h,k,S)|0,m|0?(k=m,et=V,k|0):(c=ft(h|0,c|0,52)|0,lt()|0,c=c&15,ha(h,k)|0?Sf(S,c,M,1,E):sc(S,c,M,1,E),k=E+8|0,v[p>>2]=v[k>>2],v[p+4>>2]=v[k+4>>2],v[p+8>>2]=v[k+8>>2],v[p+12>>2]=v[k+12>>2],k=0,et=V,k|0)}function Jn(h,c){h=h|0,c=c|0;var p=0,m=0,E=0,S=0;return E=et,et=et+16|0,p=E,!(!0&(c&2013265920|0)==536870912)||(m=c&-2130706433|134217728,!(of(h,m)|0))?(m=0,et=E,m|0):(S=ft(h|0,c|0,56)|0,lt()|0,S=(Bn(h,m,S&7,p)|0)==0,m=p,m=S&((v[m>>2]|0)==(h|0)?(v[m+4>>2]|0)==(c|0):0)&1,et=E,m|0)}function yi(h,c,p){h=h|0,c=c|0,p=p|0;var m=0;(c|0)>0?(m=ga(c,4)|0,v[h>>2]=m,m||ni(23337,23360,40,23374)):v[h>>2]=0,v[h+4>>2]=c,v[h+8>>2]=0,v[h+12>>2]=p}function ta(h){h=h|0;var c=0,p=0,m=0,E=0,S=0,M=0,k=0;E=h+4|0,S=h+12|0,M=h+8|0;e:for(;;){for(p=v[E>>2]|0,c=0;;){if((c|0)>=(p|0))break e;if(m=v[h>>2]|0,k=v[m+(c<<2)>>2]|0,!k)c=c+1|0;else break}c=m+(~~(+aa(+(+us(10,+ +(15-(v[S>>2]|0)|0))*(+Xe[k>>3]+ +Xe[k+8>>3])))%+(p|0))>>>0<<2)|0,p=v[c>>2]|0;t:do if(p|0){if(m=k+32|0,(p|0)==(k|0))v[c>>2]=v[m>>2];else{if(p=p+32|0,c=v[p>>2]|0,!c)break;for(;(c|0)!=(k|0);)if(p=c+32|0,c=v[p>>2]|0,!c)break t;v[p>>2]=v[m>>2]}Tn(k),v[M>>2]=(v[M>>2]|0)+-1}while(0)}Tn(v[h>>2]|0)}function bo(h){h=h|0;var c=0,p=0,m=0;for(m=v[h+4>>2]|0,p=0;;){if((p|0)>=(m|0)){c=0,p=4;break}if(c=v[(v[h>>2]|0)+(p<<2)>>2]|0,!c)p=p+1|0;else{p=4;break}}return(p|0)==4?c|0:0}function ro(h,c){h=h|0,c=c|0;var p=0,m=0,E=0,S=0;if(p=~~(+aa(+(+us(10,+ +(15-(v[h+12>>2]|0)|0))*(+Xe[c>>3]+ +Xe[c+8>>3])))%+(v[h+4>>2]|0))>>>0,p=(v[h>>2]|0)+(p<<2)|0,m=v[p>>2]|0,!m)return S=1,S|0;S=c+32|0;do if((m|0)!=(c|0)){if(p=v[m+32>>2]|0,!p)return S=1,S|0;for(E=p;;){if((E|0)==(c|0)){E=8;break}if(p=v[E+32>>2]|0,p)m=E,E=p;else{p=1,E=10;break}}if((E|0)==8){v[m+32>>2]=v[S>>2];break}else if((E|0)==10)return p|0}else v[p>>2]=v[S>>2];while(0);return Tn(c),S=h+8|0,v[S>>2]=(v[S>>2]|0)+-1,S=0,S|0}function Ti(h,c,p){h=h|0,c=c|0,p=p|0;var m=0,E=0,S=0,M=0;S=Ua(40)|0,S||ni(23390,23360,98,23403),v[S>>2]=v[c>>2],v[S+4>>2]=v[c+4>>2],v[S+8>>2]=v[c+8>>2],v[S+12>>2]=v[c+12>>2],E=S+16|0,v[E>>2]=v[p>>2],v[E+4>>2]=v[p+4>>2],v[E+8>>2]=v[p+8>>2],v[E+12>>2]=v[p+12>>2],v[S+32>>2]=0,E=~~(+aa(+(+us(10,+ +(15-(v[h+12>>2]|0)|0))*(+Xe[c>>3]+ +Xe[c+8>>3])))%+(v[h+4>>2]|0))>>>0,E=(v[h>>2]|0)+(E<<2)|0,m=v[E>>2]|0;do if(!m)v[E>>2]=S;else{for(;!(Jo(m,c)|0&&Jo(m+16|0,p)|0);)if(E=v[m+32>>2]|0,m=E|0?E:m,!(v[m+32>>2]|0)){M=10;break}if((M|0)==10){v[m+32>>2]=S;break}return Tn(S),M=m,M|0}while(0);return M=h+8|0,v[M>>2]=(v[M>>2]|0)+1,M=S,M|0}function Io(h,c,p){h=h|0,c=c|0,p=p|0;var m=0,E=0;if(E=~~(+aa(+(+us(10,+ +(15-(v[h+12>>2]|0)|0))*(+Xe[c>>3]+ +Xe[c+8>>3])))%+(v[h+4>>2]|0))>>>0,E=v[(v[h>>2]|0)+(E<<2)>>2]|0,!E)return p=0,p|0;if(!p){for(h=E;;){if(Jo(h,c)|0){m=10;break}if(h=v[h+32>>2]|0,!h){h=0,m=10;break}}if((m|0)==10)return h|0}for(h=E;;){if(Jo(h,c)|0&&Jo(h+16|0,p)|0){m=10;break}if(h=v[h+32>>2]|0,!h){h=0,m=10;break}}return(m|0)==10?h|0:0}function Na(h,c){h=h|0,c=c|0;var p=0;if(p=~~(+aa(+(+us(10,+ +(15-(v[h+12>>2]|0)|0))*(+Xe[c>>3]+ +Xe[c+8>>3])))%+(v[h+4>>2]|0))>>>0,h=v[(v[h>>2]|0)+(p<<2)>>2]|0,!h)return p=0,p|0;for(;;){if(Jo(h,c)|0){c=5;break}if(h=v[h+32>>2]|0,!h){h=0,c=5;break}}return(c|0)==5?h|0:0}function Ao(){return 23424}function jo(h){return h=+h,+ +kt(+h)}function Fa(h){return h=+h,~~+jo(h)|0}function Ua(h){h=h|0;var c=0,p=0,m=0,E=0,S=0,M=0,k=0,V=0,te=0,ve=0,Ne=0,ut=0,gt=0,rt=0,_t=0,$t=0,qt=0,Yt=0,rr=0,Wt=0,rn=0;rn=et,et=et+16|0,ut=rn;do if(h>>>0<245){if(te=h>>>0<11?16:h+11&-8,h=te>>>3,Ne=v[5857]|0,p=Ne>>>h,p&3|0)return c=(p&1^1)+h|0,h=23468+(c<<1<<2)|0,p=h+8|0,m=v[p>>2]|0,E=m+8|0,S=v[E>>2]|0,(S|0)==(h|0)?v[5857]=Ne&~(1<<c):(v[S+12>>2]=h,v[p>>2]=S),Wt=c<<3,v[m+4>>2]=Wt|3,Wt=m+Wt+4|0,v[Wt>>2]=v[Wt>>2]|1,Wt=E,et=rn,Wt|0;if(ve=v[5859]|0,te>>>0>ve>>>0){if(p|0)return c=2<<h,c=p<<h&(c|0-c),c=(c&0-c)+-1|0,k=c>>>12&16,c=c>>>k,p=c>>>5&8,c=c>>>p,S=c>>>2&4,c=c>>>S,h=c>>>1&2,c=c>>>h,m=c>>>1&1,m=(p|k|S|h|m)+(c>>>m)|0,c=23468+(m<<1<<2)|0,h=c+8|0,S=v[h>>2]|0,k=S+8|0,p=v[k>>2]|0,(p|0)==(c|0)?(h=Ne&~(1<<m),v[5857]=h):(v[p+12>>2]=c,v[h>>2]=p,h=Ne),Wt=m<<3,M=Wt-te|0,v[S+4>>2]=te|3,E=S+te|0,v[E+4>>2]=M|1,v[S+Wt>>2]=M,ve|0&&(m=v[5862]|0,c=ve>>>3,p=23468+(c<<1<<2)|0,c=1<<c,h&c?(h=p+8|0,c=v[h>>2]|0):(v[5857]=h|c,c=p,h=p+8|0),v[h>>2]=m,v[c+12>>2]=m,v[m+8>>2]=c,v[m+12>>2]=p),v[5859]=M,v[5862]=E,Wt=k,et=rn,Wt|0;if(S=v[5858]|0,S){for(p=(S&0-S)+-1|0,E=p>>>12&16,p=p>>>E,m=p>>>5&8,p=p>>>m,M=p>>>2&4,p=p>>>M,k=p>>>1&2,p=p>>>k,V=p>>>1&1,V=v[23732+((m|E|M|k|V)+(p>>>V)<<2)>>2]|0,p=V,k=V,V=(v[V+4>>2]&-8)-te|0;h=v[p+16>>2]|0,!(!h&&(h=v[p+20>>2]|0,!h));)M=(v[h+4>>2]&-8)-te|0,E=M>>>0<V>>>0,p=h,k=E?h:k,V=E?M:V;if(M=k+te|0,M>>>0>k>>>0){E=v[k+24>>2]|0,c=v[k+12>>2]|0;do if((c|0)==(k|0)){if(h=k+20|0,c=v[h>>2]|0,!c&&(h=k+16|0,c=v[h>>2]|0,!c)){p=0;break}for(;;)if(m=c+20|0,p=v[m>>2]|0,p)c=p,h=m;else if(m=c+16|0,p=v[m>>2]|0,p)c=p,h=m;else break;v[h>>2]=0,p=c}else p=v[k+8>>2]|0,v[p+12>>2]=c,v[c+8>>2]=p,p=c;while(0);do if(E|0){if(c=v[k+28>>2]|0,h=23732+(c<<2)|0,(k|0)==(v[h>>2]|0)){if(v[h>>2]=p,!p){v[5858]=S&~(1<<c);break}}else if(Wt=E+16|0,v[((v[Wt>>2]|0)==(k|0)?Wt:E+20|0)>>2]=p,!p)break;v[p+24>>2]=E,c=v[k+16>>2]|0,c|0&&(v[p+16>>2]=c,v[c+24>>2]=p),c=v[k+20>>2]|0,c|0&&(v[p+20>>2]=c,v[c+24>>2]=p)}while(0);return V>>>0<16?(Wt=V+te|0,v[k+4>>2]=Wt|3,Wt=k+Wt+4|0,v[Wt>>2]=v[Wt>>2]|1):(v[k+4>>2]=te|3,v[M+4>>2]=V|1,v[M+V>>2]=V,ve|0&&(m=v[5862]|0,c=ve>>>3,p=23468+(c<<1<<2)|0,c=1<<c,c&Ne?(h=p+8|0,c=v[h>>2]|0):(v[5857]=c|Ne,c=p,h=p+8|0),v[h>>2]=m,v[c+12>>2]=m,v[m+8>>2]=c,v[m+12>>2]=p),v[5859]=V,v[5862]=M),Wt=k+8|0,et=rn,Wt|0}else Ne=te}else Ne=te}else Ne=te}else if(h>>>0<=4294967231)if(h=h+11|0,te=h&-8,m=v[5858]|0,m){E=0-te|0,h=h>>>8,h?te>>>0>16777215?V=31:(Ne=(h+1048320|0)>>>16&8,_t=h<<Ne,k=(_t+520192|0)>>>16&4,_t=_t<<k,V=(_t+245760|0)>>>16&2,V=14-(k|Ne|V)+(_t<<V>>>15)|0,V=te>>>(V+7|0)&1|V<<1):V=0,p=v[23732+(V<<2)>>2]|0;e:do if(!p)p=0,h=0,_t=61;else for(h=0,k=te<<((V|0)==31?0:25-(V>>>1)|0),S=0;;){if(M=(v[p+4>>2]&-8)-te|0,M>>>0<E>>>0)if(M)h=p,E=M;else{h=p,E=0,_t=65;break e}if(_t=v[p+20>>2]|0,p=v[p+16+(k>>>31<<2)>>2]|0,S=(_t|0)==0|(_t|0)==(p|0)?S:_t,p)k=k<<1;else{p=S,_t=61;break}}while(0);if((_t|0)==61){if((p|0)==0&(h|0)==0){if(h=2<<V,h=(h|0-h)&m,!h){Ne=te;break}Ne=(h&0-h)+-1|0,M=Ne>>>12&16,Ne=Ne>>>M,S=Ne>>>5&8,Ne=Ne>>>S,k=Ne>>>2&4,Ne=Ne>>>k,V=Ne>>>1&2,Ne=Ne>>>V,p=Ne>>>1&1,h=0,p=v[23732+((S|M|k|V|p)+(Ne>>>p)<<2)>>2]|0}p?_t=65:(k=h,M=E)}if((_t|0)==65)for(S=p;;)if(Ne=(v[S+4>>2]&-8)-te|0,p=Ne>>>0<E>>>0,E=p?Ne:E,h=p?S:h,p=v[S+16>>2]|0,p||(p=v[S+20>>2]|0),p)S=p;else{k=h,M=E;break}if(k|0&&M>>>0<((v[5859]|0)-te|0)>>>0&&(ve=k+te|0,ve>>>0>k>>>0)){S=v[k+24>>2]|0,c=v[k+12>>2]|0;do if((c|0)==(k|0)){if(h=k+20|0,c=v[h>>2]|0,!c&&(h=k+16|0,c=v[h>>2]|0,!c)){c=0;break}for(;;)if(E=c+20|0,p=v[E>>2]|0,p)c=p,h=E;else if(E=c+16|0,p=v[E>>2]|0,p)c=p,h=E;else break;v[h>>2]=0}else Wt=v[k+8>>2]|0,v[Wt+12>>2]=c,v[c+8>>2]=Wt;while(0);do if(S){if(h=v[k+28>>2]|0,p=23732+(h<<2)|0,(k|0)==(v[p>>2]|0)){if(v[p>>2]=c,!c){m=m&~(1<<h),v[5858]=m;break}}else if(Wt=S+16|0,v[((v[Wt>>2]|0)==(k|0)?Wt:S+20|0)>>2]=c,!c)break;v[c+24>>2]=S,h=v[k+16>>2]|0,h|0&&(v[c+16>>2]=h,v[h+24>>2]=c),h=v[k+20>>2]|0,h&&(v[c+20>>2]=h,v[h+24>>2]=c)}while(0);e:do if(M>>>0<16)Wt=M+te|0,v[k+4>>2]=Wt|3,Wt=k+Wt+4|0,v[Wt>>2]=v[Wt>>2]|1;else{if(v[k+4>>2]=te|3,v[ve+4>>2]=M|1,v[ve+M>>2]=M,c=M>>>3,M>>>0<256){p=23468+(c<<1<<2)|0,h=v[5857]|0,c=1<<c,h&c?(h=p+8|0,c=v[h>>2]|0):(v[5857]=h|c,c=p,h=p+8|0),v[h>>2]=ve,v[c+12>>2]=ve,v[ve+8>>2]=c,v[ve+12>>2]=p;break}if(c=M>>>8,c?M>>>0>16777215?p=31:(rr=(c+1048320|0)>>>16&8,Wt=c<<rr,Yt=(Wt+520192|0)>>>16&4,Wt=Wt<<Yt,p=(Wt+245760|0)>>>16&2,p=14-(Yt|rr|p)+(Wt<<p>>>15)|0,p=M>>>(p+7|0)&1|p<<1):p=0,c=23732+(p<<2)|0,v[ve+28>>2]=p,h=ve+16|0,v[h+4>>2]=0,v[h>>2]=0,h=1<<p,!(m&h)){v[5858]=m|h,v[c>>2]=ve,v[ve+24>>2]=c,v[ve+12>>2]=ve,v[ve+8>>2]=ve;break}c=v[c>>2]|0;t:do if((v[c+4>>2]&-8|0)!=(M|0)){for(m=M<<((p|0)==31?0:25-(p>>>1)|0);p=c+16+(m>>>31<<2)|0,h=v[p>>2]|0,!!h;)if((v[h+4>>2]&-8|0)==(M|0)){c=h;break t}else m=m<<1,c=h;v[p>>2]=ve,v[ve+24>>2]=c,v[ve+12>>2]=ve,v[ve+8>>2]=ve;break e}while(0);rr=c+8|0,Wt=v[rr>>2]|0,v[Wt+12>>2]=ve,v[rr>>2]=ve,v[ve+8>>2]=Wt,v[ve+12>>2]=c,v[ve+24>>2]=0}while(0);return Wt=k+8|0,et=rn,Wt|0}else Ne=te}else Ne=te;else Ne=-1;while(0);if(p=v[5859]|0,p>>>0>=Ne>>>0)return c=p-Ne|0,h=v[5862]|0,c>>>0>15?(Wt=h+Ne|0,v[5862]=Wt,v[5859]=c,v[Wt+4>>2]=c|1,v[h+p>>2]=c,v[h+4>>2]=Ne|3):(v[5859]=0,v[5862]=0,v[h+4>>2]=p|3,Wt=h+p+4|0,v[Wt>>2]=v[Wt>>2]|1),Wt=h+8|0,et=rn,Wt|0;if(M=v[5860]|0,M>>>0>Ne>>>0)return Yt=M-Ne|0,v[5860]=Yt,Wt=v[5863]|0,rr=Wt+Ne|0,v[5863]=rr,v[rr+4>>2]=Yt|1,v[Wt+4>>2]=Ne|3,Wt=Wt+8|0,et=rn,Wt|0;if(v[5975]|0?h=v[5977]|0:(v[5977]=4096,v[5976]=4096,v[5978]=-1,v[5979]=-1,v[5980]=0,v[5968]=0,v[5975]=ut&-16^1431655768,h=4096),k=Ne+48|0,V=Ne+47|0,S=h+V|0,E=0-h|0,te=S&E,te>>>0<=Ne>>>0||(h=v[5967]|0,h|0&&(ve=v[5965]|0,ut=ve+te|0,ut>>>0<=ve>>>0|ut>>>0>h>>>0)))return Wt=0,et=rn,Wt|0;e:do if(v[5968]&4)c=0,_t=143;else{p=v[5863]|0;t:do if(p){for(m=23876;ut=v[m>>2]|0,!(ut>>>0<=p>>>0&&(ut+(v[m+4>>2]|0)|0)>>>0>p>>>0);)if(h=v[m+8>>2]|0,h)m=h;else{_t=128;break t}if(c=S-M&E,c>>>0<2147483647)if(h=Ft(c|0)|0,(h|0)==((v[m>>2]|0)+(v[m+4>>2]|0)|0)){if((h|0)!=-1){M=c,S=h,_t=145;break e}}else m=h,_t=136;else c=0}else _t=128;while(0);do if((_t|0)==128)if(p=Ft(0)|0,(p|0)!=-1&&(c=p,gt=v[5976]|0,rt=gt+-1|0,c=(rt&c|0?(rt+c&0-gt)-c|0:0)+te|0,gt=v[5965]|0,rt=c+gt|0,c>>>0>Ne>>>0&c>>>0<2147483647)){if(ut=v[5967]|0,ut|0&&rt>>>0<=gt>>>0|rt>>>0>ut>>>0){c=0;break}if(h=Ft(c|0)|0,(h|0)==(p|0)){M=c,S=p,_t=145;break e}else m=h,_t=136}else c=0;while(0);do if((_t|0)==136){if(p=0-c|0,!(k>>>0>c>>>0&(c>>>0<2147483647&(m|0)!=-1)))if((m|0)==-1){c=0;break}else{M=c,S=m,_t=145;break e}if(h=v[5977]|0,h=V-c+h&0-h,h>>>0>=2147483647){M=c,S=m,_t=145;break e}if((Ft(h|0)|0)==-1){Ft(p|0)|0,c=0;break}else{M=h+c|0,S=m,_t=145;break e}}while(0);v[5968]=v[5968]|4,_t=143}while(0);if((_t|0)==143&&te>>>0<2147483647&&(Yt=Ft(te|0)|0,rt=Ft(0)|0,$t=rt-Yt|0,qt=$t>>>0>(Ne+40|0)>>>0,!((Yt|0)==-1|qt^1|Yt>>>0<rt>>>0&((Yt|0)!=-1&(rt|0)!=-1)^1))&&(M=qt?$t:c,S=Yt,_t=145),(_t|0)==145){c=(v[5965]|0)+M|0,v[5965]=c,c>>>0>(v[5966]|0)>>>0&&(v[5966]=c),V=v[5863]|0;e:do if(V){for(c=23876;;){if(h=v[c>>2]|0,p=v[c+4>>2]|0,(S|0)==(h+p|0)){_t=154;break}if(m=v[c+8>>2]|0,m)c=m;else break}if((_t|0)==154&&(rr=c+4|0,(v[c+12>>2]&8|0)==0)&&S>>>0>V>>>0&h>>>0<=V>>>0){v[rr>>2]=p+M,Wt=(v[5860]|0)+M|0,Yt=V+8|0,Yt=Yt&7|0?0-Yt&7:0,rr=V+Yt|0,Yt=Wt-Yt|0,v[5863]=rr,v[5860]=Yt,v[rr+4>>2]=Yt|1,v[V+Wt+4>>2]=40,v[5864]=v[5979];break}for(S>>>0<(v[5861]|0)>>>0&&(v[5861]=S),p=S+M|0,c=23876;;){if((v[c>>2]|0)==(p|0)){_t=162;break}if(h=v[c+8>>2]|0,h)c=h;else break}if((_t|0)==162&&!(v[c+12>>2]&8|0)){v[c>>2]=S,ve=c+4|0,v[ve>>2]=(v[ve>>2]|0)+M,ve=S+8|0,ve=S+(ve&7|0?0-ve&7:0)|0,c=p+8|0,c=p+(c&7|0?0-c&7:0)|0,te=ve+Ne|0,k=c-ve-Ne|0,v[ve+4>>2]=Ne|3;t:do if((V|0)==(c|0))Wt=(v[5860]|0)+k|0,v[5860]=Wt,v[5863]=te,v[te+4>>2]=Wt|1;else{if((v[5862]|0)==(c|0)){Wt=(v[5859]|0)+k|0,v[5859]=Wt,v[5862]=te,v[te+4>>2]=Wt|1,v[te+Wt>>2]=Wt;break}if(h=v[c+4>>2]|0,(h&3|0)==1){M=h&-8,m=h>>>3;r:do if(h>>>0<256)if(h=v[c+8>>2]|0,p=v[c+12>>2]|0,(p|0)==(h|0)){v[5857]=v[5857]&~(1<<m);break}else{v[h+12>>2]=p,v[p+8>>2]=h;break}else{S=v[c+24>>2]|0,h=v[c+12>>2]|0;do if((h|0)==(c|0)){if(p=c+16|0,m=p+4|0,h=v[m>>2]|0,h)p=m;else if(h=v[p>>2]|0,!h){h=0;break}for(;;)if(E=h+20|0,m=v[E>>2]|0,m)h=m,p=E;else if(E=h+16|0,m=v[E>>2]|0,m)h=m,p=E;else break;v[p>>2]=0}else Wt=v[c+8>>2]|0,v[Wt+12>>2]=h,v[h+8>>2]=Wt;while(0);if(!S)break;p=v[c+28>>2]|0,m=23732+(p<<2)|0;do if((v[m>>2]|0)!=(c|0)){if(Wt=S+16|0,v[((v[Wt>>2]|0)==(c|0)?Wt:S+20|0)>>2]=h,!h)break r}else{if(v[m>>2]=h,h|0)break;v[5858]=v[5858]&~(1<<p);break r}while(0);if(v[h+24>>2]=S,p=c+16|0,m=v[p>>2]|0,m|0&&(v[h+16>>2]=m,v[m+24>>2]=h),p=v[p+4>>2]|0,!p)break;v[h+20>>2]=p,v[p+24>>2]=h}while(0);c=c+M|0,E=M+k|0}else E=k;if(c=c+4|0,v[c>>2]=v[c>>2]&-2,v[te+4>>2]=E|1,v[te+E>>2]=E,c=E>>>3,E>>>0<256){p=23468+(c<<1<<2)|0,h=v[5857]|0,c=1<<c,h&c?(h=p+8|0,c=v[h>>2]|0):(v[5857]=h|c,c=p,h=p+8|0),v[h>>2]=te,v[c+12>>2]=te,v[te+8>>2]=c,v[te+12>>2]=p;break}c=E>>>8;do if(!c)m=0;else{if(E>>>0>16777215){m=31;break}rr=(c+1048320|0)>>>16&8,Wt=c<<rr,Yt=(Wt+520192|0)>>>16&4,Wt=Wt<<Yt,m=(Wt+245760|0)>>>16&2,m=14-(Yt|rr|m)+(Wt<<m>>>15)|0,m=E>>>(m+7|0)&1|m<<1}while(0);if(c=23732+(m<<2)|0,v[te+28>>2]=m,h=te+16|0,v[h+4>>2]=0,v[h>>2]=0,h=v[5858]|0,p=1<<m,!(h&p)){v[5858]=h|p,v[c>>2]=te,v[te+24>>2]=c,v[te+12>>2]=te,v[te+8>>2]=te;break}c=v[c>>2]|0;r:do if((v[c+4>>2]&-8|0)!=(E|0)){for(m=E<<((m|0)==31?0:25-(m>>>1)|0);p=c+16+(m>>>31<<2)|0,h=v[p>>2]|0,!!h;)if((v[h+4>>2]&-8|0)==(E|0)){c=h;break r}else m=m<<1,c=h;v[p>>2]=te,v[te+24>>2]=c,v[te+12>>2]=te,v[te+8>>2]=te;break t}while(0);rr=c+8|0,Wt=v[rr>>2]|0,v[Wt+12>>2]=te,v[rr>>2]=te,v[te+8>>2]=Wt,v[te+12>>2]=c,v[te+24>>2]=0}while(0);return Wt=ve+8|0,et=rn,Wt|0}for(c=23876;h=v[c>>2]|0,!(h>>>0<=V>>>0&&(Wt=h+(v[c+4>>2]|0)|0,Wt>>>0>V>>>0));)c=v[c+8>>2]|0;E=Wt+-47|0,h=E+8|0,h=E+(h&7|0?0-h&7:0)|0,E=V+16|0,h=h>>>0<E>>>0?V:h,c=h+8|0,p=M+-40|0,Yt=S+8|0,Yt=Yt&7|0?0-Yt&7:0,rr=S+Yt|0,Yt=p-Yt|0,v[5863]=rr,v[5860]=Yt,v[rr+4>>2]=Yt|1,v[S+p+4>>2]=40,v[5864]=v[5979],p=h+4|0,v[p>>2]=27,v[c>>2]=v[5969],v[c+4>>2]=v[5970],v[c+8>>2]=v[5971],v[c+12>>2]=v[5972],v[5969]=S,v[5970]=M,v[5972]=0,v[5971]=c,c=h+24|0;do rr=c,c=c+4|0,v[c>>2]=7;while((rr+8|0)>>>0<Wt>>>0);if((h|0)!=(V|0)){if(S=h-V|0,v[p>>2]=v[p>>2]&-2,v[V+4>>2]=S|1,v[h>>2]=S,c=S>>>3,S>>>0<256){p=23468+(c<<1<<2)|0,h=v[5857]|0,c=1<<c,h&c?(h=p+8|0,c=v[h>>2]|0):(v[5857]=h|c,c=p,h=p+8|0),v[h>>2]=V,v[c+12>>2]=V,v[V+8>>2]=c,v[V+12>>2]=p;break}if(c=S>>>8,c?S>>>0>16777215?m=31:(rr=(c+1048320|0)>>>16&8,Wt=c<<rr,Yt=(Wt+520192|0)>>>16&4,Wt=Wt<<Yt,m=(Wt+245760|0)>>>16&2,m=14-(Yt|rr|m)+(Wt<<m>>>15)|0,m=S>>>(m+7|0)&1|m<<1):m=0,p=23732+(m<<2)|0,v[V+28>>2]=m,v[V+20>>2]=0,v[E>>2]=0,c=v[5858]|0,h=1<<m,!(c&h)){v[5858]=c|h,v[p>>2]=V,v[V+24>>2]=p,v[V+12>>2]=V,v[V+8>>2]=V;break}c=v[p>>2]|0;t:do if((v[c+4>>2]&-8|0)!=(S|0)){for(m=S<<((m|0)==31?0:25-(m>>>1)|0);p=c+16+(m>>>31<<2)|0,h=v[p>>2]|0,!!h;)if((v[h+4>>2]&-8|0)==(S|0)){c=h;break t}else m=m<<1,c=h;v[p>>2]=V,v[V+24>>2]=c,v[V+12>>2]=V,v[V+8>>2]=V;break e}while(0);rr=c+8|0,Wt=v[rr>>2]|0,v[Wt+12>>2]=V,v[rr>>2]=V,v[V+8>>2]=Wt,v[V+12>>2]=c,v[V+24>>2]=0}}else Wt=v[5861]|0,(Wt|0)==0|S>>>0<Wt>>>0&&(v[5861]=S),v[5969]=S,v[5970]=M,v[5972]=0,v[5866]=v[5975],v[5865]=-1,v[5870]=23468,v[5869]=23468,v[5872]=23476,v[5871]=23476,v[5874]=23484,v[5873]=23484,v[5876]=23492,v[5875]=23492,v[5878]=23500,v[5877]=23500,v[5880]=23508,v[5879]=23508,v[5882]=23516,v[5881]=23516,v[5884]=23524,v[5883]=23524,v[5886]=23532,v[5885]=23532,v[5888]=23540,v[5887]=23540,v[5890]=23548,v[5889]=23548,v[5892]=23556,v[5891]=23556,v[5894]=23564,v[5893]=23564,v[5896]=23572,v[5895]=23572,v[5898]=23580,v[5897]=23580,v[5900]=23588,v[5899]=23588,v[5902]=23596,v[5901]=23596,v[5904]=23604,v[5903]=23604,v[5906]=23612,v[5905]=23612,v[5908]=23620,v[5907]=23620,v[5910]=23628,v[5909]=23628,v[5912]=23636,v[5911]=23636,v[5914]=23644,v[5913]=23644,v[5916]=23652,v[5915]=23652,v[5918]=23660,v[5917]=23660,v[5920]=23668,v[5919]=23668,v[5922]=23676,v[5921]=23676,v[5924]=23684,v[5923]=23684,v[5926]=23692,v[5925]=23692,v[5928]=23700,v[5927]=23700,v[5930]=23708,v[5929]=23708,v[5932]=23716,v[5931]=23716,Wt=M+-40|0,Yt=S+8|0,Yt=Yt&7|0?0-Yt&7:0,rr=S+Yt|0,Yt=Wt-Yt|0,v[5863]=rr,v[5860]=Yt,v[rr+4>>2]=Yt|1,v[S+Wt+4>>2]=40,v[5864]=v[5979];while(0);if(c=v[5860]|0,c>>>0>Ne>>>0)return Yt=c-Ne|0,v[5860]=Yt,Wt=v[5863]|0,rr=Wt+Ne|0,v[5863]=rr,v[rr+4>>2]=Yt|1,v[Wt+4>>2]=Ne|3,Wt=Wt+8|0,et=rn,Wt|0}return Wt=Ao()|0,v[Wt>>2]=12,Wt=0,et=rn,Wt|0}function Tn(h){h=h|0;var c=0,p=0,m=0,E=0,S=0,M=0,k=0,V=0;if(h){p=h+-8|0,E=v[5861]|0,h=v[h+-4>>2]|0,c=h&-8,V=p+c|0;do if(h&1)k=p,M=p;else{if(m=v[p>>2]|0,!(h&3)||(M=p+(0-m)|0,S=m+c|0,M>>>0<E>>>0))return;if((v[5862]|0)==(M|0)){if(h=V+4|0,c=v[h>>2]|0,(c&3|0)!=3){k=M,c=S;break}v[5859]=S,v[h>>2]=c&-2,v[M+4>>2]=S|1,v[M+S>>2]=S;return}if(p=m>>>3,m>>>0<256)if(h=v[M+8>>2]|0,c=v[M+12>>2]|0,(c|0)==(h|0)){v[5857]=v[5857]&~(1<<p),k=M,c=S;break}else{v[h+12>>2]=c,v[c+8>>2]=h,k=M,c=S;break}E=v[M+24>>2]|0,h=v[M+12>>2]|0;do if((h|0)==(M|0)){if(c=M+16|0,p=c+4|0,h=v[p>>2]|0,h)c=p;else if(h=v[c>>2]|0,!h){h=0;break}for(;;)if(m=h+20|0,p=v[m>>2]|0,p)h=p,c=m;else if(m=h+16|0,p=v[m>>2]|0,p)h=p,c=m;else break;v[c>>2]=0}else k=v[M+8>>2]|0,v[k+12>>2]=h,v[h+8>>2]=k;while(0);if(E){if(c=v[M+28>>2]|0,p=23732+(c<<2)|0,(v[p>>2]|0)==(M|0)){if(v[p>>2]=h,!h){v[5858]=v[5858]&~(1<<c),k=M,c=S;break}}else if(k=E+16|0,v[((v[k>>2]|0)==(M|0)?k:E+20|0)>>2]=h,!h){k=M,c=S;break}v[h+24>>2]=E,c=M+16|0,p=v[c>>2]|0,p|0&&(v[h+16>>2]=p,v[p+24>>2]=h),c=v[c+4>>2]|0,c?(v[h+20>>2]=c,v[c+24>>2]=h,k=M,c=S):(k=M,c=S)}else k=M,c=S}while(0);if(!(M>>>0>=V>>>0)&&(h=V+4|0,m=v[h>>2]|0,!!(m&1))){if(m&2)v[h>>2]=m&-2,v[k+4>>2]=c|1,v[M+c>>2]=c,E=c;else{if((v[5863]|0)==(V|0)){if(V=(v[5860]|0)+c|0,v[5860]=V,v[5863]=k,v[k+4>>2]=V|1,(k|0)!=(v[5862]|0))return;v[5862]=0,v[5859]=0;return}if((v[5862]|0)==(V|0)){V=(v[5859]|0)+c|0,v[5859]=V,v[5862]=M,v[k+4>>2]=V|1,v[M+V>>2]=V;return}E=(m&-8)+c|0,p=m>>>3;do if(m>>>0<256)if(c=v[V+8>>2]|0,h=v[V+12>>2]|0,(h|0)==(c|0)){v[5857]=v[5857]&~(1<<p);break}else{v[c+12>>2]=h,v[h+8>>2]=c;break}else{S=v[V+24>>2]|0,h=v[V+12>>2]|0;do if((h|0)==(V|0)){if(c=V+16|0,p=c+4|0,h=v[p>>2]|0,h)c=p;else if(h=v[c>>2]|0,!h){p=0;break}for(;;)if(m=h+20|0,p=v[m>>2]|0,p)h=p,c=m;else if(m=h+16|0,p=v[m>>2]|0,p)h=p,c=m;else break;v[c>>2]=0,p=h}else p=v[V+8>>2]|0,v[p+12>>2]=h,v[h+8>>2]=p,p=h;while(0);if(S|0){if(h=v[V+28>>2]|0,c=23732+(h<<2)|0,(v[c>>2]|0)==(V|0)){if(v[c>>2]=p,!p){v[5858]=v[5858]&~(1<<h);break}}else if(m=S+16|0,v[((v[m>>2]|0)==(V|0)?m:S+20|0)>>2]=p,!p)break;v[p+24>>2]=S,h=V+16|0,c=v[h>>2]|0,c|0&&(v[p+16>>2]=c,v[c+24>>2]=p),h=v[h+4>>2]|0,h|0&&(v[p+20>>2]=h,v[h+24>>2]=p)}}while(0);if(v[k+4>>2]=E|1,v[M+E>>2]=E,(k|0)==(v[5862]|0)){v[5859]=E;return}}if(h=E>>>3,E>>>0<256){p=23468+(h<<1<<2)|0,c=v[5857]|0,h=1<<h,c&h?(c=p+8|0,h=v[c>>2]|0):(v[5857]=c|h,h=p,c=p+8|0),v[c>>2]=k,v[h+12>>2]=k,v[k+8>>2]=h,v[k+12>>2]=p;return}h=E>>>8,h?E>>>0>16777215?m=31:(M=(h+1048320|0)>>>16&8,V=h<<M,S=(V+520192|0)>>>16&4,V=V<<S,m=(V+245760|0)>>>16&2,m=14-(S|M|m)+(V<<m>>>15)|0,m=E>>>(m+7|0)&1|m<<1):m=0,h=23732+(m<<2)|0,v[k+28>>2]=m,v[k+20>>2]=0,v[k+16>>2]=0,c=v[5858]|0,p=1<<m;e:do if(!(c&p))v[5858]=c|p,v[h>>2]=k,v[k+24>>2]=h,v[k+12>>2]=k,v[k+8>>2]=k;else{h=v[h>>2]|0;t:do if((v[h+4>>2]&-8|0)!=(E|0)){for(m=E<<((m|0)==31?0:25-(m>>>1)|0);p=h+16+(m>>>31<<2)|0,c=v[p>>2]|0,!!c;)if((v[c+4>>2]&-8|0)==(E|0)){h=c;break t}else m=m<<1,h=c;v[p>>2]=k,v[k+24>>2]=h,v[k+12>>2]=k,v[k+8>>2]=k;break e}while(0);M=h+8|0,V=v[M>>2]|0,v[V+12>>2]=k,v[M>>2]=k,v[k+8>>2]=V,v[k+12>>2]=h,v[k+24>>2]=0}while(0);if(V=(v[5865]|0)+-1|0,v[5865]=V,!(V|0)){for(h=23884;h=v[h>>2]|0,h;)h=h+8|0;v[5865]=-1}}}}function ga(h,c){h=h|0,c=c|0;var p=0;return h?(p=wi(c,h)|0,(c|h)>>>0>65535&&(p=((p>>>0)/(h>>>0)|0|0)==(c|0)?p:-1)):p=0,h=Ua(p)|0,!h||!(v[h+-4>>2]&3)||St(h|0,0,p|0)|0,h|0}function un(h,c,p,m){return h=h|0,c=c|0,p=p|0,m=m|0,p=h+p>>>0,Bi(c+m+(p>>>0<h>>>0|0)>>>0|0),p|0|0}function Aa(h,c,p,m){return h=h|0,c=c|0,p=p|0,m=m|0,m=c-m-(p>>>0>h>>>0|0)>>>0,Bi(m|0),h-p>>>0|0|0}function ra(h){return h=h|0,(h?31-(al(h^h-1)|0)|0:32)|0}function Rn(h,c,p,m,E){h=h|0,c=c|0,p=p|0,m=m|0,E=E|0;var S=0,M=0,k=0,V=0,te=0,ve=0,Ne=0,ut=0,gt=0,rt=0;if(ve=h,V=c,te=V,M=p,ut=m,k=ut,!te)return S=(E|0)!=0,k?S?(v[E>>2]=h|0,v[E+4>>2]=c&0,ut=0,E=0,Bi(ut|0),E|0):(ut=0,E=0,Bi(ut|0),E|0):(S&&(v[E>>2]=(ve>>>0)%(M>>>0),v[E+4>>2]=0),ut=0,E=(ve>>>0)/(M>>>0)>>>0,Bi(ut|0),E|0);S=(k|0)==0;do if(M){if(!S){if(S=(al(k|0)|0)-(al(te|0)|0)|0,S>>>0<=31){Ne=S+1|0,k=31-S|0,c=S-31>>31,M=Ne,h=ve>>>(Ne>>>0)&c|te<<k,c=te>>>(Ne>>>0)&c,S=0,k=ve<<k;break}return E?(v[E>>2]=h|0,v[E+4>>2]=V|c&0,ut=0,E=0,Bi(ut|0),E|0):(ut=0,E=0,Bi(ut|0),E|0)}if(S=M-1|0,S&M|0){k=(al(M|0)|0)+33-(al(te|0)|0)|0,rt=64-k|0,Ne=32-k|0,V=Ne>>31,gt=k-32|0,c=gt>>31,M=k,h=Ne-1>>31&te>>>(gt>>>0)|(te<<Ne|ve>>>(k>>>0))&c,c=c&te>>>(k>>>0),S=ve<<rt&V,k=(te<<rt|ve>>>(gt>>>0))&V|ve<<Ne&k-33>>31;break}return E|0&&(v[E>>2]=S&ve,v[E+4>>2]=0),(M|0)==1?(gt=V|c&0,rt=h|0|0,Bi(gt|0),rt|0):(rt=ra(M|0)|0,gt=te>>>(rt>>>0)|0,rt=te<<32-rt|ve>>>(rt>>>0)|0,Bi(gt|0),rt|0)}else{if(S)return E|0&&(v[E>>2]=(te>>>0)%(M>>>0),v[E+4>>2]=0),gt=0,rt=(te>>>0)/(M>>>0)>>>0,Bi(gt|0),rt|0;if(!ve)return E|0&&(v[E>>2]=0,v[E+4>>2]=(te>>>0)%(k>>>0)),gt=0,rt=(te>>>0)/(k>>>0)>>>0,Bi(gt|0),rt|0;if(S=k-1|0,!(S&k))return E|0&&(v[E>>2]=h|0,v[E+4>>2]=S&te|c&0),gt=0,rt=te>>>((ra(k|0)|0)>>>0),Bi(gt|0),rt|0;if(S=(al(k|0)|0)-(al(te|0)|0)|0,S>>>0<=30){c=S+1|0,k=31-S|0,M=c,h=te<<k|ve>>>(c>>>0),c=te>>>(c>>>0),S=0,k=ve<<k;break}return E?(v[E>>2]=h|0,v[E+4>>2]=V|c&0,gt=0,rt=0,Bi(gt|0),rt|0):(gt=0,rt=0,Bi(gt|0),rt|0)}while(0);if(!M)te=k,V=0,k=0;else{Ne=p|0|0,ve=ut|m&0,te=un(Ne|0,ve|0,-1,-1)|0,p=lt()|0,V=k,k=0;do m=V,V=S>>>31|V<<1,S=k|S<<1,m=h<<1|m>>>31|0,ut=h>>>31|c<<1|0,Aa(te|0,p|0,m|0,ut|0)|0,rt=lt()|0,gt=rt>>31|((rt|0)<0?-1:0)<<1,k=gt&1,h=Aa(m|0,ut|0,gt&Ne|0,(((rt|0)<0?-1:0)>>31|((rt|0)<0?-1:0)<<1)&ve|0)|0,c=lt()|0,M=M-1|0;while(M|0);te=V,V=0}return M=0,E|0&&(v[E>>2]=h,v[E+4>>2]=c),gt=(S|0)>>>31|(te|M)<<1|(M<<1|S>>>31)&0|V,rt=(S<<1|0)&-2|k,Bi(gt|0),rt|0}function gi(h,c,p,m){h=h|0,c=c|0,p=p|0,m=m|0;var E=0,S=0,M=0,k=0,V=0,te=0;return te=c>>31|((c|0)<0?-1:0)<<1,V=((c|0)<0?-1:0)>>31|((c|0)<0?-1:0)<<1,S=m>>31|((m|0)<0?-1:0)<<1,E=((m|0)<0?-1:0)>>31|((m|0)<0?-1:0)<<1,k=Aa(te^h|0,V^c|0,te|0,V|0)|0,M=lt()|0,h=S^te,c=E^V,Aa((Rn(k,M,Aa(S^p|0,E^m|0,S|0,E|0)|0,lt()|0,0)|0)^h|0,(lt()|0)^c|0,h|0,c|0)|0}function dr(h,c){h=h|0,c=c|0;var p=0,m=0,E=0,S=0;return S=h&65535,E=c&65535,p=wi(E,S)|0,m=h>>>16,h=(p>>>16)+(wi(E,m)|0)|0,E=c>>>16,c=wi(E,S)|0,Bi((h>>>16)+(wi(E,m)|0)+(((h&65535)+c|0)>>>16)|0),h+c<<16|p&65535|0|0}function Ri(h,c,p,m){h=h|0,c=c|0,p=p|0,m=m|0;var E=0,S=0;return E=h,S=p,p=dr(E,S)|0,h=lt()|0,Bi((wi(c,S)|0)+(wi(m,E)|0)+h|h&0|0),p|0|0|0}function Xt(h,c,p,m){h=h|0,c=c|0,p=p|0,m=m|0;var E=0,S=0,M=0,k=0,V=0,te=0;return E=et,et=et+16|0,k=E|0,M=c>>31|((c|0)<0?-1:0)<<1,S=((c|0)<0?-1:0)>>31|((c|0)<0?-1:0)<<1,te=m>>31|((m|0)<0?-1:0)<<1,V=((m|0)<0?-1:0)>>31|((m|0)<0?-1:0)<<1,h=Aa(M^h|0,S^c|0,M|0,S|0)|0,c=lt()|0,Rn(h,c,Aa(te^p|0,V^m|0,te|0,V|0)|0,lt()|0,k)|0,m=Aa(v[k>>2]^M|0,v[k+4>>2]^S|0,M|0,S|0)|0,p=lt()|0,et=E,Bi(p|0),m|0}function es(h,c,p,m){h=h|0,c=c|0,p=p|0,m=m|0;var E=0,S=0;return S=et,et=et+16|0,E=S|0,Rn(h,c,p,m,E)|0,et=S,Bi(v[E+4>>2]|0),v[E>>2]|0|0}function ct(h,c,p){return h=h|0,c=c|0,p=p|0,(p|0)<32?(Bi(c>>p|0),h>>>p|(c&(1<<p)-1)<<32-p):(Bi(((c|0)<0?-1:0)|0),c>>p-32|0)}function ft(h,c,p){return h=h|0,c=c|0,p=p|0,(p|0)<32?(Bi(c>>>p|0),h>>>p|(c&(1<<p)-1)<<32-p):(Bi(0),c>>>p-32|0)}function xt(h,c,p){return h=h|0,c=c|0,p=p|0,(p|0)<32?(Bi(c<<p|(h&(1<<p)-1<<32-p)>>>32-p|0),h<<p):(Bi(h<<p-32|0),0)}function Ur(h,c){return h=+h,c=+c,h!=h?+c:c!=c?+h:+Ue(+h,+c)}function Un(h,c){return h=+h,c=+c,h!=h?+c:c!=c?+h:+An(+h,+c)}function at(h){return h=+h,h>=0?+xo(h+.5):+Fi(h-.5)}function We(h,c,p){h=h|0,c=c|0,p=p|0;var m=0,E=0,S=0;if((p|0)>=8192)return xc(h|0,c|0,p|0)|0,h|0;if(S=h|0,E=h+p|0,(h&3)==(c&3)){for(;h&3;){if(!p)return S|0;gr[h>>0]=gr[c>>0]|0,h=h+1|0,c=c+1|0,p=p-1|0}for(p=E&-4|0,m=p-64|0;(h|0)<=(m|0);)v[h>>2]=v[c>>2],v[h+4>>2]=v[c+4>>2],v[h+8>>2]=v[c+8>>2],v[h+12>>2]=v[c+12>>2],v[h+16>>2]=v[c+16>>2],v[h+20>>2]=v[c+20>>2],v[h+24>>2]=v[c+24>>2],v[h+28>>2]=v[c+28>>2],v[h+32>>2]=v[c+32>>2],v[h+36>>2]=v[c+36>>2],v[h+40>>2]=v[c+40>>2],v[h+44>>2]=v[c+44>>2],v[h+48>>2]=v[c+48>>2],v[h+52>>2]=v[c+52>>2],v[h+56>>2]=v[c+56>>2],v[h+60>>2]=v[c+60>>2],h=h+64|0,c=c+64|0;for(;(h|0)<(p|0);)v[h>>2]=v[c>>2],h=h+4|0,c=c+4|0}else for(p=E-4|0;(h|0)<(p|0);)gr[h>>0]=gr[c>>0]|0,gr[h+1>>0]=gr[c+1>>0]|0,gr[h+2>>0]=gr[c+2>>0]|0,gr[h+3>>0]=gr[c+3>>0]|0,h=h+4|0,c=c+4|0;for(;(h|0)<(E|0);)gr[h>>0]=gr[c>>0]|0,h=h+1|0,c=c+1|0;return S|0}function St(h,c,p){h=h|0,c=c|0,p=p|0;var m=0,E=0,S=0,M=0;if(S=h+p|0,c=c&255,(p|0)>=67){for(;h&3;)gr[h>>0]=c,h=h+1|0;for(m=S&-4|0,M=c|c<<8|c<<16|c<<24,E=m-64|0;(h|0)<=(E|0);)v[h>>2]=M,v[h+4>>2]=M,v[h+8>>2]=M,v[h+12>>2]=M,v[h+16>>2]=M,v[h+20>>2]=M,v[h+24>>2]=M,v[h+28>>2]=M,v[h+32>>2]=M,v[h+36>>2]=M,v[h+40>>2]=M,v[h+44>>2]=M,v[h+48>>2]=M,v[h+52>>2]=M,v[h+56>>2]=M,v[h+60>>2]=M,h=h+64|0;for(;(h|0)<(m|0);)v[h>>2]=M,h=h+4|0}for(;(h|0)<(S|0);)gr[h>>0]=c,h=h+1|0;return S-p|0}function kt(h){return h=+h,h>=0?+xo(h+.5):+Fi(h-.5)}function Ft(h){h=h|0;var c=0,p=0,m=0;return m=xh()|0,p=v[ao>>2]|0,c=p+h|0,(h|0)>0&(c|0)<(p|0)|(c|0)<0?(tf(c|0)|0,_c(12),-1):(c|0)>(m|0)&&!(o0(c|0)|0)?(_c(12),-1):(v[ao>>2]=c,p|0)}return{___divdi3:gi,___muldi3:Ri,___remdi3:Xt,___uremdi3:es,_areNeighborCells:d0,_bitshift64Ashr:ct,_bitshift64Lshr:ft,_bitshift64Shl:xt,_calloc:ga,_cellAreaKm2:Yl,_cellAreaM2:Qs,_cellAreaRads2:Nc,_cellToBoundary:Rc,_cellToCenterChild:uc,_cellToChildPos:lf,_cellToChildren:Pc,_cellToChildrenSize:Cl,_cellToLatLng:Ps,_cellToLocalIj:sr,_cellToParent:Gl,_cellToVertex:Bn,_cellToVertexes:gn,_cellsToDirectedEdge:Ch,_cellsToLinkedMultiPolygon:c0,_childPosToCell:Cf,_compactCells:Vl,_destroyLinkedMultiPolygon:Ke,_directedEdgeToBoundary:bf,_directedEdgeToCells:oc,_edgeLengthKm:Os,_edgeLengthM:Wf,_edgeLengthRads:vu,_emscripten_replace_memory:Ec,_free:Tn,_getBaseCellNumber:Lc,_getDirectedEdgeDestination:V0,_getDirectedEdgeOrigin:mA,_getHexagonAreaAvgKm2:Tf,_getHexagonAreaAvgM2:$f,_getHexagonEdgeLengthAvgKm:Y0,_getHexagonEdgeLengthAvgM:cf,_getIcosahedronFaces:Tl,_getNumCells:Mf,_getPentagons:uf,_getRes0Cells:Fl,_getResolution:Ul,_greatCircleDistanceKm:cl,_greatCircleDistanceM:wf,_greatCircleDistanceRads:lc,_gridDisk:xf,_gridDiskDistances:z0,_gridDistance:Pr,_gridPathCells:Dr,_gridPathCellsSize:Nr,_gridRingUnsafe:Eh,_i64Add:un,_i64Subtract:Aa,_isPentagon:ha,_isResClassIII:g0,_isValidCell:of,_isValidDirectedEdge:wh,_isValidVertex:Jn,_latLngToCell:sf,_llvm_maxnum_f64:Ur,_llvm_minnum_f64:Un,_llvm_round_f64:at,_localIjToCell:wr,_malloc:Ua,_maxFaceCount:kc,_maxGridDiskSize:u0,_maxPolygonToCellsSize:Bf,_memcpy:We,_memset:St,_originToDirectedEdges:H0,_pentagonCount:m0,_polygonToCells:bc,_readInt64AsDoubleFromPointer:Er,_res0CellCount:Gf,_round:kt,_sbrk:Ft,_sizeOfCellBoundary:tn,_sizeOfCoordIJ:Hr,_sizeOfGeoLoop:mr,_sizeOfGeoPolygon:cn,_sizeOfH3Index:lr,_sizeOfLatLng:Rr,_sizeOfLinkedGeoPolygon:Cr,_uncompactCells:Hl,_uncompactCellsSize:v0,_vertexToLatLng:xi,establishStackSpace:rf,stackAlloc:_f,stackRestore:Nf,stackSave:s0}}(hu,Au,ci),Ja=Ve.___divdi3=zr.___divdi3,mc=Ve.___muldi3=zr.___muldi3,kl=Ve.___remdi3=zr.___remdi3,yo=Ve.___uremdi3=zr.___uremdi3,Nu=Ve._areNeighborCells=zr._areNeighborCells,Eu=Ve._bitshift64Ashr=zr._bitshift64Ashr,qc=Ve._bitshift64Lshr=zr._bitshift64Lshr,vs=Ve._bitshift64Shl=zr._bitshift64Shl,Is=Ve._calloc=zr._calloc,Dl=Ve._cellAreaKm2=zr._cellAreaKm2,el=Ve._cellAreaM2=zr._cellAreaM2,Kc=Ve._cellAreaRads2=zr._cellAreaRads2,Df=Ve._cellToBoundary=zr._cellToBoundary,yl=Ve._cellToCenterChild=zr._cellToCenterChild,bu=Ve._cellToChildPos=zr._cellToChildPos,wo=Ve._cellToChildren=zr._cellToChildren,_l=Ve._cellToChildrenSize=zr._cellToChildrenSize,Zo=Ve._cellToLatLng=zr._cellToLatLng,Su=Ve._cellToLocalIj=zr._cellToLocalIj,Fu=Ve._cellToParent=zr._cellToParent,Jc=Ve._cellToVertex=zr._cellToVertex,xl=Ve._cellToVertexes=zr._cellToVertexes,Bu=Ve._cellsToDirectedEdge=zr._cellsToDirectedEdge,pu=Ve._cellsToLinkedMultiPolygon=zr._cellsToLinkedMultiPolygon,_o=Ve._childPosToCell=zr._childPosToCell,Cu=Ve._compactCells=zr._compactCells,ho=Ve._destroyLinkedMultiPolygon=zr._destroyLinkedMultiPolygon,a0=Ve._directedEdgeToBoundary=zr._directedEdgeToBoundary,tl=Ve._directedEdgeToCells=zr._directedEdgeToCells,rc=Ve._edgeLengthKm=zr._edgeLengthKm,zo=Ve._edgeLengthM=zr._edgeLengthM,Qo=Ve._edgeLengthRads=zr._edgeLengthRads,Gs=Ve._emscripten_replace_memory=zr._emscripten_replace_memory,js=Ve._free=zr._free,yc=Ve._getBaseCellNumber=zr._getBaseCellNumber,Ls=Ve._getDirectedEdgeDestination=zr._getDirectedEdgeDestination,El=Ve._getDirectedEdgeOrigin=zr._getDirectedEdgeOrigin,To=Ve._getHexagonAreaAvgKm2=zr._getHexagonAreaAvgKm2,Vs=Ve._getHexagonAreaAvgM2=zr._getHexagonAreaAvgM2,Va=Ve._getHexagonEdgeLengthAvgKm=zr._getHexagonEdgeLengthAvgKm,ur=Ve._getHexagonEdgeLengthAvgM=zr._getHexagonEdgeLengthAvgM,bt=Ve._getIcosahedronFaces=zr._getIcosahedronFaces,Ce=Ve._getNumCells=zr._getNumCells,Hs=Ve._getPentagons=zr._getPentagons,nt=Ve._getRes0Cells=zr._getRes0Cells,rl=Ve._getResolution=zr._getResolution,xa=Ve._greatCircleDistanceKm=zr._greatCircleDistanceKm,$s=Ve._greatCircleDistanceM=zr._greatCircleDistanceM,ai=Ve._greatCircleDistanceRads=zr._greatCircleDistanceRads,ca=Ve._gridDisk=zr._gridDisk,bi=Ve._gridDiskDistances=zr._gridDiskDistances,$a=Ve._gridDistance=zr._gridDistance,Ii=Ve._gridPathCells=zr._gridPathCells,Hn=Ve._gridPathCellsSize=zr._gridPathCellsSize,mi=Ve._gridRingUnsafe=zr._gridRingUnsafe,Wi=Ve._i64Add=zr._i64Add,_i=Ve._i64Subtract=zr._i64Subtract,di=Ve._isPentagon=zr._isPentagon,wn=Ve._isResClassIII=zr._isResClassIII,Yn=Ve._isValidCell=zr._isValidCell,Li=Ve._isValidDirectedEdge=zr._isValidDirectedEdge,qn=Ve._isValidVertex=zr._isValidVertex,Ui=Ve._latLngToCell=zr._latLngToCell,Gi=Ve._llvm_maxnum_f64=zr._llvm_maxnum_f64,Nn=Ve._llvm_minnum_f64=zr._llvm_minnum_f64,Yi=Ve._llvm_round_f64=zr._llvm_round_f64,$n=Ve._localIjToCell=zr._localIjToCell,Pi=Ve._malloc=zr._malloc,Oi=Ve._maxFaceCount=zr._maxFaceCount,Qi=Ve._maxGridDiskSize=zr._maxGridDiskSize,qi=Ve._maxPolygonToCellsSize=zr._maxPolygonToCellsSize,hi=Ve._memcpy=zr._memcpy,Si=Ve._memset=zr._memset,Ci=Ve._originToDirectedEdges=zr._originToDirectedEdges,ji=Ve._pentagonCount=zr._pentagonCount,si=Ve._polygonToCells=zr._polygonToCells,wu=Ve._readInt64AsDoubleFromPointer=zr._readInt64AsDoubleFromPointer,qo=Ve._res0CellCount=zr._res0CellCount,nl=Ve._round=zr._round,Zu=Ve._sbrk=zr._sbrk,Fn=Ve._sizeOfCellBoundary=zr._sizeOfCellBoundary,Ko=Ve._sizeOfCoordIJ=zr._sizeOfCoordIJ,Ws=Ve._sizeOfGeoLoop=zr._sizeOfGeoLoop,du=Ve._sizeOfGeoPolygon=zr._sizeOfGeoPolygon,gs=Ve._sizeOfH3Index=zr._sizeOfH3Index,bl=Ve._sizeOfLatLng=zr._sizeOfLatLng,ms=Ve._sizeOfLinkedGeoPolygon=zr._sizeOfLinkedGeoPolygon,ka=Ve._uncompactCells=zr._uncompactCells,il=Ve._uncompactCellsSize=zr._uncompactCellsSize,ef=Ve._vertexToLatLng=zr._vertexToLatLng,o=Ve.establishStackSpace=zr.establishStackSpace,s=Ve.stackAlloc=zr.stackAlloc,d=Ve.stackRestore=zr.stackRestore,_=Ve.stackSave=zr.stackSave;if(Ve.asm=zr,Ve.cwrap=gf,Ve.setValue=ws,Ve.getValue=Xc,As){Ts(As)||(As=zt(As));{n0("memory initializer");var w=function(ot){ot.byteLength&&(ot=new Uint8Array(ot)),Ha.set(ot,is),Ve.memoryInitializerRequest&&delete Ve.memoryInitializerRequest.response,fi("memory initializer")},j=function(){hr(As,w,function(){throw"could not load memory initializer "+As})},re=Xo(As);if(re)w(re.buffer);else if(Ve.memoryInitializerRequest){var Pe=function(){var ot=Ve.memoryInitializerRequest,Zt=ot.response;if(ot.status!==200&&ot.status!==0){var Jt=Xo(Ve.memoryInitializerRequestURL);if(Jt)Zt=Jt.buffer;else{console.warn("a problem seems to have happened with Module.memoryInitializerRequest, status: "+ot.status+", retrying "+As),j();return}}w(Zt)};Ve.memoryInitializerRequest.response?setTimeout(Pe,0):Ve.memoryInitializerRequest.addEventListener("load",Pe)}else j()}}var tt;Do=function ot(){tt||It(),tt||(Do=ot)};function It(ot){if(ot=ot||Be,na>0||(vl(),na>0))return;function Zt(){tt||(tt=!0,!Zs&&(ec(),Ka(),Ve.onRuntimeInitialized&&Ve.onRuntimeInitialized(),hs()))}Ve.setStatus?(Ve.setStatus("Running..."),setTimeout(function(){setTimeout(function(){Ve.setStatus("")},1),Zt()},1)):Zt()}Ve.run=It;function tr(ot){throw Ve.onAbort&&Ve.onAbort(ot),ot+="",Lr(ot),dn(ot),Zs=!0,"abort("+ot+"). Build with -s ASSERTIONS=1 for more info."}if(Ve.abort=tr,Ve.preInit)for(typeof Ve.preInit=="function"&&(Ve.preInit=[Ve.preInit]);Ve.preInit.length>0;)Ve.preInit.pop()();return It(),Mt}(typeof P=="object"?P:{}),D="number",G=D,Z=D,F=D,z=D,q=D,ee=D,fe=[["sizeOfH3Index",D],["sizeOfLatLng",D],["sizeOfCellBoundary",D],["sizeOfGeoLoop",D],["sizeOfGeoPolygon",D],["sizeOfLinkedGeoPolygon",D],["sizeOfCoordIJ",D],["readInt64AsDoubleFromPointer",D],["isValidCell",Z,[F,z]],["latLngToCell",G,[D,D,q,ee]],["cellToLatLng",G,[F,z,ee]],["cellToBoundary",G,[F,z,ee]],["maxGridDiskSize",G,[D,ee]],["gridDisk",G,[F,z,D,ee]],["gridDiskDistances",G,[F,z,D,ee,ee]],["gridRingUnsafe",G,[F,z,D,ee]],["maxPolygonToCellsSize",G,[ee,q,D,ee]],["polygonToCells",G,[ee,q,D,ee]],["cellsToLinkedMultiPolygon",G,[ee,D,ee]],["destroyLinkedMultiPolygon",null,[ee]],["compactCells",G,[ee,ee,D,D]],["uncompactCells",G,[ee,D,D,ee,D,q]],["uncompactCellsSize",G,[ee,D,D,q,ee]],["isPentagon",Z,[F,z]],["isResClassIII",Z,[F,z]],["getBaseCellNumber",D,[F,z]],["getResolution",D,[F,z]],["maxFaceCount",G,[F,z,ee]],["getIcosahedronFaces",G,[F,z,ee]],["cellToParent",G,[F,z,q,ee]],["cellToChildren",G,[F,z,q,ee]],["cellToCenterChild",G,[F,z,q,ee]],["cellToChildrenSize",G,[F,z,q,ee]],["cellToChildPos",G,[F,z,q,ee]],["childPosToCell",G,[D,D,F,z,q,ee]],["areNeighborCells",G,[F,z,F,z,ee]],["cellsToDirectedEdge",G,[F,z,F,z,ee]],["getDirectedEdgeOrigin",G,[F,z,ee]],["getDirectedEdgeDestination",G,[F,z,ee]],["isValidDirectedEdge",Z,[F,z]],["directedEdgeToCells",G,[F,z,ee]],["originToDirectedEdges",G,[F,z,ee]],["directedEdgeToBoundary",G,[F,z,ee]],["gridDistance",G,[F,z,F,z,ee]],["gridPathCells",G,[F,z,F,z,ee]],["gridPathCellsSize",G,[F,z,F,z,ee]],["cellToLocalIj",G,[F,z,F,z,D,ee]],["localIjToCell",G,[F,z,ee,D,ee]],["getHexagonAreaAvgM2",G,[q,ee]],["getHexagonAreaAvgKm2",G,[q,ee]],["getHexagonEdgeLengthAvgM",G,[q,ee]],["getHexagonEdgeLengthAvgKm",G,[q,ee]],["greatCircleDistanceM",D,[ee,ee]],["greatCircleDistanceKm",D,[ee,ee]],["greatCircleDistanceRads",D,[ee,ee]],["cellAreaM2",G,[F,z,ee]],["cellAreaKm2",G,[F,z,ee]],["cellAreaRads2",G,[F,z,ee]],["edgeLengthM",G,[F,z,ee]],["edgeLengthKm",G,[F,z,ee]],["edgeLengthRads",G,[F,z,ee]],["getNumCells",G,[q,ee]],["getRes0Cells",G,[ee]],["res0CellCount",D],["getPentagons",G,[D,ee]],["pentagonCount",D],["cellToVertex",G,[F,z,D,ee]],["cellToVertexes",G,[F,z,ee]],["vertexToLatLng",G,[F,z,ee]],["isValidVertex",Z,[F,z]]],be=0,Ie=1,Oe=2,He=3,st=4,De=5,je=6,we=7,Te=8,le=9,Re=10,ye=11,_e=12,ne=13,Y=14,Le=15,de={};de[be]="Success",de[Ie]="The operation failed but a more specific error is not available",de[Oe]="Argument was outside of acceptable range",de[He]="Latitude or longitude arguments were outside of acceptable range",de[st]="Resolution argument was outside of acceptable range",de[De]="Cell argument was not valid",de[je]="Directed edge argument was not valid",de[we]="Undirected edge argument was not valid",de[Te]="Vertex argument was not valid",de[le]="Pentagon distortion was encountered",de[Re]="Duplicate input",de[ye]="Cell arguments were not neighbors",de[_e]="Cell arguments had incompatible resolutions",de[ne]="Memory allocation failed",de[Y]="Bounds of provided memory were insufficient",de[Le]="Mode or flags argument was not valid";var Ee=1e3,ge=1001,X=1002,Me={};Me[Ee]="Unknown unit",Me[ge]="Array length out of bounds",Me[X]="Got unexpected null value for H3 index";var Ae="Unknown error";function me(Mt,Ve,Gt){var ce=Gt&&"value"in Gt,Be=new Error((Mt[Ve]||Ae)+" (code: "+Ve+(ce?", value: "+Gt.value:"")+")");return Be.code=Ve,Be}function ue(Mt,Ve){var Gt=arguments.length===2?{value:Ve}:{};return me(de,Mt,Gt)}function ke(Mt,Ve){var Gt=arguments.length===2?{value:Ve}:{};return me(Me,Mt,Gt)}function Ze(Mt){if(Mt!==0)throw ue(Mt)}var oe={};fe.forEach(function(Ve){oe[Ve[0]]=P.cwrap.apply(P,Ve)});var Dt=16,Rt=0,cr=4,Ut=4,$r=8,ln=8,Sr=oe.sizeOfH3Index(),Qr=oe.sizeOfLatLng(),Jr=oe.sizeOfCellBoundary(),_r=oe.sizeOfGeoPolygon(),Gn=oe.sizeOfGeoLoop(),ti=oe.sizeOfLinkedGeoPolygon(),Vn=oe.sizeOfCoordIJ(),Xr={m:"m",m2:"m2",km:"km",km2:"km2",rads:"rads",rads2:"rads2"};function sn(Mt){if(typeof Mt!="number"||Mt<0||Mt>15||Math.floor(Mt)!==Mt)throw ue(st,Mt);return Mt}function _n(Mt){if(!Mt)throw ke(X);return Mt}var Di=Math.pow(2,32)-1;function ri(Mt){if(Mt>Di)throw ke(ge,Mt);return Mt}var Pt=/[^0-9a-fA-F]/;function J(Mt){if(Array.isArray(Mt)&&Mt.length===2&&Number.isInteger(Mt[0])&&Number.isInteger(Mt[1]))return Mt;if(typeof Mt!="string"||Pt.test(Mt))return[0,0];var Ve=parseInt(Mt.substring(0,Mt.length-8),Dt),Gt=parseInt(Mt.substring(Mt.length-8),Dt);return[Gt,Ve]}function ze(Mt){if(Mt>=0)return Mt.toString(Dt);Mt=Mt&2147483647;var Ve=At(8,Mt.toString(Dt)),Gt=(parseInt(Ve[0],Dt)+8).toString(Dt);return Ve=Gt+Ve.substring(1),Ve}function $e(Mt,Ve){return ze(Ve)+At(8,ze(Mt))}function At(Mt,Ve){for(var Gt=Mt-Ve.length,ce="",Be=0;Be<Gt;Be++)ce+="0";return ce=ce+Ve,ce}var Lt=Math.pow(2,32);function wt(Mt){return typeof Mt!="number"?[0,0]:[Mt|0,Mt/Lt|0]}function yr(Mt,Ve,Gt){for(var ce=Mt.length,Be=P._calloc(ce,Qr),Ye=Gt?1:0,zt=Gt?0:1,hr=0;hr<ce*2;hr+=2)P.HEAPF64.set([Mt[hr/2][Ye],Mt[hr/2][zt]].map(ku),Be/$r+hr);return P.HEAPU32.set([ce,Be],Ve/cr),Ve}function vt(Mt,Ve){var Gt=Mt.length-1,ce=P._calloc(_r),Be=0,Ye=Be+Gn,zt=Ye+cr;yr(Mt[0],ce+Be,Ve);var hr;if(Gt>0){hr=P._calloc(Gt,Gn);for(var Lr=0;Lr<Gt;Lr++)yr(Mt[Lr+1],hr+Gn*Lr,Ve)}return P.setValue(ce+Ye,Gt,"i32"),P.setValue(ce+zt,hr,"i32"),ce}function Tt(Mt){var Ve=0,Gt=Ve+Gn,ce=Gt+cr,Be=cr;P._free(P.getValue(Mt+Ve+Be,"i8*"));var Ye=P.getValue(Mt+Gt,"i32");if(Ye>0){for(var zt=P.getValue(Mt+ce,"i32"),hr=0;hr<Ye;hr++)P._free(P.getValue(zt+Gn*hr+Be,"i8*"));P._free(zt)}P._free(Mt)}function Qt(Mt,Ve){Ve===void 0&&(Ve=0);var Gt=P.getValue(Mt+Sr*Ve,"i32"),ce=P.getValue(Mt+Sr*Ve+cr,"i32");return ce?$e(Gt,ce):null}function xr(Mt,Ve){Ve===void 0&&(Ve=0);var Gt=P.getValue(Mt+cr*Ve,"i32");return!!Gt}function kr(Mt,Ve){return Ve===void 0&&(Ve=0),P.getValue(Mt+$r*Ve,"double")}function Wr(Mt){return oe.readInt64AsDoubleFromPointer(Mt)}function an(Mt,Ve,Gt){P.HEAPU32.set(J(Mt),Ve/cr+2*Gt)}function Br(Mt,Ve){for(var Gt=[],ce=0;ce<Ve;ce++){var Be=Qt(Mt,ce);Be!==null&&Gt.push(Be)}return Gt}function en(Mt,Ve){for(var Gt=Ve.length,ce=0;ce<Gt;ce++)an(Ve[ce],Mt,ce)}function Zn(Mt,Ve){var Gt=P._calloc(1,Qr);return P.HEAPF64.set([Mt,Ve].map(ku),Gt/$r),Gt}function zn(Mt){return ns(P.getValue(Mt,"double"))}function li(Mt){return[zn(Mt),zn(Mt+$r)]}function sa(Mt){return[zn(Mt+$r),zn(Mt)]}function Oa(Mt,Ve,Gt){for(var ce=P.getValue(Mt,"i32"),Be=Mt+$r,Ye=[],zt=Ve?sa:li,hr=0;hr<ce*2;hr+=2)Ye.push(zt(Be+$r*hr));return Gt&&Ye.push(Ye[0]),Ye}function Gr(Mt,Ve){for(var Gt=[],ce=Ve?sa:li,Be,Ye,zt,hr;Mt;){for(Gt.push(Be=[]),Ye=P.getValue(Mt,"i8*");Ye;){for(Be.push(zt=[]),hr=P.getValue(Ye,"i8*");hr;)zt.push(ce(hr)),hr=P.getValue(hr+$r*2,"i8*");Ve&&zt.push(zt[0]),Ye=P.getValue(Ye+Ut*2,"i8*")}Mt=P.getValue(Mt+Ut*2,"i8*")}return Gt}function Ds(Mt){return{i:P.getValue(Mt,"i32"),j:P.getValue(Mt+cr,"i32")}}function Co(Mt,Ve){var Gt=Ve.i,ce=Ve.j;P.setValue(Mt,Gt,"i32"),P.setValue(Mt+cr,ce,"i32")}function xn(Mt,Ve){for(var Gt=[],ce=0;ce<Ve;ce++){var Be=P.getValue(Mt+cr*ce,"i32");Be>=0&&Gt.push(Be)}return Gt}function xs(Mt){var Ve=J(Mt),Gt=Ve[0],ce=Ve[1];return!!oe.isValidCell(Gt,ce)}function go(Mt){var Ve=J(Mt),Gt=Ve[0],ce=Ve[1];return!!oe.isPentagon(Gt,ce)}function Ns(Mt){var Ve=J(Mt),Gt=Ve[0],ce=Ve[1];return!!oe.isResClassIII(Gt,ce)}function Po(Mt){var Ve=J(Mt),Gt=Ve[0],ce=Ve[1];return oe.getBaseCellNumber(Gt,ce)}function hl(Mt){var Ve=J(Mt),Gt=Ve[0],ce=Ve[1],Be=P._malloc(cr);try{Ze(oe.maxFaceCount(Gt,ce,Be));var Ye=P.getValue(Be,"i32"),zt=P._malloc(cr*Ye);try{return Ze(oe.getIcosahedronFaces(Gt,ce,zt)),xn(zt,Ye)}finally{P._free(zt)}}finally{P._free(Be)}}function yu(Mt){var Ve=J(Mt),Gt=Ve[0],ce=Ve[1];return oe.isValidCell(Gt,ce)?oe.getResolution(Gt,ce):-1}function Es(Mt,Ve,Gt){var ce=P._malloc(Qr);P.HEAPF64.set([Mt,Ve].map(ku),ce/$r);var Be=P._malloc(Sr);try{return Ze(oe.latLngToCell(ce,Gt,Be)),_n(Qt(Be))}finally{P._free(Be),P._free(ce)}}function fs(Mt){var Ve=P._malloc(Qr),Gt=J(Mt),ce=Gt[0],Be=Gt[1];try{return Ze(oe.cellToLatLng(ce,Be,Ve)),li(Ve)}finally{P._free(Ve)}}function Ou(Mt,Ve){var Gt=P._malloc(Jr),ce=J(Mt),Be=ce[0],Ye=ce[1];try{return Ze(oe.cellToBoundary(Be,Ye,Gt)),Oa(Gt,Ve,Ve)}finally{P._free(Gt)}}function Al(Mt,Ve){var Gt=J(Mt),ce=Gt[0],Be=Gt[1],Ye=P._malloc(Sr);try{return Ze(oe.cellToParent(ce,Be,Ve,Ye)),_n(Qt(Ye))}finally{P._free(Ye)}}function da(Mt,Ve){if(!xs(Mt))return[];var Gt=J(Mt),ce=Gt[0],Be=Gt[1],Ye=ri(Zi(Mt,Ve)),zt=P._calloc(Ye,Sr);try{return Ze(oe.cellToChildren(ce,Be,Ve,zt)),Br(zt,Ye)}finally{P._free(zt)}}function Zi(Mt,Ve){if(!xs(Mt))throw ue(De);var Gt=J(Mt),ce=Gt[0],Be=Gt[1],Ye=P._malloc(ln);try{return Ze(oe.cellToChildrenSize(ce,Be,Ve,Ye)),Wr(Ye)}finally{P._free(Ye)}}function Fs(Mt,Ve){var Gt=J(Mt),ce=Gt[0],Be=Gt[1],Ye=P._malloc(Sr);try{return Ze(oe.cellToCenterChild(ce,Be,Ve,Ye)),_n(Qt(Ye))}finally{P._free(Ye)}}function no(Mt,Ve){var Gt=J(Mt),ce=Gt[0],Be=Gt[1],Ye=P._malloc(ln);try{return Ze(oe.cellToChildPos(ce,Be,Ve,Ye)),Wr(Ye)}finally{P._free(Ye)}}function ts(Mt,Ve,Gt){var ce=wt(Mt),Be=ce[0],Ye=ce[1],zt=J(Ve),hr=zt[0],Lr=zt[1],dn=P._malloc(Sr);try{return Ze(oe.childPosToCell(Be,Ye,hr,Lr,Gt,dn)),_n(Qt(dn))}finally{P._free(dn)}}function Oo(Mt,Ve){var Gt=J(Mt),ce=Gt[0],Be=Gt[1],Ye=P._malloc(ln);try{Ze(oe.maxGridDiskSize(Ve,Ye));var zt=ri(Wr(Ye)),hr=P._calloc(zt,Sr);try{return Ze(oe.gridDisk(ce,Be,Ve,hr)),Br(hr,zt)}finally{P._free(hr)}}finally{P._free(Ye)}}function Ni(Mt,Ve){var Gt=J(Mt),ce=Gt[0],Be=Gt[1],Ye=P._malloc(ln);try{Ze(oe.maxGridDiskSize(Ve,Ye));var zt=ri(Wr(Ye)),hr=P._calloc(zt,Sr),Lr=P._calloc(zt,cr);try{Ze(oe.gridDiskDistances(ce,Be,Ve,hr,Lr));for(var dn=[],Mn=0;Mn<Ve+1;Mn++)dn.push([]);for(var vi=0;vi<zt;vi++){var co=Qt(hr,vi),is=P.getValue(Lr+cr*vi,"i32");co!==null&&dn[is].push(co)}return dn}finally{P._free(hr),P._free(Lr)}}finally{P._free(Ye)}}function io(Mt,Ve){var Gt=Ve===0?1:6*Ve,ce=P._calloc(Gt,Sr);try{return Ze(oe.gridRingUnsafe.apply(oe,J(Mt).concat([Ve],[ce]))),Br(ce,Gt)}finally{P._free(ce)}}function bs(Mt,Ve,Gt){if(sn(Ve),Gt=!!Gt,Mt.length===0||Mt[0].length===0)return[];var ce=typeof Mt[0][0]=="number"?[Mt]:Mt,Be=vt(ce,Gt),Ye=P._malloc(ln);try{Ze(oe.maxPolygonToCellsSize(Be,Ve,0,Ye));var zt=ri(Wr(Ye)),hr=P._calloc(zt,Sr);try{return Ze(oe.polygonToCells(Be,Ve,0,hr)),Br(hr,zt)}finally{P._free(hr)}}finally{P._free(Ye),Tt(Be)}}function Wo(Mt,Ve){if(!Mt||!Mt.length)return[];var Gt=Mt.length,ce=P._calloc(Gt,Sr);en(ce,Mt);var Be=P._calloc(ti);try{return Ze(oe.cellsToLinkedMultiPolygon(ce,Gt,Be)),Gr(Be,Ve)}finally{oe.destroyLinkedMultiPolygon(Be),P._free(Be),P._free(ce)}}function Ru(Mt){if(!Mt||!Mt.length)return[];var Ve=Mt.length,Gt=P._calloc(Ve,Sr);en(Gt,Mt);var ce=P._calloc(Ve,Sr);try{return Ze(oe.compactCells(Gt,ce,Ve,Rt)),Br(ce,Ve)}finally{P._free(Gt),P._free(ce)}}function Sa(Mt,Ve){if(sn(Ve),!Mt||!Mt.length)return[];var Gt=Mt.length,ce=P._calloc(Gt,Sr);en(ce,Mt);var Be=P._malloc(ln);try{Ze(oe.uncompactCellsSize(ce,Gt,Rt,Ve,Be));var Ye=ri(Wr(Be)),zt=P._calloc(Ye,Sr);try{return Ze(oe.uncompactCells(ce,Gt,Rt,zt,Ye,Rt,Ve)),Br(zt,Ye)}finally{P._free(ce),P._free(zt)}}finally{P._free(Be)}}function ya(Mt,Ve){var Gt=J(Mt),ce=Gt[0],Be=Gt[1],Ye=J(Ve),zt=Ye[0],hr=Ye[1],Lr=P._malloc(cr);try{return Ze(oe.areNeighborCells(ce,Be,zt,hr,Lr)),xr(Lr)}finally{P._free(Lr)}}function Ku(Mt,Ve){var Gt=J(Mt),ce=Gt[0],Be=Gt[1],Ye=J(Ve),zt=Ye[0],hr=Ye[1],Lr=P._malloc(Sr);try{return Ze(oe.cellsToDirectedEdge(ce,Be,zt,hr,Lr)),_n(Qt(Lr))}finally{P._free(Lr)}}function uo(Mt){var Ve=J(Mt),Gt=Ve[0],ce=Ve[1],Be=P._malloc(Sr);try{return Ze(oe.getDirectedEdgeOrigin(Gt,ce,Be)),_n(Qt(Be))}finally{P._free(Be)}}function Js(Mt){var Ve=J(Mt),Gt=Ve[0],ce=Ve[1],Be=P._malloc(Sr);try{return Ze(oe.getDirectedEdgeDestination(Gt,ce,Be)),_n(Qt(Be))}finally{P._free(Be)}}function Ca(Mt){var Ve=J(Mt),Gt=Ve[0],ce=Ve[1];return!!oe.isValidDirectedEdge(Gt,ce)}function uu(Mt){var Ve=J(Mt),Gt=Ve[0],ce=Ve[1],Be=2,Ye=P._calloc(Be,Sr);try{return Ze(oe.directedEdgeToCells(Gt,ce,Ye)),Br(Ye,Be)}finally{P._free(Ye)}}function Mr(Mt){var Ve=J(Mt),Gt=Ve[0],ce=Ve[1],Be=6,Ye=P._calloc(Be,Sr);try{return Ze(oe.originToDirectedEdges(Gt,ce,Ye)),Br(Ye,Be)}finally{P._free(Ye)}}function vn(Mt,Ve){var Gt=P._malloc(Jr),ce=J(Mt),Be=ce[0],Ye=ce[1];try{return Ze(oe.directedEdgeToBoundary(Be,Ye,Gt)),Oa(Gt,Ve)}finally{P._free(Gt)}}function lo(Mt,Ve){var Gt=J(Mt),ce=Gt[0],Be=Gt[1],Ye=J(Ve),zt=Ye[0],hr=Ye[1],Lr=P._malloc(ln);try{return Ze(oe.gridDistance(ce,Be,zt,hr,Lr)),Wr(Lr)}finally{P._free(Lr)}}function eu(Mt,Ve){var Gt=J(Mt),ce=Gt[0],Be=Gt[1],Ye=J(Ve),zt=Ye[0],hr=Ye[1],Lr=P._malloc(ln);try{Ze(oe.gridPathCellsSize(ce,Be,zt,hr,Lr));var dn=ri(Wr(Lr)),Mn=P._calloc(dn,Sr);try{return oe.gridPathCells(ce,Be,zt,hr,Mn),Br(Mn,dn)}finally{P._free(Mn)}}finally{P._free(Lr)}}var tu=0;function Ss(Mt,Ve){var Gt=P._malloc(Vn);try{return Ze(oe.cellToLocalIj.apply(oe,J(Mt).concat(J(Ve),[tu],[Gt]))),Ds(Gt)}finally{P._free(Gt)}}function Bs(Mt,Ve){if(!Ve||typeof Ve.i!="number"||typeof Ve.j!="number")throw new Error("Coordinates must be provided as an {i, j} object");var Gt=P._malloc(Vn),ce=P._malloc(Sr);Co(Gt,Ve);try{return Ze(oe.localIjToCell.apply(oe,J(Mt).concat([Gt],[tu],[ce]))),_n(Qt(ce))}finally{P._free(Gt),P._free(ce)}}function ja(Mt,Ve,Gt){var ce=Zn(Mt[0],Mt[1]),Be=Zn(Ve[0],Ve[1]),Ye;switch(Gt){case Xr.m:Ye=oe.greatCircleDistanceM(ce,Be);break;case Xr.km:Ye=oe.greatCircleDistanceKm(ce,Be);break;case Xr.rads:Ye=oe.greatCircleDistanceRads(ce,Be);break;default:Ye=null}if(P._free(ce),P._free(Be),Ye===null)throw ke(Ee,Gt);return Ye}function Yc(Mt,Ve){var Gt=J(Mt),ce=Gt[0],Be=Gt[1],Ye=P._malloc($r);try{switch(Ve){case Xr.m2:Ze(oe.cellAreaM2(ce,Be,Ye));break;case Xr.km2:Ze(oe.cellAreaKm2(ce,Be,Ye));break;case Xr.rads2:Ze(oe.cellAreaRads2(ce,Be,Ye));break;default:throw ke(Ee,Ve)}return kr(Ye)}finally{P._free(Ye)}}function Cs(Mt,Ve){var Gt=J(Mt),ce=Gt[0],Be=Gt[1],Ye=P._malloc($r);try{switch(Ve){case Xr.m:Ze(oe.edgeLengthM(ce,Be,Ye));break;case Xr.km:Ze(oe.edgeLengthKm(ce,Be,Ye));break;case Xr.rads:Ze(oe.edgeLengthRads(ce,Be,Ye));break;default:throw ke(Ee,Ve)}return kr(Ye)}finally{P._free(Ye)}}function rs(Mt,Ve){sn(Mt);var Gt=P._malloc($r);try{switch(Ve){case Xr.m2:Ze(oe.getHexagonAreaAvgM2(Mt,Gt));break;case Xr.km2:Ze(oe.getHexagonAreaAvgKm2(Mt,Gt));break;default:throw ke(Ee,Ve)}return kr(Gt)}finally{P._free(Gt)}}function Ll(Mt,Ve){sn(Mt);var Gt=P._malloc($r);try{switch(Ve){case Xr.m:Ze(oe.getHexagonEdgeLengthAvgM(Mt,Gt));break;case Xr.km:Ze(oe.getHexagonEdgeLengthAvgKm(Mt,Gt));break;default:throw ke(Ee,Ve)}return kr(Gt)}finally{P._free(Gt)}}function zi(Mt,Ve){var Gt=J(Mt),ce=Gt[0],Be=Gt[1],Ye=P._malloc(Sr);try{return Ze(oe.cellToVertex(ce,Be,Ve,Ye)),_n(Qt(Ye))}finally{P._free(Ye)}}function Pl(Mt){var Ve=J(Mt),Gt=Ve[0],ce=Ve[1],Be=6,Ye=P._calloc(Be,Sr);try{return Ze(oe.cellToVertexes(Gt,ce,Ye)),Br(Ye,Be)}finally{P._free(Ye)}}function Ro(Mt){var Ve=P._malloc(Qr),Gt=J(Mt),ce=Gt[0],Be=Gt[1];try{return Ze(oe.vertexToLatLng(ce,Be,Ve)),li(Ve)}finally{P._free(Ve)}}function pl(Mt){var Ve=J(Mt),Gt=Ve[0],ce=Ve[1];return!!oe.isValidVertex(Gt,ce)}function Ai(Mt){sn(Mt);var Ve=P._malloc(ln);try{return Ze(oe.getNumCells(Mt,Ve)),Wr(Ve)}finally{P._free(Ve)}}function _u(){var Mt=oe.res0CellCount(),Ve=P._malloc(Sr*Mt);try{return Ze(oe.getRes0Cells(Ve)),Br(Ve,Mt)}finally{P._free(Ve)}}function vf(Mt){sn(Mt);var Ve=oe.pentagonCount(),Gt=P._malloc(Sr*Ve);try{return Ze(oe.getPentagons(Mt,Gt)),Br(Gt,Ve)}finally{P._free(Gt)}}function ku(Mt){return Mt*Math.PI/180}function ns(Mt){return Mt*180/Math.PI}},83959:function(se,$,C){var P;(function(D,G,Z,F){"use strict";var z=["","webkit","Moz","MS","ms","o"],q=G.createElement("div"),ee="function",fe=Math.round,be=Math.abs,Ie=Date.now;function Oe(ce,Be,Ye){return setTimeout(Re(ce,Ye),Be)}function He(ce,Be,Ye){return Array.isArray(ce)?(st(ce,Ye[Be],Ye),!0):!1}function st(ce,Be,Ye){var zt;if(ce)if(ce.forEach)ce.forEach(Be,Ye);else if(ce.length!==F)for(zt=0;zt<ce.length;)Be.call(Ye,ce[zt],zt,ce),zt++;else for(zt in ce)ce.hasOwnProperty(zt)&&Be.call(Ye,ce[zt],zt,ce)}function De(ce,Be,Ye){var zt="DEPRECATED METHOD: "+Be+`
`+Ye+` AT 
`;return function(){var hr=new Error("get-stack-trace"),Lr=hr&&hr.stack?hr.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",dn=D.console&&(D.console.warn||D.console.log);return dn&&dn.call(D.console,zt,Lr),ce.apply(this,arguments)}}var je;typeof Object.assign!="function"?je=function(Be){if(Be===F||Be===null)throw new TypeError("Cannot convert undefined or null to object");for(var Ye=Object(Be),zt=1;zt<arguments.length;zt++){var hr=arguments[zt];if(hr!==F&&hr!==null)for(var Lr in hr)hr.hasOwnProperty(Lr)&&(Ye[Lr]=hr[Lr])}return Ye}:je=Object.assign;var we=De(function(Be,Ye,zt){for(var hr=Object.keys(Ye),Lr=0;Lr<hr.length;)(!zt||zt&&Be[hr[Lr]]===F)&&(Be[hr[Lr]]=Ye[hr[Lr]]),Lr++;return Be},"extend","Use `assign`."),Te=De(function(Be,Ye){return we(Be,Ye,!0)},"merge","Use `assign`.");function le(ce,Be,Ye){var zt=Be.prototype,hr;hr=ce.prototype=Object.create(zt),hr.constructor=ce,hr._super=zt,Ye&&je(hr,Ye)}function Re(ce,Be){return function(){return ce.apply(Be,arguments)}}function ye(ce,Be){return typeof ce==ee?ce.apply(Be&&Be[0]||F,Be):ce}function _e(ce,Be){return ce===F?Be:ce}function ne(ce,Be,Ye){st(Ee(Be),function(zt){ce.addEventListener(zt,Ye,!1)})}function Y(ce,Be,Ye){st(Ee(Be),function(zt){ce.removeEventListener(zt,Ye,!1)})}function Le(ce,Be){for(;ce;){if(ce==Be)return!0;ce=ce.parentNode}return!1}function de(ce,Be){return ce.indexOf(Be)>-1}function Ee(ce){return ce.trim().split(/\s+/g)}function ge(ce,Be,Ye){if(ce.indexOf&&!Ye)return ce.indexOf(Be);for(var zt=0;zt<ce.length;){if(Ye&&ce[zt][Ye]==Be||!Ye&&ce[zt]===Be)return zt;zt++}return-1}function X(ce){return Array.prototype.slice.call(ce,0)}function Me(ce,Be,Ye){for(var zt=[],hr=[],Lr=0;Lr<ce.length;){var dn=Be?ce[Lr][Be]:ce[Lr];ge(hr,dn)<0&&zt.push(ce[Lr]),hr[Lr]=dn,Lr++}return Ye&&(Be?zt=zt.sort(function(vi,co){return vi[Be]>co[Be]}):zt=zt.sort()),zt}function Ae(ce,Be){for(var Ye,zt,hr=Be[0].toUpperCase()+Be.slice(1),Lr=0;Lr<z.length;){if(Ye=z[Lr],zt=Ye?Ye+hr:Be,zt in ce)return zt;Lr++}return F}var me=1;function ue(){return me++}function ke(ce){var Be=ce.ownerDocument||ce;return Be.defaultView||Be.parentWindow||D}var Ze=/mobile|tablet|ip(ad|hone|od)|android/i,oe="ontouchstart"in D,Dt=Ae(D,"PointerEvent")!==F,Rt=oe&&Ze.test(navigator.userAgent),cr="touch",Ut="pen",$r="mouse",ln="kinect",Sr=25,Qr=1,Jr=2,_r=4,Gn=8,ti=1,Vn=2,Xr=4,sn=8,_n=16,Di=Vn|Xr,ri=sn|_n,Pt=Di|ri,J=["x","y"],ze=["clientX","clientY"];function $e(ce,Be){var Ye=this;this.manager=ce,this.callback=Be,this.element=ce.element,this.target=ce.options.inputTarget,this.domHandler=function(zt){ye(ce.options.enable,[ce])&&Ye.handler(zt)},this.init()}$e.prototype={handler:function(){},init:function(){this.evEl&&ne(this.element,this.evEl,this.domHandler),this.evTarget&&ne(this.target,this.evTarget,this.domHandler),this.evWin&&ne(ke(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&Y(this.element,this.evEl,this.domHandler),this.evTarget&&Y(this.target,this.evTarget,this.domHandler),this.evWin&&Y(ke(this.element),this.evWin,this.domHandler)}};function At(ce){var Be,Ye=ce.options.inputClass;return Ye?Be=Ye:Dt?Be=xn:Rt?Be=fs:oe?Be=Zi:Be=sa,new Be(ce,Lt)}function Lt(ce,Be,Ye){var zt=Ye.pointers.length,hr=Ye.changedPointers.length,Lr=Be&Qr&&zt-hr===0,dn=Be&(_r|Gn)&&zt-hr===0;Ye.isFirst=!!Lr,Ye.isFinal=!!dn,Lr&&(ce.session={}),Ye.eventType=Be,wt(ce,Ye),ce.emit("hammer.input",Ye),ce.recognize(Ye),ce.session.prevInput=Ye}function wt(ce,Be){var Ye=ce.session,zt=Be.pointers,hr=zt.length;Ye.firstInput||(Ye.firstInput=Tt(Be)),hr>1&&!Ye.firstMultiple?Ye.firstMultiple=Tt(Be):hr===1&&(Ye.firstMultiple=!1);var Lr=Ye.firstInput,dn=Ye.firstMultiple,Mn=dn?dn.center:Lr.center,vi=Be.center=Qt(zt);Be.timeStamp=Ie(),Be.deltaTime=Be.timeStamp-Lr.timeStamp,Be.angle=an(Mn,vi),Be.distance=Wr(Mn,vi),yr(Ye,Be),Be.offsetDirection=kr(Be.deltaX,Be.deltaY);var co=xr(Be.deltaTime,Be.deltaX,Be.deltaY);Be.overallVelocityX=co.x,Be.overallVelocityY=co.y,Be.overallVelocity=be(co.x)>be(co.y)?co.x:co.y,Be.scale=dn?en(dn.pointers,zt):1,Be.rotation=dn?Br(dn.pointers,zt):0,Be.maxPointers=Ye.prevInput?Be.pointers.length>Ye.prevInput.maxPointers?Be.pointers.length:Ye.prevInput.maxPointers:Be.pointers.length,vt(Ye,Be);var is=ce.element;Le(Be.srcEvent.target,is)&&(is=Be.srcEvent.target),Be.target=is}function yr(ce,Be){var Ye=Be.center,zt=ce.offsetDelta||{},hr=ce.prevDelta||{},Lr=ce.prevInput||{};(Be.eventType===Qr||Lr.eventType===_r)&&(hr=ce.prevDelta={x:Lr.deltaX||0,y:Lr.deltaY||0},zt=ce.offsetDelta={x:Ye.x,y:Ye.y}),Be.deltaX=hr.x+(Ye.x-zt.x),Be.deltaY=hr.y+(Ye.y-zt.y)}function vt(ce,Be){var Ye=ce.lastInterval||Be,zt=Be.timeStamp-Ye.timeStamp,hr,Lr,dn,Mn;if(Be.eventType!=Gn&&(zt>Sr||Ye.velocity===F)){var vi=Be.deltaX-Ye.deltaX,co=Be.deltaY-Ye.deltaY,is=xr(zt,vi,co);Lr=is.x,dn=is.y,hr=be(is.x)>be(is.y)?is.x:is.y,Mn=kr(vi,co),ce.lastInterval=Be}else hr=Ye.velocity,Lr=Ye.velocityX,dn=Ye.velocityY,Mn=Ye.direction;Be.velocity=hr,Be.velocityX=Lr,Be.velocityY=dn,Be.direction=Mn}function Tt(ce){for(var Be=[],Ye=0;Ye<ce.pointers.length;)Be[Ye]={clientX:fe(ce.pointers[Ye].clientX),clientY:fe(ce.pointers[Ye].clientY)},Ye++;return{timeStamp:Ie(),pointers:Be,center:Qt(Be),deltaX:ce.deltaX,deltaY:ce.deltaY}}function Qt(ce){var Be=ce.length;if(Be===1)return{x:fe(ce[0].clientX),y:fe(ce[0].clientY)};for(var Ye=0,zt=0,hr=0;hr<Be;)Ye+=ce[hr].clientX,zt+=ce[hr].clientY,hr++;return{x:fe(Ye/Be),y:fe(zt/Be)}}function xr(ce,Be,Ye){return{x:Be/ce||0,y:Ye/ce||0}}function kr(ce,Be){return ce===Be?ti:be(ce)>=be(Be)?ce<0?Vn:Xr:Be<0?sn:_n}function Wr(ce,Be,Ye){Ye||(Ye=J);var zt=Be[Ye[0]]-ce[Ye[0]],hr=Be[Ye[1]]-ce[Ye[1]];return Math.sqrt(zt*zt+hr*hr)}function an(ce,Be,Ye){Ye||(Ye=J);var zt=Be[Ye[0]]-ce[Ye[0]],hr=Be[Ye[1]]-ce[Ye[1]];return Math.atan2(hr,zt)*180/Math.PI}function Br(ce,Be){return an(Be[1],Be[0],ze)+an(ce[1],ce[0],ze)}function en(ce,Be){return Wr(Be[0],Be[1],ze)/Wr(ce[0],ce[1],ze)}var Zn={mousedown:Qr,mousemove:Jr,mouseup:_r},zn="mousedown",li="mousemove mouseup";function sa(){this.evEl=zn,this.evWin=li,this.pressed=!1,$e.apply(this,arguments)}le(sa,$e,{handler:function(Be){var Ye=Zn[Be.type];Ye&Qr&&Be.button===0&&(this.pressed=!0),Ye&Jr&&Be.which!==1&&(Ye=_r),this.pressed&&(Ye&_r&&(this.pressed=!1),this.callback(this.manager,Ye,{pointers:[Be],changedPointers:[Be],pointerType:$r,srcEvent:Be}))}});var Oa={pointerdown:Qr,pointermove:Jr,pointerup:_r,pointercancel:Gn,pointerout:Gn},Gr={2:cr,3:Ut,4:$r,5:ln},Ds="pointerdown",Co="pointermove pointerup pointercancel";D.MSPointerEvent&&!D.PointerEvent&&(Ds="MSPointerDown",Co="MSPointerMove MSPointerUp MSPointerCancel");function xn(){this.evEl=Ds,this.evWin=Co,$e.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}le(xn,$e,{handler:function(Be){var Ye=this.store,zt=!1,hr=Be.type.toLowerCase().replace("ms",""),Lr=Oa[hr],dn=Gr[Be.pointerType]||Be.pointerType,Mn=dn==cr,vi=ge(Ye,Be.pointerId,"pointerId");Lr&Qr&&(Be.button===0||Mn)?vi<0&&(Ye.push(Be),vi=Ye.length-1):Lr&(_r|Gn)&&(zt=!0),!(vi<0)&&(Ye[vi]=Be,this.callback(this.manager,Lr,{pointers:Ye,changedPointers:[Be],pointerType:dn,srcEvent:Be}),zt&&Ye.splice(vi,1))}});var xs={touchstart:Qr,touchmove:Jr,touchend:_r,touchcancel:Gn},go="touchstart",Ns="touchstart touchmove touchend touchcancel";function Po(){this.evTarget=go,this.evWin=Ns,this.started=!1,$e.apply(this,arguments)}le(Po,$e,{handler:function(Be){var Ye=xs[Be.type];if(Ye===Qr&&(this.started=!0),!!this.started){var zt=hl.call(this,Be,Ye);Ye&(_r|Gn)&&zt[0].length-zt[1].length===0&&(this.started=!1),this.callback(this.manager,Ye,{pointers:zt[0],changedPointers:zt[1],pointerType:cr,srcEvent:Be})}}});function hl(ce,Be){var Ye=X(ce.touches),zt=X(ce.changedTouches);return Be&(_r|Gn)&&(Ye=Me(Ye.concat(zt),"identifier",!0)),[Ye,zt]}var yu={touchstart:Qr,touchmove:Jr,touchend:_r,touchcancel:Gn},Es="touchstart touchmove touchend touchcancel";function fs(){this.evTarget=Es,this.targetIds={},$e.apply(this,arguments)}le(fs,$e,{handler:function(Be){var Ye=yu[Be.type],zt=Ou.call(this,Be,Ye);zt&&this.callback(this.manager,Ye,{pointers:zt[0],changedPointers:zt[1],pointerType:cr,srcEvent:Be})}});function Ou(ce,Be){var Ye=X(ce.touches),zt=this.targetIds;if(Be&(Qr|Jr)&&Ye.length===1)return zt[Ye[0].identifier]=!0,[Ye,Ye];var hr,Lr,dn=X(ce.changedTouches),Mn=[],vi=this.target;if(Lr=Ye.filter(function(co){return Le(co.target,vi)}),Be===Qr)for(hr=0;hr<Lr.length;)zt[Lr[hr].identifier]=!0,hr++;for(hr=0;hr<dn.length;)zt[dn[hr].identifier]&&Mn.push(dn[hr]),Be&(_r|Gn)&&delete zt[dn[hr].identifier],hr++;if(Mn.length)return[Me(Lr.concat(Mn),"identifier",!0),Mn]}var Al=2500,da=25;function Zi(){$e.apply(this,arguments);var ce=Re(this.handler,this);this.touch=new fs(this.manager,ce),this.mouse=new sa(this.manager,ce),this.primaryTouch=null,this.lastTouches=[]}le(Zi,$e,{handler:function(Be,Ye,zt){var hr=zt.pointerType==cr,Lr=zt.pointerType==$r;if(!(Lr&&zt.sourceCapabilities&&zt.sourceCapabilities.firesTouchEvents)){if(hr)Fs.call(this,Ye,zt);else if(Lr&&ts.call(this,zt))return;this.callback(Be,Ye,zt)}},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});function Fs(ce,Be){ce&Qr?(this.primaryTouch=Be.changedPointers[0].identifier,no.call(this,Be)):ce&(_r|Gn)&&no.call(this,Be)}function no(ce){var Be=ce.changedPointers[0];if(Be.identifier===this.primaryTouch){var Ye={x:Be.clientX,y:Be.clientY};this.lastTouches.push(Ye);var zt=this.lastTouches,hr=function(){var Lr=zt.indexOf(Ye);Lr>-1&&zt.splice(Lr,1)};setTimeout(hr,Al)}}function ts(ce){for(var Be=ce.srcEvent.clientX,Ye=ce.srcEvent.clientY,zt=0;zt<this.lastTouches.length;zt++){var hr=this.lastTouches[zt],Lr=Math.abs(Be-hr.x),dn=Math.abs(Ye-hr.y);if(Lr<=da&&dn<=da)return!0}return!1}var Oo=Ae(q.style,"touchAction"),Ni=Oo!==F,io="compute",bs="auto",Wo="manipulation",Ru="none",Sa="pan-x",ya="pan-y",Ku=Ca();function uo(ce,Be){this.manager=ce,this.set(Be)}uo.prototype={set:function(ce){ce==io&&(ce=this.compute()),Ni&&this.manager.element.style&&Ku[ce]&&(this.manager.element.style[Oo]=ce),this.actions=ce.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var ce=[];return st(this.manager.recognizers,function(Be){ye(Be.options.enable,[Be])&&(ce=ce.concat(Be.getTouchAction()))}),Js(ce.join(" "))},preventDefaults:function(ce){var Be=ce.srcEvent,Ye=ce.offsetDirection;if(this.manager.session.prevented){Be.preventDefault();return}var zt=this.actions,hr=de(zt,Ru)&&!Ku[Ru],Lr=de(zt,ya)&&!Ku[ya],dn=de(zt,Sa)&&!Ku[Sa];if(hr){var Mn=ce.pointers.length===1,vi=ce.distance<2,co=ce.deltaTime<250;if(Mn&&vi&&co)return}if(!(dn&&Lr)&&(hr||Lr&&Ye&Di||dn&&Ye&ri))return this.preventSrc(Be)},preventSrc:function(ce){this.manager.session.prevented=!0,ce.preventDefault()}};function Js(ce){if(de(ce,Ru))return Ru;var Be=de(ce,Sa),Ye=de(ce,ya);return Be&&Ye?Ru:Be||Ye?Be?Sa:ya:de(ce,Wo)?Wo:bs}function Ca(){if(!Ni)return!1;var ce={},Be=D.CSS&&D.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach(function(Ye){ce[Ye]=Be?D.CSS.supports("touch-action",Ye):!0}),ce}var uu=1,Mr=2,vn=4,lo=8,eu=lo,tu=16,Ss=32;function Bs(ce){this.options=je({},this.defaults,ce||{}),this.id=ue(),this.manager=null,this.options.enable=_e(this.options.enable,!0),this.state=uu,this.simultaneous={},this.requireFail=[]}Bs.prototype={defaults:{},set:function(ce){return je(this.options,ce),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(ce){if(He(ce,"recognizeWith",this))return this;var Be=this.simultaneous;return ce=Cs(ce,this),Be[ce.id]||(Be[ce.id]=ce,ce.recognizeWith(this)),this},dropRecognizeWith:function(ce){return He(ce,"dropRecognizeWith",this)?this:(ce=Cs(ce,this),delete this.simultaneous[ce.id],this)},requireFailure:function(ce){if(He(ce,"requireFailure",this))return this;var Be=this.requireFail;return ce=Cs(ce,this),ge(Be,ce)===-1&&(Be.push(ce),ce.requireFailure(this)),this},dropRequireFailure:function(ce){if(He(ce,"dropRequireFailure",this))return this;ce=Cs(ce,this);var Be=ge(this.requireFail,ce);return Be>-1&&this.requireFail.splice(Be,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(ce){return!!this.simultaneous[ce.id]},emit:function(ce){var Be=this,Ye=this.state;function zt(hr){Be.manager.emit(hr,ce)}Ye<lo&&zt(Be.options.event+ja(Ye)),zt(Be.options.event),ce.additionalEvent&&zt(ce.additionalEvent),Ye>=lo&&zt(Be.options.event+ja(Ye))},tryEmit:function(ce){if(this.canEmit())return this.emit(ce);this.state=Ss},canEmit:function(){for(var ce=0;ce<this.requireFail.length;){if(!(this.requireFail[ce].state&(Ss|uu)))return!1;ce++}return!0},recognize:function(ce){var Be=je({},ce);if(!ye(this.options.enable,[this,Be])){this.reset(),this.state=Ss;return}this.state&(eu|tu|Ss)&&(this.state=uu),this.state=this.process(Be),this.state&(Mr|vn|lo|tu)&&this.tryEmit(Be)},process:function(ce){},getTouchAction:function(){},reset:function(){}};function ja(ce){return ce&tu?"cancel":ce&lo?"end":ce&vn?"move":ce&Mr?"start":""}function Yc(ce){return ce==_n?"down":ce==sn?"up":ce==Vn?"left":ce==Xr?"right":""}function Cs(ce,Be){var Ye=Be.manager;return Ye?Ye.get(ce):ce}function rs(){Bs.apply(this,arguments)}le(rs,Bs,{defaults:{pointers:1},attrTest:function(ce){var Be=this.options.pointers;return Be===0||ce.pointers.length===Be},process:function(ce){var Be=this.state,Ye=ce.eventType,zt=Be&(Mr|vn),hr=this.attrTest(ce);return zt&&(Ye&Gn||!hr)?Be|tu:zt||hr?Ye&_r?Be|lo:Be&Mr?Be|vn:Mr:Ss}});function Ll(){rs.apply(this,arguments),this.pX=null,this.pY=null}le(Ll,rs,{defaults:{event:"pan",threshold:10,pointers:1,direction:Pt},getTouchAction:function(){var ce=this.options.direction,Be=[];return ce&Di&&Be.push(ya),ce&ri&&Be.push(Sa),Be},directionTest:function(ce){var Be=this.options,Ye=!0,zt=ce.distance,hr=ce.direction,Lr=ce.deltaX,dn=ce.deltaY;return hr&Be.direction||(Be.direction&Di?(hr=Lr===0?ti:Lr<0?Vn:Xr,Ye=Lr!=this.pX,zt=Math.abs(ce.deltaX)):(hr=dn===0?ti:dn<0?sn:_n,Ye=dn!=this.pY,zt=Math.abs(ce.deltaY))),ce.direction=hr,Ye&&zt>Be.threshold&&hr&Be.direction},attrTest:function(ce){return rs.prototype.attrTest.call(this,ce)&&(this.state&Mr||!(this.state&Mr)&&this.directionTest(ce))},emit:function(ce){this.pX=ce.deltaX,this.pY=ce.deltaY;var Be=Yc(ce.direction);Be&&(ce.additionalEvent=this.options.event+Be),this._super.emit.call(this,ce)}});function zi(){rs.apply(this,arguments)}le(zi,rs,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[Ru]},attrTest:function(ce){return this._super.attrTest.call(this,ce)&&(Math.abs(ce.scale-1)>this.options.threshold||this.state&Mr)},emit:function(ce){if(ce.scale!==1){var Be=ce.scale<1?"in":"out";ce.additionalEvent=this.options.event+Be}this._super.emit.call(this,ce)}});function Pl(){Bs.apply(this,arguments),this._timer=null,this._input=null}le(Pl,Bs,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return[bs]},process:function(ce){var Be=this.options,Ye=ce.pointers.length===Be.pointers,zt=ce.distance<Be.threshold,hr=ce.deltaTime>Be.time;if(this._input=ce,!zt||!Ye||ce.eventType&(_r|Gn)&&!hr)this.reset();else if(ce.eventType&Qr)this.reset(),this._timer=Oe(function(){this.state=eu,this.tryEmit()},Be.time,this);else if(ce.eventType&_r)return eu;return Ss},reset:function(){clearTimeout(this._timer)},emit:function(ce){this.state===eu&&(ce&&ce.eventType&_r?this.manager.emit(this.options.event+"up",ce):(this._input.timeStamp=Ie(),this.manager.emit(this.options.event,this._input)))}});function Ro(){rs.apply(this,arguments)}le(Ro,rs,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[Ru]},attrTest:function(ce){return this._super.attrTest.call(this,ce)&&(Math.abs(ce.rotation)>this.options.threshold||this.state&Mr)}});function pl(){rs.apply(this,arguments)}le(pl,rs,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:Di|ri,pointers:1},getTouchAction:function(){return Ll.prototype.getTouchAction.call(this)},attrTest:function(ce){var Be=this.options.direction,Ye;return Be&(Di|ri)?Ye=ce.overallVelocity:Be&Di?Ye=ce.overallVelocityX:Be&ri&&(Ye=ce.overallVelocityY),this._super.attrTest.call(this,ce)&&Be&ce.offsetDirection&&ce.distance>this.options.threshold&&ce.maxPointers==this.options.pointers&&be(Ye)>this.options.velocity&&ce.eventType&_r},emit:function(ce){var Be=Yc(ce.offsetDirection);Be&&this.manager.emit(this.options.event+Be,ce),this.manager.emit(this.options.event,ce)}});function Ai(){Bs.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}le(Ai,Bs,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return[Wo]},process:function(ce){var Be=this.options,Ye=ce.pointers.length===Be.pointers,zt=ce.distance<Be.threshold,hr=ce.deltaTime<Be.time;if(this.reset(),ce.eventType&Qr&&this.count===0)return this.failTimeout();if(zt&&hr&&Ye){if(ce.eventType!=_r)return this.failTimeout();var Lr=this.pTime?ce.timeStamp-this.pTime<Be.interval:!0,dn=!this.pCenter||Wr(this.pCenter,ce.center)<Be.posThreshold;this.pTime=ce.timeStamp,this.pCenter=ce.center,!dn||!Lr?this.count=1:this.count+=1,this._input=ce;var Mn=this.count%Be.taps;if(Mn===0)return this.hasRequireFailures()?(this._timer=Oe(function(){this.state=eu,this.tryEmit()},Be.interval,this),Mr):eu}return Ss},failTimeout:function(){return this._timer=Oe(function(){this.state=Ss},this.options.interval,this),Ss},reset:function(){clearTimeout(this._timer)},emit:function(){this.state==eu&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}});function _u(ce,Be){return Be=Be||{},Be.recognizers=_e(Be.recognizers,_u.defaults.preset),new ns(ce,Be)}_u.VERSION="2.0.7",_u.defaults={domEvents:!1,touchAction:io,enable:!0,inputTarget:null,inputClass:null,preset:[[Ro,{enable:!1}],[zi,{enable:!1},["rotate"]],[pl,{direction:Di}],[Ll,{direction:Di},["swipe"]],[Ai],[Ai,{event:"doubletap",taps:2},["tap"]],[Pl]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}};var vf=1,ku=2;function ns(ce,Be){this.options=je({},_u.defaults,Be||{}),this.options.inputTarget=this.options.inputTarget||ce,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=ce,this.input=At(this),this.touchAction=new uo(this,this.options.touchAction),Mt(this,!0),st(this.options.recognizers,function(Ye){var zt=this.add(new Ye[0](Ye[1]));Ye[2]&&zt.recognizeWith(Ye[2]),Ye[3]&&zt.requireFailure(Ye[3])},this)}ns.prototype={set:function(ce){return je(this.options,ce),ce.touchAction&&this.touchAction.update(),ce.inputTarget&&(this.input.destroy(),this.input.target=ce.inputTarget,this.input.init()),this},stop:function(ce){this.session.stopped=ce?ku:vf},recognize:function(ce){var Be=this.session;if(!Be.stopped){this.touchAction.preventDefaults(ce);var Ye,zt=this.recognizers,hr=Be.curRecognizer;(!hr||hr&&hr.state&eu)&&(hr=Be.curRecognizer=null);for(var Lr=0;Lr<zt.length;)Ye=zt[Lr],Be.stopped!==ku&&(!hr||Ye==hr||Ye.canRecognizeWith(hr))?Ye.recognize(ce):Ye.reset(),!hr&&Ye.state&(Mr|vn|lo)&&(hr=Be.curRecognizer=Ye),Lr++}},get:function(ce){if(ce instanceof Bs)return ce;for(var Be=this.recognizers,Ye=0;Ye<Be.length;Ye++)if(Be[Ye].options.event==ce)return Be[Ye];return null},add:function(ce){if(He(ce,"add",this))return this;var Be=this.get(ce.options.event);return Be&&this.remove(Be),this.recognizers.push(ce),ce.manager=this,this.touchAction.update(),ce},remove:function(ce){if(He(ce,"remove",this))return this;if(ce=this.get(ce),ce){var Be=this.recognizers,Ye=ge(Be,ce);Ye!==-1&&(Be.splice(Ye,1),this.touchAction.update())}return this},on:function(ce,Be){if(ce!==F&&Be!==F){var Ye=this.handlers;return st(Ee(ce),function(zt){Ye[zt]=Ye[zt]||[],Ye[zt].push(Be)}),this}},off:function(ce,Be){if(ce!==F){var Ye=this.handlers;return st(Ee(ce),function(zt){Be?Ye[zt]&&Ye[zt].splice(ge(Ye[zt],Be),1):delete Ye[zt]}),this}},emit:function(ce,Be){this.options.domEvents&&Ve(ce,Be);var Ye=this.handlers[ce]&&this.handlers[ce].slice();if(!(!Ye||!Ye.length)){Be.type=ce,Be.preventDefault=function(){Be.srcEvent.preventDefault()};for(var zt=0;zt<Ye.length;)Ye[zt](Be),zt++}},destroy:function(){this.element&&Mt(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}};function Mt(ce,Be){var Ye=ce.element;if(Ye.style){var zt;st(ce.options.cssProps,function(hr,Lr){zt=Ae(Ye.style,Lr),Be?(ce.oldCssProps[zt]=Ye.style[zt],Ye.style[zt]=hr):Ye.style[zt]=ce.oldCssProps[zt]||""}),Be||(ce.oldCssProps={})}}function Ve(ce,Be){var Ye=G.createEvent("Event");Ye.initEvent(ce,!0,!0),Ye.gesture=Be,Be.target.dispatchEvent(Ye)}je(_u,{INPUT_START:Qr,INPUT_MOVE:Jr,INPUT_END:_r,INPUT_CANCEL:Gn,STATE_POSSIBLE:uu,STATE_BEGAN:Mr,STATE_CHANGED:vn,STATE_ENDED:lo,STATE_RECOGNIZED:eu,STATE_CANCELLED:tu,STATE_FAILED:Ss,DIRECTION_NONE:ti,DIRECTION_LEFT:Vn,DIRECTION_RIGHT:Xr,DIRECTION_UP:sn,DIRECTION_DOWN:_n,DIRECTION_HORIZONTAL:Di,DIRECTION_VERTICAL:ri,DIRECTION_ALL:Pt,Manager:ns,Input:$e,TouchAction:uo,TouchInput:fs,MouseInput:sa,PointerEventInput:xn,TouchMouseInput:Zi,SingleTouchInput:Po,Recognizer:Bs,AttrRecognizer:rs,Tap:Ai,Pan:Ll,Swipe:pl,Pinch:zi,Rotate:Ro,Press:Pl,on:ne,off:Y,each:st,merge:Te,extend:we,assign:je,inherit:le,bindFn:Re,prefixed:Ae});var Gt=typeof D!="undefined"?D:typeof self!="undefined"?self:{};Gt.Hammer=_u,P=function(){return _u}.call($,C,$,se),P!==F&&(se.exports=P)})(window,document,"Hammer")},38262:function(se,$,C){"use strict";var P=C(44532),D=P("%Object.defineProperty%",!0),G=function(){if(D)try{return D({},"a",{value:1}),!0}catch(F){return!1}return!1};G.hasArrayLengthDefineBug=function(){if(!G())return null;try{return D([],"length",{value:1}).length!==1}catch(F){return!0}},se.exports=G},77916:function(se){"use strict";var $={foo:{}},C=Object;se.exports=function(){return{__proto__:$}.foo===$.foo&&!({__proto__:null}instanceof C)}},9997:function(se,$,C){"use strict";var P=typeof Symbol!="undefined"&&Symbol,D=C(83880);se.exports=function(){return typeof P!="function"||typeof Symbol!="function"||typeof P("foo")!="symbol"||typeof Symbol("bar")!="symbol"?!1:D()}},83880:function(se){"use strict";se.exports=function(){if(typeof Symbol!="function"||typeof Object.getOwnPropertySymbols!="function")return!1;if(typeof Symbol.iterator=="symbol")return!0;var C={},P=Symbol("test"),D=Object(P);if(typeof P=="string"||Object.prototype.toString.call(P)!=="[object Symbol]"||Object.prototype.toString.call(D)!=="[object Symbol]")return!1;var G=42;C[P]=G;for(P in C)return!1;if(typeof Object.keys=="function"&&Object.keys(C).length!==0||typeof Object.getOwnPropertyNames=="function"&&Object.getOwnPropertyNames(C).length!==0)return!1;var Z=Object.getOwnPropertySymbols(C);if(Z.length!==1||Z[0]!==P||!Object.prototype.propertyIsEnumerable.call(C,P))return!1;if(typeof Object.getOwnPropertyDescriptor=="function"){var F=Object.getOwnPropertyDescriptor(C,P);if(F.value!==G||F.enumerable!==!0)return!1}return!0}},45119:function(se,$,C){"use strict";var P=C(83880);se.exports=function(){return P()&&!!Symbol.toStringTag}},68854:function(se,$,C){"use strict";var P=Function.prototype.call,D=Object.prototype.hasOwnProperty,G=C(36723);se.exports=G.call(P,D)},67467:function(se,$){$.read=function(C,P,D,G,Z){var F,z,q=Z*8-G-1,ee=(1<<q)-1,fe=ee>>1,be=-7,Ie=D?Z-1:0,Oe=D?-1:1,He=C[P+Ie];for(Ie+=Oe,F=He&(1<<-be)-1,He>>=-be,be+=q;be>0;F=F*256+C[P+Ie],Ie+=Oe,be-=8);for(z=F&(1<<-be)-1,F>>=-be,be+=G;be>0;z=z*256+C[P+Ie],Ie+=Oe,be-=8);if(F===0)F=1-fe;else{if(F===ee)return z?NaN:(He?-1:1)*(1/0);z=z+Math.pow(2,G),F=F-fe}return(He?-1:1)*z*Math.pow(2,F-G)},$.write=function(C,P,D,G,Z,F){var z,q,ee,fe=F*8-Z-1,be=(1<<fe)-1,Ie=be>>1,Oe=Z===23?Math.pow(2,-24)-Math.pow(2,-77):0,He=G?0:F-1,st=G?1:-1,De=P<0||P===0&&1/P<0?1:0;for(P=Math.abs(P),isNaN(P)||P===1/0?(q=isNaN(P)?1:0,z=be):(z=Math.floor(Math.log(P)/Math.LN2),P*(ee=Math.pow(2,-z))<1&&(z--,ee*=2),z+Ie>=1?P+=Oe/ee:P+=Oe*Math.pow(2,1-Ie),P*ee>=2&&(z++,ee/=2),z+Ie>=be?(q=0,z=be):z+Ie>=1?(q=(P*ee-1)*Math.pow(2,Z),z=z+Ie):(q=P*Math.pow(2,Ie-1)*Math.pow(2,Z),z=0));Z>=8;C[D+He]=q&255,He+=st,q/=256,Z-=8);for(z=z<<Z|q,fe+=Z;fe>0;C[D+He]=z&255,He+=st,z/=256,fe-=8);C[D+He-st]|=De*128}},3039:function(se,$){"use strict";Object.defineProperty($,"__esModule",{value:!0});var C=Symbol.for("INJECTION");function P(z,q,ee,fe){function be(){return fe&&!Reflect.hasMetadata(C,this,q)&&Reflect.defineMetadata(C,ee(),this,q),Reflect.hasMetadata(C,this,q)?Reflect.getMetadata(C,this,q):ee()}function Ie(Oe){Reflect.defineMetadata(C,Oe,this,q)}Object.defineProperty(z,q,{configurable:!0,enumerable:!0,get:be,set:Ie})}function D(z,q){return function(ee){return function(fe,be){var Ie=function(){return z.get(ee)};P(fe,be,Ie,q)}}}$.makePropertyInjectDecorator=D;function G(z,q){return function(ee,fe){return function(be,Ie){var Oe=function(){return z.getNamed(ee,fe)};P(be,Ie,Oe,q)}}}$.makePropertyInjectNamedDecorator=G;function Z(z,q){return function(ee,fe,be){return function(Ie,Oe){var He=function(){return z.getTagged(ee,fe,be)};P(Ie,Oe,He,q)}}}$.makePropertyInjectTaggedDecorator=Z;function F(z,q){return function(ee){return function(fe,be){var Ie=function(){return z.getAll(ee)};P(fe,be,Ie,q)}}}$.makePropertyMultiInjectDecorator=F},11922:function(se,$,C){"use strict";var P;P={value:!0};var D=C(3039);function G(Z,F){F===void 0&&(F=!0);var z=D.makePropertyInjectDecorator(Z,F),q=D.makePropertyInjectNamedDecorator(Z,F),ee=D.makePropertyInjectTaggedDecorator(Z,F),fe=D.makePropertyMultiInjectDecorator(Z,F);return{lazyInject:z,lazyInjectNamed:q,lazyInjectTagged:ee,lazyMultiInject:fe}}$.Z=G},80626:function(se,$,C){"use strict";Object.defineProperty($,"__esModule",{value:!0}),$.tagProperty=$.tagParameter=$.decorate=void 0;var P=C(36078),D=C(50295);function G(fe,be,Ie,Oe){var He=D.TAGGED;F(He,fe,be,Oe,Ie)}$.tagParameter=G;function Z(fe,be,Ie){var Oe=D.TAGGED_PROP;F(Oe,fe.constructor,be,Ie)}$.tagProperty=Z;function F(fe,be,Ie,Oe,He){var st={},De=typeof He=="number",je=He!==void 0&&De?He.toString():Ie;if(De&&Ie!==void 0)throw new Error(P.INVALID_DECORATOR_OPERATION);Reflect.hasOwnMetadata(fe,be)&&(st=Reflect.getMetadata(fe,be));var we=st[je];if(!Array.isArray(we))we=[];else for(var Te=0,le=we;Te<le.length;Te++){var Re=le[Te];if(Re.key===Oe.key)throw new Error(P.DUPLICATED_METADATA+" "+Re.key.toString())}we.push(Oe),st[je]=we,Reflect.defineMetadata(fe,st,be)}function z(fe,be){Reflect.decorate(fe,be)}function q(fe,be){return function(Ie,Oe){be(Ie,Oe,fe)}}function ee(fe,be,Ie){typeof Ie=="number"?z([q(Ie,fe)],be):typeof Ie=="string"?Reflect.decorate([fe],be,Ie):z([fe],be)}$.decorate=ee},76213:function(se,$,C){"use strict";Object.defineProperty($,"__esModule",{value:!0}),$.inject=$.LazyServiceIdentifer=void 0;var P=C(36078),D=C(50295),G=C(25092),Z=C(80626),F=function(){function q(ee){this._cb=ee}return q.prototype.unwrap=function(){return this._cb()},q}();$.LazyServiceIdentifer=F;function z(q){return function(ee,fe,be){if(q===void 0)throw new Error(P.UNDEFINED_INJECT_ANNOTATION(ee.name));var Ie=new G.Metadata(D.INJECT_TAG,q);typeof be=="number"?Z.tagParameter(ee,fe,be,Ie):Z.tagProperty(ee,fe,Ie)}}$.inject=z},91773:function(se,$,C){"use strict";Object.defineProperty($,"__esModule",{value:!0}),$.injectable=void 0;var P=C(36078),D=C(50295);function G(){return function(Z){if(Reflect.hasOwnMetadata(D.PARAM_TYPES,Z))throw new Error(P.DUPLICATED_INJECTABLE_DECORATOR);var F=Reflect.getMetadata(D.DESIGN_PARAM_TYPES,Z)||[];return Reflect.defineMetadata(D.PARAM_TYPES,F,Z),Z}}$.injectable=G},41528:function(se,$,C){"use strict";Object.defineProperty($,"__esModule",{value:!0}),$.multiInject=void 0;var P=C(50295),D=C(25092),G=C(80626);function Z(F){return function(z,q,ee){var fe=new D.Metadata(P.MULTI_INJECT_TAG,F);typeof ee=="number"?G.tagParameter(z,q,ee,fe):G.tagProperty(z,q,fe)}}$.multiInject=Z},79817:function(se,$,C){"use strict";Object.defineProperty($,"__esModule",{value:!0}),$.named=void 0;var P=C(50295),D=C(25092),G=C(80626);function Z(F){return function(z,q,ee){var fe=new D.Metadata(P.NAMED_TAG,F);typeof ee=="number"?G.tagParameter(z,q,ee,fe):G.tagProperty(z,q,fe)}}$.named=Z},71316:function(se,$,C){"use strict";Object.defineProperty($,"__esModule",{value:!0}),$.optional=void 0;var P=C(50295),D=C(25092),G=C(80626);function Z(){return function(F,z,q){var ee=new D.Metadata(P.OPTIONAL_TAG,!0);typeof q=="number"?G.tagParameter(F,z,q,ee):G.tagProperty(F,z,ee)}}$.optional=Z},71971:function(se,$,C){"use strict";Object.defineProperty($,"__esModule",{value:!0}),$.postConstruct=void 0;var P=C(36078),D=C(50295),G=C(25092);function Z(){return function(F,z,q){var ee=new G.Metadata(D.POST_CONSTRUCT,z);if(Reflect.hasOwnMetadata(D.POST_CONSTRUCT,F.constructor))throw new Error(P.MULTIPLE_POST_CONSTRUCT_METHODS);Reflect.defineMetadata(D.POST_CONSTRUCT,ee,F.constructor)}}$.postConstruct=Z},79189:function(se,$,C){"use strict";Object.defineProperty($,"__esModule",{value:!0}),$.tagged=void 0;var P=C(25092),D=C(80626);function G(Z,F){return function(z,q,ee){var fe=new P.Metadata(Z,F);typeof ee=="number"?D.tagParameter(z,q,ee,fe):D.tagProperty(z,q,fe)}}$.tagged=G},8245:function(se,$,C){"use strict";Object.defineProperty($,"__esModule",{value:!0}),$.targetName=void 0;var P=C(50295),D=C(25092),G=C(80626);function Z(F){return function(z,q,ee){var fe=new D.Metadata(P.NAME_TAG,F);G.tagParameter(z,q,ee,fe)}}$.targetName=Z},19235:function(se,$,C){"use strict";Object.defineProperty($,"__esModule",{value:!0}),$.unmanaged=void 0;var P=C(50295),D=C(25092),G=C(80626);function Z(){return function(F,z,q){var ee=new D.Metadata(P.UNMANAGED_TAG,!0);G.tagParameter(F,z,q,ee)}}$.unmanaged=Z},30683:function(se,$,C){"use strict";Object.defineProperty($,"__esModule",{value:!0}),$.Binding=void 0;var P=C(77690),D=C(70023),G=function(){function Z(F,z){this.id=D.id(),this.activated=!1,this.serviceIdentifier=F,this.scope=z,this.type=P.BindingTypeEnum.Invalid,this.constraint=function(q){return!0},this.implementationType=null,this.cache=null,this.factory=null,this.provider=null,this.onActivation=null,this.dynamicValue=null}return Z.prototype.clone=function(){var F=new Z(this.serviceIdentifier,this.scope);return F.activated=F.scope===P.BindingScopeEnum.Singleton?this.activated:!1,F.implementationType=this.implementationType,F.dynamicValue=this.dynamicValue,F.scope=this.scope,F.type=this.type,F.factory=this.factory,F.provider=this.provider,F.constraint=this.constraint,F.onActivation=this.onActivation,F.cache=this.cache,F},Z}();$.Binding=G},13497:function(se,$){"use strict";Object.defineProperty($,"__esModule",{value:!0}),$.BindingCount=void 0;var C={MultipleBindingsAvailable:2,NoBindingsAvailable:0,OnlyOneBindingAvailable:1};$.BindingCount=C},36078:function(se,$){"use strict";Object.defineProperty($,"__esModule",{value:!0}),$.STACK_OVERFLOW=$.CIRCULAR_DEPENDENCY_IN_FACTORY=$.POST_CONSTRUCT_ERROR=$.MULTIPLE_POST_CONSTRUCT_METHODS=$.CONTAINER_OPTIONS_INVALID_SKIP_BASE_CHECK=$.CONTAINER_OPTIONS_INVALID_AUTO_BIND_INJECTABLE=$.CONTAINER_OPTIONS_INVALID_DEFAULT_SCOPE=$.CONTAINER_OPTIONS_MUST_BE_AN_OBJECT=$.ARGUMENTS_LENGTH_MISMATCH=$.INVALID_DECORATOR_OPERATION=$.INVALID_TO_SELF_VALUE=$.INVALID_FUNCTION_BINDING=$.INVALID_MIDDLEWARE_RETURN=$.NO_MORE_SNAPSHOTS_AVAILABLE=$.INVALID_BINDING_TYPE=$.NOT_IMPLEMENTED=$.CIRCULAR_DEPENDENCY=$.UNDEFINED_INJECT_ANNOTATION=$.MISSING_INJECT_ANNOTATION=$.MISSING_INJECTABLE_ANNOTATION=$.NOT_REGISTERED=$.CANNOT_UNBIND=$.AMBIGUOUS_MATCH=$.KEY_NOT_FOUND=$.NULL_ARGUMENT=$.DUPLICATED_METADATA=$.DUPLICATED_INJECTABLE_DECORATOR=void 0,$.DUPLICATED_INJECTABLE_DECORATOR="Cannot apply @injectable decorator multiple times.",$.DUPLICATED_METADATA="Metadata key was used more than once in a parameter:",$.NULL_ARGUMENT="NULL argument",$.KEY_NOT_FOUND="Key Not Found",$.AMBIGUOUS_MATCH="Ambiguous match found for serviceIdentifier:",$.CANNOT_UNBIND="Could not unbind serviceIdentifier:",$.NOT_REGISTERED="No matching bindings found for serviceIdentifier:",$.MISSING_INJECTABLE_ANNOTATION="Missing required @injectable annotation in:",$.MISSING_INJECT_ANNOTATION="Missing required @inject or @multiInject annotation in:";var C=function(Z){return"@inject called with undefined this could mean that the class "+Z+" has a circular dependency problem. You can use a LazyServiceIdentifer to  overcome this limitation."};$.UNDEFINED_INJECT_ANNOTATION=C,$.CIRCULAR_DEPENDENCY="Circular dependency found:",$.NOT_IMPLEMENTED="Sorry, this feature is not fully implemented yet.",$.INVALID_BINDING_TYPE="Invalid binding type:",$.NO_MORE_SNAPSHOTS_AVAILABLE="No snapshot available to restore.",$.INVALID_MIDDLEWARE_RETURN="Invalid return type in middleware. Middleware must return!",$.INVALID_FUNCTION_BINDING="Value provided to function binding must be a function!",$.INVALID_TO_SELF_VALUE="The toSelf function can only be applied when a constructor is used as service identifier",$.INVALID_DECORATOR_OPERATION="The @inject @multiInject @tagged and @named decorators must be applied to the parameters of a class constructor or a class property.";var P=function(){for(var Z=[],F=0;F<arguments.length;F++)Z[F]=arguments[F];return"The number of constructor arguments in the derived class "+(Z[0]+" must be >= than the number of constructor arguments of its base class.")};$.ARGUMENTS_LENGTH_MISMATCH=P,$.CONTAINER_OPTIONS_MUST_BE_AN_OBJECT="Invalid Container constructor argument. Container options must be an object.",$.CONTAINER_OPTIONS_INVALID_DEFAULT_SCOPE="Invalid Container option. Default scope must be a string ('singleton' or 'transient').",$.CONTAINER_OPTIONS_INVALID_AUTO_BIND_INJECTABLE="Invalid Container option. Auto bind injectable must be a boolean",$.CONTAINER_OPTIONS_INVALID_SKIP_BASE_CHECK="Invalid Container option. Skip base check must be a boolean",$.MULTIPLE_POST_CONSTRUCT_METHODS="Cannot apply @postConstruct decorator multiple times in the same class";var D=function(){for(var Z=[],F=0;F<arguments.length;F++)Z[F]=arguments[F];return"@postConstruct error in class "+Z[0]+": "+Z[1]};$.POST_CONSTRUCT_ERROR=D;var G=function(){for(var Z=[],F=0;F<arguments.length;F++)Z[F]=arguments[F];return"It looks like there is a circular dependency "+("in one of the '"+Z[0]+"' bindings. Please investigate bindings with")+("service identifier '"+Z[1]+"'.")};$.CIRCULAR_DEPENDENCY_IN_FACTORY=G,$.STACK_OVERFLOW="Maximum call stack size exceeded"},77690:function(se,$){"use strict";Object.defineProperty($,"__esModule",{value:!0}),$.TargetTypeEnum=$.BindingTypeEnum=$.BindingScopeEnum=void 0;var C={Request:"Request",Singleton:"Singleton",Transient:"Transient"};$.BindingScopeEnum=C;var P={ConstantValue:"ConstantValue",Constructor:"Constructor",DynamicValue:"DynamicValue",Factory:"Factory",Function:"Function",Instance:"Instance",Invalid:"Invalid",Provider:"Provider"};$.BindingTypeEnum=P;var D={ClassProperty:"ClassProperty",ConstructorArgument:"ConstructorArgument",Variable:"Variable"};$.TargetTypeEnum=D},50295:function(se,$){"use strict";Object.defineProperty($,"__esModule",{value:!0}),$.NON_CUSTOM_TAG_KEYS=$.POST_CONSTRUCT=$.DESIGN_PARAM_TYPES=$.PARAM_TYPES=$.TAGGED_PROP=$.TAGGED=$.MULTI_INJECT_TAG=$.INJECT_TAG=$.OPTIONAL_TAG=$.UNMANAGED_TAG=$.NAME_TAG=$.NAMED_TAG=void 0,$.NAMED_TAG="named",$.NAME_TAG="name",$.UNMANAGED_TAG="unmanaged",$.OPTIONAL_TAG="optional",$.INJECT_TAG="inject",$.MULTI_INJECT_TAG="multi_inject",$.TAGGED="inversify:tagged",$.TAGGED_PROP="inversify:tagged_props",$.PARAM_TYPES="inversify:paramtypes",$.DESIGN_PARAM_TYPES="design:paramtypes",$.POST_CONSTRUCT="post_construct";function C(){return[$.INJECT_TAG,$.MULTI_INJECT_TAG,$.NAME_TAG,$.UNMANAGED_TAG,$.NAMED_TAG,$.OPTIONAL_TAG]}$.NON_CUSTOM_TAG_KEYS=C()},70596:function(se,$,C){"use strict";var P=this&&this.__awaiter||function(we,Te,le,Re){function ye(_e){return _e instanceof le?_e:new le(function(ne){ne(_e)})}return new(le||(le=Promise))(function(_e,ne){function Y(Ee){try{de(Re.next(Ee))}catch(ge){ne(ge)}}function Le(Ee){try{de(Re.throw(Ee))}catch(ge){ne(ge)}}function de(Ee){Ee.done?_e(Ee.value):ye(Ee.value).then(Y,Le)}de((Re=Re.apply(we,Te||[])).next())})},D=this&&this.__generator||function(we,Te){var le={label:0,sent:function(){if(_e[0]&1)throw _e[1];return _e[1]},trys:[],ops:[]},Re,ye,_e,ne;return ne={next:Y(0),throw:Y(1),return:Y(2)},typeof Symbol=="function"&&(ne[Symbol.iterator]=function(){return this}),ne;function Y(de){return function(Ee){return Le([de,Ee])}}function Le(de){if(Re)throw new TypeError("Generator is already executing.");for(;le;)try{if(Re=1,ye&&(_e=de[0]&2?ye.return:de[0]?ye.throw||((_e=ye.return)&&_e.call(ye),0):ye.next)&&!(_e=_e.call(ye,de[1])).done)return _e;switch(ye=0,_e&&(de=[de[0]&2,_e.value]),de[0]){case 0:case 1:_e=de;break;case 4:return le.label++,{value:de[1],done:!1};case 5:le.label++,ye=de[1],de=[0];continue;case 7:de=le.ops.pop(),le.trys.pop();continue;default:if(_e=le.trys,!(_e=_e.length>0&&_e[_e.length-1])&&(de[0]===6||de[0]===2)){le=0;continue}if(de[0]===3&&(!_e||de[1]>_e[0]&&de[1]<_e[3])){le.label=de[1];break}if(de[0]===6&&le.label<_e[1]){le.label=_e[1],_e=de;break}if(_e&&le.label<_e[2]){le.label=_e[2],le.ops.push(de);break}_e[2]&&le.ops.pop(),le.trys.pop();continue}de=Te.call(we,le)}catch(Ee){de=[6,Ee],ye=0}finally{Re=_e=0}if(de[0]&5)throw de[1];return{value:de[0]?de[1]:void 0,done:!0}}},G=this&&this.__spreadArray||function(we,Te){for(var le=0,Re=Te.length,ye=we.length;le<Re;le++,ye++)we[ye]=Te[le];return we};Object.defineProperty($,"__esModule",{value:!0}),$.Container=void 0;var Z=C(30683),F=C(36078),z=C(77690),q=C(50295),ee=C(43870),fe=C(54142),be=C(9386),Ie=C(43313),Oe=C(70023),He=C(29552),st=C(71878),De=C(82543),je=function(){function we(Te){this._appliedMiddleware=[];var le=Te||{};if(typeof le!="object")throw new Error(""+F.CONTAINER_OPTIONS_MUST_BE_AN_OBJECT);if(le.defaultScope===void 0)le.defaultScope=z.BindingScopeEnum.Transient;else if(le.defaultScope!==z.BindingScopeEnum.Singleton&&le.defaultScope!==z.BindingScopeEnum.Transient&&le.defaultScope!==z.BindingScopeEnum.Request)throw new Error(""+F.CONTAINER_OPTIONS_INVALID_DEFAULT_SCOPE);if(le.autoBindInjectable===void 0)le.autoBindInjectable=!1;else if(typeof le.autoBindInjectable!="boolean")throw new Error(""+F.CONTAINER_OPTIONS_INVALID_AUTO_BIND_INJECTABLE);if(le.skipBaseClassChecks===void 0)le.skipBaseClassChecks=!1;else if(typeof le.skipBaseClassChecks!="boolean")throw new Error(""+F.CONTAINER_OPTIONS_INVALID_SKIP_BASE_CHECK);this.options={autoBindInjectable:le.autoBindInjectable,defaultScope:le.defaultScope,skipBaseClassChecks:le.skipBaseClassChecks},this.id=Oe.id(),this._bindingDictionary=new De.Lookup,this._snapshots=[],this._middleware=null,this.parent=null,this._metadataReader=new ee.MetadataReader}return we.merge=function(Te,le){for(var Re=[],ye=2;ye<arguments.length;ye++)Re[ye-2]=arguments[ye];var _e=new we,ne=G([Te,le],Re).map(function(de){return fe.getBindingDictionary(de)}),Y=fe.getBindingDictionary(_e);function Le(de,Ee){de.traverse(function(ge,X){X.forEach(function(Me){Ee.add(Me.serviceIdentifier,Me.clone())})})}return ne.forEach(function(de){Le(de,Y)}),_e},we.prototype.load=function(){for(var Te=[],le=0;le<arguments.length;le++)Te[le]=arguments[le];for(var Re=this._getContainerModuleHelpersFactory(),ye=0,_e=Te;ye<_e.length;ye++){var ne=_e[ye],Y=Re(ne.id);ne.registry(Y.bindFunction,Y.unbindFunction,Y.isboundFunction,Y.rebindFunction)}},we.prototype.loadAsync=function(){for(var Te=[],le=0;le<arguments.length;le++)Te[le]=arguments[le];return P(this,void 0,void 0,function(){var Re,ye,_e,ne,Y;return D(this,function(Le){switch(Le.label){case 0:Re=this._getContainerModuleHelpersFactory(),ye=0,_e=Te,Le.label=1;case 1:return ye<_e.length?(ne=_e[ye],Y=Re(ne.id),[4,ne.registry(Y.bindFunction,Y.unbindFunction,Y.isboundFunction,Y.rebindFunction)]):[3,4];case 2:Le.sent(),Le.label=3;case 3:return ye++,[3,1];case 4:return[2]}})})},we.prototype.unload=function(){for(var Te=this,le=[],Re=0;Re<arguments.length;Re++)le[Re]=arguments[Re];var ye=function(_e){return function(ne){return ne.moduleId===_e}};le.forEach(function(_e){var ne=ye(_e.id);Te._bindingDictionary.removeByCondition(ne)})},we.prototype.bind=function(Te){var le=this.options.defaultScope||z.BindingScopeEnum.Transient,Re=new Z.Binding(Te,le);return this._bindingDictionary.add(Te,Re),new Ie.BindingToSyntax(Re)},we.prototype.rebind=function(Te){return this.unbind(Te),this.bind(Te)},we.prototype.unbind=function(Te){try{this._bindingDictionary.remove(Te)}catch(le){throw new Error(F.CANNOT_UNBIND+" "+He.getServiceIdentifierAsString(Te))}},we.prototype.unbindAll=function(){this._bindingDictionary=new De.Lookup},we.prototype.isBound=function(Te){var le=this._bindingDictionary.hasKey(Te);return!le&&this.parent&&(le=this.parent.isBound(Te)),le},we.prototype.isBoundNamed=function(Te,le){return this.isBoundTagged(Te,q.NAMED_TAG,le)},we.prototype.isBoundTagged=function(Te,le,Re){var ye=!1;if(this._bindingDictionary.hasKey(Te)){var _e=this._bindingDictionary.get(Te),ne=fe.createMockRequest(this,Te,le,Re);ye=_e.some(function(Y){return Y.constraint(ne)})}return!ye&&this.parent&&(ye=this.parent.isBoundTagged(Te,le,Re)),ye},we.prototype.snapshot=function(){this._snapshots.push(st.ContainerSnapshot.of(this._bindingDictionary.clone(),this._middleware))},we.prototype.restore=function(){var Te=this._snapshots.pop();if(Te===void 0)throw new Error(F.NO_MORE_SNAPSHOTS_AVAILABLE);this._bindingDictionary=Te.bindings,this._middleware=Te.middleware},we.prototype.createChild=function(Te){var le=new we(Te||this.options);return le.parent=this,le},we.prototype.applyMiddleware=function(){for(var Te=[],le=0;le<arguments.length;le++)Te[le]=arguments[le];this._appliedMiddleware=this._appliedMiddleware.concat(Te);var Re=this._middleware?this._middleware:this._planAndResolve();this._middleware=Te.reduce(function(ye,_e){return _e(ye)},Re)},we.prototype.applyCustomMetadataReader=function(Te){this._metadataReader=Te},we.prototype.get=function(Te){return this._get(!1,!1,z.TargetTypeEnum.Variable,Te)},we.prototype.getTagged=function(Te,le,Re){return this._get(!1,!1,z.TargetTypeEnum.Variable,Te,le,Re)},we.prototype.getNamed=function(Te,le){return this.getTagged(Te,q.NAMED_TAG,le)},we.prototype.getAll=function(Te){return this._get(!0,!0,z.TargetTypeEnum.Variable,Te)},we.prototype.getAllTagged=function(Te,le,Re){return this._get(!1,!0,z.TargetTypeEnum.Variable,Te,le,Re)},we.prototype.getAllNamed=function(Te,le){return this.getAllTagged(Te,q.NAMED_TAG,le)},we.prototype.resolve=function(Te){var le=this.createChild();return le.bind(Te).toSelf(),this._appliedMiddleware.forEach(function(Re){le.applyMiddleware(Re)}),le.get(Te)},we.prototype._getContainerModuleHelpersFactory=function(){var Te=this,le=function(Y,Le){Y._binding.moduleId=Le},Re=function(Y){return function(Le){var de=Te.bind.bind(Te),Ee=de(Le);return le(Ee,Y),Ee}},ye=function(Y){return function(Le){var de=Te.unbind.bind(Te);de(Le)}},_e=function(Y){return function(Le){var de=Te.isBound.bind(Te);return de(Le)}},ne=function(Y){return function(Le){var de=Te.rebind.bind(Te),Ee=de(Le);return le(Ee,Y),Ee}};return function(Y){return{bindFunction:Re(Y),isboundFunction:_e(Y),rebindFunction:ne(Y),unbindFunction:ye(Y)}}},we.prototype._get=function(Te,le,Re,ye,_e,ne){var Y=null,Le={avoidConstraints:Te,contextInterceptor:function(de){return de},isMultiInject:le,key:_e,serviceIdentifier:ye,targetType:Re,value:ne};if(this._middleware){if(Y=this._middleware(Le),Y==null)throw new Error(F.INVALID_MIDDLEWARE_RETURN)}else Y=this._planAndResolve()(Le);return Y},we.prototype._planAndResolve=function(){var Te=this;return function(le){var Re=fe.plan(Te._metadataReader,Te,le.isMultiInject,le.targetType,le.serviceIdentifier,le.key,le.value,le.avoidConstraints);Re=le.contextInterceptor(Re);var ye=be.resolve(Re);return ye}},we}();$.Container=je},42913:function(se,$,C){"use strict";Object.defineProperty($,"__esModule",{value:!0}),$.AsyncContainerModule=$.ContainerModule=void 0;var P=C(70023),D=function(){function Z(F){this.id=P.id(),this.registry=F}return Z}();$.ContainerModule=D;var G=function(){function Z(F){this.id=P.id(),this.registry=F}return Z}();$.AsyncContainerModule=G},71878:function(se,$){"use strict";Object.defineProperty($,"__esModule",{value:!0}),$.ContainerSnapshot=void 0;var C=function(){function P(){}return P.of=function(D,G){var Z=new P;return Z.bindings=D,Z.middleware=G,Z},P}();$.ContainerSnapshot=C},82543:function(se,$,C){"use strict";Object.defineProperty($,"__esModule",{value:!0}),$.Lookup=void 0;var P=C(36078),D=function(){function G(){this._map=new Map}return G.prototype.getMap=function(){return this._map},G.prototype.add=function(Z,F){if(Z==null)throw new Error(P.NULL_ARGUMENT);if(F==null)throw new Error(P.NULL_ARGUMENT);var z=this._map.get(Z);z!==void 0?(z.push(F),this._map.set(Z,z)):this._map.set(Z,[F])},G.prototype.get=function(Z){if(Z==null)throw new Error(P.NULL_ARGUMENT);var F=this._map.get(Z);if(F!==void 0)return F;throw new Error(P.KEY_NOT_FOUND)},G.prototype.remove=function(Z){if(Z==null)throw new Error(P.NULL_ARGUMENT);if(!this._map.delete(Z))throw new Error(P.KEY_NOT_FOUND)},G.prototype.removeByCondition=function(Z){var F=this;this._map.forEach(function(z,q){var ee=z.filter(function(fe){return!Z(fe)});ee.length>0?F._map.set(q,ee):F._map.delete(q)})},G.prototype.hasKey=function(Z){if(Z==null)throw new Error(P.NULL_ARGUMENT);return this._map.has(Z)},G.prototype.clone=function(){var Z=new G;return this._map.forEach(function(F,z){F.forEach(function(q){return Z.add(z,q.clone())})}),Z},G.prototype.traverse=function(Z){this._map.forEach(function(F,z){Z(z,F)})},G}();$.Lookup=D},99311:function(se,$,C){"use strict";var P;P={value:!0},P=P=P=P=P=P=$.GW=P=P=$.zY=P=P=P=P=P=$.f3=P=P=$.b2=P=P=P=P=P=$.W2=P=void 0;var D=C(50295);P=D;var G=C(70596);Object.defineProperty($,"W2",{enumerable:!0,get:function(){return G.Container}});var Z=C(77690);P={enumerable:!0,get:function(){return Z.BindingScopeEnum}},P={enumerable:!0,get:function(){return Z.BindingTypeEnum}},P={enumerable:!0,get:function(){return Z.TargetTypeEnum}};var F=C(42913);P={enumerable:!0,get:function(){return F.AsyncContainerModule}},P={enumerable:!0,get:function(){return F.ContainerModule}};var z=C(91773);Object.defineProperty($,"b2",{enumerable:!0,get:function(){return z.injectable}});var q=C(79189);P={enumerable:!0,get:function(){return q.tagged}};var ee=C(79817);P={enumerable:!0,get:function(){return ee.named}};var fe=C(76213);Object.defineProperty($,"f3",{enumerable:!0,get:function(){return fe.inject}}),P={enumerable:!0,get:function(){return fe.LazyServiceIdentifer}};var be=C(71316);P={enumerable:!0,get:function(){return be.optional}};var Ie=C(19235);P={enumerable:!0,get:function(){return Ie.unmanaged}};var Oe=C(41528);P={enumerable:!0,get:function(){return Oe.multiInject}};var He=C(8245);P={enumerable:!0,get:function(){return He.targetName}};var st=C(71971);Object.defineProperty($,"zY",{enumerable:!0,get:function(){return st.postConstruct}});var De=C(43870);P={enumerable:!0,get:function(){return De.MetadataReader}};var je=C(70023);P={enumerable:!0,get:function(){return je.id}};var we=C(80626);Object.defineProperty($,"GW",{enumerable:!0,get:function(){return we.decorate}});var Te=C(83140);P={enumerable:!0,get:function(){return Te.traverseAncerstors}},P={enumerable:!0,get:function(){return Te.taggedConstraint}},P={enumerable:!0,get:function(){return Te.namedConstraint}},P={enumerable:!0,get:function(){return Te.typeConstraint}};var le=C(29552);P={enumerable:!0,get:function(){return le.getServiceIdentifierAsString}};var Re=C(34384);P={enumerable:!0,get:function(){return Re.multiBindToService}}},91519:function(se,$,C){"use strict";Object.defineProperty($,"__esModule",{value:!0}),$.Context=void 0;var P=C(70023),D=function(){function G(Z){this.id=P.id(),this.container=Z}return G.prototype.addPlan=function(Z){this.plan=Z},G.prototype.setCurrentRequest=function(Z){this.currentRequest=Z},G}();$.Context=D},25092:function(se,$,C){"use strict";Object.defineProperty($,"__esModule",{value:!0}),$.Metadata=void 0;var P=C(50295),D=function(){function G(Z,F){this.key=Z,this.value=F}return G.prototype.toString=function(){return this.key===P.NAMED_TAG?"named: "+this.value.toString()+" ":"tagged: { key:"+this.key.toString()+", value: "+this.value+" }"},G}();$.Metadata=D},43870:function(se,$,C){"use strict";Object.defineProperty($,"__esModule",{value:!0}),$.MetadataReader=void 0;var P=C(50295),D=function(){function G(){}return G.prototype.getConstructorMetadata=function(Z){var F=Reflect.getMetadata(P.PARAM_TYPES,Z),z=Reflect.getMetadata(P.TAGGED,Z);return{compilerGeneratedMetadata:F,userGeneratedMetadata:z||{}}},G.prototype.getPropertiesMetadata=function(Z){var F=Reflect.getMetadata(P.TAGGED_PROP,Z)||[];return F},G}();$.MetadataReader=D},6335:function(se,$){"use strict";Object.defineProperty($,"__esModule",{value:!0}),$.Plan=void 0;var C=function(){function P(D,G){this.parentContext=D,this.rootRequest=G}return P}();$.Plan=C},54142:function(se,$,C){"use strict";Object.defineProperty($,"__esModule",{value:!0}),$.getBindingDictionary=$.createMockRequest=$.plan=void 0;var P=C(13497),D=C(36078),G=C(77690),Z=C(50295),F=C(92542),z=C(29552),q=C(91519),ee=C(25092),fe=C(6335),be=C(16664),Ie=C(14810),Oe=C(69660);function He(ye){return ye._bindingDictionary}$.getBindingDictionary=He;function st(ye,_e,ne,Y,Le,de){var Ee=ye?Z.MULTI_INJECT_TAG:Z.INJECT_TAG,ge=new ee.Metadata(Ee,ne),X=new Oe.Target(_e,Y,ne,ge);if(Le!==void 0){var Me=new ee.Metadata(Le,de);X.metadata.push(Me)}return X}function De(ye,_e,ne,Y,Le){var de=Te(ne.container,Le.serviceIdentifier),Ee=[];return de.length===P.BindingCount.NoBindingsAvailable&&ne.container.options.autoBindInjectable&&typeof Le.serviceIdentifier=="function"&&ye.getConstructorMetadata(Le.serviceIdentifier).compilerGeneratedMetadata&&(ne.container.bind(Le.serviceIdentifier).toSelf(),de=Te(ne.container,Le.serviceIdentifier)),_e?Ee=de:Ee=de.filter(function(ge){var X=new Ie.Request(ge.serviceIdentifier,ne,Y,ge,Le);return ge.constraint(X)}),je(Le.serviceIdentifier,Ee,Le,ne.container),Ee}function je(ye,_e,ne,Y){switch(_e.length){case P.BindingCount.NoBindingsAvailable:if(ne.isOptional())return _e;var Le=z.getServiceIdentifierAsString(ye),de=D.NOT_REGISTERED;throw de+=z.listMetadataForTarget(Le,ne),de+=z.listRegisteredBindingsForServiceIdentifier(Y,Le,Te),new Error(de);case P.BindingCount.OnlyOneBindingAvailable:if(!ne.isArray())return _e;case P.BindingCount.MultipleBindingsAvailable:default:if(ne.isArray())return _e;var Le=z.getServiceIdentifierAsString(ye),de=D.AMBIGUOUS_MATCH+" "+Le;throw de+=z.listRegisteredBindingsForServiceIdentifier(Y,Le,Te),new Error(de)}}function we(ye,_e,ne,Y,Le,de){var Ee,ge;if(Le===null){Ee=De(ye,_e,Y,null,de),ge=new Ie.Request(ne,Y,null,Ee,de);var X=new fe.Plan(Y,ge);Y.addPlan(X)}else Ee=De(ye,_e,Y,Le,de),ge=Le.addChildRequest(de.serviceIdentifier,Ee,de);Ee.forEach(function(Me){var Ae=null;if(de.isArray())Ae=ge.addChildRequest(Me.serviceIdentifier,Me,de);else{if(Me.cache)return;Ae=ge}if(Me.type===G.BindingTypeEnum.Instance&&Me.implementationType!==null){var me=be.getDependencies(ye,Me.implementationType);if(!Y.container.options.skipBaseClassChecks){var ue=be.getBaseClassDependencyCount(ye,Me.implementationType);if(me.length<ue){var ke=D.ARGUMENTS_LENGTH_MISMATCH(be.getFunctionName(Me.implementationType));throw new Error(ke)}}me.forEach(function(Ze){we(ye,!1,Ze.serviceIdentifier,Y,Ae,Ze)})}})}function Te(ye,_e){var ne=[],Y=He(ye);return Y.hasKey(_e)?ne=Y.get(_e):ye.parent!==null&&(ne=Te(ye.parent,_e)),ne}function le(ye,_e,ne,Y,Le,de,Ee,ge){ge===void 0&&(ge=!1);var X=new q.Context(_e),Me=st(ne,Y,Le,"",de,Ee);try{return we(ye,ge,Le,X,null,Me),X}catch(Ae){throw F.isStackOverflowExeption(Ae)&&X.plan&&z.circularDependencyToException(X.plan.rootRequest),Ae}}$.plan=le;function Re(ye,_e,ne,Y){var Le=new Oe.Target(G.TargetTypeEnum.Variable,"",_e,new ee.Metadata(ne,Y)),de=new q.Context(ye),Ee=new Ie.Request(_e,de,null,[],Le);return Ee}$.createMockRequest=Re},68634:function(se,$){"use strict";Object.defineProperty($,"__esModule",{value:!0}),$.QueryableString=void 0;var C=function(){function P(D){this.str=D}return P.prototype.startsWith=function(D){return this.str.indexOf(D)===0},P.prototype.endsWith=function(D){var G="",Z=D.split("").reverse().join("");return G=this.str.split("").reverse().join(""),this.startsWith.call({str:G},Z)},P.prototype.contains=function(D){return this.str.indexOf(D)!==-1},P.prototype.equals=function(D){return this.str===D},P.prototype.value=function(){return this.str},P}();$.QueryableString=C},16664:function(se,$,C){"use strict";var P=this&&this.__spreadArray||function(De,je){for(var we=0,Te=je.length,le=De.length;we<Te;we++,le++)De[le]=je[we];return De};Object.defineProperty($,"__esModule",{value:!0}),$.getFunctionName=$.getBaseClassDependencyCount=$.getDependencies=void 0;var D=C(76213),G=C(36078),Z=C(77690),F=C(50295),z=C(29552);Object.defineProperty($,"getFunctionName",{enumerable:!0,get:function(){return z.getFunctionName}});var q=C(69660);function ee(De,je){var we=z.getFunctionName(je),Te=fe(De,we,je,!1);return Te}$.getDependencies=ee;function fe(De,je,we,Te){var le=De.getConstructorMetadata(we),Re=le.compilerGeneratedMetadata;if(Re===void 0){var ye=G.MISSING_INJECTABLE_ANNOTATION+" "+je+".";throw new Error(ye)}var _e=le.userGeneratedMetadata,ne=Object.keys(_e),Y=we.length===0&&ne.length>0,Le=ne.length>we.length,de=Y||Le?ne.length:we.length,Ee=Ie(Te,je,Re,_e,de),ge=Oe(De,we),X=P(P([],Ee),ge);return X}function be(De,je,we,Te,le){var Re=le[De.toString()]||[],ye=st(Re),_e=ye.unmanaged!==!0,ne=Te[De],Y=ye.inject||ye.multiInject;if(ne=Y||ne,ne instanceof D.LazyServiceIdentifer&&(ne=ne.unwrap()),_e){var Le=ne===Object,de=ne===Function,Ee=ne===void 0,ge=Le||de||Ee;if(!je&&ge){var X=G.MISSING_INJECT_ANNOTATION+" argument "+De+" in class "+we+".";throw new Error(X)}var Me=new q.Target(Z.TargetTypeEnum.ConstructorArgument,ye.targetName,ne);return Me.metadata=Re,Me}return null}function Ie(De,je,we,Te,le){for(var Re=[],ye=0;ye<le;ye++){var _e=ye,ne=be(_e,De,je,we,Te);ne!==null&&Re.push(ne)}return Re}function Oe(De,je){for(var we=De.getPropertiesMetadata(je),Te=[],le=Object.keys(we),Re=0,ye=le;Re<ye.length;Re++){var _e=ye[Re],ne=we[_e],Y=st(we[_e]),Le=Y.targetName||_e,de=Y.inject||Y.multiInject,Ee=new q.Target(Z.TargetTypeEnum.ClassProperty,Le,de);Ee.metadata=ne,Te.push(Ee)}var ge=Object.getPrototypeOf(je.prototype).constructor;if(ge!==Object){var X=Oe(De,ge);Te=P(P([],Te),X)}return Te}function He(De,je){var we=Object.getPrototypeOf(je.prototype).constructor;if(we!==Object){var Te=z.getFunctionName(we),le=fe(De,Te,we,!0),Re=le.map(function(ne){return ne.metadata.filter(function(Y){return Y.key===F.UNMANAGED_TAG})}),ye=[].concat.apply([],Re).length,_e=le.length-ye;return _e>0?_e:He(De,we)}else return 0}$.getBaseClassDependencyCount=He;function st(De){var je={};return De.forEach(function(we){je[we.key.toString()]=we.value}),{inject:je[F.INJECT_TAG],multiInject:je[F.MULTI_INJECT_TAG],targetName:je[F.NAME_TAG],unmanaged:je[F.UNMANAGED_TAG]}}},14810:function(se,$,C){"use strict";Object.defineProperty($,"__esModule",{value:!0}),$.Request=void 0;var P=C(70023),D=function(){function G(Z,F,z,q,ee){this.id=P.id(),this.serviceIdentifier=Z,this.parentContext=F,this.parentRequest=z,this.target=ee,this.childRequests=[],this.bindings=Array.isArray(q)?q:[q],this.requestScope=z===null?new Map:null}return G.prototype.addChildRequest=function(Z,F,z){var q=new G(Z,this.parentContext,this,F,z);return this.childRequests.push(q),q},G}();$.Request=D},69660:function(se,$,C){"use strict";Object.defineProperty($,"__esModule",{value:!0}),$.Target=void 0;var P=C(50295),D=C(70023),G=C(25092),Z=C(68634),F=function(){function z(q,ee,fe,be){this.id=D.id(),this.type=q,this.serviceIdentifier=fe,this.name=new Z.QueryableString(ee||""),this.metadata=new Array;var Ie=null;typeof be=="string"?Ie=new G.Metadata(P.NAMED_TAG,be):be instanceof G.Metadata&&(Ie=be),Ie!==null&&this.metadata.push(Ie)}return z.prototype.hasTag=function(q){for(var ee=0,fe=this.metadata;ee<fe.length;ee++){var be=fe[ee];if(be.key===q)return!0}return!1},z.prototype.isArray=function(){return this.hasTag(P.MULTI_INJECT_TAG)},z.prototype.matchesArray=function(q){return this.matchesTag(P.MULTI_INJECT_TAG)(q)},z.prototype.isNamed=function(){return this.hasTag(P.NAMED_TAG)},z.prototype.isTagged=function(){return this.metadata.some(function(q){return P.NON_CUSTOM_TAG_KEYS.every(function(ee){return q.key!==ee})})},z.prototype.isOptional=function(){return this.matchesTag(P.OPTIONAL_TAG)(!0)},z.prototype.getNamedTag=function(){return this.isNamed()?this.metadata.filter(function(q){return q.key===P.NAMED_TAG})[0]:null},z.prototype.getCustomTags=function(){return this.isTagged()?this.metadata.filter(function(q){return P.NON_CUSTOM_TAG_KEYS.every(function(ee){return q.key!==ee})}):null},z.prototype.matchesNamedTag=function(q){return this.matchesTag(P.NAMED_TAG)(q)},z.prototype.matchesTag=function(q){var ee=this;return function(fe){for(var be=0,Ie=ee.metadata;be<Ie.length;be++){var Oe=Ie[be];if(Oe.key===q&&Oe.value===fe)return!0}return!1}},z}();$.Target=F},74962:function(se,$,C){"use strict";var P=this&&this.__spreadArray||function(fe,be){for(var Ie=0,Oe=be.length,He=fe.length;Ie<Oe;Ie++,He++)fe[He]=be[Ie];return fe};Object.defineProperty($,"__esModule",{value:!0}),$.resolveInstance=void 0;var D=C(36078),G=C(77690),Z=C(50295);function F(fe,be,Ie){var Oe=be.filter(function(st){return st.target!==null&&st.target.type===G.TargetTypeEnum.ClassProperty}),He=Oe.map(Ie);return Oe.forEach(function(st,De){var je="";je=st.target.name.value();var we=He[De];fe[je]=we}),fe}function z(fe,be){return new(fe.bind.apply(fe,P([void 0],be)))}function q(fe,be){if(Reflect.hasMetadata(Z.POST_CONSTRUCT,fe)){var Ie=Reflect.getMetadata(Z.POST_CONSTRUCT,fe);try{be[Ie.value]()}catch(Oe){throw new Error(D.POST_CONSTRUCT_ERROR(fe.name,Oe.message))}}}function ee(fe,be,Ie){var Oe=null;if(be.length>0){var He=be.filter(function(De){return De.target!==null&&De.target.type===G.TargetTypeEnum.ConstructorArgument}),st=He.map(Ie);Oe=z(fe,st),Oe=F(Oe,be,Ie)}else Oe=new fe;return q(fe,Oe),Oe}$.resolveInstance=ee},9386:function(se,$,C){"use strict";Object.defineProperty($,"__esModule",{value:!0}),$.resolve=void 0;var P=C(36078),D=C(77690),G=C(92542),Z=C(29552),F=C(74962),z=function(fe,be,Ie){try{return Ie()}catch(Oe){throw G.isStackOverflowExeption(Oe)?new Error(P.CIRCULAR_DEPENDENCY_IN_FACTORY(fe,be.toString())):Oe}},q=function(fe){return function(be){be.parentContext.setCurrentRequest(be);var Ie=be.bindings,Oe=be.childRequests,He=be.target&&be.target.isArray(),st=!be.parentRequest||!be.parentRequest.target||!be.target||!be.parentRequest.target.matchesArray(be.target.serviceIdentifier);if(He&&st)return Oe.map(function(Re){var ye=q(fe);return ye(Re)});var De=null;if(be.target.isOptional()&&Ie.length===0)return;var je=Ie[0],we=je.scope===D.BindingScopeEnum.Singleton,Te=je.scope===D.BindingScopeEnum.Request;if(we&&je.activated)return je.cache;if(Te&&fe!==null&&fe.has(je.id))return fe.get(je.id);if(je.type===D.BindingTypeEnum.ConstantValue)De=je.cache,je.activated=!0;else if(je.type===D.BindingTypeEnum.Function)De=je.cache,je.activated=!0;else if(je.type===D.BindingTypeEnum.Constructor)De=je.implementationType;else if(je.type===D.BindingTypeEnum.DynamicValue&&je.dynamicValue!==null)De=z("toDynamicValue",je.serviceIdentifier,function(){return je.dynamicValue(be.parentContext)});else if(je.type===D.BindingTypeEnum.Factory&&je.factory!==null)De=z("toFactory",je.serviceIdentifier,function(){return je.factory(be.parentContext)});else if(je.type===D.BindingTypeEnum.Provider&&je.provider!==null)De=z("toProvider",je.serviceIdentifier,function(){return je.provider(be.parentContext)});else if(je.type===D.BindingTypeEnum.Instance&&je.implementationType!==null)De=F.resolveInstance(je.implementationType,Oe,q(fe));else{var le=Z.getServiceIdentifierAsString(be.serviceIdentifier);throw new Error(P.INVALID_BINDING_TYPE+" "+le)}return typeof je.onActivation=="function"&&(De=je.onActivation(be.parentContext,De)),we&&(je.cache=De,je.activated=!0),Te&&fe!==null&&!fe.has(je.id)&&fe.set(je.id,De),De}};function ee(fe){var be=q(fe.plan.rootRequest.requestScope);return be(fe.plan.rootRequest)}$.resolve=ee},91640:function(se,$,C){"use strict";Object.defineProperty($,"__esModule",{value:!0}),$.BindingInSyntax=void 0;var P=C(77690),D=C(46890),G=function(){function Z(F){this._binding=F}return Z.prototype.inRequestScope=function(){return this._binding.scope=P.BindingScopeEnum.Request,new D.BindingWhenOnSyntax(this._binding)},Z.prototype.inSingletonScope=function(){return this._binding.scope=P.BindingScopeEnum.Singleton,new D.BindingWhenOnSyntax(this._binding)},Z.prototype.inTransientScope=function(){return this._binding.scope=P.BindingScopeEnum.Transient,new D.BindingWhenOnSyntax(this._binding)},Z}();$.BindingInSyntax=G},82386:function(se,$,C){"use strict";Object.defineProperty($,"__esModule",{value:!0}),$.BindingInWhenOnSyntax=void 0;var P=C(91640),D=C(8926),G=C(36890),Z=function(){function F(z){this._binding=z,this._bindingWhenSyntax=new G.BindingWhenSyntax(this._binding),this._bindingOnSyntax=new D.BindingOnSyntax(this._binding),this._bindingInSyntax=new P.BindingInSyntax(z)}return F.prototype.inRequestScope=function(){return this._bindingInSyntax.inRequestScope()},F.prototype.inSingletonScope=function(){return this._bindingInSyntax.inSingletonScope()},F.prototype.inTransientScope=function(){return this._bindingInSyntax.inTransientScope()},F.prototype.when=function(z){return this._bindingWhenSyntax.when(z)},F.prototype.whenTargetNamed=function(z){return this._bindingWhenSyntax.whenTargetNamed(z)},F.prototype.whenTargetIsDefault=function(){return this._bindingWhenSyntax.whenTargetIsDefault()},F.prototype.whenTargetTagged=function(z,q){return this._bindingWhenSyntax.whenTargetTagged(z,q)},F.prototype.whenInjectedInto=function(z){return this._bindingWhenSyntax.whenInjectedInto(z)},F.prototype.whenParentNamed=function(z){return this._bindingWhenSyntax.whenParentNamed(z)},F.prototype.whenParentTagged=function(z,q){return this._bindingWhenSyntax.whenParentTagged(z,q)},F.prototype.whenAnyAncestorIs=function(z){return this._bindingWhenSyntax.whenAnyAncestorIs(z)},F.prototype.whenNoAncestorIs=function(z){return this._bindingWhenSyntax.whenNoAncestorIs(z)},F.prototype.whenAnyAncestorNamed=function(z){return this._bindingWhenSyntax.whenAnyAncestorNamed(z)},F.prototype.whenAnyAncestorTagged=function(z,q){return this._bindingWhenSyntax.whenAnyAncestorTagged(z,q)},F.prototype.whenNoAncestorNamed=function(z){return this._bindingWhenSyntax.whenNoAncestorNamed(z)},F.prototype.whenNoAncestorTagged=function(z,q){return this._bindingWhenSyntax.whenNoAncestorTagged(z,q)},F.prototype.whenAnyAncestorMatches=function(z){return this._bindingWhenSyntax.whenAnyAncestorMatches(z)},F.prototype.whenNoAncestorMatches=function(z){return this._bindingWhenSyntax.whenNoAncestorMatches(z)},F.prototype.onActivation=function(z){return this._bindingOnSyntax.onActivation(z)},F}();$.BindingInWhenOnSyntax=Z},8926:function(se,$,C){"use strict";Object.defineProperty($,"__esModule",{value:!0}),$.BindingOnSyntax=void 0;var P=C(36890),D=function(){function G(Z){this._binding=Z}return G.prototype.onActivation=function(Z){return this._binding.onActivation=Z,new P.BindingWhenSyntax(this._binding)},G}();$.BindingOnSyntax=D},43313:function(se,$,C){"use strict";Object.defineProperty($,"__esModule",{value:!0}),$.BindingToSyntax=void 0;var P=C(36078),D=C(77690),G=C(82386),Z=C(46890),F=function(){function z(q){this._binding=q}return z.prototype.to=function(q){return this._binding.type=D.BindingTypeEnum.Instance,this._binding.implementationType=q,new G.BindingInWhenOnSyntax(this._binding)},z.prototype.toSelf=function(){if(typeof this._binding.serviceIdentifier!="function")throw new Error(""+P.INVALID_TO_SELF_VALUE);var q=this._binding.serviceIdentifier;return this.to(q)},z.prototype.toConstantValue=function(q){return this._binding.type=D.BindingTypeEnum.ConstantValue,this._binding.cache=q,this._binding.dynamicValue=null,this._binding.implementationType=null,this._binding.scope=D.BindingScopeEnum.Singleton,new Z.BindingWhenOnSyntax(this._binding)},z.prototype.toDynamicValue=function(q){return this._binding.type=D.BindingTypeEnum.DynamicValue,this._binding.cache=null,this._binding.dynamicValue=q,this._binding.implementationType=null,new G.BindingInWhenOnSyntax(this._binding)},z.prototype.toConstructor=function(q){return this._binding.type=D.BindingTypeEnum.Constructor,this._binding.implementationType=q,this._binding.scope=D.BindingScopeEnum.Singleton,new Z.BindingWhenOnSyntax(this._binding)},z.prototype.toFactory=function(q){return this._binding.type=D.BindingTypeEnum.Factory,this._binding.factory=q,this._binding.scope=D.BindingScopeEnum.Singleton,new Z.BindingWhenOnSyntax(this._binding)},z.prototype.toFunction=function(q){if(typeof q!="function")throw new Error(P.INVALID_FUNCTION_BINDING);var ee=this.toConstantValue(q);return this._binding.type=D.BindingTypeEnum.Function,this._binding.scope=D.BindingScopeEnum.Singleton,ee},z.prototype.toAutoFactory=function(q){return this._binding.type=D.BindingTypeEnum.Factory,this._binding.factory=function(ee){var fe=function(){return ee.container.get(q)};return fe},this._binding.scope=D.BindingScopeEnum.Singleton,new Z.BindingWhenOnSyntax(this._binding)},z.prototype.toProvider=function(q){return this._binding.type=D.BindingTypeEnum.Provider,this._binding.provider=q,this._binding.scope=D.BindingScopeEnum.Singleton,new Z.BindingWhenOnSyntax(this._binding)},z.prototype.toService=function(q){this.toDynamicValue(function(ee){return ee.container.get(q)})},z}();$.BindingToSyntax=F},46890:function(se,$,C){"use strict";Object.defineProperty($,"__esModule",{value:!0}),$.BindingWhenOnSyntax=void 0;var P=C(8926),D=C(36890),G=function(){function Z(F){this._binding=F,this._bindingWhenSyntax=new D.BindingWhenSyntax(this._binding),this._bindingOnSyntax=new P.BindingOnSyntax(this._binding)}return Z.prototype.when=function(F){return this._bindingWhenSyntax.when(F)},Z.prototype.whenTargetNamed=function(F){return this._bindingWhenSyntax.whenTargetNamed(F)},Z.prototype.whenTargetIsDefault=function(){return this._bindingWhenSyntax.whenTargetIsDefault()},Z.prototype.whenTargetTagged=function(F,z){return this._bindingWhenSyntax.whenTargetTagged(F,z)},Z.prototype.whenInjectedInto=function(F){return this._bindingWhenSyntax.whenInjectedInto(F)},Z.prototype.whenParentNamed=function(F){return this._bindingWhenSyntax.whenParentNamed(F)},Z.prototype.whenParentTagged=function(F,z){return this._bindingWhenSyntax.whenParentTagged(F,z)},Z.prototype.whenAnyAncestorIs=function(F){return this._bindingWhenSyntax.whenAnyAncestorIs(F)},Z.prototype.whenNoAncestorIs=function(F){return this._bindingWhenSyntax.whenNoAncestorIs(F)},Z.prototype.whenAnyAncestorNamed=function(F){return this._bindingWhenSyntax.whenAnyAncestorNamed(F)},Z.prototype.whenAnyAncestorTagged=function(F,z){return this._bindingWhenSyntax.whenAnyAncestorTagged(F,z)},Z.prototype.whenNoAncestorNamed=function(F){return this._bindingWhenSyntax.whenNoAncestorNamed(F)},Z.prototype.whenNoAncestorTagged=function(F,z){return this._bindingWhenSyntax.whenNoAncestorTagged(F,z)},Z.prototype.whenAnyAncestorMatches=function(F){return this._bindingWhenSyntax.whenAnyAncestorMatches(F)},Z.prototype.whenNoAncestorMatches=function(F){return this._bindingWhenSyntax.whenNoAncestorMatches(F)},Z.prototype.onActivation=function(F){return this._bindingOnSyntax.onActivation(F)},Z}();$.BindingWhenOnSyntax=G},36890:function(se,$,C){"use strict";Object.defineProperty($,"__esModule",{value:!0}),$.BindingWhenSyntax=void 0;var P=C(8926),D=C(83140),G=function(){function Z(F){this._binding=F}return Z.prototype.when=function(F){return this._binding.constraint=F,new P.BindingOnSyntax(this._binding)},Z.prototype.whenTargetNamed=function(F){return this._binding.constraint=D.namedConstraint(F),new P.BindingOnSyntax(this._binding)},Z.prototype.whenTargetIsDefault=function(){return this._binding.constraint=function(F){var z=F.target!==null&&!F.target.isNamed()&&!F.target.isTagged();return z},new P.BindingOnSyntax(this._binding)},Z.prototype.whenTargetTagged=function(F,z){return this._binding.constraint=D.taggedConstraint(F)(z),new P.BindingOnSyntax(this._binding)},Z.prototype.whenInjectedInto=function(F){return this._binding.constraint=function(z){return D.typeConstraint(F)(z.parentRequest)},new P.BindingOnSyntax(this._binding)},Z.prototype.whenParentNamed=function(F){return this._binding.constraint=function(z){return D.namedConstraint(F)(z.parentRequest)},new P.BindingOnSyntax(this._binding)},Z.prototype.whenParentTagged=function(F,z){return this._binding.constraint=function(q){return D.taggedConstraint(F)(z)(q.parentRequest)},new P.BindingOnSyntax(this._binding)},Z.prototype.whenAnyAncestorIs=function(F){return this._binding.constraint=function(z){return D.traverseAncerstors(z,D.typeConstraint(F))},new P.BindingOnSyntax(this._binding)},Z.prototype.whenNoAncestorIs=function(F){return this._binding.constraint=function(z){return!D.traverseAncerstors(z,D.typeConstraint(F))},new P.BindingOnSyntax(this._binding)},Z.prototype.whenAnyAncestorNamed=function(F){return this._binding.constraint=function(z){return D.traverseAncerstors(z,D.namedConstraint(F))},new P.BindingOnSyntax(this._binding)},Z.prototype.whenNoAncestorNamed=function(F){return this._binding.constraint=function(z){return!D.traverseAncerstors(z,D.namedConstraint(F))},new P.BindingOnSyntax(this._binding)},Z.prototype.whenAnyAncestorTagged=function(F,z){return this._binding.constraint=function(q){return D.traverseAncerstors(q,D.taggedConstraint(F)(z))},new P.BindingOnSyntax(this._binding)},Z.prototype.whenNoAncestorTagged=function(F,z){return this._binding.constraint=function(q){return!D.traverseAncerstors(q,D.taggedConstraint(F)(z))},new P.BindingOnSyntax(this._binding)},Z.prototype.whenAnyAncestorMatches=function(F){return this._binding.constraint=function(z){return D.traverseAncerstors(z,F)},new P.BindingOnSyntax(this._binding)},Z.prototype.whenNoAncestorMatches=function(F){return this._binding.constraint=function(z){return!D.traverseAncerstors(z,F)},new P.BindingOnSyntax(this._binding)},Z}();$.BindingWhenSyntax=G},83140:function(se,$,C){"use strict";Object.defineProperty($,"__esModule",{value:!0}),$.typeConstraint=$.namedConstraint=$.taggedConstraint=$.traverseAncerstors=void 0;var P=C(50295),D=C(25092),G=function(q,ee){var fe=q.parentRequest;return fe!==null?ee(fe)?!0:G(fe,ee):!1};$.traverseAncerstors=G;var Z=function(q){return function(ee){var fe=function(be){return be!==null&&be.target!==null&&be.target.matchesTag(q)(ee)};return fe.metaData=new D.Metadata(q,ee),fe}};$.taggedConstraint=Z;var F=Z(P.NAMED_TAG);$.namedConstraint=F;var z=function(q){return function(ee){var fe=null;if(ee!==null)if(fe=ee.bindings[0],typeof q=="string"){var be=fe.serviceIdentifier;return be===q}else{var Ie=ee.bindings[0].implementationType;return q===Ie}return!1}};$.typeConstraint=z},34384:function(se,$){"use strict";Object.defineProperty($,"__esModule",{value:!0}),$.multiBindToService=void 0;var C=function(P){return function(D){return function(){for(var G=[],Z=0;Z<arguments.length;Z++)G[Z]=arguments[Z];return G.forEach(function(F){return P.bind(F).toService(D)})}}};$.multiBindToService=C},92542:function(se,$,C){"use strict";Object.defineProperty($,"__esModule",{value:!0}),$.isStackOverflowExeption=void 0;var P=C(36078);function D(G){return G instanceof RangeError||G.message===P.STACK_OVERFLOW}$.isStackOverflowExeption=D},70023:function(se,$){"use strict";Object.defineProperty($,"__esModule",{value:!0}),$.id=void 0;var C=0;function P(){return C++}$.id=P},29552:function(se,$,C){"use strict";Object.defineProperty($,"__esModule",{value:!0}),$.circularDependencyToException=$.listMetadataForTarget=$.listRegisteredBindingsForServiceIdentifier=$.getServiceIdentifierAsString=$.getFunctionName=void 0;var P=C(36078);function D(fe){if(typeof fe=="function"){var be=fe;return be.name}else{if(typeof fe=="symbol")return fe.toString();var be=fe;return be}}$.getServiceIdentifierAsString=D;function G(fe,be,Ie){var Oe="",He=Ie(fe,be);return He.length!==0&&(Oe=`
Registered bindings:`,He.forEach(function(st){var De="Object";st.implementationType!==null&&(De=ee(st.implementationType)),Oe=Oe+`
 `+De,st.constraint.metaData&&(Oe=Oe+" - "+st.constraint.metaData)})),Oe}$.listRegisteredBindingsForServiceIdentifier=G;function Z(fe,be){return fe.parentRequest===null?!1:fe.parentRequest.serviceIdentifier===be?!0:Z(fe.parentRequest,be)}function F(fe){function be(Oe,He){He===void 0&&(He=[]);var st=D(Oe.serviceIdentifier);return He.push(st),Oe.parentRequest!==null?be(Oe.parentRequest,He):He}var Ie=be(fe);return Ie.reverse().join(" --> ")}function z(fe){fe.childRequests.forEach(function(be){if(Z(be,be.serviceIdentifier)){var Ie=F(be);throw new Error(P.CIRCULAR_DEPENDENCY+" "+Ie)}else z(be)})}$.circularDependencyToException=z;function q(fe,be){if(be.isTagged()||be.isNamed()){var Ie="",Oe=be.getNamedTag(),He=be.getCustomTags();return Oe!==null&&(Ie+=Oe.toString()+`
`),He!==null&&He.forEach(function(st){Ie+=st.toString()+`
`})," "+fe+`
 `+fe+" - "+Ie}else return" "+fe}$.listMetadataForTarget=q;function ee(fe){if(fe.name)return fe.name;var be=fe.toString(),Ie=be.match(/^function\s*([^\s(]+)/);return Ie?Ie[1]:"Anonymous function: "+be}$.getFunctionName=ee},76051:function(se,$,C){"use strict";var P=C(45119)(),D=C(97683),G=D("Object.prototype.toString"),Z=function(ee){return P&&ee&&typeof ee=="object"&&Symbol.toStringTag in ee?!1:G(ee)==="[object Arguments]"},F=function(ee){return Z(ee)?!0:ee!==null&&typeof ee=="object"&&typeof ee.length=="number"&&ee.length>=0&&G(ee)!=="[object Array]"&&G(ee.callee)==="[object Function]"},z=function(){return Z(arguments)}();Z.isLegacyArguments=F,se.exports=z?Z:F},5012:function(se,$,C){"use strict";var P=Date.prototype.getDay,D=function(q){try{return P.call(q),!0}catch(ee){return!1}},G=Object.prototype.toString,Z="[object Date]",F=C(45119)();se.exports=function(q){return typeof q!="object"||q===null?!1:F?D(q):G.call(q)===Z}},11644:function(se,$,C){"use strict";var P=C(97683),D=C(45119)(),G,Z,F,z;if(D){G=P("Object.prototype.hasOwnProperty"),Z=P("RegExp.prototype.exec"),F={};var q=function(){throw F};z={toString:q,valueOf:q},typeof Symbol.toPrimitive=="symbol"&&(z[Symbol.toPrimitive]=q)}var ee=P("Object.prototype.toString"),fe=Object.getOwnPropertyDescriptor,be="[object RegExp]";se.exports=D?function(Oe){if(!Oe||typeof Oe!="object")return!1;var He=fe(Oe,"lastIndex"),st=He&&G(He,"value");if(!st)return!1;try{Z(Oe,z)}catch(De){return De===F}}:function(Oe){return!Oe||typeof Oe!="object"&&typeof Oe!="function"?!1:ee(Oe)===be}},15584:function(se,$,C){var P=C(73893),D=C(33152),G=P(D,"DataView");se.exports=G},76414:function(se,$,C){var P=C(64696),D=C(16824),G=C(23476),Z=C(63122),F=C(37279);function z(q){var ee=-1,fe=q==null?0:q.length;for(this.clear();++ee<fe;){var be=q[ee];this.set(be[0],be[1])}}z.prototype.clear=P,z.prototype.delete=D,z.prototype.get=G,z.prototype.has=Z,z.prototype.set=F,se.exports=z},99746:function(se,$,C){var P=C(34251),D=C(24968),G=C(28290),Z=C(88068),F=C(54238);function z(q){var ee=-1,fe=q==null?0:q.length;for(this.clear();++ee<fe;){var be=q[ee];this.set(be[0],be[1])}}z.prototype.clear=P,z.prototype.delete=D,z.prototype.get=G,z.prototype.has=Z,z.prototype.set=F,se.exports=z},40164:function(se,$,C){var P=C(73893),D=C(33152),G=P(D,"Map");se.exports=G},52166:function(se,$,C){var P=C(35365),D=C(63765),G=C(12608),Z=C(10203),F=C(11298);function z(q){var ee=-1,fe=q==null?0:q.length;for(this.clear();++ee<fe;){var be=q[ee];this.set(be[0],be[1])}}z.prototype.clear=P,z.prototype.delete=D,z.prototype.get=G,z.prototype.has=Z,z.prototype.set=F,se.exports=z},97288:function(se,$,C){var P=C(73893),D=C(33152),G=P(D,"Promise");se.exports=G},23599:function(se,$,C){var P=C(73893),D=C(33152),G=P(D,"Set");se.exports=G},98924:function(se,$,C){var P=C(52166),D=C(34776),G=C(40393);function Z(F){var z=-1,q=F==null?0:F.length;for(this.__data__=new P;++z<q;)this.add(F[z])}Z.prototype.add=Z.prototype.push=D,Z.prototype.has=G,se.exports=Z},91866:function(se,$,C){var P=C(99746),D=C(31119),G=C(64399),Z=C(81897),F=C(90558),z=C(64841);function q(ee){var fe=this.__data__=new P(ee);this.size=fe.size}q.prototype.clear=D,q.prototype.delete=G,q.prototype.get=Z,q.prototype.has=F,q.prototype.set=z,se.exports=q},91869:function(se,$,C){var P=C(33152),D=P.Symbol;se.exports=D},77945:function(se,$,C){var P=C(33152),D=P.Uint8Array;se.exports=D},26873:function(se,$,C){var P=C(73893),D=C(33152),G=P(D,"WeakMap");se.exports=G},79628:function(se){function $(C,P,D){switch(D.length){case 0:return C.call(P);case 1:return C.call(P,D[0]);case 2:return C.call(P,D[0],D[1]);case 3:return C.call(P,D[0],D[1],D[2])}return C.apply(P,D)}se.exports=$},60661:function(se){function $(C,P){for(var D=-1,G=C==null?0:C.length;++D<G&&P(C[D],D,C)!==!1;);return C}se.exports=$},86952:function(se){function $(C,P){for(var D=-1,G=C==null?0:C.length,Z=0,F=[];++D<G;){var z=C[D];P(z,D,C)&&(F[Z++]=z)}return F}se.exports=$},84271:function(se,$,C){var P=C(17424);function D(G,Z){var F=G==null?0:G.length;return!!F&&P(G,Z,0)>-1}se.exports=D},94874:function(se){function $(C,P,D){for(var G=-1,Z=C==null?0:C.length;++G<Z;)if(D(P,C[G]))return!0;return!1}se.exports=$},63333:function(se,$,C){var P=C(67943),D=C(13053),G=C(80744),Z=C(57835),F=C(70213),z=C(18397),q=Object.prototype,ee=q.hasOwnProperty;function fe(be,Ie){var Oe=G(be),He=!Oe&&D(be),st=!Oe&&!He&&Z(be),De=!Oe&&!He&&!st&&z(be),je=Oe||He||st||De,we=je?P(be.length,String):[],Te=we.length;for(var le in be)(Ie||ee.call(be,le))&&!(je&&(le=="length"||st&&(le=="offset"||le=="parent")||De&&(le=="buffer"||le=="byteLength"||le=="byteOffset")||F(le,Te)))&&we.push(le);return we}se.exports=fe},75010:function(se){function $(C,P){for(var D=-1,G=C==null?0:C.length,Z=Array(G);++D<G;)Z[D]=P(C[D],D,C);return Z}se.exports=$},57095:function(se){function $(C,P){for(var D=-1,G=P.length,Z=C.length;++D<G;)C[Z+D]=P[D];return C}se.exports=$},99861:function(se){function $(C,P,D,G){var Z=-1,F=C==null?0:C.length;for(G&&F&&(D=C[++Z]);++Z<F;)D=P(D,C[Z],Z,C);return D}se.exports=$},64045:function(se){function $(C,P){for(var D=-1,G=C==null?0:C.length;++D<G;)if(P(C[D],D,C))return!0;return!1}se.exports=$},72828:function(se){function $(C){return C.split("")}se.exports=$},34130:function(se){var $=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g;function C(P){return P.match($)||[]}se.exports=C},89135:function(se,$,C){var P=C(42813),D=C(43607);function G(Z,F,z){(z!==void 0&&!D(Z[F],z)||z===void 0&&!(F in Z))&&P(Z,F,z)}se.exports=G},60348:function(se,$,C){var P=C(42813),D=C(43607),G=Object.prototype,Z=G.hasOwnProperty;function F(z,q,ee){var fe=z[q];(!(Z.call(z,q)&&D(fe,ee))||ee===void 0&&!(q in z))&&P(z,q,ee)}se.exports=F},67971:function(se,$,C){var P=C(43607);function D(G,Z){for(var F=G.length;F--;)if(P(G[F][0],Z))return F;return-1}se.exports=D},91937:function(se,$,C){var P=C(95378),D=C(55451);function G(Z,F){return Z&&P(F,D(F),Z)}se.exports=G},26680:function(se,$,C){var P=C(95378),D=C(56730);function G(Z,F){return Z&&P(F,D(F),Z)}se.exports=G},42813:function(se,$,C){var P=C(35234);function D(G,Z,F){Z=="__proto__"&&P?P(G,Z,{configurable:!0,enumerable:!0,value:F,writable:!0}):G[Z]=F}se.exports=D},14318:function(se){function $(C,P,D){return C===C&&(D!==void 0&&(C=C<=D?C:D),P!==void 0&&(C=C>=P?C:P)),C}se.exports=$},99045:function(se,$,C){var P=C(91866),D=C(60661),G=C(60348),Z=C(91937),F=C(26680),z=C(32315),q=C(47760),ee=C(15168),fe=C(71678),be=C(12076),Ie=C(22675),Oe=C(66139),He=C(79264),st=C(97541),De=C(4084),je=C(80744),we=C(57835),Te=C(41626),le=C(20816),Re=C(65226),ye=C(55451),_e=C(56730),ne=1,Y=2,Le=4,de="[object Arguments]",Ee="[object Array]",ge="[object Boolean]",X="[object Date]",Me="[object Error]",Ae="[object Function]",me="[object GeneratorFunction]",ue="[object Map]",ke="[object Number]",Ze="[object Object]",oe="[object RegExp]",Dt="[object Set]",Rt="[object String]",cr="[object Symbol]",Ut="[object WeakMap]",$r="[object ArrayBuffer]",ln="[object DataView]",Sr="[object Float32Array]",Qr="[object Float64Array]",Jr="[object Int8Array]",_r="[object Int16Array]",Gn="[object Int32Array]",ti="[object Uint8Array]",Vn="[object Uint8ClampedArray]",Xr="[object Uint16Array]",sn="[object Uint32Array]",_n={};_n[de]=_n[Ee]=_n[$r]=_n[ln]=_n[ge]=_n[X]=_n[Sr]=_n[Qr]=_n[Jr]=_n[_r]=_n[Gn]=_n[ue]=_n[ke]=_n[Ze]=_n[oe]=_n[Dt]=_n[Rt]=_n[cr]=_n[ti]=_n[Vn]=_n[Xr]=_n[sn]=!0,_n[Me]=_n[Ae]=_n[Ut]=!1;function Di(ri,Pt,J,ze,$e,At){var Lt,wt=Pt&ne,yr=Pt&Y,vt=Pt&Le;if(J&&(Lt=$e?J(ri,ze,$e,At):J(ri)),Lt!==void 0)return Lt;if(!le(ri))return ri;var Tt=je(ri);if(Tt){if(Lt=He(ri),!wt)return q(ri,Lt)}else{var Qt=Oe(ri),xr=Qt==Ae||Qt==me;if(we(ri))return z(ri,wt);if(Qt==Ze||Qt==de||xr&&!$e){if(Lt=yr||xr?{}:De(ri),!wt)return yr?fe(ri,F(Lt,ri)):ee(ri,Z(Lt,ri))}else{if(!_n[Qt])return $e?ri:{};Lt=st(ri,Qt,wt)}}At||(At=new P);var kr=At.get(ri);if(kr)return kr;At.set(ri,Lt),Re(ri)?ri.forEach(function(Br){Lt.add(Di(Br,Pt,J,Br,ri,At))}):Te(ri)&&ri.forEach(function(Br,en){Lt.set(en,Di(Br,Pt,J,en,ri,At))});var Wr=vt?yr?Ie:be:yr?_e:ye,an=Tt?void 0:Wr(ri);return D(an||ri,function(Br,en){an&&(en=Br,Br=ri[en]),G(Lt,en,Di(Br,Pt,J,en,ri,At))}),Lt}se.exports=Di},35024:function(se,$,C){var P=C(20816),D=Object.create,G=function(){function Z(){}return function(F){if(!P(F))return{};if(D)return D(F);Z.prototype=F;var z=new Z;return Z.prototype=void 0,z}}();se.exports=G},51533:function(se){function $(C,P,D,G){for(var Z=C.length,F=D+(G?1:-1);G?F--:++F<Z;)if(P(C[F],F,C))return F;return-1}se.exports=$},14018:function(se,$,C){var P=C(78010),D=P();se.exports=D},89147:function(se,$,C){var P=C(1186),D=C(9171);function G(Z,F){F=P(F,Z);for(var z=0,q=F.length;Z!=null&&z<q;)Z=Z[D(F[z++])];return z&&z==q?Z:void 0}se.exports=G},75635:function(se,$,C){var P=C(57095),D=C(80744);function G(Z,F,z){var q=F(Z);return D(Z)?q:P(q,z(Z))}se.exports=G},86756:function(se,$,C){var P=C(91869),D=C(72533),G=C(74702),Z="[object Null]",F="[object Undefined]",z=P?P.toStringTag:void 0;function q(ee){return ee==null?ee===void 0?F:Z:z&&z in Object(ee)?D(ee):G(ee)}se.exports=q},17424:function(se,$,C){var P=C(51533),D=C(8373),G=C(49237);function Z(F,z,q){return z===z?G(F,z,q):P(F,D,q)}se.exports=Z},71803:function(se){function $(C,P,D,G){for(var Z=D-1,F=C.length;++Z<F;)if(G(C[Z],P))return Z;return-1}se.exports=$},4977:function(se,$,C){var P=C(86756),D=C(93913),G="[object Arguments]";function Z(F){return D(F)&&P(F)==G}se.exports=Z},77295:function(se,$,C){var P=C(84412),D=C(93913);function G(Z,F,z,q,ee){return Z===F?!0:Z==null||F==null||!D(Z)&&!D(F)?Z!==Z&&F!==F:P(Z,F,z,q,G,ee)}se.exports=G},84412:function(se,$,C){var P=C(91866),D=C(50401),G=C(57710),Z=C(4983),F=C(66139),z=C(80744),q=C(57835),ee=C(18397),fe=1,be="[object Arguments]",Ie="[object Array]",Oe="[object Object]",He=Object.prototype,st=He.hasOwnProperty;function De(je,we,Te,le,Re,ye){var _e=z(je),ne=z(we),Y=_e?Ie:F(je),Le=ne?Ie:F(we);Y=Y==be?Oe:Y,Le=Le==be?Oe:Le;var de=Y==Oe,Ee=Le==Oe,ge=Y==Le;if(ge&&q(je)){if(!q(we))return!1;_e=!0,de=!1}if(ge&&!de)return ye||(ye=new P),_e||ee(je)?D(je,we,Te,le,Re,ye):G(je,we,Y,Te,le,Re,ye);if(!(Te&fe)){var X=de&&st.call(je,"__wrapped__"),Me=Ee&&st.call(we,"__wrapped__");if(X||Me){var Ae=X?je.value():je,me=Me?we.value():we;return ye||(ye=new P),Re(Ae,me,Te,le,ye)}}return ge?(ye||(ye=new P),Z(je,we,Te,le,Re,ye)):!1}se.exports=De},55005:function(se,$,C){var P=C(66139),D=C(93913),G="[object Map]";function Z(F){return D(F)&&P(F)==G}se.exports=Z},8373:function(se){function $(C){return C!==C}se.exports=$},6367:function(se,$,C){var P=C(9363),D=C(89379),G=C(20816),Z=C(63256),F=/[\\^$.*+?()[\]{}|]/g,z=/^\[object .+?Constructor\]$/,q=Function.prototype,ee=Object.prototype,fe=q.toString,be=ee.hasOwnProperty,Ie=RegExp("^"+fe.call(be).replace(F,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function Oe(He){if(!G(He)||D(He))return!1;var st=P(He)?Ie:z;return st.test(Z(He))}se.exports=Oe},38652:function(se,$,C){var P=C(66139),D=C(93913),G="[object Set]";function Z(F){return D(F)&&P(F)==G}se.exports=Z},10766:function(se,$,C){var P=C(86756),D=C(11156),G=C(93913),Z="[object Arguments]",F="[object Array]",z="[object Boolean]",q="[object Date]",ee="[object Error]",fe="[object Function]",be="[object Map]",Ie="[object Number]",Oe="[object Object]",He="[object RegExp]",st="[object Set]",De="[object String]",je="[object WeakMap]",we="[object ArrayBuffer]",Te="[object DataView]",le="[object Float32Array]",Re="[object Float64Array]",ye="[object Int8Array]",_e="[object Int16Array]",ne="[object Int32Array]",Y="[object Uint8Array]",Le="[object Uint8ClampedArray]",de="[object Uint16Array]",Ee="[object Uint32Array]",ge={};ge[le]=ge[Re]=ge[ye]=ge[_e]=ge[ne]=ge[Y]=ge[Le]=ge[de]=ge[Ee]=!0,ge[Z]=ge[F]=ge[we]=ge[z]=ge[Te]=ge[q]=ge[ee]=ge[fe]=ge[be]=ge[Ie]=ge[Oe]=ge[He]=ge[st]=ge[De]=ge[je]=!1;function X(Me){return G(Me)&&D(Me.length)&&!!ge[P(Me)]}se.exports=X},6019:function(se,$,C){var P=C(7975),D=C(23730),G=Object.prototype,Z=G.hasOwnProperty;function F(z){if(!P(z))return D(z);var q=[];for(var ee in Object(z))Z.call(z,ee)&&ee!="constructor"&&q.push(ee);return q}se.exports=F},33988:function(se,$,C){var P=C(20816),D=C(7975),G=C(97817),Z=Object.prototype,F=Z.hasOwnProperty;function z(q){if(!P(q))return G(q);var ee=D(q),fe=[];for(var be in q)be=="constructor"&&(ee||!F.call(q,be))||fe.push(be);return fe}se.exports=z},50097:function(se,$,C){var P=C(91866),D=C(89135),G=C(14018),Z=C(23585),F=C(20816),z=C(56730),q=C(47052);function ee(fe,be,Ie,Oe,He){fe!==be&&G(be,function(st,De){if(He||(He=new P),F(st))Z(fe,be,De,Ie,ee,Oe,He);else{var je=Oe?Oe(q(fe,De),st,De+"",fe,be,He):void 0;je===void 0&&(je=st),D(fe,De,je)}},z)}se.exports=ee},23585:function(se,$,C){var P=C(89135),D=C(32315),G=C(78358),Z=C(47760),F=C(4084),z=C(13053),q=C(80744),ee=C(41590),fe=C(57835),be=C(9363),Ie=C(20816),Oe=C(19308),He=C(18397),st=C(47052),De=C(20480);function je(we,Te,le,Re,ye,_e,ne){var Y=st(we,le),Le=st(Te,le),de=ne.get(Le);if(de){P(we,le,de);return}var Ee=_e?_e(Y,Le,le+"",we,Te,ne):void 0,ge=Ee===void 0;if(ge){var X=q(Le),Me=!X&&fe(Le),Ae=!X&&!Me&&He(Le);Ee=Le,X||Me||Ae?q(Y)?Ee=Y:ee(Y)?Ee=Z(Y):Me?(ge=!1,Ee=D(Le,!0)):Ae?(ge=!1,Ee=G(Le,!0)):Ee=[]:Oe(Le)||z(Le)?(Ee=Y,z(Y)?Ee=De(Y):(!Ie(Y)||be(Y))&&(Ee=F(Le))):ge=!1}ge&&(ne.set(Le,Ee),ye(Ee,Le,Re,_e,ne),ne.delete(Le)),P(we,le,Ee)}se.exports=je},61856:function(se){function $(C){return function(P){return C==null?void 0:C[P]}}se.exports=$},23442:function(se,$,C){var P=C(75010),D=C(17424),G=C(71803),Z=C(38342),F=C(47760),z=Array.prototype,q=z.splice;function ee(fe,be,Ie,Oe){var He=Oe?G:D,st=-1,De=be.length,je=fe;for(fe===be&&(be=F(be)),Ie&&(je=P(fe,Z(Ie)));++st<De;)for(var we=0,Te=be[st],le=Ie?Ie(Te):Te;(we=He(je,le,we,Oe))>-1;)je!==fe&&q.call(je,we,1),q.call(fe,we,1);return fe}se.exports=ee},92918:function(se,$,C){var P=C(46962),D=C(19652),G=C(71152);function Z(F,z){return G(D(F,z,P),F+"")}se.exports=Z},63989:function(se,$,C){var P=C(13503),D=C(35234),G=C(46962),Z=D?function(F,z){return D(F,"toString",{configurable:!0,enumerable:!1,value:P(z),writable:!0})}:G;se.exports=Z},75760:function(se){function $(C,P,D){var G=-1,Z=C.length;P<0&&(P=-P>Z?0:Z+P),D=D>Z?Z:D,D<0&&(D+=Z),Z=P>D?0:D-P>>>0,P>>>=0;for(var F=Array(Z);++G<Z;)F[G]=C[G+P];return F}se.exports=$},67943:function(se){function $(C,P){for(var D=-1,G=Array(C);++D<C;)G[D]=P(D);return G}se.exports=$},50230:function(se,$,C){var P=C(91869),D=C(75010),G=C(80744),Z=C(45029),F=1/0,z=P?P.prototype:void 0,q=z?z.toString:void 0;function ee(fe){if(typeof fe=="string")return fe;if(G(fe))return D(fe,ee)+"";if(Z(fe))return q?q.call(fe):"";var be=fe+"";return be=="0"&&1/fe==-F?"-0":be}se.exports=ee},13927:function(se,$,C){var P=C(15333),D=/^\s+/;function G(Z){return Z&&Z.slice(0,P(Z)+1).replace(D,"")}se.exports=G},38342:function(se){function $(C){return function(P){return C(P)}}se.exports=$},29098:function(se,$,C){var P=C(98924),D=C(84271),G=C(94874),Z=C(1931),F=C(47506),z=C(79679),q=200;function ee(fe,be,Ie){var Oe=-1,He=D,st=fe.length,De=!0,je=[],we=je;if(Ie)De=!1,He=G;else if(st>=q){var Te=be?null:F(fe);if(Te)return z(Te);De=!1,He=Z,we=new P}else we=be?[]:je;e:for(;++Oe<st;){var le=fe[Oe],Re=be?be(le):le;if(le=Ie||le!==0?le:0,De&&Re===Re){for(var ye=we.length;ye--;)if(we[ye]===Re)continue e;be&&we.push(Re),je.push(le)}else He(we,Re,Ie)||(we!==je&&we.push(Re),je.push(le))}return je}se.exports=ee},1931:function(se){function $(C,P){return C.has(P)}se.exports=$},1186:function(se,$,C){var P=C(80744),D=C(86773),G=C(40493),Z=C(44140);function F(z,q){return P(z)?z:D(z,q)?[z]:G(Z(z))}se.exports=F},4324:function(se,$,C){var P=C(75760);function D(G,Z,F){var z=G.length;return F=F===void 0?z:F,!Z&&F>=z?G:P(G,Z,F)}se.exports=D},20188:function(se,$,C){var P=C(77945);function D(G){var Z=new G.constructor(G.byteLength);return new P(Z).set(new P(G)),Z}se.exports=D},32315:function(se,$,C){se=C.nmd(se);var P=C(33152),D=$&&!$.nodeType&&$,G=D&&!0&&se&&!se.nodeType&&se,Z=G&&G.exports===D,F=Z?P.Buffer:void 0,z=F?F.allocUnsafe:void 0;function q(ee,fe){if(fe)return ee.slice();var be=ee.length,Ie=z?z(be):new ee.constructor(be);return ee.copy(Ie),Ie}se.exports=q},27984:function(se,$,C){var P=C(20188);function D(G,Z){var F=Z?P(G.buffer):G.buffer;return new G.constructor(F,G.byteOffset,G.byteLength)}se.exports=D},78583:function(se){var $=/\w*$/;function C(P){var D=new P.constructor(P.source,$.exec(P));return D.lastIndex=P.lastIndex,D}se.exports=C},28757:function(se,$,C){var P=C(91869),D=P?P.prototype:void 0,G=D?D.valueOf:void 0;function Z(F){return G?Object(G.call(F)):{}}se.exports=Z},78358:function(se,$,C){var P=C(20188);function D(G,Z){var F=Z?P(G.buffer):G.buffer;return new G.constructor(F,G.byteOffset,G.length)}se.exports=D},47760:function(se){function $(C,P){var D=-1,G=C.length;for(P||(P=Array(G));++D<G;)P[D]=C[D];return P}se.exports=$},95378:function(se,$,C){var P=C(60348),D=C(42813);function G(Z,F,z,q){var ee=!z;z||(z={});for(var fe=-1,be=F.length;++fe<be;){var Ie=F[fe],Oe=q?q(z[Ie],Z[Ie],Ie,z,Z):void 0;Oe===void 0&&(Oe=Z[Ie]),ee?D(z,Ie,Oe):P(z,Ie,Oe)}return z}se.exports=G},15168:function(se,$,C){var P=C(95378),D=C(58966);function G(Z,F){return P(Z,D(Z),F)}se.exports=G},71678:function(se,$,C){var P=C(95378),D=C(66817);function G(Z,F){return P(Z,D(Z),F)}se.exports=G},64218:function(se,$,C){var P=C(33152),D=P["__core-js_shared__"];se.exports=D},63323:function(se,$,C){var P=C(92918),D=C(8138);function G(Z){return P(function(F,z){var q=-1,ee=z.length,fe=ee>1?z[ee-1]:void 0,be=ee>2?z[2]:void 0;for(fe=Z.length>3&&typeof fe=="function"?(ee--,fe):void 0,be&&D(z[0],z[1],be)&&(fe=ee<3?void 0:fe,ee=1),F=Object(F);++q<ee;){var Ie=z[q];Ie&&Z(F,Ie,q,fe)}return F})}se.exports=G},78010:function(se){function $(C){return function(P,D,G){for(var Z=-1,F=Object(P),z=G(P),q=z.length;q--;){var ee=z[C?q:++Z];if(D(F[ee],ee,F)===!1)break}return P}}se.exports=$},97815:function(se,$,C){var P=C(4324),D=C(55015),G=C(80935),Z=C(44140);function F(z){return function(q){q=Z(q);var ee=D(q)?G(q):void 0,fe=ee?ee[0]:q.charAt(0),be=ee?P(ee,1).join(""):q.slice(1);return fe[z]()+be}}se.exports=F},74749:function(se,$,C){var P=C(99861),D=C(31876),G=C(61503),Z="['\u2019]",F=RegExp(Z,"g");function z(q){return function(ee){return P(G(D(ee).replace(F,"")),q,"")}}se.exports=z},47506:function(se,$,C){var P=C(23599),D=C(9958),G=C(79679),Z=1/0,F=P&&1/G(new P([,-0]))[1]==Z?function(z){return new P(z)}:D;se.exports=F},70668:function(se,$,C){var P=C(61856),D={\u00C0:"A",\u00C1:"A",\u00C2:"A",\u00C3:"A",\u00C4:"A",\u00C5:"A",\u00E0:"a",\u00E1:"a",\u00E2:"a",\u00E3:"a",\u00E4:"a",\u00E5:"a",\u00C7:"C",\u00E7:"c",\u00D0:"D",\u00F0:"d",\u00C8:"E",\u00C9:"E",\u00CA:"E",\u00CB:"E",\u00E8:"e",\u00E9:"e",\u00EA:"e",\u00EB:"e",\u00CC:"I",\u00CD:"I",\u00CE:"I",\u00CF:"I",\u00EC:"i",\u00ED:"i",\u00EE:"i",\u00EF:"i",\u00D1:"N",\u00F1:"n",\u00D2:"O",\u00D3:"O",\u00D4:"O",\u00D5:"O",\u00D6:"O",\u00D8:"O",\u00F2:"o",\u00F3:"o",\u00F4:"o",\u00F5:"o",\u00F6:"o",\u00F8:"o",\u00D9:"U",\u00DA:"U",\u00DB:"U",\u00DC:"U",\u00F9:"u",\u00FA:"u",\u00FB:"u",\u00FC:"u",\u00DD:"Y",\u00FD:"y",\u00FF:"y",\u00C6:"Ae",\u00E6:"ae",\u00DE:"Th",\u00FE:"th",\u00DF:"ss",\u0100:"A",\u0102:"A",\u0104:"A",\u0101:"a",\u0103:"a",\u0105:"a",\u0106:"C",\u0108:"C",\u010A:"C",\u010C:"C",\u0107:"c",\u0109:"c",\u010B:"c",\u010D:"c",\u010E:"D",\u0110:"D",\u010F:"d",\u0111:"d",\u0112:"E",\u0114:"E",\u0116:"E",\u0118:"E",\u011A:"E",\u0113:"e",\u0115:"e",\u0117:"e",\u0119:"e",\u011B:"e",\u011C:"G",\u011E:"G",\u0120:"G",\u0122:"G",\u011D:"g",\u011F:"g",\u0121:"g",\u0123:"g",\u0124:"H",\u0126:"H",\u0125:"h",\u0127:"h",\u0128:"I",\u012A:"I",\u012C:"I",\u012E:"I",\u0130:"I",\u0129:"i",\u012B:"i",\u012D:"i",\u012F:"i",\u0131:"i",\u0134:"J",\u0135:"j",\u0136:"K",\u0137:"k",\u0138:"k",\u0139:"L",\u013B:"L",\u013D:"L",\u013F:"L",\u0141:"L",\u013A:"l",\u013C:"l",\u013E:"l",\u0140:"l",\u0142:"l",\u0143:"N",\u0145:"N",\u0147:"N",\u014A:"N",\u0144:"n",\u0146:"n",\u0148:"n",\u014B:"n",\u014C:"O",\u014E:"O",\u0150:"O",\u014D:"o",\u014F:"o",\u0151:"o",\u0154:"R",\u0156:"R",\u0158:"R",\u0155:"r",\u0157:"r",\u0159:"r",\u015A:"S",\u015C:"S",\u015E:"S",\u0160:"S",\u015B:"s",\u015D:"s",\u015F:"s",\u0161:"s",\u0162:"T",\u0164:"T",\u0166:"T",\u0163:"t",\u0165:"t",\u0167:"t",\u0168:"U",\u016A:"U",\u016C:"U",\u016E:"U",\u0170:"U",\u0172:"U",\u0169:"u",\u016B:"u",\u016D:"u",\u016F:"u",\u0171:"u",\u0173:"u",\u0174:"W",\u0175:"w",\u0176:"Y",\u0177:"y",\u0178:"Y",\u0179:"Z",\u017B:"Z",\u017D:"Z",\u017A:"z",\u017C:"z",\u017E:"z",\u0132:"IJ",\u0133:"ij",\u0152:"Oe",\u0153:"oe",\u0149:"'n",\u017F:"s"},G=P(D);se.exports=G},35234:function(se,$,C){var P=C(73893),D=function(){try{var G=P(Object,"defineProperty");return G({},"",{}),G}catch(Z){}}();se.exports=D},50401:function(se,$,C){var P=C(98924),D=C(64045),G=C(1931),Z=1,F=2;function z(q,ee,fe,be,Ie,Oe){var He=fe&Z,st=q.length,De=ee.length;if(st!=De&&!(He&&De>st))return!1;var je=Oe.get(q),we=Oe.get(ee);if(je&&we)return je==ee&&we==q;var Te=-1,le=!0,Re=fe&F?new P:void 0;for(Oe.set(q,ee),Oe.set(ee,q);++Te<st;){var ye=q[Te],_e=ee[Te];if(be)var ne=He?be(_e,ye,Te,ee,q,Oe):be(ye,_e,Te,q,ee,Oe);if(ne!==void 0){if(ne)continue;le=!1;break}if(Re){if(!D(ee,function(Y,Le){if(!G(Re,Le)&&(ye===Y||Ie(ye,Y,fe,be,Oe)))return Re.push(Le)})){le=!1;break}}else if(!(ye===_e||Ie(ye,_e,fe,be,Oe))){le=!1;break}}return Oe.delete(q),Oe.delete(ee),le}se.exports=z},57710:function(se,$,C){var P=C(91869),D=C(77945),G=C(43607),Z=C(50401),F=C(83383),z=C(79679),q=1,ee=2,fe="[object Boolean]",be="[object Date]",Ie="[object Error]",Oe="[object Map]",He="[object Number]",st="[object RegExp]",De="[object Set]",je="[object String]",we="[object Symbol]",Te="[object ArrayBuffer]",le="[object DataView]",Re=P?P.prototype:void 0,ye=Re?Re.valueOf:void 0;function _e(ne,Y,Le,de,Ee,ge,X){switch(Le){case le:if(ne.byteLength!=Y.byteLength||ne.byteOffset!=Y.byteOffset)return!1;ne=ne.buffer,Y=Y.buffer;case Te:return!(ne.byteLength!=Y.byteLength||!ge(new D(ne),new D(Y)));case fe:case be:case He:return G(+ne,+Y);case Ie:return ne.name==Y.name&&ne.message==Y.message;case st:case je:return ne==Y+"";case Oe:var Me=F;case De:var Ae=de&q;if(Me||(Me=z),ne.size!=Y.size&&!Ae)return!1;var me=X.get(ne);if(me)return me==Y;de|=ee,X.set(ne,Y);var ue=Z(Me(ne),Me(Y),de,Ee,ge,X);return X.delete(ne),ue;case we:if(ye)return ye.call(ne)==ye.call(Y)}return!1}se.exports=_e},4983:function(se,$,C){var P=C(12076),D=1,G=Object.prototype,Z=G.hasOwnProperty;function F(z,q,ee,fe,be,Ie){var Oe=ee&D,He=P(z),st=He.length,De=P(q),je=De.length;if(st!=je&&!Oe)return!1;for(var we=st;we--;){var Te=He[we];if(!(Oe?Te in q:Z.call(q,Te)))return!1}var le=Ie.get(z),Re=Ie.get(q);if(le&&Re)return le==q&&Re==z;var ye=!0;Ie.set(z,q),Ie.set(q,z);for(var _e=Oe;++we<st;){Te=He[we];var ne=z[Te],Y=q[Te];if(fe)var Le=Oe?fe(Y,ne,Te,q,z,Ie):fe(ne,Y,Te,z,q,Ie);if(!(Le===void 0?ne===Y||be(ne,Y,ee,fe,Ie):Le)){ye=!1;break}_e||(_e=Te=="constructor")}if(ye&&!_e){var de=z.constructor,Ee=q.constructor;de!=Ee&&"constructor"in z&&"constructor"in q&&!(typeof de=="function"&&de instanceof de&&typeof Ee=="function"&&Ee instanceof Ee)&&(ye=!1)}return Ie.delete(z),Ie.delete(q),ye}se.exports=F},37675:function(se,$,C){var P=typeof C.g=="object"&&C.g&&C.g.Object===Object&&C.g;se.exports=P},12076:function(se,$,C){var P=C(75635),D=C(58966),G=C(55451);function Z(F){return P(F,G,D)}se.exports=Z},22675:function(se,$,C){var P=C(75635),D=C(66817),G=C(56730);function Z(F){return P(F,G,D)}se.exports=Z},89819:function(se,$,C){var P=C(94358);function D(G,Z){var F=G.__data__;return P(Z)?F[typeof Z=="string"?"string":"hash"]:F.map}se.exports=D},73893:function(se,$,C){var P=C(6367),D=C(49966);function G(Z,F){var z=D(Z,F);return P(z)?z:void 0}se.exports=G},49217:function(se,$,C){var P=C(31030),D=P(Object.getPrototypeOf,Object);se.exports=D},72533:function(se,$,C){var P=C(91869),D=Object.prototype,G=D.hasOwnProperty,Z=D.toString,F=P?P.toStringTag:void 0;function z(q){var ee=G.call(q,F),fe=q[F];try{q[F]=void 0;var be=!0}catch(Oe){}var Ie=Z.call(q);return be&&(ee?q[F]=fe:delete q[F]),Ie}se.exports=z},58966:function(se,$,C){var P=C(86952),D=C(4134),G=Object.prototype,Z=G.propertyIsEnumerable,F=Object.getOwnPropertySymbols,z=F?function(q){return q==null?[]:(q=Object(q),P(F(q),function(ee){return Z.call(q,ee)}))}:D;se.exports=z},66817:function(se,$,C){var P=C(57095),D=C(49217),G=C(58966),Z=C(4134),F=Object.getOwnPropertySymbols,z=F?function(q){for(var ee=[];q;)P(ee,G(q)),q=D(q);return ee}:Z;se.exports=z},66139:function(se,$,C){var P=C(15584),D=C(40164),G=C(97288),Z=C(23599),F=C(26873),z=C(86756),q=C(63256),ee="[object Map]",fe="[object Object]",be="[object Promise]",Ie="[object Set]",Oe="[object WeakMap]",He="[object DataView]",st=q(P),De=q(D),je=q(G),we=q(Z),Te=q(F),le=z;(P&&le(new P(new ArrayBuffer(1)))!=He||D&&le(new D)!=ee||G&&le(G.resolve())!=be||Z&&le(new Z)!=Ie||F&&le(new F)!=Oe)&&(le=function(Re){var ye=z(Re),_e=ye==fe?Re.constructor:void 0,ne=_e?q(_e):"";if(ne)switch(ne){case st:return He;case De:return ee;case je:return be;case we:return Ie;case Te:return Oe}return ye}),se.exports=le},49966:function(se){function $(C,P){return C==null?void 0:C[P]}se.exports=$},55015:function(se){var $="\\ud800-\\udfff",C="\\u0300-\\u036f",P="\\ufe20-\\ufe2f",D="\\u20d0-\\u20ff",G=C+P+D,Z="\\ufe0e\\ufe0f",F="\\u200d",z=RegExp("["+F+$+G+Z+"]");function q(ee){return z.test(ee)}se.exports=q},62840:function(se){var $=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/;function C(P){return $.test(P)}se.exports=C},64696:function(se,$,C){var P=C(65294);function D(){this.__data__=P?P(null):{},this.size=0}se.exports=D},16824:function(se){function $(C){var P=this.has(C)&&delete this.__data__[C];return this.size-=P?1:0,P}se.exports=$},23476:function(se,$,C){var P=C(65294),D="__lodash_hash_undefined__",G=Object.prototype,Z=G.hasOwnProperty;function F(z){var q=this.__data__;if(P){var ee=q[z];return ee===D?void 0:ee}return Z.call(q,z)?q[z]:void 0}se.exports=F},63122:function(se,$,C){var P=C(65294),D=Object.prototype,G=D.hasOwnProperty;function Z(F){var z=this.__data__;return P?z[F]!==void 0:G.call(z,F)}se.exports=Z},37279:function(se,$,C){var P=C(65294),D="__lodash_hash_undefined__";function G(Z,F){var z=this.__data__;return this.size+=this.has(Z)?0:1,z[Z]=P&&F===void 0?D:F,this}se.exports=G},79264:function(se){var $=Object.prototype,C=$.hasOwnProperty;function P(D){var G=D.length,Z=new D.constructor(G);return G&&typeof D[0]=="string"&&C.call(D,"index")&&(Z.index=D.index,Z.input=D.input),Z}se.exports=P},97541:function(se,$,C){var P=C(20188),D=C(27984),G=C(78583),Z=C(28757),F=C(78358),z="[object Boolean]",q="[object Date]",ee="[object Map]",fe="[object Number]",be="[object RegExp]",Ie="[object Set]",Oe="[object String]",He="[object Symbol]",st="[object ArrayBuffer]",De="[object DataView]",je="[object Float32Array]",we="[object Float64Array]",Te="[object Int8Array]",le="[object Int16Array]",Re="[object Int32Array]",ye="[object Uint8Array]",_e="[object Uint8ClampedArray]",ne="[object Uint16Array]",Y="[object Uint32Array]";function Le(de,Ee,ge){var X=de.constructor;switch(Ee){case st:return P(de);case z:case q:return new X(+de);case De:return D(de,ge);case je:case we:case Te:case le:case Re:case ye:case _e:case ne:case Y:return F(de,ge);case ee:return new X;case fe:case Oe:return new X(de);case be:return G(de);case Ie:return new X;case He:return Z(de)}}se.exports=Le},4084:function(se,$,C){var P=C(35024),D=C(49217),G=C(7975);function Z(F){return typeof F.constructor=="function"&&!G(F)?P(D(F)):{}}se.exports=Z},70213:function(se){var $=9007199254740991,C=/^(?:0|[1-9]\d*)$/;function P(D,G){var Z=typeof D;return G=G==null?$:G,!!G&&(Z=="number"||Z!="symbol"&&C.test(D))&&D>-1&&D%1==0&&D<G}se.exports=P},8138:function(se,$,C){var P=C(43607),D=C(24665),G=C(70213),Z=C(20816);function F(z,q,ee){if(!Z(ee))return!1;var fe=typeof q;return(fe=="number"?D(ee)&&G(q,ee.length):fe=="string"&&q in ee)?P(ee[q],z):!1}se.exports=F},86773:function(se,$,C){var P=C(80744),D=C(45029),G=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Z=/^\w*$/;function F(z,q){if(P(z))return!1;var ee=typeof z;return ee=="number"||ee=="symbol"||ee=="boolean"||z==null||D(z)?!0:Z.test(z)||!G.test(z)||q!=null&&z in Object(q)}se.exports=F},94358:function(se){function $(C){var P=typeof C;return P=="string"||P=="number"||P=="symbol"||P=="boolean"?C!=="__proto__":C===null}se.exports=$},89379:function(se,$,C){var P=C(64218),D=function(){var Z=/[^.]+$/.exec(P&&P.keys&&P.keys.IE_PROTO||"");return Z?"Symbol(src)_1."+Z:""}();function G(Z){return!!D&&D in Z}se.exports=G},7975:function(se){var $=Object.prototype;function C(P){var D=P&&P.constructor,G=typeof D=="function"&&D.prototype||$;return P===G}se.exports=C},34251:function(se){function $(){this.__data__=[],this.size=0}se.exports=$},24968:function(se,$,C){var P=C(67971),D=Array.prototype,G=D.splice;function Z(F){var z=this.__data__,q=P(z,F);if(q<0)return!1;var ee=z.length-1;return q==ee?z.pop():G.call(z,q,1),--this.size,!0}se.exports=Z},28290:function(se,$,C){var P=C(67971);function D(G){var Z=this.__data__,F=P(Z,G);return F<0?void 0:Z[F][1]}se.exports=D},88068:function(se,$,C){var P=C(67971);function D(G){return P(this.__data__,G)>-1}se.exports=D},54238:function(se,$,C){var P=C(67971);function D(G,Z){var F=this.__data__,z=P(F,G);return z<0?(++this.size,F.push([G,Z])):F[z][1]=Z,this}se.exports=D},35365:function(se,$,C){var P=C(76414),D=C(99746),G=C(40164);function Z(){this.size=0,this.__data__={hash:new P,map:new(G||D),string:new P}}se.exports=Z},63765:function(se,$,C){var P=C(89819);function D(G){var Z=P(this,G).delete(G);return this.size-=Z?1:0,Z}se.exports=D},12608:function(se,$,C){var P=C(89819);function D(G){return P(this,G).get(G)}se.exports=D},10203:function(se,$,C){var P=C(89819);function D(G){return P(this,G).has(G)}se.exports=D},11298:function(se,$,C){var P=C(89819);function D(G,Z){var F=P(this,G),z=F.size;return F.set(G,Z),this.size+=F.size==z?0:1,this}se.exports=D},83383:function(se){function $(C){var P=-1,D=Array(C.size);return C.forEach(function(G,Z){D[++P]=[Z,G]}),D}se.exports=$},26332:function(se,$,C){var P=C(52858),D=500;function G(Z){var F=P(Z,function(q){return z.size===D&&z.clear(),q}),z=F.cache;return F}se.exports=G},65294:function(se,$,C){var P=C(73893),D=P(Object,"create");se.exports=D},23730:function(se,$,C){var P=C(31030),D=P(Object.keys,Object);se.exports=D},97817:function(se){function $(C){var P=[];if(C!=null)for(var D in Object(C))P.push(D);return P}se.exports=$},52495:function(se,$,C){se=C.nmd(se);var P=C(37675),D=$&&!$.nodeType&&$,G=D&&!0&&se&&!se.nodeType&&se,Z=G&&G.exports===D,F=Z&&P.process,z=function(){try{var q=G&&G.require&&G.require("util").types;return q||F&&F.binding&&F.binding("util")}catch(ee){}}();se.exports=z},74702:function(se){var $=Object.prototype,C=$.toString;function P(D){return C.call(D)}se.exports=P},31030:function(se){function $(C,P){return function(D){return C(P(D))}}se.exports=$},19652:function(se,$,C){var P=C(79628),D=Math.max;function G(Z,F,z){return F=D(F===void 0?Z.length-1:F,0),function(){for(var q=arguments,ee=-1,fe=D(q.length-F,0),be=Array(fe);++ee<fe;)be[ee]=q[F+ee];ee=-1;for(var Ie=Array(F+1);++ee<F;)Ie[ee]=q[ee];return Ie[F]=z(be),P(Z,this,Ie)}}se.exports=G},33152:function(se,$,C){var P=C(37675),D=typeof self=="object"&&self&&self.Object===Object&&self,G=P||D||Function("return this")();se.exports=G},47052:function(se){function $(C,P){if(!(P==="constructor"&&typeof C[P]=="function")&&P!="__proto__")return C[P]}se.exports=$},34776:function(se){var $="__lodash_hash_undefined__";function C(P){return this.__data__.set(P,$),this}se.exports=C},40393:function(se){function $(C){return this.__data__.has(C)}se.exports=$},79679:function(se){function $(C){var P=-1,D=Array(C.size);return C.forEach(function(G){D[++P]=G}),D}se.exports=$},71152:function(se,$,C){var P=C(63989),D=C(78437),G=D(P);se.exports=G},78437:function(se){var $=800,C=16,P=Date.now;function D(G){var Z=0,F=0;return function(){var z=P(),q=C-(z-F);if(F=z,q>0){if(++Z>=$)return arguments[0]}else Z=0;return G.apply(void 0,arguments)}}se.exports=D},31119:function(se,$,C){var P=C(99746);function D(){this.__data__=new P,this.size=0}se.exports=D},64399:function(se){function $(C){var P=this.__data__,D=P.delete(C);return this.size=P.size,D}se.exports=$},81897:function(se){function $(C){return this.__data__.get(C)}se.exports=$},90558:function(se){function $(C){return this.__data__.has(C)}se.exports=$},64841:function(se,$,C){var P=C(99746),D=C(40164),G=C(52166),Z=200;function F(z,q){var ee=this.__data__;if(ee instanceof P){var fe=ee.__data__;if(!D||fe.length<Z-1)return fe.push([z,q]),this.size=++ee.size,this;ee=this.__data__=new G(fe)}return ee.set(z,q),this.size=ee.size,this}se.exports=F},49237:function(se){function $(C,P,D){for(var G=D-1,Z=C.length;++G<Z;)if(C[G]===P)return G;return-1}se.exports=$},80935:function(se,$,C){var P=C(72828),D=C(55015),G=C(17826);function Z(F){return D(F)?G(F):P(F)}se.exports=Z},40493:function(se,$,C){var P=C(26332),D=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,G=/\\(\\)?/g,Z=P(function(F){var z=[];return F.charCodeAt(0)===46&&z.push(""),F.replace(D,function(q,ee,fe,be){z.push(fe?be.replace(G,"$1"):ee||q)}),z});se.exports=Z},9171:function(se,$,C){var P=C(45029),D=1/0;function G(Z){if(typeof Z=="string"||P(Z))return Z;var F=Z+"";return F=="0"&&1/Z==-D?"-0":F}se.exports=G},63256:function(se){var $=Function.prototype,C=$.toString;function P(D){if(D!=null){try{return C.call(D)}catch(G){}try{return D+""}catch(G){}}return""}se.exports=P},15333:function(se){var $=/\s/;function C(P){for(var D=P.length;D--&&$.test(P.charAt(D)););return D}se.exports=C},17826:function(se){var $="\\ud800-\\udfff",C="\\u0300-\\u036f",P="\\ufe20-\\ufe2f",D="\\u20d0-\\u20ff",G=C+P+D,Z="\\ufe0e\\ufe0f",F="["+$+"]",z="["+G+"]",q="\\ud83c[\\udffb-\\udfff]",ee="(?:"+z+"|"+q+")",fe="[^"+$+"]",be="(?:\\ud83c[\\udde6-\\uddff]){2}",Ie="[\\ud800-\\udbff][\\udc00-\\udfff]",Oe="\\u200d",He=ee+"?",st="["+Z+"]?",De="(?:"+Oe+"(?:"+[fe,be,Ie].join("|")+")"+st+He+")*",je=st+He+De,we="(?:"+[fe+z+"?",z,be,Ie,F].join("|")+")",Te=RegExp(q+"(?="+q+")|"+we+je,"g");function le(Re){return Re.match(Te)||[]}se.exports=le},97681:function(se){var $="\\ud800-\\udfff",C="\\u0300-\\u036f",P="\\ufe20-\\ufe2f",D="\\u20d0-\\u20ff",G=C+P+D,Z="\\u2700-\\u27bf",F="a-z\\xdf-\\xf6\\xf8-\\xff",z="\\xac\\xb1\\xd7\\xf7",q="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",ee="\\u2000-\\u206f",fe=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",be="A-Z\\xc0-\\xd6\\xd8-\\xde",Ie="\\ufe0e\\ufe0f",Oe=z+q+ee+fe,He="['\u2019]",st="["+Oe+"]",De="["+G+"]",je="\\d+",we="["+Z+"]",Te="["+F+"]",le="[^"+$+Oe+je+Z+F+be+"]",Re="\\ud83c[\\udffb-\\udfff]",ye="(?:"+De+"|"+Re+")",_e="[^"+$+"]",ne="(?:\\ud83c[\\udde6-\\uddff]){2}",Y="[\\ud800-\\udbff][\\udc00-\\udfff]",Le="["+be+"]",de="\\u200d",Ee="(?:"+Te+"|"+le+")",ge="(?:"+Le+"|"+le+")",X="(?:"+He+"(?:d|ll|m|re|s|t|ve))?",Me="(?:"+He+"(?:D|LL|M|RE|S|T|VE))?",Ae=ye+"?",me="["+Ie+"]?",ue="(?:"+de+"(?:"+[_e,ne,Y].join("|")+")"+me+Ae+")*",ke="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",Ze="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",oe=me+Ae+ue,Dt="(?:"+[we,ne,Y].join("|")+")"+oe,Rt=RegExp([Le+"?"+Te+"+"+X+"(?="+[st,Le,"$"].join("|")+")",ge+"+"+Me+"(?="+[st,Le+Ee,"$"].join("|")+")",Le+"?"+Ee+"+"+X,Le+"+"+Me,Ze,ke,je,Dt].join("|"),"g");function cr(Ut){return Ut.match(Rt)||[]}se.exports=cr},34301:function(se,$,C){var P=C(30225),D=C(74749),G=D(function(Z,F,z){return F=F.toLowerCase(),Z+(z?P(F):F)});se.exports=G},30225:function(se,$,C){var P=C(44140),D=C(53592);function G(Z){return D(P(Z).toLowerCase())}se.exports=G},61400:function(se,$,C){var P=C(14318),D=C(20168);function G(Z,F,z){return z===void 0&&(z=F,F=void 0),z!==void 0&&(z=D(z),z=z===z?z:0),F!==void 0&&(F=D(F),F=F===F?F:0),P(D(Z),F,z)}se.exports=G},20250:function(se,$,C){var P=C(99045),D=1,G=4;function Z(F){return P(F,D|G)}se.exports=Z},13503:function(se){function $(C){return function(){return C}}se.exports=$},41571:function(se,$,C){var P=C(20816),D=C(5795),G=C(20168),Z="Expected a function",F=Math.max,z=Math.min;function q(ee,fe,be){var Ie,Oe,He,st,De,je,we=0,Te=!1,le=!1,Re=!0;if(typeof ee!="function")throw new TypeError(Z);fe=G(fe)||0,P(be)&&(Te=!!be.leading,le="maxWait"in be,He=le?F(G(be.maxWait)||0,fe):He,Re="trailing"in be?!!be.trailing:Re);function ye(Me){var Ae=Ie,me=Oe;return Ie=Oe=void 0,we=Me,st=ee.apply(me,Ae),st}function _e(Me){return we=Me,De=setTimeout(Le,fe),Te?ye(Me):st}function ne(Me){var Ae=Me-je,me=Me-we,ue=fe-Ae;return le?z(ue,He-me):ue}function Y(Me){var Ae=Me-je,me=Me-we;return je===void 0||Ae>=fe||Ae<0||le&&me>=He}function Le(){var Me=D();if(Y(Me))return de(Me);De=setTimeout(Le,ne(Me))}function de(Me){return De=void 0,Re&&Ie?ye(Me):(Ie=Oe=void 0,st)}function Ee(){De!==void 0&&clearTimeout(De),we=0,Ie=je=Oe=De=void 0}function ge(){return De===void 0?st:de(D())}function X(){var Me=D(),Ae=Y(Me);if(Ie=arguments,Oe=this,je=Me,Ae){if(De===void 0)return _e(je);if(le)return clearTimeout(De),De=setTimeout(Le,fe),ye(je)}return De===void 0&&(De=setTimeout(Le,fe)),st}return X.cancel=Ee,X.flush=ge,X}se.exports=q},31876:function(se,$,C){var P=C(70668),D=C(44140),G=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,Z="\\u0300-\\u036f",F="\\ufe20-\\ufe2f",z="\\u20d0-\\u20ff",q=Z+F+z,ee="["+q+"]",fe=RegExp(ee,"g");function be(Ie){return Ie=D(Ie),Ie&&Ie.replace(G,P).replace(fe,"")}se.exports=be},43607:function(se){function $(C,P){return C===P||C!==C&&P!==P}se.exports=$},44231:function(se,$,C){var P=C(89147);function D(G,Z,F){var z=G==null?void 0:P(G,Z);return z===void 0?F:z}se.exports=D},46962:function(se){function $(C){return C}se.exports=$},13053:function(se,$,C){var P=C(4977),D=C(93913),G=Object.prototype,Z=G.hasOwnProperty,F=G.propertyIsEnumerable,z=P(function(){return arguments}())?P:function(q){return D(q)&&Z.call(q,"callee")&&!F.call(q,"callee")};se.exports=z},80744:function(se){var $=Array.isArray;se.exports=$},24665:function(se,$,C){var P=C(9363),D=C(11156);function G(Z){return Z!=null&&D(Z.length)&&!P(Z)}se.exports=G},41590:function(se,$,C){var P=C(24665),D=C(93913);function G(Z){return D(Z)&&P(Z)}se.exports=G},26561:function(se,$,C){var P=C(86756),D=C(93913),G="[object Boolean]";function Z(F){return F===!0||F===!1||D(F)&&P(F)==G}se.exports=Z},57835:function(se,$,C){se=C.nmd(se);var P=C(33152),D=C(55950),G=$&&!$.nodeType&&$,Z=G&&!0&&se&&!se.nodeType&&se,F=Z&&Z.exports===G,z=F?P.Buffer:void 0,q=z?z.isBuffer:void 0,ee=q||D;se.exports=ee},98621:function(se,$,C){var P=C(77295);function D(G,Z){return P(G,Z)}se.exports=D},9363:function(se,$,C){var P=C(86756),D=C(20816),G="[object AsyncFunction]",Z="[object Function]",F="[object GeneratorFunction]",z="[object Proxy]";function q(ee){if(!D(ee))return!1;var fe=P(ee);return fe==Z||fe==F||fe==G||fe==z}se.exports=q},11156:function(se){var $=9007199254740991;function C(P){return typeof P=="number"&&P>-1&&P%1==0&&P<=$}se.exports=C},41626:function(se,$,C){var P=C(55005),D=C(38342),G=C(52495),Z=G&&G.isMap,F=Z?D(Z):P;se.exports=F},93544:function(se){function $(C){return C==null}se.exports=$},68868:function(se,$,C){var P=C(86756),D=C(93913),G="[object Number]";function Z(F){return typeof F=="number"||D(F)&&P(F)==G}se.exports=Z},20816:function(se){function $(C){var P=typeof C;return C!=null&&(P=="object"||P=="function")}se.exports=$},93913:function(se){function $(C){return C!=null&&typeof C=="object"}se.exports=$},19308:function(se,$,C){var P=C(86756),D=C(49217),G=C(93913),Z="[object Object]",F=Function.prototype,z=Object.prototype,q=F.toString,ee=z.hasOwnProperty,fe=q.call(Object);function be(Ie){if(!G(Ie)||P(Ie)!=Z)return!1;var Oe=D(Ie);if(Oe===null)return!0;var He=ee.call(Oe,"constructor")&&Oe.constructor;return typeof He=="function"&&He instanceof He&&q.call(He)==fe}se.exports=be},65226:function(se,$,C){var P=C(38652),D=C(38342),G=C(52495),Z=G&&G.isSet,F=Z?D(Z):P;se.exports=F},7941:function(se,$,C){var P=C(86756),D=C(80744),G=C(93913),Z="[object String]";function F(z){return typeof z=="string"||!D(z)&&G(z)&&P(z)==Z}se.exports=F},45029:function(se,$,C){var P=C(86756),D=C(93913),G="[object Symbol]";function Z(F){return typeof F=="symbol"||D(F)&&P(F)==G}se.exports=Z},18397:function(se,$,C){var P=C(10766),D=C(38342),G=C(52495),Z=G&&G.isTypedArray,F=Z?D(Z):P;se.exports=F},16513:function(se){function $(C){return C===void 0}se.exports=$},55451:function(se,$,C){var P=C(63333),D=C(6019),G=C(24665);function Z(F){return G(F)?P(F):D(F)}se.exports=Z},56730:function(se,$,C){var P=C(63333),D=C(33988),G=C(24665);function Z(F){return G(F)?P(F,!0):D(F)}se.exports=Z},52858:function(se,$,C){var P=C(52166),D="Expected a function";function G(Z,F){if(typeof Z!="function"||F!=null&&typeof F!="function")throw new TypeError(D);var z=function(){var q=arguments,ee=F?F.apply(this,q):q[0],fe=z.cache;if(fe.has(ee))return fe.get(ee);var be=Z.apply(this,q);return z.cache=fe.set(ee,be)||fe,be};return z.cache=new(G.Cache||P),z}G.Cache=P,se.exports=G},28440:function(se,$,C){var P=C(50097),D=C(63323),G=D(function(Z,F,z){P(Z,F,z)});se.exports=G},24602:function(se,$,C){var P=C(50097),D=C(63323),G=D(function(Z,F,z,q){P(Z,F,z,q)});se.exports=G},9958:function(se){function $(){}se.exports=$},5795:function(se,$,C){var P=C(33152),D=function(){return P.Date.now()};se.exports=D},63536:function(se,$,C){var P=C(92918),D=C(14989),G=P(D);se.exports=G},14989:function(se,$,C){var P=C(23442);function D(G,Z){return G&&G.length&&Z&&Z.length?P(G,Z):G}se.exports=D},4134:function(se){function $(){return[]}se.exports=$},55950:function(se){function $(){return!1}se.exports=$},46700:function(se,$,C){var P=C(41571),D=C(20816),G="Expected a function";function Z(F,z,q){var ee=!0,fe=!0;if(typeof F!="function")throw new TypeError(G);return D(q)&&(ee="leading"in q?!!q.leading:ee,fe="trailing"in q?!!q.trailing:fe),P(F,z,{leading:ee,maxWait:z,trailing:fe})}se.exports=Z},20168:function(se,$,C){var P=C(13927),D=C(20816),G=C(45029),Z=0/0,F=/^[-+]0x[0-9a-f]+$/i,z=/^0b[01]+$/i,q=/^0o[0-7]+$/i,ee=parseInt;function fe(be){if(typeof be=="number")return be;if(G(be))return Z;if(D(be)){var Ie=typeof be.valueOf=="function"?be.valueOf():be;be=D(Ie)?Ie+"":Ie}if(typeof be!="string")return be===0?be:+be;be=P(be);var Oe=z.test(be);return Oe||q.test(be)?ee(be.slice(2),Oe?2:8):F.test(be)?Z:+be}se.exports=fe},20480:function(se,$,C){var P=C(95378),D=C(56730);function G(Z){return P(Z,D(Z))}se.exports=G},44140:function(se,$,C){var P=C(50230);function D(G){return G==null?"":P(G)}se.exports=D},21691:function(se,$,C){var P=C(29098);function D(G){return G&&G.length?P(G):[]}se.exports=D},53592:function(se,$,C){var P=C(97815),D=P("toUpperCase");se.exports=D},61503:function(se,$,C){var P=C(34130),D=C(62840),G=C(44140),Z=C(97681);function F(z,q,ee){return z=G(z),q=ee?void 0:q,q===void 0?D(z)?Z(z):P(z):z.match(q)||[]}se.exports=F},84126:function(se){"use strict";var $=Object.getOwnPropertySymbols,C=Object.prototype.hasOwnProperty,P=Object.prototype.propertyIsEnumerable;function D(Z){if(Z==null)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(Z)}function G(){try{if(!Object.assign)return!1;var Z=new String("abc");if(Z[5]="de",Object.getOwnPropertyNames(Z)[0]==="5")return!1;for(var F={},z=0;z<10;z++)F["_"+String.fromCharCode(z)]=z;var q=Object.getOwnPropertyNames(F).map(function(fe){return F[fe]});if(q.join("")!=="0123456789")return!1;var ee={};return"abcdefghijklmnopqrst".split("").forEach(function(fe){ee[fe]=fe}),Object.keys(Object.assign({},ee)).join("")==="abcdefghijklmnopqrst"}catch(fe){return!1}}se.exports=G()?Object.assign:function(Z,F){for(var z,q=D(Z),ee,fe=1;fe<arguments.length;fe++){z=Object(arguments[fe]);for(var be in z)C.call(z,be)&&(q[be]=z[be]);if($){ee=$(z);for(var Ie=0;Ie<ee.length;Ie++)P.call(z,ee[Ie])&&(q[ee[Ie]]=z[ee[Ie]])}}return q}},73868:function(se){"use strict";var $=function(C){return C!==C};se.exports=function(P,D){return P===0&&D===0?1/P===1/D:!!(P===D||$(P)&&$(D))}},6392:function(se,$,C){"use strict";var P=C(8263),D=C(71262),G=C(73868),Z=C(33757),F=C(68998),z=D(Z(),Object);P(z,{getPolyfill:Z,implementation:G,shim:F}),se.exports=z},33757:function(se,$,C){"use strict";var P=C(73868);se.exports=function(){return typeof Object.is=="function"?Object.is:P}},68998:function(se,$,C){"use strict";var P=C(33757),D=C(8263);se.exports=function(){var Z=P();return D(Object,{is:Z},{is:function(){return Object.is!==Z}}),Z}},2822:function(se,$,C){"use strict";var P;if(!Object.keys){var D=Object.prototype.hasOwnProperty,G=Object.prototype.toString,Z=C(11635),F=Object.prototype.propertyIsEnumerable,z=!F.call({toString:null},"toString"),q=F.call(function(){},"prototype"),ee=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],fe=function(He){var st=He.constructor;return st&&st.prototype===He},be={$applicationCache:!0,$console:!0,$external:!0,$frame:!0,$frameElement:!0,$frames:!0,$innerHeight:!0,$innerWidth:!0,$onmozfullscreenchange:!0,$onmozfullscreenerror:!0,$outerHeight:!0,$outerWidth:!0,$pageXOffset:!0,$pageYOffset:!0,$parent:!0,$scrollLeft:!0,$scrollTop:!0,$scrollX:!0,$scrollY:!0,$self:!0,$webkitIndexedDB:!0,$webkitStorageInfo:!0,$window:!0},Ie=function(){if(typeof window=="undefined")return!1;for(var He in window)try{if(!be["$"+He]&&D.call(window,He)&&window[He]!==null&&typeof window[He]=="object")try{fe(window[He])}catch(st){return!0}}catch(st){return!0}return!1}(),Oe=function(He){if(typeof window=="undefined"||!Ie)return fe(He);try{return fe(He)}catch(st){return!1}};P=function(st){var De=st!==null&&typeof st=="object",je=G.call(st)==="[object Function]",we=Z(st),Te=De&&G.call(st)==="[object String]",le=[];if(!De&&!je&&!we)throw new TypeError("Object.keys called on a non-object");var Re=q&&je;if(Te&&st.length>0&&!D.call(st,0))for(var ye=0;ye<st.length;++ye)le.push(String(ye));if(we&&st.length>0)for(var _e=0;_e<st.length;++_e)le.push(String(_e));else for(var ne in st)!(Re&&ne==="prototype")&&D.call(st,ne)&&le.push(String(ne));if(z)for(var Y=Oe(st),Le=0;Le<ee.length;++Le)!(Y&&ee[Le]==="constructor")&&D.call(st,ee[Le])&&le.push(ee[Le]);return le}}se.exports=P},64253:function(se,$,C){"use strict";var P=Array.prototype.slice,D=C(11635),G=Object.keys,Z=G?function(q){return G(q)}:C(2822),F=Object.keys;Z.shim=function(){if(Object.keys){var q=function(){var ee=Object.keys(arguments);return ee&&ee.length===arguments.length}(1,2);q||(Object.keys=function(fe){return D(fe)?F(P.call(fe)):F(fe)})}else Object.keys=Z;return Object.keys||Z},se.exports=Z},11635:function(se){"use strict";var $=Object.prototype.toString;se.exports=function(P){var D=$.call(P),G=D==="[object Arguments]";return G||(G=D!=="[object Array]"&&P!==null&&typeof P=="object"&&typeof P.length=="number"&&P.length>=0&&$.call(P.callee)==="[object Function]"),G}},88959:function(se,$,C){"use strict";se.exports=D;var P=C(67467);function D(X){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(X)?X:new Uint8Array(X||0),this.pos=0,this.type=0,this.length=this.buf.length}D.Varint=0,D.Fixed64=1,D.Bytes=2,D.Fixed32=5;var G=65536*65536,Z=1/G,F=12,z=typeof TextDecoder=="undefined"?null:new TextDecoder("utf8");D.prototype={destroy:function(){this.buf=null},readFields:function(X,Me,Ae){for(Ae=Ae||this.length;this.pos<Ae;){var me=this.readVarint(),ue=me>>3,ke=this.pos;this.type=me&7,X(ue,Me,this),this.pos===ke&&this.skip(me)}return Me},readMessage:function(X,Me){return this.readFields(X,Me,this.readVarint()+this.pos)},readFixed32:function(){var X=ne(this.buf,this.pos);return this.pos+=4,X},readSFixed32:function(){var X=Le(this.buf,this.pos);return this.pos+=4,X},readFixed64:function(){var X=ne(this.buf,this.pos)+ne(this.buf,this.pos+4)*G;return this.pos+=8,X},readSFixed64:function(){var X=ne(this.buf,this.pos)+Le(this.buf,this.pos+4)*G;return this.pos+=8,X},readFloat:function(){var X=P.read(this.buf,this.pos,!0,23,4);return this.pos+=4,X},readDouble:function(){var X=P.read(this.buf,this.pos,!0,52,8);return this.pos+=8,X},readVarint:function(X){var Me=this.buf,Ae,me;return me=Me[this.pos++],Ae=me&127,me<128||(me=Me[this.pos++],Ae|=(me&127)<<7,me<128)||(me=Me[this.pos++],Ae|=(me&127)<<14,me<128)||(me=Me[this.pos++],Ae|=(me&127)<<21,me<128)?Ae:(me=Me[this.pos],Ae|=(me&15)<<28,q(Ae,X,this))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var X=this.readVarint();return X%2===1?(X+1)/-2:X/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var X=this.readVarint()+this.pos,Me=this.pos;return this.pos=X,X-Me>=F&&z?Ee(this.buf,Me,X):de(this.buf,Me,X)},readBytes:function(){var X=this.readVarint()+this.pos,Me=this.buf.subarray(this.pos,X);return this.pos=X,Me},readPackedVarint:function(X,Me){if(this.type!==D.Bytes)return X.push(this.readVarint(Me));var Ae=ee(this);for(X=X||[];this.pos<Ae;)X.push(this.readVarint(Me));return X},readPackedSVarint:function(X){if(this.type!==D.Bytes)return X.push(this.readSVarint());var Me=ee(this);for(X=X||[];this.pos<Me;)X.push(this.readSVarint());return X},readPackedBoolean:function(X){if(this.type!==D.Bytes)return X.push(this.readBoolean());var Me=ee(this);for(X=X||[];this.pos<Me;)X.push(this.readBoolean());return X},readPackedFloat:function(X){if(this.type!==D.Bytes)return X.push(this.readFloat());var Me=ee(this);for(X=X||[];this.pos<Me;)X.push(this.readFloat());return X},readPackedDouble:function(X){if(this.type!==D.Bytes)return X.push(this.readDouble());var Me=ee(this);for(X=X||[];this.pos<Me;)X.push(this.readDouble());return X},readPackedFixed32:function(X){if(this.type!==D.Bytes)return X.push(this.readFixed32());var Me=ee(this);for(X=X||[];this.pos<Me;)X.push(this.readFixed32());return X},readPackedSFixed32:function(X){if(this.type!==D.Bytes)return X.push(this.readSFixed32());var Me=ee(this);for(X=X||[];this.pos<Me;)X.push(this.readSFixed32());return X},readPackedFixed64:function(X){if(this.type!==D.Bytes)return X.push(this.readFixed64());var Me=ee(this);for(X=X||[];this.pos<Me;)X.push(this.readFixed64());return X},readPackedSFixed64:function(X){if(this.type!==D.Bytes)return X.push(this.readSFixed64());var Me=ee(this);for(X=X||[];this.pos<Me;)X.push(this.readSFixed64());return X},skip:function(X){var Me=X&7;if(Me===D.Varint)for(;this.buf[this.pos++]>127;);else if(Me===D.Bytes)this.pos=this.readVarint()+this.pos;else if(Me===D.Fixed32)this.pos+=4;else if(Me===D.Fixed64)this.pos+=8;else throw new Error("Unimplemented type: "+Me)},writeTag:function(X,Me){this.writeVarint(X<<3|Me)},realloc:function(X){for(var Me=this.length||16;Me<this.pos+X;)Me*=2;if(Me!==this.length){var Ae=new Uint8Array(Me);Ae.set(this.buf),this.buf=Ae,this.length=Me}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(X){this.realloc(4),Y(this.buf,X,this.pos),this.pos+=4},writeSFixed32:function(X){this.realloc(4),Y(this.buf,X,this.pos),this.pos+=4},writeFixed64:function(X){this.realloc(8),Y(this.buf,X&-1,this.pos),Y(this.buf,Math.floor(X*Z),this.pos+4),this.pos+=8},writeSFixed64:function(X){this.realloc(8),Y(this.buf,X&-1,this.pos),Y(this.buf,Math.floor(X*Z),this.pos+4),this.pos+=8},writeVarint:function(X){if(X=+X||0,X>268435455||X<0){be(X,this);return}this.realloc(4),this.buf[this.pos++]=X&127|(X>127?128:0),!(X<=127)&&(this.buf[this.pos++]=(X>>>=7)&127|(X>127?128:0),!(X<=127)&&(this.buf[this.pos++]=(X>>>=7)&127|(X>127?128:0),!(X<=127)&&(this.buf[this.pos++]=X>>>7&127)))},writeSVarint:function(X){this.writeVarint(X<0?-X*2-1:X*2)},writeBoolean:function(X){this.writeVarint(!!X)},writeString:function(X){X=String(X),this.realloc(X.length*4),this.pos++;var Me=this.pos;this.pos=ge(this.buf,X,this.pos);var Ae=this.pos-Me;Ae>=128&&He(Me,Ae,this),this.pos=Me-1,this.writeVarint(Ae),this.pos+=Ae},writeFloat:function(X){this.realloc(4),P.write(this.buf,X,this.pos,!0,23,4),this.pos+=4},writeDouble:function(X){this.realloc(8),P.write(this.buf,X,this.pos,!0,52,8),this.pos+=8},writeBytes:function(X){var Me=X.length;this.writeVarint(Me),this.realloc(Me);for(var Ae=0;Ae<Me;Ae++)this.buf[this.pos++]=X[Ae]},writeRawMessage:function(X,Me){this.pos++;var Ae=this.pos;X(Me,this);var me=this.pos-Ae;me>=128&&He(Ae,me,this),this.pos=Ae-1,this.writeVarint(me),this.pos+=me},writeMessage:function(X,Me,Ae){this.writeTag(X,D.Bytes),this.writeRawMessage(Me,Ae)},writePackedVarint:function(X,Me){Me.length&&this.writeMessage(X,st,Me)},writePackedSVarint:function(X,Me){Me.length&&this.writeMessage(X,De,Me)},writePackedBoolean:function(X,Me){Me.length&&this.writeMessage(X,Te,Me)},writePackedFloat:function(X,Me){Me.length&&this.writeMessage(X,je,Me)},writePackedDouble:function(X,Me){Me.length&&this.writeMessage(X,we,Me)},writePackedFixed32:function(X,Me){Me.length&&this.writeMessage(X,le,Me)},writePackedSFixed32:function(X,Me){Me.length&&this.writeMessage(X,Re,Me)},writePackedFixed64:function(X,Me){Me.length&&this.writeMessage(X,ye,Me)},writePackedSFixed64:function(X,Me){Me.length&&this.writeMessage(X,_e,Me)},writeBytesField:function(X,Me){this.writeTag(X,D.Bytes),this.writeBytes(Me)},writeFixed32Field:function(X,Me){this.writeTag(X,D.Fixed32),this.writeFixed32(Me)},writeSFixed32Field:function(X,Me){this.writeTag(X,D.Fixed32),this.writeSFixed32(Me)},writeFixed64Field:function(X,Me){this.writeTag(X,D.Fixed64),this.writeFixed64(Me)},writeSFixed64Field:function(X,Me){this.writeTag(X,D.Fixed64),this.writeSFixed64(Me)},writeVarintField:function(X,Me){this.writeTag(X,D.Varint),this.writeVarint(Me)},writeSVarintField:function(X,Me){this.writeTag(X,D.Varint),this.writeSVarint(Me)},writeStringField:function(X,Me){this.writeTag(X,D.Bytes),this.writeString(Me)},writeFloatField:function(X,Me){this.writeTag(X,D.Fixed32),this.writeFloat(Me)},writeDoubleField:function(X,Me){this.writeTag(X,D.Fixed64),this.writeDouble(Me)},writeBooleanField:function(X,Me){this.writeVarintField(X,!!Me)}};function q(X,Me,Ae){var me=Ae.buf,ue,ke;if(ke=me[Ae.pos++],ue=(ke&112)>>4,ke<128||(ke=me[Ae.pos++],ue|=(ke&127)<<3,ke<128)||(ke=me[Ae.pos++],ue|=(ke&127)<<10,ke<128)||(ke=me[Ae.pos++],ue|=(ke&127)<<17,ke<128)||(ke=me[Ae.pos++],ue|=(ke&127)<<24,ke<128)||(ke=me[Ae.pos++],ue|=(ke&1)<<31,ke<128))return fe(X,ue,Me);throw new Error("Expected varint not more than 10 bytes")}function ee(X){return X.type===D.Bytes?X.readVarint()+X.pos:X.pos+1}function fe(X,Me,Ae){return Ae?Me*4294967296+(X>>>0):(Me>>>0)*4294967296+(X>>>0)}function be(X,Me){var Ae,me;if(X>=0?(Ae=X%4294967296|0,me=X/4294967296|0):(Ae=~(-X%4294967296),me=~(-X/4294967296),Ae^4294967295?Ae=Ae+1|0:(Ae=0,me=me+1|0)),X>=18446744073709552e3||X<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");Me.realloc(10),Ie(Ae,me,Me),Oe(me,Me)}function Ie(X,Me,Ae){Ae.buf[Ae.pos++]=X&127|128,X>>>=7,Ae.buf[Ae.pos++]=X&127|128,X>>>=7,Ae.buf[Ae.pos++]=X&127|128,X>>>=7,Ae.buf[Ae.pos++]=X&127|128,X>>>=7,Ae.buf[Ae.pos]=X&127}function Oe(X,Me){var Ae=(X&7)<<4;Me.buf[Me.pos++]|=Ae|((X>>>=3)?128:0),X&&(Me.buf[Me.pos++]=X&127|((X>>>=7)?128:0),X&&(Me.buf[Me.pos++]=X&127|((X>>>=7)?128:0),X&&(Me.buf[Me.pos++]=X&127|((X>>>=7)?128:0),X&&(Me.buf[Me.pos++]=X&127|((X>>>=7)?128:0),X&&(Me.buf[Me.pos++]=X&127)))))}function He(X,Me,Ae){var me=Me<=16383?1:Me<=2097151?2:Me<=268435455?3:Math.floor(Math.log(Me)/(Math.LN2*7));Ae.realloc(me);for(var ue=Ae.pos-1;ue>=X;ue--)Ae.buf[ue+me]=Ae.buf[ue]}function st(X,Me){for(var Ae=0;Ae<X.length;Ae++)Me.writeVarint(X[Ae])}function De(X,Me){for(var Ae=0;Ae<X.length;Ae++)Me.writeSVarint(X[Ae])}function je(X,Me){for(var Ae=0;Ae<X.length;Ae++)Me.writeFloat(X[Ae])}function we(X,Me){for(var Ae=0;Ae<X.length;Ae++)Me.writeDouble(X[Ae])}function Te(X,Me){for(var Ae=0;Ae<X.length;Ae++)Me.writeBoolean(X[Ae])}function le(X,Me){for(var Ae=0;Ae<X.length;Ae++)Me.writeFixed32(X[Ae])}function Re(X,Me){for(var Ae=0;Ae<X.length;Ae++)Me.writeSFixed32(X[Ae])}function ye(X,Me){for(var Ae=0;Ae<X.length;Ae++)Me.writeFixed64(X[Ae])}function _e(X,Me){for(var Ae=0;Ae<X.length;Ae++)Me.writeSFixed64(X[Ae])}function ne(X,Me){return(X[Me]|X[Me+1]<<8|X[Me+2]<<16)+X[Me+3]*16777216}function Y(X,Me,Ae){X[Ae]=Me,X[Ae+1]=Me>>>8,X[Ae+2]=Me>>>16,X[Ae+3]=Me>>>24}function Le(X,Me){return(X[Me]|X[Me+1]<<8|X[Me+2]<<16)+(X[Me+3]<<24)}function de(X,Me,Ae){for(var me="",ue=Me;ue<Ae;){var ke=X[ue],Ze=null,oe=ke>239?4:ke>223?3:ke>191?2:1;if(ue+oe>Ae)break;var Dt,Rt,cr;oe===1?ke<128&&(Ze=ke):oe===2?(Dt=X[ue+1],(Dt&192)===128&&(Ze=(ke&31)<<6|Dt&63,Ze<=127&&(Ze=null))):oe===3?(Dt=X[ue+1],Rt=X[ue+2],(Dt&192)===128&&(Rt&192)===128&&(Ze=(ke&15)<<12|(Dt&63)<<6|Rt&63,(Ze<=2047||Ze>=55296&&Ze<=57343)&&(Ze=null))):oe===4&&(Dt=X[ue+1],Rt=X[ue+2],cr=X[ue+3],(Dt&192)===128&&(Rt&192)===128&&(cr&192)===128&&(Ze=(ke&15)<<18|(Dt&63)<<12|(Rt&63)<<6|cr&63,(Ze<=65535||Ze>=1114112)&&(Ze=null))),Ze===null?(Ze=65533,oe=1):Ze>65535&&(Ze-=65536,me+=String.fromCharCode(Ze>>>10&1023|55296),Ze=56320|Ze&1023),me+=String.fromCharCode(Ze),ue+=oe}return me}function Ee(X,Me,Ae){return z.decode(X.subarray(Me,Ae))}function ge(X,Me,Ae){for(var me=0,ue,ke;me<Me.length;me++){if(ue=Me.charCodeAt(me),ue>55295&&ue<57344)if(ke)if(ue<56320){X[Ae++]=239,X[Ae++]=191,X[Ae++]=189,ke=ue;continue}else ue=ke-55296<<10|ue-56320|65536,ke=null;else{ue>56319||me+1===Me.length?(X[Ae++]=239,X[Ae++]=191,X[Ae++]=189):ke=ue;continue}else ke&&(X[Ae++]=239,X[Ae++]=191,X[Ae++]=189,ke=null);ue<128?X[Ae++]=ue:(ue<2048?X[Ae++]=ue>>6|192:(ue<65536?X[Ae++]=ue>>12|224:(X[Ae++]=ue>>18|240,X[Ae++]=ue>>12&63|128),X[Ae++]=ue>>6&63|128),X[Ae++]=ue&63|128)}return Ae}},35447:function(se){se.exports=function(C,P,D,G){var Z=C[0],F=C[1],z=!1;D===void 0&&(D=0),G===void 0&&(G=P.length);for(var q=(G-D)/2,ee=0,fe=q-1;ee<q;fe=ee++){var be=P[D+ee*2+0],Ie=P[D+ee*2+1],Oe=P[D+fe*2+0],He=P[D+fe*2+1],st=Ie>F!=He>F&&Z<(Oe-be)*(F-Ie)/(He-Ie)+be;st&&(z=!z)}return z}},76469:function(se,$,C){var P=C(35447),D=C(47176);se.exports=function(Z,F,z,q){return F.length>0&&Array.isArray(F[0])?D(Z,F,z,q):P(Z,F,z,q)},se.exports.nested=D,se.exports.flat=P},47176:function(se){se.exports=function(C,P,D,G){var Z=C[0],F=C[1],z=!1;D===void 0&&(D=0),G===void 0&&(G=P.length);for(var q=G-D,ee=0,fe=q-1;ee<q;fe=ee++){var be=P[ee+D][0],Ie=P[ee+D][1],Oe=P[fe+D][0],He=P[fe+D][1],st=Ie>F!=He>F&&Z<(Oe-be)*(F-Ie)/(He-Ie)+be;st&&(z=!z)}return z}},94486:function(se,$,C){var P=C(97671);(function(D,G){se.exports=G()})(this,function(){"use strict";function D(Pt,J){if(!(Pt instanceof J))throw new TypeError("Cannot call a class as a function")}function G(Pt,J){for(var ze=0;ze<J.length;ze++){var $e=J[ze];$e.enumerable=$e.enumerable||!1,$e.configurable=!0,"value"in $e&&($e.writable=!0),Object.defineProperty(Pt,$e.key,$e)}}function Z(Pt,J,ze){return J&&G(Pt.prototype,J),ze&&G(Pt,ze),Pt}var F=function(){function Pt(J,ze){this.next=null,this.key=J,this.data=ze,this.left=null,this.right=null}return Pt}();function z(Pt,J){return Pt>J?1:Pt<J?-1:0}function q(Pt,J,ze){for(var $e=new F(null,null),At=$e,Lt=$e;;){var wt=ze(Pt,J.key);if(wt<0){if(J.left===null)break;if(ze(Pt,J.left.key)<0){var yr=J.left;if(J.left=yr.right,yr.right=J,J=yr,J.left===null)break}Lt.left=J,Lt=J,J=J.left}else if(wt>0){if(J.right===null)break;if(ze(Pt,J.right.key)>0){var yr=J.right;if(J.right=yr.left,yr.left=J,J=yr,J.right===null)break}At.right=J,At=J,J=J.right}else break}return At.right=J.left,Lt.left=J.right,J.left=$e.right,J.right=$e.left,J}function ee(Pt,J,ze,$e){var At=new F(Pt,J);if(ze===null)return At.left=At.right=null,At;ze=q(Pt,ze,$e);var Lt=$e(Pt,ze.key);return Lt<0?(At.left=ze.left,At.right=ze,ze.left=null):Lt>=0&&(At.right=ze.right,At.left=ze,ze.right=null),At}function fe(Pt,J,ze){var $e=null,At=null;if(J){J=q(Pt,J,ze);var Lt=ze(J.key,Pt);Lt===0?($e=J.left,At=J.right):Lt<0?(At=J.right,J.right=null,$e=J):($e=J.left,J.left=null,At=J)}return{left:$e,right:At}}function be(Pt,J,ze){return J===null?Pt:(Pt===null||(J=q(Pt.key,J,ze),J.left=Pt),J)}function Ie(Pt,J,ze,$e,At){if(Pt){$e(""+J+(ze?"\u2514\u2500\u2500 ":"\u251C\u2500\u2500 ")+At(Pt)+`
`);var Lt=J+(ze?"    ":"\u2502   ");Pt.left&&Ie(Pt.left,Lt,!1,$e,At),Pt.right&&Ie(Pt.right,Lt,!0,$e,At)}}var Oe=function(){function Pt(J){J===void 0&&(J=z),this._root=null,this._size=0,this._comparator=J}return Pt.prototype.insert=function(J,ze){return this._size++,this._root=ee(J,ze,this._root,this._comparator)},Pt.prototype.add=function(J,ze){var $e=new F(J,ze);this._root===null&&($e.left=$e.right=null,this._size++,this._root=$e);var At=this._comparator,Lt=q(J,this._root,At),wt=At(J,Lt.key);return wt===0?this._root=Lt:(wt<0?($e.left=Lt.left,$e.right=Lt,Lt.left=null):wt>0&&($e.right=Lt.right,$e.left=Lt,Lt.right=null),this._size++,this._root=$e),this._root},Pt.prototype.remove=function(J){this._root=this._remove(J,this._root,this._comparator)},Pt.prototype._remove=function(J,ze,$e){var At;if(ze===null)return null;ze=q(J,ze,$e);var Lt=$e(J,ze.key);return Lt===0?(ze.left===null?At=ze.right:(At=q(J,ze.left,$e),At.right=ze.right),this._size--,At):ze},Pt.prototype.pop=function(){var J=this._root;if(J){for(;J.left;)J=J.left;return this._root=q(J.key,this._root,this._comparator),this._root=this._remove(J.key,this._root,this._comparator),{key:J.key,data:J.data}}return null},Pt.prototype.findStatic=function(J){for(var ze=this._root,$e=this._comparator;ze;){var At=$e(J,ze.key);if(At===0)return ze;At<0?ze=ze.left:ze=ze.right}return null},Pt.prototype.find=function(J){return this._root&&(this._root=q(J,this._root,this._comparator),this._comparator(J,this._root.key)!==0)?null:this._root},Pt.prototype.contains=function(J){for(var ze=this._root,$e=this._comparator;ze;){var At=$e(J,ze.key);if(At===0)return!0;At<0?ze=ze.left:ze=ze.right}return!1},Pt.prototype.forEach=function(J,ze){for(var $e=this._root,At=[],Lt=!1;!Lt;)$e!==null?(At.push($e),$e=$e.left):At.length!==0?($e=At.pop(),J.call(ze,$e),$e=$e.right):Lt=!0;return this},Pt.prototype.range=function(J,ze,$e,At){for(var Lt=[],wt=this._comparator,yr=this._root,vt;Lt.length!==0||yr;)if(yr)Lt.push(yr),yr=yr.left;else{if(yr=Lt.pop(),vt=wt(yr.key,ze),vt>0)break;if(wt(yr.key,J)>=0&&$e.call(At,yr))return this;yr=yr.right}return this},Pt.prototype.keys=function(){var J=[];return this.forEach(function(ze){var $e=ze.key;return J.push($e)}),J},Pt.prototype.values=function(){var J=[];return this.forEach(function(ze){var $e=ze.data;return J.push($e)}),J},Pt.prototype.min=function(){return this._root?this.minNode(this._root).key:null},Pt.prototype.max=function(){return this._root?this.maxNode(this._root).key:null},Pt.prototype.minNode=function(J){if(J===void 0&&(J=this._root),J)for(;J.left;)J=J.left;return J},Pt.prototype.maxNode=function(J){if(J===void 0&&(J=this._root),J)for(;J.right;)J=J.right;return J},Pt.prototype.at=function(J){for(var ze=this._root,$e=!1,At=0,Lt=[];!$e;)if(ze)Lt.push(ze),ze=ze.left;else if(Lt.length>0){if(ze=Lt.pop(),At===J)return ze;At++,ze=ze.right}else $e=!0;return null},Pt.prototype.next=function(J){var ze=this._root,$e=null;if(J.right){for($e=J.right;$e.left;)$e=$e.left;return $e}for(var At=this._comparator;ze;){var Lt=At(J.key,ze.key);if(Lt===0)break;Lt<0?($e=ze,ze=ze.left):ze=ze.right}return $e},Pt.prototype.prev=function(J){var ze=this._root,$e=null;if(J.left!==null){for($e=J.left;$e.right;)$e=$e.right;return $e}for(var At=this._comparator;ze;){var Lt=At(J.key,ze.key);if(Lt===0)break;Lt<0?ze=ze.left:($e=ze,ze=ze.right)}return $e},Pt.prototype.clear=function(){return this._root=null,this._size=0,this},Pt.prototype.toList=function(){return De(this._root)},Pt.prototype.load=function(J,ze,$e){ze===void 0&&(ze=[]),$e===void 0&&($e=!1);var At=J.length,Lt=this._comparator;if($e&&Te(J,ze,0,At-1,Lt),this._root===null)this._root=He(J,ze,0,At),this._size=At;else{var wt=we(this.toList(),st(J,ze),Lt);At=this._size+At,this._root=je({head:wt},0,At)}return this},Pt.prototype.isEmpty=function(){return this._root===null},Object.defineProperty(Pt.prototype,"size",{get:function(){return this._size},enumerable:!0,configurable:!0}),Object.defineProperty(Pt.prototype,"root",{get:function(){return this._root},enumerable:!0,configurable:!0}),Pt.prototype.toString=function(J){J===void 0&&(J=function(At){return String(At.key)});var ze=[];return Ie(this._root,"",!0,function($e){return ze.push($e)},J),ze.join("")},Pt.prototype.update=function(J,ze,$e){var At=this._comparator,Lt=fe(J,this._root,At),wt=Lt.left,yr=Lt.right;At(J,ze)<0?yr=ee(ze,$e,yr,At):wt=ee(ze,$e,wt,At),this._root=be(wt,yr,At)},Pt.prototype.split=function(J){return fe(J,this._root,this._comparator)},Pt}();function He(Pt,J,ze,$e){var At=$e-ze;if(At>0){var Lt=ze+Math.floor(At/2),wt=Pt[Lt],yr=J[Lt],vt=new F(wt,yr);return vt.left=He(Pt,J,ze,Lt),vt.right=He(Pt,J,Lt+1,$e),vt}return null}function st(Pt,J){for(var ze=new F(null,null),$e=ze,At=0;At<Pt.length;At++)$e=$e.next=new F(Pt[At],J[At]);return $e.next=null,ze.next}function De(Pt){for(var J=Pt,ze=[],$e=!1,At=new F(null,null),Lt=At;!$e;)J?(ze.push(J),J=J.left):ze.length>0?(J=Lt=Lt.next=ze.pop(),J=J.right):$e=!0;return Lt.next=null,At.next}function je(Pt,J,ze){var $e=ze-J;if($e>0){var At=J+Math.floor($e/2),Lt=je(Pt,J,At),wt=Pt.head;return wt.left=Lt,Pt.head=Pt.head.next,wt.right=je(Pt,At+1,ze),wt}return null}function we(Pt,J,ze){for(var $e=new F(null,null),At=$e,Lt=Pt,wt=J;Lt!==null&&wt!==null;)ze(Lt.key,wt.key)<0?(At.next=Lt,Lt=Lt.next):(At.next=wt,wt=wt.next),At=At.next;return Lt!==null?At.next=Lt:wt!==null&&(At.next=wt),$e.next}function Te(Pt,J,ze,$e,At){if(!(ze>=$e)){for(var Lt=Pt[ze+$e>>1],wt=ze-1,yr=$e+1;;){do wt++;while(At(Pt[wt],Lt)<0);do yr--;while(At(Pt[yr],Lt)>0);if(wt>=yr)break;var vt=Pt[wt];Pt[wt]=Pt[yr],Pt[yr]=vt,vt=J[wt],J[wt]=J[yr],J[yr]=vt}Te(Pt,J,ze,yr,At),Te(Pt,J,yr+1,$e,At)}}var le=function(J,ze){return J.ll.x<=ze.x&&ze.x<=J.ur.x&&J.ll.y<=ze.y&&ze.y<=J.ur.y},Re=function(J,ze){if(ze.ur.x<J.ll.x||J.ur.x<ze.ll.x||ze.ur.y<J.ll.y||J.ur.y<ze.ll.y)return null;var $e=J.ll.x<ze.ll.x?ze.ll.x:J.ll.x,At=J.ur.x<ze.ur.x?J.ur.x:ze.ur.x,Lt=J.ll.y<ze.ll.y?ze.ll.y:J.ll.y,wt=J.ur.y<ze.ur.y?J.ur.y:ze.ur.y;return{ll:{x:$e,y:Lt},ur:{x:At,y:wt}}},ye=Number.EPSILON;ye===void 0&&(ye=Math.pow(2,-52));var _e=ye*ye,ne=function(J,ze){if(-ye<J&&J<ye&&-ye<ze&&ze<ye)return 0;var $e=J-ze;return $e*$e<_e*J*ze?0:J<ze?-1:1},Y=function(){function Pt(){D(this,Pt),this.reset()}return Z(Pt,[{key:"reset",value:function(){this.xRounder=new Le,this.yRounder=new Le}},{key:"round",value:function(ze,$e){return{x:this.xRounder.round(ze),y:this.yRounder.round($e)}}}]),Pt}(),Le=function(){function Pt(){D(this,Pt),this.tree=new Oe,this.round(0)}return Z(Pt,[{key:"round",value:function(ze){var $e=this.tree.add(ze),At=this.tree.prev($e);if(At!==null&&ne($e.key,At.key)===0)return this.tree.remove(ze),At.key;var Lt=this.tree.next($e);return Lt!==null&&ne($e.key,Lt.key)===0?(this.tree.remove(ze),Lt.key):ze}}]),Pt}(),de=new Y,Ee=function(J,ze){return J.x*ze.y-J.y*ze.x},ge=function(J,ze){return J.x*ze.x+J.y*ze.y},X=function(J,ze,$e){var At={x:ze.x-J.x,y:ze.y-J.y},Lt={x:$e.x-J.x,y:$e.y-J.y},wt=Ee(At,Lt);return ne(wt,0)},Me=function(J){return Math.sqrt(ge(J,J))},Ae=function(J,ze,$e){var At={x:ze.x-J.x,y:ze.y-J.y},Lt={x:$e.x-J.x,y:$e.y-J.y};return Ee(Lt,At)/Me(Lt)/Me(At)},me=function(J,ze,$e){var At={x:ze.x-J.x,y:ze.y-J.y},Lt={x:$e.x-J.x,y:$e.y-J.y};return ge(Lt,At)/Me(Lt)/Me(At)},ue=function(J,ze,$e){return ze.y===0?null:{x:J.x+ze.x/ze.y*($e-J.y),y:$e}},ke=function(J,ze,$e){return ze.x===0?null:{x:$e,y:J.y+ze.y/ze.x*($e-J.x)}},Ze=function(J,ze,$e,At){if(ze.x===0)return ke($e,At,J.x);if(At.x===0)return ke(J,ze,$e.x);if(ze.y===0)return ue($e,At,J.y);if(At.y===0)return ue(J,ze,$e.y);var Lt=Ee(ze,At);if(Lt==0)return null;var wt={x:$e.x-J.x,y:$e.y-J.y},yr=Ee(wt,ze)/Lt,vt=Ee(wt,At)/Lt,Tt=J.x+vt*ze.x,Qt=$e.x+yr*At.x,xr=J.y+vt*ze.y,kr=$e.y+yr*At.y,Wr=(Tt+Qt)/2,an=(xr+kr)/2;return{x:Wr,y:an}},oe=function(){Z(Pt,null,[{key:"compare",value:function(ze,$e){var At=Pt.comparePoints(ze.point,$e.point);return At!==0?At:(ze.point!==$e.point&&ze.link($e),ze.isLeft!==$e.isLeft?ze.isLeft?1:-1:Rt.compare(ze.segment,$e.segment))}},{key:"comparePoints",value:function(ze,$e){return ze.x<$e.x?-1:ze.x>$e.x?1:ze.y<$e.y?-1:ze.y>$e.y?1:0}}]);function Pt(J,ze){D(this,Pt),J.events===void 0?J.events=[this]:J.events.push(this),this.point=J,this.isLeft=ze}return Z(Pt,[{key:"link",value:function(ze){if(ze.point===this.point)throw new Error("Tried to link already linked events");for(var $e=ze.point.events,At=0,Lt=$e.length;At<Lt;At++){var wt=$e[At];this.point.events.push(wt),wt.point=this.point}this.checkForConsuming()}},{key:"checkForConsuming",value:function(){for(var ze=this.point.events.length,$e=0;$e<ze;$e++){var At=this.point.events[$e];if(At.segment.consumedBy===void 0)for(var Lt=$e+1;Lt<ze;Lt++){var wt=this.point.events[Lt];wt.consumedBy===void 0&&At.otherSE.point.events===wt.otherSE.point.events&&At.segment.consume(wt.segment)}}}},{key:"getAvailableLinkedEvents",value:function(){for(var ze=[],$e=0,At=this.point.events.length;$e<At;$e++){var Lt=this.point.events[$e];Lt!==this&&!Lt.segment.ringOut&&Lt.segment.isInResult()&&ze.push(Lt)}return ze}},{key:"getLeftmostComparator",value:function(ze){var $e=this,At=new Map,Lt=function(yr){var vt=yr.otherSE;At.set(yr,{sine:Ae($e.point,ze.point,vt.point),cosine:me($e.point,ze.point,vt.point)})};return function(wt,yr){At.has(wt)||Lt(wt),At.has(yr)||Lt(yr);var vt=At.get(wt),Tt=vt.sine,Qt=vt.cosine,xr=At.get(yr),kr=xr.sine,Wr=xr.cosine;return Tt>=0&&kr>=0?Qt<Wr?1:Qt>Wr?-1:0:Tt<0&&kr<0?Qt<Wr?-1:Qt>Wr?1:0:kr<Tt?-1:kr>Tt?1:0}}}]),Pt}(),Dt=0,Rt=function(){Z(Pt,null,[{key:"compare",value:function(ze,$e){var At=ze.leftSE.point.x,Lt=$e.leftSE.point.x,wt=ze.rightSE.point.x,yr=$e.rightSE.point.x;if(yr<At)return 1;if(wt<Lt)return-1;var vt=ze.leftSE.point.y,Tt=$e.leftSE.point.y,Qt=ze.rightSE.point.y,xr=$e.rightSE.point.y;if(At<Lt){if(Tt<vt&&Tt<Qt)return 1;if(Tt>vt&&Tt>Qt)return-1;var kr=ze.comparePoint($e.leftSE.point);if(kr<0)return 1;if(kr>0)return-1;var Wr=$e.comparePoint(ze.rightSE.point);return Wr!==0?Wr:-1}if(At>Lt){if(vt<Tt&&vt<xr)return-1;if(vt>Tt&&vt>xr)return 1;var an=$e.comparePoint(ze.leftSE.point);if(an!==0)return an;var Br=ze.comparePoint($e.rightSE.point);return Br<0?1:Br>0?-1:1}if(vt<Tt)return-1;if(vt>Tt)return 1;if(wt<yr){var en=$e.comparePoint(ze.rightSE.point);if(en!==0)return en}if(wt>yr){var Zn=ze.comparePoint($e.rightSE.point);if(Zn<0)return 1;if(Zn>0)return-1}if(wt!==yr){var zn=Qt-vt,li=wt-At,sa=xr-Tt,Oa=yr-Lt;if(zn>li&&sa<Oa)return 1;if(zn<li&&sa>Oa)return-1}return wt>yr?1:wt<yr||Qt<xr?-1:Qt>xr?1:ze.id<$e.id?-1:ze.id>$e.id?1:0}}]);function Pt(J,ze,$e,At){D(this,Pt),this.id=++Dt,this.leftSE=J,J.segment=this,J.otherSE=ze,this.rightSE=ze,ze.segment=this,ze.otherSE=J,this.rings=$e,this.windings=At}return Z(Pt,[{key:"replaceRightSE",value:function(ze){this.rightSE=ze,this.rightSE.segment=this,this.rightSE.otherSE=this.leftSE,this.leftSE.otherSE=this.rightSE}},{key:"bbox",value:function(){var ze=this.leftSE.point.y,$e=this.rightSE.point.y;return{ll:{x:this.leftSE.point.x,y:ze<$e?ze:$e},ur:{x:this.rightSE.point.x,y:ze>$e?ze:$e}}}},{key:"vector",value:function(){return{x:this.rightSE.point.x-this.leftSE.point.x,y:this.rightSE.point.y-this.leftSE.point.y}}},{key:"isAnEndpoint",value:function(ze){return ze.x===this.leftSE.point.x&&ze.y===this.leftSE.point.y||ze.x===this.rightSE.point.x&&ze.y===this.rightSE.point.y}},{key:"comparePoint",value:function(ze){if(this.isAnEndpoint(ze))return 0;var $e=this.leftSE.point,At=this.rightSE.point,Lt=this.vector();if($e.x===At.x)return ze.x===$e.x?0:ze.x<$e.x?1:-1;var wt=(ze.y-$e.y)/Lt.y,yr=$e.x+wt*Lt.x;if(ze.x===yr)return 0;var vt=(ze.x-$e.x)/Lt.x,Tt=$e.y+vt*Lt.y;return ze.y===Tt?0:ze.y<Tt?-1:1}},{key:"getIntersection",value:function(ze){var $e=this.bbox(),At=ze.bbox(),Lt=Re($e,At);if(Lt===null)return null;var wt=this.leftSE.point,yr=this.rightSE.point,vt=ze.leftSE.point,Tt=ze.rightSE.point,Qt=le($e,vt)&&this.comparePoint(vt)===0,xr=le(At,wt)&&ze.comparePoint(wt)===0,kr=le($e,Tt)&&this.comparePoint(Tt)===0,Wr=le(At,yr)&&ze.comparePoint(yr)===0;if(xr&&Qt)return Wr&&!kr?yr:!Wr&&kr?Tt:null;if(xr)return kr&&wt.x===Tt.x&&wt.y===Tt.y?null:wt;if(Qt)return Wr&&yr.x===vt.x&&yr.y===vt.y?null:vt;if(Wr&&kr)return null;if(Wr)return yr;if(kr)return Tt;var an=Ze(wt,this.vector(),vt,ze.vector());return an===null||!le(Lt,an)?null:de.round(an.x,an.y)}},{key:"split",value:function(ze){var $e=[],At=ze.events!==void 0,Lt=new oe(ze,!0),wt=new oe(ze,!1),yr=this.rightSE;this.replaceRightSE(wt),$e.push(wt),$e.push(Lt);var vt=new Pt(Lt,yr,this.rings.slice(),this.windings.slice());return oe.comparePoints(vt.leftSE.point,vt.rightSE.point)>0&&vt.swapEvents(),oe.comparePoints(this.leftSE.point,this.rightSE.point)>0&&this.swapEvents(),At&&(Lt.checkForConsuming(),wt.checkForConsuming()),$e}},{key:"swapEvents",value:function(){var ze=this.rightSE;this.rightSE=this.leftSE,this.leftSE=ze,this.leftSE.isLeft=!0,this.rightSE.isLeft=!1;for(var $e=0,At=this.windings.length;$e<At;$e++)this.windings[$e]*=-1}},{key:"consume",value:function(ze){for(var $e=this,At=ze;$e.consumedBy;)$e=$e.consumedBy;for(;At.consumedBy;)At=At.consumedBy;var Lt=Pt.compare($e,At);if(Lt!==0){if(Lt>0){var wt=$e;$e=At,At=wt}if($e.prev===At){var yr=$e;$e=At,At=yr}for(var vt=0,Tt=At.rings.length;vt<Tt;vt++){var Qt=At.rings[vt],xr=At.windings[vt],kr=$e.rings.indexOf(Qt);kr===-1?($e.rings.push(Qt),$e.windings.push(xr)):$e.windings[kr]+=xr}At.rings=null,At.windings=null,At.consumedBy=$e,At.leftSE.consumedBy=$e.leftSE,At.rightSE.consumedBy=$e.rightSE}}},{key:"prevInResult",value:function(){return this._prevInResult!==void 0?this._prevInResult:(this.prev?this.prev.isInResult()?this._prevInResult=this.prev:this._prevInResult=this.prev.prevInResult():this._prevInResult=null,this._prevInResult)}},{key:"beforeState",value:function(){if(this._beforeState!==void 0)return this._beforeState;if(!this.prev)this._beforeState={rings:[],windings:[],multiPolys:[]};else{var ze=this.prev.consumedBy||this.prev;this._beforeState=ze.afterState()}return this._beforeState}},{key:"afterState",value:function(){if(this._afterState!==void 0)return this._afterState;var ze=this.beforeState();this._afterState={rings:ze.rings.slice(0),windings:ze.windings.slice(0),multiPolys:[]};for(var $e=this._afterState.rings,At=this._afterState.windings,Lt=this._afterState.multiPolys,wt=0,yr=this.rings.length;wt<yr;wt++){var vt=this.rings[wt],Tt=this.windings[wt],Qt=$e.indexOf(vt);Qt===-1?($e.push(vt),At.push(Tt)):At[Qt]+=Tt}for(var xr=[],kr=[],Wr=0,an=$e.length;Wr<an;Wr++)if(At[Wr]!==0){var Br=$e[Wr],en=Br.poly;if(kr.indexOf(en)===-1)if(Br.isExterior)xr.push(en);else{kr.indexOf(en)===-1&&kr.push(en);var Zn=xr.indexOf(Br.poly);Zn!==-1&&xr.splice(Zn,1)}}for(var zn=0,li=xr.length;zn<li;zn++){var sa=xr[zn].multiPoly;Lt.indexOf(sa)===-1&&Lt.push(sa)}return this._afterState}},{key:"isInResult",value:function(){if(this.consumedBy)return!1;if(this._isInResult!==void 0)return this._isInResult;var ze=this.beforeState().multiPolys,$e=this.afterState().multiPolys;switch(Vn.type){case"union":{var At=ze.length===0,Lt=$e.length===0;this._isInResult=At!==Lt;break}case"intersection":{var wt,yr;ze.length<$e.length?(wt=ze.length,yr=$e.length):(wt=$e.length,yr=ze.length),this._isInResult=yr===Vn.numMultiPolys&&wt<yr;break}case"xor":{var vt=Math.abs(ze.length-$e.length);this._isInResult=vt%2===1;break}case"difference":{var Tt=function(xr){return xr.length===1&&xr[0].isSubject};this._isInResult=Tt(ze)!==Tt($e);break}default:throw new Error("Unrecognized operation type found ".concat(Vn.type))}return this._isInResult}}],[{key:"fromRing",value:function(ze,$e,At){var Lt,wt,yr,vt=oe.comparePoints(ze,$e);if(vt<0)Lt=ze,wt=$e,yr=1;else if(vt>0)Lt=$e,wt=ze,yr=-1;else throw new Error("Tried to create degenerate segment at [".concat(ze.x,", ").concat(ze.y,"]"));var Tt=new oe(Lt,!0),Qt=new oe(wt,!1);return new Pt(Tt,Qt,[At],[yr])}}]),Pt}(),cr=function(){function Pt(J,ze,$e){if(D(this,Pt),!Array.isArray(J)||J.length===0)throw new Error("Input geometry is not a valid Polygon or MultiPolygon");if(this.poly=ze,this.isExterior=$e,this.segments=[],typeof J[0][0]!="number"||typeof J[0][1]!="number")throw new Error("Input geometry is not a valid Polygon or MultiPolygon");var At=de.round(J[0][0],J[0][1]);this.bbox={ll:{x:At.x,y:At.y},ur:{x:At.x,y:At.y}};for(var Lt=At,wt=1,yr=J.length;wt<yr;wt++){if(typeof J[wt][0]!="number"||typeof J[wt][1]!="number")throw new Error("Input geometry is not a valid Polygon or MultiPolygon");var vt=de.round(J[wt][0],J[wt][1]);vt.x===Lt.x&&vt.y===Lt.y||(this.segments.push(Rt.fromRing(Lt,vt,this)),vt.x<this.bbox.ll.x&&(this.bbox.ll.x=vt.x),vt.y<this.bbox.ll.y&&(this.bbox.ll.y=vt.y),vt.x>this.bbox.ur.x&&(this.bbox.ur.x=vt.x),vt.y>this.bbox.ur.y&&(this.bbox.ur.y=vt.y),Lt=vt)}(At.x!==Lt.x||At.y!==Lt.y)&&this.segments.push(Rt.fromRing(Lt,At,this))}return Z(Pt,[{key:"getSweepEvents",value:function(){for(var ze=[],$e=0,At=this.segments.length;$e<At;$e++){var Lt=this.segments[$e];ze.push(Lt.leftSE),ze.push(Lt.rightSE)}return ze}}]),Pt}(),Ut=function(){function Pt(J,ze){if(D(this,Pt),!Array.isArray(J))throw new Error("Input geometry is not a valid Polygon or MultiPolygon");this.exteriorRing=new cr(J[0],this,!0),this.bbox={ll:{x:this.exteriorRing.bbox.ll.x,y:this.exteriorRing.bbox.ll.y},ur:{x:this.exteriorRing.bbox.ur.x,y:this.exteriorRing.bbox.ur.y}},this.interiorRings=[];for(var $e=1,At=J.length;$e<At;$e++){var Lt=new cr(J[$e],this,!1);Lt.bbox.ll.x<this.bbox.ll.x&&(this.bbox.ll.x=Lt.bbox.ll.x),Lt.bbox.ll.y<this.bbox.ll.y&&(this.bbox.ll.y=Lt.bbox.ll.y),Lt.bbox.ur.x>this.bbox.ur.x&&(this.bbox.ur.x=Lt.bbox.ur.x),Lt.bbox.ur.y>this.bbox.ur.y&&(this.bbox.ur.y=Lt.bbox.ur.y),this.interiorRings.push(Lt)}this.multiPoly=ze}return Z(Pt,[{key:"getSweepEvents",value:function(){for(var ze=this.exteriorRing.getSweepEvents(),$e=0,At=this.interiorRings.length;$e<At;$e++)for(var Lt=this.interiorRings[$e].getSweepEvents(),wt=0,yr=Lt.length;wt<yr;wt++)ze.push(Lt[wt]);return ze}}]),Pt}(),$r=function(){function Pt(J,ze){if(D(this,Pt),!Array.isArray(J))throw new Error("Input geometry is not a valid Polygon or MultiPolygon");try{typeof J[0][0][0]=="number"&&(J=[J])}catch(wt){}this.polys=[],this.bbox={ll:{x:Number.POSITIVE_INFINITY,y:Number.POSITIVE_INFINITY},ur:{x:Number.NEGATIVE_INFINITY,y:Number.NEGATIVE_INFINITY}};for(var $e=0,At=J.length;$e<At;$e++){var Lt=new Ut(J[$e],this);Lt.bbox.ll.x<this.bbox.ll.x&&(this.bbox.ll.x=Lt.bbox.ll.x),Lt.bbox.ll.y<this.bbox.ll.y&&(this.bbox.ll.y=Lt.bbox.ll.y),Lt.bbox.ur.x>this.bbox.ur.x&&(this.bbox.ur.x=Lt.bbox.ur.x),Lt.bbox.ur.y>this.bbox.ur.y&&(this.bbox.ur.y=Lt.bbox.ur.y),this.polys.push(Lt)}this.isSubject=ze}return Z(Pt,[{key:"getSweepEvents",value:function(){for(var ze=[],$e=0,At=this.polys.length;$e<At;$e++)for(var Lt=this.polys[$e].getSweepEvents(),wt=0,yr=Lt.length;wt<yr;wt++)ze.push(Lt[wt]);return ze}}]),Pt}(),ln=function(){Z(Pt,null,[{key:"factory",value:function(ze){for(var $e=[],At=0,Lt=ze.length;At<Lt;At++){var wt=ze[At];if(!(!wt.isInResult()||wt.ringOut)){for(var yr=null,vt=wt.leftSE,Tt=wt.rightSE,Qt=[vt],xr=vt.point,kr=[];yr=vt,vt=Tt,Qt.push(vt),vt.point!==xr;)for(;;){var Wr=vt.getAvailableLinkedEvents();if(Wr.length===0){var an=Qt[0].point,Br=Qt[Qt.length-1].point;throw new Error("Unable to complete output ring starting at [".concat(an.x,",")+" ".concat(an.y,"]. Last matching segment found ends at")+" [".concat(Br.x,", ").concat(Br.y,"]."))}if(Wr.length===1){Tt=Wr[0].otherSE;break}for(var en=null,Zn=0,zn=kr.length;Zn<zn;Zn++)if(kr[Zn].point===vt.point){en=Zn;break}if(en!==null){var li=kr.splice(en)[0],sa=Qt.splice(li.index);sa.unshift(sa[0].otherSE),$e.push(new Pt(sa.reverse()));continue}kr.push({index:Qt.length,point:vt.point});var Oa=vt.getLeftmostComparator(yr);Tt=Wr.sort(Oa)[0].otherSE;break}$e.push(new Pt(Qt))}}return $e}}]);function Pt(J){D(this,Pt),this.events=J;for(var ze=0,$e=J.length;ze<$e;ze++)J[ze].segment.ringOut=this;this.poly=null}return Z(Pt,[{key:"getGeom",value:function(){for(var ze=this.events[0].point,$e=[ze],At=1,Lt=this.events.length-1;At<Lt;At++){var wt=this.events[At].point,yr=this.events[At+1].point;X(wt,ze,yr)!==0&&($e.push(wt),ze=wt)}if($e.length===1)return null;var vt=$e[0],Tt=$e[1];X(vt,ze,Tt)===0&&$e.shift(),$e.push($e[0]);for(var Qt=this.isExteriorRing()?1:-1,xr=this.isExteriorRing()?0:$e.length-1,kr=this.isExteriorRing()?$e.length:-1,Wr=[],an=xr;an!=kr;an+=Qt)Wr.push([$e[an].x,$e[an].y]);return Wr}},{key:"isExteriorRing",value:function(){if(this._isExteriorRing===void 0){var ze=this.enclosingRing();this._isExteriorRing=ze?!ze.isExteriorRing():!0}return this._isExteriorRing}},{key:"enclosingRing",value:function(){return this._enclosingRing===void 0&&(this._enclosingRing=this._calcEnclosingRing()),this._enclosingRing}},{key:"_calcEnclosingRing",value:function(){for(var ze=this.events[0],$e=1,At=this.events.length;$e<At;$e++){var Lt=this.events[$e];oe.compare(ze,Lt)>0&&(ze=Lt)}for(var wt=ze.segment.prevInResult(),yr=wt?wt.prevInResult():null;;){if(!wt)return null;if(!yr)return wt.ringOut;if(yr.ringOut!==wt.ringOut)return yr.ringOut.enclosingRing()!==wt.ringOut?wt.ringOut:wt.ringOut.enclosingRing();wt=yr.prevInResult(),yr=wt?wt.prevInResult():null}}}]),Pt}(),Sr=function(){function Pt(J){D(this,Pt),this.exteriorRing=J,J.poly=this,this.interiorRings=[]}return Z(Pt,[{key:"addInterior",value:function(ze){this.interiorRings.push(ze),ze.poly=this}},{key:"getGeom",value:function(){var ze=[this.exteriorRing.getGeom()];if(ze[0]===null)return null;for(var $e=0,At=this.interiorRings.length;$e<At;$e++){var Lt=this.interiorRings[$e].getGeom();Lt!==null&&ze.push(Lt)}return ze}}]),Pt}(),Qr=function(){function Pt(J){D(this,Pt),this.rings=J,this.polys=this._composePolys(J)}return Z(Pt,[{key:"getGeom",value:function(){for(var ze=[],$e=0,At=this.polys.length;$e<At;$e++){var Lt=this.polys[$e].getGeom();Lt!==null&&ze.push(Lt)}return ze}},{key:"_composePolys",value:function(ze){for(var $e=[],At=0,Lt=ze.length;At<Lt;At++){var wt=ze[At];if(!wt.poly)if(wt.isExteriorRing())$e.push(new Sr(wt));else{var yr=wt.enclosingRing();yr.poly||$e.push(new Sr(yr)),yr.poly.addInterior(wt)}}return $e}}]),Pt}(),Jr=function(){function Pt(J){var ze=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Rt.compare;D(this,Pt),this.queue=J,this.tree=new Oe(ze),this.segments=[]}return Z(Pt,[{key:"process",value:function(ze){var $e=ze.segment,At=[];if(ze.consumedBy)return ze.isLeft?this.queue.remove(ze.otherSE):this.tree.remove($e),At;var Lt=ze.isLeft?this.tree.insert($e):this.tree.find($e);if(!Lt)throw new Error("Unable to find segment #".concat($e.id," ")+"[".concat($e.leftSE.point.x,", ").concat($e.leftSE.point.y,"] -> ")+"[".concat($e.rightSE.point.x,", ").concat($e.rightSE.point.y,"] ")+"in SweepLine tree. Please submit a bug report.");for(var wt=Lt,yr=Lt,vt=void 0,Tt=void 0;vt===void 0;)wt=this.tree.prev(wt),wt===null?vt=null:wt.key.consumedBy===void 0&&(vt=wt.key);for(;Tt===void 0;)yr=this.tree.next(yr),yr===null?Tt=null:yr.key.consumedBy===void 0&&(Tt=yr.key);if(ze.isLeft){var Qt=null;if(vt){var xr=vt.getIntersection($e);if(xr!==null&&($e.isAnEndpoint(xr)||(Qt=xr),!vt.isAnEndpoint(xr)))for(var kr=this._splitSafely(vt,xr),Wr=0,an=kr.length;Wr<an;Wr++)At.push(kr[Wr])}var Br=null;if(Tt){var en=Tt.getIntersection($e);if(en!==null&&($e.isAnEndpoint(en)||(Br=en),!Tt.isAnEndpoint(en)))for(var Zn=this._splitSafely(Tt,en),zn=0,li=Zn.length;zn<li;zn++)At.push(Zn[zn])}if(Qt!==null||Br!==null){var sa=null;if(Qt===null)sa=Br;else if(Br===null)sa=Qt;else{var Oa=oe.comparePoints(Qt,Br);sa=Oa<=0?Qt:Br}this.queue.remove($e.rightSE),At.push($e.rightSE);for(var Gr=$e.split(sa),Ds=0,Co=Gr.length;Ds<Co;Ds++)At.push(Gr[Ds])}At.length>0?(this.tree.remove($e),At.push(ze)):(this.segments.push($e),$e.prev=vt)}else{if(vt&&Tt){var xn=vt.getIntersection(Tt);if(xn!==null){if(!vt.isAnEndpoint(xn))for(var xs=this._splitSafely(vt,xn),go=0,Ns=xs.length;go<Ns;go++)At.push(xs[go]);if(!Tt.isAnEndpoint(xn))for(var Po=this._splitSafely(Tt,xn),hl=0,yu=Po.length;hl<yu;hl++)At.push(Po[hl])}}this.tree.remove($e)}return At}},{key:"_splitSafely",value:function(ze,$e){this.tree.remove(ze);var At=ze.rightSE;this.queue.remove(At);var Lt=ze.split($e);return Lt.push(At),ze.consumedBy===void 0&&this.tree.insert(ze),Lt}}]),Pt}(),_r=typeof P!="undefined"&&{NODE_ENV:"production",PUBLIC_PATH:"/"}.POLYGON_CLIPPING_MAX_QUEUE_SIZE||1e6,Gn=typeof P!="undefined"&&{NODE_ENV:"production",PUBLIC_PATH:"/"}.POLYGON_CLIPPING_MAX_SWEEPLINE_SEGMENTS||1e6,ti=function(){function Pt(){D(this,Pt)}return Z(Pt,[{key:"run",value:function(ze,$e,At){Vn.type=ze,de.reset();for(var Lt=[new $r($e,!0)],wt=0,yr=At.length;wt<yr;wt++)Lt.push(new $r(At[wt],!1));if(Vn.numMultiPolys=Lt.length,Vn.type==="difference")for(var vt=Lt[0],Tt=1;Tt<Lt.length;)Re(Lt[Tt].bbox,vt.bbox)!==null?Tt++:Lt.splice(Tt,1);if(Vn.type==="intersection"){for(var Qt=0,xr=Lt.length;Qt<xr;Qt++)for(var kr=Lt[Qt],Wr=Qt+1,an=Lt.length;Wr<an;Wr++)if(Re(kr.bbox,Lt[Wr].bbox)===null)return[]}for(var Br=new Oe(oe.compare),en=0,Zn=Lt.length;en<Zn;en++)for(var zn=Lt[en].getSweepEvents(),li=0,sa=zn.length;li<sa;li++)if(Br.insert(zn[li]),Br.size>_r)throw new Error("Infinite loop when putting segment endpoints in a priority queue (queue size too big). Please file a bug report.");for(var Oa=new Jr(Br),Gr=Br.size,Ds=Br.pop();Ds;){var Co=Ds.key;if(Br.size===Gr){var xn=Co.segment;throw new Error("Unable to pop() ".concat(Co.isLeft?"left":"right"," SweepEvent ")+"[".concat(Co.point.x,", ").concat(Co.point.y,"] from segment #").concat(xn.id," ")+"[".concat(xn.leftSE.point.x,", ").concat(xn.leftSE.point.y,"] -> ")+"[".concat(xn.rightSE.point.x,", ").concat(xn.rightSE.point.y,"] from queue. ")+"Please file a bug report.")}if(Br.size>_r)throw new Error("Infinite loop when passing sweep line over endpoints (queue size too big). Please file a bug report.");if(Oa.segments.length>Gn)throw new Error("Infinite loop when passing sweep line over endpoints (too many sweep line segments). Please file a bug report.");for(var xs=Oa.process(Co),go=0,Ns=xs.length;go<Ns;go++){var Po=xs[go];Po.consumedBy===void 0&&Br.insert(Po)}Gr=Br.size,Ds=Br.pop()}de.reset();var hl=ln.factory(Oa.segments),yu=new Qr(hl);return yu.getGeom()}}]),Pt}(),Vn=new ti,Xr=function(J){for(var ze=arguments.length,$e=new Array(ze>1?ze-1:0),At=1;At<ze;At++)$e[At-1]=arguments[At];return Vn.run("union",J,$e)},sn=function(J){for(var ze=arguments.length,$e=new Array(ze>1?ze-1:0),At=1;At<ze;At++)$e[At-1]=arguments[At];return Vn.run("intersection",J,$e)},_n=function(J){for(var ze=arguments.length,$e=new Array(ze>1?ze-1:0),At=1;At<ze;At++)$e[At-1]=arguments[At];return Vn.run("xor",J,$e)},Di=function(J){for(var ze=arguments.length,$e=new Array(ze>1?ze-1:0),At=1;At<ze;At++)$e[At-1]=arguments[At];return Vn.run("difference",J,$e)},ri={union:Xr,intersection:sn,xor:_n,difference:Di};return ri})},13664:function(se){(function($,C){se.exports=C()})(this,function(){"use strict";function $(G,Z,F,z,q){C(G,Z,F||0,z||G.length-1,q||D)}function C(G,Z,F,z,q){for(;z>F;){if(z-F>600){var ee=z-F+1,fe=Z-F+1,be=Math.log(ee),Ie=.5*Math.exp(2*be/3),Oe=.5*Math.sqrt(be*Ie*(ee-Ie)/ee)*(fe-ee/2<0?-1:1),He=Math.max(F,Math.floor(Z-fe*Ie/ee+Oe)),st=Math.min(z,Math.floor(Z+(ee-fe)*Ie/ee+Oe));C(G,Z,He,st,q)}var De=G[Z],je=F,we=z;for(P(G,F,Z),q(G[z],De)>0&&P(G,F,z);je<we;){for(P(G,je,we),je++,we--;q(G[je],De)<0;)je++;for(;q(G[we],De)>0;)we--}q(G[F],De)===0?P(G,F,we):(we++,P(G,we,z)),we<=Z&&(F=we+1),Z<=we&&(z=we-1)}}function P(G,Z,F){var z=G[Z];G[Z]=G[F],G[F]=z}function D(G,Z){return G<Z?-1:G>Z?1:0}return $})},85475:function(se,$,C){"use strict";se.exports=D,se.exports.default=D;var P=C(13664);function D(we,Te){if(!(this instanceof D))return new D(we,Te);this._maxEntries=Math.max(4,we||9),this._minEntries=Math.max(2,Math.ceil(this._maxEntries*.4)),Te&&this._initFormat(Te),this.clear()}D.prototype={all:function(){return this._all(this.data,[])},search:function(we){var Te=this.data,le=[],Re=this.toBBox;if(!st(we,Te))return le;for(var ye=[],_e,ne,Y,Le;Te;){for(_e=0,ne=Te.children.length;_e<ne;_e++)Y=Te.children[_e],Le=Te.leaf?Re(Y):Y,st(we,Le)&&(Te.leaf?le.push(Y):He(we,Le)?this._all(Y,le):ye.push(Y));Te=ye.pop()}return le},collides:function(we){var Te=this.data,le=this.toBBox;if(!st(we,Te))return!1;for(var Re=[],ye,_e,ne,Y;Te;){for(ye=0,_e=Te.children.length;ye<_e;ye++)if(ne=Te.children[ye],Y=Te.leaf?le(ne):ne,st(we,Y)){if(Te.leaf||He(we,Y))return!0;Re.push(ne)}Te=Re.pop()}return!1},load:function(we){if(!(we&&we.length))return this;if(we.length<this._minEntries){for(var Te=0,le=we.length;Te<le;Te++)this.insert(we[Te]);return this}var Re=this._build(we.slice(),0,we.length-1,0);if(!this.data.children.length)this.data=Re;else if(this.data.height===Re.height)this._splitRoot(this.data,Re);else{if(this.data.height<Re.height){var ye=this.data;this.data=Re,Re=ye}this._insert(Re,this.data.height-Re.height-1,!0)}return this},insert:function(we){return we&&this._insert(we,this.data.height-1),this},clear:function(){return this.data=De([]),this},remove:function(we,Te){if(!we)return this;for(var le=this.data,Re=this.toBBox(we),ye=[],_e=[],ne,Y,Le,de;le||ye.length;){if(le||(le=ye.pop(),Y=ye[ye.length-1],ne=_e.pop(),de=!0),le.leaf&&(Le=G(we,le.children,Te),Le!==-1))return le.children.splice(Le,1),ye.push(le),this._condense(ye),this;!de&&!le.leaf&&He(le,Re)?(ye.push(le),_e.push(ne),ne=0,Y=le,le=le.children[0]):Y?(ne++,le=Y.children[ne],de=!1):le=null}return this},toBBox:function(we){return we},compareMinX:q,compareMinY:ee,toJSON:function(){return this.data},fromJSON:function(we){return this.data=we,this},_all:function(we,Te){for(var le=[];we;)we.leaf?Te.push.apply(Te,we.children):le.push.apply(le,we.children),we=le.pop();return Te},_build:function(we,Te,le,Re){var ye=le-Te+1,_e=this._maxEntries,ne;if(ye<=_e)return ne=De(we.slice(Te,le+1)),Z(ne,this.toBBox),ne;Re||(Re=Math.ceil(Math.log(ye)/Math.log(_e)),_e=Math.ceil(ye/Math.pow(_e,Re-1))),ne=De([]),ne.leaf=!1,ne.height=Re;var Y=Math.ceil(ye/_e),Le=Y*Math.ceil(Math.sqrt(_e)),de,Ee,ge,X;for(je(we,Te,le,Le,this.compareMinX),de=Te;de<=le;de+=Le)for(ge=Math.min(de+Le-1,le),je(we,de,ge,Y,this.compareMinY),Ee=de;Ee<=ge;Ee+=Y)X=Math.min(Ee+Y-1,ge),ne.children.push(this._build(we,Ee,X,Re-1));return Z(ne,this.toBBox),ne},_chooseSubtree:function(we,Te,le,Re){for(var ye,_e,ne,Y,Le,de,Ee,ge;Re.push(Te),!(Te.leaf||Re.length-1===le);){for(Ee=ge=1/0,ye=0,_e=Te.children.length;ye<_e;ye++)ne=Te.children[ye],Le=fe(ne),de=Ie(we,ne)-Le,de<ge?(ge=de,Ee=Le<Ee?Le:Ee,Y=ne):de===ge&&Le<Ee&&(Ee=Le,Y=ne);Te=Y||Te.children[0]}return Te},_insert:function(we,Te,le){var Re=this.toBBox,ye=le?we:Re(we),_e=[],ne=this._chooseSubtree(ye,this.data,Te,_e);for(ne.children.push(we),z(ne,ye);Te>=0&&_e[Te].children.length>this._maxEntries;)this._split(_e,Te),Te--;this._adjustParentBBoxes(ye,_e,Te)},_split:function(we,Te){var le=we[Te],Re=le.children.length,ye=this._minEntries;this._chooseSplitAxis(le,ye,Re);var _e=this._chooseSplitIndex(le,ye,Re),ne=De(le.children.splice(_e,le.children.length-_e));ne.height=le.height,ne.leaf=le.leaf,Z(le,this.toBBox),Z(ne,this.toBBox),Te?we[Te-1].children.push(ne):this._splitRoot(le,ne)},_splitRoot:function(we,Te){this.data=De([we,Te]),this.data.height=we.height+1,this.data.leaf=!1,Z(this.data,this.toBBox)},_chooseSplitIndex:function(we,Te,le){var Re,ye,_e,ne,Y,Le,de,Ee;for(Le=de=1/0,Re=Te;Re<=le-Te;Re++)ye=F(we,0,Re,this.toBBox),_e=F(we,Re,le,this.toBBox),ne=Oe(ye,_e),Y=fe(ye)+fe(_e),ne<Le?(Le=ne,Ee=Re,de=Y<de?Y:de):ne===Le&&Y<de&&(de=Y,Ee=Re);return Ee},_chooseSplitAxis:function(we,Te,le){var Re=we.leaf?this.compareMinX:q,ye=we.leaf?this.compareMinY:ee,_e=this._allDistMargin(we,Te,le,Re),ne=this._allDistMargin(we,Te,le,ye);_e<ne&&we.children.sort(Re)},_allDistMargin:function(we,Te,le,Re){we.children.sort(Re);var ye=this.toBBox,_e=F(we,0,Te,ye),ne=F(we,le-Te,le,ye),Y=be(_e)+be(ne),Le,de;for(Le=Te;Le<le-Te;Le++)de=we.children[Le],z(_e,we.leaf?ye(de):de),Y+=be(_e);for(Le=le-Te-1;Le>=Te;Le--)de=we.children[Le],z(ne,we.leaf?ye(de):de),Y+=be(ne);return Y},_adjustParentBBoxes:function(we,Te,le){for(var Re=le;Re>=0;Re--)z(Te[Re],we)},_condense:function(we){for(var Te=we.length-1,le;Te>=0;Te--)we[Te].children.length===0?Te>0?(le=we[Te-1].children,le.splice(le.indexOf(we[Te]),1)):this.clear():Z(we[Te],this.toBBox)},_initFormat:function(we){var Te=["return a"," - b",";"];this.compareMinX=new Function("a","b",Te.join(we[0])),this.compareMinY=new Function("a","b",Te.join(we[1])),this.toBBox=new Function("a","return {minX: a"+we[0]+", minY: a"+we[1]+", maxX: a"+we[2]+", maxY: a"+we[3]+"};")}};function G(we,Te,le){if(!le)return Te.indexOf(we);for(var Re=0;Re<Te.length;Re++)if(le(we,Te[Re]))return Re;return-1}function Z(we,Te){F(we,0,we.children.length,Te,we)}function F(we,Te,le,Re,ye){ye||(ye=De(null)),ye.minX=1/0,ye.minY=1/0,ye.maxX=-1/0,ye.maxY=-1/0;for(var _e=Te,ne;_e<le;_e++)ne=we.children[_e],z(ye,we.leaf?Re(ne):ne);return ye}function z(we,Te){return we.minX=Math.min(we.minX,Te.minX),we.minY=Math.min(we.minY,Te.minY),we.maxX=Math.max(we.maxX,Te.maxX),we.maxY=Math.max(we.maxY,Te.maxY),we}function q(we,Te){return we.minX-Te.minX}function ee(we,Te){return we.minY-Te.minY}function fe(we){return(we.maxX-we.minX)*(we.maxY-we.minY)}function be(we){return we.maxX-we.minX+(we.maxY-we.minY)}function Ie(we,Te){return(Math.max(Te.maxX,we.maxX)-Math.min(Te.minX,we.minX))*(Math.max(Te.maxY,we.maxY)-Math.min(Te.minY,we.minY))}function Oe(we,Te){var le=Math.max(we.minX,Te.minX),Re=Math.max(we.minY,Te.minY),ye=Math.min(we.maxX,Te.maxX),_e=Math.min(we.maxY,Te.maxY);return Math.max(0,ye-le)*Math.max(0,_e-Re)}function He(we,Te){return we.minX<=Te.minX&&we.minY<=Te.minY&&Te.maxX<=we.maxX&&Te.maxY<=we.maxY}function st(we,Te){return Te.minX<=we.maxX&&Te.minY<=we.maxY&&Te.maxX>=we.minX&&Te.maxY>=we.minY}function De(we){return{children:we,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function je(we,Te,le,Re,ye){for(var _e=[Te,le],ne;_e.length;)le=_e.pop(),Te=_e.pop(),!(le-Te<=Re)&&(ne=Te+Math.ceil((le-Te)/Re/2)*Re,P(we,ne,Te,le,ye),_e.push(Te,ne,ne,le))}},79535:function(se){(function($,C){se.exports=C()})(this,function(){"use strict";function $(De,je,we,Te,le){(function Re(ye,_e,ne,Y,Le){for(;Y>ne;){if(Y-ne>600){var de=Y-ne+1,Ee=_e-ne+1,ge=Math.log(de),X=.5*Math.exp(2*ge/3),Me=.5*Math.sqrt(ge*X*(de-X)/de)*(Ee-de/2<0?-1:1),Ae=Math.max(ne,Math.floor(_e-Ee*X/de+Me)),me=Math.min(Y,Math.floor(_e+(de-Ee)*X/de+Me));Re(ye,_e,Ae,me,Le)}var ue=ye[_e],ke=ne,Ze=Y;for(C(ye,ne,_e),Le(ye[Y],ue)>0&&C(ye,ne,Y);ke<Ze;){for(C(ye,ke,Ze),ke++,Ze--;Le(ye[ke],ue)<0;)ke++;for(;Le(ye[Ze],ue)>0;)Ze--}Le(ye[ne],ue)===0?C(ye,ne,Ze):C(ye,++Ze,Y),Ze<=_e&&(ne=Ze+1),_e<=Ze&&(Y=Ze-1)}})(De,je,we||0,Te||De.length-1,le||P)}function C(De,je,we){var Te=De[je];De[je]=De[we],De[we]=Te}function P(De,je){return De<je?-1:De>je?1:0}var D=function(De){De===void 0&&(De=9),this._maxEntries=Math.max(4,De),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),this.clear()};function G(De,je,we){if(!we)return je.indexOf(De);for(var Te=0;Te<je.length;Te++)if(we(De,je[Te]))return Te;return-1}function Z(De,je){F(De,0,De.children.length,je,De)}function F(De,je,we,Te,le){le||(le=He(null)),le.minX=1/0,le.minY=1/0,le.maxX=-1/0,le.maxY=-1/0;for(var Re=je;Re<we;Re++){var ye=De.children[Re];z(le,De.leaf?Te(ye):ye)}return le}function z(De,je){return De.minX=Math.min(De.minX,je.minX),De.minY=Math.min(De.minY,je.minY),De.maxX=Math.max(De.maxX,je.maxX),De.maxY=Math.max(De.maxY,je.maxY),De}function q(De,je){return De.minX-je.minX}function ee(De,je){return De.minY-je.minY}function fe(De){return(De.maxX-De.minX)*(De.maxY-De.minY)}function be(De){return De.maxX-De.minX+(De.maxY-De.minY)}function Ie(De,je){return De.minX<=je.minX&&De.minY<=je.minY&&je.maxX<=De.maxX&&je.maxY<=De.maxY}function Oe(De,je){return je.minX<=De.maxX&&je.minY<=De.maxY&&je.maxX>=De.minX&&je.maxY>=De.minY}function He(De){return{children:De,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function st(De,je,we,Te,le){for(var Re=[je,we];Re.length;)if(!((we=Re.pop())-(je=Re.pop())<=Te)){var ye=je+Math.ceil((we-je)/Te/2)*Te;$(De,ye,je,we,le),Re.push(je,ye,ye,we)}}return D.prototype.all=function(){return this._all(this.data,[])},D.prototype.search=function(De){var je=this.data,we=[];if(!Oe(De,je))return we;for(var Te=this.toBBox,le=[];je;){for(var Re=0;Re<je.children.length;Re++){var ye=je.children[Re],_e=je.leaf?Te(ye):ye;Oe(De,_e)&&(je.leaf?we.push(ye):Ie(De,_e)?this._all(ye,we):le.push(ye))}je=le.pop()}return we},D.prototype.collides=function(De){var je=this.data;if(!Oe(De,je))return!1;for(var we=[];je;){for(var Te=0;Te<je.children.length;Te++){var le=je.children[Te],Re=je.leaf?this.toBBox(le):le;if(Oe(De,Re)){if(je.leaf||Ie(De,Re))return!0;we.push(le)}}je=we.pop()}return!1},D.prototype.load=function(De){if(!De||!De.length)return this;if(De.length<this._minEntries){for(var je=0;je<De.length;je++)this.insert(De[je]);return this}var we=this._build(De.slice(),0,De.length-1,0);if(this.data.children.length)if(this.data.height===we.height)this._splitRoot(this.data,we);else{if(this.data.height<we.height){var Te=this.data;this.data=we,we=Te}this._insert(we,this.data.height-we.height-1,!0)}else this.data=we;return this},D.prototype.insert=function(De){return De&&this._insert(De,this.data.height-1),this},D.prototype.clear=function(){return this.data=He([]),this},D.prototype.remove=function(De,je){if(!De)return this;for(var we,Te,le,Re=this.data,ye=this.toBBox(De),_e=[],ne=[];Re||_e.length;){if(Re||(Re=_e.pop(),Te=_e[_e.length-1],we=ne.pop(),le=!0),Re.leaf){var Y=G(De,Re.children,je);if(Y!==-1)return Re.children.splice(Y,1),_e.push(Re),this._condense(_e),this}le||Re.leaf||!Ie(Re,ye)?Te?(we++,Re=Te.children[we],le=!1):Re=null:(_e.push(Re),ne.push(we),we=0,Te=Re,Re=Re.children[0])}return this},D.prototype.toBBox=function(De){return De},D.prototype.compareMinX=function(De,je){return De.minX-je.minX},D.prototype.compareMinY=function(De,je){return De.minY-je.minY},D.prototype.toJSON=function(){return this.data},D.prototype.fromJSON=function(De){return this.data=De,this},D.prototype._all=function(De,je){for(var we=[];De;)De.leaf?je.push.apply(je,De.children):we.push.apply(we,De.children),De=we.pop();return je},D.prototype._build=function(De,je,we,Te){var le,Re=we-je+1,ye=this._maxEntries;if(Re<=ye)return Z(le=He(De.slice(je,we+1)),this.toBBox),le;Te||(Te=Math.ceil(Math.log(Re)/Math.log(ye)),ye=Math.ceil(Re/Math.pow(ye,Te-1))),(le=He([])).leaf=!1,le.height=Te;var _e=Math.ceil(Re/ye),ne=_e*Math.ceil(Math.sqrt(ye));st(De,je,we,ne,this.compareMinX);for(var Y=je;Y<=we;Y+=ne){var Le=Math.min(Y+ne-1,we);st(De,Y,Le,_e,this.compareMinY);for(var de=Y;de<=Le;de+=_e){var Ee=Math.min(de+_e-1,Le);le.children.push(this._build(De,de,Ee,Te-1))}}return Z(le,this.toBBox),le},D.prototype._chooseSubtree=function(De,je,we,Te){for(;Te.push(je),!je.leaf&&Te.length-1!==we;){for(var le=1/0,Re=1/0,ye=void 0,_e=0;_e<je.children.length;_e++){var ne=je.children[_e],Y=fe(ne),Le=(de=De,Ee=ne,(Math.max(Ee.maxX,de.maxX)-Math.min(Ee.minX,de.minX))*(Math.max(Ee.maxY,de.maxY)-Math.min(Ee.minY,de.minY))-Y);Le<Re?(Re=Le,le=Y<le?Y:le,ye=ne):Le===Re&&Y<le&&(le=Y,ye=ne)}je=ye||je.children[0]}var de,Ee;return je},D.prototype._insert=function(De,je,we){var Te=we?De:this.toBBox(De),le=[],Re=this._chooseSubtree(Te,this.data,je,le);for(Re.children.push(De),z(Re,Te);je>=0&&le[je].children.length>this._maxEntries;)this._split(le,je),je--;this._adjustParentBBoxes(Te,le,je)},D.prototype._split=function(De,je){var we=De[je],Te=we.children.length,le=this._minEntries;this._chooseSplitAxis(we,le,Te);var Re=this._chooseSplitIndex(we,le,Te),ye=He(we.children.splice(Re,we.children.length-Re));ye.height=we.height,ye.leaf=we.leaf,Z(we,this.toBBox),Z(ye,this.toBBox),je?De[je-1].children.push(ye):this._splitRoot(we,ye)},D.prototype._splitRoot=function(De,je){this.data=He([De,je]),this.data.height=De.height+1,this.data.leaf=!1,Z(this.data,this.toBBox)},D.prototype._chooseSplitIndex=function(De,je,we){for(var Te,le,Re,ye,_e,ne,Y,Le=1/0,de=1/0,Ee=je;Ee<=we-je;Ee++){var ge=F(De,0,Ee,this.toBBox),X=F(De,Ee,we,this.toBBox),Me=(le=ge,Re=X,ye=void 0,_e=void 0,ne=void 0,Y=void 0,ye=Math.max(le.minX,Re.minX),_e=Math.max(le.minY,Re.minY),ne=Math.min(le.maxX,Re.maxX),Y=Math.min(le.maxY,Re.maxY),Math.max(0,ne-ye)*Math.max(0,Y-_e)),Ae=fe(ge)+fe(X);Me<Le?(Le=Me,Te=Ee,de=Ae<de?Ae:de):Me===Le&&Ae<de&&(de=Ae,Te=Ee)}return Te||we-je},D.prototype._chooseSplitAxis=function(De,je,we){var Te=De.leaf?this.compareMinX:q,le=De.leaf?this.compareMinY:ee;this._allDistMargin(De,je,we,Te)<this._allDistMargin(De,je,we,le)&&De.children.sort(Te)},D.prototype._allDistMargin=function(De,je,we,Te){De.children.sort(Te);for(var le=this.toBBox,Re=F(De,0,je,le),ye=F(De,we-je,we,le),_e=be(Re)+be(ye),ne=je;ne<we-je;ne++){var Y=De.children[ne];z(Re,De.leaf?le(Y):Y),_e+=be(Re)}for(var Le=we-je-1;Le>=je;Le--){var de=De.children[Le];z(ye,De.leaf?le(de):de),_e+=be(ye)}return _e},D.prototype._adjustParentBBoxes=function(De,je,we){for(var Te=we;Te>=0;Te--)z(je[Te],De)},D.prototype._condense=function(De){for(var je=De.length-1,we=void 0;je>=0;je--)De[je].children.length===0?je>0?(we=De[je-1].children).splice(we.indexOf(De[je]),1):this.clear():Z(De[je],this.toBBox)},D})},78892:function(se,$,C){var P=C(97671);var D;(function(G){(function(Z){var F=typeof C.g=="object"?C.g:typeof self=="object"?self:typeof this=="object"?this:Function("return this;")(),z=q(G);typeof F.Reflect=="undefined"?F.Reflect=G:z=q(F.Reflect,z),Z(z);function q(ee,fe){return function(be,Ie){typeof ee[be]!="function"&&Object.defineProperty(ee,be,{configurable:!0,writable:!0,value:Ie}),fe&&fe(be,Ie)}}})(function(Z){var F=Object.prototype.hasOwnProperty,z=typeof Symbol=="function",q=z&&typeof Symbol.toPrimitive!="undefined"?Symbol.toPrimitive:"@@toPrimitive",ee=z&&typeof Symbol.iterator!="undefined"?Symbol.iterator:"@@iterator",fe=typeof Object.create=="function",be={__proto__:[]}instanceof Array,Ie=!fe&&!be,Oe={create:fe?function(){return yr(Object.create(null))}:be?function(){return yr({__proto__:null})}:function(){return yr({})},has:Ie?function(vt,Tt){return F.call(vt,Tt)}:function(vt,Tt){return Tt in vt},get:Ie?function(vt,Tt){return F.call(vt,Tt)?vt[Tt]:void 0}:function(vt,Tt){return vt[Tt]}},He=Object.getPrototypeOf(Function),st=typeof P=="object"&&{NODE_ENV:"production",PUBLIC_PATH:"/"}&&{NODE_ENV:"production",PUBLIC_PATH:"/"}.REFLECT_METADATA_USE_MAP_POLYFILL==="true",De=!st&&typeof Map=="function"&&typeof Map.prototype.entries=="function"?Map:At(),je=!st&&typeof Set=="function"&&typeof Set.prototype.entries=="function"?Set:Lt(),we=!st&&typeof WeakMap=="function"?WeakMap:wt(),Te=new we;function le(vt,Tt,Qt,xr){if(Ut(Qt)){if(!Vn(vt))throw new TypeError;if(!sn(Tt))throw new TypeError;return X(vt,Tt)}else{if(!Vn(vt))throw new TypeError;if(!Sr(Tt))throw new TypeError;if(!Sr(xr)&&!Ut(xr)&&!$r(xr))throw new TypeError;return $r(xr)&&(xr=void 0),Qt=ti(Qt),Me(vt,Tt,Qt,xr)}}Z("decorate",le);function Re(vt,Tt){function Qt(xr,kr){if(!Sr(xr))throw new TypeError;if(!Ut(kr)&&!_n(kr))throw new TypeError;oe(vt,Tt,xr,kr)}return Qt}Z("metadata",Re);function ye(vt,Tt,Qt,xr){if(!Sr(Qt))throw new TypeError;return Ut(xr)||(xr=ti(xr)),oe(vt,Tt,Qt,xr)}Z("defineMetadata",ye);function _e(vt,Tt,Qt){if(!Sr(Tt))throw new TypeError;return Ut(Qt)||(Qt=ti(Qt)),me(vt,Tt,Qt)}Z("hasMetadata",_e);function ne(vt,Tt,Qt){if(!Sr(Tt))throw new TypeError;return Ut(Qt)||(Qt=ti(Qt)),ue(vt,Tt,Qt)}Z("hasOwnMetadata",ne);function Y(vt,Tt,Qt){if(!Sr(Tt))throw new TypeError;return Ut(Qt)||(Qt=ti(Qt)),ke(vt,Tt,Qt)}Z("getMetadata",Y);function Le(vt,Tt,Qt){if(!Sr(Tt))throw new TypeError;return Ut(Qt)||(Qt=ti(Qt)),Ze(vt,Tt,Qt)}Z("getOwnMetadata",Le);function de(vt,Tt){if(!Sr(vt))throw new TypeError;return Ut(Tt)||(Tt=ti(Tt)),Dt(vt,Tt)}Z("getMetadataKeys",de);function Ee(vt,Tt){if(!Sr(vt))throw new TypeError;return Ut(Tt)||(Tt=ti(Tt)),Rt(vt,Tt)}Z("getOwnMetadataKeys",Ee);function ge(vt,Tt,Qt){if(!Sr(Tt))throw new TypeError;Ut(Qt)||(Qt=ti(Qt));var xr=Ae(Tt,Qt,!1);if(Ut(xr)||!xr.delete(vt))return!1;if(xr.size>0)return!0;var kr=Te.get(Tt);return kr.delete(Qt),kr.size>0||Te.delete(Tt),!0}Z("deleteMetadata",ge);function X(vt,Tt){for(var Qt=vt.length-1;Qt>=0;--Qt){var xr=vt[Qt],kr=xr(Tt);if(!Ut(kr)&&!$r(kr)){if(!sn(kr))throw new TypeError;Tt=kr}}return Tt}function Me(vt,Tt,Qt,xr){for(var kr=vt.length-1;kr>=0;--kr){var Wr=vt[kr],an=Wr(Tt,Qt,xr);if(!Ut(an)&&!$r(an)){if(!Sr(an))throw new TypeError;xr=an}}return xr}function Ae(vt,Tt,Qt){var xr=Te.get(vt);if(Ut(xr)){if(!Qt)return;xr=new De,Te.set(vt,xr)}var kr=xr.get(Tt);if(Ut(kr)){if(!Qt)return;kr=new De,xr.set(Tt,kr)}return kr}function me(vt,Tt,Qt){var xr=ue(vt,Tt,Qt);if(xr)return!0;var kr=$e(Tt);return $r(kr)?!1:me(vt,kr,Qt)}function ue(vt,Tt,Qt){var xr=Ae(Tt,Qt,!1);return Ut(xr)?!1:_r(xr.has(vt))}function ke(vt,Tt,Qt){var xr=ue(vt,Tt,Qt);if(xr)return Ze(vt,Tt,Qt);var kr=$e(Tt);if(!$r(kr))return ke(vt,kr,Qt)}function Ze(vt,Tt,Qt){var xr=Ae(Tt,Qt,!1);if(!Ut(xr))return xr.get(vt)}function oe(vt,Tt,Qt,xr){var kr=Ae(Qt,xr,!0);kr.set(vt,Tt)}function Dt(vt,Tt){var Qt=Rt(vt,Tt),xr=$e(vt);if(xr===null)return Qt;var kr=Dt(xr,Tt);if(kr.length<=0)return Qt;if(Qt.length<=0)return kr;for(var Wr=new je,an=[],Br=0,en=Qt;Br<en.length;Br++){var Zn=en[Br],zn=Wr.has(Zn);zn||(Wr.add(Zn),an.push(Zn))}for(var li=0,sa=kr;li<sa.length;li++){var Zn=sa[li],zn=Wr.has(Zn);zn||(Wr.add(Zn),an.push(Zn))}return an}function Rt(vt,Tt){var Qt=[],xr=Ae(vt,Tt,!1);if(Ut(xr))return Qt;for(var kr=xr.keys(),Wr=ri(kr),an=0;;){var Br=J(Wr);if(!Br)return Qt.length=an,Qt;var en=Pt(Br);try{Qt[an]=en}catch(Zn){try{ze(Wr)}finally{throw Zn}}an++}}function cr(vt){if(vt===null)return 1;switch(typeof vt){case"undefined":return 0;case"boolean":return 2;case"string":return 3;case"symbol":return 4;case"number":return 5;case"object":return vt===null?1:6;default:return 6}}function Ut(vt){return vt===void 0}function $r(vt){return vt===null}function ln(vt){return typeof vt=="symbol"}function Sr(vt){return typeof vt=="object"?vt!==null:typeof vt=="function"}function Qr(vt,Tt){switch(cr(vt)){case 0:return vt;case 1:return vt;case 2:return vt;case 3:return vt;case 4:return vt;case 5:return vt}var Qt=Tt===3?"string":Tt===5?"number":"default",xr=Di(vt,q);if(xr!==void 0){var kr=xr.call(vt,Qt);if(Sr(kr))throw new TypeError;return kr}return Jr(vt,Qt==="default"?"number":Qt)}function Jr(vt,Tt){if(Tt==="string"){var Qt=vt.toString;if(Xr(Qt)){var xr=Qt.call(vt);if(!Sr(xr))return xr}var kr=vt.valueOf;if(Xr(kr)){var xr=kr.call(vt);if(!Sr(xr))return xr}}else{var kr=vt.valueOf;if(Xr(kr)){var xr=kr.call(vt);if(!Sr(xr))return xr}var Wr=vt.toString;if(Xr(Wr)){var xr=Wr.call(vt);if(!Sr(xr))return xr}}throw new TypeError}function _r(vt){return!!vt}function Gn(vt){return""+vt}function ti(vt){var Tt=Qr(vt,3);return ln(Tt)?Tt:Gn(Tt)}function Vn(vt){return Array.isArray?Array.isArray(vt):vt instanceof Object?vt instanceof Array:Object.prototype.toString.call(vt)==="[object Array]"}function Xr(vt){return typeof vt=="function"}function sn(vt){return typeof vt=="function"}function _n(vt){switch(cr(vt)){case 3:return!0;case 4:return!0;default:return!1}}function Di(vt,Tt){var Qt=vt[Tt];if(Qt!=null){if(!Xr(Qt))throw new TypeError;return Qt}}function ri(vt){var Tt=Di(vt,ee);if(!Xr(Tt))throw new TypeError;var Qt=Tt.call(vt);if(!Sr(Qt))throw new TypeError;return Qt}function Pt(vt){return vt.value}function J(vt){var Tt=vt.next();return Tt.done?!1:Tt}function ze(vt){var Tt=vt.return;Tt&&Tt.call(vt)}function $e(vt){var Tt=Object.getPrototypeOf(vt);if(typeof vt!="function"||vt===He||Tt!==He)return Tt;var Qt=vt.prototype,xr=Qt&&Object.getPrototypeOf(Qt);if(xr==null||xr===Object.prototype)return Tt;var kr=xr.constructor;return typeof kr!="function"||kr===vt?Tt:kr}function At(){var vt={},Tt=[],Qt=function(){function an(Br,en,Zn){this._index=0,this._keys=Br,this._values=en,this._selector=Zn}return an.prototype["@@iterator"]=function(){return this},an.prototype[ee]=function(){return this},an.prototype.next=function(){var Br=this._index;if(Br>=0&&Br<this._keys.length){var en=this._selector(this._keys[Br],this._values[Br]);return Br+1>=this._keys.length?(this._index=-1,this._keys=Tt,this._values=Tt):this._index++,{value:en,done:!1}}return{value:void 0,done:!0}},an.prototype.throw=function(Br){throw this._index>=0&&(this._index=-1,this._keys=Tt,this._values=Tt),Br},an.prototype.return=function(Br){return this._index>=0&&(this._index=-1,this._keys=Tt,this._values=Tt),{value:Br,done:!0}},an}();return function(){function an(){this._keys=[],this._values=[],this._cacheKey=vt,this._cacheIndex=-2}return Object.defineProperty(an.prototype,"size",{get:function(){return this._keys.length},enumerable:!0,configurable:!0}),an.prototype.has=function(Br){return this._find(Br,!1)>=0},an.prototype.get=function(Br){var en=this._find(Br,!1);return en>=0?this._values[en]:void 0},an.prototype.set=function(Br,en){var Zn=this._find(Br,!0);return this._values[Zn]=en,this},an.prototype.delete=function(Br){var en=this._find(Br,!1);if(en>=0){for(var Zn=this._keys.length,zn=en+1;zn<Zn;zn++)this._keys[zn-1]=this._keys[zn],this._values[zn-1]=this._values[zn];return this._keys.length--,this._values.length--,Br===this._cacheKey&&(this._cacheKey=vt,this._cacheIndex=-2),!0}return!1},an.prototype.clear=function(){this._keys.length=0,this._values.length=0,this._cacheKey=vt,this._cacheIndex=-2},an.prototype.keys=function(){return new Qt(this._keys,this._values,xr)},an.prototype.values=function(){return new Qt(this._keys,this._values,kr)},an.prototype.entries=function(){return new Qt(this._keys,this._values,Wr)},an.prototype["@@iterator"]=function(){return this.entries()},an.prototype[ee]=function(){return this.entries()},an.prototype._find=function(Br,en){return this._cacheKey!==Br&&(this._cacheIndex=this._keys.indexOf(this._cacheKey=Br)),this._cacheIndex<0&&en&&(this._cacheIndex=this._keys.length,this._keys.push(Br),this._values.push(void 0)),this._cacheIndex},an}();function xr(an,Br){return an}function kr(an,Br){return Br}function Wr(an,Br){return[an,Br]}}function Lt(){return function(){function vt(){this._map=new De}return Object.defineProperty(vt.prototype,"size",{get:function(){return this._map.size},enumerable:!0,configurable:!0}),vt.prototype.has=function(Tt){return this._map.has(Tt)},vt.prototype.add=function(Tt){return this._map.set(Tt,Tt),this},vt.prototype.delete=function(Tt){return this._map.delete(Tt)},vt.prototype.clear=function(){this._map.clear()},vt.prototype.keys=function(){return this._map.keys()},vt.prototype.values=function(){return this._map.values()},vt.prototype.entries=function(){return this._map.entries()},vt.prototype["@@iterator"]=function(){return this.keys()},vt.prototype[ee]=function(){return this.keys()},vt}()}function wt(){var vt=16,Tt=Oe.create(),Qt=xr();return function(){function en(){this._key=xr()}return en.prototype.has=function(Zn){var zn=kr(Zn,!1);return zn!==void 0?Oe.has(zn,this._key):!1},en.prototype.get=function(Zn){var zn=kr(Zn,!1);return zn!==void 0?Oe.get(zn,this._key):void 0},en.prototype.set=function(Zn,zn){var li=kr(Zn,!0);return li[this._key]=zn,this},en.prototype.delete=function(Zn){var zn=kr(Zn,!1);return zn!==void 0?delete zn[this._key]:!1},en.prototype.clear=function(){this._key=xr()},en}();function xr(){var en;do en="@@WeakMap@@"+Br();while(Oe.has(Tt,en));return Tt[en]=!0,en}function kr(en,Zn){if(!F.call(en,Qt)){if(!Zn)return;Object.defineProperty(en,Qt,{value:Oe.create()})}return en[Qt]}function Wr(en,Zn){for(var zn=0;zn<Zn;++zn)en[zn]=Math.random()*255|0;return en}function an(en){return typeof Uint8Array=="function"?typeof crypto!="undefined"?crypto.getRandomValues(new Uint8Array(en)):typeof msCrypto!="undefined"?msCrypto.getRandomValues(new Uint8Array(en)):Wr(new Uint8Array(en),en):Wr(new Array(en),en)}function Br(){var en=an(vt);en[6]=en[6]&79|64,en[8]=en[8]&191|128;for(var Zn="",zn=0;zn<vt;++zn){var li=en[zn];(zn===4||zn===6||zn===8)&&(Zn+="-"),li<16&&(Zn+="0"),Zn+=li.toString(16).toLowerCase()}return Zn}}function yr(vt){return vt.__=void 0,delete vt.__,vt}})})(D||(D={}))},53273:function(se,$,C){"use strict";var P=C(76160),D=Object,G=TypeError;se.exports=P(function(){if(this!=null&&this!==D(this))throw new G("RegExp.prototype.flags getter called on non-object");var F="";return this.hasIndices&&(F+="d"),this.global&&(F+="g"),this.ignoreCase&&(F+="i"),this.multiline&&(F+="m"),this.dotAll&&(F+="s"),this.unicode&&(F+="u"),this.unicodeSets&&(F+="v"),this.sticky&&(F+="y"),F},"get flags",!0)},61245:function(se,$,C){"use strict";var P=C(8263),D=C(71262),G=C(53273),Z=C(60096),F=C(79621),z=D(Z());P(z,{getPolyfill:Z,implementation:G,shim:F}),se.exports=z},60096:function(se,$,C){"use strict";var P=C(53273),D=C(8263).supportsDescriptors,G=Object.getOwnPropertyDescriptor;se.exports=function(){if(D&&/a/mig.flags==="gim"){var F=G(RegExp.prototype,"flags");if(F&&typeof F.get=="function"&&typeof RegExp.prototype.dotAll=="boolean"&&typeof RegExp.prototype.hasIndices=="boolean"){var z="",q={};if(Object.defineProperty(q,"hasIndices",{get:function(){z+="d"}}),Object.defineProperty(q,"sticky",{get:function(){z+="y"}}),z==="dy")return F.get}}return P}},79621:function(se,$,C){"use strict";var P=C(8263).supportsDescriptors,D=C(60096),G=Object.getOwnPropertyDescriptor,Z=Object.defineProperty,F=TypeError,z=Object.getPrototypeOf,q=/a/;se.exports=function(){if(!P||!z)throw new F("RegExp.prototype.flags requires a true ES5 environment that supports property descriptors");var fe=D(),be=z(q),Ie=G(be,"flags");return(!Ie||Ie.get!==fe)&&Z(be,"flags",{configurable:!0,enumerable:!1,get:fe}),fe}},96377:function(se){(function($,C){se.exports=C()})(this,function(){"use strict";var $=function(xe){return xe instanceof Uint8Array||xe instanceof Uint16Array||xe instanceof Uint32Array||xe instanceof Int8Array||xe instanceof Int16Array||xe instanceof Int32Array||xe instanceof Float32Array||xe instanceof Float64Array||xe instanceof Uint8ClampedArray},C=function(xe,Ke){for(var mt=Object.keys(Ke),nr=0;nr<mt.length;++nr)xe[mt[nr]]=Ke[mt[nr]];return xe},P=`
`;function D(xe){return typeof atob!="undefined"?atob(xe):"base64:"+xe}function G(xe){var Ke=new Error("(regl) "+xe);throw console.error(Ke),Ke}function Z(xe,Ke){xe||G(Ke)}function F(xe){return xe?": "+xe:""}function z(xe,Ke,mt){xe in Ke||G("unknown parameter ("+xe+")"+F(mt)+". possible values: "+Object.keys(Ke).join())}function q(xe,Ke){$(xe)||G("invalid parameter type"+F(Ke)+". must be a typed array")}function ee(xe,Ke){switch(Ke){case"number":return typeof xe=="number";case"object":return typeof xe=="object";case"string":return typeof xe=="string";case"boolean":return typeof xe=="boolean";case"function":return typeof xe=="function";case"undefined":return typeof xe=="undefined";case"symbol":return typeof xe=="symbol"}}function fe(xe,Ke,mt){ee(xe,Ke)||G("invalid parameter type"+F(mt)+". expected "+Ke+", got "+typeof xe)}function be(xe,Ke){xe>=0&&(xe|0)===xe||G("invalid parameter type, ("+xe+")"+F(Ke)+". must be a nonnegative integer")}function Ie(xe,Ke,mt){Ke.indexOf(xe)<0&&G("invalid value"+F(mt)+". must be one of: "+Ke)}var Oe=["gl","canvas","container","attributes","pixelRatio","extensions","optionalExtensions","profile","onDone"];function He(xe){Object.keys(xe).forEach(function(Ke){Oe.indexOf(Ke)<0&&G('invalid regl constructor argument "'+Ke+'". must be one of '+Oe)})}function st(xe,Ke){for(xe=xe+"";xe.length<Ke;)xe=" "+xe;return xe}function De(){this.name="unknown",this.lines=[],this.index={},this.hasErrors=!1}function je(xe,Ke){this.number=xe,this.line=Ke,this.errors=[]}function we(xe,Ke,mt){this.file=xe,this.line=Ke,this.message=mt}function Te(){var xe=new Error,Ke=(xe.stack||xe).toString(),mt=/compileProcedure.*\n\s*at.*\((.*)\)/.exec(Ke);if(mt)return mt[1];var nr=/compileProcedure.*\n\s*at\s+(.*)(\n|$)/.exec(Ke);return nr?nr[1]:"unknown"}function le(){var xe=new Error,Ke=(xe.stack||xe).toString(),mt=/at REGLCommand.*\n\s+at.*\((.*)\)/.exec(Ke);if(mt)return mt[1];var nr=/at REGLCommand.*\n\s+at\s+(.*)\n/.exec(Ke);return nr?nr[1]:"unknown"}function Re(xe,Ke){var mt=xe.split(`
`),nr=1,Ar=0,er={unknown:new De,0:new De};er.unknown.name=er[0].name=Ke||Te(),er.unknown.lines.push(new je(0,""));for(var sr=0;sr<mt.length;++sr){var wr=mt[sr],Pr=/^\s*#\s*(\w+)\s+(.+)\s*$/.exec(wr);if(Pr)switch(Pr[1]){case"line":var Nr=/(\d+)(\s+\d+)?/.exec(Pr[2]);Nr&&(nr=Nr[1]|0,Nr[2]&&(Ar=Nr[2]|0,Ar in er||(er[Ar]=new De)));break;case"define":var Dr=/SHADER_NAME(_B64)?\s+(.*)$/.exec(Pr[2]);Dr&&(er[Ar].name=Dr[1]?D(Dr[2]):Dr[2]);break}er[Ar].lines.push(new je(nr++,wr))}return Object.keys(er).forEach(function(Or){var qr=er[Or];qr.lines.forEach(function(Tr){qr.index[Tr.number]=Tr})}),er}function ye(xe){var Ke=[];return xe.split(`
`).forEach(function(mt){if(!(mt.length<5)){var nr=/^ERROR:\s+(\d+):(\d+):\s*(.*)$/.exec(mt);nr?Ke.push(new we(nr[1]|0,nr[2]|0,nr[3].trim())):mt.length>0&&Ke.push(new we("unknown",0,mt))}}),Ke}function _e(xe,Ke){Ke.forEach(function(mt){var nr=xe[mt.file];if(nr){var Ar=nr.index[mt.line];if(Ar){Ar.errors.push(mt),nr.hasErrors=!0;return}}xe.unknown.hasErrors=!0,xe.unknown.lines[0].errors.push(mt)})}function ne(xe,Ke,mt,nr,Ar){if(!xe.getShaderParameter(Ke,xe.COMPILE_STATUS)){var er=xe.getShaderInfoLog(Ke),sr=nr===xe.FRAGMENT_SHADER?"fragment":"vertex";Me(mt,"string",sr+" shader source must be a string",Ar);var wr=Re(mt,Ar),Pr=ye(er);_e(wr,Pr),Object.keys(wr).forEach(function(Nr){var Dr=wr[Nr];if(!Dr.hasErrors)return;var Or=[""],qr=[""];function Tr(Zr,Vt){Or.push(Zr),qr.push(Vt||"")}Tr("file number "+Nr+": "+Dr.name+`
`,"color:red;text-decoration:underline;font-weight:bold"),Dr.lines.forEach(function(Zr){if(Zr.errors.length>0){Tr(st(Zr.number,4)+"|  ","background-color:yellow; font-weight:bold"),Tr(Zr.line+P,"color:red; background-color:yellow; font-weight:bold");var Vt=0;Zr.errors.forEach(function(lr){var Rr=lr.message,tn=/^\s*'(.*)'\s*:\s*(.*)$/.exec(Rr);if(tn){var mr=tn[1];switch(Rr=tn[2],mr){case"assign":mr="=";break}Vt=Math.max(Zr.line.indexOf(mr,Vt),0)}else Vt=0;Tr(st("| ",6)),Tr(st("^^^",Vt+3)+P,"font-weight:bold"),Tr(st("| ",6)),Tr(Rr+P,"font-weight:bold")}),Tr(st("| ",6)+P)}else Tr(st(Zr.number,4)+"|  "),Tr(Zr.line+P,"color:red")}),typeof document!="undefined"&&!window.chrome?(qr[0]=Or.join("%c"),console.log.apply(console,qr)):console.log(Or.join(""))}),Z.raise("Error compiling "+sr+" shader, "+wr[0].name)}}function Y(xe,Ke,mt,nr,Ar){if(!xe.getProgramParameter(Ke,xe.LINK_STATUS)){var er=xe.getProgramInfoLog(Ke),sr=Re(mt,Ar),wr=Re(nr,Ar),Pr='Error linking program with vertex shader, "'+wr[0].name+'", and fragment shader "'+sr[0].name+'"';typeof document!="undefined"?console.log("%c"+Pr+P+"%c"+er,"color:red;text-decoration:underline;font-weight:bold","color:red"):console.log(Pr+P+er),Z.raise(Pr)}}function Le(xe){xe._commandRef=Te()}function de(xe,Ke,mt,nr){Le(xe);function Ar(Pr){return Pr?nr.id(Pr):0}xe._fragId=Ar(xe.static.frag),xe._vertId=Ar(xe.static.vert);function er(Pr,Nr){Object.keys(Nr).forEach(function(Dr){Pr[nr.id(Dr)]=!0})}var sr=xe._uniformSet={};er(sr,Ke.static),er(sr,Ke.dynamic);var wr=xe._attributeSet={};er(wr,mt.static),er(wr,mt.dynamic),xe._hasCount="count"in xe.static||"count"in xe.dynamic||"elements"in xe.static||"elements"in xe.dynamic}function Ee(xe,Ke){var mt=le();G(xe+" in command "+(Ke||Te())+(mt==="unknown"?"":" called from "+mt))}function ge(xe,Ke,mt){xe||Ee(Ke,mt||Te())}function X(xe,Ke,mt,nr){xe in Ke||Ee("unknown parameter ("+xe+")"+F(mt)+". possible values: "+Object.keys(Ke).join(),nr||Te())}function Me(xe,Ke,mt,nr){ee(xe,Ke)||Ee("invalid parameter type"+F(mt)+". expected "+Ke+", got "+typeof xe,nr||Te())}function Ae(xe){xe()}function me(xe,Ke,mt){xe.texture?Ie(xe.texture._texture.internalformat,Ke,"unsupported texture format for attachment"):Ie(xe.renderbuffer._renderbuffer.format,mt,"unsupported renderbuffer format for attachment")}var ue=33071,ke=9728,Ze=9984,oe=9985,Dt=9986,Rt=9987,cr=5120,Ut=5121,$r=5122,ln=5123,Sr=5124,Qr=5125,Jr=5126,_r=32819,Gn=32820,ti=33635,Vn=34042,Xr=36193,sn={};sn[cr]=sn[Ut]=1,sn[$r]=sn[ln]=sn[Xr]=sn[ti]=sn[_r]=sn[Gn]=2,sn[Sr]=sn[Qr]=sn[Jr]=sn[Vn]=4;function _n(xe,Ke){return xe===Gn||xe===_r||xe===ti?2:xe===Vn?4:sn[xe]*Ke}function Di(xe){return!(xe&xe-1)&&!!xe}function ri(xe,Ke,mt){var nr,Ar=Ke.width,er=Ke.height,sr=Ke.channels;Z(Ar>0&&Ar<=mt.maxTextureSize&&er>0&&er<=mt.maxTextureSize,"invalid texture shape"),(xe.wrapS!==ue||xe.wrapT!==ue)&&Z(Di(Ar)&&Di(er),"incompatible wrap mode for texture, both width and height must be power of 2"),Ke.mipmask===1?Ar!==1&&er!==1&&Z(xe.minFilter!==Ze&&xe.minFilter!==Dt&&xe.minFilter!==oe&&xe.minFilter!==Rt,"min filter requires mipmap"):(Z(Di(Ar)&&Di(er),"texture must be a square power of 2 to support mipmapping"),Z(Ke.mipmask===(Ar<<1)-1,"missing or incomplete mipmap data")),Ke.type===Jr&&(mt.extensions.indexOf("oes_texture_float_linear")<0&&Z(xe.minFilter===ke&&xe.magFilter===ke,"filter not supported, must enable oes_texture_float_linear"),Z(!xe.genMipmaps,"mipmap generation not supported with float textures"));var wr=Ke.images;for(nr=0;nr<16;++nr)if(wr[nr]){var Pr=Ar>>nr,Nr=er>>nr;Z(Ke.mipmask&1<<nr,"missing mipmap data");var Dr=wr[nr];if(Z(Dr.width===Pr&&Dr.height===Nr,"invalid shape for mip images"),Z(Dr.format===Ke.format&&Dr.internalformat===Ke.internalformat&&Dr.type===Ke.type,"incompatible type for mip image"),!Dr.compressed)if(Dr.data){var Or=Math.ceil(_n(Dr.type,sr)*Pr/Dr.unpackAlignment)*Dr.unpackAlignment;Z(Dr.data.byteLength===Or*Nr,"invalid data for image, buffer size is inconsistent with image format")}else Dr.element||Dr.copy}else xe.genMipmaps||Z((Ke.mipmask&1<<nr)===0,"extra mipmap data");Ke.compressed&&Z(!xe.genMipmaps,"mipmap generation for compressed images not supported")}function Pt(xe,Ke,mt,nr){var Ar=xe.width,er=xe.height,sr=xe.channels;Z(Ar>0&&Ar<=nr.maxTextureSize&&er>0&&er<=nr.maxTextureSize,"invalid texture shape"),Z(Ar===er,"cube map must be square"),Z(Ke.wrapS===ue&&Ke.wrapT===ue,"wrap mode not supported by cube map");for(var wr=0;wr<mt.length;++wr){var Pr=mt[wr];Z(Pr.width===Ar&&Pr.height===er,"inconsistent cube map face shape"),Ke.genMipmaps&&(Z(!Pr.compressed,"can not generate mipmap for compressed textures"),Z(Pr.mipmask===1,"can not specify mipmaps and generate mipmaps"));for(var Nr=Pr.images,Dr=0;Dr<16;++Dr){var Or=Nr[Dr];if(Or){var qr=Ar>>Dr,Tr=er>>Dr;Z(Pr.mipmask&1<<Dr,"missing mipmap data"),Z(Or.width===qr&&Or.height===Tr,"invalid shape for mip images"),Z(Or.format===xe.format&&Or.internalformat===xe.internalformat&&Or.type===xe.type,"incompatible type for mip image"),Or.compressed||(Or.data?Z(Or.data.byteLength===qr*Tr*Math.max(_n(Or.type,sr),Or.unpackAlignment),"invalid data for image, buffer size is inconsistent with image format"):Or.element||Or.copy)}}}}var J=C(Z,{optional:Ae,raise:G,commandRaise:Ee,command:ge,parameter:z,commandParameter:X,constructor:He,type:fe,commandType:Me,isTypedArray:q,nni:be,oneOf:Ie,shaderError:ne,linkError:Y,callSite:le,saveCommandRef:Le,saveDrawInfo:de,framebufferFormat:me,guessCommand:Te,texture2D:ri,textureCube:Pt}),ze=0,$e=0,At=5,Lt=6;function wt(xe,Ke){this.id=ze++,this.type=xe,this.data=Ke}function yr(xe){return xe.replace(/\\/g,"\\\\").replace(/"/g,'\\"')}function vt(xe){if(xe.length===0)return[];var Ke=xe.charAt(0),mt=xe.charAt(xe.length-1);if(xe.length>1&&Ke===mt&&(Ke==='"'||Ke==="'"))return['"'+yr(xe.substr(1,xe.length-2))+'"'];var nr=/\[(false|true|null|\d+|'[^']*'|"[^"]*")\]/.exec(xe);if(nr)return vt(xe.substr(0,nr.index)).concat(vt(nr[1])).concat(vt(xe.substr(nr.index+nr[0].length)));var Ar=xe.split(".");if(Ar.length===1)return['"'+yr(xe)+'"'];for(var er=[],sr=0;sr<Ar.length;++sr)er=er.concat(vt(Ar[sr]));return er}function Tt(xe){return"["+vt(xe).join("][")+"]"}function Qt(xe,Ke){return new wt(xe,Tt(Ke+""))}function xr(xe){return typeof xe=="function"&&!xe._reglType||xe instanceof wt}function kr(xe,Ke){if(typeof xe=="function")return new wt($e,xe);if(typeof xe=="number"||typeof xe=="boolean")return new wt(At,xe);if(Array.isArray(xe))return new wt(Lt,xe.map((mt,nr)=>kr(mt,Ke+"["+nr+"]")));if(xe instanceof wt)return xe;J(!1,"invalid option type in uniform "+Ke)}var Wr={DynamicVariable:wt,define:Qt,isDynamic:xr,unbox:kr,accessor:Tt},an={next:typeof requestAnimationFrame=="function"?function(xe){return requestAnimationFrame(xe)}:function(xe){return setTimeout(xe,16)},cancel:typeof cancelAnimationFrame=="function"?function(xe){return cancelAnimationFrame(xe)}:clearTimeout},Br=typeof performance!="undefined"&&performance.now?function(){return performance.now()}:function(){return+new Date};function en(){var xe={"":0},Ke=[""];return{id:function(mt){var nr=xe[mt];return nr||(nr=xe[mt]=Ke.length,Ke.push(mt),nr)},str:function(mt){return Ke[mt]}}}function Zn(xe,Ke,mt){var nr=document.createElement("canvas");C(nr.style,{border:0,margin:0,padding:0,top:0,left:0}),xe.appendChild(nr),xe===document.body&&(nr.style.position="absolute",C(xe.style,{margin:0,padding:0}));function Ar(){var wr=window.innerWidth,Pr=window.innerHeight;if(xe!==document.body){var Nr=xe.getBoundingClientRect();wr=Nr.right-Nr.left,Pr=Nr.bottom-Nr.top}nr.width=mt*wr,nr.height=mt*Pr,C(nr.style,{width:wr+"px",height:Pr+"px"})}var er;xe!==document.body&&typeof ResizeObserver=="function"?(er=new ResizeObserver(function(){setTimeout(Ar)}),er.observe(xe)):window.addEventListener("resize",Ar,!1);function sr(){er?er.disconnect():window.removeEventListener("resize",Ar),xe.removeChild(nr)}return Ar(),{canvas:nr,onDestroy:sr}}function zn(xe,Ke){function mt(nr){try{return xe.getContext(nr,Ke)}catch(Ar){return null}}return mt("webgl")||mt("experimental-webgl")||mt("webgl-experimental")}function li(xe){return typeof xe.nodeName=="string"&&typeof xe.appendChild=="function"&&typeof xe.getBoundingClientRect=="function"}function sa(xe){return typeof xe.drawArrays=="function"||typeof xe.drawElements=="function"}function Oa(xe){return typeof xe=="string"?xe.split():(J(Array.isArray(xe),"invalid extension array"),xe)}function Gr(xe){return typeof xe=="string"?(J(typeof document!="undefined","not supported outside of DOM"),document.querySelector(xe)):xe}function Ds(xe){var Ke=xe||{},mt,nr,Ar,er,sr={},wr=[],Pr=[],Nr=typeof window=="undefined"?1:window.devicePixelRatio,Dr=!1,Or=function(Zr){Zr&&J.raise(Zr)},qr=function(){};if(typeof Ke=="string"?(J(typeof document!="undefined","selector queries only supported in DOM enviroments"),mt=document.querySelector(Ke),J(mt,"invalid query string for element")):typeof Ke=="object"?li(Ke)?mt=Ke:sa(Ke)?(er=Ke,Ar=er.canvas):(J.constructor(Ke),"gl"in Ke?er=Ke.gl:"canvas"in Ke?Ar=Gr(Ke.canvas):"container"in Ke&&(nr=Gr(Ke.container)),"attributes"in Ke&&(sr=Ke.attributes,J.type(sr,"object","invalid context attributes")),"extensions"in Ke&&(wr=Oa(Ke.extensions)),"optionalExtensions"in Ke&&(Pr=Oa(Ke.optionalExtensions)),"onDone"in Ke&&(J.type(Ke.onDone,"function","invalid or missing onDone callback"),Or=Ke.onDone),"profile"in Ke&&(Dr=!!Ke.profile),"pixelRatio"in Ke&&(Nr=+Ke.pixelRatio,J(Nr>0,"invalid pixel ratio"))):J.raise("invalid arguments to regl"),mt&&(mt.nodeName.toLowerCase()==="canvas"?Ar=mt:nr=mt),!er){if(!Ar){J(typeof document!="undefined","must manually specify webgl context outside of DOM environments");var Tr=Zn(nr||document.body,Or,Nr);if(!Tr)return null;Ar=Tr.canvas,qr=Tr.onDestroy}sr.premultipliedAlpha===void 0&&(sr.premultipliedAlpha=!0),er=zn(Ar,sr)}return er?{gl:er,canvas:Ar,container:nr,extensions:wr,optionalExtensions:Pr,pixelRatio:Nr,profile:Dr,onDone:Or,onDestroy:qr}:(qr(),Or("webgl not supported, try upgrading your browser or graphics drivers http://get.webgl.org"),null)}function Co(xe,Ke){var mt={};function nr(sr){J.type(sr,"string","extension name must be string");var wr=sr.toLowerCase(),Pr;try{Pr=mt[wr]=xe.getExtension(wr)}catch(Nr){}return!!Pr}for(var Ar=0;Ar<Ke.extensions.length;++Ar){var er=Ke.extensions[Ar];if(!nr(er))return Ke.onDestroy(),Ke.onDone('"'+er+'" extension is not supported by the current WebGL context, try upgrading your system or a different browser'),null}return Ke.optionalExtensions.forEach(nr),{extensions:mt,restore:function(){Object.keys(mt).forEach(function(sr){if(mt[sr]&&!nr(sr))throw new Error("(regl): error restoring extension "+sr)})}}}function xn(xe,Ke){for(var mt=Array(xe),nr=0;nr<xe;++nr)mt[nr]=Ke(nr);return mt}var xs=5120,go=5121,Ns=5122,Po=5123,hl=5124,yu=5125,Es=5126;function fs(xe){for(var Ke=16;Ke<=1<<28;Ke*=16)if(xe<=Ke)return Ke;return 0}function Ou(xe){var Ke,mt;return Ke=(xe>65535)<<4,xe>>>=Ke,mt=(xe>255)<<3,xe>>>=mt,Ke|=mt,mt=(xe>15)<<2,xe>>>=mt,Ke|=mt,mt=(xe>3)<<1,xe>>>=mt,Ke|=mt,Ke|xe>>1}function Al(){var xe=xn(8,function(){return[]});function Ke(er){var sr=fs(er),wr=xe[Ou(sr)>>2];return wr.length>0?wr.pop():new ArrayBuffer(sr)}function mt(er){xe[Ou(er.byteLength)>>2].push(er)}function nr(er,sr){var wr=null;switch(er){case xs:wr=new Int8Array(Ke(sr),0,sr);break;case go:wr=new Uint8Array(Ke(sr),0,sr);break;case Ns:wr=new Int16Array(Ke(2*sr),0,sr);break;case Po:wr=new Uint16Array(Ke(2*sr),0,sr);break;case hl:wr=new Int32Array(Ke(4*sr),0,sr);break;case yu:wr=new Uint32Array(Ke(4*sr),0,sr);break;case Es:wr=new Float32Array(Ke(4*sr),0,sr);break;default:return null}return wr.length!==sr?wr.subarray(0,sr):wr}function Ar(er){mt(er.buffer)}return{alloc:Ke,free:mt,allocType:nr,freeType:Ar}}var da=Al();da.zero=Al();var Zi=3408,Fs=3410,no=3411,ts=3412,Oo=3413,Ni=3414,io=3415,bs=33901,Wo=33902,Ru=3379,Sa=3386,ya=34921,Ku=36347,uo=36348,Js=35661,Ca=35660,uu=34930,Mr=36349,vn=34076,lo=34024,eu=7936,tu=7937,Ss=7938,Bs=35724,ja=34047,Yc=36063,Cs=34852,rs=3553,Ll=34067,zi=34069,Pl=33984,Ro=6408,pl=5126,Ai=5121,_u=36160,vf=36053,ku=36064,ns=16384,Mt=function(xe,Ke){var mt=1;Ke.ext_texture_filter_anisotropic&&(mt=xe.getParameter(ja));var nr=1,Ar=1;Ke.webgl_draw_buffers&&(nr=xe.getParameter(Cs),Ar=xe.getParameter(Yc));var er=!!Ke.oes_texture_float;if(er){var sr=xe.createTexture();xe.bindTexture(rs,sr),xe.texImage2D(rs,0,Ro,1,1,0,Ro,pl,null);var wr=xe.createFramebuffer();if(xe.bindFramebuffer(_u,wr),xe.framebufferTexture2D(_u,ku,rs,sr,0),xe.bindTexture(rs,null),xe.checkFramebufferStatus(_u)!==vf)er=!1;else{xe.viewport(0,0,1,1),xe.clearColor(1,0,0,1),xe.clear(ns);var Pr=da.allocType(pl,4);xe.readPixels(0,0,1,1,Ro,pl,Pr),xe.getError()?er=!1:(xe.deleteFramebuffer(wr),xe.deleteTexture(sr),er=Pr[0]===1),da.freeType(Pr)}}var Nr=typeof navigator!="undefined"&&(/MSIE/.test(navigator.userAgent)||/Trident\//.test(navigator.appVersion)||/Edge/.test(navigator.userAgent)),Dr=!0;if(!Nr){var Or=xe.createTexture(),qr=da.allocType(Ai,36);xe.activeTexture(Pl),xe.bindTexture(Ll,Or),xe.texImage2D(zi,0,Ro,3,3,0,Ro,Ai,qr),da.freeType(qr),xe.bindTexture(Ll,null),xe.deleteTexture(Or),Dr=!xe.getError()}return{colorBits:[xe.getParameter(Fs),xe.getParameter(no),xe.getParameter(ts),xe.getParameter(Oo)],depthBits:xe.getParameter(Ni),stencilBits:xe.getParameter(io),subpixelBits:xe.getParameter(Zi),extensions:Object.keys(Ke).filter(function(Tr){return!!Ke[Tr]}),maxAnisotropic:mt,maxDrawbuffers:nr,maxColorAttachments:Ar,pointSizeDims:xe.getParameter(bs),lineWidthDims:xe.getParameter(Wo),maxViewportDims:xe.getParameter(Sa),maxCombinedTextureUnits:xe.getParameter(Js),maxCubeMapSize:xe.getParameter(vn),maxRenderbufferSize:xe.getParameter(lo),maxTextureUnits:xe.getParameter(uu),maxTextureSize:xe.getParameter(Ru),maxAttributes:xe.getParameter(ya),maxVertexUniforms:xe.getParameter(Ku),maxVertexTextureUnits:xe.getParameter(Ca),maxVaryingVectors:xe.getParameter(uo),maxFragmentUniforms:xe.getParameter(Mr),glsl:xe.getParameter(Bs),renderer:xe.getParameter(tu),vendor:xe.getParameter(eu),version:xe.getParameter(Ss),readFloat:er,npotTextureCube:Dr}};function Ve(xe){return!!xe&&typeof xe=="object"&&Array.isArray(xe.shape)&&Array.isArray(xe.stride)&&typeof xe.offset=="number"&&xe.shape.length===xe.stride.length&&(Array.isArray(xe.data)||$(xe.data))}var Gt=function(xe){return Object.keys(xe).map(function(Ke){return xe[Ke]})},ce={shape:dn,flatten:Lr};function Be(xe,Ke,mt){for(var nr=0;nr<Ke;++nr)mt[nr]=xe[nr]}function Ye(xe,Ke,mt,nr){for(var Ar=0,er=0;er<Ke;++er)for(var sr=xe[er],wr=0;wr<mt;++wr)nr[Ar++]=sr[wr]}function zt(xe,Ke,mt,nr,Ar,er){for(var sr=er,wr=0;wr<Ke;++wr)for(var Pr=xe[wr],Nr=0;Nr<mt;++Nr)for(var Dr=Pr[Nr],Or=0;Or<nr;++Or)Ar[sr++]=Dr[Or]}function hr(xe,Ke,mt,nr,Ar){for(var er=1,sr=mt+1;sr<Ke.length;++sr)er*=Ke[sr];var wr=Ke[mt];if(Ke.length-mt===4){var Pr=Ke[mt+1],Nr=Ke[mt+2],Dr=Ke[mt+3];for(sr=0;sr<wr;++sr)zt(xe[sr],Pr,Nr,Dr,nr,Ar),Ar+=er}else for(sr=0;sr<wr;++sr)hr(xe[sr],Ke,mt+1,nr,Ar),Ar+=er}function Lr(xe,Ke,mt,nr){var Ar=1;if(Ke.length)for(var er=0;er<Ke.length;++er)Ar*=Ke[er];else Ar=0;var sr=nr||da.allocType(mt,Ar);switch(Ke.length){case 0:break;case 1:Be(xe,Ke[0],sr);break;case 2:Ye(xe,Ke[0],Ke[1],sr);break;case 3:zt(xe,Ke[0],Ke[1],Ke[2],sr,0);break;default:hr(xe,Ke,0,sr,0)}return sr}function dn(xe){for(var Ke=[],mt=xe;mt.length;mt=mt[0])Ke.push(mt.length);return Ke}var Mn={"[object Int8Array]":5120,"[object Int16Array]":5122,"[object Int32Array]":5124,"[object Uint8Array]":5121,"[object Uint8ClampedArray]":5121,"[object Uint16Array]":5123,"[object Uint32Array]":5125,"[object Float32Array]":5126,"[object Float64Array]":5121,"[object ArrayBuffer]":5121},vi=5120,co=5122,is=5124,ws=5121,Xc=5123,Zs=5125,ua=5126,Jl=5126,qa={int8:vi,int16:co,int32:is,uint8:ws,uint16:Xc,uint32:Zs,float:ua,float32:Jl},gf=35048,dl=35040,wa={dynamic:gf,stream:dl,static:35044},In=ce.flatten,Ju=ce.shape,zs=35044,lu=35040,cu=5121,xu=5126,ci=[];ci[5120]=1,ci[5122]=2,ci[5124]=4,ci[5121]=1,ci[5123]=2,ci[5125]=4,ci[5126]=4;function as(xe){return Mn[Object.prototype.toString.call(xe)]|0}function Ha(xe,Ke){for(var mt=0;mt<Ke.length;++mt)xe[mt]=Ke[mt]}function Ra(xe,Ke,mt,nr,Ar,er,sr){for(var wr=0,Pr=0;Pr<mt;++Pr)for(var Nr=0;Nr<nr;++Nr)xe[wr++]=Ke[Ar*Pr+er*Nr+sr]}function mo(xe,Ke,mt,nr){var Ar=0,er={};function sr(Vt){this.id=Ar++,this.buffer=xe.createBuffer(),this.type=Vt,this.usage=zs,this.byteLength=0,this.dimension=1,this.dtype=cu,this.persistentData=null,mt.profile&&(this.stats={size:0})}sr.prototype.bind=function(){xe.bindBuffer(this.type,this.buffer)},sr.prototype.destroy=function(){qr(this)};var wr=[];function Pr(Vt,lr){var Rr=wr.pop();return Rr||(Rr=new sr(Vt)),Rr.bind(),Or(Rr,lr,lu,0,1,!1),Rr}function Nr(Vt){wr.push(Vt)}function Dr(Vt,lr,Rr){Vt.byteLength=lr.byteLength,xe.bufferData(Vt.type,lr,Rr)}function Or(Vt,lr,Rr,tn,mr,cn){var Cr;if(Vt.usage=Rr,Array.isArray(lr)){if(Vt.dtype=tn||xu,lr.length>0){var Hr;if(Array.isArray(lr[0])){Cr=Ju(lr);for(var Er=1,Yr=1;Yr<Cr.length;++Yr)Er*=Cr[Yr];Vt.dimension=Er,Hr=In(lr,Cr,Vt.dtype),Dr(Vt,Hr,Rr),cn?Vt.persistentData=Hr:da.freeType(Hr)}else if(typeof lr[0]=="number"){Vt.dimension=mr;var Cn=da.allocType(Vt.dtype,lr.length);Ha(Cn,lr),Dr(Vt,Cn,Rr),cn?Vt.persistentData=Cn:da.freeType(Cn)}else $(lr[0])?(Vt.dimension=lr[0].length,Vt.dtype=tn||as(lr[0])||xu,Hr=In(lr,[lr.length,lr[0].length],Vt.dtype),Dr(Vt,Hr,Rr),cn?Vt.persistentData=Hr:da.freeType(Hr)):J.raise("invalid buffer data")}}else if($(lr))Vt.dtype=tn||as(lr),Vt.dimension=mr,Dr(Vt,lr,Rr),cn&&(Vt.persistentData=new Uint8Array(new Uint8Array(lr.buffer)));else if(Ve(lr)){Cr=lr.shape;var Xn=lr.stride,Ir=lr.offset,Fr=0,vr=0,On=0,Bn=0;Cr.length===1?(Fr=Cr[0],vr=1,On=Xn[0],Bn=0):Cr.length===2?(Fr=Cr[0],vr=Cr[1],On=Xn[0],Bn=Xn[1]):J.raise("invalid shape"),Vt.dtype=tn||as(lr.data)||xu,Vt.dimension=vr;var gn=da.allocType(Vt.dtype,Fr*vr);Ra(gn,lr.data,Fr,vr,On,Bn,Ir),Dr(Vt,gn,Rr),cn?Vt.persistentData=gn:da.freeType(gn)}else lr instanceof ArrayBuffer?(Vt.dtype=cu,Vt.dimension=mr,Dr(Vt,lr,Rr),cn&&(Vt.persistentData=new Uint8Array(new Uint8Array(lr)))):J.raise("invalid buffer data")}function qr(Vt){Ke.bufferCount--,nr(Vt);var lr=Vt.buffer;J(lr,"buffer must not be deleted already"),xe.deleteBuffer(lr),Vt.buffer=null,delete er[Vt.id]}function Tr(Vt,lr,Rr,tn){Ke.bufferCount++;var mr=new sr(lr);er[mr.id]=mr;function cn(Er){var Yr=zs,Cn=null,Xn=0,Ir=0,Fr=1;return Array.isArray(Er)||$(Er)||Ve(Er)||Er instanceof ArrayBuffer?Cn=Er:typeof Er=="number"?Xn=Er|0:Er&&(J.type(Er,"object","buffer arguments must be an object, a number or an array"),"data"in Er&&(J(Cn===null||Array.isArray(Cn)||$(Cn)||Ve(Cn),"invalid data for buffer"),Cn=Er.data),"usage"in Er&&(J.parameter(Er.usage,wa,"invalid buffer usage"),Yr=wa[Er.usage]),"type"in Er&&(J.parameter(Er.type,qa,"invalid buffer type"),Ir=qa[Er.type]),"dimension"in Er&&(J.type(Er.dimension,"number","invalid dimension"),Fr=Er.dimension|0),"length"in Er&&(J.nni(Xn,"buffer length must be a nonnegative integer"),Xn=Er.length|0)),mr.bind(),Cn?Or(mr,Cn,Yr,Ir,Fr,tn):(Xn&&xe.bufferData(mr.type,Xn,Yr),mr.dtype=Ir||cu,mr.usage=Yr,mr.dimension=Fr,mr.byteLength=Xn),mt.profile&&(mr.stats.size=mr.byteLength*ci[mr.dtype]),cn}function Cr(Er,Yr){J(Yr+Er.byteLength<=mr.byteLength,"invalid buffer subdata call, buffer is too small.  Can't write data of size "+Er.byteLength+" starting from offset "+Yr+" to a buffer of size "+mr.byteLength),xe.bufferSubData(mr.type,Yr,Er)}function Hr(Er,Yr){var Cn=(Yr||0)|0,Xn;if(mr.bind(),$(Er)||Er instanceof ArrayBuffer)Cr(Er,Cn);else if(Array.isArray(Er)){if(Er.length>0)if(typeof Er[0]=="number"){var Ir=da.allocType(mr.dtype,Er.length);Ha(Ir,Er),Cr(Ir,Cn),da.freeType(Ir)}else if(Array.isArray(Er[0])||$(Er[0])){Xn=Ju(Er);var Fr=In(Er,Xn,mr.dtype);Cr(Fr,Cn),da.freeType(Fr)}else J.raise("invalid buffer data")}else if(Ve(Er)){Xn=Er.shape;var vr=Er.stride,On=0,Bn=0,gn=0,xi=0;Xn.length===1?(On=Xn[0],Bn=1,gn=vr[0],xi=0):Xn.length===2?(On=Xn[0],Bn=Xn[1],gn=vr[0],xi=vr[1]):J.raise("invalid shape");var Jn=Array.isArray(Er.data)?mr.dtype:as(Er.data),yi=da.allocType(Jn,On*Bn);Ra(yi,Er.data,On,Bn,gn,xi,Er.offset),Cr(yi,Cn),da.freeType(yi)}else J.raise("invalid data for buffer subdata");return cn}return Rr||cn(Vt),cn._reglType="buffer",cn._buffer=mr,cn.subdata=Hr,mt.profile&&(cn.stats=mr.stats),cn.destroy=function(){qr(mr)},cn}function Zr(){Gt(er).forEach(function(Vt){Vt.buffer=xe.createBuffer(),xe.bindBuffer(Vt.type,Vt.buffer),xe.bufferData(Vt.type,Vt.persistentData||Vt.byteLength,Vt.usage)})}return mt.profile&&(Ke.getTotalBufferSize=function(){var Vt=0;return Object.keys(er).forEach(function(lr){Vt+=er[lr].stats.size}),Vt}),{create:Tr,createStream:Pr,destroyStream:Nr,clear:function(){Gt(er).forEach(qr),wr.forEach(qr)},getBuffer:function(Vt){return Vt&&Vt._buffer instanceof sr?Vt._buffer:null},restore:Zr,_initBuffer:Or}}var fu=0,mf=0,Ol=1,Qc=1,kf=4,Yo=4,Us={points:fu,point:mf,lines:Ol,line:Qc,triangles:kf,triangle:Yo,"line loop":2,"line strip":3,"triangle strip":5,"triangle fan":6},ko=0,la=1,os=4,Rl=5120,Ta=5121,Sn=5122,vl=5123,ec=5124,Ka=5125,hs=34963,gl=35040,vc=35044;function gc(xe,Ke,mt,nr){var Ar={},er=0,sr={uint8:Ta,uint16:vl};Ke.oes_element_index_uint&&(sr.uint32=Ka);function wr(Zr){this.id=er++,Ar[this.id]=this,this.buffer=Zr,this.primType=os,this.vertCount=0,this.type=0}wr.prototype.bind=function(){this.buffer.bind()};var Pr=[];function Nr(Zr){var Vt=Pr.pop();return Vt||(Vt=new wr(mt.create(null,hs,!0,!1)._buffer)),Or(Vt,Zr,gl,-1,-1,0,0),Vt}function Dr(Zr){Pr.push(Zr)}function Or(Zr,Vt,lr,Rr,tn,mr,cn){Zr.buffer.bind();var Cr;if(Vt){var Hr=cn;!cn&&(!$(Vt)||Ve(Vt)&&!$(Vt.data))&&(Hr=Ke.oes_element_index_uint?Ka:vl),mt._initBuffer(Zr.buffer,Vt,lr,Hr,3)}else xe.bufferData(hs,mr,lr),Zr.buffer.dtype=Cr||Ta,Zr.buffer.usage=lr,Zr.buffer.dimension=3,Zr.buffer.byteLength=mr;if(Cr=cn,!cn){switch(Zr.buffer.dtype){case Ta:case Rl:Cr=Ta;break;case vl:case Sn:Cr=vl;break;case Ka:case ec:Cr=Ka;break;default:J.raise("unsupported type for element array")}Zr.buffer.dtype=Cr}Zr.type=Cr,J(Cr!==Ka||!!Ke.oes_element_index_uint,"32 bit element buffers not supported, enable oes_element_index_uint first");var Er=tn;Er<0&&(Er=Zr.buffer.byteLength,Cr===vl?Er>>=1:Cr===Ka&&(Er>>=2)),Zr.vertCount=Er;var Yr=Rr;if(Rr<0){Yr=os;var Cn=Zr.buffer.dimension;Cn===1&&(Yr=ko),Cn===2&&(Yr=la),Cn===3&&(Yr=os)}Zr.primType=Yr}function qr(Zr){nr.elementsCount--,J(Zr.buffer!==null,"must not double destroy elements"),delete Ar[Zr.id],Zr.buffer.destroy(),Zr.buffer=null}function Tr(Zr,Vt){var lr=mt.create(null,hs,!0),Rr=new wr(lr._buffer);nr.elementsCount++;function tn(mr){if(!mr)lr(),Rr.primType=os,Rr.vertCount=0,Rr.type=Ta;else if(typeof mr=="number")lr(mr),Rr.primType=os,Rr.vertCount=mr|0,Rr.type=Ta;else{var cn=null,Cr=vc,Hr=-1,Er=-1,Yr=0,Cn=0;Array.isArray(mr)||$(mr)||Ve(mr)?cn=mr:(J.type(mr,"object","invalid arguments for elements"),"data"in mr&&(cn=mr.data,J(Array.isArray(cn)||$(cn)||Ve(cn),"invalid data for element buffer")),"usage"in mr&&(J.parameter(mr.usage,wa,"invalid element buffer usage"),Cr=wa[mr.usage]),"primitive"in mr&&(J.parameter(mr.primitive,Us,"invalid element buffer primitive"),Hr=Us[mr.primitive]),"count"in mr&&(J(typeof mr.count=="number"&&mr.count>=0,"invalid vertex count for elements"),Er=mr.count|0),"type"in mr&&(J.parameter(mr.type,sr,"invalid buffer type"),Cn=sr[mr.type]),"length"in mr?Yr=mr.length|0:(Yr=Er,Cn===vl||Cn===Sn?Yr*=2:(Cn===Ka||Cn===ec)&&(Yr*=4))),Or(Rr,cn,Cr,Hr,Er,Yr,Cn)}return tn}return tn(Zr),tn._reglType="elements",tn._elements=Rr,tn.subdata=function(mr,cn){return lr.subdata(mr,cn),tn},tn.destroy=function(){qr(Rr)},tn}return{create:Tr,createStream:Nr,destroyStream:Dr,getElements:function(Zr){return typeof Zr=="function"&&Zr._elements instanceof wr?Zr._elements:null},clear:function(){Gt(Ar).forEach(qr)}}}var yf=new Float32Array(1),ea=new Uint32Array(yf.buffer),Du=5123;function na(xe){for(var Ke=da.allocType(Du,xe.length),mt=0;mt<xe.length;++mt)if(isNaN(xe[mt]))Ke[mt]=65535;else if(xe[mt]===1/0)Ke[mt]=31744;else if(xe[mt]===-1/0)Ke[mt]=64512;else{yf[0]=xe[mt];var nr=ea[0],Ar=nr>>>31<<15,er=(nr<<1>>>24)-127,sr=nr>>13&1024-1;if(er<-24)Ke[mt]=Ar;else if(er<-14){var wr=-14-er;Ke[mt]=Ar+(sr+1024>>wr)}else er>15?Ke[mt]=Ar+31744:Ke[mt]=Ar+(er+15<<10)+sr}return Ke}function Za(xe){return Array.isArray(xe)||$(xe)}var Do=function(xe){return!(xe&xe-1)&&!!xe},n0=34467,fi=3553,As=34067,ia=34069,Ts=6408,_a=6406,ps=6407,ml=6409,ru=6410,Mi=32854,ss=32855,nu=36194,No=32819,ds=32820,Fo=33635,i0=34042,tc=6402,va=34041,Bo=35904,Ms=35906,fo=36193,Xo=33776,hu=33777,Au=33778,zr=33779,Ja=35986,mc=35987,kl=34798,yo=35840,Nu=35841,Eu=35842,qc=35843,vs=36196,Is=5121,Dl=5123,el=5125,Kc=5126,Df=10242,yl=10243,bu=10497,wo=33071,_l=33648,Zo=10240,Su=10241,Fu=9728,Jc=9729,xl=9984,Bu=9985,pu=9986,_o=9987,Cu=33170,ho=4352,a0=4353,tl=4354,rc=34046,zo=3317,Qo=37440,Gs=37441,js=37443,yc=37444,Ls=33984,El=[xl,pu,Bu,_o],To=[0,ml,ru,ps,Ts],Vs={};Vs[ml]=Vs[_a]=Vs[tc]=1,Vs[va]=Vs[ru]=2,Vs[ps]=Vs[Bo]=3,Vs[Ts]=Vs[Ms]=4;function Va(xe){return"[object "+xe+"]"}var ur=Va("HTMLCanvasElement"),bt=Va("OffscreenCanvas"),Ce=Va("CanvasRenderingContext2D"),Hs=Va("ImageBitmap"),nt=Va("HTMLImageElement"),rl=Va("HTMLVideoElement"),xa=Object.keys(Mn).concat([ur,bt,Ce,Hs,nt,rl]),$s=[];$s[Is]=1,$s[Kc]=4,$s[fo]=2,$s[Dl]=2,$s[el]=4;var ai=[];ai[Mi]=2,ai[ss]=2,ai[nu]=2,ai[va]=4,ai[Xo]=.5,ai[hu]=.5,ai[Au]=1,ai[zr]=1,ai[Ja]=.5,ai[mc]=1,ai[kl]=1,ai[yo]=.5,ai[Nu]=.25,ai[Eu]=.5,ai[qc]=.25,ai[vs]=.5;function ca(xe){return Array.isArray(xe)&&(xe.length===0||typeof xe[0]=="number")}function bi(xe){if(!Array.isArray(xe))return!1;var Ke=xe.length;return!(Ke===0||!Za(xe[0]))}function $a(xe){return Object.prototype.toString.call(xe)}function Ii(xe){return $a(xe)===ur}function Hn(xe){return $a(xe)===bt}function mi(xe){return $a(xe)===Ce}function Wi(xe){return $a(xe)===Hs}function _i(xe){return $a(xe)===nt}function di(xe){return $a(xe)===rl}function wn(xe){if(!xe)return!1;var Ke=$a(xe);return xa.indexOf(Ke)>=0?!0:ca(xe)||bi(xe)||Ve(xe)}function Yn(xe){return Mn[Object.prototype.toString.call(xe)]|0}function Li(xe,Ke){var mt=Ke.length;switch(xe.type){case Is:case Dl:case el:case Kc:var nr=da.allocType(xe.type,mt);nr.set(Ke),xe.data=nr;break;case fo:xe.data=na(Ke);break;default:J.raise("unsupported texture type, must specify a typed array")}}function qn(xe,Ke){return da.allocType(xe.type===fo?Kc:xe.type,Ke)}function Ui(xe,Ke){xe.type===fo?(xe.data=na(Ke),da.freeType(Ke)):xe.data=Ke}function Gi(xe,Ke,mt,nr,Ar,er){for(var sr=xe.width,wr=xe.height,Pr=xe.channels,Nr=sr*wr*Pr,Dr=qn(xe,Nr),Or=0,qr=0;qr<wr;++qr)for(var Tr=0;Tr<sr;++Tr)for(var Zr=0;Zr<Pr;++Zr)Dr[Or++]=Ke[mt*Tr+nr*qr+Ar*Zr+er];Ui(xe,Dr)}function Nn(xe,Ke,mt,nr,Ar,er){var sr;if(typeof ai[xe]!="undefined"?sr=ai[xe]:sr=Vs[xe]*$s[Ke],er&&(sr*=6),Ar){for(var wr=0,Pr=mt;Pr>=1;)wr+=sr*Pr*Pr,Pr/=2;return wr}else return sr*mt*nr}function Yi(xe,Ke,mt,nr,Ar,er,sr){var wr={"don't care":ho,"dont care":ho,nice:tl,fast:a0},Pr={repeat:bu,clamp:wo,mirror:_l},Nr={nearest:Fu,linear:Jc},Dr=C({mipmap:_o,"nearest mipmap nearest":xl,"linear mipmap nearest":Bu,"nearest mipmap linear":pu,"linear mipmap linear":_o},Nr),Or={none:0,browser:yc},qr={uint8:Is,rgba4:No,rgb565:Fo,"rgb5 a1":ds},Tr={alpha:_a,luminance:ml,"luminance alpha":ru,rgb:ps,rgba:Ts,rgba4:Mi,"rgb5 a1":ss,rgb565:nu},Zr={};Ke.ext_srgb&&(Tr.srgb=Bo,Tr.srgba=Ms),Ke.oes_texture_float&&(qr.float32=qr.float=Kc),Ke.oes_texture_half_float&&(qr.float16=qr["half float"]=fo),Ke.webgl_depth_texture&&(C(Tr,{depth:tc,"depth stencil":va}),C(qr,{uint16:Dl,uint32:el,"depth stencil":i0})),Ke.webgl_compressed_texture_s3tc&&C(Zr,{"rgb s3tc dxt1":Xo,"rgba s3tc dxt1":hu,"rgba s3tc dxt3":Au,"rgba s3tc dxt5":zr}),Ke.webgl_compressed_texture_atc&&C(Zr,{"rgb atc":Ja,"rgba atc explicit alpha":mc,"rgba atc interpolated alpha":kl}),Ke.webgl_compressed_texture_pvrtc&&C(Zr,{"rgb pvrtc 4bppv1":yo,"rgb pvrtc 2bppv1":Nu,"rgba pvrtc 4bppv1":Eu,"rgba pvrtc 2bppv1":qc}),Ke.webgl_compressed_texture_etc1&&(Zr["rgb etc1"]=vs);var Vt=Array.prototype.slice.call(xe.getParameter(n0));Object.keys(Zr).forEach(function(ct){var ft=Zr[ct];Vt.indexOf(ft)>=0&&(Tr[ct]=ft)});var lr=Object.keys(Tr);mt.textureFormats=lr;var Rr=[];Object.keys(Tr).forEach(function(ct){var ft=Tr[ct];Rr[ft]=ct});var tn=[];Object.keys(qr).forEach(function(ct){var ft=qr[ct];tn[ft]=ct});var mr=[];Object.keys(Nr).forEach(function(ct){var ft=Nr[ct];mr[ft]=ct});var cn=[];Object.keys(Dr).forEach(function(ct){var ft=Dr[ct];cn[ft]=ct});var Cr=[];Object.keys(Pr).forEach(function(ct){var ft=Pr[ct];Cr[ft]=ct});var Hr=lr.reduce(function(ct,ft){var xt=Tr[ft];return xt===ml||xt===_a||xt===ml||xt===ru||xt===tc||xt===va||Ke.ext_srgb&&(xt===Bo||xt===Ms)?ct[xt]=xt:xt===ss||ft.indexOf("rgba")>=0?ct[xt]=Ts:ct[xt]=ps,ct},{});function Er(){this.internalformat=Ts,this.format=Ts,this.type=Is,this.compressed=!1,this.premultiplyAlpha=!1,this.flipY=!1,this.unpackAlignment=1,this.colorSpace=yc,this.width=0,this.height=0,this.channels=0}function Yr(ct,ft){ct.internalformat=ft.internalformat,ct.format=ft.format,ct.type=ft.type,ct.compressed=ft.compressed,ct.premultiplyAlpha=ft.premultiplyAlpha,ct.flipY=ft.flipY,ct.unpackAlignment=ft.unpackAlignment,ct.colorSpace=ft.colorSpace,ct.width=ft.width,ct.height=ft.height,ct.channels=ft.channels}function Cn(ct,ft){if(!(typeof ft!="object"||!ft)){if("premultiplyAlpha"in ft&&(J.type(ft.premultiplyAlpha,"boolean","invalid premultiplyAlpha"),ct.premultiplyAlpha=ft.premultiplyAlpha),"flipY"in ft&&(J.type(ft.flipY,"boolean","invalid texture flip"),ct.flipY=ft.flipY),"alignment"in ft&&(J.oneOf(ft.alignment,[1,2,4,8],"invalid texture unpack alignment"),ct.unpackAlignment=ft.alignment),"colorSpace"in ft&&(J.parameter(ft.colorSpace,Or,"invalid colorSpace"),ct.colorSpace=Or[ft.colorSpace]),"type"in ft){var xt=ft.type;J(Ke.oes_texture_float||!(xt==="float"||xt==="float32"),"you must enable the OES_texture_float extension in order to use floating point textures."),J(Ke.oes_texture_half_float||!(xt==="half float"||xt==="float16"),"you must enable the OES_texture_half_float extension in order to use 16-bit floating point textures."),J(Ke.webgl_depth_texture||!(xt==="uint16"||xt==="uint32"||xt==="depth stencil"),"you must enable the WEBGL_depth_texture extension in order to use depth/stencil textures."),J.parameter(xt,qr,"invalid texture type"),ct.type=qr[xt]}var Ur=ct.width,Un=ct.height,at=ct.channels,We=!1;"shape"in ft?(J(Array.isArray(ft.shape)&&ft.shape.length>=2,"shape must be an array"),Ur=ft.shape[0],Un=ft.shape[1],ft.shape.length===3&&(at=ft.shape[2],J(at>0&&at<=4,"invalid number of channels"),We=!0),J(Ur>=0&&Ur<=mt.maxTextureSize,"invalid width"),J(Un>=0&&Un<=mt.maxTextureSize,"invalid height")):("radius"in ft&&(Ur=Un=ft.radius,J(Ur>=0&&Ur<=mt.maxTextureSize,"invalid radius")),"width"in ft&&(Ur=ft.width,J(Ur>=0&&Ur<=mt.maxTextureSize,"invalid width")),"height"in ft&&(Un=ft.height,J(Un>=0&&Un<=mt.maxTextureSize,"invalid height")),"channels"in ft&&(at=ft.channels,J(at>0&&at<=4,"invalid number of channels"),We=!0)),ct.width=Ur|0,ct.height=Un|0,ct.channels=at|0;var St=!1;if("format"in ft){var kt=ft.format;J(Ke.webgl_depth_texture||!(kt==="depth"||kt==="depth stencil"),"you must enable the WEBGL_depth_texture extension in order to use depth/stencil textures."),J.parameter(kt,Tr,"invalid texture format");var Ft=ct.internalformat=Tr[kt];ct.format=Hr[Ft],kt in qr&&("type"in ft||(ct.type=qr[kt])),kt in Zr&&(ct.compressed=!0),St=!0}!We&&St?ct.channels=Vs[ct.format]:We&&!St?ct.channels!==To[ct.format]&&(ct.format=ct.internalformat=To[ct.channels]):St&&We&&J(ct.channels===Vs[ct.format],"number of channels inconsistent with specified format")}}function Xn(ct){xe.pixelStorei(Qo,ct.flipY),xe.pixelStorei(Gs,ct.premultiplyAlpha),xe.pixelStorei(js,ct.colorSpace),xe.pixelStorei(zo,ct.unpackAlignment)}function Ir(){Er.call(this),this.xOffset=0,this.yOffset=0,this.data=null,this.needsFree=!1,this.element=null,this.needsCopy=!1}function Fr(ct,ft){var xt=null;if(wn(ft)?xt=ft:ft&&(J.type(ft,"object","invalid pixel data type"),Cn(ct,ft),"x"in ft&&(ct.xOffset=ft.x|0),"y"in ft&&(ct.yOffset=ft.y|0),wn(ft.data)&&(xt=ft.data)),J(!ct.compressed||xt instanceof Uint8Array,"compressed texture data must be stored in a uint8array"),ft.copy){J(!xt,"can not specify copy and data field for the same texture");var Ur=Ar.viewportWidth,Un=Ar.viewportHeight;ct.width=ct.width||Ur-ct.xOffset,ct.height=ct.height||Un-ct.yOffset,ct.needsCopy=!0,J(ct.xOffset>=0&&ct.xOffset<Ur&&ct.yOffset>=0&&ct.yOffset<Un&&ct.width>0&&ct.width<=Ur&&ct.height>0&&ct.height<=Un,"copy texture read out of bounds")}else if(!xt)ct.width=ct.width||1,ct.height=ct.height||1,ct.channels=ct.channels||4;else if($(xt))ct.channels=ct.channels||4,ct.data=xt,!("type"in ft)&&ct.type===Is&&(ct.type=Yn(xt));else if(ca(xt))ct.channels=ct.channels||4,Li(ct,xt),ct.alignment=1,ct.needsFree=!0;else if(Ve(xt)){var at=xt.data;!Array.isArray(at)&&ct.type===Is&&(ct.type=Yn(at));var We=xt.shape,St=xt.stride,kt,Ft,h,c,p,m;We.length===3?(h=We[2],m=St[2]):(J(We.length===2,"invalid ndarray pixel data, must be 2 or 3D"),h=1,m=1),kt=We[0],Ft=We[1],c=St[0],p=St[1],ct.alignment=1,ct.width=kt,ct.height=Ft,ct.channels=h,ct.format=ct.internalformat=To[h],ct.needsFree=!0,Gi(ct,at,c,p,m,xt.offset)}else if(Ii(xt)||Hn(xt)||mi(xt))Ii(xt)||Hn(xt)?ct.element=xt:ct.element=xt.canvas,ct.width=ct.element.width,ct.height=ct.element.height,ct.channels=4;else if(Wi(xt))ct.element=xt,ct.width=xt.width,ct.height=xt.height,ct.channels=4;else if(_i(xt))ct.element=xt,ct.width=xt.naturalWidth,ct.height=xt.naturalHeight,ct.channels=4;else if(di(xt))ct.element=xt,ct.width=xt.videoWidth,ct.height=xt.videoHeight,ct.channels=4;else if(bi(xt)){var E=ct.width||xt[0].length,S=ct.height||xt.length,M=ct.channels;Za(xt[0][0])?M=M||xt[0][0].length:M=M||1;for(var k=ce.shape(xt),V=1,te=0;te<k.length;++te)V*=k[te];var ve=qn(ct,V);ce.flatten(xt,k,"",ve),Ui(ct,ve),ct.alignment=1,ct.width=E,ct.height=S,ct.channels=M,ct.format=ct.internalformat=To[M],ct.needsFree=!0}ct.type===Kc?J(mt.extensions.indexOf("oes_texture_float")>=0,"oes_texture_float extension not enabled"):ct.type===fo&&J(mt.extensions.indexOf("oes_texture_half_float")>=0,"oes_texture_half_float extension not enabled")}function vr(ct,ft,xt){var Ur=ct.element,Un=ct.data,at=ct.internalformat,We=ct.format,St=ct.type,kt=ct.width,Ft=ct.height;Xn(ct),Ur?xe.texImage2D(ft,xt,We,We,St,Ur):ct.compressed?xe.compressedTexImage2D(ft,xt,at,kt,Ft,0,Un):ct.needsCopy?(nr(),xe.copyTexImage2D(ft,xt,We,ct.xOffset,ct.yOffset,kt,Ft,0)):xe.texImage2D(ft,xt,We,kt,Ft,0,We,St,Un||null)}function On(ct,ft,xt,Ur,Un){var at=ct.element,We=ct.data,St=ct.internalformat,kt=ct.format,Ft=ct.type,h=ct.width,c=ct.height;Xn(ct),at?xe.texSubImage2D(ft,Un,xt,Ur,kt,Ft,at):ct.compressed?xe.compressedTexSubImage2D(ft,Un,xt,Ur,St,h,c,We):ct.needsCopy?(nr(),xe.copyTexSubImage2D(ft,Un,xt,Ur,ct.xOffset,ct.yOffset,h,c)):xe.texSubImage2D(ft,Un,xt,Ur,h,c,kt,Ft,We)}var Bn=[];function gn(){return Bn.pop()||new Ir}function xi(ct){ct.needsFree&&da.freeType(ct.data),Ir.call(ct),Bn.push(ct)}function Jn(){Er.call(this),this.genMipmaps=!1,this.mipmapHint=ho,this.mipmask=0,this.images=Array(16)}function yi(ct,ft,xt){var Ur=ct.images[0]=gn();ct.mipmask=1,Ur.width=ct.width=ft,Ur.height=ct.height=xt,Ur.channels=ct.channels=4}function ta(ct,ft){var xt=null;if(wn(ft))xt=ct.images[0]=gn(),Yr(xt,ct),Fr(xt,ft),ct.mipmask=1;else if(Cn(ct,ft),Array.isArray(ft.mipmap))for(var Ur=ft.mipmap,Un=0;Un<Ur.length;++Un)xt=ct.images[Un]=gn(),Yr(xt,ct),xt.width>>=Un,xt.height>>=Un,Fr(xt,Ur[Un]),ct.mipmask|=1<<Un;else xt=ct.images[0]=gn(),Yr(xt,ct),Fr(xt,ft),ct.mipmask=1;Yr(ct,ct.images[0]),ct.compressed&&(ct.internalformat===Xo||ct.internalformat===hu||ct.internalformat===Au||ct.internalformat===zr)&&J(ct.width%4===0&&ct.height%4===0,"for compressed texture formats, mipmap level 0 must have width and height that are a multiple of 4")}function bo(ct,ft){for(var xt=ct.images,Ur=0;Ur<xt.length;++Ur){if(!xt[Ur])return;vr(xt[Ur],ft,Ur)}}var ro=[];function Ti(){var ct=ro.pop()||new Jn;Er.call(ct),ct.mipmask=0;for(var ft=0;ft<16;++ft)ct.images[ft]=null;return ct}function Io(ct){for(var ft=ct.images,xt=0;xt<ft.length;++xt)ft[xt]&&xi(ft[xt]),ft[xt]=null;ro.push(ct)}function Na(){this.minFilter=Fu,this.magFilter=Fu,this.wrapS=wo,this.wrapT=wo,this.anisotropic=1,this.genMipmaps=!1,this.mipmapHint=ho}function Ao(ct,ft){if("min"in ft){var xt=ft.min;J.parameter(xt,Dr),ct.minFilter=Dr[xt],El.indexOf(ct.minFilter)>=0&&!("faces"in ft)&&(ct.genMipmaps=!0)}if("mag"in ft){var Ur=ft.mag;J.parameter(Ur,Nr),ct.magFilter=Nr[Ur]}var Un=ct.wrapS,at=ct.wrapT;if("wrap"in ft){var We=ft.wrap;typeof We=="string"?(J.parameter(We,Pr),Un=at=Pr[We]):Array.isArray(We)&&(J.parameter(We[0],Pr),J.parameter(We[1],Pr),Un=Pr[We[0]],at=Pr[We[1]])}else{if("wrapS"in ft){var St=ft.wrapS;J.parameter(St,Pr),Un=Pr[St]}if("wrapT"in ft){var kt=ft.wrapT;J.parameter(kt,Pr),at=Pr[kt]}}if(ct.wrapS=Un,ct.wrapT=at,"anisotropic"in ft){var Ft=ft.anisotropic;J(typeof Ft=="number"&&Ft>=1&&Ft<=mt.maxAnisotropic,"aniso samples must be between 1 and "),ct.anisotropic=ft.anisotropic}if("mipmap"in ft){var h=!1;switch(typeof ft.mipmap){case"string":J.parameter(ft.mipmap,wr,"invalid mipmap hint"),ct.mipmapHint=wr[ft.mipmap],ct.genMipmaps=!0,h=!0;break;case"boolean":h=ct.genMipmaps=ft.mipmap;break;case"object":J(Array.isArray(ft.mipmap),"invalid mipmap type"),ct.genMipmaps=!1,h=!0;break;default:J.raise("invalid mipmap type")}h&&!("min"in ft)&&(ct.minFilter=xl)}}function jo(ct,ft){xe.texParameteri(ft,Su,ct.minFilter),xe.texParameteri(ft,Zo,ct.magFilter),xe.texParameteri(ft,Df,ct.wrapS),xe.texParameteri(ft,yl,ct.wrapT),Ke.ext_texture_filter_anisotropic&&xe.texParameteri(ft,rc,ct.anisotropic),ct.genMipmaps&&(xe.hint(Cu,ct.mipmapHint),xe.generateMipmap(ft))}var Fa=0,Ua={},Tn=mt.maxTextureUnits,ga=Array(Tn).map(function(){return null});function un(ct){Er.call(this),this.mipmask=0,this.internalformat=Ts,this.id=Fa++,this.refCount=1,this.target=ct,this.texture=xe.createTexture(),this.unit=-1,this.bindCount=0,this.texInfo=new Na,sr.profile&&(this.stats={size:0})}function Aa(ct){xe.activeTexture(Ls),xe.bindTexture(ct.target,ct.texture)}function ra(){var ct=ga[0];ct?xe.bindTexture(ct.target,ct.texture):xe.bindTexture(fi,null)}function Rn(ct){var ft=ct.texture;J(ft,"must not double destroy texture");var xt=ct.unit,Ur=ct.target;xt>=0&&(xe.activeTexture(Ls+xt),xe.bindTexture(Ur,null),ga[xt]=null),xe.deleteTexture(ft),ct.texture=null,ct.params=null,ct.pixels=null,ct.refCount=0,delete Ua[ct.id],er.textureCount--}C(un.prototype,{bind:function(){var ct=this;ct.bindCount+=1;var ft=ct.unit;if(ft<0){for(var xt=0;xt<Tn;++xt){var Ur=ga[xt];if(Ur){if(Ur.bindCount>0)continue;Ur.unit=-1}ga[xt]=ct,ft=xt;break}ft>=Tn&&J.raise("insufficient number of texture units"),sr.profile&&er.maxTextureUnits<ft+1&&(er.maxTextureUnits=ft+1),ct.unit=ft,xe.activeTexture(Ls+ft),xe.bindTexture(ct.target,ct.texture)}return ft},unbind:function(){this.bindCount-=1},decRef:function(){--this.refCount<=0&&Rn(this)}});function gi(ct,ft){var xt=new un(fi);Ua[xt.id]=xt,er.textureCount++;function Ur(We,St){var kt=xt.texInfo;Na.call(kt);var Ft=Ti();return typeof We=="number"?typeof St=="number"?yi(Ft,We|0,St|0):yi(Ft,We|0,We|0):We?(J.type(We,"object","invalid arguments to regl.texture"),Ao(kt,We),ta(Ft,We)):yi(Ft,1,1),kt.genMipmaps&&(Ft.mipmask=(Ft.width<<1)-1),xt.mipmask=Ft.mipmask,Yr(xt,Ft),J.texture2D(kt,Ft,mt),xt.internalformat=Ft.internalformat,Ur.width=Ft.width,Ur.height=Ft.height,Aa(xt),bo(Ft,fi),jo(kt,fi),ra(),Io(Ft),sr.profile&&(xt.stats.size=Nn(xt.internalformat,xt.type,Ft.width,Ft.height,kt.genMipmaps,!1)),Ur.format=Rr[xt.internalformat],Ur.type=tn[xt.type],Ur.mag=mr[kt.magFilter],Ur.min=cn[kt.minFilter],Ur.wrapS=Cr[kt.wrapS],Ur.wrapT=Cr[kt.wrapT],Ur}function Un(We,St,kt,Ft){J(!!We,"must specify image data");var h=St|0,c=kt|0,p=Ft|0,m=gn();return Yr(m,xt),m.width=0,m.height=0,Fr(m,We),m.width=m.width||(xt.width>>p)-h,m.height=m.height||(xt.height>>p)-c,J(xt.type===m.type&&xt.format===m.format&&xt.internalformat===m.internalformat,"incompatible format for texture.subimage"),J(h>=0&&c>=0&&h+m.width<=xt.width&&c+m.height<=xt.height,"texture.subimage write out of bounds"),J(xt.mipmask&1<<p,"missing mipmap data"),J(m.data||m.element||m.needsCopy,"missing image data"),Aa(xt),On(m,fi,h,c,p),ra(),xi(m),Ur}function at(We,St){var kt=We|0,Ft=St|0||kt;if(kt===xt.width&&Ft===xt.height)return Ur;Ur.width=xt.width=kt,Ur.height=xt.height=Ft,Aa(xt);for(var h=0;xt.mipmask>>h;++h){var c=kt>>h,p=Ft>>h;if(!c||!p)break;xe.texImage2D(fi,h,xt.format,c,p,0,xt.format,xt.type,null)}return ra(),sr.profile&&(xt.stats.size=Nn(xt.internalformat,xt.type,kt,Ft,!1,!1)),Ur}return Ur(ct,ft),Ur.subimage=Un,Ur.resize=at,Ur._reglType="texture2d",Ur._texture=xt,sr.profile&&(Ur.stats=xt.stats),Ur.destroy=function(){xt.decRef()},Ur}function dr(ct,ft,xt,Ur,Un,at){var We=new un(As);Ua[We.id]=We,er.cubeCount++;var St=new Array(6);function kt(c,p,m,E,S,M){var k,V=We.texInfo;for(Na.call(V),k=0;k<6;++k)St[k]=Ti();if(typeof c=="number"||!c){var te=c|0||1;for(k=0;k<6;++k)yi(St[k],te,te)}else if(typeof c=="object")if(p)ta(St[0],c),ta(St[1],p),ta(St[2],m),ta(St[3],E),ta(St[4],S),ta(St[5],M);else if(Ao(V,c),Cn(We,c),"faces"in c){var ve=c.faces;for(J(Array.isArray(ve)&&ve.length===6,"cube faces must be a length 6 array"),k=0;k<6;++k)J(typeof ve[k]=="object"&&!!ve[k],"invalid input for cube map face"),Yr(St[k],We),ta(St[k],ve[k])}else for(k=0;k<6;++k)ta(St[k],c);else J.raise("invalid arguments to cube map");for(Yr(We,St[0]),mt.npotTextureCube||J(Do(We.width)&&Do(We.height),"your browser does not support non power or two texture dimensions"),V.genMipmaps?We.mipmask=(St[0].width<<1)-1:We.mipmask=St[0].mipmask,J.textureCube(We,V,St,mt),We.internalformat=St[0].internalformat,kt.width=St[0].width,kt.height=St[0].height,Aa(We),k=0;k<6;++k)bo(St[k],ia+k);for(jo(V,As),ra(),sr.profile&&(We.stats.size=Nn(We.internalformat,We.type,kt.width,kt.height,V.genMipmaps,!0)),kt.format=Rr[We.internalformat],kt.type=tn[We.type],kt.mag=mr[V.magFilter],kt.min=cn[V.minFilter],kt.wrapS=Cr[V.wrapS],kt.wrapT=Cr[V.wrapT],k=0;k<6;++k)Io(St[k]);return kt}function Ft(c,p,m,E,S){J(!!p,"must specify image data"),J(typeof c=="number"&&c===(c|0)&&c>=0&&c<6,"invalid face");var M=m|0,k=E|0,V=S|0,te=gn();return Yr(te,We),te.width=0,te.height=0,Fr(te,p),te.width=te.width||(We.width>>V)-M,te.height=te.height||(We.height>>V)-k,J(We.type===te.type&&We.format===te.format&&We.internalformat===te.internalformat,"incompatible format for texture.subimage"),J(M>=0&&k>=0&&M+te.width<=We.width&&k+te.height<=We.height,"texture.subimage write out of bounds"),J(We.mipmask&1<<V,"missing mipmap data"),J(te.data||te.element||te.needsCopy,"missing image data"),Aa(We),On(te,ia+c,M,k,V),ra(),xi(te),kt}function h(c){var p=c|0;if(p!==We.width){kt.width=We.width=p,kt.height=We.height=p,Aa(We);for(var m=0;m<6;++m)for(var E=0;We.mipmask>>E;++E)xe.texImage2D(ia+m,E,We.format,p>>E,p>>E,0,We.format,We.type,null);return ra(),sr.profile&&(We.stats.size=Nn(We.internalformat,We.type,kt.width,kt.height,!1,!0)),kt}}return kt(ct,ft,xt,Ur,Un,at),kt.subimage=Ft,kt.resize=h,kt._reglType="textureCube",kt._texture=We,sr.profile&&(kt.stats=We.stats),kt.destroy=function(){We.decRef()},kt}function Ri(){for(var ct=0;ct<Tn;++ct)xe.activeTexture(Ls+ct),xe.bindTexture(fi,null),ga[ct]=null;Gt(Ua).forEach(Rn),er.cubeCount=0,er.textureCount=0}sr.profile&&(er.getTotalTextureSize=function(){var ct=0;return Object.keys(Ua).forEach(function(ft){ct+=Ua[ft].stats.size}),ct});function Xt(){for(var ct=0;ct<Tn;++ct){var ft=ga[ct];ft&&(ft.bindCount=0,ft.unit=-1,ga[ct]=null)}Gt(Ua).forEach(function(xt){xt.texture=xe.createTexture(),xe.bindTexture(xt.target,xt.texture);for(var Ur=0;Ur<32;++Ur)if(xt.mipmask&1<<Ur)if(xt.target===fi)xe.texImage2D(fi,Ur,xt.internalformat,xt.width>>Ur,xt.height>>Ur,0,xt.internalformat,xt.type,null);else for(var Un=0;Un<6;++Un)xe.texImage2D(ia+Un,Ur,xt.internalformat,xt.width>>Ur,xt.height>>Ur,0,xt.internalformat,xt.type,null);jo(xt.texInfo,xt.target)})}function es(){for(var ct=0;ct<Tn;++ct){var ft=ga[ct];ft&&(ft.bindCount=0,ft.unit=-1,ga[ct]=null),xe.activeTexture(Ls+ct),xe.bindTexture(fi,null),xe.bindTexture(As,null)}}return{create2D:gi,createCube:dr,clear:Ri,getTexture:function(ct){return null},restore:Xt,refresh:es}}var $n=36161,Pi=32854,Oi=32855,Qi=36194,qi=33189,hi=36168,Si=34041,Ci=35907,ji=34836,si=34842,wu=34843,qo=[];qo[Pi]=2,qo[Oi]=2,qo[Qi]=2,qo[qi]=2,qo[hi]=1,qo[Si]=4,qo[Ci]=4,qo[ji]=16,qo[si]=8,qo[wu]=6;function nl(xe,Ke,mt){return qo[xe]*Ke*mt}var Zu=function(xe,Ke,mt,nr,Ar){var er={rgba4:Pi,rgb565:Qi,"rgb5 a1":Oi,depth:qi,stencil:hi,"depth stencil":Si};Ke.ext_srgb&&(er.srgba=Ci),Ke.ext_color_buffer_half_float&&(er.rgba16f=si,er.rgb16f=wu),Ke.webgl_color_buffer_float&&(er.rgba32f=ji);var sr=[];Object.keys(er).forEach(function(Tr){var Zr=er[Tr];sr[Zr]=Tr});var wr=0,Pr={};function Nr(Tr){this.id=wr++,this.refCount=1,this.renderbuffer=Tr,this.format=Pi,this.width=0,this.height=0,Ar.profile&&(this.stats={size:0})}Nr.prototype.decRef=function(){--this.refCount<=0&&Dr(this)};function Dr(Tr){var Zr=Tr.renderbuffer;J(Zr,"must not double destroy renderbuffer"),xe.bindRenderbuffer($n,null),xe.deleteRenderbuffer(Zr),Tr.renderbuffer=null,Tr.refCount=0,delete Pr[Tr.id],nr.renderbufferCount--}function Or(Tr,Zr){var Vt=new Nr(xe.createRenderbuffer());Pr[Vt.id]=Vt,nr.renderbufferCount++;function lr(tn,mr){var cn=0,Cr=0,Hr=Pi;if(typeof tn=="object"&&tn){var Er=tn;if("shape"in Er){var Yr=Er.shape;J(Array.isArray(Yr)&&Yr.length>=2,"invalid renderbuffer shape"),cn=Yr[0]|0,Cr=Yr[1]|0}else"radius"in Er&&(cn=Cr=Er.radius|0),"width"in Er&&(cn=Er.width|0),"height"in Er&&(Cr=Er.height|0);"format"in Er&&(J.parameter(Er.format,er,"invalid renderbuffer format"),Hr=er[Er.format])}else typeof tn=="number"?(cn=tn|0,typeof mr=="number"?Cr=mr|0:Cr=cn):tn?J.raise("invalid arguments to renderbuffer constructor"):cn=Cr=1;if(J(cn>0&&Cr>0&&cn<=mt.maxRenderbufferSize&&Cr<=mt.maxRenderbufferSize,"invalid renderbuffer size"),!(cn===Vt.width&&Cr===Vt.height&&Hr===Vt.format))return lr.width=Vt.width=cn,lr.height=Vt.height=Cr,Vt.format=Hr,xe.bindRenderbuffer($n,Vt.renderbuffer),xe.renderbufferStorage($n,Hr,cn,Cr),J(xe.getError()===0,"invalid render buffer format"),Ar.profile&&(Vt.stats.size=nl(Vt.format,Vt.width,Vt.height)),lr.format=sr[Vt.format],lr}function Rr(tn,mr){var cn=tn|0,Cr=mr|0||cn;return cn===Vt.width&&Cr===Vt.height||(J(cn>0&&Cr>0&&cn<=mt.maxRenderbufferSize&&Cr<=mt.maxRenderbufferSize,"invalid renderbuffer size"),lr.width=Vt.width=cn,lr.height=Vt.height=Cr,xe.bindRenderbuffer($n,Vt.renderbuffer),xe.renderbufferStorage($n,Vt.format,cn,Cr),J(xe.getError()===0,"invalid render buffer format"),Ar.profile&&(Vt.stats.size=nl(Vt.format,Vt.width,Vt.height))),lr}return lr(Tr,Zr),lr.resize=Rr,lr._reglType="renderbuffer",lr._renderbuffer=Vt,Ar.profile&&(lr.stats=Vt.stats),lr.destroy=function(){Vt.decRef()},lr}Ar.profile&&(nr.getTotalRenderbufferSize=function(){var Tr=0;return Object.keys(Pr).forEach(function(Zr){Tr+=Pr[Zr].stats.size}),Tr});function qr(){Gt(Pr).forEach(function(Tr){Tr.renderbuffer=xe.createRenderbuffer(),xe.bindRenderbuffer($n,Tr.renderbuffer),xe.renderbufferStorage($n,Tr.format,Tr.width,Tr.height)}),xe.bindRenderbuffer($n,null)}return{create:Or,clear:function(){Gt(Pr).forEach(Dr)},restore:qr}},Fn=36160,Ko=36161,Ws=3553,du=34069,gs=36064,bl=36096,ms=36128,ka=33306,il=36053,ef=36054,o=36055,s=36057,d=36061,_=36193,w=5121,j=5126,re=6407,Pe=6408,tt=6402,It=[re,Pe],tr=[];tr[Pe]=4,tr[re]=3;var ot=[];ot[w]=1,ot[j]=4,ot[_]=2;var Zt=32854,Jt=32855,gr=36194,v=33189,Ln=36168,jn=34041,Xe=35907,Ma=34836,ao=34842,xo=34843,aa=[Zt,Jt,gr,Xe,ao,xo,Ma],Da={};Da[il]="complete",Da[ef]="incomplete attachment",Da[s]="incomplete dimensions",Da[o]="incomplete, missing attachment",Da[d]="unsupported";function us(xe,Ke,mt,nr,Ar,er){var sr={cur:null,next:null,dirty:!1,setFBO:null},wr=["rgba"],Pr=["rgba4","rgb565","rgb5 a1"];Ke.ext_srgb&&Pr.push("srgba"),Ke.ext_color_buffer_half_float&&Pr.push("rgba16f","rgb16f"),Ke.webgl_color_buffer_float&&Pr.push("rgba32f");var Nr=["uint8"];Ke.oes_texture_half_float&&Nr.push("half float","float16"),Ke.oes_texture_float&&Nr.push("float","float32");function Dr(Ir,Fr,vr){this.target=Ir,this.texture=Fr,this.renderbuffer=vr;var On=0,Bn=0;Fr?(On=Fr.width,Bn=Fr.height):vr&&(On=vr.width,Bn=vr.height),this.width=On,this.height=Bn}function Or(Ir){Ir&&(Ir.texture&&Ir.texture._texture.decRef(),Ir.renderbuffer&&Ir.renderbuffer._renderbuffer.decRef())}function qr(Ir,Fr,vr){if(Ir)if(Ir.texture){var On=Ir.texture._texture,Bn=Math.max(1,On.width),gn=Math.max(1,On.height);J(Bn===Fr&&gn===vr,"inconsistent width/height for supplied texture"),On.refCount+=1}else{var xi=Ir.renderbuffer._renderbuffer;J(xi.width===Fr&&xi.height===vr,"inconsistent width/height for renderbuffer"),xi.refCount+=1}}function Tr(Ir,Fr){Fr&&(Fr.texture?xe.framebufferTexture2D(Fn,Ir,Fr.target,Fr.texture._texture.texture,0):xe.framebufferRenderbuffer(Fn,Ir,Ko,Fr.renderbuffer._renderbuffer.renderbuffer))}function Zr(Ir){var Fr=Ws,vr=null,On=null,Bn=Ir;typeof Ir=="object"&&(Bn=Ir.data,"target"in Ir&&(Fr=Ir.target|0)),J.type(Bn,"function","invalid attachment data");var gn=Bn._reglType;return gn==="texture2d"?(vr=Bn,J(Fr===Ws)):gn==="textureCube"?(vr=Bn,J(Fr>=du&&Fr<du+6,"invalid cube map target")):gn==="renderbuffer"?(On=Bn,Fr=Ko):J.raise("invalid regl object for attachment"),new Dr(Fr,vr,On)}function Vt(Ir,Fr,vr,On,Bn){if(vr){var gn=nr.create2D({width:Ir,height:Fr,format:On,type:Bn});return gn._texture.refCount=0,new Dr(Ws,gn,null)}else{var xi=Ar.create({width:Ir,height:Fr,format:On});return xi._renderbuffer.refCount=0,new Dr(Ko,null,xi)}}function lr(Ir){return Ir&&(Ir.texture||Ir.renderbuffer)}function Rr(Ir,Fr,vr){Ir&&(Ir.texture?Ir.texture.resize(Fr,vr):Ir.renderbuffer&&Ir.renderbuffer.resize(Fr,vr),Ir.width=Fr,Ir.height=vr)}var tn=0,mr={};function cn(){this.id=tn++,mr[this.id]=this,this.framebuffer=xe.createFramebuffer(),this.width=0,this.height=0,this.colorAttachments=[],this.depthAttachment=null,this.stencilAttachment=null,this.depthStencilAttachment=null}function Cr(Ir){Ir.colorAttachments.forEach(Or),Or(Ir.depthAttachment),Or(Ir.stencilAttachment),Or(Ir.depthStencilAttachment)}function Hr(Ir){var Fr=Ir.framebuffer;J(Fr,"must not double destroy framebuffer"),xe.deleteFramebuffer(Fr),Ir.framebuffer=null,er.framebufferCount--,delete mr[Ir.id]}function Er(Ir){var Fr;xe.bindFramebuffer(Fn,Ir.framebuffer);var vr=Ir.colorAttachments;for(Fr=0;Fr<vr.length;++Fr)Tr(gs+Fr,vr[Fr]);for(Fr=vr.length;Fr<mt.maxColorAttachments;++Fr)xe.framebufferTexture2D(Fn,gs+Fr,Ws,null,0);xe.framebufferTexture2D(Fn,ka,Ws,null,0),xe.framebufferTexture2D(Fn,bl,Ws,null,0),xe.framebufferTexture2D(Fn,ms,Ws,null,0),Tr(bl,Ir.depthAttachment),Tr(ms,Ir.stencilAttachment),Tr(ka,Ir.depthStencilAttachment);var On=xe.checkFramebufferStatus(Fn);!xe.isContextLost()&&On!==il&&J.raise("framebuffer configuration not supported, status = "+Da[On]),xe.bindFramebuffer(Fn,sr.next?sr.next.framebuffer:null),sr.cur=sr.next,xe.getError()}function Yr(Ir,Fr){var vr=new cn;er.framebufferCount++;function On(gn,xi){var Jn;J(sr.next!==vr,"can not update framebuffer which is currently in use");var yi=0,ta=0,bo=!0,ro=!0,Ti=null,Io=!0,Na="rgba",Ao="uint8",jo=1,Fa=null,Ua=null,Tn=null,ga=!1;if(typeof gn=="number")yi=gn|0,ta=xi|0||yi;else if(!gn)yi=ta=1;else{J.type(gn,"object","invalid arguments for framebuffer");var un=gn;if("shape"in un){var Aa=un.shape;J(Array.isArray(Aa)&&Aa.length>=2,"invalid shape for framebuffer"),yi=Aa[0],ta=Aa[1]}else"radius"in un&&(yi=ta=un.radius),"width"in un&&(yi=un.width),"height"in un&&(ta=un.height);("color"in un||"colors"in un)&&(Ti=un.color||un.colors,Array.isArray(Ti)&&J(Ti.length===1||Ke.webgl_draw_buffers,"multiple render targets not supported")),Ti||("colorCount"in un&&(jo=un.colorCount|0,J(jo>0,"invalid color buffer count")),"colorTexture"in un&&(Io=!!un.colorTexture,Na="rgba4"),"colorType"in un&&(Ao=un.colorType,Io?(J(Ke.oes_texture_float||!(Ao==="float"||Ao==="float32"),"you must enable OES_texture_float in order to use floating point framebuffer objects"),J(Ke.oes_texture_half_float||!(Ao==="half float"||Ao==="float16"),"you must enable OES_texture_half_float in order to use 16-bit floating point framebuffer objects")):Ao==="half float"||Ao==="float16"?(J(Ke.ext_color_buffer_half_float,"you must enable EXT_color_buffer_half_float to use 16-bit render buffers"),Na="rgba16f"):(Ao==="float"||Ao==="float32")&&(J(Ke.webgl_color_buffer_float,"you must enable WEBGL_color_buffer_float in order to use 32-bit floating point renderbuffers"),Na="rgba32f"),J.oneOf(Ao,Nr,"invalid color type")),"colorFormat"in un&&(Na=un.colorFormat,wr.indexOf(Na)>=0?Io=!0:Pr.indexOf(Na)>=0?Io=!1:Io?J.oneOf(un.colorFormat,wr,"invalid color format for texture"):J.oneOf(un.colorFormat,Pr,"invalid color format for renderbuffer"))),("depthTexture"in un||"depthStencilTexture"in un)&&(ga=!!(un.depthTexture||un.depthStencilTexture),J(!ga||Ke.webgl_depth_texture,"webgl_depth_texture extension not supported")),"depth"in un&&(typeof un.depth=="boolean"?bo=un.depth:(Fa=un.depth,ro=!1)),"stencil"in un&&(typeof un.stencil=="boolean"?ro=un.stencil:(Ua=un.stencil,bo=!1)),"depthStencil"in un&&(typeof un.depthStencil=="boolean"?bo=ro=un.depthStencil:(Tn=un.depthStencil,bo=!1,ro=!1))}var ra=null,Rn=null,gi=null,dr=null;if(Array.isArray(Ti))ra=Ti.map(Zr);else if(Ti)ra=[Zr(Ti)];else for(ra=new Array(jo),Jn=0;Jn<jo;++Jn)ra[Jn]=Vt(yi,ta,Io,Na,Ao);J(Ke.webgl_draw_buffers||ra.length<=1,"you must enable the WEBGL_draw_buffers extension in order to use multiple color buffers."),J(ra.length<=mt.maxColorAttachments,"too many color attachments, not supported"),yi=yi||ra[0].width,ta=ta||ra[0].height,Fa?Rn=Zr(Fa):bo&&!ro&&(Rn=Vt(yi,ta,ga,"depth","uint32")),Ua?gi=Zr(Ua):ro&&!bo&&(gi=Vt(yi,ta,!1,"stencil","uint8")),Tn?dr=Zr(Tn):!Fa&&!Ua&&ro&&bo&&(dr=Vt(yi,ta,ga,"depth stencil","depth stencil")),J(!!Fa+!!Ua+!!Tn<=1,"invalid framebuffer configuration, can specify exactly one depth/stencil attachment");var Ri=null;for(Jn=0;Jn<ra.length;++Jn)if(qr(ra[Jn],yi,ta),J(!ra[Jn]||ra[Jn].texture&&It.indexOf(ra[Jn].texture._texture.format)>=0||ra[Jn].renderbuffer&&aa.indexOf(ra[Jn].renderbuffer._renderbuffer.format)>=0,"framebuffer color attachment "+Jn+" is invalid"),ra[Jn]&&ra[Jn].texture){var Xt=tr[ra[Jn].texture._texture.format]*ot[ra[Jn].texture._texture.type];Ri===null?Ri=Xt:J(Ri===Xt,"all color attachments much have the same number of bits per pixel.")}return qr(Rn,yi,ta),J(!Rn||Rn.texture&&Rn.texture._texture.format===tt||Rn.renderbuffer&&Rn.renderbuffer._renderbuffer.format===v,"invalid depth attachment for framebuffer object"),qr(gi,yi,ta),J(!gi||gi.renderbuffer&&gi.renderbuffer._renderbuffer.format===Ln,"invalid stencil attachment for framebuffer object"),qr(dr,yi,ta),J(!dr||dr.texture&&dr.texture._texture.format===jn||dr.renderbuffer&&dr.renderbuffer._renderbuffer.format===jn,"invalid depth-stencil attachment for framebuffer object"),Cr(vr),vr.width=yi,vr.height=ta,vr.colorAttachments=ra,vr.depthAttachment=Rn,vr.stencilAttachment=gi,vr.depthStencilAttachment=dr,On.color=ra.map(lr),On.depth=lr(Rn),On.stencil=lr(gi),On.depthStencil=lr(dr),On.width=vr.width,On.height=vr.height,Er(vr),On}function Bn(gn,xi){J(sr.next!==vr,"can not resize a framebuffer which is currently in use");var Jn=Math.max(gn|0,1),yi=Math.max(xi|0||Jn,1);if(Jn===vr.width&&yi===vr.height)return On;for(var ta=vr.colorAttachments,bo=0;bo<ta.length;++bo)Rr(ta[bo],Jn,yi);return Rr(vr.depthAttachment,Jn,yi),Rr(vr.stencilAttachment,Jn,yi),Rr(vr.depthStencilAttachment,Jn,yi),vr.width=On.width=Jn,vr.height=On.height=yi,Er(vr),On}return On(Ir,Fr),C(On,{resize:Bn,_reglType:"framebuffer",_framebuffer:vr,destroy:function(){Hr(vr),Cr(vr)},use:function(gn){sr.setFBO({framebuffer:On},gn)}})}function Cn(Ir){var Fr=Array(6);function vr(Bn){var gn;J(Fr.indexOf(sr.next)<0,"can not update framebuffer which is currently in use");var xi={color:null},Jn=0,yi=null,ta="rgba",bo="uint8",ro=1;if(typeof Bn=="number")Jn=Bn|0;else if(!Bn)Jn=1;else{J.type(Bn,"object","invalid arguments for framebuffer");var Ti=Bn;if("shape"in Ti){var Io=Ti.shape;J(Array.isArray(Io)&&Io.length>=2,"invalid shape for framebuffer"),J(Io[0]===Io[1],"cube framebuffer must be square"),Jn=Io[0]}else"radius"in Ti&&(Jn=Ti.radius|0),"width"in Ti?(Jn=Ti.width|0,"height"in Ti&&J(Ti.height===Jn,"must be square")):"height"in Ti&&(Jn=Ti.height|0);("color"in Ti||"colors"in Ti)&&(yi=Ti.color||Ti.colors,Array.isArray(yi)&&J(yi.length===1||Ke.webgl_draw_buffers,"multiple render targets not supported")),yi||("colorCount"in Ti&&(ro=Ti.colorCount|0,J(ro>0,"invalid color buffer count")),"colorType"in Ti&&(J.oneOf(Ti.colorType,Nr,"invalid color type"),bo=Ti.colorType),"colorFormat"in Ti&&(ta=Ti.colorFormat,J.oneOf(Ti.colorFormat,wr,"invalid color format for texture"))),"depth"in Ti&&(xi.depth=Ti.depth),"stencil"in Ti&&(xi.stencil=Ti.stencil),"depthStencil"in Ti&&(xi.depthStencil=Ti.depthStencil)}var Na;if(yi)if(Array.isArray(yi))for(Na=[],gn=0;gn<yi.length;++gn)Na[gn]=yi[gn];else Na=[yi];else{Na=Array(ro);var Ao={radius:Jn,format:ta,type:bo};for(gn=0;gn<ro;++gn)Na[gn]=nr.createCube(Ao)}for(xi.color=Array(Na.length),gn=0;gn<Na.length;++gn){var jo=Na[gn];J(typeof jo=="function"&&jo._reglType==="textureCube","invalid cube map"),Jn=Jn||jo.width,J(jo.width===Jn&&jo.height===Jn,"invalid cube map shape"),xi.color[gn]={target:du,data:Na[gn]}}for(gn=0;gn<6;++gn){for(var Fa=0;Fa<Na.length;++Fa)xi.color[Fa].target=du+gn;gn>0&&(xi.depth=Fr[0].depth,xi.stencil=Fr[0].stencil,xi.depthStencil=Fr[0].depthStencil),Fr[gn]?Fr[gn](xi):Fr[gn]=Yr(xi)}return C(vr,{width:Jn,height:Jn,color:Na})}function On(Bn){var gn,xi=Bn|0;if(J(xi>0&&xi<=mt.maxCubeMapSize,"invalid radius for cube fbo"),xi===vr.width)return vr;var Jn=vr.color;for(gn=0;gn<Jn.length;++gn)Jn[gn].resize(xi);for(gn=0;gn<6;++gn)Fr[gn].resize(xi);return vr.width=vr.height=xi,vr}return vr(Ir),C(vr,{faces:Fr,resize:On,_reglType:"framebufferCube",destroy:function(){Fr.forEach(function(Bn){Bn.destroy()})}})}function Xn(){sr.cur=null,sr.next=null,sr.dirty=!0,Gt(mr).forEach(function(Ir){Ir.framebuffer=xe.createFramebuffer(),Er(Ir)})}return C(sr,{getFramebuffer:function(Ir){if(typeof Ir=="function"&&Ir._reglType==="framebuffer"){var Fr=Ir._framebuffer;if(Fr instanceof cn)return Fr}return null},create:Yr,createCube:Cn,clear:function(){Gt(mr).forEach(Hr)},restore:Xn})}var Ea=5126,Vr=34962;function hn(){this.state=0,this.x=0,this.y=0,this.z=0,this.w=0,this.buffer=null,this.size=0,this.normalized=!1,this.type=Ea,this.offset=0,this.stride=0,this.divisor=0}function Wn(xe,Ke,mt,nr,Ar){for(var er=mt.maxAttributes,sr=new Array(er),wr=0;wr<er;++wr)sr[wr]=new hn;var Pr=0,Nr={},Dr={Record:hn,scope:{},state:sr,currentVAO:null,targetVAO:null,restore:qr()?mr:function(){},createVAO:cn,getVAO:Zr,destroyBuffer:Or,setVAO:qr()?Vt:lr,clear:qr()?Rr:function(){}};function Or(Cr){for(var Hr=0;Hr<sr.length;++Hr){var Er=sr[Hr];Er.buffer===Cr&&(xe.disableVertexAttribArray(Hr),Er.buffer=null)}}function qr(){return Ke.oes_vertex_array_object}function Tr(){return Ke.angle_instanced_arrays}function Zr(Cr){return typeof Cr=="function"&&Cr._vao?Cr._vao:null}function Vt(Cr){if(Cr!==Dr.currentVAO){var Hr=qr();Cr?Hr.bindVertexArrayOES(Cr.vao):Hr.bindVertexArrayOES(null),Dr.currentVAO=Cr}}function lr(Cr){if(Cr!==Dr.currentVAO){if(Cr)Cr.bindAttrs();else for(var Hr=Tr(),Er=0;Er<sr.length;++Er){var Yr=sr[Er];Yr.buffer?(xe.enableVertexAttribArray(Er),xe.vertexAttribPointer(Er,Yr.size,Yr.type,Yr.normalized,Yr.stride,Yr.offfset),Hr&&Yr.divisor&&Hr.vertexAttribDivisorANGLE(Er,Yr.divisor)):(xe.disableVertexAttribArray(Er),xe.vertexAttrib4f(Er,Yr.x,Yr.y,Yr.z,Yr.w))}Dr.currentVAO=Cr}}function Rr(){Gt(Nr).forEach(function(Cr){Cr.destroy()})}function tn(){this.id=++Pr,this.attributes=[];var Cr=qr();Cr?this.vao=Cr.createVertexArrayOES():this.vao=null,Nr[this.id]=this,this.buffers=[]}tn.prototype.bindAttrs=function(){for(var Cr=Tr(),Hr=this.attributes,Er=0;Er<Hr.length;++Er){var Yr=Hr[Er];Yr.buffer?(xe.enableVertexAttribArray(Er),xe.bindBuffer(Vr,Yr.buffer.buffer),xe.vertexAttribPointer(Er,Yr.size,Yr.type,Yr.normalized,Yr.stride,Yr.offset),Cr&&Yr.divisor&&Cr.vertexAttribDivisorANGLE(Er,Yr.divisor)):(xe.disableVertexAttribArray(Er),xe.vertexAttrib4f(Er,Yr.x,Yr.y,Yr.z,Yr.w))}for(var Cn=Hr.length;Cn<er;++Cn)xe.disableVertexAttribArray(Cn)},tn.prototype.refresh=function(){var Cr=qr();Cr&&(Cr.bindVertexArrayOES(this.vao),this.bindAttrs(),Dr.currentVAO=this)},tn.prototype.destroy=function(){if(this.vao){var Cr=qr();this===Dr.currentVAO&&(Dr.currentVAO=null,Cr.bindVertexArrayOES(null)),Cr.deleteVertexArrayOES(this.vao),this.vao=null}Nr[this.id]&&(delete Nr[this.id],nr.vaoCount-=1)};function mr(){var Cr=qr();Cr&&Gt(Nr).forEach(function(Hr){Hr.refresh()})}function cn(Cr){var Hr=new tn;nr.vaoCount+=1;function Er(Yr){J(Array.isArray(Yr),"arguments to vertex array constructor must be an array"),J(Yr.length<er,"too many attributes"),J(Yr.length>0,"must specify at least one attribute");var Cn={},Xn=Hr.attributes;Xn.length=Yr.length;for(var Ir=0;Ir<Yr.length;++Ir){var Fr=Yr[Ir],vr=Xn[Ir]=new hn,On=Fr.data||Fr;if(Array.isArray(On)||$(On)||Ve(On)){var Bn;Hr.buffers[Ir]&&(Bn=Hr.buffers[Ir],$(On)&&Bn._buffer.byteLength>=On.byteLength?Bn.subdata(On):(Bn.destroy(),Hr.buffers[Ir]=null)),Hr.buffers[Ir]||(Bn=Hr.buffers[Ir]=Ar.create(Fr,Vr,!1,!0)),vr.buffer=Ar.getBuffer(Bn),vr.size=vr.buffer.dimension|0,vr.normalized=!1,vr.type=vr.buffer.dtype,vr.offset=0,vr.stride=0,vr.divisor=0,vr.state=1,Cn[Ir]=1}else Ar.getBuffer(Fr)?(vr.buffer=Ar.getBuffer(Fr),vr.size=vr.buffer.dimension|0,vr.normalized=!1,vr.type=vr.buffer.dtype,vr.offset=0,vr.stride=0,vr.divisor=0,vr.state=1):Ar.getBuffer(Fr.buffer)?(vr.buffer=Ar.getBuffer(Fr.buffer),vr.size=(+Fr.size||vr.buffer.dimension)|0,vr.normalized=!!Fr.normalized||!1,"type"in Fr?(J.parameter(Fr.type,qa,"invalid buffer type"),vr.type=qa[Fr.type]):vr.type=vr.buffer.dtype,vr.offset=(Fr.offset||0)|0,vr.stride=(Fr.stride||0)|0,vr.divisor=(Fr.divisor||0)|0,vr.state=1,J(vr.size>=1&&vr.size<=4,"size must be between 1 and 4"),J(vr.offset>=0,"invalid offset"),J(vr.stride>=0&&vr.stride<=255,"stride must be between 0 and 255"),J(vr.divisor>=0,"divisor must be positive"),J(!vr.divisor||!!Ke.angle_instanced_arrays,"ANGLE_instanced_arrays must be enabled to use divisor")):"x"in Fr?(J(Ir>0,"first attribute must not be a constant"),vr.x=+Fr.x||0,vr.y=+Fr.y||0,vr.z=+Fr.z||0,vr.w=+Fr.w||0,vr.state=2):J(!1,"invalid attribute spec for location "+Ir)}for(var gn=0;gn<Hr.buffers.length;++gn)!Cn[gn]&&Hr.buffers[gn]&&(Hr.buffers[gn].destroy(),Hr.buffers[gn]=null);return Hr.refresh(),Er}return Er.destroy=function(){for(var Yr=0;Yr<Hr.buffers.length;++Yr)Hr.buffers[Yr]&&Hr.buffers[Yr].destroy();Hr.buffers.length=0,Hr.destroy()},Er._vao=Hr,Er._reglType="vao",Er(Cr)}return Dr}var kn=35632,Kn=35633,Pn=35718,Fi=35721;function wi(xe,Ke,mt,nr){var Ar={},er={};function sr(Vt,lr,Rr,tn){this.name=Vt,this.id=lr,this.location=Rr,this.info=tn}function wr(Vt,lr){for(var Rr=0;Rr<Vt.length;++Rr)if(Vt[Rr].id===lr.id){Vt[Rr].location=lr.location;return}Vt.push(lr)}function Pr(Vt,lr,Rr){var tn=Vt===kn?Ar:er,mr=tn[lr];if(!mr){var cn=Ke.str(lr);mr=xe.createShader(Vt),xe.shaderSource(mr,cn),xe.compileShader(mr),J.shaderError(xe,mr,cn,Vt,Rr),tn[lr]=mr}return mr}var Nr={},Dr=[],Or=0;function qr(Vt,lr){this.id=Or++,this.fragId=Vt,this.vertId=lr,this.program=null,this.uniforms=[],this.attributes=[],this.refCount=1,nr.profile&&(this.stats={uniformsCount:0,attributesCount:0})}function Tr(Vt,lr,Rr){var tn,mr,cn=Pr(kn,Vt.fragId),Cr=Pr(Kn,Vt.vertId),Hr=Vt.program=xe.createProgram();if(xe.attachShader(Hr,cn),xe.attachShader(Hr,Cr),Rr)for(tn=0;tn<Rr.length;++tn){var Er=Rr[tn];xe.bindAttribLocation(Hr,Er[0],Er[1])}xe.linkProgram(Hr),J.linkError(xe,Hr,Ke.str(Vt.fragId),Ke.str(Vt.vertId),lr);var Yr=xe.getProgramParameter(Hr,Pn);nr.profile&&(Vt.stats.uniformsCount=Yr);var Cn=Vt.uniforms;for(tn=0;tn<Yr;++tn)if(mr=xe.getActiveUniform(Hr,tn),mr)if(mr.size>1)for(var Xn=0;Xn<mr.size;++Xn){var Ir=mr.name.replace("[0]","["+Xn+"]");wr(Cn,new sr(Ir,Ke.id(Ir),xe.getUniformLocation(Hr,Ir),mr))}else wr(Cn,new sr(mr.name,Ke.id(mr.name),xe.getUniformLocation(Hr,mr.name),mr));var Fr=xe.getProgramParameter(Hr,Fi);nr.profile&&(Vt.stats.attributesCount=Fr);var vr=Vt.attributes;for(tn=0;tn<Fr;++tn)mr=xe.getActiveAttrib(Hr,tn),mr&&wr(vr,new sr(mr.name,Ke.id(mr.name),xe.getAttribLocation(Hr,mr.name),mr))}nr.profile&&(mt.getMaxUniformsCount=function(){var Vt=0;return Dr.forEach(function(lr){lr.stats.uniformsCount>Vt&&(Vt=lr.stats.uniformsCount)}),Vt},mt.getMaxAttributesCount=function(){var Vt=0;return Dr.forEach(function(lr){lr.stats.attributesCount>Vt&&(Vt=lr.stats.attributesCount)}),Vt});function Zr(){Ar={},er={};for(var Vt=0;Vt<Dr.length;++Vt)Tr(Dr[Vt],null,Dr[Vt].attributes.map(function(lr){return[lr.location,lr.name]}))}return{clear:function(){var Vt=xe.deleteShader.bind(xe);Gt(Ar).forEach(Vt),Ar={},Gt(er).forEach(Vt),er={},Dr.forEach(function(lr){xe.deleteProgram(lr.program)}),Dr.length=0,Nr={},mt.shaderCount=0},program:function(Vt,lr,Rr,tn){J.command(Vt>=0,"missing vertex shader",Rr),J.command(lr>=0,"missing fragment shader",Rr);var mr=Nr[lr];mr||(mr=Nr[lr]={});var cn=mr[Vt];if(cn&&(cn.refCount++,!tn))return cn;var Cr=new qr(lr,Vt);return mt.shaderCount++,Tr(Cr,Rr,tn),cn||(mr[Vt]=Cr),Dr.push(Cr),C(Cr,{destroy:function(){if(Cr.refCount--,Cr.refCount<=0){xe.deleteProgram(Cr.program);var Hr=Dr.indexOf(Cr);Dr.splice(Hr,1),mt.shaderCount--}mr[Cr.vertId].refCount<=0&&(xe.deleteShader(er[Cr.vertId]),delete er[Cr.vertId],delete Nr[Cr.fragId][Cr.vertId]),Object.keys(Nr[Cr.fragId]).length||(xe.deleteShader(Ar[Cr.fragId]),delete Ar[Cr.fragId],delete Nr[Cr.fragId])}})},restore:Zr,shader:Pr,frag:-1,vert:-1}}var An=6408,Ue=5121,al=3333,Bi=5126;function lt(xe,Ke,mt,nr,Ar,er,sr){function wr(Dr){var Or;Ke.next===null?(J(Ar.preserveDrawingBuffer,'you must create a webgl context with "preserveDrawingBuffer":true in order to read pixels from the drawing buffer'),Or=Ue):(J(Ke.next.colorAttachments[0].texture!==null,"You cannot read from a renderbuffer"),Or=Ke.next.colorAttachments[0].texture._texture.type,er.oes_texture_float?(J(Or===Ue||Or===Bi,"Reading from a framebuffer is only allowed for the types 'uint8' and 'float'"),Or===Bi&&J(sr.readFloat,"Reading 'float' values is not permitted in your browser. For a fallback, please see: https://www.npmjs.com/package/glsl-read-float")):J(Or===Ue,"Reading from a framebuffer is only allowed for the type 'uint8'"));var qr=0,Tr=0,Zr=nr.framebufferWidth,Vt=nr.framebufferHeight,lr=null;$(Dr)?lr=Dr:Dr&&(J.type(Dr,"object","invalid arguments to regl.read()"),qr=Dr.x|0,Tr=Dr.y|0,J(qr>=0&&qr<nr.framebufferWidth,"invalid x offset for regl.read"),J(Tr>=0&&Tr<nr.framebufferHeight,"invalid y offset for regl.read"),Zr=(Dr.width||nr.framebufferWidth-qr)|0,Vt=(Dr.height||nr.framebufferHeight-Tr)|0,lr=Dr.data||null),lr&&(Or===Ue?J(lr instanceof Uint8Array,"buffer must be 'Uint8Array' when reading from a framebuffer of type 'uint8'"):Or===Bi&&J(lr instanceof Float32Array,"buffer must be 'Float32Array' when reading from a framebuffer of type 'float'")),J(Zr>0&&Zr+qr<=nr.framebufferWidth,"invalid width for read pixels"),J(Vt>0&&Vt+Tr<=nr.framebufferHeight,"invalid height for read pixels"),mt();var Rr=Zr*Vt*4;return lr||(Or===Ue?lr=new Uint8Array(Rr):Or===Bi&&(lr=lr||new Float32Array(Rr))),J.isTypedArray(lr,"data buffer for regl.read() must be a typedarray"),J(lr.byteLength>=Rr,"data buffer for regl.read() too small"),xe.pixelStorei(al,4),xe.readPixels(qr,Tr,Zr,Vt,An,Or,lr),lr}function Pr(Dr){var Or;return Ke.setFBO({framebuffer:Dr.framebuffer},function(){Or=wr(Dr)}),Or}function Nr(Dr){return!Dr||!("framebuffer"in Dr)?wr(Dr):Pr(Dr)}return Nr}function ni(xe){return Array.prototype.slice.call(xe)}function _c(xe){return ni(xe).join("")}function xh(){var xe=0,Ke=[],mt=[];function nr(Or){for(var qr=0;qr<mt.length;++qr)if(mt[qr]===Or)return Ke[qr];var Tr="g"+xe++;return Ke.push(Tr),mt.push(Or),Tr}function Ar(){var Or=[];function qr(){Or.push.apply(Or,ni(arguments))}var Tr=[];function Zr(){var Vt="v"+xe++;return Tr.push(Vt),arguments.length>0&&(Or.push(Vt,"="),Or.push.apply(Or,ni(arguments)),Or.push(";")),Vt}return C(qr,{def:Zr,toString:function(){return _c([Tr.length>0?"var "+Tr.join(",")+";":"",_c(Or)])}})}function er(){var Or=Ar(),qr=Ar(),Tr=Or.toString,Zr=qr.toString;function Vt(lr,Rr){qr(lr,Rr,"=",Or.def(lr,Rr),";")}return C(function(){Or.apply(Or,ni(arguments))},{def:Or.def,entry:Or,exit:qr,save:Vt,set:function(lr,Rr,tn){Vt(lr,Rr),Or(lr,Rr,"=",tn,";")},toString:function(){return Tr()+Zr()}})}function sr(){var Or=_c(arguments),qr=er(),Tr=er(),Zr=qr.toString,Vt=Tr.toString;return C(qr,{then:function(){return qr.apply(qr,ni(arguments)),this},else:function(){return Tr.apply(Tr,ni(arguments)),this},toString:function(){var lr=Vt();return lr&&(lr="else{"+lr+"}"),_c(["if(",Or,"){",Zr(),"}",lr])}})}var wr=Ar(),Pr={};function Nr(Or,qr){var Tr=[];function Zr(){var mr="a"+Tr.length;return Tr.push(mr),mr}qr=qr||0;for(var Vt=0;Vt<qr;++Vt)Zr();var lr=er(),Rr=lr.toString,tn=Pr[Or]=C(lr,{arg:Zr,toString:function(){return _c(["function(",Tr.join(),"){",Rr(),"}"])}});return tn}function Dr(){var Or=['"use strict";',wr,"return {"];Object.keys(Pr).forEach(function(Zr){Or.push('"',Zr,'":',Pr[Zr].toString(),",")}),Or.push("}");var qr=_c(Or).replace(/;/g,`;
`).replace(/}/g,`}
`).replace(/{/g,`{
`),Tr=Function.apply(null,Ke.concat(qr));return Tr.apply(null,mt)}return{global:wr,link:nr,block:Ar,proc:Nr,scope:er,cond:sr,compile:Dr}}var xc="xyzw".split(""),o0=5121,tf=1,et=2,Ec=0,_f=1,s0=2,Nf=3,rf=4,u0=5,xf=6,z0="dither",l0="blend.enable",zu="blend.color",Uo="blend.equation",Ff="blend.func",Eh="depth.enable",Bf="depth.func",Nl="depth.range",bc="depth.mask",nf="colorMask",c0="cull.enable",fa="cull.face",za="frontFace",Go="lineWidth",Zf="polygonOffset.enable",U0="polygonOffset.offset",zf="sample.alpha",f0="sample.enable",Uf="sample.coverage",Xi="stencil.enable",Gf="stencil.mask",Fl="stencil.func",iu="stencil.opFront",nc="stencil.opBack",oo="scissor.enable",Uu="scissor.box",Bl="viewport",Ef="profile",Mo="framebuffer",ol="vert",ls="frag",ic="elements",Sc="primitive",Zl="count",h0="offset",jf="instances",af="vao",Vf="Width",Cc="Height",Tu=Mo+Vf,wc=Mo+Cc,Gu=Bl+Vf,sl=Bl+Cc,Tc="drawingBuffer",Sl=Tc+Vf,A0=Tc+Cc,G0=[Ff,Uo,Fl,iu,nc,Uf,Bl,Uu,U0],ac=34962,bh=34963,Sh=35632,j0=35633,p0=3553,d0=34067,Ch=2884,mA=3042,V0=3024,wh=2960,oc=2929,H0=3089,bf=32823,yA=32926,_A=32928,$0=5126,Mc=35664,Ic=35665,Sf=35666,Eo=5124,Ys=35667,zl=35668,sc=35669,ul=35670,Ul=35671,Lc=35672,of=35673,Gl=35674,Cl=35675,ha=35676,Pc=35678,jl=35680,uc=4,Vl=1028,Hl=1029,v0=2304,g0=2305,Xs=32775,Oc=32776,wl=519,ju=7680,Mu=0,Hf=1,au=32774,sf=513,$l=36160,Wl=36064,Ps={0:0,1:1,zero:0,one:1,"src color":768,"one minus src color":769,"src alpha":770,"one minus src alpha":771,"dst color":774,"one minus dst color":775,"dst alpha":772,"one minus dst alpha":773,"constant color":32769,"one minus constant color":32770,"constant alpha":32771,"one minus constant alpha":32772,"src alpha saturate":776},Rc=["constant color, constant alpha","one minus constant color, constant alpha","constant color, one minus constant alpha","one minus constant color, one minus constant alpha","constant alpha, constant color","constant alpha, one minus constant color","one minus constant alpha, constant color","one minus constant alpha, one minus constant color"],kc={never:512,less:513,"<":513,equal:514,"=":514,"==":514,"===":514,lequal:515,"<=":515,greater:516,">":516,notequal:517,"!=":517,"!==":517,gequal:518,">=":518,always:519},Tl={0:0,zero:0,keep:7680,replace:7681,increment:7682,decrement:7683,"increment wrap":34055,"decrement wrap":34056,invert:5386},m0={frag:Sh,vert:j0},uf={cw:v0,ccw:g0};function lf(xe){return Array.isArray(xe)||$(xe)||Ve(xe)}function Cf(xe){return xe.sort(function(Ke,mt){return Ke===Bl?-1:mt===Bl?1:Ke<mt?-1:1})}function ys(xe,Ke,mt,nr){this.thisDep=xe,this.contextDep=Ke,this.propDep=mt,this.append=nr}function ll(xe){return xe&&!(xe.thisDep||xe.contextDep||xe.propDep)}function Ia(xe){return new ys(!1,!1,!1,xe)}function Jo(xe,Ke){var mt=xe.type;if(mt===Ec){var nr=xe.data.length;return new ys(!0,nr>=1,nr>=2,Ke)}else if(mt===rf){var Ar=xe.data;return new ys(Ar.thisDep,Ar.contextDep,Ar.propDep,Ke)}else{if(mt===u0)return new ys(!1,!1,!1,Ke);if(mt===xf){for(var er=!1,sr=!1,wr=!1,Pr=0;Pr<xe.data.length;++Pr){var Nr=xe.data[Pr];if(Nr.type===_f)wr=!0;else if(Nr.type===s0)sr=!0;else if(Nr.type===Nf)er=!0;else if(Nr.type===Ec){er=!0;var Dr=Nr.data;Dr>=1&&(sr=!0),Dr>=2&&(wr=!0)}else Nr.type===rf&&(er=er||Nr.data.thisDep,sr=sr||Nr.data.contextDep,wr=wr||Nr.data.propDep)}return new ys(er,sr,wr,Ke)}else return new ys(mt===Nf,mt===s0,mt===_f,Ke)}}var lc=new ys(!1,!1,!1,function(){});function cl(xe,Ke,mt,nr,Ar,er,sr,wr,Pr,Nr,Dr,Or,qr,Tr,Zr){var Vt=Nr.Record,lr={add:32774,subtract:32778,"reverse subtract":32779};mt.ext_blend_minmax&&(lr.min=Xs,lr.max=Oc);var Rr=mt.angle_instanced_arrays,tn=mt.webgl_draw_buffers,mr={dirty:!0,profile:Zr.profile},cn={},Cr=[],Hr={},Er={};function Yr(at){return at.replace(".","_")}function Cn(at,We,St){var kt=Yr(at);Cr.push(at),cn[kt]=mr[kt]=!!St,Hr[kt]=We}function Xn(at,We,St){var kt=Yr(at);Cr.push(at),Array.isArray(St)?(mr[kt]=St.slice(),cn[kt]=St.slice()):mr[kt]=cn[kt]=St,Er[kt]=We}Cn(z0,V0),Cn(l0,mA),Xn(zu,"blendColor",[0,0,0,0]),Xn(Uo,"blendEquationSeparate",[au,au]),Xn(Ff,"blendFuncSeparate",[Hf,Mu,Hf,Mu]),Cn(Eh,oc,!0),Xn(Bf,"depthFunc",sf),Xn(Nl,"depthRange",[0,1]),Xn(bc,"depthMask",!0),Xn(nf,nf,[!0,!0,!0,!0]),Cn(c0,Ch),Xn(fa,"cullFace",Hl),Xn(za,za,g0),Xn(Go,Go,1),Cn(Zf,bf),Xn(U0,"polygonOffset",[0,0]),Cn(zf,yA),Cn(f0,_A),Xn(Uf,"sampleCoverage",[1,!1]),Cn(Xi,wh),Xn(Gf,"stencilMask",-1),Xn(Fl,"stencilFunc",[wl,0,-1]),Xn(iu,"stencilOpSeparate",[Vl,ju,ju,ju]),Xn(nc,"stencilOpSeparate",[Hl,ju,ju,ju]),Cn(oo,H0),Xn(Uu,"scissor",[0,0,xe.drawingBufferWidth,xe.drawingBufferHeight]),Xn(Bl,Bl,[0,0,xe.drawingBufferWidth,xe.drawingBufferHeight]);var Ir={gl:xe,context:qr,strings:Ke,next:cn,current:mr,draw:Or,elements:er,buffer:Ar,shader:Dr,attributes:Nr.state,vao:Nr,uniforms:Pr,framebuffer:wr,extensions:mt,timer:Tr,isBufferArgs:lf},Fr={primTypes:Us,compareFuncs:kc,blendFuncs:Ps,blendEquations:lr,stencilOps:Tl,glTypes:qa,orientationType:uf};J.optional(function(){Ir.isArrayLike=Za}),tn&&(Fr.backBuffer=[Hl],Fr.drawBuffer=xn(nr.maxDrawbuffers,function(at){return at===0?[0]:xn(at,function(We){return Wl+We})}));var vr=0;function On(){var at=xh(),We=at.link,St=at.global;at.id=vr++,at.batchId="0";var kt=We(Ir),Ft=at.shared={props:"a0"};Object.keys(Ir).forEach(function(E){Ft[E]=St.def(kt,".",E)}),J.optional(function(){at.CHECK=We(J),at.commandStr=J.guessCommand(),at.command=We(at.commandStr),at.assert=function(E,S,M){E("if(!(",S,"))",this.CHECK,".commandRaise(",We(M),",",this.command,");")},Fr.invalidBlendCombinations=Rc});var h=at.next={},c=at.current={};Object.keys(Er).forEach(function(E){Array.isArray(mr[E])&&(h[E]=St.def(Ft.next,".",E),c[E]=St.def(Ft.current,".",E))});var p=at.constants={};Object.keys(Fr).forEach(function(E){p[E]=St.def(JSON.stringify(Fr[E]))}),at.invoke=function(E,S){switch(S.type){case Ec:var M=["this",Ft.context,Ft.props,at.batchId];return E.def(We(S.data),".call(",M.slice(0,Math.max(S.data.length+1,4)),")");case _f:return E.def(Ft.props,S.data);case s0:return E.def(Ft.context,S.data);case Nf:return E.def("this",S.data);case rf:return S.data.append(at,E),S.data.ref;case u0:return S.data.toString();case xf:return S.data.map(function(k){return at.invoke(E,k)})}},at.attribCache={};var m={};return at.scopeAttrib=function(E){var S=Ke.id(E);if(S in m)return m[S];var M=Nr.scope[S];M||(M=Nr.scope[S]=new Vt);var k=m[S]=We(M);return k},at}function Bn(at){var We=at.static,St=at.dynamic,kt;if(Ef in We){var Ft=!!We[Ef];kt=Ia(function(c,p){return Ft}),kt.enable=Ft}else if(Ef in St){var h=St[Ef];kt=Jo(h,function(c,p){return c.invoke(p,h)})}return kt}function gn(at,We){var St=at.static,kt=at.dynamic;if(Mo in St){var Ft=St[Mo];return Ft?(Ft=wr.getFramebuffer(Ft),J.command(Ft,"invalid framebuffer object"),Ia(function(c,p){var m=c.link(Ft),E=c.shared;p.set(E.framebuffer,".next",m);var S=E.context;return p.set(S,"."+Tu,m+".width"),p.set(S,"."+wc,m+".height"),m})):Ia(function(c,p){var m=c.shared;p.set(m.framebuffer,".next","null");var E=m.context;return p.set(E,"."+Tu,E+"."+Sl),p.set(E,"."+wc,E+"."+A0),"null"})}else if(Mo in kt){var h=kt[Mo];return Jo(h,function(c,p){var m=c.invoke(p,h),E=c.shared,S=E.framebuffer,M=p.def(S,".getFramebuffer(",m,")");J.optional(function(){c.assert(p,"!"+m+"||"+M,"invalid framebuffer object")}),p.set(S,".next",M);var k=E.context;return p.set(k,"."+Tu,M+"?"+M+".width:"+k+"."+Sl),p.set(k,"."+wc,M+"?"+M+".height:"+k+"."+A0),M})}else return null}function xi(at,We,St){var kt=at.static,Ft=at.dynamic;function h(m){if(m in kt){var E=kt[m];J.commandType(E,"object","invalid "+m,St.commandStr);var S=!0,M=E.x|0,k=E.y|0,V,te;return"width"in E?(V=E.width|0,J.command(V>=0,"invalid "+m,St.commandStr)):S=!1,"height"in E?(te=E.height|0,J.command(te>=0,"invalid "+m,St.commandStr)):S=!1,new ys(!S&&We&&We.thisDep,!S&&We&&We.contextDep,!S&&We&&We.propDep,function(ut,gt){var rt=ut.shared.context,_t=V;"width"in E||(_t=gt.def(rt,".",Tu,"-",M));var $t=te;return"height"in E||($t=gt.def(rt,".",wc,"-",k)),[M,k,_t,$t]})}else if(m in Ft){var ve=Ft[m],Ne=Jo(ve,function(ut,gt){var rt=ut.invoke(gt,ve);J.optional(function(){ut.assert(gt,rt+"&&typeof "+rt+'==="object"',"invalid "+m)});var _t=ut.shared.context,$t=gt.def(rt,".x|0"),qt=gt.def(rt,".y|0"),Yt=gt.def('"width" in ',rt,"?",rt,".width|0:","(",_t,".",Tu,"-",$t,")"),rr=gt.def('"height" in ',rt,"?",rt,".height|0:","(",_t,".",wc,"-",qt,")");return J.optional(function(){ut.assert(gt,Yt+">=0&&"+rr+">=0","invalid "+m)}),[$t,qt,Yt,rr]});return We&&(Ne.thisDep=Ne.thisDep||We.thisDep,Ne.contextDep=Ne.contextDep||We.contextDep,Ne.propDep=Ne.propDep||We.propDep),Ne}else return We?new ys(We.thisDep,We.contextDep,We.propDep,function(ut,gt){var rt=ut.shared.context;return[0,0,gt.def(rt,".",Tu),gt.def(rt,".",wc)]}):null}var c=h(Bl);if(c){var p=c;c=new ys(c.thisDep,c.contextDep,c.propDep,function(m,E){var S=p.append(m,E),M=m.shared.context;return E.set(M,"."+Gu,S[2]),E.set(M,"."+sl,S[3]),S})}return{viewport:c,scissor_box:h(Uu)}}function Jn(at,We){var St=at.static,kt=typeof St[ls]=="string"&&typeof St[ol]=="string";if(kt){if(Object.keys(We.dynamic).length>0)return null;var Ft=We.static,h=Object.keys(Ft);if(h.length>0&&typeof Ft[h[0]]=="number"){for(var c=[],p=0;p<h.length;++p)J(typeof Ft[h[p]]=="number","must specify all vertex attribute locations when using vaos"),c.push([Ft[h[p]]|0,h[p]]);return c}}return null}function yi(at,We,St){var kt=at.static,Ft=at.dynamic;function h(S){if(S in kt){var M=Ke.id(kt[S]);J.optional(function(){Dr.shader(m0[S],M,J.guessCommand())});var k=Ia(function(){return M});return k.id=M,k}else if(S in Ft){var V=Ft[S];return Jo(V,function(te,ve){var Ne=te.invoke(ve,V),ut=ve.def(te.shared.strings,".id(",Ne,")");return J.optional(function(){ve(te.shared.shader,".shader(",m0[S],",",ut,",",te.command,");")}),ut})}return null}var c=h(ls),p=h(ol),m=null,E;return ll(c)&&ll(p)?(m=Dr.program(p.id,c.id,null,St),E=Ia(function(S,M){return S.link(m)})):E=new ys(c&&c.thisDep||p&&p.thisDep,c&&c.contextDep||p&&p.contextDep,c&&c.propDep||p&&p.propDep,function(S,M){var k=S.shared.shader,V;c?V=c.append(S,M):V=M.def(k,".",ls);var te;p?te=p.append(S,M):te=M.def(k,".",ol);var ve=k+".program("+te+","+V;return J.optional(function(){ve+=","+S.command}),M.def(ve+")")}),{frag:c,vert:p,progVar:E,program:m}}function ta(at,We){var St=at.static,kt=at.dynamic;function Ft(){if(ic in St){var S=St[ic];lf(S)?S=er.getElements(er.create(S,!0)):S&&(S=er.getElements(S),J.command(S,"invalid elements",We.commandStr));var M=Ia(function(V,te){if(S){var ve=V.link(S);return V.ELEMENTS=ve,ve}return V.ELEMENTS=null,null});return M.value=S,M}else if(ic in kt){var k=kt[ic];return Jo(k,function(V,te){var ve=V.shared,Ne=ve.isBufferArgs,ut=ve.elements,gt=V.invoke(te,k),rt=te.def("null"),_t=te.def(Ne,"(",gt,")"),$t=V.cond(_t).then(rt,"=",ut,".createStream(",gt,");").else(rt,"=",ut,".getElements(",gt,");");return J.optional(function(){V.assert($t.else,"!"+gt+"||"+rt,"invalid elements")}),te.entry($t),te.exit(V.cond(_t).then(ut,".destroyStream(",rt,");")),V.ELEMENTS=rt,rt})}return null}var h=Ft();function c(){if(Sc in St){var S=St[Sc];return J.commandParameter(S,Us,"invalid primitve",We.commandStr),Ia(function(k,V){return Us[S]})}else if(Sc in kt){var M=kt[Sc];return Jo(M,function(k,V){var te=k.constants.primTypes,ve=k.invoke(V,M);return J.optional(function(){k.assert(V,ve+" in "+te,"invalid primitive, must be one of "+Object.keys(Us))}),V.def(te,"[",ve,"]")})}else if(h)return ll(h)?h.value?Ia(function(k,V){return V.def(k.ELEMENTS,".primType")}):Ia(function(){return uc}):new ys(h.thisDep,h.contextDep,h.propDep,function(k,V){var te=k.ELEMENTS;return V.def(te,"?",te,".primType:",uc)});return null}function p(S,M){if(S in St){var k=St[S]|0;return J.command(!M||k>=0,"invalid "+S,We.commandStr),Ia(function(te,ve){return M&&(te.OFFSET=k),k})}else if(S in kt){var V=kt[S];return Jo(V,function(te,ve){var Ne=te.invoke(ve,V);return M&&(te.OFFSET=Ne,J.optional(function(){te.assert(ve,Ne+">=0","invalid "+S)})),Ne})}else if(M&&h)return Ia(function(te,ve){return te.OFFSET="0",0});return null}var m=p(h0,!0);function E(){if(Zl in St){var S=St[Zl]|0;return J.command(typeof S=="number"&&S>=0,"invalid vertex count",We.commandStr),Ia(function(){return S})}else if(Zl in kt){var M=kt[Zl];return Jo(M,function(te,ve){var Ne=te.invoke(ve,M);return J.optional(function(){te.assert(ve,"typeof "+Ne+'==="number"&&'+Ne+">=0&&"+Ne+"===("+Ne+"|0)","invalid vertex count")}),Ne})}else if(h)if(ll(h)){if(h)return m?new ys(m.thisDep,m.contextDep,m.propDep,function(te,ve){var Ne=ve.def(te.ELEMENTS,".vertCount-",te.OFFSET);return J.optional(function(){te.assert(ve,Ne+">=0","invalid vertex offset/element buffer too small")}),Ne}):Ia(function(te,ve){return ve.def(te.ELEMENTS,".vertCount")});var k=Ia(function(){return-1});return J.optional(function(){k.MISSING=!0}),k}else{var V=new ys(h.thisDep||m.thisDep,h.contextDep||m.contextDep,h.propDep||m.propDep,function(te,ve){var Ne=te.ELEMENTS;return te.OFFSET?ve.def(Ne,"?",Ne,".vertCount-",te.OFFSET,":-1"):ve.def(Ne,"?",Ne,".vertCount:-1")});return J.optional(function(){V.DYNAMIC=!0}),V}return null}return{elements:h,primitive:c(),count:E(),instances:p(jf,!1),offset:m}}function bo(at,We){var St=at.static,kt=at.dynamic,Ft={};return Cr.forEach(function(h){var c=Yr(h);function p(m,E){if(h in St){var S=m(St[h]);Ft[c]=Ia(function(){return S})}else if(h in kt){var M=kt[h];Ft[c]=Jo(M,function(k,V){return E(k,V,k.invoke(V,M))})}}switch(h){case c0:case l0:case z0:case Xi:case Eh:case oo:case Zf:case zf:case f0:case bc:return p(function(m){return J.commandType(m,"boolean",h,We.commandStr),m},function(m,E,S){return J.optional(function(){m.assert(E,"typeof "+S+'==="boolean"',"invalid flag "+h,m.commandStr)}),S});case Bf:return p(function(m){return J.commandParameter(m,kc,"invalid "+h,We.commandStr),kc[m]},function(m,E,S){var M=m.constants.compareFuncs;return J.optional(function(){m.assert(E,S+" in "+M,"invalid "+h+", must be one of "+Object.keys(kc))}),E.def(M,"[",S,"]")});case Nl:return p(function(m){return J.command(Za(m)&&m.length===2&&typeof m[0]=="number"&&typeof m[1]=="number"&&m[0]<=m[1],"depth range is 2d array",We.commandStr),m},function(m,E,S){J.optional(function(){m.assert(E,m.shared.isArrayLike+"("+S+")&&"+S+".length===2&&typeof "+S+'[0]==="number"&&typeof '+S+'[1]==="number"&&'+S+"[0]<="+S+"[1]","depth range must be a 2d array")});var M=E.def("+",S,"[0]"),k=E.def("+",S,"[1]");return[M,k]});case Ff:return p(function(m){J.commandType(m,"object","blend.func",We.commandStr);var E="srcRGB"in m?m.srcRGB:m.src,S="srcAlpha"in m?m.srcAlpha:m.src,M="dstRGB"in m?m.dstRGB:m.dst,k="dstAlpha"in m?m.dstAlpha:m.dst;return J.commandParameter(E,Ps,c+".srcRGB",We.commandStr),J.commandParameter(S,Ps,c+".srcAlpha",We.commandStr),J.commandParameter(M,Ps,c+".dstRGB",We.commandStr),J.commandParameter(k,Ps,c+".dstAlpha",We.commandStr),J.command(Rc.indexOf(E+", "+M)===-1,"unallowed blending combination (srcRGB, dstRGB) = ("+E+", "+M+")",We.commandStr),[Ps[E],Ps[M],Ps[S],Ps[k]]},function(m,E,S){var M=m.constants.blendFuncs;J.optional(function(){m.assert(E,S+"&&typeof "+S+'==="object"',"invalid blend func, must be an object")});function k(rt,_t){var $t=E.def('"',rt,_t,'" in ',S,"?",S,".",rt,_t,":",S,".",rt);return J.optional(function(){m.assert(E,$t+" in "+M,"invalid "+h+"."+rt+_t+", must be one of "+Object.keys(Ps))}),$t}var V=k("src","RGB"),te=k("dst","RGB");J.optional(function(){var rt=m.constants.invalidBlendCombinations;m.assert(E,rt+".indexOf("+V+'+", "+'+te+") === -1 ","unallowed blending combination for (srcRGB, dstRGB)")});var ve=E.def(M,"[",V,"]"),Ne=E.def(M,"[",k("src","Alpha"),"]"),ut=E.def(M,"[",te,"]"),gt=E.def(M,"[",k("dst","Alpha"),"]");return[ve,ut,Ne,gt]});case Uo:return p(function(m){if(typeof m=="string")return J.commandParameter(m,lr,"invalid "+h,We.commandStr),[lr[m],lr[m]];if(typeof m=="object")return J.commandParameter(m.rgb,lr,h+".rgb",We.commandStr),J.commandParameter(m.alpha,lr,h+".alpha",We.commandStr),[lr[m.rgb],lr[m.alpha]];J.commandRaise("invalid blend.equation",We.commandStr)},function(m,E,S){var M=m.constants.blendEquations,k=E.def(),V=E.def(),te=m.cond("typeof ",S,'==="string"');return J.optional(function(){function ve(Ne,ut,gt){m.assert(Ne,gt+" in "+M,"invalid "+ut+", must be one of "+Object.keys(lr))}ve(te.then,h,S),m.assert(te.else,S+"&&typeof "+S+'==="object"',"invalid "+h),ve(te.else,h+".rgb",S+".rgb"),ve(te.else,h+".alpha",S+".alpha")}),te.then(k,"=",V,"=",M,"[",S,"];"),te.else(k,"=",M,"[",S,".rgb];",V,"=",M,"[",S,".alpha];"),E(te),[k,V]});case zu:return p(function(m){return J.command(Za(m)&&m.length===4,"blend.color must be a 4d array",We.commandStr),xn(4,function(E){return+m[E]})},function(m,E,S){return J.optional(function(){m.assert(E,m.shared.isArrayLike+"("+S+")&&"+S+".length===4","blend.color must be a 4d array")}),xn(4,function(M){return E.def("+",S,"[",M,"]")})});case Gf:return p(function(m){return J.commandType(m,"number",c,We.commandStr),m|0},function(m,E,S){return J.optional(function(){m.assert(E,"typeof "+S+'==="number"',"invalid stencil.mask")}),E.def(S,"|0")});case Fl:return p(function(m){J.commandType(m,"object",c,We.commandStr);var E=m.cmp||"keep",S=m.ref||0,M="mask"in m?m.mask:-1;return J.commandParameter(E,kc,h+".cmp",We.commandStr),J.commandType(S,"number",h+".ref",We.commandStr),J.commandType(M,"number",h+".mask",We.commandStr),[kc[E],S,M]},function(m,E,S){var M=m.constants.compareFuncs;J.optional(function(){function ve(){m.assert(E,Array.prototype.join.call(arguments,""),"invalid stencil.func")}ve(S+"&&typeof ",S,'==="object"'),ve('!("cmp" in ',S,")||(",S,".cmp in ",M,")")});var k=E.def('"cmp" in ',S,"?",M,"[",S,".cmp]",":",ju),V=E.def(S,".ref|0"),te=E.def('"mask" in ',S,"?",S,".mask|0:-1");return[k,V,te]});case iu:case nc:return p(function(m){J.commandType(m,"object",c,We.commandStr);var E=m.fail||"keep",S=m.zfail||"keep",M=m.zpass||"keep";return J.commandParameter(E,Tl,h+".fail",We.commandStr),J.commandParameter(S,Tl,h+".zfail",We.commandStr),J.commandParameter(M,Tl,h+".zpass",We.commandStr),[h===nc?Hl:Vl,Tl[E],Tl[S],Tl[M]]},function(m,E,S){var M=m.constants.stencilOps;J.optional(function(){m.assert(E,S+"&&typeof "+S+'==="object"',"invalid "+h)});function k(V){return J.optional(function(){m.assert(E,'!("'+V+'" in '+S+")||("+S+"."+V+" in "+M+")","invalid "+h+"."+V+", must be one of "+Object.keys(Tl))}),E.def('"',V,'" in ',S,"?",M,"[",S,".",V,"]:",ju)}return[h===nc?Hl:Vl,k("fail"),k("zfail"),k("zpass")]});case U0:return p(function(m){J.commandType(m,"object",c,We.commandStr);var E=m.factor|0,S=m.units|0;return J.commandType(E,"number",c+".factor",We.commandStr),J.commandType(S,"number",c+".units",We.commandStr),[E,S]},function(m,E,S){J.optional(function(){m.assert(E,S+"&&typeof "+S+'==="object"',"invalid "+h)});var M=E.def(S,".factor|0"),k=E.def(S,".units|0");return[M,k]});case fa:return p(function(m){var E=0;return m==="front"?E=Vl:m==="back"&&(E=Hl),J.command(!!E,c,We.commandStr),E},function(m,E,S){return J.optional(function(){m.assert(E,S+'==="front"||'+S+'==="back"',"invalid cull.face")}),E.def(S,'==="front"?',Vl,":",Hl)});case Go:return p(function(m){return J.command(typeof m=="number"&&m>=nr.lineWidthDims[0]&&m<=nr.lineWidthDims[1],"invalid line width, must be a positive number between "+nr.lineWidthDims[0]+" and "+nr.lineWidthDims[1],We.commandStr),m},function(m,E,S){return J.optional(function(){m.assert(E,"typeof "+S+'==="number"&&'+S+">="+nr.lineWidthDims[0]+"&&"+S+"<="+nr.lineWidthDims[1],"invalid line width")}),S});case za:return p(function(m){return J.commandParameter(m,uf,c,We.commandStr),uf[m]},function(m,E,S){return J.optional(function(){m.assert(E,S+'==="cw"||'+S+'==="ccw"',"invalid frontFace, must be one of cw,ccw")}),E.def(S+'==="cw"?'+v0+":"+g0)});case nf:return p(function(m){return J.command(Za(m)&&m.length===4,"color.mask must be length 4 array",We.commandStr),m.map(function(E){return!!E})},function(m,E,S){return J.optional(function(){m.assert(E,m.shared.isArrayLike+"("+S+")&&"+S+".length===4","invalid color.mask")}),xn(4,function(M){return"!!"+S+"["+M+"]"})});case Uf:return p(function(m){J.command(typeof m=="object"&&m,c,We.commandStr);var E="value"in m?m.value:1,S=!!m.invert;return J.command(typeof E=="number"&&E>=0&&E<=1,"sample.coverage.value must be a number between 0 and 1",We.commandStr),[E,S]},function(m,E,S){J.optional(function(){m.assert(E,S+"&&typeof "+S+'==="object"',"invalid sample.coverage")});var M=E.def('"value" in ',S,"?+",S,".value:1"),k=E.def("!!",S,".invert");return[M,k]})}}),Ft}function ro(at,We){var St=at.static,kt=at.dynamic,Ft={};return Object.keys(St).forEach(function(h){var c=St[h],p;if(typeof c=="number"||typeof c=="boolean")p=Ia(function(){return c});else if(typeof c=="function"){var m=c._reglType;m==="texture2d"||m==="textureCube"?p=Ia(function(E){return E.link(c)}):m==="framebuffer"||m==="framebufferCube"?(J.command(c.color.length>0,'missing color attachment for framebuffer sent to uniform "'+h+'"',We.commandStr),p=Ia(function(E){return E.link(c.color[0])})):J.commandRaise('invalid data for uniform "'+h+'"',We.commandStr)}else Za(c)?p=Ia(function(E){var S=E.global.def("[",xn(c.length,function(M){return J.command(typeof c[M]=="number"||typeof c[M]=="boolean","invalid uniform "+h,E.commandStr),c[M]}),"]");return S}):J.commandRaise('invalid or missing data for uniform "'+h+'"',We.commandStr);p.value=c,Ft[h]=p}),Object.keys(kt).forEach(function(h){var c=kt[h];Ft[h]=Jo(c,function(p,m){return p.invoke(m,c)})}),Ft}function Ti(at,We){var St=at.static,kt=at.dynamic,Ft={};return Object.keys(St).forEach(function(h){var c=St[h],p=Ke.id(h),m=new Vt;if(lf(c))m.state=tf,m.buffer=Ar.getBuffer(Ar.create(c,ac,!1,!0)),m.type=0;else{var E=Ar.getBuffer(c);if(E)m.state=tf,m.buffer=E,m.type=0;else if(J.command(typeof c=="object"&&c,"invalid data for attribute "+h,We.commandStr),"constant"in c){var S=c.constant;m.buffer="null",m.state=et,typeof S=="number"?m.x=S:(J.command(Za(S)&&S.length>0&&S.length<=4,"invalid constant for attribute "+h,We.commandStr),xc.forEach(function(ut,gt){gt<S.length&&(m[ut]=S[gt])}))}else{lf(c.buffer)?E=Ar.getBuffer(Ar.create(c.buffer,ac,!1,!0)):E=Ar.getBuffer(c.buffer),J.command(!!E,'missing buffer for attribute "'+h+'"',We.commandStr);var M=c.offset|0;J.command(M>=0,'invalid offset for attribute "'+h+'"',We.commandStr);var k=c.stride|0;J.command(k>=0&&k<256,'invalid stride for attribute "'+h+'", must be integer betweeen [0, 255]',We.commandStr);var V=c.size|0;J.command(!("size"in c)||V>0&&V<=4,'invalid size for attribute "'+h+'", must be 1,2,3,4',We.commandStr);var te=!!c.normalized,ve=0;"type"in c&&(J.commandParameter(c.type,qa,"invalid type for attribute "+h,We.commandStr),ve=qa[c.type]);var Ne=c.divisor|0;"divisor"in c&&(J.command(Ne===0||Rr,'cannot specify divisor for attribute "'+h+'", instancing not supported',We.commandStr),J.command(Ne>=0,'invalid divisor for attribute "'+h+'"',We.commandStr)),J.optional(function(){var ut=We.commandStr,gt=["buffer","offset","divisor","normalized","type","size","stride"];Object.keys(c).forEach(function(rt){J.command(gt.indexOf(rt)>=0,'unknown parameter "'+rt+'" for attribute pointer "'+h+'" (valid parameters are '+gt+")",ut)})}),m.buffer=E,m.state=tf,m.size=V,m.normalized=te,m.type=ve||E.dtype,m.offset=M,m.stride=k,m.divisor=Ne}}Ft[h]=Ia(function(ut,gt){var rt=ut.attribCache;if(p in rt)return rt[p];var _t={isStream:!1};return Object.keys(m).forEach(function($t){_t[$t]=m[$t]}),m.buffer&&(_t.buffer=ut.link(m.buffer),_t.type=_t.type||_t.buffer+".dtype"),rt[p]=_t,_t})}),Object.keys(kt).forEach(function(h){var c=kt[h];function p(m,E){var S=m.invoke(E,c),M=m.shared,k=m.constants,V=M.isBufferArgs,te=M.buffer;J.optional(function(){m.assert(E,S+"&&(typeof "+S+'==="object"||typeof '+S+'==="function")&&('+V+"("+S+")||"+te+".getBuffer("+S+")||"+te+".getBuffer("+S+".buffer)||"+V+"("+S+'.buffer)||("constant" in '+S+"&&(typeof "+S+'.constant==="number"||'+M.isArrayLike+"("+S+".constant))))",'invalid dynamic attribute "'+h+'"')});var ve={isStream:E.def(!1)},Ne=new Vt;Ne.state=tf,Object.keys(Ne).forEach(function(_t){ve[_t]=E.def(""+Ne[_t])});var ut=ve.buffer,gt=ve.type;E("if(",V,"(",S,")){",ve.isStream,"=true;",ut,"=",te,".createStream(",ac,",",S,");",gt,"=",ut,".dtype;","}else{",ut,"=",te,".getBuffer(",S,");","if(",ut,"){",gt,"=",ut,".dtype;",'}else if("constant" in ',S,"){",ve.state,"=",et,";","if(typeof "+S+'.constant === "number"){',ve[xc[0]],"=",S,".constant;",xc.slice(1).map(function(_t){return ve[_t]}).join("="),"=0;","}else{",xc.map(function(_t,$t){return ve[_t]+"="+S+".constant.length>"+$t+"?"+S+".constant["+$t+"]:0;"}).join(""),"}}else{","if(",V,"(",S,".buffer)){",ut,"=",te,".createStream(",ac,",",S,".buffer);","}else{",ut,"=",te,".getBuffer(",S,".buffer);","}",gt,'="type" in ',S,"?",k.glTypes,"[",S,".type]:",ut,".dtype;",ve.normalized,"=!!",S,".normalized;");function rt(_t){E(ve[_t],"=",S,".",_t,"|0;")}return rt("size"),rt("offset"),rt("stride"),rt("divisor"),E("}}"),E.exit("if(",ve.isStream,"){",te,".destroyStream(",ut,");","}"),ve}Ft[h]=Jo(c,p)}),Ft}function Io(at,We){var St=at.static,kt=at.dynamic;if(af in St){var Ft=St[af];return Ft!==null&&Nr.getVAO(Ft)===null&&(Ft=Nr.createVAO(Ft)),Ia(function(c){return c.link(Nr.getVAO(Ft))})}else if(af in kt){var h=kt[af];return Jo(h,function(c,p){var m=c.invoke(p,h);return p.def(c.shared.vao+".getVAO("+m+")")})}return null}function Na(at){var We=at.static,St=at.dynamic,kt={};return Object.keys(We).forEach(function(Ft){var h=We[Ft];kt[Ft]=Ia(function(c,p){return typeof h=="number"||typeof h=="boolean"?""+h:c.link(h)})}),Object.keys(St).forEach(function(Ft){var h=St[Ft];kt[Ft]=Jo(h,function(c,p){return c.invoke(p,h)})}),kt}function Ao(at,We,St,kt,Ft){var h=at.static,c=at.dynamic;J.optional(function(){var rt=[Mo,ol,ls,ic,Sc,h0,Zl,jf,Ef,af].concat(Cr);function _t($t){Object.keys($t).forEach(function(qt){J.command(rt.indexOf(qt)>=0,'unknown parameter "'+qt+'"',Ft.commandStr)})}_t(h),_t(c)});var p=Jn(at,We),m=gn(at,Ft),E=xi(at,m,Ft),S=ta(at,Ft),M=bo(at,Ft),k=yi(at,Ft,p);function V(rt){var _t=E[rt];_t&&(M[rt]=_t)}V(Bl),V(Yr(Uu));var te=Object.keys(M).length>0,ve={framebuffer:m,draw:S,shader:k,state:M,dirty:te,scopeVAO:null,drawVAO:null,useVAO:!1,attributes:{}};if(ve.profile=Bn(at,Ft),ve.uniforms=ro(St,Ft),ve.drawVAO=ve.scopeVAO=Io(at,Ft),!ve.drawVAO&&k.program&&!p&&mt.angle_instanced_arrays){var Ne=!0,ut=k.program.attributes.map(function(rt){var _t=We.static[rt];return Ne=Ne&&!!_t,_t});if(Ne&&ut.length>0){var gt=Nr.getVAO(Nr.createVAO(ut));ve.drawVAO=new ys(null,null,null,function(rt,_t){return rt.link(gt)}),ve.useVAO=!0}}return p?ve.useVAO=!0:ve.attributes=Ti(We,Ft),ve.context=Na(kt,Ft),ve}function jo(at,We,St){var kt=at.shared,Ft=kt.context,h=at.scope();Object.keys(St).forEach(function(c){We.save(Ft,"."+c);var p=St[c],m=p.append(at,We);Array.isArray(m)?h(Ft,".",c,"=[",m.join(),"];"):h(Ft,".",c,"=",m,";")}),We(h)}function Fa(at,We,St,kt){var Ft=at.shared,h=Ft.gl,c=Ft.framebuffer,p;tn&&(p=We.def(Ft.extensions,".webgl_draw_buffers"));var m=at.constants,E=m.drawBuffer,S=m.backBuffer,M;St?M=St.append(at,We):M=We.def(c,".next"),kt||We("if(",M,"!==",c,".cur){"),We("if(",M,"){",h,".bindFramebuffer(",$l,",",M,".framebuffer);"),tn&&We(p,".drawBuffersWEBGL(",E,"[",M,".colorAttachments.length]);"),We("}else{",h,".bindFramebuffer(",$l,",null);"),tn&&We(p,".drawBuffersWEBGL(",S,");"),We("}",c,".cur=",M,";"),kt||We("}")}function Ua(at,We,St){var kt=at.shared,Ft=kt.gl,h=at.current,c=at.next,p=kt.current,m=kt.next,E=at.cond(p,".dirty");Cr.forEach(function(S){var M=Yr(S);if(!(M in St.state)){var k,V;if(M in c){k=c[M],V=h[M];var te=xn(mr[M].length,function(Ne){return E.def(k,"[",Ne,"]")});E(at.cond(te.map(function(Ne,ut){return Ne+"!=="+V+"["+ut+"]"}).join("||")).then(Ft,".",Er[M],"(",te,");",te.map(function(Ne,ut){return V+"["+ut+"]="+Ne}).join(";"),";"))}else{k=E.def(m,".",M);var ve=at.cond(k,"!==",p,".",M);E(ve),M in Hr?ve(at.cond(k).then(Ft,".enable(",Hr[M],");").else(Ft,".disable(",Hr[M],");"),p,".",M,"=",k,";"):ve(Ft,".",Er[M],"(",k,");",p,".",M,"=",k,";")}}}),Object.keys(St.state).length===0&&E(p,".dirty=false;"),We(E)}function Tn(at,We,St,kt){var Ft=at.shared,h=at.current,c=Ft.current,p=Ft.gl;Cf(Object.keys(St)).forEach(function(m){var E=St[m];if(!(kt&&!kt(E))){var S=E.append(at,We);if(Hr[m]){var M=Hr[m];ll(E)?S?We(p,".enable(",M,");"):We(p,".disable(",M,");"):We(at.cond(S).then(p,".enable(",M,");").else(p,".disable(",M,");")),We(c,".",m,"=",S,";")}else if(Za(S)){var k=h[m];We(p,".",Er[m],"(",S,");",S.map(function(V,te){return k+"["+te+"]="+V}).join(";"),";")}else We(p,".",Er[m],"(",S,");",c,".",m,"=",S,";")}})}function ga(at,We){Rr&&(at.instancing=We.def(at.shared.extensions,".angle_instanced_arrays"))}function un(at,We,St,kt,Ft){var h=at.shared,c=at.stats,p=h.current,m=h.timer,E=St.profile;function S(){return typeof performance=="undefined"?"Date.now()":"performance.now()"}var M,k;function V(rt){M=We.def(),rt(M,"=",S(),";"),typeof Ft=="string"?rt(c,".count+=",Ft,";"):rt(c,".count++;"),Tr&&(kt?(k=We.def(),rt(k,"=",m,".getNumPendingQueries();")):rt(m,".beginQuery(",c,");"))}function te(rt){rt(c,".cpuTime+=",S(),"-",M,";"),Tr&&(kt?rt(m,".pushScopeStats(",k,",",m,".getNumPendingQueries(),",c,");"):rt(m,".endQuery();"))}function ve(rt){var _t=We.def(p,".profile");We(p,".profile=",rt,";"),We.exit(p,".profile=",_t,";")}var Ne;if(E){if(ll(E)){E.enable?(V(We),te(We.exit),ve("true")):ve("false");return}Ne=E.append(at,We),ve(Ne)}else Ne=We.def(p,".profile");var ut=at.block();V(ut),We("if(",Ne,"){",ut,"}");var gt=at.block();te(gt),We.exit("if(",Ne,"){",gt,"}")}function Aa(at,We,St,kt,Ft){var h=at.shared;function c(m){switch(m){case Mc:case Ys:case Ul:return 2;case Ic:case zl:case Lc:return 3;case Sf:case sc:case of:return 4;default:return 1}}function p(m,E,S){var M=h.gl,k=We.def(m,".location"),V=We.def(h.attributes,"[",k,"]"),te=S.state,ve=S.buffer,Ne=[S.x,S.y,S.z,S.w],ut=["buffer","normalized","offset","stride"];function gt(){We("if(!",V,".buffer){",M,".enableVertexAttribArray(",k,");}");var _t=S.type,$t;if(S.size?$t=We.def(S.size,"||",E):$t=E,We("if(",V,".type!==",_t,"||",V,".size!==",$t,"||",ut.map(function(Yt){return V+"."+Yt+"!=="+S[Yt]}).join("||"),"){",M,".bindBuffer(",ac,",",ve,".buffer);",M,".vertexAttribPointer(",[k,$t,_t,S.normalized,S.stride,S.offset],");",V,".type=",_t,";",V,".size=",$t,";",ut.map(function(Yt){return V+"."+Yt+"="+S[Yt]+";"}).join(""),"}"),Rr){var qt=S.divisor;We("if(",V,".divisor!==",qt,"){",at.instancing,".vertexAttribDivisorANGLE(",[k,qt],");",V,".divisor=",qt,";}")}}function rt(){We("if(",V,".buffer){",M,".disableVertexAttribArray(",k,");",V,".buffer=null;","}if(",xc.map(function(_t,$t){return V+"."+_t+"!=="+Ne[$t]}).join("||"),"){",M,".vertexAttrib4f(",k,",",Ne,");",xc.map(function(_t,$t){return V+"."+_t+"="+Ne[$t]+";"}).join(""),"}")}te===tf?gt():te===et?rt():(We("if(",te,"===",tf,"){"),gt(),We("}else{"),rt(),We("}"))}kt.forEach(function(m){var E=m.name,S=St.attributes[E],M;if(S){if(!Ft(S))return;M=S.append(at,We)}else{if(!Ft(lc))return;var k=at.scopeAttrib(E);J.optional(function(){at.assert(We,k+".state","missing attribute "+E)}),M={},Object.keys(new Vt).forEach(function(V){M[V]=We.def(k,".",V)})}p(at.link(m),c(m.info.type),M)})}function ra(at,We,St,kt,Ft){for(var h=at.shared,c=h.gl,p,m=0;m<kt.length;++m){var E=kt[m],S=E.name,M=E.info.type,k=St.uniforms[S],V=at.link(E),te=V+".location",ve;if(k){if(!Ft(k))continue;if(ll(k)){var Ne=k.value;if(J.command(Ne!==null&&typeof Ne!="undefined",'missing uniform "'+S+'"',at.commandStr),M===Pc||M===jl){J.command(typeof Ne=="function"&&(M===Pc&&(Ne._reglType==="texture2d"||Ne._reglType==="framebuffer")||M===jl&&(Ne._reglType==="textureCube"||Ne._reglType==="framebufferCube")),"invalid texture for uniform "+S,at.commandStr);var ut=at.link(Ne._texture||Ne.color[0]._texture);We(c,".uniform1i(",te,",",ut+".bind());"),We.exit(ut,".unbind();")}else if(M===Gl||M===Cl||M===ha){J.optional(function(){J.command(Za(Ne),"invalid matrix for uniform "+S,at.commandStr),J.command(M===Gl&&Ne.length===4||M===Cl&&Ne.length===9||M===ha&&Ne.length===16,"invalid length for matrix uniform "+S,at.commandStr)});var gt=at.global.def("new Float32Array(["+Array.prototype.slice.call(Ne)+"])"),rt=2;M===Cl?rt=3:M===ha&&(rt=4),We(c,".uniformMatrix",rt,"fv(",te,",false,",gt,");")}else{switch(M){case $0:J.commandType(Ne,"number","uniform "+S,at.commandStr),p="1f";break;case Mc:J.command(Za(Ne)&&Ne.length===2,"uniform "+S,at.commandStr),p="2f";break;case Ic:J.command(Za(Ne)&&Ne.length===3,"uniform "+S,at.commandStr),p="3f";break;case Sf:J.command(Za(Ne)&&Ne.length===4,"uniform "+S,at.commandStr),p="4f";break;case ul:J.commandType(Ne,"boolean","uniform "+S,at.commandStr),p="1i";break;case Eo:J.commandType(Ne,"number","uniform "+S,at.commandStr),p="1i";break;case Ul:J.command(Za(Ne)&&Ne.length===2,"uniform "+S,at.commandStr),p="2i";break;case Ys:J.command(Za(Ne)&&Ne.length===2,"uniform "+S,at.commandStr),p="2i";break;case Lc:J.command(Za(Ne)&&Ne.length===3,"uniform "+S,at.commandStr),p="3i";break;case zl:J.command(Za(Ne)&&Ne.length===3,"uniform "+S,at.commandStr),p="3i";break;case of:J.command(Za(Ne)&&Ne.length===4,"uniform "+S,at.commandStr),p="4i";break;case sc:J.command(Za(Ne)&&Ne.length===4,"uniform "+S,at.commandStr),p="4i";break}We(c,".uniform",p,"(",te,",",Za(Ne)?Array.prototype.slice.call(Ne):Ne,");")}continue}else ve=k.append(at,We)}else{if(!Ft(lc))continue;ve=We.def(h.uniforms,"[",Ke.id(S),"]")}M===Pc?(J(!Array.isArray(ve),"must specify a scalar prop for textures"),We("if(",ve,"&&",ve,'._reglType==="framebuffer"){',ve,"=",ve,".color[0];","}")):M===jl&&(J(!Array.isArray(ve),"must specify a scalar prop for cube maps"),We("if(",ve,"&&",ve,'._reglType==="framebufferCube"){',ve,"=",ve,".color[0];","}")),J.optional(function(){function rr(Kr,pn){at.assert(We,Kr,'bad data or missing for uniform "'+S+'".  '+pn)}function Wt(Kr){J(!Array.isArray(ve),"must not specify an array type for uniform"),rr("typeof "+ve+'==="'+Kr+'"',"invalid type, expected "+Kr)}function rn(Kr,pn){Array.isArray(ve)?J(ve.length===Kr,"must have length "+Kr):rr(h.isArrayLike+"("+ve+")&&"+ve+".length==="+Kr,"invalid vector, should have length "+Kr,at.commandStr)}function En(Kr){J(!Array.isArray(ve),"must not specify a value type"),rr("typeof "+ve+'==="function"&&'+ve+'._reglType==="texture'+(Kr===p0?"2d":"Cube")+'"',"invalid texture type",at.commandStr)}switch(M){case Eo:Wt("number");break;case Ys:rn(2,"number");break;case zl:rn(3,"number");break;case sc:rn(4,"number");break;case $0:Wt("number");break;case Mc:rn(2,"number");break;case Ic:rn(3,"number");break;case Sf:rn(4,"number");break;case ul:Wt("boolean");break;case Ul:rn(2,"boolean");break;case Lc:rn(3,"boolean");break;case of:rn(4,"boolean");break;case Gl:rn(4,"number");break;case Cl:rn(9,"number");break;case ha:rn(16,"number");break;case Pc:En(p0);break;case jl:En(d0);break}});var _t=1;switch(M){case Pc:case jl:var $t=We.def(ve,"._texture");We(c,".uniform1i(",te,",",$t,".bind());"),We.exit($t,".unbind();");continue;case Eo:case ul:p="1i";break;case Ys:case Ul:p="2i",_t=2;break;case zl:case Lc:p="3i",_t=3;break;case sc:case of:p="4i",_t=4;break;case $0:p="1f";break;case Mc:p="2f",_t=2;break;case Ic:p="3f",_t=3;break;case Sf:p="4f",_t=4;break;case Gl:p="Matrix2fv";break;case Cl:p="Matrix3fv";break;case ha:p="Matrix4fv";break}if(We(c,".uniform",p,"(",te,","),p.charAt(0)==="M"){var qt=Math.pow(M-Gl+2,2),Yt=at.global.def("new Float32Array(",qt,")");Array.isArray(ve)?We("false,(",xn(qt,function(rr){return Yt+"["+rr+"]="+ve[rr]}),",",Yt,")"):We("false,(Array.isArray(",ve,")||",ve," instanceof Float32Array)?",ve,":(",xn(qt,function(rr){return Yt+"["+rr+"]="+ve+"["+rr+"]"}),",",Yt,")")}else _t>1?We(xn(_t,function(rr){return Array.isArray(ve)?ve[rr]:ve+"["+rr+"]"})):(J(!Array.isArray(ve),"uniform value must not be an array"),We(ve));We(");")}}function Rn(at,We,St,kt){var Ft=at.shared,h=Ft.gl,c=Ft.draw,p=kt.draw;function m(){var $t=p.elements,qt,Yt=We;return $t?(($t.contextDep&&kt.contextDynamic||$t.propDep)&&(Yt=St),qt=$t.append(at,Yt)):qt=Yt.def(c,".",ic),qt&&Yt("if("+qt+")"+h+".bindBuffer("+bh+","+qt+".buffer.buffer);"),qt}function E(){var $t=p.count,qt,Yt=We;return $t?(($t.contextDep&&kt.contextDynamic||$t.propDep)&&(Yt=St),qt=$t.append(at,Yt),J.optional(function(){$t.MISSING&&at.assert(We,"false","missing vertex count"),$t.DYNAMIC&&at.assert(Yt,qt+">=0","missing vertex count")})):(qt=Yt.def(c,".",Zl),J.optional(function(){at.assert(Yt,qt+">=0","missing vertex count")})),qt}var S=m();function M($t){var qt=p[$t];return qt?qt.contextDep&&kt.contextDynamic||qt.propDep?qt.append(at,St):qt.append(at,We):We.def(c,".",$t)}var k=M(Sc),V=M(h0),te=E();if(typeof te=="number"){if(te===0)return}else St("if(",te,"){"),St.exit("}");var ve,Ne;Rr&&(ve=M(jf),Ne=at.instancing);var ut=S+".type",gt=p.elements&&ll(p.elements);function rt(){function $t(){St(Ne,".drawElementsInstancedANGLE(",[k,te,ut,V+"<<(("+ut+"-"+o0+")>>1)",ve],");")}function qt(){St(Ne,".drawArraysInstancedANGLE(",[k,V,te,ve],");")}S?gt?$t():(St("if(",S,"){"),$t(),St("}else{"),qt(),St("}")):qt()}function _t(){function $t(){St(h+".drawElements("+[k,te,ut,V+"<<(("+ut+"-"+o0+")>>1)"]+");")}function qt(){St(h+".drawArrays("+[k,V,te]+");")}S?gt?$t():(St("if(",S,"){"),$t(),St("}else{"),qt(),St("}")):qt()}Rr&&(typeof ve!="number"||ve>=0)?typeof ve=="string"?(St("if(",ve,">0){"),rt(),St("}else if(",ve,"<0){"),_t(),St("}")):rt():_t()}function gi(at,We,St,kt,Ft){var h=On(),c=h.proc("body",Ft);return J.optional(function(){h.commandStr=We.commandStr,h.command=h.link(We.commandStr)}),Rr&&(h.instancing=c.def(h.shared.extensions,".angle_instanced_arrays")),at(h,c,St,kt),h.compile().body}function dr(at,We,St,kt){ga(at,We),St.useVAO?St.drawVAO?We(at.shared.vao,".setVAO(",St.drawVAO.append(at,We),");"):We(at.shared.vao,".setVAO(",at.shared.vao,".targetVAO);"):(We(at.shared.vao,".setVAO(null);"),Aa(at,We,St,kt.attributes,function(){return!0})),ra(at,We,St,kt.uniforms,function(){return!0}),Rn(at,We,We,St)}function Ri(at,We){var St=at.proc("draw",1);ga(at,St),jo(at,St,We.context),Fa(at,St,We.framebuffer),Ua(at,St,We),Tn(at,St,We.state),un(at,St,We,!1,!0);var kt=We.shader.progVar.append(at,St);if(St(at.shared.gl,".useProgram(",kt,".program);"),We.shader.program)dr(at,St,We,We.shader.program);else{St(at.shared.vao,".setVAO(null);");var Ft=at.global.def("{}"),h=St.def(kt,".id"),c=St.def(Ft,"[",h,"]");St(at.cond(c).then(c,".call(this,a0);").else(c,"=",Ft,"[",h,"]=",at.link(function(p){return gi(dr,at,We,p,1)}),"(",kt,");",c,".call(this,a0);"))}Object.keys(We.state).length>0&&St(at.shared.current,".dirty=true;")}function Xt(at,We,St,kt){at.batchId="a1",ga(at,We);function Ft(){return!0}Aa(at,We,St,kt.attributes,Ft),ra(at,We,St,kt.uniforms,Ft),Rn(at,We,We,St)}function es(at,We,St,kt){ga(at,We);var Ft=St.contextDep,h=We.def(),c="a0",p="a1",m=We.def();at.shared.props=m,at.batchId=h;var E=at.scope(),S=at.scope();We(E.entry,"for(",h,"=0;",h,"<",p,";++",h,"){",m,"=",c,"[",h,"];",S,"}",E.exit);function M(ut){return ut.contextDep&&Ft||ut.propDep}function k(ut){return!M(ut)}if(St.needsContext&&jo(at,S,St.context),St.needsFramebuffer&&Fa(at,S,St.framebuffer),Tn(at,S,St.state,M),St.profile&&M(St.profile)&&un(at,S,St,!1,!0),kt)St.useVAO?St.drawVAO?M(St.drawVAO)?S(at.shared.vao,".setVAO(",St.drawVAO.append(at,S),");"):E(at.shared.vao,".setVAO(",St.drawVAO.append(at,E),");"):E(at.shared.vao,".setVAO(",at.shared.vao,".targetVAO);"):(E(at.shared.vao,".setVAO(null);"),Aa(at,E,St,kt.attributes,k),Aa(at,S,St,kt.attributes,M)),ra(at,E,St,kt.uniforms,k),ra(at,S,St,kt.uniforms,M),Rn(at,E,S,St);else{var V=at.global.def("{}"),te=St.shader.progVar.append(at,S),ve=S.def(te,".id"),Ne=S.def(V,"[",ve,"]");S(at.shared.gl,".useProgram(",te,".program);","if(!",Ne,"){",Ne,"=",V,"[",ve,"]=",at.link(function(ut){return gi(Xt,at,St,ut,2)}),"(",te,");}",Ne,".call(this,a0[",h,"],",h,");")}}function ct(at,We){var St=at.proc("batch",2);at.batchId="0",ga(at,St);var kt=!1,Ft=!0;Object.keys(We.context).forEach(function(V){kt=kt||We.context[V].propDep}),kt||(jo(at,St,We.context),Ft=!1);var h=We.framebuffer,c=!1;h?(h.propDep?kt=c=!0:h.contextDep&&kt&&(c=!0),c||Fa(at,St,h)):Fa(at,St,null),We.state.viewport&&We.state.viewport.propDep&&(kt=!0);function p(V){return V.contextDep&&kt||V.propDep}Ua(at,St,We),Tn(at,St,We.state,function(V){return!p(V)}),(!We.profile||!p(We.profile))&&un(at,St,We,!1,"a1"),We.contextDep=kt,We.needsContext=Ft,We.needsFramebuffer=c;var m=We.shader.progVar;if(m.contextDep&&kt||m.propDep)es(at,St,We,null);else{var E=m.append(at,St);if(St(at.shared.gl,".useProgram(",E,".program);"),We.shader.program)es(at,St,We,We.shader.program);else{St(at.shared.vao,".setVAO(null);");var S=at.global.def("{}"),M=St.def(E,".id"),k=St.def(S,"[",M,"]");St(at.cond(k).then(k,".call(this,a0,a1);").else(k,"=",S,"[",M,"]=",at.link(function(V){return gi(es,at,We,V,2)}),"(",E,");",k,".call(this,a0,a1);"))}}Object.keys(We.state).length>0&&St(at.shared.current,".dirty=true;")}function ft(at,We){var St=at.proc("scope",3);at.batchId="a2";var kt=at.shared,Ft=kt.current;jo(at,St,We.context),We.framebuffer&&We.framebuffer.append(at,St),Cf(Object.keys(We.state)).forEach(function(c){var p=We.state[c],m=p.append(at,St);Za(m)?m.forEach(function(E,S){St.set(at.next[c],"["+S+"]",E)}):St.set(kt.next,"."+c,m)}),un(at,St,We,!0,!0),[ic,h0,Zl,jf,Sc].forEach(function(c){var p=We.draw[c];p&&St.set(kt.draw,"."+c,""+p.append(at,St))}),Object.keys(We.uniforms).forEach(function(c){var p=We.uniforms[c].append(at,St);Array.isArray(p)&&(p="["+p.join()+"]"),St.set(kt.uniforms,"["+Ke.id(c)+"]",p)}),Object.keys(We.attributes).forEach(function(c){var p=We.attributes[c].append(at,St),m=at.scopeAttrib(c);Object.keys(new Vt).forEach(function(E){St.set(m,"."+E,p[E])})}),We.scopeVAO&&St.set(kt.vao,".targetVAO",We.scopeVAO.append(at,St));function h(c){var p=We.shader[c];p&&St.set(kt.shader,"."+c,p.append(at,St))}h(ol),h(ls),Object.keys(We.state).length>0&&(St(Ft,".dirty=true;"),St.exit(Ft,".dirty=true;")),St("a1(",at.shared.context,",a0,",at.batchId,");")}function xt(at){if(!(typeof at!="object"||Za(at))){for(var We=Object.keys(at),St=0;St<We.length;++St)if(Wr.isDynamic(at[We[St]]))return!0;return!1}}function Ur(at,We,St){var kt=We.static[St];if(!kt||!xt(kt))return;var Ft=at.global,h=Object.keys(kt),c=!1,p=!1,m=!1,E=at.global.def("{}");h.forEach(function(M){var k=kt[M];if(Wr.isDynamic(k)){typeof k=="function"&&(k=kt[M]=Wr.unbox(k));var V=Jo(k,null);c=c||V.thisDep,m=m||V.propDep,p=p||V.contextDep}else{switch(Ft(E,".",M,"="),typeof k){case"number":Ft(k);break;case"string":Ft('"',k,'"');break;case"object":Array.isArray(k)&&Ft("[",k.join(),"]");break;default:Ft(at.link(k));break}Ft(";")}});function S(M,k){h.forEach(function(V){var te=kt[V];if(Wr.isDynamic(te)){var ve=M.invoke(k,te);k(E,".",V,"=",ve,";")}})}We.dynamic[St]=new Wr.DynamicVariable(rf,{thisDep:c,contextDep:p,propDep:m,ref:E,append:S}),delete We.static[St]}function Un(at,We,St,kt,Ft){var h=On();h.stats=h.link(Ft),Object.keys(We.static).forEach(function(p){Ur(h,We,p)}),G0.forEach(function(p){Ur(h,at,p)});var c=Ao(at,We,St,kt,h);return Ri(h,c),ft(h,c),ct(h,c),C(h.compile(),{destroy:function(){c.shader.program.destroy()}})}return{next:cn,current:mr,procs:function(){var at=On(),We=at.proc("poll"),St=at.proc("refresh"),kt=at.block();We(kt),St(kt);var Ft=at.shared,h=Ft.gl,c=Ft.next,p=Ft.current;kt(p,".dirty=false;"),Fa(at,We),Fa(at,St,null,!0);var m;Rr&&(m=at.link(Rr)),mt.oes_vertex_array_object&&St(at.link(mt.oes_vertex_array_object),".bindVertexArrayOES(null);");for(var E=0;E<nr.maxAttributes;++E){var S=St.def(Ft.attributes,"[",E,"]"),M=at.cond(S,".buffer");M.then(h,".enableVertexAttribArray(",E,");",h,".bindBuffer(",ac,",",S,".buffer.buffer);",h,".vertexAttribPointer(",E,",",S,".size,",S,".type,",S,".normalized,",S,".stride,",S,".offset);").else(h,".disableVertexAttribArray(",E,");",h,".vertexAttrib4f(",E,",",S,".x,",S,".y,",S,".z,",S,".w);",S,".buffer=null;"),St(M),Rr&&St(m,".vertexAttribDivisorANGLE(",E,",",S,".divisor);")}return St(at.shared.vao,".currentVAO=null;",at.shared.vao,".setVAO(",at.shared.vao,".targetVAO);"),Object.keys(Hr).forEach(function(k){var V=Hr[k],te=kt.def(c,".",k),ve=at.block();ve("if(",te,"){",h,".enable(",V,")}else{",h,".disable(",V,")}",p,".",k,"=",te,";"),St(ve),We("if(",te,"!==",p,".",k,"){",ve,"}")}),Object.keys(Er).forEach(function(k){var V=Er[k],te=mr[k],ve,Ne,ut=at.block();if(ut(h,".",V,"("),Za(te)){var gt=te.length;ve=at.global.def(c,".",k),Ne=at.global.def(p,".",k),ut(xn(gt,function(rt){return ve+"["+rt+"]"}),");",xn(gt,function(rt){return Ne+"["+rt+"]="+ve+"["+rt+"];"}).join("")),We("if(",xn(gt,function(rt){return ve+"["+rt+"]!=="+Ne+"["+rt+"]"}).join("||"),"){",ut,"}")}else ve=kt.def(c,".",k),Ne=kt.def(p,".",k),ut(ve,");",p,".",k,"=",ve,";"),We("if(",ve,"!==",Ne,"){",ut,"}");St(ut)}),at.compile()}(),compile:Un}}function wf(){return{vaoCount:0,bufferCount:0,elementsCount:0,framebufferCount:0,shaderCount:0,textureCount:0,cubeCount:0,renderbufferCount:0,maxTextureUnits:0}}var W0=34918,Dc=34919,Tf=35007,$f=function(xe,Ke){if(!Ke.ext_disjoint_timer_query)return null;var mt=[];function nr(){return mt.pop()||Ke.ext_disjoint_timer_query.createQueryEXT()}function Ar(Rr){mt.push(Rr)}var er=[];function sr(Rr){var tn=nr();Ke.ext_disjoint_timer_query.beginQueryEXT(Tf,tn),er.push(tn),Tr(er.length-1,er.length,Rr)}function wr(){Ke.ext_disjoint_timer_query.endQueryEXT(Tf)}function Pr(){this.startQueryIndex=-1,this.endQueryIndex=-1,this.sum=0,this.stats=null}var Nr=[];function Dr(){return Nr.pop()||new Pr}function Or(Rr){Nr.push(Rr)}var qr=[];function Tr(Rr,tn,mr){var cn=Dr();cn.startQueryIndex=Rr,cn.endQueryIndex=tn,cn.sum=0,cn.stats=mr,qr.push(cn)}var Zr=[],Vt=[];function lr(){var Rr,tn,mr=er.length;if(mr!==0){Vt.length=Math.max(Vt.length,mr+1),Zr.length=Math.max(Zr.length,mr+1),Zr[0]=0,Vt[0]=0;var cn=0;for(Rr=0,tn=0;tn<er.length;++tn){var Cr=er[tn];Ke.ext_disjoint_timer_query.getQueryObjectEXT(Cr,Dc)?(cn+=Ke.ext_disjoint_timer_query.getQueryObjectEXT(Cr,W0),Ar(Cr)):er[Rr++]=Cr,Zr[tn+1]=cn,Vt[tn+1]=Rr}for(er.length=Rr,Rr=0,tn=0;tn<qr.length;++tn){var Hr=qr[tn],Er=Hr.startQueryIndex,Yr=Hr.endQueryIndex;Hr.sum+=Zr[Yr]-Zr[Er];var Cn=Vt[Er],Xn=Vt[Yr];Xn===Cn?(Hr.stats.gpuTime+=Hr.sum/1e6,Or(Hr)):(Hr.startQueryIndex=Cn,Hr.endQueryIndex=Xn,qr[Rr++]=Hr)}qr.length=Rr}}return{beginQuery:sr,endQuery:wr,pushScopeStats:Tr,update:lr,getNumPendingQueries:function(){return er.length},clear:function(){mt.push.apply(mt,er);for(var Rr=0;Rr<mt.length;Rr++)Ke.ext_disjoint_timer_query.deleteQueryEXT(mt[Rr]);er.length=0,mt.length=0},restore:function(){er.length=0,mt.length=0}}},Y0=16384,cf=256,Mf=1024,Wa=34962,Nc="webglcontextlost",Yl="webglcontextrestored",Qs=1,vu=2,Os=3;function Wf(xe,Ke){for(var mt=0;mt<xe.length;++mt)if(xe[mt]===Ke)return mt;return-1}function y0(xe){var Ke=Ds(xe);if(!Ke)return null;var mt=Ke.gl,nr=mt.getContextAttributes(),Ar=mt.isContextLost(),er=Co(mt,Ke);if(!er)return null;var sr=en(),wr=wf(),Pr=er.extensions,Nr=$f(mt,Pr),Dr=Br(),Or=mt.drawingBufferWidth,qr=mt.drawingBufferHeight,Tr={tick:0,time:0,viewportWidth:Or,viewportHeight:qr,framebufferWidth:Or,framebufferHeight:qr,drawingBufferWidth:Or,drawingBufferHeight:qr,pixelRatio:Ke.pixelRatio},Zr={},Vt={elements:null,primitive:4,count:-1,offset:0,instances:-1},lr=Mt(mt,Pr),Rr=mo(mt,wr,Ke,mr),tn=Wn(mt,Pr,lr,wr,Rr);function mr(Rn){return tn.destroyBuffer(Rn)}var cn=gc(mt,Pr,Rr,wr),Cr=wi(mt,sr,wr,Ke),Hr=Yi(mt,Pr,lr,function(){Cn.procs.poll()},Tr,wr,Ke),Er=Zu(mt,Pr,lr,wr,Ke),Yr=us(mt,Pr,lr,Hr,Er,wr),Cn=cl(mt,sr,Pr,lr,Rr,cn,Hr,Yr,Zr,tn,Cr,Vt,Tr,Nr,Ke),Xn=lt(mt,Yr,Cn.procs.poll,Tr,nr,Pr,lr),Ir=Cn.next,Fr=mt.canvas,vr=[],On=[],Bn=[],gn=[Ke.onDestroy],xi=null;function Jn(){if(vr.length===0){Nr&&Nr.update(),xi=null;return}xi=an.next(Jn),Tn();for(var Rn=vr.length-1;Rn>=0;--Rn){var gi=vr[Rn];gi&&gi(Tr,null,0)}mt.flush(),Nr&&Nr.update()}function yi(){!xi&&vr.length>0&&(xi=an.next(Jn))}function ta(){xi&&(an.cancel(Jn),xi=null)}function bo(Rn){Rn.preventDefault(),Ar=!0,ta(),On.forEach(function(gi){gi()})}function ro(Rn){mt.getError(),Ar=!1,er.restore(),Cr.restore(),Rr.restore(),Hr.restore(),Er.restore(),Yr.restore(),tn.restore(),Nr&&Nr.restore(),Cn.procs.refresh(),yi(),Bn.forEach(function(gi){gi()})}Fr&&(Fr.addEventListener(Nc,bo,!1),Fr.addEventListener(Yl,ro,!1));function Ti(){vr.length=0,ta(),Fr&&(Fr.removeEventListener(Nc,bo),Fr.removeEventListener(Yl,ro)),Cr.clear(),Yr.clear(),Er.clear(),Hr.clear(),cn.clear(),Rr.clear(),tn.clear(),Nr&&Nr.clear(),gn.forEach(function(Rn){Rn()})}function Io(Rn){J(!!Rn,"invalid args to regl({...})"),J.type(Rn,"object","invalid args to regl({...})");function gi(Ft){var h=C({},Ft);delete h.uniforms,delete h.attributes,delete h.context,delete h.vao,"stencil"in h&&h.stencil.op&&(h.stencil.opBack=h.stencil.opFront=h.stencil.op,delete h.stencil.op);function c(p){if(p in h){var m=h[p];delete h[p],Object.keys(m).forEach(function(E){h[p+"."+E]=m[E]})}}return c("blend"),c("depth"),c("cull"),c("stencil"),c("polygonOffset"),c("scissor"),c("sample"),"vao"in Ft&&(h.vao=Ft.vao),h}function dr(Ft,h){var c={},p={};return Object.keys(Ft).forEach(function(m){var E=Ft[m];if(Wr.isDynamic(E)){p[m]=Wr.unbox(E,m);return}else if(h&&Array.isArray(E)){for(var S=0;S<E.length;++S)if(Wr.isDynamic(E[S])){p[m]=Wr.unbox(E,m);return}}c[m]=E}),{dynamic:p,static:c}}var Ri=dr(Rn.context||{},!0),Xt=dr(Rn.uniforms||{},!0),es=dr(Rn.attributes||{},!1),ct=dr(gi(Rn),!1),ft={gpuTime:0,cpuTime:0,count:0},xt=Cn.compile(ct,es,Xt,Ri,ft),Ur=xt.draw,Un=xt.batch,at=xt.scope,We=[];function St(Ft){for(;We.length<Ft;)We.push(null);return We}function kt(Ft,h){var c;if(Ar&&J.raise("context lost"),typeof Ft=="function")return at.call(this,null,Ft,0);if(typeof h=="function")if(typeof Ft=="number")for(c=0;c<Ft;++c)at.call(this,null,h,c);else if(Array.isArray(Ft))for(c=0;c<Ft.length;++c)at.call(this,Ft[c],h,c);else return at.call(this,Ft,h,0);else if(typeof Ft=="number"){if(Ft>0)return Un.call(this,St(Ft|0),Ft|0)}else if(Array.isArray(Ft)){if(Ft.length)return Un.call(this,Ft,Ft.length)}else return Ur.call(this,Ft)}return C(kt,{stats:ft,destroy:function(){xt.destroy()}})}var Na=Yr.setFBO=Io({framebuffer:Wr.define.call(null,Qs,"framebuffer")});function Ao(Rn,gi){var dr=0;Cn.procs.poll();var Ri=gi.color;Ri&&(mt.clearColor(+Ri[0]||0,+Ri[1]||0,+Ri[2]||0,+Ri[3]||0),dr|=Y0),"depth"in gi&&(mt.clearDepth(+gi.depth),dr|=cf),"stencil"in gi&&(mt.clearStencil(gi.stencil|0),dr|=Mf),J(!!dr,"called regl.clear with no buffer specified"),mt.clear(dr)}function jo(Rn){if(J(typeof Rn=="object"&&Rn,"regl.clear() takes an object as input"),"framebuffer"in Rn)if(Rn.framebuffer&&Rn.framebuffer_reglType==="framebufferCube")for(var gi=0;gi<6;++gi)Na(C({framebuffer:Rn.framebuffer.faces[gi]},Rn),Ao);else Na(Rn,Ao);else Ao(null,Rn)}function Fa(Rn){J.type(Rn,"function","regl.frame() callback must be a function"),vr.push(Rn);function gi(){var dr=Wf(vr,Rn);J(dr>=0,"cannot cancel a frame twice");function Ri(){var Xt=Wf(vr,Ri);vr[Xt]=vr[vr.length-1],vr.length-=1,vr.length<=0&&ta()}vr[dr]=Ri}return yi(),{cancel:gi}}function Ua(){var Rn=Ir.viewport,gi=Ir.scissor_box;Rn[0]=Rn[1]=gi[0]=gi[1]=0,Tr.viewportWidth=Tr.framebufferWidth=Tr.drawingBufferWidth=Rn[2]=gi[2]=mt.drawingBufferWidth,Tr.viewportHeight=Tr.framebufferHeight=Tr.drawingBufferHeight=Rn[3]=gi[3]=mt.drawingBufferHeight}function Tn(){Tr.tick+=1,Tr.time=un(),Ua(),Cn.procs.poll()}function ga(){Hr.refresh(),Ua(),Cn.procs.refresh(),Nr&&Nr.update()}function un(){return(Br()-Dr)/1e3}ga();function Aa(Rn,gi){J.type(gi,"function","listener callback must be a function");var dr;switch(Rn){case"frame":return Fa(gi);case"lost":dr=On;break;case"restore":dr=Bn;break;case"destroy":dr=gn;break;default:J.raise("invalid event, must be one of frame,lost,restore,destroy")}return dr.push(gi),{cancel:function(){for(var Ri=0;Ri<dr.length;++Ri)if(dr[Ri]===gi){dr[Ri]=dr[dr.length-1],dr.pop();return}}}}var ra=C(Io,{clear:jo,prop:Wr.define.bind(null,Qs),context:Wr.define.bind(null,vu),this:Wr.define.bind(null,Os),draw:Io({}),buffer:function(Rn){return Rr.create(Rn,Wa,!1,!1)},elements:function(Rn){return cn.create(Rn,!1)},texture:Hr.create2D,cube:Hr.createCube,renderbuffer:Er.create,framebuffer:Yr.create,framebufferCube:Yr.createCube,vao:tn.createVAO,attributes:nr,frame:Fa,on:Aa,limits:lr,hasExtension:function(Rn){return lr.extensions.indexOf(Rn.toLowerCase())>=0},read:Xn,destroy:Ti,_gl:mt,_refresh:ga,poll:function(){Tn(),Nr&&Nr.update()},now:un,stats:wr});return Ke.onDone(null,ra),ra}return y0})},45229:function(se,$){(function(C,P){P($)})(this,function(C){"use strict";const D=33306690738754706e-32;function G(He,st,De,je,we){let Te,le,Re,ye,_e=st[0],ne=je[0],Y=0,Le=0;ne>_e==ne>-_e?(Te=_e,_e=st[++Y]):(Te=ne,ne=je[++Le]);let de=0;if(Y<He&&Le<De)for(ne>_e==ne>-_e?(Re=Te-((le=_e+Te)-_e),_e=st[++Y]):(Re=Te-((le=ne+Te)-ne),ne=je[++Le]),Te=le,Re!==0&&(we[de++]=Re);Y<He&&Le<De;)ne>_e==ne>-_e?(Re=Te-((le=Te+_e)-(ye=le-Te))+(_e-ye),_e=st[++Y]):(Re=Te-((le=Te+ne)-(ye=le-Te))+(ne-ye),ne=je[++Le]),Te=le,Re!==0&&(we[de++]=Re);for(;Y<He;)Re=Te-((le=Te+_e)-(ye=le-Te))+(_e-ye),_e=st[++Y],Te=le,Re!==0&&(we[de++]=Re);for(;Le<De;)Re=Te-((le=Te+ne)-(ye=le-Te))+(ne-ye),ne=je[++Le],Te=le,Re!==0&&(we[de++]=Re);return Te===0&&de!==0||(we[de++]=Te),de}function Z(He){return new Float64Array(He)}const F=33306690738754716e-32,z=22204460492503146e-32,q=11093356479670487e-47,ee=Z(4),fe=Z(8),be=Z(12),Ie=Z(16),Oe=Z(4);C.orient2d=function(He,st,De,je,we,Te){const le=(st-Te)*(De-we),Re=(He-we)*(je-Te),ye=le-Re;if(le===0||Re===0||le>0!=Re>0)return ye;const _e=Math.abs(le+Re);return Math.abs(ye)>=F*_e?ye:-function(ne,Y,Le,de,Ee,ge,X){let Me,Ae,me,ue,ke,Ze,oe,Dt,Rt,cr,Ut,$r,ln,Sr,Qr,Jr,_r,Gn;const ti=ne-Ee,Vn=Le-Ee,Xr=Y-ge,sn=de-ge;ke=(Qr=(Dt=ti-(oe=(Ze=134217729*ti)-(Ze-ti)))*(cr=sn-(Rt=(Ze=134217729*sn)-(Ze-sn)))-((Sr=ti*sn)-oe*Rt-Dt*Rt-oe*cr))-(Ut=Qr-(_r=(Dt=Xr-(oe=(Ze=134217729*Xr)-(Ze-Xr)))*(cr=Vn-(Rt=(Ze=134217729*Vn)-(Ze-Vn)))-((Jr=Xr*Vn)-oe*Rt-Dt*Rt-oe*cr))),ee[0]=Qr-(Ut+ke)+(ke-_r),ke=(ln=Sr-(($r=Sr+Ut)-(ke=$r-Sr))+(Ut-ke))-(Ut=ln-Jr),ee[1]=ln-(Ut+ke)+(ke-Jr),ke=(Gn=$r+Ut)-$r,ee[2]=$r-(Gn-ke)+(Ut-ke),ee[3]=Gn;let _n=function(ze,$e){let At=$e[0];for(let Lt=1;Lt<ze;Lt++)At+=$e[Lt];return At}(4,ee),Di=z*X;if(_n>=Di||-_n>=Di||(Me=ne-(ti+(ke=ne-ti))+(ke-Ee),me=Le-(Vn+(ke=Le-Vn))+(ke-Ee),Ae=Y-(Xr+(ke=Y-Xr))+(ke-ge),ue=de-(sn+(ke=de-sn))+(ke-ge),Me===0&&Ae===0&&me===0&&ue===0)||(Di=q*X+D*Math.abs(_n),(_n+=ti*ue+sn*Me-(Xr*me+Vn*Ae))>=Di||-_n>=Di))return _n;ke=(Qr=(Dt=Me-(oe=(Ze=134217729*Me)-(Ze-Me)))*(cr=sn-(Rt=(Ze=134217729*sn)-(Ze-sn)))-((Sr=Me*sn)-oe*Rt-Dt*Rt-oe*cr))-(Ut=Qr-(_r=(Dt=Ae-(oe=(Ze=134217729*Ae)-(Ze-Ae)))*(cr=Vn-(Rt=(Ze=134217729*Vn)-(Ze-Vn)))-((Jr=Ae*Vn)-oe*Rt-Dt*Rt-oe*cr))),Oe[0]=Qr-(Ut+ke)+(ke-_r),ke=(ln=Sr-(($r=Sr+Ut)-(ke=$r-Sr))+(Ut-ke))-(Ut=ln-Jr),Oe[1]=ln-(Ut+ke)+(ke-Jr),ke=(Gn=$r+Ut)-$r,Oe[2]=$r-(Gn-ke)+(Ut-ke),Oe[3]=Gn;const ri=G(4,ee,4,Oe,fe);ke=(Qr=(Dt=ti-(oe=(Ze=134217729*ti)-(Ze-ti)))*(cr=ue-(Rt=(Ze=134217729*ue)-(Ze-ue)))-((Sr=ti*ue)-oe*Rt-Dt*Rt-oe*cr))-(Ut=Qr-(_r=(Dt=Xr-(oe=(Ze=134217729*Xr)-(Ze-Xr)))*(cr=me-(Rt=(Ze=134217729*me)-(Ze-me)))-((Jr=Xr*me)-oe*Rt-Dt*Rt-oe*cr))),Oe[0]=Qr-(Ut+ke)+(ke-_r),ke=(ln=Sr-(($r=Sr+Ut)-(ke=$r-Sr))+(Ut-ke))-(Ut=ln-Jr),Oe[1]=ln-(Ut+ke)+(ke-Jr),ke=(Gn=$r+Ut)-$r,Oe[2]=$r-(Gn-ke)+(Ut-ke),Oe[3]=Gn;const Pt=G(ri,fe,4,Oe,be);ke=(Qr=(Dt=Me-(oe=(Ze=134217729*Me)-(Ze-Me)))*(cr=ue-(Rt=(Ze=134217729*ue)-(Ze-ue)))-((Sr=Me*ue)-oe*Rt-Dt*Rt-oe*cr))-(Ut=Qr-(_r=(Dt=Ae-(oe=(Ze=134217729*Ae)-(Ze-Ae)))*(cr=me-(Rt=(Ze=134217729*me)-(Ze-me)))-((Jr=Ae*me)-oe*Rt-Dt*Rt-oe*cr))),Oe[0]=Qr-(Ut+ke)+(ke-_r),ke=(ln=Sr-(($r=Sr+Ut)-(ke=$r-Sr))+(Ut-ke))-(Ut=ln-Jr),Oe[1]=ln-(Ut+ke)+(ke-Jr),ke=(Gn=$r+Ut)-$r,Oe[2]=$r-(Gn-ke)+(Ut-ke),Oe[3]=Gn;const J=G(Pt,be,4,Oe,Ie);return Ie[J-1]}(He,st,De,je,we,Te,_e)},C.orient2dfast=function(He,st,De,je,we,Te){return(st-Te)*(De-we)-(He-we)*(je-Te)},Object.defineProperty(C,"__esModule",{value:!0})})},59662:function(se,$,C){"use strict";var P=C(44532),D=C(51494),G=C(38262)(),Z=C(67747),F=P("%TypeError%"),z=P("%Math.floor%");se.exports=function(ee,fe){if(typeof ee!="function")throw new F("`fn` is not a function");if(typeof fe!="number"||fe<0||fe>4294967295||z(fe)!==fe)throw new F("`length` must be a positive 32-bit integer");var be=arguments.length>2&&!!arguments[2],Ie=!0,Oe=!0;if("length"in ee&&Z){var He=Z(ee,"length");He&&!He.configurable&&(Ie=!1),He&&!He.writable&&(Oe=!1)}return(Ie||Oe||!be)&&(G?D(ee,"length",fe,!0,!0):D(ee,"length",fe)),ee}},76160:function(se,$,C){"use strict";var P=C(51494),D=C(38262)(),G=C(8325).functionsHaveConfigurableNames(),Z=TypeError;se.exports=function(z,q){if(typeof z!="function")throw new Z("`fn` is not a function");var ee=arguments.length>2&&!!arguments[2];return(!ee||G)&&(D?P(z,"name",q,!0,!0):P(z,"name",q)),z}},74995:function(se){"use strict";se.exports={eudist:function(C,P,D){for(var G=C.length,Z=0,F=0;F<G;F++){var z=(C[F]||0)-(P[F]||0);Z+=z*z}return D?Math.sqrt(Z):Z},mandist:function(C,P,D){for(var G=C.length,Z=0,F=0;F<G;F++)Z+=Math.abs((C[F]||0)-(P[F]||0));return D?Math.sqrt(Z):Z},dist:function(C,P,D){var G=Math.abs(C-P);return D?G:G*G}}},72488:function(se,$,C){"use strict";var P=C(74995),D=P.eudist,G=P.dist;se.exports={kmrand:function(F,z){for(var q={},ee=[],fe=z<<2,be=F.length,Ie=F[0].length>0;ee.length<z&&fe-- >0;){var Oe=F[Math.floor(Math.random()*be)],He=Ie?Oe.join("_"):""+Oe;q[He]||(q[He]=!0,ee.push(Oe))}if(ee.length<z)throw new Error("Error initializating clusters");return ee},kmpp:function(F,z){var q=F[0].length?D:G,ee=[],fe=F.length,be=F[0].length>0,Ie={},Oe=F[Math.floor(Math.random()*fe)],He=be?Oe.join("_"):""+Oe;for(ee.push(Oe),Ie[He]=!0;ee.length<z;){for(var st=[],De=ee.length,je=0,we=[],Te=0;Te<fe;Te++){for(var le=1/0,Re=0;Re<De;Re++){var ye=q(F[Te],ee[Re]);ye<=le&&(le=ye)}st[Te]=le}for(var _e=0;_e<fe;_e++)je+=st[_e];for(var ne=0;ne<fe;ne++)we[ne]={i:ne,v:F[ne],pr:st[ne]/je,cs:0};we.sort(function(Ee,ge){return Ee.pr-ge.pr}),we[0].cs=we[0].pr;for(var Y=1;Y<fe;Y++)we[Y].cs=we[Y-1].cs+we[Y].pr;for(var Le=Math.random(),de=0;de<fe-1&&we[de++].cs<Le;);ee.push(we[de-1].v)}return ee}}},89345:function(se,$,C){"use strict";var P=C(74995),D=C(72488),G=P.eudist,Z=P.mandist,F=P.dist,z=D.kmrand,q=D.kmpp,ee=1e4;function fe(Ie,Oe,He){He=He||[];for(var st=0;st<Ie;st++)He[st]=Oe;return He}function be(Ie,Oe,He,st){var De=[],je=[],we=[],Te=[],le=!1,Re=st||ee,ye=Ie.length,_e=Ie[0].length,ne=_e>0,Y=[];if(He)He=="kmrand"?De=z(Ie,Oe):He=="kmpp"?De=q(Ie,Oe):De=He;else for(var Le={};De.length<Oe;){var de=Math.floor(Math.random()*ye);Le[de]||(Le[de]=!0,De.push(Ie[de]))}do{fe(Oe,0,Y);for(var Ee=0;Ee<ye;Ee++){for(var ge=1/0,X=0,Me=0;Me<Oe;Me++){var Te=ne?G(Ie[Ee],De[Me]):Math.abs(Ie[Ee]-De[Me]);Te<=ge&&(ge=Te,X=Me)}we[Ee]=X,Y[X]++}for(var Ae=[],je=[],me=0,ue=0;ue<Oe;ue++)Ae[ue]=ne?fe(_e,0,Ae[ue]):0,je[ue]=De[ue];if(ne){for(var ke=0;ke<Oe;ke++)De[ke]=[];for(var Ze=0;Ze<ye;Ze++)for(var oe=we[Ze],Dt=Ae[oe],Rt=Ie[Ze],cr=0;cr<_e;cr++)Dt[cr]+=Rt[cr];le=!0;for(var Ut=0;Ut<Oe;Ut++){for(var $r=De[Ut],ln=Ae[Ut],Sr=je[Ut],Qr=Y[Ut],Jr=0;Jr<_e;Jr++)$r[Jr]=ln[Jr]/Qr||0;if(le){for(var _r=0;_r<_e;_r++)if(Sr[_r]!=$r[_r]){le=!1;break}}}}else{for(var Gn=0;Gn<ye;Gn++){var ti=we[Gn];Ae[ti]+=Ie[Gn]}for(var Vn=0;Vn<Oe;Vn++)De[Vn]=Ae[Vn]/Y[Vn]||0;le=!0;for(var Xr=0;Xr<Oe;Xr++)if(je[Xr]!=De[Xr]){le=!1;break}}le=le||--Re<=0}while(!le);return{it:ee-Re,k:Oe,idxs:we,centroids:De}}se.exports=be},77028:function(se){(function($,C){se.exports=C()})(this,function(){"use strict";function $(ne,Y,Le,de,Ee,ge){if(!(Ee-de<=Le)){var X=de+Ee>>1;C(ne,Y,X,de,Ee,ge%2),$(ne,Y,Le,de,X-1,ge+1),$(ne,Y,Le,X+1,Ee,ge+1)}}function C(ne,Y,Le,de,Ee,ge){for(;Ee>de;){if(Ee-de>600){var X=Ee-de+1,Me=Le-de+1,Ae=Math.log(X),me=.5*Math.exp(2*Ae/3),ue=.5*Math.sqrt(Ae*me*(X-me)/X)*(Me-X/2<0?-1:1),ke=Math.max(de,Math.floor(Le-Me*me/X+ue)),Ze=Math.min(Ee,Math.floor(Le+(X-Me)*me/X+ue));C(ne,Y,Le,ke,Ze,ge)}var oe=Y[2*Le+ge],Dt=de,Rt=Ee;for(P(ne,Y,de,Le),Y[2*Ee+ge]>oe&&P(ne,Y,de,Ee);Dt<Rt;){for(P(ne,Y,Dt,Rt),Dt++,Rt--;Y[2*Dt+ge]<oe;)Dt++;for(;Y[2*Rt+ge]>oe;)Rt--}Y[2*de+ge]===oe?P(ne,Y,de,Rt):(Rt++,P(ne,Y,Rt,Ee)),Rt<=Le&&(de=Rt+1),Le<=Rt&&(Ee=Rt-1)}}function P(ne,Y,Le,de){D(ne,Le,de),D(Y,2*Le,2*de),D(Y,2*Le+1,2*de+1)}function D(ne,Y,Le){var de=ne[Y];ne[Y]=ne[Le],ne[Le]=de}function G(ne,Y,Le,de,Ee,ge,X){for(var Me=[0,ne.length-1,0],Ae=[],me,ue;Me.length;){var ke=Me.pop(),Ze=Me.pop(),oe=Me.pop();if(Ze-oe<=X){for(var Dt=oe;Dt<=Ze;Dt++)me=Y[2*Dt],ue=Y[2*Dt+1],me>=Le&&me<=Ee&&ue>=de&&ue<=ge&&Ae.push(ne[Dt]);continue}var Rt=Math.floor((oe+Ze)/2);me=Y[2*Rt],ue=Y[2*Rt+1],me>=Le&&me<=Ee&&ue>=de&&ue<=ge&&Ae.push(ne[Rt]);var cr=(ke+1)%2;(ke===0?Le<=me:de<=ue)&&(Me.push(oe),Me.push(Rt-1),Me.push(cr)),(ke===0?Ee>=me:ge>=ue)&&(Me.push(Rt+1),Me.push(Ze),Me.push(cr))}return Ae}function Z(ne,Y,Le,de,Ee,ge){for(var X=[0,ne.length-1,0],Me=[],Ae=Ee*Ee;X.length;){var me=X.pop(),ue=X.pop(),ke=X.pop();if(ue-ke<=ge){for(var Ze=ke;Ze<=ue;Ze++)F(Y[2*Ze],Y[2*Ze+1],Le,de)<=Ae&&Me.push(ne[Ze]);continue}var oe=Math.floor((ke+ue)/2),Dt=Y[2*oe],Rt=Y[2*oe+1];F(Dt,Rt,Le,de)<=Ae&&Me.push(ne[oe]);var cr=(me+1)%2;(me===0?Le-Ee<=Dt:de-Ee<=Rt)&&(X.push(ke),X.push(oe-1),X.push(cr)),(me===0?Le+Ee>=Dt:de+Ee>=Rt)&&(X.push(oe+1),X.push(ue),X.push(cr))}return Me}function F(ne,Y,Le,de){var Ee=ne-Le,ge=Y-de;return Ee*Ee+ge*ge}var z=function(ne){return ne[0]},q=function(ne){return ne[1]},ee=function(Y,Le,de,Ee,ge){Le===void 0&&(Le=z),de===void 0&&(de=q),Ee===void 0&&(Ee=64),ge===void 0&&(ge=Float64Array),this.nodeSize=Ee,this.points=Y;for(var X=Y.length<65536?Uint16Array:Uint32Array,Me=this.ids=new X(Y.length),Ae=this.coords=new ge(Y.length*2),me=0;me<Y.length;me++)Me[me]=me,Ae[2*me]=Le(Y[me]),Ae[2*me+1]=de(Y[me]);$(Me,Ae,Ee,0,Me.length-1,0)};ee.prototype.range=function(Y,Le,de,Ee){return G(this.ids,this.coords,Y,Le,de,Ee,this.nodeSize)},ee.prototype.within=function(Y,Le,de){return Z(this.ids,this.coords,Y,Le,de,this.nodeSize)};var fe={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:function(ne){return ne}},be=Math.fround||function(ne){return function(Y){return ne[0]=+Y,ne[0]}}(new Float32Array(1)),Ie=function(Y){this.options=Re(Object.create(fe),Y),this.trees=new Array(this.options.maxZoom+1)};Ie.prototype.load=function(Y){var Le=this.options,de=Le.log,Ee=Le.minZoom,ge=Le.maxZoom,X=Le.nodeSize;de&&console.time("total time");var Me="prepare "+Y.length+" points";de&&console.time(Me),this.points=Y;for(var Ae=[],me=0;me<Y.length;me++)Y[me].geometry&&Ae.push(He(Y[me],me));this.trees[ge+1]=new ee(Ae,ye,_e,X,Float32Array),de&&console.timeEnd(Me);for(var ue=ge;ue>=Ee;ue--){var ke=+Date.now();Ae=this._cluster(Ae,ue),this.trees[ue]=new ee(Ae,ye,_e,X,Float32Array),de&&console.log("z%d: %d clusters in %dms",ue,Ae.length,+Date.now()-ke)}return de&&console.timeEnd("total time"),this},Ie.prototype.getClusters=function(Y,Le){var de=((Y[0]+180)%360+360)%360-180,Ee=Math.max(-90,Math.min(90,Y[1])),ge=Y[2]===180?180:((Y[2]+180)%360+360)%360-180,X=Math.max(-90,Math.min(90,Y[3]));if(Y[2]-Y[0]>=360)de=-180,ge=180;else if(de>ge){var Me=this.getClusters([de,Ee,180,X],Le),Ae=this.getClusters([-180,Ee,ge,X],Le);return Me.concat(Ae)}for(var me=this.trees[this._limitZoom(Le)],ue=me.range(je(de),we(X),je(ge),we(Ee)),ke=[],Ze=0,oe=ue;Ze<oe.length;Ze+=1){var Dt=oe[Ze],Rt=me.points[Dt];ke.push(Rt.numPoints?st(Rt):this.points[Rt.index])}return ke},Ie.prototype.getChildren=function(Y){var Le=this._getOriginId(Y),de=this._getOriginZoom(Y),Ee="No cluster with the specified id.",ge=this.trees[de];if(!ge)throw new Error(Ee);var X=ge.points[Le];if(!X)throw new Error(Ee);for(var Me=this.options.radius/(this.options.extent*Math.pow(2,de-1)),Ae=ge.within(X.x,X.y,Me),me=[],ue=0,ke=Ae;ue<ke.length;ue+=1){var Ze=ke[ue],oe=ge.points[Ze];oe.parentId===Y&&me.push(oe.numPoints?st(oe):this.points[oe.index])}if(me.length===0)throw new Error(Ee);return me},Ie.prototype.getLeaves=function(Y,Le,de){Le=Le||10,de=de||0;var Ee=[];return this._appendLeaves(Ee,Y,Le,de,0),Ee},Ie.prototype.getTile=function(Y,Le,de){var Ee=this.trees[this._limitZoom(Y)],ge=Math.pow(2,Y),X=this.options,Me=X.extent,Ae=X.radius,me=Ae/Me,ue=(de-me)/ge,ke=(de+1+me)/ge,Ze={features:[]};return this._addTileFeatures(Ee.range((Le-me)/ge,ue,(Le+1+me)/ge,ke),Ee.points,Le,de,ge,Ze),Le===0&&this._addTileFeatures(Ee.range(1-me/ge,ue,1,ke),Ee.points,ge,de,ge,Ze),Le===ge-1&&this._addTileFeatures(Ee.range(0,ue,me/ge,ke),Ee.points,-1,de,ge,Ze),Ze.features.length?Ze:null},Ie.prototype.getClusterExpansionZoom=function(Y){for(var Le=this._getOriginZoom(Y)-1;Le<=this.options.maxZoom;){var de=this.getChildren(Y);if(Le++,de.length!==1)break;Y=de[0].properties.cluster_id}return Le},Ie.prototype._appendLeaves=function(Y,Le,de,Ee,ge){for(var X=this.getChildren(Le),Me=0,Ae=X;Me<Ae.length;Me+=1){var me=Ae[Me],ue=me.properties;if(ue&&ue.cluster?ge+ue.point_count<=Ee?ge+=ue.point_count:ge=this._appendLeaves(Y,ue.cluster_id,de,Ee,ge):ge<Ee?ge++:Y.push(me),Y.length===de)break}return ge},Ie.prototype._addTileFeatures=function(Y,Le,de,Ee,ge,X){for(var Me=0,Ae=Y;Me<Ae.length;Me+=1){var me=Ae[Me],ue=Le[me],ke=ue.numPoints,Ze=void 0,oe=void 0,Dt=void 0;if(ke)Ze=De(ue),oe=ue.x,Dt=ue.y;else{var Rt=this.points[ue.index];Ze=Rt.properties,oe=je(Rt.geometry.coordinates[0]),Dt=we(Rt.geometry.coordinates[1])}var cr={type:1,geometry:[[Math.round(this.options.extent*(oe*ge-de)),Math.round(this.options.extent*(Dt*ge-Ee))]],tags:Ze},Ut=void 0;ke?Ut=ue.id:this.options.generateId?Ut=ue.index:this.points[ue.index].id&&(Ut=this.points[ue.index].id),Ut!==void 0&&(cr.id=Ut),X.features.push(cr)}},Ie.prototype._limitZoom=function(Y){return Math.max(this.options.minZoom,Math.min(Math.floor(+Y),this.options.maxZoom+1))},Ie.prototype._cluster=function(Y,Le){for(var de=[],Ee=this.options,ge=Ee.radius,X=Ee.extent,Me=Ee.reduce,Ae=Ee.minPoints,me=ge/(X*Math.pow(2,Le)),ue=0;ue<Y.length;ue++){var ke=Y[ue];if(!(ke.zoom<=Le)){ke.zoom=Le;for(var Ze=this.trees[Le+1],oe=Ze.within(ke.x,ke.y,me),Dt=ke.numPoints||1,Rt=Dt,cr=0,Ut=oe;cr<Ut.length;cr+=1){var $r=Ut[cr],ln=Ze.points[$r];ln.zoom>Le&&(Rt+=ln.numPoints||1)}if(Rt>Dt&&Rt>=Ae){for(var Sr=ke.x*Dt,Qr=ke.y*Dt,Jr=Me&&Dt>1?this._map(ke,!0):null,_r=(ue<<5)+(Le+1)+this.points.length,Gn=0,ti=oe;Gn<ti.length;Gn+=1){var Vn=ti[Gn],Xr=Ze.points[Vn];if(!(Xr.zoom<=Le)){Xr.zoom=Le;var sn=Xr.numPoints||1;Sr+=Xr.x*sn,Qr+=Xr.y*sn,Xr.parentId=_r,Me&&(Jr||(Jr=this._map(ke,!0)),Me(Jr,this._map(Xr)))}}ke.parentId=_r,de.push(Oe(Sr/Rt,Qr/Rt,_r,Rt,Jr))}else if(de.push(ke),Rt>1)for(var _n=0,Di=oe;_n<Di.length;_n+=1){var ri=Di[_n],Pt=Ze.points[ri];Pt.zoom<=Le||(Pt.zoom=Le,de.push(Pt))}}}return de},Ie.prototype._getOriginId=function(Y){return Y-this.points.length>>5},Ie.prototype._getOriginZoom=function(Y){return(Y-this.points.length)%32},Ie.prototype._map=function(Y,Le){if(Y.numPoints)return Le?Re({},Y.properties):Y.properties;var de=this.points[Y.index].properties,Ee=this.options.map(de);return Le&&Ee===de?Re({},Ee):Ee};function Oe(ne,Y,Le,de,Ee){return{x:be(ne),y:be(Y),zoom:1/0,id:Le,parentId:-1,numPoints:de,properties:Ee}}function He(ne,Y){var Le=ne.geometry.coordinates,de=Le[0],Ee=Le[1];return{x:be(je(de)),y:be(we(Ee)),zoom:1/0,index:Y,parentId:-1}}function st(ne){return{type:"Feature",id:ne.id,properties:De(ne),geometry:{type:"Point",coordinates:[Te(ne.x),le(ne.y)]}}}function De(ne){var Y=ne.numPoints,Le=Y>=1e4?Math.round(Y/1e3)+"k":Y>=1e3?Math.round(Y/100)/10+"k":Y;return Re(Re({},ne.properties),{cluster:!0,cluster_id:ne.id,point_count:Y,point_count_abbreviated:Le})}function je(ne){return ne/360+.5}function we(ne){var Y=Math.sin(ne*Math.PI/180),Le=.5-.25*Math.log((1+Y)/(1-Y))/Math.PI;return Le<0?0:Le>1?1:Le}function Te(ne){return(ne-.5)*360}function le(ne){var Y=(180-ne*360)*Math.PI/180;return 360*Math.atan(Math.exp(Y))/Math.PI-90}function Re(ne,Y){for(var Le in Y)ne[Le]=Y[Le];return ne}function ye(ne){return ne.x}function _e(ne){return ne.y}return Ie})},93285:function(se,$,C){"use strict";C.r($),C.d($,{default:function(){return P}});class P{constructor(Z=[],F=D){if(this.data=Z,this.length=this.data.length,this.compare=F,this.length>0)for(let z=(this.length>>1)-1;z>=0;z--)this._down(z)}push(Z){this.data.push(Z),this.length++,this._up(this.length-1)}pop(){if(this.length===0)return;const Z=this.data[0],F=this.data.pop();return this.length--,this.length>0&&(this.data[0]=F,this._down(0)),Z}peek(){return this.data[0]}_up(Z){const{data:F,compare:z}=this,q=F[Z];for(;Z>0;){const ee=Z-1>>1,fe=F[ee];if(z(q,fe)>=0)break;F[Z]=fe,Z=ee}F[Z]=q}_down(Z){const{data:F,compare:z}=this,q=this.length>>1,ee=F[Z];for(;Z<q;){let fe=(Z<<1)+1,be=F[fe];const Ie=fe+1;if(Ie<this.length&&z(F[Ie],be)<0&&(fe=Ie,be=F[Ie]),z(be,ee)>=0)break;F[Z]=be,Z=fe}F[Z]=ee}}function D(G,Z){return G<Z?-1:G>Z?1:0}},46780:function(se,$){(function(C,P){P($)})(this,function(C){"use strict";function P(){}function D(o){this.message=o||""}function G(o){this.message=o||""}function Z(o){this.message=o||""}function F(){}function z(o){return o===null?fs:o.color}function q(o){return o===null?null:o.parent}function ee(o,s){o!==null&&(o.color=s)}function fe(o){return o===null?null:o.left}function be(o){return o===null?null:o.right}function Ie(){this.root_=null,this.size_=0}function Oe(){}function He(){this.array_=[],arguments[0]instanceof li&&this.addAll(arguments[0])}function st(){}function De(o){this.message=o||""}function je(){this.array_=[]}"fill"in Array.prototype||Object.defineProperty(Array.prototype,"fill",{configurable:!0,value:function(o){if(this===void 0||this===null)throw new TypeError(this+" is not an object");var s=Object(this),d=Math.max(Math.min(s.length,9007199254740991),0)||0,_=1 in arguments&&parseInt(Number(arguments[1]),10)||0;_=_<0?Math.max(d+_,0):Math.min(_,d);var w=2 in arguments&&arguments[2]!==void 0?parseInt(Number(arguments[2]),10)||0:d;for(w=w<0?Math.max(d+arguments[2],0):Math.min(w,d);_<w;)s[_]=o,++_;return s},writable:!0}),Number.isFinite=Number.isFinite||function(o){return typeof o=="number"&&isFinite(o)},Number.isInteger=Number.isInteger||function(o){return typeof o=="number"&&isFinite(o)&&Math.floor(o)===o},Number.parseFloat=Number.parseFloat||parseFloat,Number.isNaN=Number.isNaN||function(o){return o!=o},Math.trunc=Math.trunc||function(o){return o<0?Math.ceil(o):Math.floor(o)};var we=function(){};we.prototype.interfaces_=function(){return[]},we.prototype.getClass=function(){return we},we.prototype.equalsWithTolerance=function(o,s,d){return Math.abs(o-s)<=d};var Te=function(o){function s(d){o.call(this,d),this.name="IllegalArgumentException",this.message=d,this.stack=new o().stack}return o&&(s.__proto__=o),s.prototype=Object.create(o&&o.prototype),s.prototype.constructor=s,s}(Error),le=function(){},Re={MAX_VALUE:{configurable:!0}};le.isNaN=function(o){return Number.isNaN(o)},le.doubleToLongBits=function(o){return o},le.longBitsToDouble=function(o){return o},le.isInfinite=function(o){return!Number.isFinite(o)},Re.MAX_VALUE.get=function(){return Number.MAX_VALUE},Object.defineProperties(le,Re);var ye=function(){},_e=function(){},ne=function(){},Y=function o(){if(this.x=null,this.y=null,this.z=null,arguments.length===0)this.x=0,this.y=0,this.z=o.NULL_ORDINATE;else if(arguments.length===1){var s=arguments[0];this.x=s.x,this.y=s.y,this.z=s.z}else arguments.length===2?(this.x=arguments[0],this.y=arguments[1],this.z=o.NULL_ORDINATE):arguments.length===3&&(this.x=arguments[0],this.y=arguments[1],this.z=arguments[2])},Le={DimensionalComparator:{configurable:!0},serialVersionUID:{configurable:!0},NULL_ORDINATE:{configurable:!0},X:{configurable:!0},Y:{configurable:!0},Z:{configurable:!0}};Y.prototype.setOrdinate=function(o,s){switch(o){case Y.X:this.x=s;break;case Y.Y:this.y=s;break;case Y.Z:this.z=s;break;default:throw new Te("Invalid ordinate index: "+o)}},Y.prototype.equals2D=function(){if(arguments.length===1){var o=arguments[0];return this.x===o.x&&this.y===o.y}if(arguments.length===2){var s=arguments[0],d=arguments[1];return!!we.equalsWithTolerance(this.x,s.x,d)&&!!we.equalsWithTolerance(this.y,s.y,d)}},Y.prototype.getOrdinate=function(o){switch(o){case Y.X:return this.x;case Y.Y:return this.y;case Y.Z:return this.z}throw new Te("Invalid ordinate index: "+o)},Y.prototype.equals3D=function(o){return this.x===o.x&&this.y===o.y&&(this.z===o.z||le.isNaN(this.z))&&le.isNaN(o.z)},Y.prototype.equals=function(o){return o instanceof Y&&this.equals2D(o)},Y.prototype.equalInZ=function(o,s){return we.equalsWithTolerance(this.z,o.z,s)},Y.prototype.compareTo=function(o){var s=o;return this.x<s.x?-1:this.x>s.x?1:this.y<s.y?-1:this.y>s.y?1:0},Y.prototype.clone=function(){},Y.prototype.copy=function(){return new Y(this)},Y.prototype.toString=function(){return"("+this.x+", "+this.y+", "+this.z+")"},Y.prototype.distance3D=function(o){var s=this.x-o.x,d=this.y-o.y,_=this.z-o.z;return Math.sqrt(s*s+d*d+_*_)},Y.prototype.distance=function(o){var s=this.x-o.x,d=this.y-o.y;return Math.sqrt(s*s+d*d)},Y.prototype.hashCode=function(){var o=17;return o=37*o+Y.hashCode(this.x),o=37*o+Y.hashCode(this.y)},Y.prototype.setCoordinate=function(o){this.x=o.x,this.y=o.y,this.z=o.z},Y.prototype.interfaces_=function(){return[ye,_e,P]},Y.prototype.getClass=function(){return Y},Y.hashCode=function(){if(arguments.length===1){var o=arguments[0],s=le.doubleToLongBits(o);return Math.trunc((s^s)>>>32)}},Le.DimensionalComparator.get=function(){return de},Le.serialVersionUID.get=function(){return 6683108902428367e3},Le.NULL_ORDINATE.get=function(){return le.NaN},Le.X.get=function(){return 0},Le.Y.get=function(){return 1},Le.Z.get=function(){return 2},Object.defineProperties(Y,Le);var de=function(o){if(this._dimensionsToTest=2,arguments.length!==0){if(arguments.length===1){var s=arguments[0];if(s!==2&&s!==3)throw new Te("only 2 or 3 dimensions may be specified");this._dimensionsToTest=s}}};de.prototype.compare=function(o,s){var d=o,_=s,w=de.compare(d.x,_.x);if(w!==0)return w;var j=de.compare(d.y,_.y);return j!==0?j:this._dimensionsToTest<=2?0:de.compare(d.z,_.z)},de.prototype.interfaces_=function(){return[ne]},de.prototype.getClass=function(){return de},de.compare=function(o,s){return o<s?-1:o>s?1:le.isNaN(o)?le.isNaN(s)?0:-1:le.isNaN(s)?1:0};var Ee=function(){};Ee.prototype.create=function(){},Ee.prototype.interfaces_=function(){return[]},Ee.prototype.getClass=function(){return Ee};var ge=function(){},X={INTERIOR:{configurable:!0},BOUNDARY:{configurable:!0},EXTERIOR:{configurable:!0},NONE:{configurable:!0}};ge.prototype.interfaces_=function(){return[]},ge.prototype.getClass=function(){return ge},ge.toLocationSymbol=function(o){switch(o){case ge.EXTERIOR:return"e";case ge.BOUNDARY:return"b";case ge.INTERIOR:return"i";case ge.NONE:return"-"}throw new Te("Unknown location value: "+o)},X.INTERIOR.get=function(){return 0},X.BOUNDARY.get=function(){return 1},X.EXTERIOR.get=function(){return 2},X.NONE.get=function(){return-1},Object.defineProperties(ge,X);var Me=function(o,s){return o.interfaces_&&o.interfaces_().indexOf(s)>-1},Ae=function(){},me={LOG_10:{configurable:!0}};Ae.prototype.interfaces_=function(){return[]},Ae.prototype.getClass=function(){return Ae},Ae.log10=function(o){var s=Math.log(o);return le.isInfinite(s)||le.isNaN(s)?s:s/Ae.LOG_10},Ae.min=function(o,s,d,_){var w=o;return s<w&&(w=s),d<w&&(w=d),_<w&&(w=_),w},Ae.clamp=function(){if(typeof arguments[2]=="number"&&typeof arguments[0]=="number"&&typeof arguments[1]=="number"){var o=arguments[0],s=arguments[1],d=arguments[2];return o<s?s:o>d?d:o}if(Number.isInteger(arguments[2])&&Number.isInteger(arguments[0])&&Number.isInteger(arguments[1])){var _=arguments[0],w=arguments[1],j=arguments[2];return _<w?w:_>j?j:_}},Ae.wrap=function(o,s){return o<0?s- -o%s:o%s},Ae.max=function(){if(arguments.length===3){var o=arguments[0],s=arguments[1],d=arguments[2],_=o;return s>_&&(_=s),d>_&&(_=d),_}if(arguments.length===4){var w=arguments[0],j=arguments[1],re=arguments[2],Pe=arguments[3],tt=w;return j>tt&&(tt=j),re>tt&&(tt=re),Pe>tt&&(tt=Pe),tt}},Ae.average=function(o,s){return(o+s)/2},me.LOG_10.get=function(){return Math.log(10)},Object.defineProperties(Ae,me);var ue=function(o){this.str=o};ue.prototype.append=function(o){this.str+=o},ue.prototype.setCharAt=function(o,s){this.str=this.str.substr(0,o)+s+this.str.substr(o+1)},ue.prototype.toString=function(o){return this.str};var ke=function(o){this.value=o};ke.prototype.intValue=function(){return this.value},ke.prototype.compareTo=function(o){return this.value<o?-1:this.value>o?1:0},ke.isNaN=function(o){return Number.isNaN(o)};var Ze=function(){};Ze.isWhitespace=function(o){return o<=32&&o>=0||o===127},Ze.toUpperCase=function(o){return o.toUpperCase()};var oe=function o(){if(this._hi=0,this._lo=0,arguments.length===0)this.init(0);else if(arguments.length===1){if(typeof arguments[0]=="number"){var s=arguments[0];this.init(s)}else if(arguments[0]instanceof o){var d=arguments[0];this.init(d)}else if(typeof arguments[0]=="string"){var _=arguments[0];o.call(this,o.parse(_))}}else if(arguments.length===2){var w=arguments[0],j=arguments[1];this.init(w,j)}},Dt={PI:{configurable:!0},TWO_PI:{configurable:!0},PI_2:{configurable:!0},E:{configurable:!0},NaN:{configurable:!0},EPS:{configurable:!0},SPLIT:{configurable:!0},MAX_PRINT_DIGITS:{configurable:!0},TEN:{configurable:!0},ONE:{configurable:!0},SCI_NOT_EXPONENT_CHAR:{configurable:!0},SCI_NOT_ZERO:{configurable:!0}};oe.prototype.le=function(o){return(this._hi<o._hi||this._hi===o._hi)&&this._lo<=o._lo},oe.prototype.extractSignificantDigits=function(o,s){var d=this.abs(),_=oe.magnitude(d._hi),w=oe.TEN.pow(_);(d=d.divide(w)).gt(oe.TEN)?(d=d.divide(oe.TEN),_+=1):d.lt(oe.ONE)&&(d=d.multiply(oe.TEN),_-=1);for(var j=_+1,re=new ue,Pe=oe.MAX_PRINT_DIGITS-1,tt=0;tt<=Pe;tt++){o&&tt===j&&re.append(".");var It=Math.trunc(d._hi);if(It<0)break;var tr=!1,ot=0;It>9?(tr=!0,ot="9"):ot="0"+It,re.append(ot),d=d.subtract(oe.valueOf(It)).multiply(oe.TEN),tr&&d.selfAdd(oe.TEN);var Zt=!0,Jt=oe.magnitude(d._hi);if(Jt<0&&Math.abs(Jt)>=Pe-tt&&(Zt=!1),!Zt)break}return s[0]=_,re.toString()},oe.prototype.sqr=function(){return this.multiply(this)},oe.prototype.doubleValue=function(){return this._hi+this._lo},oe.prototype.subtract=function(){if(arguments[0]instanceof oe){var o=arguments[0];return this.add(o.negate())}if(typeof arguments[0]=="number"){var s=arguments[0];return this.add(-s)}},oe.prototype.equals=function(){if(arguments.length===1){var o=arguments[0];return this._hi===o._hi&&this._lo===o._lo}},oe.prototype.isZero=function(){return this._hi===0&&this._lo===0},oe.prototype.selfSubtract=function(){if(arguments[0]instanceof oe){var o=arguments[0];return this.isNaN()?this:this.selfAdd(-o._hi,-o._lo)}if(typeof arguments[0]=="number"){var s=arguments[0];return this.isNaN()?this:this.selfAdd(-s,0)}},oe.prototype.getSpecialNumberString=function(){return this.isZero()?"0.0":this.isNaN()?"NaN ":null},oe.prototype.min=function(o){return this.le(o)?this:o},oe.prototype.selfDivide=function(){if(arguments.length===1){if(arguments[0]instanceof oe){var o=arguments[0];return this.selfDivide(o._hi,o._lo)}if(typeof arguments[0]=="number"){var s=arguments[0];return this.selfDivide(s,0)}}else if(arguments.length===2){var d=arguments[0],_=arguments[1],w=null,j=null,re=null,Pe=null,tt=null,It=null,tr=null,ot=null;return tt=this._hi/d,It=oe.SPLIT*tt,w=It-tt,ot=oe.SPLIT*d,w=It-w,j=tt-w,re=ot-d,tr=tt*d,re=ot-re,Pe=d-re,ot=w*re-tr+w*Pe+j*re+j*Pe,It=(this._hi-tr-ot+this._lo-tt*_)/d,ot=tt+It,this._hi=ot,this._lo=tt-ot+It,this}},oe.prototype.dump=function(){return"DD<"+this._hi+", "+this._lo+">"},oe.prototype.divide=function(){if(arguments[0]instanceof oe){var o=arguments[0],s=null,d=null,_=null,w=null,j=null,re=null,Pe=null,tt=null;return d=(j=this._hi/o._hi)-(s=(re=oe.SPLIT*j)-(s=re-j)),tt=s*(_=(tt=oe.SPLIT*o._hi)-(_=tt-o._hi))-(Pe=j*o._hi)+s*(w=o._hi-_)+d*_+d*w,re=(this._hi-Pe-tt+this._lo-j*o._lo)/o._hi,new oe(tt=j+re,j-tt+re)}if(typeof arguments[0]=="number"){var It=arguments[0];return le.isNaN(It)?oe.createNaN():oe.copy(this).selfDivide(It,0)}},oe.prototype.ge=function(o){return(this._hi>o._hi||this._hi===o._hi)&&this._lo>=o._lo},oe.prototype.pow=function(o){if(o===0)return oe.valueOf(1);var s=new oe(this),d=oe.valueOf(1),_=Math.abs(o);if(_>1)for(;_>0;)_%2==1&&d.selfMultiply(s),(_/=2)>0&&(s=s.sqr());else d=s;return o<0?d.reciprocal():d},oe.prototype.ceil=function(){if(this.isNaN())return oe.NaN;var o=Math.ceil(this._hi),s=0;return o===this._hi&&(s=Math.ceil(this._lo)),new oe(o,s)},oe.prototype.compareTo=function(o){var s=o;return this._hi<s._hi?-1:this._hi>s._hi?1:this._lo<s._lo?-1:this._lo>s._lo?1:0},oe.prototype.rint=function(){return this.isNaN()?this:this.add(.5).floor()},oe.prototype.setValue=function(){if(arguments[0]instanceof oe){var o=arguments[0];return this.init(o),this}if(typeof arguments[0]=="number"){var s=arguments[0];return this.init(s),this}},oe.prototype.max=function(o){return this.ge(o)?this:o},oe.prototype.sqrt=function(){if(this.isZero())return oe.valueOf(0);if(this.isNegative())return oe.NaN;var o=1/Math.sqrt(this._hi),s=this._hi*o,d=oe.valueOf(s),_=this.subtract(d.sqr())._hi*(.5*o);return d.add(_)},oe.prototype.selfAdd=function(){if(arguments.length===1){if(arguments[0]instanceof oe){var o=arguments[0];return this.selfAdd(o._hi,o._lo)}if(typeof arguments[0]=="number"){var s=arguments[0],d=null,_=null,w=null,j=null,re=null,Pe=null;return w=this._hi+s,re=w-this._hi,j=w-re,j=s-re+(this._hi-j),Pe=j+this._lo,d=w+Pe,_=Pe+(w-d),this._hi=d+_,this._lo=_+(d-this._hi),this}}else if(arguments.length===2){var tt=arguments[0],It=arguments[1],tr=null,ot=null,Zt=null,Jt=null,gr=null,v=null,Ln=null;Jt=this._hi+tt,ot=this._lo+It,gr=Jt-(v=Jt-this._hi),Zt=ot-(Ln=ot-this._lo);var jn=(tr=Jt+(v=(gr=tt-v+(this._hi-gr))+ot))+(v=(Zt=It-Ln+(this._lo-Zt))+(v+(Jt-tr))),Xe=v+(tr-jn);return this._hi=jn,this._lo=Xe,this}},oe.prototype.selfMultiply=function(){if(arguments.length===1){if(arguments[0]instanceof oe){var o=arguments[0];return this.selfMultiply(o._hi,o._lo)}if(typeof arguments[0]=="number"){var s=arguments[0];return this.selfMultiply(s,0)}}else if(arguments.length===2){var d=arguments[0],_=arguments[1],w=null,j=null,re=null,Pe=null,tt=null,It=null;w=(tt=oe.SPLIT*this._hi)-this._hi,It=oe.SPLIT*d,w=tt-w,j=this._hi-w,re=It-d;var tr=(tt=this._hi*d)+(It=w*(re=It-re)-tt+w*(Pe=d-re)+j*re+j*Pe+(this._hi*_+this._lo*d)),ot=It+(w=tt-tr);return this._hi=tr,this._lo=ot,this}},oe.prototype.selfSqr=function(){return this.selfMultiply(this)},oe.prototype.floor=function(){if(this.isNaN())return oe.NaN;var o=Math.floor(this._hi),s=0;return o===this._hi&&(s=Math.floor(this._lo)),new oe(o,s)},oe.prototype.negate=function(){return this.isNaN()?this:new oe(-this._hi,-this._lo)},oe.prototype.clone=function(){},oe.prototype.multiply=function(){if(arguments[0]instanceof oe){var o=arguments[0];return o.isNaN()?oe.createNaN():oe.copy(this).selfMultiply(o)}if(typeof arguments[0]=="number"){var s=arguments[0];return le.isNaN(s)?oe.createNaN():oe.copy(this).selfMultiply(s,0)}},oe.prototype.isNaN=function(){return le.isNaN(this._hi)},oe.prototype.intValue=function(){return Math.trunc(this._hi)},oe.prototype.toString=function(){var o=oe.magnitude(this._hi);return o>=-3&&o<=20?this.toStandardNotation():this.toSciNotation()},oe.prototype.toStandardNotation=function(){var o=this.getSpecialNumberString();if(o!==null)return o;var s=new Array(1).fill(null),d=this.extractSignificantDigits(!0,s),_=s[0]+1,w=d;if(d.charAt(0)===".")w="0"+d;else if(_<0)w="0."+oe.stringOfChar("0",-_)+d;else if(d.indexOf(".")===-1){var j=_-d.length;w=d+oe.stringOfChar("0",j)+".0"}return this.isNegative()?"-"+w:w},oe.prototype.reciprocal=function(){var o=null,s=null,d=null,_=null,w=null,j=null,re=null,Pe=null;s=(w=1/this._hi)-(o=(j=oe.SPLIT*w)-(o=j-w)),d=(Pe=oe.SPLIT*this._hi)-this._hi;var tt=w+(j=(1-(re=w*this._hi)-(Pe=o*(d=Pe-d)-re+o*(_=this._hi-d)+s*d+s*_)-w*this._lo)/this._hi);return new oe(tt,w-tt+j)},oe.prototype.toSciNotation=function(){if(this.isZero())return oe.SCI_NOT_ZERO;var o=this.getSpecialNumberString();if(o!==null)return o;var s=new Array(1).fill(null),d=this.extractSignificantDigits(!1,s),_=oe.SCI_NOT_EXPONENT_CHAR+s[0];if(d.charAt(0)==="0")throw new Error("Found leading zero: "+d);var w="";d.length>1&&(w=d.substring(1));var j=d.charAt(0)+"."+w;return this.isNegative()?"-"+j+_:j+_},oe.prototype.abs=function(){return this.isNaN()?oe.NaN:this.isNegative()?this.negate():new oe(this)},oe.prototype.isPositive=function(){return(this._hi>0||this._hi===0)&&this._lo>0},oe.prototype.lt=function(o){return(this._hi<o._hi||this._hi===o._hi)&&this._lo<o._lo},oe.prototype.add=function(){if(arguments[0]instanceof oe){var o=arguments[0];return oe.copy(this).selfAdd(o)}if(typeof arguments[0]=="number"){var s=arguments[0];return oe.copy(this).selfAdd(s)}},oe.prototype.init=function(){if(arguments.length===1){if(typeof arguments[0]=="number"){var o=arguments[0];this._hi=o,this._lo=0}else if(arguments[0]instanceof oe){var s=arguments[0];this._hi=s._hi,this._lo=s._lo}}else if(arguments.length===2){var d=arguments[0],_=arguments[1];this._hi=d,this._lo=_}},oe.prototype.gt=function(o){return(this._hi>o._hi||this._hi===o._hi)&&this._lo>o._lo},oe.prototype.isNegative=function(){return(this._hi<0||this._hi===0)&&this._lo<0},oe.prototype.trunc=function(){return this.isNaN()?oe.NaN:this.isPositive()?this.floor():this.ceil()},oe.prototype.signum=function(){return this._hi>0?1:this._hi<0?-1:this._lo>0?1:this._lo<0?-1:0},oe.prototype.interfaces_=function(){return[P,ye,_e]},oe.prototype.getClass=function(){return oe},oe.sqr=function(o){return oe.valueOf(o).selfMultiply(o)},oe.valueOf=function(){if(typeof arguments[0]=="string"){var o=arguments[0];return oe.parse(o)}if(typeof arguments[0]=="number"){var s=arguments[0];return new oe(s)}},oe.sqrt=function(o){return oe.valueOf(o).sqrt()},oe.parse=function(o){for(var s=0,d=o.length;Ze.isWhitespace(o.charAt(s));)s++;var _=!1;if(s<d){var w=o.charAt(s);w!=="-"&&w!=="+"||(s++,w==="-"&&(_=!0))}for(var j=new oe,re=0,Pe=0,tt=0;!(s>=d);){var It=o.charAt(s);if(s++,Ze.isDigit(It)){var tr=It-"0";j.selfMultiply(oe.TEN),j.selfAdd(tr),re++}else{if(It!=="."){if(It==="e"||It==="E"){var ot=o.substring(s);try{tt=ke.parseInt(ot)}catch(Ln){throw Ln instanceof Error?new Error("Invalid exponent "+ot+" in string "+o):Ln}break}throw new Error("Unexpected character '"+It+"' at position "+s+" in string "+o)}Pe=re}}var Zt=j,Jt=re-Pe-tt;if(Jt===0)Zt=j;else if(Jt>0){var gr=oe.TEN.pow(Jt);Zt=j.divide(gr)}else if(Jt<0){var v=oe.TEN.pow(-Jt);Zt=j.multiply(v)}return _?Zt.negate():Zt},oe.createNaN=function(){return new oe(le.NaN,le.NaN)},oe.copy=function(o){return new oe(o)},oe.magnitude=function(o){var s=Math.abs(o),d=Math.log(s)/Math.log(10),_=Math.trunc(Math.floor(d));return 10*Math.pow(10,_)<=s&&(_+=1),_},oe.stringOfChar=function(o,s){for(var d=new ue,_=0;_<s;_++)d.append(o);return d.toString()},Dt.PI.get=function(){return new oe(3.141592653589793,12246467991473532e-32)},Dt.TWO_PI.get=function(){return new oe(6.283185307179586,24492935982947064e-32)},Dt.PI_2.get=function(){return new oe(1.5707963267948966,6123233995736766e-32)},Dt.E.get=function(){return new oe(2.718281828459045,14456468917292502e-32)},Dt.NaN.get=function(){return new oe(le.NaN,le.NaN)},Dt.EPS.get=function(){return 123259516440783e-46},Dt.SPLIT.get=function(){return 134217729},Dt.MAX_PRINT_DIGITS.get=function(){return 32},Dt.TEN.get=function(){return oe.valueOf(10)},Dt.ONE.get=function(){return oe.valueOf(1)},Dt.SCI_NOT_EXPONENT_CHAR.get=function(){return"E"},Dt.SCI_NOT_ZERO.get=function(){return"0.0E0"},Object.defineProperties(oe,Dt);var Rt=function(){},cr={DP_SAFE_EPSILON:{configurable:!0}};Rt.prototype.interfaces_=function(){return[]},Rt.prototype.getClass=function(){return Rt},Rt.orientationIndex=function(o,s,d){var _=Rt.orientationIndexFilter(o,s,d);if(_<=1)return _;var w=oe.valueOf(s.x).selfAdd(-o.x),j=oe.valueOf(s.y).selfAdd(-o.y),re=oe.valueOf(d.x).selfAdd(-s.x),Pe=oe.valueOf(d.y).selfAdd(-s.y);return w.selfMultiply(Pe).selfSubtract(j.selfMultiply(re)).signum()},Rt.signOfDet2x2=function(o,s,d,_){return o.multiply(_).selfSubtract(s.multiply(d)).signum()},Rt.intersection=function(o,s,d,_){var w=oe.valueOf(_.y).selfSubtract(d.y).selfMultiply(oe.valueOf(s.x).selfSubtract(o.x)),j=oe.valueOf(_.x).selfSubtract(d.x).selfMultiply(oe.valueOf(s.y).selfSubtract(o.y)),re=w.subtract(j),Pe=oe.valueOf(_.x).selfSubtract(d.x).selfMultiply(oe.valueOf(o.y).selfSubtract(d.y)),tt=oe.valueOf(_.y).selfSubtract(d.y).selfMultiply(oe.valueOf(o.x).selfSubtract(d.x)),It=Pe.subtract(tt).selfDivide(re).doubleValue(),tr=oe.valueOf(o.x).selfAdd(oe.valueOf(s.x).selfSubtract(o.x).selfMultiply(It)).doubleValue(),ot=oe.valueOf(s.x).selfSubtract(o.x).selfMultiply(oe.valueOf(o.y).selfSubtract(d.y)),Zt=oe.valueOf(s.y).selfSubtract(o.y).selfMultiply(oe.valueOf(o.x).selfSubtract(d.x)),Jt=ot.subtract(Zt).selfDivide(re).doubleValue(),gr=oe.valueOf(d.y).selfAdd(oe.valueOf(_.y).selfSubtract(d.y).selfMultiply(Jt)).doubleValue();return new Y(tr,gr)},Rt.orientationIndexFilter=function(o,s,d){var _=null,w=(o.x-d.x)*(s.y-d.y),j=(o.y-d.y)*(s.x-d.x),re=w-j;if(w>0){if(j<=0)return Rt.signum(re);_=w+j}else{if(!(w<0)||j>=0)return Rt.signum(re);_=-w-j}var Pe=Rt.DP_SAFE_EPSILON*_;return re>=Pe||-re>=Pe?Rt.signum(re):2},Rt.signum=function(o){return o>0?1:o<0?-1:0},cr.DP_SAFE_EPSILON.get=function(){return 1e-15},Object.defineProperties(Rt,cr);var Ut=function(){},$r={X:{configurable:!0},Y:{configurable:!0},Z:{configurable:!0},M:{configurable:!0}};$r.X.get=function(){return 0},$r.Y.get=function(){return 1},$r.Z.get=function(){return 2},$r.M.get=function(){return 3},Ut.prototype.setOrdinate=function(o,s,d){},Ut.prototype.size=function(){},Ut.prototype.getOrdinate=function(o,s){},Ut.prototype.getCoordinate=function(){},Ut.prototype.getCoordinateCopy=function(o){},Ut.prototype.getDimension=function(){},Ut.prototype.getX=function(o){},Ut.prototype.clone=function(){},Ut.prototype.expandEnvelope=function(o){},Ut.prototype.copy=function(){},Ut.prototype.getY=function(o){},Ut.prototype.toCoordinateArray=function(){},Ut.prototype.interfaces_=function(){return[_e]},Ut.prototype.getClass=function(){return Ut},Object.defineProperties(Ut,$r);var ln=function(){},Sr=function(o){function s(){o.call(this,"Projective point not representable on the Cartesian plane.")}return o&&(s.__proto__=o),s.prototype=Object.create(o&&o.prototype),s.prototype.constructor=s,s.prototype.interfaces_=function(){return[]},s.prototype.getClass=function(){return s},s}(ln),Qr=function(){};Qr.arraycopy=function(o,s,d,_,w){for(var j=0,re=s;re<s+w;re++)d[_+j]=o[re],j++},Qr.getProperty=function(o){return{"line.separator":`
`}[o]};var Jr=function o(){if(this.x=null,this.y=null,this.w=null,arguments.length===0)this.x=0,this.y=0,this.w=1;else if(arguments.length===1){var s=arguments[0];this.x=s.x,this.y=s.y,this.w=1}else if(arguments.length===2){if(typeof arguments[0]=="number"&&typeof arguments[1]=="number"){var d=arguments[0],_=arguments[1];this.x=d,this.y=_,this.w=1}else if(arguments[0]instanceof o&&arguments[1]instanceof o){var w=arguments[0],j=arguments[1];this.x=w.y*j.w-j.y*w.w,this.y=j.x*w.w-w.x*j.w,this.w=w.x*j.y-j.x*w.y}else if(arguments[0]instanceof Y&&arguments[1]instanceof Y){var re=arguments[0],Pe=arguments[1];this.x=re.y-Pe.y,this.y=Pe.x-re.x,this.w=re.x*Pe.y-Pe.x*re.y}}else if(arguments.length===3){var tt=arguments[0],It=arguments[1],tr=arguments[2];this.x=tt,this.y=It,this.w=tr}else if(arguments.length===4){var ot=arguments[0],Zt=arguments[1],Jt=arguments[2],gr=arguments[3],v=ot.y-Zt.y,Ln=Zt.x-ot.x,jn=ot.x*Zt.y-Zt.x*ot.y,Xe=Jt.y-gr.y,Ma=gr.x-Jt.x,ao=Jt.x*gr.y-gr.x*Jt.y;this.x=Ln*ao-Ma*jn,this.y=Xe*jn-v*ao,this.w=v*Ma-Xe*Ln}};Jr.prototype.getY=function(){var o=this.y/this.w;if(le.isNaN(o)||le.isInfinite(o))throw new Sr;return o},Jr.prototype.getX=function(){var o=this.x/this.w;if(le.isNaN(o)||le.isInfinite(o))throw new Sr;return o},Jr.prototype.getCoordinate=function(){var o=new Y;return o.x=this.getX(),o.y=this.getY(),o},Jr.prototype.interfaces_=function(){return[]},Jr.prototype.getClass=function(){return Jr},Jr.intersection=function(o,s,d,_){var w=o.y-s.y,j=s.x-o.x,re=o.x*s.y-s.x*o.y,Pe=d.y-_.y,tt=_.x-d.x,It=d.x*_.y-_.x*d.y,tr=w*tt-Pe*j,ot=(j*It-tt*re)/tr,Zt=(Pe*re-w*It)/tr;if(le.isNaN(ot)||le.isInfinite(ot)||le.isNaN(Zt)||le.isInfinite(Zt))throw new Sr;return new Y(ot,Zt)};var _r=function o(){if(this._minx=null,this._maxx=null,this._miny=null,this._maxy=null,arguments.length===0)this.init();else if(arguments.length===1){if(arguments[0]instanceof Y){var s=arguments[0];this.init(s.x,s.x,s.y,s.y)}else if(arguments[0]instanceof o){var d=arguments[0];this.init(d)}}else if(arguments.length===2){var _=arguments[0],w=arguments[1];this.init(_.x,w.x,_.y,w.y)}else if(arguments.length===4){var j=arguments[0],re=arguments[1],Pe=arguments[2],tt=arguments[3];this.init(j,re,Pe,tt)}},Gn={serialVersionUID:{configurable:!0}};_r.prototype.getArea=function(){return this.getWidth()*this.getHeight()},_r.prototype.equals=function(o){if(!(o instanceof _r))return!1;var s=o;return this.isNull()?s.isNull():this._maxx===s.getMaxX()&&this._maxy===s.getMaxY()&&this._minx===s.getMinX()&&this._miny===s.getMinY()},_r.prototype.intersection=function(o){if(this.isNull()||o.isNull()||!this.intersects(o))return new _r;var s=this._minx>o._minx?this._minx:o._minx,d=this._miny>o._miny?this._miny:o._miny,_=this._maxx<o._maxx?this._maxx:o._maxx,w=this._maxy<o._maxy?this._maxy:o._maxy;return new _r(s,_,d,w)},_r.prototype.isNull=function(){return this._maxx<this._minx},_r.prototype.getMaxX=function(){return this._maxx},_r.prototype.covers=function(){if(arguments.length===1){if(arguments[0]instanceof Y){var o=arguments[0];return this.covers(o.x,o.y)}if(arguments[0]instanceof _r){var s=arguments[0];return!this.isNull()&&!s.isNull()&&s.getMinX()>=this._minx&&s.getMaxX()<=this._maxx&&s.getMinY()>=this._miny&&s.getMaxY()<=this._maxy}}else if(arguments.length===2){var d=arguments[0],_=arguments[1];return!this.isNull()&&d>=this._minx&&d<=this._maxx&&_>=this._miny&&_<=this._maxy}},_r.prototype.intersects=function(){if(arguments.length===1){if(arguments[0]instanceof _r){var o=arguments[0];return!this.isNull()&&!o.isNull()&&!(o._minx>this._maxx||o._maxx<this._minx||o._miny>this._maxy||o._maxy<this._miny)}if(arguments[0]instanceof Y){var s=arguments[0];return this.intersects(s.x,s.y)}}else if(arguments.length===2){var d=arguments[0],_=arguments[1];return!this.isNull()&&!(d>this._maxx||d<this._minx||_>this._maxy||_<this._miny)}},_r.prototype.getMinY=function(){return this._miny},_r.prototype.getMinX=function(){return this._minx},_r.prototype.expandToInclude=function(){if(arguments.length===1){if(arguments[0]instanceof Y){var o=arguments[0];this.expandToInclude(o.x,o.y)}else if(arguments[0]instanceof _r){var s=arguments[0];if(s.isNull())return null;this.isNull()?(this._minx=s.getMinX(),this._maxx=s.getMaxX(),this._miny=s.getMinY(),this._maxy=s.getMaxY()):(s._minx<this._minx&&(this._minx=s._minx),s._maxx>this._maxx&&(this._maxx=s._maxx),s._miny<this._miny&&(this._miny=s._miny),s._maxy>this._maxy&&(this._maxy=s._maxy))}}else if(arguments.length===2){var d=arguments[0],_=arguments[1];this.isNull()?(this._minx=d,this._maxx=d,this._miny=_,this._maxy=_):(d<this._minx&&(this._minx=d),d>this._maxx&&(this._maxx=d),_<this._miny&&(this._miny=_),_>this._maxy&&(this._maxy=_))}},_r.prototype.minExtent=function(){if(this.isNull())return 0;var o=this.getWidth(),s=this.getHeight();return o<s?o:s},_r.prototype.getWidth=function(){return this.isNull()?0:this._maxx-this._minx},_r.prototype.compareTo=function(o){var s=o;return this.isNull()?s.isNull()?0:-1:s.isNull()?1:this._minx<s._minx?-1:this._minx>s._minx?1:this._miny<s._miny?-1:this._miny>s._miny?1:this._maxx<s._maxx?-1:this._maxx>s._maxx?1:this._maxy<s._maxy?-1:this._maxy>s._maxy?1:0},_r.prototype.translate=function(o,s){if(this.isNull())return null;this.init(this.getMinX()+o,this.getMaxX()+o,this.getMinY()+s,this.getMaxY()+s)},_r.prototype.toString=function(){return"Env["+this._minx+" : "+this._maxx+", "+this._miny+" : "+this._maxy+"]"},_r.prototype.setToNull=function(){this._minx=0,this._maxx=-1,this._miny=0,this._maxy=-1},_r.prototype.getHeight=function(){return this.isNull()?0:this._maxy-this._miny},_r.prototype.maxExtent=function(){if(this.isNull())return 0;var o=this.getWidth(),s=this.getHeight();return o>s?o:s},_r.prototype.expandBy=function(){if(arguments.length===1){var o=arguments[0];this.expandBy(o,o)}else if(arguments.length===2){var s=arguments[0],d=arguments[1];if(this.isNull())return null;this._minx-=s,this._maxx+=s,this._miny-=d,this._maxy+=d,(this._minx>this._maxx||this._miny>this._maxy)&&this.setToNull()}},_r.prototype.contains=function(){if(arguments.length===1){if(arguments[0]instanceof _r){var o=arguments[0];return this.covers(o)}if(arguments[0]instanceof Y){var s=arguments[0];return this.covers(s)}}else if(arguments.length===2){var d=arguments[0],_=arguments[1];return this.covers(d,_)}},_r.prototype.centre=function(){return this.isNull()?null:new Y((this.getMinX()+this.getMaxX())/2,(this.getMinY()+this.getMaxY())/2)},_r.prototype.init=function(){if(arguments.length===0)this.setToNull();else if(arguments.length===1){if(arguments[0]instanceof Y){var o=arguments[0];this.init(o.x,o.x,o.y,o.y)}else if(arguments[0]instanceof _r){var s=arguments[0];this._minx=s._minx,this._maxx=s._maxx,this._miny=s._miny,this._maxy=s._maxy}}else if(arguments.length===2){var d=arguments[0],_=arguments[1];this.init(d.x,_.x,d.y,_.y)}else if(arguments.length===4){var w=arguments[0],j=arguments[1],re=arguments[2],Pe=arguments[3];w<j?(this._minx=w,this._maxx=j):(this._minx=j,this._maxx=w),re<Pe?(this._miny=re,this._maxy=Pe):(this._miny=Pe,this._maxy=re)}},_r.prototype.getMaxY=function(){return this._maxy},_r.prototype.distance=function(o){if(this.intersects(o))return 0;var s=0;this._maxx<o._minx?s=o._minx-this._maxx:this._minx>o._maxx&&(s=this._minx-o._maxx);var d=0;return this._maxy<o._miny?d=o._miny-this._maxy:this._miny>o._maxy&&(d=this._miny-o._maxy),s===0?d:d===0?s:Math.sqrt(s*s+d*d)},_r.prototype.hashCode=function(){var o=17;return o=37*o+Y.hashCode(this._minx),o=37*o+Y.hashCode(this._maxx),o=37*o+Y.hashCode(this._miny),o=37*o+Y.hashCode(this._maxy)},_r.prototype.interfaces_=function(){return[ye,P]},_r.prototype.getClass=function(){return _r},_r.intersects=function(){if(arguments.length===3){var o=arguments[0],s=arguments[1],d=arguments[2];return d.x>=(o.x<s.x?o.x:s.x)&&d.x<=(o.x>s.x?o.x:s.x)&&d.y>=(o.y<s.y?o.y:s.y)&&d.y<=(o.y>s.y?o.y:s.y)}if(arguments.length===4){var _=arguments[0],w=arguments[1],j=arguments[2],re=arguments[3],Pe=Math.min(j.x,re.x),tt=Math.max(j.x,re.x),It=Math.min(_.x,w.x),tr=Math.max(_.x,w.x);return!(It>tt)&&!(tr<Pe)&&(Pe=Math.min(j.y,re.y),tt=Math.max(j.y,re.y),It=Math.min(_.y,w.y),tr=Math.max(_.y,w.y),!(It>tt)&&!(tr<Pe))}},Gn.serialVersionUID.get=function(){return 5873921885273102e3},Object.defineProperties(_r,Gn);var ti={typeStr:/^\s*(\w+)\s*\(\s*(.*)\s*\)\s*$/,emptyTypeStr:/^\s*(\w+)\s*EMPTY\s*$/,spaces:/\s+/,parenComma:/\)\s*,\s*\(/,doubleParenComma:/\)\s*\)\s*,\s*\(\s*\(/,trimParens:/^\s*\(?(.*?)\)?\s*$/},Vn=function(o){this.geometryFactory=o||new Ai};Vn.prototype.read=function(o){var s,d,_;o=o.replace(/[\n\r]/g," ");var w=ti.typeStr.exec(o);if(o.search("EMPTY")!==-1&&((w=ti.emptyTypeStr.exec(o))[2]=void 0),w&&(d=w[1].toLowerCase(),_=w[2],sn[d]&&(s=sn[d].apply(this,[_]))),s===void 0)throw new Error("Could not parse WKT "+o);return s},Vn.prototype.write=function(o){return this.extractGeometry(o)},Vn.prototype.extractGeometry=function(o){var s=o.getGeometryType().toLowerCase();if(!Xr[s])return null;var d=s.toUpperCase();return o.isEmpty()?d+" EMPTY":d+"("+Xr[s].apply(this,[o])+")"};var Xr={coordinate:function(o){return o.x+" "+o.y},point:function(o){return Xr.coordinate.call(this,o._coordinates._coordinates[0])},multipoint:function(o){for(var s=[],d=0,_=o._geometries.length;d<_;++d)s.push("("+Xr.point.apply(this,[o._geometries[d]])+")");return s.join(",")},linestring:function(o){for(var s=[],d=0,_=o._points._coordinates.length;d<_;++d)s.push(Xr.coordinate.apply(this,[o._points._coordinates[d]]));return s.join(",")},linearring:function(o){for(var s=[],d=0,_=o._points._coordinates.length;d<_;++d)s.push(Xr.coordinate.apply(this,[o._points._coordinates[d]]));return s.join(",")},multilinestring:function(o){for(var s=[],d=0,_=o._geometries.length;d<_;++d)s.push("("+Xr.linestring.apply(this,[o._geometries[d]])+")");return s.join(",")},polygon:function(o){var s=[];s.push("("+Xr.linestring.apply(this,[o._shell])+")");for(var d=0,_=o._holes.length;d<_;++d)s.push("("+Xr.linestring.apply(this,[o._holes[d]])+")");return s.join(",")},multipolygon:function(o){for(var s=[],d=0,_=o._geometries.length;d<_;++d)s.push("("+Xr.polygon.apply(this,[o._geometries[d]])+")");return s.join(",")},geometrycollection:function(o){for(var s=[],d=0,_=o._geometries.length;d<_;++d)s.push(this.extractGeometry(o._geometries[d]));return s.join(",")}},sn={point:function(o){if(o===void 0)return this.geometryFactory.createPoint();var s=o.trim().split(ti.spaces);return this.geometryFactory.createPoint(new Y(Number.parseFloat(s[0]),Number.parseFloat(s[1])))},multipoint:function(o){if(o===void 0)return this.geometryFactory.createMultiPoint();for(var s,d=o.trim().split(","),_=[],w=0,j=d.length;w<j;++w)s=d[w].replace(ti.trimParens,"$1"),_.push(sn.point.apply(this,[s]));return this.geometryFactory.createMultiPoint(_)},linestring:function(o){if(o===void 0)return this.geometryFactory.createLineString();for(var s,d=o.trim().split(","),_=[],w=0,j=d.length;w<j;++w)s=d[w].trim().split(ti.spaces),_.push(new Y(Number.parseFloat(s[0]),Number.parseFloat(s[1])));return this.geometryFactory.createLineString(_)},linearring:function(o){if(o===void 0)return this.geometryFactory.createLinearRing();for(var s,d=o.trim().split(","),_=[],w=0,j=d.length;w<j;++w)s=d[w].trim().split(ti.spaces),_.push(new Y(Number.parseFloat(s[0]),Number.parseFloat(s[1])));return this.geometryFactory.createLinearRing(_)},multilinestring:function(o){if(o===void 0)return this.geometryFactory.createMultiLineString();for(var s,d=o.trim().split(ti.parenComma),_=[],w=0,j=d.length;w<j;++w)s=d[w].replace(ti.trimParens,"$1"),_.push(sn.linestring.apply(this,[s]));return this.geometryFactory.createMultiLineString(_)},polygon:function(o){if(o===void 0)return this.geometryFactory.createPolygon();for(var s,d,_,w,j=o.trim().split(ti.parenComma),re=[],Pe=0,tt=j.length;Pe<tt;++Pe)s=j[Pe].replace(ti.trimParens,"$1"),d=sn.linestring.apply(this,[s]),_=this.geometryFactory.createLinearRing(d._points),Pe===0?w=_:re.push(_);return this.geometryFactory.createPolygon(w,re)},multipolygon:function(o){if(o===void 0)return this.geometryFactory.createMultiPolygon();for(var s,d=o.trim().split(ti.doubleParenComma),_=[],w=0,j=d.length;w<j;++w)s=d[w].replace(ti.trimParens,"$1"),_.push(sn.polygon.apply(this,[s]));return this.geometryFactory.createMultiPolygon(_)},geometrycollection:function(o){if(o===void 0)return this.geometryFactory.createGeometryCollection();for(var s=(o=o.replace(/,\s*([A-Za-z])/g,"|$1")).trim().split("|"),d=[],_=0,w=s.length;_<w;++_)d.push(this.read(s[_]));return this.geometryFactory.createGeometryCollection(d)}},_n=function(o){this.parser=new Vn(o)};_n.prototype.write=function(o){return this.parser.write(o)},_n.toLineString=function(o,s){if(arguments.length!==2)throw new Error("Not implemented");return"LINESTRING ( "+o.x+" "+o.y+", "+s.x+" "+s.y+" )"};var Di=function(o){function s(d){o.call(this,d),this.name="RuntimeException",this.message=d,this.stack=new o().stack}return o&&(s.__proto__=o),s.prototype=Object.create(o&&o.prototype),s.prototype.constructor=s,s}(Error),ri=function(o){function s(){if(o.call(this),arguments.length===0)o.call(this);else if(arguments.length===1){var d=arguments[0];o.call(this,d)}}return o&&(s.__proto__=o),s.prototype=Object.create(o&&o.prototype),s.prototype.constructor=s,s.prototype.interfaces_=function(){return[]},s.prototype.getClass=function(){return s},s}(Di),Pt=function(){};Pt.prototype.interfaces_=function(){return[]},Pt.prototype.getClass=function(){return Pt},Pt.shouldNeverReachHere=function(){if(arguments.length===0)Pt.shouldNeverReachHere(null);else if(arguments.length===1){var o=arguments[0];throw new ri("Should never reach here"+(o!==null?": "+o:""))}},Pt.isTrue=function(){var o,s;if(arguments.length===1)o=arguments[0],Pt.isTrue(o,null);else if(arguments.length===2&&(o=arguments[0],s=arguments[1],!o))throw s===null?new ri:new ri(s)},Pt.equals=function(){var o,s,d;if(arguments.length===2)o=arguments[0],s=arguments[1],Pt.equals(o,s,null);else if(arguments.length===3&&(o=arguments[0],s=arguments[1],d=arguments[2],!s.equals(o)))throw new ri("Expected "+o+" but encountered "+s+(d!==null?": "+d:""))};var J=function(){this._result=null,this._inputLines=Array(2).fill().map(function(){return Array(2)}),this._intPt=new Array(2).fill(null),this._intLineIndex=null,this._isProper=null,this._pa=null,this._pb=null,this._precisionModel=null,this._intPt[0]=new Y,this._intPt[1]=new Y,this._pa=this._intPt[0],this._pb=this._intPt[1],this._result=0},ze={DONT_INTERSECT:{configurable:!0},DO_INTERSECT:{configurable:!0},COLLINEAR:{configurable:!0},NO_INTERSECTION:{configurable:!0},POINT_INTERSECTION:{configurable:!0},COLLINEAR_INTERSECTION:{configurable:!0}};J.prototype.getIndexAlongSegment=function(o,s){return this.computeIntLineIndex(),this._intLineIndex[o][s]},J.prototype.getTopologySummary=function(){var o=new ue;return this.isEndPoint()&&o.append(" endpoint"),this._isProper&&o.append(" proper"),this.isCollinear()&&o.append(" collinear"),o.toString()},J.prototype.computeIntersection=function(o,s,d,_){this._inputLines[0][0]=o,this._inputLines[0][1]=s,this._inputLines[1][0]=d,this._inputLines[1][1]=_,this._result=this.computeIntersect(o,s,d,_)},J.prototype.getIntersectionNum=function(){return this._result},J.prototype.computeIntLineIndex=function(){if(arguments.length===0)this._intLineIndex===null&&(this._intLineIndex=Array(2).fill().map(function(){return Array(2)}),this.computeIntLineIndex(0),this.computeIntLineIndex(1));else if(arguments.length===1){var o=arguments[0];this.getEdgeDistance(o,0)>this.getEdgeDistance(o,1)?(this._intLineIndex[o][0]=0,this._intLineIndex[o][1]=1):(this._intLineIndex[o][0]=1,this._intLineIndex[o][1]=0)}},J.prototype.isProper=function(){return this.hasIntersection()&&this._isProper},J.prototype.setPrecisionModel=function(o){this._precisionModel=o},J.prototype.isInteriorIntersection=function(){if(arguments.length===0)return!!this.isInteriorIntersection(0)||!!this.isInteriorIntersection(1);if(arguments.length===1){for(var o=arguments[0],s=0;s<this._result;s++)if(!this._intPt[s].equals2D(this._inputLines[o][0])&&!this._intPt[s].equals2D(this._inputLines[o][1]))return!0;return!1}},J.prototype.getIntersection=function(o){return this._intPt[o]},J.prototype.isEndPoint=function(){return this.hasIntersection()&&!this._isProper},J.prototype.hasIntersection=function(){return this._result!==J.NO_INTERSECTION},J.prototype.getEdgeDistance=function(o,s){return J.computeEdgeDistance(this._intPt[s],this._inputLines[o][0],this._inputLines[o][1])},J.prototype.isCollinear=function(){return this._result===J.COLLINEAR_INTERSECTION},J.prototype.toString=function(){return _n.toLineString(this._inputLines[0][0],this._inputLines[0][1])+" - "+_n.toLineString(this._inputLines[1][0],this._inputLines[1][1])+this.getTopologySummary()},J.prototype.getEndpoint=function(o,s){return this._inputLines[o][s]},J.prototype.isIntersection=function(o){for(var s=0;s<this._result;s++)if(this._intPt[s].equals2D(o))return!0;return!1},J.prototype.getIntersectionAlongSegment=function(o,s){return this.computeIntLineIndex(),this._intPt[this._intLineIndex[o][s]]},J.prototype.interfaces_=function(){return[]},J.prototype.getClass=function(){return J},J.computeEdgeDistance=function(o,s,d){var _=Math.abs(d.x-s.x),w=Math.abs(d.y-s.y),j=-1;if(o.equals(s))j=0;else if(o.equals(d))j=_>w?_:w;else{var re=Math.abs(o.x-s.x),Pe=Math.abs(o.y-s.y);(j=_>w?re:Pe)!==0||o.equals(s)||(j=Math.max(re,Pe))}return Pt.isTrue(!(j===0&&!o.equals(s)),"Bad distance calculation"),j},J.nonRobustComputeEdgeDistance=function(o,s,d){var _=o.x-s.x,w=o.y-s.y,j=Math.sqrt(_*_+w*w);return Pt.isTrue(!(j===0&&!o.equals(s)),"Invalid distance calculation"),j},ze.DONT_INTERSECT.get=function(){return 0},ze.DO_INTERSECT.get=function(){return 1},ze.COLLINEAR.get=function(){return 2},ze.NO_INTERSECTION.get=function(){return 0},ze.POINT_INTERSECTION.get=function(){return 1},ze.COLLINEAR_INTERSECTION.get=function(){return 2},Object.defineProperties(J,ze);var $e=function(o){function s(){o.apply(this,arguments)}return o&&(s.__proto__=o),s.prototype=Object.create(o&&o.prototype),s.prototype.constructor=s,s.prototype.isInSegmentEnvelopes=function(d){var _=new _r(this._inputLines[0][0],this._inputLines[0][1]),w=new _r(this._inputLines[1][0],this._inputLines[1][1]);return _.contains(d)&&w.contains(d)},s.prototype.computeIntersection=function(){if(arguments.length!==3)return o.prototype.computeIntersection.apply(this,arguments);var d=arguments[0],_=arguments[1],w=arguments[2];if(this._isProper=!1,_r.intersects(_,w,d)&&wt.orientationIndex(_,w,d)===0&&wt.orientationIndex(w,_,d)===0)return this._isProper=!0,(d.equals(_)||d.equals(w))&&(this._isProper=!1),this._result=o.POINT_INTERSECTION,null;this._result=o.NO_INTERSECTION},s.prototype.normalizeToMinimum=function(d,_,w,j,re){re.x=this.smallestInAbsValue(d.x,_.x,w.x,j.x),re.y=this.smallestInAbsValue(d.y,_.y,w.y,j.y),d.x-=re.x,d.y-=re.y,_.x-=re.x,_.y-=re.y,w.x-=re.x,w.y-=re.y,j.x-=re.x,j.y-=re.y},s.prototype.safeHCoordinateIntersection=function(d,_,w,j){var re=null;try{re=Jr.intersection(d,_,w,j)}catch(Pe){if(!(Pe instanceof Sr))throw Pe;re=s.nearestEndpoint(d,_,w,j)}return re},s.prototype.intersection=function(d,_,w,j){var re=this.intersectionWithNormalization(d,_,w,j);return this.isInSegmentEnvelopes(re)||(re=new Y(s.nearestEndpoint(d,_,w,j))),this._precisionModel!==null&&this._precisionModel.makePrecise(re),re},s.prototype.smallestInAbsValue=function(d,_,w,j){var re=d,Pe=Math.abs(re);return Math.abs(_)<Pe&&(re=_,Pe=Math.abs(_)),Math.abs(w)<Pe&&(re=w,Pe=Math.abs(w)),Math.abs(j)<Pe&&(re=j),re},s.prototype.checkDD=function(d,_,w,j,re){var Pe=Rt.intersection(d,_,w,j),tt=this.isInSegmentEnvelopes(Pe);Qr.out.println("DD in env = "+tt+"  --------------------- "+Pe),re.distance(Pe)>1e-4&&Qr.out.println("Distance = "+re.distance(Pe))},s.prototype.intersectionWithNormalization=function(d,_,w,j){var re=new Y(d),Pe=new Y(_),tt=new Y(w),It=new Y(j),tr=new Y;this.normalizeToEnvCentre(re,Pe,tt,It,tr);var ot=this.safeHCoordinateIntersection(re,Pe,tt,It);return ot.x+=tr.x,ot.y+=tr.y,ot},s.prototype.computeCollinearIntersection=function(d,_,w,j){var re=_r.intersects(d,_,w),Pe=_r.intersects(d,_,j),tt=_r.intersects(w,j,d),It=_r.intersects(w,j,_);return re&&Pe?(this._intPt[0]=w,this._intPt[1]=j,o.COLLINEAR_INTERSECTION):tt&&It?(this._intPt[0]=d,this._intPt[1]=_,o.COLLINEAR_INTERSECTION):re&&tt?(this._intPt[0]=w,this._intPt[1]=d,!w.equals(d)||Pe||It?o.COLLINEAR_INTERSECTION:o.POINT_INTERSECTION):re&&It?(this._intPt[0]=w,this._intPt[1]=_,!w.equals(_)||Pe||tt?o.COLLINEAR_INTERSECTION:o.POINT_INTERSECTION):Pe&&tt?(this._intPt[0]=j,this._intPt[1]=d,!j.equals(d)||re||It?o.COLLINEAR_INTERSECTION:o.POINT_INTERSECTION):Pe&&It?(this._intPt[0]=j,this._intPt[1]=_,!j.equals(_)||re||tt?o.COLLINEAR_INTERSECTION:o.POINT_INTERSECTION):o.NO_INTERSECTION},s.prototype.normalizeToEnvCentre=function(d,_,w,j,re){var Pe=d.x<_.x?d.x:_.x,tt=d.y<_.y?d.y:_.y,It=d.x>_.x?d.x:_.x,tr=d.y>_.y?d.y:_.y,ot=w.x<j.x?w.x:j.x,Zt=w.y<j.y?w.y:j.y,Jt=w.x>j.x?w.x:j.x,gr=w.y>j.y?w.y:j.y,v=((Pe>ot?Pe:ot)+(It<Jt?It:Jt))/2,Ln=((tt>Zt?tt:Zt)+(tr<gr?tr:gr))/2;re.x=v,re.y=Ln,d.x-=re.x,d.y-=re.y,_.x-=re.x,_.y-=re.y,w.x-=re.x,w.y-=re.y,j.x-=re.x,j.y-=re.y},s.prototype.computeIntersect=function(d,_,w,j){if(this._isProper=!1,!_r.intersects(d,_,w,j))return o.NO_INTERSECTION;var re=wt.orientationIndex(d,_,w),Pe=wt.orientationIndex(d,_,j);if(re>0&&Pe>0||re<0&&Pe<0)return o.NO_INTERSECTION;var tt=wt.orientationIndex(w,j,d),It=wt.orientationIndex(w,j,_);return tt>0&&It>0||tt<0&&It<0?o.NO_INTERSECTION:re===0&&Pe===0&&tt===0&&It===0?this.computeCollinearIntersection(d,_,w,j):(re===0||Pe===0||tt===0||It===0?(this._isProper=!1,d.equals2D(w)||d.equals2D(j)?this._intPt[0]=d:_.equals2D(w)||_.equals2D(j)?this._intPt[0]=_:re===0?this._intPt[0]=new Y(w):Pe===0?this._intPt[0]=new Y(j):tt===0?this._intPt[0]=new Y(d):It===0&&(this._intPt[0]=new Y(_))):(this._isProper=!0,this._intPt[0]=this.intersection(d,_,w,j)),o.POINT_INTERSECTION)},s.prototype.interfaces_=function(){return[]},s.prototype.getClass=function(){return s},s.nearestEndpoint=function(d,_,w,j){var re=d,Pe=wt.distancePointLine(d,w,j),tt=wt.distancePointLine(_,w,j);return tt<Pe&&(Pe=tt,re=_),(tt=wt.distancePointLine(w,d,_))<Pe&&(Pe=tt,re=w),(tt=wt.distancePointLine(j,d,_))<Pe&&(Pe=tt,re=j),re},s}(J),At=function(){};At.prototype.interfaces_=function(){return[]},At.prototype.getClass=function(){return At},At.orientationIndex=function(o,s,d){var _=s.x-o.x,w=s.y-o.y,j=d.x-s.x,re=d.y-s.y;return At.signOfDet2x2(_,w,j,re)},At.signOfDet2x2=function(o,s,d,_){var w=null,j=null,re=null;if(w=1,o===0||_===0)return s===0||d===0?0:s>0?d>0?-w:w:d>0?w:-w;if(s===0||d===0)return _>0?o>0?w:-w:o>0?-w:w;if(s>0?_>0?s<=_||(w=-w,j=o,o=d,d=j,j=s,s=_,_=j):s<=-_?(w=-w,d=-d,_=-_):(j=o,o=-d,d=j,j=s,s=-_,_=j):_>0?-s<=_?(w=-w,o=-o,s=-s):(j=-o,o=d,d=j,j=-s,s=_,_=j):s>=_?(o=-o,s=-s,d=-d,_=-_):(w=-w,j=-o,o=-d,d=j,j=-s,s=-_,_=j),o>0){if(!(d>0)||!(o<=d))return w}else{if(d>0||!(o>=d))return-w;w=-w,o=-o,d=-d}for(;;){if(re=Math.floor(d/o),d-=re*o,(_-=re*s)<0)return-w;if(_>s)return w;if(o>d+d){if(s<_+_)return w}else{if(s>_+_)return-w;d=o-d,_=s-_,w=-w}if(_===0)return d===0?0:-w;if(d===0||(re=Math.floor(o/d),o-=re*d,(s-=re*_)<0))return w;if(s>_)return-w;if(d>o+o){if(_<s+s)return-w}else{if(_>s+s)return w;o=d-o,s=_-s,w=-w}if(s===0)return o===0?0:w;if(o===0)return-w}};var Lt=function(){this._p=null,this._crossingCount=0,this._isPointOnSegment=!1;var o=arguments[0];this._p=o};Lt.prototype.countSegment=function(o,s){if(o.x<this._p.x&&s.x<this._p.x)return null;if(this._p.x===s.x&&this._p.y===s.y)return this._isPointOnSegment=!0,null;if(o.y===this._p.y&&s.y===this._p.y){var d=o.x,_=s.x;return d>_&&(d=s.x,_=o.x),this._p.x>=d&&this._p.x<=_&&(this._isPointOnSegment=!0),null}if(o.y>this._p.y&&s.y<=this._p.y||s.y>this._p.y&&o.y<=this._p.y){var w=o.x-this._p.x,j=o.y-this._p.y,re=s.x-this._p.x,Pe=s.y-this._p.y,tt=At.signOfDet2x2(w,j,re,Pe);if(tt===0)return this._isPointOnSegment=!0,null;Pe<j&&(tt=-tt),tt>0&&this._crossingCount++}},Lt.prototype.isPointInPolygon=function(){return this.getLocation()!==ge.EXTERIOR},Lt.prototype.getLocation=function(){return this._isPointOnSegment?ge.BOUNDARY:this._crossingCount%2==1?ge.INTERIOR:ge.EXTERIOR},Lt.prototype.isOnSegment=function(){return this._isPointOnSegment},Lt.prototype.interfaces_=function(){return[]},Lt.prototype.getClass=function(){return Lt},Lt.locatePointInRing=function(){if(arguments[0]instanceof Y&&Me(arguments[1],Ut)){for(var o=arguments[0],s=arguments[1],d=new Lt(o),_=new Y,w=new Y,j=1;j<s.size();j++)if(s.getCoordinate(j,_),s.getCoordinate(j-1,w),d.countSegment(_,w),d.isOnSegment())return d.getLocation();return d.getLocation()}if(arguments[0]instanceof Y&&arguments[1]instanceof Array){for(var re=arguments[0],Pe=arguments[1],tt=new Lt(re),It=1;It<Pe.length;It++){var tr=Pe[It],ot=Pe[It-1];if(tt.countSegment(tr,ot),tt.isOnSegment())return tt.getLocation()}return tt.getLocation()}};var wt=function(){},yr={CLOCKWISE:{configurable:!0},RIGHT:{configurable:!0},COUNTERCLOCKWISE:{configurable:!0},LEFT:{configurable:!0},COLLINEAR:{configurable:!0},STRAIGHT:{configurable:!0}};wt.prototype.interfaces_=function(){return[]},wt.prototype.getClass=function(){return wt},wt.orientationIndex=function(o,s,d){return Rt.orientationIndex(o,s,d)},wt.signedArea=function(){if(arguments[0]instanceof Array){var o=arguments[0];if(o.length<3)return 0;for(var s=0,d=o[0].x,_=1;_<o.length-1;_++){var w=o[_].x-d,j=o[_+1].y;s+=w*(o[_-1].y-j)}return s/2}if(Me(arguments[0],Ut)){var re=arguments[0],Pe=re.size();if(Pe<3)return 0;var tt=new Y,It=new Y,tr=new Y;re.getCoordinate(0,It),re.getCoordinate(1,tr);var ot=It.x;tr.x-=ot;for(var Zt=0,Jt=1;Jt<Pe-1;Jt++)tt.y=It.y,It.x=tr.x,It.y=tr.y,re.getCoordinate(Jt+1,tr),tr.x-=ot,Zt+=It.x*(tt.y-tr.y);return Zt/2}},wt.distanceLineLine=function(o,s,d,_){if(o.equals(s))return wt.distancePointLine(o,d,_);if(d.equals(_))return wt.distancePointLine(_,o,s);var w=!1;if(_r.intersects(o,s,d,_)){var j=(s.x-o.x)*(_.y-d.y)-(s.y-o.y)*(_.x-d.x);if(j===0)w=!0;else{var re=(o.y-d.y)*(_.x-d.x)-(o.x-d.x)*(_.y-d.y),Pe=((o.y-d.y)*(s.x-o.x)-(o.x-d.x)*(s.y-o.y))/j,tt=re/j;(tt<0||tt>1||Pe<0||Pe>1)&&(w=!0)}}else w=!0;return w?Ae.min(wt.distancePointLine(o,d,_),wt.distancePointLine(s,d,_),wt.distancePointLine(d,o,s),wt.distancePointLine(_,o,s)):0},wt.isPointInRing=function(o,s){return wt.locatePointInRing(o,s)!==ge.EXTERIOR},wt.computeLength=function(o){var s=o.size();if(s<=1)return 0;var d=0,_=new Y;o.getCoordinate(0,_);for(var w=_.x,j=_.y,re=1;re<s;re++){o.getCoordinate(re,_);var Pe=_.x,tt=_.y,It=Pe-w,tr=tt-j;d+=Math.sqrt(It*It+tr*tr),w=Pe,j=tt}return d},wt.isCCW=function(o){var s=o.length-1;if(s<3)throw new Te("Ring has fewer than 4 points, so orientation cannot be determined");for(var d=o[0],_=0,w=1;w<=s;w++){var j=o[w];j.y>d.y&&(d=j,_=w)}var re=_;do(re-=1)<0&&(re=s);while(o[re].equals2D(d)&&re!==_);var Pe=_;do Pe=(Pe+1)%s;while(o[Pe].equals2D(d)&&Pe!==_);var tt=o[re],It=o[Pe];if(tt.equals2D(d)||It.equals2D(d)||tt.equals2D(It))return!1;var tr=wt.computeOrientation(tt,d,It),ot=!1;return ot=tr===0?tt.x>It.x:tr>0,ot},wt.locatePointInRing=function(o,s){return Lt.locatePointInRing(o,s)},wt.distancePointLinePerpendicular=function(o,s,d){var _=(d.x-s.x)*(d.x-s.x)+(d.y-s.y)*(d.y-s.y),w=((s.y-o.y)*(d.x-s.x)-(s.x-o.x)*(d.y-s.y))/_;return Math.abs(w)*Math.sqrt(_)},wt.computeOrientation=function(o,s,d){return wt.orientationIndex(o,s,d)},wt.distancePointLine=function(){if(arguments.length===2){var o=arguments[0],s=arguments[1];if(s.length===0)throw new Te("Line array must contain at least one vertex");for(var d=o.distance(s[0]),_=0;_<s.length-1;_++){var w=wt.distancePointLine(o,s[_],s[_+1]);w<d&&(d=w)}return d}if(arguments.length===3){var j=arguments[0],re=arguments[1],Pe=arguments[2];if(re.x===Pe.x&&re.y===Pe.y)return j.distance(re);var tt=(Pe.x-re.x)*(Pe.x-re.x)+(Pe.y-re.y)*(Pe.y-re.y),It=((j.x-re.x)*(Pe.x-re.x)+(j.y-re.y)*(Pe.y-re.y))/tt;if(It<=0)return j.distance(re);if(It>=1)return j.distance(Pe);var tr=((re.y-j.y)*(Pe.x-re.x)-(re.x-j.x)*(Pe.y-re.y))/tt;return Math.abs(tr)*Math.sqrt(tt)}},wt.isOnLine=function(o,s){for(var d=new $e,_=1;_<s.length;_++){var w=s[_-1],j=s[_];if(d.computeIntersection(o,w,j),d.hasIntersection())return!0}return!1},yr.CLOCKWISE.get=function(){return-1},yr.RIGHT.get=function(){return wt.CLOCKWISE},yr.COUNTERCLOCKWISE.get=function(){return 1},yr.LEFT.get=function(){return wt.COUNTERCLOCKWISE},yr.COLLINEAR.get=function(){return 0},yr.STRAIGHT.get=function(){return wt.COLLINEAR},Object.defineProperties(wt,yr);var vt=function(){};vt.prototype.filter=function(o){},vt.prototype.interfaces_=function(){return[]},vt.prototype.getClass=function(){return vt};var Tt=function(){var o=arguments[0];this._envelope=null,this._factory=null,this._SRID=null,this._userData=null,this._factory=o,this._SRID=o.getSRID()},Qt={serialVersionUID:{configurable:!0},SORTINDEX_POINT:{configurable:!0},SORTINDEX_MULTIPOINT:{configurable:!0},SORTINDEX_LINESTRING:{configurable:!0},SORTINDEX_LINEARRING:{configurable:!0},SORTINDEX_MULTILINESTRING:{configurable:!0},SORTINDEX_POLYGON:{configurable:!0},SORTINDEX_MULTIPOLYGON:{configurable:!0},SORTINDEX_GEOMETRYCOLLECTION:{configurable:!0},geometryChangedFilter:{configurable:!0}};Tt.prototype.isGeometryCollection=function(){return this.getSortIndex()===Tt.SORTINDEX_GEOMETRYCOLLECTION},Tt.prototype.getFactory=function(){return this._factory},Tt.prototype.getGeometryN=function(o){return this},Tt.prototype.getArea=function(){return 0},Tt.prototype.isRectangle=function(){return!1},Tt.prototype.equals=function(){if(arguments[0]instanceof Tt){var o=arguments[0];return o!==null&&this.equalsTopo(o)}if(arguments[0]instanceof Object){var s=arguments[0];if(!(s instanceof Tt))return!1;var d=s;return this.equalsExact(d)}},Tt.prototype.equalsExact=function(o){return this===o||this.equalsExact(o,0)},Tt.prototype.geometryChanged=function(){this.apply(Tt.geometryChangedFilter)},Tt.prototype.geometryChangedAction=function(){this._envelope=null},Tt.prototype.equalsNorm=function(o){return o!==null&&this.norm().equalsExact(o.norm())},Tt.prototype.getLength=function(){return 0},Tt.prototype.getNumGeometries=function(){return 1},Tt.prototype.compareTo=function(){if(arguments.length===1){var o=arguments[0],s=o;return this.getSortIndex()!==s.getSortIndex()?this.getSortIndex()-s.getSortIndex():this.isEmpty()&&s.isEmpty()?0:this.isEmpty()?-1:s.isEmpty()?1:this.compareToSameClass(o)}if(arguments.length===2){var d=arguments[0],_=arguments[1];return this.getSortIndex()!==d.getSortIndex()?this.getSortIndex()-d.getSortIndex():this.isEmpty()&&d.isEmpty()?0:this.isEmpty()?-1:d.isEmpty()?1:this.compareToSameClass(d,_)}},Tt.prototype.getUserData=function(){return this._userData},Tt.prototype.getSRID=function(){return this._SRID},Tt.prototype.getEnvelope=function(){return this.getFactory().toGeometry(this.getEnvelopeInternal())},Tt.prototype.checkNotGeometryCollection=function(o){if(o.getSortIndex()===Tt.SORTINDEX_GEOMETRYCOLLECTION)throw new Te("This method does not support GeometryCollection arguments")},Tt.prototype.equal=function(o,s,d){return d===0?o.equals(s):o.distance(s)<=d},Tt.prototype.norm=function(){var o=this.copy();return o.normalize(),o},Tt.prototype.getPrecisionModel=function(){return this._factory.getPrecisionModel()},Tt.prototype.getEnvelopeInternal=function(){return this._envelope===null&&(this._envelope=this.computeEnvelopeInternal()),new _r(this._envelope)},Tt.prototype.setSRID=function(o){this._SRID=o},Tt.prototype.setUserData=function(o){this._userData=o},Tt.prototype.compare=function(o,s){for(var d=o.iterator(),_=s.iterator();d.hasNext()&&_.hasNext();){var w=d.next(),j=_.next(),re=w.compareTo(j);if(re!==0)return re}return d.hasNext()?1:_.hasNext()?-1:0},Tt.prototype.hashCode=function(){return this.getEnvelopeInternal().hashCode()},Tt.prototype.isGeometryCollectionOrDerived=function(){return this.getSortIndex()===Tt.SORTINDEX_GEOMETRYCOLLECTION||this.getSortIndex()===Tt.SORTINDEX_MULTIPOINT||this.getSortIndex()===Tt.SORTINDEX_MULTILINESTRING||this.getSortIndex()===Tt.SORTINDEX_MULTIPOLYGON},Tt.prototype.interfaces_=function(){return[_e,ye,P]},Tt.prototype.getClass=function(){return Tt},Tt.hasNonEmptyElements=function(o){for(var s=0;s<o.length;s++)if(!o[s].isEmpty())return!0;return!1},Tt.hasNullElements=function(o){for(var s=0;s<o.length;s++)if(o[s]===null)return!0;return!1},Qt.serialVersionUID.get=function(){return 8763622679187377e3},Qt.SORTINDEX_POINT.get=function(){return 0},Qt.SORTINDEX_MULTIPOINT.get=function(){return 1},Qt.SORTINDEX_LINESTRING.get=function(){return 2},Qt.SORTINDEX_LINEARRING.get=function(){return 3},Qt.SORTINDEX_MULTILINESTRING.get=function(){return 4},Qt.SORTINDEX_POLYGON.get=function(){return 5},Qt.SORTINDEX_MULTIPOLYGON.get=function(){return 6},Qt.SORTINDEX_GEOMETRYCOLLECTION.get=function(){return 7},Qt.geometryChangedFilter.get=function(){return xr},Object.defineProperties(Tt,Qt);var xr=function(){};xr.interfaces_=function(){return[vt]},xr.filter=function(o){o.geometryChangedAction()};var kr=function(){};kr.prototype.filter=function(o){},kr.prototype.interfaces_=function(){return[]},kr.prototype.getClass=function(){return kr};var Wr=function(){},an={Mod2BoundaryNodeRule:{configurable:!0},EndPointBoundaryNodeRule:{configurable:!0},MultiValentEndPointBoundaryNodeRule:{configurable:!0},MonoValentEndPointBoundaryNodeRule:{configurable:!0},MOD2_BOUNDARY_RULE:{configurable:!0},ENDPOINT_BOUNDARY_RULE:{configurable:!0},MULTIVALENT_ENDPOINT_BOUNDARY_RULE:{configurable:!0},MONOVALENT_ENDPOINT_BOUNDARY_RULE:{configurable:!0},OGC_SFS_BOUNDARY_RULE:{configurable:!0}};Wr.prototype.isInBoundary=function(o){},Wr.prototype.interfaces_=function(){return[]},Wr.prototype.getClass=function(){return Wr},an.Mod2BoundaryNodeRule.get=function(){return Br},an.EndPointBoundaryNodeRule.get=function(){return en},an.MultiValentEndPointBoundaryNodeRule.get=function(){return Zn},an.MonoValentEndPointBoundaryNodeRule.get=function(){return zn},an.MOD2_BOUNDARY_RULE.get=function(){return new Br},an.ENDPOINT_BOUNDARY_RULE.get=function(){return new en},an.MULTIVALENT_ENDPOINT_BOUNDARY_RULE.get=function(){return new Zn},an.MONOVALENT_ENDPOINT_BOUNDARY_RULE.get=function(){return new zn},an.OGC_SFS_BOUNDARY_RULE.get=function(){return Wr.MOD2_BOUNDARY_RULE},Object.defineProperties(Wr,an);var Br=function(){};Br.prototype.isInBoundary=function(o){return o%2==1},Br.prototype.interfaces_=function(){return[Wr]},Br.prototype.getClass=function(){return Br};var en=function(){};en.prototype.isInBoundary=function(o){return o>0},en.prototype.interfaces_=function(){return[Wr]},en.prototype.getClass=function(){return en};var Zn=function(){};Zn.prototype.isInBoundary=function(o){return o>1},Zn.prototype.interfaces_=function(){return[Wr]},Zn.prototype.getClass=function(){return Zn};var zn=function(){};zn.prototype.isInBoundary=function(o){return o===1},zn.prototype.interfaces_=function(){return[Wr]},zn.prototype.getClass=function(){return zn};var li=function(){};li.prototype.add=function(){},li.prototype.addAll=function(){},li.prototype.isEmpty=function(){},li.prototype.iterator=function(){},li.prototype.size=function(){},li.prototype.toArray=function(){},li.prototype.remove=function(){},(D.prototype=new Error).name="IndexOutOfBoundsException";var sa=function(){};sa.prototype.hasNext=function(){},sa.prototype.next=function(){},sa.prototype.remove=function(){};var Oa=function(o){function s(){o.apply(this,arguments)}return o&&(s.__proto__=o),s.prototype=Object.create(o&&o.prototype),s.prototype.constructor=s,s.prototype.get=function(){},s.prototype.set=function(){},s.prototype.isEmpty=function(){},s}(li);(G.prototype=new Error).name="NoSuchElementException";var Gr=function(o){function s(){o.call(this),this.array_=[],arguments[0]instanceof li&&this.addAll(arguments[0])}return o&&(s.__proto__=o),s.prototype=Object.create(o&&o.prototype),s.prototype.constructor=s,s.prototype.ensureCapacity=function(){},s.prototype.interfaces_=function(){return[o,li]},s.prototype.add=function(d){return arguments.length===1?this.array_.push(d):this.array_.splice(arguments[0],arguments[1]),!0},s.prototype.clear=function(){this.array_=[]},s.prototype.addAll=function(d){for(var _=d.iterator();_.hasNext();)this.add(_.next());return!0},s.prototype.set=function(d,_){var w=this.array_[d];return this.array_[d]=_,w},s.prototype.iterator=function(){return new Ds(this)},s.prototype.get=function(d){if(d<0||d>=this.size())throw new D;return this.array_[d]},s.prototype.isEmpty=function(){return this.array_.length===0},s.prototype.size=function(){return this.array_.length},s.prototype.toArray=function(){for(var d=[],_=0,w=this.array_.length;_<w;_++)d.push(this.array_[_]);return d},s.prototype.remove=function(d){for(var _=!1,w=0,j=this.array_.length;w<j;w++)if(this.array_[w]===d){this.array_.splice(w,1),_=!0;break}return _},s}(Oa),Ds=function(o){function s(d){o.call(this),this.arrayList_=d,this.position_=0}return o&&(s.__proto__=o),s.prototype=Object.create(o&&o.prototype),s.prototype.constructor=s,s.prototype.next=function(){if(this.position_===this.arrayList_.size())throw new G;return this.arrayList_.get(this.position_++)},s.prototype.hasNext=function(){return this.position_<this.arrayList_.size()},s.prototype.set=function(d){return this.arrayList_.set(this.position_-1,d)},s.prototype.remove=function(){this.arrayList_.remove(this.arrayList_.get(this.position_))},s}(sa),Co=function(o){function s(){if(o.call(this),arguments.length!==0){if(arguments.length===1){var _=arguments[0];this.ensureCapacity(_.length),this.add(_,!0)}else if(arguments.length===2){var w=arguments[0],j=arguments[1];this.ensureCapacity(w.length),this.add(w,j)}}}o&&(s.__proto__=o),(s.prototype=Object.create(o&&o.prototype)).constructor=s;var d={coordArrayType:{configurable:!0}};return d.coordArrayType.get=function(){return new Array(0).fill(null)},s.prototype.getCoordinate=function(_){return this.get(_)},s.prototype.addAll=function(){if(arguments.length===2){for(var _=arguments[0],w=arguments[1],j=!1,re=_.iterator();re.hasNext();)this.add(re.next(),w),j=!0;return j}return o.prototype.addAll.apply(this,arguments)},s.prototype.clone=function(){for(var _=o.prototype.clone.call(this),w=0;w<this.size();w++)_.add(w,this.get(w).copy());return _},s.prototype.toCoordinateArray=function(){return this.toArray(s.coordArrayType)},s.prototype.add=function(){if(arguments.length===1){var _=arguments[0];o.prototype.add.call(this,_)}else if(arguments.length===2){if(arguments[0]instanceof Array&&typeof arguments[1]=="boolean"){var w=arguments[0],j=arguments[1];return this.add(w,j,!0),!0}if(arguments[0]instanceof Y&&typeof arguments[1]=="boolean"){var re=arguments[0];if(!arguments[1]&&this.size()>=1&&this.get(this.size()-1).equals2D(re))return null;o.prototype.add.call(this,re)}else if(arguments[0]instanceof Object&&typeof arguments[1]=="boolean"){var Pe=arguments[0],tt=arguments[1];return this.add(Pe,tt),!0}}else if(arguments.length===3){if(typeof arguments[2]=="boolean"&&arguments[0]instanceof Array&&typeof arguments[1]=="boolean"){var It=arguments[0],tr=arguments[1];if(arguments[2])for(var ot=0;ot<It.length;ot++)this.add(It[ot],tr);else for(var Zt=It.length-1;Zt>=0;Zt--)this.add(It[Zt],tr);return!0}if(typeof arguments[2]=="boolean"&&Number.isInteger(arguments[0])&&arguments[1]instanceof Y){var Jt=arguments[0],gr=arguments[1];if(!arguments[2]){var v=this.size();if(v>0&&(Jt>0&&this.get(Jt-1).equals2D(gr)||Jt<v&&this.get(Jt).equals2D(gr)))return null}o.prototype.add.call(this,Jt,gr)}}else if(arguments.length===4){var Ln=arguments[0],jn=arguments[1],Xe=arguments[2],Ma=arguments[3],ao=1;Xe>Ma&&(ao=-1);for(var xo=Xe;xo!==Ma;xo+=ao)this.add(Ln[xo],jn);return!0}},s.prototype.closeRing=function(){this.size()>0&&this.add(new Y(this.get(0)),!1)},s.prototype.interfaces_=function(){return[]},s.prototype.getClass=function(){return s},Object.defineProperties(s,d),s}(Gr),xn=function(){},xs={ForwardComparator:{configurable:!0},BidirectionalComparator:{configurable:!0},coordArrayType:{configurable:!0}};xs.ForwardComparator.get=function(){return go},xs.BidirectionalComparator.get=function(){return Ns},xs.coordArrayType.get=function(){return new Array(0).fill(null)},xn.prototype.interfaces_=function(){return[]},xn.prototype.getClass=function(){return xn},xn.isRing=function(o){return!(o.length<4)&&!!o[0].equals2D(o[o.length-1])},xn.ptNotInList=function(o,s){for(var d=0;d<o.length;d++){var _=o[d];if(xn.indexOf(_,s)<0)return _}return null},xn.scroll=function(o,s){var d=xn.indexOf(s,o);if(d<0)return null;var _=new Array(o.length).fill(null);Qr.arraycopy(o,d,_,0,o.length-d),Qr.arraycopy(o,0,_,o.length-d,d),Qr.arraycopy(_,0,o,0,o.length)},xn.equals=function(){if(arguments.length===2){var o=arguments[0],s=arguments[1];if(o===s)return!0;if(o===null||s===null||o.length!==s.length)return!1;for(var d=0;d<o.length;d++)if(!o[d].equals(s[d]))return!1;return!0}if(arguments.length===3){var _=arguments[0],w=arguments[1],j=arguments[2];if(_===w)return!0;if(_===null||w===null||_.length!==w.length)return!1;for(var re=0;re<_.length;re++)if(j.compare(_[re],w[re])!==0)return!1;return!0}},xn.intersection=function(o,s){for(var d=new Co,_=0;_<o.length;_++)s.intersects(o[_])&&d.add(o[_],!0);return d.toCoordinateArray()},xn.hasRepeatedPoints=function(o){for(var s=1;s<o.length;s++)if(o[s-1].equals(o[s]))return!0;return!1},xn.removeRepeatedPoints=function(o){return xn.hasRepeatedPoints(o)?new Co(o,!1).toCoordinateArray():o},xn.reverse=function(o){for(var s=o.length-1,d=Math.trunc(s/2),_=0;_<=d;_++){var w=o[_];o[_]=o[s-_],o[s-_]=w}},xn.removeNull=function(o){for(var s=0,d=0;d<o.length;d++)o[d]!==null&&s++;var _=new Array(s).fill(null);if(s===0)return _;for(var w=0,j=0;j<o.length;j++)o[j]!==null&&(_[w++]=o[j]);return _},xn.copyDeep=function(){if(arguments.length===1){for(var o=arguments[0],s=new Array(o.length).fill(null),d=0;d<o.length;d++)s[d]=new Y(o[d]);return s}if(arguments.length===5)for(var _=arguments[0],w=arguments[1],j=arguments[2],re=arguments[3],Pe=arguments[4],tt=0;tt<Pe;tt++)j[re+tt]=new Y(_[w+tt])},xn.isEqualReversed=function(o,s){for(var d=0;d<o.length;d++){var _=o[d],w=s[o.length-d-1];if(_.compareTo(w)!==0)return!1}return!0},xn.envelope=function(o){for(var s=new _r,d=0;d<o.length;d++)s.expandToInclude(o[d]);return s},xn.toCoordinateArray=function(o){return o.toArray(xn.coordArrayType)},xn.atLeastNCoordinatesOrNothing=function(o,s){return s.length>=o?s:[]},xn.indexOf=function(o,s){for(var d=0;d<s.length;d++)if(o.equals(s[d]))return d;return-1},xn.increasingDirection=function(o){for(var s=0;s<Math.trunc(o.length/2);s++){var d=o.length-1-s,_=o[s].compareTo(o[d]);if(_!==0)return _}return 1},xn.compare=function(o,s){for(var d=0;d<o.length&&d<s.length;){var _=o[d].compareTo(s[d]);if(_!==0)return _;d++}return d<s.length?-1:d<o.length?1:0},xn.minCoordinate=function(o){for(var s=null,d=0;d<o.length;d++)(s===null||s.compareTo(o[d])>0)&&(s=o[d]);return s},xn.extract=function(o,s,d){s=Ae.clamp(s,0,o.length);var _=(d=Ae.clamp(d,-1,o.length))-s+1;d<0&&(_=0),s>=o.length&&(_=0),d<s&&(_=0);var w=new Array(_).fill(null);if(_===0)return w;for(var j=0,re=s;re<=d;re++)w[j++]=o[re];return w},Object.defineProperties(xn,xs);var go=function(){};go.prototype.compare=function(o,s){return xn.compare(o,s)},go.prototype.interfaces_=function(){return[ne]},go.prototype.getClass=function(){return go};var Ns=function(){};Ns.prototype.compare=function(o,s){var d=o,_=s;if(d.length<_.length)return-1;if(d.length>_.length)return 1;if(d.length===0)return 0;var w=xn.compare(d,_);return xn.isEqualReversed(d,_)?0:w},Ns.prototype.OLDcompare=function(o,s){var d=o,_=s;if(d.length<_.length)return-1;if(d.length>_.length)return 1;if(d.length===0)return 0;for(var w=xn.increasingDirection(d),j=xn.increasingDirection(_),re=w>0?0:d.length-1,Pe=j>0?0:d.length-1,tt=0;tt<d.length;tt++){var It=d[re].compareTo(_[Pe]);if(It!==0)return It;re+=w,Pe+=j}return 0},Ns.prototype.interfaces_=function(){return[ne]},Ns.prototype.getClass=function(){return Ns};var Po=function(){};Po.prototype.get=function(){},Po.prototype.put=function(){},Po.prototype.size=function(){},Po.prototype.values=function(){},Po.prototype.entrySet=function(){};var hl=function(o){function s(){o.apply(this,arguments)}return o&&(s.__proto__=o),s.prototype=Object.create(o&&o.prototype),s.prototype.constructor=s,s}(Po);(Z.prototype=new Error).name="OperationNotSupported",(F.prototype=new li).contains=function(){};var yu=function(o){function s(){o.call(this),this.array_=[],arguments[0]instanceof li&&this.addAll(arguments[0])}return o&&(s.__proto__=o),s.prototype=Object.create(o&&o.prototype),s.prototype.constructor=s,s.prototype.contains=function(d){for(var _=0,w=this.array_.length;_<w;_++)if(this.array_[_]===d)return!0;return!1},s.prototype.add=function(d){return!this.contains(d)&&(this.array_.push(d),!0)},s.prototype.addAll=function(d){for(var _=d.iterator();_.hasNext();)this.add(_.next());return!0},s.prototype.remove=function(d){throw new Error},s.prototype.size=function(){return this.array_.length},s.prototype.isEmpty=function(){return this.array_.length===0},s.prototype.toArray=function(){for(var d=[],_=0,w=this.array_.length;_<w;_++)d.push(this.array_[_]);return d},s.prototype.iterator=function(){return new Es(this)},s}(F),Es=function(o){function s(d){o.call(this),this.hashSet_=d,this.position_=0}return o&&(s.__proto__=o),s.prototype=Object.create(o&&o.prototype),s.prototype.constructor=s,s.prototype.next=function(){if(this.position_===this.hashSet_.size())throw new G;return this.hashSet_.array_[this.position_++]},s.prototype.hasNext=function(){return this.position_<this.hashSet_.size()},s.prototype.remove=function(){throw new Z},s}(sa),fs=0;(Ie.prototype=new hl).get=function(o){for(var s=this.root_;s!==null;){var d=o.compareTo(s.key);if(d<0)s=s.left;else{if(!(d>0))return s.value;s=s.right}}return null},Ie.prototype.put=function(o,s){if(this.root_===null)return this.root_={key:o,value:s,left:null,right:null,parent:null,color:fs,getValue:function(){return this.value},getKey:function(){return this.key}},this.size_=1,null;var d,_,w=this.root_;do if(d=w,(_=o.compareTo(w.key))<0)w=w.left;else{if(!(_>0)){var j=w.value;return w.value=s,j}w=w.right}while(w!==null);var re={key:o,left:null,right:null,value:s,parent:d,color:fs,getValue:function(){return this.value},getKey:function(){return this.key}};return _<0?d.left=re:d.right=re,this.fixAfterInsertion(re),this.size_++,null},Ie.prototype.fixAfterInsertion=function(o){for(o.color=1;o!=null&&o!==this.root_&&o.parent.color===1;)if(q(o)===fe(q(q(o)))){var s=be(q(q(o)));z(s)===1?(ee(q(o),fs),ee(s,fs),ee(q(q(o)),1),o=q(q(o))):(o===be(q(o))&&(o=q(o),this.rotateLeft(o)),ee(q(o),fs),ee(q(q(o)),1),this.rotateRight(q(q(o))))}else{var d=fe(q(q(o)));z(d)===1?(ee(q(o),fs),ee(d,fs),ee(q(q(o)),1),o=q(q(o))):(o===fe(q(o))&&(o=q(o),this.rotateRight(o)),ee(q(o),fs),ee(q(q(o)),1),this.rotateLeft(q(q(o))))}this.root_.color=fs},Ie.prototype.values=function(){var o=new Gr,s=this.getFirstEntry();if(s!==null)for(o.add(s.value);(s=Ie.successor(s))!==null;)o.add(s.value);return o},Ie.prototype.entrySet=function(){var o=new yu,s=this.getFirstEntry();if(s!==null)for(o.add(s);(s=Ie.successor(s))!==null;)o.add(s);return o},Ie.prototype.rotateLeft=function(o){if(o!=null){var s=o.right;o.right=s.left,s.left!=null&&(s.left.parent=o),s.parent=o.parent,o.parent===null?this.root_=s:o.parent.left===o?o.parent.left=s:o.parent.right=s,s.left=o,o.parent=s}},Ie.prototype.rotateRight=function(o){if(o!=null){var s=o.left;o.left=s.right,s.right!=null&&(s.right.parent=o),s.parent=o.parent,o.parent===null?this.root_=s:o.parent.right===o?o.parent.right=s:o.parent.left=s,s.right=o,o.parent=s}},Ie.prototype.getFirstEntry=function(){var o=this.root_;if(o!=null)for(;o.left!=null;)o=o.left;return o},Ie.successor=function(o){if(o===null)return null;if(o.right!==null){for(var s=o.right;s.left!==null;)s=s.left;return s}for(var d=o.parent,_=o;d!==null&&_===d.right;)_=d,d=d.parent;return d},Ie.prototype.size=function(){return this.size_};var Ou=function(){};Ou.prototype.interfaces_=function(){return[]},Ou.prototype.getClass=function(){return Ou},Oe.prototype=new F,(He.prototype=new Oe).contains=function(o){for(var s=0,d=this.array_.length;s<d;s++)if(this.array_[s].compareTo(o)===0)return!0;return!1},He.prototype.add=function(o){if(this.contains(o))return!1;for(var s=0,d=this.array_.length;s<d;s++)if(this.array_[s].compareTo(o)===1)return this.array_.splice(s,0,o),!0;return this.array_.push(o),!0},He.prototype.addAll=function(o){for(var s=o.iterator();s.hasNext();)this.add(s.next());return!0},He.prototype.remove=function(o){throw new Z},He.prototype.size=function(){return this.array_.length},He.prototype.isEmpty=function(){return this.array_.length===0},He.prototype.toArray=function(){for(var o=[],s=0,d=this.array_.length;s<d;s++)o.push(this.array_[s]);return o},He.prototype.iterator=function(){return new Al(this)};var Al=function(o){this.treeSet_=o,this.position_=0};Al.prototype.next=function(){if(this.position_===this.treeSet_.size())throw new G;return this.treeSet_.array_[this.position_++]},Al.prototype.hasNext=function(){return this.position_<this.treeSet_.size()},Al.prototype.remove=function(){throw new Z};var da=function(){};da.sort=function(){var o,s,d,_,w=arguments[0];if(arguments.length===1)_=function(re,Pe){return re.compareTo(Pe)},w.sort(_);else if(arguments.length===2)d=arguments[1],_=function(re,Pe){return d.compare(re,Pe)},w.sort(_);else if(arguments.length===3){(s=w.slice(arguments[1],arguments[2])).sort();var j=w.slice(0,arguments[1]).concat(s,w.slice(arguments[2],w.length));for(w.splice(0,w.length),o=0;o<j.length;o++)w.push(j[o])}else if(arguments.length===4)for(s=w.slice(arguments[1],arguments[2]),d=arguments[3],_=function(re,Pe){return d.compare(re,Pe)},s.sort(_),j=w.slice(0,arguments[1]).concat(s,w.slice(arguments[2],w.length)),w.splice(0,w.length),o=0;o<j.length;o++)w.push(j[o])},da.asList=function(o){for(var s=new Gr,d=0,_=o.length;d<_;d++)s.add(o[d]);return s};var Zi=function(){},Fs={P:{configurable:!0},L:{configurable:!0},A:{configurable:!0},FALSE:{configurable:!0},TRUE:{configurable:!0},DONTCARE:{configurable:!0},SYM_FALSE:{configurable:!0},SYM_TRUE:{configurable:!0},SYM_DONTCARE:{configurable:!0},SYM_P:{configurable:!0},SYM_L:{configurable:!0},SYM_A:{configurable:!0}};Fs.P.get=function(){return 0},Fs.L.get=function(){return 1},Fs.A.get=function(){return 2},Fs.FALSE.get=function(){return-1},Fs.TRUE.get=function(){return-2},Fs.DONTCARE.get=function(){return-3},Fs.SYM_FALSE.get=function(){return"F"},Fs.SYM_TRUE.get=function(){return"T"},Fs.SYM_DONTCARE.get=function(){return"*"},Fs.SYM_P.get=function(){return"0"},Fs.SYM_L.get=function(){return"1"},Fs.SYM_A.get=function(){return"2"},Zi.prototype.interfaces_=function(){return[]},Zi.prototype.getClass=function(){return Zi},Zi.toDimensionSymbol=function(o){switch(o){case Zi.FALSE:return Zi.SYM_FALSE;case Zi.TRUE:return Zi.SYM_TRUE;case Zi.DONTCARE:return Zi.SYM_DONTCARE;case Zi.P:return Zi.SYM_P;case Zi.L:return Zi.SYM_L;case Zi.A:return Zi.SYM_A}throw new Te("Unknown dimension value: "+o)},Zi.toDimensionValue=function(o){switch(Ze.toUpperCase(o)){case Zi.SYM_FALSE:return Zi.FALSE;case Zi.SYM_TRUE:return Zi.TRUE;case Zi.SYM_DONTCARE:return Zi.DONTCARE;case Zi.SYM_P:return Zi.P;case Zi.SYM_L:return Zi.L;case Zi.SYM_A:return Zi.A}throw new Te("Unknown dimension symbol: "+o)},Object.defineProperties(Zi,Fs);var no=function(){};no.prototype.filter=function(o){},no.prototype.interfaces_=function(){return[]},no.prototype.getClass=function(){return no};var ts=function(){};ts.prototype.filter=function(o,s){},ts.prototype.isDone=function(){},ts.prototype.isGeometryChanged=function(){},ts.prototype.interfaces_=function(){return[]},ts.prototype.getClass=function(){return ts};var Oo=function(o){function s(_,w){if(o.call(this,w),this._geometries=_||[],o.hasNullElements(this._geometries))throw new Te("geometries must not contain null elements")}o&&(s.__proto__=o),(s.prototype=Object.create(o&&o.prototype)).constructor=s;var d={serialVersionUID:{configurable:!0}};return s.prototype.computeEnvelopeInternal=function(){for(var _=new _r,w=0;w<this._geometries.length;w++)_.expandToInclude(this._geometries[w].getEnvelopeInternal());return _},s.prototype.getGeometryN=function(_){return this._geometries[_]},s.prototype.getSortIndex=function(){return o.SORTINDEX_GEOMETRYCOLLECTION},s.prototype.getCoordinates=function(){for(var _=new Array(this.getNumPoints()).fill(null),w=-1,j=0;j<this._geometries.length;j++)for(var re=this._geometries[j].getCoordinates(),Pe=0;Pe<re.length;Pe++)_[++w]=re[Pe];return _},s.prototype.getArea=function(){for(var _=0,w=0;w<this._geometries.length;w++)_+=this._geometries[w].getArea();return _},s.prototype.equalsExact=function(){if(arguments.length===2){var _=arguments[0],w=arguments[1];if(!this.isEquivalentClass(_))return!1;var j=_;if(this._geometries.length!==j._geometries.length)return!1;for(var re=0;re<this._geometries.length;re++)if(!this._geometries[re].equalsExact(j._geometries[re],w))return!1;return!0}return o.prototype.equalsExact.apply(this,arguments)},s.prototype.normalize=function(){for(var _=0;_<this._geometries.length;_++)this._geometries[_].normalize();da.sort(this._geometries)},s.prototype.getCoordinate=function(){return this.isEmpty()?null:this._geometries[0].getCoordinate()},s.prototype.getBoundaryDimension=function(){for(var _=Zi.FALSE,w=0;w<this._geometries.length;w++)_=Math.max(_,this._geometries[w].getBoundaryDimension());return _},s.prototype.getDimension=function(){for(var _=Zi.FALSE,w=0;w<this._geometries.length;w++)_=Math.max(_,this._geometries[w].getDimension());return _},s.prototype.getLength=function(){for(var _=0,w=0;w<this._geometries.length;w++)_+=this._geometries[w].getLength();return _},s.prototype.getNumPoints=function(){for(var _=0,w=0;w<this._geometries.length;w++)_+=this._geometries[w].getNumPoints();return _},s.prototype.getNumGeometries=function(){return this._geometries.length},s.prototype.reverse=function(){for(var _=this._geometries.length,w=new Array(_).fill(null),j=0;j<this._geometries.length;j++)w[j]=this._geometries[j].reverse();return this.getFactory().createGeometryCollection(w)},s.prototype.compareToSameClass=function(){if(arguments.length===1){var _=arguments[0],w=new He(da.asList(this._geometries)),j=new He(da.asList(_._geometries));return this.compare(w,j)}if(arguments.length===2){for(var re=arguments[0],Pe=arguments[1],tt=re,It=this.getNumGeometries(),tr=tt.getNumGeometries(),ot=0;ot<It&&ot<tr;){var Zt=this.getGeometryN(ot),Jt=tt.getGeometryN(ot),gr=Zt.compareToSameClass(Jt,Pe);if(gr!==0)return gr;ot++}return ot<It?1:ot<tr?-1:0}},s.prototype.apply=function(){if(Me(arguments[0],kr))for(var _=arguments[0],w=0;w<this._geometries.length;w++)this._geometries[w].apply(_);else if(Me(arguments[0],ts)){var j=arguments[0];if(this._geometries.length===0)return null;for(var re=0;re<this._geometries.length&&(this._geometries[re].apply(j),!j.isDone());re++);j.isGeometryChanged()&&this.geometryChanged()}else if(Me(arguments[0],no)){var Pe=arguments[0];Pe.filter(this);for(var tt=0;tt<this._geometries.length;tt++)this._geometries[tt].apply(Pe)}else if(Me(arguments[0],vt)){var It=arguments[0];It.filter(this);for(var tr=0;tr<this._geometries.length;tr++)this._geometries[tr].apply(It)}},s.prototype.getBoundary=function(){return this.checkNotGeometryCollection(this),Pt.shouldNeverReachHere(),null},s.prototype.clone=function(){var _=o.prototype.clone.call(this);_._geometries=new Array(this._geometries.length).fill(null);for(var w=0;w<this._geometries.length;w++)_._geometries[w]=this._geometries[w].clone();return _},s.prototype.getGeometryType=function(){return"GeometryCollection"},s.prototype.copy=function(){for(var _=new Array(this._geometries.length).fill(null),w=0;w<_.length;w++)_[w]=this._geometries[w].copy();return new s(_,this._factory)},s.prototype.isEmpty=function(){for(var _=0;_<this._geometries.length;_++)if(!this._geometries[_].isEmpty())return!1;return!0},s.prototype.interfaces_=function(){return[]},s.prototype.getClass=function(){return s},d.serialVersionUID.get=function(){return-5694727726395021e3},Object.defineProperties(s,d),s}(Tt),Ni=function(o){function s(){o.apply(this,arguments)}o&&(s.__proto__=o),(s.prototype=Object.create(o&&o.prototype)).constructor=s;var d={serialVersionUID:{configurable:!0}};return s.prototype.getSortIndex=function(){return Tt.SORTINDEX_MULTILINESTRING},s.prototype.equalsExact=function(){if(arguments.length===2){var _=arguments[0],w=arguments[1];return!!this.isEquivalentClass(_)&&o.prototype.equalsExact.call(this,_,w)}return o.prototype.equalsExact.apply(this,arguments)},s.prototype.getBoundaryDimension=function(){return this.isClosed()?Zi.FALSE:0},s.prototype.isClosed=function(){if(this.isEmpty())return!1;for(var _=0;_<this._geometries.length;_++)if(!this._geometries[_].isClosed())return!1;return!0},s.prototype.getDimension=function(){return 1},s.prototype.reverse=function(){for(var _=this._geometries.length,w=new Array(_).fill(null),j=0;j<this._geometries.length;j++)w[_-1-j]=this._geometries[j].reverse();return this.getFactory().createMultiLineString(w)},s.prototype.getBoundary=function(){return new io(this).getBoundary()},s.prototype.getGeometryType=function(){return"MultiLineString"},s.prototype.copy=function(){for(var _=new Array(this._geometries.length).fill(null),w=0;w<_.length;w++)_[w]=this._geometries[w].copy();return new s(_,this._factory)},s.prototype.interfaces_=function(){return[Ou]},s.prototype.getClass=function(){return s},d.serialVersionUID.get=function(){return 8166665132445434e3},Object.defineProperties(s,d),s}(Oo),io=function(){if(this._geom=null,this._geomFact=null,this._bnRule=null,this._endpointMap=null,arguments.length===1){var o=arguments[0],s=Wr.MOD2_BOUNDARY_RULE;this._geom=o,this._geomFact=o.getFactory(),this._bnRule=s}else if(arguments.length===2){var d=arguments[0],_=arguments[1];this._geom=d,this._geomFact=d.getFactory(),this._bnRule=_}};io.prototype.boundaryMultiLineString=function(o){if(this._geom.isEmpty())return this.getEmptyMultiPoint();var s=this.computeBoundaryCoordinates(o);return s.length===1?this._geomFact.createPoint(s[0]):this._geomFact.createMultiPointFromCoords(s)},io.prototype.getBoundary=function(){return this._geom instanceof ya?this.boundaryLineString(this._geom):this._geom instanceof Ni?this.boundaryMultiLineString(this._geom):this._geom.getBoundary()},io.prototype.boundaryLineString=function(o){return this._geom.isEmpty()?this.getEmptyMultiPoint():o.isClosed()?this._bnRule.isInBoundary(2)?o.getStartPoint():this._geomFact.createMultiPoint():this._geomFact.createMultiPoint([o.getStartPoint(),o.getEndPoint()])},io.prototype.getEmptyMultiPoint=function(){return this._geomFact.createMultiPoint()},io.prototype.computeBoundaryCoordinates=function(o){var s=new Gr;this._endpointMap=new Ie;for(var d=0;d<o.getNumGeometries();d++){var _=o.getGeometryN(d);_.getNumPoints()!==0&&(this.addEndpoint(_.getCoordinateN(0)),this.addEndpoint(_.getCoordinateN(_.getNumPoints()-1)))}for(var w=this._endpointMap.entrySet().iterator();w.hasNext();){var j=w.next(),re=j.getValue().count;this._bnRule.isInBoundary(re)&&s.add(j.getKey())}return xn.toCoordinateArray(s)},io.prototype.addEndpoint=function(o){var s=this._endpointMap.get(o);s===null&&(s=new bs,this._endpointMap.put(o,s)),s.count++},io.prototype.interfaces_=function(){return[]},io.prototype.getClass=function(){return io},io.getBoundary=function(){if(arguments.length===1){var o=arguments[0];return new io(o).getBoundary()}if(arguments.length===2){var s=arguments[0],d=arguments[1];return new io(s,d).getBoundary()}};var bs=function(){this.count=null};bs.prototype.interfaces_=function(){return[]},bs.prototype.getClass=function(){return bs};var Wo=function(){},Ru={NEWLINE:{configurable:!0},SIMPLE_ORDINATE_FORMAT:{configurable:!0}};Wo.prototype.interfaces_=function(){return[]},Wo.prototype.getClass=function(){return Wo},Wo.chars=function(o,s){for(var d=new Array(s).fill(null),_=0;_<s;_++)d[_]=o;return String(d)},Wo.getStackTrace=function(){if(arguments.length===1){var o=arguments[0],s=new function(){},d=new function(){}(s);return o.printStackTrace(d),s.toString()}if(arguments.length===2){for(var _=arguments[0],w=arguments[1],j="",re=new function(){}(new function(){}(Wo.getStackTrace(_))),Pe=0;Pe<w;Pe++)try{j+=re.readLine()+Wo.NEWLINE}catch(tt){if(!(tt instanceof st))throw tt;Pt.shouldNeverReachHere()}return j}},Wo.split=function(o,s){for(var d=s.length,_=new Gr,w=""+o,j=w.indexOf(s);j>=0;){var re=w.substring(0,j);_.add(re),j=(w=w.substring(j+d)).indexOf(s)}w.length>0&&_.add(w);for(var Pe=new Array(_.size()).fill(null),tt=0;tt<Pe.length;tt++)Pe[tt]=_.get(tt);return Pe},Wo.toString=function(){if(arguments.length===1){var o=arguments[0];return Wo.SIMPLE_ORDINATE_FORMAT.format(o)}},Wo.spaces=function(o){return Wo.chars(" ",o)},Ru.NEWLINE.get=function(){return Qr.getProperty("line.separator")},Ru.SIMPLE_ORDINATE_FORMAT.get=function(){return new function(){}("0.#")},Object.defineProperties(Wo,Ru);var Sa=function(){};Sa.prototype.interfaces_=function(){return[]},Sa.prototype.getClass=function(){return Sa},Sa.copyCoord=function(o,s,d,_){for(var w=Math.min(o.getDimension(),d.getDimension()),j=0;j<w;j++)d.setOrdinate(_,j,o.getOrdinate(s,j))},Sa.isRing=function(o){var s=o.size();return s===0||!(s<=3)&&o.getOrdinate(0,Ut.X)===o.getOrdinate(s-1,Ut.X)&&o.getOrdinate(0,Ut.Y)===o.getOrdinate(s-1,Ut.Y)},Sa.isEqual=function(o,s){var d=o.size();if(d!==s.size())return!1;for(var _=Math.min(o.getDimension(),s.getDimension()),w=0;w<d;w++)for(var j=0;j<_;j++){var re=o.getOrdinate(w,j),Pe=s.getOrdinate(w,j);if(o.getOrdinate(w,j)!==s.getOrdinate(w,j)&&(!le.isNaN(re)||!le.isNaN(Pe)))return!1}return!0},Sa.extend=function(o,s,d){var _=o.create(d,s.getDimension()),w=s.size();if(Sa.copy(s,0,_,0,w),w>0)for(var j=w;j<d;j++)Sa.copy(s,w-1,_,j,1);return _},Sa.reverse=function(o){for(var s=o.size()-1,d=Math.trunc(s/2),_=0;_<=d;_++)Sa.swap(o,_,s-_)},Sa.swap=function(o,s,d){if(s===d)return null;for(var _=0;_<o.getDimension();_++){var w=o.getOrdinate(s,_);o.setOrdinate(s,_,o.getOrdinate(d,_)),o.setOrdinate(d,_,w)}},Sa.copy=function(o,s,d,_,w){for(var j=0;j<w;j++)Sa.copyCoord(o,s+j,d,_+j)},Sa.toString=function(){if(arguments.length===1){var o=arguments[0],s=o.size();if(s===0)return"()";var d=o.getDimension(),_=new ue;_.append("(");for(var w=0;w<s;w++){w>0&&_.append(" ");for(var j=0;j<d;j++)j>0&&_.append(","),_.append(Wo.toString(o.getOrdinate(w,j)))}return _.append(")"),_.toString()}},Sa.ensureValidRing=function(o,s){var d=s.size();return d===0?s:d<=3?Sa.createClosedRing(o,s,4):s.getOrdinate(0,Ut.X)===s.getOrdinate(d-1,Ut.X)&&s.getOrdinate(0,Ut.Y)===s.getOrdinate(d-1,Ut.Y)?s:Sa.createClosedRing(o,s,d+1)},Sa.createClosedRing=function(o,s,d){var _=o.create(d,s.getDimension()),w=s.size();Sa.copy(s,0,_,0,w);for(var j=w;j<d;j++)Sa.copy(s,0,_,j,1);return _};var ya=function(o){function s(_,w){o.call(this,w),this._points=null,this.init(_)}o&&(s.__proto__=o),(s.prototype=Object.create(o&&o.prototype)).constructor=s;var d={serialVersionUID:{configurable:!0}};return s.prototype.computeEnvelopeInternal=function(){return this.isEmpty()?new _r:this._points.expandEnvelope(new _r)},s.prototype.isRing=function(){return this.isClosed()&&this.isSimple()},s.prototype.getSortIndex=function(){return o.SORTINDEX_LINESTRING},s.prototype.getCoordinates=function(){return this._points.toCoordinateArray()},s.prototype.equalsExact=function(){if(arguments.length===2){var _=arguments[0],w=arguments[1];if(!this.isEquivalentClass(_))return!1;var j=_;if(this._points.size()!==j._points.size())return!1;for(var re=0;re<this._points.size();re++)if(!this.equal(this._points.getCoordinate(re),j._points.getCoordinate(re),w))return!1;return!0}return o.prototype.equalsExact.apply(this,arguments)},s.prototype.normalize=function(){for(var _=0;_<Math.trunc(this._points.size()/2);_++){var w=this._points.size()-1-_;if(!this._points.getCoordinate(_).equals(this._points.getCoordinate(w)))return this._points.getCoordinate(_).compareTo(this._points.getCoordinate(w))>0&&Sa.reverse(this._points),null}},s.prototype.getCoordinate=function(){return this.isEmpty()?null:this._points.getCoordinate(0)},s.prototype.getBoundaryDimension=function(){return this.isClosed()?Zi.FALSE:0},s.prototype.isClosed=function(){return!this.isEmpty()&&this.getCoordinateN(0).equals2D(this.getCoordinateN(this.getNumPoints()-1))},s.prototype.getEndPoint=function(){return this.isEmpty()?null:this.getPointN(this.getNumPoints()-1)},s.prototype.getDimension=function(){return 1},s.prototype.getLength=function(){return wt.computeLength(this._points)},s.prototype.getNumPoints=function(){return this._points.size()},s.prototype.reverse=function(){var _=this._points.copy();return Sa.reverse(_),this.getFactory().createLineString(_)},s.prototype.compareToSameClass=function(){if(arguments.length===1){for(var _=arguments[0],w=0,j=0;w<this._points.size()&&j<_._points.size();){var re=this._points.getCoordinate(w).compareTo(_._points.getCoordinate(j));if(re!==0)return re;w++,j++}return w<this._points.size()?1:j<_._points.size()?-1:0}if(arguments.length===2){var Pe=arguments[0];return arguments[1].compare(this._points,Pe._points)}},s.prototype.apply=function(){if(Me(arguments[0],kr))for(var _=arguments[0],w=0;w<this._points.size();w++)_.filter(this._points.getCoordinate(w));else if(Me(arguments[0],ts)){var j=arguments[0];if(this._points.size()===0)return null;for(var re=0;re<this._points.size()&&(j.filter(this._points,re),!j.isDone());re++);j.isGeometryChanged()&&this.geometryChanged()}else Me(arguments[0],no)?arguments[0].filter(this):Me(arguments[0],vt)&&arguments[0].filter(this)},s.prototype.getBoundary=function(){return new io(this).getBoundary()},s.prototype.isEquivalentClass=function(_){return _ instanceof s},s.prototype.clone=function(){var _=o.prototype.clone.call(this);return _._points=this._points.clone(),_},s.prototype.getCoordinateN=function(_){return this._points.getCoordinate(_)},s.prototype.getGeometryType=function(){return"LineString"},s.prototype.copy=function(){return new s(this._points.copy(),this._factory)},s.prototype.getCoordinateSequence=function(){return this._points},s.prototype.isEmpty=function(){return this._points.size()===0},s.prototype.init=function(_){if(_===null&&(_=this.getFactory().getCoordinateSequenceFactory().create([])),_.size()===1)throw new Te("Invalid number of points in LineString (found "+_.size()+" - must be 0 or >= 2)");this._points=_},s.prototype.isCoordinate=function(_){for(var w=0;w<this._points.size();w++)if(this._points.getCoordinate(w).equals(_))return!0;return!1},s.prototype.getStartPoint=function(){return this.isEmpty()?null:this.getPointN(0)},s.prototype.getPointN=function(_){return this.getFactory().createPoint(this._points.getCoordinate(_))},s.prototype.interfaces_=function(){return[Ou]},s.prototype.getClass=function(){return s},d.serialVersionUID.get=function(){return 0x2b2b51ba435c8e00},Object.defineProperties(s,d),s}(Tt),Ku=function(){};Ku.prototype.interfaces_=function(){return[]},Ku.prototype.getClass=function(){return Ku};var uo=function(o){function s(_,w){o.call(this,w),this._coordinates=_||null,this.init(this._coordinates)}o&&(s.__proto__=o),(s.prototype=Object.create(o&&o.prototype)).constructor=s;var d={serialVersionUID:{configurable:!0}};return s.prototype.computeEnvelopeInternal=function(){if(this.isEmpty())return new _r;var _=new _r;return _.expandToInclude(this._coordinates.getX(0),this._coordinates.getY(0)),_},s.prototype.getSortIndex=function(){return o.SORTINDEX_POINT},s.prototype.getCoordinates=function(){return this.isEmpty()?[]:[this.getCoordinate()]},s.prototype.equalsExact=function(){if(arguments.length===2){var _=arguments[0],w=arguments[1];return!!this.isEquivalentClass(_)&&(!(!this.isEmpty()||!_.isEmpty())||this.isEmpty()===_.isEmpty()&&this.equal(_.getCoordinate(),this.getCoordinate(),w))}return o.prototype.equalsExact.apply(this,arguments)},s.prototype.normalize=function(){},s.prototype.getCoordinate=function(){return this._coordinates.size()!==0?this._coordinates.getCoordinate(0):null},s.prototype.getBoundaryDimension=function(){return Zi.FALSE},s.prototype.getDimension=function(){return 0},s.prototype.getNumPoints=function(){return this.isEmpty()?0:1},s.prototype.reverse=function(){return this.copy()},s.prototype.getX=function(){if(this.getCoordinate()===null)throw new Error("getX called on empty Point");return this.getCoordinate().x},s.prototype.compareToSameClass=function(){if(arguments.length===1){var _=arguments[0];return this.getCoordinate().compareTo(_.getCoordinate())}if(arguments.length===2){var w=arguments[0];return arguments[1].compare(this._coordinates,w._coordinates)}},s.prototype.apply=function(){if(Me(arguments[0],kr)){var _=arguments[0];if(this.isEmpty())return null;_.filter(this.getCoordinate())}else if(Me(arguments[0],ts)){var w=arguments[0];if(this.isEmpty())return null;w.filter(this._coordinates,0),w.isGeometryChanged()&&this.geometryChanged()}else Me(arguments[0],no)?arguments[0].filter(this):Me(arguments[0],vt)&&arguments[0].filter(this)},s.prototype.getBoundary=function(){return this.getFactory().createGeometryCollection(null)},s.prototype.clone=function(){var _=o.prototype.clone.call(this);return _._coordinates=this._coordinates.clone(),_},s.prototype.getGeometryType=function(){return"Point"},s.prototype.copy=function(){return new s(this._coordinates.copy(),this._factory)},s.prototype.getCoordinateSequence=function(){return this._coordinates},s.prototype.getY=function(){if(this.getCoordinate()===null)throw new Error("getY called on empty Point");return this.getCoordinate().y},s.prototype.isEmpty=function(){return this._coordinates.size()===0},s.prototype.init=function(_){_===null&&(_=this.getFactory().getCoordinateSequenceFactory().create([])),Pt.isTrue(_.size()<=1),this._coordinates=_},s.prototype.isSimple=function(){return!0},s.prototype.interfaces_=function(){return[Ku]},s.prototype.getClass=function(){return s},d.serialVersionUID.get=function(){return 4902022702746615e3},Object.defineProperties(s,d),s}(Tt),Js=function(){};Js.prototype.interfaces_=function(){return[]},Js.prototype.getClass=function(){return Js};var Ca=function(o){function s(_,w,j){if(o.call(this,j),this._shell=null,this._holes=null,_===null&&(_=this.getFactory().createLinearRing()),w===null&&(w=[]),o.hasNullElements(w))throw new Te("holes must not contain null elements");if(_.isEmpty()&&o.hasNonEmptyElements(w))throw new Te("shell is empty but holes are not");this._shell=_,this._holes=w}o&&(s.__proto__=o),(s.prototype=Object.create(o&&o.prototype)).constructor=s;var d={serialVersionUID:{configurable:!0}};return s.prototype.computeEnvelopeInternal=function(){return this._shell.getEnvelopeInternal()},s.prototype.getSortIndex=function(){return o.SORTINDEX_POLYGON},s.prototype.getCoordinates=function(){if(this.isEmpty())return[];for(var _=new Array(this.getNumPoints()).fill(null),w=-1,j=this._shell.getCoordinates(),re=0;re<j.length;re++)_[++w]=j[re];for(var Pe=0;Pe<this._holes.length;Pe++)for(var tt=this._holes[Pe].getCoordinates(),It=0;It<tt.length;It++)_[++w]=tt[It];return _},s.prototype.getArea=function(){var _=0;_+=Math.abs(wt.signedArea(this._shell.getCoordinateSequence()));for(var w=0;w<this._holes.length;w++)_-=Math.abs(wt.signedArea(this._holes[w].getCoordinateSequence()));return _},s.prototype.isRectangle=function(){if(this.getNumInteriorRing()!==0||this._shell===null||this._shell.getNumPoints()!==5)return!1;for(var _=this._shell.getCoordinateSequence(),w=this.getEnvelopeInternal(),j=0;j<5;j++){var re=_.getX(j);if(re!==w.getMinX()&&re!==w.getMaxX())return!1;var Pe=_.getY(j);if(Pe!==w.getMinY()&&Pe!==w.getMaxY())return!1}for(var tt=_.getX(0),It=_.getY(0),tr=1;tr<=4;tr++){var ot=_.getX(tr),Zt=_.getY(tr);if(ot!==tt==(Zt!==It))return!1;tt=ot,It=Zt}return!0},s.prototype.equalsExact=function(){if(arguments.length===2){var _=arguments[0],w=arguments[1];if(!this.isEquivalentClass(_))return!1;var j=_,re=this._shell,Pe=j._shell;if(!re.equalsExact(Pe,w)||this._holes.length!==j._holes.length)return!1;for(var tt=0;tt<this._holes.length;tt++)if(!this._holes[tt].equalsExact(j._holes[tt],w))return!1;return!0}return o.prototype.equalsExact.apply(this,arguments)},s.prototype.normalize=function(){if(arguments.length===0){this.normalize(this._shell,!0);for(var _=0;_<this._holes.length;_++)this.normalize(this._holes[_],!1);da.sort(this._holes)}else if(arguments.length===2){var w=arguments[0],j=arguments[1];if(w.isEmpty())return null;var re=new Array(w.getCoordinates().length-1).fill(null);Qr.arraycopy(w.getCoordinates(),0,re,0,re.length);var Pe=xn.minCoordinate(w.getCoordinates());xn.scroll(re,Pe),Qr.arraycopy(re,0,w.getCoordinates(),0,re.length),w.getCoordinates()[re.length]=re[0],wt.isCCW(w.getCoordinates())===j&&xn.reverse(w.getCoordinates())}},s.prototype.getCoordinate=function(){return this._shell.getCoordinate()},s.prototype.getNumInteriorRing=function(){return this._holes.length},s.prototype.getBoundaryDimension=function(){return 1},s.prototype.getDimension=function(){return 2},s.prototype.getLength=function(){var _=0;_+=this._shell.getLength();for(var w=0;w<this._holes.length;w++)_+=this._holes[w].getLength();return _},s.prototype.getNumPoints=function(){for(var _=this._shell.getNumPoints(),w=0;w<this._holes.length;w++)_+=this._holes[w].getNumPoints();return _},s.prototype.reverse=function(){var _=this.copy();_._shell=this._shell.copy().reverse(),_._holes=new Array(this._holes.length).fill(null);for(var w=0;w<this._holes.length;w++)_._holes[w]=this._holes[w].copy().reverse();return _},s.prototype.convexHull=function(){return this.getExteriorRing().convexHull()},s.prototype.compareToSameClass=function(){if(arguments.length===1){var _=arguments[0],w=this._shell,j=_._shell;return w.compareToSameClass(j)}if(arguments.length===2){var re=arguments[0],Pe=arguments[1],tt=re,It=this._shell,tr=tt._shell,ot=It.compareToSameClass(tr,Pe);if(ot!==0)return ot;for(var Zt=this.getNumInteriorRing(),Jt=tt.getNumInteriorRing(),gr=0;gr<Zt&&gr<Jt;){var v=this.getInteriorRingN(gr),Ln=tt.getInteriorRingN(gr),jn=v.compareToSameClass(Ln,Pe);if(jn!==0)return jn;gr++}return gr<Zt?1:gr<Jt?-1:0}},s.prototype.apply=function(_){if(Me(_,kr)){this._shell.apply(_);for(var w=0;w<this._holes.length;w++)this._holes[w].apply(_)}else if(Me(_,ts)){if(this._shell.apply(_),!_.isDone())for(var j=0;j<this._holes.length&&(this._holes[j].apply(_),!_.isDone());j++);_.isGeometryChanged()&&this.geometryChanged()}else if(Me(_,no))_.filter(this);else if(Me(_,vt)){_.filter(this),this._shell.apply(_);for(var re=0;re<this._holes.length;re++)this._holes[re].apply(_)}},s.prototype.getBoundary=function(){if(this.isEmpty())return this.getFactory().createMultiLineString();var _=new Array(this._holes.length+1).fill(null);_[0]=this._shell;for(var w=0;w<this._holes.length;w++)_[w+1]=this._holes[w];return _.length<=1?this.getFactory().createLinearRing(_[0].getCoordinateSequence()):this.getFactory().createMultiLineString(_)},s.prototype.clone=function(){var _=o.prototype.clone.call(this);_._shell=this._shell.clone(),_._holes=new Array(this._holes.length).fill(null);for(var w=0;w<this._holes.length;w++)_._holes[w]=this._holes[w].clone();return _},s.prototype.getGeometryType=function(){return"Polygon"},s.prototype.copy=function(){for(var _=this._shell.copy(),w=new Array(this._holes.length).fill(null),j=0;j<w.length;j++)w[j]=this._holes[j].copy();return new s(_,w,this._factory)},s.prototype.getExteriorRing=function(){return this._shell},s.prototype.isEmpty=function(){return this._shell.isEmpty()},s.prototype.getInteriorRingN=function(_){return this._holes[_]},s.prototype.interfaces_=function(){return[Js]},s.prototype.getClass=function(){return s},d.serialVersionUID.get=function(){return-0x307ffefd8dc97200},Object.defineProperties(s,d),s}(Tt),uu=function(o){function s(){o.apply(this,arguments)}o&&(s.__proto__=o),(s.prototype=Object.create(o&&o.prototype)).constructor=s;var d={serialVersionUID:{configurable:!0}};return s.prototype.getSortIndex=function(){return Tt.SORTINDEX_MULTIPOINT},s.prototype.isValid=function(){return!0},s.prototype.equalsExact=function(){if(arguments.length===2){var _=arguments[0],w=arguments[1];return!!this.isEquivalentClass(_)&&o.prototype.equalsExact.call(this,_,w)}return o.prototype.equalsExact.apply(this,arguments)},s.prototype.getCoordinate=function(){if(arguments.length===1){var _=arguments[0];return this._geometries[_].getCoordinate()}return o.prototype.getCoordinate.apply(this,arguments)},s.prototype.getBoundaryDimension=function(){return Zi.FALSE},s.prototype.getDimension=function(){return 0},s.prototype.getBoundary=function(){return this.getFactory().createGeometryCollection(null)},s.prototype.getGeometryType=function(){return"MultiPoint"},s.prototype.copy=function(){for(var _=new Array(this._geometries.length).fill(null),w=0;w<_.length;w++)_[w]=this._geometries[w].copy();return new s(_,this._factory)},s.prototype.interfaces_=function(){return[Ku]},s.prototype.getClass=function(){return s},d.serialVersionUID.get=function(){return-8048474874175356e3},Object.defineProperties(s,d),s}(Oo),Mr=function(o){function s(_,w){_ instanceof Y&&w instanceof Ai&&(_=w.getCoordinateSequenceFactory().create(_)),o.call(this,_,w),this.validateConstruction()}o&&(s.__proto__=o),(s.prototype=Object.create(o&&o.prototype)).constructor=s;var d={MINIMUM_VALID_SIZE:{configurable:!0},serialVersionUID:{configurable:!0}};return s.prototype.getSortIndex=function(){return Tt.SORTINDEX_LINEARRING},s.prototype.getBoundaryDimension=function(){return Zi.FALSE},s.prototype.isClosed=function(){return!!this.isEmpty()||o.prototype.isClosed.call(this)},s.prototype.reverse=function(){var _=this._points.copy();return Sa.reverse(_),this.getFactory().createLinearRing(_)},s.prototype.validateConstruction=function(){if(!this.isEmpty()&&!o.prototype.isClosed.call(this))throw new Te("Points of LinearRing do not form a closed linestring");if(this.getCoordinateSequence().size()>=1&&this.getCoordinateSequence().size()<s.MINIMUM_VALID_SIZE)throw new Te("Invalid number of points in LinearRing (found "+this.getCoordinateSequence().size()+" - must be 0 or >= 4)")},s.prototype.getGeometryType=function(){return"LinearRing"},s.prototype.copy=function(){return new s(this._points.copy(),this._factory)},s.prototype.interfaces_=function(){return[]},s.prototype.getClass=function(){return s},d.MINIMUM_VALID_SIZE.get=function(){return 4},d.serialVersionUID.get=function(){return-0x3b229e262367a600},Object.defineProperties(s,d),s}(ya),vn=function(o){function s(){o.apply(this,arguments)}o&&(s.__proto__=o),(s.prototype=Object.create(o&&o.prototype)).constructor=s;var d={serialVersionUID:{configurable:!0}};return s.prototype.getSortIndex=function(){return Tt.SORTINDEX_MULTIPOLYGON},s.prototype.equalsExact=function(){if(arguments.length===2){var _=arguments[0],w=arguments[1];return!!this.isEquivalentClass(_)&&o.prototype.equalsExact.call(this,_,w)}return o.prototype.equalsExact.apply(this,arguments)},s.prototype.getBoundaryDimension=function(){return 1},s.prototype.getDimension=function(){return 2},s.prototype.reverse=function(){for(var _=this._geometries.length,w=new Array(_).fill(null),j=0;j<this._geometries.length;j++)w[j]=this._geometries[j].reverse();return this.getFactory().createMultiPolygon(w)},s.prototype.getBoundary=function(){if(this.isEmpty())return this.getFactory().createMultiLineString();for(var _=new Gr,w=0;w<this._geometries.length;w++)for(var j=this._geometries[w].getBoundary(),re=0;re<j.getNumGeometries();re++)_.add(j.getGeometryN(re));var Pe=new Array(_.size()).fill(null);return this.getFactory().createMultiLineString(_.toArray(Pe))},s.prototype.getGeometryType=function(){return"MultiPolygon"},s.prototype.copy=function(){for(var _=new Array(this._geometries.length).fill(null),w=0;w<_.length;w++)_[w]=this._geometries[w].copy();return new s(_,this._factory)},s.prototype.interfaces_=function(){return[Js]},s.prototype.getClass=function(){return s},d.serialVersionUID.get=function(){return-0x7a5aa1369171980},Object.defineProperties(s,d),s}(Oo),lo=function(o){this._factory=o||null,this._isUserDataCopied=!1},eu={NoOpGeometryOperation:{configurable:!0},CoordinateOperation:{configurable:!0},CoordinateSequenceOperation:{configurable:!0}};lo.prototype.setCopyUserData=function(o){this._isUserDataCopied=o},lo.prototype.edit=function(o,s){if(o===null)return null;var d=this.editInternal(o,s);return this._isUserDataCopied&&d.setUserData(o.getUserData()),d},lo.prototype.editInternal=function(o,s){return this._factory===null&&(this._factory=o.getFactory()),o instanceof Oo?this.editGeometryCollection(o,s):o instanceof Ca?this.editPolygon(o,s):o instanceof uo?s.edit(o,this._factory):o instanceof ya?s.edit(o,this._factory):(Pt.shouldNeverReachHere("Unsupported Geometry class: "+o.getClass().getName()),null)},lo.prototype.editGeometryCollection=function(o,s){for(var d=s.edit(o,this._factory),_=new Gr,w=0;w<d.getNumGeometries();w++){var j=this.edit(d.getGeometryN(w),s);j===null||j.isEmpty()||_.add(j)}return d.getClass()===uu?this._factory.createMultiPoint(_.toArray([])):d.getClass()===Ni?this._factory.createMultiLineString(_.toArray([])):d.getClass()===vn?this._factory.createMultiPolygon(_.toArray([])):this._factory.createGeometryCollection(_.toArray([]))},lo.prototype.editPolygon=function(o,s){var d=s.edit(o,this._factory);if(d===null&&(d=this._factory.createPolygon(null)),d.isEmpty())return d;var _=this.edit(d.getExteriorRing(),s);if(_===null||_.isEmpty())return this._factory.createPolygon();for(var w=new Gr,j=0;j<d.getNumInteriorRing();j++){var re=this.edit(d.getInteriorRingN(j),s);re===null||re.isEmpty()||w.add(re)}return this._factory.createPolygon(_,w.toArray([]))},lo.prototype.interfaces_=function(){return[]},lo.prototype.getClass=function(){return lo},lo.GeometryEditorOperation=function(){},eu.NoOpGeometryOperation.get=function(){return tu},eu.CoordinateOperation.get=function(){return Ss},eu.CoordinateSequenceOperation.get=function(){return Bs},Object.defineProperties(lo,eu);var tu=function(){};tu.prototype.edit=function(o,s){return o},tu.prototype.interfaces_=function(){return[lo.GeometryEditorOperation]},tu.prototype.getClass=function(){return tu};var Ss=function(){};Ss.prototype.edit=function(o,s){var d=this.editCoordinates(o.getCoordinates(),o);return d===null?o:o instanceof Mr?s.createLinearRing(d):o instanceof ya?s.createLineString(d):o instanceof uo?d.length>0?s.createPoint(d[0]):s.createPoint():o},Ss.prototype.interfaces_=function(){return[lo.GeometryEditorOperation]},Ss.prototype.getClass=function(){return Ss};var Bs=function(){};Bs.prototype.edit=function(o,s){return o instanceof Mr?s.createLinearRing(this.edit(o.getCoordinateSequence(),o)):o instanceof ya?s.createLineString(this.edit(o.getCoordinateSequence(),o)):o instanceof uo?s.createPoint(this.edit(o.getCoordinateSequence(),o)):o},Bs.prototype.interfaces_=function(){return[lo.GeometryEditorOperation]},Bs.prototype.getClass=function(){return Bs};var ja=function(){if(this._dimension=3,this._coordinates=null,arguments.length===1){if(arguments[0]instanceof Array)this._coordinates=arguments[0],this._dimension=3;else if(Number.isInteger(arguments[0])){var o=arguments[0];this._coordinates=new Array(o).fill(null);for(var s=0;s<o;s++)this._coordinates[s]=new Y}else if(Me(arguments[0],Ut)){var d=arguments[0];if(d===null)return this._coordinates=new Array(0).fill(null),null;this._dimension=d.getDimension(),this._coordinates=new Array(d.size()).fill(null);for(var _=0;_<this._coordinates.length;_++)this._coordinates[_]=d.getCoordinateCopy(_)}}else if(arguments.length===2){if(arguments[0]instanceof Array&&Number.isInteger(arguments[1])){var w=arguments[0],j=arguments[1];this._coordinates=w,this._dimension=j,w===null&&(this._coordinates=new Array(0).fill(null))}else if(Number.isInteger(arguments[0])&&Number.isInteger(arguments[1])){var re=arguments[0],Pe=arguments[1];this._coordinates=new Array(re).fill(null),this._dimension=Pe;for(var tt=0;tt<re;tt++)this._coordinates[tt]=new Y}}},Yc={serialVersionUID:{configurable:!0}};ja.prototype.setOrdinate=function(o,s,d){switch(s){case Ut.X:this._coordinates[o].x=d;break;case Ut.Y:this._coordinates[o].y=d;break;case Ut.Z:this._coordinates[o].z=d;break;default:throw new Te("invalid ordinateIndex")}},ja.prototype.size=function(){return this._coordinates.length},ja.prototype.getOrdinate=function(o,s){switch(s){case Ut.X:return this._coordinates[o].x;case Ut.Y:return this._coordinates[o].y;case Ut.Z:return this._coordinates[o].z}return le.NaN},ja.prototype.getCoordinate=function(){if(arguments.length===1){var o=arguments[0];return this._coordinates[o]}if(arguments.length===2){var s=arguments[0],d=arguments[1];d.x=this._coordinates[s].x,d.y=this._coordinates[s].y,d.z=this._coordinates[s].z}},ja.prototype.getCoordinateCopy=function(o){return new Y(this._coordinates[o])},ja.prototype.getDimension=function(){return this._dimension},ja.prototype.getX=function(o){return this._coordinates[o].x},ja.prototype.clone=function(){for(var o=new Array(this.size()).fill(null),s=0;s<this._coordinates.length;s++)o[s]=this._coordinates[s].clone();return new ja(o,this._dimension)},ja.prototype.expandEnvelope=function(o){for(var s=0;s<this._coordinates.length;s++)o.expandToInclude(this._coordinates[s]);return o},ja.prototype.copy=function(){for(var o=new Array(this.size()).fill(null),s=0;s<this._coordinates.length;s++)o[s]=this._coordinates[s].copy();return new ja(o,this._dimension)},ja.prototype.toString=function(){if(this._coordinates.length>0){var o=new ue(17*this._coordinates.length);o.append("("),o.append(this._coordinates[0]);for(var s=1;s<this._coordinates.length;s++)o.append(", "),o.append(this._coordinates[s]);return o.append(")"),o.toString()}return"()"},ja.prototype.getY=function(o){return this._coordinates[o].y},ja.prototype.toCoordinateArray=function(){return this._coordinates},ja.prototype.interfaces_=function(){return[Ut,P]},ja.prototype.getClass=function(){return ja},Yc.serialVersionUID.get=function(){return-0xcb44a778db18e00},Object.defineProperties(ja,Yc);var Cs=function(){},rs={serialVersionUID:{configurable:!0},instanceObject:{configurable:!0}};Cs.prototype.readResolve=function(){return Cs.instance()},Cs.prototype.create=function(){if(arguments.length===1){if(arguments[0]instanceof Array){var o=arguments[0];return new ja(o)}if(Me(arguments[0],Ut)){var s=arguments[0];return new ja(s)}}else if(arguments.length===2){var d=arguments[0],_=arguments[1];return _>3&&(_=3),_<2?new ja(d):new ja(d,_)}},Cs.prototype.interfaces_=function(){return[Ee,P]},Cs.prototype.getClass=function(){return Cs},Cs.instance=function(){return Cs.instanceObject},rs.serialVersionUID.get=function(){return-0x38e49fa6cf6f2e00},rs.instanceObject.get=function(){return new Cs},Object.defineProperties(Cs,rs);var Ll=function(o){function s(){o.call(this),this.map_=new Map}return o&&(s.__proto__=o),s.prototype=Object.create(o&&o.prototype),s.prototype.constructor=s,s.prototype.get=function(d){return this.map_.get(d)||null},s.prototype.put=function(d,_){return this.map_.set(d,_),_},s.prototype.values=function(){for(var d=new Gr,_=this.map_.values(),w=_.next();!w.done;)d.add(w.value),w=_.next();return d},s.prototype.entrySet=function(){var d=new yu;return this.map_.entries().forEach(function(_){return d.add(_)}),d},s.prototype.size=function(){return this.map_.size()},s}(Po),zi=function o(){if(this._modelType=null,this._scale=null,arguments.length===0)this._modelType=o.FLOATING;else if(arguments.length===1){if(arguments[0]instanceof Ro){var s=arguments[0];this._modelType=s,s===o.FIXED&&this.setScale(1)}else if(typeof arguments[0]=="number"){var d=arguments[0];this._modelType=o.FIXED,this.setScale(d)}else if(arguments[0]instanceof o){var _=arguments[0];this._modelType=_._modelType,this._scale=_._scale}}},Pl={serialVersionUID:{configurable:!0},maximumPreciseValue:{configurable:!0}};zi.prototype.equals=function(o){if(!(o instanceof zi))return!1;var s=o;return this._modelType===s._modelType&&this._scale===s._scale},zi.prototype.compareTo=function(o){var s=o,d=this.getMaximumSignificantDigits(),_=s.getMaximumSignificantDigits();return new ke(d).compareTo(new ke(_))},zi.prototype.getScale=function(){return this._scale},zi.prototype.isFloating=function(){return this._modelType===zi.FLOATING||this._modelType===zi.FLOATING_SINGLE},zi.prototype.getType=function(){return this._modelType},zi.prototype.toString=function(){var o="UNKNOWN";return this._modelType===zi.FLOATING?o="Floating":this._modelType===zi.FLOATING_SINGLE?o="Floating-Single":this._modelType===zi.FIXED&&(o="Fixed (Scale="+this.getScale()+")"),o},zi.prototype.makePrecise=function(){if(typeof arguments[0]=="number"){var o=arguments[0];return le.isNaN(o)||this._modelType===zi.FLOATING_SINGLE?o:this._modelType===zi.FIXED?Math.round(o*this._scale)/this._scale:o}if(arguments[0]instanceof Y){var s=arguments[0];if(this._modelType===zi.FLOATING)return null;s.x=this.makePrecise(s.x),s.y=this.makePrecise(s.y)}},zi.prototype.getMaximumSignificantDigits=function(){var o=16;return this._modelType===zi.FLOATING?o=16:this._modelType===zi.FLOATING_SINGLE?o=6:this._modelType===zi.FIXED&&(o=1+Math.trunc(Math.ceil(Math.log(this.getScale())/Math.log(10)))),o},zi.prototype.setScale=function(o){this._scale=Math.abs(o)},zi.prototype.interfaces_=function(){return[P,ye]},zi.prototype.getClass=function(){return zi},zi.mostPrecise=function(o,s){return o.compareTo(s)>=0?o:s},Pl.serialVersionUID.get=function(){return 7777263578777804e3},Pl.maximumPreciseValue.get=function(){return 9007199254740992},Object.defineProperties(zi,Pl);var Ro=function o(s){this._name=s||null,o.nameToTypeMap.put(s,this)},pl={serialVersionUID:{configurable:!0},nameToTypeMap:{configurable:!0}};Ro.prototype.readResolve=function(){return Ro.nameToTypeMap.get(this._name)},Ro.prototype.toString=function(){return this._name},Ro.prototype.interfaces_=function(){return[P]},Ro.prototype.getClass=function(){return Ro},pl.serialVersionUID.get=function(){return-552860263173159e4},pl.nameToTypeMap.get=function(){return new Ll},Object.defineProperties(Ro,pl),zi.Type=Ro,zi.FIXED=new Ro("FIXED"),zi.FLOATING=new Ro("FLOATING"),zi.FLOATING_SINGLE=new Ro("FLOATING SINGLE");var Ai=function o(){this._precisionModel=new zi,this._SRID=0,this._coordinateSequenceFactory=o.getDefaultCoordinateSequenceFactory(),arguments.length===0||(arguments.length===1?Me(arguments[0],Ee)?this._coordinateSequenceFactory=arguments[0]:arguments[0]instanceof zi&&(this._precisionModel=arguments[0]):arguments.length===2?(this._precisionModel=arguments[0],this._SRID=arguments[1]):arguments.length===3&&(this._precisionModel=arguments[0],this._SRID=arguments[1],this._coordinateSequenceFactory=arguments[2]))},_u={serialVersionUID:{configurable:!0}};Ai.prototype.toGeometry=function(o){return o.isNull()?this.createPoint(null):o.getMinX()===o.getMaxX()&&o.getMinY()===o.getMaxY()?this.createPoint(new Y(o.getMinX(),o.getMinY())):o.getMinX()===o.getMaxX()||o.getMinY()===o.getMaxY()?this.createLineString([new Y(o.getMinX(),o.getMinY()),new Y(o.getMaxX(),o.getMaxY())]):this.createPolygon(this.createLinearRing([new Y(o.getMinX(),o.getMinY()),new Y(o.getMinX(),o.getMaxY()),new Y(o.getMaxX(),o.getMaxY()),new Y(o.getMaxX(),o.getMinY()),new Y(o.getMinX(),o.getMinY())]),null)},Ai.prototype.createLineString=function(o){return o?o instanceof Array?new ya(this.getCoordinateSequenceFactory().create(o),this):Me(o,Ut)?new ya(o,this):void 0:new ya(this.getCoordinateSequenceFactory().create([]),this)},Ai.prototype.createMultiLineString=function(){if(arguments.length===0)return new Ni(null,this);if(arguments.length===1){var o=arguments[0];return new Ni(o,this)}},Ai.prototype.buildGeometry=function(o){for(var s=null,d=!1,_=!1,w=o.iterator();w.hasNext();){var j=w.next(),re=j.getClass();s===null&&(s=re),re!==s&&(d=!0),j.isGeometryCollectionOrDerived()&&(_=!0)}if(s===null)return this.createGeometryCollection();if(d||_)return this.createGeometryCollection(Ai.toGeometryArray(o));var Pe=o.iterator().next();if(o.size()>1){if(Pe instanceof Ca)return this.createMultiPolygon(Ai.toPolygonArray(o));if(Pe instanceof ya)return this.createMultiLineString(Ai.toLineStringArray(o));if(Pe instanceof uo)return this.createMultiPoint(Ai.toPointArray(o));Pt.shouldNeverReachHere("Unhandled class: "+Pe.getClass().getName())}return Pe},Ai.prototype.createMultiPointFromCoords=function(o){return this.createMultiPoint(o!==null?this.getCoordinateSequenceFactory().create(o):null)},Ai.prototype.createPoint=function(){if(arguments.length===0)return this.createPoint(this.getCoordinateSequenceFactory().create([]));if(arguments.length===1){if(arguments[0]instanceof Y){var o=arguments[0];return this.createPoint(o!==null?this.getCoordinateSequenceFactory().create([o]):null)}if(Me(arguments[0],Ut)){var s=arguments[0];return new uo(s,this)}}},Ai.prototype.getCoordinateSequenceFactory=function(){return this._coordinateSequenceFactory},Ai.prototype.createPolygon=function(){if(arguments.length===0)return new Ca(null,null,this);if(arguments.length===1){if(Me(arguments[0],Ut)){var o=arguments[0];return this.createPolygon(this.createLinearRing(o))}if(arguments[0]instanceof Array){var s=arguments[0];return this.createPolygon(this.createLinearRing(s))}if(arguments[0]instanceof Mr){var d=arguments[0];return this.createPolygon(d,null)}}else if(arguments.length===2){var _=arguments[0],w=arguments[1];return new Ca(_,w,this)}},Ai.prototype.getSRID=function(){return this._SRID},Ai.prototype.createGeometryCollection=function(){if(arguments.length===0)return new Oo(null,this);if(arguments.length===1){var o=arguments[0];return new Oo(o,this)}},Ai.prototype.createGeometry=function(o){return new lo(this).edit(o,{edit:function(){if(arguments.length===2){var s=arguments[0];return this._coordinateSequenceFactory.create(s)}}})},Ai.prototype.getPrecisionModel=function(){return this._precisionModel},Ai.prototype.createLinearRing=function(){if(arguments.length===0)return this.createLinearRing(this.getCoordinateSequenceFactory().create([]));if(arguments.length===1){if(arguments[0]instanceof Array){var o=arguments[0];return this.createLinearRing(o!==null?this.getCoordinateSequenceFactory().create(o):null)}if(Me(arguments[0],Ut)){var s=arguments[0];return new Mr(s,this)}}},Ai.prototype.createMultiPolygon=function(){if(arguments.length===0)return new vn(null,this);if(arguments.length===1){var o=arguments[0];return new vn(o,this)}},Ai.prototype.createMultiPoint=function(){if(arguments.length===0)return new uu(null,this);if(arguments.length===1){if(arguments[0]instanceof Array){var o=arguments[0];return new uu(o,this)}if(arguments[0]instanceof Array){var s=arguments[0];return this.createMultiPoint(s!==null?this.getCoordinateSequenceFactory().create(s):null)}if(Me(arguments[0],Ut)){var d=arguments[0];if(d===null)return this.createMultiPoint(new Array(0).fill(null));for(var _=new Array(d.size()).fill(null),w=0;w<d.size();w++){var j=this.getCoordinateSequenceFactory().create(1,d.getDimension());Sa.copy(d,w,j,0,1),_[w]=this.createPoint(j)}return this.createMultiPoint(_)}}},Ai.prototype.interfaces_=function(){return[P]},Ai.prototype.getClass=function(){return Ai},Ai.toMultiPolygonArray=function(o){var s=new Array(o.size()).fill(null);return o.toArray(s)},Ai.toGeometryArray=function(o){if(o===null)return null;var s=new Array(o.size()).fill(null);return o.toArray(s)},Ai.getDefaultCoordinateSequenceFactory=function(){return Cs.instance()},Ai.toMultiLineStringArray=function(o){var s=new Array(o.size()).fill(null);return o.toArray(s)},Ai.toLineStringArray=function(o){var s=new Array(o.size()).fill(null);return o.toArray(s)},Ai.toMultiPointArray=function(o){var s=new Array(o.size()).fill(null);return o.toArray(s)},Ai.toLinearRingArray=function(o){var s=new Array(o.size()).fill(null);return o.toArray(s)},Ai.toPointArray=function(o){var s=new Array(o.size()).fill(null);return o.toArray(s)},Ai.toPolygonArray=function(o){var s=new Array(o.size()).fill(null);return o.toArray(s)},Ai.createPointFromInternalCoord=function(o,s){return s.getPrecisionModel().makePrecise(o),s.getFactory().createPoint(o)},_u.serialVersionUID.get=function(){return-6820524753094096e3},Object.defineProperties(Ai,_u);var vf=["Point","MultiPoint","LineString","MultiLineString","Polygon","MultiPolygon"],ku=function(o){this.geometryFactory=o||new Ai};ku.prototype.read=function(o){var s,d=(s=typeof o=="string"?JSON.parse(o):o).type;if(!ns[d])throw new Error("Unknown GeoJSON type: "+s.type);return vf.indexOf(d)!==-1?ns[d].apply(this,[s.coordinates]):d==="GeometryCollection"?ns[d].apply(this,[s.geometries]):ns[d].apply(this,[s])},ku.prototype.write=function(o){var s=o.getGeometryType();if(!Mt[s])throw new Error("Geometry is not supported");return Mt[s].apply(this,[o])};var ns={Feature:function(o){var s={};for(var d in o)s[d]=o[d];if(o.geometry){var _=o.geometry.type;if(!ns[_])throw new Error("Unknown GeoJSON type: "+o.type);s.geometry=this.read(o.geometry)}return o.bbox&&(s.bbox=ns.bbox.apply(this,[o.bbox])),s},FeatureCollection:function(o){var s={};if(o.features){s.features=[];for(var d=0;d<o.features.length;++d)s.features.push(this.read(o.features[d]))}return o.bbox&&(s.bbox=this.parse.bbox.apply(this,[o.bbox])),s},coordinates:function(o){for(var s=[],d=0;d<o.length;++d){var _=o[d];s.push(new Y(_[0],_[1]))}return s},bbox:function(o){return this.geometryFactory.createLinearRing([new Y(o[0],o[1]),new Y(o[2],o[1]),new Y(o[2],o[3]),new Y(o[0],o[3]),new Y(o[0],o[1])])},Point:function(o){var s=new Y(o[0],o[1]);return this.geometryFactory.createPoint(s)},MultiPoint:function(o){for(var s=[],d=0;d<o.length;++d)s.push(ns.Point.apply(this,[o[d]]));return this.geometryFactory.createMultiPoint(s)},LineString:function(o){var s=ns.coordinates.apply(this,[o]);return this.geometryFactory.createLineString(s)},MultiLineString:function(o){for(var s=[],d=0;d<o.length;++d)s.push(ns.LineString.apply(this,[o[d]]));return this.geometryFactory.createMultiLineString(s)},Polygon:function(o){for(var s=ns.coordinates.apply(this,[o[0]]),d=this.geometryFactory.createLinearRing(s),_=[],w=1;w<o.length;++w){var j=o[w],re=ns.coordinates.apply(this,[j]),Pe=this.geometryFactory.createLinearRing(re);_.push(Pe)}return this.geometryFactory.createPolygon(d,_)},MultiPolygon:function(o){for(var s=[],d=0;d<o.length;++d){var _=o[d];s.push(ns.Polygon.apply(this,[_]))}return this.geometryFactory.createMultiPolygon(s)},GeometryCollection:function(o){for(var s=[],d=0;d<o.length;++d){var _=o[d];s.push(this.read(_))}return this.geometryFactory.createGeometryCollection(s)}},Mt={coordinate:function(o){return[o.x,o.y]},Point:function(o){return{type:"Point",coordinates:Mt.coordinate.apply(this,[o.getCoordinate()])}},MultiPoint:function(o){for(var s=[],d=0;d<o._geometries.length;++d){var _=o._geometries[d],w=Mt.Point.apply(this,[_]);s.push(w.coordinates)}return{type:"MultiPoint",coordinates:s}},LineString:function(o){for(var s=[],d=o.getCoordinates(),_=0;_<d.length;++_){var w=d[_];s.push(Mt.coordinate.apply(this,[w]))}return{type:"LineString",coordinates:s}},MultiLineString:function(o){for(var s=[],d=0;d<o._geometries.length;++d){var _=o._geometries[d],w=Mt.LineString.apply(this,[_]);s.push(w.coordinates)}return{type:"MultiLineString",coordinates:s}},Polygon:function(o){var s=[],d=Mt.LineString.apply(this,[o._shell]);s.push(d.coordinates);for(var _=0;_<o._holes.length;++_){var w=o._holes[_],j=Mt.LineString.apply(this,[w]);s.push(j.coordinates)}return{type:"Polygon",coordinates:s}},MultiPolygon:function(o){for(var s=[],d=0;d<o._geometries.length;++d){var _=o._geometries[d],w=Mt.Polygon.apply(this,[_]);s.push(w.coordinates)}return{type:"MultiPolygon",coordinates:s}},GeometryCollection:function(o){for(var s=[],d=0;d<o._geometries.length;++d){var _=o._geometries[d],w=_.getGeometryType();s.push(Mt[w].apply(this,[_]))}return{type:"GeometryCollection",geometries:s}}},Ve=function(o){this.geometryFactory=o||new Ai,this.precisionModel=this.geometryFactory.getPrecisionModel(),this.parser=new ku(this.geometryFactory)};Ve.prototype.read=function(o){var s=this.parser.read(o);return this.precisionModel.getType()===zi.FIXED&&this.reducePrecision(s),s},Ve.prototype.reducePrecision=function(o){var s,d;if(o.coordinate)this.precisionModel.makePrecise(o.coordinate);else if(o.points)for(s=0,d=o.points.length;s<d;s++)this.precisionModel.makePrecise(o.points[s]);else if(o.geometries)for(s=0,d=o.geometries.length;s<d;s++)this.reducePrecision(o.geometries[s])};var Gt=function(){this.parser=new ku(this.geometryFactory)};Gt.prototype.write=function(o){return this.parser.write(o)};var ce=function(){},Be={ON:{configurable:!0},LEFT:{configurable:!0},RIGHT:{configurable:!0}};ce.prototype.interfaces_=function(){return[]},ce.prototype.getClass=function(){return ce},ce.opposite=function(o){return o===ce.LEFT?ce.RIGHT:o===ce.RIGHT?ce.LEFT:o},Be.ON.get=function(){return 0},Be.LEFT.get=function(){return 1},Be.RIGHT.get=function(){return 2},Object.defineProperties(ce,Be),(De.prototype=new Error).name="EmptyStackException",(je.prototype=new Oa).add=function(o){return this.array_.push(o),!0},je.prototype.get=function(o){if(o<0||o>=this.size())throw new Error;return this.array_[o]},je.prototype.push=function(o){return this.array_.push(o),o},je.prototype.pop=function(o){if(this.array_.length===0)throw new De;return this.array_.pop()},je.prototype.peek=function(){if(this.array_.length===0)throw new De;return this.array_[this.array_.length-1]},je.prototype.empty=function(){return this.array_.length===0},je.prototype.isEmpty=function(){return this.empty()},je.prototype.search=function(o){return this.array_.indexOf(o)},je.prototype.size=function(){return this.array_.length},je.prototype.toArray=function(){for(var o=[],s=0,d=this.array_.length;s<d;s++)o.push(this.array_[s]);return o};var Ye=function(){this._minIndex=-1,this._minCoord=null,this._minDe=null,this._orientedDe=null};Ye.prototype.getCoordinate=function(){return this._minCoord},Ye.prototype.getRightmostSide=function(o,s){var d=this.getRightmostSideOfSegment(o,s);return d<0&&(d=this.getRightmostSideOfSegment(o,s-1)),d<0&&(this._minCoord=null,this.checkForRightmostCoordinate(o)),d},Ye.prototype.findRightmostEdgeAtVertex=function(){var o=this._minDe.getEdge().getCoordinates();Pt.isTrue(this._minIndex>0&&this._minIndex<o.length,"rightmost point expected to be interior vertex of edge");var s=o[this._minIndex-1],d=o[this._minIndex+1],_=wt.computeOrientation(this._minCoord,d,s),w=!1;(s.y<this._minCoord.y&&d.y<this._minCoord.y&&_===wt.COUNTERCLOCKWISE||s.y>this._minCoord.y&&d.y>this._minCoord.y&&_===wt.CLOCKWISE)&&(w=!0),w&&(this._minIndex=this._minIndex-1)},Ye.prototype.getRightmostSideOfSegment=function(o,s){var d=o.getEdge().getCoordinates();if(s<0||s+1>=d.length||d[s].y===d[s+1].y)return-1;var _=ce.LEFT;return d[s].y<d[s+1].y&&(_=ce.RIGHT),_},Ye.prototype.getEdge=function(){return this._orientedDe},Ye.prototype.checkForRightmostCoordinate=function(o){for(var s=o.getEdge().getCoordinates(),d=0;d<s.length-1;d++)(this._minCoord===null||s[d].x>this._minCoord.x)&&(this._minDe=o,this._minIndex=d,this._minCoord=s[d])},Ye.prototype.findRightmostEdgeAtNode=function(){var o=this._minDe.getNode().getEdges();this._minDe=o.getRightmostEdge(),this._minDe.isForward()||(this._minDe=this._minDe.getSym(),this._minIndex=this._minDe.getEdge().getCoordinates().length-1)},Ye.prototype.findEdge=function(o){for(var s=o.iterator();s.hasNext();){var d=s.next();d.isForward()&&this.checkForRightmostCoordinate(d)}Pt.isTrue(this._minIndex!==0||this._minCoord.equals(this._minDe.getCoordinate()),"inconsistency in rightmost processing"),this._minIndex===0?this.findRightmostEdgeAtNode():this.findRightmostEdgeAtVertex(),this._orientedDe=this._minDe,this.getRightmostSide(this._minDe,this._minIndex)===ce.LEFT&&(this._orientedDe=this._minDe.getSym())},Ye.prototype.interfaces_=function(){return[]},Ye.prototype.getClass=function(){return Ye};var zt=function(o){function s(d,_){o.call(this,s.msgWithCoord(d,_)),this.pt=_?new Y(_):null,this.name="TopologyException"}return o&&(s.__proto__=o),s.prototype=Object.create(o&&o.prototype),s.prototype.constructor=s,s.prototype.getCoordinate=function(){return this.pt},s.prototype.interfaces_=function(){return[]},s.prototype.getClass=function(){return s},s.msgWithCoord=function(d,_){return _?d:d+" [ "+_+" ]"},s}(Di),hr=function(){this.array_=[]};hr.prototype.addLast=function(o){this.array_.push(o)},hr.prototype.removeFirst=function(){return this.array_.shift()},hr.prototype.isEmpty=function(){return this.array_.length===0};var Lr=function(){this._finder=null,this._dirEdgeList=new Gr,this._nodes=new Gr,this._rightMostCoord=null,this._env=null,this._finder=new Ye};Lr.prototype.clearVisitedEdges=function(){for(var o=this._dirEdgeList.iterator();o.hasNext();)o.next().setVisited(!1)},Lr.prototype.getRightmostCoordinate=function(){return this._rightMostCoord},Lr.prototype.computeNodeDepth=function(o){for(var s=null,d=o.getEdges().iterator();d.hasNext();){var _=d.next();if(_.isVisited()||_.getSym().isVisited()){s=_;break}}if(s===null)throw new zt("unable to find edge to compute depths at "+o.getCoordinate());o.getEdges().computeDepths(s);for(var w=o.getEdges().iterator();w.hasNext();){var j=w.next();j.setVisited(!0),this.copySymDepths(j)}},Lr.prototype.computeDepth=function(o){this.clearVisitedEdges();var s=this._finder.getEdge();s.setEdgeDepths(ce.RIGHT,o),this.copySymDepths(s),this.computeDepths(s)},Lr.prototype.create=function(o){this.addReachable(o),this._finder.findEdge(this._dirEdgeList),this._rightMostCoord=this._finder.getCoordinate()},Lr.prototype.findResultEdges=function(){for(var o=this._dirEdgeList.iterator();o.hasNext();){var s=o.next();s.getDepth(ce.RIGHT)>=1&&s.getDepth(ce.LEFT)<=0&&!s.isInteriorAreaEdge()&&s.setInResult(!0)}},Lr.prototype.computeDepths=function(o){var s=new yu,d=new hr,_=o.getNode();for(d.addLast(_),s.add(_),o.setVisited(!0);!d.isEmpty();){var w=d.removeFirst();s.add(w),this.computeNodeDepth(w);for(var j=w.getEdges().iterator();j.hasNext();){var re=j.next().getSym();if(!re.isVisited()){var Pe=re.getNode();s.contains(Pe)||(d.addLast(Pe),s.add(Pe))}}}},Lr.prototype.compareTo=function(o){var s=o;return this._rightMostCoord.x<s._rightMostCoord.x?-1:this._rightMostCoord.x>s._rightMostCoord.x?1:0},Lr.prototype.getEnvelope=function(){if(this._env===null){for(var o=new _r,s=this._dirEdgeList.iterator();s.hasNext();)for(var d=s.next().getEdge().getCoordinates(),_=0;_<d.length-1;_++)o.expandToInclude(d[_]);this._env=o}return this._env},Lr.prototype.addReachable=function(o){var s=new je;for(s.add(o);!s.empty();){var d=s.pop();this.add(d,s)}},Lr.prototype.copySymDepths=function(o){var s=o.getSym();s.setDepth(ce.LEFT,o.getDepth(ce.RIGHT)),s.setDepth(ce.RIGHT,o.getDepth(ce.LEFT))},Lr.prototype.add=function(o,s){o.setVisited(!0),this._nodes.add(o);for(var d=o.getEdges().iterator();d.hasNext();){var _=d.next();this._dirEdgeList.add(_);var w=_.getSym().getNode();w.isVisited()||s.push(w)}},Lr.prototype.getNodes=function(){return this._nodes},Lr.prototype.getDirectedEdges=function(){return this._dirEdgeList},Lr.prototype.interfaces_=function(){return[ye]},Lr.prototype.getClass=function(){return Lr};var dn=function o(){if(this.location=null,arguments.length===1){if(arguments[0]instanceof Array){var s=arguments[0];this.init(s.length)}else if(Number.isInteger(arguments[0])){var d=arguments[0];this.init(1),this.location[ce.ON]=d}else if(arguments[0]instanceof o){var _=arguments[0];if(this.init(_.location.length),_!==null)for(var w=0;w<this.location.length;w++)this.location[w]=_.location[w]}}else if(arguments.length===3){var j=arguments[0],re=arguments[1],Pe=arguments[2];this.init(3),this.location[ce.ON]=j,this.location[ce.LEFT]=re,this.location[ce.RIGHT]=Pe}};dn.prototype.setAllLocations=function(o){for(var s=0;s<this.location.length;s++)this.location[s]=o},dn.prototype.isNull=function(){for(var o=0;o<this.location.length;o++)if(this.location[o]!==ge.NONE)return!1;return!0},dn.prototype.setAllLocationsIfNull=function(o){for(var s=0;s<this.location.length;s++)this.location[s]===ge.NONE&&(this.location[s]=o)},dn.prototype.isLine=function(){return this.location.length===1},dn.prototype.merge=function(o){if(o.location.length>this.location.length){var s=new Array(3).fill(null);s[ce.ON]=this.location[ce.ON],s[ce.LEFT]=ge.NONE,s[ce.RIGHT]=ge.NONE,this.location=s}for(var d=0;d<this.location.length;d++)this.location[d]===ge.NONE&&d<o.location.length&&(this.location[d]=o.location[d])},dn.prototype.getLocations=function(){return this.location},dn.prototype.flip=function(){if(this.location.length<=1)return null;var o=this.location[ce.LEFT];this.location[ce.LEFT]=this.location[ce.RIGHT],this.location[ce.RIGHT]=o},dn.prototype.toString=function(){var o=new ue;return this.location.length>1&&o.append(ge.toLocationSymbol(this.location[ce.LEFT])),o.append(ge.toLocationSymbol(this.location[ce.ON])),this.location.length>1&&o.append(ge.toLocationSymbol(this.location[ce.RIGHT])),o.toString()},dn.prototype.setLocations=function(o,s,d){this.location[ce.ON]=o,this.location[ce.LEFT]=s,this.location[ce.RIGHT]=d},dn.prototype.get=function(o){return o<this.location.length?this.location[o]:ge.NONE},dn.prototype.isArea=function(){return this.location.length>1},dn.prototype.isAnyNull=function(){for(var o=0;o<this.location.length;o++)if(this.location[o]===ge.NONE)return!0;return!1},dn.prototype.setLocation=function(){if(arguments.length===1){var o=arguments[0];this.setLocation(ce.ON,o)}else if(arguments.length===2){var s=arguments[0],d=arguments[1];this.location[s]=d}},dn.prototype.init=function(o){this.location=new Array(o).fill(null),this.setAllLocations(ge.NONE)},dn.prototype.isEqualOnSide=function(o,s){return this.location[s]===o.location[s]},dn.prototype.allPositionsEqual=function(o){for(var s=0;s<this.location.length;s++)if(this.location[s]!==o)return!1;return!0},dn.prototype.interfaces_=function(){return[]},dn.prototype.getClass=function(){return dn};var Mn=function o(){if(this.elt=new Array(2).fill(null),arguments.length===1){if(Number.isInteger(arguments[0])){var s=arguments[0];this.elt[0]=new dn(s),this.elt[1]=new dn(s)}else if(arguments[0]instanceof o){var d=arguments[0];this.elt[0]=new dn(d.elt[0]),this.elt[1]=new dn(d.elt[1])}}else if(arguments.length===2){var _=arguments[0],w=arguments[1];this.elt[0]=new dn(ge.NONE),this.elt[1]=new dn(ge.NONE),this.elt[_].setLocation(w)}else if(arguments.length===3){var j=arguments[0],re=arguments[1],Pe=arguments[2];this.elt[0]=new dn(j,re,Pe),this.elt[1]=new dn(j,re,Pe)}else if(arguments.length===4){var tt=arguments[0],It=arguments[1],tr=arguments[2],ot=arguments[3];this.elt[0]=new dn(ge.NONE,ge.NONE,ge.NONE),this.elt[1]=new dn(ge.NONE,ge.NONE,ge.NONE),this.elt[tt].setLocations(It,tr,ot)}};Mn.prototype.getGeometryCount=function(){var o=0;return this.elt[0].isNull()||o++,this.elt[1].isNull()||o++,o},Mn.prototype.setAllLocations=function(o,s){this.elt[o].setAllLocations(s)},Mn.prototype.isNull=function(o){return this.elt[o].isNull()},Mn.prototype.setAllLocationsIfNull=function(){if(arguments.length===1){var o=arguments[0];this.setAllLocationsIfNull(0,o),this.setAllLocationsIfNull(1,o)}else if(arguments.length===2){var s=arguments[0],d=arguments[1];this.elt[s].setAllLocationsIfNull(d)}},Mn.prototype.isLine=function(o){return this.elt[o].isLine()},Mn.prototype.merge=function(o){for(var s=0;s<2;s++)this.elt[s]===null&&o.elt[s]!==null?this.elt[s]=new dn(o.elt[s]):this.elt[s].merge(o.elt[s])},Mn.prototype.flip=function(){this.elt[0].flip(),this.elt[1].flip()},Mn.prototype.getLocation=function(){if(arguments.length===1){var o=arguments[0];return this.elt[o].get(ce.ON)}if(arguments.length===2){var s=arguments[0],d=arguments[1];return this.elt[s].get(d)}},Mn.prototype.toString=function(){var o=new ue;return this.elt[0]!==null&&(o.append("A:"),o.append(this.elt[0].toString())),this.elt[1]!==null&&(o.append(" B:"),o.append(this.elt[1].toString())),o.toString()},Mn.prototype.isArea=function(){if(arguments.length===0)return this.elt[0].isArea()||this.elt[1].isArea();if(arguments.length===1){var o=arguments[0];return this.elt[o].isArea()}},Mn.prototype.isAnyNull=function(o){return this.elt[o].isAnyNull()},Mn.prototype.setLocation=function(){if(arguments.length===2){var o=arguments[0],s=arguments[1];this.elt[o].setLocation(ce.ON,s)}else if(arguments.length===3){var d=arguments[0],_=arguments[1],w=arguments[2];this.elt[d].setLocation(_,w)}},Mn.prototype.isEqualOnSide=function(o,s){return this.elt[0].isEqualOnSide(o.elt[0],s)&&this.elt[1].isEqualOnSide(o.elt[1],s)},Mn.prototype.allPositionsEqual=function(o,s){return this.elt[o].allPositionsEqual(s)},Mn.prototype.toLine=function(o){this.elt[o].isArea()&&(this.elt[o]=new dn(this.elt[o].location[0]))},Mn.prototype.interfaces_=function(){return[]},Mn.prototype.getClass=function(){return Mn},Mn.toLineLabel=function(o){for(var s=new Mn(ge.NONE),d=0;d<2;d++)s.setLocation(d,o.getLocation(d));return s};var vi=function(){this._startDe=null,this._maxNodeDegree=-1,this._edges=new Gr,this._pts=new Gr,this._label=new Mn(ge.NONE),this._ring=null,this._isHole=null,this._shell=null,this._holes=new Gr,this._geometryFactory=null;var o=arguments[0],s=arguments[1];this._geometryFactory=s,this.computePoints(o),this.computeRing()};vi.prototype.computeRing=function(){if(this._ring!==null)return null;for(var o=new Array(this._pts.size()).fill(null),s=0;s<this._pts.size();s++)o[s]=this._pts.get(s);this._ring=this._geometryFactory.createLinearRing(o),this._isHole=wt.isCCW(this._ring.getCoordinates())},vi.prototype.isIsolated=function(){return this._label.getGeometryCount()===1},vi.prototype.computePoints=function(o){this._startDe=o;var s=o,d=!0;do{if(s===null)throw new zt("Found null DirectedEdge");if(s.getEdgeRing()===this)throw new zt("Directed Edge visited twice during ring-building at "+s.getCoordinate());this._edges.add(s);var _=s.getLabel();Pt.isTrue(_.isArea()),this.mergeLabel(_),this.addPoints(s.getEdge(),s.isForward(),d),d=!1,this.setEdgeRing(s,this),s=this.getNext(s)}while(s!==this._startDe)},vi.prototype.getLinearRing=function(){return this._ring},vi.prototype.getCoordinate=function(o){return this._pts.get(o)},vi.prototype.computeMaxNodeDegree=function(){this._maxNodeDegree=0;var o=this._startDe;do{var s=o.getNode().getEdges().getOutgoingDegree(this);s>this._maxNodeDegree&&(this._maxNodeDegree=s),o=this.getNext(o)}while(o!==this._startDe);this._maxNodeDegree*=2},vi.prototype.addPoints=function(o,s,d){var _=o.getCoordinates();if(s){var w=1;d&&(w=0);for(var j=w;j<_.length;j++)this._pts.add(_[j])}else{var re=_.length-2;d&&(re=_.length-1);for(var Pe=re;Pe>=0;Pe--)this._pts.add(_[Pe])}},vi.prototype.isHole=function(){return this._isHole},vi.prototype.setInResult=function(){var o=this._startDe;do o.getEdge().setInResult(!0),o=o.getNext();while(o!==this._startDe)},vi.prototype.containsPoint=function(o){var s=this.getLinearRing();if(!s.getEnvelopeInternal().contains(o)||!wt.isPointInRing(o,s.getCoordinates()))return!1;for(var d=this._holes.iterator();d.hasNext();)if(d.next().containsPoint(o))return!1;return!0},vi.prototype.addHole=function(o){this._holes.add(o)},vi.prototype.isShell=function(){return this._shell===null},vi.prototype.getLabel=function(){return this._label},vi.prototype.getEdges=function(){return this._edges},vi.prototype.getMaxNodeDegree=function(){return this._maxNodeDegree<0&&this.computeMaxNodeDegree(),this._maxNodeDegree},vi.prototype.getShell=function(){return this._shell},vi.prototype.mergeLabel=function(){if(arguments.length===1){var o=arguments[0];this.mergeLabel(o,0),this.mergeLabel(o,1)}else if(arguments.length===2){var s=arguments[0],d=arguments[1],_=s.getLocation(d,ce.RIGHT);if(_===ge.NONE)return null;if(this._label.getLocation(d)===ge.NONE)return this._label.setLocation(d,_),null}},vi.prototype.setShell=function(o){this._shell=o,o!==null&&o.addHole(this)},vi.prototype.toPolygon=function(o){for(var s=new Array(this._holes.size()).fill(null),d=0;d<this._holes.size();d++)s[d]=this._holes.get(d).getLinearRing();return o.createPolygon(this.getLinearRing(),s)},vi.prototype.interfaces_=function(){return[]},vi.prototype.getClass=function(){return vi};var co=function(o){function s(){var d=arguments[0],_=arguments[1];o.call(this,d,_)}return o&&(s.__proto__=o),s.prototype=Object.create(o&&o.prototype),s.prototype.constructor=s,s.prototype.setEdgeRing=function(d,_){d.setMinEdgeRing(_)},s.prototype.getNext=function(d){return d.getNextMin()},s.prototype.interfaces_=function(){return[]},s.prototype.getClass=function(){return s},s}(vi),is=function(o){function s(){var d=arguments[0],_=arguments[1];o.call(this,d,_)}return o&&(s.__proto__=o),s.prototype=Object.create(o&&o.prototype),s.prototype.constructor=s,s.prototype.buildMinimalRings=function(){var d=new Gr,_=this._startDe;do{if(_.getMinEdgeRing()===null){var w=new co(_,this._geometryFactory);d.add(w)}_=_.getNext()}while(_!==this._startDe);return d},s.prototype.setEdgeRing=function(d,_){d.setEdgeRing(_)},s.prototype.linkDirectedEdgesForMinimalEdgeRings=function(){var d=this._startDe;do d.getNode().getEdges().linkMinimalDirectedEdges(this),d=d.getNext();while(d!==this._startDe)},s.prototype.getNext=function(d){return d.getNext()},s.prototype.interfaces_=function(){return[]},s.prototype.getClass=function(){return s},s}(vi),ws=function(){if(this._label=null,this._isInResult=!1,this._isCovered=!1,this._isCoveredSet=!1,this._isVisited=!1,arguments.length!==0){if(arguments.length===1){var o=arguments[0];this._label=o}}};ws.prototype.setVisited=function(o){this._isVisited=o},ws.prototype.setInResult=function(o){this._isInResult=o},ws.prototype.isCovered=function(){return this._isCovered},ws.prototype.isCoveredSet=function(){return this._isCoveredSet},ws.prototype.setLabel=function(o){this._label=o},ws.prototype.getLabel=function(){return this._label},ws.prototype.setCovered=function(o){this._isCovered=o,this._isCoveredSet=!0},ws.prototype.updateIM=function(o){Pt.isTrue(this._label.getGeometryCount()>=2,"found partial label"),this.computeIM(o)},ws.prototype.isInResult=function(){return this._isInResult},ws.prototype.isVisited=function(){return this._isVisited},ws.prototype.interfaces_=function(){return[]},ws.prototype.getClass=function(){return ws};var Xc=function(o){function s(){o.call(this),this._coord=null,this._edges=null;var d=arguments[0],_=arguments[1];this._coord=d,this._edges=_,this._label=new Mn(0,ge.NONE)}return o&&(s.__proto__=o),s.prototype=Object.create(o&&o.prototype),s.prototype.constructor=s,s.prototype.isIncidentEdgeInResult=function(){for(var d=this.getEdges().getEdges().iterator();d.hasNext();)if(d.next().getEdge().isInResult())return!0;return!1},s.prototype.isIsolated=function(){return this._label.getGeometryCount()===1},s.prototype.getCoordinate=function(){return this._coord},s.prototype.print=function(d){d.println("node "+this._coord+" lbl: "+this._label)},s.prototype.computeIM=function(d){},s.prototype.computeMergedLocation=function(d,_){var w=ge.NONE;if(w=this._label.getLocation(_),!d.isNull(_)){var j=d.getLocation(_);w!==ge.BOUNDARY&&(w=j)}return w},s.prototype.setLabel=function(){if(arguments.length!==2)return o.prototype.setLabel.apply(this,arguments);var d=arguments[0],_=arguments[1];this._label===null?this._label=new Mn(d,_):this._label.setLocation(d,_)},s.prototype.getEdges=function(){return this._edges},s.prototype.mergeLabel=function(){if(arguments[0]instanceof s){var d=arguments[0];this.mergeLabel(d._label)}else if(arguments[0]instanceof Mn)for(var _=arguments[0],w=0;w<2;w++){var j=this.computeMergedLocation(_,w);this._label.getLocation(w)===ge.NONE&&this._label.setLocation(w,j)}},s.prototype.add=function(d){this._edges.insert(d),d.setNode(this)},s.prototype.setLabelBoundary=function(d){if(this._label===null)return null;var _=ge.NONE;this._label!==null&&(_=this._label.getLocation(d));var w=null;switch(_){case ge.BOUNDARY:w=ge.INTERIOR;break;case ge.INTERIOR:default:w=ge.BOUNDARY}this._label.setLocation(d,w)},s.prototype.interfaces_=function(){return[]},s.prototype.getClass=function(){return s},s}(ws),Zs=function(){this.nodeMap=new Ie,this.nodeFact=null;var o=arguments[0];this.nodeFact=o};Zs.prototype.find=function(o){return this.nodeMap.get(o)},Zs.prototype.addNode=function(){if(arguments[0]instanceof Y){var o=arguments[0],s=this.nodeMap.get(o);return s===null&&(s=this.nodeFact.createNode(o),this.nodeMap.put(o,s)),s}if(arguments[0]instanceof Xc){var d=arguments[0],_=this.nodeMap.get(d.getCoordinate());return _===null?(this.nodeMap.put(d.getCoordinate(),d),d):(_.mergeLabel(d),_)}},Zs.prototype.print=function(o){for(var s=this.iterator();s.hasNext();)s.next().print(o)},Zs.prototype.iterator=function(){return this.nodeMap.values().iterator()},Zs.prototype.values=function(){return this.nodeMap.values()},Zs.prototype.getBoundaryNodes=function(o){for(var s=new Gr,d=this.iterator();d.hasNext();){var _=d.next();_.getLabel().getLocation(o)===ge.BOUNDARY&&s.add(_)}return s},Zs.prototype.add=function(o){var s=o.getCoordinate();this.addNode(s).add(o)},Zs.prototype.interfaces_=function(){return[]},Zs.prototype.getClass=function(){return Zs};var ua=function(){},Jl={NE:{configurable:!0},NW:{configurable:!0},SW:{configurable:!0},SE:{configurable:!0}};ua.prototype.interfaces_=function(){return[]},ua.prototype.getClass=function(){return ua},ua.isNorthern=function(o){return o===ua.NE||o===ua.NW},ua.isOpposite=function(o,s){return o===s?!1:(o-s+4)%4===2},ua.commonHalfPlane=function(o,s){if(o===s)return o;if((o-s+4)%4===2)return-1;var d=o<s?o:s;return d===0&&(o>s?o:s)===3?3:d},ua.isInHalfPlane=function(o,s){return s===ua.SE?o===ua.SE||o===ua.SW:o===s||o===s+1},ua.quadrant=function(){if(typeof arguments[0]=="number"&&typeof arguments[1]=="number"){var o=arguments[0],s=arguments[1];if(o===0&&s===0)throw new Te("Cannot compute the quadrant for point ( "+o+", "+s+" )");return o>=0?s>=0?ua.NE:ua.SE:s>=0?ua.NW:ua.SW}if(arguments[0]instanceof Y&&arguments[1]instanceof Y){var d=arguments[0],_=arguments[1];if(_.x===d.x&&_.y===d.y)throw new Te("Cannot compute the quadrant for two identical points "+d);return _.x>=d.x?_.y>=d.y?ua.NE:ua.SE:_.y>=d.y?ua.NW:ua.SW}},Jl.NE.get=function(){return 0},Jl.NW.get=function(){return 1},Jl.SW.get=function(){return 2},Jl.SE.get=function(){return 3},Object.defineProperties(ua,Jl);var qa=function(){if(this._edge=null,this._label=null,this._node=null,this._p0=null,this._p1=null,this._dx=null,this._dy=null,this._quadrant=null,arguments.length===1){var o=arguments[0];this._edge=o}else if(arguments.length===3){var s=arguments[0],d=arguments[1],_=arguments[2];this._edge=s,this.init(d,_),this._label=null}else if(arguments.length===4){var w=arguments[0],j=arguments[1],re=arguments[2],Pe=arguments[3];this._edge=w,this.init(j,re),this._label=Pe}};qa.prototype.compareDirection=function(o){return this._dx===o._dx&&this._dy===o._dy?0:this._quadrant>o._quadrant?1:this._quadrant<o._quadrant?-1:wt.computeOrientation(o._p0,o._p1,this._p1)},qa.prototype.getDy=function(){return this._dy},qa.prototype.getCoordinate=function(){return this._p0},qa.prototype.setNode=function(o){this._node=o},qa.prototype.print=function(o){var s=Math.atan2(this._dy,this._dx),d=this.getClass().getName(),_=d.lastIndexOf("."),w=d.substring(_+1);o.print("  "+w+": "+this._p0+" - "+this._p1+" "+this._quadrant+":"+s+"   "+this._label)},qa.prototype.compareTo=function(o){var s=o;return this.compareDirection(s)},qa.prototype.getDirectedCoordinate=function(){return this._p1},qa.prototype.getDx=function(){return this._dx},qa.prototype.getLabel=function(){return this._label},qa.prototype.getEdge=function(){return this._edge},qa.prototype.getQuadrant=function(){return this._quadrant},qa.prototype.getNode=function(){return this._node},qa.prototype.toString=function(){var o=Math.atan2(this._dy,this._dx),s=this.getClass().getName(),d=s.lastIndexOf(".");return"  "+s.substring(d+1)+": "+this._p0+" - "+this._p1+" "+this._quadrant+":"+o+"   "+this._label},qa.prototype.computeLabel=function(o){},qa.prototype.init=function(o,s){this._p0=o,this._p1=s,this._dx=s.x-o.x,this._dy=s.y-o.y,this._quadrant=ua.quadrant(this._dx,this._dy),Pt.isTrue(!(this._dx===0&&this._dy===0),"EdgeEnd with identical endpoints found")},qa.prototype.interfaces_=function(){return[ye]},qa.prototype.getClass=function(){return qa};var gf=function(o){function s(){var d=arguments[0],_=arguments[1];if(o.call(this,d),this._isForward=null,this._isInResult=!1,this._isVisited=!1,this._sym=null,this._next=null,this._nextMin=null,this._edgeRing=null,this._minEdgeRing=null,this._depth=[0,-999,-999],this._isForward=_,_)this.init(d.getCoordinate(0),d.getCoordinate(1));else{var w=d.getNumPoints()-1;this.init(d.getCoordinate(w),d.getCoordinate(w-1))}this.computeDirectedLabel()}return o&&(s.__proto__=o),s.prototype=Object.create(o&&o.prototype),s.prototype.constructor=s,s.prototype.getNextMin=function(){return this._nextMin},s.prototype.getDepth=function(d){return this._depth[d]},s.prototype.setVisited=function(d){this._isVisited=d},s.prototype.computeDirectedLabel=function(){this._label=new Mn(this._edge.getLabel()),this._isForward||this._label.flip()},s.prototype.getNext=function(){return this._next},s.prototype.setDepth=function(d,_){if(this._depth[d]!==-999&&this._depth[d]!==_)throw new zt("assigned depths do not match",this.getCoordinate());this._depth[d]=_},s.prototype.isInteriorAreaEdge=function(){for(var d=!0,_=0;_<2;_++)this._label.isArea(_)&&this._label.getLocation(_,ce.LEFT)===ge.INTERIOR&&this._label.getLocation(_,ce.RIGHT)===ge.INTERIOR||(d=!1);return d},s.prototype.setNextMin=function(d){this._nextMin=d},s.prototype.print=function(d){o.prototype.print.call(this,d),d.print(" "+this._depth[ce.LEFT]+"/"+this._depth[ce.RIGHT]),d.print(" ("+this.getDepthDelta()+")"),this._isInResult&&d.print(" inResult")},s.prototype.setMinEdgeRing=function(d){this._minEdgeRing=d},s.prototype.isLineEdge=function(){var d=this._label.isLine(0)||this._label.isLine(1),_=!this._label.isArea(0)||this._label.allPositionsEqual(0,ge.EXTERIOR),w=!this._label.isArea(1)||this._label.allPositionsEqual(1,ge.EXTERIOR);return d&&_&&w},s.prototype.setEdgeRing=function(d){this._edgeRing=d},s.prototype.getMinEdgeRing=function(){return this._minEdgeRing},s.prototype.getDepthDelta=function(){var d=this._edge.getDepthDelta();return this._isForward||(d=-d),d},s.prototype.setInResult=function(d){this._isInResult=d},s.prototype.getSym=function(){return this._sym},s.prototype.isForward=function(){return this._isForward},s.prototype.getEdge=function(){return this._edge},s.prototype.printEdge=function(d){this.print(d),d.print(" "),this._isForward?this._edge.print(d):this._edge.printReverse(d)},s.prototype.setSym=function(d){this._sym=d},s.prototype.setVisitedEdge=function(d){this.setVisited(d),this._sym.setVisited(d)},s.prototype.setEdgeDepths=function(d,_){var w=this.getEdge().getDepthDelta();this._isForward||(w=-w);var j=1;d===ce.LEFT&&(j=-1);var re=ce.opposite(d),Pe=_+w*j;this.setDepth(d,_),this.setDepth(re,Pe)},s.prototype.getEdgeRing=function(){return this._edgeRing},s.prototype.isInResult=function(){return this._isInResult},s.prototype.setNext=function(d){this._next=d},s.prototype.isVisited=function(){return this._isVisited},s.prototype.interfaces_=function(){return[]},s.prototype.getClass=function(){return s},s.depthFactor=function(d,_){return d===ge.EXTERIOR&&_===ge.INTERIOR?1:d===ge.INTERIOR&&_===ge.EXTERIOR?-1:0},s}(qa),dl=function(){};dl.prototype.createNode=function(o){return new Xc(o,null)},dl.prototype.interfaces_=function(){return[]},dl.prototype.getClass=function(){return dl};var wa=function(){if(this._edges=new Gr,this._nodes=null,this._edgeEndList=new Gr,arguments.length===0)this._nodes=new Zs(new dl);else if(arguments.length===1){var o=arguments[0];this._nodes=new Zs(o)}};wa.prototype.printEdges=function(o){o.println("Edges:");for(var s=0;s<this._edges.size();s++){o.println("edge "+s+":");var d=this._edges.get(s);d.print(o),d.eiList.print(o)}},wa.prototype.find=function(o){return this._nodes.find(o)},wa.prototype.addNode=function(){if(arguments[0]instanceof Xc){var o=arguments[0];return this._nodes.addNode(o)}if(arguments[0]instanceof Y){var s=arguments[0];return this._nodes.addNode(s)}},wa.prototype.getNodeIterator=function(){return this._nodes.iterator()},wa.prototype.linkResultDirectedEdges=function(){for(var o=this._nodes.iterator();o.hasNext();)o.next().getEdges().linkResultDirectedEdges()},wa.prototype.debugPrintln=function(o){Qr.out.println(o)},wa.prototype.isBoundaryNode=function(o,s){var d=this._nodes.find(s);if(d===null)return!1;var _=d.getLabel();return _!==null&&_.getLocation(o)===ge.BOUNDARY},wa.prototype.linkAllDirectedEdges=function(){for(var o=this._nodes.iterator();o.hasNext();)o.next().getEdges().linkAllDirectedEdges()},wa.prototype.matchInSameDirection=function(o,s,d,_){return!!o.equals(d)&&wt.computeOrientation(o,s,_)===wt.COLLINEAR&&ua.quadrant(o,s)===ua.quadrant(d,_)},wa.prototype.getEdgeEnds=function(){return this._edgeEndList},wa.prototype.debugPrint=function(o){Qr.out.print(o)},wa.prototype.getEdgeIterator=function(){return this._edges.iterator()},wa.prototype.findEdgeInSameDirection=function(o,s){for(var d=0;d<this._edges.size();d++){var _=this._edges.get(d),w=_.getCoordinates();if(this.matchInSameDirection(o,s,w[0],w[1])||this.matchInSameDirection(o,s,w[w.length-1],w[w.length-2]))return _}return null},wa.prototype.insertEdge=function(o){this._edges.add(o)},wa.prototype.findEdgeEnd=function(o){for(var s=this.getEdgeEnds().iterator();s.hasNext();){var d=s.next();if(d.getEdge()===o)return d}return null},wa.prototype.addEdges=function(o){for(var s=o.iterator();s.hasNext();){var d=s.next();this._edges.add(d);var _=new gf(d,!0),w=new gf(d,!1);_.setSym(w),w.setSym(_),this.add(_),this.add(w)}},wa.prototype.add=function(o){this._nodes.add(o),this._edgeEndList.add(o)},wa.prototype.getNodes=function(){return this._nodes.values()},wa.prototype.findEdge=function(o,s){for(var d=0;d<this._edges.size();d++){var _=this._edges.get(d),w=_.getCoordinates();if(o.equals(w[0])&&s.equals(w[1]))return _}return null},wa.prototype.interfaces_=function(){return[]},wa.prototype.getClass=function(){return wa},wa.linkResultDirectedEdges=function(o){for(var s=o.iterator();s.hasNext();)s.next().getEdges().linkResultDirectedEdges()};var In=function(){this._geometryFactory=null,this._shellList=new Gr;var o=arguments[0];this._geometryFactory=o};In.prototype.sortShellsAndHoles=function(o,s,d){for(var _=o.iterator();_.hasNext();){var w=_.next();w.isHole()?d.add(w):s.add(w)}},In.prototype.computePolygons=function(o){for(var s=new Gr,d=o.iterator();d.hasNext();){var _=d.next().toPolygon(this._geometryFactory);s.add(_)}return s},In.prototype.placeFreeHoles=function(o,s){for(var d=s.iterator();d.hasNext();){var _=d.next();if(_.getShell()===null){var w=this.findEdgeRingContaining(_,o);if(w===null)throw new zt("unable to assign hole to a shell",_.getCoordinate(0));_.setShell(w)}}},In.prototype.buildMinimalEdgeRings=function(o,s,d){for(var _=new Gr,w=o.iterator();w.hasNext();){var j=w.next();if(j.getMaxNodeDegree()>2){j.linkDirectedEdgesForMinimalEdgeRings();var re=j.buildMinimalRings(),Pe=this.findShell(re);Pe!==null?(this.placePolygonHoles(Pe,re),s.add(Pe)):d.addAll(re)}else _.add(j)}return _},In.prototype.containsPoint=function(o){for(var s=this._shellList.iterator();s.hasNext();)if(s.next().containsPoint(o))return!0;return!1},In.prototype.buildMaximalEdgeRings=function(o){for(var s=new Gr,d=o.iterator();d.hasNext();){var _=d.next();if(_.isInResult()&&_.getLabel().isArea()&&_.getEdgeRing()===null){var w=new is(_,this._geometryFactory);s.add(w),w.setInResult()}}return s},In.prototype.placePolygonHoles=function(o,s){for(var d=s.iterator();d.hasNext();){var _=d.next();_.isHole()&&_.setShell(o)}},In.prototype.getPolygons=function(){return this.computePolygons(this._shellList)},In.prototype.findEdgeRingContaining=function(o,s){for(var d=o.getLinearRing(),_=d.getEnvelopeInternal(),w=d.getCoordinateN(0),j=null,re=null,Pe=s.iterator();Pe.hasNext();){var tt=Pe.next(),It=tt.getLinearRing(),tr=It.getEnvelopeInternal();j!==null&&(re=j.getLinearRing().getEnvelopeInternal());var ot=!1;tr.contains(_)&&wt.isPointInRing(w,It.getCoordinates())&&(ot=!0),ot&&(j===null||re.contains(tr))&&(j=tt)}return j},In.prototype.findShell=function(o){for(var s=0,d=null,_=o.iterator();_.hasNext();){var w=_.next();w.isHole()||(d=w,s++)}return Pt.isTrue(s<=1,"found two shells in MinimalEdgeRing list"),d},In.prototype.add=function(){if(arguments.length===1){var o=arguments[0];this.add(o.getEdgeEnds(),o.getNodes())}else if(arguments.length===2){var s=arguments[0],d=arguments[1];wa.linkResultDirectedEdges(d);var _=this.buildMaximalEdgeRings(s),w=new Gr,j=this.buildMinimalEdgeRings(_,this._shellList,w);this.sortShellsAndHoles(j,this._shellList,w),this.placeFreeHoles(this._shellList,w)}},In.prototype.interfaces_=function(){return[]},In.prototype.getClass=function(){return In};var Ju=function(){};Ju.prototype.getBounds=function(){},Ju.prototype.interfaces_=function(){return[]},Ju.prototype.getClass=function(){return Ju};var zs=function(){this._bounds=null,this._item=null;var o=arguments[0],s=arguments[1];this._bounds=o,this._item=s};zs.prototype.getItem=function(){return this._item},zs.prototype.getBounds=function(){return this._bounds},zs.prototype.interfaces_=function(){return[Ju,P]},zs.prototype.getClass=function(){return zs};var lu=function(){this._size=null,this._items=null,this._size=0,this._items=new Gr,this._items.add(null)};lu.prototype.poll=function(){if(this.isEmpty())return null;var o=this._items.get(1);return this._items.set(1,this._items.get(this._size)),this._size-=1,this.reorder(1),o},lu.prototype.size=function(){return this._size},lu.prototype.reorder=function(o){for(var s=null,d=this._items.get(o);2*o<=this._size&&((s=2*o)!==this._size&&this._items.get(s+1).compareTo(this._items.get(s))<0&&s++,this._items.get(s).compareTo(d)<0);o=s)this._items.set(o,this._items.get(s));this._items.set(o,d)},lu.prototype.clear=function(){this._size=0,this._items.clear()},lu.prototype.isEmpty=function(){return this._size===0},lu.prototype.add=function(o){this._items.add(null),this._size+=1;var s=this._size;for(this._items.set(0,o);o.compareTo(this._items.get(Math.trunc(s/2)))<0;s/=2)this._items.set(s,this._items.get(Math.trunc(s/2)));this._items.set(s,o)},lu.prototype.interfaces_=function(){return[]},lu.prototype.getClass=function(){return lu};var cu=function(){};cu.prototype.visitItem=function(o){},cu.prototype.interfaces_=function(){return[]},cu.prototype.getClass=function(){return cu};var xu=function(){};xu.prototype.insert=function(o,s){},xu.prototype.remove=function(o,s){},xu.prototype.query=function(){},xu.prototype.interfaces_=function(){return[]},xu.prototype.getClass=function(){return xu};var ci=function(){if(this._childBoundables=new Gr,this._bounds=null,this._level=null,arguments.length!==0){if(arguments.length===1){var o=arguments[0];this._level=o}}},as={serialVersionUID:{configurable:!0}};ci.prototype.getLevel=function(){return this._level},ci.prototype.size=function(){return this._childBoundables.size()},ci.prototype.getChildBoundables=function(){return this._childBoundables},ci.prototype.addChildBoundable=function(o){Pt.isTrue(this._bounds===null),this._childBoundables.add(o)},ci.prototype.isEmpty=function(){return this._childBoundables.isEmpty()},ci.prototype.getBounds=function(){return this._bounds===null&&(this._bounds=this.computeBounds()),this._bounds},ci.prototype.interfaces_=function(){return[Ju,P]},ci.prototype.getClass=function(){return ci},as.serialVersionUID.get=function(){return 6493722185909574e3},Object.defineProperties(ci,as);var Ha=function(){};Ha.reverseOrder=function(){return{compare:function(o,s){return s.compareTo(o)}}},Ha.min=function(o){return Ha.sort(o),o.get(0)},Ha.sort=function(o,s){var d=o.toArray();s?da.sort(d,s):da.sort(d);for(var _=o.iterator(),w=0,j=d.length;w<j;w++)_.next(),_.set(d[w])},Ha.singletonList=function(o){var s=new Gr;return s.add(o),s};var Ra=function(){this._boundable1=null,this._boundable2=null,this._distance=null,this._itemDistance=null;var o=arguments[0],s=arguments[1],d=arguments[2];this._boundable1=o,this._boundable2=s,this._itemDistance=d,this._distance=this.distance()};Ra.prototype.expandToQueue=function(o,s){var d=Ra.isComposite(this._boundable1),_=Ra.isComposite(this._boundable2);if(d&&_)return Ra.area(this._boundable1)>Ra.area(this._boundable2)?(this.expand(this._boundable1,this._boundable2,o,s),null):(this.expand(this._boundable2,this._boundable1,o,s),null);if(d)return this.expand(this._boundable1,this._boundable2,o,s),null;if(_)return this.expand(this._boundable2,this._boundable1,o,s),null;throw new Te("neither boundable is composite")},Ra.prototype.isLeaves=function(){return!(Ra.isComposite(this._boundable1)||Ra.isComposite(this._boundable2))},Ra.prototype.compareTo=function(o){var s=o;return this._distance<s._distance?-1:this._distance>s._distance?1:0},Ra.prototype.expand=function(o,s,d,_){for(var w=o.getChildBoundables().iterator();w.hasNext();){var j=w.next(),re=new Ra(j,s,this._itemDistance);re.getDistance()<_&&d.add(re)}},Ra.prototype.getBoundable=function(o){return o===0?this._boundable1:this._boundable2},Ra.prototype.getDistance=function(){return this._distance},Ra.prototype.distance=function(){return this.isLeaves()?this._itemDistance.distance(this._boundable1,this._boundable2):this._boundable1.getBounds().distance(this._boundable2.getBounds())},Ra.prototype.interfaces_=function(){return[ye]},Ra.prototype.getClass=function(){return Ra},Ra.area=function(o){return o.getBounds().getArea()},Ra.isComposite=function(o){return o instanceof ci};var mo=function o(){if(this._root=null,this._built=!1,this._itemBoundables=new Gr,this._nodeCapacity=null,arguments.length===0){var s=o.DEFAULT_NODE_CAPACITY;this._nodeCapacity=s}else if(arguments.length===1){var d=arguments[0];Pt.isTrue(d>1,"Node capacity must be greater than 1"),this._nodeCapacity=d}},fu={IntersectsOp:{configurable:!0},serialVersionUID:{configurable:!0},DEFAULT_NODE_CAPACITY:{configurable:!0}};mo.prototype.getNodeCapacity=function(){return this._nodeCapacity},mo.prototype.lastNode=function(o){return o.get(o.size()-1)},mo.prototype.size=function(){if(arguments.length===0)return this.isEmpty()?0:(this.build(),this.size(this._root));if(arguments.length===1){for(var o=0,s=arguments[0].getChildBoundables().iterator();s.hasNext();){var d=s.next();d instanceof ci?o+=this.size(d):d instanceof zs&&(o+=1)}return o}},mo.prototype.removeItem=function(o,s){for(var d=null,_=o.getChildBoundables().iterator();_.hasNext();){var w=_.next();w instanceof zs&&w.getItem()===s&&(d=w)}return d!==null&&(o.getChildBoundables().remove(d),!0)},mo.prototype.itemsTree=function(){if(arguments.length===0){this.build();var o=this.itemsTree(this._root);return o===null?new Gr:o}if(arguments.length===1){for(var s=arguments[0],d=new Gr,_=s.getChildBoundables().iterator();_.hasNext();){var w=_.next();if(w instanceof ci){var j=this.itemsTree(w);j!==null&&d.add(j)}else w instanceof zs?d.add(w.getItem()):Pt.shouldNeverReachHere()}return d.size()<=0?null:d}},mo.prototype.insert=function(o,s){Pt.isTrue(!this._built,"Cannot insert items into an STR packed R-tree after it has been built."),this._itemBoundables.add(new zs(o,s))},mo.prototype.boundablesAtLevel=function(){if(arguments.length===1){var o=arguments[0],s=new Gr;return this.boundablesAtLevel(o,this._root,s),s}if(arguments.length===3){var d=arguments[0],_=arguments[1],w=arguments[2];if(Pt.isTrue(d>-2),_.getLevel()===d)return w.add(_),null;for(var j=_.getChildBoundables().iterator();j.hasNext();){var re=j.next();re instanceof ci?this.boundablesAtLevel(d,re,w):(Pt.isTrue(re instanceof zs),d===-1&&w.add(re))}return null}},mo.prototype.query=function(){if(arguments.length===1){var o=arguments[0];this.build();var s=new Gr;return this.isEmpty()||this.getIntersectsOp().intersects(this._root.getBounds(),o)&&this.query(o,this._root,s),s}if(arguments.length===2){var d=arguments[0],_=arguments[1];if(this.build(),this.isEmpty())return null;this.getIntersectsOp().intersects(this._root.getBounds(),d)&&this.query(d,this._root,_)}else if(arguments.length===3){if(Me(arguments[2],cu)&&arguments[0]instanceof Object&&arguments[1]instanceof ci)for(var w=arguments[0],j=arguments[1],re=arguments[2],Pe=j.getChildBoundables(),tt=0;tt<Pe.size();tt++){var It=Pe.get(tt);this.getIntersectsOp().intersects(It.getBounds(),w)&&(It instanceof ci?this.query(w,It,re):It instanceof zs?re.visitItem(It.getItem()):Pt.shouldNeverReachHere())}else if(Me(arguments[2],Oa)&&arguments[0]instanceof Object&&arguments[1]instanceof ci)for(var tr=arguments[0],ot=arguments[1],Zt=arguments[2],Jt=ot.getChildBoundables(),gr=0;gr<Jt.size();gr++){var v=Jt.get(gr);this.getIntersectsOp().intersects(v.getBounds(),tr)&&(v instanceof ci?this.query(tr,v,Zt):v instanceof zs?Zt.add(v.getItem()):Pt.shouldNeverReachHere())}}},mo.prototype.build=function(){if(this._built)return null;this._root=this._itemBoundables.isEmpty()?this.createNode(0):this.createHigherLevels(this._itemBoundables,-1),this._itemBoundables=null,this._built=!0},mo.prototype.getRoot=function(){return this.build(),this._root},mo.prototype.remove=function(){if(arguments.length===2){var o=arguments[0],s=arguments[1];return this.build(),!!this.getIntersectsOp().intersects(this._root.getBounds(),o)&&this.remove(o,this._root,s)}if(arguments.length===3){var d=arguments[0],_=arguments[1],w=arguments[2],j=this.removeItem(_,w);if(j)return!0;for(var re=null,Pe=_.getChildBoundables().iterator();Pe.hasNext();){var tt=Pe.next();if(this.getIntersectsOp().intersects(tt.getBounds(),d)&&tt instanceof ci&&(j=this.remove(d,tt,w))){re=tt;break}}return re!==null&&re.getChildBoundables().isEmpty()&&_.getChildBoundables().remove(re),j}},mo.prototype.createHigherLevels=function(o,s){Pt.isTrue(!o.isEmpty());var d=this.createParentBoundables(o,s+1);return d.size()===1?d.get(0):this.createHigherLevels(d,s+1)},mo.prototype.depth=function(){if(arguments.length===0)return this.isEmpty()?0:(this.build(),this.depth(this._root));if(arguments.length===1){for(var o=0,s=arguments[0].getChildBoundables().iterator();s.hasNext();){var d=s.next();if(d instanceof ci){var _=this.depth(d);_>o&&(o=_)}}return o+1}},mo.prototype.createParentBoundables=function(o,s){Pt.isTrue(!o.isEmpty());var d=new Gr;d.add(this.createNode(s));var _=new Gr(o);Ha.sort(_,this.getComparator());for(var w=_.iterator();w.hasNext();){var j=w.next();this.lastNode(d).getChildBoundables().size()===this.getNodeCapacity()&&d.add(this.createNode(s)),this.lastNode(d).addChildBoundable(j)}return d},mo.prototype.isEmpty=function(){return this._built?this._root.isEmpty():this._itemBoundables.isEmpty()},mo.prototype.interfaces_=function(){return[P]},mo.prototype.getClass=function(){return mo},mo.compareDoubles=function(o,s){return o>s?1:o<s?-1:0},fu.IntersectsOp.get=function(){return mf},fu.serialVersionUID.get=function(){return-3886435814360241e3},fu.DEFAULT_NODE_CAPACITY.get=function(){return 10},Object.defineProperties(mo,fu);var mf=function(){},Ol=function(){};Ol.prototype.distance=function(o,s){},Ol.prototype.interfaces_=function(){return[]},Ol.prototype.getClass=function(){return Ol};var Qc=function(o){function s(_){_=_||s.DEFAULT_NODE_CAPACITY,o.call(this,_)}o&&(s.__proto__=o),(s.prototype=Object.create(o&&o.prototype)).constructor=s;var d={STRtreeNode:{configurable:!0},serialVersionUID:{configurable:!0},xComparator:{configurable:!0},yComparator:{configurable:!0},intersectsOp:{configurable:!0},DEFAULT_NODE_CAPACITY:{configurable:!0}};return s.prototype.createParentBoundablesFromVerticalSlices=function(_,w){Pt.isTrue(_.length>0);for(var j=new Gr,re=0;re<_.length;re++)j.addAll(this.createParentBoundablesFromVerticalSlice(_[re],w));return j},s.prototype.createNode=function(_){return new kf(_)},s.prototype.size=function(){return arguments.length===0?o.prototype.size.call(this):o.prototype.size.apply(this,arguments)},s.prototype.insert=function(){if(arguments.length!==2)return o.prototype.insert.apply(this,arguments);var _=arguments[0],w=arguments[1];if(_.isNull())return null;o.prototype.insert.call(this,_,w)},s.prototype.getIntersectsOp=function(){return s.intersectsOp},s.prototype.verticalSlices=function(_,w){for(var j=Math.trunc(Math.ceil(_.size()/w)),re=new Array(w).fill(null),Pe=_.iterator(),tt=0;tt<w;tt++){re[tt]=new Gr;for(var It=0;Pe.hasNext()&&It<j;){var tr=Pe.next();re[tt].add(tr),It++}}return re},s.prototype.query=function(){if(arguments.length===1){var _=arguments[0];return o.prototype.query.call(this,_)}if(arguments.length===2){var w=arguments[0],j=arguments[1];o.prototype.query.call(this,w,j)}else if(arguments.length===3){if(Me(arguments[2],cu)&&arguments[0]instanceof Object&&arguments[1]instanceof ci){var re=arguments[0],Pe=arguments[1],tt=arguments[2];o.prototype.query.call(this,re,Pe,tt)}else if(Me(arguments[2],Oa)&&arguments[0]instanceof Object&&arguments[1]instanceof ci){var It=arguments[0],tr=arguments[1],ot=arguments[2];o.prototype.query.call(this,It,tr,ot)}}},s.prototype.getComparator=function(){return s.yComparator},s.prototype.createParentBoundablesFromVerticalSlice=function(_,w){return o.prototype.createParentBoundables.call(this,_,w)},s.prototype.remove=function(){if(arguments.length===2){var _=arguments[0],w=arguments[1];return o.prototype.remove.call(this,_,w)}return o.prototype.remove.apply(this,arguments)},s.prototype.depth=function(){return arguments.length===0?o.prototype.depth.call(this):o.prototype.depth.apply(this,arguments)},s.prototype.createParentBoundables=function(_,w){Pt.isTrue(!_.isEmpty());var j=Math.trunc(Math.ceil(_.size()/this.getNodeCapacity())),re=new Gr(_);Ha.sort(re,s.xComparator);var Pe=this.verticalSlices(re,Math.trunc(Math.ceil(Math.sqrt(j))));return this.createParentBoundablesFromVerticalSlices(Pe,w)},s.prototype.nearestNeighbour=function(){if(arguments.length===1){if(Me(arguments[0],Ol)){var _=arguments[0],w=new Ra(this.getRoot(),this.getRoot(),_);return this.nearestNeighbour(w)}if(arguments[0]instanceof Ra){var j=arguments[0];return this.nearestNeighbour(j,le.POSITIVE_INFINITY)}}else if(arguments.length===2){if(arguments[0]instanceof s&&Me(arguments[1],Ol)){var re=arguments[0],Pe=arguments[1],tt=new Ra(this.getRoot(),re.getRoot(),Pe);return this.nearestNeighbour(tt)}if(arguments[0]instanceof Ra&&typeof arguments[1]=="number"){var It=arguments[0],tr=arguments[1],ot=null,Zt=new lu;for(Zt.add(It);!Zt.isEmpty()&&tr>0;){var Jt=Zt.poll(),gr=Jt.getDistance();if(gr>=tr)break;Jt.isLeaves()?(tr=gr,ot=Jt):Jt.expandToQueue(Zt,tr)}return[ot.getBoundable(0).getItem(),ot.getBoundable(1).getItem()]}}else if(arguments.length===3){var v=arguments[0],Ln=arguments[1],jn=arguments[2],Xe=new zs(v,Ln),Ma=new Ra(this.getRoot(),Xe,jn);return this.nearestNeighbour(Ma)[0]}},s.prototype.interfaces_=function(){return[xu,P]},s.prototype.getClass=function(){return s},s.centreX=function(_){return s.avg(_.getMinX(),_.getMaxX())},s.avg=function(_,w){return(_+w)/2},s.centreY=function(_){return s.avg(_.getMinY(),_.getMaxY())},d.STRtreeNode.get=function(){return kf},d.serialVersionUID.get=function(){return 0x39920f7d5f261e0},d.xComparator.get=function(){return{interfaces_:function(){return[ne]},compare:function(_,w){return o.compareDoubles(s.centreX(_.getBounds()),s.centreX(w.getBounds()))}}},d.yComparator.get=function(){return{interfaces_:function(){return[ne]},compare:function(_,w){return o.compareDoubles(s.centreY(_.getBounds()),s.centreY(w.getBounds()))}}},d.intersectsOp.get=function(){return{interfaces_:function(){return[o.IntersectsOp]},intersects:function(_,w){return _.intersects(w)}}},d.DEFAULT_NODE_CAPACITY.get=function(){return 10},Object.defineProperties(s,d),s}(mo),kf=function(o){function s(){var d=arguments[0];o.call(this,d)}return o&&(s.__proto__=o),s.prototype=Object.create(o&&o.prototype),s.prototype.constructor=s,s.prototype.computeBounds=function(){for(var d=null,_=this.getChildBoundables().iterator();_.hasNext();){var w=_.next();d===null?d=new _r(w.getBounds()):d.expandToInclude(w.getBounds())}return d},s.prototype.interfaces_=function(){return[]},s.prototype.getClass=function(){return s},s}(ci),Yo=function(){};Yo.prototype.interfaces_=function(){return[]},Yo.prototype.getClass=function(){return Yo},Yo.relativeSign=function(o,s){return o<s?-1:o>s?1:0},Yo.compare=function(o,s,d){if(s.equals2D(d))return 0;var _=Yo.relativeSign(s.x,d.x),w=Yo.relativeSign(s.y,d.y);switch(o){case 0:return Yo.compareValue(_,w);case 1:return Yo.compareValue(w,_);case 2:return Yo.compareValue(w,-_);case 3:return Yo.compareValue(-_,w);case 4:return Yo.compareValue(-_,-w);case 5:return Yo.compareValue(-w,-_);case 6:return Yo.compareValue(-w,_);case 7:return Yo.compareValue(_,-w)}return Pt.shouldNeverReachHere("invalid octant value"),0},Yo.compareValue=function(o,s){return o<0?-1:o>0?1:s<0?-1:s>0?1:0};var Us=function(){this._segString=null,this.coord=null,this.segmentIndex=null,this._segmentOctant=null,this._isInterior=null;var o=arguments[0],s=arguments[1],d=arguments[2],_=arguments[3];this._segString=o,this.coord=new Y(s),this.segmentIndex=d,this._segmentOctant=_,this._isInterior=!s.equals2D(o.getCoordinate(d))};Us.prototype.getCoordinate=function(){return this.coord},Us.prototype.print=function(o){o.print(this.coord),o.print(" seg # = "+this.segmentIndex)},Us.prototype.compareTo=function(o){var s=o;return this.segmentIndex<s.segmentIndex?-1:this.segmentIndex>s.segmentIndex?1:this.coord.equals2D(s.coord)?0:Yo.compare(this._segmentOctant,this.coord,s.coord)},Us.prototype.isEndPoint=function(o){return this.segmentIndex===0&&!this._isInterior||this.segmentIndex===o},Us.prototype.isInterior=function(){return this._isInterior},Us.prototype.interfaces_=function(){return[ye]},Us.prototype.getClass=function(){return Us};var ko=function(){this._nodeMap=new Ie,this._edge=null;var o=arguments[0];this._edge=o};ko.prototype.getSplitCoordinates=function(){var o=new Co;this.addEndpoints();for(var s=this.iterator(),d=s.next();s.hasNext();){var _=s.next();this.addEdgeCoordinates(d,_,o),d=_}return o.toCoordinateArray()},ko.prototype.addCollapsedNodes=function(){var o=new Gr;this.findCollapsesFromInsertedNodes(o),this.findCollapsesFromExistingVertices(o);for(var s=o.iterator();s.hasNext();){var d=s.next().intValue();this.add(this._edge.getCoordinate(d),d)}},ko.prototype.print=function(o){o.println("Intersections:");for(var s=this.iterator();s.hasNext();)s.next().print(o)},ko.prototype.findCollapsesFromExistingVertices=function(o){for(var s=0;s<this._edge.size()-2;s++){var d=this._edge.getCoordinate(s),_=this._edge.getCoordinate(s+2);d.equals2D(_)&&o.add(new ke(s+1))}},ko.prototype.addEdgeCoordinates=function(o,s,d){var _=this._edge.getCoordinate(s.segmentIndex),w=s.isInterior()||!s.coord.equals2D(_);d.add(new Y(o.coord),!1);for(var j=o.segmentIndex+1;j<=s.segmentIndex;j++)d.add(this._edge.getCoordinate(j));w&&d.add(new Y(s.coord))},ko.prototype.iterator=function(){return this._nodeMap.values().iterator()},ko.prototype.addSplitEdges=function(o){this.addEndpoints(),this.addCollapsedNodes();for(var s=this.iterator(),d=s.next();s.hasNext();){var _=s.next(),w=this.createSplitEdge(d,_);o.add(w),d=_}},ko.prototype.findCollapseIndex=function(o,s,d){if(!o.coord.equals2D(s.coord))return!1;var _=s.segmentIndex-o.segmentIndex;return s.isInterior()||_--,_===1&&(d[0]=o.segmentIndex+1,!0)},ko.prototype.findCollapsesFromInsertedNodes=function(o){for(var s=new Array(1).fill(null),d=this.iterator(),_=d.next();d.hasNext();){var w=d.next();this.findCollapseIndex(_,w,s)&&o.add(new ke(s[0])),_=w}},ko.prototype.getEdge=function(){return this._edge},ko.prototype.addEndpoints=function(){var o=this._edge.size()-1;this.add(this._edge.getCoordinate(0),0),this.add(this._edge.getCoordinate(o),o)},ko.prototype.createSplitEdge=function(o,s){var d=s.segmentIndex-o.segmentIndex+2,_=this._edge.getCoordinate(s.segmentIndex),w=s.isInterior()||!s.coord.equals2D(_);w||d--;var j=new Array(d).fill(null),re=0;j[re++]=new Y(o.coord);for(var Pe=o.segmentIndex+1;Pe<=s.segmentIndex;Pe++)j[re++]=this._edge.getCoordinate(Pe);return w&&(j[re]=new Y(s.coord)),new Ta(j,this._edge.getData())},ko.prototype.add=function(o,s){var d=new Us(this._edge,o,s,this._edge.getSegmentOctant(s)),_=this._nodeMap.get(d);return _!==null?(Pt.isTrue(_.coord.equals2D(o),"Found equal nodes with different coordinates"),_):(this._nodeMap.put(d,d),d)},ko.prototype.checkSplitEdgesCorrectness=function(o){var s=this._edge.getCoordinates(),d=o.get(0).getCoordinate(0);if(!d.equals2D(s[0]))throw new Di("bad split edge start point at "+d);var _=o.get(o.size()-1).getCoordinates(),w=_[_.length-1];if(!w.equals2D(s[s.length-1]))throw new Di("bad split edge end point at "+w)},ko.prototype.interfaces_=function(){return[]},ko.prototype.getClass=function(){return ko};var la=function(){};la.prototype.interfaces_=function(){return[]},la.prototype.getClass=function(){return la},la.octant=function(){if(typeof arguments[0]=="number"&&typeof arguments[1]=="number"){var o=arguments[0],s=arguments[1];if(o===0&&s===0)throw new Te("Cannot compute the octant for point ( "+o+", "+s+" )");var d=Math.abs(o),_=Math.abs(s);return o>=0?s>=0?d>=_?0:1:d>=_?7:6:s>=0?d>=_?3:2:d>=_?4:5}if(arguments[0]instanceof Y&&arguments[1]instanceof Y){var w=arguments[0],j=arguments[1],re=j.x-w.x,Pe=j.y-w.y;if(re===0&&Pe===0)throw new Te("Cannot compute the octant for two identical points "+w);return la.octant(re,Pe)}};var os=function(){};os.prototype.getCoordinates=function(){},os.prototype.size=function(){},os.prototype.getCoordinate=function(o){},os.prototype.isClosed=function(){},os.prototype.setData=function(o){},os.prototype.getData=function(){},os.prototype.interfaces_=function(){return[]},os.prototype.getClass=function(){return os};var Rl=function(){};Rl.prototype.addIntersection=function(o,s){},Rl.prototype.interfaces_=function(){return[os]},Rl.prototype.getClass=function(){return Rl};var Ta=function(){this._nodeList=new ko(this),this._pts=null,this._data=null;var o=arguments[0],s=arguments[1];this._pts=o,this._data=s};Ta.prototype.getCoordinates=function(){return this._pts},Ta.prototype.size=function(){return this._pts.length},Ta.prototype.getCoordinate=function(o){return this._pts[o]},Ta.prototype.isClosed=function(){return this._pts[0].equals(this._pts[this._pts.length-1])},Ta.prototype.getSegmentOctant=function(o){return o===this._pts.length-1?-1:this.safeOctant(this.getCoordinate(o),this.getCoordinate(o+1))},Ta.prototype.setData=function(o){this._data=o},Ta.prototype.safeOctant=function(o,s){return o.equals2D(s)?0:la.octant(o,s)},Ta.prototype.getData=function(){return this._data},Ta.prototype.addIntersection=function(){if(arguments.length===2){var o=arguments[0],s=arguments[1];this.addIntersectionNode(o,s)}else if(arguments.length===4){var d=arguments[0],_=arguments[1],w=arguments[3],j=new Y(d.getIntersection(w));this.addIntersection(j,_)}},Ta.prototype.toString=function(){return _n.toLineString(new ja(this._pts))},Ta.prototype.getNodeList=function(){return this._nodeList},Ta.prototype.addIntersectionNode=function(o,s){var d=s,_=d+1;if(_<this._pts.length){var w=this._pts[_];o.equals2D(w)&&(d=_)}return this._nodeList.add(o,d)},Ta.prototype.addIntersections=function(o,s,d){for(var _=0;_<o.getIntersectionNum();_++)this.addIntersection(o,s,d,_)},Ta.prototype.interfaces_=function(){return[Rl]},Ta.prototype.getClass=function(){return Ta},Ta.getNodedSubstrings=function(){if(arguments.length===1){var o=arguments[0],s=new Gr;return Ta.getNodedSubstrings(o,s),s}if(arguments.length===2)for(var d=arguments[0],_=arguments[1],w=d.iterator();w.hasNext();)w.next().getNodeList().addSplitEdges(_)};var Sn=function(){if(this.p0=null,this.p1=null,arguments.length===0)this.p0=new Y,this.p1=new Y;else if(arguments.length===1){var o=arguments[0];this.p0=new Y(o.p0),this.p1=new Y(o.p1)}else if(arguments.length===2)this.p0=arguments[0],this.p1=arguments[1];else if(arguments.length===4){var s=arguments[0],d=arguments[1],_=arguments[2],w=arguments[3];this.p0=new Y(s,d),this.p1=new Y(_,w)}},vl={serialVersionUID:{configurable:!0}};Sn.prototype.minX=function(){return Math.min(this.p0.x,this.p1.x)},Sn.prototype.orientationIndex=function(){if(arguments[0]instanceof Sn){var o=arguments[0],s=wt.orientationIndex(this.p0,this.p1,o.p0),d=wt.orientationIndex(this.p0,this.p1,o.p1);return s>=0&&d>=0||s<=0&&d<=0?Math.max(s,d):0}if(arguments[0]instanceof Y){var _=arguments[0];return wt.orientationIndex(this.p0,this.p1,_)}},Sn.prototype.toGeometry=function(o){return o.createLineString([this.p0,this.p1])},Sn.prototype.isVertical=function(){return this.p0.x===this.p1.x},Sn.prototype.equals=function(o){if(!(o instanceof Sn))return!1;var s=o;return this.p0.equals(s.p0)&&this.p1.equals(s.p1)},Sn.prototype.intersection=function(o){var s=new $e;return s.computeIntersection(this.p0,this.p1,o.p0,o.p1),s.hasIntersection()?s.getIntersection(0):null},Sn.prototype.project=function(){if(arguments[0]instanceof Y){var o=arguments[0];if(o.equals(this.p0)||o.equals(this.p1))return new Y(o);var s=this.projectionFactor(o),d=new Y;return d.x=this.p0.x+s*(this.p1.x-this.p0.x),d.y=this.p0.y+s*(this.p1.y-this.p0.y),d}if(arguments[0]instanceof Sn){var _=arguments[0],w=this.projectionFactor(_.p0),j=this.projectionFactor(_.p1);if(w>=1&&j>=1||w<=0&&j<=0)return null;var re=this.project(_.p0);w<0&&(re=this.p0),w>1&&(re=this.p1);var Pe=this.project(_.p1);return j<0&&(Pe=this.p0),j>1&&(Pe=this.p1),new Sn(re,Pe)}},Sn.prototype.normalize=function(){this.p1.compareTo(this.p0)<0&&this.reverse()},Sn.prototype.angle=function(){return Math.atan2(this.p1.y-this.p0.y,this.p1.x-this.p0.x)},Sn.prototype.getCoordinate=function(o){return o===0?this.p0:this.p1},Sn.prototype.distancePerpendicular=function(o){return wt.distancePointLinePerpendicular(o,this.p0,this.p1)},Sn.prototype.minY=function(){return Math.min(this.p0.y,this.p1.y)},Sn.prototype.midPoint=function(){return Sn.midPoint(this.p0,this.p1)},Sn.prototype.projectionFactor=function(o){if(o.equals(this.p0))return 0;if(o.equals(this.p1))return 1;var s=this.p1.x-this.p0.x,d=this.p1.y-this.p0.y,_=s*s+d*d;return _<=0?le.NaN:((o.x-this.p0.x)*s+(o.y-this.p0.y)*d)/_},Sn.prototype.closestPoints=function(o){var s=this.intersection(o);if(s!==null)return[s,s];var d=new Array(2).fill(null),_=le.MAX_VALUE,w=null,j=this.closestPoint(o.p0);_=j.distance(o.p0),d[0]=j,d[1]=o.p0;var re=this.closestPoint(o.p1);(w=re.distance(o.p1))<_&&(_=w,d[0]=re,d[1]=o.p1);var Pe=o.closestPoint(this.p0);(w=Pe.distance(this.p0))<_&&(_=w,d[0]=this.p0,d[1]=Pe);var tt=o.closestPoint(this.p1);return(w=tt.distance(this.p1))<_&&(_=w,d[0]=this.p1,d[1]=tt),d},Sn.prototype.closestPoint=function(o){var s=this.projectionFactor(o);return s>0&&s<1?this.project(o):this.p0.distance(o)<this.p1.distance(o)?this.p0:this.p1},Sn.prototype.maxX=function(){return Math.max(this.p0.x,this.p1.x)},Sn.prototype.getLength=function(){return this.p0.distance(this.p1)},Sn.prototype.compareTo=function(o){var s=o,d=this.p0.compareTo(s.p0);return d!==0?d:this.p1.compareTo(s.p1)},Sn.prototype.reverse=function(){var o=this.p0;this.p0=this.p1,this.p1=o},Sn.prototype.equalsTopo=function(o){return this.p0.equals(o.p0)&&(this.p1.equals(o.p1)||this.p0.equals(o.p1))&&this.p1.equals(o.p0)},Sn.prototype.lineIntersection=function(o){try{return Jr.intersection(this.p0,this.p1,o.p0,o.p1)}catch(s){if(!(s instanceof Sr))throw s}return null},Sn.prototype.maxY=function(){return Math.max(this.p0.y,this.p1.y)},Sn.prototype.pointAlongOffset=function(o,s){var d=this.p0.x+o*(this.p1.x-this.p0.x),_=this.p0.y+o*(this.p1.y-this.p0.y),w=this.p1.x-this.p0.x,j=this.p1.y-this.p0.y,re=Math.sqrt(w*w+j*j),Pe=0,tt=0;if(s!==0){if(re<=0)throw new Error("Cannot compute offset from zero-length line segment");Pe=s*w/re,tt=s*j/re}return new Y(d-tt,_+Pe)},Sn.prototype.setCoordinates=function(){if(arguments.length===1){var o=arguments[0];this.setCoordinates(o.p0,o.p1)}else if(arguments.length===2){var s=arguments[0],d=arguments[1];this.p0.x=s.x,this.p0.y=s.y,this.p1.x=d.x,this.p1.y=d.y}},Sn.prototype.segmentFraction=function(o){var s=this.projectionFactor(o);return s<0?s=0:(s>1||le.isNaN(s))&&(s=1),s},Sn.prototype.toString=function(){return"LINESTRING( "+this.p0.x+" "+this.p0.y+", "+this.p1.x+" "+this.p1.y+")"},Sn.prototype.isHorizontal=function(){return this.p0.y===this.p1.y},Sn.prototype.distance=function(){if(arguments[0]instanceof Sn){var o=arguments[0];return wt.distanceLineLine(this.p0,this.p1,o.p0,o.p1)}if(arguments[0]instanceof Y){var s=arguments[0];return wt.distancePointLine(s,this.p0,this.p1)}},Sn.prototype.pointAlong=function(o){var s=new Y;return s.x=this.p0.x+o*(this.p1.x-this.p0.x),s.y=this.p0.y+o*(this.p1.y-this.p0.y),s},Sn.prototype.hashCode=function(){var o=le.doubleToLongBits(this.p0.x);o^=31*le.doubleToLongBits(this.p0.y);var s=Math.trunc(o)^Math.trunc(o>>32),d=le.doubleToLongBits(this.p1.x);return d^=31*le.doubleToLongBits(this.p1.y),s^(Math.trunc(d)^Math.trunc(d>>32))},Sn.prototype.interfaces_=function(){return[ye,P]},Sn.prototype.getClass=function(){return Sn},Sn.midPoint=function(o,s){return new Y((o.x+s.x)/2,(o.y+s.y)/2)},vl.serialVersionUID.get=function(){return 0x2d2172135f411c00},Object.defineProperties(Sn,vl);var ec=function(){this.tempEnv1=new _r,this.tempEnv2=new _r,this._overlapSeg1=new Sn,this._overlapSeg2=new Sn};ec.prototype.overlap=function(){if(arguments.length!==2){if(arguments.length===4){var o=arguments[0],s=arguments[1],d=arguments[2],_=arguments[3];o.getLineSegment(s,this._overlapSeg1),d.getLineSegment(_,this._overlapSeg2),this.overlap(this._overlapSeg1,this._overlapSeg2)}}},ec.prototype.interfaces_=function(){return[]},ec.prototype.getClass=function(){return ec};var Ka=function(){this._pts=null,this._start=null,this._end=null,this._env=null,this._context=null,this._id=null;var o=arguments[0],s=arguments[1],d=arguments[2],_=arguments[3];this._pts=o,this._start=s,this._end=d,this._context=_};Ka.prototype.getLineSegment=function(o,s){s.p0=this._pts[o],s.p1=this._pts[o+1]},Ka.prototype.computeSelect=function(o,s,d,_){var w=this._pts[s],j=this._pts[d];if(_.tempEnv1.init(w,j),d-s==1)return _.select(this,s),null;if(!o.intersects(_.tempEnv1))return null;var re=Math.trunc((s+d)/2);s<re&&this.computeSelect(o,s,re,_),re<d&&this.computeSelect(o,re,d,_)},Ka.prototype.getCoordinates=function(){for(var o=new Array(this._end-this._start+1).fill(null),s=0,d=this._start;d<=this._end;d++)o[s++]=this._pts[d];return o},Ka.prototype.computeOverlaps=function(o,s){this.computeOverlapsInternal(this._start,this._end,o,o._start,o._end,s)},Ka.prototype.setId=function(o){this._id=o},Ka.prototype.select=function(o,s){this.computeSelect(o,this._start,this._end,s)},Ka.prototype.getEnvelope=function(){if(this._env===null){var o=this._pts[this._start],s=this._pts[this._end];this._env=new _r(o,s)}return this._env},Ka.prototype.getEndIndex=function(){return this._end},Ka.prototype.getStartIndex=function(){return this._start},Ka.prototype.getContext=function(){return this._context},Ka.prototype.getId=function(){return this._id},Ka.prototype.computeOverlapsInternal=function(o,s,d,_,w,j){var re=this._pts[o],Pe=this._pts[s],tt=d._pts[_],It=d._pts[w];if(s-o==1&&w-_==1)return j.overlap(this,o,d,_),null;if(j.tempEnv1.init(re,Pe),j.tempEnv2.init(tt,It),!j.tempEnv1.intersects(j.tempEnv2))return null;var tr=Math.trunc((o+s)/2),ot=Math.trunc((_+w)/2);o<tr&&(_<ot&&this.computeOverlapsInternal(o,tr,d,_,ot,j),ot<w&&this.computeOverlapsInternal(o,tr,d,ot,w,j)),tr<s&&(_<ot&&this.computeOverlapsInternal(tr,s,d,_,ot,j),ot<w&&this.computeOverlapsInternal(tr,s,d,ot,w,j))},Ka.prototype.interfaces_=function(){return[]},Ka.prototype.getClass=function(){return Ka};var hs=function(){};hs.prototype.interfaces_=function(){return[]},hs.prototype.getClass=function(){return hs},hs.getChainStartIndices=function(o){var s=0,d=new Gr;d.add(new ke(s));do{var _=hs.findChainEnd(o,s);d.add(new ke(_)),s=_}while(s<o.length-1);return hs.toIntArray(d)},hs.findChainEnd=function(o,s){for(var d=s;d<o.length-1&&o[d].equals2D(o[d+1]);)d++;if(d>=o.length-1)return o.length-1;for(var _=ua.quadrant(o[d],o[d+1]),w=s+1;w<o.length&&!(!o[w-1].equals2D(o[w])&&ua.quadrant(o[w-1],o[w])!==_);)w++;return w-1},hs.getChains=function(){if(arguments.length===1){var o=arguments[0];return hs.getChains(o,null)}if(arguments.length===2){for(var s=arguments[0],d=arguments[1],_=new Gr,w=hs.getChainStartIndices(s),j=0;j<w.length-1;j++){var re=new Ka(s,w[j],w[j+1],d);_.add(re)}return _}},hs.toIntArray=function(o){for(var s=new Array(o.size()).fill(null),d=0;d<s.length;d++)s[d]=o.get(d).intValue();return s};var gl=function(){};gl.prototype.computeNodes=function(o){},gl.prototype.getNodedSubstrings=function(){},gl.prototype.interfaces_=function(){return[]},gl.prototype.getClass=function(){return gl};var vc=function(){if(this._segInt=null,arguments.length!==0){if(arguments.length===1){var o=arguments[0];this.setSegmentIntersector(o)}}};vc.prototype.setSegmentIntersector=function(o){this._segInt=o},vc.prototype.interfaces_=function(){return[gl]},vc.prototype.getClass=function(){return vc};var gc=function(o){function s(_){_?o.call(this,_):o.call(this),this._monoChains=new Gr,this._index=new Qc,this._idCounter=0,this._nodedSegStrings=null,this._nOverlaps=0}o&&(s.__proto__=o),(s.prototype=Object.create(o&&o.prototype)).constructor=s;var d={SegmentOverlapAction:{configurable:!0}};return s.prototype.getMonotoneChains=function(){return this._monoChains},s.prototype.getNodedSubstrings=function(){return Ta.getNodedSubstrings(this._nodedSegStrings)},s.prototype.getIndex=function(){return this._index},s.prototype.add=function(_){for(var w=hs.getChains(_.getCoordinates(),_).iterator();w.hasNext();){var j=w.next();j.setId(this._idCounter++),this._index.insert(j.getEnvelope(),j),this._monoChains.add(j)}},s.prototype.computeNodes=function(_){this._nodedSegStrings=_;for(var w=_.iterator();w.hasNext();)this.add(w.next());this.intersectChains()},s.prototype.intersectChains=function(){for(var _=new yf(this._segInt),w=this._monoChains.iterator();w.hasNext();)for(var j=w.next(),re=this._index.query(j.getEnvelope()).iterator();re.hasNext();){var Pe=re.next();if(Pe.getId()>j.getId()&&(j.computeOverlaps(Pe,_),this._nOverlaps++),this._segInt.isDone())return null}},s.prototype.interfaces_=function(){return[]},s.prototype.getClass=function(){return s},d.SegmentOverlapAction.get=function(){return yf},Object.defineProperties(s,d),s}(vc),yf=function(o){function s(){o.call(this),this._si=null;var d=arguments[0];this._si=d}return o&&(s.__proto__=o),s.prototype=Object.create(o&&o.prototype),s.prototype.constructor=s,s.prototype.overlap=function(){if(arguments.length!==4)return o.prototype.overlap.apply(this,arguments);var d=arguments[0],_=arguments[1],w=arguments[2],j=arguments[3],re=d.getContext(),Pe=w.getContext();this._si.processIntersections(re,_,Pe,j)},s.prototype.interfaces_=function(){return[]},s.prototype.getClass=function(){return s},s}(ec),ea=function o(){if(this._quadrantSegments=o.DEFAULT_QUADRANT_SEGMENTS,this._endCapStyle=o.CAP_ROUND,this._joinStyle=o.JOIN_ROUND,this._mitreLimit=o.DEFAULT_MITRE_LIMIT,this._isSingleSided=!1,this._simplifyFactor=o.DEFAULT_SIMPLIFY_FACTOR,arguments.length!==0){if(arguments.length===1){var s=arguments[0];this.setQuadrantSegments(s)}else if(arguments.length===2){var d=arguments[0],_=arguments[1];this.setQuadrantSegments(d),this.setEndCapStyle(_)}else if(arguments.length===4){var w=arguments[0],j=arguments[1],re=arguments[2],Pe=arguments[3];this.setQuadrantSegments(w),this.setEndCapStyle(j),this.setJoinStyle(re),this.setMitreLimit(Pe)}}},Du={CAP_ROUND:{configurable:!0},CAP_FLAT:{configurable:!0},CAP_SQUARE:{configurable:!0},JOIN_ROUND:{configurable:!0},JOIN_MITRE:{configurable:!0},JOIN_BEVEL:{configurable:!0},DEFAULT_QUADRANT_SEGMENTS:{configurable:!0},DEFAULT_MITRE_LIMIT:{configurable:!0},DEFAULT_SIMPLIFY_FACTOR:{configurable:!0}};ea.prototype.getEndCapStyle=function(){return this._endCapStyle},ea.prototype.isSingleSided=function(){return this._isSingleSided},ea.prototype.setQuadrantSegments=function(o){this._quadrantSegments=o,this._quadrantSegments===0&&(this._joinStyle=ea.JOIN_BEVEL),this._quadrantSegments<0&&(this._joinStyle=ea.JOIN_MITRE,this._mitreLimit=Math.abs(this._quadrantSegments)),o<=0&&(this._quadrantSegments=1),this._joinStyle!==ea.JOIN_ROUND&&(this._quadrantSegments=ea.DEFAULT_QUADRANT_SEGMENTS)},ea.prototype.getJoinStyle=function(){return this._joinStyle},ea.prototype.setJoinStyle=function(o){this._joinStyle=o},ea.prototype.setSimplifyFactor=function(o){this._simplifyFactor=o<0?0:o},ea.prototype.getSimplifyFactor=function(){return this._simplifyFactor},ea.prototype.getQuadrantSegments=function(){return this._quadrantSegments},ea.prototype.setEndCapStyle=function(o){this._endCapStyle=o},ea.prototype.getMitreLimit=function(){return this._mitreLimit},ea.prototype.setMitreLimit=function(o){this._mitreLimit=o},ea.prototype.setSingleSided=function(o){this._isSingleSided=o},ea.prototype.interfaces_=function(){return[]},ea.prototype.getClass=function(){return ea},ea.bufferDistanceError=function(o){var s=Math.PI/2/o;return 1-Math.cos(s/2)},Du.CAP_ROUND.get=function(){return 1},Du.CAP_FLAT.get=function(){return 2},Du.CAP_SQUARE.get=function(){return 3},Du.JOIN_ROUND.get=function(){return 1},Du.JOIN_MITRE.get=function(){return 2},Du.JOIN_BEVEL.get=function(){return 3},Du.DEFAULT_QUADRANT_SEGMENTS.get=function(){return 8},Du.DEFAULT_MITRE_LIMIT.get=function(){return 5},Du.DEFAULT_SIMPLIFY_FACTOR.get=function(){return .01},Object.defineProperties(ea,Du);var na=function(o){this._distanceTol=null,this._isDeleted=null,this._angleOrientation=wt.COUNTERCLOCKWISE,this._inputLine=o||null},Za={INIT:{configurable:!0},DELETE:{configurable:!0},KEEP:{configurable:!0},NUM_PTS_TO_CHECK:{configurable:!0}};na.prototype.isDeletable=function(o,s,d,_){var w=this._inputLine[o],j=this._inputLine[s],re=this._inputLine[d];return!!this.isConcave(w,j,re)&&!!this.isShallow(w,j,re,_)&&this.isShallowSampled(w,j,o,d,_)},na.prototype.deleteShallowConcavities=function(){for(var o=1,s=this.findNextNonDeletedIndex(o),d=this.findNextNonDeletedIndex(s),_=!1;d<this._inputLine.length;){var w=!1;this.isDeletable(o,s,d,this._distanceTol)&&(this._isDeleted[s]=na.DELETE,w=!0,_=!0),o=w?d:s,s=this.findNextNonDeletedIndex(o),d=this.findNextNonDeletedIndex(s)}return _},na.prototype.isShallowConcavity=function(o,s,d,_){return wt.computeOrientation(o,s,d)!==this._angleOrientation?!1:wt.distancePointLine(s,o,d)<_},na.prototype.isShallowSampled=function(o,s,d,_,w){var j=Math.trunc((_-d)/na.NUM_PTS_TO_CHECK);j<=0&&(j=1);for(var re=d;re<_;re+=j)if(!this.isShallow(o,s,this._inputLine[re],w))return!1;return!0},na.prototype.isConcave=function(o,s,d){var _=wt.computeOrientation(o,s,d)===this._angleOrientation;return _},na.prototype.simplify=function(o){this._distanceTol=Math.abs(o),o<0&&(this._angleOrientation=wt.CLOCKWISE),this._isDeleted=new Array(this._inputLine.length).fill(null);var s=!1;do s=this.deleteShallowConcavities();while(s);return this.collapseLine()},na.prototype.findNextNonDeletedIndex=function(o){for(var s=o+1;s<this._inputLine.length&&this._isDeleted[s]===na.DELETE;)s++;return s},na.prototype.isShallow=function(o,s,d,_){return wt.distancePointLine(s,o,d)<_},na.prototype.collapseLine=function(){for(var o=new Co,s=0;s<this._inputLine.length;s++)this._isDeleted[s]!==na.DELETE&&o.add(this._inputLine[s]);return o.toCoordinateArray()},na.prototype.interfaces_=function(){return[]},na.prototype.getClass=function(){return na},na.simplify=function(o,s){return new na(o).simplify(s)},Za.INIT.get=function(){return 0},Za.DELETE.get=function(){return 1},Za.KEEP.get=function(){return 1},Za.NUM_PTS_TO_CHECK.get=function(){return 10},Object.defineProperties(na,Za);var Do=function(){this._ptList=null,this._precisionModel=null,this._minimimVertexDistance=0,this._ptList=new Gr},n0={COORDINATE_ARRAY_TYPE:{configurable:!0}};Do.prototype.getCoordinates=function(){return this._ptList.toArray(Do.COORDINATE_ARRAY_TYPE)},Do.prototype.setPrecisionModel=function(o){this._precisionModel=o},Do.prototype.addPt=function(o){var s=new Y(o);if(this._precisionModel.makePrecise(s),this.isRedundant(s))return null;this._ptList.add(s)},Do.prototype.revere=function(){},Do.prototype.addPts=function(o,s){if(s)for(var d=0;d<o.length;d++)this.addPt(o[d]);else for(var _=o.length-1;_>=0;_--)this.addPt(o[_])},Do.prototype.isRedundant=function(o){if(this._ptList.size()<1)return!1;var s=this._ptList.get(this._ptList.size()-1);return o.distance(s)<this._minimimVertexDistance},Do.prototype.toString=function(){return new Ai().createLineString(this.getCoordinates()).toString()},Do.prototype.closeRing=function(){if(this._ptList.size()<1)return null;var o=new Y(this._ptList.get(0)),s=this._ptList.get(this._ptList.size()-1);if(o.equals(s))return null;this._ptList.add(o)},Do.prototype.setMinimumVertexDistance=function(o){this._minimimVertexDistance=o},Do.prototype.interfaces_=function(){return[]},Do.prototype.getClass=function(){return Do},n0.COORDINATE_ARRAY_TYPE.get=function(){return new Array(0).fill(null)},Object.defineProperties(Do,n0);var fi=function(){},As={PI_TIMES_2:{configurable:!0},PI_OVER_2:{configurable:!0},PI_OVER_4:{configurable:!0},COUNTERCLOCKWISE:{configurable:!0},CLOCKWISE:{configurable:!0},NONE:{configurable:!0}};fi.prototype.interfaces_=function(){return[]},fi.prototype.getClass=function(){return fi},fi.toDegrees=function(o){return 180*o/Math.PI},fi.normalize=function(o){for(;o>Math.PI;)o-=fi.PI_TIMES_2;for(;o<=-Math.PI;)o+=fi.PI_TIMES_2;return o},fi.angle=function(){if(arguments.length===1){var o=arguments[0];return Math.atan2(o.y,o.x)}if(arguments.length===2){var s=arguments[0],d=arguments[1],_=d.x-s.x,w=d.y-s.y;return Math.atan2(w,_)}},fi.isAcute=function(o,s,d){var _=o.x-s.x,w=o.y-s.y;return _*(d.x-s.x)+w*(d.y-s.y)>0},fi.isObtuse=function(o,s,d){var _=o.x-s.x,w=o.y-s.y;return _*(d.x-s.x)+w*(d.y-s.y)<0},fi.interiorAngle=function(o,s,d){var _=fi.angle(s,o),w=fi.angle(s,d);return Math.abs(w-_)},fi.normalizePositive=function(o){if(o<0){for(;o<0;)o+=fi.PI_TIMES_2;o>=fi.PI_TIMES_2&&(o=0)}else{for(;o>=fi.PI_TIMES_2;)o-=fi.PI_TIMES_2;o<0&&(o=0)}return o},fi.angleBetween=function(o,s,d){var _=fi.angle(s,o),w=fi.angle(s,d);return fi.diff(_,w)},fi.diff=function(o,s){var d=null;return(d=o<s?s-o:o-s)>Math.PI&&(d=2*Math.PI-d),d},fi.toRadians=function(o){return o*Math.PI/180},fi.getTurn=function(o,s){var d=Math.sin(s-o);return d>0?fi.COUNTERCLOCKWISE:d<0?fi.CLOCKWISE:fi.NONE},fi.angleBetweenOriented=function(o,s,d){var _=fi.angle(s,o),w=fi.angle(s,d)-_;return w<=-Math.PI?w+fi.PI_TIMES_2:w>Math.PI?w-fi.PI_TIMES_2:w},As.PI_TIMES_2.get=function(){return 2*Math.PI},As.PI_OVER_2.get=function(){return Math.PI/2},As.PI_OVER_4.get=function(){return Math.PI/4},As.COUNTERCLOCKWISE.get=function(){return wt.COUNTERCLOCKWISE},As.CLOCKWISE.get=function(){return wt.CLOCKWISE},As.NONE.get=function(){return wt.COLLINEAR},Object.defineProperties(fi,As);var ia=function o(){this._maxCurveSegmentError=0,this._filletAngleQuantum=null,this._closingSegLengthFactor=1,this._segList=null,this._distance=0,this._precisionModel=null,this._bufParams=null,this._li=null,this._s0=null,this._s1=null,this._s2=null,this._seg0=new Sn,this._seg1=new Sn,this._offset0=new Sn,this._offset1=new Sn,this._side=0,this._hasNarrowConcaveAngle=!1;var s=arguments[0],d=arguments[1],_=arguments[2];this._precisionModel=s,this._bufParams=d,this._li=new $e,this._filletAngleQuantum=Math.PI/2/d.getQuadrantSegments(),d.getQuadrantSegments()>=8&&d.getJoinStyle()===ea.JOIN_ROUND&&(this._closingSegLengthFactor=o.MAX_CLOSING_SEG_LEN_FACTOR),this.init(_)},Ts={OFFSET_SEGMENT_SEPARATION_FACTOR:{configurable:!0},INSIDE_TURN_VERTEX_SNAP_DISTANCE_FACTOR:{configurable:!0},CURVE_VERTEX_SNAP_DISTANCE_FACTOR:{configurable:!0},MAX_CLOSING_SEG_LEN_FACTOR:{configurable:!0}};ia.prototype.addNextSegment=function(o,s){if(this._s0=this._s1,this._s1=this._s2,this._s2=o,this._seg0.setCoordinates(this._s0,this._s1),this.computeOffsetSegment(this._seg0,this._side,this._distance,this._offset0),this._seg1.setCoordinates(this._s1,this._s2),this.computeOffsetSegment(this._seg1,this._side,this._distance,this._offset1),this._s1.equals(this._s2))return null;var d=wt.computeOrientation(this._s0,this._s1,this._s2),_=d===wt.CLOCKWISE&&this._side===ce.LEFT||d===wt.COUNTERCLOCKWISE&&this._side===ce.RIGHT;d===0?this.addCollinear(s):_?this.addOutsideTurn(d,s):this.addInsideTurn(d,s)},ia.prototype.addLineEndCap=function(o,s){var d=new Sn(o,s),_=new Sn;this.computeOffsetSegment(d,ce.LEFT,this._distance,_);var w=new Sn;this.computeOffsetSegment(d,ce.RIGHT,this._distance,w);var j=s.x-o.x,re=s.y-o.y,Pe=Math.atan2(re,j);switch(this._bufParams.getEndCapStyle()){case ea.CAP_ROUND:this._segList.addPt(_.p1),this.addFilletArc(s,Pe+Math.PI/2,Pe-Math.PI/2,wt.CLOCKWISE,this._distance),this._segList.addPt(w.p1);break;case ea.CAP_FLAT:this._segList.addPt(_.p1),this._segList.addPt(w.p1);break;case ea.CAP_SQUARE:var tt=new Y;tt.x=Math.abs(this._distance)*Math.cos(Pe),tt.y=Math.abs(this._distance)*Math.sin(Pe);var It=new Y(_.p1.x+tt.x,_.p1.y+tt.y),tr=new Y(w.p1.x+tt.x,w.p1.y+tt.y);this._segList.addPt(It),this._segList.addPt(tr)}},ia.prototype.getCoordinates=function(){return this._segList.getCoordinates()},ia.prototype.addMitreJoin=function(o,s,d,_){var w=!0,j=null;try{j=Jr.intersection(s.p0,s.p1,d.p0,d.p1),(_<=0?1:j.distance(o)/Math.abs(_))>this._bufParams.getMitreLimit()&&(w=!1)}catch(re){if(!(re instanceof Sr))throw re;j=new Y(0,0),w=!1}w?this._segList.addPt(j):this.addLimitedMitreJoin(s,d,_,this._bufParams.getMitreLimit())},ia.prototype.addFilletCorner=function(o,s,d,_,w){var j=s.x-o.x,re=s.y-o.y,Pe=Math.atan2(re,j),tt=d.x-o.x,It=d.y-o.y,tr=Math.atan2(It,tt);_===wt.CLOCKWISE?Pe<=tr&&(Pe+=2*Math.PI):Pe>=tr&&(Pe-=2*Math.PI),this._segList.addPt(s),this.addFilletArc(o,Pe,tr,_,w),this._segList.addPt(d)},ia.prototype.addOutsideTurn=function(o,s){if(this._offset0.p1.distance(this._offset1.p0)<this._distance*ia.OFFSET_SEGMENT_SEPARATION_FACTOR)return this._segList.addPt(this._offset0.p1),null;this._bufParams.getJoinStyle()===ea.JOIN_MITRE?this.addMitreJoin(this._s1,this._offset0,this._offset1,this._distance):this._bufParams.getJoinStyle()===ea.JOIN_BEVEL?this.addBevelJoin(this._offset0,this._offset1):(s&&this._segList.addPt(this._offset0.p1),this.addFilletCorner(this._s1,this._offset0.p1,this._offset1.p0,o,this._distance),this._segList.addPt(this._offset1.p0))},ia.prototype.createSquare=function(o){this._segList.addPt(new Y(o.x+this._distance,o.y+this._distance)),this._segList.addPt(new Y(o.x+this._distance,o.y-this._distance)),this._segList.addPt(new Y(o.x-this._distance,o.y-this._distance)),this._segList.addPt(new Y(o.x-this._distance,o.y+this._distance)),this._segList.closeRing()},ia.prototype.addSegments=function(o,s){this._segList.addPts(o,s)},ia.prototype.addFirstSegment=function(){this._segList.addPt(this._offset1.p0)},ia.prototype.addLastSegment=function(){this._segList.addPt(this._offset1.p1)},ia.prototype.initSideSegments=function(o,s,d){this._s1=o,this._s2=s,this._side=d,this._seg1.setCoordinates(o,s),this.computeOffsetSegment(this._seg1,d,this._distance,this._offset1)},ia.prototype.addLimitedMitreJoin=function(o,s,d,_){var w=this._seg0.p1,j=fi.angle(w,this._seg0.p0),re=fi.angleBetweenOriented(this._seg0.p0,w,this._seg1.p1)/2,Pe=fi.normalize(j+re),tt=fi.normalize(Pe+Math.PI),It=_*d,tr=d-It*Math.abs(Math.sin(re)),ot=w.x+It*Math.cos(tt),Zt=w.y+It*Math.sin(tt),Jt=new Y(ot,Zt),gr=new Sn(w,Jt),v=gr.pointAlongOffset(1,tr),Ln=gr.pointAlongOffset(1,-tr);this._side===ce.LEFT?(this._segList.addPt(v),this._segList.addPt(Ln)):(this._segList.addPt(Ln),this._segList.addPt(v))},ia.prototype.computeOffsetSegment=function(o,s,d,_){var w=s===ce.LEFT?1:-1,j=o.p1.x-o.p0.x,re=o.p1.y-o.p0.y,Pe=Math.sqrt(j*j+re*re),tt=w*d*j/Pe,It=w*d*re/Pe;_.p0.x=o.p0.x-It,_.p0.y=o.p0.y+tt,_.p1.x=o.p1.x-It,_.p1.y=o.p1.y+tt},ia.prototype.addFilletArc=function(o,s,d,_,w){var j=_===wt.CLOCKWISE?-1:1,re=Math.abs(s-d),Pe=Math.trunc(re/this._filletAngleQuantum+.5);if(Pe<1)return null;for(var tt=re/Pe,It=0,tr=new Y;It<re;){var ot=s+j*It;tr.x=o.x+w*Math.cos(ot),tr.y=o.y+w*Math.sin(ot),this._segList.addPt(tr),It+=tt}},ia.prototype.addInsideTurn=function(o,s){if(this._li.computeIntersection(this._offset0.p0,this._offset0.p1,this._offset1.p0,this._offset1.p1),this._li.hasIntersection())this._segList.addPt(this._li.getIntersection(0));else if(this._hasNarrowConcaveAngle=!0,this._offset0.p1.distance(this._offset1.p0)<this._distance*ia.INSIDE_TURN_VERTEX_SNAP_DISTANCE_FACTOR)this._segList.addPt(this._offset0.p1);else{if(this._segList.addPt(this._offset0.p1),this._closingSegLengthFactor>0){var d=new Y((this._closingSegLengthFactor*this._offset0.p1.x+this._s1.x)/(this._closingSegLengthFactor+1),(this._closingSegLengthFactor*this._offset0.p1.y+this._s1.y)/(this._closingSegLengthFactor+1));this._segList.addPt(d);var _=new Y((this._closingSegLengthFactor*this._offset1.p0.x+this._s1.x)/(this._closingSegLengthFactor+1),(this._closingSegLengthFactor*this._offset1.p0.y+this._s1.y)/(this._closingSegLengthFactor+1));this._segList.addPt(_)}else this._segList.addPt(this._s1);this._segList.addPt(this._offset1.p0)}},ia.prototype.createCircle=function(o){var s=new Y(o.x+this._distance,o.y);this._segList.addPt(s),this.addFilletArc(o,0,2*Math.PI,-1,this._distance),this._segList.closeRing()},ia.prototype.addBevelJoin=function(o,s){this._segList.addPt(o.p1),this._segList.addPt(s.p0)},ia.prototype.init=function(o){this._distance=o,this._maxCurveSegmentError=o*(1-Math.cos(this._filletAngleQuantum/2)),this._segList=new Do,this._segList.setPrecisionModel(this._precisionModel),this._segList.setMinimumVertexDistance(o*ia.CURVE_VERTEX_SNAP_DISTANCE_FACTOR)},ia.prototype.addCollinear=function(o){this._li.computeIntersection(this._s0,this._s1,this._s1,this._s2),this._li.getIntersectionNum()>=2&&(this._bufParams.getJoinStyle()===ea.JOIN_BEVEL||this._bufParams.getJoinStyle()===ea.JOIN_MITRE?(o&&this._segList.addPt(this._offset0.p1),this._segList.addPt(this._offset1.p0)):this.addFilletCorner(this._s1,this._offset0.p1,this._offset1.p0,wt.CLOCKWISE,this._distance))},ia.prototype.closeRing=function(){this._segList.closeRing()},ia.prototype.hasNarrowConcaveAngle=function(){return this._hasNarrowConcaveAngle},ia.prototype.interfaces_=function(){return[]},ia.prototype.getClass=function(){return ia},Ts.OFFSET_SEGMENT_SEPARATION_FACTOR.get=function(){return .001},Ts.INSIDE_TURN_VERTEX_SNAP_DISTANCE_FACTOR.get=function(){return .001},Ts.CURVE_VERTEX_SNAP_DISTANCE_FACTOR.get=function(){return 1e-6},Ts.MAX_CLOSING_SEG_LEN_FACTOR.get=function(){return 80},Object.defineProperties(ia,Ts);var _a=function(){this._distance=0,this._precisionModel=null,this._bufParams=null;var o=arguments[0],s=arguments[1];this._precisionModel=o,this._bufParams=s};_a.prototype.getOffsetCurve=function(o,s){if(this._distance=s,s===0)return null;var d=s<0,_=Math.abs(s),w=this.getSegGen(_);o.length<=1?this.computePointCurve(o[0],w):this.computeOffsetCurve(o,d,w);var j=w.getCoordinates();return d&&xn.reverse(j),j},_a.prototype.computeSingleSidedBufferCurve=function(o,s,d){var _=this.simplifyTolerance(this._distance);if(s){d.addSegments(o,!0);var w=na.simplify(o,-_),j=w.length-1;d.initSideSegments(w[j],w[j-1],ce.LEFT),d.addFirstSegment();for(var re=j-2;re>=0;re--)d.addNextSegment(w[re],!0)}else{d.addSegments(o,!1);var Pe=na.simplify(o,_),tt=Pe.length-1;d.initSideSegments(Pe[0],Pe[1],ce.LEFT),d.addFirstSegment();for(var It=2;It<=tt;It++)d.addNextSegment(Pe[It],!0)}d.addLastSegment(),d.closeRing()},_a.prototype.computeRingBufferCurve=function(o,s,d){var _=this.simplifyTolerance(this._distance);s===ce.RIGHT&&(_=-_);var w=na.simplify(o,_),j=w.length-1;d.initSideSegments(w[j-1],w[0],s);for(var re=1;re<=j;re++){var Pe=re!==1;d.addNextSegment(w[re],Pe)}d.closeRing()},_a.prototype.computeLineBufferCurve=function(o,s){var d=this.simplifyTolerance(this._distance),_=na.simplify(o,d),w=_.length-1;s.initSideSegments(_[0],_[1],ce.LEFT);for(var j=2;j<=w;j++)s.addNextSegment(_[j],!0);s.addLastSegment(),s.addLineEndCap(_[w-1],_[w]);var re=na.simplify(o,-d),Pe=re.length-1;s.initSideSegments(re[Pe],re[Pe-1],ce.LEFT);for(var tt=Pe-2;tt>=0;tt--)s.addNextSegment(re[tt],!0);s.addLastSegment(),s.addLineEndCap(re[1],re[0]),s.closeRing()},_a.prototype.computePointCurve=function(o,s){switch(this._bufParams.getEndCapStyle()){case ea.CAP_ROUND:s.createCircle(o);break;case ea.CAP_SQUARE:s.createSquare(o)}},_a.prototype.getLineCurve=function(o,s){if(this._distance=s,s<0&&!this._bufParams.isSingleSided()||s===0)return null;var d=Math.abs(s),_=this.getSegGen(d);if(o.length<=1)this.computePointCurve(o[0],_);else if(this._bufParams.isSingleSided()){var w=s<0;this.computeSingleSidedBufferCurve(o,w,_)}else this.computeLineBufferCurve(o,_);return _.getCoordinates()},_a.prototype.getBufferParameters=function(){return this._bufParams},_a.prototype.simplifyTolerance=function(o){return o*this._bufParams.getSimplifyFactor()},_a.prototype.getRingCurve=function(o,s,d){if(this._distance=d,o.length<=2)return this.getLineCurve(o,d);if(d===0)return _a.copyCoordinates(o);var _=this.getSegGen(d);return this.computeRingBufferCurve(o,s,_),_.getCoordinates()},_a.prototype.computeOffsetCurve=function(o,s,d){var _=this.simplifyTolerance(this._distance);if(s){var w=na.simplify(o,-_),j=w.length-1;d.initSideSegments(w[j],w[j-1],ce.LEFT),d.addFirstSegment();for(var re=j-2;re>=0;re--)d.addNextSegment(w[re],!0)}else{var Pe=na.simplify(o,_),tt=Pe.length-1;d.initSideSegments(Pe[0],Pe[1],ce.LEFT),d.addFirstSegment();for(var It=2;It<=tt;It++)d.addNextSegment(Pe[It],!0)}d.addLastSegment()},_a.prototype.getSegGen=function(o){return new ia(this._precisionModel,this._bufParams,o)},_a.prototype.interfaces_=function(){return[]},_a.prototype.getClass=function(){return _a},_a.copyCoordinates=function(o){for(var s=new Array(o.length).fill(null),d=0;d<s.length;d++)s[d]=new Y(o[d]);return s};var ps=function(){this._subgraphs=null,this._seg=new Sn,this._cga=new wt;var o=arguments[0];this._subgraphs=o},ml={DepthSegment:{configurable:!0}};ps.prototype.findStabbedSegments=function(){if(arguments.length===1){for(var o=arguments[0],s=new Gr,d=this._subgraphs.iterator();d.hasNext();){var _=d.next(),w=_.getEnvelope();o.y<w.getMinY()||o.y>w.getMaxY()||this.findStabbedSegments(o,_.getDirectedEdges(),s)}return s}if(arguments.length===3){if(Me(arguments[2],Oa)&&arguments[0]instanceof Y&&arguments[1]instanceof gf){for(var j=arguments[0],re=arguments[1],Pe=arguments[2],tt=re.getEdge().getCoordinates(),It=0;It<tt.length-1;It++)if(this._seg.p0=tt[It],this._seg.p1=tt[It+1],this._seg.p0.y>this._seg.p1.y&&this._seg.reverse(),!(Math.max(this._seg.p0.x,this._seg.p1.x)<j.x)&&!(this._seg.isHorizontal()||j.y<this._seg.p0.y||j.y>this._seg.p1.y||wt.computeOrientation(this._seg.p0,this._seg.p1,j)===wt.RIGHT)){var tr=re.getDepth(ce.LEFT);this._seg.p0.equals(tt[It])||(tr=re.getDepth(ce.RIGHT));var ot=new ru(this._seg,tr);Pe.add(ot)}}else if(Me(arguments[2],Oa)&&arguments[0]instanceof Y&&Me(arguments[1],Oa))for(var Zt=arguments[0],Jt=arguments[1],gr=arguments[2],v=Jt.iterator();v.hasNext();){var Ln=v.next();Ln.isForward()&&this.findStabbedSegments(Zt,Ln,gr)}}},ps.prototype.getDepth=function(o){var s=this.findStabbedSegments(o);return s.size()===0?0:Ha.min(s)._leftDepth},ps.prototype.interfaces_=function(){return[]},ps.prototype.getClass=function(){return ps},ml.DepthSegment.get=function(){return ru},Object.defineProperties(ps,ml);var ru=function(){this._upwardSeg=null,this._leftDepth=null;var o=arguments[0],s=arguments[1];this._upwardSeg=new Sn(o),this._leftDepth=s};ru.prototype.compareTo=function(o){var s=o;if(this._upwardSeg.minX()>=s._upwardSeg.maxX())return 1;if(this._upwardSeg.maxX()<=s._upwardSeg.minX())return-1;var d=this._upwardSeg.orientationIndex(s._upwardSeg);return d!==0||(d=-1*s._upwardSeg.orientationIndex(this._upwardSeg))!=0?d:this._upwardSeg.compareTo(s._upwardSeg)},ru.prototype.compareX=function(o,s){var d=o.p0.compareTo(s.p0);return d!==0?d:o.p1.compareTo(s.p1)},ru.prototype.toString=function(){return this._upwardSeg.toString()},ru.prototype.interfaces_=function(){return[ye]},ru.prototype.getClass=function(){return ru};var Mi=function(o,s,d){this.p0=o||null,this.p1=s||null,this.p2=d||null};Mi.prototype.area=function(){return Mi.area(this.p0,this.p1,this.p2)},Mi.prototype.signedArea=function(){return Mi.signedArea(this.p0,this.p1,this.p2)},Mi.prototype.interpolateZ=function(o){if(o===null)throw new Te("Supplied point is null.");return Mi.interpolateZ(o,this.p0,this.p1,this.p2)},Mi.prototype.longestSideLength=function(){return Mi.longestSideLength(this.p0,this.p1,this.p2)},Mi.prototype.isAcute=function(){return Mi.isAcute(this.p0,this.p1,this.p2)},Mi.prototype.circumcentre=function(){return Mi.circumcentre(this.p0,this.p1,this.p2)},Mi.prototype.area3D=function(){return Mi.area3D(this.p0,this.p1,this.p2)},Mi.prototype.centroid=function(){return Mi.centroid(this.p0,this.p1,this.p2)},Mi.prototype.inCentre=function(){return Mi.inCentre(this.p0,this.p1,this.p2)},Mi.prototype.interfaces_=function(){return[]},Mi.prototype.getClass=function(){return Mi},Mi.area=function(o,s,d){return Math.abs(((d.x-o.x)*(s.y-o.y)-(s.x-o.x)*(d.y-o.y))/2)},Mi.signedArea=function(o,s,d){return((d.x-o.x)*(s.y-o.y)-(s.x-o.x)*(d.y-o.y))/2},Mi.det=function(o,s,d,_){return o*_-s*d},Mi.interpolateZ=function(o,s,d,_){var w=s.x,j=s.y,re=d.x-w,Pe=_.x-w,tt=d.y-j,It=_.y-j,tr=re*It-Pe*tt,ot=o.x-w,Zt=o.y-j,Jt=(It*ot-Pe*Zt)/tr,gr=(-tt*ot+re*Zt)/tr;return s.z+Jt*(d.z-s.z)+gr*(_.z-s.z)},Mi.longestSideLength=function(o,s,d){var _=o.distance(s),w=s.distance(d),j=d.distance(o),re=_;return w>re&&(re=w),j>re&&(re=j),re},Mi.isAcute=function(o,s,d){return!!fi.isAcute(o,s,d)&&!!fi.isAcute(s,d,o)&&!!fi.isAcute(d,o,s)},Mi.circumcentre=function(o,s,d){var _=d.x,w=d.y,j=o.x-_,re=o.y-w,Pe=s.x-_,tt=s.y-w,It=2*Mi.det(j,re,Pe,tt),tr=Mi.det(re,j*j+re*re,tt,Pe*Pe+tt*tt),ot=Mi.det(j,j*j+re*re,Pe,Pe*Pe+tt*tt);return new Y(_-tr/It,w+ot/It)},Mi.perpendicularBisector=function(o,s){var d=s.x-o.x,_=s.y-o.y,w=new Jr(o.x+d/2,o.y+_/2,1),j=new Jr(o.x-_+d/2,o.y+d+_/2,1);return new Jr(w,j)},Mi.angleBisector=function(o,s,d){var _=s.distance(o),w=_/(_+s.distance(d)),j=d.x-o.x,re=d.y-o.y;return new Y(o.x+w*j,o.y+w*re)},Mi.area3D=function(o,s,d){var _=s.x-o.x,w=s.y-o.y,j=s.z-o.z,re=d.x-o.x,Pe=d.y-o.y,tt=d.z-o.z,It=w*tt-j*Pe,tr=j*re-_*tt,ot=_*Pe-w*re,Zt=It*It+tr*tr+ot*ot,Jt=Math.sqrt(Zt)/2;return Jt},Mi.centroid=function(o,s,d){var _=(o.x+s.x+d.x)/3,w=(o.y+s.y+d.y)/3;return new Y(_,w)},Mi.inCentre=function(o,s,d){var _=s.distance(d),w=o.distance(d),j=o.distance(s),re=_+w+j,Pe=(_*o.x+w*s.x+j*d.x)/re,tt=(_*o.y+w*s.y+j*d.y)/re;return new Y(Pe,tt)};var ss=function(){this._inputGeom=null,this._distance=null,this._curveBuilder=null,this._curveList=new Gr;var o=arguments[0],s=arguments[1],d=arguments[2];this._inputGeom=o,this._distance=s,this._curveBuilder=d};ss.prototype.addPoint=function(o){if(this._distance<=0)return null;var s=o.getCoordinates(),d=this._curveBuilder.getLineCurve(s,this._distance);this.addCurve(d,ge.EXTERIOR,ge.INTERIOR)},ss.prototype.addPolygon=function(o){var s=this._distance,d=ce.LEFT;this._distance<0&&(s=-this._distance,d=ce.RIGHT);var _=o.getExteriorRing(),w=xn.removeRepeatedPoints(_.getCoordinates());if(this._distance<0&&this.isErodedCompletely(_,this._distance)||this._distance<=0&&w.length<3)return null;this.addPolygonRing(w,s,d,ge.EXTERIOR,ge.INTERIOR);for(var j=0;j<o.getNumInteriorRing();j++){var re=o.getInteriorRingN(j),Pe=xn.removeRepeatedPoints(re.getCoordinates());this._distance>0&&this.isErodedCompletely(re,-this._distance)||this.addPolygonRing(Pe,s,ce.opposite(d),ge.INTERIOR,ge.EXTERIOR)}},ss.prototype.isTriangleErodedCompletely=function(o,s){var d=new Mi(o[0],o[1],o[2]),_=d.inCentre();return wt.distancePointLine(_,d.p0,d.p1)<Math.abs(s)},ss.prototype.addLineString=function(o){if(this._distance<=0&&!this._curveBuilder.getBufferParameters().isSingleSided())return null;var s=xn.removeRepeatedPoints(o.getCoordinates()),d=this._curveBuilder.getLineCurve(s,this._distance);this.addCurve(d,ge.EXTERIOR,ge.INTERIOR)},ss.prototype.addCurve=function(o,s,d){if(o===null||o.length<2)return null;var _=new Ta(o,new Mn(0,ge.BOUNDARY,s,d));this._curveList.add(_)},ss.prototype.getCurves=function(){return this.add(this._inputGeom),this._curveList},ss.prototype.addPolygonRing=function(o,s,d,_,w){if(s===0&&o.length<Mr.MINIMUM_VALID_SIZE)return null;var j=_,re=w;o.length>=Mr.MINIMUM_VALID_SIZE&&wt.isCCW(o)&&(j=w,re=_,d=ce.opposite(d));var Pe=this._curveBuilder.getRingCurve(o,d,s);this.addCurve(Pe,j,re)},ss.prototype.add=function(o){if(o.isEmpty())return null;o instanceof Ca?this.addPolygon(o):o instanceof ya?this.addLineString(o):o instanceof uo?this.addPoint(o):o instanceof uu?this.addCollection(o):o instanceof Ni?this.addCollection(o):o instanceof vn?this.addCollection(o):o instanceof Oo&&this.addCollection(o)},ss.prototype.isErodedCompletely=function(o,s){var d=o.getCoordinates();if(d.length<4)return s<0;if(d.length===4)return this.isTriangleErodedCompletely(d,s);var _=o.getEnvelopeInternal(),w=Math.min(_.getHeight(),_.getWidth());return s<0&&2*Math.abs(s)>w},ss.prototype.addCollection=function(o){for(var s=0;s<o.getNumGeometries();s++){var d=o.getGeometryN(s);this.add(d)}},ss.prototype.interfaces_=function(){return[]},ss.prototype.getClass=function(){return ss};var nu=function(){};nu.prototype.locate=function(o){},nu.prototype.interfaces_=function(){return[]},nu.prototype.getClass=function(){return nu};var No=function(){this._parent=null,this._atStart=null,this._max=null,this._index=null,this._subcollectionIterator=null;var o=arguments[0];this._parent=o,this._atStart=!0,this._index=0,this._max=o.getNumGeometries()};No.prototype.next=function(){if(this._atStart)return this._atStart=!1,No.isAtomic(this._parent)&&this._index++,this._parent;if(this._subcollectionIterator!==null){if(this._subcollectionIterator.hasNext())return this._subcollectionIterator.next();this._subcollectionIterator=null}if(this._index>=this._max)throw new G;var o=this._parent.getGeometryN(this._index++);return o instanceof Oo?(this._subcollectionIterator=new No(o),this._subcollectionIterator.next()):o},No.prototype.remove=function(){throw new Error(this.getClass().getName())},No.prototype.hasNext=function(){if(this._atStart)return!0;if(this._subcollectionIterator!==null){if(this._subcollectionIterator.hasNext())return!0;this._subcollectionIterator=null}return!(this._index>=this._max)},No.prototype.interfaces_=function(){return[sa]},No.prototype.getClass=function(){return No},No.isAtomic=function(o){return!(o instanceof Oo)};var ds=function(){this._geom=null;var o=arguments[0];this._geom=o};ds.prototype.locate=function(o){return ds.locate(o,this._geom)},ds.prototype.interfaces_=function(){return[nu]},ds.prototype.getClass=function(){return ds},ds.isPointInRing=function(o,s){return!!s.getEnvelopeInternal().intersects(o)&&wt.isPointInRing(o,s.getCoordinates())},ds.containsPointInPolygon=function(o,s){if(s.isEmpty())return!1;var d=s.getExteriorRing();if(!ds.isPointInRing(o,d))return!1;for(var _=0;_<s.getNumInteriorRing();_++){var w=s.getInteriorRingN(_);if(ds.isPointInRing(o,w))return!1}return!0},ds.containsPoint=function(o,s){if(s instanceof Ca)return ds.containsPointInPolygon(o,s);if(s instanceof Oo)for(var d=new No(s);d.hasNext();){var _=d.next();if(_!==s&&ds.containsPoint(o,_))return!0}return!1},ds.locate=function(o,s){return s.isEmpty()?ge.EXTERIOR:ds.containsPoint(o,s)?ge.INTERIOR:ge.EXTERIOR};var Fo=function(){this._edgeMap=new Ie,this._edgeList=null,this._ptInAreaLocation=[ge.NONE,ge.NONE]};Fo.prototype.getNextCW=function(o){this.getEdges();var s=this._edgeList.indexOf(o),d=s-1;return s===0&&(d=this._edgeList.size()-1),this._edgeList.get(d)},Fo.prototype.propagateSideLabels=function(o){for(var s=ge.NONE,d=this.iterator();d.hasNext();){var _=d.next().getLabel();_.isArea(o)&&_.getLocation(o,ce.LEFT)!==ge.NONE&&(s=_.getLocation(o,ce.LEFT))}if(s===ge.NONE)return null;for(var w=s,j=this.iterator();j.hasNext();){var re=j.next(),Pe=re.getLabel();if(Pe.getLocation(o,ce.ON)===ge.NONE&&Pe.setLocation(o,ce.ON,w),Pe.isArea(o)){var tt=Pe.getLocation(o,ce.LEFT),It=Pe.getLocation(o,ce.RIGHT);if(It!==ge.NONE){if(It!==w)throw new zt("side location conflict",re.getCoordinate());tt===ge.NONE&&Pt.shouldNeverReachHere("found single null side (at "+re.getCoordinate()+")"),w=tt}else Pt.isTrue(Pe.getLocation(o,ce.LEFT)===ge.NONE,"found single null side"),Pe.setLocation(o,ce.RIGHT,w),Pe.setLocation(o,ce.LEFT,w)}}},Fo.prototype.getCoordinate=function(){var o=this.iterator();return o.hasNext()?o.next().getCoordinate():null},Fo.prototype.print=function(o){Qr.out.println("EdgeEndStar:   "+this.getCoordinate());for(var s=this.iterator();s.hasNext();)s.next().print(o)},Fo.prototype.isAreaLabelsConsistent=function(o){return this.computeEdgeEndLabels(o.getBoundaryNodeRule()),this.checkAreaLabelsConsistent(0)},Fo.prototype.checkAreaLabelsConsistent=function(o){var s=this.getEdges();if(s.size()<=0)return!0;var d=s.size()-1,_=s.get(d).getLabel().getLocation(o,ce.LEFT);Pt.isTrue(_!==ge.NONE,"Found unlabelled area edge");for(var w=_,j=this.iterator();j.hasNext();){var re=j.next().getLabel();Pt.isTrue(re.isArea(o),"Found non-area edge");var Pe=re.getLocation(o,ce.LEFT),tt=re.getLocation(o,ce.RIGHT);if(Pe===tt||tt!==w)return!1;w=Pe}return!0},Fo.prototype.findIndex=function(o){this.iterator();for(var s=0;s<this._edgeList.size();s++)if(this._edgeList.get(s)===o)return s;return-1},Fo.prototype.iterator=function(){return this.getEdges().iterator()},Fo.prototype.getEdges=function(){return this._edgeList===null&&(this._edgeList=new Gr(this._edgeMap.values())),this._edgeList},Fo.prototype.getLocation=function(o,s,d){return this._ptInAreaLocation[o]===ge.NONE&&(this._ptInAreaLocation[o]=ds.locate(s,d[o].getGeometry())),this._ptInAreaLocation[o]},Fo.prototype.toString=function(){var o=new ue;o.append("EdgeEndStar:   "+this.getCoordinate()),o.append(`
`);for(var s=this.iterator();s.hasNext();){var d=s.next();o.append(d),o.append(`
`)}return o.toString()},Fo.prototype.computeEdgeEndLabels=function(o){for(var s=this.iterator();s.hasNext();)s.next().computeLabel(o)},Fo.prototype.computeLabelling=function(o){this.computeEdgeEndLabels(o[0].getBoundaryNodeRule()),this.propagateSideLabels(0),this.propagateSideLabels(1);for(var s=[!1,!1],d=this.iterator();d.hasNext();)for(var _=d.next().getLabel(),w=0;w<2;w++)_.isLine(w)&&_.getLocation(w)===ge.BOUNDARY&&(s[w]=!0);for(var j=this.iterator();j.hasNext();)for(var re=j.next(),Pe=re.getLabel(),tt=0;tt<2;tt++)if(Pe.isAnyNull(tt)){var It=ge.NONE;if(s[tt])It=ge.EXTERIOR;else{var tr=re.getCoordinate();It=this.getLocation(tt,tr,o)}Pe.setAllLocationsIfNull(tt,It)}},Fo.prototype.getDegree=function(){return this._edgeMap.size()},Fo.prototype.insertEdgeEnd=function(o,s){this._edgeMap.put(o,s),this._edgeList=null},Fo.prototype.interfaces_=function(){return[]},Fo.prototype.getClass=function(){return Fo};var i0=function(o){function s(){o.call(this),this._resultAreaEdgeList=null,this._label=null,this._SCANNING_FOR_INCOMING=1,this._LINKING_TO_OUTGOING=2}return o&&(s.__proto__=o),s.prototype=Object.create(o&&o.prototype),s.prototype.constructor=s,s.prototype.linkResultDirectedEdges=function(){this.getResultAreaEdges();for(var d=null,_=null,w=this._SCANNING_FOR_INCOMING,j=0;j<this._resultAreaEdgeList.size();j++){var re=this._resultAreaEdgeList.get(j),Pe=re.getSym();if(re.getLabel().isArea())switch(d===null&&re.isInResult()&&(d=re),w){case this._SCANNING_FOR_INCOMING:if(!Pe.isInResult())continue;_=Pe,w=this._LINKING_TO_OUTGOING;break;case this._LINKING_TO_OUTGOING:if(!re.isInResult())continue;_.setNext(re),w=this._SCANNING_FOR_INCOMING}}if(w===this._LINKING_TO_OUTGOING){if(d===null)throw new zt("no outgoing dirEdge found",this.getCoordinate());Pt.isTrue(d.isInResult(),"unable to link last incoming dirEdge"),_.setNext(d)}},s.prototype.insert=function(d){var _=d;this.insertEdgeEnd(_,_)},s.prototype.getRightmostEdge=function(){var d=this.getEdges(),_=d.size();if(_<1)return null;var w=d.get(0);if(_===1)return w;var j=d.get(_-1),re=w.getQuadrant(),Pe=j.getQuadrant();return ua.isNorthern(re)&&ua.isNorthern(Pe)?w:ua.isNorthern(re)||ua.isNorthern(Pe)?w.getDy()!==0?w:j.getDy()!==0?j:(Pt.shouldNeverReachHere("found two horizontal edges incident on node"),null):j},s.prototype.print=function(d){Qr.out.println("DirectedEdgeStar: "+this.getCoordinate());for(var _=this.iterator();_.hasNext();){var w=_.next();d.print("out "),w.print(d),d.println(),d.print("in "),w.getSym().print(d),d.println()}},s.prototype.getResultAreaEdges=function(){if(this._resultAreaEdgeList!==null)return this._resultAreaEdgeList;this._resultAreaEdgeList=new Gr;for(var d=this.iterator();d.hasNext();){var _=d.next();(_.isInResult()||_.getSym().isInResult())&&this._resultAreaEdgeList.add(_)}return this._resultAreaEdgeList},s.prototype.updateLabelling=function(d){for(var _=this.iterator();_.hasNext();){var w=_.next().getLabel();w.setAllLocationsIfNull(0,d.getLocation(0)),w.setAllLocationsIfNull(1,d.getLocation(1))}},s.prototype.linkAllDirectedEdges=function(){this.getEdges();for(var d=null,_=null,w=this._edgeList.size()-1;w>=0;w--){var j=this._edgeList.get(w),re=j.getSym();_===null&&(_=re),d!==null&&re.setNext(d),d=j}_.setNext(d)},s.prototype.computeDepths=function(){if(arguments.length===1){var d=arguments[0],_=this.findIndex(d),w=d.getDepth(ce.LEFT),j=d.getDepth(ce.RIGHT),re=this.computeDepths(_+1,this._edgeList.size(),w);if(this.computeDepths(0,_,re)!==j)throw new zt("depth mismatch at "+d.getCoordinate())}else if(arguments.length===3){for(var Pe=arguments[0],tt=arguments[1],It=arguments[2],tr=Pe;tr<tt;tr++){var ot=this._edgeList.get(tr);ot.setEdgeDepths(ce.RIGHT,It),It=ot.getDepth(ce.LEFT)}return It}},s.prototype.mergeSymLabels=function(){for(var d=this.iterator();d.hasNext();){var _=d.next();_.getLabel().merge(_.getSym().getLabel())}},s.prototype.linkMinimalDirectedEdges=function(d){for(var _=null,w=null,j=this._SCANNING_FOR_INCOMING,re=this._resultAreaEdgeList.size()-1;re>=0;re--){var Pe=this._resultAreaEdgeList.get(re),tt=Pe.getSym();switch(_===null&&Pe.getEdgeRing()===d&&(_=Pe),j){case this._SCANNING_FOR_INCOMING:if(tt.getEdgeRing()!==d)continue;w=tt,j=this._LINKING_TO_OUTGOING;break;case this._LINKING_TO_OUTGOING:if(Pe.getEdgeRing()!==d)continue;w.setNextMin(Pe),j=this._SCANNING_FOR_INCOMING}}j===this._LINKING_TO_OUTGOING&&(Pt.isTrue(_!==null,"found null for first outgoing dirEdge"),Pt.isTrue(_.getEdgeRing()===d,"unable to link last incoming dirEdge"),w.setNextMin(_))},s.prototype.getOutgoingDegree=function(){if(arguments.length===0){for(var d=0,_=this.iterator();_.hasNext();)_.next().isInResult()&&d++;return d}if(arguments.length===1){for(var w=arguments[0],j=0,re=this.iterator();re.hasNext();)re.next().getEdgeRing()===w&&j++;return j}},s.prototype.getLabel=function(){return this._label},s.prototype.findCoveredLineEdges=function(){for(var d=ge.NONE,_=this.iterator();_.hasNext();){var w=_.next(),j=w.getSym();if(!w.isLineEdge()){if(w.isInResult()){d=ge.INTERIOR;break}if(j.isInResult()){d=ge.EXTERIOR;break}}}if(d===ge.NONE)return null;for(var re=d,Pe=this.iterator();Pe.hasNext();){var tt=Pe.next(),It=tt.getSym();tt.isLineEdge()?tt.getEdge().setCovered(re===ge.INTERIOR):(tt.isInResult()&&(re=ge.EXTERIOR),It.isInResult()&&(re=ge.INTERIOR))}},s.prototype.computeLabelling=function(d){o.prototype.computeLabelling.call(this,d),this._label=new Mn(ge.NONE);for(var _=this.iterator();_.hasNext();)for(var w=_.next().getEdge().getLabel(),j=0;j<2;j++){var re=w.getLocation(j);re!==ge.INTERIOR&&re!==ge.BOUNDARY||this._label.setLocation(j,ge.INTERIOR)}},s.prototype.interfaces_=function(){return[]},s.prototype.getClass=function(){return s},s}(Fo),tc=function(o){function s(){o.apply(this,arguments)}return o&&(s.__proto__=o),s.prototype=Object.create(o&&o.prototype),s.prototype.constructor=s,s.prototype.createNode=function(d){return new Xc(d,new i0)},s.prototype.interfaces_=function(){return[]},s.prototype.getClass=function(){return s},s}(dl),va=function o(){this._pts=null,this._orientation=null;var s=arguments[0];this._pts=s,this._orientation=o.orientation(s)};va.prototype.compareTo=function(o){var s=o;return va.compareOriented(this._pts,this._orientation,s._pts,s._orientation)},va.prototype.interfaces_=function(){return[ye]},va.prototype.getClass=function(){return va},va.orientation=function(o){return xn.increasingDirection(o)===1},va.compareOriented=function(o,s,d,_){for(var w=s?1:-1,j=_?1:-1,re=s?o.length:-1,Pe=_?d.length:-1,tt=s?0:o.length-1,It=_?0:d.length-1;;){var tr=o[tt].compareTo(d[It]);if(tr!==0)return tr;var ot=(tt+=w)===re,Zt=(It+=j)===Pe;if(ot&&!Zt)return-1;if(!ot&&Zt)return 1;if(ot&&Zt)return 0}};var Bo=function(){this._edges=new Gr,this._ocaMap=new Ie};Bo.prototype.print=function(o){o.print("MULTILINESTRING ( ");for(var s=0;s<this._edges.size();s++){var d=this._edges.get(s);s>0&&o.print(","),o.print("(");for(var _=d.getCoordinates(),w=0;w<_.length;w++)w>0&&o.print(","),o.print(_[w].x+" "+_[w].y);o.println(")")}o.print(")  ")},Bo.prototype.addAll=function(o){for(var s=o.iterator();s.hasNext();)this.add(s.next())},Bo.prototype.findEdgeIndex=function(o){for(var s=0;s<this._edges.size();s++)if(this._edges.get(s).equals(o))return s;return-1},Bo.prototype.iterator=function(){return this._edges.iterator()},Bo.prototype.getEdges=function(){return this._edges},Bo.prototype.get=function(o){return this._edges.get(o)},Bo.prototype.findEqualEdge=function(o){var s=new va(o.getCoordinates());return this._ocaMap.get(s)},Bo.prototype.add=function(o){this._edges.add(o);var s=new va(o.getCoordinates());this._ocaMap.put(s,o)},Bo.prototype.interfaces_=function(){return[]},Bo.prototype.getClass=function(){return Bo};var Ms=function(){};Ms.prototype.processIntersections=function(o,s,d,_){},Ms.prototype.isDone=function(){},Ms.prototype.interfaces_=function(){return[]},Ms.prototype.getClass=function(){return Ms};var fo=function(){this._hasIntersection=!1,this._hasProper=!1,this._hasProperInterior=!1,this._hasInterior=!1,this._properIntersectionPoint=null,this._li=null,this._isSelfIntersection=null,this.numIntersections=0,this.numInteriorIntersections=0,this.numProperIntersections=0,this.numTests=0;var o=arguments[0];this._li=o};fo.prototype.isTrivialIntersection=function(o,s,d,_){if(o===d&&this._li.getIntersectionNum()===1){if(fo.isAdjacentSegments(s,_))return!0;if(o.isClosed()){var w=o.size()-1;if(s===0&&_===w||_===0&&s===w)return!0}}return!1},fo.prototype.getProperIntersectionPoint=function(){return this._properIntersectionPoint},fo.prototype.hasProperInteriorIntersection=function(){return this._hasProperInterior},fo.prototype.getLineIntersector=function(){return this._li},fo.prototype.hasProperIntersection=function(){return this._hasProper},fo.prototype.processIntersections=function(o,s,d,_){if(o===d&&s===_)return null;this.numTests++;var w=o.getCoordinates()[s],j=o.getCoordinates()[s+1],re=d.getCoordinates()[_],Pe=d.getCoordinates()[_+1];this._li.computeIntersection(w,j,re,Pe),this._li.hasIntersection()&&(this.numIntersections++,this._li.isInteriorIntersection()&&(this.numInteriorIntersections++,this._hasInterior=!0),this.isTrivialIntersection(o,s,d,_)||(this._hasIntersection=!0,o.addIntersections(this._li,s,0),d.addIntersections(this._li,_,1),this._li.isProper()&&(this.numProperIntersections++,this._hasProper=!0,this._hasProperInterior=!0)))},fo.prototype.hasIntersection=function(){return this._hasIntersection},fo.prototype.isDone=function(){return!1},fo.prototype.hasInteriorIntersection=function(){return this._hasInterior},fo.prototype.interfaces_=function(){return[Ms]},fo.prototype.getClass=function(){return fo},fo.isAdjacentSegments=function(o,s){return Math.abs(o-s)===1};var Xo=function(){this.coord=null,this.segmentIndex=null,this.dist=null;var o=arguments[0],s=arguments[1],d=arguments[2];this.coord=new Y(o),this.segmentIndex=s,this.dist=d};Xo.prototype.getSegmentIndex=function(){return this.segmentIndex},Xo.prototype.getCoordinate=function(){return this.coord},Xo.prototype.print=function(o){o.print(this.coord),o.print(" seg # = "+this.segmentIndex),o.println(" dist = "+this.dist)},Xo.prototype.compareTo=function(o){var s=o;return this.compare(s.segmentIndex,s.dist)},Xo.prototype.isEndPoint=function(o){return this.segmentIndex===0&&this.dist===0||this.segmentIndex===o},Xo.prototype.toString=function(){return this.coord+" seg # = "+this.segmentIndex+" dist = "+this.dist},Xo.prototype.getDistance=function(){return this.dist},Xo.prototype.compare=function(o,s){return this.segmentIndex<o?-1:this.segmentIndex>o?1:this.dist<s?-1:this.dist>s?1:0},Xo.prototype.interfaces_=function(){return[ye]},Xo.prototype.getClass=function(){return Xo};var hu=function(){this._nodeMap=new Ie,this.edge=null;var o=arguments[0];this.edge=o};hu.prototype.print=function(o){o.println("Intersections:");for(var s=this.iterator();s.hasNext();)s.next().print(o)},hu.prototype.iterator=function(){return this._nodeMap.values().iterator()},hu.prototype.addSplitEdges=function(o){this.addEndpoints();for(var s=this.iterator(),d=s.next();s.hasNext();){var _=s.next(),w=this.createSplitEdge(d,_);o.add(w),d=_}},hu.prototype.addEndpoints=function(){var o=this.edge.pts.length-1;this.add(this.edge.pts[0],0,0),this.add(this.edge.pts[o],o,0)},hu.prototype.createSplitEdge=function(o,s){var d=s.segmentIndex-o.segmentIndex+2,_=this.edge.pts[s.segmentIndex],w=s.dist>0||!s.coord.equals2D(_);w||d--;var j=new Array(d).fill(null),re=0;j[re++]=new Y(o.coord);for(var Pe=o.segmentIndex+1;Pe<=s.segmentIndex;Pe++)j[re++]=this.edge.pts[Pe];return w&&(j[re]=s.coord),new kl(j,new Mn(this.edge._label))},hu.prototype.add=function(o,s,d){var _=new Xo(o,s,d),w=this._nodeMap.get(_);return w!==null?w:(this._nodeMap.put(_,_),_)},hu.prototype.isIntersection=function(o){for(var s=this.iterator();s.hasNext();)if(s.next().coord.equals(o))return!0;return!1},hu.prototype.interfaces_=function(){return[]},hu.prototype.getClass=function(){return hu};var Au=function(){};Au.prototype.getChainStartIndices=function(o){var s=0,d=new Gr;d.add(new ke(s));do{var _=this.findChainEnd(o,s);d.add(new ke(_)),s=_}while(s<o.length-1);return Au.toIntArray(d)},Au.prototype.findChainEnd=function(o,s){for(var d=ua.quadrant(o[s],o[s+1]),_=s+1;_<o.length&&ua.quadrant(o[_-1],o[_])===d;)_++;return _-1},Au.prototype.interfaces_=function(){return[]},Au.prototype.getClass=function(){return Au},Au.toIntArray=function(o){for(var s=new Array(o.size()).fill(null),d=0;d<s.length;d++)s[d]=o.get(d).intValue();return s};var zr=function(){this.e=null,this.pts=null,this.startIndex=null,this.env1=new _r,this.env2=new _r;var o=arguments[0];this.e=o,this.pts=o.getCoordinates();var s=new Au;this.startIndex=s.getChainStartIndices(this.pts)};zr.prototype.getCoordinates=function(){return this.pts},zr.prototype.getMaxX=function(o){var s=this.pts[this.startIndex[o]].x,d=this.pts[this.startIndex[o+1]].x;return s>d?s:d},zr.prototype.getMinX=function(o){var s=this.pts[this.startIndex[o]].x,d=this.pts[this.startIndex[o+1]].x;return s<d?s:d},zr.prototype.computeIntersectsForChain=function(){if(arguments.length===4){var o=arguments[0],s=arguments[1],d=arguments[2],_=arguments[3];this.computeIntersectsForChain(this.startIndex[o],this.startIndex[o+1],s,s.startIndex[d],s.startIndex[d+1],_)}else if(arguments.length===6){var w=arguments[0],j=arguments[1],re=arguments[2],Pe=arguments[3],tt=arguments[4],It=arguments[5],tr=this.pts[w],ot=this.pts[j],Zt=re.pts[Pe],Jt=re.pts[tt];if(j-w==1&&tt-Pe==1)return It.addIntersections(this.e,w,re.e,Pe),null;if(this.env1.init(tr,ot),this.env2.init(Zt,Jt),!this.env1.intersects(this.env2))return null;var gr=Math.trunc((w+j)/2),v=Math.trunc((Pe+tt)/2);w<gr&&(Pe<v&&this.computeIntersectsForChain(w,gr,re,Pe,v,It),v<tt&&this.computeIntersectsForChain(w,gr,re,v,tt,It)),gr<j&&(Pe<v&&this.computeIntersectsForChain(gr,j,re,Pe,v,It),v<tt&&this.computeIntersectsForChain(gr,j,re,v,tt,It))}},zr.prototype.getStartIndexes=function(){return this.startIndex},zr.prototype.computeIntersects=function(o,s){for(var d=0;d<this.startIndex.length-1;d++)for(var _=0;_<o.startIndex.length-1;_++)this.computeIntersectsForChain(d,o,_,s)},zr.prototype.interfaces_=function(){return[]},zr.prototype.getClass=function(){return zr};var Ja=function o(){this._depth=Array(2).fill().map(function(){return Array(3)});for(var s=0;s<2;s++)for(var d=0;d<3;d++)this._depth[s][d]=o.NULL_VALUE},mc={NULL_VALUE:{configurable:!0}};Ja.prototype.getDepth=function(o,s){return this._depth[o][s]},Ja.prototype.setDepth=function(o,s,d){this._depth[o][s]=d},Ja.prototype.isNull=function(){if(arguments.length===0){for(var o=0;o<2;o++)for(var s=0;s<3;s++)if(this._depth[o][s]!==Ja.NULL_VALUE)return!1;return!0}if(arguments.length===1){var d=arguments[0];return this._depth[d][1]===Ja.NULL_VALUE}if(arguments.length===2){var _=arguments[0],w=arguments[1];return this._depth[_][w]===Ja.NULL_VALUE}},Ja.prototype.normalize=function(){for(var o=0;o<2;o++)if(!this.isNull(o)){var s=this._depth[o][1];this._depth[o][2]<s&&(s=this._depth[o][2]),s<0&&(s=0);for(var d=1;d<3;d++){var _=0;this._depth[o][d]>s&&(_=1),this._depth[o][d]=_}}},Ja.prototype.getDelta=function(o){return this._depth[o][ce.RIGHT]-this._depth[o][ce.LEFT]},Ja.prototype.getLocation=function(o,s){return this._depth[o][s]<=0?ge.EXTERIOR:ge.INTERIOR},Ja.prototype.toString=function(){return"A: "+this._depth[0][1]+","+this._depth[0][2]+" B: "+this._depth[1][1]+","+this._depth[1][2]},Ja.prototype.add=function(){if(arguments.length===1)for(var o=arguments[0],s=0;s<2;s++)for(var d=1;d<3;d++){var _=o.getLocation(s,d);_!==ge.EXTERIOR&&_!==ge.INTERIOR||(this.isNull(s,d)?this._depth[s][d]=Ja.depthAtLocation(_):this._depth[s][d]+=Ja.depthAtLocation(_))}else if(arguments.length===3){var w=arguments[0],j=arguments[1];arguments[2]===ge.INTERIOR&&this._depth[w][j]++}},Ja.prototype.interfaces_=function(){return[]},Ja.prototype.getClass=function(){return Ja},Ja.depthAtLocation=function(o){return o===ge.EXTERIOR?0:o===ge.INTERIOR?1:Ja.NULL_VALUE},mc.NULL_VALUE.get=function(){return-1},Object.defineProperties(Ja,mc);var kl=function(o){function s(){if(o.call(this),this.pts=null,this._env=null,this.eiList=new hu(this),this._name=null,this._mce=null,this._isIsolated=!0,this._depth=new Ja,this._depthDelta=0,arguments.length===1){var d=arguments[0];s.call(this,d,null)}else if(arguments.length===2){var _=arguments[0],w=arguments[1];this.pts=_,this._label=w}}return o&&(s.__proto__=o),s.prototype=Object.create(o&&o.prototype),s.prototype.constructor=s,s.prototype.getDepth=function(){return this._depth},s.prototype.getCollapsedEdge=function(){var d=new Array(2).fill(null);return d[0]=this.pts[0],d[1]=this.pts[1],new s(d,Mn.toLineLabel(this._label))},s.prototype.isIsolated=function(){return this._isIsolated},s.prototype.getCoordinates=function(){return this.pts},s.prototype.setIsolated=function(d){this._isIsolated=d},s.prototype.setName=function(d){this._name=d},s.prototype.equals=function(d){if(!(d instanceof s))return!1;var _=d;if(this.pts.length!==_.pts.length)return!1;for(var w=!0,j=!0,re=this.pts.length,Pe=0;Pe<this.pts.length;Pe++)if(this.pts[Pe].equals2D(_.pts[Pe])||(w=!1),this.pts[Pe].equals2D(_.pts[--re])||(j=!1),!w&&!j)return!1;return!0},s.prototype.getCoordinate=function(){if(arguments.length===0)return this.pts.length>0?this.pts[0]:null;if(arguments.length===1){var d=arguments[0];return this.pts[d]}},s.prototype.print=function(d){d.print("edge "+this._name+": "),d.print("LINESTRING (");for(var _=0;_<this.pts.length;_++)_>0&&d.print(","),d.print(this.pts[_].x+" "+this.pts[_].y);d.print(")  "+this._label+" "+this._depthDelta)},s.prototype.computeIM=function(d){s.updateIM(this._label,d)},s.prototype.isCollapsed=function(){return!!this._label.isArea()&&this.pts.length===3&&!!this.pts[0].equals(this.pts[2])},s.prototype.isClosed=function(){return this.pts[0].equals(this.pts[this.pts.length-1])},s.prototype.getMaximumSegmentIndex=function(){return this.pts.length-1},s.prototype.getDepthDelta=function(){return this._depthDelta},s.prototype.getNumPoints=function(){return this.pts.length},s.prototype.printReverse=function(d){d.print("edge "+this._name+": ");for(var _=this.pts.length-1;_>=0;_--)d.print(this.pts[_]+" ");d.println("")},s.prototype.getMonotoneChainEdge=function(){return this._mce===null&&(this._mce=new zr(this)),this._mce},s.prototype.getEnvelope=function(){if(this._env===null){this._env=new _r;for(var d=0;d<this.pts.length;d++)this._env.expandToInclude(this.pts[d])}return this._env},s.prototype.addIntersection=function(d,_,w,j){var re=new Y(d.getIntersection(j)),Pe=_,tt=d.getEdgeDistance(w,j),It=Pe+1;if(It<this.pts.length){var tr=this.pts[It];re.equals2D(tr)&&(Pe=It,tt=0)}this.eiList.add(re,Pe,tt)},s.prototype.toString=function(){var d=new ue;d.append("edge "+this._name+": "),d.append("LINESTRING (");for(var _=0;_<this.pts.length;_++)_>0&&d.append(","),d.append(this.pts[_].x+" "+this.pts[_].y);return d.append(")  "+this._label+" "+this._depthDelta),d.toString()},s.prototype.isPointwiseEqual=function(d){if(this.pts.length!==d.pts.length)return!1;for(var _=0;_<this.pts.length;_++)if(!this.pts[_].equals2D(d.pts[_]))return!1;return!0},s.prototype.setDepthDelta=function(d){this._depthDelta=d},s.prototype.getEdgeIntersectionList=function(){return this.eiList},s.prototype.addIntersections=function(d,_,w){for(var j=0;j<d.getIntersectionNum();j++)this.addIntersection(d,_,w,j)},s.prototype.interfaces_=function(){return[]},s.prototype.getClass=function(){return s},s.updateIM=function(){if(arguments.length!==2)return o.prototype.updateIM.apply(this,arguments);var d=arguments[0],_=arguments[1];_.setAtLeastIfValid(d.getLocation(0,ce.ON),d.getLocation(1,ce.ON),1),d.isArea()&&(_.setAtLeastIfValid(d.getLocation(0,ce.LEFT),d.getLocation(1,ce.LEFT),2),_.setAtLeastIfValid(d.getLocation(0,ce.RIGHT),d.getLocation(1,ce.RIGHT),2))},s}(ws),yo=function(o){this._workingPrecisionModel=null,this._workingNoder=null,this._geomFact=null,this._graph=null,this._edgeList=new Bo,this._bufParams=o||null};yo.prototype.setWorkingPrecisionModel=function(o){this._workingPrecisionModel=o},yo.prototype.insertUniqueEdge=function(o){var s=this._edgeList.findEqualEdge(o);if(s!==null){var d=s.getLabel(),_=o.getLabel();s.isPointwiseEqual(o)||(_=new Mn(o.getLabel())).flip(),d.merge(_);var w=yo.depthDelta(_),j=s.getDepthDelta()+w;s.setDepthDelta(j)}else this._edgeList.add(o),o.setDepthDelta(yo.depthDelta(o.getLabel()))},yo.prototype.buildSubgraphs=function(o,s){for(var d=new Gr,_=o.iterator();_.hasNext();){var w=_.next(),j=w.getRightmostCoordinate(),re=new ps(d).getDepth(j);w.computeDepth(re),w.findResultEdges(),d.add(w),s.add(w.getDirectedEdges(),w.getNodes())}},yo.prototype.createSubgraphs=function(o){for(var s=new Gr,d=o.getNodes().iterator();d.hasNext();){var _=d.next();if(!_.isVisited()){var w=new Lr;w.create(_),s.add(w)}}return Ha.sort(s,Ha.reverseOrder()),s},yo.prototype.createEmptyResultGeometry=function(){return this._geomFact.createPolygon()},yo.prototype.getNoder=function(o){if(this._workingNoder!==null)return this._workingNoder;var s=new gc,d=new $e;return d.setPrecisionModel(o),s.setSegmentIntersector(new fo(d)),s},yo.prototype.buffer=function(o,s){var d=this._workingPrecisionModel;d===null&&(d=o.getPrecisionModel()),this._geomFact=o.getFactory();var _=new _a(d,this._bufParams),w=new ss(o,s,_).getCurves();if(w.size()<=0)return this.createEmptyResultGeometry();this.computeNodedEdges(w,d),this._graph=new wa(new tc),this._graph.addEdges(this._edgeList.getEdges());var j=this.createSubgraphs(this._graph),re=new In(this._geomFact);this.buildSubgraphs(j,re);var Pe=re.getPolygons();return Pe.size()<=0?this.createEmptyResultGeometry():this._geomFact.buildGeometry(Pe)},yo.prototype.computeNodedEdges=function(o,s){var d=this.getNoder(s);d.computeNodes(o);for(var _=d.getNodedSubstrings().iterator();_.hasNext();){var w=_.next(),j=w.getCoordinates();if(j.length!==2||!j[0].equals2D(j[1])){var re=w.getData(),Pe=new kl(w.getCoordinates(),new Mn(re));this.insertUniqueEdge(Pe)}}},yo.prototype.setNoder=function(o){this._workingNoder=o},yo.prototype.interfaces_=function(){return[]},yo.prototype.getClass=function(){return yo},yo.depthDelta=function(o){var s=o.getLocation(0,ce.LEFT),d=o.getLocation(0,ce.RIGHT);return s===ge.INTERIOR&&d===ge.EXTERIOR?1:s===ge.EXTERIOR&&d===ge.INTERIOR?-1:0},yo.convertSegStrings=function(o){for(var s=new Ai,d=new Gr;o.hasNext();){var _=o.next(),w=s.createLineString(_.getCoordinates());d.add(w)}return s.buildGeometry(d)};var Nu=function(){if(this._noder=null,this._scaleFactor=null,this._offsetX=null,this._offsetY=null,this._isScaled=!1,arguments.length===2){var o=arguments[0],s=arguments[1];this._noder=o,this._scaleFactor=s,this._offsetX=0,this._offsetY=0,this._isScaled=!this.isIntegerPrecision()}else if(arguments.length===4){var d=arguments[0],_=arguments[1],w=arguments[2],j=arguments[3];this._noder=d,this._scaleFactor=_,this._offsetX=w,this._offsetY=j,this._isScaled=!this.isIntegerPrecision()}};Nu.prototype.rescale=function(){if(Me(arguments[0],li))for(var o=arguments[0].iterator();o.hasNext();){var s=o.next();this.rescale(s.getCoordinates())}else if(arguments[0]instanceof Array){for(var d=arguments[0],_=0;_<d.length;_++)d[_].x=d[_].x/this._scaleFactor+this._offsetX,d[_].y=d[_].y/this._scaleFactor+this._offsetY;d.length===2&&d[0].equals2D(d[1])&&Qr.out.println(d)}},Nu.prototype.scale=function(){if(Me(arguments[0],li)){for(var o=arguments[0],s=new Gr,d=o.iterator();d.hasNext();){var _=d.next();s.add(new Ta(this.scale(_.getCoordinates()),_.getData()))}return s}if(arguments[0]instanceof Array){for(var w=arguments[0],j=new Array(w.length).fill(null),re=0;re<w.length;re++)j[re]=new Y(Math.round((w[re].x-this._offsetX)*this._scaleFactor),Math.round((w[re].y-this._offsetY)*this._scaleFactor),w[re].z);return xn.removeRepeatedPoints(j)}},Nu.prototype.isIntegerPrecision=function(){return this._scaleFactor===1},Nu.prototype.getNodedSubstrings=function(){var o=this._noder.getNodedSubstrings();return this._isScaled&&this.rescale(o),o},Nu.prototype.computeNodes=function(o){var s=o;this._isScaled&&(s=this.scale(o)),this._noder.computeNodes(s)},Nu.prototype.interfaces_=function(){return[gl]},Nu.prototype.getClass=function(){return Nu};var Eu=function(){this._li=new $e,this._segStrings=null;var o=arguments[0];this._segStrings=o},qc={fact:{configurable:!0}};Eu.prototype.checkEndPtVertexIntersections=function(){if(arguments.length===0)for(var o=this._segStrings.iterator();o.hasNext();){var s=o.next().getCoordinates();this.checkEndPtVertexIntersections(s[0],this._segStrings),this.checkEndPtVertexIntersections(s[s.length-1],this._segStrings)}else if(arguments.length===2){for(var d=arguments[0],_=arguments[1].iterator();_.hasNext();)for(var w=_.next().getCoordinates(),j=1;j<w.length-1;j++)if(w[j].equals(d))throw new Di("found endpt/interior pt intersection at index "+j+" :pt "+d)}},Eu.prototype.checkInteriorIntersections=function(){if(arguments.length===0)for(var o=this._segStrings.iterator();o.hasNext();)for(var s=o.next(),d=this._segStrings.iterator();d.hasNext();){var _=d.next();this.checkInteriorIntersections(s,_)}else if(arguments.length===2)for(var w=arguments[0],j=arguments[1],re=w.getCoordinates(),Pe=j.getCoordinates(),tt=0;tt<re.length-1;tt++)for(var It=0;It<Pe.length-1;It++)this.checkInteriorIntersections(w,tt,j,It);else if(arguments.length===4){var tr=arguments[0],ot=arguments[1],Zt=arguments[2],Jt=arguments[3];if(tr===Zt&&ot===Jt)return null;var gr=tr.getCoordinates()[ot],v=tr.getCoordinates()[ot+1],Ln=Zt.getCoordinates()[Jt],jn=Zt.getCoordinates()[Jt+1];if(this._li.computeIntersection(gr,v,Ln,jn),this._li.hasIntersection()&&(this._li.isProper()||this.hasInteriorIntersection(this._li,gr,v)||this.hasInteriorIntersection(this._li,Ln,jn)))throw new Di("found non-noded intersection at "+gr+"-"+v+" and "+Ln+"-"+jn)}},Eu.prototype.checkValid=function(){this.checkEndPtVertexIntersections(),this.checkInteriorIntersections(),this.checkCollapses()},Eu.prototype.checkCollapses=function(){if(arguments.length===0)for(var o=this._segStrings.iterator();o.hasNext();){var s=o.next();this.checkCollapses(s)}else if(arguments.length===1)for(var d=arguments[0].getCoordinates(),_=0;_<d.length-2;_++)this.checkCollapse(d[_],d[_+1],d[_+2])},Eu.prototype.hasInteriorIntersection=function(o,s,d){for(var _=0;_<o.getIntersectionNum();_++){var w=o.getIntersection(_);if(!w.equals(s)&&!w.equals(d))return!0}return!1},Eu.prototype.checkCollapse=function(o,s,d){if(o.equals(d))throw new Di("found non-noded collapse at "+Eu.fact.createLineString([o,s,d]))},Eu.prototype.interfaces_=function(){return[]},Eu.prototype.getClass=function(){return Eu},qc.fact.get=function(){return new Ai},Object.defineProperties(Eu,qc);var vs=function(){this._li=null,this._pt=null,this._originalPt=null,this._ptScaled=null,this._p0Scaled=null,this._p1Scaled=null,this._scaleFactor=null,this._minx=null,this._maxx=null,this._miny=null,this._maxy=null,this._corner=new Array(4).fill(null),this._safeEnv=null;var o=arguments[0],s=arguments[1],d=arguments[2];if(this._originalPt=o,this._pt=o,this._scaleFactor=s,this._li=d,s<=0)throw new Te("Scale factor must be non-zero");s!==1&&(this._pt=new Y(this.scale(o.x),this.scale(o.y)),this._p0Scaled=new Y,this._p1Scaled=new Y),this.initCorners(this._pt)},Is={SAFE_ENV_EXPANSION_FACTOR:{configurable:!0}};vs.prototype.intersectsScaled=function(o,s){var d=Math.min(o.x,s.x),_=Math.max(o.x,s.x),w=Math.min(o.y,s.y),j=Math.max(o.y,s.y),re=this._maxx<d||this._minx>_||this._maxy<w||this._miny>j;if(re)return!1;var Pe=this.intersectsToleranceSquare(o,s);return Pt.isTrue(!(re&&Pe),"Found bad envelope test"),Pe},vs.prototype.initCorners=function(o){this._minx=o.x-.5,this._maxx=o.x+.5,this._miny=o.y-.5,this._maxy=o.y+.5,this._corner[0]=new Y(this._maxx,this._maxy),this._corner[1]=new Y(this._minx,this._maxy),this._corner[2]=new Y(this._minx,this._miny),this._corner[3]=new Y(this._maxx,this._miny)},vs.prototype.intersects=function(o,s){return this._scaleFactor===1?this.intersectsScaled(o,s):(this.copyScaled(o,this._p0Scaled),this.copyScaled(s,this._p1Scaled),this.intersectsScaled(this._p0Scaled,this._p1Scaled))},vs.prototype.scale=function(o){return Math.round(o*this._scaleFactor)},vs.prototype.getCoordinate=function(){return this._originalPt},vs.prototype.copyScaled=function(o,s){s.x=this.scale(o.x),s.y=this.scale(o.y)},vs.prototype.getSafeEnvelope=function(){if(this._safeEnv===null){var o=vs.SAFE_ENV_EXPANSION_FACTOR/this._scaleFactor;this._safeEnv=new _r(this._originalPt.x-o,this._originalPt.x+o,this._originalPt.y-o,this._originalPt.y+o)}return this._safeEnv},vs.prototype.intersectsPixelClosure=function(o,s){return this._li.computeIntersection(o,s,this._corner[0],this._corner[1]),!!this._li.hasIntersection()||(this._li.computeIntersection(o,s,this._corner[1],this._corner[2]),!!this._li.hasIntersection()||(this._li.computeIntersection(o,s,this._corner[2],this._corner[3]),!!this._li.hasIntersection()||(this._li.computeIntersection(o,s,this._corner[3],this._corner[0]),!!this._li.hasIntersection())))},vs.prototype.intersectsToleranceSquare=function(o,s){var d=!1,_=!1;return this._li.computeIntersection(o,s,this._corner[0],this._corner[1]),!!this._li.isProper()||(this._li.computeIntersection(o,s,this._corner[1],this._corner[2]),!!this._li.isProper()||(this._li.hasIntersection()&&(d=!0),this._li.computeIntersection(o,s,this._corner[2],this._corner[3]),!!this._li.isProper()||(this._li.hasIntersection()&&(_=!0),this._li.computeIntersection(o,s,this._corner[3],this._corner[0]),!!this._li.isProper()||!(!d||!_)||!!o.equals(this._pt)||!!s.equals(this._pt))))},vs.prototype.addSnappedNode=function(o,s){var d=o.getCoordinate(s),_=o.getCoordinate(s+1);return!!this.intersects(d,_)&&(o.addIntersection(this.getCoordinate(),s),!0)},vs.prototype.interfaces_=function(){return[]},vs.prototype.getClass=function(){return vs},Is.SAFE_ENV_EXPANSION_FACTOR.get=function(){return .75},Object.defineProperties(vs,Is);var Dl=function(){this.tempEnv1=new _r,this.selectedSegment=new Sn};Dl.prototype.select=function(){if(arguments.length!==1){if(arguments.length===2){var o=arguments[0],s=arguments[1];o.getLineSegment(s,this.selectedSegment),this.select(this.selectedSegment)}}},Dl.prototype.interfaces_=function(){return[]},Dl.prototype.getClass=function(){return Dl};var el=function(){this._index=null;var o=arguments[0];this._index=o},Kc={HotPixelSnapAction:{configurable:!0}};el.prototype.snap=function(){if(arguments.length===1){var o=arguments[0];return this.snap(o,null,-1)}if(arguments.length===3){var s=arguments[0],d=arguments[1],_=arguments[2],w=s.getSafeEnvelope(),j=new Df(s,d,_);return this._index.query(w,{interfaces_:function(){return[cu]},visitItem:function(re){re.select(w,j)}}),j.isNodeAdded()}},el.prototype.interfaces_=function(){return[]},el.prototype.getClass=function(){return el},Kc.HotPixelSnapAction.get=function(){return Df},Object.defineProperties(el,Kc);var Df=function(o){function s(){o.call(this),this._hotPixel=null,this._parentEdge=null,this._hotPixelVertexIndex=null,this._isNodeAdded=!1;var d=arguments[0],_=arguments[1],w=arguments[2];this._hotPixel=d,this._parentEdge=_,this._hotPixelVertexIndex=w}return o&&(s.__proto__=o),s.prototype=Object.create(o&&o.prototype),s.prototype.constructor=s,s.prototype.isNodeAdded=function(){return this._isNodeAdded},s.prototype.select=function(){if(arguments.length!==2)return o.prototype.select.apply(this,arguments);var d=arguments[0],_=arguments[1],w=d.getContext();if(this._parentEdge!==null&&w===this._parentEdge&&_===this._hotPixelVertexIndex)return null;this._isNodeAdded=this._hotPixel.addSnappedNode(w,_)},s.prototype.interfaces_=function(){return[]},s.prototype.getClass=function(){return s},s}(Dl),yl=function(){this._li=null,this._interiorIntersections=null;var o=arguments[0];this._li=o,this._interiorIntersections=new Gr};yl.prototype.processIntersections=function(o,s,d,_){if(o===d&&s===_)return null;var w=o.getCoordinates()[s],j=o.getCoordinates()[s+1],re=d.getCoordinates()[_],Pe=d.getCoordinates()[_+1];if(this._li.computeIntersection(w,j,re,Pe),this._li.hasIntersection()&&this._li.isInteriorIntersection()){for(var tt=0;tt<this._li.getIntersectionNum();tt++)this._interiorIntersections.add(this._li.getIntersection(tt));o.addIntersections(this._li,s,0),d.addIntersections(this._li,_,1)}},yl.prototype.isDone=function(){return!1},yl.prototype.getInteriorIntersections=function(){return this._interiorIntersections},yl.prototype.interfaces_=function(){return[Ms]},yl.prototype.getClass=function(){return yl};var bu=function(){this._pm=null,this._li=null,this._scaleFactor=null,this._noder=null,this._pointSnapper=null,this._nodedSegStrings=null;var o=arguments[0];this._pm=o,this._li=new $e,this._li.setPrecisionModel(o),this._scaleFactor=o.getScale()};bu.prototype.checkCorrectness=function(o){var s=Ta.getNodedSubstrings(o),d=new Eu(s);try{d.checkValid()}catch(_){if(!(_ instanceof ln))throw _;_.printStackTrace()}},bu.prototype.getNodedSubstrings=function(){return Ta.getNodedSubstrings(this._nodedSegStrings)},bu.prototype.snapRound=function(o,s){var d=this.findInteriorIntersections(o,s);this.computeIntersectionSnaps(d),this.computeVertexSnaps(o)},bu.prototype.findInteriorIntersections=function(o,s){var d=new yl(s);return this._noder.setSegmentIntersector(d),this._noder.computeNodes(o),d.getInteriorIntersections()},bu.prototype.computeVertexSnaps=function(){if(Me(arguments[0],li))for(var o=arguments[0].iterator();o.hasNext();){var s=o.next();this.computeVertexSnaps(s)}else if(arguments[0]instanceof Ta)for(var d=arguments[0],_=d.getCoordinates(),w=0;w<_.length;w++){var j=new vs(_[w],this._scaleFactor,this._li);this._pointSnapper.snap(j,d,w)&&d.addIntersection(_[w],w)}},bu.prototype.computeNodes=function(o){this._nodedSegStrings=o,this._noder=new gc,this._pointSnapper=new el(this._noder.getIndex()),this.snapRound(o,this._li)},bu.prototype.computeIntersectionSnaps=function(o){for(var s=o.iterator();s.hasNext();){var d=s.next(),_=new vs(d,this._scaleFactor,this._li);this._pointSnapper.snap(_)}},bu.prototype.interfaces_=function(){return[gl]},bu.prototype.getClass=function(){return bu};var wo=function(){if(this._argGeom=null,this._distance=null,this._bufParams=new ea,this._resultGeometry=null,this._saveException=null,arguments.length===1){var o=arguments[0];this._argGeom=o}else if(arguments.length===2){var s=arguments[0],d=arguments[1];this._argGeom=s,this._bufParams=d}},_l={CAP_ROUND:{configurable:!0},CAP_BUTT:{configurable:!0},CAP_FLAT:{configurable:!0},CAP_SQUARE:{configurable:!0},MAX_PRECISION_DIGITS:{configurable:!0}};wo.prototype.bufferFixedPrecision=function(o){var s=new Nu(new bu(new zi(1)),o.getScale()),d=new yo(this._bufParams);d.setWorkingPrecisionModel(o),d.setNoder(s),this._resultGeometry=d.buffer(this._argGeom,this._distance)},wo.prototype.bufferReducedPrecision=function(){var o=this;if(arguments.length===0){for(var s=wo.MAX_PRECISION_DIGITS;s>=0;s--){try{o.bufferReducedPrecision(s)}catch(j){if(!(j instanceof zt))throw j;o._saveException=j}if(o._resultGeometry!==null)return null}throw this._saveException}if(arguments.length===1){var d=arguments[0],_=wo.precisionScaleFactor(this._argGeom,this._distance,d),w=new zi(_);this.bufferFixedPrecision(w)}},wo.prototype.computeGeometry=function(){if(this.bufferOriginalPrecision(),this._resultGeometry!==null)return null;var o=this._argGeom.getFactory().getPrecisionModel();o.getType()===zi.FIXED?this.bufferFixedPrecision(o):this.bufferReducedPrecision()},wo.prototype.setQuadrantSegments=function(o){this._bufParams.setQuadrantSegments(o)},wo.prototype.bufferOriginalPrecision=function(){try{var o=new yo(this._bufParams);this._resultGeometry=o.buffer(this._argGeom,this._distance)}catch(s){if(!(s instanceof Di))throw s;this._saveException=s}},wo.prototype.getResultGeometry=function(o){return this._distance=o,this.computeGeometry(),this._resultGeometry},wo.prototype.setEndCapStyle=function(o){this._bufParams.setEndCapStyle(o)},wo.prototype.interfaces_=function(){return[]},wo.prototype.getClass=function(){return wo},wo.bufferOp=function(){if(arguments.length===2){var o=arguments[0],s=arguments[1];return new wo(o).getResultGeometry(s)}if(arguments.length===3){if(Number.isInteger(arguments[2])&&arguments[0]instanceof Tt&&typeof arguments[1]=="number"){var d=arguments[0],_=arguments[1],w=arguments[2],j=new wo(d);return j.setQuadrantSegments(w),j.getResultGeometry(_)}if(arguments[2]instanceof ea&&arguments[0]instanceof Tt&&typeof arguments[1]=="number"){var re=arguments[0],Pe=arguments[1],tt=arguments[2];return new wo(re,tt).getResultGeometry(Pe)}}else if(arguments.length===4){var It=arguments[0],tr=arguments[1],ot=arguments[2],Zt=arguments[3],Jt=new wo(It);return Jt.setQuadrantSegments(ot),Jt.setEndCapStyle(Zt),Jt.getResultGeometry(tr)}},wo.precisionScaleFactor=function(o,s,d){var _=o.getEnvelopeInternal(),w=Ae.max(Math.abs(_.getMaxX()),Math.abs(_.getMaxY()),Math.abs(_.getMinX()),Math.abs(_.getMinY()))+2*(s>0?s:0),j=d-Math.trunc(Math.log(w)/Math.log(10)+1);return Math.pow(10,j)},_l.CAP_ROUND.get=function(){return ea.CAP_ROUND},_l.CAP_BUTT.get=function(){return ea.CAP_FLAT},_l.CAP_FLAT.get=function(){return ea.CAP_FLAT},_l.CAP_SQUARE.get=function(){return ea.CAP_SQUARE},_l.MAX_PRECISION_DIGITS.get=function(){return 12},Object.defineProperties(wo,_l);var Zo=function(){this._pt=[new Y,new Y],this._distance=le.NaN,this._isNull=!0};Zo.prototype.getCoordinates=function(){return this._pt},Zo.prototype.getCoordinate=function(o){return this._pt[o]},Zo.prototype.setMinimum=function(){if(arguments.length===1){var o=arguments[0];this.setMinimum(o._pt[0],o._pt[1])}else if(arguments.length===2){var s=arguments[0],d=arguments[1];if(this._isNull)return this.initialize(s,d),null;var _=s.distance(d);_<this._distance&&this.initialize(s,d,_)}},Zo.prototype.initialize=function(){if(arguments.length===0)this._isNull=!0;else if(arguments.length===2){var o=arguments[0],s=arguments[1];this._pt[0].setCoordinate(o),this._pt[1].setCoordinate(s),this._distance=o.distance(s),this._isNull=!1}else if(arguments.length===3){var d=arguments[0],_=arguments[1],w=arguments[2];this._pt[0].setCoordinate(d),this._pt[1].setCoordinate(_),this._distance=w,this._isNull=!1}},Zo.prototype.getDistance=function(){return this._distance},Zo.prototype.setMaximum=function(){if(arguments.length===1){var o=arguments[0];this.setMaximum(o._pt[0],o._pt[1])}else if(arguments.length===2){var s=arguments[0],d=arguments[1];if(this._isNull)return this.initialize(s,d),null;var _=s.distance(d);_>this._distance&&this.initialize(s,d,_)}},Zo.prototype.interfaces_=function(){return[]},Zo.prototype.getClass=function(){return Zo};var Su=function(){};Su.prototype.interfaces_=function(){return[]},Su.prototype.getClass=function(){return Su},Su.computeDistance=function(){if(arguments[2]instanceof Zo&&arguments[0]instanceof ya&&arguments[1]instanceof Y)for(var o=arguments[0],s=arguments[1],d=arguments[2],_=o.getCoordinates(),w=new Sn,j=0;j<_.length-1;j++){w.setCoordinates(_[j],_[j+1]);var re=w.closestPoint(s);d.setMinimum(re,s)}else if(arguments[2]instanceof Zo&&arguments[0]instanceof Ca&&arguments[1]instanceof Y){var Pe=arguments[0],tt=arguments[1],It=arguments[2];Su.computeDistance(Pe.getExteriorRing(),tt,It);for(var tr=0;tr<Pe.getNumInteriorRing();tr++)Su.computeDistance(Pe.getInteriorRingN(tr),tt,It)}else if(arguments[2]instanceof Zo&&arguments[0]instanceof Tt&&arguments[1]instanceof Y){var ot=arguments[0],Zt=arguments[1],Jt=arguments[2];if(ot instanceof ya)Su.computeDistance(ot,Zt,Jt);else if(ot instanceof Ca)Su.computeDistance(ot,Zt,Jt);else if(ot instanceof Oo)for(var gr=ot,v=0;v<gr.getNumGeometries();v++){var Ln=gr.getGeometryN(v);Su.computeDistance(Ln,Zt,Jt)}else Jt.setMinimum(ot.getCoordinate(),Zt)}else if(arguments[2]instanceof Zo&&arguments[0]instanceof Sn&&arguments[1]instanceof Y){var jn=arguments[0],Xe=arguments[1],Ma=arguments[2],ao=jn.closestPoint(Xe);Ma.setMinimum(ao,Xe)}};var Fu=function(o){this._maxPtDist=new Zo,this._inputGeom=o||null},Jc={MaxPointDistanceFilter:{configurable:!0},MaxMidpointDistanceFilter:{configurable:!0}};Fu.prototype.computeMaxMidpointDistance=function(o){var s=new Bu(this._inputGeom);o.apply(s),this._maxPtDist.setMaximum(s.getMaxPointDistance())},Fu.prototype.computeMaxVertexDistance=function(o){var s=new xl(this._inputGeom);o.apply(s),this._maxPtDist.setMaximum(s.getMaxPointDistance())},Fu.prototype.findDistance=function(o){return this.computeMaxVertexDistance(o),this.computeMaxMidpointDistance(o),this._maxPtDist.getDistance()},Fu.prototype.getDistancePoints=function(){return this._maxPtDist},Fu.prototype.interfaces_=function(){return[]},Fu.prototype.getClass=function(){return Fu},Jc.MaxPointDistanceFilter.get=function(){return xl},Jc.MaxMidpointDistanceFilter.get=function(){return Bu},Object.defineProperties(Fu,Jc);var xl=function(o){this._maxPtDist=new Zo,this._minPtDist=new Zo,this._geom=o||null};xl.prototype.filter=function(o){this._minPtDist.initialize(),Su.computeDistance(this._geom,o,this._minPtDist),this._maxPtDist.setMaximum(this._minPtDist)},xl.prototype.getMaxPointDistance=function(){return this._maxPtDist},xl.prototype.interfaces_=function(){return[kr]},xl.prototype.getClass=function(){return xl};var Bu=function(o){this._maxPtDist=new Zo,this._minPtDist=new Zo,this._geom=o||null};Bu.prototype.filter=function(o,s){if(s===0)return null;var d=o.getCoordinate(s-1),_=o.getCoordinate(s),w=new Y((d.x+_.x)/2,(d.y+_.y)/2);this._minPtDist.initialize(),Su.computeDistance(this._geom,w,this._minPtDist),this._maxPtDist.setMaximum(this._minPtDist)},Bu.prototype.isDone=function(){return!1},Bu.prototype.isGeometryChanged=function(){return!1},Bu.prototype.getMaxPointDistance=function(){return this._maxPtDist},Bu.prototype.interfaces_=function(){return[ts]},Bu.prototype.getClass=function(){return Bu};var pu=function(o){this._comps=o||null};pu.prototype.filter=function(o){o instanceof Ca&&this._comps.add(o)},pu.prototype.interfaces_=function(){return[no]},pu.prototype.getClass=function(){return pu},pu.getPolygons=function(){if(arguments.length===1){var o=arguments[0];return pu.getPolygons(o,new Gr)}if(arguments.length===2){var s=arguments[0],d=arguments[1];return s instanceof Ca?d.add(s):s instanceof Oo&&s.apply(new pu(d)),d}};var _o=function(){if(this._lines=null,this._isForcedToLineString=!1,arguments.length===1){var o=arguments[0];this._lines=o}else if(arguments.length===2){var s=arguments[0],d=arguments[1];this._lines=s,this._isForcedToLineString=d}};_o.prototype.filter=function(o){if(this._isForcedToLineString&&o instanceof Mr){var s=o.getFactory().createLineString(o.getCoordinateSequence());return this._lines.add(s),null}o instanceof ya&&this._lines.add(o)},_o.prototype.setForceToLineString=function(o){this._isForcedToLineString=o},_o.prototype.interfaces_=function(){return[vt]},_o.prototype.getClass=function(){return _o},_o.getGeometry=function(){if(arguments.length===1){var o=arguments[0];return o.getFactory().buildGeometry(_o.getLines(o))}if(arguments.length===2){var s=arguments[0],d=arguments[1];return s.getFactory().buildGeometry(_o.getLines(s,d))}},_o.getLines=function(){if(arguments.length===1){var o=arguments[0];return _o.getLines(o,!1)}if(arguments.length===2){if(Me(arguments[0],li)&&Me(arguments[1],li)){for(var s=arguments[0],d=arguments[1],_=s.iterator();_.hasNext();){var w=_.next();_o.getLines(w,d)}return d}if(arguments[0]instanceof Tt&&typeof arguments[1]=="boolean"){var j=arguments[0],re=arguments[1],Pe=new Gr;return j.apply(new _o(Pe,re)),Pe}if(arguments[0]instanceof Tt&&Me(arguments[1],li)){var tt=arguments[0],It=arguments[1];return tt instanceof ya?It.add(tt):tt.apply(new _o(It)),It}}else if(arguments.length===3){if(typeof arguments[2]=="boolean"&&Me(arguments[0],li)&&Me(arguments[1],li)){for(var tr=arguments[0],ot=arguments[1],Zt=arguments[2],Jt=tr.iterator();Jt.hasNext();){var gr=Jt.next();_o.getLines(gr,ot,Zt)}return ot}if(typeof arguments[2]=="boolean"&&arguments[0]instanceof Tt&&Me(arguments[1],li)){var v=arguments[0],Ln=arguments[1],jn=arguments[2];return v.apply(new _o(Ln,jn)),Ln}}};var Cu=function(){if(this._boundaryRule=Wr.OGC_SFS_BOUNDARY_RULE,this._isIn=null,this._numBoundaries=null,arguments.length!==0){if(arguments.length===1){var o=arguments[0];if(o===null)throw new Te("Rule must be non-null");this._boundaryRule=o}}};Cu.prototype.locateInternal=function(){if(arguments[0]instanceof Y&&arguments[1]instanceof Ca){var o=arguments[0],s=arguments[1];if(s.isEmpty())return ge.EXTERIOR;var d=s.getExteriorRing(),_=this.locateInPolygonRing(o,d);if(_===ge.EXTERIOR)return ge.EXTERIOR;if(_===ge.BOUNDARY)return ge.BOUNDARY;for(var w=0;w<s.getNumInteriorRing();w++){var j=s.getInteriorRingN(w),re=this.locateInPolygonRing(o,j);if(re===ge.INTERIOR)return ge.EXTERIOR;if(re===ge.BOUNDARY)return ge.BOUNDARY}return ge.INTERIOR}if(arguments[0]instanceof Y&&arguments[1]instanceof ya){var Pe=arguments[0],tt=arguments[1];if(!tt.getEnvelopeInternal().intersects(Pe))return ge.EXTERIOR;var It=tt.getCoordinates();return tt.isClosed()||!Pe.equals(It[0])&&!Pe.equals(It[It.length-1])?wt.isOnLine(Pe,It)?ge.INTERIOR:ge.EXTERIOR:ge.BOUNDARY}if(arguments[0]instanceof Y&&arguments[1]instanceof uo){var tr=arguments[0];return arguments[1].getCoordinate().equals2D(tr)?ge.INTERIOR:ge.EXTERIOR}},Cu.prototype.locateInPolygonRing=function(o,s){return s.getEnvelopeInternal().intersects(o)?wt.locatePointInRing(o,s.getCoordinates()):ge.EXTERIOR},Cu.prototype.intersects=function(o,s){return this.locate(o,s)!==ge.EXTERIOR},Cu.prototype.updateLocationInfo=function(o){o===ge.INTERIOR&&(this._isIn=!0),o===ge.BOUNDARY&&this._numBoundaries++},Cu.prototype.computeLocation=function(o,s){if(s instanceof uo&&this.updateLocationInfo(this.locateInternal(o,s)),s instanceof ya)this.updateLocationInfo(this.locateInternal(o,s));else if(s instanceof Ca)this.updateLocationInfo(this.locateInternal(o,s));else if(s instanceof Ni)for(var d=s,_=0;_<d.getNumGeometries();_++){var w=d.getGeometryN(_);this.updateLocationInfo(this.locateInternal(o,w))}else if(s instanceof vn)for(var j=s,re=0;re<j.getNumGeometries();re++){var Pe=j.getGeometryN(re);this.updateLocationInfo(this.locateInternal(o,Pe))}else if(s instanceof Oo)for(var tt=new No(s);tt.hasNext();){var It=tt.next();It!==s&&this.computeLocation(o,It)}},Cu.prototype.locate=function(o,s){return s.isEmpty()?ge.EXTERIOR:s instanceof ya?this.locateInternal(o,s):s instanceof Ca?this.locateInternal(o,s):(this._isIn=!1,this._numBoundaries=0,this.computeLocation(o,s),this._boundaryRule.isInBoundary(this._numBoundaries)?ge.BOUNDARY:this._numBoundaries>0||this._isIn?ge.INTERIOR:ge.EXTERIOR)},Cu.prototype.interfaces_=function(){return[]},Cu.prototype.getClass=function(){return Cu};var ho=function o(){if(this._component=null,this._segIndex=null,this._pt=null,arguments.length===2){var s=arguments[0],d=arguments[1];o.call(this,s,o.INSIDE_AREA,d)}else if(arguments.length===3){var _=arguments[0],w=arguments[1],j=arguments[2];this._component=_,this._segIndex=w,this._pt=j}},a0={INSIDE_AREA:{configurable:!0}};ho.prototype.isInsideArea=function(){return this._segIndex===ho.INSIDE_AREA},ho.prototype.getCoordinate=function(){return this._pt},ho.prototype.getGeometryComponent=function(){return this._component},ho.prototype.getSegmentIndex=function(){return this._segIndex},ho.prototype.interfaces_=function(){return[]},ho.prototype.getClass=function(){return ho},a0.INSIDE_AREA.get=function(){return-1},Object.defineProperties(ho,a0);var tl=function(o){this._pts=o||null};tl.prototype.filter=function(o){o instanceof uo&&this._pts.add(o)},tl.prototype.interfaces_=function(){return[no]},tl.prototype.getClass=function(){return tl},tl.getPoints=function(){if(arguments.length===1){var o=arguments[0];return o instanceof uo?Ha.singletonList(o):tl.getPoints(o,new Gr)}if(arguments.length===2){var s=arguments[0],d=arguments[1];return s instanceof uo?d.add(s):s instanceof Oo&&s.apply(new tl(d)),d}};var rc=function(){this._locations=null;var o=arguments[0];this._locations=o};rc.prototype.filter=function(o){(o instanceof uo||o instanceof ya||o instanceof Ca)&&this._locations.add(new ho(o,0,o.getCoordinate()))},rc.prototype.interfaces_=function(){return[no]},rc.prototype.getClass=function(){return rc},rc.getLocations=function(o){var s=new Gr;return o.apply(new rc(s)),s};var zo=function(){if(this._geom=null,this._terminateDistance=0,this._ptLocator=new Cu,this._minDistanceLocation=null,this._minDistance=le.MAX_VALUE,arguments.length===2){var o=arguments[0],s=arguments[1];this._geom=[o,s],this._terminateDistance=0}else if(arguments.length===3){var d=arguments[0],_=arguments[1],w=arguments[2];this._geom=new Array(2).fill(null),this._geom[0]=d,this._geom[1]=_,this._terminateDistance=w}};zo.prototype.computeContainmentDistance=function(){if(arguments.length===0){var o=new Array(2).fill(null);if(this.computeContainmentDistance(0,o),this._minDistance<=this._terminateDistance)return null;this.computeContainmentDistance(1,o)}else if(arguments.length===2){var s=arguments[0],d=arguments[1],_=1-s,w=pu.getPolygons(this._geom[s]);if(w.size()>0){var j=rc.getLocations(this._geom[_]);if(this.computeContainmentDistance(j,w,d),this._minDistance<=this._terminateDistance)return this._minDistanceLocation[_]=d[0],this._minDistanceLocation[s]=d[1],null}}else if(arguments.length===3){if(arguments[2]instanceof Array&&Me(arguments[0],Oa)&&Me(arguments[1],Oa)){for(var re=arguments[0],Pe=arguments[1],tt=arguments[2],It=0;It<re.size();It++)for(var tr=re.get(It),ot=0;ot<Pe.size();ot++)if(this.computeContainmentDistance(tr,Pe.get(ot),tt),this._minDistance<=this._terminateDistance)return null}else if(arguments[2]instanceof Array&&arguments[0]instanceof ho&&arguments[1]instanceof Ca){var Zt=arguments[0],Jt=arguments[1],gr=arguments[2],v=Zt.getCoordinate();if(ge.EXTERIOR!==this._ptLocator.locate(v,Jt))return this._minDistance=0,gr[0]=Zt,gr[1]=new ho(Jt,v),null}}},zo.prototype.computeMinDistanceLinesPoints=function(o,s,d){for(var _=0;_<o.size();_++)for(var w=o.get(_),j=0;j<s.size();j++){var re=s.get(j);if(this.computeMinDistance(w,re,d),this._minDistance<=this._terminateDistance)return null}},zo.prototype.computeFacetDistance=function(){var o=new Array(2).fill(null),s=_o.getLines(this._geom[0]),d=_o.getLines(this._geom[1]),_=tl.getPoints(this._geom[0]),w=tl.getPoints(this._geom[1]);return this.computeMinDistanceLines(s,d,o),this.updateMinDistance(o,!1),this._minDistance<=this._terminateDistance?null:(o[0]=null,o[1]=null,this.computeMinDistanceLinesPoints(s,w,o),this.updateMinDistance(o,!1),this._minDistance<=this._terminateDistance?null:(o[0]=null,o[1]=null,this.computeMinDistanceLinesPoints(d,_,o),this.updateMinDistance(o,!0),this._minDistance<=this._terminateDistance?null:(o[0]=null,o[1]=null,this.computeMinDistancePoints(_,w,o),void this.updateMinDistance(o,!1))))},zo.prototype.nearestLocations=function(){return this.computeMinDistance(),this._minDistanceLocation},zo.prototype.updateMinDistance=function(o,s){if(o[0]===null)return null;s?(this._minDistanceLocation[0]=o[1],this._minDistanceLocation[1]=o[0]):(this._minDistanceLocation[0]=o[0],this._minDistanceLocation[1]=o[1])},zo.prototype.nearestPoints=function(){return this.computeMinDistance(),[this._minDistanceLocation[0].getCoordinate(),this._minDistanceLocation[1].getCoordinate()]},zo.prototype.computeMinDistance=function(){if(arguments.length===0){if(this._minDistanceLocation!==null||(this._minDistanceLocation=new Array(2).fill(null),this.computeContainmentDistance(),this._minDistance<=this._terminateDistance))return null;this.computeFacetDistance()}else if(arguments.length===3){if(arguments[2]instanceof Array&&arguments[0]instanceof ya&&arguments[1]instanceof uo){var o=arguments[0],s=arguments[1],d=arguments[2];if(o.getEnvelopeInternal().distance(s.getEnvelopeInternal())>this._minDistance)return null;for(var _=o.getCoordinates(),w=s.getCoordinate(),j=0;j<_.length-1;j++){var re=wt.distancePointLine(w,_[j],_[j+1]);if(re<this._minDistance){this._minDistance=re;var Pe=new Sn(_[j],_[j+1]).closestPoint(w);d[0]=new ho(o,j,Pe),d[1]=new ho(s,0,w)}if(this._minDistance<=this._terminateDistance)return null}}else if(arguments[2]instanceof Array&&arguments[0]instanceof ya&&arguments[1]instanceof ya){var tt=arguments[0],It=arguments[1],tr=arguments[2];if(tt.getEnvelopeInternal().distance(It.getEnvelopeInternal())>this._minDistance)return null;for(var ot=tt.getCoordinates(),Zt=It.getCoordinates(),Jt=0;Jt<ot.length-1;Jt++)for(var gr=0;gr<Zt.length-1;gr++){var v=wt.distanceLineLine(ot[Jt],ot[Jt+1],Zt[gr],Zt[gr+1]);if(v<this._minDistance){this._minDistance=v;var Ln=new Sn(ot[Jt],ot[Jt+1]),jn=new Sn(Zt[gr],Zt[gr+1]),Xe=Ln.closestPoints(jn);tr[0]=new ho(tt,Jt,Xe[0]),tr[1]=new ho(It,gr,Xe[1])}if(this._minDistance<=this._terminateDistance)return null}}}},zo.prototype.computeMinDistancePoints=function(o,s,d){for(var _=0;_<o.size();_++)for(var w=o.get(_),j=0;j<s.size();j++){var re=s.get(j),Pe=w.getCoordinate().distance(re.getCoordinate());if(Pe<this._minDistance&&(this._minDistance=Pe,d[0]=new ho(w,0,w.getCoordinate()),d[1]=new ho(re,0,re.getCoordinate())),this._minDistance<=this._terminateDistance)return null}},zo.prototype.distance=function(){if(this._geom[0]===null||this._geom[1]===null)throw new Te("null geometries are not supported");return this._geom[0].isEmpty()||this._geom[1].isEmpty()?0:(this.computeMinDistance(),this._minDistance)},zo.prototype.computeMinDistanceLines=function(o,s,d){for(var _=0;_<o.size();_++)for(var w=o.get(_),j=0;j<s.size();j++){var re=s.get(j);if(this.computeMinDistance(w,re,d),this._minDistance<=this._terminateDistance)return null}},zo.prototype.interfaces_=function(){return[]},zo.prototype.getClass=function(){return zo},zo.distance=function(o,s){return new zo(o,s).distance()},zo.isWithinDistance=function(o,s,d){return new zo(o,s,d).distance()<=d},zo.nearestPoints=function(o,s){return new zo(o,s).nearestPoints()};var Qo=function(){this._pt=[new Y,new Y],this._distance=le.NaN,this._isNull=!0};Qo.prototype.getCoordinates=function(){return this._pt},Qo.prototype.getCoordinate=function(o){return this._pt[o]},Qo.prototype.setMinimum=function(){if(arguments.length===1){var o=arguments[0];this.setMinimum(o._pt[0],o._pt[1])}else if(arguments.length===2){var s=arguments[0],d=arguments[1];if(this._isNull)return this.initialize(s,d),null;var _=s.distance(d);_<this._distance&&this.initialize(s,d,_)}},Qo.prototype.initialize=function(){if(arguments.length===0)this._isNull=!0;else if(arguments.length===2){var o=arguments[0],s=arguments[1];this._pt[0].setCoordinate(o),this._pt[1].setCoordinate(s),this._distance=o.distance(s),this._isNull=!1}else if(arguments.length===3){var d=arguments[0],_=arguments[1],w=arguments[2];this._pt[0].setCoordinate(d),this._pt[1].setCoordinate(_),this._distance=w,this._isNull=!1}},Qo.prototype.toString=function(){return _n.toLineString(this._pt[0],this._pt[1])},Qo.prototype.getDistance=function(){return this._distance},Qo.prototype.setMaximum=function(){if(arguments.length===1){var o=arguments[0];this.setMaximum(o._pt[0],o._pt[1])}else if(arguments.length===2){var s=arguments[0],d=arguments[1];if(this._isNull)return this.initialize(s,d),null;var _=s.distance(d);_>this._distance&&this.initialize(s,d,_)}},Qo.prototype.interfaces_=function(){return[]},Qo.prototype.getClass=function(){return Qo};var Gs=function(){};Gs.prototype.interfaces_=function(){return[]},Gs.prototype.getClass=function(){return Gs},Gs.computeDistance=function(){if(arguments[2]instanceof Qo&&arguments[0]instanceof ya&&arguments[1]instanceof Y)for(var o=arguments[0],s=arguments[1],d=arguments[2],_=new Sn,w=o.getCoordinates(),j=0;j<w.length-1;j++){_.setCoordinates(w[j],w[j+1]);var re=_.closestPoint(s);d.setMinimum(re,s)}else if(arguments[2]instanceof Qo&&arguments[0]instanceof Ca&&arguments[1]instanceof Y){var Pe=arguments[0],tt=arguments[1],It=arguments[2];Gs.computeDistance(Pe.getExteriorRing(),tt,It);for(var tr=0;tr<Pe.getNumInteriorRing();tr++)Gs.computeDistance(Pe.getInteriorRingN(tr),tt,It)}else if(arguments[2]instanceof Qo&&arguments[0]instanceof Tt&&arguments[1]instanceof Y){var ot=arguments[0],Zt=arguments[1],Jt=arguments[2];if(ot instanceof ya)Gs.computeDistance(ot,Zt,Jt);else if(ot instanceof Ca)Gs.computeDistance(ot,Zt,Jt);else if(ot instanceof Oo)for(var gr=ot,v=0;v<gr.getNumGeometries();v++){var Ln=gr.getGeometryN(v);Gs.computeDistance(Ln,Zt,Jt)}else Jt.setMinimum(ot.getCoordinate(),Zt)}else if(arguments[2]instanceof Qo&&arguments[0]instanceof Sn&&arguments[1]instanceof Y){var jn=arguments[0],Xe=arguments[1],Ma=arguments[2],ao=jn.closestPoint(Xe);Ma.setMinimum(ao,Xe)}};var js=function(){this._g0=null,this._g1=null,this._ptDist=new Qo,this._densifyFrac=0;var o=arguments[0],s=arguments[1];this._g0=o,this._g1=s},yc={MaxPointDistanceFilter:{configurable:!0},MaxDensifiedByFractionDistanceFilter:{configurable:!0}};js.prototype.getCoordinates=function(){return this._ptDist.getCoordinates()},js.prototype.setDensifyFraction=function(o){if(o>1||o<=0)throw new Te("Fraction is not in range (0.0 - 1.0]");this._densifyFrac=o},js.prototype.compute=function(o,s){this.computeOrientedDistance(o,s,this._ptDist),this.computeOrientedDistance(s,o,this._ptDist)},js.prototype.distance=function(){return this.compute(this._g0,this._g1),this._ptDist.getDistance()},js.prototype.computeOrientedDistance=function(o,s,d){var _=new Ls(s);if(o.apply(_),d.setMaximum(_.getMaxPointDistance()),this._densifyFrac>0){var w=new El(s,this._densifyFrac);o.apply(w),d.setMaximum(w.getMaxPointDistance())}},js.prototype.orientedDistance=function(){return this.computeOrientedDistance(this._g0,this._g1,this._ptDist),this._ptDist.getDistance()},js.prototype.interfaces_=function(){return[]},js.prototype.getClass=function(){return js},js.distance=function(){if(arguments.length===2){var o=arguments[0],s=arguments[1];return new js(o,s).distance()}if(arguments.length===3){var d=arguments[0],_=arguments[1],w=arguments[2],j=new js(d,_);return j.setDensifyFraction(w),j.distance()}},yc.MaxPointDistanceFilter.get=function(){return Ls},yc.MaxDensifiedByFractionDistanceFilter.get=function(){return El},Object.defineProperties(js,yc);var Ls=function(){this._maxPtDist=new Qo,this._minPtDist=new Qo,this._euclideanDist=new Gs,this._geom=null;var o=arguments[0];this._geom=o};Ls.prototype.filter=function(o){this._minPtDist.initialize(),Gs.computeDistance(this._geom,o,this._minPtDist),this._maxPtDist.setMaximum(this._minPtDist)},Ls.prototype.getMaxPointDistance=function(){return this._maxPtDist},Ls.prototype.interfaces_=function(){return[kr]},Ls.prototype.getClass=function(){return Ls};var El=function(){this._maxPtDist=new Qo,this._minPtDist=new Qo,this._geom=null,this._numSubSegs=0;var o=arguments[0],s=arguments[1];this._geom=o,this._numSubSegs=Math.trunc(Math.round(1/s))};El.prototype.filter=function(o,s){if(s===0)return null;for(var d=o.getCoordinate(s-1),_=o.getCoordinate(s),w=(_.x-d.x)/this._numSubSegs,j=(_.y-d.y)/this._numSubSegs,re=0;re<this._numSubSegs;re++){var Pe=d.x+re*w,tt=d.y+re*j,It=new Y(Pe,tt);this._minPtDist.initialize(),Gs.computeDistance(this._geom,It,this._minPtDist),this._maxPtDist.setMaximum(this._minPtDist)}},El.prototype.isDone=function(){return!1},El.prototype.isGeometryChanged=function(){return!1},El.prototype.getMaxPointDistance=function(){return this._maxPtDist},El.prototype.interfaces_=function(){return[ts]},El.prototype.getClass=function(){return El};var To=function(o,s,d){this._minValidDistance=null,this._maxValidDistance=null,this._minDistanceFound=null,this._maxDistanceFound=null,this._isValid=!0,this._errMsg=null,this._errorLocation=null,this._errorIndicator=null,this._input=o||null,this._bufDistance=s||null,this._result=d||null},Vs={VERBOSE:{configurable:!0},MAX_DISTANCE_DIFF_FRAC:{configurable:!0}};To.prototype.checkMaximumDistance=function(o,s,d){var _=new js(s,o);if(_.setDensifyFraction(.25),this._maxDistanceFound=_.orientedDistance(),this._maxDistanceFound>d){this._isValid=!1;var w=_.getCoordinates();this._errorLocation=w[1],this._errorIndicator=o.getFactory().createLineString(w),this._errMsg="Distance between buffer curve and input is too large ("+this._maxDistanceFound+" at "+_n.toLineString(w[0],w[1])+")"}},To.prototype.isValid=function(){var o=Math.abs(this._bufDistance),s=To.MAX_DISTANCE_DIFF_FRAC*o;return this._minValidDistance=o-s,this._maxValidDistance=o+s,!(!this._input.isEmpty()&&!this._result.isEmpty())||(this._bufDistance>0?this.checkPositiveValid():this.checkNegativeValid(),To.VERBOSE&&Qr.out.println("Min Dist= "+this._minDistanceFound+"  err= "+(1-this._minDistanceFound/this._bufDistance)+"  Max Dist= "+this._maxDistanceFound+"  err= "+(this._maxDistanceFound/this._bufDistance-1)),this._isValid)},To.prototype.checkNegativeValid=function(){if(!(this._input instanceof Ca||this._input instanceof vn||this._input instanceof Oo))return null;var o=this.getPolygonLines(this._input);if(this.checkMinimumDistance(o,this._result,this._minValidDistance),!this._isValid)return null;this.checkMaximumDistance(o,this._result,this._maxValidDistance)},To.prototype.getErrorIndicator=function(){return this._errorIndicator},To.prototype.checkMinimumDistance=function(o,s,d){var _=new zo(o,s,d);if(this._minDistanceFound=_.distance(),this._minDistanceFound<d){this._isValid=!1;var w=_.nearestPoints();this._errorLocation=_.nearestPoints()[1],this._errorIndicator=o.getFactory().createLineString(w),this._errMsg="Distance between buffer curve and input is too small ("+this._minDistanceFound+" at "+_n.toLineString(w[0],w[1])+" )"}},To.prototype.checkPositiveValid=function(){var o=this._result.getBoundary();if(this.checkMinimumDistance(this._input,o,this._minValidDistance),!this._isValid)return null;this.checkMaximumDistance(this._input,o,this._maxValidDistance)},To.prototype.getErrorLocation=function(){return this._errorLocation},To.prototype.getPolygonLines=function(o){for(var s=new Gr,d=new _o(s),_=pu.getPolygons(o).iterator();_.hasNext();)_.next().apply(d);return o.getFactory().buildGeometry(s)},To.prototype.getErrorMessage=function(){return this._errMsg},To.prototype.interfaces_=function(){return[]},To.prototype.getClass=function(){return To},Vs.VERBOSE.get=function(){return!1},Vs.MAX_DISTANCE_DIFF_FRAC.get=function(){return .012},Object.defineProperties(To,Vs);var Va=function(o,s,d){this._isValid=!0,this._errorMsg=null,this._errorLocation=null,this._errorIndicator=null,this._input=o||null,this._distance=s||null,this._result=d||null},ur={VERBOSE:{configurable:!0},MAX_ENV_DIFF_FRAC:{configurable:!0}};Va.prototype.isValid=function(){return this.checkPolygonal(),this._isValid?(this.checkExpectedEmpty(),this._isValid?(this.checkEnvelope(),this._isValid?(this.checkArea(),this._isValid?(this.checkDistance(),this._isValid):this._isValid):this._isValid):this._isValid):this._isValid},Va.prototype.checkEnvelope=function(){if(this._distance<0)return null;var o=this._distance*Va.MAX_ENV_DIFF_FRAC;o===0&&(o=.001);var s=new _r(this._input.getEnvelopeInternal());s.expandBy(this._distance);var d=new _r(this._result.getEnvelopeInternal());d.expandBy(o),d.contains(s)||(this._isValid=!1,this._errorMsg="Buffer envelope is incorrect",this._errorIndicator=this._input.getFactory().toGeometry(d)),this.report("Envelope")},Va.prototype.checkDistance=function(){var o=new To(this._input,this._distance,this._result);o.isValid()||(this._isValid=!1,this._errorMsg=o.getErrorMessage(),this._errorLocation=o.getErrorLocation(),this._errorIndicator=o.getErrorIndicator()),this.report("Distance")},Va.prototype.checkArea=function(){var o=this._input.getArea(),s=this._result.getArea();this._distance>0&&o>s&&(this._isValid=!1,this._errorMsg="Area of positive buffer is smaller than input",this._errorIndicator=this._result),this._distance<0&&o<s&&(this._isValid=!1,this._errorMsg="Area of negative buffer is larger than input",this._errorIndicator=this._result),this.report("Area")},Va.prototype.checkPolygonal=function(){this._result instanceof Ca||this._result instanceof vn||(this._isValid=!1),this._errorMsg="Result is not polygonal",this._errorIndicator=this._result,this.report("Polygonal")},Va.prototype.getErrorIndicator=function(){return this._errorIndicator},Va.prototype.getErrorLocation=function(){return this._errorLocation},Va.prototype.checkExpectedEmpty=function(){return this._input.getDimension()>=2||this._distance>0?null:(this._result.isEmpty()||(this._isValid=!1,this._errorMsg="Result is non-empty",this._errorIndicator=this._result),void this.report("ExpectedEmpty"))},Va.prototype.report=function(o){if(!Va.VERBOSE)return null;Qr.out.println("Check "+o+": "+(this._isValid?"passed":"FAILED"))},Va.prototype.getErrorMessage=function(){return this._errorMsg},Va.prototype.interfaces_=function(){return[]},Va.prototype.getClass=function(){return Va},Va.isValidMsg=function(o,s,d){var _=new Va(o,s,d);return _.isValid()?null:_.getErrorMessage()},Va.isValid=function(o,s,d){return!!new Va(o,s,d).isValid()},ur.VERBOSE.get=function(){return!1},ur.MAX_ENV_DIFF_FRAC.get=function(){return .012},Object.defineProperties(Va,ur);var bt=function(){this._pts=null,this._data=null;var o=arguments[0],s=arguments[1];this._pts=o,this._data=s};bt.prototype.getCoordinates=function(){return this._pts},bt.prototype.size=function(){return this._pts.length},bt.prototype.getCoordinate=function(o){return this._pts[o]},bt.prototype.isClosed=function(){return this._pts[0].equals(this._pts[this._pts.length-1])},bt.prototype.getSegmentOctant=function(o){return o===this._pts.length-1?-1:la.octant(this.getCoordinate(o),this.getCoordinate(o+1))},bt.prototype.setData=function(o){this._data=o},bt.prototype.getData=function(){return this._data},bt.prototype.toString=function(){return _n.toLineString(new ja(this._pts))},bt.prototype.interfaces_=function(){return[os]},bt.prototype.getClass=function(){return bt};var Ce=function(){this._findAllIntersections=!1,this._isCheckEndSegmentsOnly=!1,this._li=null,this._interiorIntersection=null,this._intSegments=null,this._intersections=new Gr,this._intersectionCount=0,this._keepIntersections=!0;var o=arguments[0];this._li=o,this._interiorIntersection=null};Ce.prototype.getInteriorIntersection=function(){return this._interiorIntersection},Ce.prototype.setCheckEndSegmentsOnly=function(o){this._isCheckEndSegmentsOnly=o},Ce.prototype.getIntersectionSegments=function(){return this._intSegments},Ce.prototype.count=function(){return this._intersectionCount},Ce.prototype.getIntersections=function(){return this._intersections},Ce.prototype.setFindAllIntersections=function(o){this._findAllIntersections=o},Ce.prototype.setKeepIntersections=function(o){this._keepIntersections=o},Ce.prototype.processIntersections=function(o,s,d,_){if(!this._findAllIntersections&&this.hasIntersection()||o===d&&s===_||this._isCheckEndSegmentsOnly&&!(this.isEndSegment(o,s)||this.isEndSegment(d,_)))return null;var w=o.getCoordinates()[s],j=o.getCoordinates()[s+1],re=d.getCoordinates()[_],Pe=d.getCoordinates()[_+1];this._li.computeIntersection(w,j,re,Pe),this._li.hasIntersection()&&this._li.isInteriorIntersection()&&(this._intSegments=new Array(4).fill(null),this._intSegments[0]=w,this._intSegments[1]=j,this._intSegments[2]=re,this._intSegments[3]=Pe,this._interiorIntersection=this._li.getIntersection(0),this._keepIntersections&&this._intersections.add(this._interiorIntersection),this._intersectionCount++)},Ce.prototype.isEndSegment=function(o,s){return s===0||s>=o.size()-2},Ce.prototype.hasIntersection=function(){return this._interiorIntersection!==null},Ce.prototype.isDone=function(){return!this._findAllIntersections&&this._interiorIntersection!==null},Ce.prototype.interfaces_=function(){return[Ms]},Ce.prototype.getClass=function(){return Ce},Ce.createAllIntersectionsFinder=function(o){var s=new Ce(o);return s.setFindAllIntersections(!0),s},Ce.createAnyIntersectionFinder=function(o){return new Ce(o)},Ce.createIntersectionCounter=function(o){var s=new Ce(o);return s.setFindAllIntersections(!0),s.setKeepIntersections(!1),s};var Hs=function(){this._li=new $e,this._segStrings=null,this._findAllIntersections=!1,this._segInt=null,this._isValid=!0;var o=arguments[0];this._segStrings=o};Hs.prototype.execute=function(){if(this._segInt!==null)return null;this.checkInteriorIntersections()},Hs.prototype.getIntersections=function(){return this._segInt.getIntersections()},Hs.prototype.isValid=function(){return this.execute(),this._isValid},Hs.prototype.setFindAllIntersections=function(o){this._findAllIntersections=o},Hs.prototype.checkInteriorIntersections=function(){this._isValid=!0,this._segInt=new Ce(this._li),this._segInt.setFindAllIntersections(this._findAllIntersections);var o=new gc;if(o.setSegmentIntersector(this._segInt),o.computeNodes(this._segStrings),this._segInt.hasIntersection())return this._isValid=!1,null},Hs.prototype.checkValid=function(){if(this.execute(),!this._isValid)throw new zt(this.getErrorMessage(),this._segInt.getInteriorIntersection())},Hs.prototype.getErrorMessage=function(){if(this._isValid)return"no intersections found";var o=this._segInt.getIntersectionSegments();return"found non-noded intersection between "+_n.toLineString(o[0],o[1])+" and "+_n.toLineString(o[2],o[3])},Hs.prototype.interfaces_=function(){return[]},Hs.prototype.getClass=function(){return Hs},Hs.computeIntersections=function(o){var s=new Hs(o);return s.setFindAllIntersections(!0),s.isValid(),s.getIntersections()};var nt=function o(){this._nv=null;var s=arguments[0];this._nv=new Hs(o.toSegmentStrings(s))};nt.prototype.checkValid=function(){this._nv.checkValid()},nt.prototype.interfaces_=function(){return[]},nt.prototype.getClass=function(){return nt},nt.toSegmentStrings=function(o){for(var s=new Gr,d=o.iterator();d.hasNext();){var _=d.next();s.add(new bt(_.getCoordinates(),_))}return s},nt.checkValid=function(o){new nt(o).checkValid()};var rl=function(o){this._mapOp=o};rl.prototype.map=function(o){for(var s=new Gr,d=0;d<o.getNumGeometries();d++){var _=this._mapOp.map(o.getGeometryN(d));_.isEmpty()||s.add(_)}return o.getFactory().createGeometryCollection(Ai.toGeometryArray(s))},rl.prototype.interfaces_=function(){return[]},rl.prototype.getClass=function(){return rl},rl.map=function(o,s){return new rl(s).map(o)};var xa=function(){this._op=null,this._geometryFactory=null,this._ptLocator=null,this._lineEdgesList=new Gr,this._resultLineList=new Gr;var o=arguments[0],s=arguments[1],d=arguments[2];this._op=o,this._geometryFactory=s,this._ptLocator=d};xa.prototype.collectLines=function(o){for(var s=this._op.getGraph().getEdgeEnds().iterator();s.hasNext();){var d=s.next();this.collectLineEdge(d,o,this._lineEdgesList),this.collectBoundaryTouchEdge(d,o,this._lineEdgesList)}},xa.prototype.labelIsolatedLine=function(o,s){var d=this._ptLocator.locate(o.getCoordinate(),this._op.getArgGeometry(s));o.getLabel().setLocation(s,d)},xa.prototype.build=function(o){return this.findCoveredLineEdges(),this.collectLines(o),this.buildLines(o),this._resultLineList},xa.prototype.collectLineEdge=function(o,s,d){var _=o.getLabel(),w=o.getEdge();o.isLineEdge()&&(o.isVisited()||!Fn.isResultOfOp(_,s)||w.isCovered()||(d.add(w),o.setVisitedEdge(!0)))},xa.prototype.findCoveredLineEdges=function(){for(var o=this._op.getGraph().getNodes().iterator();o.hasNext();)o.next().getEdges().findCoveredLineEdges();for(var s=this._op.getGraph().getEdgeEnds().iterator();s.hasNext();){var d=s.next(),_=d.getEdge();if(d.isLineEdge()&&!_.isCoveredSet()){var w=this._op.isCoveredByA(d.getCoordinate());_.setCovered(w)}}},xa.prototype.labelIsolatedLines=function(o){for(var s=o.iterator();s.hasNext();){var d=s.next(),_=d.getLabel();d.isIsolated()&&(_.isNull(0)?this.labelIsolatedLine(d,0):this.labelIsolatedLine(d,1))}},xa.prototype.buildLines=function(o){for(var s=this._lineEdgesList.iterator();s.hasNext();){var d=s.next(),_=this._geometryFactory.createLineString(d.getCoordinates());this._resultLineList.add(_),d.setInResult(!0)}},xa.prototype.collectBoundaryTouchEdge=function(o,s,d){var _=o.getLabel();return o.isLineEdge()||o.isVisited()||o.isInteriorAreaEdge()||o.getEdge().isInResult()?null:(Pt.isTrue(!(o.isInResult()||o.getSym().isInResult())||!o.getEdge().isInResult()),void(Fn.isResultOfOp(_,s)&&s===Fn.INTERSECTION&&(d.add(o.getEdge()),o.setVisitedEdge(!0))))},xa.prototype.interfaces_=function(){return[]},xa.prototype.getClass=function(){return xa};var $s=function(){this._op=null,this._geometryFactory=null,this._resultPointList=new Gr;var o=arguments[0],s=arguments[1];this._op=o,this._geometryFactory=s};$s.prototype.filterCoveredNodeToPoint=function(o){var s=o.getCoordinate();if(!this._op.isCoveredByLA(s)){var d=this._geometryFactory.createPoint(s);this._resultPointList.add(d)}},$s.prototype.extractNonCoveredResultNodes=function(o){for(var s=this._op.getGraph().getNodes().iterator();s.hasNext();){var d=s.next();if(!d.isInResult()&&!d.isIncidentEdgeInResult()&&(d.getEdges().getDegree()===0||o===Fn.INTERSECTION)){var _=d.getLabel();Fn.isResultOfOp(_,o)&&this.filterCoveredNodeToPoint(d)}}},$s.prototype.build=function(o){return this.extractNonCoveredResultNodes(o),this._resultPointList},$s.prototype.interfaces_=function(){return[]},$s.prototype.getClass=function(){return $s};var ai=function(){this._inputGeom=null,this._factory=null,this._pruneEmptyGeometry=!0,this._preserveGeometryCollectionType=!0,this._preserveCollections=!1,this._preserveType=!1};ai.prototype.transformPoint=function(o,s){return this._factory.createPoint(this.transformCoordinates(o.getCoordinateSequence(),o))},ai.prototype.transformPolygon=function(o,s){var d=!0,_=this.transformLinearRing(o.getExteriorRing(),o);_!==null&&_ instanceof Mr&&!_.isEmpty()||(d=!1);for(var w=new Gr,j=0;j<o.getNumInteriorRing();j++){var re=this.transformLinearRing(o.getInteriorRingN(j),o);re===null||re.isEmpty()||(re instanceof Mr||(d=!1),w.add(re))}if(d)return this._factory.createPolygon(_,w.toArray([]));var Pe=new Gr;return _!==null&&Pe.add(_),Pe.addAll(w),this._factory.buildGeometry(Pe)},ai.prototype.createCoordinateSequence=function(o){return this._factory.getCoordinateSequenceFactory().create(o)},ai.prototype.getInputGeometry=function(){return this._inputGeom},ai.prototype.transformMultiLineString=function(o,s){for(var d=new Gr,_=0;_<o.getNumGeometries();_++){var w=this.transformLineString(o.getGeometryN(_),o);w!==null&&(w.isEmpty()||d.add(w))}return this._factory.buildGeometry(d)},ai.prototype.transformCoordinates=function(o,s){return this.copy(o)},ai.prototype.transformLineString=function(o,s){return this._factory.createLineString(this.transformCoordinates(o.getCoordinateSequence(),o))},ai.prototype.transformMultiPoint=function(o,s){for(var d=new Gr,_=0;_<o.getNumGeometries();_++){var w=this.transformPoint(o.getGeometryN(_),o);w!==null&&(w.isEmpty()||d.add(w))}return this._factory.buildGeometry(d)},ai.prototype.transformMultiPolygon=function(o,s){for(var d=new Gr,_=0;_<o.getNumGeometries();_++){var w=this.transformPolygon(o.getGeometryN(_),o);w!==null&&(w.isEmpty()||d.add(w))}return this._factory.buildGeometry(d)},ai.prototype.copy=function(o){return o.copy()},ai.prototype.transformGeometryCollection=function(o,s){for(var d=new Gr,_=0;_<o.getNumGeometries();_++){var w=this.transform(o.getGeometryN(_));w!==null&&(this._pruneEmptyGeometry&&w.isEmpty()||d.add(w))}return this._preserveGeometryCollectionType?this._factory.createGeometryCollection(Ai.toGeometryArray(d)):this._factory.buildGeometry(d)},ai.prototype.transform=function(o){if(this._inputGeom=o,this._factory=o.getFactory(),o instanceof uo)return this.transformPoint(o,null);if(o instanceof uu)return this.transformMultiPoint(o,null);if(o instanceof Mr)return this.transformLinearRing(o,null);if(o instanceof ya)return this.transformLineString(o,null);if(o instanceof Ni)return this.transformMultiLineString(o,null);if(o instanceof Ca)return this.transformPolygon(o,null);if(o instanceof vn)return this.transformMultiPolygon(o,null);if(o instanceof Oo)return this.transformGeometryCollection(o,null);throw new Te("Unknown Geometry subtype: "+o.getClass().getName())},ai.prototype.transformLinearRing=function(o,s){var d=this.transformCoordinates(o.getCoordinateSequence(),o);if(d===null)return this._factory.createLinearRing(null);var _=d.size();return _>0&&_<4&&!this._preserveType?this._factory.createLineString(d):this._factory.createLinearRing(d)},ai.prototype.interfaces_=function(){return[]},ai.prototype.getClass=function(){return ai};var ca=function o(){if(this._snapTolerance=0,this._srcPts=null,this._seg=new Sn,this._allowSnappingToSourceVertices=!1,this._isClosed=!1,arguments[0]instanceof ya&&typeof arguments[1]=="number"){var s=arguments[0],d=arguments[1];o.call(this,s.getCoordinates(),d)}else if(arguments[0]instanceof Array&&typeof arguments[1]=="number"){var _=arguments[0],w=arguments[1];this._srcPts=_,this._isClosed=o.isClosed(_),this._snapTolerance=w}};ca.prototype.snapVertices=function(o,s){for(var d=this._isClosed?o.size()-1:o.size(),_=0;_<d;_++){var w=o.get(_),j=this.findSnapForVertex(w,s);j!==null&&(o.set(_,new Y(j)),_===0&&this._isClosed&&o.set(o.size()-1,new Y(j)))}},ca.prototype.findSnapForVertex=function(o,s){for(var d=0;d<s.length;d++){if(o.equals2D(s[d]))return null;if(o.distance(s[d])<this._snapTolerance)return s[d]}return null},ca.prototype.snapTo=function(o){var s=new Co(this._srcPts);return this.snapVertices(s,o),this.snapSegments(s,o),s.toCoordinateArray()},ca.prototype.snapSegments=function(o,s){if(s.length===0)return null;var d=s.length;s[0].equals2D(s[s.length-1])&&(d=s.length-1);for(var _=0;_<d;_++){var w=s[_],j=this.findSegmentIndexToSnap(w,o);j>=0&&o.add(j+1,new Y(w),!1)}},ca.prototype.findSegmentIndexToSnap=function(o,s){for(var d=le.MAX_VALUE,_=-1,w=0;w<s.size()-1;w++){if(this._seg.p0=s.get(w),this._seg.p1=s.get(w+1),this._seg.p0.equals2D(o)||this._seg.p1.equals2D(o)){if(this._allowSnappingToSourceVertices)continue;return-1}var j=this._seg.distance(o);j<this._snapTolerance&&j<d&&(d=j,_=w)}return _},ca.prototype.setAllowSnappingToSourceVertices=function(o){this._allowSnappingToSourceVertices=o},ca.prototype.interfaces_=function(){return[]},ca.prototype.getClass=function(){return ca},ca.isClosed=function(o){return!(o.length<=1)&&o[0].equals2D(o[o.length-1])};var bi=function(o){this._srcGeom=o||null},$a={SNAP_PRECISION_FACTOR:{configurable:!0}};bi.prototype.snapTo=function(o,s){var d=this.extractTargetCoordinates(o);return new Ii(s,d).transform(this._srcGeom)},bi.prototype.snapToSelf=function(o,s){var d=this.extractTargetCoordinates(this._srcGeom),_=new Ii(o,d,!0).transform(this._srcGeom),w=_;return s&&Me(w,Js)&&(w=_.buffer(0)),w},bi.prototype.computeSnapTolerance=function(o){return this.computeMinimumSegmentLength(o)/10},bi.prototype.extractTargetCoordinates=function(o){for(var s=new He,d=o.getCoordinates(),_=0;_<d.length;_++)s.add(d[_]);return s.toArray(new Array(0).fill(null))},bi.prototype.computeMinimumSegmentLength=function(o){for(var s=le.MAX_VALUE,d=0;d<o.length-1;d++){var _=o[d].distance(o[d+1]);_<s&&(s=_)}return s},bi.prototype.interfaces_=function(){return[]},bi.prototype.getClass=function(){return bi},bi.snap=function(o,s,d){var _=new Array(2).fill(null),w=new bi(o);_[0]=w.snapTo(s,d);var j=new bi(s);return _[1]=j.snapTo(_[0],d),_},bi.computeOverlaySnapTolerance=function(){if(arguments.length===1){var o=arguments[0],s=bi.computeSizeBasedSnapTolerance(o),d=o.getPrecisionModel();if(d.getType()===zi.FIXED){var _=1/d.getScale()*2/1.415;_>s&&(s=_)}return s}if(arguments.length===2){var w=arguments[0],j=arguments[1];return Math.min(bi.computeOverlaySnapTolerance(w),bi.computeOverlaySnapTolerance(j))}},bi.computeSizeBasedSnapTolerance=function(o){var s=o.getEnvelopeInternal();return Math.min(s.getHeight(),s.getWidth())*bi.SNAP_PRECISION_FACTOR},bi.snapToSelf=function(o,s,d){return new bi(o).snapToSelf(s,d)},$a.SNAP_PRECISION_FACTOR.get=function(){return 1e-9},Object.defineProperties(bi,$a);var Ii=function(o){function s(d,_,w){o.call(this),this._snapTolerance=d||null,this._snapPts=_||null,this._isSelfSnap=w!==void 0&&w}return o&&(s.__proto__=o),s.prototype=Object.create(o&&o.prototype),s.prototype.constructor=s,s.prototype.snapLine=function(d,_){var w=new ca(d,this._snapTolerance);return w.setAllowSnappingToSourceVertices(this._isSelfSnap),w.snapTo(_)},s.prototype.transformCoordinates=function(d,_){var w=d.toCoordinateArray(),j=this.snapLine(w,this._snapPts);return this._factory.getCoordinateSequenceFactory().create(j)},s.prototype.interfaces_=function(){return[]},s.prototype.getClass=function(){return s},s}(ai),Hn=function(){this._isFirst=!0,this._commonMantissaBitsCount=53,this._commonBits=0,this._commonSignExp=null};Hn.prototype.getCommon=function(){return le.longBitsToDouble(this._commonBits)},Hn.prototype.add=function(o){var s=le.doubleToLongBits(o);if(this._isFirst)return this._commonBits=s,this._commonSignExp=Hn.signExpBits(this._commonBits),this._isFirst=!1,null;if(Hn.signExpBits(s)!==this._commonSignExp)return this._commonBits=0,null;this._commonMantissaBitsCount=Hn.numCommonMostSigMantissaBits(this._commonBits,s),this._commonBits=Hn.zeroLowerBits(this._commonBits,64-(12+this._commonMantissaBitsCount))},Hn.prototype.toString=function(){if(arguments.length===1){var o=arguments[0],s=le.longBitsToDouble(o),d="0000000000000000000000000000000000000000000000000000000000000000"+le.toBinaryString(o),_=d.substring(d.length-64);return _.substring(0,1)+"  "+_.substring(1,12)+"(exp) "+_.substring(12)+" [ "+s+" ]"}},Hn.prototype.interfaces_=function(){return[]},Hn.prototype.getClass=function(){return Hn},Hn.getBit=function(o,s){return o&1<<s?1:0},Hn.signExpBits=function(o){return o>>52},Hn.zeroLowerBits=function(o,s){return o&~((1<<s)-1)},Hn.numCommonMostSigMantissaBits=function(o,s){for(var d=0,_=52;_>=0;_--){if(Hn.getBit(o,_)!==Hn.getBit(s,_))return d;d++}return 52};var mi=function(){this._commonCoord=null,this._ccFilter=new _i},Wi={CommonCoordinateFilter:{configurable:!0},Translater:{configurable:!0}};mi.prototype.addCommonBits=function(o){var s=new di(this._commonCoord);o.apply(s),o.geometryChanged()},mi.prototype.removeCommonBits=function(o){if(this._commonCoord.x===0&&this._commonCoord.y===0)return o;var s=new Y(this._commonCoord);s.x=-s.x,s.y=-s.y;var d=new di(s);return o.apply(d),o.geometryChanged(),o},mi.prototype.getCommonCoordinate=function(){return this._commonCoord},mi.prototype.add=function(o){o.apply(this._ccFilter),this._commonCoord=this._ccFilter.getCommonCoordinate()},mi.prototype.interfaces_=function(){return[]},mi.prototype.getClass=function(){return mi},Wi.CommonCoordinateFilter.get=function(){return _i},Wi.Translater.get=function(){return di},Object.defineProperties(mi,Wi);var _i=function(){this._commonBitsX=new Hn,this._commonBitsY=new Hn};_i.prototype.filter=function(o){this._commonBitsX.add(o.x),this._commonBitsY.add(o.y)},_i.prototype.getCommonCoordinate=function(){return new Y(this._commonBitsX.getCommon(),this._commonBitsY.getCommon())},_i.prototype.interfaces_=function(){return[kr]},_i.prototype.getClass=function(){return _i};var di=function(){this.trans=null;var o=arguments[0];this.trans=o};di.prototype.filter=function(o,s){var d=o.getOrdinate(s,0)+this.trans.x,_=o.getOrdinate(s,1)+this.trans.y;o.setOrdinate(s,0,d),o.setOrdinate(s,1,_)},di.prototype.isDone=function(){return!1},di.prototype.isGeometryChanged=function(){return!0},di.prototype.interfaces_=function(){return[ts]},di.prototype.getClass=function(){return di};var wn=function(o,s){this._geom=new Array(2).fill(null),this._snapTolerance=null,this._cbr=null,this._geom[0]=o,this._geom[1]=s,this.computeSnapTolerance()};wn.prototype.selfSnap=function(o){return new bi(o).snapTo(o,this._snapTolerance)},wn.prototype.removeCommonBits=function(o){this._cbr=new mi,this._cbr.add(o[0]),this._cbr.add(o[1]);var s=new Array(2).fill(null);return s[0]=this._cbr.removeCommonBits(o[0].copy()),s[1]=this._cbr.removeCommonBits(o[1].copy()),s},wn.prototype.prepareResult=function(o){return this._cbr.addCommonBits(o),o},wn.prototype.getResultGeometry=function(o){var s=this.snap(this._geom),d=Fn.overlayOp(s[0],s[1],o);return this.prepareResult(d)},wn.prototype.checkValid=function(o){o.isValid()||Qr.out.println("Snapped geometry is invalid")},wn.prototype.computeSnapTolerance=function(){this._snapTolerance=bi.computeOverlaySnapTolerance(this._geom[0],this._geom[1])},wn.prototype.snap=function(o){var s=this.removeCommonBits(o);return bi.snap(s[0],s[1],this._snapTolerance)},wn.prototype.interfaces_=function(){return[]},wn.prototype.getClass=function(){return wn},wn.overlayOp=function(o,s,d){return new wn(o,s).getResultGeometry(d)},wn.union=function(o,s){return wn.overlayOp(o,s,Fn.UNION)},wn.intersection=function(o,s){return wn.overlayOp(o,s,Fn.INTERSECTION)},wn.symDifference=function(o,s){return wn.overlayOp(o,s,Fn.SYMDIFFERENCE)},wn.difference=function(o,s){return wn.overlayOp(o,s,Fn.DIFFERENCE)};var Yn=function(o,s){this._geom=new Array(2).fill(null),this._geom[0]=o,this._geom[1]=s};Yn.prototype.getResultGeometry=function(o){var s=null,d=!1,_=null;try{s=Fn.overlayOp(this._geom[0],this._geom[1],o),d=!0}catch(w){if(!(w instanceof Di))throw w;_=w}if(!d)try{s=wn.overlayOp(this._geom[0],this._geom[1],o)}catch(w){throw w instanceof Di?_:w}return s},Yn.prototype.interfaces_=function(){return[]},Yn.prototype.getClass=function(){return Yn},Yn.overlayOp=function(o,s,d){return new Yn(o,s).getResultGeometry(d)},Yn.union=function(o,s){return Yn.overlayOp(o,s,Fn.UNION)},Yn.intersection=function(o,s){return Yn.overlayOp(o,s,Fn.INTERSECTION)},Yn.symDifference=function(o,s){return Yn.overlayOp(o,s,Fn.SYMDIFFERENCE)},Yn.difference=function(o,s){return Yn.overlayOp(o,s,Fn.DIFFERENCE)};var Li=function(){this.mce=null,this.chainIndex=null;var o=arguments[0],s=arguments[1];this.mce=o,this.chainIndex=s};Li.prototype.computeIntersections=function(o,s){this.mce.computeIntersectsForChain(this.chainIndex,o.mce,o.chainIndex,s)},Li.prototype.interfaces_=function(){return[]},Li.prototype.getClass=function(){return Li};var qn=function o(){if(this._label=null,this._xValue=null,this._eventType=null,this._insertEvent=null,this._deleteEventIndex=null,this._obj=null,arguments.length===2){var s=arguments[0],d=arguments[1];this._eventType=o.DELETE,this._xValue=s,this._insertEvent=d}else if(arguments.length===3){var _=arguments[0],w=arguments[1],j=arguments[2];this._eventType=o.INSERT,this._label=_,this._xValue=w,this._obj=j}},Ui={INSERT:{configurable:!0},DELETE:{configurable:!0}};qn.prototype.isDelete=function(){return this._eventType===qn.DELETE},qn.prototype.setDeleteEventIndex=function(o){this._deleteEventIndex=o},qn.prototype.getObject=function(){return this._obj},qn.prototype.compareTo=function(o){var s=o;return this._xValue<s._xValue?-1:this._xValue>s._xValue?1:this._eventType<s._eventType?-1:this._eventType>s._eventType?1:0},qn.prototype.getInsertEvent=function(){return this._insertEvent},qn.prototype.isInsert=function(){return this._eventType===qn.INSERT},qn.prototype.isSameLabel=function(o){return this._label!==null&&this._label===o._label},qn.prototype.getDeleteEventIndex=function(){return this._deleteEventIndex},qn.prototype.interfaces_=function(){return[ye]},qn.prototype.getClass=function(){return qn},Ui.INSERT.get=function(){return 1},Ui.DELETE.get=function(){return 2},Object.defineProperties(qn,Ui);var Gi=function(){};Gi.prototype.interfaces_=function(){return[]},Gi.prototype.getClass=function(){return Gi};var Nn=function(){this._hasIntersection=!1,this._hasProper=!1,this._hasProperInterior=!1,this._properIntersectionPoint=null,this._li=null,this._includeProper=null,this._recordIsolated=null,this._isSelfIntersection=null,this._numIntersections=0,this.numTests=0,this._bdyNodes=null,this._isDone=!1,this._isDoneWhenProperInt=!1;var o=arguments[0],s=arguments[1],d=arguments[2];this._li=o,this._includeProper=s,this._recordIsolated=d};Nn.prototype.isTrivialIntersection=function(o,s,d,_){if(o===d&&this._li.getIntersectionNum()===1){if(Nn.isAdjacentSegments(s,_))return!0;if(o.isClosed()){var w=o.getNumPoints()-1;if(s===0&&_===w||_===0&&s===w)return!0}}return!1},Nn.prototype.getProperIntersectionPoint=function(){return this._properIntersectionPoint},Nn.prototype.setIsDoneIfProperInt=function(o){this._isDoneWhenProperInt=o},Nn.prototype.hasProperInteriorIntersection=function(){return this._hasProperInterior},Nn.prototype.isBoundaryPointInternal=function(o,s){for(var d=s.iterator();d.hasNext();){var _=d.next().getCoordinate();if(o.isIntersection(_))return!0}return!1},Nn.prototype.hasProperIntersection=function(){return this._hasProper},Nn.prototype.hasIntersection=function(){return this._hasIntersection},Nn.prototype.isDone=function(){return this._isDone},Nn.prototype.isBoundaryPoint=function(o,s){return s!==null&&(!!this.isBoundaryPointInternal(o,s[0])||!!this.isBoundaryPointInternal(o,s[1]))},Nn.prototype.setBoundaryNodes=function(o,s){this._bdyNodes=new Array(2).fill(null),this._bdyNodes[0]=o,this._bdyNodes[1]=s},Nn.prototype.addIntersections=function(o,s,d,_){if(o===d&&s===_)return null;this.numTests++;var w=o.getCoordinates()[s],j=o.getCoordinates()[s+1],re=d.getCoordinates()[_],Pe=d.getCoordinates()[_+1];this._li.computeIntersection(w,j,re,Pe),this._li.hasIntersection()&&(this._recordIsolated&&(o.setIsolated(!1),d.setIsolated(!1)),this._numIntersections++,this.isTrivialIntersection(o,s,d,_)||(this._hasIntersection=!0,!this._includeProper&&this._li.isProper()||(o.addIntersections(this._li,s,0),d.addIntersections(this._li,_,1)),this._li.isProper()&&(this._properIntersectionPoint=this._li.getIntersection(0).copy(),this._hasProper=!0,this._isDoneWhenProperInt&&(this._isDone=!0),this.isBoundaryPoint(this._li,this._bdyNodes)||(this._hasProperInterior=!0))))},Nn.prototype.interfaces_=function(){return[]},Nn.prototype.getClass=function(){return Nn},Nn.isAdjacentSegments=function(o,s){return Math.abs(o-s)===1};var Yi=function(o){function s(){o.call(this),this.events=new Gr,this.nOverlaps=null}return o&&(s.__proto__=o),s.prototype=Object.create(o&&o.prototype),s.prototype.constructor=s,s.prototype.prepareEvents=function(){Ha.sort(this.events);for(var d=0;d<this.events.size();d++){var _=this.events.get(d);_.isDelete()&&_.getInsertEvent().setDeleteEventIndex(d)}},s.prototype.computeIntersections=function(){if(arguments.length===1){var d=arguments[0];this.nOverlaps=0,this.prepareEvents();for(var _=0;_<this.events.size();_++){var w=this.events.get(_);if(w.isInsert()&&this.processOverlaps(_,w.getDeleteEventIndex(),w,d),d.isDone())break}}else if(arguments.length===3){if(arguments[2]instanceof Nn&&Me(arguments[0],Oa)&&Me(arguments[1],Oa)){var j=arguments[0],re=arguments[1],Pe=arguments[2];this.addEdges(j,j),this.addEdges(re,re),this.computeIntersections(Pe)}else if(typeof arguments[2]=="boolean"&&Me(arguments[0],Oa)&&arguments[1]instanceof Nn){var tt=arguments[0],It=arguments[1];arguments[2]?this.addEdges(tt,null):this.addEdges(tt),this.computeIntersections(It)}}},s.prototype.addEdge=function(d,_){for(var w=d.getMonotoneChainEdge(),j=w.getStartIndexes(),re=0;re<j.length-1;re++){var Pe=new Li(w,re),tt=new qn(_,w.getMinX(re),Pe);this.events.add(tt),this.events.add(new qn(w.getMaxX(re),tt))}},s.prototype.processOverlaps=function(d,_,w,j){for(var re=w.getObject(),Pe=d;Pe<_;Pe++){var tt=this.events.get(Pe);if(tt.isInsert()){var It=tt.getObject();w.isSameLabel(tt)||(re.computeIntersections(It,j),this.nOverlaps++)}}},s.prototype.addEdges=function(){if(arguments.length===1)for(var d=arguments[0].iterator();d.hasNext();){var _=d.next();this.addEdge(_,_)}else if(arguments.length===2)for(var w=arguments[0],j=arguments[1],re=w.iterator();re.hasNext();){var Pe=re.next();this.addEdge(Pe,j)}},s.prototype.interfaces_=function(){return[]},s.prototype.getClass=function(){return s},s}(Gi),$n=function(){this._min=le.POSITIVE_INFINITY,this._max=le.NEGATIVE_INFINITY},Pi={NodeComparator:{configurable:!0}};$n.prototype.getMin=function(){return this._min},$n.prototype.intersects=function(o,s){return!(this._min>s||this._max<o)},$n.prototype.getMax=function(){return this._max},$n.prototype.toString=function(){return _n.toLineString(new Y(this._min,0),new Y(this._max,0))},$n.prototype.interfaces_=function(){return[]},$n.prototype.getClass=function(){return $n},Pi.NodeComparator.get=function(){return Oi},Object.defineProperties($n,Pi);var Oi=function(){};Oi.prototype.compare=function(o,s){var d=o,_=s,w=(d._min+d._max)/2,j=(_._min+_._max)/2;return w<j?-1:w>j?1:0},Oi.prototype.interfaces_=function(){return[ne]},Oi.prototype.getClass=function(){return Oi};var Qi=function(o){function s(){o.call(this),this._item=null;var d=arguments[0],_=arguments[1],w=arguments[2];this._min=d,this._max=_,this._item=w}return o&&(s.__proto__=o),s.prototype=Object.create(o&&o.prototype),s.prototype.constructor=s,s.prototype.query=function(d,_,w){if(!this.intersects(d,_))return null;w.visitItem(this._item)},s.prototype.interfaces_=function(){return[]},s.prototype.getClass=function(){return s},s}($n),qi=function(o){function s(){o.call(this),this._node1=null,this._node2=null;var d=arguments[0],_=arguments[1];this._node1=d,this._node2=_,this.buildExtent(this._node1,this._node2)}return o&&(s.__proto__=o),s.prototype=Object.create(o&&o.prototype),s.prototype.constructor=s,s.prototype.buildExtent=function(d,_){this._min=Math.min(d._min,_._min),this._max=Math.max(d._max,_._max)},s.prototype.query=function(d,_,w){if(!this.intersects(d,_))return null;this._node1!==null&&this._node1.query(d,_,w),this._node2!==null&&this._node2.query(d,_,w)},s.prototype.interfaces_=function(){return[]},s.prototype.getClass=function(){return s},s}($n),hi=function(){this._leaves=new Gr,this._root=null,this._level=0};hi.prototype.buildTree=function(){Ha.sort(this._leaves,new $n.NodeComparator);for(var o=this._leaves,s=null,d=new Gr;;){if(this.buildLevel(o,d),d.size()===1)return d.get(0);s=o,o=d,d=s}},hi.prototype.insert=function(o,s,d){if(this._root!==null)throw new Error("Index cannot be added to once it has been queried");this._leaves.add(new Qi(o,s,d))},hi.prototype.query=function(o,s,d){this.init(),this._root.query(o,s,d)},hi.prototype.buildRoot=function(){if(this._root!==null)return null;this._root=this.buildTree()},hi.prototype.printNode=function(o){Qr.out.println(_n.toLineString(new Y(o._min,this._level),new Y(o._max,this._level)))},hi.prototype.init=function(){if(this._root!==null)return null;this.buildRoot()},hi.prototype.buildLevel=function(o,s){this._level++,s.clear();for(var d=0;d<o.size();d+=2){var _=o.get(d);if((d+1<o.size()?o.get(d):null)===null)s.add(_);else{var w=new qi(o.get(d),o.get(d+1));s.add(w)}}},hi.prototype.interfaces_=function(){return[]},hi.prototype.getClass=function(){return hi};var Si=function(){this._items=new Gr};Si.prototype.visitItem=function(o){this._items.add(o)},Si.prototype.getItems=function(){return this._items},Si.prototype.interfaces_=function(){return[cu]},Si.prototype.getClass=function(){return Si};var Ci=function(){this._index=null;var o=arguments[0];if(!Me(o,Js))throw new Te("Argument must be Polygonal");this._index=new wu(o)},ji={SegmentVisitor:{configurable:!0},IntervalIndexedGeometry:{configurable:!0}};Ci.prototype.locate=function(o){var s=new Lt(o),d=new si(s);return this._index.query(o.y,o.y,d),s.getLocation()},Ci.prototype.interfaces_=function(){return[nu]},Ci.prototype.getClass=function(){return Ci},ji.SegmentVisitor.get=function(){return si},ji.IntervalIndexedGeometry.get=function(){return wu},Object.defineProperties(Ci,ji);var si=function(){this._counter=null;var o=arguments[0];this._counter=o};si.prototype.visitItem=function(o){var s=o;this._counter.countSegment(s.getCoordinate(0),s.getCoordinate(1))},si.prototype.interfaces_=function(){return[cu]},si.prototype.getClass=function(){return si};var wu=function(){this._index=new hi;var o=arguments[0];this.init(o)};wu.prototype.init=function(o){for(var s=_o.getLines(o).iterator();s.hasNext();){var d=s.next().getCoordinates();this.addLine(d)}},wu.prototype.addLine=function(o){for(var s=1;s<o.length;s++){var d=new Sn(o[s-1],o[s]),_=Math.min(d.p0.y,d.p1.y),w=Math.max(d.p0.y,d.p1.y);this._index.insert(_,w,d)}},wu.prototype.query=function(){if(arguments.length===2){var o=arguments[0],s=arguments[1],d=new Si;return this._index.query(o,s,d),d.getItems()}if(arguments.length===3){var _=arguments[0],w=arguments[1],j=arguments[2];this._index.query(_,w,j)}},wu.prototype.interfaces_=function(){return[]},wu.prototype.getClass=function(){return wu};var qo=function(o){function s(){if(o.call(this),this._parentGeom=null,this._lineEdgeMap=new Ll,this._boundaryNodeRule=null,this._useBoundaryDeterminationRule=!0,this._argIndex=null,this._boundaryNodes=null,this._hasTooFewPoints=!1,this._invalidPoint=null,this._areaPtLocator=null,this._ptLocator=new Cu,arguments.length===2){var d=arguments[0],_=arguments[1],w=Wr.OGC_SFS_BOUNDARY_RULE;this._argIndex=d,this._parentGeom=_,this._boundaryNodeRule=w,_!==null&&this.add(_)}else if(arguments.length===3){var j=arguments[0],re=arguments[1],Pe=arguments[2];this._argIndex=j,this._parentGeom=re,this._boundaryNodeRule=Pe,re!==null&&this.add(re)}}return o&&(s.__proto__=o),s.prototype=Object.create(o&&o.prototype),s.prototype.constructor=s,s.prototype.insertBoundaryPoint=function(d,_){var w=this._nodes.addNode(_).getLabel(),j=1;ge.NONE,w.getLocation(d,ce.ON)===ge.BOUNDARY&&j++;var re=s.determineBoundary(this._boundaryNodeRule,j);w.setLocation(d,re)},s.prototype.computeSelfNodes=function(){if(arguments.length===2){var d=arguments[0],_=arguments[1];return this.computeSelfNodes(d,_,!1)}if(arguments.length===3){var w=arguments[0],j=arguments[1],re=arguments[2],Pe=new Nn(w,!0,!1);Pe.setIsDoneIfProperInt(re);var tt=this.createEdgeSetIntersector(),It=this._parentGeom instanceof Mr||this._parentGeom instanceof Ca||this._parentGeom instanceof vn,tr=j||!It;return tt.computeIntersections(this._edges,Pe,tr),this.addSelfIntersectionNodes(this._argIndex),Pe}},s.prototype.computeSplitEdges=function(d){for(var _=this._edges.iterator();_.hasNext();)_.next().eiList.addSplitEdges(d)},s.prototype.computeEdgeIntersections=function(d,_,w){var j=new Nn(_,w,!0);return j.setBoundaryNodes(this.getBoundaryNodes(),d.getBoundaryNodes()),this.createEdgeSetIntersector().computeIntersections(this._edges,d._edges,j),j},s.prototype.getGeometry=function(){return this._parentGeom},s.prototype.getBoundaryNodeRule=function(){return this._boundaryNodeRule},s.prototype.hasTooFewPoints=function(){return this._hasTooFewPoints},s.prototype.addPoint=function(){if(arguments[0]instanceof uo){var d=arguments[0].getCoordinate();this.insertPoint(this._argIndex,d,ge.INTERIOR)}else if(arguments[0]instanceof Y){var _=arguments[0];this.insertPoint(this._argIndex,_,ge.INTERIOR)}},s.prototype.addPolygon=function(d){this.addPolygonRing(d.getExteriorRing(),ge.EXTERIOR,ge.INTERIOR);for(var _=0;_<d.getNumInteriorRing();_++){var w=d.getInteriorRingN(_);this.addPolygonRing(w,ge.INTERIOR,ge.EXTERIOR)}},s.prototype.addEdge=function(d){this.insertEdge(d);var _=d.getCoordinates();this.insertPoint(this._argIndex,_[0],ge.BOUNDARY),this.insertPoint(this._argIndex,_[_.length-1],ge.BOUNDARY)},s.prototype.addLineString=function(d){var _=xn.removeRepeatedPoints(d.getCoordinates());if(_.length<2)return this._hasTooFewPoints=!0,this._invalidPoint=_[0],null;var w=new kl(_,new Mn(this._argIndex,ge.INTERIOR));this._lineEdgeMap.put(d,w),this.insertEdge(w),Pt.isTrue(_.length>=2,"found LineString with single point"),this.insertBoundaryPoint(this._argIndex,_[0]),this.insertBoundaryPoint(this._argIndex,_[_.length-1])},s.prototype.getInvalidPoint=function(){return this._invalidPoint},s.prototype.getBoundaryPoints=function(){for(var d=this.getBoundaryNodes(),_=new Array(d.size()).fill(null),w=0,j=d.iterator();j.hasNext();){var re=j.next();_[w++]=re.getCoordinate().copy()}return _},s.prototype.getBoundaryNodes=function(){return this._boundaryNodes===null&&(this._boundaryNodes=this._nodes.getBoundaryNodes(this._argIndex)),this._boundaryNodes},s.prototype.addSelfIntersectionNode=function(d,_,w){if(this.isBoundaryNode(d,_))return null;w===ge.BOUNDARY&&this._useBoundaryDeterminationRule?this.insertBoundaryPoint(d,_):this.insertPoint(d,_,w)},s.prototype.addPolygonRing=function(d,_,w){if(d.isEmpty())return null;var j=xn.removeRepeatedPoints(d.getCoordinates());if(j.length<4)return this._hasTooFewPoints=!0,this._invalidPoint=j[0],null;var re=_,Pe=w;wt.isCCW(j)&&(re=w,Pe=_);var tt=new kl(j,new Mn(this._argIndex,ge.BOUNDARY,re,Pe));this._lineEdgeMap.put(d,tt),this.insertEdge(tt),this.insertPoint(this._argIndex,j[0],ge.BOUNDARY)},s.prototype.insertPoint=function(d,_,w){var j=this._nodes.addNode(_),re=j.getLabel();re===null?j._label=new Mn(d,w):re.setLocation(d,w)},s.prototype.createEdgeSetIntersector=function(){return new Yi},s.prototype.addSelfIntersectionNodes=function(d){for(var _=this._edges.iterator();_.hasNext();)for(var w=_.next(),j=w.getLabel().getLocation(d),re=w.eiList.iterator();re.hasNext();){var Pe=re.next();this.addSelfIntersectionNode(d,Pe.coord,j)}},s.prototype.add=function(){if(arguments.length!==1)return o.prototype.add.apply(this,arguments);var d=arguments[0];if(d.isEmpty())return null;if(d instanceof vn&&(this._useBoundaryDeterminationRule=!1),d instanceof Ca)this.addPolygon(d);else if(d instanceof ya)this.addLineString(d);else if(d instanceof uo)this.addPoint(d);else if(d instanceof uu)this.addCollection(d);else if(d instanceof Ni)this.addCollection(d);else if(d instanceof vn)this.addCollection(d);else{if(!(d instanceof Oo))throw new Error(d.getClass().getName());this.addCollection(d)}},s.prototype.addCollection=function(d){for(var _=0;_<d.getNumGeometries();_++){var w=d.getGeometryN(_);this.add(w)}},s.prototype.locate=function(d){return Me(this._parentGeom,Js)&&this._parentGeom.getNumGeometries()>50?(this._areaPtLocator===null&&(this._areaPtLocator=new Ci(this._parentGeom)),this._areaPtLocator.locate(d)):this._ptLocator.locate(d,this._parentGeom)},s.prototype.findEdge=function(){if(arguments.length===1){var d=arguments[0];return this._lineEdgeMap.get(d)}return o.prototype.findEdge.apply(this,arguments)},s.prototype.interfaces_=function(){return[]},s.prototype.getClass=function(){return s},s.determineBoundary=function(d,_){return d.isInBoundary(_)?ge.BOUNDARY:ge.INTERIOR},s}(wa),nl=function(){if(this._li=new $e,this._resultPrecisionModel=null,this._arg=null,arguments.length===1){var o=arguments[0];this.setComputationPrecision(o.getPrecisionModel()),this._arg=new Array(1).fill(null),this._arg[0]=new qo(0,o)}else if(arguments.length===2){var s=arguments[0],d=arguments[1],_=Wr.OGC_SFS_BOUNDARY_RULE;s.getPrecisionModel().compareTo(d.getPrecisionModel())>=0?this.setComputationPrecision(s.getPrecisionModel()):this.setComputationPrecision(d.getPrecisionModel()),this._arg=new Array(2).fill(null),this._arg[0]=new qo(0,s,_),this._arg[1]=new qo(1,d,_)}else if(arguments.length===3){var w=arguments[0],j=arguments[1],re=arguments[2];w.getPrecisionModel().compareTo(j.getPrecisionModel())>=0?this.setComputationPrecision(w.getPrecisionModel()):this.setComputationPrecision(j.getPrecisionModel()),this._arg=new Array(2).fill(null),this._arg[0]=new qo(0,w,re),this._arg[1]=new qo(1,j,re)}};nl.prototype.getArgGeometry=function(o){return this._arg[o].getGeometry()},nl.prototype.setComputationPrecision=function(o){this._resultPrecisionModel=o,this._li.setPrecisionModel(this._resultPrecisionModel)},nl.prototype.interfaces_=function(){return[]},nl.prototype.getClass=function(){return nl};var Zu=function(){};Zu.prototype.interfaces_=function(){return[]},Zu.prototype.getClass=function(){return Zu},Zu.map=function(){if(arguments[0]instanceof Tt&&Me(arguments[1],Zu.MapOp)){for(var o=arguments[0],s=arguments[1],d=new Gr,_=0;_<o.getNumGeometries();_++){var w=s.map(o.getGeometryN(_));w!==null&&d.add(w)}return o.getFactory().buildGeometry(d)}if(Me(arguments[0],li)&&Me(arguments[1],Zu.MapOp)){for(var j=arguments[0],re=arguments[1],Pe=new Gr,tt=j.iterator();tt.hasNext();){var It=tt.next(),tr=re.map(It);tr!==null&&Pe.add(tr)}return Pe}},Zu.MapOp=function(){};var Fn=function(o){function s(){var d=arguments[0],_=arguments[1];o.call(this,d,_),this._ptLocator=new Cu,this._geomFact=null,this._resultGeom=null,this._graph=null,this._edgeList=new Bo,this._resultPolyList=new Gr,this._resultLineList=new Gr,this._resultPointList=new Gr,this._graph=new wa(new tc),this._geomFact=d.getFactory()}return o&&(s.__proto__=o),s.prototype=Object.create(o&&o.prototype),s.prototype.constructor=s,s.prototype.insertUniqueEdge=function(d){var _=this._edgeList.findEqualEdge(d);if(_!==null){var w=_.getLabel(),j=d.getLabel();_.isPointwiseEqual(d)||(j=new Mn(d.getLabel())).flip();var re=_.getDepth();re.isNull()&&re.add(w),re.add(j),w.merge(j)}else this._edgeList.add(d)},s.prototype.getGraph=function(){return this._graph},s.prototype.cancelDuplicateResultEdges=function(){for(var d=this._graph.getEdgeEnds().iterator();d.hasNext();){var _=d.next(),w=_.getSym();_.isInResult()&&w.isInResult()&&(_.setInResult(!1),w.setInResult(!1))}},s.prototype.isCoveredByLA=function(d){return!!this.isCovered(d,this._resultLineList)||!!this.isCovered(d,this._resultPolyList)},s.prototype.computeGeometry=function(d,_,w,j){var re=new Gr;return re.addAll(d),re.addAll(_),re.addAll(w),re.isEmpty()?s.createEmptyResult(j,this._arg[0].getGeometry(),this._arg[1].getGeometry(),this._geomFact):this._geomFact.buildGeometry(re)},s.prototype.mergeSymLabels=function(){for(var d=this._graph.getNodes().iterator();d.hasNext();)d.next().getEdges().mergeSymLabels()},s.prototype.isCovered=function(d,_){for(var w=_.iterator();w.hasNext();){var j=w.next();if(this._ptLocator.locate(d,j)!==ge.EXTERIOR)return!0}return!1},s.prototype.replaceCollapsedEdges=function(){for(var d=new Gr,_=this._edgeList.iterator();_.hasNext();){var w=_.next();w.isCollapsed()&&(_.remove(),d.add(w.getCollapsedEdge()))}this._edgeList.addAll(d)},s.prototype.updateNodeLabelling=function(){for(var d=this._graph.getNodes().iterator();d.hasNext();){var _=d.next(),w=_.getEdges().getLabel();_.getLabel().merge(w)}},s.prototype.getResultGeometry=function(d){return this.computeOverlay(d),this._resultGeom},s.prototype.insertUniqueEdges=function(d){for(var _=d.iterator();_.hasNext();){var w=_.next();this.insertUniqueEdge(w)}},s.prototype.computeOverlay=function(d){this.copyPoints(0),this.copyPoints(1),this._arg[0].computeSelfNodes(this._li,!1),this._arg[1].computeSelfNodes(this._li,!1),this._arg[0].computeEdgeIntersections(this._arg[1],this._li,!0);var _=new Gr;this._arg[0].computeSplitEdges(_),this._arg[1].computeSplitEdges(_),this.insertUniqueEdges(_),this.computeLabelsFromDepths(),this.replaceCollapsedEdges(),nt.checkValid(this._edgeList.getEdges()),this._graph.addEdges(this._edgeList.getEdges()),this.computeLabelling(),this.labelIncompleteNodes(),this.findResultAreaEdges(d),this.cancelDuplicateResultEdges();var w=new In(this._geomFact);w.add(this._graph),this._resultPolyList=w.getPolygons();var j=new xa(this,this._geomFact,this._ptLocator);this._resultLineList=j.build(d);var re=new $s(this,this._geomFact,this._ptLocator);this._resultPointList=re.build(d),this._resultGeom=this.computeGeometry(this._resultPointList,this._resultLineList,this._resultPolyList,d)},s.prototype.labelIncompleteNode=function(d,_){var w=this._ptLocator.locate(d.getCoordinate(),this._arg[_].getGeometry());d.getLabel().setLocation(_,w)},s.prototype.copyPoints=function(d){for(var _=this._arg[d].getNodeIterator();_.hasNext();){var w=_.next();this._graph.addNode(w.getCoordinate()).setLabel(d,w.getLabel().getLocation(d))}},s.prototype.findResultAreaEdges=function(d){for(var _=this._graph.getEdgeEnds().iterator();_.hasNext();){var w=_.next(),j=w.getLabel();j.isArea()&&!w.isInteriorAreaEdge()&&s.isResultOfOp(j.getLocation(0,ce.RIGHT),j.getLocation(1,ce.RIGHT),d)&&w.setInResult(!0)}},s.prototype.computeLabelsFromDepths=function(){for(var d=this._edgeList.iterator();d.hasNext();){var _=d.next(),w=_.getLabel(),j=_.getDepth();if(!j.isNull()){j.normalize();for(var re=0;re<2;re++)w.isNull(re)||!w.isArea()||j.isNull(re)||(j.getDelta(re)===0?w.toLine(re):(Pt.isTrue(!j.isNull(re,ce.LEFT),"depth of LEFT side has not been initialized"),w.setLocation(re,ce.LEFT,j.getLocation(re,ce.LEFT)),Pt.isTrue(!j.isNull(re,ce.RIGHT),"depth of RIGHT side has not been initialized"),w.setLocation(re,ce.RIGHT,j.getLocation(re,ce.RIGHT))))}}},s.prototype.computeLabelling=function(){for(var d=this._graph.getNodes().iterator();d.hasNext();)d.next().getEdges().computeLabelling(this._arg);this.mergeSymLabels(),this.updateNodeLabelling()},s.prototype.labelIncompleteNodes=function(){for(var d=this._graph.getNodes().iterator();d.hasNext();){var _=d.next(),w=_.getLabel();_.isIsolated()&&(w.isNull(0)?this.labelIncompleteNode(_,0):this.labelIncompleteNode(_,1)),_.getEdges().updateLabelling(w)}},s.prototype.isCoveredByA=function(d){return!!this.isCovered(d,this._resultPolyList)},s.prototype.interfaces_=function(){return[]},s.prototype.getClass=function(){return s},s}(nl);Fn.overlayOp=function(o,s,d){return new Fn(o,s).getResultGeometry(d)},Fn.intersection=function(o,s){if(o.isEmpty()||s.isEmpty())return Fn.createEmptyResult(Fn.INTERSECTION,o,s,o.getFactory());if(o.isGeometryCollection()){var d=s;return rl.map(o,{interfaces_:function(){return[Zu.MapOp]},map:function(_){return _.intersection(d)}})}return o.checkNotGeometryCollection(o),o.checkNotGeometryCollection(s),Yn.overlayOp(o,s,Fn.INTERSECTION)},Fn.symDifference=function(o,s){if(o.isEmpty()||s.isEmpty()){if(o.isEmpty()&&s.isEmpty())return Fn.createEmptyResult(Fn.SYMDIFFERENCE,o,s,o.getFactory());if(o.isEmpty())return s.copy();if(s.isEmpty())return o.copy()}return o.checkNotGeometryCollection(o),o.checkNotGeometryCollection(s),Yn.overlayOp(o,s,Fn.SYMDIFFERENCE)},Fn.resultDimension=function(o,s,d){var _=s.getDimension(),w=d.getDimension(),j=-1;switch(o){case Fn.INTERSECTION:j=Math.min(_,w);break;case Fn.UNION:j=Math.max(_,w);break;case Fn.DIFFERENCE:j=_;break;case Fn.SYMDIFFERENCE:j=Math.max(_,w)}return j},Fn.createEmptyResult=function(o,s,d,_){var w=null;switch(Fn.resultDimension(o,s,d)){case-1:w=_.createGeometryCollection(new Array(0).fill(null));break;case 0:w=_.createPoint();break;case 1:w=_.createLineString();break;case 2:w=_.createPolygon()}return w},Fn.difference=function(o,s){return o.isEmpty()?Fn.createEmptyResult(Fn.DIFFERENCE,o,s,o.getFactory()):s.isEmpty()?o.copy():(o.checkNotGeometryCollection(o),o.checkNotGeometryCollection(s),Yn.overlayOp(o,s,Fn.DIFFERENCE))},Fn.isResultOfOp=function(){if(arguments.length===2){var o=arguments[0],s=arguments[1],d=o.getLocation(0),_=o.getLocation(1);return Fn.isResultOfOp(d,_,s)}if(arguments.length===3){var w=arguments[0],j=arguments[1],re=arguments[2];switch(w===ge.BOUNDARY&&(w=ge.INTERIOR),j===ge.BOUNDARY&&(j=ge.INTERIOR),re){case Fn.INTERSECTION:return w===ge.INTERIOR&&j===ge.INTERIOR;case Fn.UNION:return w===ge.INTERIOR||j===ge.INTERIOR;case Fn.DIFFERENCE:return w===ge.INTERIOR&&j!==ge.INTERIOR;case Fn.SYMDIFFERENCE:return w===ge.INTERIOR&&j!==ge.INTERIOR||w!==ge.INTERIOR&&j===ge.INTERIOR}return!1}},Fn.INTERSECTION=1,Fn.UNION=2,Fn.DIFFERENCE=3,Fn.SYMDIFFERENCE=4;var Ko=function(){this._g=null,this._boundaryDistanceTolerance=null,this._linework=null,this._ptLocator=new Cu,this._seg=new Sn;var o=arguments[0],s=arguments[1];this._g=o,this._boundaryDistanceTolerance=s,this._linework=this.extractLinework(o)};Ko.prototype.isWithinToleranceOfBoundary=function(o){for(var s=0;s<this._linework.getNumGeometries();s++)for(var d=this._linework.getGeometryN(s).getCoordinateSequence(),_=0;_<d.size()-1;_++)if(d.getCoordinate(_,this._seg.p0),d.getCoordinate(_+1,this._seg.p1),this._seg.distance(o)<=this._boundaryDistanceTolerance)return!0;return!1},Ko.prototype.getLocation=function(o){return this.isWithinToleranceOfBoundary(o)?ge.BOUNDARY:this._ptLocator.locate(o,this._g)},Ko.prototype.extractLinework=function(o){var s=new Ws;o.apply(s);var d=s.getLinework(),_=Ai.toLineStringArray(d);return o.getFactory().createMultiLineString(_)},Ko.prototype.interfaces_=function(){return[]},Ko.prototype.getClass=function(){return Ko};var Ws=function(){this._linework=null,this._linework=new Gr};Ws.prototype.getLinework=function(){return this._linework},Ws.prototype.filter=function(o){if(o instanceof Ca){var s=o;this._linework.add(s.getExteriorRing());for(var d=0;d<s.getNumInteriorRing();d++)this._linework.add(s.getInteriorRingN(d))}},Ws.prototype.interfaces_=function(){return[no]},Ws.prototype.getClass=function(){return Ws};var du=function(){this._g=null,this._doLeft=!0,this._doRight=!0;var o=arguments[0];this._g=o};du.prototype.extractPoints=function(o,s,d){for(var _=o.getCoordinates(),w=0;w<_.length-1;w++)this.computeOffsetPoints(_[w],_[w+1],s,d)},du.prototype.setSidesToGenerate=function(o,s){this._doLeft=o,this._doRight=s},du.prototype.getPoints=function(o){for(var s=new Gr,d=_o.getLines(this._g).iterator();d.hasNext();){var _=d.next();this.extractPoints(_,o,s)}return s},du.prototype.computeOffsetPoints=function(o,s,d,_){var w=s.x-o.x,j=s.y-o.y,re=Math.sqrt(w*w+j*j),Pe=d*w/re,tt=d*j/re,It=(s.x+o.x)/2,tr=(s.y+o.y)/2;if(this._doLeft){var ot=new Y(It-tt,tr+Pe);_.add(ot)}if(this._doRight){var Zt=new Y(It+tt,tr-Pe);_.add(Zt)}},du.prototype.interfaces_=function(){return[]},du.prototype.getClass=function(){return du};var gs=function o(){this._geom=null,this._locFinder=null,this._location=new Array(3).fill(null),this._invalidLocation=null,this._boundaryDistanceTolerance=o.TOLERANCE,this._testCoords=new Gr;var s=arguments[0],d=arguments[1],_=arguments[2];this._boundaryDistanceTolerance=o.computeBoundaryDistanceTolerance(s,d),this._geom=[s,d,_],this._locFinder=[new Ko(this._geom[0],this._boundaryDistanceTolerance),new Ko(this._geom[1],this._boundaryDistanceTolerance),new Ko(this._geom[2],this._boundaryDistanceTolerance)]},bl={TOLERANCE:{configurable:!0}};gs.prototype.reportResult=function(o,s,d){Qr.out.println("Overlay result invalid - A:"+ge.toLocationSymbol(s[0])+" B:"+ge.toLocationSymbol(s[1])+" expected:"+(d?"i":"e")+" actual:"+ge.toLocationSymbol(s[2]))},gs.prototype.isValid=function(o){this.addTestPts(this._geom[0]),this.addTestPts(this._geom[1]);var s=this.checkValid(o);return s},gs.prototype.checkValid=function(){if(arguments.length===1){for(var o=arguments[0],s=0;s<this._testCoords.size();s++){var d=this._testCoords.get(s);if(!this.checkValid(o,d))return this._invalidLocation=d,!1}return!0}if(arguments.length===2){var _=arguments[0],w=arguments[1];return this._location[0]=this._locFinder[0].getLocation(w),this._location[1]=this._locFinder[1].getLocation(w),this._location[2]=this._locFinder[2].getLocation(w),!!gs.hasLocation(this._location,ge.BOUNDARY)||this.isValidResult(_,this._location)}},gs.prototype.addTestPts=function(o){var s=new du(o);this._testCoords.addAll(s.getPoints(5*this._boundaryDistanceTolerance))},gs.prototype.isValidResult=function(o,s){var d=Fn.isResultOfOp(s[0],s[1],o),_=!(d^s[2]===ge.INTERIOR);return _||this.reportResult(o,s,d),_},gs.prototype.getInvalidLocation=function(){return this._invalidLocation},gs.prototype.interfaces_=function(){return[]},gs.prototype.getClass=function(){return gs},gs.hasLocation=function(o,s){for(var d=0;d<3;d++)if(o[d]===s)return!0;return!1},gs.computeBoundaryDistanceTolerance=function(o,s){return Math.min(bi.computeSizeBasedSnapTolerance(o),bi.computeSizeBasedSnapTolerance(s))},gs.isValid=function(o,s,d,_){return new gs(o,s,_).isValid(d)},bl.TOLERANCE.get=function(){return 1e-6},Object.defineProperties(gs,bl);var ms=function o(s){this._geomFactory=null,this._skipEmpty=!1,this._inputGeoms=null,this._geomFactory=o.extractFactory(s),this._inputGeoms=s};ms.prototype.extractElements=function(o,s){if(o===null)return null;for(var d=0;d<o.getNumGeometries();d++){var _=o.getGeometryN(d);this._skipEmpty&&_.isEmpty()||s.add(_)}},ms.prototype.combine=function(){for(var o=new Gr,s=this._inputGeoms.iterator();s.hasNext();){var d=s.next();this.extractElements(d,o)}return o.size()===0?this._geomFactory!==null?this._geomFactory.createGeometryCollection(null):null:this._geomFactory.buildGeometry(o)},ms.prototype.interfaces_=function(){return[]},ms.prototype.getClass=function(){return ms},ms.combine=function(){if(arguments.length===1){var o=arguments[0];return new ms(o).combine()}if(arguments.length===2){var s=arguments[0],d=arguments[1];return new ms(ms.createList(s,d)).combine()}if(arguments.length===3){var _=arguments[0],w=arguments[1],j=arguments[2];return new ms(ms.createList(_,w,j)).combine()}},ms.extractFactory=function(o){return o.isEmpty()?null:o.iterator().next().getFactory()},ms.createList=function(){if(arguments.length===2){var o=arguments[0],s=arguments[1],d=new Gr;return d.add(o),d.add(s),d}if(arguments.length===3){var _=arguments[0],w=arguments[1],j=arguments[2],re=new Gr;return re.add(_),re.add(w),re.add(j),re}};var ka=function(){this._inputPolys=null,this._geomFactory=null;var o=arguments[0];this._inputPolys=o,this._inputPolys===null&&(this._inputPolys=new Gr)},il={STRTREE_NODE_CAPACITY:{configurable:!0}};ka.prototype.reduceToGeometries=function(o){for(var s=new Gr,d=o.iterator();d.hasNext();){var _=d.next(),w=null;Me(_,Oa)?w=this.unionTree(_):_ instanceof Tt&&(w=_),s.add(w)}return s},ka.prototype.extractByEnvelope=function(o,s,d){for(var _=new Gr,w=0;w<s.getNumGeometries();w++){var j=s.getGeometryN(w);j.getEnvelopeInternal().intersects(o)?_.add(j):d.add(j)}return this._geomFactory.buildGeometry(_)},ka.prototype.unionOptimized=function(o,s){var d=o.getEnvelopeInternal(),_=s.getEnvelopeInternal();if(!d.intersects(_))return ms.combine(o,s);if(o.getNumGeometries()<=1&&s.getNumGeometries()<=1)return this.unionActual(o,s);var w=d.intersection(_);return this.unionUsingEnvelopeIntersection(o,s,w)},ka.prototype.union=function(){if(this._inputPolys===null)throw new Error("union() method cannot be called twice");if(this._inputPolys.isEmpty())return null;this._geomFactory=this._inputPolys.iterator().next().getFactory();for(var o=new Qc(ka.STRTREE_NODE_CAPACITY),s=this._inputPolys.iterator();s.hasNext();){var d=s.next();o.insert(d.getEnvelopeInternal(),d)}this._inputPolys=null;var _=o.itemsTree();return this.unionTree(_)},ka.prototype.binaryUnion=function(){if(arguments.length===1){var o=arguments[0];return this.binaryUnion(o,0,o.size())}if(arguments.length===3){var s=arguments[0],d=arguments[1],_=arguments[2];if(_-d<=1){var w=ka.getGeometry(s,d);return this.unionSafe(w,null)}if(_-d==2)return this.unionSafe(ka.getGeometry(s,d),ka.getGeometry(s,d+1));var j=Math.trunc((_+d)/2),re=this.binaryUnion(s,d,j),Pe=this.binaryUnion(s,j,_);return this.unionSafe(re,Pe)}},ka.prototype.repeatedUnion=function(o){for(var s=null,d=o.iterator();d.hasNext();){var _=d.next();s=s===null?_.copy():s.union(_)}return s},ka.prototype.unionSafe=function(o,s){return o===null&&s===null?null:o===null?s.copy():s===null?o.copy():this.unionOptimized(o,s)},ka.prototype.unionActual=function(o,s){return ka.restrictToPolygons(o.union(s))},ka.prototype.unionTree=function(o){var s=this.reduceToGeometries(o);return this.binaryUnion(s)},ka.prototype.unionUsingEnvelopeIntersection=function(o,s,d){var _=new Gr,w=this.extractByEnvelope(d,o,_),j=this.extractByEnvelope(d,s,_),re=this.unionActual(w,j);return _.add(re),ms.combine(_)},ka.prototype.bufferUnion=function(){if(arguments.length===1){var o=arguments[0];return o.get(0).getFactory().buildGeometry(o).buffer(0)}if(arguments.length===2){var s=arguments[0],d=arguments[1];return s.getFactory().createGeometryCollection([s,d]).buffer(0)}},ka.prototype.interfaces_=function(){return[]},ka.prototype.getClass=function(){return ka},ka.restrictToPolygons=function(o){if(Me(o,Js))return o;var s=pu.getPolygons(o);return s.size()===1?s.get(0):o.getFactory().createMultiPolygon(Ai.toPolygonArray(s))},ka.getGeometry=function(o,s){return s>=o.size()?null:o.get(s)},ka.union=function(o){return new ka(o).union()},il.STRTREE_NODE_CAPACITY.get=function(){return 4},Object.defineProperties(ka,il);var ef=function(){};ef.prototype.interfaces_=function(){return[]},ef.prototype.getClass=function(){return ef},ef.union=function(o,s){if(o.isEmpty()||s.isEmpty()){if(o.isEmpty()&&s.isEmpty())return Fn.createEmptyResult(Fn.UNION,o,s,o.getFactory());if(o.isEmpty())return s.copy();if(s.isEmpty())return o.copy()}return o.checkNotGeometryCollection(o),o.checkNotGeometryCollection(s),Yn.overlayOp(o,s,Fn.UNION)},C.GeoJSONReader=Ve,C.GeoJSONWriter=Gt,C.OverlayOp=Fn,C.UnionOp=ef,C.BufferOp=wo,Object.defineProperty(C,"__esModule",{value:!0})})},96026:function(se,$,C){var P=C(10574)();se.exports=P;try{regeneratorRuntime=P}catch(D){typeof globalThis=="object"?globalThis.regeneratorRuntime=P:Function("r","regeneratorRuntime = r")(P)}},39511:function(se,$,C){"use strict";C.d($,{Z:function(){return D}});var P=C(8822);function D(G,Z){Z===void 0&&(Z={});var F=Number(G[0]),z=Number(G[1]),q=Number(G[2]),ee=Number(G[3]);if(G.length===6)throw new Error("@turf/bbox-polygon does not support BBox with 6 positions");var fe=[F,z],be=[F,ee],Ie=[q,ee],Oe=[q,z];return(0,P.yu)([[fe,Oe,Ie,be,fe]],Z.properties,{bbox:G,id:Z.id})}},86461:function(se,$,C){"use strict";var P=C(94169);function D(G){var Z=[1/0,1/0,-1/0,-1/0];return(0,P.pZ)(G,function(F){Z[0]>F[0]&&(Z[0]=F[0]),Z[1]>F[1]&&(Z[1]=F[1]),Z[2]<F[0]&&(Z[2]=F[0]),Z[3]<F[1]&&(Z[3]=F[1])}),Z}D.default=D,$.Z=D},8822:function(se,$,C){"use strict";C.d($,{Tu:function(){return Ie},ot:function(){return De},tw:function(){return je},uf:function(){return He},xm:function(){return q},yu:function(){return fe},zL:function(){return F}});var P=63710088e-1,D={centimeters:P*100,centimetres:P*100,degrees:P/111325,feet:P*3.28084,inches:P*39.37,kilometers:P/1e3,kilometres:P/1e3,meters:P,metres:P,miles:P/1609.344,millimeters:P*1e3,millimetres:P*1e3,nauticalmiles:P/1852,radians:1,yards:P*1.0936},G={centimeters:100,centimetres:100,degrees:1/111325,feet:3.28084,inches:39.37,kilometers:1/1e3,kilometres:1/1e3,meters:1,metres:1,miles:1/1609.344,millimeters:1e3,millimetres:1e3,nauticalmiles:1/1852,radians:1/P,yards:1.0936133},Z={acres:247105e-9,centimeters:1e4,centimetres:1e4,feet:10.763910417,hectares:1e-4,inches:1550.003100006,kilometers:1e-6,kilometres:1e-6,meters:1,metres:1,miles:386e-9,millimeters:1e6,millimetres:1e6,yards:1.195990046};function F(Ae,me,ue){ue===void 0&&(ue={});var ke={type:"Feature"};return(ue.id===0||ue.id)&&(ke.id=ue.id),ue.bbox&&(ke.bbox=ue.bbox),ke.properties=me||{},ke.geometry=Ae,ke}function z(Ae,me,ue){switch(ue===void 0&&(ue={}),Ae){case"Point":return q(me).geometry;case"LineString":return Ie(me).geometry;case"Polygon":return fe(me).geometry;case"MultiPoint":return De(me).geometry;case"MultiLineString":return st(me).geometry;case"MultiPolygon":return je(me).geometry;default:throw new Error(Ae+" is invalid")}}function q(Ae,me,ue){if(ue===void 0&&(ue={}),!Ae)throw new Error("coordinates is required");if(!Array.isArray(Ae))throw new Error("coordinates must be an Array");if(Ae.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!Ee(Ae[0])||!Ee(Ae[1]))throw new Error("coordinates must contain numbers");var ke={type:"Point",coordinates:Ae};return F(ke,me,ue)}function ee(Ae,me,ue){return ue===void 0&&(ue={}),He(Ae.map(function(ke){return q(ke,me)}),ue)}function fe(Ae,me,ue){ue===void 0&&(ue={});for(var ke=0,Ze=Ae;ke<Ze.length;ke++){var oe=Ze[ke];if(oe.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var Dt=0;Dt<oe[oe.length-1].length;Dt++)if(oe[oe.length-1][Dt]!==oe[0][Dt])throw new Error("First and last Position are not equivalent.")}var Rt={type:"Polygon",coordinates:Ae};return F(Rt,me,ue)}function be(Ae,me,ue){return ue===void 0&&(ue={}),He(Ae.map(function(ke){return fe(ke,me)}),ue)}function Ie(Ae,me,ue){if(ue===void 0&&(ue={}),Ae.length<2)throw new Error("coordinates must be an array of two or more positions");var ke={type:"LineString",coordinates:Ae};return F(ke,me,ue)}function Oe(Ae,me,ue){return ue===void 0&&(ue={}),He(Ae.map(function(ke){return Ie(ke,me)}),ue)}function He(Ae,me){me===void 0&&(me={});var ue={type:"FeatureCollection"};return me.id&&(ue.id=me.id),me.bbox&&(ue.bbox=me.bbox),ue.features=Ae,ue}function st(Ae,me,ue){ue===void 0&&(ue={});var ke={type:"MultiLineString",coordinates:Ae};return F(ke,me,ue)}function De(Ae,me,ue){ue===void 0&&(ue={});var ke={type:"MultiPoint",coordinates:Ae};return F(ke,me,ue)}function je(Ae,me,ue){ue===void 0&&(ue={});var ke={type:"MultiPolygon",coordinates:Ae};return F(ke,me,ue)}function we(Ae,me,ue){ue===void 0&&(ue={});var ke={type:"GeometryCollection",geometries:Ae};return F(ke,me,ue)}function Te(Ae,me){if(me===void 0&&(me=0),me&&!(me>=0))throw new Error("precision must be a positive number");var ue=Math.pow(10,me||0);return Math.round(Ae*ue)/ue}function le(Ae,me){me===void 0&&(me="kilometers");var ue=D[me];if(!ue)throw new Error(me+" units is invalid");return Ae*ue}function Re(Ae,me){me===void 0&&(me="kilometers");var ue=D[me];if(!ue)throw new Error(me+" units is invalid");return Ae/ue}function ye(Ae,me){return ne(Re(Ae,me))}function _e(Ae){var me=Ae%360;return me<0&&(me+=360),me}function ne(Ae){var me=Ae%(2*Math.PI);return me*180/Math.PI}function Y(Ae){var me=Ae%360;return me*Math.PI/180}function Le(Ae,me,ue){if(me===void 0&&(me="kilometers"),ue===void 0&&(ue="kilometers"),!(Ae>=0))throw new Error("length must be a positive number");return le(Re(Ae,me),ue)}function de(Ae,me,ue){if(me===void 0&&(me="meters"),ue===void 0&&(ue="kilometers"),!(Ae>=0))throw new Error("area must be a positive number");var ke=Z[me];if(!ke)throw new Error("invalid original units");var Ze=Z[ue];if(!Ze)throw new Error("invalid final units");return Ae/ke*Ze}function Ee(Ae){return!isNaN(Ae)&&Ae!==null&&!Array.isArray(Ae)}function ge(Ae){return!!Ae&&Ae.constructor===Object}function X(Ae){if(!Ae)throw new Error("bbox is required");if(!Array.isArray(Ae))throw new Error("bbox must be an Array");if(Ae.length!==4&&Ae.length!==6)throw new Error("bbox must be an Array of 4 or 6 numbers");Ae.forEach(function(me){if(!Ee(me))throw new Error("bbox must only contain numbers")})}function Me(Ae){if(!Ae)throw new Error("id is required");if(["string","number"].indexOf(typeof Ae)===-1)throw new Error("id must be a number or a string")}},8014:function(se,$,C){"use strict";C.d($,{c9:function(){return D},nK:function(){return z},r7:function(){return G},wA:function(){return ee}});var P=C(8822);function D(be){if(!be)throw new Error("coord is required");if(!Array.isArray(be)){if(be.type==="Feature"&&be.geometry!==null&&be.geometry.type==="Point")return be.geometry.coordinates;if(be.type==="Point")return be.coordinates}if(Array.isArray(be)&&be.length>=2&&!Array.isArray(be[0])&&!Array.isArray(be[1]))return be;throw new Error("coord must be GeoJSON Point or an Array of numbers")}function G(be){if(Array.isArray(be))return be;if(be.type==="Feature"){if(be.geometry!==null)return be.geometry.coordinates}else if(be.coordinates)return be.coordinates;throw new Error("coords must be GeoJSON Feature, Geometry Object or an Array")}function Z(be){if(be.length>1&&isNumber(be[0])&&isNumber(be[1]))return!0;if(Array.isArray(be[0])&&be[0].length)return Z(be[0]);throw new Error("coordinates must only contain numbers")}function F(be,Ie,Oe){if(!Ie||!Oe)throw new Error("type and name required");if(!be||be.type!==Ie)throw new Error("Invalid input to "+Oe+": must be a "+Ie+", given "+be.type)}function z(be,Ie,Oe){if(!be)throw new Error("No feature passed");if(!Oe)throw new Error(".featureOf() requires a name");if(!be||be.type!=="Feature"||!be.geometry)throw new Error("Invalid input to "+Oe+", Feature with geometry required");if(!be.geometry||be.geometry.type!==Ie)throw new Error("Invalid input to "+Oe+": must be a "+Ie+", given "+be.geometry.type)}function q(be,Ie,Oe){if(!be)throw new Error("No featureCollection passed");if(!Oe)throw new Error(".collectionOf() requires a name");if(!be||be.type!=="FeatureCollection")throw new Error("Invalid input to "+Oe+", FeatureCollection required");for(var He=0,st=be.features;He<st.length;He++){var De=st[He];if(!De||De.type!=="Feature"||!De.geometry)throw new Error("Invalid input to "+Oe+", Feature with geometry required");if(!De.geometry||De.geometry.type!==Ie)throw new Error("Invalid input to "+Oe+": must be a "+Ie+", given "+De.geometry.type)}}function ee(be){return be.type==="Feature"?be.geometry:be}function fe(be,Ie){return be.type==="FeatureCollection"?"FeatureCollection":be.type==="GeometryCollection"?"GeometryCollection":be.type==="Feature"&&be.geometry!==null?be.geometry.type:be.type}},94169:function(se,$,C){"use strict";C.d($,{Lo:function(){return G},nG:function(){return Ie},pZ:function(){return D}});var P=C(8822);function D(le,Re,ye){if(le!==null)for(var _e,ne,Y,Le,de,Ee,ge,X=0,Me=0,Ae,me=le.type,ue=me==="FeatureCollection",ke=me==="Feature",Ze=ue?le.features.length:1,oe=0;oe<Ze;oe++){ge=ue?le.features[oe].geometry:ke?le.geometry:le,Ae=ge?ge.type==="GeometryCollection":!1,de=Ae?ge.geometries.length:1;for(var Dt=0;Dt<de;Dt++){var Rt=0,cr=0;if(Le=Ae?ge.geometries[Dt]:ge,Le!==null){Ee=Le.coordinates;var Ut=Le.type;switch(X=ye&&(Ut==="Polygon"||Ut==="MultiPolygon")?1:0,Ut){case null:break;case"Point":if(Re(Ee,Me,oe,Rt,cr)===!1)return!1;Me++,Rt++;break;case"LineString":case"MultiPoint":for(_e=0;_e<Ee.length;_e++){if(Re(Ee[_e],Me,oe,Rt,cr)===!1)return!1;Me++,Ut==="MultiPoint"&&Rt++}Ut==="LineString"&&Rt++;break;case"Polygon":case"MultiLineString":for(_e=0;_e<Ee.length;_e++){for(ne=0;ne<Ee[_e].length-X;ne++){if(Re(Ee[_e][ne],Me,oe,Rt,cr)===!1)return!1;Me++}Ut==="MultiLineString"&&Rt++,Ut==="Polygon"&&cr++}Ut==="Polygon"&&Rt++;break;case"MultiPolygon":for(_e=0;_e<Ee.length;_e++){for(cr=0,ne=0;ne<Ee[_e].length;ne++){for(Y=0;Y<Ee[_e][ne].length-X;Y++){if(Re(Ee[_e][ne][Y],Me,oe,Rt,cr)===!1)return!1;Me++}cr++}Rt++}break;case"GeometryCollection":for(_e=0;_e<Le.geometries.length;_e++)if(D(Le.geometries[_e],Re,ye)===!1)return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function G(le,Re,ye,_e){var ne=ye;return D(le,function(Y,Le,de,Ee,ge){Le===0&&ye===void 0?ne=Y:ne=Re(ne,Y,Le,de,Ee,ge)},_e),ne}function Z(le,Re){var ye;switch(le.type){case"FeatureCollection":for(ye=0;ye<le.features.length&&Re(le.features[ye].properties,ye)!==!1;ye++);break;case"Feature":Re(le.properties,0);break}}function F(le,Re,ye){var _e=ye;return Z(le,function(ne,Y){Y===0&&ye===void 0?_e=ne:_e=Re(_e,ne,Y)}),_e}function z(le,Re){if(le.type==="Feature")Re(le,0);else if(le.type==="FeatureCollection")for(var ye=0;ye<le.features.length&&Re(le.features[ye],ye)!==!1;ye++);}function q(le,Re,ye){var _e=ye;return z(le,function(ne,Y){Y===0&&ye===void 0?_e=ne:_e=Re(_e,ne,Y)}),_e}function ee(le){var Re=[];return D(le,function(ye){Re.push(ye)}),Re}function fe(le,Re){var ye,_e,ne,Y,Le,de,Ee,ge,X,Me,Ae=0,me=le.type==="FeatureCollection",ue=le.type==="Feature",ke=me?le.features.length:1;for(ye=0;ye<ke;ye++){for(de=me?le.features[ye].geometry:ue?le.geometry:le,ge=me?le.features[ye].properties:ue?le.properties:{},X=me?le.features[ye].bbox:ue?le.bbox:void 0,Me=me?le.features[ye].id:ue?le.id:void 0,Ee=de?de.type==="GeometryCollection":!1,Le=Ee?de.geometries.length:1,ne=0;ne<Le;ne++){if(Y=Ee?de.geometries[ne]:de,Y===null){if(Re(null,Ae,ge,X,Me)===!1)return!1;continue}switch(Y.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":{if(Re(Y,Ae,ge,X,Me)===!1)return!1;break}case"GeometryCollection":{for(_e=0;_e<Y.geometries.length;_e++)if(Re(Y.geometries[_e],Ae,ge,X,Me)===!1)return!1;break}default:throw new Error("Unknown Geometry Type")}}Ae++}}function be(le,Re,ye){var _e=ye;return fe(le,function(ne,Y,Le,de,Ee){Y===0&&ye===void 0?_e=ne:_e=Re(_e,ne,Y,Le,de,Ee)}),_e}function Ie(le,Re){fe(le,function(ye,_e,ne,Y,Le){var de=ye===null?null:ye.type;switch(de){case null:case"Point":case"LineString":case"Polygon":return Re((0,P.zL)(ye,ne,{bbox:Y,id:Le}),_e,0)===!1?!1:void 0}var Ee;switch(de){case"MultiPoint":Ee="Point";break;case"MultiLineString":Ee="LineString";break;case"MultiPolygon":Ee="Polygon";break}for(var ge=0;ge<ye.coordinates.length;ge++){var X=ye.coordinates[ge],Me={type:Ee,coordinates:X};if(Re((0,P.zL)(Me,ne),_e,ge)===!1)return!1}})}function Oe(le,Re,ye){var _e=ye;return Ie(le,function(ne,Y,Le){Y===0&&Le===0&&ye===void 0?_e=ne:_e=Re(_e,ne,Y,Le)}),_e}function He(le,Re){Ie(le,function(ye,_e,ne){var Y=0;if(ye.geometry){var Le=ye.geometry.type;if(!(Le==="Point"||Le==="MultiPoint")){var de,Ee=0,ge=0,X=0;if(D(ye,function(Me,Ae,me,ue,ke){if(de===void 0||_e>Ee||ue>ge||ke>X){de=Me,Ee=_e,ge=ue,X=ke,Y=0;return}var Ze=lineString([de,Me],ye.properties);if(Re(Ze,_e,ne,ke,Y)===!1)return!1;Y++,de=Me})===!1)return!1}}})}function st(le,Re,ye){var _e=ye,ne=!1;return He(le,function(Y,Le,de,Ee,ge){ne===!1&&ye===void 0?_e=Y:_e=Re(_e,Y,Le,de,Ee,ge),ne=!0}),_e}function De(le,Re){if(!le)throw new Error("geojson is required");Ie(le,function(ye,_e,ne){if(ye.geometry!==null){var Y=ye.geometry.type,Le=ye.geometry.coordinates;switch(Y){case"LineString":if(Re(ye,_e,ne,0,0)===!1)return!1;break;case"Polygon":for(var de=0;de<Le.length;de++)if(Re(lineString(Le[de],ye.properties),_e,ne,de)===!1)return!1;break}}})}function je(le,Re,ye){var _e=ye;return De(le,function(ne,Y,Le,de){Y===0&&ye===void 0?_e=ne:_e=Re(_e,ne,Y,Le,de)}),_e}function we(le,Re){if(Re=Re||{},!isObject(Re))throw new Error("options is invalid");var ye=Re.featureIndex||0,_e=Re.multiFeatureIndex||0,ne=Re.geometryIndex||0,Y=Re.segmentIndex||0,Le=Re.properties,de;switch(le.type){case"FeatureCollection":ye<0&&(ye=le.features.length+ye),Le=Le||le.features[ye].properties,de=le.features[ye].geometry;break;case"Feature":Le=Le||le.properties,de=le.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":de=le;break;default:throw new Error("geojson is invalid")}if(de===null)return null;var Ee=de.coordinates;switch(de.type){case"Point":case"MultiPoint":return null;case"LineString":return Y<0&&(Y=Ee.length+Y-1),lineString([Ee[Y],Ee[Y+1]],Le,Re);case"Polygon":return ne<0&&(ne=Ee.length+ne),Y<0&&(Y=Ee[ne].length+Y-1),lineString([Ee[ne][Y],Ee[ne][Y+1]],Le,Re);case"MultiLineString":return _e<0&&(_e=Ee.length+_e),Y<0&&(Y=Ee[_e].length+Y-1),lineString([Ee[_e][Y],Ee[_e][Y+1]],Le,Re);case"MultiPolygon":return _e<0&&(_e=Ee.length+_e),ne<0&&(ne=Ee[_e].length+ne),Y<0&&(Y=Ee[_e][ne].length-Y-1),lineString([Ee[_e][ne][Y],Ee[_e][ne][Y+1]],Le,Re)}throw new Error("geojson is invalid")}function Te(le,Re){if(Re=Re||{},!isObject(Re))throw new Error("options is invalid");var ye=Re.featureIndex||0,_e=Re.multiFeatureIndex||0,ne=Re.geometryIndex||0,Y=Re.coordIndex||0,Le=Re.properties,de;switch(le.type){case"FeatureCollection":ye<0&&(ye=le.features.length+ye),Le=Le||le.features[ye].properties,de=le.features[ye].geometry;break;case"Feature":Le=Le||le.properties,de=le.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":de=le;break;default:throw new Error("geojson is invalid")}if(de===null)return null;var Ee=de.coordinates;switch(de.type){case"Point":return point(Ee,Le,Re);case"MultiPoint":return _e<0&&(_e=Ee.length+_e),point(Ee[_e],Le,Re);case"LineString":return Y<0&&(Y=Ee.length+Y),point(Ee[Y],Le,Re);case"Polygon":return ne<0&&(ne=Ee.length+ne),Y<0&&(Y=Ee[ne].length+Y),point(Ee[ne][Y],Le,Re);case"MultiLineString":return _e<0&&(_e=Ee.length+_e),Y<0&&(Y=Ee[_e].length+Y),point(Ee[_e][Y],Le,Re);case"MultiPolygon":return _e<0&&(_e=Ee.length+_e),ne<0&&(ne=Ee[_e].length+ne),Y<0&&(Y=Ee[_e][ne].length-Y),point(Ee[_e][ne][Y],Le,Re)}throw new Error("geojson is invalid")}},80262:function(se,$,C){"use strict";C.d($,{uf4:function(){return Z.uf},yue:function(){return Z.yu}});var P=C(86461),D=C(94169),G=C(8014),Z=C(8822),F=C(84126);var z={successCallback:null,verbose:!1},q={};function ee(l,A,y){y=y||{};for(var b=Object.keys(z),T=0;T<b.length;T++){var L=b[T],R=y[L];R=typeof R!="undefined"&&R!==null?R:z[L],q[L]=R}q.verbose&&console.log("MarchingSquaresJS-isoContours: computing isocontour for "+A);var U=De(be(l,A));return typeof q.successCallback=="function"&&q.successCallback(U),U}function fe(l,A,y){return(l-A)/(y-A)}function be(l,A){for(var y=l.length-1,b=l[0].length-1,T={rows:y,cols:b,cells:[]},L=0;L<y;++L){T.cells[L]=[];for(var R=0;R<b;++R){var U=0,H=l[L+1][R],N=l[L+1][R+1],Q=l[L][R+1],K=l[L][R];if(!(isNaN(H)||isNaN(N)||isNaN(Q)||isNaN(K))){U|=H>=A?8:0,U|=N>=A?4:0,U|=Q>=A?2:0,U|=K>=A?1:0;var ie=!1;if(U===5||U===10){var pe=(H+N+Q+K)/4;U===5&&pe<A?(U=10,ie=!0):U===10&&pe<A&&(U=5,ie=!0)}if(U!==0&&U!==15){var pt,it,Nt,dt;pt=it=Nt=dt=.5,U===1?(Nt=1-fe(A,H,K),it=1-fe(A,Q,K)):U===2?(it=fe(A,K,Q),dt=1-fe(A,N,Q)):U===3?(Nt=1-fe(A,H,K),dt=1-fe(A,N,Q)):U===4?(pt=fe(A,H,N),dt=fe(A,Q,N)):U===5?(pt=fe(A,H,N),dt=fe(A,Q,N),it=1-fe(A,Q,K),Nt=1-fe(A,H,K)):U===6?(it=fe(A,K,Q),pt=fe(A,H,N)):U===7?(Nt=1-fe(A,H,K),pt=fe(A,H,N)):U===8?(Nt=fe(A,K,H),pt=1-fe(A,N,H)):U===9?(it=1-fe(A,Q,K),pt=1-fe(A,N,H)):U===10?(pt=1-fe(A,N,H),dt=1-fe(A,N,Q),it=fe(A,K,Q),Nt=fe(A,K,H)):U===11?(pt=1-fe(A,N,H),dt=1-fe(A,N,Q)):U===12?(Nt=fe(A,K,H),dt=fe(A,Q,N)):U===13?(it=1-fe(A,Q,K),dt=fe(A,Q,N)):U===14?(Nt=fe(A,K,H),it=fe(A,K,Q)):console.log("MarchingSquaresJS-isoContours: Illegal cval detected: "+U),T.cells[L][R]={cval:U,flipped:ie,top:pt,right:dt,bottom:it,left:Nt}}}}}return T}function Ie(l){return l.cval===5||l.cval===10}function Oe(l){return l.cval===0||l.cval===15}function He(l){!Oe(l)&&l.cval!==5&&l.cval!==10&&(l.cval=15)}function st(l,A){if(A==="top")return[l.top,1];if(A==="bottom")return[l.bottom,0];if(A==="right")return[1,l.right];if(A==="left")return[0,l.left]}function De(l){var A=[],y=0,b=1e-7;return l.cells.forEach(function(T,L){T.forEach(function(R,U){if(typeof R!="undefined"&&!Ie(R)&&!Oe(R)){var H=je(l.cells,L,U),N=!1;if(H.info==="mergeable"){for(var Q=H.path[H.path.length-1][0],K=H.path[H.path.length-1][1],ie=y-1;ie>=0;ie--)if(Math.abs(A[ie][0][0]-Q)<=b&&Math.abs(A[ie][0][1]-K)<=b){for(var pe=H.path.length-2;pe>=0;--pe)A[ie].unshift(H.path[pe]);N=!0;break}}N||(A[y++]=H.path)}})}),A}function je(l,A,y){var b=l.length,T=[],L=[0,0,1,1,0,0,0,0,-1,0,1,1,-1,0,-1,0],R=[0,-1,0,0,1,1,1,1,0,-1,0,0,0,-1,0,0],U,H,N=["none","left","bottom","left","right","none","bottom","left","top","top","none","top","right","right","bottom","none"],Q=["none","bottom","right","right","top","top","top","top","left","bottom","right","right","left","bottom","left","none"],pe,K=l[A][y],ie=K.cval,pe=N[ie],pt=st(K,pe);T.push([y+pt[0],A+pt[1]]),pe=Q[ie],pt=st(K,pe),T.push([y+pt[0],A+pt[1]]),He(K);for(var it=y+L[ie],Nt=A+R[ie],dt=ie;it>=0&&Nt>=0&&Nt<b&&(it!=y||Nt!=A)&&(K=l[Nt][it],typeof K!="undefined");){if(ie=K.cval,ie===0||ie===15)return{path:T,info:"mergeable"};pe=Q[ie],U=L[ie],H=R[ie],(ie===5||ie===10)&&(ie===5?K.flipped?R[dt]===-1?(pe="left",U=-1,H=0):(pe="right",U=1,H=0):L[dt]===-1&&(pe="bottom",U=0,H=-1):ie===10&&(K.flipped?L[dt]===-1?(pe="top",U=0,H=1):(pe="bottom",U=0,H=-1):R[dt]===1&&(pe="left",U=-1,H=0))),pt=st(K,pe),T.push([it+pt[0],Nt+pt[1]]),He(K),it+=U,Nt+=H,dt=ie}return{path:T,info:"closed"}}function we(l,A){if(A=A||{},!isObject(A))throw new Error("options is invalid");var y=A.zProperty||"elevation",b=A.flip,T=A.flags;collectionOf(l,"Point","input must contain Points");for(var L=Te(l,b),R=[],U=0;U<L.length;U++){for(var H=L[U],N=[],Q=0;Q<H.length;Q++){var K=H[Q];K.properties[y]?N.push(K.properties[y]):N.push(0),T===!0&&(K.properties.matrixPosition=[U,Q])}R.push(N)}return R}function Te(l,A){var y={};featureEach(l,function(L){var R=getCoords(L)[1];y[R]||(y[R]=[]),y[R].push(L)});var b=Object.keys(y).map(function(L){var R=y[L],U=R.sort(function(H,N){return getCoords(H)[0]-getCoords(N)[0]});return U}),T=b.sort(function(L,R){return A?getCoords(L[0])[1]-getCoords(R[0])[1]:getCoords(R[0])[1]-getCoords(L[0])[1]});return T}function le(l,A,y){if(y=y||{},!isObject(y))throw new Error("options is invalid");var b=y.zProperty||"elevation",T=y.commonProperties||{},L=y.breaksProperties||[];if(collectionOf(l,"Point","Input must contain Points"),!A)throw new Error("breaks is required");if(!Array.isArray(A))throw new Error("breaks must be an Array");if(!isObject(T))throw new Error("commonProperties must be an Object");if(!Array.isArray(L))throw new Error("breaksProperties must be an Array");var R=we(l,{zProperty:b,flip:!0}),U=Re(R,A,b,T,L),H=ye(U,R,l);return featureCollection(H)}function Re(l,A,y,b,T){for(var L=[],R=1;R<A.length;R++){var U=+A[R],H=objectAssign({},b,T[R]);H[y]=U;var N=multiLineString(ee(l,U),H);L.push(N)}return L}function ye(l,A,y){var b=bbox(y),T=b[2]-b[0],L=b[3]-b[1],R=b[0],U=b[1],H=A[0].length-1,N=A.length-1,Q=T/H,K=L/N,ie=function(pe){pe[0]=pe[0]*Q+R,pe[1]=pe[1]*K+U};return l.forEach(function(pe){coordEach(pe,ie)}),l}var _e=null,ne=C(24538);function Y(l,A){A===void 0&&(A={}),A.concavity=A.concavity||1/0;var y=[];if(coordEach(l,function(T){y.push([T[0],T[1]])}),!y.length)return null;var b=concaveman(y,A.concavity);return b.length>3?polygon([b]):null}function Le(l,A,y){if(y===void 0&&(y={}),!l)throw new Error("point is required");if(!A)throw new Error("polygon is required");var b=(0,G.c9)(l),T=(0,G.wA)(A),L=T.type,R=A.bbox,U=T.coordinates;if(R&&Ee(b,R)===!1)return!1;L==="Polygon"&&(U=[U]);for(var H=!1,N=0;N<U.length&&!H;N++)if(de(b,U[N][0],y.ignoreBoundary)){for(var Q=!1,K=1;K<U[N].length&&!Q;)de(b,U[N][K],!y.ignoreBoundary)&&(Q=!0),K++;Q||(H=!0)}return H}function de(l,A,y){var b=!1;A[0][0]===A[A.length-1][0]&&A[0][1]===A[A.length-1][1]&&(A=A.slice(0,A.length-1));for(var T=0,L=A.length-1;T<A.length;L=T++){var R=A[T][0],U=A[T][1],H=A[L][0],N=A[L][1],Q=l[1]*(R-H)+U*(H-l[0])+N*(l[0]-R)===0&&(R-l[0])*(H-l[0])<=0&&(U-l[1])*(N-l[1])<=0;if(Q)return!y;var K=U>l[1]!=N>l[1]&&l[0]<(H-R)*(l[1]-U)/(N-U)+R;K&&(b=!b)}return b}function Ee(l,A){return A[0]<=l[0]&&A[1]<=l[1]&&A[2]>=l[0]&&A[3]>=l[1]}function ge(l,A){var y=[];return featureEach(l,function(b){var T=!1;if(b.geometry.type==="Point")geomEach(A,function(R){pointInPolygon(b,R)&&(T=!0)}),T&&y.push(b);else if(b.geometry.type==="MultiPoint"){var L=[];geomEach(A,function(R){coordEach(b,function(U){pointInPolygon(U,R)&&(T=!0,L.push(U))})}),T&&y.push(multiPoint(L))}else throw new Error("Input geometry must be a Point or MultiPoint")}),featureCollection(y)}var X=null;function Me(l,A,y){y===void 0&&(y={});var b=getCoord(l),T=getCoord(A),L=degreesToRadians(T[1]-b[1]),R=degreesToRadians(T[0]-b[0]),U=degreesToRadians(b[1]),H=degreesToRadians(T[1]),N=Math.pow(Math.sin(L/2),2)+Math.pow(Math.sin(R/2),2)*Math.cos(U)*Math.cos(H);return radiansToLength(2*Math.atan2(Math.sqrt(N),Math.sqrt(1-N)),y.units)}var Ae=null;function me(l,A){var y=!1;return featureCollection(oe(l.features.map(function(b){var T={x:b.geometry.coordinates[0],y:b.geometry.coordinates[1]};return A?T.z=b.properties[A]:b.geometry.coordinates.length===3&&(y=!0,T.z=b.geometry.coordinates[2]),T})).map(function(b){var T=[b.a.x,b.a.y],L=[b.b.x,b.b.y],R=[b.c.x,b.c.y],U={};return y?(T.push(b.a.z),L.push(b.b.z),R.push(b.c.z)):U={a:b.a.z,b:b.b.z,c:b.c.z},polygon([[T,L,R,T]],U)}))}var ue=function(){function l(A,y,b){this.a=A,this.b=y,this.c=b;var T=y.x-A.x,L=y.y-A.y,R=b.x-A.x,U=b.y-A.y,H=T*(A.x+y.x)+L*(A.y+y.y),N=R*(A.x+b.x)+U*(A.y+b.y),Q=2*(T*(b.y-y.y)-L*(b.x-y.x)),K,ie;this.x=(U*H-L*N)/Q,this.y=(T*N-R*H)/Q,K=this.x-A.x,ie=this.y-A.y,this.r=K*K+ie*ie}return l}();function ke(l,A){return A.x-l.x}function Ze(l){var A=l.length,y,b,T,L,R;e:for(;A;)for(b=l[--A],y=l[--A],T=A;T;)if(R=l[--T],L=l[--T],y===L&&b===R||y===R&&b===L){l.splice(A,2),l.splice(T,2),A-=2;continue e}}function oe(l){if(l.length<3)return[];l.sort(ke);for(var A=l.length-1,y=l[A].x,b=l[0].x,T=l[A].y,L=T,R=1e-12,U,H,N,Q,K,ie;A--;)l[A].y<T&&(T=l[A].y),l[A].y>L&&(L=l[A].y);var pe=b-y,pt=L-T,it=pe>pt?pe:pt,Nt=(b+y)*.5,dt=(L+T)*.5,Je=[new ue({__sentinel:!0,x:Nt-20*it,y:dt-it},{__sentinel:!0,x:Nt,y:dt+20*it},{__sentinel:!0,x:Nt+20*it,y:dt-it})],ht=[],Ht=[],Bt;for(A=l.length;A--;){for(Ht.length=0,Bt=Je.length;Bt--;){if(pe=l[A].x-Je[Bt].x,pe>0&&pe*pe>Je[Bt].r){ht.push(Je[Bt]),Je.splice(Bt,1);continue}pt=l[A].y-Je[Bt].y,!(pe*pe+pt*pt>Je[Bt].r)&&(Ht.push(Je[Bt].a,Je[Bt].b,Je[Bt].b,Je[Bt].c,Je[Bt].c,Je[Bt].a),Je.splice(Bt,1))}for(Ze(Ht),Bt=Ht.length;Bt;)H=Ht[--Bt],U=Ht[--Bt],N=l[A],Q=H.x-U.x,K=H.y-U.y,ie=2*(Q*(N.y-H.y)-K*(N.x-H.x)),Math.abs(ie)>R&&Je.push(new ue(U,H,N))}for(Array.prototype.push.apply(ht,Je),A=ht.length;A--;)(ht[A].a.__sentinel||ht[A].b.__sentinel||ht[A].c.__sentinel)&&ht.splice(A,1);return ht}function Dt(l,A){if(A===void 0&&(A={}),A=A||{},!isObject(A))throw new Error("options is invalid");var y=A.mutate;if(getType(l)!=="FeatureCollection")throw new Error("geojson must be a FeatureCollection");if(!l.features.length)throw new Error("geojson is empty");(y===!1||y===void 0)&&(l=clone(l));var b=[],T=lineReduce(l,function(L,R){var U=cr(L,R);return U||(b.push(L),R)});return T&&b.push(T),b.length?b.length===1?b[0]:multiLineString(b.map(function(L){return L.coordinates})):null}function Rt(l){return l[0].toString()+","+l[1].toString()}function cr(l,A){var y=l.geometry.coordinates,b=A.geometry.coordinates,T=Rt(y[0]),L=Rt(y[y.length-1]),R=Rt(b[0]),U=Rt(b[b.length-1]),H;if(T===U)H=b.concat(y.slice(1));else if(R===L)H=y.concat(b.slice(1));else if(T===R)H=y.slice(1).reverse().concat(b);else if(L===U)H=y.concat(b.reverse().slice(1));else return null;return lineString(H)}var Ut=null,$r=Object.prototype.hasOwnProperty;function ln(l){var A=1/0,y=1/0,b=-1/0,T=-1/0;function L(K){K!=null&&hasOwnProperty.call(R,K.type)&&R[K.type](K)}var R={GeometryCollection:function(K){K.geometries.forEach(L)},Point:function(K){U(K.coordinates)},MultiPoint:function(K){K.coordinates.forEach(U)},LineString:function(K){H(K.arcs)},MultiLineString:function(K){K.arcs.forEach(H)},Polygon:function(K){K.arcs.forEach(H)},MultiPolygon:function(K){K.arcs.forEach(N)}};function U(K){var ie=K[0],pe=K[1];ie<A&&(A=ie),ie>b&&(b=ie),pe<y&&(y=pe),pe>T&&(T=pe)}function H(K){K.forEach(U)}function N(K){K.forEach(H)}for(var Q in l)L(l[Q]);return b>=A&&T>=y?[A,y,b,T]:void 0}var Sr=new ArrayBuffer(16),Qr=new Float64Array(Sr),Jr=new Uint32Array(Sr);function _r(l){Qr[0]=l[0],Qr[1]=l[1];var A=Jr[0]^Jr[1];return A=A<<5^A>>7^Jr[2]^Jr[3],A&2147483647}function Gn(l){var A=l.coordinates,y=l.lines,b=l.rings,T=ir(),L=new Int32Array(A.length),R=new Int32Array(A.length),U=new Int32Array(A.length),H=new Int8Array(A.length),N=0,Q,K,ie,pe,pt;for(Q=0,K=A.length;Q<K;++Q)L[Q]=R[Q]=U[Q]=-1;for(Q=0,K=y.length;Q<K;++Q){var it=y[Q],Nt=it[0],dt=it[1];for(pe=T[Nt],pt=T[++Nt],++N,H[pe]=1;++Nt<=dt;)Bt(Q,ie=pe,pe=pt,pt=T[Nt]);++N,H[pt]=1}for(Q=0,K=A.length;Q<K;++Q)L[Q]=-1;for(Q=0,K=b.length;Q<K;++Q){var Je=b[Q],ht=Je[0]+1,Ht=Je[1];for(ie=T[Ht-1],pe=T[ht-1],pt=T[ht],Bt(Q,ie,pe,pt);++ht<=Ht;)Bt(Q,ie=pe,pe=pt,pt=T[ht])}function Bt(bn,Ei,$i,on){if(L[$i]!==bn){L[$i]=bn;var ii=R[$i];if(ii>=0){var Dn=U[$i];(ii!==Ei||Dn!==on)&&(ii!==on||Dn!==Ei)&&(++N,H[$i]=1)}else R[$i]=Ei,U[$i]=on}}function ir(){for(var bn=hashmap(A.length*1.4,Kt,fr,Int32Array,-1,Int32Array),Ei=new Int32Array(A.length),$i=0,on=A.length;$i<on;++$i)Ei[$i]=bn.maybeSet($i,$i);return Ei}function Kt(bn){return hashPoint(A[bn])}function fr(bn,Ei){return equalPoint(A[bn],A[Ei])}L=R=U=null;var Ct=hashset(N*1.4,hashPoint,equalPoint),oi;for(Q=0,K=A.length;Q<K;++Q)H[oi=T[Q]]&&Ct.add(A[oi]);return Ct}function ti(l){var A=join(l),y=l.coordinates,b=l.lines,T=l.rings,L,R,U;for(R=0,U=b.length;R<U;++R)for(var H=b[R],N=H[0],Q=H[1];++N<Q;)A.has(y[N])&&(L={0:N,1:H[1]},H[1]=N,H=H.next=L);for(R=0,U=T.length;R<U;++R)for(var K=T[R],ie=K[0],pe=ie,pt=K[1],it=A.has(y[ie]);++pe<pt;)A.has(y[pe])&&(it?(L={0:pe,1:K[1]},K[1]=pe,K=K.next=L):(Vn(y,ie,pt,pt-pe),y[pt]=y[ie],it=!0,pe=ie));return l}function Vn(l,A,y,b){Xr(l,A,y),Xr(l,A,A+b),Xr(l,A+b,y)}function Xr(l,A,y){for(var b=A+(y---A>>1),T;A<b;++A,--y)T=l[A],l[A]=l[y],l[y]=T}function sn(l){var A=l.coordinates,y=l.lines,b,T=l.rings,L,R=y.length+T.length,U,H;for(delete l.lines,delete l.rings,U=0,H=y.length;U<H;++U)for(b=y[U];b=b.next;)++R;for(U=0,H=T.length;U<H;++U)for(L=T[U];L=L.next;)++R;var N=hashmap(R*2*1.4,hashPoint,equalPoint),Q=l.arcs=[];for(U=0,H=y.length;U<H;++U){b=y[U];do K(b);while(b=b.next)}for(U=0,H=T.length;U<H;++U)if(L=T[U],L.next)do K(L);while(L=L.next);else ie(L);function K(Je){var ht,Ht,Bt,ir,Kt,fr,Ct,oi;if(Bt=N.get(ht=A[Je[0]])){for(Ct=0,oi=Bt.length;Ct<oi;++Ct)if(ir=Bt[Ct],pe(ir,Je)){Je[0]=ir[0],Je[1]=ir[1];return}}if(Kt=N.get(Ht=A[Je[1]])){for(Ct=0,oi=Kt.length;Ct<oi;++Ct)if(fr=Kt[Ct],pt(fr,Je)){Je[1]=fr[0],Je[0]=fr[1];return}}Bt?Bt.push(Je):N.set(ht,[Je]),Kt?Kt.push(Je):N.set(Ht,[Je]),Q.push(Je)}function ie(Je){var ht,Ht,Bt,ir,Kt;if(Ht=N.get(ht=A[Je[0]]))for(ir=0,Kt=Ht.length;ir<Kt;++ir){if(Bt=Ht[ir],it(Bt,Je)){Je[0]=Bt[0],Je[1]=Bt[1];return}if(Nt(Bt,Je)){Je[0]=Bt[1],Je[1]=Bt[0];return}}if(Ht=N.get(ht=A[Je[0]+dt(Je)]))for(ir=0,Kt=Ht.length;ir<Kt;++ir){if(Bt=Ht[ir],it(Bt,Je)){Je[0]=Bt[0],Je[1]=Bt[1];return}if(Nt(Bt,Je)){Je[0]=Bt[1],Je[1]=Bt[0];return}}Ht?Ht.push(Je):N.set(ht,[Je]),Q.push(Je)}function pe(Je,ht){var Ht=Je[0],Bt=ht[0],ir=Je[1],Kt=ht[1];if(Ht-ir!==Bt-Kt)return!1;for(;Ht<=ir;++Ht,++Bt)if(!equalPoint(A[Ht],A[Bt]))return!1;return!0}function pt(Je,ht){var Ht=Je[0],Bt=ht[0],ir=Je[1],Kt=ht[1];if(Ht-ir!==Bt-Kt)return!1;for(;Ht<=ir;++Ht,--Kt)if(!equalPoint(A[Ht],A[Kt]))return!1;return!0}function it(Je,ht){var Ht=Je[0],Bt=ht[0],ir=Je[1],Kt=ht[1],fr=ir-Ht;if(fr!==Kt-Bt)return!1;for(var Ct=dt(Je),oi=dt(ht),bn=0;bn<fr;++bn)if(!equalPoint(A[Ht+(bn+Ct)%fr],A[Bt+(bn+oi)%fr]))return!1;return!0}function Nt(Je,ht){var Ht=Je[0],Bt=ht[0],ir=Je[1],Kt=ht[1],fr=ir-Ht;if(fr!==Kt-Bt)return!1;for(var Ct=dt(Je),oi=fr-dt(ht),bn=0;bn<fr;++bn)if(!equalPoint(A[Ht+(bn+Ct)%fr],A[Kt-(bn+oi)%fr]))return!1;return!0}function dt(Je){for(var ht=Je[0],Ht=Je[1],Bt=ht,ir=Bt,Kt=A[Bt];++Bt<Ht;){var fr=A[Bt];(fr[0]<Kt[0]||fr[0]===Kt[0]&&fr[1]<Kt[1])&&(ir=Bt,Kt=fr)}return ir-ht}return l}function _n(l){var A=-1,y=[],b=[],T=[];function L(K){K&&hasOwnProperty.call(R,K.type)&&R[K.type](K)}var R={GeometryCollection:function(K){K.geometries.forEach(L)},LineString:function(K){K.arcs=U(K.arcs)},MultiLineString:function(K){K.arcs=K.arcs.map(U)},Polygon:function(K){K.arcs=K.arcs.map(H)},MultiPolygon:function(K){K.arcs=K.arcs.map(N)}};function U(K){for(var ie=0,pe=K.length;ie<pe;++ie)T[++A]=K[ie];var pt={0:A-pe+1,1:A};return y.push(pt),pt}function H(K){for(var ie=0,pe=K.length;ie<pe;++ie)T[++A]=K[ie];var pt={0:A-pe+1,1:A};return b.push(pt),pt}function N(K){return K.map(H)}for(var Q in l)L(l[Q]);return{type:"Topology",coordinates:T,lines:y,rings:b,objects:l}}function Di(l,A,y){var b=A[0],T=A[1],L=A[2],R=A[3],U=L-b?(y-1)/(L-b):1,H=R-T?(y-1)/(R-T):1;function N(dt){return[Math.round((dt[0]-b)*U),Math.round((dt[1]-T)*H)]}function Q(dt,Je){for(var ht=-1,Ht=0,Bt=dt.length,ir=new Array(Bt),Kt,fr,Ct,oi,bn;++ht<Bt;)Kt=dt[ht],oi=Math.round((Kt[0]-b)*U),bn=Math.round((Kt[1]-T)*H),(oi!==fr||bn!==Ct)&&(ir[Ht++]=[fr=oi,Ct=bn]);for(ir.length=Ht;Ht<Je;)Ht=ir.push([ir[0][0],ir[0][1]]);return ir}function K(dt){return Q(dt,2)}function ie(dt){return Q(dt,4)}function pe(dt){return dt.map(ie)}function pt(dt){dt!=null&&hasOwnProperty.call(it,dt.type)&&it[dt.type](dt)}var it={GeometryCollection:function(dt){dt.geometries.forEach(pt)},Point:function(dt){dt.coordinates=N(dt.coordinates)},MultiPoint:function(dt){dt.coordinates=dt.coordinates.map(N)},LineString:function(dt){dt.arcs=K(dt.arcs)},MultiLineString:function(dt){dt.arcs=dt.arcs.map(K)},Polygon:function(dt){dt.arcs=pe(dt.arcs)},MultiPolygon:function(dt){dt.arcs=dt.arcs.map(pe)}};for(var Nt in l)pt(l[Nt]);return{scale:[1/U,1/H],translate:[b,T]}}function ri(l,A){var y=bounds(l=geometry(l)),b=A>0&&y&&prequantize(l,y,A),T=dedup(cut(extract(l))),L=T.coordinates,R=hashmap(T.arcs.length*1.4,Pt,J);l=T.objects,T.bbox=y,T.arcs=T.arcs.map(function(ie,pe){return R.set(ie,pe),L.slice(ie[0],ie[1]+1)}),delete T.coordinates,L=null;function U(ie){ie&&hasOwnProperty.call(H,ie.type)&&H[ie.type](ie)}var H={GeometryCollection:function(ie){ie.geometries.forEach(U)},LineString:function(ie){ie.arcs=N(ie.arcs)},MultiLineString:function(ie){ie.arcs=ie.arcs.map(N)},Polygon:function(ie){ie.arcs=ie.arcs.map(N)},MultiPolygon:function(ie){ie.arcs=ie.arcs.map(Q)}};function N(ie){var pe=[];do{var pt=R.get(ie);pe.push(ie[0]<ie[1]?pt:~pt)}while(ie=ie.next);return pe}function Q(ie){return ie.map(N)}for(var K in l)U(l[K]);return b&&(T.transform=b,T.arcs=delta(T.arcs)),T}function Pt(l){var A=l[0],y=l[1],b;return y<A&&(b=A,A=y,y=b),A+31*y}function J(l,A){var y=l[0],b=l[1],T=A[0],L=A[1],R;return b<y&&(R=y,y=b,b=R),L<T&&(R=T,T=L,L=R),y===T&&b===L}function ze(l,A){if(A===void 0&&(A={}),getType(l)!=="FeatureCollection")throw new Error("geojson must be a FeatureCollection");if(!l.features.length)throw new Error("geojson is empty");(A.mutate===!1||A.mutate===void 0)&&(l=clone(l));var y=[];flattenEach(l,function(L){y.push(L.geometry)});var b=topology({geoms:geometryCollection(y).geometry}),T=merge(b,b.objects.geoms.geometries);return T}function $e(l,A){if(A===void 0&&(A={}),A=A||{},!isObject(A))throw new Error("options is invalid");var y=A.mutate;if(getType(l)!=="FeatureCollection")throw new Error("geojson must be a FeatureCollection");if(!l.features.length)throw new Error("geojson is empty");(y===!1||y===void 0)&&(l=clone(l));var b=At(l);if(!b)throw new Error("geojson must be homogenous");var T=l;switch(b){case"LineString":return lineDissolve(T,A);case"Polygon":return polygonDissolve(T,A);default:throw new Error(b+" is not supported")}}function At(l){var A={};flattenEach(l,function(b){A[b.geometry.type]=!0});var y=Object.keys(A);return y.length===1?y[0]:null}var Lt=null;function wt(l,A){A===void 0&&(A={});var y=A.maxEdge||1/0,b=yr(l),T=tin(b);if(T.features=T.features.filter(function(R){var U=R.geometry.coordinates[0][0],H=R.geometry.coordinates[0][1],N=R.geometry.coordinates[0][2],Q=distance(U,H,A),K=distance(H,N,A),ie=distance(U,N,A);return Q<=y&&K<=y&&ie<=y}),T.features.length<1)return null;var L=dissolve(T);return L.coordinates.length===1&&(L.coordinates=L.coordinates[0],L.type="Polygon"),feature(L)}function yr(l){var A=[],y={};return featureEach(l,function(b){if(b.geometry){var T=b.geometry.coordinates.join("-");Object.prototype.hasOwnProperty.call(y,T)||(A.push(b),y[T]=!0)}}),featureCollection(A)}var vt=null,Tt=C(85475);function Qt(l,A,y,b){var T=rbush(6),L=A.features.map(function(R){var U;return{minX:R.geometry.coordinates[0],minY:R.geometry.coordinates[1],maxX:R.geometry.coordinates[0],maxY:R.geometry.coordinates[1],property:(U=R.properties)===null||U===void 0?void 0:U[y]}});return T.load(L),l.features.forEach(function(R){R.properties||(R.properties={});var U=turfbbox(R),H=T.search({minX:U[0],minY:U[1],maxX:U[2],maxY:U[3]}),N=[];H.forEach(function(Q){booleanPointInPolygon([Q.minX,Q.minY],R)&&N.push(Q.property)}),R.properties[b]=N}),l}var xr=null;function kr(l,A){if(A=A||{},!isObject(A))throw new Error("options is invalid");var y=A.mutate;if(!l)throw new Error("geojson is required");return(y===!1||y===void 0)&&(l=clone(l)),coordEach(l,function(b){var T=b[0],L=b[1];b[0]=L,b[1]=T}),l}var Wr=null;function an(l,A){A===void 0&&(A={});var y=typeof A=="object"?A.mutate:A;if(!l)throw new Error("geojson is required");var b=getType(l),T=[];switch(b){case"LineString":T=Br(l);break;case"MultiLineString":case"Polygon":getCoords(l).forEach(function(R){T.push(Br(R))});break;case"MultiPolygon":getCoords(l).forEach(function(R){var U=[];R.forEach(function(H){U.push(Br(H))}),T.push(U)});break;case"Point":return l;case"MultiPoint":var L={};getCoords(l).forEach(function(R){var U=R.join("-");Object.prototype.hasOwnProperty.call(L,U)||(T.push(R),L[U]=!0)});break;default:throw new Error(b+" geometry not supported")}return l.coordinates?y===!0?(l.coordinates=T,l):{type:b,coordinates:T}:y===!0?(l.geometry.coordinates=T,l):feature({type:b,coordinates:T},l.properties,{bbox:l.bbox,id:l.id})}function Br(l){var A=getCoords(l);if(A.length===2&&!en(A[0],A[1]))return A;var y=[],b=A.length-1,T=y.length;y.push(A[0]);for(var L=1;L<b;L++){var R=y[y.length-1];A[L][0]===R[0]&&A[L][1]===R[1]||(y.push(A[L]),T=y.length,T>2&&Zn(y[T-3],y[T-1],y[T-2])&&y.splice(y.length-2,1))}if(y.push(A[A.length-1]),T=y.length,en(A[0],A[A.length-1])&&T<4)throw new Error("invalid polygon");return Zn(y[T-3],y[T-1],y[T-2])&&y.splice(y.length-2,1),y}function en(l,A){return l[0]===A[0]&&l[1]===A[1]}function Zn(l,A,y){var b=y[0],T=y[1],L=l[0],R=l[1],U=A[0],H=A[1],N=b-L,Q=T-R,K=U-L,ie=H-R,pe=N*ie-Q*K;return pe!==0?!1:Math.abs(K)>=Math.abs(ie)?K>0?L<=b&&b<=U:U<=b&&b<=L:ie>0?R<=T&&T<=H:H<=T&&T<=R}var zn=null;function li(l,A){var y=l.x-A.x,b=l.y-A.y;return y*y+b*b}function sa(l,A,y){var b=A.x,T=A.y,L=y.x-b,R=y.y-T;if(L!==0||R!==0){var U=((l.x-b)*L+(l.y-T)*R)/(L*L+R*R);U>1?(b=y.x,T=y.y):U>0&&(b+=L*U,T+=R*U)}return L=l.x-b,R=l.y-T,L*L+R*R}function Oa(l,A){for(var y=l[0],b=[y],T,L=1,R=l.length;L<R;L++)T=l[L],li(T,y)>A&&(b.push(T),y=T);return y!==T&&b.push(T),b}function Gr(l,A,y,b,T){for(var L=b,R,U=A+1;U<y;U++){var H=sa(l[U],l[A],l[y]);H>L&&(R=U,L=H)}L>b&&(R-A>1&&Gr(l,A,R,b,T),T.push(l[R]),y-R>1&&Gr(l,R,y,b,T))}function Ds(l,A){var y=l.length-1,b=[l[0]];return Gr(l,0,y,A,b),b.push(l[y]),b}function Co(l,A,y){if(l.length<=2)return l;var b=A!==void 0?A*A:1;return l=y?l:Oa(l,b),l=Ds(l,b),l}function xn(l,A){if(A=A||{},!isObject(A))throw new Error("options is invalid");var y=A.tolerance!==void 0?A.tolerance:1,b=A.highQuality||!1,T=A.mutate||!1;if(!l)throw new Error("geojson is required");if(y&&y<0)throw new Error("invalid tolerance");return T!==!0&&(l=clone(l)),geomEach(l,function(L){xs(L,y,b)}),l}function xs(l,A,y){var b=l.type;if(b==="Point"||b==="MultiPoint")return l;cleanCoords(l,!0);var T=l.coordinates;switch(b){case"LineString":l.coordinates=go(T,A,y);break;case"MultiLineString":l.coordinates=T.map(function(L){return go(L,A,y)});break;case"Polygon":l.coordinates=Ns(T,A,y);break;case"MultiPolygon":l.coordinates=T.map(function(L){return Ns(L,A,y)})}return l}function go(l,A,y){return Co(l.map(function(b){return{x:b[0],y:b[1],z:b[2]}}),A,y).map(function(b){return b.z?[b.x,b.y,b.z]:[b.x,b.y]})}function Ns(l,A,y){return l.map(function(b){var T=b.map(function(R){return{x:R[0],y:R[1]}});if(T.length<4)throw new Error("invalid polygon");for(var L=Co(T,A,y).map(function(R){return[R.x,R.y]});!Po(L);)A-=A*.01,L=Co(T,A,y).map(function(R){return[R.x,R.y]});return(L[L.length-1][0]!==L[0][0]||L[L.length-1][1]!==L[0][1])&&L.push(L[0]),L})}function Po(l){return l.length<3?!1:!(l.length===3&&l[2][0]===l[0][0]&&l[2][1]===l[0][1])}var hl=null,yu=function(){function l(A){this.points=A.points||[],this.duration=A.duration||1e4,this.sharpness=A.sharpness||.85,this.centers=[],this.controls=[],this.stepLength=A.stepLength||60,this.length=this.points.length,this.delay=0;for(var y=0;y<this.length;y++)this.points[y].z=this.points[y].z||0;for(var y=0;y<this.length-1;y++){var b=this.points[y],T=this.points[y+1];this.centers.push({x:(b.x+T.x)/2,y:(b.y+T.y)/2,z:(b.z+T.z)/2})}this.controls.push([this.points[0],this.points[0]]);for(var y=0;y<this.centers.length-1;y++){var L=this.points[y+1].x-(this.centers[y].x+this.centers[y+1].x)/2,R=this.points[y+1].y-(this.centers[y].y+this.centers[y+1].y)/2,U=this.points[y+1].z-(this.centers[y].y+this.centers[y+1].z)/2;this.controls.push([{x:(1-this.sharpness)*this.points[y+1].x+this.sharpness*(this.centers[y].x+L),y:(1-this.sharpness)*this.points[y+1].y+this.sharpness*(this.centers[y].y+R),z:(1-this.sharpness)*this.points[y+1].z+this.sharpness*(this.centers[y].z+U)},{x:(1-this.sharpness)*this.points[y+1].x+this.sharpness*(this.centers[y+1].x+L),y:(1-this.sharpness)*this.points[y+1].y+this.sharpness*(this.centers[y+1].y+R),z:(1-this.sharpness)*this.points[y+1].z+this.sharpness*(this.centers[y+1].z+U)}])}return this.controls.push([this.points[this.length-1],this.points[this.length-1]]),this.steps=this.cacheSteps(this.stepLength),this}return l.prototype.cacheSteps=function(A){var y=[],b=this.pos(0);y.push(0);for(var T=0;T<this.duration;T+=10){var L=this.pos(T),R=Math.sqrt((L.x-b.x)*(L.x-b.x)+(L.y-b.y)*(L.y-b.y)+(L.z-b.z)*(L.z-b.z));R>A&&(y.push(T),b=L)}return y},l.prototype.vector=function(A){var y=this.pos(A+10),b=this.pos(A-10);return{angle:180*Math.atan2(y.y-b.y,y.x-b.x)/3.14,speed:Math.sqrt((b.x-y.x)*(b.x-y.x)+(b.y-y.y)*(b.y-y.y)+(b.z-y.z)*(b.z-y.z))}},l.prototype.pos=function(A){var y=A-this.delay;y<0&&(y=0),y>this.duration&&(y=this.duration-1);var b=y/this.duration;if(b>=1)return this.points[this.length-1];var T=Math.floor((this.points.length-1)*b),L=(this.length-1)*b-T;return fs(L,this.points[T],this.controls[T][1],this.controls[T+1][0],this.points[T+1])},l}(),Es=null;function fs(l,A,y,b,T){var L=Ou(l),R={x:T.x*L[0]+b.x*L[1]+y.x*L[2]+A.x*L[3],y:T.y*L[0]+b.y*L[1]+y.y*L[2]+A.y*L[3],z:T.z*L[0]+b.z*L[1]+y.z*L[2]+A.z*L[3]};return R}function Ou(l){var A=l*l,y=A*l;return[y,3*A*(1-l),3*l*(1-l)*(1-l),(1-l)*(1-l)*(1-l)]}function Al(l,A){A===void 0&&(A={});for(var y=A.resolution||1e4,b=A.sharpness||.85,T=[],L=getGeom(l).coordinates.map(function(N){return{x:N[0],y:N[1]}}),R=new Spline({duration:y,points:L,sharpness:b}),U=function(N){var Q=R.pos(N);Math.floor(N/100)%2===0&&T.push([Q.x,Q.y])},H=0;H<R.duration;H+=10)U(H);return U(R.duration),lineString(T,A.properties)}var da=null;function Zi(l,A,y,b){return l=clone(l),A=clone(A),featureEach(l,function(T){T.properties||(T.properties={}),featureEach(A,function(L){T.properties[b]===void 0&&booleanPointInPolygon(T,L)&&(T.properties[b]=L.properties[y])})}),l}var Fs=null;function no(l,A){if(!l)throw new Error("featurecollection is required");if(A==null)throw new Error("num is required");if(typeof A!="number")throw new Error("num must be a number");var y=featureCollection(ts(l.features,A));return y}function ts(l,A){for(var y=l.slice(0),b=l.length,T=b-A,L,R;b-- >T;)R=Math.floor((b+1)*Math.random()),L=y[R],y[R]=y[b],y[b]=L;return y.slice(T)}var Oo=null,Ni=C(39511);function io(l){return(0,Ni.Z)((0,P.Z)(l))}var bs=io;function Wo(l){var A=l[0],y=l[1],b=l[2],T=l[3],L=distance(l.slice(0,2),[b,y]),R=distance(l.slice(0,2),[A,T]);if(L>=R){var U=(y+T)/2;return[A,U-(b-A)/2,b,U+(b-A)/2]}else{var H=(A+b)/2;return[H-(T-y)/2,y,H+(T-y)/2,T]}}var Ru=null;function Sa(l,A,y,b){b===void 0&&(b={});var T=getCoord(l),L=degreesToRadians(T[0]),R=degreesToRadians(T[1]),U=degreesToRadians(y),H=lengthToRadians(A,b.units),N=Math.asin(Math.sin(R)*Math.cos(H)+Math.cos(R)*Math.sin(H)*Math.cos(U)),Q=L+Math.atan2(Math.sin(U)*Math.sin(H)*Math.cos(R),Math.cos(H)-Math.sin(R)*Math.sin(N)),K=radiansToDegrees(Q),ie=radiansToDegrees(N);return point([K,ie],b.properties)}function ya(l,A,y){y===void 0&&(y={});for(var b=y.steps||64,T=y.properties?y.properties:!Array.isArray(l)&&l.type==="Feature"&&l.properties?l.properties:{},L=[],R=0;R<b;R++)L.push(destination(l,A,R*-360/b,y).geometry.coordinates);return L.push(L[0]),polygon([L],T)}var Ku=null;function uo(l,A,y){if(y===void 0&&(y={}),y.final===!0)return Js(l,A);var b=getCoord(l),T=getCoord(A),L=degreesToRadians(b[0]),R=degreesToRadians(T[0]),U=degreesToRadians(b[1]),H=degreesToRadians(T[1]),N=Math.sin(R-L)*Math.cos(H),Q=Math.cos(U)*Math.sin(H)-Math.sin(U)*Math.cos(H)*Math.cos(R-L);return radiansToDegrees(Math.atan2(N,Q))}function Js(l,A){var y=uo(A,l);return y=(y+180)%360,y}function Ca(l,A){var y=distance(l,A),b=bearing(l,A),T=destination(l,y/2,b);return T}var uu=null;function Mr(l,A){A===void 0&&(A={});var y=bbox(l),b=(y[0]+y[2])/2,T=(y[1]+y[3])/2;return point([b,T],A.properties,A)}var vn=null;function lo(l,A){A===void 0&&(A={});var y=0,b=0,T=0;return coordEach(l,function(L){y+=L[0],b+=L[1],T++},!0),point([y/T,b/T],A.properties)}var eu=null;function tu(l,A){switch(A===void 0&&(A={}),getType(l)){case"Point":return point(getCoord(l),A.properties);case"Polygon":var y=[];coordEach(l,function(Ht){y.push(Ht)});var b=centroid(l,{properties:A.properties}),T=b.geometry.coordinates,L=0,R=0,U=0,H,N,Q,K,ie,pe,pt,it,Nt=y.map(function(Ht){return[Ht[0]-T[0],Ht[1]-T[1]]});for(H=0;H<y.length-1;H++)N=Nt[H],K=N[0],pe=N[1],Q=Nt[H+1],ie=Q[0],pt=Q[1],it=K*pt-ie*pe,U+=it,L+=(K+ie)*it,R+=(pe+pt)*it;if(U===0)return b;var dt=U*.5,Je=1/(6*dt);return point([T[0]+Je*L,T[1]+Je*R],A.properties);default:var ht=convex(l);return ht?tu(ht,{properties:A.properties}):centroid(l,{properties:A.properties})}}var Ss=null;function Bs(l){var A={MultiPoint:{coordinates:[],properties:[]},MultiLineString:{coordinates:[],properties:[]},MultiPolygon:{coordinates:[],properties:[]}};return featureEach(l,function(y){var b,T,L,R;switch((R=y.geometry)===null||R===void 0?void 0:R.type){case"Point":A.MultiPoint.coordinates.push(y.geometry.coordinates),A.MultiPoint.properties.push(y.properties);break;case"MultiPoint":(b=A.MultiPoint.coordinates).push.apply(b,y.geometry.coordinates),A.MultiPoint.properties.push(y.properties);break;case"LineString":A.MultiLineString.coordinates.push(y.geometry.coordinates),A.MultiLineString.properties.push(y.properties);break;case"MultiLineString":(T=A.MultiLineString.coordinates).push.apply(T,y.geometry.coordinates),A.MultiLineString.properties.push(y.properties);break;case"Polygon":A.MultiPolygon.coordinates.push(y.geometry.coordinates),A.MultiPolygon.properties.push(y.properties);break;case"MultiPolygon":(L=A.MultiPolygon.coordinates).push.apply(L,y.geometry.coordinates),A.MultiPolygon.properties.push(y.properties);break;default:break}}),featureCollection(Object.keys(A).filter(function(y){return A[y].coordinates.length}).sort().map(function(y){var b={type:y,coordinates:A[y].coordinates},T={collectedProperties:A[y].properties};return feature(b,T)}))}var ja=null;function Yc(l){var A=[];return l.type==="FeatureCollection"?featureEach(l,function(y){coordEach(y,function(b){A.push(point(b,y.properties))})}):coordEach(l,function(y){A.push(point(y,l.properties))}),featureCollection(A)}var Cs=null,rs=C(80569);function Ll(l){if(!l.geometry||l.geometry.type!=="Polygon"&&l.geometry.type!=="MultiPolygon")throw new Error("input must be a Polygon or MultiPolygon");var A={type:"FeatureCollection",features:[]};return l.geometry.type==="Polygon"?A.features=zi(l.geometry.coordinates):l.geometry.coordinates.forEach(function(y){A.features=A.features.concat(zi(y))}),A}function zi(l){var A=Pl(l),y=2,b=earcut(A.vertices,A.holes,y),T=[],L=[];b.forEach(function(H,N){var Q=b[N];L.push([A.vertices[Q*y],A.vertices[Q*y+1]])});for(var R=0;R<L.length;R+=3){var U=L.slice(R,R+3);U.push(L[R]),T.push(polygon([U]))}return T}function Pl(l){for(var A=l[0][0].length,y={vertices:[],holes:[],dimensions:A},b=0,T=0;T<l.length;T++){for(var L=0;L<l[T].length;L++)for(var R=0;R<A;R++)y.vertices.push(l[T][L][R]);T>0&&(b+=l[T-1].length,y.holes.push(b))}return y}var Ro=null;function pl(l,A){if(!l)throw new Error("targetPoint is required");if(!A)throw new Error("points is required");var y,b=1/0,T=0;return featureEach(A,function(L,R){var U=distance(l,L);U<b&&(T=R,b=U)}),y=clone(A.features[T]),y.properties.featureIndex=T,y.properties.distanceToPoint=b,y}var Ai=null;function _u(l){if(!l)throw new Error("geojson is required");var A=[];return flattenEach(l,function(y){vf(y,A)}),featureCollection(A)}function vf(l,A){var y=[],b=l.geometry;if(b!==null){switch(b.type){case"Polygon":y=getCoords(b);break;case"LineString":y=[getCoords(b)]}y.forEach(function(T){var L=ku(T,l.properties);L.forEach(function(R){R.id=A.length,A.push(R)})})}}function ku(l,A){var y=[];return l.reduce(function(b,T){var L=lineString([b,T],A);return L.bbox=ns(b,T),y.push(L),T}),y}function ns(l,A){var y=l[0],b=l[1],T=A[0],L=A[1],R=y<T?y:T,U=b<L?b:L,H=y>T?y:T,N=b>L?b:L;return[R,U,H,N]}var Mt=null,Ve=C(56898);function Gt(l,A){var y={},b=[];if(l.type==="LineString"&&(l=feature(l)),A.type==="LineString"&&(A=feature(A)),l.type==="Feature"&&A.type==="Feature"&&l.geometry!==null&&A.geometry!==null&&l.geometry.type==="LineString"&&A.geometry.type==="LineString"&&l.geometry.coordinates.length===2&&A.geometry.coordinates.length===2){var T=ce(l,A);return T&&b.push(T),featureCollection(b)}var L=rbush();return L.load(lineSegment(A)),featureEach(lineSegment(l),function(R){featureEach(L.search(R),function(U){var H=ce(R,U);if(H){var N=getCoords(H).join(",");y[N]||(y[N]=!0,b.push(H))}})}),featureCollection(b)}function ce(l,A){var y=getCoords(l),b=getCoords(A);if(y.length!==2)throw new Error("<intersects> line1 must only contain 2 coordinates");if(b.length!==2)throw new Error("<intersects> line2 must only contain 2 coordinates");var T=y[0][0],L=y[0][1],R=y[1][0],U=y[1][1],H=b[0][0],N=b[0][1],Q=b[1][0],K=b[1][1],ie=(K-N)*(R-T)-(Q-H)*(U-L),pe=(Q-H)*(L-N)-(K-N)*(T-H),pt=(R-T)*(L-N)-(U-L)*(T-H);if(ie===0)return null;var it=pe/ie,Nt=pt/ie;if(it>=0&&it<=1&&Nt>=0&&Nt<=1){var dt=T+it*(R-T),Je=L+it*(U-L);return point([dt,Je])}return null}var Be=null;function Ye(l,A,y){y===void 0&&(y={});var b=point([1/0,1/0],{dist:1/0}),T=0;return flattenEach(l,function(L){for(var R=getCoords(L),U=0;U<R.length-1;U++){var H=point(R[U]);H.properties.dist=distance(A,H,y);var N=point(R[U+1]);N.properties.dist=distance(A,N,y);var Q=distance(H,N,y),K=Math.max(H.properties.dist,N.properties.dist),ie=bearing(H,N),pe=destination(A,K,ie+90,y),pt=destination(A,K,ie-90,y),it=lineIntersects(lineString([pe.geometry.coordinates,pt.geometry.coordinates]),lineString([H.geometry.coordinates,N.geometry.coordinates])),Nt=null;it.features.length>0&&(Nt=it.features[0],Nt.properties.dist=distance(A,Nt,y),Nt.properties.location=T+distance(H,Nt,y)),H.properties.dist<b.properties.dist&&(b=H,b.properties.index=U,b.properties.location=T),N.properties.dist<b.properties.dist&&(b=N,b.properties.index=U+1,b.properties.location=T+Q),Nt&&Nt.properties.dist<b.properties.dist&&(b=Nt,b.properties.index=U),T+=Q}}),b}var zt=null;function hr(l,A,y){y===void 0&&(y={});var b=getCoord(l),T=getCoord(A);T[0]+=T[0]-b[0]>180?-360:b[0]-T[0]>180?360:0;var L=Lr(b,T),R=convertLength(L,"meters",y.units);return R}function Lr(l,A,y){y=y===void 0?earthRadius:Number(y);var b=y,T=l[1]*Math.PI/180,L=A[1]*Math.PI/180,R=L-T,U=Math.abs(A[0]-l[0])*Math.PI/180;U>Math.PI&&(U-=2*Math.PI);var H=Math.log(Math.tan(L/2+Math.PI/4)/Math.tan(T/2+Math.PI/4)),N=Math.abs(H)>1e-11?R/H:Math.cos(T),Q=Math.sqrt(R*R+N*N*U*U),K=Q*b;return K}var dn=null;function Mn(l,A,y){if(y===void 0&&(y={}),y.method||(y.method="geodesic"),y.units||(y.units="kilometers"),!l)throw new Error("pt is required");if(Array.isArray(l)?l=point(l):l.type==="Point"?l=feature(l):featureOf(l,"Point","point"),!A)throw new Error("line is required");Array.isArray(A)?A=lineString(A):A.type==="LineString"?A=feature(A):featureOf(A,"LineString","line");var b=1/0,T=l.geometry.coordinates;return segmentEach(A,function(L){var R=L.geometry.coordinates[0],U=L.geometry.coordinates[1],H=vi(T,R,U,y);H<b&&(b=H)}),convertLength(b,"degrees",y.units)}function vi(l,A,y,b){var T=[y[0]-A[0],y[1]-A[1]],L=[l[0]-A[0],l[1]-A[1]],R=co(L,T);if(R<=0)return is(l,A,{method:b.method,units:"degrees"});var U=co(T,T);if(U<=R)return is(l,y,{method:b.method,units:"degrees"});var H=R/U,N=[A[0]+H*T[0],A[1]+H*T[1]];return is(l,N,{method:b.method,units:"degrees"})}function co(l,A){return l[0]*A[0]+l[1]*A[1]}function is(l,A,y){return y.method==="planar"?getPlanarDistance(l,A,y):getDistance(l,A,y)}var ws=null;function Xc(l,A,y){y===void 0&&(y={});var b=y.units,T=y.properties||{},L=Zs(l);if(!L.features.length)throw new Error("points must contain features");if(!A)throw new Error("line is required");if(getType(A)!=="LineString")throw new Error("line must be a LineString");var R=1/0,U=null;return featureEach(L,function(H){var N=pointToLineDistance(H,A,{units:b});N<R&&(R=N,U=H)}),U&&(U.properties=objectAssign({dist:R},U.properties,T)),U}function Zs(l){var A=[],y=l.geometry?l.geometry.type:l.type;switch(y){case"GeometryCollection":return geomEach(l,function(b){b.type==="Point"&&A.push({type:"Feature",properties:{},geometry:b})}),{type:"FeatureCollection",features:A};case"FeatureCollection":return l.features=l.features.filter(function(b){return b.geometry.type==="Point"}),l;default:throw new Error("points must be a Point Collection")}}var ua=null;function Jl(l,A){var y=getCoord(l),b=getGeom(A),T=b.coordinates,L=T[0];if(L.length<4)throw new Error("OuterRing of a Polygon must have 4 or more Positions.");var R=A.properties||{},U=R.a,H=R.b,N=R.c,Q=y[0],K=y[1],ie=L[0][0],pe=L[0][1],pt=U!==void 0?U:L[0][2],it=L[1][0],Nt=L[1][1],dt=H!==void 0?H:L[1][2],Je=L[2][0],ht=L[2][1],Ht=N!==void 0?N:L[2][2],Bt=(Ht*(Q-ie)*(K-Nt)+pt*(Q-it)*(K-ht)+dt*(Q-Je)*(K-pe)-dt*(Q-ie)*(K-ht)-Ht*(Q-it)*(K-pe)-pt*(Q-Je)*(K-Nt))/((Q-ie)*(K-Nt)+(Q-it)*(K-ht)+(Q-Je)*(K-pe)-(Q-ie)*(K-ht)-(Q-it)*(K-pe)-(Q-Je)*(K-Nt));return Bt}var qa=null;function gf(l){var A,y,b={type:"FeatureCollection",features:[]};if(l.type==="Feature"?y=l.geometry:y=l,y.type==="LineString")A=[y.coordinates];else if(y.type==="MultiLineString")A=y.coordinates;else if(y.type==="MultiPolygon")A=[].concat.apply([],y.coordinates);else if(y.type==="Polygon")A=y.coordinates;else throw new Error("Input must be a LineString, MultiLineString, Polygon, or MultiPolygon Feature or Geometry");return A.forEach(function(T){A.forEach(function(L){for(var R=0;R<T.length-1;R++)for(var U=R;U<L.length-1;U++)if(!(T===L&&(Math.abs(R-U)===1||R===0&&U===T.length-2&&T[R][0]===T[T.length-1][0]&&T[R][1]===T[T.length-1][1]))){var H=dl(T[R][0],T[R][1],T[R+1][0],T[R+1][1],L[U][0],L[U][1],L[U+1][0],L[U+1][1]);H&&b.features.push(point([H[0],H[1]]))}})}),b}function dl(l,A,y,b,T,L,R,U){var H,N,Q,K,ie,pe={x:null,y:null,onLine1:!1,onLine2:!1};return H=(U-L)*(y-l)-(R-T)*(b-A),H===0?pe.x!==null&&pe.y!==null?pe:!1:(N=A-L,Q=l-T,K=(R-T)*N-(U-L)*Q,ie=(y-l)*N-(b-A)*Q,N=K/H,Q=ie/H,pe.x=l+N*(y-l),pe.y=A+N*(b-A),N>=0&&N<=1&&(pe.onLine1=!0),Q>=0&&Q<=1&&(pe.onLine2=!0),pe.onLine1&&pe.onLine2?[pe.x,pe.y]:!1)}function wa(l){for(var A=In(l),y=centroid(A),b=!1,T=0;!b&&T<A.features.length;){var L=A.features[T].geometry,R,U,H,N,Q,K,ie,pe=!1;if(L.type==="Point")y.geometry.coordinates[0]===L.coordinates[0]&&y.geometry.coordinates[1]===L.coordinates[1]&&(b=!0);else if(L.type==="MultiPoint"){var pt=!1;for(ie=0;!pt&&ie<L.coordinates.length;)y.geometry.coordinates[0]===L.coordinates[ie][0]&&y.geometry.coordinates[1]===L.coordinates[ie][1]&&(b=!0,pt=!0),ie++}else if(L.type==="LineString")for(ie=0;!pe&&ie<L.coordinates.length-1;)R=y.geometry.coordinates[0],U=y.geometry.coordinates[1],H=L.coordinates[ie][0],N=L.coordinates[ie][1],Q=L.coordinates[ie+1][0],K=L.coordinates[ie+1][1],Ju(R,U,H,N,Q,K)&&(pe=!0,b=!0),ie++;else if(L.type==="MultiLineString")for(var it=0;it<L.coordinates.length;){pe=!1,ie=0;for(var Nt=L.coordinates[it];!pe&&ie<Nt.length-1;)R=y.geometry.coordinates[0],U=y.geometry.coordinates[1],H=Nt[ie][0],N=Nt[ie][1],Q=Nt[ie+1][0],K=Nt[ie+1][1],Ju(R,U,H,N,Q,K)&&(pe=!0,b=!0),ie++;it++}else(L.type==="Polygon"||L.type==="MultiPolygon")&&booleanPointInPolygon(y,L)&&(b=!0);T++}if(b)return y;var dt=featureCollection([]);for(T=0;T<A.features.length;T++)dt.features=dt.features.concat(explode(A.features[T]).features);return point(nearestPoint(y,dt).geometry.coordinates)}function In(l){return l.type!=="FeatureCollection"?l.type!=="Feature"?featureCollection([feature(l)]):featureCollection([l]):l}function Ju(l,A,y,b,T,L){var R=Math.sqrt((T-y)*(T-y)+(L-b)*(L-b)),U=Math.sqrt((l-y)*(l-y)+(A-b)*(A-b)),H=Math.sqrt((T-l)*(T-l)+(L-A)*(L-A));return R===U+H}var zs=null,lu=6378137;function cu(l){return geomReduce(l,function(A,y){return A+xu(y)},0)}function xu(l){var A=0,y;switch(l.type){case"Polygon":return ci(l.coordinates);case"MultiPolygon":for(y=0;y<l.coordinates.length;y++)A+=ci(l.coordinates[y]);return A;case"Point":case"MultiPoint":case"LineString":case"MultiLineString":return 0}return 0}function ci(l){var A=0;if(l&&l.length>0){A+=Math.abs(as(l[0]));for(var y=1;y<l.length;y++)A-=Math.abs(as(l[y]))}return A}function as(l){var A,y,b,T,L,R,U,H=0,N=l.length;if(N>2){for(U=0;U<N;U++)U===N-2?(T=N-2,L=N-1,R=0):U===N-1?(T=N-1,L=0,R=1):(T=U,L=U+1,R=U+2),A=l[T],y=l[L],b=l[R],H+=(Ha(b[0])-Ha(A[0]))*Math.sin(Ha(y[1]));H=H*lu*lu/2}return H}function Ha(l){return l*Math.PI/180}function Ra(l,A,y){y===void 0&&(y={});for(var b=getGeom(l),T=b.coordinates,L=0,R=0;R<T.length&&!(A>=L&&R===T.length-1);R++)if(L>=A){var U=A-L;if(U){var H=bearing(T[R],T[R-1])-180,N=destination(T[R],U,H,y);return N}else return point(T[R])}else L+=measureDistance(T[R],T[R+1],y);return point(T[T.length-1])}function mo(l,A){return A===void 0&&(A={}),segmentReduce(l,function(y,b){var T=b.geometry.coordinates;return y+distance(T[0],T[1],A)},0)}function fu(l,A,y){var b=getCoords(y);if(getType(y)!=="LineString")throw new Error("line must be a LineString");var T=nearestPointOnLine(y,l),L=nearestPointOnLine(y,A),R;T.properties.index<=L.properties.index?R=[T,L]:R=[L,T];for(var U=[R[0].geometry.coordinates],H=R[0].properties.index+1;H<R[1].properties.index+1;H++)U.push(b[H]);return U.push(R[1].geometry.coordinates),lineString(U,y.properties)}var mf=null;function Ol(l,A,y,b){if(b=b||{},!isObject(b))throw new Error("options is invalid");var T,L=[];if(l.type==="Feature")T=l.geometry.coordinates;else if(l.type==="LineString")T=l.coordinates;else throw new Error("input must be a LineString Feature or Geometry");for(var R=T.length,U=0,H,N,Q,K=0;K<T.length&&!(A>=U&&K===T.length-1);K++){if(U>A&&L.length===0){if(H=A-U,!H)return L.push(T[K]),lineString(L);N=bearing(T[K],T[K-1])-180,Q=destination(T[K],H,N,b),L.push(Q.geometry.coordinates)}if(U>=y)return H=y-U,H?(N=bearing(T[K],T[K-1])-180,Q=destination(T[K],H,N,b),L.push(Q.geometry.coordinates),lineString(L)):(L.push(T[K]),lineString(L));if(U>=A&&L.push(T[K]),K===T.length-1)return lineString(L);U+=distance(T[K],T[K+1],b)}if(U<A&&T.length===R)throw new Error("Start position is beyond line");var ie=T[T.length-1];return lineString([ie,ie])}var Qc=null;function kf(l,A,y){y===void 0&&(y={});for(var b=getCoord(l),T=getCoords(A),L=0;L<T.length-1;L++){var R=!1;if(y.ignoreEndVertices&&(L===0&&(R="start"),L===T.length-2&&(R="end"),L===0&&L+1===T.length-1&&(R="both")),Yo(T[L],T[L+1],b,R,typeof y.epsilon=="undefined"?null:y.epsilon))return!0}return!1}function Yo(l,A,y,b,T){var L=y[0],R=y[1],U=l[0],H=l[1],N=A[0],Q=A[1],K=y[0]-U,ie=y[1]-H,pe=N-U,pt=Q-H,it=K*pt-ie*pe;if(T!==null){if(Math.abs(it)>T)return!1}else if(it!==0)return!1;if(b){if(b==="start")return Math.abs(pe)>=Math.abs(pt)?pe>0?U<L&&L<=N:N<=L&&L<U:pt>0?H<R&&R<=Q:Q<=R&&R<H;if(b==="end")return Math.abs(pe)>=Math.abs(pt)?pe>0?U<=L&&L<N:N<L&&L<=U:pt>0?H<=R&&R<Q:Q<R&&R<=H;if(b==="both")return Math.abs(pe)>=Math.abs(pt)?pe>0?U<L&&L<N:N<L&&L<U:pt>0?H<R&&R<Q:Q<R&&R<H}else return Math.abs(pe)>=Math.abs(pt)?pe>0?U<=L&&L<=N:N<=L&&L<=U:pt>0?H<=R&&R<=Q:Q<=R&&R<=H;return!1}var Us=null;function ko(l,A){var y=getGeom(l),b=getGeom(A),T=y.type,L=b.type;switch(T){case"Point":switch(L){case"MultiPoint":return la(y,b);case"LineString":return booleanPointOnLine(y,b,{ignoreEndVertices:!0});case"Polygon":case"MultiPolygon":return booleanPointInPolygon(y,b,{ignoreBoundary:!0});default:throw new Error("feature2 "+L+" geometry not supported")}case"MultiPoint":switch(L){case"MultiPoint":return os(y,b);case"LineString":return Rl(y,b);case"Polygon":case"MultiPolygon":return Ta(y,b);default:throw new Error("feature2 "+L+" geometry not supported")}case"LineString":switch(L){case"LineString":return Sn(y,b);case"Polygon":case"MultiPolygon":return vl(y,b);default:throw new Error("feature2 "+L+" geometry not supported")}case"Polygon":switch(L){case"Polygon":case"MultiPolygon":return ec(y,b);default:throw new Error("feature2 "+L+" geometry not supported")}default:throw new Error("feature1 "+T+" geometry not supported")}}function la(l,A){var y,b=!1;for(y=0;y<A.coordinates.length;y++)if(hs(A.coordinates[y],l.coordinates)){b=!0;break}return b}function os(l,A){for(var y=0;y<l.coordinates.length;y++){for(var b=!1,T=0;T<A.coordinates.length;T++)hs(l.coordinates[y],A.coordinates[T])&&(b=!0);if(!b)return!1}return!0}function Rl(l,A){for(var y=!1,b=0;b<l.coordinates.length;b++){if(!booleanPointOnLine(l.coordinates[b],A))return!1;y||(y=booleanPointOnLine(l.coordinates[b],A,{ignoreEndVertices:!0}))}return y}function Ta(l,A){for(var y=!0,b=!1,T=!1,L=0;L<l.coordinates.length;L++){if(T=booleanPointInPolygon(l.coordinates[1],A),!T){y=!1;break}b||(T=booleanPointInPolygon(l.coordinates[1],A,{ignoreBoundary:!0}))}return y&&T}function Sn(l,A){for(var y=0;y<l.coordinates.length;y++)if(!booleanPointOnLine(l.coordinates[y],A))return!1;return!0}function vl(l,A){var y=calcBbox(A),b=calcBbox(l);if(!Ka(y,b))return!1;for(var T=!1,L=0;L<l.coordinates.length-1;L++){if(!booleanPointInPolygon(l.coordinates[L],A))return!1;if(T||(T=booleanPointInPolygon(l.coordinates[L],A,{ignoreBoundary:!0})),!T){var R=gl(l.coordinates[L],l.coordinates[L+1]);T=booleanPointInPolygon(R,A,{ignoreBoundary:!0})}}return T}function ec(l,A){var y=calcBbox(l),b=calcBbox(A);if(!Ka(b,y))return!1;for(var T=0;T<l.coordinates[0].length;T++)if(!booleanPointInPolygon(l.coordinates[0][T],A))return!1;return!0}function Ka(l,A){return!(l[0]>A[0]||l[2]<A[2]||l[1]>A[1]||l[3]<A[3])}function hs(l,A){return l[0]===A[0]&&l[1]===A[1]}function gl(l,A){return[(l[0]+A[0])/2,(l[1]+A[1])/2]}var vc=null;function gc(l,A,y){y===void 0&&(y={}),y.mask&&!y.units&&(y.units="kilometers");for(var b=[],T=l[0],L=l[1],R=l[2],U=l[3],H=A/distance([T,L],[R,L],y),N=H*(R-T),Q=A/distance([T,L],[T,U],y),K=Q*(U-L),ie=R-T,pe=U-L,pt=Math.floor(ie/N),it=Math.floor(pe/K),Nt=(ie-pt*N)/2,dt=(pe-it*K)/2,Je=T+Nt;Je<=R;){for(var ht=L+dt;ht<=U;){var Ht=point([Je,ht],y.properties);y.mask?within(Ht,y.mask)&&b.push(Ht):b.push(Ht),ht+=K}Je+=N}return featureCollection(b)}var yf=null;function ea(l,A){A===void 0&&(A={});var y=A.precision,b=A.coordinates,T=A.mutate;if(y=y==null||isNaN(y)?6:y,b=b==null||isNaN(b)?3:b,!l)throw new Error("<geojson> is required");if(typeof y!="number")throw new Error("<precision> must be a number");if(typeof b!="number")throw new Error("<coordinates> must be a number");(T===!1||T===void 0)&&(l=JSON.parse(JSON.stringify(l)));var L=Math.pow(10,y);return coordEach(l,function(R){Du(R,L,b)}),l}function Du(l,A,y){l.length>y&&l.splice(y,l.length);for(var b=0;b<l.length;b++)l[b]=Math.round(l[b]*A)/A;return l}var na=null;function Za(l){if(!l)throw new Error("geojson is required");var A=[];return flattenEach(l,function(y){A.push(y)}),featureCollection(A)}var Do=null;function n0(l,A,y){if(y=y||{},!isObject(y))throw new Error("options is invalid");var b=y.units,T=y.reverse;if(!l)throw new Error("geojson is required");if(A<=0)throw new Error("segmentLength must be greater than 0");var L=[];return flattenEach(l,function(R){T&&(R.geometry.coordinates=R.geometry.coordinates.reverse()),fi(R,A,b,function(U){L.push(U)})}),featureCollection(L)}function fi(l,A,y,b){var T=length(l,{units:y});if(T<=A)return b(l);var L=T/A;Number.isInteger(L)||(L=Math.floor(L)+1);for(var R=0;R<L;R++){var U=lineSliceAlong(l,A*R,A*(R+1),{units:y});b(U,R)}}var As=null;function ia(l,A,y){if(l.geometry.type!=="Polygon")throw new Error("The input feature must be a Polygon");y===void 0&&(y=1);var b=l.geometry.coordinates,T=[],L={};if(y){for(var R=[],U=0;U<b.length;U++)for(var H=0;H<b[U].length-1;H++)R.push(Nt(U,H));var N=rbush();N.load(R)}for(var Q=0;Q<b.length;Q++)for(var K=0;K<b[Q].length-1;K++)if(y){var ie=N.search(Nt(Q,K));ie.forEach(function(dt){var Je=dt.ring,ht=dt.edge;it(Q,K,Je,ht)})}else for(var pe=0;pe<b.length;pe++)for(var pt=0;pt<b[pe].length-1;pt++)it(Q,K,pe,pt);return A||(T={type:"Feature",geometry:{type:"MultiPoint",coordinates:T}}),T;function it(dt,Je,ht,Ht){var Bt=b[dt][Je],ir=b[dt][Je+1],Kt=b[ht][Ht],fr=b[ht][Ht+1],Ct=Ts(Bt,ir,Kt,fr);if(Ct!==null){var oi,bn;if(ir[0]!==Bt[0]?oi=(Ct[0]-Bt[0])/(ir[0]-Bt[0]):oi=(Ct[1]-Bt[1])/(ir[1]-Bt[1]),fr[0]!==Kt[0]?bn=(Ct[0]-Kt[0])/(fr[0]-Kt[0]):bn=(Ct[1]-Kt[1])/(fr[1]-Kt[1]),!(oi>=1||oi<=0||bn>=1||bn<=0)){var Ei=Ct,$i=!L[Ei];$i&&(L[Ei]=!0),A?T.push(A(Ct,dt,Je,Bt,ir,oi,ht,Ht,Kt,fr,bn,$i)):T.push(Ct)}}}function Nt(dt,Je){var ht=b[dt][Je],Ht=b[dt][Je+1],Bt,ir,Kt,fr;return ht[0]<Ht[0]?(Bt=ht[0],ir=Ht[0]):(Bt=Ht[0],ir=ht[0]),ht[1]<Ht[1]?(Kt=ht[1],fr=Ht[1]):(Kt=Ht[1],fr=ht[1]),{minX:Bt,minY:Kt,maxX:ir,maxY:fr,ring:dt,edge:Je}}}function Ts(l,A,y,b){if(_a(l,y)||_a(l,b)||_a(A,y)||_a(b,y))return null;var T=l[0],L=l[1],R=A[0],U=A[1],H=y[0],N=y[1],Q=b[0],K=b[1],ie=(T-R)*(N-K)-(L-U)*(H-Q);if(ie===0)return null;var pe=((T*U-L*R)*(H-Q)-(T-R)*(H*K-N*Q))/ie,pt=((T*U-L*R)*(N-K)-(L-U)*(H*K-N*Q))/ie;return[pe,pt]}function _a(l,A){if(!l||!A||l.length!==A.length)return!1;for(var y=0,b=l.length;y<b;y++)if(l[y]instanceof Array&&A[y]instanceof Array){if(!_a(l[y],A[y]))return!1}else if(l[y]!==A[y])return!1;return!0}function ps(l){if(l.type!="Feature")throw new Error("The input must a geojson object of type Feature");if(l.geometry===void 0||l.geometry==null)throw new Error("The input must a geojson object with a non-empty geometry");if(l.geometry.type!="Polygon")throw new Error("The input must be a geojson Polygon");for(var A=l.geometry.coordinates.length,y=[],Je=0;Je<A;Je++){var b=l.geometry.coordinates[Je];nu(b[0],b[b.length-1])||b.push(b[0]),y.push.apply(y,b.slice(0,b.length-1))}if(!ds(y))throw new Error("The input polygon may not have duplicate vertices (except for the first and last vertex of each ring)");var T=y.length,L=ia(l,function(po,Vo,Gc,Ql,qh,O0,Kh,fh,Wv,Yv,Xv,Qv){return[po,Vo,Gc,Ql,qh,O0,Kh,fh,Wv,Yv,Xv,Qv]}),R=L.length;if(R==0){for(var Kt=[],Je=0;Je<A;Je++)Kt.push(polygon([l.geometry.coordinates[Je]],{parent:-1,winding:ss(l.geometry.coordinates[Je])}));var Ji=featureCollection(Kt);return mu(),_s(),Ji}for(var U=[],H=[],Je=0;Je<A;Je++){U.push([]);for(var N=0;N<l.geometry.coordinates[Je].length-1;N++)U[Je].push([new ml(l.geometry.coordinates[Je][No(N+1,l.geometry.coordinates[Je].length-1)],1,[Je,N],[Je,No(N+1,l.geometry.coordinates[Je].length-1)],void 0)]),H.push(new ru(l.geometry.coordinates[Je][N],[Je,No(N-1,l.geometry.coordinates[Je].length-1)],[Je,N],void 0,void 0,!1,!0))}for(var Je=0;Je<R;Je++)U[L[Je][1]][L[Je][2]].push(new ml(L[Je][0],L[Je][5],[L[Je][1],L[Je][2]],[L[Je][6],L[Je][7]],void 0)),L[Je][11]&&H.push(new ru(L[Je][0],[L[Je][1],L[Je][2]],[L[Je][6],L[Je][7]],void 0,void 0,!0,!0));for(var Q=H.length,Je=0;Je<U.length;Je++)for(var N=0;N<U[Je].length;N++)U[Je][N].sort(function(Vo,Gc){return Vo.param<Gc.param?-1:1});for(var K=[],Je=0;Je<Q;Je++)K.push({minX:H[Je].coord[0],minY:H[Je].coord[1],maxX:H[Je].coord[0],maxY:H[Je].coord[1],index:Je});var ie=rbush();ie.load(K);for(var Je=0;Je<U.length;Je++)for(var N=0;N<U[Je].length;N++)for(var pe=0;pe<U[Je][N].length;pe++){var pt;pe==U[Je][N].length-1?pt=U[Je][No(N+1,l.geometry.coordinates[Je].length-1)][0].coord:pt=U[Je][N][pe+1].coord;var it=ie.search({minX:pt[0],minY:pt[1],maxX:pt[0],maxY:pt[1]})[0];U[Je][N][pe].nxtIsectAlongEdgeIn=it.index}for(var Je=0;Je<U.length;Je++)for(var N=0;N<U[Je].length;N++)for(var pe=0;pe<U[Je][N].length;pe++){var pt=U[Je][N][pe].coord,it=ie.search({minX:pt[0],minY:pt[1],maxX:pt[0],maxY:pt[1]})[0],Nt=it.index;Nt<T?H[Nt].nxtIsectAlongRingAndEdge2=U[Je][N][pe].nxtIsectAlongEdgeIn:nu(H[Nt].ringAndEdge1,U[Je][N][pe].ringAndEdgeIn)?H[Nt].nxtIsectAlongRingAndEdge1=U[Je][N][pe].nxtIsectAlongEdgeIn:H[Nt].nxtIsectAlongRingAndEdge2=U[Je][N][pe].nxtIsectAlongEdgeIn}for(var dt=[],Je=0,N=0;N<A;N++){for(var ht=Je,pe=0;pe<l.geometry.coordinates[N].length-1;pe++)H[Je].coord[0]<H[ht].coord[0]&&(ht=Je),Je++;for(var Ht=H[ht].nxtIsectAlongRingAndEdge2,pe=0;pe<H.length;pe++)if(H[pe].nxtIsectAlongRingAndEdge1==ht||H[pe].nxtIsectAlongRingAndEdge2==ht){var Bt=pe;break}var ir=Mi([H[Bt].coord,H[ht].coord,H[Ht].coord],!0)?1:-1;dt.push({isect:ht,parent:-1,winding:ir})}dt.sort(function(Qa,po){return H[Qa.isect].coord>H[po.isect].coord?-1:1});for(var Kt=[];dt.length>0;){var fr=dt.pop(),Ct=fr.isect,oi=fr.parent,bn=fr.winding,Ei=Kt.length,$i=[H[Ct].coord],on=Ct;if(H[Ct].ringAndEdge1Walkable)var ii=H[Ct].ringAndEdge1,Dn=H[Ct].nxtIsectAlongRingAndEdge1;else var ii=H[Ct].ringAndEdge2,Dn=H[Ct].nxtIsectAlongRingAndEdge2;for(;!nu(H[Ct].coord,H[Dn].coord);){$i.push(H[Dn].coord);for(var Pa=void 0,Je=0;Je<dt.length;Je++)if(dt[Je].isect==Dn){Pa=Je;break}if(Pa!=null&&dt.splice(Pa,1),nu(ii,H[Dn].ringAndEdge1)){if(ii=H[Dn].ringAndEdge2,H[Dn].ringAndEdge2Walkable=!1,H[Dn].ringAndEdge1Walkable){var ba={isect:Dn};Mi([H[on].coord,H[Dn].coord,H[H[Dn].nxtIsectAlongRingAndEdge2].coord],bn==1)?(ba.parent=oi,ba.winding=-bn):(ba.parent=Ei,ba.winding=bn),dt.push(ba)}on=Dn,Dn=H[Dn].nxtIsectAlongRingAndEdge2}else{if(ii=H[Dn].ringAndEdge1,H[Dn].ringAndEdge1Walkable=!1,H[Dn].ringAndEdge2Walkable){var ba={isect:Dn};Mi([H[on].coord,H[Dn].coord,H[H[Dn].nxtIsectAlongRingAndEdge1].coord],bn==1)?(ba.parent=oi,ba.winding=-bn):(ba.parent=Ei,ba.winding=bn),dt.push(ba)}on=Dn,Dn=H[Dn].nxtIsectAlongRingAndEdge1}}$i.push(H[Dn].coord),Kt.push(polygon([$i],{index:Ei,parent:oi,winding:bn,netWinding:void 0}))}var Ji=featureCollection(Kt);mu(),_s();function mu(){for(var Qa=[],po=0;po<Ji.features.length;po++)Ji.features[po].properties.parent==-1&&Qa.push(po);if(Qa.length>1)for(var po=0;po<Qa.length;po++){for(var Vo=-1,Gc=1/0,Ql=0;Ql<Ji.features.length;Ql++)Qa[po]!=Ql&&booleanPointInPolygon(Ji.features[Qa[po]].geometry.coordinates[0][0],Ji.features[Ql],{ignoreBoundary:!0})&&area(Ji.features[Ql])<Gc&&(Vo=Ql);Ji.features[Qa[po]].properties.parent=Vo}}function _s(){for(var Qa=0;Qa<Ji.features.length;Qa++)if(Ji.features[Qa].properties.parent==-1){var po=Ji.features[Qa].properties.winding;Ji.features[Qa].properties.netWinding=po,ou(Qa,po)}}function ou(Qa,po){for(var Vo=0;Vo<Ji.features.length;Vo++)if(Ji.features[Vo].properties.parent==Qa){var Gc=po+Ji.features[Vo].properties.winding;Ji.features[Vo].properties.netWinding=Gc,ou(Vo,Gc)}}return Ji}var ml=function(l,A,y,b,T){this.coord=l,this.param=A,this.ringAndEdgeIn=y,this.ringAndEdgeOut=b,this.nxtIsectAlongEdgeIn=T},ru=function(l,A,y,b,T,L,R){this.coord=l,this.ringAndEdge1=A,this.ringAndEdge2=y,this.nxtIsectAlongRingAndEdge1=b,this.nxtIsectAlongRingAndEdge2=T,this.ringAndEdge1Walkable=L,this.ringAndEdge2Walkable=R};function Mi(l,A){if(typeof A=="undefined"&&(A=!0),l.length!=3)throw new Error("This function requires an array of three points [x,y]");var y=(l[1][0]-l[0][0])*(l[2][1]-l[0][1])-(l[1][1]-l[0][1])*(l[2][0]-l[0][0]);return y>=0==A}function ss(l){for(var A=0,y=0;y<l.length-1;y++)l[y][0]<l[A][0]&&(A=y);if(Mi([l[No(A-1,l.length-1)],l[A],l[No(A+1,l.length-1)]],!0))var b=1;else var b=-1;return b}function nu(l,A){if(!l||!A||l.length!=A.length)return!1;for(var y=0,b=l.length;y<b;y++)if(l[y]instanceof Array&&A[y]instanceof Array){if(!nu(l[y],A[y]))return!1}else if(l[y]!=A[y])return!1;return!0}function No(l,A){return(l%A+A)%A}function ds(l){for(var A={},y=1,b=0,T=l.length;b<T;++b){if(Object.prototype.hasOwnProperty.call(A,l[b])){y=0;break}A[l[b]]=1}return y}function Fo(l){var A=[];return flattenEach(l,function(y){y.geometry.type==="Polygon"&&featureEach(ps(y),function(b){A.push(polygon(b.geometry.coordinates,y.properties))})}),featureCollection(A)}var i0=null,tc=Math.PI/180,va=180/Math.PI,Bo=function(l,A){this.lon=l,this.lat=A,this.x=tc*l,this.y=tc*A};Bo.prototype.view=function(){return String(this.lon).slice(0,4)+","+String(this.lat).slice(0,4)},Bo.prototype.antipode=function(){var l=-1*this.lat,A=this.lon<0?180+this.lon:(180-this.lon)*-1;return new Bo(A,l)};var Ms=function(){this.coords=[],this.length=0};Ms.prototype.move_to=function(l){this.length++,this.coords.push(l)};var fo=function(l){this.properties=l||{},this.geometries=[]};fo.prototype.json=function(){if(this.geometries.length<=0)return{geometry:{type:"LineString",coordinates:null},type:"Feature",properties:this.properties};if(this.geometries.length===1)return{geometry:{type:"LineString",coordinates:this.geometries[0].coords},type:"Feature",properties:this.properties};for(var l=[],A=0;A<this.geometries.length;A++)l.push(this.geometries[A].coords);return{geometry:{type:"MultiLineString",coordinates:l},type:"Feature",properties:this.properties}},fo.prototype.wkt=function(){for(var l="",A="LINESTRING(",y=function(L){A+=L[0]+" "+L[1]+","},b=0;b<this.geometries.length;b++){if(this.geometries[b].coords.length===0)return"LINESTRING(empty)";var T=this.geometries[b].coords;T.forEach(y),l+=A.substring(0,A.length-1)+")"}return l};var Xo=function(l,A,y){if(!l||l.x===void 0||l.y===void 0)throw new Error("GreatCircle constructor expects two args: start and end objects with x and y properties");if(!A||A.x===void 0||A.y===void 0)throw new Error("GreatCircle constructor expects two args: start and end objects with x and y properties");this.start=new Bo(l.x,l.y),this.end=new Bo(A.x,A.y),this.properties=y||{};var b=this.start.x-this.end.x,T=this.start.y-this.end.y,L=Math.pow(Math.sin(T/2),2)+Math.cos(this.start.y)*Math.cos(this.end.y)*Math.pow(Math.sin(b/2),2);if(this.g=2*Math.asin(Math.sqrt(L)),this.g===Math.PI)throw new Error("it appears "+l.view()+" and "+A.view()+" are 'antipodal', e.g diametrically opposite, thus there is no single route but rather infinite");if(isNaN(this.g))throw new Error("could not calculate great circle between "+l+" and "+A)};Xo.prototype.interpolate=function(l){var A=Math.sin((1-l)*this.g)/Math.sin(this.g),y=Math.sin(l*this.g)/Math.sin(this.g),b=A*Math.cos(this.start.y)*Math.cos(this.start.x)+y*Math.cos(this.end.y)*Math.cos(this.end.x),T=A*Math.cos(this.start.y)*Math.sin(this.start.x)+y*Math.cos(this.end.y)*Math.sin(this.end.x),L=A*Math.sin(this.start.y)+y*Math.sin(this.end.y),R=va*Math.atan2(L,Math.sqrt(Math.pow(b,2)+Math.pow(T,2))),U=va*Math.atan2(T,b);return[U,R]},Xo.prototype.Arc=function(l,A){var y=[];if(!l||l<=2)y.push([this.start.lon,this.start.lat]),y.push([this.end.lon,this.end.lat]);else for(var b=1/(l-1),T=0;T<l;++T){var L=b*T,R=this.interpolate(L);y.push(R)}for(var U=!1,H=0,N=A&&A.offset?A.offset:10,Q=180-N,K=-180+N,ie=360-N,pe=1;pe<y.length;++pe){var pt=y[pe-1][0],it=y[pe][0],Nt=Math.abs(it-pt);Nt>ie&&(it>Q&&pt<K||pt>Q&&it<K)?U=!0:Nt>H&&(H=Nt)}var dt=[];if(U&&H<N){var Je=[];dt.push(Je);for(var ht=0;ht<y.length;++ht){var Ht=parseFloat(y[ht][0]);if(ht>0&&Math.abs(Ht-y[ht-1][0])>ie){var Bt=parseFloat(y[ht-1][0]),ir=parseFloat(y[ht-1][1]),Kt=parseFloat(y[ht][0]),fr=parseFloat(y[ht][1]);if(Bt>-180&&Bt<K&&Kt===180&&ht+1<y.length&&y[ht-1][0]>-180&&y[ht-1][0]<K){Je.push([-180,y[ht][1]]),ht++,Je.push([y[ht][0],y[ht][1]]);continue}else if(Bt>Q&&Bt<180&&Kt===-180&&ht+1<y.length&&y[ht-1][0]>Q&&y[ht-1][0]<180){Je.push([180,y[ht][1]]),ht++,Je.push([y[ht][0],y[ht][1]]);continue}if(Bt<K&&Kt>Q){var Ct=Bt;Bt=Kt,Kt=Ct;var oi=ir;ir=fr,fr=oi}if(Bt>Q&&Kt<K&&(Kt+=360),Bt<=180&&Kt>=180&&Bt<Kt){var bn=(180-Bt)/(Kt-Bt),Ei=bn*fr+(1-bn)*ir;Je.push([y[ht-1][0]>Q?180:-180,Ei]),Je=[],Je.push([y[ht-1][0]>Q?-180:180,Ei]),dt.push(Je)}else Je=[],dt.push(Je);Je.push([Ht,y[ht][1]])}else Je.push([y[ht][0],y[ht][1]])}}else{var $i=[];dt.push($i);for(var on=0;on<y.length;++on)$i.push([y[on][0],y[on][1]])}for(var ii=new fo(this.properties),Dn=0;Dn<dt.length;++Dn){var Pa=new Ms;ii.geometries.push(Pa);for(var ba=dt[Dn],Ji=0;Ji<ba.length;++Ji)Pa.move_to(ba[Ji])}return ii};function hu(l,A,y){if(y=y||{},typeof y!="object")throw new Error("options is invalid");var b=y.properties,T=y.npoints,L=y.offset;l=getCoord(l),A=getCoord(A),b=b||{},T=T||100,L=L||10;var R=new Xo({x:l[0],y:l[1]},{x:A[0],y:A[1]},b),U=R.Arc(T,{offset:L});return U.json()}var Au=null;function zr(l,A){if(!l)throw new Error("line is required");if(!A)throw new Error("splitter is required");var y=getType(l),b=getType(A);if(y!=="LineString")throw new Error("line must be LineString");if(b==="FeatureCollection")throw new Error("splitter cannot be a FeatureCollection");if(b==="GeometryCollection")throw new Error("splitter cannot be a GeometryCollection");var T=truncate(A,{precision:7});switch(b){case"Point":return mc(l,T);case"MultiPoint":return Ja(l,T);case"LineString":case"MultiLineString":case"Polygon":case"MultiPolygon":return Ja(l,lineIntersect(l,T))}}function Ja(l,A){var y=[],b=rbush();return flattenEach(A,function(T){if(y.forEach(function(U,H){U.id=H}),!y.length)y=mc(l,T).features,y.forEach(function(U){U.bbox||(U.bbox=square(bbox(U)))}),b.load(featureCollection(y));else{var L=b.search(T);if(L.features.length){var R=kl(T,L);y=y.filter(function(U){return U.id!==R.id}),b.remove(R),featureEach(mc(R,T),function(U){y.push(U),b.insert(U)})}}}),featureCollection(y)}function mc(l,A){var y=[],b=getCoords(l)[0],T=getCoords(l)[l.geometry.coordinates.length-1];if(yo(b,getCoord(A))||yo(T,getCoord(A)))return featureCollection([l]);var L=rbush(),R=lineSegment(l);L.load(R);var U=L.search(A);if(!U.features.length)return featureCollection([l]);var H=kl(A,U),N=[b],Q=featureReduce(R,function(K,ie,pe){var pt=getCoords(ie)[1],it=getCoord(A);return pe===H.id?(K.push(it),y.push(lineString(K)),yo(it,pt)?[it]:[it,pt]):(K.push(pt),K)},N);return Q.length>1&&y.push(lineString(Q)),featureCollection(y)}function kl(l,A){if(!A.features.length)throw new Error("lines must contain features");if(A.features.length===1)return A.features[0];var y,b=1/0;return featureEach(A,function(T){var L=nearestPointOnLine(T,l),R=L.properties.dist;R<b&&(y=T,b=R)}),y}function yo(l,A){return l[0]===A[0]&&l[1]===A[1]}var Nu=null;function Eu(l,A,y,b,T){T===void 0&&(T={});var L=T.steps||64,R=qc(y),U=qc(b),H=!Array.isArray(l)&&l.type==="Feature"?l.properties:{};if(R===U)return lineString(circle(l,A,T).geometry.coordinates[0],H);for(var N=R,Q=R<U?U:U+360,K=N,ie=[],pe=0;K<Q;)ie.push(destination(l,A,K,T).geometry.coordinates),pe++,K=N+pe*360/L;return K>Q&&ie.push(destination(l,A,Q,T).geometry.coordinates),lineString(ie,H)}function qc(l){var A=l%360;return A<0&&(A+=360),A}function vs(l,A){A===void 0&&(A={});var y=getGeom(l);switch(!A.properties&&l.type==="Feature"&&(A.properties=l.properties),y.type){case"Polygon":return Is(y,A);case"MultiPolygon":return Dl(y,A);default:throw new Error("invalid poly")}}function Is(l,A){A===void 0&&(A={});var y=getGeom(l),b=y.coordinates,T=A.properties?A.properties:l.type==="Feature"?l.properties:{};return el(b,T)}function Dl(l,A){A===void 0&&(A={});var y=getGeom(l),b=y.coordinates,T=A.properties?A.properties:l.type==="Feature"?l.properties:{},L=[];return b.forEach(function(R){L.push(el(R,T))}),featureCollection(L)}function el(l,A){return l.length>1?multiLineString(l,A):lineString(l[0],A)}function Kc(l,A){A===void 0&&(A={});var y,b,T,L=A.properties,R=(y=A.autoComplete)!==null&&y!==void 0?y:!0,U=(b=A.orderCoords)!==null&&b!==void 0?b:!0,H=(T=A.mutate)!==null&&T!==void 0?T:!1;switch(H||(l=clone(l)),l.type){case"FeatureCollection":var N=[];return l.features.forEach(function(Q){N.push(getCoords(Df(Q,{},R,U)))}),multiPolygon(N,L);default:return Df(l,L,R,U)}}function Df(l,A,y,b){A=A||(l.type==="Feature"?l.properties:{});var T=getGeom(l),L=T.coordinates,R=T.type;if(!L.length)throw new Error("line must contain coordinates");switch(R){case"LineString":return y&&(L=yl(L)),polygon([L],A);case"MultiLineString":var U=[],H=0;return L.forEach(function(N){if(y&&(N=yl(N)),b){var Q=bu(turfBBox(lineString(N)));Q>H?(U.unshift(N),H=Q):U.push(N)}else U.push(N)}),polygon(U,A);default:throw new Error("geometry type "+R+" is not supported")}}function yl(l){var A=l[0],y=A[0],b=A[1],T=l[l.length-1],L=T[0],R=T[1];return(y!==L||b!==R)&&l.push(A),l}function bu(l){var A=l[0],y=l[1],b=l[2],T=l[3];return Math.abs(A-b)*Math.abs(y-T)}var wo=null;function _l(l,A){var y=getGeom(l),b=y.type,T=l.type==="Feature"?l.properties:{},L=y.coordinates;switch(b){case"LineString":case"MultiLineString":{var R=[];return b==="LineString"&&(L=[L]),L.forEach(function(U){lineclip(U,A,R)}),R.length===1?lineString(R[0],T):multiLineString(R,T)}case"Polygon":return polygon(Zo(L,A),T);case"MultiPolygon":return multiPolygon(L.map(function(U){return Zo(U,A)}),T);default:throw new Error("geometry "+b+" not supported")}}function Zo(l,A){for(var y=[],b=0,T=l;b<T.length;b++){var L=T[b],R=polygonclip(L,A);R.length>0&&((R[0][0]!==R[R.length-1][0]||R[0][1]!==R[R.length-1][1])&&R.push(R[0]),R.length>=4&&y.push(R))}return y}var Su=C(19545);function Fu(l,A,y){if(y===void 0&&(y={}),y=y||{},!isObject(y))throw new Error("options is invalid");var b=y.tolerance||0,T=[],L=rbush(),R=lineSegment(l);L.load(R);var U;return segmentEach(A,function(H){var N=!1;H&&(featureEach(L.search(H),function(Q){if(N===!1){var K=getCoords(H).sort(),ie=getCoords(Q).sort();equal(K,ie)||(b===0?booleanPointOnLine(K[0],Q)&&booleanPointOnLine(K[1],Q):nearestPointOnLine(Q,K[0]).properties.dist<=b&&nearestPointOnLine(Q,K[1]).properties.dist<=b)?(N=!0,U?U=Jc(U,H):U=H):(b===0?booleanPointOnLine(ie[0],H)&&booleanPointOnLine(ie[1],H):nearestPointOnLine(H,ie[0]).properties.dist<=b&&nearestPointOnLine(H,ie[1]).properties.dist<=b)&&(U?U=Jc(U,Q):U=Q)}}),N===!1&&U&&(T.push(U),U=void 0))}),U&&T.push(U),featureCollection(T)}function Jc(l,A){var y=getCoords(A),b=getCoords(l),T=b[0],L=b[b.length-1],R=l.geometry.coordinates;return equal(y[0],T)?R.unshift(y[1]):equal(y[0],L)?R.push(y[1]):equal(y[1],T)?R.unshift(y[0]):equal(y[1],L)&&R.push(y[0]),l}var xl=null;function Bu(l,A,y,b,T){if(T=T||{},!isObject(T))throw new Error("options is invalid");var L=T.properties;if(!l)throw new Error("center is required");if(y==null)throw new Error("bearing1 is required");if(b==null)throw new Error("bearing2 is required");if(!A)throw new Error("radius is required");if(typeof T!="object")throw new Error("options must be an object");if(pu(y)===pu(b))return circle(l,A,T);var R=getCoords(l),U=lineArc(l,A,y,b,T),H=[[R]];return coordEach(U,function(N){H[0].push(N)}),H[0].push(R),polygon(H,L)}function pu(l){var A=l%360;return A<0&&(A+=360),A}var _o=null;function Cu(l,A,y){y===void 0&&(y={});var b;y.final?b=ho(getCoord(A),getCoord(l)):b=ho(getCoord(l),getCoord(A));var T=b>180?-(360-b):b;return T}function ho(l,A){var y=degreesToRadians(l[1]),b=degreesToRadians(A[1]),T=degreesToRadians(A[0]-l[0]);T>Math.PI&&(T-=2*Math.PI),T<-Math.PI&&(T+=2*Math.PI);var L=Math.log(Math.tan(b/2+Math.PI/4)/Math.tan(y/2+Math.PI/4)),R=Math.atan2(T,L);return(radiansToDegrees(R)+360)%360}var a0=null;function tl(l,A,y,b){b===void 0&&(b={});var T=A<0,L=convertLength(Math.abs(A),b.units,"meters");T&&(L=-Math.abs(L));var R=getCoord(l),U=rc(R,L,y);return U[0]+=U[0]-R[0]>180?-360:R[0]-U[0]>180?360:0,point(U,b.properties)}function rc(l,A,y,b){b=b===void 0?earthRadius:Number(b);var T=A/b,L=l[0]*Math.PI/180,R=degreesToRadians(l[1]),U=degreesToRadians(y),H=T*Math.cos(U),N=R+H;Math.abs(N)>Math.PI/2&&(N=N>0?Math.PI-N:-Math.PI-N);var Q=Math.log(Math.tan(N/2+Math.PI/4)/Math.tan(R/2+Math.PI/4)),K=Math.abs(Q)>1e-11?H/Q:Math.cos(R),ie=T*Math.sin(U)/K,pe=L+ie;return[(pe*180/Math.PI+540)%360-180,N*180/Math.PI]}var zo=null;function Qo(l,A){var y=getCoords(l),b=getCoords(A),T,L,R,U,H=calcBbox(A),N=0,Q=null;y[0]>H[0]&&y[0]<H[2]&&y[1]>H[1]&&y[1]<H[3]&&(Q=nearestPoint(l,explode(A)),N=Q.properties.featureIndex);var K=getType(A);switch(K){case"Polygon":T=b[0][N],L=b[0][0],Q!==null&&Q.geometry.coordinates[1]<y[1]&&(L=b[0][N]),U=Ls(b[0][0],b[0][b[0].length-1],y);var ie=Gs(b[0],y,U,R,T,L);T=ie[0],L=ie[1];break;case"MultiPolygon":for(var pe=0,pt=0,it=0,Nt=0;Nt<b[0].length;Nt++){pe=Nt;for(var dt=!1,Je=0;Je<b[0][Nt].length;Je++){if(pt=Je,it===N){dt=!0;break}it++}if(dt)break}T=b[0][pe][pt],L=b[0][pe][pt],U=Ls(b[0][0][0],b[0][0][b[0][0].length-1],y),b.forEach(function(ht){var Ht=Gs(ht[0],y,U,R,T,L);T=Ht[0],L=Ht[1]});break}return featureCollection([point(T),point(L)])}function Gs(l,A,y,b,T,L){for(var R=0;R<l.length;R++){var U=l[R],H=l[R+1];R===l.length-1&&(H=l[0]),b=Ls(U,H,A),y<=0&&b>0?yc(A,U,T)||(T=U):y>0&&b<=0&&(js(A,U,L)||(L=U)),y=b}return[T,L]}function js(l,A,y){return Ls(l,A,y)>0}function yc(l,A,y){return Ls(l,A,y)<0}function Ls(l,A,y){return(A[0]-l[0])*(y[1]-l[1])-(y[0]-l[0])*(A[1]-l[1])}var El=null;function To(l){for(var A=getCoords(l),y=0,b=1,T,L;b<A.length;)T=L||A[0],L=A[b],y+=(L[0]-T[0])*(L[1]+T[1]),b++;return y>0}function Vs(l,A){if(A=A||{},!isObject(A))throw new Error("options is invalid");var y=A.reverse||!1,b=A.mutate||!1;if(!l)throw new Error("<geojson> is required");if(typeof y!="boolean")throw new Error("<reverse> must be a boolean");if(typeof b!="boolean")throw new Error("<mutate> must be a boolean");b===!1&&(l=clone(l));var T=[];switch(l.type){case"GeometryCollection":return geomEach(l,function(L){Va(L,y)}),l;case"FeatureCollection":return featureEach(l,function(L){featureEach(Va(L,y),function(R){T.push(R)})}),featureCollection(T)}return Va(l,y)}function Va(l,A){var y=l.type==="Feature"?l.geometry.type:l.type;switch(y){case"GeometryCollection":return geomEach(l,function(b){Va(b,A)}),l;case"LineString":return ur(getCoords(l),A),l;case"Polygon":return bt(getCoords(l),A),l;case"MultiLineString":return getCoords(l).forEach(function(b){ur(b,A)}),l;case"MultiPolygon":return getCoords(l).forEach(function(b){bt(b,A)}),l;case"Point":case"MultiPoint":return l}}function ur(l,A){booleanClockwise(l)===A&&l.reverse()}function bt(l,A){booleanClockwise(l[0])!==A&&l[0].reverse();for(var y=1;y<l.length;y++)booleanClockwise(l[y])===A&&l[y].reverse()}var Ce=null;function Hs(l,A){if(A=A||{},!isObject(A))throw new Error("options is invalid");var y=A.zProperty||"elevation",b=A.flip,T=A.flags;collectionOf(l,"Point","input must contain Points");for(var L=nt(l,b),R=[],U=0;U<L.length;U++){for(var H=L[U],N=[],Q=0;Q<H.length;Q++){var K=H[Q];K.properties[y]?N.push(K.properties[y]):N.push(0),T===!0&&(K.properties.matrixPosition=[U,Q])}R.push(N)}return R}function nt(l,A){var y={};featureEach(l,function(L){var R=getCoords(L)[1];y[R]||(y[R]=[]),y[R].push(L)});var b=Object.keys(y).map(function(L){var R=y[L],U=R.sort(function(H,N){return getCoords(H)[0]-getCoords(N)[0]});return U}),T=b.sort(function(L,R){return A?getCoords(L[0])[1]-getCoords(R[0])[1]:getCoords(R[0])[1]-getCoords(L[0])[1]});return T}var rl={successCallback:null,verbose:!1,polygons:!1},xa={};function $s(l,A,y,b){b=b||{};for(var T=Object.keys(rl),L=0;L<T.length;L++){var R=T[L],U=b[R];U=typeof U!="undefined"&&U!==null?U:rl[R],xa[R]=U}xa.verbose&&console.log("MarchingSquaresJS-isoBands: computing isobands for ["+A+":"+(A+y)+"]");var H=Bi(l,A,y),N;return xa.polygons?(xa.verbose&&console.log("MarchingSquaresJS-isoBands: returning single polygons for each grid cell"),N=o0(H)):(xa.verbose&&console.log("MarchingSquaresJS-isoBands: returning polygon paths for entire data grid"),N=lt(H)),typeof xa.successCallback=="function"&&xa.successCallback(N),N}var ai=64,ca=16,bi=4,$a=1,Ii=[],Hn=[],mi=[],Wi=[],_i=[],di=[],wn=[],Yn=[],Li=[],qn=[],Ui=[],Gi=[],Nn=[],Yi=[],$n=[],Pi=[],Oi=[],Qi=[],qi=[],hi=[],Si=[],Ci=[],ji=[],si=[];wn[85]=qn[85]=-1,Yn[85]=Ui[85]=0,Li[85]=Gi[85]=1,qi[85]=Ci[85]=1,hi[85]=ji[85]=0,Si[85]=si[85]=1,Ii[85]=Wi[85]=0,Hn[85]=_i[85]=-1,mi[85]=$n[85]=0,Pi[85]=Nn[85]=0,Oi[85]=Yi[85]=1,di[85]=Qi[85]=1,Ci[1]=Ci[169]=0,ji[1]=ji[169]=-1,si[1]=si[169]=0,Nn[1]=Nn[169]=-1,Yi[1]=Yi[169]=0,$n[1]=$n[169]=0,qn[4]=qn[166]=0,Ui[4]=Ui[166]=-1,Gi[4]=Gi[166]=1,Pi[4]=Pi[166]=1,Oi[4]=Oi[166]=0,Qi[4]=Qi[166]=0,wn[16]=wn[154]=0,Yn[16]=Yn[154]=1,Li[16]=Li[154]=1,Wi[16]=Wi[154]=1,_i[16]=_i[154]=0,di[16]=di[154]=1,qi[64]=qi[106]=0,hi[64]=hi[106]=1,Si[64]=Si[106]=0,Ii[64]=Ii[106]=-1,Hn[64]=Hn[106]=0,mi[64]=mi[106]=1,qi[2]=qi[168]=0,hi[2]=hi[168]=-1,Si[2]=Si[168]=1,Ci[2]=Ci[168]=0,ji[2]=ji[168]=-1,si[2]=si[168]=0,Nn[2]=Nn[168]=-1,Yi[2]=Yi[168]=0,$n[2]=$n[168]=0,Pi[2]=Pi[168]=-1,Oi[2]=Oi[168]=0,Qi[2]=Qi[168]=1,wn[8]=wn[162]=0,Yn[8]=Yn[162]=-1,Li[8]=Li[162]=0,qn[8]=qn[162]=0,Ui[8]=Ui[162]=-1,Gi[8]=Gi[162]=1,Nn[8]=Nn[162]=1,Yi[8]=Yi[162]=0,$n[8]=$n[162]=1,Pi[8]=Pi[162]=1,Oi[8]=Oi[162]=0,Qi[8]=Qi[162]=0,wn[32]=wn[138]=0,Yn[32]=Yn[138]=1,Li[32]=Li[138]=1,qn[32]=qn[138]=0,Ui[32]=Ui[138]=1,Gi[32]=Gi[138]=0,Ii[32]=Ii[138]=1,Hn[32]=Hn[138]=0,mi[32]=mi[138]=0,Wi[32]=Wi[138]=1,_i[32]=_i[138]=0,di[32]=di[138]=1,Ci[128]=Ci[42]=0,ji[128]=ji[42]=1,si[128]=si[42]=1,qi[128]=qi[42]=0,hi[128]=hi[42]=1,Si[128]=Si[42]=0,Ii[128]=Ii[42]=-1,Hn[128]=Hn[42]=0,mi[128]=mi[42]=1,Wi[128]=Wi[42]=-1,_i[128]=_i[42]=0,di[128]=di[42]=0,qn[5]=qn[165]=-1,Ui[5]=Ui[165]=0,Gi[5]=Gi[165]=0,Ci[5]=Ci[165]=1,ji[5]=ji[165]=0,si[5]=si[165]=0,Pi[20]=Pi[150]=0,Oi[20]=Oi[150]=1,Qi[20]=Qi[150]=1,Wi[20]=Wi[150]=0,_i[20]=_i[150]=-1,di[20]=di[150]=1,wn[80]=wn[90]=-1,Yn[80]=Yn[90]=0,Li[80]=Li[90]=1,qi[80]=qi[90]=1,hi[80]=hi[90]=0,Si[80]=Si[90]=1,Nn[65]=Nn[105]=0,Yi[65]=Yi[105]=1,$n[65]=$n[105]=0,Ii[65]=Ii[105]=0,Hn[65]=Hn[105]=-1,mi[65]=mi[105]=0,wn[160]=wn[10]=-1,Yn[160]=Yn[10]=0,Li[160]=Li[10]=1,qn[160]=qn[10]=-1,Ui[160]=Ui[10]=0,Gi[160]=Gi[10]=0,Ci[160]=Ci[10]=1,ji[160]=ji[10]=0,si[160]=si[10]=0,qi[160]=qi[10]=1,hi[160]=hi[10]=0,Si[160]=Si[10]=1,Pi[130]=Pi[40]=0,Oi[130]=Oi[40]=1,Qi[130]=Qi[40]=1,Nn[130]=Nn[40]=0,Yi[130]=Yi[40]=1,$n[130]=$n[40]=0,Ii[130]=Ii[40]=0,Hn[130]=Hn[40]=-1,mi[130]=mi[40]=0,Wi[130]=Wi[40]=0,_i[130]=_i[40]=-1,di[130]=di[40]=1,qn[37]=qn[133]=0,Ui[37]=Ui[133]=1,Gi[37]=Gi[133]=1,Ci[37]=Ci[133]=0,ji[37]=ji[133]=1,si[37]=si[133]=0,Ii[37]=Ii[133]=-1,Hn[37]=Hn[133]=0,mi[37]=mi[133]=0,Wi[37]=Wi[133]=1,_i[37]=_i[133]=0,di[37]=di[133]=0,Pi[148]=Pi[22]=-1,Oi[148]=Oi[22]=0,Qi[148]=Qi[22]=0,Ci[148]=Ci[22]=0,ji[148]=ji[22]=-1,si[148]=si[22]=1,qi[148]=qi[22]=0,hi[148]=hi[22]=1,Si[148]=Si[22]=1,Wi[148]=Wi[22]=-1,_i[148]=_i[22]=0,di[148]=di[22]=1,wn[82]=wn[88]=0,Yn[82]=Yn[88]=-1,Li[82]=Li[88]=1,Pi[82]=Pi[88]=1,Oi[82]=Oi[88]=0,Qi[82]=Qi[88]=1,Nn[82]=Nn[88]=-1,Yi[82]=Yi[88]=0,$n[82]=$n[88]=1,qi[82]=qi[88]=0,hi[82]=hi[88]=-1,Si[82]=Si[88]=0,wn[73]=wn[97]=0,Yn[73]=Yn[97]=1,Li[73]=Li[97]=0,qn[73]=qn[97]=0,Ui[73]=Ui[97]=-1,Gi[73]=Gi[97]=0,Nn[73]=Nn[97]=1,Yi[73]=Yi[97]=0,$n[73]=$n[97]=0,Ii[73]=Ii[97]=1,Hn[73]=Hn[97]=0,mi[73]=mi[97]=1,wn[145]=wn[25]=0,Yn[145]=Yn[25]=-1,Li[145]=Li[25]=0,Nn[145]=Nn[25]=1,Yi[145]=Yi[25]=0,$n[145]=$n[25]=1,Ci[145]=Ci[25]=0,ji[145]=ji[25]=1,si[145]=si[25]=1,Wi[145]=Wi[25]=-1,_i[145]=_i[25]=0,di[145]=di[25]=0,qn[70]=qn[100]=0,Ui[70]=Ui[100]=1,Gi[70]=Gi[100]=0,Pi[70]=Pi[100]=-1,Oi[70]=Oi[100]=0,Qi[70]=Qi[100]=1,qi[70]=qi[100]=0,hi[70]=hi[100]=-1,Si[70]=Si[100]=1,Ii[70]=Ii[100]=1,Hn[70]=Hn[100]=0,mi[70]=mi[100]=0,qn[101]=qn[69]=0,Ui[101]=Ui[69]=1,Gi[101]=Gi[69]=0,Ii[101]=Ii[69]=1,Hn[101]=Hn[69]=0,mi[101]=mi[69]=0,Ci[149]=Ci[21]=0,ji[149]=ji[21]=1,si[149]=si[21]=1,Wi[149]=Wi[21]=-1,_i[149]=_i[21]=0,di[149]=di[21]=0,Pi[86]=Pi[84]=-1,Oi[86]=Oi[84]=0,Qi[86]=Qi[84]=1,qi[86]=qi[84]=0,hi[86]=hi[84]=-1,Si[86]=Si[84]=1,wn[89]=wn[81]=0,Yn[89]=Yn[81]=-1,Li[89]=Li[81]=0,Nn[89]=Nn[81]=1,Yi[89]=Yi[81]=0,$n[89]=$n[81]=1,wn[96]=wn[74]=0,Yn[96]=Yn[74]=1,Li[96]=Li[74]=0,qn[96]=qn[74]=-1,Ui[96]=Ui[74]=0,Gi[96]=Gi[74]=1,qi[96]=qi[74]=1,hi[96]=hi[74]=0,Si[96]=Si[74]=0,Ii[96]=Ii[74]=1,Hn[96]=Hn[74]=0,mi[96]=mi[74]=1,wn[24]=wn[146]=0,Yn[24]=Yn[146]=-1,Li[24]=Li[146]=1,Pi[24]=Pi[146]=1,Oi[24]=Oi[146]=0,Qi[24]=Qi[146]=1,Nn[24]=Nn[146]=0,Yi[24]=Yi[146]=1,$n[24]=$n[146]=1,Wi[24]=Wi[146]=0,_i[24]=_i[146]=-1,di[24]=di[146]=0,qn[6]=qn[164]=-1,Ui[6]=Ui[164]=0,Gi[6]=Gi[164]=1,Pi[6]=Pi[164]=-1,Oi[6]=Oi[164]=0,Qi[6]=Qi[164]=0,Ci[6]=Ci[164]=0,ji[6]=ji[164]=-1,si[6]=si[164]=1,qi[6]=qi[164]=1,hi[6]=hi[164]=0,Si[6]=Si[164]=0,Nn[129]=Nn[41]=0,Yi[129]=Yi[41]=1,$n[129]=$n[41]=1,Ci[129]=Ci[41]=0,ji[129]=ji[41]=1,si[129]=si[41]=0,Ii[129]=Ii[41]=-1,Hn[129]=Hn[41]=0,mi[129]=mi[41]=0,Wi[129]=Wi[41]=0,_i[129]=_i[41]=-1,di[129]=di[41]=0,Pi[66]=Pi[104]=0,Oi[66]=Oi[104]=1,Qi[66]=Qi[104]=0,Nn[66]=Nn[104]=-1,Yi[66]=Yi[104]=0,$n[66]=$n[104]=1,qi[66]=qi[104]=0,hi[66]=hi[104]=-1,Si[66]=Si[104]=0,Ii[66]=Ii[104]=0,Hn[66]=Hn[104]=-1,mi[66]=mi[104]=1,wn[144]=wn[26]=-1,Yn[144]=Yn[26]=0,Li[144]=Li[26]=0,Ci[144]=Ci[26]=1,ji[144]=ji[26]=0,si[144]=si[26]=1,qi[144]=qi[26]=0,hi[144]=hi[26]=1,Si[144]=Si[26]=1,Wi[144]=Wi[26]=-1,_i[144]=_i[26]=0,di[144]=di[26]=1,qn[36]=qn[134]=0,Ui[36]=Ui[134]=1,Gi[36]=Gi[134]=1,Pi[36]=Pi[134]=0,Oi[36]=Oi[134]=1,Qi[36]=Qi[134]=0,Ii[36]=Ii[134]=0,Hn[36]=Hn[134]=-1,mi[36]=mi[134]=1,Wi[36]=Wi[134]=1,_i[36]=_i[134]=0,di[36]=di[134]=0,wn[9]=wn[161]=-1,Yn[9]=Yn[161]=0,Li[9]=Li[161]=0,qn[9]=qn[161]=0,Ui[9]=Ui[161]=-1,Gi[9]=Gi[161]=0,Nn[9]=Nn[161]=1,Yi[9]=Yi[161]=0,$n[9]=$n[161]=0,Ci[9]=Ci[161]=1,ji[9]=ji[161]=0,si[9]=si[161]=1,wn[136]=0,Yn[136]=1,Li[136]=1,qn[136]=0,Ui[136]=1,Gi[136]=0,Pi[136]=-1,Oi[136]=0,Qi[136]=1,Nn[136]=-1,Yi[136]=0,$n[136]=0,Ci[136]=0,ji[136]=-1,si[136]=0,qi[136]=0,hi[136]=-1,Si[136]=1,Ii[136]=1,Hn[136]=0,mi[136]=0,Wi[136]=1,_i[136]=0,di[136]=1,wn[34]=0,Yn[34]=-1,Li[34]=0,qn[34]=0,Ui[34]=-1,Gi[34]=1,Pi[34]=1,Oi[34]=0,Qi[34]=0,Nn[34]=1,Yi[34]=0,$n[34]=1,Ci[34]=0,ji[34]=1,si[34]=1,qi[34]=0,hi[34]=1,Si[34]=0,Ii[34]=-1,Hn[34]=0,mi[34]=1,Wi[34]=-1,_i[34]=0,di[34]=0,wn[35]=0,Yn[35]=1,Li[35]=1,qn[35]=0,Ui[35]=-1,Gi[35]=1,Pi[35]=1,Oi[35]=0,Qi[35]=0,Nn[35]=-1,Yi[35]=0,$n[35]=0,Ci[35]=0,ji[35]=-1,si[35]=0,qi[35]=0,hi[35]=1,Si[35]=0,Ii[35]=-1,Hn[35]=0,mi[35]=1,Wi[35]=1,_i[35]=0,di[35]=1,wn[153]=0,Yn[153]=1,Li[153]=1,Nn[153]=-1,Yi[153]=0,$n[153]=0,Ci[153]=0,ji[153]=-1,si[153]=0,Wi[153]=1,_i[153]=0,di[153]=1,qn[102]=0,Ui[102]=-1,Gi[102]=1,Pi[102]=1,Oi[102]=0,Qi[102]=0,qi[102]=0,hi[102]=1,Si[102]=0,Ii[102]=-1,Hn[102]=0,mi[102]=1,wn[155]=0,Yn[155]=-1,Li[155]=0,Nn[155]=1,Yi[155]=0,$n[155]=1,Ci[155]=0,ji[155]=1,si[155]=1,Wi[155]=-1,_i[155]=0,di[155]=0,qn[103]=0,Ui[103]=1,Gi[103]=0,Pi[103]=-1,Oi[103]=0,Qi[103]=1,qi[103]=0,hi[103]=-1,Si[103]=1,Ii[103]=1,Hn[103]=0,mi[103]=0,wn[152]=0,Yn[152]=1,Li[152]=1,Pi[152]=-1,Oi[152]=0,Qi[152]=1,Nn[152]=-1,Yi[152]=0,$n[152]=0,Ci[152]=0,ji[152]=-1,si[152]=0,qi[152]=0,hi[152]=-1,Si[152]=1,Wi[152]=1,_i[152]=0,di[152]=1,wn[156]=0,Yn[156]=-1,Li[156]=1,Pi[156]=1,Oi[156]=0,Qi[156]=1,Nn[156]=-1,Yi[156]=0,$n[156]=0,Ci[156]=0,ji[156]=-1,si[156]=0,qi[156]=0,hi[156]=1,Si[156]=1,Wi[156]=-1,_i[156]=0,di[156]=1,wn[137]=0,Yn[137]=1,Li[137]=1,qn[137]=0,Ui[137]=1,Gi[137]=0,Nn[137]=-1,Yi[137]=0,$n[137]=0,Ci[137]=0,ji[137]=-1,si[137]=0,Ii[137]=1,Hn[137]=0,mi[137]=0,Wi[137]=1,_i[137]=0,di[137]=1,wn[139]=0,Yn[139]=1,Li[139]=1,qn[139]=0,Ui[139]=-1,Gi[139]=0,Nn[139]=1,Yi[139]=0,$n[139]=0,Ci[139]=0,ji[139]=1,si[139]=0,Ii[139]=-1,Hn[139]=0,mi[139]=0,Wi[139]=1,_i[139]=0,di[139]=1,wn[98]=0,Yn[98]=-1,Li[98]=0,qn[98]=0,Ui[98]=-1,Gi[98]=1,Pi[98]=1,Oi[98]=0,Qi[98]=0,Nn[98]=1,Yi[98]=0,$n[98]=1,qi[98]=0,hi[98]=1,Si[98]=0,Ii[98]=-1,Hn[98]=0,mi[98]=1,wn[99]=0,Yn[99]=1,Li[99]=0,qn[99]=0,Ui[99]=-1,Gi[99]=1,Pi[99]=1,Oi[99]=0,Qi[99]=0,Nn[99]=-1,Yi[99]=0,$n[99]=1,qi[99]=0,hi[99]=-1,Si[99]=0,Ii[99]=1,Hn[99]=0,mi[99]=1,qn[38]=0,Ui[38]=-1,Gi[38]=1,Pi[38]=1,Oi[38]=0,Qi[38]=0,Ci[38]=0,ji[38]=1,si[38]=1,qi[38]=0,hi[38]=1,Si[38]=0,Ii[38]=-1,Hn[38]=0,mi[38]=1,Wi[38]=-1,_i[38]=0,di[38]=0,qn[39]=0,Ui[39]=1,Gi[39]=1,Pi[39]=-1,Oi[39]=0,Qi[39]=0,Ci[39]=0,ji[39]=-1,si[39]=1,qi[39]=0,hi[39]=1,Si[39]=0,Ii[39]=-1,Hn[39]=0,mi[39]=1,Wi[39]=1,_i[39]=0,di[39]=0;var wu=function(l){return[[l.bottomleft,0],[0,0],[0,l.leftbottom]]},qo=function(l){return[[1,l.rightbottom],[1,0],[l.bottomright,0]]},nl=function(l){return[[l.topright,1],[1,1],[1,l.righttop]]},Zu=function(l){return[[0,l.lefttop],[0,1],[l.topleft,1]]},Fn=function(l){return[[l.bottomright,0],[l.bottomleft,0],[0,l.leftbottom],[0,l.lefttop]]},Ko=function(l){return[[l.bottomright,0],[l.bottomleft,0],[1,l.righttop],[1,l.rightbottom]]},Ws=function(l){return[[1,l.righttop],[1,l.rightbottom],[l.topleft,1],[l.topright,1]]},du=function(l){return[[0,l.leftbottom],[0,l.lefttop],[l.topleft,1],[l.topright,1]]},gs=function(l){return[[0,0],[0,l.leftbottom],[1,l.rightbottom],[1,0]]},bl=function(l){return[[1,0],[l.bottomright,0],[l.topright,1],[1,1]]},ms=function(l){return[[1,1],[1,l.righttop],[0,l.lefttop],[0,1]]},ka=function(l){return[[l.bottomleft,0],[0,0],[0,1],[l.topleft,1]]},il=function(l){return[[1,l.righttop],[1,l.rightbottom],[0,l.leftbottom],[0,l.lefttop]]},ef=function(l){return[[l.topleft,1],[l.topright,1],[l.bottomright,0],[l.bottomleft,0]]},o=function(){return[[0,0],[0,1],[1,1],[1,0]]},s=function(l){return[[1,l.rightbottom],[1,0],[0,0],[0,1],[l.topleft,1]]},d=function(l){return[[l.topright,1],[1,1],[1,0],[0,0],[0,l.leftbottom]]},_=function(l){return[[1,0],[l.bottomright,0],[0,l.lefttop],[0,1],[1,1]]},w=function(l){return[[1,1],[1,l.righttop],[l.bottomleft,0],[0,0],[0,1]]},j=function(l){return[[1,l.righttop],[1,l.rightbottom],[0,l.lefttop],[0,1],[l.topleft,1]]},re=function(l){return[[1,1],[1,l.righttop],[l.bottomright,0],[l.bottomleft,0],[l.topright,1]]},Pe=function(l){return[[1,l.rightbottom],[1,0],[l.bottomright,0],[0,l.leftbottom],[0,l.lefttop]]},tt=function(l){return[[l.topright,1],[l.bottomleft,0],[0,0],[0,l.leftbottom],[l.topleft,1]]},It=function(l){return[[l.bottomright,0],[l.bottomleft,0],[0,l.lefttop],[0,1],[l.topleft,1]]},tr=function(l){return[[1,1],[1,l.righttop],[0,l.leftbottom],[0,l.lefttop],[l.topright,1]]},ot=function(l){return[[1,l.rightbottom],[1,0],[l.bottomright,0],[l.topleft,1],[l.topright,1]]},Zt=function(l){return[[1,l.righttop],[1,l.rightbottom],[l.bottomleft,0],[0,0],[0,l.leftbottom]]},Jt=function(l){return[[1,l.rightbottom],[1,0],[0,0],[0,l.leftbottom],[l.topleft,1],[l.topright,1]]},gr=function(l){return[[1,1],[1,0],[l.bottomright,0],[0,l.leftbottom],[0,l.lefttop],[l.topright,1]]},v=function(l){return[[1,1],[1,l.righttop],[l.bottomright,0],[l.bottomleft,0],[0,l.lefttop],[0,1]]},Ln=function(l){return[[1,l.righttop],[1,l.rightbottom],[l.bottomleft,0],[0,0],[0,1],[l.topleft,1]]},jn=function(l){return[[1,1],[1,l.righttop],[l.bottomleft,0],[0,0],[0,l.leftbottom],[l.topright,1]]},Xe=function(l){return[[1,l.rightbottom],[1,0],[l.bottomright,0],[0,l.lefttop],[0,1],[l.topleft,1]]},Ma=function(l){return[[1,l.righttop],[1,l.rightbottom],[l.bottomright,0],[l.bottomleft,0],[0,l.leftbottom],[0,l.lefttop],[l.topleft,1],[l.topright,1]]},ao=function(l){return[[1,1],[1,l.righttop],[l.bottomleft,0],[0,0],[0,l.leftbottom],[l.topright,1]]},xo=function(l){return[[1,l.rightbottom],[1,0],[l.bottomright,0],[0,l.lefttop],[0,1],[l.topleft,1]]},aa=function(l){return[[1,1],[1,l.righttop],[l.bottomright,0],[l.bottomleft,0],[0,l.leftbottom],[0,l.lefttop],[l.topright,1]]},Da=function(l){return[[1,l.righttop],[1,l.rightbottom],[l.bottomleft,0],[0,0],[0,l.leftbottom],[l.topleft,1],[l.topright,1]]},us=function(l){return[[1,l.righttop],[1,l.rightbottom],[l.bottomright,0],[l.bottomleft,0],[0,l.lefttop],[0,1],[l.topleft,1]]},Ea=function(l){return[[1,l.rightbottom],[1,0],[l.bottomright,0],[0,l.leftbottom],[0,l.lefttop],[l.topleft,1],[l.topright,1]]},Vr=[],hn=[],Wn=[],kn=[],Kn=[],Pn=[],Fi=[],wi=[];kn[1]=Kn[1]=18,kn[169]=Kn[169]=18,Wn[4]=hn[4]=12,Wn[166]=hn[166]=12,Vr[16]=wi[16]=4,Vr[154]=wi[154]=4,Pn[64]=Fi[64]=22,Pn[106]=Fi[106]=22,Wn[2]=Pn[2]=17,kn[2]=Kn[2]=18,Wn[168]=Pn[168]=17,kn[168]=Kn[168]=18,Vr[8]=kn[8]=9,hn[8]=Wn[8]=12,Vr[162]=kn[162]=9,hn[162]=Wn[162]=12,Vr[32]=wi[32]=4,hn[32]=Fi[32]=1,Vr[138]=wi[138]=4,hn[138]=Fi[138]=1,Kn[128]=wi[128]=21,Pn[128]=Fi[128]=22,Kn[42]=wi[42]=21,Pn[42]=Fi[42]=22,hn[5]=Kn[5]=14,hn[165]=Kn[165]=14,Wn[20]=wi[20]=6,Wn[150]=wi[150]=6,Vr[80]=Pn[80]=11,Vr[90]=Pn[90]=11,kn[65]=Fi[65]=3,kn[105]=Fi[105]=3,Vr[160]=Pn[160]=11,hn[160]=Kn[160]=14,Vr[10]=Pn[10]=11,hn[10]=Kn[10]=14,Wn[130]=wi[130]=6,kn[130]=Fi[130]=3,Wn[40]=wi[40]=6,kn[40]=Fi[40]=3,hn[101]=Fi[101]=1,hn[69]=Fi[69]=1,Kn[149]=wi[149]=21,Kn[21]=wi[21]=21,Wn[86]=Pn[86]=17,Wn[84]=Pn[84]=17,Vr[89]=kn[89]=9,Vr[81]=kn[81]=9,Vr[96]=Fi[96]=0,hn[96]=Pn[96]=15,Vr[74]=Fi[74]=0,hn[74]=Pn[74]=15,Vr[24]=Wn[24]=8,kn[24]=wi[24]=7,Vr[146]=Wn[146]=8,kn[146]=wi[146]=7,hn[6]=Pn[6]=15,Wn[6]=Kn[6]=16,hn[164]=Pn[164]=15,Wn[164]=Kn[164]=16,kn[129]=wi[129]=7,Kn[129]=Fi[129]=20,kn[41]=wi[41]=7,Kn[41]=Fi[41]=20,Wn[66]=Fi[66]=2,kn[66]=Pn[66]=19,Wn[104]=Fi[104]=2,kn[104]=Pn[104]=19,Vr[144]=Kn[144]=10,Pn[144]=wi[144]=23,Vr[26]=Kn[26]=10,Pn[26]=wi[26]=23,hn[36]=wi[36]=5,Wn[36]=Fi[36]=2,hn[134]=wi[134]=5,Wn[134]=Fi[134]=2,Vr[9]=Kn[9]=10,hn[9]=kn[9]=13,Vr[161]=Kn[161]=10,hn[161]=kn[161]=13,hn[37]=wi[37]=5,Kn[37]=Fi[37]=20,hn[133]=wi[133]=5,Kn[133]=Fi[133]=20,Wn[148]=Kn[148]=16,Pn[148]=wi[148]=23,Wn[22]=Kn[22]=16,Pn[22]=wi[22]=23,Vr[82]=Wn[82]=8,kn[82]=Pn[82]=19,Vr[88]=Wn[88]=8,kn[88]=Pn[88]=19,Vr[73]=Fi[73]=0,hn[73]=kn[73]=13,Vr[97]=Fi[97]=0,hn[97]=kn[97]=13,Vr[145]=kn[145]=9,Kn[145]=wi[145]=21,Vr[25]=kn[25]=9,Kn[25]=wi[25]=21,hn[70]=Fi[70]=1,Wn[70]=Pn[70]=17,hn[100]=Fi[100]=1,Wn[100]=Pn[100]=17,Vr[34]=kn[34]=9,hn[34]=Wn[34]=12,Kn[34]=wi[34]=21,Pn[34]=Fi[34]=22,Vr[136]=wi[136]=4,hn[136]=Fi[136]=1,Wn[136]=Pn[136]=17,kn[136]=Kn[136]=18,Vr[35]=wi[35]=4,hn[35]=Wn[35]=12,kn[35]=Kn[35]=18,Pn[35]=Fi[35]=22,Vr[153]=wi[153]=4,kn[153]=Kn[153]=18,hn[102]=Wn[102]=12,Pn[102]=Fi[102]=22,Vr[155]=kn[155]=9,Kn[155]=wi[155]=23,hn[103]=Fi[103]=1,Wn[103]=Pn[103]=17,Vr[152]=wi[152]=4,Wn[152]=Pn[152]=17,kn[152]=Kn[152]=18,Vr[156]=Wn[156]=8,kn[156]=Kn[156]=18,Pn[156]=wi[156]=23,Vr[137]=wi[137]=4,hn[137]=Fi[137]=1,kn[137]=Kn[137]=18,Vr[139]=wi[139]=4,hn[139]=kn[139]=13,Kn[139]=Fi[139]=20,Vr[98]=kn[98]=9,hn[98]=Wn[98]=12,Pn[98]=Fi[98]=22,Vr[99]=Fi[99]=0,hn[99]=Wn[99]=12,kn[99]=Pn[99]=19,hn[38]=Wn[38]=12,Kn[38]=wi[38]=21,Pn[38]=Fi[38]=22,hn[39]=wi[39]=5,Wn[39]=Kn[39]=16,Pn[39]=Fi[39]=22;var An=[];An[1]=An[169]=wu,An[4]=An[166]=qo,An[16]=An[154]=nl,An[64]=An[106]=Zu,An[168]=An[2]=Fn,An[162]=An[8]=Ko,An[138]=An[32]=Ws,An[42]=An[128]=du,An[5]=An[165]=gs,An[20]=An[150]=bl,An[80]=An[90]=ms,An[65]=An[105]=ka,An[160]=An[10]=il,An[130]=An[40]=ef,An[85]=o,An[101]=An[69]=s,An[149]=An[21]=d,An[86]=An[84]=_,An[89]=An[81]=w,An[96]=An[74]=j,An[24]=An[146]=re,An[6]=An[164]=Pe,An[129]=An[41]=tt,An[66]=An[104]=It,An[144]=An[26]=tr,An[36]=An[134]=ot,An[9]=An[161]=Zt,An[37]=An[133]=Jt,An[148]=An[22]=gr,An[82]=An[88]=v,An[73]=An[97]=Ln,An[145]=An[25]=jn,An[70]=An[100]=Xe,An[34]=function(l){return[du(l),Ko(l)]},An[35]=Ma,An[136]=function(l){return[Ws(l),Fn(l)]},An[153]=function(l){return[nl(l),wu(l)]},An[102]=function(l){return[qo(l),Zu(l)]},An[155]=ao,An[103]=xo,An[152]=function(l){return[nl(l),Fn(l)]},An[156]=aa,An[137]=function(l){return[Ws(l),wu(l)]},An[139]=Da,An[98]=function(l){return[Ko(l),Zu(l)]},An[99]=us,An[38]=function(l){return[qo(l),du(l)]},An[39]=Ea;function Ue(l,A,y){return(l-A)/(y-A)}function al(l){return l.constructor.toString().indexOf("Array")>-1}function Bi(l,A,y){for(var b=l.length-1,T=l[0].length-1,L={rows:b,cols:T,cells:[]},R=A+Math.abs(y),U=0;U<b;++U){L.cells[U]=[];for(var H=0;H<T;++H){var N=0,Q=l[U+1][H],K=l[U+1][H+1],ie=l[U][H+1],pe=l[U][H];if(!(isNaN(Q)||isNaN(K)||isNaN(ie)||isNaN(pe))){N|=Q<A?0:Q>R?128:64,N|=K<A?0:K>R?32:16,N|=ie<A?0:ie>R?8:4,N|=pe<A?0:pe>R?2:1;var pt=+N,it=0;if(N===17||N===18||N===33||N===34||N===38||N===68||N===72||N===98||N===102||N===132||N===136||N===137||N===152||N===153){var Nt=(Q+K+ie+pe)/4;it=Nt>R?2:Nt<A?0:1,N===34?it===1?N=35:it===0&&(N=136):N===136?it===1?(N=35,it=4):it===0&&(N=34):N===17?it===1?(N=155,it=4):it===0&&(N=153):N===68?it===1?(N=103,it=4):it===0&&(N=102):N===153?it===1&&(N=155):N===102?it===1&&(N=103):N===152?it<2&&(N=156,it=1):N===137?it<2&&(N=139,it=1):N===98?it<2&&(N=99,it=1):N===38?it<2&&(N=39,it=1):N===18?it>0?(N=156,it=4):N=152:N===33?it>0?(N=139,it=4):N=137:N===72?it>0?(N=99,it=4):N=98:N===132&&(it>0?(N=39,it=4):N=38)}if(N!=0&&N!=170){var dt,Je,ht,Ht,Bt,ir,Kt,fr;dt=Je=ht=Ht=Bt=ir=Kt=fr=.5;var Ct=[];N===1?(ht=1-Ue(A,ie,pe),fr=1-Ue(A,Q,pe),Ct.push(kn[N])):N===169?(ht=Ue(R,pe,ie),fr=Ue(R,pe,Q),Ct.push(kn[N])):N===4?(ir=1-Ue(A,K,ie),Ht=Ue(A,pe,ie),Ct.push(hn[N])):N===166?(ir=Ue(R,ie,K),Ht=1-Ue(R,ie,pe),Ct.push(hn[N])):N===16?(Bt=Ue(A,ie,K),Je=Ue(A,Q,K),Ct.push(Vr[N])):N===154?(Bt=1-Ue(R,K,ie),Je=1-Ue(R,K,Q),Ct.push(Vr[N])):N===64?(Kt=Ue(A,pe,Q),dt=1-Ue(A,K,Q),Ct.push(Pn[N])):N===106?(Kt=1-Ue(R,Q,pe),dt=Ue(R,Q,K),Ct.push(Pn[N])):N===168?(Ht=Ue(R,pe,ie),ht=Ue(A,pe,ie),fr=Ue(A,pe,Q),Kt=Ue(R,pe,Q),Ct.push(Wn[N]),Ct.push(kn[N])):N===2?(Ht=1-Ue(A,ie,pe),ht=1-Ue(R,ie,pe),fr=1-Ue(R,Q,pe),Kt=1-Ue(A,Q,pe),Ct.push(Wn[N]),Ct.push(kn[N])):N===162?(Bt=Ue(R,ie,K),ir=Ue(A,ie,K),Ht=1-Ue(A,ie,pe),ht=1-Ue(R,ie,pe),Ct.push(Wn[N]),Ct.push(kn[N])):N===8?(Bt=1-Ue(A,K,ie),ir=1-Ue(R,K,ie),Ht=Ue(R,pe,ie),ht=Ue(A,pe,ie),Ct.push(Vr[N]),Ct.push(hn[N])):N===138?(Bt=1-Ue(A,K,ie),ir=1-Ue(R,K,ie),dt=1-Ue(R,K,Q),Je=1-Ue(A,K,Q),Ct.push(Vr[N]),Ct.push(hn[N])):N===32?(Bt=Ue(R,ie,K),ir=Ue(A,ie,K),dt=Ue(A,Q,K),Je=Ue(R,Q,K),Ct.push(Vr[N]),Ct.push(hn[N])):N===42?(fr=1-Ue(R,Q,pe),Kt=1-Ue(A,Q,pe),dt=Ue(A,Q,K),Je=Ue(R,Q,K),Ct.push(Kn[N]),Ct.push(Pn[N])):N===128&&(fr=Ue(A,pe,Q),Kt=Ue(R,pe,Q),dt=1-Ue(R,K,Q),Je=1-Ue(A,K,Q),Ct.push(Kn[N]),Ct.push(Pn[N])),N===5?(ir=1-Ue(A,K,ie),fr=1-Ue(A,Q,pe),Ct.push(hn[N])):N===165?(ir=Ue(R,ie,K),fr=Ue(R,pe,Q),Ct.push(hn[N])):N===20?(Ht=Ue(A,pe,ie),Je=Ue(A,Q,K),Ct.push(Wn[N])):N===150?(Ht=1-Ue(R,ie,pe),Je=1-Ue(R,K,Q),Ct.push(Wn[N])):N===80?(Bt=Ue(A,ie,K),Kt=Ue(A,pe,Q),Ct.push(Vr[N])):N===90?(Bt=1-Ue(R,K,ie),Kt=1-Ue(R,Q,pe),Ct.push(Vr[N])):N===65?(ht=1-Ue(A,ie,pe),dt=1-Ue(A,K,Q),Ct.push(kn[N])):N===105?(ht=Ue(R,pe,ie),dt=Ue(R,Q,K),Ct.push(kn[N])):N===160?(Bt=Ue(R,ie,K),ir=Ue(A,ie,K),fr=Ue(A,pe,Q),Kt=Ue(R,pe,Q),Ct.push(Vr[N]),Ct.push(hn[N])):N===10?(Bt=1-Ue(A,K,ie),ir=1-Ue(R,K,ie),fr=1-Ue(R,Q,pe),Kt=1-Ue(A,Q,pe),Ct.push(Vr[N]),Ct.push(hn[N])):N===130?(Ht=1-Ue(A,ie,pe),ht=1-Ue(R,ie,pe),dt=1-Ue(R,K,Q),Je=1-Ue(A,K,Q),Ct.push(Wn[N]),Ct.push(kn[N])):N===40?(Ht=Ue(R,pe,ie),ht=Ue(A,pe,ie),dt=Ue(A,Q,K),Je=Ue(R,Q,K),Ct.push(Wn[N]),Ct.push(kn[N])):N===101?(ir=Ue(R,ie,K),dt=Ue(R,Q,K),Ct.push(hn[N])):N===69?(ir=1-Ue(A,K,ie),dt=1-Ue(A,K,Q),Ct.push(hn[N])):N===149?(fr=Ue(R,pe,Q),Je=1-Ue(R,K,Q),Ct.push(Kn[N])):N===21?(fr=1-Ue(A,Q,pe),Je=Ue(A,Q,K),Ct.push(Kn[N])):N===86?(Ht=1-Ue(R,ie,pe),Kt=1-Ue(R,Q,pe),Ct.push(Wn[N])):N===84?(Ht=Ue(A,pe,ie),Kt=Ue(A,pe,Q),Ct.push(Wn[N])):N===89?(Bt=1-Ue(R,K,ie),ht=Ue(R,pe,ie),Ct.push(kn[N])):N===81?(Bt=Ue(A,ie,K),ht=1-Ue(A,ie,pe),Ct.push(kn[N])):N===96?(Bt=Ue(R,ie,K),ir=Ue(A,ie,K),Kt=Ue(A,pe,Q),dt=Ue(R,Q,K),Ct.push(Vr[N]),Ct.push(hn[N])):N===74?(Bt=1-Ue(A,K,ie),ir=1-Ue(R,K,ie),Kt=1-Ue(R,Q,pe),dt=1-Ue(A,K,Q),Ct.push(Vr[N]),Ct.push(hn[N])):N===24?(Bt=1-Ue(R,K,ie),Ht=Ue(R,pe,ie),ht=Ue(A,pe,ie),Je=Ue(A,Q,K),Ct.push(Vr[N]),Ct.push(kn[N])):N===146?(Bt=Ue(A,ie,K),Ht=1-Ue(A,ie,pe),ht=1-Ue(R,ie,pe),Je=1-Ue(R,K,Q),Ct.push(Vr[N]),Ct.push(kn[N])):N===6?(ir=1-Ue(A,K,ie),Ht=1-Ue(R,ie,pe),fr=1-Ue(R,Q,pe),Kt=1-Ue(A,Q,pe),Ct.push(hn[N]),Ct.push(Wn[N])):N===164?(ir=Ue(R,ie,K),Ht=Ue(A,pe,ie),fr=Ue(A,pe,Q),Kt=Ue(R,pe,Q),Ct.push(hn[N]),Ct.push(Wn[N])):N===129?(ht=1-Ue(A,ie,pe),fr=Ue(R,pe,Q),dt=1-Ue(R,K,Q),Je=1-Ue(A,K,Q),Ct.push(kn[N]),Ct.push(Kn[N])):N===41?(ht=Ue(R,pe,ie),fr=1-Ue(A,Q,pe),dt=Ue(A,Q,K),Je=Ue(R,Q,K),Ct.push(kn[N]),Ct.push(Kn[N])):N===66?(Ht=1-Ue(A,ie,pe),ht=1-Ue(R,ie,pe),Kt=1-Ue(R,Q,pe),dt=1-Ue(A,K,Q),Ct.push(Wn[N]),Ct.push(kn[N])):N===104?(Ht=Ue(R,pe,ie),ht=Ue(A,pe,ie),Kt=Ue(A,pe,Q),dt=Ue(R,Q,K),Ct.push(kn[N]),Ct.push(Fi[N])):N===144?(Bt=Ue(A,ie,K),fr=Ue(A,pe,Q),Kt=Ue(R,pe,Q),Je=1-Ue(R,K,Q),Ct.push(Vr[N]),Ct.push(Pn[N])):N===26?(Bt=1-Ue(R,K,ie),fr=1-Ue(R,Q,pe),Kt=1-Ue(A,Q,pe),Je=Ue(A,Q,K),Ct.push(Vr[N]),Ct.push(Pn[N])):N===36?(ir=Ue(R,ie,K),Ht=Ue(A,pe,ie),dt=Ue(A,Q,K),Je=Ue(R,Q,K),Ct.push(hn[N]),Ct.push(Wn[N])):N===134?(ir=1-Ue(A,K,ie),Ht=1-Ue(R,ie,pe),dt=1-Ue(R,K,Q),Je=1-Ue(A,K,Q),Ct.push(hn[N]),Ct.push(Wn[N])):N===9?(Bt=1-Ue(A,K,ie),ir=1-Ue(R,K,ie),ht=Ue(R,pe,ie),fr=1-Ue(A,Q,pe),Ct.push(Vr[N]),Ct.push(hn[N])):N===161?(Bt=Ue(R,ie,K),ir=Ue(A,ie,K),ht=1-Ue(A,ie,pe),fr=Ue(R,pe,Q),Ct.push(Vr[N]),Ct.push(hn[N])):N===37?(ir=Ue(R,ie,K),fr=1-Ue(A,Q,pe),dt=Ue(A,Q,K),Je=Ue(R,Q,K),Ct.push(hn[N]),Ct.push(Kn[N])):N===133?(ir=1-Ue(A,K,ie),fr=Ue(R,pe,Q),dt=1-Ue(R,K,Q),Je=1-Ue(A,K,Q),Ct.push(hn[N]),Ct.push(Kn[N])):N===148?(Ht=Ue(A,pe,ie),fr=Ue(A,pe,Q),Kt=Ue(R,pe,Q),Je=1-Ue(R,K,Q),Ct.push(Wn[N]),Ct.push(Pn[N])):N===22?(Ht=1-Ue(R,ie,pe),fr=1-Ue(R,Q,pe),Kt=1-Ue(A,Q,pe),Je=Ue(A,Q,K),Ct.push(Wn[N]),Ct.push(Pn[N])):N===82?(Bt=Ue(A,ie,K),Ht=1-Ue(A,ie,pe),ht=1-Ue(R,ie,pe),Kt=1-Ue(R,Q,pe),Ct.push(Vr[N]),Ct.push(kn[N])):N===88?(Bt=1-Ue(R,K,ie),Ht=Ue(R,pe,ie),ht=Ue(A,pe,ie),Kt=Ue(A,pe,Q),Ct.push(Vr[N]),Ct.push(kn[N])):N===73?(Bt=1-Ue(A,K,ie),ir=1-Ue(R,K,ie),ht=Ue(R,pe,ie),dt=1-Ue(A,K,Q),Ct.push(Vr[N]),Ct.push(hn[N])):N===97?(Bt=Ue(R,ie,K),ir=Ue(A,ie,K),ht=1-Ue(A,ie,pe),dt=Ue(R,Q,K),Ct.push(Vr[N]),Ct.push(hn[N])):N===145?(Bt=Ue(A,ie,K),ht=1-Ue(A,ie,pe),fr=Ue(R,pe,Q),Je=1-Ue(R,K,Q),Ct.push(Vr[N]),Ct.push(Kn[N])):N===25?(Bt=1-Ue(R,K,ie),ht=Ue(R,pe,ie),fr=1-Ue(A,Q,pe),Je=Ue(A,Q,K),Ct.push(Vr[N]),Ct.push(Kn[N])):N===70?(ir=1-Ue(A,K,ie),Ht=1-Ue(R,ie,pe),Kt=1-Ue(R,Q,pe),dt=1-Ue(A,K,Q),Ct.push(hn[N]),Ct.push(Wn[N])):N===100?(ir=Ue(R,ie,K),Ht=Ue(A,pe,ie),Kt=Ue(A,pe,Q),dt=Ue(R,Q,K),Ct.push(hn[N]),Ct.push(Wn[N])):N===34?(it===0?(Bt=1-Ue(A,K,ie),ir=1-Ue(R,K,ie),Ht=Ue(R,pe,ie),ht=Ue(A,pe,ie),fr=Ue(A,pe,Q),Kt=Ue(R,pe,Q),dt=1-Ue(R,K,Q),Je=1-Ue(A,K,Q)):(Bt=Ue(R,ie,K),ir=Ue(A,ie,K),Ht=1-Ue(A,ie,pe),ht=1-Ue(R,ie,pe),fr=1-Ue(R,Q,pe),Kt=1-Ue(A,Q,pe),dt=Ue(A,Q,K),Je=Ue(R,Q,K)),Ct.push(Vr[N]),Ct.push(hn[N]),Ct.push(Kn[N]),Ct.push(Pn[N])):N===35?(it===4?(Bt=1-Ue(A,K,ie),ir=1-Ue(R,K,ie),Ht=Ue(R,pe,ie),ht=Ue(A,pe,ie),fr=Ue(A,pe,Q),Kt=Ue(R,pe,Q),dt=1-Ue(R,K,Q),Je=1-Ue(A,K,Q)):(Bt=Ue(R,ie,K),ir=Ue(A,ie,K),Ht=1-Ue(A,ie,pe),ht=1-Ue(R,ie,pe),fr=1-Ue(R,Q,pe),Kt=1-Ue(A,Q,pe),dt=Ue(A,Q,K),Je=Ue(R,Q,K)),Ct.push(Vr[N]),Ct.push(hn[N]),Ct.push(kn[N]),Ct.push(Pn[N])):N===136?(it===0?(Bt=Ue(R,ie,K),ir=Ue(A,ie,K),Ht=1-Ue(A,ie,pe),ht=1-Ue(R,ie,pe),fr=1-Ue(R,Q,pe),Kt=1-Ue(A,Q,pe),dt=Ue(A,Q,K),Je=Ue(R,Q,K)):(Bt=1-Ue(A,K,ie),ir=1-Ue(R,K,ie),Ht=Ue(R,pe,ie),ht=Ue(A,pe,ie),fr=Ue(A,pe,Q),Kt=Ue(R,pe,Q),dt=1-Ue(R,K,Q),Je=1-Ue(A,K,Q)),Ct.push(Vr[N]),Ct.push(hn[N]),Ct.push(Kn[N]),Ct.push(Pn[N])):N===153?(it===0?(Bt=Ue(A,ie,K),ht=1-Ue(A,ie,pe),fr=1-Ue(A,Q,pe),Je=Ue(A,Q,K)):(Bt=1-Ue(R,K,ie),ht=Ue(R,pe,ie),fr=Ue(R,pe,Q),Je=1-Ue(R,K,Q)),Ct.push(Vr[N]),Ct.push(kn[N])):N===102?(it===0?(ir=1-Ue(A,K,ie),Ht=Ue(A,pe,ie),Kt=Ue(A,pe,Q),dt=1-Ue(A,K,Q)):(ir=Ue(R,ie,K),Ht=1-Ue(R,ie,pe),Kt=1-Ue(R,Q,pe),dt=Ue(R,Q,K)),Ct.push(hn[N]),Ct.push(Pn[N])):N===155?(it===4?(Bt=Ue(A,ie,K),ht=1-Ue(A,ie,pe),fr=1-Ue(A,Q,pe),Je=Ue(A,Q,K)):(Bt=1-Ue(R,K,ie),ht=Ue(R,pe,ie),fr=Ue(R,pe,Q),Je=1-Ue(R,K,Q)),Ct.push(Vr[N]),Ct.push(Kn[N])):N===103?(it===4?(ir=1-Ue(A,K,ie),Ht=Ue(A,pe,ie),Kt=Ue(A,pe,Q),dt=1-Ue(A,K,Q)):(ir=Ue(R,ie,K),Ht=1-Ue(R,ie,pe),Kt=1-Ue(R,Q,pe),dt=Ue(R,Q,K)),Ct.push(hn[N]),Ct.push(Wn[N])):N===152?(it===0?(Bt=Ue(A,ie,K),Ht=1-Ue(A,ie,pe),ht=1-Ue(R,ie,pe),fr=1-Ue(R,Q,pe),Kt=1-Ue(A,Q,pe),Je=Ue(A,Q,K)):(Bt=1-Ue(R,K,ie),Ht=Ue(R,pe,ie),ht=Ue(A,pe,ie),fr=Ue(A,pe,Q),Kt=Ue(R,pe,Q),Je=1-Ue(R,K,Q)),Ct.push(Vr[N]),Ct.push(Wn[N]),Ct.push(kn[N])):N===156?(it===4?(Bt=Ue(A,ie,K),Ht=1-Ue(A,ie,pe),ht=1-Ue(R,ie,pe),fr=1-Ue(R,Q,pe),Kt=1-Ue(A,Q,pe),Je=Ue(A,Q,K)):(Bt=1-Ue(R,K,ie),Ht=Ue(R,pe,ie),ht=Ue(A,pe,ie),fr=Ue(A,pe,Q),Kt=Ue(R,pe,Q),Je=1-Ue(R,K,Q)),Ct.push(Vr[N]),Ct.push(kn[N]),Ct.push(Pn[N])):N===137?(it===0?(Bt=Ue(R,ie,K),ir=Ue(A,ie,K),ht=1-Ue(A,ie,pe),fr=1-Ue(A,Q,pe),dt=Ue(A,Q,K),Je=Ue(R,Q,K)):(Bt=1-Ue(A,K,ie),ir=1-Ue(R,K,ie),ht=Ue(R,pe,ie),fr=Ue(R,pe,Q),dt=1-Ue(R,K,Q),Je=1-Ue(A,K,Q)),Ct.push(Vr[N]),Ct.push(hn[N]),Ct.push(kn[N])):N===139?(it===4?(Bt=Ue(R,ie,K),ir=Ue(A,ie,K),ht=1-Ue(A,ie,pe),fr=1-Ue(A,Q,pe),dt=Ue(A,Q,K),Je=Ue(R,Q,K)):(Bt=1-Ue(A,K,ie),ir=1-Ue(R,K,ie),ht=Ue(R,pe,ie),fr=Ue(R,pe,Q),dt=1-Ue(R,K,Q),Je=1-Ue(A,K,Q)),Ct.push(Vr[N]),Ct.push(hn[N]),Ct.push(Kn[N])):N===98?(it===0?(Bt=1-Ue(A,K,ie),ir=1-Ue(R,K,ie),Ht=Ue(R,pe,ie),ht=Ue(A,pe,ie),Kt=Ue(A,pe,Q),dt=1-Ue(A,K,Q)):(Bt=Ue(R,ie,K),ir=Ue(A,ie,K),Ht=1-Ue(A,ie,pe),ht=1-Ue(R,ie,pe),Kt=1-Ue(R,Q,pe),dt=Ue(R,Q,K)),Ct.push(Vr[N]),Ct.push(hn[N]),Ct.push(Pn[N])):N===99?(it===4?(Bt=1-Ue(A,K,ie),ir=1-Ue(R,K,ie),Ht=Ue(R,pe,ie),ht=Ue(A,pe,ie),Kt=Ue(A,pe,Q),dt=1-Ue(A,K,Q)):(Bt=Ue(R,ie,K),ir=Ue(A,ie,K),Ht=1-Ue(A,ie,pe),ht=1-Ue(R,ie,pe),Kt=1-Ue(R,Q,pe),dt=Ue(R,Q,K)),Ct.push(Vr[N]),Ct.push(hn[N]),Ct.push(kn[N])):N===38?(it===0?(ir=1-Ue(A,K,ie),Ht=Ue(A,pe,ie),fr=Ue(A,pe,Q),Kt=Ue(R,pe,Q),dt=1-Ue(R,K,Q),Je=1-Ue(A,K,Q)):(ir=Ue(R,ie,K),Ht=1-Ue(R,ie,pe),fr=1-Ue(R,Q,pe),Kt=1-Ue(A,Q,pe),dt=Ue(A,Q,K),Je=Ue(R,Q,K)),Ct.push(hn[N]),Ct.push(Kn[N]),Ct.push(Pn[N])):N===39?(it===4?(ir=1-Ue(A,K,ie),Ht=Ue(A,pe,ie),fr=Ue(A,pe,Q),Kt=Ue(R,pe,Q),dt=1-Ue(R,K,Q),Je=1-Ue(A,K,Q)):(ir=Ue(R,ie,K),Ht=1-Ue(R,ie,pe),fr=1-Ue(R,Q,pe),Kt=1-Ue(A,Q,pe),dt=Ue(A,Q,K),Je=Ue(R,Q,K)),Ct.push(hn[N]),Ct.push(Wn[N]),Ct.push(Pn[N])):N===85&&(Bt=1,ir=0,Ht=1,ht=0,fr=0,Kt=1,dt=0,Je=1),(dt<0||dt>1||Je<0||Je>1||Bt<0||Bt>1||Ht<0||Ht>1||fr<0||fr>1||Kt<0||Kt>1)&&console.log("MarchingSquaresJS-isoBands: "+N+" "+pt+" "+Q+","+K+","+ie+","+pe+" "+it+" "+dt+" "+Je+" "+Bt+" "+ir+" "+Ht+" "+ht+" "+fr+" "+Kt),L.cells[U][H]={cval:N,cval_real:pt,flipped:it,topleft:dt,topright:Je,righttop:Bt,rightbottom:ir,bottomright:Ht,bottomleft:ht,leftbottom:fr,lefttop:Kt,edges:Ct}}}}}return L}function lt(l){for(var A=[],y=l.rows,b=l.cols,T=[],L=0;L<y;L++)for(var R=0;R<b;R++)if(typeof l.cells[L][R]!="undefined"&&l.cells[L][R].edges.length>0){var U=l.cells[L][R],H=xh(U),N=null,Q=R,K=L;H!==null&&T.push([H.p[0]+Q,H.p[1]+K]);do{if(N=xc(l.cells[K][Q],H.x,H.y,H.o),N!==null)T.push([N.p[0]+Q,N.p[1]+K]),Q+=N.x,K+=N.y,H=N;else break;if(K<0||K>=y||Q<0||Q>=b||typeof l.cells[K][Q]=="undefined"){Q-=N.x,K-=N.y;var ie=ni(l,Q,K,N.x,N.y,N.o);if(ie!==null)ie.path.forEach(function(pe){T.push(pe)}),Q=ie.i,K=ie.j,H=ie;else break}}while(typeof l.cells[K][Q]!="undefined"&&l.cells[K][Q].edges.length>0);A.push(T),T=[],l.cells[L][R].edges.length>0&&R--}return A}function ni(l,A,y,b,T,L){for(var R=l.cells[y][A],U=R.cval_real,H=A+b,N=y+T,Q=[],K=!1;!K;){if(typeof l.cells[N]=="undefined"||typeof l.cells[N][H]=="undefined")if(N-=T,H-=b,R=l.cells[N][H],U=R.cval_real,T===-1)if(L===0)if(U&$a)Q.push([H,N]),b=-1,T=0,L=0;else if(U&bi)Q.push([H+1,N]),b=1,T=0,L=0;else{Q.push([H+R.bottomright,N]),b=0,T=1,L=1,K=!0;break}else if(U&$a)Q.push([H,N]),b=-1,T=0,L=0;else if(U&bi){Q.push([H+R.bottomright,N]),b=0,T=1,L=1,K=!0;break}else{Q.push([H+R.bottomleft,N]),b=0,T=1,L=0,K=!0;break}else if(T===1)if(L===0)if(U&ca)Q.push([H+1,N+1]),b=1,T=0,L=1;else if(U&ai){Q.push([H+R.topleft,N+1]),b=0,T=-1,L=0,K=!0;break}else{Q.push([H+R.topright,N+1]),b=0,T=-1,L=1,K=!0;break}else U&ca?(Q.push([H+1,N+1]),b=1,T=0,L=1):(Q.push([H+1,N+1]),b=1,T=0,L=1);else if(b===-1)if(L===0)if(U&ai)Q.push([H,N+1]),b=0,T=1,L=0;else if(U&$a){Q.push([H,N+R.leftbottom]),b=1,T=0,L=0,K=!0;break}else{Q.push([H,N+R.lefttop]),b=1,T=0,L=1,K=!0;break}else if(U&ai)Q.push([H,N+1]),b=0,T=1,L=0;else{console.log("MarchingSquaresJS-isoBands: wtf");break}else if(b===1)if(L===0)if(U&bi)Q.push([H+1,N]),b=0,T=-1,L=1;else{Q.push([H+1,N+R.rightbottom]),b=-1,T=0,L=0,K=!0;break}else if(U&bi)Q.push([H+1,N]),b=0,T=-1,L=1;else if(U&ca){Q.push([H+1,N+R.righttop]),b=-1,T=0,L=1;break}else{Q.push([H+1,N+R.rightbottom]),b=-1,T=0,L=0,K=!0;break}else{console.log("MarchingSquaresJS-isoBands: we came from nowhere!");break}else if(R=l.cells[N][H],U=R.cval_real,b===-1)if(L===0)if(typeof l.cells[N-1]!="undefined"&&typeof l.cells[N-1][H]!="undefined")b=0,T=-1,L=1;else if(U&$a)Q.push([H,N]);else{Q.push([H+R.bottomright,N]),b=0,T=1,L=1,K=!0;break}else if(U&ai)console.log("MarchingSquaresJS-isoBands: proceeding in x-direction!");else{console.log("MarchingSquaresJS-isoBands: found entry from top at "+H+","+N);break}else if(b===1)if(L===0){console.log("MarchingSquaresJS-isoBands: wtf");break}else if(typeof l.cells[N+1]!="undefined"&&typeof l.cells[N+1][H]!="undefined")b=0,T=1,L=0;else if(U&ca)Q.push([H+1,N+1]),b=1,T=0,L=1;else{Q.push([H+R.topleft,N+1]),b=0,T=-1,L=0,K=!0;break}else if(T===-1)if(L===1)if(typeof l.cells[N][H+1]!="undefined")b=1,T=0,L=1;else if(U&bi)Q.push([H+1,N]),b=0,T=-1,L=1;else{Q.push([H+1,N+R.righttop]),b=-1,T=0,L=1,K=!0;break}else{console.log("MarchingSquaresJS-isoBands: wtf");break}else if(T===1)if(L===0)if(typeof l.cells[N][H-1]!="undefined")b=-1,T=0,L=0;else if(U&ai)Q.push([H,N+1]),b=0,T=1,L=0;else{Q.push([H,N+R.leftbottom]),b=1,T=0,L=0,K=!0;break}else{console.log("MarchingSquaresJS-isoBands: wtf");break}else{console.log("MarchingSquaresJS-isoBands: where did we came from???");break}if(H+=b,N+=T,H===A&&N===y)break}return{path:Q,i:H,j:N,x:b,y:T,o:L}}function _c(l,A){delete l.edges[A];for(var y=A+1;y<l.edges.length;y++)l.edges[y-1]=l.edges[y];l.edges.pop()}function xh(l){if(l.edges.length>0){var A=l.edges[l.edges.length-1],y=l.cval_real;switch(A){case 0:return y&ca?{p:[1,l.righttop],x:-1,y:0,o:1}:{p:[l.topleft,1],x:0,y:-1,o:0};case 1:return y&bi?{p:[l.topleft,1],x:0,y:-1,o:0}:{p:[1,l.rightbottom],x:-1,y:0,o:0};case 2:return y&bi?{p:[l.bottomright,0],x:0,y:1,o:1}:{p:[l.topleft,1],x:0,y:-1,o:0};case 3:return y&$a?{p:[l.topleft,1],x:0,y:-1,o:0}:{p:[l.bottomleft,0],x:0,y:1,o:0};case 4:return y&ca?{p:[1,l.righttop],x:-1,y:0,o:1}:{p:[l.topright,1],x:0,y:-1,o:1};case 5:return y&bi?{p:[l.topright,1],x:0,y:-1,o:1}:{p:[1,l.rightbottom],x:-1,y:0,o:0};case 6:return y&bi?{p:[l.bottomright,0],x:0,y:1,o:1}:{p:[l.topright,1],x:0,y:-1,o:1};case 7:return y&$a?{p:[l.topright,1],x:0,y:-1,o:1}:{p:[l.bottomleft,0],x:0,y:1,o:0};case 8:return y&bi?{p:[l.bottomright,0],x:0,y:1,o:1}:{p:[1,l.righttop],x:-1,y:0,o:1};case 9:return y&$a?{p:[1,l.righttop],x:-1,y:0,o:1}:{p:[l.bottomleft,0],x:0,y:1,o:0};case 10:return y&$a?{p:[0,l.leftbottom],x:1,y:0,o:0}:{p:[1,l.righttop],x:-1,y:0,o:1};case 11:return y&ai?{p:[1,l.righttop],x:-1,y:0,o:1}:{p:[0,l.lefttop],x:1,y:0,o:1};case 12:return y&bi?{p:[l.bottomright,0],x:0,y:1,o:1}:{p:[1,l.rightbottom],x:-1,y:0,o:0};case 13:return y&$a?{p:[1,l.rightbottom],x:-1,y:0,o:0}:{p:[l.bottomleft,0],x:0,y:1,o:0};case 14:return y&$a?{p:[0,l.leftbottom],x:1,y:0,o:0}:{p:[1,l.rightbottom],x:-1,y:0,o:0};case 15:return y&ai?{p:[1,l.rightbottom],x:-1,y:0,o:0}:{p:[0,l.lefttop],x:1,y:0,o:1};case 16:return y&bi?{p:[l.bottomright,0],x:0,y:1,o:1}:{p:[0,l.leftbottom],x:1,y:0,o:0};case 17:return y&ai?{p:[l.bottomright,0],x:0,y:1,o:1}:{p:[0,l.lefttop],x:1,y:0,o:1};case 18:return y&$a?{p:[0,l.leftbottom],x:1,y:0,o:0}:{p:[l.bottomleft,0],x:0,y:1,o:0};case 19:return y&ai?{p:[l.bottomleft,0],x:0,y:1,o:0}:{p:[0,l.lefttop],x:1,y:0,o:1};case 20:return y&ai?{p:[l.topleft,1],x:0,y:-1,o:0}:{p:[0,l.leftbottom],x:1,y:0,o:0};case 21:return y&ca?{p:[0,l.leftbottom],x:1,y:0,o:0}:{p:[l.topright,1],x:0,y:-1,o:1};case 22:return y&ai?{p:[l.topleft,1],x:0,y:-1,o:0}:{p:[0,l.lefttop],x:1,y:0,o:1};case 23:return y&ca?{p:[0,l.lefttop],x:1,y:0,o:1}:{p:[l.topright,1],x:0,y:-1,o:1};default:console.log("MarchingSquaresJS-isoBands: edge index out of range!"),console.log(l);break}}return null}function xc(l,A,y,b){var T,L,R,U,H=l.cval,N;switch(A){case-1:switch(b){case 0:T=hn[H],R=qn[H],U=Ui[H],N=Gi[H];break;default:T=Vr[H],R=wn[H],U=Yn[H],N=Li[H];break}break;case 1:switch(b){case 0:T=Kn[H],R=Ci[H],U=ji[H],N=si[H];break;default:T=Pn[H],R=qi[H],U=hi[H],N=Si[H];break}break;default:switch(y){case-1:switch(b){case 0:T=Fi[H],R=Ii[H],U=Hn[H],N=mi[H];break;default:T=wi[H],R=Wi[H],U=_i[H],N=di[H];break}break;case 1:switch(b){case 0:T=kn[H],R=Nn[H],U=Yi[H],N=$n[H];break;default:T=Wn[H],R=Pi[H],U=Oi[H],N=Qi[H];break}break}break}if(L=l.edges.indexOf(T),typeof l.edges[L]!="undefined")_c(l,L);else return null;switch(H=l.cval_real,T){case 0:H&ca?(A=l.topleft,y=1):(A=1,y=l.righttop);break;case 1:H&bi?(A=1,y=l.rightbottom):(A=l.topleft,y=1);break;case 2:H&bi?(A=l.topleft,y=1):(A=l.bottomright,y=0);break;case 3:H&$a?(A=l.bottomleft,y=0):(A=l.topleft,y=1);break;case 4:H&ca?(A=l.topright,y=1):(A=1,y=l.righttop);break;case 5:H&bi?(A=1,y=l.rightbottom):(A=l.topright,y=1);break;case 6:H&bi?(A=l.topright,y=1):(A=l.bottomright,y=0);break;case 7:H&$a?(A=l.bottomleft,y=0):(A=l.topright,y=1);break;case 8:H&bi?(A=1,y=l.righttop):(A=l.bottomright,y=0);break;case 9:H&$a?(A=l.bottomleft,y=0):(A=1,y=l.righttop);break;case 10:H&$a?(A=1,y=l.righttop):(A=0,y=l.leftbottom);break;case 11:H&ai?(A=0,y=l.lefttop):(A=1,y=l.righttop);break;case 12:H&bi?(A=1,y=l.rightbottom):(A=l.bottomright,y=0);break;case 13:H&$a?(A=l.bottomleft,y=0):(A=1,y=l.rightbottom);break;case 14:H&$a?(A=1,y=l.rightbottom):(A=0,y=l.leftbottom);break;case 15:H&ai?(A=0,y=l.lefttop):(A=1,y=l.rightbottom);break;case 16:H&bi?(A=0,y=l.leftbottom):(A=l.bottomright,y=0);break;case 17:H&ai?(A=0,y=l.lefttop):(A=l.bottomright,y=0);break;case 18:H&$a?(A=l.bottomleft,y=0):(A=0,y=l.leftbottom);break;case 19:H&ai?(A=0,y=l.lefttop):(A=l.bottomleft,y=0);break;case 20:H&ai?(A=0,y=l.leftbottom):(A=l.topleft,y=1);break;case 21:H&ca?(A=l.topright,y=1):(A=0,y=l.leftbottom);break;case 22:H&ai?(A=0,y=l.lefttop):(A=l.topleft,y=1);break;case 23:H&ca?(A=l.topright,y=1):(A=0,y=l.lefttop);break;default:return console.log("MarchingSquaresJS-isoBands: edge index out of range!"),console.log(l),null}return(typeof A=="undefined"||typeof y=="undefined"||typeof R=="undefined"||typeof U=="undefined"||typeof N=="undefined")&&(console.log("MarchingSquaresJS-isoBands: undefined value!"),console.log(l),console.log(A+" "+y+" "+R+" "+U+" "+N)),{p:[A,y],x:R,y:U,o:N}}function o0(l){var A=[],y=0;return l.cells.forEach(function(b,T){b.forEach(function(L,R){if(typeof L!="undefined"){var U=An[L.cval](L);typeof U=="object"&&al(U)?typeof U[0]=="object"&&al(U[0])?typeof U[0][0]=="object"&&al(U[0][0])?U.forEach(function(H){H.forEach(function(N){N[0]+=R,N[1]+=T}),A[y++]=H}):(U.forEach(function(H){H[0]+=R,H[1]+=T}),A[y++]=U):console.log("MarchingSquaresJS-isoBands: bandcell polygon with malformed coordinates"):console.log("MarchingSquaresJS-isoBands: bandcell polygon with null coordinates")}})}),A}function tf(l,A,y){if(y=y||{},!isObject(y))throw new Error("options is invalid");var b=y.zProperty||"elevation",T=y.commonProperties||{},L=y.breaksProperties||[];if(collectionOf(l,"Point","Input must contain Points"),!A)throw new Error("breaks is required");if(!Array.isArray(A))throw new Error("breaks is not an Array");if(!isObject(T))throw new Error("commonProperties is not an Object");if(!Array.isArray(L))throw new Error("breaksProperties is not an Array");var R=Hs(l,{zProperty:b,flip:!0}),U=et(R,A,b);U=Ec(U,R,l);var H=U.map(function(N,Q){if(L[Q]&&!isObject(L[Q]))throw new Error("Each mappedProperty is required to be an Object");var K=objectAssign({},T,L[Q]);K[b]=N[b];var ie=multiPolygon(N.groupedRings,K);return ie});return featureCollection(H)}function et(l,A,y){for(var b=[],T=1;T<A.length;T++){var L=+A[T-1],R=+A[T],U=$s(l,L,R-L),H=_f(U),N=s0(H),Q={};Q.groupedRings=N,Q[y]=L+"-"+R,b.push(Q)}return b}function Ec(l,A,y){var b=bbox(y),T=b[2]-b[0],L=b[3]-b[1],R=b[0],U=b[1],H=A[0].length-1,N=A.length-1,Q=T/H,K=L/N,ie=function(pe){pe[0]=pe[0]*Q+R,pe[1]=pe[1]*K+U};return l.forEach(function(pe){pe.groupedRings.forEach(function(pt){pt.forEach(function(it){it.forEach(ie)})})}),l}function _f(l){var A=[],y=[];l.forEach(function(T){var L=area(polygon([T]));y.push(L),A.push({ring:T,area:L})}),y.sort(function(T,L){return L-T});var b=[];return y.forEach(function(T){for(var L=0;L<A.length;L++)if(A[L].area===T){b.push(A[L].ring),A.splice(L,1);break}}),b}function s0(l){for(var A=l.map(function(H){return{lrCoordinates:H,grouped:!1}}),y=[];!rf(A);)for(var b=0;b<A.length;b++)if(!A[b].grouped){var T=[];T.push(A[b].lrCoordinates),A[b].grouped=!0;for(var L=polygon([A[b].lrCoordinates]),R=b+1;R<A.length;R++)if(!A[R].grouped){var U=polygon([A[R].lrCoordinates]);Nf(U,L)&&(T.push(A[R].lrCoordinates),A[R].grouped=!0)}y.push(T)}return y}function Nf(l,A){for(var y=explode(l),b=0;b<y.features.length;b++)if(!booleanPointInPolygon(y.features[b],A))return!1;return!0}function rf(l){for(var A=0;A<l.length;A++)if(l[A].grouped===!1)return!1;return!0}var u0=null;function xf(l,A,y){if(y=y||{},!isObject(y))throw new Error("options is invalid");var b=y.pivot,T=y.mutate;if(!l)throw new Error("geojson is required");if(A==null||isNaN(A))throw new Error("angle is required");return A===0||(b||(b=centroid(l)),(T===!1||T===void 0)&&(l=clone(l)),coordEach(l,function(L){var R=rhumbBearing(b,L),U=R+A,H=rhumbDistance(b,L),N=getCoords(rhumbDestination(b,H,U));L[0]=N[0],L[1]=N[1]})),l}var z0=null;function l0(l,A,y){if(y=y||{},!isObject(y))throw new Error("options is invalid");var b=y.origin,T=y.mutate;if(!l)throw new Error("geojson required");if(typeof A!="number"||A===0)throw new Error("invalid factor");var L=Array.isArray(b)||typeof b=="object";return T!==!0&&(l=clone(l)),l.type==="FeatureCollection"&&!L?(featureEach(l,function(R,U){l.features[U]=zu(R,A,b)}),l):zu(l,A,b)}function zu(l,A,y){var b=getType(l)==="Point";return y=Uo(l,y),A===1||b||coordEach(l,function(T){var L=rhumbDistance(y,T),R=rhumbBearing(y,T),U=L*A,H=getCoords(rhumbDestination(y,U,R));T[0]=H[0],T[1]=H[1],T.length===3&&(T[2]*=A)}),l}function Uo(l,A){if(A==null&&(A="centroid"),Array.isArray(A)||typeof A=="object")return getCoord(A);var y=l.bbox?l.bbox:turfBBox(l),b=y[0],T=y[1],L=y[2],R=y[3];switch(A){case"sw":case"southwest":case"westsouth":case"bottomleft":return point([b,T]);case"se":case"southeast":case"eastsouth":case"bottomright":return point([L,T]);case"nw":case"northwest":case"westnorth":case"topleft":return point([b,R]);case"ne":case"northeast":case"eastnorth":case"topright":return point([L,R]);case"center":return center(l);case void 0:case null:case"centroid":return centroid(l);default:throw new Error("invalid origin")}}var Ff=null;function Eh(l,A,y,b){if(b=b||{},!isObject(b))throw new Error("options is invalid");var T=b.units,L=b.zTranslation,R=b.mutate;if(!l)throw new Error("geojson is required");if(A==null||isNaN(A))throw new Error("distance is required");if(L&&typeof L!="number"&&isNaN(L))throw new Error("zTranslation is not a number");if(L=L!==void 0?L:0,A===0&&L===0)return l;if(y==null||isNaN(y))throw new Error("direction is required");return A<0&&(A=-A,y=y+180),(R===!1||R===void 0)&&(l=clone(l)),coordEach(l,function(U){var H=getCoords(rhumbDestination(U,A,y,{units:T}));U[0]=H[0],U[1]=H[1],L&&U.length===3&&(U[2]+=L)}),l}var Bf=null;function Nl(l){var A=l[0],y=l[1];return[y[0]-A[0],y[1]-A[1]]}function bc(l,A){return l[0]*A[1]-A[0]*l[1]}function nf(l,A){return[l[0]+A[0],l[1]+A[1]]}function c0(l,A){return[l[0]-A[0],l[1]-A[1]]}function fa(l,A){return[l*A[0],l*A[1]]}function za(l,A){var y=l[0],b=Nl(l),T=A[0],L=Nl(A),R=bc(b,L),U=c0(T,y),H=bc(U,L),N=H/R,Q=nf(y,fa(N,b));return Q}function Go(l,A){var y=Nl(l),b=Nl(A);return bc(y,b)===0}function Zf(l,A){return Go(l,A)?!1:za(l,A)}function U0(l,A,y){if(y=y||{},!isObject(y))throw new Error("options is invalid");var b=y.units;if(!l)throw new Error("geojson is required");if(A==null||isNaN(A))throw new Error("distance is required");var T=getType(l),L=l.properties;switch(T){case"LineString":return zf(l,A,b);case"MultiLineString":var R=[];return flattenEach(l,function(U){R.push(zf(U,A,b).geometry.coordinates)}),multiLineString(R,L);default:throw new Error("geometry "+T+" is not supported")}}function zf(l,A,y){var b=[],T=lengthToDegrees(A,y),L=getCoords(l),R=[];return L.forEach(function(U,H){if(H!==L.length-1){var N=f0(U,L[H+1],T);if(b.push(N),H>0){var Q=b[H-1],K=Zf(N,Q);K!==!1&&(Q[1]=K,N[0]=K),R.push(Q[0]),H===L.length-2&&(R.push(N[0]),R.push(N[1]))}L.length===2&&(R.push(N[0]),R.push(N[1]))}}),lineString(R,l.properties)}function f0(l,A,y){var b=Math.sqrt((l[0]-A[0])*(l[0]-A[0])+(l[1]-A[1])*(l[1]-A[1])),T=l[0]+y*(A[1]-l[1])/b,L=A[0]+y*(A[1]-l[1])/b,R=l[1]+y*(l[0]-A[0])/b,U=A[1]+y*(l[0]-A[0])/b;return[[T,R],[L,U]]}var Uf=null;function Xi(l){return(l>0)-(l<0)||+l}function Gf(l,A,y){var b=A[0]-l[0],T=A[1]-l[1],L=y[0]-A[0],R=y[1]-A[1];return Xi(b*R-L*T)}function Fl(l,A){var y=l.geometry.coordinates[0].map(function(R){return R[0]}),b=l.geometry.coordinates[0].map(function(R){return R[1]}),T=A.geometry.coordinates[0].map(function(R){return R[0]}),L=A.geometry.coordinates[0].map(function(R){return R[1]});return Math.max.apply(null,y)===Math.max.apply(null,T)&&Math.max.apply(null,b)===Math.max.apply(null,L)&&Math.min.apply(null,y)===Math.min.apply(null,T)&&Math.min.apply(null,b)===Math.min.apply(null,L)}function iu(l,A){return A.geometry.coordinates[0].every(function(y){return Le((0,Z.xm)(y),l)})}function nc(l,A){return l[0]===A[0]&&l[1]===A[1]}var oo=function(){function l(A){this.id=l.buildId(A),this.coordinates=A,this.innerEdges=[],this.outerEdges=[],this.outerEdgesSorted=!1}return l.buildId=function(A){return A.join(",")},l.prototype.removeInnerEdge=function(A){this.innerEdges=this.innerEdges.filter(function(y){return y.from.id!==A.from.id})},l.prototype.removeOuterEdge=function(A){this.outerEdges=this.outerEdges.filter(function(y){return y.to.id!==A.to.id})},l.prototype.addOuterEdge=function(A){this.outerEdges.push(A),this.outerEdgesSorted=!1},l.prototype.sortOuterEdges=function(){var A=this;this.outerEdgesSorted||(this.outerEdges.sort(function(y,b){var T=y.to,L=b.to;if(T.coordinates[0]-A.coordinates[0]>=0&&L.coordinates[0]-A.coordinates[0]<0)return 1;if(T.coordinates[0]-A.coordinates[0]<0&&L.coordinates[0]-A.coordinates[0]>=0)return-1;if(T.coordinates[0]-A.coordinates[0]===0&&L.coordinates[0]-A.coordinates[0]===0)return T.coordinates[1]-A.coordinates[1]>=0||L.coordinates[1]-A.coordinates[1]>=0?T.coordinates[1]-L.coordinates[1]:L.coordinates[1]-T.coordinates[1];var R=Gf(A.coordinates,T.coordinates,L.coordinates);if(R<0)return 1;if(R>0)return-1;var U=Math.pow(T.coordinates[0]-A.coordinates[0],2)+Math.pow(T.coordinates[1]-A.coordinates[1],2),H=Math.pow(L.coordinates[0]-A.coordinates[0],2)+Math.pow(L.coordinates[1]-A.coordinates[1],2);return U-H}),this.outerEdgesSorted=!0)},l.prototype.getOuterEdges=function(){return this.sortOuterEdges(),this.outerEdges},l.prototype.getOuterEdge=function(A){return this.sortOuterEdges(),this.outerEdges[A]},l.prototype.addInnerEdge=function(A){this.innerEdges.push(A)},l}(),Uu=oo,Bl=function(){function l(A,y){this.from=A,this.to=y,this.next=void 0,this.label=void 0,this.symetric=void 0,this.ring=void 0,this.from.addOuterEdge(this),this.to.addInnerEdge(this)}return l.prototype.getSymetric=function(){return this.symetric||(this.symetric=new l(this.to,this.from),this.symetric.symetric=this),this.symetric},l.prototype.deleteEdge=function(){this.from.removeOuterEdge(this),this.to.removeInnerEdge(this)},l.prototype.isEqual=function(A){return this.from.id===A.from.id&&this.to.id===A.to.id},l.prototype.toString=function(){return"Edge { "+this.from.id+" -> "+this.to.id+" }"},l.prototype.toLineString=function(){return(0,Z.Tu)([this.from.coordinates,this.to.coordinates])},l.prototype.compareTo=function(A){return Gf(A.from.coordinates,A.to.coordinates,this.to.coordinates)},l}(),Ef=Bl,Mo=function(){function l(){this.edges=[],this.polygon=void 0,this.envelope=void 0}return l.prototype.push=function(A){this.edges.push(A),this.polygon=this.envelope=void 0},l.prototype.get=function(A){return this.edges[A]},Object.defineProperty(l.prototype,"length",{get:function(){return this.edges.length},enumerable:!0,configurable:!0}),l.prototype.forEach=function(A){this.edges.forEach(A)},l.prototype.map=function(A){return this.edges.map(A)},l.prototype.some=function(A){return this.edges.some(A)},l.prototype.isValid=function(){return!0},l.prototype.isHole=function(){var A=this,y=this.edges.reduce(function(R,U,H){return U.from.coordinates[1]>A.edges[R].from.coordinates[1]&&(R=H),R},0),b=(y===0?this.length:y)-1,T=(y+1)%this.length,L=Gf(this.edges[b].from.coordinates,this.edges[y].from.coordinates,this.edges[T].from.coordinates);return L===0?this.edges[b].from.coordinates[0]>this.edges[T].from.coordinates[0]:L>0},l.prototype.toMultiPoint=function(){return(0,Z.ot)(this.edges.map(function(A){return A.from.coordinates}))},l.prototype.toPolygon=function(){if(this.polygon)return this.polygon;var A=this.edges.map(function(y){return y.from.coordinates});return A.push(this.edges[0].from.coordinates),this.polygon=(0,Z.yu)([A])},l.prototype.getEnvelope=function(){return this.envelope?this.envelope:this.envelope=bs(this.toPolygon())},l.findEdgeRingContaining=function(A,y){var b=A.getEnvelope(),T,L;return y.forEach(function(R){var U=R.getEnvelope();if(L&&(T=L.getEnvelope()),!Fl(U,b)&&iu(U,b)){for(var H=A.map(function(pt){return pt.from.coordinates}),N=void 0,Q=function(pt){R.some(function(it){return nc(pt,it.from.coordinates)})||(N=pt)},K=0,ie=H;K<ie.length;K++){var pe=ie[K];Q(pe)}N&&R.inside((0,Z.xm)(N))&&(!L||iu(T,U))&&(L=R)}}),L},l.prototype.inside=function(A){return Le(A,this.toPolygon())},l}(),ol=Mo;function ls(l){if(!l)throw new Error("No geojson passed");if(l.type!=="FeatureCollection"&&l.type!=="GeometryCollection"&&l.type!=="MultiLineString"&&l.type!=="LineString"&&l.type!=="Feature")throw new Error("Invalid input type '"+l.type+"'. Geojson must be FeatureCollection, GeometryCollection, LineString, MultiLineString or Feature")}var ic=function(){function l(){this.edges=[],this.nodes={}}return l.fromGeoJson=function(A){ls(A);var y=new l;return(0,D.nG)(A,function(b){(0,G.nK)(b,"LineString","Graph::fromGeoJson"),(0,D.Lo)(b,function(T,L){if(T){var R=y.getNode(T),U=y.getNode(L);y.addEdge(R,U)}return L})}),y},l.prototype.getNode=function(A){var y=Uu.buildId(A),b=this.nodes[y];return b||(b=this.nodes[y]=new Uu(A)),b},l.prototype.addEdge=function(A,y){var b=new Ef(A,y),T=b.getSymetric();this.edges.push(b),this.edges.push(T)},l.prototype.deleteDangles=function(){var A=this;Object.keys(this.nodes).map(function(y){return A.nodes[y]}).forEach(function(y){return A._removeIfDangle(y)})},l.prototype._removeIfDangle=function(A){var y=this;if(A.innerEdges.length<=1){var b=A.getOuterEdges().map(function(T){return T.to});this.removeNode(A),b.forEach(function(T){return y._removeIfDangle(T)})}},l.prototype.deleteCutEdges=function(){var A=this;this._computeNextCWEdges(),this._findLabeledEdgeRings(),this.edges.forEach(function(y){y.label===y.symetric.label&&(A.removeEdge(y.symetric),A.removeEdge(y))})},l.prototype._computeNextCWEdges=function(A){var y=this;typeof A=="undefined"?Object.keys(this.nodes).forEach(function(b){return y._computeNextCWEdges(y.nodes[b])}):A.getOuterEdges().forEach(function(b,T){A.getOuterEdge((T===0?A.getOuterEdges().length:T)-1).symetric.next=b})},l.prototype._computeNextCCWEdges=function(A,y){for(var b=A.getOuterEdges(),T,L,R=b.length-1;R>=0;--R){var U=b[R],H=U.symetric,N=void 0,Q=void 0;U.label===y&&(N=U),H.label===y&&(Q=H),!(!N||!Q)&&(Q&&(L=Q),N&&(L&&(L.next=N,L=void 0),T||(T=N)))}L&&(L.next=T)},l.prototype._findLabeledEdgeRings=function(){var A=[],y=0;return this.edges.forEach(function(b){if(!(b.label>=0)){A.push(b);var T=b;do T.label=y,T=T.next;while(!b.isEqual(T));y++}}),A},l.prototype.getEdgeRings=function(){var A=this;this._computeNextCWEdges(),this.edges.forEach(function(b){b.label=void 0}),this._findLabeledEdgeRings().forEach(function(b){A._findIntersectionNodes(b).forEach(function(T){A._computeNextCCWEdges(T,b.label)})});var y=[];return this.edges.forEach(function(b){b.ring||y.push(A._findEdgeRing(b))}),y},l.prototype._findIntersectionNodes=function(A){var y=[],b=A,T=function(){var L=0;b.from.getOuterEdges().forEach(function(R){R.label===A.label&&++L}),L>1&&y.push(b.from),b=b.next};do T();while(!A.isEqual(b));return y},l.prototype._findEdgeRing=function(A){var y=A,b=new ol;do b.push(y),y.ring=b,y=y.next;while(!A.isEqual(y));return b},l.prototype.removeNode=function(A){var y=this;A.getOuterEdges().forEach(function(b){return y.removeEdge(b)}),A.innerEdges.forEach(function(b){return y.removeEdge(b)}),delete this.nodes[A.id]},l.prototype.removeEdge=function(A){this.edges=this.edges.filter(function(y){return!y.isEqual(A)}),A.deleteEdge()},l}(),Sc=null;function Zl(l){var A=Graph.fromGeoJson(l);A.deleteDangles(),A.deleteCutEdges();var y=[],b=[];return A.getEdgeRings().filter(function(T){return T.isValid()}).forEach(function(T){T.isHole()?y.push(T):b.push(T)}),y.forEach(function(T){EdgeRing.findEdgeRingContaining(T,b)&&b.push(T)}),featureCollection(b.map(function(T){return T.toPolygon()}))}function h0(l,A){var y=!0;return flattenEach(l,function(b){flattenEach(A,function(T){if(y===!1)return!1;y=jf(b.geometry,T.geometry)})}),y}function jf(l,A){switch(l.type){case"Point":switch(A.type){case"Point":return!Gu(l.coordinates,A.coordinates);case"LineString":return!af(A,l);case"Polygon":return!booleanPointInPolygon(l,A)}break;case"LineString":switch(A.type){case"Point":return!af(l,A);case"LineString":return!Vf(l,A);case"Polygon":return!Cc(A,l)}break;case"Polygon":switch(A.type){case"Point":return!booleanPointInPolygon(A,l);case"LineString":return!Cc(l,A);case"Polygon":return!Tu(A,l)}}return!1}function af(l,A){for(var y=0;y<l.coordinates.length-1;y++)if(wc(l.coordinates[y],l.coordinates[y+1],A.coordinates))return!0;return!1}function Vf(l,A){var y=lineIntersect(l,A);return y.features.length>0}function Cc(l,A){for(var y=0,b=A.coordinates;y<b.length;y++){var T=b[y];if(booleanPointInPolygon(T,l))return!0}var L=lineIntersect(A,polygonToLine(l));return L.features.length>0}function Tu(l,A){for(var y=0,b=l.coordinates[0];y<b.length;y++){var T=b[y];if(booleanPointInPolygon(T,A))return!0}for(var L=0,R=A.coordinates[0];L<R.length;L++){var U=R[L];if(booleanPointInPolygon(U,l))return!0}var H=lineIntersect(polygonToLine(l),polygonToLine(A));return H.features.length>0}function wc(l,A,y){var b=y[0]-l[0],T=y[1]-l[1],L=A[0]-l[0],R=A[1]-l[1],U=b*R-T*L;return U!==0?!1:Math.abs(L)>=Math.abs(R)?L>0?l[0]<=y[0]&&y[0]<=A[0]:A[0]<=y[0]&&y[0]<=l[0]:R>0?l[1]<=y[1]&&y[1]<=A[1]:A[1]<=y[1]&&y[1]<=l[1]}function Gu(l,A){return l[0]===A[0]&&l[1]===A[1]}var sl=null;function Tc(l,A){var y=getGeom(l),b=getGeom(A),T=y.type,L=b.type,R=y.coordinates,U=b.coordinates;switch(T){case"Point":switch(L){case"Point":return d0(R,U);default:throw new Error("feature2 "+L+" geometry not supported")}case"MultiPoint":switch(L){case"Point":return Sl(y,b);case"MultiPoint":return A0(y,b);default:throw new Error("feature2 "+L+" geometry not supported")}case"LineString":switch(L){case"Point":return isPointOnLine(b,y,{ignoreEndVertices:!0});case"LineString":return bh(y,b);case"MultiPoint":return G0(y,b);default:throw new Error("feature2 "+L+" geometry not supported")}case"Polygon":switch(L){case"Point":return booleanPointInPolygon(b,y,{ignoreBoundary:!0});case"LineString":return Sh(y,b);case"Polygon":return j0(y,b);case"MultiPoint":return ac(y,b);default:throw new Error("feature2 "+L+" geometry not supported")}default:throw new Error("feature1 "+T+" geometry not supported")}}function Sl(l,A){var y,b=!1;for(y=0;y<l.coordinates.length;y++)if(d0(l.coordinates[y],A.coordinates)){b=!0;break}return b}function A0(l,A){for(var y=0,b=A.coordinates;y<b.length;y++){for(var T=b[y],L=!1,R=0,U=l.coordinates;R<U.length;R++){var H=U[R];if(d0(T,H)){L=!0;break}}if(!L)return!1}return!0}function G0(l,A){for(var y=!1,b=0,T=A.coordinates;b<T.length;b++){var L=T[b];if(isPointOnLine(L,l,{ignoreEndVertices:!0})&&(y=!0),!isPointOnLine(L,l))return!1}return!!y}function ac(l,A){for(var y=0,b=A.coordinates;y<b.length;y++){var T=b[y];if(!booleanPointInPolygon(T,l,{ignoreBoundary:!0}))return!1}return!0}function bh(l,A){for(var y=!1,b=0,T=A.coordinates;b<T.length;b++){var L=T[b];if(isPointOnLine({type:"Point",coordinates:L},l,{ignoreEndVertices:!0})&&(y=!0),!isPointOnLine({type:"Point",coordinates:L},l,{ignoreEndVertices:!1}))return!1}return y}function Sh(l,A){var y=!1,b=0,T=calcBbox(l),L=calcBbox(A);if(!p0(T,L))return!1;for(b;b<A.coordinates.length-1;b++){var R=Ch(A.coordinates[b],A.coordinates[b+1]);if(booleanPointInPolygon({type:"Point",coordinates:R},l,{ignoreBoundary:!0})){y=!0;break}}return y}function j0(l,A){if(l.type==="Feature"&&l.geometry===null||A.type==="Feature"&&A.geometry===null)return!1;var y=calcBbox(l),b=calcBbox(A);if(!p0(y,b))return!1;for(var T=getGeom(A).coordinates,L=0,R=T;L<R.length;L++)for(var U=R[L],H=0,N=U;H<N.length;H++){var Q=N[H];if(!booleanPointInPolygon(Q,l))return!1}return!0}function p0(l,A){return!(l[0]>A[0]||l[2]<A[2]||l[1]>A[1]||l[3]<A[3])}function d0(l,A){return l[0]===A[0]&&l[1]===A[1]}function Ch(l,A){return[(l[0]+A[0])/2,(l[1]+A[1])/2]}function mA(l,A){var y=getGeom(l),b=getGeom(A),T=y.type,L=b.type;switch(T){case"MultiPoint":switch(L){case"LineString":return V0(y,b);case"Polygon":return H0(y,b);default:throw new Error("feature2 "+L+" geometry not supported")}case"LineString":switch(L){case"MultiPoint":return V0(b,y);case"LineString":return wh(y,b);case"Polygon":return oc(y,b);default:throw new Error("feature2 "+L+" geometry not supported")}case"Polygon":switch(L){case"MultiPoint":return H0(b,y);case"LineString":return oc(b,y);default:throw new Error("feature2 "+L+" geometry not supported")}default:throw new Error("feature1 "+T+" geometry not supported")}}function V0(l,A){for(var y=!1,b=!1,T=l.coordinates.length,L=0;L<T&&!y&&!b;){for(var R=0;R<A.coordinates.length-1;R++){var U=!0;(R===0||R===A.coordinates.length-2)&&(U=!1),bf(A.coordinates[R],A.coordinates[R+1],l.coordinates[L],U)?y=!0:b=!0}L++}return y&&b}function wh(l,A){var y=lineIntersect(l,A);if(y.features.length>0)for(var b=0;b<l.coordinates.length-1;b++)for(var T=0;T<A.coordinates.length-1;T++){var L=!0;if((T===0||T===A.coordinates.length-2)&&(L=!1),bf(l.coordinates[b],l.coordinates[b+1],A.coordinates[T],L))return!0}return!1}function oc(l,A){var y=polygonToLine(A),b=lineIntersect(l,y);return b.features.length>0}function H0(l,A){for(var y=!1,b=!1,T=l.coordinates.length,L=0;L<T&&(!y||!b);L++)booleanPointInPolygon(point(l.coordinates[L]),A)?y=!0:b=!0;return b&&y}function bf(l,A,y,b){var T=y[0]-l[0],L=y[1]-l[1],R=A[0]-l[0],U=A[1]-l[1],H=T*U-L*R;return H!==0?!1:b?Math.abs(R)>=Math.abs(U)?R>0?l[0]<=y[0]&&y[0]<=A[0]:A[0]<=y[0]&&y[0]<=l[0]:U>0?l[1]<=y[1]&&y[1]<=A[1]:A[1]<=y[1]&&y[1]<=l[1]:Math.abs(R)>=Math.abs(U)?R>0?l[0]<y[0]&&y[0]<A[0]:A[0]<y[0]&&y[0]<l[0]:U>0?l[1]<y[1]&&y[1]<A[1]:A[1]<y[1]&&y[1]<l[1]}var yA=null,_A=C(15468);function $0(l,A){var y=getGeom(l),b=getGeom(A),T=y.type,L=b.type;if(T==="MultiPoint"&&L!=="MultiPoint"||(T==="LineString"||T==="MultiLineString")&&L!=="LineString"&&L!=="MultiLineString"||(T==="Polygon"||T==="MultiPolygon")&&L!=="Polygon"&&L!=="MultiPolygon")throw new Error("features must be of the same type");if(T==="Point")throw new Error("Point geometry not supported");var R=new GeojsonEquality({precision:6});if(R.compare(l,A))return!1;var U=0;switch(T){case"MultiPoint":for(var H=0;H<y.coordinates.length;H++)for(var N=0;N<b.coordinates.length;N++){var Q=y.coordinates[H],K=b.coordinates[N];if(Q[0]===K[0]&&Q[1]===K[1])return!0}return!1;case"LineString":case"MultiLineString":segmentEach(l,function(ie){segmentEach(A,function(pe){lineOverlap(ie,pe).features.length&&U++})});break;case"Polygon":case"MultiPolygon":segmentEach(l,function(ie){segmentEach(A,function(pe){lineIntersect(ie,pe).features.length&&U++})});break}return U>0}function Mc(l,A){var y=getGeom(l).type,b=getGeom(A).type;if(y!==b)return!1;var T=new GeojsonEquality({precision:6});return T.compare(cleanCoords(l),cleanCoords(A))}var Ic=null;function Sf(l,A){var y=!1;return flattenEach(l,function(b){flattenEach(A,function(T){if(y===!0)return!0;y=!booleanDisjoint(b.geometry,T.geometry)})}),y}var Eo=C(70298);function Ys(l,A,y){y===void 0&&(y={}),y.mutate!==!0&&(l=clone(l)),y.minPoints=y.minPoints||3;var b=new clustering.DBSCAN,T=b.run(coordAll(l),convertLength(A,y.units),y.minPoints,distance),L=-1;return T.forEach(function(R){L++,R.forEach(function(U){var H=l.features[U];H.properties||(H.properties={}),H.properties.cluster=L,H.properties.dbscan="core"})}),b.noise.forEach(function(R){var U=l.features[R];U.properties||(U.properties={}),U.properties.cluster?U.properties.dbscan="edge":U.properties.dbscan="noise"}),l}var zl=null,sc=C(89345);function ul(l,A){A===void 0&&(A={});var y=l.features.length;A.numberOfClusters=A.numberOfClusters||Math.round(Math.sqrt(y/2)),A.numberOfClusters>y&&(A.numberOfClusters=y),A.mutate!==!0&&(l=clone(l));var b=coordAll(l),T=b.slice(0,A.numberOfClusters),L=skmeans(b,A.numberOfClusters,T),R={};return L.centroids.forEach(function(U,H){R[H]=U}),featureEach(l,function(U,H){var N=L.idxs[H];U.properties.cluster=N,U.properties.centroid=R[N]}),l}var Ul=null;function Lc(l,A){if(!l)throw new Error("line1 is required");if(!A)throw new Error("line2 is required");var y=Gl(l,"line1");if(y!=="LineString")throw new Error("line1 must be a LineString");var b=Gl(A,"line2");if(b!=="LineString")throw new Error("line2 must be a LineString");for(var T=lineSegment(cleanCoords(l)).features,L=lineSegment(cleanCoords(A)).features,R=0;R<T.length;R++){var U=T[R].geometry.coordinates;if(!L[R])break;var H=L[R].geometry.coordinates;if(!of(U,H))return!1}return!0}function of(l,A){var y=bearingToAzimuth(rhumbBearing(l[0],l[1])),b=bearingToAzimuth(rhumbBearing(A[0],A[1]));return y===b}function Gl(l,A){if(l.geometry&&l.geometry.type)return l.geometry.type;if(l.type)return l.type;throw new Error("Invalid GeoJSON object for "+A)}var Cl=null;function ha(l){for(var A=l,y=[];A.parent;)y.unshift(A),A=A.parent;return y}function Pc(){return new Hl(function(l){return l.f})}var jl={search:function(l,A,y,b){l.cleanDirty(),b=b||{};var T=b.heuristic||jl.heuristics.manhattan,L=b.closest||!1,R=Pc(),U=A;for(A.h=T(A,y),R.push(A);R.size()>0;){var H=R.pop();if(H===y)return ha(H);H.closed=!0;for(var N=l.neighbors(H),Q=0,K=N.length;Q<K;++Q){var ie=N[Q];if(!(ie.closed||ie.isWall())){var pe=H.g+ie.getCost(H),pt=ie.visited;(!pt||pe<ie.g)&&(ie.visited=!0,ie.parent=H,ie.h=ie.h||T(ie,y),ie.g=pe,ie.f=ie.g+ie.h,l.markDirty(ie),L&&(ie.h<U.h||ie.h===U.h&&ie.g<U.g)&&(U=ie),pt?R.rescoreElement(ie):R.push(ie))}}}return L?ha(U):[]},heuristics:{manhattan:function(l,A){var y=Math.abs(A.x-l.x),b=Math.abs(A.y-l.y);return y+b},diagonal:function(l,A){var y=1,b=Math.sqrt(2),T=Math.abs(A.x-l.x),L=Math.abs(A.y-l.y);return y*(T+L)+(b-2*y)*Math.min(T,L)}},cleanNode:function(l){l.f=0,l.g=0,l.h=0,l.visited=!1,l.closed=!1,l.parent=null}};function uc(l,A){A=A||{},this.nodes=[],this.diagonal=!!A.diagonal,this.grid=[];for(var y=0;y<l.length;y++){this.grid[y]=[];for(var b=0,T=l[y];b<T.length;b++){var L=new Vl(y,b,T[b]);this.grid[y][b]=L,this.nodes.push(L)}}this.init()}uc.prototype.init=function(){this.dirtyNodes=[];for(var l=0;l<this.nodes.length;l++)jl.cleanNode(this.nodes[l])},uc.prototype.cleanDirty=function(){for(var l=0;l<this.dirtyNodes.length;l++)jl.cleanNode(this.dirtyNodes[l]);this.dirtyNodes=[]},uc.prototype.markDirty=function(l){this.dirtyNodes.push(l)},uc.prototype.neighbors=function(l){var A=[],y=l.x,b=l.y,T=this.grid;return T[y-1]&&T[y-1][b]&&A.push(T[y-1][b]),T[y+1]&&T[y+1][b]&&A.push(T[y+1][b]),T[y]&&T[y][b-1]&&A.push(T[y][b-1]),T[y]&&T[y][b+1]&&A.push(T[y][b+1]),this.diagonal&&(T[y-1]&&T[y-1][b-1]&&A.push(T[y-1][b-1]),T[y+1]&&T[y+1][b-1]&&A.push(T[y+1][b-1]),T[y-1]&&T[y-1][b+1]&&A.push(T[y-1][b+1]),T[y+1]&&T[y+1][b+1]&&A.push(T[y+1][b+1])),A},uc.prototype.toString=function(){for(var l=[],A=this.grid,y,b,T,L,R=0,U=A.length;R<U;R++){for(y=[],b=A[R],T=0,L=b.length;T<L;T++)y.push(b[T].weight);l.push(y.join(" "))}return l.join(`
`)};function Vl(l,A,y){this.x=l,this.y=A,this.weight=y}Vl.prototype.toString=function(){return"["+this.x+" "+this.y+"]"},Vl.prototype.getCost=function(l){return l&&l.x!==this.x&&l.y!==this.y?this.weight*1.41421:this.weight},Vl.prototype.isWall=function(){return this.weight===0};function Hl(l){this.content=[],this.scoreFunction=l}Hl.prototype={push:function(l){this.content.push(l),this.sinkDown(this.content.length-1)},pop:function(){var l=this.content[0],A=this.content.pop();return this.content.length>0&&(this.content[0]=A,this.bubbleUp(0)),l},remove:function(l){var A=this.content.indexOf(l),y=this.content.pop();A!==this.content.length-1&&(this.content[A]=y,this.scoreFunction(y)<this.scoreFunction(l)?this.sinkDown(A):this.bubbleUp(A))},size:function(){return this.content.length},rescoreElement:function(l){this.sinkDown(this.content.indexOf(l))},sinkDown:function(l){for(var A=this.content[l];l>0;){var y=(l+1>>1)-1,b=this.content[y];if(this.scoreFunction(A)<this.scoreFunction(b))this.content[y]=A,this.content[l]=b,l=y;else break}},bubbleUp:function(l){for(var A=this.content.length,y=this.content[l],b=this.scoreFunction(y);;){var T=l+1<<1,L=T-1,R=null,U;if(L<A){var H=this.content[L];U=this.scoreFunction(H),U<b&&(R=L)}if(T<A){var N=this.content[T],Q=this.scoreFunction(N);Q<(R===null?b:U)&&(R=T)}if(R!==null)this.content[l]=this.content[R],this.content[R]=y,l=R;else break}}};function v0(l,A,y){if(y=y||{},!isObject(y))throw new Error("options is invalid");var b=y.resolution,T=y.minDistance,L=y.obstacles||featureCollection([]);if(!l)throw new Error("start is required");if(!A)throw new Error("end is required");if(b&&!isNumber(b)||b<=0)throw new Error("options.resolution must be a number, greater than 0");if(T)throw new Error("options.minDistance is not yet implemented");var R=getCoord(l),U=getCoord(A);switch(l=point(R),A=point(U),getType(L)){case"FeatureCollection":if(L.features.length===0)return lineString([R,U]);break;case"Polygon":L=featureCollection([feature(getGeom(L))]);break;default:throw new Error("invalid obstacles")}var H=L;H.features.push(l),H.features.push(A);var N=bbox(scale(bboxPolygon(bbox(H)),1.15));if(!b){var Q=distance([N[0],N[1]],[N[2],N[1]],y);b=Q/100}H.features.pop(),H.features.pop();for(var K=N[0],ie=N[1],pe=N[2],pt=N[3],it=b/distance([K,ie],[pe,ie],y),Nt=it*(pe-K),dt=b/distance([K,ie],[K,pt],y),Je=dt*(pt-ie),ht=pe-K,Ht=pt-ie,Bt=Math.floor(ht/Nt),ir=Math.floor(Ht/Je),Kt=(ht-Bt*Nt)/2,fr=(Ht-ir*Je)/2,Ct=[],oi=[],bn=[],Ei=[],$i=1/0,on=1/0,ii=pt-fr,Dn=0;ii>=ie;){for(var Pa=[],ba=[],Ji=K+Kt,mu=0;Ji<=pe;){var _s=point([Ji,ii]),ou=g0(_s,L);Pa.push(ou?0:1),ba.push(Ji+"|"+ii);var Qa=distance(_s,l);!ou&&Qa<$i&&($i=Qa,bn={x:mu,y:Dn});var po=distance(_s,A);!ou&&po<on&&(on=po,Ei={x:mu,y:Dn}),Ji+=Nt,mu++}oi.push(Pa),Ct.push(ba),ii-=Je,Dn++}var Vo=new uc(oi,{diagonal:!0}),Gc=Vo.grid[bn.y][bn.x],Ql=Vo.grid[Ei.y][Ei.x],qh=jl.search(Vo,Gc,Ql),O0=[R];return qh.forEach(function(Kh){var fh=Ct[Kh.x][Kh.y].split("|");O0.push([+fh[0],+fh[1]])}),O0.push(U),cleanCoords(lineString(O0))}function g0(l,A){for(var y=0;y<A.features.length;y++)if(booleanPointInPolygon(l,A.features[y]))return!0;return!1}var Xs=null;function Oc(){this._=null}function wl(l){l.U=l.C=l.L=l.R=l.P=l.N=null}Oc.prototype={constructor:Oc,insert:function(l,A){var y,b,T;if(l){if(A.P=l,A.N=l.N,l.N&&(l.N.P=A),l.N=A,l.R){for(l=l.R;l.L;)l=l.L;l.L=A}else l.R=A;y=l}else this._?(l=Hf(this._),A.P=null,A.N=l,l.P=l.L=A,y=l):(A.P=A.N=null,this._=A,y=null);for(A.L=A.R=null,A.U=y,A.C=!0,l=A;y&&y.C;)b=y.U,y===b.L?(T=b.R,T&&T.C?(y.C=T.C=!1,b.C=!0,l=b):(l===y.R&&(ju(this,y),l=y,y=l.U),y.C=!1,b.C=!0,Mu(this,b))):(T=b.L,T&&T.C?(y.C=T.C=!1,b.C=!0,l=b):(l===y.L&&(Mu(this,y),l=y,y=l.U),y.C=!1,b.C=!0,ju(this,b))),y=l.U;this._.C=!1},remove:function(l){l.N&&(l.N.P=l.P),l.P&&(l.P.N=l.N),l.N=l.P=null;var A=l.U,y,b=l.L,T=l.R,L,R;if(b?T?L=Hf(T):L=b:L=T,A?A.L===l?A.L=L:A.R=L:this._=L,b&&T?(R=L.C,L.C=l.C,L.L=b,b.U=L,L!==T?(A=L.U,L.U=l.U,l=L.R,A.L=l,L.R=T,T.U=L):(L.U=A,A=L,l=L.R)):(R=l.C,l=L),l&&(l.U=A),!R){if(l&&l.C){l.C=!1;return}do{if(l===this._)break;if(l===A.L){if(y=A.R,y.C&&(y.C=!1,A.C=!0,ju(this,A),y=A.R),y.L&&y.L.C||y.R&&y.R.C){(!y.R||!y.R.C)&&(y.L.C=!1,y.C=!0,Mu(this,y),y=A.R),y.C=A.C,A.C=y.R.C=!1,ju(this,A),l=this._;break}}else if(y=A.L,y.C&&(y.C=!1,A.C=!0,Mu(this,A),y=A.L),y.L&&y.L.C||y.R&&y.R.C){(!y.L||!y.L.C)&&(y.R.C=!1,y.C=!0,ju(this,y),y=A.L),y.C=A.C,A.C=y.L.C=!1,Mu(this,A),l=this._;break}y.C=!0,l=A,A=A.U}while(!l.C);l&&(l.C=!1)}}};function ju(l,A){var y=A,b=A.R,T=y.U;T?T.L===y?T.L=b:T.R=b:l._=b,b.U=T,y.U=b,y.R=b.L,y.R&&(y.R.U=y),b.L=y}function Mu(l,A){var y=A,b=A.L,T=y.U;T?T.L===y?T.L=b:T.R=b:l._=b,b.U=T,y.U=b,y.L=b.R,y.L&&(y.L.U=y),b.R=y}function Hf(l){for(;l.L;)l=l.L;return l}var au=Oc;function sf(l,A,y,b){var T=[null,null],L=Os.push(T)-1;return T.left=l,T.right=A,y&&Wl(T,l,A,y),b&&Wl(T,A,l,b),Qs[l.index].halfedges.push(L),Qs[A.index].halfedges.push(L),T}function $l(l,A,y){var b=[A,y];return b.left=l,b}function Wl(l,A,y,b){!l[0]&&!l[1]?(l[0]=b,l.left=A,l.right=y):l.left===y?l[1]=b:l[0]=b}function Ps(l,A,y,b,T){var L=l[0],R=l[1],U=L[0],H=L[1],N=R[0],Q=R[1],K=0,ie=1,pe=N-U,pt=Q-H,it;if(it=A-U,!(!pe&&it>0)){if(it/=pe,pe<0){if(it<K)return;it<ie&&(ie=it)}else if(pe>0){if(it>ie)return;it>K&&(K=it)}if(it=b-U,!(!pe&&it<0)){if(it/=pe,pe<0){if(it>ie)return;it>K&&(K=it)}else if(pe>0){if(it<K)return;it<ie&&(ie=it)}if(it=y-H,!(!pt&&it>0)){if(it/=pt,pt<0){if(it<K)return;it<ie&&(ie=it)}else if(pt>0){if(it>ie)return;it>K&&(K=it)}if(it=T-H,!(!pt&&it<0)){if(it/=pt,pt<0){if(it>ie)return;it>K&&(K=it)}else if(pt>0){if(it<K)return;it<ie&&(ie=it)}return!(K>0)&&!(ie<1)||(K>0&&(l[0]=[U+K*pe,H+K*pt]),ie<1&&(l[1]=[U+ie*pe,H+ie*pt])),!0}}}}}function Rc(l,A,y,b,T){var L=l[1];if(L)return!0;var R=l[0],U=l.left,H=l.right,N=U[0],Q=U[1],K=H[0],ie=H[1],pe=(N+K)/2,pt=(Q+ie)/2,it,Nt;if(ie===Q){if(pe<A||pe>=b)return;if(N>K){if(!R)R=[pe,y];else if(R[1]>=T)return;L=[pe,T]}else{if(!R)R=[pe,T];else if(R[1]<y)return;L=[pe,y]}}else if(it=(N-K)/(ie-Q),Nt=pt-it*pe,it<-1||it>1)if(N>K){if(!R)R=[(y-Nt)/it,y];else if(R[1]>=T)return;L=[(T-Nt)/it,T]}else{if(!R)R=[(T-Nt)/it,T];else if(R[1]<y)return;L=[(y-Nt)/it,y]}else if(Q<ie){if(!R)R=[A,it*A+Nt];else if(R[0]>=b)return;L=[b,it*b+Nt]}else{if(!R)R=[b,it*b+Nt];else if(R[0]<A)return;L=[A,it*A+Nt]}return l[0]=R,l[1]=L,!0}function kc(l,A,y,b){for(var T=Os.length,L;T--;)(!Rc(L=Os[T],l,A,y,b)||!Ps(L,l,A,y,b)||!(Math.abs(L[0][0]-L[1][0])>Wa||Math.abs(L[0][1]-L[1][1])>Wa))&&delete Os[T]}function Tl(l){return Qs[l.index]={site:l,halfedges:[]}}function m0(l,A){var y=l.site,b=A.left,T=A.right;return y===T&&(T=b,b=y),T?Math.atan2(T[1]-b[1],T[0]-b[0]):(y===b?(b=A[1],T=A[0]):(b=A[0],T=A[1]),Math.atan2(b[0]-T[0],T[1]-b[1]))}function uf(l,A){return A[+(A.left!==l.site)]}function lf(l,A){return A[+(A.left===l.site)]}function Cf(){for(var l=0,A=Qs.length,y,b,T,L;l<A;++l)if((y=Qs[l])&&(L=(b=y.halfedges).length)){var R=new Array(L),U=new Array(L);for(T=0;T<L;++T)R[T]=T,U[T]=m0(y,Os[b[T]]);for(R.sort(function(H,N){return U[N]-U[H]}),T=0;T<L;++T)U[T]=b[R[T]];for(T=0;T<L;++T)b[T]=U[T]}}function ys(l,A,y,b){var T=Qs.length,L,R,U,H,N,Q,K,ie,pe,pt,it,Nt,dt=!0;for(L=0;L<T;++L)if(R=Qs[L]){for(U=R.site,N=R.halfedges,H=N.length;H--;)Os[N[H]]||N.splice(H,1);for(H=0,Q=N.length;H<Q;)pt=lf(R,Os[N[H]]),it=pt[0],Nt=pt[1],K=uf(R,Os[N[++H%Q]]),ie=K[0],pe=K[1],(Math.abs(it-ie)>Wa||Math.abs(Nt-pe)>Wa)&&(N.splice(H,0,Os.push($l(U,pt,Math.abs(it-l)<Wa&&b-Nt>Wa?[l,Math.abs(ie-l)<Wa?pe:b]:Math.abs(Nt-b)<Wa&&y-it>Wa?[Math.abs(pe-b)<Wa?ie:y,b]:Math.abs(it-y)<Wa&&Nt-A>Wa?[y,Math.abs(ie-y)<Wa?pe:A]:Math.abs(Nt-A)<Wa&&it-l>Wa?[Math.abs(pe-A)<Wa?ie:l,A]:null))-1),++Q);Q&&(dt=!1)}if(dt){var Je,ht,Ht,Bt=1/0;for(L=0,dt=null;L<T;++L)(R=Qs[L])&&(U=R.site,Je=U[0]-l,ht=U[1]-A,Ht=Je*Je+ht*ht,Ht<Bt&&(Bt=Ht,dt=R));if(dt){var ir=[l,A],Kt=[l,b],fr=[y,b],Ct=[y,A];dt.halfedges.push(Os.push($l(U=dt.site,ir,Kt))-1,Os.push($l(U,Kt,fr))-1,Os.push($l(U,fr,Ct))-1,Os.push($l(U,Ct,ir))-1)}}for(L=0;L<T;++L)(R=Qs[L])&&(R.halfedges.length||delete Qs[L])}var ll=[],Ia;function Jo(){wl(this),this.x=this.y=this.arc=this.site=this.cy=null}function lc(l){var A=l.P,y=l.N;if(!(!A||!y)){var b=A.site,T=l.site,L=y.site;if(b!==L){var R=T[0],U=T[1],H=b[0]-R,N=b[1]-U,Q=L[0]-R,K=L[1]-U,ie=2*(H*K-N*Q);if(!(ie>=-Nc)){var pe=H*H+N*N,pt=Q*Q+K*K,it=(K*pe-N*pt)/ie,Nt=(H*pt-Q*pe)/ie,dt=ll.pop()||new Jo;dt.arc=l,dt.site=T,dt.x=it+R,dt.y=(dt.cy=Nt+U)+Math.sqrt(it*it+Nt*Nt),l.circle=dt;for(var Je=null,ht=vu._;ht;)if(dt.y<ht.y||dt.y===ht.y&&dt.x<=ht.x)if(ht.L)ht=ht.L;else{Je=ht.P;break}else if(ht.R)ht=ht.R;else{Je=ht;break}vu.insert(Je,dt),Je||(Ia=dt)}}}}function cl(l){var A=l.circle;A&&(A.P||(Ia=A.N),vu.remove(A),ll.push(A),wl(A),l.circle=null)}var wf=[];function W0(){wl(this),this.edge=this.site=this.circle=null}function Dc(l){var A=wf.pop()||new W0;return A.site=l,A}function Tf(l){cl(l),Yl.remove(l),wf.push(l),wl(l)}function $f(l){var A=l.circle,y=A.x,b=A.cy,T=[y,b],L=l.P,R=l.N,U=[l];Tf(l);for(var H=L;H.circle&&Math.abs(y-H.circle.x)<Wa&&Math.abs(b-H.circle.cy)<Wa;)L=H.P,U.unshift(H),Tf(H),H=L;U.unshift(H),cl(H);for(var N=R;N.circle&&Math.abs(y-N.circle.x)<Wa&&Math.abs(b-N.circle.cy)<Wa;)R=N.N,U.push(N),Tf(N),N=R;U.push(N),cl(N);var Q=U.length,K;for(K=1;K<Q;++K)N=U[K],H=U[K-1],Wl(N.edge,H.site,N.site,T);H=U[0],N=U[Q-1],N.edge=sf(H.site,N.site,null,T),lc(H),lc(N)}function Y0(l){for(var A=l[0],y=l[1],b,T,L,R,U=Yl._;U;)if(L=cf(U,y)-A,L>Wa)U=U.L;else if(R=A-Mf(U,y),R>Wa){if(!U.R){b=U;break}U=U.R}else{L>-Wa?(b=U.P,T=U):R>-Wa?(b=U,T=U.N):b=T=U;break}Tl(l);var H=Dc(l);if(Yl.insert(b,H),!(!b&&!T)){if(b===T){cl(b),T=Dc(b.site),Yl.insert(H,T),H.edge=T.edge=sf(b.site,H.site),lc(b),lc(T);return}if(!T){H.edge=sf(b.site,H.site);return}cl(b),cl(T);var N=b.site,Q=N[0],K=N[1],ie=l[0]-Q,pe=l[1]-K,pt=T.site,it=pt[0]-Q,Nt=pt[1]-K,dt=2*(ie*Nt-pe*it),Je=ie*ie+pe*pe,ht=it*it+Nt*Nt,Ht=[(Nt*Je-pe*ht)/dt+Q,(ie*ht-it*Je)/dt+K];Wl(T.edge,N,pt,Ht),H.edge=sf(N,l,null,Ht),T.edge=sf(l,pt,null,Ht),lc(b),lc(T)}}function cf(l,A){var y=l.site,b=y[0],T=y[1],L=T-A;if(!L)return b;var R=l.P;if(!R)return-1/0;y=R.site;var U=y[0],H=y[1],N=H-A;if(!N)return U;var Q=U-b,K=1/L-1/N,ie=Q/N;return K?(-ie+Math.sqrt(ie*ie-2*K*(Q*Q/(-2*N)-H+N/2+T-L/2)))/K+b:(b+U)/2}function Mf(l,A){var y=l.N;if(y)return cf(y,A);var b=l.site;return b[1]===A?b[0]:1/0}var Wa=1e-6,Nc=1e-12,Yl,Qs,vu,Os;function Wf(l,A,y){return(l[0]-y[0])*(A[1]-l[1])-(l[0]-A[0])*(y[1]-l[1])}function y0(l,A){return A[1]-l[1]||A[0]-l[0]}function xe(l,A){var y=l.sort(y0).pop(),b,T,L;for(Os=[],Qs=new Array(l.length),Yl=new au,vu=new au;;)if(L=Ia,y&&(!L||y[1]<L.y||y[1]===L.y&&y[0]<L.x))(y[0]!==b||y[1]!==T)&&(Y0(y),b=y[0],T=y[1]),y=l.pop();else if(L)$f(L.arc);else break;if(Cf(),A){var R=+A[0][0],U=+A[0][1],H=+A[1][0],N=+A[1][1];kc(R,U,H,N),ys(R,U,H,N)}this.edges=Os,this.cells=Qs,Yl=vu=Os=Qs=null}xe.prototype={constructor:xe,polygons:function(){var l=this.edges;return this.cells.map(function(A){var y=A.halfedges.map(function(b){return uf(A,l[b])});return y.data=A.site.data,y})},triangles:function(){var l=[],A=this.edges;return this.cells.forEach(function(y,b){if(U=(L=y.halfedges).length)for(var T=y.site,L,R=-1,U,H,N=A[L[U-1]],Q=N.left===T?N.right:N.left;++R<U;)H=Q,N=A[L[R]],Q=N.left===T?N.right:N.left,H&&Q&&b<H.index&&b<Q.index&&Wf(T,H,Q)<0&&l.push([T.data,H.data,Q.data])}),l},links:function(){return this.edges.filter(function(l){return l.right}).map(function(l){return{source:l.left.data,target:l.right.data}})},find:function(l,A,y){for(var b=this,T,L=b._found||0,R=b.cells.length,U;!(U=b.cells[L]);)if(++L>=R)return null;var H=l-U.site[0],N=A-U.site[1],Q=H*H+N*N;do U=b.cells[T=L],L=null,U.halfedges.forEach(function(K){var ie=b.edges[K],pe=ie.left;if(!((pe===U.site||!pe)&&!(pe=ie.right))){var pt=l-pe[0],it=A-pe[1],Nt=pt*pt+it*it;Nt<Q&&(Q=Nt,L=pe.index)}});while(L!==null);return b._found=T,y==null||Q<=y*y?U.site:null}};function Ke(){var l=pointX,A=pointY,y=null;function b(T){return new Diagram(T.map(function(L,R){var U=[Math.round(l(L,R,T)/epsilon)*epsilon,Math.round(A(L,R,T)/epsilon)*epsilon];return U.index=R,U.data=L,U}),y)}return b.polygons=function(T){return b(T).polygons()},b.links=function(T){return b(T).links()},b.triangles=function(T){return b(T).triangles()},b.x=function(T){return arguments.length?(l=typeof T=="function"?T:constant(+T),b):l},b.y=function(T){return arguments.length?(A=typeof T=="function"?T:constant(+T),b):A},b.extent=function(T){return arguments.length?(y=T==null?null:[[+T[0][0],+T[0][1]],[+T[1][0],+T[1][1]]],b):y&&[[y[0][0],y[0][1]],[y[1][0],y[1][1]]]},b.size=function(T){return arguments.length?(y=T==null?null:[[0,0],[+T[0],+T[1]]],b):y&&[y[1][0]-y[0][0],y[1][1]-y[0][1]]},b}function mt(l){return l=l.slice(),l.push(l[0]),polygon([l])}function nr(l,A){if(A=A||{},!isObject(A))throw new Error("options is invalid");var y=A.bbox||[-180,-85,180,85];if(!l)throw new Error("points is required");if(!Array.isArray(y))throw new Error("bbox is invalid");return collectionOf(l,"Point","points"),featureCollection(voronoi$1().x(function(b){return b.geometry.coordinates[0]}).y(function(b){return b.geometry.coordinates[1]}).extent([[y[0],y[1]],[y[2],y[3]]]).polygons(l.features).map(mt))}var Ar=null;function er(l,A,y,b){b=b||{};var T=b.steps||64,L=b.units||"kilometers",R=b.angle||0,U=b.pivot||l,H=b.properties||l.properties||{};if(!l)throw new Error("center is required");if(!A)throw new Error("xSemiAxis is required");if(!y)throw new Error("ySemiAxis is required");if(!isObject(b))throw new Error("options must be an object");if(!isNumber(T))throw new Error("steps must be a number");if(!isNumber(R))throw new Error("angle must be a number");var N=getCoord(l);if(L==="degrees")var Q=degreesToRadians(R);else A=rhumbDestination(l,A,90,{units:L}),y=rhumbDestination(l,y,0,{units:L}),A=getCoord(A)[0]-N[0],y=getCoord(y)[1]-N[1];for(var K=[],ie=0;ie<T;ie+=1){var pe=ie*-360/T,pt=A*y/Math.sqrt(Math.pow(y,2)+Math.pow(A,2)*Math.pow(sr(pe),2)),it=A*y/Math.sqrt(Math.pow(A,2)+Math.pow(y,2)/Math.pow(sr(pe),2));if(pe<-90&&pe>=-270&&(pt=-pt),pe<-180&&pe>=-360&&(it=-it),L==="degrees"){var Nt=pt*Math.cos(Q)+it*Math.sin(Q),dt=it*Math.cos(Q)-pt*Math.sin(Q);pt=Nt,it=dt}K.push([pt+N[0],it+N[1]])}return K.push(K[0]),L==="degrees"?polygon([K],H):transformRotate(polygon([K],H),R,{pivot:U})}function sr(l){var A=l*Math.PI/180;return Math.tan(A)}var wr=null;function Pr(l,A){A===void 0&&(A={});var y=0,b=0,T=0;return geomEach(l,function(L,R,U){var H=A.weight?U==null?void 0:U[A.weight]:void 0;if(H=H==null?1:H,!isNumber(H))throw new Error("weight value must be a number for feature index "+R);H=Number(H),H>0&&coordEach(L,function(N){y+=N[0]*H,b+=N[1]*H,T+=H})}),point([y/T,b/T],A.properties,A)}var Nr=null;function Dr(l,A){if(A===void 0&&(A={}),A=A||{},!isObject(A))throw new Error("options is invalid");var y=A.counter||10;if(!isNumber(y))throw new Error("counter must be a number");var b=A.weight,T=centerMean(l,{weight:A.weight}),L=featureCollection([]);featureEach(l,function(U){var H;L.features.push(centroid(U,{properties:{weight:(H=U.properties)===null||H===void 0?void 0:H[b]}}))});var R={tolerance:A.tolerance,medianCandidates:[]};return Or(T.geometry.coordinates,[0,0],L,R,y)}function Or(l,A,y,b,T){var L=b.tolerance||.001,R=0,U=0,H=0,N=0;if(featureEach(y,function(ie){var pe,pt=(pe=ie.properties)===null||pe===void 0?void 0:pe.weight,it=pt==null?1:pt;if(it=Number(it),!isNumber(it))throw new Error("weight value must be a number");if(it>0){N+=1;var Nt=it*distance(ie,l);Nt===0&&(Nt=1);var dt=it/Nt;R+=ie.geometry.coordinates[0]*dt,U+=ie.geometry.coordinates[1]*dt,H+=dt}}),N<1)throw new Error("no features to measure");var Q=R/H,K=U/H;return N===1||T===0||Math.abs(Q-A[0])<L&&Math.abs(K-A[1])<L?point([Q,K],{medianCandidates:b.medianCandidates}):(b.medianCandidates.push([Q,K]),Or([Q,K],l,y,b,T-1))}var qr=null;function Tr(l,A){if(A=A||{},!isObject(A))throw new Error("options is invalid");var y=A.steps||64,b=A.weight,T=A.properties||{};if(!isNumber(y))throw new Error("steps must be a number");if(!isObject(T))throw new Error("properties must be a number");var L=coordAll(l).length,R=centerMean(l,{weight:b}),U=0,H=0,N=0;featureEach(l,function(Kt){var fr=Kt.properties[b]||1,Ct=Zr(getCoords(Kt),getCoords(R));U+=Math.pow(Ct.x,2)*fr,H+=Math.pow(Ct.y,2)*fr,N+=Ct.x*Ct.y*fr});var Q=U-H,K=Math.sqrt(Math.pow(Q,2)+4*Math.pow(N,2)),ie=2*N,pe=Math.atan((Q+K)/ie),pt=pe*180/Math.PI,it=0,Nt=0,dt=0;featureEach(l,function(Kt){var fr=Kt.properties[b]||1,Ct=Zr(getCoords(Kt),getCoords(R));it+=Math.pow(Ct.x*Math.cos(pe)-Ct.y*Math.sin(pe),2)*fr,Nt+=Math.pow(Ct.x*Math.sin(pe)+Ct.y*Math.cos(pe),2)*fr,dt+=fr});var Je=Math.sqrt(2*it/dt),ht=Math.sqrt(2*Nt/dt),Ht=ellipse(R,Je,ht,{units:"degrees",angle:pt,steps:y,properties:T}),Bt=pointsWithinPolygon(l,featureCollection([Ht])),ir={meanCenterCoordinates:getCoords(R),semiMajorAxis:Je,semiMinorAxis:ht,numberOfFeatures:L,angle:pt,percentageWithinEllipse:100*coordAll(Bt).length/L};return Ht.properties.standardDeviationalEllipse=ir,Ht}function Zr(l,A){return{x:l[0]-A[0],y:l[1]-A[1]}}var Vt=null;function lr(l,A,y,b){if(b===void 0&&(b={}),!isObject(b))throw new Error("options is invalid");if(!l)throw new Error("startPoint is required");if(!A)throw new Error("midPoint is required");if(!y)throw new Error("endPoint is required");var T=l,L=A,R=y,U=bearingToAzimuth(b.mercator!==!0?bearing(T,L):rhumbBearing(T,L)),H=bearingToAzimuth(b.mercator!==!0?bearing(R,L):rhumbBearing(R,L)),N=Math.abs(U-H);return b.explementary===!0?360-N:N}var Rr=null;function tn(l,A){var y=[],b=A.iterations||1;if(!l)throw new Error("inputPolys is required");return geomEach(l,function(T,L,R){var U,H,N;switch(T.type){case"Polygon":U=[[]];for(var Q=0;Q<b;Q++)N=[[]],H=T,Q>0&&(H=polygon(U).geometry),mr(H,N),U=N.slice(0);y.push(polygon(U,R));break;case"MultiPolygon":U=[[[]]];for(var K=0;K<b;K++)N=[[[]]],H=T,K>0&&(H=multiPolygon(U).geometry),cn(H,N),U=N.slice(0);y.push(multiPolygon(U,R));break;default:throw new Error("geometry is invalid, must be Polygon or MultiPolygon")}}),featureCollection(y)}function mr(l,A){var y=0,b=0;coordEach(l,function(T,L,R,U,H){H>y&&(y=H,b=L,A.push([]));var N=L-b,Q=l.coordinates[H][N+1],K=T[0],ie=T[1],pe=Q[0],pt=Q[1];A[H].push([.75*K+.25*pe,.75*ie+.25*pt]),A[H].push([.25*K+.75*pe,.25*ie+.75*pt])},!0),A.forEach(function(T){T.push(T[0])})}function cn(l,A){var y=0,b=0,T=0;coordEach(l,function(L,R,U,H,N){H>T&&(T=H,b=R,A.push([[]])),N>y&&(y=N,b=R,A[H].push([]));var Q=R-b,K=l.coordinates[H][N][Q+1],ie=L[0],pe=L[1],pt=K[0],it=K[1];A[H][N].push([.75*ie+.25*pt,.75*pe+.25*it]),A[H][N].push([.25*ie+.75*pt,.25*pe+.75*it])},!0),A.forEach(function(L){L.forEach(function(R){R.push(R[0])})})}var Cr=null;function Hr(l,A,y){y===void 0&&(y=2);var b=getCoord(l),T=getCoord(A),L=b[0]-T[0],R=b[1]-T[1];return y===1?Math.abs(L)+Math.abs(R):Math.pow(Math.pow(L,y)+Math.pow(R,y),1/y)}function Er(l,A){A=A||{};var y=A.threshold||1e4,b=A.p||2,T=A.binary||!1,L=A.alpha||-1,R=A.standardization||!1,U=[];featureEach(l,function(pe){U.push(centroid(pe))});for(var H=[],N=0;N<U.length;N++)H[N]=[];for(var N=0;N<U.length;N++)for(var Q=N;Q<U.length;Q++){N===Q&&(H[N][Q]=0);var K=Hr(U[N],U[Q],b);H[N][Q]=K,H[Q][N]=K}for(var N=0;N<U.length;N++)for(var Q=0;Q<U.length;Q++){var K=H[N][Q];K!==0&&(T?K<=y?H[N][Q]=1:H[N][Q]=0:K<=y?H[N][Q]=Math.pow(K,L):H[N][Q]=0)}if(R)for(var N=0;N<U.length;N++)for(var ie=H[N].reduce(function(pt,it){return pt+it},0),Q=0;Q<U.length;Q++)H[N][Q]=H[N][Q]/ie;return H}function Yr(l,A){var y=A.inputField,b=A.threshold||1e5,T=A.p||2,L=A.binary||!1,R=A.alpha||-1,U=A.standardization||!0,H=spatialWeight(l,{alpha:R,binary:L,p:T,standardization:U,threshold:b}),N=[];featureEach(l,function(bn){var Ei=bn.properties||{};N.push(Ei[y])});for(var Q=Cn(N),K=Xn(N),ie=0,pe=0,pt=0,it=0,Nt=H.length,dt=0;dt<Nt;dt++){for(var Je=0,ht=0;ht<Nt;ht++)ie+=H[dt][ht]*(N[dt]-Q)*(N[ht]-Q),pe+=H[dt][ht],pt+=Math.pow(H[dt][ht]+H[ht][dt],2),Je+=H[dt][ht]+H[ht][dt];it+=Math.pow(Je,2)}pt=.5*pt;var Ht=ie/pe/K,Bt=-1/(Nt-1),ir=Nt*Nt*pt-Nt*it+3*(pe*pe),Kt=(Nt-1)*(Nt+1)*(pe*pe),fr=ir/Kt-Bt*Bt,Ct=Math.sqrt(fr),oi=(Ht-Bt)/Ct;return{expectedMoranIndex:Bt,moranIndex:Ht,stdNorm:Ct,zNorm:oi}}function Cn(l){for(var A=0,y=0,b=l;y<b.length;y++){var T=b[y];A+=T}return A/l.length}function Xn(l){for(var A=Cn(l),y=0,b=0,T=l;b<T.length;b++){var L=T[b];y+=Math.pow(L-A,2)}return y/l.length}function Ir(l,A){return A===void 0&&(A={}),vr(l,"mercator",A)}function Fr(l,A){return A===void 0&&(A={}),vr(l,"wgs84",A)}function vr(l,A,y){y===void 0&&(y={}),y=y||{};var b=y.mutate;if(!l)throw new Error("geojson is required");return Array.isArray(l)&&isNumber(l[0])?l=A==="mercator"?On(l):Bn(l):(b!==!0&&(l=clone(l)),coordEach(l,function(T){var L=A==="mercator"?On(T):Bn(T);T[0]=L[0],T[1]=L[1]})),l}function On(l){var A=Math.PI/180,y=6378137,b=20037508342789244e-9,T=Math.abs(l[0])<=180?l[0]:l[0]-gn(l[0])*360,L=[y*T*A,y*Math.log(Math.tan(Math.PI*.25+.5*l[1]*A))];return L[0]>b&&(L[0]=b),L[0]<-b&&(L[0]=-b),L[1]>b&&(L[1]=b),L[1]<-b&&(L[1]=-b),L}function Bn(l){var A=180/Math.PI,y=6378137;return[l[0]*A/y,(Math.PI*.5-2*Math.atan(Math.exp(-l[1]/y)))*A]}function gn(l){return l<0?-1:l>0?1:0}var xi=function(){for(var l=0,A=0,y=arguments.length;A<y;A++)l+=arguments[A].length;for(var b=Array(l),T=0,A=0;A<y;A++)for(var L=arguments[A],R=0,U=L.length;R<U;R++,T++)b[T]=L[R];return b};function Jn(l){return Array.isArray(l)?Ao(l):l&&l.bbox?Ao(l.bbox):[Io(),Na()]}function yi(l,A){A===void 0&&(A={}),l==null&&(l=1);for(var y=[],b=0;b<l;b++)y.push(point(Jn(A.bbox)));return featureCollection(y)}function ta(l,A){A===void 0&&(A={}),l==null&&(l=1),(!isNumber(A.num_vertices)||A.num_vertices===void 0)&&(A.num_vertices=10),(!isNumber(A.max_radial_length)||A.max_radial_length===void 0)&&(A.max_radial_length=10);for(var y=[],b=function(L){var R=[],U=xi(Array(A.num_vertices+1)).map(Math.random);U.forEach(function(H,N,Q){Q[N]=N>0?H+Q[N-1]:H}),U.forEach(function(H){H=H*2*Math.PI/U[U.length-1];var N=Math.random();R.push([N*(A.max_radial_length||10)*Math.sin(H),N*(A.max_radial_length||10)*Math.cos(H)])}),R[R.length-1]=R[0],R=R.map(ro(Jn(A.bbox))),y.push(polygon([R]))},T=0;T<l;T++)b(T);return featureCollection(y)}function bo(l,A){if(A===void 0&&(A={}),A=A||{},!isObject(A))throw new Error("options is invalid");var y=A.bbox,b=A.num_vertices,T=A.max_length,L=A.max_rotation;l==null&&(l=1),(!isNumber(b)||b===void 0||b<2)&&(b=10),(!isNumber(T)||T===void 0)&&(T=1e-4),(!isNumber(L)||L===void 0)&&(L=Math.PI/8);for(var R=[],U=0;U<l;U++){for(var H=Jn(y),N=[H],Q=0;Q<b-1;Q++){var K=Q===0?Math.random()*2*Math.PI:Math.tan((N[Q][1]-N[Q-1][1])/(N[Q][0]-N[Q-1][0])),ie=K+(Math.random()-.5)*L*2,pe=Math.random()*T;N.push([N[Q][0]+pe*Math.cos(ie),N[Q][1]+pe*Math.sin(ie)])}R.push(lineString(N))}return featureCollection(R)}function ro(l){return function(A){return[A[0]+l[0],A[1]+l[1]]}}function Ti(){return Math.random()-.5}function Io(){return Ti()*360}function Na(){return Ti()*180}function Ao(l){return[Math.random()*(l[2]-l[0])+l[0],Math.random()*(l[3]-l[1])+l[1]]}function jo(l,A){if(!l)throw new Error("geojson is required");if(l.type!=="FeatureCollection")throw new Error("geojson must be a FeatureCollection");if(A==null)throw new Error("filter is required");var y=[];return featureEach(l,function(b){ga(b.properties,A)&&y.push(b)}),featureCollection(y)}function Fa(l,A,y){if(!l)throw new Error("geojson is required");if(l.type!=="FeatureCollection")throw new Error("geojson must be a FeatureCollection");if(A==null)throw new Error("property is required");for(var b=Tn(l,A),T=Object.keys(b),L=0;L<T.length;L++){for(var R=T[L],U=b[R],H=[],N=0;N<U.length;N++)H.push(l.features[U[N]]);y(featureCollection(H),R,L)}}function Ua(l,A,y,b){var T=b;return Fa(l,A,function(L,R,U){U===0&&b===void 0?T=L:T=y(T,L,R,U)}),T}function Tn(l,A){var y={};return featureEach(l,function(b,T){var L=b.properties||{};if(Object.prototype.hasOwnProperty.call(L,String(A))){var R=L[A];Object.prototype.hasOwnProperty.call(y,R)?y[R].push(T):y[R]=[T]}}),y}function ga(l,A){if(l===void 0)return!1;var y=typeof A;if(y==="number"||y==="string")return Object.prototype.hasOwnProperty.call(l,A);if(Array.isArray(A)){for(var b=0;b<A.length;b++)if(!ga(l,A[b]))return!1;return!0}else return un(l,A)}function un(l,A){for(var y=Object.keys(A),b=0;b<y.length;b++){var T=y[b];if(l[T]!==A[T])return!1}return!0}function Aa(l,A){if(!A)return{};if(!A.length)return{};for(var y={},b=0;b<A.length;b++){var T=A[b];Object.prototype.hasOwnProperty.call(l,T)&&(y[T]=l[T])}return y}var ra=C(94486);function Rn(l,A){var y=getGeom(l),b=getGeom(A),T=l.properties||{},L=polygonClipping.difference(y.coordinates,b.coordinates);return L.length===0?null:L.length===1?polygon(L[0],T):multiPolygon(L,T)}var gi=null,dr=C(46780);function Ri(){return new Xt}function Xt(){this.reset()}Xt.prototype={constructor:Xt,reset:function(){this.s=this.t=0},add:function(l){ct(es,l,this.t),ct(this,es.s,this.s),this.s?this.t+=es.t:this.s=es.t},valueOf:function(){return this.s}};var es=new Xt;function ct(l,A,y){var b=l.s=A+y,T=b-A,L=b-T;l.t=A-L+(y-T)}var ft=1e-6,xt=1e-12,Ur=Math.PI,Un=Ur/2,at=Ur/4,We=Ur*2,St=180/Ur,kt=Ur/180,Ft=Math.abs,h=Math.atan,c=Math.atan2,p=Math.cos,m=Math.ceil,E=Math.exp,S=Math.floor,M=Math.log,k=Math.pow,V=Math.sin,te=Math.sign||function(l){return l>0?1:l<0?-1:0},ve=Math.sqrt,Ne=Math.tan;function ut(l){return l>1?0:l<-1?Ur:Math.acos(l)}function gt(l){return l>1?Un:l<-1?-Un:Math.asin(l)}function rt(l){return(l=V(l/2))*l}function _t(){}function $t(l,A){l&&Yt.hasOwnProperty(l.type)&&Yt[l.type](l,A)}var qt={Feature:function(l,A){$t(l.geometry,A)},FeatureCollection:function(l,A){for(var y=l.features,b=-1,T=y.length;++b<T;)$t(y[b].geometry,A)}},Yt={Sphere:function(l,A){A.sphere()},Point:function(l,A){l=l.coordinates,A.point(l[0],l[1],l[2])},MultiPoint:function(l,A){for(var y=l.coordinates,b=-1,T=y.length;++b<T;)l=y[b],A.point(l[0],l[1],l[2])},LineString:function(l,A){rr(l.coordinates,A,0)},MultiLineString:function(l,A){for(var y=l.coordinates,b=-1,T=y.length;++b<T;)rr(y[b],A,0)},Polygon:function(l,A){Wt(l.coordinates,A)},MultiPolygon:function(l,A){for(var y=l.coordinates,b=-1,T=y.length;++b<T;)Wt(y[b],A)},GeometryCollection:function(l,A){for(var y=l.geometries,b=-1,T=y.length;++b<T;)$t(y[b],A)}};function rr(l,A,y){var b=-1,T=l.length-y,L;for(A.lineStart();++b<T;)L=l[b],A.point(L[0],L[1],L[2]);A.lineEnd()}function Wt(l,A){var y=-1,b=l.length;for(A.polygonStart();++y<b;)rr(l[y],A,1);A.polygonEnd()}function rn(l,A){l&&qt.hasOwnProperty(l.type)?qt[l.type](l,A):$t(l,A)}var En=Ri(),Kr=Ri(),pn,La,oa,pa,Vi,ui={point:_t,lineStart:_t,lineEnd:_t,polygonStart:function(){En.reset(),ui.lineStart=ki,ui.lineEnd=Ya},polygonEnd:function(){var l=+En;Kr.add(l<0?We+l:l),this.lineStart=this.lineEnd=this.point=_t},sphere:function(){Kr.add(We)}};function ki(){ui.point=Qn}function Ya(){Xa(pn,La)}function Qn(l,A){ui.point=Xa,pn=l,La=A,l*=kt,A*=kt,oa=l,pa=p(A=A/2+at),Vi=V(A)}function Xa(l,A){l*=kt,A*=kt,A=A/2+at;var y=l-oa,b=y>=0?1:-1,T=b*y,L=p(A),R=V(A),U=Vi*R,H=pa*L+U*p(T),N=U*b*V(T);En.add(c(N,H)),oa=l,pa=L,Vi=R}function Iu(l){return Kr.reset(),stream(l,ui),Kr*2}function X0(l){return[c(l[1],l[0]),gt(l[2])]}function xA(l){var A=l[0],y=l[1],b=p(y);return[b*p(A),b*V(A),V(y)]}function uv(l,A){return l[0]*A[0]+l[1]*A[1]+l[2]*A[2]}function Th(l,A){return[l[1]*A[2]-l[2]*A[1],l[2]*A[0]-l[0]*A[2],l[0]*A[1]-l[1]*A[0]]}function kp(l,A){l[0]+=A[0],l[1]+=A[1],l[2]+=A[2]}function Yg(l,A){return[l[0]*A,l[1]*A,l[2]*A]}function EA(l){var A=ve(l[0]*l[0]+l[1]*l[1]+l[2]*l[2]);l[0]/=A,l[1]/=A,l[2]/=A}var Ga,qs,So,Xl,cc,Q0,q0,Yf,K0=Ri(),If,ff,hf={point:bA,lineStart:Dp,lineEnd:Np,polygonStart:function(){hf.point=CA,hf.lineStart=lv,hf.lineEnd=cv,K0.reset(),ui.polygonStart()},polygonEnd:function(){ui.polygonEnd(),hf.point=bA,hf.lineStart=Dp,hf.lineEnd=Np,En<0?(Ga=-(So=180),qs=-(Xl=90)):K0>ft?Xl=90:K0<-ft&&(qs=-90),ff[0]=Ga,ff[1]=So}};function bA(l,A){If.push(ff=[Ga=l,So=l]),A<qs&&(qs=A),A>Xl&&(Xl=A)}function SA(l,A){var y=xA([l*kt,A*kt]);if(Yf){var b=Th(Yf,y),T=[b[1],-b[0],0],L=Th(T,b);EA(L),L=X0(L);var R=l-cc,U=R>0?1:-1,H=L[0]*St*U,N,Q=Ft(R)>180;Q^(U*cc<H&&H<U*l)?(N=L[1]*St,N>Xl&&(Xl=N)):(H=(H+360)%360-180,Q^(U*cc<H&&H<U*l)?(N=-L[1]*St,N<qs&&(qs=N)):(A<qs&&(qs=A),A>Xl&&(Xl=A))),Q?l<cc?Ml(Ga,l)>Ml(Ga,So)&&(So=l):Ml(l,So)>Ml(Ga,So)&&(Ga=l):So>=Ga?(l<Ga&&(Ga=l),l>So&&(So=l)):l>cc?Ml(Ga,l)>Ml(Ga,So)&&(So=l):Ml(l,So)>Ml(Ga,So)&&(Ga=l)}else If.push(ff=[Ga=l,So=l]);A<qs&&(qs=A),A>Xl&&(Xl=A),Yf=y,cc=l}function Dp(){hf.point=SA}function Np(){ff[0]=Ga,ff[1]=So,hf.point=bA,Yf=null}function CA(l,A){if(Yf){var y=l-cc;K0.add(Ft(y)>180?y+(y>0?360:-360):y)}else Q0=l,q0=A;ui.point(l,A),SA(l,A)}function lv(){ui.lineStart()}function cv(){CA(Q0,q0),ui.lineEnd(),Ft(K0)>ft&&(Ga=-(So=180)),ff[0]=Ga,ff[1]=So,Yf=null}function Ml(l,A){return(A-=l)<0?A+360:A}function fv(l,A){return l[0]-A[0]}function Fp(l,A){return l[0]<=l[1]?l[0]<=A&&A<=l[1]:A<l[0]||l[1]<A}function hv(l){var A,y,b,T,L,R,U;if(Xl=So=-(Ga=qs=1/0),If=[],stream(l,hf),y=If.length){for(If.sort(fv),A=1,b=If[0],L=[b];A<y;++A)T=If[A],Fp(b,T[0])||Fp(b,T[1])?(Ml(b[0],T[1])>Ml(b[0],b[1])&&(b[1]=T[1]),Ml(T[0],b[1])>Ml(b[0],b[1])&&(b[0]=T[0])):L.push(b=T);for(R=-1/0,y=L.length-1,A=0,b=L[y];A<=y;b=T,++A)T=L[A],(U=Ml(b[1],T[0]))>R&&(R=U,Ga=T[0],So=b[1])}return If=ff=null,Ga===1/0||qs===1/0?[[NaN,NaN],[NaN,NaN]]:[[Ga,qs],[So,Xl]]}var Xf,Mh,Ih,J0,Lh,Ph,eh,Oh,wA,TA,MA,IA,Bp,Vu,Hu,gu,fc={sphere:_t,point:LA,lineStart:PA,lineEnd:OA,polygonStart:function(){fc.lineStart=Zp,fc.lineEnd=pv},polygonEnd:function(){fc.lineStart=PA,fc.lineEnd=OA}};function LA(l,A){l*=kt,A*=kt;var y=p(A);_0(y*p(l),y*V(l),V(A))}function _0(l,A,y){++Xf,Ih+=(l-Ih)/Xf,J0+=(A-J0)/Xf,Lh+=(y-Lh)/Xf}function PA(){fc.point=Av}function Av(l,A){l*=kt,A*=kt;var y=p(A);Vu=y*p(l),Hu=y*V(l),gu=V(A),fc.point=Rh,_0(Vu,Hu,gu)}function Rh(l,A){l*=kt,A*=kt;var y=p(A),b=y*p(l),T=y*V(l),L=V(A),R=c(ve((R=Hu*L-gu*T)*R+(R=gu*b-Vu*L)*R+(R=Vu*T-Hu*b)*R),Vu*b+Hu*T+gu*L);Mh+=R,Ph+=R*(Vu+(Vu=b)),eh+=R*(Hu+(Hu=T)),Oh+=R*(gu+(gu=L)),_0(Vu,Hu,gu)}function OA(){fc.point=LA}function Zp(){fc.point=dv}function pv(){RA(IA,Bp),fc.point=LA}function dv(l,A){IA=l,Bp=A,l*=kt,A*=kt,fc.point=RA;var y=p(A);Vu=y*p(l),Hu=y*V(l),gu=V(A),_0(Vu,Hu,gu)}function RA(l,A){l*=kt,A*=kt;var y=p(A),b=y*p(l),T=y*V(l),L=V(A),R=Hu*L-gu*T,U=gu*b-Vu*L,H=Vu*T-Hu*b,N=ve(R*R+U*U+H*H),Q=gt(N),K=N&&-Q/N;wA+=K*R,TA+=K*U,MA+=K*H,Mh+=Q,Ph+=Q*(Vu+(Vu=b)),eh+=Q*(Hu+(Hu=T)),Oh+=Q*(gu+(gu=L)),_0(Vu,Hu,gu)}function Xg(l){Xf=Mh=Ih=J0=Lh=Ph=eh=Oh=wA=TA=MA=0,stream(l,fc);var A=wA,y=TA,b=MA,T=A*A+y*y+b*b;return T<epsilon2&&(A=Ph,y=eh,b=Oh,Mh<epsilon&&(A=Ih,y=J0,b=Lh),T=A*A+y*y+b*b,T<epsilon2)?[NaN,NaN]:[atan2(y,A)*degrees,asin(b/sqrt(T))*degrees]}function kA(l,A){return[l>Ur?l-We:l<-Ur?l+We:l,A]}kA.invert=kA;function zp(l,A,y){return(l%=tau)?A||y?compose(Up(l),NA(A,y)):Up(l):A||y?NA(A,y):kA}function DA(l){return function(A,y){return A+=l,[A>pi?A-tau:A<-pi?A+tau:A,y]}}function Up(l){var A=DA(l);return A.invert=DA(-l),A}function NA(l,A){var y=cos(l),b=sin(l),T=cos(A),L=sin(A);function R(U,H){var N=cos(H),Q=cos(U)*N,K=sin(U)*N,ie=sin(H),pe=ie*y+Q*b;return[atan2(K*T-pe*L,Q*y-ie*b),asin(pe*T+K*L)]}return R.invert=function(U,H){var N=cos(H),Q=cos(U)*N,K=sin(U)*N,ie=sin(H),pe=ie*T-K*L;return[atan2(K*T+ie*L,Q*y+pe*b),asin(pe*y-Q*b)]},R}function vv(l){l=zp(l[0]*radians,l[1]*radians,l.length>2?l[2]*radians:0);function A(y){return y=l(y[0]*radians,y[1]*radians),y[0]*=degrees,y[1]*=degrees,y}return A.invert=function(y){return y=l.invert(y[0]*radians,y[1]*radians),y[0]*=degrees,y[1]*=degrees,y},A}function gv(l,A,y,b,T,L){if(y){var R=cos(A),U=sin(A),H=b*y;T==null?(T=A+b*tau,L=A-H/2):(T=Af(R,T),L=Af(R,L),(b>0?T<L:T>L)&&(T+=b*tau));for(var N,Q=T;b>0?Q>L:Q<L;Q-=H)N=spherical([R,-U*cos(Q),-U*sin(Q)]),l.point(N[0],N[1])}}function Af(l,A){A=cartesian(A),A[0]-=l,cartesianNormalizeInPlace(A);var y=acos(-A[1]);return((-A[2]<0?-y:y)+tau-epsilon)%tau}function x0(){var l=constant([0,0]),A=constant(90),y=constant(6),b,T,L={point:R};function R(H,N){b.push(H=T(H,N)),H[0]*=degrees,H[1]*=degrees}function U(){var H=l.apply(this,arguments),N=A.apply(this,arguments)*radians,Q=y.apply(this,arguments)*radians;return b=[],T=rotateRadians(-H[0]*radians,-H[1]*radians,0).invert,gv(L,N,Q,1),H={type:"Polygon",coordinates:[b]},b=T=null,H}return U.center=function(H){return arguments.length?(l=typeof H=="function"?H:constant([+H[0],+H[1]]),U):l},U.radius=function(H){return arguments.length?(A=typeof H=="function"?H:constant(+H),U):A},U.precision=function(H){return arguments.length?(y=typeof H=="function"?H:constant(+H),U):y},U}function kh(l,A){return Ft(l[0]-A[0])<ft&&Ft(l[1]-A[1])<ft}function cs(l,A,y,b){this.x=l,this.z=A,this.o=y,this.e=b,this.v=!1,this.n=this.p=null}function mv(l,A,y,b,T){var L=[],R=[],U,H;if(l.forEach(function(pt){if(!((it=pt.length-1)<=0)){var it,Nt=pt[0],dt=pt[it],Je;if(kh(Nt,dt)){for(T.lineStart(),U=0;U<it;++U)T.point((Nt=pt[U])[0],Nt[1]);T.lineEnd();return}L.push(Je=new cs(Nt,pt,null,!0)),R.push(Je.o=new cs(Nt,null,Je,!1)),L.push(Je=new cs(dt,pt,null,!1)),R.push(Je.o=new cs(dt,null,Je,!0))}}),!!L.length){for(R.sort(A),Gp(L),Gp(R),U=0,H=R.length;U<H;++U)R[U].e=y=!y;for(var N=L[0],Q,K;;){for(var ie=N,pe=!0;ie.v;)if((ie=ie.n)===N)return;Q=ie.z,T.lineStart();do{if(ie.v=ie.o.v=!0,ie.e){if(pe)for(U=0,H=Q.length;U<H;++U)T.point((K=Q[U])[0],K[1]);else b(ie.x,ie.n.x,1,T);ie=ie.n}else{if(pe)for(Q=ie.p.z,U=Q.length-1;U>=0;--U)T.point((K=Q[U])[0],K[1]);else b(ie.x,ie.p.x,-1,T);ie=ie.p}ie=ie.o,Q=ie.z,pe=!pe}while(!ie.v);T.lineEnd()}}}function Gp(l){if(A=l.length){for(var A,y=0,b=l[0],T;++y<A;)b.n=T=l[y],T.p=b,b=T;b.n=T=l[0],T.p=b}}var jp=C(57965),E0=1e9,Dh=-E0;function yv(l,A,y,b){function T(N,Q){return l<=N&&N<=y&&A<=Q&&Q<=b}function L(N,Q,K,ie){var pe=0,pt=0;if(N==null||(pe=R(N,K))!==(pt=R(Q,K))||H(N,Q)<0^K>0)do ie.point(pe===0||pe===3?l:y,pe>1?b:A);while((pe=(pe+K+4)%4)!==pt);else ie.point(Q[0],Q[1])}function R(N,Q){return abs(N[0]-l)<epsilon?Q>0?0:3:abs(N[0]-y)<epsilon?Q>0?2:1:abs(N[1]-A)<epsilon?Q>0?1:0:Q>0?3:2}function U(N,Q){return H(N.x,Q.x)}function H(N,Q){var K=R(N,1),ie=R(Q,1);return K!==ie?K-ie:K===0?Q[1]-N[1]:K===1?N[0]-Q[0]:K===2?N[1]-Q[1]:Q[0]-N[0]}return function(N){var Q=N,K=clipBuffer(),ie,pe,pt,it,Nt,dt,Je,ht,Ht,Bt,ir,Kt={point:fr,lineStart:Ei,lineEnd:$i,polygonStart:oi,polygonEnd:bn};function fr(ii,Dn){T(ii,Dn)&&Q.point(ii,Dn)}function Ct(){for(var ii=0,Dn=0,Pa=pe.length;Dn<Pa;++Dn)for(var ba=pe[Dn],Ji=1,mu=ba.length,_s=ba[0],ou,Qa,po=_s[0],Vo=_s[1];Ji<mu;++Ji)ou=po,Qa=Vo,_s=ba[Ji],po=_s[0],Vo=_s[1],Qa<=b?Vo>b&&(po-ou)*(b-Qa)>(Vo-Qa)*(l-ou)&&++ii:Vo<=b&&(po-ou)*(b-Qa)<(Vo-Qa)*(l-ou)&&--ii;return ii}function oi(){Q=K,ie=[],pe=[],ir=!0}function bn(){var ii=Ct(),Dn=ir&&ii,Pa=(ie=merge(ie)).length;(Dn||Pa)&&(N.polygonStart(),Dn&&(N.lineStart(),L(null,null,1,N),N.lineEnd()),Pa&&clipPolygon(ie,U,ii,L,N),N.polygonEnd()),Q=N,ie=pe=pt=null}function Ei(){Kt.point=on,pe&&pe.push(pt=[]),Bt=!0,Ht=!1,Je=ht=NaN}function $i(){ie&&(on(it,Nt),dt&&Ht&&K.rejoin(),ie.push(K.result())),Kt.point=fr,Ht&&Q.lineEnd()}function on(ii,Dn){var Pa=T(ii,Dn);if(pe&&pt.push([ii,Dn]),Bt)it=ii,Nt=Dn,dt=Pa,Bt=!1,Pa&&(Q.lineStart(),Q.point(ii,Dn));else if(Pa&&Ht)Q.point(ii,Dn);else{var ba=[Je=Math.max(Dh,Math.min(E0,Je)),ht=Math.max(Dh,Math.min(E0,ht))],Ji=[ii=Math.max(Dh,Math.min(E0,ii)),Dn=Math.max(Dh,Math.min(E0,Dn))];clipLine(ba,Ji,l,A,y,b)?(Ht||(Q.lineStart(),Q.point(ba[0],ba[1])),Q.point(Ji[0],Ji[1]),Pa||Q.lineEnd(),ir=!1):Pa&&(Q.lineStart(),Q.point(ii,Dn),ir=!1)}Je=ii,ht=Dn,Ht=Pa}return Kt}}function Qg(){var l=0,A=0,y=960,b=500,T,L,R;return R={stream:function(U){return T&&L===U?T:T=yv(l,A,y,b)(L=U)},extent:function(U){return arguments.length?(l=+U[0][0],A=+U[0][1],y=+U[1][0],b=+U[1][1],T=L=null,R):[[l,A],[y,b]]}}}var FA=Ri();function Ki(l,A){var y=A[0],b=A[1],T=[V(y),-p(y),0],L=0,R=0;FA.reset();for(var U=0,H=l.length;U<H;++U)if(Q=(N=l[U]).length)for(var N,Q,K=N[Q-1],ie=K[0],pe=K[1]/2+at,pt=V(pe),it=p(pe),Nt=0;Nt<Q;++Nt,ie=Je,pt=Ht,it=Bt,K=dt){var dt=N[Nt],Je=dt[0],ht=dt[1]/2+at,Ht=V(ht),Bt=p(ht),ir=Je-ie,Kt=ir>=0?1:-1,fr=Kt*ir,Ct=fr>Ur,oi=pt*Ht;if(FA.add(c(oi*Kt*V(fr),it*Bt+oi*p(fr))),L+=Ct?ir+Kt*We:ir,Ct^ie>=y^Je>=y){var bn=Th(xA(K),xA(dt));EA(bn);var Ei=Th(T,bn);EA(Ei);var $i=(Ct^ir>=0?-1:1)*gt(Ei[2]);(b>$i||b===$i&&(bn[0]||bn[1]))&&(R+=Ct^ir>=0?1:-1)}}return(L<-ft||L<ft&&FA<-ft)^R&1}var Hi=Ri(),Nh,BA,Fh,th={sphere:_t,point:_t,lineStart:qg,lineEnd:_t,polygonStart:_t,polygonEnd:_t};function qg(){th.point=Jg,th.lineEnd=Kg}function Kg(){th.point=th.lineEnd=_t}function Jg(l,A){l*=kt,A*=kt,Nh=l,BA=V(A),Fh=p(A),th.point=em}function em(l,A){l*=kt,A*=kt;var y=V(A),b=p(A),T=Ft(l-Nh),L=p(T),R=V(T),U=b*R,H=Fh*y-BA*b*L,N=BA*y+Fh*b*L;Hi.add(c(ve(U*U+H*H),N)),Nh=l,BA=y,Fh=b}function tm(l){return Hi.reset(),rn(l,th),+Hi}var Vp=[null,null],rm={type:"LineString",coordinates:Vp};function ZA(l,A){return Vp[0]=l,Vp[1]=A,tm(rm)}var _v={Feature:function(l,A){return Bh(l.geometry,A)},FeatureCollection:function(l,A){for(var y=l.features,b=-1,T=y.length;++b<T;)if(Bh(y[b].geometry,A))return!0;return!1}},xv={Sphere:function(){return!0},Point:function(l,A){return Ev(l.coordinates,A)},MultiPoint:function(l,A){for(var y=l.coordinates,b=-1,T=y.length;++b<T;)if(Ev(y[b],A))return!0;return!1},LineString:function(l,A){return bv(l.coordinates,A)},MultiLineString:function(l,A){for(var y=l.coordinates,b=-1,T=y.length;++b<T;)if(bv(y[b],A))return!0;return!1},Polygon:function(l,A){return Sv(l.coordinates,A)},MultiPolygon:function(l,A){for(var y=l.coordinates,b=-1,T=y.length;++b<T;)if(Sv(y[b],A))return!0;return!1},GeometryCollection:function(l,A){for(var y=l.geometries,b=-1,T=y.length;++b<T;)if(Bh(y[b],A))return!0;return!1}};function Bh(l,A){return l&&xv.hasOwnProperty(l.type)?xv[l.type](l,A):!1}function Ev(l,A){return ZA(l,A)===0}function bv(l,A){var y=ZA(l[0],l[1]),b=ZA(l[0],A),T=ZA(A,l[1]);return b+T<=y+ft}function Sv(l,A){return!!Ki(l.map(nm),Cv(A))}function nm(l){return l=l.map(Cv),l.pop(),l}function Cv(l){return[l[0]*kt,l[1]*kt]}function _x(l,A){return(l&&_v.hasOwnProperty(l.type)?_v[l.type]:Bh)(l,A)}function wv(l,A,y){var b=range(l,A-epsilon,y).concat(A);return function(T){return b.map(function(L){return[T,L]})}}function Tv(l,A,y){var b=range(l,A-epsilon,y).concat(A);return function(T){return b.map(function(L){return[L,T]})}}function im(){var l,A,y,b,T,L,R,U,H=10,N=H,Q=90,K=360,ie,pe,pt,it,Nt=2.5;function dt(){return{type:"MultiLineString",coordinates:Je()}}function Je(){return range(ceil(b/Q)*Q,y,Q).map(pt).concat(range(ceil(U/K)*K,R,K).map(it)).concat(range(ceil(A/H)*H,l,H).filter(function(ht){return abs(ht%Q)>epsilon}).map(ie)).concat(range(ceil(L/N)*N,T,N).filter(function(ht){return abs(ht%K)>epsilon}).map(pe))}return dt.lines=function(){return Je().map(function(ht){return{type:"LineString",coordinates:ht}})},dt.outline=function(){return{type:"Polygon",coordinates:[pt(b).concat(it(R).slice(1),pt(y).reverse().slice(1),it(U).reverse().slice(1))]}},dt.extent=function(ht){return arguments.length?dt.extentMajor(ht).extentMinor(ht):dt.extentMinor()},dt.extentMajor=function(ht){return arguments.length?(b=+ht[0][0],y=+ht[1][0],U=+ht[0][1],R=+ht[1][1],b>y&&(ht=b,b=y,y=ht),U>R&&(ht=U,U=R,R=ht),dt.precision(Nt)):[[b,U],[y,R]]},dt.extentMinor=function(ht){return arguments.length?(A=+ht[0][0],l=+ht[1][0],L=+ht[0][1],T=+ht[1][1],A>l&&(ht=A,A=l,l=ht),L>T&&(ht=L,L=T,T=ht),dt.precision(Nt)):[[A,L],[l,T]]},dt.step=function(ht){return arguments.length?dt.stepMajor(ht).stepMinor(ht):dt.stepMinor()},dt.stepMajor=function(ht){return arguments.length?(Q=+ht[0],K=+ht[1],dt):[Q,K]},dt.stepMinor=function(ht){return arguments.length?(H=+ht[0],N=+ht[1],dt):[H,N]},dt.precision=function(ht){return arguments.length?(Nt=+ht,ie=wv(L,T,90),pe=Tv(A,l,Nt),pt=wv(U,R,90),it=Tv(b,y,Nt),dt):Nt},dt.extentMajor([[-180,-90+epsilon],[180,90-epsilon]]).extentMinor([[-180,-80-epsilon],[180,80+epsilon]])}function xx(){return im()()}function Ex(l,A){var y=l[0]*radians,b=l[1]*radians,T=A[0]*radians,L=A[1]*radians,R=cos(b),U=sin(b),H=cos(L),N=sin(L),Q=R*cos(y),K=R*sin(y),ie=H*cos(T),pe=H*sin(T),pt=2*asin(sqrt(haversin(L-b)+R*H*haversin(T-y))),it=sin(pt),Nt=pt?function(dt){var Je=sin(dt*=pt)/it,ht=sin(pt-dt)/it,Ht=ht*Q+Je*ie,Bt=ht*K+Je*pe,ir=ht*U+Je*N;return[atan2(Bt,Ht)*degrees,atan2(ir,sqrt(Ht*Ht+Bt*Bt))*degrees]}:function(){return[y*degrees,b*degrees]};return Nt.distance=pt,Nt}var Hp=Ri(),rh=Ri(),Mv,Iv,$p,Wp,b0={point:_t,lineStart:_t,lineEnd:_t,polygonStart:function(){b0.lineStart=am,b0.lineEnd=sm},polygonEnd:function(){b0.lineStart=b0.lineEnd=b0.point=_t,Hp.add(Ft(rh)),rh.reset()},result:function(){var l=Hp/2;return Hp.reset(),l}};function am(){b0.point=om}function om(l,A){b0.point=Lv,Mv=$p=l,Iv=Wp=A}function Lv(l,A){rh.add(Wp*l-$p*A),$p=l,Wp=A}function sm(){Lv(Mv,Iv)}var bx=null,nh=1/0,zA=nh,Zh=-nh,S0=Zh,um={point:Yp,lineStart:_t,lineEnd:_t,polygonStart:_t,polygonEnd:_t,result:function(){var l=[[nh,zA],[Zh,S0]];return Zh=S0=-(zA=nh=1/0),l}};function Yp(l,A){l<nh&&(nh=l),l>Zh&&(Zh=l),A<zA&&(zA=A),A>S0&&(S0=A)}var Pv=null,Fc=0,pf=0,C0=0,ih=0,ah=0,Lf=0,zh=0,UA=0,oh=0,GA,jA,Bc,Zc,zc={point:Qf,lineStart:w0,lineEnd:VA,polygonStart:function(){zc.lineStart=Qp,zc.lineEnd=HA},polygonEnd:function(){zc.point=Qf,zc.lineStart=w0,zc.lineEnd=VA},result:function(){var l=oh?[zh/oh,UA/oh]:Lf?[ih/Lf,ah/Lf]:C0?[Fc/C0,pf/C0]:[NaN,NaN];return Fc=pf=C0=ih=ah=Lf=zh=UA=oh=0,l}};function Qf(l,A){Fc+=l,pf+=A,++C0}function w0(){zc.point=$u}function $u(l,A){zc.point=Xp,Qf(Bc=l,Zc=A)}function Xp(l,A){var y=l-Bc,b=A-Zc,T=ve(y*y+b*b);ih+=T*(Bc+l)/2,ah+=T*(Zc+A)/2,Lf+=T,Qf(Bc=l,Zc=A)}function VA(){zc.point=Qf}function Qp(){zc.point=qp}function HA(){Kp(GA,jA)}function qp(l,A){zc.point=Kp,Qf(GA=Bc=l,jA=Zc=A)}function Kp(l,A){var y=l-Bc,b=A-Zc,T=ve(y*y+b*b);ih+=T*(Bc+l)/2,ah+=T*(Zc+A)/2,Lf+=T,T=Zc*l-Bc*A,zh+=T*(Bc+l),UA+=T*(Zc+A),oh+=T*3,Qf(Bc=l,Zc=A)}var lm=null;function Ov(l){this._context=l}Ov.prototype={_radius:4.5,pointRadius:function(l){return this._radius=l,this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){this._line===0&&this._context.closePath(),this._point=NaN},point:function(l,A){switch(this._point){case 0:{this._context.moveTo(l,A),this._point=1;break}case 1:{this._context.lineTo(l,A);break}default:{this._context.moveTo(l+this._radius,A),this._context.arc(l,A,this._radius,0,We);break}}},result:_t};var $A=Ri(),WA,Jp,ed,Ge,T0,Uh={point:_t,lineStart:function(){Uh.point=td},lineEnd:function(){WA&&YA(Jp,ed),Uh.point=_t},polygonStart:function(){WA=!0},polygonEnd:function(){WA=null},result:function(){var l=+$A;return $A.reset(),l}};function td(l,A){Uh.point=YA,Jp=Ge=l,ed=T0=A}function YA(l,A){Ge-=l,T0-=A,$A.add(ve(Ge*Ge+T0*T0)),Ge=l,T0=A}var Rv=null;function rd(){this._string=[]}rd.prototype={_radius:4.5,_circle:XA(4.5),pointRadius:function(l){return(l=+l)!==this._radius&&(this._radius=l,this._circle=null),this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){this._line===0&&this._string.push("Z"),this._point=NaN},point:function(l,A){switch(this._point){case 0:{this._string.push("M",l,",",A),this._point=1;break}case 1:{this._string.push("L",l,",",A);break}default:{this._circle==null&&(this._circle=XA(this._radius)),this._string.push("M",l,",",A,this._circle);break}}},result:function(){if(this._string.length){var l=this._string.join("");return this._string=[],l}else return null}};function XA(l){return"m0,"+l+"a"+l+","+l+" 0 1,1 0,"+-2*l+"a"+l+","+l+" 0 1,1 0,"+2*l+"z"}function M0(l,A){var y=4.5,b,T;function L(R){return R&&(typeof y=="function"&&T.pointRadius(+y.apply(this,arguments)),stream(R,b(T))),T.result()}return L.area=function(R){return stream(R,b(pathArea)),pathArea.result()},L.measure=function(R){return stream(R,b(pathMeasure)),pathMeasure.result()},L.bounds=function(R){return stream(R,b(pathBounds)),pathBounds.result()},L.centroid=function(R){return stream(R,b(pathCentroid)),pathCentroid.result()},L.projection=function(R){return arguments.length?(b=R==null?(l=null,identity):(l=R).stream,L):l},L.context=function(R){return arguments.length?(T=R==null?(A=null,new PathString):new PathContext(A=R),typeof y!="function"&&T.pointRadius(y),L):A},L.pointRadius=function(R){return arguments.length?(y=typeof R=="function"?R:(T.pointRadius(+R),+R),L):y},L.projection(l).context(A)}function nd(){var l=[],A;return{point:function(y,b){A.push([y,b])},lineStart:function(){l.push(A=[])},lineEnd:_t,rejoin:function(){l.length>1&&l.push(l.pop().concat(l.shift()))},result:function(){var y=l;return l=[],A=null,y}}}function id(l,A,y,b){return function(T,L){var R=A(L),U=T.invert(b[0],b[1]),H=nd(),N=A(H),Q=!1,K,ie,pe,pt={point:it,lineStart:dt,lineEnd:Je,polygonStart:function(){pt.point=ht,pt.lineStart=Ht,pt.lineEnd=Bt,ie=[],K=[]},polygonEnd:function(){pt.point=it,pt.lineStart=dt,pt.lineEnd=Je,ie=(0,jp.TS)(ie);var ir=Ki(K,U);ie.length?(Q||(L.polygonStart(),Q=!0),mv(ie,od,ir,y,L)):ir&&(Q||(L.polygonStart(),Q=!0),L.lineStart(),y(null,null,1,L),L.lineEnd()),Q&&(L.polygonEnd(),Q=!1),ie=K=null},sphere:function(){L.polygonStart(),L.lineStart(),y(null,null,1,L),L.lineEnd(),L.polygonEnd()}};function it(ir,Kt){var fr=T(ir,Kt);l(ir=fr[0],Kt=fr[1])&&L.point(ir,Kt)}function Nt(ir,Kt){var fr=T(ir,Kt);R.point(fr[0],fr[1])}function dt(){pt.point=Nt,R.lineStart()}function Je(){pt.point=it,R.lineEnd()}function ht(ir,Kt){pe.push([ir,Kt]);var fr=T(ir,Kt);N.point(fr[0],fr[1])}function Ht(){N.lineStart(),pe=[]}function Bt(){ht(pe[0][0],pe[0][1]),N.lineEnd();var ir=N.clean(),Kt=H.result(),fr,Ct=Kt.length,oi,bn,Ei;if(pe.pop(),K.push(pe),pe=null,!!Ct){if(ir&1){if(bn=Kt[0],(oi=bn.length-1)>0){for(Q||(L.polygonStart(),Q=!0),L.lineStart(),fr=0;fr<oi;++fr)L.point((Ei=bn[fr])[0],Ei[1]);L.lineEnd()}return}Ct>1&&ir&2&&Kt.push(Kt.pop().concat(Kt.shift())),ie.push(Kt.filter(ad))}}return pt}}function ad(l){return l.length>1}function od(l,A){return((l=l.x)[0]<0?l[1]-Un-ft:Un-l[1])-((A=A.x)[0]<0?A[1]-Un-ft:Un-A[1])}var kv=id(function(){return!0},Dv,sd,[-Ur,-Un]);function Dv(l){var A=NaN,y=NaN,b=NaN,T;return{lineStart:function(){l.lineStart(),T=1},point:function(L,R){var U=L>0?Ur:-Ur,H=Ft(L-A);Ft(H-Ur)<ft?(l.point(A,y=(y+R)/2>0?Un:-Un),l.point(b,y),l.lineEnd(),l.lineStart(),l.point(U,y),l.point(L,y),T=0):b!==U&&H>=Ur&&(Ft(A-b)<ft&&(A-=b*ft),Ft(L-U)<ft&&(L-=U*ft),y=Nv(A,y,L,R),l.point(b,y),l.lineEnd(),l.lineStart(),l.point(U,y),T=0),l.point(A=L,y=R),b=U},lineEnd:function(){l.lineEnd(),A=y=NaN},clean:function(){return 2-T}}}function Nv(l,A,y,b){var T,L,R=V(l-y);return Ft(R)>ft?h((V(A)*(L=p(b))*V(y)-V(b)*(T=p(A))*V(l))/(T*L*R)):(A+b)/2}function sd(l,A,y,b){var T;if(l==null)T=y*Un,b.point(-Ur,T),b.point(0,T),b.point(Ur,T),b.point(Ur,0),b.point(Ur,-T),b.point(0,-T),b.point(-Ur,-T),b.point(-Ur,0),b.point(-Ur,T);else if(Ft(l[0]-A[0])>ft){var L=l[0]<A[0]?Ur:-Ur;T=y*L/2,b.point(-L,T),b.point(0,T),b.point(L,T)}else b.point(A[0],A[1])}function Fv(l,A){var y=cos(l),b=y>0,T=abs(y)>epsilon;function L(Q,K,ie,pe){circleStream(pe,l,A,ie,Q,K)}function R(Q,K){return cos(Q)*cos(K)>y}function U(Q){var K,ie,pe,pt,it;return{lineStart:function(){pt=pe=!1,it=1},point:function(Nt,dt){var Je=[Nt,dt],ht,Ht=R(Nt,dt),Bt=b?Ht?0:N(Nt,dt):Ht?N(Nt+(Nt<0?pi:-pi),dt):0;if(!K&&(pt=pe=Ht)&&Q.lineStart(),Ht!==pe&&(ht=H(K,Je),(!ht||pointEqual(K,ht)||pointEqual(Je,ht))&&(Je[0]+=epsilon,Je[1]+=epsilon,Ht=R(Je[0],Je[1]))),Ht!==pe)it=0,Ht?(Q.lineStart(),ht=H(Je,K),Q.point(ht[0],ht[1])):(ht=H(K,Je),Q.point(ht[0],ht[1]),Q.lineEnd()),K=ht;else if(T&&K&&b^Ht){var ir;!(Bt&ie)&&(ir=H(Je,K,!0))&&(it=0,b?(Q.lineStart(),Q.point(ir[0][0],ir[0][1]),Q.point(ir[1][0],ir[1][1]),Q.lineEnd()):(Q.point(ir[1][0],ir[1][1]),Q.lineEnd(),Q.lineStart(),Q.point(ir[0][0],ir[0][1])))}Ht&&(!K||!pointEqual(K,Je))&&Q.point(Je[0],Je[1]),K=Je,pe=Ht,ie=Bt},lineEnd:function(){pe&&Q.lineEnd(),K=null},clean:function(){return it|(pt&&pe)<<1}}}function H(Q,K,ie){var pe=cartesian(Q),pt=cartesian(K),it=[1,0,0],Nt=cartesianCross(pe,pt),dt=cartesianDot(Nt,Nt),Je=Nt[0],ht=dt-Je*Je;if(!ht)return!ie&&Q;var Ht=y*dt/ht,Bt=-y*Je/ht,ir=cartesianCross(it,Nt),Kt=cartesianScale(it,Ht),fr=cartesianScale(Nt,Bt);cartesianAddInPlace(Kt,fr);var Ct=ir,oi=cartesianDot(Kt,Ct),bn=cartesianDot(Ct,Ct),Ei=oi*oi-bn*(cartesianDot(Kt,Kt)-1);if(!(Ei<0)){var $i=sqrt(Ei),on=cartesianScale(Ct,(-oi-$i)/bn);if(cartesianAddInPlace(on,Kt),on=spherical(on),!ie)return on;var ii=Q[0],Dn=K[0],Pa=Q[1],ba=K[1],Ji;Dn<ii&&(Ji=ii,ii=Dn,Dn=Ji);var mu=Dn-ii,_s=abs(mu-pi)<epsilon,ou=_s||mu<epsilon;if(!_s&&ba<Pa&&(Ji=Pa,Pa=ba,ba=Ji),ou?_s?Pa+ba>0^on[1]<(abs(on[0]-ii)<epsilon?Pa:ba):Pa<=on[1]&&on[1]<=ba:mu>pi^(ii<=on[0]&&on[0]<=Dn)){var Qa=cartesianScale(Ct,(-oi+$i)/bn);return cartesianAddInPlace(Qa,Kt),[on,spherical(Qa)]}}}function N(Q,K){var ie=b?l:pi-l,pe=0;return Q<-ie?pe|=1:Q>ie&&(pe|=2),K<-ie?pe|=4:K>ie&&(pe|=8),pe}return clip(R,U,L,b?[0,-l]:[-pi,l-pi])}function Bv(l){return{stream:QA(l)}}function QA(l){return function(A){var y=new Gh;for(var b in l)y[b]=l[b];return y.stream=A,y}}function Gh(){}Gh.prototype={constructor:Gh,point:function(l,A){this.stream.point(l,A)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};function sh(l,A,y){var b=A[1][0]-A[0][0],T=A[1][1]-A[0][1],L=l.clipExtent&&l.clipExtent();l.scale(150).translate([0,0]),L!=null&&l.clipExtent(null),geoStream(y,l.stream(boundsStream));var R=boundsStream.result(),U=Math.min(b/(R[1][0]-R[0][0]),T/(R[1][1]-R[0][1])),H=+A[0][0]+(b-U*(R[1][0]+R[0][0]))/2,N=+A[0][1]+(T-U*(R[1][1]+R[0][1]))/2;return L!=null&&l.clipExtent(L),l.scale(U*150).translate([H,N])}function Zv(l,A,y){return sh(l,[[0,0],A],y)}var qA=16,ud=p(30*kt);function ld(l,A){return+A?cd(l,A):zv(l)}function zv(l){return transformer({point:function(A,y){A=l(A,y),this.stream.point(A[0],A[1])}})}function cd(l,A){function y(b,T,L,R,U,H,N,Q,K,ie,pe,pt,it,Nt){var dt=N-b,Je=Q-T,ht=dt*dt+Je*Je;if(ht>4*A&&it--){var Ht=R+ie,Bt=U+pe,ir=H+pt,Kt=sqrt(Ht*Ht+Bt*Bt+ir*ir),fr=asin(ir/=Kt),Ct=abs(abs(ir)-1)<epsilon||abs(L-K)<epsilon?(L+K)/2:atan2(Bt,Ht),oi=l(Ct,fr),bn=oi[0],Ei=oi[1],$i=bn-b,on=Ei-T,ii=Je*$i-dt*on;(ii*ii/ht>A||abs((dt*$i+Je*on)/ht-.5)>.3||R*ie+U*pe+H*pt<ud)&&(y(b,T,L,R,U,H,bn,Ei,Ct,Ht/=Kt,Bt/=Kt,ir,it,Nt),Nt.point(bn,Ei),y(bn,Ei,Ct,Ht,Bt,ir,N,Q,K,ie,pe,pt,it,Nt))}}return function(b){var T,L,R,U,H,N,Q,K,ie,pe,pt,it,Nt={point:dt,lineStart:Je,lineEnd:Ht,polygonStart:function(){b.polygonStart(),Nt.lineStart=Bt},polygonEnd:function(){b.polygonEnd(),Nt.lineStart=Je}};function dt(fr,Ct){fr=l(fr,Ct),b.point(fr[0],fr[1])}function Je(){K=NaN,Nt.point=ht,b.lineStart()}function ht(fr,Ct){var oi=cartesian([fr,Ct]),bn=l(fr,Ct);y(K,ie,Q,pe,pt,it,K=bn[0],ie=bn[1],Q=fr,pe=oi[0],pt=oi[1],it=oi[2],qA,b),b.point(K,ie)}function Ht(){Nt.point=dt,b.lineEnd()}function Bt(){Je(),Nt.point=ir,Nt.lineEnd=Kt}function ir(fr,Ct){ht(T=fr,Ct),L=K,R=ie,U=pe,H=pt,N=it,Nt.point=ht}function Kt(){y(K,ie,Q,pe,pt,it,L,R,T,U,H,N,qA,b),Nt.lineEnd=Ht,Ht()}return Nt}}var Uv=QA({point:function(l,A){this.stream.point(l*kt,A*kt)}});function cm(l){return fd(function(){return l})()}function fd(l){var A,y=150,b=480,T=250,L,R,U=0,H=0,N=0,Q=0,K=0,ie,pe,pt=null,it=clipAntimeridian,Nt=null,dt,Je,ht,Ht=identity,Bt=.5,ir=resample(bn,Bt),Kt,fr;function Ct(on){return on=pe(on[0]*radians,on[1]*radians),[on[0]*y+L,R-on[1]*y]}function oi(on){return on=pe.invert((on[0]-L)/y,(R-on[1])/y),on&&[on[0]*degrees,on[1]*degrees]}function bn(on,ii){return on=A(on,ii),[on[0]*y+L,R-on[1]*y]}Ct.stream=function(on){return Kt&&fr===on?Kt:Kt=Uv(it(ie,ir(Ht(fr=on))))},Ct.clipAngle=function(on){return arguments.length?(it=+on?clipCircle(pt=on*radians,6*radians):(pt=null,clipAntimeridian),$i()):pt*degrees},Ct.clipExtent=function(on){return arguments.length?(Ht=on==null?(Nt=dt=Je=ht=null,identity):clipExtent(Nt=+on[0][0],dt=+on[0][1],Je=+on[1][0],ht=+on[1][1]),$i()):Nt==null?null:[[Nt,dt],[Je,ht]]},Ct.scale=function(on){return arguments.length?(y=+on,Ei()):y},Ct.translate=function(on){return arguments.length?(b=+on[0],T=+on[1],Ei()):[b,T]},Ct.center=function(on){return arguments.length?(U=on[0]%360*radians,H=on[1]%360*radians,Ei()):[U*degrees,H*degrees]},Ct.rotate=function(on){return arguments.length?(N=on[0]%360*radians,Q=on[1]%360*radians,K=on.length>2?on[2]%360*radians:0,Ei()):[N*degrees,Q*degrees,K*degrees]},Ct.precision=function(on){return arguments.length?(ir=resample(bn,Bt=on*on),$i()):sqrt(Bt)},Ct.fitExtent=function(on,ii){return fitExtent(Ct,on,ii)},Ct.fitSize=function(on,ii){return fitSize(Ct,on,ii)};function Ei(){pe=compose(ie=rotateRadians(N,Q,K),A);var on=A(U,H);return L=b-on[0]*y,R=T+on[1]*y,$i()}function $i(){return Kt=fr=null,Ct}return function(){return A=l.apply(this,arguments),Ct.invert=A.invert&&oi,Ei()}}function fm(l){var A=0,y=pi/3,b=projectionMutator(l),T=b(A,y);return T.parallels=function(L){return arguments.length?b(A=L[0]*radians,y=L[1]*radians):[A*degrees,y*degrees]},T}function hc(l){var A=cos(l);function y(b,T){return[b*A,sin(T)/A]}return y.invert=function(b,T){return[b/A,asin(T*A)]},y}function Gv(l,A){var y=sin(l),b=(y+sin(A))/2;if(abs(b)<epsilon)return cylindricalEqualAreaRaw(l);var T=1+y*(2*b-y),L=sqrt(T)/b;function R(U,H){var N=sqrt(T-2*b*sin(H))/b;return[N*sin(U*=b),L-N*cos(U)]}return R.invert=function(U,H){var N=L-H;return[atan2(U,abs(N))/b*sign(N),asin((T-(U*U+N*N)*b*b)/(2*b))]},R}function hm(){return conicProjection(Gv).scale(155.424).center([0,33.6442])}function Am(){return conicEqualArea().parallels([29.5,45.5]).scale(1070).translate([480,250]).rotate([96,0]).center([-.6,38.7])}function jv(l){var A=l.length;return{point:function(y,b){for(var T=-1;++T<A;)l[T].point(y,b)},sphere:function(){for(var y=-1;++y<A;)l[y].sphere()},lineStart:function(){for(var y=-1;++y<A;)l[y].lineStart()},lineEnd:function(){for(var y=-1;++y<A;)l[y].lineEnd()},polygonStart:function(){for(var y=-1;++y<A;)l[y].polygonStart()},polygonEnd:function(){for(var y=-1;++y<A;)l[y].polygonEnd()}}}function jh(){var l,A,y=albers(),b,T=conicEqualArea().rotate([154,0]).center([-2,58.5]).parallels([55,65]),L,R=conicEqualArea().rotate([157,0]).center([-3,19.9]).parallels([8,18]),U,H,N={point:function(ie,pe){H=[ie,pe]}};function Q(ie){var pe=ie[0],pt=ie[1];return H=null,b.point(pe,pt),H||(L.point(pe,pt),H)||(U.point(pe,pt),H)}Q.invert=function(ie){var pe=y.scale(),pt=y.translate(),it=(ie[0]-pt[0])/pe,Nt=(ie[1]-pt[1])/pe;return(Nt>=.12&&Nt<.234&&it>=-.425&&it<-.214?T:Nt>=.166&&Nt<.234&&it>=-.214&&it<-.115?R:y).invert(ie)},Q.stream=function(ie){return l&&A===ie?l:l=jv([y.stream(A=ie),T.stream(ie),R.stream(ie)])},Q.precision=function(ie){return arguments.length?(y.precision(ie),T.precision(ie),R.precision(ie),K()):y.precision()},Q.scale=function(ie){return arguments.length?(y.scale(ie),T.scale(ie*.35),R.scale(ie),Q.translate(y.translate())):y.scale()},Q.translate=function(ie){if(!arguments.length)return y.translate();var pe=y.scale(),pt=+ie[0],it=+ie[1];return b=y.translate(ie).clipExtent([[pt-.455*pe,it-.238*pe],[pt+.455*pe,it+.238*pe]]).stream(N),L=T.translate([pt-.307*pe,it+.201*pe]).clipExtent([[pt-.425*pe+epsilon,it+.12*pe+epsilon],[pt-.214*pe-epsilon,it+.234*pe-epsilon]]).stream(N),U=R.translate([pt-.205*pe,it+.212*pe]).clipExtent([[pt-.214*pe+epsilon,it+.166*pe+epsilon],[pt-.115*pe-epsilon,it+.234*pe-epsilon]]).stream(N),K()},Q.fitExtent=function(ie,pe){return fitExtent(Q,ie,pe)},Q.fitSize=function(ie,pe){return fitSize(Q,ie,pe)};function K(){return l=A=null,Q}return Q.scale(1070)}function KA(l){return function(A,y){var b=p(A),T=p(y),L=l(b*T);return[L*T*V(A),L*V(y)]}}function I0(l){return function(A,y){var b=ve(A*A+y*y),T=l(b),L=V(T),R=p(T);return[c(A*L,b*R),gt(b&&y*L/b)]}}var JA=KA(function(l){return ve(2/(1+l))});JA.invert=I0(function(l){return 2*gt(l/2)});function hd(){return projection(JA).scale(124.75).clipAngle(180-.001)}var ep=KA(function(l){return(l=ut(l))&&l/V(l)});ep.invert=I0(function(l){return l});function pm(){return projection(ep).scale(79.4188).clipAngle(180-.001)}function tp(l,A){return[l,M(Ne((Un+A)/2))]}tp.invert=function(l,A){return[l,2*h(E(A))-Un]};function Ad(){return rp(tp).scale(961/tau)}function rp(l){var A=projection(l),y=A.center,b=A.scale,T=A.translate,L=A.clipExtent,R=null,U,H,N;A.scale=function(K){return arguments.length?(b(K),Q()):b()},A.translate=function(K){return arguments.length?(T(K),Q()):T()},A.center=function(K){return arguments.length?(y(K),Q()):y()},A.clipExtent=function(K){return arguments.length?(K==null?R=U=H=N=null:(R=+K[0][0],U=+K[0][1],H=+K[1][0],N=+K[1][1]),Q()):R==null?null:[[R,U],[H,N]]};function Q(){var K=pi*b(),ie=A(rotation(A.rotate()).invert([0,0]));return L(R==null?[[ie[0]-K,ie[1]-K],[ie[0]+K,ie[1]+K]]:l===tp?[[Math.max(ie[0]-K,R),U],[Math.min(ie[0]+K,H),N]]:[[R,Math.max(ie[1]-K,U)],[H,Math.min(ie[1]+K,N)]])}return Q()}function L0(l){return tan((halfPi+l)/2)}function Vh(l,A){var y=cos(l),b=l===A?sin(l):log(y/cos(A))/log(L0(A)/L0(l)),T=y*pow(L0(l),b)/b;if(!b)return mercatorRaw;function L(R,U){T>0?U<-halfPi+epsilon&&(U=-halfPi+epsilon):U>halfPi-epsilon&&(U=halfPi-epsilon);var H=T/pow(L0(U),b);return[H*sin(b*R),T-H*cos(b*R)]}return L.invert=function(R,U){var H=T-U,N=sign(b)*sqrt(R*R+H*H);return[atan2(R,abs(H))/b*sign(H),2*atan(pow(T/N,1/b))-halfPi]},L}function np(){return conicProjection(Vh).scale(109.5).parallels([30,30])}function uh(l,A){return[l,A]}uh.invert=uh;function pd(){return projection(uh).scale(152.63)}function Hh(l,A){var y=cos(l),b=l===A?sin(l):(y-cos(A))/(A-l),T=y/b+l;if(abs(b)<epsilon)return equirectangularRaw;function L(R,U){var H=T-U,N=b*R;return[H*sin(N),T-H*cos(N)]}return L.invert=function(R,U){var H=T-U;return[atan2(R,abs(H))/b*sign(H),T-sign(b)*sqrt(R*R+H*H)]},L}function $h(){return conicProjection(Hh).scale(131.154).center([0,13.9389])}function Wu(l,A){var y=p(A),b=p(l)*y;return[y*V(l)/b,V(A)/b]}Wu.invert=I0(h);function dd(){return projection(Wu).scale(144.049).clipAngle(60)}function P0(l,A,y,b){return l===1&&A===1&&y===0&&b===0?identity:transformer({point:function(T,L){this.stream.point(T*l+y,L*A+b)}})}function qf(){var l=1,A=0,y=0,b=1,T=1,L=identity,R=null,U,H,N,Q=identity,K,ie,pe;function pt(){return K=ie=null,pe}return pe={stream:function(it){return K&&ie===it?K:K=L(Q(ie=it))},clipExtent:function(it){return arguments.length?(Q=it==null?(R=U=H=N=null,identity):clipExtent(R=+it[0][0],U=+it[0][1],H=+it[1][0],N=+it[1][1]),pt()):R==null?null:[[R,U],[H,N]]},scale:function(it){return arguments.length?(L=P0((l=+it)*b,l*T,A,y),pt()):l},translate:function(it){return arguments.length?(L=P0(l*b,l*T,A=+it[0],y=+it[1]),pt()):[A,y]},reflectX:function(it){return arguments.length?(L=P0(l*(b=it?-1:1),l*T,A,y),pt()):b<0},reflectY:function(it){return arguments.length?(L=P0(l*b,l*(T=it?-1:1),A,y),pt()):T<0},fitExtent:function(it,Nt){return fitExtent(pe,it,Nt)},fitSize:function(it,Nt){return fitSize(pe,it,Nt)}}}function vd(l,A){var y=A*A,b=y*y;return[l*(.8707-.131979*y+b*(-.013791+b*(.003971*y-.001529*b))),A*(1.007226+y*(.015085+b*(-.044475+.028874*y-.005916*b)))]}vd.invert=function(l,A){var y=A,b=25,T;do{var L=y*y,R=L*L;y-=T=(y*(1.007226+L*(.015085+R*(-.044475+.028874*L-.005916*R)))-A)/(1.007226+L*(.015085*3+R*(-.044475*7+.028874*9*L-.005916*11*R)))}while(Ft(T)>ft&&--b>0);return[l/(.8707+(L=y*y)*(-.131979+L*(-.013791+L*L*L*(.003971-.001529*L)))),y]};function dm(){return projection(vd).scale(175.295)}function gd(l,A){return[p(A)*V(l),V(A)]}gd.invert=I0(gt);function Vv(){return projection(gd).scale(249.5).clipAngle(90+epsilon)}function ip(l,A){var y=p(A),b=1+p(l)*y;return[y*V(l)/b,V(A)/b]}ip.invert=I0(function(l){return 2*h(l)});function Wh(){return projection(ip).scale(250).clipAngle(142)}function md(l,A){return[M(Ne((Un+A)/2)),-l]}md.invert=function(l,A){return[-A,2*h(E(l))-Un]};function vm(){var l=mercatorProjection(md),A=l.center,y=l.rotate;return l.center=function(b){return arguments.length?A([-b[1],b[0]]):(b=A(),[b[1],-b[0]])},l.rotate=function(b){return arguments.length?y([b[0],b[1],b.length>2?b[2]+90:90]):(b=y(),[b[0],b[1],b[2]-90])},y([0,0,90]).scale(159.155)}function gm(l,A,y){y=y||{};var b=y.units||"kilometers",T=y.steps||8;if(!l)throw new Error("geojson is required");if(typeof y!="object")throw new Error("options must be an object");if(typeof T!="number")throw new Error("steps must be an number");if(A===void 0)throw new Error("radius is required");if(T<=0)throw new Error("steps must be greater than 0");var L=[];switch(l.type){case"GeometryCollection":return geomEach(l,function(R){var U=lh(R,A,b,T);U&&L.push(U)}),featureCollection(L);case"FeatureCollection":return featureEach(l,function(R){var U=lh(R,A,b,T);U&&featureEach(U,function(H){H&&L.push(H)})}),featureCollection(L)}return lh(l,A,b,T)}function lh(l,A,y,b){var T=l.properties||{},L=l.type==="Feature"?l.geometry:l;if(L.type==="GeometryCollection"){var R=[];return geomEach(l,function(it){var Nt=lh(it,A,y,b);Nt&&R.push(Nt)}),featureCollection(R)}var U=Kf(L),H={type:L.type,coordinates:_d(L.coordinates,U)},N=new GeoJSONReader,Q=N.read(H),K=radiansToLength(lengthToRadians(A,y),"meters"),ie=BufferOp.bufferOp(Q,K,b),pe=new GeoJSONWriter;if(ie=pe.write(ie),!yd(ie.coordinates)){var pt={type:ie.type,coordinates:xd(ie.coordinates,U)};return feature(pt,T)}}function yd(l){return Array.isArray(l[0])?yd(l[0]):isNaN(l[0])}function _d(l,A){return typeof l[0]!="object"?A(l):l.map(function(y){return _d(y,A)})}function xd(l,A){return typeof l[0]!="object"?A.invert(l):l.map(function(y){return xd(y,A)})}function Kf(l){var A=center(l).geometry.coordinates,y=[-A[0],-A[1]];return geoAzimuthalEquidistant().rotate(y).scale(earthRadius)}var Ed=null,ap=C(35486);function bd(l,A,y){y===void 0&&(y={});var b=getGeom(l),T=getGeom(A),L=polygonClipping.intersection(b.coordinates,T.coordinates);return L.length===0?null:L.length===1?polygon(L[0],y.properties):multiPolygon(L,y.properties)}function Yh(l,A){if(A=A||{},!isObject(A))throw new Error("options is invalid");var y=A.propertyName;collectionOf(l,"Polygon","dissolve");var b=[];if(A.propertyName){var T={};featureEach(l,function(H){Object.prototype.hasOwnProperty.call(T,H.properties[y])||(T[H.properties[y]]=[]),T[H.properties[y]].push(H)});for(var L=Object.keys(T),R=0;R<L.length;R++){var U=multiPolygon(polygonClipping.union.apply(null,T[L[R]].map(function(H){return H.geometry.coordinates})));U.properties[y]=L[R],b.push(U)}}else return flatten(multiPolygon(polygonClipping.union.apply(null,l.features.map(function(H){return H.geometry.coordinates}))));return flatten(featureCollection(b))}var Sd=null;function Cd(l,A,y){y===void 0&&(y={});var b=JSON.stringify(y.properties||{}),T=l[0],L=l[1],R=l[2],U=l[3],H=(L+U)/2,N=(T+R)/2,Q=A*2/distance([T,H],[R,H],y),K=Q*(R-T),ie=A*2/distance([N,L],[N,U],y),pe=ie*(U-L),pt=K/2,it=pt*2,Nt=Math.sqrt(3)/2*pe,dt=R-T,Je=U-L,ht=3/4*it,Ht=Nt,Bt=(dt-it)/(it-pt/2),ir=Math.floor(Bt),Kt=(ir*ht-pt/2-dt)/2-pt/2+ht/2,fr=Math.floor((Je-Nt)/Nt),Ct=(Je-fr*Nt)/2,oi=fr*Nt-Je>Nt/2;oi&&(Ct-=Nt/4);for(var bn=[],Ei=[],$i=0;$i<6;$i++){var on=2*Math.PI/6*$i;bn.push(Math.cos(on)),Ei.push(Math.sin(on))}for(var ii=[],Dn=0;Dn<=ir;Dn++)for(var Pa=0;Pa<=fr;Pa++){var ba=Dn%2===1;if(!(Pa===0&&ba)&&!(Pa===0&&oi)){var Ji=Dn*ht+T-Kt,mu=Pa*Ht+L+Ct;if(ba&&(mu-=Nt/2),y.triangles===!0)op([Ji,mu],K/2,pe/2,JSON.parse(b),bn,Ei).forEach(function(ou){y.mask?intersect(y.mask,ou)&&ii.push(ou):ii.push(ou)});else{var _s=ch([Ji,mu],K/2,pe/2,JSON.parse(b),bn,Ei);y.mask?intersect(y.mask,_s)&&ii.push(_s):ii.push(_s)}}}return featureCollection(ii)}function ch(l,A,y,b,T,L){for(var R=[],U=0;U<6;U++){var H=l[0]+A*T[U],N=l[1]+y*L[U];R.push([H,N])}return R.push(R[0].slice()),polygon([R],b)}function op(l,A,y,b,T,L){for(var R=[],U=0;U<6;U++){var H=[];H.push(l),H.push([l[0]+A*T[U],l[1]+y*L[U]]),H.push([l[0]+A*T[(U+1)%6],l[1]+y*L[(U+1)%6]]),H.push(l),R.push(polygon([H],b))}return R}var Xh=null;function sp(l,A){var y=up(A),b=null;return l.type==="FeatureCollection"?b=Uc(l):b=Qh(polygonClipping.union(l.geometry.coordinates)),b.geometry.coordinates.forEach(function(T){y.geometry.coordinates.push(T[0])}),y}function Uc(l){var A=l.features.length===2?polygonClipping.union(l.features[0].geometry.coordinates,l.features[1].geometry.coordinates):polygonClipping.union.apply(polygonClipping,l.features.map(function(y){return y.geometry.coordinates}));return Qh(A)}function Qh(l){return multiPolygon(l)}function up(l){var A=[[[180,90],[-180,90],[-180,-90],[180,-90],[180,90]]],y=l&&l.geometry.coordinates||A;return polygon(y)}var mm=null;function Sx(l,A,y,b){b===void 0&&(b={});for(var T=[],L=l[0],R=l[1],U=l[2],H=l[3],N=A/distance([L,R],[U,R],b),Q=N*(U-L),K=y/distance([L,R],[L,H],b),ie=K*(H-R),pe=U-L,pt=H-R,it=Math.floor(pe/Q),Nt=Math.floor(pt/ie),dt=(pe-it*Q)/2,Je=(pt-Nt*ie)/2,ht=L+dt,Ht=0;Ht<it;Ht++){for(var Bt=R+Je,ir=0;ir<Nt;ir++){var Kt=polygon([[[ht,Bt],[ht,Bt+ie],[ht+Q,Bt+ie],[ht+Q,Bt],[ht,Bt]]],b.properties);b.mask?intersect(b.mask,Kt)&&T.push(Kt):T.push(Kt),Bt+=ie}ht+=Q}return featureCollection(T)}var wd=null;function Hv(l,A,y){return y===void 0&&(y={}),rectangleGrid(l,A,A,y)}function Cx(l,A,y){y===void 0&&(y={});for(var b=[],T=A/distance([l[0],l[1]],[l[2],l[1]],y),L=T*(l[2]-l[0]),R=A/distance([l[0],l[1]],[l[0],l[3]],y),U=R*(l[3]-l[1]),H=0,N=l[0];N<=l[2];){for(var Q=0,K=l[1];K<=l[3];){var ie=null,pe=null;H%2===0&&Q%2===0?(ie=polygon([[[N,K],[N,K+U],[N+L,K],[N,K]]],y.properties),pe=polygon([[[N,K+U],[N+L,K+U],[N+L,K],[N,K+U]]],y.properties)):H%2===0&&Q%2===1?(ie=polygon([[[N,K],[N+L,K+U],[N+L,K],[N,K]]],y.properties),pe=polygon([[[N,K],[N,K+U],[N+L,K+U],[N,K]]],y.properties)):Q%2===0&&H%2===1?(ie=polygon([[[N,K],[N,K+U],[N+L,K+U],[N,K]]],y.properties),pe=polygon([[[N,K],[N+L,K+U],[N+L,K],[N,K]]],y.properties)):Q%2===1&&H%2===1&&(ie=polygon([[[N,K],[N,K+U],[N+L,K],[N,K]]],y.properties),pe=polygon([[[N,K+U],[N+L,K+U],[N+L,K],[N,K+U]]],y.properties)),y.mask?(intersect(y.mask,ie)&&b.push(ie),intersect(y.mask,pe)&&b.push(pe)):(b.push(ie),b.push(pe)),K+=U,Q++}H++,N+=L}return featureCollection(b)}var $v=null;function ym(l,A,y){if(y=y||{},typeof y!="object")throw new Error("options is invalid");var b=y.gridType,T=y.property,L=y.weight;if(!l)throw new Error("points is required");if(collectionOf(l,"Point","input must contain Points"),!A)throw new Error("cellSize is required");if(L!==void 0&&typeof L!="number")throw new Error("weight must be a number");T=T||"elevation",b=b||"square",L=L||1;var R=bbox(l),U;switch(b){case"point":case"points":U=pointGrid(R,A,y);break;case"square":case"squares":U=squareGrid(R,A,y);break;case"hex":case"hexes":U=hexGrid(R,A,y);break;case"triangle":case"triangles":U=triangleGrid(R,A,y);break;default:throw new Error("invalid gridType")}var H=[];return featureEach(U,function(N){var Q=0,K=0;featureEach(l,function(pe){var pt=b==="point"?N:centroid(N),it=distance(pt,pe,y),Nt;if(T!==void 0&&(Nt=pe.properties[T]),Nt===void 0&&(Nt=pe.geometry.coordinates[2]),Nt===void 0)throw new Error("zValue is missing");it===0&&(Q=Nt);var dt=1/Math.pow(it,L);K+=dt,Q+=dt*Nt});var ie=clone(N);ie.properties[T]=Q/K,H.push(ie)}),featureCollection(H)}var _m=null},35486:function(se,$,C){"use strict";var P=C(94486),D=C(8014),G=C(8822);function Z(F,z,q){q===void 0&&(q={});var ee=(0,D.wA)(F),fe=(0,D.wA)(z),be=P.union(ee.coordinates,fe.coordinates);return be.length===0?null:be.length===1?(0,G.yu)(be[0],q.properties):(0,G.tw)(be,q.properties)}$.Z=Z}}]);
