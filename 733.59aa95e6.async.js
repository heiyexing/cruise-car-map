(self.webpackChunkcruise_car_map=self.webpackChunkcruise_car_map||[]).push([[733],{81618:function(le){"use strict";(function($,C){le.exports=C()})(this,function(){function $(ee){var fe=[];return ee.AMapUI&&fe.push(C(ee.AMapUI)),ee.Loca&&fe.push(L(ee.Loca)),Promise.all(fe)}function C(ee){return new Promise(function(fe,Se){var Re=[];if(ee.plugins)for(var De=0;De<ee.plugins.length;De+=1)G.AMapUI.plugins.indexOf(ee.plugins[De])==-1&&Re.push(ee.plugins[De]);if(Z.AMapUI===k.failed)Se("\u524D\u6B21\u8BF7\u6C42 AMapUI \u5931\u8D25");else if(Z.AMapUI===k.notload){Z.AMapUI=k.loading,G.AMapUI.version=ee.version||G.AMapUI.version,De=G.AMapUI.version;var Ve=document.body||document.head,nt=document.createElement("script");nt.type="text/javascript",nt.src="https://webapi.amap.com/ui/"+De+"/main.js",nt.onerror=function(Ee){Z.AMapUI=k.failed,Se("\u8BF7\u6C42 AMapUI \u5931\u8D25")},nt.onload=function(){if(Z.AMapUI=k.loaded,Re.length)window.AMapUI.loadUI(Re,function(){for(var Ee=0,Ie=Re.length;Ee<Ie;Ee++){var me=Re[Ee].split("/").slice(-1)[0];window.AMapUI[me]=arguments[Ee]}for(fe();F.AMapUI.length;)F.AMapUI.splice(0,1)[0]()});else for(fe();F.AMapUI.length;)F.AMapUI.splice(0,1)[0]()},Ve.appendChild(nt)}else Z.AMapUI===k.loaded?ee.version&&ee.version!==G.AMapUI.version?Se("\u4E0D\u5141\u8BB8\u591A\u4E2A\u7248\u672C AMapUI \u6DF7\u7528"):Re.length?window.AMapUI.loadUI(Re,function(){for(var Ee=0,Ie=Re.length;Ee<Ie;Ee++){var me=Re[Ee].split("/").slice(-1)[0];window.AMapUI[me]=arguments[Ee]}fe()}):fe():ee.version&&ee.version!==G.AMapUI.version?Se("\u4E0D\u5141\u8BB8\u591A\u4E2A\u7248\u672C AMapUI \u6DF7\u7528"):F.AMapUI.push(function(Ee){Ee?Se(Ee):Re.length?window.AMapUI.loadUI(Re,function(){for(var Ie=0,me=Re.length;Ie<me;Ie++){var we=Re[Ie].split("/").slice(-1)[0];window.AMapUI[we]=arguments[Ie]}fe()}):fe()})})}function L(ee){return new Promise(function(fe,Se){if(Z.Loca===k.failed)Se("\u524D\u6B21\u8BF7\u6C42 Loca \u5931\u8D25");else if(Z.Loca===k.notload){Z.Loca=k.loading,G.Loca.version=ee.version||G.Loca.version;var Re=G.Loca.version,De=G.AMap.version.startsWith("2"),Ve=Re.startsWith("2");if(De&&!Ve||!De&&Ve)Se("JSAPI \u4E0E Loca \u7248\u672C\u4E0D\u5BF9\u5E94\uFF01\uFF01");else{De=G.key,Ve=document.body||document.head;var nt=document.createElement("script");nt.type="text/javascript",nt.src="https://webapi.amap.com/loca?v="+Re+"&key="+De,nt.onerror=function(Ee){Z.Loca=k.failed,Se("\u8BF7\u6C42 AMapUI \u5931\u8D25")},nt.onload=function(){for(Z.Loca=k.loaded,fe();F.Loca.length;)F.Loca.splice(0,1)[0]()},Ve.appendChild(nt)}}else Z.Loca===k.loaded?ee.version&&ee.version!==G.Loca.version?Se("\u4E0D\u5141\u8BB8\u591A\u4E2A\u7248\u672C Loca \u6DF7\u7528"):fe():ee.version&&ee.version!==G.Loca.version?Se("\u4E0D\u5141\u8BB8\u591A\u4E2A\u7248\u672C Loca \u6DF7\u7528"):F.Loca.push(function(Ee){Ee?Se(Ee):Se()})})}if(!window)throw Error("AMap JSAPI can only be used in Browser.");var k;(function(ee){ee.notload="notload",ee.loading="loading",ee.loaded="loaded",ee.failed="failed"})(k||(k={}));var G={key:"",AMap:{version:"1.4.15",plugins:[]},AMapUI:{version:"1.1",plugins:[]},Loca:{version:"1.3.2"}},Z={AMap:k.notload,AMapUI:k.notload,Loca:k.notload},F={AMap:[],AMapUI:[],Loca:[]},z=[],q=function(ee){typeof ee=="function"&&(Z.AMap===k.loaded?ee(window.AMap):z.push(ee))};return{load:function(ee){return new Promise(function(fe,Se){if(Z.AMap==k.failed)Se("");else if(Z.AMap==k.notload){var Re=ee.key,De=ee.version,Ve=ee.plugins;Re?(window.AMap&&location.host!=="lbs.amap.com"&&Se("\u7981\u6B62\u591A\u79CDAPI\u52A0\u8F7D\u65B9\u5F0F\u6DF7\u7528"),G.key=Re,G.AMap.version=De||G.AMap.version,G.AMap.plugins=Ve||G.AMap.plugins,Z.AMap=k.loading,De=document.body||document.head,window.___onAPILoaded=function(Ee){if(delete window.___onAPILoaded,Ee)Z.AMap=k.failed,Se(Ee);else for(Z.AMap=k.loaded,$(ee).then(function(){fe(window.AMap)}).catch(Se);z.length;)z.splice(0,1)[0]()},Ve=document.createElement("script"),Ve.type="text/javascript",Ve.src="https://webapi.amap.com/maps?callback=___onAPILoaded&v="+G.AMap.version+"&key="+Re+"&plugin="+G.AMap.plugins.join(","),Ve.onerror=function(Ee){Z.AMap=k.failed,Se(Ee)},De.appendChild(Ve)):Se("\u8BF7\u586B\u5199key")}else if(Z.AMap==k.loaded)if(ee.key&&ee.key!==G.key)Se("\u591A\u4E2A\u4E0D\u4E00\u81F4\u7684 key");else if(ee.version&&ee.version!==G.AMap.version)Se("\u4E0D\u5141\u8BB8\u591A\u4E2A\u7248\u672C JSAPI \u6DF7\u7528");else{if(Re=[],ee.plugins)for(De=0;De<ee.plugins.length;De+=1)G.AMap.plugins.indexOf(ee.plugins[De])==-1&&Re.push(ee.plugins[De]);Re.length?window.AMap.plugin(Re,function(){$(ee).then(function(){fe(window.AMap)}).catch(Se)}):$(ee).then(function(){fe(window.AMap)}).catch(Se)}else if(ee.key&&ee.key!==G.key)Se("\u591A\u4E2A\u4E0D\u4E00\u81F4\u7684 key");else if(ee.version&&ee.version!==G.AMap.version)Se("\u4E0D\u5141\u8BB8\u591A\u4E2A\u7248\u672C JSAPI \u6DF7\u7528");else{var nt=[];if(ee.plugins)for(De=0;De<ee.plugins.length;De+=1)G.AMap.plugins.indexOf(ee.plugins[De])==-1&&nt.push(ee.plugins[De]);q(function(){nt.length?window.AMap.plugin(nt,function(){$(ee).then(function(){fe(window.AMap)}).catch(Se)}):$(ee).then(function(){fe(window.AMap)}).catch(Se)})}})},reset:function(){delete window.AMap,delete window.AMapUI,delete window.Loca,G={key:"",AMap:{version:"1.4.15",plugins:[]},AMapUI:{version:"1.1",plugins:[]},Loca:{version:"1.3.2"}},Z={AMap:k.notload,AMapUI:k.notload,Loca:k.notload},F={AMap:[],AMapUI:[],Loca:[]}}}})},4157:function(){window._iconfont_svg_string_3580659='<svg><symbol id="l7-icon-area1" viewBox="0 0 1024 1024"><path d="M796.444444 56.888889a113.777778 113.777778 0 0 1 43.064889 219.136l38.798223 466.261333a113.777778 113.777778 0 1 1-133.518223 145.237334H279.210667a113.777778 113.777778 0 1 1-60.302223-137.272889L697.856 227.555556A113.777778 113.777778 0 0 1 796.444444 56.888889z m56.888889 750.933333a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222z m-682.666666 0a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222z m577.592889-534.072889L269.198222 796.444444c4.152889 7.168 7.509333 14.791111 10.012445 22.812445h465.578666a114.119111 114.119111 0 0 1 65.479111-71.224889l-38.798222-466.261333a112.924444 112.924444 0 0 1-23.210666-7.964445zM796.444444 125.155556a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222z"  ></path></symbol><symbol id="l7-icon-area" viewBox="0 0 1024 1024"><path d="M796.444444 56.888889a113.777778 113.777778 0 0 1 43.008 219.136l38.855112 466.261333a113.777778 113.777778 0 0 1-16.497778 224.540445L853.333333 967.111111a113.777778 113.777778 0 0 1-108.544-79.644444H279.210667a113.834667 113.834667 0 0 1-100.067556 79.36L170.666667 967.111111a113.777778 113.777778 0 0 1-17.066667-226.304l30.492444-351.175111a113.777778 113.777778 0 0 1 34.986667-218.680889L227.555556 170.666667a113.777778 113.777778 0 0 1 99.896888 59.221333l355.84-71.395556a113.777778 113.777778 0 0 1 104.675556-101.262222L796.444444 56.888889z m56.888889 750.933333a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222z m-682.666666 0a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222z m526.051555-582.314666L340.650667 296.903111a113.891556 113.891556 0 0 1-88.462223 98.645333l-30.947555 355.84c27.477333 13.653333 48.64 38.115556 58.026667 67.754667h465.521777a114.119111 114.119111 0 0 1 65.536-71.168l-38.855111-466.261333a113.948444 113.948444 0 0 1-74.752-56.206222zM227.555556 238.933333a45.511111 45.511111 0 1 0 0 91.022223 45.511111 45.511111 0 0 0 0-91.022223z m568.888888-113.777777a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222z"  ></path></symbol><symbol id="l7-icon-delete" viewBox="0 0 1024 1024"><path d="M705.422222 85.333333a34.133333 34.133333 0 0 1 34.133334 34.133334V227.555556h136.533333a34.133333 34.133333 0 0 1 0 68.266666h-25.543111l-24.348445 610.076445a34.133333 34.133333 0 0 1-34.133333 32.768H231.936a34.133333 34.133333 0 0 1-34.076444-32.768L173.340444 295.822222H147.911111a34.133333 34.133333 0 1 1 0-68.266666H284.444444V119.466667a34.133333 34.133333 0 0 1 34.133334-34.133334h386.844444zM241.720889 295.822222l22.983111 574.577778h494.535111l23.04-574.577778H241.720889zM671.288889 153.6H352.711111V227.555556h318.577778V153.6z"  ></path></symbol><symbol id="l7-icon-color" viewBox="0 0 1024 1024"><path d="M512 56.888889c9.841778 0 19.626667 0.341333 29.354667 0.910222 69.176889 4.437333 119.068444 62.577778 124.302222 131.072l0.455111 9.386667c0.739556 44.600889 15.303111 84.935111 44.999111 114.631111 27.022222 27.022222 62.805333 41.528889 102.570667 44.430222l12.060444 0.568889c72.476444 1.194667 135.793778 52.451556 140.458667 124.757333 1.137778 18.261333 1.251556 36.807111 0.170667 55.637334-13.198222 233.585778-211.399111 424.220444-445.326223 428.714666L512 967.111111a455.111111 455.111111 0 0 1-455.054222-464.156444c4.551111-233.927111 195.185778-432.128 428.771555-445.326223C494.535111 57.116444 503.296 56.888889 512 56.888889z m0 68.266667a385.706667 385.706667 0 0 0-22.414222 0.625777C291.726222 136.988444 129.080889 305.948444 125.155556 504.263111c-4.152889 212.366222 163.100444 387.185778 372.508444 394.353778l13.425778 0.227555 8.533333-0.113777c198.371556-3.811556 367.331556-166.456889 378.538667-364.373334a396.174222 396.174222 0 0 0-0.170667-47.331555c-1.991111-31.232-29.127111-56.604444-67.128889-60.472889l-8.248889-0.455111-14.051555-0.682667c-56.547556-4.209778-107.406222-25.884444-145.806222-64.284444-38.855111-38.798222-60.416-90.225778-64.284445-145.749334l-0.910222-21.333333c-2.901333-38.001778-28.785778-66.048-60.302222-68.096A433.891556 433.891556 0 0 0 512 125.155556zM438.044444 682.666667a68.266667 68.266667 0 1 1 0 136.533333 68.266667 68.266667 0 0 1 0-136.533333z m-170.666666-227.555556a68.266667 68.266667 0 1 1 0 136.533333 68.266667 68.266667 0 0 1 0-136.533333z m142.222222-227.555555a68.266667 68.266667 0 1 1 0 136.533333 68.266667 68.266667 0 0 1 0-136.533333z"  ></path></symbol><symbol id="l7-icon-base-map" viewBox="0 0 1024 1024"><path d="M923.761778 115.029333A34.133333 34.133333 0 0 1 967.111111 147.911111v624.128a34.133333 34.133333 0 0 1-22.186667 32.028445l-278.755555 103.992888a34.133333 34.133333 0 0 1-23.665778 0.056889L381.724444 812.714667a34.133333 34.133333 0 0 0-23.665777 0.113777L102.968889 908.060444a34.133333 34.133333 0 0 1-45.738667-26.965333L56.888889 876.088889V251.960889a34.133333 34.133333 0 0 1 22.186667-32.028445l278.755555-103.992888a34.133333 34.133333 0 0 1 20.992-0.967112l266.183111 72.988445a34.133333 34.133333 0 0 0 18.204445 0zM403.911111 192.625778v555.576889l216.177778 79.075555V251.960889l-216.177778-59.335111z m-68.266667 4.380444L125.155556 275.569778v551.310222l210.432-78.506667V197.006222zM898.844444 192.853333l-210.545777 58.936889v575.089778l210.545777-78.563556V192.853333z"  ></path></symbol><symbol id="l7-icon-dot" viewBox="0 0 1024 1024"><path d="M341.333333 739.555556a113.777778 113.777778 0 0 1 8.533334 227.271111L341.333333 967.111111a113.777778 113.777778 0 0 1-8.533333-227.271111L341.333333 739.555556z m0 68.266666a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222zM910.222222 341.333333a113.777778 113.777778 0 0 1 8.533334 227.271111L910.222222 568.888889a113.777778 113.777778 0 0 1-8.533333-227.271111L910.222222 341.333333z m0 68.266667a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222zM227.555556 56.888889a113.777778 113.777778 0 0 1 8.533333 227.271111L227.555556 284.444444a113.777778 113.777778 0 0 1-8.533334-227.271111L227.555556 56.888889z m0 68.266667a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222z"  ></path></symbol><symbol id="l7-icon-display" viewBox="0 0 1024 1024"><path d="M512 170.666667c284.444444 0 455.111111 227.555556 455.111111 341.333333s-170.666667 341.333333-455.111111 341.333333-455.111111-227.555556-455.111111-341.333333 170.666667-341.333333 455.111111-341.333333z m0 68.266666C303.729778 238.933333 125.155556 401.237333 125.155556 512c0 110.762667 178.574222 273.066667 386.844444 273.066667s386.844444-162.304 386.844444-273.066667c0-110.762667-178.574222-273.066667-386.844444-273.066667zM512 341.333333a170.666667 170.666667 0 1 1 0 341.333334 170.666667 170.666667 0 0 1 0-341.333334z m0 68.266667a102.4 102.4 0 1 0 0 204.8 102.4 102.4 0 0 0 0-204.8z"  ></path></symbol><symbol id="l7-icon-enlarge" viewBox="0 0 1024 1024"><path d="M546.133333 147.911111l-0.056889 329.955556H876.088889a34.133333 34.133333 0 0 1 0 68.266666H546.076444v329.955556a34.133333 34.133333 0 0 1-68.266666 0V546.133333H147.911111a34.133333 34.133333 0 1 1 0-68.266666h329.898667V147.911111a34.133333 34.133333 0 0 1 68.266666 0z"  ></path></symbol><symbol id="l7-icon-export-picture" viewBox="0 0 1024 1024"><path d="M883.873684 161.684211a32.336842 32.336842 0 0 1 32.336842 32.336842v582.063158a32.336842 32.336842 0 0 1-32.336842 32.336842H86.231579a32.336842 32.336842 0 0 1-32.336842-32.336842V194.021053a32.336842 32.336842 0 0 1 32.336842-32.336842h797.642105z m-32.336842 64.673684H118.568421v517.389473h170.792421a32.175158 32.175158 0 0 1 0.431158-0.646736l3.772632-4.473264 330.320842-330.374736a32.336842 32.336842 0 0 1 38.588631-5.389474l4.473263 3.018105 184.589474 147.725474V226.357895z m-202.428631 248.131368L379.850105 743.747368H851.536842v-107.304421l-202.428631-161.953684zM323.368421 323.368421a107.789474 107.789474 0 1 1 0 215.578947 107.789474 107.789474 0 0 1 0-215.578947z m0 64.673684a43.115789 43.115789 0 1 0 0 86.231579 43.115789 43.115789 0 0 0 0-86.231579z"  ></path></symbol><symbol id="l7-icon-exit-fullscreen" viewBox="0 0 1024 1024"><path d="M841.955556 591.644444a34.133333 34.133333 0 0 1 5.518222 67.811556l-5.518222 0.455111h-133.745778l192 192.056889a34.133333 34.133333 0 0 1-38.343111 55.182222l-5.176889-2.958222-4.721778-3.982222L659.911111 708.266667V841.955556a34.133333 34.133333 0 0 1-28.615111 33.678222L625.777778 876.088889a34.133333 34.133333 0 0 1-33.678222-28.615111L591.644444 841.955556V625.777778a34.133333 34.133333 0 0 1 28.615112-33.678222L625.777778 591.644444h216.177778z m-443.733334 0a34.133333 34.133333 0 0 1 33.678222 28.615112L432.355556 625.777778v216.177778a34.133333 34.133333 0 0 1-67.811556 5.518222L364.088889 841.955556v-133.745778l-192.056889 192a34.133333 34.133333 0 0 1-52.224-43.52l3.982222-4.721778L315.847111 659.911111H182.044444a34.133333 34.133333 0 0 1-33.678222-28.615111L147.911111 625.777778a34.133333 34.133333 0 0 1 28.615111-33.678222L182.044444 591.644444H398.222222zM167.310222 119.808l4.721778 3.982222L364.088889 315.847111V182.044444a34.133333 34.133333 0 0 1 28.615111-33.678222L398.222222 147.911111a34.133333 34.133333 0 0 1 33.678222 28.615111L432.355556 182.044444V398.222222a34.133333 34.133333 0 0 1-28.615112 33.678222L398.222222 432.355556H182.044444a34.133333 34.133333 0 0 1-5.518222-67.811556L182.044444 364.088889h133.802667L123.790222 172.032a34.133333 34.133333 0 0 1 43.52-52.224z m732.899556 3.982222a34.133333 34.133333 0 0 1 3.982222 43.52l-3.982222 4.721778L708.266667 364.088889H841.955556a34.133333 34.133333 0 0 1 33.678222 28.615111L876.088889 398.222222a34.133333 34.133333 0 0 1-28.615111 33.678222L841.955556 432.355556H625.777778a34.133333 34.133333 0 0 1-33.678222-28.615112L591.644444 398.222222V182.044444a34.133333 34.133333 0 0 1 67.811556-5.518222l0.455111 5.518222v133.802667l192.056889-192.056889a34.133333 34.133333 0 0 1 48.241778 0z"  ></path></symbol><symbol id="l7-icon-line" viewBox="0 0 1024 1024"><path d="M853.333333 56.888889a113.777778 113.777778 0 0 1 8.533334 227.271111L853.333333 284.444444c-19.000889 0-36.864-4.664889-52.622222-12.856888l-529.123555 529.066666a113.777778 113.777778 0 0 1-92.387556 166.115556L170.666667 967.111111a113.777778 113.777778 0 0 1-8.533334-227.271111L170.666667 739.555556c19.000889 0 36.864 4.664889 52.622222 12.856888l529.123555-529.066666a113.777778 113.777778 0 0 1 92.387556-166.115556L853.333333 56.888889zM170.666667 807.822222a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222z m682.666666-682.666666a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222z"  ></path></symbol><symbol id="l7-icon-layer" viewBox="0 0 1024 1024"><path d="M767.089778 625.777778l180.167111 82.773333a34.133333 34.133333 0 0 1 4.892444 59.278222l-4.892444 2.730667-420.977778 193.422222a34.133333 34.133333 0 0 1-22.983111 1.991111l-5.575111-1.991111-420.977778-193.422222a34.133333 34.133333 0 0 1-4.892444-59.278222l4.892444-2.730667L256.853333 625.777778l81.749334 37.546666L172.771556 739.555556 512 895.374222 851.171556 739.555556l-165.831112-76.231112 81.749334-37.546666z m0-227.555556l180.167111 82.773334a34.133333 34.133333 0 0 1 4.892444 59.278222l-4.892444 2.730666-420.977778 193.422223a34.133333 34.133333 0 0 1-22.983111 1.991111l-5.575111-1.991111-420.977778-193.422223a34.133333 34.133333 0 0 1-4.892444-59.278222l4.892444-2.730666L256.853333 398.222222l81.749334 37.546667-165.831111 76.174222L512 667.818667l339.171556-155.875556-165.831112-76.174222L767.089778 398.222222zM497.720889 60.017778a34.133333 34.133333 0 0 1 28.558222 0l420.977778 193.422222a34.133333 34.133333 0 0 1 0 62.008889l-420.977778 193.422222a34.133333 34.133333 0 0 1-28.558222 0l-420.977778-193.422222a34.133333 34.133333 0 0 1 0-62.008889zM512 128.568889L172.771556 284.387556 512 440.263111l339.171556-155.875555L512 128.568889z"  ></path></symbol><symbol id="l7-icon-narrow" viewBox="0 0 1024 1024"><path d="M910.222222 512a34.133333 34.133333 0 0 1-34.133333 34.133333H147.911111a34.133333 34.133333 0 1 1 0-68.266666h728.177778a34.133333 34.133333 0 0 1 34.133333 34.133333z"  ></path></symbol><symbol id="l7-icon-fullscreen" viewBox="0 0 1024 1024"><path d="M645.176889 597.674667l4.721778 3.982222L841.955556 793.6l0.056888-133.688889a34.133333 34.133333 0 0 1 28.615112-33.678222L876.088889 625.777778a34.133333 34.133333 0 0 1 33.678222 28.615111L910.222222 659.911111v216.177778a34.133333 34.133333 0 0 1-28.615111 33.678222L876.088889 910.222222h-216.177778a34.133333 34.133333 0 0 1-5.518222-67.811555l5.518222-0.455111h133.745778l-192-192.056889a34.133333 34.133333 0 0 1 43.52-52.224z m-222.833778 3.982222a34.133333 34.133333 0 0 1 3.982222 43.52l-3.982222 4.721778L230.286222 841.955556H364.088889a34.133333 34.133333 0 0 1 33.678222 28.615111L398.222222 876.088889a34.133333 34.133333 0 0 1-28.615111 33.678222L364.088889 910.222222H147.911111a34.133333 34.133333 0 0 1-33.678222-28.615111L113.777778 876.088889v-216.177778a34.133333 34.133333 0 0 1 67.811555-5.518222l0.455111 5.518222-0.056888 133.745778 192.113777-192a34.133333 34.133333 0 0 1 48.241778 0zM364.088889 113.777778a34.133333 34.133333 0 0 1 5.518222 67.811555L364.088889 182.044444H230.343111l192 192.056889a34.133333 34.133333 0 0 1-43.52 52.224l-4.721778-3.982222-192.113777-192.056889L182.044444 364.088889a34.133333 34.133333 0 0 1-28.615111 33.678222L147.911111 398.222222a34.133333 34.133333 0 0 1-33.678222-28.615111L113.777778 364.088889V147.911111a34.133333 34.133333 0 0 1 28.615111-33.678222L147.911111 113.777778h216.177778z m512 0a34.133333 34.133333 0 0 1 33.678222 28.615111L910.222222 147.911111v216.177778a34.133333 34.133333 0 0 1-67.811555 5.518222L841.955556 364.088889l-0.056889-133.745778-192 192a34.133333 34.133333 0 0 1-52.224-43.52l3.982222-4.721778L793.6 182.044444H659.911111a34.133333 34.133333 0 0 1-33.678222-28.615111L625.777778 147.911111a34.133333 34.133333 0 0 1 28.615111-33.678222L659.911111 113.777778h216.177778z"  ></path></symbol><symbol id="l7-icon-hide" viewBox="0 0 1024 1024"><path d="M875.52 87.836444a34.133333 34.133333 0 0 1 7.281778 43.121778l-3.527111 5.006222-682.666667 796.444445a34.133333 34.133333 0 0 1-55.409778-39.367111l3.527111-5.006222 97.166223-113.379556C123.164444 697.969778 56.888889 582.940444 56.888889 512c0-113.777778 170.666667-341.333333 455.111111-341.333333a496.64 496.64 0 0 1 208.952889 45.112889l106.439111-124.188445a34.133333 34.133333 0 0 1 48.128-3.754667z m-38.684444 202.524445C921.031111 362.951111 967.111111 452.835556 967.111111 512c0 113.777778-170.666667 341.333333-455.111111 341.333333-50.631111 0-97.678222-7.224889-140.8-19.740444l50.232889-58.595556A417.393778 417.393778 0 0 0 512 785.066667c208.270222 0 386.844444-162.304 386.844444-273.066667 0-52.849778-40.675556-117.418667-105.813333-170.496l43.804445-51.2zM512 238.933333C303.729778 238.933333 125.155556 401.237333 125.155556 512c0 66.787556 64.853333 152.291556 162.133333 209.692444L377.173333 616.675556a170.666667 170.666667 0 0 1 217.713778-253.895112l78.620445-91.704888A432.924444 432.924444 0 0 0 512 238.933333z m166.684444 236.088889a170.666667 170.666667 0 0 1-177.664 207.303111l177.607112-207.303111zM512 409.6a102.4 102.4 0 0 0-88.746667 153.486222L548.864 416.426667A102.172444 102.172444 0 0 0 512 409.6z"  ></path></symbol><symbol id="l7-icon-rectangle" viewBox="0 0 1024 1024"><path d="M170.666667 56.888889a113.777778 113.777778 0 0 1 108.544 79.644444H853.333333a34.133333 34.133333 0 0 1 33.678223 28.615111L887.466667 170.666667v574.122666a113.777778 113.777778 0 1 1-142.677334 142.734223L170.666667 887.466667a34.133333 34.133333 0 0 1-33.678223-28.615111L136.533333 853.333333V279.210667A113.777778 113.777778 0 0 1 170.666667 56.888889z m682.666666 750.933333a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222z m-34.133333-603.022222H279.210667a114.062222 114.062222 0 0 1-74.353778 74.410667L204.8 819.2h539.989333a114.062222 114.062222 0 0 1 74.410667-74.410667V204.8zM170.666667 125.155556a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222z"  ></path></symbol><symbol id="l7-icon-ranging" viewBox="0 0 1024 1024"><path d="M723.171556 50.403556l250.424888 250.424888a31.061333 31.061333 0 0 1 0 43.918223L344.746667 973.596444a31.061333 31.061333 0 0 1-43.918223 0L50.403556 723.171556a31.061333 31.061333 0 0 1 0-43.918223L679.253333 50.403556a31.061333 31.061333 0 0 1 43.918223 0z m-21.959112 74.524444l-39.765333 39.822222 98.986667 98.872889a34.133333 34.133333 0 0 1-44.088889 51.882667l-4.209778-3.640889-98.929778-98.929778-63.886222 63.886222 62.179556 62.122667a34.133333 34.133333 0 0 1-44.088889 51.882667L563.2 387.242667 501.077333 325.063111 437.191111 388.949333l98.986667 98.929778a34.133333 34.133333 0 0 1-44.088889 51.882667l-4.209778-3.640889-98.929778-98.929778-63.886222 63.886222L387.242667 563.2a34.133333 34.133333 0 0 1-44.088889 51.882667l-4.209778-3.584-62.122667-62.179556-63.886222 63.886222 98.986667 98.929778a34.133333 34.133333 0 0 1-44.088889 51.882667l-4.209778-3.640889-98.929778-98.929778-39.765333 39.822222 197.802667 197.745778 576.284444-576.284444-197.802667-197.745778z"  ></path></symbol><symbol id="l7-icon-reposition" viewBox="0 0 1024 1024"><path d="M512 56.888889a34.133333 34.133333 0 0 1 34.133333 34.133333v24.177778A398.336 398.336 0 0 1 908.856889 477.866667h24.177778a34.133333 34.133333 0 0 1 0 68.266666h-24.177778A398.336 398.336 0 0 1 546.133333 908.856889L546.133333 932.977778a34.133333 34.133333 0 0 1-68.266666 0v-24.177778A398.336 398.336 0 0 1 115.2 546.133333L91.022222 546.133333a34.133333 34.133333 0 1 1 0-68.266666h24.177778A398.336 398.336 0 0 1 477.866667 115.2V91.022222A34.133333 34.133333 0 0 1 512 56.888889z m34.190222 126.862222L546.133333 193.422222a34.133333 34.133333 0 1 1-68.266666 0v-9.671111A330.069333 330.069333 0 0 0 183.751111 477.866667h9.671111a34.133333 34.133333 0 1 1 0 68.266666l-9.671111 0.056889A330.069333 330.069333 0 0 0 477.866667 840.248889V830.577778a34.133333 34.133333 0 0 1 68.266666 0l0.056889 9.671111A330.069333 330.069333 0 0 0 840.248889 546.133333L830.577778 546.133333a34.133333 34.133333 0 0 1 0-68.266666h9.671111A330.069333 330.069333 0 0 0 546.133333 183.751111zM512 341.333333a170.666667 170.666667 0 1 1 0 341.333334 170.666667 170.666667 0 0 1 0-341.333334z m0 68.266667a102.4 102.4 0 1 0 0 204.8 102.4 102.4 0 0 0 0-204.8z"  ></path></symbol><symbol id="l7-icon-round" viewBox="0 0 1024 1024"><path d="M512 56.888889a455.111111 455.111111 0 0 1 391.395556 687.502222 113.777778 113.777778 0 0 1-159.061334 158.890667A455.111111 455.111111 0 0 1 120.604444 279.608889 113.777778 113.777778 0 0 1 279.608889 120.604444 452.835556 452.835556 0 0 1 512 56.888889z m0 68.266667a384.910222 384.910222 0 0 0-191.715556 50.744888A113.777778 113.777778 0 0 1 175.957333 320.284444a386.844444 386.844444 0 0 0 527.815111 527.758223 113.777778 113.777778 0 0 1 144.270223-144.440889A386.844444 386.844444 0 0 0 512 125.155556z m299.406222 640.739555a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222zM212.593778 167.082667a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222z"  ></path></symbol><symbol id="l7-icon-guanbi" viewBox="0 0 1024 1024"><path d="M576 512l277.333333 277.333333-64 64-277.333333-277.333333L234.666667 853.333333 170.666667 789.333333l277.333333-277.333333L170.666667 234.666667 234.666667 170.666667l277.333333 277.333333L789.333333 170.666667 853.333333 234.666667 576 512z"  ></path></symbol></svg>',function(le){try{let fe=function(){F||(F=!0,G())},Se=function(){try{Z.documentElement.doScroll("left")}catch(Re){return void setTimeout(Se,50)}fe()};var q=fe,ee=Se,C=(C=document.getElementsByTagName("script"))[C.length-1],$=C.getAttribute("data-injectcss"),C=C.getAttribute("data-disable-injectsvg");if(!C){var L,k,G,Z,F,z=function(De,Ve){Ve.parentNode.insertBefore(De,Ve)};if($&&!le.__iconfont__svg__cssinject__){le.__iconfont__svg__cssinject__=!0;try{document.write("<style>.svgfont {display: inline-block;width: 1em;height: 1em;fill: currentColor;vertical-align: -0.1em;font-size:16px;}</style>")}catch(Re){console&&console.log(Re)}}L=function(){var De,Ve=document.createElement("div");Ve.innerHTML=le._iconfont_svg_string_3580659,(Ve=Ve.getElementsByTagName("svg")[0])&&(Ve.setAttribute("aria-hidden","true"),Ve.style.position="absolute",Ve.style.width=0,Ve.style.height=0,Ve.style.overflow="hidden",Ve=Ve,(De=document.body).firstChild?z(Ve,De.firstChild):De.appendChild(Ve))},document.addEventListener?~["complete","loaded","interactive"].indexOf(document.readyState)?setTimeout(L,0):(k=function(){document.removeEventListener("DOMContentLoaded",k,!1),L()},document.addEventListener("DOMContentLoaded",k,!1)):document.attachEvent&&(G=L,Z=le.document,F=!1,Se(),Z.onreadystatechange=function(){Z.readyState=="complete"&&(Z.onreadystatechange=null,fe())})}}catch(fe){}}(window)},46367:function(le,$,C){"use strict";C.d($,{lg:function(){return F6},Ie:function(){return mg},Jx:function(){return Py},u7:function(){return pS},ns:function(){return Zd},dW:function(){return _g},xs:function(){return aP}});var L={};C.r(L),C.d(L,{add:function(){return IA},adjoint:function(){return Qg},clone:function(){return Xa},copy:function(){return Iu},create:function(){return Qn},determinant:function(){return bA},equals:function(){return gu},exactEquals:function(){return Hu},frob:function(){return MA},fromQuat:function(){return hv},fromQuat2:function(){return Np},fromRotation:function(){return Lf},fromRotationTranslation:function(){return CA},fromRotationTranslationScale:function(){return fv},fromRotationTranslationScaleOrigin:function(){return Ml},fromScaling:function(){return J0},fromTranslation:function(){return Qf},fromValues:function(){return Q0},fromXRotation:function(){return hf},fromYRotation:function(){return Af},fromZRotation:function(){return SA},frustum:function(){return Bp},getRotation:function(){return cv},getScaling:function(){return wA},getTranslation:function(){return Fp},identity:function(){return lv},invert:function(){return kp},lookAt:function(){return th},mul:function(){return hc},multiply:function(){return ja},multiplyScalar:function(){return Zp},multiplyScalarAndAdd:function(){return Vu},ortho:function(){return Lh},orthoNO:function(){return eh},orthoZO:function(){return Oh},perspective:function(){return qf},perspectiveFromFieldOfView:function(){return Ph},perspectiveNO:function(){return Av},perspectiveZO:function(){return Ih},rotate:function(){return Xl},rotateX:function(){return fc},rotateY:function(){return q0},rotateZ:function(){return K0},scale:function(){return So},set:function(){return EA},str:function(){return TA},sub:function(){return LA},subtract:function(){return PA},targetTo:function(){return Rh},translate:function(){return Ks},transpose:function(){return Mh}});var k={};C.r(k),C.d(k,{add:function(){return n3},angle:function(){return fg},bezier:function(){return p3},ceil:function(){return i3},clone:function(){return e3},copy:function(){return t3},create:function(){return sA},cross:function(){return i1},dist:function(){return M3},distance:function(){return Jy},div:function(){return T3},divide:function(){return Ky},dot:function(){return n1},equals:function(){return C3},exactEquals:function(){return S3},floor:function(){return a3},forEach:function(){return O3},fromValues:function(){return Pu},hermite:function(){return A3},inverse:function(){return f3},len:function(){return P3},length:function(){return Xy},lerp:function(){return h3},max:function(){return s3},min:function(){return o3},mul:function(){return w3},multiply:function(){return qy},negate:function(){return r1},normalize:function(){return uA},random:function(){return v3},rotateX:function(){return y3},rotateY:function(){return _3},rotateZ:function(){return x3},round:function(){return u3},scale:function(){return l3},scaleAndAdd:function(){return c3},set:function(){return r3},sqrDist:function(){return I3},sqrLen:function(){return L3},squaredDistance:function(){return e1},squaredLength:function(){return t1},str:function(){return b3},sub:function(){return hg},subtract:function(){return Qy},transformMat3:function(){return g3},transformMat4:function(){return hp},transformQuat:function(){return m3},zero:function(){return E3}});var G={},Z={},F=function(i){return Z[i]},z=function(i,t){Z[i]=t},q=function(i){return G[i]},ee=function(i,t){G[i]=t},fe={},Se={},Re=34,De=10,Ve=13;function nt(e){return new Function("d","return {"+e.map(function(i,t){return JSON.stringify(i)+": d["+t+'] || ""'}).join(",")+"}")}function Ee(e,i){var t=nt(e);return function(n,r){return i(t(n),r,e)}}function Ie(e){var i=Object.create(null),t=[];return e.forEach(function(n){for(var r in n)r in i||t.push(i[r]=r)}),t}function me(e,i){var t=e+"",n=t.length;return n<i?new Array(i-n+1).join(0)+t:t}function we(e){return e<0?"-"+me(-e,6):e>9999?"+"+me(e,6):me(e,4)}function ne(e){var i=e.getUTCHours(),t=e.getUTCMinutes(),n=e.getUTCSeconds(),r=e.getUTCMilliseconds();return isNaN(e)?"Invalid Date":we(e.getUTCFullYear(),4)+"-"+me(e.getUTCMonth()+1,2)+"-"+me(e.getUTCDate(),2)+(r?"T"+me(i,2)+":"+me(t,2)+":"+me(n,2)+"."+me(r,3)+"Z":n?"T"+me(i,2)+":"+me(t,2)+":"+me(n,2)+"Z":t||i?"T"+me(i,2)+":"+me(t,2)+"Z":"")}function Pe(e){var i=new RegExp('["'+e+`
\r]`),t=e.charCodeAt(0);function n(O,B){var W,ce,oe=r(O,function(Te,Ze){if(W)return W(Te,Ze-1);ce=Te,W=B?Ee(Te,B):nt(Te)});return oe.columns=ce||[],oe}function r(O,B){var W=[],ce=O.length,oe=0,Te=0,Ze,qe=ce<=0,et=!1;O.charCodeAt(ce-1)===De&&--ce,O.charCodeAt(ce-1)===Ve&&--ce;function yt(){if(qe)return Se;if(et)return et=!1,fe;var Ot,jt=oe,or;if(O.charCodeAt(jt)===Re){for(;oe++<ce&&O.charCodeAt(oe)!==Re||O.charCodeAt(++oe)===Re;);return(Ot=oe)>=ce?qe=!0:(or=O.charCodeAt(oe++))===De?et=!0:or===Ve&&(et=!0,O.charCodeAt(oe)===De&&++oe),O.slice(jt+1,Ot-1).replace(/""/g,'"')}for(;oe<ce;){if((or=O.charCodeAt(Ot=oe++))===De)et=!0;else if(or===Ve)et=!0,O.charCodeAt(oe)===De&&++oe;else if(or!==t)continue;return O.slice(jt,Ot)}return qe=!0,O.slice(jt,ce)}for(;(Ze=yt())!==Se;){for(var bt=[];Ze!==fe&&Ze!==Se;)bt.push(Ze),Ze=yt();B&&(bt=B(bt,Te++))==null||W.push(bt)}return W}function a(O,B){return O.map(function(W){return B.map(function(ce){return M(W[ce])}).join(e)})}function u(O,B){return B==null&&(B=Ie(O)),[B.map(M).join(e)].concat(a(O,B)).join(`
`)}function c(O,B){return B==null&&(B=Ie(O)),a(O,B).join(`
`)}function g(O){return O.map(x).join(`
`)}function x(O){return O.map(M).join(e)}function M(O){return O==null?"":O instanceof Date?ne(O):i.test(O+="")?'"'+O.replace(/"/g,'""')+'"':O}return{parse:n,parseRows:r,format:u,formatBody:c,formatRows:g,formatRow:x,formatValue:M}}var he=Pe(","),ve=he.parse,te=he.parseRows,Y=he.format,Oe=he.formatBody,pe=he.formatRows,ye=he.formatRow,_e=he.formatValue,X=C(1413),Le=C(36987),de=C(39034),be=C(43144),se=C(15671),Ne=C(60136),ze=C(82963),ue=C(61120),kt=C(89611);function Rt(e){try{return Function.toString.call(e).indexOf("[native code]")!==-1}catch(i){return typeof e=="function"}}var cr=C(78814);function Ut(e,i,t){return(0,cr.Z)()?Ut=Reflect.construct.bind():Ut=function(r,a,u){var c=[null];c.push.apply(c,a);var g=Function.bind.apply(r,c),x=new g;return u&&(0,kt.Z)(x,u.prototype),x},Ut.apply(null,arguments)}function $r(e){var i=typeof Map=="function"?new Map:void 0;return $r=function(n){if(n===null||!Rt(n))return n;if(typeof n!="function")throw new TypeError("Super expression must either be null or a function");if(typeof i!="undefined"){if(i.has(n))return i.get(n);i.set(n,r)}function r(){return Ut(n,arguments,(0,ue.Z)(this).constructor)}return r.prototype=Object.create(n.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),(0,kt.Z)(r,n)},$r(e)}var ln={REGISTERED_PROTOCOLS:{}};function Cr(e){var i=Qr();return function(){var n=(0,ue.Z)(e),r;if(i){var a=(0,ue.Z)(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return(0,ze.Z)(this,r)}}function Qr(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var Jr=function(i){return ln.REGISTERED_PROTOCOLS[i.substring(0,i.indexOf("://"))]},xr=function(e){(0,Ne.Z)(t,e);var i=Cr(t);function t(n,r,a,u){var c;return(0,se.Z)(this,t),c=i.call(this,"AJAXError: ".concat(r," (").concat(n,"): ").concat(a)),c.status=n,c.statusText=r,c.url=a,c.body=u,c}return(0,be.Z)(t)}($r(Error));function Gn(e,i){var t=new XMLHttpRequest,n=Array.isArray(e.url)?e.url[0]:e.url;t.open(e.method||"GET",n,!0),e.type==="arrayBuffer"&&(t.responseType="arraybuffer");for(var r in e.headers)e.headers.hasOwnProperty(r)&&t.setRequestHeader(r,e.headers[r]);return e.type==="json"&&(t.responseType="text",t.setRequestHeader("Accept","application/json")),t.withCredentials=e.credentials==="include",t.onerror=function(){i(new Error(t.statusText))},t.onload=function(){if((t.status>=200&&t.status<300||t.status===0)&&t.response!==null){var a=t.response;if(e.type==="json")try{a=JSON.parse(t.response)}catch(c){return i(c)}i(null,a,t.getResponseHeader("Cache-Control"),t.getResponseHeader("Expires"),t)}else{var u=new Blob([t.response],{type:t.getResponseHeader("Content-Type")});i(new xr(t.status,t.statusText,n.toString(),u))}},t.cancel=t.abort,t.send(e.body),t}function ti(e){return new Promise(function(i,t){Gn(e,function(n,r,a,u,c){n?t({err:n,data:null,xhr:c}):i({err:null,data:r,cacheControl:a,expires:u,xhr:c})})})}function Vn(e,i){return Gn(e,i)}var Xr=function(i,t){var n=Jr(i.url)||Vn;return n((0,X.Z)((0,X.Z)({},i),{},{type:"json"}),t)},sn=function(i,t){var n=Jr(i.url)||Vn;return n((0,X.Z)((0,X.Z)({},i),{},{type:"arrayBuffer"}),t)},yn=function(i,t){return Vn(_objectSpread(_objectSpread({},i),{},{method:"POST"}),t)},ki=function(i,t){return Vn((0,X.Z)((0,X.Z)({},i),{},{method:"GET"}),t)};function ri(e){var i=window.document.createElement("a");return i.href=e,i.protocol===window.document.location.protocol&&i.host===window.document.location.host}var Lt="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";function J(e,i){var t=new window.Image,n=window.URL||window.webkitURL;t.crossOrigin="anonymous",t.onload=function(){i(null,t),n.revokeObjectURL(t.src),t.onload=null,window.requestAnimationFrame(function(){t.src=Lt})},t.onerror=function(){return i(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))};var r=new Blob([new Uint8Array(e)],{type:"image/png"});t.src=e.byteLength?n.createObjectURL(r):Lt}function Ue(e,i){var t=new Blob([new Uint8Array(e)],{type:"image/png"});createImageBitmap(t).then(function(n){i(null,n)}).catch(function(n){i(new Error("Could not load image because of ".concat(n.message,". Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.")))})}var $e=function(i,t,n){var r=function(u,c){if(u)t(u);else if(c){var g=typeof createImageBitmap=="function",x=n?n(c):c;g?Ue(x,t):J(x,t)}};return i.type==="json"?Xr(i,r):sn(i,r)},At=function(i,t){var n=typeof createImageBitmap=="function";n?Ue(i,t):J(i,t)},It=function(e){return e.CENTER="center",e.TOP="top",e["TOP-LEFT"]="top-left",e["TOP-RIGHT"]="top-right",e.BOTTOM="bottom",e["BOTTOM-LEFT"]="bottom-left",e["BOTTOM-RIGHT"]="bottom-right",e.LEFT="left",e.RIGHT="right",e}({}),wt={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function mr(e,i,t){var n=e.classList;for(var r in wt)wt.hasOwnProperty(r)&&n.remove("l7-".concat(t,"-anchor-").concat(r));n.add("l7-".concat(t,"-anchor-").concat(i))}function vt(e,i,t){e.prototype=i.prototype=t,t.constructor=e}function Tt(e,i){var t=Object.create(e.prototype);for(var n in i)t[n]=i[n];return t}function Qt(){}var Er=.7,Dr=1/Er,Yr="\\s*([+-]?\\d+)\\s*",an="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",Br="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",en=/^#([0-9a-f]{3,8})$/,Zn=new RegExp("^rgb\\("+[Yr,Yr,Yr]+"\\)$"),zn=new RegExp("^rgb\\("+[Br,Br,Br]+"\\)$"),fi=new RegExp("^rgba\\("+[Yr,Yr,Yr,an]+"\\)$"),la=new RegExp("^rgba\\("+[Br,Br,Br,an]+"\\)$"),Oa=new RegExp("^hsl\\("+[an,Br,Br]+"\\)$"),Gr=new RegExp("^hsla\\("+[an,Br,Br,an]+"\\)$"),Ns={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};vt(Qt,go,{copy:function(e){return Object.assign(new this.constructor,this,e)},displayable:function(){return this.rgb().displayable()},hex:Co,formatHex:Co,formatHsl:_n,formatRgb:xs,toString:xs});function Co(){return this.rgb().formatHex()}function _n(){return Zi(this).formatHsl()}function xs(){return this.rgb().formatRgb()}function go(e){var i,t;return e=(e+"").trim().toLowerCase(),(i=en.exec(e))?(t=i[1].length,i=parseInt(i[1],16),t===6?Fs(i):t===3?new Es(i>>8&15|i>>4&240,i>>4&15|i&240,(i&15)<<4|i&15,1):t===8?Po(i>>24&255,i>>16&255,i>>8&255,(i&255)/255):t===4?Po(i>>12&15|i>>8&240,i>>8&15|i>>4&240,i>>4&15|i&240,((i&15)<<4|i&15)/255):null):(i=Zn.exec(e))?new Es(i[1],i[2],i[3],1):(i=zn.exec(e))?new Es(i[1]*255/100,i[2]*255/100,i[3]*255/100,1):(i=fi.exec(e))?Po(i[1],i[2],i[3],i[4]):(i=la.exec(e))?Po(i[1]*255/100,i[2]*255/100,i[3]*255/100,i[4]):(i=Oa.exec(e))?ga(i[1],i[2]/100,i[3]/100,1):(i=Gr.exec(e))?ga(i[1],i[2]/100,i[3]/100,i[4]):Ns.hasOwnProperty(e)?Fs(Ns[e]):e==="transparent"?new Es(NaN,NaN,NaN,0):null}function Fs(e){return new Es(e>>16&255,e>>8&255,e&255,1)}function Po(e,i,t,n){return n<=0&&(e=i=t=NaN),new Es(e,i,t,n)}function hl(e){return e instanceof Qt||(e=go(e)),e?(e=e.rgb(),new Es(e.r,e.g,e.b,e.opacity)):new Es}function yu(e,i,t,n){return arguments.length===1?hl(e):new Es(e,i,t,n==null?1:n)}function Es(e,i,t,n){this.r=+e,this.g=+i,this.b=+t,this.opacity=+n}vt(Es,yu,Tt(Qt,{brighter:function(e){return e=e==null?Dr:Math.pow(Dr,e),new Es(this.r*e,this.g*e,this.b*e,this.opacity)},darker:function(e){return e=e==null?Er:Math.pow(Er,e),new Es(this.r*e,this.g*e,this.b*e,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:cs,formatHex:cs,formatRgb:Ou,toString:Ou}));function cs(){return"#"+Al(this.r)+Al(this.g)+Al(this.b)}function Ou(){var e=this.opacity;return e=isNaN(e)?1:Math.max(0,Math.min(1,e)),(e===1?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(e===1?")":", "+e+")")}function Al(e){return e=Math.max(0,Math.min(255,Math.round(e)||0)),(e<16?"0":"")+e.toString(16)}function ga(e,i,t,n){return n<=0?e=i=t=NaN:t<=0||t>=1?e=i=NaN:i<=0&&(e=NaN),new no(e,i,t,n)}function Zi(e){if(e instanceof no)return new no(e.h,e.s,e.l,e.opacity);if(e instanceof Qt||(e=go(e)),!e)return new no;if(e instanceof no)return e;e=e.rgb();var i=e.r/255,t=e.g/255,n=e.b/255,r=Math.min(i,t,n),a=Math.max(i,t,n),u=NaN,c=a-r,g=(a+r)/2;return c?(i===a?u=(t-n)/c+(t<n)*6:t===a?u=(n-i)/c+2:u=(i-t)/c+4,c/=g<.5?a+r:2-a-r,u*=60):c=g>0&&g<1?0:u,new no(u,c,g,e.opacity)}function Bs(e,i,t,n){return arguments.length===1?Zi(e):new no(e,i,t,n==null?1:n)}function no(e,i,t,n){this.h=+e,this.s=+i,this.l=+t,this.opacity=+n}vt(no,Bs,Tt(Qt,{brighter:function(e){return e=e==null?Dr:Math.pow(Dr,e),new no(this.h,this.s,this.l*e,this.opacity)},darker:function(e){return e=e==null?Er:Math.pow(Er,e),new no(this.h,this.s,this.l*e,this.opacity)},rgb:function(){var e=this.h%360+(this.h<0)*360,i=isNaN(e)||isNaN(this.s)?0:this.s,t=this.l,n=t+(t<.5?t:1-t)*i,r=2*t-n;return new Es(es(e>=240?e-240:e+120,r,n),es(e,r,n),es(e<120?e+240:e-120,r,n),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var e=this.opacity;return e=isNaN(e)?1:Math.max(0,Math.min(1,e)),(e===1?"hsl(":"hsla(")+(this.h||0)+", "+(this.s||0)*100+"%, "+(this.l||0)*100+"%"+(e===1?")":", "+e+")")}}));function es(e,i,t){return(e<60?i+(t-i)*e/60:e<180?t:e<240?i+(t-i)*(240-e)/60:i)*255}function Lo(e){return typeof e=="string"?!!d3.color(e):!1}function Ni(e){var i=go(e),t=[0,0,0,0];return i!=null&&(t[0]=i.r/255,t[1]=i.g/255,t[2]=i.b/255,t[3]=i.opacity),t}function io(e){var i=e&&e[0],t=e&&e[1],n=e&&e[2],r=i+t*256+n*65536-1;return r}function bs(e){return[e+1&255,e+1>>8&255,e+1>>8>>8&255]}function $o(e){var i=window.document.createElement("canvas"),t=i.getContext("2d");i.width=256,i.height=1;for(var n=null,r=t.createLinearGradient(0,0,256,1),a=e.positions[0],u=e.positions[e.positions.length-1],c=0;c<e.colors.length;++c){var g=(e.positions[c]-a)/(u-a);r.addColorStop(g,e.colors[c])}return t.fillStyle=r,t.fillRect(0,0,256,1),n=new Uint8ClampedArray(t.getImageData(0,0,256,1).data),i=null,t=null,{data:n,width:256,height:1}}function Ru(e,i){var t=window.document.createElement("canvas"),n=t.getContext("2d");t.width=256,t.height=1;for(var r=n.createLinearGradient(0,0,256,1),a=i[1]-i[0],u=0;u<e.colors.length;++u){var c=Math.max((e.positions[u]-i[0])/a,0);r.addColorStop(c,e.colors[u])}n.fillStyle=r,n.fillRect(0,0,256,1);var g=n.getImageData(0,0,256,1).data,x=uo(n,g);return t=null,n=null,x}function Ca(e){var i=window.document.createElement("canvas"),t=i.getContext("2d");i.width=256,i.height=1;var n=t.createImageData(256,1);return n.data.fill(0),e.positions.forEach(function(r,a){var u=Ni(e.colors[a]);n.data[r*4+0]=u[0]*255,n.data[r*4+1]=u[1]*255,n.data[r*4+2]=u[2]*255,n.data[r*4+3]=u[3]*255}),i=null,t=null,n}function xa(e){var i=window.document.createElement("canvas"),t=i.getContext("2d");t.globalAlpha=1,i.width=256,i.height=1;for(var n=256/e.colors.length,r=0;r<e.colors.length;r++)t.beginPath(),t.lineWidth=2,t.strokeStyle=e.colors[r],t.moveTo(r*n,0),t.lineTo((r+1)*n,0),t.stroke();var a=t.getImageData(0,0,256,1).data,u=uo(t,a);return i=null,t=null,u}function Ku(e,i){var t=window.document.createElement("canvas"),n=t.getContext("2d");n.globalAlpha=1,t.width=256,t.height=1;var r=i[1]-i[0];e.positions.length-e.colors.length!==1&&console.warn("positions \u7684\u6570\u5B57\u4E2A\u6570\u5E94\u5F53\u6BD4 colors \u7684\u6837\u5F0F\u591A\u4E00\u4E2A,poisitions \u7684\u9996\u5C3E\u503C\u4E00\u822C\u4E3A\u6570\u636E\u7684\u6700\u5927\u6700\u65B0\u503C");for(var a=0;a<e.colors.length;a++)n.beginPath(),n.lineWidth=2,n.strokeStyle=e.colors[a],n.moveTo((e.positions[a]-i[0])/r*255,0),n.lineTo((e.positions[a+1]-i[0])/r*255,0),n.stroke();var u=n.getImageData(0,0,256,1).data,c=uo(n,u);return t=null,n=null,c}function uo(e,i){for(var t=e.createImageData(256,1),n=0;n<t.data.length;n+=4)t.data[n+0]=i[n+0],t.data[n+1]=i[n+1],t.data[n+2]=i[n+2],t.data[n+3]=i[n+3];return t}function eu(e){switch(e.type){case"cat":return[0,255];default:return[0,1]}}var wa={BACK:1029,FRONT:1028};function lu(e){switch(e){case"GAODE1.x":return wa.BACK;case"GAODE2.x":return wa.BACK;case"MAPBOX":return wa.FRONT;case"SIMPLE":return wa.FRONT;case"GLOBEL":return wa.BACK;case"DEBAULT":return wa.FRONT;default:return wa.FRONT}}var pr=C(74902),vn=C(97685),lo=C(74691),tu=C.n(lo),ru=C(50361),Ss=C.n(ru),Zs=C(23279),Va=C.n(Zs),Xc=C(27361),Cs=C.n(Xc),ts=C(51584),Pl=C.n(ts),zi=C(18446),Ll=C.n(zi),Oo=C(14293),pl=C.n(Oo),Ai=C(81763),_u=C.n(Ai),gf=C(68630),Du=C.n(gf),rs=C(47037),Mt=C.n(rs),He=C(36719),Gt=C.n(He),Ae=C(82492),Be=C.n(Ae),We=C(30236),zt=C.n(We),hr=C(97019),Pr=C.n(hr),dn=C(23493),Mn=C.n(dn),vi=C(44908),co=C.n(vi),ns=C(11700),ws=C.n(ns),Qc=C(23560),zs=C.n(Qc),ca=C(13218),ec=C.n(ca),qa=C(52353),mf=C.n(qa),dl=C(68929),Ta=C.n(dl),In={isNil:pl(),merge:Be(),throttle:Mn(),isString:Mt(),debounce:Va(),pull:Pr(),isTypedArray:Gt(),isPlainObject:Du(),isNumber:_u(),isBoolean:Pl(),isEqual:Ll(),cloneDeep:Ss(),uniq:co(),clamp:tu(),upperFirst:ws(),get:Cs(),mergeWith:zt(),isFunction:zs(),isObject:ec(),isUndefined:mf(),camelCase:Ta()},Ju=In.pull;function Us(e){var i=e;return typeof e=="string"&&(i=window.document.getElementById(e)),i}function cu(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}function fu(e){return cu(e).split(/\s+/)}function xu(e){var i,t,n=(i=document)===null||i===void 0||(t=i.documentElement)===null||t===void 0?void 0:t.style;if(!n)return e[0];for(var r in e)if(e[r]&&e[r]in n)return e[r];return e[0]}function ni(e,i,t){var n=window.document.createElement(e);return i&&(n.className=i||""),t&&t.appendChild(n),n}function Ro(e){var i=e.parentNode;i&&i.removeChild(e)}function Ha(e,i){if(e.classList!==void 0)for(var t=fu(i),n=0,r=t.length;n<r;n++)e.classList.add(t[n]);else if(!mo(e,i)){var a=yf(e);hu(e,(a?a+" ":"")+i)}}function Ra(e,i){if(e.classList!==void 0){var t=fu(i);t.forEach(function(n){e.classList.remove(n)})}else hu(e,cu((" "+yf(e)+" ").replace(" "+i+" "," ")))}function mo(e,i){if(e.classList!==void 0)return e.classList.contains(i);var t=yf(e);return t.length>0&&new RegExp("(^|\\s)"+i+"(\\s|$)").test(t)}function hu(e,i){e instanceof HTMLElement?e.className=i:e.className.baseVal=i}function yf(e){return e instanceof SVGElement&&(e=e.correspondingElement),e.className.baseVal===void 0?e.className:e.className.baseVal}function Ol(e){for(;e&&e.firstChild;)e.removeChild(e.firstChild)}var qc=xu(["transform","WebkitTransform"]);function _f(e,i){e.style[qc]=i}function Yo(){if(typeof Event=="function")window.dispatchEvent(new Event("resize"));else{var e=window.document.createEvent("UIEvents");e.initUIEvent("resize",!0,!1,window,0),window.dispatchEvent(e)}}function Gs(e){var i=["padding: "+(e.height/2-8)+"px "+e.width/2+"px;","line-height: "+e.height+"px;","background-image: url("+e.toDataURL()+");"];console.log(`%c
`,i.join(""))}function Do(){var e,i=window.document.querySelector('meta[name="viewport"]');if(!i)return 1;var t=(e=i.content)===null||e===void 0?void 0:e.split(","),n=t.find(function(r){var a=r.split("="),u=(0,vn.Z)(a,1),c=u[0];return c==="initial-scale"});return n?n.split("=")[1]*1:1}var fa=Do()<1?1:window.devicePixelRatio;function is(e,i){e.setAttribute("style","".concat(e.style.cssText).concat(i))}function Rl(e){return e.split(";").map(function(i){return i.trim()}).filter(function(i){return i})}function Ma(e,i){var t,n=Rl((t=e.getAttribute("style"))!==null&&t!==void 0?t:""),r=Rl(i),a=Ju.apply(void 0,[n].concat((0,pr.Z)(r)));e.setAttribute("style",a.join(";"))}function Sn(e){return Object.entries(e).map(function(i){var t=(0,vn.Z)(i,2),n=t[0],r=t[1];return"".concat(n,": ").concat(r)}).join(";")}function vl(e,i){return{left:e.left-i.left,top:e.top-i.top,right:i.left+i.width-e.left-e.width,bottom:i.top+i.height-e.top-e.height}}function tc(e,i){e.checked=i,i?e.setAttribute("checked","true"):e.removeAttribute("checked")}function Ka(e){e.innerHTML=""}function fs(e){e.setAttribute("draggable","false")}function gl(e,i){if(typeof i=="string"){var t=document.createElement("div");for(t.innerHTML=i;t.firstChild;)e.append(t.firstChild)}else Array.isArray(i)?e.append.apply(e,(0,pr.Z)(i)):e.append(i)}function gc(e,i){for(var t=Array.isArray(i)?i:[i],n=e;n instanceof Element&&n!==window.document.body;){var r,a;if(t.find(function(u){var c;return(c=n)===null||c===void 0?void 0:c.matches(u)}))return n;n=(r=(a=n)===null||a===void 0?void 0:a.parentElement)!==null&&r!==void 0?r:null}}var mc;function xf(e){return typeof ImageBitmap!="undefined"&&e instanceof ImageBitmap}function ea(){return typeof importScripts=="function"}var ku=ea()?function(){return self.worker&&self.worker.referrer}:function(){return(window.location.protocol==="blob:"?window.parent:window).location.href},na=(mc=navigator)===null||mc===void 0?void 0:mc.userAgent,Za=!!na.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/),ko=na.indexOf("Android")>-1||na.indexOf("Adr")>-1;function Nf(){for(var e=na,i=["Android","iPhone","SymbianOS","Windows Phone","iPad","iPod"],t=!0,n=0,r=i;n<r.length;n++){var a=r[n];if(e.indexOf(a)>0){t=!1;break}}return t}function ui(e,i){e.forEach(function(t){i[t]&&(i[t]=i[t].bind(i))})}var hs=null,aa=C(62096),Ts=C(1449);function Ea(e){return typeof e=="number"}var As=2*Math.PI*6378137/2;function ml(e,i){var t=(0,vn.Z)(i,4),n=t[0],r=t[1],a=t[2],u=t[3];return e.lng>n&&e.lng<=a&&e.lat>r&&e.lat<=u}function nu(e){var i=[1/0,1/0,-1/0,-1/0];return e.forEach(function(t){var n=t.coordinates;Mi(i,n)}),i}function Mi(e,i){return Array.isArray(i[0])?i.forEach(function(t){Mi(e,t)}):(e[0]>i[0]&&(e[0]=i[0]),e[1]>i[1]&&(e[1]=i[1]),e[2]<i[0]&&(e[2]=i[0]),e[3]<i[1]&&(e[3]=i[1])),e}function as(e,i){return iu(e,i)}function iu(e,i){return Array.isArray(e[0])?e.map(function(t){return iu(t,i)}):i(e)}function No(e){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{enable:!0,decimal:1};e=rc(e,i);var n=e[0],r=e[1],a=n*As/180,u=Math.log(Math.tan((90+r)*Math.PI/360))/(Math.PI/180);return u=u*As/180,t.enable&&(a=Number(a.toFixed(t.decimal)),u=Number(u.toFixed(t.decimal))),e.length===3?[a,u,e[2]]:[a,u]}function ps(e){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:6,t=e[0],n=e[1],r=t/As*180,a=n/As*180;return a=180/Math.PI*(2*Math.atan(Math.exp(a*Math.PI/180))-Math.PI/2),i!=null&&(r=Number(r.toFixed(i)),a=Number(a.toFixed(i))),e.length===3?[r,a,e[2]]:[r,a]}function Fo(e){if(e==null)throw new Error("lng is required");return(e>180||e<-180)&&(e=e%360,e>180&&(e=-360+e),e<-180&&(e=360+e),e===0&&(e=0)),e}function a0(e){if(e==null)throw new Error("lat is required");return(e>90||e<-90)&&(e=e%180,e>90&&(e=-180+e),e<-90&&(e=180+e),e===0&&(e=0)),e}function rc(e,i){if(i===!1)return e;var t=Fo(e[0]),n=a0(e[1]);return n>85&&(n=85),n<-85&&(n=-85),e.length===3?[t,n,e[2]]:[t,n]}function ma(e){var i=85.0511287798,t=Math.max(Math.min(i,e[1]),-i),n=256<<20,r=Math.PI/180,a=e[0]*r,u=t*r;u=Math.log(Math.tan(Math.PI/4+u/2));var c=.5/Math.PI,g=.5,x=-.5/Math.PI;return r=.5,a=n*(c*a+g),u=n*(x*u+r),[Math.floor(a),Math.floor(u)]}function Bo(e){var i=.5/Math.PI,t=.5,n=-.5/Math.PI,r=.5,a=256<<20,u=_slicedToArray(e,2),c=u[0],g=u[1];c=(c/a-t)/i,g=(g/a-r)/n,g=(Math.atan(Math.pow(Math.E,g))-Math.PI/4)*2,r=Math.PI/180;var x=g/r,M=c/r;return[M,x]}function Ms(e,i){var t=85.0511287798,n=Math.PI/180,r=6378137;return i=Math.max(Math.min(t,i),-t),e*=n,i*=n,i=Math.log(Math.tan(Math.PI/4+i/2)),[e*r,i*r]}function fo(e,i){var t=Math.PI/180,n=6378137,r=e/n/t,a=2*(Math.atan(Math.exp(i/n))-Math.PI/4)/t;return[r,a]}function Wo(e,i,t){var n=degreesToRadians(i[1]-e[1]),r=degreesToRadians(i[0]-e[0]),a=degreesToRadians(e[1]),u=degreesToRadians(i[1]),c=Math.pow(Math.sin(n/2),2)+Math.pow(Math.sin(r/2),2)*Math.cos(a)*Math.cos(u);return radiansToLength(2*Math.atan2(Math.sqrt(c),Math.sqrt(1-c)),t="meters")}function Au(e){var i=Math.PI/180,t=85.0511287798,n=6378137,r=Math.max(Math.min(t,e[1]),-t),a=Math.sin(r*i),u=n*e[0]*i,c=n*Math.log((1+a)/(1-a))/2;return[u,c]}function js(e,i){var t=Math.abs(e[1][1]-e[0][1])*i,n=Math.abs(e[1][0]-e[0][0])*i;return[[e[0][0]-n,e[0][1]-t],[e[1][0]+n,e[1][1]+t]]}function Zr(e,i){return e[0][0]<=i[0][0]&&e[0][1]<=i[0][1]&&e[1][0]>=i[1][0]&&e[1][1]>=i[1][1]}function Ja(e){return[[e[0],e[1]],[e[2],e[3]]]}function yc(e){var i=Dl(e,[0,0]);return[e[0]/i,e[1]/i]}function Dl(e,i){return Math.sqrt(Math.pow(e[0]-i[0],2)+Math.pow(e[1]-i[1],2))}function yo(e,i){return e[0]*i[0]+e[1]*i[1]}function Nu(e){return Math.sqrt(e[0]*e[0]+e[1]*e[1])}function Eu(e,i){return Math.acos(yo(e,i)/(Nu(e)*Nu(i)))*180/Math.PI}function Kc(e,i){return i[0]>0?i[1]>0?90-Math.atan(i[1]/i[0])*180/Math.PI:90+Math.atan(-i[1]/i[0])*180/Math.PI:i[1]<0?180+(90-Math.atan(i[1]/i[0])*180/Math.PI):270+Math.atan(i[1]/-i[0])*180/Math.PI}function ds(e){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:100;if(!(!e||e.length<2)){for(var t=[0,1],n=0,r=[],a=0;a<e.length-1;a++){var u=e[a],c=e[a+1],g=Dl(u,c);n+=g;var x=[u[0]-c[0],u[1]-c[1]],M=Kc(t,x);if(a>0){var O=r[a-1].rotation;O-M>360-O+M&&(M=M+360)}r.push({start:u,end:c,dis:g,rotation:M,duration:0})}return r.map(function(B){B.duration=i*(B.dis/n)}),r}}function Is(e){if(Ea(e[0]))return e;if(Ea(e[0][0]))throw new Error("\u5F53\u524D\u6570\u636E\u4E0D\u652F\u6301\u6807\u6CE8");if(Ea(e[0][0][0])){var i=e,t=0,n=0,r=0;return i.forEach(function(a){a.forEach(function(u){t+=u[0],n+=u[1],r++})}),[t/r,n/r,0]}else throw new Error("\u5F53\u524D\u6570\u636E\u4E0D\u652F\u6301\u6807\u6CE8")}function kl(e){for(var i=e[0],t=e[1],n=e[0],r=e[1],a=0,u=0,c=0,g=0;g<e.length;g+=2){var x=e[g],M=e[g+1];x&&M&&(i=Math.max(x,i),t=Math.max(M,t),n=Math.min(x,n),r=Math.min(M,r),a+=x,u+=M,c++)}return{center:[a/c,u/c],radius:Math.sqrt(Math.pow(i-n,2)+Math.pow(t-r,2))/2}}function el(e){return(0,aa.Z)((0,Ts.uf)([(0,Ts.Tu)(e)]))}function Jc(e){var i=131,t=137,n=0;e+="x";for(var r=Math.floor(9007199254740991/t),a=0;a<e.length;a++)n>r&&(n=Math.floor(n/t)),n=n*i+e.charCodeAt(a);return n}function Ff(e){e=e.toString();for(var i=5381,t=e.length;t;)i=i*33^e.charCodeAt(--t);return i>>>0}function yl(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var i=Math.random()*16|0,t=e==="x"?i:i&3|8;return t.toString(16)})}var bu=function(e){return e["GAODE1.x"]="GAODE1.x",e["GAODE2.x"]="GAODE2.x",e.MAPBOX="MAPBOX",e.DEFAULT="DEFAUlTMAP",e.SIMPLE="SIMPLE",e.GLOBEL="GLOBEL",e}({});function wo(e,i,t,n,r){var a=arguments.length>5&&arguments[5]!==void 0?arguments[5]:30,u=arguments.length>6?arguments[6]:void 0,c=t;return u&&(c=Math.round(t*(a-1))/(a-1)),n?Fu(e,i,c,n,r):Fu(e,i,c,.314,r)}function _l(e,i){var t=1-i;return(e[0]*t+e[1]*i)*t+(e[1]*t+e[2]*i)*i}function Zo(e,i){return Math.sqrt(Math.pow(e[0]-i[0],2)+Math.pow(e[1]-i[1],2))}function Su(e,i,t){var n=[i[0]-e[0],i[1]-e[1]],r=Zo(n,[0,0]),a=Math.atan2(n[1],n[0]),u=r/2/Math.cos(t),c=a+t,g=[u*Math.cos(c)+e[0],u*Math.sin(c)+e[1]];return g}function Fu(e,i,t,n,r){if(r===MapType["GAODE2.x"]){var a=amap2Project(e[0],e[1]),u=amap2Project(i[0],i[1]),c=Su(a,u,n),g=[a[0],c[0],u[0]],x=[a[1],c[1],u[1]];return[].concat(_toConsumableArray(amap2UnProject(_l(g,t),_l(x,t))),[0])}else{var M=Su(e,i,n),O=[e[0],M[0],i[0]],B=[e[1],M[1],i[1]];return[_l(O,t),_l(B,t),0]}}function ef(e,i,t,n,r){var a=arguments.length>5&&arguments[5]!==void 0?arguments[5]:30,u=arguments.length>6?arguments[6]:void 0,c=t;return u&&(c=Math.round(t*29)/29),_o(e,i,c,r)}function xl(e,i){var t=[i[0]-e[0],i[1]-e[1]],n=calDistance(t,[0,0]),r=Math.atan2(t[1],t[0]),a=.314,u=n/2/Math.cos(a),c=r+a,g=[u*Math.cos(c)+e[0],u*Math.sin(c)+e[1]];return g}function Bu(e,i){var t=1-i;return(e[0]*t+e[1]*i)*t+(e[1]*t+e[2]*i)*i}function pu(e,i){var t=[e[0]-i[0],e[1]-i[1]],n=[Math.sin(t[0]/2),Math.sin(t[1]/2)],r=n[1]*n[1]+Math.cos(e[1])*Math.cos(i[1])*n[0]*n[0];return 2*Math.atan2(Math.sqrt(r),Math.sqrt(1-r))}function _o(e,i,t,n){var r=[degreesToRadians(e[0]),degreesToRadians(e[1])],a=[degreesToRadians(i[0]),degreesToRadians(i[1])];if(n==="GAODE2.x"){var u=xl(r,a),c=[r[0],u[0],a[0]],g=[r[1],u[1],a[1]];return[Bu(c,t),Bu(g,t),0]}else{var x=pu(r,a);if(Math.abs(x-Math.PI)<.001)return[(1-t)*r[0]+t*a[0],(1-t)*r[1]+t*a[1]];var M=Math.sin((1-t)*x)/Math.sin(x),O=Math.sin(t*x)/Math.sin(x),B=[Math.sin(r[0]),Math.sin(r[1])],W=[Math.cos(r[0]),Math.cos(r[1])],ce=[Math.sin(a[0]),Math.sin(a[1])],oe=[Math.cos(a[0]),Math.cos(a[1])],Te=M*W[1]*W[0]+O*oe[1]*oe[0],Ze=M*W[1]*B[0]+O*oe[1]*ce[0],qe=M*B[1]+O*ce[1];return[radiansToDegrees(Math.atan2(Ze,Te)),radiansToDegrees(Math.atan2(qe,Math.sqrt(Te*Te+Ze*Ze)))]}}function Cu(e,i){for(var t=0,n=[],r=0;r<e.length-1;r++){var a=e[r],u=e[r+1],c=o0(a,u),g=t;t+=c,n.push({p1:a,p2:u,totalDistance:t,distance:c,lastTotalDistance:g})}for(var x=t*i,M,O,B=0,W=n;B<W.length;B++){var ce=W[B],oe=ce.totalDistance;if(oe>x){var Te=ce.p1,Ze=ce.p2,qe=(x-ce.lastTotalDistance)/ce.distance,et=ho(Ze,Te,qe);M=et[0],O=et[1];break}}return{lng:M,lat:O,height:0}}function ho(e,i,t){return[e[0]*t+i[0]*(1-t),e[1]*t+i[1]*(1-t)]}function o0(e,i){return Math.sqrt(Math.pow(e[0]-i[0],2)+Math.pow(e[1]-i[1],2))}function tl(e,i){var t=i.featureId,n=e.data.dataArray;return typeof t=="number"&&(n=n.filter(function(r){var a=r.id;return a===t})),n.map(function(r){var a=zo(r,i);return _objectSpread(_objectSpread({},r),a)})}function nc(e,i){return new Promise(function(t){e.inited?t(tl(e,i)):e.once("update",function(){t(tl(e,i))})})}function zo(e,i){var t=i.offset,n=i.shape,r=i.thetaOffset,a=i.mapVersion,u=i.segmentNumber,c=u===void 0?30:u,g=i.autoFit,x=g===void 0?!0:g,M=e.coordinates;if(n==="line")return pathLineAtOffset(M,t);var O=M[0],B=M[1],W=typeof r=="string"?e[r]||0:r,ce;switch(n){case"arc":ce=arcLineAtOffset;break;case"greatcircle":ce=greatCircleLineAtOffset;break;default:ce=arcLineAtOffset}var oe=ce(O,B,t,W,a,c,x),Te=_slicedToArray(oe,3),Ze=Te[0],qe=Te[1],et=Te[2];return{lng:Ze,lat:qe,height:et}}var Xo=function(){function e(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:50,t=arguments.length>1?arguments[1]:void 0;(0,se.Z)(this,e),this.limit=i,this.destroy=t||this.defaultDestroy,this.order=[],this.clear()}return(0,be.Z)(e,[{key:"clear",value:function(){var t=this;this.order.forEach(function(n){t.delete(n)}),this.cache={},this.order=[]}},{key:"get",value:function(t){var n=this.cache[t];return n&&(this.deleteOrder(t),this.appendOrder(t)),n}},{key:"set",value:function(t,n){this.cache[t]?(this.delete(t),this.cache[t]=n,this.appendOrder(t)):(Object.keys(this.cache).length===this.limit&&this.delete(this.order[0]),this.cache[t]=n,this.appendOrder(t))}},{key:"delete",value:function(t){var n=this.cache[t];n&&(this.deleteCache(t),this.deleteOrder(t),this.destroy(n,t))}},{key:"deleteCache",value:function(t){delete this.cache[t]}},{key:"deleteOrder",value:function(t){var n=this.order.findIndex(function(r){return r===t});n>=0&&this.order.splice(n,1)}},{key:"appendOrder",value:function(t){this.order.push(t)}},{key:"defaultDestroy",value:function(t,n){return null}}]),e}();function Vs(e){if(e.length===0)throw new Error("max requires at least one data point");for(var i=e[0],t=1;t<e.length;t++)e[t]>i&&(i=e[t]);return i*1}function Hs(e){if(e.length===0)throw new Error("min requires at least one data point");for(var i=e[0],t=1;t<e.length;t++)e[t]<i&&(i=e[t]);return i*1}function _c(e){if(e.length===0)return 0;for(var i=e[0]*1,t=1;t<e.length;t++)i+=e[t]*1;return i}function Ps(e){if(e.length===0)throw new Error("mean requires at least one data point");return _c(e)/e.length}function El(e){if(e.length===0)throw new Error("mean requires at least one data point");if(e.length<3)return e[0];e.sort();for(var i=e[0],t=NaN,n=0,r=1,a=1;a<e.length+1;a++)e[a]!==i?(r>n&&(n=r,t=i),r=1,i=e[a]):r++;return t*1}var To={min:Hs,max:Vs,mean:Ps,sum:_c,mode:El};function Ls(e,i){return e.map(function(t){return t[i]})}function za(e,i){return To[e](i)}var ur=C(15861),xt=C(97326),Me=C(4942),$s=C(64687),it=C.n($s),rl=C(95),ha=C(26729),Ys=C.n(ha),oi=function(e){return e.Realtime="realtime",e.Overlap="overlap",e.Replace="replace",e}({}),Aa=function(e){return e.Loading="Loading",e.Loaded="Loaded",e.Failure="Failure",e.Cancelled="Cancelled",e}({}),bi=0,$a=1,Ii=2;function Hn(e){e.forEach(function(i){i.isCurrent&&(i.isVisible=i.isLoaded)})}function yi(e){e.forEach(function(i){i.properties.state=bi}),e.forEach(function(i){i.isCurrent&&!_i(i)&&di(i)}),e.forEach(function(i){i.isVisible=!!(i.properties.state&Ii)})}function Yi(e){e.forEach(function(t){t.properties.state=bi}),e.forEach(function(t){t.isCurrent&&_i(t)});var i=e.slice().sort(function(t,n){return t.z-n.z});i.forEach(function(t){t.isVisible=!!(t.properties.state&Ii),t.children.length&&(t.isVisible||t.properties.state&$a)?t.children.forEach(function(n){n.properties.state=$a}):t.isCurrent&&di(t)})}function _i(e){for(;e;){if(e.isLoaded)return e.properties.state|=Ii,!0;e=e.parent}return!1}function di(e){e.children.forEach(function(i){i.isLoaded?i.properties.state|=Ii:di(i)})}var wn,Wn=256,Pi=[-1/0,-1/0,1/0,1/0],qn=.2,Ui=5,Gi=(wn={},(0,Me.Z)(wn,oi.Realtime,Hn),(0,Me.Z)(wn,oi.Overlap,yi),(0,Me.Z)(wn,oi.Replace,Yi),wn),Nn=function(){};function Wi(e,i,t){var n=Math.floor((e+180)/360*Math.pow(2,t)),r=Math.floor((1-Math.log(Math.tan(i*Math.PI/180)+1/Math.cos(i*Math.PI/180))/Math.PI)/2*Math.pow(2,t));return[n,r]}function $n(e,i,t){var n=e/Math.pow(2,t)*360-180,r=Math.PI-2*Math.PI*i/Math.pow(2,t),a=180/Math.PI*Math.atan(.5*(Math.exp(r)-Math.exp(-r)));return[n,a]}var Li=function(i,t,n){var r=$n(i,t,n),a=(0,vn.Z)(r,2),u=a[0],c=a[1],g=$n(i+1,t+1,n),x=(0,vn.Z)(g,2),M=x[0],O=x[1];return[u,O,M,c]};function Oi(e){var i=e.zoom,t=e.latLonBounds,n=e.maxZoom,r=n===void 0?1/0:n,a=e.minZoom,u=a===void 0?0:a,c=e.zoomOffset,g=c===void 0?0:c,x=e.extent,M=x===void 0?Pi:x,O=Math.ceil(i)+g;if(Number.isFinite(u)&&O<u)return[];Number.isFinite(r)&&O>r&&(O=r);for(var B=(0,vn.Z)(t,4),W=B[0],ce=B[1],oe=B[2],Te=B[3],Ze=[Math.max(W,M[0]),Math.max(ce,M[1]),Math.min(oe,M[2]),Math.min(Te,M[3])],qe=[],et=Wi(Ze[0],Ze[1],O),yt=(0,vn.Z)(et,2),bt=yt[0],Ot=yt[1],jt=Wi(Ze[2],Ze[3],O),or=(0,vn.Z)(jt,2),ar=or[0],Sr=or[1],dr=bt;dr<=ar;dr++)for(var jr=Sr;jr<=Ot;jr++)qe.push({x:dr,y:jr,z:O});var nn=(ar+bt)/2,En=(Ot+Sr)/2,_a=function(ls,Ds){return Math.abs(ls-nn)+Math.abs(Ds-En)};return qe.sort(function(_s,ls){return _a(_s.x,_s.y)-_a(ls.x,ls.y)}),qe}var Qi=function(i,t,n){var r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!0,a=Math.pow(2,n),u=a-1,c=a,g=i,x=t;return r&&(g<0?g=g+c:g>u&&(g=g%c)),{warpX:g,warpY:x}};function qi(e){var i=hi();return function(){var n=(0,ue.Z)(e),r;if(i){var a=(0,ue.Z)(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return(0,ze.Z)(this,r)}}function hi(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var Si=function(e){(0,Ne.Z)(t,e);var i=qi(t);function t(n){var r;(0,se.Z)(this,t),r=i.call(this),(0,Me.Z)((0,xt.Z)(r),"tileSize",256),(0,Me.Z)((0,xt.Z)(r),"isVisible",!1),(0,Me.Z)((0,xt.Z)(r),"isCurrent",!1),(0,Me.Z)((0,xt.Z)(r),"isVisibleChange",!1),(0,Me.Z)((0,xt.Z)(r),"loadedLayers",0),(0,Me.Z)((0,xt.Z)(r),"isLayerLoaded",!1),(0,Me.Z)((0,xt.Z)(r),"isLoad",!1),(0,Me.Z)((0,xt.Z)(r),"isChildLoad",!1),(0,Me.Z)((0,xt.Z)(r),"parent",null),(0,Me.Z)((0,xt.Z)(r),"children",[]),(0,Me.Z)((0,xt.Z)(r),"data",null),(0,Me.Z)((0,xt.Z)(r),"properties",{}),(0,Me.Z)((0,xt.Z)(r),"loadDataId",0);var a=n.x,u=n.y,c=n.z,g=n.tileSize,x=n.warp,M=x===void 0?!0:x;return r.x=a,r.y=u,r.z=c,r.warp=M||!0,r.tileSize=g,r}return(0,be.Z)(t,[{key:"isLoading",get:function(){return this.loadStatus===Aa.Loading}},{key:"isLoaded",get:function(){return this.loadStatus===Aa.Loaded}},{key:"isFailure",get:function(){return this.loadStatus===Aa.Failure}},{key:"setTileLayerLoaded",value:function(){this.isLayerLoaded=!0}},{key:"isCancelled",get:function(){return this.loadStatus===Aa.Cancelled}},{key:"isDone",get:function(){return[Aa.Loaded,Aa.Cancelled,Aa.Failure].includes(this.loadStatus)}},{key:"bounds",get:function(){return Li(this.x,this.y,this.z)}},{key:"bboxPolygon",get:function(){var r=(0,vn.Z)(this.bounds,4),a=r[0],u=r[1],c=r[2],g=r[3],x=[(c-a)/2,(g-u)/2],M=(0,rl.Z)(this.bounds,{properties:{key:this.key,id:this.key,bbox:this.bounds,center:x,meta:`
      `.concat(this.key,`
      `)}});return M}},{key:"key",get:function(){var r="".concat(this.x,"_").concat(this.y,"_").concat(this.z);return r}},{key:"layerLoad",value:function(){this.loadedLayers++,this.emit("layerLoaded")}},{key:"loadData",value:function(){var n=(0,ur.Z)(it().mark(function a(u){var c,g,x,M,O,B,W,ce,oe,Te,Ze,qe,et,yt,bt,Ot,jt;return it().wrap(function(ar){for(;;)switch(ar.prev=ar.next){case 0:return c=u.getData,g=u.onLoad,x=u.onError,this.loadDataId++,M=this.loadDataId,this.isLoading&&this.abortLoad(),this.abortController=new AbortController,this.loadStatus=Aa.Loading,O=null,ar.prev=7,W=this.x,ce=this.y,oe=this.z,Te=this.bounds,Ze=this.tileSize,qe=this.warp,et=Qi(W,ce,oe,qe),yt=et.warpX,bt=et.warpY,Ot=this.abortController.signal,jt={x:yt,y:bt,z:oe,bounds:Te,tileSize:Ze,signal:Ot,warp:qe},ar.next=14,c(jt,this);case 14:O=ar.sent,ar.next=20;break;case 17:ar.prev=17,ar.t0=ar.catch(7),B=ar.t0;case 20:if(M===this.loadDataId){ar.next=22;break}return ar.abrupt("return");case 22:if(!(this.isCancelled&&!O)){ar.next=24;break}return ar.abrupt("return");case 24:if(!(B||!O)){ar.next=28;break}return this.loadStatus=Aa.Failure,x(B,this),ar.abrupt("return");case 28:this.loadStatus=Aa.Loaded,this.data=O,g(this);case 31:case"end":return ar.stop()}},a,this,[[7,17]])}));function r(a){return n.apply(this,arguments)}return r}()},{key:"reloadData",value:function(r){this.isLoading&&this.abortLoad(),this.loadData(r)}},{key:"abortLoad",value:function(){this.isLoaded||this.isCancelled||(this.loadStatus=Aa.Cancelled,this.abortController.abort(),this.xhrCancel&&this.xhrCancel())}}]),t}(ha.EventEmitter),Ci=function(i,t){var n=Ja(i),r=js(n,t),a=360*3-180,u=85.0511287798065,c=[Math.max(r[0][0],-a),Math.max(r[0][1],-u),Math.min(r[1][0],a),Math.min(r[1][1],u)];return c},ji=function(i,t){var n=Ja(i),r=Ja(t),a=Zr(n,r);return a};function li(e,i){var t=typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=wu(e))||i&&e&&typeof e.length=="number"){t&&(e=t);var n=0,r=function(){};return{s:r,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(x){throw x},f:r}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var a=!0,u=!1,c;return{s:function(){t=t.call(e)},n:function(){var x=t.next();return a=x.done,x},e:function(x){u=!0,c=x},f:function(){try{!a&&t.return!=null&&t.return()}finally{if(u)throw c}}}}function wu(e,i){if(e){if(typeof e=="string")return Qo(e,i);var t=Object.prototype.toString.call(e).slice(8,-1);if(t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set")return Array.from(e);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return Qo(e,i)}}function Qo(e,i){(i==null||i>e.length)&&(i=e.length);for(var t=0,n=new Array(i);t<i;t++)n[t]=e[t];return n}function nl(e){var i=Zu();return function(){var n=(0,ue.Z)(e),r;if(i){var a=(0,ue.Z)(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return(0,ze.Z)(this,r)}}function Zu(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var Fn=In.throttle,qo=function(e){return e.TilesLoadStart="tiles-load-start",e.TileLoaded="tile-loaded",e.TileError="tile-error",e.TileUnload="tile-unload",e.TileUpdate="tile-update",e.TilesLoadFinished="tiles-load-finished",e}({}),Ws=function(e){(0,Ne.Z)(t,e);var i=nl(t);function t(n){var r;return(0,se.Z)(this,t),r=i.call(this),(0,Me.Z)((0,xt.Z)(r),"currentTiles",[]),(0,Me.Z)((0,xt.Z)(r),"cacheTiles",new Map),(0,Me.Z)((0,xt.Z)(r),"throttleUpdate",Fn(function(a,u){r.update(a,u)},16)),(0,Me.Z)((0,xt.Z)(r),"onTileLoad",function(a){r.emit(qo.TileLoaded,a),r.updateTileVisible(),r.loadFinished()}),(0,Me.Z)((0,xt.Z)(r),"onTileError",function(a,u){r.emit(qo.TileError,{error:a,tile:u}),r.updateTileVisible(),r.loadFinished()}),(0,Me.Z)((0,xt.Z)(r),"onTileUnload",function(a){r.emit(qo.TileUnload,a),r.loadFinished()}),r.options={tileSize:256,minZoom:0,maxZoom:1/0,zoomOffset:0,extent:Pi,getTileData:Nn,warp:!0,updateStrategy:oi.Replace},r.updateOptions(n),r}return(0,be.Z)(t,[{key:"isLoaded",get:function(){return this.currentTiles.every(function(r){return r.isDone})}},{key:"tiles",get:function(){var r=Array.from(this.cacheTiles.values()).sort(function(a,u){return a.z-u.z});return r}},{key:"updateOptions",value:function(r){var a=r.minZoom===void 0?this.options.minZoom:Math.ceil(r.minZoom),u=r.maxZoom===void 0?this.options.maxZoom:Math.floor(r.maxZoom);this.options=(0,X.Z)((0,X.Z)((0,X.Z)({},this.options),r),{},{minZoom:a,maxZoom:u})}},{key:"update",value:function(r,a){var u=this,c=Math.max(0,Math.ceil(r));if(!(this.lastViewStates&&this.lastViewStates.zoom===c&&ji(this.lastViewStates.latLonBoundsBuffer,a))){var g=Ci(a,qn);this.lastViewStates={zoom:c,latLonBounds:a,latLonBoundsBuffer:g},this.currentZoom=c;var x=!1,M=this.getTileIndices(c,g).filter(function(O){return u.options.warp||O.x>=0&&O.x<Math.pow(2,c)});this.emit(qo.TilesLoadStart),this.currentTiles=M.map(function(O){var B=O.x,W=O.y,ce=O.z,oe=u.getTile(B,W,ce);if(oe){var Te,Ze,qe=((Te=oe)===null||Te===void 0?void 0:Te.isFailure)||((Ze=oe)===null||Ze===void 0?void 0:Ze.isCancelled);return qe&&oe.loadData({getData:u.options.getTileData,onLoad:u.onTileLoad,onError:u.onTileError}),oe}return oe=u.createTile(B,W,ce),x=!0,oe}),x&&this.resizeCacheTiles(),this.updateTileVisible(),this.pruneRequests()}}},{key:"reloadAll",value:function(){var r=li(this.cacheTiles),a;try{for(r.s();!(a=r.n()).done;){var u=(0,vn.Z)(a.value,2),c=u[0],g=u[1];if(!this.currentTiles.includes(g)){this.cacheTiles.delete(c),this.onTileUnload(g);return}this.onTileUnload(g),g.loadData({getData:this.options.getTileData,onLoad:this.onTileLoad,onError:this.onTileError})}}catch(x){r.e(x)}finally{r.f()}}},{key:"reloadTileById",value:function(r,a,u){var c=this.cacheTiles.get("".concat(a,",").concat(u,",").concat(r));c&&(this.onTileUnload(c),c.loadData({getData:this.options.getTileData,onLoad:this.onTileLoad,onError:this.onTileError}))}},{key:"reloadTileByLnglat",value:function(r,a,u){var c=this.getTileByLngLat(r,a,u);c&&this.reloadTileById(c.z,c.x,c.y)}},{key:"reloadTileByExtent",value:function(r,a){var u=this,c=this.getTileIndices(a,r);c.forEach(function(g){u.reloadTileById(g.z,g.x,g.y)})}},{key:"pruneRequests",value:function(){var r=[],a=li(this.cacheTiles.values()),u;try{for(a.s();!(u=a.n()).done;){var c=u.value;c.isLoading&&!c.isCurrent&&!c.isVisible&&r.push(c)}}catch(x){a.e(x)}finally{a.f()}for(;r.length>0;){var g=r.shift();g.abortLoad()}}},{key:"getTileByLngLat",value:function(r,a,u){var c=this.options.zoomOffset,g=Math.ceil(u)+c,x=Wi(r,a,g),M=this.tiles.filter(function(O){return O.key==="".concat(x[0],"_").concat(x[1],"_").concat(g)});return M[0]}},{key:"getTileExtent",value:function(r,a){return this.getTileIndices(a,r)}},{key:"getTileByZXY",value:function(r,a,u){var c=this.tiles.filter(function(g){return g.key==="".concat(a,"_").concat(u,"_").concat(r)});return c[0]}},{key:"clear",value:function(){var r=li(this.cacheTiles.values()),a;try{for(r.s();!(a=r.n()).done;){var u=a.value;u.isLoading?u.abortLoad():this.onTileUnload(u)}}catch(c){r.e(c)}finally{r.f()}this.lastViewStates=void 0,this.cacheTiles.clear(),this.currentTiles=[]}},{key:"destroy",value:function(){this.clear(),this.removeAllListeners()}},{key:"updateTileVisible",value:function(){var r=this.options.updateStrategy,a=new Map,u=li(this.cacheTiles.values()),c;try{for(u.s();!(c=u.n()).done;){var g=c.value;a.set(g.key,g.isVisible),g.isCurrent=!1,g.isVisible=!1}}catch(ce){u.e(ce)}finally{u.f()}var x=li(this.currentTiles),M;try{for(x.s();!(M=x.n()).done;){var O=M.value;O.isCurrent=!0,O.isVisible=!0}}catch(ce){x.e(ce)}finally{x.f()}var B=Array.from(this.cacheTiles.values());typeof r=="function"?r(B):Gi[r](B);var W=!1;Array.from(this.cacheTiles.values()).forEach(function(ce){ce.isVisible!==a.get(ce.key)?(ce.isVisibleChange=!0,W=!0):ce.isVisibleChange=!1}),W&&this.emit(qo.TileUpdate)}},{key:"getTileIndices",value:function(r,a){var u=this.options,c=u.tileSize,g=u.extent,x=u.zoomOffset,M=Math.floor(this.options.maxZoom),O=Math.ceil(this.options.minZoom),B=Oi({maxZoom:M,minZoom:O,zoomOffset:x,tileSize:c,zoom:r,latLonBounds:a,extent:g});return B}},{key:"getTileId",value:function(r,a,u){var c="".concat(r,",").concat(a,",").concat(u);return c}},{key:"loadFinished",value:function(){var r=!this.currentTiles.some(function(a){return!a.isDone});return r&&this.emit(qo.TilesLoadFinished),r}},{key:"getTile",value:function(r,a,u){var c=this.getTileId(r,a,u),g=this.cacheTiles.get(c);return g}},{key:"createTile",value:function(r,a,u){var c=this.getTileId(r,a,u),g=new Si({x:r,y:a,z:u,tileSize:this.options.tileSize,warp:this.options.warp});return this.cacheTiles.set(c,g),g.loadData({getData:this.options.getTileData,onLoad:this.onTileLoad,onError:this.onTileError}),g}},{key:"resizeCacheTiles",value:function(){var r=Ui*this.currentTiles.length,a=this.cacheTiles.size>r;if(a){var u=li(this.cacheTiles),c;try{for(u.s();!(c=u.n()).done;){var g=(0,vn.Z)(c.value,2),x=g[0],M=g[1];if(!M.isVisible&&!this.currentTiles.includes(M)&&(this.cacheTiles.delete(x),this.onTileUnload(M)),this.cacheTiles.size<=r)break}}catch(O){u.e(O)}finally{u.f()}}this.rebuildTileTree()}},{key:"rebuildTileTree",value:function(){var r=li(this.cacheTiles.values()),a;try{for(r.s();!(a=r.n()).done;){var u=a.value;u.parent=null,u.children.length=0}}catch(O){r.e(O)}finally{r.f()}var c=li(this.cacheTiles.values()),g;try{for(c.s();!(g=c.n()).done;){var x=g.value,M=this.getNearestAncestor(x.x,x.y,x.z);x.parent=M,M!=null&&M.children&&M.children.push(x)}}catch(O){c.e(O)}finally{c.f()}}},{key:"getNearestAncestor",value:function(r,a,u){for(;u>this.options.minZoom;){r=Math.floor(r/2),a=Math.floor(a/2),u=u-1;var c=this.getTile(r,a,u);if(c)return c}return null}}]),t}(Ys());function du(e){return/(?=.*{box})(?=.*{z})(?=.*{x})(?=.*({y}|{-y}))/.test(e)}function vs(e){var i=[],t=/\{([a-z])-([a-z])\}/.exec(e);if(t){var n=t[1].charCodeAt(0),r=t[2].charCodeAt(0),a;for(a=n;a<=r;++a)i.push(e.replace(t[0],String.fromCharCode(a)));return i}if(t=/\{(\d+)-(\d+)\}/.exec(e),t){for(var u=parseInt(t[2],10),c=parseInt(t[1],10);c<=u;c++)i.push(e.replace(t[0],c.toString()));return i}return i.push(e),i}function bl(e,i){if(!e||!e.length)throw new Error("url is not allowed to be empty");var t=i.x,n=i.y,r=i.z,a=vs(e),u=Math.abs(t+n)%a.length,c=Jr(a[u])?"".concat(a[u],"/{z}/{x}/{y}"):a[u];return c.replace(/\{x\}/g,t.toString()).replace(/\{y\}/g,n.toString()).replace(/\{z\}/g,r.toString()).replace(/\{bbox\}/g,Li(t,n,r).join(",")).replace(/\{-y\}/g,(Math.pow(2,r)-n-1).toString())}function gs(e,i){var t=i.x,n=i.y,r=i.z,a=i.layer,u=i.version,c=u===void 0?"1.0.0":u,g=i.style,x=g===void 0?"default":g,M=i.format,O=i.service,B=O===void 0?"WMTS":O,W=i.tileMatrixset,ce="".concat(e,"&SERVICE=").concat(B,"&REQUEST=GetTile&VERSION=").concat(c,"&LAYER=").concat(a,"&STYLE=").concat(x,"&TILEMATRIXSET=").concat(W,"&FORMAT=").concat(M,"&TILECOL=").concat(t,"&TILEROW=").concat(n,"&TILEMATRIX=").concat(r);return ce}function Da(e,i){if(!e)throw new Error(i||"web worker helper assertion failed.")}var il={self:typeof self!="undefined"&&self,window:typeof window!="undefined"&&window,document:typeof document!="undefined"&&document},tf=il.self||il.window||{},o=il.window||il.self||{},s=il.self||il.window||{},d=il.document||{},_=typeof importScripts=="function",w=typeof window!="undefined"&&typeof window.orientation!="undefined",j=function(){function e(i,t){var n=this;this.name=i,this.workerThread=t,this.isRunning=!0,this.resolve=function(){},this.reject=function(){},this.result=new Promise(function(r,a){n.resolve=r,n.reject=a})}return e.prototype.postMessage=function(i,t){this.workerThread.postMessage({source:"Main thread",type:i,payload:t})},e.prototype.done=function(i){Da(this.isRunning,"WorkerJob isRunning false."),this.isRunning=!1,this.resolve(i)},e.prototype.error=function(i){Da(this.isRunning,"WorkerJob isRunning false."),this.isRunning=!1,this.reject(i)},e}(),ie=j,ke=new Map;function tt(e){Da(e.source&&!e.url||!e.source&&e.url);var i=ke.get(e.source||e.url);return i||(e.url&&(i=Pt(e.url),ke.set(e.url,i)),e.source&&(i=tr(e.source),ke.set(e.source,i))),Da(i),i}function Pt(e){if(!e.startsWith("http"))return e;var i=st(e);return tr(i)}function tr(e){var i=new Blob([e],{type:"application/javascript"});return URL.createObjectURL(i)}function st(e){return`try {
  importScripts('`+e+`');
} catch (error) {
  console.error(error);
  throw error;
}`}function Zt(e,i,t){i===void 0&&(i=!0);var n=t||new Set;if(e){if(Jt(e))n.add(e);else if(Jt(e.buffer))n.add(e.buffer);else if(!ArrayBuffer.isView(e)){if(i&&typeof e=="object")for(var r in e)Zt(e[r],i,n)}}return t===void 0?Array.from(n):[]}function Jt(e){return e?e instanceof ArrayBuffer||typeof MessagePort!="undefined"&&e instanceof MessagePort||typeof ImageBitmap!="undefined"&&e instanceof ImageBitmap||typeof OffscreenCanvas!="undefined"&&e instanceof OffscreenCanvas:!1}var yr=function(){},v=function(){function e(i){this.terminated=!1,this.loadableURL="";var t=i.name,n=i.source,r=i.url;Da(n||r),this.name=t,this.source=n,this.url=r,this.onMessage=yr,this.onError=function(a){return console.log(a)},this.worker=this.createBrowserWorker()}return e.isSupported=function(){return typeof Worker!="undefined"},e.prototype.destroy=function(){this.onMessage=yr,this.onError=yr,this.worker.terminate(),this.terminated=!0},Object.defineProperty(e.prototype,"isRunning",{get:function(){return!!this.onMessage},enumerable:!1,configurable:!0}),e.prototype.postMessage=function(i,t){t=t||Zt(i),this.worker.postMessage(i,t)},e.prototype.getErrorFromErrorEvent=function(i){var t="Failed to load ";return t+="worker "+this.name+" from "+this.url+". ",i.message&&(t+=i.message+" in "),i.lineno&&(t+=":"+i.lineno+":"+i.colno),new Error(t)},e.prototype.createBrowserWorker=function(){var i=this;this.loadableURL=tt({source:this.source,url:this.url});var t=new Worker(this.loadableURL,{name:this.name});return t.onmessage=function(n){n.data?i.onMessage(n.data):i.onError(new Error("No data received"))},t.onerror=function(n){i.onError(i.getErrorFromErrorEvent(n)),i.terminated=!0},t.onmessageerror=function(n){return console.error("worker "+i.name+", message error: "+n)},t},e}(),Pn=v,jn=function(){return jn=Object.assign||function(e){for(var i,t=1,n=arguments.length;t<n;t++){i=arguments[t];for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(e[r]=i[r])}return e},jn.apply(this,arguments)},Xe=function(e,i,t,n){function r(a){return a instanceof t?a:new t(function(u){u(a)})}return new(t||(t=Promise))(function(a,u){function c(M){try{x(n.next(M))}catch(O){u(O)}}function g(M){try{x(n.throw(M))}catch(O){u(O)}}function x(M){M.done?a(M.value):r(M.value).then(c,g)}x((n=n.apply(e,i||[])).next())})},Ia=function(e,i){var t={label:0,sent:function(){if(a[0]&1)throw a[1];return a[1]},trys:[],ops:[]},n,r,a,u;return u={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(u[Symbol.iterator]=function(){return this}),u;function c(x){return function(M){return g([x,M])}}function g(x){if(n)throw new TypeError("Generator is already executing.");for(;t;)try{if(n=1,r&&(a=x[0]&2?r.return:x[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,x[1])).done)return a;switch(r=0,a&&(x=[x[0]&2,a.value]),x[0]){case 0:case 1:a=x;break;case 4:return t.label++,{value:x[1],done:!1};case 5:t.label++,r=x[1],x=[0];continue;case 7:x=t.ops.pop(),t.trys.pop();continue;default:if(a=t.trys,!(a=a.length>0&&a[a.length-1])&&(x[0]===6||x[0]===2)){t=0;continue}if(x[0]===3&&(!a||x[1]>a[0]&&x[1]<a[3])){t.label=x[1];break}if(x[0]===6&&t.label<a[1]){t.label=a[1],a=x;break}if(a&&t.label<a[2]){t.label=a[2],t.ops.push(x);break}a[2]&&t.ops.pop(),t.trys.pop();continue}x=i.call(e,t)}catch(M){x=[6,M],r=0}finally{n=a=0}if(x[0]&5)throw x[1];return{value:x[0]?x[1]:void 0,done:!0}}},ao=function(){function e(i){this.name="unnamed",this.maxConcurrency=1,this.maxMobileConcurrency=1,this.onDebug=function(){},this.reuseWorkers=!0,this.props={},this.jobQueue=[],this.idleQueue=[],this.count=0,this.isDestroyed=!1,this.source=i.source,this.url=i.url,this.setProps(i)}return e.prototype.destroy=function(){this.idleQueue.forEach(function(i){return i.destroy()}),this.isDestroyed=!0},e.prototype.setProps=function(i){this.props=jn(jn({},this.props),i),i.name!==void 0&&(this.name=i.name),i.maxConcurrency!==void 0&&(this.maxConcurrency=i.maxConcurrency),i.maxMobileConcurrency!==void 0&&(this.maxMobileConcurrency=i.maxMobileConcurrency),i.reuseWorkers!==void 0&&(this.reuseWorkers=i.reuseWorkers),i.onDebug!==void 0&&(this.onDebug=i.onDebug)},e.prototype.startJob=function(i,t,n){return t===void 0&&(t=function(r,a,u){return r.done(u)}),n===void 0&&(n=function(r,a){return r.error(a)}),Xe(this,void 0,void 0,function(){var r,a=this;return Ia(this,function(u){switch(u.label){case 0:return r=new Promise(function(c){return a.jobQueue.push({name:i,onMessage:t,onError:n,onStart:c}),a}),this.startQueuedJob(),[4,r];case 1:return[2,u.sent()]}})})},e.prototype.startQueuedJob=function(){return Xe(this,void 0,void 0,function(){var i,t,n;return Ia(this,function(r){switch(r.label){case 0:if(!this.jobQueue.length)return[2];if(i=this.getAvailableWorker(),!i)return[2];if(t=this.jobQueue.shift(),!t)return[3,4];this.onDebug({message:"Starting job",name:t.name,backlog:this.jobQueue.length,workerThread:i}),n=new ie(t.name,i),i.onMessage=function(a){return t.onMessage(n,a.type,a.payload)},i.onError=function(a){return t.onError(n,a)},t.onStart(n),r.label=1;case 1:return r.trys.push([1,,3,4]),[4,n.result];case 2:return r.sent(),[3,4];case 3:return this.returnWorkerToQueue(i),[7];case 4:return[2]}})})},e.prototype.returnWorkerToQueue=function(i){var t=this.isDestroyed||!this.reuseWorkers||this.count>this.getMaxConcurrency();t?(i.destroy(),this.count--):this.idleQueue.push(i),this.isDestroyed||this.startQueuedJob()},e.prototype.getAvailableWorker=function(){if(this.idleQueue.length>0)return this.idleQueue.shift()||null;if(this.count<this.getMaxConcurrency()){this.count++;var i=this.name.toLowerCase()+" (#"+this.count+" of "+this.maxConcurrency+")";return new Pn({name:i,source:this.source,url:this.url})}return null},e.prototype.getMaxConcurrency=function(){return w?this.maxMobileConcurrency:this.maxConcurrency},e}(),xo=ao,sa=function(){return sa=Object.assign||function(e){for(var i,t=1,n=arguments.length;t<n;t++){i=arguments[t];for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(e[r]=i[r])}return e},sa.apply(this,arguments)},ka=function(e){var i=typeof Symbol=="function"&&Symbol.iterator,t=i&&e[i],n=0;if(t)return t.call(e);if(e&&typeof e.length=="number")return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(i?"Object is not iterable.":"Symbol.iterator is not defined.")},os={maxConcurrency:3,maxMobileConcurrency:1,onDebug:function(){},reuseWorkers:!0},ba=function(){function e(i){this.workerPools=new Map,this.props=sa({},os),this.setProps(i),this.workerPools=new Map}return e.isSupported=function(){return Pn.isSupported()},e.getWorkerFarm=function(i){return i===void 0&&(i={}),e.workerFarm=e.workerFarm||new e({}),e.workerFarm.setProps(i),e.workerFarm},e.prototype.destroy=function(){var i,t;try{for(var n=ka(this.workerPools.values()),r=n.next();!r.done;r=n.next()){var a=r.value;a.destroy()}}catch(u){i={error:u}}finally{try{r&&!r.done&&(t=n.return)&&t.call(n)}finally{if(i)throw i.error}}},e.prototype.setProps=function(i){var t,n;this.props=sa(sa({},this.props),i);try{for(var r=ka(this.workerPools.values()),a=r.next();!a.done;a=r.next()){var u=a.value;u.setProps(this.getWorkerPoolProps())}}catch(c){t={error:c}}finally{try{a&&!a.done&&(n=r.return)&&n.call(r)}finally{if(t)throw t.error}}},e.prototype.getWorkerPool=function(i){var t=i.name,n=i.source,r=i.url,a=this.workerPools.get(t);return a||(a=new xo({name:t,source:n,url:r}),a.setProps(this.getWorkerPoolProps()),this.workerPools.set(t,a)),a},e.prototype.getWorkerPoolProps=function(){return{maxConcurrency:this.props.maxConcurrency,maxMobileConcurrency:this.props.maxMobileConcurrency,reuseWorkers:this.props.reuseWorkers,onDebug:this.props.onDebug}},e}(),Vr=null,hn=new Map,Yn=function(){function e(){}return Object.defineProperty(e,"onmessage",{set:function(i){self.onmessage=function(t){if(Kn(t)){var n=t.data,r=n.type,a=n.payload;i(r,a)}}},enumerable:!1,configurable:!0}),e.addEventListener=function(i){var t=hn.get(i);t||(t=function(n){if(Kn(n)){var r=n.data,a=r.type,u=r.payload;i(a,u)}}),self.addEventListener("message",t)},e.removeEventListener=function(i){var t=hn.get(i);hn.delete(i),self.removeEventListener("message",t)},e.postMessage=function(i,t){if(self){var n={source:"Worker thread",type:i,payload:t},r=Zt(t);self.postMessage(n,r)}},e}(),Dn=null;function Kn(e){var i=e.type,t=e.data;return i==="message"&&t&&typeof t.source=="string"&&t.source==="Main thread"}function Ln(e){return JSON.parse(Fi(e))}function Fi(e){var i=new Set;return JSON.stringify(e,function(t,n){if(typeof n=="object"&&n!==null){if(i.has(n))try{return JSON.parse(JSON.stringify(n))}catch(r){return}i.add(n)}return n})}function wi(e){return""+e.name}function An(e,i){i===void 0&&(i={});var t=i[e.id]||{},n=e.name+".worker.js",r=t.workerUrl;return i._workerType==="test"&&(r=e.module+"/dist/"+n),r||(r="https://unpkg.com/"+e.module+"/dist/"+n),assert(r),r}var Ge=function(e,i,t,n){function r(a){return a instanceof t?a:new t(function(u){u(a)})}return new(t||(t=Promise))(function(a,u){function c(M){try{x(n.next(M))}catch(O){u(O)}}function g(M){try{x(n.throw(M))}catch(O){u(O)}}function x(M){M.done?a(M.value):r(M.value).then(c,g)}x((n=n.apply(e,i||[])).next())})},al=function(e,i){var t={label:0,sent:function(){if(a[0]&1)throw a[1];return a[1]},trys:[],ops:[]},n,r,a,u;return u={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(u[Symbol.iterator]=function(){return this}),u;function c(x){return function(M){return g([x,M])}}function g(x){if(n)throw new TypeError("Generator is already executing.");for(;t;)try{if(n=1,r&&(a=x[0]&2?r.return:x[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,x[1])).done)return a;switch(r=0,a&&(x=[x[0]&2,a.value]),x[0]){case 0:case 1:a=x;break;case 4:return t.label++,{value:x[1],done:!1};case 5:t.label++,r=x[1],x=[0];continue;case 7:x=t.ops.pop(),t.trys.pop();continue;default:if(a=t.trys,!(a=a.length>0&&a[a.length-1])&&(x[0]===6||x[0]===2)){t=0;continue}if(x[0]===3&&(!a||x[1]>a[0]&&x[1]<a[3])){t.label=x[1];break}if(x[0]===6&&t.label<a[1]){t.label=a[1],a=x;break}if(a&&t.label<a[2]){t.label=a[2],t.ops.push(x);break}a[2]&&t.ops.pop(),t.trys.pop();continue}x=i.call(e,t)}catch(M){x=[6,M],r=0}finally{n=a=0}if(x[0]&5)throw x[1];return{value:x[0]?x[1]:void 0,done:!0}}};function Bi(e,i){return WorkerFarm.isSupported()?e.worker&&(i==null?void 0:i.worker):!1}function lt(e,i,t,n){return t===void 0&&(t={}),n===void 0&&(n={}),Ge(this,void 0,void 0,function(){var r,a,u,c,g,x,M,O;return al(this,function(B){switch(B.label){case 0:return r=getWorkerName(e),a=getWorkerURL(e,t),u=WorkerFarm.getWorkerFarm(t),c=u.getWorkerPool({name:r,url:a}),g=t.jobName||e.name,[4,c.startJob(g,ii.bind(null,n))];case 1:return x=B.sent(),M=removeNontransferableOptions(t),x.postMessage("process",{input:i,options:M}),[4,x.result];case 2:return O=B.sent(),[2,O.result]}})})}function ii(e,i,t,n){return Ge(this,void 0,void 0,function(){var r,a,u,c,g,x,M;return al(this,function(O){switch(O.label){case 0:switch(r=t,r){case"done":return[3,1];case"error":return[3,2];case"process":return[3,3]}return[3,8];case 1:return i.done(n),[3,9];case 2:return i.error(new Error(n.error)),[3,9];case 3:a=n.id,u=n.input,c=n.options,O.label=4;case 4:return O.trys.push([4,6,,7]),e.process?[4,e.process(u,c)]:(i.postMessage("error",{id:a,error:"Worker not set up to process on main thread"}),[2]);case 5:return g=O.sent(),i.postMessage("done",{id:a,result:g}),[3,7];case 6:return x=O.sent(),M=x instanceof Error?x.message:"unknown error",i.postMessage("error",{id:a,error:M}),[3,7];case 7:return[3,9];case 8:console.warn("process-on-worker: unknown message "+t),O.label=9;case 9:return[2]}})})}var xc=function(){function e(){this._values=[],this._settlers=[],this._closed=!1}return e.prototype[Symbol.asyncIterator]=function(){return this},e.prototype.push=function(i){return this.enqueue(i)},e.prototype.enqueue=function(i){if(this._closed)throw new Error("Closed");if(this._settlers.length>0){if(this._values.length>0)throw new Error("Illegal internal state");var t=this._settlers.shift();i instanceof Error?t.reject(i):t.resolve({value:i})}else this._values.push(i)},e.prototype.close=function(){for(;this._settlers.length>0;){var i=this._settlers.shift();i.resolve({done:!0})}this._closed=!0},e.prototype.next=function(){var i=this;if(this._values.length>0){var t=this._values.shift();return t instanceof Error?Promise.reject(t):Promise.resolve({done:!1,value:t})}if(this._closed){if(this._settlers.length>0)throw new Error("Illegal internal state");return Promise.resolve({done:!0,value:void 0})}return new Promise(function(n,r){i._settlers.push({resolve:n,reject:r})})},e}(),Eh=null,Ec=function(e,i,t,n){function r(a){return a instanceof t?a:new t(function(u){u(a)})}return new(t||(t=Promise))(function(a,u){function c(M){try{x(n.next(M))}catch(O){u(O)}}function g(M){try{x(n.throw(M))}catch(O){u(O)}}function x(M){M.done?a(M.value):r(M.value).then(c,g)}x((n=n.apply(e,i||[])).next())})},s0=function(e,i){var t={label:0,sent:function(){if(a[0]&1)throw a[1];return a[1]},trys:[],ops:[]},n,r,a,u;return u={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(u[Symbol.iterator]=function(){return this}),u;function c(x){return function(M){return g([x,M])}}function g(x){if(n)throw new TypeError("Generator is already executing.");for(;t;)try{if(n=1,r&&(a=x[0]&2?r.return:x[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,x[1])).done)return a;switch(r=0,a&&(x=[x[0]&2,a.value]),x[0]){case 0:case 1:a=x;break;case 4:return t.label++,{value:x[1],done:!1};case 5:t.label++,r=x[1],x=[0];continue;case 7:x=t.ops.pop(),t.trys.pop();continue;default:if(a=t.trys,!(a=a.length>0&&a[a.length-1])&&(x[0]===6||x[0]===2)){t=0;continue}if(x[0]===3&&(!a||x[1]>a[0]&&x[1]<a[3])){t.label=x[1];break}if(x[0]===6&&t.label<a[1]){t.label=a[1],a=x;break}if(a&&t.label<a[2]){t.label=a[2],t.ops.push(x);break}a[2]&&t.ops.pop(),t.trys.pop();continue}x=i.call(e,t)}catch(M){x=[6,M],r=0}finally{n=a=0}if(x[0]&5)throw x[1];return{value:x[0]?x[1]:void 0,done:!0}}},rf=function(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i=e[Symbol.asyncIterator],t;return i?i.call(e):(e=typeof __values=="function"?__values(e):e[Symbol.iterator](),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(a){t[a]=e[a]&&function(u){return new Promise(function(c,g){u=e[a](u),r(c,g,u.done,u.value)})}}function r(a,u,c,g){Promise.resolve(g).then(function(x){a({value:x,done:c})},u)}},Je=0,bc,Ef;function u0(e,i){var t=this;if(typeof self!="undefined"){var n={process:Bf};WorkerBody.onmessage=function(r,a){return Ec(t,void 0,void 0,function(){var u,c,g,x,M,O,B,W,ce,oe,Te;return s0(this,function(Ze){switch(Ze.label){case 0:switch(Ze.trys.push([0,19,,20]),u=r,u){case"process":return[3,1];case"process-in-batches":return[3,3];case"input-batch":return[3,16];case"input-done":return[3,17]}return[3,18];case 1:if(!e)throw new Error("Worker does not support atomic processing");return[4,e(a.input,a.options||{},n)];case 2:return c=Ze.sent(),WorkerBody.postMessage("done",{result:c}),[3,18];case 3:if(!i)throw new Error("Worker does not support batched processing");bc=new AsyncQueue,Ef=a.options||{},g=i(bc,Ef,n),Ze.label=4;case 4:Ze.trys.push([4,9,10,15]),x=rf(g),Ze.label=5;case 5:return[4,x.next()];case 6:if(M=Ze.sent(),!!M.done)return[3,8];O=M.value,WorkerBody.postMessage("output-batch",{result:O}),Ze.label=7;case 7:return[3,5];case 8:return[3,15];case 9:return B=Ze.sent(),oe={error:B},[3,15];case 10:return Ze.trys.push([10,,13,14]),M&&!M.done&&(Te=x.return)?[4,Te.call(x)]:[3,12];case 11:Ze.sent(),Ze.label=12;case 12:return[3,14];case 13:if(oe)throw oe.error;return[7];case 14:return[7];case 15:return WorkerBody.postMessage("done",{}),[3,18];case 16:return bc.push(a.input),[3,18];case 17:return bc.close(),[3,18];case 18:return[3,20];case 19:return W=Ze.sent(),ce=W instanceof Error?W.message:"",WorkerBody.postMessage("error",{error:ce}),[3,20];case 20:return[2]}})})}}}function Bf(e,i){return i===void 0&&(i={}),new Promise(function(t,n){var r=Je++,a=function(c,g){if(g.id===r)switch(c){case"done":WorkerBody.removeEventListener(a),t(g.result);break;case"error":WorkerBody.removeEventListener(a),n(g.error);break;default:}};WorkerBody.addEventListener(a);var u={id:r,input:e,options:i};WorkerBody.postMessage("process",u)})}var nf=function(e,i,t,n){function r(a){return a instanceof t?a:new t(function(u){u(a)})}return new(t||(t=Promise))(function(a,u){function c(M){try{x(n.next(M))}catch(O){u(O)}}function g(M){try{x(n.throw(M))}catch(O){u(O)}}function x(M){M.done?a(M.value):r(M.value).then(c,g)}x((n=n.apply(e,i||[])).next())})},l0=function(e,i){var t={label:0,sent:function(){if(a[0]&1)throw a[1];return a[1]},trys:[],ops:[]},n,r,a,u;return u={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(u[Symbol.iterator]=function(){return this}),u;function c(x){return function(M){return g([x,M])}}function g(x){if(n)throw new TypeError("Generator is already executing.");for(;t;)try{if(n=1,r&&(a=x[0]&2?r.return:x[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,x[1])).done)return a;switch(r=0,a&&(x=[x[0]&2,a.value]),x[0]){case 0:case 1:a=x;break;case 4:return t.label++,{value:x[1],done:!1};case 5:t.label++,r=x[1],x=[0];continue;case 7:x=t.ops.pop(),t.trys.pop();continue;default:if(a=t.trys,!(a=a.length>0&&a[a.length-1])&&(x[0]===6||x[0]===2)){t=0;continue}if(x[0]===3&&(!a||x[1]>a[0]&&x[1]<a[3])){t.label=x[1];break}if(x[0]===6&&t.label<a[1]){t.label=a[1],a=x;break}if(a&&t.label<a[2]){t.label=a[2],t.ops.push(x);break}a[2]&&t.ops.pop(),t.trys.pop();continue}x=i.call(e,t)}catch(M){x=[6,M],r=0}finally{n=a=0}if(x[0]&5)throw x[1];return{value:x[0]?x[1]:void 0,done:!0}}},bf={};function U0(e,i,t){return i===void 0&&(i=null),t===void 0&&(t={}),nf(this,void 0,void 0,function(){return l0(this,function(n){switch(n.label){case 0:return i&&(e=c0(e,i,t)),bf[e]=bf[e]||zu(e),[4,bf[e]];case 1:return[2,n.sent()]}})})}function c0(e,i,t){if(e.startsWith("http"))return e;var n=t.modules||{};return n[e]?n[e]:t.CDN?(assert(t.CDN.startsWith("http")),t.CDN+"/"+i+"/dist/libs/"+e):isWorker?"../src/libs/"+e:"modules/"+i+"/src/libs/"+e}function zu(e){return nf(this,void 0,void 0,function(){var i,t,n;return l0(this,function(r){switch(r.label){case 0:return e.endsWith("wasm")?[4,fetch(e)]:[3,3];case 1:return i=r.sent(),[4,i.arrayBuffer()];case 2:return[2,r.sent()];case 3:return isWorker?[2,importScripts(e)]:[4,fetch(e)];case 4:return t=r.sent(),[4,t.text()];case 5:return n=r.sent(),[2,Uo(n,e)]}})})}function Uo(e,i){if(isWorker)return eval.call(global,e),null;var t=document.createElement("script");t.id=i;try{t.appendChild(document.createTextNode(e))}catch(n){t.text=e}return document.body.appendChild(t),null}var Zf="0.0.3",bh={id:"null",name:"null",module:"web-worker-helper",options:{}};function zf(e){var i=e.color;return!i||!i.length?[1,1,1,1]:i}function Nl(e,i,t){return t.length===2?[t[0],t[1],0]:[t[0],t[1],t[2]]}function Sc(e){var i=e.filter;return i?[1]:[0]}function af(e,i){return[i]}var f0=C(9187),oa=C.n(f0),Ua=1e-6,Go=typeof Float32Array!="undefined"?Float32Array:Array,Uf=Math.random;function G0(e){Go=e}var Gf=Math.PI/180;function h0(e){return e*Gf}function jf(e,i){return Math.abs(e-i)<=Ua*Math.max(1,Math.abs(e),Math.abs(i))}Math.hypot||(Math.hypot=function(){for(var e=0,i=arguments.length;i--;)e+=arguments[i]*arguments[i];return Math.sqrt(e)});function Xi(){var e=new Go(2);return Go!=Float32Array&&(e[0]=0,e[1]=0),e}function Vf(e){var i=new glMatrix.ARRAY_TYPE(2);return i[0]=e[0],i[1]=e[1],i}function Fl(e,i){var t=new Go(2);return t[0]=e,t[1]=i,t}function au(e,i){return e[0]=i[0],e[1]=i[1],e}function ic(e,i,t){return e[0]=i,e[1]=t,e}function oo(e,i,t){return e[0]=i[0]+t[0],e[1]=i[1]+t[1],e}function Uu(e,i,t){return e[0]=i[0]-t[0],e[1]=i[1]-t[1],e}function Bl(e,i,t){return e[0]=i[0]*t[0],e[1]=i[1]*t[1],e}function Sf(e,i,t){return e[0]=i[0]/t[0],e[1]=i[1]/t[1],e}function Mo(e,i){return e[0]=Math.ceil(i[0]),e[1]=Math.ceil(i[1]),e}function ol(e,i){return e[0]=Math.floor(i[0]),e[1]=Math.floor(i[1]),e}function ss(e,i,t){return e[0]=Math.min(i[0],t[0]),e[1]=Math.min(i[1],t[1]),e}function ac(e,i,t){return e[0]=Math.max(i[0],t[0]),e[1]=Math.max(i[1],t[1]),e}function Cc(e,i){return e[0]=Math.round(i[0]),e[1]=Math.round(i[1]),e}function Zl(e,i,t){return e[0]=i[0]*t,e[1]=i[1]*t,e}function A0(e,i,t,n){return e[0]=i[0]+t[0]*n,e[1]=i[1]+t[1]*n,e}function Hf(e,i){var t=i[0]-e[0],n=i[1]-e[1];return Math.hypot(t,n)}function of(e,i){var t=i[0]-e[0],n=i[1]-e[1];return t*t+n*n}function $f(e){var i=e[0],t=e[1];return Math.hypot(i,t)}function wc(e){var i=e[0],t=e[1];return i*i+t*t}function Tu(e,i){return e[0]=-i[0],e[1]=-i[1],e}function Tc(e,i){return e[0]=1/i[0],e[1]=1/i[1],e}function Gu(e,i){var t=i[0],n=i[1],r=t*t+n*n;return r>0&&(r=1/Math.sqrt(r)),e[0]=i[0]*r,e[1]=i[1]*r,e}function sl(e,i){return e[0]*i[0]+e[1]*i[1]}function Mc(e,i,t){var n=i[0]*t[1]-i[1]*t[0];return e[0]=e[1]=0,e[2]=n,e}function Sl(e,i,t,n){var r=i[0],a=i[1];return e[0]=r+n*(t[0]-r),e[1]=a+n*(t[1]-a),e}function p0(e,i){i=i||1;var t=glMatrix.RANDOM()*2*Math.PI;return e[0]=Math.cos(t)*i,e[1]=Math.sin(t)*i,e}function j0(e,i,t){var n=i[0],r=i[1];return e[0]=t[0]*n+t[2]*r,e[1]=t[1]*n+t[3]*r,e}function oc(e,i,t){var n=i[0],r=i[1];return e[0]=t[0]*n+t[2]*r+t[4],e[1]=t[1]*n+t[3]*r+t[5],e}function Sh(e,i,t){var n=i[0],r=i[1];return e[0]=t[0]*n+t[3]*r+t[6],e[1]=t[1]*n+t[4]*r+t[7],e}function Ch(e,i,t){var n=i[0],r=i[1];return e[0]=t[0]*n+t[4]*r+t[12],e[1]=t[1]*n+t[5]*r+t[13],e}function V0(e,i,t,n){var r=i[0]-t[0],a=i[1]-t[1],u=Math.sin(n),c=Math.cos(n);return e[0]=r*c-a*u+t[0],e[1]=r*u+a*c+t[1],e}function d0(e,i){var t=e[0],n=e[1],r=i[0],a=i[1],u=Math.sqrt(t*t+n*n)*Math.sqrt(r*r+a*a),c=u&&(t*r+n*a)/u;return Math.acos(Math.min(Math.max(c,-1),1))}function v0(e){return e[0]=0,e[1]=0,e}function wh(e){return"vec2("+e[0]+", "+e[1]+")"}function yA(e,i){return e[0]===i[0]&&e[1]===i[1]}function H0(e,i){var t=e[0],n=e[1],r=i[0],a=i[1];return Math.abs(t-r)<=glMatrix.EPSILON*Math.max(1,Math.abs(t),Math.abs(r))&&Math.abs(n-a)<=glMatrix.EPSILON*Math.max(1,Math.abs(n),Math.abs(a))}var Th=null,sc=Uu,$0=null,Cf=null,_A=null,xA=null,Y0=null,Ic=function(){var e=Xi();return function(i,t,n,r,a,u){var c,g;for(t||(t=2),n||(n=0),r?g=Math.min(r*t+n,i.length):g=i.length,c=n;c<g;c+=t)e[0]=i[c],e[1]=i[c+1],a(e,e,u),i[c]=e[0],i[c+1]=e[1];return i}}(),Pc=Xi(),wf=Xi(),Eo=Xi(),Xs=Xi(),zl=Xi();function uc(e,i,t,n,r){oo(e,t,n),Gu(e,e),i=Fl(-e[1],e[0]);var a=Fl(-t[1],t[0]);return[r/sl(i,a),i]}function ul(e,i){return ic(e,-i[1],i[0])}function Ul(e,i,t){return sc(e,i,t),Gu(e,e),e}function Lc(e,i){return e[0]===i[0]&&e[1]===i[1]}function sf(e){for(var i=new Map,t=0;t<e.length;t++){var n=e[0].toString()+"-"+e[1].toString();i.get(n)?(e.splice(t,1),t++):i.set(n,n)}return e}var Gl=function(){function e(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};(0,se.Z)(this,e),(0,Me.Z)(this,"lastFlip",-1),(0,Me.Z)(this,"miter",Fl(0,0)),(0,Me.Z)(this,"started",!1),(0,Me.Z)(this,"dash",!1),(0,Me.Z)(this,"totalDistance",0),(0,Me.Z)(this,"currentIndex",0),this.join=i.join||"miter",this.cap=i.cap||"butt",this.miterLimit=i.miterLimit||10,this.thickness=i.thickness||1,this.dash=i.dash||!1,this.complex={positions:[],indices:[],normals:[],startIndex:0,indexes:[]}}return(0,be.Z)(e,[{key:"extrude_gaode2",value:function(t,n){var r=this.complex;if(t.length<=1)return r;this.lastFlip=-1,this.started=!1,this.normal=null,this.totalDistance=0;for(var a=t.length,u=r.startIndex,c=1;c<a;c++){var g,x,M,O=t[c-1];O.push((g=n[c-1][2])!==null&&g!==void 0?g:0);var B=n[c-1],W=t[c];W.push((x=n[c][2])!==null&&x!==void 0?x:0);var ce=n[c],oe=c<t.length-1?[].concat((0,pr.Z)(t[c+1]),[(M=n[c+1][2])!==null&&M!==void 0?M:0]):null,Te=c<n.length-1?n[c+1]:null,Ze=this.segment_gaode2(r,u,O,W,oe,B,ce,Te);u+=Ze}if(this.dash)for(var qe=0;qe<r.positions.length/6;qe++)r.positions[qe*6+5]=this.totalDistance;return r.startIndex=r.positions.length/6,r}},{key:"simpleExtrude_gaode2",value:function(t,n){var r=this.complex;if(t.length<=1)return r;this.lastFlip=-1,this.started=!1,this.normal=null,this.totalDistance=0;for(var a=t.length,u=r.startIndex,c=1;c<a;c++){var g,x,M,O=t[c-1];O.push((g=n[c-1][2])!==null&&g!==void 0?g:0);var B=n[c-1],W=t[c];W.push((x=n[c][2])!==null&&x!==void 0?x:0);var ce=n[c],oe=c<t.length-1?[].concat((0,pr.Z)(t[c+1]),[(M=n[c+1][2])!==null&&M!==void 0?M:0]):null,Te=c<n.length-1?n[c+1]:null,Ze=this.simpleSegment(r,u,O,W,oe,B,ce,Te);u+=Ze}if(this.dash)for(var qe=0;qe<r.positions.length/6;qe++)r.positions[qe*6+5]=this.totalDistance;return r.startIndex=r.positions.length/6,r}},{key:"extrude",value:function(t){var n=this.complex;if(t.length<=1)return n;this.lastFlip=-1,this.started=!1,this.normal=null,this.totalDistance=0;for(var r=t.length,a=n.startIndex,u=1;u<r;u++){var c=t[u-1],g=t[u],x=u<t.length-1?t[u+1]:null,M=this.segment(n,a,c,g,x);a+=M}if(this.dash)for(var O=0;O<n.positions.length/6;O++)n.positions[O*6+5]=this.totalDistance;return n.startIndex=n.positions.length/6,n}},{key:"simpleExtrude",value:function(t){var n=this.complex;if(t.length<=1)return n;this.lastFlip=-1,this.started=!1,this.normal=null,this.totalDistance=0;for(var r=t.length,a=n.startIndex,u=1;u<r;u++){var c=t[u-1],g=t[u],x=u<t.length-1?t[u+1]:null,M=this.simpleSegment(n,a,c,g,x);a+=M}if(this.dash)for(var O=0;O<n.positions.length/6;O++)n.positions[O*6+5]=this.totalDistance;return n.startIndex=n.positions.length/6,n}},{key:"segment_gaode2",value:function(t,n,r,a,u,c,g,x){var M=0,O=t.indices,B=t.positions,W=t.normals,ce=this.cap==="square",oe=this.join==="bevel",Te=ma([g[0],g[1]]),Ze=ma([c[0],c[1]]);Ul(Eo,a,r);var qe=0;if(this.dash&&(qe=this.lineSegmentDistance(Te,Ze),this.totalDistance+=qe),this.normal||(this.normal=Xi(),ul(this.normal,Eo)),!this.started)if(this.started=!0,ce){var et=Xi(),yt=Xi();oo(et,this.normal,Eo),oo(yt,this.normal,Eo),W.push(yt[0],yt[1],0),W.push(et[0],et[1],0),B.push(r[0],r[1],r[2]|0,this.totalDistance-qe,-this.thickness,r[2]|0),this.complex.indexes.push(this.currentIndex),B.push(r[0],r[1],r[2]|0,this.totalDistance-qe,this.thickness,r[2]|0),this.complex.indexes.push(this.currentIndex),this.currentIndex++}else this.extrusions(B,W,r,this.normal,this.thickness,this.totalDistance-qe);if(O.push(n+0,n+1,n+2),u){Lc(a,u)&&oo(u,a,Gu(u,Uu(u,a,r))),Ul(Xs,u,a);var jt=uc(zl,Xi(),Eo,Xs,this.thickness),or=(0,vn.Z)(jt,2),ar=or[0],Sr=or[1],dr=sl(zl,this.normal)<0?-1:1,jr=oe;if(!jr&&this.join==="miter"){var nn=ar;nn>this.miterLimit&&(jr=!0)}jr?(W.push(this.normal[0],this.normal[1],0),W.push(Sr[0],Sr[1],0),B.push(a[0],a[1],a[2]|0,this.totalDistance,-this.thickness*dr,a[2]|0),this.complex.indexes.push(this.currentIndex),B.push(a[0],a[1],a[2]|0,this.totalDistance,this.thickness*dr,a[2]|0),this.complex.indexes.push(this.currentIndex),this.currentIndex++,O.push.apply(O,(0,pr.Z)(this.lastFlip!==-dr?[n,n+2,n+3]:[n+2,n+1,n+3])),O.push(n+2,n+3,n+4),ul(Pc,Xs),au(this.normal,Pc),W.push(this.normal[0],this.normal[1],0),B.push(a[0],a[1],a[2]|0,this.totalDistance,-this.thickness*dr,a[2]|0),this.complex.indexes.push(this.currentIndex),this.currentIndex++,M+=3):(this.extrusions(B,W,a,Sr,ar,this.totalDistance),O.push.apply(O,(0,pr.Z)(this.lastFlip===1?[n,n+2,n+3]:[n+2,n+1,n+3])),dr=-1,au(this.normal,Sr),M+=2),this.lastFlip=dr}else{if(ul(this.normal,Eo),ce){var bt=Xi(),Ot=Xi();sc(Ot,Eo,this.normal),oo(bt,Eo,this.normal),W.push(Ot[0],Ot[1],0),W.push(bt[0],bt[1],0),B.push(a[0],a[1],a[2]|0,this.totalDistance,this.thickness,a[2]|0),this.complex.indexes.push(this.currentIndex),B.push(a[0],a[1],a[2]|0,this.totalDistance,this.thickness,a[2]|0),this.complex.indexes.push(this.currentIndex),this.currentIndex++}else this.extrusions(B,W,a,this.normal,this.thickness,this.totalDistance);O.push.apply(O,(0,pr.Z)(this.lastFlip===1?[n,n+2,n+3]:[n+2,n+1,n+3])),M+=2}return M}},{key:"simpleSegment",value:function(t,n,r,a,u){var c=0,g=t.indices,x=t.positions,M=t.normals,O=ma([a[0],a[1]]),B=ma([r[0],r[1]]);Ul(Eo,O,B);var W=0;if(this.dash&&(W=this.lineSegmentDistance(O,B),this.totalDistance+=W),this.normal||(this.normal=Xi(),ul(this.normal,Eo)),this.started||(this.started=!0,this.extrusions(x,M,r,this.normal,this.thickness,this.totalDistance-W)),g.push(n+0,n+1,n+2),!u)ul(this.normal,Eo),this.extrusions(x,M,a,this.normal,this.thickness,this.totalDistance),g.push.apply(g,(0,pr.Z)(this.lastFlip===1?[n,n+2,n+3]:[n+2,n+1,n+3])),c+=2;else{var ce=ma([u[0],u[1]]);Lc(O,ce)&&oo(ce,O,Gu(ce,Uu(ce,O,B))),Ul(Xs,ce,O);var oe=uc(zl,Xi(),Eo,Xs,this.thickness),Te=(0,vn.Z)(oe,2),Ze=Te[0],qe=Te[1],et=sl(zl,this.normal)<0?-1:1;this.extrusions(x,M,a,qe,Ze,this.totalDistance),g.push.apply(g,(0,pr.Z)(this.lastFlip===1?[n,n+2,n+3]:[n+2,n+1,n+3])),et=-1,au(this.normal,qe),c+=2,this.lastFlip=et}return c}},{key:"segment",value:function(t,n,r,a,u){var c=0,g=t.indices,x=t.positions,M=t.normals,O=this.cap==="square",B=this.join==="bevel",W=ma([a[0],a[1]]),ce=ma([r[0],r[1]]);Ul(Eo,W,ce);var oe=0;if(this.dash&&(oe=this.lineSegmentDistance(W,ce),this.totalDistance+=oe),this.normal||(this.normal=Xi(),ul(this.normal,Eo)),!this.started)if(this.started=!0,O){var Te=Xi(),Ze=Xi();oo(Te,this.normal,Eo),oo(Ze,this.normal,Eo),M.push(Ze[0],Ze[1],0),M.push(Te[0],Te[1],0),x.push(r[0],r[1],r[2]|0,this.totalDistance-oe,-this.thickness,r[2]|0),this.complex.indexes.push(this.currentIndex),x.push(r[0],r[1],r[2]|0,this.totalDistance-oe,this.thickness,r[2]|0),this.complex.indexes.push(this.currentIndex),this.currentIndex++}else this.extrusions(x,M,r,this.normal,this.thickness,this.totalDistance-oe);if(g.push(n+0,n+1,n+2),u){var yt=ma([u[0],u[1]]);Lc(W,yt)&&oo(yt,W,Gu(yt,Uu(yt,W,ce))),Ul(Xs,yt,W);var bt=uc(zl,Xi(),Eo,Xs,this.thickness),Ot=(0,vn.Z)(bt,2),jt=Ot[0],or=Ot[1],ar=sl(zl,this.normal)<0?-1:1,Sr=B;if(!Sr&&this.join==="miter"){var dr=jt;dr>this.miterLimit&&(Sr=!0)}Sr?(M.push(this.normal[0],this.normal[1],0),M.push(or[0],or[1],0),x.push(a[0],a[1],a[2]|0,this.totalDistance,-this.thickness*ar,a[2]|0),this.complex.indexes.push(this.currentIndex),x.push(a[0],a[1],a[2]|0,this.totalDistance,this.thickness*ar,a[2]|0),this.complex.indexes.push(this.currentIndex),this.currentIndex++,g.push.apply(g,(0,pr.Z)(this.lastFlip!==-ar?[n,n+2,n+3]:[n+2,n+1,n+3])),g.push(n+2,n+3,n+4),ul(Pc,Xs),au(this.normal,Pc),M.push(this.normal[0],this.normal[1],0),x.push(a[0],a[1],a[2]|0,this.totalDistance,-this.thickness*ar,a[2]|0),this.complex.indexes.push(this.currentIndex),this.currentIndex++,c+=3):(this.extrusions(x,M,a,or,jt,this.totalDistance),g.push.apply(g,(0,pr.Z)(this.lastFlip===1?[n,n+2,n+3]:[n+2,n+1,n+3])),ar=-1,au(this.normal,or),c+=2),this.lastFlip=ar}else{if(ul(this.normal,Eo),O){var qe=Xi(),et=Xi();sc(et,Eo,this.normal),oo(qe,Eo,this.normal),M.push(et[0],et[1],0),M.push(qe[0],qe[1],0),x.push(a[0],a[1],a[2]|0,this.totalDistance,this.thickness,a[2]|0),this.complex.indexes.push(this.currentIndex),x.push(a[0],a[1],a[2]|0,this.totalDistance,this.thickness,a[2]|0),this.complex.indexes.push(this.currentIndex),this.currentIndex++}else this.extrusions(x,M,a,this.normal,this.thickness,this.totalDistance);g.push.apply(g,(0,pr.Z)(this.lastFlip===1?[n,n+2,n+3]:[n+2,n+1,n+3])),c+=2}return c}},{key:"extrusions",value:function(t,n,r,a,u,c){n.push(a[0],a[1],0),n.push(a[0],a[1],0),t.push(r[0],r[1],r[2]|0,c,-u,r[2]|0),this.complex.indexes.push(this.currentIndex),t.push(r[0],r[1],r[2]|0,c,u,r[2]|0),this.complex.indexes.push(this.currentIndex),this.currentIndex++}},{key:"lineSegmentDistance",value:function(t,n){var r=n[0]-t[0],a=n[1]-t[1];return Math.sqrt(r*r+a*a)}}]),e}();function Cl(e){var i=e.coordinates,t=e.originCoordinates,n=e.version,r=new Gl({dash:!0,join:"bevel"});if(n==="GAODE2.x"){var a=i;Array.isArray(a[0][0])||(a=[i]);var u=t;Array.isArray(u[0][0])||(u=[t]);for(var c=0;c<a.length;c++){var g=a[c],x=u[c];r.extrude_gaode2(g,x)}}else{var M=i;M[0]&&!Array.isArray(M[0][0])&&(M=[i]),M.forEach(function(B){r.extrude(B)})}var O=r.complex;return{vertices:O.positions,indices:O.indices,normals:O.normals,indexes:O.indexes,size:6}}function pa(e){var i=Is(e.coordinates);return{vertices:[].concat((0,pr.Z)(i),(0,pr.Z)(i),(0,pr.Z)(i),(0,pr.Z)(i)),indices:[0,1,2,2,3,0],size:i.length}}function Oc(e){var i=e.coordinates,t=oa().flatten(i),n=t.vertices,r=t.dimensions,a=t.holes,u=oa()(n,a,r);return{indices:u,vertices:n,size:r}}var jl=function(){var e=(0,ur.Z)(it().mark(function i(t){var n,r,a,u,c,g,x,M,O;return it().wrap(function(W){for(;;)switch(W.prev=W.next){case 0:return n=t.descriptors,r=t.features,a=t.enablePicking,u=t.iconMap,c={a_Color:zf,a_Position:Nl,filter:Sc,a_vertexId:af,a_PickingColor:function(oe){var Te=oe.id;return a?bs(Te):[0,0,0]},a_DistanceAndIndex:function(oe,Te,Ze,qe,et,yt){return yt===void 0?[Ze[3],10]:[Ze[3],yt]},a_Total_Distance:function(oe,Te,Ze){return[Ze[5]]},a_Size:function(oe){var Te=oe.size,Ze=Te===void 0?1:Te;return Array.isArray(Ze)?[Ze[0],Ze[1]]:[Ze,0]},a_Normal:function(oe,Te,Ze,qe,et){return et},a_Miter:function(oe,Te,Ze){return[Ze[4]]},a_iconMapUV:function(oe){var Te=oe.texture,Ze=u[Te]||{x:0,y:0},qe=Ze.x,et=Ze.y;return[qe,et]}},g={sizePerElement:0,elements:[]},x=0,M=[],O=3,r.forEach(function(ce,oe){var Te=Cl(ce),Ze=Te.indices,qe=Te.vertices,et=Te.normals,yt=Te.size,bt=Te.indexes;Ze.forEach(function(ar){M.push(ar+x)}),O=yt;var Ot=qe.length/yt;g.sizePerElement=O,g.elements.push({featureIdx:oe,vertices:qe,normals:et,offset:x}),x+=Ot;for(var jt=function(Sr){var dr=(et==null?void 0:et.slice(Sr*3,Sr*3+3))||[],jr=qe.slice(Sr*yt,Sr*yt+yt),nn=0;bt&&bt[Sr]!==void 0&&(nn=bt[Sr]),n.forEach(function(En){if(En&&c[En.name]){var _a;(_a=En.buffer.data).push.apply(_a,(0,pr.Z)(c[En.name](ce,oe,jr,Sr,dr,nn)))}})},or=0;or<Ot;or++)jt(or)}),W.abrupt("return",{descriptors:n,featureLayout:g,indices:M});case 8:case"end":return W.stop()}},i)}));return function(t){return e.apply(this,arguments)}}(),lc=function(){var e=(0,ur.Z)(it().mark(function i(t){var n,r,a,u,c,g,x,M,O;return it().wrap(function(W){for(;;)switch(W.prev=W.next){case 0:return n=t.descriptors,r=t.features,a=t.enablePicking,u=t.shape2d,c={a_Color:zf,a_Position:Nl,filter:Sc,a_vertexId:af,a_PickingColor:function(oe){var Te=oe.id;return a?bs(Te):[0,0,0]},a_Shape:function(oe){var Te=oe.shape,Ze=Te===void 0?2:Te,qe=u.indexOf(Ze);return[qe]},a_Extrude:function(oe,Te,Ze,qe){var et=[1,1,0,-1,1,0,-1,-1,0,1,-1,0],yt=qe%4*3;return[et[yt],et[yt+1],et[yt+2]]},a_Size:function(oe){var Te=oe.size,Ze=Te===void 0?5:Te;return Array.isArray(Ze)?[Ze[0]]:[Ze]}},g={sizePerElement:0,elements:[]},x=0,M=[],O=3,r.forEach(function(ce,oe){var Te=pa(ce),Ze=Te.indices,qe=Te.vertices,et=Te.normals,yt=Te.size,bt=Te.indexes;Ze.forEach(function(ar){M.push(ar+x)}),O=yt;var Ot=qe.length/yt;g.sizePerElement=O,g.elements.push({featureIdx:oe,vertices:qe,normals:et,offset:x}),x+=Ot;for(var jt=function(Sr){var dr=(et==null?void 0:et.slice(Sr*3,Sr*3+3))||[],jr=qe.slice(Sr*yt,Sr*yt+yt),nn=0;bt&&bt[Sr]!==void 0&&(nn=bt[Sr]),n.forEach(function(En){if(En&&c[En.name]){var _a;(_a=En.buffer.data).push.apply(_a,(0,pr.Z)(c[En.name](ce,oe,jr,Sr,dr,nn)))}})},or=0;or<Ot;or++)jt(or)}),W.abrupt("return",{descriptors:n,featureLayout:g,indices:M});case 8:case"end":return W.stop()}},i)}));return function(t){return e.apply(this,arguments)}}(),Vl=function(){var e=(0,ur.Z)(it().mark(function i(t){var n,r,a,u,c,g,x,M;return it().wrap(function(B){for(;;)switch(B.prev=B.next){case 0:return n=t.descriptors,r=t.features,a=t.enablePicking,u={a_Color:zf,a_Position:Nl,filter:Sc,a_vertexId:af,a_PickingColor:function(ce){var oe=ce.id;return a?bs(oe):[0,0,0]}},c={sizePerElement:0,elements:[]},g=0,x=[],M=3,r.forEach(function(W,ce){var oe=Oc(W),Te=oe.indices,Ze=oe.vertices,qe=oe.normals,et=oe.size,yt=oe.indexes;Te.forEach(function(or){x.push(or+g)}),M=et;var bt=Ze.length/et;c.sizePerElement=M,c.elements.push({featureIdx:ce,vertices:Ze,normals:qe,offset:g}),g+=bt;for(var Ot=function(ar){var Sr=(qe==null?void 0:qe.slice(ar*3,ar*3+3))||[],dr=Ze.slice(ar*et,ar*et+et),jr=0;yt&&yt[ar]!==void 0&&(jr=yt[ar]),n.forEach(function(nn){if(nn&&u[nn.name]){var En;(En=nn.buffer.data).push.apply(En,(0,pr.Z)(u[nn.name](W,ce,dr,ar,Sr,jr)))}})},jt=0;jt<bt;jt++)Ot(jt)}),B.abrupt("return",{descriptors:n,featureLayout:c,indices:x});case 8:case"end":return B.stop()}},i)}));return function(t){return e.apply(this,arguments)}}(),Hl={pointFill:lc,line:jl,polygonFill:Vl},g0=(0,X.Z)({},Hl);function m0(e){return Qs.apply(this,arguments)}function Qs(){return Qs=_asyncToGenerator(_regeneratorRuntime.mark(function e(i){var t,n;return _regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(t=i.workerType,n=i.data,!g0[t]){a.next=3;break}return a.abrupt("return",g0[t](n));case 3:return a.abrupt("return",Promise.reject(new Error('Worker with type "'.concat(t,'" non-existent.'))));case 4:case"end":return a.stop()}},e)})),Qs.apply(this,arguments)}var Rc=new Map;function wl(e,i){Rc.set(e,i)}function ju(e){var i=Rc.get(e);return i}var Mu="l7-worker",Yf=3,ou=!0;function uf(e){registerWorkerSource(Mu,e)}function $l(){var e=getWorkerSource(Mu);if(!e)throw new Error("get worker failed by workerName: ".concat(Mu,"."));return e}function Yl(e,i){return Os.apply(this,arguments)}function Os(){return Os=_asyncToGenerator(_regeneratorRuntime.mark(function e(i,t){var n,r,a,u,c;return _regeneratorRuntime.wrap(function(x){for(;;)switch(x.prev=x.next){case 0:return n=$l(),r=WorkerFarm.getWorkerFarm({maxConcurrency:Yf,reuseWorkers:ou}),a=r.getWorkerPool({name:Mu,source:n}),x.next=5,a.startJob(Mu,function(M,O,B){return M.done(B)});case 5:return u=x.sent,u.postMessage("process",{input:{workerType:i,data:t}}),x.next=9,u.result;case 9:return c=x.sent,x.abrupt("return",c.result);case 11:case"end":return x.stop()}},e)})),Os.apply(this,arguments)}var Dc=C(38163),kc=C.n(Dc);function Tl(e,i){return e.map(function(t){return t[i]*1})}function y0(e){return e===void 0?!1:!Array.isArray(e)&&e.data!==void 0}function lf(e){return Array.isArray(e)?e.length===0?!1:!!y0(e[0]):!1}function cf(e){return Array.isArray(e)?e.length===0||typeof e[0]=="number":!1}function Tf(e){var i=Object.isFrozen(e)?In.cloneDeep(e):e;return kc()(i,!0),i}function ms(e,i){var t=i.x,n=i.y,r=i.x1,a=i.y1,u=i.coordinates,c=i.geometry,g=[];if(!Array.isArray(e))return{dataArray:[]};if(c)return e.filter(function(Ze){return Ze[c]&&Ze[c].type&&Ze[c].coordinates&&Ze[c].coordinates.length>0}).forEach(function(Ze,qe){var et=Tf(Ze[c]);(0,de.nG)(et,function(yt){var bt=(0,Le.r7)(yt),Ot=(0,X.Z)((0,X.Z)({},Ze),{},{_id:qe,coordinates:bt});g.push(Ot)})}),{dataArray:g};for(var x=0;x<e.length;x++){var M=e[x],O=[];if(u){var B="Polygon";Array.isArray(u[0])||(B="Point"),Array.isArray(u[0])&&!Array.isArray(u[0][0])&&(B="LineString");var W=Tf({type:B,coordinates:M[u]});O=W.coordinates}else if(t&&n&&r&&a){var ce=[parseFloat(M[t]),parseFloat(M[n])],oe=[parseFloat(M[r]),parseFloat(M[a])];O=[ce,oe]}else t&&n&&(O=[parseFloat(M[t]),parseFloat(M[n])]);var Te=(0,X.Z)((0,X.Z)({},M),{},{_id:x,coordinates:O});g.push(Te)}return{dataArray:g}}function ll(e,i){var t=ve(e);return ms(t,i)}var ia=C(71002);function Ko(e){for(var i=e.toString(),t=5381,n=i.length;n;)t=t*33^i.charCodeAt(--n);return t>>>0}function cc(e,i){return i===void 0?null:(0,ia.Z)(e.properties[i])*1==="number"?e.properties[i]*1:e.properties&&e.properties[i]?Ko(e.properties[i]+"")%1000019:null}function cl(e,i){var t=[],n={};return e.features?(e.features=e.features.filter(function(r){var a=r.geometry;return r!=null&&a&&a.type&&a.coordinates&&a.coordinates.length>0}),e=Tf(e),e.features.length===0?{dataArray:[],featureKeys:n}:((0,de.nG)(e,function(r,a){var u=cc(r,i==null?void 0:i.featureId);u===null&&(u=a);var c=u,g=(0,Le.r7)(r),x=(0,X.Z)((0,X.Z)({},r.properties),{},{coordinates:g,_id:c});t.push(x)}),{dataArray:t,featureKeys:n})):(e.features=[],{dataArray:[]})}function Mf(e,i,t,n){for(var r=n,a=t-i>>1,u=t-i,c,g=e[i],x=e[i+1],M=e[t],O=e[t+1],B=i+3;B<t;B+=3){var W=W0(e[B],e[B+1],g,x,M,O);if(W>r)c=B,r=W;else if(W===r){var ce=Math.abs(B-a);ce<u&&(c=B,u=ce)}}r>n&&(c-i>3&&Mf(e,i,c,n),e[c+2]=r,t-c>3&&Mf(e,c,t,n))}function W0(e,i,t,n,r,a){var u=r-t,c=a-n;if(u!==0||c!==0){var g=((e-t)*u+(i-n)*c)/(u*u+c*c);g>1?(t=r,n=a):g>0&&(t+=u*g,n+=c*g)}return u=e-t,c=i-n,u*u+c*c}function Nc(e,i,t,n){var r={id:typeof e=="undefined"?null:e,type:i,geometry:t,tags:n,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return If(r),r}function If(e){var i=e.geometry,t=e.type;if(t==="Point"||t==="MultiPoint"||t==="LineString")Wf(e,i);else if(t==="Polygon"||t==="MultiLineString")for(var n=0;n<i.length;n++)Wf(e,i[n]);else if(t==="MultiPolygon")for(n=0;n<i.length;n++)for(var r=0;r<i[n].length;r++)Wf(e,i[n][r])}function Wf(e,i){for(var t=0;t<i.length;t+=3)e.minX=Math.min(e.minX,i[t]),e.minY=Math.min(e.minY,i[t+1]),e.maxX=Math.max(e.maxX,i[t]),e.maxY=Math.max(e.maxY,i[t+1])}function X0(e,i){var t=[];if(e.type==="FeatureCollection")for(var n=0;n<e.features.length;n++)ff(t,e.features[n],i,n);else e.type==="Feature"?ff(t,e,i):ff(t,{geometry:e},i);return t}function ff(e,i,t,n){if(i.geometry){var r=i.geometry.coordinates,a=i.geometry.type,u=Math.pow(t.tolerance/((1<<t.maxZoom)*t.extent),2),c=[],g=i.id;if(t.promoteId?g=i.properties[t.promoteId]:t.generateId&&(g=n||0),a==="Point")Pf(r,c);else if(a==="MultiPoint")for(var x=0;x<r.length;x++)Pf(r[x],c);else if(a==="LineString")Ya(r,c,u,!1);else if(a==="MultiLineString")if(t.lineMetrics){for(x=0;x<r.length;x++)c=[],Ya(r[x],c,u,!1),e.push(Nc(g,"LineString",c,i.properties));return}else Fc(r,c,u,!1);else if(a==="Polygon")Fc(r,c,u,!0);else if(a==="MultiPolygon")for(x=0;x<r.length;x++){var M=[];Fc(r[x],M,u,!0),c.push(M)}else if(a==="GeometryCollection"){for(x=0;x<i.geometry.geometries.length;x++)ff(e,{id:g,geometry:i.geometry.geometries[x],properties:i.properties},t,n);return}else throw new Error("Input data is not a valid GeoJSON object.");e.push(Nc(g,a,c,i.properties))}}function Pf(e,i){i.push(Wl(e[0])),i.push(qs(e[1])),i.push(0)}function Ya(e,i,t,n){for(var r,a,u=0,c=0;c<e.length;c++){var g=Wl(e[c][0]),x=qs(e[c][1]);i.push(g),i.push(x),i.push(0),c>0&&(n?u+=(r*x-g*a)/2:u+=Math.sqrt(Math.pow(g-r,2)+Math.pow(x-a,2))),r=g,a=x}var M=i.length-3;i[2]=1,Mf(i,0,M,t),i[M+2]=1,i.size=Math.abs(u),i.start=0,i.end=i.size}function Fc(e,i,t,n){for(var r=0;r<e.length;r++){var a=[];Ya(e[r],a,t,n),i.push(a)}}function Wl(e){return e/360+.5}function qs(e){var i=Math.sin(e*Math.PI/180),t=.5-.25*Math.log((1+i)/(1-i))/Math.PI;return t<0?0:t>1?1:t}function vu(e,i,t,n,r,a,u,c){if(t/=i,n/=i,a>=t&&u<n)return e;if(u<t||a>=n)return null;for(var g=[],x=0;x<e.length;x++){var M=e[x],O=M.geometry,B=M.type,W=r===0?M.minX:M.minY,ce=r===0?M.maxX:M.maxY;if(W>=t&&ce<n){g.push(M);continue}else if(ce<t||W>=n)continue;var oe=[];if(B==="Point"||B==="MultiPoint")Rs(O,oe,t,n,r);else if(B==="LineString")Xf(O,oe,t,n,r,!1,c.lineMetrics);else if(B==="MultiLineString")Ce(O,oe,t,n,r,!1);else if(B==="Polygon")Ce(O,oe,t,n,r,!0);else if(B==="MultiPolygon")for(var Te=0;Te<O.length;Te++){var Ze=[];Ce(O[Te],Ze,t,n,r,!0),Ze.length&&oe.push(Ze)}if(oe.length){if(c.lineMetrics&&B==="LineString"){for(Te=0;Te<oe.length;Te++)g.push(Nc(M.id,B,oe[Te],M.tags));continue}(B==="LineString"||B==="MultiLineString")&&(oe.length===1?(B="LineString",oe=oe[0]):B="MultiLineString"),(B==="Point"||B==="MultiPoint")&&(B=oe.length===3?"Point":"MultiPoint"),g.push(Nc(M.id,B,oe,M.tags))}}return g.length?g:null}function Rs(e,i,t,n,r){for(var a=0;a<e.length;a+=3){var u=e[a+r];u>=t&&u<=n&&(i.push(e[a]),i.push(e[a+1]),i.push(e[a+2]))}}function Xf(e,i,t,n,r,a,u){for(var c=_0(e),g=r===0?mt:nr,x=e.start,M,O,B=0;B<e.length-3;B+=3){var W=e[B],ce=e[B+1],oe=e[B+2],Te=e[B+3],Ze=e[B+4],qe=r===0?W:ce,et=r===0?Te:Ze,yt=!1;u&&(M=Math.sqrt(Math.pow(W-Te,2)+Math.pow(ce-Ze,2))),qe<t?et>t&&(O=g(c,W,ce,Te,Ze,t),u&&(c.start=x+M*O)):qe>n?et<n&&(O=g(c,W,ce,Te,Ze,n),u&&(c.start=x+M*O)):Qe(c,W,ce,oe),et<t&&qe>=t&&(O=g(c,W,ce,Te,Ze,t),yt=!0),et>n&&qe<=n&&(O=g(c,W,ce,Te,Ze,n),yt=!0),!a&&yt&&(u&&(c.end=x+M*O),i.push(c),c=_0(e)),u&&(x+=M)}var bt=e.length-3;W=e[bt],ce=e[bt+1],oe=e[bt+2],qe=r===0?W:ce,qe>=t&&qe<=n&&Qe(c,W,ce,oe),bt=c.length-3,a&&bt>=3&&(c[bt]!==c[0]||c[bt+1]!==c[1])&&Qe(c,c[0],c[1],c[2]),c.length&&i.push(c)}function _0(e){var i=[];return i.size=e.size,i.start=e.start,i.end=e.end,i}function Ce(e,i,t,n,r,a){for(var u=0;u<e.length;u++)Xf(e[u],i,t,n,r,a,!1)}function Qe(e,i,t,n){e.push(i),e.push(t),e.push(n)}function mt(e,i,t,n,r,a){var u=(a-i)/(n-i);return e.push(a),e.push(t+(r-t)*u),e.push(1),u}function nr(e,i,t,n,r,a){var u=(a-t)/(r-t);return e.push(i+(n-i)*u),e.push(a),e.push(1),u}function Ar(e,i){var t=i.buffer/i.extent,n=e,r=vu(e,1,-1-t,t,0,-1,2,i),a=vu(e,1,1-t,2+t,0,-1,2,i);return(r||a)&&(n=vu(e,1,-t,1+t,0,-1,2,i)||[],r&&(n=er(r,1).concat(n)),a&&(n=n.concat(er(a,-1)))),n}function er(e,i){for(var t=[],n=0;n<e.length;n++){var r=e[n],a=r.type,u;if(a==="Point"||a==="MultiPoint"||a==="LineString")u=sr(r.geometry,i);else if(a==="MultiLineString"||a==="Polygon"){u=[];for(var c=0;c<r.geometry.length;c++)u.push(sr(r.geometry[c],i))}else if(a==="MultiPolygon")for(u=[],c=0;c<r.geometry.length;c++){for(var g=[],x=0;x<r.geometry[c].length;x++)g.push(sr(r.geometry[c][x],i));u.push(g)}t.push(Nc(r.id,a,u,r.tags))}return t}function sr(e,i){var t=[];t.size=e.size,e.start!==void 0&&(t.start=e.start,t.end=e.end);for(var n=0;n<e.length;n+=3)t.push(e[n]+i,e[n+1],e[n+2]);return t}function Tr(e,i){if(e.transformed)return e;var t=1<<e.z,n=e.x,r=e.y,a,u,c;for(a=0;a<e.features.length;a++){var g=e.features[a],x=g.geometry,M=g.type;if(g.geometry=[],M===1)for(u=0;u<x.length;u+=2)g.geometry.push(Lr(x[u],x[u+1],i,t,n,r));else for(u=0;u<x.length;u++){var O=[];for(c=0;c<x[u].length;c+=2)O.push(Lr(x[u][c],x[u][c+1],i,t,n,r));g.geometry.push(O)}}return e.transformed=!0,e}function Lr(e,i,t,n,r,a){return[Math.round(t*(e*n-r)),Math.round(t*(i*n-a))]}function Nr(e,i,t,n,r){for(var a=i===r.maxZoom?0:r.tolerance/((1<<i)*r.extent),u={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:t,y:n,z:i,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},c=0;c<e.length;c++){u.numFeatures++,kr(u,e[c],a,r);var g=e[c].minX,x=e[c].minY,M=e[c].maxX,O=e[c].maxY;g<u.minX&&(u.minX=g),x<u.minY&&(u.minY=x),M>u.maxX&&(u.maxX=M),O>u.maxY&&(u.maxY=O)}return u}function kr(e,i,t,n){var r=i.geometry,a=i.type,u=[];if(a==="Point"||a==="MultiPoint")for(var c=0;c<r.length;c+=3)u.push(r[c]),u.push(r[c+1]),e.numPoints++,e.numSimplified++;else if(a==="LineString")Or(u,r,e,t,!1,!1);else if(a==="MultiLineString"||a==="Polygon")for(c=0;c<r.length;c++)Or(u,r[c],e,t,a==="Polygon",c===0);else if(a==="MultiPolygon")for(var g=0;g<r.length;g++){var x=r[g];for(c=0;c<x.length;c++)Or(u,x[c],e,t,!0,c===0)}if(u.length){var M=i.tags||null;if(a==="LineString"&&n.lineMetrics){M={};for(var O in i.tags)M[O]=i.tags[O];M.mapbox_clip_start=r.start/r.size,M.mapbox_clip_end=r.end/r.size}var B={geometry:u,type:a==="Polygon"||a==="MultiPolygon"?3:a==="LineString"||a==="MultiLineString"?2:1,tags:M};i.id!==null&&(B.id=i.id),e.features.push(B)}}function Or(e,i,t,n,r,a){var u=n*n;if(n>0&&i.size<(r?u:n)){t.numPoints+=i.length/3;return}for(var c=[],g=0;g<i.length;g+=3)(n===0||i[g+2]>u)&&(t.numSimplified++,c.push(i[g]),c.push(i[g+1])),t.numPoints++;r&&qr(c,a),e.push(c)}function qr(e,i){for(var t=0,n=0,r=e.length,a=r-2;n<r;a=n,n+=2)t+=(e[n]-e[a])*(e[n+1]+e[a+1]);if(t>0===i)for(n=0,r=e.length;n<r/2;n+=2){var u=e[n],c=e[n+1];e[n]=e[r-2-n],e[n+1]=e[r-1-n],e[r-2-n]=u,e[r-1-n]=c}}function Mr(e,i){return new zr(e,i)}function zr(e,i){i=this.options=lr(Object.create(this.options),i);var t=i.debug;if(t&&console.time("preprocess data"),i.maxZoom<0||i.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(i.promoteId&&i.generateId)throw new Error("promoteId and generateId cannot be used together.");var n=X0(e,i);this.tiles={},this.tileCoords=[],t&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",i.indexMaxZoom,i.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),n=Ar(n,i),n.length&&this.splitTile(n,0,0,0),t&&(n.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}zr.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},zr.prototype.splitTile=function(e,i,t,n,r,a,u){for(var c=[e,i,t,n],g=this.options,x=g.debug;c.length;){n=c.pop(),t=c.pop(),i=c.pop(),e=c.pop();var M=1<<i,O=Vt(i,t,n),B=this.tiles[O];if(!B&&(x>1&&console.time("creation"),B=this.tiles[O]=Nr(e,i,t,n,g),this.tileCoords.push({z:i,x:t,y:n}),x)){x>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",i,t,n,B.numFeatures,B.numPoints,B.numSimplified),console.timeEnd("creation"));var W="z"+i;this.stats[W]=(this.stats[W]||0)+1,this.total++}if(B.source=e,r){if(i===g.maxZoom||i===r)continue;var ce=1<<r-i;if(t!==Math.floor(a/ce)||n!==Math.floor(u/ce))continue}else if(i===g.indexMaxZoom||B.numPoints<=g.indexMaxPoints)continue;if(B.source=null,e.length!==0){x>1&&console.time("clipping");var oe=.5*g.buffer/g.extent,Te=.5-oe,Ze=.5+oe,qe=1+oe,et,yt,bt,Ot,jt,or;et=yt=bt=Ot=null,jt=vu(e,M,t-oe,t+Ze,0,B.minX,B.maxX,g),or=vu(e,M,t+Te,t+qe,0,B.minX,B.maxX,g),e=null,jt&&(et=vu(jt,M,n-oe,n+Ze,1,B.minY,B.maxY,g),yt=vu(jt,M,n+Te,n+qe,1,B.minY,B.maxY,g),jt=null),or&&(bt=vu(or,M,n-oe,n+Ze,1,B.minY,B.maxY,g),Ot=vu(or,M,n+Te,n+qe,1,B.minY,B.maxY,g),or=null),x>1&&console.timeEnd("clipping"),c.push(et||[],i+1,t*2,n*2),c.push(yt||[],i+1,t*2,n*2+1),c.push(bt||[],i+1,t*2+1,n*2),c.push(Ot||[],i+1,t*2+1,n*2+1)}}},zr.prototype.getTile=function(e,i,t){var n=this.options,r=n.extent,a=n.debug;if(e<0||e>24)return null;var u=1<<e;i=(i%u+u)%u;var c=Vt(e,i,t);if(this.tiles[c])return Tr(this.tiles[c],r);a>1&&console.log("drilling down to z%d-%d-%d",e,i,t);for(var g=e,x=i,M=t,O;!O&&g>0;)g--,x=Math.floor(x/2),M=Math.floor(M/2),O=this.tiles[Vt(g,x,M)];return!O||!O.source?null:(a>1&&console.log("found parent tile z%d-%d-%d",g,x,M),a>1&&console.time("drilling down"),this.splitTile(O.source,g,x,M,e,i,t),a>1&&console.timeEnd("drilling down"),this.tiles[c]?Tr(this.tiles[c],r):null)};function Vt(e,i,t){return((1<<e)*t+i)*32+e}function lr(e,i){for(var t in i)e[t]=i[t];return e}var Rr=function(){function e(i,t,n,r){(0,se.Z)(this,e),(0,Me.Z)(this,"vectorLayerCache",{}),this.x=t,this.y=n,this.z=r,this.vectorTile=i}return(0,be.Z)(e,[{key:"getTileData",value:function(t){if(!t||!this.vectorTile.layers[t])return[];if(this.vectorLayerCache[t])return this.vectorLayerCache[t];var n=this.vectorTile.layers[t];return n.features}},{key:"getFeatureById",value:function(){throw new Error("Method not implemented.")}}]),e}(),tn={tileSize:256,minZoom:0,maxZoom:1/0,zoomOffset:0};function _r(e){for(var i=0,t=0,n=e.length,r=n-1,a,u;t<n;r=t++)a=e[t],u=e[r],i+=(u.x-a.x)*(a.y+u.y);return i}function cn(e){var i=e.length;if(i<=1)return[e];for(var t=[],n,r,a=0;a<i;a++){var u=_r(e[a]);u!==0&&(r===void 0&&(r=u<0),r===u<0?(n&&t.push(n),n=[e[a]]):n.push(e[a]))}return n&&t.push(n),t}var wr=["Unknown","Point","LineString","Polygon"];function Hr(e,i,t,n,r){var a=r.geometry,u=r.type,c=r.tags,g=r.id,x=e*Math.pow(2,n),M=e*i,O=e*t,B=wr[u],W,ce;function oe(qe){for(var et=0;et<qe.length;et++){var yt=qe[et];if(yt[3])break;var bt=180-(yt[1]+O)*360/x,Ot=(yt[0]+M)*360/x-180,jt=360/Math.PI*Math.atan(Math.exp(bt*Math.PI/180))-90;qe[et]=[Ot,jt,0,1]}}switch(u){case 1:var Te=[];for(W=0;W<a.length;W++)Te[W]=a[W][0];a=Te,oe(a);break;case 2:for(W=0;W<a.length;W++)oe(a[W]);break;case 3:for(a=cn(a),W=0;W<a.length;W++)for(ce=0;ce<a[W].length;ce++)oe(a[W][ce]);break}a.length===1?a=a[0]:B="Multi"+B;var Ze={type:"Feature",geometry:{type:B,coordinates:a},properties:c,id:g,tileOrigin:[0,0],coord:""};return Ze}var br=function(){var e=(0,ur.Z)(it().mark(function i(t,n,r,a){return it().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.abrupt("return",new Promise(function(g){var x=n.getTile(t.z,t.x,t.y),M=x?x.features.map(function(W){return Hr(a,r.x,r.y,r.z,W)}):[],O={layers:{defaultLayer:{features:M}}},B=new Rr(O,t.x,t.y,t.z);g(B)}));case 1:case"end":return c.stop()}},i)}));return function(t,n,r,a){return e.apply(this,arguments)}}();function Wr(e){var i={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!0,debug:0};return e===void 0||typeof e.geojsonvtOptions=="undefined"?i:(0,X.Z)((0,X.Z)({},i),e.geojsonvtOptions)}function Cn(e,i){var t=Wr(i),n=t.extent||4096,r=Mr(e,t),a=function(g,x){return br(x,r,g,n)},u=(0,X.Z)((0,X.Z)((0,X.Z)({},tn),i),{},{getTileData:a});return{data:e,dataArray:[],tilesetOptions:u,isTile:!0}}function Xn(e,i){var t=i.extent,n=t===void 0?[121.168,30.2828,121.384,30.4219]:t,r=i.requestParameters,a=r===void 0?{}:r,u=new Promise(function(g){e instanceof HTMLImageElement||xf(e)?g([e]):Ir(e,a,function(x){g(x)})}),c={originData:e,images:u,_id:1,dataArray:[{_id:0,coordinates:[[n[0],n[1]],[n[2],n[3]]]}]};return c}function Ir(e,i,t){var n=[];if(typeof e=="string")$e((0,X.Z)((0,X.Z)({},i),{},{url:e}),function(u,c){c&&(n.push(c),t(n))});else{var r=e.length,a=0;e.forEach(function(u){$e((0,X.Z)((0,X.Z)({},i),{},{url:u}),function(c,g){a++,g&&n.push(g),a===r&&t(n)})})}return Xn}var Fr=function(){var e=(0,ur.Z)(it().mark(function i(t,n,r,a){var u,c;return it().wrap(function(x){for(;;)switch(x.prev=x.next){case 0:return u={x:n.x,y:n.y,z:n.z},c=bl(t,u),x.abrupt("return",new Promise(function(M){a?a(u,function(O,B){if(O||!B){var W={layers:{defaultLayer:{features:[]}}},ce=new Rr(W,n.x,n.y,n.z);M(ce)}else{var oe={layers:{defaultLayer:{features:B.features}}},Te=new Rr(oe,n.x,n.y,n.z);M(Te)}}):ki((0,X.Z)((0,X.Z)({},r),{},{url:c}),function(O,B){if(O||!B){var W={layers:{defaultLayer:{features:[]}}},ce=new Rr(W,n.x,n.y,n.z);M(ce)}else{var oe=JSON.parse(B),Te={layers:{defaultLayer:{features:oe}}},Ze=new Rr(Te,n.x,n.y,n.z);M(Ze)}})}));case 3:case"end":return x.stop()}},i)}));return function(t,n,r,a){return e.apply(this,arguments)}}();function gr(e,i){var t=function(a,u){return Fr(e,u,i==null?void 0:i.requestParameters,i.getCustomData)},n=(0,X.Z)((0,X.Z)({},i),{},{getTileData:t});return{dataArray:[],tilesetOptions:n,isTile:!0}}var On=C(38929),Bn=C(3614),gn=C.n(Bn),xi=function(){function e(i,t,n,r){(0,se.Z)(this,e),(0,Me.Z)(this,"vectorLayerCache",{}),this.x=t,this.y=n,this.z=r,this.vectorTile=new On.VectorTile(new(gn())(i))}return(0,be.Z)(e,[{key:"getTileData",value:function(t){if(!t||!this.vectorTile.layers[t])return[];if(this.vectorLayerCache[t])return this.vectorLayerCache[t];var n=this.vectorTile.layers[t];if(Array.isArray(n.features))return this.vectorLayerCache[t]=n.features,n.features;for(var r=[],a=0;a<n.length;a++){var u=n.feature(a),c=u.toGeoJSON(this.x,this.y,this.z);r.push((0,X.Z)((0,X.Z)({},c),{},{properties:(0,X.Z)({id:c.id},c.properties)}))}return this.vectorLayerCache[t]=r,r}},{key:"getFeatureById",value:function(){throw new Error("Method not implemented.")}}]),e}(),Jn={tileSize:256,minZoom:0,maxZoom:1/0,zoomOffset:0,warp:!0},gi=function(){var e=(0,ur.Z)(it().mark(function i(t,n,r,a,u){var c;return it().wrap(function(x){for(;;)switch(x.prev=x.next){case 0:return c=bl(t,n),x.abrupt("return",new Promise(function(M){if(u)u({x:r.x,y:r.y,z:r.z},function(B,W){if(B||!W)M(void 0);else{var ce=new xi(W,r.x,r.y,r.z);M(ce)}});else{var O=sn((0,X.Z)((0,X.Z)({},a),{},{url:c}),function(B,W){if(B||!W)M(void 0);else{var ce=new xi(W,r.x,r.y,r.z);M(ce)}});r.xhrCancel=function(){return O.cancel()}}}));case 2:case"end":return x.stop()}},i)}));return function(t,n,r,a,u){return e.apply(this,arguments)}}();function ta(e,i){var t=Array.isArray(e)?e[0]:e,n=function(u,c){return gi(t,u,c,i==null?void 0:i.requestParameters,i==null?void 0:i.getCustomData)},r=(0,X.Z)((0,X.Z)((0,X.Z)({},Jn),i),{},{getTileData:n});return{data:t,dataArray:[],tilesetOptions:r,isTile:!0}}function bo(e,i,t){switch(e){case"+":return i+t;case"-":return i-t;case"*":return i*t;case"/":return i/t;case"%":return i%t;case"^":return Math.pow(i,t);case"abs":return Math.abs(i);case"floor":return Math.floor(i);case"round":return Math.round(i);case"ceil":return Math.ceil(i);case"sin":return Math.sin(i);case"cos":return Math.cos(i);case"atan":return t===-1?Math.atan(i):Math.atan2(i,t);case"min":return Math.min(i,t);case"max":return Math.max(i,t);case"log10":return Math.log(i);case"log2":return Math.log2(i);default:return console.warn("Calculate symbol err! Return default 0"),0}}function ro(e,i){for(var t=i[0],n=t.width,r=t.height,a=i.map(function(W){return W.rasterData}),u=n*r,c=[],g=JSON.stringify(e),x=0;x<u;x++){var M=JSON.parse(g),O=Ti(M,a,x);if(typeof O=="number")c.push(O);else{var B=Na(M);c.push(B)}}return c}function Ti(e,i,t){if(e.length===2&&e[0]==="band"&&typeof e[1]=="number")try{return i[e[1]][t]}catch(n){return console.warn("Raster Data err!"),0}e.map(function(n,r){if(Array.isArray(n)&&n.length>0)switch(n[0]){case"band":try{e[r]=i[n[1]][t]}catch(a){console.warn("Raster Data err!"),e[r]=0}break;default:Ti(n,i,t)}})}function Io(e){var i=(0,vn.Z)(e,3),t=i[0],n=i[1],r=n===void 0?-1:n,a=i[2],u=a===void 0?-1:a;if(t===void 0)return console.warn("Express err!"),["+",0,0];var c=t.replace(/\s+/g,"");return[c,r,u]}function Na(e){var i=Io(e),t=i[0],n=i[1],r=i[2];return Array.isArray(n)&&(n=Na(e[1])),Array.isArray(r)&&(r=Na(e[2])),bo(t,n,r)}var Ao={nd:{type:"operation",expression:["/",["-",["band",1],["band",0]],["+",["band",1],["band",0]]]},rgb:{type:"function",method:jo}};function jo(e,i){for(var t=e[0].rasterData,n=e[1].rasterData,r=e[2].rasterData,a=[],u=(i==null?void 0:i.countCut)||[2,98],c=(0,vn.Z)(u,2),g=c[0],x=c[1],M=(i==null?void 0:i.RMinMax)||Fa(t,g,x),O=(i==null?void 0:i.GMinMax)||Fa(n,g,x),B=(i==null?void 0:i.BMinMax)||Fa(r,g,x),W=0;W<t.length;W++)a.push(Math.max(0,t[W]-M[0])),a.push(Math.max(0,n[W]-O[0])),a.push(Math.max(0,r[W]-B[0]));return{rasterData:a,rMinMax:M,gMinMax:O,bMinMax:B}}function Fa(e,i,t){var n=e.slice().sort(function(c,g){return c-g}),r=n.length,a=n[Math.ceil(r*i/100)],u=n[Math.ceil(r*t/100)];return[a,u]}function Ga(e,i,t){return Tn.apply(this,arguments)}function Tn(){return Tn=(0,ur.Z)(it().mark(function e(i,t,n){var r,a,u,c,g,x;return it().wrap(function(O){for(;;)switch(O.prev=O.next){case 0:if(i.length!==0){O.next=2;break}return O.abrupt("return",{rasterData:[0],width:1,heigh:1});case 2:return O.next=4,Promise.all(i.map(function(B){var W=B.data,ce=B.bands,oe=ce===void 0?[0]:ce;return t(W,oe)}));case 4:r=O.sent,a=[],r.forEach(function(B){Array.isArray(B)?a.push.apply(a,(0,pr.Z)(B)):a.push(B)}),u=a[0],c=u.width,g=u.height,O.t0=(0,ia.Z)(n),O.next=O.t0==="function"?11:O.t0==="object"?13:15;break;case 11:return x=n(a),O.abrupt("break",16);case 13:return Array.isArray(n)?x={rasterData:ro(n,a)}:x=ya(n,a),O.abrupt("break",16);case 15:x={rasterData:a[0].rasterData};case 16:return O.abrupt("return",(0,X.Z)((0,X.Z)({},x),{},{width:c,height:g}));case 17:case"end":return O.stop()}},e)})),Tn.apply(this,arguments)}function ya(e,i){var t=Ao[e.type];if(t.type==="function")return t.method(i,e==null?void 0:e.options);if(t.type==="operation")return e.type==="rgb"?un(t.expression,i):{rasterData:ro(t.expression,i)}}function un(e,i){e.r===void 0&&console.warn("Channel R lost in Operation! Use band[0] to fill!"),e.g===void 0&&console.warn("Channel G lost in Operation! Use band[0] to fill!"),e.b===void 0&&console.warn("Channel B lost in Operation! Use band[0] to fill!");var t=ro(e.r||["band",0],i),n=ro(e.g||["band",0],i),r=ro(e.b||["band",0],i);return[t,n,r]}function da(e,i,t,n){return ra.apply(this,arguments)}function ra(){return ra=(0,ur.Z)(it().mark(function e(i,t,n,r){var a;return it().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.next=2,Ga(i,t,n);case 2:a=c.sent,r(null,{data:a});case 4:case"end":return c.stop()}},e)})),ra.apply(this,arguments)}function Rn(e,i){var t=i.extent,n=i.width,r=i.height,a=i.min,u=i.max,c=i.format,g=i.operation,x,M,O;if(c===void 0||cf(e))x=Array.from(e),M=n,O=r;else{var B=Array.isArray(e)?e:[e];x=Ga(B,c,g)}var W={_id:1,dataArray:[{_id:1,data:x,width:M,height:O,min:a,max:u,coordinates:[[t[0],t[1]],[t[2],t[3]]]}]};return W}var mi=C(28660),vr=C(86700),Ri=C(84879),Xt={IEventEmitter:Symbol.for("IEventEmitter"),ISceneService:Symbol.for("ISceneService"),IGlobalConfigService:Symbol.for("IGlobalConfigService"),ICameraService:Symbol.for("ICameraService"),ICoordinateSystemService:Symbol.for("ICoordinateSystemService"),ILayerService:Symbol.for("ILayerService"),IDebugService:Symbol.for("IDebugService"),ILayerMappingService:Symbol.for("ILayerMappingService"),ILayerStyleService:Symbol.for("ILayerStyleService"),IMapService:Symbol.for("IMapService"),IMarkerService:Symbol.for("IMarkerService"),IPopupService:Symbol.for("PopupService"),IFactoryMapService:Symbol.for("Factory<IMapService>"),IRendererService:Symbol.for("IRendererService"),IShaderModuleService:Symbol.for("IShaderModuleService"),IIconService:Symbol.for("IIconService"),IFontService:Symbol.for("IFontService"),IInteractionService:Symbol.for("IInteractionService"),IPickingService:Symbol.for("IPickingService"),IControlService:Symbol.for("IControlService"),IStyleAttributeService:Symbol.for("IStyleAttributeService"),ILayer:Symbol.for("ILayer"),ILayerPlugin:Symbol.for("ILayerPlugin"),INormalPass:Symbol.for("INormalPass"),IPostProcessor:Symbol.for("IPostProcessor"),IPostProcessingPass:Symbol.for("IPostProcessingPass"),IFactoryPostProcessingPass:Symbol.for("Factory<IPostProcessingPass>"),IFactoryNormalPass:Symbol.for("Factory<IFactoryNormalPass>"),IMultiPassRenderer:Symbol.for("IMultiPassRenderer"),SceneID:Symbol.for("SceneID"),MapConfig:Symbol.for("MapConfig")},Jo=1e20,ct=function(){function e(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=i.fontSize,n=t===void 0?24:t,r=i.buffer,a=r===void 0?3:r,u=i.radius,c=u===void 0?8:u,g=i.cutoff,x=g===void 0?.25:g,M=i.fontFamily,O=M===void 0?"sans-serif":M,B=i.fontWeight,W=B===void 0?"normal":B,ce=i.fontStyle,oe=ce===void 0?"normal":ce;(0,se.Z)(this,e),(0,Me.Z)(this,"buffer",void 0),(0,Me.Z)(this,"cutoff",void 0),(0,Me.Z)(this,"radius",void 0),(0,Me.Z)(this,"size",void 0),(0,Me.Z)(this,"ctx",void 0),(0,Me.Z)(this,"gridOuter",void 0),(0,Me.Z)(this,"gridInner",void 0),(0,Me.Z)(this,"f",void 0),(0,Me.Z)(this,"z",void 0),(0,Me.Z)(this,"v",void 0),this.buffer=a,this.cutoff=x,this.radius=c;var Te=this.size=n+a*4,Ze=this._createCanvas(Te),qe=this.ctx=Ze.getContext("2d",{willReadFrequently:!0});qe.font="".concat(oe," ").concat(W," ").concat(n,"px ").concat(O),qe.textBaseline="alphabetic",qe.textAlign="left",qe.fillStyle="black",this.gridOuter=new Float64Array(Te*Te),this.gridInner=new Float64Array(Te*Te),this.f=new Float64Array(Te),this.z=new Float64Array(Te+1),this.v=new Uint16Array(Te)}return(0,be.Z)(e,[{key:"_createCanvas",value:function(t){var n=document.createElement("canvas");return n.width=n.height=t,n}},{key:"draw",value:function(t){var n=this.ctx.measureText(t),r=n.width,a=n.actualBoundingBoxAscent,u=n.actualBoundingBoxDescent,c=n.actualBoundingBoxLeft,g=n.actualBoundingBoxRight,x=Math.ceil(a),M=0,O=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(g-c))),B=Math.min(this.size-this.buffer,x+Math.ceil(u)),W=O+2*this.buffer,ce=B+2*this.buffer,oe=Math.max(W*ce,0),Te=new Uint8ClampedArray(oe),Ze={data:Te,width:W,height:ce,glyphWidth:O,glyphHeight:B,glyphTop:x,glyphLeft:M,glyphAdvance:r};if(O===0||B===0)return Ze;var qe=this.buffer,et=this.gridInner,yt=this.gridOuter,bt=this.ctx;bt.clearRect(qe,qe,O,B),bt.fillText(t,qe,qe+x);var Ot=bt.getImageData(qe,qe,O,B);yt.fill(Jo,0,oe),et.fill(0,0,oe);for(var jt=0;jt<B;jt++)for(var or=0;or<O;or++){var ar=Ot.data[4*(jt*O+or)+3]/255;if(ar!==0){var Sr=(jt+qe)*W+or+qe;if(ar===1)yt[Sr]=0,et[Sr]=Jo;else{var dr=.5-ar;yt[Sr]=dr>0?dr*dr:0,et[Sr]=dr<0?dr*dr:0}}}ft(yt,0,0,W,ce,W,this.f,this.v,this.z),ft(et,qe,qe,O,B,W,this.f,this.v,this.z);for(var jr=0;jr<oe;jr++){var nn=Math.sqrt(yt[jr])-Math.sqrt(et[jr]);Te[jr]=Math.round(255-255*(nn/this.radius+this.cutoff))}return Ze}}]),e}();function ft(e,i,t,n,r,a,u,c,g){for(var x=i;x<i+n;x++)Et(e,t*a+x,a,r,u,c,g);for(var M=t;M<t+r;M++)Et(e,M*a+i,1,n,u,c,g)}function Et(e,i,t,n,r,a,u){a[0]=0,u[0]=-Jo,u[1]=Jo,r[0]=e[i];for(var c=1,g=0,x=0;c<n;c++){r[c]=e[i+c*t];var M=c*c;do{var O=a[g];x=(r[c]-r[O]+M-O*O)/(c-O)/2}while(x<=u[g]&&--g>-1);g++,a[g]=c,u[g]=x,u[g+1]=Jo}for(var B=0,W=0;B<n;B++){for(;u[W+1]<B;)W++;var ce=a[W],oe=B-ce;e[i+B*t]=r[ce]+oe*oe}}function Ur(e,i){var t=typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=Un(e))||i&&e&&typeof e.length=="number"){t&&(e=t);var n=0,r=function(){};return{s:r,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(x){throw x},f:r}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var a=!0,u=!1,c;return{s:function(){t=t.call(e)},n:function(){var x=t.next();return a=x.done,x},e:function(x){u=!0,c=x},f:function(){try{!a&&t.return!=null&&t.return()}finally{if(u)throw c}}}}function Un(e,i){if(e){if(typeof e=="string")return ot(e,i);var t=Object.prototype.toString.call(e).slice(8,-1);if(t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set")return Array.from(e);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return ot(e,i)}}function ot(e,i){(i==null||i>e.length)&&(i=e.length);for(var t=0,n=new Array(i);t<i;t++)n[t]=e[t];return n}var Ye=30;function St(e){var i=e.characterSet,t=e.getFontWidth,n=e.fontHeight,r=e.buffer,a=e.maxCanvasWidth,u=e.mapping,c=u===void 0?{}:u,g=e.xOffset,x=g===void 0?0:g,M=e.yOffset,O=M===void 0?0:M,B=0,W=x;Array.from(i).forEach(function(oe,Te){if(!c[oe]){var Ze=t(oe,Te);W+Ye>a&&(W=0,B++),c[oe]={x:W,y:O+B*Ye,width:Ye,height:Ye,advance:Ze},W+=Ye}});var ce=n+r*2;return{mapping:c,xOffset:W,yOffset:O+B*ce,canvasHeight:h(O+(B+1)*ce)}}function Dt(e,i,t){var n=0,r=0,a=0,u=[],c={},g=Ur(e),x;try{for(g.s();!(x=g.n()).done;){var M=x.value;if(!c[M.id]){var O=M.size;n+O+i>t&&(Ft(c,u,r),n=0,r=a+r+i,a=0,u=[]),u.push({icon:M,xOffset:n}),n=n+O+i,a=Math.max(a,O)}}}catch(W){g.e(W)}finally{g.f()}u.length>0&&Ft(c,u,r);var B=h(a+r+i);return{mapping:c,canvasHeight:B}}function Ft(e,i,t){var n=Ur(i),r;try{for(n.s();!(r=n.n()).done;){var a=r.value,u=a.icon,c=a.xOffset;e[u.id]=(0,X.Z)((0,X.Z)({},u),{},{x:c,y:t,image:u.image,width:u.width,height:u.height})}}catch(g){n.e(g)}finally{n.f()}}function h(e){return Math.pow(2,Math.ceil(Math.log2(e)))}var f,p;function m(e,i){var t=typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=E(e))||i&&e&&typeof e.length=="number"){t&&(e=t);var n=0,r=function(){};return{s:r,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(x){throw x},f:r}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var a=!0,u=!1,c;return{s:function(){t=t.call(e)},n:function(){var x=t.next();return a=x.done,x},e:function(x){u=!0,c=x},f:function(){try{!a&&t.return!=null&&t.return()}finally{if(u)throw c}}}}function E(e,i){if(e){if(typeof e=="string")return S(e,i);var t=Object.prototype.toString.call(e).slice(8,-1);if(t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set")return Array.from(e);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return S(e,i)}}function S(e,i){(i==null||i>e.length)&&(i=e.length);for(var t=0,n=new Array(i);t<i;t++)n[t]=e[t];return n}function I(e){var i=D();return function(){var n=(0,ue.Z)(e),r;if(i){var a=(0,ue.Z)(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return(0,ze.Z)(this,r)}}function D(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var V=Yt(),re="sans-serif",xe="normal",Fe=24,ut=3,gt=.25,rt=8,_t=1024,$t=1,qt=1,Wt=3,rr=null;function Yt(){for(var e=[],i=32;i<128;i++)e.push(String.fromCharCode(i));return e}function rn(e,i,t,n){e.font="".concat(n," ").concat(t,"px ").concat(i),e.fillStyle="black",e.textBaseline="middle"}function xn(e,i){for(var t=0;t<e.length;t++)i.data[4*t+3]=e[t]}var Kr=(f=(0,vr.b2)(),f(p=function(e){(0,Ne.Z)(t,e);var i=I(t);function t(){var n;(0,se.Z)(this,t);for(var r=arguments.length,a=new Array(r),u=0;u<r;u++)a[u]=arguments[u];return n=i.call.apply(i,[this].concat(a)),(0,Me.Z)((0,xt.Z)(n),"fontAtlas",void 0),(0,Me.Z)((0,xt.Z)(n),"iconFontMap",void 0),(0,Me.Z)((0,xt.Z)(n),"iconFontGlyphs",{}),(0,Me.Z)((0,xt.Z)(n),"fontOptions",void 0),(0,Me.Z)((0,xt.Z)(n),"key",void 0),(0,Me.Z)((0,xt.Z)(n),"cache",new Xo(Wt)),n}return(0,be.Z)(t,[{key:"scale",get:function(){return qt}},{key:"canvas",get:function(){var r=this.cache.get(this.key);return r&&r.data}},{key:"mapping",get:function(){var r=this.cache.get(this.key);return r&&r.mapping||{}}},{key:"getCanvasByKey",value:function(r){var a=this.cache.get(r);return a&&a.data}},{key:"getMappingByKey",value:function(r){var a=this.cache.get(r);return a&&a.mapping||{}}},{key:"init",value:function(){this.cache.clear(),this.fontOptions={fontFamily:re,fontWeight:xe,characterSet:V,fontSize:Fe,buffer:ut,sdf:!0,cutoff:gt,radius:rt,iconfont:!1},this.key="",this.iconFontMap=new Map}},{key:"addIconGlyphs",value:function(r){var a=this;r.forEach(function(u){a.iconFontGlyphs[u.name]=u.unicode})}},{key:"addIconFont",value:function(r,a){this.iconFontMap.set(r,a)}},{key:"getIconFontKey",value:function(r){return this.iconFontMap.get(r)||r}},{key:"getGlyph",value:function(r){return this.iconFontGlyphs[r]?String.fromCharCode(parseInt(this.iconFontGlyphs[r],16)):""}},{key:"setFontOptions",value:function(r){this.fontOptions=(0,X.Z)((0,X.Z)({},this.fontOptions),r),this.key=this.getKey();var a=this.getNewChars(this.key,this.fontOptions.characterSet),u=this.cache.get(this.key);if(!(u&&a.length===0)){var c=this.generateFontAtlas(this.key,a,u);this.fontAtlas=c,this.cache.set(this.key,c)}}},{key:"addFontFace",value:function(r,a){var u=this,c=document.createElement("style");c.type="text/css",c.innerText=`
        @font-face{
            font-family: '`.concat(r,`';
            src: url('`).concat(a,`') format('woff2'),
            url('`).concat(a,`') format('woff'),
            url('`).concat(a,`') format('truetype');
        }`),c.onload=function(){if(document.fonts)try{document.fonts.load("24px ".concat(r),"L7text"),document.fonts.ready.then(function(){u.emit("fontloaded",{fontFamily:r})})}catch(g){console.warn("\u5F53\u524D\u73AF\u5883\u4E0D\u652F\u6301 document.fonts !"),console.warn("\u5F53\u524D\u73AF\u5883\u4E0D\u652F\u6301 iconfont !"),console.warn(g)}},document.getElementsByTagName("head")[0].appendChild(c)}},{key:"destroy",value:function(){this.cache.clear(),this.iconFontMap.clear()}},{key:"generateFontAtlas",value:function(r,a,u){var c=this.fontOptions,g=c.fontFamily,x=c.fontWeight,M=c.fontSize,O=c.buffer,B=c.sdf,W=c.radius,ce=c.cutoff,oe=c.iconfont,Te=u&&u.data;Te||(Te=window.document.createElement("canvas"),Te.width=_t);var Ze=Te.getContext("2d",{willReadFrequently:!0});rn(Ze,g,M,x);var qe=St((0,X.Z)({getFontWidth:function(Xg){return Ze.measureText(Xg).width},fontHeight:M*qt,buffer:O,characterSet:a,maxCanvasWidth:_t},u&&{mapping:u.mapping,xOffset:u.xOffset,yOffset:u.yOffset})),et=qe.mapping,yt=qe.canvasHeight,bt=qe.xOffset,Ot=qe.yOffset,jt=Ze.getImageData(0,0,Te.width,Te.height);if(Te.height=yt,Ze.putImageData(jt,0,0),rn(Ze,g,M,x),B){var or=new ct({fontSize:M,buffer:O,radius:W,cutoff:ce,fontFamily:g,fontWeight:x}),ar=m(a),Sr;try{for(ar.s();!(Sr=ar.n()).done;){var dr=Sr.value,jr=void 0;if(oe){var nn=String.fromCharCode(parseInt(dr.replace("&#x","").replace(";",""),16));jr=or.draw(nn)}else jr=or.draw(dr);var En=jr,_a=En.data,_s=En.width,ls=En.height,Ds=Ze.getImageData(0,0,_s,ls);xn(_a,Ds),Ze.putImageData(Ds,et[dr].x,et[dr].y)}}catch(mA){ar.e(mA)}finally{ar.f()}}else{var ks=m(a),Wc;try{for(ks.s();!(Wc=ks.n()).done;){var Dp=Wc.value;Ze.fillText(Dp,et[Dp].x,et[Dp].y+M*$t)}}catch(mA){ks.e(mA)}finally{ks.f()}}return{xOffset:bt,yOffset:Ot,mapping:et,data:Te,width:Te.width,height:Te.height}}},{key:"getKey",value:function(){var r=this.fontOptions,a=r.fontFamily,u=r.fontWeight;return"".concat(a,"_").concat(u)}},{key:"getNewChars",value:function(r,a){var u=this.cache.get(r);if(!u)return a;var c=[],g=u.mapping,x=new Set(Object.keys(g)),M=new Set(a);return M.forEach(function(O){x.has(O)||c.push(O)}),c}}]),t}(ha.EventEmitter))||p),pn,Pa;function ua(e){var i=va();return function(){var n=(0,ue.Z)(e),r;if(i){var a=(0,ue.Z)(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return(0,ze.Z)(this,r)}}function va(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var Vi=3,ci=1024,Di=64,Wa=(pn=(0,vr.b2)(),pn(Pa=function(e){(0,Ne.Z)(t,e);var i=ua(t);function t(){var n;(0,se.Z)(this,t);for(var r=arguments.length,a=new Array(r),u=0;u<r;u++)a[u]=arguments[u];return n=i.call.apply(i,[this].concat(a)),(0,Me.Z)((0,xt.Z)(n),"canvasHeight",128),(0,Me.Z)((0,xt.Z)(n),"texture",void 0),(0,Me.Z)((0,xt.Z)(n),"canvas",void 0),(0,Me.Z)((0,xt.Z)(n),"iconData",void 0),(0,Me.Z)((0,xt.Z)(n),"iconMap",void 0),(0,Me.Z)((0,xt.Z)(n),"ctx",void 0),(0,Me.Z)((0,xt.Z)(n),"loadingImageCount",0),n}return(0,be.Z)(t,[{key:"isLoading",value:function(){return this.loadingImageCount===0}},{key:"init",value:function(){this.iconData=[],this.iconMap={},this.canvas=window.document.createElement("canvas"),this.canvas.width=128,this.canvas.height=128,this.ctx=this.canvas.getContext("2d")}},{key:"addImage",value:function(){var n=(0,ur.Z)(it().mark(function a(u,c){var g,x;return it().wrap(function(O){for(;;)switch(O.prev=O.next){case 0:return g=new Image,this.loadingImageCount++,this.hasImage(u)?console.warn("Image Id already exists"):this.iconData.push({id:u,size:Di}),this.updateIconMap(),O.next=6,this.loadImage(c);case 6:g=O.sent,x=this.iconData.find(function(B){return B.id===u}),x&&(x.image=g,x.width=g.width,x.height=g.height),this.update();case 10:case"end":return O.stop()}},a,this)}));function r(a,u){return n.apply(this,arguments)}return r}()},{key:"addImageMini",value:function(r,a,u){var c=this,g=u.getSceneConfig().canvas,x=g.createImage();if(this.loadingImageCount++,this.hasImage(r))throw new Error("Image Id already exists");this.iconData.push({id:r,size:Di}),this.updateIconMap(),this.loadImageMini(a,g).then(function(M){x=M;var O=c.iconData.find(function(B){return B.id===r});O&&(O.image=x,O.width=x.width,O.height=x.height),c.update()})}},{key:"getTexture",value:function(){return this.texture}},{key:"getIconMap",value:function(){return this.iconMap}},{key:"getCanvas",value:function(){return this.canvas}},{key:"hasImage",value:function(r){return this.iconMap.hasOwnProperty(r)}},{key:"removeImage",value:function(r){this.hasImage(r)&&(this.iconData=this.iconData.filter(function(a){return a.id!==r}),delete this.iconMap[r],this.update())}},{key:"destroy",value:function(){this.removeAllListeners("imageUpdate"),this.iconData=[],this.iconMap={}}},{key:"loadImage",value:function(r){return new Promise(function(a,u){if(r instanceof HTMLImageElement){a(r);return}var c=new Image;c.crossOrigin="anonymous",c.onload=function(){a(c)},c.onerror=function(){u(new Error("Could not load image at "+r))},c.src=r instanceof File?URL.createObjectURL(r):r})}},{key:"update",value:function(){this.updateIconMap(),this.updateIconAtlas(),this.loadingImageCount--,this.loadingImageCount===0&&this.emit("imageUpdate")}},{key:"updateIconAtlas",value:function(){var r=this;this.canvas.width=ci,this.canvas.height=this.canvasHeight,Object.keys(this.iconMap).forEach(function(a){var u=r.iconMap[a],c=u.x,g=u.y,x=u.image,M=u.width,O=M===void 0?64:M,B=u.height,W=B===void 0?64:B,ce=Math.max(O,W),oe=ce/Di,Te=W/oe,Ze=O/oe;x&&r.ctx.drawImage(x,c+(Di-Ze)/2,g+(Di-Te)/2,Ze,Te)})}},{key:"updateIconMap",value:function(){var r=Dt(this.iconData,Vi,ci),a=r.mapping,u=r.canvasHeight;this.iconMap=a,this.canvasHeight=u}},{key:"loadImageMini",value:function(r,a){return new Promise(function(u,c){var g=a.createImage();g.crossOrigin="anonymous",g.onload=function(){u(g)},g.onerror=function(){c(new Error("Could not load image at "+r))},g.src=r})}}]),t}(ha.EventEmitter))||Pa);function Qn(){var e=new Go(16);return Go!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0),e[0]=1,e[5]=1,e[10]=1,e[15]=1,e}function Xa(e){var i=new Go(16);return i[0]=e[0],i[1]=e[1],i[2]=e[2],i[3]=e[3],i[4]=e[4],i[5]=e[5],i[6]=e[6],i[7]=e[7],i[8]=e[8],i[9]=e[9],i[10]=e[10],i[11]=e[11],i[12]=e[12],i[13]=e[13],i[14]=e[14],i[15]=e[15],i}function Iu(e,i){return e[0]=i[0],e[1]=i[1],e[2]=i[2],e[3]=i[3],e[4]=i[4],e[5]=i[5],e[6]=i[6],e[7]=i[7],e[8]=i[8],e[9]=i[9],e[10]=i[10],e[11]=i[11],e[12]=i[12],e[13]=i[13],e[14]=i[14],e[15]=i[15],e}function Q0(e,i,t,n,r,a,u,c,g,x,M,O,B,W,ce,oe){var Te=new Go(16);return Te[0]=e,Te[1]=i,Te[2]=t,Te[3]=n,Te[4]=r,Te[5]=a,Te[6]=u,Te[7]=c,Te[8]=g,Te[9]=x,Te[10]=M,Te[11]=O,Te[12]=B,Te[13]=W,Te[14]=ce,Te[15]=oe,Te}function EA(e,i,t,n,r,a,u,c,g,x,M,O,B,W,ce,oe,Te){return e[0]=i,e[1]=t,e[2]=n,e[3]=r,e[4]=a,e[5]=u,e[6]=c,e[7]=g,e[8]=x,e[9]=M,e[10]=O,e[11]=B,e[12]=W,e[13]=ce,e[14]=oe,e[15]=Te,e}function lv(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function Mh(e,i){if(e===i){var t=i[1],n=i[2],r=i[3],a=i[6],u=i[7],c=i[11];e[1]=i[4],e[2]=i[8],e[3]=i[12],e[4]=t,e[6]=i[9],e[7]=i[13],e[8]=n,e[9]=a,e[11]=i[14],e[12]=r,e[13]=u,e[14]=c}else e[0]=i[0],e[1]=i[4],e[2]=i[8],e[3]=i[12],e[4]=i[1],e[5]=i[5],e[6]=i[9],e[7]=i[13],e[8]=i[2],e[9]=i[6],e[10]=i[10],e[11]=i[14],e[12]=i[3],e[13]=i[7],e[14]=i[11],e[15]=i[15];return e}function kp(e,i){var t=i[0],n=i[1],r=i[2],a=i[3],u=i[4],c=i[5],g=i[6],x=i[7],M=i[8],O=i[9],B=i[10],W=i[11],ce=i[12],oe=i[13],Te=i[14],Ze=i[15],qe=t*c-n*u,et=t*g-r*u,yt=t*x-a*u,bt=n*g-r*c,Ot=n*x-a*c,jt=r*x-a*g,or=M*oe-O*ce,ar=M*Te-B*ce,Sr=M*Ze-W*ce,dr=O*Te-B*oe,jr=O*Ze-W*oe,nn=B*Ze-W*Te,En=qe*nn-et*jr+yt*dr+bt*Sr-Ot*ar+jt*or;return En?(En=1/En,e[0]=(c*nn-g*jr+x*dr)*En,e[1]=(r*jr-n*nn-a*dr)*En,e[2]=(oe*jt-Te*Ot+Ze*bt)*En,e[3]=(B*Ot-O*jt-W*bt)*En,e[4]=(g*Sr-u*nn-x*ar)*En,e[5]=(t*nn-r*Sr+a*ar)*En,e[6]=(Te*yt-ce*jt-Ze*et)*En,e[7]=(M*jt-B*yt+W*et)*En,e[8]=(u*jr-c*Sr+x*or)*En,e[9]=(n*Sr-t*jr-a*or)*En,e[10]=(ce*Ot-oe*yt+Ze*qe)*En,e[11]=(O*yt-M*Ot-W*qe)*En,e[12]=(c*ar-u*dr-g*or)*En,e[13]=(t*dr-n*ar+r*or)*En,e[14]=(oe*et-ce*bt-Te*qe)*En,e[15]=(M*bt-O*et+B*qe)*En,e):null}function Qg(e,i){var t=i[0],n=i[1],r=i[2],a=i[3],u=i[4],c=i[5],g=i[6],x=i[7],M=i[8],O=i[9],B=i[10],W=i[11],ce=i[12],oe=i[13],Te=i[14],Ze=i[15];return e[0]=c*(B*Ze-W*Te)-O*(g*Ze-x*Te)+oe*(g*W-x*B),e[1]=-(n*(B*Ze-W*Te)-O*(r*Ze-a*Te)+oe*(r*W-a*B)),e[2]=n*(g*Ze-x*Te)-c*(r*Ze-a*Te)+oe*(r*x-a*g),e[3]=-(n*(g*W-x*B)-c*(r*W-a*B)+O*(r*x-a*g)),e[4]=-(u*(B*Ze-W*Te)-M*(g*Ze-x*Te)+ce*(g*W-x*B)),e[5]=t*(B*Ze-W*Te)-M*(r*Ze-a*Te)+ce*(r*W-a*B),e[6]=-(t*(g*Ze-x*Te)-u*(r*Ze-a*Te)+ce*(r*x-a*g)),e[7]=t*(g*W-x*B)-u*(r*W-a*B)+M*(r*x-a*g),e[8]=u*(O*Ze-W*oe)-M*(c*Ze-x*oe)+ce*(c*W-x*O),e[9]=-(t*(O*Ze-W*oe)-M*(n*Ze-a*oe)+ce*(n*W-a*O)),e[10]=t*(c*Ze-x*oe)-u*(n*Ze-a*oe)+ce*(n*x-a*c),e[11]=-(t*(c*W-x*O)-u*(n*W-a*O)+M*(n*x-a*c)),e[12]=-(u*(O*Te-B*oe)-M*(c*Te-g*oe)+ce*(c*B-g*O)),e[13]=t*(O*Te-B*oe)-M*(n*Te-r*oe)+ce*(n*B-r*O),e[14]=-(t*(c*Te-g*oe)-u*(n*Te-r*oe)+ce*(n*g-r*c)),e[15]=t*(c*B-g*O)-u*(n*B-r*O)+M*(n*g-r*c),e}function bA(e){var i=e[0],t=e[1],n=e[2],r=e[3],a=e[4],u=e[5],c=e[6],g=e[7],x=e[8],M=e[9],O=e[10],B=e[11],W=e[12],ce=e[13],oe=e[14],Te=e[15],Ze=i*u-t*a,qe=i*c-n*a,et=i*g-r*a,yt=t*c-n*u,bt=t*g-r*u,Ot=n*g-r*c,jt=x*ce-M*W,or=x*oe-O*W,ar=x*Te-B*W,Sr=M*oe-O*ce,dr=M*Te-B*ce,jr=O*Te-B*oe;return Ze*jr-qe*dr+et*Sr+yt*ar-bt*or+Ot*jt}function ja(e,i,t){var n=i[0],r=i[1],a=i[2],u=i[3],c=i[4],g=i[5],x=i[6],M=i[7],O=i[8],B=i[9],W=i[10],ce=i[11],oe=i[12],Te=i[13],Ze=i[14],qe=i[15],et=t[0],yt=t[1],bt=t[2],Ot=t[3];return e[0]=et*n+yt*c+bt*O+Ot*oe,e[1]=et*r+yt*g+bt*B+Ot*Te,e[2]=et*a+yt*x+bt*W+Ot*Ze,e[3]=et*u+yt*M+bt*ce+Ot*qe,et=t[4],yt=t[5],bt=t[6],Ot=t[7],e[4]=et*n+yt*c+bt*O+Ot*oe,e[5]=et*r+yt*g+bt*B+Ot*Te,e[6]=et*a+yt*x+bt*W+Ot*Ze,e[7]=et*u+yt*M+bt*ce+Ot*qe,et=t[8],yt=t[9],bt=t[10],Ot=t[11],e[8]=et*n+yt*c+bt*O+Ot*oe,e[9]=et*r+yt*g+bt*B+Ot*Te,e[10]=et*a+yt*x+bt*W+Ot*Ze,e[11]=et*u+yt*M+bt*ce+Ot*qe,et=t[12],yt=t[13],bt=t[14],Ot=t[15],e[12]=et*n+yt*c+bt*O+Ot*oe,e[13]=et*r+yt*g+bt*B+Ot*Te,e[14]=et*a+yt*x+bt*W+Ot*Ze,e[15]=et*u+yt*M+bt*ce+Ot*qe,e}function Ks(e,i,t){var n=t[0],r=t[1],a=t[2],u,c,g,x,M,O,B,W,ce,oe,Te,Ze;return i===e?(e[12]=i[0]*n+i[4]*r+i[8]*a+i[12],e[13]=i[1]*n+i[5]*r+i[9]*a+i[13],e[14]=i[2]*n+i[6]*r+i[10]*a+i[14],e[15]=i[3]*n+i[7]*r+i[11]*a+i[15]):(u=i[0],c=i[1],g=i[2],x=i[3],M=i[4],O=i[5],B=i[6],W=i[7],ce=i[8],oe=i[9],Te=i[10],Ze=i[11],e[0]=u,e[1]=c,e[2]=g,e[3]=x,e[4]=M,e[5]=O,e[6]=B,e[7]=W,e[8]=ce,e[9]=oe,e[10]=Te,e[11]=Ze,e[12]=u*n+M*r+ce*a+i[12],e[13]=c*n+O*r+oe*a+i[13],e[14]=g*n+B*r+Te*a+i[14],e[15]=x*n+W*r+Ze*a+i[15]),e}function So(e,i,t){var n=t[0],r=t[1],a=t[2];return e[0]=i[0]*n,e[1]=i[1]*n,e[2]=i[2]*n,e[3]=i[3]*n,e[4]=i[4]*r,e[5]=i[5]*r,e[6]=i[6]*r,e[7]=i[7]*r,e[8]=i[8]*a,e[9]=i[9]*a,e[10]=i[10]*a,e[11]=i[11]*a,e[12]=i[12],e[13]=i[13],e[14]=i[14],e[15]=i[15],e}function Xl(e,i,t,n){var r=n[0],a=n[1],u=n[2],c=Math.hypot(r,a,u),g,x,M,O,B,W,ce,oe,Te,Ze,qe,et,yt,bt,Ot,jt,or,ar,Sr,dr,jr,nn,En,_a;return c<Ua?null:(c=1/c,r*=c,a*=c,u*=c,g=Math.sin(t),x=Math.cos(t),M=1-x,O=i[0],B=i[1],W=i[2],ce=i[3],oe=i[4],Te=i[5],Ze=i[6],qe=i[7],et=i[8],yt=i[9],bt=i[10],Ot=i[11],jt=r*r*M+x,or=a*r*M+u*g,ar=u*r*M-a*g,Sr=r*a*M-u*g,dr=a*a*M+x,jr=u*a*M+r*g,nn=r*u*M+a*g,En=a*u*M-r*g,_a=u*u*M+x,e[0]=O*jt+oe*or+et*ar,e[1]=B*jt+Te*or+yt*ar,e[2]=W*jt+Ze*or+bt*ar,e[3]=ce*jt+qe*or+Ot*ar,e[4]=O*Sr+oe*dr+et*jr,e[5]=B*Sr+Te*dr+yt*jr,e[6]=W*Sr+Ze*dr+bt*jr,e[7]=ce*Sr+qe*dr+Ot*jr,e[8]=O*nn+oe*En+et*_a,e[9]=B*nn+Te*En+yt*_a,e[10]=W*nn+Ze*En+bt*_a,e[11]=ce*nn+qe*En+Ot*_a,i!==e&&(e[12]=i[12],e[13]=i[13],e[14]=i[14],e[15]=i[15]),e)}function fc(e,i,t){var n=Math.sin(t),r=Math.cos(t),a=i[4],u=i[5],c=i[6],g=i[7],x=i[8],M=i[9],O=i[10],B=i[11];return i!==e&&(e[0]=i[0],e[1]=i[1],e[2]=i[2],e[3]=i[3],e[12]=i[12],e[13]=i[13],e[14]=i[14],e[15]=i[15]),e[4]=a*r+x*n,e[5]=u*r+M*n,e[6]=c*r+O*n,e[7]=g*r+B*n,e[8]=x*r-a*n,e[9]=M*r-u*n,e[10]=O*r-c*n,e[11]=B*r-g*n,e}function q0(e,i,t){var n=Math.sin(t),r=Math.cos(t),a=i[0],u=i[1],c=i[2],g=i[3],x=i[8],M=i[9],O=i[10],B=i[11];return i!==e&&(e[4]=i[4],e[5]=i[5],e[6]=i[6],e[7]=i[7],e[12]=i[12],e[13]=i[13],e[14]=i[14],e[15]=i[15]),e[0]=a*r-x*n,e[1]=u*r-M*n,e[2]=c*r-O*n,e[3]=g*r-B*n,e[8]=a*n+x*r,e[9]=u*n+M*r,e[10]=c*n+O*r,e[11]=g*n+B*r,e}function K0(e,i,t){var n=Math.sin(t),r=Math.cos(t),a=i[0],u=i[1],c=i[2],g=i[3],x=i[4],M=i[5],O=i[6],B=i[7];return i!==e&&(e[8]=i[8],e[9]=i[9],e[10]=i[10],e[11]=i[11],e[12]=i[12],e[13]=i[13],e[14]=i[14],e[15]=i[15]),e[0]=a*r+x*n,e[1]=u*r+M*n,e[2]=c*r+O*n,e[3]=g*r+B*n,e[4]=x*r-a*n,e[5]=M*r-u*n,e[6]=O*r-c*n,e[7]=B*r-g*n,e}function Qf(e,i){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=i[0],e[13]=i[1],e[14]=i[2],e[15]=1,e}function J0(e,i){return e[0]=i[0],e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=i[1],e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=i[2],e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function Lf(e,i,t){var n=t[0],r=t[1],a=t[2],u=Math.hypot(n,r,a),c,g,x;return u<Ua?null:(u=1/u,n*=u,r*=u,a*=u,c=Math.sin(i),g=Math.cos(i),x=1-g,e[0]=n*n*x+g,e[1]=r*n*x+a*c,e[2]=a*n*x-r*c,e[3]=0,e[4]=n*r*x-a*c,e[5]=r*r*x+g,e[6]=a*r*x+n*c,e[7]=0,e[8]=n*a*x+r*c,e[9]=r*a*x-n*c,e[10]=a*a*x+g,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e)}function hf(e,i){var t=Math.sin(i),n=Math.cos(i);return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=n,e[6]=t,e[7]=0,e[8]=0,e[9]=-t,e[10]=n,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function Af(e,i){var t=Math.sin(i),n=Math.cos(i);return e[0]=n,e[1]=0,e[2]=-t,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=t,e[9]=0,e[10]=n,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function SA(e,i){var t=Math.sin(i),n=Math.cos(i);return e[0]=n,e[1]=t,e[2]=0,e[3]=0,e[4]=-t,e[5]=n,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function CA(e,i,t){var n=i[0],r=i[1],a=i[2],u=i[3],c=n+n,g=r+r,x=a+a,M=n*c,O=n*g,B=n*x,W=r*g,ce=r*x,oe=a*x,Te=u*c,Ze=u*g,qe=u*x;return e[0]=1-(W+oe),e[1]=O+qe,e[2]=B-Ze,e[3]=0,e[4]=O-qe,e[5]=1-(M+oe),e[6]=ce+Te,e[7]=0,e[8]=B+Ze,e[9]=ce-Te,e[10]=1-(M+W),e[11]=0,e[12]=t[0],e[13]=t[1],e[14]=t[2],e[15]=1,e}function Np(e,i){var t=new Go(3),n=-i[0],r=-i[1],a=-i[2],u=i[3],c=i[4],g=i[5],x=i[6],M=i[7],O=n*n+r*r+a*a+u*u;return O>0?(t[0]=(c*u+M*n+g*a-x*r)*2/O,t[1]=(g*u+M*r+x*n-c*a)*2/O,t[2]=(x*u+M*a+c*r-g*n)*2/O):(t[0]=(c*u+M*n+g*a-x*r)*2,t[1]=(g*u+M*r+x*n-c*a)*2,t[2]=(x*u+M*a+c*r-g*n)*2),CA(e,i,t),e}function Fp(e,i){return e[0]=i[12],e[1]=i[13],e[2]=i[14],e}function wA(e,i){var t=i[0],n=i[1],r=i[2],a=i[4],u=i[5],c=i[6],g=i[8],x=i[9],M=i[10];return e[0]=Math.hypot(t,n,r),e[1]=Math.hypot(a,u,c),e[2]=Math.hypot(g,x,M),e}function cv(e,i){var t=new Go(3);wA(t,i);var n=1/t[0],r=1/t[1],a=1/t[2],u=i[0]*n,c=i[1]*r,g=i[2]*a,x=i[4]*n,M=i[5]*r,O=i[6]*a,B=i[8]*n,W=i[9]*r,ce=i[10]*a,oe=u+M+ce,Te=0;return oe>0?(Te=Math.sqrt(oe+1)*2,e[3]=.25*Te,e[0]=(O-W)/Te,e[1]=(B-g)/Te,e[2]=(c-x)/Te):u>M&&u>ce?(Te=Math.sqrt(1+u-M-ce)*2,e[3]=(O-W)/Te,e[0]=.25*Te,e[1]=(c+x)/Te,e[2]=(B+g)/Te):M>ce?(Te=Math.sqrt(1+M-u-ce)*2,e[3]=(B-g)/Te,e[0]=(c+x)/Te,e[1]=.25*Te,e[2]=(O+W)/Te):(Te=Math.sqrt(1+ce-u-M)*2,e[3]=(c-x)/Te,e[0]=(B+g)/Te,e[1]=(O+W)/Te,e[2]=.25*Te),e}function fv(e,i,t,n){var r=i[0],a=i[1],u=i[2],c=i[3],g=r+r,x=a+a,M=u+u,O=r*g,B=r*x,W=r*M,ce=a*x,oe=a*M,Te=u*M,Ze=c*g,qe=c*x,et=c*M,yt=n[0],bt=n[1],Ot=n[2];return e[0]=(1-(ce+Te))*yt,e[1]=(B+et)*yt,e[2]=(W-qe)*yt,e[3]=0,e[4]=(B-et)*bt,e[5]=(1-(O+Te))*bt,e[6]=(oe+Ze)*bt,e[7]=0,e[8]=(W+qe)*Ot,e[9]=(oe-Ze)*Ot,e[10]=(1-(O+ce))*Ot,e[11]=0,e[12]=t[0],e[13]=t[1],e[14]=t[2],e[15]=1,e}function Ml(e,i,t,n,r){var a=i[0],u=i[1],c=i[2],g=i[3],x=a+a,M=u+u,O=c+c,B=a*x,W=a*M,ce=a*O,oe=u*M,Te=u*O,Ze=c*O,qe=g*x,et=g*M,yt=g*O,bt=n[0],Ot=n[1],jt=n[2],or=r[0],ar=r[1],Sr=r[2],dr=(1-(oe+Ze))*bt,jr=(W+yt)*bt,nn=(ce-et)*bt,En=(W-yt)*Ot,_a=(1-(B+Ze))*Ot,_s=(Te+qe)*Ot,ls=(ce+et)*jt,Ds=(Te-qe)*jt,ks=(1-(B+oe))*jt;return e[0]=dr,e[1]=jr,e[2]=nn,e[3]=0,e[4]=En,e[5]=_a,e[6]=_s,e[7]=0,e[8]=ls,e[9]=Ds,e[10]=ks,e[11]=0,e[12]=t[0]+or-(dr*or+En*ar+ls*Sr),e[13]=t[1]+ar-(jr*or+_a*ar+Ds*Sr),e[14]=t[2]+Sr-(nn*or+_s*ar+ks*Sr),e[15]=1,e}function hv(e,i){var t=i[0],n=i[1],r=i[2],a=i[3],u=t+t,c=n+n,g=r+r,x=t*u,M=n*u,O=n*c,B=r*u,W=r*c,ce=r*g,oe=a*u,Te=a*c,Ze=a*g;return e[0]=1-O-ce,e[1]=M+Ze,e[2]=B-Te,e[3]=0,e[4]=M-Ze,e[5]=1-x-ce,e[6]=W+oe,e[7]=0,e[8]=B+Te,e[9]=W-oe,e[10]=1-x-O,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function Bp(e,i,t,n,r,a,u){var c=1/(t-i),g=1/(r-n),x=1/(a-u);return e[0]=a*2*c,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=a*2*g,e[6]=0,e[7]=0,e[8]=(t+i)*c,e[9]=(r+n)*g,e[10]=(u+a)*x,e[11]=-1,e[12]=0,e[13]=0,e[14]=u*a*2*x,e[15]=0,e}function Av(e,i,t,n,r){var a=1/Math.tan(i/2),u;return e[0]=a/t,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=a,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=-1,e[12]=0,e[13]=0,e[15]=0,r!=null&&r!==1/0?(u=1/(n-r),e[10]=(r+n)*u,e[14]=2*r*n*u):(e[10]=-1,e[14]=-2*n),e}var qf=Av;function Ih(e,i,t,n,r){var a=1/Math.tan(i/2),u;return e[0]=a/t,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=a,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=-1,e[12]=0,e[13]=0,e[15]=0,r!=null&&r!==1/0?(u=1/(n-r),e[10]=r*u,e[14]=r*n*u):(e[10]=-1,e[14]=-n),e}function Ph(e,i,t,n){var r=Math.tan(i.upDegrees*Math.PI/180),a=Math.tan(i.downDegrees*Math.PI/180),u=Math.tan(i.leftDegrees*Math.PI/180),c=Math.tan(i.rightDegrees*Math.PI/180),g=2/(u+c),x=2/(r+a);return e[0]=g,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=x,e[6]=0,e[7]=0,e[8]=-((u-c)*g*.5),e[9]=(r-a)*x*.5,e[10]=n/(t-n),e[11]=-1,e[12]=0,e[13]=0,e[14]=n*t/(t-n),e[15]=0,e}function eh(e,i,t,n,r,a,u){var c=1/(i-t),g=1/(n-r),x=1/(a-u);return e[0]=-2*c,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*g,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=2*x,e[11]=0,e[12]=(i+t)*c,e[13]=(r+n)*g,e[14]=(u+a)*x,e[15]=1,e}var Lh=eh;function Oh(e,i,t,n,r,a,u){var c=1/(i-t),g=1/(n-r),x=1/(a-u);return e[0]=-2*c,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*g,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=x,e[11]=0,e[12]=(i+t)*c,e[13]=(r+n)*g,e[14]=a*x,e[15]=1,e}function th(e,i,t,n){var r,a,u,c,g,x,M,O,B,W,ce=i[0],oe=i[1],Te=i[2],Ze=n[0],qe=n[1],et=n[2],yt=t[0],bt=t[1],Ot=t[2];return Math.abs(ce-yt)<Ua&&Math.abs(oe-bt)<Ua&&Math.abs(Te-Ot)<Ua?lv(e):(M=ce-yt,O=oe-bt,B=Te-Ot,W=1/Math.hypot(M,O,B),M*=W,O*=W,B*=W,r=qe*B-et*O,a=et*M-Ze*B,u=Ze*O-qe*M,W=Math.hypot(r,a,u),W?(W=1/W,r*=W,a*=W,u*=W):(r=0,a=0,u=0),c=O*u-B*a,g=B*r-M*u,x=M*a-O*r,W=Math.hypot(c,g,x),W?(W=1/W,c*=W,g*=W,x*=W):(c=0,g=0,x=0),e[0]=r,e[1]=c,e[2]=M,e[3]=0,e[4]=a,e[5]=g,e[6]=O,e[7]=0,e[8]=u,e[9]=x,e[10]=B,e[11]=0,e[12]=-(r*ce+a*oe+u*Te),e[13]=-(c*ce+g*oe+x*Te),e[14]=-(M*ce+O*oe+B*Te),e[15]=1,e)}function Rh(e,i,t,n){var r=i[0],a=i[1],u=i[2],c=n[0],g=n[1],x=n[2],M=r-t[0],O=a-t[1],B=u-t[2],W=M*M+O*O+B*B;W>0&&(W=1/Math.sqrt(W),M*=W,O*=W,B*=W);var ce=g*B-x*O,oe=x*M-c*B,Te=c*O-g*M;return W=ce*ce+oe*oe+Te*Te,W>0&&(W=1/Math.sqrt(W),ce*=W,oe*=W,Te*=W),e[0]=ce,e[1]=oe,e[2]=Te,e[3]=0,e[4]=O*Te-B*oe,e[5]=B*ce-M*Te,e[6]=M*oe-O*ce,e[7]=0,e[8]=M,e[9]=O,e[10]=B,e[11]=0,e[12]=r,e[13]=a,e[14]=u,e[15]=1,e}function TA(e){return"mat4("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+", "+e[8]+", "+e[9]+", "+e[10]+", "+e[11]+", "+e[12]+", "+e[13]+", "+e[14]+", "+e[15]+")"}function MA(e){return Math.hypot(e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8],e[9],e[10],e[11],e[12],e[13],e[14],e[15])}function IA(e,i,t){return e[0]=i[0]+t[0],e[1]=i[1]+t[1],e[2]=i[2]+t[2],e[3]=i[3]+t[3],e[4]=i[4]+t[4],e[5]=i[5]+t[5],e[6]=i[6]+t[6],e[7]=i[7]+t[7],e[8]=i[8]+t[8],e[9]=i[9]+t[9],e[10]=i[10]+t[10],e[11]=i[11]+t[11],e[12]=i[12]+t[12],e[13]=i[13]+t[13],e[14]=i[14]+t[14],e[15]=i[15]+t[15],e}function PA(e,i,t){return e[0]=i[0]-t[0],e[1]=i[1]-t[1],e[2]=i[2]-t[2],e[3]=i[3]-t[3],e[4]=i[4]-t[4],e[5]=i[5]-t[5],e[6]=i[6]-t[6],e[7]=i[7]-t[7],e[8]=i[8]-t[8],e[9]=i[9]-t[9],e[10]=i[10]-t[10],e[11]=i[11]-t[11],e[12]=i[12]-t[12],e[13]=i[13]-t[13],e[14]=i[14]-t[14],e[15]=i[15]-t[15],e}function Zp(e,i,t){return e[0]=i[0]*t,e[1]=i[1]*t,e[2]=i[2]*t,e[3]=i[3]*t,e[4]=i[4]*t,e[5]=i[5]*t,e[6]=i[6]*t,e[7]=i[7]*t,e[8]=i[8]*t,e[9]=i[9]*t,e[10]=i[10]*t,e[11]=i[11]*t,e[12]=i[12]*t,e[13]=i[13]*t,e[14]=i[14]*t,e[15]=i[15]*t,e}function Vu(e,i,t,n){return e[0]=i[0]+t[0]*n,e[1]=i[1]+t[1]*n,e[2]=i[2]+t[2]*n,e[3]=i[3]+t[3]*n,e[4]=i[4]+t[4]*n,e[5]=i[5]+t[5]*n,e[6]=i[6]+t[6]*n,e[7]=i[7]+t[7]*n,e[8]=i[8]+t[8]*n,e[9]=i[9]+t[9]*n,e[10]=i[10]+t[10]*n,e[11]=i[11]+t[11]*n,e[12]=i[12]+t[12]*n,e[13]=i[13]+t[13]*n,e[14]=i[14]+t[14]*n,e[15]=i[15]+t[15]*n,e}function Hu(e,i){return e[0]===i[0]&&e[1]===i[1]&&e[2]===i[2]&&e[3]===i[3]&&e[4]===i[4]&&e[5]===i[5]&&e[6]===i[6]&&e[7]===i[7]&&e[8]===i[8]&&e[9]===i[9]&&e[10]===i[10]&&e[11]===i[11]&&e[12]===i[12]&&e[13]===i[13]&&e[14]===i[14]&&e[15]===i[15]}function gu(e,i){var t=e[0],n=e[1],r=e[2],a=e[3],u=e[4],c=e[5],g=e[6],x=e[7],M=e[8],O=e[9],B=e[10],W=e[11],ce=e[12],oe=e[13],Te=e[14],Ze=e[15],qe=i[0],et=i[1],yt=i[2],bt=i[3],Ot=i[4],jt=i[5],or=i[6],ar=i[7],Sr=i[8],dr=i[9],jr=i[10],nn=i[11],En=i[12],_a=i[13],_s=i[14],ls=i[15];return Math.abs(t-qe)<=Ua*Math.max(1,Math.abs(t),Math.abs(qe))&&Math.abs(n-et)<=Ua*Math.max(1,Math.abs(n),Math.abs(et))&&Math.abs(r-yt)<=Ua*Math.max(1,Math.abs(r),Math.abs(yt))&&Math.abs(a-bt)<=Ua*Math.max(1,Math.abs(a),Math.abs(bt))&&Math.abs(u-Ot)<=Ua*Math.max(1,Math.abs(u),Math.abs(Ot))&&Math.abs(c-jt)<=Ua*Math.max(1,Math.abs(c),Math.abs(jt))&&Math.abs(g-or)<=Ua*Math.max(1,Math.abs(g),Math.abs(or))&&Math.abs(x-ar)<=Ua*Math.max(1,Math.abs(x),Math.abs(ar))&&Math.abs(M-Sr)<=Ua*Math.max(1,Math.abs(M),Math.abs(Sr))&&Math.abs(O-dr)<=Ua*Math.max(1,Math.abs(O),Math.abs(dr))&&Math.abs(B-jr)<=Ua*Math.max(1,Math.abs(B),Math.abs(jr))&&Math.abs(W-nn)<=Ua*Math.max(1,Math.abs(W),Math.abs(nn))&&Math.abs(ce-En)<=Ua*Math.max(1,Math.abs(ce),Math.abs(En))&&Math.abs(oe-_a)<=Ua*Math.max(1,Math.abs(oe),Math.abs(_a))&&Math.abs(Te-_s)<=Ua*Math.max(1,Math.abs(Te),Math.abs(_s))&&Math.abs(Ze-ls)<=Ua*Math.max(1,Math.abs(Ze),Math.abs(ls))}var hc=ja,LA=PA,x0,OA,pv=(x0=(0,vr.b2)(),x0(OA=function(){function e(){(0,se.Z)(this,e),(0,Me.Z)(this,"viewport",void 0),(0,Me.Z)(this,"overridedViewProjectionMatrix",void 0),(0,Me.Z)(this,"jitteredViewProjectionMatrix",void 0),(0,Me.Z)(this,"jitteredProjectionMatrix",void 0),(0,Me.Z)(this,"viewMatrixInverse",void 0),(0,Me.Z)(this,"cameraPosition",void 0)}return(0,be.Z)(e,[{key:"init",value:function(){}},{key:"update",value:function(t){this.viewport=t,this.viewMatrixInverse=Qn(),kp(this.viewMatrixInverse,t.getViewMatrix()),this.cameraPosition=[this.viewMatrixInverse[12],this.viewMatrixInverse[13],this.viewMatrixInverse[14]]}},{key:"getProjectionMatrix",value:function(){return this.jitteredProjectionMatrix||this.viewport.getProjectionMatrix()}},{key:"getModelMatrix",value:function(){return this.viewport.getModelMatrix()}},{key:"getViewMatrix",value:function(){return this.viewport.getViewMatrix()}},{key:"getViewMatrixUncentered",value:function(){return this.viewport.getViewMatrixUncentered()}},{key:"getViewProjectionMatrixUncentered",value:function(){return this.viewport.getViewProjectionMatrixUncentered()}},{key:"getViewProjectionMatrix",value:function(){return this.overridedViewProjectionMatrix||this.jitteredViewProjectionMatrix||this.viewport.getViewProjectionMatrix()}},{key:"getZoom",value:function(){return this.viewport.getZoom()}},{key:"getZoomScale",value:function(){return this.viewport.getZoomScale()}},{key:"getCenter",value:function(){var t=this.viewport.getCenter(),n=(0,vn.Z)(t,2),r=n[0],a=n[1];return[r,a]}},{key:"getFocalDistance",value:function(){return this.viewport.getFocalDistance()}},{key:"getCameraPosition",value:function(){return this.cameraPosition}},{key:"projectFlat",value:function(t,n){return this.viewport.projectFlat(t,n)}},{key:"setViewProjectionMatrix",value:function(t){this.overridedViewProjectionMatrix=t}},{key:"jitterProjectionMatrix",value:function(t,n){var r=Qf(Qn(),[t,n,0]);this.jitteredProjectionMatrix=ja(Qn(),r,this.viewport.getProjectionMatrix()),this.jitteredViewProjectionMatrix=ja(Qn(),this.jitteredProjectionMatrix,this.viewport.getViewMatrix())}},{key:"clearJitterProjectionMatrix",value:function(){this.jitteredProjectionMatrix=void 0,this.jitteredViewProjectionMatrix=void 0}}]),e}())||OA),Dh=function(e){return e.TOPRIGHT="topright",e.TOPLEFT="topleft",e.BOTTOMRIGHT="bottomright",e.BOTTOMLEFT="bottomleft",e.TOPCENTER="topcenter",e.BOTTOMCENTER="bottomcenter",e.LEFTCENTER="leftcenter",e.RIGHTCENTER="rightcenter",e.LEFTTOP="lefttop",e.RIGHTTOP="righttop",e.LEFTBOTTOM="leftbottom",e.RIGHTBOTTOM="rightbottom",e}({}),RA,zp;function dv(e,i){var t=typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=vv(e))||i&&e&&typeof e.length=="number"){t&&(e=t);var n=0,r=function(){};return{s:r,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(x){throw x},f:r}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var a=!0,u=!1,c;return{s:function(){t=t.call(e)},n:function(){var x=t.next();return a=x.done,x},e:function(x){u=!0,c=x},f:function(){try{!a&&t.return!=null&&t.return()}finally{if(u)throw c}}}}function vv(e,i){if(e){if(typeof e=="string")return DA(e,i);var t=Object.prototype.toString.call(e).slice(8,-1);if(t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set")return Array.from(e);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return DA(e,i)}}function DA(e,i){(i==null||i>e.length)&&(i=e.length);for(var t=0,n=new Array(i);t<i;t++)n[t]=e[t];return n}var qg={topleft:"column",topright:"column",bottomright:"column",bottomleft:"column",leftcenter:"column",rightcenter:"column",topcenter:"row",bottomcenter:"row",lefttop:"row",righttop:"row",leftbottom:"row",rightbottom:"row"},kA=(RA=(0,vr.b2)(),RA(zp=function(){function e(){(0,se.Z)(this,e),(0,Me.Z)(this,"container",void 0),(0,Me.Z)(this,"controlCorners",void 0),(0,Me.Z)(this,"controlContainer",void 0),(0,Me.Z)(this,"scene",void 0),(0,Me.Z)(this,"mapsService",void 0),(0,Me.Z)(this,"controls",[]),(0,Me.Z)(this,"unAddControls",[])}return(0,be.Z)(e,[{key:"init",value:function(t,n){this.container=t.container,this.scene=n,this.mapsService=n.get(Xt.IMapService),this.initControlPos()}},{key:"addControl",value:function(t,n){var r=n.get(Xt.IMapService);r.map?(t.addTo(this.scene),this.controls.push(t)):this.unAddControls.push(t)}},{key:"getControlByName",value:function(t){return this.controls.find(function(n){return n.controlOption.name===t})}},{key:"removeControl",value:function(t){var n=this.controls.indexOf(t);return n>-1&&this.controls.splice(n,1),t.remove(),this}},{key:"addControls",value:function(){var t=this;this.unAddControls.forEach(function(n){n.addTo(t.scene),t.controls.push(n)}),this.unAddControls=[]}},{key:"destroy",value:function(){var t=dv(this.controls),n;try{for(t.s();!(n=t.n()).done;){var r=n.value;r.remove()}}catch(a){t.e(a)}finally{t.f()}this.controls=[],this.clearControlPos()}},{key:"initControlPos",value:function(){var t=this.controlCorners={},n="l7-",r=this.controlContainer=ni("div",n+"control-container",this.container);function a(){var c=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],g=c.map(function(x){return n+x}).join(" ");t[c.filter(function(x){return!["row","column"].includes(x)}).join("")]=ni("div",g,r)}function u(c){var g=c.replace(/^(top|bottom|left|right|center)/,"$1-").split("-");return[].concat((0,pr.Z)(g),[qg[c]])}Object.values(Dh).forEach(function(c){a(u(c))}),this.checkCornerOverlap()}},{key:"clearControlPos",value:function(){for(var t in this.controlCorners)this.controlCorners[t]&&Ro(this.controlCorners[t]);this.controlContainer&&Ro(this.controlContainer)}},{key:"checkCornerOverlap",value:function(){var t=this,n=window.MutationObserver;if(n)for(var r=function(){var g=u[a],x=g.match(/^(top|bottom)(left|right)$/);if(x){var M=(0,vn.Z)(x,3),O=M[1],B=M[2],W=t.controlCorners["".concat(O).concat(B)],ce=new n(function(oe){var Te=(0,vn.Z)(oe,1),Ze=Te[0].target;W&&(W.style[O]=Ze.clientHeight+"px")});ce.observe(t.controlCorners["".concat(B).concat(O)],{childList:!0,attributes:!0})}},a=0,u=Object.keys(this.controlCorners);a<u.length;a++)r()}}]),e}())||zp),Up,NA,Gp=(Up=(0,vr.b2)(),Up(NA=function(){function e(){(0,se.Z)(this,e),(0,Me.Z)(this,"container",void 0),(0,Me.Z)(this,"scene",void 0),(0,Me.Z)(this,"mapsService",void 0),(0,Me.Z)(this,"markers",[]),(0,Me.Z)(this,"markerLayers",[]),(0,Me.Z)(this,"unAddMarkers",[]),(0,Me.Z)(this,"unAddMarkerLayers",[])}return(0,be.Z)(e,[{key:"addMarkerLayer",value:function(t){this.mapsService.map&&this.mapsService.getMarkerContainer()?(this.markerLayers.push(t),t.addTo(this.scene)):this.unAddMarkerLayers.push(t)}},{key:"removeMarkerLayer",value:function(t){t.destroy(),this.markerLayers.indexOf(t);var n=this.markerLayers.indexOf(t);n>-1&&this.markerLayers.splice(n,1)}},{key:"addMarker",value:function(t){this.mapsService.map&&this.mapsService.getMarkerContainer()?(this.markers.push(t),t.addTo(this.scene)):this.unAddMarkers.push(t)}},{key:"addMarkers",value:function(){var t=this;this.unAddMarkers.forEach(function(n){n.addTo(t.scene),t.markers.push(n)}),this.unAddMarkers=[]}},{key:"addMarkerLayers",value:function(){var t=this;this.unAddMarkerLayers.forEach(function(n){t.markerLayers.push(n),n.addTo(t.scene)}),this.unAddMarkers=[]}},{key:"removeMarker",value:function(t){t.remove(),this.markers.indexOf(t);var n=this.markers.indexOf(t);n>-1&&this.markers.splice(n,1)}},{key:"removeAllMarkers",value:function(){this.destroy()}},{key:"init",value:function(t){this.scene=t,this.mapsService=t.get(Xt.IMapService)}},{key:"destroy",value:function(){this.markers.forEach(function(t){t.remove()}),this.markers=[],this.markerLayers.forEach(function(t){t.destroy()}),this.markerLayers=[]}},{key:"removeMakerLayerMarker",value:function(t){t.destroy()}}]),e}())||NA),FA,gv,mv=(FA=(0,vr.b2)(),FA(gv=function(){function e(){(0,se.Z)(this,e),(0,Me.Z)(this,"scene",void 0),(0,Me.Z)(this,"mapsService",void 0),(0,Me.Z)(this,"popups",[]),(0,Me.Z)(this,"unAddPopups",[])}return(0,be.Z)(e,[{key:"isMarkerReady",get:function(){return this.mapsService.map&&this.mapsService.getMarkerContainer()}},{key:"removePopup",value:function(t){t!=null&&t.isOpen()&&t.remove();var n=this.popups.indexOf(t);n>-1&&this.popups.splice(n,1);var r=this.unAddPopups.indexOf(t);r>-1&&this.unAddPopups.splice(r,1)}},{key:"destroy",value:function(){this.popups.forEach(function(t){return t.remove()})}},{key:"addPopup",value:function(t){var n=this;t&&t.getOptions().autoClose&&[].concat((0,pr.Z)(this.popups),(0,pr.Z)(this.unAddPopups)).forEach(function(r){r.getOptions().autoClose&&n.removePopup(r)}),this.isMarkerReady?(t.addTo(this.scene),this.popups.push(t)):this.unAddPopups.push(t),t.on("close",function(){n.removePopup(t)})}},{key:"initPopup",value:function(){var t=this;this.unAddPopups.length&&this.unAddPopups.forEach(function(n){t.addPopup(n),t.unAddPopups=[]})}},{key:"init",value:function(t){this.scene=t,this.mapsService=t.get(Xt.IMapService)}}]),e}())||gv),pf=function(e){return e.normal="normal",e.additive="additive",e.subtractive="subtractive",e.min="min",e.max="max",e.none="none",e}({}),E0=function(e){return e.MULTIPLE="MULTIPLE",e.SINGLE="SINGLE",e}({}),kh=function(e){return e.AND="and",e.OR="or",e}({}),us=function(e){return e.INIT="init",e.UPDATE="update",e}({}),yv={MapToken:"\u60A8\u6B63\u5728\u4F7F\u7528 Demo \u6D4B\u8BD5 Token, \u751F\u4EA7\u73AF\u5883\u52A1\u5FC5\u81EA\u884C\u6CE8\u518C Token \u786E\u4FDD\u670D\u52A1\u7A33\u5B9A \u9AD8\u5FB7\u5730\u56FE\u7533\u8BF7\u5730\u5740 https://lbs.amap.com/api/javascript-api/guide/abc/prepare  Mapbox\u5730\u56FE\u7533\u8BF7\u5730\u5740 https://docs.mapbox.com/help/glossary/access-token/",SDK:"\u8BF7\u786E\u8BA4\u5F15\u5165\u4E86mapbox-gl api\u4E14\u5728L7\u4E4B\u524D\u5F15\u5165"},jp=yv,Vp,b0,Nh=In.merge,_v={id:"map",logoPosition:"bottomleft",logoVisible:!0,antialias:!0,stencil:!0,preserveDrawingBuffer:!1,pickBufferScale:1,fitBoundsOptions:{animate:!1}},Kg={colors:["rgb(103,0,31)","rgb(178,24,43)","rgb(214,96,77)","rgb(244,165,130)","rgb(253,219,199)","rgb(247,247,247)","rgb(209,229,240)","rgb(146,197,222)","rgb(67,147,195)","rgb(33,102,172)","rgb(5,48,97)"],size:10,shape:"circle",scales:{},shape2d:["circle","triangle","square","pentagon","hexagon","octogon","hexagram","rhombus","vesica"],shape3d:["cylinder","triangleColumn","hexagonColumn","squareColumn"],minZoom:-1,maxZoom:24,visible:!0,autoFit:!1,pickingBuffer:0,enablePropagation:!1,zIndex:0,blend:"normal",maskLayers:[],enableMask:!0,maskOperation:kh.AND,pickedFeatureID:-1,enableMultiPassRenderer:!1,enablePicking:!0,active:!1,activeColor:"#2f54eb",enableHighlight:!1,enableSelect:!1,highlightColor:"#2f54eb",activeMix:0,selectColor:"blue",selectMix:0,enableTAA:!1,jitterScale:1,enableLighting:!1,animateOption:{enable:!1,interval:.2,duration:4,trailLength:.15},forward:!0},BA=(Vp=(0,vr.b2)(),Vp(b0=function(){function e(){(0,se.Z)(this,e),(0,Me.Z)(this,"sceneConfigCache",{}),(0,Me.Z)(this,"layerConfigCache",{}),(0,Me.Z)(this,"layerAttributeConfigCache",{})}return(0,be.Z)(e,[{key:"getSceneConfig",value:function(t){return this.sceneConfigCache[t]}},{key:"getSceneWarninfo",value:function(t){return jp[t]}},{key:"setSceneConfig",value:function(t,n){this.sceneConfigCache[t]=(0,X.Z)((0,X.Z)({},_v),n)}},{key:"getLayerConfig",value:function(t){return this.layerConfigCache[t]}},{key:"setLayerConfig",value:function(t,n,r){this.layerConfigCache[n]=(0,X.Z)({},Nh({},this.sceneConfigCache[t],Kg,r))}},{key:"getAttributeConfig",value:function(t){return this.layerAttributeConfigCache[t]}},{key:"setAttributeConfig",value:function(t,n){this.layerAttributeConfigCache[t]=(0,X.Z)((0,X.Z)({},this.layerAttributeConfigCache[t]),n)}},{key:"clean",value:function(){this.sceneConfigCache={},this.layerConfigCache={}}}]),e}())||b0);function Ki(e,i,t,n){t&&Object.defineProperty(e,i,{enumerable:t.enumerable,configurable:t.configurable,writable:t.writable,value:t.initializer?t.initializer.call(n):void 0})}function Hi(e,i,t,n,r){var a={};return Object.keys(n).forEach(function(u){a[u]=n[u]}),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=t.slice().reverse().reduce(function(u,c){return c(e,i,u)||u},a),r&&a.initializer!==void 0&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),a.initializer===void 0&&(Object.defineProperty(e,i,a),a=null),a}function Fh(){var e=new Go(4);return Go!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0,e[3]=0),e}function ZA(e){var i=new glMatrix.ARRAY_TYPE(4);return i[0]=e[0],i[1]=e[1],i[2]=e[2],i[3]=e[3],i}function Bh(e,i,t,n){var r=new Go(4);return r[0]=e,r[1]=i,r[2]=t,r[3]=n,r}function rh(e,i){return e[0]=i[0],e[1]=i[1],e[2]=i[2],e[3]=i[3],e}function Jg(e,i,t,n,r){return e[0]=i,e[1]=t,e[2]=n,e[3]=r,e}function em(e,i,t){return e[0]=i[0]+t[0],e[1]=i[1]+t[1],e[2]=i[2]+t[2],e[3]=i[3]+t[3],e}function tm(e,i,t){return e[0]=i[0]-t[0],e[1]=i[1]-t[1],e[2]=i[2]-t[2],e[3]=i[3]-t[3],e}function rm(e,i,t){return e[0]=i[0]*t[0],e[1]=i[1]*t[1],e[2]=i[2]*t[2],e[3]=i[3]*t[3],e}function nm(e,i,t){return e[0]=i[0]/t[0],e[1]=i[1]/t[1],e[2]=i[2]/t[2],e[3]=i[3]/t[3],e}function Hp(e,i){return e[0]=Math.ceil(i[0]),e[1]=Math.ceil(i[1]),e[2]=Math.ceil(i[2]),e[3]=Math.ceil(i[3]),e}function im(e,i){return e[0]=Math.floor(i[0]),e[1]=Math.floor(i[1]),e[2]=Math.floor(i[2]),e[3]=Math.floor(i[3]),e}function zA(e,i,t){return e[0]=Math.min(i[0],t[0]),e[1]=Math.min(i[1],t[1]),e[2]=Math.min(i[2],t[2]),e[3]=Math.min(i[3],t[3]),e}function xv(e,i,t){return e[0]=Math.max(i[0],t[0]),e[1]=Math.max(i[1],t[1]),e[2]=Math.max(i[2],t[2]),e[3]=Math.max(i[3],t[3]),e}function Ev(e,i){return e[0]=Math.round(i[0]),e[1]=Math.round(i[1]),e[2]=Math.round(i[2]),e[3]=Math.round(i[3]),e}function Zh(e,i,t){return e[0]=i[0]*t,e[1]=i[1]*t,e[2]=i[2]*t,e[3]=i[3]*t,e}function bv(e,i,t,n){return e[0]=i[0]+t[0]*n,e[1]=i[1]+t[1]*n,e[2]=i[2]+t[2]*n,e[3]=i[3]+t[3]*n,e}function Sv(e,i){var t=i[0]-e[0],n=i[1]-e[1],r=i[2]-e[2],a=i[3]-e[3];return Math.hypot(t,n,r,a)}function Cv(e,i){var t=i[0]-e[0],n=i[1]-e[1],r=i[2]-e[2],a=i[3]-e[3];return t*t+n*n+r*r+a*a}function am(e){var i=e[0],t=e[1],n=e[2],r=e[3];return Math.hypot(i,t,n,r)}function wv(e){var i=e[0],t=e[1],n=e[2],r=e[3];return i*i+t*t+n*n+r*r}function Tx(e,i){return e[0]=-i[0],e[1]=-i[1],e[2]=-i[2],e[3]=-i[3],e}function Tv(e,i){return e[0]=1/i[0],e[1]=1/i[1],e[2]=1/i[2],e[3]=1/i[3],e}function Mv(e,i){var t=i[0],n=i[1],r=i[2],a=i[3],u=t*t+n*n+r*r+a*a;return u>0&&(u=1/Math.sqrt(u)),e[0]=t*u,e[1]=n*u,e[2]=r*u,e[3]=a*u,e}function om(e,i){return e[0]*i[0]+e[1]*i[1]+e[2]*i[2]+e[3]*i[3]}function Mx(e,i,t,n){var r=t[0]*n[1]-t[1]*n[0],a=t[0]*n[2]-t[2]*n[0],u=t[0]*n[3]-t[3]*n[0],c=t[1]*n[2]-t[2]*n[1],g=t[1]*n[3]-t[3]*n[1],x=t[2]*n[3]-t[3]*n[2],M=i[0],O=i[1],B=i[2],W=i[3];return e[0]=O*x-B*g+W*c,e[1]=-(M*x)+B*u-W*a,e[2]=M*g-O*u+W*r,e[3]=-(M*c)+O*a-B*r,e}function Ix(e,i,t,n){var r=i[0],a=i[1],u=i[2],c=i[3];return e[0]=r+n*(t[0]-r),e[1]=a+n*(t[1]-a),e[2]=u+n*(t[2]-u),e[3]=c+n*(t[3]-c),e}function $p(e,i){i=i||1;var t,n,r,a,u,c;do t=glMatrix.RANDOM()*2-1,n=glMatrix.RANDOM()*2-1,u=t*t+n*n;while(u>=1);do r=glMatrix.RANDOM()*2-1,a=glMatrix.RANDOM()*2-1,c=r*r+a*a;while(c>=1);var g=Math.sqrt((1-u)/c);return e[0]=i*t,e[1]=i*n,e[2]=i*r*g,e[3]=i*a*g,e}function nh(e,i,t){var n=i[0],r=i[1],a=i[2],u=i[3];return e[0]=t[0]*n+t[4]*r+t[8]*a+t[12]*u,e[1]=t[1]*n+t[5]*r+t[9]*a+t[13]*u,e[2]=t[2]*n+t[6]*r+t[10]*a+t[14]*u,e[3]=t[3]*n+t[7]*r+t[11]*a+t[15]*u,e}function Iv(e,i,t){var n=i[0],r=i[1],a=i[2],u=t[0],c=t[1],g=t[2],x=t[3],M=x*n+c*a-g*r,O=x*r+g*n-u*a,B=x*a+u*r-c*n,W=-u*n-c*r-g*a;return e[0]=M*x+W*-u+O*-g-B*-c,e[1]=O*x+W*-c+B*-u-M*-g,e[2]=B*x+W*-g+M*-c-O*-u,e[3]=i[3],e}function Pv(e){return e[0]=0,e[1]=0,e[2]=0,e[3]=0,e}function Yp(e){return"vec4("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+")"}function Wp(e,i){return e[0]===i[0]&&e[1]===i[1]&&e[2]===i[2]&&e[3]===i[3]}function S0(e,i){var t=e[0],n=e[1],r=e[2],a=e[3],u=i[0],c=i[1],g=i[2],x=i[3];return Math.abs(t-u)<=glMatrix.EPSILON*Math.max(1,Math.abs(t),Math.abs(u))&&Math.abs(n-c)<=glMatrix.EPSILON*Math.max(1,Math.abs(n),Math.abs(c))&&Math.abs(r-g)<=glMatrix.EPSILON*Math.max(1,Math.abs(r),Math.abs(g))&&Math.abs(a-x)<=glMatrix.EPSILON*Math.max(1,Math.abs(a),Math.abs(x))}var sm=null,um=null,Lv=null,lm=null,Px=null,ih=null,UA=null,zh=function(){var e=Fh();return function(i,t,n,r,a,u){var c,g;for(t||(t=4),n||(n=0),r?g=Math.min(r*t+n,i.length):g=i.length,c=n;c<g;c+=t)e[0]=i[c],e[1]=i[c+1],e[2]=i[c+2],e[3]=i[c+3],a(e,e,u),i[c]=e[0],i[c+1]=e[1],i[c+2]=e[2],i[c+3]=e[3];return i}}(),C0=Math.PI/180,cm=512,Xp=4003e4;function Ov(e){var i=e.latitude,t=i===void 0?0:i,n=e.zoom,r=n===void 0?0:n,a=e.scale,u=e.highPrecision,c=u===void 0?!1:u,g=e.flipY,x=g===void 0?!1:g;a=a!==void 0?a:Math.pow(2,r);var M={},O=cm*a,B=Math.cos(t*C0),W=O/360,ce=W/B,oe=O/Xp/B;if(M.pixelsPerMeter=[oe,-oe,oe],M.metersPerPixel=[1/oe,-1/oe,1/oe],M.pixelsPerDegree=[W,-ce,oe],M.degreesPerPixel=[1/W,-1/ce,1/oe],c){var Te=C0*Math.tan(t*C0)/B,Ze=W*Te/2,qe=O/Xp*Te,et=qe/ce*oe;M.pixelsPerDegree2=[0,-Ze,qe],M.pixelsPerMeter2=[et,0,et],x&&(M.pixelsPerDegree2[1]=-M.pixelsPerDegree2[1],M.pixelsPerMeter2[1]=-M.pixelsPerMeter2[1])}return x&&(M.pixelsPerMeter[1]=-M.pixelsPerMeter[1],M.metersPerPixel[1]=-M.metersPerPixel[1],M.pixelsPerDegree[1]=-M.pixelsPerDegree[1],M.degreesPerPixel[1]=-M.degreesPerPixel[1]),M}var Bc=function(e){return e[e.LNGLAT=1]="LNGLAT",e[e.LNGLAT_OFFSET=2]="LNGLAT_OFFSET",e[e.VECTOR_TILE=3]="VECTOR_TILE",e[e.IDENTITY=4]="IDENTITY",e[e.P20=5]="P20",e[e.P20_OFFSET=6]="P20_OFFSET",e[e.METER_OFFSET=7]="METER_OFFSET",e[e.P20_2=8]="P20_2",e}({}),df={CoordinateSystem:"u_CoordinateSystem",ViewportCenter:"u_ViewportCenter",ViewportCenterProjection:"u_ViewportCenterProjection",PixelsPerDegree:"u_PixelsPerDegree",PixelsPerDegree2:"u_PixelsPerDegree2",PixelsPerMeter:"u_PixelsPerMeter",Mvp:"u_Mvp"},w0,ah,oh,Of,Uh,GA=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0],sh=(w0=(0,vr.b2)(),ah=(0,vr.f3)(Xt.ICameraService),w0(oh=(Of=function(){function e(){(0,se.Z)(this,e),(0,Me.Z)(this,"needRefresh",!0),Ki(this,"cameraService",Uh,this),(0,Me.Z)(this,"coordinateSystem",void 0),(0,Me.Z)(this,"viewportCenter",void 0),(0,Me.Z)(this,"viewportCenterProjection",void 0),(0,Me.Z)(this,"pixelsPerDegree",void 0),(0,Me.Z)(this,"pixelsPerDegree2",void 0),(0,Me.Z)(this,"pixelsPerMeter",void 0)}return(0,be.Z)(e,[{key:"refresh",value:function(t){var n=this.cameraService.getZoom(),r=this.cameraService.getZoomScale(),a=t||this.cameraService.getCenter(),u=Ov({latitude:a[1],zoom:n}),c=u.pixelsPerMeter,g=u.pixelsPerDegree;this.viewportCenter=a,this.viewportCenterProjection=[0,0,0,0],this.pixelsPerMeter=c,this.pixelsPerDegree=g,this.pixelsPerDegree2=[0,0,0],this.coordinateSystem===Bc.LNGLAT||this.coordinateSystem===Bc.P20?this.cameraService.setViewProjectionMatrix(void 0):this.coordinateSystem===Bc.LNGLAT_OFFSET?this.calculateLnglatOffset(a,n):this.coordinateSystem===Bc.P20_OFFSET&&this.calculateLnglatOffset(a,n,r,!0),this.needRefresh=!1}},{key:"getCoordinateSystem",value:function(){return this.coordinateSystem}},{key:"setCoordinateSystem",value:function(t){this.coordinateSystem=t}},{key:"getViewportCenter",value:function(){return this.viewportCenter}},{key:"getViewportCenterProjection",value:function(){return this.viewportCenterProjection}},{key:"getPixelsPerDegree",value:function(){return this.pixelsPerDegree}},{key:"getPixelsPerDegree2",value:function(){return this.pixelsPerDegree2}},{key:"getPixelsPerMeter",value:function(){return this.pixelsPerMeter}},{key:"calculateLnglatOffset",value:function(t,n,r,a){var u=Ov({latitude:t[1],zoom:n,scale:r,flipY:a,highPrecision:!0}),c=u.pixelsPerMeter,g=u.pixelsPerDegree,x=u.pixelsPerDegree2,M=this.cameraService.getViewMatrix(),O=this.cameraService.getProjectionMatrix(),B=ja([],O,M),W=this.cameraService.projectFlat([Math.fround(t[0]),Math.fround(t[1])],Math.pow(2,n));this.viewportCenterProjection=nh([],[W[0],W[1],0,1],B),M=this.cameraService.getViewMatrixUncentered()||M,B=ja([],O,M),B=ja([],B,GA),this.cameraService.setViewProjectionMatrix(B),this.pixelsPerMeter=c,this.pixelsPerDegree=g,this.pixelsPerDegree2=x}}]),e}(),Uh=Hi(Of.prototype,"cameraService",[ah],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Of))||oh),jA,VA;function Zc(e){var i=zc();return function(){var n=(0,ue.Z)(e),r;if(i){var a=(0,ue.Z)(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return(0,ze.Z)(this,r)}}function zc(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var Uc=(jA=(0,vr.b2)(),jA(VA=function(e){(0,Ne.Z)(t,e);var i=Zc(t);function t(){var n;(0,se.Z)(this,t);for(var r=arguments.length,a=new Array(r),u=0;u<r;u++)a[u]=arguments[u];return n=i.call.apply(i,[this].concat(a)),(0,Me.Z)((0,xt.Z)(n),"renderMap",new Map),(0,Me.Z)((0,xt.Z)(n),"enable",!1),(0,Me.Z)((0,xt.Z)(n),"renderEnable",!1),(0,Me.Z)((0,xt.Z)(n),"cacheLogs",{}),n}return(0,be.Z)(t,[{key:"setEnable",value:function(r){this.enable=!!r}},{key:"log",value:function(r,a){var u=this;if(this.enable){var c=r.split("."),g=null;c.forEach(function(x,M){g!==null?(g[x]||(g[x]={}),M!==c.length-1&&(g=g[x])):(u.cacheLogs[x]||(u.cacheLogs[x]={}),M!==c.length-1&&(g=u.cacheLogs[x])),M===c.length-1&&(g[x]=(0,X.Z)((0,X.Z)({time:Date.now()},g[x]),a))})}}},{key:"getLog",value:function(r){var a=this;switch((0,ia.Z)(r)){case"string":return this.cacheLogs[r];case"object":return r.map(function(u){return a.cacheLogs[u]}).filter(function(u){return u!==void 0});case"undefined":return this.cacheLogs}}},{key:"removeLog",value:function(r){delete this.cacheLogs[r]}},{key:"generateRenderUid",value:function(){return this.renderEnable?yl():""}},{key:"renderDebug",value:function(r){this.renderEnable=r}},{key:"renderStart",value:function(r){if(!(!this.renderEnable||!this.enable)){var a=this.renderMap.get(r)||{};this.renderMap.set(r,(0,X.Z)((0,X.Z)({},a),{},{renderUid:r,renderStart:Date.now()}))}}},{key:"renderEnd",value:function(r){if(!(!this.renderEnable||!this.enable)){var a=this.renderMap.get(r);if(a){var u=a.renderStart,c=Date.now();this.emit("renderEnd",(0,X.Z)((0,X.Z)({},a),{},{renderEnd:c,renderDuration:c-u})),this.renderMap.delete(r)}}}},{key:"destroy",value:function(){this.cacheLogs=null,this.renderMap.clear()}}]),t}(ha.EventEmitter))||VA),Kf=C(50840),T0=C.n(Kf),$u=function(e){return e.Hover="hover",e.Click="click",e.Select="select",e.Active="active",e.Drag="drag",e}({}),Qp,HA,qp,$A,Kp;function Jp(e){var i=fm();return function(){var n=(0,ue.Z)(e),r;if(i){var a=(0,ue.Z)(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return(0,ze.Z)(this,r)}}function fm(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var Rv={panstart:"dragstart",panmove:"dragging",panend:"dragend",pancancel:"dragcancel"},YA=(Qp=(0,vr.b2)(),HA=(0,vr.f3)(Xt.IMapService),Qp(qp=($A=function(e){(0,Ne.Z)(t,e);var i=Jp(t);function t(){var n;(0,se.Z)(this,t);for(var r=arguments.length,a=new Array(r),u=0;u<r;u++)a[u]=arguments[u];return n=i.call.apply(i,[this].concat(a)),(0,Me.Z)((0,xt.Z)(n),"indragging",!1),Ki((0,xt.Z)(n),"mapService",Kp,(0,xt.Z)(n)),(0,Me.Z)((0,xt.Z)(n),"hammertime",void 0),(0,Me.Z)((0,xt.Z)(n),"lastClickTime",0),(0,Me.Z)((0,xt.Z)(n),"lastClickXY",[-1,-1]),(0,Me.Z)((0,xt.Z)(n),"clickTimer",void 0),(0,Me.Z)((0,xt.Z)(n),"$containter",void 0),(0,Me.Z)((0,xt.Z)(n),"onDrag",function(c){var g=n.interactionEvent(c);g.type=Rv[g.type],g.type==="dragging"?n.indragging=!0:n.indragging=!1,n.emit($u.Drag,g)}),(0,Me.Z)((0,xt.Z)(n),"onHammer",function(c){c.srcEvent.stopPropagation();var g=n.interactionEvent(c);n.emit($u.Hover,g)}),(0,Me.Z)((0,xt.Z)(n),"onTouch",function(c){var g=c.touches[0];n.onHover({x:g.pageX,y:g.pageY,type:"touch"})}),(0,Me.Z)((0,xt.Z)(n),"onHover",function(c){var g=c.clientX,x=c.clientY,M=g,O=x,B=c.type,W=n.mapService.getMapContainer();if(W){var ce=W.getBoundingClientRect(),oe=ce.top,Te=ce.left;M=M-Te-W.clientLeft,O=O-oe-W.clientTop}var Ze=n.mapService.containerToLngLat([M,O]);if(B==="click"){n.isDoubleTap(M,O,Ze);return}if(B==="touch"){n.isDoubleTap(M,O,Ze);return}B!=="click"&&B!=="dblclick"&&n.emit($u.Hover,{x:M,y:O,lngLat:Ze,type:B,target:c})}),n}return(0,be.Z)(t,[{key:"init",value:function(){this.addEventListenerOnMap(),this.$containter=this.mapService.getMapContainer()}},{key:"destroy",value:function(){this.hammertime&&this.hammertime.destroy(),this.removeEventListenerOnMap(),this.off($u.Hover)}},{key:"triggerHover",value:function(r){var a=r.x,u=r.y;this.emit($u.Hover,{x:a,y:u})}},{key:"triggerSelect",value:function(r){this.emit($u.Select,{featureId:r})}},{key:"triggerActive",value:function(r){this.emit($u.Active,{featureId:r})}},{key:"handleMiniEvent",value:function(r){this.onHover({clientX:r.touches[0].pageX,clientY:r.touches[0].pageY,type:"touch"})}},{key:"addEventListenerOnMap",value:function(){var r=this.mapService.getMapContainer();if(r){var a=new(T0()).Manager(r);a.add(new(T0()).Tap({event:"dblclick",taps:2})),a.add(new(T0()).Tap({event:"click"})),a.add(new(T0()).Pan({threshold:0,pointers:0})),a.add(new(T0()).Press({})),a.on("dblclick click",this.onHammer),a.on("panstart panmove panend pancancel",this.onDrag),r.addEventListener("mousemove",this.onHover),r.addEventListener("mousedown",this.onHover,!0),r.addEventListener("mouseup",this.onHover),r.addEventListener("contextmenu",this.onHover),this.hammertime=a}}},{key:"removeEventListenerOnMap",value:function(){var r=this.mapService.getMapContainer();r&&(r.removeEventListener("mousemove",this.onHover),this.hammertime.off("dblclick click",this.onHammer),this.hammertime.off("panstart panmove panend pancancel",this.onDrag),r.removeEventListener("mousedown",this.onHover),r.removeEventListener("mouseup",this.onHover),r.removeEventListener("contextmenu",this.onHover))}},{key:"interactionEvent",value:function(r){var a=r.type,u=r.pointerType,c,g;u==="touch"?(g=Math.floor(r.pointers[0].clientY),c=Math.floor(r.pointers[0].clientX)):(g=Math.floor(r.srcEvent.y),c=Math.floor(r.srcEvent.x));var x=this.mapService.getMapContainer();if(x){var M=x.getBoundingClientRect(),O=M.top,B=M.left;c-=B,g-=O}var W=this.mapService.containerToLngLat([c,g]);return{x:c,y:g,lngLat:W,type:a,target:r.srcEvent}}},{key:"isDoubleTap",value:function(r,a,u){var c=this,g=new Date().getTime(),x="click";g-this.lastClickTime<400&&Math.abs(this.lastClickXY[0]-r)<10&&Math.abs(this.lastClickXY[1]-a)<10?(this.lastClickTime=0,this.lastClickXY=[-1,-1],this.clickTimer&&clearTimeout(this.clickTimer),x="dblclick",this.emit($u.Hover,{x:r,y:a,lngLat:u,type:x})):(this.lastClickTime=g,this.lastClickXY=[r,a],this.clickTimer=setTimeout(function(){x="click",c.emit($u.Hover,{x:r,y:a,lngLat:u,type:x})},400))}}]),t}(Ys()),Kp=Hi($A.prototype,"mapService",[HA],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),$A))||qp),WA=0;function ed(e){var i=e;if(typeof e=="string"&&(i=document.getElementById(e)),i){var t=document.createElement("div");return t.style.cssText+=`
      position: absolute;
      z-index:2;
      height: 100%;
      width: 100%;
      pointer-events: none;
    `,t.id="l7-scene-".concat(WA++),t.classList.add("l7-scene"),i.appendChild(t),t}return null}function td(e){var i,t=!0;if((e==null||(i=e.target)===null||i===void 0?void 0:i.target)instanceof HTMLElement)for(var n,r=e==null||(n=e.target)===null||n===void 0?void 0:n.target;r;){var a,u=Array.from(r.classList);if(u.includes("l7-marker")||u.includes("l7-popup")){t=!1;break}r=(a=r)===null||a===void 0?void 0:a.parentElement}return t}var je=function(e){return e[e.DEPTH_BUFFER_BIT=256]="DEPTH_BUFFER_BIT",e[e.STENCIL_BUFFER_BIT=1024]="STENCIL_BUFFER_BIT",e[e.COLOR_BUFFER_BIT=16384]="COLOR_BUFFER_BIT",e[e.POINTS=0]="POINTS",e[e.LINES=1]="LINES",e[e.LINE_LOOP=2]="LINE_LOOP",e[e.LINE_STRIP=3]="LINE_STRIP",e[e.TRIANGLES=4]="TRIANGLES",e[e.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",e[e.TRIANGLE_FAN=6]="TRIANGLE_FAN",e[e.ZERO=0]="ZERO",e[e.ONE=1]="ONE",e[e.SRC_COLOR=768]="SRC_COLOR",e[e.ONE_MINUS_SRC_COLOR=769]="ONE_MINUS_SRC_COLOR",e[e.SRC_ALPHA=770]="SRC_ALPHA",e[e.ONE_MINUS_SRC_ALPHA=771]="ONE_MINUS_SRC_ALPHA",e[e.DST_ALPHA=772]="DST_ALPHA",e[e.ONE_MINUS_DST_ALPHA=773]="ONE_MINUS_DST_ALPHA",e[e.DST_COLOR=774]="DST_COLOR",e[e.ONE_MINUS_DST_COLOR=775]="ONE_MINUS_DST_COLOR",e[e.SRC_ALPHA_SATURATE=776]="SRC_ALPHA_SATURATE",e[e.FUNC_ADD=32774]="FUNC_ADD",e[e.BLEND_EQUATION=32777]="BLEND_EQUATION",e[e.BLEND_EQUATION_RGB=32777]="BLEND_EQUATION_RGB",e[e.BLEND_EQUATION_ALPHA=34877]="BLEND_EQUATION_ALPHA",e[e.FUNC_SUBTRACT=32778]="FUNC_SUBTRACT",e[e.FUNC_REVERSE_SUBTRACT=32779]="FUNC_REVERSE_SUBTRACT",e[e.MAX_EXT=32776]="MAX_EXT",e[e.MIN_EXT=32775]="MIN_EXT",e[e.BLEND_DST_RGB=32968]="BLEND_DST_RGB",e[e.BLEND_SRC_RGB=32969]="BLEND_SRC_RGB",e[e.BLEND_DST_ALPHA=32970]="BLEND_DST_ALPHA",e[e.BLEND_SRC_ALPHA=32971]="BLEND_SRC_ALPHA",e[e.CONSTANT_COLOR=32769]="CONSTANT_COLOR",e[e.ONE_MINUS_CONSTANT_COLOR=32770]="ONE_MINUS_CONSTANT_COLOR",e[e.CONSTANT_ALPHA=32771]="CONSTANT_ALPHA",e[e.ONE_MINUS_CONSTANT_ALPHA=32772]="ONE_MINUS_CONSTANT_ALPHA",e[e.BLEND_COLOR=32773]="BLEND_COLOR",e[e.ARRAY_BUFFER=34962]="ARRAY_BUFFER",e[e.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",e[e.ARRAY_BUFFER_BINDING=34964]="ARRAY_BUFFER_BINDING",e[e.ELEMENT_ARRAY_BUFFER_BINDING=34965]="ELEMENT_ARRAY_BUFFER_BINDING",e[e.STREAM_DRAW=35040]="STREAM_DRAW",e[e.STATIC_DRAW=35044]="STATIC_DRAW",e[e.DYNAMIC_DRAW=35048]="DYNAMIC_DRAW",e[e.BUFFER_SIZE=34660]="BUFFER_SIZE",e[e.BUFFER_USAGE=34661]="BUFFER_USAGE",e[e.CURRENT_VERTEX_ATTRIB=34342]="CURRENT_VERTEX_ATTRIB",e[e.FRONT=1028]="FRONT",e[e.BACK=1029]="BACK",e[e.FRONT_AND_BACK=1032]="FRONT_AND_BACK",e[e.CULL_FACE=2884]="CULL_FACE",e[e.BLEND=3042]="BLEND",e[e.DITHER=3024]="DITHER",e[e.STENCIL_TEST=2960]="STENCIL_TEST",e[e.DEPTH_TEST=2929]="DEPTH_TEST",e[e.SCISSOR_TEST=3089]="SCISSOR_TEST",e[e.POLYGON_OFFSET_FILL=32823]="POLYGON_OFFSET_FILL",e[e.SAMPLE_ALPHA_TO_COVERAGE=32926]="SAMPLE_ALPHA_TO_COVERAGE",e[e.SAMPLE_COVERAGE=32928]="SAMPLE_COVERAGE",e[e.NO_ERROR=0]="NO_ERROR",e[e.INVALID_ENUM=1280]="INVALID_ENUM",e[e.INVALID_VALUE=1281]="INVALID_VALUE",e[e.INVALID_OPERATION=1282]="INVALID_OPERATION",e[e.OUT_OF_MEMORY=1285]="OUT_OF_MEMORY",e[e.CW=2304]="CW",e[e.CCW=2305]="CCW",e[e.LINE_WIDTH=2849]="LINE_WIDTH",e[e.ALIASED_POINT_SIZE_RANGE=33901]="ALIASED_POINT_SIZE_RANGE",e[e.ALIASED_LINE_WIDTH_RANGE=33902]="ALIASED_LINE_WIDTH_RANGE",e[e.CULL_FACE_MODE=2885]="CULL_FACE_MODE",e[e.FRONT_FACE=2886]="FRONT_FACE",e[e.DEPTH_RANGE=2928]="DEPTH_RANGE",e[e.DEPTH_WRITEMASK=2930]="DEPTH_WRITEMASK",e[e.DEPTH_CLEAR_VALUE=2931]="DEPTH_CLEAR_VALUE",e[e.DEPTH_FUNC=2932]="DEPTH_FUNC",e[e.STENCIL_CLEAR_VALUE=2961]="STENCIL_CLEAR_VALUE",e[e.STENCIL_FUNC=2962]="STENCIL_FUNC",e[e.STENCIL_FAIL=2964]="STENCIL_FAIL",e[e.STENCIL_PASS_DEPTH_FAIL=2965]="STENCIL_PASS_DEPTH_FAIL",e[e.STENCIL_PASS_DEPTH_PASS=2966]="STENCIL_PASS_DEPTH_PASS",e[e.STENCIL_REF=2967]="STENCIL_REF",e[e.STENCIL_VALUE_MASK=2963]="STENCIL_VALUE_MASK",e[e.STENCIL_WRITEMASK=2968]="STENCIL_WRITEMASK",e[e.STENCIL_BACK_FUNC=34816]="STENCIL_BACK_FUNC",e[e.STENCIL_BACK_FAIL=34817]="STENCIL_BACK_FAIL",e[e.STENCIL_BACK_PASS_DEPTH_FAIL=34818]="STENCIL_BACK_PASS_DEPTH_FAIL",e[e.STENCIL_BACK_PASS_DEPTH_PASS=34819]="STENCIL_BACK_PASS_DEPTH_PASS",e[e.STENCIL_BACK_REF=36003]="STENCIL_BACK_REF",e[e.STENCIL_BACK_VALUE_MASK=36004]="STENCIL_BACK_VALUE_MASK",e[e.STENCIL_BACK_WRITEMASK=36005]="STENCIL_BACK_WRITEMASK",e[e.VIEWPORT=2978]="VIEWPORT",e[e.SCISSOR_BOX=3088]="SCISSOR_BOX",e[e.COLOR_CLEAR_VALUE=3106]="COLOR_CLEAR_VALUE",e[e.COLOR_WRITEMASK=3107]="COLOR_WRITEMASK",e[e.UNPACK_ALIGNMENT=3317]="UNPACK_ALIGNMENT",e[e.PACK_ALIGNMENT=3333]="PACK_ALIGNMENT",e[e.MAX_TEXTURE_SIZE=3379]="MAX_TEXTURE_SIZE",e[e.MAX_VIEWPORT_DIMS=3386]="MAX_VIEWPORT_DIMS",e[e.SUBPIXEL_BITS=3408]="SUBPIXEL_BITS",e[e.RED_BITS=3410]="RED_BITS",e[e.GREEN_BITS=3411]="GREEN_BITS",e[e.BLUE_BITS=3412]="BLUE_BITS",e[e.ALPHA_BITS=3413]="ALPHA_BITS",e[e.DEPTH_BITS=3414]="DEPTH_BITS",e[e.STENCIL_BITS=3415]="STENCIL_BITS",e[e.POLYGON_OFFSET_UNITS=10752]="POLYGON_OFFSET_UNITS",e[e.POLYGON_OFFSET_FACTOR=32824]="POLYGON_OFFSET_FACTOR",e[e.TEXTURE_BINDING_2D=32873]="TEXTURE_BINDING_2D",e[e.SAMPLE_BUFFERS=32936]="SAMPLE_BUFFERS",e[e.SAMPLES=32937]="SAMPLES",e[e.SAMPLE_COVERAGE_VALUE=32938]="SAMPLE_COVERAGE_VALUE",e[e.SAMPLE_COVERAGE_INVERT=32939]="SAMPLE_COVERAGE_INVERT",e[e.COMPRESSED_TEXTURE_FORMATS=34467]="COMPRESSED_TEXTURE_FORMATS",e[e.DONT_CARE=4352]="DONT_CARE",e[e.FASTEST=4353]="FASTEST",e[e.NICEST=4354]="NICEST",e[e.GENERATE_MIPMAP_HINT=33170]="GENERATE_MIPMAP_HINT",e[e.BYTE=5120]="BYTE",e[e.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",e[e.SHORT=5122]="SHORT",e[e.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",e[e.INT=5124]="INT",e[e.UNSIGNED_INT=5125]="UNSIGNED_INT",e[e.FLOAT=5126]="FLOAT",e[e.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",e[e.ALPHA=6406]="ALPHA",e[e.RGB=6407]="RGB",e[e.RGBA=6408]="RGBA",e[e.LUMINANCE=6409]="LUMINANCE",e[e.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",e[e.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",e[e.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",e[e.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",e[e.FRAGMENT_SHADER=35632]="FRAGMENT_SHADER",e[e.VERTEX_SHADER=35633]="VERTEX_SHADER",e[e.MAX_VERTEX_ATTRIBS=34921]="MAX_VERTEX_ATTRIBS",e[e.MAX_VERTEX_UNIFORM_VECTORS=36347]="MAX_VERTEX_UNIFORM_VECTORS",e[e.MAX_VARYING_VECTORS=36348]="MAX_VARYING_VECTORS",e[e.MAX_COMBINED_TEXTURE_IMAGE_UNITS=35661]="MAX_COMBINED_TEXTURE_IMAGE_UNITS",e[e.MAX_VERTEX_TEXTURE_IMAGE_UNITS=35660]="MAX_VERTEX_TEXTURE_IMAGE_UNITS",e[e.MAX_TEXTURE_IMAGE_UNITS=34930]="MAX_TEXTURE_IMAGE_UNITS",e[e.MAX_FRAGMENT_UNIFORM_VECTORS=36349]="MAX_FRAGMENT_UNIFORM_VECTORS",e[e.SHADER_TYPE=35663]="SHADER_TYPE",e[e.DELETE_STATUS=35712]="DELETE_STATUS",e[e.LINK_STATUS=35714]="LINK_STATUS",e[e.VALIDATE_STATUS=35715]="VALIDATE_STATUS",e[e.ATTACHED_SHADERS=35717]="ATTACHED_SHADERS",e[e.ACTIVE_UNIFORMS=35718]="ACTIVE_UNIFORMS",e[e.ACTIVE_ATTRIBUTES=35721]="ACTIVE_ATTRIBUTES",e[e.SHADING_LANGUAGE_VERSION=35724]="SHADING_LANGUAGE_VERSION",e[e.CURRENT_PROGRAM=35725]="CURRENT_PROGRAM",e[e.NEVER=512]="NEVER",e[e.LESS=513]="LESS",e[e.EQUAL=514]="EQUAL",e[e.LEQUAL=515]="LEQUAL",e[e.GREATER=516]="GREATER",e[e.NOTEQUAL=517]="NOTEQUAL",e[e.GEQUAL=518]="GEQUAL",e[e.ALWAYS=519]="ALWAYS",e[e.KEEP=7680]="KEEP",e[e.REPLACE=7681]="REPLACE",e[e.INCR=7682]="INCR",e[e.DECR=7683]="DECR",e[e.INVERT=5386]="INVERT",e[e.INCR_WRAP=34055]="INCR_WRAP",e[e.DECR_WRAP=34056]="DECR_WRAP",e[e.VENDOR=7936]="VENDOR",e[e.RENDERER=7937]="RENDERER",e[e.VERSION=7938]="VERSION",e[e.NEAREST=9728]="NEAREST",e[e.LINEAR=9729]="LINEAR",e[e.NEAREST_MIPMAP_NEAREST=9984]="NEAREST_MIPMAP_NEAREST",e[e.LINEAR_MIPMAP_NEAREST=9985]="LINEAR_MIPMAP_NEAREST",e[e.NEAREST_MIPMAP_LINEAR=9986]="NEAREST_MIPMAP_LINEAR",e[e.LINEAR_MIPMAP_LINEAR=9987]="LINEAR_MIPMAP_LINEAR",e[e.TEXTURE_MAG_FILTER=10240]="TEXTURE_MAG_FILTER",e[e.TEXTURE_MIN_FILTER=10241]="TEXTURE_MIN_FILTER",e[e.TEXTURE_WRAP_S=10242]="TEXTURE_WRAP_S",e[e.TEXTURE_WRAP_T=10243]="TEXTURE_WRAP_T",e[e.TEXTURE_2D=3553]="TEXTURE_2D",e[e.TEXTURE=5890]="TEXTURE",e[e.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",e[e.TEXTURE_BINDING_CUBE_MAP=34068]="TEXTURE_BINDING_CUBE_MAP",e[e.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",e[e.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",e[e.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",e[e.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",e[e.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",e[e.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z",e[e.MAX_CUBE_MAP_TEXTURE_SIZE=34076]="MAX_CUBE_MAP_TEXTURE_SIZE",e[e.TEXTURE0=33984]="TEXTURE0",e[e.TEXTURE1=33985]="TEXTURE1",e[e.TEXTURE2=33986]="TEXTURE2",e[e.TEXTURE3=33987]="TEXTURE3",e[e.TEXTURE4=33988]="TEXTURE4",e[e.TEXTURE5=33989]="TEXTURE5",e[e.TEXTURE6=33990]="TEXTURE6",e[e.TEXTURE7=33991]="TEXTURE7",e[e.TEXTURE8=33992]="TEXTURE8",e[e.TEXTURE9=33993]="TEXTURE9",e[e.TEXTURE10=33994]="TEXTURE10",e[e.TEXTURE11=33995]="TEXTURE11",e[e.TEXTURE12=33996]="TEXTURE12",e[e.TEXTURE13=33997]="TEXTURE13",e[e.TEXTURE14=33998]="TEXTURE14",e[e.TEXTURE15=33999]="TEXTURE15",e[e.TEXTURE16=34e3]="TEXTURE16",e[e.TEXTURE17=34001]="TEXTURE17",e[e.TEXTURE18=34002]="TEXTURE18",e[e.TEXTURE19=34003]="TEXTURE19",e[e.TEXTURE20=34004]="TEXTURE20",e[e.TEXTURE21=34005]="TEXTURE21",e[e.TEXTURE22=34006]="TEXTURE22",e[e.TEXTURE23=34007]="TEXTURE23",e[e.TEXTURE24=34008]="TEXTURE24",e[e.TEXTURE25=34009]="TEXTURE25",e[e.TEXTURE26=34010]="TEXTURE26",e[e.TEXTURE27=34011]="TEXTURE27",e[e.TEXTURE28=34012]="TEXTURE28",e[e.TEXTURE29=34013]="TEXTURE29",e[e.TEXTURE30=34014]="TEXTURE30",e[e.TEXTURE31=34015]="TEXTURE31",e[e.ACTIVE_TEXTURE=34016]="ACTIVE_TEXTURE",e[e.REPEAT=10497]="REPEAT",e[e.CLAMP_TO_EDGE=33071]="CLAMP_TO_EDGE",e[e.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT",e[e.FLOAT_VEC2=35664]="FLOAT_VEC2",e[e.FLOAT_VEC3=35665]="FLOAT_VEC3",e[e.FLOAT_VEC4=35666]="FLOAT_VEC4",e[e.INT_VEC2=35667]="INT_VEC2",e[e.INT_VEC3=35668]="INT_VEC3",e[e.INT_VEC4=35669]="INT_VEC4",e[e.BOOL=35670]="BOOL",e[e.BOOL_VEC2=35671]="BOOL_VEC2",e[e.BOOL_VEC3=35672]="BOOL_VEC3",e[e.BOOL_VEC4=35673]="BOOL_VEC4",e[e.FLOAT_MAT2=35674]="FLOAT_MAT2",e[e.FLOAT_MAT3=35675]="FLOAT_MAT3",e[e.FLOAT_MAT4=35676]="FLOAT_MAT4",e[e.SAMPLER_2D=35678]="SAMPLER_2D",e[e.SAMPLER_CUBE=35680]="SAMPLER_CUBE",e[e.VERTEX_ATTRIB_ARRAY_ENABLED=34338]="VERTEX_ATTRIB_ARRAY_ENABLED",e[e.VERTEX_ATTRIB_ARRAY_SIZE=34339]="VERTEX_ATTRIB_ARRAY_SIZE",e[e.VERTEX_ATTRIB_ARRAY_STRIDE=34340]="VERTEX_ATTRIB_ARRAY_STRIDE",e[e.VERTEX_ATTRIB_ARRAY_TYPE=34341]="VERTEX_ATTRIB_ARRAY_TYPE",e[e.VERTEX_ATTRIB_ARRAY_NORMALIZED=34922]="VERTEX_ATTRIB_ARRAY_NORMALIZED",e[e.VERTEX_ATTRIB_ARRAY_POINTER=34373]="VERTEX_ATTRIB_ARRAY_POINTER",e[e.VERTEX_ATTRIB_ARRAY_BUFFER_BINDING=34975]="VERTEX_ATTRIB_ARRAY_BUFFER_BINDING",e[e.COMPILE_STATUS=35713]="COMPILE_STATUS",e[e.LOW_FLOAT=36336]="LOW_FLOAT",e[e.MEDIUM_FLOAT=36337]="MEDIUM_FLOAT",e[e.HIGH_FLOAT=36338]="HIGH_FLOAT",e[e.LOW_INT=36339]="LOW_INT",e[e.MEDIUM_INT=36340]="MEDIUM_INT",e[e.HIGH_INT=36341]="HIGH_INT",e[e.FRAMEBUFFER=36160]="FRAMEBUFFER",e[e.RENDERBUFFER=36161]="RENDERBUFFER",e[e.RGBA4=32854]="RGBA4",e[e.RGB5_A1=32855]="RGB5_A1",e[e.RGB565=36194]="RGB565",e[e.DEPTH_COMPONENT16=33189]="DEPTH_COMPONENT16",e[e.STENCIL_INDEX=6401]="STENCIL_INDEX",e[e.STENCIL_INDEX8=36168]="STENCIL_INDEX8",e[e.DEPTH_STENCIL=34041]="DEPTH_STENCIL",e[e.RENDERBUFFER_WIDTH=36162]="RENDERBUFFER_WIDTH",e[e.RENDERBUFFER_HEIGHT=36163]="RENDERBUFFER_HEIGHT",e[e.RENDERBUFFER_INTERNAL_FORMAT=36164]="RENDERBUFFER_INTERNAL_FORMAT",e[e.RENDERBUFFER_RED_SIZE=36176]="RENDERBUFFER_RED_SIZE",e[e.RENDERBUFFER_GREEN_SIZE=36177]="RENDERBUFFER_GREEN_SIZE",e[e.RENDERBUFFER_BLUE_SIZE=36178]="RENDERBUFFER_BLUE_SIZE",e[e.RENDERBUFFER_ALPHA_SIZE=36179]="RENDERBUFFER_ALPHA_SIZE",e[e.RENDERBUFFER_DEPTH_SIZE=36180]="RENDERBUFFER_DEPTH_SIZE",e[e.RENDERBUFFER_STENCIL_SIZE=36181]="RENDERBUFFER_STENCIL_SIZE",e[e.FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE=36048]="FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE",e[e.FRAMEBUFFER_ATTACHMENT_OBJECT_NAME=36049]="FRAMEBUFFER_ATTACHMENT_OBJECT_NAME",e[e.FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL=36050]="FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL",e[e.FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE=36051]="FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE",e[e.COLOR_ATTACHMENT0=36064]="COLOR_ATTACHMENT0",e[e.DEPTH_ATTACHMENT=36096]="DEPTH_ATTACHMENT",e[e.STENCIL_ATTACHMENT=36128]="STENCIL_ATTACHMENT",e[e.DEPTH_STENCIL_ATTACHMENT=33306]="DEPTH_STENCIL_ATTACHMENT",e[e.NONE=0]="NONE",e[e.FRAMEBUFFER_COMPLETE=36053]="FRAMEBUFFER_COMPLETE",e[e.FRAMEBUFFER_INCOMPLETE_ATTACHMENT=36054]="FRAMEBUFFER_INCOMPLETE_ATTACHMENT",e[e.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT=36055]="FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT",e[e.FRAMEBUFFER_INCOMPLETE_DIMENSIONS=36057]="FRAMEBUFFER_INCOMPLETE_DIMENSIONS",e[e.FRAMEBUFFER_UNSUPPORTED=36061]="FRAMEBUFFER_UNSUPPORTED",e[e.FRAMEBUFFER_BINDING=36006]="FRAMEBUFFER_BINDING",e[e.RENDERBUFFER_BINDING=36007]="RENDERBUFFER_BINDING",e[e.MAX_RENDERBUFFER_SIZE=34024]="MAX_RENDERBUFFER_SIZE",e[e.INVALID_FRAMEBUFFER_OPERATION=1286]="INVALID_FRAMEBUFFER_OPERATION",e[e.UNPACK_FLIP_Y_WEBGL=37440]="UNPACK_FLIP_Y_WEBGL",e[e.UNPACK_PREMULTIPLY_ALPHA_WEBGL=37441]="UNPACK_PREMULTIPLY_ALPHA_WEBGL",e[e.CONTEXT_LOST_WEBGL=37442]="CONTEXT_LOST_WEBGL",e[e.UNPACK_COLORSPACE_CONVERSION_WEBGL=37443]="UNPACK_COLORSPACE_CONVERSION_WEBGL",e[e.BROWSER_DEFAULT_WEBGL=37444]="BROWSER_DEFAULT_WEBGL",e}({}),M0,Gh,rd,XA,Dv,nd,QA,I0,id,ad,od,sd,kv,Nv=(M0=(0,vr.b2)(),Gh=(0,vr.f3)(Xt.IMapService),rd=(0,vr.f3)(Xt.IRendererService),XA=(0,vr.f3)(Xt.IGlobalConfigService),Dv=(0,vr.f3)(Xt.IInteractionService),nd=(0,vr.f3)(Xt.ILayerService),M0(QA=(I0=function(){function e(){var i=this;(0,se.Z)(this,e),(0,Me.Z)(this,"pickedColors",void 0),(0,Me.Z)(this,"pickedTileLayers",[]),Ki(this,"mapService",id,this),Ki(this,"rendererService",ad,this),Ki(this,"configService",od,this),Ki(this,"interactionService",sd,this),Ki(this,"layerService",kv,this),(0,Me.Z)(this,"pickingFBO",void 0),(0,Me.Z)(this,"width",0),(0,Me.Z)(this,"height",0),(0,Me.Z)(this,"alreadyInPicking",!1),(0,Me.Z)(this,"pickBufferScale",1),(0,Me.Z)(this,"pickFromPickingFBO",function(t,n){var r=n.x,a=n.y,u=n.lngLat,c=n.type,g=n.target,x=!1,M=i.rendererService,O=M.readPixels,B=M.getContainer,W=i.getContainerSize(B()),ce=W.width,oe=W.height;ce*=fa,oe*=fa;var Te=t.getLayerConfig(),Ze=Te.enableHighlight,qe=Te.enableSelect,et=r*fa,yt=a*fa;if(et>ce-1*fa||et<0||yt>oe-1*fa||yt<0)return!1;var bt=O({x:Math.floor(et/i.pickBufferScale),y:Math.floor((oe-(a+1)*fa)/i.pickBufferScale),width:1,height:1,data:new Uint8Array(1*1*4),framebuffer:i.pickingFBO});if(i.pickedColors=bt,bt[0]!==0||bt[1]!==0||bt[2]!==0){var Ot=io(bt),jt=t.layerPickService.getFeatureById(Ot);Ot!==t.getCurrentPickId()&&c==="mousemove"&&(c="mouseenter");var or={x:r,y:a,type:c,lngLat:u,featureId:Ot,feature:jt,target:g};jt&&(x=!0,t.setCurrentPickId(Ot),i.triggerHoverOnLayer(t,or))}else{var ar={x:r,y:a,lngLat:u,type:t.getCurrentPickId()!==null&&c==="mousemove"?"mouseout":"un"+c,featureId:null,target:g,feature:null};i.triggerHoverOnLayer(t,(0,X.Z)((0,X.Z)({},ar),{},{type:"unpick"})),i.triggerHoverOnLayer(t,ar),t.setCurrentPickId(null)}if(Ze&&t.layerPickService.highlightPickedFeature(bt),qe&&c==="click"&&(bt==null?void 0:bt.toString())!==[0,0,0,0].toString()){var Sr=io(bt);t.getCurrentSelectedId()===null||Sr!==t.getCurrentSelectedId()?(t.layerPickService.selectFeature(bt),t.setCurrentSelectedId(Sr)):(t.layerPickService.selectFeature(new Uint8Array([0,0,0,0])),t.setCurrentSelectedId(null))}return x})}return(0,be.Z)(e,[{key:"init",value:function(t){var n=this.rendererService,r=n.createTexture2D,a=n.createFramebuffer,u=n.getContainer,c=this.getContainerSize(u()),g=c.width,x=c.height;g*=fa,x*=fa,this.pickBufferScale=this.configService.getSceneConfig(t).pickBufferScale||1,this.pickingFBO=a({color:r({width:Math.round(g/this.pickBufferScale),height:Math.round(x/this.pickBufferScale),wrapS:je.CLAMP_TO_EDGE,wrapT:je.CLAMP_TO_EDGE})}),this.interactionService.on($u.Hover,this.pickingAllLayer.bind(this))}},{key:"boxPickLayer",value:function(){var i=(0,ur.Z)(it().mark(function n(r,a,u){var c=this,g,x,M;return it().wrap(function(B){for(;;)switch(B.prev=B.next){case 0:g=this.rendererService,x=g.useFramebuffer,M=g.clear,this.resizePickingFBO(),x(this.pickingFBO,function(){M({framebuffer:c.pickingFBO,color:[0,0,0,0],stencil:0,depth:1}),r.hooks.beforePickingEncode.call(),r.renderModels({ispick:!0}),r.hooks.afterPickingEncode.call();var W=c.pickBox(r,a);u(W)});case 3:case"end":return B.stop()}},n,this)}));function t(n,r,a){return i.apply(this,arguments)}return t}()},{key:"pickBox",value:function(t,n){var r=this,a=n.map(function(Sr){var dr=Sr<0?0:Sr;return Math.floor(dr*fa/r.pickBufferScale)}),u=(0,vn.Z)(a,4),c=u[0],g=u[1],x=u[2],M=u[3],O=this.rendererService,B=O.readPixels,W=O.getContainer,ce=this.getContainerSize(W()),oe=ce.width,Te=ce.height;if(oe*=fa,Te*=fa,c>(oe-1)*fa/this.pickBufferScale||x<0||g>(Te-1)*fa/this.pickBufferScale||M<0)return[];for(var Ze=Math.min(oe/this.pickBufferScale,x)-c,qe=Math.min(Te/this.pickBufferScale,M)-g,et=B({x:c,y:Math.floor(Te/this.pickBufferScale-(M+1)),width:Ze,height:qe,data:new Uint8Array(Ze*qe*4),framebuffer:this.pickingFBO}),yt=[],bt={},Ot=0;Ot<et.length/4;Ot=Ot+1){var jt=et.slice(Ot*4,Ot*4+4),or=io(jt);if(or!==-1&&!bt[or]){var ar=t.layerPickService.getFeatureById(or);yt.push((0,X.Z)((0,X.Z)({},ar),{},{pickedFeatureIdx:or})),bt[or]=!0}}return yt}},{key:"handleCursor",value:function(t,n){var r=t.getLayerConfig(),a=r.cursor,u=a===void 0?"":a,c=r.cursorEnabled;if(c){var g=this.mapService.version,x=g==="GAODE2.x"?this.mapService.getMapContainer():this.mapService.getMarkerContainer(),M=x==null?void 0:x.style.getPropertyValue("cursor");n==="unmousemove"&&M!==""?x==null||x.style.setProperty("cursor",""):n==="mousemove"&&(x==null||x.style.setProperty("cursor",u))}}},{key:"destroy",value:function(){this.pickingFBO.destroy(),this.pickingFBO=null}},{key:"getContainerSize",value:function(t){return t.getContext?{width:t.width/fa,height:t.height/fa}:t.getBoundingClientRect()}},{key:"pickingAllLayer",value:function(){var i=(0,ur.Z)(it().mark(function n(r){return it().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:if(!(!this.layerService.needPick(r.type)||!this.isPickingAllLayer())){u.next=2;break}return u.abrupt("return");case 2:return this.alreadyInPicking=!0,u.next=5,this.pickingLayers(r);case 5:this.layerService.renderLayers(),this.alreadyInPicking=!1;case 7:case"end":return u.stop()}},n,this)}));function t(n){return i.apply(this,arguments)}return t}()},{key:"isPickingAllLayer",value:function(){return!(this.alreadyInPicking||this.layerService.alreadyInRendering||this.interactionService.indragging||!this.layerService.getShaderPickStat())}},{key:"resizePickingFBO",value:function(){var t=this.rendererService.getContainer,n=this.getContainerSize(t()),r=n.width,a=n.height;r*=fa,a*=fa,(this.width!==r||this.height!==a)&&(this.pickingFBO.resize({width:Math.round(r/this.pickBufferScale),height:Math.round(a/this.pickBufferScale)}),this.width=r,this.height=a)}},{key:"pickingLayers",value:function(){var i=(0,ur.Z)(it().mark(function n(r){var a=this,u,c,g;return it().wrap(function(M){for(;;)switch(M.prev=M.next){case 0:u=this.rendererService,c=u.useFramebuffer,g=u.clear,this.resizePickingFBO(),c(this.pickingFBO,function(){var O=a.layerService.getRenderList();O.filter(function(B){return B.needPick(r.type)}).reverse().some(function(B){g({framebuffer:a.pickingFBO,color:[0,0,0,0],stencil:0,depth:1}),B.layerPickService.pickRender(r);var W=a.pickFromPickingFBO(B,r);return a.layerService.pickedLayerId=W?+B.id:-1,W&&!B.getLayerConfig().enablePropagation})});case 3:case"end":return M.stop()}},n,this)}));function t(n){return i.apply(this,arguments)}return t}()},{key:"triggerHoverOnLayer",value:function(t,n){td(n)&&(this.handleCursor(t,n.type),t.emit(n.type,n))}}]),e}(),id=Hi(I0.prototype,"mapService",[Gh],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ad=Hi(I0.prototype,"rendererService",[rd],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),od=Hi(I0.prototype,"configService",[XA],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),sd=Hi(I0.prototype,"interactionService",[Dv],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),kv=Hi(I0.prototype,"layerService",[nd],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),I0))||QA),Fv=function(){function e(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;(0,se.Z)(this,e),(0,Me.Z)(this,"autoStart",void 0),(0,Me.Z)(this,"startTime",0),(0,Me.Z)(this,"oldTime",0),(0,Me.Z)(this,"running",!1),(0,Me.Z)(this,"elapsedTime",0),this.autoStart=i}return(0,be.Z)(e,[{key:"start",value:function(){this.startTime=(typeof performance=="undefined"?Date:performance).now(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}},{key:"stop",value:function(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}},{key:"getElapsedTime",value:function(){return this.getDelta(),this.elapsedTime}},{key:"getDelta",value:function(){var t=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){var n=(typeof performance=="undefined"?Date:performance).now();t=(n-this.oldTime)/1e3,this.oldTime=n,this.elapsedTime+=t}return t}}]),e}(),ud,Bv,Zv,qA,jh,uh,zv,KA,ld;function cd(e,i){var t=typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=Uv(e))||i&&e&&typeof e.length=="number"){t&&(e=t);var n=0,r=function(){};return{s:r,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(x){throw x},f:r}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var a=!0,u=!1,c;return{s:function(){t=t.call(e)},n:function(){var x=t.next();return a=x.done,x},e:function(x){u=!0,c=x},f:function(){try{!a&&t.return!=null&&t.return()}finally{if(u)throw c}}}}function Uv(e,i){if(e){if(typeof e=="string")return fd(e,i);var t=Object.prototype.toString.call(e).slice(8,-1);if(t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set")return Array.from(e);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return fd(e,i)}}function fd(e,i){(i==null||i>e.length)&&(i=e.length);for(var t=0,n=new Array(i);t<i;t++)n[t]=e[t];return n}function Gv(e){var i=hm();return function(){var n=(0,ue.Z)(e),r;if(i){var a=(0,ue.Z)(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return(0,ze.Z)(this,r)}}function hm(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var hd=In.throttle,Am=(ud=(0,vr.b2)(),Bv=(0,vr.f3)(Xt.IRendererService),Zv=(0,vr.f3)(Xt.IMapService),qA=(0,vr.f3)(Xt.IDebugService),ud(jh=(uh=function(e){(0,Ne.Z)(t,e);var i=Gv(t);function t(){var n;(0,se.Z)(this,t);for(var r=arguments.length,a=new Array(r),u=0;u<r;u++)a[u]=arguments[u];return n=i.call.apply(i,[this].concat(a)),(0,Me.Z)((0,xt.Z)(n),"pickedLayerId",-1),(0,Me.Z)((0,xt.Z)(n),"clock",new Fv),(0,Me.Z)((0,xt.Z)(n),"alreadyInRendering",!1),(0,Me.Z)((0,xt.Z)(n),"layers",[]),(0,Me.Z)((0,xt.Z)(n),"layerList",[]),(0,Me.Z)((0,xt.Z)(n),"layerRenderID",void 0),(0,Me.Z)((0,xt.Z)(n),"sceneInited",!1),(0,Me.Z)((0,xt.Z)(n),"animateInstanceCount",0),(0,Me.Z)((0,xt.Z)(n),"shaderPicking",!0),(0,Me.Z)((0,xt.Z)(n),"enableRender",!0),Ki((0,xt.Z)(n),"renderService",zv,(0,xt.Z)(n)),Ki((0,xt.Z)(n),"mapService",KA,(0,xt.Z)(n)),Ki((0,xt.Z)(n),"debugService",ld,(0,xt.Z)(n)),(0,Me.Z)((0,xt.Z)(n),"reRender",hd(function(){n.renderLayers()},32)),(0,Me.Z)((0,xt.Z)(n),"throttleRenderLayers",hd(function(){n.renderLayers()},16)),n}return(0,be.Z)(t,[{key:"needPick",value:function(r){return this.layerList.some(function(a){return a.needPick(r)})}},{key:"add",value:function(r){var a=this;this.layers.push(r),this.sceneInited&&r.init().then(function(){a.renderLayers()})}},{key:"addMask",value:function(r){var a=this;this.sceneInited&&r.init().then(function(){a.renderLayers()})}},{key:"initLayers",value:function(){var n=(0,ur.Z)(it().mark(function a(){var u=this;return it().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:this.sceneInited=!0,this.layers.forEach(function(){var x=(0,ur.Z)(it().mark(function M(O){return it().wrap(function(W){for(;;)switch(W.prev=W.next){case 0:if(O.startInit){W.next=4;break}return W.next=3,O.init();case 3:u.updateLayerRenderList();case 4:case"end":return W.stop()}},M)}));return function(M){return x.apply(this,arguments)}}());case 2:case"end":return g.stop()}},a,this)}));function r(){return n.apply(this,arguments)}return r}()},{key:"getSceneInited",value:function(){return this.sceneInited}},{key:"getRenderList",value:function(){return this.layerList}},{key:"getLayers",value:function(){return this.layers}},{key:"getLayer",value:function(r){return this.layers.find(function(a){return a.id===r})}},{key:"getLayerByName",value:function(r){return this.layers.find(function(a){return a.name===r})}},{key:"remove",value:function(){var n=(0,ur.Z)(it().mark(function a(u,c){var g,x;return it().wrap(function(O){for(;;)switch(O.prev=O.next){case 0:c?(g=c.layerChildren.indexOf(u),g>-1&&c.layerChildren.splice(g,1)):(x=this.layers.indexOf(u),x>-1&&this.layers.splice(x,1)),u.destroy(),this.reRender(),this.emit("layerChange",this.layers);case 4:case"end":return O.stop()}},a,this)}));function r(a,u){return n.apply(this,arguments)}return r}()},{key:"removeAllLayers",value:function(){var n=(0,ur.Z)(it().mark(function a(){return it().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:this.destroy(),this.reRender();case 2:case"end":return c.stop()}},a,this)}));function r(){return n.apply(this,arguments)}return r}()},{key:"setEnableRender",value:function(r){this.enableRender=r}},{key:"renderLayers",value:function(){var n=(0,ur.Z)(it().mark(function a(){var u,c,g,x,M,O;return it().wrap(function(W){for(;;)switch(W.prev=W.next){case 0:if(!(this.alreadyInRendering||!this.enableRender)){W.next=2;break}return W.abrupt("return");case 2:this.updateLayerRenderList(),u=this.debugService.generateRenderUid(),this.debugService.renderStart(u),this.alreadyInRendering=!0,this.clear(),c=cd(this.layerList),W.prev=8,c.s();case 10:if((g=c.n()).done){W.next=23;break}if(x=g.value,M=x.getLayerConfig(),O=M.enableMask,x.masks.filter(function(ce){return ce.inited}).length>0&&O&&this.renderMask(x.masks),!x.getLayerConfig().enableMultiPassRenderer){W.next=19;break}return W.next=17,x.renderMultiPass();case 17:W.next=21;break;case 19:return W.next=21,x.render();case 21:W.next=10;break;case 23:W.next=28;break;case 25:W.prev=25,W.t0=W.catch(8),c.e(W.t0);case 28:return W.prev=28,c.f(),W.finish(28);case 31:this.debugService.renderEnd(u),this.alreadyInRendering=!1;case 33:case"end":return W.stop()}},a,this,[[8,25,28,31]])}));function r(){return n.apply(this,arguments)}return r}()},{key:"renderMask",value:function(r){var a=0;this.renderService.clear({stencil:0,depth:1,framebuffer:null});var u=r.length>1?E0.MULTIPLE:E0.SINGLE,c=cd(r),g;try{for(c.s();!(g=c.n()).done;){var x=g.value;x.render({isStencil:!0,stencilType:u,stencilIndex:a++})}}catch(M){c.e(M)}finally{c.f()}}},{key:"beforeRenderData",value:function(){var n=(0,ur.Z)(it().mark(function a(u){var c;return it().wrap(function(x){for(;;)switch(x.prev=x.next){case 0:return x.next=2,u.hooks.beforeRenderData.promise();case 2:c=x.sent,c&&this.renderLayers();case 4:case"end":return x.stop()}},a,this)}));function r(a){return n.apply(this,arguments)}return r}()},{key:"renderTileLayerMask",value:function(r){var a=0,u=r.getLayerConfig(),c=u.enableMask,g=c===void 0?!0:c,x=r.tileMask?1:0,M=r.masks.filter(function(oe){return oe.inited});x=x+(g?M.length:1);var O=x>1?E0.MULTIPLE:E0.SINGLE;if((r.tileMask||M.length&&g)&&this.renderService.clear({stencil:0,depth:1,framebuffer:null}),M.length&&g){var B=cd(M),W;try{for(B.s();!(W=B.n()).done;){var ce=W.value;ce.render({isStencil:!0,stencilType:O,stencilIndex:a++})}}catch(oe){B.e(oe)}finally{B.f()}}r.tileMask&&r.tileMask.render({isStencil:!0,stencilType:O,stencilIndex:a++,stencilOperation:kh.OR})}},{key:"renderTileLayer",value:function(){var n=(0,ur.Z)(it().mark(function a(u){return it().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:if(this.renderTileLayerMask(u),!u.getLayerConfig().enableMultiPassRenderer){g.next=6;break}return g.next=4,u.renderMultiPass();case 4:g.next=8;break;case 6:return g.next=8,u.render();case 8:case"end":return g.stop()}},a,this)}));function r(a){return n.apply(this,arguments)}return r}()},{key:"updateLayerRenderList",value:function(){var r=this;this.layerList=[],this.layers.filter(function(a){return a.inited}).filter(function(a){return a.isVisible()}).sort(function(a,u){return a.zIndex-u.zIndex}).forEach(function(a){r.layerList.push(a)})}},{key:"destroy",value:function(){this.layers.forEach(function(r){r.destroy()}),this.layers=[],this.layerList=[],this.emit("layerChange",this.layers)}},{key:"startAnimate",value:function(){this.animateInstanceCount++===0&&(this.clock.start(),this.runRender())}},{key:"stopAnimate",value:function(){--this.animateInstanceCount===0&&(this.stopRender(),this.clock.stop())}},{key:"getOESTextureFloat",value:function(){return this.renderService.extensionObject.OES_texture_float}},{key:"enableShaderPick",value:function(){this.shaderPicking=!0}},{key:"disableShaderPick",value:function(){this.shaderPicking=!1}},{key:"getShaderPickStat",value:function(){return this.shaderPicking}},{key:"clear",value:function(){var r=Ni(this.mapService.bgColor);this.renderService.clear({color:r,depth:1,stencil:0,framebuffer:null})}},{key:"runRender",value:function(){this.renderLayers(),this.layerRenderID=window.requestAnimationFrame(this.runRender.bind(this))}},{key:"stopRender",value:function(){window.cancelAnimationFrame(this.layerRenderID)}}]),t}(ha.EventEmitter),zv=Hi(uh.prototype,"renderService",[Bv],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),KA=Hi(uh.prototype,"mapService",[Zv],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ld=Hi(uh.prototype,"debugService",[qA],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),uh))||jh),Ac=C(91),jv=In.isNil,pm=function(){function e(i){var t=this;(0,se.Z)(this,e),(0,Me.Z)(this,"name",void 0),(0,Me.Z)(this,"type",void 0),(0,Me.Z)(this,"scale",void 0),(0,Me.Z)(this,"descriptor",void 0),(0,Me.Z)(this,"featureBufferLayout",[]),(0,Me.Z)(this,"needRescale",!1),(0,Me.Z)(this,"needRemapping",!1),(0,Me.Z)(this,"needRegenerateVertices",!1),(0,Me.Z)(this,"featureRange",{startIndex:0,endIndex:1/0}),(0,Me.Z)(this,"vertexAttribute",void 0),(0,Me.Z)(this,"defaultCallback",function(n){if(n.length===0){var r;return((r=t.scale)===null||r===void 0?void 0:r.defaultValues)||[]}return n.map(function(a,u){var c,g=(c=t.scale)===null||c===void 0?void 0:c.scalers[u].func,x=g(a);return x})}),this.setProps(i)}return(0,be.Z)(e,[{key:"setProps",value:function(t){Object.assign(this,t)}},{key:"mapping",value:function(t){var n;if((n=this.scale)!==null&&n!==void 0&&n.callback){var r,a=(r=this.scale)===null||r===void 0?void 0:r.callback.apply(r,(0,pr.Z)(t));if(!jv(a))return[a]}return this.defaultCallback(t)}},{key:"resetDescriptor",value:function(){this.descriptor&&(this.descriptor.buffer.data=[])}}]),e}(),dm=["buffer","update","name"],Vv=["buffer","update","name"],Vh,JA,P0,ep,Ad,tp,vm=(Vh={},(0,Me.Z)(Vh,je.FLOAT,4),(0,Me.Z)(Vh,je.UNSIGNED_BYTE,1),(0,Me.Z)(Vh,je.UNSIGNED_SHORT,2),Vh),rp=(JA=(0,vr.b2)(),P0=(0,vr.f3)(Xt.IRendererService),JA(ep=(Ad=function(){function e(){(0,se.Z)(this,e),(0,Me.Z)(this,"attributesAndIndices",void 0),Ki(this,"rendererService",tp,this),(0,Me.Z)(this,"attributes",[]),(0,Me.Z)(this,"triangulation",void 0),(0,Me.Z)(this,"featureLayout",{sizePerElement:0,elements:[]})}return(0,be.Z)(e,[{key:"registerStyleAttribute",value:function(t){var n=this.getLayerStyleAttribute(t.name||"");return n?n.setProps(t):(n=new pm(t),this.attributes.push(n)),n}},{key:"unRegisterStyleAttribute",value:function(t){var n=this.attributes.findIndex(function(r){return r.name===t});n>-1&&this.attributes.splice(n,1)}},{key:"updateScaleAttribute",value:function(t){this.attributes.forEach(function(n){var r,a=n.name,u=(r=n.scale)===null||r===void 0?void 0:r.field;(t[a]||u&&t[u])&&(n.needRescale=!0,n.needRemapping=!0,n.needRegenerateVertices=!0)})}},{key:"updateStyleAttribute",value:function(t,n,r){var a=this.getLayerStyleAttribute(t);a||(a=this.registerStyleAttribute((0,X.Z)((0,X.Z)({},n),{},{name:t})));var u=n.scale;u&&a&&(a.scale=u,a.needRescale=!0,a.needRemapping=!0,a.needRegenerateVertices=!0,r&&r.featureRange&&(a.featureRange=r.featureRange))}},{key:"getLayerStyleAttributes",value:function(){return this.attributes}},{key:"getLayerStyleAttribute",value:function(t){return this.attributes.find(function(n){return n.name===t})}},{key:"getLayerAttributeScale",value:function(t){var n,r=this.getLayerStyleAttribute(t),a=r==null||(n=r.scale)===null||n===void 0?void 0:n.scalers;return a&&a[0]?a[0].func:null}},{key:"updateAttributeByFeatureRange",value:function(t,n){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,a=arguments.length>3?arguments[3]:void 0,u=arguments.length>4?arguments[4]:void 0,c=this.attributes.find(function(bt){return bt.name===t});if(c&&c.descriptor){var g=c.descriptor,x=g.update,M=g.buffer,O=g.size,B=O===void 0?0:O,W=vm[M.type||je.FLOAT];if(x){var ce=this.featureLayout,oe=ce.elements,Te=ce.sizePerElement,Ze=oe.slice(r,a);if(!Ze.length)return;var qe=Ze[0].offset,et=qe*B*W,yt=Ze.map(function(bt,Ot){for(var jt=bt.featureIdx,or=bt.vertices,ar=bt.normals,Sr=or.length/Te,dr=[],jr=0;jr<Sr;jr++){var nn=ar?ar.slice(jr*3,jr*3+3):[];dr.push.apply(dr,(0,pr.Z)(x(n[jt],jt,or.slice(jr*Te,jr*Te+Te),Ot,nn)))}return dr}).reduce(function(bt,Ot){return bt.push.apply(bt,(0,pr.Z)(Ot)),bt},[]);c.vertexAttribute.updateBuffer({data:yt,offset:et}),u==null||u.emit("legend:".concat(t),{type:t,attr:c})}}}},{key:"createAttributesAndIndices",value:function(t,n,r){var a=this;this.featureLayout={sizePerElement:0,elements:[]},n&&(this.triangulation=n);var u=this.attributes.map(function(Ze){return Ze.resetDescriptor(),Ze.descriptor}),c=0,g=0,x=[],M=3;t.forEach(function(Ze,qe){var et=a.triangulation(Ze,r),yt=et.indices,bt=et.vertices,Ot=et.normals,jt=et.size,or=et.indexes,ar=et.count;typeof ar=="number"&&(g+=ar),yt.forEach(function(nn){x.push(nn+c)}),M=jt;var Sr=bt.length/jt;a.featureLayout.sizePerElement=M,a.featureLayout.elements.push({featureIdx:qe,vertices:bt,normals:Ot,offset:c}),c+=Sr;for(var dr=function(En){var _a=(Ot==null?void 0:Ot.slice(En*3,En*3+3))||[],_s=bt.slice(En*jt,En*jt+jt),ls=0;or&&or[En]!==void 0&&(ls=or[En]),u.forEach(function(Ds,ks){if(Ds&&Ds.update){var Wc;(Wc=Ds.buffer.data).push.apply(Wc,(0,pr.Z)(Ds.update(Ze,qe,_s,En,_a,ls)))}})},jr=0;jr<Sr;jr++)dr(jr)});var O=this.rendererService,B=O.createAttribute,W=O.createBuffer,ce=O.createElements,oe={};u.forEach(function(Ze,qe){if(Ze){var et=Ze.buffer,yt=Ze.update,bt=Ze.name,Ot=(0,Ac.Z)(Ze,dm),jt=B((0,X.Z)({buffer:W(et)},Ot));oe[Ze.name||""]=jt,a.attributes[qe].vertexAttribute=jt}});var Te=ce({data:x,type:je.UNSIGNED_INT,count:x.length});return this.attributesAndIndices={attributes:oe,elements:Te,count:g},this.attributesAndIndices}},{key:"createAttributes",value:function(t,n){var r=this;this.featureLayout={sizePerElement:0,elements:[]},n&&(this.triangulation=n);var a=this.attributes.map(function(W){return W.resetDescriptor(),W.descriptor}),u=0,c=[],g=3;t.forEach(function(W,ce){var oe=r.triangulation(W),Te=oe.indices,Ze=oe.vertices,qe=oe.normals,et=oe.size,yt=oe.indexes;Te.forEach(function(or){c.push(or+u)}),g=et;var bt=Ze.length/et;r.featureLayout.sizePerElement=g,r.featureLayout.elements.push({featureIdx:ce,vertices:Ze,normals:qe,offset:u}),u+=bt;for(var Ot=function(ar){var Sr=(qe==null?void 0:qe.slice(ar*3,ar*3+3))||[],dr=Ze.slice(ar*et,ar*et+et),jr=0;yt&&yt[ar]!==void 0&&(jr=yt[ar]),a.forEach(function(nn,En){if(nn&&nn.update){var _a;(_a=nn.buffer.data).push.apply(_a,(0,pr.Z)(nn.update(W,ce,dr,ar,Sr,jr)))}})},jt=0;jt<bt;jt++)Ot(jt)});var x=this.rendererService,M=x.createAttribute,O=x.createBuffer,B={};return a.forEach(function(W,ce){if(W){var oe=W.buffer,Te=W.update,Ze=W.name,qe=(0,Ac.Z)(W,Vv),et=M((0,X.Z)({buffer:O(oe)},qe));B[W.name||""]=et,r.attributes[ce].vertexAttribute=et}}),{attributes:B}}},{key:"clearAllAttributes",value:function(){var t;this.attributes.forEach(function(n){n.vertexAttribute&&n.vertexAttribute.destroy()}),(t=this.attributesAndIndices)===null||t===void 0||t.elements.destroy(),this.attributes=[]}}]),e}(),tp=Hi(Ad.prototype,"rendererService",[P0],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ad))||ep),pd=C(34155);function np(e,i,t,n){function r(a){return a instanceof t?a:new t(function(u){u(a)})}return new(t||(t=Promise))(function(a,u){function c(M){try{x(n.next(M))}catch(O){u(O)}}function g(M){try{x(n.throw(M))}catch(O){u(O)}}function x(M){M.done?a(M.value):r(M.value).then(c,g)}x((n=n.apply(e,i||[])).next())})}function L0(e,i){var t={label:0,sent:function(){if(a[0]&1)throw a[1];return a[1]},trys:[],ops:[]},n,r,a,u;return u={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(u[Symbol.iterator]=function(){return this}),u;function c(x){return function(M){return g([x,M])}}function g(x){if(n)throw new TypeError("Generator is already executing.");for(;t;)try{if(n=1,r&&(a=x[0]&2?r.return:x[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,x[1])).done)return a;switch(r=0,a&&(x=[x[0]&2,a.value]),x[0]){case 0:case 1:a=x;break;case 4:return t.label++,{value:x[1],done:!1};case 5:t.label++,r=x[1],x=[0];continue;case 7:x=t.ops.pop(),t.trys.pop();continue;default:if(a=t.trys,!(a=a.length>0&&a[a.length-1])&&(x[0]===6||x[0]===2)){t=0;continue}if(x[0]===3&&(!a||x[1]>a[0]&&x[1]<a[3])){t.label=x[1];break}if(x[0]===6&&t.label<a[1]){t.label=a[1],a=x;break}if(a&&t.label<a[2]){t.label=a[2],t.ops.push(x);break}a[2]&&t.ops.pop(),t.trys.pop();continue}x=i.call(e,t)}catch(M){x=[6,M],r=0}finally{n=a=0}if(x[0]&5)throw x[1];return{value:x[0]?x[1]:void 0,done:!0}}}function Hh(e,i){var t=typeof Symbol=="function"&&e[Symbol.iterator];if(!t)return e;var n=t.call(e),r,a=[],u;try{for(;(i===void 0||i-- >0)&&!(r=n.next()).done;)a.push(r.value)}catch(c){u={error:c}}finally{try{r&&!r.done&&(t=n.return)&&t.call(n)}finally{if(u)throw u.error}}return a}function ip(e,i,t){if(t||arguments.length===2)for(var n=0,r=i.length,a;n<r;n++)(a||!(n in i))&&(a||(a=Array.prototype.slice.call(i,0,n)),a[n]=i[n]);return e.concat(a||Array.prototype.slice.call(i))}function lh(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var dd={exports:{}},$h={exports:{}},Yh={exports:{}};(function(e,i){Object.defineProperty(i,"__esModule",{value:!0}),i.default=t;function t(n){return n&&typeof n.length=="number"&&n.length>=0&&n.length%1===0}e.exports=i.default})(Yh,Yh.exports);var Yu={},vd={exports:{}},O0={exports:{}};(function(e,i){Object.defineProperty(i,"__esModule",{value:!0}),i.default=function(t){return function(){for(var n=[],r=arguments.length;r--;)n[r]=arguments[r];var a=n.pop();return t.call(this,n,a)}},e.exports=i.default})(O0,O0.exports);var Jf={};Object.defineProperty(Jf,"__esModule",{value:!0}),Jf.fallback=Hv,Jf.wrap=ap;var gd=Jf.hasQueueMicrotask=typeof queueMicrotask=="function"&&queueMicrotask,gm=Jf.hasSetImmediate=typeof setImmediate=="function"&&setImmediate,md=Jf.hasNextTick=typeof pd=="object"&&typeof pd.nextTick=="function";function Hv(e){setTimeout(e,0)}function ap(e){return function(i){for(var t=[],n=arguments.length-1;n-- >0;)t[n]=arguments[n+1];return e(function(){return i.apply(void 0,t)})}}var Wh;gd?Wh=queueMicrotask:gm?Wh=setImmediate:md?Wh=pd.nextTick:Wh=Hv,Jf.default=ap(Wh),function(e,i){Object.defineProperty(i,"__esModule",{value:!0}),i.default=g;var t=O0.exports,n=c(t),r=Jf,a=c(r),u=Yu;function c(O){return O&&O.__esModule?O:{default:O}}function g(O){return(0,u.isAsync)(O)?function(){for(var B=[],W=arguments.length;W--;)B[W]=arguments[W];var ce=B.pop(),oe=O.apply(this,B);return x(oe,ce)}:(0,n.default)(function(B,W){var ce;try{ce=O.apply(this,B)}catch(oe){return W(oe)}if(ce&&typeof ce.then=="function")return x(ce,W);W(null,ce)})}function x(O,B){return O.then(function(W){M(B,null,W)},function(W){M(B,W&&W.message?W:new Error(W))})}function M(O,B,W){try{O(B,W)}catch(ce){(0,a.default)(function(oe){throw oe},ce)}}e.exports=i.default}(vd,vd.exports),Object.defineProperty(Yu,"__esModule",{value:!0}),Yu.isAsyncIterable=Yu.isAsyncGenerator=Yu.isAsync=void 0;var yd=vd.exports,mm=ym(yd);function ym(e){return e&&e.__esModule?e:{default:e}}function ch(e){return e[Symbol.toStringTag]==="AsyncFunction"}function _d(e){return e[Symbol.toStringTag]==="AsyncGenerator"}function xd(e){return typeof e[Symbol.asyncIterator]=="function"}function Ed(e){if(typeof e!="function")throw new Error("expected a function");return ch(e)?(0,mm.default)(e):e}Yu.default=Ed,Yu.isAsync=ch,Yu.isAsyncGenerator=_d,Yu.isAsyncIterable=xd;var e0={exports:{}};(function(e,i){Object.defineProperty(i,"__esModule",{value:!0}),i.default=t;function t(n,r){if(r===void 0&&(r=n.length),!r)throw new Error("arity is undefined");function a(){for(var u=this,c=[],g=arguments.length;g--;)c[g]=arguments[g];return typeof c[r-1]=="function"?n.apply(this,c):new Promise(function(x,M){c[r-1]=function(O){for(var B=[],W=arguments.length-1;W-- >0;)B[W]=arguments[W+1];if(O)return M(O);x(B.length>1?B:B[0])},n.apply(u,c)})}return a}e.exports=i.default})(e0,e0.exports),function(e,i){Object.defineProperty(i,"__esModule",{value:!0});var t=Yh.exports,n=g(t),r=Yu,a=g(r),u=e0.exports,c=g(u);function g(x){return x&&x.__esModule?x:{default:x}}i.default=(0,c.default)(function(x,M,O){var B=(0,n.default)(M)?[]:{};x(M,function(W,ce,oe){(0,a.default)(W)(function(Te){for(var Ze,qe=[],et=arguments.length-1;et-- >0;)qe[et]=arguments[et+1];qe.length<2&&(Ze=qe,qe=Ze[0]),B[ce]=qe,oe(Te)})},function(W){return O(W,B)})},3),e.exports=i.default}($h,$h.exports);var bd={exports:{}},op={exports:{}},Sd={exports:{}},Xh={exports:{}};(function(e,i){Object.defineProperty(i,"__esModule",{value:!0}),i.default=t;function t(n){function r(){for(var a=[],u=arguments.length;u--;)a[u]=arguments[u];if(n!==null){var c=n;n=null,c.apply(this,a)}}return Object.assign(r,n),r}e.exports=i.default})(Xh,Xh.exports);var Cd={exports:{}},wd={exports:{}};(function(e,i){Object.defineProperty(i,"__esModule",{value:!0}),i.default=function(t){return t[Symbol.iterator]&&t[Symbol.iterator]()},e.exports=i.default})(wd,wd.exports),function(e,i){Object.defineProperty(i,"__esModule",{value:!0}),i.default=M;var t=Yh.exports,n=u(t),r=wd.exports,a=u(r);function u(O){return O&&O.__esModule?O:{default:O}}function c(O){var B=-1,W=O.length;return function(){return++B<W?{value:O[B],key:B}:null}}function g(O){var B=-1;return function(){var ce=O.next();return ce.done?null:(B++,{value:ce.value,key:B})}}function x(O){var B=O?Object.keys(O):[],W=-1,ce=B.length;return function oe(){var Te=B[++W];return Te==="__proto__"?oe():W<ce?{value:O[Te],key:Te}:null}}function M(O){if((0,n.default)(O))return c(O);var B=(0,a.default)(O);return B?g(B):x(O)}e.exports=i.default}(Cd,Cd.exports);var fh={exports:{}};(function(e,i){Object.defineProperty(i,"__esModule",{value:!0}),i.default=t;function t(n){return function(){for(var r=[],a=arguments.length;a--;)r[a]=arguments[a];if(n===null)throw new Error("Callback was already called.");var u=n;n=null,u.apply(this,r)}}e.exports=i.default})(fh,fh.exports);var sp={exports:{}},Qh={exports:{}};(function(e,i){Object.defineProperty(i,"__esModule",{value:!0});var t={};i.default=t,e.exports=i.default})(Qh,Qh.exports),function(e,i){Object.defineProperty(i,"__esModule",{value:!0}),i.default=a;var t=Qh.exports,n=r(t);function r(u){return u&&u.__esModule?u:{default:u}}function a(u,c,g,x){var M=!1,O=!1,B=!1,W=0,ce=0;function oe(){W>=c||B||M||(B=!0,u.next().then(function(qe){var et=qe.value,yt=qe.done;if(!(O||M)){if(B=!1,yt){M=!0,W<=0&&x(null);return}W++,g(et,ce,Te),ce++,oe()}}).catch(Ze))}function Te(qe,et){if(W-=1,!O){if(qe)return Ze(qe);if(qe===!1){M=!0,O=!0;return}if(et===n.default||M&&W<=0)return M=!0,x(null);oe()}}function Ze(qe){O||(B=!1,M=!0,x(qe))}oe()}e.exports=i.default}(sp,sp.exports),function(e,i){Object.defineProperty(i,"__esModule",{value:!0});var t=Xh.exports,n=W(t),r=Cd.exports,a=W(r),u=fh.exports,c=W(u),g=Yu,x=sp.exports,M=W(x),O=Qh.exports,B=W(O);function W(ce){return ce&&ce.__esModule?ce:{default:ce}}i.default=function(ce){return function(oe,Te,Ze){if(Ze=(0,n.default)(Ze),ce<=0)throw new RangeError("concurrency limit cannot be less than 1");if(!oe)return Ze(null);if((0,g.isAsyncGenerator)(oe))return(0,M.default)(oe,ce,Te,Ze);if((0,g.isAsyncIterable)(oe))return(0,M.default)(oe[Symbol.asyncIterator](),ce,Te,Ze);var qe=(0,a.default)(oe),et=!1,yt=!1,bt=0,Ot=!1;function jt(ar,Sr){if(!yt)if(bt-=1,ar)et=!0,Ze(ar);else if(ar===!1)et=!0,yt=!0;else{if(Sr===B.default||et&&bt<=0)return et=!0,Ze(null);Ot||or()}}function or(){for(Ot=!0;bt<ce&&!et;){var ar=qe();if(ar===null){et=!0,bt<=0&&Ze(null);return}bt+=1,Te(ar.value,ar.key,(0,c.default)(jt))}Ot=!1}or()}},e.exports=i.default}(Sd,Sd.exports),function(e,i){Object.defineProperty(i,"__esModule",{value:!0});var t=Sd.exports,n=g(t),r=Yu,a=g(r),u=e0.exports,c=g(u);function g(M){return M&&M.__esModule?M:{default:M}}function x(M,O,B,W){return(0,n.default)(O)(M,(0,a.default)(B),W)}i.default=(0,c.default)(x,4),e.exports=i.default}(op,op.exports),function(e,i){Object.defineProperty(i,"__esModule",{value:!0});var t=op.exports,n=u(t),r=e0.exports,a=u(r);function u(g){return g&&g.__esModule?g:{default:g}}function c(g,x,M){return(0,n.default)(g,1,x,M)}i.default=(0,a.default)(c,3),e.exports=i.default}(bd,bd.exports),function(e,i){Object.defineProperty(i,"__esModule",{value:!0}),i.default=c;var t=$h.exports,n=u(t),r=bd.exports,a=u(r);function u(g){return g&&g.__esModule?g:{default:g}}function c(g,x){return(0,n.default)(a.default,g,x)}e.exports=i.default}(dd,dd.exports);var up=lh(dd.exports),Gc=function(){function e(){this.args=[],this.tasks=[]}return e.prototype.call=function(){for(var i=arguments,t=[],n=0;n<arguments.length;n++)t[n]=i[n];return this.args=t,up(this.tasks)},e.prototype.tap=function(i,t){var n=this;this.tasks.push(function(r){t.apply(void 0,ip([],Hh(n.args),!1)),r(null,i)})},e}(),qh={exports:{}},lp={exports:{}};(function(e,i){Object.defineProperty(i,"__esModule",{value:!0});var t=Yh.exports,n=Te(t),r=Qh.exports,a=Te(r),u=op.exports,c=Te(u),g=Xh.exports,x=Te(g),M=fh.exports,O=Te(M),B=Yu,W=Te(B),ce=e0.exports,oe=Te(ce);function Te(yt){return yt&&yt.__esModule?yt:{default:yt}}function Ze(yt,bt,Ot){Ot=(0,x.default)(Ot);var jt=0,or=0,ar=yt.length,Sr=!1;ar===0&&Ot(null);function dr(jr,nn){jr===!1&&(Sr=!0),Sr!==!0&&(jr?Ot(jr):(++or===ar||nn===a.default)&&Ot(null))}for(;jt<ar;jt++)bt(yt[jt],jt,(0,O.default)(dr))}function qe(yt,bt,Ot){return(0,c.default)(yt,1/0,bt,Ot)}function et(yt,bt,Ot){var jt=(0,n.default)(yt)?Ze:qe;return jt(yt,(0,W.default)(bt),Ot)}i.default=(0,oe.default)(et,3),e.exports=i.default})(lp,lp.exports),function(e,i){Object.defineProperty(i,"__esModule",{value:!0}),i.default=c;var t=lp.exports,n=u(t),r=$h.exports,a=u(r);function u(g){return g&&g.__esModule?g:{default:g}}function c(g,x){return(0,a.default)(n.default,g,x)}e.exports=i.default}(qh,qh.exports);var _m=lh(qh.exports),Lx=function(){function e(){this.tasks=[]}return e.prototype.promise=function(){return _m(this.tasks)},e.prototype.tapPromise=function(i,t){var n=this;this.tasks.push(function(r){return np(n,void 0,void 0,function(){return L0(this,function(a){switch(a.label){case 0:return[4,t()];case 1:return a.sent(),r(null,i),[2]}})})})},e}(),Td={exports:{}};(function(e,i){Object.defineProperty(i,"__esModule",{value:!0});var t=Xh.exports,n=M(t),r=fh.exports,a=M(r),u=Yu,c=M(u),g=e0.exports,x=M(g);function M(B){return B&&B.__esModule?B:{default:B}}function O(B,W){if(W=(0,n.default)(W),!Array.isArray(B))return W(new Error("First argument to waterfall must be an array of functions"));if(!B.length)return W();var ce=0;function oe(Ze){var qe=(0,c.default)(B[ce++]);qe.apply(void 0,Ze.concat([(0,a.default)(Te)]))}function Te(Ze){for(var qe=[],et=arguments.length-1;et-- >0;)qe[et]=arguments[et+1];if(Ze!==!1){if(Ze||ce===B.length)return W.apply(void 0,[Ze].concat(qe));oe(qe)}}oe([])}i.default=(0,x.default)(O),e.exports=i.default})(Td,Td.exports);var $v=lh(Td.exports),Ox=function(){function e(){this.tasks=[]}return e.prototype.call=function(){return $v(this.tasks)},e.prototype.tap=function(i,t){this.tasks.length===0?this.tasks.push(function(n){var r=t();n(r?null:!1,r)}):this.tasks.push(function(n,r){var a=t.apply(void 0,ip([],Hh(n),!1));r(a?null:!1,i)})},e}(),Yv=function(){function e(){this.tasks=[]}return e.prototype.call=function(){return up(this.tasks)},e.prototype.tap=function(i,t){this.tasks.push(function(n){var r=t();n(r,i)})},e}(),xm=function(){function e(){this.args=[],this.tasks=[]}return e.prototype.promise=function(){for(var i=arguments,t=[],n=0;n<arguments.length;n++)t[n]=i[n];return this.args=t,up(this.tasks)},e.prototype.tapPromise=function(i,t){var n=this;this.tasks.push(function(r){return np(n,void 0,void 0,function(){return L0(this,function(a){switch(a.label){case 0:return[4,t.apply(void 0,ip([],Hh(this.args),!1))];case 1:return a.sent(),r(null,i),[2]}})})})},e}(),Em=function(){function e(){this.args=[],this.tasks=[]}return e.prototype.promise=function(){for(var i=arguments,t=[],n=0;n<arguments.length;n++)t[n]=i[n];return this.args=t,up(this.tasks)},e.prototype.tapPromise=function(i,t){var n=this;this.tasks.push(function(r){return np(n,void 0,void 0,function(){var a;return L0(this,function(u){switch(u.label){case 0:return[4,t.apply(void 0,ip([],Hh(this.args),!1))];case 1:return a=u.sent(),r(a,i),[2]}})})})},e}(),l=function(){function e(){this.tasks=[]}return e.prototype.promise=function(){return $v(this.tasks)},e.prototype.tapPromise=function(i,t){this.tasks.length===0?this.tasks.push(function(n){t().then(function(r){n(null,r)})}):this.tasks.push(function(n,r){t(n).then(function(a){r(null,a)})})},e}(),A=C(67709),y=C.n(A),b,T,P,R,U,H,N,Q,K,ae,ge,pt,at,Nt,dt,Ke,ht,Ht,Bt,ir,Kt,fr,Ct,si,bn,Ei,$i,on,ai,kn,La,Sa,Ji,mu,ys;function su(e){var i=Qa();return function(){var n=(0,ue.Z)(e),r;if(i){var a=(0,ue.Z)(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return(0,ze.Z)(this,r)}}function Qa(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var po=(b=(0,vr.b2)(),T=(0,vr.f3)(Xt.SceneID),P=(0,vr.f3)(Xt.IIconService),R=(0,vr.f3)(Xt.IFontService),U=(0,vr.f3)(Xt.IControlService),H=(0,vr.f3)(Xt.IGlobalConfigService),N=(0,vr.f3)(Xt.IMapService),Q=(0,vr.f3)(Xt.ICoordinateSystemService),K=(0,vr.f3)(Xt.IRendererService),ae=(0,vr.f3)(Xt.ILayerService),ge=(0,vr.f3)(Xt.IDebugService),pt=(0,vr.f3)(Xt.ICameraService),at=(0,vr.f3)(Xt.IInteractionService),Nt=(0,vr.f3)(Xt.IPickingService),dt=(0,vr.f3)(Xt.IShaderModuleService),Ke=(0,vr.f3)(Xt.IMarkerService),ht=(0,vr.f3)(Xt.IPopupService),b(Ht=(Bt=function(e){(0,Ne.Z)(t,e);var i=su(t);function t(){var n;return(0,se.Z)(this,t),n=i.call(this),(0,Me.Z)((0,xt.Z)(n),"destroyed",!1),(0,Me.Z)((0,xt.Z)(n),"loaded",!1),Ki((0,xt.Z)(n),"id",ir,(0,xt.Z)(n)),Ki((0,xt.Z)(n),"iconService",Kt,(0,xt.Z)(n)),Ki((0,xt.Z)(n),"fontService",fr,(0,xt.Z)(n)),Ki((0,xt.Z)(n),"controlService",Ct,(0,xt.Z)(n)),Ki((0,xt.Z)(n),"configService",si,(0,xt.Z)(n)),Ki((0,xt.Z)(n),"map",bn,(0,xt.Z)(n)),Ki((0,xt.Z)(n),"coordinateSystemService",Ei,(0,xt.Z)(n)),Ki((0,xt.Z)(n),"rendererService",$i,(0,xt.Z)(n)),Ki((0,xt.Z)(n),"layerService",on,(0,xt.Z)(n)),Ki((0,xt.Z)(n),"debugService",ai,(0,xt.Z)(n)),Ki((0,xt.Z)(n),"cameraService",kn,(0,xt.Z)(n)),Ki((0,xt.Z)(n),"interactionService",La,(0,xt.Z)(n)),Ki((0,xt.Z)(n),"pickingService",Sa,(0,xt.Z)(n)),Ki((0,xt.Z)(n),"shaderModuleService",Ji,(0,xt.Z)(n)),Ki((0,xt.Z)(n),"markerService",mu,(0,xt.Z)(n)),Ki((0,xt.Z)(n),"popupService",ys,(0,xt.Z)(n)),(0,Me.Z)((0,xt.Z)(n),"inited",!1),(0,Me.Z)((0,xt.Z)(n),"initPromise",void 0),(0,Me.Z)((0,xt.Z)(n),"rendering",!1),(0,Me.Z)((0,xt.Z)(n),"$container",void 0),(0,Me.Z)((0,xt.Z)(n),"canvas",void 0),(0,Me.Z)((0,xt.Z)(n),"markerContainer",void 0),(0,Me.Z)((0,xt.Z)(n),"hooks",void 0),(0,Me.Z)((0,xt.Z)(n),"handleWindowResized",function(){n.emit("resize"),n.$container&&(n.initContainer(),Yo(),n.coordinateSystemService.needRefresh=!0,n.render())}),(0,Me.Z)((0,xt.Z)(n),"handleMapCameraChanged",function(r){n.cameraService.update(r),n.render()}),n.hooks={init:new xm},n}return(0,be.Z)(t,[{key:"init",value:function(r){var a=this;this.configService.setSceneConfig(this.id,r),this.shaderModuleService.registerBuiltinModules(),this.iconService.init(),this.iconService.on("imageUpdate",function(){return a.render()}),this.fontService.init(),this.hooks.init.tapPromise("initMap",(0,ur.Z)(it().mark(function u(){return it().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return a.debugService.log("map.mapInitStart",{type:a.map.version}),g.next=3,new Promise(function(x){a.map.onCameraChanged(function(M){a.cameraService.init(),a.cameraService.update(M),x()}),a.map.init()});case 3:a.map.onCameraChanged(a.handleMapCameraChanged),a.map.addMarkerContainer(),a.markerService.addMarkers(),a.markerService.addMarkerLayers(),a.popupService.initPopup(),a.interactionService.init(),a.interactionService.on($u.Drag,a.addSceneEvent.bind(a));case 10:case"end":return g.stop()}},u)}))),this.hooks.init.tapPromise("initRenderer",(0,ur.Z)(it().mark(function u(){var c,g,x;return it().wrap(function(O){for(;;)switch(O.prev=O.next){case 0:if(g=((c=a.map)===null||c===void 0?void 0:c.getOverlayContainer())||void 0,g?a.$container=g:a.$container=ed(a.configService.getSceneConfig(a.id).id||""),!a.$container){O.next=13;break}return a.canvas=ni("canvas","",a.$container),a.setCanvas(),O.next=7,a.rendererService.init(a.canvas,a.configService.getSceneConfig(a.id),r.gl);case 7:a.registerContextLost(),a.initContainer(),y()(a.$container,a.handleWindowResized),window.matchMedia&&((x=window.matchMedia("screen and (-webkit-min-device-pixel-ratio: 1.5)"))===null||x===void 0||x.addListener(a.handleWindowResized)),O.next=14;break;case 13:console.error("\u5BB9\u5668 id \u4E0D\u5B58\u5728");case 14:a.pickingService.init(a.id);case 15:case"end":return O.stop()}},u)}))),this.render()}},{key:"registerContextLost",value:function(){var r=this,a=this.rendererService.getCanvas();a&&a.addEventListener("webglcontextlost",function(){return r.emit("webglcontextlost")})}},{key:"initMiniScene",value:function(r){var a=this;this.configService.setSceneConfig(this.id,r),this.shaderModuleService.registerBuiltinModules(),this.iconService.init(),this.iconService.on("imageUpdate",function(){return a.render()}),this.fontService.init(),this.hooks.init.tapPromise("initMap",(0,ur.Z)(it().mark(function u(){return it().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return g.next=2,new Promise(function(x){a.map.onCameraChanged(function(M){a.cameraService.init(),a.cameraService.update(M),a.map.version!=="GAODE2.x"&&x()}),a.map.initMiniMap()});case 2:a.map.onCameraChanged(a.handleMapCameraChanged),a.interactionService.init(),a.interactionService.on($u.Drag,a.addSceneEvent.bind(a));case 5:case"end":return g.stop()}},u)}))),this.hooks.init.tapPromise("initRenderer",(0,ur.Z)(it().mark(function u(){var c;return it().wrap(function(x){for(;;)switch(x.prev=x.next){case 0:if(c=r.canvas,a.$container=c||null,!a.$container){x.next=7;break}return x.next=5,a.rendererService.init(r.canvas,a.configService.getSceneConfig(a.id),void 0);case 5:x.next=8;break;case 7:console.error("\u5BB9\u5668 id \u4E0D\u5B58\u5728");case 8:a.pickingService.init(a.id);case 9:case"end":return x.stop()}},u)}))),this.initPromise=this.hooks.init.promise(),this.render()}},{key:"addLayer",value:function(r){this.layerService.sceneService=this,this.layerService.add(r)}},{key:"addMask",value:function(r){this.layerService.sceneService=this,this.layerService.addMask(r)}},{key:"render",value:function(){var n=(0,ur.Z)(it().mark(function a(){return it().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:if(!(this.rendering||this.destroyed)){c.next=2;break}return c.abrupt("return");case 2:if(this.rendering=!0,this.inited){c.next=16;break}return c.next=6,this.hooks.init.promise();case 6:return this.destroyed&&this.destroy(),c.next=9,this.layerService.initLayers();case 9:this.layerService.renderLayers(),this.controlService.addControls(),this.loaded=!0,this.emit("loaded"),this.inited=!0,c.next=20;break;case 16:return c.next=18,this.layerService.initLayers();case 18:return c.next=20,this.layerService.renderLayers();case 20:this.rendering=!1;case 21:case"end":return c.stop()}},a,this)}));function r(){return n.apply(this,arguments)}return r}()},{key:"addFontFace",value:function(r,a){this.fontService.addFontFace(r,a)}},{key:"getSceneContainer",value:function(){return this.$container}},{key:"exportPng",value:function(){var n=(0,ur.Z)(it().mark(function a(u){var c,g,x;return it().wrap(function(O){for(;;)switch(O.prev=O.next){case 0:return g=(c=this.$container)===null||c===void 0?void 0:c.getElementsByTagName("canvas")[0],O.next=3,this.render();case 3:return x=u==="jpg"?g==null?void 0:g.toDataURL("image/jpeg"):g==null?void 0:g.toDataURL("image/png"),O.abrupt("return",x);case 5:case"end":return O.stop()}},a,this)}));function r(a){return n.apply(this,arguments)}return r}()},{key:"getSceneConfig",value:function(){return this.configService.getSceneConfig(this.id)}},{key:"getPointSizeRange",value:function(){return this.rendererService.getPointSizeRange()}},{key:"addMarkerContainer",value:function(){var r=this.$container.parentElement;r!==null&&(this.markerContainer=ni("div","l7-marker-container",r))}},{key:"getMarkerContainer",value:function(){return this.markerContainer}},{key:"destroy",value:function(){var r=this,a,u;if(!this.inited){this.destroyed=!0;return}if((0,A.unbind)(this.$container,this.handleWindowResized),window.matchMedia){var c;(c=window.matchMedia("screen and (min-resolution: 2dppx)"))===null||c===void 0||c.removeListener(this.handleWindowResized)}this.pickingService.destroy(),this.layerService.destroy(),this.interactionService.destroy(),this.controlService.destroy(),this.markerService.destroy(),this.fontService.destroy(),this.iconService.destroy(),this.removeAllListeners(),this.inited=!1,this.map.destroy(),setTimeout(function(){var g;(g=r.$container)===null||g===void 0||g.removeChild(r.canvas),r.canvas=null,r.rendererService.destroy()}),(a=this.$container)===null||a===void 0||(u=a.parentNode)===null||u===void 0||u.removeChild(this.$container),this.emit("destroy")}},{key:"initContainer",value:function(){var r,a,u=fa,c=((r=this.$container)===null||r===void 0?void 0:r.clientWidth)||400,g=((a=this.$container)===null||a===void 0?void 0:a.clientHeight)||300,x=this.canvas;x&&(x.width=c*u,x.height=g*u),this.rendererService.viewport({x:0,y:0,width:u*c,height:u*g})}},{key:"setCanvas",value:function(){var r,a,u=fa,c=((r=this.$container)===null||r===void 0?void 0:r.clientWidth)||400,g=((a=this.$container)===null||a===void 0?void 0:a.clientHeight)||300,x=this.canvas;x.width=c*u,x.height=g*u,x.style.width="100%",x.style.height="100%"}},{key:"addSceneEvent",value:function(r){this.emit(r.type,r)}}]),t}(ha.EventEmitter),ir=Hi(Bt.prototype,"id",[T],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Kt=Hi(Bt.prototype,"iconService",[P],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),fr=Hi(Bt.prototype,"fontService",[R],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ct=Hi(Bt.prototype,"controlService",[U],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),si=Hi(Bt.prototype,"configService",[H],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),bn=Hi(Bt.prototype,"map",[N],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ei=Hi(Bt.prototype,"coordinateSystemService",[Q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),$i=Hi(Bt.prototype,"rendererService",[K],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),on=Hi(Bt.prototype,"layerService",[ae],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ai=Hi(Bt.prototype,"debugService",[ge],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),kn=Hi(Bt.prototype,"cameraService",[pt],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),La=Hi(Bt.prototype,"interactionService",[at],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Sa=Hi(Bt.prototype,"pickingService",[Nt],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ji=Hi(Bt.prototype,"shaderModuleService",[dt],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),mu=Hi(Bt.prototype,"markerService",[Ke],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ys=Hi(Bt.prototype,"popupService",[ht],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Bt))||Ht);function Vo(e){var i=0;switch(e){case"vec2":case"ivec2":i=2;break;case"vec3":case"ivec3":i=3;break;case"vec4":case"ivec4":case"mat2":i=4;break;case"mat3":i=9;break;case"mat4":i=16;break;default:}return i}var jc=/uniform\s+(bool|float|int|vec2|vec3|vec4|ivec2|ivec3|ivec4|mat2|mat3|mat4|sampler2D|samplerCube)\s+([\s\S]*?);/g;function Ql(e){var i={};return e=e.replace(jc,function(t,n,r){var a=r.split(":"),u=a[0].trim(),c="";switch(a.length>1&&(c=a[1].trim()),n){case"bool":c=c==="true";break;case"float":case"int":c=Number(c);break;case"vec2":case"vec3":case"vec4":case"ivec2":case"ivec3":case"ivec4":case"mat2":case"mat3":case"mat4":c?c=c.replace("[","").replace("]","").split(",").reduce(function(g,x){return g.push(Number(x.trim())),g},[]):c=new Array(Vo(n)).fill(0);break;default:}return i[u]=c,"uniform ".concat(n," ").concat(u,`;
`)}),{content:e,uniforms:i}}var Kh,R0,Jh=In.uniq,hh="#define PI 3.14159265359",Wv=`#define SHIFT_RIGHT17 1.0 / 131072.0
#define SHIFT_RIGHT18 1.0 / 262144.0
#define SHIFT_RIGHT19 1.0 / 524288.0
#define SHIFT_RIGHT20 1.0 / 1048576.0
#define SHIFT_RIGHT21 1.0 / 2097152.0
#define SHIFT_RIGHT22 1.0 / 4194304.0
#define SHIFT_RIGHT23 1.0 / 8388608.0
#define SHIFT_RIGHT24 1.0 / 16777216.0

#define SHIFT_LEFT17 131072.0
#define SHIFT_LEFT18 262144.0
#define SHIFT_LEFT19 524288.0
#define SHIFT_LEFT20 1048576.0
#define SHIFT_LEFT21 2097152.0
#define SHIFT_LEFT22 4194304.0
#define SHIFT_LEFT23 8388608.0
#define SHIFT_LEFT24 16777216.0

vec2 unpack_float(float packedValue) {
  int packedIntValue = int(packedValue);
  int v0 = packedIntValue / 256;
  return vec2(v0, packedIntValue - v0 * 256);
}

vec4 decode_color(vec2 encodedColor) {
  return vec4(
    unpack_float(encodedColor[0]) / 255.0,
    unpack_float(encodedColor[1]) / 255.0
  );
}
`,Xv=`#define ambientRatio 0.5
#define diffuseRatio 0.3
#define specularRatio 0.2


float calc_lighting(vec4 pos) {

    vec3 worldPos = vec3(pos * u_ModelMatrix);

    vec3 worldNormal = a_Normal;
      // //cal light weight
    vec3 viewDir = normalize(u_CameraPosition - worldPos);

    vec3 lightDir = normalize(vec3(1, -10.5, 12));

    vec3 halfDir = normalize(viewDir+lightDir);
      // //lambert
    float lambert = dot(worldNormal, lightDir);
        //specular
    float specular = pow(max(0.0, dot(worldNormal, halfDir)), 32.0);
        //sum to light weight
    float lightWeight = ambientRatio + diffuseRatio * lambert + specularRatio * specular;

    return lightWeight;
}
`,Qv=`// Blinn-Phong model
// apply lighting in vertex shader instead of fragment shader
// @see https://learnopengl.com/Advanced-Lighting/Advanced-Lighting
uniform float u_Ambient : 1.0;
uniform float u_Diffuse : 1.0;
uniform float u_Specular : 1.0;
uniform int u_NumOfDirectionalLights : 1;
uniform int u_NumOfSpotLights : 0;

#define SHININESS 32.0
#define MAX_NUM_OF_DIRECTIONAL_LIGHTS 3
#define MAX_NUM_OF_SPOT_LIGHTS 3

struct DirectionalLight {
  vec3 direction;
  vec3 ambient;
  vec3 diffuse;
  vec3 specular;
};

struct SpotLight {
  vec3 position;
  vec3 direction;
  vec3 ambient;
  vec3 diffuse;
  vec3 specular;
  float constant;
  float linear;
  float quadratic;
  float angle;
  float blur;
  float exponent;
};

uniform DirectionalLight u_DirectionalLights[MAX_NUM_OF_DIRECTIONAL_LIGHTS];
uniform SpotLight u_SpotLights[MAX_NUM_OF_SPOT_LIGHTS];

vec3 calc_directional_light(DirectionalLight light, vec3 normal, vec3 viewDir) {
  vec3 lightDir = normalize(light.direction);
  // diffuse shading
  float diff = max(dot(normal, lightDir), 0.0);
  // Blinn-Phong specular shading
  vec3 halfwayDir = normalize(lightDir + viewDir);
  float spec = pow(max(dot(normal, halfwayDir), 0.0), SHININESS);

  vec3 ambient = light.ambient * u_Ambient;
  vec3 diffuse = light.diffuse * diff * u_Diffuse;
  vec3 specular = light.specular * spec * u_Specular;

  return ambient + diffuse + specular;
}

// vec3 calc_spot_light(SpotLight light, vec3 normal, vec3 fragPos, vec3 viewDir) {
//   vec3 lightDir = normalize(light.position - fragPos);
//   // diffuse shading
//   float diff = max(dot(normal, lightDir), 0.0);
//   // specular shading
//   vec3 reflectDir = reflect(-lightDir, normal);
//   float spec = pow(max(dot(viewDir, reflectDir), 0.0), SHININESS);
//   // attenuation
//   float distance = length(light.position - fragPos);
//   float attenuation = 1.0 / (light.constant + light.linear * distance +
//           light.quadratic * (distance * distance));

//   vec3 ambient = light.ambient * u_Ambient;
//   vec3 diffuse = light.diffuse * diff * u_Diffuse;
//   vec3 specular = light.specular * spec * u_Specular;

//   float spotEffect = dot(normalize(light.direction), -lightDir);
//   float spotCosCutoff = cos(light.angle / 180.0 * PI);
//   float spotCosOuterCutoff = cos((light.angle + light.blur) / 180.0 * PI);
//   float spotCosInnerCutoff = cos((light.angle - light.blur) / 180.0 * PI);
//   if (spotEffect > spotCosCutoff) {
//     spotEffect = pow(smoothstep(spotCosOuterCutoff, spotCosInnerCutoff, spotEffect), light.exponent);
//   } else {
//     spotEffect = 0.0;
//   }

//   return ambient + attenuation * (spotEffect * diffuse + specular);
// }

vec3 calc_lighting(vec3 position, vec3 normal, vec3 viewDir) {
  vec3 weight = vec3(0.0);
  for (int i = 0; i < MAX_NUM_OF_DIRECTIONAL_LIGHTS; i++) {
    if (i >= u_NumOfDirectionalLights) {
      break;
    }
    weight += calc_directional_light(u_DirectionalLights[i], normal, viewDir);
  }
  // for (int i = 0; i < MAX_NUM_OF_SPOT_LIGHTS; i++) {
  //   if (i >= u_NumOfSpotLights) {
  //     break;
  //   }
  //   weight += calc_spot_light(u_SpotLights[i], normal, position, viewDir);
  // }
  return weight;
}
`,qv=`varying vec4 v_PickingResult;
uniform vec4 u_HighlightColor : [0, 0, 0, 0];
uniform vec4 u_SelectColor : [0, 0, 0, 0];
uniform float u_PickingStage : 0.0;
uniform float u_shaderPick;

uniform float u_activeMix: 0;

#define PICKING_NONE 0.0
#define PICKING_ENCODE 1.0
#define PICKING_HIGHLIGHT 2.0
#define COLOR_SCALE 1. / 255.

#define HIGHLIGHT 1.0
#define SELECT 2.0

/*
 * Returns highlight color if this item is selected.
 */
vec4 filterHighlightColor(vec4 color, float weight) {
  // float selected = v_PickingResult.a;
  bool selected = bool(v_PickingResult.a);

  // if (selected == SELECT) {
  if (selected) {
  //   // \u70B9\u51FB\u9009\u4E2D\u72B6\u6001
  //   vec4 selectColor = u_SelectColor * COLOR_SCALE;
  //   return selectColor;
  // } else if (selected == HIGHLIGHT) {
  //   // hover \u9AD8\u4EAE\u72B6\u6001
    vec4 highLightColor = u_HighlightColor * COLOR_SCALE;

    float highLightAlpha = highLightColor.a;
    float highLightRatio = highLightAlpha / (highLightAlpha + color.a * (1.0 - highLightAlpha));

    vec3 resultRGB = mix(color.rgb, highLightColor.rgb, highLightRatio);
    return vec4(mix(resultRGB * weight, color.rgb, u_activeMix), color.a);
  } else {
    return color;
  }
}

/*
 * Returns picking color if picking enabled else unmodified argument.
 */
vec4 filterPickingColor(vec4 color) {
  vec3 pickingColor = v_PickingResult.rgb;
  if (u_PickingStage == PICKING_ENCODE && length(pickingColor) < 0.001) {
    discard;
  }
  return u_PickingStage == PICKING_ENCODE ? vec4(pickingColor, step(0.001,color.a)): color;
}

/*
 * Returns picking color if picking is enabled if not
 * highlight color if this item is selected, otherwise unmodified argument.
 */
vec4 filterColor(vec4 color) {
  // \u8FC7\u6EE4\u591A\u4F59\u7684 shader \u8BA1\u7B97
  // return color;
  if(u_shaderPick < 0.5) {
    return color; // \u6682\u65F6\u53BB\u9664 \u76F4\u63A5\u53D6\u6D88\u8BA1\u7B97\u5728\u9009\u4E2D\u65F6\u62D6\u62FD\u5730\u56FE\u4F1A\u6709\u95EE\u9898
  } else {
    return filterPickingColor(filterHighlightColor(color, 1.0));
  }
  
}

vec4 filterColorAlpha(vec4 color, float alpha) {
  // \u8FC7\u6EE4\u591A\u4F59\u7684 shader \u8BA1\u7B97
  // return color;
  if(u_shaderPick < 0.5) {
    return color; // \u6682\u65F6\u53BB\u9664 \u76F4\u63A5\u53D6\u6D88\u8BA1\u7B97\u5728\u9009\u4E2D\u65F6\u62D6\u62FD\u5730\u56FE\u4F1A\u6709\u95EE\u9898
  } else {
    return filterPickingColor(filterHighlightColor(color, alpha));
  }
}

`,Rx=`attribute vec3 a_PickingColor;
varying vec4 v_PickingResult;

uniform vec3 u_PickingColor : [0, 0, 0];
uniform vec3 u_CurrentSelectedId : [0, 0, 0];
uniform vec4 u_HighlightColor : [0, 0, 0, 0];
uniform vec4 u_SelectColor : [0, 0, 0, 0];
uniform float u_PickingStage : 0.0;
uniform float u_PickingThreshold : 1.0;
uniform float u_PickingBuffer: 0.0;
uniform float u_shaderPick;
uniform float u_EnableSelect: 0.0;

#define PICKING_NONE 0.0
#define PICKING_ENCODE 1.0
#define PICKING_HIGHLIGHT 2.0
#define COLOR_SCALE 1. / 255.

#define NORMAL 0.0
#define HIGHLIGHT 1.0
#define SELECT 2.0

bool isVertexPicked(vec3 vertexColor) {
  return
    abs(vertexColor.r - u_PickingColor.r) < u_PickingThreshold &&
    abs(vertexColor.g - u_PickingColor.g) < u_PickingThreshold &&
    abs(vertexColor.b - u_PickingColor.b) < u_PickingThreshold;
}

// \u5224\u65AD\u5F53\u524D\u70B9\u662F\u5426\u5DF2\u7ECF\u88AB select \u9009\u4E2D
bool isVertexSelected(vec3 vertexColor) {
  return
    abs(vertexColor.r - u_CurrentSelectedId.r) < u_PickingThreshold &&
    abs(vertexColor.g - u_CurrentSelectedId.g) < u_PickingThreshold &&
    abs(vertexColor.b - u_CurrentSelectedId.b) < u_PickingThreshold;
}

void setPickingColor(vec3 pickingColor) {
  if(u_shaderPick < 0.5) {
    return;
  }
  // compares only in highlight stage

  v_PickingResult.a = float((u_PickingStage == PICKING_HIGHLIGHT) && isVertexPicked(pickingColor));

  // if (u_EnableSelect == 1.0 && u_PickingStage == PICKING_HIGHLIGHT && isVertexSelected(pickingColor)) {
  //   // \u9009\u4E2D\u6001
  //   v_PickingResult.a = SELECT;
  // } else if (u_PickingStage == PICKING_HIGHLIGHT && isVertexPicked(pickingColor)) {
  //   // \u9AD8\u4EAE\u6001
  //   v_PickingResult.a = HIGHLIGHT;
  // } else {
  //   v_PickingResult.a = NORMAL;
  // }

  // Stores the picking color so that the fragment shader can render it during picking
  v_PickingResult.rgb = pickingColor * COLOR_SCALE;
}

float setPickingSize(float x) {
   return u_PickingStage == PICKING_ENCODE ? x + u_PickingBuffer : x;
}

float setPickingOrder(float z) {
   bool selected = bool(v_PickingResult.a);
   return selected ? z + 1. : 0.;
}
`,Dx=`
#define E 2.718281828459045
vec2 ProjectFlat(vec2 lnglat){
  float maxs=85.0511287798;
  float lat=max(min(maxs,lnglat.y),-maxs);
  float scale= 268435456.;
  float d=PI/180.;
  float x=lnglat.x*d;
  float y=lat*d;
  y=log(tan((PI/4.)+(y/2.)));

  float a=.5/PI,
  b=.5,
  c=-.5/PI;
  d=.5;
  x=scale*(a*x+b);
  y=scale*(c*y+d);
  return vec2(x,y);
}

vec2 unProjectFlat(vec2 px){
  float a=.5/PI;
  float b=.5;
  float c=-.5/PI;
  float d=.5;
  float scale = 268435456.;
  float x=(px.x/scale-b)/a;
  float y=(px.y/scale-d)/c;
  y=(atan(pow(E,y))-(PI/4.))*2.;
  d=PI/180.;
  float lat=y/d;
  float lng=x/d;
  return vec2(lng,lat);
}

float pixelDistance(vec2 from, vec2 to) {
 vec2 a1 = ProjectFlat(from);
 vec2 b1 = ProjectFlat(to);
 return distance(a1, b1);
}

// gaode2.0
vec2 customProject(vec2 lnglat) { // \u7ECF\u7EAC\u5EA6 => \u5E73\u9762\u5750\u6807
  float t = lnglat.x;
  float e = lnglat.y;
  float Sm = 180.0 / PI;
  float Tm = 6378137.0;
  float Rm = PI / 180.0;
  float r = 85.0511287798;
  e = max(min(r, e), -r);
  t *= Rm;
  e *= Rm;
  e = log(tan(PI / 4.0 + e / 2.0));
  return vec2(t * Tm, e * Tm);
}

vec2 unProjCustomCoord(vec2 point) { // \u5E73\u9762\u5750\u6807 => \u7ECF\u7EAC\u5EA6
  float Sm = 57.29577951308232; //180 / Math.PI
  float Tm = 6378137.0;
  float t = point.x;
  float e = point.y;
  return vec2(t / Tm * Sm, (2.0 * atan(exp(e / Tm)) - PI / 2.0) * Sm);
}


float customPixelDistance(vec2 from, vec2 to) {
 vec2 a1 = ProjectFlat(from);
 vec2 b1 = ProjectFlat(to);
 return distance(a1, b1);
}`,kx=`#define TILE_SIZE 512.0
#define PI 3.1415926536
#define WORLD_SCALE TILE_SIZE / (PI * 2.0)

#define COORDINATE_SYSTEM_LNGLAT 1.0        // mapbox
#define COORDINATE_SYSTEM_LNGLAT_OFFSET 2.0 // mapbox offset
#define COORDINATE_SYSTEM_VECTOR_TILE 3.0
#define COORDINATE_SYSTEM_IDENTITY 4.0
#define COORDINATE_SYSTEM_P20 5.0           // amap
#define COORDINATE_SYSTEM_P20_OFFSET 6.0    // amap offset
#define COORDINATE_SYSTEM_METER_OFFSET 7.0

#define COORDINATE_SYSTEM_P20_2 8.0         // amap2.0

uniform mat4 u_ViewMatrix;
uniform mat4 u_ProjectionMatrix;
uniform mat4 u_ViewProjectionMatrix;
uniform float u_Zoom : 1;
uniform float u_ZoomScale : 1;

uniform float u_CoordinateSystem;
uniform vec2 u_ViewportCenter;
uniform vec4 u_ViewportCenterProjection;
uniform vec3 u_PixelsPerDegree;
uniform vec3 u_PixelsPerDegree2;
uniform vec3 u_PixelsPerMeter;

uniform vec2 u_ViewportSize;
uniform float u_DevicePixelRatio;
uniform float u_FocalDistance;
uniform vec3 u_CameraPosition;
uniform mat4 u_Mvp;

// web mercator coords -> world coords
vec2 project_mercator(vec2 lnglat) {
   if (u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.0
    return lnglat;
  }
  float x = lnglat.x;
  return vec2(
    radians(x) + PI,
    PI - log(tan(PI * 0.25 + radians(lnglat.y) * 0.5))
  );
}

float project_scale(float meters) {
  return meters * u_PixelsPerMeter.z;
}


// offset coords -> world coords
vec4 project_offset(vec4 offset) {
  float dy = offset.y;
  dy = clamp(dy, -1., 1.);
  vec3 pixels_per_unit = u_PixelsPerDegree + u_PixelsPerDegree2 * dy;
  return vec4(offset.xyz * pixels_per_unit, offset.w);
}

vec3 project_normal(vec3 normal) {
  vec4 normal_modelspace = u_ModelMatrix * vec4(normal, 0.0);
  return normalize(normal_modelspace.xyz * u_PixelsPerMeter);
}

vec3 project_offset_normal(vec3 vector) {
  if (u_CoordinateSystem < COORDINATE_SYSTEM_LNGLAT + 0.01 && u_CoordinateSystem >COORDINATE_SYSTEM_LNGLAT - 0.01
    || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
    // normals generated by the polygon tesselator are in lnglat offsets instead of meters
    return normalize(vector * u_PixelsPerDegree);
  }
  return project_normal(vector);
}
// || u_CoordinateSystem < COORDINATE_SYSTEM_P20_OFFSET + 0.01 && u_CoordinateSystem >COORDINATE_SYSTEM_P20_OFFSET - 0.01
// reverse Y
vec3 reverse_offset_normal(vec3 vector) {
  if (u_CoordinateSystem == COORDINATE_SYSTEM_P20 ||u_CoordinateSystem == COORDINATE_SYSTEM_P20_OFFSET ) {
    return vector * vec3(1.0, -1.0, 1.0);
  }

  if (u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.0
    return vector;
  }
  return vector;
}

vec4 project_mvt_offset_position(vec4 position) {
  float a = COORDINATE_SYSTEM_LNGLAT_OFFSET;
  float b = COORDINATE_SYSTEM_P20_OFFSET;
  float c = COORDINATE_SYSTEM_LNGLAT;
  if (u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET || u_CoordinateSystem == COORDINATE_SYSTEM_P20_OFFSET) {
    return project_offset(vec4(0.0, 0.0, position.z, position.w));
  }
  if (u_CoordinateSystem < COORDINATE_SYSTEM_LNGLAT + 0.01 && u_CoordinateSystem >COORDINATE_SYSTEM_LNGLAT - 0.01) {
    return vec4(
      project_mercator(position.xy) * WORLD_SCALE * u_ZoomScale,
      project_scale(position.z),
      position.w
    );
  }
  return position;
}

vec4 project_position(vec4 position) {
  float a = COORDINATE_SYSTEM_LNGLAT_OFFSET;
  float b = COORDINATE_SYSTEM_P20_OFFSET;
  float c = COORDINATE_SYSTEM_LNGLAT;
  if (u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET
    || u_CoordinateSystem == COORDINATE_SYSTEM_P20_OFFSET) {
    float X = position.x - u_ViewportCenter.x;
    float Y = position.y - u_ViewportCenter.y;
    return project_offset(vec4(X, Y, position.z, position.w));
  }
  if (u_CoordinateSystem < COORDINATE_SYSTEM_LNGLAT + 0.01 && u_CoordinateSystem >COORDINATE_SYSTEM_LNGLAT - 0.01) {
    return vec4(
      project_mercator(position.xy) * WORLD_SCALE * u_ZoomScale,
      project_scale(position.z),
      position.w
    );
  }
  if (u_CoordinateSystem == COORDINATE_SYSTEM_P20) {
    return vec4(
      (project_mercator(position.xy) * WORLD_SCALE * u_ZoomScale - vec2(215440491., 106744817.)) * vec2(1., -1.),
      project_scale(position.z),
      position.w
    );
  }

  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) {
   return position;
  }
  return position;

  // TODO: \u74E6\u7247\u5750\u6807\u7CFB & \u5E38\u89C4\u4E16\u754C\u5750\u6807\u7CFB
}
vec2 project_pixel_size_to_clipspace(vec2 pixels) {
  vec2 offset = pixels / u_ViewportSize * u_DevicePixelRatio * 2.0;
  return offset * u_FocalDistance;
}



float project_pixel_allmap(float pixel) {
  if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {
    return pixel * pow(2.0, u_Zoom);
  }
  return pixel * u_FocalDistance ;
}

// \u9002\u914D\u7EB9\u7406\u8D34\u56FE\u7684\u7B49\u50CF\u7D20\u5927\u5C0F
float project_pixel_texture(float pixel) {
  // mapbox zoom > 12
  if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
    return pixel * pow(0.5, u_Zoom) * u_FocalDistance ;
  }

  // amap2 zoom > 12
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) {
    return pixel * pow(2.0, (19.0 - 3.0 - u_Zoom))* u_FocalDistance ;
  }

  // amap zoom > 12
  if (u_CoordinateSystem == COORDINATE_SYSTEM_P20_OFFSET) {
    return pixel * pow(0.5, u_Zoom)* u_FocalDistance ;
  }
  
  // amap zoom < 12
  if (u_CoordinateSystem == COORDINATE_SYSTEM_P20) {
    return pixel * pow(2.0, (20.0 - u_Zoom))* u_FocalDistance ;
  }
  return pixel * 2.0 *  u_FocalDistance;;
}

// \u5728\u4E0D\u8BBA\u4EC0\u4E48\u5E95\u56FE\u4E0B\u9700\u8981\u7EDF\u4E00\u5904\u7406\u7684\u65F6\u5019\u4F7F\u7528
float project_float_pixel(float pixel) {
  if (u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
    // mapbox P20 \u5750\u6807\u7CFB\u4E0B\uFF0C\u4E3A\u4E86\u548C Web \u58A8\u5361\u6258\u5750\u6807\u7CFB\u7EDF\u4E00\uFF0Czoom \u9ED8\u8BA4\u51CF1
    return pixel * pow(2.0, (19.0 - u_Zoom))  * u_FocalDistance ;
  }
  if (u_CoordinateSystem == COORDINATE_SYSTEM_P20 || u_CoordinateSystem == COORDINATE_SYSTEM_P20_OFFSET) {
    // amap P20 \u5750\u6807\u7CFB\u4E0B\uFF0C\u4E3A\u4E86\u548C Web \u58A8\u5361\u6258\u5750\u6807\u7CFB\u7EDF\u4E00\uFF0Czoom \u9ED8\u8BA4\u51CF1
    return pixel * pow(2.0, (19.0 - u_Zoom));
  }
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) {
    // amap2 P20_2 \u5750\u6807\u7CFB\u4E0B\uFF0C\u4E3A\u4E86\u548C Web \u58A8\u5361\u6258\u5750\u6807\u7CFB\u7EDF\u4E00\uFF0Czoom \u9ED8\u8BA4\u51CF3
    return pixel * pow(2.0, (19.0 - 3.0 - u_Zoom))* u_FocalDistance ;
  }
  return pixel * u_FocalDistance;
}

float project_pixel(float pixel) {
  if (u_CoordinateSystem == COORDINATE_SYSTEM_P20 || u_CoordinateSystem == COORDINATE_SYSTEM_P20_OFFSET) {
    // amap P20 \u5750\u6807\u7CFB\u4E0B\uFF0C\u4E3A\u4E86\u548C Web \u58A8\u5361\u6258\u5750\u6807\u7CFB\u7EDF\u4E00\uFF0Czoom \u9ED8\u8BA4\u51CF1
    return pixel * pow(2.0, (19.0 - u_Zoom)) * u_FocalDistance ;
  }
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) {
    // amap2 P20_2 \u5750\u6807\u7CFB\u4E0B\uFF0C\u4E3A\u4E86\u548C Web \u58A8\u5361\u6258\u5750\u6807\u7CFB\u7EDF\u4E00\uFF0Czoom \u9ED8\u8BA4\u51CF3
    return pixel * pow(2.0, (19.0 - 3.0 - u_Zoom)) * u_FocalDistance ;
  }
  return pixel * u_FocalDistance;
}
vec2 project_pixel(vec2 pixel) {
  if (u_CoordinateSystem == COORDINATE_SYSTEM_P20 || u_CoordinateSystem == COORDINATE_SYSTEM_P20_OFFSET) {
    // P20 \u5750\u6807\u7CFB\u4E0B\uFF0C\u4E3A\u4E86\u548C Web \u58A8\u5361\u6258\u5750\u6807\u7CFB\u7EDF\u4E00\uFF0Czoom \u9ED8\u8BA4\u51CF1
    return pixel * pow(2.0, (19.0 - u_Zoom)) * u_FocalDistance ;
  }
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) {
    // P20_2 \u5750\u6807\u7CFB\u4E0B\uFF0C\u4E3A\u4E86\u548C Web \u58A8\u5361\u6258\u5750\u6807\u7CFB\u7EDF\u4E00\uFF0Czoom \u9ED8\u8BA4\u51CF3
    return pixel * pow(2.0, (19.0 - 3.0 - u_Zoom)) * u_FocalDistance ;
  }
  return pixel * -1. * u_FocalDistance;
}
vec3 project_pixel(vec3 pixel) {
  if (u_CoordinateSystem == COORDINATE_SYSTEM_P20 || u_CoordinateSystem == COORDINATE_SYSTEM_P20_OFFSET) {
    // P20 \u5750\u6807\u7CFB\u4E0B\uFF0C\u4E3A\u4E86\u548C Web \u58A8\u5361\u6258\u5750\u6807\u7CFB\u7EDF\u4E00\uFF0Czoom \u9ED8\u8BA4\u51CF1
    return pixel * pow(2.0, (19.0 - u_Zoom)) *  u_FocalDistance ;
  }
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) {
    // P20_2 \u5750\u6807\u7CFB\u4E0B\uFF0C\u4E3A\u4E86\u548C Web \u58A8\u5361\u6258\u5750\u6807\u7CFB\u7EDF\u4E00\uFF0Czoom \u9ED8\u8BA4\u51CF3
    return pixel * pow(2.0, (19.0 - 3.0 - u_Zoom))  * u_FocalDistance ;
  }
  return pixel * -1. * u_FocalDistance;
}

vec4 project_common_position_to_clipspace(vec4 position, mat4 viewProjectionMatrix, vec4 center) {
  if (u_CoordinateSystem == COORDINATE_SYSTEM_METER_OFFSET ||
    u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
    // Needs to be divided with project_uCommonUnitsPerMeter
    position.w *= u_PixelsPerMeter.z;
  }

  return viewProjectionMatrix * position + center;
}

// Projects from common space coordinates to clip space
vec4 project_common_position_to_clipspace(vec4 position) {
  return project_common_position_to_clipspace(
    position,
    u_ViewProjectionMatrix,
    u_ViewportCenterProjection
  );
}

vec4 unproject_clipspace_to_position(vec4 clipspacePos, mat4 u_InverseViewProjectionMatrix) {
  vec4 pos = u_InverseViewProjectionMatrix * (clipspacePos - u_ViewportCenterProjection);

  if (u_CoordinateSystem == COORDINATE_SYSTEM_METER_OFFSET ||
    u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
    // Needs to be divided with project_uCommonUnitsPerMeter
     pos.w = pos.w / u_PixelsPerMeter.z;
  }
  return pos;
}


bool isEqual( float a,  float b) {
    return  a< b + 0.001 && a > b - 0.001;
}

// \u652F\u6301 GaodeV2\u3001Mapbox
vec4 project_common_position_to_clipspace_v2(vec4 position) {
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    return u_Mvp * position;
  } else {
    return project_common_position_to_clipspace(position);
  }
}`,Nx=`vec2 rotate_matrix(vec2 v, float a) {
    float b = a / 180.0 * 3.1415926535897932384626433832795;
    float s = sin(b);
    float c = cos(b);
    mat2 m = mat2(c, s, -s, c);
    return m * v;
}`,Fx=`/**
 * 2D signed distance field functions
 * @see http://www.iquilezles.org/www/articles/distfunctions2d/distfunctions2d.htm
 */

float ndot(vec2 a, vec2 b ) { return a.x*b.x - a.y*b.y; }

float sdCircle(vec2 p, float r) {
  return length(p) - r;
}

float sdEquilateralTriangle(vec2 p) {
  float k = sqrt(3.0);
  p.x = abs(p.x) - 1.0;
  p.y = p.y + 1.0/k;
  if( p.x + k*p.y > 0.0 ) p = vec2(p.x-k*p.y,-k*p.x-p.y)/2.0;
  p.x -= clamp( p.x, -2.0, 0.0 );
  return -length(p)*sign(p.y);
}

float sdBox(vec2 p, vec2 b) {
  vec2 d = abs(p)-b;
  return length(max(d,vec2(0))) + min(max(d.x,d.y),0.0);
}

float sdPentagon(vec2 p, float r) {
  vec3 k = vec3(0.809016994,0.587785252,0.726542528);
  p.x = abs(p.x);
  p -= 2.0*min(dot(vec2(-k.x,k.y),p),0.0)*vec2(-k.x,k.y);
  p -= 2.0*min(dot(vec2( k.x,k.y),p),0.0)*vec2( k.x,k.y);
  p -= vec2(clamp(p.x,-r*k.z,r*k.z),r);
  return length(p)*sign(p.y);
}

float sdHexagon(vec2 p, float r) {
  vec3 k = vec3(-0.866025404,0.5,0.577350269);
  p = abs(p);
  p -= 2.0*min(dot(k.xy,p),0.0)*k.xy;
  p -= vec2(clamp(p.x, -k.z*r, k.z*r), r);
  return length(p)*sign(p.y);
}

float sdOctogon(vec2 p, float r) {
  vec3 k = vec3(-0.9238795325, 0.3826834323, 0.4142135623 );
  p = abs(p);
  p -= 2.0*min(dot(vec2( k.x,k.y),p),0.0)*vec2( k.x,k.y);
  p -= 2.0*min(dot(vec2(-k.x,k.y),p),0.0)*vec2(-k.x,k.y);
  p -= vec2(clamp(p.x, -k.z*r, k.z*r), r);
  return length(p)*sign(p.y);
}

float sdHexagram(vec2 p, float r) {
  vec4 k=vec4(-0.5,0.8660254038,0.5773502692,1.7320508076);
  p = abs(p);
  p -= 2.0*min(dot(k.xy,p),0.0)*k.xy;
  p -= 2.0*min(dot(k.yx,p),0.0)*k.yx;
  p -= vec2(clamp(p.x,r*k.z,r*k.w),r);
  return length(p)*sign(p.y);
}

float sdRhombus(vec2 p, vec2 b) {
  vec2 q = abs(p);
  float h = clamp((-2.0*ndot(q,b)+ndot(b,b))/dot(b,b),-1.0,1.0);
  float d = length( q - 0.5*b*vec2(1.0-h,1.0+h) );
  return d * sign( q.x*b.y + q.y*b.x - b.x*b.y );
}

float sdVesica(vec2 p, float r, float d) {
  p = abs(p);
  float b = sqrt(r*r-d*d); // can delay this sqrt
  return ((p.y-b)*d>p.x*b)
          ? length(p-vec2(0.0,b))
          : length(p-vec2(-d,0.0))-r;
}
`,Bx=/precision\s+(high|low|medium)p\s+float/,Zx=`#ifdef GL_FRAGMENT_PRECISION_HIGH
 precision highp float;
 #else
 precision mediump float;
#endif
`,zx=/#pragma include (["^+"]?["[a-zA-Z_0-9](.*)"]*?)/g,Ux=/void\s+main\s*\([^)]*\)\s*\{\n?/,fP=/}\n?[^{}]*$/,Gx=(Kh=(0,vr.b2)(),Kh(R0=function(){function e(){(0,se.Z)(this,e),(0,Me.Z)(this,"moduleCache",{}),(0,Me.Z)(this,"rawContentCache",{})}return(0,be.Z)(e,[{key:"registerBuiltinModules",value:function(){this.destroy(),this.registerModule("common",{vs:hh,fs:hh}),this.registerModule("decode",{vs:Wv,fs:""}),this.registerModule("projection",{vs:kx,fs:""}),this.registerModule("project",{vs:Dx,fs:""}),this.registerModule("sdf_2d",{vs:"",fs:Fx}),this.registerModule("lighting",{vs:Qv,fs:""}),this.registerModule("light",{vs:Xv,fs:""}),this.registerModule("picking",{vs:Rx,fs:qv}),this.registerModule("rotation_2d",{vs:Nx,fs:""})}},{key:"registerModule",value:function(t,n){var r=n.vs,a=n.fs,u=n.uniforms,c=n.inject,g=Ql(r),x=g.content,M=g.uniforms,O=Ql(a),B=O.content,W=O.uniforms;this.rawContentCache[t]={fs:B,inject:c,uniforms:(0,X.Z)((0,X.Z)((0,X.Z)({},M),W),u),vs:x}}},{key:"destroy",value:function(){this.moduleCache={},this.rawContentCache={}}},{key:"getModule",value:function(t){var n=this,r=this.rawContentCache[t].vs,a=this.rawContentCache[t].fs,u=this.rawContentCache[t].inject,c={};u!=null&&u["vs:#decl"]&&(r=(u==null?void 0:u["vs:#decl"])+r,c=Ql(u==null?void 0:u["vs:#decl"]).uniforms),u!=null&&u["vs:#main-start"]&&(r=r.replace(Ux,function(Te){return Te+(u==null?void 0:u["vs:#main-start"])}));var g=this.processModule(r,[],"vs"),x=g.content,M=g.includeList,O=this.processModule(a,[],"fs"),B=O.content,W=O.includeList,ce="",oe=Jh(M.concat(W).concat(t)).reduce(function(Te,Ze){return(0,X.Z)((0,X.Z)({},Te),n.rawContentCache[Ze].uniforms)},(0,X.Z)({},c));return Bx.test(B)||(ce=ce+Zx),ce=ce+B,this.moduleCache[t]={fs:ce.trim(),uniforms:oe,vs:x.trim()},this.moduleCache[t]}},{key:"processModule",value:function(t,n,r){var a=this,u=t.replace(zx,function(c,g){var x=g.split(" "),M=x[0].replace(/"/g,"");if(n.indexOf(M)>-1)return"";var O=a.rawContentCache[M][r];n.push(M);var B=a.processModule(O,n,r),W=B.content;return W});return{content:u,includeList:n}}},{key:"injectDefines",value:function(t){var n=Object.keys(t).reduce(function(r,a){return r+"#define ".concat(a.toUpperCase()," ").concat(t[a],`;
`)},`
`);return n}}]),e}())||R0);function jx(e,i){for(;!Object.prototype.hasOwnProperty.call(e,i)&&(e=(0,ue.Z)(e),e!==null););return e}function D0(){return typeof Reflect!="undefined"&&Reflect.get?D0=Reflect.get.bind():D0=function(i,t,n){var r=jx(i,t);if(r){var a=Object.getOwnPropertyDescriptor(r,t);return a.get?a.get.call(arguments.length<3?i:n):a.value}},D0.apply(this,arguments)}var eA=function(e){return e.Normal="normal",e.PostProcessing="post-processing",e}({}),bm,Sm,Md=(bm=(0,vr.b2)(),bm(Sm=function(){function e(){(0,se.Z)(this,e),(0,Me.Z)(this,"shaderModuleService",void 0),(0,Me.Z)(this,"rendererService",void 0),(0,Me.Z)(this,"cameraService",void 0),(0,Me.Z)(this,"mapService",void 0),(0,Me.Z)(this,"interactionService",void 0),(0,Me.Z)(this,"layerService",void 0),(0,Me.Z)(this,"config",void 0)}return(0,be.Z)(e,[{key:"getName",value:function(){return""}},{key:"getType",value:function(){return eA.Normal}},{key:"init",value:function(t,n){this.config=n,this.rendererService=t.getContainer().get(Xt.IRendererService),this.cameraService=t.getContainer().get(Xt.ICameraService),this.mapService=t.getContainer().get(Xt.IMapService),this.interactionService=t.getContainer().get(Xt.IInteractionService),this.layerService=t.getContainer().get(Xt.ILayerService),this.shaderModuleService=t.getContainer().get(Xt.IShaderModuleService)}},{key:"render",value:function(t){}}]),e}())||Sm),Cm,wm;function Vx(e){var i=Hx();return function(){var n=(0,ue.Z)(e),r;if(i){var a=(0,ue.Z)(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return(0,ze.Z)(this,r)}}function Hx(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var $x=(Cm=(0,vr.b2)(),Cm(wm=function(e){(0,Ne.Z)(t,e);var i=Vx(t);function t(){return(0,se.Z)(this,t),i.apply(this,arguments)}return(0,be.Z)(t,[{key:"getName",value:function(){return"clear"}},{key:"init",value:function(r,a){D0((0,ue.Z)(t.prototype),"init",this).call(this,r,a)}},{key:"render",value:function(){this.rendererService.clear({color:[0,0,0,0],depth:1,framebuffer:null})}}]),t}(Md))||wm),Tm,Mm,Im,Kv,Pm;function Yx(e,i){var t=typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=Wx(e))||i&&e&&typeof e.length=="number"){t&&(e=t);var n=0,r=function(){};return{s:r,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(x){throw x},f:r}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var a=!0,u=!1,c;return{s:function(){t=t.call(e)},n:function(){var x=t.next();return a=x.done,x},e:function(x){u=!0,c=x},f:function(){try{!a&&t.return!=null&&t.return()}finally{if(u)throw c}}}}function Wx(e,i){if(e){if(typeof e=="string")return Lm(e,i);var t=Object.prototype.toString.call(e).slice(8,-1);if(t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set")return Array.from(e);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return Lm(e,i)}}function Lm(e,i){(i==null||i>e.length)&&(i=e.length);for(var t=0,n=new Array(i);t<i;t++)n[t]=e[t];return n}var Xx=(Tm=(0,vr.b2)(),Mm=(0,vr.f3)(Xt.IPostProcessor),Tm(Im=(Kv=function(){function e(){(0,se.Z)(this,e),(0,Me.Z)(this,"passes",[]),Ki(this,"postProcessor",Pm,this),(0,Me.Z)(this,"layer",void 0),(0,Me.Z)(this,"renderFlag",void 0),(0,Me.Z)(this,"width",0),(0,Me.Z)(this,"height",0)}return(0,be.Z)(e,[{key:"setLayer",value:function(t){this.layer=t}},{key:"setRenderFlag",value:function(t){this.renderFlag=t}},{key:"getRenderFlag",value:function(){return this.renderFlag}},{key:"getPostProcessor",value:function(){return this.postProcessor}},{key:"render",value:function(){var i=(0,ur.Z)(it().mark(function n(){var r,a,u;return it().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:r=Yx(this.passes),g.prev=1,r.s();case 3:if((a=r.n()).done){g.next=9;break}return u=a.value,g.next=7,u.render(this.layer);case 7:g.next=3;break;case 9:g.next=14;break;case 11:g.prev=11,g.t0=g.catch(1),r.e(g.t0);case 14:return g.prev=14,r.f(),g.finish(14);case 17:return g.next=19,this.postProcessor.render(this.layer);case 19:case"end":return g.stop()}},n,this,[[1,11,14,17]])}));function t(){return i.apply(this,arguments)}return t}()},{key:"resize",value:function(t,n){(this.width!==t||this.height!==n)&&(this.postProcessor.resize(t,n),this.width=t,this.height=n)}},{key:"add",value:function(t,n){t.getType()===eA.PostProcessing?this.postProcessor.add(t,this.layer,n):(t.init(this.layer,n),this.passes.push(t))}},{key:"insert",value:function(t,n,r){t.init(this.layer,n),this.passes.splice(r,0,t)}},{key:"destroy",value:function(){this.passes.length=0}}]),e}(),Pm=Hi(Kv.prototype,"postProcessor",[Mm],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Kv))||Im),Om,Rm;function Qx(e){var i=qx();return function(){var n=(0,ue.Z)(e),r;if(i){var a=(0,ue.Z)(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return(0,ze.Z)(this,r)}}function qx(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var Kx=(Om=(0,vr.b2)(),Om(Rm=function(e){(0,Ne.Z)(t,e);var i=Qx(t);function t(){var n;(0,se.Z)(this,t);for(var r=arguments.length,a=new Array(r),u=0;u<r;u++)a[u]=arguments[u];return n=i.call.apply(i,[this].concat(a)),(0,Me.Z)((0,xt.Z)(n),"pickingFBO",void 0),(0,Me.Z)((0,xt.Z)(n),"layer",void 0),(0,Me.Z)((0,xt.Z)(n),"width",0),(0,Me.Z)((0,xt.Z)(n),"height",0),(0,Me.Z)((0,xt.Z)(n),"alreadyInRendering",!1),(0,Me.Z)((0,xt.Z)(n),"pickFromPickingFBO",function(c){var g=c.x,x=c.y,M=c.lngLat,O=c.type;if(!(!n.layer.isVisible()||!n.layer.needPick(O))){var B=n.rendererService,W=B.getViewportSize,ce=B.readPixels,oe=B.useFramebuffer,Te=W(),Ze=Te.width,qe=Te.height,et=n.layer.getLayerConfig(),yt=et.enableHighlight,bt=et.enableSelect,Ot=g*fa,jt=x*fa;if(!(Ot>Ze||Ot<0||jt>qe||jt<0)){var or;oe(n.pickingFBO,function(){var ar;if(or=ce({x:Math.round(Ot),y:Math.round(qe-(x+1)*fa),width:1,height:1,data:new Uint8Array(1*1*4),framebuffer:n.pickingFBO}),or[0]!==0||or[1]!==0||or[2]!==0){var Sr=io(or),dr=n.layer.getSource().getFeatureById(Sr),jr={x:g,y:x,type:O,lngLat:M,featureId:Sr,feature:dr};dr&&(n.layer.setCurrentPickId(Sr),n.triggerHoverOnLayer(jr))}else{var nn={x:g,y:x,lngLat:M,type:n.layer.getCurrentPickId()===null?"un"+O:"mouseout",featureId:null,feature:null};n.triggerHoverOnLayer((0,X.Z)((0,X.Z)({},nn),{},{type:"unpick"})),n.triggerHoverOnLayer(nn),n.layer.setCurrentPickId(null)}yt&&n.highlightPickedFeature(or),bt&&O==="click"&&((ar=or)===null||ar===void 0?void 0:ar.toString())!==[0,0,0,0].toString()&&n.selectFeature(or)})}}}),n}return(0,be.Z)(t,[{key:"getType",value:function(){return eA.Normal}},{key:"getName",value:function(){return"pixelPicking"}},{key:"init",value:function(r,a){D0((0,ue.Z)(t.prototype),"init",this).call(this,r,a),this.layer=r;var u=this.rendererService,c=u.createTexture2D,g=u.createFramebuffer,x=u.getViewportSize,M=x(),O=M.width,B=M.height;this.pickingFBO=g({color:c({width:O,height:B,wrapS:je.CLAMP_TO_EDGE,wrapT:je.CLAMP_TO_EDGE})}),this.interactionService.on($u.Hover,this.pickFromPickingFBO),this.interactionService.on($u.Select,this.selectFeatureHandle.bind(this)),this.interactionService.on($u.Active,this.highlightFeatureHandle.bind(this))}},{key:"render",value:function(r){var a=this;if(!this.alreadyInRendering){var u=this.rendererService,c=u.getViewportSize,g=u.useFramebuffer,x=u.clear,M=c(),O=M.width,B=M.height;this.alreadyInRendering=!0,(this.width!==O||this.height!==B)&&(this.pickingFBO.resize({width:O,height:B}),this.width=O,this.height=B),g(this.pickingFBO,function(){x({framebuffer:a.pickingFBO,color:[0,0,0,0],stencil:0,depth:1});var W=a.layer.multiPassRenderer.getRenderFlag();a.layer.multiPassRenderer.setRenderFlag(!1),r.hooks.beforePickingEncode.call(),r.render(),r.hooks.afterPickingEncode.call(),a.layer.multiPassRenderer.setRenderFlag(W),a.alreadyInRendering=!1})}}},{key:"triggerHoverOnLayer",value:function(r){this.layer.emit(r.type,r)}},{key:"highlightPickedFeature",value:function(r){var a=(0,vn.Z)(r,3),u=a[0],c=a[1],g=a[2];this.layer.hooks.beforeHighlight.call([u,c,g]),this.layerService.renderLayers()}},{key:"selectFeature",value:function(r){var a=(0,vn.Z)(r,3),u=a[0],c=a[1],g=a[2];this.layer.hooks.beforeSelect.call([u,c,g]),this.layerService.renderLayers()}},{key:"selectFeatureHandle",value:function(r){var a=r.featureId,u=bs(a);this.selectFeature(new Uint8Array(u))}},{key:"highlightFeatureHandle",value:function(r){var a=r.featureId,u=bs(a);this.highlightPickedFeature(new Uint8Array(u))}}]),t}(Md))||Rm),Dm,km,Nm,Jv,Fm,Jx=In.camelCase,eE=In.isNil,tE=In.upperFirst,rE=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,t0=(Dm=(0,vr.b2)(),km=(0,vr.f3)(Xt.IShaderModuleService),Dm(Nm=(Jv=function(){function e(){(0,se.Z)(this,e),Ki(this,"shaderModuleService",Fm,this),(0,Me.Z)(this,"rendererService",void 0),(0,Me.Z)(this,"config",void 0),(0,Me.Z)(this,"quad",rE),(0,Me.Z)(this,"enabled",!0),(0,Me.Z)(this,"renderToScreen",!1),(0,Me.Z)(this,"model",void 0),(0,Me.Z)(this,"name",void 0),(0,Me.Z)(this,"optionsToUpdate",{})}return(0,be.Z)(e,[{key:"getName",value:function(){return this.name}},{key:"setName",value:function(t){this.name=t}},{key:"getType",value:function(){return eA.PostProcessing}},{key:"init",value:function(t,n){this.config=n,this.rendererService=t.getContainer().get(Xt.IRendererService),this.shaderModuleService=t.getContainer().get(Xt.IShaderModuleService);var r=this.rendererService,a=r.createAttribute,u=r.createBuffer,c=r.createModel,g=this.setupShaders(),x=g.vs,M=g.fs,O=g.uniforms;this.model=c({vs:x,fs:M,attributes:{a_Position:a({buffer:u({data:[-4,-4,4,-4,0,4],type:je.FLOAT}),size:2})},uniforms:(0,X.Z)((0,X.Z)({u_Texture:null},O),this.config&&this.convertOptionsToUniforms(this.config)),depth:{enable:!1},count:3,blend:{enable:this.getName()==="copy"}})}},{key:"render",value:function(t,n){var r=this,a=t.multiPassRenderer.getPostProcessor(),u=this.rendererService,c=u.useFramebuffer,g=u.getViewportSize,x=u.clear,M=g(),O=M.width,B=M.height;c(this.renderToScreen?null:a.getWriteFBO(),function(){x({framebuffer:a.getWriteFBO(),color:[0,0,0,0],depth:1,stencil:0});var W=(0,X.Z)({u_BloomFinal:0,u_Texture:a.getReadFBO(),u_ViewportSize:[O,B]},r.convertOptionsToUniforms(r.optionsToUpdate));n&&(W.u_BloomFinal=1,W.u_Texture2=n),r.model.draw({uniforms:W})})}},{key:"isEnabled",value:function(){return this.enabled}},{key:"setEnabled",value:function(t){this.enabled=t}},{key:"setRenderToScreen",value:function(t){this.renderToScreen=t}},{key:"updateOptions",value:function(t){this.optionsToUpdate=(0,X.Z)((0,X.Z)({},this.optionsToUpdate),t)}},{key:"setupShaders",value:function(){throw new Error("Method not implemented.")}},{key:"convertOptionsToUniforms",value:function(t){var n={};return Object.keys(t).forEach(function(r){eE(t[r])||(n["u_".concat(tE(Jx(r)))]=t[r])}),n}}]),e}(),Fm=Hi(Jv.prototype,"shaderModuleService",[km],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Jv))||Nm),Bm,Zm;function nE(e){var i=iE();return function(){var n=(0,ue.Z)(e),r;if(i){var a=(0,ue.Z)(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return(0,ze.Z)(this,r)}}function iE(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var aE=`varying vec2 v_UV;

uniform float u_BloomFinal: 0.0;
uniform sampler2D u_Texture;
uniform sampler2D u_Texture2;

uniform vec2 u_ViewportSize: [1.0, 1.0];
uniform float u_radius: 5.0;
uniform float u_intensity: 0.3;
uniform float u_baseRadio: 0.5;

// https://github.com/Jam3/glsl-fast-gaussian-blur/blob/master/9.glsl
vec4 blur9(sampler2D image, vec2 uv, vec2 resolution, vec2 direction) {
  vec4 color = vec4(0.0);
  vec2 off1 = vec2(1.3846153846) * direction;
  vec2 off2 = vec2(3.2307692308) * direction;
  color += texture2D(image, uv) * 0.2270270270;
  color += texture2D(image, uv + (off1 / resolution)) * 0.3162162162;
  color += texture2D(image, uv - (off1 / resolution)) * 0.3162162162;
  color += texture2D(image, uv + (off2 / resolution)) * 0.0702702703;
  color += texture2D(image, uv - (off2 / resolution)) * 0.0702702703;
  return color;
}

float luminance(vec4 color) {
  return  0.2125 * color.r + 0.7154 * color.g + 0.0721 * color.b;
}

void main() {
  // vec4 baseColor = texture2D(u_Texture, v_UV);

  float r = sqrt(u_radius);

  vec4 c1 = blur9(u_Texture, v_UV, u_ViewportSize, vec2(u_radius, 0.0));
  // c1 *= luminance(c1);
  vec4 c2 = blur9(u_Texture, v_UV, u_ViewportSize, vec2(0.0, u_radius));
  // c2 *= luminance(c2);
  vec4 c3 = blur9(u_Texture, v_UV, u_ViewportSize, vec2(r, r));
  // c3 *= luminance(c3);
  vec4 c4 = blur9(u_Texture, v_UV, u_ViewportSize, vec2(r, -r));
  // c4 *= luminance(c4);
  vec4 inbloomColor = (c1 + c2 + c3 + c4) * 0.25;

  // float lum = luminance(inbloomColor);
  // inbloomColor.rgb *= lum;

  if(u_BloomFinal > 0.0) {
    vec4 baseColor = texture2D(u_Texture2, v_UV);
    float baselum = luminance(baseColor);
    gl_FragColor = mix(inbloomColor, baseColor, u_baseRadio);
    if(baselum <= 0.2) {
      gl_FragColor = inbloomColor * u_intensity;
    }
  } else {
    gl_FragColor = inbloomColor;
  }
}`,oE=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,eg=In.isNil,sE=(Bm=(0,vr.b2)(),Bm(Zm=function(e){(0,Ne.Z)(t,e);var i=nE(t);function t(){return(0,se.Z)(this,t),i.apply(this,arguments)}return(0,be.Z)(t,[{key:"setupShaders",value:function(){this.shaderModuleService.registerModule("blur-pass",{vs:oE,fs:aE});var r=this.shaderModuleService.getModule("blur-pass"),a=r.vs,u=r.fs,c=r.uniforms,g=this.rendererService.getViewportSize(),x=g.width,M=g.height;return{vs:a,fs:u,uniforms:(0,X.Z)((0,X.Z)({},c),{},{u_ViewportSize:[x,M]})}}},{key:"convertOptionsToUniforms",value:function(r){var a={};return eg(r.bloomRadius)||(a.u_radius=r.bloomRadius),eg(r.bloomIntensity)||(a.u_intensity=r.bloomIntensity),eg(r.bloomBaseRadio)||(a.u_baseRadio=r.bloomBaseRadio),a}}]),t}(t0))||Zm),zm,Um;function uE(e){var i=lE();return function(){var n=(0,ue.Z)(e),r;if(i){var a=(0,ue.Z)(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return(0,ze.Z)(this,r)}}function lE(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var cE=`varying vec2 v_UV;

uniform sampler2D u_Texture;

uniform vec2 u_ViewportSize: [1.0, 1.0];
uniform vec2 u_BlurDir: [1.0, 0.0];

// https://github.com/Jam3/glsl-fast-gaussian-blur/blob/master/9.glsl
vec4 blur9(sampler2D image, vec2 uv, vec2 resolution, vec2 direction) {
  vec4 color = vec4(0.0);
  vec2 off1 = vec2(1.3846153846) * direction;
  vec2 off2 = vec2(3.2307692308) * direction;
  color += texture2D(image, uv) * 0.2270270270;
  color += texture2D(image, uv + (off1 / resolution)) * 0.3162162162;
  color += texture2D(image, uv - (off1 / resolution)) * 0.3162162162;
  color += texture2D(image, uv + (off2 / resolution)) * 0.0702702703;
  color += texture2D(image, uv - (off2 / resolution)) * 0.0702702703;
  return color;
}

void main() {
  gl_FragColor = blur9(u_Texture, v_UV, u_ViewportSize, u_BlurDir);
}`,fE=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,hE=In.isNil,AE=(zm=(0,vr.b2)(),zm(Um=function(e){(0,Ne.Z)(t,e);var i=uE(t);function t(){return(0,se.Z)(this,t),i.apply(this,arguments)}return(0,be.Z)(t,[{key:"setupShaders",value:function(){this.shaderModuleService.registerModule("blur-pass",{vs:fE,fs:cE});var r=this.shaderModuleService.getModule("blur-pass"),a=r.vs,u=r.fs,c=r.uniforms,g=this.rendererService.getViewportSize(),x=g.width,M=g.height;return{vs:a,fs:u,uniforms:(0,X.Z)((0,X.Z)({},c),{},{u_ViewportSize:[x,M]})}}},{key:"convertOptionsToUniforms",value:function(r){var a={};return hE(r.blurRadius)||(a.u_BlurDir=[r.blurRadius,0]),a}}]),t}(t0))||Um),Gm,jm;function pE(e){var i=dE();return function(){var n=(0,ue.Z)(e),r;if(i){var a=(0,ue.Z)(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return(0,ze.Z)(this,r)}}function dE(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var vE=`varying vec2 v_UV;

uniform sampler2D u_Texture;

uniform vec2 u_ViewportSize: [1.0, 1.0];
uniform vec2 u_BlurDir: [1.0, 0.0];

// https://github.com/Jam3/glsl-fast-gaussian-blur/blob/master/9.glsl
vec4 blur9(sampler2D image, vec2 uv, vec2 resolution, vec2 direction) {
  vec4 color = vec4(0.0);
  vec2 off1 = vec2(1.3846153846) * direction;
  vec2 off2 = vec2(3.2307692308) * direction;
  color += texture2D(image, uv) * 0.2270270270;
  color += texture2D(image, uv + (off1 / resolution)) * 0.3162162162;
  color += texture2D(image, uv - (off1 / resolution)) * 0.3162162162;
  color += texture2D(image, uv + (off2 / resolution)) * 0.0702702703;
  color += texture2D(image, uv - (off2 / resolution)) * 0.0702702703;
  return color;
}

void main() {
  gl_FragColor = blur9(u_Texture, v_UV, u_ViewportSize, u_BlurDir);
}`,gE=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,mE=In.isNil,yE=(Gm=(0,vr.b2)(),Gm(jm=function(e){(0,Ne.Z)(t,e);var i=pE(t);function t(){return(0,se.Z)(this,t),i.apply(this,arguments)}return(0,be.Z)(t,[{key:"setupShaders",value:function(){this.shaderModuleService.registerModule("blur-pass",{vs:gE,fs:vE});var r=this.shaderModuleService.getModule("blur-pass"),a=r.vs,u=r.fs,c=r.uniforms,g=this.rendererService.getViewportSize(),x=g.width,M=g.height;return{vs:a,fs:u,uniforms:(0,X.Z)((0,X.Z)({},c),{},{u_ViewportSize:[x,M]})}}},{key:"convertOptionsToUniforms",value:function(r){var a={};return mE(r.blurRadius)||(a.u_BlurDir=[0,r.blurRadius]),a}}]),t}(t0))||jm),Vm,Hm;function _E(e){var i=xE();return function(){var n=(0,ue.Z)(e),r;if(i){var a=(0,ue.Z)(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return(0,ze.Z)(this,r)}}function xE(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var EE=`varying vec2 v_UV;

uniform sampler2D u_Texture;
uniform vec2 u_ViewportSize: [1.0, 1.0];
uniform vec2 u_Center : [0.5, 0.5];
uniform float u_Angle : 0;
uniform float u_Size : 8;

#pragma include "common"

float scale = PI / u_Size;

float pattern(float u_Angle, vec2 texSize, vec2 texCoord) {
  float s = sin(u_Angle), c = cos(u_Angle);
  vec2 tex = texCoord * texSize - u_Center * texSize;
  vec2 point = vec2(
    c * tex.x - s * tex.y,
    s * tex.x + c * tex.y
  ) * scale;
  return (sin(point.x) * sin(point.y)) * 4.0;
}

// https://github.com/evanw/glfx.js/blob/master/src/filters/fun/colorhalftone.js
vec4 colorHalftone_filterColor(vec4 color, vec2 texSize, vec2 texCoord) {
  vec3 cmy = 1.0 - color.rgb;
  float k = min(cmy.x, min(cmy.y, cmy.z));
  cmy = (cmy - k) / (1.0 - k);
  cmy = clamp(
    cmy * 10.0 - 3.0 + vec3(
      pattern(u_Angle + 0.26179, texSize, texCoord),
      pattern(u_Angle + 1.30899, texSize, texCoord),
      pattern(u_Angle, texSize, texCoord)
    ),
    0.0,
    1.0
  );
  k = clamp(k * 10.0 - 5.0 + pattern(u_Angle + 0.78539, texSize, texCoord), 0.0, 1.0);
  return vec4(1.0 - cmy - k, color.a);
}

void main() {
  gl_FragColor = vec4(texture2D(u_Texture, v_UV));
  gl_FragColor = colorHalftone_filterColor(gl_FragColor, u_ViewportSize, v_UV);
}`,bE=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,SE=(Vm=(0,vr.b2)(),Vm(Hm=function(e){(0,Ne.Z)(t,e);var i=_E(t);function t(){return(0,se.Z)(this,t),i.apply(this,arguments)}return(0,be.Z)(t,[{key:"setupShaders",value:function(){this.shaderModuleService.registerModule("colorhalftone-pass",{vs:bE,fs:EE});var r=this.shaderModuleService.getModule("colorhalftone-pass"),a=r.vs,u=r.fs,c=r.uniforms,g=this.rendererService.getViewportSize(),x=g.width,M=g.height;return{vs:a,fs:u,uniforms:(0,X.Z)((0,X.Z)({},c),{},{u_ViewportSize:[x,M]})}}}]),t}(t0))||Hm),$m,Ym;function CE(e){var i=wE();return function(){var n=(0,ue.Z)(e),r;if(i){var a=(0,ue.Z)(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return(0,ze.Z)(this,r)}}function wE(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var TE=`varying vec2 v_UV;

uniform sampler2D u_Texture;

void main() {
  gl_FragColor = vec4(texture2D(u_Texture, v_UV));
}`,ME=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,IE=($m=(0,vr.b2)(),$m(Ym=function(e){(0,Ne.Z)(t,e);var i=CE(t);function t(){return(0,se.Z)(this,t),i.apply(this,arguments)}return(0,be.Z)(t,[{key:"setupShaders",value:function(){return this.shaderModuleService.registerModule("copy-pass",{vs:ME,fs:TE}),this.shaderModuleService.getModule("copy-pass")}}]),t}(t0))||Ym),Wm,Xm;function PE(e){var i=LE();return function(){var n=(0,ue.Z)(e),r;if(i){var a=(0,ue.Z)(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return(0,ze.Z)(this,r)}}function LE(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var OE=`varying vec2 v_UV;

uniform sampler2D u_Texture;
uniform vec2 u_ViewportSize: [1.0, 1.0];
uniform vec2 u_Center : [0.5, 0.5];
uniform float u_Scale : 10;

// https://github.com/evanw/glfx.js/blob/master/src/filters/fun/hexagonalpixelate.js
vec4 hexagonalPixelate_sampleColor(sampler2D texture, vec2 texSize, vec2 texCoord) {
  vec2 tex = (texCoord * texSize - u_Center * texSize) / u_Scale;
  tex.y /= 0.866025404;
  tex.x -= tex.y * 0.5;
  vec2 a;
  if (tex.x + tex.y - floor(tex.x) - floor(tex.y) < 1.0) {
    a = vec2(floor(tex.x), floor(tex.y));
  }
  else a = vec2(ceil(tex.x), ceil(tex.y));
  vec2 b = vec2(ceil(tex.x), floor(tex.y));
  vec2 c = vec2(floor(tex.x), ceil(tex.y));
  vec3 TEX = vec3(tex.x, tex.y, 1.0 - tex.x - tex.y);
  vec3 A = vec3(a.x, a.y, 1.0 - a.x - a.y);
  vec3 B = vec3(b.x, b.y, 1.0 - b.x - b.y);
  vec3 C = vec3(c.x, c.y, 1.0 - c.x - c.y);
  float alen = length(TEX - A);
  float blen = length(TEX - B);
  float clen = length(TEX - C);
  vec2 choice;
  if (alen < blen) {
    if (alen < clen) choice = a;
    else choice = c;
  } else {
    if (blen < clen) choice = b;
    else choice = c;
  }
  choice.x += choice.y * 0.5;
  choice.y *= 0.866025404;
  choice *= u_Scale / texSize;
  return texture2D(texture, choice + u_Center);
}

void main() {
  gl_FragColor = vec4(texture2D(u_Texture, v_UV));
  gl_FragColor = hexagonalPixelate_sampleColor(u_Texture, u_ViewportSize, v_UV);
}`,RE=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,DE=(Wm=(0,vr.b2)(),Wm(Xm=function(e){(0,Ne.Z)(t,e);var i=PE(t);function t(){return(0,se.Z)(this,t),i.apply(this,arguments)}return(0,be.Z)(t,[{key:"setupShaders",value:function(){this.shaderModuleService.registerModule("hexagonalpixelate-pass",{vs:RE,fs:OE});var r=this.shaderModuleService.getModule("hexagonalpixelate-pass"),a=r.vs,u=r.fs,c=r.uniforms,g=this.rendererService.getViewportSize(),x=g.width,M=g.height;return{vs:a,fs:u,uniforms:(0,X.Z)((0,X.Z)({},c),{},{u_ViewportSize:[x,M]})}}}]),t}(t0))||Xm),Qm,qm;function kE(e){var i=NE();return function(){var n=(0,ue.Z)(e),r;if(i){var a=(0,ue.Z)(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return(0,ze.Z)(this,r)}}function NE(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var FE=`varying vec2 v_UV;

uniform sampler2D u_Texture;
uniform vec2 u_ViewportSize: [1.0, 1.0];
uniform float u_Strength : 0.6;

vec4 ink_sampleColor(sampler2D texture, vec2 texSize, vec2 texCoord) {
  vec2 dx = vec2(1.0 / texSize.x, 0.0);
  vec2 dy = vec2(0.0, 1.0 / texSize.y);
  vec4 color = texture2D(texture, texCoord);
  float bigTotal = 0.0;
  float smallTotal = 0.0;
  vec3 bigAverage = vec3(0.0);
  vec3 smallAverage = vec3(0.0);
  for (float x = -2.0; x <= 2.0; x += 1.0) {
    for (float y = -2.0; y <= 2.0; y += 1.0) {
      vec3 sample = texture2D(texture, texCoord + dx * x + dy * y).rgb;
      bigAverage += sample;
      bigTotal += 1.0;
      if (abs(x) + abs(y) < 2.0) {
        smallAverage += sample;
        smallTotal += 1.0;
      }
    }
  }
  vec3 edge = max(vec3(0.0), bigAverage / bigTotal - smallAverage / smallTotal);
  float power = u_Strength * u_Strength * u_Strength * u_Strength * u_Strength;
  return vec4(color.rgb - dot(edge, edge) * power * 100000.0, color.a);
}

void main() {
  gl_FragColor = vec4(texture2D(u_Texture, v_UV));
  gl_FragColor = ink_sampleColor(u_Texture, u_ViewportSize, v_UV);
}`,BE=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,ZE=(Qm=(0,vr.b2)(),Qm(qm=function(e){(0,Ne.Z)(t,e);var i=kE(t);function t(){return(0,se.Z)(this,t),i.apply(this,arguments)}return(0,be.Z)(t,[{key:"setupShaders",value:function(){this.shaderModuleService.registerModule("ink-pass",{vs:BE,fs:FE});var r=this.shaderModuleService.getModule("ink-pass"),a=r.vs,u=r.fs,c=r.uniforms,g=this.rendererService.getViewportSize(),x=g.width,M=g.height;return{vs:a,fs:u,uniforms:(0,X.Z)((0,X.Z)({},c),{},{u_ViewportSize:[x,M]})}}}]),t}(t0))||qm),Km,Jm;function zE(e){var i=UE();return function(){var n=(0,ue.Z)(e),r;if(i){var a=(0,ue.Z)(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return(0,ze.Z)(this,r)}}function UE(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var GE=`varying vec2 v_UV;

uniform sampler2D u_Texture;
uniform float u_Amount : 0.5;

float rand(vec2 co) {
  return fract(sin(dot(co.xy ,vec2(12.9898,78.233))) * 43758.5453);
}

// https://github.com/evanw/glfx.js/blob/master/src/filters/adjust/noise.js
vec4 noise_filterColor(vec4 color, vec2 texCoord) {
  float diff = (rand(texCoord) - 0.5) * u_Amount;
  color.r += diff;
  color.g += diff;
  color.b += diff;
  return color;
}

void main() {
  gl_FragColor = vec4(texture2D(u_Texture, v_UV));
  gl_FragColor = noise_filterColor(gl_FragColor, v_UV);
}`,jE=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,VE=(Km=(0,vr.b2)(),Km(Jm=function(e){(0,Ne.Z)(t,e);var i=zE(t);function t(){return(0,se.Z)(this,t),i.apply(this,arguments)}return(0,be.Z)(t,[{key:"setupShaders",value:function(){return this.shaderModuleService.registerModule("noise-pass",{vs:jE,fs:GE}),this.shaderModuleService.getModule("noise-pass")}}]),t}(t0))||Jm),ey,ty;function HE(e){var i=$E();return function(){var n=(0,ue.Z)(e),r;if(i){var a=(0,ue.Z)(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return(0,ze.Z)(this,r)}}function $E(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var YE=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,WE=`varying vec2 v_UV;

uniform sampler2D u_Texture;

uniform float u_Amount : 0.5;

// https://github.com/evanw/glfx.js/blob/master/src/filters/adjust/sepia.js
vec4 sepia_filterColor(vec4 color) {
  float r = color.r;
  float g = color.g;
  float b = color.b;
  color.r =
    min(1.0, (r * (1.0 - (0.607 * u_Amount))) + (g * (0.769 * u_Amount)) + (b * (0.189 * u_Amount)));
  color.g = min(1.0, (r * 0.349 * u_Amount) + (g * (1.0 - (0.314 * u_Amount))) + (b * 0.168 * u_Amount));
  color.b = min(1.0, (r * 0.272 * u_Amount) + (g * 0.534 * u_Amount) + (b * (1.0 - (0.869 * u_Amount))));
  return color;
}

void main() {
  gl_FragColor = vec4(texture2D(u_Texture, v_UV));
  gl_FragColor = sepia_filterColor(gl_FragColor);
}`,XE=(ey=(0,vr.b2)(),ey(ty=function(e){(0,Ne.Z)(t,e);var i=HE(t);function t(){return(0,se.Z)(this,t),i.apply(this,arguments)}return(0,be.Z)(t,[{key:"setupShaders",value:function(){return this.shaderModuleService.registerModule("sepia-pass",{vs:YE,fs:WE}),this.shaderModuleService.getModule("sepia-pass")}}]),t}(t0))||ty),ry,ny,iy,ay,tA,oy,QE=(ry=(0,vr.b2)(),ny=(0,vr.f3)(Xt.IRendererService),iy=(0,vr.zY)(),ry(ay=(tA=function(){function e(){(0,se.Z)(this,e),Ki(this,"rendererService",oy,this),(0,Me.Z)(this,"passes",[]),(0,Me.Z)(this,"readFBO",void 0),(0,Me.Z)(this,"writeFBO",void 0)}return(0,be.Z)(e,[{key:"getReadFBO",value:function(){return this.readFBO}},{key:"getWriteFBO",value:function(){return this.writeFBO}},{key:"getCurrentFBOTex",value:function(){var t=this.rendererService,n=t.getViewportSize,r=t.createTexture2D,a=n(),u=a.width,c=a.height;return r({x:0,y:0,width:u,height:c,copy:!0})}},{key:"getReadFBOTex",value:function(){var t=this,n=this.rendererService.useFramebuffer;return new Promise(function(r){n(t.readFBO,(0,ur.Z)(it().mark(function a(){return it().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:r(t.getCurrentFBOTex());case 1:case"end":return c.stop()}},a)})))})}},{key:"renderBloomPass",value:function(){var i=(0,ur.Z)(it().mark(function n(r,a){var u,c;return it().wrap(function(x){for(;;)switch(x.prev=x.next){case 0:return x.next=2,this.getReadFBOTex();case 2:u=x.sent,c=0;case 4:if(!(c<4)){x.next=11;break}return x.next=7,a.render(r,u);case 7:this.swap(),c++,x.next=4;break;case 11:case"end":return x.stop()}},n,this)}));function t(n,r){return i.apply(this,arguments)}return t}()},{key:"render",value:function(){var i=(0,ur.Z)(it().mark(function n(r){var a,u;return it().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:a=0;case 1:if(!(a<this.passes.length)){g.next=15;break}if(u=this.passes[a],u.setRenderToScreen(this.isLastEnabledPass(a)),u.getName()!=="bloom"){g.next=9;break}return g.next=7,this.renderBloomPass(r,u);case 7:g.next=12;break;case 9:return g.next=11,u.render(r);case 11:a!==this.passes.length-1&&this.swap();case 12:a++,g.next=1;break;case 15:case"end":return g.stop()}},n,this)}));function t(n){return i.apply(this,arguments)}return t}()},{key:"resize",value:function(t,n){this.readFBO.resize({width:t,height:n}),this.writeFBO.resize({width:t,height:n})}},{key:"add",value:function(t,n,r){t.init(n,r),this.passes.push(t)}},{key:"insert",value:function(t,n,r,a){t.init(r,a),this.passes.splice(n,0,t)}},{key:"getPostProcessingPassByName",value:function(t){return this.passes.find(function(n){return n.getName()===t})}},{key:"init",value:function(){var t=this.rendererService,n=t.createFramebuffer,r=t.createTexture2D;this.readFBO=n({color:r({width:1,height:1,wrapS:je.CLAMP_TO_EDGE,wrapT:je.CLAMP_TO_EDGE})}),this.writeFBO=n({color:r({width:1,height:1,wrapS:je.CLAMP_TO_EDGE,wrapT:je.CLAMP_TO_EDGE})})}},{key:"isLastEnabledPass",value:function(t){for(var n=t+1;n<this.passes.length;n++)if(this.passes[n].isEnabled())return!1;return!0}},{key:"swap",value:function(){var t=this.readFBO;this.readFBO=this.writeFBO,this.writeFBO=t}}]),e}(),oy=Hi(tA.prototype,"rendererService",[ny],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Hi(tA.prototype,"init",[iy],Object.getOwnPropertyDescriptor(tA.prototype,"init"),tA.prototype),tA))||ay),sy,uy;function qE(e){var i=KE();return function(){var n=(0,ue.Z)(e),r;if(i){var a=(0,ue.Z)(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return(0,ze.Z)(this,r)}}function KE(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var JE=(sy=(0,vr.b2)(),sy(uy=function(e){(0,Ne.Z)(t,e);var i=qE(t);function t(){return(0,se.Z)(this,t),i.apply(this,arguments)}return(0,be.Z)(t,[{key:"getType",value:function(){return eA.Normal}},{key:"getName",value:function(){return"render"}},{key:"init",value:function(r,a){D0((0,ue.Z)(t.prototype),"init",this).call(this,r,a)}},{key:"render",value:function(r){var a=this.rendererService,u=a.useFramebuffer,c=a.clear,g=r.multiPassRenderer.getPostProcessor().getReadFBO();u(g,function(){c({color:[0,0,0,0],depth:1,stencil:0,framebuffer:g}),r.multiPassRenderer.setRenderFlag(!1),r.models.forEach(function(x){x.draw({uniforms:r.layerModel.getUninforms()})}),r.multiPassRenderer.setRenderFlag(!0)})}}]),t}(Md))||uy),ly,cy,fy,tg,hy;function eb(e){var i=tb();return function(){var n=(0,ue.Z)(e),r;if(i){var a=(0,ue.Z)(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return(0,ze.Z)(this,r)}}function tb(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var rb=`uniform float u_opacity : 1.0;
uniform float u_MixRatio : 0.5;

uniform sampler2D u_Diffuse1;
uniform sampler2D u_Diffuse2;

varying vec2 v_UV;

void main() {
  vec4 texel1 = texture2D(u_Diffuse1, v_UV);
  vec4 texel2 = texture2D(u_Diffuse2, v_UV);
  gl_FragColor = u_opacity * mix(texel1, texel2, u_MixRatio);
}
`,Ay=`varying vec2 v_UV;

uniform sampler2D u_Texture;

void main() {
  gl_FragColor = vec4(texture2D(u_Texture, v_UV));
}`,nb=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`;function py(e,i){for(var t=0,n=1/i,r=e;r>0;)t=t+n*(r%i),r=Math.floor(r/i),n=n/i;return t}var ib=1,ab=(ly=(0,vr.b2)(),cy=(0,vr.f3)(Xt.IShaderModuleService),ly(fy=(tg=function(e){(0,Ne.Z)(t,e);var i=eb(t);function t(){var n;(0,se.Z)(this,t);for(var r=arguments.length,a=new Array(r),u=0;u<r;u++)a[u]=arguments[u];return n=i.call.apply(i,[this].concat(a)),Ki((0,xt.Z)(n),"shaderModuleService",hy,(0,xt.Z)(n)),(0,Me.Z)((0,xt.Z)(n),"haltonSequence",[]),(0,Me.Z)((0,xt.Z)(n),"accumulatingId",0),(0,Me.Z)((0,xt.Z)(n),"frame",0),(0,Me.Z)((0,xt.Z)(n),"timer",void 0),(0,Me.Z)((0,xt.Z)(n),"sampleRenderTarget",void 0),(0,Me.Z)((0,xt.Z)(n),"prevRenderTarget",void 0),(0,Me.Z)((0,xt.Z)(n),"outputRenderTarget",void 0),(0,Me.Z)((0,xt.Z)(n),"copyRenderTarget",void 0),(0,Me.Z)((0,xt.Z)(n),"blendModel",void 0),(0,Me.Z)((0,xt.Z)(n),"outputModel",void 0),(0,Me.Z)((0,xt.Z)(n),"copyModel",void 0),n}return(0,be.Z)(t,[{key:"getType",value:function(){return eA.Normal}},{key:"getName",value:function(){return"taa"}},{key:"init",value:function(r,a){D0((0,ue.Z)(t.prototype),"init",this).call(this,r,a);var u=this.rendererService,c=u.createFramebuffer,g=u.createTexture2D;this.sampleRenderTarget=c({color:g({width:1,height:1,wrapS:je.CLAMP_TO_EDGE,wrapT:je.CLAMP_TO_EDGE})}),this.prevRenderTarget=c({color:g({width:1,height:1,wrapS:je.CLAMP_TO_EDGE,wrapT:je.CLAMP_TO_EDGE})}),this.outputRenderTarget=c({color:g({width:1,height:1,wrapS:je.CLAMP_TO_EDGE,wrapT:je.CLAMP_TO_EDGE})}),this.copyRenderTarget=c({color:g({width:1,height:1,wrapS:je.CLAMP_TO_EDGE,wrapT:je.CLAMP_TO_EDGE})});for(var x=0;x<30;x++)this.haltonSequence.push([py(x,2),py(x,3)]);this.blendModel=this.createTriangleModel("blend-pass",rb),this.outputModel=this.createTriangleModel("copy-pass",Ay,{blend:{enable:!0,func:{srcRGB:je.ONE,dstRGB:je.ONE_MINUS_SRC_ALPHA,srcAlpha:je.ONE,dstAlpha:je.ONE_MINUS_SRC_ALPHA},equation:{rgb:je.FUNC_ADD,alpha:je.FUNC_ADD}}}),this.copyModel=this.createTriangleModel("copy-pass",Ay)}},{key:"render",value:function(r){var a=this,u=this.rendererService,c=u.clear,g=u.getViewportSize,x=u.useFramebuffer,M=g(),O=M.width,B=M.height;this.sampleRenderTarget.resize({width:O,height:B}),this.prevRenderTarget.resize({width:O,height:B}),this.outputRenderTarget.resize({width:O,height:B}),this.copyRenderTarget.resize({width:O,height:B}),this.resetFrame(),this.stopAccumulating();var W=r.multiPassRenderer.getPostProcessor().getReadFBO();x(W,function(){c({color:[0,0,0,0],depth:1,stencil:0,framebuffer:W}),r.multiPassRenderer.setRenderFlag(!1),r.render(),r.multiPassRenderer.setRenderFlag(!0)});var ce=function oe(Te){!a.accumulatingId||Te!==a.accumulatingId||a.isFinished()||(a.doRender(r),window.requestAnimationFrame(function(){oe(Te)}))};this.accumulatingId=ib++,this.timer=window.setTimeout(function(){ce(a.accumulatingId)},50)}},{key:"doRender",value:function(r){var a=this,u=this.rendererService,c=u.clear,g=u.getViewportSize,x=u.useFramebuffer,M=g(),O=M.width,B=M.height,W=r.getLayerConfig(),ce=W.jitterScale,oe=ce===void 0?1:ce,Te=this.haltonSequence[this.frame%this.haltonSequence.length];this.cameraService.jitterProjectionMatrix((Te[0]*2-1)/O*oe,(Te[1]*2-1)/B*oe),r.multiPassRenderer.setRenderFlag(!1),r.hooks.beforeRender.call(),x(this.sampleRenderTarget,function(){c({color:[0,0,0,0],depth:1,stencil:0,framebuffer:a.sampleRenderTarget}),r.render()}),r.hooks.afterRender.call(),r.multiPassRenderer.setRenderFlag(!0);var Ze=r.getLayerConfig();x(this.outputRenderTarget,function(){a.blendModel.draw({uniforms:{u_opacity:Ze.opacity||1,u_MixRatio:a.frame===0?1:.9,u_Diffuse1:a.sampleRenderTarget,u_Diffuse2:a.frame===0?r.multiPassRenderer.getPostProcessor().getReadFBO():a.prevRenderTarget}})}),this.frame===0&&c({color:[0,0,0,0],depth:1,stencil:0,framebuffer:this.copyRenderTarget}),this.frame>=1&&(x(this.copyRenderTarget,function(){a.outputModel.draw({uniforms:{u_Texture:a.outputRenderTarget}})}),x(r.multiPassRenderer.getPostProcessor().getReadFBO(),function(){a.copyModel.draw({uniforms:{u_Texture:a.copyRenderTarget}})}),r.multiPassRenderer.getPostProcessor().render(r));var qe=this.prevRenderTarget;this.prevRenderTarget=this.outputRenderTarget,this.outputRenderTarget=qe,this.frame++,this.cameraService.clearJitterProjectionMatrix()}},{key:"isFinished",value:function(){return this.frame>=this.haltonSequence.length}},{key:"resetFrame",value:function(){this.frame=0}},{key:"stopAccumulating",value:function(){this.accumulatingId=0,window.clearTimeout(this.timer)}},{key:"createTriangleModel",value:function(r,a,u){this.shaderModuleService.registerModule(r,{vs:nb,fs:a});var c=this.shaderModuleService.getModule(r),g=c.vs,x=c.fs,M=c.uniforms,O=this.rendererService,B=O.createAttribute,W=O.createBuffer,ce=O.createModel;return ce((0,X.Z)({vs:g,fs:x,attributes:{a_Position:B({buffer:W({data:[-4,-4,4,-4,0,4],type:je.FLOAT}),size:2})},uniforms:(0,X.Z)({},M),depth:{enable:!1},count:3},u))}}]),t}(Md),hy=Hi(tg.prototype,"shaderModuleService",[cy],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),tg))||fy),cp=new vr.W2;cp.bind(Xt.IGlobalConfigService).to(BA).inSingletonScope(),(0,vr.GW)((0,vr.b2)(),ha.EventEmitter),cp.bind(Xt.IEventEmitter).to(ha.EventEmitter);var dy=(0,Ri.Z)(cp,!1),rg=function(i){var t=dy.lazyInject(i);return function(n,r,a){t.call(this,n,r),a&&(a.initializer=function(){return n[r]})}},hP=function(i){var t=dy.lazyMultiInject(i);return function(n,r,a){t.call(this,n,r),a&&(a.initializer=function(){return n[r]})}},ql=cp,ob=0;function sb(){var e=new vr.W2;return e.parent=cp,e.bind(Xt.SceneID).toConstantValue("".concat(ob++)),e.bind(Xt.IShaderModuleService).to(Gx).inSingletonScope(),e.bind(Xt.ILayerService).to(Am).inSingletonScope(),e.bind(Xt.IDebugService).to(Uc).inSingletonScope(),e.bind(Xt.ISceneService).to(po).inSingletonScope(),e.bind(Xt.ICameraService).to(pv).inSingletonScope(),e.bind(Xt.ICoordinateSystemService).to(sh).inSingletonScope(),e.bind(Xt.IInteractionService).to(YA).inSingletonScope(),e.bind(Xt.IPickingService).to(Nv).inSingletonScope(),e.bind(Xt.IControlService).to(kA).inSingletonScope(),e.bind(Xt.IMarkerService).to(Gp).inSingletonScope(),e.bind(Xt.IIconService).to(Wa).inSingletonScope(),e.bind(Xt.IFontService).to(Kr).inSingletonScope(),e.bind(Xt.IPopupService).to(mv).inSingletonScope(),e.bind(Xt.INormalPass).to($x).whenTargetNamed("clear"),e.bind(Xt.INormalPass).to(Kx).whenTargetNamed("pixelPicking"),e.bind(Xt.INormalPass).to(JE).whenTargetNamed("render"),e.bind(Xt.INormalPass).to(ab).whenTargetNamed("taa"),e.bind(Xt.IFactoryNormalPass).toFactory(function(i){return function(t){return i.container.getNamed(Xt.INormalPass,t)}}),e.bind(Xt.IPostProcessingPass).to(IE).whenTargetNamed("copy"),e.bind(Xt.IPostProcessingPass).to(sE).whenTargetNamed("bloom"),e.bind(Xt.IPostProcessingPass).to(AE).whenTargetNamed("blurH"),e.bind(Xt.IPostProcessingPass).to(yE).whenTargetNamed("blurV"),e.bind(Xt.IPostProcessingPass).to(VE).whenTargetNamed("noise"),e.bind(Xt.IPostProcessingPass).to(XE).whenTargetNamed("sepia"),e.bind(Xt.IPostProcessingPass).to(SE).whenTargetNamed("colorHalftone"),e.bind(Xt.IPostProcessingPass).to(DE).whenTargetNamed("hexagonalPixelate"),e.bind(Xt.IPostProcessingPass).to(ZE).whenTargetNamed("ink"),e.bind(Xt.IFactoryPostProcessingPass).toFactory(function(i){return function(t){var n=i.container.getNamed(Xt.IPostProcessingPass,t);return n.setName(t),n}}),e}function fp(e){var i=new vr.W2;return i.parent=e,i.bind(Xt.IStyleAttributeService).to(rp).inSingletonScope(),i.bind(Xt.IMultiPassRenderer).to(Xx).inSingletonScope(),i.bind(Xt.IPostProcessor).to(QE).inSingletonScope(),i}var ub=null;function AP(e){return ub.indexOf(e)}var vy=In.clamp,lb=2,pP=4,cb=64,dP=128,fb=256,hb=512,vP=8192,gP=16384,mP=32768,Ab=null,gy=131072,yP=262144,pb=524288,_P=1048576,db=2097152,xP=4194304,vb=8388608,gb=16777216,mb=null;function Id(e,i){return e=vy(Math.floor(e),0,255),i=vy(Math.floor(i),0,255),256*e+i}function EP(e){var i=e.color,t=e.radius,n=e.tileX,r=e.tileY,a=e.shape,u=e.opacity,c=e.stroke,g=e.strokeWidth,x=e.strokeOpacity,M=[],O=[],B=[],W=[Id(i[0],i[1]),Id(i[2],i[3])],ce=[Id(c[0],c[1]),Id(c[2],c[3])];return[[-1,-1],[1,-1],[1,1],[-1,1]].forEach(function(oe){var Te=_slicedToArray(oe,2),Ze=Te[0],qe=Te[1];M.push([].concat(W,[(Ze+1)*vb+(qe+1)*db+getShapeIndex(a)*gy+t,(n+512)*pb+(r+512)*cb])),O.push([].concat(ce,[g,x])),B.push([u,0,0,0])}),{packedBuffer:M,packedBuffer2:O,packedBuffer3:B}}function bP(e,i){if(e===0&&!i)return 0;if(e===1&&i)return 4294967295;var t=i?1:0,n=Math.floor(e*127);return n*mb+t*gb+n*gy+t*Ab+n*hb+t*fb+n*lb+t}var Ah={ProjectionMatrix:"u_ProjectionMatrix",ViewMatrix:"u_ViewMatrix",ViewProjectionMatrix:"u_ViewProjectionMatrix",Zoom:"u_Zoom",ZoomScale:"u_ZoomScale",FocalDistance:"u_FocalDistance",CameraPosition:"u_CameraPosition"},Js={MapInitStart:"mapInitStart",LayerInitStart:"layerInitStart",LayerInitEnd:"layerInitEnd",SourceInitStart:"sourceInitStart",SourceInitEnd:"sourceInitEnd",ScaleInitStart:"scaleInitStart",ScaleInitEnd:"scaleInitEnd",MappingStart:"mappingStart",MappingEnd:"mappingEnd",BuildModelStart:"buildModelStart",BuildModelEnd:"buildModelEnd"},so=function(e){return e.LINEAR="linear",e.SEQUENTIAL="sequential",e.POWER="power",e.LOG="log",e.IDENTITY="identity",e.TIME="time",e.QUANTILE="quantile",e.QUANTIZE="quantize",e.THRESHOLD="threshold",e.CAT="cat",e.DIVERGING="diverging",e}({}),rA=function(e){return e.CONSTANT="constant",e.VARIABLE="variable",e}({}),mn=function(e){return e[e.Attribute=0]="Attribute",e[e.InstancedAttribute=1]="InstancedAttribute",e[e.Uniform=2]="Uniform",e}({}),yy=["mapload","mapchange","mapAfterFrameChange"],Pd=["loaded","fontloaded","maploaded","resize","destroy","dragstart","dragging","dragend","dragcancel"],Wu=function(e){return e.IMAGE="image",e.CUSTOMIMAGE="customImage",e.ARRAYBUFFER="arraybuffer",e.RGB="rgb",e.TERRAINRGB="terrainRGB",e.CUSTOMRGB="customRGB",e.CUSTOMARRAYBUFFER="customArrayBuffer",e.CUSTOMTERRAINRGB="customTerrainRGB",e}({}),yb=function(){var e=(0,ur.Z)(it().mark(function i(t,n,r,a){return it().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.abrupt("return",new Promise(function(g,x){n({x:t.x,y:t.y,z:t.z},function(M,O){if(M||O.length===0){x(M);return}O&&da([{data:O,bands:[0]}],r,a,function(B,W){B?x(B):W&&g(W)})})}));case 1:case"end":return c.stop()}},i)}));return function(t,n,r,a){return e.apply(this,arguments)}}(),_b=function(){var e=(0,ur.Z)(it().mark(function i(t,n){return it().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",new Promise(function(u,c){n({x:t.x,y:t.y,z:t.z},function(g,x){if(g||!x){c(g);return}x instanceof ArrayBuffer?At(x,function(M,O){M&&c(M),u(O)}):x instanceof HTMLImageElement?u(x):c(g)})}));case 1:case"end":return a.stop()}},i)}));return function(t,n){return e.apply(this,arguments)}}();function xb(e,i){return Array.isArray(e)?typeof e[0]=="string"?e.map(function(t){return bl(t,i)}):e.map(function(t){return{url:bl(t.url,i),bands:t.bands||[0]}}):bl(e,i)}function Eb(e){return typeof e=="string"?[{url:e,bands:[0]}]:typeof e[0]=="string"?e.map(function(i){return{url:i,bands:[0]}}):e}function _y(e,i){e.xhrCancel=function(){i.map(function(t){t.abort()})}}var bb=function(){var e=(0,ur.Z)(it().mark(function i(t,n,r,a,u){var c,g,x,M,O,B;return it().wrap(function(ce){for(;;)switch(ce.prev=ce.next){case 0:if(c=Eb(n.url),!(c.length>1)){ce.next=15;break}return ce.next=4,Sb(c,n);case 4:if(g=ce.sent,x=g.rasterFiles,M=g.xhrList,O=g.errList,_y(t,M),!(O.length>0)){ce.next=12;break}return r(O,null),ce.abrupt("return");case 12:da(x,a,u,r),ce.next=17;break;case 15:B=sn(n,function(oe,Te){if(oe)r(oe);else if(Te){var Ze=[{data:Te,bands:c[0].bands}];da(Ze,a,u,r)}}),_y(t,[B]);case 17:case"end":return ce.stop()}},i)}));return function(t,n,r,a,u){return e.apply(this,arguments)}}();function Sb(e,i){return ng.apply(this,arguments)}function ng(){return ng=(0,ur.Z)(it().mark(function e(i,t){var n,r,a,u,c,g,x,M,O,B,W;return it().wrap(function(oe){for(;;)switch(oe.prev=oe.next){case 0:n=[],r=[],a=[],u=0;case 4:if(!(u<i.length)){oe.next=20;break}return c=i[u],g=(0,X.Z)((0,X.Z)({},t),{},{url:c.url}),x=c.bands,oe.next=10,ti((0,X.Z)((0,X.Z)({},g),{},{type:"arrayBuffer"}));case 10:M=oe.sent,O=M.err,B=M.data,W=M.xhr,O&&a.push(O),r.push(W),n.push({data:B,bands:x});case 17:u++,oe.next=4;break;case 20:return oe.abrupt("return",{rasterFiles:n,xhrList:r,errList:a});case 21:case"end":return oe.stop()}},e)})),ng.apply(this,arguments)}var Cb=function(){var e=(0,ur.Z)(it().mark(function i(t,n,r,a,u){var c;return it().wrap(function(x){for(;;)switch(x.prev=x.next){case 0:return c={url:xb(t,n)},x.abrupt("return",new Promise(function(M,O){bb(r,c,function(B,W){B?O(B):W&&M(W)},a,u)}));case 2:case"end":return x.stop()}},i)}));return function(t,n,r,a,u){return e.apply(this,arguments)}}(),xy=function(){var e=(0,ur.Z)(it().mark(function i(t,n,r,a){var u,c,g,x;return it().wrap(function(O){for(;;)switch(O.prev=O.next){case 0:return c=Array.isArray(t)?t[0]:t,a.wmtsOptions?(g=(a==null?void 0:a.getURLFromTemplate)||gs,u=g(c,(0,X.Z)((0,X.Z)({},n),a.wmtsOptions))):(x=(a==null?void 0:a.getURLFromTemplate)||bl,u=x(c,n)),O.abrupt("return",new Promise(function(B,W){var ce,oe=$e({url:u,type:(a==null||(ce=a.requestParameters)===null||ce===void 0?void 0:ce.type)||"arrayBuffer"},function(Te,Ze){Te?W(Te):Ze&&B(Ze)},a.transformResponse);r.xhrCancel=function(){return oe.cancel()}}));case 3:case"end":return O.stop()}},i)}));return function(t,n,r,a){return e.apply(this,arguments)}}(),Ey=function(){return{rasterData:new Uint8Array([0]),width:1,height:1}},wb={tileSize:256,minZoom:0,maxZoom:1/0,zoomOffset:0,warp:!0},SP=[Wu.ARRAYBUFFER,Wu.RGB];function Tb(e){return!!(Array.isArray(e)&&e.length===0||!Array.isArray(e)&&typeof e!="string")}function Mb(e){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(Tb(e))throw new Error("tile server url is error");var t=(i==null?void 0:i.dataType)||Wu.IMAGE;t===Wu.RGB&&(t=Wu.ARRAYBUFFER);var n=function(u,c){switch(t){case Wu.IMAGE:return xy(e,u,c,i);case Wu.CUSTOMIMAGE:case Wu.CUSTOMTERRAINRGB:return _b(c,i==null?void 0:i.getCustomData);case Wu.ARRAYBUFFER:return Cb(e,u,c,(i==null?void 0:i.format)||Ey,i==null?void 0:i.operation);case Wu.CUSTOMARRAYBUFFER:case Wu.CUSTOMRGB:return yb(c,i==null?void 0:i.getCustomData,(i==null?void 0:i.format)||Ey,i==null?void 0:i.operation);default:return xy(e,u,c,i)}},r=(0,X.Z)((0,X.Z)((0,X.Z)({},wb),i),{},{getTileData:n});return{data:e,dataArray:[],tilesetOptions:r,isTile:!0}}var Ib=["extent","min","max","width","height","format","operation"];function Pb(e,i){var t=i.extent,n=i.min,r=i.max,a=i.width,u=i.height,c=i.format,g=i.operation,x=(0,Ac.Z)(i,Ib),M;if(c===void 0||cf(e))M=Array.from(e);else{var O=Array.isArray(e)?e:[e];M=Ga(O,c,g)}var B={_id:1,dataArray:[(0,X.Z)((0,X.Z)({_id:1,data:M,width:a,height:u},x),{},{min:n,max:r,coordinates:[[t[0],t[1]],[t[2],t[3]]]})]};return B}var Lb={tileSize:256,minZoom:0,maxZoom:1/0,zoomOffset:0},Ob=function(){var e=(0,ur.Z)(it().mark(function i(t){return it().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",new Promise(function(a){var u=(0,vn.Z)(t.bounds,4),c=u[0],g=u[1],x=u[2],M=u[3],O={layers:{testTile:{features:[{type:"Feature",properties:{key:t.x+"/"+t.y+"/"+t.z,x:(c+x)/2,y:(g+M)/2},geometry:{type:"LineString",coordinates:[[x,M],[x,g],[c,g],[c,g]]}}]}}};a(O)}));case 1:case"end":return r.stop()}},i)}));return function(t){return e.apply(this,arguments)}}();function Rb(e,i){var t=function(a){return Ob(a)},n=(0,X.Z)((0,X.Z)((0,X.Z)({},Lb),i),{},{getTileData:t});return{data:e,dataArray:[],tilesetOptions:n,isTile:!0}}var Db=C(69848),by=C.n(Db);function Sy(e,i){var t=i.radius,n=t===void 0?40:t,r=i.maxZoom,a=r===void 0?18:r,u=i.minZoom,c=u===void 0?0:u,g=i.zoom,x=g===void 0?2:g;if(e.pointIndex){var M=e.pointIndex.getClusters(e.extent,Math.floor(x));return e.dataArray=kb(M),e}var O=new(by())({radius:n,minZoom:c,maxZoom:a}),B={type:"FeatureCollection",features:[]};return B.features=e.dataArray.map(function(W){return{type:"Feature",geometry:{type:"Point",coordinates:W.coordinates},properties:(0,X.Z)({},W)}}),O.load(B.features),O}function kb(e){return e.map(function(i,t){return(0,X.Z)({coordinates:i.geometry.coordinates,_id:t+1},i.properties)})}function Nb(e){if(e.length===0)throw new Error("max requires at least one data point");for(var i=e[0],t=1;t<e.length;t++)e[t]>i&&(i=e[t]);return i}function Fb(e){if(e.length===0)throw new Error("min requires at least one data point");for(var i=e[0],t=1;t<e.length;t++)e[t]<i&&(i=e[t]);return i}function Cy(e){if(e.length===0)return 0;for(var i=e[0],t=0,n,r=1;r<e.length;r++)n=i+e[r]*1,Math.abs(i)>=Math.abs(e[r])?t+=i-n+e[r]:t+=e[r]-n+i,i=n;return i+t*1}function Bb(e){if(e.length===0)throw new Error("mean requires at least one data point");return Cy(e)/e.length}var Zb={min:Fb,max:Nb,mean:Bb,sum:Cy};function zb(e){var i=Ub();return function(){var n=(0,ue.Z)(e),r;if(i){var a=(0,ue.Z)(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return(0,ze.Z)(this,r)}}function Ub(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var Gb=In.cloneDeep,wy=In.isFunction,jb=In.isString,Vb=In.mergeWith;function Hb(e,i){if(Array.isArray(i))return i}var $b=function(e){(0,Ne.Z)(t,e);var i=zb(t);function t(n,r){var a;return(0,se.Z)(this,t),a=i.call(this),(0,Me.Z)((0,xt.Z)(a),"type","source"),(0,Me.Z)((0,xt.Z)(a),"isTile",!1),(0,Me.Z)((0,xt.Z)(a),"inited",!1),(0,Me.Z)((0,xt.Z)(a),"hooks",{init:new Gc}),(0,Me.Z)((0,xt.Z)(a),"parser",{type:"geojson"}),(0,Me.Z)((0,xt.Z)(a),"transforms",[]),(0,Me.Z)((0,xt.Z)(a),"cluster",!1),(0,Me.Z)((0,xt.Z)(a),"clusterOptions",{enable:!1,radius:40,maxZoom:20,zoom:-99,method:"count"}),(0,Me.Z)((0,xt.Z)(a),"invalidExtent",!1),(0,Me.Z)((0,xt.Z)(a),"dataArrayChanged",!1),(0,Me.Z)((0,xt.Z)(a),"cfg",{autoRender:!0}),a.originData=n,a.initCfg(r),a.init().then(function(){a.inited=!0,a.emit("update",{type:"inited"})}),a}return(0,be.Z)(t,[{key:"getSourceCfg",value:function(){return this.cfg}},{key:"getClusters",value:function(r){return this.clusterIndex.getClusters(this.caculClusterExtent(2),r)}},{key:"getClustersLeaves",value:function(r){return this.clusterIndex.getLeaves(r,1/0)}},{key:"getParserType",value:function(){return this.parser.type}},{key:"updateClusterData",value:function(r){var a=this,u=this.clusterOptions,c=u.method,g=c===void 0?"sum":c,x=u.field,M=this.clusterIndex.getClusters(this.caculClusterExtent(2),Math.floor(r));this.clusterOptions.zoom=r,M.forEach(function(O){O.id||(O.properties.point_count=1)}),(x||wy(g))&&(M=M.map(function(O){var B=O.id;if(B){var W=a.clusterIndex.getLeaves(B,1/0),ce=W.map(function(Ze){return Ze.properties}),oe;if(jb(g)&&x){var Te=Tl(ce,x);oe=Zb[g](Te)}wy(g)&&(oe=g(ce)),O.properties.stat=oe}else O.properties.point_count=1;return O})),this.data=F("geojson")({type:"FeatureCollection",features:M}),this.executeTrans()}},{key:"getFeatureById",value:function(r){var a=this.parser,u=a.type,c=u===void 0?"geojson":u,g=a.geometry;if(c==="geojson"&&!this.cluster){var x=r<this.originData.features.length?this.originData.features[r]:"null",M=Gb(x);if(M!=null&&M.properties&&(this.transforms.length!==0||this.dataArrayChanged)){var O=this.data.dataArray.find(function(B){return B._id===r});M.properties=O}return M}else return c==="json"&&g?this.data.dataArray.find(function(B){return B._id===r}):r<this.data.dataArray.length?this.data.dataArray[r]:"null"}},{key:"updateFeaturePropertiesById",value:function(r,a){this.data.dataArray=this.data.dataArray.map(function(u){return u._id===r?(0,X.Z)((0,X.Z)({},u),a):u}),this.dataArrayChanged=!0,this.emit("update",{type:"update"})}},{key:"getFeatureId",value:function(r,a){var u=this.data.dataArray.find(function(c){return c[r]===a});return u==null?void 0:u._id}},{key:"setData",value:function(r,a){var u=this;this.originData=r,this.dataArrayChanged=!1,this.initCfg(a),this.init().then(function(){u.emit("update",{type:"update"})})}},{key:"reloadAllTile",value:function(){var r;(r=this.tileset)===null||r===void 0||r.reloadAll()}},{key:"reloadTilebyId",value:function(r,a,u){var c;(c=this.tileset)===null||c===void 0||c.reloadTileById(r,a,u)}},{key:"reloadTileByLnglat",value:function(r,a,u){var c;(c=this.tileset)===null||c===void 0||c.reloadTileByLnglat(r,a,u)}},{key:"getTileExtent",value:function(r,a){var u;return(u=this.tileset)===null||u===void 0?void 0:u.getTileExtent(r,a)}},{key:"getTileByZXY",value:function(r,a,u){var c;return(c=this.tileset)===null||c===void 0?void 0:c.getTileByZXY(r,a,u)}},{key:"reloadTileByExtent",value:function(r,a){var u;(u=this.tileset)===null||u===void 0||u.reloadTileByExtent(r,a)}},{key:"destroy",value:function(){var r;this.removeAllListeners(),this.originData=null,this.clusterIndex=null,this.data=null,(r=this.tileset)===null||r===void 0||r.destroy()}},{key:"processData",value:function(){var n=(0,ur.Z)(it().mark(function a(){var u=this;return it().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return g.abrupt("return",new Promise(function(x,M){try{u.excuteParser(),u.initCluster(),u.executeTrans(),x({})}catch(O){M(O)}}));case 1:case"end":return g.stop()}},a)}));function r(){return n.apply(this,arguments)}return r}()},{key:"initCfg",value:function(r){this.cfg=Vb(this.cfg,r,Hb);var a=this.cfg;a&&(a.parser&&(this.parser=a.parser),a.transforms&&(this.transforms=a.transforms),this.cluster=a.cluster||!1,a.clusterOptions&&(this.cluster=!0,this.clusterOptions=(0,X.Z)((0,X.Z)({},this.clusterOptions),a.clusterOptions)))}},{key:"init",value:function(){var n=(0,ur.Z)(it().mark(function a(){return it().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return this.inited=!1,c.next=3,this.processData();case 3:this.inited=!0;case 4:case"end":return c.stop()}},a,this)}));function r(){return n.apply(this,arguments)}return r}()},{key:"excuteParser",value:function(){var r=this.parser,a=r.type||"geojson",u=F(a);this.data=u(this.originData,r),this.tileset=this.initTileset(),!r.cancelExtent&&(this.extent=nu(this.data.dataArray),this.setCenter(this.extent),this.invalidExtent=this.extent[0]===this.extent[2]||this.extent[1]===this.extent[3])}},{key:"setCenter",value:function(r){this.center=[(r[0]+r[2])/2,(r[1]+r[3])/2],(isNaN(this.center[0])||isNaN(this.center[1]))&&(this.center=[108.92361111111111,34.54083333333333])}},{key:"initTileset",value:function(){var r=this.data.tilesetOptions;if(r){if(this.isTile=!0,this.tileset)return this.tileset.updateOptions(r),this.tileset;var a=new Ws((0,X.Z)({},r));return a}}},{key:"executeTrans",value:function(){var r=this,a=this.transforms;a.forEach(function(u){var c=u.type,g=q(c)(r.data,u);Object.assign(r.data,g)})}},{key:"initCluster",value:function(){if(this.cluster){var r=this.clusterOptions||{};this.clusterIndex=Sy(this.data,r)}}},{key:"caculClusterExtent",value:function(r){var a=[[-1/0,-1/0],[1/0,1/0]];return this.invalidExtent||(a=js(Ja(this.extent),r)),a[0].concat(a[1])}}]),t}(ha.EventEmitter);function Yb(e,i){var t=i.callback;return t&&(e.dataArray=e.dataArray.filter(t)),e}function Ty(e,i){var t=typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=Wb(e))||i&&e&&typeof e.length=="number"){t&&(e=t);var n=0,r=function(){};return{s:r,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(x){throw x},f:r}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var a=!0,u=!1,c;return{s:function(){t=t.call(e)},n:function(){var x=t.next();return a=x.done,x},e:function(x){u=!0,c=x},f:function(){try{!a&&t.return!=null&&t.return()}finally{if(u)throw c}}}}function Wb(e,i){if(e){if(typeof e=="string")return My(e,i);var t=Object.prototype.toString.call(e).slice(8,-1);if(t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set")return Array.from(e);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return My(e,i)}}function My(e,i){(i==null||i>e.length)&&(i=e.length);for(var t=0,n=new Array(i);t<i;t++)n[t]=e[t];return n}var ig=6378e3;function Xb(e,i){var t=e.dataArray,n=i.size,r=n===void 0?10:n,a=r/(2*Math.PI*ig)*(256<<20)/2,u=Qb(t,r),c=u.gridHash,g=u.gridOffset,x=eS(c,g,i);return{yOffset:a,xOffset:a,radius:a,type:"grid",dataArray:x}}function Qb(e,i){var t=1/0,n=-1/0,r,a=Ty(e),u;try{for(a.s();!(u=a.n()).done;){var c=u.value;r=c.coordinates[1],Number.isFinite(r)&&(t=r<t?r:t,n=r>n?r:n)}}catch(et){a.e(et)}finally{a.f()}var g=(t+n)/2,x=qb(i,g);if(x.xOffset<=0||x.yOffset<=0)return{gridHash:{},gridOffset:x};var M={},O=Ty(e),B;try{for(O.s();!(B=O.n()).done;){var W=B.value,ce=W.coordinates[1],oe=W.coordinates[0];if(Number.isFinite(ce)&&Number.isFinite(oe)){var Te=Math.floor((ce+90)/x.yOffset),Ze=Math.floor((oe+180)/x.xOffset),qe="".concat(Te,"-").concat(Ze);M[qe]=M[qe]||{count:0,points:[]},M[qe].count+=1,M[qe].points.push(W)}}}catch(et){O.e(et)}finally{O.f()}return{gridHash:M,gridOffset:x}}function qb(e,i){var t=Kb(e),n=Jb(i,e);return{yOffset:t,xOffset:n}}function Kb(e){return e/ig*(180/Math.PI)}function Jb(e,i){return i/ig*(180/Math.PI)/Math.cos(e*Math.PI/180)}function eS(e,i,t){return Object.keys(e).reduce(function(n,r,a){var u=r.split("-"),c=parseInt(u[0],10),g=parseInt(u[1],10),x={};if(t.field&&t.method){var M=Ls(e[r].points,t.field);x[t.method]=To[t.method](M)}return Object.assign(x,{_id:a,coordinates:ma([-180+i.xOffset*(g+.5),-90+i.yOffset*(c+.5)]),rawData:e[r].points,count:e[r].count}),n.push(x),n},[])}var nA=Math.PI/3,tS=[0,nA,2*nA,3*nA,4*nA,5*nA];function rS(e){return e[0]}function nS(e){return e[1]}function iS(){var e=0,i=0,t=1,n=1,r=rS,a=nS,u,c,g;function x(O){var B={},W=[],ce,oe=O.length;for(ce=0;ce<oe;++ce)if(!(isNaN(Ze=+r.call(null,Te=O[ce],ce,O))||isNaN(qe=+a.call(null,Te,ce,O)))){var Te,Ze,qe,et=Math.round(qe=qe/g),yt=Math.round(Ze=Ze/c-(et&1)/2),bt=qe-et;if(Math.abs(bt)*3>1){var Ot=Ze-yt,jt=yt+(Ze<yt?-1:1)/2,or=et+(qe<et?-1:1),ar=Ze-jt,Sr=qe-or;Ot*Ot+bt*bt>ar*ar+Sr*Sr&&(yt=jt+(et&1?1:-1)/2,et=or)}var dr=yt+"-"+et,jr=B[dr];jr?jr.push(Te):(W.push(jr=B[dr]=[Te]),jr.x=(yt+(et&1)/2)*c,jr.y=et*g)}return W}function M(O){var B=0,W=0;return tS.map(function(ce){var oe=Math.sin(ce)*O,Te=-Math.cos(ce)*O,Ze=oe-B,qe=Te-W;return B=oe,W=Te,[Ze,qe]})}return x.hexagon=function(O){return"m"+M(O==null?u:+O).join("l")+"z"},x.centers=function(){for(var O=[],B=Math.round(i/g),W=Math.round(e/c),ce=B*g;ce<n+u;ce+=g,++B)for(var oe=W*c+(B&1)*c/2;oe<t+c/2;oe+=c)O.push([oe,ce]);return O},x.mesh=function(){var O=M(u).slice(0,4).join("l");return x.centers().map(function(B){return"M"+B+"m"+O}).join("")},x.x=function(O){return arguments.length?(r=O,x):r},x.y=function(O){return arguments.length?(a=O,x):a},x.radius=function(O){return arguments.length?(u=+O,c=u*2*Math.sin(nA),g=u*1.5,x):u},x.size=function(O){return arguments.length?(e=i=0,t=+O[0],n=+O[1],x):[t-e,n-i]},x.extent=function(O){return arguments.length?(e=+O[0][0],i=+O[0][1],t=+O[1][0],n=+O[1][1],x):[[e,i],[t,n]]},x.radius(1)}var aS=6378e3;function oS(e,i){var t=e.dataArray,n=i.size,r=n===void 0?10:n,a=i.method,u=a===void 0?"sum":a,c=r/(2*Math.PI*aS)*(256<<20)/2,g=t.map(function(B){var W=ma(B.coordinates),ce=(0,vn.Z)(W,2),oe=ce[0],Te=ce[1];return(0,X.Z)((0,X.Z)({},B),{},{coordinates:[oe,Te]})}),x=iS().radius(c).x(function(B){return B.coordinates[0]}).y(function(B){return B.coordinates[1]}),M=x(g),O={dataArray:M.map(function(B,W){var ce;if(i.field&&u){var oe=Ls(B,i.field);B[u]=To[u](oe)}return ce={},(0,Me.Z)(ce,i.method,B[u]),(0,Me.Z)(ce,"count",B.length),(0,Me.Z)(ce,"rawData",B),(0,Me.Z)(ce,"coordinates",[B.x,B.y]),(0,Me.Z)(ce,"_id",W),ce}),radius:c,xOffset:c,yOffset:c,type:"hexagon"};return O}function sS(e,i){var t=i.sourceField,n=i.targetField,r=i.data,a={};return r.forEach(function(u){a[u[t]]=u}),e.dataArray=e.dataArray.map(function(u){var c=u[n];return(0,X.Z)((0,X.Z)({},u),a[c])}),e}function uS(e,i){var t=i.callback;return t&&(e.dataArray=e.dataArray.map(t)),e}z("rasterTile",Mb),z("mvt",ta),z("geojsonvt",Cn),z("testTile",Rb),z("geojson",cl),z("jsonTile",gr),z("image",Xn),z("csv",ll),z("json",ms),z("raster",Rn),z("rasterRgb",Pb),ee("cluster",Sy),ee("filter",Yb),ee("join",sS),ee("map",uS),ee("grid",Xb),ee("hexagon",oS);var Iy=$b;function lS(e){var i=cS();return function(){var n=(0,ue.Z)(e),r;if(i){var a=(0,ue.Z)(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return(0,ze.Z)(this,r)}}function cS(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var Py=function(e){(0,Ne.Z)(t,e);var i=lS(t);function t(n){var r;return(0,se.Z)(this,t),r=i.call(this),(0,Me.Z)((0,xt.Z)(r),"added",!1),(0,Me.Z)((0,xt.Z)(r),"eventHandle",function(a){r.polyfillEvent(a),r.emit(a.type,{target:a,data:r.markerOption.extData,lngLat:r.lngLat})}),r.markerOption=(0,X.Z)((0,X.Z)({},r.getDefault()),n),ui(["update","onMove","onMapClick"],(0,xt.Z)(r)),r.init(),r}return(0,be.Z)(t,[{key:"getMarkerLayerContainerSize",value:function(){}},{key:"getDefault",value:function(){return{element:void 0,anchor:It.BOTTOM,offsets:[0,0],color:"#5B8FF9",draggable:!1}}},{key:"addTo",value:function(r){this.scene=r,this.mapsService=r.get(Xt.IMapService),this.sceneSerive=r.get(Xt.ISceneService);var a=this.markerOption.element;return this.mapsService.getMarkerContainer().appendChild(a),this.registerMarkerEvent(a),this.mapsService.on("camerachange",this.update),this.update(),this.added=!0,this.emit("added"),this}},{key:"remove",value:function(){this.mapsService&&(this.mapsService.off("click",this.onMapClick),this.mapsService.off("move",this.update),this.mapsService.off("moveend",this.update),this.mapsService.off("camerachange",this.update)),this.unRegisterMarkerEvent(),this.removeAllListeners();var r=this.markerOption.element;return r&&Ro(r),this.popup&&this.popup.remove(),this}},{key:"setLnglat",value:function(r){return this.lngLat=r,Array.isArray(r)&&(this.lngLat={lng:r[0],lat:r[1]}),this.popup&&this.popup.setLnglat(this.lngLat),this.update(),this}},{key:"getLnglat",value:function(){return this.lngLat}},{key:"getElement",value:function(){return this.markerOption.element}},{key:"setElement",value:function(r){var a=this;if(!this.added)return this.once("added",function(){a.setElement(r)}),this;var u=this.markerOption.element;return u&&Ro(u),this.markerOption.element=r,this.init(),this.mapsService.getMarkerContainer().appendChild(r),this.registerMarkerEvent(r),this.update(),this}},{key:"openPopup",value:function(){var r=this;if(!this.added)return this.once("added",function(){r.openPopup()}),this;var a=this.popup;return a?(a.isOpen()||a.addTo(this.scene),this):this}},{key:"closePopup",value:function(){var r=this;this.added||this.once("added",function(){r.closePopup()});var a=this.popup;return a&&a.remove(),this}},{key:"setPopup",value:function(r){return this.popup=r,this.lngLat&&this.popup.setLnglat(this.lngLat),this}},{key:"togglePopup",value:function(){var r=this.popup;if(r)r.isOpen()?r.remove():r.addTo(this.scene);else return this;return this}},{key:"getPopup",value:function(){return this.popup}},{key:"getOffset",value:function(){return this.markerOption.offsets}},{key:"setDraggable",value:function(r){throw new Error("Method not implemented.")}},{key:"isDraggable",value:function(){return this.markerOption.draggable}},{key:"getExtData",value:function(){return this.markerOption.extData}},{key:"setExtData",value:function(r){this.markerOption.extData=r}},{key:"update",value:function(){if(this.mapsService){var r=this.markerOption,a=r.element,u=r.anchor;this.updatePosition(),_f(a,"".concat(wt[u]))}}},{key:"onMapClick",value:function(r){var a=this.markerOption.element;this.popup&&a&&this.togglePopup()}},{key:"getCurrentContainerSize",value:function(){var r=this.mapsService.getContainer();return{containerHeight:(r==null?void 0:r.scrollHeight)||0,containerWidth:(r==null?void 0:r.scrollWidth)||0,bounds:this.mapsService.getBounds()}}},{key:"updatePosition",value:function(){if(this.mapsService){var r=this.markerOption,a=r.element,u=r.offsets,c=this.lngLat,g=c.lng,x=c.lat,M=this.mapsService.lngLatToContainer([g,x]);if(a){a.style.display="block",a.style.whiteSpace="nowrap";var O=this.getMarkerLayerContainerSize()||this.getCurrentContainerSize(),B=O.containerHeight,W=O.containerWidth,ce=O.bounds;if(!ce)return;if(Math.abs(ce[0][0])>180||Math.abs(ce[1][0])>180){if(M.x>W){var oe=this.mapsService.lngLatToContainer([g-360,x]);M.x=oe.x}if(M.x<0){var Te=this.mapsService.lngLatToContainer([g+360,x]);M.x=Te.x}}(M.x>W||M.x<0||M.y>B||M.y<0)&&(a.style.display="none"),a.style.left=M.x+u[0]+"px",a.style.top=M.y-u[1]+"px"}}}},{key:"init",value:function(){var r=this,a=this.markerOption.element,u=this.markerOption,c=u.color,g=u.anchor;if(!a){this.defaultMarker=!0,a=ni("div"),this.markerOption.element=a;var x=document.createElementNS("http://www.w3.org/2000/svg","svg");x.setAttributeNS(null,"display","block"),x.setAttributeNS(null,"height","48px"),x.setAttributeNS(null,"width","48px"),x.setAttributeNS(null,"viewBox","0 0 1024 1024");var M=document.createElementNS("http://www.w3.org/2000/svg","path");M.setAttributeNS(null,"d","M512 490.666667C453.12 490.666667 405.333333 442.88 405.333333 384 405.333333 325.12 453.12 277.333333 512 277.333333 570.88 277.333333 618.666667 325.12 618.666667 384 618.666667 442.88 570.88 490.666667 512 490.666667M512 85.333333C346.88 85.333333 213.333333 218.88 213.333333 384 213.333333 608 512 938.666667 512 938.666667 512 938.666667 810.666667 608 810.666667 384 810.666667 218.88 677.12 85.333333 512 85.333333Z"),M.setAttributeNS(null,"fill",c),x.appendChild(M),a.appendChild(x)}Ha(a,"l7-marker"),Object.keys(this.markerOption.style||{}).forEach(function(O){var B,W,ce=((B=r.markerOption)===null||B===void 0?void 0:B.style)&&((W=r.markerOption)===null||W===void 0?void 0:W.style[O]);a&&(a.style[O]=ce)}),mr(a,g,"marker")}},{key:"registerMarkerEvent",value:function(r){r.addEventListener("click",this.onMapClick),r.addEventListener("mousemove",this.eventHandle),r.addEventListener("click",this.eventHandle),r.addEventListener("mousedown",this.eventHandle),r.addEventListener("mouseup",this.eventHandle),r.addEventListener("dblclick",this.eventHandle),r.addEventListener("contextmenu",this.eventHandle),r.addEventListener("mouseover",this.eventHandle),r.addEventListener("mouseout",this.eventHandle),r.addEventListener("touchstart",this.eventHandle),r.addEventListener("touchend",this.eventHandle)}},{key:"unRegisterMarkerEvent",value:function(){var r=this.getElement();r.removeEventListener("click",this.onMapClick),r.removeEventListener("mousemove",this.eventHandle),r.removeEventListener("click",this.eventHandle),r.removeEventListener("mousedown",this.eventHandle),r.removeEventListener("mouseup",this.eventHandle),r.removeEventListener("dblclick",this.eventHandle),r.removeEventListener("contextmenu",this.eventHandle),r.removeEventListener("mouseover",this.eventHandle),r.removeEventListener("mouseout",this.eventHandle),r.removeEventListener("touchstart",this.eventHandle),r.removeEventListener("touchend",this.eventHandle)}},{key:"polyfillEvent",value:function(r){!this.mapsService||this.mapsService.version!=="GAODE2.x"||Nf()||(r.type==="touchstart"&&(this.touchStartTime=Date.now()),r.type==="touchend"&&Date.now()-this.touchStartTime<300&&this.emit("click",{target:r,data:this.markerOption.extData,lngLat:this.lngLat}))}},{key:"addDragHandler",value:function(r){return null}},{key:"onUp",value:function(r){throw new Error("Method not implemented.")}}]),t}(ha.EventEmitter);function fS(e){var i=hS();return function(){var n=(0,ue.Z)(e),r;if(i){var a=(0,ue.Z)(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return(0,ze.Z)(this,r)}}function hS(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var AS=In.merge,pS=function(e){(0,Ne.Z)(t,e);var i=fS(t);function t(n){var r,a;return(0,se.Z)(this,t),a=i.call(this),(0,Me.Z)((0,xt.Z)(a),"markers",[]),(0,Me.Z)((0,xt.Z)(a),"points",[]),(0,Me.Z)((0,xt.Z)(a),"clusterMarkers",[]),a.markerLayerOption=AS(a.getDefault(),n),ui(["update"],(0,xt.Z)(a)),a.zoom=((r=a.markerLayerOption.clusterOption)===null||r===void 0?void 0:r.zoom)||-99,a}return(0,be.Z)(t,[{key:"getDefault",value:function(){return{cluster:!1,clusterOption:{radius:80,maxZoom:20,minZoom:0,zoom:-99,style:{},className:""}}}},{key:"addTo",value:function(r){return this.scene=r,this.mapsService=r.get(Xt.IMapService),this.markerLayerOption.cluster&&(this.initCluster(),this.update(),this.mapsService.on("camerachange",this.update),this.mapsService.on("viewchange",this.update)),this.mapsService.on("camerachange",this.setContainerSize.bind(this)),this.mapsService.on("viewchange",this.setContainerSize.bind(this)),this.addMarkers(),this.inited=!0,this}},{key:"setContainerSize",value:function(){if(this.mapsService){var r=this.mapsService.getContainer();this.containerSize={containerWidth:(r==null?void 0:r.scrollWidth)||0,containerHeight:(r==null?void 0:r.scrollHeight)||0,bounds:this.mapsService.getBounds()}}}},{key:"getContainerSize",value:function(){return this.containerSize}},{key:"addMarker",value:function(r){var a=this.markerLayerOption.cluster;if(r.getMarkerLayerContainerSize=this.getContainerSize.bind(this),a&&(this.addPoint(r,this.markers.length),this.mapsService)){var u=this.mapsService.getZoom(),c=this.mapsService.getBounds();this.bbox=js(c,.5),this.zoom=Math.floor(u),this.getClusterMarker(this.bbox,this.zoom)}this.markers.push(r)}},{key:"removeMarker",value:function(r){this.markers.indexOf(r);var a=this.markers.indexOf(r);a>-1&&this.markers.splice(a,1)}},{key:"hide",value:function(){this.markers.map(function(r){r.getElement().style.opacity="0"}),this.clusterMarkers.map(function(r){r.getElement().style.opacity="0"})}},{key:"show",value:function(){this.markers.map(function(r){r.getElement().style.opacity="1"}),this.clusterMarkers.map(function(r){r.getElement().style.opacity="1"})}},{key:"getMarkers",value:function(){var r=this.markerLayerOption.cluster;return r?this.clusterMarkers:this.markers}},{key:"addMarkers",value:function(){var r=this;this.getMarkers().forEach(function(a){a.addTo(r.scene)})}},{key:"clear",value:function(){this.markers.forEach(function(r){r.remove()}),this.clusterMarkers.forEach(function(r){r.remove()}),this.markers=[],this.points=[],this.clusterMarkers=[]}},{key:"destroy",value:function(){this.clear(),this.removeAllListeners(),this.mapsService.off("camerachange",this.update),this.mapsService.off("viewchange",this.update),this.mapsService.off("camerachange",this.setContainerSize.bind(this)),this.mapsService.off("viewchange",this.setContainerSize.bind(this))}},{key:"addPoint",value:function(r,a){var u=r.getLnglat(),c=u.lng,g=u.lat,x={geometry:{type:"Point",coordinates:[c,g]},properties:(0,X.Z)((0,X.Z)({},r.getExtData()),{},{marker_id:a})};this.points.push(x),this.clusterIndex&&this.clusterIndex.load(this.points)}},{key:"initCluster",value:function(){if(this.markerLayerOption.cluster){var r=this.markerLayerOption.clusterOption,a=r.radius,u=r.minZoom,c=u===void 0?0:u,g=r.maxZoom;this.clusterIndex=new(by())({radius:a,minZoom:c,maxZoom:g}),this.clusterIndex.load(this.points)}}},{key:"getClusterMarker",value:function(r,a){var u=this,c=r[0].concat(r[1]),g=this.clusterIndex.getClusters(c,a);this.clusterMarkers.forEach(function(x){x.remove()}),this.clusterMarkers=[],g.forEach(function(x){var M,O=u.markerLayerOption.clusterOption,B=O.field,W=O.method;if((M=x.properties)!==null&&M!==void 0&&M.cluster_id){var ce,oe=u.getLeaves((ce=x.properties)===null||ce===void 0?void 0:ce.cluster_id);if(x.properties.clusterData=oe,B&&W){var Te=oe==null?void 0:oe.map(function(bt){var Ot=(0,Me.Z)({},B,bt.properties[B]);return Ot}),Ze=Ls(Te,B),qe=za(W,Ze),et="point_"+W;x.properties[et]=qe.toFixed(2)}}var yt=u.clusterMarker(x);u.clusterMarkers.push(yt),yt.addTo(u.scene)})}},{key:"getLeaves",value:function(r){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1/0,u=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;return r?this.clusterIndex.getLeaves(r,a,u):null}},{key:"clusterMarker",value:function(r){var a=this.markerLayerOption.clusterOption,u=a,c=u.element,g=c===void 0?this.generateElement.bind(this):c,x=new Py({element:g(r)}).setLnglat({lng:r.geometry.coordinates[0],lat:r.geometry.coordinates[1]});return x}},{key:"normalMarker",value:function(r){var a=r.properties.marker_id;return this.markers[a]}},{key:"update",value:function(){if(this.mapsService&&this.markers.length!==0){var r=this.mapsService.getZoom(),a=this.mapsService.getBounds();(!this.bbox||Math.abs(r-this.zoom)>=1||!Zr(this.bbox,a))&&(this.bbox=js(a,.5),this.zoom=Math.floor(r),this.getClusterMarker(this.bbox,this.zoom))}}},{key:"generateElement",value:function(r){var a=ni("div","l7-marker-cluster"),u=ni("div","",a),c=ni("span","",u),g=this.markerLayerOption.clusterOption,x=g.field,M=g.method;r.properties.point_count=r.properties.point_count||1;var O=x&&M?r.properties["point_"+M]||r.properties[x]:r.properties.point_count;return c.textContent=O,a}}]),t}(ha.EventEmitter),CP=C(4157);function dS(e){var i=vS();return function(){var n=(0,ue.Z)(e),r;if(i){var a=(0,ue.Z)(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return(0,ze.Z)(this,r)}}function vS(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var Ly=function(e){(0,Ne.Z)(t,e);var i=dS(t);function t(n){var r;return(0,se.Z)(this,t),r=i.call(this),t.controlCount++,r.controlOption=(0,X.Z)((0,X.Z)({},r.getDefault(n)),n||{}),r}return(0,be.Z)(t,[{key:"getOptions",value:function(){return this.controlOption}},{key:"setOptions",value:function(r){var a=this.getDefault(r);Object.entries(r).forEach(function(u){var c=(0,vn.Z)(u,2),g=c[0],x=c[1];x===void 0&&(r[g]=a[g])}),"position"in r&&this.setPosition(r.position),"className"in r&&this.setClassName(r.className),"style"in r&&this.setStyle(r.style),this.controlOption=(0,X.Z)((0,X.Z)({},this.controlOption),r)}},{key:"addTo",value:function(r){this.mapsService=r.get(Xt.IMapService),this.renderService=r.get(Xt.IRendererService),this.layerService=r.get(Xt.ILayerService),this.controlService=r.get(Xt.IControlService),this.configService=r.get(Xt.IGlobalConfigService),this.scene=r.get(Xt.ISceneService),this.sceneContainer=r,this.isShow=!0,this.container=this.onAdd(),Ha(this.container,"l7-control");var a=this.controlOption,u=a.className,c=a.style;return u&&this.setClassName(u),c&&this.setStyle(c),this.insertContainer(),this.emit("add",this),this}},{key:"remove",value:function(){if(!this.mapsService)return this;Ro(this.container),this.onRemove(),this.emit("remove",this)}},{key:"onAdd",value:function(){return ni("div")}},{key:"onRemove",value:function(){}},{key:"show",value:function(){var r=this.container;Ra(r,"l7-control--hide"),this.isShow=!0,this.emit("show",this)}},{key:"hide",value:function(){var r=this.container;Ha(r,"l7-control--hide"),this.isShow=!1,this.emit("hide",this)}},{key:"getDefault",value:function(r){return{position:Dh.TOPRIGHT,name:"".concat(t.controlCount)}}},{key:"getContainer",value:function(){return this.container}},{key:"getIsShow",value:function(){return this.isShow}},{key:"_refocusOnMap",value:function(r){if(this.mapsService&&r&&r.screenX>0&&r.screenY>0){var a=this.mapsService.getContainer();a!==null&&a.focus()}}},{key:"setPosition",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Dh.TOPLEFT,a=this.controlService;return a&&a.removeControl(this),this.controlOption.position=r,a&&a.addControl(this,this.sceneContainer),this}},{key:"setClassName",value:function(r){var a=this.container,u=this.controlOption.className;u&&Ra(a,u),r&&Ha(a,r)}},{key:"setStyle",value:function(r){var a=this.container;r?a.setAttribute("style",r):a.removeAttribute("style")}},{key:"insertContainer",value:function(){var r=this.controlOption.position,a=this.container;if(r instanceof Element)r.appendChild(a);else{var u=this.controlService.controlCorners[r];["bottomleft","bottomright","righttop","rightbottom"].includes(r)?u.insertBefore(a,u.firstChild):u.appendChild(a)}}},{key:"checkUpdateOption",value:function(r,a){return a.some(function(u){return u in r})}}]),t}(Ys());(0,Me.Z)(Ly,"controlCount",0);function wP(e){var i=gS();return function(){var n=_getPrototypeOf(e),r;if(i){var a=_getPrototypeOf(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return _possibleConstructorReturn(this,r)}}function gS(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var TP=null;function mS(e){var i=yS();return function(){var n=(0,ue.Z)(e),r;if(i){var a=(0,ue.Z)(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return(0,ze.Z)(this,r)}}function yS(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var _S=function(e){(0,Ne.Z)(t,e);var i=mS(t);function t(n,r){var a;return(0,se.Z)(this,t),a=i.call(this),(0,Me.Z)((0,xt.Z)(a),"isShow",!1),(0,Me.Z)((0,xt.Z)(a),"timeout",null),(0,Me.Z)((0,xt.Z)(a),"show",function(){return a.isShow||!a.contentDOM.innerHTML||(a.resetPopperPosition(),Ra(a.popperDOM,"l7-popper-hide"),a.isShow=!0,a.option.unique&&t.conflictPopperList.forEach(function(u){u!==(0,xt.Z)(a)&&u.isShow&&u.hide()}),a.emit("show"),window.addEventListener("pointerdown",a.onPopperUnClick)),(0,xt.Z)(a)}),(0,Me.Z)((0,xt.Z)(a),"hide",function(){return a.isShow&&(Ha(a.popperDOM,"l7-popper-hide"),a.isShow=!1,a.emit("hide"),window.removeEventListener("pointerdown",a.onPopperUnClick)),(0,xt.Z)(a)}),(0,Me.Z)((0,xt.Z)(a),"setHideTimeout",function(){a.timeout||(a.timeout=window.setTimeout(function(){a.isShow&&(a.hide(),a.timeout=null)},300))}),(0,Me.Z)((0,xt.Z)(a),"clearHideTimeout",function(){a.timeout&&(window.clearTimeout(a.timeout),a.timeout=null)}),(0,Me.Z)((0,xt.Z)(a),"onBtnClick",function(){a.isShow?a.hide():a.show()}),(0,Me.Z)((0,xt.Z)(a),"onPopperUnClick",function(u){gc(u.target,[".l7-button-control",".l7-popper-content"])||a.hide()}),(0,Me.Z)((0,xt.Z)(a),"onBtnMouseLeave",function(){a.setHideTimeout()}),(0,Me.Z)((0,xt.Z)(a),"onBtnMouseMove",function(){a.clearHideTimeout(),!a.isShow&&a.show()}),a.button=n,a.option=r,a.init(),r.unique&&t.conflictPopperList.push((0,xt.Z)(a)),a}return(0,be.Z)(t,[{key:"buttonRect",get:function(){return this.button.getBoundingClientRect()}},{key:"getPopperDOM",value:function(){return this.popperDOM}},{key:"getIsShow",value:function(){return this.isShow}},{key:"getContent",value:function(){return this.content}},{key:"setContent",value:function(r){typeof r=="string"?this.contentDOM.innerHTML=r:r instanceof HTMLElement&&(Ka(this.contentDOM),this.contentDOM.appendChild(r)),this.content=r}},{key:"init",value:function(){var r=this.option.trigger;this.popperDOM=this.createPopper(),r==="click"?this.button.addEventListener("click",this.onBtnClick):(this.button.addEventListener("mousemove",this.onBtnMouseMove),this.button.addEventListener("mouseleave",this.onBtnMouseLeave),this.popperDOM.addEventListener("mousemove",this.onBtnMouseMove),this.popperDOM.addEventListener("mouseleave",this.onBtnMouseLeave))}},{key:"destroy",value:function(){this.button.removeEventListener("click",this.onBtnClick),this.button.removeEventListener("mousemove",this.onBtnMouseMove),this.button.removeEventListener("mousemove",this.onBtnMouseLeave),this.popperDOM.removeEventListener("mousemove",this.onBtnMouseMove),this.popperDOM.removeEventListener("mouseleave",this.onBtnMouseLeave),Ro(this.popperDOM)}},{key:"resetPopperPosition",value:function(){var r={},a=this.option,u=a.container,c=a.offset,g=c===void 0?[0,0]:c,x=a.placement,M=(0,vn.Z)(g,2),O=M[0],B=M[1],W=this.button.getBoundingClientRect(),ce=u.getBoundingClientRect(),oe=vl(W,ce),Te=oe.left,Ze=oe.right,qe=oe.top,et=oe.bottom,yt=!1,bt=!1;/^(left|right)/.test(x)?(x.includes("left")?r.right="".concat(W.width+Ze,"px"):x.includes("right")&&(r.left="".concat(W.width+Te,"px")),x.includes("start")?r.top="".concat(qe,"px"):x.includes("end")?r.bottom="".concat(et,"px"):(r.top="".concat(qe+W.height/2,"px"),bt=!0,r.transform="translate(".concat(O,"px, calc(").concat(B,"px - 50%))"))):/^(top|bottom)/.test(x)&&(x.includes("top")?r.bottom="".concat(W.height+et,"px"):x.includes("bottom")&&(r.top="".concat(W.height+qe,"px")),x.includes("start")?r.left="".concat(Te,"px"):x.includes("end")?r.right="".concat(Ze,"px"):(r.left="".concat(Te+W.width/2,"px"),yt=!0,r.transform="translate(calc(".concat(O,"px - 50%), ").concat(B,"px)"))),r.transform="translate(calc(".concat(O,"px - ").concat(yt?"50%":"0%","), calc(").concat(B,"px - ").concat(bt?"50%":"0%",")");var Ot=x.split("-");Ot.length&&Ha(this.popperDOM,Ot.map(function(jt){return"l7-popper-".concat(jt)}).join(" ")),is(this.popperDOM,Sn(r))}},{key:"createPopper",value:function(){var r=this.option,a=r.container,u=r.className,c=u===void 0?"":u,g=r.content,x=ni("div","l7-popper l7-popper-hide ".concat(c)),M=ni("div","l7-popper-content"),O=ni("div","l7-popper-arrow");return x.appendChild(M),x.appendChild(O),a.appendChild(x),this.popperDOM=x,this.contentDOM=M,g&&this.setContent(g),x}}]),t}(ha.EventEmitter);(0,Me.Z)(_S,"conflictPopperList",[]);function MP(e){var i=xS();return function(){var n=_getPrototypeOf(e),r;if(i){var a=_getPrototypeOf(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return _possibleConstructorReturn(this,r)}}function xS(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var IP={topleft:"right-start",topcenter:"bottom",topright:"left-start",bottomleft:"right-end",bottomcenter:"top",bottomright:"left-end",lefttop:"bottom-start",leftcenter:"right",leftbottom:"top-start",righttop:"bottom-end",rightcenter:"left",rightbottom:"top-end"},PP=null;function LP(e){var i=ES();return function(){var n=_getPrototypeOf(e),r;if(i){var a=_getPrototypeOf(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return _possibleConstructorReturn(this,r)}}function ES(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var bS=function(e){return e.ActiveOptionClassName="l7-select-control-item-active",e.OptionValueAttrKey="data-option-value",e.OptionIndexAttrKey="data-option-index",e}(bS||{}),OP=null,RP=function(i){var t=document.createElementNS("http://www.w3.org/2000/svg","svg");t.classList.add("l7-iconfont"),t.setAttribute("aria-hidden","true");var n=document.createElementNS("http://www.w3.org/2000/svg","use");return n.setAttributeNS("http://www.w3.org/1999/xlink","href","#".concat(i)),t.appendChild(n),t};function DP(e){var i=SS();return function(){var n=_getPrototypeOf(e),r;if(i){var a=_getPrototypeOf(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return _possibleConstructorReturn(this,r)}}function SS(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var kP=null;function CS(e,i){var t=typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=wS(e))||i&&e&&typeof e.length=="number"){t&&(e=t);var n=0,r=function(){};return{s:r,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(x){throw x},f:r}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var a=!0,u=!1,c;return{s:function(){t=t.call(e)},n:function(){var x=t.next();return a=x.done,x},e:function(x){u=!0,c=x},f:function(){try{!a&&t.return!=null&&t.return()}finally{if(u)throw c}}}}function wS(e,i){if(e){if(typeof e=="string")return Oy(e,i);var t=Object.prototype.toString.call(e).slice(8,-1);if(t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set")return Array.from(e);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return Oy(e,i)}}function Oy(e,i){(i==null||i>e.length)&&(i=e.length);for(var t=0,n=new Array(i);t<i;t++)n[t]=e[t];return n}var Ry=[["requestFullscreen","exitFullscreen","fullscreenElement","fullscreenEnabled","fullscreenchange","fullscreenerror"],["webkitRequestFullscreen","webkitExitFullscreen","webkitFullscreenElement","webkitFullscreenEnabled","webkitfullscreenchange","webkitfullscreenerror"],["webkitRequestFullScreen","webkitCancelFullScreen","webkitCurrentFullScreenElement","webkitCancelFullScreen","webkitfullscreenchange","webkitfullscreenerror"],["mozRequestFullScreen","mozCancelFullScreen","mozFullScreenElement","mozFullScreenEnabled","mozfullscreenchange","mozfullscreenerror"],["msRequestFullscreen","msExitFullscreen","msFullscreenElement","msFullscreenEnabled","MSFullscreenChange","MSFullscreenError"]],r0=function(){if(typeof document=="undefined")return!1;for(var e=Ry[0],i={},t=0,n=Ry;t<n.length;t++){var r=n[t],a=r==null?void 0:r[1];if(a in document){var u=CS(r.entries()),c;try{for(u.s();!(c=u.n()).done;){var g=(0,vn.Z)(c.value,2),x=g[0],M=g[1];i[e[x]]=M}}catch(O){u.e(O)}finally{u.f()}return i}}return!1}(),Dy={change:r0.fullscreenchange,error:r0.fullscreenerror},Vc={request:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document.documentElement,t=arguments.length>1?arguments[1]:void 0;return new Promise(function(n,r){var a=function c(){Vc.off("change",c),n()};Vc.on("change",a);var u=i[r0.requestFullscreen](t);u instanceof Promise&&u.then(a).catch(r)})},exit:function(){return new Promise(function(i,t){if(!Vc.isFullscreen){i();return}var n=function a(){Vc.off("change",a),i()};Vc.on("change",n);var r=document[r0.exitFullscreen]();r instanceof Promise&&r.then(n).catch(t)})},toggle:function(i,t){return Vc.isFullscreen?Vc.exit():Vc.request(i,t)},onchange:function(i){Vc.on("change",i)},onerror:function(i){Vc.on("error",i)},on:function(i,t){var n=Dy[i];n&&document.addEventListener(n,t,!1)},off:function(i,t){var n=Dy[i];n&&document.removeEventListener(n,t,!1)},raw:r0};Object.defineProperties(Vc,{isFullscreen:{get:function(){return!!document[r0.fullscreenElement]}},element:{enumerable:!0,get:function(){var i;return(i=document[r0.fullscreenElement])!==null&&i!==void 0?i:void 0}},isEnabled:{enumerable:!0,get:function(){return!!document[r0.fullscreenEnabled]}}}),r0||(Vc={isEnabled:!1});var NP=null;function FP(e){var i=TS();return function(){var n=_getPrototypeOf(e),r;if(i){var a=_getPrototypeOf(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return _possibleConstructorReturn(this,r)}}function TS(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var BP=null;function ZP(e){var i=MS();return function(){var n=_getPrototypeOf(e),r;if(i){var a=_getPrototypeOf(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return _possibleConstructorReturn(this,r)}}function MS(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var zP=null;function UP(e){var i=IS();return function(){var n=_getPrototypeOf(e),r;if(i){var a=_getPrototypeOf(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return _possibleConstructorReturn(this,r)}}function IS(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}function GP(e){return e&&e.layer}var jP=null;function PS(e){var i=LS();return function(){var n=(0,ue.Z)(e),r;if(i){var a=(0,ue.Z)(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return(0,ze.Z)(this,r)}}function LS(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var OS=function(e){(0,Ne.Z)(t,e);var i=PS(t);function t(){return(0,se.Z)(this,t),i.apply(this,arguments)}return(0,be.Z)(t,[{key:"getDefault",value:function(){return{position:Dh.BOTTOMLEFT,name:"logo",href:"https://l7.antv.antgroup.com/",img:"https://gw.alipayobjects.com/mdn/rms_816329/afts/img/A*GRb1TKp4HcMAAAAAAAAAAAAAARQnAQ"}}},{key:"onAdd",value:function(){var r=ni("div","l7-control-logo");return this.setLogoContent(r),r}},{key:"onRemove",value:function(){return null}},{key:"setOptions",value:function(r){D0((0,ue.Z)(t.prototype),"setOptions",this).call(this,r),this.checkUpdateOption(r,["img","href"])&&(Ka(this.container),this.setLogoContent(this.container))}},{key:"setLogoContent",value:function(r){var a=this.controlOption,u=a.href,c=a.img,g=ni("img");if(g.setAttribute("src",c),g.setAttribute("aria-label","AntV logo"),fs(g),u){var x=ni("a","l7-control-logo-link");x.target="_blank",x.href=u,x.rel="noopener nofollow",x.setAttribute("rel","noopener nofollow"),x.appendChild(g),r.appendChild(x)}else r.appendChild(g)}}]),t}(Ly),VP={normal:{text:"\u6807\u51C6",img:"https://mdn.alipayobjects.com/huamei_qa8qxu/afts/img/A*qdFDSbvIalgAAAAAAAAAAAAADmJ7AQ/original"},light:{text:"\u6708\u5149\u94F6",img:"https://mdn.alipayobjects.com/huamei_qa8qxu/afts/img/A*d-vcRLzu8WIAAAAAAAAAAAAADmJ7AQ/original"},dark:{text:"\u5E7B\u5F71\u9ED1",img:"https://mdn.alipayobjects.com/huamei_qa8qxu/afts/img/A*HMbRTI3XnpIAAAAAAAAAAAAADmJ7AQ/original"},fresh:{text:"\u8349\u8272\u9752",img:"https://mdn.alipayobjects.com/huamei_qa8qxu/afts/img/A*kqaGQ5kjSiAAAAAAAAAAAAAADmJ7AQ/original"},grey:{text:"\u96C5\u58EB\u7070",img:"https://mdn.alipayobjects.com/huamei_qa8qxu/afts/img/A*XegrTpZIbqAAAAAAAAAAAAAADmJ7AQ/original"},graffiti:{text:"\u6D82\u9E26",img:"https://mdn.alipayobjects.com/huamei_qa8qxu/afts/img/A*G5g9SZ_Jg4cAAAAAAAAAAAAADmJ7AQ/original"},macaron:{text:"\u9A6C\u5361\u9F99",img:"https://mdn.alipayobjects.com/huamei_qa8qxu/afts/img/A*irVvQbDpQMwAAAAAAAAAAAAADmJ7AQ/original"},darkblue:{text:"\u6781\u591C\u84DD",img:"https://mdn.alipayobjects.com/huamei_qa8qxu/afts/img/A*lKRzQYB4iR0AAAAAAAAAAAAADmJ7AQ/original"},wine:{text:"\u9171\u7C7D",img:"https://mdn.alipayobjects.com/huamei_qa8qxu/afts/img/A*orY0T7QL-lwAAAAAAAAAAAAADmJ7AQ/original"}},HP={normal:{text:"\u6807\u51C6",img:"https://mdn.alipayobjects.com/huamei_qa8qxu/afts/img/A*kIyZTok4Uk0AAAAAAAAAAAAADmJ7AQ/original"},light:{text:"\u4EAE",img:"https://mdn.alipayobjects.com/huamei_qa8qxu/afts/img/A*Z3JRQKDI-cIAAAAAAAAAAAAADmJ7AQ/original"},dark:{text:"\u6697",img:"https://mdn.alipayobjects.com/huamei_qa8qxu/afts/img/A*d7HCQbfmyaoAAAAAAAAAAAAADmJ7AQ/original"},satellite:{text:"\u536B\u661F",img:"https://mdn.alipayobjects.com/huamei_qa8qxu/afts/img/A*TytUT6pS9okAAAAAAAAAAAAADmJ7AQ/original"},outdoors:{text:"\u6237\u5916",img:"https://mdn.alipayobjects.com/huamei_qa8qxu/afts/img/A*hWwFSYJEFWsAAAAAAAAAAAAADmJ7AQ/original"}};function $P(e){var i=RS();return function(){var n=_getPrototypeOf(e),r;if(i){var a=_getPrototypeOf(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return _possibleConstructorReturn(this,r)}}function RS(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var YP=null;function WP(e){var i=DS();return function(){var n=_getPrototypeOf(e),r;if(i){var a=_getPrototypeOf(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return _possibleConstructorReturn(this,r)}}function DS(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var XP=null;function QP(e){var i=kS();return function(){var n=_getPrototypeOf(e),r;if(i){var a=_getPrototypeOf(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return _possibleConstructorReturn(this,r)}}function kS(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var qP=null;function KP(e){var i=NS();return function(){var n=_getPrototypeOf(e),r;if(i){var a=_getPrototypeOf(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return _possibleConstructorReturn(this,r)}}function NS(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var JP=null;function eL(e){var i=FS();return function(){var n=_getPrototypeOf(e),r;if(i){var a=_getPrototypeOf(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return _possibleConstructorReturn(this,r)}}function FS(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var tL=null;function rL(e){var i=BS();return function(){var n=_getPrototypeOf(e),r;if(i){var a=_getPrototypeOf(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return _possibleConstructorReturn(this,r)}}function BS(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var nL=In.get,iL=null;function ZS(e,i){var t=typeof my!="undefined"&&!!my&&typeof my.showToast=="function"&&my.isFRM!==!0,n=typeof wx!="undefined"&&wx!==null&&(typeof wx.request!="undefined"||typeof wx.miniProgram!="undefined");if(!(t||n)&&(i||(i=document),!!i)){var r=i.head||i.getElementsByTagName("head")[0];if(!r){r=i.createElement("head");var a=i.body||i.getElementsByTagName("body")[0];a?a.parentNode.insertBefore(r,a):i.documentElement.appendChild(r)}var u=i.createElement("style");return u.type="text/css",u.styleSheet?u.styleSheet.cssText=e:u.appendChild(i.createTextNode(e)),r.appendChild(u),u}}ZS(`.l7-marker-container {
  position: absolute;
  width: 100%;
  height: 100%;
  overflow: hidden;
}
.l7-marker {
  position: absolute !important;
  top: 0;
  left: 0;
  z-index: 5;
  cursor: pointer;
}
.l7-marker-cluster {
  width: 40px;
  height: 40px;
  background-color: rgba(181, 226, 140, 0.6);
  background-clip: padding-box;
  border-radius: 20px;
}
.l7-marker-cluster div {
  width: 30px;
  height: 30px;
  margin-top: 5px;
  margin-left: 5px;
  font: 12px 'Helvetica Neue', Arial, Helvetica, sans-serif;
  text-align: center;
  background-color: rgba(110, 204, 57, 0.6);
  border-radius: 15px;
}
.l7-marker-cluster span {
  line-height: 30px;
}
.l7-touch .l7-control-attribution,
.l7-touch .l7-control-layers,
.l7-touch .l7-bar {
  -webkit-box-shadow: none;
          box-shadow: none;
}
.l7-touch .l7-control-layers,
.l7-touch .l7-bar {
  background-clip: padding-box;
  border: 2px solid rgba(0, 0, 0, 0.2);
}
.mapboxgl-ctrl-logo,
.amap-logo {
  display: none !important;
}
.l7-select-box {
  border: 3px dashed gray;
  border-radius: 2px;
  position: absolute;
  z-index: 999;
  -webkit-box-sizing: border-box;
          box-sizing: border-box;
}
.l7-control-container {
  font: 12px/1.5 'Helvetica Neue', Arial, Helvetica, sans-serif;
}
.l7-control-container .l7-control {
  position: relative;
  z-index: 999;
  float: left;
  clear: both;
  color: #595959;
  font-size: 12px;
  pointer-events: visiblePainted;
  /* IE 9-10 doesn't have auto */
  pointer-events: auto;
}
.l7-control-container .l7-control.l7-control--hide {
  display: none;
}
.l7-control-container .l7-top {
  top: 0;
  display: -webkit-box;
  display: -ms-flexbox;
  display: flex;
  position: absolute;
  z-index: 999;
  pointer-events: none;
}
.l7-control-container .l7-top .l7-control:not(.l7-control--hide) {
  margin-top: 8px;
}
.l7-control-container .l7-right {
  right: 0;
  display: -webkit-box;
  display: -ms-flexbox;
  display: flex;
  position: absolute;
  z-index: 999;
  pointer-events: none;
}
.l7-control-container .l7-right .l7-control:not(.l7-control--hide) {
  margin-right: 8px;
}
.l7-control-container .l7-bottom {
  bottom: 0;
  display: -webkit-box;
  display: -ms-flexbox;
  display: flex;
  position: absolute;
  z-index: 999;
  pointer-events: none;
}
.l7-control-container .l7-bottom .l7-control:not(.l7-control--hide) {
  margin-bottom: 8px;
}
.l7-control-container .l7-left {
  left: 0;
  display: -webkit-box;
  display: -ms-flexbox;
  display: flex;
  position: absolute;
  z-index: 999;
  pointer-events: none;
}
.l7-control-container .l7-left .l7-control:not(.l7-control--hide) {
  margin-left: 8px;
}
.l7-control-container .l7-center {
  position: absolute;
  display: -webkit-box;
  display: -ms-flexbox;
  display: flex;
  -webkit-box-pack: center;
      -ms-flex-pack: center;
          justify-content: center;
}
.l7-control-container .l7-center.l7-top,
.l7-control-container .l7-center.l7-bottom {
  width: 100%;
}
.l7-control-container .l7-center.l7-left,
.l7-control-container .l7-center.l7-right {
  height: 100%;
}
.l7-control-container .l7-center .l7-control {
  margin-right: 8px;
  margin-bottom: 8px;
}
.l7-control-container .l7-row {
  -webkit-box-orient: horizontal;
  -webkit-box-direction: normal;
      -ms-flex-direction: row;
          flex-direction: row;
}
.l7-control-container .l7-row.l7-top {
  -webkit-box-align: start;
      -ms-flex-align: start;
          align-items: flex-start;
}
.l7-control-container .l7-row.l7-bottom {
  -webkit-box-align: end;
      -ms-flex-align: end;
          align-items: flex-end;
}
.l7-control-container .l7-column {
  -webkit-box-orient: vertical;
  -webkit-box-direction: normal;
      -ms-flex-direction: column;
          flex-direction: column;
}
.l7-control-container .l7-column.l7-left {
  -webkit-box-align: start;
      -ms-flex-align: start;
          align-items: flex-start;
}
.l7-control-container .l7-column.l7-right {
  -webkit-box-align: end;
      -ms-flex-align: end;
          align-items: flex-end;
}
.l7-button-control {
  min-width: 28px;
  height: 28px;
  background-color: #fff;
  border-width: 0;
  border-radius: 2px;
  outline: 0;
  cursor: pointer;
  -webkit-transition: all 0.2s;
  transition: all 0.2s;
  display: -webkit-box;
  display: -ms-flexbox;
  display: flex;
  -webkit-box-pack: center;
      -ms-flex-pack: center;
          justify-content: center;
  -webkit-box-align: center;
      -ms-flex-align: center;
          align-items: center;
  padding: 0 6px;
  -webkit-box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.15);
          box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.15);
  line-height: 16px;
}
.l7-button-control .l7-iconfont {
  fill: #595959;
  color: #595959;
  width: 16px;
  height: 16px;
}
.l7-button-control.l7-button-control--row {
  padding: 0 16px 0 13px;
}
.l7-button-control.l7-button-control--row * + .l7-button-control__text {
  margin-left: 8px;
}
.l7-button-control.l7-button-control--column {
  height: 44px;
  -webkit-box-orient: vertical;
  -webkit-box-direction: normal;
      -ms-flex-direction: column;
          flex-direction: column;
}
.l7-button-control.l7-button-control--column .l7-iconfont {
  margin-top: 3px;
}
.l7-button-control.l7-button-control--column .l7-button-control__text {
  margin-top: 3px;
  font-size: 10px;
  -webkit-transform: scale(0.83333);
          transform: scale(0.83333);
}
.l7-button-control:not(:disabled):hover {
  background-color: #f3f3f3;
}
.l7-button-control:not(:disabled):active {
  background-color: #f3f3f3;
}
.l7-button-control:disabled {
  background-color: #fafafa;
  color: #bdbdbd;
  cursor: not-allowed;
}
.l7-button-control:disabled .l7-iconfont {
  fill: #bdbdbd;
  color: #bdbdbd;
}
.l7-button-control:disabled:hover {
  background-color: #fafafa;
}
.l7-button-control:disabled:active {
  background-color: #fafafa;
}
.l7-popper {
  position: absolute;
  display: -webkit-box;
  display: -ms-flexbox;
  display: flex;
  -webkit-box-pack: center;
      -ms-flex-pack: center;
          justify-content: center;
  -webkit-box-align: center;
      -ms-flex-align: center;
          align-items: center;
  z-index: 5;
  color: #595959;
}
.l7-popper.l7-popper-hide {
  display: none;
}
.l7-popper .l7-popper-content {
  min-height: 28px;
  background: #fff;
  border-radius: 2px;
  -webkit-box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.15);
          box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.15);
}
.l7-popper .l7-popper-arrow {
  width: 0;
  height: 0;
  border-width: 4px;
  border-style: solid;
  border-top-color: transparent;
  border-bottom-color: transparent;
  border-left-color: transparent;
  border-right-color: transparent;
  -webkit-box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.15);
          box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.15);
}
.l7-popper.l7-popper-left {
  -webkit-box-orient: horizontal;
  -webkit-box-direction: normal;
      -ms-flex-direction: row;
          flex-direction: row;
}
.l7-popper.l7-popper-left .l7-popper-arrow {
  border-left-color: #fff;
  margin: 10px 0;
}
.l7-popper.l7-popper-right {
  -webkit-box-orient: horizontal;
  -webkit-box-direction: reverse;
      -ms-flex-direction: row-reverse;
          flex-direction: row-reverse;
}
.l7-popper.l7-popper-right .l7-popper-arrow {
  border-right-color: #fff;
  margin: 10px 0;
}
.l7-popper.l7-popper-top {
  -webkit-box-orient: vertical;
  -webkit-box-direction: normal;
      -ms-flex-direction: column;
          flex-direction: column;
}
.l7-popper.l7-popper-top .l7-popper-arrow {
  border-top-color: #fff;
  margin: 0 10px;
}
.l7-popper.l7-popper-bottom {
  -webkit-box-orient: vertical;
  -webkit-box-direction: reverse;
      -ms-flex-direction: column-reverse;
          flex-direction: column-reverse;
}
.l7-popper.l7-popper-bottom .l7-popper-arrow {
  border-bottom-color: #fff;
  margin: 0 10px;
}
.l7-popper.l7-popper-start {
  -webkit-box-align: start;
      -ms-flex-align: start;
          align-items: flex-start;
}
.l7-popper.l7-popper-end {
  -webkit-box-align: end;
      -ms-flex-align: end;
          align-items: flex-end;
}
.l7-select-control--normal {
  padding: 4px 0;
}
.l7-select-control--normal .l7-select-control-item {
  height: 24px;
  line-height: 24px;
  display: -webkit-box;
  display: -ms-flexbox;
  display: flex;
  -webkit-box-align: center;
      -ms-flex-align: center;
          align-items: center;
  padding: 0 16px;
  font-size: 12px;
}
.l7-select-control--normal .l7-select-control-item > * + * {
  margin-left: 6px;
}
.l7-select-control--normal .l7-select-control-item input[type='checkbox'] {
  height: 14px;
  width: 14px;
}
.l7-select-control--normal .l7-select-control-item:hover {
  background-color: #f3f3f3;
}
.l7-select-control--image {
  padding: 12px 12px 0 12px;
  width: 474px;
  height: 320px;
  overflow: auto;
  display: -webkit-box;
  display: -ms-flexbox;
  display: flex;
  -ms-flex-wrap: wrap;
      flex-wrap: wrap;
  -webkit-box-sizing: border-box;
          box-sizing: border-box;
  -webkit-box-align: start;
      -ms-flex-align: start;
          align-items: flex-start;
}
.l7-select-control--image .l7-select-control-item {
  margin-right: 12px;
  border-radius: 2px;
  overflow: hidden;
  border: 1px solid #fff;
  -webkit-box-sizing: content-box;
          box-sizing: content-box;
  width: calc((100% - 36px) / 3);
  display: -webkit-box;
  display: -ms-flexbox;
  display: flex;
  -webkit-box-orient: vertical;
  -webkit-box-direction: normal;
      -ms-flex-direction: column;
          flex-direction: column;
  -webkit-box-pack: center;
      -ms-flex-pack: center;
          justify-content: center;
  margin-bottom: 12px;
  position: relative;
  font-size: 12px;
}
.l7-select-control--image .l7-select-control-item img {
  width: 142px;
  height: 80px;
}
.l7-select-control--image .l7-select-control-item input[type='checkbox'] {
  position: absolute;
  right: 0;
  top: 0;
}
.l7-select-control--image .l7-select-control-item .l7-select-control-item-row {
  display: -webkit-box;
  display: -ms-flexbox;
  display: flex;
  -webkit-box-pack: center;
      -ms-flex-pack: center;
          justify-content: center;
  -webkit-box-align: center;
      -ms-flex-align: center;
          align-items: center;
  line-height: 26px;
}
.l7-select-control--image .l7-select-control-item .l7-select-control-item-row > * + * {
  margin-left: 8px;
}
.l7-select-control--image .l7-select-control-item.l7-select-control-item-active {
  border-color: #0370fe;
}
.l7-select-control--image .l7-select-control-item:nth-child(3n) {
  margin-right: 0;
}
.l7-select-control-item {
  cursor: pointer;
}
.l7-select-control-item input[type='checkbox'] {
  margin: 0;
  cursor: pointer;
}
.l7-select-control--multiple .l7-select-control-item:hover {
  background-color: transparent;
}
.l7-control-logo {
  width: 89px;
  height: 16px;
  -webkit-user-select: none;
     -moz-user-select: none;
      -ms-user-select: none;
          user-select: none;
}
.l7-control-logo img {
  height: 100%;
  width: 100%;
}
.l7-control-logo .l7-control-logo-link {
  display: block;
  cursor: pointer;
}
.l7-control-logo .l7-control-logo-link img {
  cursor: pointer;
}
.l7-control-mouse-location {
  background-color: #fff;
  border-radius: 2px;
  -webkit-box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.15);
          box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.15);
  padding: 2px 4px;
  min-width: 130px;
}
.l7-control-zoom {
  overflow: hidden;
  border-radius: 2px;
  -webkit-box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.15);
          box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.15);
}
.l7-control-zoom .l7-button-control {
  font-size: 16px;
  border-bottom: 1px solid #f0f0f0;
  border-radius: 0;
  -webkit-box-shadow: 0 0 0;
          box-shadow: 0 0 0;
}
.l7-control-zoom .l7-button-control .l7-iconfont {
  width: 14px;
  height: 14px;
}
.l7-control-zoom .l7-button-control:last-child {
  border-bottom: 0;
}
.l7-control-zoom .l7-control-zoom__number {
  color: #595959;
  padding: 0;
}
.l7-control-zoom .l7-control-zoom__number:hover {
  background-color: #fff;
}
.l7-control-scale {
  display: -webkit-box;
  display: -ms-flexbox;
  display: flex;
  -webkit-box-orient: vertical;
  -webkit-box-direction: normal;
      -ms-flex-direction: column;
          flex-direction: column;
}
.l7-control-scale .l7-control-scale-line {
  -webkit-box-sizing: border-box;
          box-sizing: border-box;
  padding: 2px 5px 1px;
  overflow: hidden;
  color: #595959;
  font-size: 10px;
  line-height: 1.1;
  white-space: nowrap;
  background: #fff;
  border: 2px solid #000;
  border-top: 0;
  -webkit-transition: width 0.1s;
  transition: width 0.1s;
}
.l7-control-scale .l7-control-scale-line + .l7-control-scale .l7-control-scale-line {
  margin-top: -2px;
  border-top: 2px solid #777;
  border-bottom: none;
}
.l7-right .l7-control-scale {
  display: -webkit-box;
  display: -ms-flexbox;
  display: flex;
  -webkit-box-align: end;
      -ms-flex-align: end;
          align-items: flex-end;
}
.l7-right .l7-control-scale .l7-control-scale-line {
  text-align: right;
}
.l7-popup {
  position: absolute;
  top: 0;
  left: 0;
  z-index: 5;
  display: -webkit-box;
  display: -ms-flexbox;
  display: flex;
  will-change: transform;
  pointer-events: none;
}
.l7-popup.l7-popup-hide {
  display: none;
}
.l7-popup .l7-popup-content {
  position: relative;
  padding: 16px;
  font-size: 14px;
  background: #fff;
  border-radius: 3px;
  -webkit-box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
          box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
}
.l7-popup .l7-popup-content .l7-popup-content__title {
  margin-bottom: 8px;
  font-weight: bold;
}
.l7-popup .l7-popup-content .l7-popup-close-button,
.l7-popup .l7-popup-content .l7-popup-content__title,
.l7-popup .l7-popup-content .l7-popup-content__panel {
  white-space: normal;
  -webkit-user-select: text;
     -moz-user-select: text;
      -ms-user-select: text;
          user-select: text;
  pointer-events: initial;
}
.l7-popup .l7-popup-content .l7-popup-close-button {
  position: absolute;
  top: 0;
  right: 0;
  width: 18px;
  height: 18px;
  padding: 0;
  font-size: 14px;
  line-height: 18px;
  text-align: center;
  background-color: transparent;
  border: 0;
  border-radius: 0 3px 0 0;
  cursor: pointer;
}
.l7-popup .l7-popup-tip {
  position: relative;
  z-index: 1;
  width: 0;
  height: 0;
  border: 10px solid transparent;
}
.l7-popup.l7-popup-anchor-bottom,
.l7-popup.l7-popup-anchor-bottom-left,
.l7-popup.l7-popup-anchor-bottom-right {
  -webkit-box-orient: vertical;
  -webkit-box-direction: reverse;
      -ms-flex-direction: column-reverse;
          flex-direction: column-reverse;
}
.l7-popup.l7-popup-anchor-bottom .l7-popup-tip,
.l7-popup.l7-popup-anchor-bottom-left .l7-popup-tip,
.l7-popup.l7-popup-anchor-bottom-right .l7-popup-tip {
  bottom: 1px;
}
.l7-popup.l7-popup-anchor-top,
.l7-popup.l7-popup-anchor-top-left,
.l7-popup.l7-popup-anchor-top-right {
  -webkit-box-orient: vertical;
  -webkit-box-direction: normal;
      -ms-flex-direction: column;
          flex-direction: column;
}
.l7-popup.l7-popup-anchor-top .l7-popup-tip,
.l7-popup.l7-popup-anchor-top-left .l7-popup-tip,
.l7-popup.l7-popup-anchor-top-right .l7-popup-tip {
  top: 1px;
}
.l7-popup.l7-popup-anchor-left {
  -webkit-box-orient: horizontal;
  -webkit-box-direction: normal;
      -ms-flex-direction: row;
          flex-direction: row;
}
.l7-popup.l7-popup-anchor-right {
  -webkit-box-orient: horizontal;
  -webkit-box-direction: reverse;
      -ms-flex-direction: row-reverse;
          flex-direction: row-reverse;
}
.l7-popup-anchor-top .l7-popup-tip {
  position: relative;
  -webkit-align-self: center;
  -ms-flex-item-align: center;
      align-self: center;
  border-top: none;
  border-bottom-color: #fff;
}
.l7-popup-anchor-top-left .l7-popup-tip {
  -webkit-align-self: flex-start;
  -ms-flex-item-align: start;
      align-self: flex-start;
  border-top: none;
  border-bottom-color: #fff;
  border-left: none;
}
.l7-popup-anchor-top-right .l7-popup-tip {
  -webkit-align-self: flex-end;
  -ms-flex-item-align: end;
      align-self: flex-end;
  border-top: none;
  border-right: none;
  border-bottom-color: #fff;
}
.l7-popup-anchor-bottom .l7-popup-tip {
  -webkit-align-self: center;
  -ms-flex-item-align: center;
      align-self: center;
  border-top-color: #fff;
  border-bottom: none;
}
.l7-popup-anchor-bottom-left .l7-popup-tip {
  -webkit-align-self: flex-start;
  -ms-flex-item-align: start;
      align-self: flex-start;
  border-top-color: #fff;
  border-bottom: none;
  border-left: none;
}
.l7-popup-anchor-bottom-right .l7-popup-tip {
  -webkit-align-self: flex-end;
  -ms-flex-item-align: end;
      align-self: flex-end;
  border-top-color: #fff;
  border-right: none;
  border-bottom: none;
}
.l7-popup-anchor-left .l7-popup-tip {
  -webkit-align-self: center;
  -ms-flex-item-align: center;
      align-self: center;
  border-right-color: #fff;
  border-left: none;
}
.l7-popup-anchor-right .l7-popup-tip {
  right: 1px;
  -webkit-align-self: center;
  -ms-flex-item-align: center;
      align-self: center;
  border-right: none;
  border-left-color: #fff;
}
.l7-popup-anchor-top-left .l7-popup-content {
  border-top-left-radius: 0;
}
.l7-popup-anchor-top-right .l7-popup-content {
  border-top-right-radius: 0;
}
.l7-popup-anchor-bottom-left .l7-popup-content {
  border-bottom-left-radius: 0;
}
.l7-popup-anchor-bottom-right .l7-popup-content {
  border-bottom-right-radius: 0;
}
.l7-popup-track-pointer {
  display: none;
}
.l7-popup-track-pointer * {
  -webkit-user-select: none;
     -moz-user-select: none;
      -ms-user-select: none;
          user-select: none;
  pointer-events: none;
}
.l7-map:hover .l7-popup-track-pointer {
  display: -webkit-box;
  display: -ms-flexbox;
  display: flex;
}
.l7-map:active .l7-popup-track-pointer {
  display: none;
}
.l7-layer-popup__row {
  font-size: 12px;
}
.l7-layer-popup__row + .l7-layer-popup__row {
  margin-top: 4px;
}
`);var k0,ky=(k0={},(0,Me.Z)(k0,pf.additive,{enable:!0,func:{srcRGB:je.ONE,dstRGB:je.ONE,srcAlpha:1,dstAlpha:1}}),(0,Me.Z)(k0,pf.none,{enable:!1}),(0,Me.Z)(k0,pf.normal,{enable:!0,func:{srcRGB:je.SRC_ALPHA,dstRGB:je.ONE_MINUS_SRC_ALPHA,srcAlpha:1,dstAlpha:1}}),(0,Me.Z)(k0,pf.subtractive,{enable:!0,func:{srcRGB:je.ONE,dstRGB:je.ONE,srcAlpha:je.ZERO,dstAlpha:je.ONE_MINUS_SRC_COLOR},equation:{rgb:je.FUNC_SUBTRACT,alpha:je.FUNC_SUBTRACT}}),(0,Me.Z)(k0,pf.max,{enable:!0,func:{srcRGB:je.ONE,dstRGB:je.ONE},equation:{rgb:je.MAX_EXT}}),(0,Me.Z)(k0,pf.min,{enable:!0,func:{srcRGB:je.ONE,dstRGB:je.ONE},equation:{rgb:je.MIN_EXT}}),k0);function Ny(e){return e.map(function(i){return typeof i=="string"&&(i=[i,{}]),i})}function Fy(e,i,t,n){var r=e.multiPassRenderer,a=e.getLayerConfig(),u=a.enableTAA;return u?r.add(n("taa")):r.add(n("render")),Ny(i).forEach(function(c){var g=(0,vn.Z)(c,2),x=g[0],M=g[1];r.add(t(x),M)}),r.add(t("copy")),r}var zS=function(){function e(i){(0,se.Z)(this,e),this.layer=i}return(0,be.Z)(e,[{key:"pickRender",value:function(t){var n=this.layer.getContainer(),r=n.get(Xt.ILayerService),a=this.layer;if(a.tileLayer)return a.tileLayer.pickRender(t);a.hooks.beforePickingEncode.call(),r.renderTileLayerMask(a),a.renderModels({ispick:!0}),a.hooks.afterPickingEncode.call()}},{key:"pick",value:function(t,n){var r=this.layer.getContainer(),a=r.get(Xt.IPickingService);return t.type==="RasterLayer"?this.pickRasterLayer(t,n):(this.pickRender(n),a.pickFromPickingFBO(t,n))}},{key:"pickRasterLayer",value:function(t,n,r){var a=this.layer.getContainer(),u=a.get(Xt.IPickingService),c=a.get(Xt.IMapService),g=this.layer.getSource().extent,x=ml(n.lngLat,g),M={x:n.x,y:n.y,type:n.type,lngLat:n.lngLat,target:n,rasterValue:null},O=r||t;if(x){var B=this.readRasterValue(t,g,c,n.x,n.y);return M.rasterValue=B,u.triggerHoverOnLayer(O,M),!0}else return M.type=n.type==="mousemove"?"mouseout":"un"+n.type,u.triggerHoverOnLayer(O,(0,X.Z)((0,X.Z)({},M),{},{type:"unpick"})),u.triggerHoverOnLayer(O,M),!1}},{key:"readRasterValue",value:function(t,n,r,a,u){var c=t.getSource().data.dataArray[0],g=(0,vn.Z)(n,4),x=g[0],M=x===void 0?0:x,O=g[1],B=O===void 0?0:O,W=g[2],ce=W===void 0?10:W,oe=g[3],Te=oe===void 0?-10:oe,Ze=r.lngLatToContainer([M,B]),qe=r.lngLatToContainer([ce,Te]),et=qe.x-Ze.x,yt=Ze.y-qe.y,bt=[(a-Ze.x)/et,(u-qe.y)/yt],Ot=c.width||1,jt=c.height||1,or=Math.floor(bt[0]*Ot),ar=Math.floor(bt[1]*jt),Sr=Math.max(0,ar-1)*Ot+or,dr=c.data[Sr];return dr}},{key:"selectFeature",value:function(t){var n=this.layer,r=(0,vn.Z)(t,3),a=r[0],u=r[1],c=r[2];n.hooks.beforeSelect.call([a,u,c])}},{key:"highlightPickedFeature",value:function(t){var n=(0,vn.Z)(t,3),r=n[0],a=n[1],u=n[2];this.layer.hooks.beforeHighlight.call([r,a,u])}},{key:"getFeatureById",value:function(t){return this.layer.getSource().getFeatureById(t)}}]),e}(),US=function(){function e(i){(0,se.Z)(this,e),this.layer=i;var t=this.layer.getContainer();this.rendererService=t.get(Xt.IRendererService)}return(0,be.Z)(e,[{key:"getColorTexture",value:function(t,n){var r=this.getTextureKey(t,n);return this.key===r?this.colorTexture:(this.createColorTexture(t,n),this.key=r,this.colorTexture)}},{key:"createColorTexture",value:function(t,n){var r=this.rendererService.createTexture2D,a=this.getColorRampBar(t,n),u=r({data:new Uint8Array(a.data),width:a.width,height:a.height,flipY:!1});return this.colorTexture=u,u}},{key:"setColorTexture",value:function(t,n,r){this.key=this.getTextureKey(n,r),this.colorTexture=t}},{key:"destroy",value:function(){var t;(t=this.colorTexture)===null||t===void 0||t.destroy()}},{key:"getColorRampBar",value:function(t,n){switch(t.type){case"cat":return Ca(t);case"quantize":return xa(t);case"custom":return Ku(t,n);case"linear":return Ru(t,n);default:return $o(t)}}},{key:"getTextureKey",value:function(t,n){var r;return"".concat(t.colors.join("_"),"_").concat(t==null||(r=t.positions)===null||r===void 0?void 0:r.join("_"),"_").concat(t.type,"_").concat(n==null?void 0:n.join("_"))}}]),e}(),GS=["passes"],jS=["moduleName","vertexShader","fragmentShader","inject","triangulation","styleOption"],By,ag,Zy;function VS(e,i){var t=typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=HS(e))||i&&e&&typeof e.length=="number"){t&&(e=t);var n=0,r=function(){};return{s:r,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(x){throw x},f:r}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var a=!0,u=!1,c;return{s:function(){t=t.call(e)},n:function(){var x=t.next();return a=x.done,x},e:function(x){u=!0,c=x},f:function(){try{!a&&t.return!=null&&t.return()}finally{if(u)throw c}}}}function HS(e,i){if(e){if(typeof e=="string")return zy(e,i);var t=Object.prototype.toString.call(e).slice(8,-1);if(t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set")return Array.from(e);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return zy(e,i)}}function zy(e,i){(i==null||i>e.length)&&(i=e.length);for(var t=0,n=new Array(i);t<i;t++)n[t]=e[t];return n}function $S(e){var i=YS();return function(){var n=(0,ue.Z)(e),r;if(i){var a=(0,ue.Z)(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return(0,ze.Z)(this,r)}}function YS(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var og=In.isEqual,Uy=In.isFunction,Gy=In.isNumber,Xu=In.isObject,WS=In.isPlainObject,XS=In.isUndefined,jy=0,iA=(By=rg(Xt.IGlobalConfigService),ag=function(e){(0,Ne.Z)(t,e);var i=$S(t);function t(){var n,r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return(0,se.Z)(this,t),n=i.call(this),(0,Me.Z)((0,xt.Z)(n),"id","".concat(jy++)),(0,Me.Z)((0,xt.Z)(n),"name","".concat(jy)),(0,Me.Z)((0,xt.Z)(n),"visible",!0),(0,Me.Z)((0,xt.Z)(n),"zIndex",0),(0,Me.Z)((0,xt.Z)(n),"inited",!1),(0,Me.Z)((0,xt.Z)(n),"layerModelNeedUpdate",!1),(0,Me.Z)((0,xt.Z)(n),"pickedFeatureID",null),(0,Me.Z)((0,xt.Z)(n),"selectedFeatureID",null),(0,Me.Z)((0,xt.Z)(n),"styleNeedUpdate",!1),(0,Me.Z)((0,xt.Z)(n),"forceRender",!1),(0,Me.Z)((0,xt.Z)(n),"clusterZoom",0),(0,Me.Z)((0,xt.Z)(n),"defaultSourceConfig",{data:[],options:{parser:{type:"json"}}}),(0,Me.Z)((0,xt.Z)(n),"dataState",{dataSourceNeedUpdate:!1,dataMappingNeedUpdate:!1,filterNeedUpdate:!1,featureScaleNeedUpdate:!1,StyleAttrNeedUpdate:!1}),(0,Me.Z)((0,xt.Z)(n),"hooks",{init:new Em,afterInit:new Yv,beforeRender:new Yv,beforeRenderData:new l,afterRender:new Gc,beforePickingEncode:new Gc,afterPickingEncode:new Gc,beforeHighlight:new Gc(["pickedColor"]),afterHighlight:new Gc,beforeSelect:new Gc(["pickedColor"]),afterSelect:new Gc,beforeDestroy:new Gc,afterDestroy:new Gc}),(0,Me.Z)((0,xt.Z)(n),"models",[]),(0,Me.Z)((0,xt.Z)(n),"startInit",!1),(0,Me.Z)((0,xt.Z)(n),"layerChildren",[]),(0,Me.Z)((0,xt.Z)(n),"masks",[]),Ki((0,xt.Z)(n),"configService",Zy,(0,xt.Z)(n)),(0,Me.Z)((0,xt.Z)(n),"animateOptions",{enable:!1}),(0,Me.Z)((0,xt.Z)(n),"currentPickId",null),(0,Me.Z)((0,xt.Z)(n),"encodeStyleAttribute",{}),(0,Me.Z)((0,xt.Z)(n),"enableShaderEncodeStyles",[]),(0,Me.Z)((0,xt.Z)(n),"enableDataEncodeStyles",[]),(0,Me.Z)((0,xt.Z)(n),"enablg",[]),(0,Me.Z)((0,xt.Z)(n),"pendingStyleAttributes",[]),(0,Me.Z)((0,xt.Z)(n),"scaleOptions",{}),(0,Me.Z)((0,xt.Z)(n),"animateStatus",!1),(0,Me.Z)((0,xt.Z)(n),"isDestroyed",!1),(0,Me.Z)((0,xt.Z)(n),"encodeDataLength",0),(0,Me.Z)((0,xt.Z)(n),"sourceEvent",function(){n.dataState.dataSourceNeedUpdate=!0;var a=n.getLayerConfig();a&&a.autoFit&&n.fitBounds(a.fitBoundsOptions);var u=n.layerSource.getSourceCfg().autoRender;u&&n.reRender()}),n.name=r.name||n.id,n.zIndex=r.zIndex||0,n.rawConfig=r,n}return(0,be.Z)(t,[{key:"addMask",value:function(r){this.masks.push(r),this.enableMask()}},{key:"removeMask",value:function(r){var a=this.masks.indexOf(r);a>-1&&this.masks.splice(a,1)}},{key:"disableMask",value:function(){this.updateLayerConfig({enableMask:!1})}},{key:"enableMask",value:function(){this.updateLayerConfig({enableMask:!0})}},{key:"addMaskLayer",value:function(r){this.masks.push(r)}},{key:"removeMaskLayer",value:function(r){var a=this.masks.indexOf(r);a>-1&&this.masks.splice(a,1),r.destroy()}},{key:"getAttribute",value:function(r){return this.styleAttributeService.getLayerStyleAttribute(r)}},{key:"getLayerConfig",value:function(){return this.configService.getLayerConfig(this.id)}},{key:"updateLayerConfig",value:function(r){var a=this;if(Object.keys(r).map(function(c){c in a.rawConfig&&(a.rawConfig[c]=r[c])}),!this.startInit)this.needUpdateConfig=(0,X.Z)((0,X.Z)({},this.needUpdateConfig),r);else{var u=this.container.get(Xt.SceneID);this.configService.setLayerConfig(u,this.id,(0,X.Z)((0,X.Z)((0,X.Z)({},this.configService.getLayerConfig(this.id)),this.needUpdateConfig),r)),this.needUpdateConfig={}}}},{key:"setContainer",value:function(r,a){this.container=r,this.sceneContainer=a}},{key:"getContainer",value:function(){return this.container}},{key:"addPlugin",value:function(r){return this.plugins.push(r),this}},{key:"init",value:function(){var n=(0,ur.Z)(it().mark(function a(){var u=this,c,g,x,M,O,B,W;return it().wrap(function(oe){for(;;)switch(oe.prev=oe.next){case 0:c=this.container.get(Xt.SceneID),this.startInit=!0,this.configService.setLayerConfig(c,this.id,this.rawConfig),this.layerType=this.rawConfig.layerType,this.iconService=this.container.get(Xt.IIconService),this.fontService=this.container.get(Xt.IFontService),this.rendererService=this.container.get(Xt.IRendererService),this.layerService=this.container.get(Xt.ILayerService),this.debugService=this.container.get(Xt.IDebugService),this.interactionService=this.container.get(Xt.IInteractionService),this.pickingService=this.container.get(Xt.IPickingService),this.mapService=this.container.get(Xt.IMapService),g=this.getLayerConfig(),x=g.enableMultiPassRenderer,M=g.passes,x&&M!==null&&M!==void 0&&M.length&&M.length>0&&this.mapService.on("mapAfterFrameChange",function(){u.renderLayers()}),this.cameraService=this.container.get(Xt.ICameraService),this.coordinateService=this.container.get(Xt.ICoordinateSystemService),this.shaderModuleService=this.container.get(Xt.IShaderModuleService),this.postProcessingPassFactory=this.container.get(Xt.IFactoryPostProcessingPass),this.normalPassFactory=this.container.get(Xt.IFactoryNormalPass),this.styleAttributeService=this.container.get(Xt.IStyleAttributeService),x&&(this.multiPassRenderer=this.container.get(Xt.IMultiPassRenderer),this.multiPassRenderer.setLayer(this)),this.pendingStyleAttributes.forEach(function(Te){var Ze=Te.attributeName,qe=Te.attributeField,et=Te.attributeValues,yt=Te.updateOptions;u.styleAttributeService.updateStyleAttribute(Ze,{scale:(0,X.Z)({field:qe},u.splitValuesAndCallbackInAttribute(et,qe?void 0:u.getLayerConfig()[Ze]))},yt)}),this.pendingStyleAttributes=[],this.plugins=this.container.getAll(Xt.ILayerPlugin),O=VS(this.plugins);try{for(O.s();!(B=O.n()).done;)W=B.value,W.apply(this,{rendererService:this.rendererService,mapService:this.mapService,styleAttributeService:this.styleAttributeService,normalPassFactory:this.normalPassFactory,postProcessingPassFactory:this.postProcessingPassFactory})}catch(Te){O.e(Te)}finally{O.f()}return this.layerPickService=new zS(this),this.textureService=new US(this),this.log(Js.LayerInitStart),oe.next=31,this.hooks.init.promise();case 31:this.log(Js.LayerInitEnd),this.inited=!0,this.emit("inited",{target:this,type:"inited"}),this.emit("add",{target:this,type:"add"}),this.hooks.afterInit.call();case 36:case"end":return oe.stop()}},a,this)}));function r(){return n.apply(this,arguments)}return r}()},{key:"log",value:function(r){var a,u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"init";if(!(this.tileLayer||this.isTileLayer)){var c="".concat(this.id,".").concat(u,".").concat(r),g={id:this.id,type:this.type};(a=this.debugService)===null||a===void 0||a.log(c,g)}}},{key:"updateModelData",value:function(r){r.attributes&&r.elements?this.models.map(function(a){a.updateAttributesAndElements(r.attributes,r.elements)}):console.warn("data error")}},{key:"setLayerPickService",value:function(r){this.layerPickService=r}},{key:"prepareBuildModel",value:function(){Object.keys(this.needUpdateConfig||{}).length!==0&&this.updateLayerConfig({});var r=this.getLayerConfig(),a=r.animateOption;a!=null&&a.enable&&(this.layerService.startAnimate(),this.animateStatus=!0)}},{key:"color",value:function(r,a,u){return this.updateStyleAttribute("color",r,a,u),this}},{key:"texture",value:function(r,a,u){return this.updateStyleAttribute("texture",r,a,u),this}},{key:"rotate",value:function(r,a,u){return this.updateStyleAttribute("rotate",r,a,u),this}},{key:"size",value:function(r,a,u){return this.updateStyleAttribute("size",r,a,u),this}},{key:"filter",value:function(r,a,u){var c=this.updateStyleAttribute("filter",r,a,u);return this.dataState.dataSourceNeedUpdate=c&&this.inited,this}},{key:"shape",value:function(r,a,u){this.shapeOption={field:r,values:a};var c=this.updateStyleAttribute("shape",r,a,u);return this.dataState.dataSourceNeedUpdate=c&&this.inited,this}},{key:"label",value:function(r,a,u){return this.pendingStyleAttributes.push({attributeName:"label",attributeField:r,attributeValues:a,updateOptions:u}),this}},{key:"animate",value:function(r){var a={};return Xu(r)?(a.enable=!0,a=(0,X.Z)((0,X.Z)({},a),r)):a.enable=r,this.updateLayerConfig({animateOption:a}),this}},{key:"source",value:function(r,a){return(r==null?void 0:r.type)==="source"?(this.setSource(r),this):(this.sourceOption={data:r,options:a},this.clusterZoom=0,this)}},{key:"setData",value:function(r,a){var u=this;return this.inited?(this.log(Js.SourceInitStart,us.UPDATE),this.layerSource.setData(r,a),this.log(Js.SourceInitEnd,us.UPDATE)):this.on("inited",function(){u.log(Js.SourceInitStart,us.UPDATE);var c=u.getSource();c?u.layerSource.setData(r,a):u.source(new Iy(r,a)),u.layerSource.once("update",function(){u.log(Js.SourceInitEnd,us.UPDATE)})}),this}},{key:"style",value:function(r){var a=this,u=r.passes,c=(0,Ac.Z)(r,GS);u&&Ny(u).forEach(function(x){var M=a.multiPassRenderer.getPostProcessor().getPostProcessingPassByName(x[0]);M&&M.updateOptions(x[1])}),c.borderColor&&(c.stroke=c.borderColor),c.borderWidth&&(c.strokeWidth=c.borderWidth);var g=c;return Object.keys(c).forEach(function(x){var M=c[x];Array.isArray(M)&&M.length===2&&!Gy(M[0])&&!Gy(M[1])&&(g[x]={field:M[0],value:M[1]})}),this.encodeStyle(g),this.updateLayerConfig(g),this}},{key:"encodeStyle",value:function(r){var a=this;Object.keys(r).forEach(function(u){[].concat((0,pr.Z)(a.enableShaderEncodeStyles),(0,pr.Z)(a.enableDataEncodeStyles)).includes(u)&&WS(r[u])&&(r[u].field||r[u].value)&&!og(a.encodeStyleAttribute[u],r[u])?(a.encodeStyleAttribute[u]=r[u],a.updateStyleAttribute(u,r[u].field,r[u].value),a.inited&&(a.dataState.dataMappingNeedUpdate=!0)):a.encodeStyleAttribute[u]&&(delete a.encodeStyleAttribute[u],a.dataState.dataSourceNeedUpdate=!0)})}},{key:"scale",value:function(r,a){var u=(0,X.Z)({},this.scaleOptions);if(Xu(r)?this.scaleOptions=(0,X.Z)((0,X.Z)({},this.scaleOptions),r):this.scaleOptions[r]=a,this.styleAttributeService&&!og(u,this.scaleOptions)){var c=Xu(r)?r:(0,Me.Z)({},r,a);this.styleAttributeService.updateScaleAttribute(c)}return this}},{key:"renderLayers",value:function(){this.rendering=!0,this.layerService.reRender(),this.rendering=!1}},{key:"render",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.tileLayer?(this.tileLayer.render(),this):(this.layerService.beforeRenderData(this),this.encodeDataLength<=0&&!this.forceRender?this:(this.renderModels(r),this))}},{key:"renderMultiPass",value:function(){var n=(0,ur.Z)(it().mark(function a(){return it().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:if(!(this.encodeDataLength<=0&&!this.forceRender)){c.next=2;break}return c.abrupt("return");case 2:if(!(this.multiPassRenderer&&this.multiPassRenderer.getRenderFlag())){c.next=7;break}return c.next=5,this.multiPassRenderer.render();case 5:c.next=8;break;case 7:this.multiPassRenderer?this.renderModels():this.renderModels();case 8:case"end":return c.stop()}},a,this)}));function r(){return n.apply(this,arguments)}return r}()},{key:"active",value:function(r){var a={};return a.enableHighlight=Xu(r)?!0:r,Xu(r)?(a.enableHighlight=!0,r.color&&(a.highlightColor=r.color),r.mix&&(a.activeMix=r.mix)):a.enableHighlight=!!r,this.updateLayerConfig(a),this}},{key:"setActive",value:function(r,a){var u=this;if(Xu(r)){var c=r.x,g=c===void 0?0:c,x=r.y,M=x===void 0?0:x;this.updateLayerConfig({highlightColor:Xu(a)?a.color:this.getLayerConfig().highlightColor,activeMix:Xu(a)?a.mix:this.getLayerConfig().activeMix}),this.pick({x:g,y:M})}else this.updateLayerConfig({pickedFeatureID:r,highlightColor:Xu(a)?a.color:this.getLayerConfig().highlightColor,activeMix:Xu(a)?a.mix:this.getLayerConfig().activeMix}),this.hooks.beforeHighlight.call(bs(r)).then(function(){setTimeout(function(){u.reRender()},1)})}},{key:"select",value:function(r){var a={};return a.enableSelect=Xu(r)?!0:r,Xu(r)?(a.enableSelect=!0,r.color&&(a.selectColor=r.color),r.mix&&(a.selectMix=r.mix)):a.enableSelect=!!r,this.updateLayerConfig(a),this}},{key:"setSelect",value:function(r,a){var u=this;if(Xu(r)){var c=r.x,g=c===void 0?0:c,x=r.y,M=x===void 0?0:x;this.updateLayerConfig({selectColor:Xu(a)?a.color:this.getLayerConfig().selectColor,selectMix:Xu(a)?a.mix:this.getLayerConfig().selectMix}),this.pick({x:g,y:M})}else this.updateLayerConfig({pickedFeatureID:r,selectColor:Xu(a)?a.color:this.getLayerConfig().selectColor,selectMix:Xu(a)?a.mix:this.getLayerConfig().selectMix}),this.hooks.beforeSelect.call(bs(r)).then(function(){setTimeout(function(){u.reRender()},1)})}},{key:"setBlend",value:function(r){return this.updateLayerConfig({blend:r}),this.reRender(),this}},{key:"show",value:function(){return this.updateLayerConfig({visible:!0}),this.reRender(),this.emit("show"),this}},{key:"hide",value:function(){return this.updateLayerConfig({visible:!1}),this.reRender(),this.emit("hide"),this}},{key:"setIndex",value:function(r){return this.zIndex=r,this.layerService.updateLayerRenderList(),this.layerService.renderLayers(),this}},{key:"setCurrentPickId",value:function(r){this.currentPickId=r}},{key:"getCurrentPickId",value:function(){return this.currentPickId}},{key:"setCurrentSelectedId",value:function(r){this.selectedFeatureID=r}},{key:"getCurrentSelectedId",value:function(){return this.selectedFeatureID}},{key:"isVisible",value:function(){var r=this.mapService.getZoom(),a=this.getLayerConfig(),u=a.visible,c=a.minZoom,g=c===void 0?-1/0:c,x=a.maxZoom,M=x===void 0?1/0:x;return!!u&&r>=g&&r<M}},{key:"setMultiPass",value:function(r,a){if(this.updateLayerConfig({enableMultiPassRenderer:r}),a&&this.updateLayerConfig({passes:a}),r){var u=this.getLayerConfig(),c=u.passes,g=c===void 0?[]:c;this.multiPassRenderer=Fy(this,g,this.postProcessingPassFactory,this.normalPassFactory),this.multiPassRenderer.setRenderFlag(!0);var x=this.rendererService.getViewportSize(),M=x.width,O=x.height;this.multiPassRenderer.resize(M,O)}return this}},{key:"setMinZoom",value:function(r){return this.updateLayerConfig({minZoom:r}),this}},{key:"getMinZoom",value:function(){var r=this.getLayerConfig(),a=r.minZoom;return a}},{key:"getMaxZoom",value:function(){var r=this.getLayerConfig(),a=r.maxZoom;return a}},{key:"get",value:function(r){var a=this.getLayerConfig();return a[r]}},{key:"setMaxZoom",value:function(r){return this.updateLayerConfig({maxZoom:r}),this}},{key:"setAutoFit",value:function(r){return this.updateLayerConfig({autoFit:r}),this}},{key:"fitBounds",value:function(r){if(!this.inited)return this.updateLayerConfig({autoFit:!0}),this;var a=this.getSource(),u=a.extent,c=u.some(function(g){return Math.abs(g)===1/0});return c?this:(this.mapService.fitBounds([[u[0],u[1]],[u[2],u[3]]],r),this)}},{key:"destroy",value:function(){var r,a,u,c,g=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(!this.isDestroyed){this.layerChildren.map(function(O){return O.destroy(!1)}),this.layerChildren=[];var x=this.getLayerConfig(),M=x.maskfence;M&&(this.masks.map(function(O){return O.destroy(!1)}),this.masks=[]),this.hooks.beforeDestroy.call(),this.layerSource.off("update",this.sourceEvent),(r=this.multiPassRenderer)===null||r===void 0||r.destroy(),this.textureService.destroy(),this.styleAttributeService.clearAllAttributes(),this.hooks.afterDestroy.call(),(a=this.layerModel)===null||a===void 0||a.clearModels(g),(u=this.tileLayer)===null||u===void 0||u.destroy(),this.models=[],(c=this.debugService)===null||c===void 0||c.removeLog(this.id),this.emit("remove",{target:this,type:"remove"}),this.emit("destroy",{target:this,type:"destroy"}),this.removeAllListeners(),this.isDestroyed=!0}}},{key:"clear",value:function(){this.styleAttributeService.clearAllAttributes()}},{key:"clearModels",value:function(){var r;this.models.forEach(function(a){return a.destroy()}),(r=this.layerModel)===null||r===void 0||r.clearModels(),this.models=[]}},{key:"isDirty",value:function(){return!!(this.styleAttributeService.getLayerStyleAttributes()||[]).filter(function(r){return r.needRescale||r.needRemapping||r.needRegenerateVertices}).length}},{key:"setSource",value:function(r){var a=this;if(this.layerSource&&this.layerSource.off("update",this.sourceEvent),this.layerSource=r,this.clusterZoom=0,this.inited&&this.layerSource.cluster){var u=this.mapService.getZoom();this.layerSource.updateClusterData(u)}this.layerSource.inited&&this.sourceEvent(),this.layerSource.on("update",function(c){var g=c.type;if(a.coordCenter===void 0){var x,M=a.layerSource.center;a.coordCenter=M,(x=a.mapService)!==null&&x!==void 0&&x.setCoordCenter&&a.mapService.setCoordCenter(M)}if(g==="update"){if(a.tileLayer){a.tileLayer.reload();return}a.sourceEvent()}})}},{key:"getSource",value:function(){return this.layerSource}},{key:"getScaleOptions",value:function(){return this.scaleOptions}},{key:"setEncodedData",value:function(r){this.encodedData=r,this.encodeDataLength=r.length}},{key:"getEncodedData",value:function(){return this.encodedData}},{key:"getScale",value:function(r){return this.styleAttributeService.getLayerAttributeScale(r)}},{key:"getLegend",value:function(r){var a,u,c,g=this.styleAttributeService.getLayerStyleAttribute(r),x=(g==null||(a=g.scale)===null||a===void 0?void 0:a.scalers)||[];return{type:(u=x[0].option)===null||u===void 0?void 0:u.type,field:g==null||(c=g.scale)===null||c===void 0?void 0:c.field,items:this.getLegendItems(r)}}},{key:"getLegendItems",value:function(r){var a=this.styleAttributeService.getLayerAttributeScale(r);if(!a)return[];if(a.invertExtent){var u=a.range().map(function(x){return(0,Me.Z)({value:a.invertExtent(x)},r,x)});return u}else if(a.ticks){var c=a.ticks().map(function(x){return(0,Me.Z)({value:x},r,a(x))});return c}else if(a!=null&&a.domain){var g=a.domain().filter(function(x){return!XS(x)}).map(function(x){return(0,Me.Z)({value:x},r,a(x))});return g}return[]}},{key:"pick",value:function(r){var a=r.x,u=r.y;this.interactionService.triggerHover({x:a,y:u})}},{key:"boxSelect",value:function(r,a){this.pickingService.boxPickLayer(this,r,a)}},{key:"buildLayerModel",value:function(){var n=(0,ur.Z)(it().mark(function a(u){var c=this,g,x,M,O,B,W,ce,oe,Te,Ze,qe,et;return it().wrap(function(bt){for(;;)switch(bt.prev=bt.next){case 0:return g=u.moduleName,x=u.vertexShader,M=u.fragmentShader,O=u.inject,B=u.triangulation,W=u.styleOption,ce=(0,Ac.Z)(u,jS),this.shaderModuleService.registerModule(g,{vs:x,fs:M,inject:O}),oe=this.shaderModuleService.getModule(g),Te=oe.vs,Ze=oe.fs,qe=oe.uniforms,et=this.rendererService.createModel,bt.abrupt("return",new Promise(function(Ot){var jt=c.styleAttributeService.createAttributesAndIndices(c.encodedData,B,W),or=jt.attributes,ar=jt.elements,Sr=jt.count,dr=(0,X.Z)({attributes:or,uniforms:qe,fs:Ze,vs:Te,elements:ar,blend:ky[pf.normal]},ce);Sr&&(dr.count=Sr);var jr=et(dr);Ot(jr)}));case 5:case"end":return bt.stop()}},a,this)}));function r(a){return n.apply(this,arguments)}return r}()},{key:"createAttributes",value:function(r){var a=r.triangulation,u=this.styleAttributeService.createAttributes(this.encodedData,a),c=u.attributes;return c}},{key:"getTime",value:function(){return this.layerService.clock.getDelta()}},{key:"setAnimateStartTime",value:function(){this.animateStartTime=this.layerService.clock.getElapsedTime()}},{key:"stopAnimate",value:function(){this.animateStatus&&(this.layerService.stopAnimate(),this.animateStatus=!1,this.updateLayerConfig({animateOption:{enable:!1}}))}},{key:"getLayerAnimateTime",value:function(){return this.layerService.clock.getElapsedTime()-this.animateStartTime}},{key:"needPick",value:function(r){var a=this.getLayerConfig(),u=a.enableHighlight,c=u===void 0?!0:u,g=a.enableSelect,x=g===void 0?!0:g,M=this.eventNames().indexOf(r)!==-1||this.eventNames().indexOf("un"+r)!==-1;return(r==="click"||r==="dblclick")&&x&&(M=!0),r==="mousemove"&&(c||this.eventNames().indexOf("mouseenter")!==-1||this.eventNames().indexOf("unmousemove")!==-1||this.eventNames().indexOf("mouseout")!==-1)&&(M=!0),this.isVisible()&&M}},{key:"buildModels",value:function(){var n=(0,ur.Z)(it().mark(function a(){return it().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:throw new Error("Method not implemented.");case 1:case"end":return c.stop()}},a)}));function r(){return n.apply(this,arguments)}return r}()},{key:"rebuildModels",value:function(){var n=(0,ur.Z)(it().mark(function a(){return it().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.next=2,this.buildModels();case 2:case"end":return c.stop()}},a,this)}));function r(){return n.apply(this,arguments)}return r}()},{key:"renderMulPass",value:function(){var n=(0,ur.Z)(it().mark(function a(u){return it().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return g.next=2,u.render();case 2:case"end":return g.stop()}},a)}));function r(a){return n.apply(this,arguments)}return r}()},{key:"renderModels",value:function(){var r=this,a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.encodeDataLength<=0&&!this.forceRender?(this.clearModels(),this):(this.hooks.beforeRender.call(),this.models.forEach(function(u){u.draw({uniforms:r.layerModel.getUninforms(),blend:r.layerModel.getBlend(),stencil:r.layerModel.getStencil(a)},(a==null?void 0:a.ispick)||!1)}),this.hooks.afterRender.call(),this)}},{key:"updateStyleAttribute",value:function(r,a,u,c){var g=this.configService.getAttributeConfig(this.id)||{};return og(g[r],{field:a,values:u})?!1:(["color","size","texture","rotate","filter","label","shape"].indexOf(r)!==-1&&this.configService.setAttributeConfig(this.id,(0,Me.Z)({},r,{field:a,values:u})),this.startInit?this.styleAttributeService.updateStyleAttribute(r,{scale:(0,X.Z)({field:a},this.splitValuesAndCallbackInAttribute(u,this.getLayerConfig()[a]))},c):this.pendingStyleAttributes.push({attributeName:r,attributeField:a,attributeValues:u,updateOptions:c}),!0)}},{key:"getLayerAttributeConfig",value:function(){return this.configService.getAttributeConfig(this.id)}},{key:"getShaderPickStat",value:function(){return this.layerService.getShaderPickStat()}},{key:"setEarthTime",value:function(r){console.warn("empty fn")}},{key:"processData",value:function(r){return r}},{key:"getModelType",value:function(){throw new Error("Method not implemented.")}},{key:"getDefaultConfig",value:function(){return{}}},{key:"initLayerModels",value:function(){var n=(0,ur.Z)(it().mark(function a(){return it().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return this.models.forEach(function(g){return g.destroy()}),this.models=[],c.next=4,this.layerModel.initModels();case 4:this.models=c.sent;case 5:case"end":return c.stop()}},a,this)}));function r(){return n.apply(this,arguments)}return r}()},{key:"reRender",value:function(){this.inited&&this.layerService.reRender()}},{key:"splitValuesAndCallbackInAttribute",value:function(r){return{values:Uy(r)?void 0:r,callback:Uy(r)?r:void 0}}}]),t}(ha.EventEmitter),Zy=Hi(ag.prototype,"configService",[By],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ag);function QS(e,i){return{enable:e,mask:255,func:{cmp:je.EQUAL,ref:i?1:0,mask:1}}}function Vy(e){return e.maskOperation===kh.OR?{enable:!0,mask:255,func:{cmp:je.ALWAYS,ref:1,mask:255},opFront:{fail:je.KEEP,zfail:je.REPLACE,zpass:je.REPLACE}}:{enable:!0,mask:255,func:{cmp:e.stencilType===E0.SINGLE||e.stencilIndex===0?je.ALWAYS:je.LESS,ref:e.stencilType===E0.SINGLE?1:e.stencilIndex===0?2:1,mask:255},opFront:{fail:je.KEEP,zfail:je.REPLACE,zpass:je.REPLACE}}}function qS(e){switch(e){case"rotation":return{name:"Rotation",type:mn.Attribute,descriptor:{name:"a_Rotation",buffer:{usage:je.DYNAMIC_DRAW,data:[],type:je.FLOAT},size:1,update:function(t){var n=t.rotation,r=n===void 0?0:n;return Array.isArray(r)?[r[0]]:[r]}}};case"stroke":return{name:"stroke",type:mn.Attribute,descriptor:{name:"a_Stroke",buffer:{usage:je.DYNAMIC_DRAW,data:[],type:je.FLOAT},size:4,update:function(t){var n=t.stroke,r=n===void 0?[1,1,1,1]:n;return r}}};case"opacity":return{name:"opacity",type:mn.Attribute,descriptor:{name:"a_Opacity",buffer:{usage:je.STATIC_DRAW,data:[],type:je.FLOAT},size:1,update:function(t){var n=t.opacity,r=n===void 0?1:n;return[r]}}};case"extrusionBase":return{name:"extrusionBase",type:mn.Attribute,descriptor:{name:"a_ExtrusionBase",buffer:{usage:je.STATIC_DRAW,data:[],type:je.FLOAT},size:1,update:function(t){var n=t.extrusionBase,r=n===void 0?0:n;return[r]}}};case"offsets":return{name:"offsets",type:mn.Attribute,descriptor:{name:"a_Offsets",buffer:{usage:je.STATIC_DRAW,data:[],type:je.FLOAT},size:2,update:function(t){var n=t.offsets;return n}}};case"thetaOffset":return{name:"thetaOffset",type:mn.Attribute,descriptor:{name:"a_ThetaOffset",buffer:{usage:je.STATIC_DRAW,data:[],type:je.FLOAT},size:1,update:function(t){var n=t.thetaOffset,r=n===void 0?1:n;return[r]}}};default:return}}var KS={opacity:1,stroke:[1,0,0,1],offsets:[0,0],rotation:0,extrusionBase:0,strokeOpacity:1,thetaOffset:.314},Ld={opacity:"float",stroke:"vec4",offsets:"vec2",textOffset:"vec2",rotation:"float",extrusionBase:"float",strokeOpacity:"float",thetaOffset:"float"},Hy,sg,$y,vo=(Hy=rg(Xt.IGlobalConfigService),sg=function(){function e(i){(0,se.Z)(this,e),(0,Me.Z)(this,"preStyleAttribute",{}),(0,Me.Z)(this,"encodeStyleAttribute",{}),Ki(this,"configService",$y,this),this.layer=i,this.rendererService=i.getContainer().get(Xt.IRendererService),this.pickingService=i.getContainer().get(Xt.IPickingService),this.shaderModuleService=i.getContainer().get(Xt.IShaderModuleService),this.styleAttributeService=i.getContainer().get(Xt.IStyleAttributeService),this.mapService=i.getContainer().get(Xt.IMapService),this.iconService=i.getContainer().get(Xt.IIconService),this.fontService=i.getContainer().get(Xt.IFontService),this.cameraService=i.getContainer().get(Xt.ICameraService),this.layerService=i.getContainer().get(Xt.ILayerService),this.registerStyleAttribute(),this.registerBuiltinAttributes(),this.startModelAnimate();var t=this.rendererService.createTexture2D;this.createTexture2D=t}return(0,be.Z)(e,[{key:"getBlend",value:function(){var t=this.layer.getLayerConfig(),n=t.blend,r=n===void 0?"normal":n;return ky[pf[r]]}},{key:"getStencil",value:function(t){var n=this.layer.getLayerConfig(),r=n.mask,a=r===void 0?!1:r,u=n.maskInside,c=u===void 0?!0:u,g=n.enableMask,x=n.maskOperation,M=x===void 0?kh.AND:x;if(this.layer.type==="MaskLayer")return Vy({isStencil:!0,stencilType:E0.SINGLE});if(t.isStencil)return Vy((0,X.Z)((0,X.Z)({},t),{},{maskOperation:M}));var O=a||g&&this.layer.masks.length!==0||this.layer.tileMask!==void 0;return QS(O,c)}},{key:"getDefaultStyle",value:function(){return{}}},{key:"getUninforms",value:function(){throw new Error("Method not implemented.")}},{key:"getAnimateUniforms",value:function(){return{}}},{key:"needUpdate",value:function(){var i=(0,ur.Z)(it().mark(function n(){return it().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",!1);case 1:case"end":return a.stop()}},n)}));function t(){return i.apply(this,arguments)}return t}()},{key:"buildModels",value:function(){var i=(0,ur.Z)(it().mark(function n(){return it().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:throw new Error("Method not implemented.");case 1:case"end":return a.stop()}},n)}));function t(){return i.apply(this,arguments)}return t}()},{key:"initModels",value:function(){var i=(0,ur.Z)(it().mark(function n(){return it().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:throw new Error("Method not implemented.");case 1:case"end":return a.stop()}},n)}));function t(){return i.apply(this,arguments)}return t}()},{key:"clearModels",value:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0}},{key:"getAttribute",value:function(){throw new Error("Method not implemented.")}},{key:"render",value:function(t){throw new Error("Method not implemented.")}},{key:"registerBuiltinAttributes",value:function(){throw new Error("Method not implemented.")}},{key:"animateOption2Array",value:function(t){return[t.enable?0:1,t.duration||4,t.interval||.2,t.trailLength||.1]}},{key:"startModelAnimate",value:function(){var t=this.layer.getLayerConfig(),n=t.animateOption;n.enable&&this.layer.setAnimateStartTime()}},{key:"getInject",value:function(){var t=this.layer.encodeStyleAttribute,n="";this.layer.enableShaderEncodeStyles.forEach(function(a){t[a]&&(n+="#define USE_ATTRIBUTE_".concat(a.toUpperCase(),` 0.0; 

`)),n+=`
          #ifdef USE_ATTRIBUTE_`.concat(a.toUpperCase(),`
      attribute `).concat(Ld[a]," a_").concat(a.charAt(0).toUpperCase()+a.slice(1),`;
    #else
      uniform `).concat(Ld[a]," u_").concat(a,`;
    #endif

    `)});var r="";return this.layer.enableShaderEncodeStyles.forEach(function(a){r+=`

#ifdef USE_ATTRIBUTE_`.concat(a.toUpperCase(),`
  `).concat(Ld[a]," ").concat(a,"  = a_").concat(a.charAt(0).toUpperCase()+a.slice(1),`;
#else
  `).concat(Ld[a]," ").concat(a," = u_").concat(a,`;
#endif

`)}),{"vs:#decl":n,"vs:#main-start":r}}},{key:"getStyleAttribute",value:function(){var t=this,n={};return this.layer.enableShaderEncodeStyles.forEach(function(r){if(!t.layer.encodeStyleAttribute[r]){var a=t.layer.getLayerConfig()[r],u=typeof a=="undefined"?KS[r]:a;r==="stroke"&&(u=Ni(u)),n["u_"+r]=u}}),n}},{key:"registerStyleAttribute",value:function(){var t=this;Object.keys(this.layer.encodeStyleAttribute).forEach(function(n){var r=qS(n);r&&t.styleAttributeService.registerStyleAttribute(r)})}},{key:"updateEncodeAttribute",value:function(t,n){this.encodeStyleAttribute[t]=n}}]),e}(),$y=Hi(sg.prototype,"configService",[Hy],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),sg),ug=100,aL=36,oL=40;function Yy(e){return e/180*Math.acos(-1)}function Wy(e){var i=Yy(e[0])+Math.PI/2,t=Yy(e[1]),n=ug+Math.random()*.4,r=n*Math.cos(t)*Math.cos(i),a=n*Math.cos(t)*Math.sin(i),u=n*Math.sin(t);return[a,u,r]}function sL(e,i){var t=mat4.create(),n=mat4.create(),r=vec3.fromValues(0,1,0),a=vec3.fromValues(0,0,0);i=i||{},e=typeof e!="undefined"?e:1;for(var u=typeof i.segments!="undefined"?i.segments:32,c=2+u,g=2*c,x=[],M=[],O=[],B=[],W=[],ce=[],oe=0;oe<=c;oe++){for(var Te=oe/c,Ze=Te*Math.PI,qe=0;qe<=g;qe++){var et=qe/g,yt=et*Math.PI*2;mat4.identity(n),mat4.rotateZ(n,n,-Ze),mat4.identity(t),mat4.rotateY(t,t,yt),vec3.transformMat4(a,r,n),vec3.transformMat4(a,a,t),vec3.scale(a,a,-e),O.push(a.slice()),B.push.apply(B,_toConsumableArray(a.slice())),vec3.normalize(a,a),W.push.apply(W,_toConsumableArray(a.slice())),ce.push([et,1-Te]),B.push(et,1-Te)}if(oe>0)for(var bt=O.length,Ot=bt-2*(g+1);Ot+g+2<bt;Ot++)x.push([Ot,Ot+1,Ot+g+1]),M.push(Ot,Ot+1,Ot+g+1),x.push([Ot+g+1,Ot+1,Ot+g+2]),M.push(Ot+g+1,Ot+1,Ot+g+2)}return{cells:x,positions:O,uvs:ce,positionsArr:B,indicesArr:M,normalArr:W}}var Od=Xi(),uL=Xi(),uu=Xi(),N0=Xi(),aA=Xi();function lg(e,i,t,n,r){oo(e,t,n),Gu(e,e),i=Fl(-e[1],e[0]);var a=Fl(-t[1],t[0]);return[r/sl(i,a),i]}function F0(e,i){return ic(e,-i[1],i[0])}function oA(e,i,t){return sc(e,i,t),Gu(e,e),e}function cg(e,i){return e[0]===i[0]&&e[1]===i[1]}function lL(e){for(var i=new Map,t=0;t<e.length;t++){var n=e[0].toString()+"-"+e[1].toString();i.get(n)?(e.splice(t,1),t++):i.set(n,n)}return e}var JS=function(){function e(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};(0,se.Z)(this,e),(0,Me.Z)(this,"lastFlip",-1),(0,Me.Z)(this,"miter",Fl(0,0)),(0,Me.Z)(this,"started",!1),(0,Me.Z)(this,"dash",!1),(0,Me.Z)(this,"totalDistance",0),(0,Me.Z)(this,"currentIndex",0),this.join=i.join||"miter",this.cap=i.cap||"butt",this.miterLimit=i.miterLimit||10,this.thickness=i.thickness||1,this.dash=i.dash||!1,this.complex={positions:[],indices:[],normals:[],startIndex:0,indexes:[]}}return(0,be.Z)(e,[{key:"simpleExtrude",value:function(t){var n=this.complex;if(t.length<=1)return n;this.lastFlip=-1,this.started=!1,this.normal=null,this.totalDistance=0;for(var r=t.length,a=n.startIndex,u=1;u<r;u++){var c=t[u-1],g=t[u],x=u<t.length-1?t[u+1]:null,M=this.simpleSegment(n,a,c,g,x);a+=M}if(this.dash)for(var O=0;O<n.positions.length/6;O++)n.positions[O*6+5]=this.totalDistance;return n.startIndex=n.positions.length/6,n}},{key:"simpleExtrude_gaode2",value:function(t,n){var r=this.complex;if(t.length<=1)return r;this.lastFlip=-1,this.started=!1,this.normal=null,this.totalDistance=0;for(var a=t.length,u=r.startIndex,c=1;c<a;c++){var g,x,M,O=t[c-1];O.push((g=n[c-1][2])!==null&&g!==void 0?g:0);var B=n[c-1],W=t[c];W.push((x=n[c][2])!==null&&x!==void 0?x:0);var ce=n[c],oe=c<t.length-1?[].concat((0,pr.Z)(t[c+1]),[(M=n[c+1][2])!==null&&M!==void 0?M:0]):null,Te=c<n.length-1?n[c+1]:null,Ze=this.simpleSegment(r,u,O,W,oe,B,ce,Te);u+=Ze}if(this.dash)for(var qe=0;qe<r.positions.length/6;qe++)r.positions[qe*6+5]=this.totalDistance;return r.startIndex=r.positions.length/6,r}},{key:"extrude_gaode2",value:function(t,n){var r=this.complex;if(t.length<=1)return r;this.lastFlip=-1,this.started=!1,this.normal=null,this.totalDistance=0;for(var a=t.length,u=r.startIndex,c=1;c<a;c++){var g,x,M,O=t[c-1];O.push((g=n[c-1][2])!==null&&g!==void 0?g:0);var B=n[c-1],W=t[c];W.push((x=n[c][2])!==null&&x!==void 0?x:0);var ce=n[c],oe=c<t.length-1?[].concat((0,pr.Z)(t[c+1]),[(M=n[c+1][2])!==null&&M!==void 0?M:0]):null,Te=c<n.length-1?n[c+1]:null,Ze=this.segment_gaode2(r,u,O,W,oe,B,ce,Te);u+=Ze}if(this.dash)for(var qe=0;qe<r.positions.length/6;qe++)r.positions[qe*6+5]=this.totalDistance;return r.startIndex=r.positions.length/6,r}},{key:"extrude",value:function(t){var n=this.complex;if(t.length<=1)return n;this.lastFlip=-1,this.started=!1,this.normal=null,this.totalDistance=0;for(var r=t.length,a=n.startIndex,u=1;u<r;u++){var c=t[u-1],g=t[u],x=u<t.length-1?t[u+1]:null,M=this.segment(n,a,c,g,x);a+=M}if(this.dash)for(var O=0;O<n.positions.length/6;O++)n.positions[O*6+5]=this.totalDistance;return n.startIndex=n.positions.length/6,n}},{key:"simpleSegment",value:function(t,n,r,a,u){var c=0,g=t.indices,x=t.positions,M=t.normals,O=ma([a[0],a[1]]),B=ma([r[0],r[1]]);oA(uu,O,B);var W=0;if(this.dash&&(W=this.lineSegmentDistance(O,B),this.totalDistance+=W),this.normal||(this.normal=Xi(),F0(this.normal,uu)),this.started||(this.started=!0,this.extrusions(x,M,r,this.normal,this.thickness,this.totalDistance-W)),g.push(n+0,n+1,n+2),!u)F0(this.normal,uu),this.extrusions(x,M,a,this.normal,this.thickness,this.totalDistance),g.push.apply(g,(0,pr.Z)(this.lastFlip===1?[n,n+2,n+3]:[n+2,n+1,n+3])),c+=2;else{var ce=ma([u[0],u[1]]);cg(O,ce)&&oo(ce,O,Gu(ce,Uu(ce,O,B))),oA(N0,ce,O);var oe=lg(aA,Xi(),uu,N0,this.thickness),Te=(0,vn.Z)(oe,2),Ze=Te[0],qe=Te[1],et=sl(aA,this.normal)<0?-1:1;this.extrusions(x,M,a,qe,Ze,this.totalDistance),g.push.apply(g,(0,pr.Z)(this.lastFlip===1?[n,n+2,n+3]:[n+2,n+1,n+3])),et=-1,au(this.normal,qe),c+=2,this.lastFlip=et}return c}},{key:"segment_gaode2",value:function(t,n,r,a,u,c,g,x){var M=0,O=t.indices,B=t.positions,W=t.normals,ce=this.cap==="square",oe=this.join==="bevel",Te=ma([g[0],g[1]]),Ze=ma([c[0],c[1]]);oA(uu,a,r);var qe=0;if(this.dash&&(qe=this.lineSegmentDistance(Te,Ze),this.totalDistance+=qe),this.normal||(this.normal=Xi(),F0(this.normal,uu)),!this.started)if(this.started=!0,ce){var et=Xi(),yt=Xi();oo(et,this.normal,uu),oo(yt,this.normal,uu),W.push(yt[0],yt[1],0),W.push(et[0],et[1],0),B.push(r[0],r[1],r[2]|0,this.totalDistance-qe,-this.thickness,r[2]|0),this.complex.indexes.push(this.currentIndex),B.push(r[0],r[1],r[2]|0,this.totalDistance-qe,this.thickness,r[2]|0),this.complex.indexes.push(this.currentIndex),this.currentIndex++}else this.extrusions(B,W,r,this.normal,this.thickness,this.totalDistance-qe);if(O.push(n+0,n+1,n+2),u){cg(a,u)&&oo(u,a,Gu(u,Uu(u,a,r))),oA(N0,u,a);var jt=lg(aA,Xi(),uu,N0,this.thickness),or=(0,vn.Z)(jt,2),ar=or[0],Sr=or[1],dr=sl(aA,this.normal)<0?-1:1,jr=oe;if(!jr&&this.join==="miter"){var nn=ar;nn>this.miterLimit&&(jr=!0)}jr?(W.push(this.normal[0],this.normal[1],0),W.push(Sr[0],Sr[1],0),B.push(a[0],a[1],a[2]|0,this.totalDistance,-this.thickness*dr,a[2]|0),this.complex.indexes.push(this.currentIndex),B.push(a[0],a[1],a[2]|0,this.totalDistance,this.thickness*dr,a[2]|0),this.complex.indexes.push(this.currentIndex),this.currentIndex++,O.push.apply(O,(0,pr.Z)(this.lastFlip!==-dr?[n,n+2,n+3]:[n+2,n+1,n+3])),O.push(n+2,n+3,n+4),F0(Od,N0),au(this.normal,Od),W.push(this.normal[0],this.normal[1],0),B.push(a[0],a[1],a[2]|0,this.totalDistance,-this.thickness*dr,a[2]|0),this.complex.indexes.push(this.currentIndex),this.currentIndex++,M+=3):(this.extrusions(B,W,a,Sr,ar,this.totalDistance),O.push.apply(O,(0,pr.Z)(this.lastFlip===1?[n,n+2,n+3]:[n+2,n+1,n+3])),dr=-1,au(this.normal,Sr),M+=2),this.lastFlip=dr}else{if(F0(this.normal,uu),ce){var bt=Xi(),Ot=Xi();sc(Ot,uu,this.normal),oo(bt,uu,this.normal),W.push(Ot[0],Ot[1],0),W.push(bt[0],bt[1],0),B.push(a[0],a[1],a[2]|0,this.totalDistance,this.thickness,a[2]|0),this.complex.indexes.push(this.currentIndex),B.push(a[0],a[1],a[2]|0,this.totalDistance,this.thickness,a[2]|0),this.complex.indexes.push(this.currentIndex),this.currentIndex++}else this.extrusions(B,W,a,this.normal,this.thickness,this.totalDistance);O.push.apply(O,(0,pr.Z)(this.lastFlip===1?[n,n+2,n+3]:[n+2,n+1,n+3])),M+=2}return M}},{key:"segment",value:function(t,n,r,a,u){var c=0,g=t.indices,x=t.positions,M=t.normals,O=this.cap==="square",B=this.join==="bevel",W=ma([a[0],a[1]]),ce=ma([r[0],r[1]]);oA(uu,W,ce);var oe=0;if(this.dash&&(oe=this.lineSegmentDistance(W,ce),this.totalDistance+=oe),this.normal||(this.normal=Xi(),F0(this.normal,uu)),!this.started)if(this.started=!0,O){var Te=Xi(),Ze=Xi();oo(Te,this.normal,uu),oo(Ze,this.normal,uu),M.push(Ze[0],Ze[1],0),M.push(Te[0],Te[1],0),x.push(r[0],r[1],r[2]|0,this.totalDistance-oe,-this.thickness,r[2]|0),this.complex.indexes.push(this.currentIndex),x.push(r[0],r[1],r[2]|0,this.totalDistance-oe,this.thickness,r[2]|0),this.complex.indexes.push(this.currentIndex),this.currentIndex++}else this.extrusions(x,M,r,this.normal,this.thickness,this.totalDistance-oe);if(g.push(n+0,n+1,n+2),u){var yt=ma([u[0],u[1]]);cg(W,yt)&&oo(yt,W,Gu(yt,Uu(yt,W,ce))),oA(N0,yt,W);var bt=lg(aA,Xi(),uu,N0,this.thickness),Ot=(0,vn.Z)(bt,2),jt=Ot[0],or=Ot[1],ar=sl(aA,this.normal)<0?-1:1,Sr=B;if(!Sr&&this.join==="miter"){var dr=jt;dr>this.miterLimit&&(Sr=!0)}Sr?(M.push(this.normal[0],this.normal[1],0),M.push(or[0],or[1],0),x.push(a[0],a[1],a[2]|0,this.totalDistance,-this.thickness*ar,a[2]|0),this.complex.indexes.push(this.currentIndex),x.push(a[0],a[1],a[2]|0,this.totalDistance,this.thickness*ar,a[2]|0),this.complex.indexes.push(this.currentIndex),this.currentIndex++,g.push.apply(g,(0,pr.Z)(this.lastFlip!==-ar?[n,n+2,n+3]:[n+2,n+1,n+3])),g.push(n+2,n+3,n+4),F0(Od,N0),au(this.normal,Od),M.push(this.normal[0],this.normal[1],0),x.push(a[0],a[1],a[2]|0,this.totalDistance,-this.thickness*ar,a[2]|0),this.complex.indexes.push(this.currentIndex),this.currentIndex++,c+=3):(this.extrusions(x,M,a,or,jt,this.totalDistance),g.push.apply(g,(0,pr.Z)(this.lastFlip===1?[n,n+2,n+3]:[n+2,n+1,n+3])),ar=-1,au(this.normal,or),c+=2),this.lastFlip=ar}else{if(F0(this.normal,uu),O){var qe=Xi(),et=Xi();sc(et,uu,this.normal),oo(qe,uu,this.normal),M.push(et[0],et[1],0),M.push(qe[0],qe[1],0),x.push(a[0],a[1],a[2]|0,this.totalDistance,this.thickness,a[2]|0),this.complex.indexes.push(this.currentIndex),x.push(a[0],a[1],a[2]|0,this.totalDistance,this.thickness,a[2]|0),this.complex.indexes.push(this.currentIndex),this.currentIndex++}else this.extrusions(x,M,a,this.normal,this.thickness,this.totalDistance);g.push.apply(g,(0,pr.Z)(this.lastFlip===1?[n,n+2,n+3]:[n+2,n+1,n+3])),c+=2}return c}},{key:"extrusions",value:function(t,n,r,a,u,c){n.push(a[0],a[1],0),n.push(a[0],a[1],0),t.push(r[0],r[1],r[2]|0,c,-u,r[2]|0),this.complex.indexes.push(this.currentIndex),t.push(r[0],r[1],r[2]|0,c,u,r[2]|0),this.complex.indexes.push(this.currentIndex),this.currentIndex++}},{key:"lineSegmentDistance",value:function(t,n){var r=n[0]-t[0],a=n[1]-t[1];return Math.sqrt(r*r+a*a)}}]),e}();function sA(){var e=new Go(3);return Go!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0),e}function e3(e){var i=new Go(3);return i[0]=e[0],i[1]=e[1],i[2]=e[2],i}function Xy(e){var i=e[0],t=e[1],n=e[2];return Math.hypot(i,t,n)}function Pu(e,i,t){var n=new Go(3);return n[0]=e,n[1]=i,n[2]=t,n}function t3(e,i){return e[0]=i[0],e[1]=i[1],e[2]=i[2],e}function r3(e,i,t,n){return e[0]=i,e[1]=t,e[2]=n,e}function n3(e,i,t){return e[0]=i[0]+t[0],e[1]=i[1]+t[1],e[2]=i[2]+t[2],e}function Qy(e,i,t){return e[0]=i[0]-t[0],e[1]=i[1]-t[1],e[2]=i[2]-t[2],e}function qy(e,i,t){return e[0]=i[0]*t[0],e[1]=i[1]*t[1],e[2]=i[2]*t[2],e}function Ky(e,i,t){return e[0]=i[0]/t[0],e[1]=i[1]/t[1],e[2]=i[2]/t[2],e}function i3(e,i){return e[0]=Math.ceil(i[0]),e[1]=Math.ceil(i[1]),e[2]=Math.ceil(i[2]),e}function a3(e,i){return e[0]=Math.floor(i[0]),e[1]=Math.floor(i[1]),e[2]=Math.floor(i[2]),e}function o3(e,i,t){return e[0]=Math.min(i[0],t[0]),e[1]=Math.min(i[1],t[1]),e[2]=Math.min(i[2],t[2]),e}function s3(e,i,t){return e[0]=Math.max(i[0],t[0]),e[1]=Math.max(i[1],t[1]),e[2]=Math.max(i[2],t[2]),e}function u3(e,i){return e[0]=Math.round(i[0]),e[1]=Math.round(i[1]),e[2]=Math.round(i[2]),e}function l3(e,i,t){return e[0]=i[0]*t,e[1]=i[1]*t,e[2]=i[2]*t,e}function c3(e,i,t,n){return e[0]=i[0]+t[0]*n,e[1]=i[1]+t[1]*n,e[2]=i[2]+t[2]*n,e}function Jy(e,i){var t=i[0]-e[0],n=i[1]-e[1],r=i[2]-e[2];return Math.hypot(t,n,r)}function e1(e,i){var t=i[0]-e[0],n=i[1]-e[1],r=i[2]-e[2];return t*t+n*n+r*r}function t1(e){var i=e[0],t=e[1],n=e[2];return i*i+t*t+n*n}function r1(e,i){return e[0]=-i[0],e[1]=-i[1],e[2]=-i[2],e}function f3(e,i){return e[0]=1/i[0],e[1]=1/i[1],e[2]=1/i[2],e}function uA(e,i){var t=i[0],n=i[1],r=i[2],a=t*t+n*n+r*r;return a>0&&(a=1/Math.sqrt(a)),e[0]=i[0]*a,e[1]=i[1]*a,e[2]=i[2]*a,e}function n1(e,i){return e[0]*i[0]+e[1]*i[1]+e[2]*i[2]}function i1(e,i,t){var n=i[0],r=i[1],a=i[2],u=t[0],c=t[1],g=t[2];return e[0]=r*g-a*c,e[1]=a*u-n*g,e[2]=n*c-r*u,e}function h3(e,i,t,n){var r=i[0],a=i[1],u=i[2];return e[0]=r+n*(t[0]-r),e[1]=a+n*(t[1]-a),e[2]=u+n*(t[2]-u),e}function A3(e,i,t,n,r,a){var u=a*a,c=u*(2*a-3)+1,g=u*(a-2)+a,x=u*(a-1),M=u*(3-2*a);return e[0]=i[0]*c+t[0]*g+n[0]*x+r[0]*M,e[1]=i[1]*c+t[1]*g+n[1]*x+r[1]*M,e[2]=i[2]*c+t[2]*g+n[2]*x+r[2]*M,e}function p3(e,i,t,n,r,a){var u=1-a,c=u*u,g=a*a,x=c*u,M=3*a*c,O=3*g*u,B=g*a;return e[0]=i[0]*x+t[0]*M+n[0]*O+r[0]*B,e[1]=i[1]*x+t[1]*M+n[1]*O+r[1]*B,e[2]=i[2]*x+t[2]*M+n[2]*O+r[2]*B,e}function v3(e,i){i=i||1;var t=Uf()*2*Math.PI,n=Uf()*2-1,r=Math.sqrt(1-n*n)*i;return e[0]=Math.cos(t)*r,e[1]=Math.sin(t)*r,e[2]=n*i,e}function hp(e,i,t){var n=i[0],r=i[1],a=i[2],u=t[3]*n+t[7]*r+t[11]*a+t[15];return u=u||1,e[0]=(t[0]*n+t[4]*r+t[8]*a+t[12])/u,e[1]=(t[1]*n+t[5]*r+t[9]*a+t[13])/u,e[2]=(t[2]*n+t[6]*r+t[10]*a+t[14])/u,e}function g3(e,i,t){var n=i[0],r=i[1],a=i[2];return e[0]=n*t[0]+r*t[3]+a*t[6],e[1]=n*t[1]+r*t[4]+a*t[7],e[2]=n*t[2]+r*t[5]+a*t[8],e}function m3(e,i,t){var n=t[0],r=t[1],a=t[2],u=t[3],c=i[0],g=i[1],x=i[2],M=r*x-a*g,O=a*c-n*x,B=n*g-r*c,W=r*B-a*O,ce=a*M-n*B,oe=n*O-r*M,Te=u*2;return M*=Te,O*=Te,B*=Te,W*=2,ce*=2,oe*=2,e[0]=c+M+W,e[1]=g+O+ce,e[2]=x+B+oe,e}function y3(e,i,t,n){var r=[],a=[];return r[0]=i[0]-t[0],r[1]=i[1]-t[1],r[2]=i[2]-t[2],a[0]=r[0],a[1]=r[1]*Math.cos(n)-r[2]*Math.sin(n),a[2]=r[1]*Math.sin(n)+r[2]*Math.cos(n),e[0]=a[0]+t[0],e[1]=a[1]+t[1],e[2]=a[2]+t[2],e}function _3(e,i,t,n){var r=[],a=[];return r[0]=i[0]-t[0],r[1]=i[1]-t[1],r[2]=i[2]-t[2],a[0]=r[2]*Math.sin(n)+r[0]*Math.cos(n),a[1]=r[1],a[2]=r[2]*Math.cos(n)-r[0]*Math.sin(n),e[0]=a[0]+t[0],e[1]=a[1]+t[1],e[2]=a[2]+t[2],e}function x3(e,i,t,n){var r=[],a=[];return r[0]=i[0]-t[0],r[1]=i[1]-t[1],r[2]=i[2]-t[2],a[0]=r[0]*Math.cos(n)-r[1]*Math.sin(n),a[1]=r[0]*Math.sin(n)+r[1]*Math.cos(n),a[2]=r[2],e[0]=a[0]+t[0],e[1]=a[1]+t[1],e[2]=a[2]+t[2],e}function fg(e,i){var t=e[0],n=e[1],r=e[2],a=i[0],u=i[1],c=i[2],g=Math.sqrt(t*t+n*n+r*r),x=Math.sqrt(a*a+u*u+c*c),M=g*x,O=M&&n1(e,i)/M;return Math.acos(Math.min(Math.max(O,-1),1))}function E3(e){return e[0]=0,e[1]=0,e[2]=0,e}function b3(e){return"vec3("+e[0]+", "+e[1]+", "+e[2]+")"}function S3(e,i){return e[0]===i[0]&&e[1]===i[1]&&e[2]===i[2]}function C3(e,i){var t=e[0],n=e[1],r=e[2],a=i[0],u=i[1],c=i[2];return Math.abs(t-a)<=Ua*Math.max(1,Math.abs(t),Math.abs(a))&&Math.abs(n-u)<=Ua*Math.max(1,Math.abs(n),Math.abs(u))&&Math.abs(r-c)<=Ua*Math.max(1,Math.abs(r),Math.abs(c))}var hg=Qy,w3=qy,T3=Ky,M3=Jy,I3=e1,P3=Xy,L3=t1,O3=function(){var e=sA();return function(i,t,n,r,a,u){var c,g;for(t||(t=3),n||(n=0),r?g=Math.min(r*t+n,i.length):g=i.length,c=n;c<g;c+=t)e[0]=i[c],e[1]=i[c+1],e[2]=i[c+2],a(e,e,u),i[c]=e[0],i[c+1]=e[1],i[c+2]=e[2];return i}}();function cL(e){var i=e[0][0],t=e[0][e[0].length-1];i[0]===t[0]&&i[1]===t[1]&&(e[0]=e[0].slice(0,e[0].length-1));for(var n=e[0].length,r=earcut.flatten(e),a=r.vertices,u=r.dimensions,c=[],g=[],x=0;x<a.length/u;x++)u===2?c.push(a[x*2],a[x*2+1],1):c.push(a[x*3],a[x*3+1],1);var M=earcut(r.vertices,r.holes,r.dimensions);g.push.apply(g,_toConsumableArray(M));for(var O=function(){var ce=r.vertices.slice(B*u,(B+1)*u),oe=r.vertices.slice((B+1)*u,(B+2)*u);oe.length===0&&(oe=r.vertices.slice(0,u));var Te=c.length/3;c.push(ce[0],ce[1],1,oe[0],oe[1],1,ce[0],ce[1],0,oe[0],oe[1],0),g.push.apply(g,_toConsumableArray([0,2,1,2,3,1].map(function(Ze){return Ze+Te})))},B=0;B<n;B++)O();return{positions:c,index:g}}function fL(e){var i=earcut.flatten(e),t=earcut(i.vertices,i.holes,i.dimensions);return{positions:i.vertices,index:t}}function a1(e){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,t=e[0][0],n=e[0][e[0].length-1];t[0]===n[0]&&t[1]===n[1]&&(e[0]=e[0].slice(0,e[0].length-1));for(var r=e[0].length,a=oa().flatten(e),u=a.vertices,c=a.dimensions,g=[],x=[],M=[],O=0;O<u.length/c;O++)g.push(u[O*c],u[O*c+1],1,-1,-1),M.push(0,0,1);var B=oa()(a.vertices,a.holes,a.dimensions);x.push.apply(x,(0,pr.Z)(B));for(var W=function(){var Te=a.vertices.slice(ce*c,(ce+1)*c),Ze=a.vertices.slice((ce+1)*c,(ce+2)*c);Ze.length===0&&(Ze=a.vertices.slice(0,c));var qe=g.length/5;g.push(Te[0],Te[1],1,0,0,Ze[0],Ze[1],1,.1,0,Te[0],Te[1],0,0,.8,Ze[0],Ze[1],0,.1,.8);var et=R3([Ze[0],Ze[1],1],[Te[0],Te[1],0],[Te[0],Te[1],1],i);M.push.apply(M,(0,pr.Z)(et).concat((0,pr.Z)(et),(0,pr.Z)(et),(0,pr.Z)(et))),x.push.apply(x,(0,pr.Z)([1,2,0,3,2,1].map(function(yt){return yt+qe})))},ce=0;ce<r;ce++)W();return{positions:g,index:x,normals:M}}function R3(e,i,t){var n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,r=sA(),a=sA(),u=sA();n&&(e=No(e),i=No(i),t=No(t));var c=Pu.apply(k,(0,pr.Z)(e)),g=Pu.apply(k,(0,pr.Z)(i)),x=Pu.apply(k,(0,pr.Z)(t));hg(r,x,g),hg(a,c,g),i1(u,r,a);var M=sA();return uA(M,u),M}var Hc,Ap=function(e){return e.CYLINDER="cylinder",e.SQUARECOLUMN="squareColumn",e.TRIANGLECOLUMN="triangleColumn",e.HEXAGONCOLUMN="hexagonColumn",e.PENTAGONCOLUMN="pentagonColumn",e}({}),pp=function(e){return e.CIRCLE="circle",e.SQUARE="square",e.TRIANGLE="triangle",e.HEXAGON="hexagon",e.PENTAGON="pentagon",e}({});function dp(e){for(var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,t=Math.PI*2/e,n=[],r=0;r<e;r++)n.push(t*r+i*Math.PI/12);var a=n.map(function(u){var c=Math.sin(u+Math.PI/4),g=Math.cos(u+Math.PI/4);return[c,g,0]});return a}function Ag(){return dp(30)}function o1(){return dp(4)}function s1(){return dp(3)}function u1(){return dp(6,1)}function l1(){return dp(5)}var pg=(Hc={},(0,Me.Z)(Hc,pp.CIRCLE,Ag),(0,Me.Z)(Hc,pp.HEXAGON,u1),(0,Me.Z)(Hc,pp.TRIANGLE,s1),(0,Me.Z)(Hc,pp.SQUARE,o1),(0,Me.Z)(Hc,pp.PENTAGON,l1),(0,Me.Z)(Hc,Ap.CYLINDER,Ag),(0,Me.Z)(Hc,Ap.HEXAGONCOLUMN,u1),(0,Me.Z)(Hc,Ap.TRIANGLECOLUMN,s1),(0,Me.Z)(Hc,Ap.SQUARECOLUMN,o1),(0,Me.Z)(Hc,Ap.PENTAGONCOLUMN,l1),Hc),Rd={};function Dd(e){var i=Is(e.coordinates);return{vertices:[].concat((0,pr.Z)(i),(0,pr.Z)(i),(0,pr.Z)(i),(0,pr.Z)(i)),indices:[0,1,2,2,3,0],size:i.length}}function c1(e){var i=Is(e.coordinates),t=Wy(i);return{vertices:[].concat((0,pr.Z)(t),(0,pr.Z)(t),(0,pr.Z)(t),(0,pr.Z)(t)),indices:[0,1,2,2,3,0],size:t.length}}function f1(e){var i=e.shape,t=z3(i,!1),n=t.positions,r=t.index,a=t.normals;return{vertices:n,indices:r,normals:a,size:5}}function D3(e){var i=Is(e.coordinates);return{vertices:(0,pr.Z)(i),indices:[0],size:i.length}}function dg(e){var i=e.coordinates,t=e.originCoordinates,n=e.version,r=new JS({dash:!0,join:"bevel"});if(n==="GAODE2.x"){var a=i;Array.isArray(a[0][0])||(a=[i]);var u=t;Array.isArray(u[0][0])||(u=[t]);for(var c=0;c<a.length;c++){var g=a[c],x=u[c];r.extrude_gaode2(g,x)}}else{var M=i;M[0]&&!Array.isArray(M[0][0])&&(M=[i]),M.forEach(function(B){r.extrude(B)})}var O=r.complex;return{vertices:O.positions,indices:O.indices,normals:O.normals,indexes:O.indexes,size:6}}function hL(e){var i=e.coordinates.flat(),t=1,n=1;return{vertices:[1,0,0].concat(_toConsumableArray(i),[1,2,-3],_toConsumableArray(i),[1,1,-3],_toConsumableArray(i),[0,1,0],_toConsumableArray(i),[0,0,0],_toConsumableArray(i),[1,0,0],_toConsumableArray(i),[1,2,-3],_toConsumableArray(i),[1,1,-3],_toConsumableArray(i),[0,1,0],_toConsumableArray(i),[0,0,0],_toConsumableArray(i)),normals:[-t,2*n,1,2*n,-n,1,n,-n,1,n,-n,1,-t,-n,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],indices:[0,1,2,0,2,3,0,3,4,5,6,7,5,7,8,5,8,9],size:7}}function k3(e){var i=e.coordinates,t=[];if(!Array.isArray(i[0]))return{vertices:[],indices:[],normals:[],size:6,count:0};var n=N3(i),r=n.results,a=n.totalDistance;return r.map(function(u){t.push(u[0],u[1],u[2],u[3],0,a)}),{vertices:t,indices:[],normals:[],size:6,count:r.length}}function AL(e){var i=e.coordinates,t=[];if(!Array.isArray(i[0]))return{vertices:[],indices:[],size:4,count:0};var n=F3(i),r=n.results;return r.map(function(a){t.push(a[0],a[1],a[2],a[3])}),{vertices:t,indices:[],size:4,count:r.length}}function h1(e,i){var t=i[0]-e[0],n=i[1]-e[1];return Math.sqrt(t*t+n*n)}function lA(e,i){return e.length<3&&e.push(0),i!==void 0&&e.push(i),e}function N3(e){var i=e;Array.isArray(i)&&Array.isArray(i[0])&&Array.isArray(i[0][0])&&(i=e.flat());var t=0;if(i.length<2)return{results:i,totalDistance:0};var n=[],r=lA(i[0],t);n.push(r);for(var a=1;a<i.length-1;a++){var u=h1(i[a-1],i[a]);t+=u;var c=lA(i[a],t);n.push(c),n.push(c)}var g=h1(i[i.length-2],i[i.length-1]);return t+=g,n.push(lA(i[i.length-1],t)),{results:n,totalDistance:t}}function F3(e){if(e.length<2)return{results:e};var i=[],t=lA(e[0]);i.push(t);for(var n=1;n<e.length-1;n++){var r=lA(e[n]);i.push(r),i.push(r)}return i.push(lA(e[e.length-1])),{results:i}}function vg(e){var i=e.coordinates,t=oa().flatten(i),n=t.vertices,r=t.dimensions,a=t.holes;return{indices:oa()(n,a,r),vertices:n,size:r}}function B3(e){var i=e.coordinates,t=oa().flatten(i),n=t.vertices,r=t.dimensions,a=t.holes;return{indices:oa()(n,a,r),vertices:Z3(n),size:r+4}}function Z3(e){for(var i=[],t=kl(e),n=t.center,r=t.radius,a=0;a<e.length;a+=2){var u=e[a],c=e[a+1];i.push.apply(i,[u,c,0].concat((0,pr.Z)(n),[r]))}return i}function A1(e){var i=e.coordinates,t=a1(i,!0),n=t.positions,r=t.index,a=t.normals;return{vertices:n,indices:r,normals:a,size:5}}function pL(e){var i=e.shape,t=G3(i),n=t.positions,r=t.index;return{vertices:n,indices:r,size:3}}function kd(e){var i=e.coordinates,t=[].concat((0,pr.Z)(i[0]),[0,0,1,i[1][0],i[0][1],0,1,1],(0,pr.Z)(i[1]),[0,1,0],(0,pr.Z)(i[0]),[0,0,1],(0,pr.Z)(i[1]),[0,1,0,i[0][0],i[1][1],0,0,0]),n=[0,1,2,3,4,5];return{vertices:t,indices:n,size:5}}function Nd(e,i){for(var t=i.segmentNumber,n=t===void 0?30:t,r=e.coordinates,a=[],u=[],c=function(M){a.push(M,1,M,r[0][0],r[0][1],r[1][0],r[1][1],M,-1,M,r[0][0],r[0][1],r[1][0],r[1][1]),M!==n-1&&u.push.apply(u,(0,pr.Z)([0,1,2,1,3,2].map(function(O){return M*2+O})))},g=0;g<n;g++)c(g);return{vertices:a,indices:u,size:7}}function dL(e){var i=e.coordinates;i.length===2&&i.push(0);var t=Fd(-1,1),n=Fd(1,1),r=Fd(-1,-1),a=Fd(1,-1),u=[].concat(_toConsumableArray(i),_toConsumableArray(t),_toConsumableArray(i),_toConsumableArray(r),_toConsumableArray(i),_toConsumableArray(a),_toConsumableArray(i),_toConsumableArray(n)),c=[0,1,2,3,0,2];return{vertices:u,indices:c,size:5}}function z3(e){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(Rd&&Rd[e])return Rd[e];var t=pg[e]?pg[e]():pg.cylinder(),n=a1([t],i);return Rd[e]=n,n}function vL(e,i){for(var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:3,n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,r=new Float32Array(e.length/t*3),a,u,c,g=vec3.create(),x=vec3.create(),M=vec3.create(),O=0,B=i.length;O<B;O+=3){a=i[O+0]*3,u=i[O+1]*3,c=i[O+2]*3;var W=[e[a],e[a+1]],ce=[e[u],e[u+1]],oe=[e[c],e[c+1]];n&&(W=lngLatToMeters(W),ce=lngLatToMeters(ce),oe=lngLatToMeters(oe));var Te=W,Ze=_slicedToArray(Te,2),qe=Ze[0],et=Ze[1],yt=vec3.fromValues(qe,et,e[a+2]),bt=ce,Ot=_slicedToArray(bt,2),jt=Ot[0],or=Ot[1],ar=vec3.fromValues(jt,or,e[u+2]),Sr=oe,dr=_slicedToArray(Sr,2),jr=dr[0],nn=dr[1],En=vec3.fromValues(jr,nn,e[c+2]);vec3.sub(g,En,ar),vec3.sub(x,yt,ar),vec3.cross(M,g,x),r[a]+=g[0],r[a+1]+=g[1],r[a+2]+=g[2],r[u]+=g[0],r[u+1]+=g[1],r[u+2]+=g[2],r[c]+=g[0],r[c+1]+=g[1],r[c+2]+=g[2]}return U3(r),r}function U3(e){for(var i=0,t=e.length;i<t;i+=3){var n=vec3.fromValues(e[i],e[i+1],e[i+2]),r=vec3.create();vec3.normalize(r,n),e.set(r,i)}}function gL(e){var i=e[0][0],t=e[0][e[0].length-1];return i[0]===t[0]&&i[1]===t[1]}function G3(e){var i=["cylinder","triangleColumn","hexagonColumn","squareColumn"],t=geometryShape[e]?geometryShape[e]():geometryShape.circle(),n=i.indexOf(e)===-1?fillPolygon([t]):extrudePolygon([t]);return n}function Fd(e,i){var t=(e+1)/2,n=(i+1)/2;return[t,n]}function mL(){var e=primitiveSphere(EARTH_RADIUS,{segments:EARTH_SEGMENTS}),i=e.positionsArr,t=e.indicesArr,n=e.normalArr;return{vertices:i,indices:t,size:5,normals:n}}function yL(){var e=primitiveSphere(EARTH_RADIUS+EARTH_RADIUS_OUTER,{segments:EARTH_SEGMENTS}),i=e.positionsArr,t=e.indicesArr,n=e.normalArr;return{vertices:i,indices:t,size:5,normals:n}}function j3(e){var i=V3();return function(){var n=(0,ue.Z)(e),r;if(i){var a=(0,ue.Z)(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return(0,ze.Z)(this,r)}}function V3(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var H3=`varying vec4 v_dash_array;
varying vec4 v_color;
varying float v_distance_ratio;

uniform float segmentNumber;


#pragma include "picking"

void main() {
  gl_FragColor = v_color;

  float flag = 0.;
  float dashLength = mod(v_distance_ratio, v_dash_array.x + v_dash_array.y + v_dash_array.z + v_dash_array.w);
  if(dashLength < v_dash_array.x || (dashLength > (v_dash_array.x + v_dash_array.y) && dashLength <  v_dash_array.x + v_dash_array.y + v_dash_array.z)) {
    flag = 1.;
  };
  gl_FragColor.a *=flag;
  
  gl_FragColor = filterColor(gl_FragColor);
}`,$3=`
attribute vec4 a_Color;
attribute vec3 a_Position;
attribute vec4 a_Instance;
attribute float a_Size;
uniform mat4 u_ModelMatrix;

uniform float segmentNumber;
varying vec4 v_color;


uniform vec4 u_dash_array: [10.0, 5., 0, 0];
uniform float u_lineDir: 1.0;
varying vec4 v_dash_array;
varying float v_distance_ratio;
#pragma include "projection"
#pragma include "project"
#pragma include "picking"

float bezier3(vec3 arr, float t) {
  float ut = 1. - t;
  return (arr.x * ut + arr.y * t) * ut + (arr.y * ut + arr.z * t) * t;
}
vec2 midPoint(vec2 source, vec2 target, float arcThetaOffset) {
  vec2 center = target - source;
  float r = length(center);
  float theta = atan(center.y, center.x);
  float thetaOffset = arcThetaOffset;
  float r2 = r / 2.0 / cos(thetaOffset);
  float theta2 = theta + thetaOffset;
  vec2 mid = vec2(r2*cos(theta2) + source.x, r2*sin(theta2) + source.y);
  if(u_lineDir == 1.0) { // \u6B63\u5411
    return mid;
  } else { // \u9006\u5411
    // (mid + vmin)/2 = (s + t)/2
    vec2 vmid = source + target - mid;
    return vmid;
  }
  // return mid;
}
float getSegmentRatio(float index) {
  // dash: index / (segmentNumber - 1.);
  // normal: smoothstep(0.0, 1.0, index / (segmentNumber - 1.));
  return index / (segmentNumber - 1.);
}
vec2 interpolate (vec2 source, vec2 target, float t, float arcThetaOffset) {
  // if the angularDist is PI, linear interpolation is applied. otherwise, use spherical interpolation
  vec2 mid = midPoint(source, target, arcThetaOffset);
  vec3 x = vec3(source.x, mid.x, target.x);
  vec3 y = vec3(source.y, mid.y, target.y);
  return vec2(bezier3(x ,t), bezier3(y,t));
}
vec2 getExtrusionOffset(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
   dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
  vec2 offset = dir_screenspace * offset_direction * setPickingSize(a_Size) / 2.0;
  return offset;
}
vec2 getNormal(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
   dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
   return reverse_offset_normal(vec3(dir_screenspace,1.0)).xy * sign(offset_direction);
}

void main() {
  v_color = vec4(a_Color.xyz, a_Color.w * opacity);
  
  vec2 source = a_Instance.rg;  // \u8D77\u59CB\u70B9
  vec2 target =  a_Instance.ba; // \u7EC8\u70B9
  float segmentIndex = a_Position.x;
  float segmentRatio = getSegmentRatio(segmentIndex);

  float indexDir = mix(-1.0, 1.0, step(segmentIndex, 0.0));
  float nextSegmentRatio = getSegmentRatio(segmentIndex + indexDir);

  vec2 s = source;
  vec2 t = target;
  
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    s = unProjCustomCoord(source);
    t = unProjCustomCoord(target);
  }
  float total_Distance = pixelDistance(s, t) / 2.0 * PI;
  v_dash_array = pow(2.0, 20.0 - u_Zoom) * u_dash_array / total_Distance;

  v_distance_ratio = segmentIndex / segmentNumber;

  vec4 curr = project_position(vec4(interpolate(source, target, segmentRatio, thetaOffset), 0.0, 1.0));
  vec4 next = project_position(vec4(interpolate(source, target, nextSegmentRatio, thetaOffset), 0.0, 1.0));
 
  
  vec2 offset = project_pixel(getExtrusionOffset((next.xy - curr.xy) * indexDir, a_Position.y));

  gl_Position = project_common_position_to_clipspace_v2(vec4(curr.xy + offset, 0, 1.0));

  gl_PointSize = 5.0;
  setPickingColor(a_PickingColor);
}
`,Y3=`
#define Animate 0.0
#define LineTexture 1.0
uniform float u_textureBlend;
uniform float u_blur : 0.9;
uniform float u_line_type: 0.0;
// varying vec2 v_normal;
varying vec4 v_dash_array;
varying vec4 v_color;

uniform float u_time;
uniform vec4 u_animate: [ 1., 2., 1.0, 0.2 ];

uniform float u_line_texture;
uniform sampler2D u_texture;
uniform vec2 u_textSize;

uniform float segmentNumber;
varying vec2 v_iconMapUV;
varying vec4 v_lineData;


#pragma include "picking"

void main() {
  float animateSpeed = 0.0; // \u8FD0\u52A8\u901F\u5EA6
  gl_FragColor = v_color;
  

  if(u_animate.x == Animate && u_line_texture != LineTexture) {
      animateSpeed = u_time / u_animate.y;
      float alpha =1.0 - fract( mod(1.0- v_lineData.b, u_animate.z)* (1.0/ u_animate.z) + u_time / u_animate.y);
      alpha = (alpha + u_animate.w -1.0) / u_animate.w;
      // alpha = smoothstep(0., 1., alpha);
      alpha = clamp(alpha, 0.0, 1.0);
      gl_FragColor.a *= alpha;
  }

  // \u5F53\u5B58\u5728\u8D34\u56FE\u65F6\u5728\u5E95\u8272\u4E0A\u8D34\u4E0A\u8D34\u56FE
  if(u_line_texture == LineTexture) { // while load texture
    float arcRadio = smoothstep( 0.0, 1.0, (v_lineData.r / segmentNumber));
    // float arcRadio = smoothstep( 0.0, 1.0, d_distance_ratio);

    float count = v_lineData.g; // \u8D34\u56FE\u5728\u5F27\u7EBF\u4E0A\u91CD\u590D\u7684\u6570\u91CF

    float time = 0.0;
    if(u_animate.x == Animate) {
      time = u_time / u_animate.y;
    }
    float redioCount = arcRadio * count;

    float u = fract(redioCount - time);
    float v = v_lineData.a; // \u6A2A\u5411 v
    vec2 uv= v_iconMapUV / u_textSize + vec2(u, v) / u_textSize * 64.;

    vec4 pattern = texture2D(u_texture, uv);

    if(u_animate.x == Animate) {
      float currentPlane = floor(redioCount - time);
      float textureStep = floor(count * u_animate.z);
      float a = mod(currentPlane, textureStep);
      if(a < textureStep - 1.0) {
        pattern = vec4(0.0);
      }
    }

    if(u_textureBlend == 0.0) { // normal
      pattern.a = 0.0;
      gl_FragColor = filterColor(gl_FragColor + pattern);
    } else { // replace
        pattern.a *= v_color.a;
        if(gl_FragColor.a <= 0.0) {
          pattern.a = 0.0;
        }
        gl_FragColor = filterColor(pattern);
    }
    
  } else {
     gl_FragColor = filterColor(gl_FragColor);
  }
}`,W3=`#define Animate 0.0
#define LineTexture 1.0

attribute vec4 a_Color;
attribute vec3 a_Position;
attribute vec4 a_Instance;
attribute float a_Size;
uniform mat4 u_ModelMatrix;

uniform float segmentNumber;
uniform vec4 u_animate: [ 1., 2., 1.0, 0.2 ];
varying vec4 v_color;

uniform float u_lineDir: 1.0;

uniform float u_icon_step: 100;
uniform float u_line_texture: 0.0;
attribute vec2 a_iconMapUV;
varying vec2 v_iconMapUV;
varying vec4 v_lineData;
varying vec2 v_distance_ratio;


#pragma include "projection"
#pragma include "project"
#pragma include "picking"

float bezier3(vec3 arr, float t) {
  float ut = 1. - t;
  return (arr.x * ut + arr.y * t) * ut + (arr.y * ut + arr.z * t) * t;
}
vec2 midPoint(vec2 source, vec2 target, float arcThetaOffset) {
  vec2 center = target - source;
  float r = length(center);
  float theta = atan(center.y, center.x);
  float thetaOffset = arcThetaOffset;
  float r2 = r / 2.0 / cos(thetaOffset);
  float theta2 = theta + thetaOffset;
  vec2 mid = vec2(r2*cos(theta2) + source.x, r2*sin(theta2) + source.y);
  if(u_lineDir == 1.0) { // \u6B63\u5411
    return mid;
  } else { // \u9006\u5411
    // (mid + vmin)/2 = (s + t)/2
    vec2 vmid = source + target - mid;
    return vmid;
  }
  // return mid;
}
float getSegmentRatio(float index) {
    // dash: index / (segmentNumber - 1.);
    // normal: smoothstep(0.0, 1.0, index / (segmentNumber - 1.));
    return smoothstep(0.0, 1.0, index / (segmentNumber - 1.));
    //  return index / (segmentNumber - 1.);
}
vec2 interpolate (vec2 source, vec2 target, float t, float arcThetaOffset) {
  // if the angularDist is PI, linear interpolation is applied. otherwise, use spherical interpolation
  vec2 mid = midPoint(source, target, arcThetaOffset);
  vec3 x = vec3(source.x, mid.x, target.x);
  vec3 y = vec3(source.y, mid.y, target.y);
  return vec2(bezier3(x ,t), bezier3(y,t));
}
vec2 getExtrusionOffset(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
   dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
  vec2 offset = dir_screenspace * offset_direction * setPickingSize(a_Size) / 2.0;
  return offset;
}
vec2 getNormal(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
   dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
   return reverse_offset_normal(vec3(dir_screenspace,1.0)).xy * sign(offset_direction);
}

void main() {
  v_color = a_Color;
  v_color.a = v_color.a * opacity;

  vec2 source = a_Instance.rg;  // \u8D77\u59CB\u70B9
  vec2 target =  a_Instance.ba; // \u7EC8\u70B9
  float segmentIndex = a_Position.x;
  float segmentRatio = getSegmentRatio(segmentIndex);

  float indexDir = mix(-1.0, 1.0, step(segmentIndex, 0.0));
  float nextSegmentRatio = getSegmentRatio(segmentIndex + indexDir);
  float d_distance_ratio;
  
  if(u_animate.x == Animate) {
      d_distance_ratio = segmentIndex / segmentNumber;
      if(u_lineDir != 1.0) {
        d_distance_ratio = 1.0 - d_distance_ratio;
      }
  }

 v_lineData.b = d_distance_ratio;

  vec4 curr = project_position(vec4(interpolate(source, target, segmentRatio, thetaOffset), 0.0, 1.0));
  vec4 next = project_position(vec4(interpolate(source, target, nextSegmentRatio, thetaOffset), 0.0, 1.0));

  
  vec2 offset = project_pixel(getExtrusionOffset((next.xy - curr.xy) * indexDir, a_Position.y));


  float d_segmentIndex = a_Position.x + 1.0; // \u5F53\u524D\u9876\u70B9\u5728\u5F27\u7EBF\u4E2D\u6240\u5904\u7684\u5206\u6BB5\u4F4D\u7F6E
 v_lineData.r = d_segmentIndex;

  if(LineTexture == u_line_texture) { // \u5F00\u542F\u8D34\u56FE\u6A21\u5F0F

    float arcDistrance = length(source - target); // \u8D77\u59CB\u70B9\u548C\u7EC8\u70B9\u7684\u8DDD\u79BB
    if(u_CoordinateSystem == COORDINATE_SYSTEM_P20) { // amap
      arcDistrance *= 1000000.0;
    }
    if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) { // mapbox
      // arcDistrance *= 8.0;
      arcDistrance = project_pixel_allmap(arcDistrance);
    }
    v_iconMapUV = a_iconMapUV;

    float pixelLen = project_pixel_texture(u_icon_step); // \u8D34\u56FE\u6CBF\u5F27\u7EBF\u65B9\u5411\u7684\u957F\u5EA6 - \u968F\u5730\u56FE\u7F29\u653E\u6539\u53D8
    float texCount = floor(arcDistrance/pixelLen); // \u8D34\u56FE\u5728\u5F27\u7EBF\u4E0A\u91CD\u590D\u7684\u6570\u91CF
    v_lineData.g = texCount;

    float lineOffsetWidth = length(offset + offset * sign(a_Position.y)); // \u7EBF\u6A2A\u5411\u504F\u79FB\u7684\u8DDD\u79BB
    float linePixelSize = project_pixel(a_Size); // \u5B9A\u70B9\u4F4D\u7F6E\u504F\u79FB
    v_lineData.a = lineOffsetWidth/linePixelSize; // \u7EBF\u56FE\u5C42\u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\u503C
  }

  gl_Position = project_common_position_to_clipspace_v2(vec4(curr.xy + offset, 0, 1.0));

  setPickingColor(a_PickingColor);
}
`,X3=`varying vec4 v_color;

#pragma include "picking"

void main() {
// \u5F53\u524D\u9876\u70B9\u5728\u5F27\u7EBF\u4E2D\u6240\u5904\u7684\u5206\u6BB5\u4F4D\u7F6E

  gl_FragColor = v_color;
  gl_FragColor = filterColor(gl_FragColor);
}`,Q3=`
attribute vec4 a_Color;
attribute vec3 a_Position;
attribute vec4 a_Instance;
attribute float a_Size;
uniform mat4 u_ModelMatrix;

uniform float segmentNumber;
varying vec4 v_color;
varying float v_segmentIndex;

uniform float u_lineDir: 1.0;

uniform vec4 u_sourceColor;
uniform vec4 u_targetColor;




#pragma include "projection"
#pragma include "project"
#pragma include "picking"

float bezier3(vec3 arr, float t) {
  float ut = 1. - t;
  return (arr.x * ut + arr.y * t) * ut + (arr.y * ut + arr.z * t) * t;
}
vec2 midPoint(vec2 source, vec2 target, float arcThetaOffset) {
  vec2 center = target - source;
  float r = length(center);
  float theta = atan(center.y, center.x);
  float thetaOffset = arcThetaOffset;
  float r2 = r / 2.0 / cos(thetaOffset);
  float theta2 = theta + thetaOffset;
  vec2 mid = vec2(r2*cos(theta2) + source.x, r2*sin(theta2) + source.y);
  if(u_lineDir == 1.0) { // \u6B63\u5411
    return mid;
  } else { // \u9006\u5411
    // (mid + vmin)/2 = (s + t)/2
    vec2 vmid = source + target - mid;
    return vmid;
  }
  // return mid;
}
float getSegmentRatio(float index) {
    return smoothstep(0.0, 1.0, index / (segmentNumber - 1.));
}
vec2 interpolate (vec2 source, vec2 target, float t, float arcThetaOffset) {
  // if the angularDist is PI, linear interpolation is applied. otherwise, use spherical interpolation
  vec2 mid = midPoint(source, target, arcThetaOffset);
  vec3 x = vec3(source.x, mid.x, target.x);
  vec3 y = vec3(source.y, mid.y, target.y);
  return vec2(bezier3(x ,t), bezier3(y,t));
}
vec2 getExtrusionOffset(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
   dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
  vec2 offset = dir_screenspace * offset_direction * setPickingSize(a_Size) / 2.0;
  return offset;
}
vec2 getNormal(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
   dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
   return reverse_offset_normal(vec3(dir_screenspace,1.0)).xy * sign(offset_direction);
}

void main() {
  v_color = a_Color;

  vec2 source = a_Instance.rg;  // \u8D77\u59CB\u70B9
  vec2 target =  a_Instance.ba; // \u7EC8\u70B9
  float segmentIndex = a_Position.x;
  float segmentRatio = getSegmentRatio(segmentIndex);

  float indexDir = mix(-1.0, 1.0, step(segmentIndex, 0.0));
  float nextSegmentRatio = getSegmentRatio(segmentIndex + indexDir);
  float d_distance_ratio;
  vec4 curr = project_position(vec4(interpolate(source, target, segmentRatio, thetaOffset), 0.0, 1.0));
  vec4 next = project_position(vec4(interpolate(source, target, nextSegmentRatio, thetaOffset), 0.0, 1.0));
  // v_normal = getNormal((next.xy - curr.xy) * indexDir, a_Position.y);
  //unProjCustomCoord
  
  vec2 offset = project_pixel(getExtrusionOffset((next.xy - curr.xy) * indexDir, a_Position.y));


  float d_segmentIndex = a_Position.x + 1.0; // \u5F53\u524D\u9876\u70B9\u5728\u5F27\u7EBF\u4E2D\u6240\u5904\u7684\u5206\u6BB5\u4F4D\u7F6E

  v_color = mix(u_sourceColor, u_targetColor, d_segmentIndex/segmentNumber);
  v_color.a *= opacity;

  gl_Position = project_common_position_to_clipspace_v2(vec4(curr.xy + offset, 0, 1.0));

  setPickingColor(a_PickingColor);
}
`,q3={solid:0,dash:1},_L=In.isNumber,K3=function(e){(0,Ne.Z)(t,e);var i=j3(t);function t(){var n;(0,se.Z)(this,t);for(var r=arguments.length,a=new Array(r),u=0;u<r;u++)a[u]=arguments[u];return n=i.call.apply(i,[this].concat(a)),(0,Me.Z)((0,xt.Z)(n),"updateTexture",function(){var c=n.rendererService.createTexture2D;if(n.texture){n.texture.update({data:n.iconService.getCanvas()}),n.layer.render();return}n.texture=c({data:n.iconService.getCanvas(),mag:je.NEAREST,min:je.NEAREST,premultiplyAlpha:!1,width:1024,height:n.iconService.canvasHeight||128})}),n}return(0,be.Z)(t,[{key:"getUninforms",value:function(){var r=this.layer.getLayerConfig(),a=r.opacity,u=a===void 0?1:a,c=r.sourceColor,g=r.targetColor,x=r.textureBlend,M=x===void 0?"normal":x,O=r.lineType,B=O===void 0?"solid":O,W=r.dashArray,ce=W===void 0?[10,5]:W,oe=r.forward,Te=oe===void 0?!0:oe,Ze=r.lineTexture,qe=Ze===void 0?!1:Ze,et=r.iconStep,yt=et===void 0?100:et,bt=r.segmentNumber,Ot=bt===void 0?30:bt;ce.length===2&&ce.push(0,0);var jt=0,or=[0,0,0,0],ar=[0,0,0,0];return c&&g&&(or=Ni(c),ar=Ni(g),jt=1),this.rendererService.getDirty()&&this.texture.bind(),(0,X.Z)({u_textureBlend:M==="normal"?0:1,segmentNumber:Ot,u_line_type:q3[B||"solid"],u_dash_array:ce,u_blur:.9,u_lineDir:Te?1:-1,u_texture:this.texture,u_line_texture:qe?1:0,u_icon_step:yt,u_textSize:[1024,this.iconService.canvasHeight||128],u_linearColor:jt,u_sourceColor:or,u_targetColor:ar},this.getStyleAttribute())}},{key:"getAnimateUniforms",value:function(){var r=this.layer.getLayerConfig(),a=r.animateOption;return{u_animate:this.animateOption2Array(a),u_time:this.layer.getLayerAnimateTime()}}},{key:"initModels",value:function(){var n=(0,ur.Z)(it().mark(function a(){return it().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return this.updateTexture(),this.iconService.on("imageUpdate",this.updateTexture),c.abrupt("return",this.buildModels());case 3:case"end":return c.stop()}},a,this)}));function r(){return n.apply(this,arguments)}return r}()},{key:"clearModels",value:function(){var r;(r=this.texture)===null||r===void 0||r.destroy(),this.iconService.off("imageUpdate",this.updateTexture)}},{key:"getShaders",value:function(){var r=this.layer.getLayerConfig(),a=r.sourceColor,u=r.targetColor,c=r.lineType;return c==="dash"?{frag:H3,vert:$3,type:"Dash"}:a&&u?{frag:X3,vert:Q3,type:"Linear"}:{frag:Y3,vert:W3,type:""}}},{key:"buildModels",value:function(){var n=(0,ur.Z)(it().mark(function a(){var u,c,g,x,M,O,B,W;return it().wrap(function(oe){for(;;)switch(oe.prev=oe.next){case 0:return u=this.layer.getLayerConfig(),c=u.segmentNumber,g=c===void 0?30:c,x=this.getShaders(),M=x.frag,O=x.vert,B=x.type,oe.next=4,this.layer.buildLayerModel({moduleName:"lineArc2d"+B,vertexShader:O,fragmentShader:M,inject:this.getInject(),triangulation:Nd,depth:{enable:!1},styleOption:{segmentNumber:g}});case 4:return W=oe.sent,oe.abrupt("return",[W]);case 6:case"end":return oe.stop()}},a,this)}));function r(){return n.apply(this,arguments)}return r}()},{key:"registerBuiltinAttributes",value:function(){var r=this;this.styleAttributeService.registerStyleAttribute({name:"size",type:mn.Attribute,descriptor:{name:"a_Size",buffer:{usage:je.DYNAMIC_DRAW,data:[],type:je.FLOAT},size:1,update:function(u){var c=u.size,g=c===void 0?1:c;return Array.isArray(g)?[g[0]]:[g]}}}),this.styleAttributeService.registerStyleAttribute({name:"instance",type:mn.Attribute,descriptor:{name:"a_Instance",buffer:{usage:je.STATIC_DRAW,data:[],type:je.FLOAT},size:4,update:function(u,c,g){return[g[3],g[4],g[5],g[6]]}}}),this.styleAttributeService.registerStyleAttribute({name:"uv",type:mn.Attribute,descriptor:{name:"a_iconMapUV",buffer:{usage:je.DYNAMIC_DRAW,data:[],type:je.FLOAT},size:2,update:function(u){var c=r.iconService.getIconMap(),g=u.texture,x=c[g]||{x:0,y:0},M=x.x,O=x.y;return[M,O]}}})}}]),t}(vo);function J3(e){var i=eC();return function(){var n=(0,ue.Z)(e),r;if(i){var a=(0,ue.Z)(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return(0,ze.Z)(this,r)}}function eC(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var tC=`#define LineTypeSolid 0.0
#define LineTypeDash 1.0
#define Animate 0.0
#define LineTexture 1.0

uniform float u_textureBlend;
uniform float u_blur : 0.9;
uniform float u_line_type: 0.0;
// varying vec2 v_normal;
varying vec4 v_dash_array;
varying vec4 v_color;
varying vec4 v_line_data;

uniform float u_line_texture: 0.0;
uniform sampler2D u_texture;
uniform vec2 u_textSize;
varying float v_segmentIndex;
uniform float segmentNumber;


varying vec2 v_iconMapUV;

uniform float u_time;
uniform vec4 u_animate: [ 1., 2., 1.0, 0.2 ];


#pragma include "picking"

void main() {
  float animateSpeed = 0.0; // \u8FD0\u52A8\u901F\u5EA6
  float d_distance_ratio = v_line_data.g; // \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B
  gl_FragColor = v_color;

  if(u_line_type == LineTypeDash) {
    float flag = 0.;
    float dashLength = mod(d_distance_ratio, v_dash_array.x + v_dash_array.y + v_dash_array.z + v_dash_array.w);
    if(dashLength < v_dash_array.x || (dashLength > (v_dash_array.x + v_dash_array.y) && dashLength <  v_dash_array.x + v_dash_array.y + v_dash_array.z)) {
      flag = 1.;
    }
    gl_FragColor.a *=flag;
  }

  if(u_animate.x == Animate && u_line_texture != LineTexture) {
      animateSpeed = u_time / u_animate.y;
      float alpha =1.0 - fract( mod(1.0- d_distance_ratio, u_animate.z)* (1.0/ u_animate.z) + u_time / u_animate.y);

      alpha = (alpha + u_animate.w -1.0) / u_animate.w;
      // alpha = smoothstep(0., 1., alpha);
      alpha = clamp(alpha, 0.0, 1.0);
      gl_FragColor.a *= alpha;

      // u_animate 
      // x enable
      // y duration
      // z interval
      // w trailLength
  }

  if(u_line_texture == LineTexture && u_line_type != LineTypeDash) { // while load texture
    // float arcRadio = smoothstep( 0.0, 1.0, (v_segmentIndex / segmentNumber));
    float arcRadio = v_segmentIndex / (segmentNumber - 1.0);
    float count = v_line_data.b; // // \u8D34\u56FE\u5728\u5F27\u7EBF\u4E0A\u91CD\u590D\u7684\u6570\u91CF

    float time = 0.0;
    if(u_animate.x == Animate) {
      time = u_time / u_animate.y;
    }
    float redioCount = arcRadio * count;

    float u = fract(redioCount - time);

    float v = v_line_data.a;  // \u7EBF\u56FE\u5C42\u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\u503C
    vec2 uv= v_iconMapUV / u_textSize + vec2(u, v) / u_textSize * 64.;
    vec4 pattern = texture2D(u_texture, uv);

    if(u_animate.x == Animate) {
      float currentPlane = floor(redioCount - time);
      float textureStep = floor(count * u_animate.z);
      float a = mod(currentPlane, textureStep);
      if(a < textureStep - 1.0) {
        pattern = vec4(0.0);
      }
    }

    if(u_textureBlend == 0.0) { // normal
      pattern.a = 0.0;
      gl_FragColor = filterColor(gl_FragColor + pattern);
    } else { // replace
        pattern.a *= v_color.a;
        if(gl_FragColor.a <= 0.0) {
          pattern.a = 0.0;
          discard;
        } else {
          gl_FragColor = filterColor(pattern);
        }
    }

  } else {
    gl_FragColor = filterColor(gl_FragColor);
  }
}
`,rC=`#define LineTypeSolid 0.0
#define LineTypeDash 1.0
#define Animate 0.0
#define LineTexture 1.0
attribute vec3 a_Position;
attribute vec4 a_Instance;
attribute vec4 a_Color;
attribute float a_Size;

uniform float u_globel;
uniform float u_globel_radius;
uniform float u_global_height: 10;
uniform mat4 u_ModelMatrix;

uniform float segmentNumber;
uniform vec4 u_animate: [ 1., 2., 1.0, 0.2 ];
varying vec4 v_color;

uniform float u_line_type: 0.0;
uniform vec4 u_dash_array: [10.0, 5., 0, 0];
varying vec4 v_dash_array;

uniform float u_icon_step: 100;
uniform float u_line_texture: 0.0;
varying float v_segmentIndex;

attribute vec2 a_iconMapUV;
varying vec2 v_iconMapUV;
varying vec4 v_line_data;

#pragma include "projection"
#pragma include "project"
#pragma include "picking"

float maps (float value, float start1, float stop1, float start2, float stop2) {
  return start2 + (stop2 - start2) * ((value - start1) / (stop1 - start1));
}

float getSegmentRatio(float index) {
  return smoothstep(0.0, 1.0, index / (segmentNumber - 1.0));
}

float paraboloid(vec2 source, vec2 target, float ratio) {
  vec2 x = mix(source, target, ratio);
  vec2 center = mix(source, target, 0.5);
  float dSourceCenter = distance(source, center);
  float dXCenter = distance(x, center);
  return (dSourceCenter + dXCenter) * (dSourceCenter - dXCenter);
}

vec3 getPos(vec2 source, vec2 target, float segmentRatio) {
  float vertex_height = paraboloid(source, target, segmentRatio);

  return vec3(
    mix(source, target, segmentRatio),
    sqrt(max(0.0, vertex_height))
  );
}
vec2 getExtrusionOffset(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
  dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);

  vec2 offset = dir_screenspace * offset_direction * setPickingSize(a_Size) / 2.0;

  return offset;
}
vec2 getNormal(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
  dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
  return reverse_offset_normal(vec3(dir_screenspace,1.0)).xy * sign(offset_direction);
}

float torad(float deg) {
  return (deg / 180.0) * acos(-1.0);
}

vec3 lglt2xyz(vec2 lnglat) {
  float pi = 3.1415926;
  // + Math.PI/2 \u662F\u4E3A\u4E86\u5BF9\u9F50\u5750\u6807
  float lng = torad(lnglat.x) + pi / 2.0;
  float lat = torad(lnglat.y);

  // \u624B\u52A8\u589E\u52A0\u4E00\u4E9B\u504F\u79FB\uFF0C\u51CF\u8F7B\u9762\u7684\u51B2\u7A81
  float radius = u_globel_radius;

  float z = radius * cos(lat) * cos(lng);
  float x = radius * cos(lat) * sin(lng);
  float y = radius * sin(lat);
  return vec3(x, y, z);
}

void main() {

  v_color = a_Color;
  v_color.a = v_color.a * opacity;
  vec2 source = project_position(vec4(a_Instance.rg, 0, 0)).xy;
  vec2 target = project_position(vec4(a_Instance.ba, 0, 0)).xy;
  float segmentIndex = a_Position.x;
  float segmentRatio = getSegmentRatio(segmentIndex);
  float indexDir = mix(-1.0, 1.0, step(segmentIndex, 0.0));

  float d_distance_ratio;
   if(u_line_type == LineTypeDash) {
    d_distance_ratio = segmentIndex / segmentNumber;
    vec2 s = source;
    vec2 t = target;
    
    if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
      s = unProjCustomCoord(source);
      t = unProjCustomCoord(target);
    }
    float total_Distance = pixelDistance(s, t) / 2.0 * PI;
    v_dash_array = pow(2.0, 20.0 - u_Zoom) * u_dash_array / (total_Distance / segmentNumber * segmentIndex);
  }
    if(u_animate.x == Animate) {
      d_distance_ratio = segmentIndex / segmentNumber;
  }
  v_line_data.g = d_distance_ratio; // \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B

  float nextSegmentRatio = getSegmentRatio(segmentIndex + indexDir);
  vec3 curr = getPos(source, target, segmentRatio);
  vec3 next = getPos(source, target, nextSegmentRatio);
  vec2 offset = getExtrusionOffset((next.xy - curr.xy) * indexDir, a_Position.y);
  // v_normal = getNormal((next.xy - curr.xy) * indexDir, a_Position.y);


  v_segmentIndex = a_Position.x;
  if(LineTexture == u_line_texture && u_line_type != LineTypeDash) { // \u5F00\u542F\u8D34\u56FE\u6A21\u5F0F  

    float arcDistrance = length(source - target);
    float pixelLen =  project_pixel_texture(u_icon_step);
    v_line_data.b = floor(arcDistrance/pixelLen); // \u8D34\u56FE\u5728\u5F27\u7EBF\u4E0A\u91CD\u590D\u7684\u6570\u91CF

    vec2 projectOffset = project_pixel(offset);
    float lineOffsetWidth = length(projectOffset + projectOffset * sign(a_Position.y)); // \u7EBF\u6A2A\u5411\u504F\u79FB\u7684\u8DDD\u79BB
    float linePixelSize = project_pixel(a_Size);  // \u5B9A\u70B9\u4F4D\u7F6E\u504F\u79FB\uFF0C\u6309\u5730\u56FE\u7B49\u7EA7\u7F29\u653E\u540E\u7684\u8DDD\u79BB
    v_line_data.a = lineOffsetWidth/linePixelSize;  // \u7EBF\u56FE\u5C42\u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\u503C

    v_iconMapUV = a_iconMapUV;
  }


  gl_Position = project_common_position_to_clipspace_v2(vec4(curr.xy + project_pixel(offset), curr.z * thetaOffset, 1.0));

  // \u5730\u7403\u6A21\u5F0F
  if(u_globel > 0.0) {
    vec3 startLngLat = lglt2xyz(a_Instance.rg);
    vec3 endLngLat = lglt2xyz(a_Instance.ba);
    float globalRadius = length(startLngLat);

    vec3 lineDir = normalize(endLngLat - startLngLat);
    vec3 midPointDir = normalize((startLngLat + endLngLat)/2.0);

    // \u7EBF\u7684\u504F\u79FB
    vec3 lnglatOffset = cross(lineDir, midPointDir) * a_Position.y;
    // \u8BA1\u7B97\u8D77\u59CB\u70B9\u548C\u7EC8\u6B62\u70B9\u7684\u8DDD\u79BB
    float lnglatLength = length(a_Instance.rg - a_Instance.ba)/50.0;
    // \u8BA1\u7B97\u98DE\u7EBF\u5404\u4E2A\u8282\u70B9\u76F8\u5E94\u7684\u9AD8\u5EA6
    float lineHeight = u_global_height * (-4.0*segmentRatio*segmentRatio + 4.0 * segmentRatio) * lnglatLength;
    // \u5730\u7403\u70B9\u4F4D
    vec3 globalPoint = normalize(mix(startLngLat, endLngLat, segmentRatio)) * (globalRadius + lineHeight) + lnglatOffset * a_Size;
    
    gl_Position = u_ViewProjectionMatrix * vec4(globalPoint, 1.0);
  }
 

  setPickingColor(a_PickingColor);
}
`,nC=`
#define Animate 0.0
uniform float u_time;
uniform vec4 u_animate: [ 1., 2., 1.0, 0.2 ];
varying vec4 v_Color;

varying float v_distance_ratio;
#pragma include "picking"

void main() {

  float animateSpeed = 0.0; // \u8FD0\u52A8\u901F\u5EA6
  gl_FragColor = v_Color;

  if(u_animate.x == Animate) {
      animateSpeed = u_time / u_animate.y;
      float alpha =1.0 - fract( mod(1.0- v_distance_ratio, u_animate.z)* (1.0/ u_animate.z) + u_time / u_animate.y);

      alpha = (alpha + u_animate.w -1.0) / u_animate.w;
      // alpha = smoothstep(0., 1., alpha);
      alpha = clamp(alpha, 0.0, 1.0);
      gl_FragColor.a *= alpha;

      // u_animate 
      // x enable
      // y duration
      // z interval
      // w trailLength
  }

  gl_FragColor = filterColor(gl_FragColor);
}
`,iC=`#define LineTypeSolid 0.0
#define LineTypeDash 1.0
#define Animate 0.0
#define LineTexture 1.0
attribute vec3 a_Position;
attribute vec4 a_Instance;
attribute vec4 a_Color;
attribute float a_Size;
attribute vec2 a_iconMapUV;

uniform float u_globel;
uniform float u_globel_radius;
uniform float u_global_height: 10;
uniform mat4 u_ModelMatrix;

uniform float segmentNumber;
uniform vec4 u_animate: [ 1., 2., 1.0, 0.2 ];
uniform vec4 u_sourceColor;
uniform vec4 u_targetColor;

uniform float u_line_type: 0.0;
uniform vec4 u_dash_array: [10.0, 5., 0, 0];
uniform float u_icon_step: 100;
uniform float u_line_texture: 0.0;
varying float v_distance_ratio;

varying vec4 v_dash_array;
varying vec4 v_color;
varying vec2 v_iconMapUV;
varying vec4 v_Color;

#pragma include "projection"
#pragma include "project"
#pragma include "picking"

float maps (float value, float start1, float stop1, float start2, float stop2) {
  return start2 + (stop2 - start2) * ((value - start1) / (stop1 - start1));
}

float getSegmentRatio(float index) {
  return smoothstep(0.0, 1.0, index / (segmentNumber - 1.0));
}

float paraboloid(vec2 source, vec2 target, float ratio) {
  vec2 x = mix(source, target, ratio);
  vec2 center = mix(source, target, 0.5);
  float dSourceCenter = distance(source, center);
  float dXCenter = distance(x, center);
  return (dSourceCenter + dXCenter) * (dSourceCenter - dXCenter);
}

vec3 getPos(vec2 source, vec2 target, float segmentRatio) {
  float vertex_height = paraboloid(source, target, segmentRatio);

  return vec3(
    mix(source, target, segmentRatio),
    sqrt(max(0.0, vertex_height))
  );
}
vec2 getExtrusionOffset(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
  dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);

  vec2 offset = dir_screenspace * offset_direction * setPickingSize(a_Size) / 2.0;

  return offset;
}
vec2 getNormal(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
  dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
  return reverse_offset_normal(vec3(dir_screenspace,1.0)).xy * sign(offset_direction);
}

float torad(float deg) {
  return (deg / 180.0) * acos(-1.0);
}

vec3 lglt2xyz(vec2 lnglat) {
  float pi = 3.1415926;
  // + Math.PI/2 \u662F\u4E3A\u4E86\u5BF9\u9F50\u5750\u6807
  float lng = torad(lnglat.x) + pi / 2.0;
  float lat = torad(lnglat.y);

  // \u624B\u52A8\u589E\u52A0\u4E00\u4E9B\u504F\u79FB\uFF0C\u51CF\u8F7B\u9762\u7684\u51B2\u7A81
  float radius = u_globel_radius;

  float z = radius * cos(lat) * cos(lng);
  float x = radius * cos(lat) * sin(lng);
  float y = radius * sin(lat);
  return vec3(x, y, z);
}

void main() {
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97

  v_color = a_Color;
  vec2 source = project_position(vec4(a_Instance.rg, 0, 0)).xy;
  vec2 target = project_position(vec4(a_Instance.ba, 0, 0)).xy;
  float segmentIndex = a_Position.x;
  float segmentRatio = getSegmentRatio(segmentIndex);
  float indexDir = mix(-1.0, 1.0, step(segmentIndex, 0.0));

  float d_distance_ratio;
   if(u_line_type == LineTypeDash) {
    d_distance_ratio = segmentIndex / segmentNumber;
    // float total_Distance = pixelDistance(a_Instance.rg, a_Instance.ba) / 2.0 * PI;
    vec2 s = source;
    vec2 t = target;
    
    if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
      s = unProjCustomCoord(source);
      t = unProjCustomCoord(target);
    }
    float total_Distance = pixelDistance(s, t) / 2.0 * PI;
    v_dash_array = pow(2.0, 20.0 - u_Zoom) * u_dash_array / (total_Distance / segmentNumber * segmentIndex);
  }
    if(u_animate.x == Animate) {
      v_distance_ratio = segmentIndex / segmentNumber;
  }


  float nextSegmentRatio = getSegmentRatio(segmentIndex + indexDir);
  vec3 curr = getPos(source, target, segmentRatio);
  vec3 next = getPos(source, target, nextSegmentRatio);
  vec2 offset = getExtrusionOffset((next.xy - curr.xy) * indexDir, a_Position.y);

  float animateSpeed = 0.0; // \u8FD0\u52A8\u901F\u5EA6
  v_Color = mix(u_sourceColor, u_targetColor, a_Position.x/segmentNumber);

  v_Color.a *= opacity;

  gl_Position = project_common_position_to_clipspace_v2(vec4(curr.xy + project_pixel(offset), curr.z, 1.0));

  // \u5730\u7403\u6A21\u5F0F
  if(u_globel > 0.0) {
    vec3 startLngLat = lglt2xyz(a_Instance.rg);
    vec3 endLngLat = lglt2xyz(a_Instance.ba);
    float globalRadius = length(startLngLat);

    vec3 lineDir = normalize(endLngLat - startLngLat);
    vec3 midPointDir = normalize((startLngLat + endLngLat)/2.0);

    // \u7EBF\u7684\u504F\u79FB
    vec3 lnglatOffset = cross(lineDir, midPointDir) * a_Position.y;
    // \u8BA1\u7B97\u8D77\u59CB\u70B9\u548C\u7EC8\u6B62\u70B9\u7684\u8DDD\u79BB
    float lnglatLength = length(a_Instance.rg - a_Instance.ba)/50.0;
    // \u8BA1\u7B97\u98DE\u7EBF\u5404\u4E2A\u8282\u70B9\u76F8\u5E94\u7684\u9AD8\u5EA6
    float lineHeight = u_global_height * (-4.0*segmentRatio*segmentRatio + 4.0 * segmentRatio) * lnglatLength;
    // \u5730\u7403\u70B9\u4F4D
    vec3 globalPoint = normalize(mix(startLngLat, endLngLat, segmentRatio)) * (globalRadius + lineHeight) + lnglatOffset * a_Size;
    
    gl_Position = u_ViewProjectionMatrix * vec4(globalPoint, 1.0);
  }
 

  setPickingColor(a_PickingColor);
}
`,aC={solid:0,dash:1},oC=function(e){(0,Ne.Z)(t,e);var i=J3(t);function t(){var n;(0,se.Z)(this,t);for(var r=arguments.length,a=new Array(r),u=0;u<r;u++)a[u]=arguments[u];return n=i.call.apply(i,[this].concat(a)),(0,Me.Z)((0,xt.Z)(n),"updateTexture",function(){var c=n.rendererService.createTexture2D;if(n.texture){n.texture.update({data:n.iconService.getCanvas()}),n.layer.render();return}n.texture=c({data:n.iconService.getCanvas(),mag:je.NEAREST,min:je.NEAREST,premultiplyAlpha:!1,width:1024,height:n.iconService.canvasHeight||128})}),n}return(0,be.Z)(t,[{key:"getUninforms",value:function(){var r=this.layer.getLayerConfig(),a=r.sourceColor,u=r.targetColor,c=r.textureBlend,g=c===void 0?"normal":c,x=r.lineType,M=x===void 0?"solid":x,O=r.dashArray,B=O===void 0?[10,5]:O,W=r.lineTexture,ce=W===void 0?!1:W,oe=r.iconStep,Te=oe===void 0?100:oe,Ze=r.segmentNumber,qe=Ze===void 0?30:Ze,et=r.globalArcHeight,yt=et===void 0?10:et;B.length===2&&B.push(0,0);var bt=0,Ot=[0,0,0,0],jt=[0,0,0,0];return a&&u&&(Ot=Ni(a),jt=Ni(u),bt=1),this.rendererService.getDirty()&&this.texture.bind(),(0,X.Z)({u_globel:this.mapService.version==="GLOBEL"?1:0,u_globel_radius:ug,u_global_height:yt,u_textureBlend:g==="normal"?0:1,segmentNumber:qe,u_line_type:aC[M]||0,u_dash_array:B,u_texture:this.texture,u_line_texture:ce?1:0,u_icon_step:Te,u_textSize:[1024,this.iconService.canvasHeight||128],u_linearColor:bt,u_sourceColor:Ot,u_targetColor:jt},this.getStyleAttribute())}},{key:"getAnimateUniforms",value:function(){var r=this.layer.getLayerConfig(),a=r.animateOption;return{u_animate:this.animateOption2Array(a),u_time:this.layer.getLayerAnimateTime()}}},{key:"initModels",value:function(){var n=(0,ur.Z)(it().mark(function a(){return it().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return this.updateTexture(),this.iconService.on("imageUpdate",this.updateTexture),c.abrupt("return",this.buildModels());case 3:case"end":return c.stop()}},a,this)}));function r(){return n.apply(this,arguments)}return r}()},{key:"clearModels",value:function(){var r;(r=this.texture)===null||r===void 0||r.destroy(),this.iconService.off("imageUpdate",this.updateTexture)}},{key:"getShaders",value:function(){var r=this.layer.getLayerConfig(),a=r.sourceColor,u=r.targetColor;return a&&u?{frag:nC,vert:iC,type:"Linear"}:{frag:tC,vert:rC,type:""}}},{key:"buildModels",value:function(){var n=(0,ur.Z)(it().mark(function a(){var u,c,g,x,M,O,B,W;return it().wrap(function(oe){for(;;)switch(oe.prev=oe.next){case 0:return u=this.layer.getLayerConfig(),c=u.segmentNumber,g=c===void 0?30:c,x=this.getShaders(),M=x.frag,O=x.vert,B=x.type,oe.next=4,this.layer.buildLayerModel({moduleName:"lineArc3d"+B,vertexShader:O,fragmentShader:M,inject:this.getInject(),triangulation:Nd,styleOption:{segmentNumber:g}});case 4:return W=oe.sent,oe.abrupt("return",[W]);case 6:case"end":return oe.stop()}},a,this)}));function r(){return n.apply(this,arguments)}return r}()},{key:"registerBuiltinAttributes",value:function(){var r=this;this.styleAttributeService.registerStyleAttribute({name:"size",type:mn.Attribute,descriptor:{name:"a_Size",buffer:{usage:je.DYNAMIC_DRAW,data:[],type:je.FLOAT},size:1,update:function(u){var c=u.size,g=c===void 0?1:c;return Array.isArray(g)?[g[0]]:[g]}}}),this.styleAttributeService.registerStyleAttribute({name:"instance",type:mn.Attribute,descriptor:{name:"a_Instance",buffer:{usage:je.STATIC_DRAW,data:[],type:je.FLOAT},size:4,update:function(u,c,g){return[g[3],g[4],g[5],g[6]]}}}),this.styleAttributeService.registerStyleAttribute({name:"uv",type:mn.Attribute,descriptor:{name:"a_iconMapUV",buffer:{usage:je.DYNAMIC_DRAW,data:[],type:je.FLOAT},size:2,update:function(u){var c=r.iconService.getIconMap(),g=u.texture,x=c[g]||{x:0,y:0},M=x.x,O=x.y;return[M,O]}}})}}]),t}(vo);function sC(e){var i=uC();return function(){var n=(0,ue.Z)(e),r;if(i){var a=(0,ue.Z)(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return(0,ze.Z)(this,r)}}function uC(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var lC=`#define LineTypeSolid 0.0
#define LineTypeDash 1.0
#define Animate 0.0
#define LineTexture 1.0

uniform float u_textureBlend;
uniform float u_blur : 0.9;
uniform float u_line_type: 0.0;
// varying vec2 v_normal;
varying vec4 v_dash_array;
varying vec4 v_color;
varying vec4 v_line_data;

uniform float u_line_texture: 0.0;
uniform sampler2D u_texture;
uniform vec2 u_textSize;
varying float v_segmentIndex;
uniform float segmentNumber;


varying vec2 v_iconMapUV;

uniform float u_time;
uniform vec4 u_animate: [ 1., 2., 1.0, 0.2 ];


#pragma include "picking"

void main() {
  float animateSpeed = 0.0; // \u8FD0\u52A8\u901F\u5EA6
  float d_distance_ratio = v_line_data.g; // \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B
  gl_FragColor = v_color;

  if(u_line_type == LineTypeDash) {
    float flag = 0.;
    float dashLength = mod(d_distance_ratio, v_dash_array.x + v_dash_array.y + v_dash_array.z + v_dash_array.w);
    if(dashLength < v_dash_array.x || (dashLength > (v_dash_array.x + v_dash_array.y) && dashLength <  v_dash_array.x + v_dash_array.y + v_dash_array.z)) {
      flag = 1.;
    }
    gl_FragColor.a *=flag;
  }

  if(u_animate.x == Animate && u_line_texture != LineTexture) {
      animateSpeed = u_time / u_animate.y;
      float alpha =1.0 - fract( mod(1.0- d_distance_ratio, u_animate.z)* (1.0/ u_animate.z) + u_time / u_animate.y);

      alpha = (alpha + u_animate.w -1.0) / u_animate.w;
      // alpha = smoothstep(0., 1., alpha);
      alpha = clamp(alpha, 0.0, 1.0);
      gl_FragColor.a *= alpha;

      // u_animate 
      // x enable
      // y duration
      // z interval
      // w trailLength
  }

  if(u_line_texture == LineTexture && u_line_type != LineTypeDash) { // while load texture
    // float arcRadio = smoothstep( 0.0, 1.0, (v_segmentIndex / segmentNumber));
    float arcRadio = v_segmentIndex / (segmentNumber - 1.0);
    float count = v_line_data.b; // // \u8D34\u56FE\u5728\u5F27\u7EBF\u4E0A\u91CD\u590D\u7684\u6570\u91CF

    float time = 0.0;
    if(u_animate.x == Animate) {
      time = u_time / u_animate.y;
    }
    float redioCount = arcRadio * count;

    float u = fract(redioCount - time);

    float v = v_line_data.a;  // \u7EBF\u56FE\u5C42\u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\u503C
    vec2 uv= v_iconMapUV / u_textSize + vec2(u, v) / u_textSize * 64.;
    vec4 pattern = texture2D(u_texture, uv);

    if(u_animate.x == Animate) {
      float currentPlane = floor(redioCount - time);
      float textureStep = floor(count * u_animate.z);
      float a = mod(currentPlane, textureStep);
      if(a < textureStep - 1.0) {
        pattern = vec4(0.0);
      }
    }

    if(u_textureBlend == 0.0) { // normal
      pattern.a = 0.0;
      gl_FragColor = filterColor(gl_FragColor + pattern);
    } else { // replace
        pattern.a *= v_color.a;
        if(gl_FragColor.a <= 0.0) {
          pattern.a = 0.0;
          discard;
        } else {
          gl_FragColor = filterColor(pattern);
        }
    }

  } else {
    gl_FragColor = filterColor(gl_FragColor);
  }
}
`,cC=`#define LineTypeSolid 0.0
#define LineTypeDash 1.0
#define Animate 0.0
#define LineTexture 1.0
attribute vec3 a_Position;
attribute vec4 a_Instance;
attribute vec4 a_Color;
attribute float a_Size;

uniform float u_globel;
uniform float u_globel_radius;
uniform float u_global_height: 10;
uniform mat4 u_ModelMatrix;

uniform float segmentNumber;
uniform vec4 u_animate: [ 1., 2., 1.0, 0.2 ];
varying vec4 v_color;

uniform float u_line_type: 0.0;
uniform vec4 u_dash_array: [10.0, 5., 0, 0];
varying vec4 v_dash_array;

uniform float u_icon_step: 100;
uniform float u_line_texture: 0.0;
varying float v_segmentIndex;

attribute vec2 a_iconMapUV;
varying vec2 v_iconMapUV;
varying vec4 v_line_data;

#pragma include "projection"
#pragma include "project"
#pragma include "picking"

float maps (float value, float start1, float stop1, float start2, float stop2) {
  return start2 + (stop2 - start2) * ((value - start1) / (stop1 - start1));
}

float getSegmentRatio(float index) {
  return smoothstep(0.0, 1.0, index / (segmentNumber - 1.0));
}

float paraboloid(vec2 source, vec2 target, float ratio) {
  vec2 x = mix(source, target, ratio);
  vec2 center = mix(source, target, 0.5);
  float dSourceCenter = distance(source, center);
  float dXCenter = distance(x, center);
  return (dSourceCenter + dXCenter) * (dSourceCenter - dXCenter);
}

vec3 getPos(vec2 source, vec2 target, float segmentRatio) {
  float vertex_height = paraboloid(source, target, segmentRatio);

  return vec3(
    mix(source, target, segmentRatio),
    sqrt(max(0.0, vertex_height))
  );
}
vec2 getExtrusionOffset(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
  dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);

  vec2 offset = dir_screenspace * offset_direction * setPickingSize(a_Size) / 2.0;

  return offset;
}
vec2 getNormal(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
  dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
  return reverse_offset_normal(vec3(dir_screenspace,1.0)).xy * sign(offset_direction);
}

float torad(float deg) {
  return (deg / 180.0) * acos(-1.0);
}

vec3 lglt2xyz(vec2 lnglat) {
  float pi = 3.1415926;
  // + Math.PI/2 \u662F\u4E3A\u4E86\u5BF9\u9F50\u5750\u6807
  float lng = torad(lnglat.x) + pi / 2.0;
  float lat = torad(lnglat.y);

  // \u624B\u52A8\u589E\u52A0\u4E00\u4E9B\u504F\u79FB\uFF0C\u51CF\u8F7B\u9762\u7684\u51B2\u7A81
  float radius = u_globel_radius;

  float z = radius * cos(lat) * cos(lng);
  float x = radius * cos(lat) * sin(lng);
  float y = radius * sin(lat);
  return vec3(x, y, z);
}

void main() {

  v_color = a_Color;
  v_color.a = v_color.a * opacity;
  vec2 source = project_position(vec4(a_Instance.rg, 0, 0)).xy;
  vec2 target = project_position(vec4(a_Instance.ba, 0, 0)).xy;
  float segmentIndex = a_Position.x;
  float segmentRatio = getSegmentRatio(segmentIndex);
  float indexDir = mix(-1.0, 1.0, step(segmentIndex, 0.0));

  float d_distance_ratio;
   if(u_line_type == LineTypeDash) {
    d_distance_ratio = segmentIndex / segmentNumber;
    vec2 s = source;
    vec2 t = target;
    
    if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
      s = unProjCustomCoord(source);
      t = unProjCustomCoord(target);
    }
    float total_Distance = pixelDistance(s, t) / 2.0 * PI;
    v_dash_array = pow(2.0, 20.0 - u_Zoom) * u_dash_array / (total_Distance / segmentNumber * segmentIndex);
  }
    if(u_animate.x == Animate) {
      d_distance_ratio = segmentIndex / segmentNumber;
  }
  v_line_data.g = d_distance_ratio; // \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B

  float nextSegmentRatio = getSegmentRatio(segmentIndex + indexDir);
  vec3 curr = getPos(source, target, segmentRatio);
  vec3 next = getPos(source, target, nextSegmentRatio);
  vec2 offset = getExtrusionOffset((next.xy - curr.xy) * indexDir, a_Position.y);
  // v_normal = getNormal((next.xy - curr.xy) * indexDir, a_Position.y);


  v_segmentIndex = a_Position.x;
  if(LineTexture == u_line_texture && u_line_type != LineTypeDash) { // \u5F00\u542F\u8D34\u56FE\u6A21\u5F0F  

    float arcDistrance = length(source - target);
    float pixelLen =  project_pixel_texture(u_icon_step);
    v_line_data.b = floor(arcDistrance/pixelLen); // \u8D34\u56FE\u5728\u5F27\u7EBF\u4E0A\u91CD\u590D\u7684\u6570\u91CF

    vec2 projectOffset = project_pixel(offset);
    float lineOffsetWidth = length(projectOffset + projectOffset * sign(a_Position.y)); // \u7EBF\u6A2A\u5411\u504F\u79FB\u7684\u8DDD\u79BB
    float linePixelSize = project_pixel(a_Size);  // \u5B9A\u70B9\u4F4D\u7F6E\u504F\u79FB\uFF0C\u6309\u5730\u56FE\u7B49\u7EA7\u7F29\u653E\u540E\u7684\u8DDD\u79BB
    v_line_data.a = lineOffsetWidth/linePixelSize;  // \u7EBF\u56FE\u5C42\u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\u503C

    v_iconMapUV = a_iconMapUV;
  }


  gl_Position = project_common_position_to_clipspace_v2(vec4(curr.xy + project_pixel(offset), curr.z * thetaOffset, 1.0));

  // \u5730\u7403\u6A21\u5F0F
  if(u_globel > 0.0) {
    vec3 startLngLat = lglt2xyz(a_Instance.rg);
    vec3 endLngLat = lglt2xyz(a_Instance.ba);
    float globalRadius = length(startLngLat);

    vec3 lineDir = normalize(endLngLat - startLngLat);
    vec3 midPointDir = normalize((startLngLat + endLngLat)/2.0);

    // \u7EBF\u7684\u504F\u79FB
    vec3 lnglatOffset = cross(lineDir, midPointDir) * a_Position.y;
    // \u8BA1\u7B97\u8D77\u59CB\u70B9\u548C\u7EC8\u6B62\u70B9\u7684\u8DDD\u79BB
    float lnglatLength = length(a_Instance.rg - a_Instance.ba)/50.0;
    // \u8BA1\u7B97\u98DE\u7EBF\u5404\u4E2A\u8282\u70B9\u76F8\u5E94\u7684\u9AD8\u5EA6
    float lineHeight = u_global_height * (-4.0*segmentRatio*segmentRatio + 4.0 * segmentRatio) * lnglatLength;
    // \u5730\u7403\u70B9\u4F4D
    vec3 globalPoint = normalize(mix(startLngLat, endLngLat, segmentRatio)) * (globalRadius + lineHeight) + lnglatOffset * a_Size;
    
    gl_Position = u_ViewProjectionMatrix * vec4(globalPoint, 1.0);
  }
 

  setPickingColor(a_PickingColor);
}
`,fC=`
#define Animate 0.0
uniform float u_time;
uniform vec4 u_animate: [ 1., 2., 1.0, 0.2 ];
varying vec4 v_Color;

varying float v_distance_ratio;
#pragma include "picking"

void main() {

  float animateSpeed = 0.0; // \u8FD0\u52A8\u901F\u5EA6
  gl_FragColor = v_Color;

  if(u_animate.x == Animate) {
      animateSpeed = u_time / u_animate.y;
      float alpha =1.0 - fract( mod(1.0- v_distance_ratio, u_animate.z)* (1.0/ u_animate.z) + u_time / u_animate.y);

      alpha = (alpha + u_animate.w -1.0) / u_animate.w;
      // alpha = smoothstep(0., 1., alpha);
      alpha = clamp(alpha, 0.0, 1.0);
      gl_FragColor.a *= alpha;

      // u_animate 
      // x enable
      // y duration
      // z interval
      // w trailLength
  }

  gl_FragColor = filterColor(gl_FragColor);
}
`,hC=`#define LineTypeSolid 0.0
#define LineTypeDash 1.0
#define Animate 0.0
#define LineTexture 1.0
attribute vec3 a_Position;
attribute vec4 a_Instance;
attribute vec4 a_Color;
attribute float a_Size;
attribute vec2 a_iconMapUV;

uniform float u_globel;
uniform float u_globel_radius;
uniform float u_global_height: 10;
uniform mat4 u_ModelMatrix;

uniform float segmentNumber;
uniform vec4 u_animate: [ 1., 2., 1.0, 0.2 ];
uniform vec4 u_sourceColor;
uniform vec4 u_targetColor;

uniform float u_line_type: 0.0;
uniform vec4 u_dash_array: [10.0, 5., 0, 0];
uniform float u_icon_step: 100;
uniform float u_line_texture: 0.0;
varying float v_distance_ratio;

varying vec4 v_dash_array;
varying vec4 v_color;
varying vec2 v_iconMapUV;
varying vec4 v_Color;

#pragma include "projection"
#pragma include "project"
#pragma include "picking"

float maps (float value, float start1, float stop1, float start2, float stop2) {
  return start2 + (stop2 - start2) * ((value - start1) / (stop1 - start1));
}

float getSegmentRatio(float index) {
  return smoothstep(0.0, 1.0, index / (segmentNumber - 1.0));
}

float paraboloid(vec2 source, vec2 target, float ratio) {
  vec2 x = mix(source, target, ratio);
  vec2 center = mix(source, target, 0.5);
  float dSourceCenter = distance(source, center);
  float dXCenter = distance(x, center);
  return (dSourceCenter + dXCenter) * (dSourceCenter - dXCenter);
}

vec3 getPos(vec2 source, vec2 target, float segmentRatio) {
  float vertex_height = paraboloid(source, target, segmentRatio);

  return vec3(
    mix(source, target, segmentRatio),
    sqrt(max(0.0, vertex_height))
  );
}
vec2 getExtrusionOffset(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
  dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);

  vec2 offset = dir_screenspace * offset_direction * setPickingSize(a_Size) / 2.0;

  return offset;
}
vec2 getNormal(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
  dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
  return reverse_offset_normal(vec3(dir_screenspace,1.0)).xy * sign(offset_direction);
}

float torad(float deg) {
  return (deg / 180.0) * acos(-1.0);
}

vec3 lglt2xyz(vec2 lnglat) {
  float pi = 3.1415926;
  // + Math.PI/2 \u662F\u4E3A\u4E86\u5BF9\u9F50\u5750\u6807
  float lng = torad(lnglat.x) + pi / 2.0;
  float lat = torad(lnglat.y);

  // \u624B\u52A8\u589E\u52A0\u4E00\u4E9B\u504F\u79FB\uFF0C\u51CF\u8F7B\u9762\u7684\u51B2\u7A81
  float radius = u_globel_radius;

  float z = radius * cos(lat) * cos(lng);
  float x = radius * cos(lat) * sin(lng);
  float y = radius * sin(lat);
  return vec3(x, y, z);
}

void main() {
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97

  v_color = a_Color;
  vec2 source = project_position(vec4(a_Instance.rg, 0, 0)).xy;
  vec2 target = project_position(vec4(a_Instance.ba, 0, 0)).xy;
  float segmentIndex = a_Position.x;
  float segmentRatio = getSegmentRatio(segmentIndex);
  float indexDir = mix(-1.0, 1.0, step(segmentIndex, 0.0));

  float d_distance_ratio;
   if(u_line_type == LineTypeDash) {
    d_distance_ratio = segmentIndex / segmentNumber;
    // float total_Distance = pixelDistance(a_Instance.rg, a_Instance.ba) / 2.0 * PI;
    vec2 s = source;
    vec2 t = target;
    
    if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
      s = unProjCustomCoord(source);
      t = unProjCustomCoord(target);
    }
    float total_Distance = pixelDistance(s, t) / 2.0 * PI;
    v_dash_array = pow(2.0, 20.0 - u_Zoom) * u_dash_array / (total_Distance / segmentNumber * segmentIndex);
  }
    if(u_animate.x == Animate) {
      v_distance_ratio = segmentIndex / segmentNumber;
  }


  float nextSegmentRatio = getSegmentRatio(segmentIndex + indexDir);
  vec3 curr = getPos(source, target, segmentRatio);
  vec3 next = getPos(source, target, nextSegmentRatio);
  vec2 offset = getExtrusionOffset((next.xy - curr.xy) * indexDir, a_Position.y);

  float animateSpeed = 0.0; // \u8FD0\u52A8\u901F\u5EA6
  v_Color = mix(u_sourceColor, u_targetColor, a_Position.x/segmentNumber);

  v_Color.a *= opacity;

  gl_Position = project_common_position_to_clipspace_v2(vec4(curr.xy + project_pixel(offset), curr.z, 1.0));

  // \u5730\u7403\u6A21\u5F0F
  if(u_globel > 0.0) {
    vec3 startLngLat = lglt2xyz(a_Instance.rg);
    vec3 endLngLat = lglt2xyz(a_Instance.ba);
    float globalRadius = length(startLngLat);

    vec3 lineDir = normalize(endLngLat - startLngLat);
    vec3 midPointDir = normalize((startLngLat + endLngLat)/2.0);

    // \u7EBF\u7684\u504F\u79FB
    vec3 lnglatOffset = cross(lineDir, midPointDir) * a_Position.y;
    // \u8BA1\u7B97\u8D77\u59CB\u70B9\u548C\u7EC8\u6B62\u70B9\u7684\u8DDD\u79BB
    float lnglatLength = length(a_Instance.rg - a_Instance.ba)/50.0;
    // \u8BA1\u7B97\u98DE\u7EBF\u5404\u4E2A\u8282\u70B9\u76F8\u5E94\u7684\u9AD8\u5EA6
    float lineHeight = u_global_height * (-4.0*segmentRatio*segmentRatio + 4.0 * segmentRatio) * lnglatLength;
    // \u5730\u7403\u70B9\u4F4D
    vec3 globalPoint = normalize(mix(startLngLat, endLngLat, segmentRatio)) * (globalRadius + lineHeight) + lnglatOffset * a_Size;
    
    gl_Position = u_ViewProjectionMatrix * vec4(globalPoint, 1.0);
  }
 

  setPickingColor(a_PickingColor);
}
`,AC={solid:0,dash:1},pC=function(e){(0,Ne.Z)(t,e);var i=sC(t);function t(){var n;(0,se.Z)(this,t);for(var r=arguments.length,a=new Array(r),u=0;u<r;u++)a[u]=arguments[u];return n=i.call.apply(i,[this].concat(a)),(0,Me.Z)((0,xt.Z)(n),"updateTexture",function(){var c=n.rendererService.createTexture2D;if(n.texture){n.texture.update({data:n.iconService.getCanvas()}),n.layer.render();return}n.texture=c({data:n.iconService.getCanvas(),mag:je.NEAREST,min:je.NEAREST,premultiplyAlpha:!1,width:1024,height:n.iconService.canvasHeight||128})}),n}return(0,be.Z)(t,[{key:"getUninforms",value:function(){var r=this.layer.getLayerConfig(),a=r.opacity,u=a===void 0?1:a,c=r.sourceColor,g=r.targetColor,x=r.textureBlend,M=x===void 0?"normal":x,O=r.lineType,B=O===void 0?"solid":O,W=r.dashArray,ce=W===void 0?[10,5]:W,oe=r.lineTexture,Te=oe===void 0?!1:oe,Ze=r.iconStep,qe=Ze===void 0?100:Ze,et=r.segmentNumber,yt=et===void 0?30:et,bt=r.globalArcHeight,Ot=bt===void 0?10:bt;ce.length===2&&ce.push(0,0);var jt=0,or=[0,0,0,0],ar=[0,0,0,0];return c&&g&&(or=Ni(c),ar=Ni(g),jt=1),this.rendererService.getDirty()&&this.texture.bind(),{u_globel:1,u_globel_radius:ug,u_global_height:Ot,u_opacity:u,u_textureBlend:M==="normal"?0:1,segmentNumber:yt,u_line_type:AC[B]||0,u_dash_array:ce,u_texture:this.texture,u_line_texture:Te?1:0,u_icon_step:qe,u_textSize:[1024,this.iconService.canvasHeight||128],u_linearColor:jt,u_sourceColor:or,u_targetColor:ar}}},{key:"getAnimateUniforms",value:function(){var r=this.layer.getLayerConfig(),a=r.animateOption;return{u_animate:this.animateOption2Array(a),u_time:this.layer.getLayerAnimateTime()}}},{key:"initModels",value:function(){var n=(0,ur.Z)(it().mark(function a(){return it().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return this.updateTexture(),this.iconService.on("imageUpdate",this.updateTexture),c.abrupt("return",this.buildModels());case 3:case"end":return c.stop()}},a,this)}));function r(){return n.apply(this,arguments)}return r}()},{key:"clearModels",value:function(){var r;(r=this.texture)===null||r===void 0||r.destroy(),this.iconService.off("imageUpdate",this.updateTexture)}},{key:"getShaders",value:function(){var r=this.layer.getLayerConfig(),a=r.sourceColor,u=r.targetColor;return a&&u?{frag:fC,vert:hC,type:"Linear"}:{frag:lC,vert:cC,type:""}}},{key:"buildModels",value:function(){var n=(0,ur.Z)(it().mark(function a(){var u,c,g,x,M,O,B,W;return it().wrap(function(oe){for(;;)switch(oe.prev=oe.next){case 0:return u=this.layer.getLayerConfig(),c=u.segmentNumber,g=c===void 0?30:c,x=this.getShaders(),M=x.frag,O=x.vert,B=x.type,oe.next=4,this.layer.buildLayerModel({moduleName:"lineEarthArc3d"+B,vertexShader:O,fragmentShader:M,triangulation:Nd,depth:{enable:!0},styleOption:{segmentNumber:g}});case 4:return W=oe.sent,oe.abrupt("return",[W]);case 6:case"end":return oe.stop()}},a,this)}));function r(){return n.apply(this,arguments)}return r}()},{key:"registerBuiltinAttributes",value:function(){var r=this;this.styleAttributeService.registerStyleAttribute({name:"size",type:mn.Attribute,descriptor:{name:"a_Size",buffer:{usage:je.DYNAMIC_DRAW,data:[],type:je.FLOAT},size:1,update:function(u){var c=u.size,g=c===void 0?1:c;return Array.isArray(g)?[g[0]]:[g]}}}),this.styleAttributeService.registerStyleAttribute({name:"instance",type:mn.Attribute,descriptor:{name:"a_Instance",buffer:{usage:je.STATIC_DRAW,data:[],type:je.FLOAT},size:4,update:function(u,c,g){return[g[3],g[4],g[5],g[6]]}}}),this.styleAttributeService.registerStyleAttribute({name:"uv",type:mn.Attribute,descriptor:{name:"a_iconMapUV",buffer:{usage:je.DYNAMIC_DRAW,data:[],type:je.FLOAT},size:2,update:function(u){var c=r.iconService.getIconMap(),g=u.texture,x=c[g]||{x:0,y:0},M=x.x,O=x.y;return[M,O]}}})}}]),t}(vo),p1={circle:2,triangle:2,diamond:4,rect:2,classic:3,halfTriangle:2,none:0},Kl=1/2;function dC(e,i){var t=i.width,n=t===void 0?2:t,r=i.height,a=r===void 0?1:r;return{vertices:[0,Kl*e,1*e*n,-(a+Kl)*e,1*e*n,(a-Kl)*e,0,Kl*e,1*e*n,-(a+Kl)*e,1*e*n,(a-Kl)*e],indices:[3,4,5],outLineIndices:[0,1,2],normals:[1*e,-2*e,1,-2*e,1.5*e,1,1*e,1.5*e,1,0,0,0,0,0,0,0,0,0],dimensions:2}}function vC(e,i){var t=i.width,n=t===void 0?2:t,r=i.height,a=r===void 0?3:r;return{vertices:[0,0,1*e*n,1*a,1*e*n,-1*a,0,0,1*e*n,1*a,1*e*n,-1*a],outLineIndices:[0,1,2],indices:[3,4,5],normals:[0,-1.5*e,1,2,1*e,1,-2,1*e,1,0,0,0,0,0,0,0,0,0],dimensions:2}}function gC(e,i){var t=i.width,n=t===void 0?2:t,r=i.height,a=r===void 0?2:r;return{vertices:[0,a/2,e*n*1,a/2,e*n*1,-a/2,0,-a/2,0,a/2,e*n*1,a/2,e*n*1,-a/2,0,-a/2],dimensions:2,indices:[4,5,6,4,6,7],outLineIndices:[0,1,2,0,2,3],normals:[0,-e,1,1,0,1,0,-e,1,-1,-0,1,0,0,0,0,0,0,0,0,0,0,0,0]}}function mC(e,i){var t=i.width,n=t===void 0?2:t,r=i.height,a=r===void 0?3:r;return{vertices:[0,0,1*n*e,.5*a,2*n*e,0,1*n*e,-.5*a,0,0,1*n*e,.5*a,2*n*e,0,1*n*e,-.5*a],dimensions:2,indices:[4,5,6,4,6,7],outLineIndices:[0,1,2,0,2,3],normals:[0,-e,1,1,0,1,0,-e,1,-1,-0,1,0,0,0,0,0,0,0,0,0,0,0,0]}}function yC(e,i){var t=i.width,n=t===void 0?2:t,r=i.height,a=r===void 0?3:r;return{vertices:[0,0,2*e*n,1*a,1.5*e*n,0,2*e*n,-1*a,0,0,2*e*n,1*a,1.5*e*n,0,2*e*n,-1*a],dimensions:2,indices:[4,5,6,4,6,7],outLineIndices:[0,1,2,0,2,3],normals:[0,-e,1,1,0,1,0,-e,1,-1,-0,1,0,0,0,0,0,0,0,0,0,0,0,0]}}function _C(e,i){var t=i.width,n=t===void 0?2:t,r=i.height,a=r===void 0?2:r,u=Ag(),c=oa().flatten([u]),g=oa()(c.vertices,c.holes,c.dimensions),x=u.map(function(M){return[M[0]*n*e,M[1]*a]}).flat();return{vertices:[].concat((0,pr.Z)(x),(0,pr.Z)(x)),dimensions:2,indices:g.map(function(M){return M+u.length}),outLineIndices:g,normals:[].concat((0,pr.Z)(u.map(function(M){return[M[1]*a,M[0]*n*e,1]}).flat()),(0,pr.Z)(new Array(u.length*3).fill(0)))}}function xC(e){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,t=arguments.length>2?arguments[2]:void 0,n=(0,ia.Z)(t.source)==="object"?t.source.type:t.source,r=(0,ia.Z)(t.target)==="object"?t.target.type:t.target,a=(0,ia.Z)(t.source)==="object"?t.source:{},u=a.width,c=u===void 0?n?p1[n]:0:u,g=a.height,x=g===void 0?2:g,M=(0,ia.Z)(t.target)==="object"?t.target:{},O=M.width,B=O===void 0?r?p1[r]:0:O,W=M.height,ce=W===void 0?2:W;return{vertices:[0,Kl,1*c].concat((0,pr.Z)(e),[1,Kl,-1*B],(0,pr.Z)(e),[1,-Kl,-1*B],(0,pr.Z)(e),[0,-Kl,1*c],(0,pr.Z)(e),[0,Kl,1*c],(0,pr.Z)(e),[1,Kl,-1*B],(0,pr.Z)(e),[1,-Kl,-1*B],(0,pr.Z)(e),[0,-Kl,1*c],(0,pr.Z)(e)),outLineIndices:[0,1,2,0,2,3].map(function(oe){return oe+i}),indices:[4,5,6,4,6,7].map(function(oe){return oe+i}),normals:[1,-1,1,1,1,1,-1,0,1,-1,0,1,0,0,0,0,0,0,0,0,0,0,0,0],dimensions:2}}function d1(e,i){var t=(0,ia.Z)(e)==="object"?e.type:e,n=i==="source"?1:-1,r=(0,ia.Z)(e)==="object"?e:{};switch(t){case"circle":return _C(n,r);case"triangle":return vC(n,r);case"diamond":return mC(n,r);case"rect":return gC(n,r);case"classic":return yC(n,r);case"halfTriangle":return dC(n,r);default:return{vertices:[],indices:[],normals:[],dimensions:2,outLineIndices:[],outLineNormals:[]}}}function EC(e){var i=e.coordinates.flat(),t=1,n=1;return{vertices:[1,0,0].concat((0,pr.Z)(i),[1,2,-3],(0,pr.Z)(i),[1,1,-3],(0,pr.Z)(i),[0,1,0],(0,pr.Z)(i),[0,0,0],(0,pr.Z)(i),[1,0,0],(0,pr.Z)(i),[1,2,-3],(0,pr.Z)(i),[1,1,-3],(0,pr.Z)(i),[0,1,0],(0,pr.Z)(i),[0,0,0],(0,pr.Z)(i)),normals:[-t,2*n,1,2*n,-n,1,n,-n,1,n,-n,1,-t,-n,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],indices:[0,1,2,0,2,3,0,3,4,5,6,7,5,7,8,5,8,9],size:7}}function bC(e,i){return i?SC(e,i):EC(e)}function SC(e,i){var t=e.coordinates.flat(),n=i,r=n.target,a=r===void 0?"classic":r,u=n.source,c=u===void 0?"circle":u,g=v1(d1(c,"source"),t,0,0),x=xC(t,g.vertices.length/7,i),M=v1(d1(a,"target"),t,1,g.vertices.length/7+x.vertices.length/7),O={vertices:[].concat((0,pr.Z)(g.vertices),(0,pr.Z)(x.vertices),(0,pr.Z)(M.vertices)),indices:[].concat((0,pr.Z)(g.outLineIndices),(0,pr.Z)(x.outLineIndices),(0,pr.Z)(M.outLineIndices),(0,pr.Z)(g.indices),(0,pr.Z)(x.indices),(0,pr.Z)(M.indices)),normals:[].concat((0,pr.Z)(g.normals),(0,pr.Z)(x.normals),(0,pr.Z)(M.normals)),size:7};return O}function v1(e,i){for(var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,r=[],a=e.vertices,u=e.indices,c=e.dimensions,g=e.outLineIndices,x=0;x<a.length;x+=c)r.push.apply(r,[t,a[x+1],a[x]].concat((0,pr.Z)(i)));return(0,X.Z)((0,X.Z)({},e),{},{vertices:r,indices:u.map(function(M){return M+n}),outLineIndices:g.map(function(M){return M+n})})}function CC(e){var i=wC();return function(){var n=(0,ue.Z)(e),r;if(i){var a=(0,ue.Z)(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return(0,ze.Z)(this,r)}}function wC(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var TC=`#extension GL_OES_standard_derivatives : enable

varying vec4 v_color;


// line texture

#pragma include "picking"

void main() {
gl_FragColor = v_color;
gl_FragColor = filterColor(gl_FragColor);
}
`,MC=`attribute vec4 a_Color;
attribute vec2 a_Size;
attribute vec4 a_Instance;
attribute vec3 a_Normal;
attribute vec3 a_Position;

uniform mat4 u_ModelMatrix;


#pragma include "projection"
#pragma include "project"
#pragma include "picking"
varying vec4 v_color;
uniform float u_gap_width: 1.0;
uniform float u_stroke_width: 1.0;
uniform float u_stroke_opacity: 1.0;

vec2 project_pixel_offset(vec2 offsets) {

   vec2 data = project_pixel(offsets);
   if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) {
    // P20_2 \u5750\u6807\u7CFB\u4E0B\uFF0C\u4E3A\u4E86\u548C Web \u58A8\u5361\u6258\u5750\u6807\u7CFB\u7EDF\u4E00\uFF0Czoom \u9ED8\u8BA4\u51CF3
    return data;
  }

  return vec2(data.x, -data.y);;
}

vec2 line_dir(vec2 target, vec2 source) {

   if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) {
    // P20_2 \u5750\u6807\u7CFB\u4E0B\uFF0C\u4E3A\u4E86\u548C Web \u58A8\u5361\u6258\u5750\u6807\u7CFB\u7EDF\u4E00\uFF0Czoom \u9ED8\u8BA4\u51CF3
     return normalize(target - source);
  }
  return normalize(ProjectFlat(target) - ProjectFlat(source));
}

float flag_gap() {
   if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) {
    // P20_2 \u5750\u6807\u7CFB\u4E0B\uFF0C\u4E3A\u4E86\u548C Web \u58A8\u5361\u6258\u5750\u6807\u7CFB\u7EDF\u4E00\uFF0Czoom \u9ED8\u8BA4\u51CF3
     return 1.;
  }
  return -1.;

}


void main() {

// \u900F\u660E\u5EA6\u8BA1\u7B97
  vec2 source = a_Instance.rg;  // \u8D77\u59CB\u70B9
  vec2 target =  a_Instance.ba; // \u7EC8\u70B9
  vec2 flowlineDir = line_dir(target,source);
  vec2 perpendicularDir = vec2(flowlineDir.y, flowlineDir.x); // mapbox || \u9AD8\u5FB7


  vec2 position = mix(source, target, a_Position.x);
  
  float lengthCommon = length(project_position(vec4(target,0,1)) - project_position(vec4(source,0,1)));  //    
  vec2 offsetDistances = a_Size.x * project_pixel_offset(vec2(a_Position.y, a_Position.z)); // Mapbox || \u9AD8\u5FB7
  vec2 limitedOffsetDistances = clamp(   
   offsetDistances,
   project_pixel(-lengthCommon*.2), project_pixel(lengthCommon*.2)
  );


  float startOffsetCommon = project_pixel(offsets[0]);
  float endOffsetCommon = project_pixel(offsets[1]);
  float endpointOffset = mix(
    clamp(startOffsetCommon, 0.0, lengthCommon*.2),
    -clamp(endOffsetCommon, 0.0, lengthCommon*.2),
    a_Position.x
  );

  vec2 normalsCommon =  u_stroke_width * project_pixel_offset(vec2(a_Normal.x, a_Normal.y)); // mapbox || \u9AD8\u5FB7

  float gapCommon = flag_gap() * project_pixel(u_gap_width);
  vec3 offsetCommon = vec3(
    flowlineDir * (limitedOffsetDistances[1] + normalsCommon.y + endpointOffset * 1.05) -
    perpendicularDir * (limitedOffsetDistances[0] + gapCommon + normalsCommon.x),
    0.0
  );


  vec4 project_pos = project_position(vec4(position.xy, 0, 1.0));

  vec4 fillColor = vec4(a_Color.rgb, a_Color.a * opacity);
  v_color = mix(fillColor, vec4(u_stroke.xyz, u_stroke.w * fillColor.w * u_stroke_opacity), a_Normal.z);

  gl_Position = project_common_position_to_clipspace_v2(vec4(project_pos.xy + offsetCommon.xy, 0., 1.0));



  setPickingColor(a_PickingColor);
}
`,IC=function(e){(0,Ne.Z)(t,e);var i=CC(t);function t(){return(0,se.Z)(this,t),i.apply(this,arguments)}return(0,be.Z)(t,[{key:"getUninforms",value:function(){var r=this.layer.getLayerConfig(),a=r.gapWidth,u=a===void 0?2:a,c=r.strokeWidth,g=c===void 0?1:c,x=r.stroke,M=x===void 0?"#000":x,O=r.strokeOpacity,B=O===void 0?1:O;return(0,X.Z)({u_gap_width:u,u_stroke_width:g,u_stroke:Ni(M),u_stroke_opacity:B},this.getStyleAttribute())}},{key:"initModels",value:function(){var n=(0,ur.Z)(it().mark(function a(){return it().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.abrupt("return",this.buildModels());case 1:case"end":return c.stop()}},a,this)}));function r(){return n.apply(this,arguments)}return r}()},{key:"buildModels",value:function(){var n=(0,ur.Z)(it().mark(function a(){var u;return it().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return g.next=2,this.layer.buildLayerModel({moduleName:"flow_line",vertexShader:MC,fragmentShader:TC,inject:this.getInject(),triangulation:bC,styleOption:this.layer.getLayerConfig().symbol,primitive:je.TRIANGLES,depth:{enable:!1},pick:!1});case 2:return u=g.sent,g.abrupt("return",[u]);case 4:case"end":return g.stop()}},a,this)}));function r(){return n.apply(this,arguments)}return r}()},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"size",type:mn.Attribute,descriptor:{name:"a_Size",buffer:{usage:je.DYNAMIC_DRAW,data:[],type:je.FLOAT},size:2,update:function(a){var u=a.size,c=u===void 0?1:u;return Array.isArray(c)?[c[0],c[1]]:[c,0]}}}),this.styleAttributeService.registerStyleAttribute({name:"instance",type:mn.Attribute,descriptor:{name:"a_Instance",buffer:{usage:je.STATIC_DRAW,data:[],type:je.FLOAT},size:4,update:function(a,u,c){return[c[3],c[4],c[5],c[6]]}}}),this.styleAttributeService.registerStyleAttribute({name:"normal",type:mn.Attribute,descriptor:{name:"a_Normal",buffer:{usage:je.STATIC_DRAW,data:[],type:je.FLOAT},size:3,update:function(a,u,c,g,x){return x}}})}}]),t}(vo);function PC(e){var i=LC();return function(){var n=(0,ue.Z)(e),r;if(i){var a=(0,ue.Z)(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return(0,ze.Z)(this,r)}}function LC(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var OC=`#define LineTypeSolid 0.0
#define LineTypeDash 1.0
#define Animate 0.0
#define LineTexture 1.0

uniform float u_textureBlend;
uniform float u_blur : 0.9;
uniform float u_line_type: 0.0;
// varying vec2 v_normal;
varying vec4 v_dash_array;
varying float v_distance_ratio;
varying vec4 v_color;

uniform float u_time;
uniform vec4 u_animate: [ 1., 2., 1.0, 0.2 ];

uniform float u_line_texture: 0.0;
uniform sampler2D u_texture;
uniform vec2 u_textSize;
uniform float segmentNumber;

varying vec2 v_iconMapUV;

uniform float u_linearColor: 0;
uniform vec4 u_sourceColor;
uniform vec4 u_targetColor;
varying vec4 v_line_data;

#pragma include "picking"
#pragma include "project"
#pragma include "projection"

void main() {

  float animateSpeed = 0.0;
  float d_segmentIndex = v_line_data.g;
  
  // \u8BBE\u7F6E\u5F27\u7EBF\u7684\u5E95\u8272
  if(u_linearColor == 1.0) { // \u4F7F\u7528\u6E10\u53D8\u989C\u8272
    gl_FragColor = mix(u_sourceColor, u_targetColor, d_segmentIndex/segmentNumber);
     gl_FragColor.a *= v_color.a;
  } else { // \u4F7F\u7528 color \u65B9\u6CD5\u4F20\u5165\u7684\u989C\u8272
     gl_FragColor = v_color;
  }

  // float blur = 1.- smoothstep(u_blur, 1., length(v_normal.xy));
  // float blur = smoothstep(1.0, u_blur, length(v_normal.xy));
  if(u_line_type == LineTypeDash) {
    float dashLength = mod(v_distance_ratio, v_dash_array.x + v_dash_array.y + v_dash_array.z + v_dash_array.w);
    if(dashLength < v_dash_array.x || (dashLength > (v_dash_array.x + v_dash_array.y) && dashLength <  v_dash_array.x + v_dash_array.y + v_dash_array.z)) {
      // \u5B9E\u7EBF\u90E8\u5206
    } else {
      // \u865A\u7EBF\u90E8\u5206
      discard;
    };
  }

  // \u8BBE\u7F6E\u5F27\u7EBF\u7684\u52A8\u753B\u6A21\u5F0F
  if(u_animate.x == Animate) {
      animateSpeed = u_time / u_animate.y;
      float alpha =1.0 - fract( mod(1.0- v_distance_ratio, u_animate.z)* (1.0/ u_animate.z) + u_time / u_animate.y);
      alpha = (alpha + u_animate.w -1.0) / u_animate.w;
      alpha = smoothstep(0., 1., alpha);
      gl_FragColor.a *= alpha;
  }

  // \u8BBE\u7F6E\u5F27\u7EBF\u7684\u8D34\u56FE
  if(LineTexture == u_line_texture && u_line_type != LineTypeDash) { 
    float arcRadio = smoothstep( 0.0, 1.0, (d_segmentIndex / (segmentNumber - 1.0)));
    // float arcRadio = d_segmentIndex / (segmentNumber - 1.0);
    float count = v_line_data.b; // \u8D34\u56FE\u5728\u5F27\u7EBF\u4E0A\u91CD\u590D\u7684\u6570\u91CF
    float u = fract(arcRadio * count - animateSpeed * count);
    // float u = fract(arcRadio * count - animateSpeed);
    if(u_animate.x == Animate) {
      u = gl_FragColor.a/v_color.a;
    }

    float v = v_line_data.a; // \u7EBF\u56FE\u5C42\u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\u503C

    vec2 uv= v_iconMapUV / u_textSize + vec2(u, v) / u_textSize * 64.;
    vec4 pattern = texture2D(u_texture, uv);
    
    // \u8BBE\u7F6E\u8D34\u56FE\u548C\u5E95\u8272\u7684\u53E0\u52A0\u6A21\u5F0F
    if(u_textureBlend == 0.0) { // normal
      pattern.a = 0.0;
      gl_FragColor = filterColor(gl_FragColor + pattern);
    } else { // replace
        pattern.a *= v_color.a;
        if(gl_FragColor.a <= 0.0) {
          pattern.a = 0.0;
        }
        gl_FragColor = filterColor(pattern);
    }
  } else {
    gl_FragColor = filterColor(gl_FragColor);
  }

  // gl_FragColor = filterColor(gl_FragColor);
}`,RC=`#define LineTypeSolid 0.0
#define LineTypeDash 1.0
#define Animate 0.0
#define LineTexture 1.0

attribute vec4 a_Color;
attribute vec3 a_Position;
attribute vec4 a_Instance;
attribute float a_Size;
uniform mat4 u_ModelMatrix;

uniform float segmentNumber;
uniform vec4 u_animate: [ 1., 2., 1.0, 0.2 ];
varying vec4 v_color;

varying float v_distance_ratio;
uniform float u_line_type: 0.0;
uniform vec4 u_dash_array: [10.0, 5., 0, 0];
varying vec4 v_dash_array;

uniform float u_icon_step: 100;
uniform float u_line_texture: 0.0;

attribute vec2 a_iconMapUV;
varying vec2 v_iconMapUV;
varying vec4 v_line_data;


#pragma include "projection"
#pragma include "project"
#pragma include "picking"

float maps (float value, float start1, float stop1, float start2, float stop2) {
    return start2 + (stop2 - start2) * ((value - start1) / (stop1 - start1));
}

float getSegmentRatio(float index) {
    return index / (segmentNumber - 1.);
}

float paraboloid(vec2 source, vec2 target, float ratio) {
    vec2 x = mix(source, target, ratio);
    vec2 center = mix(source, target, 0.5);
    float dSourceCenter = distance(source, center);
    float dXCenter = distance(x, center);
    return (dSourceCenter + dXCenter) * (dSourceCenter - dXCenter);
}

vec3 getPos(vec2 source, vec2 target, float segmentRatio) {
     float vertex_height = paraboloid(source, target, segmentRatio);

    return vec3(
    mix(source, target, segmentRatio),
    sqrt(max(0.0, vertex_height))
    );
}
vec2 getExtrusionOffset(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
   dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
  vec2 offset = dir_screenspace * offset_direction * setPickingSize(a_Size)/ 2.0;
  return offset;
}
vec2 getNormal(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
   dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
   return reverse_offset_normal(vec3(dir_screenspace,1.0)).xy * sign(offset_direction);
}
float getAngularDist (vec2 source, vec2 target) {
  vec2 delta = source - target;
  vec2 sin_half_delta = sin(delta / 2.0);
  float a =
    sin_half_delta.y * sin_half_delta.y +
    cos(source.y) * cos(target.y) *
    sin_half_delta.x * sin_half_delta.x;
  return 2.0 * atan(sqrt(a), sqrt(1.0 - a));
}

vec2 midPoint(vec2 source, vec2 target) {
  vec2 center = target - source;
  float r = length(center);
  float theta = atan(center.y, center.x);
  float thetaOffset = 0.314;
  float r2 = r / 2.0 / cos(thetaOffset);
  float theta2 = theta + thetaOffset;
  vec2 mid = vec2(r2*cos(theta2) + source.x, r2*sin(theta2) + source.y);
  return mid;
}
float bezier3(vec3 arr, float t) {
  float ut = 1. - t;
  return (arr.x * ut + arr.y * t) * ut + (arr.y * ut + arr.z * t) * t;
}

vec2 interpolate (vec2 source, vec2 target, float angularDist, float t) {
  // if the angularDist is PI, linear interpolation is applied. otherwise, use spherical interpolation
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    vec2 mid = midPoint(source, target);
    vec3 x = vec3(source.x, mid.x, target.x);
    vec3 y = vec3(source.y, mid.y, target.y);
    return vec2(bezier3(x ,t), bezier3(y,t));
  }else {
    if(abs(angularDist - PI) < 0.001) {
      return (1.0 - t) * source + t * target;
    }
    float a = sin((1.0 - t) * angularDist) / sin(angularDist);
    float b = sin(t * angularDist) / sin(angularDist);
    vec2 sin_source = sin(source);
    vec2 cos_source = cos(source);
    vec2 sin_target = sin(target);
    vec2 cos_target = cos(target);
    float x = a * cos_source.y * cos_source.x + b * cos_target.y * cos_target.x;
    float y = a * cos_source.y * sin_source.x + b * cos_target.y * sin_target.x;
    float z = a * sin_source.y + b * sin_target.y;
    return vec2(atan(y, x), atan(z, sqrt(x * x + y * y)));
  }
}

void main() {
  v_color = a_Color;
  v_color.a = v_color.a * opacity;
  vec2 source = radians(a_Instance.rg);
  vec2 target = radians(a_Instance.ba);
  float angularDist = getAngularDist(source, target);
  float segmentIndex = a_Position.x;
  float segmentRatio = getSegmentRatio(segmentIndex);
  float indexDir = mix(-1.0, 1.0, step(segmentIndex, 0.0));

  if(u_line_type == LineTypeDash) {
    v_distance_ratio = segmentIndex / segmentNumber;
    vec2 s = source;
    vec2 t = target;
    
    if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
      s = unProjCustomCoord(source);
      t = unProjCustomCoord(target);
    }
    float total_Distance = pixelDistance(s, t) / 2.0 * PI;
    total_Distance = total_Distance*16.0; // total_Distance*16.0 \u8C03\u6574\u9ED8\u8BA4\u7684\u6548\u679C
    v_dash_array = pow(2.0, 20.0 - u_Zoom) * u_dash_array / total_Distance;
  }

  if(u_animate.x == Animate) {
      v_distance_ratio = segmentIndex / segmentNumber;
  }

  float nextSegmentRatio = getSegmentRatio(segmentIndex + indexDir);
  v_distance_ratio = segmentIndex / segmentNumber;
  vec4 curr = project_position(vec4(degrees(interpolate(source, target, angularDist, segmentRatio)), 0.0, 1.0));
  vec4 next = project_position(vec4(degrees(interpolate(source, target, angularDist, nextSegmentRatio)), 0.0, 1.0));
  // v_normal = getNormal((next.xy - curr.xy) * indexDir, a_Position.y);
  vec2 offset = project_pixel(getExtrusionOffset((next.xy - curr.xy) * indexDir, a_Position.y));
  //  vec4 project_pos = project_position(vec4(curr.xy, 0, 1.0));
  // gl_Position = project_common_position_to_clipspace(vec4(curr.xy + offset, curr.z, 1.0));

v_line_data.g = a_Position.x; // \u8BE5\u9876\u70B9\u5728\u5F27\u7EBF\u4E0A\u7684\u5206\u6BB5\u6392\u5E8F
  if(LineTexture == u_line_texture) { // \u5F00\u542F\u8D34\u56FE\u6A21\u5F0F  
    // float mapZoomScale = u_CoordinateSystem !== COORDINATE_SYSTEM_P20_2?10000000.0:1.0;
    float d_arcDistrance = length(source - target);
    if(u_CoordinateSystem == COORDINATE_SYSTEM_P20) { // amap
      d_arcDistrance = d_arcDistrance * 1000000.0;
    }
    if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) { // mapbox
      d_arcDistrance = project_pixel_allmap(d_arcDistrance);
    }
    float d_pixelLen = project_pixel(u_icon_step)/8.0;
v_line_data.b = floor(d_arcDistrance/d_pixelLen); // \u8D34\u56FE\u5728\u5F27\u7EBF\u4E0A\u91CD\u590D\u7684\u6570\u91CF

    float lineOffsetWidth = length(offset + offset * sign(a_Position.y)); // \u7EBF\u6A2A\u5411\u504F\u79FB\u7684\u8DDD\u79BB
    float linePixelSize = project_pixel(a_Size);  // \u5B9A\u70B9\u4F4D\u7F6E\u504F\u79FB\uFF0C\u6309\u5730\u56FE\u7B49\u7EA7\u7F29\u653E\u540E\u7684\u8DDD\u79BB
v_line_data.a = lineOffsetWidth/linePixelSize;  // \u7EBF\u56FE\u5C42\u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\u503C

    v_iconMapUV = a_iconMapUV;
  }



  gl_Position = project_common_position_to_clipspace_v2(vec4(curr.xy + offset, 0, 1.0));
  setPickingColor(a_PickingColor);
}

`,DC={solid:0,dash:1},kC=function(e){(0,Ne.Z)(t,e);var i=PC(t);function t(){var n;(0,se.Z)(this,t);for(var r=arguments.length,a=new Array(r),u=0;u<r;u++)a[u]=arguments[u];return n=i.call.apply(i,[this].concat(a)),(0,Me.Z)((0,xt.Z)(n),"updateTexture",function(){var c=n.rendererService.createTexture2D;if(n.texture){n.texture.update({data:n.iconService.getCanvas()}),n.layer.render();return}n.texture=c({data:n.iconService.getCanvas(),mag:je.NEAREST,min:je.NEAREST,premultiplyAlpha:!1,width:1024,height:n.iconService.canvasHeight||128})}),n}return(0,be.Z)(t,[{key:"getUninforms",value:function(){var r=this.layer.getLayerConfig(),a=r.sourceColor,u=r.targetColor,c=r.textureBlend,g=c===void 0?"normal":c,x=r.lineType,M=x===void 0?"solid":x,O=r.dashArray,B=O===void 0?[10,5]:O,W=r.lineTexture,ce=W===void 0?!1:W,oe=r.iconStep,Te=oe===void 0?100:oe,Ze=r.segmentNumber,qe=Ze===void 0?30:Ze;B.length===2&&B.push(0,0),this.rendererService.getDirty()&&this.texture.bind();var et=0,yt=[0,0,0,0],bt=[0,0,0,0];return a&&u&&(yt=Ni(a),bt=Ni(u),et=1),(0,X.Z)({u_textureBlend:g==="normal"?0:1,segmentNumber:qe,u_line_type:DC[M]||0,u_dash_array:B,u_texture:this.texture,u_line_texture:ce?1:0,u_icon_step:Te,u_textSize:[1024,this.iconService.canvasHeight||128],u_linearColor:et,u_sourceColor:yt,u_targetColor:bt},this.getStyleAttribute())}},{key:"getAnimateUniforms",value:function(){var r=this.layer.getLayerConfig(),a=r.animateOption;return{u_animate:this.animateOption2Array(a),u_time:this.layer.getLayerAnimateTime()}}},{key:"initModels",value:function(){var n=(0,ur.Z)(it().mark(function a(){return it().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return this.updateTexture(),this.iconService.on("imageUpdate",this.updateTexture),c.abrupt("return",this.buildModels());case 3:case"end":return c.stop()}},a,this)}));function r(){return n.apply(this,arguments)}return r}()},{key:"clearModels",value:function(){var r;(r=this.texture)===null||r===void 0||r.destroy(),this.iconService.off("imageUpdate",this.updateTexture)}},{key:"buildModels",value:function(){var n=(0,ur.Z)(it().mark(function a(){var u;return it().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return g.next=2,this.layer.buildLayerModel({moduleName:"lineGreatCircle",vertexShader:RC,fragmentShader:OC,triangulation:Nd,inject:this.getInject(),depth:{enable:!1}});case 2:return u=g.sent,g.abrupt("return",[u]);case 4:case"end":return g.stop()}},a,this)}));function r(){return n.apply(this,arguments)}return r}()},{key:"registerBuiltinAttributes",value:function(){var r=this;this.styleAttributeService.registerStyleAttribute({name:"size",type:mn.Attribute,descriptor:{name:"a_Size",buffer:{usage:je.DYNAMIC_DRAW,data:[],type:je.FLOAT},size:1,update:function(u){var c=u.size,g=c===void 0?1:c;return Array.isArray(g)?[g[0]]:[g]}}}),this.styleAttributeService.registerStyleAttribute({name:"instance",type:mn.Attribute,descriptor:{name:"a_Instance",buffer:{usage:je.STATIC_DRAW,data:[],type:je.FLOAT},size:4,update:function(u,c,g){return[g[3],g[4],g[5],g[6]]}}}),this.styleAttributeService.registerStyleAttribute({name:"uv",type:mn.Attribute,descriptor:{name:"a_iconMapUV",buffer:{usage:je.DYNAMIC_DRAW,data:[],type:je.FLOAT},size:2,update:function(u){var c=r.iconService.getIconMap(),g=u.texture,x=c[g]||{x:0,y:0},M=x.x,O=x.y;return[M,O]}}})}}]),t}(vo),xL=function(e){return e[e.solid=0]="solid",e[e.dash=1]="dash",e}({}),Bd=function(e){return e.VERTICAL="vertical",e.HORIZONTAL="horizontal",e}({}),NC=function(e){return e.NORMAL="normal",e.REPLACE="replace",e}({}),gg=function(e){return e[e.pixel=0]="pixel",e[e.meter=1]="meter",e}({}),EL=function(e){return e.ALWAYS="always",e.DRAGEND="dragend",e}({});function FC(e){var i=BC();return function(){var n=(0,ue.Z)(e),r;if(i){var a=(0,ue.Z)(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return(0,ze.Z)(this,r)}}function BC(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var ZC=`#define LineTypeSolid 0.0
varying vec4 v_color;

// dash
varying vec4 v_dash_array;
varying float v_d_distance_ratio;

#pragma include "picking"

uniform float u_time;
uniform vec4 u_animate: [ 1., 2., 1.0, 0.2 ]; // \u63A7\u5236\u8FD0\u52A8

// [animate, duration, interval, trailLength],
void main() {

  gl_FragColor = v_color;

  float dashLength = mod(v_d_distance_ratio, v_dash_array.x + v_dash_array.y + v_dash_array.z + v_dash_array.w);
  if(dashLength < v_dash_array.x || (dashLength > (v_dash_array.x + v_dash_array.y) && dashLength <  v_dash_array.x + v_dash_array.y + v_dash_array.z)) {
    // \u5B9E\u7EBF\u90E8\u5206
  } else {
    // \u865A\u7EBF\u90E8\u5206
    discard;
  };

  gl_FragColor = filterColor(gl_FragColor);
}
`,zC=`#define LineTypeSolid 0.0
#define LineTypeDash 1.0
#define Animate 0.0

attribute float a_Miter;
attribute vec4 a_Color;
attribute vec2 a_Size;
attribute vec3 a_Normal;
attribute vec3 a_Position;

attribute vec2 a_iconMapUV;

// dash line
attribute float a_Total_Distance;
attribute vec2 a_DistanceAndIndex;
uniform float u_raisingHeight: 0.0;
uniform float u_heightfixed: 0.0;

uniform mat4 u_ModelMatrix;

uniform vec4 u_dash_array: [10.0, 5., 0, 0];

uniform float u_vertexScale: 1.0;

#pragma include "projection"
#pragma include "picking"

varying vec4 v_color;
varying vec4 v_dash_array;
varying float v_d_distance_ratio;


void main() {

  v_dash_array = pow(2.0, 20.0 - u_Zoom) * u_dash_array / a_Total_Distance;
  v_color = vec4(a_Color.xyz, a_Color.w * opacity);

  vec3 size = a_Miter * setPickingSize(a_Size.x) * reverse_offset_normal(a_Normal);
  vec2 offset = project_pixel(size.xy);
  v_d_distance_ratio = a_DistanceAndIndex.x / a_Total_Distance;


  vec4 project_pos = project_position(vec4(a_Position.xy, 0, 1.0));
  
 float h = float(a_Position.z) * u_vertexScale; // \u7EBF\u9876\u70B9\u7684\u9AD8\u5EA6 - \u517C\u5BB9\u4E0D\u5B58\u5728\u7B2C\u4E09\u4E2A\u6570\u503C\u7684\u60C5\u51B5 vertex height
  float lineHeight = a_Size.y; // size \u7B2C\u4E8C\u4E2A\u53C2\u6570\u4EE3\u8868\u7684\u9AD8\u5EA6 [linewidth, lineheight]

  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    lineHeight *= 0.2; // \u4FDD\u6301\u548C amap/mapbox \u4E00\u81F4\u7684\u6548\u679C
    h *= 0.2;
    if(u_heightfixed < 1.0) {
      lineHeight = project_pixel(a_Size.y);
    }
    gl_Position = u_Mvp * (vec4(project_pos.xy + offset, lineHeight + h + u_raisingHeight, 1.0));
  } else {
    // mapbox -  amap
    
    // \u517C\u5BB9 mapbox \u5728\u7EBF\u9AD8\u5EA6\u4E0A\u7684\u6548\u679C\u8868\u73B0\u57FA\u672C\u4E00\u81F4
    if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
      // mapbox
      // \u4FDD\u6301\u9AD8\u5EA6\u76F8\u5BF9\u4E0D\u53D8
      float mapboxZoomScale = 4.0/pow(2.0, 21.0 - u_Zoom);
      h *= mapboxZoomScale;
      h += u_raisingHeight * mapboxZoomScale;
      if(u_heightfixed > 0.0) {
        lineHeight *= mapboxZoomScale;
      }
      
    } else {
      // amap
      h += u_raisingHeight;
      // lineHeight \u9876\u70B9\u504F\u79FB\u9AD8\u5EA6
      if(u_heightfixed < 1.0) {
        lineHeight *= pow(2.0, 20.0 - u_Zoom);
      }
    }

    gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, lineHeight + h, 1.0));
  }

  setPickingColor(a_PickingColor);
}
`,UC=`#extension GL_OES_standard_derivatives : enable
#define Animate 0.0
#define LineTexture 1.0
uniform float u_textureBlend;

uniform float u_strokeWidth: 0.0;

uniform vec3 u_blur;
varying vec4 v_color;
varying vec4 v_stroke;

// line texture
uniform float u_line_texture;
uniform sampler2D u_texture;
uniform vec2 u_textSize;
varying vec2 v_iconMapUV;
varying vec4 v_texture_data;


#pragma include "picking"

uniform float u_time;
uniform vec4 u_animate: [ 1, 2., 1.0, 0.2 ]; // \u63A7\u5236\u8FD0\u52A8
// [animate, duration, interval, trailLength],
void main() {
  float animateSpeed = 0.0; // \u8FD0\u52A8\u901F\u5EA6
  float d_distance_ratio = v_texture_data.r; // \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B
  gl_FragColor = v_color;
  // anti-alias
  // float blur = 1.0 - smoothstep(u_blur, 1., length(v_normal.xy));
  if(u_animate.x == Animate) {
      animateSpeed = u_time / u_animate.y;
       float alpha =1.0 - fract( mod(1.0- d_distance_ratio, u_animate.z)* (1.0/ u_animate.z) + animateSpeed);
      alpha = (alpha + u_animate.w -1.0) / u_animate.w;
      alpha = smoothstep(0., 1., alpha);
      gl_FragColor.a *= alpha;
  }

  if(u_line_texture == LineTexture) { // while load texture
    float aDistance = v_texture_data.g;      // \u5F53\u524D\u9876\u70B9\u7684\u8DDD\u79BB
    float d_texPixelLen = v_texture_data.b;  // \u8D34\u56FE\u7684\u50CF\u7D20\u957F\u5EA6\uFF0C\u6839\u636E\u5730\u56FE\u5C42\u7EA7\u7F29\u653E
    float u = fract(mod(aDistance, d_texPixelLen)/d_texPixelLen - animateSpeed);
    float v = v_texture_data.a;  // \u7EBF\u56FE\u5C42\u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\u503C

    // v = max(smoothstep(0.95, 1.0, v), v);
    vec2 uv= v_iconMapUV / u_textSize + vec2(u, v) / u_textSize * 64.;
     vec4 pattern = texture2D(u_texture, uv);

    if(u_textureBlend == 0.0) { // normal
      pattern.a = 0.0;
      gl_FragColor += pattern;
    } else { // replace
        pattern.a *= v_color.a;
        if(gl_FragColor.a <= 0.0) {
          pattern.a = 0.0;
        }
        gl_FragColor = pattern;
    }
  } 

  float v = v_texture_data.a;
  float strokeWidth = min(0.5, u_strokeWidth);
  // \u7ED8\u5236 border
  if(strokeWidth > 0.01) {
    float borderOuterWidth = strokeWidth / 2.0;


    if(v >= 1.0 - strokeWidth || v <= strokeWidth) {
      if(v > strokeWidth) { // \u5916\u4FA7
        float linear = smoothstep(0.0, 1.0, (v - (1.0 - strokeWidth))/strokeWidth);
        //  float linear = step(0.0, (v - (1.0 - borderWidth))/borderWidth);
        gl_FragColor.rgb = mix(gl_FragColor.rgb, v_stroke.rgb, linear);
      } else if(v <= strokeWidth) {
        float linear = smoothstep(0.0, 1.0, v/strokeWidth);
        gl_FragColor.rgb = mix(v_stroke.rgb, gl_FragColor.rgb, linear);
      }
    }

    if(v < borderOuterWidth) {
      gl_FragColor.a = mix(0.0, gl_FragColor.a, v/borderOuterWidth);
    } else if(v > 1.0 - borderOuterWidth) {
      gl_FragColor.a = mix(gl_FragColor.a, 0.0, (v - (1.0 - borderOuterWidth))/borderOuterWidth);
    }
  }

  // blur
  float blurV = v_texture_data.a;
  if(blurV < 0.5) {
    gl_FragColor.a *= mix(u_blur.r, u_blur.g, blurV/0.5);
  } else {
    gl_FragColor.a *= mix(u_blur.g, u_blur.b, (blurV - 0.5)/0.5);
  }
  
  gl_FragColor = filterColor(gl_FragColor);
}
`,g1=`
#define Animate 0.0

attribute float a_Miter;
attribute vec4 a_Color;
attribute vec2 a_Size;
attribute vec3 a_Normal;
attribute vec3 a_Position;

attribute vec2 a_iconMapUV;

// dash line
attribute float a_Total_Distance;
attribute vec2 a_DistanceAndIndex;

uniform mat4 u_ModelMatrix;

uniform vec4 u_animate: [ 1., 2., 1.0, 0.2 ];
uniform float u_icon_step: 100;

uniform float u_heightfixed: 0.0;
uniform float u_vertexScale: 1.0;
uniform float u_raisingHeight: 0.0;

#pragma include "projection"
#pragma include "picking"

varying vec4 v_color;
varying vec4 v_stroke;

// texV \u7EBF\u56FE\u5C42 - \u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\uFF08\u7EBF\u7684\u5BBD\u5EA6\u65B9\u5411\uFF09
varying vec2 v_iconMapUV;


uniform float u_linearColor: 0;
uniform float u_arrow: 0.0;
uniform float u_arrowHeight: 3.0;
uniform float u_arrowWidth: 2.0;
uniform float u_tailWidth: 1.0;

varying vec4 v_texture_data;

vec2 calculateArrow(vec2 offset) {
  /*
  * \u5728\u652F\u6301\u7BAD\u5934\u7684\u65F6\u5019\uFF0C\u7B2C\u4E8C\u3001\u7B2C\u4E09\u7EC4\u9876\u70B9\u662F\u989D\u5916\u63D2\u5165\u7528\u4E8E\u6784\u5EFA\u9876\u70B9\u7684
  */
  float arrowFlag = -1.0;
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) {
    // \u9AD8\u5FB7 2.0 \u7684\u65CB\u8F6C\u89D2\u5EA6\u4E0D\u540C
    arrowFlag = 1.0;
  }
  float pi = arrowFlag * 3.1415926/2.;
  if(a_Miter < 0.) {
    // \u6839\u636E\u7EBF\u7684\u4E24\u4FA7\u504F\u79FB\u4E0D\u540C\u3001\u65CB\u8F6C\u7684\u65B9\u5411\u76F8\u53CD
    pi = -pi;
  }
  highp float angle_sin = sin(pi);
  highp float angle_cos = cos(pi);
  // \u8BA1\u7B97\u5782\u76F4\u4E0E\u7EBF\u65B9\u5411\u7684\u65CB\u8F6C\u77E9\u9635
  mat2 rotation_matrix = mat2(angle_cos, -1.0 * angle_sin, angle_sin, angle_cos);
  float arrowWidth = u_arrowWidth;
  float arrowHeight = u_arrowHeight;

  vec2 arrowOffset = vec2(0.0);
  /*
  * a_DistanceAndIndex.y \u7528\u4E8E\u6807\u8BB0\u5F53\u524D\u9876\u70B9\u5C5E\u4E8E\u54EA\u4E00\u7EC4\uFF08\u4E24\u4E2A\u9876\u70B9\u4E00\u7EC4\uFF0C\u6784\u6210\u7EBF\u7684\u5176\u5B9E\u662F\u77E9\u5F62\uFF0C\u6700\u7B80\u9700\u8981\u56DB\u4E2A\u9876\u70B9\u3001\u4E24\u7EC4\u9876\u70B9\u6784\u6210\uFF09
  */
  if(a_DistanceAndIndex.y == 0.0) {
    // \u7BAD\u5934\u5C16\u90E8
    offset = vec2(0.0);
  } else if(a_DistanceAndIndex.y == 1.0) {
    // \u7BAD\u5934\u4E24\u4FA7
    arrowOffset = rotation_matrix*(offset * arrowHeight);
    offset += arrowOffset; // \u6CBF\u7EBF\u504F\u79FB
    offset = offset * arrowWidth; // \u5782\u76F4\u7EBF\u5411\u5916\u504F\u79FB\uFF08\u662F\u6784\u5EFA\u7BAD\u5934\u4E24\u4FA7\u7684\u9876\u70B9\uFF09
  } else if(a_DistanceAndIndex.y == 2.0 || a_DistanceAndIndex.y == 3.0 || a_DistanceAndIndex.y == 4.0) {
    // \u504F\u79FB\u5176\u4F59\u7684\u70B9\u4F4D\uFF08\u5C06\u957F\u5EA6\u8BA9\u4F4D\u7ED9\u7BAD\u5934\uFF09
    arrowOffset = rotation_matrix*(offset * arrowHeight) * arrowWidth;
    offset += arrowOffset;// \u6CBF\u7EBF\u504F\u79FB
  }

  return offset;
}

void main() {
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97

  
  float d_texPixelLen;    // \u8D34\u56FE\u7684\u50CF\u7D20\u957F\u5EA6\uFF0C\u6839\u636E\u5730\u56FE\u5C42\u7EA7\u7F29\u653E

  v_iconMapUV = a_iconMapUV;
  d_texPixelLen = project_float_pixel(u_icon_step);
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) {
    d_texPixelLen *= 10.0;
  }

  v_color = a_Color;
  v_color.a *= opacity;
  v_stroke = stroke;

  vec3 size = a_Miter * setPickingSize(a_Size.x) * reverse_offset_normal(a_Normal);
  
  vec2 offset = project_pixel(size.xy);

  float lineDistance = a_DistanceAndIndex.x;
  float currentLinePointRatio = lineDistance / a_Total_Distance;
 
  if(u_arrow > 0.0) {
      //  \u8BA1\u7B97\u7BAD\u5934
    offset = calculateArrow(offset);

    if(a_DistanceAndIndex.y > 4.0) {
      offset *= mix(1.0, u_tailWidth, currentLinePointRatio);
    }
  }

  float lineOffsetWidth = length(offset + offset * sign(a_Miter)); // \u7EBF\u6A2A\u5411\u504F\u79FB\u7684\u8DDD\u79BB\uFF08\u5411\u4E24\u4FA7\u504F\u79FB\u7684\u548C\uFF09
  float linePixelSize = project_pixel(a_Size.x) * 2.0;  // \u5B9A\u70B9\u4F4D\u7F6E\u504F\u79FB\uFF0C\u6309\u5730\u56FE\u7B49\u7EA7\u7F29\u653E\u540E\u7684\u8DDD\u79BB \u5355\u4FA7 * 2
  float texV = lineOffsetWidth/linePixelSize; // \u7EBF\u56FE\u5C42\u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\u503C
  
  v_texture_data = vec4(currentLinePointRatio, lineDistance, d_texPixelLen, texV);
  // \u8BBE\u7F6E\u6570\u636E\u96C6\u7684\u53C2\u6570

  vec4 project_pos = project_position(vec4(a_Position.xy, 0, 1.0));

  // gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, a_Size.y, 1.0));

  float h = float(a_Position.z) * u_vertexScale; // \u7EBF\u9876\u70B9\u7684\u9AD8\u5EA6 - \u517C\u5BB9\u4E0D\u5B58\u5728\u7B2C\u4E09\u4E2A\u6570\u503C\u7684\u60C5\u51B5 vertex height
  float lineHeight = a_Size.y; // size \u7B2C\u4E8C\u4E2A\u53C2\u6570\u4EE3\u8868\u7684\u9AD8\u5EA6 [linewidth, lineheight]

  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    lineHeight *= 0.2; // \u4FDD\u6301\u548C amap/mapbox \u4E00\u81F4\u7684\u6548\u679C
    h *= 0.2;
    if(u_heightfixed < 1.0) {
      lineHeight = project_pixel(a_Size.y);
    }
    gl_Position = u_Mvp * (vec4(project_pos.xy + offset, lineHeight + h + u_raisingHeight, 1.0));
  } else {
    // mapbox -  amap
    
    // \u517C\u5BB9 mapbox \u5728\u7EBF\u9AD8\u5EA6\u4E0A\u7684\u6548\u679C\u8868\u73B0\u57FA\u672C\u4E00\u81F4
    if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
      // mapbox
      // \u4FDD\u6301\u9AD8\u5EA6\u76F8\u5BF9\u4E0D\u53D8
      float mapboxZoomScale = 4.0/pow(2.0, 21.0 - u_Zoom);
      h *= mapboxZoomScale;
      h += u_raisingHeight * mapboxZoomScale;
      if(u_heightfixed > 0.0) {
        lineHeight *= mapboxZoomScale;
      }
      
    } else {
      // amap
      h += u_raisingHeight;
      // lineHeight \u9876\u70B9\u504F\u79FB\u9AD8\u5EA6
      if(u_heightfixed < 1.0) {
        lineHeight *= pow(2.0, 20.0 - u_Zoom);
      }
    }

    gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, lineHeight + h, 1.0));
  }

  setPickingColor(a_PickingColor);
}
`,GC=`varying vec4 v_color;
varying vec4 v_texture_data;
uniform float u_linearDir: 1.0;
uniform float u_linearColor: 0;
uniform vec4 u_sourceColor;
uniform vec4 u_targetColor;

#pragma include "picking"


void main() {
  float linearRadio = v_texture_data.r; // \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B
  if(u_linearDir < 1.0) {
    linearRadio = v_texture_data.a;
  }

  if(u_linearColor == 1.0) { // \u4F7F\u7528\u6E10\u53D8\u989C\u8272
    gl_FragColor = mix(u_sourceColor, u_targetColor, linearRadio);
    gl_FragColor.a *= v_color.a;
  } else { // \u4F7F\u7528 color \u65B9\u6CD5\u4F20\u5165\u7684\u989C\u8272
     gl_FragColor = v_color;
  }

  gl_FragColor = filterColor(gl_FragColor);
}
`,jC={solid:0,dash:1},m1=function(e){(0,Ne.Z)(t,e);var i=FC(t);function t(){var n;(0,se.Z)(this,t);for(var r=arguments.length,a=new Array(r),u=0;u<r;u++)a[u]=arguments[u];return n=i.call.apply(i,[this].concat(a)),(0,Me.Z)((0,xt.Z)(n),"textureEventFlag",!1),(0,Me.Z)((0,xt.Z)(n),"texture",n.createTexture2D({data:[0,0,0,0],mag:je.NEAREST,min:je.NEAREST,premultiplyAlpha:!1,width:1,height:1})),(0,Me.Z)((0,xt.Z)(n),"updateTexture",function(){var c=n.rendererService.createTexture2D;if(n.texture){n.texture.update({data:n.iconService.getCanvas()}),n.layer.render();return}n.texture=c({data:n.iconService.getCanvas(),mag:je.NEAREST,min:je.NEAREST,premultiplyAlpha:!1,width:1024,height:n.iconService.canvasHeight||128})}),n}return(0,be.Z)(t,[{key:"getUninforms",value:function(){var r=this.layer.getLayerConfig(),a=r.sourceColor,u=r.targetColor,c=r.textureBlend,g=c===void 0?"normal":c,x=r.lineType,M=x===void 0?"solid":x,O=r.dashArray,B=O===void 0?[10,5,0,0]:O,W=r.lineTexture,ce=W===void 0?!1:W,oe=r.iconStep,Te=oe===void 0?100:oe,Ze=r.vertexHeightScale,qe=Ze===void 0?20:Ze,et=r.strokeWidth,yt=et===void 0?0:et,bt=r.raisingHeight,Ot=bt===void 0?0:bt,jt=r.heightfixed,or=jt===void 0?!1:jt,ar=r.linearDir,Sr=ar===void 0?Bd.VERTICAL:ar,dr=r.blur,jr=dr===void 0?[1,1,1]:dr;B.length===2&&B.push(0,0),this.rendererService.getDirty()&&this.texture&&this.texture.bind();var nn=0,En=[0,0,0,0],_a=[0,0,0,0];return a&&u&&(En=Ni(a),_a=Ni(u),nn=1),(0,X.Z)({u_textureBlend:g===NC.NORMAL?0:1,u_line_type:jC[M],u_dash_array:B,u_blur:jr,u_texture:this.texture,u_line_texture:ce?1:0,u_icon_step:Te,u_textSize:[1024,this.iconService.canvasHeight||128],u_strokeWidth:yt,u_linearDir:Sr===Bd.VERTICAL?1:0,u_linearColor:nn,u_sourceColor:En,u_targetColor:_a,u_heightfixed:Number(or),u_vertexScale:qe,u_raisingHeight:Number(Ot)},this.getStyleAttribute())}},{key:"getAnimateUniforms",value:function(){var r=this.layer.getLayerConfig(),a=r.animateOption;return{u_animate:this.animateOption2Array(a),u_time:this.layer.getLayerAnimateTime()}}},{key:"initModels",value:function(){var n=(0,ur.Z)(it().mark(function a(){return it().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return this.textureEventFlag||(this.textureEventFlag=!0,this.updateTexture(),this.iconService.on("imageUpdate",this.updateTexture)),c.abrupt("return",this.buildModels());case 2:case"end":return c.stop()}},a,this)}));function r(){return n.apply(this,arguments)}return r}()},{key:"clearModels",value:function(){var r;(r=this.texture)===null||r===void 0||r.destroy(),this.iconService.off("imageUpdate",this.updateTexture)}},{key:"buildModels",value:function(){var n=(0,ur.Z)(it().mark(function a(){var u,c,g,x,M,O,B,W;return it().wrap(function(oe){for(;;)switch(oe.prev=oe.next){case 0:return u=this.layer.getLayerConfig(),c=u.depth,g=c===void 0?!1:c,x=this.getShaders(),M=x.frag,O=x.vert,B=x.type,this.layer.triangulation=Cl,oe.next=5,this.layer.buildLayerModel({moduleName:"line"+B,vertexShader:O,fragmentShader:M,triangulation:Cl,inject:this.getInject(),depth:{enable:g}});case 5:return W=oe.sent,oe.abrupt("return",[W]);case 7:case"end":return oe.stop()}},a,this)}));function r(){return n.apply(this,arguments)}return r}()},{key:"getShaders",value:function(){var r=this.layer.getLayerConfig(),a=r.sourceColor,u=r.targetColor,c=r.lineType;return c==="dash"?{frag:ZC,vert:zC,type:"Dash"}:a&&u?{frag:GC,vert:g1,type:"Linear"}:{frag:UC,vert:g1,type:""}}},{key:"registerBuiltinAttributes",value:function(){var r=this;this.styleAttributeService.registerStyleAttribute({name:"distanceAndIndex",type:mn.Attribute,descriptor:{name:"a_DistanceAndIndex",buffer:{usage:je.STATIC_DRAW,data:[],type:je.FLOAT},size:2,update:function(u,c,g,x,M,O){return O===void 0?[g[3],10]:[g[3],O]}}}),this.styleAttributeService.registerStyleAttribute({name:"total_distance",type:mn.Attribute,descriptor:{name:"a_Total_Distance",buffer:{usage:je.STATIC_DRAW,data:[],type:je.FLOAT},size:1,update:function(u,c,g){return[g[5]]}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:mn.Attribute,descriptor:{name:"a_Size",buffer:{usage:je.DYNAMIC_DRAW,data:[],type:je.FLOAT},size:2,update:function(u){var c=u.size,g=c===void 0?1:c;return Array.isArray(g)?[g[0],g[1]]:[g,0]}}}),this.styleAttributeService.registerStyleAttribute({name:"normal",type:mn.Attribute,descriptor:{name:"a_Normal",buffer:{usage:je.STATIC_DRAW,data:[],type:je.FLOAT},size:3,update:function(u,c,g,x,M){return M}}}),this.styleAttributeService.registerStyleAttribute({name:"miter",type:mn.Attribute,descriptor:{name:"a_Miter",buffer:{usage:je.STATIC_DRAW,data:[],type:je.FLOAT},size:1,update:function(u,c,g){return[g[4]]}}}),this.styleAttributeService.registerStyleAttribute({name:"uv",type:mn.Attribute,descriptor:{name:"a_iconMapUV",buffer:{usage:je.DYNAMIC_DRAW,data:[],type:je.FLOAT},size:2,update:function(u){var c=r.iconService.getIconMap(),g=u.texture,x=c[g]||{x:0,y:0},M=x.x,O=x.y;return[M,O]}}})}}]),t}(vo);function VC(e){var i=HC();return function(){var n=(0,ue.Z)(e),r;if(i){var a=(0,ue.Z)(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return(0,ze.Z)(this,r)}}function HC(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var $C=`
varying vec4 v_Color;
#pragma include "picking"
void main() {

  gl_FragColor = v_Color; // \u5168\u5C40\u900F\u660E\u5EA6
  gl_FragColor = filterColor(gl_FragColor);
}
`,YC=`
attribute float a_Miter;
attribute vec2 a_Size;
attribute vec3 a_Normal;
attribute vec3 a_Position;

// dash line
attribute float a_Total_Distance;
attribute vec2 a_DistanceAndIndex;

uniform mat4 u_ModelMatrix;


uniform float u_heightfixed: 0.0;
uniform float u_vertexScale: 1.0;
uniform float u_raisingHeight: 0.0;
uniform sampler2D u_texture;
uniform float u_linearDir: 1.0;
varying vec4 v_Color;


#pragma include "projection"
#pragma include "picking"


void main() {


  vec3 size = a_Miter * setPickingSize(a_Size.x) * reverse_offset_normal(a_Normal);
  
  vec2 offset = project_pixel(size.xy);

  float lineDistance = a_DistanceAndIndex.x;
  float currentLinePointRatio = lineDistance / a_Total_Distance;
 

  float lineOffsetWidth = length(offset + offset * sign(a_Miter)); // \u7EBF\u6A2A\u5411\u504F\u79FB\u7684\u8DDD\u79BB\uFF08\u5411\u4E24\u4FA7\u504F\u79FB\u7684\u548C\uFF09
  float linePixelSize = project_pixel(a_Size.x) * 2.0;  // \u5B9A\u70B9\u4F4D\u7F6E\u504F\u79FB\uFF0C\u6309\u5730\u56FE\u7B49\u7EA7\u7F29\u653E\u540E\u7684\u8DDD\u79BB \u5355\u4FA7 * 2
  float texV = lineOffsetWidth/linePixelSize; // \u7EBF\u56FE\u5C42\u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\u503C

  float linearRadio =currentLinePointRatio; // \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B
  if(u_linearDir < 1.0) {
    linearRadio = texV;
  }

  v_Color = texture2D(u_texture, vec2(linearRadio, 0.5));

  v_Color.a *= opacity; // \u5168\u5C40\u900F\u660E\u5EA6



  vec4 project_pos = project_position(vec4(a_Position.xy, 0, 1.0));

  // gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, a_Size.y, 1.0));

  float h = float(a_Position.z) * u_vertexScale; // \u7EBF\u9876\u70B9\u7684\u9AD8\u5EA6 - \u517C\u5BB9\u4E0D\u5B58\u5728\u7B2C\u4E09\u4E2A\u6570\u503C\u7684\u60C5\u51B5 vertex height
  float lineHeight = a_Size.y; // size \u7B2C\u4E8C\u4E2A\u53C2\u6570\u4EE3\u8868\u7684\u9AD8\u5EA6 [linewidth, lineheight]

  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    lineHeight *= 0.2; // \u4FDD\u6301\u548C amap/mapbox \u4E00\u81F4\u7684\u6548\u679C
    h *= 0.2;
    if(u_heightfixed < 1.0) {
      lineHeight = project_pixel(a_Size.y);
    }
    gl_Position = u_Mvp * (vec4(project_pos.xy + offset, lineHeight + h + u_raisingHeight, 1.0));
  } else {
    // mapbox -  amap
    
    // \u517C\u5BB9 mapbox \u5728\u7EBF\u9AD8\u5EA6\u4E0A\u7684\u6548\u679C\u8868\u73B0\u57FA\u672C\u4E00\u81F4
    if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
      // mapbox
      // \u4FDD\u6301\u9AD8\u5EA6\u76F8\u5BF9\u4E0D\u53D8
      float mapboxZoomScale = 4.0/pow(2.0, 21.0 - u_Zoom);
      h *= mapboxZoomScale;
      h += u_raisingHeight * mapboxZoomScale;
      if(u_heightfixed > 0.0) {
        lineHeight *= mapboxZoomScale;
      }
      
    } else {
      // amap
      h += u_raisingHeight;
      // lineHeight \u9876\u70B9\u504F\u79FB\u9AD8\u5EA6
      if(u_heightfixed < 1.0) {
        lineHeight *= pow(2.0, 20.0 - u_Zoom);
      }
    }

    gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, lineHeight + h, 1.0));
  }

  setPickingColor(a_PickingColor);
}
`,bL=In.isNumber,WC=function(e){(0,Ne.Z)(t,e);var i=VC(t);function t(){var n;(0,se.Z)(this,t);for(var r=arguments.length,a=new Array(r),u=0;u<r;u++)a[u]=arguments[u];return n=i.call.apply(i,[this].concat(a)),(0,Me.Z)((0,xt.Z)(n),"updateTexture",function(){var c=n.rendererService.createTexture2D;n.colorTexture&&n.colorTexture.destroy();var g=n.layer.getLayerConfig(),x=g.rampColors,M=$o(x);n.colorTexture=c({data:new Uint8Array(M.data),width:M.width,height:M.height,wrapS:je.CLAMP_TO_EDGE,wrapT:je.CLAMP_TO_EDGE,min:je.NEAREST,mag:je.NEAREST,flipY:!1})}),n}return(0,be.Z)(t,[{key:"getUninforms",value:function(){var r=this.layer.getLayerConfig(),a=r.opacity,u=a===void 0?1:a,c=r.vertexHeightScale,g=c===void 0?20:c,x=r.raisingHeight,M=x===void 0?0:x,O=r.heightfixed,B=O===void 0?!1:O,W=r.linearDir,ce=W===void 0?Bd.VERTICAL:W;return this.rendererService.getDirty()&&this.colorTexture.bind(),(0,X.Z)({u_linearDir:ce===Bd.VERTICAL?1:0,u_texture:this.colorTexture,u_heightfixed:Number(B),u_vertexScale:g,u_raisingHeight:Number(M)},this.getStyleAttribute())}},{key:"initModels",value:function(){var n=(0,ur.Z)(it().mark(function a(){return it().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return this.updateTexture(),c.abrupt("return",this.buildModels());case 2:case"end":return c.stop()}},a,this)}));function r(){return n.apply(this,arguments)}return r}()},{key:"clearModels",value:function(){var r;(r=this.colorTexture)===null||r===void 0||r.destroy()}},{key:"buildModels",value:function(){var n=(0,ur.Z)(it().mark(function a(){var u,c,g,x;return it().wrap(function(O){for(;;)switch(O.prev=O.next){case 0:return u=this.layer.getLayerConfig(),c=u.depth,g=c===void 0?!1:c,this.layer.triangulation=dg,O.next=4,this.layer.buildLayerModel({moduleName:"lineRampColors",vertexShader:YC,fragmentShader:$C,triangulation:dg,inject:this.getInject(),depth:{enable:g}});case 4:return x=O.sent,O.abrupt("return",[x]);case 6:case"end":return O.stop()}},a,this)}));function r(){return n.apply(this,arguments)}return r}()},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"distanceAndIndex",type:mn.Attribute,descriptor:{name:"a_DistanceAndIndex",buffer:{usage:je.STATIC_DRAW,data:[],type:je.FLOAT},size:2,update:function(a,u,c,g,x,M){return M===void 0?[c[3],10]:[c[3],M]}}}),this.styleAttributeService.registerStyleAttribute({name:"total_distance",type:mn.Attribute,descriptor:{name:"a_Total_Distance",buffer:{usage:je.STATIC_DRAW,data:[],type:je.FLOAT},size:1,update:function(a,u,c){return[c[5]]}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:mn.Attribute,descriptor:{name:"a_Size",buffer:{usage:je.DYNAMIC_DRAW,data:[],type:je.FLOAT},size:2,update:function(a){var u=a.size,c=u===void 0?1:u;return Array.isArray(c)?[c[0],c[1]]:[c,0]}}}),this.styleAttributeService.registerStyleAttribute({name:"normal",type:mn.Attribute,descriptor:{name:"a_Normal",buffer:{usage:je.STATIC_DRAW,data:[],type:je.FLOAT},size:3,update:function(a,u,c,g,x){return x}}}),this.styleAttributeService.registerStyleAttribute({name:"miter",type:mn.Attribute,descriptor:{name:"a_Miter",buffer:{usage:je.STATIC_DRAW,data:[],type:je.FLOAT},size:1,update:function(a,u,c){return[c[4]]}}})}}]),t}(vo);function XC(e){var i=QC();return function(){var n=(0,ue.Z)(e),r;if(i){var a=(0,ue.Z)(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return(0,ze.Z)(this,r)}}function QC(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var qC=`
varying vec4 v_color;
void main() {
  gl_FragColor = v_color;

}
`,KC=`uniform vec4 u_sourceColor;
uniform vec4 u_targetColor;
varying float v_distanceScale;
varying vec4 v_color;
void main() {
  gl_FragColor = mix(u_sourceColor, u_targetColor, v_distanceScale);
  gl_FragColor.a *= v_color.a; // \u5168\u5C40\u900F\u660E\u5EA6
}
`,y1=`attribute vec4 a_Color;
attribute vec2 a_Size;
attribute vec3 a_Position;

attribute float a_Total_Distance;
attribute float a_Distance;

uniform mat4 u_ModelMatrix;


uniform float u_vertexScale: 1.0;
uniform vec4 u_sourceColor;
uniform vec4 u_targetColor;



#pragma include "projection"

varying vec4 v_color;
varying float v_distanceScale;

void main() {

  v_color = a_Color; 
  v_distanceScale = a_Distance / a_Total_Distance;
  v_color.a = v_color.a * opacity;
  vec4 project_pos = project_position(vec4(a_Position.xy, 0, 1.0));

  float h = float(a_Position.z) * u_vertexScale; // \u7EBF\u9876\u70B9\u7684\u9AD8\u5EA6 - \u517C\u5BB9\u4E0D\u5B58\u5728\u7B2C\u4E09\u4E2A\u6570\u503C\u7684\u60C5\u51B5

  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    gl_Position = u_Mvp * (vec4(project_pos.xy, project_pixel(a_Size.y) + h * 0.2, 1.0));
  } else {
    float lineHeight = a_Size.y;
    // \u517C\u5BB9 mapbox \u5728\u7EBF\u9AD8\u5EA6\u4E0A\u7684\u6548\u679C\u8868\u73B0\u57FA\u672C\u4E00\u81F4
    if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
      // \u4FDD\u6301\u9AD8\u5EA6\u76F8\u5BF9\u4E0D\u53D8
      h *= 2.0/pow(2.0, 20.0 - u_Zoom);
    }

    // amap1.x
    if(u_CoordinateSystem == COORDINATE_SYSTEM_P20 || u_CoordinateSystem == COORDINATE_SYSTEM_P20_OFFSET) {
      // \u4FDD\u6301\u9AD8\u5EA6\u76F8\u5BF9\u4E0D\u53D8
      lineHeight *= pow(2.0, 20.0 - u_Zoom);
    }

    gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy, lineHeight + h, 1.0));
    gl_PointSize = 10.0;
  }
}
`,SL=In.isNumber,JC=function(e){(0,Ne.Z)(t,e);var i=XC(t);function t(){return(0,se.Z)(this,t),i.apply(this,arguments)}return(0,be.Z)(t,[{key:"getUninforms",value:function(){var r=this.layer.getLayerConfig(),a=r.opacity,u=a===void 0?1:a,c=r.sourceColor,g=r.targetColor,x=r.vertexHeightScale,M=x===void 0?20:x,O=0,B=[0,0,0,0],W=[0,0,0,0];return c&&g&&(B=Ni(c),W=Ni(g),O=1),(0,X.Z)({u_linearColor:O,u_sourceColor:B,u_targetColor:W,u_vertexScale:M},this.getStyleAttribute())}},{key:"initModels",value:function(){var n=(0,ur.Z)(it().mark(function a(){return it().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.abrupt("return",this.buildModels());case 1:case"end":return c.stop()}},a,this)}));function r(){return n.apply(this,arguments)}return r}()},{key:"getShaders",value:function(){var r=this.layer.getLayerConfig(),a=r.sourceColor,u=r.targetColor;return a&&u?{frag:KC,vert:y1,type:"lineSimpleLinear"}:{frag:qC,vert:y1,type:"lineSimpleNormal"}}},{key:"buildModels",value:function(){var n=(0,ur.Z)(it().mark(function a(){var u,c,g,x,M;return it().wrap(function(B){for(;;)switch(B.prev=B.next){case 0:return u=this.getShaders(),c=u.frag,g=u.vert,x=u.type,B.next=3,this.layer.buildLayerModel({moduleName:x,vertexShader:g,fragmentShader:c,triangulation:k3,inject:this.getInject(),primitive:je.LINES,depth:{enable:!1},pick:!1});case 3:return M=B.sent,B.abrupt("return",[M]);case 5:case"end":return B.stop()}},a,this)}));function r(){return n.apply(this,arguments)}return r}()},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"distance",type:mn.Attribute,descriptor:{name:"a_Distance",buffer:{usage:je.STATIC_DRAW,data:[],type:je.FLOAT},size:1,update:function(a,u,c){return[c[3]]}}}),this.styleAttributeService.registerStyleAttribute({name:"total_distance",type:mn.Attribute,descriptor:{name:"a_Total_Distance",buffer:{usage:je.STATIC_DRAW,data:[],type:je.FLOAT},size:1,update:function(a,u,c){return[c[5]]}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:mn.Attribute,descriptor:{name:"a_Size",buffer:{usage:je.DYNAMIC_DRAW,data:[],type:je.FLOAT},size:2,update:function(a){var u=a.size,c=u===void 0?1:u;return Array.isArray(c)?[c[0],c[1]]:[c,0]}}})}}]),t}(vo);function ew(e){var i=tw();return function(){var n=(0,ue.Z)(e),r;if(i){var a=(0,ue.Z)(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return(0,ze.Z)(this,r)}}function tw(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var rw=`#define Animate 0.0
#define LineTexture 1.0

// line texture
uniform float u_line_texture;
uniform sampler2D u_texture;
uniform vec2 u_textSize;
uniform float u_linearColor: 0;
uniform vec4 u_sourceColor;
uniform vec4 u_targetColor;
uniform float u_opacity : 1.0;
uniform float u_textureBlend;
uniform float u_iconStepCount;
uniform float u_time;
uniform vec4 u_animate: [ 1., 2., 1.0, 0.2 ]; // \u63A7\u5236\u8FD0\u52A8

varying vec2 v_iconMapUV;
varying float v_blur;
varying float v_radio;
varying vec4 v_color;
varying vec4 v_dataset;

#pragma include "picking"

void main() {
  float opacity = u_opacity;
  float animateSpeed = 0.0; // \u8FD0\u52A8\u901F\u5EA6
  float d_distance_ratio = v_dataset.r; // \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B
  float v = v_dataset.a;

  if(u_linearColor == 1.0) { // \u4F7F\u7528\u6E10\u53D8\u989C\u8272
    gl_FragColor = mix(u_sourceColor, u_targetColor, v);
  } else { // \u4F7F\u7528 color \u65B9\u6CD5\u4F20\u5165\u7684\u989C\u8272
     gl_FragColor = v_color;
  }

  gl_FragColor.a *= opacity; // \u5168\u5C40\u900F\u660E\u5EA6
  if(u_animate.x == Animate) {
      animateSpeed = u_time / u_animate.y;
       float alpha =1.0 - fract( mod(1.0- d_distance_ratio, u_animate.z)* (1.0/ u_animate.z) + animateSpeed);
      alpha = (alpha + u_animate.w -1.0) / u_animate.w;
      alpha = smoothstep(0., 1., alpha);
      gl_FragColor.a *= alpha;
  }

  if(u_line_texture == LineTexture) { // while load texture
    float aDistance = v_dataset.g;      // \u5F53\u524D\u9876\u70B9\u7684\u8DDD\u79BB
    float d_texPixelLen = v_dataset.b;  // \u8D34\u56FE\u7684\u50CF\u7D20\u957F\u5EA6\uFF0C\u6839\u636E\u5730\u56FE\u5C42\u7EA7\u7F29\u653E
    float u = fract(mod(aDistance, d_texPixelLen)/d_texPixelLen - animateSpeed);
    float v = v_dataset.a;  // \u7EBF\u56FE\u5C42\u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\u503C

    // \u8BA1\u7B97\u7EB9\u7406\u95F4\u9694 start
    float flag = 0.0;
    if(u > 1.0/u_iconStepCount) {
      flag = 1.0;
    }
    u = fract(u*u_iconStepCount);
    // \u8BA1\u7B97\u7EB9\u7406\u95F4\u9694 end

    vec2 uv= v_iconMapUV / u_textSize + vec2(u, v) / u_textSize * 64.;
    vec4 pattern = texture2D(u_texture, uv);

    // Tip: \u5224\u65AD\u7EB9\u7406\u95F4\u9694
    if(flag > 0.0) {
      pattern = vec4(0.0);
    }

    if(u_textureBlend == 0.0) { // normal
      pattern.a = 0.0;
      gl_FragColor = filterColor(gl_FragColor + pattern);
    } else { // replace
        pattern.a *= opacity;
        if(gl_FragColor.a <= 0.0) {
          pattern.a = 0.0;
        }
        gl_FragColor = filterColor(pattern);
    }
  }
  

  // blur - AA
  if(v < v_blur) {
    gl_FragColor.a = mix(0.0, gl_FragColor.a, v/v_blur);
  } else if(v > 1.0 - v_blur) {
    gl_FragColor.a = mix(gl_FragColor.a, 0.0, (v - (1.0 - v_blur))/v_blur);
  }

  gl_FragColor = filterColor(gl_FragColor);
}
`,nw=`#define Animate 0.0

attribute float a_Miter;
attribute vec4 a_Color;
attribute vec2 a_Size;
attribute vec3 a_Normal;
attribute vec3 a_Position;
attribute vec2 a_iconMapUV;
attribute float a_Total_Distance;
attribute float a_Distance;

uniform mat4 u_ModelMatrix;

uniform vec4 u_animate: [ 1., 2., 1.0, 0.2 ];
uniform float u_icon_step: 100;
uniform float u_heightfixed;
uniform float u_linearColor: 0;

#pragma include "projection"
#pragma include "light"
#pragma include "picking"

// texV \u7EBF\u56FE\u5C42 - \u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\uFF08\u7EBF\u7684\u5BBD\u5EA6\u65B9\u5411\uFF09
varying vec2 v_iconMapUV;
varying vec4 v_color;
varying float v_blur;
varying float v_radio;
varying vec4 v_dataset;

void main() {


  float d_distance_ratio; // \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B
  float d_texPixelLen;    // \u8D34\u56FE\u7684\u50CF\u7D20\u957F\u5EA6\uFF0C\u6839\u636E\u5730\u56FE\u5C42\u7EA7\u7F29\u653E

  v_iconMapUV = a_iconMapUV;
  if(u_heightfixed < 1.0) {     // \u9AD8\u5EA6\u968F zoom \u8C03\u6574
    d_texPixelLen = project_pixel(u_icon_step);
  } else {
    d_texPixelLen = u_icon_step;
  }
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) {
    d_texPixelLen *= 10.0;
  }

  if(u_animate.x == Animate || u_linearColor == 1.0) {
      d_distance_ratio = a_Distance / a_Total_Distance;
  }

  float miter = (a_Miter + 1.0)/2.0;
  // \u8BBE\u7F6E\u6570\u636E\u96C6\u7684\u53C2\u6570
  v_dataset[0] = d_distance_ratio; // \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B
  v_dataset[1] = a_Distance;       // \u5F53\u524D\u9876\u70B9\u7684\u8DDD\u79BB
  v_dataset[2] = d_texPixelLen;    // \u8D34\u56FE\u7684\u50CF\u7D20\u957F\u5EA6\uFF0C\u6839\u636E\u5730\u56FE\u5C42\u7EA7\u7F29\u653E
  v_dataset[3] = miter;          // \u7EBF\u56FE\u5C42\u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\u503C 0 - 1

  vec4 project_pos = project_position(vec4(a_Position.xy, 0, 1.0));

  float originSize = a_Size.x;  // \u56FA\u5B9A\u9AD8\u5EA6
  if(u_heightfixed < 1.0) {     // \u9AD8\u5EA6\u968F zoom \u8C03\u6574
    originSize = project_float_pixel(a_Size.x);
  }

  float wallHeight = originSize * miter;
  float lightWeight = calc_lighting(vec4(project_pos.xy, wallHeight, 1.0));

  v_blur = min(project_float_pixel(2.0) / originSize, 0.05);
  v_color = vec4(a_Color.rgb * lightWeight, a_Color.w);

  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    gl_Position = u_Mvp * (vec4(project_pos.xy, wallHeight, 1.0));
  } else {
    gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy, wallHeight, 1.0));
  }

  setPickingColor(a_PickingColor);
}
`,CL=In.isNumber,iw=function(e){(0,Ne.Z)(t,e);var i=ew(t);function t(){var n;(0,se.Z)(this,t);for(var r=arguments.length,a=new Array(r),u=0;u<r;u++)a[u]=arguments[u];return n=i.call.apply(i,[this].concat(a)),(0,Me.Z)((0,xt.Z)(n),"updateTexture",function(){var c=n.rendererService.createTexture2D;if(n.texture){n.texture.update({data:n.iconService.getCanvas()}),n.layer.render();return}n.texture=c({data:n.iconService.getCanvas(),mag:je.NEAREST,min:je.NEAREST,premultiplyAlpha:!1,width:1024,height:n.iconService.canvasHeight||128})}),n}return(0,be.Z)(t,[{key:"getUninforms",value:function(){var r=this.layer.getLayerConfig(),a=r.sourceColor,u=r.targetColor,c=r.textureBlend,g=c===void 0?"normal":c,x=r.heightfixed,M=x===void 0?!1:x,O=r.lineTexture,B=O===void 0?!1:O,W=r.iconStep,ce=W===void 0?100:W,oe=r.iconStepCount,Te=oe===void 0?1:oe;this.rendererService.getDirty()&&this.texture.bind();var Ze=0,qe=[0,0,0,0],et=[0,0,0,0];return a&&u&&(qe=Ni(a),et=Ni(u),Ze=1),(0,X.Z)({u_heightfixed:Number(M),u_textureBlend:g==="normal"?0:1,u_texture:this.texture,u_line_texture:B?1:0,u_iconStepCount:Te,u_icon_step:ce,u_textSize:[1024,this.iconService.canvasHeight||128],u_linearColor:Ze,u_sourceColor:qe,u_targetColor:et},this.getStyleAttribute())}},{key:"getAnimateUniforms",value:function(){var r=this.layer.getLayerConfig(),a=r.animateOption;return{u_animate:this.animateOption2Array(a),u_time:this.layer.getLayerAnimateTime()}}},{key:"initModels",value:function(){var n=(0,ur.Z)(it().mark(function a(){return it().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return this.updateTexture(),this.iconService.on("imageUpdate",this.updateTexture),c.abrupt("return",this.buildModels());case 3:case"end":return c.stop()}},a,this)}));function r(){return n.apply(this,arguments)}return r}()},{key:"clearModels",value:function(){var r;(r=this.texture)===null||r===void 0||r.destroy(),this.iconService.off("imageUpdate",this.updateTexture)}},{key:"buildModels",value:function(){var n=(0,ur.Z)(it().mark(function a(){var u;return it().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return g.next=2,this.layer.buildLayerModel({moduleName:"lineWall",vertexShader:nw,fragmentShader:rw,triangulation:dg,inject:this.getInject(),depth:{enable:!1},blend:this.getBlend()});case 2:return u=g.sent,g.abrupt("return",[u]);case 4:case"end":return g.stop()}},a,this)}));function r(){return n.apply(this,arguments)}return r}()},{key:"registerBuiltinAttributes",value:function(){var r=this;this.styleAttributeService.registerStyleAttribute({name:"distance",type:mn.Attribute,descriptor:{name:"a_Distance",buffer:{usage:je.STATIC_DRAW,data:[],type:je.FLOAT},size:1,update:function(u,c,g){return[g[3]]}}}),this.styleAttributeService.registerStyleAttribute({name:"total_distance",type:mn.Attribute,descriptor:{name:"a_Total_Distance",buffer:{usage:je.STATIC_DRAW,data:[],type:je.FLOAT},size:1,update:function(u,c,g){return[g[5]]}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:mn.Attribute,descriptor:{name:"a_Size",buffer:{usage:je.DYNAMIC_DRAW,data:[],type:je.FLOAT},size:2,update:function(u){var c=u.size,g=c===void 0?1:c;return Array.isArray(g)?[g[0],g[1]]:[g,0]}}}),this.styleAttributeService.registerStyleAttribute({name:"normal",type:mn.Attribute,descriptor:{name:"a_Normal",buffer:{usage:je.STATIC_DRAW,data:[],type:je.FLOAT},size:3,update:function(u,c,g,x,M){return M}}}),this.styleAttributeService.registerStyleAttribute({name:"miter",type:mn.Attribute,descriptor:{name:"a_Miter",buffer:{usage:je.STATIC_DRAW,data:[],type:je.FLOAT},size:1,update:function(u,c,g){return[g[4]]}}}),this.styleAttributeService.registerStyleAttribute({name:"uv",type:mn.Attribute,descriptor:{name:"a_iconMapUV",buffer:{usage:je.DYNAMIC_DRAW,data:[],type:je.FLOAT},size:2,update:function(u){var c=r.iconService.getIconMap(),g=u.texture,x=c[g]||{x:0,y:0},M=x.x,O=x.y;return[M,O]}}})}}]),t}(vo),aw={arc:K3,arc3d:oC,greatcircle:kC,wall:iw,line:m1,simple:JC,linearline:WC,earthArc3d:pC,flowline:IC},ow=aw;function sw(e){var i=uw();return function(){var n=(0,ue.Z)(e),r;if(i){var a=(0,ue.Z)(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return(0,ze.Z)(this,r)}}function uw(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var mg=function(e){(0,Ne.Z)(t,e);var i=sw(t);function t(){var n;(0,se.Z)(this,t);for(var r=arguments.length,a=new Array(r),u=0;u<r;u++)a[u]=arguments[u];return n=i.call.apply(i,[this].concat(a)),(0,Me.Z)((0,xt.Z)(n),"type","LineLayer"),(0,Me.Z)((0,xt.Z)(n),"enableShaderEncodeStyles",["opacity","offsets","stroke","thetaOffset"]),(0,Me.Z)((0,xt.Z)(n),"arrowInsertCount",0),(0,Me.Z)((0,xt.Z)(n),"defaultSourceConfig",{data:[{lng1:100,lat1:30,lng2:130,lat2:30}],options:{parser:{type:"json",x:"lng1",y:"lat1",x1:"lng2",y1:"lat2"}}}),n}return(0,be.Z)(t,[{key:"buildModels",value:function(){var n=(0,ur.Z)(it().mark(function a(){var u;return it().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return u=this.getModelType(),this.layerModel=new ow[u](this),g.next=4,this.initLayerModels();case 4:case"end":return g.stop()}},a,this)}));function r(){return n.apply(this,arguments)}return r}()},{key:"getDefaultConfig",value:function(){var r=this.getModelType(),a={line:{},linearline:{},simple:{},wall:{},arc3d:{blend:"additive"},arc:{blend:"additive"},greatcircle:{blend:"additive"},tileLine:{},earthArc3d:{},flowline:{},arrow:{}};return a[r]}},{key:"getModelType",value:function(){var r;if(this.layerType)return this.layerType;var a=this.styleAttributeService.getLayerStyleAttribute("shape"),u=a==null||(r=a.scale)===null||r===void 0?void 0:r.field;return u||"line"}},{key:"processData",value:function(r){if(this.getModelType()!=="simple")return r;var a=[];return r.map(function(u){if(Array.isArray(u.coordinates)&&Array.isArray(u.coordinates[0])&&Array.isArray(u.coordinates[0][0])){var c=(0,X.Z)({},u);u.coordinates.map(function(g){a.push((0,X.Z)((0,X.Z)({},c),{},{coordinates:g}))})}else a.push(u)}),a}}]),t}(iA);function lw(e){var i=cw();return function(){var n=(0,ue.Z)(e),r;if(i){var a=(0,ue.Z)(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return(0,ze.Z)(this,r)}}function cw(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var fw=`
uniform float u_additive;
uniform float u_stroke_opacity : 1;

uniform vec4 u_stroke_color : [0.0, 0.0, 0.0, 0.0];

varying vec4 v_color;
varying float v_blur;
varying float v_innerRadius;

#pragma include "picking"
void main() {
  vec2 center = vec2(0.5);

  // Tip: \u7247\u5143\u5230\u4E2D\u5FC3\u70B9\u7684\u8DDD\u79BB 0 - 1
  float fragmengTocenter = distance(center, gl_PointCoord) * 2.0;
  // Tip: \u7247\u5143\u7684\u526A\u5207\u6210\u5706\u5F62
  float circleClipOpacity = 1.0 - smoothstep(v_blur, 1.0, fragmengTocenter);


  if(v_innerRadius < 0.99) {
    // \u5F53\u5B58\u5728 stroke \u4E14 stroke > 0.01
    float blurWidth = (1.0 - v_blur)/2.0;
    vec4 stroke = vec4(u_stroke_color.rgb, u_stroke_opacity);
    if(fragmengTocenter > v_innerRadius + blurWidth) {
      gl_FragColor = stroke;
    } else if(fragmengTocenter > v_innerRadius - blurWidth){
      float mixR = (fragmengTocenter - (v_innerRadius - blurWidth)) / (blurWidth * 2.0);
      gl_FragColor = mix(v_color, stroke, mixR);
    } else {
      gl_FragColor = v_color;
    }
  } else {
    // \u5F53\u4E0D\u5B58\u5728 stroke \u6216 stroke <= 0.01
    gl_FragColor = v_color;
  }

  gl_FragColor = filterColor(gl_FragColor);
  
  if(u_additive > 0.0) {
    gl_FragColor *= circleClipOpacity;
  } else {
    gl_FragColor.a *= circleClipOpacity;
  }

}
`,hw=`
attribute vec3 a_Position;
uniform mat4 u_ModelMatrix;

attribute float a_Size;
attribute vec4 a_Color;
varying vec4 v_color;

uniform float u_opacity : 1;
uniform vec2 u_offsets;
uniform float u_stroke_width;

varying float v_blur;
varying float v_innerRadius;



#pragma include "projection"
#pragma include "picking"
#pragma include "project"
void main() {
  v_color = vec4(a_Color.xyz, a_Color.w * u_opacity);
  v_blur = 1.0 - max(2.0/a_Size, 0.05);
  v_innerRadius = max((a_Size - u_stroke_width) / a_Size, 0.0);
  
  vec2 offset = project_pixel(u_offsets);
  
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    gl_Position = u_Mvp * vec4(a_Position.xy + offset, a_Position.z, 1.0);
  } else { // else
    vec4 project_pos = project_position(vec4(a_Position, 1.0)) + vec4(a_Size / 2.,-a_Size /2.,0.,0.);
    gl_Position = project_common_position_to_clipspace(vec4(vec2(project_pos.xy+offset),project_pos.z,project_pos.w));
  }
  
  gl_PointSize = a_Size * 2.0 * u_DevicePixelRatio;
  setPickingColor(a_PickingColor);
}
`;function _1(e){var i=e.coordinates;return{vertices:(0,pr.Z)(i),indices:[0],size:i.length}}var Aw=function(e){(0,Ne.Z)(t,e);var i=lw(t);function t(){return(0,se.Z)(this,t),i.apply(this,arguments)}return(0,be.Z)(t,[{key:"getDefaultStyle",value:function(){return{blend:"additive"}}},{key:"getUninforms",value:function(){var r=this.layer.getLayerConfig(),a=r.opacity,u=a===void 0?1:a,c=r.offsets,g=c===void 0?[0,0]:c,x=r.blend,M=r.strokeOpacity,O=M===void 0?1:M,B=r.strokeWidth,W=B===void 0?0:B,ce=r.stroke,oe=ce===void 0?"#fff":ce;return{u_additive:x==="additive"?1:0,u_opacity:u,u_offsets:g,u_stroke_opacity:O,u_stroke_width:W,u_stroke_color:Ni(oe)}}},{key:"initModels",value:function(){var n=(0,ur.Z)(it().mark(function a(){return it().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.abrupt("return",this.buildModels());case 1:case"end":return c.stop()}},a,this)}));function r(){return n.apply(this,arguments)}return r}()},{key:"buildModels",value:function(){var n=(0,ur.Z)(it().mark(function a(){var u;return it().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return this.layer.triangulation=_1,g.next=3,this.layer.buildLayerModel({moduleName:"pointSimple",vertexShader:hw,fragmentShader:fw,triangulation:_1,depth:{enable:!1},primitive:je.POINTS});case 3:return u=g.sent,g.abrupt("return",[u]);case 5:case"end":return g.stop()}},a,this)}));function r(){return n.apply(this,arguments)}return r}()},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"size",type:mn.Attribute,descriptor:{name:"a_Size",buffer:{usage:je.DYNAMIC_DRAW,data:[],type:je.FLOAT},size:1,update:function(a){var u=a.size,c=u===void 0?1:u;return Array.isArray(c)?[c[0]]:[c]}}})}}]),t}(vo);function pw(e){var i=dw();return function(){var n=(0,ue.Z)(e),r;if(i){var a=(0,ue.Z)(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return(0,ze.Z)(this,r)}}function dw(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var vw=`varying vec4 v_color;
uniform float u_opacity: 1.0;

uniform float u_pickLight: 0.0;

#pragma include "picking"


uniform float u_linearColor: 0;
uniform vec4 u_sourceColor;
uniform vec4 u_targetColor;

uniform float u_opacitylinear: 0.0;
uniform float u_opacitylinear_dir: 1.0;
varying float v_lightWeight;
varying float v_barLinearZ;
void main() {

   gl_FragColor = v_color;

  // \u5F00\u542F\u900F\u660E\u5EA6\u6E10\u53D8
  if(u_opacitylinear > 0.0) {
    gl_FragColor.a *= u_opacitylinear_dir > 0.0 ? (1.0 - v_barLinearZ): v_barLinearZ;
  }

  // picking
  if(u_pickLight > 0.0) {
    gl_FragColor = filterColorAlpha(gl_FragColor, v_lightWeight);
  } else {
    gl_FragColor = filterColor(gl_FragColor);
  }
}
`,gw=`precision highp float;

#define pi 3.1415926535
#define ambientRatio 0.5
#define diffuseRatio 0.3
#define specularRatio 0.2

attribute vec3 a_Position;
attribute vec3 a_Pos;
attribute vec4 a_Color;
attribute vec3 a_Size;
attribute vec3 a_Normal;

uniform float u_heightfixed: 0.0; // \u9ED8\u8BA4\u4E0D\u56FA\u5B9A
uniform float u_globel;
uniform float u_r;
uniform mat4 u_ModelMatrix;

varying vec4 v_color;

uniform float u_opacity : 1;
uniform float u_lightEnable: 1;
varying float v_lightWeight;
varying float v_barLinearZ;
// \u7528\u4E8E\u5C06\u5728\u9876\u70B9\u7740\u8272\u5668\u4E2D\u8BA1\u7B97\u597D\u7684\u6837\u5F0F\u503C\u4F20\u9012\u7ED9\u7247\u5143


#pragma include "projection"
#pragma include "light"
#pragma include "picking"

float getYRadian(float x, float z) {
  if(x > 0.0 && z > 0.0) {
    return atan(x/z);
  } else if(x > 0.0 && z <= 0.0){
    return atan(-z/x) + pi/2.0;
  } else if(x <= 0.0 && z <= 0.0) {
    return  pi + atan(x/z); //atan(x/z) + 
  } else {
    return atan(z/-x) + pi*3.0/2.0;
  }
}

float getXRadian(float y, float r) {
  return atan(y/r);
}

void main() {

  
  float textureOffset = 0.0; // \u5728 cell \u4E2D\u53D6\u503C\u7684\u504F\u79FB\u91CF

  textureOffset = opacityAndOffset.g;
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
  vec3 size = a_Size * a_Position;

  // a_Position.z \u662F\u5728\u6784\u5EFA\u7F51\u683C\u7684\u65F6\u5019\u4F20\u5165\u7684\u6807\u51C6\u503C 0 - 1\uFF0C\u5728\u63D2\u503C\u5668\u63D2\u503C\u53EF\u4EE5\u83B7\u53D6 0\uFF5E1 \u7EBF\u6027\u6E10\u53D8\u7684\u503C
  v_barLinearZ =  a_Position.z;

  vec3 offset = size; // \u63A7\u5236\u5706\u67F1\u4F53\u7684\u5927\u5C0F - \u4ECE\u6807\u51C6\u5355\u4F4D\u5706\u67F1\u4F53\u8FDB\u884C\u504F\u79FB
  if(u_heightfixed < 1.0) { // \u5706\u67F1\u4F53\u4E0D\u56FA\u5B9A\u9AD8\u5EA6
    
    if (u_CoordinateSystem == COORDINATE_SYSTEM_P20 || u_CoordinateSystem == COORDINATE_SYSTEM_P20_OFFSET) {
      // P20 \u5750\u6807\u7CFB\u4E0B\uFF0C\u4E3A\u4E86\u548C Web \u58A8\u5361\u6258\u5750\u6807\u7CFB\u7EDF\u4E00\uFF0Czoom \u9ED8\u8BA4\u51CF1
      offset = offset * pow(2.0, (19.0 - u_Zoom));
    }
    if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) {
      // P20_2 \u5750\u6807\u7CFB\u4E0B\uFF0C\u4E3A\u4E86\u548C Web \u58A8\u5361\u6258\u5750\u6807\u7CFB\u7EDF\u4E00\uFF0Czoom \u9ED8\u8BA4\u51CF3
      offset = offset * pow(2.0, (19.0 - 3.0 - u_Zoom));
    }
  } else {// \u5706\u67F1\u4F53\u56FA\u5B9A\u9AD8\u5EA6 \uFF08 \u5904\u7406 mapbox \uFF09
    if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
      offset *= 4.0/pow(2.0, 21.0 - u_Zoom);
    }
  }


  vec4 project_pos = project_position(vec4(a_Pos.xy, 0., 1.0));

  // u_r \u63A7\u5236\u5706\u67F1\u7684\u751F\u957F
  vec4 pos = vec4(project_pos.xy + offset.xy, offset.z * u_r, 1.0);

  // \u5706\u67F1\u5149\u7167\u6548\u679C
  float lightWeight = 1.0;
  if(u_lightEnable > 0.0) { // \u53D6\u6D88\u4E09\u5143\u8868\u8FBE\u5F0F\uFF0C\u589E\u5F3A\u5065\u58EE\u6027
    lightWeight = calc_lighting(pos);
  }
  v_lightWeight = lightWeight;
  // \u8BBE\u7F6E\u5706\u67F1\u7684\u5E95\u8272
  if(u_linearColor == 1.0) { // \u4F7F\u7528\u6E10\u53D8\u989C\u8272
    v_color = mix(u_sourceColor, u_targetColor, barLinearZ);
    v_color.rgb *= lightWeight;
  } else { // \u4F7F\u7528 color \u65B9\u6CD5\u4F20\u5165\u7684\u989C\u8272
     v_color = a_Color;
  }
  v_color.a *= u_opacity;

    
  // \u5728\u5730\u7403\u6A21\u5F0F\u4E0B\uFF0C\u5C06\u539F\u672C\u5782\u76F4\u4E8E xy \u5E73\u9762\u7684\u5706\u67F1\u8C03\u6574\u59FF\u6001\u5230\u9002\u5E94\u5706\u7684\u89D2\u5EA6
  //\u65CB\u8F6C\u77E9\u9635mx\uFF0C\u521B\u5EFA\u7ED5x\u8F74\u65CB\u8F6C\u77E9\u9635
  float r = sqrt(a_Pos.z*a_Pos.z + a_Pos.x*a_Pos.x);
  float xRadian = getXRadian(a_Pos.y, r);
  float xcos = cos(xRadian);//\u6C42\u89E3\u65CB\u8F6C\u89D2\u5EA6\u4F59\u5F26\u503C
  float xsin = sin(xRadian);//\u6C42\u89E3\u65CB\u8F6C\u89D2\u5EA6\u6B63\u5F26\u503C
  mat4 mx = mat4(
    1,0,0,0,  
    0,xcos,-xsin,0,  
    0,xsin,xcos,0,  
    0,0,0,1);

  //\u65CB\u8F6C\u77E9\u9635my\uFF0C\u521B\u5EFA\u7ED5y\u8F74\u65CB\u8F6C\u77E9\u9635
  float yRadian = getYRadian(a_Pos.x, a_Pos.z);
  float ycos = cos(yRadian);//\u6C42\u89E3\u65CB\u8F6C\u89D2\u5EA6\u4F59\u5F26\u503C
  float ysin = sin(yRadian);//\u6C42\u89E3\u65CB\u8F6C\u89D2\u5EA6\u6B63\u5F26\u503C
  mat4 my = mat4(
    ycos,0,-ysin,0,  
    0,1,0,0,  
    ysin,0,ycos,0,  
    0,0,0,1);

  gl_Position = u_ViewProjectionMatrix * vec4(( my * mx *  vec4(a_Position * a_Size, 1.0)).xyz + a_Pos, 1.0);
  

  setPickingColor(a_PickingColor);
}
`,mw=In.isNumber,yw=function(e){(0,Ne.Z)(t,e);var i=pw(t);function t(){var n;(0,se.Z)(this,t);for(var r=arguments.length,a=new Array(r),u=0;u<r;u++)a[u]=arguments[u];return n=i.call.apply(i,[this].concat(a)),(0,Me.Z)((0,xt.Z)(n),"raiseCount",0),(0,Me.Z)((0,xt.Z)(n),"raiseRepeat",0),n}return(0,be.Z)(t,[{key:"getUninforms",value:function(){var r=this.layer.getLayerConfig(),a=r.animateOption,u=a===void 0?{enable:!1,speed:.01,repeat:!1}:a,c=r.opacity,g=c===void 0?1:c,x=r.sourceColor,M=r.targetColor,O=r.pickLight,B=O===void 0?!1:O,W=r.heightfixed,ce=W===void 0?!1:W,oe=r.opacityLinear,Te=oe===void 0?{enable:!1,dir:"up"}:oe,Ze=r.lightEnable,qe=Ze===void 0?!0:Ze,et=0,yt=[0,0,0,0],bt=[0,0,0,0];if(x&&M&&(yt=Ni(x),bt=Ni(M),et=1),this.raiseCount<1&&this.raiseRepeat>0&&u.enable){var Ot=u.speed,jt=Ot===void 0?.01:Ot;this.raiseCount+=jt,this.raiseCount>=1&&(this.raiseRepeat>1?(this.raiseCount=0,this.raiseRepeat--):this.raiseCount=1)}return{u_pickLight:Number(B),u_heightfixed:Number(ce),u_r:u.enable&&this.raiseRepeat>0?this.raiseCount:1,u_opacity:mw(g)?g:1,u_linearColor:et,u_sourceColor:yt,u_targetColor:bt,u_opacitylinear:Number(Te.enable),u_opacitylinear_dir:Te.dir==="up"?1:0,u_lightEnable:Number(qe)}}},{key:"initModels",value:function(){var n=(0,ur.Z)(it().mark(function a(){return it().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.abrupt("return",this.buildModels());case 1:case"end":return c.stop()}},a,this)}));function r(){return n.apply(this,arguments)}return r}()},{key:"buildModels",value:function(){var n=(0,ur.Z)(it().mark(function a(){var u,c,g,x;return it().wrap(function(O){for(;;)switch(O.prev=O.next){case 0:return u=this.layer.getLayerConfig(),c=u.animateOption.repeat,g=c===void 0?1:c,this.raiseRepeat=g,O.next=4,this.layer.buildLayerModel({moduleName:"pointEarthExtrude",vertexShader:gw,fragmentShader:vw,triangulation:f1,depth:{enable:!0},cull:{enable:!0,face:lu(this.mapService.version)},blend:this.getBlend()});case 4:return x=O.sent,O.abrupt("return",[x]);case 6:case"end":return O.stop()}},a,this)}));function r(){return n.apply(this,arguments)}return r}()},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"size",type:mn.Attribute,descriptor:{name:"a_Size",buffer:{usage:je.DYNAMIC_DRAW,data:[],type:je.FLOAT},size:3,update:function(a){var u=a.size;if(u){var c=[];return Array.isArray(u)&&(c=u.length===2?[u[0],u[0],u[1]]:u),Array.isArray(u)||(c=[u,u,u]),c}else return[2,2,2]}}}),this.styleAttributeService.registerStyleAttribute({name:"normal",type:mn.Attribute,descriptor:{name:"a_Normal",buffer:{usage:je.STATIC_DRAW,data:[],type:je.FLOAT},size:3,update:function(a,u,c,g,x){return x}}}),this.styleAttributeService.registerStyleAttribute({name:"pos",type:mn.Attribute,descriptor:{name:"a_Pos",buffer:{usage:je.DYNAMIC_DRAW,data:[],type:je.FLOAT},size:3,update:function(a){var u=Is(a.coordinates);return Wy([u[0],u[1]])}}})}}]),t}(vo);function _w(e){var i=xw();return function(){var n=(0,ue.Z)(e),r;if(i){var a=(0,ue.Z)(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return(0,ze.Z)(this,r)}}function xw(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var Ew=`uniform float u_additive;
uniform float u_opacity : 1;
uniform float u_stroke_opacity : 1;
uniform float u_stroke_width : 2;

varying vec4 v_data;
varying vec4 v_color;
varying float v_radius;

#pragma include "sdf_2d"
#pragma include "picking"


void main() {
  int shape = int(floor(v_data.w + 0.5));

  vec4 strokeColor = textrueStroke == vec4(0) ? v_color : textrueStroke;

  lowp float antialiasblur = v_data.z;
  float r = v_radius / (v_radius + strokeWidth);

  float outer_df;
  float inner_df;
  // 'circle', 'triangle', 'square', 'pentagon', 'hexagon', 'octogon', 'hexagram', 'rhombus', 'vesica'
  if (shape == 0) {
    outer_df = sdCircle(v_data.xy, 1.0);
    inner_df = sdCircle(v_data.xy, r);
  } else if (shape == 1) {
    outer_df = sdEquilateralTriangle(1.1 * v_data.xy);
    inner_df = sdEquilateralTriangle(1.1 / r * v_data.xy);
  } else if (shape == 2) {
    outer_df = sdBox(v_data.xy, vec2(1.));
    inner_df = sdBox(v_data.xy, vec2(r));
  } else if (shape == 3) {
    outer_df = sdPentagon(v_data.xy, 0.8);
    inner_df = sdPentagon(v_data.xy, r * 0.8);
  } else if (shape == 4) {
    outer_df = sdHexagon(v_data.xy, 0.8);
    inner_df = sdHexagon(v_data.xy, r * 0.8);
  } else if (shape == 5) {
    outer_df = sdOctogon(v_data.xy, 1.0);
    inner_df = sdOctogon(v_data.xy, r);
  } else if (shape == 6) {
    outer_df = sdHexagram(v_data.xy, 0.52);
    inner_df = sdHexagram(v_data.xy, r * 0.52);
  } else if (shape == 7) {
    outer_df = sdRhombus(v_data.xy, vec2(1.0));
    inner_df = sdRhombus(v_data.xy, vec2(r));
  } else if (shape == 8) {
    outer_df = sdVesica(v_data.xy, 1.1, 0.8);
    inner_df = sdVesica(v_data.xy, r * 1.1, r * 0.8);
  }

  if(outer_df > antialiasblur + 0.018) discard;

  float opacity_t = smoothstep(0.0, antialiasblur, outer_df);

  float color_t = strokeWidth < 0.01 ? 0.0 : smoothstep(
    antialiasblur,
    0.0,
    inner_df
  );

  if(strokeWidth < 0.01) {
    gl_FragColor = vec4(v_color.rgb, v_color.a * u_opacity);
  } else {
    gl_FragColor = mix(vec4(v_color.rgb, v_color.a * u_opacity), u_stroke_color * u_stroke_opacity, color_t);
  }

  if(u_additive > 0.0) {
    gl_FragColor *= opacity_t;
    gl_FragColor = filterColorAlpha(gl_FragColor, gl_FragColor.a);
  } else {
    gl_FragColor.a *= opacity_t;
    gl_FragColor = filterColor(gl_FragColor);
  }
}
`,bw=`attribute vec4 a_Color;
attribute vec3 a_Position;
attribute vec3 a_Extrude;
attribute float a_Size;
attribute float a_Shape;
uniform mat4 u_ModelMatrix;


varying vec4 v_data;
varying vec4 v_color;
varying float v_radius;

uniform float u_opacity : 1;
uniform float u_stroke_opacity : 1;
uniform float u_stroke_width : 2;
uniform vec4 u_stroke_color : [0.0, 0.0, 0.0, 0.0];
uniform vec2 u_offsets;

uniform float u_blur : 0.0;

#pragma include "projection"
#pragma include "picking"


void main() {
  vec3 extrude = a_Extrude;
  float shape_type = a_Shape;
  /*
  *  setPickingSize \u8BBE\u7F6E\u62FE\u53D6\u5927\u5C0F
  */
  float newSize = setPickingSize(a_Size);
  // float newSize = setPickingSize(a_Size) * 0.00001038445708445579;

  // unpack color(vec2)
  v_color = a_Color;

  // radius(16-bit)
  v_radius = newSize;

  // anti-alias
  //  float antialiased_blur = -max(u_blur, antialiasblur);
  float antialiasblur = -max(2.0 / u_DevicePixelRatio / newSize, u_blur);

  // TODP: /abs(extrude.x) \u662F\u4E3A\u4E86\u517C\u5BB9\u5730\u7403\u6A21\u5F0F
  v_data = vec4(extrude.x/abs(extrude.x), extrude.y/abs(extrude.y), antialiasblur,shape_type);


  gl_Position = u_ViewProjectionMatrix * vec4(a_Position + extrude * newSize * 0.1 + u_offsets, 1.0);

  setPickingColor(a_PickingColor);
}
`,Sw=function(e){(0,Ne.Z)(t,e);var i=_w(t);function t(){return(0,se.Z)(this,t),i.apply(this,arguments)}return(0,be.Z)(t,[{key:"getUninforms",value:function(){var r=this.layer.getLayerConfig(),a=r.opacity,u=a===void 0?1:a,c=r.strokeOpacity,g=c===void 0?1:c,x=r.strokeWidth,M=x===void 0?0:x,O=r.stroke,B=O===void 0?"rgba(0,0,0,0)":O,W=r.blend,ce=r.blur,oe=ce===void 0?0:ce;return{u_blur:oe,u_additive:W==="additive"?1:0,u_opacity:u,u_stroke_opacity:g,u_stroke_width:M,u_stroke_color:Ni(B)}}},{key:"getAnimateUniforms",value:function(){var r=this.layer.getLayerConfig(),a=r.animateOption,u=a===void 0?{enable:!1}:a;return{u_animate:this.animateOption2Array(u),u_time:this.layer.getLayerAnimateTime()}}},{key:"initModels",value:function(){var n=(0,ur.Z)(it().mark(function a(){return it().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.abrupt("return",this.buildModels());case 1:case"end":return c.stop()}},a,this)}));function r(){return n.apply(this,arguments)}return r}()},{key:"buildModels",value:function(){var n=(0,ur.Z)(it().mark(function a(){var u;return it().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return this.layer.triangulation=c1,g.next=3,this.layer.buildLayerModel({moduleName:"pointEarthFill",vertexShader:bw,fragmentShader:Ew,triangulation:c1,depth:{enable:!0},blend:this.getBlend()});case 3:return u=g.sent,g.abrupt("return",[u]);case 5:case"end":return g.stop()}},a,this)}));function r(){return n.apply(this,arguments)}return r}()},{key:"animateOption2Array",value:function(r){return[r.enable?0:1,r.speed||1,r.rings||3,0]}},{key:"registerBuiltinAttributes",value:function(){var r=this;this.styleAttributeService.registerStyleAttribute({name:"extrude",type:mn.Attribute,descriptor:{name:"a_Extrude",buffer:{usage:je.DYNAMIC_DRAW,data:[],type:je.FLOAT},size:3,update:function(u,c,g,x){var M=(0,vn.Z)(g,3),O=M[0],B=M[1],W=M[2],ce=Pu(0,0,1),oe=Pu(O,0,W),Te=O>=0?fg(ce,oe):Math.PI*2-fg(ce,oe),Ze=Math.PI*2-Math.asin(B/100),qe=Qn();q0(qe,qe,Te),fc(qe,qe,Ze);var et=Pu(1,1,0);hp(et,et,qe),uA(et,et);var yt=Pu(-1,1,0);hp(yt,yt,qe),uA(yt,yt);var bt=Pu(-1,-1,0);hp(bt,bt,qe),uA(bt,bt);var Ot=Pu(1,-1,0);hp(Ot,Ot,qe),uA(Ot,Ot);var jt=[].concat((0,pr.Z)(et),(0,pr.Z)(yt),(0,pr.Z)(bt),(0,pr.Z)(Ot)),or=x%4*3;return[jt[or],jt[or+1],jt[or+2]]}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:mn.Attribute,descriptor:{name:"a_Size",buffer:{usage:je.DYNAMIC_DRAW,data:[],type:je.FLOAT},size:1,update:function(u){var c=u.size,g=c===void 0?5:c;return Array.isArray(g)?[g[0]]:[g]}}}),this.styleAttributeService.registerStyleAttribute({name:"shape",type:mn.Attribute,descriptor:{name:"a_Shape",buffer:{usage:je.DYNAMIC_DRAW,data:[],type:je.FLOAT},size:1,update:function(u){var c=u.shape,g=c===void 0?2:c,x=r.layer.getLayerConfig().shape2d,M=x.indexOf(g);return[M]}}})}}]),t}(vo);function Cw(e){var i=ww();return function(){var n=(0,ue.Z)(e),r;if(i){var a=(0,ue.Z)(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return(0,ze.Z)(this,r)}}function ww(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var Tw=`varying vec4 v_color;
varying float v_lightWeight;
uniform float u_pickLight: 0.0;

#pragma include "picking"


void main() {

  gl_FragColor = v_color;
  // \u5F00\u542F\u900F\u660E\u5EA6\u6E10\u53D8
  // picking
  if(u_pickLight > 0.0) {
    gl_FragColor = filterColorAlpha(gl_FragColor, v_lightWeight);
  } else {
    gl_FragColor = filterColor(gl_FragColor);
  }
}
`,Mw=`precision highp float;

#define pi 3.1415926535
#define ambientRatio 0.5
#define diffuseRatio 0.3
#define specularRatio 0.2

attribute vec3 a_Position;
attribute vec3 a_Pos;
attribute vec4 a_Color;
attribute vec3 a_Size;
attribute vec3 a_Normal;

uniform float u_heightfixed: 0.0; // \u9ED8\u8BA4\u4E0D\u56FA\u5B9A
uniform float u_r;
uniform mat4 u_ModelMatrix;

varying vec4 v_color;
varying float v_lightWeight;
varying float v_barLinearZ;

uniform float u_opacity : 1;
uniform float u_lightEnable: 1;
uniform float u_opacitylinear: 0.0;
uniform vec4 u_sourceColor;
uniform vec4 u_targetColor;
uniform float u_opacitylinear_dir: 1.0;
uniform float  u_linearColor: 0.0;


#pragma include "projection"
#pragma include "light"
#pragma include "picking"

float getYRadian(float x, float z) {
  if(x > 0.0 && z > 0.0) {
    return atan(x/z);
  } else if(x > 0.0 && z <= 0.0){
    return atan(-z/x) + pi/2.0;
  } else if(x <= 0.0 && z <= 0.0) {
    return  pi + atan(x/z); //atan(x/z) + 
  } else {
    return atan(z/-x) + pi*3.0/2.0;
  }
}

float getXRadian(float y, float r) {
  return atan(y/r);
}

void main() {


  vec3 size = a_Size * a_Position;

  vec3 offset = size; // \u63A7\u5236\u5706\u67F1\u4F53\u7684\u5927\u5C0F - \u4ECE\u6807\u51C6\u5355\u4F4D\u5706\u67F1\u4F53\u8FDB\u884C\u504F\u79FB

  if(u_heightfixed < 1.0) { // \u5706\u67F1\u4F53\u4E0D\u56FA\u5B9A\u9AD8\u5EA6
    
    if (u_CoordinateSystem == COORDINATE_SYSTEM_P20 || u_CoordinateSystem == COORDINATE_SYSTEM_P20_OFFSET) {
      // P20 \u5750\u6807\u7CFB\u4E0B\uFF0C\u4E3A\u4E86\u548C Web \u58A8\u5361\u6258\u5750\u6807\u7CFB\u7EDF\u4E00\uFF0Czoom \u9ED8\u8BA4\u51CF1
      offset = offset * pow(2.0, (19.0 - u_Zoom));
    }
    if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) {
      // P20_2 \u5750\u6807\u7CFB\u4E0B\uFF0C\u4E3A\u4E86\u548C Web \u58A8\u5361\u6258\u5750\u6807\u7CFB\u7EDF\u4E00\uFF0Czoom \u9ED8\u8BA4\u51CF3
      offset = offset * pow(2.0, (19.0 - 3.0 - u_Zoom));
    }
  } else {// \u5706\u67F1\u4F53\u56FA\u5B9A\u9AD8\u5EA6 \uFF08 \u5904\u7406 mapbox \uFF09
    if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
      offset *= 4.0/pow(2.0, 21.0 - u_Zoom);
    }
  }


  vec4 project_pos = project_position(vec4(a_Pos.xy, 0., 1.0));

  // u_r \u63A7\u5236\u5706\u67F1\u7684\u751F\u957F
  vec4 pos = vec4(project_pos.xy + offset.xy, offset.z * u_r, 1.0);

  // // \u5706\u67F1\u5149\u7167\u6548\u679C
  float lightWeight = 1.0;

  if(u_lightEnable > 0.0) { // \u53D6\u6D88\u4E09\u5143\u8868\u8FBE\u5F0F\uFF0C\u589E\u5F3A\u5065\u58EE\u6027
    lightWeight = calc_lighting(pos);
  }

  v_lightWeight = lightWeight;

  v_color = a_Color;

    // \u8BBE\u7F6E\u5706\u67F1\u7684\u5E95\u8272
  if(u_linearColor == 1.0) { // \u4F7F\u7528\u6E10\u53D8\u989C\u8272
    v_color = mix(u_sourceColor, u_targetColor, a_Position.z);
    v_color.a =  v_color.a * u_opacity;
  } else {
    v_color = vec4(a_Color.rgb * lightWeight, a_Color.w * u_opacity);
  }

    if(u_opacitylinear > 0.0) {
    v_color.a *= u_opacitylinear_dir > 0.0 ? (1.0 - a_Position.z): a_Position.z;
  }


  // gl_Position = project_common_position_to_clipspace(pos);

  gl_Position = project_common_position_to_clipspace_v2(pos);

  setPickingColor(a_PickingColor);
}
`,x1=function(e){(0,Ne.Z)(t,e);var i=Cw(t);function t(){var n;(0,se.Z)(this,t);for(var r=arguments.length,a=new Array(r),u=0;u<r;u++)a[u]=arguments[u];return n=i.call.apply(i,[this].concat(a)),(0,Me.Z)((0,xt.Z)(n),"raiseCount",0),(0,Me.Z)((0,xt.Z)(n),"raiseRepeat",0),n}return(0,be.Z)(t,[{key:"getUninforms",value:function(){var r=this.layer.getLayerConfig(),a=r.animateOption,u=a===void 0?{enable:!1,speed:.01,repeat:!1}:a,c=r.opacity,g=c===void 0?1:c,x=r.sourceColor,M=r.targetColor,O=r.pickLight,B=O===void 0?!1:O,W=r.heightfixed,ce=W===void 0?!1:W,oe=r.opacityLinear,Te=oe===void 0?{enable:!1,dir:"up"}:oe,Ze=r.lightEnable,qe=Ze===void 0?!0:Ze,et=0,yt=[0,0,0,0],bt=[0,0,0,0];if(x&&M&&(yt=Ni(x),bt=Ni(M),et=1),this.raiseCount<1&&this.raiseRepeat>0&&u.enable){var Ot=u.speed,jt=Ot===void 0?.01:Ot;this.raiseCount+=jt,this.raiseCount>=1&&(this.raiseRepeat>1?(this.raiseCount=0,this.raiseRepeat--):this.raiseCount=1)}return{u_pickLight:Number(B),u_heightfixed:Number(ce),u_r:u.enable&&this.raiseRepeat>0?this.raiseCount:1,u_opacity:g,u_linearColor:et,u_sourceColor:yt,u_targetColor:bt,u_opacitylinear:Number(Te.enable),u_opacitylinear_dir:Te.dir==="up"?1:0,u_lightEnable:Number(qe)}}},{key:"initModels",value:function(){var n=(0,ur.Z)(it().mark(function a(){return it().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.abrupt("return",this.buildModels());case 1:case"end":return c.stop()}},a,this)}));function r(){return n.apply(this,arguments)}return r}()},{key:"buildModels",value:function(){var n=(0,ur.Z)(it().mark(function a(){var u,c,g,x,M,O;return it().wrap(function(W){for(;;)switch(W.prev=W.next){case 0:return u=this.layer.getLayerConfig(),c=u.depth,g=c===void 0?!0:c,x=u.animateOption.repeat,M=x===void 0?1:x,this.raiseRepeat=M,W.next=4,this.layer.buildLayerModel({moduleName:"pointExtrude",vertexShader:Mw,fragmentShader:Tw,triangulation:f1,cull:{enable:!0,face:lu(this.mapService.version)},depth:{enable:g}});case 4:return O=W.sent,W.abrupt("return",[O]);case 6:case"end":return W.stop()}},a,this)}));function r(){return n.apply(this,arguments)}return r}()},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"size",type:mn.Attribute,descriptor:{name:"a_Size",buffer:{usage:je.DYNAMIC_DRAW,data:[],type:je.FLOAT},size:3,update:function(a){var u=a.size;if(u){var c=[];return Array.isArray(u)&&(c=u.length===2?[u[0],u[0],u[1]]:u),Array.isArray(u)||(c=[u,u,u]),c}else return[2,2,2]}}}),this.styleAttributeService.registerStyleAttribute({name:"normal",type:mn.Attribute,descriptor:{name:"a_Normal",buffer:{usage:je.STATIC_DRAW,data:[],type:je.FLOAT},size:3,update:function(a,u,c,g,x){return x}}}),this.styleAttributeService.registerStyleAttribute({name:"pos",type:mn.Attribute,descriptor:{name:"a_Pos",buffer:{usage:je.DYNAMIC_DRAW,data:[],type:je.FLOAT},size:3,update:function(a){var u=Is(a.coordinates);return[u[0],u[1],0]}}})}}]),t}(vo);function Iw(e){var i=Pw();return function(){var n=(0,ue.Z)(e),r;if(i){var a=(0,ue.Z)(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return(0,ze.Z)(this,r)}}function Pw(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var E1=`
uniform float u_additive;


varying vec4 v_data;
varying vec4 v_color;
varying float v_radius;
uniform float u_time;
uniform vec4 u_animate: [ 1., 2., 1.0, 0.2 ];

#pragma include "sdf_2d"
#pragma include "picking"

void main() {

  lowp float antialiasblur = v_data.z;
  float r = v_radius / (v_radius);

  float outer_df;
  float inner_df;
  // 'circle', 'triangle', 'square', 'pentagon', 'hexagon', 'octogon', 'hexagram', 'rhombus', 'vesica'
  
  outer_df = sdCircle(v_data.xy, 1.0);
  inner_df = sdCircle(v_data.xy, r);


  float opacity_t = smoothstep(0.0, antialiasblur, outer_df);

  float color_t = smoothstep(
    antialiasblur,
    0.0,
    inner_df
  );
  float PI = 3.14159;
  float N_RINGS = 3.0;
  float FREQ = 1.0;

  gl_FragColor = v_color;

  float d = length(v_data.xy);
  if(d > 0.5) {
    discard;
  }
  float intensity = clamp(cos(d * PI), 0.0, 1.0) * clamp(cos(2.0 * PI * (d * 2.0 * u_animate.z - u_animate.y * u_time)), 0.0, 1.0);
  
  // \u6839\u636E\u53E0\u52A0\u6A21\u5F0F\u9009\u62E9\u6548\u679C
  if(u_additive > 0.0) {
    gl_FragColor *= intensity;
    // \u4F18\u5316\u6C34\u6CE2\u70B9 blend additive \u6A21\u5F0F\u4E0B\u6709\u7684\u62FE\u53D6\u6548\u679C 
    gl_FragColor = filterColorAlpha(gl_FragColor, gl_FragColor.a);
  } else {
    gl_FragColor = vec4(gl_FragColor.xyz, gl_FragColor.a * intensity);
    gl_FragColor = filterColor(gl_FragColor);
  }
}
`,Lw=`uniform float u_additive;
uniform float u_stroke_opacity : 1;
uniform float u_stroke_width : 2;

varying vec4 v_data;
varying vec4 v_color;
varying float v_radius;
varying vec4 v_stroke;


#pragma include "sdf_2d"
#pragma include "picking"


void main() {
  int shape = int(floor(v_data.w + 0.5));
  lowp float antialiasblur = v_data.z;
  float r = v_radius / (v_radius + u_stroke_width);

  float outer_df;
  float inner_df;
  // 'circle', 'triangle', 'square', 'pentagon', 'hexagon', 'octogon', 'hexagram', 'rhombus', 'vesica'
  if (shape == 0) {
    outer_df = sdCircle(v_data.xy, 1.0);
    inner_df = sdCircle(v_data.xy, r);
  } else if (shape == 1) {
    outer_df = sdEquilateralTriangle(1.1 * v_data.xy);
    inner_df = sdEquilateralTriangle(1.1 / r * v_data.xy);
  } else if (shape == 2) {
    outer_df = sdBox(v_data.xy, vec2(1.));
    inner_df = sdBox(v_data.xy, vec2(r));
  } else if (shape == 3) {
    outer_df = sdPentagon(v_data.xy, 0.8);
    inner_df = sdPentagon(v_data.xy, r * 0.8);
  } else if (shape == 4) {
    outer_df = sdHexagon(v_data.xy, 0.8);
    inner_df = sdHexagon(v_data.xy, r * 0.8);
  } else if (shape == 5) {
    outer_df = sdOctogon(v_data.xy, 1.0);
    inner_df = sdOctogon(v_data.xy, r);
  } else if (shape == 6) {
    outer_df = sdHexagram(v_data.xy, 0.52);
    inner_df = sdHexagram(v_data.xy, r * 0.52);
  } else if (shape == 7) {
    outer_df = sdRhombus(v_data.xy, vec2(1.0));
    inner_df = sdRhombus(v_data.xy, vec2(r));
  } else if (shape == 8) {
    outer_df = sdVesica(v_data.xy, 1.1, 0.8);
    inner_df = sdVesica(v_data.xy, r * 1.1, r * 0.8);
  }

  float opacity_t = smoothstep(0.0, antialiasblur, outer_df);

  float color_t = u_stroke_width < 0.01 ? 0.0 : smoothstep(
    antialiasblur,
    0.0,
    inner_df
  );

  if(u_stroke_width < 0.01) {
    gl_FragColor = v_color;
  } else {
    gl_FragColor = mix(v_color, v_stroke * u_stroke_opacity, color_t);
  }

  if(u_additive > 0.0) {
    gl_FragColor *= opacity_t;
    gl_FragColor = filterColorAlpha(gl_FragColor, gl_FragColor.a);
  } else {
    gl_FragColor.a *= opacity_t;
    gl_FragColor = filterColor(gl_FragColor);
  }
   // \u4F5C\u4E3A mask \u6A21\u677F\u65F6\u9700\u8981\u4E22\u5F03\u900F\u660E\u7684\u50CF\u7D20
  if(gl_FragColor.a < 0.01) {
    discard;
  } 
}
`,yg=`attribute vec4 a_Color;
attribute vec3 a_Position;
attribute vec3 a_Extrude;
attribute float a_Size;
attribute float a_Shape;
uniform mat4 u_ModelMatrix;

uniform int u_size_unit;

varying vec4 v_data;
varying vec4 v_color;
varying float v_radius;
varying vec4 v_stroke;
uniform float u_stroke_width: 2;
uniform vec3 u_blur_height_fixed: [0, 0, 0];


#pragma include "projection"
#pragma include "picking"
#pragma include "rotation_2d"


void main() {
  // \u900F\u660E\u5EA6\u8BA1\u7B97
   v_stroke = stroke;  
  vec3 extrude = a_Extrude;
  float shape_type = a_Shape;
  /*
  *  setPickingSize \u8BBE\u7F6E\u62FE\u53D6\u5927\u5C0F
  *  u_meter2coord \u5728\u7B49\u9762\u79EF\u5927\u5C0F\u7684\u65F6\u5019\u8BBE\u7F6E\u5355\u4F4D
  */
  float newSize = setPickingSize(a_Size);
  // float newSize = setPickingSize(a_Size) * 0.00001038445708445579;



  // unpack color(vec2)
  v_color = vec4(a_Color.xyz, a_Color.w * opacity);

  if(u_size_unit == 1) {
    newSize = newSize  * u_PixelsPerMeter.z;
  }

   v_radius = newSize;

  // anti-alias
  //  float antialiased_blur = -max(u_blur, antialiasblur);
  float antialiasblur = -max(2.0 / u_DevicePixelRatio / newSize, u_blur_height_fixed.x);

  vec2 offset = (extrude.xy * (newSize + u_stroke_width) + u_offsets);
  vec3 aPosition = a_Position;

  offset = project_pixel(offset);
  offset = rotate_matrix(offset,rotation);
  
  // TODP: /abs(extrude.x) \u662F\u4E3A\u4E86\u517C\u5BB9\u5730\u7403\u6A21\u5F0F
  v_data = vec4(extrude.x/abs(extrude.x), extrude.y/abs(extrude.y), antialiasblur,shape_type);


  // vec4 project_pos = project_position(vec4(a_Position.xy, 0.0, 1.0));
  vec4 project_pos = project_position(vec4(aPosition.xy, 0.0, 1.0));
  // gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, project_pixel(setPickingOrder(0.0)), 1.0));

  float raisingHeight = u_blur_height_fixed.y;

  if(u_blur_height_fixed.z < 1.0) { // false
    raisingHeight = project_pixel(u_blur_height_fixed.y);
  } else {
     if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
      float mapboxZoomScale = 4.0/pow(2.0, 21.0 - u_Zoom);
      raisingHeight = u_blur_height_fixed.y * mapboxZoomScale;
    }
  }
  
  gl_Position = project_common_position_to_clipspace_v2(vec4(project_pos.xy + offset, raisingHeight, 1.0));

  setPickingColor(a_PickingColor);
}
`,b1=function(e){(0,Ne.Z)(t,e);var i=Iw(t);function t(){return(0,se.Z)(this,t),i.apply(this,arguments)}return(0,be.Z)(t,[{key:"getUninforms",value:function(){var r=this.layer.getLayerConfig(),a=r.strokeOpacity,u=a===void 0?1:a,c=r.strokeWidth,g=c===void 0?0:c,x=r.blend,M=r.blur,O=M===void 0?0:M,B=r.raisingHeight,W=B===void 0?0:B,ce=r.heightfixed,oe=ce===void 0?!1:ce,Te=r.unit,Ze=Te===void 0?"pixel":Te;return(0,X.Z)({u_blur_height_fixed:[O,Number(W),Number(oe)],u_additive:x==="additive"?1:0,u_stroke_opacity:u,u_stroke_width:g,u_size_unit:gg[Ze]},this.getStyleAttribute())}},{key:"getAnimateUniforms",value:function(){var r=this.layer.getLayerConfig(),a=r.animateOption,u=a===void 0?{enable:!1}:a;return{u_animate:this.animateOption2Array(u),u_time:this.layer.getLayerAnimateTime()}}},{key:"getAttribute",value:function(){return this.styleAttributeService.createAttributesAndIndices(this.layer.getEncodedData(),pa)}},{key:"initModels",value:function(){var n=(0,ur.Z)(it().mark(function a(){return it().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.abrupt("return",this.buildModels());case 1:case"end":return c.stop()}},a,this)}));function r(){return n.apply(this,arguments)}return r}()},{key:"buildModels",value:function(){var n=(0,ur.Z)(it().mark(function a(){var u,c,g,x,M,O,B,W;return it().wrap(function(oe){for(;;)switch(oe.prev=oe.next){case 0:return u=this.layer.getLayerConfig(),c=u.animateOption,g=c===void 0?{enable:!1}:c,x=this.getShaders(g),M=x.frag,O=x.vert,B=x.type,this.layer.triangulation=pa,oe.next=5,this.layer.buildLayerModel({moduleName:B,vertexShader:O,fragmentShader:M,inject:this.getInject(),triangulation:pa,depth:{enable:!1}});case 5:return W=oe.sent,oe.abrupt("return",[W]);case 7:case"end":return oe.stop()}},a,this)}));function r(){return n.apply(this,arguments)}return r}()},{key:"getShaders",value:function(r){if(r.enable)switch(r.type){case"wave":return{frag:E1,vert:yg,type:"pointWave"};default:return{frag:E1,vert:yg,type:"pointWave"}}else return{frag:Lw,vert:yg,type:"pointFill"}}},{key:"animateOption2Array",value:function(r){return[r.enable?0:1,r.speed||1,r.rings||3,0]}},{key:"registerBuiltinAttributes",value:function(){var r=this.layer.getLayerConfig().shape2d;this.styleAttributeService.registerStyleAttribute({name:"extrude",type:mn.Attribute,descriptor:{name:"a_Extrude",buffer:{usage:je.DYNAMIC_DRAW,data:[],type:je.FLOAT},size:3,update:function(u,c,g,x){var M=[1,1,0,-1,1,0,-1,-1,0,1,-1,0],O=x%4*3;return[M[O],M[O+1],M[O+2]]}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:mn.Attribute,descriptor:{name:"a_Size",buffer:{usage:je.DYNAMIC_DRAW,data:[],type:je.FLOAT},size:1,update:function(u){var c=u.size,g=c===void 0?5:c;return Array.isArray(g)?[g[0]]:[g]}}}),this.styleAttributeService.registerStyleAttribute({name:"shape",type:mn.Attribute,descriptor:{name:"a_Shape",buffer:{usage:je.DYNAMIC_DRAW,data:[],type:je.FLOAT},size:1,update:function(u){var c=u.shape,g=c===void 0?2:c,x=r.indexOf(g);return[x]}}})}}]),t}(vo);function Ow(e){var i=Rw();return function(){var n=(0,ue.Z)(e),r;if(i){var a=(0,ue.Z)(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return(0,ze.Z)(this,r)}}function Rw(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var Dw=`uniform sampler2D u_texture;
uniform vec2 u_textSize;
uniform float u_opacity : 1;

#pragma include "sdf_2d"
#pragma include "picking"
varying vec2 v_uv; // \u672C\u8EAB\u7684 uv \u5750\u6807
varying vec2 v_Iconuv;
varying float v_opacity;

void main() {

  vec2 pos = v_Iconuv / u_textSize + v_uv / u_textSize * 64.;
  gl_FragColor = texture2D(u_texture, pos);
  gl_FragColor.a *= v_opacity;

  gl_FragColor = filterColor(gl_FragColor);
}
`,kw=`attribute vec4 a_Color;
attribute vec3 a_Position;
attribute vec3 a_Extrude;
attribute float a_Size;
attribute vec2 a_Uv;

uniform mat4 u_ModelMatrix;

uniform mat2 u_RotateMatrix;
uniform int u_size_unit;

varying vec2 v_uv; // \u672C\u8EAB\u7684 uv \u5750\u6807
varying vec2 v_Iconuv; // icon \u8D34\u56FE\u7684 uv \u5750\u6807

uniform float u_raisingHeight: 0.0;
uniform float u_heightfixed: 0.0;
varying float v_opacity;
// uniform vec2 u_offsets; // shader \u6CE8\u5165


#pragma include "projection"
#pragma include "picking"
#pragma include "rotation_2d"

void main() {
  vec3 extrude = a_Extrude;
  v_uv = (a_Extrude.xy + 1.0)/2.0;
  v_uv.y = 1.0 - v_uv.y;
  v_Iconuv = a_Uv;
  v_opacity = opacity;
  float newSize = a_Size;
  if(u_size_unit == 1) {
    newSize = newSize  * u_PixelsPerMeter.z;
  }
  
  // vec2 offset = (u_RotateMatrix * extrude.xy * (a_Size) + textrueOffsets);
  vec2 offset = (extrude.xy * (newSize) + offsets);

  offset = rotate_matrix(offset,rotation);

  vec3 aPosition = a_Position;

  offset = project_pixel(offset);

  vec4 project_pos = project_position(vec4(aPosition.xy, 0.0, 1.0));
  float raisingHeight = u_raisingHeight;
  if(u_heightfixed < 1.0) { // height fixed
    raisingHeight = project_pixel(u_raisingHeight);
  } else {
    if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
      float mapboxZoomScale = 4.0/pow(2.0, 21.0 - u_Zoom);
      raisingHeight = u_raisingHeight * mapboxZoomScale;
    }
  }

  gl_Position = project_common_position_to_clipspace_v2(vec4(project_pos.xy + offset, 0.0, 1.0));

  setPickingColor(a_PickingColor);
}
`,Nw=function(e){(0,Ne.Z)(t,e);var i=Ow(t);function t(){var n;(0,se.Z)(this,t);for(var r=arguments.length,a=new Array(r),u=0;u<r;u++)a[u]=arguments[u];return n=i.call.apply(i,[this].concat(a)),(0,Me.Z)((0,xt.Z)(n),"meter2coord",1),(0,Me.Z)((0,xt.Z)(n),"isMeter",!1),(0,Me.Z)((0,xt.Z)(n),"radian",0),(0,Me.Z)((0,xt.Z)(n),"updateTexture",function(){var c=n.rendererService.createTexture2D;if(n.texture){n.texture.update({data:n.iconService.getCanvas(),mag:"linear",min:"linear mipmap nearest",mipmap:!0}),n.layerService.throttleRenderLayers();return}n.texture=c({data:n.iconService.getCanvas(),mag:je.LINEAR,min:je.LINEAR_MIPMAP_LINEAR,premultiplyAlpha:!1,width:1024,height:n.iconService.canvasHeight||128,mipmap:!0})}),n}return(0,be.Z)(t,[{key:"getUninforms",value:function(){var r=this.layer.getLayerConfig(),a=r.raisingHeight,u=a===void 0?0:a,c=r.heightfixed,g=c===void 0?!1:c,x=r.unit,M=x===void 0?"pixel":x;return this.rendererService.getDirty()&&this.texture.bind(),(0,X.Z)({u_raisingHeight:Number(u),u_heightfixed:Number(g),u_size_unit:gg[M],u_texture:this.texture,u_textSize:[1024,this.iconService.canvasHeight||128]},this.getStyleAttribute())}},{key:"getAttribute",value:function(){return this.styleAttributeService.createAttributesAndIndices(this.layer.getEncodedData(),Dd)}},{key:"initModels",value:function(){var n=(0,ur.Z)(it().mark(function a(){return it().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return this.iconService.on("imageUpdate",this.updateTexture),this.updateTexture(),c.abrupt("return",this.buildModels());case 3:case"end":return c.stop()}},a,this)}));function r(){return n.apply(this,arguments)}return r}()},{key:"buildModels",value:function(){var n=(0,ur.Z)(it().mark(function a(){var u;return it().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return g.next=2,this.layer.buildLayerModel({moduleName:"pointFillImage",vertexShader:kw,fragmentShader:Dw,triangulation:Dd,depth:{enable:!1},inject:this.getInject(),cull:{enable:!0,face:lu(this.mapService.version)}});case 2:return u=g.sent,g.abrupt("return",[u]);case 4:case"end":return g.stop()}},a,this)}));function r(){return n.apply(this,arguments)}return r}()},{key:"clearModels",value:function(){var r;this.iconService.off("imageUpdate",this.updateTexture),(r=this.texture)===null||r===void 0||r.destroy()}},{key:"registerBuiltinAttributes",value:function(){var r=this;this.styleAttributeService.registerStyleAttribute({name:"uv",type:mn.Attribute,descriptor:{name:"a_Uv",buffer:{usage:je.DYNAMIC_DRAW,data:[],type:je.FLOAT},size:2,update:function(u){var c=r.iconService.getIconMap(),g=u.shape,x=c[g]||{x:-64,y:-64},M=x.x,O=x.y;return[M,O]}}}),this.styleAttributeService.registerStyleAttribute({name:"extrude",type:mn.Attribute,descriptor:{name:"a_Extrude",buffer:{usage:je.DYNAMIC_DRAW,data:[],type:je.FLOAT},size:3,update:function(u,c,g,x){var M=[1,1,0,-1,1,0,-1,-1,0,1,-1,0],O=x%4*3;return[M[O],M[O+1],M[O+2]]}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:mn.Attribute,descriptor:{name:"a_Size",buffer:{usage:je.DYNAMIC_DRAW,data:[],type:je.FLOAT},size:1,update:function(u){var c=u.size,g=c===void 0?5:c;return Array.isArray(g)?[g[0]]:[g]}}})}}]),t}(vo);function Fw(e){var i=Bw();return function(){var n=(0,ue.Z)(e),r;if(i){var a=(0,ue.Z)(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return(0,ze.Z)(this,r)}}function Bw(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var Zw=`
uniform sampler2D u_texture;
varying vec4 v_color;
varying vec2 v_uv;
varying float v_opacity;
uniform vec2 u_textSize;

#pragma include "picking"

void main(){
      vec2 pos = v_uv / u_textSize + gl_PointCoord / u_textSize * 64.;
      vec4 textureColor;

      // Y = 0.299R + 0.587G + 0.114B // \u4EAE\u5EA6\u63D0\u53D6
     
      textureColor = texture2D(u_texture, pos);

      // Tip: \u53BB\u9664\u8FB9\u7F18\u90E8\u5206 mipmap \u5BFC\u81F4\u7684\u6DF7\u5408\u53D8\u6697
      float fragmengTocenter = distance(vec2(0.5), gl_PointCoord);
      if(fragmengTocenter >= 0.5) {
            float luma = 0.299 * textureColor.r + 0.587 * textureColor.g + 0.114 * textureColor.b;
            textureColor.a *= luma;
      }
      
      

      if(all(lessThan(v_color, vec4(1.0+0.00001))) && all(greaterThan(v_color, vec4(1.0-0.00001))) || v_color==vec4(1.0)){
            gl_FragColor= textureColor;
      }else {
            gl_FragColor= step(0.01, textureColor.z) * v_color;
      }
      gl_FragColor.a *= v_opacity;
      if (gl_FragColor.a < 0.01) {
         discard;
      }
      gl_FragColor = filterColor(gl_FragColor);
}
`,zw=`precision highp float;
attribute vec3 a_Position;
attribute vec4 a_Color;
attribute vec2 a_Uv;
attribute float a_Size;
varying vec4 v_color;
varying vec2 v_uv;
varying float v_opacity;
uniform mat4 u_ModelMatrix;


uniform float u_raisingHeight: 0.0;
uniform float u_heightfixed: 0.0;

#pragma include "projection"
#pragma include "picking"

void main() {

  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
  v_color = a_Color;
  v_opacity = opacity;
  v_uv = a_Uv;
  vec4 project_pos = project_position(vec4(a_Position, 1.0));
   
  vec2 offset = project_pixel(offsets);

  float raisingHeight = u_raisingHeight;
  if(u_heightfixed < 1.0) { // false
    raisingHeight = project_pixel(u_raisingHeight);
  } else {
     if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
      float mapboxZoomScale = 4.0/pow(2.0, 21.0 - u_Zoom);
      raisingHeight = u_raisingHeight * mapboxZoomScale;
    }
  }


  gl_Position = project_common_position_to_clipspace_v2(vec4(project_pos.xy + offset, raisingHeight, 1.0));

  gl_PointSize = a_Size * 2.0 * u_DevicePixelRatio;
  setPickingColor(a_PickingColor);
}
`,S1=function(e){(0,Ne.Z)(t,e);var i=Fw(t);function t(){var n;(0,se.Z)(this,t);for(var r=arguments.length,a=new Array(r),u=0;u<r;u++)a[u]=arguments[u];return n=i.call.apply(i,[this].concat(a)),(0,Me.Z)((0,xt.Z)(n),"updateTexture",function(){var c=n.rendererService.createTexture2D;if(n.texture){n.texture.update({data:n.iconService.getCanvas(),mag:"linear",min:"linear mipmap nearest",mipmap:!0}),setTimeout(function(){n.layerService.throttleRenderLayers()});return}n.texture=c({data:n.iconService.getCanvas(),mag:je.LINEAR,min:je.LINEAR_MIPMAP_LINEAR,premultiplyAlpha:!1,width:1024,height:n.iconService.canvasHeight||128,mipmap:!0})}),n}return(0,be.Z)(t,[{key:"getUninforms",value:function(){var r=this.layer.getLayerConfig(),a=r.opacity,u=a===void 0?1:a,c=r.offsets,g=c===void 0?[0,0]:c,x=r.raisingHeight,M=x===void 0?0:x,O=r.heightfixed,B=O===void 0?!1:O;return this.rendererService.getDirty()&&this.texture.bind(),(0,X.Z)({u_raisingHeight:Number(M),u_heightfixed:Number(B),u_texture:this.texture,u_textSize:[1024,this.iconService.canvasHeight||128]},this.getStyleAttribute())}},{key:"initModels",value:function(){var n=(0,ur.Z)(it().mark(function a(){return it().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return this.iconService.on("imageUpdate",this.updateTexture),this.updateTexture(),c.abrupt("return",this.buildModels());case 3:case"end":return c.stop()}},a,this)}));function r(){return n.apply(this,arguments)}return r}()},{key:"clearModels",value:function(){var r;(r=this.texture)===null||r===void 0||r.destroy(),this.iconService.off("imageUpdate",this.updateTexture)}},{key:"buildModels",value:function(){var n=(0,ur.Z)(it().mark(function a(){var u;return it().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return g.next=2,this.layer.buildLayerModel({moduleName:"pointImage",vertexShader:zw,fragmentShader:Zw,triangulation:D3,inject:this.getInject(),depth:{enable:!1},primitive:je.POINTS});case 2:return u=g.sent,g.abrupt("return",[u]);case 4:case"end":return g.stop()}},a,this)}));function r(){return n.apply(this,arguments)}return r}()},{key:"registerBuiltinAttributes",value:function(){var r=this;this.styleAttributeService.registerStyleAttribute({name:"size",type:mn.Attribute,descriptor:{name:"a_Size",buffer:{usage:je.DYNAMIC_DRAW,data:[],type:je.FLOAT},size:1,update:function(u){var c=u.size,g=c===void 0?5:c;return Array.isArray(g)?[g[0]]:[g]}}}),this.styleAttributeService.registerStyleAttribute({name:"uv",type:mn.Attribute,descriptor:{name:"a_Uv",buffer:{usage:je.DYNAMIC_DRAW,data:[],type:je.FLOAT},size:2,update:function(u){var c=r.iconService.getIconMap(),g=u.shape,x=c[g]||{x:-64,y:-64},M=x.x,O=x.y;return[M,O]}}})}}]),t}(vo);function Uw(e){var i=Gw();return function(){var n=(0,ue.Z)(e),r;if(i){var a=(0,ue.Z)(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return(0,ze.Z)(this,r)}}function Gw(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var jw=`varying vec4 v_color;
void main() {
  gl_FragColor = v_color;
}
`,Vw=`
attribute vec3 a_Position;
uniform mat4 u_ModelMatrix;

attribute float a_Size;
attribute vec4 a_Color;

varying vec4 v_color;

#pragma include "projection"
#pragma include "project"

void main() {
  v_color = vec4(a_Color.xyz, a_Color.w * opacity);

  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    gl_Position = u_Mvp * vec4(a_Position.xy, a_Position.z, 1.0);
  } else {
    vec4 project_pos = project_position(vec4(a_Position, 1.0)) + vec4(a_Size / 2.,-a_Size /2.,0.,0.);
    gl_Position = project_common_position_to_clipspace(vec4(vec2(project_pos.xy),project_pos.z,project_pos.w));
  }

  gl_PointSize = a_Size * 2.0 * u_DevicePixelRatio;
}
`,wL=In.isNumber;function C1(e){var i=e.coordinates;return{vertices:(0,pr.Z)(i),indices:[0],size:i.length}}var w1=function(e){(0,Ne.Z)(t,e);var i=Uw(t);function t(){return(0,se.Z)(this,t),i.apply(this,arguments)}return(0,be.Z)(t,[{key:"getDefaultStyle",value:function(){return{blend:"additive"}}},{key:"getUninforms",value:function(){var r=this.layer.getLayerConfig(),a=r.opacity,u=a===void 0?1:a;return(0,X.Z)({},this.getStyleAttribute())}},{key:"initModels",value:function(){var n=(0,ur.Z)(it().mark(function a(){return it().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.abrupt("return",this.buildModels());case 1:case"end":return c.stop()}},a,this)}));function r(){return n.apply(this,arguments)}return r}()},{key:"buildModels",value:function(){var n=(0,ur.Z)(it().mark(function a(){var u;return it().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return this.layer.triangulation=C1,g.next=3,this.layer.buildLayerModel({moduleName:"pointNormal",vertexShader:Vw,fragmentShader:jw,triangulation:C1,inject:this.getInject(),depth:{enable:!1},primitive:je.POINTS,pick:!1});case 3:return u=g.sent,g.abrupt("return",[u]);case 5:case"end":return g.stop()}},a,this)}));function r(){return n.apply(this,arguments)}return r}()},{key:"clearModels",value:function(){}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"size",type:mn.Attribute,descriptor:{name:"a_Size",buffer:{usage:je.DYNAMIC_DRAW,data:[],type:je.FLOAT},size:1,update:function(a){var u=a.size,c=u===void 0?1:u;return Array.isArray(c)?[c[0]]:[c]}}})}}]),t}(vo);function Hw(e){var i=$w();return function(){var n=(0,ue.Z)(e),r;if(i){var a=(0,ue.Z)(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return(0,ze.Z)(this,r)}}function $w(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var Yw=`
uniform float u_additive;
uniform float u_opacity: 1.0;

varying vec4 v_data;
varying vec4 v_color;
varying float v_radius;
varying vec2 v_exteude;
#pragma include "sdf_2d"
#pragma include "picking"

void main() {

  lowp float antialiasblur = v_data.z;
  float r = v_radius / (v_radius);

  float outer_df = sdCircle(v_data.xy, 1.0);
  float inner_df = sdCircle(v_data.xy, r);

  float opacity_t = smoothstep(0.0, antialiasblur, outer_df);

  gl_FragColor = vec4(v_color.rgb, v_color.a * u_opacity);

  if(u_additive > 0.0) {
    gl_FragColor *= opacity_t;
  } else {
    gl_FragColor.a *= opacity_t;
  }

  if(gl_FragColor.a > 0.0) {
    gl_FragColor = filterColor(gl_FragColor);
  }

  vec2 extrude =  v_exteude;
  vec2 dir = normalize(extrude);
  vec2 baseDir = vec2(1.0, 0.0);
  float pi = 3.14159265359;
  float flag = sign(dir.y);
  float rades = dot(dir, baseDir);
  float radar_v = (flag - 1.0) * -0.5 * acos(rades)/pi;
  // simple AA
  if(radar_v > 0.99) {
    radar_v = 1.0 - (radar_v - 0.99)/0.01;
  }

  gl_FragColor.a *= radar_v;
}
`,Ww=`attribute vec4 a_Color;
attribute vec3 a_Position;
attribute vec3 a_Extrude;
attribute float a_Size;
uniform float u_speed: 1.0;
uniform float u_time;

uniform mat4 u_ModelMatrix;

uniform int u_size_unit;

varying vec4 v_data;
varying vec4 v_color;
varying float v_radius;
varying vec2 v_exteude;

#pragma include "projection"
#pragma include "picking"

void main() {
  vec3 extrude = a_Extrude;
  float newSize = setPickingSize(a_Size);

  float time = u_time * u_speed;
  mat2 rotateMatrix = mat2( 
    cos(time), sin(time), 
    -sin(time), cos(time)
  );
  v_exteude = rotateMatrix * a_Extrude.xy;

  // unpack color(vec2)
  v_color = a_Color;

  // anti-alias
  float blur = 0.0;
  float antialiasblur = -max(2.0 / u_DevicePixelRatio / a_Size, blur);

  if(u_size_unit == 1) {
    newSize = newSize  * u_PixelsPerMeter.z;
  }
  // radius(16-bit)
  v_radius = newSize;

  vec2 offset = (extrude.xy * (newSize));
  vec3 aPosition = a_Position;
  
    // \u4E0D\u4EE5\u7C73\u4E3A\u5B9E\u9645\u5355\u4F4D
  offset = project_pixel(offset);
  
  v_data = vec4(extrude.x, extrude.y, antialiasblur, -1.0);

  vec4 project_pos = project_position(vec4(aPosition.xy, 0.0, 1.0));
  gl_Position = project_common_position_to_clipspace_v2(vec4(project_pos.xy + offset, project_pixel(setPickingOrder(0.0)), 1.0));

  setPickingColor(a_PickingColor);
}
`,Xw=function(e){(0,Ne.Z)(t,e);var i=Hw(t);function t(){return(0,se.Z)(this,t),i.apply(this,arguments)}return(0,be.Z)(t,[{key:"getUninforms",value:function(){var r=this.layer.getLayerConfig(),a=r.opacity,u=a===void 0?1:a,c=r.blend,g=r.speed,x=g===void 0?1:g,M=r.unit,O=M===void 0?"pixel":M;return{u_size_unit:gg[O],u_speed:x,u_additive:c==="additive"?1:0,u_opacity:u}}},{key:"getAnimateUniforms",value:function(){var r=this.layer.getLayerConfig(),a=r.animateOption,u=a===void 0?{enable:!1}:a;return{u_animate:this.animateOption2Array(u),u_time:this.layer.getLayerAnimateTime()}}},{key:"getAttribute",value:function(){return this.styleAttributeService.createAttributesAndIndices(this.layer.getEncodedData(),Dd)}},{key:"initModels",value:function(){var n=(0,ur.Z)(it().mark(function a(){return it().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.abrupt("return",this.buildModels());case 1:case"end":return c.stop()}},a,this)}));function r(){return n.apply(this,arguments)}return r}()},{key:"buildModels",value:function(){var n=(0,ur.Z)(it().mark(function a(){var u;return it().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return g.next=2,this.layer.buildLayerModel({moduleName:"pointRadar",vertexShader:Ww,fragmentShader:Yw,triangulation:Dd,depth:{enable:!1}});case 2:return u=g.sent,g.abrupt("return",[u]);case 4:case"end":return g.stop()}},a,this)}));function r(){return n.apply(this,arguments)}return r}()},{key:"animateOption2Array",value:function(r){return[r.enable?0:1,r.speed||1,r.rings||3,0]}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"extrude",type:mn.Attribute,descriptor:{name:"a_Extrude",buffer:{usage:je.DYNAMIC_DRAW,data:[],type:je.FLOAT},size:3,update:function(a,u,c,g){var x=[1,1,0,-1,1,0,-1,-1,0,1,-1,0],M=g%4*3;return[x[M],x[M+1],x[M+2]]}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:mn.Attribute,descriptor:{name:"a_Size",buffer:{usage:je.DYNAMIC_DRAW,data:[],type:je.FLOAT},size:1,update:function(a){var u=a.size,c=u===void 0?5:u;return Array.isArray(c)?[c[0]]:[c]}}})}}]),t}(vo);function Qw(e,i){var t=typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=qw(e))||i&&e&&typeof e.length=="number"){t&&(e=t);var n=0,r=function(){};return{s:r,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(x){throw x},f:r}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var a=!0,u=!1,c;return{s:function(){t=t.call(e)},n:function(){var x=t.next();return a=x.done,x},e:function(x){u=!0,c=x},f:function(){try{!a&&t.return!=null&&t.return()}finally{if(u)throw c}}}}function qw(e,i){if(e){if(typeof e=="string")return T1(e,i);var t=Object.prototype.toString.call(e).slice(8,-1);if(t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set")return Array.from(e);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return T1(e,i)}}function T1(e,i){(i==null||i>e.length)&&(i=e.length);for(var t=0,n=new Array(i);t<i;t++)n[t]=e[t];return n}var Kw=function(){function e(i,t,n){(0,se.Z)(this,e),(0,Me.Z)(this,"boxCells",[]);var r=this.boxCells;this.xCellCount=Math.ceil(i/n),this.yCellCount=Math.ceil(t/n);for(var a=0;a<this.xCellCount*this.yCellCount;a++)r.push([]);this.boxKeys=[],this.bboxes=[],this.width=i,this.height=t,this.xScale=this.xCellCount/i,this.yScale=this.yCellCount/t,this.boxUid=0}return(0,be.Z)(e,[{key:"insert",value:function(t,n,r,a,u){this.forEachCell(n,r,a,u,this.insertBoxCell,this.boxUid++),this.boxKeys.push(t),this.bboxes.push(n),this.bboxes.push(r),this.bboxes.push(a),this.bboxes.push(u)}},{key:"query",value:function(t,n,r,a,u){return this.queryHitTest(t,n,r,a,!1,u)}},{key:"hitTest",value:function(t,n,r,a,u){return this.queryHitTest(t,n,r,a,!0,u)}},{key:"insertBoxCell",value:function(t,n,r,a,u,c){this.boxCells[u].push(c)}},{key:"queryHitTest",value:function(t,n,r,a,u,c){if(r<0||t>this.width||a<0||n>this.height)return u?!1:[];var g=[];if(t<=0&&n<=0&&this.width<=r&&this.height<=a){if(u)return!0;for(var x=0;x<this.boxKeys.length;x++)g.push({key:this.boxKeys[x],x1:this.bboxes[x*4],y1:this.bboxes[x*4+1],x2:this.bboxes[x*4+2],y2:this.bboxes[x*4+3]});return c?g.filter(c):g}var M={hitTest:u,seenUids:{box:{},circle:{}}};return this.forEachCell(t,n,r,a,this.queryCell,g,M,c),u?g.length>0:g}},{key:"queryCell",value:function(t,n,r,a,u,c,g,x){var M=g.seenUids,O=this.boxCells[u];if(O!==null){var B=this.bboxes,W=Qw(O),ce;try{for(W.s();!(ce=W.n()).done;){var oe=ce.value;if(!M.box[oe]){M.box[oe]=!0;var Te=oe*4;if(t<=B[Te+2]&&n<=B[Te+3]&&r>=B[Te+0]&&a>=B[Te+1]&&(!x||x(this.boxKeys[oe]))){if(g.hitTest)return c.push(!0),!0;c.push({key:this.boxKeys[oe],x1:B[Te],y1:B[Te+1],x2:B[Te+2],y2:B[Te+3]})}}}}catch(Ze){W.e(Ze)}finally{W.f()}}return!1}},{key:"forEachCell",value:function(t,n,r,a,u,c,g,x){for(var M=this.convertToXCellCoord(t),O=this.convertToYCellCoord(n),B=this.convertToXCellCoord(r),W=this.convertToYCellCoord(a),ce=M;ce<=B;ce++)for(var oe=O;oe<=W;oe++){var Te=this.xCellCount*oe+ce;if(u.call(this,t,n,r,a,Te,c,g,x))return}}},{key:"convertToXCellCoord",value:function(t){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(t*this.xScale)))}},{key:"convertToYCellCoord",value:function(t){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(t*this.yScale)))}}]),e}(),Jw=Kw,e4=function(){function e(i,t){(0,se.Z)(this,e),(0,Me.Z)(this,"viewportPadding",100),this.width=i,this.height=t,this.viewportPadding=Math.max(i,t),this.grid=new Jw(i+this.viewportPadding,t+this.viewportPadding,25),this.screenRightBoundary=i+this.viewportPadding,this.screenBottomBoundary=t+this.viewportPadding,this.gridRightBoundary=i+2*this.viewportPadding,this.gridBottomBoundary=t+2*this.viewportPadding}return(0,be.Z)(e,[{key:"placeCollisionBox",value:function(t){var n=t.x1+t.anchorPointX+this.viewportPadding,r=t.y1+t.anchorPointY+this.viewportPadding,a=t.x2+t.anchorPointX+this.viewportPadding,u=t.y2+t.anchorPointY+this.viewportPadding;return!this.isInsideGrid(n,r,a,u)||this.grid.hitTest(n,r,a,u)?{box:[]}:{box:[n,r,a,u]}}},{key:"insertCollisionBox",value:function(t,n){var r={featureIndex:n};this.grid.insert(r,t[0],t[1],t[2],t[3])}},{key:"project",value:function(t,n,r){var a=Bh(n,r,0,1),u=Fh(),c=Q0.apply(L,(0,pr.Z)(t));return nh(u,a,c),{x:(u[0]/u[3]+1)/2*this.width+this.viewportPadding,y:(-u[1]/u[3]+1)/2*this.height+this.viewportPadding}}},{key:"isInsideGrid",value:function(t,n,r,a){return r>=0&&t<this.gridRightBoundary&&a>=0&&n<this.gridBottomBoundary}}]),e}();function M1(e,i){var t=typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=t4(e))||i&&e&&typeof e.length=="number"){t&&(e=t);var n=0,r=function(){};return{s:r,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(x){throw x},f:r}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var a=!0,u=!1,c;return{s:function(){t=t.call(e)},n:function(){var x=t.next();return a=x.done,x},e:function(x){u=!0,c=x},f:function(){try{!a&&t.return!=null&&t.return()}finally{if(u)throw c}}}}function t4(e,i){if(e){if(typeof e=="string")return I1(e,i);var t=Object.prototype.toString.call(e).slice(8,-1);if(t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set")return Array.from(e);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return I1(e,i)}}function I1(e,i){(i==null||i>e.length)&&(i=e.length);for(var t=0,n=new Array(i);t<i;t++)n[t]=e[t];return n}function P1(e){var i=.5,t=.5;switch(e){case"right":case"top-right":case"bottom-right":i=1;break;case"left":case"top-left":case"bottom-left":i=0;break;default:i=.5}switch(e){case"bottom":case"bottom-right":case"bottom-left":t=1;break;case"top":case"top-right":case"top-left":t=0;break;default:t=.5}return{horizontalAlign:i,verticalAlign:t}}function L1(e,i,t,n,r){if(r){var a=e[n],u=a.glyph;if(u)for(var c=i[u].advance*a.scale,g=(e[n].x+c)*r,x=t;x<=n;x++)e[x].x-=g}}function O1(e,i,t,n,r,a,u){var c=(i-t)*r,g=(-n*u+.5)*a,x=M1(e),M;try{for(x.s();!(M=x.n()).done;){var O=M.value;O.x+=c,O.y+=g}}catch(B){x.e(B)}finally{x.f()}}function r4(e,i,t,n,r,a,u){var c=-8,g=0,x=c,M=0,O=e.positionedGlyphs,B=a==="right"?1:a==="left"?0:.5,W=O.length;t.forEach(function(qe){if(qe.split("").forEach(function(yt){var bt=i[yt],Ot=0;bt&&(O.push({glyph:yt,x:g,y:x+Ot,vertical:!1,scale:1,metrics:bt}),g+=bt.advance+u)}),O.length!==W){var et=g-u;M=Math.max(et,M),L1(O,i,W,O.length-1,B)}g=0,x-=n+5});var ce=P1(r),oe=ce.horizontalAlign,Te=ce.verticalAlign;O1(O,B,oe,Te,M,n,t.length);var Ze=x-c;e.top+=-Te*Ze,e.bottom=e.top-Ze,e.left+=-oe*M,e.right=e.left+M}function n4(e,i,t,n,r,a,u){var c=-8,g=0,x=c,M=0,O=e.positionedGlyphs,B=a==="right"?1:a==="left"?0:.5,W=O.length;t.forEach(function(qe){var et=i[qe],yt=0;if(et&&(O.push({glyph:qe,x:et.advance/2,y:x+yt,vertical:!1,scale:1,metrics:et}),g+=et.advance+u),O.length!==W){var bt=g-u;M=Math.max(bt,M),L1(O,i,W,O.length-1,B)}g=0,x-=n+5});var ce=P1(r),oe=ce.horizontalAlign,Te=ce.verticalAlign;O1(O,B,oe,Te,M,n,t.length);var Ze=x-c;e.top+=-Te*Ze,e.bottom=e.top-Ze,e.left+=-oe*M,e.right=e.left+M}function i4(e,i,t,n,r,a){var u=arguments.length>6&&arguments[6]!==void 0?arguments[6]:[0,0],c=arguments.length>7?arguments[7]:void 0,g=e.split(`
`),x=[],M={positionedGlyphs:x,top:u[1],bottom:u[1],left:u[0],right:u[0],lineCount:g.length,text:e};return c?n4(M,i,g,t,n,r,a):r4(M,i,g,t,n,r,a),x.length?M:!1}function a4(e){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[0,0],t=arguments.length>2?arguments[2]:void 0,n=e.positionedGlyphs,r=n===void 0?[]:n,a=[],u=M1(r),c;try{for(u.s();!(c=u.n()).done;){var g=c.value,x=g.metrics,M=4,O=x.advance*g.scale/2,B=t?[g.x+O,g.y]:[0,0],W=t?[0,0]:[g.x+O+i[0],g.y+i[1]],ce=(0-M)*g.scale-O+W[0],oe=(0-M)*g.scale+W[1],Te=ce+x.width*g.scale,Ze=oe+x.height*g.scale,qe={x:ce,y:oe},et={x:Te,y:oe},yt={x:ce,y:Ze},bt={x:Te,y:Ze};a.push({tl:qe,tr:et,bl:yt,br:bt,tex:x,glyphOffset:B})}}catch(Ot){u.e(Ot)}finally{u.f()}return a}function o4(e,i){var t=typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=s4(e))||i&&e&&typeof e.length=="number"){t&&(e=t);var n=0,r=function(){};return{s:r,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(x){throw x},f:r}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var a=!0,u=!1,c;return{s:function(){t=t.call(e)},n:function(){var x=t.next();return a=x.done,x},e:function(x){u=!0,c=x},f:function(){try{!a&&t.return!=null&&t.return()}finally{if(u)throw c}}}}function s4(e,i){if(e){if(typeof e=="string")return R1(e,i);var t=Object.prototype.toString.call(e).slice(8,-1);if(t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set")return Array.from(e);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return R1(e,i)}}function R1(e,i){(i==null||i>e.length)&&(i=e.length);for(var t=0,n=new Array(i);t<i;t++)n[t]=e[t];return n}function u4(e){var i=l4();return function(){var n=(0,ue.Z)(e),r;if(i){var a=(0,ue.Z)(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return(0,ze.Z)(this,r)}}function l4(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var D1=`#define SDF_PX 8.0
#define EDGE_GAMMA 0.105
#define FONT_SIZE 48.0
uniform sampler2D u_sdf_map;
uniform float u_gamma_scale : 0.5;
uniform float u_stroke_width : 2.0;
uniform float u_halo_blur : 0.5;
uniform float u_DevicePixelRatio;

varying vec4 v_color;
varying vec4 v_stroke_color;
varying vec2 v_uv;
varying float v_gamma_scale;
varying float v_fontScale;


#pragma include "picking"
void main() {
  // get style data mapping

  // get sdf from atlas
  float dist = texture2D(u_sdf_map, v_uv).a;

  lowp float buff = (6.0 - u_stroke_width / v_fontScale) / SDF_PX;
  highp float gamma = (u_halo_blur * 1.19 / SDF_PX + EDGE_GAMMA) / (v_fontScale * u_gamma_scale) / 1.0;

  highp float gamma_scaled = gamma * v_gamma_scale;

  highp float alpha = smoothstep(buff - gamma_scaled, buff + gamma_scaled, dist);

  gl_FragColor = mix(v_color, v_stroke_color, smoothstep(0., 0.5, 1.- dist));

  gl_FragColor.a *= alpha;
   // \u4F5C\u4E3A mask \u6A21\u677F\u65F6\u9700\u8981\u4E22\u5F03\u900F\u660E\u7684\u50CF\u7D20
  if (gl_FragColor.a < 0.01) {
    discard;
  }
  gl_FragColor = filterColor(gl_FragColor);
}
`,k1=`#define SDF_PX 8.0
#define EDGE_GAMMA 0.105
#define FONT_SIZE 24.0
attribute vec3 a_Position;
attribute vec2 a_tex;
attribute vec2 a_textOffsets;
attribute vec4 a_Color;
attribute float a_Size;

uniform vec2 u_sdf_map_size;
uniform mat4 u_ModelMatrix;

uniform float u_raisingHeight: 0.0;

varying vec2 v_uv;
varying float v_gamma_scale;
varying vec4 v_color;
varying vec4 v_stroke_color;
varying float v_fontScale;
uniform float u_stroke_width : 2;
uniform vec4 u_stroke_color : [0.0, 0.0, 0.0, 0.0];



#pragma include "projection"
#pragma include "picking"
#pragma include "rotation_2d"

void main() {
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
  
  v_uv = a_tex / u_sdf_map_size;



  v_color = vec4(a_Color.xyz, a_Color.w * opacity);
  v_stroke_color = vec4(u_stroke_color.xyz, u_stroke_color.w * opacity);

  // \u6587\u672C\u7F29\u653E\u6BD4\u4F8B
  float fontScale = a_Size / FONT_SIZE;
  v_fontScale = fontScale;

  vec4 project_pos = project_position(vec4(a_Position, 1.0));
  // vec4 projected_position  = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));

  vec2 offset = rotate_matrix(a_textOffsets,rotation);
  
  // gl_Position = vec4(projected_position.xy / projected_position.w + rotation_matrix * a_textOffsets * fontScale / u_ViewportSize * 2.0 * u_DevicePixelRatio, 0.0, 1.0);

  float raiseHeight = u_raisingHeight;
  if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
    float mapboxZoomScale = 4.0/pow(2.0, 21.0 - u_Zoom);
    raiseHeight = u_raisingHeight * mapboxZoomScale;
  }

  vec4 projected_position = project_common_position_to_clipspace_v2(vec4(project_pos.xyz + vec3(0.0, 0.0, raiseHeight), 1.0));

  gl_Position = vec4(
    projected_position.xy / projected_position.w + offset * fontScale / u_ViewportSize * 2.0 * u_DevicePixelRatio, 0.0, 1.0);
  v_gamma_scale = gl_Position.w;
  setPickingColor(a_PickingColor);

}
`,vp=In.isEqual;function N1(e){var i=this,t=e.id,n=[],r=[];if(!i.glyphInfoMap||!i.glyphInfoMap[t])return{vertices:[],indices:[],size:7};var a=i.glyphInfoMap[t].centroid,u=a.length===2?[a[0],a[1],0]:a;return i.glyphInfoMap[t].glyphQuads.forEach(function(c,g){n.push.apply(n,(0,pr.Z)(u).concat([c.tex.x,c.tex.y+c.tex.height,c.tl.x,c.tl.y],(0,pr.Z)(u),[c.tex.x+c.tex.width,c.tex.y+c.tex.height,c.tr.x,c.tr.y],(0,pr.Z)(u),[c.tex.x+c.tex.width,c.tex.y,c.br.x,c.br.y],(0,pr.Z)(u),[c.tex.x,c.tex.y,c.bl.x,c.bl.y])),r.push(0+g*4,1+g*4,2+g*4,2+g*4,3+g*4,0+g*4)}),{vertices:n,indices:r,size:7}}var F1=function(e){(0,Ne.Z)(t,e);var i=u4(t);function t(){var n;(0,se.Z)(this,t);for(var r=arguments.length,a=new Array(r),u=0;u<r;u++)a[u]=arguments[u];return n=i.call.apply(i,[this].concat(a)),(0,Me.Z)((0,xt.Z)(n),"glyphInfoMap",{}),(0,Me.Z)((0,xt.Z)(n),"currentZoom",-1),(0,Me.Z)((0,xt.Z)(n),"textureHeight",0),(0,Me.Z)((0,xt.Z)(n),"textCount",0),(0,Me.Z)((0,xt.Z)(n),"preTextStyle",{}),(0,Me.Z)((0,xt.Z)(n),"mapping",(0,ur.Z)(it().mark(function c(){return it().wrap(function(x){for(;;)switch(x.prev=x.next){case 0:return n.initGlyph(),n.updateTexture(),x.next=4,n.reBuildModel();case 4:case"end":return x.stop()}},c)}))),n}return(0,be.Z)(t,[{key:"getUninforms",value:function(){var r=this.layer.getLayerConfig(),a=r.stroke,u=a===void 0?"#fff":a,c=r.strokeWidth,g=c===void 0?0:c,x=r.halo,M=x===void 0?.5:x,O=r.gamma,B=O===void 0?2:O,W=r.raisingHeight,ce=W===void 0?0:W,oe=this.getFontServiceMapping(),Te=this.getFontServiceCanvas();return oe&&Object.keys(oe).length!==this.textCount&&Te&&(this.updateTexture(),this.textCount=Object.keys(oe).length),this.preTextStyle=this.getTextStyle(),(0,X.Z)({u_raisingHeight:Number(ce),u_stroke_width:g,u_stroke_color:Ni(u),u_sdf_map:this.texture,u_halo_blur:M,u_gamma_scale:B,u_sdf_map_size:[(Te==null?void 0:Te.width)||1,(Te==null?void 0:Te.height)||1]},this.getStyleAttribute())}},{key:"initModels",value:function(){var n=(0,ur.Z)(it().mark(function a(){return it().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return this.bindEvent(),this.extent=this.textExtent(),this.rawEncodeData=this.layer.getEncodedData(),this.preTextStyle=this.getTextStyle(),c.abrupt("return",this.buildModels());case 5:case"end":return c.stop()}},a,this)}));function r(){return n.apply(this,arguments)}return r}()},{key:"buildModels",value:function(){var n=(0,ur.Z)(it().mark(function a(){var u,c,g,x;return it().wrap(function(O){for(;;)switch(O.prev=O.next){case 0:return u=this.layer.getLayerConfig(),c=u.textAllowOverlap,g=c===void 0?!1:c,this.initGlyph(),this.updateTexture(),g||this.filterGlyphs(),O.next=6,this.layer.buildLayerModel({moduleName:"pointText",vertexShader:k1,fragmentShader:D1,inject:this.getInject(),triangulation:N1.bind(this),depth:{enable:!1}});case 6:return x=O.sent,O.abrupt("return",[x]);case 8:case"end":return O.stop()}},a,this)}));function r(){return n.apply(this,arguments)}return r}()},{key:"needUpdate",value:function(){var n=(0,ur.Z)(it().mark(function a(){var u,c,g,x,M,O,B,W,ce,oe,Te,Ze;return it().wrap(function(et){for(;;)switch(et.prev=et.next){case 0:if(u=this.getTextStyle(),c=u.textAllowOverlap,g=c===void 0?!1:c,x=u.textAnchor,M=x===void 0?"center":x,O=u.textOffset,B=u.padding,W=u.fontFamily,ce=u.fontWeight,!(!vp(B,this.preTextStyle.padding)||!vp(O,this.preTextStyle.textOffset)||!vp(M,this.preTextStyle.textAnchor)||!vp(W,this.preTextStyle.fontFamily)||!vp(ce,this.preTextStyle.fontWeight))){et.next=5;break}return et.next=4,this.mapping();case 4:return et.abrupt("return",!0);case 5:if(!g){et.next=7;break}return et.abrupt("return",!1);case 7:if(oe=this.mapService.getZoom(),Te=this.mapService.getBounds(),Ze=Zr(this.extent,Te),!(Math.abs(this.currentZoom-oe)>.5||!Ze||g!==this.preTextStyle.textAllowOverlap)){et.next=14;break}return et.next=13,this.reBuildModel();case 13:return et.abrupt("return",!0);case 14:return et.abrupt("return",!1);case 15:case"end":return et.stop()}},a,this)}));function r(){return n.apply(this,arguments)}return r}()},{key:"clearModels",value:function(){var r;(r=this.texture)===null||r===void 0||r.destroy(),this.layer.off("remapping",this.mapping)}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"textOffsets",type:mn.Attribute,descriptor:{name:"a_textOffsets",buffer:{usage:je.STATIC_DRAW,data:[],type:je.FLOAT},size:2,update:function(a,u,c){return[c[5],c[6]]}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:mn.Attribute,descriptor:{name:"a_Size",buffer:{usage:je.DYNAMIC_DRAW,data:[],type:je.FLOAT},size:1,update:function(a){var u=a.size,c=u===void 0?12:u;return Array.isArray(c)?[c[0]]:[c]}}}),this.styleAttributeService.registerStyleAttribute({name:"textUv",type:mn.Attribute,descriptor:{name:"a_tex",buffer:{usage:je.DYNAMIC_DRAW,data:[],type:je.FLOAT},size:2,update:function(a,u,c){return[c[3],c[4]]}}})}},{key:"bindEvent",value:function(){this.layer.isTileLayer||this.layer.on("remapping",this.mapping)}},{key:"textExtent",value:function(){var r=this.mapService.getBounds();return js(r,.5)}},{key:"initTextFont",value:function(){var r=this.getTextStyle(),a=r.fontWeight,u=r.fontFamily,c=this.rawEncodeData,g=[];c.forEach(function(x){var M=x.shape,O=M===void 0?"":M;O=O.toString();var B=o4(O),W;try{for(B.s();!(W=B.n()).done;){var ce=W.value;g.indexOf(ce)===-1&&g.push(ce)}}catch(oe){B.e(oe)}finally{B.f()}}),this.fontService.setFontOptions({characterSet:g,fontWeight:a,fontFamily:u,iconfont:!1})}},{key:"initIconFontTex",value:function(){var r=this.getTextStyle(),a=r.fontWeight,u=r.fontFamily,c=this.rawEncodeData,g=[];c.forEach(function(x){var M=x.shape,O=M===void 0?"":M;O="".concat(O),g.indexOf(O)===-1&&g.push(O)}),this.fontService.setFontOptions({characterSet:g,fontWeight:a,fontFamily:u,iconfont:!0})}},{key:"getTextStyle",value:function(){var r=this.layer.getLayerConfig(),a=r.fontWeight,u=a===void 0?"400":a,c=r.fontFamily,g=c===void 0?"sans-serif":c,x=r.textAllowOverlap,M=x===void 0?!1:x,O=r.padding,B=O===void 0?[0,0]:O,W=r.textAnchor,ce=W===void 0?"center":W,oe=r.textOffset,Te=oe===void 0?[0,0]:oe,Ze=r.opacity,qe=Ze===void 0?1:Ze,et=r.strokeOpacity,yt=et===void 0?1:et,bt=r.strokeWidth,Ot=bt===void 0?0:bt,jt=r.stroke,or=jt===void 0?"#000":jt;return{fontWeight:u,fontFamily:g,textAllowOverlap:M,padding:B,textAnchor:ce,textOffset:Te,opacity:qe,strokeOpacity:yt,strokeWidth:Ot,stroke:or}}},{key:"generateGlyphLayout",value:function(r){var a=this,u=this.getFontServiceMapping(),c=this.layer.getLayerConfig(),g=c.spacing,x=g===void 0?2:g,M=c.textAnchor,O=M===void 0?"center":M,B=c.textOffset,W=this.rawEncodeData;this.glyphInfo=W.map(function(ce){var oe=ce.shape,Te=oe===void 0?"":oe,Ze=ce.id,qe=ce.size,et=qe===void 0?1:qe,yt=ce.textOffset?ce.textOffset:B||[0,0],bt=ce.textAnchor?ce.textAnchor:O||"center",Ot=i4(Te.toString(),u,et,bt,"left",x,yt,r),jt=a4(Ot,yt,!1);return ce.shaping=Ot,ce.glyphQuads=jt,ce.centroid=Is(ce.coordinates),ce.originCentroid=ce.version==="GAODE2.x"?Is(ce.originCoordinates):ce.originCentroid=ce.centroid,a.glyphInfoMap[Ze]={shaping:Ot,glyphQuads:jt,centroid:Is(ce.coordinates)},ce})}},{key:"getFontServiceMapping",value:function(){var r=this.layer.getLayerConfig(),a=r.fontWeight,u=a===void 0?"400":a,c=r.fontFamily,g=c===void 0?"sans-serif":c;return this.fontService.getMappingByKey("".concat(g,"_").concat(u))}},{key:"getFontServiceCanvas",value:function(){var r=this.layer.getLayerConfig(),a=r.fontWeight,u=a===void 0?"400":a,c=r.fontFamily,g=c===void 0?"sans-serif":c;return this.fontService.getCanvasByKey("".concat(g,"_").concat(u))}},{key:"filterGlyphs",value:function(){var r=this,a=this.layer.getLayerConfig(),u=a.padding,c=u===void 0?[0,0]:u,g=a.textAllowOverlap,x=g===void 0?!1:g;if(!x){this.glyphInfoMap={},this.currentZoom=this.mapService.getZoom(),this.extent=this.textExtent();var M=this.rendererService.getViewportSize(),O=M.width,B=M.height,W=new e4(O,B),ce=this.glyphInfo.filter(function(oe){var Te=oe.shaping,Ze=oe.id,qe=Ze===void 0?0:Ze,et=oe.version==="GAODE2.x"?oe.originCentroid:oe.centroid,yt=oe.size,bt=yt/16,Ot=r.mapService.lngLatToContainer(et),jt=W.placeCollisionBox({x1:Te.left*bt-c[0],x2:Te.right*bt+c[0],y1:Te.top*bt-c[1],y2:Te.bottom*bt+c[1],anchorPointX:Ot.x,anchorPointY:Ot.y}),or=jt.box;return or&&or.length?(W.insertCollisionBox(or,qe),!0):!1});ce.forEach(function(oe){r.glyphInfoMap[oe.id]=oe})}}},{key:"initGlyph",value:function(){var r=this.layer.getLayerConfig(),a=r.iconfont,u=a===void 0?!1:a;u?this.initIconFontTex():this.initTextFont(),this.generateGlyphLayout(u)}},{key:"updateTexture",value:function(){var r=this.rendererService.createTexture2D,a=this.getFontServiceCanvas();this.textureHeight=a.height,this.texture&&this.texture.destroy(),this.texture=r({data:a,mag:je.LINEAR,min:je.LINEAR,width:a.width,height:a.height})}},{key:"reBuildModel",value:function(){var n=(0,ur.Z)(it().mark(function a(){var u;return it().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return this.filterGlyphs(),g.next=3,this.layer.buildLayerModel({moduleName:"pointText",vertexShader:k1,fragmentShader:D1,triangulation:N1.bind(this),inject:this.getInject(),depth:{enable:!1}});case 3:u=g.sent,this.layer.models=[u];case 5:case"end":return g.stop()}},a,this)}));function r(){return n.apply(this,arguments)}return r}()}]),t}(vo),c4={fillImage:Nw,fill:b1,radar:Xw,image:S1,normal:w1,simplePoint:Aw,extrude:x1,text:F1,earthFill:Sw,earthExtrude:yw},f4=c4;function h4(e,i){var t=typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=A4(e))||i&&e&&typeof e.length=="number"){t&&(e=t);var n=0,r=function(){};return{s:r,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(x){throw x},f:r}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var a=!0,u=!1,c;return{s:function(){t=t.call(e)},n:function(){var x=t.next();return a=x.done,x},e:function(x){u=!0,c=x},f:function(){try{!a&&t.return!=null&&t.return()}finally{if(u)throw c}}}}function A4(e,i){if(e){if(typeof e=="string")return B1(e,i);var t=Object.prototype.toString.call(e).slice(8,-1);if(t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set")return Array.from(e);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return B1(e,i)}}function B1(e,i){(i==null||i>e.length)&&(i=e.length);for(var t=0,n=new Array(i);t<i;t++)n[t]=e[t];return n}function p4(e){var i=d4();return function(){var n=(0,ue.Z)(e),r;if(i){var a=(0,ue.Z)(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return(0,ze.Z)(this,r)}}function d4(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var Zd=function(e){(0,Ne.Z)(t,e);var i=p4(t);function t(){var n;(0,se.Z)(this,t);for(var r=arguments.length,a=new Array(r),u=0;u<r;u++)a[u]=arguments[u];return n=i.call.apply(i,[this].concat(a)),(0,Me.Z)((0,xt.Z)(n),"type","PointLayer"),(0,Me.Z)((0,xt.Z)(n),"enableShaderEncodeStyles",["opacity","offsets","stroke","rotation"]),(0,Me.Z)((0,xt.Z)(n),"enableDataEncodeStyles",["textOffset","textAnchor"]),(0,Me.Z)((0,xt.Z)(n),"defaultSourceConfig",{data:[],options:{parser:{type:"json",x:"lng",y:"lat"}}}),n}return(0,be.Z)(t,[{key:"buildModels",value:function(){var n=(0,ur.Z)(it().mark(function a(){var u;return it().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return u=this.getModelType(),this.layerModel&&this.layerModel.clearModels(),this.layerModel=new f4[u](this),g.next=5,this.initLayerModels();case 5:case"end":return g.stop()}},a,this)}));function r(){return n.apply(this,arguments)}return r}()},{key:"rebuildModels",value:function(){var n=(0,ur.Z)(it().mark(function a(){return it().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.next=2,this.buildModels();case 2:case"end":return c.stop()}},a,this)}));function r(){return n.apply(this,arguments)}return r}()},{key:"getModelTypeWillEmptyData",value:function(){if(this.shapeOption){var r=this.shapeOption,a=r.field,u=r.values,c=this.getLayerConfig(),g=c.shape2d,x=this.iconService.getIconMap();if(a&&(g==null?void 0:g.indexOf(a))!==-1)return"fill";if(u==="text")return"text";if(u&&u instanceof Array){var M=h4(u),O;try{for(M.s();!(O=M.n()).done;){var B=O.value;if(typeof B=="string"&&x.hasOwnProperty(B))return"image"}}catch(W){M.e(W)}finally{M.f()}}}return"normal"}},{key:"getDefaultConfig",value:function(){var r=this.getModelType(),a={fillImage:{},normal:{blend:"additive"},radar:{},simplePoint:{},fill:{blend:"normal"},extrude:{},image:{},text:{blend:"normal"},tile:{},tileText:{},earthFill:{},earthExtrude:{}};return a[r]}},{key:"getModelType",value:function(){var r=this.getEncodedData(),a=this.getLayerConfig(),u=a.shape2d,c=a.shape3d,g=a.billboard,x=g===void 0?!0:g,M=this.iconService.getIconMap(),O=r.find(function(W){return W.hasOwnProperty("shape")});if(O){var B=O.shape;return B==="dot"?"normal":B==="simple"?"simplePoint":B==="radar"?"radar":this.layerType==="fillImage"||x===!1?"fillImage":(u==null?void 0:u.indexOf(B))!==-1?this.mapService.version==="GLOBEL"?"earthFill":"fill":(c==null?void 0:c.indexOf(B))!==-1?this.mapService.version==="GLOBEL"?"earthExtrude":"extrude":M.hasOwnProperty(B)?"image":"text"}else return this.getModelTypeWillEmptyData()}}]),t}(iA);function v4(e){var i=g4();return function(){var n=(0,ue.Z)(e),r;if(i){var a=(0,ue.Z)(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return(0,ze.Z)(this,r)}}function g4(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var m4=`uniform vec4 u_sourceColor;
uniform vec4 u_targetColor;
uniform float u_linearColor: 0;

uniform float u_topsurface: 1.0;
uniform float u_sidesurface: 1.0;

varying vec4 v_Color;

#pragma include "picking"

void main() {


     // top face
    if(u_topsurface < 1.0) {
      discard;
    }

    gl_FragColor = v_Color;
  

  gl_FragColor = filterColor(gl_FragColor);
}
`,y4=`precision highp float;

#define ambientRatio 0.5
#define diffuseRatio 0.3
#define specularRatio 0.2

attribute vec4 a_Color;
attribute vec3 a_Position;
attribute vec3 a_Normal;
attribute float a_Size;
attribute vec3 a_uvs;
uniform mat4 u_ModelMatrix;

uniform vec4 u_sourceColor;
uniform vec4 u_targetColor;
uniform float u_linearColor: 0;

uniform float u_topsurface: 1.0;
uniform float u_sidesurface: 1.0;

varying vec4 v_Color;
uniform float u_heightfixed: 0.0; // \u9ED8\u8BA4\u4E0D\u56FA\u5B9A
uniform float u_raisingHeight: 0.0;

#pragma include "projection"
#pragma include "light"
#pragma include "picking"

void main() {
 
  float isSide = a_Position.z;
 float topU = a_uvs[0];
 float topV = 1.0 - a_uvs[1];
 float sidey = a_uvs[2];

  vec4 pos = vec4(a_Position.xy, a_Position.z * a_Size, 1.0);
  float lightWeight = calc_lighting(pos);

  vec4 project_pos = project_position(pos);

  if(u_heightfixed > 0.0) { // \u5224\u65AD\u51E0\u4F55\u4F53\u662F\u5426\u56FA\u5B9A\u9AD8\u5EA6
    project_pos.z = a_Position.z * a_Size;
    project_pos.z += u_raisingHeight;

    if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
      float mapboxZoomScale = 4.0/pow(2.0, 21.0 - u_Zoom);
      project_pos.z *= mapboxZoomScale;
      project_pos.z += u_raisingHeight * mapboxZoomScale;
    }
  }


 gl_Position = project_common_position_to_clipspace_v2(vec4(project_pos.xyz, 1.0));

  // Tip: \u90E8\u5206\u673A\u578B GPU \u8BA1\u7B97\u7CBE\u5EA6\u517C\u5BB9
  if(isSide < 0.999) {
    // side face
    // if(u_sidesurface < 1.0) {
    //   discard;
    // }

    if(u_linearColor == 1.0) {
      vec4 linearColor = mix(u_targetColor, u_sourceColor, sidey);
      linearColor.rgb *= lightWeight;
      v_Color = linearColor;
    } else {
      v_Color = a_Color;
    }

  } else {
    v_Color = a_Color;
  }

  v_Color = vec4(v_Color.rgb * lightWeight, v_Color.w * opacity);


  setPickingColor(a_PickingColor);
}
`,_4=`uniform sampler2D u_texture;
uniform float u_opacity: 1.0;
uniform vec4 u_sourceColor;
uniform vec4 u_targetColor;
uniform float u_linearColor: 0;

uniform float u_topsurface: 1.0;
uniform float u_sidesurface: 1.0;

varying vec4 v_Color;
varying vec3 v_uvs;
varying vec2 v_texture_data;


#pragma include "picking"

void main() {
  float opacity = u_opacity;
  float isSide = v_texture_data.x;
  float lightWeight = v_texture_data.y;
  float topU = v_uvs[0];
  float topV = 1.0 - v_uvs[1];
  float sidey = v_uvs[2];
  // Tip: \u90E8\u5206\u673A\u578B GPU \u8BA1\u7B97\u7CBE\u5EA6\u517C\u5BB9
  if(isSide < 0.999) {// \u662F\u5426\u662F\u8FB9\u7F18
    // side face
    if(u_sidesurface < 1.0) {
      discard;
    }

    if(u_linearColor == 1.0) {
      vec4 linearColor = mix(u_targetColor, u_sourceColor, sidey);
      linearColor.rgb *= lightWeight;
      gl_FragColor = linearColor;
    } else {
      gl_FragColor = v_Color;
    }
  } else {

     // top face
    if(u_topsurface < 1.0) {
      discard;
    }

    gl_FragColor = texture2D(u_texture, vec2(topU, topV));
    // gl_FragColor = vec4(1.0, 0., 0., 1.0);
  }
  

  gl_FragColor.a *= opacity;
  gl_FragColor = filterColor(gl_FragColor);
}
`,x4=`precision highp float;

#define ambientRatio 0.5
#define diffuseRatio 0.3
#define specularRatio 0.2

attribute vec4 a_Color;
attribute vec3 a_Position;
attribute vec3 a_Normal;
attribute float a_Size;
attribute vec3 a_uvs;
uniform mat4 u_ModelMatrix;

uniform sampler2D u_texture;


uniform vec4 u_sourceColor;
uniform vec4 u_targetColor;
uniform float u_topsurface: 1.0;
uniform float u_sidesurface: 1.0;
varying vec4 v_Color;
uniform float u_heightfixed: 0.0; // \u9ED8\u8BA4\u4E0D\u56FA\u5B9A
uniform float u_raisingHeight: 0.0;
uniform float u_linearColor: 0.0;

varying vec2 v_texture_data;
varying vec3 v_uvs;

#pragma include "projection"
#pragma include "light"
#pragma include "picking"

void main() {
 
  vec4 pos = vec4(a_Position.xy, a_Position.z * a_Size, 1.0);
  float lightWeight = calc_lighting(pos);
  vec4 project_pos = project_position(pos);
  v_uvs = a_uvs;

  v_texture_data = vec2(a_Position.z, lightWeight);

  if(u_heightfixed > 0.0) { // \u5224\u65AD\u51E0\u4F55\u4F53\u662F\u5426\u56FA\u5B9A\u9AD8\u5EA6
    project_pos.z = a_Position.z * a_Size;
    project_pos.z += u_raisingHeight;

    if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
      float mapboxZoomScale = 4.0/pow(2.0, 21.0 - u_Zoom);
      project_pos.z *= mapboxZoomScale;
      project_pos.z += u_raisingHeight * mapboxZoomScale;
    }
  }


    gl_Position = project_common_position_to_clipspace_v2(vec4(project_pos.xyz, 1.0));



  setPickingColor(a_PickingColor);
}
`,E4=`uniform float u_opacity: 1.0;
uniform vec4 u_sourceColor;
uniform vec4 u_targetColor;
uniform float u_linearColor: 0;

uniform float u_topsurface: 1.0;
uniform float u_sidesurface: 1.0;

varying vec4 v_Color;
varying vec3 v_uvs;
varying vec2 v_texture_data;

#pragma include "picking"

void main() {
  float opacity = u_opacity;
  float isSide =  v_texture_data.x;
  float sidey = v_uvs[2];
  float lightWeight = v_texture_data.y;

  // Tip: \u90E8\u5206\u673A\u578B GPU \u8BA1\u7B97\u7CBE\u5EA6\u517C\u5BB9
  if(isSide < 0.999) {
    // side face
    if(u_sidesurface < 1.0) {
      discard;
    }
    
    if( u_linearColor == 1.0) {
      // side use linear
      vec4 linearColor = mix(u_targetColor, u_sourceColor, sidey);
      linearColor.rgb *= lightWeight;
      gl_FragColor = linearColor;
    } else {
      // side notuse linear
       gl_FragColor = v_Color;
    }
  } else {
    // top face
    if(u_topsurface < 1.0) {
      discard;
    }
    gl_FragColor = v_Color;
  }

  gl_FragColor.a *= opacity;
  gl_FragColor = filterColorAlpha(gl_FragColor, lightWeight);
}
`,b4=`precision highp float;

#define ambientRatio 0.5
#define diffuseRatio 0.3
#define specularRatio 0.2

attribute vec4 a_Color;
attribute vec3 a_Position;
attribute vec3 a_Normal;
attribute float a_Size;
attribute vec3 a_uvs;
uniform mat4 u_ModelMatrix;


uniform float u_heightfixed: 0.0; // \u9ED8\u8BA4\u4E0D\u56FA\u5B9A
uniform float u_raisingHeight: 0.0;

varying vec2 v_texture_data;
varying vec3 v_uvs;
varying vec4 v_Color;


#pragma include "projection"
#pragma include "light"
#pragma include "picking"

void main() {


  v_uvs = a_uvs;
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
  vec4 pos = vec4(a_Position.xy, a_Position.z * a_Size, 1.0);
  vec4 project_pos = project_position(pos);

  if(u_heightfixed > 0.0) { // \u5224\u65AD\u51E0\u4F55\u4F53\u662F\u5426\u56FA\u5B9A\u9AD8\u5EA6
    project_pos.z = a_Position.z * a_Size;
    project_pos.z += u_raisingHeight;
    if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
      float mapboxZoomScale = 4.0/pow(2.0, 21.0 - u_Zoom);
      project_pos.z *= mapboxZoomScale;
      project_pos.z += u_raisingHeight * mapboxZoomScale;
    }
  }

  gl_Position = project_common_position_to_clipspace_v2(vec4(project_pos.xyz, 1.0));
  float lightWeight = calc_lighting(pos);
  v_texture_data = vec2(a_Position.z,lightWeight);

  v_Color = vec4(a_Color.rgb * lightWeight, a_Color.w);

  setPickingColor(a_PickingColor);
}
`,S4=function(e){(0,Ne.Z)(t,e);var i=v4(t);function t(){return(0,se.Z)(this,t),i.apply(this,arguments)}return(0,be.Z)(t,[{key:"getUninforms",value:function(){var r=this.layer.getLayerConfig(),a=r.heightfixed,u=a===void 0?!1:a,c=r.raisingHeight,g=c===void 0?0:c,x=r.topsurface,M=x===void 0?!0:x,O=r.sidesurface,B=O===void 0?!0:O,W=r.sourceColor,ce=r.targetColor,oe=0,Te=[1,1,1,1],Ze=[1,1,1,1];return W&&ce&&(Te=Ni(W),Ze=Ni(ce),oe=1),(0,X.Z)({u_topsurface:Number(M),u_sidesurface:Number(B),u_heightfixed:Number(u),u_raisingHeight:Number(g),u_linearColor:oe,u_sourceColor:Te,u_targetColor:Ze,u_texture:this.texture},this.getStyleAttribute())}},{key:"initModels",value:function(){var n=(0,ur.Z)(it().mark(function a(){return it().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.next=2,this.loadTexture();case 2:return c.abrupt("return",this.buildModels());case 3:case"end":return c.stop()}},a,this)}));function r(){return n.apply(this,arguments)}return r}()},{key:"buildModels",value:function(){var n=(0,ur.Z)(it().mark(function a(){var u,c,g,x,M;return it().wrap(function(B){for(;;)switch(B.prev=B.next){case 0:return u=this.getShaders(),c=u.frag,g=u.vert,x=u.type,B.next=3,this.layer.buildLayerModel({moduleName:x,vertexShader:g,fragmentShader:c,inject:this.getInject(),triangulation:A1});case 3:return M=B.sent,B.abrupt("return",[M]);case 5:case"end":return B.stop()}},a,this)}));function r(){return n.apply(this,arguments)}return r}()},{key:"getShaders",value:function(){var r=this.layer.getLayerConfig(),a=r.pickLight,u=r.mapTexture;return u?{frag:_4,vert:x4,type:"polygonExtrudeTexture"}:a?{frag:E4,vert:b4,type:"polygonExtrudePickLight"}:{frag:m4,vert:y4,type:"polygonExtrude"}}},{key:"clearModels",value:function(){var r;(r=this.texture)===null||r===void 0||r.destroy()}},{key:"registerBuiltinAttributes",value:function(){var r=this.layer.getSource().extent,a=r,u=this.layer.coordCenter||this.layer.getSource().center,c=a[2]-a[0],g=a[3]-a[1];if(this.mapService.version==="GAODE2.x"){var x=this.mapService.coordToAMap2RelativeCoordinates([r[0],r[1]],u),M=(0,vn.Z)(x,2),O=M[0],B=M[1],W=this.mapService.coordToAMap2RelativeCoordinates([r[2],r[3]],u),ce=(0,vn.Z)(W,2),oe=ce[0],Te=ce[1];c=oe-O,g=Te-B,a=[O,B,oe,Te]}this.styleAttributeService.registerStyleAttribute({name:"uvs",type:mn.Attribute,descriptor:{name:"a_uvs",buffer:{usage:je.STATIC_DRAW,data:[],type:je.FLOAT},size:3,update:function(qe,et,yt){var bt=yt[0],Ot=yt[1];return[(bt-a[0])/c,(Ot-a[1])/g,yt[4]]}}}),this.styleAttributeService.registerStyleAttribute({name:"normal",type:mn.Attribute,descriptor:{name:"a_Normal",buffer:{usage:je.STATIC_DRAW,data:[],type:je.FLOAT},size:3,update:function(qe,et,yt,bt,Ot){return Ot}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:mn.Attribute,descriptor:{name:"a_Size",buffer:{usage:je.DYNAMIC_DRAW,data:[],type:je.FLOAT},size:1,update:function(qe){var et=qe.size,yt=et===void 0?10:et;return Array.isArray(yt)?[yt[0]]:[yt]}}})}},{key:"loadTexture",value:function(){var n=(0,ur.Z)(it().mark(function a(){var u=this,c,g,x;return it().wrap(function(O){for(;;)switch(O.prev=O.next){case 0:if(c=this.layer.getLayerConfig(),g=c.mapTexture,x=this.rendererService.createTexture2D,this.texture=x({height:0,width:0}),!g){O.next=5;break}return O.abrupt("return",new Promise(function(B,W){var ce=new Image;ce.crossOrigin="anonymous",ce.src=g,ce.onload=function(){return u.texture=x({data:ce,width:ce.width,height:ce.height,wrapS:je.CLAMP_TO_EDGE,wrapT:je.CLAMP_TO_EDGE,min:je.LINEAR,mag:je.LINEAR}),B(null)},ce.onerror=function(){W(new Error("image load error"))}}));case 5:case"end":return O.stop()}},a,this)}));function r(){return n.apply(this,arguments)}return r}()}]),t}(vo);function C4(e){var i=w4();return function(){var n=(0,ue.Z)(e),r;if(i){var a=(0,ue.Z)(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return(0,ze.Z)(this,r)}}function w4(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var T4=`
uniform float u_opacity: 1.0;
varying vec4 v_Color;
varying vec2 v_texture_data;


#pragma include "picking"

void main() {

  gl_FragColor = v_Color;
  gl_FragColor = filterColor(gl_FragColor);
}
`,M4=`precision highp float;

#define ambientRatio 0.5
#define diffuseRatio 0.3
#define specularRatio 0.2

attribute vec4 a_Color;
attribute vec3 a_Position;
attribute vec3 a_Normal;
attribute float a_Size;
uniform mat4 u_ModelMatrix;




varying vec4 v_Color;

#pragma include "projection"
#pragma include "light"
#pragma include "picking"

void main() {
 
  vec4 pos = vec4(a_Position.xy, a_Position.z * a_Size + (1.0 - a_Position.z) * extrusionBase, 1.0);
  float lightWeight = calc_lighting(pos);
  vec4 project_pos = project_position(pos);
  v_Color = a_Color;
  v_Color = vec4(v_Color.rgb * lightWeight, v_Color.w * opacity);

  gl_Position = project_common_position_to_clipspace_v2(vec4(project_pos.xyz, 1.0));

  setPickingColor(a_PickingColor);
}
`,I4=function(e){(0,Ne.Z)(t,e);var i=C4(t);function t(){return(0,se.Z)(this,t),i.apply(this,arguments)}return(0,be.Z)(t,[{key:"getUninforms",value:function(){return(0,X.Z)({},this.getStyleAttribute())}},{key:"initModels",value:function(){var n=(0,ur.Z)(it().mark(function a(){return it().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.abrupt("return",this.buildModels());case 1:case"end":return c.stop()}},a,this)}));function r(){return n.apply(this,arguments)}return r}()},{key:"buildModels",value:function(){var n=(0,ur.Z)(it().mark(function a(){var u,c,g,x,M;return it().wrap(function(B){for(;;)switch(B.prev=B.next){case 0:return u=this.getShaders(),c=u.frag,g=u.vert,x=u.type,B.next=3,this.layer.buildLayerModel({moduleName:x,vertexShader:g,fragmentShader:c,inject:this.getInject(),triangulation:A1});case 3:return M=B.sent,B.abrupt("return",[M]);case 5:case"end":return B.stop()}},a,this)}));function r(){return n.apply(this,arguments)}return r}()},{key:"getShaders",value:function(){return{frag:T4,vert:M4,type:"polygonExtrude"}}},{key:"clearModels",value:function(){var r;(r=this.texture)===null||r===void 0||r.destroy()}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"normal",type:mn.Attribute,descriptor:{name:"a_Normal",buffer:{usage:je.STATIC_DRAW,data:[],type:je.FLOAT},size:3,update:function(a,u,c,g,x){return x}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:mn.Attribute,descriptor:{name:"a_Size",buffer:{usage:je.DYNAMIC_DRAW,data:[],type:je.FLOAT},size:1,update:function(a){var u=a.size,c=u===void 0?10:u;return Array.isArray(c)?[c[0]]:[c]}}})}}]),t}(vo);function P4(e){var i=L4();return function(){var n=(0,ue.Z)(e),r;if(i){var a=(0,ue.Z)(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return(0,ze.Z)(this,r)}}function L4(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var O4=`varying vec4 v_color;
#pragma include "picking"

void main() {
  gl_FragColor = v_color;
  gl_FragColor = filterColor(gl_FragColor);
}
`,R4=`#pragma include "picking"
uniform float u_opacitylinear: 0.0;
uniform float u_dir: 1.0;
varying vec3 v_linear;
varying vec2 v_pos;
varying vec4 v_Color;


void main() {
   gl_FragColor = v_Color;
  if(u_opacitylinear > 0.0) {
    gl_FragColor.a *= u_dir == 1.0 ? 1.0 - length(v_pos - v_linear.xy)/v_linear.z : length(v_pos - v_linear.xy)/v_linear.z;
  }
  gl_FragColor = filterColor(gl_FragColor);
}
`,D4=`attribute vec4 a_Color;
attribute vec3 a_Position;

uniform mat4 u_ModelMatrix;

uniform float u_raisingHeight: 0.0;

varying vec4 v_Color;


#pragma include "projection"
#pragma include "picking"

uniform float u_opacitylinear: 0.0;

attribute vec3 a_linear;
varying vec3 v_linear;
varying vec2 v_pos;

void main() {
  if(u_opacitylinear > 0.0) {
    v_linear = a_linear;
    v_pos = a_Position.xy;
  }
  v_Color = vec4(a_Color.xyz, a_Color.w * opacity);
  vec4 project_pos = project_position(vec4(a_Position, 1.0));
  project_pos.z += u_raisingHeight;

  if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
    float mapboxZoomScale = 4.0/pow(2.0, 21.0 - u_Zoom);
    project_pos.z *= mapboxZoomScale;
    project_pos.z += u_raisingHeight * mapboxZoomScale;
  }

   gl_Position = project_common_position_to_clipspace_v2(vec4(project_pos.xyz, 1.0));
  setPickingColor(a_PickingColor);
}`,k4=`attribute vec4 a_Color;
attribute vec3 a_Position;

uniform mat4 u_ModelMatrix;


uniform float u_raisingHeight: 0.0;

varying vec4 v_color;


#pragma include "projection"
#pragma include "picking"

void main() {
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97

  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97

  v_color = vec4(a_Color.xyz, a_Color.w * opacity);
  vec4 project_pos = project_position(vec4(a_Position, 1.0));
  // gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));

  project_pos.z += u_raisingHeight;

  if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
    float mapboxZoomScale = 4.0/pow(2.0, 21.0 - u_Zoom);
    project_pos.z *= mapboxZoomScale;
    project_pos.z += u_raisingHeight * mapboxZoomScale;
  }

 
  gl_Position = project_common_position_to_clipspace_v2(vec4(project_pos.xyz, 1.0));

  setPickingColor(a_PickingColor);
}

`,N4=function(e){(0,Ne.Z)(t,e);var i=P4(t);function t(){return(0,se.Z)(this,t),i.apply(this,arguments)}return(0,be.Z)(t,[{key:"getUninforms",value:function(){var r=this.layer.getLayerConfig(),a=r.raisingHeight,u=a===void 0?0:a,c=r.opacityLinear,g=c===void 0?{enable:!1,dir:"in"}:c;return(0,X.Z)({u_raisingHeight:Number(u),u_opacitylinear:Number(g.enable),u_dir:g.dir==="in"?1:0},this.getStyleAttribute())}},{key:"initModels",value:function(){var n=(0,ur.Z)(it().mark(function a(){return it().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.abrupt("return",this.buildModels());case 1:case"end":return c.stop()}},a,this)}));function r(){return n.apply(this,arguments)}return r}()},{key:"buildModels",value:function(){var n=(0,ur.Z)(it().mark(function a(){var u,c,g,x,M,O;return it().wrap(function(W){for(;;)switch(W.prev=W.next){case 0:return u=this.getModelParams(),c=u.frag,g=u.vert,x=u.triangulation,M=u.type,this.layer.triangulation=x,W.next=4,this.layer.buildLayerModel({moduleName:M,vertexShader:g,fragmentShader:c,inject:this.getInject(),triangulation:x,primitive:je.TRIANGLES,depth:{enable:!1}});case 4:return O=W.sent,W.abrupt("return",[O]);case 6:case"end":return W.stop()}},a,this)}));function r(){return n.apply(this,arguments)}return r}()},{key:"registerBuiltinAttributes",value:function(){var r=this.layer.getLayerConfig(),a=r.opacityLinear,u=a===void 0?{enable:!1,dir:"in"}:a;u.enable&&this.styleAttributeService.registerStyleAttribute({name:"linear",type:mn.Attribute,descriptor:{name:"a_linear",buffer:{usage:je.STATIC_DRAW,data:[],type:je.FLOAT},size:3,update:function(g,x,M){return[M[3],M[4],M[5]]}}})}},{key:"getModelParams",value:function(){var r=this.layer.getLayerConfig(),a=r.opacityLinear,u=a===void 0?{enable:!1}:a;return u.enable?{frag:R4,vert:D4,type:"polygonLinear",triangulation:B3}:{frag:O4,vert:k4,type:"polygonFill",triangulation:Oc}}}]),t}(vo);function F4(e){var i=B4();return function(){var n=(0,ue.Z)(e),r;if(i){var a=(0,ue.Z)(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return(0,ze.Z)(this,r)}}function B4(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var Z4=`
uniform float u_time: 0.0;
uniform float u_opacity: 1.0;

varying vec2 v_uv;

float coast2water_fadedepth = 0.10;
float large_waveheight      = .750; // change to adjust the "heavy" waves
float large_wavesize        = 3.4;  // factor to adjust the large wave size
float small_waveheight      = 0.6;  // change to adjust the small random waves
float small_wavesize        = 0.5;   // factor to ajust the small wave size
float water_softlight_fact  = 15.;  // range [1..200] (should be << smaller than glossy-fact)
float water_glossylight_fact= 120.; // range [1..200]
float particle_amount       = 70.;
// vec3 watercolor             = vec3(0.43, 0.60, 0.66); // 'transparent' low-water color (RGB)
// vec3 watercolor2            = vec3(0.06, 0.07, 0.11); // deep-water color (RGB, should be darker than the low-water color)
uniform vec4 u_watercolor;
uniform vec4 u_watercolor2;
vec3 water_specularcolor    = vec3(1.3, 1.3, 0.9);    // specular Color (RGB) of the water-highlights
#define light                 vec3(-0., sin(u_time*0.5)*.5 + .35, 2.8) // position of the sun

uniform sampler2D u_texture1;
uniform sampler2D u_texture2;
uniform sampler2D u_texture3;

  

float hash( float n ) {
    return fract(sin(n)*43758.5453123);
}

// 2d noise function
float noise1( in vec2 x ) {
  vec2 p  = floor(x);
  vec2 f  = smoothstep(0.0, 1.0, fract(x));
  float n = p.x + p.y*57.0;
  return mix(mix( hash(n+  0.0), hash(n+  1.0),f.x),
    mix( hash(n+ 57.0), hash(n+ 58.0),f.x),f.y);
}

float noise(vec2 p) {
    return texture2D(u_texture2,p*vec2(1./256.)).x;
}

vec4 highness(vec2 p) {
    vec4 t = texture2D(u_texture1,fract(p));
    float clipped = -2.0-smoothstep(3.,10.,t.a)*6.9-smoothstep(10.,100.,t.a)*89.9-smoothstep(0.,10000.,t.a)*10000.0;
    return clamp(t, 0.0,3.0)+clamp(t/3.0-1.0, 0.0,1.0)+clamp(t/16.0-1.0, 0.0,1.0);
}

float height_map( vec2 p ) {
    vec4 height=highness(p);
    /*
    height = -0.5+
        0.5*smoothstep(-100.,0.,-height)+
        2.75*smoothstep(0.,2.,height)+
        1.75*smoothstep(2.,4.,height)+
        2.75*smoothstep(4.,16.,height)+
        1.5*smoothstep(16.,1000.,height);
    */

    mat2 m = mat2( 0.9563*1.4,  -0.2924*1.4,  0.2924*1.4,  0.9563*1.4 );
    //p = p*6.;
    float f = 0.6000*noise1( p ); p = m*p*1.1*6.;
    f += 0.2500*noise( p ); p = m*p*1.32;
    f += 0.1666*noise( p ); p = m*p*1.11;
    f += 0.0834*noise( p ); p = m*p*1.12;
    f += 0.0634*noise( p ); p = m*p*1.13;
    f += 0.0444*noise( p ); p = m*p*1.14;
    f += 0.0274*noise( p ); p = m*p*1.15;
    f += 0.0134*noise( p ); p = m*p*1.16;
    f += 0.0104*noise( p ); p = m*p*1.17;
    f += 0.0084*noise( p );
    f = .25*f+dot(height,vec4(-.03125,-.125,.25,.25))*.5;
        const float FLAT_LEVEL = 0.92525;
        //f = f*0.25+height*0.75;
    if (f<FLAT_LEVEL)
        f = f;
    else
        f = pow((f-FLAT_LEVEL)/(1.-FLAT_LEVEL), 2.)*(1.-FLAT_LEVEL)*2.0+FLAT_LEVEL; // makes a smooth coast-increase
    return clamp(f, 0., 10.);
}

vec3 plasma_quintic( float x ) {
    x = clamp( x, 0.0, 1.0);
    vec4 x1 = vec4( 1.0, x, x * x, x * x * x ); // 1 x x2 x3
    vec4 x2 = x1 * x1.w * x; // x4 x5 x6 x7
    return vec3(
        dot( x1.xyzw, vec4( +0.063861086, +1.992659096, -1.023901152, -0.490832805 ) ) + dot( x2.xy, vec2( +1.308442123, -0.914547012 ) ),
        dot( x1.xyzw, vec4( +0.049718590, -0.791144343, +2.892305078, +0.811726816 ) ) + dot( x2.xy, vec2( -4.686502417, +2.717794514 ) ),
        dot( x1.xyzw, vec4( +0.513275779, +1.580255060, -5.164414457, +4.559573646 ) ) + dot( x2.xy, vec2( -1.916810682, +0.570638854 ) ) );
}

vec4 color(vec2 p){
    vec4 c1 = vec4(1.7,1.6,.9,1);
    vec4 c2 = vec4(.2,.94,.1,1);
    vec4 c3 = vec4(.3,.2,.0,1);
    vec4 c4 = vec4(.99,.99,1.6,1);
    vec4 v = highness(p);
    float los = smoothstep(0.1,1.1,v.b);
    float his = smoothstep(3.5,6.5,v.b);
    float ces = smoothstep(1.,5.,v.a);
    vec4 lo = mix(c1,c2,los);
    vec4 hi = mix(c3,c4,his);
    vec4 ce = mix(lo,hi,ces);

    return vec4(plasma_quintic(ces),1).ragb;
}

vec3 terrain_map( vec2 p )
{
  return color(p).rgb*0.75+0.25*vec3(0.7, .55, .4)+texture2D(u_texture3, fract(p*5.)).rgb*.5; // test-terrain is simply 'sandstone'
}

const mat2 m = mat2( 0.72, -1.60,  1.60,  0.72 );

float water_map( vec2 p, float height ) {
    vec2 p2 = p*large_wavesize;
    vec2 shift1 = 0.001*vec2( u_time*160.0*2.0, u_time*120.0*2.0 );
    vec2 shift2 = 0.001*vec2( u_time*190.0*2.0, -u_time*130.0*2.0 );

    // coarse crossing 'ocean' waves...
    float f = 0.6000*noise( p );
    f += 0.2500*noise( p*m );
    f += 0.1666*noise( p*m*m );
    float wave = sin(p2.x*0.622+p2.y*0.622+shift2.x*4.269)*large_waveheight*f*height*height ;

    p *= small_wavesize;
    f = 0.;
    float amp = 1.0, s = .5;
    for (int i=0; i<9; i++)
    { p = m*p*.947; f -= amp*abs(sin((noise( p+shift1*s )-.5)*2.)); amp = amp*.59; s*=-1.329; }
    
    return wave+f*small_waveheight;
}

float nautic(vec2 p) {
    p *= 18.;
    float f = 0.;
    float amp = 1.0, s = .5;
    for (int i=0; i<3; i++)
    { p = m*p*1.2; f += amp*abs(smoothstep(0., 1., noise( p+u_time*s ))-.5); amp = amp*.5; s*=-1.227; }
    return pow(1.-f, 5.);
}

float particles(vec2 p) {
    p *= 200.;
    float f = 0.;
    float amp = 1.0, s = 1.5;
    for (int i=0; i<3; i++)
    { p = m*p*1.2; f += amp*noise( p+u_time*s ); amp = amp*.5; s*=-1.227; }
    return pow(f*.35, 7.)*particle_amount;
}

float test_shadow( vec2 xy, float height) {
    vec3 r0 = vec3(xy, height);
    vec3 rd = normalize( light - r0 );
    
    float hit = 1.0;
    float t   = 0.001;
    for (int j=1; j<25; j++)
    {
        vec3 p = r0 + t*rd;
        float h = height_map( p.xy );
        float height_diff = p.z - h;
        if (height_diff<0.0)
        {
            return 0.0;
        }
        t += 0.01+height_diff*.02;
        hit = min(hit, 2.*height_diff/t); // soft shaddow   
    }
    return hit;
}

vec3 CalcTerrain(vec2 uv, float height) {
    vec3 col = terrain_map( uv );
    vec2 iResolution = vec2(512.);
    float h1 = height_map(uv-vec2(0., 0.5)/ iResolution.xy);
    float h2 = height_map(uv+vec2(0., 0.5)/ iResolution.xy);
    float h3 = height_map(uv-vec2(0.5, 0.)/ iResolution.xy);
    float h4 = height_map(uv+vec2(0.5, 0.)/ iResolution.xy);
    vec3 norm = normalize(vec3(h3-h4, h1-h2, 1.));
    vec3 r0 = vec3(uv, height);
    vec3 rd = normalize( light - r0 );
    float grad = dot(norm, rd);
    col *= grad+pow(grad, 8.);
    float terrainshade = test_shadow( uv, height );
    col = mix(col*.25, col, terrainshade);
    return col;
}


void main() {
  vec3 watercolor = u_watercolor.rgb;
  vec3 watercolor2 = u_watercolor2.rgb;
  vec2 uv = v_uv;
  float WATER_LEVEL = 0.84; // Water level (range: 0.0 - 2.0)
  float deepwater_fadedepth   = 0.4 + coast2water_fadedepth;
  float height = height_map( uv );
  vec3 col;

    float waveheight = clamp(WATER_LEVEL*3.-1.5, 0., 1.);
    float level = WATER_LEVEL + .2*water_map(uv*15. + vec2(u_time*.1), waveheight);
    if (height > level)
    {
        col = CalcTerrain(uv, height);
    }
    if (height <= level)
    {
        vec2 dif = vec2(.0, .01);
        vec2 pos = uv*15. + vec2(u_time*.01);
        float h1 = water_map(pos-dif,waveheight);
        float h2 = water_map(pos+dif,waveheight);
        float h3 = water_map(pos-dif.yx,waveheight);
        float h4 = water_map(pos+dif.yx,waveheight);
        vec3 normwater = normalize(vec3(h3-h4, h1-h2, .125)); // norm-vector of the 'bumpy' water-plane
        uv += normwater.xy*.002*(level-height);
        
        col = CalcTerrain(uv, height);

        float coastfade = clamp((level-height)/coast2water_fadedepth, 0., 1.);
        float coastfade2= clamp((level-height)/deepwater_fadedepth, 0., 1.);
        float intensity = col.r*.2126+col.g*.7152+col.b*.0722;
        watercolor = mix(watercolor*intensity, watercolor2, smoothstep(0., 1., coastfade2));

        vec3 r0 = vec3(uv, WATER_LEVEL);
        vec3 rd = normalize( light - r0 ); // ray-direction to the light from water-position
        float grad     = dot(normwater, rd); // dot-product of norm-vector and light-direction
        float specular = pow(grad, water_softlight_fact);  // used for soft highlights                          
        float specular2= pow(grad, water_glossylight_fact); // used for glossy highlights
        float gradpos  = dot(vec3(0., 0., 1.), rd);
        float specular1= smoothstep(0., 1., pow(gradpos, 5.));  // used for diffusity (some darker corona around light's specular reflections...)                          
        float watershade  = test_shadow( uv, level );
        watercolor *= 2.2+watershade;
        watercolor += (.2+.8*watershade) * ((grad-1.0)*.5+specular) * .25;
        watercolor /= (1.+specular1*1.25);
        watercolor += watershade*specular2*water_specularcolor;
        watercolor += watershade*coastfade*(1.-coastfade2)*(vec3(.5, .6, .7)*nautic(uv)+vec3(1., 1., 1.)*particles(uv));
        
        col = mix(col, watercolor, coastfade);
    }
    

  float opacity = u_opacity;
  gl_FragColor = vec4(col, opacity);  
}
`,z4=`attribute vec2 a_uv;
attribute vec3 a_Position;
uniform mat4 u_ModelMatrix;


varying vec2 v_uv;

#pragma include "projection"

void main() {
  v_uv = a_uv;

  vec4 project_pos = project_position(vec4(a_Position, 1.0));
  gl_Position = project_common_position_to_clipspace_v2(vec4(project_pos.xyz, 1.0));
}

`,U4=In.isNumber,G4=function(e){(0,Ne.Z)(t,e);var i=F4(t);function t(){return(0,se.Z)(this,t),i.apply(this,arguments)}return(0,be.Z)(t,[{key:"getUninforms",value:function(){var r=this.layer.getLayerConfig(),a=r.opacity,u=a===void 0?1:a,c=r.watercolor,g=c===void 0?"#6D99A8":c,x=r.watercolor2,M=x===void 0?"#0F121C":x;return{u_texture1:this.texture1,u_texture2:this.texture2,u_texture3:this.texture3,u_watercolor:Ni(g),u_watercolor2:Ni(M),u_opacity:U4(u)?u:1}}},{key:"getAnimateUniforms",value:function(){return{u_time:this.layer.getLayerAnimateTime()}}},{key:"initModels",value:function(){var n=(0,ur.Z)(it().mark(function a(){return it().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return this.loadTexture(),c.abrupt("return",this.buildModels());case 2:case"end":return c.stop()}},a,this)}));function r(){return n.apply(this,arguments)}return r}()},{key:"buildModels",value:function(){var n=(0,ur.Z)(it().mark(function a(){var u;return it().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return g.next=2,this.layer.buildLayerModel({moduleName:"polygonOcean",vertexShader:z4,fragmentShader:Z4,triangulation:vg,primitive:je.TRIANGLES,depth:{enable:!1}});case 2:return u=g.sent,g.abrupt("return",[u]);case 4:case"end":return g.stop()}},a,this)}));function r(){return n.apply(this,arguments)}return r}()},{key:"clearModels",value:function(){var r,a,u;(r=this.texture1)===null||r===void 0||r.destroy(),(a=this.texture2)===null||a===void 0||a.destroy(),(u=this.texture3)===null||u===void 0||u.destroy()}},{key:"registerBuiltinAttributes",value:function(){var r=this.layer.getSource().extent,a=(0,vn.Z)(r,4),u=a[0],c=a[1],g=a[2],x=a[3],M=g-u,O=x-c;this.styleAttributeService.registerStyleAttribute({name:"oceanUv",type:mn.Attribute,descriptor:{name:"a_uv",buffer:{usage:je.STATIC_DRAW,data:[],type:je.FLOAT},size:2,update:function(W,ce,oe,Te){var Ze=W.version==="GAODE2.x"?W.originCoordinates[0][Te]:oe,qe=(0,vn.Z)(Ze,2),et=qe[0],yt=qe[1];return[(et-u)/M,(yt-c)/O]}}})}},{key:"loadTexture",value:function(){var r=this,a=this.rendererService.createTexture2D,u={height:0,width:0};this.texture1=a(u),this.texture2=a(u),this.texture3=a(u),c(function(x){r.texture1=g(x[0]),r.texture2=g(x[1]),r.texture3=g(x[2]),r.layerService.reRender()});function c(x){var M=0,O=[],B=["https://gw.alipayobjects.com/mdn/rms_816329/afts/img/A*EojwT4VzSiYAAAAAAAAAAAAAARQnAQ","https://gw.alipayobjects.com/mdn/rms_816329/afts/img/A*MJ22QbpuCzIAAAAAAAAAAAAAARQnAQ","https://gw.alipayobjects.com/mdn/rms_816329/afts/img/A*-z2HSIVDsHIAAAAAAAAAAAAAARQnAQ"];B.map(function(W){var ce=new Image;ce.crossOrigin="",ce.src=W,O.push(ce),ce.onload=function(){M++,M===3&&x(O)}})}function g(x){return a({data:x,width:x.width,height:x.height,wrapS:je.MIRRORED_REPEAT,wrapT:je.MIRRORED_REPEAT,min:je.LINEAR,mag:je.LINEAR})}}}]),t}(vo);function j4(e){var i=V4();return function(){var n=(0,ue.Z)(e),r;if(i){var a=(0,ue.Z)(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return(0,ze.Z)(this,r)}}function V4(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var H4=`uniform sampler2D u_texture;
uniform float u_time: 0.0;
uniform float u_speed: 1.0;
uniform float u_opacity: 1.0;

varying vec4 v_Color;
varying vec2 v_uv;

float rand(vec2 n) { return 0.5 + 0.5 * fract(sin(dot(n.xy, vec2(12.9898, 78.233)))* 43758.5453); }

float water(vec3 p) {
  float t = u_time * u_speed;
  p.z += t * 2.; p.x += t * 2.;
  vec3 c1 = texture2D(u_texture, p.xz / 30.).xyz;
  p.z += t * 3.; p.x += t * 0.52;
  vec3 c2 = texture2D(u_texture, p.xz / 30.).xyz;
  p.z += t * 4.; p.x += t * 0.8;
  vec3 c3 = texture2D(u_texture, p.xz / 30.).xyz;
  c1 += c2 - c3;
  float z = (c1.x + c1.y + c1.z) / 3.;
  return p.y + z / 4.;
}

float map(vec3 p) {
  float d = 100.0;
  d = water(p);
  return d;
}

float intersect(vec3 ro, vec3 rd) {
  float d = 0.0;
  for (int i = 0; i <= 100; i++) {
    float h = map(ro + rd * d);
    if (h < 0.1) return  d;
    d += h;
  }
  return 0.0;
}

vec3 norm(vec3 p) {
  float eps = .1;
  return normalize(vec3(
    map(p + vec3(eps, 0, 0)) - map(p + vec3(-eps, 0, 0)),
    map(p + vec3(0, eps, 0)) - map(p + vec3(0, -eps, 0)),
    map(p + vec3(0, 0, eps)) - map(p + vec3(0, 0, -eps))
  ));
} 

float calSpc() {
  vec3 l1 = normalize(vec3(1, 1, 1));
  vec3 ro = vec3(-3, 20, -8);
  vec3 rc = vec3(0, 0, 0);
  vec3 ww = normalize(rc - ro);
  vec3 uu = normalize(cross(vec3(0,1,0), ww));
  vec3 vv = normalize(cross(rc - ro, uu));
  vec3 rd = normalize(uu * v_uv.x + vv * v_uv.y + ww);
  float d = intersect(ro, rd);
  vec3 p = ro + rd * d;
  vec3 n = norm(p);
  float spc = pow(max(0.0, dot(reflect(l1, n), rd)), 30.0);
  return spc;
}

void main() {
  float opacity = u_opacity;
  gl_FragColor = v_Color;
  gl_FragColor.a *= opacity;

  float spc = calSpc();
  gl_FragColor += spc * 0.4;
}
`,$4=`attribute vec4 a_Color;
attribute vec2 a_uv;
attribute vec3 a_Position;
uniform mat4 u_ModelMatrix;


varying vec4 v_Color;
varying vec2 v_uv;
uniform float u_opacity: 1.0;


#pragma include "projection"

void main() {
  v_uv = a_uv;

  v_Color = a_Color;
  vec4 project_pos = project_position(vec4(a_Position, 1.0));

  gl_Position = project_common_position_to_clipspace_v2(vec4(project_pos.xyz, 1.0));
}

`,Y4=In.isNumber,W4=function(e){(0,Ne.Z)(t,e);var i=j4(t);function t(){return(0,se.Z)(this,t),i.apply(this,arguments)}return(0,be.Z)(t,[{key:"getUninforms",value:function(){var r=this.layer.getLayerConfig(),a=r.opacity,u=a===void 0?1:a,c=r.speed,g=c===void 0?.5:c;return{u_texture:this.texture,u_speed:g,u_opacity:Y4(u)?u:1}}},{key:"getAnimateUniforms",value:function(){return{u_time:this.layer.getLayerAnimateTime()}}},{key:"initModels",value:function(){var n=(0,ur.Z)(it().mark(function a(){return it().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return this.loadTexture(),c.abrupt("return",this.buildModels());case 2:case"end":return c.stop()}},a,this)}));function r(){return n.apply(this,arguments)}return r}()},{key:"buildModels",value:function(){var n=(0,ur.Z)(it().mark(function a(){var u;return it().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return g.next=2,this.layer.buildLayerModel({moduleName:"polygonWater",vertexShader:$4,fragmentShader:H4,triangulation:vg,primitive:je.TRIANGLES,depth:{enable:!1}});case 2:return u=g.sent,g.abrupt("return",[u]);case 4:case"end":return g.stop()}},a,this)}));function r(){return n.apply(this,arguments)}return r}()},{key:"clearModels",value:function(){var r;(r=this.texture)===null||r===void 0||r.destroy()}},{key:"registerBuiltinAttributes",value:function(){var r=this.layer.getSource().extent,a=(0,vn.Z)(r,4),u=a[0],c=a[1],g=a[2],x=a[3],M=g-u,O=x-c;this.styleAttributeService.registerStyleAttribute({name:"waterUv",type:mn.Attribute,descriptor:{name:"a_uv",buffer:{usage:je.STATIC_DRAW,data:[],type:je.FLOAT},size:2,update:function(W,ce,oe,Te){var Ze=W.version==="GAODE2.x"?W.originCoordinates[0][Te]:oe,qe=(0,vn.Z)(Ze,2),et=qe[0],yt=qe[1];return[(et-u)/M,(yt-c)/O]}}})}},{key:"loadTexture",value:function(){var r=this,a=this.layer.getLayerConfig(),u=a.waterTexture,c=this.rendererService.createTexture2D;this.texture=c({height:0,width:0});var g=new Image;g.crossOrigin="",u?(console.warn("L7 recommend\uFF1Ahttps://gw.alipayobjects.com/mdn/rms_816329/afts/img/A*EojwT4VzSiYAAAAAAAAAAAAAARQnAQ"),g.src=u):g.src="https://gw.alipayobjects.com/mdn/rms_816329/afts/img/A*EojwT4VzSiYAAAAAAAAAAAAAARQnAQ",g.onload=function(){r.texture=c({data:g,width:g.width,height:g.height,wrapS:je.MIRRORED_REPEAT,wrapT:je.MIRRORED_REPEAT,min:je.LINEAR,mag:je.LINEAR}),r.layerService.reRender()}}}]),t}(vo),X4={fill:N4,line:m1,extrude:S4,text:F1,point_fill:b1,point_image:S1,point_normal:w1,point_extrude:x1,water:W4,ocean:G4,extrusion:I4},Q4=X4;function q4(e){var i=K4();return function(){var n=(0,ue.Z)(e),r;if(i){var a=(0,ue.Z)(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return(0,ze.Z)(this,r)}}function K4(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var _g=function(e){(0,Ne.Z)(t,e);var i=q4(t);function t(){var n;(0,se.Z)(this,t);for(var r=arguments.length,a=new Array(r),u=0;u<r;u++)a[u]=arguments[u];return n=i.call.apply(i,[this].concat(a)),(0,Me.Z)((0,xt.Z)(n),"type","PolygonLayer"),(0,Me.Z)((0,xt.Z)(n),"enableShaderEncodeStyles",["opacity","extrusionBase","rotation","offsets","stroke"]),n}return(0,be.Z)(t,[{key:"buildModels",value:function(){var n=(0,ur.Z)(it().mark(function a(){var u;return it().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return u=this.getModelType(),this.layerModel=new Q4[u](this),g.next=4,this.initLayerModels();case 4:case"end":return g.stop()}},a,this)}));function r(){return n.apply(this,arguments)}return r}()},{key:"getModelType",value:function(){var r,a=this.styleAttributeService.getLayerStyleAttribute("shape"),u=a==null||(r=a.scale)===null||r===void 0?void 0:r.field;return u==="fill"||!u?"fill":u==="extrude"?"extrude":u==="extrusion"?"extrusion":u==="water"?"water":u==="ocean"?"ocean":u==="line"?"line":this.getPointModelType()}},{key:"getPointModelType",value:function(){var r=this.getEncodedData(),a=this.getLayerConfig(),u=a.shape2d,c=a.shape3d,g=this.iconService.getIconMap(),x=r.find(function(O){return O.hasOwnProperty("shape")});if(x){var M=x.shape;return M==="dot"?"point_normal":(u==null?void 0:u.indexOf(M))!==-1?"point_fill":(c==null?void 0:c.indexOf(M))!==-1?"point_extrude":g.hasOwnProperty(M)?"point_image":"text"}else return"fill"}}]),t}(iA);function J4(e){var i=eT();return function(){var n=(0,ue.Z)(e),r;if(i){var a=(0,ue.Z)(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return(0,ze.Z)(this,r)}}function eT(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var tT=`uniform float u_opacity : 1.0;
uniform vec4 u_color;

void main() {
  gl_FragColor = u_color;
  gl_FragColor.a *= u_opacity;
}
`,rT=`attribute vec3 a_Position;
uniform mat4 u_ModelMatrix;


#pragma include "projection"

void main() {
  vec4 project_pos = project_position(vec4(a_Position, 1.0));

  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    gl_Position = u_Mvp * (vec4(project_pos.xyz, 1.0));
  } else {
    gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));
  }
}

`,nT=In.isNumber,iT=function(e){(0,Ne.Z)(t,e);var i=J4(t);function t(){return(0,se.Z)(this,t),i.apply(this,arguments)}return(0,be.Z)(t,[{key:"getUninforms",value:function(){var r=this.layer.getLayerConfig(),a=r.opacity,u=a===void 0?1:a,c=r.color,g=c===void 0?"#000":c;return{u_opacity:nT(u)?u:0,u_color:Ni(g)}}},{key:"initModels",value:function(){var n=(0,ur.Z)(it().mark(function a(){return it().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.abrupt("return",this.buildModels());case 1:case"end":return c.stop()}},a,this)}));function r(){return n.apply(this,arguments)}return r}()},{key:"buildModels",value:function(){var n=(0,ur.Z)(it().mark(function a(){var u;return it().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return g.next=2,this.layer.buildLayerModel({moduleName:"mask",vertexShader:rT,fragmentShader:tT,triangulation:vg,depth:{enable:!1},pick:!1});case 2:return u=g.sent,g.abrupt("return",[u]);case 4:case"end":return g.stop()}},a,this)}));function r(){return n.apply(this,arguments)}return r}()},{key:"clearModels",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;r&&this.layerService.clear()}},{key:"registerBuiltinAttributes",value:function(){return""}}]),t}(vo),aT={fill:iT},oT=aT;function sT(e){var i=uT();return function(){var n=(0,ue.Z)(e),r;if(i){var a=(0,ue.Z)(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return(0,ze.Z)(this,r)}}function uT(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var Z1=function(e){(0,Ne.Z)(t,e);var i=sT(t);function t(){var n;(0,se.Z)(this,t);for(var r=arguments.length,a=new Array(r),u=0;u<r;u++)a[u]=arguments[u];return n=i.call.apply(i,[this].concat(a)),(0,Me.Z)((0,xt.Z)(n),"type","MaskLayer"),n}return(0,be.Z)(t,[{key:"buildModels",value:function(){var n=(0,ur.Z)(it().mark(function a(){var u;return it().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return u=this.getModelType(),this.layerModel=new oT[u](this),g.next=4,this.initLayerModels();case 4:case"end":return g.stop()}},a,this)}));function r(){return n.apply(this,arguments)}return r}()},{key:"getModelType",value:function(){return"fill"}}]),t}(iA),z1,U1,G1,j1,zd,V1,H1,lT=In.cloneDeep,cT=(z1=(0,vr.b2)(),U1=(0,vr.f3)(Xt.IMapService),G1=(0,vr.f3)(Xt.IFontService),z1(j1=(zd=function(){function e(){(0,se.Z)(this,e),Ki(this,"mapService",V1,this),Ki(this,"fontService",H1,this)}return(0,be.Z)(e,[{key:"apply",value:function(t,n){var r=this,a=n.styleAttributeService;t.hooks.init.tapPromise("DataMappingPlugin",(0,ur.Z)(it().mark(function u(){return it().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:t.log(Js.MappingStart,us.INIT),r.generateMaping(t,{styleAttributeService:a}),t.log(Js.MappingEnd,us.INIT);case 3:case"end":return g.stop()}},u)}))),t.hooks.beforeRenderData.tapPromise("DataMappingPlugin",function(){var u=(0,ur.Z)(it().mark(function c(g){var x;return it().wrap(function(O){for(;;)switch(O.prev=O.next){case 0:if(g){O.next=2;break}return O.abrupt("return",g);case 2:return t.dataState.dataMappingNeedUpdate=!1,t.log(Js.MappingStart,us.UPDATE),x=r.generateMaping(t,{styleAttributeService:a}),t.log(Js.MappingEnd,us.UPDATE),O.abrupt("return",x);case 7:case"end":return O.stop()}},c)}));return function(c){return u.apply(this,arguments)}}()),t.hooks.beforeRender.tap("DataMappingPlugin",function(){var u=t.getSource();if(!(t.layerModelNeedUpdate||!u||!u.inited)){var c=a.getLayerStyleAttributes()||[],g=a.getLayerStyleAttribute("filter"),x=u.data.dataArray;if(!(Array.isArray(x)&&x.length===0)){var M=c.filter(function(W){return W.needRemapping}),O=x;if(g!=null&&g.needRemapping&&g!==null&&g!==void 0&&g.scale&&(O=x.filter(function(W){return r.applyAttributeMapping(g,W)[0]})),M.length){var B=r.mapping(t,M,O,t.getEncodedData());t.setEncodedData(B)}}}})}},{key:"generateMaping",value:function(t,n){var r=this,a=n.styleAttributeService,u=a.getLayerStyleAttributes()||[],c=a.getLayerStyleAttribute("filter"),g=t.getSource().data.dataArray,x=g;c!=null&&c.scale&&(x=g.filter(function(O){return r.applyAttributeMapping(c,O)[0]})),x=t.processData(x);var M=this.mapping(t,u,x,void 0);return t.setEncodedData(M),g.length===0&&t.encodeDataLength===0?!1:(t.emit("dataUpdate",null),!0)}},{key:"mapping",value:function(t,n,r,a){var u=this,c=n.filter(function(x){return x.scale!==void 0}).filter(function(x){return x.name!=="filter"}),g=r.map(function(x,M){var O=a?a[M]:{},B=(0,X.Z)({id:x._id,coordinates:x.coordinates},O);return c.forEach(function(W){var ce=u.applyAttributeMapping(W,x);(W.name==="color"||W.name==="stroke")&&(ce=ce.map(function(oe){return Ni(oe)})),B[W.name]=Array.isArray(ce)&&ce.length===1?ce[0]:ce,W.name==="shape"&&(B.shape=u.fontService.getIconFontKey(B[W.name]))}),B});return n.forEach(function(x){x.needRemapping=!1}),this.adjustData2Amap2Coordinates(g,t),this.adjustData2SimpleCoordinates(g),g}},{key:"adjustData2Amap2Coordinates",value:function(t,n){var r=this;if(t.length>0&&this.mapService.version==="GAODE2.x"){var a=n.coordCenter||n.getSource().center;t.filter(function(u){return!u.originCoordinates}).map(function(u){u.version="GAODE2.x",u.originCoordinates=lT(u.coordinates),u.coordinates=r.mapService.coordToAMap2RelativeCoordinates(u.coordinates,a)})}}},{key:"adjustData2SimpleCoordinates",value:function(t){var n=this;t.length>0&&this.mapService.version==="SIMPLE"&&t.map(function(r){r.simpleCoordinate||(r.coordinates=n.unProjectCoordinates(r.coordinates),r.simpleCoordinate=!0)})}},{key:"unProjectCoordinates",value:function(t){var n=this;if(typeof t[0]=="number")return this.mapService.simpleMapCoord.unproject(t);if(t[0]&&t[0][0]instanceof Array){var r=[];return t.map(function(u){var c=[];u.map(function(g){c.push(n.mapService.simpleMapCoord.unproject(g))}),r.push(c)}),r}else{var a=[];return t.map(function(u){a.push(n.mapService.simpleMapCoord.unproject(u))}),a}}},{key:"applyAttributeMapping",value:function(t,n){var r;if(!t.scale)return[];var a=(t==null||(r=t.scale)===null||r===void 0?void 0:r.scalers)||[],u=[];a.forEach(function(g){var x,M=g.field;(n.hasOwnProperty(M)||((x=t.scale)===null||x===void 0?void 0:x.type)==="variable")&&u.push(n[M])});var c=t.mapping?t.mapping(u):[];return c}},{key:"getArrowPoints",value:function(t,n){var r=[n[0]-t[0],n[1]-t[1]],a=yc(r),u=[t[0]+a[0]*1e-4,t[1]+a[1]*1e-4];return u}}]),e}(),V1=Hi(zd.prototype,"mapService",[U1],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),H1=Hi(zd.prototype,"fontService",[G1],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),zd))||j1),$1,Y1,fT=($1=(0,vr.b2)(),$1(Y1=function(){function e(){(0,se.Z)(this,e)}return(0,be.Z)(e,[{key:"apply",value:function(t){var n=this;this.mapService=t.getContainer().get(Xt.IMapService),t.hooks.init.tapPromise("DataSourcePlugin",(0,ur.Z)(it().mark(function r(){var a,u,c,g;return it().wrap(function(M){for(;;)switch(M.prev=M.next){case 0:if(t.log(Js.SourceInitStart,us.INIT),a=t.getSource(),a||(u=t.sourceOption||t.defaultSourceConfig,c=u.data,g=u.options,a=new Iy(c,g),t.setSource(a)),!a.inited){M.next=8;break}n.updateClusterData(t),t.log(Js.SourceInitEnd,us.INIT),M.next=10;break;case 8:return M.next=10,new Promise(function(O){a.on("update",function(B){B.type==="inited"&&(n.updateClusterData(t),t.log(Js.SourceInitEnd,us.INIT)),O(null)})});case 10:case"end":return M.stop()}},r)}))),t.hooks.beforeRenderData.tapPromise("DataSourcePlugin",(0,ur.Z)(it().mark(function r(){var a,u,c;return it().wrap(function(x){for(;;)switch(x.prev=x.next){case 0:return a=n.updateClusterData(t),u=t.dataState.dataSourceNeedUpdate,t.dataState.dataSourceNeedUpdate=!1,c=a||u,x.abrupt("return",c);case 5:case"end":return x.stop()}},r)})))}},{key:"updateClusterData",value:function(t){if(t.isTileLayer||t.tileLayer||!t.getSource())return!1;var n=t.getSource(),r=n.cluster,a=n.clusterOptions.zoom,u=a===void 0?0:a,c=this.mapService.getZoom()-1,g=t.dataState.dataSourceNeedUpdate;return r&&g&&n.updateClusterData(Math.floor(c)),r&&Math.abs(t.clusterZoom-c)>=1?(u!==Math.floor(c)&&n.updateClusterData(Math.floor(c)),t.clusterZoom=c,!0):!1}}]),e}())||Y1),Qu=C(61272);function W1(e,i,t,n,r){var a=e*e,u=a*e;return((1-3*e+3*a-u)*i+(4-6*a+3*u)*t+(1+3*e+3*a-3*u)*n+u*r)/6}function hT(e){var i=e.length-1;return function(t){var n=t<=0?t=0:t>=1?(t=1,i-1):Math.floor(t*i),r=e[n],a=e[n+1],u=n>0?e[n-1]:2*r-a,c=n<i-1?e[n+2]:2*a-r;return W1((t-n/i)*i,u,r,a,c)}}function AT(e){var i=e.length;return function(t){var n=Math.floor(((t%=1)<0?++t:t)*i),r=e[(n+i-1)%i],a=e[n%i],u=e[(n+1)%i],c=e[(n+2)%i];return W1((t-n/i)*i,r,a,u,c)}}function xg(e){return function(){return e}}function X1(e,i){return function(t){return e+t*i}}function pT(e,i,t){return e=Math.pow(e,t),i=Math.pow(i,t)-e,t=1/t,function(n){return Math.pow(e+n*i,t)}}function TL(e,i){var t=i-e;return t?X1(e,t>180||t<-180?t-360*Math.round(t/360):t):constant(isNaN(e)?i:e)}function dT(e){return(e=+e)==1?Q1:function(i,t){return t-i?pT(i,t,e):xg(isNaN(i)?t:i)}}function Q1(e,i){var t=i-e;return t?X1(e,t):xg(isNaN(e)?i:e)}var q1=function e(i){var t=dT(i);function n(r,a){var u=t((r=yu(r)).r,(a=yu(a)).r),c=t(r.g,a.g),g=t(r.b,a.b),x=Q1(r.opacity,a.opacity);return function(M){return r.r=u(M),r.g=c(M),r.b=g(M),r.opacity=x(M),r+""}}return n.gamma=e,n}(1);function K1(e){return function(i){var t=i.length,n=new Array(t),r=new Array(t),a=new Array(t),u,c;for(u=0;u<t;++u)c=yu(i[u]),n[u]=c.r||0,r[u]=c.g||0,a[u]=c.b||0;return n=e(n),r=e(r),a=e(a),c.opacity=1,function(g){return c.r=n(g),c.g=r(g),c.b=a(g),c+""}}}var vT=K1(hT),ML=K1(AT),$c="$";function Ud(){}Ud.prototype=J1.prototype={constructor:Ud,has:function(e){return $c+e in this},get:function(e){return this[$c+e]},set:function(e,i){return this[$c+e]=i,this},remove:function(e){var i=$c+e;return i in this&&delete this[i]},clear:function(){for(var e in this)e[0]===$c&&delete this[e]},keys:function(){var e=[];for(var i in this)i[0]===$c&&e.push(i.slice(1));return e},values:function(){var e=[];for(var i in this)i[0]===$c&&e.push(this[i]);return e},entries:function(){var e=[];for(var i in this)i[0]===$c&&e.push({key:i.slice(1),value:this[i]});return e},size:function(){var e=0;for(var i in this)i[0]===$c&&++e;return e},empty:function(){for(var e in this)if(e[0]===$c)return!1;return!0},each:function(e){for(var i in this)i[0]===$c&&e(this[i],i.slice(1),this)}};function J1(e,i){var t=new Ud;if(e instanceof Ud)e.each(function(c,g){t.set(g,c)});else if(Array.isArray(e)){var n=-1,r=e.length,a;if(i==null)for(;++n<r;)t.set(n,e[n]);else for(;++n<r;)t.set(i(a=e[n],n,e),a)}else if(e)for(var u in e)t.set(u,e[u]);return t}var Eg=J1;function IL(){var e=[],i=[],t,n,r;function a(c,g,x,M){if(g>=e.length)return t!=null&&c.sort(t),n!=null?n(c):c;for(var O=-1,B=c.length,W=e[g++],ce,oe,Te=map(),Ze,qe=x();++O<B;)(Ze=Te.get(ce=W(oe=c[O])+""))?Ze.push(oe):Te.set(ce,[oe]);return Te.each(function(et,yt){M(qe,yt,a(et,g,x,M))}),qe}function u(c,g){if(++g>e.length)return c;var x,M=i[g-1];return n!=null&&g>=e.length?x=c.entries():(x=[],c.each(function(O,B){x.push({key:B,values:u(O,g)})})),M!=null?x.sort(function(O,B){return M(O.key,B.key)}):x}return r={object:function(c){return a(c,0,gT,mT)},map:function(c){return a(c,0,e_,t_)},entries:function(c){return u(a(c,0,e_,t_),0)},key:function(c){return e.push(c),r},sortKeys:function(c){return i[e.length-1]=c,r},sortValues:function(c){return t=c,r},rollup:function(c){return n=c,r}}}function gT(){return{}}function mT(e,i,t){e[i]=t}function e_(){return map()}function t_(e,i,t){e.set(i,t)}function Gd(){}var ph=Eg.prototype;Gd.prototype=yT.prototype={constructor:Gd,has:ph.has,add:function(e){return e+="",this[$c+e]=e,this},remove:ph.remove,clear:ph.clear,values:ph.keys,size:ph.size,empty:ph.empty,each:ph.each};function yT(e,i){var t=new Gd;if(e instanceof Gd)e.each(function(a){t.add(a)});else if(e){var n=-1,r=e.length;if(i==null)for(;++n<r;)t.add(e[n]);else for(;++n<r;)t.add(i(e[n],n,e))}return t}var PL=null,r_=Array.prototype,n_=r_.map,dh=r_.slice;function B0(e,i){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(i).domain(e);break}return this}function i_(e,i){switch(arguments.length){case 0:break;case 1:this.interpolator(e);break;default:this.interpolator(i).domain(e);break}return this}var a_={name:"implicit"};function jd(){var e=Eg(),i=[],t=[],n=a_;function r(a){var u=a+"",c=e.get(u);if(!c){if(n!==a_)return n;e.set(u,c=i.push(a))}return t[(c-1)%t.length]}return r.domain=function(a){if(!arguments.length)return i.slice();i=[],e=Eg();for(var u=-1,c=a.length,g,x;++u<c;)e.has(x=(g=a[u])+"")||e.set(x,i.push(g));return r},r.range=function(a){return arguments.length?(t=dh.call(a),r):t.slice()},r.unknown=function(a){return arguments.length?(n=a,r):n},r.copy=function(){return jd(i,t).unknown(n)},B0.apply(r,arguments),r}function o_(){var e=ordinal().unknown(void 0),i=e.domain,t=e.range,n=[0,1],r,a,u=!1,c=0,g=0,x=.5;delete e.unknown;function M(){var O=i().length,B=n[1]<n[0],W=n[B-0],ce=n[1-B];r=(ce-W)/Math.max(1,O-c+g*2),u&&(r=Math.floor(r)),W+=(ce-W-r*(O-c))*x,a=r*(1-c),u&&(W=Math.round(W),a=Math.round(a));var oe=sequence(O).map(function(Te){return W+r*Te});return t(B?oe.reverse():oe)}return e.domain=function(O){return arguments.length?(i(O),M()):i()},e.range=function(O){return arguments.length?(n=[+O[0],+O[1]],M()):n.slice()},e.rangeRound=function(O){return n=[+O[0],+O[1]],u=!0,M()},e.bandwidth=function(){return a},e.step=function(){return r},e.round=function(O){return arguments.length?(u=!!O,M()):u},e.padding=function(O){return arguments.length?(c=Math.min(1,g=+O),M()):c},e.paddingInner=function(O){return arguments.length?(c=Math.min(1,O),M()):c},e.paddingOuter=function(O){return arguments.length?(g=+O,M()):g},e.align=function(O){return arguments.length?(x=Math.max(0,Math.min(1,O)),M()):x},e.copy=function(){return o_(i(),n).round(u).paddingInner(c).paddingOuter(g).align(x)},initRange.apply(M(),arguments)}function s_(e){var i=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,delete e.paddingOuter,e.copy=function(){return s_(i())},e}function LL(){return s_(o_.apply(null,arguments).paddingInner(1))}function OL(e,i){return(isNumberArray(i)?numberArray:u_)(e,i)}function u_(e,i){var t=i?i.length:0,n=e?Math.min(t,e.length):0,r=new Array(n),a=new Array(t),u;for(u=0;u<n;++u)r[u]=Cg(e[u],i[u]);for(;u<t;++u)a[u]=i[u];return function(c){for(u=0;u<n;++u)a[u]=r[u](c);return a}}function _T(e,i){var t=new Date;return e=+e,i=+i,function(n){return t.setTime(e*(1-n)+i*n),t}}function Vd(e,i){return e=+e,i=+i,function(t){return e*(1-t)+i*t}}function xT(e,i){var t={},n={},r;(e===null||typeof e!="object")&&(e={}),(i===null||typeof i!="object")&&(i={});for(r in i)r in e?t[r]=Cg(e[r],i[r]):n[r]=i[r];return function(a){for(r in t)n[r]=t[r](a);return n}}var bg=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Sg=new RegExp(bg.source,"g");function ET(e){return function(){return e}}function bT(e){return function(i){return e(i)+""}}function ST(e,i){var t=bg.lastIndex=Sg.lastIndex=0,n,r,a,u=-1,c=[],g=[];for(e=e+"",i=i+"";(n=bg.exec(e))&&(r=Sg.exec(i));)(a=r.index)>t&&(a=i.slice(t,a),c[u]?c[u]+=a:c[++u]=a),(n=n[0])===(r=r[0])?c[u]?c[u]+=r:c[++u]=r:(c[++u]=null,g.push({i:u,x:Vd(n,r)})),t=Sg.lastIndex;return t<i.length&&(a=i.slice(t),c[u]?c[u]+=a:c[++u]=a),c.length<2?g[0]?bT(g[0].x):ET(i):(i=g.length,function(x){for(var M=0,O;M<i;++M)c[(O=g[M]).i]=O.x(x);return c.join("")})}function CT(e,i){i||(i=[]);var t=e?Math.min(i.length,e.length):0,n=i.slice(),r;return function(a){for(r=0;r<t;++r)n[r]=e[r]*(1-a)+i[r]*a;return n}}function wT(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function Cg(e,i){var t=typeof i,n;return i==null||t==="boolean"?xg(i):(t==="number"?Vd:t==="string"?(n=go(i))?(i=n,q1):ST:i instanceof go?q1:i instanceof Date?_T:wT(i)?CT:Array.isArray(i)?u_:typeof i.valueOf!="function"&&typeof i.toString!="function"||isNaN(i)?xT:Vd)(e,i)}function TT(e,i){return e=+e,i=+i,function(t){return Math.round(e*(1-t)+i*t)}}function MT(e){return function(){return e}}function IT(e){return+e}var l_=[0,1];function fl(e){return e}function wg(e,i){return(i-=e=+e)?function(t){return(t-e)/i}:MT(isNaN(i)?NaN:.5)}function c_(e){var i=e[0],t=e[e.length-1],n;return i>t&&(n=i,i=t,t=n),function(r){return Math.max(i,Math.min(t,r))}}function PT(e,i,t){var n=e[0],r=e[1],a=i[0],u=i[1];return r<n?(n=wg(r,n),a=t(u,a)):(n=wg(n,r),a=t(a,u)),function(c){return a(n(c))}}function LT(e,i,t){var n=Math.min(e.length,i.length)-1,r=new Array(n),a=new Array(n),u=-1;for(e[n]<e[0]&&(e=e.slice().reverse(),i=i.slice().reverse());++u<n;)r[u]=wg(e[u],e[u+1]),a[u]=t(i[u],i[u+1]);return function(c){var g=(0,Qu.b4)(e,c,1,n)-1;return a[g](r[g](c))}}function Hd(e,i){return i.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function Tg(){var e=l_,i=l_,t=Cg,n,r,a,u=fl,c,g,x;function M(){return c=Math.min(e.length,i.length)>2?LT:PT,g=x=null,O}function O(B){return isNaN(B=+B)?a:(g||(g=c(e.map(n),i,t)))(n(u(B)))}return O.invert=function(B){return u(r((x||(x=c(i,e.map(n),Vd)))(B)))},O.domain=function(B){return arguments.length?(e=n_.call(B,IT),u===fl||(u=c_(e)),M()):e.slice()},O.range=function(B){return arguments.length?(i=dh.call(B),M()):i.slice()},O.rangeRound=function(B){return i=dh.call(B),t=TT,M()},O.clamp=function(B){return arguments.length?(u=B?c_(e):fl,O):u!==fl},O.interpolate=function(B){return arguments.length?(t=B,M()):t},O.unknown=function(B){return arguments.length?(a=B,O):a},function(B,W){return n=B,r=W,M()}}function f_(e,i){return Tg()(e,i)}var OT=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function $d(e){if(!(i=OT.exec(e)))throw new Error("invalid format: "+e);var i;return new Mg({fill:i[1],align:i[2],sign:i[3],symbol:i[4],zero:i[5],width:i[6],comma:i[7],precision:i[8]&&i[8].slice(1),trim:i[9],type:i[10]})}$d.prototype=Mg.prototype;function Mg(e){this.fill=e.fill===void 0?" ":e.fill+"",this.align=e.align===void 0?">":e.align+"",this.sign=e.sign===void 0?"-":e.sign+"",this.symbol=e.symbol===void 0?"":e.symbol+"",this.zero=!!e.zero,this.width=e.width===void 0?void 0:+e.width,this.comma=!!e.comma,this.precision=e.precision===void 0?void 0:+e.precision,this.trim=!!e.trim,this.type=e.type===void 0?"":e.type+""}Mg.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function RT(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)}function Yd(e,i){if((t=(e=i?e.toExponential(i-1):e.toExponential()).indexOf("e"))<0)return null;var t,n=e.slice(0,t);return[n.length>1?n[0]+n.slice(2):n,+e.slice(t+1)]}function cA(e){return e=Yd(Math.abs(e)),e?e[1]:NaN}function DT(e,i){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(cA(i)/3)))*3-cA(Math.abs(e)))}function kT(e,i){return function(t,n){for(var r=t.length,a=[],u=0,c=e[0],g=0;r>0&&c>0&&(g+c+1>n&&(c=Math.max(1,n-g)),a.push(t.substring(r-=c,r+c)),!((g+=c+1)>n));)c=e[u=(u+1)%e.length];return a.reverse().join(i)}}function NT(e){return function(i){return i.replace(/[0-9]/g,function(t){return e[+t]})}}function FT(e){e:for(var i=e.length,t=1,n=-1,r;t<i;++t)switch(e[t]){case".":n=r=t;break;case"0":n===0&&(n=t),r=t;break;default:if(!+e[t])break e;n>0&&(n=0);break}return n>0?e.slice(0,n)+e.slice(r+1):e}var h_;function BT(e,i){var t=Yd(e,i);if(!t)return e+"";var n=t[0],r=t[1],a=r-(h_=Math.max(-8,Math.min(8,Math.floor(r/3)))*3)+1,u=n.length;return a===u?n:a>u?n+new Array(a-u+1).join("0"):a>0?n.slice(0,a)+"."+n.slice(a):"0."+new Array(1-a).join("0")+Yd(e,Math.max(0,i+a-1))[0]}function A_(e,i){var t=Yd(e,i);if(!t)return e+"";var n=t[0],r=t[1];return r<0?"0."+new Array(-r).join("0")+n:n.length>r+1?n.slice(0,r+1)+"."+n.slice(r+1):n+new Array(r-n.length+2).join("0")}var p_={"%":function(e,i){return(e*100).toFixed(i)},b:function(e){return Math.round(e).toString(2)},c:function(e){return e+""},d:RT,e:function(e,i){return e.toExponential(i)},f:function(e,i){return e.toFixed(i)},g:function(e,i){return e.toPrecision(i)},o:function(e){return Math.round(e).toString(8)},p:function(e,i){return A_(e*100,i)},r:A_,s:BT,X:function(e){return Math.round(e).toString(16).toUpperCase()},x:function(e){return Math.round(e).toString(16)}};function d_(e){return e}var v_=Array.prototype.map,g_=["y","z","a","f","p","n","\xB5","m","","k","M","G","T","P","E","Z","Y"];function ZT(e){var i=e.grouping===void 0||e.thousands===void 0?d_:kT(v_.call(e.grouping,Number),e.thousands+""),t=e.currency===void 0?"":e.currency[0]+"",n=e.currency===void 0?"":e.currency[1]+"",r=e.decimal===void 0?".":e.decimal+"",a=e.numerals===void 0?d_:NT(v_.call(e.numerals,String)),u=e.percent===void 0?"%":e.percent+"",c=e.minus===void 0?"-":e.minus+"",g=e.nan===void 0?"NaN":e.nan+"";function x(O){O=$d(O);var B=O.fill,W=O.align,ce=O.sign,oe=O.symbol,Te=O.zero,Ze=O.width,qe=O.comma,et=O.precision,yt=O.trim,bt=O.type;bt==="n"?(qe=!0,bt="g"):p_[bt]||(et===void 0&&(et=12),yt=!0,bt="g"),(Te||B==="0"&&W==="=")&&(Te=!0,B="0",W="=");var Ot=oe==="$"?t:oe==="#"&&/[boxX]/.test(bt)?"0"+bt.toLowerCase():"",jt=oe==="$"?n:/[%p]/.test(bt)?u:"",or=p_[bt],ar=/[defgprs%]/.test(bt);et=et===void 0?6:/[gprs]/.test(bt)?Math.max(1,Math.min(21,et)):Math.max(0,Math.min(20,et));function Sr(dr){var jr=Ot,nn=jt,En,_a,_s;if(bt==="c")nn=or(dr)+nn,dr="";else{dr=+dr;var ls=dr<0||1/dr<0;if(dr=isNaN(dr)?g:or(Math.abs(dr),et),yt&&(dr=FT(dr)),ls&&+dr==0&&ce!=="+"&&(ls=!1),jr=(ls?ce==="("?ce:c:ce==="-"||ce==="("?"":ce)+jr,nn=(bt==="s"?g_[8+h_/3]:"")+nn+(ls&&ce==="("?")":""),ar){for(En=-1,_a=dr.length;++En<_a;)if(_s=dr.charCodeAt(En),48>_s||_s>57){nn=(_s===46?r+dr.slice(En+1):dr.slice(En))+nn,dr=dr.slice(0,En);break}}}qe&&!Te&&(dr=i(dr,1/0));var Ds=jr.length+dr.length+nn.length,ks=Ds<Ze?new Array(Ze-Ds+1).join(B):"";switch(qe&&Te&&(dr=i(ks+dr,ks.length?Ze-nn.length:1/0),ks=""),W){case"<":dr=jr+dr+nn+ks;break;case"=":dr=jr+ks+dr+nn;break;case"^":dr=ks.slice(0,Ds=ks.length>>1)+jr+dr+nn+ks.slice(Ds);break;default:dr=ks+jr+dr+nn;break}return a(dr)}return Sr.toString=function(){return O+""},Sr}function M(O,B){var W=x((O=$d(O),O.type="f",O)),ce=Math.max(-8,Math.min(8,Math.floor(cA(B)/3)))*3,oe=Math.pow(10,-ce),Te=g_[8+ce/3];return function(Ze){return W(oe*Ze)+Te}}return{format:x,formatPrefix:M}}var Wd,Ig,m_;zT({decimal:".",thousands:",",grouping:[3],currency:["$",""],minus:"-"});function zT(e){return Wd=ZT(e),Ig=Wd.format,m_=Wd.formatPrefix,Wd}function UT(e,i){return e=Math.abs(e),i=Math.abs(i)-e,Math.max(0,cA(i)-cA(e))+1}function GT(e){return Math.max(0,-cA(Math.abs(e)))}function jT(e,i,t,n){var r=(0,Qu.ly)(e,i,t),a;switch(n=$d(n==null?",f":n),n.type){case"s":{var u=Math.max(Math.abs(e),Math.abs(i));return n.precision==null&&!isNaN(a=DT(r,u))&&(n.precision=a),m_(n,u)}case"":case"e":case"g":case"p":case"r":{n.precision==null&&!isNaN(a=UT(r,Math.max(Math.abs(e),Math.abs(i))))&&(n.precision=a-(n.type==="e"));break}case"f":case"%":{n.precision==null&&!isNaN(a=GT(r))&&(n.precision=a-(n.type==="%")*2);break}}return Ig(n)}function gp(e){var i=e.domain;return e.ticks=function(t){var n=i();return(0,Qu.sd)(n[0],n[n.length-1],t==null?10:t)},e.tickFormat=function(t,n){var r=i();return jT(r[0],r[r.length-1],t==null?10:t,n)},e.nice=function(t){t==null&&(t=10);var n=i(),r=0,a=n.length-1,u=n[r],c=n[a],g;return c<u&&(g=u,u=c,c=g,g=r,r=a,a=g),g=(0,Qu.G9)(u,c,t),g>0?(u=Math.floor(u/g)*g,c=Math.ceil(c/g)*g,g=(0,Qu.G9)(u,c,t)):g<0&&(u=Math.ceil(u*g)/g,c=Math.floor(c*g)/g,g=(0,Qu.G9)(u,c,t)),g>0?(n[r]=Math.floor(u/g)*g,n[a]=Math.ceil(c/g)*g,i(n)):g<0&&(n[r]=Math.ceil(u*g)/g,n[a]=Math.floor(c*g)/g,i(n)),e},e}function y_(){var e=f_(fl,fl);return e.copy=function(){return Hd(e,y_())},B0.apply(e,arguments),gp(e)}function VT(e){var i;function t(n){return isNaN(n=+n)?i:n}return t.invert=t,t.domain=t.range=function(n){return arguments.length?(e=map.call(n,number),t):e.slice()},t.unknown=function(n){return arguments.length?(i=n,t):i},t.copy=function(){return VT(e).unknown(i)},e=arguments.length?map.call(e,number):[0,1],linearish(t)}function __(e,i){e=e.slice();var t=0,n=e.length-1,r=e[t],a=e[n],u;return a<r&&(u=t,t=n,n=u,u=r,r=a,a=u),e[t]=i.floor(r),e[n]=i.ceil(a),e}function x_(e){return Math.log(e)}function E_(e){return Math.exp(e)}function HT(e){return-Math.log(-e)}function $T(e){return-Math.exp(-e)}function YT(e){return isFinite(e)?+("1e"+e):e<0?0:e}function WT(e){return e===10?YT:e===Math.E?Math.exp:function(i){return Math.pow(e,i)}}function XT(e){return e===Math.E?Math.log:e===10&&Math.log10||e===2&&Math.log2||(e=Math.log(e),function(i){return Math.log(i)/e})}function b_(e){return function(i){return-e(-i)}}function QT(e){var i=e(x_,E_),t=i.domain,n=10,r,a;function u(){return r=XT(n),a=WT(n),t()[0]<0?(r=b_(r),a=b_(a),e(HT,$T)):e(x_,E_),i}return i.base=function(c){return arguments.length?(n=+c,u()):n},i.domain=function(c){return arguments.length?(t(c),u()):t()},i.ticks=function(c){var g=t(),x=g[0],M=g[g.length-1],O;(O=M<x)&&(B=x,x=M,M=B);var B=r(x),W=r(M),ce,oe,Te,Ze=c==null?10:+c,qe=[];if(!(n%1)&&W-B<Ze){if(B=Math.round(B)-1,W=Math.round(W)+1,x>0){for(;B<W;++B)for(oe=1,ce=a(B);oe<n;++oe)if(Te=ce*oe,!(Te<x)){if(Te>M)break;qe.push(Te)}}else for(;B<W;++B)for(oe=n-1,ce=a(B);oe>=1;--oe)if(Te=ce*oe,!(Te<x)){if(Te>M)break;qe.push(Te)}}else qe=(0,Qu.sd)(B,W,Math.min(W-B,Ze)).map(a);return O?qe.reverse():qe},i.tickFormat=function(c,g){if(g==null&&(g=n===10?".0e":","),typeof g!="function"&&(g=Ig(g)),c===1/0)return g;c==null&&(c=10);var x=Math.max(1,n*c/i.ticks().length);return function(M){var O=M/a(Math.round(r(M)));return O*n<n-.5&&(O*=n),O<=x?g(M):""}},i.nice=function(){return t(__(t(),{floor:function(c){return a(Math.floor(r(c)))},ceil:function(c){return a(Math.ceil(r(c)))}}))},i}function S_(){var e=QT(Tg()).domain([1,10]);return e.copy=function(){return Hd(e,S_()).base(e.base())},B0.apply(e,arguments),e}function C_(e){return function(i){return Math.sign(i)*Math.log1p(Math.abs(i/e))}}function w_(e){return function(i){return Math.sign(i)*Math.expm1(Math.abs(i))*e}}function qT(e){var i=1,t=e(C_(i),w_(i));return t.constant=function(n){return arguments.length?e(C_(i=+n),w_(i)):i},linearish(t)}function KT(){var e=qT(transformer());return e.copy=function(){return copy(e,KT()).constant(e.constant())},initRange.apply(e,arguments)}function T_(e){return function(i){return i<0?-Math.pow(-i,e):Math.pow(i,e)}}function JT(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function eM(e){return e<0?-e*e:e*e}function tM(e){var i=e(fl,fl),t=1;function n(){return t===1?e(fl,fl):t===.5?e(JT,eM):e(T_(t),T_(1/t))}return i.exponent=function(r){return arguments.length?(t=+r,n()):t},gp(i)}function Pg(){var e=tM(Tg());return e.copy=function(){return Hd(e,Pg()).exponent(e.exponent())},B0.apply(e,arguments),e}function RL(){return Pg.apply(null,arguments).exponent(.5)}function M_(){var e=[],i=[],t=[],n;function r(){var u=0,c=Math.max(1,i.length);for(t=new Array(c-1);++u<c;)t[u-1]=(0,Qu.VR)(e,u/c);return a}function a(u){return isNaN(u=+u)?n:i[(0,Qu.b4)(t,u)]}return a.invertExtent=function(u){var c=i.indexOf(u);return c<0?[NaN,NaN]:[c>0?t[c-1]:e[0],c<t.length?t[c]:e[e.length-1]]},a.domain=function(u){if(!arguments.length)return e.slice();e=[];for(var c=0,g=u.length,x;c<g;++c)x=u[c],x!=null&&!isNaN(x=+x)&&e.push(x);return e.sort(Qu.j2),r()},a.range=function(u){return arguments.length?(i=dh.call(u),r()):i.slice()},a.unknown=function(u){return arguments.length?(n=u,a):n},a.quantiles=function(){return t.slice()},a.copy=function(){return M_().domain(e).range(i).unknown(n)},B0.apply(a,arguments)}function I_(){var e=0,i=1,t=1,n=[.5],r=[0,1],a;function u(g){return g<=g?r[(0,Qu.b4)(n,g,0,t)]:a}function c(){var g=-1;for(n=new Array(t);++g<t;)n[g]=((g+1)*i-(g-t)*e)/(t+1);return u}return u.domain=function(g){return arguments.length?(e=+g[0],i=+g[1],c()):[e,i]},u.range=function(g){return arguments.length?(t=(r=dh.call(g)).length-1,c()):r.slice()},u.invertExtent=function(g){var x=r.indexOf(g);return x<0?[NaN,NaN]:x<1?[e,n[0]]:x>=t?[n[t-1],i]:[n[x-1],n[x]]},u.unknown=function(g){return arguments.length&&(a=g),u},u.thresholds=function(){return n.slice()},u.copy=function(){return I_().domain([e,i]).range(r).unknown(a)},B0.apply(gp(u),arguments)}function P_(){var e=[.5],i=[0,1],t,n=1;function r(a){return a<=a?i[(0,Qu.b4)(e,a,0,n)]:t}return r.domain=function(a){return arguments.length?(e=dh.call(a),n=Math.min(e.length,i.length-1),r):e.slice()},r.range=function(a){return arguments.length?(i=dh.call(a),n=Math.min(e.length,i.length-1),r):i.slice()},r.invertExtent=function(a){var u=i.indexOf(a);return[e[u-1],e[u]]},r.unknown=function(a){return arguments.length?(t=a,r):t},r.copy=function(){return P_().domain(e).range(i).unknown(t)},B0.apply(r,arguments)}var Lg=new Date,Og=new Date;function Il(e,i,t,n){function r(a){return e(a=arguments.length===0?new Date:new Date(+a)),a}return r.floor=function(a){return e(a=new Date(+a)),a},r.ceil=function(a){return e(a=new Date(a-1)),i(a,1),e(a),a},r.round=function(a){var u=r(a),c=r.ceil(a);return a-u<c-a?u:c},r.offset=function(a,u){return i(a=new Date(+a),u==null?1:Math.floor(u)),a},r.range=function(a,u,c){var g=[],x;if(a=r.ceil(a),c=c==null?1:Math.floor(c),!(a<u)||!(c>0))return g;do g.push(x=new Date(+a)),i(a,c),e(a);while(x<a&&a<u);return g},r.filter=function(a){return Il(function(u){if(u>=u)for(;e(u),!a(u);)u.setTime(u-1)},function(u,c){if(u>=u)if(c<0)for(;++c<=0;)for(;i(u,-1),!a(u););else for(;--c>=0;)for(;i(u,1),!a(u););})},t&&(r.count=function(a,u){return Lg.setTime(+a),Og.setTime(+u),e(Lg),e(Og),Math.floor(t(Lg,Og))},r.every=function(a){return a=Math.floor(a),!isFinite(a)||!(a>0)?null:a>1?r.filter(n?function(u){return n(u)%a===0}:function(u){return r.count(0,u)%a===0}):r}),r}var Rg=Il(function(e){e.setMonth(0,1),e.setHours(0,0,0,0)},function(e,i){e.setFullYear(e.getFullYear()+i)},function(e,i){return i.getFullYear()-e.getFullYear()},function(e){return e.getFullYear()});Rg.every=function(e){return!isFinite(e=Math.floor(e))||!(e>0)?null:Il(function(i){i.setFullYear(Math.floor(i.getFullYear()/e)*e),i.setMonth(0,1),i.setHours(0,0,0,0)},function(i,t){i.setFullYear(i.getFullYear()+t*e)})};var fA=Rg,DL=Rg.range,L_=Il(function(e){e.setDate(1),e.setHours(0,0,0,0)},function(e,i){e.setMonth(e.getMonth()+i)},function(e,i){return i.getMonth()-e.getMonth()+(i.getFullYear()-e.getFullYear())*12},function(e){return e.getMonth()}),rM=L_,kL=L_.range,Xd=1e3,mp=6e4,O_=36e5,R_=864e5,D_=6048e5;function vh(e){return Il(function(i){i.setDate(i.getDate()-(i.getDay()+7-e)%7),i.setHours(0,0,0,0)},function(i,t){i.setDate(i.getDate()+t*7)},function(i,t){return(t-i-(t.getTimezoneOffset()-i.getTimezoneOffset())*mp)/D_})}var Dg=vh(0),Qd=vh(1),nM=vh(2),iM=vh(3),hA=vh(4),aM=vh(5),oM=vh(6),NL=Dg.range,FL=Qd.range,BL=nM.range,ZL=iM.range,zL=hA.range,UL=aM.range,GL=oM.range,k_=Il(function(e){e.setHours(0,0,0,0)},function(e,i){e.setDate(e.getDate()+i)},function(e,i){return(i-e-(i.getTimezoneOffset()-e.getTimezoneOffset())*mp)/R_},function(e){return e.getDate()-1}),kg=k_,jL=k_.range,N_=Il(function(e){e.setTime(e-e.getMilliseconds()-e.getSeconds()*Xd-e.getMinutes()*mp)},function(e,i){e.setTime(+e+i*O_)},function(e,i){return(i-e)/O_},function(e){return e.getHours()}),sM=N_,VL=N_.range,F_=Il(function(e){e.setTime(e-e.getMilliseconds()-e.getSeconds()*Xd)},function(e,i){e.setTime(+e+i*mp)},function(e,i){return(i-e)/mp},function(e){return e.getMinutes()}),uM=F_,HL=F_.range,B_=Il(function(e){e.setTime(e-e.getMilliseconds())},function(e,i){e.setTime(+e+i*Xd)},function(e,i){return(i-e)/Xd},function(e){return e.getUTCSeconds()}),lM=B_,$L=B_.range,qd=Il(function(){},function(e,i){e.setTime(+e+i)},function(e,i){return i-e});qd.every=function(e){return e=Math.floor(e),!isFinite(e)||!(e>0)?null:e>1?Il(function(i){i.setTime(Math.floor(i/e)*e)},function(i,t){i.setTime(+i+t*e)},function(i,t){return(t-i)/e}):qd};var cM=qd,YL=qd.range;function gh(e){return Il(function(i){i.setUTCDate(i.getUTCDate()-(i.getUTCDay()+7-e)%7),i.setUTCHours(0,0,0,0)},function(i,t){i.setUTCDate(i.getUTCDate()+t*7)},function(i,t){return(t-i)/D_})}var Z_=gh(0),Kd=gh(1),fM=gh(2),hM=gh(3),AA=gh(4),AM=gh(5),pM=gh(6),WL=Z_.range,XL=Kd.range,QL=fM.range,qL=hM.range,KL=AA.range,JL=AM.range,e8=pM.range,z_=Il(function(e){e.setUTCHours(0,0,0,0)},function(e,i){e.setUTCDate(e.getUTCDate()+i)},function(e,i){return(i-e)/R_},function(e){return e.getUTCDate()-1}),U_=z_,t8=z_.range,Ng=Il(function(e){e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},function(e,i){e.setUTCFullYear(e.getUTCFullYear()+i)},function(e,i){return i.getUTCFullYear()-e.getUTCFullYear()},function(e){return e.getUTCFullYear()});Ng.every=function(e){return!isFinite(e=Math.floor(e))||!(e>0)?null:Il(function(i){i.setUTCFullYear(Math.floor(i.getUTCFullYear()/e)*e),i.setUTCMonth(0,1),i.setUTCHours(0,0,0,0)},function(i,t){i.setUTCFullYear(i.getUTCFullYear()+t*e)})};var yp=Ng,r8=Ng.range;function Fg(e){if(0<=e.y&&e.y<100){var i=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return i.setFullYear(e.y),i}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function Bg(e){if(0<=e.y&&e.y<100){var i=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return i.setUTCFullYear(e.y),i}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function _p(e,i,t){return{y:e,m:i,d:t,H:0,M:0,S:0,L:0}}function dM(e){var i=e.dateTime,t=e.date,n=e.time,r=e.periods,a=e.days,u=e.shortDays,c=e.months,g=e.shortMonths,x=xp(r),M=Ep(r),O=xp(a),B=Ep(a),W=xp(u),ce=Ep(u),oe=xp(c),Te=Ep(c),Ze=xp(g),qe=Ep(g),et={a:ls,A:Ds,b:ks,B:Wc,c:null,d:Y_,e:Y_,f:BM,g:WM,G:QM,H:kM,I:NM,j:FM,L:W_,m:ZM,M:zM,p:Dp,q:mA,Q:e2,s:t2,S:UM,u:GM,U:jM,V:VM,w:HM,W:$M,x:null,X:null,y:YM,Y:XM,Z:qM,"%":J_},yt={a:Xg,A:oP,b:sP,B:uP,c:null,d:Q_,e:Q_,f:tI,g:fI,G:AI,H:KM,I:JM,j:eI,L:q_,m:rI,M:nI,p:lP,q:cP,Q:e2,s:t2,S:iI,u:aI,U:oI,V:sI,w:uI,W:lI,x:null,X:null,y:cI,Y:hI,Z:pI,"%":J_},bt={a:Sr,A:dr,b:jr,B:nn,c:En,d:H_,e:H_,f:LM,g:V_,G:j_,H:$_,I:$_,j:TM,L:PM,m:wM,M:MM,p:ar,q:CM,Q:RM,s:DM,S:IM,u:_M,U:xM,V:EM,w:yM,W:bM,x:_a,X:_s,y:V_,Y:j_,Z:SM,"%":OM};et.x=Ot(t,et),et.X=Ot(n,et),et.c=Ot(i,et),yt.x=Ot(t,yt),yt.X=Ot(n,yt),yt.c=Ot(i,yt);function Ot(ei,Ba){return function(to){var fn=[],Jl=-1,Ho=0,dc=ei.length,vc,xh,Cx;for(to instanceof Date||(to=new Date(+to));++Jl<dc;)ei.charCodeAt(Jl)===37&&(fn.push(ei.slice(Ho,Jl)),(xh=G_[vc=ei.charAt(++Jl)])!=null?vc=ei.charAt(++Jl):xh=vc==="e"?" ":"0",(Cx=Ba[vc])&&(vc=Cx(to,xh)),fn.push(vc),Ho=Jl+1);return fn.push(ei.slice(Ho,Jl)),fn.join("")}}function jt(ei,Ba){return function(to){var fn=_p(1900,void 0,1),Jl=or(fn,ei,to+="",0),Ho,dc;if(Jl!=to.length)return null;if("Q"in fn)return new Date(fn.Q);if("s"in fn)return new Date(fn.s*1e3+("L"in fn?fn.L:0));if(Ba&&!("Z"in fn)&&(fn.Z=0),"p"in fn&&(fn.H=fn.H%12+fn.p*12),fn.m===void 0&&(fn.m="q"in fn?fn.q:0),"V"in fn){if(fn.V<1||fn.V>53)return null;"w"in fn||(fn.w=1),"Z"in fn?(Ho=Bg(_p(fn.y,0,1)),dc=Ho.getUTCDay(),Ho=dc>4||dc===0?Kd.ceil(Ho):Kd(Ho),Ho=U_.offset(Ho,(fn.V-1)*7),fn.y=Ho.getUTCFullYear(),fn.m=Ho.getUTCMonth(),fn.d=Ho.getUTCDate()+(fn.w+6)%7):(Ho=Fg(_p(fn.y,0,1)),dc=Ho.getDay(),Ho=dc>4||dc===0?Qd.ceil(Ho):Qd(Ho),Ho=kg.offset(Ho,(fn.V-1)*7),fn.y=Ho.getFullYear(),fn.m=Ho.getMonth(),fn.d=Ho.getDate()+(fn.w+6)%7)}else("W"in fn||"U"in fn)&&("w"in fn||(fn.w="u"in fn?fn.u%7:"W"in fn?1:0),dc="Z"in fn?Bg(_p(fn.y,0,1)).getUTCDay():Fg(_p(fn.y,0,1)).getDay(),fn.m=0,fn.d="W"in fn?(fn.w+6)%7+fn.W*7-(dc+5)%7:fn.w+fn.U*7-(dc+6)%7);return"Z"in fn?(fn.H+=fn.Z/100|0,fn.M+=fn.Z%100,Bg(fn)):Fg(fn)}}function or(ei,Ba,to,fn){for(var Jl=0,Ho=Ba.length,dc=to.length,vc,xh;Jl<Ho;){if(fn>=dc)return-1;if(vc=Ba.charCodeAt(Jl++),vc===37){if(vc=Ba.charAt(Jl++),xh=bt[vc in G_?Ba.charAt(Jl++):vc],!xh||(fn=xh(ei,to,fn))<0)return-1}else if(vc!=to.charCodeAt(fn++))return-1}return fn}function ar(ei,Ba,to){var fn=x.exec(Ba.slice(to));return fn?(ei.p=M[fn[0].toLowerCase()],to+fn[0].length):-1}function Sr(ei,Ba,to){var fn=W.exec(Ba.slice(to));return fn?(ei.w=ce[fn[0].toLowerCase()],to+fn[0].length):-1}function dr(ei,Ba,to){var fn=O.exec(Ba.slice(to));return fn?(ei.w=B[fn[0].toLowerCase()],to+fn[0].length):-1}function jr(ei,Ba,to){var fn=Ze.exec(Ba.slice(to));return fn?(ei.m=qe[fn[0].toLowerCase()],to+fn[0].length):-1}function nn(ei,Ba,to){var fn=oe.exec(Ba.slice(to));return fn?(ei.m=Te[fn[0].toLowerCase()],to+fn[0].length):-1}function En(ei,Ba,to){return or(ei,i,Ba,to)}function _a(ei,Ba,to){return or(ei,t,Ba,to)}function _s(ei,Ba,to){return or(ei,n,Ba,to)}function ls(ei){return u[ei.getDay()]}function Ds(ei){return a[ei.getDay()]}function ks(ei){return g[ei.getMonth()]}function Wc(ei){return c[ei.getMonth()]}function Dp(ei){return r[+(ei.getHours()>=12)]}function mA(ei){return 1+~~(ei.getMonth()/3)}function Xg(ei){return u[ei.getUTCDay()]}function oP(ei){return a[ei.getUTCDay()]}function sP(ei){return g[ei.getUTCMonth()]}function uP(ei){return c[ei.getUTCMonth()]}function lP(ei){return r[+(ei.getUTCHours()>=12)]}function cP(ei){return 1+~~(ei.getUTCMonth()/3)}return{format:function(ei){var Ba=Ot(ei+="",et);return Ba.toString=function(){return ei},Ba},parse:function(ei){var Ba=jt(ei+="",!1);return Ba.toString=function(){return ei},Ba},utcFormat:function(ei){var Ba=Ot(ei+="",yt);return Ba.toString=function(){return ei},Ba},utcParse:function(ei){var Ba=jt(ei+="",!0);return Ba.toString=function(){return ei},Ba}}}var G_={"-":"",_:" ",0:"0"},Lu=/^\s*\d+/,vM=/^%/,gM=/[\\^$*+?|[\]().{}]/g;function eo(e,i,t){var n=e<0?"-":"",r=(n?-e:e)+"",a=r.length;return n+(a<t?new Array(t-a+1).join(i)+r:r)}function mM(e){return e.replace(gM,"\\$&")}function xp(e){return new RegExp("^(?:"+e.map(mM).join("|")+")","i")}function Ep(e){for(var i={},t=-1,n=e.length;++t<n;)i[e[t].toLowerCase()]=t;return i}function yM(e,i,t){var n=Lu.exec(i.slice(t,t+1));return n?(e.w=+n[0],t+n[0].length):-1}function _M(e,i,t){var n=Lu.exec(i.slice(t,t+1));return n?(e.u=+n[0],t+n[0].length):-1}function xM(e,i,t){var n=Lu.exec(i.slice(t,t+2));return n?(e.U=+n[0],t+n[0].length):-1}function EM(e,i,t){var n=Lu.exec(i.slice(t,t+2));return n?(e.V=+n[0],t+n[0].length):-1}function bM(e,i,t){var n=Lu.exec(i.slice(t,t+2));return n?(e.W=+n[0],t+n[0].length):-1}function j_(e,i,t){var n=Lu.exec(i.slice(t,t+4));return n?(e.y=+n[0],t+n[0].length):-1}function V_(e,i,t){var n=Lu.exec(i.slice(t,t+2));return n?(e.y=+n[0]+(+n[0]>68?1900:2e3),t+n[0].length):-1}function SM(e,i,t){var n=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(i.slice(t,t+6));return n?(e.Z=n[1]?0:-(n[2]+(n[3]||"00")),t+n[0].length):-1}function CM(e,i,t){var n=Lu.exec(i.slice(t,t+1));return n?(e.q=n[0]*3-3,t+n[0].length):-1}function wM(e,i,t){var n=Lu.exec(i.slice(t,t+2));return n?(e.m=n[0]-1,t+n[0].length):-1}function H_(e,i,t){var n=Lu.exec(i.slice(t,t+2));return n?(e.d=+n[0],t+n[0].length):-1}function TM(e,i,t){var n=Lu.exec(i.slice(t,t+3));return n?(e.m=0,e.d=+n[0],t+n[0].length):-1}function $_(e,i,t){var n=Lu.exec(i.slice(t,t+2));return n?(e.H=+n[0],t+n[0].length):-1}function MM(e,i,t){var n=Lu.exec(i.slice(t,t+2));return n?(e.M=+n[0],t+n[0].length):-1}function IM(e,i,t){var n=Lu.exec(i.slice(t,t+2));return n?(e.S=+n[0],t+n[0].length):-1}function PM(e,i,t){var n=Lu.exec(i.slice(t,t+3));return n?(e.L=+n[0],t+n[0].length):-1}function LM(e,i,t){var n=Lu.exec(i.slice(t,t+6));return n?(e.L=Math.floor(n[0]/1e3),t+n[0].length):-1}function OM(e,i,t){var n=vM.exec(i.slice(t,t+1));return n?t+n[0].length:-1}function RM(e,i,t){var n=Lu.exec(i.slice(t));return n?(e.Q=+n[0],t+n[0].length):-1}function DM(e,i,t){var n=Lu.exec(i.slice(t));return n?(e.s=+n[0],t+n[0].length):-1}function Y_(e,i){return eo(e.getDate(),i,2)}function kM(e,i){return eo(e.getHours(),i,2)}function NM(e,i){return eo(e.getHours()%12||12,i,2)}function FM(e,i){return eo(1+kg.count(fA(e),e),i,3)}function W_(e,i){return eo(e.getMilliseconds(),i,3)}function BM(e,i){return W_(e,i)+"000"}function ZM(e,i){return eo(e.getMonth()+1,i,2)}function zM(e,i){return eo(e.getMinutes(),i,2)}function UM(e,i){return eo(e.getSeconds(),i,2)}function GM(e){var i=e.getDay();return i===0?7:i}function jM(e,i){return eo(Dg.count(fA(e)-1,e),i,2)}function X_(e){var i=e.getDay();return i>=4||i===0?hA(e):hA.ceil(e)}function VM(e,i){return e=X_(e),eo(hA.count(fA(e),e)+(fA(e).getDay()===4),i,2)}function HM(e){return e.getDay()}function $M(e,i){return eo(Qd.count(fA(e)-1,e),i,2)}function YM(e,i){return eo(e.getFullYear()%100,i,2)}function WM(e,i){return e=X_(e),eo(e.getFullYear()%100,i,2)}function XM(e,i){return eo(e.getFullYear()%1e4,i,4)}function QM(e,i){var t=e.getDay();return e=t>=4||t===0?hA(e):hA.ceil(e),eo(e.getFullYear()%1e4,i,4)}function qM(e){var i=e.getTimezoneOffset();return(i>0?"-":(i*=-1,"+"))+eo(i/60|0,"0",2)+eo(i%60,"0",2)}function Q_(e,i){return eo(e.getUTCDate(),i,2)}function KM(e,i){return eo(e.getUTCHours(),i,2)}function JM(e,i){return eo(e.getUTCHours()%12||12,i,2)}function eI(e,i){return eo(1+U_.count(yp(e),e),i,3)}function q_(e,i){return eo(e.getUTCMilliseconds(),i,3)}function tI(e,i){return q_(e,i)+"000"}function rI(e,i){return eo(e.getUTCMonth()+1,i,2)}function nI(e,i){return eo(e.getUTCMinutes(),i,2)}function iI(e,i){return eo(e.getUTCSeconds(),i,2)}function aI(e){var i=e.getUTCDay();return i===0?7:i}function oI(e,i){return eo(Z_.count(yp(e)-1,e),i,2)}function K_(e){var i=e.getUTCDay();return i>=4||i===0?AA(e):AA.ceil(e)}function sI(e,i){return e=K_(e),eo(AA.count(yp(e),e)+(yp(e).getUTCDay()===4),i,2)}function uI(e){return e.getUTCDay()}function lI(e,i){return eo(Kd.count(yp(e)-1,e),i,2)}function cI(e,i){return eo(e.getUTCFullYear()%100,i,2)}function fI(e,i){return e=K_(e),eo(e.getUTCFullYear()%100,i,2)}function hI(e,i){return eo(e.getUTCFullYear()%1e4,i,4)}function AI(e,i){var t=e.getUTCDay();return e=t>=4||t===0?AA(e):AA.ceil(e),eo(e.getUTCFullYear()%1e4,i,4)}function pI(){return"+0000"}function J_(){return"%"}function e2(e){return+e}function t2(e){return Math.floor(+e/1e3)}var pA,r2,dI,vI,gI;mI({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function mI(e){return pA=dM(e),r2=pA.format,dI=pA.parse,vI=pA.utcFormat,gI=pA.utcParse,pA}var bp=1e3,Sp=bp*60,Cp=Sp*60,wp=Cp*24,yI=wp*7,n2=wp*30,Zg=wp*365;function _I(e){return new Date(e)}function xI(e){return e instanceof Date?+e:+new Date(+e)}function i2(e,i,t,n,r,a,u,c,g){var x=f_(fl,fl),M=x.invert,O=x.domain,B=g(".%L"),W=g(":%S"),ce=g("%I:%M"),oe=g("%I %p"),Te=g("%a %d"),Ze=g("%b %d"),qe=g("%B"),et=g("%Y"),yt=[[u,1,bp],[u,5,5*bp],[u,15,15*bp],[u,30,30*bp],[a,1,Sp],[a,5,5*Sp],[a,15,15*Sp],[a,30,30*Sp],[r,1,Cp],[r,3,3*Cp],[r,6,6*Cp],[r,12,12*Cp],[n,1,wp],[n,2,2*wp],[t,1,yI],[i,1,n2],[i,3,3*n2],[e,1,Zg]];function bt(jt){return(u(jt)<jt?B:a(jt)<jt?W:r(jt)<jt?ce:n(jt)<jt?oe:i(jt)<jt?t(jt)<jt?Te:Ze:e(jt)<jt?qe:et)(jt)}function Ot(jt,or,ar,Sr){if(jt==null&&(jt=10),typeof jt=="number"){var dr=Math.abs(ar-or)/jt,jr=(0,Qu.YF)(function(nn){return nn[2]}).right(yt,dr);jr===yt.length?(Sr=(0,Qu.ly)(or/Zg,ar/Zg,jt),jt=e):jr?(jr=yt[dr/yt[jr-1][2]<yt[jr][2]/dr?jr-1:jr],Sr=jr[1],jt=jr[0]):(Sr=Math.max((0,Qu.ly)(or,ar,jt),1),jt=c)}return Sr==null?jt:jt.every(Sr)}return x.invert=function(jt){return new Date(M(jt))},x.domain=function(jt){return arguments.length?O(n_.call(jt,xI)):O().map(_I)},x.ticks=function(jt,or){var ar=O(),Sr=ar[0],dr=ar[ar.length-1],jr=dr<Sr,nn;return jr&&(nn=Sr,Sr=dr,dr=nn),nn=Ot(jt,Sr,dr,or),nn=nn?nn.range(Sr,dr+1):[],jr?nn.reverse():nn},x.tickFormat=function(jt,or){return or==null?bt:g(or)},x.nice=function(jt,or){var ar=O();return(jt=Ot(jt,ar[0],ar[ar.length-1],or))?O(__(ar,jt)):x},x.copy=function(){return Hd(x,i2(e,i,t,n,r,a,u,c,g))},x}function EI(){return B0.apply(i2(fA,rM,Dg,kg,sM,uM,lM,cM,r2).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function n8(){return initRange.apply(calendar(utcYear,utcMonth,utcWeek,utcDay,utcHour,utcMinute,utcSecond,utcMillisecond,utcFormat).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function Jd(){var e=0,i=1,t,n,r,a,u=fl,c=!1,g;function x(M){return isNaN(M=+M)?g:u(r===0?.5:(M=(a(M)-t)*r,c?Math.max(0,Math.min(1,M)):M))}return x.domain=function(M){return arguments.length?(t=a(e=+M[0]),n=a(i=+M[1]),r=t===n?0:1/(n-t),x):[e,i]},x.clamp=function(M){return arguments.length?(c=!!M,x):c},x.interpolator=function(M){return arguments.length?(u=M,x):u},x.unknown=function(M){return arguments.length?(g=M,x):g},function(M){return a=M,t=M(e),n=M(i),r=t===n?0:1/(n-t),x}}function Tp(e,i){return i.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function a2(){var e=gp(Jd()(fl));return e.copy=function(){return Tp(e,a2())},i_.apply(e,arguments)}function bI(){var e=loggish(Jd()).domain([1,10]);return e.copy=function(){return Tp(e,bI()).base(e.base())},initInterpolator.apply(e,arguments)}function SI(){var e=symlogish(Jd());return e.copy=function(){return Tp(e,SI()).constant(e.constant())},initInterpolator.apply(e,arguments)}function o2(){var e=powish(Jd());return e.copy=function(){return Tp(e,o2()).exponent(e.exponent())},initInterpolator.apply(e,arguments)}function i8(){return o2.apply(null,arguments).exponent(.5)}function CI(){var e=[],i=identity;function t(n){if(!isNaN(n=+n))return i((bisect(e,n)-1)/(e.length-1))}return t.domain=function(n){if(!arguments.length)return e.slice();e=[];for(var r=0,a=n.length,u;r<a;++r)u=n[r],u!=null&&!isNaN(u=+u)&&e.push(u);return e.sort(ascending),t},t.interpolator=function(n){return arguments.length?(i=n,t):i},t.copy=function(){return CI(i).domain(e)},initInterpolator.apply(t,arguments)}function ev(){var e=0,i=.5,t=1,n,r,a,u,c,g=fl,x,M=!1,O;function B(W){return isNaN(W=+W)?O:(W=.5+((W=+x(W))-r)*(W<r?u:c),g(M?Math.max(0,Math.min(1,W)):W))}return B.domain=function(W){return arguments.length?(n=x(e=+W[0]),r=x(i=+W[1]),a=x(t=+W[2]),u=n===r?0:.5/(r-n),c=r===a?0:.5/(a-r),B):[e,i,t]},B.clamp=function(W){return arguments.length?(M=!!W,B):M},B.interpolator=function(W){return arguments.length?(g=W,B):g},B.unknown=function(W){return arguments.length?(O=W,B):O},function(W){return x=W,n=W(e),r=W(i),a=W(t),u=n===r?0:.5/(r-n),c=r===a?0:.5/(a-r),B}}function s2(){var e=gp(ev()(fl));return e.copy=function(){return Tp(e,s2())},i_.apply(e,arguments)}function wI(){var e=loggish(ev()).domain([.1,1,10]);return e.copy=function(){return copy(e,wI()).base(e.base())},initInterpolator.apply(e,arguments)}function TI(){var e=symlogish(ev());return e.copy=function(){return copy(e,TI()).constant(e.constant())},initInterpolator.apply(e,arguments)}function u2(){var e=powish(ev());return e.copy=function(){return copy(e,u2()).exponent(e.exponent())},initInterpolator.apply(e,arguments)}function a8(){return u2.apply(null,arguments).exponent(.5)}function l2(e){var i,t=[];function n(r){return r==null?i:r}return n.invert=n,n.domain=n.range=function(r){return r?(t=r,r):t},n.unknown=function(r){return r?(i=r,r):i},n.copy=function(){return l2(e).unknown(i)},n}var pc,c2,f2,zg=In.isNil,MI=In.isString,II=In.uniq,PI=/^(?:(?!0000)[0-9]{4}([-/.]+)(?:(?:0?[1-9]|1[0-2])\1(?:0?[1-9]|1[0-9]|2[0-8])|(?:0?[13-9]|1[0-2])\1(?:29|30)|(?:0?[13578]|1[02])\1(?:31))|(?:[0-9]{2}(?:0[48]|[2468][048]|[13579][26])|(?:0[48]|[2468][048]|[13579][26])00)([-/.]?)0?2\2(?:29))(\s+([01]|([01][0-9]|2[0-3])):([0-9]|[0-5][0-9]):([0-9]|[0-5][0-9]))?$/,LI=(pc={},(0,Me.Z)(pc,so.LINEAR,y_),(0,Me.Z)(pc,so.POWER,Pg),(0,Me.Z)(pc,so.LOG,S_),(0,Me.Z)(pc,so.IDENTITY,l2),(0,Me.Z)(pc,so.SEQUENTIAL,a2),(0,Me.Z)(pc,so.TIME,EI),(0,Me.Z)(pc,so.QUANTILE,M_),(0,Me.Z)(pc,so.QUANTIZE,I_),(0,Me.Z)(pc,so.THRESHOLD,P_),(0,Me.Z)(pc,so.CAT,jd),(0,Me.Z)(pc,so.DIVERGING,s2),pc),OI=(c2=(0,vr.b2)(),c2(f2=function(){function e(){(0,se.Z)(this,e),(0,Me.Z)(this,"scaleOptions",{})}return(0,be.Z)(e,[{key:"apply",value:function(t,n){var r=this,a=n.styleAttributeService;t.hooks.init.tapPromise("FeatureScalePlugin",(0,ur.Z)(it().mark(function u(){var c,g,x;return it().wrap(function(O){for(;;)switch(O.prev=O.next){case 0:if(t.log(Js.ScaleInitStart,us.INIT),r.scaleOptions=t.getScaleOptions(),g=a.getLayerStyleAttributes(),x=(c=t.getSource())===null||c===void 0?void 0:c.data.dataArray,!(Array.isArray(x)&&x.length===0)){O.next=8;break}return O.abrupt("return");case 8:r.caculateScalesForAttributes(g||[],x);case 9:t.log(Js.ScaleInitEnd,us.INIT);case 10:case"end":return O.stop()}},u)}))),t.hooks.beforeRenderData.tapPromise("FeatureScalePlugin",function(){var u=(0,ur.Z)(it().mark(function c(g){var x,M;return it().wrap(function(B){for(;;)switch(B.prev=B.next){case 0:if(g){B.next=2;break}return B.abrupt("return",g);case 2:if(t.log(Js.ScaleInitStart,us.UPDATE),r.scaleOptions=t.getScaleOptions(),x=a.getLayerStyleAttributes(),M=t.getSource().data.dataArray,!(Array.isArray(M)&&M.length===0)){B.next=8;break}return B.abrupt("return",!0);case 8:return r.caculateScalesForAttributes(x||[],M),t.log(Js.ScaleInitEnd,us.UPDATE),t.layerModelNeedUpdate=!0,B.abrupt("return",!0);case 12:case"end":return B.stop()}},c)}));return function(c){return u.apply(this,arguments)}}()),t.hooks.beforeRender.tap("FeatureScalePlugin",function(){if(!t.layerModelNeedUpdate){r.scaleOptions=t.getScaleOptions();var u=a.getLayerStyleAttributes(),c=t.getSource().data.dataArray;if(!(Array.isArray(c)&&c.length===0)&&u){var g=u.filter(function(x){return x.needRescale});g.length&&r.caculateScalesForAttributes(g,c)}}})}},{key:"isNumber",value:function(t){return!isNaN(parseFloat(t))&&isFinite(t)}},{key:"caculateScalesForAttributes",value:function(t,n){var r=this;t.forEach(function(a){if(a.scale){var u=a.scale,c=a.scale.field;u.names=r.parseFields(zg(c)?[]:c);var g=[];u.names.forEach(function(x){var M;g.push(r.createScale(x,a.name,(M=a.scale)===null||M===void 0?void 0:M.values,n))}),g.some(function(x){return x.type===rA.VARIABLE})?(u.type=rA.VARIABLE,g.forEach(function(x){if(!u.callback&&u.values!=="text"){var M;switch((M=x.option)===null||M===void 0?void 0:M.type){case so.LOG:case so.LINEAR:case so.POWER:if(u.values&&u.values.length>2){var O=x.scale.ticks(u.values.length);x.scale.domain(O)}u.values?x.scale.range(u.values):x.scale.range(x.option.domain);break;case so.QUANTILE:case so.QUANTIZE:case so.THRESHOLD:x.scale.range(u.values);break;case so.IDENTITY:break;case so.CAT:u.values?x.scale.range(u.values):x.scale.range(x.option.domain);break;case so.DIVERGING:case so.SEQUENTIAL:x.scale.interpolator(vT(u.values));break}}if(u.values==="text"){var B;x.scale.range((B=x.option)===null||B===void 0?void 0:B.domain)}})):(u.type=rA.CONSTANT,u.defaultValues=g.map(function(x,M){return x.scale(u.names[M])})),u.scalers=g.map(function(x){return{field:x.field,func:x.scale,option:x.option}}),a.needRescale=!1}})}},{key:"parseFields",value:function(t){return Array.isArray(t)?t:MI(t)?t.split("*"):[t]}},{key:"createScale",value:function(t,n,r,a){var u,c,g=this.scaleOptions[n]&&((u=this.scaleOptions[n])===null||u===void 0?void 0:u.field)===t?this.scaleOptions[n]:this.scaleOptions[t],x={field:t,scale:void 0,type:rA.VARIABLE,option:g};if(!a||!a.length)return g&&g.type?x.scale=this.createDefaultScale(g):(x.scale=jd([t]),x.type=rA.CONSTANT),x;var M=(c=a.find(function(W){return!zg(W[t])}))===null||c===void 0?void 0:c[t];if(this.isNumber(t)||zg(M)&&!g)x.scale=jd([t]),x.type=rA.CONSTANT;else{var O=g&&g.type||this.getDefaultType(M);r==="text"&&(O=so.CAT),r===void 0&&(O=so.IDENTITY);var B=this.createScaleConfig(O,t,g,a);x.scale=this.createDefaultScale(B),x.option=B}return x}},{key:"getDefaultType",value:function(t){var n=so.LINEAR;return typeof t=="string"&&(n=PI.test(t)?so.TIME:so.CAT),n}},{key:"createScaleConfig",value:function(t,n,r,a){var u={type:t},c=(a==null?void 0:a.map(function(M){return M[n]}))||[];if(r!=null&&r.domain)u.domain=r==null?void 0:r.domain;else if(t===so.CAT||t===so.IDENTITY)u.domain=II(c);else if(t===so.QUANTILE)u.domain=c;else if(t===so.DIVERGING){var g=(0,Qu.We)(c),x=(r==null?void 0:r.neutral)!==void 0?r==null?void 0:r.neutral:(g[0]+g[1])/2;u.domain=[g[0],x,g[1]]}else u.domain=(0,Qu.We)(c);return(0,X.Z)((0,X.Z)({},u),r)}},{key:"createDefaultScale",value:function(t){var n=t.type,r=t.domain,a=t.unknown,u=t.clamp,c=t.nice,g=LI[n]();return r&&g.domain&&g.domain(r),a&&g.unknown(a),u!==void 0&&g.clamp&&g.clamp(u),c!==void 0&&g.nice&&g.nice(c),g}}]),e}())||f2),h2,A2,RI=(h2=(0,vr.b2)(),h2(A2=function(){function e(){(0,se.Z)(this,e)}return(0,be.Z)(e,[{key:"apply",value:function(t){t.hooks.beforeRender.tap("LayerAnimateStylePlugin",function(){var n=t.animateStatus;n&&t.models.forEach(function(r){r.addUniforms((0,X.Z)({},t.layerModel.getAnimateUniforms()))})})}}]),e}())||A2),p2,d2,DI=(p2=(0,vr.b2)(),p2(d2=function(){function e(){(0,se.Z)(this,e)}return(0,be.Z)(e,[{key:"apply",value:function(t){t.hooks.afterInit.tap("LayerMaskPlugin",function(){var n=t.getLayerConfig(),r=n.maskLayers,a=n.enableMask;if(!t.tileLayer&&r&&r.length>0){var u;(u=t.masks).push.apply(u,(0,pr.Z)(r)),t.updateLayerConfig({mask:a})}})}}]),e}())||d2),kI=function(){function e(i){var t=i.rendererService,n=i.layerService,r=i.parent;(0,se.Z)(this,e),(0,Me.Z)(this,"tileResource",new Map),(0,Me.Z)(this,"layerTiles",[]),this.rendererService=t,this.layerService=n,this.parent=r}return(0,be.Z)(e,[{key:"tiles",get:function(){return this.layerTiles}},{key:"hasTile",value:function(t){return this.layerTiles.some(function(n){return n.key===t})}},{key:"addTile",value:function(t){this.layerTiles.push(t)}},{key:"getTile",value:function(t){return this.layerTiles.find(function(n){return n.key===t})}},{key:"getVisibleTileBylngLat",value:function(t){return this.layerTiles.find(function(n){return n.isLoaded&&n.visible&&n.lnglatInBounds(t)})}},{key:"removeTile",value:function(t){var n=this.layerTiles.findIndex(function(a){return a.key===t}),r=this.layerTiles.splice(n,1);r[0]&&r[0].destroy()}},{key:"updateTileVisible",value:function(t){var n=this.getTile(t.key);if(t.isVisible)if(t.parent){var r=this.isChildrenLoaded(t.parent);n==null||n.updateVisible(r)}else n==null||n.updateVisible(!0);else if(t.parent){var a=this.isChildrenLoaded(t.parent);n==null||n.updateVisible(!a)}else n==null||n.updateVisible(!1)}},{key:"isParentLoaded",value:function(t){var n=t.parent;if(!n)return!0;var r=this.getTile(n==null?void 0:n.key);return!!(r!=null&&r.isLoaded)}},{key:"isChildrenLoaded",value:function(t){var n=this,r=t==null?void 0:t.children;return r.length===0?!0:r.every(function(a){var u=n.getTile(a==null?void 0:a.key);return u?(u==null?void 0:u.isLoaded)===!0:!0})}},{key:"render",value:function(){var i=(0,ur.Z)(it().mark(function n(){var r=this,a,u;return it().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return a=this.getRenderLayers(),u=a.map(function(){var x=(0,ur.Z)(it().mark(function M(O){return it().wrap(function(W){for(;;)switch(W.prev=W.next){case 0:return W.next=2,r.layerService.renderTileLayer(O);case 2:case"end":return W.stop()}},M)}));return function(M){return x.apply(this,arguments)}}()),g.next=4,Promise.all(u);case 4:case"end":return g.stop()}},n,this)}));function t(){return i.apply(this,arguments)}return t}()},{key:"getRenderLayers",value:function(){var t=this.layerTiles.filter(function(r){return r.visible&&r.isLoaded}),n=[];return t.map(function(r){return n.push.apply(n,(0,pr.Z)(r.getLayers()))}),n}},{key:"getLayers",value:function(){var t=this.layerTiles.filter(function(r){return r.isLoaded}),n=[];return t.map(function(r){return n.push.apply(n,(0,pr.Z)(r.getLayers()))}),n}},{key:"getTiles",value:function(){return this.layerTiles}},{key:"destroy",value:function(){this.layerTiles.forEach(function(t){return t.destroy()}),this.tileResource.clear()}}]),e}(),NI=C(51287),FI=function(){function e(){(0,se.Z)(this,e)}return(0,be.Z)(e,[{key:"getCombineFeature",value:function(t){var n=null,r=t[0];return t.map(function(a){var u=Ts.yu(a.coordinates);n===null?n=u:n=(0,NI.Z)(n,u)}),r&&(n.properties=(0,X.Z)({},r)),n}}]),e}(),Mp="select",Ip="active",BI=function(){function e(i){var t=i.layerService,n=i.tileLayerService,r=i.parent;(0,se.Z)(this,e),(0,Me.Z)(this,"tilePickID",new Map),this.layerService=t,this.tileLayerService=n,this.parent=r,this.tileSourceService=new FI}return(0,be.Z)(e,[{key:"pickRender",value:function(t){var n=this.tileLayerService.getVisibleTileBylngLat(t.lngLat);if(n){var r=n.getMainLayer();r==null||r.layerPickService.pickRender(t)}}},{key:"pick",value:function(t,n){var r=this.parent.getContainer(),a=r.get(Xt.IPickingService);if(t.type==="RasterLayer"){var u=this.tileLayerService.getVisibleTileBylngLat(n.lngLat);if(u&&u.getMainLayer()!==void 0){var c=u.getMainLayer();return c.layerPickService.pickRasterLayer(c,n,this.parent)}return!1}return this.pickRender(n),a.pickFromPickingFBO(t,n)}},{key:"selectFeature",value:function(t){var n=(0,vn.Z)(t,3),r=n[0],a=n[1],u=n[2],c=this.color2PickId(r,a,u);this.tilePickID.set(Mp,c),this.updateHighLight(r,a,u,Mp)}},{key:"highlightPickedFeature",value:function(t){var n=(0,vn.Z)(t,3),r=n[0],a=n[1],u=n[2],c=this.color2PickId(r,a,u);this.tilePickID.set(Ip,c),this.updateHighLight(r,a,u,Ip)}},{key:"updateHighLight",value:function(t,n,r,a){this.tileLayerService.tiles.map(function(u){var c=u.getMainLayer();switch(a){case Mp:c==null||c.hooks.beforeSelect.call([t,n,r]);break;case Ip:c==null||c.hooks.beforeHighlight.call([t,n,r]);break}})}},{key:"setPickState",value:function(){var t=this.tilePickID.get(Mp),n=this.tilePickID.get(Ip);if(t){var r=this.pickId2Color(t),a=(0,vn.Z)(r,3),u=a[0],c=a[1],g=a[2];this.updateHighLight(u,c,g,Mp);return}if(n){var x=this.pickId2Color(n),M=(0,vn.Z)(x,3),O=M[0],B=M[1],W=M[2];this.updateHighLight(O,B,W,Ip);return}}},{key:"color2PickId",value:function(t,n,r){return io(new Uint8Array([t,n,r]))}},{key:"pickId2Color",value:function(t){return bs(t)}},{key:"getFeatureById",value:function(t){var n=this.tileLayerService.getTiles().filter(function(a){return a.visible}),r=[];return n.forEach(function(a){r.push.apply(r,(0,pr.Z)(a.getFeatureById(t)))}),r}},{key:"pickRasterLayer",value:function(t,n,r){return!1}}]),e}();function ZI(e){return e==="PolygonLayer"?_g:e==="LineLayer"?mg:Zd}function zI(e){return["PolygonLayer","LineLayer"].indexOf(e)!==-1}function UI(e){var i=GI();return function(){var n=(0,ue.Z)(e),r;if(i){var a=(0,ue.Z)(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return(0,ze.Z)(this,r)}}function GI(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var mh=function(e){(0,Ne.Z)(t,e);var i=UI(t);function t(n,r){var a;return(0,se.Z)(this,t),a=i.call(this),(0,Me.Z)((0,xt.Z)(a),"visible",!0),(0,Me.Z)((0,xt.Z)(a),"layers",[]),(0,Me.Z)((0,xt.Z)(a),"isLoaded",!1),(0,Me.Z)((0,xt.Z)(a),"tileMaskLayers",[]),a.parent=r,a.sourceTile=n,a.x=n.x,a.y=n.y,a.z=n.z,a.key="".concat(a.x,"_").concat(a.y,"_").concat(a.z),a}return(0,be.Z)(t,[{key:"getLayers",value:function(){return this.layers}},{key:"styleUpdate",value:function(){}},{key:"lnglatInBounds",value:function(r){var a=(0,vn.Z)(this.sourceTile.bounds,4),u=a[0],c=a[1],g=a[2],x=a[3],M=r.lng,O=r.lat;return M>=u&&M<=g&&O>=c&&O<=x}},{key:"getLayerOptions",value:function(){var r,a=this.parent.getLayerConfig();return(0,X.Z)((0,X.Z)({},a),{},{textAllowOverlap:!0,autoFit:!1,maskLayers:this.getMaskLayer(),tileMask:zI(this.parent.type),mask:a.mask||((r=a.maskLayers)===null||r===void 0?void 0:r.length)!==0&&a.enableMask})}},{key:"getMaskLayer",value:function(){var r=this,a=this.parent.getLayerConfig(),u=a.maskLayers,c=[];return u==null||u.forEach(function(g){if(!g.tileLayer)return c.push(g),g;var x=g.tileLayer,M=x.getTile(r.sourceTile.key),O=M==null?void 0:M.getLayers()[0];O&&c.push(O)}),c}},{key:"addTileMask",value:function(){var n=(0,ur.Z)(it().mark(function a(){var u,c,g;return it().wrap(function(M){for(;;)switch(M.prev=M.next){case 0:return u=new _g({visible:!1,enablePicking:!1}).source({type:"FeatureCollection",features:[this.sourceTile.bboxPolygon]},{parser:{type:"geojson",featureId:"id"}}).shape("fill").style({opacity:.5}),c=fp(this.parent.sceneContainer),u.setContainer(c,this.parent.sceneContainer),M.next=5,u.init();case 5:return this.tileMask=u,g=this.getMainLayer(),g!==void 0&&(g.tileMask=u),M.abrupt("return",u);case 9:case"end":return M.stop()}},a,this)}));function r(){return n.apply(this,arguments)}return r}()},{key:"addMask",value:function(){var n=(0,ur.Z)(it().mark(function a(u,c){var g;return it().wrap(function(M){for(;;)switch(M.prev=M.next){case 0:return g=fp(this.parent.sceneContainer),c.setContainer(g,this.parent.sceneContainer),M.next=4,c.init();case 4:u.addMask(c),this.tileMaskLayers.push(c);case 6:case"end":return M.stop()}},a,this)}));function r(a,u){return n.apply(this,arguments)}return r}()},{key:"addLayer",value:function(){var n=(0,ur.Z)(it().mark(function a(u){var c;return it().wrap(function(x){for(;;)switch(x.prev=x.next){case 0:return u.isTileLayer=!0,c=fp(this.parent.sceneContainer),u.setContainer(c,this.parent.sceneContainer),this.layers.push(u),x.next=6,u.init();case 6:case"end":return x.stop()}},a,this)}));function r(a){return n.apply(this,arguments)}return r}()},{key:"updateVisible",value:function(r){this.visible=r,this.updateOptions("visible",r)}},{key:"updateOptions",value:function(r,a){this.layers.forEach(function(u){u.updateLayerConfig((0,Me.Z)({},r,a))})}},{key:"getMainLayer",value:function(){return this.layers[0]}},{key:"getFeatures",value:function(r){return[]}},{key:"getFeatureById",value:function(r){return[]}},{key:"destroy",value:function(){var r;(r=this.tileMask)===null||r===void 0||r.destroy(),this.layers.forEach(function(a){return a.destroy()})}}]),t}(ha.EventEmitter);function jI(e){var i=VI();return function(){var n=(0,ue.Z)(e),r;if(i){var a=(0,ue.Z)(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return(0,ze.Z)(this,r)}}function VI(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var HI=function(e){(0,Ne.Z)(t,e);var i=jI(t);function t(){return(0,se.Z)(this,t),i.apply(this,arguments)}return(0,be.Z)(t,[{key:"initTileLayer",value:function(){var n=(0,ur.Z)(it().mark(function a(){var u,c,g,x;return it().wrap(function(O){for(;;)switch(O.prev=O.next){case 0:return u=this.getSourceOption(),c=u.data.features[0].properties,g=new mg().source(u.data,u.options).size(1).shape("line").color("red"),x=new Zd({minZoom:this.z-1,maxZoom:this.z+1,textAllowOverlap:!0}).source([c],{parser:{type:"json",x:"x",y:"y"}}).size(20).color("red").shape(this.key).style({stroke:"#fff",strokeWidth:2}),O.next=6,this.addLayer(g);case 6:return O.next=8,this.addLayer(x);case 8:this.isLoaded=!0;case 9:case"end":return O.stop()}},a,this)}));function r(){return n.apply(this,arguments)}return r}()},{key:"getSourceOption",value:function(){var r=this.parent.getSource(),a=this.sourceTile.data.layers.testTile.features;return{data:{type:"FeatureCollection",features:a},options:{parser:{type:"geojson"},transforms:r.transforms}}}}]),t}(mh);function $I(e){var i=YI();return function(){var n=(0,ue.Z)(e),r;if(i){var a=(0,ue.Z)(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return(0,ze.Z)(this,r)}}function YI(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var WI=`precision mediump float;
uniform float u_opacity: 1.0;
uniform sampler2D u_texture;
varying vec2 v_texCoord;
void main() {
  vec4 color = texture2D(u_texture,vec2(v_texCoord.x,v_texCoord.y));
  gl_FragColor = color;
  gl_FragColor.a *= u_opacity;
  if(gl_FragColor.a < 0.01)
    discard;
}
`,XI=`precision highp float;
uniform mat4 u_ModelMatrix;

attribute vec3 a_Position;
attribute vec2 a_Uv;
varying vec2 v_texCoord;
#pragma include "projection"
void main() {
   v_texCoord = a_Uv;
   vec4 project_pos = project_position(vec4(a_Position, 1.0));
   gl_Position = project_common_position_to_clipspace_v2(vec4(project_pos.xy,0., 1.0));
 
}
`,QI=function(e){(0,Ne.Z)(t,e);var i=$I(t);function t(){return(0,se.Z)(this,t),i.apply(this,arguments)}return(0,be.Z)(t,[{key:"getUninforms",value:function(){var r=this.layer.getLayerConfig(),a=r.opacity;return{u_opacity:a||1,u_texture:this.texture}}},{key:"initModels",value:function(){var n=(0,ur.Z)(it().mark(function a(){var u,c,g,x;return it().wrap(function(O){for(;;)switch(O.prev=O.next){case 0:return u=this.layer.getSource(),c=this.rendererService.createTexture2D,this.texture=c({height:0,width:0}),O.next=5,u.data.images;case 5:return g=O.sent,this.texture=c({data:g[0],width:g[0].width,height:g[0].height,mag:je.LINEAR,min:je.LINEAR}),O.next=9,this.layer.buildLayerModel({moduleName:"rasterImage",vertexShader:XI,fragmentShader:WI,triangulation:kd,primitive:je.TRIANGLES,blend:{enable:!0},depth:{enable:!1}});case 9:return x=O.sent,O.abrupt("return",[x]);case 11:case"end":return O.stop()}},a,this)}));function r(){return n.apply(this,arguments)}return r}()},{key:"clearModels",value:function(){var r;(r=this.texture)===null||r===void 0||r.destroy()}},{key:"buildModels",value:function(){var n=(0,ur.Z)(it().mark(function a(){return it().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.abrupt("return",this.initModels());case 1:case"end":return c.stop()}},a,this)}));function r(){return n.apply(this,arguments)}return r}()},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"uv",type:mn.Attribute,descriptor:{name:"a_Uv",buffer:{usage:je.DYNAMIC_DRAW,data:[],type:je.FLOAT},size:2,update:function(a,u,c){return[c[3],c[4]]}}})}}]),t}(vo),qI={image:QI},KI=qI;function JI(e){var i=e5();return function(){var n=(0,ue.Z)(e),r;if(i){var a=(0,ue.Z)(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return(0,ze.Z)(this,r)}}function e5(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var t5=function(e){(0,Ne.Z)(t,e);var i=JI(t);function t(){var n;(0,se.Z)(this,t);for(var r=arguments.length,a=new Array(r),u=0;u<r;u++)a[u]=arguments[u];return n=i.call.apply(i,[this].concat(a)),(0,Me.Z)((0,xt.Z)(n),"type","ImageLayer"),n}return(0,be.Z)(t,[{key:"buildModels",value:function(){var n=(0,ur.Z)(it().mark(function a(){var u;return it().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return u=this.getModelType(),this.layerModel=new KI[u](this),g.next=4,this.initLayerModels();case 4:case"end":return g.stop()}},a,this)}));function r(){return n.apply(this,arguments)}return r}()},{key:"getDefaultConfig",value:function(){var r=this.getModelType(),a={image:{}};return a[r]}},{key:"getModelType",value:function(){return"image"}}]),t}(iA);function r5(e){var i=n5();return function(){var n=(0,ue.Z)(e),r;if(i){var a=(0,ue.Z)(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return(0,ze.Z)(this,r)}}function n5(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var i5=function(e){(0,Ne.Z)(t,e);var i=r5(t);function t(){return(0,se.Z)(this,t),i.apply(this,arguments)}return(0,be.Z)(t,[{key:"initTileLayer",value:function(){var n=(0,ur.Z)(it().mark(function a(){var u,c,g,x;return it().wrap(function(O){for(;;)switch(O.prev=O.next){case 0:return u=this.parent.getLayerAttributeConfig(),c=this.getLayerOptions(),g=this.getSourceOption(),x=new t5((0,X.Z)({},c)).source(g.data,g.options),u&&Object.keys(u).forEach(function(B){var W,ce,oe=B;x[oe]((W=u[oe])===null||W===void 0?void 0:W.field,(ce=u[oe])===null||ce===void 0?void 0:ce.values)}),O.next=7,this.addLayer(x);case 7:this.isLoaded=!0;case 8:case"end":return O.stop()}},a,this)}));function r(){return n.apply(this,arguments)}return r}()},{key:"getSourceOption",value:function(){var r=this.parent.getSource();return{data:this.sourceTile.data,options:{parser:{type:"image",extent:this.sourceTile.bounds},transforms:r.transforms}}}}]),t}(mh);function a5(e){var i=o5();return function(){var n=(0,ue.Z)(e),r;if(i){var a=(0,ue.Z)(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return(0,ze.Z)(this,r)}}function o5(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var s5=function(e){(0,Ne.Z)(t,e);var i=a5(t);function t(){return(0,se.Z)(this,t),i.apply(this,arguments)}return(0,be.Z)(t,[{key:"initTileLayer",value:function(){var n=(0,ur.Z)(it().mark(function a(){var u,c,g,x;return it().wrap(function(O){for(;;)switch(O.prev=O.next){case 0:return u=this.parent.getLayerAttributeConfig(),c=this.getLayerOptions(),g=this.getSourceOption(),x=new Z1((0,X.Z)({},c)).source(g.data,g.options),u&&Object.keys(u).forEach(function(B){var W,ce,oe=B;x[oe]((W=u[oe])===null||W===void 0?void 0:W.field,(ce=u[oe])===null||ce===void 0?void 0:ce.values)}),O.next=7,this.addLayer(x);case 7:this.isLoaded=!0;case 8:case"end":return O.stop()}},a,this)}));function r(){return n.apply(this,arguments)}return r}()},{key:"getFeatures",value:function(r){if(!r)return[];var a=this.sourceTile.data;return a.getTileData(r)}},{key:"getSourceOption",value:function(){var r=this.parent.getSource(),a=this.parent.getLayerConfig(),u=a.sourceLayer,c=a.featureId,g=this.getFeatures(u);return{data:{type:"FeatureCollection",features:g},options:{parser:{type:"geojson",featureId:c},transforms:r.transforms}}}}]),t}(mh);function u5(e){var i=l5();return function(){var n=(0,ue.Z)(e),r;if(i){var a=(0,ue.Z)(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return(0,ze.Z)(this,r)}}function l5(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var c5=`precision mediump float;
uniform float u_opacity: 1.0;
uniform sampler2D u_texture;
uniform sampler2D u_colorTexture;
uniform float u_min;
uniform float u_max;
uniform vec2 u_domain;
uniform float u_noDataValue;
uniform bool u_clampLow: true;
uniform bool u_clampHigh: true;
varying vec2 v_texCoord;
bool isnan_emu(float x) { return (x > 0.0 || x < 0.0) ? x != x : x != 0.0; }


void main() {

  float value = texture2D(u_texture,vec2(v_texCoord.x,v_texCoord.y)).r;
  if (value == u_noDataValue || isnan_emu(value))
      discard;
  else if ((!u_clampLow && value < u_domain[0]) || (!u_clampHigh && value > u_domain[1]))
     discard;
  else {
    float normalisedValue =(value - u_domain[0]) / (u_domain[1] -u_domain[0]);
    vec4 color = texture2D(u_colorTexture,vec2(normalisedValue, 0));
    
    gl_FragColor = color;
    gl_FragColor.a =  gl_FragColor.a * u_opacity ;
    if(gl_FragColor.a < 0.01)
      discard;
   
  }
}
`,f5=`precision highp float;
uniform mat4 u_ModelMatrix;

attribute vec3 a_Position;
attribute vec2 a_Uv;
varying vec2 v_texCoord;
#pragma include "projection"
void main() {
   v_texCoord = a_Uv;
   vec4 project_pos = project_position(vec4(a_Position, 1.0));

    gl_Position = project_common_position_to_clipspace_v2(vec4(project_pos.xy,0., 1.0));
}
`,v2=function(e){(0,Ne.Z)(t,e);var i=u5(t);function t(){return(0,se.Z)(this,t),i.apply(this,arguments)}return(0,be.Z)(t,[{key:"getUninforms",value:function(){var r=this.layer.getLayerConfig(),a=r.opacity,u=a===void 0?1:a,c=r.clampLow,g=c===void 0?!0:c,x=r.clampHigh,M=x===void 0?!0:x,O=r.noDataValue,B=O===void 0?-9999999:O,W=r.domain,ce=r.rampColors,oe=W||eu(ce);return this.colorTexture=this.layer.textureService.getColorTexture(ce,oe),{u_opacity:u||1,u_texture:this.texture,u_domain:oe,u_clampLow:g,u_clampHigh:typeof M!="undefined"?M:g,u_noDataValue:B,u_colorTexture:this.colorTexture}}},{key:"getRasterData",value:function(){var n=(0,ur.Z)(it().mark(function a(u){var c,g,x,M;return it().wrap(function(B){for(;;)switch(B.prev=B.next){case 0:if(!Array.isArray(u.data)){B.next=4;break}return B.abrupt("return",{data:u.data,width:u.width,height:u.height});case 4:return B.next=6,u.data;case 6:return c=B.sent,g=c.rasterData,x=c.width,M=c.height,B.abrupt("return",{data:Array.from(g),width:x,height:M});case 11:case"end":return B.stop()}},a)}));function r(a){return n.apply(this,arguments)}return r}()},{key:"initModels",value:function(){var n=(0,ur.Z)(it().mark(function a(){var u,c,g,x,M,O,B,W;return it().wrap(function(oe){for(;;)switch(oe.prev=oe.next){case 0:return u=this.layer.getSource(),c=this.rendererService.createTexture2D,g=u.data.dataArray[0],oe.next=5,this.getRasterData(g);case 5:return x=oe.sent,M=x.data,O=x.width,B=x.height,this.texture=c({data:M,width:O,height:B,format:je.LUMINANCE,type:je.FLOAT}),oe.next=12,this.layer.buildLayerModel({moduleName:"rasterImageData",vertexShader:f5,fragmentShader:c5,triangulation:kd,primitive:je.TRIANGLES,depth:{enable:!1}});case 12:return W=oe.sent,oe.abrupt("return",[W]);case 14:case"end":return oe.stop()}},a,this)}));function r(){return n.apply(this,arguments)}return r}()},{key:"buildModels",value:function(){var n=(0,ur.Z)(it().mark(function a(){return it().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.abrupt("return",this.initModels());case 1:case"end":return c.stop()}},a,this)}));function r(){return n.apply(this,arguments)}return r}()},{key:"clearModels",value:function(){var r,a;(r=this.texture)===null||r===void 0||r.destroy(),(a=this.colorTexture)===null||a===void 0||a.destroy()}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"uv",type:mn.Attribute,descriptor:{name:"a_Uv",buffer:{usage:je.DYNAMIC_DRAW,data:[],type:je.FLOAT},size:2,update:function(a,u,c){return[c[3],c[4]]}}})}}]),t}(vo),h5=["data"],A5=["rasterData"];function p5(e){var i=d5();return function(){var n=(0,ue.Z)(e),r;if(i){var a=(0,ue.Z)(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return(0,ze.Z)(this,r)}}function d5(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var v5=`precision highp float;
uniform mat4 u_ModelMatrix;

attribute vec3 a_Position;
attribute vec2 a_Uv;
varying vec2 v_texCoord;
#pragma include "projection"
void main() {
   v_texCoord = a_Uv;
   vec4 project_pos = project_position(vec4(a_Position, 1.0));

    gl_Position = project_common_position_to_clipspace_v2(vec4(project_pos.xy,0., 1.0));
}
`,g5=`precision mediump float;
uniform vec2 u_rminmax: vec2(0,255); 
uniform vec2 u_gminmax: vec2(0,255);
uniform vec2 u_bminmax: vec2(0,255);
uniform float u_opacity: 1.0;
uniform sampler2D u_texture;
uniform float u_noDataValue : 0.0;
varying vec2 v_texCoord;

void main() {
  vec3 rgb = texture2D(u_texture,vec2(v_texCoord.x,v_texCoord.y)).rgb;
  if(rgb == vec3(u_noDataValue)) {
    gl_FragColor = vec4(0.0, 0, 0, 0.0);
  } else {
    gl_FragColor = vec4(rgb.r / (u_rminmax.y -u_rminmax.x), rgb.g /(u_gminmax.y -u_gminmax.x), rgb.b/ (u_bminmax.y - u_bminmax.x), u_opacity);
  }
  if(gl_FragColor.a < 0.01)
    discard;
 
}`,m5=function(e){(0,Ne.Z)(t,e);var i=p5(t);function t(){var n;(0,se.Z)(this,t);for(var r=arguments.length,a=new Array(r),u=0;u<r;u++)a[u]=arguments[u];return n=i.call.apply(i,[this].concat(a)),(0,Me.Z)((0,xt.Z)(n),"dataOption",{}),n}return(0,be.Z)(t,[{key:"getUninforms",value:function(){var r=this.layer.getLayerConfig(),a=r.opacity,u=a===void 0?1:a,c=r.noDataValue,g=c===void 0?0:c,x=this.dataOption,M=x.rMinMax,O=x.gMinMax,B=x.bMinMax;return{u_opacity:u||1,u_texture:this.texture,u_noDataValue:g,u_rminmax:M,u_gminmax:O,u_bminmax:B}}},{key:"getRasterData",value:function(){var n=(0,ur.Z)(it().mark(function a(u){var c,g,x,M,O;return it().wrap(function(W){for(;;)switch(W.prev=W.next){case 0:if(!Array.isArray(u.data)){W.next=4;break}return c=u.data,g=(0,Ac.Z)(u,h5),this.dataOption=g,W.abrupt("return",(0,X.Z)({data:c},g));case 4:return W.next=6,u.data;case 6:if(x=W.sent,M=x.rasterData,O=(0,Ac.Z)(x,A5),this.dataOption=O,!Array.isArray(M)){W.next=14;break}return W.abrupt("return",(0,X.Z)({data:M},O));case 14:return W.abrupt("return",(0,X.Z)({data:Array.from(M)},O));case 15:case"end":return W.stop()}},a,this)}));function r(a){return n.apply(this,arguments)}return r}()},{key:"initModels",value:function(){var n=(0,ur.Z)(it().mark(function a(){var u,c,g,x,M,O,B,W;return it().wrap(function(oe){for(;;)switch(oe.prev=oe.next){case 0:return u=this.layer.getSource(),c=this.rendererService.createTexture2D,g=u.data.dataArray[0],oe.next=5,this.getRasterData(g);case 5:return x=oe.sent,M=x.data,O=x.width,B=x.height,this.texture=c({data:M,width:O,height:B,format:je.RGB,type:je.FLOAT}),oe.next=12,this.layer.buildLayerModel({moduleName:"rasterImageDataRGBA",vertexShader:v5,fragmentShader:g5,triangulation:kd,primitive:je.TRIANGLES,depth:{enable:!1}});case 12:return W=oe.sent,oe.abrupt("return",[W]);case 14:case"end":return oe.stop()}},a,this)}));function r(){return n.apply(this,arguments)}return r}()},{key:"buildModels",value:function(){var n=(0,ur.Z)(it().mark(function a(){return it().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.abrupt("return",this.initModels());case 1:case"end":return c.stop()}},a,this)}));function r(){return n.apply(this,arguments)}return r}()},{key:"clearModels",value:function(){var r;(r=this.texture)===null||r===void 0||r.destroy()}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"uv",type:mn.Attribute,descriptor:{name:"a_Uv",buffer:{usage:je.DYNAMIC_DRAW,data:[],type:je.FLOAT},size:2,update:function(a,u,c){return[c[3],c[4]]}}})}}]),t}(vo);function y5(e){var i=_5();return function(){var n=(0,ue.Z)(e),r;if(i){var a=(0,ue.Z)(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return(0,ze.Z)(this,r)}}function _5(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var x5=`precision mediump float;
uniform float u_opacity: 1.0;

uniform sampler2D u_texture;
uniform sampler2D u_colorTexture;

varying vec2 v_texCoord;

uniform vec2 u_domain;
uniform float u_noDataValue;
uniform bool u_clampLow: true;
uniform bool u_clampHigh: true;
uniform vec4 u_unpack;

float getElevation(vec2 coord, float bias) {
    // Convert encoded elevation value to meters
    vec4 data = texture2D(u_texture, coord,bias) * 255.0;
    data.a = -1.0;
    return dot(data, u_unpack);
}

vec4 getColor(float value) {
   float normalisedValue =(value- u_domain[0]) / (u_domain[1] - u_domain[0]);
    vec2 coord = vec2(normalisedValue, 0);
    return texture2D(u_colorTexture, coord);
}

void main() {
  float value = getElevation(v_texCoord,0.0);
  if (value == u_noDataValue) {
    gl_FragColor = vec4(0.0, 0, 0, 0.0);
  } else if ((!u_clampLow && value < u_domain[0]) || (!u_clampHigh && value > u_domain[1])) {
     gl_FragColor = vec4(0.0, 0, 0, 0.0);
  } else {
   
    gl_FragColor = getColor(value);
    gl_FragColor.a =  gl_FragColor.a * u_opacity ;
      if(gl_FragColor.a < 0.01)
      discard;
  }
}
`,E5=`precision highp float;
uniform mat4 u_ModelMatrix;

attribute vec3 a_Position;
attribute vec2 a_Uv;
varying vec2 v_texCoord;
#pragma include "projection"
void main() {
   v_texCoord = a_Uv;
   vec4 project_pos = project_position(vec4(a_Position, 1.0));
   gl_Position = project_common_position_to_clipspace_v2(vec4(project_pos.xy,0., 1.0));
}
`,b5=function(e){(0,Ne.Z)(t,e);var i=y5(t);function t(){return(0,se.Z)(this,t),i.apply(this,arguments)}return(0,be.Z)(t,[{key:"getUninforms",value:function(){var r=this.layer.getLayerConfig(),a=r.opacity,u=r.clampLow,c=u===void 0?!0:u,g=r.clampHigh,x=g===void 0?!0:g,M=r.noDataValue,O=M===void 0?-9999999:M,B=r.domain,W=r.rampColors,ce=r.colorTexture,oe=r.rScaler,Te=oe===void 0?6553.6:oe,Ze=r.gScaler,qe=Ze===void 0?25.6:Ze,et=r.bScaler,yt=et===void 0?.1:et,bt=r.offset,Ot=bt===void 0?1e4:bt,jt=B||eu(W),or=ce;return ce?this.layer.textureService.setColorTexture(ce,W,jt):or=this.layer.textureService.getColorTexture(W,jt),{u_opacity:a||1,u_texture:this.texture,u_domain:jt,u_clampLow:c,u_clampHigh:typeof x!="undefined"?x:c,u_noDataValue:O,u_unpack:[Te,qe,yt,Ot],u_colorTexture:or}}},{key:"initModels",value:function(){var n=(0,ur.Z)(it().mark(function a(){var u,c,g,x;return it().wrap(function(O){for(;;)switch(O.prev=O.next){case 0:return u=this.layer.getSource(),c=this.rendererService.createTexture2D,O.next=4,u.data.images;case 4:return g=O.sent,this.texture=c({data:g[0],width:g[0].width,height:g[0].height,min:je.LINEAR,mag:je.LINEAR}),O.next=8,this.layer.buildLayerModel({moduleName:"RasterTileDataImage",vertexShader:E5,fragmentShader:x5,triangulation:kd,primitive:je.TRIANGLES,depth:{enable:!1}});case 8:return x=O.sent,O.abrupt("return",[x]);case 10:case"end":return O.stop()}},a,this)}));function r(){return n.apply(this,arguments)}return r}()},{key:"clearModels",value:function(){var r;(r=this.texture)===null||r===void 0||r.destroy()}},{key:"buildModels",value:function(){var n=(0,ur.Z)(it().mark(function a(){return it().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.abrupt("return",this.initModels());case 1:case"end":return c.stop()}},a,this)}));function r(){return n.apply(this,arguments)}return r}()},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"uv",type:mn.Attribute,descriptor:{name:"a_Uv",buffer:{usage:je.DYNAMIC_DRAW,data:[],type:je.FLOAT},size:2,update:function(a,u,c){return[c[3],c[4]]}}})}}]),t}(vo),S5={raster:v2,rasterRgb:m5,raster3d:v2,rasterTerrainRgb:b5},C5=S5;function w5(e){var i=T5();return function(){var n=(0,ue.Z)(e),r;if(i){var a=(0,ue.Z)(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return(0,ze.Z)(this,r)}}function T5(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var Ug=function(e){(0,Ne.Z)(t,e);var i=w5(t);function t(){var n;(0,se.Z)(this,t);for(var r=arguments.length,a=new Array(r),u=0;u<r;u++)a[u]=arguments[u];return n=i.call.apply(i,[this].concat(a)),(0,Me.Z)((0,xt.Z)(n),"type","RasterLayer"),n}return(0,be.Z)(t,[{key:"buildModels",value:function(){var n=(0,ur.Z)(it().mark(function a(){var u;return it().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return u=this.getModelType(),this.layerModel=new C5[u](this),g.next=4,this.initLayerModels();case 4:case"end":return g.stop()}},a,this)}));function r(){return n.apply(this,arguments)}return r}()},{key:"getDefaultConfig",value:function(){var r=this.getModelType(),a={raster:{},rasterRgb:{},raster3d:{},rasterTerrainRgb:{}};return a[r]}},{key:"getModelType",value:function(){var r=this.layerSource.getParserType();switch(r){case"raster":return"raster";case"rasterRgb":return"rasterRgb";case"image":return"rasterTerrainRgb";default:return"raster"}}}]),t}(iA),M5=["rasterData"];function I5(e){var i=P5();return function(){var n=(0,ue.Z)(e),r;if(i){var a=(0,ue.Z)(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return(0,ze.Z)(this,r)}}function P5(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var L5=function(e){(0,Ne.Z)(t,e);var i=I5(t);function t(){return(0,se.Z)(this,t),i.apply(this,arguments)}return(0,be.Z)(t,[{key:"initTileLayer",value:function(){var n=(0,ur.Z)(it().mark(function a(){var u,c,g,x;return it().wrap(function(O){for(;;)switch(O.prev=O.next){case 0:return u=this.parent.getLayerAttributeConfig(),c=this.getLayerOptions(),g=this.getSourceOption(),x=new Ug((0,X.Z)({},c)).source(g.data,g.options),u&&Object.keys(u).forEach(function(B){var W,ce,oe=B;x[oe]((W=u[oe])===null||W===void 0?void 0:W.field,(ce=u[oe])===null||ce===void 0?void 0:ce.values)}),O.next=7,this.addLayer(x);case 7:this.isLoaded=!0;case 8:case"end":return O.stop()}},a,this)}));function r(){return n.apply(this,arguments)}return r}()},{key:"getSourceOption",value:function(){var r=this.parent.getSource(),a=this.sourceTile.data.data,u=a.rasterData,c=(0,Ac.Z)(a,M5);return{data:u,options:{parser:(0,X.Z)({type:"rasterRgb",extent:this.sourceTile.bounds},c),transforms:r.transforms}}}}]),t}(mh);function O5(e){var i=R5();return function(){var n=(0,ue.Z)(e),r;if(i){var a=(0,ue.Z)(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return(0,ze.Z)(this,r)}}function R5(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var D5=function(e){(0,Ne.Z)(t,e);var i=O5(t);function t(){return(0,se.Z)(this,t),i.apply(this,arguments)}return(0,be.Z)(t,[{key:"initTileLayer",value:function(){var n=(0,ur.Z)(it().mark(function a(){var u,c,g,x;return it().wrap(function(O){for(;;)switch(O.prev=O.next){case 0:return u=this.parent.getLayerAttributeConfig(),c=this.getLayerOptions(),g=this.getSourceOption(),x=new Ug((0,X.Z)({},c)).source(g.data,g.options),u&&Object.keys(u).forEach(function(B){var W,ce,oe=B;x[oe]((W=u[oe])===null||W===void 0?void 0:W.field,(ce=u[oe])===null||ce===void 0?void 0:ce.values)}),O.next=7,this.addLayer(x);case 7:this.isLoaded=!0;case 8:case"end":return O.stop()}},a,this)}));function r(){return n.apply(this,arguments)}return r}()},{key:"getSourceOption",value:function(){var r=this.parent.getSource();return{data:this.sourceTile.data,options:{parser:{type:"image",extent:this.sourceTile.bounds},transforms:r.transforms}}}}]),t}(mh),k5=["rasterData"];function N5(e){var i=F5();return function(){var n=(0,ue.Z)(e),r;if(i){var a=(0,ue.Z)(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return(0,ze.Z)(this,r)}}function F5(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var B5={positions:[0,1],colors:["#000","#fff"]},Z5=function(e){(0,Ne.Z)(t,e);var i=N5(t);function t(){return(0,se.Z)(this,t),i.apply(this,arguments)}return(0,be.Z)(t,[{key:"initTileLayer",value:function(){var n=(0,ur.Z)(it().mark(function a(){var u,c,g,x,M,O,B;return it().wrap(function(ce){for(;;)switch(ce.prev=ce.next){case 0:return u=this.parent.getLayerAttributeConfig(),c=this.getLayerOptions(),g=this.getSourceOption(),x=this.getLayerOptions(),M=x.rampColors,O=x.domain,this.colorTexture=this.parent.textureService.getColorTexture(M,O),B=new Ug((0,X.Z)((0,X.Z)({},c),{},{colorTexture:this.colorTexture})).source(g.data,g.options),u&&Object.keys(u).forEach(function(oe){var Te,Ze,qe=oe;B[qe]((Te=u[qe])===null||Te===void 0?void 0:Te.field,(Ze=u[qe])===null||Ze===void 0?void 0:Ze.values)}),ce.next=9,this.addLayer(B);case 9:this.isLoaded=!0;case 10:case"end":return ce.stop()}},a,this)}));function r(){return n.apply(this,arguments)}return r}()},{key:"getSourceOption",value:function(){var r=this.parent.getSource(),a=this.sourceTile.data.data,u=a.rasterData,c=(0,Ac.Z)(a,k5);return{data:u,options:{parser:(0,X.Z)({type:"raster",extent:this.sourceTile.bounds},c),transforms:r.transforms}}}},{key:"styleUpdate",value:function(){for(var r=this,a=arguments.length,u=new Array(a),c=0;c<a;c++)u[c]=arguments[c];var g=u,x=g.rampColors,M=x===void 0?B5:x,O=g.domain;this.colorTexture=this.parent.textureService.getColorTexture(M,O||eu(M)),this.layers.forEach(function(B){return B.style({colorTexture:r.colorTexture})})}},{key:"destroy",value:function(){this.layers.forEach(function(r){return r.destroy()})}}]),t}(mh);function z5(e){var i=U5();return function(){var n=(0,ue.Z)(e),r;if(i){var a=(0,ue.Z)(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return(0,ze.Z)(this,r)}}function U5(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var tv=function(e){(0,Ne.Z)(t,e);var i=z5(t);function t(){return(0,se.Z)(this,t),i.apply(this,arguments)}return(0,be.Z)(t,[{key:"initTileLayer",value:function(){var n=(0,ur.Z)(it().mark(function a(){var u,c,g,x,M;return it().wrap(function(B){for(;;)switch(B.prev=B.next){case 0:if(u=this.parent.getLayerAttributeConfig(),c=this.getLayerOptions(),g=ZI(this.parent.type),x=this.getSourceOption(),x){B.next=8;break}return this.isLoaded=!0,this.emit("loaded"),B.abrupt("return");case 8:return M=new g((0,X.Z)({},c)).source(x.data,x.options),Object.keys(u).forEach(function(W){var ce,oe,Te=W;M[Te]((ce=u[Te])===null||ce===void 0?void 0:ce.field,(oe=u[Te])===null||oe===void 0?void 0:oe.values)}),B.next=12,this.addLayer(M);case 12:if(!c.tileMask){B.next=15;break}return B.next=15,this.addTileMask();case 15:this.setLayerMinMaxZoom(M),this.isLoaded=!0,this.emit("loaded");case 18:case"end":return B.stop()}},a,this)}));function r(){return n.apply(this,arguments)}return r}()},{key:"getSourceOption",value:function(){var r=this.parent.getSource(),a=this.parent.getLayerConfig(),u=a.sourceLayer,c=u===void 0?"defaultLayer":u,g=a.featureId,x=g===void 0?"id":g,M=this.getFeatures(c);return{data:{type:"FeatureCollection",features:M},options:{parser:{type:"geojson",featureId:x},transforms:r.transforms}}}},{key:"setLayerMinMaxZoom",value:function(r){r.getModelType()==="text"&&r.updateLayerConfig({maxZoom:this.z+1,minZoom:this.z-1})}},{key:"getFeatures",value:function(r){var a=this.sourceTile.data;return a.getTileData(r)}},{key:"getFeatureById",value:function(r){var a=this.getMainLayer();if(!a)return[];var u=a.getSource().data.dataArray.filter(function(c){return c._id===r});return u}}]),t}(mh);function G5(e){var i=e.type;switch(i){case"PolygonLayer":return tv;case"LineLayer":return tv;case"PointLayer":return tv;case"TileDebugLayer":return HI;case"MaskLayer":return s5;case"RasterLayer":var t=e.getSource().parser.dataType;switch(t){case Wu.RGB:case Wu.CUSTOMRGB:return L5;case Wu.ARRAYBUFFER:case Wu.CUSTOMARRAYBUFFER:return Z5;case Wu.TERRAINRGB:case Wu.CUSTOMTERRAINRGB:return D5;default:return i5}default:return tv}}var j5=["shape","color","size","style","animate","filter","rotate","scale","setBlend","setSelect","setActive","disableMask","enableMask"],V5=In.debounce,g2=function(){function e(i){var t=this;(0,se.Z)(this,e),(0,Me.Z)(this,"initedTileset",!1),(0,Me.Z)(this,"mapchange",function(){var r;if(t.parent.isVisible()!==!1){var a=t.getCurrentView(),u=a.latLonBounds,c=a.zoom;if(t.mapService.version==="GAODE1.x"){var g=t.parent.getLayerConfig(),x=g.visible;c<2&&x?(t.parent.updateLayerConfig({visible:!1}),t.layerService.reRender()):c>=2&&!x&&(t.parent.updateLayerConfig({visible:!0}),t.layerService.reRender())}t.lastViewStates&&t.lastViewStates.zoom===c&&t.lastViewStates.latLonBounds.toString()===u.toString()||(t.lastViewStates={zoom:c,latLonBounds:u},(r=t.tilesetManager)===null||r===void 0||r.throttleUpdate(c,u))}}),(0,Me.Z)(this,"viewchange",V5(this.mapchange,24)),this.parent=i;var n=this.parent.getContainer();this.rendererService=n.get(Xt.IRendererService),this.layerService=n.get(Xt.ILayerService),this.mapService=n.get(Xt.IMapService),this.pickingService=n.get(Xt.IPickingService),this.tileLayerService=new kI({rendererService:this.rendererService,layerService:this.layerService,parent:i}),this.tilePickService=new BI({tileLayerService:this.tileLayerService,layerService:this.layerService,parent:i}),this.parent.setLayerPickService(this.tilePickService),this.proxy(i),this.initTileSetManager()}return(0,be.Z)(e,[{key:"initTileSetManager",value:function(){var t,n=this.parent.getSource();if(this.tilesetManager=n.tileset,this.initedTileset||(this.bindTilesetEvent(),this.initedTileset=!0),this.parent.isVisible()!==!1){var r=this.getCurrentView(),a=r.latLonBounds,u=r.zoom;(t=this.tilesetManager)===null||t===void 0||t.update(u,a)}}},{key:"getCurrentView",value:function(){var t=this.mapService.getBounds(),n=[t[0][0],t[0][1],t[1][0],t[1][1]],r=this.mapService.getZoom();return{latLonBounds:n,zoom:r}}},{key:"bindTilesetEvent",value:function(){var t=this;this.tilesetManager.on("tile-loaded",function(n){}),this.tilesetManager.on("tile-unload",function(n){t.tileUnLoad(n)}),this.tilesetManager.on("tile-error",function(n,r){t.tileError(n)}),this.tilesetManager.on("tile-update",function(){t.tileUpdate()}),this.mapService.on("zoomend",this.mapchange),this.mapService.on("moveend",this.viewchange)}},{key:"render",value:function(){this.tileLayerService.render()}},{key:"getLayers",value:function(){return this.tileLayerService.getLayers()}},{key:"getTiles",value:function(){return this.tileLayerService.getTiles()}},{key:"getTile",value:function(t){return this.tileLayerService.getTile(t)}},{key:"tileLoaded",value:function(t){}},{key:"tileError",value:function(t){console.warn("error:",t)}},{key:"destroy",value:function(){var t;this.mapService.off("zoomend",this.mapchange),this.mapService.off("moveend",this.viewchange),(t=this.tilesetManager)===null||t===void 0||t.destroy(),this.tileLayerService.destroy()}},{key:"reload",value:function(){var t;this.tilesetManager.clear();var n=this.getCurrentView(),r=n.latLonBounds,a=n.zoom;(t=this.tilesetManager)===null||t===void 0||t.update(a,r)}},{key:"tileUnLoad",value:function(t){this.tileLayerService.removeTile(t.key)}},{key:"tileUpdate",value:function(){var i=(0,ur.Z)(it().mark(function n(){var r=this,a,u;return it().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:if(this.tilesetManager){g.next=2;break}return g.abrupt("return");case 2:return a=this.parent.getMinZoom(),u=this.parent.getMaxZoom(),g.next=6,Promise.all(this.tilesetManager.tiles.filter(function(x){return x.isLoaded}).filter(function(x){return x.isVisibleChange}).filter(function(x){return x.data}).filter(function(x){return x.z>=a&&x.z<u}).map(function(){var x=(0,ur.Z)(it().mark(function M(O){var B,W;return it().wrap(function(oe){for(;;)switch(oe.prev=oe.next){case 0:if(r.tileLayerService.hasTile(O.key)){oe.next=9;break}return B=G5(r.parent),W=new B(O,r.parent),oe.next=5,W.initTileLayer();case 5:r.tilePickService.setPickState(),W.getLayers().length!==0&&(r.tileLayerService.addTile(W),r.tileLayerService.updateTileVisible(O),r.layerService.reRender()),oe.next=12;break;case 9:r.tileLayerService.updateTileVisible(O),r.tilePickService.setPickState(),r.layerService.reRender();case 12:case"end":return oe.stop()}},M)}));return function(M){return x.apply(this,arguments)}}()));case 6:this.tilesetManager.isLoaded&&this.parent.emit("tiles-loaded",this.tilesetManager.currentTiles);case 7:case"end":return g.stop()}},n,this)}));function t(){return i.apply(this,arguments)}return t}()},{key:"setPickState",value:function(t){}},{key:"pickRender",value:function(t){this.tilePickService.pickRender(t)}},{key:"selectFeature",value:function(t){this.tilePickService.selectFeature(t)}},{key:"highlightPickedFeature",value:function(t){this.tilePickService.highlightPickedFeature(t)}},{key:"proxy",value:function(t){var n=this;j5.forEach(function(r){var a=t[r].bind(t);t[r]=function(){for(var u=arguments.length,c=new Array(u),g=0;g<u;g++)c[g]=arguments[g];return a.apply(void 0,c),n.getLayers().map(function(x){x[r].apply(x,c)}),r==="style"&&n.getTiles().forEach(function(x){return x.styleUpdate.apply(x,c)}),t}})}}]),e}(),m2,y2,H5=(m2=(0,vr.b2)(),m2(y2=function(){function e(){(0,se.Z)(this,e)}return(0,be.Z)(e,[{key:"build",value:function(){var i=(0,ur.Z)(it().mark(function n(r){return it().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return r.prepareBuildModel(),u.next=3,r.buildModels();case 3:case"end":return u.stop()}},n)}));function t(n){return i.apply(this,arguments)}return t}()},{key:"initLayerModel",value:function(){var i=(0,ur.Z)(it().mark(function n(r){return it().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.next=2,this.build(r);case 2:r.styleNeedUpdate=!1;case 3:case"end":return u.stop()}},n,this)}));function t(n){return i.apply(this,arguments)}return t}()},{key:"prepareLayerModel",value:function(){var i=(0,ur.Z)(it().mark(function n(r){return it().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.next=2,this.build(r);case 2:r.styleNeedUpdate=!1;case 3:case"end":return u.stop()}},n,this)}));function t(n){return i.apply(this,arguments)}return t}()},{key:"apply",value:function(t){var n=this;t.hooks.init.tapPromise("LayerModelPlugin",(0,ur.Z)(it().mark(function r(){return it().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:if(!t.getSource().isTile){u.next=4;break}return t.prepareBuildModel(),t.tileLayer=new g2(t),u.abrupt("return");case 4:return t.log(Js.BuildModelStart,us.INIT),u.next=7,n.initLayerModel(t);case 7:t.log(Js.BuildModelEnd,us.INIT);case 8:case"end":return u.stop()}},r)}))),t.hooks.beforeRenderData.tapPromise("LayerModelPlugin",function(){var r=(0,ur.Z)(it().mark(function a(u){return it().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:if(u){g.next=2;break}return g.abrupt("return",!1);case 2:if(!t.getSource().isTile){g.next=5;break}return t.tileLayer=new g2(t),g.abrupt("return",!1);case 5:return t.log(Js.BuildModelStart,us.UPDATE),g.next=8,n.prepareLayerModel(t);case 8:return t.log(Js.BuildModelEnd,us.UPDATE),g.abrupt("return",!0);case 10:case"end":return g.stop()}},a)}));return function(a){return r.apply(this,arguments)}}())}}]),e}())||y2),_2,x2,$5=(_2=(0,vr.b2)(),_2(x2=function(){function e(){(0,se.Z)(this,e)}return(0,be.Z)(e,[{key:"apply",value:function(t){t.hooks.afterInit.tap("LayerStylePlugin",function(){var n=t.getLayerConfig(),r=n.autoFit,a=n.fitBoundsOptions;r&&t.fitBounds(a),t.styleNeedUpdate=!1})}}]),e}())||x2),E2,b2,Y5=["type"],S2={directional:{lights:"u_DirectionalLights",num:"u_NumOfDirectionalLights"},spot:{lights:"u_SpotLights",num:"u_NumOfSpotLights"}},W5={type:"directional",direction:[1,10.5,12],ambient:[.2,.2,.2],diffuse:[.6,.6,.6],specular:[.1,.1,.1]},X5={direction:[0,0,0],ambient:[0,0,0],diffuse:[0,0,0],specular:[0,0,0]},Q5={position:[0,0,0],direction:[0,0,0],ambient:[0,0,0],diffuse:[0,0,0],specular:[0,0,0],constant:1,linear:0,quadratic:0,angle:14,exponent:40,blur:5};function q5(e){var i={u_DirectionalLights:new Array(3).fill((0,X.Z)({},X5)),u_NumOfDirectionalLights:0,u_SpotLights:new Array(3).fill((0,X.Z)({},Q5)),u_NumOfSpotLights:0};return(!e||!e.length)&&(e=[W5]),e.forEach(function(t){var n=t.type,r=n===void 0?"directional":n,a=(0,Ac.Z)(t,Y5),u=S2[r].lights,c=S2[r].num,g=i[c];i[u][g]=(0,X.Z)((0,X.Z)({},i[u][g]),a),i[c]++}),i}var K5=(E2=(0,vr.b2)(),E2(b2=function(){function e(){(0,se.Z)(this,e)}return(0,be.Z)(e,[{key:"apply",value:function(t){t.hooks.beforeRender.tap("LightingPlugin",function(){var n=t.getLayerConfig(),r=n.enableLighting;r&&t.models.forEach(function(a){return a.addUniforms((0,X.Z)({},q5()))})})}}]),e}())||b2),C2,w2,J5=(C2=(0,vr.b2)(),C2(w2=function(){function e(){(0,se.Z)(this,e)}return(0,be.Z)(e,[{key:"apply",value:function(t,n){var r=this,a=n.rendererService,u=n.postProcessingPassFactory,c=n.normalPassFactory;t.hooks.init.tapPromise("MultiPassRendererPlugin",function(){var g=t.getLayerConfig(),x=g.enableMultiPassRenderer,M=g.passes,O=M===void 0?[]:M;r.enabled=!!x&&t.getLayerConfig().enableMultiPassRenderer!==!1,r.enabled&&(t.multiPassRenderer=Fy(t,O,u,c),t.multiPassRenderer.setRenderFlag(!0))}),t.hooks.beforeRender.tap("MultiPassRendererPlugin",function(){if(r.enabled){var g=a.getViewportSize(),x=g.width,M=g.height;t.multiPassRenderer.resize(x,M)}})}}]),e}())||w2),T2,M2,rv={NONE:0,ENCODE:1,HIGHLIGHT:2},e6=(T2=(0,vr.b2)(),T2(M2=function(){function e(){(0,se.Z)(this,e)}return(0,be.Z)(e,[{key:"apply",value:function(t,n){var r=n.styleAttributeService;t.hooks.init.tapPromise("PixelPickingPlugin",function(){var a=t.getLayerConfig(),u=a.enablePicking;r.registerStyleAttribute({name:"pickingColor",type:mn.Attribute,descriptor:{name:"a_PickingColor",buffer:{data:[],type:je.FLOAT},size:3,update:function(g){var x=g.id;return u?bs(x):[0,0,0]}}})}),t.hooks.beforePickingEncode.tap("PixelPickingPlugin",function(){var a=t.getLayerConfig(),u=a.enablePicking;u&&t.isVisible()&&t.models.forEach(function(c){return c.addUniforms({u_PickingStage:rv.ENCODE})})}),t.hooks.afterPickingEncode.tap("PixelPickingPlugin",function(){var a=t.getLayerConfig(),u=a.enablePicking;u&&t.isVisible()&&t.models.forEach(function(c){return c.addUniforms({u_PickingStage:rv.HIGHLIGHT})})}),t.hooks.beforeHighlight.tap("PixelPickingPlugin",function(a){var u=t.getLayerConfig(),c=u.highlightColor,g=u.activeMix,x=g===void 0?0:g,M=typeof c=="string"?Ni(c):c||[1,0,0,1];t.updateLayerConfig({pickedFeatureID:io(new Uint8Array(a))}),t.models.forEach(function(O){return O.addUniforms({u_PickingStage:rv.HIGHLIGHT,u_PickingColor:a,u_HighlightColor:M.map(function(B){return B*255}),u_activeMix:x})})}),t.hooks.beforeSelect.tap("PixelPickingPlugin",function(a){var u=t.getLayerConfig(),c=u.selectColor,g=u.selectMix,x=g===void 0?0:g,M=typeof c=="string"?Ni(c):c||[1,0,0,1];t.updateLayerConfig({pickedFeatureID:io(new Uint8Array(a))}),t.models.forEach(function(O){return O.addUniforms({u_PickingStage:rv.HIGHLIGHT,u_PickingColor:a,u_HighlightColor:M.map(function(B){return B*255}),u_activeMix:x,u_CurrentSelectedId:a,u_SelectColor:M.map(function(B){return B*255}),u_EnableSelect:1})})})}}]),e}())||M2),t6=["mvt","geojsonvt","testTile"];function r6(e){var i=e.getSource();return t6.includes(i.parser.type)}function o8(e){return e.getContext?{width:e.width/DOM.DPR,height:e.height/DOM.DPR}:e.getBoundingClientRect()}var I2,P2,n6=(I2=(0,vr.b2)(),I2(P2=function(){function e(){(0,se.Z)(this,e)}return(0,be.Z)(e,[{key:"apply",value:function(t,n){var r=this,a=n.styleAttributeService;t.hooks.init.tapPromise("RegisterStyleAttributePlugin",function(){r6(t)||r.registerBuiltinAttributes(a,t)})}},{key:"registerBuiltinAttributes",value:function(t,n){if(n.type==="MaskLayer"){this.registerPositionAttribute(t);return}this.registerPositionAttribute(t),this.registerColorAttribute(t),this.registerVertexIdAttribute(t)}},{key:"registerPositionAttribute",value:function(t){t.registerStyleAttribute({name:"position",type:mn.Attribute,descriptor:{name:"a_Position",buffer:{data:[],type:je.FLOAT},size:3,update:function(r,a,u){return u.length===2?[u[0],u[1],0]:[u[0],u[1],u[2]]}}})}},{key:"registerFilterAttribute",value:function(t){t.registerStyleAttribute({name:"filter",type:mn.Attribute,descriptor:{name:"filter",buffer:{usage:je.DYNAMIC_DRAW,data:[],type:je.FLOAT},size:1,update:function(r){var a=r.filter;return a?[1]:[0]}}})}},{key:"registerColorAttribute",value:function(t){t.registerStyleAttribute({name:"color",type:mn.Attribute,descriptor:{name:"a_Color",buffer:{usage:je.DYNAMIC_DRAW,data:[],type:je.FLOAT},size:4,update:function(r){var a=r.color;return!a||!a.length?[1,1,1,1]:a}}})}},{key:"registerVertexIdAttribute",value:function(t){t.registerStyleAttribute({name:"vertexId",type:mn.Attribute,descriptor:{name:"a_vertexId",buffer:{usage:je.DYNAMIC_DRAW,data:[],type:je.FLOAT},size:1,update:function(r,a){return[a]}}})}}]),e}())||P2),L2,O2,R2,D2,k2,N2,dA,F2,B2,Z2,z2,i6=(L2=(0,vr.b2)(),O2=(0,vr.f3)(Xt.ICameraService),R2=(0,vr.f3)(Xt.ICoordinateSystemService),D2=(0,vr.f3)(Xt.IRendererService),k2=(0,vr.f3)(Xt.IMapService),L2(N2=(dA=function(){function e(){(0,se.Z)(this,e),Ki(this,"cameraService",F2,this),Ki(this,"coordinateSystemService",B2,this),Ki(this,"rendererService",Z2,this),Ki(this,"mapService",z2,this)}return(0,be.Z)(e,[{key:"apply",value:function(t){var n=this,r=this.mapService.version,a=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],u=[0,0];t.hooks.beforeRender.tap("ShaderUniformPlugin",function(){var c=t.getLayerConfig().tileOrigin;n.coordinateSystemService.refresh(c),r==="GAODE2.x"&&(n.setLayerCenter(t),a=n.mapService.map.customCoords.getMVPMatrix(),u=n.mapService.getCustomCoordCenter());var g=n.rendererService.getViewportSize(),x=g.width,M=g.height;t.models.forEach(function(O){var B;O.addUniforms((B={},(0,Me.Z)(B,Ah.ProjectionMatrix,n.cameraService.getProjectionMatrix()),(0,Me.Z)(B,Ah.ViewMatrix,n.cameraService.getViewMatrix()),(0,Me.Z)(B,Ah.ViewProjectionMatrix,n.cameraService.getViewProjectionMatrix()),(0,Me.Z)(B,Ah.Zoom,n.cameraService.getZoom()),(0,Me.Z)(B,Ah.ZoomScale,n.cameraService.getZoomScale()),(0,Me.Z)(B,Ah.FocalDistance,n.cameraService.getFocalDistance()),(0,Me.Z)(B,Ah.CameraPosition,n.cameraService.getCameraPosition()),(0,Me.Z)(B,df.CoordinateSystem,n.coordinateSystemService.getCoordinateSystem()),(0,Me.Z)(B,df.ViewportCenter,n.coordinateSystemService.getViewportCenter()),(0,Me.Z)(B,df.ViewportCenterProjection,n.coordinateSystemService.getViewportCenterProjection()),(0,Me.Z)(B,df.PixelsPerDegree,n.coordinateSystemService.getPixelsPerDegree()),(0,Me.Z)(B,df.PixelsPerDegree2,n.coordinateSystemService.getPixelsPerDegree2()),(0,Me.Z)(B,df.PixelsPerMeter,n.coordinateSystemService.getPixelsPerMeter()),(0,Me.Z)(B,df.Mvp,a),(0,Me.Z)(B,"u_sceneCenterMercator",u),(0,Me.Z)(B,"u_ViewportSize",[x,M]),(0,Me.Z)(B,"u_ModelMatrix",n.cameraService.getModelMatrix()),(0,Me.Z)(B,"u_DevicePixelRatio",window.devicePixelRatio),(0,Me.Z)(B,"u_PickingBuffer",t.getLayerConfig().pickingBuffer||0),(0,Me.Z)(B,"u_shaderPick",Number(t.getShaderPickStat())),B))})})}},{key:"setLayerCenter",value:function(t){t.coordCenter===void 0&&(t.coordCenter=t.getSource().center),this.mapService.setCoordCenter&&this.mapService.setCoordCenter(t.coordCenter)}}]),e}(),F2=Hi(dA.prototype,"cameraService",[O2],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),B2=Hi(dA.prototype,"coordinateSystemService",[R2],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Z2=Hi(dA.prototype,"rendererService",[D2],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),z2=Hi(dA.prototype,"mapService",[k2],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),dA))||N2),U2,G2,a6=(U2=(0,vr.b2)(),U2(G2=function(){function e(){(0,se.Z)(this,e)}return(0,be.Z)(e,[{key:"apply",value:function(t){t.hooks.beforeRender.tap("UpdateModelPlugin",function(){t.layerModel&&t.layerModel.needUpdate().then(function(n){n&&t.renderLayers()})}),t.hooks.afterRender.tap("UpdateModelPlugin",function(){t.layerModelNeedUpdate=!1})}}]),e}())||G2),j2,V2,o6=(j2=(0,vr.b2)(),j2(V2=function(){function e(){(0,se.Z)(this,e)}return(0,be.Z)(e,[{key:"apply",value:function(t,n){var r=this,a=n.styleAttributeService;t.hooks.init.tapPromise("UpdateStyleAttributePlugin",function(){r.initStyleAttribute(t,{styleAttributeService:a})}),t.hooks.beforeRender.tap("UpdateStyleAttributePlugin",function(){t.layerModelNeedUpdate||t.inited&&r.updateStyleAttribute(t,{styleAttributeService:a})})}},{key:"updateStyleAttribute",value:function(t,n){var r=n.styleAttributeService,a=r.getLayerStyleAttributes()||[],u=r.getLayerStyleAttribute("filter");if(u&&u.needRegenerateVertices){t.layerModelNeedUpdate=!0,a.forEach(function(c){return c.needRegenerateVertices=!1});return}a.filter(function(c){return c.needRegenerateVertices}).forEach(function(c){r.updateAttributeByFeatureRange(c.name,t.getEncodedData(),c.featureRange.startIndex,c.featureRange.endIndex,t),c.needRegenerateVertices=!1})}},{key:"initStyleAttribute",value:function(t,n){var r=n.styleAttributeService,a=r.getLayerStyleAttributes()||[];a.filter(function(u){return u.needRegenerateVertices}).forEach(function(u){r.updateAttributeByFeatureRange(u.name,t.getEncodedData(),u.featureRange.startIndex,u.featureRange.endIndex),u.needRegenerateVertices=!1})}}]),e}())||V2);ql.bind(Xt.ILayerPlugin).to(fT).inRequestScope(),ql.bind(Xt.ILayerPlugin).to(n6).inRequestScope(),ql.bind(Xt.ILayerPlugin).to(OI).inRequestScope(),ql.bind(Xt.ILayerPlugin).to(cT).inRequestScope(),ql.bind(Xt.ILayerPlugin).to($5).inRequestScope(),ql.bind(Xt.ILayerPlugin).to(DI).inRequestScope(),ql.bind(Xt.ILayerPlugin).to(o6).inRequestScope(),ql.bind(Xt.ILayerPlugin).to(a6).inRequestScope(),ql.bind(Xt.ILayerPlugin).to(J5).inRequestScope(),ql.bind(Xt.ILayerPlugin).to(i6).inRequestScope(),ql.bind(Xt.ILayerPlugin).to(RI).inRequestScope(),ql.bind(Xt.ILayerPlugin).to(K5).inRequestScope(),ql.bind(Xt.ILayerPlugin).to(e6).inRequestScope(),ql.bind(Xt.ILayerPlugin).to(H5).inRequestScope();var H2,Gg,$2,s6=(H2=rg(Xt.IGlobalConfigService),Gg=function(){function e(i){(0,se.Z)(this,e),Ki(this,"configService",$2,this),this.config=i}return(0,be.Z)(e,[{key:"setContainer",value:function(t,n,r,a){t.bind(Xt.MapConfig).toConstantValue((0,X.Z)((0,X.Z)({},this.config),{},{id:n,canvas:r,hasBaseMap:a})),t.bind(Xt.IMapService).to(this.getServiceConstructor()).inSingletonScope()}},{key:"getServiceConstructor",value:function(){throw new Error("Method not implemented.")}}]),e}(),$2=Hi(Gg.prototype,"configService",[H2],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Gg),u6=C(81618),Y2=C.n(u6);function Pp(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function nv(e,i){var t=nh([],i,e);return Zh(t,t,1/t[3]),t}function s8(e,i){var t=e%i;return t<0?i+t:t}function u8(e,i,t){return t*i+(1-t)*e}function yh(e,i){if(!e)throw new Error(i||"viewport-mercator-project: assertion failed.")}var vf=Math.PI,W2=vf/4,n0=vf/180,X2=180/vf,jg=512,Vg=4003e4,l6=1.5;function Q2(e){return Math.pow(2,e)}function c6(e){return Math.log2(e)}function iv(e,i){var t=(0,vn.Z)(e,2),n=t[0],r=t[1];yh(Number.isFinite(n)&&Number.isFinite(i)),yh(Number.isFinite(r)&&r>=-90&&r<=90,"invalid latitude"),i*=jg;var a=n*n0,u=r*n0,c=i*(a+vf)/(2*vf),g=i*(vf-Math.log(Math.tan(W2+u*.5)))/(2*vf);return[c,g]}function Hg(e,i){var t=(0,vn.Z)(e,2),n=t[0],r=t[1];i*=jg;var a=n/i*(2*vf)-vf,u=2*(Math.atan(Math.exp(vf-r/i*(2*vf)))-W2);return[a*X2,u*X2]}function l8(e){var i=e.latitude;assert(Number.isFinite(i));var t=Math.cos(i*n0);return c6(Vg*t)-9}function q2(e){var i=e.latitude,t=e.longitude,n=e.zoom,r=e.scale,a=e.highPrecision,u=a===void 0?!1:a;r=r!==void 0?r:Q2(n),yh(Number.isFinite(i)&&Number.isFinite(t)&&Number.isFinite(r));var c={},g=jg*r,x=Math.cos(i*n0),M=g/360,O=M/x,B=g/Vg/x;if(c.pixelsPerMeter=[B,-B,B],c.metersPerPixel=[1/B,-1/B,1/B],c.pixelsPerDegree=[M,-O,B],c.degreesPerPixel=[1/M,-1/O,1/B],u){var W=n0*Math.tan(i*n0)/x,ce=M*W/2,oe=g/Vg*W,Te=oe/O*B;c.pixelsPerDegree2=[0,-ce,oe],c.pixelsPerMeter2=[Te,0,Te]}return c}function c8(e,i){var t=_slicedToArray(e,3),n=t[0],r=t[1],a=t[2],u=_slicedToArray(i,3),c=u[0],g=u[1],x=u[2],M=1,O=q2({longitude:n,latitude:r,scale:M,highPrecision:!0}),B=O.pixelsPerMeter,W=O.pixelsPerMeter2,ce=iv(e,M);ce[0]+=c*(B[0]+W[0]*g),ce[1]+=g*(B[1]+W[1]*g);var oe=Hg(ce,M),Te=(a||0)+(x||0);return Number.isFinite(a)||Number.isFinite(x)?[oe[0],oe[1],Te]:oe}function f6(e){var i=e.height,t=e.pitch,n=e.bearing,r=e.altitude,a=e.center,u=a===void 0?null:a,c=e.flipY,g=c===void 0?!1:c,x=Pp();return Ks(x,x,[0,0,-r]),So(x,x,[1,1,1/i]),fc(x,x,-t*n0),K0(x,x,n*n0),g&&So(x,x,[1,-1,1]),u&&Ks(x,x,r1([],u)),x}function h6(e){var i=e.width,t=e.height,n=e.altitude,r=n===void 0?l6:n,a=e.pitch,u=a===void 0?0:a,c=e.nearZMultiplier,g=c===void 0?1:c,x=e.farZMultiplier,M=x===void 0?1:x,O=u*n0,B=Math.atan(.5/r),W=Math.sin(B)*r/Math.sin(Math.PI/2-O-B),ce=Math.cos(Math.PI/2-O)*W+r;return{fov:2*Math.atan(t/2/r),aspect:i/t,focalDistance:r,near:g,far:ce*M}}function A6(e){var i=e.width,t=e.height,n=e.pitch,r=e.altitude,a=e.nearZMultiplier,u=e.farZMultiplier,c=h6({width:i,height:t,altitude:r,pitch:n,nearZMultiplier:a,farZMultiplier:u}),g=c.fov,x=c.aspect,M=c.near,O=c.far,B=qf([],g,x,M,O);return B}function p6(e,i){var t=(0,vn.Z)(e,3),n=t[0],r=t[1],a=t[2],u=a===void 0?0:a;return yh(Number.isFinite(n)&&Number.isFinite(r)&&Number.isFinite(u)),nv(i,[n,r,u,1])}function K2(e,i){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,n=(0,vn.Z)(e,3),r=n[0],a=n[1],u=n[2];if(yh(Number.isFinite(r)&&Number.isFinite(a),"invalid pixel coordinate"),Number.isFinite(u)){var c=nv(i,[r,a,u,1]);return c}var g=nv(i,[r,a,0,1]),x=nv(i,[r,a,1,1]),M=g[2],O=x[2],B=M===O?0:((t||0)-M)/(O-M);return Sl([],g,x,B)}var J2=Pp(),d6=function(){function e(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=i.width,n=i.height,r=i.viewMatrix,a=r===void 0?J2:r,u=i.projectionMatrix,c=u===void 0?J2:u;(0,se.Z)(this,e),this.width=t||1,this.height=n||1,this.scale=1,this.pixelsPerMeter=1,this.viewMatrix=a,this.projectionMatrix=c;var g=Pp();ja(g,g,this.projectionMatrix),ja(g,g,this.viewMatrix),this.viewProjectionMatrix=g;var x=Pp();So(x,x,[this.width/2,-this.height/2,1]),Ks(x,x,[1,-1,0]),ja(x,x,this.viewProjectionMatrix);var M=kp(Pp(),x);if(!M)throw new Error("Pixel project matrix not invertible");this.pixelProjectionMatrix=x,this.pixelUnprojectionMatrix=M,this.equals=this.equals.bind(this),this.project=this.project.bind(this),this.unproject=this.unproject.bind(this),this.projectPosition=this.projectPosition.bind(this),this.unprojectPosition=this.unprojectPosition.bind(this),this.projectFlat=this.projectFlat.bind(this),this.unprojectFlat=this.unprojectFlat.bind(this)}return(0,be.Z)(e,[{key:"equals",value:function(t){return t instanceof e?t.width===this.width&&t.height===this.height&&gu(t.projectionMatrix,this.projectionMatrix)&&gu(t.viewMatrix,this.viewMatrix):!1}},{key:"project",value:function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=n.topLeft,a=r===void 0?!0:r,u=this.projectPosition(t),c=p6(u,this.pixelProjectionMatrix),g=(0,vn.Z)(c,2),x=g[0],M=g[1],O=a?M:this.height-M;return t.length===2?[x,O]:[x,O,c[2]]}},{key:"unproject",value:function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=n.topLeft,a=r===void 0?!0:r,u=n.targetZ,c=(0,vn.Z)(t,3),g=c[0],x=c[1],M=c[2],O=a?x:this.height-x,B=u&&u*this.pixelsPerMeter,W=K2([g,O,M],this.pixelUnprojectionMatrix,B),ce=this.unprojectPosition(W),oe=(0,vn.Z)(ce,3),Te=oe[0],Ze=oe[1],qe=oe[2];return Number.isFinite(M)?[Te,Ze,qe]:Number.isFinite(u)?[Te,Ze,u]:[Te,Ze]}},{key:"projectPosition",value:function(t){var n=this.projectFlat(t),r=(0,vn.Z)(n,2),a=r[0],u=r[1],c=(t[2]||0)*this.pixelsPerMeter;return[a,u,c]}},{key:"unprojectPosition",value:function(t){var n=this.unprojectFlat(t),r=(0,vn.Z)(n,2),a=r[0],u=r[1],c=(t[2]||0)/this.pixelsPerMeter;return[a,u,c]}},{key:"projectFlat",value:function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.scale;return t}},{key:"unprojectFlat",value:function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.scale;return t}}]),e}();function v6(e){var i=e.width,t=e.height,n=e.bounds,r=e.minExtent,a=r===void 0?0:r,u=e.maxZoom,c=u===void 0?24:u,g=e.padding,x=g===void 0?0:g,M=e.offset,O=M===void 0?[0,0]:M,B=(0,vn.Z)(n,2),W=(0,vn.Z)(B[0],2),ce=W[0],oe=W[1],Te=(0,vn.Z)(B[1],2),Ze=Te[0],qe=Te[1];if(Number.isFinite(x)){var et=x;x={top:et,bottom:et,left:et,right:et}}else yh(Number.isFinite(x.top)&&Number.isFinite(x.bottom)&&Number.isFinite(x.left)&&Number.isFinite(x.right));var yt=new ex({width:i,height:t,longitude:0,latitude:0,zoom:0}),bt=yt.project([ce,qe]),Ot=yt.project([Ze,oe]),jt=[Math.max(Math.abs(Ot[0]-bt[0]),a),Math.max(Math.abs(Ot[1]-bt[1]),a)],or=[i-x.left-x.right-Math.abs(O[0])*2,t-x.top-x.bottom-Math.abs(O[1])*2];yh(or[0]>0&&or[1]>0);var ar=or[0]/jt[0],Sr=or[1]/jt[1],dr=(x.right-x.left)/2/ar,jr=(x.bottom-x.top)/2/Sr,nn=[(Ot[0]+bt[0])/2+dr,(Ot[1]+bt[1])/2+jr],En=yt.unproject(nn),_a=yt.zoom+Math.log2(Math.abs(Math.min(ar,Sr)));return{longitude:En[0],latitude:En[1],zoom:Math.min(_a,c)}}var ex=function(e){(0,Ne.Z)(i,e);function i(){var t,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=n.width,a=n.height,u=n.latitude,c=u===void 0?0:u,g=n.longitude,x=g===void 0?0:g,M=n.zoom,O=M===void 0?0:M,B=n.pitch,W=B===void 0?0:B,ce=n.bearing,oe=ce===void 0?0:ce,Te=n.altitude,Ze=Te===void 0?1.5:Te,qe=n.nearZMultiplier,et=n.farZMultiplier;(0,se.Z)(this,i),r=r||1,a=a||1;var yt=Q2(O);Ze=Math.max(.75,Ze);var bt=iv([x,c],yt);bt[2]=0;var Ot=A6({width:r,height:a,pitch:W,bearing:oe,altitude:Ze,nearZMultiplier:qe||1/a,farZMultiplier:et||1.01}),jt=f6({height:a,center:bt,pitch:W,bearing:oe,altitude:Ze,flipY:!0});return t=(0,ze.Z)(this,(0,ue.Z)(i).call(this,{width:r,height:a,viewMatrix:jt,projectionMatrix:Ot})),t.latitude=c,t.longitude=x,t.zoom=O,t.pitch=W,t.bearing=oe,t.altitude=Ze,t.scale=yt,t.center=bt,t.pixelsPerMeter=q2((0,xt.Z)((0,xt.Z)(t))).pixelsPerMeter[2],Object.freeze((0,xt.Z)((0,xt.Z)(t))),t}return(0,be.Z)(i,[{key:"projectFlat",value:function(n){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.scale;return iv(n,r)}},{key:"unprojectFlat",value:function(n){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.scale;return Hg(n,r)}},{key:"getMapCenterByLngLatPosition",value:function(n){var r=n.lngLat,a=n.pos,u=K2(a,this.pixelUnprojectionMatrix),c=iv(r,this.scale),g=oo([],c,Tu([],u)),x=oo([],this.center,g);return Hg(x,this.scale)}},{key:"getLocationAtPoint",value:function(n){var r=n.lngLat,a=n.pos;return this.getMapCenterByLngLatPosition({lngLat:r,pos:a})}},{key:"fitBounds",value:function(n){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},a=this.width,u=this.height,c=v6(Object.assign({width:a,height:u,bounds:n},r)),g=c.longitude,x=c.latitude,M=c.zoom;return new i({width:a,height:u,longitude:g,latitude:x,zoom:M})}}]),i}(d6),g6=function(){function e(){(0,se.Z)(this,e)}return(0,be.Z)(e,[{key:"syncWithMapCamera",value:function(t){var n=t.center,r=t.zoom,a=t.pitch,u=t.bearing,c=t.viewportHeight,g=t.viewportWidth,x=this.viewport?{width:this.viewport.width,height:this.viewport.height,longitude:this.viewport.center[0],latitude:this.viewport.center[1],zoom:this.viewport.zoom,pitch:this.viewport.pitch,bearing:this.viewport.bearing}:{};this.viewport=new ex((0,X.Z)((0,X.Z)({},x),{},{width:g,height:c,longitude:n&&n[0],latitude:n&&n[1],zoom:r,pitch:a,bearing:u}))}},{key:"getZoom",value:function(){return this.viewport.zoom}},{key:"getZoomScale",value:function(){return Math.pow(2,this.getZoom())}},{key:"getCenter",value:function(){return[this.viewport.longitude,this.viewport.latitude]}},{key:"getProjectionMatrix",value:function(){return this.viewport.projectionMatrix}},{key:"getModelMatrix",value:function(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}},{key:"getViewMatrix",value:function(){return this.viewport.viewMatrix}},{key:"getViewMatrixUncentered",value:function(){return this.viewport.viewMatrixUncentered}},{key:"getViewProjectionMatrix",value:function(){return this.viewport.viewProjectionMatrix}},{key:"getViewProjectionMatrixUncentered",value:function(){return this.viewport.viewProjectionMatrix}},{key:"getFocalDistance",value:function(){return 1}},{key:"projectFlat",value:function(t,n){return this.viewport.projectFlat(t,n)}}]),e}(),m6=function(){function e(i){(0,se.Z)(this,e),(0,Me.Z)(this,"size",1e4),this.size=i||1e4}return(0,be.Z)(e,[{key:"setSize",value:function(t){this.size=t}},{key:"getSize",value:function(){return[this.size,this.size]}},{key:"mercatorXfromLng",value:function(t){return(180+t)/360*this.size}},{key:"mercatorYfromLat",value:function(t){return(1-(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+t*Math.PI/360)))/360)*this.size}},{key:"lngFromMercatorX",value:function(t){return t/this.size*360-180}},{key:"latFromMercatorY",value:function(t){var n=180-(1-t/this.size)*360;return 360/Math.PI*Math.atan(Math.exp(n*Math.PI/180))-90}},{key:"project",value:function(t){var n=this.mercatorXfromLng(t[0]),r=this.mercatorYfromLat(t[1]);return[n,r]}},{key:"unproject",value:function(t){var n=this.lngFromMercatorX(t[0]),r=this.latFromMercatorY(t[1]);return[n,r]}}]),e}();function tx(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},i={top:0,right:0,bottom:0,left:0};if(typeof e=="number")return{top:e,right:e,bottom:e,left:e};if(Array.isArray(e)){if(e.length===4)return{top:e[0],right:e[1],bottom:e[2],left:e[3]};if(e.length===2)return{top:e[0],right:e[1],bottom:e[0],left:e[1]}}return(0,X.Z)((0,X.Z)({},i),e)}var y6={normal:"amap://styles/normal",light:"amap://styles/c422f5c0cfced5be9fe3a83f05f28a68?isPublic=true",dark:"amap://styles/c9f1d10cae34f8ab05e425462c5a58d7?isPublic=true",blank:"amap://styles/07c17002b38775b32a7a76c66cf90e99?isPublic=true",fresh:"amap://styles/fresh",grey:"amap://styles/grey",graffiti:"amap://styles/graffiti",macaron:"amap://styles/macaron",darkblue:"amap://styles/darkblue",wine:"amap://styles/wine"},_6=["id","style","minZoom","maxZoom","token","mapInstance","plugin"],rx,nx,ix,ax,ox,sx,vA,ux,lx,cx,fx;function x6(e,i){var t=typeof my!="undefined"&&!!my&&typeof my.showToast=="function"&&my.isFRM!==!0,n=typeof wx!="undefined"&&wx!==null&&(typeof wx.request!="undefined"||typeof wx.miniProgram!="undefined");if(!(t||n)&&(i||(i=document),!!i)){var r=i.head||i.getElementsByTagName("head")[0];if(!r){r=i.createElement("head");var a=i.body||i.getElementsByTagName("body")[0];a?a.parentNode.insertBefore(r,a):i.documentElement.appendChild(r)}var u=i.createElement("style");return u.type="text/css",u.styleSheet?u.styleSheet.cssText=e:u.appendChild(i.createTextNode(e)),r.appendChild(u),u}}x6(`.amap-logo{
 display: none !important;
}
`);var E6={contextmenu:"rightclick"},b6={contextmenu:"rightclick",camerachange:"viewchange"},hx={"GAODE1.x":E6,"GAODE2.x":b6},S6=0;window.forceWebGL=!0;var Ax="15cd8a57710d40c9b7c0e3cc120f1200",C6="1.4.15",w6="amap-script",$g=!1,av=[],T6=12,M6=(rx=(0,vr.b2)(),nx=(0,vr.f3)(Xt.IGlobalConfigService),ix=(0,vr.f3)(Xt.MapConfig),ax=(0,vr.f3)(Xt.ICoordinateSystemService),ox=(0,vr.f3)(Xt.IEventEmitter),rx(sx=(vA=function(){function e(){var i=this;(0,se.Z)(this,e),(0,Me.Z)(this,"version",bu["GAODE1.x"]),(0,Me.Z)(this,"simpleMapCoord",new m6),(0,Me.Z)(this,"bgColor","rgba(0, 0, 0, 0)"),Ki(this,"configService",ux,this),Ki(this,"config",lx,this),Ki(this,"coordinateSystemService",cx,this),Ki(this,"eventEmitter",fx,this),(0,Me.Z)(this,"handleCameraChanged",function(t){var n=t.camera,r=n.fov,a=n.near,u=n.far,c=n.height,g=n.pitch,x=n.rotation,M=n.aspect,O=n.position,B=i.getCenter(),W=B.lng,ce=B.lat;if(i.emit("mapchange"),i.cameraChangedCallback){i.viewport.syncWithMapCamera({aspect:M,bearing:360-x,far:u,fov:r,cameraHeight:c,near:a,pitch:g,zoom:i.map.getZoom()-1,center:[W,ce],offsetOrigin:[O.x,O.y]});var oe=i.config.offsetZoom,Te=oe===void 0?T6:oe;i.viewport.getZoom()>Te?i.coordinateSystemService.setCoordinateSystem(Bc.P20_OFFSET):i.coordinateSystemService.setCoordinateSystem(Bc.P20),i.cameraChangedCallback(i.viewport)}})}return(0,be.Z)(e,[{key:"setBgColor",value:function(t){this.bgColor=t}},{key:"addMarkerContainer",value:function(){var t=this.map.getContainer();if(t!==null){var n=t.getElementsByClassName("amap-maps")[0];this.markerContainer=ni("div","l7-marker-container",n)}}},{key:"getMarkerContainer",value:function(){return this.markerContainer}},{key:"on",value:function(t,n){yy.indexOf(t)!==-1?this.eventEmitter.on(t,n):this.map.on(hx[this.version][t]||t,n)}},{key:"off",value:function(t,n){yy.indexOf(t)!==-1?this.eventEmitter.off(t,n):this.map.off(hx[this.version][t]||t,n)}},{key:"getContainer",value:function(){return this.map.getContainer()}},{key:"getMapCanvasContainer",value:function(){var t;return(t=this.map.getContainer())===null||t===void 0?void 0:t.getElementsByClassName("amap-maps")[0]}},{key:"getSize",value:function(){var t=this.map.getSize();return[t.getWidth(),t.getHeight()]}},{key:"getType",value:function(){return"amap"}},{key:"getZoom",value:function(){return this.map.getZoom()-1}},{key:"setZoom",value:function(t){return this.map.setZoom(t+1)}},{key:"getCenter",value:function(t){if(t!=null&&t.padding){var n=this.getCenter(),r=tx(t.padding),a=this.lngLatToPixel([n.lng,n.lat]),u=[(r.right-r.left)/2,(r.bottom-r.top)/2],c=this.pixelToLngLat([a.x-u[0],a.y-u[1]]);return c}var g=this.map.getCenter();return{lng:g.getLng(),lat:g.getLat()}}},{key:"setCenter",value:function(t,n){if(n!=null&&n.padding){var r=tx(n.padding),a=this.lngLatToPixel(t),u=[(r.right-r.left)/2,(r.bottom-r.top)/2],c=this.pixelToLngLat([a.x+u[0],a.y+u[1]]);this.map.setCenter([c.lng,c.lat])}else this.map.setCenter(t)}},{key:"getPitch",value:function(){return this.map.getPitch()}},{key:"getRotation",value:function(){return 360-this.map.getRotation()}},{key:"getBounds",value:function(){var t=this.map.getBounds().toBounds(),n=t.getNorthEast(),r=t.getSouthWest(),a=this.getCenter(),u=a.lng>n.getLng()||a.lng<r.getLng()?180-n.getLng():n.getLng(),c=a.lng<r.getLng()?r.getLng()-180:r.getLng();return[[c,r.getLat()],[u,n.getLat()]]}},{key:"getMinZoom",value:function(){var t=this.map.get("zooms");return t[0]-1}},{key:"getMaxZoom",value:function(){var t=this.map.get("zooms");return t[1]-1}},{key:"setRotation",value:function(t){return this.map.setRotation(t)}},{key:"setPitch",value:function(t){return this.map.setPitch(t)}},{key:"zoomIn",value:function(){this.map.zoomIn()}},{key:"zoomOut",value:function(){this.map.zoomOut()}},{key:"panTo",value:function(t){this.map.panTo(t)}},{key:"panBy",value:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;this.map.panBy(t,n)}},{key:"fitBounds",value:function(t){this.map.setBounds(new AMap.Bounds([t[0][0],t[0][1],t[1][0],t[1][1]]))}},{key:"setZoomAndCenter",value:function(t,n){this.map.setZoomAndCenter(t+1,n)}},{key:"setMapStyle",value:function(t){this.map.setMapStyle(this.getMapStyleValue(t))}},{key:"setMapStatus",value:function(t){this.map.setStatus(t)}},{key:"getMapStyleConfig",value:function(){return y6}},{key:"getMapStyleValue",value:function(t){return this.getMapStyleConfig()[t]||t}},{key:"getMapStyle",value:function(){return this.map.getMapStyle()}},{key:"pixelToLngLat",value:function(t){var n=this.map.pixelToLngLat(new AMap.Pixel(t[0],t[1]));return{lng:n.getLng(),lat:n.getLat()}}},{key:"lngLatToPixel",value:function(t){var n=this.map.lnglatToPixel(new AMap.LngLat(t[0],t[1]));return{x:n.getX(),y:n.getY()}}},{key:"containerToLngLat",value:function(t){var n=new AMap.Pixel(t[0],t[1]),r=this.map.containerToLngLat(n);return{lng:r==null?void 0:r.getLng(),lat:r==null?void 0:r.getLat()}}},{key:"lngLatToContainer",value:function(t){var n=new AMap.LngLat(t[0],t[1]),r=this.map.lngLatToContainer(n);return{x:r.getX(),y:r.getY()}}},{key:"lngLatToCoord",value:function(t){var n=this.map.lngLatToGeodeticCoord(t),r=n.x,a=n.y;return[r,-a]}},{key:"lngLatToMercator",value:function(t,n){return{x:0,y:0,z:0}}},{key:"getModelMatrix",value:function(t,n,r){var a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:[1,1,1],u=this.viewport.projectFlat(t),c=Qn();return Ks(c,c,Pu(u[0],u[1],n)),So(c,c,Pu(a[0],a[1],a[2])),fc(c,c,r[0]),q0(c,c,r[1]),K0(c,c,r[2]),c}},{key:"init",value:function(){var i=(0,ur.Z)(it().mark(function n(){var r=this,a,u,c,g,x,M,O,B,W,ce,oe,Te,Ze,qe;return it().wrap(function(yt){for(;;)switch(yt.prev=yt.next){case 0:return a=this.config,u=a.id,c=a.style,g=c===void 0?"light":c,x=a.minZoom,M=x===void 0?0:x,O=a.maxZoom,B=O===void 0?18:O,W=a.token,ce=W===void 0?Ax:W,oe=a.mapInstance,Te=a.plugin,Ze=Te===void 0?[]:Te,qe=(0,Ac.Z)(a,_6),yt.next=3,new Promise(function(bt){var Ot=function(){if(oe)r.map=oe,r.$mapContainer=r.map.getContainer(),setTimeout(function(){r.map.on("camerachange",r.handleCameraChanged),bt()},30);else{r.$mapContainer=r.creatMapContainer(u);var or=(0,X.Z)({mapStyle:r.getMapStyleValue(g),zooms:[M,B],viewMode:"3D"},qe);or.zoom&&(or.zoom+=1);var ar=new AMap.Map(r.$mapContainer,or);ar.on("camerachange",r.handleCameraChanged),ar.on("camerachange",function(){setTimeout(function(){return r.handleAfterMapChange()})}),r.map=ar,setTimeout(function(){bt()},10)}};!$g&&!oe?(ce===Ax&&console.warn("%c".concat(r.configService.getSceneWarninfo("MapToken"),"!"),"color: #873bf4;font-weigh:900;font-size: 16px;"),$g=!0,Ze.push("Map3D"),Y2().load({key:ce,version:C6,plugins:Ze}).then(function(){Ot(),av.length&&(av.forEach(function(jt){return jt()}),av=[])}).catch(function(jt){throw new Error(jt)})):$g&&window.AMap||oe?Ot():av.push(Ot)});case 3:this.viewport=new g6;case 4:case"end":return yt.stop()}},n,this)}));function t(){return i.apply(this,arguments)}return t}()},{key:"meterToCoord",value:function(t,n){var r=AMap.GeometryUtil.distance(Ut(AMap.LngLat,(0,pr.Z)(t)),Ut(AMap.LngLat,(0,pr.Z)(n))),a=this.lngLatToCoord(t),u=(0,vn.Z)(a,2),c=u[0],g=u[1],x=this.lngLatToCoord(n),M=(0,vn.Z)(x,2),O=M[0],B=M[1],W=Math.sqrt(Math.pow(c-O,2)+Math.pow(g-B,2));return W/r}},{key:"updateView",value:function(t){}},{key:"getOverlayContainer",value:function(){}},{key:"exportMap",value:function(t){var n,r=(n=this.getContainer())===null||n===void 0?void 0:n.getElementsByClassName("amap-layer")[0],a=t==="jpg"?r==null?void 0:r.toDataURL("image/jpeg"):r==null?void 0:r.toDataURL("image/png");return a}},{key:"emit",value:function(t){for(var n,r=arguments.length,a=new Array(r>1?r-1:0),u=1;u<r;u++)a[u-1]=arguments[u];(n=this.eventEmitter).emit.apply(n,[t].concat(a))}},{key:"once",value:function(t){for(var n,r=arguments.length,a=new Array(r>1?r-1:0),u=1;u<r;u++)a[u-1]=arguments[u];(n=this.eventEmitter).once.apply(n,[t].concat(a))}},{key:"destroy",value:function(){var t,n;(t=this.$mapContainer)===null||t===void 0||(n=t.parentNode)===null||n===void 0||n.removeChild(this.$mapContainer),delete window.initAMap;var r=document.getElementById(w6);r&&document.head.removeChild(r),this.map.destroy()}},{key:"getMapContainer",value:function(){return this.$mapContainer}},{key:"onCameraChanged",value:function(t){this.cameraChangedCallback=t}},{key:"handleAfterMapChange",value:function(){this.emit("mapAfterFrameChange")}},{key:"creatMapContainer",value:function(t){var n=t;typeof t=="string"&&(n=document.getElementById(t));var r=document.createElement("div");return r.style.cssText+=`
       position: absolute;
       top: 0;
       height: 100%;
       width: 100%;
     `,r.id="l7_amap_div"+S6++,n.appendChild(r),r}}]),e}(),ux=Hi(vA.prototype,"configService",[nx],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),lx=Hi(vA.prototype,"config",[ix],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),cx=Hi(vA.prototype,"coordinateSystemService",[ax],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),fx=Hi(vA.prototype,"eventEmitter",[ox],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),vA))||sx),I6=function(){function e(){(0,se.Z)(this,e),(0,Me.Z)(this,"projectionMatrix",Qn()),(0,Me.Z)(this,"viewMatrix",Qn()),(0,Me.Z)(this,"viewProjectionMatrix",Qn()),(0,Me.Z)(this,"ViewProjectionMatrixUncentered",Qn()),(0,Me.Z)(this,"viewUncenteredMatrix",Qn())}return(0,be.Z)(e,[{key:"syncWithMapCamera",value:function(t){var n=t.zoom,r=n===void 0?1:n,a=t.center,u=a===void 0?[0,0]:a,c=t.offsetOrigin,g=c===void 0?[0,0]:c,x=t.cameraPosition,M=x===void 0?[0,0,0]:x,O=t.up,B=O===void 0?[0,1,0]:O,W=t.lookAt,ce=W===void 0?[0,0,0]:W,oe=t.aspect,Te=oe===void 0?1:oe,Ze=t.near,qe=Ze===void 0?.1:Ze,et=t.far,yt=et===void 0?1e3:et,bt=t.fov,Ot=bt===void 0?45:bt;this.zoom=r,this.center=u,qf(this.projectionMatrix,Ot/180*Math.PI,Te,qe,yt);var jt=Pu.apply(k,(0,pr.Z)(M)),or=Pu.apply(k,(0,pr.Z)(ce)),ar=Pu.apply(k,(0,pr.Z)(B));th(this.viewMatrix,jt,or,ar),this.viewUncenteredMatrix=Xa(this.viewMatrix),Ks(this.viewMatrix,this.viewMatrix,Pu(-g[0],g[1],0)),ja(this.viewProjectionMatrix,this.projectionMatrix,this.viewMatrix),ja(this.ViewProjectionMatrixUncentered,this.projectionMatrix,this.viewMatrix)}},{key:"getZoom",value:function(){return this.zoom}},{key:"getZoomScale",value:function(){return 1048576}},{key:"getCenter",value:function(){var t=(0,vn.Z)(this.center,2),n=t[0],r=t[1];return[n,r]}},{key:"getProjectionMatrix",value:function(){return this.projectionMatrix}},{key:"getModelMatrix",value:function(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}},{key:"getViewMatrix",value:function(){return this.viewMatrix}},{key:"getViewMatrixUncentered",value:function(){return this.viewUncenteredMatrix}},{key:"getViewProjectionMatrix",value:function(){return this.viewProjectionMatrix}},{key:"getViewProjectionMatrixUncentered",value:function(){return this.ViewProjectionMatrixUncentered}},{key:"getFocalDistance",value:function(){return 1.2}},{key:"projectFlat",value:function(t){var n=85.0511287798,r=Math.max(Math.min(n,t[1]),-n),a=256<<20,u=Math.PI/180,c=t[0]*u,g=r*u;g=Math.log(Math.tan(Math.PI/4+g/2));var x=.5/Math.PI,M=.5,O=-.5/Math.PI;return u=.5,c=a*(x*c+M)-215440491,g=-(a*(O*g+u)-106744817),[c,g]}}]),e}(),P6=["id","style","minZoom","maxZoom","token","mapInstance","plugin","version"],px,dx;function L6(e){var i=O6();return function(){var n=(0,ue.Z)(e),r;if(i){var a=(0,ue.Z)(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return(0,ze.Z)(this,r)}}function O6(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}function R6(e,i){var t=typeof my!="undefined"&&!!my&&typeof my.showToast=="function"&&my.isFRM!==!0,n=typeof wx!="undefined"&&wx!==null&&(typeof wx.request!="undefined"||typeof wx.miniProgram!="undefined");if(!(t||n)&&(i||(i=document),!!i)){var r=i.head||i.getElementsByTagName("head")[0];if(!r){r=i.createElement("head");var a=i.body||i.getElementsByTagName("body")[0];a?a.parentNode.insertBefore(r,a):i.documentElement.appendChild(r)}var u=i.createElement("style");return u.type="text/css",u.styleSheet?u.styleSheet.cssText=e:u.appendChild(i.createTextNode(e)),r.appendChild(u),u}}R6(`.amap-logo{
 display: none !important;
}
`);var vx=[108.92361,34.54083];window.forceWebGL=!0;var gx="f59bcf249433f8b05caaee19f349b3d7",mx="2.0",f8=!1,h8=null,D6=(px=(0,vr.b2)(),px(dx=function(e){(0,Ne.Z)(t,e);var i=L6(t);function t(){var n;(0,se.Z)(this,t);for(var r=arguments.length,a=new Array(r),u=0;u<r;u++)a[u]=arguments[u];return n=i.call.apply(i,[this].concat(a)),(0,Me.Z)((0,xt.Z)(n),"version","GAODE2.x"),(0,Me.Z)((0,xt.Z)(n),"handleViewChanged",function(c){var g=n.map.customCoords.getCameraParams(),x=g.fov,M=g.near,O=g.far,B=g.aspect,W=g.position,ce=g.lookAt,oe=g.up;n.emit("mapchange");var Te=n.map.customCoords.getCenter();n.cameraChangedCallback&&(n.viewport.syncWithMapCamera({aspect:B,far:O,fov:x,cameraPosition:W,lookAt:ce,up:oe,near:M,zoom:n.map.getZoom()-1,center:Te,offsetOrigin:[W[0],W[1]]}),n.coordinateSystemService.setCoordinateSystem(Bc.P20_2),n.cameraChangedCallback(n.viewport))}),n}return(0,be.Z)(t,[{key:"setCustomCoordCenter",value:function(r){this.sceneCenter=r,this.sceneCenterMercator=Ms.apply(void 0,(0,pr.Z)(r))}},{key:"getCustomCoordCenter",value:function(){return this.sceneCenterMercator}},{key:"lngLatToCoordByLayer",value:function(r,a){var u=a||this.sceneCenterMercator,c=this._sub(Ms(r[0],r[1]),u);return r[2]&&c.push(r[2]),c}},{key:"coordToAMap2RelativeCoordinates",value:function(r,a){var u=this,c=Ms(a[0],a[1]);return typeof r[0]=="number"?this.lngLatToCoordByLayer(r,c):r.map(function(g){return Array.isArray(g)&&typeof g[0]=="number"?u.lngLatToCoordByLayer(g,c):g.map(function(x){return u.lngLatToCoordByLayer(x,c)})})}},{key:"setCoordCenter",value:function(r){this.map.customCoords.setCenter(r||vx),this.setCustomCoordCenter(r||vx)}},{key:"lngLatToCoord",value:function(r){return this.sceneCenter||(this.map.customCoords.setCenter(r),this.setCustomCoordCenter(r)),this._sub(Ms(r[0],r[1]),this.sceneCenterMercator)}},{key:"lngLatToCoords",value:function(r){var a=this;return r.map(function(u){return typeof u[0]=="number"?a.lngLatToCoord(u):u.map(function(c){return a.lngLatToCoord(c)})})}},{key:"addMarkerContainer",value:function(){if(this.map){var r=this.map.getContainer();if(r!==null){var a=r.getElementsByClassName("amap-maps")[0];a.style.zIndex="auto",this.markerContainer=ni("div","l7-marker-container2",a)}}}},{key:"updateView",value:function(r){}},{key:"getOverlayContainer",value:function(){}},{key:"getType",value:function(){return"amap2"}},{key:"getBounds",value:function(){var r=this.map.getBounds(),a=r.getNorthEast(),u=r.getSouthWest(),c=this.getCenter(),g=c.lng>a.getLng()||c.lng<u.getLng()?180-a.getLng():a.getLng(),x=c.lng<u.getLng()?u.getLng()-180:u.getLng();return[[x,u.getLat()],[g,a.getLat()]]}},{key:"getMinZoom",value:function(){var r=this.map.getZooms();return r[0]-1}},{key:"getMaxZoom",value:function(){var r=this.map.getZooms();return r[1]-1}},{key:"lngLatToContainer",value:function(r){var a=this.map.lngLatToContainer(r);return{x:a.getX(),y:a.getY()}}},{key:"lngLatToPixel",value:function(r){var a=this.map.lngLatToPixel(new AMap.LngLat(r[0],r[1]));return{x:a.getX(),y:a.getY()}}},{key:"getModelMatrix",value:function(r,a,u){var c=arguments.length>3&&arguments[3]!==void 0?arguments[3]:[1,1,1],g=this.map.customCoords.lngLatToCoord(r),x=Qn();return Ks(x,x,Pu(g[0],g[1],a)),So(x,x,Pu(c[0],c[1],c[2])),fc(x,x,u[0]),q0(x,x,u[1]),K0(x,x,u[2]),x}},{key:"init",value:function(){var n=(0,ur.Z)(it().mark(function a(){var u,c,g,x,M,O,B,W,ce,oe,Te,Ze,qe,et,yt,bt,Ot,jt,or,ar,Sr,dr;return it().wrap(function(nn){for(;;)switch(nn.prev=nn.next){case 0:if(u=this.config,c=u.id,g=u.style,x=g===void 0?"light":g,M=u.minZoom,O=M===void 0?0:M,B=u.maxZoom,W=B===void 0?18:B,ce=u.token,oe=ce===void 0?gx:ce,Te=u.mapInstance,Ze=u.plugin,qe=Ze===void 0?[]:Ze,et=u.version,yt=et===void 0?mx:et,bt=(0,Ac.Z)(u,P6),this.viewport=new I6,window.AMap||Te){nn.next=6;break}return qe.push("Map3D"),nn.next=6,Y2().load({key:oe,version:mx,plugins:qe});case 6:Te?(this.map=Te,this.$mapContainer=this.map.getContainer(),jt=this.map.getCenter(),(Ot=this.map.customCoords)===null||Ot===void 0||Ot.setCenter([jt.lng,jt.lat]),this.setCustomCoordCenter([jt.lng,jt.lat]),this.map.on("viewchange",this.handleViewChanged)):(this.$mapContainer=this.creatMapContainer(c),ar=(0,X.Z)({mapStyle:this.getMapStyleValue(x),zooms:[O,W],viewMode:"3D"},bt),ar.zoom&&(ar.zoom+=1),oe===gx&&(window._AMapSecurityConfig={securityJsCode:"2653011adeb04230b3a26cc9a780a800"},console.warn("%c".concat(this.configService.getSceneWarninfo("MapToken"),"!"),"color: #873bf4;font-weigh:900;font-size: 16px;")),Sr=new AMap.Map(this.$mapContainer,ar),this.map=Sr,dr=Sr.getCenter(),(or=this.map.customCoords)===null||or===void 0||or.setCenter([dr.lng,dr.lat]),this.setCustomCoordCenter([dr.lng,dr.lat]),Sr.on("viewchange",this.handleViewChanged)),this.initViewPort();case 8:case"end":return nn.stop()}},a,this)}));function r(){return n.apply(this,arguments)}return r}()},{key:"getMapContainer",value:function(){return this.$mapContainer}},{key:"onCameraChanged",value:function(r){this.cameraChangedCallback=r}},{key:"initViewPort",value:function(){var r,a=(r=this.map.customCoords)===null||r===void 0?void 0:r.getCameraParams(),u=a.fov,c=a.near,g=a.far,x=a.aspect,M=a.position,O=a.lookAt,B=a.up;this.emit("mapchange");var W=this.map.customCoords.getCenter(),ce=this.map.getZoom();this.cameraChangedCallback&&(this.viewport.syncWithMapCamera({aspect:x,far:g,fov:u,cameraPosition:M,lookAt:O,near:c,up:B,zoom:ce-1,center:W,offsetOrigin:[M[0],M[1]]}),this.coordinateSystemService.setCoordinateSystem(Bc.P20_2),this.cameraChangedCallback(this.viewport))}},{key:"_sub",value:function(r,a){var u=[0,0];return u[0]=r[0]-a[0],u[1]=r[1]-a[1],u}}]),t}(M6))||dx);function k6(e){var i=N6();return function(){var n=(0,ue.Z)(e),r;if(i){var a=(0,ue.Z)(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return(0,ze.Z)(this,r)}}function N6(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var F6=function(e){(0,Ne.Z)(t,e);var i=k6(t);function t(){return(0,se.Z)(this,t),i.apply(this,arguments)}return(0,be.Z)(t,[{key:"getServiceConstructor",value:function(){return D6}}]),t}(s6),B6=C(81550),Z6=C.n(B6),z6=function(){function e(i,t){(0,se.Z)(this,e);var n=t.buffer,r=t.offset,a=t.stride,u=t.normalized,c=t.size,g=t.divisor;this.buffer=n,this.attribute={buffer:n.get(),offset:r||0,stride:a||0,normalized:u||!1,divisor:g||0},c&&(this.attribute.size=c)}return(0,be.Z)(e,[{key:"get",value:function(){return this.attribute}},{key:"updateBuffer",value:function(t){this.buffer.subData(t)}},{key:"destroy",value:function(){this.buffer.destroy()}}]),e}(),i0,Lp,Z0,Yc,Op,z0,Rp,ov,Rf,_h,qu,Df,kf,sv,U6=(i0={},(0,Me.Z)(i0,je.POINTS,"points"),(0,Me.Z)(i0,je.LINES,"lines"),(0,Me.Z)(i0,je.LINE_LOOP,"line loop"),(0,Me.Z)(i0,je.LINE_STRIP,"line strip"),(0,Me.Z)(i0,je.TRIANGLES,"triangles"),(0,Me.Z)(i0,je.TRIANGLE_FAN,"triangle fan"),(0,Me.Z)(i0,je.TRIANGLE_STRIP,"triangle strip"),i0),yx=(Lp={},(0,Me.Z)(Lp,je.STATIC_DRAW,"static"),(0,Me.Z)(Lp,je.DYNAMIC_DRAW,"dynamic"),(0,Me.Z)(Lp,je.STREAM_DRAW,"stream"),Lp),Yg=(Z0={},(0,Me.Z)(Z0,je.BYTE,"int8"),(0,Me.Z)(Z0,je.INT,"int32"),(0,Me.Z)(Z0,je.UNSIGNED_BYTE,"uint8"),(0,Me.Z)(Z0,je.UNSIGNED_SHORT,"uint16"),(0,Me.Z)(Z0,je.UNSIGNED_INT,"uint32"),(0,Me.Z)(Z0,je.FLOAT,"float"),Z0),G6=(Yc={},(0,Me.Z)(Yc,je.ALPHA,"alpha"),(0,Me.Z)(Yc,je.LUMINANCE,"luminance"),(0,Me.Z)(Yc,je.LUMINANCE_ALPHA,"luminance alpha"),(0,Me.Z)(Yc,je.RGB,"rgb"),(0,Me.Z)(Yc,je.RGBA,"rgba"),(0,Me.Z)(Yc,je.RGBA4,"rgba4"),(0,Me.Z)(Yc,je.RGB5_A1,"rgb5 a1"),(0,Me.Z)(Yc,je.RGB565,"rgb565"),(0,Me.Z)(Yc,je.DEPTH_COMPONENT,"depth"),(0,Me.Z)(Yc,je.DEPTH_STENCIL,"depth stencil"),Yc),j6=(Op={},(0,Me.Z)(Op,je.DONT_CARE,"dont care"),(0,Me.Z)(Op,je.NICEST,"nice"),(0,Me.Z)(Op,je.FASTEST,"fast"),Op),_x=(z0={},(0,Me.Z)(z0,je.NEAREST,"nearest"),(0,Me.Z)(z0,je.LINEAR,"linear"),(0,Me.Z)(z0,je.LINEAR_MIPMAP_LINEAR,"mipmap"),(0,Me.Z)(z0,je.NEAREST_MIPMAP_LINEAR,"nearest mipmap linear"),(0,Me.Z)(z0,je.LINEAR_MIPMAP_NEAREST,"linear mipmap nearest"),(0,Me.Z)(z0,je.NEAREST_MIPMAP_NEAREST,"nearest mipmap nearest"),z0),xx=(Rp={},(0,Me.Z)(Rp,je.REPEAT,"repeat"),(0,Me.Z)(Rp,je.CLAMP_TO_EDGE,"clamp"),(0,Me.Z)(Rp,je.MIRRORED_REPEAT,"mirror"),Rp),V6=(ov={},(0,Me.Z)(ov,je.NONE,"none"),(0,Me.Z)(ov,je.BROWSER_DEFAULT_WEBGL,"browser"),ov),H6=(Rf={},(0,Me.Z)(Rf,je.NEVER,"never"),(0,Me.Z)(Rf,je.ALWAYS,"always"),(0,Me.Z)(Rf,je.LESS,"less"),(0,Me.Z)(Rf,je.LEQUAL,"lequal"),(0,Me.Z)(Rf,je.GREATER,"greater"),(0,Me.Z)(Rf,je.GEQUAL,"gequal"),(0,Me.Z)(Rf,je.EQUAL,"equal"),(0,Me.Z)(Rf,je.NOTEQUAL,"notequal"),Rf),Ex=(_h={},(0,Me.Z)(_h,je.FUNC_ADD,"add"),(0,Me.Z)(_h,je.MIN_EXT,"min"),(0,Me.Z)(_h,je.MAX_EXT,"max"),(0,Me.Z)(_h,je.FUNC_SUBTRACT,"subtract"),(0,Me.Z)(_h,je.FUNC_REVERSE_SUBTRACT,"reverse subtract"),_h),uv=(qu={},(0,Me.Z)(qu,je.ZERO,"zero"),(0,Me.Z)(qu,je.ONE,"one"),(0,Me.Z)(qu,je.SRC_COLOR,"src color"),(0,Me.Z)(qu,je.ONE_MINUS_SRC_COLOR,"one minus src color"),(0,Me.Z)(qu,je.SRC_ALPHA,"src alpha"),(0,Me.Z)(qu,je.ONE_MINUS_SRC_ALPHA,"one minus src alpha"),(0,Me.Z)(qu,je.DST_COLOR,"dst color"),(0,Me.Z)(qu,je.ONE_MINUS_DST_COLOR,"one minus dst color"),(0,Me.Z)(qu,je.DST_ALPHA,"dst alpha"),(0,Me.Z)(qu,je.ONE_MINUS_DST_ALPHA,"one minus dst alpha"),(0,Me.Z)(qu,je.CONSTANT_COLOR,"constant color"),(0,Me.Z)(qu,je.ONE_MINUS_CONSTANT_COLOR,"one minus constant color"),(0,Me.Z)(qu,je.CONSTANT_ALPHA,"constant alpha"),(0,Me.Z)(qu,je.ONE_MINUS_CONSTANT_ALPHA,"one minus constant alpha"),(0,Me.Z)(qu,je.SRC_ALPHA_SATURATE,"src alpha saturate"),qu),$6=(Df={},(0,Me.Z)(Df,je.NEVER,"never"),(0,Me.Z)(Df,je.ALWAYS,"always"),(0,Me.Z)(Df,je.LESS,"less"),(0,Me.Z)(Df,je.LEQUAL,"lequal"),(0,Me.Z)(Df,je.GREATER,"greater"),(0,Me.Z)(Df,je.GEQUAL,"gequal"),(0,Me.Z)(Df,je.EQUAL,"equal"),(0,Me.Z)(Df,je.NOTEQUAL,"notequal"),Df),gA=(kf={},(0,Me.Z)(kf,je.ZERO,"zero"),(0,Me.Z)(kf,je.KEEP,"keep"),(0,Me.Z)(kf,je.REPLACE,"replace"),(0,Me.Z)(kf,je.INVERT,"invert"),(0,Me.Z)(kf,je.INCR,"increment"),(0,Me.Z)(kf,je.DECR,"decrement"),(0,Me.Z)(kf,je.INCR_WRAP,"increment wrap"),(0,Me.Z)(kf,je.DECR_WRAP,"decrement wrap"),kf),Y6=(sv={},(0,Me.Z)(sv,je.FRONT,"front"),(0,Me.Z)(sv,je.BACK,"back"),sv),W6=function(){function e(i,t){(0,se.Z)(this,e),(0,Me.Z)(this,"isDestroyed",!1);var n=t.data,r=t.usage,a=t.type;this.buffer=i.buffer({data:n,usage:yx[r||je.STATIC_DRAW],type:Yg[a||je.UNSIGNED_BYTE]})}return(0,be.Z)(e,[{key:"get",value:function(){return this.buffer}},{key:"destroy",value:function(){this.isDestroyed||this.buffer.destroy(),this.isDestroyed=!0}},{key:"subData",value:function(t){var n=t.data,r=t.offset;this.buffer.subdata(n,r)}}]),e}(),X6=function(){function e(i,t){(0,se.Z)(this,e);var n=t.data,r=t.usage,a=t.type,u=t.count;this.elements=i.elements({data:n,usage:yx[r||je.STATIC_DRAW],type:Yg[a||je.UNSIGNED_BYTE],count:u})}return(0,be.Z)(e,[{key:"get",value:function(){return this.elements}},{key:"subData",value:function(t){var n=t.data;this.elements.subdata(n)}},{key:"destroy",value:function(){}}]),e}(),Q6=function(){function e(i,t){(0,se.Z)(this,e);var n=t.width,r=t.height,a=t.color,u=t.colors,c={width:n,height:r};Array.isArray(u)&&(c.colors=u.map(function(g){return g.get()})),a&&typeof a!="boolean"&&(c.color=a.get()),this.framebuffer=i.framebuffer(c)}return(0,be.Z)(e,[{key:"get",value:function(){return this.framebuffer}},{key:"destroy",value:function(){this.framebuffer.destroy()}},{key:"resize",value:function(t){var n=t.width,r=t.height;this.framebuffer.resize(n,r)}}]),e}(),q6=In.isPlainObject,K6=In.isTypedArray,J6=function(){function e(i,t){(0,se.Z)(this,e),(0,Me.Z)(this,"destroyed",!1),(0,Me.Z)(this,"uniforms",{}),this.reGl=i;var n=t.vs,r=t.fs,a=t.attributes,u=t.uniforms,c=t.primitive,g=t.count,x=t.elements,M=t.depth,O=t.cull,B=t.instances,W={};this.options=t,u&&(this.uniforms=this.extractUniforms(u),Object.keys(u).forEach(function(Te){W[Te]=i.prop(Te)}));var ce={};Object.keys(a).forEach(function(Te){ce[Te]=a[Te].get()});var oe={attributes:ce,frag:r,uniforms:W,vert:n,colorMask:i.prop("colorMask"),lineWidth:1,blend:{enable:i.prop("blend.enable"),func:i.prop("blend.func"),equation:i.prop("blend.equation"),color:i.prop("blend.color")},stencil:{enable:i.prop("stencil.enable"),mask:i.prop("stencil.mask"),func:i.prop("stencil.func"),opFront:i.prop("stencil.opFront"),opBack:i.prop("stencil.opBack")},primitive:U6[c===void 0?je.TRIANGLES:c]};B&&(oe.instances=B),g?oe.count=g:x&&(oe.elements=x.get()),this.initDepthDrawParams({depth:M},oe),this.initCullDrawParams({cull:O},oe),this.drawCommand=i(oe),this.drawParams=oe}return(0,be.Z)(e,[{key:"updateAttributesAndElements",value:function(t,n){var r={};Object.keys(t).forEach(function(a){r[a]=t[a].get()}),this.drawParams.attributes=r,this.drawParams.elements=n.get(),this.drawCommand=this.reGl(this.drawParams)}},{key:"updateAttributes",value:function(t){var n={};Object.keys(t).forEach(function(r){n[r]=t[r].get()}),this.drawParams.attributes=n,this.drawCommand=this.reGl(this.drawParams)}},{key:"addUniforms",value:function(t){this.uniforms=(0,X.Z)((0,X.Z)({},this.uniforms),this.extractUniforms(t))}},{key:"draw",value:function(t,n){if(!(this.drawParams.attributes&&Object.keys(this.drawParams.attributes).length===0)){var r=(0,X.Z)((0,X.Z)({},this.uniforms),this.extractUniforms(t.uniforms||{})),a={};Object.keys(r).forEach(function(u){var c=(0,ia.Z)(r[u]);c==="boolean"||c==="number"||Array.isArray(r[u])||r[u].BYTES_PER_ELEMENT?a[u]=r[u]:a[u]=r[u].get()}),a.blend=n?this.getBlendDrawParams({blend:{enable:!1}}):this.getBlendDrawParams(t),a.stencil=this.getStencilDrawParams(t),a.colorMask=this.getColorMaskDrawParams(t,n),this.drawCommand(a)}}},{key:"destroy",value:function(){var t,n;(t=this.drawParams)===null||t===void 0||(n=t.elements)===null||n===void 0||n.destroy(),this.options.attributes&&Object.values(this.options.attributes).forEach(function(r){r==null||r.destroy()}),this.destroyed=!0}},{key:"initDepthDrawParams",value:function(t,n){var r=t.depth;r&&(n.depth={enable:r.enable===void 0?!0:!!r.enable,mask:r.mask===void 0?!0:!!r.mask,func:H6[r.func||je.LESS],range:r.range||[0,1]})}},{key:"getBlendDrawParams",value:function(t){var n=t.blend,r=n||{},a=r.enable,u=r.func,c=r.equation,g=r.color,x=g===void 0?[0,0,0,0]:g;return{enable:!!a,func:{srcRGB:uv[u&&u.srcRGB||je.SRC_ALPHA],srcAlpha:uv[u&&u.srcAlpha||je.SRC_ALPHA],dstRGB:uv[u&&u.dstRGB||je.ONE_MINUS_SRC_ALPHA],dstAlpha:uv[u&&u.dstAlpha||je.ONE_MINUS_SRC_ALPHA]},equation:{rgb:Ex[c&&c.rgb||je.FUNC_ADD],alpha:Ex[c&&c.alpha||je.FUNC_ADD]},color:x}}},{key:"getStencilDrawParams",value:function(t){var n=t.stencil,r=n||{},a=r.enable,u=r.mask,c=u===void 0?-1:u,g=r.func,x=g===void 0?{cmp:je.ALWAYS,ref:0,mask:-1}:g,M=r.opFront,O=M===void 0?{fail:je.KEEP,zfail:je.KEEP,zpass:je.KEEP}:M,B=r.opBack,W=B===void 0?{fail:je.KEEP,zfail:je.KEEP,zpass:je.KEEP}:B;return{enable:!!a,mask:c,func:(0,X.Z)((0,X.Z)({},x),{},{cmp:$6[x.cmp]}),opFront:{fail:gA[O.fail],zfail:gA[O.zfail],zpass:gA[O.zpass]},opBack:{fail:gA[W.fail],zfail:gA[W.zfail],zpass:gA[W.zpass]}}}},{key:"getColorMaskDrawParams",value:function(t,n){var r=t.stencil,a=r!=null&&r.enable&&r.opFront&&!n?[!1,!1,!1,!1]:[!0,!0,!0,!0];return a}},{key:"initCullDrawParams",value:function(t,n){var r=t.cull;if(r){var a=r.enable,u=r.face,c=u===void 0?je.BACK:u;n.cull={enable:!!a,face:Y6[c]}}}},{key:"extractUniforms",value:function(t){var n=this,r={};return Object.keys(t).forEach(function(a){n.extractUniformsRecursively(a,t[a],r,"")}),r}},{key:"extractUniformsRecursively",value:function(t,n,r,a){var u=this;if(n===null||typeof n=="number"||typeof n=="boolean"||Array.isArray(n)&&typeof n[0]=="number"||K6(n)||n===""||"resize"in n){r["".concat(a&&a+".").concat(t)]=n;return}q6(n)&&Object.keys(n).forEach(function(c){u.extractUniformsRecursively(c,n[c],r,"".concat(a&&a+".").concat(t))}),Array.isArray(n)&&n.forEach(function(c,g){Object.keys(c).forEach(function(x){u.extractUniformsRecursively(x,c[x],r,"".concat(a&&a+".").concat(t,"[").concat(g,"]"))})})}}]),e}(),eP=function(){function e(i,t){(0,se.Z)(this,e),(0,Me.Z)(this,"isDestroy",!1);var n=t.data,r=t.type,a=r===void 0?je.UNSIGNED_BYTE:r,u=t.width,c=t.height,g=t.flipY,x=g===void 0?!1:g,M=t.format,O=M===void 0?je.RGBA:M,B=t.mipmap,W=B===void 0?!1:B,ce=t.wrapS,oe=ce===void 0?je.CLAMP_TO_EDGE:ce,Te=t.wrapT,Ze=Te===void 0?je.CLAMP_TO_EDGE:Te,qe=t.aniso,et=qe===void 0?0:qe,yt=t.alignment,bt=yt===void 0?1:yt,Ot=t.premultiplyAlpha,jt=Ot===void 0?!1:Ot,or=t.mag,ar=or===void 0?je.NEAREST:or,Sr=t.min,dr=Sr===void 0?je.NEAREST:Sr,jr=t.colorSpace,nn=jr===void 0?je.BROWSER_DEFAULT_WEBGL:jr,En=t.x,_a=En===void 0?0:En,_s=t.y,ls=_s===void 0?0:_s,Ds=t.copy,ks=Ds===void 0?!1:Ds;this.width=u,this.height=c;var Wc={width:u,height:c,type:Yg[a],format:G6[O],wrapS:xx[oe],wrapT:xx[Ze],mag:_x[ar],min:_x[dr],alignment:bt,flipY:x,colorSpace:V6[nn],premultiplyAlpha:jt,aniso:et,x:_a,y:ls,copy:ks};n&&(Wc.data=n),typeof W=="number"?Wc.mipmap=j6[W]:typeof W=="boolean"&&(Wc.mipmap=W),this.texture=i.texture(Wc)}return(0,be.Z)(e,[{key:"get",value:function(){return this.texture}},{key:"update",value:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.texture(t)}},{key:"bind",value:function(){this.texture._texture.bind()}},{key:"resize",value:function(t){var n=t.width,r=t.height;this.texture.resize(n,r),this.width=n,this.height=r}},{key:"getSize",value:function(){return[this.width,this.height]}},{key:"destroy",value:function(){if(!this.isDestroy){var t;(t=this.texture)===null||t===void 0||t.destroy()}this.isDestroy=!0}}]),e}(),bx,Sx,tP=(bx=(0,vr.b2)(),bx(Sx=function(){function e(){var i=this;(0,se.Z)(this,e),(0,Me.Z)(this,"createModel",function(t){return new J6(i.gl,t)}),(0,Me.Z)(this,"createAttribute",function(t){return new z6(i.gl,t)}),(0,Me.Z)(this,"createBuffer",function(t){return new W6(i.gl,t)}),(0,Me.Z)(this,"createElements",function(t){return new X6(i.gl,t)}),(0,Me.Z)(this,"createTexture2D",function(t){return new eP(i.gl,t)}),(0,Me.Z)(this,"createFramebuffer",function(t){return new Q6(i.gl,t)}),(0,Me.Z)(this,"useFramebuffer",function(t,n){i.gl({framebuffer:t?t.get():null})(n)}),(0,Me.Z)(this,"clear",function(t){var n,r=t.color,a=t.depth,u=t.stencil,c=t.framebuffer,g=c===void 0?null:c,x={color:r,depth:a,stencil:u};x.framebuffer=g===null?g:g.get(),(n=i.gl)===null||n===void 0||n.clear(x)}),(0,Me.Z)(this,"viewport",function(t){var n=t.x,r=t.y,a=t.width,u=t.height;i.gl._gl.viewport(n,r,a,u),i.width=a,i.height=u,i.gl._refresh()}),(0,Me.Z)(this,"readPixels",function(t){var n=t.framebuffer,r=t.x,a=t.y,u=t.width,c=t.height,g={x:r,y:a,width:u,height:c};return n&&(g.framebuffer=n.get()),i.gl.read(g)}),(0,Me.Z)(this,"getViewportSize",function(){return{width:i.gl._gl.drawingBufferWidth,height:i.gl._gl.drawingBufferHeight}}),(0,Me.Z)(this,"getContainer",function(){var t;return(t=i.canvas)===null||t===void 0?void 0:t.parentElement}),(0,Me.Z)(this,"getCanvas",function(){return i.canvas}),(0,Me.Z)(this,"getGLContext",function(){return i.gl._gl}),(0,Me.Z)(this,"destroy",function(){var t,n,r;i.canvas=null,(t=i.gl)===null||t===void 0||(n=t._gl)===null||n===void 0||(r=n.getExtension("WEBGL_lose_context"))===null||r===void 0||r.loseContext(),i.gl.destroy(),i.gl=null})}return(0,be.Z)(e,[{key:"init",value:function(){var i=(0,ur.Z)(it().mark(function n(r,a,u){var c=this;return it().wrap(function(x){for(;;)switch(x.prev=x.next){case 0:if(this.canvas=r,!u){x.next=5;break}this.gl=u,x.next=8;break;case 5:return x.next=7,new Promise(function(M,O){Z6()({canvas:c.canvas,attributes:{alpha:!0,antialias:a.antialias,premultipliedAlpha:!0,preserveDrawingBuffer:a.preserveDrawingBuffer,stencil:a.stencil},extensions:["OES_element_index_uint","OES_standard_derivatives","ANGLE_instanced_arrays"],optionalExtensions:["oes_texture_float_linear","OES_texture_float","EXT_texture_filter_anisotropic","EXT_blend_minmax","WEBGL_depth_texture","WEBGL_lose_context"],profile:!0,onDone:function(W,ce){(W||!ce)&&O(W),M(ce)}})});case 7:this.gl=x.sent;case 8:this.extensionObject={OES_texture_float:this.testExtension("OES_texture_float")};case 9:case"end":return x.stop()}},n,this)}));function t(n,r,a){return i.apply(this,arguments)}return t}()},{key:"getPointSizeRange",value:function(){return this.gl._gl.getParameter(this.gl._gl.ALIASED_POINT_SIZE_RANGE)}},{key:"testExtension",value:function(t){return!!this.getGLContext().getExtension(t)}},{key:"setState",value:function(){this.gl({cull:{enable:!1,face:"back"},viewport:{x:0,y:0,height:this.width,width:this.height},blend:{enable:!0,equation:"add"},framebuffer:null}),this.gl._refresh()}},{key:"setBaseState",value:function(){this.gl({cull:{enable:!1,face:"back"},viewport:{x:0,y:0,height:this.width,width:this.height},blend:{enable:!1,equation:"add"},framebuffer:null}),this.gl._refresh()}},{key:"setCustomLayerDefaults",value:function(){var t=this.getGLContext();t.disable(t.CULL_FACE)}},{key:"setDirty",value:function(t){this.isDirty=t}},{key:"getDirty",value:function(){return this.isDirty}}]),e}())||Sx);function rP(e){var i=nP();return function(){var n=(0,ue.Z)(e),r;if(i){var a=(0,ue.Z)(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return(0,ze.Z)(this,r)}}function nP(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var Wg=["selectstart","selecting","selectend"],iP=function(e){(0,Ne.Z)(t,e);var i=rP(t);function t(n){var r,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return(0,se.Z)(this,t),r=i.call(this),(0,Me.Z)((0,xt.Z)(r),"isEnable",!1),(0,Me.Z)((0,xt.Z)(r),"onDragStart",function(u){r.box.style.display="block",r.startEvent=r.endEvent=u,r.syncBoxBound(),r.emit("selectstart",r.getLngLatBox(),r.startEvent,r.endEvent)}),(0,Me.Z)((0,xt.Z)(r),"onDragging",function(u){r.endEvent=u,r.syncBoxBound(),r.emit("selecting",r.getLngLatBox(),r.startEvent,r.endEvent)}),(0,Me.Z)((0,xt.Z)(r),"onDragEnd",function(u){r.endEvent=u,r.box.style.display="none",r.emit("selectend",r.getLngLatBox(),r.startEvent,r.endEvent)}),r.scene=n,r.options=a,r}return(0,be.Z)(t,[{key:"container",get:function(){return this.scene.getMapService().getMarkerContainer()}},{key:"enable",value:function(){if(!this.isEnable){var r=this.options.className;if(this.scene.setMapStatus({dragEnable:!1}),this.container.style.cursor="crosshair",!this.box){var a=ni("div",void 0,this.container);a.classList.add("l7-select-box"),r&&a.classList.add(r),a.style.display="none",this.box=a}this.scene.on("dragstart",this.onDragStart),this.scene.on("dragging",this.onDragging),this.scene.on("dragend",this.onDragEnd),this.isEnable=!0}}},{key:"disable",value:function(){this.isEnable&&(this.scene.setMapStatus({dragEnable:!0}),this.container.style.cursor="auto",this.scene.off("dragstart",this.onDragStart),this.scene.off("dragging",this.onDragging),this.scene.off("dragend",this.onDragEnd),this.isEnable=!1)}},{key:"syncBoxBound",value:function(){var r=this.startEvent,a=r.x,u=r.y,c=this.endEvent,g=c.x,x=c.y,M=Math.min(a,g),O=Math.min(u,x),B=Math.abs(a-g),W=Math.abs(u-x);this.box.style.top="".concat(O,"px"),this.box.style.left="".concat(M,"px"),this.box.style.width="".concat(B,"px"),this.box.style.height="".concat(W,"px")}},{key:"getLngLatBox",value:function(){var r=this.startEvent.lngLat,a=r.lng,u=r.lat,c=this.endEvent.lngLat,g=c.lng,x=c.lat;return el([[a,u],[g,x]])}}]),t}(ha.EventEmitter),aP=function(){function e(i){(0,se.Z)(this,e);var t=i.id,n=i.map,r=i.canvas,a=i.hasBaseMap,u=sb();this.container=u,n.setContainer(u,t,r,a),u.bind(Xt.IRendererService).to(tP).inSingletonScope(),this.sceneService=u.get(Xt.ISceneService),this.mapService=u.get(Xt.IMapService),this.iconService=u.get(Xt.IIconService),this.fontService=u.get(Xt.IFontService),this.controlService=u.get(Xt.IControlService),this.layerService=u.get(Xt.ILayerService),this.debugService=u.get(Xt.IDebugService),this.debugService.setEnable(i.debug),this.markerService=u.get(Xt.IMarkerService),this.interactionService=u.get(Xt.IInteractionService),this.popupService=u.get(Xt.IPopupService),this.boxSelect=new iP(this,{}),this.initComponent(t),this.sceneService.init(i),this.initControl()}return(0,be.Z)(e,[{key:"map",get:function(){return this.mapService.map}},{key:"loaded",get:function(){return this.sceneService.loaded}},{key:"getServiceContainer",value:function(){return this.container}},{key:"getSize",value:function(){return this.mapService.getSize()}},{key:"getMinZoom",value:function(){return this.mapService.getMinZoom()}},{key:"getMaxZoom",value:function(){return this.mapService.getMaxZoom()}},{key:"getType",value:function(){return this.mapService.getType()}},{key:"getMapContainer",value:function(){return this.mapService.getMapContainer()}},{key:"getMapCanvasContainer",value:function(){return this.mapService.getMapCanvasContainer()}},{key:"getMapService",value:function(){return this.mapService}},{key:"getDebugService",value:function(){return this.debugService}},{key:"exportPng",value:function(){var i=(0,ur.Z)(it().mark(function n(r){return it().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.abrupt("return",this.sceneService.exportPng(r));case 1:case"end":return u.stop()}},n,this)}));function t(n){return i.apply(this,arguments)}return t}()},{key:"exportMap",value:function(){var i=(0,ur.Z)(it().mark(function n(r){return it().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.abrupt("return",this.sceneService.exportPng(r));case 1:case"end":return u.stop()}},n,this)}));function t(n){return i.apply(this,arguments)}return t}()},{key:"registerRenderService",value:function(t){var n=this;if(this.sceneService.loaded){var r=new t(this);r.init()}else this.on("loaded",function(){var a=new t(n);a.init()})}},{key:"setBgColor",value:function(t){this.mapService.setBgColor(t)}},{key:"addLayer",value:function(t){var n=this,r=fp(this.container);if(t.setContainer(r,this.container),this.sceneService.addLayer(t),t.inited){var a=this.initMask(t);this.addMask(a,t.id)}else t.on("inited",function(){var u=n.initMask(t);n.addMask(u,t.id)})}},{key:"initMask",value:function(t){var n=t.getLayerConfig(),r=n.mask,a=n.maskfence,u=n.maskColor,c=u===void 0?"#000":u,g=n.maskOpacity,x=g===void 0?0:g;if(!(!r||!a)){var M=new Z1().source(a).shape("fill").style({color:c,opacity:x});return M}}},{key:"addMask",value:function(t,n){if(t){var r=this.getLayer(n);if(r){var a=fp(this.container);t.setContainer(a,this.container),r.addMaskLayer(t),this.sceneService.addMask(t)}else console.warn("parent layer not find!")}}},{key:"getPickedLayer",value:function(){return this.layerService.pickedLayerId}},{key:"getLayers",value:function(){return this.layerService.getLayers()}},{key:"getLayer",value:function(t){return this.layerService.getLayer(t)}},{key:"getLayerByName",value:function(t){return this.layerService.getLayerByName(t)}},{key:"removeLayer",value:function(){var i=(0,ur.Z)(it().mark(function n(r,a){return it().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.next=2,this.layerService.remove(r,a);case 2:case"end":return c.stop()}},n,this)}));function t(n,r){return i.apply(this,arguments)}return t}()},{key:"removeAllLayer",value:function(){var i=(0,ur.Z)(it().mark(function n(){return it().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,this.layerService.removeAllLayers();case 2:case"end":return a.stop()}},n,this)}));function t(){return i.apply(this,arguments)}return t}()},{key:"render",value:function(){this.sceneService.render()}},{key:"setEnableRender",value:function(t){this.layerService.setEnableRender(t)}},{key:"addIconFont",value:function(t,n){this.fontService.addIconFont(t,n)}},{key:"addIconFonts",value:function(t){var n=this;t.forEach(function(r){var a=(0,vn.Z)(r,2),u=a[0],c=a[1];n.fontService.addIconFont(u,c)})}},{key:"addFontFace",value:function(t,n){var r=this;this.fontService.once("fontloaded",function(a){r.emit("fontloaded",a)}),this.fontService.addFontFace(t,n)}},{key:"addImage",value:function(){var i=(0,ur.Z)(it().mark(function n(r,a){return it().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.next=2,this.iconService.addImage(r,a);case 2:case"end":return c.stop()}},n,this)}));function t(n,r){return i.apply(this,arguments)}return t}()},{key:"hasImage",value:function(t){return this.iconService.hasImage(t)}},{key:"removeImage",value:function(t){this.iconService.removeImage(t)}},{key:"addIconFontGlyphs",value:function(t,n){this.fontService.addIconGlyphs(n)}},{key:"addControl",value:function(t){this.controlService.addControl(t,this.container)}},{key:"removeControl",value:function(t){this.controlService.removeControl(t)}},{key:"getControlByName",value:function(t){return this.controlService.getControlByName(t)}},{key:"addMarker",value:function(t){this.markerService.addMarker(t)}},{key:"addMarkerLayer",value:function(t){this.markerService.addMarkerLayer(t)}},{key:"removeMarkerLayer",value:function(t){this.markerService.removeMarkerLayer(t)}},{key:"removeAllMarkers",value:function(){this.markerService.removeAllMarkers()}},{key:"removeAllMakers",value:function(){console.warn("removeAllMakers \u5DF2\u5E9F\u5F03\uFF0C\u8BF7\u4F7F\u7528 removeAllMarkers"),this.markerService.removeAllMarkers()}},{key:"addPopup",value:function(t){this.popupService.addPopup(t)}},{key:"removePopup",value:function(t){this.popupService.removePopup(t)}},{key:"on",value:function(t,n){if(Wg.includes(t)){var r;(r=this.boxSelect)===null||r===void 0||r.on(t,n)}else Pd.includes(t)?this.sceneService.on(t,n):this.mapService.on(t,n)}},{key:"once",value:function(t,n){if(Wg.includes(t)){var r;(r=this.boxSelect)===null||r===void 0||r.once(t,n)}else Pd.includes(t)?this.sceneService.once(t,n):this.mapService.once(t,n)}},{key:"emit",value:function(t,n){Pd.indexOf(t)===-1?this.mapService.on(t,n):this.sceneService.emit(t,n)}},{key:"off",value:function(t,n){if(Wg.includes(t)){var r;(r=this.boxSelect)===null||r===void 0||r.off(t,n)}else Pd.includes(t)?this.sceneService.off(t,n):this.mapService.off(t,n)}},{key:"getZoom",value:function(){return this.mapService.getZoom()}},{key:"getCenter",value:function(t){return this.mapService.getCenter(t)}},{key:"setCenter",value:function(t,n){return this.mapService.setCenter(t,n)}},{key:"getPitch",value:function(){return this.mapService.getPitch()}},{key:"setPitch",value:function(t){return this.mapService.setPitch(t)}},{key:"getRotation",value:function(){return this.mapService.getRotation()}},{key:"getBounds",value:function(){return this.mapService.getBounds()}},{key:"setRotation",value:function(t){this.mapService.setRotation(t)}},{key:"zoomIn",value:function(){this.mapService.zoomIn()}},{key:"zoomOut",value:function(){this.mapService.zoomOut()}},{key:"panTo",value:function(t){this.mapService.panTo(t)}},{key:"panBy",value:function(t,n){this.mapService.panBy(t,n)}},{key:"getContainer",value:function(){return this.mapService.getContainer()}},{key:"setZoom",value:function(t){this.mapService.setZoom(t)}},{key:"fitBounds",value:function(t,n){var r=this.sceneService.getSceneConfig(),a=r.fitBoundsOptions,u=r.animate;this.mapService.fitBounds(t,n||(0,X.Z)((0,X.Z)({},a),{},{animate:u}))}},{key:"setZoomAndCenter",value:function(t,n){this.mapService.setZoomAndCenter(t,n)}},{key:"setMapStyle",value:function(t){this.mapService.setMapStyle(t)}},{key:"setMapStatus",value:function(t){this.mapService.setMapStatus(t)}},{key:"pixelToLngLat",value:function(t){return this.mapService.pixelToLngLat(t)}},{key:"lngLatToPixel",value:function(t){return this.mapService.lngLatToPixel(t)}},{key:"containerToLngLat",value:function(t){return this.mapService.containerToLngLat(t)}},{key:"lngLatToContainer",value:function(t){return this.mapService.lngLatToContainer(t)}},{key:"destroy",value:function(){this.sceneService.destroy()}},{key:"registerPostProcessingPass",value:function(t,n){this.container.bind(Xt.IPostProcessingPass).to(t).whenTargetNamed(n)}},{key:"enableShaderPick",value:function(){this.layerService.enableShaderPick()}},{key:"diasbleShaderPick",value:function(){this.layerService.disableShaderPick()}},{key:"enableBoxSelect",value:function(){var t=this,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.boxSelect.enable(),n&&this.boxSelect.once("selectend",function(){t.disableBoxSelect()})}},{key:"disableBoxSelect",value:function(){this.boxSelect.disable()}},{key:"getProtocol",value:function(t){return ln.REGISTERED_PROTOCOLS[t]}},{key:"getPointSizeRange",value:function(){return this.sceneService.getPointSizeRange()}},{key:"initComponent",value:function(t){this.controlService.init({container:Us(t)},this.container),this.markerService.init(this.container),this.popupService.init(this.container)}},{key:"initControl",value:function(){var t=this.sceneService.getSceneConfig(),n=t.logoVisible,r=t.logoPosition;n&&this.addControl(new OS({position:r}))}}],[{key:"addProtocol",value:function(t,n){ln.REGISTERED_PROTOCOLS[t]=n}},{key:"removeProtocol",value:function(t){delete ln.REGISTERED_PROTOCOLS[t]}}]),e}(),A8="2.19.11"},38163:function(le){le.exports=$;function $(k,G){var Z=k&&k.type,F;if(Z==="FeatureCollection")for(F=0;F<k.features.length;F++)$(k.features[F],G);else if(Z==="GeometryCollection")for(F=0;F<k.geometries.length;F++)$(k.geometries[F],G);else if(Z==="Feature")$(k.geometry,G);else if(Z==="Polygon")C(k.coordinates,G);else if(Z==="MultiPolygon")for(F=0;F<k.coordinates.length;F++)C(k.coordinates[F],G);return k}function C(k,G){if(k.length!==0){L(k[0],G);for(var Z=1;Z<k.length;Z++)L(k[Z],!G)}}function L(k,G){for(var Z=0,F=0,z=0,q=k.length,ee=q-1;z<q;ee=z++){var fe=(k[z][0]-k[ee][0])*(k[ee][1]+k[z][1]),Se=Z+fe;F+=Math.abs(Z)>=Math.abs(fe)?Z-Se+fe:fe-Se+Z,Z=Se}Z+F>=0!=!!G&&k.reverse()}},75550:function(le){"use strict";le.exports=$;function $(C,L){this.x=C,this.y=L}$.prototype={clone:function(){return new $(this.x,this.y)},add:function(C){return this.clone()._add(C)},sub:function(C){return this.clone()._sub(C)},multByPoint:function(C){return this.clone()._multByPoint(C)},divByPoint:function(C){return this.clone()._divByPoint(C)},mult:function(C){return this.clone()._mult(C)},div:function(C){return this.clone()._div(C)},rotate:function(C){return this.clone()._rotate(C)},rotateAround:function(C,L){return this.clone()._rotateAround(C,L)},matMult:function(C){return this.clone()._matMult(C)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(C){return this.x===C.x&&this.y===C.y},dist:function(C){return Math.sqrt(this.distSqr(C))},distSqr:function(C){var L=C.x-this.x,k=C.y-this.y;return L*L+k*k},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(C){return Math.atan2(this.y-C.y,this.x-C.x)},angleWith:function(C){return this.angleWithSep(C.x,C.y)},angleWithSep:function(C,L){return Math.atan2(this.x*L-this.y*C,this.x*C+this.y*L)},_matMult:function(C){var L=C[0]*this.x+C[1]*this.y,k=C[2]*this.x+C[3]*this.y;return this.x=L,this.y=k,this},_add:function(C){return this.x+=C.x,this.y+=C.y,this},_sub:function(C){return this.x-=C.x,this.y-=C.y,this},_mult:function(C){return this.x*=C,this.y*=C,this},_div:function(C){return this.x/=C,this.y/=C,this},_multByPoint:function(C){return this.x*=C.x,this.y*=C.y,this},_divByPoint:function(C){return this.x/=C.x,this.y/=C.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var C=this.y;return this.y=this.x,this.x=-C,this},_rotate:function(C){var L=Math.cos(C),k=Math.sin(C),G=L*this.x-k*this.y,Z=k*this.x+L*this.y;return this.x=G,this.y=Z,this},_rotateAround:function(C,L){var k=Math.cos(C),G=Math.sin(C),Z=L.x+k*(this.x-L.x)-G*(this.y-L.y),F=L.y+G*(this.x-L.x)+k*(this.y-L.y);return this.x=Z,this.y=F,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},$.convert=function(C){return C instanceof $?C:Array.isArray(C)?new $(C[0],C[1]):C}},38929:function(le,$,C){le.exports.VectorTile=C(22779),C(66024),C(59701)},22779:function(le,$,C){"use strict";var L=C(59701);le.exports=k;function k(Z,F){this.layers=Z.readFields(G,{},F)}function G(Z,F,z){if(Z===3){var q=new L(z,z.readVarint()+z.pos);q.length&&(F[q.name]=q)}}},66024:function(le,$,C){"use strict";var L=C(75550);le.exports=k;function k(q,ee,fe,Se,Re){this.properties={},this.extent=fe,this.type=0,this._pbf=q,this._geometry=-1,this._keys=Se,this._values=Re,q.readFields(G,this,ee)}function G(q,ee,fe){q==1?ee.id=fe.readVarint():q==2?Z(fe,ee):q==3?ee.type=fe.readVarint():q==4&&(ee._geometry=fe.pos)}function Z(q,ee){for(var fe=q.readVarint()+q.pos;q.pos<fe;){var Se=ee._keys[q.readVarint()],Re=ee._values[q.readVarint()];ee.properties[Se]=Re}}k.types=["Unknown","Point","LineString","Polygon"],k.prototype.loadGeometry=function(){var q=this._pbf;q.pos=this._geometry;for(var ee=q.readVarint()+q.pos,fe=1,Se=0,Re=0,De=0,Ve=[],nt;q.pos<ee;){if(Se<=0){var Ee=q.readVarint();fe=Ee&7,Se=Ee>>3}if(Se--,fe===1||fe===2)Re+=q.readSVarint(),De+=q.readSVarint(),fe===1&&(nt&&Ve.push(nt),nt=[]),nt.push(new L(Re,De));else if(fe===7)nt&&nt.push(nt[0].clone());else throw new Error("unknown command "+fe)}return nt&&Ve.push(nt),Ve},k.prototype.bbox=function(){var q=this._pbf;q.pos=this._geometry;for(var ee=q.readVarint()+q.pos,fe=1,Se=0,Re=0,De=0,Ve=1/0,nt=-1/0,Ee=1/0,Ie=-1/0;q.pos<ee;){if(Se<=0){var me=q.readVarint();fe=me&7,Se=me>>3}if(Se--,fe===1||fe===2)Re+=q.readSVarint(),De+=q.readSVarint(),Re<Ve&&(Ve=Re),Re>nt&&(nt=Re),De<Ee&&(Ee=De),De>Ie&&(Ie=De);else if(fe!==7)throw new Error("unknown command "+fe)}return[Ve,Ee,nt,Ie]},k.prototype.toGeoJSON=function(q,ee,fe){var Se=this.extent*Math.pow(2,fe),Re=this.extent*q,De=this.extent*ee,Ve=this.loadGeometry(),nt=k.types[this.type],Ee,Ie;function me(Pe){for(var he=0;he<Pe.length;he++){var ve=Pe[he],te=180-(ve.y+De)*360/Se;Pe[he]=[(ve.x+Re)*360/Se-180,360/Math.PI*Math.atan(Math.exp(te*Math.PI/180))-90]}}switch(this.type){case 1:var we=[];for(Ee=0;Ee<Ve.length;Ee++)we[Ee]=Ve[Ee][0];Ve=we,me(Ve);break;case 2:for(Ee=0;Ee<Ve.length;Ee++)me(Ve[Ee]);break;case 3:for(Ve=F(Ve),Ee=0;Ee<Ve.length;Ee++)for(Ie=0;Ie<Ve[Ee].length;Ie++)me(Ve[Ee][Ie]);break}Ve.length===1?Ve=Ve[0]:nt="Multi"+nt;var ne={type:"Feature",geometry:{type:nt,coordinates:Ve},properties:this.properties};return"id"in this&&(ne.id=this.id),ne};function F(q){var ee=q.length;if(ee<=1)return[q];for(var fe=[],Se,Re,De=0;De<ee;De++){var Ve=z(q[De]);Ve!==0&&(Re===void 0&&(Re=Ve<0),Re===Ve<0?(Se&&fe.push(Se),Se=[q[De]]):Se.push(q[De]))}return Se&&fe.push(Se),fe}function z(q){for(var ee=0,fe=0,Se=q.length,Re=Se-1,De,Ve;fe<Se;Re=fe++)De=q[fe],Ve=q[Re],ee+=(Ve.x-De.x)*(De.y+Ve.y);return ee}},59701:function(le,$,C){"use strict";var L=C(66024);le.exports=k;function k(F,z){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=F,this._keys=[],this._values=[],this._features=[],F.readFields(G,this,z),this.length=this._features.length}function G(F,z,q){F===15?z.version=q.readVarint():F===1?z.name=q.readString():F===5?z.extent=q.readVarint():F===2?z._features.push(q.pos):F===3?z._keys.push(q.readString()):F===4&&z._values.push(Z(q))}function Z(F){for(var z=null,q=F.readVarint()+F.pos;F.pos<q;){var ee=F.readVarint()>>3;z=ee===1?F.readString():ee===2?F.readFloat():ee===3?F.readDouble():ee===4?F.readVarint64():ee===5?F.readVarint():ee===6?F.readSVarint():ee===7?F.readBoolean():null}return z}k.prototype.feature=function(F){if(F<0||F>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[F];var z=this._pbf.readVarint()+this._pbf.pos;return new L(this._pbf,z,this.extent,this._keys,this._values)}},9705:function(le,$,C){"use strict";var L;L={value:!0};var k=C(31540);function G(Z){var F=[1/0,1/0,-1/0,-1/0];return k.coordEach(Z,function(z){F[0]>z[0]&&(F[0]=z[0]),F[1]>z[1]&&(F[1]=z[1]),F[2]<z[0]&&(F[2]=z[0]),F[3]<z[1]&&(F[3]=z[1])}),F}G.default=G,$.Z=G},84102:function(le,$){"use strict";Object.defineProperty($,"__esModule",{value:!0}),$.earthRadius=63710088e-1,$.factors={centimeters:$.earthRadius*100,centimetres:$.earthRadius*100,degrees:$.earthRadius/111325,feet:$.earthRadius*3.28084,inches:$.earthRadius*39.37,kilometers:$.earthRadius/1e3,kilometres:$.earthRadius/1e3,meters:$.earthRadius,metres:$.earthRadius,miles:$.earthRadius/1609.344,millimeters:$.earthRadius*1e3,millimetres:$.earthRadius*1e3,nauticalmiles:$.earthRadius/1852,radians:1,yards:$.earthRadius*1.0936},$.unitsFactors={centimeters:100,centimetres:100,degrees:1/111325,feet:3.28084,inches:39.37,kilometers:1/1e3,kilometres:1/1e3,meters:1,metres:1,miles:1/1609.344,millimeters:1e3,millimetres:1e3,nauticalmiles:1/1852,radians:1/$.earthRadius,yards:1.0936133},$.areaFactors={acres:247105e-9,centimeters:1e4,centimetres:1e4,feet:10.763910417,hectares:1e-4,inches:1550.003100006,kilometers:1e-6,kilometres:1e-6,meters:1,metres:1,miles:386e-9,millimeters:1e6,millimetres:1e6,yards:1.195990046};function C(pe,ye,_e){_e===void 0&&(_e={});var X={type:"Feature"};return(_e.id===0||_e.id)&&(X.id=_e.id),_e.bbox&&(X.bbox=_e.bbox),X.properties=ye||{},X.geometry=pe,X}$.feature=C;function L(pe,ye,_e){switch(_e===void 0&&(_e={}),pe){case"Point":return k(ye).geometry;case"LineString":return z(ye).geometry;case"Polygon":return Z(ye).geometry;case"MultiPoint":return Se(ye).geometry;case"MultiLineString":return fe(ye).geometry;case"MultiPolygon":return Re(ye).geometry;default:throw new Error(pe+" is invalid")}}$.geometry=L;function k(pe,ye,_e){if(_e===void 0&&(_e={}),!pe)throw new Error("coordinates is required");if(!Array.isArray(pe))throw new Error("coordinates must be an Array");if(pe.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!ve(pe[0])||!ve(pe[1]))throw new Error("coordinates must contain numbers");var X={type:"Point",coordinates:pe};return C(X,ye,_e)}$.point=k;function G(pe,ye,_e){return _e===void 0&&(_e={}),ee(pe.map(function(X){return k(X,ye)}),_e)}$.points=G;function Z(pe,ye,_e){_e===void 0&&(_e={});for(var X=0,Le=pe;X<Le.length;X++){var de=Le[X];if(de.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var be=0;be<de[de.length-1].length;be++)if(de[de.length-1][be]!==de[0][be])throw new Error("First and last Position are not equivalent.")}var se={type:"Polygon",coordinates:pe};return C(se,ye,_e)}$.polygon=Z;function F(pe,ye,_e){return _e===void 0&&(_e={}),ee(pe.map(function(X){return Z(X,ye)}),_e)}$.polygons=F;function z(pe,ye,_e){if(_e===void 0&&(_e={}),pe.length<2)throw new Error("coordinates must be an array of two or more positions");var X={type:"LineString",coordinates:pe};return C(X,ye,_e)}$.lineString=z;function q(pe,ye,_e){return _e===void 0&&(_e={}),ee(pe.map(function(X){return z(X,ye)}),_e)}$.lineStrings=q;function ee(pe,ye){ye===void 0&&(ye={});var _e={type:"FeatureCollection"};return ye.id&&(_e.id=ye.id),ye.bbox&&(_e.bbox=ye.bbox),_e.features=pe,_e}$.featureCollection=ee;function fe(pe,ye,_e){_e===void 0&&(_e={});var X={type:"MultiLineString",coordinates:pe};return C(X,ye,_e)}$.multiLineString=fe;function Se(pe,ye,_e){_e===void 0&&(_e={});var X={type:"MultiPoint",coordinates:pe};return C(X,ye,_e)}$.multiPoint=Se;function Re(pe,ye,_e){_e===void 0&&(_e={});var X={type:"MultiPolygon",coordinates:pe};return C(X,ye,_e)}$.multiPolygon=Re;function De(pe,ye,_e){_e===void 0&&(_e={});var X={type:"GeometryCollection",geometries:pe};return C(X,ye,_e)}$.geometryCollection=De;function Ve(pe,ye){if(ye===void 0&&(ye=0),ye&&!(ye>=0))throw new Error("precision must be a positive number");var _e=Math.pow(10,ye||0);return Math.round(pe*_e)/_e}$.round=Ve;function nt(pe,ye){ye===void 0&&(ye="kilometers");var _e=$.factors[ye];if(!_e)throw new Error(ye+" units is invalid");return pe*_e}$.radiansToLength=nt;function Ee(pe,ye){ye===void 0&&(ye="kilometers");var _e=$.factors[ye];if(!_e)throw new Error(ye+" units is invalid");return pe/_e}$.lengthToRadians=Ee;function Ie(pe,ye){return we(Ee(pe,ye))}$.lengthToDegrees=Ie;function me(pe){var ye=pe%360;return ye<0&&(ye+=360),ye}$.bearingToAzimuth=me;function we(pe){var ye=pe%(2*Math.PI);return ye*180/Math.PI}$.radiansToDegrees=we;function ne(pe){var ye=pe%360;return ye*Math.PI/180}$.degreesToRadians=ne;function Pe(pe,ye,_e){if(ye===void 0&&(ye="kilometers"),_e===void 0&&(_e="kilometers"),!(pe>=0))throw new Error("length must be a positive number");return nt(Ee(pe,ye),_e)}$.convertLength=Pe;function he(pe,ye,_e){if(ye===void 0&&(ye="meters"),_e===void 0&&(_e="kilometers"),!(pe>=0))throw new Error("area must be a positive number");var X=$.areaFactors[ye];if(!X)throw new Error("invalid original units");var Le=$.areaFactors[_e];if(!Le)throw new Error("invalid final units");return pe/X*Le}$.convertArea=he;function ve(pe){return!isNaN(pe)&&pe!==null&&!Array.isArray(pe)}$.isNumber=ve;function te(pe){return!!pe&&pe.constructor===Object}$.isObject=te;function Y(pe){if(!pe)throw new Error("bbox is required");if(!Array.isArray(pe))throw new Error("bbox must be an Array");if(pe.length!==4&&pe.length!==6)throw new Error("bbox must be an Array of 4 or 6 numbers");pe.forEach(function(ye){if(!ve(ye))throw new Error("bbox must only contain numbers")})}$.validateBBox=Y;function Oe(pe){if(!pe)throw new Error("id is required");if(["string","number"].indexOf(typeof pe)===-1)throw new Error("id must be a number or a string")}$.validateId=Oe},31540:function(le,$,C){"use strict";Object.defineProperty($,"__esModule",{value:!0});var L=C(84102);function k(ne,Pe,he){if(ne!==null)for(var ve,te,Y,Oe,pe,ye,_e,X=0,Le=0,de,be=ne.type,se=be==="FeatureCollection",Ne=be==="Feature",ze=se?ne.features.length:1,ue=0;ue<ze;ue++){_e=se?ne.features[ue].geometry:Ne?ne.geometry:ne,de=_e?_e.type==="GeometryCollection":!1,pe=de?_e.geometries.length:1;for(var kt=0;kt<pe;kt++){var Rt=0,cr=0;if(Oe=de?_e.geometries[kt]:_e,Oe!==null){ye=Oe.coordinates;var Ut=Oe.type;switch(X=he&&(Ut==="Polygon"||Ut==="MultiPolygon")?1:0,Ut){case null:break;case"Point":if(Pe(ye,Le,ue,Rt,cr)===!1)return!1;Le++,Rt++;break;case"LineString":case"MultiPoint":for(ve=0;ve<ye.length;ve++){if(Pe(ye[ve],Le,ue,Rt,cr)===!1)return!1;Le++,Ut==="MultiPoint"&&Rt++}Ut==="LineString"&&Rt++;break;case"Polygon":case"MultiLineString":for(ve=0;ve<ye.length;ve++){for(te=0;te<ye[ve].length-X;te++){if(Pe(ye[ve][te],Le,ue,Rt,cr)===!1)return!1;Le++}Ut==="MultiLineString"&&Rt++,Ut==="Polygon"&&cr++}Ut==="Polygon"&&Rt++;break;case"MultiPolygon":for(ve=0;ve<ye.length;ve++){for(cr=0,te=0;te<ye[ve].length;te++){for(Y=0;Y<ye[ve][te].length-X;Y++){if(Pe(ye[ve][te][Y],Le,ue,Rt,cr)===!1)return!1;Le++}cr++}Rt++}break;case"GeometryCollection":for(ve=0;ve<Oe.geometries.length;ve++)if(k(Oe.geometries[ve],Pe,he)===!1)return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function G(ne,Pe,he,ve){var te=he;return k(ne,function(Y,Oe,pe,ye,_e){Oe===0&&he===void 0?te=Y:te=Pe(te,Y,Oe,pe,ye,_e)},ve),te}function Z(ne,Pe){var he;switch(ne.type){case"FeatureCollection":for(he=0;he<ne.features.length&&Pe(ne.features[he].properties,he)!==!1;he++);break;case"Feature":Pe(ne.properties,0);break}}function F(ne,Pe,he){var ve=he;return Z(ne,function(te,Y){Y===0&&he===void 0?ve=te:ve=Pe(ve,te,Y)}),ve}function z(ne,Pe){if(ne.type==="Feature")Pe(ne,0);else if(ne.type==="FeatureCollection")for(var he=0;he<ne.features.length&&Pe(ne.features[he],he)!==!1;he++);}function q(ne,Pe,he){var ve=he;return z(ne,function(te,Y){Y===0&&he===void 0?ve=te:ve=Pe(ve,te,Y)}),ve}function ee(ne){var Pe=[];return k(ne,function(he){Pe.push(he)}),Pe}function fe(ne,Pe){var he,ve,te,Y,Oe,pe,ye,_e,X,Le,de=0,be=ne.type==="FeatureCollection",se=ne.type==="Feature",Ne=be?ne.features.length:1;for(he=0;he<Ne;he++){for(pe=be?ne.features[he].geometry:se?ne.geometry:ne,_e=be?ne.features[he].properties:se?ne.properties:{},X=be?ne.features[he].bbox:se?ne.bbox:void 0,Le=be?ne.features[he].id:se?ne.id:void 0,ye=pe?pe.type==="GeometryCollection":!1,Oe=ye?pe.geometries.length:1,te=0;te<Oe;te++){if(Y=ye?pe.geometries[te]:pe,Y===null){if(Pe(null,de,_e,X,Le)===!1)return!1;continue}switch(Y.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":{if(Pe(Y,de,_e,X,Le)===!1)return!1;break}case"GeometryCollection":{for(ve=0;ve<Y.geometries.length;ve++)if(Pe(Y.geometries[ve],de,_e,X,Le)===!1)return!1;break}default:throw new Error("Unknown Geometry Type")}}de++}}function Se(ne,Pe,he){var ve=he;return fe(ne,function(te,Y,Oe,pe,ye){Y===0&&he===void 0?ve=te:ve=Pe(ve,te,Y,Oe,pe,ye)}),ve}function Re(ne,Pe){fe(ne,function(he,ve,te,Y,Oe){var pe=he===null?null:he.type;switch(pe){case null:case"Point":case"LineString":case"Polygon":return Pe(L.feature(he,te,{bbox:Y,id:Oe}),ve,0)===!1?!1:void 0}var ye;switch(pe){case"MultiPoint":ye="Point";break;case"MultiLineString":ye="LineString";break;case"MultiPolygon":ye="Polygon";break}for(var _e=0;_e<he.coordinates.length;_e++){var X=he.coordinates[_e],Le={type:ye,coordinates:X};if(Pe(L.feature(Le,te),ve,_e)===!1)return!1}})}function De(ne,Pe,he){var ve=he;return Re(ne,function(te,Y,Oe){Y===0&&Oe===0&&he===void 0?ve=te:ve=Pe(ve,te,Y,Oe)}),ve}function Ve(ne,Pe){Re(ne,function(he,ve,te){var Y=0;if(he.geometry){var Oe=he.geometry.type;if(!(Oe==="Point"||Oe==="MultiPoint")){var pe,ye=0,_e=0,X=0;if(k(he,function(Le,de,be,se,Ne){if(pe===void 0||ve>ye||se>_e||Ne>X){pe=Le,ye=ve,_e=se,X=Ne,Y=0;return}var ze=L.lineString([pe,Le],he.properties);if(Pe(ze,ve,te,Ne,Y)===!1)return!1;Y++,pe=Le})===!1)return!1}}})}function nt(ne,Pe,he){var ve=he,te=!1;return Ve(ne,function(Y,Oe,pe,ye,_e){te===!1&&he===void 0?ve=Y:ve=Pe(ve,Y,Oe,pe,ye,_e),te=!0}),ve}function Ee(ne,Pe){if(!ne)throw new Error("geojson is required");Re(ne,function(he,ve,te){if(he.geometry!==null){var Y=he.geometry.type,Oe=he.geometry.coordinates;switch(Y){case"LineString":if(Pe(he,ve,te,0,0)===!1)return!1;break;case"Polygon":for(var pe=0;pe<Oe.length;pe++)if(Pe(L.lineString(Oe[pe],he.properties),ve,te,pe)===!1)return!1;break}}})}function Ie(ne,Pe,he){var ve=he;return Ee(ne,function(te,Y,Oe,pe){Y===0&&he===void 0?ve=te:ve=Pe(ve,te,Y,Oe,pe)}),ve}function me(ne,Pe){if(Pe=Pe||{},!L.isObject(Pe))throw new Error("options is invalid");var he=Pe.featureIndex||0,ve=Pe.multiFeatureIndex||0,te=Pe.geometryIndex||0,Y=Pe.segmentIndex||0,Oe=Pe.properties,pe;switch(ne.type){case"FeatureCollection":he<0&&(he=ne.features.length+he),Oe=Oe||ne.features[he].properties,pe=ne.features[he].geometry;break;case"Feature":Oe=Oe||ne.properties,pe=ne.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":pe=ne;break;default:throw new Error("geojson is invalid")}if(pe===null)return null;var ye=pe.coordinates;switch(pe.type){case"Point":case"MultiPoint":return null;case"LineString":return Y<0&&(Y=ye.length+Y-1),L.lineString([ye[Y],ye[Y+1]],Oe,Pe);case"Polygon":return te<0&&(te=ye.length+te),Y<0&&(Y=ye[te].length+Y-1),L.lineString([ye[te][Y],ye[te][Y+1]],Oe,Pe);case"MultiLineString":return ve<0&&(ve=ye.length+ve),Y<0&&(Y=ye[ve].length+Y-1),L.lineString([ye[ve][Y],ye[ve][Y+1]],Oe,Pe);case"MultiPolygon":return ve<0&&(ve=ye.length+ve),te<0&&(te=ye[ve].length+te),Y<0&&(Y=ye[ve][te].length-Y-1),L.lineString([ye[ve][te][Y],ye[ve][te][Y+1]],Oe,Pe)}throw new Error("geojson is invalid")}function we(ne,Pe){if(Pe=Pe||{},!L.isObject(Pe))throw new Error("options is invalid");var he=Pe.featureIndex||0,ve=Pe.multiFeatureIndex||0,te=Pe.geometryIndex||0,Y=Pe.coordIndex||0,Oe=Pe.properties,pe;switch(ne.type){case"FeatureCollection":he<0&&(he=ne.features.length+he),Oe=Oe||ne.features[he].properties,pe=ne.features[he].geometry;break;case"Feature":Oe=Oe||ne.properties,pe=ne.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":pe=ne;break;default:throw new Error("geojson is invalid")}if(pe===null)return null;var ye=pe.coordinates;switch(pe.type){case"Point":return L.point(ye,Oe,Pe);case"MultiPoint":return ve<0&&(ve=ye.length+ve),L.point(ye[ve],Oe,Pe);case"LineString":return Y<0&&(Y=ye.length+Y),L.point(ye[Y],Oe,Pe);case"Polygon":return te<0&&(te=ye.length+te),Y<0&&(Y=ye[te].length+Y),L.point(ye[te][Y],Oe,Pe);case"MultiLineString":return ve<0&&(ve=ye.length+ve),Y<0&&(Y=ye[ve].length+Y),L.point(ye[ve][Y],Oe,Pe);case"MultiPolygon":return ve<0&&(ve=ye.length+ve),te<0&&(te=ye[ve].length+te),Y<0&&(Y=ye[ve][te].length-Y),L.point(ye[ve][te][Y],Oe,Pe)}throw new Error("geojson is invalid")}$.coordAll=ee,$.coordEach=k,$.coordReduce=G,$.featureEach=z,$.featureReduce=q,$.findPoint=we,$.findSegment=me,$.flattenEach=Re,$.flattenReduce=De,$.geomEach=fe,$.geomReduce=Se,$.lineEach=Ee,$.lineReduce=Ie,$.propEach=Z,$.propReduce=F,$.segmentEach=Ve,$.segmentReduce=nt},21924:function(le,$,C){"use strict";var L=C(40210),k=C(55559),G=k(L("String.prototype.indexOf"));le.exports=function(F,z){var q=L(F,!!z);return typeof q=="function"&&G(F,".prototype.")>-1?k(q):q}},55559:function(le,$,C){"use strict";var L=C(58612),k=C(40210),G=C(67771),Z=k("%TypeError%"),F=k("%Function.prototype.apply%"),z=k("%Function.prototype.call%"),q=k("%Reflect.apply%",!0)||L.call(z,F),ee=k("%Object.defineProperty%",!0),fe=k("%Math.max%");if(ee)try{ee({},"a",{value:1})}catch(Re){ee=null}le.exports=function(De){if(typeof De!="function")throw new Z("a function is required");var Ve=q(L,z,arguments);return G(Ve,1+fe(0,De.length-(arguments.length-1)),!0)};var Se=function(){return q(L,F,arguments)};ee?ee(le.exports,"apply",{value:Se}):le.exports.apply=Se},72273:function(le,$,C){"use strict";var L=C(81662),k=C(43842),G=C(26960),Z=C(88639).orient2d;k.default&&(k=k.default),le.exports=F,le.exports.default=F;function F(he,ve,te){ve=Math.max(0,ve===void 0?2:ve),te=te||0;var Y=nt(he),Oe=new L(16);Oe.toBBox=function(cr){return{minX:cr[0],minY:cr[1],maxX:cr[0],maxY:cr[1]}},Oe.compareMinX=function(cr,Ut){return cr[0]-Ut[0]},Oe.compareMinY=function(cr,Ut){return cr[1]-Ut[1]},Oe.load(he);for(var pe=[],ye=0,_e;ye<Y.length;ye++){var X=Y[ye];Oe.remove(X),_e=Ee(X,_e),pe.push(_e)}var Le=new L(16);for(ye=0;ye<pe.length;ye++)Le.insert(Ve(pe[ye]));for(var de=ve*ve,be=te*te;pe.length;){var se=pe.shift(),Ne=se.p,ze=se.next.p,ue=Ie(Ne,ze);if(!(ue<be)){var kt=ue/de;X=z(Oe,se.prev.p,Ne,ze,se.next.next.p,kt,Le),X&&Math.min(Ie(X,Ne),Ie(X,ze))<=kt&&(pe.push(se),pe.push(Ee(X,se)),Oe.remove(X),Le.remove(se),Le.insert(Ve(se)),Le.insert(Ve(se.next)))}}se=_e;var Rt=[];do Rt.push(se.p),se=se.next;while(se!==_e);return Rt.push(se.p),Rt}function z(he,ve,te,Y,Oe,pe,ye){for(var _e=new k([],q),X=he.data;X;){for(var Le=0;Le<X.children.length;Le++){var de=X.children[Le],be=X.leaf?me(de,te,Y):ee(te,Y,de);be>pe||_e.push({node:de,dist:be})}for(;_e.length&&!_e.peek().node.children;){var se=_e.pop(),Ne=se.node,ze=me(Ne,ve,te),ue=me(Ne,Y,Oe);if(se.dist<ze&&se.dist<ue&&Se(te,Ne,ye)&&Se(Y,Ne,ye))return Ne}X=_e.pop(),X&&(X=X.node)}return null}function q(he,ve){return he.dist-ve.dist}function ee(he,ve,te){if(fe(he,te)||fe(ve,te))return 0;var Y=we(he[0],he[1],ve[0],ve[1],te.minX,te.minY,te.maxX,te.minY);if(Y===0)return 0;var Oe=we(he[0],he[1],ve[0],ve[1],te.minX,te.minY,te.minX,te.maxY);if(Oe===0)return 0;var pe=we(he[0],he[1],ve[0],ve[1],te.maxX,te.minY,te.maxX,te.maxY);if(pe===0)return 0;var ye=we(he[0],he[1],ve[0],ve[1],te.minX,te.maxY,te.maxX,te.maxY);return ye===0?0:Math.min(Y,Oe,pe,ye)}function fe(he,ve){return he[0]>=ve.minX&&he[0]<=ve.maxX&&he[1]>=ve.minY&&he[1]<=ve.maxY}function Se(he,ve,te){for(var Y=Math.min(he[0],ve[0]),Oe=Math.min(he[1],ve[1]),pe=Math.max(he[0],ve[0]),ye=Math.max(he[1],ve[1]),_e=te.search({minX:Y,minY:Oe,maxX:pe,maxY:ye}),X=0;X<_e.length;X++)if(De(_e[X].p,_e[X].next.p,he,ve))return!1;return!0}function Re(he,ve,te){return Z(he[0],he[1],ve[0],ve[1],te[0],te[1])}function De(he,ve,te,Y){return he!==Y&&ve!==te&&Re(he,ve,te)>0!=Re(he,ve,Y)>0&&Re(te,Y,he)>0!=Re(te,Y,ve)>0}function Ve(he){var ve=he.p,te=he.next.p;return he.minX=Math.min(ve[0],te[0]),he.minY=Math.min(ve[1],te[1]),he.maxX=Math.max(ve[0],te[0]),he.maxY=Math.max(ve[1],te[1]),he}function nt(he){for(var ve=he[0],te=he[0],Y=he[0],Oe=he[0],pe=0;pe<he.length;pe++){var ye=he[pe];ye[0]<ve[0]&&(ve=ye),ye[0]>Y[0]&&(Y=ye),ye[1]<te[1]&&(te=ye),ye[1]>Oe[1]&&(Oe=ye)}var _e=[ve,te,Y,Oe],X=_e.slice();for(pe=0;pe<he.length;pe++)G(he[pe],_e)||X.push(he[pe]);return Pe(X)}function Ee(he,ve){var te={p:he,prev:null,next:null,minX:0,minY:0,maxX:0,maxY:0};return ve?(te.next=ve.next,te.prev=ve,ve.next.prev=te,ve.next=te):(te.prev=te,te.next=te),te}function Ie(he,ve){var te=he[0]-ve[0],Y=he[1]-ve[1];return te*te+Y*Y}function me(he,ve,te){var Y=ve[0],Oe=ve[1],pe=te[0]-Y,ye=te[1]-Oe;if(pe!==0||ye!==0){var _e=((he[0]-Y)*pe+(he[1]-Oe)*ye)/(pe*pe+ye*ye);_e>1?(Y=te[0],Oe=te[1]):_e>0&&(Y+=pe*_e,Oe+=ye*_e)}return pe=he[0]-Y,ye=he[1]-Oe,pe*pe+ye*ye}function we(he,ve,te,Y,Oe,pe,ye,_e){var X=te-he,Le=Y-ve,de=ye-Oe,be=_e-pe,se=he-Oe,Ne=ve-pe,ze=X*X+Le*Le,ue=X*de+Le*be,kt=de*de+be*be,Rt=X*se+Le*Ne,cr=de*se+be*Ne,Ut=ze*kt-ue*ue,$r,ln,Cr,Qr,Jr=Ut,xr=Ut;Ut===0?(ln=0,Jr=1,Qr=cr,xr=kt):(ln=ue*cr-kt*Rt,Qr=ze*cr-ue*Rt,ln<0?(ln=0,Qr=cr,xr=kt):ln>Jr&&(ln=Jr,Qr=cr+ue,xr=kt)),Qr<0?(Qr=0,-Rt<0?ln=0:-Rt>ze?ln=Jr:(ln=-Rt,Jr=ze)):Qr>xr&&(Qr=xr,-Rt+ue<0?ln=0:-Rt+ue>ze?ln=Jr:(ln=-Rt+ue,Jr=ze)),$r=ln===0?0:ln/Jr,Cr=Qr===0?0:Qr/xr;var Gn=(1-$r)*he+$r*te,ti=(1-$r)*ve+$r*Y,Vn=(1-Cr)*Oe+Cr*ye,Xr=(1-Cr)*pe+Cr*_e,sn=Vn-Gn,yn=Xr-ti;return sn*sn+yn*yn}function ne(he,ve){return he[0]===ve[0]?he[1]-ve[1]:he[0]-ve[0]}function Pe(he){he.sort(ne);for(var ve=[],te=0;te<he.length;te++){for(;ve.length>=2&&Re(ve[ve.length-2],ve[ve.length-1],he[te])<=0;)ve.pop();ve.push(he[te])}for(var Y=[],Oe=he.length-1;Oe>=0;Oe--){for(;Y.length>=2&&Re(Y[Y.length-2],Y[Y.length-1],he[Oe])<=0;)Y.pop();Y.push(he[Oe])}return Y.pop(),ve.pop(),ve.concat(Y)}},81662:function(le){(function($,C){le.exports=C()})(this,function(){"use strict";function $(Ee,Ie,me,we,ne){(function Pe(he,ve,te,Y,Oe){for(;Y>te;){if(Y-te>600){var pe=Y-te+1,ye=ve-te+1,_e=Math.log(pe),X=.5*Math.exp(2*_e/3),Le=.5*Math.sqrt(_e*X*(pe-X)/pe)*(ye-pe/2<0?-1:1),de=Math.max(te,Math.floor(ve-ye*X/pe+Le)),be=Math.min(Y,Math.floor(ve+(pe-ye)*X/pe+Le));Pe(he,ve,de,be,Oe)}var se=he[ve],Ne=te,ze=Y;for(C(he,te,ve),Oe(he[Y],se)>0&&C(he,te,Y);Ne<ze;){for(C(he,Ne,ze),Ne++,ze--;Oe(he[Ne],se)<0;)Ne++;for(;Oe(he[ze],se)>0;)ze--}Oe(he[te],se)===0?C(he,te,ze):C(he,++ze,Y),ze<=ve&&(te=ze+1),ve<=ze&&(Y=ze-1)}})(Ee,Ie,me||0,we||Ee.length-1,ne||L)}function C(Ee,Ie,me){var we=Ee[Ie];Ee[Ie]=Ee[me],Ee[me]=we}function L(Ee,Ie){return Ee<Ie?-1:Ee>Ie?1:0}var k=function(Ee){Ee===void 0&&(Ee=9),this._maxEntries=Math.max(4,Ee),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),this.clear()};function G(Ee,Ie,me){if(!me)return Ie.indexOf(Ee);for(var we=0;we<Ie.length;we++)if(me(Ee,Ie[we]))return we;return-1}function Z(Ee,Ie){F(Ee,0,Ee.children.length,Ie,Ee)}function F(Ee,Ie,me,we,ne){ne||(ne=Ve(null)),ne.minX=1/0,ne.minY=1/0,ne.maxX=-1/0,ne.maxY=-1/0;for(var Pe=Ie;Pe<me;Pe++){var he=Ee.children[Pe];z(ne,Ee.leaf?we(he):he)}return ne}function z(Ee,Ie){return Ee.minX=Math.min(Ee.minX,Ie.minX),Ee.minY=Math.min(Ee.minY,Ie.minY),Ee.maxX=Math.max(Ee.maxX,Ie.maxX),Ee.maxY=Math.max(Ee.maxY,Ie.maxY),Ee}function q(Ee,Ie){return Ee.minX-Ie.minX}function ee(Ee,Ie){return Ee.minY-Ie.minY}function fe(Ee){return(Ee.maxX-Ee.minX)*(Ee.maxY-Ee.minY)}function Se(Ee){return Ee.maxX-Ee.minX+(Ee.maxY-Ee.minY)}function Re(Ee,Ie){return Ee.minX<=Ie.minX&&Ee.minY<=Ie.minY&&Ie.maxX<=Ee.maxX&&Ie.maxY<=Ee.maxY}function De(Ee,Ie){return Ie.minX<=Ee.maxX&&Ie.minY<=Ee.maxY&&Ie.maxX>=Ee.minX&&Ie.maxY>=Ee.minY}function Ve(Ee){return{children:Ee,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function nt(Ee,Ie,me,we,ne){for(var Pe=[Ie,me];Pe.length;)if(!((me=Pe.pop())-(Ie=Pe.pop())<=we)){var he=Ie+Math.ceil((me-Ie)/we/2)*we;$(Ee,he,Ie,me,ne),Pe.push(Ie,he,he,me)}}return k.prototype.all=function(){return this._all(this.data,[])},k.prototype.search=function(Ee){var Ie=this.data,me=[];if(!De(Ee,Ie))return me;for(var we=this.toBBox,ne=[];Ie;){for(var Pe=0;Pe<Ie.children.length;Pe++){var he=Ie.children[Pe],ve=Ie.leaf?we(he):he;De(Ee,ve)&&(Ie.leaf?me.push(he):Re(Ee,ve)?this._all(he,me):ne.push(he))}Ie=ne.pop()}return me},k.prototype.collides=function(Ee){var Ie=this.data;if(!De(Ee,Ie))return!1;for(var me=[];Ie;){for(var we=0;we<Ie.children.length;we++){var ne=Ie.children[we],Pe=Ie.leaf?this.toBBox(ne):ne;if(De(Ee,Pe)){if(Ie.leaf||Re(Ee,Pe))return!0;me.push(ne)}}Ie=me.pop()}return!1},k.prototype.load=function(Ee){if(!Ee||!Ee.length)return this;if(Ee.length<this._minEntries){for(var Ie=0;Ie<Ee.length;Ie++)this.insert(Ee[Ie]);return this}var me=this._build(Ee.slice(),0,Ee.length-1,0);if(this.data.children.length)if(this.data.height===me.height)this._splitRoot(this.data,me);else{if(this.data.height<me.height){var we=this.data;this.data=me,me=we}this._insert(me,this.data.height-me.height-1,!0)}else this.data=me;return this},k.prototype.insert=function(Ee){return Ee&&this._insert(Ee,this.data.height-1),this},k.prototype.clear=function(){return this.data=Ve([]),this},k.prototype.remove=function(Ee,Ie){if(!Ee)return this;for(var me,we,ne,Pe=this.data,he=this.toBBox(Ee),ve=[],te=[];Pe||ve.length;){if(Pe||(Pe=ve.pop(),we=ve[ve.length-1],me=te.pop(),ne=!0),Pe.leaf){var Y=G(Ee,Pe.children,Ie);if(Y!==-1)return Pe.children.splice(Y,1),ve.push(Pe),this._condense(ve),this}ne||Pe.leaf||!Re(Pe,he)?we?(me++,Pe=we.children[me],ne=!1):Pe=null:(ve.push(Pe),te.push(me),me=0,we=Pe,Pe=Pe.children[0])}return this},k.prototype.toBBox=function(Ee){return Ee},k.prototype.compareMinX=function(Ee,Ie){return Ee.minX-Ie.minX},k.prototype.compareMinY=function(Ee,Ie){return Ee.minY-Ie.minY},k.prototype.toJSON=function(){return this.data},k.prototype.fromJSON=function(Ee){return this.data=Ee,this},k.prototype._all=function(Ee,Ie){for(var me=[];Ee;)Ee.leaf?Ie.push.apply(Ie,Ee.children):me.push.apply(me,Ee.children),Ee=me.pop();return Ie},k.prototype._build=function(Ee,Ie,me,we){var ne,Pe=me-Ie+1,he=this._maxEntries;if(Pe<=he)return Z(ne=Ve(Ee.slice(Ie,me+1)),this.toBBox),ne;we||(we=Math.ceil(Math.log(Pe)/Math.log(he)),he=Math.ceil(Pe/Math.pow(he,we-1))),(ne=Ve([])).leaf=!1,ne.height=we;var ve=Math.ceil(Pe/he),te=ve*Math.ceil(Math.sqrt(he));nt(Ee,Ie,me,te,this.compareMinX);for(var Y=Ie;Y<=me;Y+=te){var Oe=Math.min(Y+te-1,me);nt(Ee,Y,Oe,ve,this.compareMinY);for(var pe=Y;pe<=Oe;pe+=ve){var ye=Math.min(pe+ve-1,Oe);ne.children.push(this._build(Ee,pe,ye,we-1))}}return Z(ne,this.toBBox),ne},k.prototype._chooseSubtree=function(Ee,Ie,me,we){for(;we.push(Ie),!Ie.leaf&&we.length-1!==me;){for(var ne=1/0,Pe=1/0,he=void 0,ve=0;ve<Ie.children.length;ve++){var te=Ie.children[ve],Y=fe(te),Oe=(pe=Ee,ye=te,(Math.max(ye.maxX,pe.maxX)-Math.min(ye.minX,pe.minX))*(Math.max(ye.maxY,pe.maxY)-Math.min(ye.minY,pe.minY))-Y);Oe<Pe?(Pe=Oe,ne=Y<ne?Y:ne,he=te):Oe===Pe&&Y<ne&&(ne=Y,he=te)}Ie=he||Ie.children[0]}var pe,ye;return Ie},k.prototype._insert=function(Ee,Ie,me){var we=me?Ee:this.toBBox(Ee),ne=[],Pe=this._chooseSubtree(we,this.data,Ie,ne);for(Pe.children.push(Ee),z(Pe,we);Ie>=0&&ne[Ie].children.length>this._maxEntries;)this._split(ne,Ie),Ie--;this._adjustParentBBoxes(we,ne,Ie)},k.prototype._split=function(Ee,Ie){var me=Ee[Ie],we=me.children.length,ne=this._minEntries;this._chooseSplitAxis(me,ne,we);var Pe=this._chooseSplitIndex(me,ne,we),he=Ve(me.children.splice(Pe,me.children.length-Pe));he.height=me.height,he.leaf=me.leaf,Z(me,this.toBBox),Z(he,this.toBBox),Ie?Ee[Ie-1].children.push(he):this._splitRoot(me,he)},k.prototype._splitRoot=function(Ee,Ie){this.data=Ve([Ee,Ie]),this.data.height=Ee.height+1,this.data.leaf=!1,Z(this.data,this.toBBox)},k.prototype._chooseSplitIndex=function(Ee,Ie,me){for(var we,ne,Pe,he,ve,te,Y,Oe=1/0,pe=1/0,ye=Ie;ye<=me-Ie;ye++){var _e=F(Ee,0,ye,this.toBBox),X=F(Ee,ye,me,this.toBBox),Le=(ne=_e,Pe=X,he=void 0,ve=void 0,te=void 0,Y=void 0,he=Math.max(ne.minX,Pe.minX),ve=Math.max(ne.minY,Pe.minY),te=Math.min(ne.maxX,Pe.maxX),Y=Math.min(ne.maxY,Pe.maxY),Math.max(0,te-he)*Math.max(0,Y-ve)),de=fe(_e)+fe(X);Le<Oe?(Oe=Le,we=ye,pe=de<pe?de:pe):Le===Oe&&de<pe&&(pe=de,we=ye)}return we||me-Ie},k.prototype._chooseSplitAxis=function(Ee,Ie,me){var we=Ee.leaf?this.compareMinX:q,ne=Ee.leaf?this.compareMinY:ee;this._allDistMargin(Ee,Ie,me,we)<this._allDistMargin(Ee,Ie,me,ne)&&Ee.children.sort(we)},k.prototype._allDistMargin=function(Ee,Ie,me,we){Ee.children.sort(we);for(var ne=this.toBBox,Pe=F(Ee,0,Ie,ne),he=F(Ee,me-Ie,me,ne),ve=Se(Pe)+Se(he),te=Ie;te<me-Ie;te++){var Y=Ee.children[te];z(Pe,Ee.leaf?ne(Y):Y),ve+=Se(Pe)}for(var Oe=me-Ie-1;Oe>=Ie;Oe--){var pe=Ee.children[Oe];z(he,Ee.leaf?ne(pe):pe),ve+=Se(he)}return ve},k.prototype._adjustParentBBoxes=function(Ee,Ie,me){for(var we=me;we>=0;we--)z(Ie[we],Ee)},k.prototype._condense=function(Ee){for(var Ie=Ee.length-1,me=void 0;Ie>=0;Ie--)Ee[Ie].children.length===0?Ie>0?(me=Ee[Ie-1].children).splice(me.indexOf(Ee[Ie]),1):this.clear():Z(Ee[Ie],this.toBBox)},k})},61272:function(le,$,C){"use strict";C.d($,{j2:function(){return L},b4:function(){return q},YF:function(){return k},We:function(){return ee},TS:function(){return Pe},VR:function(){return ve},G9:function(){return Ie},ly:function(){return me},sd:function(){return Ee}});function L(te,Y){return te<Y?-1:te>Y?1:te>=Y?0:NaN}function k(te){return te.length===1&&(te=G(te)),{left:function(Y,Oe,pe,ye){for(pe==null&&(pe=0),ye==null&&(ye=Y.length);pe<ye;){var _e=pe+ye>>>1;te(Y[_e],Oe)<0?pe=_e+1:ye=_e}return pe},right:function(Y,Oe,pe,ye){for(pe==null&&(pe=0),ye==null&&(ye=Y.length);pe<ye;){var _e=pe+ye>>>1;te(Y[_e],Oe)>0?ye=_e:pe=_e+1}return pe}}}function G(te){return function(Y,Oe){return L(te(Y),Oe)}}var Z=k(L),F=Z.right,z=Z.left,q=F;function ee(te,Y){var Oe=te.length,pe=-1,ye,_e,X;if(Y==null){for(;++pe<Oe;)if((ye=te[pe])!=null&&ye>=ye)for(_e=X=ye;++pe<Oe;)(ye=te[pe])!=null&&(_e>ye&&(_e=ye),X<ye&&(X=ye))}else for(;++pe<Oe;)if((ye=Y(te[pe],pe,te))!=null&&ye>=ye)for(_e=X=ye;++pe<Oe;)(ye=Y(te[pe],pe,te))!=null&&(_e>ye&&(_e=ye),X<ye&&(X=ye));return[_e,X]}var fe=Array.prototype,Se=fe.slice,Re=fe.map,De=Math.sqrt(50),Ve=Math.sqrt(10),nt=Math.sqrt(2);function Ee(te,Y,Oe){var pe,ye=-1,_e,X,Le;if(Y=+Y,te=+te,Oe=+Oe,te===Y&&Oe>0)return[te];if((pe=Y<te)&&(_e=te,te=Y,Y=_e),(Le=Ie(te,Y,Oe))===0||!isFinite(Le))return[];if(Le>0)for(te=Math.ceil(te/Le),Y=Math.floor(Y/Le),X=new Array(_e=Math.ceil(Y-te+1));++ye<_e;)X[ye]=(te+ye)*Le;else for(te=Math.floor(te*Le),Y=Math.ceil(Y*Le),X=new Array(_e=Math.ceil(te-Y+1));++ye<_e;)X[ye]=(te-ye)/Le;return pe&&X.reverse(),X}function Ie(te,Y,Oe){var pe=(Y-te)/Math.max(0,Oe),ye=Math.floor(Math.log(pe)/Math.LN10),_e=pe/Math.pow(10,ye);return ye>=0?(_e>=De?10:_e>=Ve?5:_e>=nt?2:1)*Math.pow(10,ye):-Math.pow(10,-ye)/(_e>=De?10:_e>=Ve?5:_e>=nt?2:1)}function me(te,Y,Oe){var pe=Math.abs(Y-te)/Math.max(0,Oe),ye=Math.pow(10,Math.floor(Math.log(pe)/Math.LN10)),_e=pe/ye;return _e>=De?ye*=10:_e>=Ve?ye*=5:_e>=nt&&(ye*=2),Y<te?-ye:ye}function we(){var te=identity,Y=extent,Oe=sturges;function pe(ye){var _e,X=ye.length,Le,de=new Array(X);for(_e=0;_e<X;++_e)de[_e]=te(ye[_e],_e,ye);var be=Y(de),se=be[0],Ne=be[1],ze=Oe(de,se,Ne);Array.isArray(ze)||(ze=tickStep(se,Ne,ze),ze=range(Math.ceil(se/ze)*ze,Ne,ze));for(var ue=ze.length;ze[0]<=se;)ze.shift(),--ue;for(;ze[ue-1]>Ne;)ze.pop(),--ue;var kt=new Array(ue+1),Rt;for(_e=0;_e<=ue;++_e)Rt=kt[_e]=[],Rt.x0=_e>0?ze[_e-1]:se,Rt.x1=_e<ue?ze[_e]:Ne;for(_e=0;_e<X;++_e)Le=de[_e],se<=Le&&Le<=Ne&&kt[bisect(ze,Le,0,ue)].push(ye[_e]);return kt}return pe.value=function(ye){return arguments.length?(te=typeof ye=="function"?ye:constant(ye),pe):te},pe.domain=function(ye){return arguments.length?(Y=typeof ye=="function"?ye:constant([ye[0],ye[1]]),pe):Y},pe.thresholds=function(ye){return arguments.length?(Oe=typeof ye=="function"?ye:Array.isArray(ye)?constant(slice.call(ye)):constant(ye),pe):Oe},pe}function ne(te,Y,Oe){return te=map.call(te,number).sort(ascending),Math.ceil((Oe-Y)/(2*(quantile(te,.75)-quantile(te,.25))*Math.pow(te.length,-1/3)))}function Pe(te){for(var Y=te.length,Oe,pe=-1,ye=0,_e,X;++pe<Y;)ye+=te[pe].length;for(_e=new Array(ye);--Y>=0;)for(X=te[Y],Oe=X.length;--Oe>=0;)_e[--ye]=X[Oe];return _e}function he(te){return te===null?NaN:+te}function ve(te,Y,Oe){if(Oe==null&&(Oe=he),!!(pe=te.length)){if((Y=+Y)<=0||pe<2)return+Oe(te[0],0,te);if(Y>=1)return+Oe(te[pe-1],pe-1,te);var pe,ye=(pe-1)*Y,_e=Math.floor(ye),X=+Oe(te[_e],_e,te),Le=+Oe(te[_e+1],_e+1,te);return X+(Le-X)*(ye-_e)}}},10251:function(le,$,C){var L=C(82215),k=C(82584),G=C(20609),Z=C(98420),F=C(2847),z=C(18923),q=Date.prototype.getTime;function ee(De,Ve,nt){var Ee=nt||{};return(Ee.strict?G(De,Ve):De===Ve)?!0:!De||!Ve||typeof De!="object"&&typeof Ve!="object"?Ee.strict?G(De,Ve):De==Ve:Re(De,Ve,Ee)}function fe(De){return De==null}function Se(De){return!(!De||typeof De!="object"||typeof De.length!="number"||typeof De.copy!="function"||typeof De.slice!="function"||De.length>0&&typeof De[0]!="number")}function Re(De,Ve,nt){var Ee,Ie;if(typeof De!=typeof Ve||fe(De)||fe(Ve)||De.prototype!==Ve.prototype||k(De)!==k(Ve))return!1;var me=Z(De),we=Z(Ve);if(me!==we)return!1;if(me||we)return De.source===Ve.source&&F(De)===F(Ve);if(z(De)&&z(Ve))return q.call(De)===q.call(Ve);var ne=Se(De),Pe=Se(Ve);if(ne!==Pe)return!1;if(ne||Pe){if(De.length!==Ve.length)return!1;for(Ee=0;Ee<De.length;Ee++)if(De[Ee]!==Ve[Ee])return!1;return!0}if(typeof De!=typeof Ve)return!1;try{var he=L(De),ve=L(Ve)}catch(te){return!1}if(he.length!==ve.length)return!1;for(he.sort(),ve.sort(),Ee=he.length-1;Ee>=0;Ee--)if(he[Ee]!=ve[Ee])return!1;for(Ee=he.length-1;Ee>=0;Ee--)if(Ie=he[Ee],!ee(De[Ie],Ve[Ie],nt))return!1;return!0}le.exports=ee},12296:function(le,$,C){"use strict";var L=C(31044)(),k=C(40210),G=L&&k("%Object.defineProperty%",!0);if(G)try{G({},"a",{value:1})}catch(q){G=!1}var Z=k("%SyntaxError%"),F=k("%TypeError%"),z=C(25275);le.exports=function(ee,fe,Se){if(!ee||typeof ee!="object"&&typeof ee!="function")throw new F("`obj` must be an object or a function`");if(typeof fe!="string"&&typeof fe!="symbol")throw new F("`property` must be a string or a symbol`");if(arguments.length>3&&typeof arguments[3]!="boolean"&&arguments[3]!==null)throw new F("`nonEnumerable`, if provided, must be a boolean or null");if(arguments.length>4&&typeof arguments[4]!="boolean"&&arguments[4]!==null)throw new F("`nonWritable`, if provided, must be a boolean or null");if(arguments.length>5&&typeof arguments[5]!="boolean"&&arguments[5]!==null)throw new F("`nonConfigurable`, if provided, must be a boolean or null");if(arguments.length>6&&typeof arguments[6]!="boolean")throw new F("`loose`, if provided, must be a boolean");var Re=arguments.length>3?arguments[3]:null,De=arguments.length>4?arguments[4]:null,Ve=arguments.length>5?arguments[5]:null,nt=arguments.length>6?arguments[6]:!1,Ee=!!z&&z(ee,fe);if(G)G(ee,fe,{configurable:Ve===null&&Ee?Ee.configurable:!Ve,enumerable:Re===null&&Ee?Ee.enumerable:!Re,value:Se,writable:De===null&&Ee?Ee.writable:!De});else if(nt||!Re&&!De&&!Ve)ee[fe]=Se;else throw new Z("This environment does not support defining a property as non-configurable, non-writable, or non-enumerable.")}},4289:function(le,$,C){"use strict";var L=C(82215),k=typeof Symbol=="function"&&typeof Symbol("foo")=="symbol",G=Object.prototype.toString,Z=Array.prototype.concat,F=C(12296),z=function(Se){return typeof Se=="function"&&G.call(Se)==="[object Function]"},q=C(31044)(),ee=function(Se,Re,De,Ve){if(Re in Se){if(Ve===!0){if(Se[Re]===De)return}else if(!z(Ve)||!Ve())return}q?F(Se,Re,De,!0):F(Se,Re,De)},fe=function(Se,Re){var De=arguments.length>2?arguments[2]:{},Ve=L(Re);k&&(Ve=Z.call(Ve,Object.getOwnPropertySymbols(Re)));for(var nt=0;nt<Ve.length;nt+=1)ee(Se,Ve[nt],Re[Ve[nt]],De[Ve[nt]])};fe.supportsDescriptors=!!q,le.exports=fe},68317:function(le){function $(C,L,k,G){this.dataset=[],this.epsilon=1,this.minPts=2,this.distance=this._euclideanDistance,this.clusters=[],this.noise=[],this._visited=[],this._assigned=[],this._datasetLength=0,this._init(C,L,k,G)}$.prototype.run=function(C,L,k,G){this._init(C,L,k,G);for(var Z=0;Z<this._datasetLength;Z++)if(this._visited[Z]!==1){this._visited[Z]=1;var F=this._regionQuery(Z);if(F.length<this.minPts)this.noise.push(Z);else{var z=this.clusters.length;this.clusters.push([]),this._addToCluster(Z,z),this._expandCluster(z,F)}}return this.clusters},$.prototype._init=function(C,L,k,G){if(C){if(!(C instanceof Array))throw Error("Dataset must be of type array, "+typeof C+" given");this.dataset=C,this.clusters=[],this.noise=[],this._datasetLength=C.length,this._visited=new Array(this._datasetLength),this._assigned=new Array(this._datasetLength)}L&&(this.epsilon=L),k&&(this.minPts=k),G&&(this.distance=G)},$.prototype._expandCluster=function(C,L){for(var k=0;k<L.length;k++){var G=L[k];if(this._visited[G]!==1){this._visited[G]=1;var Z=this._regionQuery(G);Z.length>=this.minPts&&(L=this._mergeArrays(L,Z))}this._assigned[G]!==1&&this._addToCluster(G,C)}},$.prototype._addToCluster=function(C,L){this.clusters[L].push(C),this._assigned[C]=1},$.prototype._regionQuery=function(C){for(var L=[],k=0;k<this._datasetLength;k++){var G=this.distance(this.dataset[C],this.dataset[k]);G<this.epsilon&&L.push(k)}return L},$.prototype._mergeArrays=function(C,L){for(var k=L.length,G=0;G<k;G++){var Z=L[G];C.indexOf(Z)<0&&C.push(Z)}return C},$.prototype._euclideanDistance=function(C,L){for(var k=0,G=Math.min(C.length,L.length);G--;)k+=(C[G]-L[G])*(C[G]-L[G]);return Math.sqrt(k)},le.exports&&(le.exports=$)},63781:function(le){function $(C,L,k){this.k=3,this.dataset=[],this.assignments=[],this.centroids=[],this.init(C,L,k)}$.prototype.init=function(C,L,k){this.assignments=[],this.centroids=[],typeof C!="undefined"&&(this.dataset=C),typeof L!="undefined"&&(this.k=L),typeof k!="undefined"&&(this.distance=k)},$.prototype.run=function(C,L){this.init(C,L);for(var k=this.dataset.length,G=0;G<this.k;G++)this.centroids[G]=this.randomCentroid();for(var Z=!0;Z;){Z=this.assign();for(var F=0;F<this.k;F++){for(var z=new Array(Se),q=0,ee=0;ee<Se;ee++)z[ee]=0;for(var fe=0;fe<k;fe++){var Se=this.dataset[fe].length;if(F===this.assignments[fe]){for(var ee=0;ee<Se;ee++)z[ee]+=this.dataset[fe][ee];q++}}if(q>0){for(var ee=0;ee<Se;ee++)z[ee]/=q;this.centroids[F]=z}else this.centroids[F]=this.randomCentroid(),Z=!0}}return this.getClusters()},$.prototype.randomCentroid=function(){var C=this.dataset.length-1,L,k;do k=Math.round(Math.random()*C),L=this.dataset[k];while(this.centroids.indexOf(L)>=0);return L},$.prototype.assign=function(){for(var C=!1,L=this.dataset.length,k,G=0;G<L;G++)k=this.argmin(this.dataset[G],this.centroids,this.distance),k!=this.assignments[G]&&(this.assignments[G]=k,C=!0);return C},$.prototype.getClusters=function(){for(var C=new Array(this.k),L,k=0;k<this.assignments.length;k++)L=this.assignments[k],typeof C[L]=="undefined"&&(C[L]=[]),C[L].push(k);return C},$.prototype.argmin=function(C,L,k){for(var G=Number.MAX_VALUE,Z=0,F=L.length,z,q=0;q<F;q++)z=k(C,L[q]),z<G&&(G=z,Z=q);return Z},$.prototype.distance=function(C,L){for(var k=0,G=Math.min(C.length,L.length);G--;){var Z=C[G]-L[G];k+=Z*Z}return Math.sqrt(k)},le.exports&&(le.exports=$)},73763:function(le,$,C){if(le.exports)var L=C(57985);function k(G,Z,F,z){this.epsilon=1,this.minPts=1,this.distance=this._euclideanDistance,this._reachability=[],this._processed=[],this._coreDistance=0,this._orderedList=[],this._init(G,Z,F,z)}k.prototype.run=function(G,Z,F,z){this._init(G,Z,F,z);for(var q=0,ee=this.dataset.length;q<ee;q++)if(this._processed[q]!==1){this._processed[q]=1,this.clusters.push([q]);var fe=this.clusters.length-1;this._orderedList.push(q);var Se=new L(null,null,"asc"),Re=this._regionQuery(q);this._distanceToCore(q)!==void 0&&(this._updateQueue(q,Re,Se),this._expandCluster(fe,Se))}return this.clusters},k.prototype.getReachabilityPlot=function(){for(var G=[],Z=0,F=this._orderedList.length;Z<F;Z++){var z=this._orderedList[Z],q=this._reachability[z];G.push([z,q])}return G},k.prototype._init=function(G,Z,F,z){if(G){if(!(G instanceof Array))throw Error("Dataset must be of type array, "+typeof G+" given");this.dataset=G,this.clusters=[],this._reachability=new Array(this.dataset.length),this._processed=new Array(this.dataset.length),this._coreDistance=0,this._orderedList=[]}Z&&(this.epsilon=Z),F&&(this.minPts=F),z&&(this.distance=z)},k.prototype._updateQueue=function(G,Z,F){var z=this;this._coreDistance=this._distanceToCore(G),Z.forEach(function(q){if(z._processed[q]===void 0){var ee=z.distance(z.dataset[G],z.dataset[q]),fe=Math.max(z._coreDistance,ee);z._reachability[q]===void 0?(z._reachability[q]=fe,F.insert(q,fe)):fe<z._reachability[q]&&(z._reachability[q]=fe,F.remove(q),F.insert(q,fe))}})},k.prototype._expandCluster=function(G,Z){for(var F=Z.getElements(),z=0,q=F.length;z<q;z++){var ee=F[z];if(this._processed[ee]===void 0){var fe=this._regionQuery(ee);this._processed[ee]=1,this.clusters[G].push(ee),this._orderedList.push(ee),this._distanceToCore(ee)!==void 0&&(this._updateQueue(ee,fe,Z),this._expandCluster(G,Z))}}},k.prototype._distanceToCore=function(G){for(var Z=this.epsilon,F=0;F<Z;F++){var z=this._regionQuery(G,F);if(z.length>=this.minPts)return F}},k.prototype._regionQuery=function(G,Z){Z=Z||this.epsilon;for(var F=[],z=0,q=this.dataset.length;z<q;z++)this.distance(this.dataset[G],this.dataset[z])<Z&&F.push(z);return F},k.prototype._euclideanDistance=function(G,Z){for(var F=0,z=Math.min(G.length,Z.length);z--;)F+=(G[z]-Z[z])*(G[z]-Z[z]);return Math.sqrt(F)},le.exports&&(le.exports=k)},57985:function(le){function $(C,L,k){this._queue=[],this._priorities=[],this._sorting="desc",this._init(C,L,k)}$.prototype.insert=function(C,L){for(var k=this._queue.length,G=k;G--;){var Z=this._priorities[G];this._sorting==="desc"?L>Z&&(k=G):L<Z&&(k=G)}this._insertAt(C,L,k)},$.prototype.remove=function(C){for(var L=this._queue.length;L--;){var k=this._queue[L];if(C===k){this._queue.splice(L,1),this._priorities.splice(L,1);break}}},$.prototype.forEach=function(C){this._queue.forEach(C)},$.prototype.getElements=function(){return this._queue},$.prototype.getElementPriority=function(C){return this._priorities[C]},$.prototype.getPriorities=function(){return this._priorities},$.prototype.getElementsWithPriorities=function(){for(var C=[],L=0,k=this._queue.length;L<k;L++)C.push([this._queue[L],this._priorities[L]]);return C},$.prototype._init=function(C,L,k){if(C&&L){if(this._queue=[],this._priorities=[],C.length!==L.length)throw new Error("Arrays must have the same length");for(var G=0;G<C.length;G++)this.insert(C[G],L[G])}k&&(this._sorting=k)},$.prototype._insertAt=function(C,L,k){this._queue.length===k?(this._queue.push(C),this._priorities.push(L)):(this._queue.splice(k,0,C),this._priorities.splice(k,0,L))},le.exports&&(le.exports=$)},52606:function(le,$,C){le.exports&&(le.exports={DBSCAN:C(68317),KMEANS:C(63781),OPTICS:C(73763),PriorityQueue:C(57985)})},9187:function(le){"use strict";le.exports=$,le.exports.default=$;function $(de,be,se){se=se||2;var Ne=be&&be.length,ze=Ne?be[0]*se:de.length,ue=C(de,0,ze,se,!0),kt=[];if(!ue||ue.next===ue.prev)return kt;var Rt,cr,Ut,$r,ln,Cr,Qr;if(Ne&&(ue=q(de,be,ue,se)),de.length>80*se){Rt=Ut=de[0],cr=$r=de[1];for(var Jr=se;Jr<ze;Jr+=se)ln=de[Jr],Cr=de[Jr+1],ln<Rt&&(Rt=ln),Cr<cr&&(cr=Cr),ln>Ut&&(Ut=ln),Cr>$r&&($r=Cr);Qr=Math.max(Ut-Rt,$r-cr),Qr=Qr!==0?32767/Qr:0}return k(ue,kt,se,Rt,cr,Qr,0),kt}function C(de,be,se,Ne,ze){var ue,kt;if(ze===Le(de,be,se,Ne)>0)for(ue=be;ue<se;ue+=Ne)kt=ye(ue,de[ue],de[ue+1],kt);else for(ue=se-Ne;ue>=be;ue-=Ne)kt=ye(ue,de[ue],de[ue+1],kt);return kt&&ne(kt,kt.next)&&(_e(kt),kt=kt.next),kt}function L(de,be){if(!de)return de;be||(be=de);var se=de,Ne;do if(Ne=!1,!se.steiner&&(ne(se,se.next)||we(se.prev,se,se.next)===0)){if(_e(se),se=be=se.prev,se===se.next)break;Ne=!0}else se=se.next;while(Ne||se!==be);return be}function k(de,be,se,Ne,ze,ue,kt){if(de){!kt&&ue&&De(de,Ne,ze,ue);for(var Rt=de,cr,Ut;de.prev!==de.next;){if(cr=de.prev,Ut=de.next,ue?Z(de,Ne,ze,ue):G(de)){be.push(cr.i/se|0),be.push(de.i/se|0),be.push(Ut.i/se|0),_e(de),de=Ut.next,Rt=Ut.next;continue}if(de=Ut,de===Rt){kt?kt===1?(de=F(L(de),be,se),k(de,be,se,Ne,ze,ue,2)):kt===2&&z(de,be,se,Ne,ze,ue):k(L(de),be,se,Ne,ze,ue,1);break}}}}function G(de){var be=de.prev,se=de,Ne=de.next;if(we(be,se,Ne)>=0)return!1;for(var ze=be.x,ue=se.x,kt=Ne.x,Rt=be.y,cr=se.y,Ut=Ne.y,$r=ze<ue?ze<kt?ze:kt:ue<kt?ue:kt,ln=Rt<cr?Rt<Ut?Rt:Ut:cr<Ut?cr:Ut,Cr=ze>ue?ze>kt?ze:kt:ue>kt?ue:kt,Qr=Rt>cr?Rt>Ut?Rt:Ut:cr>Ut?cr:Ut,Jr=Ne.next;Jr!==be;){if(Jr.x>=$r&&Jr.x<=Cr&&Jr.y>=ln&&Jr.y<=Qr&&Ie(ze,Rt,ue,cr,kt,Ut,Jr.x,Jr.y)&&we(Jr.prev,Jr,Jr.next)>=0)return!1;Jr=Jr.next}return!0}function Z(de,be,se,Ne){var ze=de.prev,ue=de,kt=de.next;if(we(ze,ue,kt)>=0)return!1;for(var Rt=ze.x,cr=ue.x,Ut=kt.x,$r=ze.y,ln=ue.y,Cr=kt.y,Qr=Rt<cr?Rt<Ut?Rt:Ut:cr<Ut?cr:Ut,Jr=$r<ln?$r<Cr?$r:Cr:ln<Cr?ln:Cr,xr=Rt>cr?Rt>Ut?Rt:Ut:cr>Ut?cr:Ut,Gn=$r>ln?$r>Cr?$r:Cr:ln>Cr?ln:Cr,ti=nt(Qr,Jr,be,se,Ne),Vn=nt(xr,Gn,be,se,Ne),Xr=de.prevZ,sn=de.nextZ;Xr&&Xr.z>=ti&&sn&&sn.z<=Vn;){if(Xr.x>=Qr&&Xr.x<=xr&&Xr.y>=Jr&&Xr.y<=Gn&&Xr!==ze&&Xr!==kt&&Ie(Rt,$r,cr,ln,Ut,Cr,Xr.x,Xr.y)&&we(Xr.prev,Xr,Xr.next)>=0||(Xr=Xr.prevZ,sn.x>=Qr&&sn.x<=xr&&sn.y>=Jr&&sn.y<=Gn&&sn!==ze&&sn!==kt&&Ie(Rt,$r,cr,ln,Ut,Cr,sn.x,sn.y)&&we(sn.prev,sn,sn.next)>=0))return!1;sn=sn.nextZ}for(;Xr&&Xr.z>=ti;){if(Xr.x>=Qr&&Xr.x<=xr&&Xr.y>=Jr&&Xr.y<=Gn&&Xr!==ze&&Xr!==kt&&Ie(Rt,$r,cr,ln,Ut,Cr,Xr.x,Xr.y)&&we(Xr.prev,Xr,Xr.next)>=0)return!1;Xr=Xr.prevZ}for(;sn&&sn.z<=Vn;){if(sn.x>=Qr&&sn.x<=xr&&sn.y>=Jr&&sn.y<=Gn&&sn!==ze&&sn!==kt&&Ie(Rt,$r,cr,ln,Ut,Cr,sn.x,sn.y)&&we(sn.prev,sn,sn.next)>=0)return!1;sn=sn.nextZ}return!0}function F(de,be,se){var Ne=de;do{var ze=Ne.prev,ue=Ne.next.next;!ne(ze,ue)&&Pe(ze,Ne,Ne.next,ue)&&Y(ze,ue)&&Y(ue,ze)&&(be.push(ze.i/se|0),be.push(Ne.i/se|0),be.push(ue.i/se|0),_e(Ne),_e(Ne.next),Ne=de=ue),Ne=Ne.next}while(Ne!==de);return L(Ne)}function z(de,be,se,Ne,ze,ue){var kt=de;do{for(var Rt=kt.next.next;Rt!==kt.prev;){if(kt.i!==Rt.i&&me(kt,Rt)){var cr=pe(kt,Rt);kt=L(kt,kt.next),cr=L(cr,cr.next),k(kt,be,se,Ne,ze,ue,0),k(cr,be,se,Ne,ze,ue,0);return}Rt=Rt.next}kt=kt.next}while(kt!==de)}function q(de,be,se,Ne){var ze=[],ue,kt,Rt,cr,Ut;for(ue=0,kt=be.length;ue<kt;ue++)Rt=be[ue]*Ne,cr=ue<kt-1?be[ue+1]*Ne:de.length,Ut=C(de,Rt,cr,Ne,!1),Ut===Ut.next&&(Ut.steiner=!0),ze.push(Ee(Ut));for(ze.sort(ee),ue=0;ue<ze.length;ue++)se=fe(ze[ue],se);return se}function ee(de,be){return de.x-be.x}function fe(de,be){var se=Se(de,be);if(!se)return be;var Ne=pe(se,de);return L(Ne,Ne.next),L(se,se.next)}function Se(de,be){var se=be,Ne=de.x,ze=de.y,ue=-1/0,kt;do{if(ze<=se.y&&ze>=se.next.y&&se.next.y!==se.y){var Rt=se.x+(ze-se.y)*(se.next.x-se.x)/(se.next.y-se.y);if(Rt<=Ne&&Rt>ue&&(ue=Rt,kt=se.x<se.next.x?se:se.next,Rt===Ne))return kt}se=se.next}while(se!==be);if(!kt)return null;var cr=kt,Ut=kt.x,$r=kt.y,ln=1/0,Cr;se=kt;do Ne>=se.x&&se.x>=Ut&&Ne!==se.x&&Ie(ze<$r?Ne:ue,ze,Ut,$r,ze<$r?ue:Ne,ze,se.x,se.y)&&(Cr=Math.abs(ze-se.y)/(Ne-se.x),Y(se,de)&&(Cr<ln||Cr===ln&&(se.x>kt.x||se.x===kt.x&&Re(kt,se)))&&(kt=se,ln=Cr)),se=se.next;while(se!==cr);return kt}function Re(de,be){return we(de.prev,de,be.prev)<0&&we(be.next,de,de.next)<0}function De(de,be,se,Ne){var ze=de;do ze.z===0&&(ze.z=nt(ze.x,ze.y,be,se,Ne)),ze.prevZ=ze.prev,ze.nextZ=ze.next,ze=ze.next;while(ze!==de);ze.prevZ.nextZ=null,ze.prevZ=null,Ve(ze)}function Ve(de){var be,se,Ne,ze,ue,kt,Rt,cr,Ut=1;do{for(se=de,de=null,ue=null,kt=0;se;){for(kt++,Ne=se,Rt=0,be=0;be<Ut&&(Rt++,Ne=Ne.nextZ,!!Ne);be++);for(cr=Ut;Rt>0||cr>0&&Ne;)Rt!==0&&(cr===0||!Ne||se.z<=Ne.z)?(ze=se,se=se.nextZ,Rt--):(ze=Ne,Ne=Ne.nextZ,cr--),ue?ue.nextZ=ze:de=ze,ze.prevZ=ue,ue=ze;se=Ne}ue.nextZ=null,Ut*=2}while(kt>1);return de}function nt(de,be,se,Ne,ze){return de=(de-se)*ze|0,be=(be-Ne)*ze|0,de=(de|de<<8)&16711935,de=(de|de<<4)&252645135,de=(de|de<<2)&858993459,de=(de|de<<1)&1431655765,be=(be|be<<8)&16711935,be=(be|be<<4)&252645135,be=(be|be<<2)&858993459,be=(be|be<<1)&1431655765,de|be<<1}function Ee(de){var be=de,se=de;do(be.x<se.x||be.x===se.x&&be.y<se.y)&&(se=be),be=be.next;while(be!==de);return se}function Ie(de,be,se,Ne,ze,ue,kt,Rt){return(ze-kt)*(be-Rt)>=(de-kt)*(ue-Rt)&&(de-kt)*(Ne-Rt)>=(se-kt)*(be-Rt)&&(se-kt)*(ue-Rt)>=(ze-kt)*(Ne-Rt)}function me(de,be){return de.next.i!==be.i&&de.prev.i!==be.i&&!te(de,be)&&(Y(de,be)&&Y(be,de)&&Oe(de,be)&&(we(de.prev,de,be.prev)||we(de,be.prev,be))||ne(de,be)&&we(de.prev,de,de.next)>0&&we(be.prev,be,be.next)>0)}function we(de,be,se){return(be.y-de.y)*(se.x-be.x)-(be.x-de.x)*(se.y-be.y)}function ne(de,be){return de.x===be.x&&de.y===be.y}function Pe(de,be,se,Ne){var ze=ve(we(de,be,se)),ue=ve(we(de,be,Ne)),kt=ve(we(se,Ne,de)),Rt=ve(we(se,Ne,be));return!!(ze!==ue&&kt!==Rt||ze===0&&he(de,se,be)||ue===0&&he(de,Ne,be)||kt===0&&he(se,de,Ne)||Rt===0&&he(se,be,Ne))}function he(de,be,se){return be.x<=Math.max(de.x,se.x)&&be.x>=Math.min(de.x,se.x)&&be.y<=Math.max(de.y,se.y)&&be.y>=Math.min(de.y,se.y)}function ve(de){return de>0?1:de<0?-1:0}function te(de,be){var se=de;do{if(se.i!==de.i&&se.next.i!==de.i&&se.i!==be.i&&se.next.i!==be.i&&Pe(se,se.next,de,be))return!0;se=se.next}while(se!==de);return!1}function Y(de,be){return we(de.prev,de,de.next)<0?we(de,be,de.next)>=0&&we(de,de.prev,be)>=0:we(de,be,de.prev)<0||we(de,de.next,be)<0}function Oe(de,be){var se=de,Ne=!1,ze=(de.x+be.x)/2,ue=(de.y+be.y)/2;do se.y>ue!=se.next.y>ue&&se.next.y!==se.y&&ze<(se.next.x-se.x)*(ue-se.y)/(se.next.y-se.y)+se.x&&(Ne=!Ne),se=se.next;while(se!==de);return Ne}function pe(de,be){var se=new X(de.i,de.x,de.y),Ne=new X(be.i,be.x,be.y),ze=de.next,ue=be.prev;return de.next=be,be.prev=de,se.next=ze,ze.prev=se,Ne.next=se,se.prev=Ne,ue.next=Ne,Ne.prev=ue,Ne}function ye(de,be,se,Ne){var ze=new X(de,be,se);return Ne?(ze.next=Ne.next,ze.prev=Ne,Ne.next.prev=ze,Ne.next=ze):(ze.prev=ze,ze.next=ze),ze}function _e(de){de.next.prev=de.prev,de.prev.next=de.next,de.prevZ&&(de.prevZ.nextZ=de.nextZ),de.nextZ&&(de.nextZ.prevZ=de.prevZ)}function X(de,be,se){this.i=de,this.x=be,this.y=se,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}$.deviation=function(de,be,se,Ne){var ze=be&&be.length,ue=ze?be[0]*se:de.length,kt=Math.abs(Le(de,0,ue,se));if(ze)for(var Rt=0,cr=be.length;Rt<cr;Rt++){var Ut=be[Rt]*se,$r=Rt<cr-1?be[Rt+1]*se:de.length;kt-=Math.abs(Le(de,Ut,$r,se))}var ln=0;for(Rt=0;Rt<Ne.length;Rt+=3){var Cr=Ne[Rt]*se,Qr=Ne[Rt+1]*se,Jr=Ne[Rt+2]*se;ln+=Math.abs((de[Cr]-de[Jr])*(de[Qr+1]-de[Cr+1])-(de[Cr]-de[Qr])*(de[Jr+1]-de[Cr+1]))}return kt===0&&ln===0?0:Math.abs((ln-kt)/kt)};function Le(de,be,se,Ne){for(var ze=0,ue=be,kt=se-Ne;ue<se;ue+=Ne)ze+=(de[kt]-de[ue])*(de[ue+1]+de[kt+1]),kt=ue;return ze}$.flatten=function(de){for(var be=de[0][0].length,se={vertices:[],holes:[],dimensions:be},Ne=0,ze=0;ze<de.length;ze++){for(var ue=0;ue<de[ze].length;ue++)for(var kt=0;kt<be;kt++)se.vertices.push(de[ze][ue][kt]);ze>0&&(Ne+=de[ze-1].length,se.holes.push(Ne))}return se}},67709:function(le){function $(L){var k=L.target||L.srcElement;k.__resizeRAF__&&cancelAnimationFrame(k.__resizeRAF__),k.__resizeRAF__=requestAnimationFrame(function(){var G=k.__resizeTrigger__,Z=G&&G.__resizeListeners__;Z&&Z.forEach(function(F){F.call(G,L)})})}var C=function(k,G){var Z=this,F=Z.document,z,q=F.attachEvent;typeof navigator!="undefined"&&(z=navigator.userAgent.match(/Trident/)||navigator.userAgent.match(/Edge/));function ee(){this.contentDocument.defaultView.__resizeTrigger__=this.__resizeElement__,this.contentDocument.defaultView.addEventListener("resize",$)}if(!k.__resizeListeners__)if(k.__resizeListeners__=[],q)k.__resizeTrigger__=k,k.attachEvent("onresize",$);else{getComputedStyle(k).position==="static"&&(k.style.position="relative");var fe=k.__resizeTrigger__=F.createElement("object");fe.setAttribute("style","position: absolute; top: 0; left: 0; height: 100%; width: 100%; pointer-events: none; z-index: -1; opacity: 0;"),fe.setAttribute("class","resize-sensor"),fe.setAttribute("tabindex","-1"),fe.setAttribute("title",""),fe.__resizeElement__=k,fe.onload=ee,fe.type="text/html",z&&k.appendChild(fe),fe.data="about:blank",z||k.appendChild(fe)}k.__resizeListeners__.push(G)};le.exports=typeof window=="undefined"?C:C.bind(window),le.exports.unbind=function(L,k){var G=document.attachEvent,Z=L.__resizeListeners__||[];if(k){var F=Z.indexOf(k);F!==-1&&Z.splice(F,1)}else Z=L.__resizeListeners__=[];if(!Z.length){if(G)L.detachEvent("onresize",$);else if(L.__resizeTrigger__){var z=L.__resizeTrigger__.contentDocument,q=z&&z.defaultView;q&&(q.removeEventListener("resize",$),delete q.__resizeTrigger__),L.__resizeTrigger__=!L.removeChild(L.__resizeTrigger__)}delete L.__resizeListeners__}}},26729:function(le){"use strict";var $=Object.prototype.hasOwnProperty,C="~";function L(){}Object.create&&(L.prototype=Object.create(null),new L().__proto__||(C=!1));function k(z,q,ee){this.fn=z,this.context=q,this.once=ee||!1}function G(z,q,ee,fe,Se){if(typeof ee!="function")throw new TypeError("The listener must be a function");var Re=new k(ee,fe||z,Se),De=C?C+q:q;return z._events[De]?z._events[De].fn?z._events[De]=[z._events[De],Re]:z._events[De].push(Re):(z._events[De]=Re,z._eventsCount++),z}function Z(z,q){--z._eventsCount===0?z._events=new L:delete z._events[q]}function F(){this._events=new L,this._eventsCount=0}F.prototype.eventNames=function(){var q=[],ee,fe;if(this._eventsCount===0)return q;for(fe in ee=this._events)$.call(ee,fe)&&q.push(C?fe.slice(1):fe);return Object.getOwnPropertySymbols?q.concat(Object.getOwnPropertySymbols(ee)):q},F.prototype.listeners=function(q){var ee=C?C+q:q,fe=this._events[ee];if(!fe)return[];if(fe.fn)return[fe.fn];for(var Se=0,Re=fe.length,De=new Array(Re);Se<Re;Se++)De[Se]=fe[Se].fn;return De},F.prototype.listenerCount=function(q){var ee=C?C+q:q,fe=this._events[ee];return fe?fe.fn?1:fe.length:0},F.prototype.emit=function(q,ee,fe,Se,Re,De){var Ve=C?C+q:q;if(!this._events[Ve])return!1;var nt=this._events[Ve],Ee=arguments.length,Ie,me;if(nt.fn){switch(nt.once&&this.removeListener(q,nt.fn,void 0,!0),Ee){case 1:return nt.fn.call(nt.context),!0;case 2:return nt.fn.call(nt.context,ee),!0;case 3:return nt.fn.call(nt.context,ee,fe),!0;case 4:return nt.fn.call(nt.context,ee,fe,Se),!0;case 5:return nt.fn.call(nt.context,ee,fe,Se,Re),!0;case 6:return nt.fn.call(nt.context,ee,fe,Se,Re,De),!0}for(me=1,Ie=new Array(Ee-1);me<Ee;me++)Ie[me-1]=arguments[me];nt.fn.apply(nt.context,Ie)}else{var we=nt.length,ne;for(me=0;me<we;me++)switch(nt[me].once&&this.removeListener(q,nt[me].fn,void 0,!0),Ee){case 1:nt[me].fn.call(nt[me].context);break;case 2:nt[me].fn.call(nt[me].context,ee);break;case 3:nt[me].fn.call(nt[me].context,ee,fe);break;case 4:nt[me].fn.call(nt[me].context,ee,fe,Se);break;default:if(!Ie)for(ne=1,Ie=new Array(Ee-1);ne<Ee;ne++)Ie[ne-1]=arguments[ne];nt[me].fn.apply(nt[me].context,Ie)}}return!0},F.prototype.on=function(q,ee,fe){return G(this,q,ee,fe,!1)},F.prototype.once=function(q,ee,fe){return G(this,q,ee,fe,!0)},F.prototype.removeListener=function(q,ee,fe,Se){var Re=C?C+q:q;if(!this._events[Re])return this;if(!ee)return Z(this,Re),this;var De=this._events[Re];if(De.fn)De.fn===ee&&(!Se||De.once)&&(!fe||De.context===fe)&&Z(this,Re);else{for(var Ve=0,nt=[],Ee=De.length;Ve<Ee;Ve++)(De[Ve].fn!==ee||Se&&!De[Ve].once||fe&&De[Ve].context!==fe)&&nt.push(De[Ve]);nt.length?this._events[Re]=nt.length===1?nt[0]:nt:Z(this,Re)}return this},F.prototype.removeAllListeners=function(q){var ee;return q?(ee=C?C+q:q,this._events[ee]&&Z(this,ee)):(this._events=new L,this._eventsCount=0),this},F.prototype.off=F.prototype.removeListener,F.prototype.addListener=F.prototype.on,F.prefixed=C,F.EventEmitter=F,le.exports=F},17648:function(le){"use strict";var $="Function.prototype.bind called on incompatible ",C=Object.prototype.toString,L=Math.max,k="[object Function]",G=function(q,ee){for(var fe=[],Se=0;Se<q.length;Se+=1)fe[Se]=q[Se];for(var Re=0;Re<ee.length;Re+=1)fe[Re+q.length]=ee[Re];return fe},Z=function(q,ee){for(var fe=[],Se=ee||0,Re=0;Se<q.length;Se+=1,Re+=1)fe[Re]=q[Se];return fe},F=function(z,q){for(var ee="",fe=0;fe<z.length;fe+=1)ee+=z[fe],fe+1<z.length&&(ee+=q);return ee};le.exports=function(q){var ee=this;if(typeof ee!="function"||C.apply(ee)!==k)throw new TypeError($+ee);for(var fe=Z(arguments,1),Se,Re=function(){if(this instanceof Se){var Ie=ee.apply(this,G(fe,arguments));return Object(Ie)===Ie?Ie:this}return ee.apply(q,G(fe,arguments))},De=L(0,ee.length-fe.length),Ve=[],nt=0;nt<De;nt++)Ve[nt]="$"+nt;if(Se=Function("binder","return function ("+F(Ve,",")+"){ return binder.apply(this,arguments); }")(Re),ee.prototype){var Ee=function(){};Ee.prototype=ee.prototype,Se.prototype=new Ee,Ee.prototype=null}return Se}},58612:function(le,$,C){"use strict";var L=C(17648);le.exports=Function.prototype.bind||L},25972:function(le){"use strict";var $=function(){return typeof function(){}.name=="string"},C=Object.getOwnPropertyDescriptor;if(C)try{C([],"length")}catch(k){C=null}$.functionsHaveConfigurableNames=function(){if(!$()||!C)return!1;var G=C(function(){},"name");return!!G&&!!G.configurable};var L=Function.prototype.bind;$.boundFunctionsHaveNames=function(){return $()&&typeof L=="function"&&function(){}.bind().name!==""},le.exports=$},29657:function(le,$,C){var L=C(10251),k=function(z){this.precision=z&&z.precision?z.precision:17,this.direction=z&&z.direction?z.direction:!1,this.pseudoNode=z&&z.pseudoNode?z.pseudoNode:!1,this.objectComparator=z&&z.objectComparator?z.objectComparator:F};k.prototype.compare=function(z,q){if(z.type!==q.type||!Z(z,q))return!1;switch(z.type){case"Point":return this.compareCoord(z.coordinates,q.coordinates);case"LineString":return this.compareLine(z.coordinates,q.coordinates,0,!1);case"Polygon":return this.comparePolygon(z,q);case"Feature":return this.compareFeature(z,q);default:if(z.type.indexOf("Multi")===0){var ee=this,fe=G(z),Se=G(q);return fe.every(function(Re){return this.some(function(De){return ee.compare(Re,De)})},Se)}}return!1};function G(z){return z.coordinates.map(function(q){return{type:z.type.replace("Multi",""),coordinates:q}})}function Z(z,q){return z.hasOwnProperty("coordinates")?z.coordinates.length===q.coordinates.length:z.length===q.length}k.prototype.compareCoord=function(z,q){if(z.length!==q.length)return!1;for(var ee=0;ee<z.length;ee++)if(z[ee].toFixed(this.precision)!==q[ee].toFixed(this.precision))return!1;return!0},k.prototype.compareLine=function(z,q,ee,fe){if(!Z(z,q))return!1;var Se=this.pseudoNode?z:this.removePseudo(z),Re=this.pseudoNode?q:this.removePseudo(q);if(!(fe&&!this.compareCoord(Se[0],Re[0])&&(Re=this.fixStartIndex(Re,Se),!Re))){var De=this.compareCoord(Se[ee],Re[ee]);return this.direction||De?this.comparePath(Se,Re):this.compareCoord(Se[ee],Re[Re.length-(1+ee)])?this.comparePath(Se.slice().reverse(),Re):!1}},k.prototype.fixStartIndex=function(z,q){for(var ee,fe=-1,Se=0;Se<z.length;Se++)if(this.compareCoord(z[Se],q[0])){fe=Se;break}return fe>=0&&(ee=[].concat(z.slice(fe,z.length),z.slice(1,fe+1))),ee},k.prototype.comparePath=function(z,q){var ee=this;return z.every(function(fe,Se){return ee.compareCoord(fe,this[Se])},q)},k.prototype.comparePolygon=function(z,q){if(this.compareLine(z.coordinates[0],q.coordinates[0],1,!0)){var ee=z.coordinates.slice(1,z.coordinates.length),fe=q.coordinates.slice(1,q.coordinates.length),Se=this;return ee.every(function(Re){return this.some(function(De){return Se.compareLine(Re,De,1,!0)})},fe)}else return!1},k.prototype.compareFeature=function(z,q){return z.id!==q.id||!this.objectComparator(z.properties,q.properties)||!this.compareBBox(z,q)?!1:this.compare(z.geometry,q.geometry)},k.prototype.compareBBox=function(z,q){return!!(!z.bbox&&!q.bbox||z.bbox&&q.bbox&&this.compareCoord(z.bbox,q.bbox))},k.prototype.removePseudo=function(z){return z};function F(z,q){return L(z,q,{strict:!0})}le.exports=k},51787:function(le,$,C){var L=C(24056),k=C(84102),G=C(31540),Z=C(9705).Z,F=G.featureEach,z=G.coordEach,q=k.polygon,ee=k.featureCollection;function fe(Se){var Re=new L(Se);return Re.insert=function(De){if(De.type!=="Feature")throw new Error("invalid feature");return De.bbox=De.bbox?De.bbox:Z(De),L.prototype.insert.call(this,De)},Re.load=function(De){var Ve=[];return Array.isArray(De)?De.forEach(function(nt){if(nt.type!=="Feature")throw new Error("invalid features");nt.bbox=nt.bbox?nt.bbox:Z(nt),Ve.push(nt)}):F(De,function(nt){if(nt.type!=="Feature")throw new Error("invalid features");nt.bbox=nt.bbox?nt.bbox:Z(nt),Ve.push(nt)}),L.prototype.load.call(this,Ve)},Re.remove=function(De,Ve){if(De.type!=="Feature")throw new Error("invalid feature");return De.bbox=De.bbox?De.bbox:Z(De),L.prototype.remove.call(this,De,Ve)},Re.clear=function(){return L.prototype.clear.call(this)},Re.search=function(De){var Ve=L.prototype.search.call(this,this.toBBox(De));return ee(Ve)},Re.collides=function(De){return L.prototype.collides.call(this,this.toBBox(De))},Re.all=function(){var De=L.prototype.all.call(this);return ee(De)},Re.toJSON=function(){return L.prototype.toJSON.call(this)},Re.fromJSON=function(De){return L.prototype.fromJSON.call(this,De)},Re.toBBox=function(De){var Ve;if(De.bbox)Ve=De.bbox;else if(Array.isArray(De)&&De.length===4)Ve=De;else if(Array.isArray(De)&&De.length===6)Ve=[De[0],De[1],De[3],De[4]];else if(De.type==="Feature")Ve=Z(De);else if(De.type==="FeatureCollection")Ve=Z(De);else throw new Error("invalid geojson");return{minX:Ve[0],minY:Ve[1],maxX:Ve[2],maxY:Ve[3]}},Re}le.exports=fe,le.exports.default=fe},24056:function(le){(function($,C){le.exports=C()})(this,function(){"use strict";function $(Ee,Ie,me,we,ne){(function Pe(he,ve,te,Y,Oe){for(;Y>te;){if(Y-te>600){var pe=Y-te+1,ye=ve-te+1,_e=Math.log(pe),X=.5*Math.exp(2*_e/3),Le=.5*Math.sqrt(_e*X*(pe-X)/pe)*(ye-pe/2<0?-1:1),de=Math.max(te,Math.floor(ve-ye*X/pe+Le)),be=Math.min(Y,Math.floor(ve+(pe-ye)*X/pe+Le));Pe(he,ve,de,be,Oe)}var se=he[ve],Ne=te,ze=Y;for(C(he,te,ve),Oe(he[Y],se)>0&&C(he,te,Y);Ne<ze;){for(C(he,Ne,ze),Ne++,ze--;Oe(he[Ne],se)<0;)Ne++;for(;Oe(he[ze],se)>0;)ze--}Oe(he[te],se)===0?C(he,te,ze):C(he,++ze,Y),ze<=ve&&(te=ze+1),ve<=ze&&(Y=ze-1)}})(Ee,Ie,me||0,we||Ee.length-1,ne||L)}function C(Ee,Ie,me){var we=Ee[Ie];Ee[Ie]=Ee[me],Ee[me]=we}function L(Ee,Ie){return Ee<Ie?-1:Ee>Ie?1:0}var k=function(Ee){Ee===void 0&&(Ee=9),this._maxEntries=Math.max(4,Ee),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),this.clear()};function G(Ee,Ie,me){if(!me)return Ie.indexOf(Ee);for(var we=0;we<Ie.length;we++)if(me(Ee,Ie[we]))return we;return-1}function Z(Ee,Ie){F(Ee,0,Ee.children.length,Ie,Ee)}function F(Ee,Ie,me,we,ne){ne||(ne=Ve(null)),ne.minX=1/0,ne.minY=1/0,ne.maxX=-1/0,ne.maxY=-1/0;for(var Pe=Ie;Pe<me;Pe++){var he=Ee.children[Pe];z(ne,Ee.leaf?we(he):he)}return ne}function z(Ee,Ie){return Ee.minX=Math.min(Ee.minX,Ie.minX),Ee.minY=Math.min(Ee.minY,Ie.minY),Ee.maxX=Math.max(Ee.maxX,Ie.maxX),Ee.maxY=Math.max(Ee.maxY,Ie.maxY),Ee}function q(Ee,Ie){return Ee.minX-Ie.minX}function ee(Ee,Ie){return Ee.minY-Ie.minY}function fe(Ee){return(Ee.maxX-Ee.minX)*(Ee.maxY-Ee.minY)}function Se(Ee){return Ee.maxX-Ee.minX+(Ee.maxY-Ee.minY)}function Re(Ee,Ie){return Ee.minX<=Ie.minX&&Ee.minY<=Ie.minY&&Ie.maxX<=Ee.maxX&&Ie.maxY<=Ee.maxY}function De(Ee,Ie){return Ie.minX<=Ee.maxX&&Ie.minY<=Ee.maxY&&Ie.maxX>=Ee.minX&&Ie.maxY>=Ee.minY}function Ve(Ee){return{children:Ee,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function nt(Ee,Ie,me,we,ne){for(var Pe=[Ie,me];Pe.length;)if(!((me=Pe.pop())-(Ie=Pe.pop())<=we)){var he=Ie+Math.ceil((me-Ie)/we/2)*we;$(Ee,he,Ie,me,ne),Pe.push(Ie,he,he,me)}}return k.prototype.all=function(){return this._all(this.data,[])},k.prototype.search=function(Ee){var Ie=this.data,me=[];if(!De(Ee,Ie))return me;for(var we=this.toBBox,ne=[];Ie;){for(var Pe=0;Pe<Ie.children.length;Pe++){var he=Ie.children[Pe],ve=Ie.leaf?we(he):he;De(Ee,ve)&&(Ie.leaf?me.push(he):Re(Ee,ve)?this._all(he,me):ne.push(he))}Ie=ne.pop()}return me},k.prototype.collides=function(Ee){var Ie=this.data;if(!De(Ee,Ie))return!1;for(var me=[];Ie;){for(var we=0;we<Ie.children.length;we++){var ne=Ie.children[we],Pe=Ie.leaf?this.toBBox(ne):ne;if(De(Ee,Pe)){if(Ie.leaf||Re(Ee,Pe))return!0;me.push(ne)}}Ie=me.pop()}return!1},k.prototype.load=function(Ee){if(!Ee||!Ee.length)return this;if(Ee.length<this._minEntries){for(var Ie=0;Ie<Ee.length;Ie++)this.insert(Ee[Ie]);return this}var me=this._build(Ee.slice(),0,Ee.length-1,0);if(this.data.children.length)if(this.data.height===me.height)this._splitRoot(this.data,me);else{if(this.data.height<me.height){var we=this.data;this.data=me,me=we}this._insert(me,this.data.height-me.height-1,!0)}else this.data=me;return this},k.prototype.insert=function(Ee){return Ee&&this._insert(Ee,this.data.height-1),this},k.prototype.clear=function(){return this.data=Ve([]),this},k.prototype.remove=function(Ee,Ie){if(!Ee)return this;for(var me,we,ne,Pe=this.data,he=this.toBBox(Ee),ve=[],te=[];Pe||ve.length;){if(Pe||(Pe=ve.pop(),we=ve[ve.length-1],me=te.pop(),ne=!0),Pe.leaf){var Y=G(Ee,Pe.children,Ie);if(Y!==-1)return Pe.children.splice(Y,1),ve.push(Pe),this._condense(ve),this}ne||Pe.leaf||!Re(Pe,he)?we?(me++,Pe=we.children[me],ne=!1):Pe=null:(ve.push(Pe),te.push(me),me=0,we=Pe,Pe=Pe.children[0])}return this},k.prototype.toBBox=function(Ee){return Ee},k.prototype.compareMinX=function(Ee,Ie){return Ee.minX-Ie.minX},k.prototype.compareMinY=function(Ee,Ie){return Ee.minY-Ie.minY},k.prototype.toJSON=function(){return this.data},k.prototype.fromJSON=function(Ee){return this.data=Ee,this},k.prototype._all=function(Ee,Ie){for(var me=[];Ee;)Ee.leaf?Ie.push.apply(Ie,Ee.children):me.push.apply(me,Ee.children),Ee=me.pop();return Ie},k.prototype._build=function(Ee,Ie,me,we){var ne,Pe=me-Ie+1,he=this._maxEntries;if(Pe<=he)return Z(ne=Ve(Ee.slice(Ie,me+1)),this.toBBox),ne;we||(we=Math.ceil(Math.log(Pe)/Math.log(he)),he=Math.ceil(Pe/Math.pow(he,we-1))),(ne=Ve([])).leaf=!1,ne.height=we;var ve=Math.ceil(Pe/he),te=ve*Math.ceil(Math.sqrt(he));nt(Ee,Ie,me,te,this.compareMinX);for(var Y=Ie;Y<=me;Y+=te){var Oe=Math.min(Y+te-1,me);nt(Ee,Y,Oe,ve,this.compareMinY);for(var pe=Y;pe<=Oe;pe+=ve){var ye=Math.min(pe+ve-1,Oe);ne.children.push(this._build(Ee,pe,ye,we-1))}}return Z(ne,this.toBBox),ne},k.prototype._chooseSubtree=function(Ee,Ie,me,we){for(;we.push(Ie),!Ie.leaf&&we.length-1!==me;){for(var ne=1/0,Pe=1/0,he=void 0,ve=0;ve<Ie.children.length;ve++){var te=Ie.children[ve],Y=fe(te),Oe=(pe=Ee,ye=te,(Math.max(ye.maxX,pe.maxX)-Math.min(ye.minX,pe.minX))*(Math.max(ye.maxY,pe.maxY)-Math.min(ye.minY,pe.minY))-Y);Oe<Pe?(Pe=Oe,ne=Y<ne?Y:ne,he=te):Oe===Pe&&Y<ne&&(ne=Y,he=te)}Ie=he||Ie.children[0]}var pe,ye;return Ie},k.prototype._insert=function(Ee,Ie,me){var we=me?Ee:this.toBBox(Ee),ne=[],Pe=this._chooseSubtree(we,this.data,Ie,ne);for(Pe.children.push(Ee),z(Pe,we);Ie>=0&&ne[Ie].children.length>this._maxEntries;)this._split(ne,Ie),Ie--;this._adjustParentBBoxes(we,ne,Ie)},k.prototype._split=function(Ee,Ie){var me=Ee[Ie],we=me.children.length,ne=this._minEntries;this._chooseSplitAxis(me,ne,we);var Pe=this._chooseSplitIndex(me,ne,we),he=Ve(me.children.splice(Pe,me.children.length-Pe));he.height=me.height,he.leaf=me.leaf,Z(me,this.toBBox),Z(he,this.toBBox),Ie?Ee[Ie-1].children.push(he):this._splitRoot(me,he)},k.prototype._splitRoot=function(Ee,Ie){this.data=Ve([Ee,Ie]),this.data.height=Ee.height+1,this.data.leaf=!1,Z(this.data,this.toBBox)},k.prototype._chooseSplitIndex=function(Ee,Ie,me){for(var we,ne,Pe,he,ve,te,Y,Oe=1/0,pe=1/0,ye=Ie;ye<=me-Ie;ye++){var _e=F(Ee,0,ye,this.toBBox),X=F(Ee,ye,me,this.toBBox),Le=(ne=_e,Pe=X,he=void 0,ve=void 0,te=void 0,Y=void 0,he=Math.max(ne.minX,Pe.minX),ve=Math.max(ne.minY,Pe.minY),te=Math.min(ne.maxX,Pe.maxX),Y=Math.min(ne.maxY,Pe.maxY),Math.max(0,te-he)*Math.max(0,Y-ve)),de=fe(_e)+fe(X);Le<Oe?(Oe=Le,we=ye,pe=de<pe?de:pe):Le===Oe&&de<pe&&(pe=de,we=ye)}return we||me-Ie},k.prototype._chooseSplitAxis=function(Ee,Ie,me){var we=Ee.leaf?this.compareMinX:q,ne=Ee.leaf?this.compareMinY:ee;this._allDistMargin(Ee,Ie,me,we)<this._allDistMargin(Ee,Ie,me,ne)&&Ee.children.sort(we)},k.prototype._allDistMargin=function(Ee,Ie,me,we){Ee.children.sort(we);for(var ne=this.toBBox,Pe=F(Ee,0,Ie,ne),he=F(Ee,me-Ie,me,ne),ve=Se(Pe)+Se(he),te=Ie;te<me-Ie;te++){var Y=Ee.children[te];z(Pe,Ee.leaf?ne(Y):Y),ve+=Se(Pe)}for(var Oe=me-Ie-1;Oe>=Ie;Oe--){var pe=Ee.children[Oe];z(he,Ee.leaf?ne(pe):pe),ve+=Se(he)}return ve},k.prototype._adjustParentBBoxes=function(Ee,Ie,me){for(var we=me;we>=0;we--)z(Ie[we],Ee)},k.prototype._condense=function(Ee){for(var Ie=Ee.length-1,me=void 0;Ie>=0;Ie--)Ee[Ie].children.length===0?Ie>0?(me=Ee[Ie-1].children).splice(me.indexOf(Ee[Ie]),1):this.clear():Z(Ee[Ie],this.toBBox)},k})},40210:function(le,$,C){"use strict";var L,k=SyntaxError,G=Function,Z=TypeError,F=function(X){try{return G('"use strict"; return ('+X+").constructor;")()}catch(Le){}},z=Object.getOwnPropertyDescriptor;if(z)try{z({},"")}catch(X){z=null}var q=function(){throw new Z},ee=z?function(){try{return arguments.callee,q}catch(X){try{return z(arguments,"callee").get}catch(Le){return q}}}():q,fe=C(41405)(),Se=C(28185)(),Re=Object.getPrototypeOf||(Se?function(X){return X.__proto__}:null),De={},Ve=typeof Uint8Array=="undefined"||!Re?L:Re(Uint8Array),nt={"%AggregateError%":typeof AggregateError=="undefined"?L:AggregateError,"%Array%":Array,"%ArrayBuffer%":typeof ArrayBuffer=="undefined"?L:ArrayBuffer,"%ArrayIteratorPrototype%":fe&&Re?Re([][Symbol.iterator]()):L,"%AsyncFromSyncIteratorPrototype%":L,"%AsyncFunction%":De,"%AsyncGenerator%":De,"%AsyncGeneratorFunction%":De,"%AsyncIteratorPrototype%":De,"%Atomics%":typeof Atomics=="undefined"?L:Atomics,"%BigInt%":typeof BigInt=="undefined"?L:BigInt,"%BigInt64Array%":typeof BigInt64Array=="undefined"?L:BigInt64Array,"%BigUint64Array%":typeof BigUint64Array=="undefined"?L:BigUint64Array,"%Boolean%":Boolean,"%DataView%":typeof DataView=="undefined"?L:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":Error,"%eval%":eval,"%EvalError%":EvalError,"%Float32Array%":typeof Float32Array=="undefined"?L:Float32Array,"%Float64Array%":typeof Float64Array=="undefined"?L:Float64Array,"%FinalizationRegistry%":typeof FinalizationRegistry=="undefined"?L:FinalizationRegistry,"%Function%":G,"%GeneratorFunction%":De,"%Int8Array%":typeof Int8Array=="undefined"?L:Int8Array,"%Int16Array%":typeof Int16Array=="undefined"?L:Int16Array,"%Int32Array%":typeof Int32Array=="undefined"?L:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":fe&&Re?Re(Re([][Symbol.iterator]())):L,"%JSON%":typeof JSON=="object"?JSON:L,"%Map%":typeof Map=="undefined"?L:Map,"%MapIteratorPrototype%":typeof Map=="undefined"||!fe||!Re?L:Re(new Map()[Symbol.iterator]()),"%Math%":Math,"%Number%":Number,"%Object%":Object,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":typeof Promise=="undefined"?L:Promise,"%Proxy%":typeof Proxy=="undefined"?L:Proxy,"%RangeError%":RangeError,"%ReferenceError%":ReferenceError,"%Reflect%":typeof Reflect=="undefined"?L:Reflect,"%RegExp%":RegExp,"%Set%":typeof Set=="undefined"?L:Set,"%SetIteratorPrototype%":typeof Set=="undefined"||!fe||!Re?L:Re(new Set()[Symbol.iterator]()),"%SharedArrayBuffer%":typeof SharedArrayBuffer=="undefined"?L:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":fe&&Re?Re(""[Symbol.iterator]()):L,"%Symbol%":fe?Symbol:L,"%SyntaxError%":k,"%ThrowTypeError%":ee,"%TypedArray%":Ve,"%TypeError%":Z,"%Uint8Array%":typeof Uint8Array=="undefined"?L:Uint8Array,"%Uint8ClampedArray%":typeof Uint8ClampedArray=="undefined"?L:Uint8ClampedArray,"%Uint16Array%":typeof Uint16Array=="undefined"?L:Uint16Array,"%Uint32Array%":typeof Uint32Array=="undefined"?L:Uint32Array,"%URIError%":URIError,"%WeakMap%":typeof WeakMap=="undefined"?L:WeakMap,"%WeakRef%":typeof WeakRef=="undefined"?L:WeakRef,"%WeakSet%":typeof WeakSet=="undefined"?L:WeakSet};if(Re)try{null.error}catch(X){var Ee=Re(Re(X));nt["%Error.prototype%"]=Ee}var Ie=function X(Le){var de;if(Le==="%AsyncFunction%")de=F("async function () {}");else if(Le==="%GeneratorFunction%")de=F("function* () {}");else if(Le==="%AsyncGeneratorFunction%")de=F("async function* () {}");else if(Le==="%AsyncGenerator%"){var be=X("%AsyncGeneratorFunction%");be&&(de=be.prototype)}else if(Le==="%AsyncIteratorPrototype%"){var se=X("%AsyncGenerator%");se&&Re&&(de=Re(se.prototype))}return nt[Le]=de,de},me={"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},we=C(58612),ne=C(78001),Pe=we.call(Function.call,Array.prototype.concat),he=we.call(Function.apply,Array.prototype.splice),ve=we.call(Function.call,String.prototype.replace),te=we.call(Function.call,String.prototype.slice),Y=we.call(Function.call,RegExp.prototype.exec),Oe=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,pe=/\\(\\)?/g,ye=function(Le){var de=te(Le,0,1),be=te(Le,-1);if(de==="%"&&be!=="%")throw new k("invalid intrinsic syntax, expected closing `%`");if(be==="%"&&de!=="%")throw new k("invalid intrinsic syntax, expected opening `%`");var se=[];return ve(Le,Oe,function(Ne,ze,ue,kt){se[se.length]=ue?ve(kt,pe,"$1"):ze||Ne}),se},_e=function(Le,de){var be=Le,se;if(ne(me,be)&&(se=me[be],be="%"+se[0]+"%"),ne(nt,be)){var Ne=nt[be];if(Ne===De&&(Ne=Ie(be)),typeof Ne=="undefined"&&!de)throw new Z("intrinsic "+Le+" exists, but is not available. Please file an issue!");return{alias:se,name:be,value:Ne}}throw new k("intrinsic "+Le+" does not exist!")};le.exports=function(Le,de){if(typeof Le!="string"||Le.length===0)throw new Z("intrinsic name must be a non-empty string");if(arguments.length>1&&typeof de!="boolean")throw new Z('"allowMissing" argument must be a boolean');if(Y(/^%?[^%]*%?$/,Le)===null)throw new k("`%` may not be present anywhere but at the beginning and end of the intrinsic name");var be=ye(Le),se=be.length>0?be[0]:"",Ne=_e("%"+se+"%",de),ze=Ne.name,ue=Ne.value,kt=!1,Rt=Ne.alias;Rt&&(se=Rt[0],he(be,Pe([0,1],Rt)));for(var cr=1,Ut=!0;cr<be.length;cr+=1){var $r=be[cr],ln=te($r,0,1),Cr=te($r,-1);if((ln==='"'||ln==="'"||ln==="`"||Cr==='"'||Cr==="'"||Cr==="`")&&ln!==Cr)throw new k("property names with quotes must have matching quotes");if(($r==="constructor"||!Ut)&&(kt=!0),se+="."+$r,ze="%"+se+"%",ne(nt,ze))ue=nt[ze];else if(ue!=null){if(!($r in ue)){if(!de)throw new Z("base intrinsic for "+Le+" exists, but the property is not available.");return}if(z&&cr+1>=be.length){var Qr=z(ue,$r);Ut=!!Qr,Ut&&"get"in Qr&&!("originalValue"in Qr.get)?ue=Qr.get:ue=ue[$r]}else Ut=ne(ue,$r),ue=ue[$r];Ut&&!kt&&(nt[ze]=ue)}}return ue}},25275:function(le,$,C){"use strict";var L=C(40210),k=L("%Object.getOwnPropertyDescriptor%",!0);if(k)try{k([],"length")}catch(G){k=null}le.exports=k},89947:function(le,$,C){"use strict";C.d($,{jf:function(){return Ou},mD:function(){return Es}});var L=function(Mt){Mt=Mt||{};var He=typeof Mt!="undefined"?Mt:{},Gt={},Ae;for(Ae in He)He.hasOwnProperty(Ae)&&(Gt[Ae]=He[Ae]);var Be=[],We="";function zt(st){return He.locateFile?He.locateFile(st,We):We+st}var hr;typeof document!="undefined"&&document.currentScript&&(We=document.currentScript.src),We.indexOf("blob:")!==0?We=We.substr(0,We.lastIndexOf("/")+1):We="",hr=function(Zt,Jt,yr){var v=new XMLHttpRequest;v.open("GET",Zt,!0),v.responseType="arraybuffer",v.onload=function(){if(v.status==200||v.status==0&&v.response){Jt(v.response);return}var jn=Wo(Zt);if(jn){Jt(jn.buffer);return}yr()},v.onerror=yr,v.send(null)};var Pr=He.print||console.log.bind(console),dn=He.printErr||console.warn.bind(console);for(Ae in Gt)Gt.hasOwnProperty(Ae)&&(He[Ae]=Gt[Ae]);Gt=null,He.arguments&&(Be=He.arguments);var Mn=0,vi=function(st){Mn=st},co=function(){return Mn},ns=8;function ws(st,Zt,Jt,yr){switch(Jt=Jt||"i8",Jt.charAt(Jt.length-1)==="*"&&(Jt="i32"),Jt){case"i1":Ro[st>>0]=Zt;break;case"i8":Ro[st>>0]=Zt;break;case"i16":Ra[st>>1]=Zt;break;case"i32":hu[st>>2]=Zt;break;case"i64":As=[Zt>>>0,(Ea=Zt,+mc(Ea)>=1?Ea>0?(ku(+ea(Ea/4294967296),4294967295)|0)>>>0:~~+xf((Ea-+(~~Ea>>>0))/4294967296)>>>0:0)],hu[st>>2]=As[0],hu[st+4>>2]=As[1];break;case"float":Ol[st>>2]=Zt;break;case"double":qc[st>>3]=Zt;break;default:tr("invalid type for setValue: "+Jt)}}function Qc(st,Zt,Jt){switch(Zt=Zt||"i8",Zt.charAt(Zt.length-1)==="*"&&(Zt="i32"),Zt){case"i1":return Ro[st>>0];case"i8":return Ro[st>>0];case"i16":return Ra[st>>1];case"i32":return hu[st>>2];case"i64":return hu[st>>2];case"float":return Ol[st>>2];case"double":return qc[st>>3];default:tr("invalid type for getValue: "+Zt)}return null}var zs=!1;function ca(st,Zt){st||tr("Assertion failed: "+Zt)}function ec(st){var Zt=He["_"+st];return ca(Zt,"Cannot call unknown function "+st+", make sure it is exported"),Zt}function qa(st,Zt,Jt,yr,v){var Pn={string:function(os){var ba=0;if(os!=null&&os!==0){var Vr=(os.length<<2)+1;ba=s(Vr),Us(os,ba,Vr)}return ba},array:function(os){var ba=s(os.length);return fu(os,ba),ba}};function jn(os){return Zt==="string"?In(os):Zt==="boolean"?!!os:os}var Xe=ec(st),Ia=[],ao=0;if(yr)for(var xo=0;xo<yr.length;xo++){var sa=Pn[Jt[xo]];sa?(ao===0&&(ao=_()),Ia[xo]=sa(yr[xo])):Ia[xo]=yr[xo]}var ka=Xe.apply(null,Ia);return ka=jn(ka),ao!==0&&d(ao),ka}function mf(st,Zt,Jt,yr){Jt=Jt||[];var v=Jt.every(function(jn){return jn==="number"}),Pn=Zt!=="string";return Pn&&v&&!yr?ec(st):function(){return qa(st,Zt,Jt,arguments,yr)}}var dl=typeof TextDecoder!="undefined"?new TextDecoder("utf8"):void 0;function Ta(st,Zt,Jt){for(var yr=Zt+Jt,v=Zt;st[v]&&!(v>=yr);)++v;if(v-Zt>16&&st.subarray&&dl)return dl.decode(st.subarray(Zt,v));for(var Pn="";Zt<v;){var jn=st[Zt++];if(!(jn&128)){Pn+=String.fromCharCode(jn);continue}var Xe=st[Zt++]&63;if((jn&224)==192){Pn+=String.fromCharCode((jn&31)<<6|Xe);continue}var Ia=st[Zt++]&63;if((jn&240)==224?jn=(jn&15)<<12|Xe<<6|Ia:jn=(jn&7)<<18|Xe<<12|Ia<<6|st[Zt++]&63,jn<65536)Pn+=String.fromCharCode(jn);else{var ao=jn-65536;Pn+=String.fromCharCode(55296|ao>>10,56320|ao&1023)}}return Pn}function In(st,Zt){return st?Ta(Ha,st,Zt):""}function Ju(st,Zt,Jt,yr){if(!(yr>0))return 0;for(var v=Jt,Pn=Jt+yr-1,jn=0;jn<st.length;++jn){var Xe=st.charCodeAt(jn);if(Xe>=55296&&Xe<=57343){var Ia=st.charCodeAt(++jn);Xe=65536+((Xe&1023)<<10)|Ia&1023}if(Xe<=127){if(Jt>=Pn)break;Zt[Jt++]=Xe}else if(Xe<=2047){if(Jt+1>=Pn)break;Zt[Jt++]=192|Xe>>6,Zt[Jt++]=128|Xe&63}else if(Xe<=65535){if(Jt+2>=Pn)break;Zt[Jt++]=224|Xe>>12,Zt[Jt++]=128|Xe>>6&63,Zt[Jt++]=128|Xe&63}else{if(Jt+3>=Pn)break;Zt[Jt++]=240|Xe>>18,Zt[Jt++]=128|Xe>>12&63,Zt[Jt++]=128|Xe>>6&63,Zt[Jt++]=128|Xe&63}}return Zt[Jt]=0,Jt-v}function Us(st,Zt,Jt){return Ju(st,Ha,Zt,Jt)}var cu=typeof TextDecoder!="undefined"?new TextDecoder("utf-16le"):void 0;function fu(st,Zt){Ro.set(st,Zt)}function xu(st,Zt){return st%Zt>0&&(st+=Zt-st%Zt),st}var ni,Ro,Ha,Ra,mo,hu,yf,Ol,qc;function _f(st){ni=st,He.HEAP8=Ro=new Int8Array(st),He.HEAP16=Ra=new Int16Array(st),He.HEAP32=hu=new Int32Array(st),He.HEAPU8=Ha=new Uint8Array(st),He.HEAPU16=mo=new Uint16Array(st),He.HEAPU32=yf=new Uint32Array(st),He.HEAPF32=Ol=new Float32Array(st),He.HEAPF64=qc=new Float64Array(st)}var Yo=5267040,Gs=24128,Do=He.TOTAL_MEMORY||33554432;He.buffer?ni=He.buffer:ni=new ArrayBuffer(Do),Do=ni.byteLength,_f(ni),hu[Gs>>2]=Yo;function fa(st){for(;st.length>0;){var Zt=st.shift();if(typeof Zt=="function"){Zt();continue}var Jt=Zt.func;typeof Jt=="number"?Zt.arg===void 0?He.dynCall_v(Jt):He.dynCall_vi(Jt,Zt.arg):Jt(Zt.arg===void 0?null:Zt.arg)}}var is=[],Rl=[],Ma=[],Sn=[];function vl(){if(He.preRun)for(typeof He.preRun=="function"&&(He.preRun=[He.preRun]);He.preRun.length;)gl(He.preRun.shift());fa(is)}function tc(){fa(Rl)}function Ka(){fa(Ma)}function fs(){if(He.postRun)for(typeof He.postRun=="function"&&(He.postRun=[He.postRun]);He.postRun.length;)gc(He.postRun.shift());fa(Sn)}function gl(st){is.unshift(st)}function gc(st){Sn.unshift(st)}var mc=Math.abs,xf=Math.ceil,ea=Math.floor,ku=Math.min,na=0,Za=null,ko=null;function Nf(st){na++,He.monitorRunDependencies&&He.monitorRunDependencies(na)}function ui(st){if(na--,He.monitorRunDependencies&&He.monitorRunDependencies(na),na==0&&(Za!==null&&(clearInterval(Za),Za=null),ko)){var Zt=ko;ko=null,Zt()}}He.preloadedImages={},He.preloadedAudios={};var hs=null,aa="data:application/octet-stream;base64,";function Ts(st){return String.prototype.startsWith?st.startsWith(aa):st.indexOf(aa)===0}var Ea,As;hs="data:application/octet-stream;base64,AAAAAAAAAAAAAAAAAQAAAAIAAAADAAAABAAAAAUAAAAGAAAAAQAAAAQAAAADAAAABgAAAAUAAAACAAAAAAAAAAIAAAADAAAAAQAAAAQAAAAGAAAAAAAAAAUAAAADAAAABgAAAAQAAAAFAAAAAAAAAAEAAAACAAAABAAAAAUAAAAGAAAAAAAAAAIAAAADAAAAAQAAAAUAAAACAAAAAAAAAAEAAAADAAAABgAAAAQAAAAGAAAAAAAAAAUAAAACAAAAAQAAAAQAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAEAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAIAAAADAAAAAAAAAAAAAAACAAAAAAAAAAEAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAABAAAAAYAAAAAAAAABQAAAAAAAAAAAAAABAAAAAUAAAAAAAAAAAAAAAAAAAACAAAAAAAAAAYAAAAAAAAABgAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAgAAAAMAAAAEAAAABQAAAAYAAAABAAAAAgAAAAMAAAAEAAAABQAAAAYAAAAAAAAAAgAAAAMAAAAEAAAABQAAAAYAAAAAAAAAAQAAAAMAAAAEAAAABQAAAAYAAAAAAAAAAQAAAAIAAAAEAAAABQAAAAYAAAAAAAAAAQAAAAIAAAADAAAABQAAAAYAAAAAAAAAAQAAAAIAAAADAAAABAAAAAYAAAAAAAAAAQAAAAIAAAADAAAABAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAwAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAgAAAAIAAAAAAAAAAAAAAAYAAAAAAAAAAwAAAAIAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAFAAAABAAAAAAAAAABAAAAAAAAAAAAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAYAAAAAAAAABAAAAAAAAAAGAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAFAAAAAgAAAAQAAAADAAAACAAAAAEAAAAHAAAABgAAAAkAAAAAAAAAAwAAAAIAAAACAAAABgAAAAoAAAALAAAAAAAAAAEAAAAFAAAAAwAAAA0AAAABAAAABwAAAAQAAAAMAAAAAAAAAAQAAAB/AAAADwAAAAgAAAADAAAAAAAAAAwAAAAFAAAAAgAAABIAAAAKAAAACAAAAAAAAAAQAAAABgAAAA4AAAALAAAAEQAAAAEAAAAJAAAAAgAAAAcAAAAVAAAACQAAABMAAAADAAAADQAAAAEAAAAIAAAABQAAABYAAAAQAAAABAAAAAAAAAAPAAAACQAAABMAAAAOAAAAFAAAAAEAAAAHAAAABgAAAAoAAAALAAAAGAAAABcAAAAFAAAAAgAAABIAAAALAAAAEQAAABcAAAAZAAAAAgAAAAYAAAAKAAAADAAAABwAAAANAAAAGgAAAAQAAAAPAAAAAwAAAA0AAAAaAAAAFQAAAB0AAAADAAAADAAAAAcAAAAOAAAAfwAAABEAAAAbAAAACQAAABQAAAAGAAAADwAAABYAAAAcAAAAHwAAAAQAAAAIAAAADAAAABAAAAASAAAAIQAAAB4AAAAIAAAABQAAABYAAAARAAAACwAAAA4AAAAGAAAAIwAAABkAAAAbAAAAEgAAABgAAAAeAAAAIAAAAAUAAAAKAAAAEAAAABMAAAAiAAAAFAAAACQAAAAHAAAAFQAAAAkAAAAUAAAADgAAABMAAAAJAAAAKAAAABsAAAAkAAAAFQAAACYAAAATAAAAIgAAAA0AAAAdAAAABwAAABYAAAAQAAAAKQAAACEAAAAPAAAACAAAAB8AAAAXAAAAGAAAAAsAAAAKAAAAJwAAACUAAAAZAAAAGAAAAH8AAAAgAAAAJQAAAAoAAAAXAAAAEgAAABkAAAAXAAAAEQAAAAsAAAAtAAAAJwAAACMAAAAaAAAAKgAAAB0AAAArAAAADAAAABwAAAANAAAAGwAAACgAAAAjAAAALgAAAA4AAAAUAAAAEQAAABwAAAAfAAAAKgAAACwAAAAMAAAADwAAABoAAAAdAAAAKwAAACYAAAAvAAAADQAAABoAAAAVAAAAHgAAACAAAAAwAAAAMgAAABAAAAASAAAAIQAAAB8AAAApAAAALAAAADUAAAAPAAAAFgAAABwAAAAgAAAAHgAAABgAAAASAAAANAAAADIAAAAlAAAAIQAAAB4AAAAxAAAAMAAAABYAAAAQAAAAKQAAACIAAAATAAAAJgAAABUAAAA2AAAAJAAAADMAAAAjAAAALgAAAC0AAAA4AAAAEQAAABsAAAAZAAAAJAAAABQAAAAiAAAAEwAAADcAAAAoAAAANgAAACUAAAAnAAAANAAAADkAAAAYAAAAFwAAACAAAAAmAAAAfwAAACIAAAAzAAAAHQAAAC8AAAAVAAAAJwAAACUAAAAZAAAAFwAAADsAAAA5AAAALQAAACgAAAAbAAAAJAAAABQAAAA8AAAALgAAADcAAAApAAAAMQAAADUAAAA9AAAAFgAAACEAAAAfAAAAKgAAADoAAAArAAAAPgAAABwAAAAsAAAAGgAAACsAAAA+AAAALwAAAEAAAAAaAAAAKgAAAB0AAAAsAAAANQAAADoAAABBAAAAHAAAAB8AAAAqAAAALQAAACcAAAAjAAAAGQAAAD8AAAA7AAAAOAAAAC4AAAA8AAAAOAAAAEQAAAAbAAAAKAAAACMAAAAvAAAAJgAAACsAAAAdAAAARQAAADMAAABAAAAAMAAAADEAAAAeAAAAIQAAAEMAAABCAAAAMgAAADEAAAB/AAAAPQAAAEIAAAAhAAAAMAAAACkAAAAyAAAAMAAAACAAAAAeAAAARgAAAEMAAAA0AAAAMwAAAEUAAAA2AAAARwAAACYAAAAvAAAAIgAAADQAAAA5AAAARgAAAEoAAAAgAAAAJQAAADIAAAA1AAAAPQAAAEEAAABLAAAAHwAAACkAAAAsAAAANgAAAEcAAAA3AAAASQAAACIAAAAzAAAAJAAAADcAAAAoAAAANgAAACQAAABIAAAAPAAAAEkAAAA4AAAARAAAAD8AAABNAAAAIwAAAC4AAAAtAAAAOQAAADsAAABKAAAATgAAACUAAAAnAAAANAAAADoAAAB/AAAAPgAAAEwAAAAsAAAAQQAAACoAAAA7AAAAPwAAAE4AAABPAAAAJwAAAC0AAAA5AAAAPAAAAEgAAABEAAAAUAAAACgAAAA3AAAALgAAAD0AAAA1AAAAMQAAACkAAABRAAAASwAAAEIAAAA+AAAAKwAAADoAAAAqAAAAUgAAAEAAAABMAAAAPwAAAH8AAAA4AAAALQAAAE8AAAA7AAAATQAAAEAAAAAvAAAAPgAAACsAAABUAAAARQAAAFIAAABBAAAAOgAAADUAAAAsAAAAVgAAAEwAAABLAAAAQgAAAEMAAABRAAAAVQAAADEAAAAwAAAAPQAAAEMAAABCAAAAMgAAADAAAABXAAAAVQAAAEYAAABEAAAAOAAAADwAAAAuAAAAWgAAAE0AAABQAAAARQAAADMAAABAAAAALwAAAFkAAABHAAAAVAAAAEYAAABDAAAANAAAADIAAABTAAAAVwAAAEoAAABHAAAAWQAAAEkAAABbAAAAMwAAAEUAAAA2AAAASAAAAH8AAABJAAAANwAAAFAAAAA8AAAAWAAAAEkAAABbAAAASAAAAFgAAAA2AAAARwAAADcAAABKAAAATgAAAFMAAABcAAAANAAAADkAAABGAAAASwAAAEEAAAA9AAAANQAAAF4AAABWAAAAUQAAAEwAAABWAAAAUgAAAGAAAAA6AAAAQQAAAD4AAABNAAAAPwAAAEQAAAA4AAAAXQAAAE8AAABaAAAATgAAAEoAAAA7AAAAOQAAAF8AAABcAAAATwAAAE8AAABOAAAAPwAAADsAAABdAAAAXwAAAE0AAABQAAAARAAAAEgAAAA8AAAAYwAAAFoAAABYAAAAUQAAAFUAAABeAAAAZQAAAD0AAABCAAAASwAAAFIAAABgAAAAVAAAAGIAAAA+AAAATAAAAEAAAABTAAAAfwAAAEoAAABGAAAAZAAAAFcAAABcAAAAVAAAAEUAAABSAAAAQAAAAGEAAABZAAAAYgAAAFUAAABXAAAAZQAAAGYAAABCAAAAQwAAAFEAAABWAAAATAAAAEsAAABBAAAAaAAAAGAAAABeAAAAVwAAAFMAAABmAAAAZAAAAEMAAABGAAAAVQAAAFgAAABIAAAAWwAAAEkAAABjAAAAUAAAAGkAAABZAAAAYQAAAFsAAABnAAAARQAAAFQAAABHAAAAWgAAAE0AAABQAAAARAAAAGoAAABdAAAAYwAAAFsAAABJAAAAWQAAAEcAAABpAAAAWAAAAGcAAABcAAAAUwAAAE4AAABKAAAAbAAAAGQAAABfAAAAXQAAAE8AAABaAAAATQAAAG0AAABfAAAAagAAAF4AAABWAAAAUQAAAEsAAABrAAAAaAAAAGUAAABfAAAAXAAAAE8AAABOAAAAbQAAAGwAAABdAAAAYAAAAGgAAABiAAAAbgAAAEwAAABWAAAAUgAAAGEAAAB/AAAAYgAAAFQAAABnAAAAWQAAAG8AAABiAAAAbgAAAGEAAABvAAAAUgAAAGAAAABUAAAAYwAAAFAAAABpAAAAWAAAAGoAAABaAAAAcQAAAGQAAABmAAAAUwAAAFcAAABsAAAAcgAAAFwAAABlAAAAZgAAAGsAAABwAAAAUQAAAFUAAABeAAAAZgAAAGUAAABXAAAAVQAAAHIAAABwAAAAZAAAAGcAAABbAAAAYQAAAFkAAAB0AAAAaQAAAG8AAABoAAAAawAAAG4AAABzAAAAVgAAAF4AAABgAAAAaQAAAFgAAABnAAAAWwAAAHEAAABjAAAAdAAAAGoAAABdAAAAYwAAAFoAAAB1AAAAbQAAAHEAAABrAAAAfwAAAGUAAABeAAAAcwAAAGgAAABwAAAAbAAAAGQAAABfAAAAXAAAAHYAAAByAAAAbQAAAG0AAABsAAAAXQAAAF8AAAB1AAAAdgAAAGoAAABuAAAAYgAAAGgAAABgAAAAdwAAAG8AAABzAAAAbwAAAGEAAABuAAAAYgAAAHQAAABnAAAAdwAAAHAAAABrAAAAZgAAAGUAAAB4AAAAcwAAAHIAAABxAAAAYwAAAHQAAABpAAAAdQAAAGoAAAB5AAAAcgAAAHAAAABkAAAAZgAAAHYAAAB4AAAAbAAAAHMAAABuAAAAawAAAGgAAAB4AAAAdwAAAHAAAAB0AAAAZwAAAHcAAABvAAAAcQAAAGkAAAB5AAAAdQAAAH8AAABtAAAAdgAAAHEAAAB5AAAAagAAAHYAAAB4AAAAbAAAAHIAAAB1AAAAeQAAAG0AAAB3AAAAbwAAAHMAAABuAAAAeQAAAHQAAAB4AAAAeAAAAHMAAAByAAAAcAAAAHkAAAB3AAAAdgAAAHkAAAB0AAAAeAAAAHcAAAB1AAAAcQAAAHYAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAABAAAABQAAAAEAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAACAAAABQAAAAEAAAAAAAAA/////wEAAAAAAAAAAwAAAAQAAAACAAAAAAAAAAAAAAABAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAMAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAFAAAAAQAAAAAAAAAAAAAAAQAAAAMAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAEAAAADAAAAAAAAAAAAAAABAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAADAAAABQAAAAEAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAABAAAAAAAAAP////8DAAAAAAAAAAUAAAACAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAEAAAABQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAAFAAAABQAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAD/////AwAAAAAAAAAFAAAAAgAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAAAAAABAAAAAwAAAAAAAAAAAAAAAQAAAAAAAAADAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAQAAAAMAAAAAAAAAAAAAAAEAAAAAAAAAAwAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAADAAAAAAAAAP////8DAAAAAAAAAAUAAAACAAAAAAAAAAAAAAADAAAAAAAAAAAAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAUAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAFAAAABQAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAwAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAADAAAAAwAAAAMAAAAAAAAAAwAAAAAAAAAAAAAA/////wMAAAAAAAAABQAAAAIAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAA/////wMAAAAAAAAABQAAAAIAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAMAAAADAAAAAAAAAAAAAAADAAAAAwAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAMAAAADAAAAAwAAAAMAAAAAAAAAAwAAAAAAAAD/////AwAAAAAAAAAFAAAAAgAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAAAAAADAAAAAAAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAAAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAAAAAD/////AwAAAAAAAAAFAAAAAgAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAADAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAFAAAAAAAAAAAAAAADAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAADAAAAAQAAAAAAAAABAAAAAAAAAAAAAAABAAAAAwAAAAEAAAAAAAAAAQAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAADAAAAAAAAAP////8DAAAAAAAAAAUAAAACAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAAAAAAAAAAADAAAAAwAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAUAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAFAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAA/////wMAAAAAAAAABQAAAAIAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAAFAAAAAAAAAAAAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAEAAAADAAAAAQAAAAAAAAABAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAADAAAAAQAAAAAAAAABAAAAAAAAAAMAAAADAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAEAAAAAAAAAAwAAAAUAAAABAAAAAAAAAP////8DAAAAAAAAAAUAAAACAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAABAAAAAUAAAABAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAIAAAAFAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAEAAAADAAAAAQAAAAAAAAABAAAAAAAAAAUAAAAAAAAAAAAAAAUAAAAFAAAAAAAAAAAAAAD/////AQAAAAAAAAADAAAABAAAAAIAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAUAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAFAAAAAAAAAAAAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAUAAAABAAAAAAAAAAAAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAAAAAAEAAAD//////////wEAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAADAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAsAAAACAAAAAAAAAAAAAAABAAAAAgAAAAYAAAAEAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAYAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAcAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAACAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAYAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAKAAAAAgAAAAAAAAAAAAAAAQAAAAEAAAAFAAAABgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAALAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAABAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAABwAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAsAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACgAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAACAAAAAAAAAAAAAAABAAAAAwAAAAcAAAAGAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAABwAAAAEAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAGAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAADgAAAAIAAAAAAAAAAAAAAAEAAAAAAAAACQAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACgAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAMAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAABwAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAsAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAKAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADQAAAAIAAAAAAAAAAAAAAAEAAAAEAAAACAAAAAoAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAALAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAACQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAGAAAAAgAAAAAAAAAAAAAAAQAAAAsAAAAPAAAACAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAkAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAOAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAEAAAAAAAAAAQAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAIAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAABQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAgAAAAAAAAAAAAAAAQAAAAwAAAAQAAAADAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAoAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAJAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAPAAAAAAAAAAEAAAABAAAAAAAAAAAAAAAAAAAADwAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAADQAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAACAAAAAAAAAAAAAAABAAAACgAAABMAAAAIAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAkAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAEQAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEQAAAAAAAAABAAAAAQAAAAAAAAAAAAAAAAAAAA8AAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAQAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAACQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAANAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAAAAIAAAAAAAAAAAAAAAEAAAANAAAAEQAAAA0AAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAARAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAEwAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAA4AAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAATAAAAAAAAAAEAAAABAAAAAAAAAAAAAAAAAAAAEQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAA0AAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAARAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAkAAAACAAAAAAAAAAAAAAABAAAADgAAABIAAAAPAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAADwAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABIAAAAAAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAASAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAEwAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAABEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAATAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAABIAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAATAAAAAgAAAAAAAAAAAAAAAQAAAP//////////EwAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAATAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAEgAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAASAAAAAAAAABgAAAAAAAAAIQAAAAAAAAAeAAAAAAAAACAAAAADAAAAMQAAAAEAAAAwAAAAAwAAADIAAAADAAAACAAAAAAAAAAFAAAABQAAAAoAAAAFAAAAFgAAAAAAAAAQAAAAAAAAABIAAAAAAAAAKQAAAAEAAAAhAAAAAAAAAB4AAAAAAAAABAAAAAAAAAAAAAAABQAAAAIAAAAFAAAADwAAAAEAAAAIAAAAAAAAAAUAAAAFAAAAHwAAAAEAAAAWAAAAAAAAABAAAAAAAAAAAgAAAAAAAAAGAAAAAAAAAA4AAAAAAAAACgAAAAAAAAALAAAAAAAAABEAAAADAAAAGAAAAAEAAAAXAAAAAwAAABkAAAADAAAAAAAAAAAAAAABAAAABQAAAAkAAAAFAAAABQAAAAAAAAACAAAAAAAAAAYAAAAAAAAAEgAAAAEAAAAKAAAAAAAAAAsAAAAAAAAABAAAAAEAAAADAAAABQAAAAcAAAAFAAAACAAAAAEAAAAAAAAAAAAAAAEAAAAFAAAAEAAAAAEAAAAFAAAAAAAAAAIAAAAAAAAABwAAAAAAAAAVAAAAAAAAACYAAAAAAAAACQAAAAAAAAATAAAAAAAAACIAAAADAAAADgAAAAEAAAAUAAAAAwAAACQAAAADAAAAAwAAAAAAAAANAAAABQAAAB0AAAAFAAAAAQAAAAAAAAAHAAAAAAAAABUAAAAAAAAABgAAAAEAAAAJAAAAAAAAABMAAAAAAAAABAAAAAIAAAAMAAAABQAAABoAAAAFAAAAAAAAAAEAAAADAAAAAAAAAA0AAAAFAAAAAgAAAAEAAAABAAAAAAAAAAcAAAAAAAAAGgAAAAAAAAAqAAAAAAAAADoAAAAAAAAAHQAAAAAAAAArAAAAAAAAAD4AAAADAAAAJgAAAAEAAAAvAAAAAwAAAEAAAAADAAAADAAAAAAAAAAcAAAABQAAACwAAAAFAAAADQAAAAAAAAAaAAAAAAAAACoAAAAAAAAAFQAAAAEAAAAdAAAAAAAAACsAAAAAAAAABAAAAAMAAAAPAAAABQAAAB8AAAAFAAAAAwAAAAEAAAAMAAAAAAAAABwAAAAFAAAABwAAAAEAAAANAAAAAAAAABoAAAAAAAAAHwAAAAAAAAApAAAAAAAAADEAAAAAAAAALAAAAAAAAAA1AAAAAAAAAD0AAAADAAAAOgAAAAEAAABBAAAAAwAAAEsAAAADAAAADwAAAAAAAAAWAAAABQAAACEAAAAFAAAAHAAAAAAAAAAfAAAAAAAAACkAAAAAAAAAKgAAAAEAAAAsAAAAAAAAADUAAAAAAAAABAAAAAQAAAAIAAAABQAAABAAAAAFAAAADAAAAAEAAAAPAAAAAAAAABYAAAAFAAAAGgAAAAEAAAAcAAAAAAAAAB8AAAAAAAAAMgAAAAAAAAAwAAAAAAAAADEAAAADAAAAIAAAAAAAAAAeAAAAAwAAACEAAAADAAAAGAAAAAMAAAASAAAAAwAAABAAAAADAAAARgAAAAAAAABDAAAAAAAAAEIAAAADAAAANAAAAAMAAAAyAAAAAAAAADAAAAAAAAAAJQAAAAMAAAAgAAAAAAAAAB4AAAADAAAAUwAAAAAAAABXAAAAAwAAAFUAAAADAAAASgAAAAMAAABGAAAAAAAAAEMAAAAAAAAAOQAAAAEAAAA0AAAAAwAAADIAAAAAAAAAGQAAAAAAAAAXAAAAAAAAABgAAAADAAAAEQAAAAAAAAALAAAAAwAAAAoAAAADAAAADgAAAAMAAAAGAAAAAwAAAAIAAAADAAAALQAAAAAAAAAnAAAAAAAAACUAAAADAAAAIwAAAAMAAAAZAAAAAAAAABcAAAAAAAAAGwAAAAMAAAARAAAAAAAAAAsAAAADAAAAPwAAAAAAAAA7AAAAAwAAADkAAAADAAAAOAAAAAMAAAAtAAAAAAAAACcAAAAAAAAALgAAAAMAAAAjAAAAAwAAABkAAAAAAAAAJAAAAAAAAAAUAAAAAAAAAA4AAAADAAAAIgAAAAAAAAATAAAAAwAAAAkAAAADAAAAJgAAAAMAAAAVAAAAAwAAAAcAAAADAAAANwAAAAAAAAAoAAAAAAAAABsAAAADAAAANgAAAAMAAAAkAAAAAAAAABQAAAAAAAAAMwAAAAMAAAAiAAAAAAAAABMAAAADAAAASAAAAAAAAAA8AAAAAwAAAC4AAAADAAAASQAAAAMAAAA3AAAAAAAAACgAAAAAAAAARwAAAAMAAAA2AAAAAwAAACQAAAAAAAAAQAAAAAAAAAAvAAAAAAAAACYAAAADAAAAPgAAAAAAAAArAAAAAwAAAB0AAAADAAAAOgAAAAMAAAAqAAAAAwAAABoAAAADAAAAVAAAAAAAAABFAAAAAAAAADMAAAADAAAAUgAAAAMAAABAAAAAAAAAAC8AAAAAAAAATAAAAAMAAAA+AAAAAAAAACsAAAADAAAAYQAAAAAAAABZAAAAAwAAAEcAAAADAAAAYgAAAAMAAABUAAAAAAAAAEUAAAAAAAAAYAAAAAMAAABSAAAAAwAAAEAAAAAAAAAASwAAAAAAAABBAAAAAAAAADoAAAADAAAAPQAAAAAAAAA1AAAAAwAAACwAAAADAAAAMQAAAAMAAAApAAAAAwAAAB8AAAADAAAAXgAAAAAAAABWAAAAAAAAAEwAAAADAAAAUQAAAAMAAABLAAAAAAAAAEEAAAAAAAAAQgAAAAMAAAA9AAAAAAAAADUAAAADAAAAawAAAAAAAABoAAAAAwAAAGAAAAADAAAAZQAAAAMAAABeAAAAAAAAAFYAAAAAAAAAVQAAAAMAAABRAAAAAwAAAEsAAAAAAAAAOQAAAAAAAAA7AAAAAAAAAD8AAAADAAAASgAAAAAAAABOAAAAAwAAAE8AAAADAAAAUwAAAAMAAABcAAAAAwAAAF8AAAADAAAAJQAAAAAAAAAnAAAAAwAAAC0AAAADAAAANAAAAAAAAAA5AAAAAAAAADsAAAAAAAAARgAAAAMAAABKAAAAAAAAAE4AAAADAAAAGAAAAAAAAAAXAAAAAwAAABkAAAADAAAAIAAAAAMAAAAlAAAAAAAAACcAAAADAAAAMgAAAAMAAAA0AAAAAAAAADkAAAAAAAAALgAAAAAAAAA8AAAAAAAAAEgAAAADAAAAOAAAAAAAAABEAAAAAwAAAFAAAAADAAAAPwAAAAMAAABNAAAAAwAAAFoAAAADAAAAGwAAAAAAAAAoAAAAAwAAADcAAAADAAAAIwAAAAAAAAAuAAAAAAAAADwAAAAAAAAALQAAAAMAAAA4AAAAAAAAAEQAAAADAAAADgAAAAAAAAAUAAAAAwAAACQAAAADAAAAEQAAAAMAAAAbAAAAAAAAACgAAAADAAAAGQAAAAMAAAAjAAAAAAAAAC4AAAAAAAAARwAAAAAAAABZAAAAAAAAAGEAAAADAAAASQAAAAAAAABbAAAAAwAAAGcAAAADAAAASAAAAAMAAABYAAAAAwAAAGkAAAADAAAAMwAAAAAAAABFAAAAAwAAAFQAAAADAAAANgAAAAAAAABHAAAAAAAAAFkAAAAAAAAANwAAAAMAAABJAAAAAAAAAFsAAAADAAAAJgAAAAAAAAAvAAAAAwAAAEAAAAADAAAAIgAAAAMAAAAzAAAAAAAAAEUAAAADAAAAJAAAAAMAAAA2AAAAAAAAAEcAAAAAAAAAYAAAAAAAAABoAAAAAAAAAGsAAAADAAAAYgAAAAAAAABuAAAAAwAAAHMAAAADAAAAYQAAAAMAAABvAAAAAwAAAHcAAAADAAAATAAAAAAAAABWAAAAAwAAAF4AAAADAAAAUgAAAAAAAABgAAAAAAAAAGgAAAAAAAAAVAAAAAMAAABiAAAAAAAAAG4AAAADAAAAOgAAAAAAAABBAAAAAwAAAEsAAAADAAAAPgAAAAMAAABMAAAAAAAAAFYAAAADAAAAQAAAAAMAAABSAAAAAAAAAGAAAAAAAAAAVQAAAAAAAABXAAAAAAAAAFMAAAADAAAAZQAAAAAAAABmAAAAAwAAAGQAAAADAAAAawAAAAMAAABwAAAAAwAAAHIAAAADAAAAQgAAAAAAAABDAAAAAwAAAEYAAAADAAAAUQAAAAAAAABVAAAAAAAAAFcAAAAAAAAAXgAAAAMAAABlAAAAAAAAAGYAAAADAAAAMQAAAAAAAAAwAAAAAwAAADIAAAADAAAAPQAAAAMAAABCAAAAAAAAAEMAAAADAAAASwAAAAMAAABRAAAAAAAAAFUAAAAAAAAAXwAAAAAAAABcAAAAAAAAAFMAAAAAAAAATwAAAAAAAABOAAAAAAAAAEoAAAADAAAAPwAAAAEAAAA7AAAAAwAAADkAAAADAAAAbQAAAAAAAABsAAAAAAAAAGQAAAAFAAAAXQAAAAEAAABfAAAAAAAAAFwAAAAAAAAATQAAAAEAAABPAAAAAAAAAE4AAAAAAAAAdQAAAAQAAAB2AAAABQAAAHIAAAAFAAAAagAAAAEAAABtAAAAAAAAAGwAAAAAAAAAWgAAAAEAAABdAAAAAQAAAF8AAAAAAAAAWgAAAAAAAABNAAAAAAAAAD8AAAAAAAAAUAAAAAAAAABEAAAAAAAAADgAAAADAAAASAAAAAEAAAA8AAAAAwAAAC4AAAADAAAAagAAAAAAAABdAAAAAAAAAE8AAAAFAAAAYwAAAAEAAABaAAAAAAAAAE0AAAAAAAAAWAAAAAEAAABQAAAAAAAAAEQAAAAAAAAAdQAAAAMAAABtAAAABQAAAF8AAAAFAAAAcQAAAAEAAABqAAAAAAAAAF0AAAAAAAAAaQAAAAEAAABjAAAAAQAAAFoAAAAAAAAAaQAAAAAAAABYAAAAAAAAAEgAAAAAAAAAZwAAAAAAAABbAAAAAAAAAEkAAAADAAAAYQAAAAEAAABZAAAAAwAAAEcAAAADAAAAcQAAAAAAAABjAAAAAAAAAFAAAAAFAAAAdAAAAAEAAABpAAAAAAAAAFgAAAAAAAAAbwAAAAEAAABnAAAAAAAAAFsAAAAAAAAAdQAAAAIAAABqAAAABQAAAFoAAAAFAAAAeQAAAAEAAABxAAAAAAAAAGMAAAAAAAAAdwAAAAEAAAB0AAAAAQAAAGkAAAAAAAAAdwAAAAAAAABvAAAAAAAAAGEAAAAAAAAAcwAAAAAAAABuAAAAAAAAAGIAAAADAAAAawAAAAEAAABoAAAAAwAAAGAAAAADAAAAeQAAAAAAAAB0AAAAAAAAAGcAAAAFAAAAeAAAAAEAAAB3AAAAAAAAAG8AAAAAAAAAcAAAAAEAAABzAAAAAAAAAG4AAAAAAAAAdQAAAAEAAABxAAAABQAAAGkAAAAFAAAAdgAAAAEAAAB5AAAAAAAAAHQAAAAAAAAAcgAAAAEAAAB4AAAAAQAAAHcAAAAAAAAAcgAAAAAAAABwAAAAAAAAAGsAAAAAAAAAZAAAAAAAAABmAAAAAAAAAGUAAAADAAAAUwAAAAEAAABXAAAAAwAAAFUAAAADAAAAdgAAAAAAAAB4AAAAAAAAAHMAAAAFAAAAbAAAAAEAAAByAAAAAAAAAHAAAAAAAAAAXAAAAAEAAABkAAAAAAAAAGYAAAAAAAAAdQAAAAAAAAB5AAAABQAAAHcAAAAFAAAAbQAAAAEAAAB2AAAAAAAAAHgAAAAAAAAAXwAAAAEAAABsAAAAAQAAAHIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAEAAAABAAAAAQAAAAAAAAAAAAAAAQAAAAAAAAABAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAGAAAAAgAAAAUAAAABAAAABAAAAAAAAAAAAAAABQAAAAMAAAABAAAABgAAAAQAAAACAAAAAAAAAH6iBfbytuk/Gq6akm/58z/Xrm0Liez0P5doSdOpSwRAWs602ULg8D/dT7Rcbo/1v1N1RQHFNOM/g9Snx7HW3L8HWsP8Q3jfP6VwOLosutk/9rjk1YQcxj+gnmKMsNn6P/HDeuPFY+M/YHwDjqKhB0Ci19/fCVrbP4UxKkDWOP6/pvljWa09tL9wi7wrQXjnv/Z6yLImkM2/3yTlOzY14D+m+WNZrT20PzwKVQnrQwNA9nrIsiaQzT/g40rFrRQFwPa45NWEHMa/kbslHEZq97/xw3rjxWPjv4cLC2SMBci/otff3wla27+rKF5oIAv0P1N1RQHFNOO/iDJPGyWHBUAHWsP8Q3jfvwQf/by16gXAfqIF9vK26b8XrO0Vh0r+v9eubQuJ7PS/BxLrA0ZZ479azrTZQuDwv1MK1EuItPw/yscgV9Z6FkAwHBR2WjQMQJNRzXsQ5vY/GlUHVJYKF0DONuFv2lMNQNCGZ28QJfk/0WUwoIL36D8ggDOMQuATQNqMOeAy/wZAWFYOYM+M2z/LWC4uH3oSQDE+LyTsMgRAkJzhRGWFGEDd4soovCQQQKqk0DJMEP8/rGmNdwOLBUAW2X/9xCbjP4hu3dcqJhNAzuYItRvdB0CgzW3zJW/sPxotm/Y2TxRAQAk9XmdDDEC1Kx9MKgT3P1M+NctcghZAFVqcLlb0C0Bgzd3sB2b2P77mZDPUWhZAFROHJpUGCEDAfma5CxXtPz1DWq/zYxRAmhYY5824F0DOuQKWSbAOQNCMqrvu3fs/L6DR22K2wT9nAAxPBU8RQGiN6mW43AFAZhu25b633D8c1YgmzowSQNM25BRKWARArGS08/lNxD+LFssHwmMRQLC5aNcxBgJABL9HT0WRF0CjCmJmOGEOQHsuaVzMP/s/TWJCaGGwBUCeu1PAPLzjP9nqN9DZOBNAKE4JcydbCkCGtbd1qjPzP8dgm9U8jhVAtPeKTkVwDkCeCLss5l37P401XMPLmBdAFd29VMVQDUBg0yA55h75Pz6odcYLCRdApBM4rBrkAkDyAVWgQxbRP4XDMnK20hFAymLlF7EmzD8GUgo9XBHlP3lbK7T9COc/k+OhPthhy7+YGEpnrOvCPzBFhLs15u4/epbqB6H4uz9IuuLF5svev6lzLKY31es/CaQ0envF5z8ZY0xlUADXv7zaz7HYEuI/CfbK1sn16T8uAQfWwxLWPzKn/YuFN94/5KdbC1AFu793fyCSnlfvPzK2y4doAMY/NRg5t1/X6b/shq4QJaHDP5yNIAKPOeI/vpn7BSE30r/X4YQrO6nrv78Ziv/Thto/DqJ1Y6+y5z9l51NaxFrlv8QlA65HOLS/86dxiEc96z+Hj0+LFjneP6LzBZ8LTc2/DaJ1Y6+y579l51NaxFrlP8QlA65HOLQ/8qdxiEc967+Jj0+LFjnev6LzBZ8LTc0/1qdbC1AFuz93fyCSnlfvvzK2y4doAMa/NRg5t1/X6T/vhq4QJaHDv5yNIAKPOeK/wJn7BSE30j/W4YQrO6nrP78Ziv/Thtq/CaQ0envF578XY0xlUADXP7zaz7HYEuK/CvbK1sn16b8rAQfWwxLWvzKn/YuFN96/zWLlF7EmzL8GUgo9XBHlv3lbK7T9COe/kOOhPthhyz+cGEpnrOvCvzBFhLs15u6/c5bqB6H4u79IuuLF5sveP6lzLKY31eu/AQAAAP////8HAAAA/////zEAAAD/////VwEAAP////9hCQAA/////6dBAAD/////kcsBAP/////3kAwA/////8H2VwAAAAAAAAAAAAAAAAACAAAA/////w4AAAD/////YgAAAP////+uAgAA/////8ISAAD/////ToMAAP////8ilwMA/////+4hGQD/////gu2vAAAAAAAAAAAAAAAAAAAAAAACAAAA//////////8BAAAAAwAAAP//////////////////////////////////////////////////////////////////////////AQAAAAAAAAACAAAA////////////////AwAAAP//////////////////////////////////////////////////////////////////////////AQAAAAAAAAACAAAA////////////////AwAAAP//////////////////////////////////////////////////////////////////////////AQAAAAAAAAACAAAA////////////////AwAAAP//////////////////////////////////////////////////////////AgAAAP//////////AQAAAAAAAAD/////////////////////AwAAAP////////////////////////////////////////////////////8DAAAA/////////////////////wAAAAD/////////////////////AQAAAP///////////////wIAAAD///////////////////////////////8DAAAA/////////////////////wAAAAD///////////////8CAAAAAQAAAP////////////////////////////////////////////////////8DAAAA/////////////////////wAAAAD///////////////8CAAAAAQAAAP////////////////////////////////////////////////////8DAAAA/////////////////////wAAAAD///////////////8CAAAAAQAAAP////////////////////////////////////////////////////8DAAAA/////////////////////wAAAAD///////////////8CAAAAAQAAAP////////////////////////////////////////////////////8BAAAAAgAAAP///////////////wAAAAD/////////////////////AwAAAP////////////////////////////////////////////////////8BAAAAAgAAAP///////////////wAAAAD/////////////////////AwAAAP////////////////////////////////////////////////////8BAAAAAgAAAP///////////////wAAAAD/////////////////////AwAAAP////////////////////////////////////////////////////8BAAAAAgAAAP///////////////wAAAAD/////////////////////AwAAAP///////////////////////////////wIAAAD///////////////8BAAAA/////////////////////wAAAAD/////////////////////AwAAAP////////////////////////////////////////////////////8DAAAA/////////////////////wAAAAABAAAA//////////8CAAAA//////////////////////////////////////////////////////////8DAAAA////////////////AgAAAAAAAAABAAAA//////////////////////////////////////////////////////////////////////////8DAAAA////////////////AgAAAAAAAAABAAAA//////////////////////////////////////////////////////////////////////////8DAAAA////////////////AgAAAAAAAAABAAAA//////////////////////////////////////////////////////////////////////////8DAAAAAQAAAP//////////AgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAACAAAAAAAAAAIAAAABAAAAAQAAAAIAAAACAAAAAAAAAAUAAAAFAAAAAAAAAAIAAAACAAAAAwAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAgAAAAEAAAACAAAAAgAAAAIAAAAAAAAABQAAAAYAAAAAAAAAAgAAAAIAAAADAAAAAgAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAgAAAAAAAAACAAAAAQAAAAMAAAACAAAAAgAAAAAAAAAFAAAABwAAAAAAAAACAAAAAgAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAACAAAAAAAAAAIAAAABAAAABAAAAAIAAAACAAAAAAAAAAUAAAAIAAAAAAAAAAIAAAACAAAAAwAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAIAAAAAAAAAAgAAAAEAAAAAAAAAAgAAAAIAAAAAAAAABQAAAAkAAAAAAAAAAgAAAAIAAAADAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAKAAAAAgAAAAIAAAAAAAAAAwAAAA4AAAACAAAAAAAAAAIAAAADAAAAAAAAAAAAAAACAAAAAgAAAAMAAAAGAAAAAAAAAAAAAAAAAAAAAAAAAAsAAAACAAAAAgAAAAAAAAADAAAACgAAAAIAAAAAAAAAAgAAAAMAAAABAAAAAAAAAAIAAAACAAAAAwAAAAcAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAIAAAACAAAAAAAAAAMAAAALAAAAAgAAAAAAAAACAAAAAwAAAAIAAAAAAAAAAgAAAAIAAAADAAAACAAAAAAAAAAAAAAAAAAAAAAAAAANAAAAAgAAAAIAAAAAAAAAAwAAAAwAAAACAAAAAAAAAAIAAAADAAAAAwAAAAAAAAACAAAAAgAAAAMAAAAJAAAAAAAAAAAAAAAAAAAAAAAAAA4AAAACAAAAAgAAAAAAAAADAAAADQAAAAIAAAAAAAAAAgAAAAMAAAAEAAAAAAAAAAIAAAACAAAAAwAAAAoAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAIAAAACAAAAAAAAAAMAAAAGAAAAAgAAAAAAAAACAAAAAwAAAA8AAAAAAAAAAgAAAAIAAAADAAAACwAAAAAAAAAAAAAAAAAAAAAAAAAGAAAAAgAAAAIAAAAAAAAAAwAAAAcAAAACAAAAAAAAAAIAAAADAAAAEAAAAAAAAAACAAAAAgAAAAMAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAcAAAACAAAAAgAAAAAAAAADAAAACAAAAAIAAAAAAAAAAgAAAAMAAAARAAAAAAAAAAIAAAACAAAAAwAAAA0AAAAAAAAAAAAAAAAAAAAAAAAACAAAAAIAAAACAAAAAAAAAAMAAAAJAAAAAgAAAAAAAAACAAAAAwAAABIAAAAAAAAAAgAAAAIAAAADAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAJAAAAAgAAAAIAAAAAAAAAAwAAAAUAAAACAAAAAAAAAAIAAAADAAAAEwAAAAAAAAACAAAAAgAAAAMAAAAPAAAAAAAAAAAAAAAAAAAAAAAAABAAAAACAAAAAAAAAAIAAAABAAAAEwAAAAIAAAACAAAAAAAAAAUAAAAKAAAAAAAAAAIAAAACAAAAAwAAABAAAAAAAAAAAAAAAAAAAAAAAAAAEQAAAAIAAAAAAAAAAgAAAAEAAAAPAAAAAgAAAAIAAAAAAAAABQAAAAsAAAAAAAAAAgAAAAIAAAADAAAAEQAAAAAAAAAAAAAAAAAAAAAAAAASAAAAAgAAAAAAAAACAAAAAQAAABAAAAACAAAAAgAAAAAAAAAFAAAADAAAAAAAAAACAAAAAgAAAAMAAAASAAAAAAAAAAAAAAAAAAAAAAAAABMAAAACAAAAAAAAAAIAAAABAAAAEQAAAAIAAAACAAAAAAAAAAUAAAANAAAAAAAAAAIAAAACAAAAAwAAABMAAAAAAAAAAAAAAAAAAAAAAAAADwAAAAIAAAAAAAAAAgAAAAEAAAASAAAAAgAAAAIAAAAAAAAABQAAAA4AAAAAAAAAAgAAAAIAAAADAAAAAgAAAAEAAAAAAAAAAQAAAAIAAAAAAAAAAAAAAAIAAAABAAAAAAAAAAEAAAACAAAAAQAAAAAAAAACAAAAAAAAAAUAAAAEAAAAAAAAAAEAAAAFAAAAAAAAAAAAAAAFAAAABAAAAAAAAAABAAAABQAAAAQAAAAAAAAABQAAAAAAAAACAAAAAQAAAAAAAAABAAAAAgAAAAAAAAAAAAAAAgAAAAEAAAAAAAAAAQAAAAIAAAABAAAAAAAAAAIAAAACAAAAAAAAAAEAAAAAAAAAAAAAAAUAAAAEAAAAAAAAAAEAAAAFAAAAAAAAAAAAAAAFAAAABAAAAAAAAAABAAAABQAAAAQAAAAAAAAABQAAAAUAAAAAAAAAAQAAAAAAAAAAAAAAOgehWlKfUEEz1zLi+JsiQa2og3wcMfVAWCbHorc0yEDi+Yn/Y6mbQJ11/mfsnG9At6bnG4UQQkBvMCQWKqUUQJVmwwswmOc/3hVgVBL3uj//qqOEOdGOPw/WDN4gnGE/H3ANkCUgND+AA8btKgAHPwTXBqJVSdo+XfRQAqsKrj4fc+zLYbSPQklEmCZHv2FCUP+uDso1NEKYtPhwphUHQptxnyFXYdpB7CddZAMmrkGAt1AxSTqBQUibBVdTsFNBSuX3MV+AJkFocv82SLf5QAqmgj7AY81A23VDSEnLoEDGEJVSeDFzQDYrqvBk70VA8U157pcRGUBWfEF+ZKbsP7KBdLHZTpFAqKYk69AqekDbeGY41MdjQD8AZzHK501A1vcrrjubNkD5LnquvBYhQCbiRRD71QlAqt72EbOH8z8Eu+jL1YbdP4uaox/xUcY/abedg1XfsD+BsUdzJ4KZP5wE9YFySIM/rW1kAKMpbT+rZFthVRhWPy4PKlXIs0A/qMZLlwDnMEHByqEF0I0ZQQYSFD8lUQNBPpY+dFs07UAH8BZImBPWQN9RY0I0sMBA2T7kLfc6qUByFYvfhBKTQMq+0Mis1XxA0XQbeQXMZUBJJ5aEGXpQQP7/SY0a6ThAaMD92b/UIkAs8s8yqXoMQNIegOvCk/U/aOi7NZJP4D8AAAAA/////wAAAAAAAAAAAAAAAAAAAAAAAAAA/////////////////////////////////////wAAAAD/////AAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAA/////wAAAAAAAAAAAQAAAAEAAAAAAAAAAAAAAP////8AAAAABQAAAAAAAAAAAAAAAAAAAAAAAAD/////BQAAAAUAAAAAAAAAAAAAAAAAAAAAAAAA/////wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAP////////////////////////////////////8AAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD/////////////////////////////////////AAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAABQAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA/////////////////////////////////////wAAAAABAAAAAQAAAAEAAAABAAAAAQAAAAEAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAEAAAABAAAAAQAAAAAAAAABAAAAAAAAAAUAAAABAAAAAQAAAAAAAAAAAAAAAQAAAAEAAAAAAAAAAQAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQEAAAAAAAEAAQAAAQEAAAAAAAEAAAABAAAAAQABAAAAAAAAAAAAAAAAAAAAAAcAAAAHAAAAAQAAAAIAAAAEAAAAAwAAAAAAAAAAAAAABwAAAAMAAAABAAAAAgAAAAUAAAAEAAAAAAAAAAAAAAAEAAAABAAAAAAAAAACAAAAAQAAAAMAAAAOAAAABgAAAAsAAAACAAAABwAAAAEAAAAYAAAABQAAAAoAAAABAAAABgAAAAAAAAAmAAAABwAAAAwAAAADAAAACAAAAAIAAAAxAAAACQAAAA4AAAAAAAAABQAAAAQAAAA6AAAACAAAAA0AAAAEAAAACQAAAAMAAAA/AAAACwAAAAYAAAAPAAAACgAAABAAAABIAAAADAAAAAcAAAAQAAAACwAAABEAAABTAAAACgAAAAUAAAATAAAADgAAAA8AAABhAAAADQAAAAgAAAARAAAADAAAABIAAABrAAAADgAAAAkAAAASAAAADQAAABMAAAB1AAAADwAAABMAAAARAAAAEgAAABAAAAAGAAAAAgAAAAMAAAAFAAAABAAAAAAAAAAAAAAAAAAAAAYAAAACAAAAAwAAAAEAAAAFAAAABAAAAAAAAAAAAAAABwAAAAUAAAADAAAABAAAAAEAAAAAAAAAAgAAAAAAAAACAAAAAwAAAAEAAAAFAAAABAAAAAYAAAAAAAAAAAAAAGFsZ29zLmMAaDNOZWlnaGJvclJvdGF0aW9ucwBjb29yZGlqay5jAF91cEFwN0NoZWNrZWQAX3VwQXA3ckNoZWNrZWQAZGlyZWN0ZWRFZGdlLmMAZGlyZWN0ZWRFZGdlVG9Cb3VuZGFyeQBhZGphY2VudEZhY2VEaXJbdG1wRmlqay5mYWNlXVtmaWprLmZhY2VdID09IEtJAGZhY2VpamsuYwBfZmFjZUlqa1BlbnRUb0NlbGxCb3VuZGFyeQBhZGphY2VudEZhY2VEaXJbY2VudGVySUpLLmZhY2VdW2ZhY2UyXSA9PSBLSQBfZmFjZUlqa1RvQ2VsbEJvdW5kYXJ5AGgzSW5kZXguYwBjb21wYWN0Q2VsbHMAbGF0TG5nVG9DZWxsAGNlbGxUb0NoaWxkUG9zAHZhbGlkYXRlQ2hpbGRQb3MAbGF0TG5nLmMAY2VsbEFyZWFSYWRzMgBwb2x5Z29uLT5uZXh0ID09IE5VTEwAbGlua2VkR2VvLmMAYWRkTmV3TGlua2VkUG9seWdvbgBuZXh0ICE9IE5VTEwAbG9vcCAhPSBOVUxMAGFkZE5ld0xpbmtlZExvb3AAcG9seWdvbi0+Zmlyc3QgPT0gTlVMTABhZGRMaW5rZWRMb29wAGNvb3JkICE9IE5VTEwAYWRkTGlua2VkQ29vcmQAbG9vcC0+Zmlyc3QgPT0gTlVMTABpbm5lckxvb3BzICE9IE5VTEwAbm9ybWFsaXplTXVsdGlQb2x5Z29uAGJib3hlcyAhPSBOVUxMAGNhbmRpZGF0ZXMgIT0gTlVMTABmaW5kUG9seWdvbkZvckhvbGUAY2FuZGlkYXRlQkJveGVzICE9IE5VTEwAcmV2RGlyICE9IElOVkFMSURfRElHSVQAbG9jYWxpai5jAGNlbGxUb0xvY2FsSWprAGJhc2VDZWxsICE9IG9yaWdpbkJhc2VDZWxsACEob3JpZ2luT25QZW50ICYmIGluZGV4T25QZW50KQBiYXNlQ2VsbCA9PSBvcmlnaW5CYXNlQ2VsbABiYXNlQ2VsbCAhPSBJTlZBTElEX0JBU0VfQ0VMTABsb2NhbElqa1RvQ2VsbAAhX2lzQmFzZUNlbGxQZW50YWdvbihiYXNlQ2VsbCkAYmFzZUNlbGxSb3RhdGlvbnMgPj0gMABncmlkUGF0aENlbGxzADAAdmVydGV4LmMAY2VsbFRvVmVydGV4AGdyYXBoLT5idWNrZXRzICE9IE5VTEwAdmVydGV4R3JhcGguYwBpbml0VmVydGV4R3JhcGgAbm9kZSAhPSBOVUxMAGFkZFZlcnRleE5vZGU=";var ml=24144;function nu(st){return st}function Mi(st){var Zt=/\b__Z[\w\d_]+/g;return st.replace(Zt,function(Jt){var yr=Jt;return Jt===yr?Jt:yr+" ["+Jt+"]"})}function as(){var st=new Error;if(!st.stack){try{throw new Error(0)}catch(Zt){st=Zt}if(!st.stack)return"(no stack trace available)"}return st.stack.toString()}function iu(){var st=as();return He.extraStackTrace&&(st+=`
`+He.extraStackTrace()),Mi(st)}function No(st,Zt,Jt,yr){tr("Assertion failed: "+In(st)+", at: "+[Zt?In(Zt):"unknown filename",Jt,yr?In(yr):"unknown function"])}function ps(){return Ro.length}function Fo(st,Zt,Jt){Ha.set(Ha.subarray(Zt,Zt+Jt),st)}function a0(st){return He.___errno_location&&(hu[He.___errno_location()>>2]=st),st}function rc(st){tr("OOM")}function ma(st){try{var Zt=new ArrayBuffer(st);return Zt.byteLength!=st?void 0:(new Int8Array(Zt).set(Ro),Vs(Zt),_f(Zt),1)}catch(Jt){}}function Bo(st){var Zt=ps(),Jt=16777216,yr=2147483648-Jt;if(st>yr)return!1;for(var v=16777216,Pn=Math.max(Zt,v);Pn<st;)Pn<=536870912?Pn=xu(2*Pn,Jt):Pn=Math.min(xu((3*Pn+2147483648)/4,Jt),yr);var jn=ma(Pn);return!!jn}var Ms=typeof atob=="function"?atob:function(st){var Zt="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",Jt="",yr,v,Pn,jn,Xe,Ia,ao,xo=0;st=st.replace(/[^A-Za-z0-9\+\/\=]/g,"");do jn=Zt.indexOf(st.charAt(xo++)),Xe=Zt.indexOf(st.charAt(xo++)),Ia=Zt.indexOf(st.charAt(xo++)),ao=Zt.indexOf(st.charAt(xo++)),yr=jn<<2|Xe>>4,v=(Xe&15)<<4|Ia>>2,Pn=(Ia&3)<<6|ao,Jt=Jt+String.fromCharCode(yr),Ia!==64&&(Jt=Jt+String.fromCharCode(v)),ao!==64&&(Jt=Jt+String.fromCharCode(Pn));while(xo<st.length);return Jt};function fo(st){try{for(var Zt=Ms(st),Jt=new Uint8Array(Zt.length),yr=0;yr<Zt.length;++yr)Jt[yr]=Zt.charCodeAt(yr);return Jt}catch(v){throw new Error("Converting base64 string to bytes failed.")}}function Wo(st){if(Ts(st))return fo(st.slice(aa.length))}var Au={Math,Int8Array,Int32Array,Uint8Array,Float32Array,Float64Array},js={a:tr,b:vi,c:co,d:No,e:a0,f:ps,g:Fo,h:Bo,i:rc,j:nu,k:Mi,l:ma,m:as,n:iu,o:ml,p:Gs},Zr=function(st,Zt,Jt){"almost asm";var yr=new st.Int8Array(Jt),v=new st.Int32Array(Jt),Pn=new st.Uint8Array(Jt),jn=new st.Float32Array(Jt),Xe=new st.Float64Array(Jt),Ia=Zt.o|0,ao=Zt.p|0,xo=st.Math.floor,sa=st.Math.abs,ka=st.Math.sqrt,os=st.Math.pow,ba=st.Math.cos,Vr=st.Math.sin,hn=st.Math.tan,Yn=st.Math.acos,Dn=st.Math.asin,Kn=st.Math.atan,Ln=st.Math.atan2,Fi=st.Math.ceil,wi=st.Math.imul,An=st.Math.min,Ge=st.Math.max,al=st.Math.clz32,Bi=Zt.b,lt=Zt.c,ii=Zt.d,xc=Zt.e,Eh=Zt.f,Ec=Zt.g,s0=Zt.h,rf=Zt.i,Je=24160;function bc(h){return yr=new Int8Array(h),Pn=new Uint8Array(h),v=new Int32Array(h),jn=new Float32Array(h),Xe=new Float64Array(h),Jt=h,!0}function Ef(h){h=h|0;var f=0;return f=Je,Je=Je+h|0,Je=Je+15&-16,f|0}function u0(){return Je|0}function Bf(h){h=h|0,Je=h}function nf(h,f){h=h|0,f=f|0,Je=h}function l0(h,f){h=h|0,f=f|0;var p=0,m=0,E=0;return(h|0)<0?(f=2,f|0):(h|0)>13780509?(f=Pf(15,f)|0,f|0):(p=((h|0)<0)<<31>>31,E=Ri(h|0,p|0,3,0)|0,m=lt()|0,p=un(h|0,p|0,1,0)|0,p=Ri(E|0,m|0,p|0,lt()|0)|0,p=un(p|0,lt()|0,1,0)|0,h=lt()|0,v[f>>2]=p,v[f+4>>2]=h,f=0,f|0)}function bf(h,f,p,m){return h=h|0,f=f|0,p=p|0,m=m|0,U0(h,f,p,m,0)|0}function U0(h,f,p,m,E){h=h|0,f=f|0,p=p|0,m=m|0,E=E|0;var S=0,I=0,D=0,V=0,re=0;if(V=Je,Je=Je+16|0,I=V,!(c0(h,f,p,m,E)|0))return m=0,Je=V,m|0;do if((p|0)>=0){if((p|0)>13780509){if(S=Pf(15,I)|0,S|0)break;D=I,I=v[D>>2]|0,D=v[D+4>>2]|0}else S=((p|0)<0)<<31>>31,re=Ri(p|0,S|0,3,0)|0,D=lt()|0,S=un(p|0,S|0,1,0)|0,S=Ri(re|0,D|0,S|0,lt()|0)|0,S=un(S|0,lt()|0,1,0)|0,D=lt()|0,v[I>>2]=S,v[I+4>>2]=D,I=S;if(St(m|0,0,I<<3|0)|0,E|0){St(E|0,0,I<<2|0)|0,S=zu(h,f,p,m,E,I,D,0)|0;break}S=ya(I,4)|0,S?(re=zu(h,f,p,m,S,I,D,0)|0,Tn(S),S=re):S=13}else S=2;while(0);return re=S,Je=V,re|0}function c0(h,f,p,m,E){h=h|0,f=f|0,p=p|0,m=m|0,E=E|0;var S=0,I=0,D=0,V=0,re=0,xe=0,Fe=0,ut=0,gt=0,rt=0,_t=0;if(_t=Je,Je=Je+16|0,gt=_t,rt=_t+8|0,ut=gt,v[ut>>2]=h,v[ut+4>>2]=f,(p|0)<0)return rt=2,Je=_t,rt|0;if(S=m,v[S>>2]=h,v[S+4>>2]=f,S=(E|0)!=0,S&&(v[E>>2]=0),pa(h,f)|0)return rt=9,Je=_t,rt|0;v[rt>>2]=0;e:do if((p|0)>=1)if(S)for(xe=1,re=0,Fe=0,ut=1,S=h;;){if(!(re|Fe)){if(S=Uo(S,f,4,rt,gt)|0,S|0)break e;if(f=gt,S=v[f>>2]|0,f=v[f+4>>2]|0,pa(S,f)|0){S=9;break e}}if(S=Uo(S,f,v[22384+(Fe<<2)>>2]|0,rt,gt)|0,S|0)break e;if(f=gt,S=v[f>>2]|0,f=v[f+4>>2]|0,h=m+(xe<<3)|0,v[h>>2]=S,v[h+4>>2]=f,v[E+(xe<<2)>>2]=ut,h=re+1|0,I=(h|0)==(ut|0),D=Fe+1|0,V=(D|0)==6,pa(S,f)|0){S=9;break e}if(ut=ut+(V&I&1)|0,(ut|0)>(p|0)){S=0;break}else xe=xe+1|0,re=I?0:h,Fe=I?V?0:D:Fe}else for(xe=1,re=0,Fe=0,ut=1,S=h;;){if(!(re|Fe)){if(S=Uo(S,f,4,rt,gt)|0,S|0)break e;if(f=gt,S=v[f>>2]|0,f=v[f+4>>2]|0,pa(S,f)|0){S=9;break e}}if(S=Uo(S,f,v[22384+(Fe<<2)>>2]|0,rt,gt)|0,S|0)break e;if(f=gt,S=v[f>>2]|0,f=v[f+4>>2]|0,h=m+(xe<<3)|0,v[h>>2]=S,v[h+4>>2]=f,h=re+1|0,I=(h|0)==(ut|0),D=Fe+1|0,V=(D|0)==6,pa(S,f)|0){S=9;break e}if(ut=ut+(V&I&1)|0,(ut|0)>(p|0)){S=0;break}else xe=xe+1|0,re=I?0:h,Fe=I?V?0:D:Fe}else S=0;while(0);return rt=S,Je=_t,rt|0}function zu(h,f,p,m,E,S,I,D){h=h|0,f=f|0,p=p|0,m=m|0,E=E|0,S=S|0,I=I|0,D=D|0;var V=0,re=0,xe=0,Fe=0,ut=0,gt=0,rt=0,_t=0,$t=0,qt=0;if(_t=Je,Je=Je+16|0,gt=_t+8|0,rt=_t,V=Jo(h|0,f|0,S|0,I|0)|0,xe=lt()|0,Fe=m+(V<<3)|0,$t=Fe,qt=v[$t>>2]|0,$t=v[$t+4>>2]|0,re=(qt|0)==(h|0)&($t|0)==(f|0),!((qt|0)==0&($t|0)==0|re))do V=un(V|0,xe|0,1,0)|0,V=Xt(V|0,lt()|0,S|0,I|0)|0,xe=lt()|0,Fe=m+(V<<3)|0,qt=Fe,$t=v[qt>>2]|0,qt=v[qt+4>>2]|0,re=($t|0)==(h|0)&(qt|0)==(f|0);while(!(($t|0)==0&(qt|0)==0|re));if(V=E+(V<<2)|0,re&&(v[V>>2]|0)<=(D|0)||(qt=Fe,v[qt>>2]=h,v[qt+4>>2]=f,v[V>>2]=D,(D|0)>=(p|0)))return qt=0,Je=_t,qt|0;switch(re=D+1|0,v[gt>>2]=0,V=Uo(h,f,2,gt,rt)|0,V|0){case 9:{ut=9;break}case 0:{V=rt,V=zu(v[V>>2]|0,v[V+4>>2]|0,p,m,E,S,I,re)|0,V||(ut=9);break}default:}e:do if((ut|0)==9){switch(v[gt>>2]=0,V=Uo(h,f,3,gt,rt)|0,V|0){case 9:break;case 0:{if(V=rt,V=zu(v[V>>2]|0,v[V+4>>2]|0,p,m,E,S,I,re)|0,V|0)break e;break}default:break e}switch(v[gt>>2]=0,V=Uo(h,f,1,gt,rt)|0,V|0){case 9:break;case 0:{if(V=rt,V=zu(v[V>>2]|0,v[V+4>>2]|0,p,m,E,S,I,re)|0,V|0)break e;break}default:break e}switch(v[gt>>2]=0,V=Uo(h,f,5,gt,rt)|0,V|0){case 9:break;case 0:{if(V=rt,V=zu(v[V>>2]|0,v[V+4>>2]|0,p,m,E,S,I,re)|0,V|0)break e;break}default:break e}switch(v[gt>>2]=0,V=Uo(h,f,4,gt,rt)|0,V|0){case 9:break;case 0:{if(V=rt,V=zu(v[V>>2]|0,v[V+4>>2]|0,p,m,E,S,I,re)|0,V|0)break e;break}default:break e}switch(v[gt>>2]=0,V=Uo(h,f,6,gt,rt)|0,V|0){case 9:break;case 0:{if(V=rt,V=zu(v[V>>2]|0,v[V+4>>2]|0,p,m,E,S,I,re)|0,V|0)break e;break}default:break e}return qt=0,Je=_t,qt|0}while(0);return qt=V,Je=_t,qt|0}function Uo(h,f,p,m,E){h=h|0,f=f|0,p=p|0,m=m|0,E=E|0;var S=0,I=0,D=0,V=0,re=0,xe=0,Fe=0,ut=0,gt=0,rt=0;if(p>>>0>6)return E=1,E|0;if(Fe=(v[m>>2]|0)%6|0,v[m>>2]=Fe,(Fe|0)>0){S=0;do p=Mc(p)|0,S=S+1|0;while((S|0)<(v[m>>2]|0))}if(Fe=ft(h|0,f|0,45)|0,lt()|0,xe=Fe&127,xe>>>0>121)return E=5,E|0;V=Qs(h,f)|0,S=ft(h|0,f|0,52)|0,lt()|0,S=S&15;e:do if(!S)re=8;else{for(;;){if(I=(15-S|0)*3|0,D=ft(h|0,f|0,I|0)|0,lt()|0,D=D&7,(D|0)==7){f=5;break}if(rt=(ou(S)|0)==0,S=S+-1|0,ut=Et(7,0,I|0)|0,f=f&~(lt()|0),gt=Et(v[(rt?432:16)+(D*28|0)+(p<<2)>>2]|0,0,I|0)|0,I=lt()|0,p=v[(rt?640:224)+(D*28|0)+(p<<2)>>2]|0,h=gt|h&~ut,f=I|f,!p){p=0;break e}if(!S){re=8;break e}}return f|0}while(0);(re|0)==8&&(rt=v[848+(xe*28|0)+(p<<2)>>2]|0,gt=Et(rt|0,0,45)|0,h=gt|h,f=lt()|0|f&-1040385,p=v[4272+(xe*28|0)+(p<<2)>>2]|0,(rt&127|0)==127&&(rt=Et(v[848+(xe*28|0)+20>>2]|0,0,45)|0,f=lt()|0|f&-1040385,p=v[4272+(xe*28|0)+20>>2]|0,h=wl(rt|h,f)|0,f=lt()|0,v[m>>2]=(v[m>>2]|0)+1)),D=ft(h|0,f|0,45)|0,lt()|0,D=D&127;e:do if(oa(D)|0){t:do if((Qs(h,f)|0)==1){if((xe|0)!=(D|0))if(h0(D,v[7696+(xe*28|0)>>2]|0)|0){h=Mu(h,f)|0,I=1,f=lt()|0;break}else ii(23313,22416,436,22424);switch(V|0){case 3:{h=wl(h,f)|0,f=lt()|0,v[m>>2]=(v[m>>2]|0)+1,I=0;break t}case 5:{h=Mu(h,f)|0,f=lt()|0,v[m>>2]=(v[m>>2]|0)+5,I=0;break t}case 0:return rt=9,rt|0;default:return rt=1,rt|0}}else I=0;while(0);if((p|0)>0){S=0;do h=Rc(h,f)|0,f=lt()|0,S=S+1|0;while((S|0)!=(p|0))}if((xe|0)!=(D|0)){if(!(Ua(D)|0)){if((I|0)!=0|(Qs(h,f)|0)!=5)break;v[m>>2]=(v[m>>2]|0)+1;break}switch(Fe&127){case 8:case 118:break e;default:}(Qs(h,f)|0)!=3&&(v[m>>2]=(v[m>>2]|0)+1)}}else if((p|0)>0){S=0;do h=wl(h,f)|0,f=lt()|0,S=S+1|0;while((S|0)!=(p|0))}while(0);return v[m>>2]=((v[m>>2]|0)+p|0)%6|0,rt=E,v[rt>>2]=h,v[rt+4>>2]=f,rt=0,rt|0}function Zf(h,f,p,m){h=h|0,f=f|0,p=p|0,m=m|0;var E=0,S=0,I=0,D=0,V=0,re=0;for(D=Je,Je=Je+16|0,S=D,I=D+8|0,E=(pa(h,f)|0)==0,E=E?1:2;;){if(v[I>>2]=0,re=(Uo(h,f,E,I,S)|0)==0,V=S,re&((v[V>>2]|0)==(p|0)?(v[V+4>>2]|0)==(m|0):0)){h=4;break}if(E=E+1|0,E>>>0>=7){E=7,h=4;break}}return(h|0)==4?(Je=D,E|0):0}function bh(h,f,p,m){h=h|0,f=f|0,p=p|0,m=m|0;var E=0,S=0,I=0,D=0,V=0,re=0,xe=0,Fe=0,ut=0,gt=0,rt=0;if(rt=Je,Je=Je+16|0,ut=rt,gt=rt+8|0,Fe=ut,v[Fe>>2]=h,v[Fe+4>>2]=f,!p)return gt=m,v[gt>>2]=h,v[gt+4>>2]=f,gt=0,Je=rt,gt|0;v[gt>>2]=0;e:do if(pa(h,f)|0)h=9;else{if(S=(p|0)>0,S){E=0,Fe=h;do{if(h=Uo(Fe,f,4,gt,ut)|0,h|0)break e;if(f=ut,Fe=v[f>>2]|0,f=v[f+4>>2]|0,E=E+1|0,pa(Fe,f)|0){h=9;break e}}while((E|0)<(p|0));if(xe=m,v[xe>>2]=Fe,v[xe+4>>2]=f,xe=p+-1|0,S){re=0,h=1;do{if(E=22384+(re<<2)|0,(re|0)==5)for(I=v[E>>2]|0,S=0,E=h;;){if(h=ut,h=Uo(v[h>>2]|0,v[h+4>>2]|0,I,gt,ut)|0,h|0)break e;if((S|0)!=(xe|0))if(V=ut,D=v[V>>2]|0,V=v[V+4>>2]|0,h=m+(E<<3)|0,v[h>>2]=D,v[h+4>>2]=V,!(pa(D,V)|0))h=E+1|0;else{h=9;break e}else h=E;if(S=S+1|0,(S|0)>=(p|0))break;E=h}else for(I=ut,V=v[E>>2]|0,D=0,E=h,S=v[I>>2]|0,I=v[I+4>>2]|0;;){if(h=Uo(S,I,V,gt,ut)|0,h|0)break e;if(I=ut,S=v[I>>2]|0,I=v[I+4>>2]|0,h=m+(E<<3)|0,v[h>>2]=S,v[h+4>>2]=I,h=E+1|0,pa(S,I)|0){h=9;break e}if(D=D+1|0,(D|0)>=(p|0))break;E=h}re=re+1|0}while(re>>>0<6);h=ut,I=Fe,E=v[h>>2]|0,S=f,h=v[h+4>>2]|0}else I=Fe,E=Fe,S=f,h=f}else I=m,v[I>>2]=h,v[I+4>>2]=f,I=h,E=h,S=f,h=f;h=(I|0)==(E|0)&(S|0)==(h|0)?0:9}while(0);return gt=h,Je=rt,gt|0}function zf(h,f,p,m){h=h|0,f=f|0,p=p|0,m=m|0;var E=0,S=0,I=0,D=0,V=0,re=0;if(D=Je,Je=Je+48|0,E=D+16|0,S=D+8|0,I=D,p|0)return I=15,Je=D,I|0;if(re=h,V=v[re+4>>2]|0,p=S,v[p>>2]=v[re>>2],v[p+4>>2]=V,Mr(S,E),f=oo(E,f,I)|0,!f){if(p=v[S>>2]|0,S=v[h+8>>2]|0,(S|0)>0){E=v[h+12>>2]|0,f=0;do p=(v[E+(f<<3)>>2]|0)+p|0,f=f+1|0;while((f|0)<(S|0))}f=I,E=v[f>>2]|0,f=v[f+4>>2]|0,S=((p|0)<0)<<31>>31,(f|0)<(S|0)|(f|0)==(S|0)&E>>>0<p>>>0?(f=I,v[f>>2]=p,v[f+4>>2]=S,f=S):p=E,V=un(p|0,f|0,12,0)|0,re=lt()|0,f=I,v[f>>2]=V,v[f+4>>2]=re,f=m,v[f>>2]=V,v[f+4>>2]=re,f=0}return re=f,Je=D,re|0}function Nl(h,f,p,m,E,S,I){h=h|0,f=f|0,p=p|0,m=m|0,E=E|0,S=S|0,I=I|0;var D=0,V=0,re=0,xe=0,Fe=0,ut=0,gt=0,rt=0,_t=0,$t=0,qt=0,Wt=0,rr=0,Yt=0,rn=0,xn=0,Kr=0,pn=0,Pa=0,ua=0,va=0,Vi=0,ci=0,Di=0,Wa=0,Qn=0,Xa=0,Iu=0,Q0=0;if(Wa=Je,Je=Je+64|0,va=Wa+48|0,Vi=Wa+32|0,ci=Wa+24|0,rn=Wa+8|0,xn=Wa,V=v[h>>2]|0,(V|0)<=0)return Di=0,Je=Wa,Di|0;for(Kr=h+4|0,pn=va+8|0,Pa=Vi+8|0,ua=rn+8|0,D=0,rr=0;;){re=v[Kr>>2]|0,Wt=re+(rr<<4)|0,v[va>>2]=v[Wt>>2],v[va+4>>2]=v[Wt+4>>2],v[va+8>>2]=v[Wt+8>>2],v[va+12>>2]=v[Wt+12>>2],(rr|0)==(V+-1|0)?(v[Vi>>2]=v[re>>2],v[Vi+4>>2]=v[re+4>>2],v[Vi+8>>2]=v[re+8>>2],v[Vi+12>>2]=v[re+12>>2]):(Wt=re+(rr+1<<4)|0,v[Vi>>2]=v[Wt>>2],v[Vi+4>>2]=v[Wt+4>>2],v[Vi+8>>2]=v[Wt+8>>2],v[Vi+12>>2]=v[Wt+12>>2]),V=Uu(va,Vi,m,ci)|0;e:do if(V)re=0,D=V;else if(re=ci,V=v[re>>2]|0,re=v[re+4>>2]|0,(re|0)>0|(re|0)==0&V>>>0>0){qt=0,Wt=0;t:for(;;){if(Q0=+Xe[va>>3],$t=da(V|0,re|0,qt|0,Wt|0)|0,Iu=+($t>>>0)+4294967296*+(lt()|0),Qn=+(V>>>0)+4294967296*+(re|0),Xa=+(qt>>>0)+4294967296*+(Wt|0),Xe[rn>>3]=Q0*Iu/Qn+ +Xe[Vi>>3]*Xa/Qn,Xe[ua>>3]=+Xe[pn>>3]*Iu/Qn+ +Xe[Pa>>3]*Xa/Qn,V=uf(rn,m,xn)|0,V|0){D=V;break}$t=xn,_t=v[$t>>2]|0,$t=v[$t+4>>2]|0,ut=Jo(_t|0,$t|0,f|0,p|0)|0,xe=lt()|0,V=I+(ut<<3)|0,Fe=V,re=v[Fe>>2]|0,Fe=v[Fe+4>>2]|0;r:do if((re|0)==0&(Fe|0)==0)Yt=V,Di=16;else for(gt=0,rt=0;;){if((gt|0)>(p|0)|(gt|0)==(p|0)&rt>>>0>f>>>0){D=1;break t}if((re|0)==(_t|0)&(Fe|0)==($t|0))break r;if(V=un(ut|0,xe|0,1,0)|0,ut=Xt(V|0,lt()|0,f|0,p|0)|0,xe=lt()|0,rt=un(rt|0,gt|0,1,0)|0,gt=lt()|0,V=I+(ut<<3)|0,Fe=V,re=v[Fe>>2]|0,Fe=v[Fe+4>>2]|0,(re|0)==0&(Fe|0)==0){Yt=V,Di=16;break}}while(0);if((Di|0)==16&&(Di=0,!((_t|0)==0&($t|0)==0))&&(rt=Yt,v[rt>>2]=_t,v[rt+4>>2]=$t,rt=S+(v[E>>2]<<3)|0,v[rt>>2]=_t,v[rt+4>>2]=$t,rt=E,rt=un(v[rt>>2]|0,v[rt+4>>2]|0,1,0)|0,_t=lt()|0,$t=E,v[$t>>2]=rt,v[$t+4>>2]=_t),qt=un(qt|0,Wt|0,1,0)|0,Wt=lt()|0,re=ci,V=v[re>>2]|0,re=v[re+4>>2]|0,!((re|0)>(Wt|0)|(re|0)==(Wt|0)&V>>>0>qt>>>0)){re=1;break e}}re=0}else re=1;while(0);if(rr=rr+1|0,!re){Di=21;break}if(V=v[h>>2]|0,(rr|0)>=(V|0)){D=0,Di=21;break}}return(Di|0)==21?(Je=Wa,D|0):0}function Sc(h,f,p,m){h=h|0,f=f|0,p=p|0,m=m|0;var E=0,S=0,I=0,D=0,V=0,re=0,xe=0,Fe=0,ut=0,gt=0,rt=0,_t=0,$t=0,qt=0,Wt=0,rr=0,Yt=0,rn=0,xn=0,Kr=0,pn=0,Pa=0,ua=0,va=0,Vi=0,ci=0,Di=0,Wa=0,Qn=0,Xa=0,Iu=0;if(Iu=Je,Je=Je+112|0,Di=Iu+80|0,V=Iu+72|0,Wa=Iu,Qn=Iu+56|0,p|0)return Xa=15,Je=Iu,Xa|0;if(re=h+8|0,Xa=Ga((v[re>>2]<<5)+32|0)|0,!Xa)return Xa=13,Je=Iu,Xa|0;if(zr(h,Xa),Vi=h,ci=v[Vi+4>>2]|0,p=V,v[p>>2]=v[Vi>>2],v[p+4>>2]=ci,Mr(V,Di),p=oo(Di,f,Wa)|0,p)Vi=0,ci=0;else{if(p=v[V>>2]|0,S=v[re>>2]|0,(S|0)>0){I=v[h+12>>2]|0,E=0;do p=(v[I+(E<<3)>>2]|0)+p|0,E=E+1|0;while((E|0)!=(S|0));E=p}else E=p;p=Wa,S=v[p>>2]|0,p=v[p+4>>2]|0,I=((E|0)<0)<<31>>31,(p|0)<(I|0)|(p|0)==(I|0)&S>>>0<E>>>0?(p=Wa,v[p>>2]=E,v[p+4>>2]=I,p=I):E=S,Vi=un(E|0,p|0,12,0)|0,ci=lt()|0,p=Wa,v[p>>2]=Vi,v[p+4>>2]=ci,p=0}if(p|0)return Tn(Xa),Xa=p,Je=Iu,Xa|0;if(E=ya(Vi,8)|0,!E)return Tn(Xa),Xa=13,Je=Iu,Xa|0;if(D=ya(Vi,8)|0,!D)return Tn(Xa),Tn(E),Xa=13,Je=Iu,Xa|0;ua=Di,v[ua>>2]=0,v[ua+4>>2]=0,ua=h,va=v[ua+4>>2]|0,p=V,v[p>>2]=v[ua>>2],v[p+4>>2]=va,p=Nl(V,Vi,ci,f,Di,E,D)|0;e:do if(p)Tn(E),Tn(D),Tn(Xa);else{t:do if((v[re>>2]|0)>0){for(I=h+12|0,S=0;p=Nl((v[I>>2]|0)+(S<<3)|0,Vi,ci,f,Di,E,D)|0,S=S+1|0,!(p|0);)if((S|0)>=(v[re>>2]|0))break t;Tn(E),Tn(D),Tn(Xa);break e}while(0);(ci|0)>0|(ci|0)==0&Vi>>>0>0&&St(D|0,0,Vi<<3|0)|0,va=Di,ua=v[va+4>>2]|0;t:do if((ua|0)>0|(ua|0)==0&(v[va>>2]|0)>>>0>0){Kr=E,pn=D,Pa=E,ua=D,va=E,p=E,Yt=E,rn=D,xn=D,E=D;r:for(;;){for($t=0,qt=0,Wt=0,rr=0,S=0,I=0;;){D=Wa,V=D+56|0;do v[D>>2]=0,D=D+4|0;while((D|0)<(V|0));if(f=Kr+($t<<3)|0,re=v[f>>2]|0,f=v[f+4>>2]|0,c0(re,f,1,Wa,0)|0){D=Wa,V=D+56|0;do v[D>>2]=0,D=D+4|0;while((D|0)<(V|0));D=ya(7,4)|0,D|0&&(zu(re,f,1,Wa,D,7,0,0)|0,Tn(D))}for(_t=0;;){rt=Wa+(_t<<3)|0,gt=v[rt>>2]|0,rt=v[rt+4>>2]|0;n:do if((gt|0)==0&(rt|0)==0)D=S,V=I;else{if(xe=Jo(gt|0,rt|0,Vi|0,ci|0)|0,re=lt()|0,D=m+(xe<<3)|0,f=D,V=v[f>>2]|0,f=v[f+4>>2]|0,!((V|0)==0&(f|0)==0)){Fe=0,ut=0;do{if((Fe|0)>(ci|0)|(Fe|0)==(ci|0)&ut>>>0>Vi>>>0)break r;if((V|0)==(gt|0)&(f|0)==(rt|0)){D=S,V=I;break n}D=un(xe|0,re|0,1,0)|0,xe=Xt(D|0,lt()|0,Vi|0,ci|0)|0,re=lt()|0,ut=un(ut|0,Fe|0,1,0)|0,Fe=lt()|0,D=m+(xe<<3)|0,f=D,V=v[f>>2]|0,f=v[f+4>>2]|0}while(!((V|0)==0&(f|0)==0))}(gt|0)==0&(rt|0)==0?(D=S,V=I):(Os(gt,rt,Qn)|0,Vt(h,Xa,Qn)|0&&(ut=un(S|0,I|0,1,0)|0,I=lt()|0,Fe=D,v[Fe>>2]=gt,v[Fe+4>>2]=rt,S=pn+(S<<3)|0,v[S>>2]=gt,v[S+4>>2]=rt,S=ut),D=S,V=I)}while(0);if(_t=_t+1|0,_t>>>0>=7)break;S=D,I=V}if($t=un($t|0,qt|0,1,0)|0,qt=lt()|0,Wt=un(Wt|0,rr|0,1,0)|0,rr=lt()|0,I=Di,S=v[I>>2]|0,I=v[I+4>>2]|0,(rr|0)<(I|0)|(rr|0)==(I|0)&Wt>>>0<S>>>0)S=D,I=V;else break}if((I|0)>0|(I|0)==0&S>>>0>0){S=0,I=0;do rr=Kr+(S<<3)|0,v[rr>>2]=0,v[rr+4>>2]=0,S=un(S|0,I|0,1,0)|0,I=lt()|0,rr=Di,Wt=v[rr+4>>2]|0;while((I|0)<(Wt|0)|((I|0)==(Wt|0)?S>>>0<(v[rr>>2]|0)>>>0:0))}if(rr=Di,v[rr>>2]=D,v[rr+4>>2]=V,(V|0)>0|(V|0)==0&D>>>0>0)_t=E,$t=xn,qt=va,Wt=rn,rr=pn,E=Yt,xn=p,rn=Pa,Yt=_t,p=$t,va=ua,ua=qt,Pa=Wt,pn=Kr,Kr=rr;else break t}Tn(Pa),Tn(ua),Tn(Xa),p=1;break e}else p=D;while(0);Tn(Xa),Tn(E),Tn(p),p=0}while(0);return Xa=p,Je=Iu,Xa|0}function af(h,f,p){h=h|0,f=f|0,p=p|0;var m=0,E=0,S=0,I=0,D=0,V=0,re=0,xe=0;if(xe=Je,Je=Je+176|0,V=xe,(f|0)<1)return gi(p,0,0),re=0,Je=xe,re|0;for(D=h,D=ft(v[D>>2]|0,v[D+4>>2]|0,52)|0,lt()|0,gi(p,(f|0)>6?f:6,D&15),D=0;m=h+(D<<3)|0,m=Dc(v[m>>2]|0,v[m+4>>2]|0,V)|0,!(m|0);){if(m=v[V>>2]|0,(m|0)>0){I=0;do S=V+8+(I<<4)|0,I=I+1|0,m=V+8+(((I|0)%(m|0)|0)<<4)|0,E=Io(p,m,S)|0,E?ro(p,E)|0:Ti(p,S,m)|0,m=v[V>>2]|0;while((I|0)<(m|0))}if(D=D+1|0,(D|0)>=(f|0)){m=0,re=13;break}}return(re|0)==13?(Je=xe,m|0):(ta(p),re=m,Je=xe,re|0)}function f0(h,f,p){h=h|0,f=f|0,p=p|0;var m=0,E=0,S=0,I=0;if(S=Je,Je=Je+32|0,m=S,E=S+16|0,h=af(h,f,E)|0,h|0)return p=h,Je=S,p|0;if(v[p>>2]=0,v[p+4>>2]=0,v[p+8>>2]=0,h=bo(E)|0,h|0)do{f=_0(p)|0;do Ce(f,h)|0,I=h+16|0,v[m>>2]=v[I>>2],v[m+4>>2]=v[I+4>>2],v[m+8>>2]=v[I+8>>2],v[m+12>>2]=v[I+12>>2],ro(E,h)|0,h=Na(E,m)|0;while(h|0);h=bo(E)|0}while(h|0);return ta(E),h=mt(p)|0,h?(Qe(p),I=h,Je=S,I|0):(I=0,Je=S,I|0)}function oa(h){return h=h|0,h>>>0>121?(h=0,h|0):(h=v[7696+(h*28|0)+16>>2]|0,h|0)}function Ua(h){return h=h|0,(h|0)==4|(h|0)==117|0}function Go(h){return h=h|0,v[11120+((v[h>>2]|0)*216|0)+((v[h+4>>2]|0)*72|0)+((v[h+8>>2]|0)*24|0)+(v[h+12>>2]<<3)>>2]|0}function Uf(h){return h=h|0,v[11120+((v[h>>2]|0)*216|0)+((v[h+4>>2]|0)*72|0)+((v[h+8>>2]|0)*24|0)+(v[h+12>>2]<<3)+4>>2]|0}function G0(h,f){h=h|0,f=f|0,h=7696+(h*28|0)|0,v[f>>2]=v[h>>2],v[f+4>>2]=v[h+4>>2],v[f+8>>2]=v[h+8>>2],v[f+12>>2]=v[h+12>>2]}function Gf(h,f){h=h|0,f=f|0;var p=0,m=0;if(f>>>0>20)return f=-1,f|0;do if((v[11120+(f*216|0)>>2]|0)!=(h|0))if((v[11120+(f*216|0)+8>>2]|0)!=(h|0))if((v[11120+(f*216|0)+16>>2]|0)!=(h|0))if((v[11120+(f*216|0)+24>>2]|0)!=(h|0))if((v[11120+(f*216|0)+32>>2]|0)!=(h|0))if((v[11120+(f*216|0)+40>>2]|0)!=(h|0))if((v[11120+(f*216|0)+48>>2]|0)!=(h|0))if((v[11120+(f*216|0)+56>>2]|0)!=(h|0))if((v[11120+(f*216|0)+64>>2]|0)!=(h|0))if((v[11120+(f*216|0)+72>>2]|0)!=(h|0))if((v[11120+(f*216|0)+80>>2]|0)!=(h|0))if((v[11120+(f*216|0)+88>>2]|0)!=(h|0))if((v[11120+(f*216|0)+96>>2]|0)!=(h|0))if((v[11120+(f*216|0)+104>>2]|0)!=(h|0))if((v[11120+(f*216|0)+112>>2]|0)!=(h|0))if((v[11120+(f*216|0)+120>>2]|0)!=(h|0))if((v[11120+(f*216|0)+128>>2]|0)!=(h|0))if((v[11120+(f*216|0)+136>>2]|0)==(h|0))h=2,p=1,m=2;else{if((v[11120+(f*216|0)+144>>2]|0)==(h|0)){h=0,p=2,m=0;break}if((v[11120+(f*216|0)+152>>2]|0)==(h|0)){h=0,p=2,m=1;break}if((v[11120+(f*216|0)+160>>2]|0)==(h|0)){h=0,p=2,m=2;break}if((v[11120+(f*216|0)+168>>2]|0)==(h|0)){h=1,p=2,m=0;break}if((v[11120+(f*216|0)+176>>2]|0)==(h|0)){h=1,p=2,m=1;break}if((v[11120+(f*216|0)+184>>2]|0)==(h|0)){h=1,p=2,m=2;break}if((v[11120+(f*216|0)+192>>2]|0)==(h|0)){h=2,p=2,m=0;break}if((v[11120+(f*216|0)+200>>2]|0)==(h|0)){h=2,p=2,m=1;break}if((v[11120+(f*216|0)+208>>2]|0)==(h|0)){h=2,p=2,m=2;break}else h=-1;return h|0}else h=2,p=1,m=1;else h=2,p=1,m=0;else h=1,p=1,m=2;else h=1,p=1,m=1;else h=1,p=1,m=0;else h=0,p=1,m=2;else h=0,p=1,m=1;else h=0,p=1,m=0;else h=2,p=0,m=2;else h=2,p=0,m=1;else h=2,p=0,m=0;else h=1,p=0,m=2;else h=1,p=0,m=1;else h=1,p=0,m=0;else h=0,p=0,m=2;else h=0,p=0,m=1;else h=0,p=0,m=0;while(0);return f=v[11120+(f*216|0)+(p*72|0)+(h*24|0)+(m<<3)+4>>2]|0,f|0}function h0(h,f){return h=h|0,f=f|0,(v[7696+(h*28|0)+20>>2]|0)==(f|0)?(f=1,f|0):(f=(v[7696+(h*28|0)+24>>2]|0)==(f|0),f|0)}function jf(h,f){return h=h|0,f=f|0,v[848+(h*28|0)+(f<<2)>>2]|0}function Xi(h,f){return h=h|0,f=f|0,(v[848+(h*28|0)>>2]|0)==(f|0)?(f=0,f|0):(v[848+(h*28|0)+4>>2]|0)==(f|0)?(f=1,f|0):(v[848+(h*28|0)+8>>2]|0)==(f|0)?(f=2,f|0):(v[848+(h*28|0)+12>>2]|0)==(f|0)?(f=3,f|0):(v[848+(h*28|0)+16>>2]|0)==(f|0)?(f=4,f|0):(v[848+(h*28|0)+20>>2]|0)==(f|0)?(f=5,f|0):((v[848+(h*28|0)+24>>2]|0)==(f|0)?6:7)|0}function Vf(){return 122}function Fl(h){h=h|0;var f=0,p=0,m=0;f=0;do Et(f|0,0,45)|0,m=lt()|0|134225919,p=h+(f<<3)|0,v[p>>2]=-1,v[p+4>>2]=m,f=f+1|0;while((f|0)!=122);return 0}function au(h){return h=h|0,+Xe[h+16>>3]<+Xe[h+24>>3]|0}function ic(h,f){h=h|0,f=f|0;var p=0,m=0,E=0;return p=+Xe[f>>3],!(p>=+Xe[h+8>>3])||!(p<=+Xe[h>>3])?(f=0,f|0):(m=+Xe[h+16>>3],p=+Xe[h+24>>3],E=+Xe[f+8>>3],f=E>=p,h=E<=m&1,m<p?f&&(h=1):f||(h=0),f=(h|0)!=0,f|0)}function oo(h,f,p){h=h|0,f=f|0,p=p|0;var m=0,E=0,S=0,I=0,D=0,V=0,re=0,xe=0,Fe=0,ut=0,gt=0,rt=0,_t=0,$t=0;rt=Je,Je=Je+288|0,xe=rt+264|0,Fe=rt+96|0,re=rt,D=re,V=D+96|0;do v[D>>2]=0,D=D+4|0;while((D|0)<(V|0));return f=lf(f,re)|0,f|0?(gt=f,Je=rt,gt|0):(V=re,re=v[V>>2]|0,V=v[V+4>>2]|0,Os(re,V,xe)|0,Dc(re,V,Fe)|0,I=+cl(xe,Fe+8|0),Xe[xe>>3]=+Xe[h>>3],V=xe+8|0,Xe[V>>3]=+Xe[h+16>>3],Xe[Fe>>3]=+Xe[h+8>>3],re=Fe+8|0,Xe[re>>3]=+Xe[h+24>>3],E=+cl(xe,Fe),$t=+Xe[V>>3]-+Xe[re>>3],S=+sa(+$t),_t=+Xe[xe>>3]-+Xe[Fe>>3],m=+sa(+_t),!($t==0|_t==0)&&($t=+Ur(+S,+m),$t=+Fi(+(E*E/+Un(+($t/+Un(+S,+m)),3)/(I*(I*2.59807621135)*.8))),Xe[Ia>>3]=$t,ut=~~$t>>>0,gt=+sa($t)>=1?$t>0?~~+An(+xo($t/4294967296),4294967295)>>>0:~~+Fi(($t-+(~~$t>>>0))/4294967296)>>>0:0,(v[Ia+4>>2]&2146435072|0)!=2146435072)?(Fe=(ut|0)==0&(gt|0)==0,f=p,v[f>>2]=Fe?1:ut,v[f+4>>2]=Fe?0:gt,f=0):f=1,gt=f,Je=rt,gt|0)}function Uu(h,f,p,m){h=h|0,f=f|0,p=p|0,m=m|0;var E=0,S=0,I=0,D=0,V=0,re=0,xe=0;re=Je,Je=Je+288|0,I=re+264|0,D=re+96|0,V=re,E=V,S=E+96|0;do v[E>>2]=0,E=E+4|0;while((E|0)<(S|0));return p=lf(p,V)|0,p|0?(m=p,Je=re,m|0):(p=V,E=v[p>>2]|0,p=v[p+4>>2]|0,Os(E,p,I)|0,Dc(E,p,D)|0,xe=+cl(I,D+8|0),xe=+Fi(+(+cl(h,f)/(xe*2))),Xe[Ia>>3]=xe,p=~~xe>>>0,E=+sa(xe)>=1?xe>0?~~+An(+xo(xe/4294967296),4294967295)>>>0:~~+Fi((xe-+(~~xe>>>0))/4294967296)>>>0:0,(v[Ia+4>>2]&2146435072|0)==2146435072?(m=1,Je=re,m|0):(V=(p|0)==0&(E|0)==0,v[m>>2]=V?1:p,v[m+4>>2]=V?0:E,m=0,Je=re,m|0))}function Bl(h,f,p,m){h=h|0,f=f|0,p=p|0,m=m|0,v[h>>2]=f,v[h+4>>2]=p,v[h+8>>2]=m}function Sf(h,f){h=h|0,f=f|0;var p=0,m=0,E=0,S=0,I=0,D=0,V=0,re=0,xe=0,Fe=0,ut=0;Fe=f+8|0,v[Fe>>2]=0,V=+Xe[h>>3],I=+sa(+V),re=+Xe[h+8>>3],D=+sa(+re)/.8660254037844386,I=I+D*.5,p=~~I,h=~~D,I=I-+(p|0),D=D-+(h|0);do if(I<.5)if(I<.3333333333333333)if(v[f>>2]=p,D<(I+1)*.5){v[f+4>>2]=h;break}else{h=h+1|0,v[f+4>>2]=h;break}else if(ut=1-I,h=(!(D<ut)&1)+h|0,v[f+4>>2]=h,ut<=D&D<I*2){p=p+1|0,v[f>>2]=p;break}else{v[f>>2]=p;break}else{if(!(I<.6666666666666666))if(p=p+1|0,v[f>>2]=p,D<I*.5){v[f+4>>2]=h;break}else{h=h+1|0,v[f+4>>2]=h;break}if(D<1-I){if(v[f+4>>2]=h,I*2+-1<D){v[f>>2]=p;break}}else h=h+1|0,v[f+4>>2]=h;p=p+1|0,v[f>>2]=p}while(0);do if(V<0)if(h&1){xe=(h+1|0)/2|0,xe=da(p|0,((p|0)<0)<<31>>31|0,xe|0,((xe|0)<0)<<31>>31|0)|0,p=~~(+(p|0)-((+(xe>>>0)+4294967296*+(lt()|0))*2+1)),v[f>>2]=p;break}else{xe=(h|0)/2|0,xe=da(p|0,((p|0)<0)<<31>>31|0,xe|0,((xe|0)<0)<<31>>31|0)|0,p=~~(+(p|0)-(+(xe>>>0)+4294967296*+(lt()|0))*2),v[f>>2]=p;break}while(0);xe=f+4|0,re<0&&(p=p-((h<<1|1|0)/2|0)|0,v[f>>2]=p,h=0-h|0,v[xe>>2]=h),m=h-p|0,(p|0)<0?(E=0-p|0,v[xe>>2]=m,v[Fe>>2]=E,v[f>>2]=0,h=m,p=0):E=0,(h|0)<0&&(p=p-h|0,v[f>>2]=p,E=E-h|0,v[Fe>>2]=E,v[xe>>2]=0,h=0),S=p-E|0,m=h-E|0,(E|0)<0&&(v[f>>2]=S,v[xe>>2]=m,v[Fe>>2]=0,h=m,p=S,E=0),m=(h|0)<(p|0)?h:p,m=(E|0)<(m|0)?E:m,!((m|0)<=0)&&(v[f>>2]=p-m,v[xe>>2]=h-m,v[Fe>>2]=E-m)}function Mo(h){h=h|0;var f=0,p=0,m=0,E=0,S=0,I=0;f=v[h>>2]|0,I=h+4|0,p=v[I>>2]|0,(f|0)<0&&(p=p-f|0,v[I>>2]=p,S=h+8|0,v[S>>2]=(v[S>>2]|0)-f,v[h>>2]=0,f=0),(p|0)<0?(f=f-p|0,v[h>>2]=f,S=h+8|0,E=(v[S>>2]|0)-p|0,v[S>>2]=E,v[I>>2]=0,p=0):(E=h+8|0,S=E,E=v[E>>2]|0),(E|0)<0&&(f=f-E|0,v[h>>2]=f,p=p-E|0,v[I>>2]=p,v[S>>2]=0,E=0),m=(p|0)<(f|0)?p:f,m=(E|0)<(m|0)?E:m,!((m|0)<=0)&&(v[h>>2]=f-m,v[I>>2]=p-m,v[S>>2]=E-m)}function ol(h,f){h=h|0,f=f|0;var p=0,m=0;m=v[h+8>>2]|0,p=+((v[h+4>>2]|0)-m|0),Xe[f>>3]=+((v[h>>2]|0)-m|0)-p*.5,Xe[f+8>>3]=p*.8660254037844386}function ss(h,f,p){h=h|0,f=f|0,p=p|0,v[p>>2]=(v[f>>2]|0)+(v[h>>2]|0),v[p+4>>2]=(v[f+4>>2]|0)+(v[h+4>>2]|0),v[p+8>>2]=(v[f+8>>2]|0)+(v[h+8>>2]|0)}function ac(h,f,p){h=h|0,f=f|0,p=p|0,v[p>>2]=(v[h>>2]|0)-(v[f>>2]|0),v[p+4>>2]=(v[h+4>>2]|0)-(v[f+4>>2]|0),v[p+8>>2]=(v[h+8>>2]|0)-(v[f+8>>2]|0)}function Cc(h,f){h=h|0,f=f|0;var p=0,m=0;p=wi(v[h>>2]|0,f)|0,v[h>>2]=p,p=h+4|0,m=wi(v[p>>2]|0,f)|0,v[p>>2]=m,h=h+8|0,f=wi(v[h>>2]|0,f)|0,v[h>>2]=f}function Zl(h){h=h|0;var f=0,p=0,m=0,E=0,S=0,I=0,D=0;I=v[h>>2]|0,D=(I|0)<0,m=(v[h+4>>2]|0)-(D?I:0)|0,S=(m|0)<0,E=(S?0-m|0:0)+((v[h+8>>2]|0)-(D?I:0))|0,p=(E|0)<0,h=p?0:E,f=(S?0:m)-(p?E:0)|0,E=(D?0:I)-(S?m:0)-(p?E:0)|0,p=(f|0)<(E|0)?f:E,p=(h|0)<(p|0)?h:p,m=(p|0)>0,h=h-(m?p:0)|0,f=f-(m?p:0)|0;e:do switch(E-(m?p:0)|0){case 0:switch(f|0){case 0:return D=h|0?(h|0)==1?1:7:0,D|0;case 1:return D=h|0?(h|0)==1?3:7:2,D|0;default:break e}case 1:switch(f|0){case 0:return D=h|0?(h|0)==1?5:7:4,D|0;case 1:{if(!h)h=6;else break e;return h|0}default:break e}default:}while(0);return D=7,D|0}function A0(h){h=h|0;var f=0,p=0,m=0,E=0,S=0,I=0,D=0;I=h+8|0,E=v[I>>2]|0,S=(v[h>>2]|0)-E|0,D=h+4|0,E=(v[D>>2]|0)-E|0;do if(S>>>0>715827881|E>>>0>715827881){if(p=(S|0)>0,p){if((2147483647-S|0)<(S|0)||(2147483647-(S<<1)|0)<(S|0))return D=1,D|0}else if((-2147483648-S|0)>(S|0)||(-2147483648-(S<<1)|0)>(S|0))return D=1,D|0;if(f=S*3|0,(E|0)>0){if((2147483647-E|0)<(E|0))return D=1,D|0}else if((-2147483648-E|0)>(E|0))return D=1,D|0;if(m=E<<1,(S|0)>-1){if((f|-2147483648|0)>=(E|0))return D=1,D|0}else if((f^-2147483648|0)<(E|0))return D=1,D|0;if(p){if((2147483647-S|0)<(m|0))f=1;else{p=m;break}return f|0}else{if((-2147483648-S|0)>(m|0))f=1;else{p=m;break}return f|0}}else p=E<<1,f=S*3|0;while(0);m=Fa(+(f-E|0)/7)|0,v[h>>2]=m,E=Fa(+(p+S|0)/7)|0,v[D>>2]=E,v[I>>2]=0,p=(E|0)<(m|0),f=p?m:E,p=p?E:m;do if((p|0)<0){if((f|0)>0){if((f|-2147483648|0)<(p|0)&((p|0)!=-2147483648&(2147483647-f|0)>=(p|0)))break;ii(23313,22444,355,22455)}if((p|0)==-2147483648|(-2147483648-f|0)>(p|0)&&ii(23313,22444,355,22455),(f|0)>-1){if((f|-2147483648|0)<(p|0))break;ii(23313,22444,355,22455)}else{if((f^-2147483648|0)>=(p|0))break;ii(23313,22444,355,22455)}}while(0);return f=E-m|0,(m|0)<0?(p=0-m|0,v[D>>2]=f,v[I>>2]=p,v[h>>2]=0,m=0):(f=E,p=0),(f|0)<0&&(m=m-f|0,v[h>>2]=m,p=p-f|0,v[I>>2]=p,v[D>>2]=0,f=0),S=m-p|0,E=f-p|0,(p|0)<0?(v[h>>2]=S,v[D>>2]=E,v[I>>2]=0,f=E,E=S,p=0):E=m,m=(f|0)<(E|0)?f:E,m=(p|0)<(m|0)?p:m,(m|0)<=0?(D=0,D|0):(v[h>>2]=E-m,v[D>>2]=f-m,v[I>>2]=p-m,D=0,D|0)}function Hf(h){h=h|0;var f=0,p=0,m=0,E=0,S=0,I=0,D=0;I=h+8|0,E=v[I>>2]|0,S=(v[h>>2]|0)-E|0,D=h+4|0,E=(v[D>>2]|0)-E|0;do if(S>>>0>715827881|E>>>0>715827881){if(p=(S|0)>0,p){if((2147483647-S|0)<(S|0))return D=1,D|0}else if((-2147483648-S|0)>(S|0))return D=1,D|0;if(f=S<<1,(E|0)>0){if((2147483647-E|0)<(E|0)||(2147483647-(E<<1)|0)<(E|0))return D=1,D|0}else if((-2147483648-E|0)>(E|0)||(-2147483648-(E<<1)|0)>(E|0))return D=1,D|0;if(m=E*3|0,p){if((2147483647-f|0)<(E|0))return D=1,D|0}else if((-2147483648-f|0)>(E|0))return D=1,D|0;if((E|0)>-1){if((m|-2147483648|0)<(S|0)){p=m;break}else f=1;return f|0}else{if((m^-2147483648|0)<(S|0))f=1;else{p=m;break}return f|0}}else p=E*3|0,f=S<<1;while(0);m=Fa(+(f+E|0)/7)|0,v[h>>2]=m,E=Fa(+(p-S|0)/7)|0,v[D>>2]=E,v[I>>2]=0,p=(E|0)<(m|0),f=p?m:E,p=p?E:m;do if((p|0)<0){if((f|0)>0){if((f|-2147483648|0)<(p|0)&((p|0)!=-2147483648&(2147483647-f|0)>=(p|0)))break;ii(23313,22444,404,22469)}if((p|0)==-2147483648|(-2147483648-f|0)>(p|0)&&ii(23313,22444,404,22469),(f|0)>-1){if((f|-2147483648|0)<(p|0))break;ii(23313,22444,404,22469)}else{if((f^-2147483648|0)>=(p|0))break;ii(23313,22444,404,22469)}}while(0);return f=E-m|0,(m|0)<0?(p=0-m|0,v[D>>2]=f,v[I>>2]=p,v[h>>2]=0,m=0):(f=E,p=0),(f|0)<0&&(m=m-f|0,v[h>>2]=m,p=p-f|0,v[I>>2]=p,v[D>>2]=0,f=0),S=m-p|0,E=f-p|0,(p|0)<0?(v[h>>2]=S,v[D>>2]=E,v[I>>2]=0,f=E,E=S,p=0):E=m,m=(f|0)<(E|0)?f:E,m=(p|0)<(m|0)?p:m,(m|0)<=0?(D=0,D|0):(v[h>>2]=E-m,v[D>>2]=f-m,v[I>>2]=p-m,D=0,D|0)}function of(h){h=h|0;var f=0,p=0,m=0,E=0,S=0,I=0,D=0;I=h+8|0,p=v[I>>2]|0,f=(v[h>>2]|0)-p|0,D=h+4|0,p=(v[D>>2]|0)-p|0,m=Fa(+((f*3|0)-p|0)/7)|0,v[h>>2]=m,f=Fa(+((p<<1)+f|0)/7)|0,v[D>>2]=f,v[I>>2]=0,p=f-m|0,(m|0)<0?(S=0-m|0,v[D>>2]=p,v[I>>2]=S,v[h>>2]=0,f=p,m=0,p=S):p=0,(f|0)<0&&(m=m-f|0,v[h>>2]=m,p=p-f|0,v[I>>2]=p,v[D>>2]=0,f=0),S=m-p|0,E=f-p|0,(p|0)<0?(v[h>>2]=S,v[D>>2]=E,v[I>>2]=0,f=E,E=S,p=0):E=m,m=(f|0)<(E|0)?f:E,m=(p|0)<(m|0)?p:m,!((m|0)<=0)&&(v[h>>2]=E-m,v[D>>2]=f-m,v[I>>2]=p-m)}function $f(h){h=h|0;var f=0,p=0,m=0,E=0,S=0,I=0,D=0;I=h+8|0,p=v[I>>2]|0,f=(v[h>>2]|0)-p|0,D=h+4|0,p=(v[D>>2]|0)-p|0,m=Fa(+((f<<1)+p|0)/7)|0,v[h>>2]=m,f=Fa(+((p*3|0)-f|0)/7)|0,v[D>>2]=f,v[I>>2]=0,p=f-m|0,(m|0)<0?(S=0-m|0,v[D>>2]=p,v[I>>2]=S,v[h>>2]=0,f=p,m=0,p=S):p=0,(f|0)<0&&(m=m-f|0,v[h>>2]=m,p=p-f|0,v[I>>2]=p,v[D>>2]=0,f=0),S=m-p|0,E=f-p|0,(p|0)<0?(v[h>>2]=S,v[D>>2]=E,v[I>>2]=0,f=E,E=S,p=0):E=m,m=(f|0)<(E|0)?f:E,m=(p|0)<(m|0)?p:m,!((m|0)<=0)&&(v[h>>2]=E-m,v[D>>2]=f-m,v[I>>2]=p-m)}function wc(h){h=h|0;var f=0,p=0,m=0,E=0,S=0,I=0,D=0;f=v[h>>2]|0,I=h+4|0,p=v[I>>2]|0,D=h+8|0,m=v[D>>2]|0,E=p+(f*3|0)|0,v[h>>2]=E,p=m+(p*3|0)|0,v[I>>2]=p,f=(m*3|0)+f|0,v[D>>2]=f,m=p-E|0,(E|0)<0?(f=f-E|0,v[I>>2]=m,v[D>>2]=f,v[h>>2]=0,p=m,m=0):m=E,(p|0)<0&&(m=m-p|0,v[h>>2]=m,f=f-p|0,v[D>>2]=f,v[I>>2]=0,p=0),S=m-f|0,E=p-f|0,(f|0)<0?(v[h>>2]=S,v[I>>2]=E,v[D>>2]=0,m=S,f=0):E=p,p=(E|0)<(m|0)?E:m,p=(f|0)<(p|0)?f:p,!((p|0)<=0)&&(v[h>>2]=m-p,v[I>>2]=E-p,v[D>>2]=f-p)}function Tu(h){h=h|0;var f=0,p=0,m=0,E=0,S=0,I=0,D=0;E=v[h>>2]|0,I=h+4|0,f=v[I>>2]|0,D=h+8|0,p=v[D>>2]|0,m=(f*3|0)+E|0,E=p+(E*3|0)|0,v[h>>2]=E,v[I>>2]=m,f=(p*3|0)+f|0,v[D>>2]=f,p=m-E|0,(E|0)<0?(f=f-E|0,v[I>>2]=p,v[D>>2]=f,v[h>>2]=0,E=0):p=m,(p|0)<0&&(E=E-p|0,v[h>>2]=E,f=f-p|0,v[D>>2]=f,v[I>>2]=0,p=0),S=E-f|0,m=p-f|0,(f|0)<0?(v[h>>2]=S,v[I>>2]=m,v[D>>2]=0,E=S,f=0):m=p,p=(m|0)<(E|0)?m:E,p=(f|0)<(p|0)?f:p,!((p|0)<=0)&&(v[h>>2]=E-p,v[I>>2]=m-p,v[D>>2]=f-p)}function Tc(h,f){h=h|0,f=f|0;var p=0,m=0,E=0,S=0,I=0,D=0;(f+-1|0)>>>0>=6||(E=(v[15440+(f*12|0)>>2]|0)+(v[h>>2]|0)|0,v[h>>2]=E,D=h+4|0,m=(v[15440+(f*12|0)+4>>2]|0)+(v[D>>2]|0)|0,v[D>>2]=m,I=h+8|0,f=(v[15440+(f*12|0)+8>>2]|0)+(v[I>>2]|0)|0,v[I>>2]=f,p=m-E|0,(E|0)<0?(f=f-E|0,v[D>>2]=p,v[I>>2]=f,v[h>>2]=0,m=0):(p=m,m=E),(p|0)<0&&(m=m-p|0,v[h>>2]=m,f=f-p|0,v[I>>2]=f,v[D>>2]=0,p=0),S=m-f|0,E=p-f|0,(f|0)<0?(v[h>>2]=S,v[D>>2]=E,v[I>>2]=0,m=S,f=0):E=p,p=(E|0)<(m|0)?E:m,p=(f|0)<(p|0)?f:p,!((p|0)<=0)&&(v[h>>2]=m-p,v[D>>2]=E-p,v[I>>2]=f-p))}function Gu(h){h=h|0;var f=0,p=0,m=0,E=0,S=0,I=0,D=0;E=v[h>>2]|0,I=h+4|0,f=v[I>>2]|0,D=h+8|0,p=v[D>>2]|0,m=f+E|0,E=p+E|0,v[h>>2]=E,v[I>>2]=m,f=p+f|0,v[D>>2]=f,p=m-E|0,(E|0)<0?(f=f-E|0,v[I>>2]=p,v[D>>2]=f,v[h>>2]=0,m=0):(p=m,m=E),(p|0)<0&&(m=m-p|0,v[h>>2]=m,f=f-p|0,v[D>>2]=f,v[I>>2]=0,p=0),S=m-f|0,E=p-f|0,(f|0)<0?(v[h>>2]=S,v[I>>2]=E,v[D>>2]=0,m=S,f=0):E=p,p=(E|0)<(m|0)?E:m,p=(f|0)<(p|0)?f:p,!((p|0)<=0)&&(v[h>>2]=m-p,v[I>>2]=E-p,v[D>>2]=f-p)}function sl(h){h=h|0;var f=0,p=0,m=0,E=0,S=0,I=0,D=0;f=v[h>>2]|0,I=h+4|0,m=v[I>>2]|0,D=h+8|0,p=v[D>>2]|0,E=m+f|0,v[h>>2]=E,m=p+m|0,v[I>>2]=m,f=p+f|0,v[D>>2]=f,p=m-E|0,(E|0)<0?(f=f-E|0,v[I>>2]=p,v[D>>2]=f,v[h>>2]=0,m=0):(p=m,m=E),(p|0)<0&&(m=m-p|0,v[h>>2]=m,f=f-p|0,v[D>>2]=f,v[I>>2]=0,p=0),S=m-f|0,E=p-f|0,(f|0)<0?(v[h>>2]=S,v[I>>2]=E,v[D>>2]=0,m=S,f=0):E=p,p=(E|0)<(m|0)?E:m,p=(f|0)<(p|0)?f:p,!((p|0)<=0)&&(v[h>>2]=m-p,v[I>>2]=E-p,v[D>>2]=f-p)}function Mc(h){switch(h=h|0,h|0){case 1:{h=5;break}case 5:{h=4;break}case 4:{h=6;break}case 6:{h=2;break}case 2:{h=3;break}case 3:{h=1;break}default:}return h|0}function Sl(h){switch(h=h|0,h|0){case 1:{h=3;break}case 3:{h=2;break}case 2:{h=6;break}case 6:{h=4;break}case 4:{h=5;break}case 5:{h=1;break}default:}return h|0}function p0(h){h=h|0;var f=0,p=0,m=0,E=0,S=0,I=0,D=0;f=v[h>>2]|0,I=h+4|0,p=v[I>>2]|0,D=h+8|0,m=v[D>>2]|0,E=p+(f<<1)|0,v[h>>2]=E,p=m+(p<<1)|0,v[I>>2]=p,f=(m<<1)+f|0,v[D>>2]=f,m=p-E|0,(E|0)<0?(f=f-E|0,v[I>>2]=m,v[D>>2]=f,v[h>>2]=0,p=m,m=0):m=E,(p|0)<0&&(m=m-p|0,v[h>>2]=m,f=f-p|0,v[D>>2]=f,v[I>>2]=0,p=0),S=m-f|0,E=p-f|0,(f|0)<0?(v[h>>2]=S,v[I>>2]=E,v[D>>2]=0,m=S,f=0):E=p,p=(E|0)<(m|0)?E:m,p=(f|0)<(p|0)?f:p,!((p|0)<=0)&&(v[h>>2]=m-p,v[I>>2]=E-p,v[D>>2]=f-p)}function j0(h){h=h|0;var f=0,p=0,m=0,E=0,S=0,I=0,D=0;E=v[h>>2]|0,I=h+4|0,f=v[I>>2]|0,D=h+8|0,p=v[D>>2]|0,m=(f<<1)+E|0,E=p+(E<<1)|0,v[h>>2]=E,v[I>>2]=m,f=(p<<1)+f|0,v[D>>2]=f,p=m-E|0,(E|0)<0?(f=f-E|0,v[I>>2]=p,v[D>>2]=f,v[h>>2]=0,E=0):p=m,(p|0)<0&&(E=E-p|0,v[h>>2]=E,f=f-p|0,v[D>>2]=f,v[I>>2]=0,p=0),S=E-f|0,m=p-f|0,(f|0)<0?(v[h>>2]=S,v[I>>2]=m,v[D>>2]=0,E=S,f=0):m=p,p=(m|0)<(E|0)?m:E,p=(f|0)<(p|0)?f:p,!((p|0)<=0)&&(v[h>>2]=E-p,v[I>>2]=m-p,v[D>>2]=f-p)}function oc(h,f){h=h|0,f=f|0;var p=0,m=0,E=0,S=0,I=0,D=0;return I=(v[h>>2]|0)-(v[f>>2]|0)|0,D=(I|0)<0,m=(v[h+4>>2]|0)-(v[f+4>>2]|0)-(D?I:0)|0,S=(m|0)<0,E=(D?0-I|0:0)+(v[h+8>>2]|0)-(v[f+8>>2]|0)+(S?0-m|0:0)|0,h=(E|0)<0,f=h?0:E,p=(S?0:m)-(h?E:0)|0,E=(D?0:I)-(S?m:0)-(h?E:0)|0,h=(p|0)<(E|0)?p:E,h=(f|0)<(h|0)?f:h,m=(h|0)>0,f=f-(m?h:0)|0,p=p-(m?h:0)|0,h=E-(m?h:0)|0,h=(h|0)>-1?h:0-h|0,p=(p|0)>-1?p:0-p|0,f=(f|0)>-1?f:0-f|0,f=(p|0)>(f|0)?p:f,((h|0)>(f|0)?h:f)|0}function Sh(h,f){h=h|0,f=f|0;var p=0;p=v[h+8>>2]|0,v[f>>2]=(v[h>>2]|0)-p,v[f+4>>2]=(v[h+4>>2]|0)-p}function Ch(h,f){h=h|0,f=f|0;var p=0,m=0,E=0,S=0,I=0,D=0;m=v[h>>2]|0,v[f>>2]=m,E=v[h+4>>2]|0,I=f+4|0,v[I>>2]=E,D=f+8|0,v[D>>2]=0,p=(E|0)<(m|0),h=p?m:E,p=p?E:m;do if((p|0)<0){if((h|0)>0){if((h|-2147483648|0)<(p|0)&((p|0)!=-2147483648&(2147483647-h|0)>=(p|0)))break;return h=1,h|0}if((p|0)==-2147483648|(-2147483648-h|0)>(p|0))return f=1,f|0;if((h|0)>-1){if((h|-2147483648|0)<(p|0))break;return h=1,h|0}else{if((h^-2147483648|0)<(p|0))h=1;else break;return h|0}}while(0);return h=E-m|0,(m|0)<0?(p=0-m|0,v[I>>2]=h,v[D>>2]=p,v[f>>2]=0,m=0):(h=E,p=0),(h|0)<0&&(m=m-h|0,v[f>>2]=m,p=p-h|0,v[D>>2]=p,v[I>>2]=0,h=0),S=m-p|0,E=h-p|0,(p|0)<0?(v[f>>2]=S,v[I>>2]=E,v[D>>2]=0,h=E,E=S,p=0):E=m,m=(h|0)<(E|0)?h:E,m=(p|0)<(m|0)?p:m,(m|0)<=0?(f=0,f|0):(v[f>>2]=E-m,v[I>>2]=h-m,v[D>>2]=p-m,f=0,f|0)}function V0(h){h=h|0;var f=0,p=0,m=0,E=0;f=h+8|0,E=v[f>>2]|0,p=E-(v[h>>2]|0)|0,v[h>>2]=p,m=h+4|0,h=(v[m>>2]|0)-E|0,v[m>>2]=h,v[f>>2]=0-(h+p)}function d0(h){h=h|0;var f=0,p=0,m=0,E=0,S=0,I=0,D=0;p=v[h>>2]|0,f=0-p|0,v[h>>2]=f,I=h+8|0,v[I>>2]=0,D=h+4|0,m=v[D>>2]|0,E=m+p|0,(p|0)>0?(v[D>>2]=E,v[I>>2]=p,v[h>>2]=0,f=0,m=E):p=0,(m|0)<0?(S=f-m|0,v[h>>2]=S,p=p-m|0,v[I>>2]=p,v[D>>2]=0,E=S-p|0,f=0-p|0,(p|0)<0?(v[h>>2]=E,v[D>>2]=f,v[I>>2]=0,m=f,p=0):(m=0,E=S)):E=f,f=(m|0)<(E|0)?m:E,f=(p|0)<(f|0)?p:f,!((f|0)<=0)&&(v[h>>2]=E-f,v[D>>2]=m-f,v[I>>2]=p-f)}function v0(h,f,p,m,E){h=h|0,f=f|0,p=p|0,m=m|0,E=E|0;var S=0,I=0,D=0,V=0,re=0,xe=0,Fe=0;if(Fe=Je,Je=Je+64|0,xe=Fe,D=Fe+56|0,!(!0&(f&2013265920|0)==134217728&(!0&(m&2013265920|0)==134217728)))return E=5,Je=Fe,E|0;if((h|0)==(p|0)&(f|0)==(m|0))return v[E>>2]=0,E=0,Je=Fe,E|0;if(I=ft(h|0,f|0,52)|0,lt()|0,I=I&15,re=ft(p|0,m|0,52)|0,lt()|0,(I|0)!=(re&15|0))return E=12,Je=Fe,E|0;if(S=I+-1|0,I>>>0>1){Gl(h,f,S,xe)|0,Gl(p,m,S,D)|0,re=xe,V=v[re>>2]|0,re=v[re+4>>2]|0;e:do if((V|0)==(v[D>>2]|0)&&(re|0)==(v[D+4>>2]|0)){I=(I^15)*3|0,S=ft(h|0,f|0,I|0)|0,lt()|0,S=S&7,I=ft(p|0,m|0,I|0)|0,lt()|0,I=I&7;do if((S|0)==0|(I|0)==0)v[E>>2]=1,S=0;else if((S|0)==7)S=5;else{if((S|0)==1|(I|0)==1&&pa(V,re)|0){S=5;break}if((v[15536+(S<<2)>>2]|0)!=(I|0)&&(v[15568+(S<<2)>>2]|0)!=(I|0))break e;v[E>>2]=1,S=0}while(0);return E=S,Je=Fe,E|0}while(0)}S=xe,I=S+56|0;do v[S>>2]=0,S=S+4|0;while((S|0)<(I|0));return bf(h,f,1,xe)|0,f=xe,!((v[f>>2]|0)==(p|0)&&(v[f+4>>2]|0)==(m|0))&&(f=xe+8|0,!((v[f>>2]|0)==(p|0)&&(v[f+4>>2]|0)==(m|0)))&&(f=xe+16|0,!((v[f>>2]|0)==(p|0)&&(v[f+4>>2]|0)==(m|0)))&&(f=xe+24|0,!((v[f>>2]|0)==(p|0)&&(v[f+4>>2]|0)==(m|0)))&&(f=xe+32|0,!((v[f>>2]|0)==(p|0)&&(v[f+4>>2]|0)==(m|0)))&&(f=xe+40|0,!((v[f>>2]|0)==(p|0)&&(v[f+4>>2]|0)==(m|0)))?(S=xe+48|0,S=((v[S>>2]|0)==(p|0)?(v[S+4>>2]|0)==(m|0):0)&1):S=1,v[E>>2]=S,E=0,Je=Fe,E|0}function wh(h,f,p,m,E){return h=h|0,f=f|0,p=p|0,m=m|0,E=E|0,p=Zf(h,f,p,m)|0,(p|0)==7?(E=11,E|0):(m=Et(p|0,0,56)|0,f=f&-2130706433|(lt()|0)|268435456,v[E>>2]=h|m,v[E+4>>2]=f,E=0,E|0)}function yA(h,f,p){return h=h|0,f=f|0,p=p|0,!0&(f&2013265920|0)==268435456?(v[p>>2]=h,v[p+4>>2]=f&-2130706433|134217728,p=0,p|0):(p=6,p|0)}function H0(h,f,p){h=h|0,f=f|0,p=p|0;var m=0,E=0,S=0;return E=Je,Je=Je+16|0,m=E,v[m>>2]=0,!0&(f&2013265920|0)==268435456?(S=ft(h|0,f|0,56)|0,lt()|0,m=Uo(h,f&-2130706433|134217728,S&7,m,p)|0,Je=E,m|0):(m=6,Je=E,m|0)}function Th(h,f){h=h|0,f=f|0;var p=0;switch(p=ft(h|0,f|0,56)|0,lt()|0,p&7){case 0:case 7:return p=0,p|0;default:}return p=f&-2130706433|134217728,!(!0&(f&2013265920|0)==268435456)||!0&(f&117440512|0)==16777216&(pa(h,p)|0)!=0?(p=0,p|0):(p=sf(h,p)|0,p|0)}function sc(h,f,p){h=h|0,f=f|0,p=p|0;var m=0,E=0,S=0,I=0;return E=Je,Je=Je+16|0,m=E,!0&(f&2013265920|0)==268435456?(S=f&-2130706433|134217728,I=p,v[I>>2]=h,v[I+4>>2]=S,v[m>>2]=0,f=ft(h|0,f|0,56)|0,lt()|0,m=Uo(h,S,f&7,m,p+8|0)|0,Je=E,m|0):(m=6,Je=E,m|0)}function $0(h,f,p){h=h|0,f=f|0,p=p|0;var m=0,E=0;return E=(pa(h,f)|0)==0,f=f&-2130706433,m=p,v[m>>2]=E?h:0,v[m+4>>2]=E?f|285212672:0,m=p+8|0,v[m>>2]=h,v[m+4>>2]=f|301989888,m=p+16|0,v[m>>2]=h,v[m+4>>2]=f|318767104,m=p+24|0,v[m>>2]=h,v[m+4>>2]=f|335544320,m=p+32|0,v[m>>2]=h,v[m+4>>2]=f|352321536,p=p+40|0,v[p>>2]=h,v[p+4>>2]=f|369098752,0}function Cf(h,f,p){h=h|0,f=f|0,p=p|0;var m=0,E=0,S=0,I=0;return I=Je,Je=Je+16|0,E=I,S=f&-2130706433|134217728,!0&(f&2013265920|0)==268435456?(m=ft(h|0,f|0,56)|0,lt()|0,m=gr(h,S,m&7)|0,(m|0)==-1?(v[p>>2]=0,S=6,Je=I,S|0):(Yl(h,S,E)|0&&ii(23313,22484,282,22499),f=ft(h|0,f|0,52)|0,lt()|0,f=f&15,pa(h,S)|0?wf(E,f,m,2,p):uc(E,f,m,2,p),S=0,Je=I,S|0)):(S=6,Je=I,S|0)}function _A(h,f,p){h=h|0,f=f|0,p=p|0;var m=0,E=0;m=Je,Je=Je+16|0,E=m,xA(h,f,p,E),Sf(E,p+4|0),Je=m}function xA(h,f,p,m){h=h|0,f=f|0,p=p|0,m=m|0;var E=0,S=0,I=0,D=0,V=0;if(D=Je,Je=Je+16|0,V=D,Y0(h,p,V),S=+Yn(+(1-+Xe[V>>3]*.5)),S<1e-16){v[m>>2]=0,v[m+4>>2]=0,v[m+8>>2]=0,v[m+12>>2]=0,Je=D;return}if(V=v[p>>2]|0,E=+Xe[15920+(V*24|0)>>3],E=+ia(E-+ia(+W0(15600+(V<<4)|0,h))),ou(f)|0?I=+ia(E+-.3334731722518321):I=E,E=+hn(+S)/.381966011250105,(f|0)>0){h=0;do E=E*2.6457513110645907,h=h+1|0;while((h|0)!=(f|0))}S=+ba(+I)*E,Xe[m>>3]=S,I=+Vr(+I)*E,Xe[m+8>>3]=I,Je=D}function Y0(h,f,p){h=h|0,f=f|0,p=p|0;var m=0,E=0,S=0;if(S=Je,Je=Je+32|0,E=S,Fr(h,E),v[f>>2]=0,Xe[p>>3]=5,m=+Ir(16400,E),m<+Xe[p>>3]&&(v[f>>2]=0,Xe[p>>3]=m),m=+Ir(16424,E),m<+Xe[p>>3]&&(v[f>>2]=1,Xe[p>>3]=m),m=+Ir(16448,E),m<+Xe[p>>3]&&(v[f>>2]=2,Xe[p>>3]=m),m=+Ir(16472,E),m<+Xe[p>>3]&&(v[f>>2]=3,Xe[p>>3]=m),m=+Ir(16496,E),m<+Xe[p>>3]&&(v[f>>2]=4,Xe[p>>3]=m),m=+Ir(16520,E),m<+Xe[p>>3]&&(v[f>>2]=5,Xe[p>>3]=m),m=+Ir(16544,E),m<+Xe[p>>3]&&(v[f>>2]=6,Xe[p>>3]=m),m=+Ir(16568,E),m<+Xe[p>>3]&&(v[f>>2]=7,Xe[p>>3]=m),m=+Ir(16592,E),m<+Xe[p>>3]&&(v[f>>2]=8,Xe[p>>3]=m),m=+Ir(16616,E),m<+Xe[p>>3]&&(v[f>>2]=9,Xe[p>>3]=m),m=+Ir(16640,E),m<+Xe[p>>3]&&(v[f>>2]=10,Xe[p>>3]=m),m=+Ir(16664,E),m<+Xe[p>>3]&&(v[f>>2]=11,Xe[p>>3]=m),m=+Ir(16688,E),m<+Xe[p>>3]&&(v[f>>2]=12,Xe[p>>3]=m),m=+Ir(16712,E),m<+Xe[p>>3]&&(v[f>>2]=13,Xe[p>>3]=m),m=+Ir(16736,E),m<+Xe[p>>3]&&(v[f>>2]=14,Xe[p>>3]=m),m=+Ir(16760,E),m<+Xe[p>>3]&&(v[f>>2]=15,Xe[p>>3]=m),m=+Ir(16784,E),m<+Xe[p>>3]&&(v[f>>2]=16,Xe[p>>3]=m),m=+Ir(16808,E),m<+Xe[p>>3]&&(v[f>>2]=17,Xe[p>>3]=m),m=+Ir(16832,E),m<+Xe[p>>3]&&(v[f>>2]=18,Xe[p>>3]=m),m=+Ir(16856,E),!(m<+Xe[p>>3])){Je=S;return}v[f>>2]=19,Xe[p>>3]=m,Je=S}function Ic(h,f,p,m,E){h=h|0,f=f|0,p=p|0,m=m|0,E=E|0;var S=0,I=0;if(S=+Wr(h),S<1e-16){f=15600+(f<<4)|0,v[E>>2]=v[f>>2],v[E+4>>2]=v[f+4>>2],v[E+8>>2]=v[f+8>>2],v[E+12>>2]=v[f+12>>2];return}if(I=+Ln(+ +Xe[h+8>>3],+ +Xe[h>>3]),(p|0)>0){h=0;do S=S/2.6457513110645907,h=h+1|0;while((h|0)!=(p|0))}m?(S=S/3,p=(ou(p)|0)==0,S=+Kn(+((p?S:S/2.6457513110645907)*.381966011250105))):(S=+Kn(+(S*.381966011250105)),ou(p)|0&&(I=+ia(I+.3334731722518321))),Nc(15600+(f<<4)|0,+ia(+Xe[15920+(f*24|0)>>3]-I),S,E)}function Pc(h,f,p){h=h|0,f=f|0,p=p|0;var m=0,E=0;m=Je,Je=Je+16|0,E=m,ol(h+4|0,E),Ic(E,v[h>>2]|0,f,0,p),Je=m}function wf(h,f,p,m,E){h=h|0,f=f|0,p=p|0,m=m|0,E=E|0;var S=0,I=0,D=0,V=0,re=0,xe=0,Fe=0,ut=0,gt=0,rt=0,_t=0,$t=0,qt=0,Wt=0,rr=0,Yt=0,rn=0,xn=0,Kr=0,pn=0,Pa=0,ua=0,va=0,Vi=0,ci=0,Di=0,Wa=0,Qn=0;if(Di=Je,Je=Je+272|0,S=Di+256|0,Wt=Di+240|0,va=Di,Vi=Di+224|0,ci=Di+208|0,rr=Di+176|0,Yt=Di+160|0,rn=Di+192|0,xn=Di+144|0,Kr=Di+128|0,pn=Di+112|0,Pa=Di+96|0,ua=Di+80|0,v[S>>2]=f,v[Wt>>2]=v[h>>2],v[Wt+4>>2]=v[h+4>>2],v[Wt+8>>2]=v[h+8>>2],v[Wt+12>>2]=v[h+12>>2],Eo(Wt,S,va),v[E>>2]=0,Wt=m+p+((m|0)==5&1)|0,(Wt|0)<=(p|0)){Je=Di;return}V=v[S>>2]|0,re=Vi+4|0,xe=rr+4|0,Fe=p+5|0,ut=16880+(V<<2)|0,gt=16960+(V<<2)|0,rt=Kr+8|0,_t=pn+8|0,$t=Pa+8|0,qt=ci+4|0,D=p;e:for(;;){I=va+(((D|0)%5|0)<<4)|0,v[ci>>2]=v[I>>2],v[ci+4>>2]=v[I+4>>2],v[ci+8>>2]=v[I+8>>2],v[ci+12>>2]=v[I+12>>2];do;while((Xs(ci,V,0,1)|0)==2);if((D|0)>(p|0)&(ou(f)|0)!=0){if(v[rr>>2]=v[ci>>2],v[rr+4>>2]=v[ci+4>>2],v[rr+8>>2]=v[ci+8>>2],v[rr+12>>2]=v[ci+12>>2],ol(re,Yt),m=v[rr>>2]|0,S=v[17040+(m*80|0)+(v[Vi>>2]<<2)>>2]|0,v[rr>>2]=v[18640+(m*80|0)+(S*20|0)>>2],I=v[18640+(m*80|0)+(S*20|0)+16>>2]|0,(I|0)>0){h=0;do Gu(xe),h=h+1|0;while((h|0)<(I|0))}switch(I=18640+(m*80|0)+(S*20|0)+4|0,v[rn>>2]=v[I>>2],v[rn+4>>2]=v[I+4>>2],v[rn+8>>2]=v[I+8>>2],Cc(rn,(v[ut>>2]|0)*3|0),ss(xe,rn,xe),Mo(xe),ol(xe,xn),Wa=+(v[gt>>2]|0),Xe[Kr>>3]=Wa*3,Xe[rt>>3]=0,Qn=Wa*-1.5,Xe[pn>>3]=Qn,Xe[_t>>3]=Wa*2.598076211353316,Xe[Pa>>3]=Qn,Xe[$t>>3]=Wa*-2.598076211353316,v[17040+((v[rr>>2]|0)*80|0)+(v[ci>>2]<<2)>>2]|0){case 1:{h=pn,m=Kr;break}case 3:{h=Pa,m=pn;break}case 2:{h=Kr,m=Pa;break}default:{h=12;break e}}Cn(Yt,xn,m,h,ua),Ic(ua,v[rr>>2]|0,V,1,E+8+(v[E>>2]<<4)|0),v[E>>2]=(v[E>>2]|0)+1}if((D|0)<(Fe|0)&&(ol(qt,rr),Ic(rr,v[ci>>2]|0,V,1,E+8+(v[E>>2]<<4)|0),v[E>>2]=(v[E>>2]|0)+1),v[Vi>>2]=v[ci>>2],v[Vi+4>>2]=v[ci+4>>2],v[Vi+8>>2]=v[ci+8>>2],v[Vi+12>>2]=v[ci+12>>2],D=D+1|0,(D|0)>=(Wt|0)){h=3;break}}if((h|0)==3){Je=Di;return}else(h|0)==12&&ii(22522,22569,571,22579)}function Eo(h,f,p){h=h|0,f=f|0,p=p|0;var m=0,E=0,S=0,I=0,D=0,V=0;V=Je,Je=Je+128|0,m=V+64|0,E=V,S=m,I=20240,D=S+60|0;do v[S>>2]=v[I>>2],S=S+4|0,I=I+4|0;while((S|0)<(D|0));S=E,I=20304,D=S+60|0;do v[S>>2]=v[I>>2],S=S+4|0,I=I+4|0;while((S|0)<(D|0));D=(ou(v[f>>2]|0)|0)==0,m=D?m:E,E=h+4|0,p0(E),j0(E),ou(v[f>>2]|0)|0&&(Tu(E),v[f>>2]=(v[f>>2]|0)+1),v[p>>2]=v[h>>2],f=p+4|0,ss(E,m,f),Mo(f),v[p+16>>2]=v[h>>2],f=p+20|0,ss(E,m+12|0,f),Mo(f),v[p+32>>2]=v[h>>2],f=p+36|0,ss(E,m+24|0,f),Mo(f),v[p+48>>2]=v[h>>2],f=p+52|0,ss(E,m+36|0,f),Mo(f),v[p+64>>2]=v[h>>2],p=p+68|0,ss(E,m+48|0,p),Mo(p),Je=V}function Xs(h,f,p,m){h=h|0,f=f|0,p=p|0,m=m|0;var E=0,S=0,I=0,D=0,V=0,re=0,xe=0,Fe=0,ut=0,gt=0,rt=0;if(rt=Je,Je=Je+32|0,ut=rt+12|0,D=rt,gt=h+4|0,Fe=v[16960+(f<<2)>>2]|0,xe=(m|0)!=0,Fe=xe?Fe*3|0:Fe,E=v[gt>>2]|0,re=h+8|0,I=v[re>>2]|0,xe){if(S=h+12|0,m=v[S>>2]|0,E=I+E+m|0,(E|0)==(Fe|0))return gt=1,Je=rt,gt|0;V=S}else V=h+12|0,m=v[V>>2]|0,E=I+E+m|0;if((E|0)<=(Fe|0))return gt=0,Je=rt,gt|0;do if((m|0)>0){if(m=v[h>>2]|0,(I|0)>0){S=18640+(m*80|0)+60|0,m=h;break}m=18640+(m*80|0)+40|0,p?(Bl(ut,Fe,0,0),ac(gt,ut,D),sl(D),ss(D,ut,gt),S=m,m=h):(S=m,m=h)}else S=18640+((v[h>>2]|0)*80|0)+20|0,m=h;while(0);if(v[m>>2]=v[S>>2],E=S+16|0,(v[E>>2]|0)>0){m=0;do Gu(gt),m=m+1|0;while((m|0)<(v[E>>2]|0))}return h=S+4|0,v[ut>>2]=v[h>>2],v[ut+4>>2]=v[h+4>>2],v[ut+8>>2]=v[h+8>>2],f=v[16880+(f<<2)>>2]|0,Cc(ut,xe?f*3|0:f),ss(gt,ut,gt),Mo(gt),xe?m=((v[re>>2]|0)+(v[gt>>2]|0)+(v[V>>2]|0)|0)==(Fe|0)?1:2:m=2,gt=m,Je=rt,gt|0}function zl(h,f){h=h|0,f=f|0;var p=0;do p=Xs(h,f,0,1)|0;while((p|0)==2);return p|0}function uc(h,f,p,m,E){h=h|0,f=f|0,p=p|0,m=m|0,E=E|0;var S=0,I=0,D=0,V=0,re=0,xe=0,Fe=0,ut=0,gt=0,rt=0,_t=0,$t=0,qt=0,Wt=0,rr=0,Yt=0,rn=0,xn=0,Kr=0,pn=0,Pa=0,ua=0,va=0;if(Pa=Je,Je=Je+240|0,S=Pa+224|0,rn=Pa+208|0,xn=Pa,Kr=Pa+192|0,pn=Pa+176|0,$t=Pa+160|0,qt=Pa+144|0,Wt=Pa+128|0,rr=Pa+112|0,Yt=Pa+96|0,v[S>>2]=f,v[rn>>2]=v[h>>2],v[rn+4>>2]=v[h+4>>2],v[rn+8>>2]=v[h+8>>2],v[rn+12>>2]=v[h+12>>2],ul(rn,S,xn),v[E>>2]=0,_t=m+p+((m|0)==6&1)|0,(_t|0)<=(p|0)){Je=Pa;return}V=v[S>>2]|0,re=p+6|0,xe=16960+(V<<2)|0,Fe=qt+8|0,ut=Wt+8|0,gt=rr+8|0,rt=Kr+4|0,I=0,D=p,m=-1;e:for(;;){if(S=(D|0)%6|0,h=xn+(S<<4)|0,v[Kr>>2]=v[h>>2],v[Kr+4>>2]=v[h+4>>2],v[Kr+8>>2]=v[h+8>>2],v[Kr+12>>2]=v[h+12>>2],h=I,I=Xs(Kr,V,0,1)|0,(D|0)>(p|0)&(ou(f)|0)!=0&&(h|0)!=1&&(v[Kr>>2]|0)!=(m|0)){switch(ol(xn+(((S+5|0)%6|0)<<4)+4|0,pn),ol(xn+(S<<4)+4|0,$t),ua=+(v[xe>>2]|0),Xe[qt>>3]=ua*3,Xe[Fe>>3]=0,va=ua*-1.5,Xe[Wt>>3]=va,Xe[ut>>3]=ua*2.598076211353316,Xe[rr>>3]=va,Xe[gt>>3]=ua*-2.598076211353316,S=v[rn>>2]|0,v[17040+(S*80|0)+(((m|0)==(S|0)?v[Kr>>2]|0:m)<<2)>>2]|0){case 1:{h=Wt,m=qt;break}case 3:{h=rr,m=Wt;break}case 2:{h=qt,m=rr;break}default:{h=8;break e}}Cn(pn,$t,m,h,Yt),!(Xn(pn,Yt)|0)&&!(Xn($t,Yt)|0)&&(Ic(Yt,v[rn>>2]|0,V,1,E+8+(v[E>>2]<<4)|0),v[E>>2]=(v[E>>2]|0)+1)}if((D|0)<(re|0)&&(ol(rt,pn),Ic(pn,v[Kr>>2]|0,V,1,E+8+(v[E>>2]<<4)|0),v[E>>2]=(v[E>>2]|0)+1),D=D+1|0,(D|0)>=(_t|0)){h=3;break}else m=v[Kr>>2]|0}if((h|0)==3){Je=Pa;return}else(h|0)==8&&ii(22606,22569,736,22651)}function ul(h,f,p){h=h|0,f=f|0,p=p|0;var m=0,E=0,S=0,I=0,D=0,V=0;V=Je,Je=Je+160|0,m=V+80|0,E=V,S=m,I=20368,D=S+72|0;do v[S>>2]=v[I>>2],S=S+4|0,I=I+4|0;while((S|0)<(D|0));S=E,I=20448,D=S+72|0;do v[S>>2]=v[I>>2],S=S+4|0,I=I+4|0;while((S|0)<(D|0));D=(ou(v[f>>2]|0)|0)==0,m=D?m:E,E=h+4|0,p0(E),j0(E),ou(v[f>>2]|0)|0&&(Tu(E),v[f>>2]=(v[f>>2]|0)+1),v[p>>2]=v[h>>2],f=p+4|0,ss(E,m,f),Mo(f),v[p+16>>2]=v[h>>2],f=p+20|0,ss(E,m+12|0,f),Mo(f),v[p+32>>2]=v[h>>2],f=p+36|0,ss(E,m+24|0,f),Mo(f),v[p+48>>2]=v[h>>2],f=p+52|0,ss(E,m+36|0,f),Mo(f),v[p+64>>2]=v[h>>2],f=p+68|0,ss(E,m+48|0,f),Mo(f),v[p+80>>2]=v[h>>2],p=p+84|0,ss(E,m+60|0,p),Mo(p),Je=V}function Ul(h,f){return h=h|0,f=f|0,f=ft(h|0,f|0,52)|0,lt()|0,f&15|0}function Lc(h,f){return h=h|0,f=f|0,f=ft(h|0,f|0,45)|0,lt()|0,f&127|0}function sf(h,f){h=h|0,f=f|0;var p=0,m=0,E=0,S=0,I=0,D=0;if(!(!0&(f&-16777216|0)==134217728)||(I=ft(h|0,f|0,45)|0,lt()|0,I=I&127,I>>>0>121))return f=0,f|0;p=ft(h|0,f|0,52)|0,lt()|0,p=p&15;do if(p|0){for(E=1,m=0;;){if(S=ft(h|0,f|0,(15-E|0)*3|0)|0,lt()|0,S=S&7,(S|0)!=0&(m^1))if((S|0)==1&(oa(I)|0)!=0){D=0,m=13;break}else m=1;if((S|0)==7){D=0,m=13;break}if(E>>>0<p>>>0)E=E+1|0;else{m=9;break}}if((m|0)==9){if((p|0)==15)D=1;else break;return D|0}else if((m|0)==13)return D|0}while(0);for(;;){if(D=ft(h|0,f|0,(14-p|0)*3|0)|0,lt()|0,!((D&7|0)==7&!0)){D=0,m=13;break}if(p>>>0<14)p=p+1|0;else{D=1,m=13;break}}return(m|0)==13?D|0:0}function Gl(h,f,p,m){h=h|0,f=f|0,p=p|0,m=m|0;var E=0,S=0;if(S=ft(h|0,f|0,52)|0,lt()|0,S=S&15,p>>>0>15)return m=4,m|0;if((S|0)<(p|0))return m=12,m|0;if((S|0)==(p|0))return v[m>>2]=h,v[m+4>>2]=f,m=0,m|0;if(E=Et(p|0,0,52)|0,E=E|h,h=lt()|0|f&-15728641,(S|0)>(p|0))do f=Et(7,0,(14-p|0)*3|0)|0,p=p+1|0,E=f|E,h=lt()|0|h;while((p|0)<(S|0));return v[m>>2]=E,v[m+4>>2]=h,m=0,m|0}function Cl(h,f,p,m){h=h|0,f=f|0,p=p|0,m=m|0;var E=0,S=0,I=0;if(S=ft(h|0,f|0,52)|0,lt()|0,S=S&15,!((p|0)<16&(S|0)<=(p|0)))return m=4,m|0;E=p-S|0,p=ft(h|0,f|0,45)|0,lt()|0;e:do if(!(oa(p&127)|0))p=Or(7,0,E,((E|0)<0)<<31>>31)|0,E=lt()|0;else{t:do if(S|0){for(p=1;I=Et(7,0,(15-p|0)*3|0)|0,!!((I&h|0)==0&((lt()|0)&f|0)==0);)if(p>>>0<S>>>0)p=p+1|0;else break t;p=Or(7,0,E,((E|0)<0)<<31>>31)|0,E=lt()|0;break e}while(0);p=Or(7,0,E,((E|0)<0)<<31>>31)|0,p=Ri(p|0,lt()|0,5,0)|0,p=un(p|0,lt()|0,-5,-1)|0,p=mi(p|0,lt()|0,6,0)|0,p=un(p|0,lt()|0,1,0)|0,E=lt()|0}while(0);return I=m,v[I>>2]=p,v[I+4>>2]=E,I=0,I|0}function pa(h,f){h=h|0,f=f|0;var p=0,m=0,E=0;if(E=ft(h|0,f|0,45)|0,lt()|0,!(oa(E&127)|0))return E=0,E|0;E=ft(h|0,f|0,52)|0,lt()|0,E=E&15;e:do if(!E)p=0;else for(m=1;;){if(p=ft(h|0,f|0,(15-m|0)*3|0)|0,lt()|0,p=p&7,p|0)break e;if(m>>>0<E>>>0)m=m+1|0;else{p=0;break}}while(0);return E=(p|0)==0&1,E|0}function Oc(h,f,p,m){h=h|0,f=f|0,p=p|0,m=m|0;var E=0,S=0,I=0,D=0;if(I=Je,Je=Je+16|0,S=I,ms(S,h,f,p),f=S,h=v[f>>2]|0,f=v[f+4>>2]|0,(h|0)==0&(f|0)==0)return Je=I,0;E=0,p=0;do D=m+(E<<3)|0,v[D>>2]=h,v[D+4>>2]=f,E=un(E|0,p|0,1,0)|0,p=lt()|0,ll(S),D=S,h=v[D>>2]|0,f=v[D+4>>2]|0;while(!((h|0)==0&(f|0)==0));return Je=I,0}function jl(h,f,p,m){return h=h|0,f=f|0,p=p|0,m=m|0,(m|0)<(p|0)?(p=f,m=h,Bi(p|0),m|0):(p=Et(-1,-1,((m-p|0)*3|0)+3|0)|0,m=Et(~p|0,~(lt()|0)|0,(15-m|0)*3|0)|0,p=~(lt()|0)&f,m=~m&h,Bi(p|0),m|0)}function lc(h,f,p,m){h=h|0,f=f|0,p=p|0,m=m|0;var E=0;return E=ft(h|0,f|0,52)|0,lt()|0,E=E&15,(p|0)<16&(E|0)<=(p|0)?((E|0)<(p|0)&&(E=Et(-1,-1,((p+-1-E|0)*3|0)+3|0)|0,E=Et(~E|0,~(lt()|0)|0,(15-p|0)*3|0)|0,f=~(lt()|0)&f,h=~E&h),E=Et(p|0,0,52)|0,p=f&-15728641|(lt()|0),v[m>>2]=h|E,v[m+4>>2]=p,m=0,m|0):(m=4,m|0)}function Vl(h,f,p,m){h=h|0,f=f|0,p=p|0,m=m|0;var E=0,S=0,I=0,D=0,V=0,re=0,xe=0,Fe=0,ut=0,gt=0,rt=0,_t=0,$t=0,qt=0,Wt=0,rr=0,Yt=0,rn=0,xn=0,Kr=0,pn=0;if((p|0)==0&(m|0)==0)return Kr=0,Kr|0;if(E=h,S=v[E>>2]|0,E=v[E+4>>2]|0,!0&(E&15728640|0)==0){if(!((m|0)>0|(m|0)==0&p>>>0>0)||(Kr=f,v[Kr>>2]=S,v[Kr+4>>2]=E,(p|0)==1&(m|0)==0))return Kr=0,Kr|0;E=1;do rn=h+(E<<3)|0,xn=v[rn+4>>2]|0,Kr=f+(E<<3)|0,v[Kr>>2]=v[rn>>2],v[Kr+4>>2]=xn,E=E+1|0;while(0<(m|0)|(m|0)==0&E>>>0<p>>>0);return E=0,E|0}if(Yt=p<<3,xn=Ga(Yt)|0,!xn)return Kr=13,Kr|0;if(Ye(xn|0,h|0,Yt|0)|0,rn=ya(p,8)|0,!rn)return Tn(xn),Kr=13,Kr|0;e:do if(p|0){t:for(;;){E=xn,qt=v[E>>2]|0,E=v[E+4>>2]|0,Wt=ft(qt|0,E|0,52)|0,lt()|0,Wt=Wt&15,rr=Wt+-1|0,$t=(p|0)>0;r:do if((Wt|0)!=0&$t){if(gt=((p|0)<0)<<31>>31,rt=Et(rr|0,0,52)|0,_t=lt()|0,rr>>>0>15){if(!((qt|0)==0&(E|0)==0)){Kr=17;break t}for(S=0;;){if(S=S+1|0,(S|0)>=(p|0))break r;if(m=xn+(S<<3)|0,_t=v[m>>2]|0,m=v[m+4>>2]|0,!((_t|0)==0&(m|0)==0)){E=m,Kr=17;break t}}}for(S=0,h=qt,m=E;;){if(!((h|0)==0&(m|0)==0)){if(!(!0&(m&117440512|0)==0)){Kr=22;break t}if(D=ft(h|0,m|0,52)|0,lt()|0,D=D&15,(D|0)<(rr|0)){E=12,Kr=28;break t}if((D|0)!=(rr|0)&&(h=h|rt,m=m&-15728641|_t,D>>>0>=Wt>>>0)){I=rr;do ut=Et(7,0,(14-I|0)*3|0)|0,I=I+1|0,h=ut|h,m=lt()|0|m;while(I>>>0<D>>>0)}if(I=Jo(h|0,m|0,p|0,gt|0)|0,lt()|0,re=rn+(I<<3)|0,D=re,V=v[D>>2]|0,D=v[D+4>>2]|0,(V|0)==0&(D|0)==0)I=re;else for(ut=0;;){if((ut|0)>(p|0)){Kr=32;break t}if((V|0)==(h|0)&(D&-117440513|0)==(m|0)){xe=ft(V|0,D|0,56)|0,lt()|0,xe=xe&7,Fe=xe+1|0,pn=ft(V|0,D|0,45)|0,lt()|0;n:do if(!(oa(pn&127)|0))D=7;else{if(V=ft(V|0,D|0,52)|0,lt()|0,V=V&15,!V){D=6;break}for(D=1;;){if(pn=Et(7,0,(15-D|0)*3|0)|0,!((pn&h|0)==0&((lt()|0)&m|0)==0)){D=7;break n}if(D>>>0<V>>>0)D=D+1|0;else{D=6;break}}}while(0);if((xe+2|0)>>>0>D>>>0){Kr=42;break t}pn=Et(Fe|0,0,56)|0,m=lt()|0|m&-117440513,Fe=re,v[Fe>>2]=0,v[Fe+4>>2]=0,h=pn|h}else I=(I+1|0)%(p|0)|0;if(re=rn+(I<<3)|0,D=re,V=v[D>>2]|0,D=v[D+4>>2]|0,(V|0)==0&(D|0)==0){I=re;break}else ut=ut+1|0}pn=I,v[pn>>2]=h,v[pn+4>>2]=m}if(S=S+1|0,(S|0)>=(p|0))break r;m=xn+(S<<3)|0,h=v[m>>2]|0,m=v[m+4>>2]|0}}while(0);if((p+5|0)>>>0<11){Kr=85;break}if(_t=ya((p|0)/6|0,8)|0,!_t){Kr=49;break}r:do if($t){ut=0,Fe=0;do{if(D=rn+(ut<<3)|0,m=D,S=v[m>>2]|0,m=v[m+4>>2]|0,!((S|0)==0&(m|0)==0)){V=ft(S|0,m|0,56)|0,lt()|0,V=V&7,h=V+1|0,re=m&-117440513,pn=ft(S|0,m|0,45)|0,lt()|0;n:do if(oa(pn&127)|0){if(xe=ft(S|0,m|0,52)|0,lt()|0,xe=xe&15,xe|0)for(I=1;;){if(pn=Et(7,0,(15-I|0)*3|0)|0,!((S&pn|0)==0&(re&(lt()|0)|0)==0))break n;if(I>>>0<xe>>>0)I=I+1|0;else break}m=Et(h|0,0,56)|0,S=m|S,m=lt()|0|re,h=D,v[h>>2]=S,v[h+4>>2]=m,h=V+2|0}while(0);(h|0)==7&&(pn=_t+(Fe<<3)|0,v[pn>>2]=S,v[pn+4>>2]=m&-117440513,Fe=Fe+1|0)}ut=ut+1|0}while((ut|0)!=(p|0));if($t){if(ut=((p|0)<0)<<31>>31,gt=Et(rr|0,0,52)|0,rt=lt()|0,rr>>>0>15){if(!((qt|0)==0&(E|0)==0)){E=4,Kr=84;break t}for(E=0;;){if(E=E+1|0,(E|0)>=(p|0)){S=0,E=Fe;break r}if(pn=xn+(E<<3)|0,!((v[pn>>2]|0)==0&(v[pn+4>>2]|0)==0)){E=4,Kr=84;break t}}}for(xe=0,S=0,re=qt;;){do if(!((re|0)==0&(E|0)==0)){if(D=ft(re|0,E|0,52)|0,lt()|0,D=D&15,(D|0)<(rr|0)){E=12,Kr=84;break t}do if((D|0)==(rr|0))m=re,D=E;else{if(m=re|gt,h=E&-15728641|rt,D>>>0<Wt>>>0){D=h;break}I=rr;do pn=Et(7,0,(14-I|0)*3|0)|0,I=I+1|0,m=pn|m,h=lt()|0|h;while(I>>>0<D>>>0);D=h}while(0);for(I=Jo(m|0,D|0,p|0,ut|0)|0,lt()|0,h=0;;){if((h|0)>(p|0)){Kr=77;break t}if(pn=rn+(I<<3)|0,V=v[pn+4>>2]|0,(V&-117440513|0)==(D|0)&&(v[pn>>2]|0)==(m|0)){Kr=79;break}if(I=(I+1|0)%(p|0)|0,pn=rn+(I<<3)|0,(v[pn>>2]|0)==(m|0)&&(v[pn+4>>2]|0)==(D|0))break;h=h+1|0}if((Kr|0)==79&&(Kr=0,!0&(V&117440512|0)==100663296))break;pn=f+(S<<3)|0,v[pn>>2]=re,v[pn+4>>2]=E,S=S+1|0}while(0);if(E=xe+1|0,(E|0)>=(p|0)){E=Fe;break r}pn=xn+(E<<3)|0,xe=E,re=v[pn>>2]|0,E=v[pn+4>>2]|0}}else S=0,E=Fe}else S=0,E=0;while(0);if(St(rn|0,0,Yt|0)|0,Ye(xn|0,_t|0,E<<3|0)|0,Tn(_t),E)f=f+(S<<3)|0,p=E;else break e}if((Kr|0)==17)!0&(E&117440512|0)==0?(E=4,Kr=28):Kr=22;else if((Kr|0)==32)ii(23313,22674,362,22684);else{if((Kr|0)==42)return Tn(xn),Tn(rn),pn=10,pn|0;if((Kr|0)==49)return Tn(xn),Tn(rn),pn=13,pn|0;if((Kr|0)==77)ii(23313,22674,462,22684);else{if((Kr|0)==84)return Tn(_t),Tn(xn),Tn(rn),pn=E,pn|0;if((Kr|0)==85){Ye(f|0,xn|0,p<<3|0)|0;break}}}if((Kr|0)==22)return Tn(xn),Tn(rn),pn=5,pn|0;if((Kr|0)==28)return Tn(xn),Tn(rn),pn=E,pn|0}while(0);return Tn(xn),Tn(rn),pn=0,pn|0}function Hl(h,f,p,m,E,S,I){h=h|0,f=f|0,p=p|0,m=m|0,E=E|0,S=S|0,I=I|0;var D=0,V=0,re=0,xe=0,Fe=0,ut=0,gt=0,rt=0,_t=0;if(_t=Je,Je=Je+16|0,rt=_t,!((p|0)>0|(p|0)==0&f>>>0>0))return rt=0,Je=_t,rt|0;if((I|0)>=16)return rt=12,Je=_t,rt|0;ut=0,gt=0,Fe=0,D=0;e:for(;;){if(re=h+(ut<<3)|0,V=v[re>>2]|0,re=v[re+4>>2]|0,xe=ft(V|0,re|0,52)|0,lt()|0,(xe&15|0)>(I|0)){D=12,V=11;break}if(ms(rt,V,re,I),xe=rt,re=v[xe>>2]|0,xe=v[xe+4>>2]|0,(re|0)==0&(xe|0)==0)V=Fe;else{V=Fe;do{if(!((D|0)<(S|0)|(D|0)==(S|0)&V>>>0<E>>>0)){V=10;break e}Fe=m+(V<<3)|0,v[Fe>>2]=re,v[Fe+4>>2]=xe,V=un(V|0,D|0,1,0)|0,D=lt()|0,ll(rt),Fe=rt,re=v[Fe>>2]|0,xe=v[Fe+4>>2]|0}while(!((re|0)==0&(xe|0)==0))}if(ut=un(ut|0,gt|0,1,0)|0,gt=lt()|0,(gt|0)<(p|0)|(gt|0)==(p|0)&ut>>>0<f>>>0)Fe=V;else{D=0,V=11;break}}return(V|0)==10?(rt=14,Je=_t,rt|0):(V|0)==11?(Je=_t,D|0):0}function g0(h,f,p,m,E){h=h|0,f=f|0,p=p|0,m=m|0,E=E|0;var S=0,I=0,D=0,V=0,re=0,xe=0,Fe=0,ut=0;ut=Je,Je=Je+16|0,Fe=ut;e:do if((p|0)>0|(p|0)==0&f>>>0>0){for(re=0,I=0,S=0,xe=0;;){if(V=h+(re<<3)|0,D=v[V>>2]|0,V=v[V+4>>2]|0,!((D|0)==0&(V|0)==0)&&(V=(Cl(D,V,m,Fe)|0)==0,D=Fe,I=un(v[D>>2]|0,v[D+4>>2]|0,I|0,S|0)|0,S=lt()|0,!V)){S=12;break}if(re=un(re|0,xe|0,1,0)|0,xe=lt()|0,!((xe|0)<(p|0)|(xe|0)==(p|0)&re>>>0<f>>>0))break e}return Je=ut,S|0}else I=0,S=0;while(0);return v[E>>2]=I,v[E+4>>2]=S,E=0,Je=ut,E|0}function m0(h,f){return h=h|0,f=f|0,f=ft(h|0,f|0,52)|0,lt()|0,f&1|0}function Qs(h,f){h=h|0,f=f|0;var p=0,m=0,E=0;if(E=ft(h|0,f|0,52)|0,lt()|0,E=E&15,!E)return E=0,E|0;for(m=1;;){if(p=ft(h|0,f|0,(15-m|0)*3|0)|0,lt()|0,p=p&7,p|0){m=5;break}if(m>>>0<E>>>0)m=m+1|0;else{p=0,m=5;break}}return(m|0)==5?p|0:0}function Rc(h,f){h=h|0,f=f|0;var p=0,m=0,E=0,S=0,I=0,D=0,V=0;if(V=ft(h|0,f|0,52)|0,lt()|0,V=V&15,!V)return D=f,V=h,Bi(D|0),V|0;for(D=1,p=0;;){S=(15-D|0)*3|0,m=Et(7,0,S|0)|0,E=lt()|0,I=ft(h|0,f|0,S|0)|0,lt()|0,S=Et(Mc(I&7)|0,0,S|0)|0,I=lt()|0,h=S|h&~m,f=I|f&~E;e:do if(!p)if((S&m|0)==0&(I&E|0)==0)p=0;else if(m=ft(h|0,f|0,52)|0,lt()|0,m=m&15,!m)p=1;else{p=1;t:for(;;){switch(I=ft(h|0,f|0,(15-p|0)*3|0)|0,lt()|0,I&7){case 1:break t;case 0:break;default:{p=1;break e}}if(p>>>0<m>>>0)p=p+1|0;else{p=1;break e}}for(p=1;;)if(I=(15-p|0)*3|0,E=ft(h|0,f|0,I|0)|0,lt()|0,S=Et(7,0,I|0)|0,f=f&~(lt()|0),I=Et(Mc(E&7)|0,0,I|0)|0,h=h&~S|I,f=f|(lt()|0),p>>>0<m>>>0)p=p+1|0;else{p=1;break}}while(0);if(D>>>0<V>>>0)D=D+1|0;else break}return Bi(f|0),h|0}function wl(h,f){h=h|0,f=f|0;var p=0,m=0,E=0,S=0,I=0;if(m=ft(h|0,f|0,52)|0,lt()|0,m=m&15,!m)return p=f,m=h,Bi(p|0),m|0;for(p=1;S=(15-p|0)*3|0,I=ft(h|0,f|0,S|0)|0,lt()|0,E=Et(7,0,S|0)|0,f=f&~(lt()|0),S=Et(Mc(I&7)|0,0,S|0)|0,h=S|h&~E,f=lt()|0|f,p>>>0<m>>>0;)p=p+1|0;return Bi(f|0),h|0}function ju(h,f){h=h|0,f=f|0;var p=0,m=0,E=0,S=0,I=0,D=0,V=0;if(V=ft(h|0,f|0,52)|0,lt()|0,V=V&15,!V)return D=f,V=h,Bi(D|0),V|0;for(D=1,p=0;;){S=(15-D|0)*3|0,m=Et(7,0,S|0)|0,E=lt()|0,I=ft(h|0,f|0,S|0)|0,lt()|0,S=Et(Sl(I&7)|0,0,S|0)|0,I=lt()|0,h=S|h&~m,f=I|f&~E;e:do if(!p)if((S&m|0)==0&(I&E|0)==0)p=0;else if(m=ft(h|0,f|0,52)|0,lt()|0,m=m&15,!m)p=1;else{p=1;t:for(;;){switch(I=ft(h|0,f|0,(15-p|0)*3|0)|0,lt()|0,I&7){case 1:break t;case 0:break;default:{p=1;break e}}if(p>>>0<m>>>0)p=p+1|0;else{p=1;break e}}for(p=1;;)if(E=(15-p|0)*3|0,S=Et(7,0,E|0)|0,I=f&~(lt()|0),f=ft(h|0,f|0,E|0)|0,lt()|0,f=Et(Sl(f&7)|0,0,E|0)|0,h=h&~S|f,f=I|(lt()|0),p>>>0<m>>>0)p=p+1|0;else{p=1;break}}while(0);if(D>>>0<V>>>0)D=D+1|0;else break}return Bi(f|0),h|0}function Mu(h,f){h=h|0,f=f|0;var p=0,m=0,E=0,S=0,I=0;if(m=ft(h|0,f|0,52)|0,lt()|0,m=m&15,!m)return p=f,m=h,Bi(p|0),m|0;for(p=1;I=(15-p|0)*3|0,S=Et(7,0,I|0)|0,E=f&~(lt()|0),f=ft(h|0,f|0,I|0)|0,lt()|0,f=Et(Sl(f&7)|0,0,I|0)|0,h=f|h&~S,f=lt()|0|E,p>>>0<m>>>0;)p=p+1|0;return Bi(f|0),h|0}function Yf(h,f){h=h|0,f=f|0;var p=0,m=0,E=0,S=0,I=0,D=0,V=0,re=0,xe=0;if(V=Je,Je=Je+64|0,D=V+40|0,m=V+24|0,E=V+12|0,S=V,Et(f|0,0,52)|0,p=lt()|0|134225919,!f)return(v[h+4>>2]|0)>2||(v[h+8>>2]|0)>2||(v[h+12>>2]|0)>2?(I=0,D=0,Bi(I|0),Je=V,D|0):(Et(Go(h)|0,0,45)|0,I=lt()|0|p,D=-1,Bi(I|0),Je=V,D|0);if(v[D>>2]=v[h>>2],v[D+4>>2]=v[h+4>>2],v[D+8>>2]=v[h+8>>2],v[D+12>>2]=v[h+12>>2],I=D+4|0,(f|0)>0)for(h=-1;v[m>>2]=v[I>>2],v[m+4>>2]=v[I+4>>2],v[m+8>>2]=v[I+8>>2],f&1?(of(I),v[E>>2]=v[I>>2],v[E+4>>2]=v[I+4>>2],v[E+8>>2]=v[I+8>>2],wc(E)):($f(I),v[E>>2]=v[I>>2],v[E+4>>2]=v[I+4>>2],v[E+8>>2]=v[I+8>>2],Tu(E)),ac(m,E,S),Mo(S),xe=(15-f|0)*3|0,re=Et(7,0,xe|0)|0,p=p&~(lt()|0),xe=Et(Zl(S)|0,0,xe|0)|0,h=xe|h&~re,p=lt()|0|p,(f|0)>1;)f=f+-1|0;else h=-1;e:do if((v[I>>2]|0)<=2&&(v[D+8>>2]|0)<=2&&(v[D+12>>2]|0)<=2){if(m=Go(D)|0,f=Et(m|0,0,45)|0,f=f|h,h=lt()|0|p&-1040385,S=Uf(D)|0,!(oa(m)|0)){if((S|0)<=0)break;for(E=0;;){if(m=ft(f|0,h|0,52)|0,lt()|0,m=m&15,m)for(p=1;xe=(15-p|0)*3|0,D=ft(f|0,h|0,xe|0)|0,lt()|0,re=Et(7,0,xe|0)|0,h=h&~(lt()|0),xe=Et(Mc(D&7)|0,0,xe|0)|0,f=f&~re|xe,h=h|(lt()|0),p>>>0<m>>>0;)p=p+1|0;if(E=E+1|0,(E|0)==(S|0))break e}}E=ft(f|0,h|0,52)|0,lt()|0,E=E&15;t:do if(E){p=1;r:for(;;){switch(xe=ft(f|0,h|0,(15-p|0)*3|0)|0,lt()|0,xe&7){case 1:break r;case 0:break;default:break t}if(p>>>0<E>>>0)p=p+1|0;else break t}if(h0(m,v[D>>2]|0)|0)for(p=1;D=(15-p|0)*3|0,re=Et(7,0,D|0)|0,xe=h&~(lt()|0),h=ft(f|0,h|0,D|0)|0,lt()|0,h=Et(Sl(h&7)|0,0,D|0)|0,f=f&~re|h,h=xe|(lt()|0),p>>>0<E>>>0;)p=p+1|0;else for(p=1;xe=(15-p|0)*3|0,D=ft(f|0,h|0,xe|0)|0,lt()|0,re=Et(7,0,xe|0)|0,h=h&~(lt()|0),xe=Et(Mc(D&7)|0,0,xe|0)|0,f=f&~re|xe,h=h|(lt()|0),p>>>0<E>>>0;)p=p+1|0}while(0);if((S|0)>0){p=0;do f=Rc(f,h)|0,h=lt()|0,p=p+1|0;while((p|0)!=(S|0))}}else f=0,h=0;while(0);return re=h,xe=f,Bi(re|0),Je=V,xe|0}function ou(h){return h=h|0,(h|0)%2|0|0}function uf(h,f,p){h=h|0,f=f|0,p=p|0;var m=0,E=0;return E=Je,Je=Je+16|0,m=E,f>>>0>15?(m=4,Je=E,m|0):(v[h+4>>2]&2146435072|0)==2146435072||(v[h+8+4>>2]&2146435072|0)==2146435072?(m=3,Je=E,m|0):(_A(h,f,m),f=Yf(m,f)|0,m=lt()|0,v[p>>2]=f,v[p+4>>2]=m,(f|0)==0&(m|0)==0&&ii(23313,22674,786,22697),m=0,Je=E,m|0)}function $l(h,f,p){h=h|0,f=f|0,p=p|0;var m=0,E=0,S=0,I=0;if(E=p+4|0,S=ft(h|0,f|0,52)|0,lt()|0,S=S&15,I=ft(h|0,f|0,45)|0,lt()|0,m=(S|0)==0,oa(I&127)|0){if(m)return I=1,I|0;m=1}else{if(m)return I=0,I|0;!(v[E>>2]|0)&&!(v[p+8>>2]|0)?m=(v[p+12>>2]|0)!=0&1:m=1}for(p=1;p&1?wc(E):Tu(E),I=ft(h|0,f|0,(15-p|0)*3|0)|0,lt()|0,Tc(E,I&7),p>>>0<S>>>0;)p=p+1|0;return m|0}function Yl(h,f,p){h=h|0,f=f|0,p=p|0;var m=0,E=0,S=0,I=0,D=0,V=0,re=0,xe=0;if(xe=Je,Je=Je+16|0,V=xe,re=ft(h|0,f|0,45)|0,lt()|0,re=re&127,re>>>0>121)return v[p>>2]=0,v[p+4>>2]=0,v[p+8>>2]=0,v[p+12>>2]=0,re=5,Je=xe,re|0;e:do if(oa(re)|0&&(S=ft(h|0,f|0,52)|0,lt()|0,S=S&15,(S|0)!=0)){m=1;t:for(;;){switch(D=ft(h|0,f|0,(15-m|0)*3|0)|0,lt()|0,D&7){case 5:break t;case 0:break;default:{m=f;break e}}if(m>>>0<S>>>0)m=m+1|0;else{m=f;break e}}for(E=1,m=f;f=(15-E|0)*3|0,I=Et(7,0,f|0)|0,D=m&~(lt()|0),m=ft(h|0,m|0,f|0)|0,lt()|0,m=Et(Sl(m&7)|0,0,f|0)|0,h=h&~I|m,m=D|(lt()|0),E>>>0<S>>>0;)E=E+1|0}else m=f;while(0);if(D=7696+(re*28|0)|0,v[p>>2]=v[D>>2],v[p+4>>2]=v[D+4>>2],v[p+8>>2]=v[D+8>>2],v[p+12>>2]=v[D+12>>2],!($l(h,m,p)|0))return re=0,Je=xe,re|0;if(I=p+4|0,v[V>>2]=v[I>>2],v[V+4>>2]=v[I+4>>2],v[V+8>>2]=v[I+8>>2],S=ft(h|0,m|0,52)|0,lt()|0,D=S&15,S&1?(Tu(I),S=D+1|0):S=D,!(oa(re)|0))m=0;else{e:do if(!D)m=0;else for(f=1;;){if(E=ft(h|0,m|0,(15-f|0)*3|0)|0,lt()|0,E=E&7,E|0){m=E;break e}if(f>>>0<D>>>0)f=f+1|0;else{m=0;break}}while(0);m=(m|0)==4&1}if(!(Xs(p,S,m,0)|0))(S|0)!=(D|0)&&(v[I>>2]=v[V>>2],v[I+4>>2]=v[V+4>>2],v[I+8>>2]=v[V+8>>2]);else{if(oa(re)|0)do;while(Xs(p,S,0,0)|0);(S|0)!=(D|0)&&$f(I)}return re=0,Je=xe,re|0}function Os(h,f,p){h=h|0,f=f|0,p=p|0;var m=0,E=0,S=0;return S=Je,Je=Je+16|0,m=S,E=Yl(h,f,m)|0,E|0?(Je=S,E|0):(E=ft(h|0,f|0,52)|0,lt()|0,Pc(m,E&15,p),E=0,Je=S,E|0)}function Dc(h,f,p){h=h|0,f=f|0,p=p|0;var m=0,E=0,S=0,I=0,D=0;if(I=Je,Je=Je+16|0,S=I,m=Yl(h,f,S)|0,m|0)return S=m,Je=I,S|0;m=ft(h|0,f|0,45)|0,lt()|0,m=(oa(m&127)|0)==0,E=ft(h|0,f|0,52)|0,lt()|0,E=E&15;e:do if(!m){if(E|0)for(m=1;;){if(D=Et(7,0,(15-m|0)*3|0)|0,!((D&h|0)==0&((lt()|0)&f|0)==0))break e;if(m>>>0<E>>>0)m=m+1|0;else break}return wf(S,E,0,5,p),D=0,Je=I,D|0}while(0);return uc(S,E,0,6,p),D=0,Je=I,D|0}function kc(h,f,p){h=h|0,f=f|0,p=p|0;var m=0,E=0,S=0;if(E=ft(h|0,f|0,45)|0,lt()|0,!(oa(E&127)|0))return E=2,v[p>>2]=E,0;if(E=ft(h|0,f|0,52)|0,lt()|0,E=E&15,!E)return E=5,v[p>>2]=E,0;for(m=1;;){if(S=Et(7,0,(15-m|0)*3|0)|0,!((S&h|0)==0&((lt()|0)&f|0)==0)){m=2,h=6;break}if(m>>>0<E>>>0)m=m+1|0;else{m=5,h=6;break}}return(h|0)==6&&(v[p>>2]=m),0}function Tl(h,f,p){h=h|0,f=f|0,p=p|0;var m=0,E=0,S=0,I=0,D=0,V=0,re=0,xe=0,Fe=0;Fe=Je,Je=Je+128|0,re=Fe+112|0,S=Fe+96|0,xe=Fe,E=ft(h|0,f|0,52)|0,lt()|0,D=E&15,v[re>>2]=D,I=ft(h|0,f|0,45)|0,lt()|0,I=I&127;e:do if(oa(I)|0){if(D|0)for(m=1;;){if(V=Et(7,0,(15-m|0)*3|0)|0,!((V&h|0)==0&((lt()|0)&f|0)==0)){E=0;break e}if(m>>>0<D>>>0)m=m+1|0;else break}if(E&1)E=1;else return V=Et(D+1|0,0,52)|0,xe=lt()|0|f&-15728641,re=Et(7,0,(14-D|0)*3|0)|0,xe=Tl((V|h)&~re,xe&~(lt()|0),p)|0,Je=Fe,xe|0}else E=0;while(0);if(m=Yl(h,f,S)|0,!m){E?(Eo(S,re,xe),V=5):(ul(S,re,xe),V=6);e:do if(oa(I)|0)if(!D)h=5;else for(m=1;;){if(I=Et(7,0,(15-m|0)*3|0)|0,!((I&h|0)==0&((lt()|0)&f|0)==0)){h=2;break e}if(m>>>0<D>>>0)m=m+1|0;else{h=5;break}}else h=2;while(0);St(p|0,-1,h<<2|0)|0;e:do if(E)for(S=0;;){if(I=xe+(S<<4)|0,zl(I,v[re>>2]|0)|0,I=v[I>>2]|0,D=v[p>>2]|0,(D|0)==-1|(D|0)==(I|0))m=p;else{E=0;do{if(E=E+1|0,E>>>0>=h>>>0){m=1;break e}m=p+(E<<2)|0,D=v[m>>2]|0}while(!((D|0)==-1|(D|0)==(I|0)))}if(v[m>>2]=I,S=S+1|0,S>>>0>=V>>>0){m=0;break}}else for(S=0;;){if(I=xe+(S<<4)|0,Xs(I,v[re>>2]|0,0,1)|0,I=v[I>>2]|0,D=v[p>>2]|0,(D|0)==-1|(D|0)==(I|0))m=p;else{E=0;do{if(E=E+1|0,E>>>0>=h>>>0){m=1;break e}m=p+(E<<2)|0,D=v[m>>2]|0}while(!((D|0)==-1|(D|0)==(I|0)))}if(v[m>>2]=I,S=S+1|0,S>>>0>=V>>>0){m=0;break}}while(0)}return xe=m,Je=Fe,xe|0}function y0(){return 12}function lf(h,f){h=h|0,f=f|0;var p=0,m=0,E=0,S=0,I=0,D=0,V=0;if(h>>>0>15)return D=4,D|0;if(Et(h|0,0,52)|0,D=lt()|0|134225919,!h){p=0,m=0;do oa(m)|0&&(Et(m|0,0,45)|0,I=D|(lt()|0),h=f+(p<<3)|0,v[h>>2]=-1,v[h+4>>2]=I,p=p+1|0),m=m+1|0;while((m|0)!=122);return p=0,p|0}p=0,I=0;do{if(oa(I)|0){for(Et(I|0,0,45)|0,m=1,E=-1,S=D|(lt()|0);V=Et(7,0,(15-m|0)*3|0)|0,E=E&~V,S=S&~(lt()|0),(m|0)!=(h|0);)m=m+1|0;V=f+(p<<3)|0,v[V>>2]=E,v[V+4>>2]=S,p=p+1|0}I=I+1|0}while((I|0)!=122);return p=0,p|0}function cf(h,f,p,m){h=h|0,f=f|0,p=p|0,m=m|0;var E=0,S=0,I=0,D=0,V=0,re=0,xe=0,Fe=0,ut=0,gt=0,rt=0,_t=0,$t=0,qt=0,Wt=0;if(Wt=Je,Je=Je+16|0,$t=Wt,qt=ft(h|0,f|0,52)|0,lt()|0,qt=qt&15,p>>>0>15)return qt=4,Je=Wt,qt|0;if((qt|0)<(p|0))return qt=12,Je=Wt,qt|0;if((qt|0)!=(p|0))if(S=Et(p|0,0,52)|0,S=S|h,D=lt()|0|f&-15728641,(qt|0)>(p|0)){V=p;do _t=Et(7,0,(14-V|0)*3|0)|0,V=V+1|0,S=_t|S,D=lt()|0|D;while((V|0)<(qt|0));_t=S}else _t=S;else _t=h,D=f;rt=ft(_t|0,D|0,45)|0,lt()|0;e:do if(oa(rt&127)|0){if(V=ft(_t|0,D|0,52)|0,lt()|0,V=V&15,V|0)for(S=1;;){if(rt=Et(7,0,(15-S|0)*3|0)|0,!((rt&_t|0)==0&((lt()|0)&D|0)==0)){re=33;break e}if(S>>>0<V>>>0)S=S+1|0;else break}if(rt=m,v[rt>>2]=0,v[rt+4>>2]=0,(qt|0)>(p|0)){for(rt=f&-15728641,gt=qt;;){if(ut=gt,gt=gt+-1|0,gt>>>0>15|(qt|0)<(gt|0)){re=19;break}if((qt|0)!=(gt|0))if(S=Et(gt|0,0,52)|0,S=S|h,V=lt()|0|rt,(qt|0)<(ut|0))Fe=S;else{re=gt;do Fe=Et(7,0,(14-re|0)*3|0)|0,re=re+1|0,S=Fe|S,V=lt()|0|V;while((re|0)<(qt|0));Fe=S}else Fe=h,V=f;if(xe=ft(Fe|0,V|0,45)|0,lt()|0,!(oa(xe&127)|0))S=0;else{xe=ft(Fe|0,V|0,52)|0,lt()|0,xe=xe&15;t:do if(!xe)S=0;else for(re=1;;){if(S=ft(Fe|0,V|0,(15-re|0)*3|0)|0,lt()|0,S=S&7,S|0)break t;if(re>>>0<xe>>>0)re=re+1|0;else{S=0;break}}while(0);S=(S|0)==0&1}if(V=ft(h|0,f|0,(15-ut|0)*3|0)|0,lt()|0,V=V&7,(V|0)==7){E=5,re=42;break}if(S=(S|0)!=0,(V|0)==1&S){E=5,re=42;break}if(Fe=V+(((V|0)!=0&S)<<31>>31)|0,Fe|0&&(re=qt-ut|0,re=Or(7,0,re,((re|0)<0)<<31>>31)|0,xe=lt()|0,S?(S=Ri(re|0,xe|0,5,0)|0,S=un(S|0,lt()|0,-5,-1)|0,S=mi(S|0,lt()|0,6,0)|0,S=un(S|0,lt()|0,1,0)|0,V=lt()|0):(S=re,V=xe),ut=Fe+-1|0,ut=Ri(re|0,xe|0,ut|0,((ut|0)<0)<<31>>31|0)|0,ut=un(S|0,V|0,ut|0,lt()|0)|0,Fe=lt()|0,xe=m,xe=un(ut|0,Fe|0,v[xe>>2]|0,v[xe+4>>2]|0)|0,Fe=lt()|0,ut=m,v[ut>>2]=xe,v[ut+4>>2]=Fe),(gt|0)<=(p|0)){re=37;break}}if((re|0)==19)ii(23313,22674,1099,22710);else if((re|0)==37){I=m,E=v[I+4>>2]|0,I=v[I>>2]|0;break}else if((re|0)==42)return Je=Wt,E|0}else E=0,I=0}else re=33;while(0);e:do if((re|0)==33)if(rt=m,v[rt>>2]=0,v[rt+4>>2]=0,(qt|0)>(p|0)){for(S=qt;;){if(E=ft(h|0,f|0,(15-S|0)*3|0)|0,lt()|0,E=E&7,(E|0)==7){E=5;break}if(I=qt-S|0,I=Or(7,0,I,((I|0)<0)<<31>>31)|0,E=Ri(I|0,lt()|0,E|0,0)|0,I=lt()|0,rt=m,I=un(v[rt>>2]|0,v[rt+4>>2]|0,E|0,I|0)|0,E=lt()|0,rt=m,v[rt>>2]=I,v[rt+4>>2]=E,S=S+-1|0,(S|0)<=(p|0))break e}return Je=Wt,E|0}else E=0,I=0;while(0);return Cl(_t,D,qt,$t)|0&&ii(23313,22674,1063,22725),qt=$t,$t=v[qt+4>>2]|0,((E|0)>-1|(E|0)==-1&I>>>0>4294967295)&(($t|0)>(E|0)|(($t|0)==(E|0)?(v[qt>>2]|0)>>>0>I>>>0:0))?(qt=0,Je=Wt,qt|0):(ii(23313,22674,1139,22710),0)}function Tf(h,f,p,m,E,S){h=h|0,f=f|0,p=p|0,m=m|0,E=E|0,S=S|0;var I=0,D=0,V=0,re=0,xe=0,Fe=0,ut=0,gt=0,rt=0,_t=0;if(Fe=Je,Je=Je+16|0,I=Fe,E>>>0>15)return S=4,Je=Fe,S|0;if(D=ft(p|0,m|0,52)|0,lt()|0,D=D&15,(D|0)>(E|0))return S=12,Je=Fe,S|0;if(Cl(p,m,E,I)|0&&ii(23313,22674,1063,22725),xe=I,re=v[xe+4>>2]|0,!(((f|0)>-1|(f|0)==-1&h>>>0>4294967295)&((re|0)>(f|0)|((re|0)==(f|0)?(v[xe>>2]|0)>>>0>h>>>0:0))))return S=2,Je=Fe,S|0;xe=E-D|0,E=Et(E|0,0,52)|0,V=lt()|0|m&-15728641,re=S,v[re>>2]=E|p,v[re+4>>2]=V,re=ft(p|0,m|0,45)|0,lt()|0;e:do if(oa(re&127)|0){if(D|0)for(I=1;;){if(re=Et(7,0,(15-I|0)*3|0)|0,!((re&p|0)==0&((lt()|0)&m|0)==0))break e;if(I>>>0<D>>>0)I=I+1|0;else break}if((xe|0)<1)return S=0,Je=Fe,S|0;for(re=D^15,m=-1,V=1,I=1;;){D=xe-V|0,D=Or(7,0,D,((D|0)<0)<<31>>31)|0,p=lt()|0;do if(I)if(I=Ri(D|0,p|0,5,0)|0,I=un(I|0,lt()|0,-5,-1)|0,I=mi(I|0,lt()|0,6,0)|0,E=lt()|0,(f|0)>(E|0)|(f|0)==(E|0)&h>>>0>I>>>0){f=un(h|0,f|0,-1,-1)|0,f=da(f|0,lt()|0,I|0,E|0)|0,I=lt()|0,ut=S,rt=v[ut>>2]|0,ut=v[ut+4>>2]|0,_t=(re+m|0)*3|0,gt=Et(7,0,_t|0)|0,ut=ut&~(lt()|0),m=mi(f|0,I|0,D|0,p|0)|0,h=lt()|0,E=un(m|0,h|0,2,0)|0,_t=Et(E|0,lt()|0,_t|0)|0,ut=lt()|0|ut,E=S,v[E>>2]=_t|rt&~gt,v[E+4>>2]=ut,h=Ri(m|0,h|0,D|0,p|0)|0,h=da(f|0,I|0,h|0,lt()|0)|0,I=0,f=lt()|0;break}else{_t=S,gt=v[_t>>2]|0,_t=v[_t+4>>2]|0,rt=Et(7,0,(re+m|0)*3|0)|0,_t=_t&~(lt()|0),I=S,v[I>>2]=gt&~rt,v[I+4>>2]=_t,I=1;break}else gt=S,E=v[gt>>2]|0,gt=v[gt+4>>2]|0,m=(re+m|0)*3|0,ut=Et(7,0,m|0)|0,gt=gt&~(lt()|0),_t=mi(h|0,f|0,D|0,p|0)|0,I=lt()|0,m=Et(_t|0,I|0,m|0)|0,gt=lt()|0|gt,rt=S,v[rt>>2]=m|E&~ut,v[rt+4>>2]=gt,I=Ri(_t|0,I|0,D|0,p|0)|0,h=da(h|0,f|0,I|0,lt()|0)|0,I=0,f=lt()|0;while(0);if((xe|0)>(V|0))m=~V,V=V+1|0;else{f=0;break}}return Je=Fe,f|0}while(0);if((xe|0)<1)return _t=0,Je=Fe,_t|0;for(E=D^15,I=1;;)if(rt=xe-I|0,rt=Or(7,0,rt,((rt|0)<0)<<31>>31)|0,_t=lt()|0,V=S,p=v[V>>2]|0,V=v[V+4>>2]|0,D=(E-I|0)*3|0,m=Et(7,0,D|0)|0,V=V&~(lt()|0),ut=mi(h|0,f|0,rt|0,_t|0)|0,gt=lt()|0,D=Et(ut|0,gt|0,D|0)|0,V=lt()|0|V,re=S,v[re>>2]=D|p&~m,v[re+4>>2]=V,_t=Ri(ut|0,gt|0,rt|0,_t|0)|0,h=da(h|0,f|0,_t|0,lt()|0)|0,f=lt()|0,(xe|0)<=(I|0)){f=0;break}else I=I+1|0;return Je=Fe,f|0}function ms(h,f,p,m){h=h|0,f=f|0,p=p|0,m=m|0;var E=0,S=0;E=ft(f|0,p|0,52)|0,lt()|0,E=E&15,(f|0)==0&(p|0)==0|((m|0)>15|(E|0)>(m|0))?(m=-1,E=-1,f=0,p=0):(S=jl(f,p,E+1|0,m)|0,p=(lt()|0)&-15728641,f=Et(m|0,0,52)|0,f=S|f,p=p|(lt()|0),S=(pa(f,p)|0)==0,m=S?-1:m),S=h,v[S>>2]=f,v[S+4>>2]=p,v[h+8>>2]=E,v[h+12>>2]=m}function ll(h){h=h|0;var f=0,p=0,m=0,E=0,S=0,I=0,D=0,V=0,re=0;if(p=h,f=v[p>>2]|0,p=v[p+4>>2]|0,!((f|0)==0&(p|0)==0)&&(m=ft(f|0,p|0,52)|0,lt()|0,m=m&15,D=Et(1,0,(m^15)*3|0)|0,f=un(D|0,lt()|0,f|0,p|0)|0,p=lt()|0,D=h,v[D>>2]=f,v[D+4>>2]=p,D=h+8|0,I=v[D>>2]|0,!((m|0)<(I|0)))){for(V=h+12|0,S=m;;){if((S|0)==(I|0)){m=5;break}if(re=(S|0)==(v[V>>2]|0),E=(15-S|0)*3|0,m=ft(f|0,p|0,E|0)|0,lt()|0,m=m&7,re&((m|0)==1&!0)){m=7;break}if(!((m|0)==7&!0)){m=10;break}if(re=Et(1,0,E|0)|0,f=un(f|0,p|0,re|0,lt()|0)|0,p=lt()|0,re=h,v[re>>2]=f,v[re+4>>2]=p,(S|0)>(I|0))S=S+-1|0;else{m=10;break}}if((m|0)==5){re=h,v[re>>2]=0,v[re+4>>2]=0,v[D>>2]=-1,v[V>>2]=-1;return}else if((m|0)==7){I=Et(1,0,E|0)|0,I=un(f|0,p|0,I|0,lt()|0)|0,D=lt()|0,re=h,v[re>>2]=I,v[re+4>>2]=D,v[V>>2]=S+-1;return}else if((m|0)==10)return}}function ia(h){h=+h;var f=0;return f=h<0?h+6.283185307179586:h,+(h>=6.283185307179586?f+-6.283185307179586:f)}function Ko(h,f){return h=h|0,f=f|0,+sa(+(+Xe[h>>3]-+Xe[f>>3]))<17453292519943298e-27?(f=+sa(+(+Xe[h+8>>3]-+Xe[f+8>>3]))<17453292519943298e-27,f|0):(f=0,f|0)}function cc(h,f){h=h|0,f=f|0;var p=0,m=0,E=0,S=0;return E=+Xe[f>>3],m=+Xe[h>>3],S=+Vr(+((E-m)*.5)),p=+Vr(+((+Xe[f+8>>3]-+Xe[h+8>>3])*.5)),p=S*S+p*(+ba(+E)*+ba(+m)*p),+(+Ln(+ +ka(+p),+ +ka(+(1-p)))*2)}function cl(h,f){h=h|0,f=f|0;var p=0,m=0,E=0,S=0;return E=+Xe[f>>3],m=+Xe[h>>3],S=+Vr(+((E-m)*.5)),p=+Vr(+((+Xe[f+8>>3]-+Xe[h+8>>3])*.5)),p=S*S+p*(+ba(+E)*+ba(+m)*p),+(+Ln(+ +ka(+p),+ +ka(+(1-p)))*2*6371.007180918475)}function Mf(h,f){h=h|0,f=f|0;var p=0,m=0,E=0,S=0;return E=+Xe[f>>3],m=+Xe[h>>3],S=+Vr(+((E-m)*.5)),p=+Vr(+((+Xe[f+8>>3]-+Xe[h+8>>3])*.5)),p=S*S+p*(+ba(+E)*+ba(+m)*p),+(+Ln(+ +ka(+p),+ +ka(+(1-p)))*2*6371.007180918475*1e3)}function W0(h,f){h=h|0,f=f|0;var p=0,m=0,E=0,S=0,I=0;return S=+Xe[f>>3],m=+ba(+S),E=+Xe[f+8>>3]-+Xe[h+8>>3],I=m*+Vr(+E),p=+Xe[h>>3],+ +Ln(+I,+(+Vr(+S)*+ba(+p)-+ba(+E)*(m*+Vr(+p))))}function Nc(h,f,p,m){h=h|0,f=+f,p=+p,m=m|0;var E=0,S=0,I=0,D=0;if(p<1e-16){v[m>>2]=v[h>>2],v[m+4>>2]=v[h+4>>2],v[m+8>>2]=v[h+8>>2],v[m+12>>2]=v[h+12>>2];return}S=f<0?f+6.283185307179586:f,S=f>=6.283185307179586?S+-6.283185307179586:S;do if(S<1e-16)f=+Xe[h>>3]+p,Xe[m>>3]=f,E=m;else{if(E=+sa(+(S+-3.141592653589793))<1e-16,f=+Xe[h>>3],E){f=f-p,Xe[m>>3]=f,E=m;break}if(I=+ba(+p),p=+Vr(+p),f=I*+Vr(+f)+ +ba(+S)*(p*+ba(+f)),f=f>1?1:f,f=+Dn(+(f<-1?-1:f)),Xe[m>>3]=f,+sa(+(f+-1.5707963267948966))<1e-16){Xe[m>>3]=1.5707963267948966,Xe[m+8>>3]=0;return}if(+sa(+(f+1.5707963267948966))<1e-16){Xe[m>>3]=-1.5707963267948966,Xe[m+8>>3]=0;return}if(D=+ba(+f),S=p*+Vr(+S)/D,p=+Xe[h>>3],f=(I-+Vr(+f)*+Vr(+p))/+ba(+p)/D,I=S>1?1:S,f=f>1?1:f,f=+Xe[h+8>>3]+ +Ln(+(I<-1?-1:I),+(f<-1?-1:f)),f>3.141592653589793)do f=f+-6.283185307179586;while(f>3.141592653589793);if(f<-3.141592653589793)do f=f+6.283185307179586;while(f<-3.141592653589793);Xe[m+8>>3]=f;return}while(0);if(+sa(+(f+-1.5707963267948966))<1e-16){Xe[E>>3]=1.5707963267948966,Xe[m+8>>3]=0;return}if(+sa(+(f+1.5707963267948966))<1e-16){Xe[E>>3]=-1.5707963267948966,Xe[m+8>>3]=0;return}if(f=+Xe[h+8>>3],f>3.141592653589793)do f=f+-6.283185307179586;while(f>3.141592653589793);if(f<-3.141592653589793)do f=f+6.283185307179586;while(f<-3.141592653589793);Xe[m+8>>3]=f}function If(h,f){return h=h|0,f=f|0,h>>>0>15?(f=4,f|0):(Xe[f>>3]=+Xe[20528+(h<<3)>>3],f=0,f|0)}function Wf(h,f){return h=h|0,f=f|0,h>>>0>15?(f=4,f|0):(Xe[f>>3]=+Xe[20656+(h<<3)>>3],f=0,f|0)}function X0(h,f){return h=h|0,f=f|0,h>>>0>15?(f=4,f|0):(Xe[f>>3]=+Xe[20784+(h<<3)>>3],f=0,f|0)}function ff(h,f){return h=h|0,f=f|0,h>>>0>15?(f=4,f|0):(Xe[f>>3]=+Xe[20912+(h<<3)>>3],f=0,f|0)}function Pf(h,f){h=h|0,f=f|0;var p=0;return h>>>0>15?(f=4,f|0):(p=Or(7,0,h,((h|0)<0)<<31>>31)|0,p=Ri(p|0,lt()|0,120,0)|0,h=lt()|0,v[f>>2]=p|2,v[f+4>>2]=h,f=0,f|0)}function Ya(h,f,p){h=h|0,f=f|0,p=p|0;var m=0,E=0,S=0,I=0,D=0,V=0,re=0,xe=0,Fe=0,ut=0;return ut=+Xe[f>>3],xe=+Xe[h>>3],V=+Vr(+((ut-xe)*.5)),S=+Xe[f+8>>3],re=+Xe[h+8>>3],I=+Vr(+((S-re)*.5)),D=+ba(+xe),Fe=+ba(+ut),I=V*V+I*(Fe*D*I),I=+Ln(+ +ka(+I),+ +ka(+(1-I)))*2,V=+Xe[p>>3],ut=+Vr(+((V-ut)*.5)),m=+Xe[p+8>>3],S=+Vr(+((m-S)*.5)),E=+ba(+V),S=ut*ut+S*(Fe*E*S),S=+Ln(+ +ka(+S),+ +ka(+(1-S)))*2,V=+Vr(+((xe-V)*.5)),m=+Vr(+((re-m)*.5)),m=V*V+m*(D*E*m),m=+Ln(+ +ka(+m),+ +ka(+(1-m)))*2,E=(I+S+m)*.5,+(+Kn(+ +ka(+(+hn(+(E*.5))*+hn(+((E-I)*.5))*+hn(+((E-S)*.5))*+hn(+((E-m)*.5)))))*4)}function Fc(h,f,p){h=h|0,f=f|0,p=p|0;var m=0,E=0,S=0,I=0,D=0;if(D=Je,Je=Je+192|0,S=D+168|0,I=D,E=Os(h,f,S)|0,E|0)return p=E,Je=D,p|0;if(Dc(h,f,I)|0&&ii(23313,22742,386,22751),f=v[I>>2]|0,(f|0)>0){if(m=+Ya(I+8|0,I+8+(((f|0)!=1&1)<<4)|0,S)+0,(f|0)!=1){h=1;do E=h,h=h+1|0,m=m+ +Ya(I+8+(E<<4)|0,I+8+(((h|0)%(f|0)|0)<<4)|0,S);while((h|0)<(f|0))}}else m=0;return Xe[p>>3]=m,p=0,Je=D,p|0}function Wl(h,f,p){return h=h|0,f=f|0,p=p|0,h=Fc(h,f,p)|0,h|0||(Xe[p>>3]=+Xe[p>>3]*6371.007180918475*6371.007180918475),h|0}function qs(h,f,p){return h=h|0,f=f|0,p=p|0,h=Fc(h,f,p)|0,h|0||(Xe[p>>3]=+Xe[p>>3]*6371.007180918475*6371.007180918475*1e3*1e3),h|0}function vu(h,f,p){h=h|0,f=f|0,p=p|0;var m=0,E=0,S=0,I=0,D=0,V=0,re=0,xe=0;if(D=Je,Je=Je+176|0,I=D,h=Cf(h,f,I)|0,h|0)return I=h,Je=D,I|0;if(Xe[p>>3]=0,h=v[I>>2]|0,(h|0)<=1)return I=0,Je=D,I|0;f=h+-1|0,h=0,m=+Xe[I+8>>3],E=+Xe[I+16>>3],S=0;do h=h+1|0,re=m,m=+Xe[I+8+(h<<4)>>3],xe=+Vr(+((m-re)*.5)),V=E,E=+Xe[I+8+(h<<4)+8>>3],V=+Vr(+((E-V)*.5)),V=xe*xe+V*(+ba(+m)*+ba(+re)*V),S=S+ +Ln(+ +ka(+V),+ +ka(+(1-V)))*2;while((h|0)<(f|0));return Xe[p>>3]=S,I=0,Je=D,I|0}function Rs(h,f,p){h=h|0,f=f|0,p=p|0;var m=0,E=0,S=0,I=0,D=0,V=0,re=0,xe=0;if(D=Je,Je=Je+176|0,I=D,h=Cf(h,f,I)|0,h|0)return I=h,S=+Xe[p>>3],S=S*6371.007180918475,Xe[p>>3]=S,Je=D,I|0;if(Xe[p>>3]=0,h=v[I>>2]|0,(h|0)<=1)return I=0,S=0,S=S*6371.007180918475,Xe[p>>3]=S,Je=D,I|0;f=h+-1|0,h=0,m=+Xe[I+8>>3],E=+Xe[I+16>>3],S=0;do h=h+1|0,re=m,m=+Xe[I+8+(h<<4)>>3],xe=+Vr(+((m-re)*.5)),V=E,E=+Xe[I+8+(h<<4)+8>>3],V=+Vr(+((E-V)*.5)),V=xe*xe+V*(+ba(+re)*+ba(+m)*V),S=S+ +Ln(+ +ka(+V),+ +ka(+(1-V)))*2;while((h|0)!=(f|0));return Xe[p>>3]=S,I=0,xe=S,xe=xe*6371.007180918475,Xe[p>>3]=xe,Je=D,I|0}function Xf(h,f,p){h=h|0,f=f|0,p=p|0;var m=0,E=0,S=0,I=0,D=0,V=0,re=0,xe=0;if(D=Je,Je=Je+176|0,I=D,h=Cf(h,f,I)|0,h|0)return I=h,S=+Xe[p>>3],S=S*6371.007180918475,S=S*1e3,Xe[p>>3]=S,Je=D,I|0;if(Xe[p>>3]=0,h=v[I>>2]|0,(h|0)<=1)return I=0,S=0,S=S*6371.007180918475,S=S*1e3,Xe[p>>3]=S,Je=D,I|0;f=h+-1|0,h=0,m=+Xe[I+8>>3],E=+Xe[I+16>>3],S=0;do h=h+1|0,re=m,m=+Xe[I+8+(h<<4)>>3],xe=+Vr(+((m-re)*.5)),V=E,E=+Xe[I+8+(h<<4)+8>>3],V=+Vr(+((E-V)*.5)),V=xe*xe+V*(+ba(+re)*+ba(+m)*V),S=S+ +Ln(+ +ka(+V),+ +ka(+(1-V)))*2;while((h|0)!=(f|0));return Xe[p>>3]=S,I=0,xe=S,xe=xe*6371.007180918475,xe=xe*1e3,Xe[p>>3]=xe,Je=D,I|0}function _0(h){h=h|0;var f=0,p=0,m=0;return f=ya(1,12)|0,f||ii(22832,22787,49,22845),p=h+4|0,m=v[p>>2]|0,m|0?(m=m+8|0,v[m>>2]=f,v[p>>2]=f,f|0):(v[h>>2]|0&&ii(22862,22787,61,22885),m=h,v[m>>2]=f,v[p>>2]=f,f|0)}function Ce(h,f){h=h|0,f=f|0;var p=0,m=0;return m=Ga(24)|0,m||ii(22899,22787,78,22913),v[m>>2]=v[f>>2],v[m+4>>2]=v[f+4>>2],v[m+8>>2]=v[f+8>>2],v[m+12>>2]=v[f+12>>2],v[m+16>>2]=0,f=h+4|0,p=v[f>>2]|0,p|0?(v[p+16>>2]=m,v[f>>2]=m,m|0):(v[h>>2]|0&&ii(22928,22787,82,22913),v[h>>2]=m,v[f>>2]=m,m|0)}function Qe(h){h=h|0;var f=0,p=0,m=0,E=0;if(h)for(m=1;;){if(f=v[h>>2]|0,f|0)do{if(p=v[f>>2]|0,p|0)do E=p,p=v[p+16>>2]|0,Tn(E);while(p|0);E=f,f=v[f+8>>2]|0,Tn(E)}while(f|0);if(f=h,h=v[h+8>>2]|0,m||Tn(f),h)m=0;else break}}function mt(h){h=h|0;var f=0,p=0,m=0,E=0,S=0,I=0,D=0,V=0,re=0,xe=0,Fe=0,ut=0,gt=0,rt=0,_t=0,$t=0,qt=0,Wt=0,rr=0,Yt=0,rn=0,xn=0,Kr=0,pn=0,Pa=0,ua=0,va=0,Vi=0,ci=0,Di=0,Wa=0,Qn=0;if(E=h+8|0,v[E>>2]|0)return Qn=1,Qn|0;if(m=v[h>>2]|0,!m)return Qn=0,Qn|0;f=m,p=0;do p=p+1|0,f=v[f+8>>2]|0;while(f|0);if(p>>>0<2)return Qn=0,Qn|0;Di=Ga(p<<2)|0,Di||ii(22948,22787,317,22967),ci=Ga(p<<5)|0,ci||ii(22989,22787,321,22967),v[h>>2]=0,xn=h+4|0,v[xn>>2]=0,v[E>>2]=0,p=0,Vi=0,rn=0,Fe=0;e:for(;;){if(xe=v[m>>2]|0,xe){S=0,I=xe;do{if(V=+Xe[I+8>>3],f=I,I=v[I+16>>2]|0,re=(I|0)==0,E=re?xe:I,D=+Xe[E+8>>3],+sa(+(V-D))>3.141592653589793){Qn=14;break}S=S+(D-V)*(+Xe[f>>3]+ +Xe[E>>3])}while(!re);if((Qn|0)==14){Qn=0,S=0,f=xe;do Yt=+Xe[f+8>>3],va=f+16|0,ua=v[va>>2]|0,ua=ua|0?ua:xe,rr=+Xe[ua+8>>3],S=S+(+Xe[f>>3]+ +Xe[ua>>3])*((rr<0?rr+6.283185307179586:rr)-(Yt<0?Yt+6.283185307179586:Yt)),f=v[(f|0?va:m)>>2]|0;while(f|0)}S>0?(v[Di+(Vi<<2)>>2]=m,Vi=Vi+1|0,E=rn,f=Fe):Qn=19}else Qn=19;if((Qn|0)==19){Qn=0;do if(p){if(f=p+8|0,v[f>>2]|0){Qn=21;break e}if(p=ya(1,12)|0,!p){Qn=23;break e}v[f>>2]=p,E=p+4|0,I=p,f=Fe}else if(Fe){E=xn,I=Fe+8|0,f=m,p=h;break}else if(v[h>>2]|0){Qn=27;break e}else{E=xn,I=h,f=m,p=h;break}while(0);if(v[I>>2]=m,v[E>>2]=m,I=ci+(rn<<5)|0,re=v[m>>2]|0,re){for(xe=ci+(rn<<5)+8|0,Xe[xe>>3]=17976931348623157e292,Fe=ci+(rn<<5)+24|0,Xe[Fe>>3]=17976931348623157e292,Xe[I>>3]=-17976931348623157e292,ut=ci+(rn<<5)+16|0,Xe[ut>>3]=-17976931348623157e292,qt=17976931348623157e292,Wt=-17976931348623157e292,E=0,gt=re,V=17976931348623157e292,_t=17976931348623157e292,$t=-17976931348623157e292,D=-17976931348623157e292;S=+Xe[gt>>3],Yt=+Xe[gt+8>>3],gt=v[gt+16>>2]|0,rt=(gt|0)==0,rr=+Xe[(rt?re:gt)+8>>3],S<V&&(Xe[xe>>3]=S,V=S),Yt<_t&&(Xe[Fe>>3]=Yt,_t=Yt),S>$t?Xe[I>>3]=S:S=$t,Yt>D&&(Xe[ut>>3]=Yt,D=Yt),qt=Yt>0&Yt<qt?Yt:qt,Wt=Yt<0&Yt>Wt?Yt:Wt,E=E|+sa(+(Yt-rr))>3.141592653589793,!rt;)$t=S;E&&(Xe[ut>>3]=Wt,Xe[Fe>>3]=qt)}else v[I>>2]=0,v[I+4>>2]=0,v[I+8>>2]=0,v[I+12>>2]=0,v[I+16>>2]=0,v[I+20>>2]=0,v[I+24>>2]=0,v[I+28>>2]=0;E=rn+1|0}if(va=m+8|0,m=v[va>>2]|0,v[va>>2]=0,m)rn=E,Fe=f;else{Qn=45;break}}if((Qn|0)==21)ii(22765,22787,35,22799);else if((Qn|0)==23)ii(22819,22787,37,22799);else if((Qn|0)==27)ii(22862,22787,61,22885);else if((Qn|0)==45){e:do if((Vi|0)>0){for(va=(E|0)==0,Pa=E<<2,ua=(h|0)==0,pn=0,f=0;;){if(Kr=v[Di+(pn<<2)>>2]|0,va)Qn=73;else{if(rn=Ga(Pa)|0,!rn){Qn=50;break}if(xn=Ga(Pa)|0,!xn){Qn=52;break}t:do if(ua)p=0;else{for(E=0,p=0,I=h;m=ci+(E<<5)|0,nr(v[I>>2]|0,m,v[Kr>>2]|0)|0?(v[rn+(p<<2)>>2]=I,v[xn+(p<<2)>>2]=m,rt=p+1|0):rt=p,I=v[I+8>>2]|0,I;)E=E+1|0,p=rt;if((rt|0)>0)if(m=v[rn>>2]|0,(rt|0)==1)p=m;else for(ut=0,gt=-1,p=m,Fe=m;;){for(re=v[Fe>>2]|0,m=0,I=0;E=v[v[rn+(I<<2)>>2]>>2]|0,(E|0)==(re|0)?xe=m:xe=m+((nr(E,v[xn+(I<<2)>>2]|0,v[re>>2]|0)|0)&1)|0,I=I+1|0,(I|0)!=(rt|0);)m=xe;if(E=(xe|0)>(gt|0),p=E?Fe:p,m=ut+1|0,(m|0)==(rt|0))break t;ut=m,gt=E?xe:gt,Fe=v[rn+(m<<2)>>2]|0}else p=0}while(0);if(Tn(rn),Tn(xn),p){if(E=p+4|0,m=v[E>>2]|0,m)p=m+8|0;else if(v[p>>2]|0){Qn=70;break}v[p>>2]=Kr,v[E>>2]=Kr}else Qn=73}if((Qn|0)==73){if(Qn=0,f=v[Kr>>2]|0,f|0)do xn=f,f=v[f+16>>2]|0,Tn(xn);while(f|0);Tn(Kr),f=1}if(pn=pn+1|0,(pn|0)>=(Vi|0)){Wa=f;break e}}(Qn|0)==50?ii(23004,22787,249,23023):(Qn|0)==52?ii(23042,22787,252,23023):(Qn|0)==70&&ii(22862,22787,61,22885)}else Wa=0;while(0);return Tn(Di),Tn(ci),Qn=Wa,Qn|0}return 0}function nr(h,f,p){h=h|0,f=f|0,p=p|0;var m=0,E=0,S=0,I=0,D=0,V=0,re=0,xe=0;if(!(ic(f,p)|0)||(f=au(f)|0,m=+Xe[p>>3],E=+Xe[p+8>>3],E=f&E<0?E+6.283185307179586:E,h=v[h>>2]|0,!h))return h=0,h|0;if(f){f=0,re=E,p=h;e:for(;;){for(;I=+Xe[p>>3],E=+Xe[p+8>>3],p=p+16|0,xe=v[p>>2]|0,xe=xe|0?xe:h,S=+Xe[xe>>3],D=+Xe[xe+8>>3],I>S?(V=I,I=D):(V=S,S=I,I=E,E=D),m=m==S|m==V?m+2220446049250313e-31:m,!!(m<S|m>V);)if(p=v[p>>2]|0,!p){p=22;break e}if(D=I<0?I+6.283185307179586:I,I=E<0?E+6.283185307179586:E,re=D==re|I==re?re+-2220446049250313e-31:re,V=D+(I-D)*((m-S)/(V-S)),(V<0?V+6.283185307179586:V)>re&&(f=f^1),p=v[p>>2]|0,!p){p=22;break}}if((p|0)==22)return f|0}else{f=0,re=E,p=h;e:for(;;){for(;I=+Xe[p>>3],E=+Xe[p+8>>3],p=p+16|0,xe=v[p>>2]|0,xe=xe|0?xe:h,S=+Xe[xe>>3],D=+Xe[xe+8>>3],I>S?(V=I,I=D):(V=S,S=I,I=E,E=D),m=m==S|m==V?m+2220446049250313e-31:m,!!(m<S|m>V);)if(p=v[p>>2]|0,!p){p=22;break e}if(re=I==re|E==re?re+-2220446049250313e-31:re,I+(E-I)*((m-S)/(V-S))>re&&(f=f^1),p=v[p>>2]|0,!p){p=22;break}}if((p|0)==22)return f|0}return 0}function Ar(h,f,p,m,E){h=h|0,f=f|0,p=p|0,m=m|0,E=E|0;var S=0,I=0,D=0,V=0,re=0,xe=0,Fe=0,ut=0,gt=0,rt=0,_t=0,$t=0,qt=0,Wt=0;if(Wt=Je,Je=Je+32|0,qt=Wt+16|0,$t=Wt,S=ft(h|0,f|0,52)|0,lt()|0,S=S&15,gt=ft(p|0,m|0,52)|0,lt()|0,(S|0)!=(gt&15|0))return qt=12,Je=Wt,qt|0;if(re=ft(h|0,f|0,45)|0,lt()|0,re=re&127,xe=ft(p|0,m|0,45)|0,lt()|0,xe=xe&127,re>>>0>121|xe>>>0>121)return qt=5,Je=Wt,qt|0;if(gt=(re|0)!=(xe|0),gt){if(D=Xi(re,xe)|0,(D|0)==7)return qt=1,Je=Wt,qt|0;V=Xi(xe,re)|0,(V|0)==7?ii(23066,23090,161,23100):(rt=D,I=V)}else rt=0,I=0;Fe=oa(re)|0,ut=oa(xe)|0,v[qt>>2]=0,v[qt+4>>2]=0,v[qt+8>>2]=0,v[qt+12>>2]=0;do if(rt){if(xe=v[4272+(re*28|0)+(rt<<2)>>2]|0,D=(xe|0)>0,ut)if(D){re=0,V=p,D=m;do V=ju(V,D)|0,D=lt()|0,I=Sl(I)|0,(I|0)==1&&(I=Sl(1)|0),re=re+1|0;while((re|0)!=(xe|0));xe=I,re=V,V=D}else xe=I,re=p,V=m;else if(D){re=0,V=p,D=m;do V=Mu(V,D)|0,D=lt()|0,I=Sl(I)|0,re=re+1|0;while((re|0)!=(xe|0));xe=I,re=V,V=D}else xe=I,re=p,V=m;if($l(re,V,qt)|0,gt||ii(23115,23090,191,23100),D=(Fe|0)!=0,I=(ut|0)!=0,D&I&&ii(23142,23090,192,23100),D){if(I=Qs(h,f)|0,(I|0)==7){S=5;break}if(yr[21872+(I*7|0)+rt>>0]|0){S=1;break}V=v[21040+(I*28|0)+(rt<<2)>>2]|0,re=V}else if(I){if(I=Qs(re,V)|0,(I|0)==7){S=5;break}if(yr[21872+(I*7|0)+xe>>0]|0){S=1;break}re=0,V=v[21040+(xe*28|0)+(I<<2)>>2]|0}else re=0,V=0;if((re|V|0)<0)S=5;else{if((V|0)>0){D=qt+4|0,I=0;do sl(D),I=I+1|0;while((I|0)!=(V|0))}if(v[$t>>2]=0,v[$t+4>>2]=0,v[$t+8>>2]=0,Tc($t,rt),S|0)for(;ou(S)|0?wc($t):Tu($t),(S|0)>1;)S=S+-1|0;if((re|0)>0){S=0;do sl($t),S=S+1|0;while((S|0)!=(re|0))}_t=qt+4|0,ss(_t,$t,_t),Mo(_t),_t=51}}else if($l(p,m,qt)|0,(Fe|0)!=0&(ut|0)!=0)if((xe|0)!=(re|0)&&ii(23173,23090,261,23100),I=Qs(h,f)|0,S=Qs(p,m)|0,(I|0)==7|(S|0)==7)S=5;else if(yr[21872+(I*7|0)+S>>0]|0)S=1;else if(I=v[21040+(I*28|0)+(S<<2)>>2]|0,(I|0)>0){D=qt+4|0,S=0;do sl(D),S=S+1|0;while((S|0)!=(I|0));_t=51}else _t=51;else _t=51;while(0);return(_t|0)==51&&(S=qt+4|0,v[E>>2]=v[S>>2],v[E+4>>2]=v[S+4>>2],v[E+8>>2]=v[S+8>>2],S=0),qt=S,Je=Wt,qt|0}function er(h,f,p,m){h=h|0,f=f|0,p=p|0,m=m|0;var E=0,S=0,I=0,D=0,V=0,re=0,xe=0,Fe=0,ut=0,gt=0,rt=0,_t=0,$t=0,qt=0,Wt=0,rr=0;if(_t=Je,Je=Je+48|0,re=_t+36|0,I=_t+24|0,D=_t+12|0,V=_t,E=ft(h|0,f|0,52)|0,lt()|0,E=E&15,ut=ft(h|0,f|0,45)|0,lt()|0,ut=ut&127,ut>>>0>121)return m=5,Je=_t,m|0;if(xe=oa(ut)|0,Et(E|0,0,52)|0,$t=lt()|0|134225919,S=m,v[S>>2]=-1,v[S+4>>2]=$t,!E)return E=Zl(p)|0,(E|0)==7||(E=jf(ut,E)|0,(E|0)==127)?($t=1,Je=_t,$t|0):(gt=Et(E|0,0,45)|0,rt=lt()|0,ut=m,rt=v[ut+4>>2]&-1040385|rt,$t=m,v[$t>>2]=v[ut>>2]|gt,v[$t+4>>2]=rt,$t=0,Je=_t,$t|0);for(v[re>>2]=v[p>>2],v[re+4>>2]=v[p+4>>2],v[re+8>>2]=v[p+8>>2],p=E;;){if(S=p,p=p+-1|0,v[I>>2]=v[re>>2],v[I+4>>2]=v[re+4>>2],v[I+8>>2]=v[re+8>>2],ou(S)|0){if(E=A0(re)|0,E|0){p=13;break}v[D>>2]=v[re>>2],v[D+4>>2]=v[re+4>>2],v[D+8>>2]=v[re+8>>2],wc(D)}else{if(E=Hf(re)|0,E|0){p=13;break}v[D>>2]=v[re>>2],v[D+4>>2]=v[re+4>>2],v[D+8>>2]=v[re+8>>2],Tu(D)}if(ac(I,D,V),Mo(V),E=m,Wt=v[E>>2]|0,E=v[E+4>>2]|0,rr=(15-S|0)*3|0,qt=Et(7,0,rr|0)|0,E=E&~(lt()|0),rr=Et(Zl(V)|0,0,rr|0)|0,E=lt()|0|E,$t=m,v[$t>>2]=rr|Wt&~qt,v[$t+4>>2]=E,(S|0)<=1){p=14;break}}e:do if((p|0)!=13&&(p|0)==14)if((v[re>>2]|0)<=1&&(v[re+4>>2]|0)<=1&&(v[re+8>>2]|0)<=1){p=Zl(re)|0,E=jf(ut,p)|0,(E|0)==127?V=0:V=oa(E)|0;t:do if(p){if(xe){if(E=Qs(h,f)|0,(E|0)==7){E=5;break e}if(S=v[21248+(E*28|0)+(p<<2)>>2]|0,(S|0)>0){E=p,p=0;do E=Mc(E)|0,p=p+1|0;while((p|0)!=(S|0))}else E=p;if((E|0)==1){E=9;break e}p=jf(ut,E)|0,(p|0)==127&&ii(23200,23090,411,23230),oa(p)|0?ii(23245,23090,412,23230):(rt=p,gt=S,Fe=E)}else rt=E,gt=0,Fe=p;if(D=v[4272+(ut*28|0)+(Fe<<2)>>2]|0,(D|0)<=-1&&ii(23276,23090,419,23230),!V){if((gt|0)<0){E=5;break e}if(gt|0){S=m,E=0,p=v[S>>2]|0,S=v[S+4>>2]|0;do p=wl(p,S)|0,S=lt()|0,rr=m,v[rr>>2]=p,v[rr+4>>2]=S,E=E+1|0;while((E|0)<(gt|0))}if((D|0)<=0){E=rt,p=58;break}for(S=m,E=0,p=v[S>>2]|0,S=v[S+4>>2]|0;;)if(p=wl(p,S)|0,S=lt()|0,rr=m,v[rr>>2]=p,v[rr+4>>2]=S,E=E+1|0,(E|0)==(D|0)){E=rt,p=58;break t}}if(I=Xi(rt,ut)|0,(I|0)==7&&ii(23066,23090,428,23230),E=m,p=v[E>>2]|0,E=v[E+4>>2]|0,(D|0)>0){S=0;do p=wl(p,E)|0,E=lt()|0,rr=m,v[rr>>2]=p,v[rr+4>>2]=E,S=S+1|0;while((S|0)!=(D|0))}if(E=Qs(p,E)|0,(E|0)==7&&ii(23313,23090,440,23230),p=Ua(rt)|0,p=v[(p?21664:21456)+(I*28|0)+(E<<2)>>2]|0,(p|0)<0&&ii(23313,23090,454,23230),!p)E=rt,p=58;else{I=m,E=0,S=v[I>>2]|0,I=v[I+4>>2]|0;do S=Rc(S,I)|0,I=lt()|0,rr=m,v[rr>>2]=S,v[rr+4>>2]=I,E=E+1|0;while((E|0)<(p|0));E=rt,p=58}}else if((xe|0)!=0&(V|0)!=0){if(p=Qs(h,f)|0,S=m,S=Qs(v[S>>2]|0,v[S+4>>2]|0)|0,(p|0)==7|(S|0)==7){E=5;break e}if(S=v[21248+(p*28|0)+(S<<2)>>2]|0,(S|0)<0){E=5;break e}if(!S)p=59;else{D=m,p=0,I=v[D>>2]|0,D=v[D+4>>2]|0;do I=wl(I,D)|0,D=lt()|0,rr=m,v[rr>>2]=I,v[rr+4>>2]=D,p=p+1|0;while((p|0)<(S|0));p=58}}else p=58;while(0);if((p|0)==58&&V&&(p=59),(p|0)==59&&(rr=m,(Qs(v[rr>>2]|0,v[rr+4>>2]|0)|0)==1)){E=9;break}rr=m,qt=v[rr>>2]|0,rr=v[rr+4>>2]&-1040385,Wt=Et(E|0,0,45)|0,rr=rr|(lt()|0),E=m,v[E>>2]=qt|Wt,v[E+4>>2]=rr,E=0}else E=1;while(0);return rr=E,Je=_t,rr|0}function sr(h,f,p,m,E,S){h=h|0,f=f|0,p=p|0,m=m|0,E=E|0,S=S|0;var I=0,D=0;return D=Je,Je=Je+16|0,I=D,E?h=15:(h=Ar(h,f,p,m,I)|0,h||(Sh(I,S),h=0)),Je=D,h|0}function Tr(h,f,p,m,E){h=h|0,f=f|0,p=p|0,m=m|0,E=E|0;var S=0,I=0;return I=Je,Je=Je+16|0,S=I,m?p=15:(p=Ch(p,S)|0,p||(p=er(h,f,S,E)|0)),Je=I,p|0}function Lr(h,f,p,m,E){h=h|0,f=f|0,p=p|0,m=m|0,E=E|0;var S=0,I=0,D=0,V=0;return V=Je,Je=Je+32|0,I=V+12|0,D=V,S=Ar(h,f,h,f,I)|0,S|0?(D=S,Je=V,D|0):(h=Ar(h,f,p,m,D)|0,h|0?(D=h,Je=V,D|0):(I=oc(I,D)|0,D=E,v[D>>2]=I,v[D+4>>2]=((I|0)<0)<<31>>31,D=0,Je=V,D|0))}function Nr(h,f,p,m,E){h=h|0,f=f|0,p=p|0,m=m|0,E=E|0;var S=0,I=0,D=0,V=0;return V=Je,Je=Je+32|0,I=V+12|0,D=V,S=Ar(h,f,h,f,I)|0,!S&&(S=Ar(h,f,p,m,D)|0,!S)?(m=oc(I,D)|0,m=un(m|0,((m|0)<0)<<31>>31|0,1,0)|0,I=lt()|0,D=E,v[D>>2]=m,v[D+4>>2]=I,D=0,Je=V,D|0):(D=S,Je=V,D|0)}function kr(h,f,p,m,E){h=h|0,f=f|0,p=p|0,m=m|0,E=E|0;var S=0,I=0,D=0,V=0,re=0,xe=0,Fe=0,ut=0,gt=0,rt=0,_t=0,$t=0,qt=0,Wt=0,rr=0,Yt=0,rn=0,xn=0,Kr=0,pn=0;if(Kr=Je,Je=Je+48|0,I=Kr+24|0,D=Kr+12|0,xn=Kr,S=Ar(h,f,h,f,I)|0,!S&&(S=Ar(h,f,p,m,D)|0,!S)){Yt=oc(I,D)|0,rn=((Yt|0)<0)<<31>>31,v[I>>2]=0,v[I+4>>2]=0,v[I+8>>2]=0,v[D>>2]=0,v[D+4>>2]=0,v[D+8>>2]=0,Ar(h,f,h,f,I)|0&&ii(23313,23090,691,23299),Ar(h,f,p,m,D)|0&&ii(23313,23090,696,23299),V0(I),V0(D),Yt?(Fe=v[I>>2]|0,rt=+(Yt|0),qt=I+4|0,ut=v[qt>>2]|0,Wt=I+8|0,gt=v[Wt>>2]|0,rr=I,m=Fe,S=ut,p=gt,_t=+((v[D>>2]|0)-Fe|0)/rt,$t=+((v[D+4>>2]|0)-ut|0)/rt,rt=+((v[D+8>>2]|0)-gt|0)/rt):(S=I+4|0,p=I+8|0,qt=S,Wt=p,rr=I,m=v[I>>2]|0,S=v[S>>2]|0,p=v[p>>2]|0,_t=0,$t=0,rt=0),v[xn>>2]=m,gt=xn+4|0,v[gt>>2]=S,ut=xn+8|0,v[ut>>2]=p;e:do if((Yt|0)<0)S=0;else for(xe=0,Fe=0,S=m;;){re=+(Fe>>>0)+4294967296*+(xe|0),pn=_t*re+ +(S|0),V=$t*re+ +(v[qt>>2]|0),re=rt*re+ +(v[Wt>>2]|0),p=~~+ot(+pn),I=~~+ot(+V),S=~~+ot(+re),pn=+sa(+(+(p|0)-pn)),V=+sa(+(+(I|0)-V)),re=+sa(+(+(S|0)-re));do if(pn>V&pn>re)p=0-(I+S)|0,m=I;else if(D=0-p|0,V>re){m=D-S|0;break}else{m=I,S=D-I|0;break}while(0);if(v[xn>>2]=p,v[gt>>2]=m,v[ut>>2]=S,d0(xn),S=er(h,f,xn,E+(Fe<<3)|0)|0,S|0)break e;if(!((xe|0)<(rn|0)|(xe|0)==(rn|0)&Fe>>>0<Yt>>>0)){S=0;break e}S=un(Fe|0,xe|0,1,0)|0,D=lt()|0,xe=D,Fe=S,S=v[rr>>2]|0}while(0);return xn=S,Je=Kr,xn|0}return xn=S,Je=Kr,xn|0}function Or(h,f,p,m){h=h|0,f=f|0,p=p|0,m=m|0;var E=0,S=0,I=0;if((p|0)==0&(m|0)==0)return E=0,S=1,Bi(E|0),S|0;S=h,E=f,h=1,f=0;do I=(p&1|0)==0&!0,h=Ri((I?1:S)|0,(I?0:E)|0,h|0,f|0)|0,f=lt()|0,p=ct(p|0,m|0,1)|0,m=lt()|0,S=Ri(S|0,E|0,S|0,E|0)|0,E=lt()|0;while(!((p|0)==0&(m|0)==0));return Bi(f|0),h|0}function qr(h,f,p){h=h|0,f=f|0,p=p|0;var m=0,E=0,S=0,I=0,D=0,V=0,re=0,xe=0,Fe=0,ut=0;if(!(ic(f,p)|0)||(f=au(f)|0,m=+Xe[p>>3],E=+Xe[p+8>>3],E=f&E<0?E+6.283185307179586:E,ut=v[h>>2]|0,(ut|0)<=0))return ut=0,ut|0;if(Fe=v[h+4>>2]|0,f){f=0,xe=E,p=-1,h=0;e:for(;;){for(re=h;I=+Xe[Fe+(re<<4)>>3],E=+Xe[Fe+(re<<4)+8>>3],h=(p+2|0)%(ut|0)|0,S=+Xe[Fe+(h<<4)>>3],D=+Xe[Fe+(h<<4)+8>>3],I>S?(V=I,I=D):(V=S,S=I,I=E,E=D),m=m==S|m==V?m+2220446049250313e-31:m,!!(m<S|m>V);)if(p=re+1|0,(p|0)>=(ut|0)){p=22;break e}else h=re,re=p,p=h;if(D=I<0?I+6.283185307179586:I,I=E<0?E+6.283185307179586:E,xe=D==xe|I==xe?xe+-2220446049250313e-31:xe,V=D+(I-D)*((m-S)/(V-S)),(V<0?V+6.283185307179586:V)>xe&&(f=f^1),h=re+1|0,(h|0)>=(ut|0)){p=22;break}else p=re}if((p|0)==22)return f|0}else{f=0,xe=E,p=-1,h=0;e:for(;;){for(re=h;I=+Xe[Fe+(re<<4)>>3],E=+Xe[Fe+(re<<4)+8>>3],h=(p+2|0)%(ut|0)|0,S=+Xe[Fe+(h<<4)>>3],D=+Xe[Fe+(h<<4)+8>>3],I>S?(V=I,I=D):(V=S,S=I,I=E,E=D),m=m==S|m==V?m+2220446049250313e-31:m,!!(m<S|m>V);)if(p=re+1|0,(p|0)>=(ut|0)){p=22;break e}else h=re,re=p,p=h;if(xe=I==xe|E==xe?xe+-2220446049250313e-31:xe,I+(E-I)*((m-S)/(V-S))>xe&&(f=f^1),h=re+1|0,(h|0)>=(ut|0)){p=22;break}else p=re}if((p|0)==22)return f|0}return 0}function Mr(h,f){h=h|0,f=f|0;var p=0,m=0,E=0,S=0,I=0,D=0,V=0,re=0,xe=0,Fe=0,ut=0,gt=0,rt=0,_t=0,$t=0,qt=0,Wt=0;if(rt=v[h>>2]|0,!rt){v[f>>2]=0,v[f+4>>2]=0,v[f+8>>2]=0,v[f+12>>2]=0,v[f+16>>2]=0,v[f+20>>2]=0,v[f+24>>2]=0,v[f+28>>2]=0;return}if(_t=f+8|0,Xe[_t>>3]=17976931348623157e292,$t=f+24|0,Xe[$t>>3]=17976931348623157e292,Xe[f>>3]=-17976931348623157e292,qt=f+16|0,Xe[qt>>3]=-17976931348623157e292,!((rt|0)<=0)){for(ut=v[h+4>>2]|0,re=17976931348623157e292,xe=-17976931348623157e292,Fe=0,h=-1,S=17976931348623157e292,I=17976931348623157e292,V=-17976931348623157e292,m=-17976931348623157e292,gt=0;p=+Xe[ut+(gt<<4)>>3],D=+Xe[ut+(gt<<4)+8>>3],h=h+2|0,E=+Xe[ut+(((h|0)==(rt|0)?0:h)<<4)+8>>3],p<S&&(Xe[_t>>3]=p,S=p),D<I&&(Xe[$t>>3]=D,I=D),p>V?Xe[f>>3]=p:p=V,D>m&&(Xe[qt>>3]=D,m=D),re=D>0&D<re?D:re,xe=D<0&D>xe?D:xe,Fe=Fe|+sa(+(D-E))>3.141592653589793,h=gt+1|0,(h|0)!=(rt|0);)Wt=gt,V=p,gt=h,h=Wt;Fe&&(Xe[qt>>3]=xe,Xe[$t>>3]=re)}}function zr(h,f){h=h|0,f=f|0;var p=0,m=0,E=0,S=0,I=0,D=0,V=0,re=0,xe=0,Fe=0,ut=0,gt=0,rt=0,_t=0,$t=0,qt=0,Wt=0,rr=0,Yt=0,rn=0,xn=0,Kr=0;if(rt=v[h>>2]|0,rt){if(_t=f+8|0,Xe[_t>>3]=17976931348623157e292,$t=f+24|0,Xe[$t>>3]=17976931348623157e292,Xe[f>>3]=-17976931348623157e292,qt=f+16|0,Xe[qt>>3]=-17976931348623157e292,(rt|0)>0){for(E=v[h+4>>2]|0,ut=17976931348623157e292,gt=-17976931348623157e292,m=0,p=-1,V=17976931348623157e292,re=17976931348623157e292,Fe=-17976931348623157e292,I=-17976931348623157e292,Wt=0;S=+Xe[E+(Wt<<4)>>3],xe=+Xe[E+(Wt<<4)+8>>3],xn=p+2|0,D=+Xe[E+(((xn|0)==(rt|0)?0:xn)<<4)+8>>3],S<V&&(Xe[_t>>3]=S,V=S),xe<re&&(Xe[$t>>3]=xe,re=xe),S>Fe?Xe[f>>3]=S:S=Fe,xe>I&&(Xe[qt>>3]=xe,I=xe),ut=xe>0&xe<ut?xe:ut,gt=xe<0&xe>gt?xe:gt,m=m|+sa(+(xe-D))>3.141592653589793,p=Wt+1|0,(p|0)!=(rt|0);)xn=Wt,Fe=S,Wt=p,p=xn;m&&(Xe[qt>>3]=gt,Xe[$t>>3]=ut)}}else v[f>>2]=0,v[f+4>>2]=0,v[f+8>>2]=0,v[f+12>>2]=0,v[f+16>>2]=0,v[f+20>>2]=0,v[f+24>>2]=0,v[f+28>>2]=0;if(xn=h+8|0,p=v[xn>>2]|0,!((p|0)<=0)){rn=h+12|0,Yt=0;do if(E=v[rn>>2]|0,m=Yt,Yt=Yt+1|0,$t=f+(Yt<<5)|0,qt=v[E+(m<<3)>>2]|0,qt){if(Wt=f+(Yt<<5)+8|0,Xe[Wt>>3]=17976931348623157e292,h=f+(Yt<<5)+24|0,Xe[h>>3]=17976931348623157e292,Xe[$t>>3]=-17976931348623157e292,rr=f+(Yt<<5)+16|0,Xe[rr>>3]=-17976931348623157e292,(qt|0)>0){for(rt=v[E+(m<<3)+4>>2]|0,ut=17976931348623157e292,gt=-17976931348623157e292,E=0,m=-1,_t=0,V=17976931348623157e292,re=17976931348623157e292,xe=-17976931348623157e292,I=-17976931348623157e292;S=+Xe[rt+(_t<<4)>>3],Fe=+Xe[rt+(_t<<4)+8>>3],m=m+2|0,D=+Xe[rt+(((m|0)==(qt|0)?0:m)<<4)+8>>3],S<V&&(Xe[Wt>>3]=S,V=S),Fe<re&&(Xe[h>>3]=Fe,re=Fe),S>xe?Xe[$t>>3]=S:S=xe,Fe>I&&(Xe[rr>>3]=Fe,I=Fe),ut=Fe>0&Fe<ut?Fe:ut,gt=Fe<0&Fe>gt?Fe:gt,E=E|+sa(+(Fe-D))>3.141592653589793,m=_t+1|0,(m|0)!=(qt|0);)Kr=_t,_t=m,xe=S,m=Kr;E&&(Xe[rr>>3]=gt,Xe[h>>3]=ut)}}else v[$t>>2]=0,v[$t+4>>2]=0,v[$t+8>>2]=0,v[$t+12>>2]=0,v[$t+16>>2]=0,v[$t+20>>2]=0,v[$t+24>>2]=0,v[$t+28>>2]=0,p=v[xn>>2]|0;while((Yt|0)<(p|0))}}function Vt(h,f,p){h=h|0,f=f|0,p=p|0;var m=0,E=0,S=0;if(!(qr(h,f,p)|0))return E=0,E|0;if(E=h+8|0,(v[E>>2]|0)<=0)return E=1,E|0;for(m=h+12|0,h=0;;){if(S=h,h=h+1|0,qr((v[m>>2]|0)+(S<<3)|0,f+(h<<5)|0,p)|0){h=0,m=6;break}if((h|0)>=(v[E>>2]|0)){h=1,m=6;break}}return(m|0)==6?h|0:0}function lr(){return 8}function Rr(){return 16}function tn(){return 168}function _r(){return 8}function cn(){return 16}function wr(){return 12}function Hr(){return 8}function br(h){return h=h|0,+(+((v[h>>2]|0)>>>0)+4294967296*+(v[h+4>>2]|0))}function Wr(h){h=h|0;var f=0,p=0;return p=+Xe[h>>3],f=+Xe[h+8>>3],+ +ka(+(p*p+f*f))}function Cn(h,f,p,m,E){h=h|0,f=f|0,p=p|0,m=m|0,E=E|0;var S=0,I=0,D=0,V=0,re=0,xe=0,Fe=0,ut=0;re=+Xe[h>>3],V=+Xe[f>>3]-re,D=+Xe[h+8>>3],I=+Xe[f+8>>3]-D,Fe=+Xe[p>>3],S=+Xe[m>>3]-Fe,ut=+Xe[p+8>>3],xe=+Xe[m+8>>3]-ut,S=(S*(D-ut)-(re-Fe)*xe)/(V*xe-I*S),Xe[E>>3]=re+V*S,Xe[E+8>>3]=D+I*S}function Xn(h,f){return h=h|0,f=f|0,+sa(+(+Xe[h>>3]-+Xe[f>>3]))<11920928955078125e-23?(f=+sa(+(+Xe[h+8>>3]-+Xe[f+8>>3]))<11920928955078125e-23,f|0):(f=0,f|0)}function Ir(h,f){h=h|0,f=f|0;var p=0,m=0,E=0;return E=+Xe[h>>3]-+Xe[f>>3],m=+Xe[h+8>>3]-+Xe[f+8>>3],p=+Xe[h+16>>3]-+Xe[f+16>>3],+(E*E+m*m+p*p)}function Fr(h,f){h=h|0,f=f|0;var p=0,m=0,E=0;p=+Xe[h>>3],m=+ba(+p),p=+Vr(+p),Xe[f+16>>3]=p,p=+Xe[h+8>>3],E=m*+ba(+p),Xe[f>>3]=E,p=m*+Vr(+p),Xe[f+8>>3]=p}function gr(h,f,p){h=h|0,f=f|0,p=p|0;var m=0,E=0,S=0;if(S=Je,Je=Je+16|0,E=S,m=pa(h,f)|0,(p+-1|0)>>>0>5||(m=(m|0)!=0,(p|0)==1&m))return E=-1,Je=S,E|0;do if(On(h,f,E)|0)m=-1;else if(m){m=((v[21936+(p<<2)>>2]|0)+5-(v[E>>2]|0)|0)%5|0;break}else{m=((v[21968+(p<<2)>>2]|0)+6-(v[E>>2]|0)|0)%6|0;break}while(0);return E=m,Je=S,E|0}function On(h,f,p){h=h|0,f=f|0,p=p|0;var m=0,E=0,S=0,I=0,D=0,V=0,re=0;if(re=Je,Je=Je+32|0,I=re+16|0,D=re,m=Yl(h,f,I)|0,m|0)return p=m,Je=re,p|0;S=Lc(h,f)|0,V=Qs(h,f)|0,G0(S,D),m=Gf(S,v[I>>2]|0)|0;e:do if(oa(S)|0){do switch(S|0){case 4:{h=0;break}case 14:{h=1;break}case 24:{h=2;break}case 38:{h=3;break}case 49:{h=4;break}case 58:{h=5;break}case 63:{h=6;break}case 72:{h=7;break}case 83:{h=8;break}case 97:{h=9;break}case 107:{h=10;break}case 117:{h=11;break}default:{m=1;break e}}while(0);if(E=v[22e3+(h*24|0)+8>>2]|0,f=v[22e3+(h*24|0)+16>>2]|0,h=v[I>>2]|0,(h|0)!=(v[D>>2]|0)&&(D=Ua(S)|0,h=v[I>>2]|0,D|(h|0)==(f|0)&&(m=(m+1|0)%6|0)),(V|0)==3&(h|0)==(f|0)){m=(m+5|0)%6|0,E=22;break}(V|0)==5&(h|0)==(E|0)&&(m=(m+1|0)%6|0),E=22}else E=22;while(0);return(E|0)==22&&(v[p>>2]=m,m=0),p=m,Je=re,p|0}function Bn(h,f,p,m){h=h|0,f=f|0,p=p|0,m=m|0;var E=0,S=0,I=0,D=0,V=0,re=0,xe=0,Fe=0,ut=0,gt=0,rt=0,_t=0,$t=0,qt=0,Wt=0,rr=0;if(rr=Je,Je=Je+32|0,Wt=rr+24|0,$t=rr+20|0,rt=rr+8|0,gt=rr+16|0,ut=rr,V=(pa(h,f)|0)==0,V=V?6:5,xe=ft(h|0,f|0,52)|0,lt()|0,xe=xe&15,V>>>0<=p>>>0)return m=2,Je=rr,m|0;Fe=(xe|0)==0,!Fe&&(_t=Et(7,0,(xe^15)*3|0)|0,(_t&h|0)==0&((lt()|0)&f|0)==0)?E=p:S=4;e:do if((S|0)==4){if(E=(pa(h,f)|0)!=0,((E?4:5)|0)<(p|0)||On(h,f,Wt)|0||(S=(v[Wt>>2]|0)+p|0,E?E=22288+(((S|0)%5|0)<<2)|0:E=22320+(((S|0)%6|0)<<2)|0,_t=v[E>>2]|0,(_t|0)==7))return m=1,Je=rr,m|0;v[$t>>2]=0,E=Uo(h,f,_t,$t,rt)|0;do if(!E){if(D=rt,re=v[D>>2]|0,D=v[D+4>>2]|0,I=D>>>0<f>>>0|(D|0)==(f|0)&re>>>0<h>>>0,S=I?re:h,I=I?D:f,!Fe&&(Fe=Et(7,0,(xe^15)*3|0)|0,(re&Fe|0)==0&(D&(lt()|0)|0)==0))E=p;else{if(D=(p+-1+V|0)%(V|0)|0,E=pa(h,f)|0,(D|0)<0&&ii(23313,23315,245,23324),V=(E|0)!=0,((V?4:5)|0)<(D|0)&&ii(23313,23315,245,23324),On(h,f,Wt)|0&&ii(23313,23315,245,23324),E=(v[Wt>>2]|0)+D|0,V?E=22288+(((E|0)%5|0)<<2)|0:E=22320+(((E|0)%6|0)<<2)|0,D=v[E>>2]|0,(D|0)==7&&ii(23313,23315,245,23324),v[gt>>2]=0,E=Uo(h,f,D,gt,ut)|0,E|0)break;re=ut,V=v[re>>2]|0,re=v[re+4>>2]|0;do if(re>>>0<I>>>0|(re|0)==(I|0)&V>>>0<S>>>0){if(pa(V,re)|0?S=Zf(V,re,h,f)|0:S=v[22384+((((v[gt>>2]|0)+(v[22352+(D<<2)>>2]|0)|0)%6|0)<<2)>>2]|0,E=pa(V,re)|0,(S+-1|0)>>>0>5){E=-1,S=V,I=re;break}if(E=(E|0)!=0,(S|0)==1&E){E=-1,S=V,I=re;break}do if(On(V,re,Wt)|0)E=-1;else if(E){E=((v[21936+(S<<2)>>2]|0)+5-(v[Wt>>2]|0)|0)%5|0;break}else{E=((v[21968+(S<<2)>>2]|0)+6-(v[Wt>>2]|0)|0)%6|0;break}while(0);S=V,I=re}else E=p;while(0);D=rt,re=v[D>>2]|0,D=v[D+4>>2]|0}if((S|0)==(re|0)&(I|0)==(D|0)){if(V=(pa(re,D)|0)!=0,V?h=Zf(re,D,h,f)|0:h=v[22384+((((v[$t>>2]|0)+(v[22352+(_t<<2)>>2]|0)|0)%6|0)<<2)>>2]|0,E=pa(re,D)|0,(h+-1|0)>>>0<=5&&(qt=(E|0)!=0,!((h|0)==1&qt)))do if(On(re,D,Wt)|0)E=-1;else if(qt){E=((v[21936+(h<<2)>>2]|0)+5-(v[Wt>>2]|0)|0)%5|0;break}else{E=((v[21968+(h<<2)>>2]|0)+6-(v[Wt>>2]|0)|0)%6|0;break}while(0);else E=-1;E=E+1|0,E=(E|0)==6|V&(E|0)==5?0:E}f=I,h=S;break e}while(0);return m=E,Je=rr,m|0}while(0);return qt=Et(E|0,0,56)|0,Wt=lt()|0|f&-2130706433|536870912,v[m>>2]=qt|h,v[m+4>>2]=Wt,m=0,Je=rr,m|0}function gn(h,f,p){h=h|0,f=f|0,p=p|0;var m=0,E=0,S=0;return S=(pa(h,f)|0)==0,m=Bn(h,f,0,p)|0,E=(m|0)==0,S?!E||(m=Bn(h,f,1,p+8|0)|0,m|0)||(m=Bn(h,f,2,p+16|0)|0,m|0)||(m=Bn(h,f,3,p+24|0)|0,m|0)||(m=Bn(h,f,4,p+32|0)|0,m)?(S=m,S|0):Bn(h,f,5,p+40|0)|0:!E||(m=Bn(h,f,1,p+8|0)|0,m|0)||(m=Bn(h,f,2,p+16|0)|0,m|0)||(m=Bn(h,f,3,p+24|0)|0,m|0)||(m=Bn(h,f,4,p+32|0)|0,m|0)?(S=m,S|0):(S=p+40|0,v[S>>2]=0,v[S+4>>2]=0,S=0,S|0)}function xi(h,f,p){h=h|0,f=f|0,p=p|0;var m=0,E=0,S=0,I=0,D=0,V=0;return V=Je,Je=Je+192|0,E=V,S=V+168|0,I=ft(h|0,f|0,56)|0,lt()|0,I=I&7,D=f&-2130706433|134217728,m=Yl(h,D,S)|0,m|0?(D=m,Je=V,D|0):(f=ft(h|0,f|0,52)|0,lt()|0,f=f&15,pa(h,D)|0?wf(S,f,I,1,E):uc(S,f,I,1,E),D=E+8|0,v[p>>2]=v[D>>2],v[p+4>>2]=v[D+4>>2],v[p+8>>2]=v[D+8>>2],v[p+12>>2]=v[D+12>>2],D=0,Je=V,D|0)}function Jn(h,f){h=h|0,f=f|0;var p=0,m=0,E=0,S=0;return E=Je,Je=Je+16|0,p=E,!(!0&(f&2013265920|0)==536870912)||(m=f&-2130706433|134217728,!(sf(h,m)|0))?(m=0,Je=E,m|0):(S=ft(h|0,f|0,56)|0,lt()|0,S=(Bn(h,m,S&7,p)|0)==0,m=p,m=S&((v[m>>2]|0)==(h|0)?(v[m+4>>2]|0)==(f|0):0)&1,Je=E,m|0)}function gi(h,f,p){h=h|0,f=f|0,p=p|0;var m=0;(f|0)>0?(m=ya(f,4)|0,v[h>>2]=m,m||ii(23337,23360,40,23374)):v[h>>2]=0,v[h+4>>2]=f,v[h+8>>2]=0,v[h+12>>2]=p}function ta(h){h=h|0;var f=0,p=0,m=0,E=0,S=0,I=0,D=0;E=h+4|0,S=h+12|0,I=h+8|0;e:for(;;){for(p=v[E>>2]|0,f=0;;){if((f|0)>=(p|0))break e;if(m=v[h>>2]|0,D=v[m+(f<<2)>>2]|0,!D)f=f+1|0;else break}f=m+(~~(+sa(+(+os(10,+ +(15-(v[S>>2]|0)|0))*(+Xe[D>>3]+ +Xe[D+8>>3])))%+(p|0))>>>0<<2)|0,p=v[f>>2]|0;t:do if(p|0){if(m=D+32|0,(p|0)==(D|0))v[f>>2]=v[m>>2];else{if(p=p+32|0,f=v[p>>2]|0,!f)break;for(;(f|0)!=(D|0);)if(p=f+32|0,f=v[p>>2]|0,!f)break t;v[p>>2]=v[m>>2]}Tn(D),v[I>>2]=(v[I>>2]|0)+-1}while(0)}Tn(v[h>>2]|0)}function bo(h){h=h|0;var f=0,p=0,m=0;for(m=v[h+4>>2]|0,p=0;;){if((p|0)>=(m|0)){f=0,p=4;break}if(f=v[(v[h>>2]|0)+(p<<2)>>2]|0,!f)p=p+1|0;else{p=4;break}}return(p|0)==4?f|0:0}function ro(h,f){h=h|0,f=f|0;var p=0,m=0,E=0,S=0;if(p=~~(+sa(+(+os(10,+ +(15-(v[h+12>>2]|0)|0))*(+Xe[f>>3]+ +Xe[f+8>>3])))%+(v[h+4>>2]|0))>>>0,p=(v[h>>2]|0)+(p<<2)|0,m=v[p>>2]|0,!m)return S=1,S|0;S=f+32|0;do if((m|0)!=(f|0)){if(p=v[m+32>>2]|0,!p)return S=1,S|0;for(E=p;;){if((E|0)==(f|0)){E=8;break}if(p=v[E+32>>2]|0,p)m=E,E=p;else{p=1,E=10;break}}if((E|0)==8){v[m+32>>2]=v[S>>2];break}else if((E|0)==10)return p|0}else v[p>>2]=v[S>>2];while(0);return Tn(f),S=h+8|0,v[S>>2]=(v[S>>2]|0)+-1,S=0,S|0}function Ti(h,f,p){h=h|0,f=f|0,p=p|0;var m=0,E=0,S=0,I=0;S=Ga(40)|0,S||ii(23390,23360,98,23403),v[S>>2]=v[f>>2],v[S+4>>2]=v[f+4>>2],v[S+8>>2]=v[f+8>>2],v[S+12>>2]=v[f+12>>2],E=S+16|0,v[E>>2]=v[p>>2],v[E+4>>2]=v[p+4>>2],v[E+8>>2]=v[p+8>>2],v[E+12>>2]=v[p+12>>2],v[S+32>>2]=0,E=~~(+sa(+(+os(10,+ +(15-(v[h+12>>2]|0)|0))*(+Xe[f>>3]+ +Xe[f+8>>3])))%+(v[h+4>>2]|0))>>>0,E=(v[h>>2]|0)+(E<<2)|0,m=v[E>>2]|0;do if(!m)v[E>>2]=S;else{for(;!(Ko(m,f)|0&&Ko(m+16|0,p)|0);)if(E=v[m+32>>2]|0,m=E|0?E:m,!(v[m+32>>2]|0)){I=10;break}if((I|0)==10){v[m+32>>2]=S;break}return Tn(S),I=m,I|0}while(0);return I=h+8|0,v[I>>2]=(v[I>>2]|0)+1,I=S,I|0}function Io(h,f,p){h=h|0,f=f|0,p=p|0;var m=0,E=0;if(E=~~(+sa(+(+os(10,+ +(15-(v[h+12>>2]|0)|0))*(+Xe[f>>3]+ +Xe[f+8>>3])))%+(v[h+4>>2]|0))>>>0,E=v[(v[h>>2]|0)+(E<<2)>>2]|0,!E)return p=0,p|0;if(!p){for(h=E;;){if(Ko(h,f)|0){m=10;break}if(h=v[h+32>>2]|0,!h){h=0,m=10;break}}if((m|0)==10)return h|0}for(h=E;;){if(Ko(h,f)|0&&Ko(h+16|0,p)|0){m=10;break}if(h=v[h+32>>2]|0,!h){h=0,m=10;break}}return(m|0)==10?h|0:0}function Na(h,f){h=h|0,f=f|0;var p=0;if(p=~~(+sa(+(+os(10,+ +(15-(v[h+12>>2]|0)|0))*(+Xe[f>>3]+ +Xe[f+8>>3])))%+(v[h+4>>2]|0))>>>0,h=v[(v[h>>2]|0)+(p<<2)>>2]|0,!h)return p=0,p|0;for(;;){if(Ko(h,f)|0){f=5;break}if(h=v[h+32>>2]|0,!h){h=0,f=5;break}}return(f|0)==5?h|0:0}function Ao(){return 23424}function jo(h){return h=+h,+ +Dt(+h)}function Fa(h){return h=+h,~~+jo(h)|0}function Ga(h){h=h|0;var f=0,p=0,m=0,E=0,S=0,I=0,D=0,V=0,re=0,xe=0,Fe=0,ut=0,gt=0,rt=0,_t=0,$t=0,qt=0,Wt=0,rr=0,Yt=0,rn=0;rn=Je,Je=Je+16|0,ut=rn;do if(h>>>0<245){if(re=h>>>0<11?16:h+11&-8,h=re>>>3,Fe=v[5857]|0,p=Fe>>>h,p&3|0)return f=(p&1^1)+h|0,h=23468+(f<<1<<2)|0,p=h+8|0,m=v[p>>2]|0,E=m+8|0,S=v[E>>2]|0,(S|0)==(h|0)?v[5857]=Fe&~(1<<f):(v[S+12>>2]=h,v[p>>2]=S),Yt=f<<3,v[m+4>>2]=Yt|3,Yt=m+Yt+4|0,v[Yt>>2]=v[Yt>>2]|1,Yt=E,Je=rn,Yt|0;if(xe=v[5859]|0,re>>>0>xe>>>0){if(p|0)return f=2<<h,f=p<<h&(f|0-f),f=(f&0-f)+-1|0,D=f>>>12&16,f=f>>>D,p=f>>>5&8,f=f>>>p,S=f>>>2&4,f=f>>>S,h=f>>>1&2,f=f>>>h,m=f>>>1&1,m=(p|D|S|h|m)+(f>>>m)|0,f=23468+(m<<1<<2)|0,h=f+8|0,S=v[h>>2]|0,D=S+8|0,p=v[D>>2]|0,(p|0)==(f|0)?(h=Fe&~(1<<m),v[5857]=h):(v[p+12>>2]=f,v[h>>2]=p,h=Fe),Yt=m<<3,I=Yt-re|0,v[S+4>>2]=re|3,E=S+re|0,v[E+4>>2]=I|1,v[S+Yt>>2]=I,xe|0&&(m=v[5862]|0,f=xe>>>3,p=23468+(f<<1<<2)|0,f=1<<f,h&f?(h=p+8|0,f=v[h>>2]|0):(v[5857]=h|f,f=p,h=p+8|0),v[h>>2]=m,v[f+12>>2]=m,v[m+8>>2]=f,v[m+12>>2]=p),v[5859]=I,v[5862]=E,Yt=D,Je=rn,Yt|0;if(S=v[5858]|0,S){for(p=(S&0-S)+-1|0,E=p>>>12&16,p=p>>>E,m=p>>>5&8,p=p>>>m,I=p>>>2&4,p=p>>>I,D=p>>>1&2,p=p>>>D,V=p>>>1&1,V=v[23732+((m|E|I|D|V)+(p>>>V)<<2)>>2]|0,p=V,D=V,V=(v[V+4>>2]&-8)-re|0;h=v[p+16>>2]|0,!(!h&&(h=v[p+20>>2]|0,!h));)I=(v[h+4>>2]&-8)-re|0,E=I>>>0<V>>>0,p=h,D=E?h:D,V=E?I:V;if(I=D+re|0,I>>>0>D>>>0){E=v[D+24>>2]|0,f=v[D+12>>2]|0;do if((f|0)==(D|0)){if(h=D+20|0,f=v[h>>2]|0,!f&&(h=D+16|0,f=v[h>>2]|0,!f)){p=0;break}for(;;)if(m=f+20|0,p=v[m>>2]|0,p)f=p,h=m;else if(m=f+16|0,p=v[m>>2]|0,p)f=p,h=m;else break;v[h>>2]=0,p=f}else p=v[D+8>>2]|0,v[p+12>>2]=f,v[f+8>>2]=p,p=f;while(0);do if(E|0){if(f=v[D+28>>2]|0,h=23732+(f<<2)|0,(D|0)==(v[h>>2]|0)){if(v[h>>2]=p,!p){v[5858]=S&~(1<<f);break}}else if(Yt=E+16|0,v[((v[Yt>>2]|0)==(D|0)?Yt:E+20|0)>>2]=p,!p)break;v[p+24>>2]=E,f=v[D+16>>2]|0,f|0&&(v[p+16>>2]=f,v[f+24>>2]=p),f=v[D+20>>2]|0,f|0&&(v[p+20>>2]=f,v[f+24>>2]=p)}while(0);return V>>>0<16?(Yt=V+re|0,v[D+4>>2]=Yt|3,Yt=D+Yt+4|0,v[Yt>>2]=v[Yt>>2]|1):(v[D+4>>2]=re|3,v[I+4>>2]=V|1,v[I+V>>2]=V,xe|0&&(m=v[5862]|0,f=xe>>>3,p=23468+(f<<1<<2)|0,f=1<<f,f&Fe?(h=p+8|0,f=v[h>>2]|0):(v[5857]=f|Fe,f=p,h=p+8|0),v[h>>2]=m,v[f+12>>2]=m,v[m+8>>2]=f,v[m+12>>2]=p),v[5859]=V,v[5862]=I),Yt=D+8|0,Je=rn,Yt|0}else Fe=re}else Fe=re}else Fe=re}else if(h>>>0<=4294967231)if(h=h+11|0,re=h&-8,m=v[5858]|0,m){E=0-re|0,h=h>>>8,h?re>>>0>16777215?V=31:(Fe=(h+1048320|0)>>>16&8,_t=h<<Fe,D=(_t+520192|0)>>>16&4,_t=_t<<D,V=(_t+245760|0)>>>16&2,V=14-(D|Fe|V)+(_t<<V>>>15)|0,V=re>>>(V+7|0)&1|V<<1):V=0,p=v[23732+(V<<2)>>2]|0;e:do if(!p)p=0,h=0,_t=61;else for(h=0,D=re<<((V|0)==31?0:25-(V>>>1)|0),S=0;;){if(I=(v[p+4>>2]&-8)-re|0,I>>>0<E>>>0)if(I)h=p,E=I;else{h=p,E=0,_t=65;break e}if(_t=v[p+20>>2]|0,p=v[p+16+(D>>>31<<2)>>2]|0,S=(_t|0)==0|(_t|0)==(p|0)?S:_t,p)D=D<<1;else{p=S,_t=61;break}}while(0);if((_t|0)==61){if((p|0)==0&(h|0)==0){if(h=2<<V,h=(h|0-h)&m,!h){Fe=re;break}Fe=(h&0-h)+-1|0,I=Fe>>>12&16,Fe=Fe>>>I,S=Fe>>>5&8,Fe=Fe>>>S,D=Fe>>>2&4,Fe=Fe>>>D,V=Fe>>>1&2,Fe=Fe>>>V,p=Fe>>>1&1,h=0,p=v[23732+((S|I|D|V|p)+(Fe>>>p)<<2)>>2]|0}p?_t=65:(D=h,I=E)}if((_t|0)==65)for(S=p;;)if(Fe=(v[S+4>>2]&-8)-re|0,p=Fe>>>0<E>>>0,E=p?Fe:E,h=p?S:h,p=v[S+16>>2]|0,p||(p=v[S+20>>2]|0),p)S=p;else{D=h,I=E;break}if(D|0&&I>>>0<((v[5859]|0)-re|0)>>>0&&(xe=D+re|0,xe>>>0>D>>>0)){S=v[D+24>>2]|0,f=v[D+12>>2]|0;do if((f|0)==(D|0)){if(h=D+20|0,f=v[h>>2]|0,!f&&(h=D+16|0,f=v[h>>2]|0,!f)){f=0;break}for(;;)if(E=f+20|0,p=v[E>>2]|0,p)f=p,h=E;else if(E=f+16|0,p=v[E>>2]|0,p)f=p,h=E;else break;v[h>>2]=0}else Yt=v[D+8>>2]|0,v[Yt+12>>2]=f,v[f+8>>2]=Yt;while(0);do if(S){if(h=v[D+28>>2]|0,p=23732+(h<<2)|0,(D|0)==(v[p>>2]|0)){if(v[p>>2]=f,!f){m=m&~(1<<h),v[5858]=m;break}}else if(Yt=S+16|0,v[((v[Yt>>2]|0)==(D|0)?Yt:S+20|0)>>2]=f,!f)break;v[f+24>>2]=S,h=v[D+16>>2]|0,h|0&&(v[f+16>>2]=h,v[h+24>>2]=f),h=v[D+20>>2]|0,h&&(v[f+20>>2]=h,v[h+24>>2]=f)}while(0);e:do if(I>>>0<16)Yt=I+re|0,v[D+4>>2]=Yt|3,Yt=D+Yt+4|0,v[Yt>>2]=v[Yt>>2]|1;else{if(v[D+4>>2]=re|3,v[xe+4>>2]=I|1,v[xe+I>>2]=I,f=I>>>3,I>>>0<256){p=23468+(f<<1<<2)|0,h=v[5857]|0,f=1<<f,h&f?(h=p+8|0,f=v[h>>2]|0):(v[5857]=h|f,f=p,h=p+8|0),v[h>>2]=xe,v[f+12>>2]=xe,v[xe+8>>2]=f,v[xe+12>>2]=p;break}if(f=I>>>8,f?I>>>0>16777215?p=31:(rr=(f+1048320|0)>>>16&8,Yt=f<<rr,Wt=(Yt+520192|0)>>>16&4,Yt=Yt<<Wt,p=(Yt+245760|0)>>>16&2,p=14-(Wt|rr|p)+(Yt<<p>>>15)|0,p=I>>>(p+7|0)&1|p<<1):p=0,f=23732+(p<<2)|0,v[xe+28>>2]=p,h=xe+16|0,v[h+4>>2]=0,v[h>>2]=0,h=1<<p,!(m&h)){v[5858]=m|h,v[f>>2]=xe,v[xe+24>>2]=f,v[xe+12>>2]=xe,v[xe+8>>2]=xe;break}f=v[f>>2]|0;t:do if((v[f+4>>2]&-8|0)!=(I|0)){for(m=I<<((p|0)==31?0:25-(p>>>1)|0);p=f+16+(m>>>31<<2)|0,h=v[p>>2]|0,!!h;)if((v[h+4>>2]&-8|0)==(I|0)){f=h;break t}else m=m<<1,f=h;v[p>>2]=xe,v[xe+24>>2]=f,v[xe+12>>2]=xe,v[xe+8>>2]=xe;break e}while(0);rr=f+8|0,Yt=v[rr>>2]|0,v[Yt+12>>2]=xe,v[rr>>2]=xe,v[xe+8>>2]=Yt,v[xe+12>>2]=f,v[xe+24>>2]=0}while(0);return Yt=D+8|0,Je=rn,Yt|0}else Fe=re}else Fe=re;else Fe=-1;while(0);if(p=v[5859]|0,p>>>0>=Fe>>>0)return f=p-Fe|0,h=v[5862]|0,f>>>0>15?(Yt=h+Fe|0,v[5862]=Yt,v[5859]=f,v[Yt+4>>2]=f|1,v[h+p>>2]=f,v[h+4>>2]=Fe|3):(v[5859]=0,v[5862]=0,v[h+4>>2]=p|3,Yt=h+p+4|0,v[Yt>>2]=v[Yt>>2]|1),Yt=h+8|0,Je=rn,Yt|0;if(I=v[5860]|0,I>>>0>Fe>>>0)return Wt=I-Fe|0,v[5860]=Wt,Yt=v[5863]|0,rr=Yt+Fe|0,v[5863]=rr,v[rr+4>>2]=Wt|1,v[Yt+4>>2]=Fe|3,Yt=Yt+8|0,Je=rn,Yt|0;if(v[5975]|0?h=v[5977]|0:(v[5977]=4096,v[5976]=4096,v[5978]=-1,v[5979]=-1,v[5980]=0,v[5968]=0,v[5975]=ut&-16^1431655768,h=4096),D=Fe+48|0,V=Fe+47|0,S=h+V|0,E=0-h|0,re=S&E,re>>>0<=Fe>>>0||(h=v[5967]|0,h|0&&(xe=v[5965]|0,ut=xe+re|0,ut>>>0<=xe>>>0|ut>>>0>h>>>0)))return Yt=0,Je=rn,Yt|0;e:do if(v[5968]&4)f=0,_t=143;else{p=v[5863]|0;t:do if(p){for(m=23876;ut=v[m>>2]|0,!(ut>>>0<=p>>>0&&(ut+(v[m+4>>2]|0)|0)>>>0>p>>>0);)if(h=v[m+8>>2]|0,h)m=h;else{_t=128;break t}if(f=S-I&E,f>>>0<2147483647)if(h=Ft(f|0)|0,(h|0)==((v[m>>2]|0)+(v[m+4>>2]|0)|0)){if((h|0)!=-1){I=f,S=h,_t=145;break e}}else m=h,_t=136;else f=0}else _t=128;while(0);do if((_t|0)==128)if(p=Ft(0)|0,(p|0)!=-1&&(f=p,gt=v[5976]|0,rt=gt+-1|0,f=(rt&f|0?(rt+f&0-gt)-f|0:0)+re|0,gt=v[5965]|0,rt=f+gt|0,f>>>0>Fe>>>0&f>>>0<2147483647)){if(ut=v[5967]|0,ut|0&&rt>>>0<=gt>>>0|rt>>>0>ut>>>0){f=0;break}if(h=Ft(f|0)|0,(h|0)==(p|0)){I=f,S=p,_t=145;break e}else m=h,_t=136}else f=0;while(0);do if((_t|0)==136){if(p=0-f|0,!(D>>>0>f>>>0&(f>>>0<2147483647&(m|0)!=-1)))if((m|0)==-1){f=0;break}else{I=f,S=m,_t=145;break e}if(h=v[5977]|0,h=V-f+h&0-h,h>>>0>=2147483647){I=f,S=m,_t=145;break e}if((Ft(h|0)|0)==-1){Ft(p|0)|0,f=0;break}else{I=h+f|0,S=m,_t=145;break e}}while(0);v[5968]=v[5968]|4,_t=143}while(0);if((_t|0)==143&&re>>>0<2147483647&&(Wt=Ft(re|0)|0,rt=Ft(0)|0,$t=rt-Wt|0,qt=$t>>>0>(Fe+40|0)>>>0,!((Wt|0)==-1|qt^1|Wt>>>0<rt>>>0&((Wt|0)!=-1&(rt|0)!=-1)^1))&&(I=qt?$t:f,S=Wt,_t=145),(_t|0)==145){f=(v[5965]|0)+I|0,v[5965]=f,f>>>0>(v[5966]|0)>>>0&&(v[5966]=f),V=v[5863]|0;e:do if(V){for(f=23876;;){if(h=v[f>>2]|0,p=v[f+4>>2]|0,(S|0)==(h+p|0)){_t=154;break}if(m=v[f+8>>2]|0,m)f=m;else break}if((_t|0)==154&&(rr=f+4|0,(v[f+12>>2]&8|0)==0)&&S>>>0>V>>>0&h>>>0<=V>>>0){v[rr>>2]=p+I,Yt=(v[5860]|0)+I|0,Wt=V+8|0,Wt=Wt&7|0?0-Wt&7:0,rr=V+Wt|0,Wt=Yt-Wt|0,v[5863]=rr,v[5860]=Wt,v[rr+4>>2]=Wt|1,v[V+Yt+4>>2]=40,v[5864]=v[5979];break}for(S>>>0<(v[5861]|0)>>>0&&(v[5861]=S),p=S+I|0,f=23876;;){if((v[f>>2]|0)==(p|0)){_t=162;break}if(h=v[f+8>>2]|0,h)f=h;else break}if((_t|0)==162&&!(v[f+12>>2]&8|0)){v[f>>2]=S,xe=f+4|0,v[xe>>2]=(v[xe>>2]|0)+I,xe=S+8|0,xe=S+(xe&7|0?0-xe&7:0)|0,f=p+8|0,f=p+(f&7|0?0-f&7:0)|0,re=xe+Fe|0,D=f-xe-Fe|0,v[xe+4>>2]=Fe|3;t:do if((V|0)==(f|0))Yt=(v[5860]|0)+D|0,v[5860]=Yt,v[5863]=re,v[re+4>>2]=Yt|1;else{if((v[5862]|0)==(f|0)){Yt=(v[5859]|0)+D|0,v[5859]=Yt,v[5862]=re,v[re+4>>2]=Yt|1,v[re+Yt>>2]=Yt;break}if(h=v[f+4>>2]|0,(h&3|0)==1){I=h&-8,m=h>>>3;r:do if(h>>>0<256)if(h=v[f+8>>2]|0,p=v[f+12>>2]|0,(p|0)==(h|0)){v[5857]=v[5857]&~(1<<m);break}else{v[h+12>>2]=p,v[p+8>>2]=h;break}else{S=v[f+24>>2]|0,h=v[f+12>>2]|0;do if((h|0)==(f|0)){if(p=f+16|0,m=p+4|0,h=v[m>>2]|0,h)p=m;else if(h=v[p>>2]|0,!h){h=0;break}for(;;)if(E=h+20|0,m=v[E>>2]|0,m)h=m,p=E;else if(E=h+16|0,m=v[E>>2]|0,m)h=m,p=E;else break;v[p>>2]=0}else Yt=v[f+8>>2]|0,v[Yt+12>>2]=h,v[h+8>>2]=Yt;while(0);if(!S)break;p=v[f+28>>2]|0,m=23732+(p<<2)|0;do if((v[m>>2]|0)!=(f|0)){if(Yt=S+16|0,v[((v[Yt>>2]|0)==(f|0)?Yt:S+20|0)>>2]=h,!h)break r}else{if(v[m>>2]=h,h|0)break;v[5858]=v[5858]&~(1<<p);break r}while(0);if(v[h+24>>2]=S,p=f+16|0,m=v[p>>2]|0,m|0&&(v[h+16>>2]=m,v[m+24>>2]=h),p=v[p+4>>2]|0,!p)break;v[h+20>>2]=p,v[p+24>>2]=h}while(0);f=f+I|0,E=I+D|0}else E=D;if(f=f+4|0,v[f>>2]=v[f>>2]&-2,v[re+4>>2]=E|1,v[re+E>>2]=E,f=E>>>3,E>>>0<256){p=23468+(f<<1<<2)|0,h=v[5857]|0,f=1<<f,h&f?(h=p+8|0,f=v[h>>2]|0):(v[5857]=h|f,f=p,h=p+8|0),v[h>>2]=re,v[f+12>>2]=re,v[re+8>>2]=f,v[re+12>>2]=p;break}f=E>>>8;do if(!f)m=0;else{if(E>>>0>16777215){m=31;break}rr=(f+1048320|0)>>>16&8,Yt=f<<rr,Wt=(Yt+520192|0)>>>16&4,Yt=Yt<<Wt,m=(Yt+245760|0)>>>16&2,m=14-(Wt|rr|m)+(Yt<<m>>>15)|0,m=E>>>(m+7|0)&1|m<<1}while(0);if(f=23732+(m<<2)|0,v[re+28>>2]=m,h=re+16|0,v[h+4>>2]=0,v[h>>2]=0,h=v[5858]|0,p=1<<m,!(h&p)){v[5858]=h|p,v[f>>2]=re,v[re+24>>2]=f,v[re+12>>2]=re,v[re+8>>2]=re;break}f=v[f>>2]|0;r:do if((v[f+4>>2]&-8|0)!=(E|0)){for(m=E<<((m|0)==31?0:25-(m>>>1)|0);p=f+16+(m>>>31<<2)|0,h=v[p>>2]|0,!!h;)if((v[h+4>>2]&-8|0)==(E|0)){f=h;break r}else m=m<<1,f=h;v[p>>2]=re,v[re+24>>2]=f,v[re+12>>2]=re,v[re+8>>2]=re;break t}while(0);rr=f+8|0,Yt=v[rr>>2]|0,v[Yt+12>>2]=re,v[rr>>2]=re,v[re+8>>2]=Yt,v[re+12>>2]=f,v[re+24>>2]=0}while(0);return Yt=xe+8|0,Je=rn,Yt|0}for(f=23876;h=v[f>>2]|0,!(h>>>0<=V>>>0&&(Yt=h+(v[f+4>>2]|0)|0,Yt>>>0>V>>>0));)f=v[f+8>>2]|0;E=Yt+-47|0,h=E+8|0,h=E+(h&7|0?0-h&7:0)|0,E=V+16|0,h=h>>>0<E>>>0?V:h,f=h+8|0,p=I+-40|0,Wt=S+8|0,Wt=Wt&7|0?0-Wt&7:0,rr=S+Wt|0,Wt=p-Wt|0,v[5863]=rr,v[5860]=Wt,v[rr+4>>2]=Wt|1,v[S+p+4>>2]=40,v[5864]=v[5979],p=h+4|0,v[p>>2]=27,v[f>>2]=v[5969],v[f+4>>2]=v[5970],v[f+8>>2]=v[5971],v[f+12>>2]=v[5972],v[5969]=S,v[5970]=I,v[5972]=0,v[5971]=f,f=h+24|0;do rr=f,f=f+4|0,v[f>>2]=7;while((rr+8|0)>>>0<Yt>>>0);if((h|0)!=(V|0)){if(S=h-V|0,v[p>>2]=v[p>>2]&-2,v[V+4>>2]=S|1,v[h>>2]=S,f=S>>>3,S>>>0<256){p=23468+(f<<1<<2)|0,h=v[5857]|0,f=1<<f,h&f?(h=p+8|0,f=v[h>>2]|0):(v[5857]=h|f,f=p,h=p+8|0),v[h>>2]=V,v[f+12>>2]=V,v[V+8>>2]=f,v[V+12>>2]=p;break}if(f=S>>>8,f?S>>>0>16777215?m=31:(rr=(f+1048320|0)>>>16&8,Yt=f<<rr,Wt=(Yt+520192|0)>>>16&4,Yt=Yt<<Wt,m=(Yt+245760|0)>>>16&2,m=14-(Wt|rr|m)+(Yt<<m>>>15)|0,m=S>>>(m+7|0)&1|m<<1):m=0,p=23732+(m<<2)|0,v[V+28>>2]=m,v[V+20>>2]=0,v[E>>2]=0,f=v[5858]|0,h=1<<m,!(f&h)){v[5858]=f|h,v[p>>2]=V,v[V+24>>2]=p,v[V+12>>2]=V,v[V+8>>2]=V;break}f=v[p>>2]|0;t:do if((v[f+4>>2]&-8|0)!=(S|0)){for(m=S<<((m|0)==31?0:25-(m>>>1)|0);p=f+16+(m>>>31<<2)|0,h=v[p>>2]|0,!!h;)if((v[h+4>>2]&-8|0)==(S|0)){f=h;break t}else m=m<<1,f=h;v[p>>2]=V,v[V+24>>2]=f,v[V+12>>2]=V,v[V+8>>2]=V;break e}while(0);rr=f+8|0,Yt=v[rr>>2]|0,v[Yt+12>>2]=V,v[rr>>2]=V,v[V+8>>2]=Yt,v[V+12>>2]=f,v[V+24>>2]=0}}else Yt=v[5861]|0,(Yt|0)==0|S>>>0<Yt>>>0&&(v[5861]=S),v[5969]=S,v[5970]=I,v[5972]=0,v[5866]=v[5975],v[5865]=-1,v[5870]=23468,v[5869]=23468,v[5872]=23476,v[5871]=23476,v[5874]=23484,v[5873]=23484,v[5876]=23492,v[5875]=23492,v[5878]=23500,v[5877]=23500,v[5880]=23508,v[5879]=23508,v[5882]=23516,v[5881]=23516,v[5884]=23524,v[5883]=23524,v[5886]=23532,v[5885]=23532,v[5888]=23540,v[5887]=23540,v[5890]=23548,v[5889]=23548,v[5892]=23556,v[5891]=23556,v[5894]=23564,v[5893]=23564,v[5896]=23572,v[5895]=23572,v[5898]=23580,v[5897]=23580,v[5900]=23588,v[5899]=23588,v[5902]=23596,v[5901]=23596,v[5904]=23604,v[5903]=23604,v[5906]=23612,v[5905]=23612,v[5908]=23620,v[5907]=23620,v[5910]=23628,v[5909]=23628,v[5912]=23636,v[5911]=23636,v[5914]=23644,v[5913]=23644,v[5916]=23652,v[5915]=23652,v[5918]=23660,v[5917]=23660,v[5920]=23668,v[5919]=23668,v[5922]=23676,v[5921]=23676,v[5924]=23684,v[5923]=23684,v[5926]=23692,v[5925]=23692,v[5928]=23700,v[5927]=23700,v[5930]=23708,v[5929]=23708,v[5932]=23716,v[5931]=23716,Yt=I+-40|0,Wt=S+8|0,Wt=Wt&7|0?0-Wt&7:0,rr=S+Wt|0,Wt=Yt-Wt|0,v[5863]=rr,v[5860]=Wt,v[rr+4>>2]=Wt|1,v[S+Yt+4>>2]=40,v[5864]=v[5979];while(0);if(f=v[5860]|0,f>>>0>Fe>>>0)return Wt=f-Fe|0,v[5860]=Wt,Yt=v[5863]|0,rr=Yt+Fe|0,v[5863]=rr,v[rr+4>>2]=Wt|1,v[Yt+4>>2]=Fe|3,Yt=Yt+8|0,Je=rn,Yt|0}return Yt=Ao()|0,v[Yt>>2]=12,Yt=0,Je=rn,Yt|0}function Tn(h){h=h|0;var f=0,p=0,m=0,E=0,S=0,I=0,D=0,V=0;if(h){p=h+-8|0,E=v[5861]|0,h=v[h+-4>>2]|0,f=h&-8,V=p+f|0;do if(h&1)D=p,I=p;else{if(m=v[p>>2]|0,!(h&3)||(I=p+(0-m)|0,S=m+f|0,I>>>0<E>>>0))return;if((v[5862]|0)==(I|0)){if(h=V+4|0,f=v[h>>2]|0,(f&3|0)!=3){D=I,f=S;break}v[5859]=S,v[h>>2]=f&-2,v[I+4>>2]=S|1,v[I+S>>2]=S;return}if(p=m>>>3,m>>>0<256)if(h=v[I+8>>2]|0,f=v[I+12>>2]|0,(f|0)==(h|0)){v[5857]=v[5857]&~(1<<p),D=I,f=S;break}else{v[h+12>>2]=f,v[f+8>>2]=h,D=I,f=S;break}E=v[I+24>>2]|0,h=v[I+12>>2]|0;do if((h|0)==(I|0)){if(f=I+16|0,p=f+4|0,h=v[p>>2]|0,h)f=p;else if(h=v[f>>2]|0,!h){h=0;break}for(;;)if(m=h+20|0,p=v[m>>2]|0,p)h=p,f=m;else if(m=h+16|0,p=v[m>>2]|0,p)h=p,f=m;else break;v[f>>2]=0}else D=v[I+8>>2]|0,v[D+12>>2]=h,v[h+8>>2]=D;while(0);if(E){if(f=v[I+28>>2]|0,p=23732+(f<<2)|0,(v[p>>2]|0)==(I|0)){if(v[p>>2]=h,!h){v[5858]=v[5858]&~(1<<f),D=I,f=S;break}}else if(D=E+16|0,v[((v[D>>2]|0)==(I|0)?D:E+20|0)>>2]=h,!h){D=I,f=S;break}v[h+24>>2]=E,f=I+16|0,p=v[f>>2]|0,p|0&&(v[h+16>>2]=p,v[p+24>>2]=h),f=v[f+4>>2]|0,f?(v[h+20>>2]=f,v[f+24>>2]=h,D=I,f=S):(D=I,f=S)}else D=I,f=S}while(0);if(!(I>>>0>=V>>>0)&&(h=V+4|0,m=v[h>>2]|0,!!(m&1))){if(m&2)v[h>>2]=m&-2,v[D+4>>2]=f|1,v[I+f>>2]=f,E=f;else{if((v[5863]|0)==(V|0)){if(V=(v[5860]|0)+f|0,v[5860]=V,v[5863]=D,v[D+4>>2]=V|1,(D|0)!=(v[5862]|0))return;v[5862]=0,v[5859]=0;return}if((v[5862]|0)==(V|0)){V=(v[5859]|0)+f|0,v[5859]=V,v[5862]=I,v[D+4>>2]=V|1,v[I+V>>2]=V;return}E=(m&-8)+f|0,p=m>>>3;do if(m>>>0<256)if(f=v[V+8>>2]|0,h=v[V+12>>2]|0,(h|0)==(f|0)){v[5857]=v[5857]&~(1<<p);break}else{v[f+12>>2]=h,v[h+8>>2]=f;break}else{S=v[V+24>>2]|0,h=v[V+12>>2]|0;do if((h|0)==(V|0)){if(f=V+16|0,p=f+4|0,h=v[p>>2]|0,h)f=p;else if(h=v[f>>2]|0,!h){p=0;break}for(;;)if(m=h+20|0,p=v[m>>2]|0,p)h=p,f=m;else if(m=h+16|0,p=v[m>>2]|0,p)h=p,f=m;else break;v[f>>2]=0,p=h}else p=v[V+8>>2]|0,v[p+12>>2]=h,v[h+8>>2]=p,p=h;while(0);if(S|0){if(h=v[V+28>>2]|0,f=23732+(h<<2)|0,(v[f>>2]|0)==(V|0)){if(v[f>>2]=p,!p){v[5858]=v[5858]&~(1<<h);break}}else if(m=S+16|0,v[((v[m>>2]|0)==(V|0)?m:S+20|0)>>2]=p,!p)break;v[p+24>>2]=S,h=V+16|0,f=v[h>>2]|0,f|0&&(v[p+16>>2]=f,v[f+24>>2]=p),h=v[h+4>>2]|0,h|0&&(v[p+20>>2]=h,v[h+24>>2]=p)}}while(0);if(v[D+4>>2]=E|1,v[I+E>>2]=E,(D|0)==(v[5862]|0)){v[5859]=E;return}}if(h=E>>>3,E>>>0<256){p=23468+(h<<1<<2)|0,f=v[5857]|0,h=1<<h,f&h?(f=p+8|0,h=v[f>>2]|0):(v[5857]=f|h,h=p,f=p+8|0),v[f>>2]=D,v[h+12>>2]=D,v[D+8>>2]=h,v[D+12>>2]=p;return}h=E>>>8,h?E>>>0>16777215?m=31:(I=(h+1048320|0)>>>16&8,V=h<<I,S=(V+520192|0)>>>16&4,V=V<<S,m=(V+245760|0)>>>16&2,m=14-(S|I|m)+(V<<m>>>15)|0,m=E>>>(m+7|0)&1|m<<1):m=0,h=23732+(m<<2)|0,v[D+28>>2]=m,v[D+20>>2]=0,v[D+16>>2]=0,f=v[5858]|0,p=1<<m;e:do if(!(f&p))v[5858]=f|p,v[h>>2]=D,v[D+24>>2]=h,v[D+12>>2]=D,v[D+8>>2]=D;else{h=v[h>>2]|0;t:do if((v[h+4>>2]&-8|0)!=(E|0)){for(m=E<<((m|0)==31?0:25-(m>>>1)|0);p=h+16+(m>>>31<<2)|0,f=v[p>>2]|0,!!f;)if((v[f+4>>2]&-8|0)==(E|0)){h=f;break t}else m=m<<1,h=f;v[p>>2]=D,v[D+24>>2]=h,v[D+12>>2]=D,v[D+8>>2]=D;break e}while(0);I=h+8|0,V=v[I>>2]|0,v[V+12>>2]=D,v[I>>2]=D,v[D+8>>2]=V,v[D+12>>2]=h,v[D+24>>2]=0}while(0);if(V=(v[5865]|0)+-1|0,v[5865]=V,!(V|0)){for(h=23884;h=v[h>>2]|0,h;)h=h+8|0;v[5865]=-1}}}}function ya(h,f){h=h|0,f=f|0;var p=0;return h?(p=wi(f,h)|0,(f|h)>>>0>65535&&(p=((p>>>0)/(h>>>0)|0|0)==(f|0)?p:-1)):p=0,h=Ga(p)|0,!h||!(v[h+-4>>2]&3)||St(h|0,0,p|0)|0,h|0}function un(h,f,p,m){return h=h|0,f=f|0,p=p|0,m=m|0,p=h+p>>>0,Bi(f+m+(p>>>0<h>>>0|0)>>>0|0),p|0|0}function da(h,f,p,m){return h=h|0,f=f|0,p=p|0,m=m|0,m=f-m-(p>>>0>h>>>0|0)>>>0,Bi(m|0),h-p>>>0|0|0}function ra(h){return h=h|0,(h?31-(al(h^h-1)|0)|0:32)|0}function Rn(h,f,p,m,E){h=h|0,f=f|0,p=p|0,m=m|0,E=E|0;var S=0,I=0,D=0,V=0,re=0,xe=0,Fe=0,ut=0,gt=0,rt=0;if(xe=h,V=f,re=V,I=p,ut=m,D=ut,!re)return S=(E|0)!=0,D?S?(v[E>>2]=h|0,v[E+4>>2]=f&0,ut=0,E=0,Bi(ut|0),E|0):(ut=0,E=0,Bi(ut|0),E|0):(S&&(v[E>>2]=(xe>>>0)%(I>>>0),v[E+4>>2]=0),ut=0,E=(xe>>>0)/(I>>>0)>>>0,Bi(ut|0),E|0);S=(D|0)==0;do if(I){if(!S){if(S=(al(D|0)|0)-(al(re|0)|0)|0,S>>>0<=31){Fe=S+1|0,D=31-S|0,f=S-31>>31,I=Fe,h=xe>>>(Fe>>>0)&f|re<<D,f=re>>>(Fe>>>0)&f,S=0,D=xe<<D;break}return E?(v[E>>2]=h|0,v[E+4>>2]=V|f&0,ut=0,E=0,Bi(ut|0),E|0):(ut=0,E=0,Bi(ut|0),E|0)}if(S=I-1|0,S&I|0){D=(al(I|0)|0)+33-(al(re|0)|0)|0,rt=64-D|0,Fe=32-D|0,V=Fe>>31,gt=D-32|0,f=gt>>31,I=D,h=Fe-1>>31&re>>>(gt>>>0)|(re<<Fe|xe>>>(D>>>0))&f,f=f&re>>>(D>>>0),S=xe<<rt&V,D=(re<<rt|xe>>>(gt>>>0))&V|xe<<Fe&D-33>>31;break}return E|0&&(v[E>>2]=S&xe,v[E+4>>2]=0),(I|0)==1?(gt=V|f&0,rt=h|0|0,Bi(gt|0),rt|0):(rt=ra(I|0)|0,gt=re>>>(rt>>>0)|0,rt=re<<32-rt|xe>>>(rt>>>0)|0,Bi(gt|0),rt|0)}else{if(S)return E|0&&(v[E>>2]=(re>>>0)%(I>>>0),v[E+4>>2]=0),gt=0,rt=(re>>>0)/(I>>>0)>>>0,Bi(gt|0),rt|0;if(!xe)return E|0&&(v[E>>2]=0,v[E+4>>2]=(re>>>0)%(D>>>0)),gt=0,rt=(re>>>0)/(D>>>0)>>>0,Bi(gt|0),rt|0;if(S=D-1|0,!(S&D))return E|0&&(v[E>>2]=h|0,v[E+4>>2]=S&re|f&0),gt=0,rt=re>>>((ra(D|0)|0)>>>0),Bi(gt|0),rt|0;if(S=(al(D|0)|0)-(al(re|0)|0)|0,S>>>0<=30){f=S+1|0,D=31-S|0,I=f,h=re<<D|xe>>>(f>>>0),f=re>>>(f>>>0),S=0,D=xe<<D;break}return E?(v[E>>2]=h|0,v[E+4>>2]=V|f&0,gt=0,rt=0,Bi(gt|0),rt|0):(gt=0,rt=0,Bi(gt|0),rt|0)}while(0);if(!I)re=D,V=0,D=0;else{Fe=p|0|0,xe=ut|m&0,re=un(Fe|0,xe|0,-1,-1)|0,p=lt()|0,V=D,D=0;do m=V,V=S>>>31|V<<1,S=D|S<<1,m=h<<1|m>>>31|0,ut=h>>>31|f<<1|0,da(re|0,p|0,m|0,ut|0)|0,rt=lt()|0,gt=rt>>31|((rt|0)<0?-1:0)<<1,D=gt&1,h=da(m|0,ut|0,gt&Fe|0,(((rt|0)<0?-1:0)>>31|((rt|0)<0?-1:0)<<1)&xe|0)|0,f=lt()|0,I=I-1|0;while(I|0);re=V,V=0}return I=0,E|0&&(v[E>>2]=h,v[E+4>>2]=f),gt=(S|0)>>>31|(re|I)<<1|(I<<1|S>>>31)&0|V,rt=(S<<1|0)&-2|D,Bi(gt|0),rt|0}function mi(h,f,p,m){h=h|0,f=f|0,p=p|0,m=m|0;var E=0,S=0,I=0,D=0,V=0,re=0;return re=f>>31|((f|0)<0?-1:0)<<1,V=((f|0)<0?-1:0)>>31|((f|0)<0?-1:0)<<1,S=m>>31|((m|0)<0?-1:0)<<1,E=((m|0)<0?-1:0)>>31|((m|0)<0?-1:0)<<1,D=da(re^h|0,V^f|0,re|0,V|0)|0,I=lt()|0,h=S^re,f=E^V,da((Rn(D,I,da(S^p|0,E^m|0,S|0,E|0)|0,lt()|0,0)|0)^h|0,(lt()|0)^f|0,h|0,f|0)|0}function vr(h,f){h=h|0,f=f|0;var p=0,m=0,E=0,S=0;return S=h&65535,E=f&65535,p=wi(E,S)|0,m=h>>>16,h=(p>>>16)+(wi(E,m)|0)|0,E=f>>>16,f=wi(E,S)|0,Bi((h>>>16)+(wi(E,m)|0)+(((h&65535)+f|0)>>>16)|0),h+f<<16|p&65535|0|0}function Ri(h,f,p,m){h=h|0,f=f|0,p=p|0,m=m|0;var E=0,S=0;return E=h,S=p,p=vr(E,S)|0,h=lt()|0,Bi((wi(f,S)|0)+(wi(m,E)|0)+h|h&0|0),p|0|0|0}function Xt(h,f,p,m){h=h|0,f=f|0,p=p|0,m=m|0;var E=0,S=0,I=0,D=0,V=0,re=0;return E=Je,Je=Je+16|0,D=E|0,I=f>>31|((f|0)<0?-1:0)<<1,S=((f|0)<0?-1:0)>>31|((f|0)<0?-1:0)<<1,re=m>>31|((m|0)<0?-1:0)<<1,V=((m|0)<0?-1:0)>>31|((m|0)<0?-1:0)<<1,h=da(I^h|0,S^f|0,I|0,S|0)|0,f=lt()|0,Rn(h,f,da(re^p|0,V^m|0,re|0,V|0)|0,lt()|0,D)|0,m=da(v[D>>2]^I|0,v[D+4>>2]^S|0,I|0,S|0)|0,p=lt()|0,Je=E,Bi(p|0),m|0}function Jo(h,f,p,m){h=h|0,f=f|0,p=p|0,m=m|0;var E=0,S=0;return S=Je,Je=Je+16|0,E=S|0,Rn(h,f,p,m,E)|0,Je=S,Bi(v[E+4>>2]|0),v[E>>2]|0|0}function ct(h,f,p){return h=h|0,f=f|0,p=p|0,(p|0)<32?(Bi(f>>p|0),h>>>p|(f&(1<<p)-1)<<32-p):(Bi(((f|0)<0?-1:0)|0),f>>p-32|0)}function ft(h,f,p){return h=h|0,f=f|0,p=p|0,(p|0)<32?(Bi(f>>>p|0),h>>>p|(f&(1<<p)-1)<<32-p):(Bi(0),f>>>p-32|0)}function Et(h,f,p){return h=h|0,f=f|0,p=p|0,(p|0)<32?(Bi(f<<p|(h&(1<<p)-1<<32-p)>>>32-p|0),h<<p):(Bi(h<<p-32|0),0)}function Ur(h,f){return h=+h,f=+f,h!=h?+f:f!=f?+h:+Ge(+h,+f)}function Un(h,f){return h=+h,f=+f,h!=h?+f:f!=f?+h:+An(+h,+f)}function ot(h){return h=+h,h>=0?+xo(h+.5):+Fi(h-.5)}function Ye(h,f,p){h=h|0,f=f|0,p=p|0;var m=0,E=0,S=0;if((p|0)>=8192)return Ec(h|0,f|0,p|0)|0,h|0;if(S=h|0,E=h+p|0,(h&3)==(f&3)){for(;h&3;){if(!p)return S|0;yr[h>>0]=yr[f>>0]|0,h=h+1|0,f=f+1|0,p=p-1|0}for(p=E&-4|0,m=p-64|0;(h|0)<=(m|0);)v[h>>2]=v[f>>2],v[h+4>>2]=v[f+4>>2],v[h+8>>2]=v[f+8>>2],v[h+12>>2]=v[f+12>>2],v[h+16>>2]=v[f+16>>2],v[h+20>>2]=v[f+20>>2],v[h+24>>2]=v[f+24>>2],v[h+28>>2]=v[f+28>>2],v[h+32>>2]=v[f+32>>2],v[h+36>>2]=v[f+36>>2],v[h+40>>2]=v[f+40>>2],v[h+44>>2]=v[f+44>>2],v[h+48>>2]=v[f+48>>2],v[h+52>>2]=v[f+52>>2],v[h+56>>2]=v[f+56>>2],v[h+60>>2]=v[f+60>>2],h=h+64|0,f=f+64|0;for(;(h|0)<(p|0);)v[h>>2]=v[f>>2],h=h+4|0,f=f+4|0}else for(p=E-4|0;(h|0)<(p|0);)yr[h>>0]=yr[f>>0]|0,yr[h+1>>0]=yr[f+1>>0]|0,yr[h+2>>0]=yr[f+2>>0]|0,yr[h+3>>0]=yr[f+3>>0]|0,h=h+4|0,f=f+4|0;for(;(h|0)<(E|0);)yr[h>>0]=yr[f>>0]|0,h=h+1|0,f=f+1|0;return S|0}function St(h,f,p){h=h|0,f=f|0,p=p|0;var m=0,E=0,S=0,I=0;if(S=h+p|0,f=f&255,(p|0)>=67){for(;h&3;)yr[h>>0]=f,h=h+1|0;for(m=S&-4|0,I=f|f<<8|f<<16|f<<24,E=m-64|0;(h|0)<=(E|0);)v[h>>2]=I,v[h+4>>2]=I,v[h+8>>2]=I,v[h+12>>2]=I,v[h+16>>2]=I,v[h+20>>2]=I,v[h+24>>2]=I,v[h+28>>2]=I,v[h+32>>2]=I,v[h+36>>2]=I,v[h+40>>2]=I,v[h+44>>2]=I,v[h+48>>2]=I,v[h+52>>2]=I,v[h+56>>2]=I,v[h+60>>2]=I,h=h+64|0;for(;(h|0)<(m|0);)v[h>>2]=I,h=h+4|0}for(;(h|0)<(S|0);)yr[h>>0]=f,h=h+1|0;return S-p|0}function Dt(h){return h=+h,h>=0?+xo(h+.5):+Fi(h-.5)}function Ft(h){h=h|0;var f=0,p=0,m=0;return m=Eh()|0,p=v[ao>>2]|0,f=p+h|0,(h|0)>0&(f|0)<(p|0)|(f|0)<0?(rf(f|0)|0,xc(12),-1):(f|0)>(m|0)&&!(s0(f|0)|0)?(xc(12),-1):(v[ao>>2]=f,p|0)}return{___divdi3:mi,___muldi3:Ri,___remdi3:Xt,___uremdi3:Jo,_areNeighborCells:v0,_bitshift64Ashr:ct,_bitshift64Lshr:ft,_bitshift64Shl:Et,_calloc:ya,_cellAreaKm2:Wl,_cellAreaM2:qs,_cellAreaRads2:Fc,_cellToBoundary:Dc,_cellToCenterChild:lc,_cellToChildPos:cf,_cellToChildren:Oc,_cellToChildrenSize:Cl,_cellToLatLng:Os,_cellToLocalIj:sr,_cellToParent:Gl,_cellToVertex:Bn,_cellToVertexes:gn,_cellsToDirectedEdge:wh,_cellsToLinkedMultiPolygon:f0,_childPosToCell:Tf,_compactCells:Vl,_destroyLinkedMultiPolygon:Qe,_directedEdgeToBoundary:Cf,_directedEdgeToCells:sc,_edgeLengthKm:Rs,_edgeLengthM:Xf,_edgeLengthRads:vu,_emscripten_replace_memory:bc,_free:Tn,_getBaseCellNumber:Lc,_getDirectedEdgeDestination:H0,_getDirectedEdgeOrigin:yA,_getHexagonAreaAvgKm2:If,_getHexagonAreaAvgM2:Wf,_getHexagonEdgeLengthAvgKm:X0,_getHexagonEdgeLengthAvgM:ff,_getIcosahedronFaces:Tl,_getNumCells:Pf,_getPentagons:lf,_getRes0Cells:Fl,_getResolution:Ul,_greatCircleDistanceKm:cl,_greatCircleDistanceM:Mf,_greatCircleDistanceRads:cc,_gridDisk:bf,_gridDiskDistances:U0,_gridDistance:Lr,_gridPathCells:kr,_gridPathCellsSize:Nr,_gridRingUnsafe:bh,_i64Add:un,_i64Subtract:da,_isPentagon:pa,_isResClassIII:m0,_isValidCell:sf,_isValidDirectedEdge:Th,_isValidVertex:Jn,_latLngToCell:uf,_llvm_maxnum_f64:Ur,_llvm_minnum_f64:Un,_llvm_round_f64:ot,_localIjToCell:Tr,_malloc:Ga,_maxFaceCount:kc,_maxGridDiskSize:l0,_maxPolygonToCellsSize:zf,_memcpy:Ye,_memset:St,_originToDirectedEdges:$0,_pentagonCount:y0,_polygonToCells:Sc,_readInt64AsDoubleFromPointer:br,_res0CellCount:Vf,_round:Dt,_sbrk:Ft,_sizeOfCellBoundary:tn,_sizeOfCoordIJ:Hr,_sizeOfGeoLoop:_r,_sizeOfGeoPolygon:cn,_sizeOfH3Index:lr,_sizeOfLatLng:Rr,_sizeOfLinkedGeoPolygon:wr,_uncompactCells:Hl,_uncompactCellsSize:g0,_vertexToLatLng:xi,establishStackSpace:nf,stackAlloc:Ef,stackRestore:Bf,stackSave:u0}}(Au,js,ni),Ja=He.___divdi3=Zr.___divdi3,yc=He.___muldi3=Zr.___muldi3,Dl=He.___remdi3=Zr.___remdi3,yo=He.___uremdi3=Zr.___uremdi3,Nu=He._areNeighborCells=Zr._areNeighborCells,Eu=He._bitshift64Ashr=Zr._bitshift64Ashr,Kc=He._bitshift64Lshr=Zr._bitshift64Lshr,ds=He._bitshift64Shl=Zr._bitshift64Shl,Is=He._calloc=Zr._calloc,kl=He._cellAreaKm2=Zr._cellAreaKm2,el=He._cellAreaM2=Zr._cellAreaM2,Jc=He._cellAreaRads2=Zr._cellAreaRads2,Ff=He._cellToBoundary=Zr._cellToBoundary,yl=He._cellToCenterChild=Zr._cellToCenterChild,bu=He._cellToChildPos=Zr._cellToChildPos,wo=He._cellToChildren=Zr._cellToChildren,_l=He._cellToChildrenSize=Zr._cellToChildrenSize,Zo=He._cellToLatLng=Zr._cellToLatLng,Su=He._cellToLocalIj=Zr._cellToLocalIj,Fu=He._cellToParent=Zr._cellToParent,ef=He._cellToVertex=Zr._cellToVertex,xl=He._cellToVertexes=Zr._cellToVertexes,Bu=He._cellsToDirectedEdge=Zr._cellsToDirectedEdge,pu=He._cellsToLinkedMultiPolygon=Zr._cellsToLinkedMultiPolygon,_o=He._childPosToCell=Zr._childPosToCell,Cu=He._compactCells=Zr._compactCells,ho=He._destroyLinkedMultiPolygon=Zr._destroyLinkedMultiPolygon,o0=He._directedEdgeToBoundary=Zr._directedEdgeToBoundary,tl=He._directedEdgeToCells=Zr._directedEdgeToCells,nc=He._edgeLengthKm=Zr._edgeLengthKm,zo=He._edgeLengthM=Zr._edgeLengthM,Xo=He._edgeLengthRads=Zr._edgeLengthRads,Vs=He._emscripten_replace_memory=Zr._emscripten_replace_memory,Hs=He._free=Zr._free,_c=He._getBaseCellNumber=Zr._getBaseCellNumber,Ps=He._getDirectedEdgeDestination=Zr._getDirectedEdgeDestination,El=He._getDirectedEdgeOrigin=Zr._getDirectedEdgeOrigin,To=He._getHexagonAreaAvgKm2=Zr._getHexagonAreaAvgKm2,Ls=He._getHexagonAreaAvgM2=Zr._getHexagonAreaAvgM2,za=He._getHexagonEdgeLengthAvgKm=Zr._getHexagonEdgeLengthAvgKm,ur=He._getHexagonEdgeLengthAvgM=Zr._getHexagonEdgeLengthAvgM,xt=He._getIcosahedronFaces=Zr._getIcosahedronFaces,Me=He._getNumCells=Zr._getNumCells,$s=He._getPentagons=Zr._getPentagons,it=He._getRes0Cells=Zr._getRes0Cells,rl=He._getResolution=Zr._getResolution,ha=He._greatCircleDistanceKm=Zr._greatCircleDistanceKm,Ys=He._greatCircleDistanceM=Zr._greatCircleDistanceM,oi=He._greatCircleDistanceRads=Zr._greatCircleDistanceRads,Aa=He._gridDisk=Zr._gridDisk,bi=He._gridDiskDistances=Zr._gridDiskDistances,$a=He._gridDistance=Zr._gridDistance,Ii=He._gridPathCells=Zr._gridPathCells,Hn=He._gridPathCellsSize=Zr._gridPathCellsSize,yi=He._gridRingUnsafe=Zr._gridRingUnsafe,Yi=He._i64Add=Zr._i64Add,_i=He._i64Subtract=Zr._i64Subtract,di=He._isPentagon=Zr._isPentagon,wn=He._isResClassIII=Zr._isResClassIII,Wn=He._isValidCell=Zr._isValidCell,Pi=He._isValidDirectedEdge=Zr._isValidDirectedEdge,qn=He._isValidVertex=Zr._isValidVertex,Ui=He._latLngToCell=Zr._latLngToCell,Gi=He._llvm_maxnum_f64=Zr._llvm_maxnum_f64,Nn=He._llvm_minnum_f64=Zr._llvm_minnum_f64,Wi=He._llvm_round_f64=Zr._llvm_round_f64,$n=He._localIjToCell=Zr._localIjToCell,Li=He._malloc=Zr._malloc,Oi=He._maxFaceCount=Zr._maxFaceCount,Qi=He._maxGridDiskSize=Zr._maxGridDiskSize,qi=He._maxPolygonToCellsSize=Zr._maxPolygonToCellsSize,hi=He._memcpy=Zr._memcpy,Si=He._memset=Zr._memset,Ci=He._originToDirectedEdges=Zr._originToDirectedEdges,ji=He._pentagonCount=Zr._pentagonCount,li=He._polygonToCells=Zr._polygonToCells,wu=He._readInt64AsDoubleFromPointer=Zr._readInt64AsDoubleFromPointer,Qo=He._res0CellCount=Zr._res0CellCount,nl=He._round=Zr._round,Zu=He._sbrk=Zr._sbrk,Fn=He._sizeOfCellBoundary=Zr._sizeOfCellBoundary,qo=He._sizeOfCoordIJ=Zr._sizeOfCoordIJ,Ws=He._sizeOfGeoLoop=Zr._sizeOfGeoLoop,du=He._sizeOfGeoPolygon=Zr._sizeOfGeoPolygon,vs=He._sizeOfH3Index=Zr._sizeOfH3Index,bl=He._sizeOfLatLng=Zr._sizeOfLatLng,gs=He._sizeOfLinkedGeoPolygon=Zr._sizeOfLinkedGeoPolygon,Da=He._uncompactCells=Zr._uncompactCells,il=He._uncompactCellsSize=Zr._uncompactCellsSize,tf=He._vertexToLatLng=Zr._vertexToLatLng,o=He.establishStackSpace=Zr.establishStackSpace,s=He.stackAlloc=Zr.stackAlloc,d=He.stackRestore=Zr.stackRestore,_=He.stackSave=Zr.stackSave;if(He.asm=Zr,He.cwrap=mf,He.setValue=ws,He.getValue=Qc,hs){Ts(hs)||(hs=zt(hs));{Nf("memory initializer");var w=function(st){st.byteLength&&(st=new Uint8Array(st)),Ha.set(st,ns),He.memoryInitializerRequest&&delete He.memoryInitializerRequest.response,ui("memory initializer")},j=function(){hr(hs,w,function(){throw"could not load memory initializer "+hs})},ie=Wo(hs);if(ie)w(ie.buffer);else if(He.memoryInitializerRequest){var ke=function(){var st=He.memoryInitializerRequest,Zt=st.response;if(st.status!==200&&st.status!==0){var Jt=Wo(He.memoryInitializerRequestURL);if(Jt)Zt=Jt.buffer;else{console.warn("a problem seems to have happened with Module.memoryInitializerRequest, status: "+st.status+", retrying "+hs),j();return}}w(Zt)};He.memoryInitializerRequest.response?setTimeout(ke,0):He.memoryInitializerRequest.addEventListener("load",ke)}else j()}}var tt;ko=function st(){tt||Pt(),tt||(ko=st)};function Pt(st){if(st=st||Be,na>0||(vl(),na>0))return;function Zt(){tt||(tt=!0,!zs&&(tc(),Ka(),He.onRuntimeInitialized&&He.onRuntimeInitialized(),fs()))}He.setStatus?(He.setStatus("Running..."),setTimeout(function(){setTimeout(function(){He.setStatus("")},1),Zt()},1)):Zt()}He.run=Pt;function tr(st){throw He.onAbort&&He.onAbort(st),st+="",Pr(st),dn(st),zs=!0,"abort("+st+"). Build with -s ASSERTIONS=1 for more info."}if(He.abort=tr,He.preInit)for(typeof He.preInit=="function"&&(He.preInit=[He.preInit]);He.preInit.length>0;)He.preInit.pop()();return Pt(),Mt}(typeof L=="object"?L:{}),k="number",G=k,Z=k,F=k,z=k,q=k,ee=k,fe=[["sizeOfH3Index",k],["sizeOfLatLng",k],["sizeOfCellBoundary",k],["sizeOfGeoLoop",k],["sizeOfGeoPolygon",k],["sizeOfLinkedGeoPolygon",k],["sizeOfCoordIJ",k],["readInt64AsDoubleFromPointer",k],["isValidCell",Z,[F,z]],["latLngToCell",G,[k,k,q,ee]],["cellToLatLng",G,[F,z,ee]],["cellToBoundary",G,[F,z,ee]],["maxGridDiskSize",G,[k,ee]],["gridDisk",G,[F,z,k,ee]],["gridDiskDistances",G,[F,z,k,ee,ee]],["gridRingUnsafe",G,[F,z,k,ee]],["maxPolygonToCellsSize",G,[ee,q,k,ee]],["polygonToCells",G,[ee,q,k,ee]],["cellsToLinkedMultiPolygon",G,[ee,k,ee]],["destroyLinkedMultiPolygon",null,[ee]],["compactCells",G,[ee,ee,k,k]],["uncompactCells",G,[ee,k,k,ee,k,q]],["uncompactCellsSize",G,[ee,k,k,q,ee]],["isPentagon",Z,[F,z]],["isResClassIII",Z,[F,z]],["getBaseCellNumber",k,[F,z]],["getResolution",k,[F,z]],["maxFaceCount",G,[F,z,ee]],["getIcosahedronFaces",G,[F,z,ee]],["cellToParent",G,[F,z,q,ee]],["cellToChildren",G,[F,z,q,ee]],["cellToCenterChild",G,[F,z,q,ee]],["cellToChildrenSize",G,[F,z,q,ee]],["cellToChildPos",G,[F,z,q,ee]],["childPosToCell",G,[k,k,F,z,q,ee]],["areNeighborCells",G,[F,z,F,z,ee]],["cellsToDirectedEdge",G,[F,z,F,z,ee]],["getDirectedEdgeOrigin",G,[F,z,ee]],["getDirectedEdgeDestination",G,[F,z,ee]],["isValidDirectedEdge",Z,[F,z]],["directedEdgeToCells",G,[F,z,ee]],["originToDirectedEdges",G,[F,z,ee]],["directedEdgeToBoundary",G,[F,z,ee]],["gridDistance",G,[F,z,F,z,ee]],["gridPathCells",G,[F,z,F,z,ee]],["gridPathCellsSize",G,[F,z,F,z,ee]],["cellToLocalIj",G,[F,z,F,z,k,ee]],["localIjToCell",G,[F,z,ee,k,ee]],["getHexagonAreaAvgM2",G,[q,ee]],["getHexagonAreaAvgKm2",G,[q,ee]],["getHexagonEdgeLengthAvgM",G,[q,ee]],["getHexagonEdgeLengthAvgKm",G,[q,ee]],["greatCircleDistanceM",k,[ee,ee]],["greatCircleDistanceKm",k,[ee,ee]],["greatCircleDistanceRads",k,[ee,ee]],["cellAreaM2",G,[F,z,ee]],["cellAreaKm2",G,[F,z,ee]],["cellAreaRads2",G,[F,z,ee]],["edgeLengthM",G,[F,z,ee]],["edgeLengthKm",G,[F,z,ee]],["edgeLengthRads",G,[F,z,ee]],["getNumCells",G,[q,ee]],["getRes0Cells",G,[ee]],["res0CellCount",k],["getPentagons",G,[k,ee]],["pentagonCount",k],["cellToVertex",G,[F,z,k,ee]],["cellToVertexes",G,[F,z,ee]],["vertexToLatLng",G,[F,z,ee]],["isValidVertex",Z,[F,z]]],Se=0,Re=1,De=2,Ve=3,nt=4,Ee=5,Ie=6,me=7,we=8,ne=9,Pe=10,he=11,ve=12,te=13,Y=14,Oe=15,pe={};pe[Se]="Success",pe[Re]="The operation failed but a more specific error is not available",pe[De]="Argument was outside of acceptable range",pe[Ve]="Latitude or longitude arguments were outside of acceptable range",pe[nt]="Resolution argument was outside of acceptable range",pe[Ee]="Cell argument was not valid",pe[Ie]="Directed edge argument was not valid",pe[me]="Undirected edge argument was not valid",pe[we]="Vertex argument was not valid",pe[ne]="Pentagon distortion was encountered",pe[Pe]="Duplicate input",pe[he]="Cell arguments were not neighbors",pe[ve]="Cell arguments had incompatible resolutions",pe[te]="Memory allocation failed",pe[Y]="Bounds of provided memory were insufficient",pe[Oe]="Mode or flags argument was not valid";var ye=1e3,_e=1001,X=1002,Le={};Le[ye]="Unknown unit",Le[_e]="Array length out of bounds",Le[X]="Got unexpected null value for H3 index";var de="Unknown error";function be(Mt,He,Gt){var Ae=Gt&&"value"in Gt,Be=new Error((Mt[He]||de)+" (code: "+He+(Ae?", value: "+Gt.value:"")+")");return Be.code=He,Be}function se(Mt,He){var Gt=arguments.length===2?{value:He}:{};return be(pe,Mt,Gt)}function Ne(Mt,He){var Gt=arguments.length===2?{value:He}:{};return be(Le,Mt,Gt)}function ze(Mt){if(Mt!==0)throw se(Mt)}var ue={};fe.forEach(function(He){ue[He[0]]=L.cwrap.apply(L,He)});var kt=16,Rt=0,cr=4,Ut=4,$r=8,ln=8,Cr=ue.sizeOfH3Index(),Qr=ue.sizeOfLatLng(),Jr=ue.sizeOfCellBoundary(),xr=ue.sizeOfGeoPolygon(),Gn=ue.sizeOfGeoLoop(),ti=ue.sizeOfLinkedGeoPolygon(),Vn=ue.sizeOfCoordIJ(),Xr={m:"m",m2:"m2",km:"km",km2:"km2",rads:"rads",rads2:"rads2"};function sn(Mt){if(typeof Mt!="number"||Mt<0||Mt>15||Math.floor(Mt)!==Mt)throw se(nt,Mt);return Mt}function yn(Mt){if(!Mt)throw Ne(X);return Mt}var ki=Math.pow(2,32)-1;function ri(Mt){if(Mt>ki)throw Ne(_e,Mt);return Mt}var Lt=/[^0-9a-fA-F]/;function J(Mt){if(Array.isArray(Mt)&&Mt.length===2&&Number.isInteger(Mt[0])&&Number.isInteger(Mt[1]))return Mt;if(typeof Mt!="string"||Lt.test(Mt))return[0,0];var He=parseInt(Mt.substring(0,Mt.length-8),kt),Gt=parseInt(Mt.substring(Mt.length-8),kt);return[Gt,He]}function Ue(Mt){if(Mt>=0)return Mt.toString(kt);Mt=Mt&2147483647;var He=At(8,Mt.toString(kt)),Gt=(parseInt(He[0],kt)+8).toString(kt);return He=Gt+He.substring(1),He}function $e(Mt,He){return Ue(He)+At(8,Ue(Mt))}function At(Mt,He){for(var Gt=Mt-He.length,Ae="",Be=0;Be<Gt;Be++)Ae+="0";return Ae=Ae+He,Ae}var It=Math.pow(2,32);function wt(Mt){return typeof Mt!="number"?[0,0]:[Mt|0,Mt/It|0]}function mr(Mt,He,Gt){for(var Ae=Mt.length,Be=L._calloc(Ae,Qr),We=Gt?1:0,zt=Gt?0:1,hr=0;hr<Ae*2;hr+=2)L.HEAPF64.set([Mt[hr/2][We],Mt[hr/2][zt]].map(Du),Be/$r+hr);return L.HEAPU32.set([Ae,Be],He/cr),He}function vt(Mt,He){var Gt=Mt.length-1,Ae=L._calloc(xr),Be=0,We=Be+Gn,zt=We+cr;mr(Mt[0],Ae+Be,He);var hr;if(Gt>0){hr=L._calloc(Gt,Gn);for(var Pr=0;Pr<Gt;Pr++)mr(Mt[Pr+1],hr+Gn*Pr,He)}return L.setValue(Ae+We,Gt,"i32"),L.setValue(Ae+zt,hr,"i32"),Ae}function Tt(Mt){var He=0,Gt=He+Gn,Ae=Gt+cr,Be=cr;L._free(L.getValue(Mt+He+Be,"i8*"));var We=L.getValue(Mt+Gt,"i32");if(We>0){for(var zt=L.getValue(Mt+Ae,"i32"),hr=0;hr<We;hr++)L._free(L.getValue(zt+Gn*hr+Be,"i8*"));L._free(zt)}L._free(Mt)}function Qt(Mt,He){He===void 0&&(He=0);var Gt=L.getValue(Mt+Cr*He,"i32"),Ae=L.getValue(Mt+Cr*He+cr,"i32");return Ae?$e(Gt,Ae):null}function Er(Mt,He){He===void 0&&(He=0);var Gt=L.getValue(Mt+cr*He,"i32");return!!Gt}function Dr(Mt,He){return He===void 0&&(He=0),L.getValue(Mt+$r*He,"double")}function Yr(Mt){return ue.readInt64AsDoubleFromPointer(Mt)}function an(Mt,He,Gt){L.HEAPU32.set(J(Mt),He/cr+2*Gt)}function Br(Mt,He){for(var Gt=[],Ae=0;Ae<He;Ae++){var Be=Qt(Mt,Ae);Be!==null&&Gt.push(Be)}return Gt}function en(Mt,He){for(var Gt=He.length,Ae=0;Ae<Gt;Ae++)an(He[Ae],Mt,Ae)}function Zn(Mt,He){var Gt=L._calloc(1,Qr);return L.HEAPF64.set([Mt,He].map(Du),Gt/$r),Gt}function zn(Mt){return rs(L.getValue(Mt,"double"))}function fi(Mt){return[zn(Mt),zn(Mt+$r)]}function la(Mt){return[zn(Mt+$r),zn(Mt)]}function Oa(Mt,He,Gt){for(var Ae=L.getValue(Mt,"i32"),Be=Mt+$r,We=[],zt=He?la:fi,hr=0;hr<Ae*2;hr+=2)We.push(zt(Be+$r*hr));return Gt&&We.push(We[0]),We}function Gr(Mt,He){for(var Gt=[],Ae=He?la:fi,Be,We,zt,hr;Mt;){for(Gt.push(Be=[]),We=L.getValue(Mt,"i8*");We;){for(Be.push(zt=[]),hr=L.getValue(We,"i8*");hr;)zt.push(Ae(hr)),hr=L.getValue(hr+$r*2,"i8*");He&&zt.push(zt[0]),We=L.getValue(We+Ut*2,"i8*")}Mt=L.getValue(Mt+Ut*2,"i8*")}return Gt}function Ns(Mt){return{i:L.getValue(Mt,"i32"),j:L.getValue(Mt+cr,"i32")}}function Co(Mt,He){var Gt=He.i,Ae=He.j;L.setValue(Mt,Gt,"i32"),L.setValue(Mt+cr,Ae,"i32")}function _n(Mt,He){for(var Gt=[],Ae=0;Ae<He;Ae++){var Be=L.getValue(Mt+cr*Ae,"i32");Be>=0&&Gt.push(Be)}return Gt}function xs(Mt){var He=J(Mt),Gt=He[0],Ae=He[1];return!!ue.isValidCell(Gt,Ae)}function go(Mt){var He=J(Mt),Gt=He[0],Ae=He[1];return!!ue.isPentagon(Gt,Ae)}function Fs(Mt){var He=J(Mt),Gt=He[0],Ae=He[1];return!!ue.isResClassIII(Gt,Ae)}function Po(Mt){var He=J(Mt),Gt=He[0],Ae=He[1];return ue.getBaseCellNumber(Gt,Ae)}function hl(Mt){var He=J(Mt),Gt=He[0],Ae=He[1],Be=L._malloc(cr);try{ze(ue.maxFaceCount(Gt,Ae,Be));var We=L.getValue(Be,"i32"),zt=L._malloc(cr*We);try{return ze(ue.getIcosahedronFaces(Gt,Ae,zt)),_n(zt,We)}finally{L._free(zt)}}finally{L._free(Be)}}function yu(Mt){var He=J(Mt),Gt=He[0],Ae=He[1];return ue.isValidCell(Gt,Ae)?ue.getResolution(Gt,Ae):-1}function Es(Mt,He,Gt){var Ae=L._malloc(Qr);L.HEAPF64.set([Mt,He].map(Du),Ae/$r);var Be=L._malloc(Cr);try{return ze(ue.latLngToCell(Ae,Gt,Be)),yn(Qt(Be))}finally{L._free(Be),L._free(Ae)}}function cs(Mt){var He=L._malloc(Qr),Gt=J(Mt),Ae=Gt[0],Be=Gt[1];try{return ze(ue.cellToLatLng(Ae,Be,He)),fi(He)}finally{L._free(He)}}function Ou(Mt,He){var Gt=L._malloc(Jr),Ae=J(Mt),Be=Ae[0],We=Ae[1];try{return ze(ue.cellToBoundary(Be,We,Gt)),Oa(Gt,He,He)}finally{L._free(Gt)}}function Al(Mt,He){var Gt=J(Mt),Ae=Gt[0],Be=Gt[1],We=L._malloc(Cr);try{return ze(ue.cellToParent(Ae,Be,He,We)),yn(Qt(We))}finally{L._free(We)}}function ga(Mt,He){if(!xs(Mt))return[];var Gt=J(Mt),Ae=Gt[0],Be=Gt[1],We=ri(Zi(Mt,He)),zt=L._calloc(We,Cr);try{return ze(ue.cellToChildren(Ae,Be,He,zt)),Br(zt,We)}finally{L._free(zt)}}function Zi(Mt,He){if(!xs(Mt))throw se(Ee);var Gt=J(Mt),Ae=Gt[0],Be=Gt[1],We=L._malloc(ln);try{return ze(ue.cellToChildrenSize(Ae,Be,He,We)),Yr(We)}finally{L._free(We)}}function Bs(Mt,He){var Gt=J(Mt),Ae=Gt[0],Be=Gt[1],We=L._malloc(Cr);try{return ze(ue.cellToCenterChild(Ae,Be,He,We)),yn(Qt(We))}finally{L._free(We)}}function no(Mt,He){var Gt=J(Mt),Ae=Gt[0],Be=Gt[1],We=L._malloc(ln);try{return ze(ue.cellToChildPos(Ae,Be,He,We)),Yr(We)}finally{L._free(We)}}function es(Mt,He,Gt){var Ae=wt(Mt),Be=Ae[0],We=Ae[1],zt=J(He),hr=zt[0],Pr=zt[1],dn=L._malloc(Cr);try{return ze(ue.childPosToCell(Be,We,hr,Pr,Gt,dn)),yn(Qt(dn))}finally{L._free(dn)}}function Lo(Mt,He){var Gt=J(Mt),Ae=Gt[0],Be=Gt[1],We=L._malloc(ln);try{ze(ue.maxGridDiskSize(He,We));var zt=ri(Yr(We)),hr=L._calloc(zt,Cr);try{return ze(ue.gridDisk(Ae,Be,He,hr)),Br(hr,zt)}finally{L._free(hr)}}finally{L._free(We)}}function Ni(Mt,He){var Gt=J(Mt),Ae=Gt[0],Be=Gt[1],We=L._malloc(ln);try{ze(ue.maxGridDiskSize(He,We));var zt=ri(Yr(We)),hr=L._calloc(zt,Cr),Pr=L._calloc(zt,cr);try{ze(ue.gridDiskDistances(Ae,Be,He,hr,Pr));for(var dn=[],Mn=0;Mn<He+1;Mn++)dn.push([]);for(var vi=0;vi<zt;vi++){var co=Qt(hr,vi),ns=L.getValue(Pr+cr*vi,"i32");co!==null&&dn[ns].push(co)}return dn}finally{L._free(hr),L._free(Pr)}}finally{L._free(We)}}function io(Mt,He){var Gt=He===0?1:6*He,Ae=L._calloc(Gt,Cr);try{return ze(ue.gridRingUnsafe.apply(ue,J(Mt).concat([He],[Ae]))),Br(Ae,Gt)}finally{L._free(Ae)}}function bs(Mt,He,Gt){if(sn(He),Gt=!!Gt,Mt.length===0||Mt[0].length===0)return[];var Ae=typeof Mt[0][0]=="number"?[Mt]:Mt,Be=vt(Ae,Gt),We=L._malloc(ln);try{ze(ue.maxPolygonToCellsSize(Be,He,0,We));var zt=ri(Yr(We)),hr=L._calloc(zt,Cr);try{return ze(ue.polygonToCells(Be,He,0,hr)),Br(hr,zt)}finally{L._free(hr)}}finally{L._free(We),Tt(Be)}}function $o(Mt,He){if(!Mt||!Mt.length)return[];var Gt=Mt.length,Ae=L._calloc(Gt,Cr);en(Ae,Mt);var Be=L._calloc(ti);try{return ze(ue.cellsToLinkedMultiPolygon(Ae,Gt,Be)),Gr(Be,He)}finally{ue.destroyLinkedMultiPolygon(Be),L._free(Be),L._free(Ae)}}function Ru(Mt){if(!Mt||!Mt.length)return[];var He=Mt.length,Gt=L._calloc(He,Cr);en(Gt,Mt);var Ae=L._calloc(He,Cr);try{return ze(ue.compactCells(Gt,Ae,He,Rt)),Br(Ae,He)}finally{L._free(Gt),L._free(Ae)}}function Ca(Mt,He){if(sn(He),!Mt||!Mt.length)return[];var Gt=Mt.length,Ae=L._calloc(Gt,Cr);en(Ae,Mt);var Be=L._malloc(ln);try{ze(ue.uncompactCellsSize(Ae,Gt,Rt,He,Be));var We=ri(Yr(Be)),zt=L._calloc(We,Cr);try{return ze(ue.uncompactCells(Ae,Gt,Rt,zt,We,Rt,He)),Br(zt,We)}finally{L._free(Ae),L._free(zt)}}finally{L._free(Be)}}function xa(Mt,He){var Gt=J(Mt),Ae=Gt[0],Be=Gt[1],We=J(He),zt=We[0],hr=We[1],Pr=L._malloc(cr);try{return ze(ue.areNeighborCells(Ae,Be,zt,hr,Pr)),Er(Pr)}finally{L._free(Pr)}}function Ku(Mt,He){var Gt=J(Mt),Ae=Gt[0],Be=Gt[1],We=J(He),zt=We[0],hr=We[1],Pr=L._malloc(Cr);try{return ze(ue.cellsToDirectedEdge(Ae,Be,zt,hr,Pr)),yn(Qt(Pr))}finally{L._free(Pr)}}function uo(Mt){var He=J(Mt),Gt=He[0],Ae=He[1],Be=L._malloc(Cr);try{return ze(ue.getDirectedEdgeOrigin(Gt,Ae,Be)),yn(Qt(Be))}finally{L._free(Be)}}function eu(Mt){var He=J(Mt),Gt=He[0],Ae=He[1],Be=L._malloc(Cr);try{return ze(ue.getDirectedEdgeDestination(Gt,Ae,Be)),yn(Qt(Be))}finally{L._free(Be)}}function wa(Mt){var He=J(Mt),Gt=He[0],Ae=He[1];return!!ue.isValidDirectedEdge(Gt,Ae)}function lu(Mt){var He=J(Mt),Gt=He[0],Ae=He[1],Be=2,We=L._calloc(Be,Cr);try{return ze(ue.directedEdgeToCells(Gt,Ae,We)),Br(We,Be)}finally{L._free(We)}}function pr(Mt){var He=J(Mt),Gt=He[0],Ae=He[1],Be=6,We=L._calloc(Be,Cr);try{return ze(ue.originToDirectedEdges(Gt,Ae,We)),Br(We,Be)}finally{L._free(We)}}function vn(Mt,He){var Gt=L._malloc(Jr),Ae=J(Mt),Be=Ae[0],We=Ae[1];try{return ze(ue.directedEdgeToBoundary(Be,We,Gt)),Oa(Gt,He)}finally{L._free(Gt)}}function lo(Mt,He){var Gt=J(Mt),Ae=Gt[0],Be=Gt[1],We=J(He),zt=We[0],hr=We[1],Pr=L._malloc(ln);try{return ze(ue.gridDistance(Ae,Be,zt,hr,Pr)),Yr(Pr)}finally{L._free(Pr)}}function tu(Mt,He){var Gt=J(Mt),Ae=Gt[0],Be=Gt[1],We=J(He),zt=We[0],hr=We[1],Pr=L._malloc(ln);try{ze(ue.gridPathCellsSize(Ae,Be,zt,hr,Pr));var dn=ri(Yr(Pr)),Mn=L._calloc(dn,Cr);try{return ue.gridPathCells(Ae,Be,zt,hr,Mn),Br(Mn,dn)}finally{L._free(Mn)}}finally{L._free(Pr)}}var ru=0;function Ss(Mt,He){var Gt=L._malloc(Vn);try{return ze(ue.cellToLocalIj.apply(ue,J(Mt).concat(J(He),[ru],[Gt]))),Ns(Gt)}finally{L._free(Gt)}}function Zs(Mt,He){if(!He||typeof He.i!="number"||typeof He.j!="number")throw new Error("Coordinates must be provided as an {i, j} object");var Gt=L._malloc(Vn),Ae=L._malloc(Cr);Co(Gt,He);try{return ze(ue.localIjToCell.apply(ue,J(Mt).concat([Gt],[ru],[Ae]))),yn(Qt(Ae))}finally{L._free(Gt),L._free(Ae)}}function Va(Mt,He,Gt){var Ae=Zn(Mt[0],Mt[1]),Be=Zn(He[0],He[1]),We;switch(Gt){case Xr.m:We=ue.greatCircleDistanceM(Ae,Be);break;case Xr.km:We=ue.greatCircleDistanceKm(Ae,Be);break;case Xr.rads:We=ue.greatCircleDistanceRads(Ae,Be);break;default:We=null}if(L._free(Ae),L._free(Be),We===null)throw Ne(ye,Gt);return We}function Xc(Mt,He){var Gt=J(Mt),Ae=Gt[0],Be=Gt[1],We=L._malloc($r);try{switch(He){case Xr.m2:ze(ue.cellAreaM2(Ae,Be,We));break;case Xr.km2:ze(ue.cellAreaKm2(Ae,Be,We));break;case Xr.rads2:ze(ue.cellAreaRads2(Ae,Be,We));break;default:throw Ne(ye,He)}return Dr(We)}finally{L._free(We)}}function Cs(Mt,He){var Gt=J(Mt),Ae=Gt[0],Be=Gt[1],We=L._malloc($r);try{switch(He){case Xr.m:ze(ue.edgeLengthM(Ae,Be,We));break;case Xr.km:ze(ue.edgeLengthKm(Ae,Be,We));break;case Xr.rads:ze(ue.edgeLengthRads(Ae,Be,We));break;default:throw Ne(ye,He)}return Dr(We)}finally{L._free(We)}}function ts(Mt,He){sn(Mt);var Gt=L._malloc($r);try{switch(He){case Xr.m2:ze(ue.getHexagonAreaAvgM2(Mt,Gt));break;case Xr.km2:ze(ue.getHexagonAreaAvgKm2(Mt,Gt));break;default:throw Ne(ye,He)}return Dr(Gt)}finally{L._free(Gt)}}function Pl(Mt,He){sn(Mt);var Gt=L._malloc($r);try{switch(He){case Xr.m:ze(ue.getHexagonEdgeLengthAvgM(Mt,Gt));break;case Xr.km:ze(ue.getHexagonEdgeLengthAvgKm(Mt,Gt));break;default:throw Ne(ye,He)}return Dr(Gt)}finally{L._free(Gt)}}function zi(Mt,He){var Gt=J(Mt),Ae=Gt[0],Be=Gt[1],We=L._malloc(Cr);try{return ze(ue.cellToVertex(Ae,Be,He,We)),yn(Qt(We))}finally{L._free(We)}}function Ll(Mt){var He=J(Mt),Gt=He[0],Ae=He[1],Be=6,We=L._calloc(Be,Cr);try{return ze(ue.cellToVertexes(Gt,Ae,We)),Br(We,Be)}finally{L._free(We)}}function Oo(Mt){var He=L._malloc(Qr),Gt=J(Mt),Ae=Gt[0],Be=Gt[1];try{return ze(ue.vertexToLatLng(Ae,Be,He)),fi(He)}finally{L._free(He)}}function pl(Mt){var He=J(Mt),Gt=He[0],Ae=He[1];return!!ue.isValidVertex(Gt,Ae)}function Ai(Mt){sn(Mt);var He=L._malloc(ln);try{return ze(ue.getNumCells(Mt,He)),Yr(He)}finally{L._free(He)}}function _u(){var Mt=ue.res0CellCount(),He=L._malloc(Cr*Mt);try{return ze(ue.getRes0Cells(He)),Br(He,Mt)}finally{L._free(He)}}function gf(Mt){sn(Mt);var He=ue.pentagonCount(),Gt=L._malloc(Cr*He);try{return ze(ue.getPentagons(Mt,Gt)),Br(Gt,He)}finally{L._free(Gt)}}function Du(Mt){return Mt*Math.PI/180}function rs(Mt){return Mt*180/Math.PI}},50840:function(le,$,C){var L;(function(k,G,Z,F){"use strict";var z=["","webkit","Moz","MS","ms","o"],q=G.createElement("div"),ee="function",fe=Math.round,Se=Math.abs,Re=Date.now;function De(Ae,Be,We){return setTimeout(Pe(Ae,We),Be)}function Ve(Ae,Be,We){return Array.isArray(Ae)?(nt(Ae,We[Be],We),!0):!1}function nt(Ae,Be,We){var zt;if(Ae)if(Ae.forEach)Ae.forEach(Be,We);else if(Ae.length!==F)for(zt=0;zt<Ae.length;)Be.call(We,Ae[zt],zt,Ae),zt++;else for(zt in Ae)Ae.hasOwnProperty(zt)&&Be.call(We,Ae[zt],zt,Ae)}function Ee(Ae,Be,We){var zt="DEPRECATED METHOD: "+Be+`
`+We+` AT 
`;return function(){var hr=new Error("get-stack-trace"),Pr=hr&&hr.stack?hr.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",dn=k.console&&(k.console.warn||k.console.log);return dn&&dn.call(k.console,zt,Pr),Ae.apply(this,arguments)}}var Ie;typeof Object.assign!="function"?Ie=function(Be){if(Be===F||Be===null)throw new TypeError("Cannot convert undefined or null to object");for(var We=Object(Be),zt=1;zt<arguments.length;zt++){var hr=arguments[zt];if(hr!==F&&hr!==null)for(var Pr in hr)hr.hasOwnProperty(Pr)&&(We[Pr]=hr[Pr])}return We}:Ie=Object.assign;var me=Ee(function(Be,We,zt){for(var hr=Object.keys(We),Pr=0;Pr<hr.length;)(!zt||zt&&Be[hr[Pr]]===F)&&(Be[hr[Pr]]=We[hr[Pr]]),Pr++;return Be},"extend","Use `assign`."),we=Ee(function(Be,We){return me(Be,We,!0)},"merge","Use `assign`.");function ne(Ae,Be,We){var zt=Be.prototype,hr;hr=Ae.prototype=Object.create(zt),hr.constructor=Ae,hr._super=zt,We&&Ie(hr,We)}function Pe(Ae,Be){return function(){return Ae.apply(Be,arguments)}}function he(Ae,Be){return typeof Ae==ee?Ae.apply(Be&&Be[0]||F,Be):Ae}function ve(Ae,Be){return Ae===F?Be:Ae}function te(Ae,Be,We){nt(ye(Be),function(zt){Ae.addEventListener(zt,We,!1)})}function Y(Ae,Be,We){nt(ye(Be),function(zt){Ae.removeEventListener(zt,We,!1)})}function Oe(Ae,Be){for(;Ae;){if(Ae==Be)return!0;Ae=Ae.parentNode}return!1}function pe(Ae,Be){return Ae.indexOf(Be)>-1}function ye(Ae){return Ae.trim().split(/\s+/g)}function _e(Ae,Be,We){if(Ae.indexOf&&!We)return Ae.indexOf(Be);for(var zt=0;zt<Ae.length;){if(We&&Ae[zt][We]==Be||!We&&Ae[zt]===Be)return zt;zt++}return-1}function X(Ae){return Array.prototype.slice.call(Ae,0)}function Le(Ae,Be,We){for(var zt=[],hr=[],Pr=0;Pr<Ae.length;){var dn=Be?Ae[Pr][Be]:Ae[Pr];_e(hr,dn)<0&&zt.push(Ae[Pr]),hr[Pr]=dn,Pr++}return We&&(Be?zt=zt.sort(function(vi,co){return vi[Be]>co[Be]}):zt=zt.sort()),zt}function de(Ae,Be){for(var We,zt,hr=Be[0].toUpperCase()+Be.slice(1),Pr=0;Pr<z.length;){if(We=z[Pr],zt=We?We+hr:Be,zt in Ae)return zt;Pr++}return F}var be=1;function se(){return be++}function Ne(Ae){var Be=Ae.ownerDocument||Ae;return Be.defaultView||Be.parentWindow||k}var ze=/mobile|tablet|ip(ad|hone|od)|android/i,ue="ontouchstart"in k,kt=de(k,"PointerEvent")!==F,Rt=ue&&ze.test(navigator.userAgent),cr="touch",Ut="pen",$r="mouse",ln="kinect",Cr=25,Qr=1,Jr=2,xr=4,Gn=8,ti=1,Vn=2,Xr=4,sn=8,yn=16,ki=Vn|Xr,ri=sn|yn,Lt=ki|ri,J=["x","y"],Ue=["clientX","clientY"];function $e(Ae,Be){var We=this;this.manager=Ae,this.callback=Be,this.element=Ae.element,this.target=Ae.options.inputTarget,this.domHandler=function(zt){he(Ae.options.enable,[Ae])&&We.handler(zt)},this.init()}$e.prototype={handler:function(){},init:function(){this.evEl&&te(this.element,this.evEl,this.domHandler),this.evTarget&&te(this.target,this.evTarget,this.domHandler),this.evWin&&te(Ne(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&Y(this.element,this.evEl,this.domHandler),this.evTarget&&Y(this.target,this.evTarget,this.domHandler),this.evWin&&Y(Ne(this.element),this.evWin,this.domHandler)}};function At(Ae){var Be,We=Ae.options.inputClass;return We?Be=We:kt?Be=_n:Rt?Be=cs:ue?Be=Zi:Be=la,new Be(Ae,It)}function It(Ae,Be,We){var zt=We.pointers.length,hr=We.changedPointers.length,Pr=Be&Qr&&zt-hr===0,dn=Be&(xr|Gn)&&zt-hr===0;We.isFirst=!!Pr,We.isFinal=!!dn,Pr&&(Ae.session={}),We.eventType=Be,wt(Ae,We),Ae.emit("hammer.input",We),Ae.recognize(We),Ae.session.prevInput=We}function wt(Ae,Be){var We=Ae.session,zt=Be.pointers,hr=zt.length;We.firstInput||(We.firstInput=Tt(Be)),hr>1&&!We.firstMultiple?We.firstMultiple=Tt(Be):hr===1&&(We.firstMultiple=!1);var Pr=We.firstInput,dn=We.firstMultiple,Mn=dn?dn.center:Pr.center,vi=Be.center=Qt(zt);Be.timeStamp=Re(),Be.deltaTime=Be.timeStamp-Pr.timeStamp,Be.angle=an(Mn,vi),Be.distance=Yr(Mn,vi),mr(We,Be),Be.offsetDirection=Dr(Be.deltaX,Be.deltaY);var co=Er(Be.deltaTime,Be.deltaX,Be.deltaY);Be.overallVelocityX=co.x,Be.overallVelocityY=co.y,Be.overallVelocity=Se(co.x)>Se(co.y)?co.x:co.y,Be.scale=dn?en(dn.pointers,zt):1,Be.rotation=dn?Br(dn.pointers,zt):0,Be.maxPointers=We.prevInput?Be.pointers.length>We.prevInput.maxPointers?Be.pointers.length:We.prevInput.maxPointers:Be.pointers.length,vt(We,Be);var ns=Ae.element;Oe(Be.srcEvent.target,ns)&&(ns=Be.srcEvent.target),Be.target=ns}function mr(Ae,Be){var We=Be.center,zt=Ae.offsetDelta||{},hr=Ae.prevDelta||{},Pr=Ae.prevInput||{};(Be.eventType===Qr||Pr.eventType===xr)&&(hr=Ae.prevDelta={x:Pr.deltaX||0,y:Pr.deltaY||0},zt=Ae.offsetDelta={x:We.x,y:We.y}),Be.deltaX=hr.x+(We.x-zt.x),Be.deltaY=hr.y+(We.y-zt.y)}function vt(Ae,Be){var We=Ae.lastInterval||Be,zt=Be.timeStamp-We.timeStamp,hr,Pr,dn,Mn;if(Be.eventType!=Gn&&(zt>Cr||We.velocity===F)){var vi=Be.deltaX-We.deltaX,co=Be.deltaY-We.deltaY,ns=Er(zt,vi,co);Pr=ns.x,dn=ns.y,hr=Se(ns.x)>Se(ns.y)?ns.x:ns.y,Mn=Dr(vi,co),Ae.lastInterval=Be}else hr=We.velocity,Pr=We.velocityX,dn=We.velocityY,Mn=We.direction;Be.velocity=hr,Be.velocityX=Pr,Be.velocityY=dn,Be.direction=Mn}function Tt(Ae){for(var Be=[],We=0;We<Ae.pointers.length;)Be[We]={clientX:fe(Ae.pointers[We].clientX),clientY:fe(Ae.pointers[We].clientY)},We++;return{timeStamp:Re(),pointers:Be,center:Qt(Be),deltaX:Ae.deltaX,deltaY:Ae.deltaY}}function Qt(Ae){var Be=Ae.length;if(Be===1)return{x:fe(Ae[0].clientX),y:fe(Ae[0].clientY)};for(var We=0,zt=0,hr=0;hr<Be;)We+=Ae[hr].clientX,zt+=Ae[hr].clientY,hr++;return{x:fe(We/Be),y:fe(zt/Be)}}function Er(Ae,Be,We){return{x:Be/Ae||0,y:We/Ae||0}}function Dr(Ae,Be){return Ae===Be?ti:Se(Ae)>=Se(Be)?Ae<0?Vn:Xr:Be<0?sn:yn}function Yr(Ae,Be,We){We||(We=J);var zt=Be[We[0]]-Ae[We[0]],hr=Be[We[1]]-Ae[We[1]];return Math.sqrt(zt*zt+hr*hr)}function an(Ae,Be,We){We||(We=J);var zt=Be[We[0]]-Ae[We[0]],hr=Be[We[1]]-Ae[We[1]];return Math.atan2(hr,zt)*180/Math.PI}function Br(Ae,Be){return an(Be[1],Be[0],Ue)+an(Ae[1],Ae[0],Ue)}function en(Ae,Be){return Yr(Be[0],Be[1],Ue)/Yr(Ae[0],Ae[1],Ue)}var Zn={mousedown:Qr,mousemove:Jr,mouseup:xr},zn="mousedown",fi="mousemove mouseup";function la(){this.evEl=zn,this.evWin=fi,this.pressed=!1,$e.apply(this,arguments)}ne(la,$e,{handler:function(Be){var We=Zn[Be.type];We&Qr&&Be.button===0&&(this.pressed=!0),We&Jr&&Be.which!==1&&(We=xr),this.pressed&&(We&xr&&(this.pressed=!1),this.callback(this.manager,We,{pointers:[Be],changedPointers:[Be],pointerType:$r,srcEvent:Be}))}});var Oa={pointerdown:Qr,pointermove:Jr,pointerup:xr,pointercancel:Gn,pointerout:Gn},Gr={2:cr,3:Ut,4:$r,5:ln},Ns="pointerdown",Co="pointermove pointerup pointercancel";k.MSPointerEvent&&!k.PointerEvent&&(Ns="MSPointerDown",Co="MSPointerMove MSPointerUp MSPointerCancel");function _n(){this.evEl=Ns,this.evWin=Co,$e.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}ne(_n,$e,{handler:function(Be){var We=this.store,zt=!1,hr=Be.type.toLowerCase().replace("ms",""),Pr=Oa[hr],dn=Gr[Be.pointerType]||Be.pointerType,Mn=dn==cr,vi=_e(We,Be.pointerId,"pointerId");Pr&Qr&&(Be.button===0||Mn)?vi<0&&(We.push(Be),vi=We.length-1):Pr&(xr|Gn)&&(zt=!0),!(vi<0)&&(We[vi]=Be,this.callback(this.manager,Pr,{pointers:We,changedPointers:[Be],pointerType:dn,srcEvent:Be}),zt&&We.splice(vi,1))}});var xs={touchstart:Qr,touchmove:Jr,touchend:xr,touchcancel:Gn},go="touchstart",Fs="touchstart touchmove touchend touchcancel";function Po(){this.evTarget=go,this.evWin=Fs,this.started=!1,$e.apply(this,arguments)}ne(Po,$e,{handler:function(Be){var We=xs[Be.type];if(We===Qr&&(this.started=!0),!!this.started){var zt=hl.call(this,Be,We);We&(xr|Gn)&&zt[0].length-zt[1].length===0&&(this.started=!1),this.callback(this.manager,We,{pointers:zt[0],changedPointers:zt[1],pointerType:cr,srcEvent:Be})}}});function hl(Ae,Be){var We=X(Ae.touches),zt=X(Ae.changedTouches);return Be&(xr|Gn)&&(We=Le(We.concat(zt),"identifier",!0)),[We,zt]}var yu={touchstart:Qr,touchmove:Jr,touchend:xr,touchcancel:Gn},Es="touchstart touchmove touchend touchcancel";function cs(){this.evTarget=Es,this.targetIds={},$e.apply(this,arguments)}ne(cs,$e,{handler:function(Be){var We=yu[Be.type],zt=Ou.call(this,Be,We);zt&&this.callback(this.manager,We,{pointers:zt[0],changedPointers:zt[1],pointerType:cr,srcEvent:Be})}});function Ou(Ae,Be){var We=X(Ae.touches),zt=this.targetIds;if(Be&(Qr|Jr)&&We.length===1)return zt[We[0].identifier]=!0,[We,We];var hr,Pr,dn=X(Ae.changedTouches),Mn=[],vi=this.target;if(Pr=We.filter(function(co){return Oe(co.target,vi)}),Be===Qr)for(hr=0;hr<Pr.length;)zt[Pr[hr].identifier]=!0,hr++;for(hr=0;hr<dn.length;)zt[dn[hr].identifier]&&Mn.push(dn[hr]),Be&(xr|Gn)&&delete zt[dn[hr].identifier],hr++;if(Mn.length)return[Le(Pr.concat(Mn),"identifier",!0),Mn]}var Al=2500,ga=25;function Zi(){$e.apply(this,arguments);var Ae=Pe(this.handler,this);this.touch=new cs(this.manager,Ae),this.mouse=new la(this.manager,Ae),this.primaryTouch=null,this.lastTouches=[]}ne(Zi,$e,{handler:function(Be,We,zt){var hr=zt.pointerType==cr,Pr=zt.pointerType==$r;if(!(Pr&&zt.sourceCapabilities&&zt.sourceCapabilities.firesTouchEvents)){if(hr)Bs.call(this,We,zt);else if(Pr&&es.call(this,zt))return;this.callback(Be,We,zt)}},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});function Bs(Ae,Be){Ae&Qr?(this.primaryTouch=Be.changedPointers[0].identifier,no.call(this,Be)):Ae&(xr|Gn)&&no.call(this,Be)}function no(Ae){var Be=Ae.changedPointers[0];if(Be.identifier===this.primaryTouch){var We={x:Be.clientX,y:Be.clientY};this.lastTouches.push(We);var zt=this.lastTouches,hr=function(){var Pr=zt.indexOf(We);Pr>-1&&zt.splice(Pr,1)};setTimeout(hr,Al)}}function es(Ae){for(var Be=Ae.srcEvent.clientX,We=Ae.srcEvent.clientY,zt=0;zt<this.lastTouches.length;zt++){var hr=this.lastTouches[zt],Pr=Math.abs(Be-hr.x),dn=Math.abs(We-hr.y);if(Pr<=ga&&dn<=ga)return!0}return!1}var Lo=de(q.style,"touchAction"),Ni=Lo!==F,io="compute",bs="auto",$o="manipulation",Ru="none",Ca="pan-x",xa="pan-y",Ku=wa();function uo(Ae,Be){this.manager=Ae,this.set(Be)}uo.prototype={set:function(Ae){Ae==io&&(Ae=this.compute()),Ni&&this.manager.element.style&&Ku[Ae]&&(this.manager.element.style[Lo]=Ae),this.actions=Ae.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var Ae=[];return nt(this.manager.recognizers,function(Be){he(Be.options.enable,[Be])&&(Ae=Ae.concat(Be.getTouchAction()))}),eu(Ae.join(" "))},preventDefaults:function(Ae){var Be=Ae.srcEvent,We=Ae.offsetDirection;if(this.manager.session.prevented){Be.preventDefault();return}var zt=this.actions,hr=pe(zt,Ru)&&!Ku[Ru],Pr=pe(zt,xa)&&!Ku[xa],dn=pe(zt,Ca)&&!Ku[Ca];if(hr){var Mn=Ae.pointers.length===1,vi=Ae.distance<2,co=Ae.deltaTime<250;if(Mn&&vi&&co)return}if(!(dn&&Pr)&&(hr||Pr&&We&ki||dn&&We&ri))return this.preventSrc(Be)},preventSrc:function(Ae){this.manager.session.prevented=!0,Ae.preventDefault()}};function eu(Ae){if(pe(Ae,Ru))return Ru;var Be=pe(Ae,Ca),We=pe(Ae,xa);return Be&&We?Ru:Be||We?Be?Ca:xa:pe(Ae,$o)?$o:bs}function wa(){if(!Ni)return!1;var Ae={},Be=k.CSS&&k.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach(function(We){Ae[We]=Be?k.CSS.supports("touch-action",We):!0}),Ae}var lu=1,pr=2,vn=4,lo=8,tu=lo,ru=16,Ss=32;function Zs(Ae){this.options=Ie({},this.defaults,Ae||{}),this.id=se(),this.manager=null,this.options.enable=ve(this.options.enable,!0),this.state=lu,this.simultaneous={},this.requireFail=[]}Zs.prototype={defaults:{},set:function(Ae){return Ie(this.options,Ae),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(Ae){if(Ve(Ae,"recognizeWith",this))return this;var Be=this.simultaneous;return Ae=Cs(Ae,this),Be[Ae.id]||(Be[Ae.id]=Ae,Ae.recognizeWith(this)),this},dropRecognizeWith:function(Ae){return Ve(Ae,"dropRecognizeWith",this)?this:(Ae=Cs(Ae,this),delete this.simultaneous[Ae.id],this)},requireFailure:function(Ae){if(Ve(Ae,"requireFailure",this))return this;var Be=this.requireFail;return Ae=Cs(Ae,this),_e(Be,Ae)===-1&&(Be.push(Ae),Ae.requireFailure(this)),this},dropRequireFailure:function(Ae){if(Ve(Ae,"dropRequireFailure",this))return this;Ae=Cs(Ae,this);var Be=_e(this.requireFail,Ae);return Be>-1&&this.requireFail.splice(Be,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(Ae){return!!this.simultaneous[Ae.id]},emit:function(Ae){var Be=this,We=this.state;function zt(hr){Be.manager.emit(hr,Ae)}We<lo&&zt(Be.options.event+Va(We)),zt(Be.options.event),Ae.additionalEvent&&zt(Ae.additionalEvent),We>=lo&&zt(Be.options.event+Va(We))},tryEmit:function(Ae){if(this.canEmit())return this.emit(Ae);this.state=Ss},canEmit:function(){for(var Ae=0;Ae<this.requireFail.length;){if(!(this.requireFail[Ae].state&(Ss|lu)))return!1;Ae++}return!0},recognize:function(Ae){var Be=Ie({},Ae);if(!he(this.options.enable,[this,Be])){this.reset(),this.state=Ss;return}this.state&(tu|ru|Ss)&&(this.state=lu),this.state=this.process(Be),this.state&(pr|vn|lo|ru)&&this.tryEmit(Be)},process:function(Ae){},getTouchAction:function(){},reset:function(){}};function Va(Ae){return Ae&ru?"cancel":Ae&lo?"end":Ae&vn?"move":Ae&pr?"start":""}function Xc(Ae){return Ae==yn?"down":Ae==sn?"up":Ae==Vn?"left":Ae==Xr?"right":""}function Cs(Ae,Be){var We=Be.manager;return We?We.get(Ae):Ae}function ts(){Zs.apply(this,arguments)}ne(ts,Zs,{defaults:{pointers:1},attrTest:function(Ae){var Be=this.options.pointers;return Be===0||Ae.pointers.length===Be},process:function(Ae){var Be=this.state,We=Ae.eventType,zt=Be&(pr|vn),hr=this.attrTest(Ae);return zt&&(We&Gn||!hr)?Be|ru:zt||hr?We&xr?Be|lo:Be&pr?Be|vn:pr:Ss}});function Pl(){ts.apply(this,arguments),this.pX=null,this.pY=null}ne(Pl,ts,{defaults:{event:"pan",threshold:10,pointers:1,direction:Lt},getTouchAction:function(){var Ae=this.options.direction,Be=[];return Ae&ki&&Be.push(xa),Ae&ri&&Be.push(Ca),Be},directionTest:function(Ae){var Be=this.options,We=!0,zt=Ae.distance,hr=Ae.direction,Pr=Ae.deltaX,dn=Ae.deltaY;return hr&Be.direction||(Be.direction&ki?(hr=Pr===0?ti:Pr<0?Vn:Xr,We=Pr!=this.pX,zt=Math.abs(Ae.deltaX)):(hr=dn===0?ti:dn<0?sn:yn,We=dn!=this.pY,zt=Math.abs(Ae.deltaY))),Ae.direction=hr,We&&zt>Be.threshold&&hr&Be.direction},attrTest:function(Ae){return ts.prototype.attrTest.call(this,Ae)&&(this.state&pr||!(this.state&pr)&&this.directionTest(Ae))},emit:function(Ae){this.pX=Ae.deltaX,this.pY=Ae.deltaY;var Be=Xc(Ae.direction);Be&&(Ae.additionalEvent=this.options.event+Be),this._super.emit.call(this,Ae)}});function zi(){ts.apply(this,arguments)}ne(zi,ts,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[Ru]},attrTest:function(Ae){return this._super.attrTest.call(this,Ae)&&(Math.abs(Ae.scale-1)>this.options.threshold||this.state&pr)},emit:function(Ae){if(Ae.scale!==1){var Be=Ae.scale<1?"in":"out";Ae.additionalEvent=this.options.event+Be}this._super.emit.call(this,Ae)}});function Ll(){Zs.apply(this,arguments),this._timer=null,this._input=null}ne(Ll,Zs,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return[bs]},process:function(Ae){var Be=this.options,We=Ae.pointers.length===Be.pointers,zt=Ae.distance<Be.threshold,hr=Ae.deltaTime>Be.time;if(this._input=Ae,!zt||!We||Ae.eventType&(xr|Gn)&&!hr)this.reset();else if(Ae.eventType&Qr)this.reset(),this._timer=De(function(){this.state=tu,this.tryEmit()},Be.time,this);else if(Ae.eventType&xr)return tu;return Ss},reset:function(){clearTimeout(this._timer)},emit:function(Ae){this.state===tu&&(Ae&&Ae.eventType&xr?this.manager.emit(this.options.event+"up",Ae):(this._input.timeStamp=Re(),this.manager.emit(this.options.event,this._input)))}});function Oo(){ts.apply(this,arguments)}ne(Oo,ts,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[Ru]},attrTest:function(Ae){return this._super.attrTest.call(this,Ae)&&(Math.abs(Ae.rotation)>this.options.threshold||this.state&pr)}});function pl(){ts.apply(this,arguments)}ne(pl,ts,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:ki|ri,pointers:1},getTouchAction:function(){return Pl.prototype.getTouchAction.call(this)},attrTest:function(Ae){var Be=this.options.direction,We;return Be&(ki|ri)?We=Ae.overallVelocity:Be&ki?We=Ae.overallVelocityX:Be&ri&&(We=Ae.overallVelocityY),this._super.attrTest.call(this,Ae)&&Be&Ae.offsetDirection&&Ae.distance>this.options.threshold&&Ae.maxPointers==this.options.pointers&&Se(We)>this.options.velocity&&Ae.eventType&xr},emit:function(Ae){var Be=Xc(Ae.offsetDirection);Be&&this.manager.emit(this.options.event+Be,Ae),this.manager.emit(this.options.event,Ae)}});function Ai(){Zs.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}ne(Ai,Zs,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return[$o]},process:function(Ae){var Be=this.options,We=Ae.pointers.length===Be.pointers,zt=Ae.distance<Be.threshold,hr=Ae.deltaTime<Be.time;if(this.reset(),Ae.eventType&Qr&&this.count===0)return this.failTimeout();if(zt&&hr&&We){if(Ae.eventType!=xr)return this.failTimeout();var Pr=this.pTime?Ae.timeStamp-this.pTime<Be.interval:!0,dn=!this.pCenter||Yr(this.pCenter,Ae.center)<Be.posThreshold;this.pTime=Ae.timeStamp,this.pCenter=Ae.center,!dn||!Pr?this.count=1:this.count+=1,this._input=Ae;var Mn=this.count%Be.taps;if(Mn===0)return this.hasRequireFailures()?(this._timer=De(function(){this.state=tu,this.tryEmit()},Be.interval,this),pr):tu}return Ss},failTimeout:function(){return this._timer=De(function(){this.state=Ss},this.options.interval,this),Ss},reset:function(){clearTimeout(this._timer)},emit:function(){this.state==tu&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}});function _u(Ae,Be){return Be=Be||{},Be.recognizers=ve(Be.recognizers,_u.defaults.preset),new rs(Ae,Be)}_u.VERSION="2.0.7",_u.defaults={domEvents:!1,touchAction:io,enable:!0,inputTarget:null,inputClass:null,preset:[[Oo,{enable:!1}],[zi,{enable:!1},["rotate"]],[pl,{direction:ki}],[Pl,{direction:ki},["swipe"]],[Ai],[Ai,{event:"doubletap",taps:2},["tap"]],[Ll]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}};var gf=1,Du=2;function rs(Ae,Be){this.options=Ie({},_u.defaults,Be||{}),this.options.inputTarget=this.options.inputTarget||Ae,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=Ae,this.input=At(this),this.touchAction=new uo(this,this.options.touchAction),Mt(this,!0),nt(this.options.recognizers,function(We){var zt=this.add(new We[0](We[1]));We[2]&&zt.recognizeWith(We[2]),We[3]&&zt.requireFailure(We[3])},this)}rs.prototype={set:function(Ae){return Ie(this.options,Ae),Ae.touchAction&&this.touchAction.update(),Ae.inputTarget&&(this.input.destroy(),this.input.target=Ae.inputTarget,this.input.init()),this},stop:function(Ae){this.session.stopped=Ae?Du:gf},recognize:function(Ae){var Be=this.session;if(!Be.stopped){this.touchAction.preventDefaults(Ae);var We,zt=this.recognizers,hr=Be.curRecognizer;(!hr||hr&&hr.state&tu)&&(hr=Be.curRecognizer=null);for(var Pr=0;Pr<zt.length;)We=zt[Pr],Be.stopped!==Du&&(!hr||We==hr||We.canRecognizeWith(hr))?We.recognize(Ae):We.reset(),!hr&&We.state&(pr|vn|lo)&&(hr=Be.curRecognizer=We),Pr++}},get:function(Ae){if(Ae instanceof Zs)return Ae;for(var Be=this.recognizers,We=0;We<Be.length;We++)if(Be[We].options.event==Ae)return Be[We];return null},add:function(Ae){if(Ve(Ae,"add",this))return this;var Be=this.get(Ae.options.event);return Be&&this.remove(Be),this.recognizers.push(Ae),Ae.manager=this,this.touchAction.update(),Ae},remove:function(Ae){if(Ve(Ae,"remove",this))return this;if(Ae=this.get(Ae),Ae){var Be=this.recognizers,We=_e(Be,Ae);We!==-1&&(Be.splice(We,1),this.touchAction.update())}return this},on:function(Ae,Be){if(Ae!==F&&Be!==F){var We=this.handlers;return nt(ye(Ae),function(zt){We[zt]=We[zt]||[],We[zt].push(Be)}),this}},off:function(Ae,Be){if(Ae!==F){var We=this.handlers;return nt(ye(Ae),function(zt){Be?We[zt]&&We[zt].splice(_e(We[zt],Be),1):delete We[zt]}),this}},emit:function(Ae,Be){this.options.domEvents&&He(Ae,Be);var We=this.handlers[Ae]&&this.handlers[Ae].slice();if(!(!We||!We.length)){Be.type=Ae,Be.preventDefault=function(){Be.srcEvent.preventDefault()};for(var zt=0;zt<We.length;)We[zt](Be),zt++}},destroy:function(){this.element&&Mt(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}};function Mt(Ae,Be){var We=Ae.element;if(We.style){var zt;nt(Ae.options.cssProps,function(hr,Pr){zt=de(We.style,Pr),Be?(Ae.oldCssProps[zt]=We.style[zt],We.style[zt]=hr):We.style[zt]=Ae.oldCssProps[zt]||""}),Be||(Ae.oldCssProps={})}}function He(Ae,Be){var We=G.createEvent("Event");We.initEvent(Ae,!0,!0),We.gesture=Be,Be.target.dispatchEvent(We)}Ie(_u,{INPUT_START:Qr,INPUT_MOVE:Jr,INPUT_END:xr,INPUT_CANCEL:Gn,STATE_POSSIBLE:lu,STATE_BEGAN:pr,STATE_CHANGED:vn,STATE_ENDED:lo,STATE_RECOGNIZED:tu,STATE_CANCELLED:ru,STATE_FAILED:Ss,DIRECTION_NONE:ti,DIRECTION_LEFT:Vn,DIRECTION_RIGHT:Xr,DIRECTION_UP:sn,DIRECTION_DOWN:yn,DIRECTION_HORIZONTAL:ki,DIRECTION_VERTICAL:ri,DIRECTION_ALL:Lt,Manager:rs,Input:$e,TouchAction:uo,TouchInput:cs,MouseInput:la,PointerEventInput:_n,TouchMouseInput:Zi,SingleTouchInput:Po,Recognizer:Zs,AttrRecognizer:ts,Tap:Ai,Pan:Pl,Swipe:pl,Pinch:zi,Rotate:Oo,Press:Ll,on:te,off:Y,each:nt,merge:we,extend:me,assign:Ie,inherit:ne,bindFn:Pe,prefixed:de});var Gt=typeof k!="undefined"?k:typeof self!="undefined"?self:{};Gt.Hammer=_u,L=function(){return _u}.call($,C,$,le),L!==F&&(le.exports=L)})(window,document,"Hammer")},31044:function(le,$,C){"use strict";var L=C(40210),k=L("%Object.defineProperty%",!0),G=function(){if(k)try{return k({},"a",{value:1}),!0}catch(F){return!1}return!1};G.hasArrayLengthDefineBug=function(){if(!G())return null;try{return k([],"length",{value:1}).length!==1}catch(F){return!0}},le.exports=G},28185:function(le){"use strict";var $={foo:{}},C=Object;le.exports=function(){return{__proto__:$}.foo===$.foo&&!({__proto__:null}instanceof C)}},41405:function(le,$,C){"use strict";var L=typeof Symbol!="undefined"&&Symbol,k=C(55419);le.exports=function(){return typeof L!="function"||typeof Symbol!="function"||typeof L("foo")!="symbol"||typeof Symbol("bar")!="symbol"?!1:k()}},55419:function(le){"use strict";le.exports=function(){if(typeof Symbol!="function"||typeof Object.getOwnPropertySymbols!="function")return!1;if(typeof Symbol.iterator=="symbol")return!0;var C={},L=Symbol("test"),k=Object(L);if(typeof L=="string"||Object.prototype.toString.call(L)!=="[object Symbol]"||Object.prototype.toString.call(k)!=="[object Symbol]")return!1;var G=42;C[L]=G;for(L in C)return!1;if(typeof Object.keys=="function"&&Object.keys(C).length!==0||typeof Object.getOwnPropertyNames=="function"&&Object.getOwnPropertyNames(C).length!==0)return!1;var Z=Object.getOwnPropertySymbols(C);if(Z.length!==1||Z[0]!==L||!Object.prototype.propertyIsEnumerable.call(C,L))return!1;if(typeof Object.getOwnPropertyDescriptor=="function"){var F=Object.getOwnPropertyDescriptor(C,L);if(F.value!==G||F.enumerable!==!0)return!1}return!0}},96410:function(le,$,C){"use strict";var L=C(55419);le.exports=function(){return L()&&!!Symbol.toStringTag}},78001:function(le,$,C){"use strict";var L=Function.prototype.call,k=Object.prototype.hasOwnProperty,G=C(58612);le.exports=G.call(L,k)},80645:function(le,$){$.read=function(C,L,k,G,Z){var F,z,q=Z*8-G-1,ee=(1<<q)-1,fe=ee>>1,Se=-7,Re=k?Z-1:0,De=k?-1:1,Ve=C[L+Re];for(Re+=De,F=Ve&(1<<-Se)-1,Ve>>=-Se,Se+=q;Se>0;F=F*256+C[L+Re],Re+=De,Se-=8);for(z=F&(1<<-Se)-1,F>>=-Se,Se+=G;Se>0;z=z*256+C[L+Re],Re+=De,Se-=8);if(F===0)F=1-fe;else{if(F===ee)return z?NaN:(Ve?-1:1)*(1/0);z=z+Math.pow(2,G),F=F-fe}return(Ve?-1:1)*z*Math.pow(2,F-G)},$.write=function(C,L,k,G,Z,F){var z,q,ee,fe=F*8-Z-1,Se=(1<<fe)-1,Re=Se>>1,De=Z===23?Math.pow(2,-24)-Math.pow(2,-77):0,Ve=G?0:F-1,nt=G?1:-1,Ee=L<0||L===0&&1/L<0?1:0;for(L=Math.abs(L),isNaN(L)||L===1/0?(q=isNaN(L)?1:0,z=Se):(z=Math.floor(Math.log(L)/Math.LN2),L*(ee=Math.pow(2,-z))<1&&(z--,ee*=2),z+Re>=1?L+=De/ee:L+=De*Math.pow(2,1-Re),L*ee>=2&&(z++,ee/=2),z+Re>=Se?(q=0,z=Se):z+Re>=1?(q=(L*ee-1)*Math.pow(2,Z),z=z+Re):(q=L*Math.pow(2,Re-1)*Math.pow(2,Z),z=0));Z>=8;C[k+Ve]=q&255,Ve+=nt,q/=256,Z-=8);for(z=z<<Z|q,fe+=Z;fe>0;C[k+Ve]=z&255,Ve+=nt,z/=256,fe-=8);C[k+Ve-nt]|=Ee*128}},7375:function(le,$){"use strict";Object.defineProperty($,"__esModule",{value:!0});var C=Symbol.for("INJECTION");function L(z,q,ee,fe){function Se(){return fe&&!Reflect.hasMetadata(C,this,q)&&Reflect.defineMetadata(C,ee(),this,q),Reflect.hasMetadata(C,this,q)?Reflect.getMetadata(C,this,q):ee()}function Re(De){Reflect.defineMetadata(C,De,this,q)}Object.defineProperty(z,q,{configurable:!0,enumerable:!0,get:Se,set:Re})}function k(z,q){return function(ee){return function(fe,Se){var Re=function(){return z.get(ee)};L(fe,Se,Re,q)}}}$.makePropertyInjectDecorator=k;function G(z,q){return function(ee,fe){return function(Se,Re){var De=function(){return z.getNamed(ee,fe)};L(Se,Re,De,q)}}}$.makePropertyInjectNamedDecorator=G;function Z(z,q){return function(ee,fe,Se){return function(Re,De){var Ve=function(){return z.getTagged(ee,fe,Se)};L(Re,De,Ve,q)}}}$.makePropertyInjectTaggedDecorator=Z;function F(z,q){return function(ee){return function(fe,Se){var Re=function(){return z.getAll(ee)};L(fe,Se,Re,q)}}}$.makePropertyMultiInjectDecorator=F},84879:function(le,$,C){"use strict";var L;L={value:!0};var k=C(7375);function G(Z,F){F===void 0&&(F=!0);var z=k.makePropertyInjectDecorator(Z,F),q=k.makePropertyInjectNamedDecorator(Z,F),ee=k.makePropertyInjectTaggedDecorator(Z,F),fe=k.makePropertyMultiInjectDecorator(Z,F);return{lazyInject:z,lazyInjectNamed:q,lazyInjectTagged:ee,lazyMultiInject:fe}}$.Z=G},99934:function(le,$,C){"use strict";Object.defineProperty($,"__esModule",{value:!0}),$.tagProperty=$.tagParameter=$.decorate=void 0;var L=C(16674),k=C(6867);function G(fe,Se,Re,De){var Ve=k.TAGGED;F(Ve,fe,Se,De,Re)}$.tagParameter=G;function Z(fe,Se,Re){var De=k.TAGGED_PROP;F(De,fe.constructor,Se,Re)}$.tagProperty=Z;function F(fe,Se,Re,De,Ve){var nt={},Ee=typeof Ve=="number",Ie=Ve!==void 0&&Ee?Ve.toString():Re;if(Ee&&Re!==void 0)throw new Error(L.INVALID_DECORATOR_OPERATION);Reflect.hasOwnMetadata(fe,Se)&&(nt=Reflect.getMetadata(fe,Se));var me=nt[Ie];if(!Array.isArray(me))me=[];else for(var we=0,ne=me;we<ne.length;we++){var Pe=ne[we];if(Pe.key===De.key)throw new Error(L.DUPLICATED_METADATA+" "+Pe.key.toString())}me.push(De),nt[Ie]=me,Reflect.defineMetadata(fe,nt,Se)}function z(fe,Se){Reflect.decorate(fe,Se)}function q(fe,Se){return function(Re,De){Se(Re,De,fe)}}function ee(fe,Se,Re){typeof Re=="number"?z([q(Re,fe)],Se):typeof Re=="string"?Reflect.decorate([fe],Se,Re):z([fe],Se)}$.decorate=ee},5744:function(le,$,C){"use strict";Object.defineProperty($,"__esModule",{value:!0}),$.inject=$.LazyServiceIdentifer=void 0;var L=C(16674),k=C(6867),G=C(47738),Z=C(99934),F=function(){function q(ee){this._cb=ee}return q.prototype.unwrap=function(){return this._cb()},q}();$.LazyServiceIdentifer=F;function z(q){return function(ee,fe,Se){if(q===void 0)throw new Error(L.UNDEFINED_INJECT_ANNOTATION(ee.name));var Re=new G.Metadata(k.INJECT_TAG,q);typeof Se=="number"?Z.tagParameter(ee,fe,Se,Re):Z.tagProperty(ee,fe,Re)}}$.inject=z},64315:function(le,$,C){"use strict";Object.defineProperty($,"__esModule",{value:!0}),$.injectable=void 0;var L=C(16674),k=C(6867);function G(){return function(Z){if(Reflect.hasOwnMetadata(k.PARAM_TYPES,Z))throw new Error(L.DUPLICATED_INJECTABLE_DECORATOR);var F=Reflect.getMetadata(k.DESIGN_PARAM_TYPES,Z)||[];return Reflect.defineMetadata(k.PARAM_TYPES,F,Z),Z}}$.injectable=G},71693:function(le,$,C){"use strict";Object.defineProperty($,"__esModule",{value:!0}),$.multiInject=void 0;var L=C(6867),k=C(47738),G=C(99934);function Z(F){return function(z,q,ee){var fe=new k.Metadata(L.MULTI_INJECT_TAG,F);typeof ee=="number"?G.tagParameter(z,q,ee,fe):G.tagProperty(z,q,fe)}}$.multiInject=Z},38085:function(le,$,C){"use strict";Object.defineProperty($,"__esModule",{value:!0}),$.named=void 0;var L=C(6867),k=C(47738),G=C(99934);function Z(F){return function(z,q,ee){var fe=new k.Metadata(L.NAMED_TAG,F);typeof ee=="number"?G.tagParameter(z,q,ee,fe):G.tagProperty(z,q,fe)}}$.named=Z},6515:function(le,$,C){"use strict";Object.defineProperty($,"__esModule",{value:!0}),$.optional=void 0;var L=C(6867),k=C(47738),G=C(99934);function Z(){return function(F,z,q){var ee=new k.Metadata(L.OPTIONAL_TAG,!0);typeof q=="number"?G.tagParameter(F,z,q,ee):G.tagProperty(F,z,ee)}}$.optional=Z},7014:function(le,$,C){"use strict";Object.defineProperty($,"__esModule",{value:!0}),$.postConstruct=void 0;var L=C(16674),k=C(6867),G=C(47738);function Z(){return function(F,z,q){var ee=new G.Metadata(k.POST_CONSTRUCT,z);if(Reflect.hasOwnMetadata(k.POST_CONSTRUCT,F.constructor))throw new Error(L.MULTIPLE_POST_CONSTRUCT_METHODS);Reflect.defineMetadata(k.POST_CONSTRUCT,ee,F.constructor)}}$.postConstruct=Z},32052:function(le,$,C){"use strict";Object.defineProperty($,"__esModule",{value:!0}),$.tagged=void 0;var L=C(47738),k=C(99934);function G(Z,F){return function(z,q,ee){var fe=new L.Metadata(Z,F);typeof ee=="number"?k.tagParameter(z,q,ee,fe):k.tagProperty(z,q,fe)}}$.tagged=G},55638:function(le,$,C){"use strict";Object.defineProperty($,"__esModule",{value:!0}),$.targetName=void 0;var L=C(6867),k=C(47738),G=C(99934);function Z(F){return function(z,q,ee){var fe=new k.Metadata(L.NAME_TAG,F);G.tagParameter(z,q,ee,fe)}}$.targetName=Z},86757:function(le,$,C){"use strict";Object.defineProperty($,"__esModule",{value:!0}),$.unmanaged=void 0;var L=C(6867),k=C(47738),G=C(99934);function Z(){return function(F,z,q){var ee=new k.Metadata(L.UNMANAGED_TAG,!0);G.tagParameter(F,z,q,ee)}}$.unmanaged=Z},44290:function(le,$,C){"use strict";Object.defineProperty($,"__esModule",{value:!0}),$.Binding=void 0;var L=C(28421),k=C(37791),G=function(){function Z(F,z){this.id=k.id(),this.activated=!1,this.serviceIdentifier=F,this.scope=z,this.type=L.BindingTypeEnum.Invalid,this.constraint=function(q){return!0},this.implementationType=null,this.cache=null,this.factory=null,this.provider=null,this.onActivation=null,this.dynamicValue=null}return Z.prototype.clone=function(){var F=new Z(this.serviceIdentifier,this.scope);return F.activated=F.scope===L.BindingScopeEnum.Singleton?this.activated:!1,F.implementationType=this.implementationType,F.dynamicValue=this.dynamicValue,F.scope=this.scope,F.type=this.type,F.factory=this.factory,F.provider=this.provider,F.constraint=this.constraint,F.onActivation=this.onActivation,F.cache=this.cache,F},Z}();$.Binding=G},23184:function(le,$){"use strict";Object.defineProperty($,"__esModule",{value:!0}),$.BindingCount=void 0;var C={MultipleBindingsAvailable:2,NoBindingsAvailable:0,OnlyOneBindingAvailable:1};$.BindingCount=C},16674:function(le,$){"use strict";Object.defineProperty($,"__esModule",{value:!0}),$.STACK_OVERFLOW=$.CIRCULAR_DEPENDENCY_IN_FACTORY=$.POST_CONSTRUCT_ERROR=$.MULTIPLE_POST_CONSTRUCT_METHODS=$.CONTAINER_OPTIONS_INVALID_SKIP_BASE_CHECK=$.CONTAINER_OPTIONS_INVALID_AUTO_BIND_INJECTABLE=$.CONTAINER_OPTIONS_INVALID_DEFAULT_SCOPE=$.CONTAINER_OPTIONS_MUST_BE_AN_OBJECT=$.ARGUMENTS_LENGTH_MISMATCH=$.INVALID_DECORATOR_OPERATION=$.INVALID_TO_SELF_VALUE=$.INVALID_FUNCTION_BINDING=$.INVALID_MIDDLEWARE_RETURN=$.NO_MORE_SNAPSHOTS_AVAILABLE=$.INVALID_BINDING_TYPE=$.NOT_IMPLEMENTED=$.CIRCULAR_DEPENDENCY=$.UNDEFINED_INJECT_ANNOTATION=$.MISSING_INJECT_ANNOTATION=$.MISSING_INJECTABLE_ANNOTATION=$.NOT_REGISTERED=$.CANNOT_UNBIND=$.AMBIGUOUS_MATCH=$.KEY_NOT_FOUND=$.NULL_ARGUMENT=$.DUPLICATED_METADATA=$.DUPLICATED_INJECTABLE_DECORATOR=void 0,$.DUPLICATED_INJECTABLE_DECORATOR="Cannot apply @injectable decorator multiple times.",$.DUPLICATED_METADATA="Metadata key was used more than once in a parameter:",$.NULL_ARGUMENT="NULL argument",$.KEY_NOT_FOUND="Key Not Found",$.AMBIGUOUS_MATCH="Ambiguous match found for serviceIdentifier:",$.CANNOT_UNBIND="Could not unbind serviceIdentifier:",$.NOT_REGISTERED="No matching bindings found for serviceIdentifier:",$.MISSING_INJECTABLE_ANNOTATION="Missing required @injectable annotation in:",$.MISSING_INJECT_ANNOTATION="Missing required @inject or @multiInject annotation in:";var C=function(Z){return"@inject called with undefined this could mean that the class "+Z+" has a circular dependency problem. You can use a LazyServiceIdentifer to  overcome this limitation."};$.UNDEFINED_INJECT_ANNOTATION=C,$.CIRCULAR_DEPENDENCY="Circular dependency found:",$.NOT_IMPLEMENTED="Sorry, this feature is not fully implemented yet.",$.INVALID_BINDING_TYPE="Invalid binding type:",$.NO_MORE_SNAPSHOTS_AVAILABLE="No snapshot available to restore.",$.INVALID_MIDDLEWARE_RETURN="Invalid return type in middleware. Middleware must return!",$.INVALID_FUNCTION_BINDING="Value provided to function binding must be a function!",$.INVALID_TO_SELF_VALUE="The toSelf function can only be applied when a constructor is used as service identifier",$.INVALID_DECORATOR_OPERATION="The @inject @multiInject @tagged and @named decorators must be applied to the parameters of a class constructor or a class property.";var L=function(){for(var Z=[],F=0;F<arguments.length;F++)Z[F]=arguments[F];return"The number of constructor arguments in the derived class "+(Z[0]+" must be >= than the number of constructor arguments of its base class.")};$.ARGUMENTS_LENGTH_MISMATCH=L,$.CONTAINER_OPTIONS_MUST_BE_AN_OBJECT="Invalid Container constructor argument. Container options must be an object.",$.CONTAINER_OPTIONS_INVALID_DEFAULT_SCOPE="Invalid Container option. Default scope must be a string ('singleton' or 'transient').",$.CONTAINER_OPTIONS_INVALID_AUTO_BIND_INJECTABLE="Invalid Container option. Auto bind injectable must be a boolean",$.CONTAINER_OPTIONS_INVALID_SKIP_BASE_CHECK="Invalid Container option. Skip base check must be a boolean",$.MULTIPLE_POST_CONSTRUCT_METHODS="Cannot apply @postConstruct decorator multiple times in the same class";var k=function(){for(var Z=[],F=0;F<arguments.length;F++)Z[F]=arguments[F];return"@postConstruct error in class "+Z[0]+": "+Z[1]};$.POST_CONSTRUCT_ERROR=k;var G=function(){for(var Z=[],F=0;F<arguments.length;F++)Z[F]=arguments[F];return"It looks like there is a circular dependency "+("in one of the '"+Z[0]+"' bindings. Please investigate bindings with")+("service identifier '"+Z[1]+"'.")};$.CIRCULAR_DEPENDENCY_IN_FACTORY=G,$.STACK_OVERFLOW="Maximum call stack size exceeded"},28421:function(le,$){"use strict";Object.defineProperty($,"__esModule",{value:!0}),$.TargetTypeEnum=$.BindingTypeEnum=$.BindingScopeEnum=void 0;var C={Request:"Request",Singleton:"Singleton",Transient:"Transient"};$.BindingScopeEnum=C;var L={ConstantValue:"ConstantValue",Constructor:"Constructor",DynamicValue:"DynamicValue",Factory:"Factory",Function:"Function",Instance:"Instance",Invalid:"Invalid",Provider:"Provider"};$.BindingTypeEnum=L;var k={ClassProperty:"ClassProperty",ConstructorArgument:"ConstructorArgument",Variable:"Variable"};$.TargetTypeEnum=k},6867:function(le,$){"use strict";Object.defineProperty($,"__esModule",{value:!0}),$.NON_CUSTOM_TAG_KEYS=$.POST_CONSTRUCT=$.DESIGN_PARAM_TYPES=$.PARAM_TYPES=$.TAGGED_PROP=$.TAGGED=$.MULTI_INJECT_TAG=$.INJECT_TAG=$.OPTIONAL_TAG=$.UNMANAGED_TAG=$.NAME_TAG=$.NAMED_TAG=void 0,$.NAMED_TAG="named",$.NAME_TAG="name",$.UNMANAGED_TAG="unmanaged",$.OPTIONAL_TAG="optional",$.INJECT_TAG="inject",$.MULTI_INJECT_TAG="multi_inject",$.TAGGED="inversify:tagged",$.TAGGED_PROP="inversify:tagged_props",$.PARAM_TYPES="inversify:paramtypes",$.DESIGN_PARAM_TYPES="design:paramtypes",$.POST_CONSTRUCT="post_construct";function C(){return[$.INJECT_TAG,$.MULTI_INJECT_TAG,$.NAME_TAG,$.UNMANAGED_TAG,$.NAMED_TAG,$.OPTIONAL_TAG]}$.NON_CUSTOM_TAG_KEYS=C()},51389:function(le,$,C){"use strict";var L=this&&this.__awaiter||function(me,we,ne,Pe){function he(ve){return ve instanceof ne?ve:new ne(function(te){te(ve)})}return new(ne||(ne=Promise))(function(ve,te){function Y(ye){try{pe(Pe.next(ye))}catch(_e){te(_e)}}function Oe(ye){try{pe(Pe.throw(ye))}catch(_e){te(_e)}}function pe(ye){ye.done?ve(ye.value):he(ye.value).then(Y,Oe)}pe((Pe=Pe.apply(me,we||[])).next())})},k=this&&this.__generator||function(me,we){var ne={label:0,sent:function(){if(ve[0]&1)throw ve[1];return ve[1]},trys:[],ops:[]},Pe,he,ve,te;return te={next:Y(0),throw:Y(1),return:Y(2)},typeof Symbol=="function"&&(te[Symbol.iterator]=function(){return this}),te;function Y(pe){return function(ye){return Oe([pe,ye])}}function Oe(pe){if(Pe)throw new TypeError("Generator is already executing.");for(;ne;)try{if(Pe=1,he&&(ve=pe[0]&2?he.return:pe[0]?he.throw||((ve=he.return)&&ve.call(he),0):he.next)&&!(ve=ve.call(he,pe[1])).done)return ve;switch(he=0,ve&&(pe=[pe[0]&2,ve.value]),pe[0]){case 0:case 1:ve=pe;break;case 4:return ne.label++,{value:pe[1],done:!1};case 5:ne.label++,he=pe[1],pe=[0];continue;case 7:pe=ne.ops.pop(),ne.trys.pop();continue;default:if(ve=ne.trys,!(ve=ve.length>0&&ve[ve.length-1])&&(pe[0]===6||pe[0]===2)){ne=0;continue}if(pe[0]===3&&(!ve||pe[1]>ve[0]&&pe[1]<ve[3])){ne.label=pe[1];break}if(pe[0]===6&&ne.label<ve[1]){ne.label=ve[1],ve=pe;break}if(ve&&ne.label<ve[2]){ne.label=ve[2],ne.ops.push(pe);break}ve[2]&&ne.ops.pop(),ne.trys.pop();continue}pe=we.call(me,ne)}catch(ye){pe=[6,ye],he=0}finally{Pe=ve=0}if(pe[0]&5)throw pe[1];return{value:pe[0]?pe[1]:void 0,done:!0}}},G=this&&this.__spreadArray||function(me,we){for(var ne=0,Pe=we.length,he=me.length;ne<Pe;ne++,he++)me[he]=we[ne];return me};Object.defineProperty($,"__esModule",{value:!0}),$.Container=void 0;var Z=C(44290),F=C(16674),z=C(28421),q=C(6867),ee=C(51377),fe=C(86311),Se=C(31927),Re=C(51860),De=C(37791),Ve=C(55800),nt=C(85700),Ee=C(80175),Ie=function(){function me(we){this._appliedMiddleware=[];var ne=we||{};if(typeof ne!="object")throw new Error(""+F.CONTAINER_OPTIONS_MUST_BE_AN_OBJECT);if(ne.defaultScope===void 0)ne.defaultScope=z.BindingScopeEnum.Transient;else if(ne.defaultScope!==z.BindingScopeEnum.Singleton&&ne.defaultScope!==z.BindingScopeEnum.Transient&&ne.defaultScope!==z.BindingScopeEnum.Request)throw new Error(""+F.CONTAINER_OPTIONS_INVALID_DEFAULT_SCOPE);if(ne.autoBindInjectable===void 0)ne.autoBindInjectable=!1;else if(typeof ne.autoBindInjectable!="boolean")throw new Error(""+F.CONTAINER_OPTIONS_INVALID_AUTO_BIND_INJECTABLE);if(ne.skipBaseClassChecks===void 0)ne.skipBaseClassChecks=!1;else if(typeof ne.skipBaseClassChecks!="boolean")throw new Error(""+F.CONTAINER_OPTIONS_INVALID_SKIP_BASE_CHECK);this.options={autoBindInjectable:ne.autoBindInjectable,defaultScope:ne.defaultScope,skipBaseClassChecks:ne.skipBaseClassChecks},this.id=De.id(),this._bindingDictionary=new Ee.Lookup,this._snapshots=[],this._middleware=null,this.parent=null,this._metadataReader=new ee.MetadataReader}return me.merge=function(we,ne){for(var Pe=[],he=2;he<arguments.length;he++)Pe[he-2]=arguments[he];var ve=new me,te=G([we,ne],Pe).map(function(pe){return fe.getBindingDictionary(pe)}),Y=fe.getBindingDictionary(ve);function Oe(pe,ye){pe.traverse(function(_e,X){X.forEach(function(Le){ye.add(Le.serviceIdentifier,Le.clone())})})}return te.forEach(function(pe){Oe(pe,Y)}),ve},me.prototype.load=function(){for(var we=[],ne=0;ne<arguments.length;ne++)we[ne]=arguments[ne];for(var Pe=this._getContainerModuleHelpersFactory(),he=0,ve=we;he<ve.length;he++){var te=ve[he],Y=Pe(te.id);te.registry(Y.bindFunction,Y.unbindFunction,Y.isboundFunction,Y.rebindFunction)}},me.prototype.loadAsync=function(){for(var we=[],ne=0;ne<arguments.length;ne++)we[ne]=arguments[ne];return L(this,void 0,void 0,function(){var Pe,he,ve,te,Y;return k(this,function(Oe){switch(Oe.label){case 0:Pe=this._getContainerModuleHelpersFactory(),he=0,ve=we,Oe.label=1;case 1:return he<ve.length?(te=ve[he],Y=Pe(te.id),[4,te.registry(Y.bindFunction,Y.unbindFunction,Y.isboundFunction,Y.rebindFunction)]):[3,4];case 2:Oe.sent(),Oe.label=3;case 3:return he++,[3,1];case 4:return[2]}})})},me.prototype.unload=function(){for(var we=this,ne=[],Pe=0;Pe<arguments.length;Pe++)ne[Pe]=arguments[Pe];var he=function(ve){return function(te){return te.moduleId===ve}};ne.forEach(function(ve){var te=he(ve.id);we._bindingDictionary.removeByCondition(te)})},me.prototype.bind=function(we){var ne=this.options.defaultScope||z.BindingScopeEnum.Transient,Pe=new Z.Binding(we,ne);return this._bindingDictionary.add(we,Pe),new Re.BindingToSyntax(Pe)},me.prototype.rebind=function(we){return this.unbind(we),this.bind(we)},me.prototype.unbind=function(we){try{this._bindingDictionary.remove(we)}catch(ne){throw new Error(F.CANNOT_UNBIND+" "+Ve.getServiceIdentifierAsString(we))}},me.prototype.unbindAll=function(){this._bindingDictionary=new Ee.Lookup},me.prototype.isBound=function(we){var ne=this._bindingDictionary.hasKey(we);return!ne&&this.parent&&(ne=this.parent.isBound(we)),ne},me.prototype.isBoundNamed=function(we,ne){return this.isBoundTagged(we,q.NAMED_TAG,ne)},me.prototype.isBoundTagged=function(we,ne,Pe){var he=!1;if(this._bindingDictionary.hasKey(we)){var ve=this._bindingDictionary.get(we),te=fe.createMockRequest(this,we,ne,Pe);he=ve.some(function(Y){return Y.constraint(te)})}return!he&&this.parent&&(he=this.parent.isBoundTagged(we,ne,Pe)),he},me.prototype.snapshot=function(){this._snapshots.push(nt.ContainerSnapshot.of(this._bindingDictionary.clone(),this._middleware))},me.prototype.restore=function(){var we=this._snapshots.pop();if(we===void 0)throw new Error(F.NO_MORE_SNAPSHOTS_AVAILABLE);this._bindingDictionary=we.bindings,this._middleware=we.middleware},me.prototype.createChild=function(we){var ne=new me(we||this.options);return ne.parent=this,ne},me.prototype.applyMiddleware=function(){for(var we=[],ne=0;ne<arguments.length;ne++)we[ne]=arguments[ne];this._appliedMiddleware=this._appliedMiddleware.concat(we);var Pe=this._middleware?this._middleware:this._planAndResolve();this._middleware=we.reduce(function(he,ve){return ve(he)},Pe)},me.prototype.applyCustomMetadataReader=function(we){this._metadataReader=we},me.prototype.get=function(we){return this._get(!1,!1,z.TargetTypeEnum.Variable,we)},me.prototype.getTagged=function(we,ne,Pe){return this._get(!1,!1,z.TargetTypeEnum.Variable,we,ne,Pe)},me.prototype.getNamed=function(we,ne){return this.getTagged(we,q.NAMED_TAG,ne)},me.prototype.getAll=function(we){return this._get(!0,!0,z.TargetTypeEnum.Variable,we)},me.prototype.getAllTagged=function(we,ne,Pe){return this._get(!1,!0,z.TargetTypeEnum.Variable,we,ne,Pe)},me.prototype.getAllNamed=function(we,ne){return this.getAllTagged(we,q.NAMED_TAG,ne)},me.prototype.resolve=function(we){var ne=this.createChild();return ne.bind(we).toSelf(),this._appliedMiddleware.forEach(function(Pe){ne.applyMiddleware(Pe)}),ne.get(we)},me.prototype._getContainerModuleHelpersFactory=function(){var we=this,ne=function(Y,Oe){Y._binding.moduleId=Oe},Pe=function(Y){return function(Oe){var pe=we.bind.bind(we),ye=pe(Oe);return ne(ye,Y),ye}},he=function(Y){return function(Oe){var pe=we.unbind.bind(we);pe(Oe)}},ve=function(Y){return function(Oe){var pe=we.isBound.bind(we);return pe(Oe)}},te=function(Y){return function(Oe){var pe=we.rebind.bind(we),ye=pe(Oe);return ne(ye,Y),ye}};return function(Y){return{bindFunction:Pe(Y),isboundFunction:ve(Y),rebindFunction:te(Y),unbindFunction:he(Y)}}},me.prototype._get=function(we,ne,Pe,he,ve,te){var Y=null,Oe={avoidConstraints:we,contextInterceptor:function(pe){return pe},isMultiInject:ne,key:ve,serviceIdentifier:he,targetType:Pe,value:te};if(this._middleware){if(Y=this._middleware(Oe),Y==null)throw new Error(F.INVALID_MIDDLEWARE_RETURN)}else Y=this._planAndResolve()(Oe);return Y},me.prototype._planAndResolve=function(){var we=this;return function(ne){var Pe=fe.plan(we._metadataReader,we,ne.isMultiInject,ne.targetType,ne.serviceIdentifier,ne.key,ne.value,ne.avoidConstraints);Pe=ne.contextInterceptor(Pe);var he=Se.resolve(Pe);return he}},me}();$.Container=Ie},33244:function(le,$,C){"use strict";Object.defineProperty($,"__esModule",{value:!0}),$.AsyncContainerModule=$.ContainerModule=void 0;var L=C(37791),k=function(){function Z(F){this.id=L.id(),this.registry=F}return Z}();$.ContainerModule=k;var G=function(){function Z(F){this.id=L.id(),this.registry=F}return Z}();$.AsyncContainerModule=G},85700:function(le,$){"use strict";Object.defineProperty($,"__esModule",{value:!0}),$.ContainerSnapshot=void 0;var C=function(){function L(){}return L.of=function(k,G){var Z=new L;return Z.bindings=k,Z.middleware=G,Z},L}();$.ContainerSnapshot=C},80175:function(le,$,C){"use strict";Object.defineProperty($,"__esModule",{value:!0}),$.Lookup=void 0;var L=C(16674),k=function(){function G(){this._map=new Map}return G.prototype.getMap=function(){return this._map},G.prototype.add=function(Z,F){if(Z==null)throw new Error(L.NULL_ARGUMENT);if(F==null)throw new Error(L.NULL_ARGUMENT);var z=this._map.get(Z);z!==void 0?(z.push(F),this._map.set(Z,z)):this._map.set(Z,[F])},G.prototype.get=function(Z){if(Z==null)throw new Error(L.NULL_ARGUMENT);var F=this._map.get(Z);if(F!==void 0)return F;throw new Error(L.KEY_NOT_FOUND)},G.prototype.remove=function(Z){if(Z==null)throw new Error(L.NULL_ARGUMENT);if(!this._map.delete(Z))throw new Error(L.KEY_NOT_FOUND)},G.prototype.removeByCondition=function(Z){var F=this;this._map.forEach(function(z,q){var ee=z.filter(function(fe){return!Z(fe)});ee.length>0?F._map.set(q,ee):F._map.delete(q)})},G.prototype.hasKey=function(Z){if(Z==null)throw new Error(L.NULL_ARGUMENT);return this._map.has(Z)},G.prototype.clone=function(){var Z=new G;return this._map.forEach(function(F,z){F.forEach(function(q){return Z.add(z,q.clone())})}),Z},G.prototype.traverse=function(Z){this._map.forEach(function(F,z){Z(z,F)})},G}();$.Lookup=k},86700:function(le,$,C){"use strict";var L;L={value:!0},L=L=L=L=L=L=$.GW=L=L=$.zY=L=L=L=L=L=$.f3=L=L=$.b2=L=L=L=L=L=$.W2=L=void 0;var k=C(6867);L=k;var G=C(51389);Object.defineProperty($,"W2",{enumerable:!0,get:function(){return G.Container}});var Z=C(28421);L={enumerable:!0,get:function(){return Z.BindingScopeEnum}},L={enumerable:!0,get:function(){return Z.BindingTypeEnum}},L={enumerable:!0,get:function(){return Z.TargetTypeEnum}};var F=C(33244);L={enumerable:!0,get:function(){return F.AsyncContainerModule}},L={enumerable:!0,get:function(){return F.ContainerModule}};var z=C(64315);Object.defineProperty($,"b2",{enumerable:!0,get:function(){return z.injectable}});var q=C(32052);L={enumerable:!0,get:function(){return q.tagged}};var ee=C(38085);L={enumerable:!0,get:function(){return ee.named}};var fe=C(5744);Object.defineProperty($,"f3",{enumerable:!0,get:function(){return fe.inject}}),L={enumerable:!0,get:function(){return fe.LazyServiceIdentifer}};var Se=C(6515);L={enumerable:!0,get:function(){return Se.optional}};var Re=C(86757);L={enumerable:!0,get:function(){return Re.unmanaged}};var De=C(71693);L={enumerable:!0,get:function(){return De.multiInject}};var Ve=C(55638);L={enumerable:!0,get:function(){return Ve.targetName}};var nt=C(7014);Object.defineProperty($,"zY",{enumerable:!0,get:function(){return nt.postConstruct}});var Ee=C(51377);L={enumerable:!0,get:function(){return Ee.MetadataReader}};var Ie=C(37791);L={enumerable:!0,get:function(){return Ie.id}};var me=C(99934);Object.defineProperty($,"GW",{enumerable:!0,get:function(){return me.decorate}});var we=C(80758);L={enumerable:!0,get:function(){return we.traverseAncerstors}},L={enumerable:!0,get:function(){return we.taggedConstraint}},L={enumerable:!0,get:function(){return we.namedConstraint}},L={enumerable:!0,get:function(){return we.typeConstraint}};var ne=C(55800);L={enumerable:!0,get:function(){return ne.getServiceIdentifierAsString}};var Pe=C(70600);L={enumerable:!0,get:function(){return Pe.multiBindToService}}},95228:function(le,$,C){"use strict";Object.defineProperty($,"__esModule",{value:!0}),$.Context=void 0;var L=C(37791),k=function(){function G(Z){this.id=L.id(),this.container=Z}return G.prototype.addPlan=function(Z){this.plan=Z},G.prototype.setCurrentRequest=function(Z){this.currentRequest=Z},G}();$.Context=k},47738:function(le,$,C){"use strict";Object.defineProperty($,"__esModule",{value:!0}),$.Metadata=void 0;var L=C(6867),k=function(){function G(Z,F){this.key=Z,this.value=F}return G.prototype.toString=function(){return this.key===L.NAMED_TAG?"named: "+this.value.toString()+" ":"tagged: { key:"+this.key.toString()+", value: "+this.value+" }"},G}();$.Metadata=k},51377:function(le,$,C){"use strict";Object.defineProperty($,"__esModule",{value:!0}),$.MetadataReader=void 0;var L=C(6867),k=function(){function G(){}return G.prototype.getConstructorMetadata=function(Z){var F=Reflect.getMetadata(L.PARAM_TYPES,Z),z=Reflect.getMetadata(L.TAGGED,Z);return{compilerGeneratedMetadata:F,userGeneratedMetadata:z||{}}},G.prototype.getPropertiesMetadata=function(Z){var F=Reflect.getMetadata(L.TAGGED_PROP,Z)||[];return F},G}();$.MetadataReader=k},55314:function(le,$){"use strict";Object.defineProperty($,"__esModule",{value:!0}),$.Plan=void 0;var C=function(){function L(k,G){this.parentContext=k,this.rootRequest=G}return L}();$.Plan=C},86311:function(le,$,C){"use strict";Object.defineProperty($,"__esModule",{value:!0}),$.getBindingDictionary=$.createMockRequest=$.plan=void 0;var L=C(23184),k=C(16674),G=C(28421),Z=C(6867),F=C(85265),z=C(55800),q=C(95228),ee=C(47738),fe=C(55314),Se=C(6e3),Re=C(6748),De=C(18924);function Ve(he){return he._bindingDictionary}$.getBindingDictionary=Ve;function nt(he,ve,te,Y,Oe,pe){var ye=he?Z.MULTI_INJECT_TAG:Z.INJECT_TAG,_e=new ee.Metadata(ye,te),X=new De.Target(ve,Y,te,_e);if(Oe!==void 0){var Le=new ee.Metadata(Oe,pe);X.metadata.push(Le)}return X}function Ee(he,ve,te,Y,Oe){var pe=we(te.container,Oe.serviceIdentifier),ye=[];return pe.length===L.BindingCount.NoBindingsAvailable&&te.container.options.autoBindInjectable&&typeof Oe.serviceIdentifier=="function"&&he.getConstructorMetadata(Oe.serviceIdentifier).compilerGeneratedMetadata&&(te.container.bind(Oe.serviceIdentifier).toSelf(),pe=we(te.container,Oe.serviceIdentifier)),ve?ye=pe:ye=pe.filter(function(_e){var X=new Re.Request(_e.serviceIdentifier,te,Y,_e,Oe);return _e.constraint(X)}),Ie(Oe.serviceIdentifier,ye,Oe,te.container),ye}function Ie(he,ve,te,Y){switch(ve.length){case L.BindingCount.NoBindingsAvailable:if(te.isOptional())return ve;var Oe=z.getServiceIdentifierAsString(he),pe=k.NOT_REGISTERED;throw pe+=z.listMetadataForTarget(Oe,te),pe+=z.listRegisteredBindingsForServiceIdentifier(Y,Oe,we),new Error(pe);case L.BindingCount.OnlyOneBindingAvailable:if(!te.isArray())return ve;case L.BindingCount.MultipleBindingsAvailable:default:if(te.isArray())return ve;var Oe=z.getServiceIdentifierAsString(he),pe=k.AMBIGUOUS_MATCH+" "+Oe;throw pe+=z.listRegisteredBindingsForServiceIdentifier(Y,Oe,we),new Error(pe)}}function me(he,ve,te,Y,Oe,pe){var ye,_e;if(Oe===null){ye=Ee(he,ve,Y,null,pe),_e=new Re.Request(te,Y,null,ye,pe);var X=new fe.Plan(Y,_e);Y.addPlan(X)}else ye=Ee(he,ve,Y,Oe,pe),_e=Oe.addChildRequest(pe.serviceIdentifier,ye,pe);ye.forEach(function(Le){var de=null;if(pe.isArray())de=_e.addChildRequest(Le.serviceIdentifier,Le,pe);else{if(Le.cache)return;de=_e}if(Le.type===G.BindingTypeEnum.Instance&&Le.implementationType!==null){var be=Se.getDependencies(he,Le.implementationType);if(!Y.container.options.skipBaseClassChecks){var se=Se.getBaseClassDependencyCount(he,Le.implementationType);if(be.length<se){var Ne=k.ARGUMENTS_LENGTH_MISMATCH(Se.getFunctionName(Le.implementationType));throw new Error(Ne)}}be.forEach(function(ze){me(he,!1,ze.serviceIdentifier,Y,de,ze)})}})}function we(he,ve){var te=[],Y=Ve(he);return Y.hasKey(ve)?te=Y.get(ve):he.parent!==null&&(te=we(he.parent,ve)),te}function ne(he,ve,te,Y,Oe,pe,ye,_e){_e===void 0&&(_e=!1);var X=new q.Context(ve),Le=nt(te,Y,Oe,"",pe,ye);try{return me(he,_e,Oe,X,null,Le),X}catch(de){throw F.isStackOverflowExeption(de)&&X.plan&&z.circularDependencyToException(X.plan.rootRequest),de}}$.plan=ne;function Pe(he,ve,te,Y){var Oe=new De.Target(G.TargetTypeEnum.Variable,"",ve,new ee.Metadata(te,Y)),pe=new q.Context(he),ye=new Re.Request(ve,pe,null,[],Oe);return ye}$.createMockRequest=Pe},88460:function(le,$){"use strict";Object.defineProperty($,"__esModule",{value:!0}),$.QueryableString=void 0;var C=function(){function L(k){this.str=k}return L.prototype.startsWith=function(k){return this.str.indexOf(k)===0},L.prototype.endsWith=function(k){var G="",Z=k.split("").reverse().join("");return G=this.str.split("").reverse().join(""),this.startsWith.call({str:G},Z)},L.prototype.contains=function(k){return this.str.indexOf(k)!==-1},L.prototype.equals=function(k){return this.str===k},L.prototype.value=function(){return this.str},L}();$.QueryableString=C},6e3:function(le,$,C){"use strict";var L=this&&this.__spreadArray||function(Ee,Ie){for(var me=0,we=Ie.length,ne=Ee.length;me<we;me++,ne++)Ee[ne]=Ie[me];return Ee};Object.defineProperty($,"__esModule",{value:!0}),$.getFunctionName=$.getBaseClassDependencyCount=$.getDependencies=void 0;var k=C(5744),G=C(16674),Z=C(28421),F=C(6867),z=C(55800);Object.defineProperty($,"getFunctionName",{enumerable:!0,get:function(){return z.getFunctionName}});var q=C(18924);function ee(Ee,Ie){var me=z.getFunctionName(Ie),we=fe(Ee,me,Ie,!1);return we}$.getDependencies=ee;function fe(Ee,Ie,me,we){var ne=Ee.getConstructorMetadata(me),Pe=ne.compilerGeneratedMetadata;if(Pe===void 0){var he=G.MISSING_INJECTABLE_ANNOTATION+" "+Ie+".";throw new Error(he)}var ve=ne.userGeneratedMetadata,te=Object.keys(ve),Y=me.length===0&&te.length>0,Oe=te.length>me.length,pe=Y||Oe?te.length:me.length,ye=Re(we,Ie,Pe,ve,pe),_e=De(Ee,me),X=L(L([],ye),_e);return X}function Se(Ee,Ie,me,we,ne){var Pe=ne[Ee.toString()]||[],he=nt(Pe),ve=he.unmanaged!==!0,te=we[Ee],Y=he.inject||he.multiInject;if(te=Y||te,te instanceof k.LazyServiceIdentifer&&(te=te.unwrap()),ve){var Oe=te===Object,pe=te===Function,ye=te===void 0,_e=Oe||pe||ye;if(!Ie&&_e){var X=G.MISSING_INJECT_ANNOTATION+" argument "+Ee+" in class "+me+".";throw new Error(X)}var Le=new q.Target(Z.TargetTypeEnum.ConstructorArgument,he.targetName,te);return Le.metadata=Pe,Le}return null}function Re(Ee,Ie,me,we,ne){for(var Pe=[],he=0;he<ne;he++){var ve=he,te=Se(ve,Ee,Ie,me,we);te!==null&&Pe.push(te)}return Pe}function De(Ee,Ie){for(var me=Ee.getPropertiesMetadata(Ie),we=[],ne=Object.keys(me),Pe=0,he=ne;Pe<he.length;Pe++){var ve=he[Pe],te=me[ve],Y=nt(me[ve]),Oe=Y.targetName||ve,pe=Y.inject||Y.multiInject,ye=new q.Target(Z.TargetTypeEnum.ClassProperty,Oe,pe);ye.metadata=te,we.push(ye)}var _e=Object.getPrototypeOf(Ie.prototype).constructor;if(_e!==Object){var X=De(Ee,_e);we=L(L([],we),X)}return we}function Ve(Ee,Ie){var me=Object.getPrototypeOf(Ie.prototype).constructor;if(me!==Object){var we=z.getFunctionName(me),ne=fe(Ee,we,me,!0),Pe=ne.map(function(te){return te.metadata.filter(function(Y){return Y.key===F.UNMANAGED_TAG})}),he=[].concat.apply([],Pe).length,ve=ne.length-he;return ve>0?ve:Ve(Ee,me)}else return 0}$.getBaseClassDependencyCount=Ve;function nt(Ee){var Ie={};return Ee.forEach(function(me){Ie[me.key.toString()]=me.value}),{inject:Ie[F.INJECT_TAG],multiInject:Ie[F.MULTI_INJECT_TAG],targetName:Ie[F.NAME_TAG],unmanaged:Ie[F.UNMANAGED_TAG]}}},6748:function(le,$,C){"use strict";Object.defineProperty($,"__esModule",{value:!0}),$.Request=void 0;var L=C(37791),k=function(){function G(Z,F,z,q,ee){this.id=L.id(),this.serviceIdentifier=Z,this.parentContext=F,this.parentRequest=z,this.target=ee,this.childRequests=[],this.bindings=Array.isArray(q)?q:[q],this.requestScope=z===null?new Map:null}return G.prototype.addChildRequest=function(Z,F,z){var q=new G(Z,this.parentContext,this,F,z);return this.childRequests.push(q),q},G}();$.Request=k},18924:function(le,$,C){"use strict";Object.defineProperty($,"__esModule",{value:!0}),$.Target=void 0;var L=C(6867),k=C(37791),G=C(47738),Z=C(88460),F=function(){function z(q,ee,fe,Se){this.id=k.id(),this.type=q,this.serviceIdentifier=fe,this.name=new Z.QueryableString(ee||""),this.metadata=new Array;var Re=null;typeof Se=="string"?Re=new G.Metadata(L.NAMED_TAG,Se):Se instanceof G.Metadata&&(Re=Se),Re!==null&&this.metadata.push(Re)}return z.prototype.hasTag=function(q){for(var ee=0,fe=this.metadata;ee<fe.length;ee++){var Se=fe[ee];if(Se.key===q)return!0}return!1},z.prototype.isArray=function(){return this.hasTag(L.MULTI_INJECT_TAG)},z.prototype.matchesArray=function(q){return this.matchesTag(L.MULTI_INJECT_TAG)(q)},z.prototype.isNamed=function(){return this.hasTag(L.NAMED_TAG)},z.prototype.isTagged=function(){return this.metadata.some(function(q){return L.NON_CUSTOM_TAG_KEYS.every(function(ee){return q.key!==ee})})},z.prototype.isOptional=function(){return this.matchesTag(L.OPTIONAL_TAG)(!0)},z.prototype.getNamedTag=function(){return this.isNamed()?this.metadata.filter(function(q){return q.key===L.NAMED_TAG})[0]:null},z.prototype.getCustomTags=function(){return this.isTagged()?this.metadata.filter(function(q){return L.NON_CUSTOM_TAG_KEYS.every(function(ee){return q.key!==ee})}):null},z.prototype.matchesNamedTag=function(q){return this.matchesTag(L.NAMED_TAG)(q)},z.prototype.matchesTag=function(q){var ee=this;return function(fe){for(var Se=0,Re=ee.metadata;Se<Re.length;Se++){var De=Re[Se];if(De.key===q&&De.value===fe)return!0}return!1}},z}();$.Target=F},52279:function(le,$,C){"use strict";var L=this&&this.__spreadArray||function(fe,Se){for(var Re=0,De=Se.length,Ve=fe.length;Re<De;Re++,Ve++)fe[Ve]=Se[Re];return fe};Object.defineProperty($,"__esModule",{value:!0}),$.resolveInstance=void 0;var k=C(16674),G=C(28421),Z=C(6867);function F(fe,Se,Re){var De=Se.filter(function(nt){return nt.target!==null&&nt.target.type===G.TargetTypeEnum.ClassProperty}),Ve=De.map(Re);return De.forEach(function(nt,Ee){var Ie="";Ie=nt.target.name.value();var me=Ve[Ee];fe[Ie]=me}),fe}function z(fe,Se){return new(fe.bind.apply(fe,L([void 0],Se)))}function q(fe,Se){if(Reflect.hasMetadata(Z.POST_CONSTRUCT,fe)){var Re=Reflect.getMetadata(Z.POST_CONSTRUCT,fe);try{Se[Re.value]()}catch(De){throw new Error(k.POST_CONSTRUCT_ERROR(fe.name,De.message))}}}function ee(fe,Se,Re){var De=null;if(Se.length>0){var Ve=Se.filter(function(Ee){return Ee.target!==null&&Ee.target.type===G.TargetTypeEnum.ConstructorArgument}),nt=Ve.map(Re);De=z(fe,nt),De=F(De,Se,Re)}else De=new fe;return q(fe,De),De}$.resolveInstance=ee},31927:function(le,$,C){"use strict";Object.defineProperty($,"__esModule",{value:!0}),$.resolve=void 0;var L=C(16674),k=C(28421),G=C(85265),Z=C(55800),F=C(52279),z=function(fe,Se,Re){try{return Re()}catch(De){throw G.isStackOverflowExeption(De)?new Error(L.CIRCULAR_DEPENDENCY_IN_FACTORY(fe,Se.toString())):De}},q=function(fe){return function(Se){Se.parentContext.setCurrentRequest(Se);var Re=Se.bindings,De=Se.childRequests,Ve=Se.target&&Se.target.isArray(),nt=!Se.parentRequest||!Se.parentRequest.target||!Se.target||!Se.parentRequest.target.matchesArray(Se.target.serviceIdentifier);if(Ve&&nt)return De.map(function(Pe){var he=q(fe);return he(Pe)});var Ee=null;if(Se.target.isOptional()&&Re.length===0)return;var Ie=Re[0],me=Ie.scope===k.BindingScopeEnum.Singleton,we=Ie.scope===k.BindingScopeEnum.Request;if(me&&Ie.activated)return Ie.cache;if(we&&fe!==null&&fe.has(Ie.id))return fe.get(Ie.id);if(Ie.type===k.BindingTypeEnum.ConstantValue)Ee=Ie.cache,Ie.activated=!0;else if(Ie.type===k.BindingTypeEnum.Function)Ee=Ie.cache,Ie.activated=!0;else if(Ie.type===k.BindingTypeEnum.Constructor)Ee=Ie.implementationType;else if(Ie.type===k.BindingTypeEnum.DynamicValue&&Ie.dynamicValue!==null)Ee=z("toDynamicValue",Ie.serviceIdentifier,function(){return Ie.dynamicValue(Se.parentContext)});else if(Ie.type===k.BindingTypeEnum.Factory&&Ie.factory!==null)Ee=z("toFactory",Ie.serviceIdentifier,function(){return Ie.factory(Se.parentContext)});else if(Ie.type===k.BindingTypeEnum.Provider&&Ie.provider!==null)Ee=z("toProvider",Ie.serviceIdentifier,function(){return Ie.provider(Se.parentContext)});else if(Ie.type===k.BindingTypeEnum.Instance&&Ie.implementationType!==null)Ee=F.resolveInstance(Ie.implementationType,De,q(fe));else{var ne=Z.getServiceIdentifierAsString(Se.serviceIdentifier);throw new Error(L.INVALID_BINDING_TYPE+" "+ne)}return typeof Ie.onActivation=="function"&&(Ee=Ie.onActivation(Se.parentContext,Ee)),me&&(Ie.cache=Ee,Ie.activated=!0),we&&fe!==null&&!fe.has(Ie.id)&&fe.set(Ie.id,Ee),Ee}};function ee(fe){var Se=q(fe.plan.rootRequest.requestScope);return Se(fe.plan.rootRequest)}$.resolve=ee},83366:function(le,$,C){"use strict";Object.defineProperty($,"__esModule",{value:!0}),$.BindingInSyntax=void 0;var L=C(28421),k=C(71325),G=function(){function Z(F){this._binding=F}return Z.prototype.inRequestScope=function(){return this._binding.scope=L.BindingScopeEnum.Request,new k.BindingWhenOnSyntax(this._binding)},Z.prototype.inSingletonScope=function(){return this._binding.scope=L.BindingScopeEnum.Singleton,new k.BindingWhenOnSyntax(this._binding)},Z.prototype.inTransientScope=function(){return this._binding.scope=L.BindingScopeEnum.Transient,new k.BindingWhenOnSyntax(this._binding)},Z}();$.BindingInSyntax=G},99812:function(le,$,C){"use strict";Object.defineProperty($,"__esModule",{value:!0}),$.BindingInWhenOnSyntax=void 0;var L=C(83366),k=C(51811),G=C(98370),Z=function(){function F(z){this._binding=z,this._bindingWhenSyntax=new G.BindingWhenSyntax(this._binding),this._bindingOnSyntax=new k.BindingOnSyntax(this._binding),this._bindingInSyntax=new L.BindingInSyntax(z)}return F.prototype.inRequestScope=function(){return this._bindingInSyntax.inRequestScope()},F.prototype.inSingletonScope=function(){return this._bindingInSyntax.inSingletonScope()},F.prototype.inTransientScope=function(){return this._bindingInSyntax.inTransientScope()},F.prototype.when=function(z){return this._bindingWhenSyntax.when(z)},F.prototype.whenTargetNamed=function(z){return this._bindingWhenSyntax.whenTargetNamed(z)},F.prototype.whenTargetIsDefault=function(){return this._bindingWhenSyntax.whenTargetIsDefault()},F.prototype.whenTargetTagged=function(z,q){return this._bindingWhenSyntax.whenTargetTagged(z,q)},F.prototype.whenInjectedInto=function(z){return this._bindingWhenSyntax.whenInjectedInto(z)},F.prototype.whenParentNamed=function(z){return this._bindingWhenSyntax.whenParentNamed(z)},F.prototype.whenParentTagged=function(z,q){return this._bindingWhenSyntax.whenParentTagged(z,q)},F.prototype.whenAnyAncestorIs=function(z){return this._bindingWhenSyntax.whenAnyAncestorIs(z)},F.prototype.whenNoAncestorIs=function(z){return this._bindingWhenSyntax.whenNoAncestorIs(z)},F.prototype.whenAnyAncestorNamed=function(z){return this._bindingWhenSyntax.whenAnyAncestorNamed(z)},F.prototype.whenAnyAncestorTagged=function(z,q){return this._bindingWhenSyntax.whenAnyAncestorTagged(z,q)},F.prototype.whenNoAncestorNamed=function(z){return this._bindingWhenSyntax.whenNoAncestorNamed(z)},F.prototype.whenNoAncestorTagged=function(z,q){return this._bindingWhenSyntax.whenNoAncestorTagged(z,q)},F.prototype.whenAnyAncestorMatches=function(z){return this._bindingWhenSyntax.whenAnyAncestorMatches(z)},F.prototype.whenNoAncestorMatches=function(z){return this._bindingWhenSyntax.whenNoAncestorMatches(z)},F.prototype.onActivation=function(z){return this._bindingOnSyntax.onActivation(z)},F}();$.BindingInWhenOnSyntax=Z},51811:function(le,$,C){"use strict";Object.defineProperty($,"__esModule",{value:!0}),$.BindingOnSyntax=void 0;var L=C(98370),k=function(){function G(Z){this._binding=Z}return G.prototype.onActivation=function(Z){return this._binding.onActivation=Z,new L.BindingWhenSyntax(this._binding)},G}();$.BindingOnSyntax=k},51860:function(le,$,C){"use strict";Object.defineProperty($,"__esModule",{value:!0}),$.BindingToSyntax=void 0;var L=C(16674),k=C(28421),G=C(99812),Z=C(71325),F=function(){function z(q){this._binding=q}return z.prototype.to=function(q){return this._binding.type=k.BindingTypeEnum.Instance,this._binding.implementationType=q,new G.BindingInWhenOnSyntax(this._binding)},z.prototype.toSelf=function(){if(typeof this._binding.serviceIdentifier!="function")throw new Error(""+L.INVALID_TO_SELF_VALUE);var q=this._binding.serviceIdentifier;return this.to(q)},z.prototype.toConstantValue=function(q){return this._binding.type=k.BindingTypeEnum.ConstantValue,this._binding.cache=q,this._binding.dynamicValue=null,this._binding.implementationType=null,this._binding.scope=k.BindingScopeEnum.Singleton,new Z.BindingWhenOnSyntax(this._binding)},z.prototype.toDynamicValue=function(q){return this._binding.type=k.BindingTypeEnum.DynamicValue,this._binding.cache=null,this._binding.dynamicValue=q,this._binding.implementationType=null,new G.BindingInWhenOnSyntax(this._binding)},z.prototype.toConstructor=function(q){return this._binding.type=k.BindingTypeEnum.Constructor,this._binding.implementationType=q,this._binding.scope=k.BindingScopeEnum.Singleton,new Z.BindingWhenOnSyntax(this._binding)},z.prototype.toFactory=function(q){return this._binding.type=k.BindingTypeEnum.Factory,this._binding.factory=q,this._binding.scope=k.BindingScopeEnum.Singleton,new Z.BindingWhenOnSyntax(this._binding)},z.prototype.toFunction=function(q){if(typeof q!="function")throw new Error(L.INVALID_FUNCTION_BINDING);var ee=this.toConstantValue(q);return this._binding.type=k.BindingTypeEnum.Function,this._binding.scope=k.BindingScopeEnum.Singleton,ee},z.prototype.toAutoFactory=function(q){return this._binding.type=k.BindingTypeEnum.Factory,this._binding.factory=function(ee){var fe=function(){return ee.container.get(q)};return fe},this._binding.scope=k.BindingScopeEnum.Singleton,new Z.BindingWhenOnSyntax(this._binding)},z.prototype.toProvider=function(q){return this._binding.type=k.BindingTypeEnum.Provider,this._binding.provider=q,this._binding.scope=k.BindingScopeEnum.Singleton,new Z.BindingWhenOnSyntax(this._binding)},z.prototype.toService=function(q){this.toDynamicValue(function(ee){return ee.container.get(q)})},z}();$.BindingToSyntax=F},71325:function(le,$,C){"use strict";Object.defineProperty($,"__esModule",{value:!0}),$.BindingWhenOnSyntax=void 0;var L=C(51811),k=C(98370),G=function(){function Z(F){this._binding=F,this._bindingWhenSyntax=new k.BindingWhenSyntax(this._binding),this._bindingOnSyntax=new L.BindingOnSyntax(this._binding)}return Z.prototype.when=function(F){return this._bindingWhenSyntax.when(F)},Z.prototype.whenTargetNamed=function(F){return this._bindingWhenSyntax.whenTargetNamed(F)},Z.prototype.whenTargetIsDefault=function(){return this._bindingWhenSyntax.whenTargetIsDefault()},Z.prototype.whenTargetTagged=function(F,z){return this._bindingWhenSyntax.whenTargetTagged(F,z)},Z.prototype.whenInjectedInto=function(F){return this._bindingWhenSyntax.whenInjectedInto(F)},Z.prototype.whenParentNamed=function(F){return this._bindingWhenSyntax.whenParentNamed(F)},Z.prototype.whenParentTagged=function(F,z){return this._bindingWhenSyntax.whenParentTagged(F,z)},Z.prototype.whenAnyAncestorIs=function(F){return this._bindingWhenSyntax.whenAnyAncestorIs(F)},Z.prototype.whenNoAncestorIs=function(F){return this._bindingWhenSyntax.whenNoAncestorIs(F)},Z.prototype.whenAnyAncestorNamed=function(F){return this._bindingWhenSyntax.whenAnyAncestorNamed(F)},Z.prototype.whenAnyAncestorTagged=function(F,z){return this._bindingWhenSyntax.whenAnyAncestorTagged(F,z)},Z.prototype.whenNoAncestorNamed=function(F){return this._bindingWhenSyntax.whenNoAncestorNamed(F)},Z.prototype.whenNoAncestorTagged=function(F,z){return this._bindingWhenSyntax.whenNoAncestorTagged(F,z)},Z.prototype.whenAnyAncestorMatches=function(F){return this._bindingWhenSyntax.whenAnyAncestorMatches(F)},Z.prototype.whenNoAncestorMatches=function(F){return this._bindingWhenSyntax.whenNoAncestorMatches(F)},Z.prototype.onActivation=function(F){return this._bindingOnSyntax.onActivation(F)},Z}();$.BindingWhenOnSyntax=G},98370:function(le,$,C){"use strict";Object.defineProperty($,"__esModule",{value:!0}),$.BindingWhenSyntax=void 0;var L=C(51811),k=C(80758),G=function(){function Z(F){this._binding=F}return Z.prototype.when=function(F){return this._binding.constraint=F,new L.BindingOnSyntax(this._binding)},Z.prototype.whenTargetNamed=function(F){return this._binding.constraint=k.namedConstraint(F),new L.BindingOnSyntax(this._binding)},Z.prototype.whenTargetIsDefault=function(){return this._binding.constraint=function(F){var z=F.target!==null&&!F.target.isNamed()&&!F.target.isTagged();return z},new L.BindingOnSyntax(this._binding)},Z.prototype.whenTargetTagged=function(F,z){return this._binding.constraint=k.taggedConstraint(F)(z),new L.BindingOnSyntax(this._binding)},Z.prototype.whenInjectedInto=function(F){return this._binding.constraint=function(z){return k.typeConstraint(F)(z.parentRequest)},new L.BindingOnSyntax(this._binding)},Z.prototype.whenParentNamed=function(F){return this._binding.constraint=function(z){return k.namedConstraint(F)(z.parentRequest)},new L.BindingOnSyntax(this._binding)},Z.prototype.whenParentTagged=function(F,z){return this._binding.constraint=function(q){return k.taggedConstraint(F)(z)(q.parentRequest)},new L.BindingOnSyntax(this._binding)},Z.prototype.whenAnyAncestorIs=function(F){return this._binding.constraint=function(z){return k.traverseAncerstors(z,k.typeConstraint(F))},new L.BindingOnSyntax(this._binding)},Z.prototype.whenNoAncestorIs=function(F){return this._binding.constraint=function(z){return!k.traverseAncerstors(z,k.typeConstraint(F))},new L.BindingOnSyntax(this._binding)},Z.prototype.whenAnyAncestorNamed=function(F){return this._binding.constraint=function(z){return k.traverseAncerstors(z,k.namedConstraint(F))},new L.BindingOnSyntax(this._binding)},Z.prototype.whenNoAncestorNamed=function(F){return this._binding.constraint=function(z){return!k.traverseAncerstors(z,k.namedConstraint(F))},new L.BindingOnSyntax(this._binding)},Z.prototype.whenAnyAncestorTagged=function(F,z){return this._binding.constraint=function(q){return k.traverseAncerstors(q,k.taggedConstraint(F)(z))},new L.BindingOnSyntax(this._binding)},Z.prototype.whenNoAncestorTagged=function(F,z){return this._binding.constraint=function(q){return!k.traverseAncerstors(q,k.taggedConstraint(F)(z))},new L.BindingOnSyntax(this._binding)},Z.prototype.whenAnyAncestorMatches=function(F){return this._binding.constraint=function(z){return k.traverseAncerstors(z,F)},new L.BindingOnSyntax(this._binding)},Z.prototype.whenNoAncestorMatches=function(F){return this._binding.constraint=function(z){return!k.traverseAncerstors(z,F)},new L.BindingOnSyntax(this._binding)},Z}();$.BindingWhenSyntax=G},80758:function(le,$,C){"use strict";Object.defineProperty($,"__esModule",{value:!0}),$.typeConstraint=$.namedConstraint=$.taggedConstraint=$.traverseAncerstors=void 0;var L=C(6867),k=C(47738),G=function(q,ee){var fe=q.parentRequest;return fe!==null?ee(fe)?!0:G(fe,ee):!1};$.traverseAncerstors=G;var Z=function(q){return function(ee){var fe=function(Se){return Se!==null&&Se.target!==null&&Se.target.matchesTag(q)(ee)};return fe.metaData=new k.Metadata(q,ee),fe}};$.taggedConstraint=Z;var F=Z(L.NAMED_TAG);$.namedConstraint=F;var z=function(q){return function(ee){var fe=null;if(ee!==null)if(fe=ee.bindings[0],typeof q=="string"){var Se=fe.serviceIdentifier;return Se===q}else{var Re=ee.bindings[0].implementationType;return q===Re}return!1}};$.typeConstraint=z},70600:function(le,$){"use strict";Object.defineProperty($,"__esModule",{value:!0}),$.multiBindToService=void 0;var C=function(L){return function(k){return function(){for(var G=[],Z=0;Z<arguments.length;Z++)G[Z]=arguments[Z];return G.forEach(function(F){return L.bind(F).toService(k)})}}};$.multiBindToService=C},85265:function(le,$,C){"use strict";Object.defineProperty($,"__esModule",{value:!0}),$.isStackOverflowExeption=void 0;var L=C(16674);function k(G){return G instanceof RangeError||G.message===L.STACK_OVERFLOW}$.isStackOverflowExeption=k},37791:function(le,$){"use strict";Object.defineProperty($,"__esModule",{value:!0}),$.id=void 0;var C=0;function L(){return C++}$.id=L},55800:function(le,$,C){"use strict";Object.defineProperty($,"__esModule",{value:!0}),$.circularDependencyToException=$.listMetadataForTarget=$.listRegisteredBindingsForServiceIdentifier=$.getServiceIdentifierAsString=$.getFunctionName=void 0;var L=C(16674);function k(fe){if(typeof fe=="function"){var Se=fe;return Se.name}else{if(typeof fe=="symbol")return fe.toString();var Se=fe;return Se}}$.getServiceIdentifierAsString=k;function G(fe,Se,Re){var De="",Ve=Re(fe,Se);return Ve.length!==0&&(De=`
Registered bindings:`,Ve.forEach(function(nt){var Ee="Object";nt.implementationType!==null&&(Ee=ee(nt.implementationType)),De=De+`
 `+Ee,nt.constraint.metaData&&(De=De+" - "+nt.constraint.metaData)})),De}$.listRegisteredBindingsForServiceIdentifier=G;function Z(fe,Se){return fe.parentRequest===null?!1:fe.parentRequest.serviceIdentifier===Se?!0:Z(fe.parentRequest,Se)}function F(fe){function Se(De,Ve){Ve===void 0&&(Ve=[]);var nt=k(De.serviceIdentifier);return Ve.push(nt),De.parentRequest!==null?Se(De.parentRequest,Ve):Ve}var Re=Se(fe);return Re.reverse().join(" --> ")}function z(fe){fe.childRequests.forEach(function(Se){if(Z(Se,Se.serviceIdentifier)){var Re=F(Se);throw new Error(L.CIRCULAR_DEPENDENCY+" "+Re)}else z(Se)})}$.circularDependencyToException=z;function q(fe,Se){if(Se.isTagged()||Se.isNamed()){var Re="",De=Se.getNamedTag(),Ve=Se.getCustomTags();return De!==null&&(Re+=De.toString()+`
`),Ve!==null&&Ve.forEach(function(nt){Re+=nt.toString()+`
`})," "+fe+`
 `+fe+" - "+Re}else return" "+fe}$.listMetadataForTarget=q;function ee(fe){if(fe.name)return fe.name;var Se=fe.toString(),Re=Se.match(/^function\s*([^\s(]+)/);return Re?Re[1]:"Anonymous function: "+Se}$.getFunctionName=ee},82584:function(le,$,C){"use strict";var L=C(96410)(),k=C(21924),G=k("Object.prototype.toString"),Z=function(ee){return L&&ee&&typeof ee=="object"&&Symbol.toStringTag in ee?!1:G(ee)==="[object Arguments]"},F=function(ee){return Z(ee)?!0:ee!==null&&typeof ee=="object"&&typeof ee.length=="number"&&ee.length>=0&&G(ee)!=="[object Array]"&&G(ee.callee)==="[object Function]"},z=function(){return Z(arguments)}();Z.isLegacyArguments=F,le.exports=z?Z:F},18923:function(le,$,C){"use strict";var L=Date.prototype.getDay,k=function(q){try{return L.call(q),!0}catch(ee){return!1}},G=Object.prototype.toString,Z="[object Date]",F=C(96410)();le.exports=function(q){return typeof q!="object"||q===null?!1:F?k(q):G.call(q)===Z}},98420:function(le,$,C){"use strict";var L=C(21924),k=C(96410)(),G,Z,F,z;if(k){G=L("Object.prototype.hasOwnProperty"),Z=L("RegExp.prototype.exec"),F={};var q=function(){throw F};z={toString:q,valueOf:q},typeof Symbol.toPrimitive=="symbol"&&(z[Symbol.toPrimitive]=q)}var ee=L("Object.prototype.toString"),fe=Object.getOwnPropertyDescriptor,Se="[object RegExp]";le.exports=k?function(De){if(!De||typeof De!="object")return!1;var Ve=fe(De,"lastIndex"),nt=Ve&&G(Ve,"value");if(!nt)return!1;try{Z(De,z)}catch(Ee){return Ee===F}}:function(De){return!De||typeof De!="object"&&typeof De!="function"?!1:ee(De)===Se}},18552:function(le,$,C){var L=C(10852),k=C(55639),G=L(k,"DataView");le.exports=G},1989:function(le,$,C){var L=C(51789),k=C(80401),G=C(57667),Z=C(21327),F=C(81866);function z(q){var ee=-1,fe=q==null?0:q.length;for(this.clear();++ee<fe;){var Se=q[ee];this.set(Se[0],Se[1])}}z.prototype.clear=L,z.prototype.delete=k,z.prototype.get=G,z.prototype.has=Z,z.prototype.set=F,le.exports=z},38407:function(le,$,C){var L=C(27040),k=C(14125),G=C(82117),Z=C(67518),F=C(44264);function z(q){var ee=-1,fe=q==null?0:q.length;for(this.clear();++ee<fe;){var Se=q[ee];this.set(Se[0],Se[1])}}z.prototype.clear=L,z.prototype.delete=k,z.prototype.get=G,z.prototype.has=Z,z.prototype.set=F,le.exports=z},57071:function(le,$,C){var L=C(10852),k=C(55639),G=L(k,"Map");le.exports=G},83369:function(le,$,C){var L=C(24785),k=C(11285),G=C(96e3),Z=C(49916),F=C(95265);function z(q){var ee=-1,fe=q==null?0:q.length;for(this.clear();++ee<fe;){var Se=q[ee];this.set(Se[0],Se[1])}}z.prototype.clear=L,z.prototype.delete=k,z.prototype.get=G,z.prototype.has=Z,z.prototype.set=F,le.exports=z},53818:function(le,$,C){var L=C(10852),k=C(55639),G=L(k,"Promise");le.exports=G},58525:function(le,$,C){var L=C(10852),k=C(55639),G=L(k,"Set");le.exports=G},88668:function(le,$,C){var L=C(83369),k=C(90619),G=C(72385);function Z(F){var z=-1,q=F==null?0:F.length;for(this.__data__=new L;++z<q;)this.add(F[z])}Z.prototype.add=Z.prototype.push=k,Z.prototype.has=G,le.exports=Z},46384:function(le,$,C){var L=C(38407),k=C(37465),G=C(63779),Z=C(67599),F=C(44758),z=C(34309);function q(ee){var fe=this.__data__=new L(ee);this.size=fe.size}q.prototype.clear=k,q.prototype.delete=G,q.prototype.get=Z,q.prototype.has=F,q.prototype.set=z,le.exports=q},62705:function(le,$,C){var L=C(55639),k=L.Symbol;le.exports=k},11149:function(le,$,C){var L=C(55639),k=L.Uint8Array;le.exports=k},70577:function(le,$,C){var L=C(10852),k=C(55639),G=L(k,"WeakMap");le.exports=G},96874:function(le){function $(C,L,k){switch(k.length){case 0:return C.call(L);case 1:return C.call(L,k[0]);case 2:return C.call(L,k[0],k[1]);case 3:return C.call(L,k[0],k[1],k[2])}return C.apply(L,k)}le.exports=$},77412:function(le){function $(C,L){for(var k=-1,G=C==null?0:C.length;++k<G&&L(C[k],k,C)!==!1;);return C}le.exports=$},34963:function(le){function $(C,L){for(var k=-1,G=C==null?0:C.length,Z=0,F=[];++k<G;){var z=C[k];L(z,k,C)&&(F[Z++]=z)}return F}le.exports=$},47443:function(le,$,C){var L=C(42118);function k(G,Z){var F=G==null?0:G.length;return!!F&&L(G,Z,0)>-1}le.exports=k},1196:function(le){function $(C,L,k){for(var G=-1,Z=C==null?0:C.length;++G<Z;)if(k(L,C[G]))return!0;return!1}le.exports=$},14636:function(le,$,C){var L=C(22545),k=C(35694),G=C(1469),Z=C(44144),F=C(65776),z=C(36719),q=Object.prototype,ee=q.hasOwnProperty;function fe(Se,Re){var De=G(Se),Ve=!De&&k(Se),nt=!De&&!Ve&&Z(Se),Ee=!De&&!Ve&&!nt&&z(Se),Ie=De||Ve||nt||Ee,me=Ie?L(Se.length,String):[],we=me.length;for(var ne in Se)(Re||ee.call(Se,ne))&&!(Ie&&(ne=="length"||nt&&(ne=="offset"||ne=="parent")||Ee&&(ne=="buffer"||ne=="byteLength"||ne=="byteOffset")||F(ne,we)))&&me.push(ne);return me}le.exports=fe},29932:function(le){function $(C,L){for(var k=-1,G=C==null?0:C.length,Z=Array(G);++k<G;)Z[k]=L(C[k],k,C);return Z}le.exports=$},62488:function(le){function $(C,L){for(var k=-1,G=L.length,Z=C.length;++k<G;)C[Z+k]=L[k];return C}le.exports=$},62663:function(le){function $(C,L,k,G){var Z=-1,F=C==null?0:C.length;for(G&&F&&(k=C[++Z]);++Z<F;)k=L(k,C[Z],Z,C);return k}le.exports=$},82908:function(le){function $(C,L){for(var k=-1,G=C==null?0:C.length;++k<G;)if(L(C[k],k,C))return!0;return!1}le.exports=$},44286:function(le){function $(C){return C.split("")}le.exports=$},49029:function(le){var $=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g;function C(L){return L.match($)||[]}le.exports=C},86556:function(le,$,C){var L=C(89465),k=C(77813);function G(Z,F,z){(z!==void 0&&!k(Z[F],z)||z===void 0&&!(F in Z))&&L(Z,F,z)}le.exports=G},34865:function(le,$,C){var L=C(89465),k=C(77813),G=Object.prototype,Z=G.hasOwnProperty;function F(z,q,ee){var fe=z[q];(!(Z.call(z,q)&&k(fe,ee))||ee===void 0&&!(q in z))&&L(z,q,ee)}le.exports=F},18470:function(le,$,C){var L=C(77813);function k(G,Z){for(var F=G.length;F--;)if(L(G[F][0],Z))return F;return-1}le.exports=k},44037:function(le,$,C){var L=C(98363),k=C(3674);function G(Z,F){return Z&&L(F,k(F),Z)}le.exports=G},63886:function(le,$,C){var L=C(98363),k=C(81704);function G(Z,F){return Z&&L(F,k(F),Z)}le.exports=G},89465:function(le,$,C){var L=C(38777);function k(G,Z,F){Z=="__proto__"&&L?L(G,Z,{configurable:!0,enumerable:!0,value:F,writable:!0}):G[Z]=F}le.exports=k},29750:function(le){function $(C,L,k){return C===C&&(k!==void 0&&(C=C<=k?C:k),L!==void 0&&(C=C>=L?C:L)),C}le.exports=$},85990:function(le,$,C){var L=C(46384),k=C(77412),G=C(34865),Z=C(44037),F=C(63886),z=C(64626),q=C(278),ee=C(18805),fe=C(1911),Se=C(58234),Re=C(46904),De=C(64160),Ve=C(43824),nt=C(29148),Ee=C(38517),Ie=C(1469),me=C(44144),we=C(56688),ne=C(13218),Pe=C(72928),he=C(3674),ve=C(81704),te=1,Y=2,Oe=4,pe="[object Arguments]",ye="[object Array]",_e="[object Boolean]",X="[object Date]",Le="[object Error]",de="[object Function]",be="[object GeneratorFunction]",se="[object Map]",Ne="[object Number]",ze="[object Object]",ue="[object RegExp]",kt="[object Set]",Rt="[object String]",cr="[object Symbol]",Ut="[object WeakMap]",$r="[object ArrayBuffer]",ln="[object DataView]",Cr="[object Float32Array]",Qr="[object Float64Array]",Jr="[object Int8Array]",xr="[object Int16Array]",Gn="[object Int32Array]",ti="[object Uint8Array]",Vn="[object Uint8ClampedArray]",Xr="[object Uint16Array]",sn="[object Uint32Array]",yn={};yn[pe]=yn[ye]=yn[$r]=yn[ln]=yn[_e]=yn[X]=yn[Cr]=yn[Qr]=yn[Jr]=yn[xr]=yn[Gn]=yn[se]=yn[Ne]=yn[ze]=yn[ue]=yn[kt]=yn[Rt]=yn[cr]=yn[ti]=yn[Vn]=yn[Xr]=yn[sn]=!0,yn[Le]=yn[de]=yn[Ut]=!1;function ki(ri,Lt,J,Ue,$e,At){var It,wt=Lt&te,mr=Lt&Y,vt=Lt&Oe;if(J&&(It=$e?J(ri,Ue,$e,At):J(ri)),It!==void 0)return It;if(!ne(ri))return ri;var Tt=Ie(ri);if(Tt){if(It=Ve(ri),!wt)return q(ri,It)}else{var Qt=De(ri),Er=Qt==de||Qt==be;if(me(ri))return z(ri,wt);if(Qt==ze||Qt==pe||Er&&!$e){if(It=mr||Er?{}:Ee(ri),!wt)return mr?fe(ri,F(It,ri)):ee(ri,Z(It,ri))}else{if(!yn[Qt])return $e?ri:{};It=nt(ri,Qt,wt)}}At||(At=new L);var Dr=At.get(ri);if(Dr)return Dr;At.set(ri,It),Pe(ri)?ri.forEach(function(Br){It.add(ki(Br,Lt,J,Br,ri,At))}):we(ri)&&ri.forEach(function(Br,en){It.set(en,ki(Br,Lt,J,en,ri,At))});var Yr=vt?mr?Re:Se:mr?ve:he,an=Tt?void 0:Yr(ri);return k(an||ri,function(Br,en){an&&(en=Br,Br=ri[en]),G(It,en,ki(Br,Lt,J,en,ri,At))}),It}le.exports=ki},3118:function(le,$,C){var L=C(13218),k=Object.create,G=function(){function Z(){}return function(F){if(!L(F))return{};if(k)return k(F);Z.prototype=F;var z=new Z;return Z.prototype=void 0,z}}();le.exports=G},41848:function(le){function $(C,L,k,G){for(var Z=C.length,F=k+(G?1:-1);G?F--:++F<Z;)if(L(C[F],F,C))return F;return-1}le.exports=$},28483:function(le,$,C){var L=C(25063),k=L();le.exports=k},97786:function(le,$,C){var L=C(71811),k=C(40327);function G(Z,F){F=L(F,Z);for(var z=0,q=F.length;Z!=null&&z<q;)Z=Z[k(F[z++])];return z&&z==q?Z:void 0}le.exports=G},68866:function(le,$,C){var L=C(62488),k=C(1469);function G(Z,F,z){var q=F(Z);return k(Z)?q:L(q,z(Z))}le.exports=G},44239:function(le,$,C){var L=C(62705),k=C(89607),G=C(2333),Z="[object Null]",F="[object Undefined]",z=L?L.toStringTag:void 0;function q(ee){return ee==null?ee===void 0?F:Z:z&&z in Object(ee)?k(ee):G(ee)}le.exports=q},42118:function(le,$,C){var L=C(41848),k=C(62722),G=C(42351);function Z(F,z,q){return z===z?G(F,z,q):L(F,k,q)}le.exports=Z},74221:function(le){function $(C,L,k,G){for(var Z=k-1,F=C.length;++Z<F;)if(G(C[Z],L))return Z;return-1}le.exports=$},9454:function(le,$,C){var L=C(44239),k=C(37005),G="[object Arguments]";function Z(F){return k(F)&&L(F)==G}le.exports=Z},90939:function(le,$,C){var L=C(21299),k=C(37005);function G(Z,F,z,q,ee){return Z===F?!0:Z==null||F==null||!k(Z)&&!k(F)?Z!==Z&&F!==F:L(Z,F,z,q,G,ee)}le.exports=G},21299:function(le,$,C){var L=C(46384),k=C(67114),G=C(18351),Z=C(16096),F=C(64160),z=C(1469),q=C(44144),ee=C(36719),fe=1,Se="[object Arguments]",Re="[object Array]",De="[object Object]",Ve=Object.prototype,nt=Ve.hasOwnProperty;function Ee(Ie,me,we,ne,Pe,he){var ve=z(Ie),te=z(me),Y=ve?Re:F(Ie),Oe=te?Re:F(me);Y=Y==Se?De:Y,Oe=Oe==Se?De:Oe;var pe=Y==De,ye=Oe==De,_e=Y==Oe;if(_e&&q(Ie)){if(!q(me))return!1;ve=!0,pe=!1}if(_e&&!pe)return he||(he=new L),ve||ee(Ie)?k(Ie,me,we,ne,Pe,he):G(Ie,me,Y,we,ne,Pe,he);if(!(we&fe)){var X=pe&&nt.call(Ie,"__wrapped__"),Le=ye&&nt.call(me,"__wrapped__");if(X||Le){var de=X?Ie.value():Ie,be=Le?me.value():me;return he||(he=new L),Pe(de,be,we,ne,he)}}return _e?(he||(he=new L),Z(Ie,me,we,ne,Pe,he)):!1}le.exports=Ee},25588:function(le,$,C){var L=C(64160),k=C(37005),G="[object Map]";function Z(F){return k(F)&&L(F)==G}le.exports=Z},62722:function(le){function $(C){return C!==C}le.exports=$},28458:function(le,$,C){var L=C(23560),k=C(15346),G=C(13218),Z=C(80346),F=/[\\^$.*+?()[\]{}|]/g,z=/^\[object .+?Constructor\]$/,q=Function.prototype,ee=Object.prototype,fe=q.toString,Se=ee.hasOwnProperty,Re=RegExp("^"+fe.call(Se).replace(F,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function De(Ve){if(!G(Ve)||k(Ve))return!1;var nt=L(Ve)?Re:z;return nt.test(Z(Ve))}le.exports=De},29221:function(le,$,C){var L=C(64160),k=C(37005),G="[object Set]";function Z(F){return k(F)&&L(F)==G}le.exports=Z},38749:function(le,$,C){var L=C(44239),k=C(41780),G=C(37005),Z="[object Arguments]",F="[object Array]",z="[object Boolean]",q="[object Date]",ee="[object Error]",fe="[object Function]",Se="[object Map]",Re="[object Number]",De="[object Object]",Ve="[object RegExp]",nt="[object Set]",Ee="[object String]",Ie="[object WeakMap]",me="[object ArrayBuffer]",we="[object DataView]",ne="[object Float32Array]",Pe="[object Float64Array]",he="[object Int8Array]",ve="[object Int16Array]",te="[object Int32Array]",Y="[object Uint8Array]",Oe="[object Uint8ClampedArray]",pe="[object Uint16Array]",ye="[object Uint32Array]",_e={};_e[ne]=_e[Pe]=_e[he]=_e[ve]=_e[te]=_e[Y]=_e[Oe]=_e[pe]=_e[ye]=!0,_e[Z]=_e[F]=_e[me]=_e[z]=_e[we]=_e[q]=_e[ee]=_e[fe]=_e[Se]=_e[Re]=_e[De]=_e[Ve]=_e[nt]=_e[Ee]=_e[Ie]=!1;function X(Le){return G(Le)&&k(Le.length)&&!!_e[L(Le)]}le.exports=X},280:function(le,$,C){var L=C(25726),k=C(86916),G=Object.prototype,Z=G.hasOwnProperty;function F(z){if(!L(z))return k(z);var q=[];for(var ee in Object(z))Z.call(z,ee)&&ee!="constructor"&&q.push(ee);return q}le.exports=F},35014:function(le,$,C){var L=C(13218),k=C(25726),G=C(33498),Z=Object.prototype,F=Z.hasOwnProperty;function z(q){if(!L(q))return G(q);var ee=k(q),fe=[];for(var Se in q)Se=="constructor"&&(ee||!F.call(q,Se))||fe.push(Se);return fe}le.exports=z},42980:function(le,$,C){var L=C(46384),k=C(86556),G=C(28483),Z=C(59783),F=C(13218),z=C(81704),q=C(36390);function ee(fe,Se,Re,De,Ve){fe!==Se&&G(Se,function(nt,Ee){if(Ve||(Ve=new L),F(nt))Z(fe,Se,Ee,Re,ee,De,Ve);else{var Ie=De?De(q(fe,Ee),nt,Ee+"",fe,Se,Ve):void 0;Ie===void 0&&(Ie=nt),k(fe,Ee,Ie)}},z)}le.exports=ee},59783:function(le,$,C){var L=C(86556),k=C(64626),G=C(77133),Z=C(278),F=C(38517),z=C(35694),q=C(1469),ee=C(29246),fe=C(44144),Se=C(23560),Re=C(13218),De=C(68630),Ve=C(36719),nt=C(36390),Ee=C(59881);function Ie(me,we,ne,Pe,he,ve,te){var Y=nt(me,ne),Oe=nt(we,ne),pe=te.get(Oe);if(pe){L(me,ne,pe);return}var ye=ve?ve(Y,Oe,ne+"",me,we,te):void 0,_e=ye===void 0;if(_e){var X=q(Oe),Le=!X&&fe(Oe),de=!X&&!Le&&Ve(Oe);ye=Oe,X||Le||de?q(Y)?ye=Y:ee(Y)?ye=Z(Y):Le?(_e=!1,ye=k(Oe,!0)):de?(_e=!1,ye=G(Oe,!0)):ye=[]:De(Oe)||z(Oe)?(ye=Y,z(Y)?ye=Ee(Y):(!Re(Y)||Se(Y))&&(ye=F(Oe))):_e=!1}_e&&(te.set(Oe,ye),he(ye,Oe,Pe,ve,te),te.delete(Oe)),L(me,ne,ye)}le.exports=Ie},18674:function(le){function $(C){return function(L){return C==null?void 0:C[L]}}le.exports=$},65464:function(le,$,C){var L=C(29932),k=C(42118),G=C(74221),Z=C(7518),F=C(278),z=Array.prototype,q=z.splice;function ee(fe,Se,Re,De){var Ve=De?G:k,nt=-1,Ee=Se.length,Ie=fe;for(fe===Se&&(Se=F(Se)),Re&&(Ie=L(fe,Z(Re)));++nt<Ee;)for(var me=0,we=Se[nt],ne=Re?Re(we):we;(me=Ve(Ie,ne,me,De))>-1;)Ie!==fe&&q.call(Ie,me,1),q.call(fe,me,1);return fe}le.exports=ee},5976:function(le,$,C){var L=C(6557),k=C(45357),G=C(30061);function Z(F,z){return G(k(F,z,L),F+"")}le.exports=Z},56560:function(le,$,C){var L=C(75703),k=C(38777),G=C(6557),Z=k?function(F,z){return k(F,"toString",{configurable:!0,enumerable:!1,value:L(z),writable:!0})}:G;le.exports=Z},14259:function(le){function $(C,L,k){var G=-1,Z=C.length;L<0&&(L=-L>Z?0:Z+L),k=k>Z?Z:k,k<0&&(k+=Z),Z=L>k?0:k-L>>>0,L>>>=0;for(var F=Array(Z);++G<Z;)F[G]=C[G+L];return F}le.exports=$},22545:function(le){function $(C,L){for(var k=-1,G=Array(C);++k<C;)G[k]=L(k);return G}le.exports=$},80531:function(le,$,C){var L=C(62705),k=C(29932),G=C(1469),Z=C(33448),F=1/0,z=L?L.prototype:void 0,q=z?z.toString:void 0;function ee(fe){if(typeof fe=="string")return fe;if(G(fe))return k(fe,ee)+"";if(Z(fe))return q?q.call(fe):"";var Se=fe+"";return Se=="0"&&1/fe==-F?"-0":Se}le.exports=ee},4107:function(le,$,C){var L=C(67990),k=/^\s+/;function G(Z){return Z&&Z.slice(0,L(Z)+1).replace(k,"")}le.exports=G},7518:function(le){function $(C){return function(L){return C(L)}}le.exports=$},45652:function(le,$,C){var L=C(88668),k=C(47443),G=C(1196),Z=C(74757),F=C(23593),z=C(21814),q=200;function ee(fe,Se,Re){var De=-1,Ve=k,nt=fe.length,Ee=!0,Ie=[],me=Ie;if(Re)Ee=!1,Ve=G;else if(nt>=q){var we=Se?null:F(fe);if(we)return z(we);Ee=!1,Ve=Z,me=new L}else me=Se?[]:Ie;e:for(;++De<nt;){var ne=fe[De],Pe=Se?Se(ne):ne;if(ne=Re||ne!==0?ne:0,Ee&&Pe===Pe){for(var he=me.length;he--;)if(me[he]===Pe)continue e;Se&&me.push(Pe),Ie.push(ne)}else Ve(me,Pe,Re)||(me!==Ie&&me.push(Pe),Ie.push(ne))}return Ie}le.exports=ee},74757:function(le){function $(C,L){return C.has(L)}le.exports=$},71811:function(le,$,C){var L=C(1469),k=C(15403),G=C(55514),Z=C(79833);function F(z,q){return L(z)?z:k(z,q)?[z]:G(Z(z))}le.exports=F},40180:function(le,$,C){var L=C(14259);function k(G,Z,F){var z=G.length;return F=F===void 0?z:F,!Z&&F>=z?G:L(G,Z,F)}le.exports=k},74318:function(le,$,C){var L=C(11149);function k(G){var Z=new G.constructor(G.byteLength);return new L(Z).set(new L(G)),Z}le.exports=k},64626:function(le,$,C){le=C.nmd(le);var L=C(55639),k=$&&!$.nodeType&&$,G=k&&!0&&le&&!le.nodeType&&le,Z=G&&G.exports===k,F=Z?L.Buffer:void 0,z=F?F.allocUnsafe:void 0;function q(ee,fe){if(fe)return ee.slice();var Se=ee.length,Re=z?z(Se):new ee.constructor(Se);return ee.copy(Re),Re}le.exports=q},57157:function(le,$,C){var L=C(74318);function k(G,Z){var F=Z?L(G.buffer):G.buffer;return new G.constructor(F,G.byteOffset,G.byteLength)}le.exports=k},93147:function(le){var $=/\w*$/;function C(L){var k=new L.constructor(L.source,$.exec(L));return k.lastIndex=L.lastIndex,k}le.exports=C},40419:function(le,$,C){var L=C(62705),k=L?L.prototype:void 0,G=k?k.valueOf:void 0;function Z(F){return G?Object(G.call(F)):{}}le.exports=Z},77133:function(le,$,C){var L=C(74318);function k(G,Z){var F=Z?L(G.buffer):G.buffer;return new G.constructor(F,G.byteOffset,G.length)}le.exports=k},278:function(le){function $(C,L){var k=-1,G=C.length;for(L||(L=Array(G));++k<G;)L[k]=C[k];return L}le.exports=$},98363:function(le,$,C){var L=C(34865),k=C(89465);function G(Z,F,z,q){var ee=!z;z||(z={});for(var fe=-1,Se=F.length;++fe<Se;){var Re=F[fe],De=q?q(z[Re],Z[Re],Re,z,Z):void 0;De===void 0&&(De=Z[Re]),ee?k(z,Re,De):L(z,Re,De)}return z}le.exports=G},18805:function(le,$,C){var L=C(98363),k=C(99551);function G(Z,F){return L(Z,k(Z),F)}le.exports=G},1911:function(le,$,C){var L=C(98363),k=C(51442);function G(Z,F){return L(Z,k(Z),F)}le.exports=G},14429:function(le,$,C){var L=C(55639),k=L["__core-js_shared__"];le.exports=k},21463:function(le,$,C){var L=C(5976),k=C(16612);function G(Z){return L(function(F,z){var q=-1,ee=z.length,fe=ee>1?z[ee-1]:void 0,Se=ee>2?z[2]:void 0;for(fe=Z.length>3&&typeof fe=="function"?(ee--,fe):void 0,Se&&k(z[0],z[1],Se)&&(fe=ee<3?void 0:fe,ee=1),F=Object(F);++q<ee;){var Re=z[q];Re&&Z(F,Re,q,fe)}return F})}le.exports=G},25063:function(le){function $(C){return function(L,k,G){for(var Z=-1,F=Object(L),z=G(L),q=z.length;q--;){var ee=z[C?q:++Z];if(k(F[ee],ee,F)===!1)break}return L}}le.exports=$},98805:function(le,$,C){var L=C(40180),k=C(62689),G=C(83140),Z=C(79833);function F(z){return function(q){q=Z(q);var ee=k(q)?G(q):void 0,fe=ee?ee[0]:q.charAt(0),Se=ee?L(ee,1).join(""):q.slice(1);return fe[z]()+Se}}le.exports=F},35393:function(le,$,C){var L=C(62663),k=C(53816),G=C(58748),Z="['\u2019]",F=RegExp(Z,"g");function z(q){return function(ee){return L(G(k(ee).replace(F,"")),q,"")}}le.exports=z},23593:function(le,$,C){var L=C(58525),k=C(50308),G=C(21814),Z=1/0,F=L&&1/G(new L([,-0]))[1]==Z?function(z){return new L(z)}:k;le.exports=F},69389:function(le,$,C){var L=C(18674),k={\u00C0:"A",\u00C1:"A",\u00C2:"A",\u00C3:"A",\u00C4:"A",\u00C5:"A",\u00E0:"a",\u00E1:"a",\u00E2:"a",\u00E3:"a",\u00E4:"a",\u00E5:"a",\u00C7:"C",\u00E7:"c",\u00D0:"D",\u00F0:"d",\u00C8:"E",\u00C9:"E",\u00CA:"E",\u00CB:"E",\u00E8:"e",\u00E9:"e",\u00EA:"e",\u00EB:"e",\u00CC:"I",\u00CD:"I",\u00CE:"I",\u00CF:"I",\u00EC:"i",\u00ED:"i",\u00EE:"i",\u00EF:"i",\u00D1:"N",\u00F1:"n",\u00D2:"O",\u00D3:"O",\u00D4:"O",\u00D5:"O",\u00D6:"O",\u00D8:"O",\u00F2:"o",\u00F3:"o",\u00F4:"o",\u00F5:"o",\u00F6:"o",\u00F8:"o",\u00D9:"U",\u00DA:"U",\u00DB:"U",\u00DC:"U",\u00F9:"u",\u00FA:"u",\u00FB:"u",\u00FC:"u",\u00DD:"Y",\u00FD:"y",\u00FF:"y",\u00C6:"Ae",\u00E6:"ae",\u00DE:"Th",\u00FE:"th",\u00DF:"ss",\u0100:"A",\u0102:"A",\u0104:"A",\u0101:"a",\u0103:"a",\u0105:"a",\u0106:"C",\u0108:"C",\u010A:"C",\u010C:"C",\u0107:"c",\u0109:"c",\u010B:"c",\u010D:"c",\u010E:"D",\u0110:"D",\u010F:"d",\u0111:"d",\u0112:"E",\u0114:"E",\u0116:"E",\u0118:"E",\u011A:"E",\u0113:"e",\u0115:"e",\u0117:"e",\u0119:"e",\u011B:"e",\u011C:"G",\u011E:"G",\u0120:"G",\u0122:"G",\u011D:"g",\u011F:"g",\u0121:"g",\u0123:"g",\u0124:"H",\u0126:"H",\u0125:"h",\u0127:"h",\u0128:"I",\u012A:"I",\u012C:"I",\u012E:"I",\u0130:"I",\u0129:"i",\u012B:"i",\u012D:"i",\u012F:"i",\u0131:"i",\u0134:"J",\u0135:"j",\u0136:"K",\u0137:"k",\u0138:"k",\u0139:"L",\u013B:"L",\u013D:"L",\u013F:"L",\u0141:"L",\u013A:"l",\u013C:"l",\u013E:"l",\u0140:"l",\u0142:"l",\u0143:"N",\u0145:"N",\u0147:"N",\u014A:"N",\u0144:"n",\u0146:"n",\u0148:"n",\u014B:"n",\u014C:"O",\u014E:"O",\u0150:"O",\u014D:"o",\u014F:"o",\u0151:"o",\u0154:"R",\u0156:"R",\u0158:"R",\u0155:"r",\u0157:"r",\u0159:"r",\u015A:"S",\u015C:"S",\u015E:"S",\u0160:"S",\u015B:"s",\u015D:"s",\u015F:"s",\u0161:"s",\u0162:"T",\u0164:"T",\u0166:"T",\u0163:"t",\u0165:"t",\u0167:"t",\u0168:"U",\u016A:"U",\u016C:"U",\u016E:"U",\u0170:"U",\u0172:"U",\u0169:"u",\u016B:"u",\u016D:"u",\u016F:"u",\u0171:"u",\u0173:"u",\u0174:"W",\u0175:"w",\u0176:"Y",\u0177:"y",\u0178:"Y",\u0179:"Z",\u017B:"Z",\u017D:"Z",\u017A:"z",\u017C:"z",\u017E:"z",\u0132:"IJ",\u0133:"ij",\u0152:"Oe",\u0153:"oe",\u0149:"'n",\u017F:"s"},G=L(k);le.exports=G},38777:function(le,$,C){var L=C(10852),k=function(){try{var G=L(Object,"defineProperty");return G({},"",{}),G}catch(Z){}}();le.exports=k},67114:function(le,$,C){var L=C(88668),k=C(82908),G=C(74757),Z=1,F=2;function z(q,ee,fe,Se,Re,De){var Ve=fe&Z,nt=q.length,Ee=ee.length;if(nt!=Ee&&!(Ve&&Ee>nt))return!1;var Ie=De.get(q),me=De.get(ee);if(Ie&&me)return Ie==ee&&me==q;var we=-1,ne=!0,Pe=fe&F?new L:void 0;for(De.set(q,ee),De.set(ee,q);++we<nt;){var he=q[we],ve=ee[we];if(Se)var te=Ve?Se(ve,he,we,ee,q,De):Se(he,ve,we,q,ee,De);if(te!==void 0){if(te)continue;ne=!1;break}if(Pe){if(!k(ee,function(Y,Oe){if(!G(Pe,Oe)&&(he===Y||Re(he,Y,fe,Se,De)))return Pe.push(Oe)})){ne=!1;break}}else if(!(he===ve||Re(he,ve,fe,Se,De))){ne=!1;break}}return De.delete(q),De.delete(ee),ne}le.exports=z},18351:function(le,$,C){var L=C(62705),k=C(11149),G=C(77813),Z=C(67114),F=C(68776),z=C(21814),q=1,ee=2,fe="[object Boolean]",Se="[object Date]",Re="[object Error]",De="[object Map]",Ve="[object Number]",nt="[object RegExp]",Ee="[object Set]",Ie="[object String]",me="[object Symbol]",we="[object ArrayBuffer]",ne="[object DataView]",Pe=L?L.prototype:void 0,he=Pe?Pe.valueOf:void 0;function ve(te,Y,Oe,pe,ye,_e,X){switch(Oe){case ne:if(te.byteLength!=Y.byteLength||te.byteOffset!=Y.byteOffset)return!1;te=te.buffer,Y=Y.buffer;case we:return!(te.byteLength!=Y.byteLength||!_e(new k(te),new k(Y)));case fe:case Se:case Ve:return G(+te,+Y);case Re:return te.name==Y.name&&te.message==Y.message;case nt:case Ie:return te==Y+"";case De:var Le=F;case Ee:var de=pe&q;if(Le||(Le=z),te.size!=Y.size&&!de)return!1;var be=X.get(te);if(be)return be==Y;pe|=ee,X.set(te,Y);var se=Z(Le(te),Le(Y),pe,ye,_e,X);return X.delete(te),se;case me:if(he)return he.call(te)==he.call(Y)}return!1}le.exports=ve},16096:function(le,$,C){var L=C(58234),k=1,G=Object.prototype,Z=G.hasOwnProperty;function F(z,q,ee,fe,Se,Re){var De=ee&k,Ve=L(z),nt=Ve.length,Ee=L(q),Ie=Ee.length;if(nt!=Ie&&!De)return!1;for(var me=nt;me--;){var we=Ve[me];if(!(De?we in q:Z.call(q,we)))return!1}var ne=Re.get(z),Pe=Re.get(q);if(ne&&Pe)return ne==q&&Pe==z;var he=!0;Re.set(z,q),Re.set(q,z);for(var ve=De;++me<nt;){we=Ve[me];var te=z[we],Y=q[we];if(fe)var Oe=De?fe(Y,te,we,q,z,Re):fe(te,Y,we,z,q,Re);if(!(Oe===void 0?te===Y||Se(te,Y,ee,fe,Re):Oe)){he=!1;break}ve||(ve=we=="constructor")}if(he&&!ve){var pe=z.constructor,ye=q.constructor;pe!=ye&&"constructor"in z&&"constructor"in q&&!(typeof pe=="function"&&pe instanceof pe&&typeof ye=="function"&&ye instanceof ye)&&(he=!1)}return Re.delete(z),Re.delete(q),he}le.exports=F},31957:function(le,$,C){var L=typeof C.g=="object"&&C.g&&C.g.Object===Object&&C.g;le.exports=L},58234:function(le,$,C){var L=C(68866),k=C(99551),G=C(3674);function Z(F){return L(F,G,k)}le.exports=Z},46904:function(le,$,C){var L=C(68866),k=C(51442),G=C(81704);function Z(F){return L(F,G,k)}le.exports=Z},45050:function(le,$,C){var L=C(37019);function k(G,Z){var F=G.__data__;return L(Z)?F[typeof Z=="string"?"string":"hash"]:F.map}le.exports=k},10852:function(le,$,C){var L=C(28458),k=C(47801);function G(Z,F){var z=k(Z,F);return L(z)?z:void 0}le.exports=G},85924:function(le,$,C){var L=C(5569),k=L(Object.getPrototypeOf,Object);le.exports=k},89607:function(le,$,C){var L=C(62705),k=Object.prototype,G=k.hasOwnProperty,Z=k.toString,F=L?L.toStringTag:void 0;function z(q){var ee=G.call(q,F),fe=q[F];try{q[F]=void 0;var Se=!0}catch(De){}var Re=Z.call(q);return Se&&(ee?q[F]=fe:delete q[F]),Re}le.exports=z},99551:function(le,$,C){var L=C(34963),k=C(70479),G=Object.prototype,Z=G.propertyIsEnumerable,F=Object.getOwnPropertySymbols,z=F?function(q){return q==null?[]:(q=Object(q),L(F(q),function(ee){return Z.call(q,ee)}))}:k;le.exports=z},51442:function(le,$,C){var L=C(62488),k=C(85924),G=C(99551),Z=C(70479),F=Object.getOwnPropertySymbols,z=F?function(q){for(var ee=[];q;)L(ee,G(q)),q=k(q);return ee}:Z;le.exports=z},64160:function(le,$,C){var L=C(18552),k=C(57071),G=C(53818),Z=C(58525),F=C(70577),z=C(44239),q=C(80346),ee="[object Map]",fe="[object Object]",Se="[object Promise]",Re="[object Set]",De="[object WeakMap]",Ve="[object DataView]",nt=q(L),Ee=q(k),Ie=q(G),me=q(Z),we=q(F),ne=z;(L&&ne(new L(new ArrayBuffer(1)))!=Ve||k&&ne(new k)!=ee||G&&ne(G.resolve())!=Se||Z&&ne(new Z)!=Re||F&&ne(new F)!=De)&&(ne=function(Pe){var he=z(Pe),ve=he==fe?Pe.constructor:void 0,te=ve?q(ve):"";if(te)switch(te){case nt:return Ve;case Ee:return ee;case Ie:return Se;case me:return Re;case we:return De}return he}),le.exports=ne},47801:function(le){function $(C,L){return C==null?void 0:C[L]}le.exports=$},62689:function(le){var $="\\ud800-\\udfff",C="\\u0300-\\u036f",L="\\ufe20-\\ufe2f",k="\\u20d0-\\u20ff",G=C+L+k,Z="\\ufe0e\\ufe0f",F="\\u200d",z=RegExp("["+F+$+G+Z+"]");function q(ee){return z.test(ee)}le.exports=q},93157:function(le){var $=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/;function C(L){return $.test(L)}le.exports=C},51789:function(le,$,C){var L=C(94536);function k(){this.__data__=L?L(null):{},this.size=0}le.exports=k},80401:function(le){function $(C){var L=this.has(C)&&delete this.__data__[C];return this.size-=L?1:0,L}le.exports=$},57667:function(le,$,C){var L=C(94536),k="__lodash_hash_undefined__",G=Object.prototype,Z=G.hasOwnProperty;function F(z){var q=this.__data__;if(L){var ee=q[z];return ee===k?void 0:ee}return Z.call(q,z)?q[z]:void 0}le.exports=F},21327:function(le,$,C){var L=C(94536),k=Object.prototype,G=k.hasOwnProperty;function Z(F){var z=this.__data__;return L?z[F]!==void 0:G.call(z,F)}le.exports=Z},81866:function(le,$,C){var L=C(94536),k="__lodash_hash_undefined__";function G(Z,F){var z=this.__data__;return this.size+=this.has(Z)?0:1,z[Z]=L&&F===void 0?k:F,this}le.exports=G},43824:function(le){var $=Object.prototype,C=$.hasOwnProperty;function L(k){var G=k.length,Z=new k.constructor(G);return G&&typeof k[0]=="string"&&C.call(k,"index")&&(Z.index=k.index,Z.input=k.input),Z}le.exports=L},29148:function(le,$,C){var L=C(74318),k=C(57157),G=C(93147),Z=C(40419),F=C(77133),z="[object Boolean]",q="[object Date]",ee="[object Map]",fe="[object Number]",Se="[object RegExp]",Re="[object Set]",De="[object String]",Ve="[object Symbol]",nt="[object ArrayBuffer]",Ee="[object DataView]",Ie="[object Float32Array]",me="[object Float64Array]",we="[object Int8Array]",ne="[object Int16Array]",Pe="[object Int32Array]",he="[object Uint8Array]",ve="[object Uint8ClampedArray]",te="[object Uint16Array]",Y="[object Uint32Array]";function Oe(pe,ye,_e){var X=pe.constructor;switch(ye){case nt:return L(pe);case z:case q:return new X(+pe);case Ee:return k(pe,_e);case Ie:case me:case we:case ne:case Pe:case he:case ve:case te:case Y:return F(pe,_e);case ee:return new X;case fe:case De:return new X(pe);case Se:return G(pe);case Re:return new X;case Ve:return Z(pe)}}le.exports=Oe},38517:function(le,$,C){var L=C(3118),k=C(85924),G=C(25726);function Z(F){return typeof F.constructor=="function"&&!G(F)?L(k(F)):{}}le.exports=Z},65776:function(le){var $=9007199254740991,C=/^(?:0|[1-9]\d*)$/;function L(k,G){var Z=typeof k;return G=G==null?$:G,!!G&&(Z=="number"||Z!="symbol"&&C.test(k))&&k>-1&&k%1==0&&k<G}le.exports=L},16612:function(le,$,C){var L=C(77813),k=C(98612),G=C(65776),Z=C(13218);function F(z,q,ee){if(!Z(ee))return!1;var fe=typeof q;return(fe=="number"?k(ee)&&G(q,ee.length):fe=="string"&&q in ee)?L(ee[q],z):!1}le.exports=F},15403:function(le,$,C){var L=C(1469),k=C(33448),G=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Z=/^\w*$/;function F(z,q){if(L(z))return!1;var ee=typeof z;return ee=="number"||ee=="symbol"||ee=="boolean"||z==null||k(z)?!0:Z.test(z)||!G.test(z)||q!=null&&z in Object(q)}le.exports=F},37019:function(le){function $(C){var L=typeof C;return L=="string"||L=="number"||L=="symbol"||L=="boolean"?C!=="__proto__":C===null}le.exports=$},15346:function(le,$,C){var L=C(14429),k=function(){var Z=/[^.]+$/.exec(L&&L.keys&&L.keys.IE_PROTO||"");return Z?"Symbol(src)_1."+Z:""}();function G(Z){return!!k&&k in Z}le.exports=G},25726:function(le){var $=Object.prototype;function C(L){var k=L&&L.constructor,G=typeof k=="function"&&k.prototype||$;return L===G}le.exports=C},27040:function(le){function $(){this.__data__=[],this.size=0}le.exports=$},14125:function(le,$,C){var L=C(18470),k=Array.prototype,G=k.splice;function Z(F){var z=this.__data__,q=L(z,F);if(q<0)return!1;var ee=z.length-1;return q==ee?z.pop():G.call(z,q,1),--this.size,!0}le.exports=Z},82117:function(le,$,C){var L=C(18470);function k(G){var Z=this.__data__,F=L(Z,G);return F<0?void 0:Z[F][1]}le.exports=k},67518:function(le,$,C){var L=C(18470);function k(G){return L(this.__data__,G)>-1}le.exports=k},44264:function(le,$,C){var L=C(18470);function k(G,Z){var F=this.__data__,z=L(F,G);return z<0?(++this.size,F.push([G,Z])):F[z][1]=Z,this}le.exports=k},24785:function(le,$,C){var L=C(1989),k=C(38407),G=C(57071);function Z(){this.size=0,this.__data__={hash:new L,map:new(G||k),string:new L}}le.exports=Z},11285:function(le,$,C){var L=C(45050);function k(G){var Z=L(this,G).delete(G);return this.size-=Z?1:0,Z}le.exports=k},96e3:function(le,$,C){var L=C(45050);function k(G){return L(this,G).get(G)}le.exports=k},49916:function(le,$,C){var L=C(45050);function k(G){return L(this,G).has(G)}le.exports=k},95265:function(le,$,C){var L=C(45050);function k(G,Z){var F=L(this,G),z=F.size;return F.set(G,Z),this.size+=F.size==z?0:1,this}le.exports=k},68776:function(le){function $(C){var L=-1,k=Array(C.size);return C.forEach(function(G,Z){k[++L]=[Z,G]}),k}le.exports=$},24523:function(le,$,C){var L=C(88306),k=500;function G(Z){var F=L(Z,function(q){return z.size===k&&z.clear(),q}),z=F.cache;return F}le.exports=G},94536:function(le,$,C){var L=C(10852),k=L(Object,"create");le.exports=k},86916:function(le,$,C){var L=C(5569),k=L(Object.keys,Object);le.exports=k},33498:function(le){function $(C){var L=[];if(C!=null)for(var k in Object(C))L.push(k);return L}le.exports=$},31167:function(le,$,C){le=C.nmd(le);var L=C(31957),k=$&&!$.nodeType&&$,G=k&&!0&&le&&!le.nodeType&&le,Z=G&&G.exports===k,F=Z&&L.process,z=function(){try{var q=G&&G.require&&G.require("util").types;return q||F&&F.binding&&F.binding("util")}catch(ee){}}();le.exports=z},2333:function(le){var $=Object.prototype,C=$.toString;function L(k){return C.call(k)}le.exports=L},5569:function(le){function $(C,L){return function(k){return C(L(k))}}le.exports=$},45357:function(le,$,C){var L=C(96874),k=Math.max;function G(Z,F,z){return F=k(F===void 0?Z.length-1:F,0),function(){for(var q=arguments,ee=-1,fe=k(q.length-F,0),Se=Array(fe);++ee<fe;)Se[ee]=q[F+ee];ee=-1;for(var Re=Array(F+1);++ee<F;)Re[ee]=q[ee];return Re[F]=z(Se),L(Z,this,Re)}}le.exports=G},55639:function(le,$,C){var L=C(31957),k=typeof self=="object"&&self&&self.Object===Object&&self,G=L||k||Function("return this")();le.exports=G},36390:function(le){function $(C,L){if(!(L==="constructor"&&typeof C[L]=="function")&&L!="__proto__")return C[L]}le.exports=$},90619:function(le){var $="__lodash_hash_undefined__";function C(L){return this.__data__.set(L,$),this}le.exports=C},72385:function(le){function $(C){return this.__data__.has(C)}le.exports=$},21814:function(le){function $(C){var L=-1,k=Array(C.size);return C.forEach(function(G){k[++L]=G}),k}le.exports=$},30061:function(le,$,C){var L=C(56560),k=C(21275),G=k(L);le.exports=G},21275:function(le){var $=800,C=16,L=Date.now;function k(G){var Z=0,F=0;return function(){var z=L(),q=C-(z-F);if(F=z,q>0){if(++Z>=$)return arguments[0]}else Z=0;return G.apply(void 0,arguments)}}le.exports=k},37465:function(le,$,C){var L=C(38407);function k(){this.__data__=new L,this.size=0}le.exports=k},63779:function(le){function $(C){var L=this.__data__,k=L.delete(C);return this.size=L.size,k}le.exports=$},67599:function(le){function $(C){return this.__data__.get(C)}le.exports=$},44758:function(le){function $(C){return this.__data__.has(C)}le.exports=$},34309:function(le,$,C){var L=C(38407),k=C(57071),G=C(83369),Z=200;function F(z,q){var ee=this.__data__;if(ee instanceof L){var fe=ee.__data__;if(!k||fe.length<Z-1)return fe.push([z,q]),this.size=++ee.size,this;ee=this.__data__=new G(fe)}return ee.set(z,q),this.size=ee.size,this}le.exports=F},42351:function(le){function $(C,L,k){for(var G=k-1,Z=C.length;++G<Z;)if(C[G]===L)return G;return-1}le.exports=$},83140:function(le,$,C){var L=C(44286),k=C(62689),G=C(676);function Z(F){return k(F)?G(F):L(F)}le.exports=Z},55514:function(le,$,C){var L=C(24523),k=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,G=/\\(\\)?/g,Z=L(function(F){var z=[];return F.charCodeAt(0)===46&&z.push(""),F.replace(k,function(q,ee,fe,Se){z.push(fe?Se.replace(G,"$1"):ee||q)}),z});le.exports=Z},40327:function(le,$,C){var L=C(33448),k=1/0;function G(Z){if(typeof Z=="string"||L(Z))return Z;var F=Z+"";return F=="0"&&1/Z==-k?"-0":F}le.exports=G},80346:function(le){var $=Function.prototype,C=$.toString;function L(k){if(k!=null){try{return C.call(k)}catch(G){}try{return k+""}catch(G){}}return""}le.exports=L},67990:function(le){var $=/\s/;function C(L){for(var k=L.length;k--&&$.test(L.charAt(k)););return k}le.exports=C},676:function(le){var $="\\ud800-\\udfff",C="\\u0300-\\u036f",L="\\ufe20-\\ufe2f",k="\\u20d0-\\u20ff",G=C+L+k,Z="\\ufe0e\\ufe0f",F="["+$+"]",z="["+G+"]",q="\\ud83c[\\udffb-\\udfff]",ee="(?:"+z+"|"+q+")",fe="[^"+$+"]",Se="(?:\\ud83c[\\udde6-\\uddff]){2}",Re="[\\ud800-\\udbff][\\udc00-\\udfff]",De="\\u200d",Ve=ee+"?",nt="["+Z+"]?",Ee="(?:"+De+"(?:"+[fe,Se,Re].join("|")+")"+nt+Ve+")*",Ie=nt+Ve+Ee,me="(?:"+[fe+z+"?",z,Se,Re,F].join("|")+")",we=RegExp(q+"(?="+q+")|"+me+Ie,"g");function ne(Pe){return Pe.match(we)||[]}le.exports=ne},2757:function(le){var $="\\ud800-\\udfff",C="\\u0300-\\u036f",L="\\ufe20-\\ufe2f",k="\\u20d0-\\u20ff",G=C+L+k,Z="\\u2700-\\u27bf",F="a-z\\xdf-\\xf6\\xf8-\\xff",z="\\xac\\xb1\\xd7\\xf7",q="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",ee="\\u2000-\\u206f",fe=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",Se="A-Z\\xc0-\\xd6\\xd8-\\xde",Re="\\ufe0e\\ufe0f",De=z+q+ee+fe,Ve="['\u2019]",nt="["+De+"]",Ee="["+G+"]",Ie="\\d+",me="["+Z+"]",we="["+F+"]",ne="[^"+$+De+Ie+Z+F+Se+"]",Pe="\\ud83c[\\udffb-\\udfff]",he="(?:"+Ee+"|"+Pe+")",ve="[^"+$+"]",te="(?:\\ud83c[\\udde6-\\uddff]){2}",Y="[\\ud800-\\udbff][\\udc00-\\udfff]",Oe="["+Se+"]",pe="\\u200d",ye="(?:"+we+"|"+ne+")",_e="(?:"+Oe+"|"+ne+")",X="(?:"+Ve+"(?:d|ll|m|re|s|t|ve))?",Le="(?:"+Ve+"(?:D|LL|M|RE|S|T|VE))?",de=he+"?",be="["+Re+"]?",se="(?:"+pe+"(?:"+[ve,te,Y].join("|")+")"+be+de+")*",Ne="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",ze="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",ue=be+de+se,kt="(?:"+[me,te,Y].join("|")+")"+ue,Rt=RegExp([Oe+"?"+we+"+"+X+"(?="+[nt,Oe,"$"].join("|")+")",_e+"+"+Le+"(?="+[nt,Oe+ye,"$"].join("|")+")",Oe+"?"+ye+"+"+X,Oe+"+"+Le,ze,Ne,Ie,kt].join("|"),"g");function cr(Ut){return Ut.match(Rt)||[]}le.exports=cr},68929:function(le,$,C){var L=C(48403),k=C(35393),G=k(function(Z,F,z){return F=F.toLowerCase(),Z+(z?L(F):F)});le.exports=G},48403:function(le,$,C){var L=C(79833),k=C(11700);function G(Z){return k(L(Z).toLowerCase())}le.exports=G},74691:function(le,$,C){var L=C(29750),k=C(14841);function G(Z,F,z){return z===void 0&&(z=F,F=void 0),z!==void 0&&(z=k(z),z=z===z?z:0),F!==void 0&&(F=k(F),F=F===F?F:0),L(k(Z),F,z)}le.exports=G},50361:function(le,$,C){var L=C(85990),k=1,G=4;function Z(F){return L(F,k|G)}le.exports=Z},75703:function(le){function $(C){return function(){return C}}le.exports=$},23279:function(le,$,C){var L=C(13218),k=C(7771),G=C(14841),Z="Expected a function",F=Math.max,z=Math.min;function q(ee,fe,Se){var Re,De,Ve,nt,Ee,Ie,me=0,we=!1,ne=!1,Pe=!0;if(typeof ee!="function")throw new TypeError(Z);fe=G(fe)||0,L(Se)&&(we=!!Se.leading,ne="maxWait"in Se,Ve=ne?F(G(Se.maxWait)||0,fe):Ve,Pe="trailing"in Se?!!Se.trailing:Pe);function he(Le){var de=Re,be=De;return Re=De=void 0,me=Le,nt=ee.apply(be,de),nt}function ve(Le){return me=Le,Ee=setTimeout(Oe,fe),we?he(Le):nt}function te(Le){var de=Le-Ie,be=Le-me,se=fe-de;return ne?z(se,Ve-be):se}function Y(Le){var de=Le-Ie,be=Le-me;return Ie===void 0||de>=fe||de<0||ne&&be>=Ve}function Oe(){var Le=k();if(Y(Le))return pe(Le);Ee=setTimeout(Oe,te(Le))}function pe(Le){return Ee=void 0,Pe&&Re?he(Le):(Re=De=void 0,nt)}function ye(){Ee!==void 0&&clearTimeout(Ee),me=0,Re=Ie=De=Ee=void 0}function _e(){return Ee===void 0?nt:pe(k())}function X(){var Le=k(),de=Y(Le);if(Re=arguments,De=this,Ie=Le,de){if(Ee===void 0)return ve(Ie);if(ne)return clearTimeout(Ee),Ee=setTimeout(Oe,fe),he(Ie)}return Ee===void 0&&(Ee=setTimeout(Oe,fe)),nt}return X.cancel=ye,X.flush=_e,X}le.exports=q},53816:function(le,$,C){var L=C(69389),k=C(79833),G=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,Z="\\u0300-\\u036f",F="\\ufe20-\\ufe2f",z="\\u20d0-\\u20ff",q=Z+F+z,ee="["+q+"]",fe=RegExp(ee,"g");function Se(Re){return Re=k(Re),Re&&Re.replace(G,L).replace(fe,"")}le.exports=Se},77813:function(le){function $(C,L){return C===L||C!==C&&L!==L}le.exports=$},27361:function(le,$,C){var L=C(97786);function k(G,Z,F){var z=G==null?void 0:L(G,Z);return z===void 0?F:z}le.exports=k},6557:function(le){function $(C){return C}le.exports=$},35694:function(le,$,C){var L=C(9454),k=C(37005),G=Object.prototype,Z=G.hasOwnProperty,F=G.propertyIsEnumerable,z=L(function(){return arguments}())?L:function(q){return k(q)&&Z.call(q,"callee")&&!F.call(q,"callee")};le.exports=z},1469:function(le){var $=Array.isArray;le.exports=$},98612:function(le,$,C){var L=C(23560),k=C(41780);function G(Z){return Z!=null&&k(Z.length)&&!L(Z)}le.exports=G},29246:function(le,$,C){var L=C(98612),k=C(37005);function G(Z){return k(Z)&&L(Z)}le.exports=G},51584:function(le,$,C){var L=C(44239),k=C(37005),G="[object Boolean]";function Z(F){return F===!0||F===!1||k(F)&&L(F)==G}le.exports=Z},44144:function(le,$,C){le=C.nmd(le);var L=C(55639),k=C(95062),G=$&&!$.nodeType&&$,Z=G&&!0&&le&&!le.nodeType&&le,F=Z&&Z.exports===G,z=F?L.Buffer:void 0,q=z?z.isBuffer:void 0,ee=q||k;le.exports=ee},18446:function(le,$,C){var L=C(90939);function k(G,Z){return L(G,Z)}le.exports=k},23560:function(le,$,C){var L=C(44239),k=C(13218),G="[object AsyncFunction]",Z="[object Function]",F="[object GeneratorFunction]",z="[object Proxy]";function q(ee){if(!k(ee))return!1;var fe=L(ee);return fe==Z||fe==F||fe==G||fe==z}le.exports=q},41780:function(le){var $=9007199254740991;function C(L){return typeof L=="number"&&L>-1&&L%1==0&&L<=$}le.exports=C},56688:function(le,$,C){var L=C(25588),k=C(7518),G=C(31167),Z=G&&G.isMap,F=Z?k(Z):L;le.exports=F},14293:function(le){function $(C){return C==null}le.exports=$},81763:function(le,$,C){var L=C(44239),k=C(37005),G="[object Number]";function Z(F){return typeof F=="number"||k(F)&&L(F)==G}le.exports=Z},13218:function(le){function $(C){var L=typeof C;return C!=null&&(L=="object"||L=="function")}le.exports=$},37005:function(le){function $(C){return C!=null&&typeof C=="object"}le.exports=$},68630:function(le,$,C){var L=C(44239),k=C(85924),G=C(37005),Z="[object Object]",F=Function.prototype,z=Object.prototype,q=F.toString,ee=z.hasOwnProperty,fe=q.call(Object);function Se(Re){if(!G(Re)||L(Re)!=Z)return!1;var De=k(Re);if(De===null)return!0;var Ve=ee.call(De,"constructor")&&De.constructor;return typeof Ve=="function"&&Ve instanceof Ve&&q.call(Ve)==fe}le.exports=Se},72928:function(le,$,C){var L=C(29221),k=C(7518),G=C(31167),Z=G&&G.isSet,F=Z?k(Z):L;le.exports=F},47037:function(le,$,C){var L=C(44239),k=C(1469),G=C(37005),Z="[object String]";function F(z){return typeof z=="string"||!k(z)&&G(z)&&L(z)==Z}le.exports=F},33448:function(le,$,C){var L=C(44239),k=C(37005),G="[object Symbol]";function Z(F){return typeof F=="symbol"||k(F)&&L(F)==G}le.exports=Z},36719:function(le,$,C){var L=C(38749),k=C(7518),G=C(31167),Z=G&&G.isTypedArray,F=Z?k(Z):L;le.exports=F},52353:function(le){function $(C){return C===void 0}le.exports=$},3674:function(le,$,C){var L=C(14636),k=C(280),G=C(98612);function Z(F){return G(F)?L(F):k(F)}le.exports=Z},81704:function(le,$,C){var L=C(14636),k=C(35014),G=C(98612);function Z(F){return G(F)?L(F,!0):k(F)}le.exports=Z},88306:function(le,$,C){var L=C(83369),k="Expected a function";function G(Z,F){if(typeof Z!="function"||F!=null&&typeof F!="function")throw new TypeError(k);var z=function(){var q=arguments,ee=F?F.apply(this,q):q[0],fe=z.cache;if(fe.has(ee))return fe.get(ee);var Se=Z.apply(this,q);return z.cache=fe.set(ee,Se)||fe,Se};return z.cache=new(G.Cache||L),z}G.Cache=L,le.exports=G},82492:function(le,$,C){var L=C(42980),k=C(21463),G=k(function(Z,F,z){L(Z,F,z)});le.exports=G},30236:function(le,$,C){var L=C(42980),k=C(21463),G=k(function(Z,F,z,q){L(Z,F,z,q)});le.exports=G},50308:function(le){function $(){}le.exports=$},7771:function(le,$,C){var L=C(55639),k=function(){return L.Date.now()};le.exports=k},97019:function(le,$,C){var L=C(5976),k=C(45604),G=L(k);le.exports=G},45604:function(le,$,C){var L=C(65464);function k(G,Z){return G&&G.length&&Z&&Z.length?L(G,Z):G}le.exports=k},70479:function(le){function $(){return[]}le.exports=$},95062:function(le){function $(){return!1}le.exports=$},23493:function(le,$,C){var L=C(23279),k=C(13218),G="Expected a function";function Z(F,z,q){var ee=!0,fe=!0;if(typeof F!="function")throw new TypeError(G);return k(q)&&(ee="leading"in q?!!q.leading:ee,fe="trailing"in q?!!q.trailing:fe),L(F,z,{leading:ee,maxWait:z,trailing:fe})}le.exports=Z},14841:function(le,$,C){var L=C(4107),k=C(13218),G=C(33448),Z=0/0,F=/^[-+]0x[0-9a-f]+$/i,z=/^0b[01]+$/i,q=/^0o[0-7]+$/i,ee=parseInt;function fe(Se){if(typeof Se=="number")return Se;if(G(Se))return Z;if(k(Se)){var Re=typeof Se.valueOf=="function"?Se.valueOf():Se;Se=k(Re)?Re+"":Re}if(typeof Se!="string")return Se===0?Se:+Se;Se=L(Se);var De=z.test(Se);return De||q.test(Se)?ee(Se.slice(2),De?2:8):F.test(Se)?Z:+Se}le.exports=fe},59881:function(le,$,C){var L=C(98363),k=C(81704);function G(Z){return L(Z,k(Z))}le.exports=G},79833:function(le,$,C){var L=C(80531);function k(G){return G==null?"":L(G)}le.exports=k},44908:function(le,$,C){var L=C(45652);function k(G){return G&&G.length?L(G):[]}le.exports=k},11700:function(le,$,C){var L=C(98805),k=L("toUpperCase");le.exports=k},58748:function(le,$,C){var L=C(49029),k=C(93157),G=C(79833),Z=C(2757);function F(z,q,ee){return z=G(z),q=ee?void 0:q,q===void 0?k(z)?Z(z):L(z):z.match(q)||[]}le.exports=F},27418:function(le){"use strict";var $=Object.getOwnPropertySymbols,C=Object.prototype.hasOwnProperty,L=Object.prototype.propertyIsEnumerable;function k(Z){if(Z==null)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(Z)}function G(){try{if(!Object.assign)return!1;var Z=new String("abc");if(Z[5]="de",Object.getOwnPropertyNames(Z)[0]==="5")return!1;for(var F={},z=0;z<10;z++)F["_"+String.fromCharCode(z)]=z;var q=Object.getOwnPropertyNames(F).map(function(fe){return F[fe]});if(q.join("")!=="0123456789")return!1;var ee={};return"abcdefghijklmnopqrst".split("").forEach(function(fe){ee[fe]=fe}),Object.keys(Object.assign({},ee)).join("")==="abcdefghijklmnopqrst"}catch(fe){return!1}}le.exports=G()?Object.assign:function(Z,F){for(var z,q=k(Z),ee,fe=1;fe<arguments.length;fe++){z=Object(arguments[fe]);for(var Se in z)C.call(z,Se)&&(q[Se]=z[Se]);if($){ee=$(z);for(var Re=0;Re<ee.length;Re++)L.call(z,ee[Re])&&(q[ee[Re]]=z[ee[Re]])}}return q}},24244:function(le){"use strict";var $=function(C){return C!==C};le.exports=function(L,k){return L===0&&k===0?1/L===1/k:!!(L===k||$(L)&&$(k))}},20609:function(le,$,C){"use strict";var L=C(4289),k=C(55559),G=C(24244),Z=C(75624),F=C(52281),z=k(Z(),Object);L(z,{getPolyfill:Z,implementation:G,shim:F}),le.exports=z},75624:function(le,$,C){"use strict";var L=C(24244);le.exports=function(){return typeof Object.is=="function"?Object.is:L}},52281:function(le,$,C){"use strict";var L=C(75624),k=C(4289);le.exports=function(){var Z=L();return k(Object,{is:Z},{is:function(){return Object.is!==Z}}),Z}},18987:function(le,$,C){"use strict";var L;if(!Object.keys){var k=Object.prototype.hasOwnProperty,G=Object.prototype.toString,Z=C(21414),F=Object.prototype.propertyIsEnumerable,z=!F.call({toString:null},"toString"),q=F.call(function(){},"prototype"),ee=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],fe=function(Ve){var nt=Ve.constructor;return nt&&nt.prototype===Ve},Se={$applicationCache:!0,$console:!0,$external:!0,$frame:!0,$frameElement:!0,$frames:!0,$innerHeight:!0,$innerWidth:!0,$onmozfullscreenchange:!0,$onmozfullscreenerror:!0,$outerHeight:!0,$outerWidth:!0,$pageXOffset:!0,$pageYOffset:!0,$parent:!0,$scrollLeft:!0,$scrollTop:!0,$scrollX:!0,$scrollY:!0,$self:!0,$webkitIndexedDB:!0,$webkitStorageInfo:!0,$window:!0},Re=function(){if(typeof window=="undefined")return!1;for(var Ve in window)try{if(!Se["$"+Ve]&&k.call(window,Ve)&&window[Ve]!==null&&typeof window[Ve]=="object")try{fe(window[Ve])}catch(nt){return!0}}catch(nt){return!0}return!1}(),De=function(Ve){if(typeof window=="undefined"||!Re)return fe(Ve);try{return fe(Ve)}catch(nt){return!1}};L=function(nt){var Ee=nt!==null&&typeof nt=="object",Ie=G.call(nt)==="[object Function]",me=Z(nt),we=Ee&&G.call(nt)==="[object String]",ne=[];if(!Ee&&!Ie&&!me)throw new TypeError("Object.keys called on a non-object");var Pe=q&&Ie;if(we&&nt.length>0&&!k.call(nt,0))for(var he=0;he<nt.length;++he)ne.push(String(he));if(me&&nt.length>0)for(var ve=0;ve<nt.length;++ve)ne.push(String(ve));else for(var te in nt)!(Pe&&te==="prototype")&&k.call(nt,te)&&ne.push(String(te));if(z)for(var Y=De(nt),Oe=0;Oe<ee.length;++Oe)!(Y&&ee[Oe]==="constructor")&&k.call(nt,ee[Oe])&&ne.push(ee[Oe]);return ne}}le.exports=L},82215:function(le,$,C){"use strict";var L=Array.prototype.slice,k=C(21414),G=Object.keys,Z=G?function(q){return G(q)}:C(18987),F=Object.keys;Z.shim=function(){if(Object.keys){var q=function(){var ee=Object.keys(arguments);return ee&&ee.length===arguments.length}(1,2);q||(Object.keys=function(fe){return k(fe)?F(L.call(fe)):F(fe)})}else Object.keys=Z;return Object.keys||Z},le.exports=Z},21414:function(le){"use strict";var $=Object.prototype.toString;le.exports=function(L){var k=$.call(L),G=k==="[object Arguments]";return G||(G=k!=="[object Array]"&&L!==null&&typeof L=="object"&&typeof L.length=="number"&&L.length>=0&&$.call(L.callee)==="[object Function]"),G}},3614:function(le,$,C){"use strict";le.exports=k;var L=C(80645);function k(X){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(X)?X:new Uint8Array(X||0),this.pos=0,this.type=0,this.length=this.buf.length}k.Varint=0,k.Fixed64=1,k.Bytes=2,k.Fixed32=5;var G=65536*65536,Z=1/G,F=12,z=typeof TextDecoder=="undefined"?null:new TextDecoder("utf8");k.prototype={destroy:function(){this.buf=null},readFields:function(X,Le,de){for(de=de||this.length;this.pos<de;){var be=this.readVarint(),se=be>>3,Ne=this.pos;this.type=be&7,X(se,Le,this),this.pos===Ne&&this.skip(be)}return Le},readMessage:function(X,Le){return this.readFields(X,Le,this.readVarint()+this.pos)},readFixed32:function(){var X=te(this.buf,this.pos);return this.pos+=4,X},readSFixed32:function(){var X=Oe(this.buf,this.pos);return this.pos+=4,X},readFixed64:function(){var X=te(this.buf,this.pos)+te(this.buf,this.pos+4)*G;return this.pos+=8,X},readSFixed64:function(){var X=te(this.buf,this.pos)+Oe(this.buf,this.pos+4)*G;return this.pos+=8,X},readFloat:function(){var X=L.read(this.buf,this.pos,!0,23,4);return this.pos+=4,X},readDouble:function(){var X=L.read(this.buf,this.pos,!0,52,8);return this.pos+=8,X},readVarint:function(X){var Le=this.buf,de,be;return be=Le[this.pos++],de=be&127,be<128||(be=Le[this.pos++],de|=(be&127)<<7,be<128)||(be=Le[this.pos++],de|=(be&127)<<14,be<128)||(be=Le[this.pos++],de|=(be&127)<<21,be<128)?de:(be=Le[this.pos],de|=(be&15)<<28,q(de,X,this))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var X=this.readVarint();return X%2===1?(X+1)/-2:X/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var X=this.readVarint()+this.pos,Le=this.pos;return this.pos=X,X-Le>=F&&z?ye(this.buf,Le,X):pe(this.buf,Le,X)},readBytes:function(){var X=this.readVarint()+this.pos,Le=this.buf.subarray(this.pos,X);return this.pos=X,Le},readPackedVarint:function(X,Le){if(this.type!==k.Bytes)return X.push(this.readVarint(Le));var de=ee(this);for(X=X||[];this.pos<de;)X.push(this.readVarint(Le));return X},readPackedSVarint:function(X){if(this.type!==k.Bytes)return X.push(this.readSVarint());var Le=ee(this);for(X=X||[];this.pos<Le;)X.push(this.readSVarint());return X},readPackedBoolean:function(X){if(this.type!==k.Bytes)return X.push(this.readBoolean());var Le=ee(this);for(X=X||[];this.pos<Le;)X.push(this.readBoolean());return X},readPackedFloat:function(X){if(this.type!==k.Bytes)return X.push(this.readFloat());var Le=ee(this);for(X=X||[];this.pos<Le;)X.push(this.readFloat());return X},readPackedDouble:function(X){if(this.type!==k.Bytes)return X.push(this.readDouble());var Le=ee(this);for(X=X||[];this.pos<Le;)X.push(this.readDouble());return X},readPackedFixed32:function(X){if(this.type!==k.Bytes)return X.push(this.readFixed32());var Le=ee(this);for(X=X||[];this.pos<Le;)X.push(this.readFixed32());return X},readPackedSFixed32:function(X){if(this.type!==k.Bytes)return X.push(this.readSFixed32());var Le=ee(this);for(X=X||[];this.pos<Le;)X.push(this.readSFixed32());return X},readPackedFixed64:function(X){if(this.type!==k.Bytes)return X.push(this.readFixed64());var Le=ee(this);for(X=X||[];this.pos<Le;)X.push(this.readFixed64());return X},readPackedSFixed64:function(X){if(this.type!==k.Bytes)return X.push(this.readSFixed64());var Le=ee(this);for(X=X||[];this.pos<Le;)X.push(this.readSFixed64());return X},skip:function(X){var Le=X&7;if(Le===k.Varint)for(;this.buf[this.pos++]>127;);else if(Le===k.Bytes)this.pos=this.readVarint()+this.pos;else if(Le===k.Fixed32)this.pos+=4;else if(Le===k.Fixed64)this.pos+=8;else throw new Error("Unimplemented type: "+Le)},writeTag:function(X,Le){this.writeVarint(X<<3|Le)},realloc:function(X){for(var Le=this.length||16;Le<this.pos+X;)Le*=2;if(Le!==this.length){var de=new Uint8Array(Le);de.set(this.buf),this.buf=de,this.length=Le}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(X){this.realloc(4),Y(this.buf,X,this.pos),this.pos+=4},writeSFixed32:function(X){this.realloc(4),Y(this.buf,X,this.pos),this.pos+=4},writeFixed64:function(X){this.realloc(8),Y(this.buf,X&-1,this.pos),Y(this.buf,Math.floor(X*Z),this.pos+4),this.pos+=8},writeSFixed64:function(X){this.realloc(8),Y(this.buf,X&-1,this.pos),Y(this.buf,Math.floor(X*Z),this.pos+4),this.pos+=8},writeVarint:function(X){if(X=+X||0,X>268435455||X<0){Se(X,this);return}this.realloc(4),this.buf[this.pos++]=X&127|(X>127?128:0),!(X<=127)&&(this.buf[this.pos++]=(X>>>=7)&127|(X>127?128:0),!(X<=127)&&(this.buf[this.pos++]=(X>>>=7)&127|(X>127?128:0),!(X<=127)&&(this.buf[this.pos++]=X>>>7&127)))},writeSVarint:function(X){this.writeVarint(X<0?-X*2-1:X*2)},writeBoolean:function(X){this.writeVarint(!!X)},writeString:function(X){X=String(X),this.realloc(X.length*4),this.pos++;var Le=this.pos;this.pos=_e(this.buf,X,this.pos);var de=this.pos-Le;de>=128&&Ve(Le,de,this),this.pos=Le-1,this.writeVarint(de),this.pos+=de},writeFloat:function(X){this.realloc(4),L.write(this.buf,X,this.pos,!0,23,4),this.pos+=4},writeDouble:function(X){this.realloc(8),L.write(this.buf,X,this.pos,!0,52,8),this.pos+=8},writeBytes:function(X){var Le=X.length;this.writeVarint(Le),this.realloc(Le);for(var de=0;de<Le;de++)this.buf[this.pos++]=X[de]},writeRawMessage:function(X,Le){this.pos++;var de=this.pos;X(Le,this);var be=this.pos-de;be>=128&&Ve(de,be,this),this.pos=de-1,this.writeVarint(be),this.pos+=be},writeMessage:function(X,Le,de){this.writeTag(X,k.Bytes),this.writeRawMessage(Le,de)},writePackedVarint:function(X,Le){Le.length&&this.writeMessage(X,nt,Le)},writePackedSVarint:function(X,Le){Le.length&&this.writeMessage(X,Ee,Le)},writePackedBoolean:function(X,Le){Le.length&&this.writeMessage(X,we,Le)},writePackedFloat:function(X,Le){Le.length&&this.writeMessage(X,Ie,Le)},writePackedDouble:function(X,Le){Le.length&&this.writeMessage(X,me,Le)},writePackedFixed32:function(X,Le){Le.length&&this.writeMessage(X,ne,Le)},writePackedSFixed32:function(X,Le){Le.length&&this.writeMessage(X,Pe,Le)},writePackedFixed64:function(X,Le){Le.length&&this.writeMessage(X,he,Le)},writePackedSFixed64:function(X,Le){Le.length&&this.writeMessage(X,ve,Le)},writeBytesField:function(X,Le){this.writeTag(X,k.Bytes),this.writeBytes(Le)},writeFixed32Field:function(X,Le){this.writeTag(X,k.Fixed32),this.writeFixed32(Le)},writeSFixed32Field:function(X,Le){this.writeTag(X,k.Fixed32),this.writeSFixed32(Le)},writeFixed64Field:function(X,Le){this.writeTag(X,k.Fixed64),this.writeFixed64(Le)},writeSFixed64Field:function(X,Le){this.writeTag(X,k.Fixed64),this.writeSFixed64(Le)},writeVarintField:function(X,Le){this.writeTag(X,k.Varint),this.writeVarint(Le)},writeSVarintField:function(X,Le){this.writeTag(X,k.Varint),this.writeSVarint(Le)},writeStringField:function(X,Le){this.writeTag(X,k.Bytes),this.writeString(Le)},writeFloatField:function(X,Le){this.writeTag(X,k.Fixed32),this.writeFloat(Le)},writeDoubleField:function(X,Le){this.writeTag(X,k.Fixed64),this.writeDouble(Le)},writeBooleanField:function(X,Le){this.writeVarintField(X,!!Le)}};function q(X,Le,de){var be=de.buf,se,Ne;if(Ne=be[de.pos++],se=(Ne&112)>>4,Ne<128||(Ne=be[de.pos++],se|=(Ne&127)<<3,Ne<128)||(Ne=be[de.pos++],se|=(Ne&127)<<10,Ne<128)||(Ne=be[de.pos++],se|=(Ne&127)<<17,Ne<128)||(Ne=be[de.pos++],se|=(Ne&127)<<24,Ne<128)||(Ne=be[de.pos++],se|=(Ne&1)<<31,Ne<128))return fe(X,se,Le);throw new Error("Expected varint not more than 10 bytes")}function ee(X){return X.type===k.Bytes?X.readVarint()+X.pos:X.pos+1}function fe(X,Le,de){return de?Le*4294967296+(X>>>0):(Le>>>0)*4294967296+(X>>>0)}function Se(X,Le){var de,be;if(X>=0?(de=X%4294967296|0,be=X/4294967296|0):(de=~(-X%4294967296),be=~(-X/4294967296),de^4294967295?de=de+1|0:(de=0,be=be+1|0)),X>=18446744073709552e3||X<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");Le.realloc(10),Re(de,be,Le),De(be,Le)}function Re(X,Le,de){de.buf[de.pos++]=X&127|128,X>>>=7,de.buf[de.pos++]=X&127|128,X>>>=7,de.buf[de.pos++]=X&127|128,X>>>=7,de.buf[de.pos++]=X&127|128,X>>>=7,de.buf[de.pos]=X&127}function De(X,Le){var de=(X&7)<<4;Le.buf[Le.pos++]|=de|((X>>>=3)?128:0),X&&(Le.buf[Le.pos++]=X&127|((X>>>=7)?128:0),X&&(Le.buf[Le.pos++]=X&127|((X>>>=7)?128:0),X&&(Le.buf[Le.pos++]=X&127|((X>>>=7)?128:0),X&&(Le.buf[Le.pos++]=X&127|((X>>>=7)?128:0),X&&(Le.buf[Le.pos++]=X&127)))))}function Ve(X,Le,de){var be=Le<=16383?1:Le<=2097151?2:Le<=268435455?3:Math.floor(Math.log(Le)/(Math.LN2*7));de.realloc(be);for(var se=de.pos-1;se>=X;se--)de.buf[se+be]=de.buf[se]}function nt(X,Le){for(var de=0;de<X.length;de++)Le.writeVarint(X[de])}function Ee(X,Le){for(var de=0;de<X.length;de++)Le.writeSVarint(X[de])}function Ie(X,Le){for(var de=0;de<X.length;de++)Le.writeFloat(X[de])}function me(X,Le){for(var de=0;de<X.length;de++)Le.writeDouble(X[de])}function we(X,Le){for(var de=0;de<X.length;de++)Le.writeBoolean(X[de])}function ne(X,Le){for(var de=0;de<X.length;de++)Le.writeFixed32(X[de])}function Pe(X,Le){for(var de=0;de<X.length;de++)Le.writeSFixed32(X[de])}function he(X,Le){for(var de=0;de<X.length;de++)Le.writeFixed64(X[de])}function ve(X,Le){for(var de=0;de<X.length;de++)Le.writeSFixed64(X[de])}function te(X,Le){return(X[Le]|X[Le+1]<<8|X[Le+2]<<16)+X[Le+3]*16777216}function Y(X,Le,de){X[de]=Le,X[de+1]=Le>>>8,X[de+2]=Le>>>16,X[de+3]=Le>>>24}function Oe(X,Le){return(X[Le]|X[Le+1]<<8|X[Le+2]<<16)+(X[Le+3]<<24)}function pe(X,Le,de){for(var be="",se=Le;se<de;){var Ne=X[se],ze=null,ue=Ne>239?4:Ne>223?3:Ne>191?2:1;if(se+ue>de)break;var kt,Rt,cr;ue===1?Ne<128&&(ze=Ne):ue===2?(kt=X[se+1],(kt&192)===128&&(ze=(Ne&31)<<6|kt&63,ze<=127&&(ze=null))):ue===3?(kt=X[se+1],Rt=X[se+2],(kt&192)===128&&(Rt&192)===128&&(ze=(Ne&15)<<12|(kt&63)<<6|Rt&63,(ze<=2047||ze>=55296&&ze<=57343)&&(ze=null))):ue===4&&(kt=X[se+1],Rt=X[se+2],cr=X[se+3],(kt&192)===128&&(Rt&192)===128&&(cr&192)===128&&(ze=(Ne&15)<<18|(kt&63)<<12|(Rt&63)<<6|cr&63,(ze<=65535||ze>=1114112)&&(ze=null))),ze===null?(ze=65533,ue=1):ze>65535&&(ze-=65536,be+=String.fromCharCode(ze>>>10&1023|55296),ze=56320|ze&1023),be+=String.fromCharCode(ze),se+=ue}return be}function ye(X,Le,de){return z.decode(X.subarray(Le,de))}function _e(X,Le,de){for(var be=0,se,Ne;be<Le.length;be++){if(se=Le.charCodeAt(be),se>55295&&se<57344)if(Ne)if(se<56320){X[de++]=239,X[de++]=191,X[de++]=189,Ne=se;continue}else se=Ne-55296<<10|se-56320|65536,Ne=null;else{se>56319||be+1===Le.length?(X[de++]=239,X[de++]=191,X[de++]=189):Ne=se;continue}else Ne&&(X[de++]=239,X[de++]=191,X[de++]=189,Ne=null);se<128?X[de++]=se:(se<2048?X[de++]=se>>6|192:(se<65536?X[de++]=se>>12|224:(X[de++]=se>>18|240,X[de++]=se>>12&63|128),X[de++]=se>>6&63|128),X[de++]=se&63|128)}return de}},11895:function(le){le.exports=function(C,L,k,G){var Z=C[0],F=C[1],z=!1;k===void 0&&(k=0),G===void 0&&(G=L.length);for(var q=(G-k)/2,ee=0,fe=q-1;ee<q;fe=ee++){var Se=L[k+ee*2+0],Re=L[k+ee*2+1],De=L[k+fe*2+0],Ve=L[k+fe*2+1],nt=Re>F!=Ve>F&&Z<(De-Se)*(F-Re)/(Ve-Re)+Se;nt&&(z=!z)}return z}},26960:function(le,$,C){var L=C(11895),k=C(88139);le.exports=function(Z,F,z,q){return F.length>0&&Array.isArray(F[0])?k(Z,F,z,q):L(Z,F,z,q)},le.exports.nested=k,le.exports.flat=L},88139:function(le){le.exports=function(C,L,k,G){var Z=C[0],F=C[1],z=!1;k===void 0&&(k=0),G===void 0&&(G=L.length);for(var q=G-k,ee=0,fe=q-1;ee<q;fe=ee++){var Se=L[ee+k][0],Re=L[ee+k][1],De=L[fe+k][0],Ve=L[fe+k][1],nt=Re>F!=Ve>F&&Z<(De-Se)*(F-Re)/(Ve-Re)+Se;nt&&(z=!z)}return z}},32676:function(le,$,C){var L=C(34155);(function(k,G){le.exports=G()})(this,function(){"use strict";function k(Lt,J){if(!(Lt instanceof J))throw new TypeError("Cannot call a class as a function")}function G(Lt,J){for(var Ue=0;Ue<J.length;Ue++){var $e=J[Ue];$e.enumerable=$e.enumerable||!1,$e.configurable=!0,"value"in $e&&($e.writable=!0),Object.defineProperty(Lt,$e.key,$e)}}function Z(Lt,J,Ue){return J&&G(Lt.prototype,J),Ue&&G(Lt,Ue),Lt}var F=function(){function Lt(J,Ue){this.next=null,this.key=J,this.data=Ue,this.left=null,this.right=null}return Lt}();function z(Lt,J){return Lt>J?1:Lt<J?-1:0}function q(Lt,J,Ue){for(var $e=new F(null,null),At=$e,It=$e;;){var wt=Ue(Lt,J.key);if(wt<0){if(J.left===null)break;if(Ue(Lt,J.left.key)<0){var mr=J.left;if(J.left=mr.right,mr.right=J,J=mr,J.left===null)break}It.left=J,It=J,J=J.left}else if(wt>0){if(J.right===null)break;if(Ue(Lt,J.right.key)>0){var mr=J.right;if(J.right=mr.left,mr.left=J,J=mr,J.right===null)break}At.right=J,At=J,J=J.right}else break}return At.right=J.left,It.left=J.right,J.left=$e.right,J.right=$e.left,J}function ee(Lt,J,Ue,$e){var At=new F(Lt,J);if(Ue===null)return At.left=At.right=null,At;Ue=q(Lt,Ue,$e);var It=$e(Lt,Ue.key);return It<0?(At.left=Ue.left,At.right=Ue,Ue.left=null):It>=0&&(At.right=Ue.right,At.left=Ue,Ue.right=null),At}function fe(Lt,J,Ue){var $e=null,At=null;if(J){J=q(Lt,J,Ue);var It=Ue(J.key,Lt);It===0?($e=J.left,At=J.right):It<0?(At=J.right,J.right=null,$e=J):($e=J.left,J.left=null,At=J)}return{left:$e,right:At}}function Se(Lt,J,Ue){return J===null?Lt:(Lt===null||(J=q(Lt.key,J,Ue),J.left=Lt),J)}function Re(Lt,J,Ue,$e,At){if(Lt){$e(""+J+(Ue?"\u2514\u2500\u2500 ":"\u251C\u2500\u2500 ")+At(Lt)+`
`);var It=J+(Ue?"    ":"\u2502   ");Lt.left&&Re(Lt.left,It,!1,$e,At),Lt.right&&Re(Lt.right,It,!0,$e,At)}}var De=function(){function Lt(J){J===void 0&&(J=z),this._root=null,this._size=0,this._comparator=J}return Lt.prototype.insert=function(J,Ue){return this._size++,this._root=ee(J,Ue,this._root,this._comparator)},Lt.prototype.add=function(J,Ue){var $e=new F(J,Ue);this._root===null&&($e.left=$e.right=null,this._size++,this._root=$e);var At=this._comparator,It=q(J,this._root,At),wt=At(J,It.key);return wt===0?this._root=It:(wt<0?($e.left=It.left,$e.right=It,It.left=null):wt>0&&($e.right=It.right,$e.left=It,It.right=null),this._size++,this._root=$e),this._root},Lt.prototype.remove=function(J){this._root=this._remove(J,this._root,this._comparator)},Lt.prototype._remove=function(J,Ue,$e){var At;if(Ue===null)return null;Ue=q(J,Ue,$e);var It=$e(J,Ue.key);return It===0?(Ue.left===null?At=Ue.right:(At=q(J,Ue.left,$e),At.right=Ue.right),this._size--,At):Ue},Lt.prototype.pop=function(){var J=this._root;if(J){for(;J.left;)J=J.left;return this._root=q(J.key,this._root,this._comparator),this._root=this._remove(J.key,this._root,this._comparator),{key:J.key,data:J.data}}return null},Lt.prototype.findStatic=function(J){for(var Ue=this._root,$e=this._comparator;Ue;){var At=$e(J,Ue.key);if(At===0)return Ue;At<0?Ue=Ue.left:Ue=Ue.right}return null},Lt.prototype.find=function(J){return this._root&&(this._root=q(J,this._root,this._comparator),this._comparator(J,this._root.key)!==0)?null:this._root},Lt.prototype.contains=function(J){for(var Ue=this._root,$e=this._comparator;Ue;){var At=$e(J,Ue.key);if(At===0)return!0;At<0?Ue=Ue.left:Ue=Ue.right}return!1},Lt.prototype.forEach=function(J,Ue){for(var $e=this._root,At=[],It=!1;!It;)$e!==null?(At.push($e),$e=$e.left):At.length!==0?($e=At.pop(),J.call(Ue,$e),$e=$e.right):It=!0;return this},Lt.prototype.range=function(J,Ue,$e,At){for(var It=[],wt=this._comparator,mr=this._root,vt;It.length!==0||mr;)if(mr)It.push(mr),mr=mr.left;else{if(mr=It.pop(),vt=wt(mr.key,Ue),vt>0)break;if(wt(mr.key,J)>=0&&$e.call(At,mr))return this;mr=mr.right}return this},Lt.prototype.keys=function(){var J=[];return this.forEach(function(Ue){var $e=Ue.key;return J.push($e)}),J},Lt.prototype.values=function(){var J=[];return this.forEach(function(Ue){var $e=Ue.data;return J.push($e)}),J},Lt.prototype.min=function(){return this._root?this.minNode(this._root).key:null},Lt.prototype.max=function(){return this._root?this.maxNode(this._root).key:null},Lt.prototype.minNode=function(J){if(J===void 0&&(J=this._root),J)for(;J.left;)J=J.left;return J},Lt.prototype.maxNode=function(J){if(J===void 0&&(J=this._root),J)for(;J.right;)J=J.right;return J},Lt.prototype.at=function(J){for(var Ue=this._root,$e=!1,At=0,It=[];!$e;)if(Ue)It.push(Ue),Ue=Ue.left;else if(It.length>0){if(Ue=It.pop(),At===J)return Ue;At++,Ue=Ue.right}else $e=!0;return null},Lt.prototype.next=function(J){var Ue=this._root,$e=null;if(J.right){for($e=J.right;$e.left;)$e=$e.left;return $e}for(var At=this._comparator;Ue;){var It=At(J.key,Ue.key);if(It===0)break;It<0?($e=Ue,Ue=Ue.left):Ue=Ue.right}return $e},Lt.prototype.prev=function(J){var Ue=this._root,$e=null;if(J.left!==null){for($e=J.left;$e.right;)$e=$e.right;return $e}for(var At=this._comparator;Ue;){var It=At(J.key,Ue.key);if(It===0)break;It<0?Ue=Ue.left:($e=Ue,Ue=Ue.right)}return $e},Lt.prototype.clear=function(){return this._root=null,this._size=0,this},Lt.prototype.toList=function(){return Ee(this._root)},Lt.prototype.load=function(J,Ue,$e){Ue===void 0&&(Ue=[]),$e===void 0&&($e=!1);var At=J.length,It=this._comparator;if($e&&we(J,Ue,0,At-1,It),this._root===null)this._root=Ve(J,Ue,0,At),this._size=At;else{var wt=me(this.toList(),nt(J,Ue),It);At=this._size+At,this._root=Ie({head:wt},0,At)}return this},Lt.prototype.isEmpty=function(){return this._root===null},Object.defineProperty(Lt.prototype,"size",{get:function(){return this._size},enumerable:!0,configurable:!0}),Object.defineProperty(Lt.prototype,"root",{get:function(){return this._root},enumerable:!0,configurable:!0}),Lt.prototype.toString=function(J){J===void 0&&(J=function(At){return String(At.key)});var Ue=[];return Re(this._root,"",!0,function($e){return Ue.push($e)},J),Ue.join("")},Lt.prototype.update=function(J,Ue,$e){var At=this._comparator,It=fe(J,this._root,At),wt=It.left,mr=It.right;At(J,Ue)<0?mr=ee(Ue,$e,mr,At):wt=ee(Ue,$e,wt,At),this._root=Se(wt,mr,At)},Lt.prototype.split=function(J){return fe(J,this._root,this._comparator)},Lt}();function Ve(Lt,J,Ue,$e){var At=$e-Ue;if(At>0){var It=Ue+Math.floor(At/2),wt=Lt[It],mr=J[It],vt=new F(wt,mr);return vt.left=Ve(Lt,J,Ue,It),vt.right=Ve(Lt,J,It+1,$e),vt}return null}function nt(Lt,J){for(var Ue=new F(null,null),$e=Ue,At=0;At<Lt.length;At++)$e=$e.next=new F(Lt[At],J[At]);return $e.next=null,Ue.next}function Ee(Lt){for(var J=Lt,Ue=[],$e=!1,At=new F(null,null),It=At;!$e;)J?(Ue.push(J),J=J.left):Ue.length>0?(J=It=It.next=Ue.pop(),J=J.right):$e=!0;return It.next=null,At.next}function Ie(Lt,J,Ue){var $e=Ue-J;if($e>0){var At=J+Math.floor($e/2),It=Ie(Lt,J,At),wt=Lt.head;return wt.left=It,Lt.head=Lt.head.next,wt.right=Ie(Lt,At+1,Ue),wt}return null}function me(Lt,J,Ue){for(var $e=new F(null,null),At=$e,It=Lt,wt=J;It!==null&&wt!==null;)Ue(It.key,wt.key)<0?(At.next=It,It=It.next):(At.next=wt,wt=wt.next),At=At.next;return It!==null?At.next=It:wt!==null&&(At.next=wt),$e.next}function we(Lt,J,Ue,$e,At){if(!(Ue>=$e)){for(var It=Lt[Ue+$e>>1],wt=Ue-1,mr=$e+1;;){do wt++;while(At(Lt[wt],It)<0);do mr--;while(At(Lt[mr],It)>0);if(wt>=mr)break;var vt=Lt[wt];Lt[wt]=Lt[mr],Lt[mr]=vt,vt=J[wt],J[wt]=J[mr],J[mr]=vt}we(Lt,J,Ue,mr,At),we(Lt,J,mr+1,$e,At)}}var ne=function(J,Ue){return J.ll.x<=Ue.x&&Ue.x<=J.ur.x&&J.ll.y<=Ue.y&&Ue.y<=J.ur.y},Pe=function(J,Ue){if(Ue.ur.x<J.ll.x||J.ur.x<Ue.ll.x||Ue.ur.y<J.ll.y||J.ur.y<Ue.ll.y)return null;var $e=J.ll.x<Ue.ll.x?Ue.ll.x:J.ll.x,At=J.ur.x<Ue.ur.x?J.ur.x:Ue.ur.x,It=J.ll.y<Ue.ll.y?Ue.ll.y:J.ll.y,wt=J.ur.y<Ue.ur.y?J.ur.y:Ue.ur.y;return{ll:{x:$e,y:It},ur:{x:At,y:wt}}},he=Number.EPSILON;he===void 0&&(he=Math.pow(2,-52));var ve=he*he,te=function(J,Ue){if(-he<J&&J<he&&-he<Ue&&Ue<he)return 0;var $e=J-Ue;return $e*$e<ve*J*Ue?0:J<Ue?-1:1},Y=function(){function Lt(){k(this,Lt),this.reset()}return Z(Lt,[{key:"reset",value:function(){this.xRounder=new Oe,this.yRounder=new Oe}},{key:"round",value:function(Ue,$e){return{x:this.xRounder.round(Ue),y:this.yRounder.round($e)}}}]),Lt}(),Oe=function(){function Lt(){k(this,Lt),this.tree=new De,this.round(0)}return Z(Lt,[{key:"round",value:function(Ue){var $e=this.tree.add(Ue),At=this.tree.prev($e);if(At!==null&&te($e.key,At.key)===0)return this.tree.remove(Ue),At.key;var It=this.tree.next($e);return It!==null&&te($e.key,It.key)===0?(this.tree.remove(Ue),It.key):Ue}}]),Lt}(),pe=new Y,ye=function(J,Ue){return J.x*Ue.y-J.y*Ue.x},_e=function(J,Ue){return J.x*Ue.x+J.y*Ue.y},X=function(J,Ue,$e){var At={x:Ue.x-J.x,y:Ue.y-J.y},It={x:$e.x-J.x,y:$e.y-J.y},wt=ye(At,It);return te(wt,0)},Le=function(J){return Math.sqrt(_e(J,J))},de=function(J,Ue,$e){var At={x:Ue.x-J.x,y:Ue.y-J.y},It={x:$e.x-J.x,y:$e.y-J.y};return ye(It,At)/Le(It)/Le(At)},be=function(J,Ue,$e){var At={x:Ue.x-J.x,y:Ue.y-J.y},It={x:$e.x-J.x,y:$e.y-J.y};return _e(It,At)/Le(It)/Le(At)},se=function(J,Ue,$e){return Ue.y===0?null:{x:J.x+Ue.x/Ue.y*($e-J.y),y:$e}},Ne=function(J,Ue,$e){return Ue.x===0?null:{x:$e,y:J.y+Ue.y/Ue.x*($e-J.x)}},ze=function(J,Ue,$e,At){if(Ue.x===0)return Ne($e,At,J.x);if(At.x===0)return Ne(J,Ue,$e.x);if(Ue.y===0)return se($e,At,J.y);if(At.y===0)return se(J,Ue,$e.y);var It=ye(Ue,At);if(It==0)return null;var wt={x:$e.x-J.x,y:$e.y-J.y},mr=ye(wt,Ue)/It,vt=ye(wt,At)/It,Tt=J.x+vt*Ue.x,Qt=$e.x+mr*At.x,Er=J.y+vt*Ue.y,Dr=$e.y+mr*At.y,Yr=(Tt+Qt)/2,an=(Er+Dr)/2;return{x:Yr,y:an}},ue=function(){Z(Lt,null,[{key:"compare",value:function(Ue,$e){var At=Lt.comparePoints(Ue.point,$e.point);return At!==0?At:(Ue.point!==$e.point&&Ue.link($e),Ue.isLeft!==$e.isLeft?Ue.isLeft?1:-1:Rt.compare(Ue.segment,$e.segment))}},{key:"comparePoints",value:function(Ue,$e){return Ue.x<$e.x?-1:Ue.x>$e.x?1:Ue.y<$e.y?-1:Ue.y>$e.y?1:0}}]);function Lt(J,Ue){k(this,Lt),J.events===void 0?J.events=[this]:J.events.push(this),this.point=J,this.isLeft=Ue}return Z(Lt,[{key:"link",value:function(Ue){if(Ue.point===this.point)throw new Error("Tried to link already linked events");for(var $e=Ue.point.events,At=0,It=$e.length;At<It;At++){var wt=$e[At];this.point.events.push(wt),wt.point=this.point}this.checkForConsuming()}},{key:"checkForConsuming",value:function(){for(var Ue=this.point.events.length,$e=0;$e<Ue;$e++){var At=this.point.events[$e];if(At.segment.consumedBy===void 0)for(var It=$e+1;It<Ue;It++){var wt=this.point.events[It];wt.consumedBy===void 0&&At.otherSE.point.events===wt.otherSE.point.events&&At.segment.consume(wt.segment)}}}},{key:"getAvailableLinkedEvents",value:function(){for(var Ue=[],$e=0,At=this.point.events.length;$e<At;$e++){var It=this.point.events[$e];It!==this&&!It.segment.ringOut&&It.segment.isInResult()&&Ue.push(It)}return Ue}},{key:"getLeftmostComparator",value:function(Ue){var $e=this,At=new Map,It=function(mr){var vt=mr.otherSE;At.set(mr,{sine:de($e.point,Ue.point,vt.point),cosine:be($e.point,Ue.point,vt.point)})};return function(wt,mr){At.has(wt)||It(wt),At.has(mr)||It(mr);var vt=At.get(wt),Tt=vt.sine,Qt=vt.cosine,Er=At.get(mr),Dr=Er.sine,Yr=Er.cosine;return Tt>=0&&Dr>=0?Qt<Yr?1:Qt>Yr?-1:0:Tt<0&&Dr<0?Qt<Yr?-1:Qt>Yr?1:0:Dr<Tt?-1:Dr>Tt?1:0}}}]),Lt}(),kt=0,Rt=function(){Z(Lt,null,[{key:"compare",value:function(Ue,$e){var At=Ue.leftSE.point.x,It=$e.leftSE.point.x,wt=Ue.rightSE.point.x,mr=$e.rightSE.point.x;if(mr<At)return 1;if(wt<It)return-1;var vt=Ue.leftSE.point.y,Tt=$e.leftSE.point.y,Qt=Ue.rightSE.point.y,Er=$e.rightSE.point.y;if(At<It){if(Tt<vt&&Tt<Qt)return 1;if(Tt>vt&&Tt>Qt)return-1;var Dr=Ue.comparePoint($e.leftSE.point);if(Dr<0)return 1;if(Dr>0)return-1;var Yr=$e.comparePoint(Ue.rightSE.point);return Yr!==0?Yr:-1}if(At>It){if(vt<Tt&&vt<Er)return-1;if(vt>Tt&&vt>Er)return 1;var an=$e.comparePoint(Ue.leftSE.point);if(an!==0)return an;var Br=Ue.comparePoint($e.rightSE.point);return Br<0?1:Br>0?-1:1}if(vt<Tt)return-1;if(vt>Tt)return 1;if(wt<mr){var en=$e.comparePoint(Ue.rightSE.point);if(en!==0)return en}if(wt>mr){var Zn=Ue.comparePoint($e.rightSE.point);if(Zn<0)return 1;if(Zn>0)return-1}if(wt!==mr){var zn=Qt-vt,fi=wt-At,la=Er-Tt,Oa=mr-It;if(zn>fi&&la<Oa)return 1;if(zn<fi&&la>Oa)return-1}return wt>mr?1:wt<mr||Qt<Er?-1:Qt>Er?1:Ue.id<$e.id?-1:Ue.id>$e.id?1:0}}]);function Lt(J,Ue,$e,At){k(this,Lt),this.id=++kt,this.leftSE=J,J.segment=this,J.otherSE=Ue,this.rightSE=Ue,Ue.segment=this,Ue.otherSE=J,this.rings=$e,this.windings=At}return Z(Lt,[{key:"replaceRightSE",value:function(Ue){this.rightSE=Ue,this.rightSE.segment=this,this.rightSE.otherSE=this.leftSE,this.leftSE.otherSE=this.rightSE}},{key:"bbox",value:function(){var Ue=this.leftSE.point.y,$e=this.rightSE.point.y;return{ll:{x:this.leftSE.point.x,y:Ue<$e?Ue:$e},ur:{x:this.rightSE.point.x,y:Ue>$e?Ue:$e}}}},{key:"vector",value:function(){return{x:this.rightSE.point.x-this.leftSE.point.x,y:this.rightSE.point.y-this.leftSE.point.y}}},{key:"isAnEndpoint",value:function(Ue){return Ue.x===this.leftSE.point.x&&Ue.y===this.leftSE.point.y||Ue.x===this.rightSE.point.x&&Ue.y===this.rightSE.point.y}},{key:"comparePoint",value:function(Ue){if(this.isAnEndpoint(Ue))return 0;var $e=this.leftSE.point,At=this.rightSE.point,It=this.vector();if($e.x===At.x)return Ue.x===$e.x?0:Ue.x<$e.x?1:-1;var wt=(Ue.y-$e.y)/It.y,mr=$e.x+wt*It.x;if(Ue.x===mr)return 0;var vt=(Ue.x-$e.x)/It.x,Tt=$e.y+vt*It.y;return Ue.y===Tt?0:Ue.y<Tt?-1:1}},{key:"getIntersection",value:function(Ue){var $e=this.bbox(),At=Ue.bbox(),It=Pe($e,At);if(It===null)return null;var wt=this.leftSE.point,mr=this.rightSE.point,vt=Ue.leftSE.point,Tt=Ue.rightSE.point,Qt=ne($e,vt)&&this.comparePoint(vt)===0,Er=ne(At,wt)&&Ue.comparePoint(wt)===0,Dr=ne($e,Tt)&&this.comparePoint(Tt)===0,Yr=ne(At,mr)&&Ue.comparePoint(mr)===0;if(Er&&Qt)return Yr&&!Dr?mr:!Yr&&Dr?Tt:null;if(Er)return Dr&&wt.x===Tt.x&&wt.y===Tt.y?null:wt;if(Qt)return Yr&&mr.x===vt.x&&mr.y===vt.y?null:vt;if(Yr&&Dr)return null;if(Yr)return mr;if(Dr)return Tt;var an=ze(wt,this.vector(),vt,Ue.vector());return an===null||!ne(It,an)?null:pe.round(an.x,an.y)}},{key:"split",value:function(Ue){var $e=[],At=Ue.events!==void 0,It=new ue(Ue,!0),wt=new ue(Ue,!1),mr=this.rightSE;this.replaceRightSE(wt),$e.push(wt),$e.push(It);var vt=new Lt(It,mr,this.rings.slice(),this.windings.slice());return ue.comparePoints(vt.leftSE.point,vt.rightSE.point)>0&&vt.swapEvents(),ue.comparePoints(this.leftSE.point,this.rightSE.point)>0&&this.swapEvents(),At&&(It.checkForConsuming(),wt.checkForConsuming()),$e}},{key:"swapEvents",value:function(){var Ue=this.rightSE;this.rightSE=this.leftSE,this.leftSE=Ue,this.leftSE.isLeft=!0,this.rightSE.isLeft=!1;for(var $e=0,At=this.windings.length;$e<At;$e++)this.windings[$e]*=-1}},{key:"consume",value:function(Ue){for(var $e=this,At=Ue;$e.consumedBy;)$e=$e.consumedBy;for(;At.consumedBy;)At=At.consumedBy;var It=Lt.compare($e,At);if(It!==0){if(It>0){var wt=$e;$e=At,At=wt}if($e.prev===At){var mr=$e;$e=At,At=mr}for(var vt=0,Tt=At.rings.length;vt<Tt;vt++){var Qt=At.rings[vt],Er=At.windings[vt],Dr=$e.rings.indexOf(Qt);Dr===-1?($e.rings.push(Qt),$e.windings.push(Er)):$e.windings[Dr]+=Er}At.rings=null,At.windings=null,At.consumedBy=$e,At.leftSE.consumedBy=$e.leftSE,At.rightSE.consumedBy=$e.rightSE}}},{key:"prevInResult",value:function(){return this._prevInResult!==void 0?this._prevInResult:(this.prev?this.prev.isInResult()?this._prevInResult=this.prev:this._prevInResult=this.prev.prevInResult():this._prevInResult=null,this._prevInResult)}},{key:"beforeState",value:function(){if(this._beforeState!==void 0)return this._beforeState;if(!this.prev)this._beforeState={rings:[],windings:[],multiPolys:[]};else{var Ue=this.prev.consumedBy||this.prev;this._beforeState=Ue.afterState()}return this._beforeState}},{key:"afterState",value:function(){if(this._afterState!==void 0)return this._afterState;var Ue=this.beforeState();this._afterState={rings:Ue.rings.slice(0),windings:Ue.windings.slice(0),multiPolys:[]};for(var $e=this._afterState.rings,At=this._afterState.windings,It=this._afterState.multiPolys,wt=0,mr=this.rings.length;wt<mr;wt++){var vt=this.rings[wt],Tt=this.windings[wt],Qt=$e.indexOf(vt);Qt===-1?($e.push(vt),At.push(Tt)):At[Qt]+=Tt}for(var Er=[],Dr=[],Yr=0,an=$e.length;Yr<an;Yr++)if(At[Yr]!==0){var Br=$e[Yr],en=Br.poly;if(Dr.indexOf(en)===-1)if(Br.isExterior)Er.push(en);else{Dr.indexOf(en)===-1&&Dr.push(en);var Zn=Er.indexOf(Br.poly);Zn!==-1&&Er.splice(Zn,1)}}for(var zn=0,fi=Er.length;zn<fi;zn++){var la=Er[zn].multiPoly;It.indexOf(la)===-1&&It.push(la)}return this._afterState}},{key:"isInResult",value:function(){if(this.consumedBy)return!1;if(this._isInResult!==void 0)return this._isInResult;var Ue=this.beforeState().multiPolys,$e=this.afterState().multiPolys;switch(Vn.type){case"union":{var At=Ue.length===0,It=$e.length===0;this._isInResult=At!==It;break}case"intersection":{var wt,mr;Ue.length<$e.length?(wt=Ue.length,mr=$e.length):(wt=$e.length,mr=Ue.length),this._isInResult=mr===Vn.numMultiPolys&&wt<mr;break}case"xor":{var vt=Math.abs(Ue.length-$e.length);this._isInResult=vt%2===1;break}case"difference":{var Tt=function(Er){return Er.length===1&&Er[0].isSubject};this._isInResult=Tt(Ue)!==Tt($e);break}default:throw new Error("Unrecognized operation type found ".concat(Vn.type))}return this._isInResult}}],[{key:"fromRing",value:function(Ue,$e,At){var It,wt,mr,vt=ue.comparePoints(Ue,$e);if(vt<0)It=Ue,wt=$e,mr=1;else if(vt>0)It=$e,wt=Ue,mr=-1;else throw new Error("Tried to create degenerate segment at [".concat(Ue.x,", ").concat(Ue.y,"]"));var Tt=new ue(It,!0),Qt=new ue(wt,!1);return new Lt(Tt,Qt,[At],[mr])}}]),Lt}(),cr=function(){function Lt(J,Ue,$e){if(k(this,Lt),!Array.isArray(J)||J.length===0)throw new Error("Input geometry is not a valid Polygon or MultiPolygon");if(this.poly=Ue,this.isExterior=$e,this.segments=[],typeof J[0][0]!="number"||typeof J[0][1]!="number")throw new Error("Input geometry is not a valid Polygon or MultiPolygon");var At=pe.round(J[0][0],J[0][1]);this.bbox={ll:{x:At.x,y:At.y},ur:{x:At.x,y:At.y}};for(var It=At,wt=1,mr=J.length;wt<mr;wt++){if(typeof J[wt][0]!="number"||typeof J[wt][1]!="number")throw new Error("Input geometry is not a valid Polygon or MultiPolygon");var vt=pe.round(J[wt][0],J[wt][1]);vt.x===It.x&&vt.y===It.y||(this.segments.push(Rt.fromRing(It,vt,this)),vt.x<this.bbox.ll.x&&(this.bbox.ll.x=vt.x),vt.y<this.bbox.ll.y&&(this.bbox.ll.y=vt.y),vt.x>this.bbox.ur.x&&(this.bbox.ur.x=vt.x),vt.y>this.bbox.ur.y&&(this.bbox.ur.y=vt.y),It=vt)}(At.x!==It.x||At.y!==It.y)&&this.segments.push(Rt.fromRing(It,At,this))}return Z(Lt,[{key:"getSweepEvents",value:function(){for(var Ue=[],$e=0,At=this.segments.length;$e<At;$e++){var It=this.segments[$e];Ue.push(It.leftSE),Ue.push(It.rightSE)}return Ue}}]),Lt}(),Ut=function(){function Lt(J,Ue){if(k(this,Lt),!Array.isArray(J))throw new Error("Input geometry is not a valid Polygon or MultiPolygon");this.exteriorRing=new cr(J[0],this,!0),this.bbox={ll:{x:this.exteriorRing.bbox.ll.x,y:this.exteriorRing.bbox.ll.y},ur:{x:this.exteriorRing.bbox.ur.x,y:this.exteriorRing.bbox.ur.y}},this.interiorRings=[];for(var $e=1,At=J.length;$e<At;$e++){var It=new cr(J[$e],this,!1);It.bbox.ll.x<this.bbox.ll.x&&(this.bbox.ll.x=It.bbox.ll.x),It.bbox.ll.y<this.bbox.ll.y&&(this.bbox.ll.y=It.bbox.ll.y),It.bbox.ur.x>this.bbox.ur.x&&(this.bbox.ur.x=It.bbox.ur.x),It.bbox.ur.y>this.bbox.ur.y&&(this.bbox.ur.y=It.bbox.ur.y),this.interiorRings.push(It)}this.multiPoly=Ue}return Z(Lt,[{key:"getSweepEvents",value:function(){for(var Ue=this.exteriorRing.getSweepEvents(),$e=0,At=this.interiorRings.length;$e<At;$e++)for(var It=this.interiorRings[$e].getSweepEvents(),wt=0,mr=It.length;wt<mr;wt++)Ue.push(It[wt]);return Ue}}]),Lt}(),$r=function(){function Lt(J,Ue){if(k(this,Lt),!Array.isArray(J))throw new Error("Input geometry is not a valid Polygon or MultiPolygon");try{typeof J[0][0][0]=="number"&&(J=[J])}catch(wt){}this.polys=[],this.bbox={ll:{x:Number.POSITIVE_INFINITY,y:Number.POSITIVE_INFINITY},ur:{x:Number.NEGATIVE_INFINITY,y:Number.NEGATIVE_INFINITY}};for(var $e=0,At=J.length;$e<At;$e++){var It=new Ut(J[$e],this);It.bbox.ll.x<this.bbox.ll.x&&(this.bbox.ll.x=It.bbox.ll.x),It.bbox.ll.y<this.bbox.ll.y&&(this.bbox.ll.y=It.bbox.ll.y),It.bbox.ur.x>this.bbox.ur.x&&(this.bbox.ur.x=It.bbox.ur.x),It.bbox.ur.y>this.bbox.ur.y&&(this.bbox.ur.y=It.bbox.ur.y),this.polys.push(It)}this.isSubject=Ue}return Z(Lt,[{key:"getSweepEvents",value:function(){for(var Ue=[],$e=0,At=this.polys.length;$e<At;$e++)for(var It=this.polys[$e].getSweepEvents(),wt=0,mr=It.length;wt<mr;wt++)Ue.push(It[wt]);return Ue}}]),Lt}(),ln=function(){Z(Lt,null,[{key:"factory",value:function(Ue){for(var $e=[],At=0,It=Ue.length;At<It;At++){var wt=Ue[At];if(!(!wt.isInResult()||wt.ringOut)){for(var mr=null,vt=wt.leftSE,Tt=wt.rightSE,Qt=[vt],Er=vt.point,Dr=[];mr=vt,vt=Tt,Qt.push(vt),vt.point!==Er;)for(;;){var Yr=vt.getAvailableLinkedEvents();if(Yr.length===0){var an=Qt[0].point,Br=Qt[Qt.length-1].point;throw new Error("Unable to complete output ring starting at [".concat(an.x,",")+" ".concat(an.y,"]. Last matching segment found ends at")+" [".concat(Br.x,", ").concat(Br.y,"]."))}if(Yr.length===1){Tt=Yr[0].otherSE;break}for(var en=null,Zn=0,zn=Dr.length;Zn<zn;Zn++)if(Dr[Zn].point===vt.point){en=Zn;break}if(en!==null){var fi=Dr.splice(en)[0],la=Qt.splice(fi.index);la.unshift(la[0].otherSE),$e.push(new Lt(la.reverse()));continue}Dr.push({index:Qt.length,point:vt.point});var Oa=vt.getLeftmostComparator(mr);Tt=Yr.sort(Oa)[0].otherSE;break}$e.push(new Lt(Qt))}}return $e}}]);function Lt(J){k(this,Lt),this.events=J;for(var Ue=0,$e=J.length;Ue<$e;Ue++)J[Ue].segment.ringOut=this;this.poly=null}return Z(Lt,[{key:"getGeom",value:function(){for(var Ue=this.events[0].point,$e=[Ue],At=1,It=this.events.length-1;At<It;At++){var wt=this.events[At].point,mr=this.events[At+1].point;X(wt,Ue,mr)!==0&&($e.push(wt),Ue=wt)}if($e.length===1)return null;var vt=$e[0],Tt=$e[1];X(vt,Ue,Tt)===0&&$e.shift(),$e.push($e[0]);for(var Qt=this.isExteriorRing()?1:-1,Er=this.isExteriorRing()?0:$e.length-1,Dr=this.isExteriorRing()?$e.length:-1,Yr=[],an=Er;an!=Dr;an+=Qt)Yr.push([$e[an].x,$e[an].y]);return Yr}},{key:"isExteriorRing",value:function(){if(this._isExteriorRing===void 0){var Ue=this.enclosingRing();this._isExteriorRing=Ue?!Ue.isExteriorRing():!0}return this._isExteriorRing}},{key:"enclosingRing",value:function(){return this._enclosingRing===void 0&&(this._enclosingRing=this._calcEnclosingRing()),this._enclosingRing}},{key:"_calcEnclosingRing",value:function(){for(var Ue=this.events[0],$e=1,At=this.events.length;$e<At;$e++){var It=this.events[$e];ue.compare(Ue,It)>0&&(Ue=It)}for(var wt=Ue.segment.prevInResult(),mr=wt?wt.prevInResult():null;;){if(!wt)return null;if(!mr)return wt.ringOut;if(mr.ringOut!==wt.ringOut)return mr.ringOut.enclosingRing()!==wt.ringOut?wt.ringOut:wt.ringOut.enclosingRing();wt=mr.prevInResult(),mr=wt?wt.prevInResult():null}}}]),Lt}(),Cr=function(){function Lt(J){k(this,Lt),this.exteriorRing=J,J.poly=this,this.interiorRings=[]}return Z(Lt,[{key:"addInterior",value:function(Ue){this.interiorRings.push(Ue),Ue.poly=this}},{key:"getGeom",value:function(){var Ue=[this.exteriorRing.getGeom()];if(Ue[0]===null)return null;for(var $e=0,At=this.interiorRings.length;$e<At;$e++){var It=this.interiorRings[$e].getGeom();It!==null&&Ue.push(It)}return Ue}}]),Lt}(),Qr=function(){function Lt(J){k(this,Lt),this.rings=J,this.polys=this._composePolys(J)}return Z(Lt,[{key:"getGeom",value:function(){for(var Ue=[],$e=0,At=this.polys.length;$e<At;$e++){var It=this.polys[$e].getGeom();It!==null&&Ue.push(It)}return Ue}},{key:"_composePolys",value:function(Ue){for(var $e=[],At=0,It=Ue.length;At<It;At++){var wt=Ue[At];if(!wt.poly)if(wt.isExteriorRing())$e.push(new Cr(wt));else{var mr=wt.enclosingRing();mr.poly||$e.push(new Cr(mr)),mr.poly.addInterior(wt)}}return $e}}]),Lt}(),Jr=function(){function Lt(J){var Ue=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Rt.compare;k(this,Lt),this.queue=J,this.tree=new De(Ue),this.segments=[]}return Z(Lt,[{key:"process",value:function(Ue){var $e=Ue.segment,At=[];if(Ue.consumedBy)return Ue.isLeft?this.queue.remove(Ue.otherSE):this.tree.remove($e),At;var It=Ue.isLeft?this.tree.insert($e):this.tree.find($e);if(!It)throw new Error("Unable to find segment #".concat($e.id," ")+"[".concat($e.leftSE.point.x,", ").concat($e.leftSE.point.y,"] -> ")+"[".concat($e.rightSE.point.x,", ").concat($e.rightSE.point.y,"] ")+"in SweepLine tree. Please submit a bug report.");for(var wt=It,mr=It,vt=void 0,Tt=void 0;vt===void 0;)wt=this.tree.prev(wt),wt===null?vt=null:wt.key.consumedBy===void 0&&(vt=wt.key);for(;Tt===void 0;)mr=this.tree.next(mr),mr===null?Tt=null:mr.key.consumedBy===void 0&&(Tt=mr.key);if(Ue.isLeft){var Qt=null;if(vt){var Er=vt.getIntersection($e);if(Er!==null&&($e.isAnEndpoint(Er)||(Qt=Er),!vt.isAnEndpoint(Er)))for(var Dr=this._splitSafely(vt,Er),Yr=0,an=Dr.length;Yr<an;Yr++)At.push(Dr[Yr])}var Br=null;if(Tt){var en=Tt.getIntersection($e);if(en!==null&&($e.isAnEndpoint(en)||(Br=en),!Tt.isAnEndpoint(en)))for(var Zn=this._splitSafely(Tt,en),zn=0,fi=Zn.length;zn<fi;zn++)At.push(Zn[zn])}if(Qt!==null||Br!==null){var la=null;if(Qt===null)la=Br;else if(Br===null)la=Qt;else{var Oa=ue.comparePoints(Qt,Br);la=Oa<=0?Qt:Br}this.queue.remove($e.rightSE),At.push($e.rightSE);for(var Gr=$e.split(la),Ns=0,Co=Gr.length;Ns<Co;Ns++)At.push(Gr[Ns])}At.length>0?(this.tree.remove($e),At.push(Ue)):(this.segments.push($e),$e.prev=vt)}else{if(vt&&Tt){var _n=vt.getIntersection(Tt);if(_n!==null){if(!vt.isAnEndpoint(_n))for(var xs=this._splitSafely(vt,_n),go=0,Fs=xs.length;go<Fs;go++)At.push(xs[go]);if(!Tt.isAnEndpoint(_n))for(var Po=this._splitSafely(Tt,_n),hl=0,yu=Po.length;hl<yu;hl++)At.push(Po[hl])}}this.tree.remove($e)}return At}},{key:"_splitSafely",value:function(Ue,$e){this.tree.remove(Ue);var At=Ue.rightSE;this.queue.remove(At);var It=Ue.split($e);return It.push(At),Ue.consumedBy===void 0&&this.tree.insert(Ue),It}}]),Lt}(),xr=typeof L!="undefined"&&{NODE_ENV:"production",PUBLIC_PATH:"/cruise-car-map/"}.POLYGON_CLIPPING_MAX_QUEUE_SIZE||1e6,Gn=typeof L!="undefined"&&{NODE_ENV:"production",PUBLIC_PATH:"/cruise-car-map/"}.POLYGON_CLIPPING_MAX_SWEEPLINE_SEGMENTS||1e6,ti=function(){function Lt(){k(this,Lt)}return Z(Lt,[{key:"run",value:function(Ue,$e,At){Vn.type=Ue,pe.reset();for(var It=[new $r($e,!0)],wt=0,mr=At.length;wt<mr;wt++)It.push(new $r(At[wt],!1));if(Vn.numMultiPolys=It.length,Vn.type==="difference")for(var vt=It[0],Tt=1;Tt<It.length;)Pe(It[Tt].bbox,vt.bbox)!==null?Tt++:It.splice(Tt,1);if(Vn.type==="intersection"){for(var Qt=0,Er=It.length;Qt<Er;Qt++)for(var Dr=It[Qt],Yr=Qt+1,an=It.length;Yr<an;Yr++)if(Pe(Dr.bbox,It[Yr].bbox)===null)return[]}for(var Br=new De(ue.compare),en=0,Zn=It.length;en<Zn;en++)for(var zn=It[en].getSweepEvents(),fi=0,la=zn.length;fi<la;fi++)if(Br.insert(zn[fi]),Br.size>xr)throw new Error("Infinite loop when putting segment endpoints in a priority queue (queue size too big). Please file a bug report.");for(var Oa=new Jr(Br),Gr=Br.size,Ns=Br.pop();Ns;){var Co=Ns.key;if(Br.size===Gr){var _n=Co.segment;throw new Error("Unable to pop() ".concat(Co.isLeft?"left":"right"," SweepEvent ")+"[".concat(Co.point.x,", ").concat(Co.point.y,"] from segment #").concat(_n.id," ")+"[".concat(_n.leftSE.point.x,", ").concat(_n.leftSE.point.y,"] -> ")+"[".concat(_n.rightSE.point.x,", ").concat(_n.rightSE.point.y,"] from queue. ")+"Please file a bug report.")}if(Br.size>xr)throw new Error("Infinite loop when passing sweep line over endpoints (queue size too big). Please file a bug report.");if(Oa.segments.length>Gn)throw new Error("Infinite loop when passing sweep line over endpoints (too many sweep line segments). Please file a bug report.");for(var xs=Oa.process(Co),go=0,Fs=xs.length;go<Fs;go++){var Po=xs[go];Po.consumedBy===void 0&&Br.insert(Po)}Gr=Br.size,Ns=Br.pop()}pe.reset();var hl=ln.factory(Oa.segments),yu=new Qr(hl);return yu.getGeom()}}]),Lt}(),Vn=new ti,Xr=function(J){for(var Ue=arguments.length,$e=new Array(Ue>1?Ue-1:0),At=1;At<Ue;At++)$e[At-1]=arguments[At];return Vn.run("union",J,$e)},sn=function(J){for(var Ue=arguments.length,$e=new Array(Ue>1?Ue-1:0),At=1;At<Ue;At++)$e[At-1]=arguments[At];return Vn.run("intersection",J,$e)},yn=function(J){for(var Ue=arguments.length,$e=new Array(Ue>1?Ue-1:0),At=1;At<Ue;At++)$e[At-1]=arguments[At];return Vn.run("xor",J,$e)},ki=function(J){for(var Ue=arguments.length,$e=new Array(Ue>1?Ue-1:0),At=1;At<Ue;At++)$e[At-1]=arguments[At];return Vn.run("difference",J,$e)},ri={union:Xr,intersection:sn,xor:yn,difference:ki};return ri})},65510:function(le,$,C){"use strict";le.exports=k,le.exports.default=k;var L=C(84291);function k(me,we){if(!(this instanceof k))return new k(me,we);this._maxEntries=Math.max(4,me||9),this._minEntries=Math.max(2,Math.ceil(this._maxEntries*.4)),we&&this._initFormat(we),this.clear()}k.prototype={all:function(){return this._all(this.data,[])},search:function(me){var we=this.data,ne=[],Pe=this.toBBox;if(!nt(me,we))return ne;for(var he=[],ve,te,Y,Oe;we;){for(ve=0,te=we.children.length;ve<te;ve++)Y=we.children[ve],Oe=we.leaf?Pe(Y):Y,nt(me,Oe)&&(we.leaf?ne.push(Y):Ve(me,Oe)?this._all(Y,ne):he.push(Y));we=he.pop()}return ne},collides:function(me){var we=this.data,ne=this.toBBox;if(!nt(me,we))return!1;for(var Pe=[],he,ve,te,Y;we;){for(he=0,ve=we.children.length;he<ve;he++)if(te=we.children[he],Y=we.leaf?ne(te):te,nt(me,Y)){if(we.leaf||Ve(me,Y))return!0;Pe.push(te)}we=Pe.pop()}return!1},load:function(me){if(!(me&&me.length))return this;if(me.length<this._minEntries){for(var we=0,ne=me.length;we<ne;we++)this.insert(me[we]);return this}var Pe=this._build(me.slice(),0,me.length-1,0);if(!this.data.children.length)this.data=Pe;else if(this.data.height===Pe.height)this._splitRoot(this.data,Pe);else{if(this.data.height<Pe.height){var he=this.data;this.data=Pe,Pe=he}this._insert(Pe,this.data.height-Pe.height-1,!0)}return this},insert:function(me){return me&&this._insert(me,this.data.height-1),this},clear:function(){return this.data=Ee([]),this},remove:function(me,we){if(!me)return this;for(var ne=this.data,Pe=this.toBBox(me),he=[],ve=[],te,Y,Oe,pe;ne||he.length;){if(ne||(ne=he.pop(),Y=he[he.length-1],te=ve.pop(),pe=!0),ne.leaf&&(Oe=G(me,ne.children,we),Oe!==-1))return ne.children.splice(Oe,1),he.push(ne),this._condense(he),this;!pe&&!ne.leaf&&Ve(ne,Pe)?(he.push(ne),ve.push(te),te=0,Y=ne,ne=ne.children[0]):Y?(te++,ne=Y.children[te],pe=!1):ne=null}return this},toBBox:function(me){return me},compareMinX:q,compareMinY:ee,toJSON:function(){return this.data},fromJSON:function(me){return this.data=me,this},_all:function(me,we){for(var ne=[];me;)me.leaf?we.push.apply(we,me.children):ne.push.apply(ne,me.children),me=ne.pop();return we},_build:function(me,we,ne,Pe){var he=ne-we+1,ve=this._maxEntries,te;if(he<=ve)return te=Ee(me.slice(we,ne+1)),Z(te,this.toBBox),te;Pe||(Pe=Math.ceil(Math.log(he)/Math.log(ve)),ve=Math.ceil(he/Math.pow(ve,Pe-1))),te=Ee([]),te.leaf=!1,te.height=Pe;var Y=Math.ceil(he/ve),Oe=Y*Math.ceil(Math.sqrt(ve)),pe,ye,_e,X;for(Ie(me,we,ne,Oe,this.compareMinX),pe=we;pe<=ne;pe+=Oe)for(_e=Math.min(pe+Oe-1,ne),Ie(me,pe,_e,Y,this.compareMinY),ye=pe;ye<=_e;ye+=Y)X=Math.min(ye+Y-1,_e),te.children.push(this._build(me,ye,X,Pe-1));return Z(te,this.toBBox),te},_chooseSubtree:function(me,we,ne,Pe){for(var he,ve,te,Y,Oe,pe,ye,_e;Pe.push(we),!(we.leaf||Pe.length-1===ne);){for(ye=_e=1/0,he=0,ve=we.children.length;he<ve;he++)te=we.children[he],Oe=fe(te),pe=Re(me,te)-Oe,pe<_e?(_e=pe,ye=Oe<ye?Oe:ye,Y=te):pe===_e&&Oe<ye&&(ye=Oe,Y=te);we=Y||we.children[0]}return we},_insert:function(me,we,ne){var Pe=this.toBBox,he=ne?me:Pe(me),ve=[],te=this._chooseSubtree(he,this.data,we,ve);for(te.children.push(me),z(te,he);we>=0&&ve[we].children.length>this._maxEntries;)this._split(ve,we),we--;this._adjustParentBBoxes(he,ve,we)},_split:function(me,we){var ne=me[we],Pe=ne.children.length,he=this._minEntries;this._chooseSplitAxis(ne,he,Pe);var ve=this._chooseSplitIndex(ne,he,Pe),te=Ee(ne.children.splice(ve,ne.children.length-ve));te.height=ne.height,te.leaf=ne.leaf,Z(ne,this.toBBox),Z(te,this.toBBox),we?me[we-1].children.push(te):this._splitRoot(ne,te)},_splitRoot:function(me,we){this.data=Ee([me,we]),this.data.height=me.height+1,this.data.leaf=!1,Z(this.data,this.toBBox)},_chooseSplitIndex:function(me,we,ne){var Pe,he,ve,te,Y,Oe,pe,ye;for(Oe=pe=1/0,Pe=we;Pe<=ne-we;Pe++)he=F(me,0,Pe,this.toBBox),ve=F(me,Pe,ne,this.toBBox),te=De(he,ve),Y=fe(he)+fe(ve),te<Oe?(Oe=te,ye=Pe,pe=Y<pe?Y:pe):te===Oe&&Y<pe&&(pe=Y,ye=Pe);return ye},_chooseSplitAxis:function(me,we,ne){var Pe=me.leaf?this.compareMinX:q,he=me.leaf?this.compareMinY:ee,ve=this._allDistMargin(me,we,ne,Pe),te=this._allDistMargin(me,we,ne,he);ve<te&&me.children.sort(Pe)},_allDistMargin:function(me,we,ne,Pe){me.children.sort(Pe);var he=this.toBBox,ve=F(me,0,we,he),te=F(me,ne-we,ne,he),Y=Se(ve)+Se(te),Oe,pe;for(Oe=we;Oe<ne-we;Oe++)pe=me.children[Oe],z(ve,me.leaf?he(pe):pe),Y+=Se(ve);for(Oe=ne-we-1;Oe>=we;Oe--)pe=me.children[Oe],z(te,me.leaf?he(pe):pe),Y+=Se(te);return Y},_adjustParentBBoxes:function(me,we,ne){for(var Pe=ne;Pe>=0;Pe--)z(we[Pe],me)},_condense:function(me){for(var we=me.length-1,ne;we>=0;we--)me[we].children.length===0?we>0?(ne=me[we-1].children,ne.splice(ne.indexOf(me[we]),1)):this.clear():Z(me[we],this.toBBox)},_initFormat:function(me){var we=["return a"," - b",";"];this.compareMinX=new Function("a","b",we.join(me[0])),this.compareMinY=new Function("a","b",we.join(me[1])),this.toBBox=new Function("a","return {minX: a"+me[0]+", minY: a"+me[1]+", maxX: a"+me[2]+", maxY: a"+me[3]+"};")}};function G(me,we,ne){if(!ne)return we.indexOf(me);for(var Pe=0;Pe<we.length;Pe++)if(ne(me,we[Pe]))return Pe;return-1}function Z(me,we){F(me,0,me.children.length,we,me)}function F(me,we,ne,Pe,he){he||(he=Ee(null)),he.minX=1/0,he.minY=1/0,he.maxX=-1/0,he.maxY=-1/0;for(var ve=we,te;ve<ne;ve++)te=me.children[ve],z(he,me.leaf?Pe(te):te);return he}function z(me,we){return me.minX=Math.min(me.minX,we.minX),me.minY=Math.min(me.minY,we.minY),me.maxX=Math.max(me.maxX,we.maxX),me.maxY=Math.max(me.maxY,we.maxY),me}function q(me,we){return me.minX-we.minX}function ee(me,we){return me.minY-we.minY}function fe(me){return(me.maxX-me.minX)*(me.maxY-me.minY)}function Se(me){return me.maxX-me.minX+(me.maxY-me.minY)}function Re(me,we){return(Math.max(we.maxX,me.maxX)-Math.min(we.minX,me.minX))*(Math.max(we.maxY,me.maxY)-Math.min(we.minY,me.minY))}function De(me,we){var ne=Math.max(me.minX,we.minX),Pe=Math.max(me.minY,we.minY),he=Math.min(me.maxX,we.maxX),ve=Math.min(me.maxY,we.maxY);return Math.max(0,he-ne)*Math.max(0,ve-Pe)}function Ve(me,we){return me.minX<=we.minX&&me.minY<=we.minY&&we.maxX<=me.maxX&&we.maxY<=me.maxY}function nt(me,we){return we.minX<=me.maxX&&we.minY<=me.maxY&&we.maxX>=me.minX&&we.maxY>=me.minY}function Ee(me){return{children:me,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function Ie(me,we,ne,Pe,he){for(var ve=[we,ne],te;ve.length;)ne=ve.pop(),we=ve.pop(),!(ne-we<=Pe)&&(te=we+Math.ceil((ne-we)/Pe/2)*Pe,L(me,te,we,ne,he),ve.push(we,te,te,ne))}},84291:function(le){(function($,C){le.exports=C()})(this,function(){"use strict";function $(G,Z,F,z,q){C(G,Z,F||0,z||G.length-1,q||k)}function C(G,Z,F,z,q){for(;z>F;){if(z-F>600){var ee=z-F+1,fe=Z-F+1,Se=Math.log(ee),Re=.5*Math.exp(2*Se/3),De=.5*Math.sqrt(Se*Re*(ee-Re)/ee)*(fe-ee/2<0?-1:1),Ve=Math.max(F,Math.floor(Z-fe*Re/ee+De)),nt=Math.min(z,Math.floor(Z+(ee-fe)*Re/ee+De));C(G,Z,Ve,nt,q)}var Ee=G[Z],Ie=F,me=z;for(L(G,F,Z),q(G[z],Ee)>0&&L(G,F,z);Ie<me;){for(L(G,Ie,me),Ie++,me--;q(G[Ie],Ee)<0;)Ie++;for(;q(G[me],Ee)>0;)me--}q(G[F],Ee)===0?L(G,F,me):(me++,L(G,me,z)),me<=Z&&(F=me+1),Z<=me&&(z=me-1)}}function L(G,Z,F){var z=G[Z];G[Z]=G[F],G[F]=z}function k(G,Z){return G<Z?-1:G>Z?1:0}return $})},28660:function(le,$,C){var L=C(34155);var k;(function(G){(function(Z){var F=typeof C.g=="object"?C.g:typeof self=="object"?self:typeof this=="object"?this:Function("return this;")(),z=q(G);typeof F.Reflect=="undefined"?F.Reflect=G:z=q(F.Reflect,z),Z(z);function q(ee,fe){return function(Se,Re){typeof ee[Se]!="function"&&Object.defineProperty(ee,Se,{configurable:!0,writable:!0,value:Re}),fe&&fe(Se,Re)}}})(function(Z){var F=Object.prototype.hasOwnProperty,z=typeof Symbol=="function",q=z&&typeof Symbol.toPrimitive!="undefined"?Symbol.toPrimitive:"@@toPrimitive",ee=z&&typeof Symbol.iterator!="undefined"?Symbol.iterator:"@@iterator",fe=typeof Object.create=="function",Se={__proto__:[]}instanceof Array,Re=!fe&&!Se,De={create:fe?function(){return mr(Object.create(null))}:Se?function(){return mr({__proto__:null})}:function(){return mr({})},has:Re?function(vt,Tt){return F.call(vt,Tt)}:function(vt,Tt){return Tt in vt},get:Re?function(vt,Tt){return F.call(vt,Tt)?vt[Tt]:void 0}:function(vt,Tt){return vt[Tt]}},Ve=Object.getPrototypeOf(Function),nt=typeof L=="object"&&{NODE_ENV:"production",PUBLIC_PATH:"/cruise-car-map/"}&&{NODE_ENV:"production",PUBLIC_PATH:"/cruise-car-map/"}.REFLECT_METADATA_USE_MAP_POLYFILL==="true",Ee=!nt&&typeof Map=="function"&&typeof Map.prototype.entries=="function"?Map:At(),Ie=!nt&&typeof Set=="function"&&typeof Set.prototype.entries=="function"?Set:It(),me=!nt&&typeof WeakMap=="function"?WeakMap:wt(),we=new me;function ne(vt,Tt,Qt,Er){if(Ut(Qt)){if(!Vn(vt))throw new TypeError;if(!sn(Tt))throw new TypeError;return X(vt,Tt)}else{if(!Vn(vt))throw new TypeError;if(!Cr(Tt))throw new TypeError;if(!Cr(Er)&&!Ut(Er)&&!$r(Er))throw new TypeError;return $r(Er)&&(Er=void 0),Qt=ti(Qt),Le(vt,Tt,Qt,Er)}}Z("decorate",ne);function Pe(vt,Tt){function Qt(Er,Dr){if(!Cr(Er))throw new TypeError;if(!Ut(Dr)&&!yn(Dr))throw new TypeError;ue(vt,Tt,Er,Dr)}return Qt}Z("metadata",Pe);function he(vt,Tt,Qt,Er){if(!Cr(Qt))throw new TypeError;return Ut(Er)||(Er=ti(Er)),ue(vt,Tt,Qt,Er)}Z("defineMetadata",he);function ve(vt,Tt,Qt){if(!Cr(Tt))throw new TypeError;return Ut(Qt)||(Qt=ti(Qt)),be(vt,Tt,Qt)}Z("hasMetadata",ve);function te(vt,Tt,Qt){if(!Cr(Tt))throw new TypeError;return Ut(Qt)||(Qt=ti(Qt)),se(vt,Tt,Qt)}Z("hasOwnMetadata",te);function Y(vt,Tt,Qt){if(!Cr(Tt))throw new TypeError;return Ut(Qt)||(Qt=ti(Qt)),Ne(vt,Tt,Qt)}Z("getMetadata",Y);function Oe(vt,Tt,Qt){if(!Cr(Tt))throw new TypeError;return Ut(Qt)||(Qt=ti(Qt)),ze(vt,Tt,Qt)}Z("getOwnMetadata",Oe);function pe(vt,Tt){if(!Cr(vt))throw new TypeError;return Ut(Tt)||(Tt=ti(Tt)),kt(vt,Tt)}Z("getMetadataKeys",pe);function ye(vt,Tt){if(!Cr(vt))throw new TypeError;return Ut(Tt)||(Tt=ti(Tt)),Rt(vt,Tt)}Z("getOwnMetadataKeys",ye);function _e(vt,Tt,Qt){if(!Cr(Tt))throw new TypeError;Ut(Qt)||(Qt=ti(Qt));var Er=de(Tt,Qt,!1);if(Ut(Er)||!Er.delete(vt))return!1;if(Er.size>0)return!0;var Dr=we.get(Tt);return Dr.delete(Qt),Dr.size>0||we.delete(Tt),!0}Z("deleteMetadata",_e);function X(vt,Tt){for(var Qt=vt.length-1;Qt>=0;--Qt){var Er=vt[Qt],Dr=Er(Tt);if(!Ut(Dr)&&!$r(Dr)){if(!sn(Dr))throw new TypeError;Tt=Dr}}return Tt}function Le(vt,Tt,Qt,Er){for(var Dr=vt.length-1;Dr>=0;--Dr){var Yr=vt[Dr],an=Yr(Tt,Qt,Er);if(!Ut(an)&&!$r(an)){if(!Cr(an))throw new TypeError;Er=an}}return Er}function de(vt,Tt,Qt){var Er=we.get(vt);if(Ut(Er)){if(!Qt)return;Er=new Ee,we.set(vt,Er)}var Dr=Er.get(Tt);if(Ut(Dr)){if(!Qt)return;Dr=new Ee,Er.set(Tt,Dr)}return Dr}function be(vt,Tt,Qt){var Er=se(vt,Tt,Qt);if(Er)return!0;var Dr=$e(Tt);return $r(Dr)?!1:be(vt,Dr,Qt)}function se(vt,Tt,Qt){var Er=de(Tt,Qt,!1);return Ut(Er)?!1:xr(Er.has(vt))}function Ne(vt,Tt,Qt){var Er=se(vt,Tt,Qt);if(Er)return ze(vt,Tt,Qt);var Dr=$e(Tt);if(!$r(Dr))return Ne(vt,Dr,Qt)}function ze(vt,Tt,Qt){var Er=de(Tt,Qt,!1);if(!Ut(Er))return Er.get(vt)}function ue(vt,Tt,Qt,Er){var Dr=de(Qt,Er,!0);Dr.set(vt,Tt)}function kt(vt,Tt){var Qt=Rt(vt,Tt),Er=$e(vt);if(Er===null)return Qt;var Dr=kt(Er,Tt);if(Dr.length<=0)return Qt;if(Qt.length<=0)return Dr;for(var Yr=new Ie,an=[],Br=0,en=Qt;Br<en.length;Br++){var Zn=en[Br],zn=Yr.has(Zn);zn||(Yr.add(Zn),an.push(Zn))}for(var fi=0,la=Dr;fi<la.length;fi++){var Zn=la[fi],zn=Yr.has(Zn);zn||(Yr.add(Zn),an.push(Zn))}return an}function Rt(vt,Tt){var Qt=[],Er=de(vt,Tt,!1);if(Ut(Er))return Qt;for(var Dr=Er.keys(),Yr=ri(Dr),an=0;;){var Br=J(Yr);if(!Br)return Qt.length=an,Qt;var en=Lt(Br);try{Qt[an]=en}catch(Zn){try{Ue(Yr)}finally{throw Zn}}an++}}function cr(vt){if(vt===null)return 1;switch(typeof vt){case"undefined":return 0;case"boolean":return 2;case"string":return 3;case"symbol":return 4;case"number":return 5;case"object":return vt===null?1:6;default:return 6}}function Ut(vt){return vt===void 0}function $r(vt){return vt===null}function ln(vt){return typeof vt=="symbol"}function Cr(vt){return typeof vt=="object"?vt!==null:typeof vt=="function"}function Qr(vt,Tt){switch(cr(vt)){case 0:return vt;case 1:return vt;case 2:return vt;case 3:return vt;case 4:return vt;case 5:return vt}var Qt=Tt===3?"string":Tt===5?"number":"default",Er=ki(vt,q);if(Er!==void 0){var Dr=Er.call(vt,Qt);if(Cr(Dr))throw new TypeError;return Dr}return Jr(vt,Qt==="default"?"number":Qt)}function Jr(vt,Tt){if(Tt==="string"){var Qt=vt.toString;if(Xr(Qt)){var Er=Qt.call(vt);if(!Cr(Er))return Er}var Dr=vt.valueOf;if(Xr(Dr)){var Er=Dr.call(vt);if(!Cr(Er))return Er}}else{var Dr=vt.valueOf;if(Xr(Dr)){var Er=Dr.call(vt);if(!Cr(Er))return Er}var Yr=vt.toString;if(Xr(Yr)){var Er=Yr.call(vt);if(!Cr(Er))return Er}}throw new TypeError}function xr(vt){return!!vt}function Gn(vt){return""+vt}function ti(vt){var Tt=Qr(vt,3);return ln(Tt)?Tt:Gn(Tt)}function Vn(vt){return Array.isArray?Array.isArray(vt):vt instanceof Object?vt instanceof Array:Object.prototype.toString.call(vt)==="[object Array]"}function Xr(vt){return typeof vt=="function"}function sn(vt){return typeof vt=="function"}function yn(vt){switch(cr(vt)){case 3:return!0;case 4:return!0;default:return!1}}function ki(vt,Tt){var Qt=vt[Tt];if(Qt!=null){if(!Xr(Qt))throw new TypeError;return Qt}}function ri(vt){var Tt=ki(vt,ee);if(!Xr(Tt))throw new TypeError;var Qt=Tt.call(vt);if(!Cr(Qt))throw new TypeError;return Qt}function Lt(vt){return vt.value}function J(vt){var Tt=vt.next();return Tt.done?!1:Tt}function Ue(vt){var Tt=vt.return;Tt&&Tt.call(vt)}function $e(vt){var Tt=Object.getPrototypeOf(vt);if(typeof vt!="function"||vt===Ve||Tt!==Ve)return Tt;var Qt=vt.prototype,Er=Qt&&Object.getPrototypeOf(Qt);if(Er==null||Er===Object.prototype)return Tt;var Dr=Er.constructor;return typeof Dr!="function"||Dr===vt?Tt:Dr}function At(){var vt={},Tt=[],Qt=function(){function an(Br,en,Zn){this._index=0,this._keys=Br,this._values=en,this._selector=Zn}return an.prototype["@@iterator"]=function(){return this},an.prototype[ee]=function(){return this},an.prototype.next=function(){var Br=this._index;if(Br>=0&&Br<this._keys.length){var en=this._selector(this._keys[Br],this._values[Br]);return Br+1>=this._keys.length?(this._index=-1,this._keys=Tt,this._values=Tt):this._index++,{value:en,done:!1}}return{value:void 0,done:!0}},an.prototype.throw=function(Br){throw this._index>=0&&(this._index=-1,this._keys=Tt,this._values=Tt),Br},an.prototype.return=function(Br){return this._index>=0&&(this._index=-1,this._keys=Tt,this._values=Tt),{value:Br,done:!0}},an}();return function(){function an(){this._keys=[],this._values=[],this._cacheKey=vt,this._cacheIndex=-2}return Object.defineProperty(an.prototype,"size",{get:function(){return this._keys.length},enumerable:!0,configurable:!0}),an.prototype.has=function(Br){return this._find(Br,!1)>=0},an.prototype.get=function(Br){var en=this._find(Br,!1);return en>=0?this._values[en]:void 0},an.prototype.set=function(Br,en){var Zn=this._find(Br,!0);return this._values[Zn]=en,this},an.prototype.delete=function(Br){var en=this._find(Br,!1);if(en>=0){for(var Zn=this._keys.length,zn=en+1;zn<Zn;zn++)this._keys[zn-1]=this._keys[zn],this._values[zn-1]=this._values[zn];return this._keys.length--,this._values.length--,Br===this._cacheKey&&(this._cacheKey=vt,this._cacheIndex=-2),!0}return!1},an.prototype.clear=function(){this._keys.length=0,this._values.length=0,this._cacheKey=vt,this._cacheIndex=-2},an.prototype.keys=function(){return new Qt(this._keys,this._values,Er)},an.prototype.values=function(){return new Qt(this._keys,this._values,Dr)},an.prototype.entries=function(){return new Qt(this._keys,this._values,Yr)},an.prototype["@@iterator"]=function(){return this.entries()},an.prototype[ee]=function(){return this.entries()},an.prototype._find=function(Br,en){return this._cacheKey!==Br&&(this._cacheIndex=this._keys.indexOf(this._cacheKey=Br)),this._cacheIndex<0&&en&&(this._cacheIndex=this._keys.length,this._keys.push(Br),this._values.push(void 0)),this._cacheIndex},an}();function Er(an,Br){return an}function Dr(an,Br){return Br}function Yr(an,Br){return[an,Br]}}function It(){return function(){function vt(){this._map=new Ee}return Object.defineProperty(vt.prototype,"size",{get:function(){return this._map.size},enumerable:!0,configurable:!0}),vt.prototype.has=function(Tt){return this._map.has(Tt)},vt.prototype.add=function(Tt){return this._map.set(Tt,Tt),this},vt.prototype.delete=function(Tt){return this._map.delete(Tt)},vt.prototype.clear=function(){this._map.clear()},vt.prototype.keys=function(){return this._map.keys()},vt.prototype.values=function(){return this._map.values()},vt.prototype.entries=function(){return this._map.entries()},vt.prototype["@@iterator"]=function(){return this.keys()},vt.prototype[ee]=function(){return this.keys()},vt}()}function wt(){var vt=16,Tt=De.create(),Qt=Er();return function(){function en(){this._key=Er()}return en.prototype.has=function(Zn){var zn=Dr(Zn,!1);return zn!==void 0?De.has(zn,this._key):!1},en.prototype.get=function(Zn){var zn=Dr(Zn,!1);return zn!==void 0?De.get(zn,this._key):void 0},en.prototype.set=function(Zn,zn){var fi=Dr(Zn,!0);return fi[this._key]=zn,this},en.prototype.delete=function(Zn){var zn=Dr(Zn,!1);return zn!==void 0?delete zn[this._key]:!1},en.prototype.clear=function(){this._key=Er()},en}();function Er(){var en;do en="@@WeakMap@@"+Br();while(De.has(Tt,en));return Tt[en]=!0,en}function Dr(en,Zn){if(!F.call(en,Qt)){if(!Zn)return;Object.defineProperty(en,Qt,{value:De.create()})}return en[Qt]}function Yr(en,Zn){for(var zn=0;zn<Zn;++zn)en[zn]=Math.random()*255|0;return en}function an(en){return typeof Uint8Array=="function"?typeof crypto!="undefined"?crypto.getRandomValues(new Uint8Array(en)):typeof msCrypto!="undefined"?msCrypto.getRandomValues(new Uint8Array(en)):Yr(new Uint8Array(en),en):Yr(new Array(en),en)}function Br(){var en=an(vt);en[6]=en[6]&79|64,en[8]=en[8]&191|128;for(var Zn="",zn=0;zn<vt;++zn){var fi=en[zn];(zn===4||zn===6||zn===8)&&(Zn+="-"),fi<16&&(Zn+="0"),Zn+=fi.toString(16).toLowerCase()}return Zn}}function mr(vt){return vt.__=void 0,delete vt.__,vt}})})(k||(k={}))},53697:function(le,$,C){"use strict";var L=C(58052),k=Object,G=TypeError;le.exports=L(function(){if(this!=null&&this!==k(this))throw new G("RegExp.prototype.flags getter called on non-object");var F="";return this.hasIndices&&(F+="d"),this.global&&(F+="g"),this.ignoreCase&&(F+="i"),this.multiline&&(F+="m"),this.dotAll&&(F+="s"),this.unicode&&(F+="u"),this.unicodeSets&&(F+="v"),this.sticky&&(F+="y"),F},"get flags",!0)},2847:function(le,$,C){"use strict";var L=C(4289),k=C(55559),G=C(53697),Z=C(71721),F=C(32753),z=k(Z());L(z,{getPolyfill:Z,implementation:G,shim:F}),le.exports=z},71721:function(le,$,C){"use strict";var L=C(53697),k=C(4289).supportsDescriptors,G=Object.getOwnPropertyDescriptor;le.exports=function(){if(k&&/a/mig.flags==="gim"){var F=G(RegExp.prototype,"flags");if(F&&typeof F.get=="function"&&typeof RegExp.prototype.dotAll=="boolean"&&typeof RegExp.prototype.hasIndices=="boolean"){var z="",q={};if(Object.defineProperty(q,"hasIndices",{get:function(){z+="d"}}),Object.defineProperty(q,"sticky",{get:function(){z+="y"}}),z==="dy")return F.get}}return L}},32753:function(le,$,C){"use strict";var L=C(4289).supportsDescriptors,k=C(71721),G=Object.getOwnPropertyDescriptor,Z=Object.defineProperty,F=TypeError,z=Object.getPrototypeOf,q=/a/;le.exports=function(){if(!L||!z)throw new F("RegExp.prototype.flags requires a true ES5 environment that supports property descriptors");var fe=k(),Se=z(q),Re=G(Se,"flags");return(!Re||Re.get!==fe)&&Z(Se,"flags",{configurable:!0,enumerable:!1,get:fe}),fe}},81550:function(le){(function($,C){le.exports=C()})(this,function(){"use strict";var $=function(Ce){return Ce instanceof Uint8Array||Ce instanceof Uint16Array||Ce instanceof Uint32Array||Ce instanceof Int8Array||Ce instanceof Int16Array||Ce instanceof Int32Array||Ce instanceof Float32Array||Ce instanceof Float64Array||Ce instanceof Uint8ClampedArray},C=function(Ce,Qe){for(var mt=Object.keys(Qe),nr=0;nr<mt.length;++nr)Ce[mt[nr]]=Qe[mt[nr]];return Ce},L=`
`;function k(Ce){return typeof atob!="undefined"?atob(Ce):"base64:"+Ce}function G(Ce){var Qe=new Error("(regl) "+Ce);throw console.error(Qe),Qe}function Z(Ce,Qe){Ce||G(Qe)}function F(Ce){return Ce?": "+Ce:""}function z(Ce,Qe,mt){Ce in Qe||G("unknown parameter ("+Ce+")"+F(mt)+". possible values: "+Object.keys(Qe).join())}function q(Ce,Qe){$(Ce)||G("invalid parameter type"+F(Qe)+". must be a typed array")}function ee(Ce,Qe){switch(Qe){case"number":return typeof Ce=="number";case"object":return typeof Ce=="object";case"string":return typeof Ce=="string";case"boolean":return typeof Ce=="boolean";case"function":return typeof Ce=="function";case"undefined":return typeof Ce=="undefined";case"symbol":return typeof Ce=="symbol"}}function fe(Ce,Qe,mt){ee(Ce,Qe)||G("invalid parameter type"+F(mt)+". expected "+Qe+", got "+typeof Ce)}function Se(Ce,Qe){Ce>=0&&(Ce|0)===Ce||G("invalid parameter type, ("+Ce+")"+F(Qe)+". must be a nonnegative integer")}function Re(Ce,Qe,mt){Qe.indexOf(Ce)<0&&G("invalid value"+F(mt)+". must be one of: "+Qe)}var De=["gl","canvas","container","attributes","pixelRatio","extensions","optionalExtensions","profile","onDone"];function Ve(Ce){Object.keys(Ce).forEach(function(Qe){De.indexOf(Qe)<0&&G('invalid regl constructor argument "'+Qe+'". must be one of '+De)})}function nt(Ce,Qe){for(Ce=Ce+"";Ce.length<Qe;)Ce=" "+Ce;return Ce}function Ee(){this.name="unknown",this.lines=[],this.index={},this.hasErrors=!1}function Ie(Ce,Qe){this.number=Ce,this.line=Qe,this.errors=[]}function me(Ce,Qe,mt){this.file=Ce,this.line=Qe,this.message=mt}function we(){var Ce=new Error,Qe=(Ce.stack||Ce).toString(),mt=/compileProcedure.*\n\s*at.*\((.*)\)/.exec(Qe);if(mt)return mt[1];var nr=/compileProcedure.*\n\s*at\s+(.*)(\n|$)/.exec(Qe);return nr?nr[1]:"unknown"}function ne(){var Ce=new Error,Qe=(Ce.stack||Ce).toString(),mt=/at REGLCommand.*\n\s+at.*\((.*)\)/.exec(Qe);if(mt)return mt[1];var nr=/at REGLCommand.*\n\s+at\s+(.*)\n/.exec(Qe);return nr?nr[1]:"unknown"}function Pe(Ce,Qe){var mt=Ce.split(`
`),nr=1,Ar=0,er={unknown:new Ee,0:new Ee};er.unknown.name=er[0].name=Qe||we(),er.unknown.lines.push(new Ie(0,""));for(var sr=0;sr<mt.length;++sr){var Tr=mt[sr],Lr=/^\s*#\s*(\w+)\s+(.+)\s*$/.exec(Tr);if(Lr)switch(Lr[1]){case"line":var Nr=/(\d+)(\s+\d+)?/.exec(Lr[2]);Nr&&(nr=Nr[1]|0,Nr[2]&&(Ar=Nr[2]|0,Ar in er||(er[Ar]=new Ee)));break;case"define":var kr=/SHADER_NAME(_B64)?\s+(.*)$/.exec(Lr[2]);kr&&(er[Ar].name=kr[1]?k(kr[2]):kr[2]);break}er[Ar].lines.push(new Ie(nr++,Tr))}return Object.keys(er).forEach(function(Or){var qr=er[Or];qr.lines.forEach(function(Mr){qr.index[Mr.number]=Mr})}),er}function he(Ce){var Qe=[];return Ce.split(`
`).forEach(function(mt){if(!(mt.length<5)){var nr=/^ERROR:\s+(\d+):(\d+):\s*(.*)$/.exec(mt);nr?Qe.push(new me(nr[1]|0,nr[2]|0,nr[3].trim())):mt.length>0&&Qe.push(new me("unknown",0,mt))}}),Qe}function ve(Ce,Qe){Qe.forEach(function(mt){var nr=Ce[mt.file];if(nr){var Ar=nr.index[mt.line];if(Ar){Ar.errors.push(mt),nr.hasErrors=!0;return}}Ce.unknown.hasErrors=!0,Ce.unknown.lines[0].errors.push(mt)})}function te(Ce,Qe,mt,nr,Ar){if(!Ce.getShaderParameter(Qe,Ce.COMPILE_STATUS)){var er=Ce.getShaderInfoLog(Qe),sr=nr===Ce.FRAGMENT_SHADER?"fragment":"vertex";Le(mt,"string",sr+" shader source must be a string",Ar);var Tr=Pe(mt,Ar),Lr=he(er);ve(Tr,Lr),Object.keys(Tr).forEach(function(Nr){var kr=Tr[Nr];if(!kr.hasErrors)return;var Or=[""],qr=[""];function Mr(zr,Vt){Or.push(zr),qr.push(Vt||"")}Mr("file number "+Nr+": "+kr.name+`
`,"color:red;text-decoration:underline;font-weight:bold"),kr.lines.forEach(function(zr){if(zr.errors.length>0){Mr(nt(zr.number,4)+"|  ","background-color:yellow; font-weight:bold"),Mr(zr.line+L,"color:red; background-color:yellow; font-weight:bold");var Vt=0;zr.errors.forEach(function(lr){var Rr=lr.message,tn=/^\s*'(.*)'\s*:\s*(.*)$/.exec(Rr);if(tn){var _r=tn[1];switch(Rr=tn[2],_r){case"assign":_r="=";break}Vt=Math.max(zr.line.indexOf(_r,Vt),0)}else Vt=0;Mr(nt("| ",6)),Mr(nt("^^^",Vt+3)+L,"font-weight:bold"),Mr(nt("| ",6)),Mr(Rr+L,"font-weight:bold")}),Mr(nt("| ",6)+L)}else Mr(nt(zr.number,4)+"|  "),Mr(zr.line+L,"color:red")}),typeof document!="undefined"&&!window.chrome?(qr[0]=Or.join("%c"),console.log.apply(console,qr)):console.log(Or.join(""))}),Z.raise("Error compiling "+sr+" shader, "+Tr[0].name)}}function Y(Ce,Qe,mt,nr,Ar){if(!Ce.getProgramParameter(Qe,Ce.LINK_STATUS)){var er=Ce.getProgramInfoLog(Qe),sr=Pe(mt,Ar),Tr=Pe(nr,Ar),Lr='Error linking program with vertex shader, "'+Tr[0].name+'", and fragment shader "'+sr[0].name+'"';typeof document!="undefined"?console.log("%c"+Lr+L+"%c"+er,"color:red;text-decoration:underline;font-weight:bold","color:red"):console.log(Lr+L+er),Z.raise(Lr)}}function Oe(Ce){Ce._commandRef=we()}function pe(Ce,Qe,mt,nr){Oe(Ce);function Ar(Lr){return Lr?nr.id(Lr):0}Ce._fragId=Ar(Ce.static.frag),Ce._vertId=Ar(Ce.static.vert);function er(Lr,Nr){Object.keys(Nr).forEach(function(kr){Lr[nr.id(kr)]=!0})}var sr=Ce._uniformSet={};er(sr,Qe.static),er(sr,Qe.dynamic);var Tr=Ce._attributeSet={};er(Tr,mt.static),er(Tr,mt.dynamic),Ce._hasCount="count"in Ce.static||"count"in Ce.dynamic||"elements"in Ce.static||"elements"in Ce.dynamic}function ye(Ce,Qe){var mt=ne();G(Ce+" in command "+(Qe||we())+(mt==="unknown"?"":" called from "+mt))}function _e(Ce,Qe,mt){Ce||ye(Qe,mt||we())}function X(Ce,Qe,mt,nr){Ce in Qe||ye("unknown parameter ("+Ce+")"+F(mt)+". possible values: "+Object.keys(Qe).join(),nr||we())}function Le(Ce,Qe,mt,nr){ee(Ce,Qe)||ye("invalid parameter type"+F(mt)+". expected "+Qe+", got "+typeof Ce,nr||we())}function de(Ce){Ce()}function be(Ce,Qe,mt){Ce.texture?Re(Ce.texture._texture.internalformat,Qe,"unsupported texture format for attachment"):Re(Ce.renderbuffer._renderbuffer.format,mt,"unsupported renderbuffer format for attachment")}var se=33071,Ne=9728,ze=9984,ue=9985,kt=9986,Rt=9987,cr=5120,Ut=5121,$r=5122,ln=5123,Cr=5124,Qr=5125,Jr=5126,xr=32819,Gn=32820,ti=33635,Vn=34042,Xr=36193,sn={};sn[cr]=sn[Ut]=1,sn[$r]=sn[ln]=sn[Xr]=sn[ti]=sn[xr]=sn[Gn]=2,sn[Cr]=sn[Qr]=sn[Jr]=sn[Vn]=4;function yn(Ce,Qe){return Ce===Gn||Ce===xr||Ce===ti?2:Ce===Vn?4:sn[Ce]*Qe}function ki(Ce){return!(Ce&Ce-1)&&!!Ce}function ri(Ce,Qe,mt){var nr,Ar=Qe.width,er=Qe.height,sr=Qe.channels;Z(Ar>0&&Ar<=mt.maxTextureSize&&er>0&&er<=mt.maxTextureSize,"invalid texture shape"),(Ce.wrapS!==se||Ce.wrapT!==se)&&Z(ki(Ar)&&ki(er),"incompatible wrap mode for texture, both width and height must be power of 2"),Qe.mipmask===1?Ar!==1&&er!==1&&Z(Ce.minFilter!==ze&&Ce.minFilter!==kt&&Ce.minFilter!==ue&&Ce.minFilter!==Rt,"min filter requires mipmap"):(Z(ki(Ar)&&ki(er),"texture must be a square power of 2 to support mipmapping"),Z(Qe.mipmask===(Ar<<1)-1,"missing or incomplete mipmap data")),Qe.type===Jr&&(mt.extensions.indexOf("oes_texture_float_linear")<0&&Z(Ce.minFilter===Ne&&Ce.magFilter===Ne,"filter not supported, must enable oes_texture_float_linear"),Z(!Ce.genMipmaps,"mipmap generation not supported with float textures"));var Tr=Qe.images;for(nr=0;nr<16;++nr)if(Tr[nr]){var Lr=Ar>>nr,Nr=er>>nr;Z(Qe.mipmask&1<<nr,"missing mipmap data");var kr=Tr[nr];if(Z(kr.width===Lr&&kr.height===Nr,"invalid shape for mip images"),Z(kr.format===Qe.format&&kr.internalformat===Qe.internalformat&&kr.type===Qe.type,"incompatible type for mip image"),!kr.compressed)if(kr.data){var Or=Math.ceil(yn(kr.type,sr)*Lr/kr.unpackAlignment)*kr.unpackAlignment;Z(kr.data.byteLength===Or*Nr,"invalid data for image, buffer size is inconsistent with image format")}else kr.element||kr.copy}else Ce.genMipmaps||Z((Qe.mipmask&1<<nr)===0,"extra mipmap data");Qe.compressed&&Z(!Ce.genMipmaps,"mipmap generation for compressed images not supported")}function Lt(Ce,Qe,mt,nr){var Ar=Ce.width,er=Ce.height,sr=Ce.channels;Z(Ar>0&&Ar<=nr.maxTextureSize&&er>0&&er<=nr.maxTextureSize,"invalid texture shape"),Z(Ar===er,"cube map must be square"),Z(Qe.wrapS===se&&Qe.wrapT===se,"wrap mode not supported by cube map");for(var Tr=0;Tr<mt.length;++Tr){var Lr=mt[Tr];Z(Lr.width===Ar&&Lr.height===er,"inconsistent cube map face shape"),Qe.genMipmaps&&(Z(!Lr.compressed,"can not generate mipmap for compressed textures"),Z(Lr.mipmask===1,"can not specify mipmaps and generate mipmaps"));for(var Nr=Lr.images,kr=0;kr<16;++kr){var Or=Nr[kr];if(Or){var qr=Ar>>kr,Mr=er>>kr;Z(Lr.mipmask&1<<kr,"missing mipmap data"),Z(Or.width===qr&&Or.height===Mr,"invalid shape for mip images"),Z(Or.format===Ce.format&&Or.internalformat===Ce.internalformat&&Or.type===Ce.type,"incompatible type for mip image"),Or.compressed||(Or.data?Z(Or.data.byteLength===qr*Mr*Math.max(yn(Or.type,sr),Or.unpackAlignment),"invalid data for image, buffer size is inconsistent with image format"):Or.element||Or.copy)}}}}var J=C(Z,{optional:de,raise:G,commandRaise:ye,command:_e,parameter:z,commandParameter:X,constructor:Ve,type:fe,commandType:Le,isTypedArray:q,nni:Se,oneOf:Re,shaderError:te,linkError:Y,callSite:ne,saveCommandRef:Oe,saveDrawInfo:pe,framebufferFormat:be,guessCommand:we,texture2D:ri,textureCube:Lt}),Ue=0,$e=0,At=5,It=6;function wt(Ce,Qe){this.id=Ue++,this.type=Ce,this.data=Qe}function mr(Ce){return Ce.replace(/\\/g,"\\\\").replace(/"/g,'\\"')}function vt(Ce){if(Ce.length===0)return[];var Qe=Ce.charAt(0),mt=Ce.charAt(Ce.length-1);if(Ce.length>1&&Qe===mt&&(Qe==='"'||Qe==="'"))return['"'+mr(Ce.substr(1,Ce.length-2))+'"'];var nr=/\[(false|true|null|\d+|'[^']*'|"[^"]*")\]/.exec(Ce);if(nr)return vt(Ce.substr(0,nr.index)).concat(vt(nr[1])).concat(vt(Ce.substr(nr.index+nr[0].length)));var Ar=Ce.split(".");if(Ar.length===1)return['"'+mr(Ce)+'"'];for(var er=[],sr=0;sr<Ar.length;++sr)er=er.concat(vt(Ar[sr]));return er}function Tt(Ce){return"["+vt(Ce).join("][")+"]"}function Qt(Ce,Qe){return new wt(Ce,Tt(Qe+""))}function Er(Ce){return typeof Ce=="function"&&!Ce._reglType||Ce instanceof wt}function Dr(Ce,Qe){if(typeof Ce=="function")return new wt($e,Ce);if(typeof Ce=="number"||typeof Ce=="boolean")return new wt(At,Ce);if(Array.isArray(Ce))return new wt(It,Ce.map((mt,nr)=>Dr(mt,Qe+"["+nr+"]")));if(Ce instanceof wt)return Ce;J(!1,"invalid option type in uniform "+Qe)}var Yr={DynamicVariable:wt,define:Qt,isDynamic:Er,unbox:Dr,accessor:Tt},an={next:typeof requestAnimationFrame=="function"?function(Ce){return requestAnimationFrame(Ce)}:function(Ce){return setTimeout(Ce,16)},cancel:typeof cancelAnimationFrame=="function"?function(Ce){return cancelAnimationFrame(Ce)}:clearTimeout},Br=typeof performance!="undefined"&&performance.now?function(){return performance.now()}:function(){return+new Date};function en(){var Ce={"":0},Qe=[""];return{id:function(mt){var nr=Ce[mt];return nr||(nr=Ce[mt]=Qe.length,Qe.push(mt),nr)},str:function(mt){return Qe[mt]}}}function Zn(Ce,Qe,mt){var nr=document.createElement("canvas");C(nr.style,{border:0,margin:0,padding:0,top:0,left:0}),Ce.appendChild(nr),Ce===document.body&&(nr.style.position="absolute",C(Ce.style,{margin:0,padding:0}));function Ar(){var Tr=window.innerWidth,Lr=window.innerHeight;if(Ce!==document.body){var Nr=Ce.getBoundingClientRect();Tr=Nr.right-Nr.left,Lr=Nr.bottom-Nr.top}nr.width=mt*Tr,nr.height=mt*Lr,C(nr.style,{width:Tr+"px",height:Lr+"px"})}var er;Ce!==document.body&&typeof ResizeObserver=="function"?(er=new ResizeObserver(function(){setTimeout(Ar)}),er.observe(Ce)):window.addEventListener("resize",Ar,!1);function sr(){er?er.disconnect():window.removeEventListener("resize",Ar),Ce.removeChild(nr)}return Ar(),{canvas:nr,onDestroy:sr}}function zn(Ce,Qe){function mt(nr){try{return Ce.getContext(nr,Qe)}catch(Ar){return null}}return mt("webgl")||mt("experimental-webgl")||mt("webgl-experimental")}function fi(Ce){return typeof Ce.nodeName=="string"&&typeof Ce.appendChild=="function"&&typeof Ce.getBoundingClientRect=="function"}function la(Ce){return typeof Ce.drawArrays=="function"||typeof Ce.drawElements=="function"}function Oa(Ce){return typeof Ce=="string"?Ce.split():(J(Array.isArray(Ce),"invalid extension array"),Ce)}function Gr(Ce){return typeof Ce=="string"?(J(typeof document!="undefined","not supported outside of DOM"),document.querySelector(Ce)):Ce}function Ns(Ce){var Qe=Ce||{},mt,nr,Ar,er,sr={},Tr=[],Lr=[],Nr=typeof window=="undefined"?1:window.devicePixelRatio,kr=!1,Or=function(zr){zr&&J.raise(zr)},qr=function(){};if(typeof Qe=="string"?(J(typeof document!="undefined","selector queries only supported in DOM enviroments"),mt=document.querySelector(Qe),J(mt,"invalid query string for element")):typeof Qe=="object"?fi(Qe)?mt=Qe:la(Qe)?(er=Qe,Ar=er.canvas):(J.constructor(Qe),"gl"in Qe?er=Qe.gl:"canvas"in Qe?Ar=Gr(Qe.canvas):"container"in Qe&&(nr=Gr(Qe.container)),"attributes"in Qe&&(sr=Qe.attributes,J.type(sr,"object","invalid context attributes")),"extensions"in Qe&&(Tr=Oa(Qe.extensions)),"optionalExtensions"in Qe&&(Lr=Oa(Qe.optionalExtensions)),"onDone"in Qe&&(J.type(Qe.onDone,"function","invalid or missing onDone callback"),Or=Qe.onDone),"profile"in Qe&&(kr=!!Qe.profile),"pixelRatio"in Qe&&(Nr=+Qe.pixelRatio,J(Nr>0,"invalid pixel ratio"))):J.raise("invalid arguments to regl"),mt&&(mt.nodeName.toLowerCase()==="canvas"?Ar=mt:nr=mt),!er){if(!Ar){J(typeof document!="undefined","must manually specify webgl context outside of DOM environments");var Mr=Zn(nr||document.body,Or,Nr);if(!Mr)return null;Ar=Mr.canvas,qr=Mr.onDestroy}sr.premultipliedAlpha===void 0&&(sr.premultipliedAlpha=!0),er=zn(Ar,sr)}return er?{gl:er,canvas:Ar,container:nr,extensions:Tr,optionalExtensions:Lr,pixelRatio:Nr,profile:kr,onDone:Or,onDestroy:qr}:(qr(),Or("webgl not supported, try upgrading your browser or graphics drivers http://get.webgl.org"),null)}function Co(Ce,Qe){var mt={};function nr(sr){J.type(sr,"string","extension name must be string");var Tr=sr.toLowerCase(),Lr;try{Lr=mt[Tr]=Ce.getExtension(Tr)}catch(Nr){}return!!Lr}for(var Ar=0;Ar<Qe.extensions.length;++Ar){var er=Qe.extensions[Ar];if(!nr(er))return Qe.onDestroy(),Qe.onDone('"'+er+'" extension is not supported by the current WebGL context, try upgrading your system or a different browser'),null}return Qe.optionalExtensions.forEach(nr),{extensions:mt,restore:function(){Object.keys(mt).forEach(function(sr){if(mt[sr]&&!nr(sr))throw new Error("(regl): error restoring extension "+sr)})}}}function _n(Ce,Qe){for(var mt=Array(Ce),nr=0;nr<Ce;++nr)mt[nr]=Qe(nr);return mt}var xs=5120,go=5121,Fs=5122,Po=5123,hl=5124,yu=5125,Es=5126;function cs(Ce){for(var Qe=16;Qe<=1<<28;Qe*=16)if(Ce<=Qe)return Qe;return 0}function Ou(Ce){var Qe,mt;return Qe=(Ce>65535)<<4,Ce>>>=Qe,mt=(Ce>255)<<3,Ce>>>=mt,Qe|=mt,mt=(Ce>15)<<2,Ce>>>=mt,Qe|=mt,mt=(Ce>3)<<1,Ce>>>=mt,Qe|=mt,Qe|Ce>>1}function Al(){var Ce=_n(8,function(){return[]});function Qe(er){var sr=cs(er),Tr=Ce[Ou(sr)>>2];return Tr.length>0?Tr.pop():new ArrayBuffer(sr)}function mt(er){Ce[Ou(er.byteLength)>>2].push(er)}function nr(er,sr){var Tr=null;switch(er){case xs:Tr=new Int8Array(Qe(sr),0,sr);break;case go:Tr=new Uint8Array(Qe(sr),0,sr);break;case Fs:Tr=new Int16Array(Qe(2*sr),0,sr);break;case Po:Tr=new Uint16Array(Qe(2*sr),0,sr);break;case hl:Tr=new Int32Array(Qe(4*sr),0,sr);break;case yu:Tr=new Uint32Array(Qe(4*sr),0,sr);break;case Es:Tr=new Float32Array(Qe(4*sr),0,sr);break;default:return null}return Tr.length!==sr?Tr.subarray(0,sr):Tr}function Ar(er){mt(er.buffer)}return{alloc:Qe,free:mt,allocType:nr,freeType:Ar}}var ga=Al();ga.zero=Al();var Zi=3408,Bs=3410,no=3411,es=3412,Lo=3413,Ni=3414,io=3415,bs=33901,$o=33902,Ru=3379,Ca=3386,xa=34921,Ku=36347,uo=36348,eu=35661,wa=35660,lu=34930,pr=36349,vn=34076,lo=34024,tu=7936,ru=7937,Ss=7938,Zs=35724,Va=34047,Xc=36063,Cs=34852,ts=3553,Pl=34067,zi=34069,Ll=33984,Oo=6408,pl=5126,Ai=5121,_u=36160,gf=36053,Du=36064,rs=16384,Mt=function(Ce,Qe){var mt=1;Qe.ext_texture_filter_anisotropic&&(mt=Ce.getParameter(Va));var nr=1,Ar=1;Qe.webgl_draw_buffers&&(nr=Ce.getParameter(Cs),Ar=Ce.getParameter(Xc));var er=!!Qe.oes_texture_float;if(er){var sr=Ce.createTexture();Ce.bindTexture(ts,sr),Ce.texImage2D(ts,0,Oo,1,1,0,Oo,pl,null);var Tr=Ce.createFramebuffer();if(Ce.bindFramebuffer(_u,Tr),Ce.framebufferTexture2D(_u,Du,ts,sr,0),Ce.bindTexture(ts,null),Ce.checkFramebufferStatus(_u)!==gf)er=!1;else{Ce.viewport(0,0,1,1),Ce.clearColor(1,0,0,1),Ce.clear(rs);var Lr=ga.allocType(pl,4);Ce.readPixels(0,0,1,1,Oo,pl,Lr),Ce.getError()?er=!1:(Ce.deleteFramebuffer(Tr),Ce.deleteTexture(sr),er=Lr[0]===1),ga.freeType(Lr)}}var Nr=typeof navigator!="undefined"&&(/MSIE/.test(navigator.userAgent)||/Trident\//.test(navigator.appVersion)||/Edge/.test(navigator.userAgent)),kr=!0;if(!Nr){var Or=Ce.createTexture(),qr=ga.allocType(Ai,36);Ce.activeTexture(Ll),Ce.bindTexture(Pl,Or),Ce.texImage2D(zi,0,Oo,3,3,0,Oo,Ai,qr),ga.freeType(qr),Ce.bindTexture(Pl,null),Ce.deleteTexture(Or),kr=!Ce.getError()}return{colorBits:[Ce.getParameter(Bs),Ce.getParameter(no),Ce.getParameter(es),Ce.getParameter(Lo)],depthBits:Ce.getParameter(Ni),stencilBits:Ce.getParameter(io),subpixelBits:Ce.getParameter(Zi),extensions:Object.keys(Qe).filter(function(Mr){return!!Qe[Mr]}),maxAnisotropic:mt,maxDrawbuffers:nr,maxColorAttachments:Ar,pointSizeDims:Ce.getParameter(bs),lineWidthDims:Ce.getParameter($o),maxViewportDims:Ce.getParameter(Ca),maxCombinedTextureUnits:Ce.getParameter(eu),maxCubeMapSize:Ce.getParameter(vn),maxRenderbufferSize:Ce.getParameter(lo),maxTextureUnits:Ce.getParameter(lu),maxTextureSize:Ce.getParameter(Ru),maxAttributes:Ce.getParameter(xa),maxVertexUniforms:Ce.getParameter(Ku),maxVertexTextureUnits:Ce.getParameter(wa),maxVaryingVectors:Ce.getParameter(uo),maxFragmentUniforms:Ce.getParameter(pr),glsl:Ce.getParameter(Zs),renderer:Ce.getParameter(ru),vendor:Ce.getParameter(tu),version:Ce.getParameter(Ss),readFloat:er,npotTextureCube:kr}};function He(Ce){return!!Ce&&typeof Ce=="object"&&Array.isArray(Ce.shape)&&Array.isArray(Ce.stride)&&typeof Ce.offset=="number"&&Ce.shape.length===Ce.stride.length&&(Array.isArray(Ce.data)||$(Ce.data))}var Gt=function(Ce){return Object.keys(Ce).map(function(Qe){return Ce[Qe]})},Ae={shape:dn,flatten:Pr};function Be(Ce,Qe,mt){for(var nr=0;nr<Qe;++nr)mt[nr]=Ce[nr]}function We(Ce,Qe,mt,nr){for(var Ar=0,er=0;er<Qe;++er)for(var sr=Ce[er],Tr=0;Tr<mt;++Tr)nr[Ar++]=sr[Tr]}function zt(Ce,Qe,mt,nr,Ar,er){for(var sr=er,Tr=0;Tr<Qe;++Tr)for(var Lr=Ce[Tr],Nr=0;Nr<mt;++Nr)for(var kr=Lr[Nr],Or=0;Or<nr;++Or)Ar[sr++]=kr[Or]}function hr(Ce,Qe,mt,nr,Ar){for(var er=1,sr=mt+1;sr<Qe.length;++sr)er*=Qe[sr];var Tr=Qe[mt];if(Qe.length-mt===4){var Lr=Qe[mt+1],Nr=Qe[mt+2],kr=Qe[mt+3];for(sr=0;sr<Tr;++sr)zt(Ce[sr],Lr,Nr,kr,nr,Ar),Ar+=er}else for(sr=0;sr<Tr;++sr)hr(Ce[sr],Qe,mt+1,nr,Ar),Ar+=er}function Pr(Ce,Qe,mt,nr){var Ar=1;if(Qe.length)for(var er=0;er<Qe.length;++er)Ar*=Qe[er];else Ar=0;var sr=nr||ga.allocType(mt,Ar);switch(Qe.length){case 0:break;case 1:Be(Ce,Qe[0],sr);break;case 2:We(Ce,Qe[0],Qe[1],sr);break;case 3:zt(Ce,Qe[0],Qe[1],Qe[2],sr,0);break;default:hr(Ce,Qe,0,sr,0)}return sr}function dn(Ce){for(var Qe=[],mt=Ce;mt.length;mt=mt[0])Qe.push(mt.length);return Qe}var Mn={"[object Int8Array]":5120,"[object Int16Array]":5122,"[object Int32Array]":5124,"[object Uint8Array]":5121,"[object Uint8ClampedArray]":5121,"[object Uint16Array]":5123,"[object Uint32Array]":5125,"[object Float32Array]":5126,"[object Float64Array]":5121,"[object ArrayBuffer]":5121},vi=5120,co=5122,ns=5124,ws=5121,Qc=5123,zs=5125,ca=5126,ec=5126,qa={int8:vi,int16:co,int32:ns,uint8:ws,uint16:Qc,uint32:zs,float:ca,float32:ec},mf=35048,dl=35040,Ta={dynamic:mf,stream:dl,static:35044},In=Ae.flatten,Ju=Ae.shape,Us=35044,cu=35040,fu=5121,xu=5126,ni=[];ni[5120]=1,ni[5122]=2,ni[5124]=4,ni[5121]=1,ni[5123]=2,ni[5125]=4,ni[5126]=4;function Ro(Ce){return Mn[Object.prototype.toString.call(Ce)]|0}function Ha(Ce,Qe){for(var mt=0;mt<Qe.length;++mt)Ce[mt]=Qe[mt]}function Ra(Ce,Qe,mt,nr,Ar,er,sr){for(var Tr=0,Lr=0;Lr<mt;++Lr)for(var Nr=0;Nr<nr;++Nr)Ce[Tr++]=Qe[Ar*Lr+er*Nr+sr]}function mo(Ce,Qe,mt,nr){var Ar=0,er={};function sr(Vt){this.id=Ar++,this.buffer=Ce.createBuffer(),this.type=Vt,this.usage=Us,this.byteLength=0,this.dimension=1,this.dtype=fu,this.persistentData=null,mt.profile&&(this.stats={size:0})}sr.prototype.bind=function(){Ce.bindBuffer(this.type,this.buffer)},sr.prototype.destroy=function(){qr(this)};var Tr=[];function Lr(Vt,lr){var Rr=Tr.pop();return Rr||(Rr=new sr(Vt)),Rr.bind(),Or(Rr,lr,cu,0,1,!1),Rr}function Nr(Vt){Tr.push(Vt)}function kr(Vt,lr,Rr){Vt.byteLength=lr.byteLength,Ce.bufferData(Vt.type,lr,Rr)}function Or(Vt,lr,Rr,tn,_r,cn){var wr;if(Vt.usage=Rr,Array.isArray(lr)){if(Vt.dtype=tn||xu,lr.length>0){var Hr;if(Array.isArray(lr[0])){wr=Ju(lr);for(var br=1,Wr=1;Wr<wr.length;++Wr)br*=wr[Wr];Vt.dimension=br,Hr=In(lr,wr,Vt.dtype),kr(Vt,Hr,Rr),cn?Vt.persistentData=Hr:ga.freeType(Hr)}else if(typeof lr[0]=="number"){Vt.dimension=_r;var Cn=ga.allocType(Vt.dtype,lr.length);Ha(Cn,lr),kr(Vt,Cn,Rr),cn?Vt.persistentData=Cn:ga.freeType(Cn)}else $(lr[0])?(Vt.dimension=lr[0].length,Vt.dtype=tn||Ro(lr[0])||xu,Hr=In(lr,[lr.length,lr[0].length],Vt.dtype),kr(Vt,Hr,Rr),cn?Vt.persistentData=Hr:ga.freeType(Hr)):J.raise("invalid buffer data")}}else if($(lr))Vt.dtype=tn||Ro(lr),Vt.dimension=_r,kr(Vt,lr,Rr),cn&&(Vt.persistentData=new Uint8Array(new Uint8Array(lr.buffer)));else if(He(lr)){wr=lr.shape;var Xn=lr.stride,Ir=lr.offset,Fr=0,gr=0,On=0,Bn=0;wr.length===1?(Fr=wr[0],gr=1,On=Xn[0],Bn=0):wr.length===2?(Fr=wr[0],gr=wr[1],On=Xn[0],Bn=Xn[1]):J.raise("invalid shape"),Vt.dtype=tn||Ro(lr.data)||xu,Vt.dimension=gr;var gn=ga.allocType(Vt.dtype,Fr*gr);Ra(gn,lr.data,Fr,gr,On,Bn,Ir),kr(Vt,gn,Rr),cn?Vt.persistentData=gn:ga.freeType(gn)}else lr instanceof ArrayBuffer?(Vt.dtype=fu,Vt.dimension=_r,kr(Vt,lr,Rr),cn&&(Vt.persistentData=new Uint8Array(new Uint8Array(lr)))):J.raise("invalid buffer data")}function qr(Vt){Qe.bufferCount--,nr(Vt);var lr=Vt.buffer;J(lr,"buffer must not be deleted already"),Ce.deleteBuffer(lr),Vt.buffer=null,delete er[Vt.id]}function Mr(Vt,lr,Rr,tn){Qe.bufferCount++;var _r=new sr(lr);er[_r.id]=_r;function cn(br){var Wr=Us,Cn=null,Xn=0,Ir=0,Fr=1;return Array.isArray(br)||$(br)||He(br)||br instanceof ArrayBuffer?Cn=br:typeof br=="number"?Xn=br|0:br&&(J.type(br,"object","buffer arguments must be an object, a number or an array"),"data"in br&&(J(Cn===null||Array.isArray(Cn)||$(Cn)||He(Cn),"invalid data for buffer"),Cn=br.data),"usage"in br&&(J.parameter(br.usage,Ta,"invalid buffer usage"),Wr=Ta[br.usage]),"type"in br&&(J.parameter(br.type,qa,"invalid buffer type"),Ir=qa[br.type]),"dimension"in br&&(J.type(br.dimension,"number","invalid dimension"),Fr=br.dimension|0),"length"in br&&(J.nni(Xn,"buffer length must be a nonnegative integer"),Xn=br.length|0)),_r.bind(),Cn?Or(_r,Cn,Wr,Ir,Fr,tn):(Xn&&Ce.bufferData(_r.type,Xn,Wr),_r.dtype=Ir||fu,_r.usage=Wr,_r.dimension=Fr,_r.byteLength=Xn),mt.profile&&(_r.stats.size=_r.byteLength*ni[_r.dtype]),cn}function wr(br,Wr){J(Wr+br.byteLength<=_r.byteLength,"invalid buffer subdata call, buffer is too small.  Can't write data of size "+br.byteLength+" starting from offset "+Wr+" to a buffer of size "+_r.byteLength),Ce.bufferSubData(_r.type,Wr,br)}function Hr(br,Wr){var Cn=(Wr||0)|0,Xn;if(_r.bind(),$(br)||br instanceof ArrayBuffer)wr(br,Cn);else if(Array.isArray(br)){if(br.length>0)if(typeof br[0]=="number"){var Ir=ga.allocType(_r.dtype,br.length);Ha(Ir,br),wr(Ir,Cn),ga.freeType(Ir)}else if(Array.isArray(br[0])||$(br[0])){Xn=Ju(br);var Fr=In(br,Xn,_r.dtype);wr(Fr,Cn),ga.freeType(Fr)}else J.raise("invalid buffer data")}else if(He(br)){Xn=br.shape;var gr=br.stride,On=0,Bn=0,gn=0,xi=0;Xn.length===1?(On=Xn[0],Bn=1,gn=gr[0],xi=0):Xn.length===2?(On=Xn[0],Bn=Xn[1],gn=gr[0],xi=gr[1]):J.raise("invalid shape");var Jn=Array.isArray(br.data)?_r.dtype:Ro(br.data),gi=ga.allocType(Jn,On*Bn);Ra(gi,br.data,On,Bn,gn,xi,br.offset),wr(gi,Cn),ga.freeType(gi)}else J.raise("invalid data for buffer subdata");return cn}return Rr||cn(Vt),cn._reglType="buffer",cn._buffer=_r,cn.subdata=Hr,mt.profile&&(cn.stats=_r.stats),cn.destroy=function(){qr(_r)},cn}function zr(){Gt(er).forEach(function(Vt){Vt.buffer=Ce.createBuffer(),Ce.bindBuffer(Vt.type,Vt.buffer),Ce.bufferData(Vt.type,Vt.persistentData||Vt.byteLength,Vt.usage)})}return mt.profile&&(Qe.getTotalBufferSize=function(){var Vt=0;return Object.keys(er).forEach(function(lr){Vt+=er[lr].stats.size}),Vt}),{create:Mr,createStream:Lr,destroyStream:Nr,clear:function(){Gt(er).forEach(qr),Tr.forEach(qr)},getBuffer:function(Vt){return Vt&&Vt._buffer instanceof sr?Vt._buffer:null},restore:zr,_initBuffer:Or}}var hu=0,yf=0,Ol=1,qc=1,_f=4,Yo=4,Gs={points:hu,point:yf,lines:Ol,line:qc,triangles:_f,triangle:Yo,"line loop":2,"line strip":3,"triangle strip":5,"triangle fan":6},Do=0,fa=1,is=4,Rl=5120,Ma=5121,Sn=5122,vl=5123,tc=5124,Ka=5125,fs=34963,gl=35040,gc=35044;function mc(Ce,Qe,mt,nr){var Ar={},er=0,sr={uint8:Ma,uint16:vl};Qe.oes_element_index_uint&&(sr.uint32=Ka);function Tr(zr){this.id=er++,Ar[this.id]=this,this.buffer=zr,this.primType=is,this.vertCount=0,this.type=0}Tr.prototype.bind=function(){this.buffer.bind()};var Lr=[];function Nr(zr){var Vt=Lr.pop();return Vt||(Vt=new Tr(mt.create(null,fs,!0,!1)._buffer)),Or(Vt,zr,gl,-1,-1,0,0),Vt}function kr(zr){Lr.push(zr)}function Or(zr,Vt,lr,Rr,tn,_r,cn){zr.buffer.bind();var wr;if(Vt){var Hr=cn;!cn&&(!$(Vt)||He(Vt)&&!$(Vt.data))&&(Hr=Qe.oes_element_index_uint?Ka:vl),mt._initBuffer(zr.buffer,Vt,lr,Hr,3)}else Ce.bufferData(fs,_r,lr),zr.buffer.dtype=wr||Ma,zr.buffer.usage=lr,zr.buffer.dimension=3,zr.buffer.byteLength=_r;if(wr=cn,!cn){switch(zr.buffer.dtype){case Ma:case Rl:wr=Ma;break;case vl:case Sn:wr=vl;break;case Ka:case tc:wr=Ka;break;default:J.raise("unsupported type for element array")}zr.buffer.dtype=wr}zr.type=wr,J(wr!==Ka||!!Qe.oes_element_index_uint,"32 bit element buffers not supported, enable oes_element_index_uint first");var br=tn;br<0&&(br=zr.buffer.byteLength,wr===vl?br>>=1:wr===Ka&&(br>>=2)),zr.vertCount=br;var Wr=Rr;if(Rr<0){Wr=is;var Cn=zr.buffer.dimension;Cn===1&&(Wr=Do),Cn===2&&(Wr=fa),Cn===3&&(Wr=is)}zr.primType=Wr}function qr(zr){nr.elementsCount--,J(zr.buffer!==null,"must not double destroy elements"),delete Ar[zr.id],zr.buffer.destroy(),zr.buffer=null}function Mr(zr,Vt){var lr=mt.create(null,fs,!0),Rr=new Tr(lr._buffer);nr.elementsCount++;function tn(_r){if(!_r)lr(),Rr.primType=is,Rr.vertCount=0,Rr.type=Ma;else if(typeof _r=="number")lr(_r),Rr.primType=is,Rr.vertCount=_r|0,Rr.type=Ma;else{var cn=null,wr=gc,Hr=-1,br=-1,Wr=0,Cn=0;Array.isArray(_r)||$(_r)||He(_r)?cn=_r:(J.type(_r,"object","invalid arguments for elements"),"data"in _r&&(cn=_r.data,J(Array.isArray(cn)||$(cn)||He(cn),"invalid data for element buffer")),"usage"in _r&&(J.parameter(_r.usage,Ta,"invalid element buffer usage"),wr=Ta[_r.usage]),"primitive"in _r&&(J.parameter(_r.primitive,Gs,"invalid element buffer primitive"),Hr=Gs[_r.primitive]),"count"in _r&&(J(typeof _r.count=="number"&&_r.count>=0,"invalid vertex count for elements"),br=_r.count|0),"type"in _r&&(J.parameter(_r.type,sr,"invalid buffer type"),Cn=sr[_r.type]),"length"in _r?Wr=_r.length|0:(Wr=br,Cn===vl||Cn===Sn?Wr*=2:(Cn===Ka||Cn===tc)&&(Wr*=4))),Or(Rr,cn,wr,Hr,br,Wr,Cn)}return tn}return tn(zr),tn._reglType="elements",tn._elements=Rr,tn.subdata=function(_r,cn){return lr.subdata(_r,cn),tn},tn.destroy=function(){qr(Rr)},tn}return{create:Mr,createStream:Nr,destroyStream:kr,getElements:function(zr){return typeof zr=="function"&&zr._elements instanceof Tr?zr._elements:null},clear:function(){Gt(Ar).forEach(qr)}}}var xf=new Float32Array(1),ea=new Uint32Array(xf.buffer),ku=5123;function na(Ce){for(var Qe=ga.allocType(ku,Ce.length),mt=0;mt<Ce.length;++mt)if(isNaN(Ce[mt]))Qe[mt]=65535;else if(Ce[mt]===1/0)Qe[mt]=31744;else if(Ce[mt]===-1/0)Qe[mt]=64512;else{xf[0]=Ce[mt];var nr=ea[0],Ar=nr>>>31<<15,er=(nr<<1>>>24)-127,sr=nr>>13&1024-1;if(er<-24)Qe[mt]=Ar;else if(er<-14){var Tr=-14-er;Qe[mt]=Ar+(sr+1024>>Tr)}else er>15?Qe[mt]=Ar+31744:Qe[mt]=Ar+(er+15<<10)+sr}return Qe}function Za(Ce){return Array.isArray(Ce)||$(Ce)}var ko=function(Ce){return!(Ce&Ce-1)&&!!Ce},Nf=34467,ui=3553,hs=34067,aa=34069,Ts=6408,Ea=6406,As=6407,ml=6409,nu=6410,Mi=32854,as=32855,iu=36194,No=32819,ps=32820,Fo=33635,a0=34042,rc=6402,ma=34041,Bo=35904,Ms=35906,fo=36193,Wo=33776,Au=33777,js=33778,Zr=33779,Ja=35986,yc=35987,Dl=34798,yo=35840,Nu=35841,Eu=35842,Kc=35843,ds=36196,Is=5121,kl=5123,el=5125,Jc=5126,Ff=10242,yl=10243,bu=10497,wo=33071,_l=33648,Zo=10240,Su=10241,Fu=9728,ef=9729,xl=9984,Bu=9985,pu=9986,_o=9987,Cu=33170,ho=4352,o0=4353,tl=4354,nc=34046,zo=3317,Xo=37440,Vs=37441,Hs=37443,_c=37444,Ps=33984,El=[xl,pu,Bu,_o],To=[0,ml,nu,As,Ts],Ls={};Ls[ml]=Ls[Ea]=Ls[rc]=1,Ls[ma]=Ls[nu]=2,Ls[As]=Ls[Bo]=3,Ls[Ts]=Ls[Ms]=4;function za(Ce){return"[object "+Ce+"]"}var ur=za("HTMLCanvasElement"),xt=za("OffscreenCanvas"),Me=za("CanvasRenderingContext2D"),$s=za("ImageBitmap"),it=za("HTMLImageElement"),rl=za("HTMLVideoElement"),ha=Object.keys(Mn).concat([ur,xt,Me,$s,it,rl]),Ys=[];Ys[Is]=1,Ys[Jc]=4,Ys[fo]=2,Ys[kl]=2,Ys[el]=4;var oi=[];oi[Mi]=2,oi[as]=2,oi[iu]=2,oi[ma]=4,oi[Wo]=.5,oi[Au]=.5,oi[js]=1,oi[Zr]=1,oi[Ja]=.5,oi[yc]=1,oi[Dl]=1,oi[yo]=.5,oi[Nu]=.25,oi[Eu]=.5,oi[Kc]=.25,oi[ds]=.5;function Aa(Ce){return Array.isArray(Ce)&&(Ce.length===0||typeof Ce[0]=="number")}function bi(Ce){if(!Array.isArray(Ce))return!1;var Qe=Ce.length;return!(Qe===0||!Za(Ce[0]))}function $a(Ce){return Object.prototype.toString.call(Ce)}function Ii(Ce){return $a(Ce)===ur}function Hn(Ce){return $a(Ce)===xt}function yi(Ce){return $a(Ce)===Me}function Yi(Ce){return $a(Ce)===$s}function _i(Ce){return $a(Ce)===it}function di(Ce){return $a(Ce)===rl}function wn(Ce){if(!Ce)return!1;var Qe=$a(Ce);return ha.indexOf(Qe)>=0?!0:Aa(Ce)||bi(Ce)||He(Ce)}function Wn(Ce){return Mn[Object.prototype.toString.call(Ce)]|0}function Pi(Ce,Qe){var mt=Qe.length;switch(Ce.type){case Is:case kl:case el:case Jc:var nr=ga.allocType(Ce.type,mt);nr.set(Qe),Ce.data=nr;break;case fo:Ce.data=na(Qe);break;default:J.raise("unsupported texture type, must specify a typed array")}}function qn(Ce,Qe){return ga.allocType(Ce.type===fo?Jc:Ce.type,Qe)}function Ui(Ce,Qe){Ce.type===fo?(Ce.data=na(Qe),ga.freeType(Qe)):Ce.data=Qe}function Gi(Ce,Qe,mt,nr,Ar,er){for(var sr=Ce.width,Tr=Ce.height,Lr=Ce.channels,Nr=sr*Tr*Lr,kr=qn(Ce,Nr),Or=0,qr=0;qr<Tr;++qr)for(var Mr=0;Mr<sr;++Mr)for(var zr=0;zr<Lr;++zr)kr[Or++]=Qe[mt*Mr+nr*qr+Ar*zr+er];Ui(Ce,kr)}function Nn(Ce,Qe,mt,nr,Ar,er){var sr;if(typeof oi[Ce]!="undefined"?sr=oi[Ce]:sr=Ls[Ce]*Ys[Qe],er&&(sr*=6),Ar){for(var Tr=0,Lr=mt;Lr>=1;)Tr+=sr*Lr*Lr,Lr/=2;return Tr}else return sr*mt*nr}function Wi(Ce,Qe,mt,nr,Ar,er,sr){var Tr={"don't care":ho,"dont care":ho,nice:tl,fast:o0},Lr={repeat:bu,clamp:wo,mirror:_l},Nr={nearest:Fu,linear:ef},kr=C({mipmap:_o,"nearest mipmap nearest":xl,"linear mipmap nearest":Bu,"nearest mipmap linear":pu,"linear mipmap linear":_o},Nr),Or={none:0,browser:_c},qr={uint8:Is,rgba4:No,rgb565:Fo,"rgb5 a1":ps},Mr={alpha:Ea,luminance:ml,"luminance alpha":nu,rgb:As,rgba:Ts,rgba4:Mi,"rgb5 a1":as,rgb565:iu},zr={};Qe.ext_srgb&&(Mr.srgb=Bo,Mr.srgba=Ms),Qe.oes_texture_float&&(qr.float32=qr.float=Jc),Qe.oes_texture_half_float&&(qr.float16=qr["half float"]=fo),Qe.webgl_depth_texture&&(C(Mr,{depth:rc,"depth stencil":ma}),C(qr,{uint16:kl,uint32:el,"depth stencil":a0})),Qe.webgl_compressed_texture_s3tc&&C(zr,{"rgb s3tc dxt1":Wo,"rgba s3tc dxt1":Au,"rgba s3tc dxt3":js,"rgba s3tc dxt5":Zr}),Qe.webgl_compressed_texture_atc&&C(zr,{"rgb atc":Ja,"rgba atc explicit alpha":yc,"rgba atc interpolated alpha":Dl}),Qe.webgl_compressed_texture_pvrtc&&C(zr,{"rgb pvrtc 4bppv1":yo,"rgb pvrtc 2bppv1":Nu,"rgba pvrtc 4bppv1":Eu,"rgba pvrtc 2bppv1":Kc}),Qe.webgl_compressed_texture_etc1&&(zr["rgb etc1"]=ds);var Vt=Array.prototype.slice.call(Ce.getParameter(Nf));Object.keys(zr).forEach(function(ct){var ft=zr[ct];Vt.indexOf(ft)>=0&&(Mr[ct]=ft)});var lr=Object.keys(Mr);mt.textureFormats=lr;var Rr=[];Object.keys(Mr).forEach(function(ct){var ft=Mr[ct];Rr[ft]=ct});var tn=[];Object.keys(qr).forEach(function(ct){var ft=qr[ct];tn[ft]=ct});var _r=[];Object.keys(Nr).forEach(function(ct){var ft=Nr[ct];_r[ft]=ct});var cn=[];Object.keys(kr).forEach(function(ct){var ft=kr[ct];cn[ft]=ct});var wr=[];Object.keys(Lr).forEach(function(ct){var ft=Lr[ct];wr[ft]=ct});var Hr=lr.reduce(function(ct,ft){var Et=Mr[ft];return Et===ml||Et===Ea||Et===ml||Et===nu||Et===rc||Et===ma||Qe.ext_srgb&&(Et===Bo||Et===Ms)?ct[Et]=Et:Et===as||ft.indexOf("rgba")>=0?ct[Et]=Ts:ct[Et]=As,ct},{});function br(){this.internalformat=Ts,this.format=Ts,this.type=Is,this.compressed=!1,this.premultiplyAlpha=!1,this.flipY=!1,this.unpackAlignment=1,this.colorSpace=_c,this.width=0,this.height=0,this.channels=0}function Wr(ct,ft){ct.internalformat=ft.internalformat,ct.format=ft.format,ct.type=ft.type,ct.compressed=ft.compressed,ct.premultiplyAlpha=ft.premultiplyAlpha,ct.flipY=ft.flipY,ct.unpackAlignment=ft.unpackAlignment,ct.colorSpace=ft.colorSpace,ct.width=ft.width,ct.height=ft.height,ct.channels=ft.channels}function Cn(ct,ft){if(!(typeof ft!="object"||!ft)){if("premultiplyAlpha"in ft&&(J.type(ft.premultiplyAlpha,"boolean","invalid premultiplyAlpha"),ct.premultiplyAlpha=ft.premultiplyAlpha),"flipY"in ft&&(J.type(ft.flipY,"boolean","invalid texture flip"),ct.flipY=ft.flipY),"alignment"in ft&&(J.oneOf(ft.alignment,[1,2,4,8],"invalid texture unpack alignment"),ct.unpackAlignment=ft.alignment),"colorSpace"in ft&&(J.parameter(ft.colorSpace,Or,"invalid colorSpace"),ct.colorSpace=Or[ft.colorSpace]),"type"in ft){var Et=ft.type;J(Qe.oes_texture_float||!(Et==="float"||Et==="float32"),"you must enable the OES_texture_float extension in order to use floating point textures."),J(Qe.oes_texture_half_float||!(Et==="half float"||Et==="float16"),"you must enable the OES_texture_half_float extension in order to use 16-bit floating point textures."),J(Qe.webgl_depth_texture||!(Et==="uint16"||Et==="uint32"||Et==="depth stencil"),"you must enable the WEBGL_depth_texture extension in order to use depth/stencil textures."),J.parameter(Et,qr,"invalid texture type"),ct.type=qr[Et]}var Ur=ct.width,Un=ct.height,ot=ct.channels,Ye=!1;"shape"in ft?(J(Array.isArray(ft.shape)&&ft.shape.length>=2,"shape must be an array"),Ur=ft.shape[0],Un=ft.shape[1],ft.shape.length===3&&(ot=ft.shape[2],J(ot>0&&ot<=4,"invalid number of channels"),Ye=!0),J(Ur>=0&&Ur<=mt.maxTextureSize,"invalid width"),J(Un>=0&&Un<=mt.maxTextureSize,"invalid height")):("radius"in ft&&(Ur=Un=ft.radius,J(Ur>=0&&Ur<=mt.maxTextureSize,"invalid radius")),"width"in ft&&(Ur=ft.width,J(Ur>=0&&Ur<=mt.maxTextureSize,"invalid width")),"height"in ft&&(Un=ft.height,J(Un>=0&&Un<=mt.maxTextureSize,"invalid height")),"channels"in ft&&(ot=ft.channels,J(ot>0&&ot<=4,"invalid number of channels"),Ye=!0)),ct.width=Ur|0,ct.height=Un|0,ct.channels=ot|0;var St=!1;if("format"in ft){var Dt=ft.format;J(Qe.webgl_depth_texture||!(Dt==="depth"||Dt==="depth stencil"),"you must enable the WEBGL_depth_texture extension in order to use depth/stencil textures."),J.parameter(Dt,Mr,"invalid texture format");var Ft=ct.internalformat=Mr[Dt];ct.format=Hr[Ft],Dt in qr&&("type"in ft||(ct.type=qr[Dt])),Dt in zr&&(ct.compressed=!0),St=!0}!Ye&&St?ct.channels=Ls[ct.format]:Ye&&!St?ct.channels!==To[ct.format]&&(ct.format=ct.internalformat=To[ct.channels]):St&&Ye&&J(ct.channels===Ls[ct.format],"number of channels inconsistent with specified format")}}function Xn(ct){Ce.pixelStorei(Xo,ct.flipY),Ce.pixelStorei(Vs,ct.premultiplyAlpha),Ce.pixelStorei(Hs,ct.colorSpace),Ce.pixelStorei(zo,ct.unpackAlignment)}function Ir(){br.call(this),this.xOffset=0,this.yOffset=0,this.data=null,this.needsFree=!1,this.element=null,this.needsCopy=!1}function Fr(ct,ft){var Et=null;if(wn(ft)?Et=ft:ft&&(J.type(ft,"object","invalid pixel data type"),Cn(ct,ft),"x"in ft&&(ct.xOffset=ft.x|0),"y"in ft&&(ct.yOffset=ft.y|0),wn(ft.data)&&(Et=ft.data)),J(!ct.compressed||Et instanceof Uint8Array,"compressed texture data must be stored in a uint8array"),ft.copy){J(!Et,"can not specify copy and data field for the same texture");var Ur=Ar.viewportWidth,Un=Ar.viewportHeight;ct.width=ct.width||Ur-ct.xOffset,ct.height=ct.height||Un-ct.yOffset,ct.needsCopy=!0,J(ct.xOffset>=0&&ct.xOffset<Ur&&ct.yOffset>=0&&ct.yOffset<Un&&ct.width>0&&ct.width<=Ur&&ct.height>0&&ct.height<=Un,"copy texture read out of bounds")}else if(!Et)ct.width=ct.width||1,ct.height=ct.height||1,ct.channels=ct.channels||4;else if($(Et))ct.channels=ct.channels||4,ct.data=Et,!("type"in ft)&&ct.type===Is&&(ct.type=Wn(Et));else if(Aa(Et))ct.channels=ct.channels||4,Pi(ct,Et),ct.alignment=1,ct.needsFree=!0;else if(He(Et)){var ot=Et.data;!Array.isArray(ot)&&ct.type===Is&&(ct.type=Wn(ot));var Ye=Et.shape,St=Et.stride,Dt,Ft,h,f,p,m;Ye.length===3?(h=Ye[2],m=St[2]):(J(Ye.length===2,"invalid ndarray pixel data, must be 2 or 3D"),h=1,m=1),Dt=Ye[0],Ft=Ye[1],f=St[0],p=St[1],ct.alignment=1,ct.width=Dt,ct.height=Ft,ct.channels=h,ct.format=ct.internalformat=To[h],ct.needsFree=!0,Gi(ct,ot,f,p,m,Et.offset)}else if(Ii(Et)||Hn(Et)||yi(Et))Ii(Et)||Hn(Et)?ct.element=Et:ct.element=Et.canvas,ct.width=ct.element.width,ct.height=ct.element.height,ct.channels=4;else if(Yi(Et))ct.element=Et,ct.width=Et.width,ct.height=Et.height,ct.channels=4;else if(_i(Et))ct.element=Et,ct.width=Et.naturalWidth,ct.height=Et.naturalHeight,ct.channels=4;else if(di(Et))ct.element=Et,ct.width=Et.videoWidth,ct.height=Et.videoHeight,ct.channels=4;else if(bi(Et)){var E=ct.width||Et[0].length,S=ct.height||Et.length,I=ct.channels;Za(Et[0][0])?I=I||Et[0][0].length:I=I||1;for(var D=Ae.shape(Et),V=1,re=0;re<D.length;++re)V*=D[re];var xe=qn(ct,V);Ae.flatten(Et,D,"",xe),Ui(ct,xe),ct.alignment=1,ct.width=E,ct.height=S,ct.channels=I,ct.format=ct.internalformat=To[I],ct.needsFree=!0}ct.type===Jc?J(mt.extensions.indexOf("oes_texture_float")>=0,"oes_texture_float extension not enabled"):ct.type===fo&&J(mt.extensions.indexOf("oes_texture_half_float")>=0,"oes_texture_half_float extension not enabled")}function gr(ct,ft,Et){var Ur=ct.element,Un=ct.data,ot=ct.internalformat,Ye=ct.format,St=ct.type,Dt=ct.width,Ft=ct.height;Xn(ct),Ur?Ce.texImage2D(ft,Et,Ye,Ye,St,Ur):ct.compressed?Ce.compressedTexImage2D(ft,Et,ot,Dt,Ft,0,Un):ct.needsCopy?(nr(),Ce.copyTexImage2D(ft,Et,Ye,ct.xOffset,ct.yOffset,Dt,Ft,0)):Ce.texImage2D(ft,Et,Ye,Dt,Ft,0,Ye,St,Un||null)}function On(ct,ft,Et,Ur,Un){var ot=ct.element,Ye=ct.data,St=ct.internalformat,Dt=ct.format,Ft=ct.type,h=ct.width,f=ct.height;Xn(ct),ot?Ce.texSubImage2D(ft,Un,Et,Ur,Dt,Ft,ot):ct.compressed?Ce.compressedTexSubImage2D(ft,Un,Et,Ur,St,h,f,Ye):ct.needsCopy?(nr(),Ce.copyTexSubImage2D(ft,Un,Et,Ur,ct.xOffset,ct.yOffset,h,f)):Ce.texSubImage2D(ft,Un,Et,Ur,h,f,Dt,Ft,Ye)}var Bn=[];function gn(){return Bn.pop()||new Ir}function xi(ct){ct.needsFree&&ga.freeType(ct.data),Ir.call(ct),Bn.push(ct)}function Jn(){br.call(this),this.genMipmaps=!1,this.mipmapHint=ho,this.mipmask=0,this.images=Array(16)}function gi(ct,ft,Et){var Ur=ct.images[0]=gn();ct.mipmask=1,Ur.width=ct.width=ft,Ur.height=ct.height=Et,Ur.channels=ct.channels=4}function ta(ct,ft){var Et=null;if(wn(ft))Et=ct.images[0]=gn(),Wr(Et,ct),Fr(Et,ft),ct.mipmask=1;else if(Cn(ct,ft),Array.isArray(ft.mipmap))for(var Ur=ft.mipmap,Un=0;Un<Ur.length;++Un)Et=ct.images[Un]=gn(),Wr(Et,ct),Et.width>>=Un,Et.height>>=Un,Fr(Et,Ur[Un]),ct.mipmask|=1<<Un;else Et=ct.images[0]=gn(),Wr(Et,ct),Fr(Et,ft),ct.mipmask=1;Wr(ct,ct.images[0]),ct.compressed&&(ct.internalformat===Wo||ct.internalformat===Au||ct.internalformat===js||ct.internalformat===Zr)&&J(ct.width%4===0&&ct.height%4===0,"for compressed texture formats, mipmap level 0 must have width and height that are a multiple of 4")}function bo(ct,ft){for(var Et=ct.images,Ur=0;Ur<Et.length;++Ur){if(!Et[Ur])return;gr(Et[Ur],ft,Ur)}}var ro=[];function Ti(){var ct=ro.pop()||new Jn;br.call(ct),ct.mipmask=0;for(var ft=0;ft<16;++ft)ct.images[ft]=null;return ct}function Io(ct){for(var ft=ct.images,Et=0;Et<ft.length;++Et)ft[Et]&&xi(ft[Et]),ft[Et]=null;ro.push(ct)}function Na(){this.minFilter=Fu,this.magFilter=Fu,this.wrapS=wo,this.wrapT=wo,this.anisotropic=1,this.genMipmaps=!1,this.mipmapHint=ho}function Ao(ct,ft){if("min"in ft){var Et=ft.min;J.parameter(Et,kr),ct.minFilter=kr[Et],El.indexOf(ct.minFilter)>=0&&!("faces"in ft)&&(ct.genMipmaps=!0)}if("mag"in ft){var Ur=ft.mag;J.parameter(Ur,Nr),ct.magFilter=Nr[Ur]}var Un=ct.wrapS,ot=ct.wrapT;if("wrap"in ft){var Ye=ft.wrap;typeof Ye=="string"?(J.parameter(Ye,Lr),Un=ot=Lr[Ye]):Array.isArray(Ye)&&(J.parameter(Ye[0],Lr),J.parameter(Ye[1],Lr),Un=Lr[Ye[0]],ot=Lr[Ye[1]])}else{if("wrapS"in ft){var St=ft.wrapS;J.parameter(St,Lr),Un=Lr[St]}if("wrapT"in ft){var Dt=ft.wrapT;J.parameter(Dt,Lr),ot=Lr[Dt]}}if(ct.wrapS=Un,ct.wrapT=ot,"anisotropic"in ft){var Ft=ft.anisotropic;J(typeof Ft=="number"&&Ft>=1&&Ft<=mt.maxAnisotropic,"aniso samples must be between 1 and "),ct.anisotropic=ft.anisotropic}if("mipmap"in ft){var h=!1;switch(typeof ft.mipmap){case"string":J.parameter(ft.mipmap,Tr,"invalid mipmap hint"),ct.mipmapHint=Tr[ft.mipmap],ct.genMipmaps=!0,h=!0;break;case"boolean":h=ct.genMipmaps=ft.mipmap;break;case"object":J(Array.isArray(ft.mipmap),"invalid mipmap type"),ct.genMipmaps=!1,h=!0;break;default:J.raise("invalid mipmap type")}h&&!("min"in ft)&&(ct.minFilter=xl)}}function jo(ct,ft){Ce.texParameteri(ft,Su,ct.minFilter),Ce.texParameteri(ft,Zo,ct.magFilter),Ce.texParameteri(ft,Ff,ct.wrapS),Ce.texParameteri(ft,yl,ct.wrapT),Qe.ext_texture_filter_anisotropic&&Ce.texParameteri(ft,nc,ct.anisotropic),ct.genMipmaps&&(Ce.hint(Cu,ct.mipmapHint),Ce.generateMipmap(ft))}var Fa=0,Ga={},Tn=mt.maxTextureUnits,ya=Array(Tn).map(function(){return null});function un(ct){br.call(this),this.mipmask=0,this.internalformat=Ts,this.id=Fa++,this.refCount=1,this.target=ct,this.texture=Ce.createTexture(),this.unit=-1,this.bindCount=0,this.texInfo=new Na,sr.profile&&(this.stats={size:0})}function da(ct){Ce.activeTexture(Ps),Ce.bindTexture(ct.target,ct.texture)}function ra(){var ct=ya[0];ct?Ce.bindTexture(ct.target,ct.texture):Ce.bindTexture(ui,null)}function Rn(ct){var ft=ct.texture;J(ft,"must not double destroy texture");var Et=ct.unit,Ur=ct.target;Et>=0&&(Ce.activeTexture(Ps+Et),Ce.bindTexture(Ur,null),ya[Et]=null),Ce.deleteTexture(ft),ct.texture=null,ct.params=null,ct.pixels=null,ct.refCount=0,delete Ga[ct.id],er.textureCount--}C(un.prototype,{bind:function(){var ct=this;ct.bindCount+=1;var ft=ct.unit;if(ft<0){for(var Et=0;Et<Tn;++Et){var Ur=ya[Et];if(Ur){if(Ur.bindCount>0)continue;Ur.unit=-1}ya[Et]=ct,ft=Et;break}ft>=Tn&&J.raise("insufficient number of texture units"),sr.profile&&er.maxTextureUnits<ft+1&&(er.maxTextureUnits=ft+1),ct.unit=ft,Ce.activeTexture(Ps+ft),Ce.bindTexture(ct.target,ct.texture)}return ft},unbind:function(){this.bindCount-=1},decRef:function(){--this.refCount<=0&&Rn(this)}});function mi(ct,ft){var Et=new un(ui);Ga[Et.id]=Et,er.textureCount++;function Ur(Ye,St){var Dt=Et.texInfo;Na.call(Dt);var Ft=Ti();return typeof Ye=="number"?typeof St=="number"?gi(Ft,Ye|0,St|0):gi(Ft,Ye|0,Ye|0):Ye?(J.type(Ye,"object","invalid arguments to regl.texture"),Ao(Dt,Ye),ta(Ft,Ye)):gi(Ft,1,1),Dt.genMipmaps&&(Ft.mipmask=(Ft.width<<1)-1),Et.mipmask=Ft.mipmask,Wr(Et,Ft),J.texture2D(Dt,Ft,mt),Et.internalformat=Ft.internalformat,Ur.width=Ft.width,Ur.height=Ft.height,da(Et),bo(Ft,ui),jo(Dt,ui),ra(),Io(Ft),sr.profile&&(Et.stats.size=Nn(Et.internalformat,Et.type,Ft.width,Ft.height,Dt.genMipmaps,!1)),Ur.format=Rr[Et.internalformat],Ur.type=tn[Et.type],Ur.mag=_r[Dt.magFilter],Ur.min=cn[Dt.minFilter],Ur.wrapS=wr[Dt.wrapS],Ur.wrapT=wr[Dt.wrapT],Ur}function Un(Ye,St,Dt,Ft){J(!!Ye,"must specify image data");var h=St|0,f=Dt|0,p=Ft|0,m=gn();return Wr(m,Et),m.width=0,m.height=0,Fr(m,Ye),m.width=m.width||(Et.width>>p)-h,m.height=m.height||(Et.height>>p)-f,J(Et.type===m.type&&Et.format===m.format&&Et.internalformat===m.internalformat,"incompatible format for texture.subimage"),J(h>=0&&f>=0&&h+m.width<=Et.width&&f+m.height<=Et.height,"texture.subimage write out of bounds"),J(Et.mipmask&1<<p,"missing mipmap data"),J(m.data||m.element||m.needsCopy,"missing image data"),da(Et),On(m,ui,h,f,p),ra(),xi(m),Ur}function ot(Ye,St){var Dt=Ye|0,Ft=St|0||Dt;if(Dt===Et.width&&Ft===Et.height)return Ur;Ur.width=Et.width=Dt,Ur.height=Et.height=Ft,da(Et);for(var h=0;Et.mipmask>>h;++h){var f=Dt>>h,p=Ft>>h;if(!f||!p)break;Ce.texImage2D(ui,h,Et.format,f,p,0,Et.format,Et.type,null)}return ra(),sr.profile&&(Et.stats.size=Nn(Et.internalformat,Et.type,Dt,Ft,!1,!1)),Ur}return Ur(ct,ft),Ur.subimage=Un,Ur.resize=ot,Ur._reglType="texture2d",Ur._texture=Et,sr.profile&&(Ur.stats=Et.stats),Ur.destroy=function(){Et.decRef()},Ur}function vr(ct,ft,Et,Ur,Un,ot){var Ye=new un(hs);Ga[Ye.id]=Ye,er.cubeCount++;var St=new Array(6);function Dt(f,p,m,E,S,I){var D,V=Ye.texInfo;for(Na.call(V),D=0;D<6;++D)St[D]=Ti();if(typeof f=="number"||!f){var re=f|0||1;for(D=0;D<6;++D)gi(St[D],re,re)}else if(typeof f=="object")if(p)ta(St[0],f),ta(St[1],p),ta(St[2],m),ta(St[3],E),ta(St[4],S),ta(St[5],I);else if(Ao(V,f),Cn(Ye,f),"faces"in f){var xe=f.faces;for(J(Array.isArray(xe)&&xe.length===6,"cube faces must be a length 6 array"),D=0;D<6;++D)J(typeof xe[D]=="object"&&!!xe[D],"invalid input for cube map face"),Wr(St[D],Ye),ta(St[D],xe[D])}else for(D=0;D<6;++D)ta(St[D],f);else J.raise("invalid arguments to cube map");for(Wr(Ye,St[0]),mt.npotTextureCube||J(ko(Ye.width)&&ko(Ye.height),"your browser does not support non power or two texture dimensions"),V.genMipmaps?Ye.mipmask=(St[0].width<<1)-1:Ye.mipmask=St[0].mipmask,J.textureCube(Ye,V,St,mt),Ye.internalformat=St[0].internalformat,Dt.width=St[0].width,Dt.height=St[0].height,da(Ye),D=0;D<6;++D)bo(St[D],aa+D);for(jo(V,hs),ra(),sr.profile&&(Ye.stats.size=Nn(Ye.internalformat,Ye.type,Dt.width,Dt.height,V.genMipmaps,!0)),Dt.format=Rr[Ye.internalformat],Dt.type=tn[Ye.type],Dt.mag=_r[V.magFilter],Dt.min=cn[V.minFilter],Dt.wrapS=wr[V.wrapS],Dt.wrapT=wr[V.wrapT],D=0;D<6;++D)Io(St[D]);return Dt}function Ft(f,p,m,E,S){J(!!p,"must specify image data"),J(typeof f=="number"&&f===(f|0)&&f>=0&&f<6,"invalid face");var I=m|0,D=E|0,V=S|0,re=gn();return Wr(re,Ye),re.width=0,re.height=0,Fr(re,p),re.width=re.width||(Ye.width>>V)-I,re.height=re.height||(Ye.height>>V)-D,J(Ye.type===re.type&&Ye.format===re.format&&Ye.internalformat===re.internalformat,"incompatible format for texture.subimage"),J(I>=0&&D>=0&&I+re.width<=Ye.width&&D+re.height<=Ye.height,"texture.subimage write out of bounds"),J(Ye.mipmask&1<<V,"missing mipmap data"),J(re.data||re.element||re.needsCopy,"missing image data"),da(Ye),On(re,aa+f,I,D,V),ra(),xi(re),Dt}function h(f){var p=f|0;if(p!==Ye.width){Dt.width=Ye.width=p,Dt.height=Ye.height=p,da(Ye);for(var m=0;m<6;++m)for(var E=0;Ye.mipmask>>E;++E)Ce.texImage2D(aa+m,E,Ye.format,p>>E,p>>E,0,Ye.format,Ye.type,null);return ra(),sr.profile&&(Ye.stats.size=Nn(Ye.internalformat,Ye.type,Dt.width,Dt.height,!1,!0)),Dt}}return Dt(ct,ft,Et,Ur,Un,ot),Dt.subimage=Ft,Dt.resize=h,Dt._reglType="textureCube",Dt._texture=Ye,sr.profile&&(Dt.stats=Ye.stats),Dt.destroy=function(){Ye.decRef()},Dt}function Ri(){for(var ct=0;ct<Tn;++ct)Ce.activeTexture(Ps+ct),Ce.bindTexture(ui,null),ya[ct]=null;Gt(Ga).forEach(Rn),er.cubeCount=0,er.textureCount=0}sr.profile&&(er.getTotalTextureSize=function(){var ct=0;return Object.keys(Ga).forEach(function(ft){ct+=Ga[ft].stats.size}),ct});function Xt(){for(var ct=0;ct<Tn;++ct){var ft=ya[ct];ft&&(ft.bindCount=0,ft.unit=-1,ya[ct]=null)}Gt(Ga).forEach(function(Et){Et.texture=Ce.createTexture(),Ce.bindTexture(Et.target,Et.texture);for(var Ur=0;Ur<32;++Ur)if(Et.mipmask&1<<Ur)if(Et.target===ui)Ce.texImage2D(ui,Ur,Et.internalformat,Et.width>>Ur,Et.height>>Ur,0,Et.internalformat,Et.type,null);else for(var Un=0;Un<6;++Un)Ce.texImage2D(aa+Un,Ur,Et.internalformat,Et.width>>Ur,Et.height>>Ur,0,Et.internalformat,Et.type,null);jo(Et.texInfo,Et.target)})}function Jo(){for(var ct=0;ct<Tn;++ct){var ft=ya[ct];ft&&(ft.bindCount=0,ft.unit=-1,ya[ct]=null),Ce.activeTexture(Ps+ct),Ce.bindTexture(ui,null),Ce.bindTexture(hs,null)}}return{create2D:mi,createCube:vr,clear:Ri,getTexture:function(ct){return null},restore:Xt,refresh:Jo}}var $n=36161,Li=32854,Oi=32855,Qi=36194,qi=33189,hi=36168,Si=34041,Ci=35907,ji=34836,li=34842,wu=34843,Qo=[];Qo[Li]=2,Qo[Oi]=2,Qo[Qi]=2,Qo[qi]=2,Qo[hi]=1,Qo[Si]=4,Qo[Ci]=4,Qo[ji]=16,Qo[li]=8,Qo[wu]=6;function nl(Ce,Qe,mt){return Qo[Ce]*Qe*mt}var Zu=function(Ce,Qe,mt,nr,Ar){var er={rgba4:Li,rgb565:Qi,"rgb5 a1":Oi,depth:qi,stencil:hi,"depth stencil":Si};Qe.ext_srgb&&(er.srgba=Ci),Qe.ext_color_buffer_half_float&&(er.rgba16f=li,er.rgb16f=wu),Qe.webgl_color_buffer_float&&(er.rgba32f=ji);var sr=[];Object.keys(er).forEach(function(Mr){var zr=er[Mr];sr[zr]=Mr});var Tr=0,Lr={};function Nr(Mr){this.id=Tr++,this.refCount=1,this.renderbuffer=Mr,this.format=Li,this.width=0,this.height=0,Ar.profile&&(this.stats={size:0})}Nr.prototype.decRef=function(){--this.refCount<=0&&kr(this)};function kr(Mr){var zr=Mr.renderbuffer;J(zr,"must not double destroy renderbuffer"),Ce.bindRenderbuffer($n,null),Ce.deleteRenderbuffer(zr),Mr.renderbuffer=null,Mr.refCount=0,delete Lr[Mr.id],nr.renderbufferCount--}function Or(Mr,zr){var Vt=new Nr(Ce.createRenderbuffer());Lr[Vt.id]=Vt,nr.renderbufferCount++;function lr(tn,_r){var cn=0,wr=0,Hr=Li;if(typeof tn=="object"&&tn){var br=tn;if("shape"in br){var Wr=br.shape;J(Array.isArray(Wr)&&Wr.length>=2,"invalid renderbuffer shape"),cn=Wr[0]|0,wr=Wr[1]|0}else"radius"in br&&(cn=wr=br.radius|0),"width"in br&&(cn=br.width|0),"height"in br&&(wr=br.height|0);"format"in br&&(J.parameter(br.format,er,"invalid renderbuffer format"),Hr=er[br.format])}else typeof tn=="number"?(cn=tn|0,typeof _r=="number"?wr=_r|0:wr=cn):tn?J.raise("invalid arguments to renderbuffer constructor"):cn=wr=1;if(J(cn>0&&wr>0&&cn<=mt.maxRenderbufferSize&&wr<=mt.maxRenderbufferSize,"invalid renderbuffer size"),!(cn===Vt.width&&wr===Vt.height&&Hr===Vt.format))return lr.width=Vt.width=cn,lr.height=Vt.height=wr,Vt.format=Hr,Ce.bindRenderbuffer($n,Vt.renderbuffer),Ce.renderbufferStorage($n,Hr,cn,wr),J(Ce.getError()===0,"invalid render buffer format"),Ar.profile&&(Vt.stats.size=nl(Vt.format,Vt.width,Vt.height)),lr.format=sr[Vt.format],lr}function Rr(tn,_r){var cn=tn|0,wr=_r|0||cn;return cn===Vt.width&&wr===Vt.height||(J(cn>0&&wr>0&&cn<=mt.maxRenderbufferSize&&wr<=mt.maxRenderbufferSize,"invalid renderbuffer size"),lr.width=Vt.width=cn,lr.height=Vt.height=wr,Ce.bindRenderbuffer($n,Vt.renderbuffer),Ce.renderbufferStorage($n,Vt.format,cn,wr),J(Ce.getError()===0,"invalid render buffer format"),Ar.profile&&(Vt.stats.size=nl(Vt.format,Vt.width,Vt.height))),lr}return lr(Mr,zr),lr.resize=Rr,lr._reglType="renderbuffer",lr._renderbuffer=Vt,Ar.profile&&(lr.stats=Vt.stats),lr.destroy=function(){Vt.decRef()},lr}Ar.profile&&(nr.getTotalRenderbufferSize=function(){var Mr=0;return Object.keys(Lr).forEach(function(zr){Mr+=Lr[zr].stats.size}),Mr});function qr(){Gt(Lr).forEach(function(Mr){Mr.renderbuffer=Ce.createRenderbuffer(),Ce.bindRenderbuffer($n,Mr.renderbuffer),Ce.renderbufferStorage($n,Mr.format,Mr.width,Mr.height)}),Ce.bindRenderbuffer($n,null)}return{create:Or,clear:function(){Gt(Lr).forEach(kr)},restore:qr}},Fn=36160,qo=36161,Ws=3553,du=34069,vs=36064,bl=36096,gs=36128,Da=33306,il=36053,tf=36054,o=36055,s=36057,d=36061,_=36193,w=5121,j=5126,ie=6407,ke=6408,tt=6402,Pt=[ie,ke],tr=[];tr[ke]=4,tr[ie]=3;var st=[];st[w]=1,st[j]=4,st[_]=2;var Zt=32854,Jt=32855,yr=36194,v=33189,Pn=36168,jn=34041,Xe=35907,Ia=34836,ao=34842,xo=34843,sa=[Zt,Jt,yr,Xe,ao,xo,Ia],ka={};ka[il]="complete",ka[tf]="incomplete attachment",ka[s]="incomplete dimensions",ka[o]="incomplete, missing attachment",ka[d]="unsupported";function os(Ce,Qe,mt,nr,Ar,er){var sr={cur:null,next:null,dirty:!1,setFBO:null},Tr=["rgba"],Lr=["rgba4","rgb565","rgb5 a1"];Qe.ext_srgb&&Lr.push("srgba"),Qe.ext_color_buffer_half_float&&Lr.push("rgba16f","rgb16f"),Qe.webgl_color_buffer_float&&Lr.push("rgba32f");var Nr=["uint8"];Qe.oes_texture_half_float&&Nr.push("half float","float16"),Qe.oes_texture_float&&Nr.push("float","float32");function kr(Ir,Fr,gr){this.target=Ir,this.texture=Fr,this.renderbuffer=gr;var On=0,Bn=0;Fr?(On=Fr.width,Bn=Fr.height):gr&&(On=gr.width,Bn=gr.height),this.width=On,this.height=Bn}function Or(Ir){Ir&&(Ir.texture&&Ir.texture._texture.decRef(),Ir.renderbuffer&&Ir.renderbuffer._renderbuffer.decRef())}function qr(Ir,Fr,gr){if(Ir)if(Ir.texture){var On=Ir.texture._texture,Bn=Math.max(1,On.width),gn=Math.max(1,On.height);J(Bn===Fr&&gn===gr,"inconsistent width/height for supplied texture"),On.refCount+=1}else{var xi=Ir.renderbuffer._renderbuffer;J(xi.width===Fr&&xi.height===gr,"inconsistent width/height for renderbuffer"),xi.refCount+=1}}function Mr(Ir,Fr){Fr&&(Fr.texture?Ce.framebufferTexture2D(Fn,Ir,Fr.target,Fr.texture._texture.texture,0):Ce.framebufferRenderbuffer(Fn,Ir,qo,Fr.renderbuffer._renderbuffer.renderbuffer))}function zr(Ir){var Fr=Ws,gr=null,On=null,Bn=Ir;typeof Ir=="object"&&(Bn=Ir.data,"target"in Ir&&(Fr=Ir.target|0)),J.type(Bn,"function","invalid attachment data");var gn=Bn._reglType;return gn==="texture2d"?(gr=Bn,J(Fr===Ws)):gn==="textureCube"?(gr=Bn,J(Fr>=du&&Fr<du+6,"invalid cube map target")):gn==="renderbuffer"?(On=Bn,Fr=qo):J.raise("invalid regl object for attachment"),new kr(Fr,gr,On)}function Vt(Ir,Fr,gr,On,Bn){if(gr){var gn=nr.create2D({width:Ir,height:Fr,format:On,type:Bn});return gn._texture.refCount=0,new kr(Ws,gn,null)}else{var xi=Ar.create({width:Ir,height:Fr,format:On});return xi._renderbuffer.refCount=0,new kr(qo,null,xi)}}function lr(Ir){return Ir&&(Ir.texture||Ir.renderbuffer)}function Rr(Ir,Fr,gr){Ir&&(Ir.texture?Ir.texture.resize(Fr,gr):Ir.renderbuffer&&Ir.renderbuffer.resize(Fr,gr),Ir.width=Fr,Ir.height=gr)}var tn=0,_r={};function cn(){this.id=tn++,_r[this.id]=this,this.framebuffer=Ce.createFramebuffer(),this.width=0,this.height=0,this.colorAttachments=[],this.depthAttachment=null,this.stencilAttachment=null,this.depthStencilAttachment=null}function wr(Ir){Ir.colorAttachments.forEach(Or),Or(Ir.depthAttachment),Or(Ir.stencilAttachment),Or(Ir.depthStencilAttachment)}function Hr(Ir){var Fr=Ir.framebuffer;J(Fr,"must not double destroy framebuffer"),Ce.deleteFramebuffer(Fr),Ir.framebuffer=null,er.framebufferCount--,delete _r[Ir.id]}function br(Ir){var Fr;Ce.bindFramebuffer(Fn,Ir.framebuffer);var gr=Ir.colorAttachments;for(Fr=0;Fr<gr.length;++Fr)Mr(vs+Fr,gr[Fr]);for(Fr=gr.length;Fr<mt.maxColorAttachments;++Fr)Ce.framebufferTexture2D(Fn,vs+Fr,Ws,null,0);Ce.framebufferTexture2D(Fn,Da,Ws,null,0),Ce.framebufferTexture2D(Fn,bl,Ws,null,0),Ce.framebufferTexture2D(Fn,gs,Ws,null,0),Mr(bl,Ir.depthAttachment),Mr(gs,Ir.stencilAttachment),Mr(Da,Ir.depthStencilAttachment);var On=Ce.checkFramebufferStatus(Fn);!Ce.isContextLost()&&On!==il&&J.raise("framebuffer configuration not supported, status = "+ka[On]),Ce.bindFramebuffer(Fn,sr.next?sr.next.framebuffer:null),sr.cur=sr.next,Ce.getError()}function Wr(Ir,Fr){var gr=new cn;er.framebufferCount++;function On(gn,xi){var Jn;J(sr.next!==gr,"can not update framebuffer which is currently in use");var gi=0,ta=0,bo=!0,ro=!0,Ti=null,Io=!0,Na="rgba",Ao="uint8",jo=1,Fa=null,Ga=null,Tn=null,ya=!1;if(typeof gn=="number")gi=gn|0,ta=xi|0||gi;else if(!gn)gi=ta=1;else{J.type(gn,"object","invalid arguments for framebuffer");var un=gn;if("shape"in un){var da=un.shape;J(Array.isArray(da)&&da.length>=2,"invalid shape for framebuffer"),gi=da[0],ta=da[1]}else"radius"in un&&(gi=ta=un.radius),"width"in un&&(gi=un.width),"height"in un&&(ta=un.height);("color"in un||"colors"in un)&&(Ti=un.color||un.colors,Array.isArray(Ti)&&J(Ti.length===1||Qe.webgl_draw_buffers,"multiple render targets not supported")),Ti||("colorCount"in un&&(jo=un.colorCount|0,J(jo>0,"invalid color buffer count")),"colorTexture"in un&&(Io=!!un.colorTexture,Na="rgba4"),"colorType"in un&&(Ao=un.colorType,Io?(J(Qe.oes_texture_float||!(Ao==="float"||Ao==="float32"),"you must enable OES_texture_float in order to use floating point framebuffer objects"),J(Qe.oes_texture_half_float||!(Ao==="half float"||Ao==="float16"),"you must enable OES_texture_half_float in order to use 16-bit floating point framebuffer objects")):Ao==="half float"||Ao==="float16"?(J(Qe.ext_color_buffer_half_float,"you must enable EXT_color_buffer_half_float to use 16-bit render buffers"),Na="rgba16f"):(Ao==="float"||Ao==="float32")&&(J(Qe.webgl_color_buffer_float,"you must enable WEBGL_color_buffer_float in order to use 32-bit floating point renderbuffers"),Na="rgba32f"),J.oneOf(Ao,Nr,"invalid color type")),"colorFormat"in un&&(Na=un.colorFormat,Tr.indexOf(Na)>=0?Io=!0:Lr.indexOf(Na)>=0?Io=!1:Io?J.oneOf(un.colorFormat,Tr,"invalid color format for texture"):J.oneOf(un.colorFormat,Lr,"invalid color format for renderbuffer"))),("depthTexture"in un||"depthStencilTexture"in un)&&(ya=!!(un.depthTexture||un.depthStencilTexture),J(!ya||Qe.webgl_depth_texture,"webgl_depth_texture extension not supported")),"depth"in un&&(typeof un.depth=="boolean"?bo=un.depth:(Fa=un.depth,ro=!1)),"stencil"in un&&(typeof un.stencil=="boolean"?ro=un.stencil:(Ga=un.stencil,bo=!1)),"depthStencil"in un&&(typeof un.depthStencil=="boolean"?bo=ro=un.depthStencil:(Tn=un.depthStencil,bo=!1,ro=!1))}var ra=null,Rn=null,mi=null,vr=null;if(Array.isArray(Ti))ra=Ti.map(zr);else if(Ti)ra=[zr(Ti)];else for(ra=new Array(jo),Jn=0;Jn<jo;++Jn)ra[Jn]=Vt(gi,ta,Io,Na,Ao);J(Qe.webgl_draw_buffers||ra.length<=1,"you must enable the WEBGL_draw_buffers extension in order to use multiple color buffers."),J(ra.length<=mt.maxColorAttachments,"too many color attachments, not supported"),gi=gi||ra[0].width,ta=ta||ra[0].height,Fa?Rn=zr(Fa):bo&&!ro&&(Rn=Vt(gi,ta,ya,"depth","uint32")),Ga?mi=zr(Ga):ro&&!bo&&(mi=Vt(gi,ta,!1,"stencil","uint8")),Tn?vr=zr(Tn):!Fa&&!Ga&&ro&&bo&&(vr=Vt(gi,ta,ya,"depth stencil","depth stencil")),J(!!Fa+!!Ga+!!Tn<=1,"invalid framebuffer configuration, can specify exactly one depth/stencil attachment");var Ri=null;for(Jn=0;Jn<ra.length;++Jn)if(qr(ra[Jn],gi,ta),J(!ra[Jn]||ra[Jn].texture&&Pt.indexOf(ra[Jn].texture._texture.format)>=0||ra[Jn].renderbuffer&&sa.indexOf(ra[Jn].renderbuffer._renderbuffer.format)>=0,"framebuffer color attachment "+Jn+" is invalid"),ra[Jn]&&ra[Jn].texture){var Xt=tr[ra[Jn].texture._texture.format]*st[ra[Jn].texture._texture.type];Ri===null?Ri=Xt:J(Ri===Xt,"all color attachments much have the same number of bits per pixel.")}return qr(Rn,gi,ta),J(!Rn||Rn.texture&&Rn.texture._texture.format===tt||Rn.renderbuffer&&Rn.renderbuffer._renderbuffer.format===v,"invalid depth attachment for framebuffer object"),qr(mi,gi,ta),J(!mi||mi.renderbuffer&&mi.renderbuffer._renderbuffer.format===Pn,"invalid stencil attachment for framebuffer object"),qr(vr,gi,ta),J(!vr||vr.texture&&vr.texture._texture.format===jn||vr.renderbuffer&&vr.renderbuffer._renderbuffer.format===jn,"invalid depth-stencil attachment for framebuffer object"),wr(gr),gr.width=gi,gr.height=ta,gr.colorAttachments=ra,gr.depthAttachment=Rn,gr.stencilAttachment=mi,gr.depthStencilAttachment=vr,On.color=ra.map(lr),On.depth=lr(Rn),On.stencil=lr(mi),On.depthStencil=lr(vr),On.width=gr.width,On.height=gr.height,br(gr),On}function Bn(gn,xi){J(sr.next!==gr,"can not resize a framebuffer which is currently in use");var Jn=Math.max(gn|0,1),gi=Math.max(xi|0||Jn,1);if(Jn===gr.width&&gi===gr.height)return On;for(var ta=gr.colorAttachments,bo=0;bo<ta.length;++bo)Rr(ta[bo],Jn,gi);return Rr(gr.depthAttachment,Jn,gi),Rr(gr.stencilAttachment,Jn,gi),Rr(gr.depthStencilAttachment,Jn,gi),gr.width=On.width=Jn,gr.height=On.height=gi,br(gr),On}return On(Ir,Fr),C(On,{resize:Bn,_reglType:"framebuffer",_framebuffer:gr,destroy:function(){Hr(gr),wr(gr)},use:function(gn){sr.setFBO({framebuffer:On},gn)}})}function Cn(Ir){var Fr=Array(6);function gr(Bn){var gn;J(Fr.indexOf(sr.next)<0,"can not update framebuffer which is currently in use");var xi={color:null},Jn=0,gi=null,ta="rgba",bo="uint8",ro=1;if(typeof Bn=="number")Jn=Bn|0;else if(!Bn)Jn=1;else{J.type(Bn,"object","invalid arguments for framebuffer");var Ti=Bn;if("shape"in Ti){var Io=Ti.shape;J(Array.isArray(Io)&&Io.length>=2,"invalid shape for framebuffer"),J(Io[0]===Io[1],"cube framebuffer must be square"),Jn=Io[0]}else"radius"in Ti&&(Jn=Ti.radius|0),"width"in Ti?(Jn=Ti.width|0,"height"in Ti&&J(Ti.height===Jn,"must be square")):"height"in Ti&&(Jn=Ti.height|0);("color"in Ti||"colors"in Ti)&&(gi=Ti.color||Ti.colors,Array.isArray(gi)&&J(gi.length===1||Qe.webgl_draw_buffers,"multiple render targets not supported")),gi||("colorCount"in Ti&&(ro=Ti.colorCount|0,J(ro>0,"invalid color buffer count")),"colorType"in Ti&&(J.oneOf(Ti.colorType,Nr,"invalid color type"),bo=Ti.colorType),"colorFormat"in Ti&&(ta=Ti.colorFormat,J.oneOf(Ti.colorFormat,Tr,"invalid color format for texture"))),"depth"in Ti&&(xi.depth=Ti.depth),"stencil"in Ti&&(xi.stencil=Ti.stencil),"depthStencil"in Ti&&(xi.depthStencil=Ti.depthStencil)}var Na;if(gi)if(Array.isArray(gi))for(Na=[],gn=0;gn<gi.length;++gn)Na[gn]=gi[gn];else Na=[gi];else{Na=Array(ro);var Ao={radius:Jn,format:ta,type:bo};for(gn=0;gn<ro;++gn)Na[gn]=nr.createCube(Ao)}for(xi.color=Array(Na.length),gn=0;gn<Na.length;++gn){var jo=Na[gn];J(typeof jo=="function"&&jo._reglType==="textureCube","invalid cube map"),Jn=Jn||jo.width,J(jo.width===Jn&&jo.height===Jn,"invalid cube map shape"),xi.color[gn]={target:du,data:Na[gn]}}for(gn=0;gn<6;++gn){for(var Fa=0;Fa<Na.length;++Fa)xi.color[Fa].target=du+gn;gn>0&&(xi.depth=Fr[0].depth,xi.stencil=Fr[0].stencil,xi.depthStencil=Fr[0].depthStencil),Fr[gn]?Fr[gn](xi):Fr[gn]=Wr(xi)}return C(gr,{width:Jn,height:Jn,color:Na})}function On(Bn){var gn,xi=Bn|0;if(J(xi>0&&xi<=mt.maxCubeMapSize,"invalid radius for cube fbo"),xi===gr.width)return gr;var Jn=gr.color;for(gn=0;gn<Jn.length;++gn)Jn[gn].resize(xi);for(gn=0;gn<6;++gn)Fr[gn].resize(xi);return gr.width=gr.height=xi,gr}return gr(Ir),C(gr,{faces:Fr,resize:On,_reglType:"framebufferCube",destroy:function(){Fr.forEach(function(Bn){Bn.destroy()})}})}function Xn(){sr.cur=null,sr.next=null,sr.dirty=!0,Gt(_r).forEach(function(Ir){Ir.framebuffer=Ce.createFramebuffer(),br(Ir)})}return C(sr,{getFramebuffer:function(Ir){if(typeof Ir=="function"&&Ir._reglType==="framebuffer"){var Fr=Ir._framebuffer;if(Fr instanceof cn)return Fr}return null},create:Wr,createCube:Cn,clear:function(){Gt(_r).forEach(Hr)},restore:Xn})}var ba=5126,Vr=34962;function hn(){this.state=0,this.x=0,this.y=0,this.z=0,this.w=0,this.buffer=null,this.size=0,this.normalized=!1,this.type=ba,this.offset=0,this.stride=0,this.divisor=0}function Yn(Ce,Qe,mt,nr,Ar){for(var er=mt.maxAttributes,sr=new Array(er),Tr=0;Tr<er;++Tr)sr[Tr]=new hn;var Lr=0,Nr={},kr={Record:hn,scope:{},state:sr,currentVAO:null,targetVAO:null,restore:qr()?_r:function(){},createVAO:cn,getVAO:zr,destroyBuffer:Or,setVAO:qr()?Vt:lr,clear:qr()?Rr:function(){}};function Or(wr){for(var Hr=0;Hr<sr.length;++Hr){var br=sr[Hr];br.buffer===wr&&(Ce.disableVertexAttribArray(Hr),br.buffer=null)}}function qr(){return Qe.oes_vertex_array_object}function Mr(){return Qe.angle_instanced_arrays}function zr(wr){return typeof wr=="function"&&wr._vao?wr._vao:null}function Vt(wr){if(wr!==kr.currentVAO){var Hr=qr();wr?Hr.bindVertexArrayOES(wr.vao):Hr.bindVertexArrayOES(null),kr.currentVAO=wr}}function lr(wr){if(wr!==kr.currentVAO){if(wr)wr.bindAttrs();else for(var Hr=Mr(),br=0;br<sr.length;++br){var Wr=sr[br];Wr.buffer?(Ce.enableVertexAttribArray(br),Ce.vertexAttribPointer(br,Wr.size,Wr.type,Wr.normalized,Wr.stride,Wr.offfset),Hr&&Wr.divisor&&Hr.vertexAttribDivisorANGLE(br,Wr.divisor)):(Ce.disableVertexAttribArray(br),Ce.vertexAttrib4f(br,Wr.x,Wr.y,Wr.z,Wr.w))}kr.currentVAO=wr}}function Rr(){Gt(Nr).forEach(function(wr){wr.destroy()})}function tn(){this.id=++Lr,this.attributes=[];var wr=qr();wr?this.vao=wr.createVertexArrayOES():this.vao=null,Nr[this.id]=this,this.buffers=[]}tn.prototype.bindAttrs=function(){for(var wr=Mr(),Hr=this.attributes,br=0;br<Hr.length;++br){var Wr=Hr[br];Wr.buffer?(Ce.enableVertexAttribArray(br),Ce.bindBuffer(Vr,Wr.buffer.buffer),Ce.vertexAttribPointer(br,Wr.size,Wr.type,Wr.normalized,Wr.stride,Wr.offset),wr&&Wr.divisor&&wr.vertexAttribDivisorANGLE(br,Wr.divisor)):(Ce.disableVertexAttribArray(br),Ce.vertexAttrib4f(br,Wr.x,Wr.y,Wr.z,Wr.w))}for(var Cn=Hr.length;Cn<er;++Cn)Ce.disableVertexAttribArray(Cn)},tn.prototype.refresh=function(){var wr=qr();wr&&(wr.bindVertexArrayOES(this.vao),this.bindAttrs(),kr.currentVAO=this)},tn.prototype.destroy=function(){if(this.vao){var wr=qr();this===kr.currentVAO&&(kr.currentVAO=null,wr.bindVertexArrayOES(null)),wr.deleteVertexArrayOES(this.vao),this.vao=null}Nr[this.id]&&(delete Nr[this.id],nr.vaoCount-=1)};function _r(){var wr=qr();wr&&Gt(Nr).forEach(function(Hr){Hr.refresh()})}function cn(wr){var Hr=new tn;nr.vaoCount+=1;function br(Wr){J(Array.isArray(Wr),"arguments to vertex array constructor must be an array"),J(Wr.length<er,"too many attributes"),J(Wr.length>0,"must specify at least one attribute");var Cn={},Xn=Hr.attributes;Xn.length=Wr.length;for(var Ir=0;Ir<Wr.length;++Ir){var Fr=Wr[Ir],gr=Xn[Ir]=new hn,On=Fr.data||Fr;if(Array.isArray(On)||$(On)||He(On)){var Bn;Hr.buffers[Ir]&&(Bn=Hr.buffers[Ir],$(On)&&Bn._buffer.byteLength>=On.byteLength?Bn.subdata(On):(Bn.destroy(),Hr.buffers[Ir]=null)),Hr.buffers[Ir]||(Bn=Hr.buffers[Ir]=Ar.create(Fr,Vr,!1,!0)),gr.buffer=Ar.getBuffer(Bn),gr.size=gr.buffer.dimension|0,gr.normalized=!1,gr.type=gr.buffer.dtype,gr.offset=0,gr.stride=0,gr.divisor=0,gr.state=1,Cn[Ir]=1}else Ar.getBuffer(Fr)?(gr.buffer=Ar.getBuffer(Fr),gr.size=gr.buffer.dimension|0,gr.normalized=!1,gr.type=gr.buffer.dtype,gr.offset=0,gr.stride=0,gr.divisor=0,gr.state=1):Ar.getBuffer(Fr.buffer)?(gr.buffer=Ar.getBuffer(Fr.buffer),gr.size=(+Fr.size||gr.buffer.dimension)|0,gr.normalized=!!Fr.normalized||!1,"type"in Fr?(J.parameter(Fr.type,qa,"invalid buffer type"),gr.type=qa[Fr.type]):gr.type=gr.buffer.dtype,gr.offset=(Fr.offset||0)|0,gr.stride=(Fr.stride||0)|0,gr.divisor=(Fr.divisor||0)|0,gr.state=1,J(gr.size>=1&&gr.size<=4,"size must be between 1 and 4"),J(gr.offset>=0,"invalid offset"),J(gr.stride>=0&&gr.stride<=255,"stride must be between 0 and 255"),J(gr.divisor>=0,"divisor must be positive"),J(!gr.divisor||!!Qe.angle_instanced_arrays,"ANGLE_instanced_arrays must be enabled to use divisor")):"x"in Fr?(J(Ir>0,"first attribute must not be a constant"),gr.x=+Fr.x||0,gr.y=+Fr.y||0,gr.z=+Fr.z||0,gr.w=+Fr.w||0,gr.state=2):J(!1,"invalid attribute spec for location "+Ir)}for(var gn=0;gn<Hr.buffers.length;++gn)!Cn[gn]&&Hr.buffers[gn]&&(Hr.buffers[gn].destroy(),Hr.buffers[gn]=null);return Hr.refresh(),br}return br.destroy=function(){for(var Wr=0;Wr<Hr.buffers.length;++Wr)Hr.buffers[Wr]&&Hr.buffers[Wr].destroy();Hr.buffers.length=0,Hr.destroy()},br._vao=Hr,br._reglType="vao",br(wr)}return kr}var Dn=35632,Kn=35633,Ln=35718,Fi=35721;function wi(Ce,Qe,mt,nr){var Ar={},er={};function sr(Vt,lr,Rr,tn){this.name=Vt,this.id=lr,this.location=Rr,this.info=tn}function Tr(Vt,lr){for(var Rr=0;Rr<Vt.length;++Rr)if(Vt[Rr].id===lr.id){Vt[Rr].location=lr.location;return}Vt.push(lr)}function Lr(Vt,lr,Rr){var tn=Vt===Dn?Ar:er,_r=tn[lr];if(!_r){var cn=Qe.str(lr);_r=Ce.createShader(Vt),Ce.shaderSource(_r,cn),Ce.compileShader(_r),J.shaderError(Ce,_r,cn,Vt,Rr),tn[lr]=_r}return _r}var Nr={},kr=[],Or=0;function qr(Vt,lr){this.id=Or++,this.fragId=Vt,this.vertId=lr,this.program=null,this.uniforms=[],this.attributes=[],this.refCount=1,nr.profile&&(this.stats={uniformsCount:0,attributesCount:0})}function Mr(Vt,lr,Rr){var tn,_r,cn=Lr(Dn,Vt.fragId),wr=Lr(Kn,Vt.vertId),Hr=Vt.program=Ce.createProgram();if(Ce.attachShader(Hr,cn),Ce.attachShader(Hr,wr),Rr)for(tn=0;tn<Rr.length;++tn){var br=Rr[tn];Ce.bindAttribLocation(Hr,br[0],br[1])}Ce.linkProgram(Hr),J.linkError(Ce,Hr,Qe.str(Vt.fragId),Qe.str(Vt.vertId),lr);var Wr=Ce.getProgramParameter(Hr,Ln);nr.profile&&(Vt.stats.uniformsCount=Wr);var Cn=Vt.uniforms;for(tn=0;tn<Wr;++tn)if(_r=Ce.getActiveUniform(Hr,tn),_r)if(_r.size>1)for(var Xn=0;Xn<_r.size;++Xn){var Ir=_r.name.replace("[0]","["+Xn+"]");Tr(Cn,new sr(Ir,Qe.id(Ir),Ce.getUniformLocation(Hr,Ir),_r))}else Tr(Cn,new sr(_r.name,Qe.id(_r.name),Ce.getUniformLocation(Hr,_r.name),_r));var Fr=Ce.getProgramParameter(Hr,Fi);nr.profile&&(Vt.stats.attributesCount=Fr);var gr=Vt.attributes;for(tn=0;tn<Fr;++tn)_r=Ce.getActiveAttrib(Hr,tn),_r&&Tr(gr,new sr(_r.name,Qe.id(_r.name),Ce.getAttribLocation(Hr,_r.name),_r))}nr.profile&&(mt.getMaxUniformsCount=function(){var Vt=0;return kr.forEach(function(lr){lr.stats.uniformsCount>Vt&&(Vt=lr.stats.uniformsCount)}),Vt},mt.getMaxAttributesCount=function(){var Vt=0;return kr.forEach(function(lr){lr.stats.attributesCount>Vt&&(Vt=lr.stats.attributesCount)}),Vt});function zr(){Ar={},er={};for(var Vt=0;Vt<kr.length;++Vt)Mr(kr[Vt],null,kr[Vt].attributes.map(function(lr){return[lr.location,lr.name]}))}return{clear:function(){var Vt=Ce.deleteShader.bind(Ce);Gt(Ar).forEach(Vt),Ar={},Gt(er).forEach(Vt),er={},kr.forEach(function(lr){Ce.deleteProgram(lr.program)}),kr.length=0,Nr={},mt.shaderCount=0},program:function(Vt,lr,Rr,tn){J.command(Vt>=0,"missing vertex shader",Rr),J.command(lr>=0,"missing fragment shader",Rr);var _r=Nr[lr];_r||(_r=Nr[lr]={});var cn=_r[Vt];if(cn&&(cn.refCount++,!tn))return cn;var wr=new qr(lr,Vt);return mt.shaderCount++,Mr(wr,Rr,tn),cn||(_r[Vt]=wr),kr.push(wr),C(wr,{destroy:function(){if(wr.refCount--,wr.refCount<=0){Ce.deleteProgram(wr.program);var Hr=kr.indexOf(wr);kr.splice(Hr,1),mt.shaderCount--}_r[wr.vertId].refCount<=0&&(Ce.deleteShader(er[wr.vertId]),delete er[wr.vertId],delete Nr[wr.fragId][wr.vertId]),Object.keys(Nr[wr.fragId]).length||(Ce.deleteShader(Ar[wr.fragId]),delete Ar[wr.fragId],delete Nr[wr.fragId])}})},restore:zr,shader:Lr,frag:-1,vert:-1}}var An=6408,Ge=5121,al=3333,Bi=5126;function lt(Ce,Qe,mt,nr,Ar,er,sr){function Tr(kr){var Or;Qe.next===null?(J(Ar.preserveDrawingBuffer,'you must create a webgl context with "preserveDrawingBuffer":true in order to read pixels from the drawing buffer'),Or=Ge):(J(Qe.next.colorAttachments[0].texture!==null,"You cannot read from a renderbuffer"),Or=Qe.next.colorAttachments[0].texture._texture.type,er.oes_texture_float?(J(Or===Ge||Or===Bi,"Reading from a framebuffer is only allowed for the types 'uint8' and 'float'"),Or===Bi&&J(sr.readFloat,"Reading 'float' values is not permitted in your browser. For a fallback, please see: https://www.npmjs.com/package/glsl-read-float")):J(Or===Ge,"Reading from a framebuffer is only allowed for the type 'uint8'"));var qr=0,Mr=0,zr=nr.framebufferWidth,Vt=nr.framebufferHeight,lr=null;$(kr)?lr=kr:kr&&(J.type(kr,"object","invalid arguments to regl.read()"),qr=kr.x|0,Mr=kr.y|0,J(qr>=0&&qr<nr.framebufferWidth,"invalid x offset for regl.read"),J(Mr>=0&&Mr<nr.framebufferHeight,"invalid y offset for regl.read"),zr=(kr.width||nr.framebufferWidth-qr)|0,Vt=(kr.height||nr.framebufferHeight-Mr)|0,lr=kr.data||null),lr&&(Or===Ge?J(lr instanceof Uint8Array,"buffer must be 'Uint8Array' when reading from a framebuffer of type 'uint8'"):Or===Bi&&J(lr instanceof Float32Array,"buffer must be 'Float32Array' when reading from a framebuffer of type 'float'")),J(zr>0&&zr+qr<=nr.framebufferWidth,"invalid width for read pixels"),J(Vt>0&&Vt+Mr<=nr.framebufferHeight,"invalid height for read pixels"),mt();var Rr=zr*Vt*4;return lr||(Or===Ge?lr=new Uint8Array(Rr):Or===Bi&&(lr=lr||new Float32Array(Rr))),J.isTypedArray(lr,"data buffer for regl.read() must be a typedarray"),J(lr.byteLength>=Rr,"data buffer for regl.read() too small"),Ce.pixelStorei(al,4),Ce.readPixels(qr,Mr,zr,Vt,An,Or,lr),lr}function Lr(kr){var Or;return Qe.setFBO({framebuffer:kr.framebuffer},function(){Or=Tr(kr)}),Or}function Nr(kr){return!kr||!("framebuffer"in kr)?Tr(kr):Lr(kr)}return Nr}function ii(Ce){return Array.prototype.slice.call(Ce)}function xc(Ce){return ii(Ce).join("")}function Eh(){var Ce=0,Qe=[],mt=[];function nr(Or){for(var qr=0;qr<mt.length;++qr)if(mt[qr]===Or)return Qe[qr];var Mr="g"+Ce++;return Qe.push(Mr),mt.push(Or),Mr}function Ar(){var Or=[];function qr(){Or.push.apply(Or,ii(arguments))}var Mr=[];function zr(){var Vt="v"+Ce++;return Mr.push(Vt),arguments.length>0&&(Or.push(Vt,"="),Or.push.apply(Or,ii(arguments)),Or.push(";")),Vt}return C(qr,{def:zr,toString:function(){return xc([Mr.length>0?"var "+Mr.join(",")+";":"",xc(Or)])}})}function er(){var Or=Ar(),qr=Ar(),Mr=Or.toString,zr=qr.toString;function Vt(lr,Rr){qr(lr,Rr,"=",Or.def(lr,Rr),";")}return C(function(){Or.apply(Or,ii(arguments))},{def:Or.def,entry:Or,exit:qr,save:Vt,set:function(lr,Rr,tn){Vt(lr,Rr),Or(lr,Rr,"=",tn,";")},toString:function(){return Mr()+zr()}})}function sr(){var Or=xc(arguments),qr=er(),Mr=er(),zr=qr.toString,Vt=Mr.toString;return C(qr,{then:function(){return qr.apply(qr,ii(arguments)),this},else:function(){return Mr.apply(Mr,ii(arguments)),this},toString:function(){var lr=Vt();return lr&&(lr="else{"+lr+"}"),xc(["if(",Or,"){",zr(),"}",lr])}})}var Tr=Ar(),Lr={};function Nr(Or,qr){var Mr=[];function zr(){var _r="a"+Mr.length;return Mr.push(_r),_r}qr=qr||0;for(var Vt=0;Vt<qr;++Vt)zr();var lr=er(),Rr=lr.toString,tn=Lr[Or]=C(lr,{arg:zr,toString:function(){return xc(["function(",Mr.join(),"){",Rr(),"}"])}});return tn}function kr(){var Or=['"use strict";',Tr,"return {"];Object.keys(Lr).forEach(function(zr){Or.push('"',zr,'":',Lr[zr].toString(),",")}),Or.push("}");var qr=xc(Or).replace(/;/g,`;
`).replace(/}/g,`}
`).replace(/{/g,`{
`),Mr=Function.apply(null,Qe.concat(qr));return Mr.apply(null,mt)}return{global:Tr,link:nr,block:Ar,proc:Nr,scope:er,cond:sr,compile:kr}}var Ec="xyzw".split(""),s0=5121,rf=1,Je=2,bc=0,Ef=1,u0=2,Bf=3,nf=4,l0=5,bf=6,U0="dither",c0="blend.enable",zu="blend.color",Uo="blend.equation",Zf="blend.func",bh="depth.enable",zf="depth.func",Nl="depth.range",Sc="depth.mask",af="colorMask",f0="cull.enable",oa="cull.face",Ua="frontFace",Go="lineWidth",Uf="polygonOffset.enable",G0="polygonOffset.offset",Gf="sample.alpha",h0="sample.enable",jf="sample.coverage",Xi="stencil.enable",Vf="stencil.mask",Fl="stencil.func",au="stencil.opFront",ic="stencil.opBack",oo="scissor.enable",Uu="scissor.box",Bl="viewport",Sf="profile",Mo="framebuffer",ol="vert",ss="frag",ac="elements",Cc="primitive",Zl="count",A0="offset",Hf="instances",of="vao",$f="Width",wc="Height",Tu=Mo+$f,Tc=Mo+wc,Gu=Bl+$f,sl=Bl+wc,Mc="drawingBuffer",Sl=Mc+$f,p0=Mc+wc,j0=[Zf,Uo,Fl,au,ic,jf,Bl,Uu,G0],oc=34962,Sh=34963,Ch=35632,V0=35633,d0=3553,v0=34067,wh=2884,yA=3042,H0=3024,Th=2960,sc=2929,$0=3089,Cf=32823,_A=32926,xA=32928,Y0=5126,Ic=35664,Pc=35665,wf=35666,Eo=5124,Xs=35667,zl=35668,uc=35669,ul=35670,Ul=35671,Lc=35672,sf=35673,Gl=35674,Cl=35675,pa=35676,Oc=35678,jl=35680,lc=4,Vl=1028,Hl=1029,g0=2304,m0=2305,Qs=32775,Rc=32776,wl=519,ju=7680,Mu=0,Yf=1,ou=32774,uf=513,$l=36160,Yl=36064,Os={0:0,1:1,zero:0,one:1,"src color":768,"one minus src color":769,"src alpha":770,"one minus src alpha":771,"dst color":774,"one minus dst color":775,"dst alpha":772,"one minus dst alpha":773,"constant color":32769,"one minus constant color":32770,"constant alpha":32771,"one minus constant alpha":32772,"src alpha saturate":776},Dc=["constant color, constant alpha","one minus constant color, constant alpha","constant color, one minus constant alpha","one minus constant color, one minus constant alpha","constant alpha, constant color","constant alpha, one minus constant color","one minus constant alpha, constant color","one minus constant alpha, one minus constant color"],kc={never:512,less:513,"<":513,equal:514,"=":514,"==":514,"===":514,lequal:515,"<=":515,greater:516,">":516,notequal:517,"!=":517,"!==":517,gequal:518,">=":518,always:519},Tl={0:0,zero:0,keep:7680,replace:7681,increment:7682,decrement:7683,"increment wrap":34055,"decrement wrap":34056,invert:5386},y0={frag:Ch,vert:V0},lf={cw:g0,ccw:m0};function cf(Ce){return Array.isArray(Ce)||$(Ce)||He(Ce)}function Tf(Ce){return Ce.sort(function(Qe,mt){return Qe===Bl?-1:mt===Bl?1:Qe<mt?-1:1})}function ms(Ce,Qe,mt,nr){this.thisDep=Ce,this.contextDep=Qe,this.propDep=mt,this.append=nr}function ll(Ce){return Ce&&!(Ce.thisDep||Ce.contextDep||Ce.propDep)}function ia(Ce){return new ms(!1,!1,!1,Ce)}function Ko(Ce,Qe){var mt=Ce.type;if(mt===bc){var nr=Ce.data.length;return new ms(!0,nr>=1,nr>=2,Qe)}else if(mt===nf){var Ar=Ce.data;return new ms(Ar.thisDep,Ar.contextDep,Ar.propDep,Qe)}else{if(mt===l0)return new ms(!1,!1,!1,Qe);if(mt===bf){for(var er=!1,sr=!1,Tr=!1,Lr=0;Lr<Ce.data.length;++Lr){var Nr=Ce.data[Lr];if(Nr.type===Ef)Tr=!0;else if(Nr.type===u0)sr=!0;else if(Nr.type===Bf)er=!0;else if(Nr.type===bc){er=!0;var kr=Nr.data;kr>=1&&(sr=!0),kr>=2&&(Tr=!0)}else Nr.type===nf&&(er=er||Nr.data.thisDep,sr=sr||Nr.data.contextDep,Tr=Tr||Nr.data.propDep)}return new ms(er,sr,Tr,Qe)}else return new ms(mt===Bf,mt===u0,mt===Ef,Qe)}}var cc=new ms(!1,!1,!1,function(){});function cl(Ce,Qe,mt,nr,Ar,er,sr,Tr,Lr,Nr,kr,Or,qr,Mr,zr){var Vt=Nr.Record,lr={add:32774,subtract:32778,"reverse subtract":32779};mt.ext_blend_minmax&&(lr.min=Qs,lr.max=Rc);var Rr=mt.angle_instanced_arrays,tn=mt.webgl_draw_buffers,_r={dirty:!0,profile:zr.profile},cn={},wr=[],Hr={},br={};function Wr(ot){return ot.replace(".","_")}function Cn(ot,Ye,St){var Dt=Wr(ot);wr.push(ot),cn[Dt]=_r[Dt]=!!St,Hr[Dt]=Ye}function Xn(ot,Ye,St){var Dt=Wr(ot);wr.push(ot),Array.isArray(St)?(_r[Dt]=St.slice(),cn[Dt]=St.slice()):_r[Dt]=cn[Dt]=St,br[Dt]=Ye}Cn(U0,H0),Cn(c0,yA),Xn(zu,"blendColor",[0,0,0,0]),Xn(Uo,"blendEquationSeparate",[ou,ou]),Xn(Zf,"blendFuncSeparate",[Yf,Mu,Yf,Mu]),Cn(bh,sc,!0),Xn(zf,"depthFunc",uf),Xn(Nl,"depthRange",[0,1]),Xn(Sc,"depthMask",!0),Xn(af,af,[!0,!0,!0,!0]),Cn(f0,wh),Xn(oa,"cullFace",Hl),Xn(Ua,Ua,m0),Xn(Go,Go,1),Cn(Uf,Cf),Xn(G0,"polygonOffset",[0,0]),Cn(Gf,_A),Cn(h0,xA),Xn(jf,"sampleCoverage",[1,!1]),Cn(Xi,Th),Xn(Vf,"stencilMask",-1),Xn(Fl,"stencilFunc",[wl,0,-1]),Xn(au,"stencilOpSeparate",[Vl,ju,ju,ju]),Xn(ic,"stencilOpSeparate",[Hl,ju,ju,ju]),Cn(oo,$0),Xn(Uu,"scissor",[0,0,Ce.drawingBufferWidth,Ce.drawingBufferHeight]),Xn(Bl,Bl,[0,0,Ce.drawingBufferWidth,Ce.drawingBufferHeight]);var Ir={gl:Ce,context:qr,strings:Qe,next:cn,current:_r,draw:Or,elements:er,buffer:Ar,shader:kr,attributes:Nr.state,vao:Nr,uniforms:Lr,framebuffer:Tr,extensions:mt,timer:Mr,isBufferArgs:cf},Fr={primTypes:Gs,compareFuncs:kc,blendFuncs:Os,blendEquations:lr,stencilOps:Tl,glTypes:qa,orientationType:lf};J.optional(function(){Ir.isArrayLike=Za}),tn&&(Fr.backBuffer=[Hl],Fr.drawBuffer=_n(nr.maxDrawbuffers,function(ot){return ot===0?[0]:_n(ot,function(Ye){return Yl+Ye})}));var gr=0;function On(){var ot=Eh(),Ye=ot.link,St=ot.global;ot.id=gr++,ot.batchId="0";var Dt=Ye(Ir),Ft=ot.shared={props:"a0"};Object.keys(Ir).forEach(function(E){Ft[E]=St.def(Dt,".",E)}),J.optional(function(){ot.CHECK=Ye(J),ot.commandStr=J.guessCommand(),ot.command=Ye(ot.commandStr),ot.assert=function(E,S,I){E("if(!(",S,"))",this.CHECK,".commandRaise(",Ye(I),",",this.command,");")},Fr.invalidBlendCombinations=Dc});var h=ot.next={},f=ot.current={};Object.keys(br).forEach(function(E){Array.isArray(_r[E])&&(h[E]=St.def(Ft.next,".",E),f[E]=St.def(Ft.current,".",E))});var p=ot.constants={};Object.keys(Fr).forEach(function(E){p[E]=St.def(JSON.stringify(Fr[E]))}),ot.invoke=function(E,S){switch(S.type){case bc:var I=["this",Ft.context,Ft.props,ot.batchId];return E.def(Ye(S.data),".call(",I.slice(0,Math.max(S.data.length+1,4)),")");case Ef:return E.def(Ft.props,S.data);case u0:return E.def(Ft.context,S.data);case Bf:return E.def("this",S.data);case nf:return S.data.append(ot,E),S.data.ref;case l0:return S.data.toString();case bf:return S.data.map(function(D){return ot.invoke(E,D)})}},ot.attribCache={};var m={};return ot.scopeAttrib=function(E){var S=Qe.id(E);if(S in m)return m[S];var I=Nr.scope[S];I||(I=Nr.scope[S]=new Vt);var D=m[S]=Ye(I);return D},ot}function Bn(ot){var Ye=ot.static,St=ot.dynamic,Dt;if(Sf in Ye){var Ft=!!Ye[Sf];Dt=ia(function(f,p){return Ft}),Dt.enable=Ft}else if(Sf in St){var h=St[Sf];Dt=Ko(h,function(f,p){return f.invoke(p,h)})}return Dt}function gn(ot,Ye){var St=ot.static,Dt=ot.dynamic;if(Mo in St){var Ft=St[Mo];return Ft?(Ft=Tr.getFramebuffer(Ft),J.command(Ft,"invalid framebuffer object"),ia(function(f,p){var m=f.link(Ft),E=f.shared;p.set(E.framebuffer,".next",m);var S=E.context;return p.set(S,"."+Tu,m+".width"),p.set(S,"."+Tc,m+".height"),m})):ia(function(f,p){var m=f.shared;p.set(m.framebuffer,".next","null");var E=m.context;return p.set(E,"."+Tu,E+"."+Sl),p.set(E,"."+Tc,E+"."+p0),"null"})}else if(Mo in Dt){var h=Dt[Mo];return Ko(h,function(f,p){var m=f.invoke(p,h),E=f.shared,S=E.framebuffer,I=p.def(S,".getFramebuffer(",m,")");J.optional(function(){f.assert(p,"!"+m+"||"+I,"invalid framebuffer object")}),p.set(S,".next",I);var D=E.context;return p.set(D,"."+Tu,I+"?"+I+".width:"+D+"."+Sl),p.set(D,"."+Tc,I+"?"+I+".height:"+D+"."+p0),I})}else return null}function xi(ot,Ye,St){var Dt=ot.static,Ft=ot.dynamic;function h(m){if(m in Dt){var E=Dt[m];J.commandType(E,"object","invalid "+m,St.commandStr);var S=!0,I=E.x|0,D=E.y|0,V,re;return"width"in E?(V=E.width|0,J.command(V>=0,"invalid "+m,St.commandStr)):S=!1,"height"in E?(re=E.height|0,J.command(re>=0,"invalid "+m,St.commandStr)):S=!1,new ms(!S&&Ye&&Ye.thisDep,!S&&Ye&&Ye.contextDep,!S&&Ye&&Ye.propDep,function(ut,gt){var rt=ut.shared.context,_t=V;"width"in E||(_t=gt.def(rt,".",Tu,"-",I));var $t=re;return"height"in E||($t=gt.def(rt,".",Tc,"-",D)),[I,D,_t,$t]})}else if(m in Ft){var xe=Ft[m],Fe=Ko(xe,function(ut,gt){var rt=ut.invoke(gt,xe);J.optional(function(){ut.assert(gt,rt+"&&typeof "+rt+'==="object"',"invalid "+m)});var _t=ut.shared.context,$t=gt.def(rt,".x|0"),qt=gt.def(rt,".y|0"),Wt=gt.def('"width" in ',rt,"?",rt,".width|0:","(",_t,".",Tu,"-",$t,")"),rr=gt.def('"height" in ',rt,"?",rt,".height|0:","(",_t,".",Tc,"-",qt,")");return J.optional(function(){ut.assert(gt,Wt+">=0&&"+rr+">=0","invalid "+m)}),[$t,qt,Wt,rr]});return Ye&&(Fe.thisDep=Fe.thisDep||Ye.thisDep,Fe.contextDep=Fe.contextDep||Ye.contextDep,Fe.propDep=Fe.propDep||Ye.propDep),Fe}else return Ye?new ms(Ye.thisDep,Ye.contextDep,Ye.propDep,function(ut,gt){var rt=ut.shared.context;return[0,0,gt.def(rt,".",Tu),gt.def(rt,".",Tc)]}):null}var f=h(Bl);if(f){var p=f;f=new ms(f.thisDep,f.contextDep,f.propDep,function(m,E){var S=p.append(m,E),I=m.shared.context;return E.set(I,"."+Gu,S[2]),E.set(I,"."+sl,S[3]),S})}return{viewport:f,scissor_box:h(Uu)}}function Jn(ot,Ye){var St=ot.static,Dt=typeof St[ss]=="string"&&typeof St[ol]=="string";if(Dt){if(Object.keys(Ye.dynamic).length>0)return null;var Ft=Ye.static,h=Object.keys(Ft);if(h.length>0&&typeof Ft[h[0]]=="number"){for(var f=[],p=0;p<h.length;++p)J(typeof Ft[h[p]]=="number","must specify all vertex attribute locations when using vaos"),f.push([Ft[h[p]]|0,h[p]]);return f}}return null}function gi(ot,Ye,St){var Dt=ot.static,Ft=ot.dynamic;function h(S){if(S in Dt){var I=Qe.id(Dt[S]);J.optional(function(){kr.shader(y0[S],I,J.guessCommand())});var D=ia(function(){return I});return D.id=I,D}else if(S in Ft){var V=Ft[S];return Ko(V,function(re,xe){var Fe=re.invoke(xe,V),ut=xe.def(re.shared.strings,".id(",Fe,")");return J.optional(function(){xe(re.shared.shader,".shader(",y0[S],",",ut,",",re.command,");")}),ut})}return null}var f=h(ss),p=h(ol),m=null,E;return ll(f)&&ll(p)?(m=kr.program(p.id,f.id,null,St),E=ia(function(S,I){return S.link(m)})):E=new ms(f&&f.thisDep||p&&p.thisDep,f&&f.contextDep||p&&p.contextDep,f&&f.propDep||p&&p.propDep,function(S,I){var D=S.shared.shader,V;f?V=f.append(S,I):V=I.def(D,".",ss);var re;p?re=p.append(S,I):re=I.def(D,".",ol);var xe=D+".program("+re+","+V;return J.optional(function(){xe+=","+S.command}),I.def(xe+")")}),{frag:f,vert:p,progVar:E,program:m}}function ta(ot,Ye){var St=ot.static,Dt=ot.dynamic;function Ft(){if(ac in St){var S=St[ac];cf(S)?S=er.getElements(er.create(S,!0)):S&&(S=er.getElements(S),J.command(S,"invalid elements",Ye.commandStr));var I=ia(function(V,re){if(S){var xe=V.link(S);return V.ELEMENTS=xe,xe}return V.ELEMENTS=null,null});return I.value=S,I}else if(ac in Dt){var D=Dt[ac];return Ko(D,function(V,re){var xe=V.shared,Fe=xe.isBufferArgs,ut=xe.elements,gt=V.invoke(re,D),rt=re.def("null"),_t=re.def(Fe,"(",gt,")"),$t=V.cond(_t).then(rt,"=",ut,".createStream(",gt,");").else(rt,"=",ut,".getElements(",gt,");");return J.optional(function(){V.assert($t.else,"!"+gt+"||"+rt,"invalid elements")}),re.entry($t),re.exit(V.cond(_t).then(ut,".destroyStream(",rt,");")),V.ELEMENTS=rt,rt})}return null}var h=Ft();function f(){if(Cc in St){var S=St[Cc];return J.commandParameter(S,Gs,"invalid primitve",Ye.commandStr),ia(function(D,V){return Gs[S]})}else if(Cc in Dt){var I=Dt[Cc];return Ko(I,function(D,V){var re=D.constants.primTypes,xe=D.invoke(V,I);return J.optional(function(){D.assert(V,xe+" in "+re,"invalid primitive, must be one of "+Object.keys(Gs))}),V.def(re,"[",xe,"]")})}else if(h)return ll(h)?h.value?ia(function(D,V){return V.def(D.ELEMENTS,".primType")}):ia(function(){return lc}):new ms(h.thisDep,h.contextDep,h.propDep,function(D,V){var re=D.ELEMENTS;return V.def(re,"?",re,".primType:",lc)});return null}function p(S,I){if(S in St){var D=St[S]|0;return J.command(!I||D>=0,"invalid "+S,Ye.commandStr),ia(function(re,xe){return I&&(re.OFFSET=D),D})}else if(S in Dt){var V=Dt[S];return Ko(V,function(re,xe){var Fe=re.invoke(xe,V);return I&&(re.OFFSET=Fe,J.optional(function(){re.assert(xe,Fe+">=0","invalid "+S)})),Fe})}else if(I&&h)return ia(function(re,xe){return re.OFFSET="0",0});return null}var m=p(A0,!0);function E(){if(Zl in St){var S=St[Zl]|0;return J.command(typeof S=="number"&&S>=0,"invalid vertex count",Ye.commandStr),ia(function(){return S})}else if(Zl in Dt){var I=Dt[Zl];return Ko(I,function(re,xe){var Fe=re.invoke(xe,I);return J.optional(function(){re.assert(xe,"typeof "+Fe+'==="number"&&'+Fe+">=0&&"+Fe+"===("+Fe+"|0)","invalid vertex count")}),Fe})}else if(h)if(ll(h)){if(h)return m?new ms(m.thisDep,m.contextDep,m.propDep,function(re,xe){var Fe=xe.def(re.ELEMENTS,".vertCount-",re.OFFSET);return J.optional(function(){re.assert(xe,Fe+">=0","invalid vertex offset/element buffer too small")}),Fe}):ia(function(re,xe){return xe.def(re.ELEMENTS,".vertCount")});var D=ia(function(){return-1});return J.optional(function(){D.MISSING=!0}),D}else{var V=new ms(h.thisDep||m.thisDep,h.contextDep||m.contextDep,h.propDep||m.propDep,function(re,xe){var Fe=re.ELEMENTS;return re.OFFSET?xe.def(Fe,"?",Fe,".vertCount-",re.OFFSET,":-1"):xe.def(Fe,"?",Fe,".vertCount:-1")});return J.optional(function(){V.DYNAMIC=!0}),V}return null}return{elements:h,primitive:f(),count:E(),instances:p(Hf,!1),offset:m}}function bo(ot,Ye){var St=ot.static,Dt=ot.dynamic,Ft={};return wr.forEach(function(h){var f=Wr(h);function p(m,E){if(h in St){var S=m(St[h]);Ft[f]=ia(function(){return S})}else if(h in Dt){var I=Dt[h];Ft[f]=Ko(I,function(D,V){return E(D,V,D.invoke(V,I))})}}switch(h){case f0:case c0:case U0:case Xi:case bh:case oo:case Uf:case Gf:case h0:case Sc:return p(function(m){return J.commandType(m,"boolean",h,Ye.commandStr),m},function(m,E,S){return J.optional(function(){m.assert(E,"typeof "+S+'==="boolean"',"invalid flag "+h,m.commandStr)}),S});case zf:return p(function(m){return J.commandParameter(m,kc,"invalid "+h,Ye.commandStr),kc[m]},function(m,E,S){var I=m.constants.compareFuncs;return J.optional(function(){m.assert(E,S+" in "+I,"invalid "+h+", must be one of "+Object.keys(kc))}),E.def(I,"[",S,"]")});case Nl:return p(function(m){return J.command(Za(m)&&m.length===2&&typeof m[0]=="number"&&typeof m[1]=="number"&&m[0]<=m[1],"depth range is 2d array",Ye.commandStr),m},function(m,E,S){J.optional(function(){m.assert(E,m.shared.isArrayLike+"("+S+")&&"+S+".length===2&&typeof "+S+'[0]==="number"&&typeof '+S+'[1]==="number"&&'+S+"[0]<="+S+"[1]","depth range must be a 2d array")});var I=E.def("+",S,"[0]"),D=E.def("+",S,"[1]");return[I,D]});case Zf:return p(function(m){J.commandType(m,"object","blend.func",Ye.commandStr);var E="srcRGB"in m?m.srcRGB:m.src,S="srcAlpha"in m?m.srcAlpha:m.src,I="dstRGB"in m?m.dstRGB:m.dst,D="dstAlpha"in m?m.dstAlpha:m.dst;return J.commandParameter(E,Os,f+".srcRGB",Ye.commandStr),J.commandParameter(S,Os,f+".srcAlpha",Ye.commandStr),J.commandParameter(I,Os,f+".dstRGB",Ye.commandStr),J.commandParameter(D,Os,f+".dstAlpha",Ye.commandStr),J.command(Dc.indexOf(E+", "+I)===-1,"unallowed blending combination (srcRGB, dstRGB) = ("+E+", "+I+")",Ye.commandStr),[Os[E],Os[I],Os[S],Os[D]]},function(m,E,S){var I=m.constants.blendFuncs;J.optional(function(){m.assert(E,S+"&&typeof "+S+'==="object"',"invalid blend func, must be an object")});function D(rt,_t){var $t=E.def('"',rt,_t,'" in ',S,"?",S,".",rt,_t,":",S,".",rt);return J.optional(function(){m.assert(E,$t+" in "+I,"invalid "+h+"."+rt+_t+", must be one of "+Object.keys(Os))}),$t}var V=D("src","RGB"),re=D("dst","RGB");J.optional(function(){var rt=m.constants.invalidBlendCombinations;m.assert(E,rt+".indexOf("+V+'+", "+'+re+") === -1 ","unallowed blending combination for (srcRGB, dstRGB)")});var xe=E.def(I,"[",V,"]"),Fe=E.def(I,"[",D("src","Alpha"),"]"),ut=E.def(I,"[",re,"]"),gt=E.def(I,"[",D("dst","Alpha"),"]");return[xe,ut,Fe,gt]});case Uo:return p(function(m){if(typeof m=="string")return J.commandParameter(m,lr,"invalid "+h,Ye.commandStr),[lr[m],lr[m]];if(typeof m=="object")return J.commandParameter(m.rgb,lr,h+".rgb",Ye.commandStr),J.commandParameter(m.alpha,lr,h+".alpha",Ye.commandStr),[lr[m.rgb],lr[m.alpha]];J.commandRaise("invalid blend.equation",Ye.commandStr)},function(m,E,S){var I=m.constants.blendEquations,D=E.def(),V=E.def(),re=m.cond("typeof ",S,'==="string"');return J.optional(function(){function xe(Fe,ut,gt){m.assert(Fe,gt+" in "+I,"invalid "+ut+", must be one of "+Object.keys(lr))}xe(re.then,h,S),m.assert(re.else,S+"&&typeof "+S+'==="object"',"invalid "+h),xe(re.else,h+".rgb",S+".rgb"),xe(re.else,h+".alpha",S+".alpha")}),re.then(D,"=",V,"=",I,"[",S,"];"),re.else(D,"=",I,"[",S,".rgb];",V,"=",I,"[",S,".alpha];"),E(re),[D,V]});case zu:return p(function(m){return J.command(Za(m)&&m.length===4,"blend.color must be a 4d array",Ye.commandStr),_n(4,function(E){return+m[E]})},function(m,E,S){return J.optional(function(){m.assert(E,m.shared.isArrayLike+"("+S+")&&"+S+".length===4","blend.color must be a 4d array")}),_n(4,function(I){return E.def("+",S,"[",I,"]")})});case Vf:return p(function(m){return J.commandType(m,"number",f,Ye.commandStr),m|0},function(m,E,S){return J.optional(function(){m.assert(E,"typeof "+S+'==="number"',"invalid stencil.mask")}),E.def(S,"|0")});case Fl:return p(function(m){J.commandType(m,"object",f,Ye.commandStr);var E=m.cmp||"keep",S=m.ref||0,I="mask"in m?m.mask:-1;return J.commandParameter(E,kc,h+".cmp",Ye.commandStr),J.commandType(S,"number",h+".ref",Ye.commandStr),J.commandType(I,"number",h+".mask",Ye.commandStr),[kc[E],S,I]},function(m,E,S){var I=m.constants.compareFuncs;J.optional(function(){function xe(){m.assert(E,Array.prototype.join.call(arguments,""),"invalid stencil.func")}xe(S+"&&typeof ",S,'==="object"'),xe('!("cmp" in ',S,")||(",S,".cmp in ",I,")")});var D=E.def('"cmp" in ',S,"?",I,"[",S,".cmp]",":",ju),V=E.def(S,".ref|0"),re=E.def('"mask" in ',S,"?",S,".mask|0:-1");return[D,V,re]});case au:case ic:return p(function(m){J.commandType(m,"object",f,Ye.commandStr);var E=m.fail||"keep",S=m.zfail||"keep",I=m.zpass||"keep";return J.commandParameter(E,Tl,h+".fail",Ye.commandStr),J.commandParameter(S,Tl,h+".zfail",Ye.commandStr),J.commandParameter(I,Tl,h+".zpass",Ye.commandStr),[h===ic?Hl:Vl,Tl[E],Tl[S],Tl[I]]},function(m,E,S){var I=m.constants.stencilOps;J.optional(function(){m.assert(E,S+"&&typeof "+S+'==="object"',"invalid "+h)});function D(V){return J.optional(function(){m.assert(E,'!("'+V+'" in '+S+")||("+S+"."+V+" in "+I+")","invalid "+h+"."+V+", must be one of "+Object.keys(Tl))}),E.def('"',V,'" in ',S,"?",I,"[",S,".",V,"]:",ju)}return[h===ic?Hl:Vl,D("fail"),D("zfail"),D("zpass")]});case G0:return p(function(m){J.commandType(m,"object",f,Ye.commandStr);var E=m.factor|0,S=m.units|0;return J.commandType(E,"number",f+".factor",Ye.commandStr),J.commandType(S,"number",f+".units",Ye.commandStr),[E,S]},function(m,E,S){J.optional(function(){m.assert(E,S+"&&typeof "+S+'==="object"',"invalid "+h)});var I=E.def(S,".factor|0"),D=E.def(S,".units|0");return[I,D]});case oa:return p(function(m){var E=0;return m==="front"?E=Vl:m==="back"&&(E=Hl),J.command(!!E,f,Ye.commandStr),E},function(m,E,S){return J.optional(function(){m.assert(E,S+'==="front"||'+S+'==="back"',"invalid cull.face")}),E.def(S,'==="front"?',Vl,":",Hl)});case Go:return p(function(m){return J.command(typeof m=="number"&&m>=nr.lineWidthDims[0]&&m<=nr.lineWidthDims[1],"invalid line width, must be a positive number between "+nr.lineWidthDims[0]+" and "+nr.lineWidthDims[1],Ye.commandStr),m},function(m,E,S){return J.optional(function(){m.assert(E,"typeof "+S+'==="number"&&'+S+">="+nr.lineWidthDims[0]+"&&"+S+"<="+nr.lineWidthDims[1],"invalid line width")}),S});case Ua:return p(function(m){return J.commandParameter(m,lf,f,Ye.commandStr),lf[m]},function(m,E,S){return J.optional(function(){m.assert(E,S+'==="cw"||'+S+'==="ccw"',"invalid frontFace, must be one of cw,ccw")}),E.def(S+'==="cw"?'+g0+":"+m0)});case af:return p(function(m){return J.command(Za(m)&&m.length===4,"color.mask must be length 4 array",Ye.commandStr),m.map(function(E){return!!E})},function(m,E,S){return J.optional(function(){m.assert(E,m.shared.isArrayLike+"("+S+")&&"+S+".length===4","invalid color.mask")}),_n(4,function(I){return"!!"+S+"["+I+"]"})});case jf:return p(function(m){J.command(typeof m=="object"&&m,f,Ye.commandStr);var E="value"in m?m.value:1,S=!!m.invert;return J.command(typeof E=="number"&&E>=0&&E<=1,"sample.coverage.value must be a number between 0 and 1",Ye.commandStr),[E,S]},function(m,E,S){J.optional(function(){m.assert(E,S+"&&typeof "+S+'==="object"',"invalid sample.coverage")});var I=E.def('"value" in ',S,"?+",S,".value:1"),D=E.def("!!",S,".invert");return[I,D]})}}),Ft}function ro(ot,Ye){var St=ot.static,Dt=ot.dynamic,Ft={};return Object.keys(St).forEach(function(h){var f=St[h],p;if(typeof f=="number"||typeof f=="boolean")p=ia(function(){return f});else if(typeof f=="function"){var m=f._reglType;m==="texture2d"||m==="textureCube"?p=ia(function(E){return E.link(f)}):m==="framebuffer"||m==="framebufferCube"?(J.command(f.color.length>0,'missing color attachment for framebuffer sent to uniform "'+h+'"',Ye.commandStr),p=ia(function(E){return E.link(f.color[0])})):J.commandRaise('invalid data for uniform "'+h+'"',Ye.commandStr)}else Za(f)?p=ia(function(E){var S=E.global.def("[",_n(f.length,function(I){return J.command(typeof f[I]=="number"||typeof f[I]=="boolean","invalid uniform "+h,E.commandStr),f[I]}),"]");return S}):J.commandRaise('invalid or missing data for uniform "'+h+'"',Ye.commandStr);p.value=f,Ft[h]=p}),Object.keys(Dt).forEach(function(h){var f=Dt[h];Ft[h]=Ko(f,function(p,m){return p.invoke(m,f)})}),Ft}function Ti(ot,Ye){var St=ot.static,Dt=ot.dynamic,Ft={};return Object.keys(St).forEach(function(h){var f=St[h],p=Qe.id(h),m=new Vt;if(cf(f))m.state=rf,m.buffer=Ar.getBuffer(Ar.create(f,oc,!1,!0)),m.type=0;else{var E=Ar.getBuffer(f);if(E)m.state=rf,m.buffer=E,m.type=0;else if(J.command(typeof f=="object"&&f,"invalid data for attribute "+h,Ye.commandStr),"constant"in f){var S=f.constant;m.buffer="null",m.state=Je,typeof S=="number"?m.x=S:(J.command(Za(S)&&S.length>0&&S.length<=4,"invalid constant for attribute "+h,Ye.commandStr),Ec.forEach(function(ut,gt){gt<S.length&&(m[ut]=S[gt])}))}else{cf(f.buffer)?E=Ar.getBuffer(Ar.create(f.buffer,oc,!1,!0)):E=Ar.getBuffer(f.buffer),J.command(!!E,'missing buffer for attribute "'+h+'"',Ye.commandStr);var I=f.offset|0;J.command(I>=0,'invalid offset for attribute "'+h+'"',Ye.commandStr);var D=f.stride|0;J.command(D>=0&&D<256,'invalid stride for attribute "'+h+'", must be integer betweeen [0, 255]',Ye.commandStr);var V=f.size|0;J.command(!("size"in f)||V>0&&V<=4,'invalid size for attribute "'+h+'", must be 1,2,3,4',Ye.commandStr);var re=!!f.normalized,xe=0;"type"in f&&(J.commandParameter(f.type,qa,"invalid type for attribute "+h,Ye.commandStr),xe=qa[f.type]);var Fe=f.divisor|0;"divisor"in f&&(J.command(Fe===0||Rr,'cannot specify divisor for attribute "'+h+'", instancing not supported',Ye.commandStr),J.command(Fe>=0,'invalid divisor for attribute "'+h+'"',Ye.commandStr)),J.optional(function(){var ut=Ye.commandStr,gt=["buffer","offset","divisor","normalized","type","size","stride"];Object.keys(f).forEach(function(rt){J.command(gt.indexOf(rt)>=0,'unknown parameter "'+rt+'" for attribute pointer "'+h+'" (valid parameters are '+gt+")",ut)})}),m.buffer=E,m.state=rf,m.size=V,m.normalized=re,m.type=xe||E.dtype,m.offset=I,m.stride=D,m.divisor=Fe}}Ft[h]=ia(function(ut,gt){var rt=ut.attribCache;if(p in rt)return rt[p];var _t={isStream:!1};return Object.keys(m).forEach(function($t){_t[$t]=m[$t]}),m.buffer&&(_t.buffer=ut.link(m.buffer),_t.type=_t.type||_t.buffer+".dtype"),rt[p]=_t,_t})}),Object.keys(Dt).forEach(function(h){var f=Dt[h];function p(m,E){var S=m.invoke(E,f),I=m.shared,D=m.constants,V=I.isBufferArgs,re=I.buffer;J.optional(function(){m.assert(E,S+"&&(typeof "+S+'==="object"||typeof '+S+'==="function")&&('+V+"("+S+")||"+re+".getBuffer("+S+")||"+re+".getBuffer("+S+".buffer)||"+V+"("+S+'.buffer)||("constant" in '+S+"&&(typeof "+S+'.constant==="number"||'+I.isArrayLike+"("+S+".constant))))",'invalid dynamic attribute "'+h+'"')});var xe={isStream:E.def(!1)},Fe=new Vt;Fe.state=rf,Object.keys(Fe).forEach(function(_t){xe[_t]=E.def(""+Fe[_t])});var ut=xe.buffer,gt=xe.type;E("if(",V,"(",S,")){",xe.isStream,"=true;",ut,"=",re,".createStream(",oc,",",S,");",gt,"=",ut,".dtype;","}else{",ut,"=",re,".getBuffer(",S,");","if(",ut,"){",gt,"=",ut,".dtype;",'}else if("constant" in ',S,"){",xe.state,"=",Je,";","if(typeof "+S+'.constant === "number"){',xe[Ec[0]],"=",S,".constant;",Ec.slice(1).map(function(_t){return xe[_t]}).join("="),"=0;","}else{",Ec.map(function(_t,$t){return xe[_t]+"="+S+".constant.length>"+$t+"?"+S+".constant["+$t+"]:0;"}).join(""),"}}else{","if(",V,"(",S,".buffer)){",ut,"=",re,".createStream(",oc,",",S,".buffer);","}else{",ut,"=",re,".getBuffer(",S,".buffer);","}",gt,'="type" in ',S,"?",D.glTypes,"[",S,".type]:",ut,".dtype;",xe.normalized,"=!!",S,".normalized;");function rt(_t){E(xe[_t],"=",S,".",_t,"|0;")}return rt("size"),rt("offset"),rt("stride"),rt("divisor"),E("}}"),E.exit("if(",xe.isStream,"){",re,".destroyStream(",ut,");","}"),xe}Ft[h]=Ko(f,p)}),Ft}function Io(ot,Ye){var St=ot.static,Dt=ot.dynamic;if(of in St){var Ft=St[of];return Ft!==null&&Nr.getVAO(Ft)===null&&(Ft=Nr.createVAO(Ft)),ia(function(f){return f.link(Nr.getVAO(Ft))})}else if(of in Dt){var h=Dt[of];return Ko(h,function(f,p){var m=f.invoke(p,h);return p.def(f.shared.vao+".getVAO("+m+")")})}return null}function Na(ot){var Ye=ot.static,St=ot.dynamic,Dt={};return Object.keys(Ye).forEach(function(Ft){var h=Ye[Ft];Dt[Ft]=ia(function(f,p){return typeof h=="number"||typeof h=="boolean"?""+h:f.link(h)})}),Object.keys(St).forEach(function(Ft){var h=St[Ft];Dt[Ft]=Ko(h,function(f,p){return f.invoke(p,h)})}),Dt}function Ao(ot,Ye,St,Dt,Ft){var h=ot.static,f=ot.dynamic;J.optional(function(){var rt=[Mo,ol,ss,ac,Cc,A0,Zl,Hf,Sf,of].concat(wr);function _t($t){Object.keys($t).forEach(function(qt){J.command(rt.indexOf(qt)>=0,'unknown parameter "'+qt+'"',Ft.commandStr)})}_t(h),_t(f)});var p=Jn(ot,Ye),m=gn(ot,Ft),E=xi(ot,m,Ft),S=ta(ot,Ft),I=bo(ot,Ft),D=gi(ot,Ft,p);function V(rt){var _t=E[rt];_t&&(I[rt]=_t)}V(Bl),V(Wr(Uu));var re=Object.keys(I).length>0,xe={framebuffer:m,draw:S,shader:D,state:I,dirty:re,scopeVAO:null,drawVAO:null,useVAO:!1,attributes:{}};if(xe.profile=Bn(ot,Ft),xe.uniforms=ro(St,Ft),xe.drawVAO=xe.scopeVAO=Io(ot,Ft),!xe.drawVAO&&D.program&&!p&&mt.angle_instanced_arrays){var Fe=!0,ut=D.program.attributes.map(function(rt){var _t=Ye.static[rt];return Fe=Fe&&!!_t,_t});if(Fe&&ut.length>0){var gt=Nr.getVAO(Nr.createVAO(ut));xe.drawVAO=new ms(null,null,null,function(rt,_t){return rt.link(gt)}),xe.useVAO=!0}}return p?xe.useVAO=!0:xe.attributes=Ti(Ye,Ft),xe.context=Na(Dt,Ft),xe}function jo(ot,Ye,St){var Dt=ot.shared,Ft=Dt.context,h=ot.scope();Object.keys(St).forEach(function(f){Ye.save(Ft,"."+f);var p=St[f],m=p.append(ot,Ye);Array.isArray(m)?h(Ft,".",f,"=[",m.join(),"];"):h(Ft,".",f,"=",m,";")}),Ye(h)}function Fa(ot,Ye,St,Dt){var Ft=ot.shared,h=Ft.gl,f=Ft.framebuffer,p;tn&&(p=Ye.def(Ft.extensions,".webgl_draw_buffers"));var m=ot.constants,E=m.drawBuffer,S=m.backBuffer,I;St?I=St.append(ot,Ye):I=Ye.def(f,".next"),Dt||Ye("if(",I,"!==",f,".cur){"),Ye("if(",I,"){",h,".bindFramebuffer(",$l,",",I,".framebuffer);"),tn&&Ye(p,".drawBuffersWEBGL(",E,"[",I,".colorAttachments.length]);"),Ye("}else{",h,".bindFramebuffer(",$l,",null);"),tn&&Ye(p,".drawBuffersWEBGL(",S,");"),Ye("}",f,".cur=",I,";"),Dt||Ye("}")}function Ga(ot,Ye,St){var Dt=ot.shared,Ft=Dt.gl,h=ot.current,f=ot.next,p=Dt.current,m=Dt.next,E=ot.cond(p,".dirty");wr.forEach(function(S){var I=Wr(S);if(!(I in St.state)){var D,V;if(I in f){D=f[I],V=h[I];var re=_n(_r[I].length,function(Fe){return E.def(D,"[",Fe,"]")});E(ot.cond(re.map(function(Fe,ut){return Fe+"!=="+V+"["+ut+"]"}).join("||")).then(Ft,".",br[I],"(",re,");",re.map(function(Fe,ut){return V+"["+ut+"]="+Fe}).join(";"),";"))}else{D=E.def(m,".",I);var xe=ot.cond(D,"!==",p,".",I);E(xe),I in Hr?xe(ot.cond(D).then(Ft,".enable(",Hr[I],");").else(Ft,".disable(",Hr[I],");"),p,".",I,"=",D,";"):xe(Ft,".",br[I],"(",D,");",p,".",I,"=",D,";")}}}),Object.keys(St.state).length===0&&E(p,".dirty=false;"),Ye(E)}function Tn(ot,Ye,St,Dt){var Ft=ot.shared,h=ot.current,f=Ft.current,p=Ft.gl;Tf(Object.keys(St)).forEach(function(m){var E=St[m];if(!(Dt&&!Dt(E))){var S=E.append(ot,Ye);if(Hr[m]){var I=Hr[m];ll(E)?S?Ye(p,".enable(",I,");"):Ye(p,".disable(",I,");"):Ye(ot.cond(S).then(p,".enable(",I,");").else(p,".disable(",I,");")),Ye(f,".",m,"=",S,";")}else if(Za(S)){var D=h[m];Ye(p,".",br[m],"(",S,");",S.map(function(V,re){return D+"["+re+"]="+V}).join(";"),";")}else Ye(p,".",br[m],"(",S,");",f,".",m,"=",S,";")}})}function ya(ot,Ye){Rr&&(ot.instancing=Ye.def(ot.shared.extensions,".angle_instanced_arrays"))}function un(ot,Ye,St,Dt,Ft){var h=ot.shared,f=ot.stats,p=h.current,m=h.timer,E=St.profile;function S(){return typeof performance=="undefined"?"Date.now()":"performance.now()"}var I,D;function V(rt){I=Ye.def(),rt(I,"=",S(),";"),typeof Ft=="string"?rt(f,".count+=",Ft,";"):rt(f,".count++;"),Mr&&(Dt?(D=Ye.def(),rt(D,"=",m,".getNumPendingQueries();")):rt(m,".beginQuery(",f,");"))}function re(rt){rt(f,".cpuTime+=",S(),"-",I,";"),Mr&&(Dt?rt(m,".pushScopeStats(",D,",",m,".getNumPendingQueries(),",f,");"):rt(m,".endQuery();"))}function xe(rt){var _t=Ye.def(p,".profile");Ye(p,".profile=",rt,";"),Ye.exit(p,".profile=",_t,";")}var Fe;if(E){if(ll(E)){E.enable?(V(Ye),re(Ye.exit),xe("true")):xe("false");return}Fe=E.append(ot,Ye),xe(Fe)}else Fe=Ye.def(p,".profile");var ut=ot.block();V(ut),Ye("if(",Fe,"){",ut,"}");var gt=ot.block();re(gt),Ye.exit("if(",Fe,"){",gt,"}")}function da(ot,Ye,St,Dt,Ft){var h=ot.shared;function f(m){switch(m){case Ic:case Xs:case Ul:return 2;case Pc:case zl:case Lc:return 3;case wf:case uc:case sf:return 4;default:return 1}}function p(m,E,S){var I=h.gl,D=Ye.def(m,".location"),V=Ye.def(h.attributes,"[",D,"]"),re=S.state,xe=S.buffer,Fe=[S.x,S.y,S.z,S.w],ut=["buffer","normalized","offset","stride"];function gt(){Ye("if(!",V,".buffer){",I,".enableVertexAttribArray(",D,");}");var _t=S.type,$t;if(S.size?$t=Ye.def(S.size,"||",E):$t=E,Ye("if(",V,".type!==",_t,"||",V,".size!==",$t,"||",ut.map(function(Wt){return V+"."+Wt+"!=="+S[Wt]}).join("||"),"){",I,".bindBuffer(",oc,",",xe,".buffer);",I,".vertexAttribPointer(",[D,$t,_t,S.normalized,S.stride,S.offset],");",V,".type=",_t,";",V,".size=",$t,";",ut.map(function(Wt){return V+"."+Wt+"="+S[Wt]+";"}).join(""),"}"),Rr){var qt=S.divisor;Ye("if(",V,".divisor!==",qt,"){",ot.instancing,".vertexAttribDivisorANGLE(",[D,qt],");",V,".divisor=",qt,";}")}}function rt(){Ye("if(",V,".buffer){",I,".disableVertexAttribArray(",D,");",V,".buffer=null;","}if(",Ec.map(function(_t,$t){return V+"."+_t+"!=="+Fe[$t]}).join("||"),"){",I,".vertexAttrib4f(",D,",",Fe,");",Ec.map(function(_t,$t){return V+"."+_t+"="+Fe[$t]+";"}).join(""),"}")}re===rf?gt():re===Je?rt():(Ye("if(",re,"===",rf,"){"),gt(),Ye("}else{"),rt(),Ye("}"))}Dt.forEach(function(m){var E=m.name,S=St.attributes[E],I;if(S){if(!Ft(S))return;I=S.append(ot,Ye)}else{if(!Ft(cc))return;var D=ot.scopeAttrib(E);J.optional(function(){ot.assert(Ye,D+".state","missing attribute "+E)}),I={},Object.keys(new Vt).forEach(function(V){I[V]=Ye.def(D,".",V)})}p(ot.link(m),f(m.info.type),I)})}function ra(ot,Ye,St,Dt,Ft){for(var h=ot.shared,f=h.gl,p,m=0;m<Dt.length;++m){var E=Dt[m],S=E.name,I=E.info.type,D=St.uniforms[S],V=ot.link(E),re=V+".location",xe;if(D){if(!Ft(D))continue;if(ll(D)){var Fe=D.value;if(J.command(Fe!==null&&typeof Fe!="undefined",'missing uniform "'+S+'"',ot.commandStr),I===Oc||I===jl){J.command(typeof Fe=="function"&&(I===Oc&&(Fe._reglType==="texture2d"||Fe._reglType==="framebuffer")||I===jl&&(Fe._reglType==="textureCube"||Fe._reglType==="framebufferCube")),"invalid texture for uniform "+S,ot.commandStr);var ut=ot.link(Fe._texture||Fe.color[0]._texture);Ye(f,".uniform1i(",re,",",ut+".bind());"),Ye.exit(ut,".unbind();")}else if(I===Gl||I===Cl||I===pa){J.optional(function(){J.command(Za(Fe),"invalid matrix for uniform "+S,ot.commandStr),J.command(I===Gl&&Fe.length===4||I===Cl&&Fe.length===9||I===pa&&Fe.length===16,"invalid length for matrix uniform "+S,ot.commandStr)});var gt=ot.global.def("new Float32Array(["+Array.prototype.slice.call(Fe)+"])"),rt=2;I===Cl?rt=3:I===pa&&(rt=4),Ye(f,".uniformMatrix",rt,"fv(",re,",false,",gt,");")}else{switch(I){case Y0:J.commandType(Fe,"number","uniform "+S,ot.commandStr),p="1f";break;case Ic:J.command(Za(Fe)&&Fe.length===2,"uniform "+S,ot.commandStr),p="2f";break;case Pc:J.command(Za(Fe)&&Fe.length===3,"uniform "+S,ot.commandStr),p="3f";break;case wf:J.command(Za(Fe)&&Fe.length===4,"uniform "+S,ot.commandStr),p="4f";break;case ul:J.commandType(Fe,"boolean","uniform "+S,ot.commandStr),p="1i";break;case Eo:J.commandType(Fe,"number","uniform "+S,ot.commandStr),p="1i";break;case Ul:J.command(Za(Fe)&&Fe.length===2,"uniform "+S,ot.commandStr),p="2i";break;case Xs:J.command(Za(Fe)&&Fe.length===2,"uniform "+S,ot.commandStr),p="2i";break;case Lc:J.command(Za(Fe)&&Fe.length===3,"uniform "+S,ot.commandStr),p="3i";break;case zl:J.command(Za(Fe)&&Fe.length===3,"uniform "+S,ot.commandStr),p="3i";break;case sf:J.command(Za(Fe)&&Fe.length===4,"uniform "+S,ot.commandStr),p="4i";break;case uc:J.command(Za(Fe)&&Fe.length===4,"uniform "+S,ot.commandStr),p="4i";break}Ye(f,".uniform",p,"(",re,",",Za(Fe)?Array.prototype.slice.call(Fe):Fe,");")}continue}else xe=D.append(ot,Ye)}else{if(!Ft(cc))continue;xe=Ye.def(h.uniforms,"[",Qe.id(S),"]")}I===Oc?(J(!Array.isArray(xe),"must specify a scalar prop for textures"),Ye("if(",xe,"&&",xe,'._reglType==="framebuffer"){',xe,"=",xe,".color[0];","}")):I===jl&&(J(!Array.isArray(xe),"must specify a scalar prop for cube maps"),Ye("if(",xe,"&&",xe,'._reglType==="framebufferCube"){',xe,"=",xe,".color[0];","}")),J.optional(function(){function rr(Kr,pn){ot.assert(Ye,Kr,'bad data or missing for uniform "'+S+'".  '+pn)}function Yt(Kr){J(!Array.isArray(xe),"must not specify an array type for uniform"),rr("typeof "+xe+'==="'+Kr+'"',"invalid type, expected "+Kr)}function rn(Kr,pn){Array.isArray(xe)?J(xe.length===Kr,"must have length "+Kr):rr(h.isArrayLike+"("+xe+")&&"+xe+".length==="+Kr,"invalid vector, should have length "+Kr,ot.commandStr)}function xn(Kr){J(!Array.isArray(xe),"must not specify a value type"),rr("typeof "+xe+'==="function"&&'+xe+'._reglType==="texture'+(Kr===d0?"2d":"Cube")+'"',"invalid texture type",ot.commandStr)}switch(I){case Eo:Yt("number");break;case Xs:rn(2,"number");break;case zl:rn(3,"number");break;case uc:rn(4,"number");break;case Y0:Yt("number");break;case Ic:rn(2,"number");break;case Pc:rn(3,"number");break;case wf:rn(4,"number");break;case ul:Yt("boolean");break;case Ul:rn(2,"boolean");break;case Lc:rn(3,"boolean");break;case sf:rn(4,"boolean");break;case Gl:rn(4,"number");break;case Cl:rn(9,"number");break;case pa:rn(16,"number");break;case Oc:xn(d0);break;case jl:xn(v0);break}});var _t=1;switch(I){case Oc:case jl:var $t=Ye.def(xe,"._texture");Ye(f,".uniform1i(",re,",",$t,".bind());"),Ye.exit($t,".unbind();");continue;case Eo:case ul:p="1i";break;case Xs:case Ul:p="2i",_t=2;break;case zl:case Lc:p="3i",_t=3;break;case uc:case sf:p="4i",_t=4;break;case Y0:p="1f";break;case Ic:p="2f",_t=2;break;case Pc:p="3f",_t=3;break;case wf:p="4f",_t=4;break;case Gl:p="Matrix2fv";break;case Cl:p="Matrix3fv";break;case pa:p="Matrix4fv";break}if(Ye(f,".uniform",p,"(",re,","),p.charAt(0)==="M"){var qt=Math.pow(I-Gl+2,2),Wt=ot.global.def("new Float32Array(",qt,")");Array.isArray(xe)?Ye("false,(",_n(qt,function(rr){return Wt+"["+rr+"]="+xe[rr]}),",",Wt,")"):Ye("false,(Array.isArray(",xe,")||",xe," instanceof Float32Array)?",xe,":(",_n(qt,function(rr){return Wt+"["+rr+"]="+xe+"["+rr+"]"}),",",Wt,")")}else _t>1?Ye(_n(_t,function(rr){return Array.isArray(xe)?xe[rr]:xe+"["+rr+"]"})):(J(!Array.isArray(xe),"uniform value must not be an array"),Ye(xe));Ye(");")}}function Rn(ot,Ye,St,Dt){var Ft=ot.shared,h=Ft.gl,f=Ft.draw,p=Dt.draw;function m(){var $t=p.elements,qt,Wt=Ye;return $t?(($t.contextDep&&Dt.contextDynamic||$t.propDep)&&(Wt=St),qt=$t.append(ot,Wt)):qt=Wt.def(f,".",ac),qt&&Wt("if("+qt+")"+h+".bindBuffer("+Sh+","+qt+".buffer.buffer);"),qt}function E(){var $t=p.count,qt,Wt=Ye;return $t?(($t.contextDep&&Dt.contextDynamic||$t.propDep)&&(Wt=St),qt=$t.append(ot,Wt),J.optional(function(){$t.MISSING&&ot.assert(Ye,"false","missing vertex count"),$t.DYNAMIC&&ot.assert(Wt,qt+">=0","missing vertex count")})):(qt=Wt.def(f,".",Zl),J.optional(function(){ot.assert(Wt,qt+">=0","missing vertex count")})),qt}var S=m();function I($t){var qt=p[$t];return qt?qt.contextDep&&Dt.contextDynamic||qt.propDep?qt.append(ot,St):qt.append(ot,Ye):Ye.def(f,".",$t)}var D=I(Cc),V=I(A0),re=E();if(typeof re=="number"){if(re===0)return}else St("if(",re,"){"),St.exit("}");var xe,Fe;Rr&&(xe=I(Hf),Fe=ot.instancing);var ut=S+".type",gt=p.elements&&ll(p.elements);function rt(){function $t(){St(Fe,".drawElementsInstancedANGLE(",[D,re,ut,V+"<<(("+ut+"-"+s0+")>>1)",xe],");")}function qt(){St(Fe,".drawArraysInstancedANGLE(",[D,V,re,xe],");")}S?gt?$t():(St("if(",S,"){"),$t(),St("}else{"),qt(),St("}")):qt()}function _t(){function $t(){St(h+".drawElements("+[D,re,ut,V+"<<(("+ut+"-"+s0+")>>1)"]+");")}function qt(){St(h+".drawArrays("+[D,V,re]+");")}S?gt?$t():(St("if(",S,"){"),$t(),St("}else{"),qt(),St("}")):qt()}Rr&&(typeof xe!="number"||xe>=0)?typeof xe=="string"?(St("if(",xe,">0){"),rt(),St("}else if(",xe,"<0){"),_t(),St("}")):rt():_t()}function mi(ot,Ye,St,Dt,Ft){var h=On(),f=h.proc("body",Ft);return J.optional(function(){h.commandStr=Ye.commandStr,h.command=h.link(Ye.commandStr)}),Rr&&(h.instancing=f.def(h.shared.extensions,".angle_instanced_arrays")),ot(h,f,St,Dt),h.compile().body}function vr(ot,Ye,St,Dt){ya(ot,Ye),St.useVAO?St.drawVAO?Ye(ot.shared.vao,".setVAO(",St.drawVAO.append(ot,Ye),");"):Ye(ot.shared.vao,".setVAO(",ot.shared.vao,".targetVAO);"):(Ye(ot.shared.vao,".setVAO(null);"),da(ot,Ye,St,Dt.attributes,function(){return!0})),ra(ot,Ye,St,Dt.uniforms,function(){return!0}),Rn(ot,Ye,Ye,St)}function Ri(ot,Ye){var St=ot.proc("draw",1);ya(ot,St),jo(ot,St,Ye.context),Fa(ot,St,Ye.framebuffer),Ga(ot,St,Ye),Tn(ot,St,Ye.state),un(ot,St,Ye,!1,!0);var Dt=Ye.shader.progVar.append(ot,St);if(St(ot.shared.gl,".useProgram(",Dt,".program);"),Ye.shader.program)vr(ot,St,Ye,Ye.shader.program);else{St(ot.shared.vao,".setVAO(null);");var Ft=ot.global.def("{}"),h=St.def(Dt,".id"),f=St.def(Ft,"[",h,"]");St(ot.cond(f).then(f,".call(this,a0);").else(f,"=",Ft,"[",h,"]=",ot.link(function(p){return mi(vr,ot,Ye,p,1)}),"(",Dt,");",f,".call(this,a0);"))}Object.keys(Ye.state).length>0&&St(ot.shared.current,".dirty=true;")}function Xt(ot,Ye,St,Dt){ot.batchId="a1",ya(ot,Ye);function Ft(){return!0}da(ot,Ye,St,Dt.attributes,Ft),ra(ot,Ye,St,Dt.uniforms,Ft),Rn(ot,Ye,Ye,St)}function Jo(ot,Ye,St,Dt){ya(ot,Ye);var Ft=St.contextDep,h=Ye.def(),f="a0",p="a1",m=Ye.def();ot.shared.props=m,ot.batchId=h;var E=ot.scope(),S=ot.scope();Ye(E.entry,"for(",h,"=0;",h,"<",p,";++",h,"){",m,"=",f,"[",h,"];",S,"}",E.exit);function I(ut){return ut.contextDep&&Ft||ut.propDep}function D(ut){return!I(ut)}if(St.needsContext&&jo(ot,S,St.context),St.needsFramebuffer&&Fa(ot,S,St.framebuffer),Tn(ot,S,St.state,I),St.profile&&I(St.profile)&&un(ot,S,St,!1,!0),Dt)St.useVAO?St.drawVAO?I(St.drawVAO)?S(ot.shared.vao,".setVAO(",St.drawVAO.append(ot,S),");"):E(ot.shared.vao,".setVAO(",St.drawVAO.append(ot,E),");"):E(ot.shared.vao,".setVAO(",ot.shared.vao,".targetVAO);"):(E(ot.shared.vao,".setVAO(null);"),da(ot,E,St,Dt.attributes,D),da(ot,S,St,Dt.attributes,I)),ra(ot,E,St,Dt.uniforms,D),ra(ot,S,St,Dt.uniforms,I),Rn(ot,E,S,St);else{var V=ot.global.def("{}"),re=St.shader.progVar.append(ot,S),xe=S.def(re,".id"),Fe=S.def(V,"[",xe,"]");S(ot.shared.gl,".useProgram(",re,".program);","if(!",Fe,"){",Fe,"=",V,"[",xe,"]=",ot.link(function(ut){return mi(Xt,ot,St,ut,2)}),"(",re,");}",Fe,".call(this,a0[",h,"],",h,");")}}function ct(ot,Ye){var St=ot.proc("batch",2);ot.batchId="0",ya(ot,St);var Dt=!1,Ft=!0;Object.keys(Ye.context).forEach(function(V){Dt=Dt||Ye.context[V].propDep}),Dt||(jo(ot,St,Ye.context),Ft=!1);var h=Ye.framebuffer,f=!1;h?(h.propDep?Dt=f=!0:h.contextDep&&Dt&&(f=!0),f||Fa(ot,St,h)):Fa(ot,St,null),Ye.state.viewport&&Ye.state.viewport.propDep&&(Dt=!0);function p(V){return V.contextDep&&Dt||V.propDep}Ga(ot,St,Ye),Tn(ot,St,Ye.state,function(V){return!p(V)}),(!Ye.profile||!p(Ye.profile))&&un(ot,St,Ye,!1,"a1"),Ye.contextDep=Dt,Ye.needsContext=Ft,Ye.needsFramebuffer=f;var m=Ye.shader.progVar;if(m.contextDep&&Dt||m.propDep)Jo(ot,St,Ye,null);else{var E=m.append(ot,St);if(St(ot.shared.gl,".useProgram(",E,".program);"),Ye.shader.program)Jo(ot,St,Ye,Ye.shader.program);else{St(ot.shared.vao,".setVAO(null);");var S=ot.global.def("{}"),I=St.def(E,".id"),D=St.def(S,"[",I,"]");St(ot.cond(D).then(D,".call(this,a0,a1);").else(D,"=",S,"[",I,"]=",ot.link(function(V){return mi(Jo,ot,Ye,V,2)}),"(",E,");",D,".call(this,a0,a1);"))}}Object.keys(Ye.state).length>0&&St(ot.shared.current,".dirty=true;")}function ft(ot,Ye){var St=ot.proc("scope",3);ot.batchId="a2";var Dt=ot.shared,Ft=Dt.current;jo(ot,St,Ye.context),Ye.framebuffer&&Ye.framebuffer.append(ot,St),Tf(Object.keys(Ye.state)).forEach(function(f){var p=Ye.state[f],m=p.append(ot,St);Za(m)?m.forEach(function(E,S){St.set(ot.next[f],"["+S+"]",E)}):St.set(Dt.next,"."+f,m)}),un(ot,St,Ye,!0,!0),[ac,A0,Zl,Hf,Cc].forEach(function(f){var p=Ye.draw[f];p&&St.set(Dt.draw,"."+f,""+p.append(ot,St))}),Object.keys(Ye.uniforms).forEach(function(f){var p=Ye.uniforms[f].append(ot,St);Array.isArray(p)&&(p="["+p.join()+"]"),St.set(Dt.uniforms,"["+Qe.id(f)+"]",p)}),Object.keys(Ye.attributes).forEach(function(f){var p=Ye.attributes[f].append(ot,St),m=ot.scopeAttrib(f);Object.keys(new Vt).forEach(function(E){St.set(m,"."+E,p[E])})}),Ye.scopeVAO&&St.set(Dt.vao,".targetVAO",Ye.scopeVAO.append(ot,St));function h(f){var p=Ye.shader[f];p&&St.set(Dt.shader,"."+f,p.append(ot,St))}h(ol),h(ss),Object.keys(Ye.state).length>0&&(St(Ft,".dirty=true;"),St.exit(Ft,".dirty=true;")),St("a1(",ot.shared.context,",a0,",ot.batchId,");")}function Et(ot){if(!(typeof ot!="object"||Za(ot))){for(var Ye=Object.keys(ot),St=0;St<Ye.length;++St)if(Yr.isDynamic(ot[Ye[St]]))return!0;return!1}}function Ur(ot,Ye,St){var Dt=Ye.static[St];if(!Dt||!Et(Dt))return;var Ft=ot.global,h=Object.keys(Dt),f=!1,p=!1,m=!1,E=ot.global.def("{}");h.forEach(function(I){var D=Dt[I];if(Yr.isDynamic(D)){typeof D=="function"&&(D=Dt[I]=Yr.unbox(D));var V=Ko(D,null);f=f||V.thisDep,m=m||V.propDep,p=p||V.contextDep}else{switch(Ft(E,".",I,"="),typeof D){case"number":Ft(D);break;case"string":Ft('"',D,'"');break;case"object":Array.isArray(D)&&Ft("[",D.join(),"]");break;default:Ft(ot.link(D));break}Ft(";")}});function S(I,D){h.forEach(function(V){var re=Dt[V];if(Yr.isDynamic(re)){var xe=I.invoke(D,re);D(E,".",V,"=",xe,";")}})}Ye.dynamic[St]=new Yr.DynamicVariable(nf,{thisDep:f,contextDep:p,propDep:m,ref:E,append:S}),delete Ye.static[St]}function Un(ot,Ye,St,Dt,Ft){var h=On();h.stats=h.link(Ft),Object.keys(Ye.static).forEach(function(p){Ur(h,Ye,p)}),j0.forEach(function(p){Ur(h,ot,p)});var f=Ao(ot,Ye,St,Dt,h);return Ri(h,f),ft(h,f),ct(h,f),C(h.compile(),{destroy:function(){f.shader.program.destroy()}})}return{next:cn,current:_r,procs:function(){var ot=On(),Ye=ot.proc("poll"),St=ot.proc("refresh"),Dt=ot.block();Ye(Dt),St(Dt);var Ft=ot.shared,h=Ft.gl,f=Ft.next,p=Ft.current;Dt(p,".dirty=false;"),Fa(ot,Ye),Fa(ot,St,null,!0);var m;Rr&&(m=ot.link(Rr)),mt.oes_vertex_array_object&&St(ot.link(mt.oes_vertex_array_object),".bindVertexArrayOES(null);");for(var E=0;E<nr.maxAttributes;++E){var S=St.def(Ft.attributes,"[",E,"]"),I=ot.cond(S,".buffer");I.then(h,".enableVertexAttribArray(",E,");",h,".bindBuffer(",oc,",",S,".buffer.buffer);",h,".vertexAttribPointer(",E,",",S,".size,",S,".type,",S,".normalized,",S,".stride,",S,".offset);").else(h,".disableVertexAttribArray(",E,");",h,".vertexAttrib4f(",E,",",S,".x,",S,".y,",S,".z,",S,".w);",S,".buffer=null;"),St(I),Rr&&St(m,".vertexAttribDivisorANGLE(",E,",",S,".divisor);")}return St(ot.shared.vao,".currentVAO=null;",ot.shared.vao,".setVAO(",ot.shared.vao,".targetVAO);"),Object.keys(Hr).forEach(function(D){var V=Hr[D],re=Dt.def(f,".",D),xe=ot.block();xe("if(",re,"){",h,".enable(",V,")}else{",h,".disable(",V,")}",p,".",D,"=",re,";"),St(xe),Ye("if(",re,"!==",p,".",D,"){",xe,"}")}),Object.keys(br).forEach(function(D){var V=br[D],re=_r[D],xe,Fe,ut=ot.block();if(ut(h,".",V,"("),Za(re)){var gt=re.length;xe=ot.global.def(f,".",D),Fe=ot.global.def(p,".",D),ut(_n(gt,function(rt){return xe+"["+rt+"]"}),");",_n(gt,function(rt){return Fe+"["+rt+"]="+xe+"["+rt+"];"}).join("")),Ye("if(",_n(gt,function(rt){return xe+"["+rt+"]!=="+Fe+"["+rt+"]"}).join("||"),"){",ut,"}")}else xe=Dt.def(f,".",D),Fe=Dt.def(p,".",D),ut(xe,");",p,".",D,"=",xe,";"),Ye("if(",xe,"!==",Fe,"){",ut,"}");St(ut)}),ot.compile()}(),compile:Un}}function Mf(){return{vaoCount:0,bufferCount:0,elementsCount:0,framebufferCount:0,shaderCount:0,textureCount:0,cubeCount:0,renderbufferCount:0,maxTextureUnits:0}}var W0=34918,Nc=34919,If=35007,Wf=function(Ce,Qe){if(!Qe.ext_disjoint_timer_query)return null;var mt=[];function nr(){return mt.pop()||Qe.ext_disjoint_timer_query.createQueryEXT()}function Ar(Rr){mt.push(Rr)}var er=[];function sr(Rr){var tn=nr();Qe.ext_disjoint_timer_query.beginQueryEXT(If,tn),er.push(tn),Mr(er.length-1,er.length,Rr)}function Tr(){Qe.ext_disjoint_timer_query.endQueryEXT(If)}function Lr(){this.startQueryIndex=-1,this.endQueryIndex=-1,this.sum=0,this.stats=null}var Nr=[];function kr(){return Nr.pop()||new Lr}function Or(Rr){Nr.push(Rr)}var qr=[];function Mr(Rr,tn,_r){var cn=kr();cn.startQueryIndex=Rr,cn.endQueryIndex=tn,cn.sum=0,cn.stats=_r,qr.push(cn)}var zr=[],Vt=[];function lr(){var Rr,tn,_r=er.length;if(_r!==0){Vt.length=Math.max(Vt.length,_r+1),zr.length=Math.max(zr.length,_r+1),zr[0]=0,Vt[0]=0;var cn=0;for(Rr=0,tn=0;tn<er.length;++tn){var wr=er[tn];Qe.ext_disjoint_timer_query.getQueryObjectEXT(wr,Nc)?(cn+=Qe.ext_disjoint_timer_query.getQueryObjectEXT(wr,W0),Ar(wr)):er[Rr++]=wr,zr[tn+1]=cn,Vt[tn+1]=Rr}for(er.length=Rr,Rr=0,tn=0;tn<qr.length;++tn){var Hr=qr[tn],br=Hr.startQueryIndex,Wr=Hr.endQueryIndex;Hr.sum+=zr[Wr]-zr[br];var Cn=Vt[br],Xn=Vt[Wr];Xn===Cn?(Hr.stats.gpuTime+=Hr.sum/1e6,Or(Hr)):(Hr.startQueryIndex=Cn,Hr.endQueryIndex=Xn,qr[Rr++]=Hr)}qr.length=Rr}}return{beginQuery:sr,endQuery:Tr,pushScopeStats:Mr,update:lr,getNumPendingQueries:function(){return er.length},clear:function(){mt.push.apply(mt,er);for(var Rr=0;Rr<mt.length;Rr++)Qe.ext_disjoint_timer_query.deleteQueryEXT(mt[Rr]);er.length=0,mt.length=0},restore:function(){er.length=0,mt.length=0}}},X0=16384,ff=256,Pf=1024,Ya=34962,Fc="webglcontextlost",Wl="webglcontextrestored",qs=1,vu=2,Rs=3;function Xf(Ce,Qe){for(var mt=0;mt<Ce.length;++mt)if(Ce[mt]===Qe)return mt;return-1}function _0(Ce){var Qe=Ns(Ce);if(!Qe)return null;var mt=Qe.gl,nr=mt.getContextAttributes(),Ar=mt.isContextLost(),er=Co(mt,Qe);if(!er)return null;var sr=en(),Tr=Mf(),Lr=er.extensions,Nr=Wf(mt,Lr),kr=Br(),Or=mt.drawingBufferWidth,qr=mt.drawingBufferHeight,Mr={tick:0,time:0,viewportWidth:Or,viewportHeight:qr,framebufferWidth:Or,framebufferHeight:qr,drawingBufferWidth:Or,drawingBufferHeight:qr,pixelRatio:Qe.pixelRatio},zr={},Vt={elements:null,primitive:4,count:-1,offset:0,instances:-1},lr=Mt(mt,Lr),Rr=mo(mt,Tr,Qe,_r),tn=Yn(mt,Lr,lr,Tr,Rr);function _r(Rn){return tn.destroyBuffer(Rn)}var cn=mc(mt,Lr,Rr,Tr),wr=wi(mt,sr,Tr,Qe),Hr=Wi(mt,Lr,lr,function(){Cn.procs.poll()},Mr,Tr,Qe),br=Zu(mt,Lr,lr,Tr,Qe),Wr=os(mt,Lr,lr,Hr,br,Tr),Cn=cl(mt,sr,Lr,lr,Rr,cn,Hr,Wr,zr,tn,wr,Vt,Mr,Nr,Qe),Xn=lt(mt,Wr,Cn.procs.poll,Mr,nr,Lr,lr),Ir=Cn.next,Fr=mt.canvas,gr=[],On=[],Bn=[],gn=[Qe.onDestroy],xi=null;function Jn(){if(gr.length===0){Nr&&Nr.update(),xi=null;return}xi=an.next(Jn),Tn();for(var Rn=gr.length-1;Rn>=0;--Rn){var mi=gr[Rn];mi&&mi(Mr,null,0)}mt.flush(),Nr&&Nr.update()}function gi(){!xi&&gr.length>0&&(xi=an.next(Jn))}function ta(){xi&&(an.cancel(Jn),xi=null)}function bo(Rn){Rn.preventDefault(),Ar=!0,ta(),On.forEach(function(mi){mi()})}function ro(Rn){mt.getError(),Ar=!1,er.restore(),wr.restore(),Rr.restore(),Hr.restore(),br.restore(),Wr.restore(),tn.restore(),Nr&&Nr.restore(),Cn.procs.refresh(),gi(),Bn.forEach(function(mi){mi()})}Fr&&(Fr.addEventListener(Fc,bo,!1),Fr.addEventListener(Wl,ro,!1));function Ti(){gr.length=0,ta(),Fr&&(Fr.removeEventListener(Fc,bo),Fr.removeEventListener(Wl,ro)),wr.clear(),Wr.clear(),br.clear(),Hr.clear(),cn.clear(),Rr.clear(),tn.clear(),Nr&&Nr.clear(),gn.forEach(function(Rn){Rn()})}function Io(Rn){J(!!Rn,"invalid args to regl({...})"),J.type(Rn,"object","invalid args to regl({...})");function mi(Ft){var h=C({},Ft);delete h.uniforms,delete h.attributes,delete h.context,delete h.vao,"stencil"in h&&h.stencil.op&&(h.stencil.opBack=h.stencil.opFront=h.stencil.op,delete h.stencil.op);function f(p){if(p in h){var m=h[p];delete h[p],Object.keys(m).forEach(function(E){h[p+"."+E]=m[E]})}}return f("blend"),f("depth"),f("cull"),f("stencil"),f("polygonOffset"),f("scissor"),f("sample"),"vao"in Ft&&(h.vao=Ft.vao),h}function vr(Ft,h){var f={},p={};return Object.keys(Ft).forEach(function(m){var E=Ft[m];if(Yr.isDynamic(E)){p[m]=Yr.unbox(E,m);return}else if(h&&Array.isArray(E)){for(var S=0;S<E.length;++S)if(Yr.isDynamic(E[S])){p[m]=Yr.unbox(E,m);return}}f[m]=E}),{dynamic:p,static:f}}var Ri=vr(Rn.context||{},!0),Xt=vr(Rn.uniforms||{},!0),Jo=vr(Rn.attributes||{},!1),ct=vr(mi(Rn),!1),ft={gpuTime:0,cpuTime:0,count:0},Et=Cn.compile(ct,Jo,Xt,Ri,ft),Ur=Et.draw,Un=Et.batch,ot=Et.scope,Ye=[];function St(Ft){for(;Ye.length<Ft;)Ye.push(null);return Ye}function Dt(Ft,h){var f;if(Ar&&J.raise("context lost"),typeof Ft=="function")return ot.call(this,null,Ft,0);if(typeof h=="function")if(typeof Ft=="number")for(f=0;f<Ft;++f)ot.call(this,null,h,f);else if(Array.isArray(Ft))for(f=0;f<Ft.length;++f)ot.call(this,Ft[f],h,f);else return ot.call(this,Ft,h,0);else if(typeof Ft=="number"){if(Ft>0)return Un.call(this,St(Ft|0),Ft|0)}else if(Array.isArray(Ft)){if(Ft.length)return Un.call(this,Ft,Ft.length)}else return Ur.call(this,Ft)}return C(Dt,{stats:ft,destroy:function(){Et.destroy()}})}var Na=Wr.setFBO=Io({framebuffer:Yr.define.call(null,qs,"framebuffer")});function Ao(Rn,mi){var vr=0;Cn.procs.poll();var Ri=mi.color;Ri&&(mt.clearColor(+Ri[0]||0,+Ri[1]||0,+Ri[2]||0,+Ri[3]||0),vr|=X0),"depth"in mi&&(mt.clearDepth(+mi.depth),vr|=ff),"stencil"in mi&&(mt.clearStencil(mi.stencil|0),vr|=Pf),J(!!vr,"called regl.clear with no buffer specified"),mt.clear(vr)}function jo(Rn){if(J(typeof Rn=="object"&&Rn,"regl.clear() takes an object as input"),"framebuffer"in Rn)if(Rn.framebuffer&&Rn.framebuffer_reglType==="framebufferCube")for(var mi=0;mi<6;++mi)Na(C({framebuffer:Rn.framebuffer.faces[mi]},Rn),Ao);else Na(Rn,Ao);else Ao(null,Rn)}function Fa(Rn){J.type(Rn,"function","regl.frame() callback must be a function"),gr.push(Rn);function mi(){var vr=Xf(gr,Rn);J(vr>=0,"cannot cancel a frame twice");function Ri(){var Xt=Xf(gr,Ri);gr[Xt]=gr[gr.length-1],gr.length-=1,gr.length<=0&&ta()}gr[vr]=Ri}return gi(),{cancel:mi}}function Ga(){var Rn=Ir.viewport,mi=Ir.scissor_box;Rn[0]=Rn[1]=mi[0]=mi[1]=0,Mr.viewportWidth=Mr.framebufferWidth=Mr.drawingBufferWidth=Rn[2]=mi[2]=mt.drawingBufferWidth,Mr.viewportHeight=Mr.framebufferHeight=Mr.drawingBufferHeight=Rn[3]=mi[3]=mt.drawingBufferHeight}function Tn(){Mr.tick+=1,Mr.time=un(),Ga(),Cn.procs.poll()}function ya(){Hr.refresh(),Ga(),Cn.procs.refresh(),Nr&&Nr.update()}function un(){return(Br()-kr)/1e3}ya();function da(Rn,mi){J.type(mi,"function","listener callback must be a function");var vr;switch(Rn){case"frame":return Fa(mi);case"lost":vr=On;break;case"restore":vr=Bn;break;case"destroy":vr=gn;break;default:J.raise("invalid event, must be one of frame,lost,restore,destroy")}return vr.push(mi),{cancel:function(){for(var Ri=0;Ri<vr.length;++Ri)if(vr[Ri]===mi){vr[Ri]=vr[vr.length-1],vr.pop();return}}}}var ra=C(Io,{clear:jo,prop:Yr.define.bind(null,qs),context:Yr.define.bind(null,vu),this:Yr.define.bind(null,Rs),draw:Io({}),buffer:function(Rn){return Rr.create(Rn,Ya,!1,!1)},elements:function(Rn){return cn.create(Rn,!1)},texture:Hr.create2D,cube:Hr.createCube,renderbuffer:br.create,framebuffer:Wr.create,framebufferCube:Wr.createCube,vao:tn.createVAO,attributes:nr,frame:Fa,on:da,limits:lr,hasExtension:function(Rn){return lr.extensions.indexOf(Rn.toLowerCase())>=0},read:Xn,destroy:Ti,_gl:mt,_refresh:ya,poll:function(){Tn(),Nr&&Nr.update()},now:un,stats:Tr});return Qe.onDone(null,ra),ra}return _0})},88639:function(le,$){(function(C,L){L($)})(this,function(C){"use strict";const k=33306690738754706e-32;function G(Ve,nt,Ee,Ie,me){let we,ne,Pe,he,ve=nt[0],te=Ie[0],Y=0,Oe=0;te>ve==te>-ve?(we=ve,ve=nt[++Y]):(we=te,te=Ie[++Oe]);let pe=0;if(Y<Ve&&Oe<Ee)for(te>ve==te>-ve?(Pe=we-((ne=ve+we)-ve),ve=nt[++Y]):(Pe=we-((ne=te+we)-te),te=Ie[++Oe]),we=ne,Pe!==0&&(me[pe++]=Pe);Y<Ve&&Oe<Ee;)te>ve==te>-ve?(Pe=we-((ne=we+ve)-(he=ne-we))+(ve-he),ve=nt[++Y]):(Pe=we-((ne=we+te)-(he=ne-we))+(te-he),te=Ie[++Oe]),we=ne,Pe!==0&&(me[pe++]=Pe);for(;Y<Ve;)Pe=we-((ne=we+ve)-(he=ne-we))+(ve-he),ve=nt[++Y],we=ne,Pe!==0&&(me[pe++]=Pe);for(;Oe<Ee;)Pe=we-((ne=we+te)-(he=ne-we))+(te-he),te=Ie[++Oe],we=ne,Pe!==0&&(me[pe++]=Pe);return we===0&&pe!==0||(me[pe++]=we),pe}function Z(Ve){return new Float64Array(Ve)}const F=33306690738754716e-32,z=22204460492503146e-32,q=11093356479670487e-47,ee=Z(4),fe=Z(8),Se=Z(12),Re=Z(16),De=Z(4);C.orient2d=function(Ve,nt,Ee,Ie,me,we){const ne=(nt-we)*(Ee-me),Pe=(Ve-me)*(Ie-we),he=ne-Pe;if(ne===0||Pe===0||ne>0!=Pe>0)return he;const ve=Math.abs(ne+Pe);return Math.abs(he)>=F*ve?he:-function(te,Y,Oe,pe,ye,_e,X){let Le,de,be,se,Ne,ze,ue,kt,Rt,cr,Ut,$r,ln,Cr,Qr,Jr,xr,Gn;const ti=te-ye,Vn=Oe-ye,Xr=Y-_e,sn=pe-_e;Ne=(Qr=(kt=ti-(ue=(ze=134217729*ti)-(ze-ti)))*(cr=sn-(Rt=(ze=134217729*sn)-(ze-sn)))-((Cr=ti*sn)-ue*Rt-kt*Rt-ue*cr))-(Ut=Qr-(xr=(kt=Xr-(ue=(ze=134217729*Xr)-(ze-Xr)))*(cr=Vn-(Rt=(ze=134217729*Vn)-(ze-Vn)))-((Jr=Xr*Vn)-ue*Rt-kt*Rt-ue*cr))),ee[0]=Qr-(Ut+Ne)+(Ne-xr),Ne=(ln=Cr-(($r=Cr+Ut)-(Ne=$r-Cr))+(Ut-Ne))-(Ut=ln-Jr),ee[1]=ln-(Ut+Ne)+(Ne-Jr),Ne=(Gn=$r+Ut)-$r,ee[2]=$r-(Gn-Ne)+(Ut-Ne),ee[3]=Gn;let yn=function(Ue,$e){let At=$e[0];for(let It=1;It<Ue;It++)At+=$e[It];return At}(4,ee),ki=z*X;if(yn>=ki||-yn>=ki||(Le=te-(ti+(Ne=te-ti))+(Ne-ye),be=Oe-(Vn+(Ne=Oe-Vn))+(Ne-ye),de=Y-(Xr+(Ne=Y-Xr))+(Ne-_e),se=pe-(sn+(Ne=pe-sn))+(Ne-_e),Le===0&&de===0&&be===0&&se===0)||(ki=q*X+k*Math.abs(yn),(yn+=ti*se+sn*Le-(Xr*be+Vn*de))>=ki||-yn>=ki))return yn;Ne=(Qr=(kt=Le-(ue=(ze=134217729*Le)-(ze-Le)))*(cr=sn-(Rt=(ze=134217729*sn)-(ze-sn)))-((Cr=Le*sn)-ue*Rt-kt*Rt-ue*cr))-(Ut=Qr-(xr=(kt=de-(ue=(ze=134217729*de)-(ze-de)))*(cr=Vn-(Rt=(ze=134217729*Vn)-(ze-Vn)))-((Jr=de*Vn)-ue*Rt-kt*Rt-ue*cr))),De[0]=Qr-(Ut+Ne)+(Ne-xr),Ne=(ln=Cr-(($r=Cr+Ut)-(Ne=$r-Cr))+(Ut-Ne))-(Ut=ln-Jr),De[1]=ln-(Ut+Ne)+(Ne-Jr),Ne=(Gn=$r+Ut)-$r,De[2]=$r-(Gn-Ne)+(Ut-Ne),De[3]=Gn;const ri=G(4,ee,4,De,fe);Ne=(Qr=(kt=ti-(ue=(ze=134217729*ti)-(ze-ti)))*(cr=se-(Rt=(ze=134217729*se)-(ze-se)))-((Cr=ti*se)-ue*Rt-kt*Rt-ue*cr))-(Ut=Qr-(xr=(kt=Xr-(ue=(ze=134217729*Xr)-(ze-Xr)))*(cr=be-(Rt=(ze=134217729*be)-(ze-be)))-((Jr=Xr*be)-ue*Rt-kt*Rt-ue*cr))),De[0]=Qr-(Ut+Ne)+(Ne-xr),Ne=(ln=Cr-(($r=Cr+Ut)-(Ne=$r-Cr))+(Ut-Ne))-(Ut=ln-Jr),De[1]=ln-(Ut+Ne)+(Ne-Jr),Ne=(Gn=$r+Ut)-$r,De[2]=$r-(Gn-Ne)+(Ut-Ne),De[3]=Gn;const Lt=G(ri,fe,4,De,Se);Ne=(Qr=(kt=Le-(ue=(ze=134217729*Le)-(ze-Le)))*(cr=se-(Rt=(ze=134217729*se)-(ze-se)))-((Cr=Le*se)-ue*Rt-kt*Rt-ue*cr))-(Ut=Qr-(xr=(kt=de-(ue=(ze=134217729*de)-(ze-de)))*(cr=be-(Rt=(ze=134217729*be)-(ze-be)))-((Jr=de*be)-ue*Rt-kt*Rt-ue*cr))),De[0]=Qr-(Ut+Ne)+(Ne-xr),Ne=(ln=Cr-(($r=Cr+Ut)-(Ne=$r-Cr))+(Ut-Ne))-(Ut=ln-Jr),De[1]=ln-(Ut+Ne)+(Ne-Jr),Ne=(Gn=$r+Ut)-$r,De[2]=$r-(Gn-Ne)+(Ut-Ne),De[3]=Gn;const J=G(Lt,Se,4,De,Re);return Re[J-1]}(Ve,nt,Ee,Ie,me,we,ve)},C.orient2dfast=function(Ve,nt,Ee,Ie,me,we){return(nt-we)*(Ee-me)-(Ve-me)*(Ie-we)},Object.defineProperty(C,"__esModule",{value:!0})})},67771:function(le,$,C){"use strict";var L=C(40210),k=C(12296),G=C(31044)(),Z=C(25275),F=L("%TypeError%"),z=L("%Math.floor%");le.exports=function(ee,fe){if(typeof ee!="function")throw new F("`fn` is not a function");if(typeof fe!="number"||fe<0||fe>4294967295||z(fe)!==fe)throw new F("`length` must be a positive 32-bit integer");var Se=arguments.length>2&&!!arguments[2],Re=!0,De=!0;if("length"in ee&&Z){var Ve=Z(ee,"length");Ve&&!Ve.configurable&&(Re=!1),Ve&&!Ve.writable&&(De=!1)}return(Re||De||!Se)&&(G?k(ee,"length",fe,!0,!0):k(ee,"length",fe)),ee}},58052:function(le,$,C){"use strict";var L=C(12296),k=C(31044)(),G=C(25972).functionsHaveConfigurableNames(),Z=TypeError;le.exports=function(z,q){if(typeof z!="function")throw new Z("`fn` is not a function");var ee=arguments.length>2&&!!arguments[2];return(!ee||G)&&(k?L(z,"name",q,!0,!0):L(z,"name",q)),z}},85697:function(le){"use strict";le.exports={eudist:function(C,L,k){for(var G=C.length,Z=0,F=0;F<G;F++){var z=(C[F]||0)-(L[F]||0);Z+=z*z}return k?Math.sqrt(Z):Z},mandist:function(C,L,k){for(var G=C.length,Z=0,F=0;F<G;F++)Z+=Math.abs((C[F]||0)-(L[F]||0));return k?Math.sqrt(Z):Z},dist:function(C,L,k){var G=Math.abs(C-L);return k?G:G*G}}},97035:function(le,$,C){"use strict";var L=C(85697),k=L.eudist,G=L.dist;le.exports={kmrand:function(F,z){for(var q={},ee=[],fe=z<<2,Se=F.length,Re=F[0].length>0;ee.length<z&&fe-- >0;){var De=F[Math.floor(Math.random()*Se)],Ve=Re?De.join("_"):""+De;q[Ve]||(q[Ve]=!0,ee.push(De))}if(ee.length<z)throw new Error("Error initializating clusters");return ee},kmpp:function(F,z){var q=F[0].length?k:G,ee=[],fe=F.length,Se=F[0].length>0,Re={},De=F[Math.floor(Math.random()*fe)],Ve=Se?De.join("_"):""+De;for(ee.push(De),Re[Ve]=!0;ee.length<z;){for(var nt=[],Ee=ee.length,Ie=0,me=[],we=0;we<fe;we++){for(var ne=1/0,Pe=0;Pe<Ee;Pe++){var he=q(F[we],ee[Pe]);he<=ne&&(ne=he)}nt[we]=ne}for(var ve=0;ve<fe;ve++)Ie+=nt[ve];for(var te=0;te<fe;te++)me[te]={i:te,v:F[te],pr:nt[te]/Ie,cs:0};me.sort(function(ye,_e){return ye.pr-_e.pr}),me[0].cs=me[0].pr;for(var Y=1;Y<fe;Y++)me[Y].cs=me[Y-1].cs+me[Y].pr;for(var Oe=Math.random(),pe=0;pe<fe-1&&me[pe++].cs<Oe;);ee.push(me[pe-1].v)}return ee}}},21160:function(le,$,C){"use strict";var L=C(85697),k=C(97035),G=L.eudist,Z=L.mandist,F=L.dist,z=k.kmrand,q=k.kmpp,ee=1e4;function fe(Re,De,Ve){Ve=Ve||[];for(var nt=0;nt<Re;nt++)Ve[nt]=De;return Ve}function Se(Re,De,Ve,nt){var Ee=[],Ie=[],me=[],we=[],ne=!1,Pe=nt||ee,he=Re.length,ve=Re[0].length,te=ve>0,Y=[];if(Ve)Ve=="kmrand"?Ee=z(Re,De):Ve=="kmpp"?Ee=q(Re,De):Ee=Ve;else for(var Oe={};Ee.length<De;){var pe=Math.floor(Math.random()*he);Oe[pe]||(Oe[pe]=!0,Ee.push(Re[pe]))}do{fe(De,0,Y);for(var ye=0;ye<he;ye++){for(var _e=1/0,X=0,Le=0;Le<De;Le++){var we=te?G(Re[ye],Ee[Le]):Math.abs(Re[ye]-Ee[Le]);we<=_e&&(_e=we,X=Le)}me[ye]=X,Y[X]++}for(var de=[],Ie=[],be=0,se=0;se<De;se++)de[se]=te?fe(ve,0,de[se]):0,Ie[se]=Ee[se];if(te){for(var Ne=0;Ne<De;Ne++)Ee[Ne]=[];for(var ze=0;ze<he;ze++)for(var ue=me[ze],kt=de[ue],Rt=Re[ze],cr=0;cr<ve;cr++)kt[cr]+=Rt[cr];ne=!0;for(var Ut=0;Ut<De;Ut++){for(var $r=Ee[Ut],ln=de[Ut],Cr=Ie[Ut],Qr=Y[Ut],Jr=0;Jr<ve;Jr++)$r[Jr]=ln[Jr]/Qr||0;if(ne){for(var xr=0;xr<ve;xr++)if(Cr[xr]!=$r[xr]){ne=!1;break}}}}else{for(var Gn=0;Gn<he;Gn++){var ti=me[Gn];de[ti]+=Re[Gn]}for(var Vn=0;Vn<De;Vn++)Ee[Vn]=de[Vn]/Y[Vn]||0;ne=!0;for(var Xr=0;Xr<De;Xr++)if(Ie[Xr]!=Ee[Xr]){ne=!1;break}}ne=ne||--Pe<=0}while(!ne);return{it:ee-Pe,k:De,idxs:me,centroids:Ee}}le.exports=Se},69848:function(le){(function($,C){le.exports=C()})(this,function(){"use strict";function $(te,Y,Oe,pe,ye,_e){if(!(ye-pe<=Oe)){var X=pe+ye>>1;C(te,Y,X,pe,ye,_e%2),$(te,Y,Oe,pe,X-1,_e+1),$(te,Y,Oe,X+1,ye,_e+1)}}function C(te,Y,Oe,pe,ye,_e){for(;ye>pe;){if(ye-pe>600){var X=ye-pe+1,Le=Oe-pe+1,de=Math.log(X),be=.5*Math.exp(2*de/3),se=.5*Math.sqrt(de*be*(X-be)/X)*(Le-X/2<0?-1:1),Ne=Math.max(pe,Math.floor(Oe-Le*be/X+se)),ze=Math.min(ye,Math.floor(Oe+(X-Le)*be/X+se));C(te,Y,Oe,Ne,ze,_e)}var ue=Y[2*Oe+_e],kt=pe,Rt=ye;for(L(te,Y,pe,Oe),Y[2*ye+_e]>ue&&L(te,Y,pe,ye);kt<Rt;){for(L(te,Y,kt,Rt),kt++,Rt--;Y[2*kt+_e]<ue;)kt++;for(;Y[2*Rt+_e]>ue;)Rt--}Y[2*pe+_e]===ue?L(te,Y,pe,Rt):(Rt++,L(te,Y,Rt,ye)),Rt<=Oe&&(pe=Rt+1),Oe<=Rt&&(ye=Rt-1)}}function L(te,Y,Oe,pe){k(te,Oe,pe),k(Y,2*Oe,2*pe),k(Y,2*Oe+1,2*pe+1)}function k(te,Y,Oe){var pe=te[Y];te[Y]=te[Oe],te[Oe]=pe}function G(te,Y,Oe,pe,ye,_e,X){for(var Le=[0,te.length-1,0],de=[],be,se;Le.length;){var Ne=Le.pop(),ze=Le.pop(),ue=Le.pop();if(ze-ue<=X){for(var kt=ue;kt<=ze;kt++)be=Y[2*kt],se=Y[2*kt+1],be>=Oe&&be<=ye&&se>=pe&&se<=_e&&de.push(te[kt]);continue}var Rt=Math.floor((ue+ze)/2);be=Y[2*Rt],se=Y[2*Rt+1],be>=Oe&&be<=ye&&se>=pe&&se<=_e&&de.push(te[Rt]);var cr=(Ne+1)%2;(Ne===0?Oe<=be:pe<=se)&&(Le.push(ue),Le.push(Rt-1),Le.push(cr)),(Ne===0?ye>=be:_e>=se)&&(Le.push(Rt+1),Le.push(ze),Le.push(cr))}return de}function Z(te,Y,Oe,pe,ye,_e){for(var X=[0,te.length-1,0],Le=[],de=ye*ye;X.length;){var be=X.pop(),se=X.pop(),Ne=X.pop();if(se-Ne<=_e){for(var ze=Ne;ze<=se;ze++)F(Y[2*ze],Y[2*ze+1],Oe,pe)<=de&&Le.push(te[ze]);continue}var ue=Math.floor((Ne+se)/2),kt=Y[2*ue],Rt=Y[2*ue+1];F(kt,Rt,Oe,pe)<=de&&Le.push(te[ue]);var cr=(be+1)%2;(be===0?Oe-ye<=kt:pe-ye<=Rt)&&(X.push(Ne),X.push(ue-1),X.push(cr)),(be===0?Oe+ye>=kt:pe+ye>=Rt)&&(X.push(ue+1),X.push(se),X.push(cr))}return Le}function F(te,Y,Oe,pe){var ye=te-Oe,_e=Y-pe;return ye*ye+_e*_e}var z=function(te){return te[0]},q=function(te){return te[1]},ee=function(Y,Oe,pe,ye,_e){Oe===void 0&&(Oe=z),pe===void 0&&(pe=q),ye===void 0&&(ye=64),_e===void 0&&(_e=Float64Array),this.nodeSize=ye,this.points=Y;for(var X=Y.length<65536?Uint16Array:Uint32Array,Le=this.ids=new X(Y.length),de=this.coords=new _e(Y.length*2),be=0;be<Y.length;be++)Le[be]=be,de[2*be]=Oe(Y[be]),de[2*be+1]=pe(Y[be]);$(Le,de,ye,0,Le.length-1,0)};ee.prototype.range=function(Y,Oe,pe,ye){return G(this.ids,this.coords,Y,Oe,pe,ye,this.nodeSize)},ee.prototype.within=function(Y,Oe,pe){return Z(this.ids,this.coords,Y,Oe,pe,this.nodeSize)};var fe={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:function(te){return te}},Se=Math.fround||function(te){return function(Y){return te[0]=+Y,te[0]}}(new Float32Array(1)),Re=function(Y){this.options=Pe(Object.create(fe),Y),this.trees=new Array(this.options.maxZoom+1)};Re.prototype.load=function(Y){var Oe=this.options,pe=Oe.log,ye=Oe.minZoom,_e=Oe.maxZoom,X=Oe.nodeSize;pe&&console.time("total time");var Le="prepare "+Y.length+" points";pe&&console.time(Le),this.points=Y;for(var de=[],be=0;be<Y.length;be++)Y[be].geometry&&de.push(Ve(Y[be],be));this.trees[_e+1]=new ee(de,he,ve,X,Float32Array),pe&&console.timeEnd(Le);for(var se=_e;se>=ye;se--){var Ne=+Date.now();de=this._cluster(de,se),this.trees[se]=new ee(de,he,ve,X,Float32Array),pe&&console.log("z%d: %d clusters in %dms",se,de.length,+Date.now()-Ne)}return pe&&console.timeEnd("total time"),this},Re.prototype.getClusters=function(Y,Oe){var pe=((Y[0]+180)%360+360)%360-180,ye=Math.max(-90,Math.min(90,Y[1])),_e=Y[2]===180?180:((Y[2]+180)%360+360)%360-180,X=Math.max(-90,Math.min(90,Y[3]));if(Y[2]-Y[0]>=360)pe=-180,_e=180;else if(pe>_e){var Le=this.getClusters([pe,ye,180,X],Oe),de=this.getClusters([-180,ye,_e,X],Oe);return Le.concat(de)}for(var be=this.trees[this._limitZoom(Oe)],se=be.range(Ie(pe),me(X),Ie(_e),me(ye)),Ne=[],ze=0,ue=se;ze<ue.length;ze+=1){var kt=ue[ze],Rt=be.points[kt];Ne.push(Rt.numPoints?nt(Rt):this.points[Rt.index])}return Ne},Re.prototype.getChildren=function(Y){var Oe=this._getOriginId(Y),pe=this._getOriginZoom(Y),ye="No cluster with the specified id.",_e=this.trees[pe];if(!_e)throw new Error(ye);var X=_e.points[Oe];if(!X)throw new Error(ye);for(var Le=this.options.radius/(this.options.extent*Math.pow(2,pe-1)),de=_e.within(X.x,X.y,Le),be=[],se=0,Ne=de;se<Ne.length;se+=1){var ze=Ne[se],ue=_e.points[ze];ue.parentId===Y&&be.push(ue.numPoints?nt(ue):this.points[ue.index])}if(be.length===0)throw new Error(ye);return be},Re.prototype.getLeaves=function(Y,Oe,pe){Oe=Oe||10,pe=pe||0;var ye=[];return this._appendLeaves(ye,Y,Oe,pe,0),ye},Re.prototype.getTile=function(Y,Oe,pe){var ye=this.trees[this._limitZoom(Y)],_e=Math.pow(2,Y),X=this.options,Le=X.extent,de=X.radius,be=de/Le,se=(pe-be)/_e,Ne=(pe+1+be)/_e,ze={features:[]};return this._addTileFeatures(ye.range((Oe-be)/_e,se,(Oe+1+be)/_e,Ne),ye.points,Oe,pe,_e,ze),Oe===0&&this._addTileFeatures(ye.range(1-be/_e,se,1,Ne),ye.points,_e,pe,_e,ze),Oe===_e-1&&this._addTileFeatures(ye.range(0,se,be/_e,Ne),ye.points,-1,pe,_e,ze),ze.features.length?ze:null},Re.prototype.getClusterExpansionZoom=function(Y){for(var Oe=this._getOriginZoom(Y)-1;Oe<=this.options.maxZoom;){var pe=this.getChildren(Y);if(Oe++,pe.length!==1)break;Y=pe[0].properties.cluster_id}return Oe},Re.prototype._appendLeaves=function(Y,Oe,pe,ye,_e){for(var X=this.getChildren(Oe),Le=0,de=X;Le<de.length;Le+=1){var be=de[Le],se=be.properties;if(se&&se.cluster?_e+se.point_count<=ye?_e+=se.point_count:_e=this._appendLeaves(Y,se.cluster_id,pe,ye,_e):_e<ye?_e++:Y.push(be),Y.length===pe)break}return _e},Re.prototype._addTileFeatures=function(Y,Oe,pe,ye,_e,X){for(var Le=0,de=Y;Le<de.length;Le+=1){var be=de[Le],se=Oe[be],Ne=se.numPoints,ze=void 0,ue=void 0,kt=void 0;if(Ne)ze=Ee(se),ue=se.x,kt=se.y;else{var Rt=this.points[se.index];ze=Rt.properties,ue=Ie(Rt.geometry.coordinates[0]),kt=me(Rt.geometry.coordinates[1])}var cr={type:1,geometry:[[Math.round(this.options.extent*(ue*_e-pe)),Math.round(this.options.extent*(kt*_e-ye))]],tags:ze},Ut=void 0;Ne?Ut=se.id:this.options.generateId?Ut=se.index:this.points[se.index].id&&(Ut=this.points[se.index].id),Ut!==void 0&&(cr.id=Ut),X.features.push(cr)}},Re.prototype._limitZoom=function(Y){return Math.max(this.options.minZoom,Math.min(Math.floor(+Y),this.options.maxZoom+1))},Re.prototype._cluster=function(Y,Oe){for(var pe=[],ye=this.options,_e=ye.radius,X=ye.extent,Le=ye.reduce,de=ye.minPoints,be=_e/(X*Math.pow(2,Oe)),se=0;se<Y.length;se++){var Ne=Y[se];if(!(Ne.zoom<=Oe)){Ne.zoom=Oe;for(var ze=this.trees[Oe+1],ue=ze.within(Ne.x,Ne.y,be),kt=Ne.numPoints||1,Rt=kt,cr=0,Ut=ue;cr<Ut.length;cr+=1){var $r=Ut[cr],ln=ze.points[$r];ln.zoom>Oe&&(Rt+=ln.numPoints||1)}if(Rt>kt&&Rt>=de){for(var Cr=Ne.x*kt,Qr=Ne.y*kt,Jr=Le&&kt>1?this._map(Ne,!0):null,xr=(se<<5)+(Oe+1)+this.points.length,Gn=0,ti=ue;Gn<ti.length;Gn+=1){var Vn=ti[Gn],Xr=ze.points[Vn];if(!(Xr.zoom<=Oe)){Xr.zoom=Oe;var sn=Xr.numPoints||1;Cr+=Xr.x*sn,Qr+=Xr.y*sn,Xr.parentId=xr,Le&&(Jr||(Jr=this._map(Ne,!0)),Le(Jr,this._map(Xr)))}}Ne.parentId=xr,pe.push(De(Cr/Rt,Qr/Rt,xr,Rt,Jr))}else if(pe.push(Ne),Rt>1)for(var yn=0,ki=ue;yn<ki.length;yn+=1){var ri=ki[yn],Lt=ze.points[ri];Lt.zoom<=Oe||(Lt.zoom=Oe,pe.push(Lt))}}}return pe},Re.prototype._getOriginId=function(Y){return Y-this.points.length>>5},Re.prototype._getOriginZoom=function(Y){return(Y-this.points.length)%32},Re.prototype._map=function(Y,Oe){if(Y.numPoints)return Oe?Pe({},Y.properties):Y.properties;var pe=this.points[Y.index].properties,ye=this.options.map(pe);return Oe&&ye===pe?Pe({},ye):ye};function De(te,Y,Oe,pe,ye){return{x:Se(te),y:Se(Y),zoom:1/0,id:Oe,parentId:-1,numPoints:pe,properties:ye}}function Ve(te,Y){var Oe=te.geometry.coordinates,pe=Oe[0],ye=Oe[1];return{x:Se(Ie(pe)),y:Se(me(ye)),zoom:1/0,index:Y,parentId:-1}}function nt(te){return{type:"Feature",id:te.id,properties:Ee(te),geometry:{type:"Point",coordinates:[we(te.x),ne(te.y)]}}}function Ee(te){var Y=te.numPoints,Oe=Y>=1e4?Math.round(Y/1e3)+"k":Y>=1e3?Math.round(Y/100)/10+"k":Y;return Pe(Pe({},te.properties),{cluster:!0,cluster_id:te.id,point_count:Y,point_count_abbreviated:Oe})}function Ie(te){return te/360+.5}function me(te){var Y=Math.sin(te*Math.PI/180),Oe=.5-.25*Math.log((1+Y)/(1-Y))/Math.PI;return Oe<0?0:Oe>1?1:Oe}function we(te){return(te-.5)*360}function ne(te){var Y=(180-te*360)*Math.PI/180;return 360*Math.atan(Math.exp(Y))/Math.PI-90}function Pe(te,Y){for(var Oe in Y)te[Oe]=Y[Oe];return te}function he(te){return te.x}function ve(te){return te.y}return Re})},43842:function(le,$,C){"use strict";C.r($),C.d($,{default:function(){return L}});class L{constructor(Z=[],F=k){if(this.data=Z,this.length=this.data.length,this.compare=F,this.length>0)for(let z=(this.length>>1)-1;z>=0;z--)this._down(z)}push(Z){this.data.push(Z),this.length++,this._up(this.length-1)}pop(){if(this.length===0)return;const Z=this.data[0],F=this.data.pop();return this.length--,this.length>0&&(this.data[0]=F,this._down(0)),Z}peek(){return this.data[0]}_up(Z){const{data:F,compare:z}=this,q=F[Z];for(;Z>0;){const ee=Z-1>>1,fe=F[ee];if(z(q,fe)>=0)break;F[Z]=fe,Z=ee}F[Z]=q}_down(Z){const{data:F,compare:z}=this,q=this.length>>1,ee=F[Z];for(;Z<q;){let fe=(Z<<1)+1,Se=F[fe];const Re=fe+1;if(Re<this.length&&z(F[Re],Se)<0&&(fe=Re,Se=F[Re]),z(Se,ee)>=0)break;F[Z]=Se,Z=fe}F[Z]=ee}}function k(G,Z){return G<Z?-1:G>Z?1:0}},20675:function(le,$){(function(C,L){L($)})(this,function(C){"use strict";function L(){}function k(o){this.message=o||""}function G(o){this.message=o||""}function Z(o){this.message=o||""}function F(){}function z(o){return o===null?cs:o.color}function q(o){return o===null?null:o.parent}function ee(o,s){o!==null&&(o.color=s)}function fe(o){return o===null?null:o.left}function Se(o){return o===null?null:o.right}function Re(){this.root_=null,this.size_=0}function De(){}function Ve(){this.array_=[],arguments[0]instanceof fi&&this.addAll(arguments[0])}function nt(){}function Ee(o){this.message=o||""}function Ie(){this.array_=[]}"fill"in Array.prototype||Object.defineProperty(Array.prototype,"fill",{configurable:!0,value:function(o){if(this===void 0||this===null)throw new TypeError(this+" is not an object");var s=Object(this),d=Math.max(Math.min(s.length,9007199254740991),0)||0,_=1 in arguments&&parseInt(Number(arguments[1]),10)||0;_=_<0?Math.max(d+_,0):Math.min(_,d);var w=2 in arguments&&arguments[2]!==void 0?parseInt(Number(arguments[2]),10)||0:d;for(w=w<0?Math.max(d+arguments[2],0):Math.min(w,d);_<w;)s[_]=o,++_;return s},writable:!0}),Number.isFinite=Number.isFinite||function(o){return typeof o=="number"&&isFinite(o)},Number.isInteger=Number.isInteger||function(o){return typeof o=="number"&&isFinite(o)&&Math.floor(o)===o},Number.parseFloat=Number.parseFloat||parseFloat,Number.isNaN=Number.isNaN||function(o){return o!=o},Math.trunc=Math.trunc||function(o){return o<0?Math.ceil(o):Math.floor(o)};var me=function(){};me.prototype.interfaces_=function(){return[]},me.prototype.getClass=function(){return me},me.prototype.equalsWithTolerance=function(o,s,d){return Math.abs(o-s)<=d};var we=function(o){function s(d){o.call(this,d),this.name="IllegalArgumentException",this.message=d,this.stack=new o().stack}return o&&(s.__proto__=o),s.prototype=Object.create(o&&o.prototype),s.prototype.constructor=s,s}(Error),ne=function(){},Pe={MAX_VALUE:{configurable:!0}};ne.isNaN=function(o){return Number.isNaN(o)},ne.doubleToLongBits=function(o){return o},ne.longBitsToDouble=function(o){return o},ne.isInfinite=function(o){return!Number.isFinite(o)},Pe.MAX_VALUE.get=function(){return Number.MAX_VALUE},Object.defineProperties(ne,Pe);var he=function(){},ve=function(){},te=function(){},Y=function o(){if(this.x=null,this.y=null,this.z=null,arguments.length===0)this.x=0,this.y=0,this.z=o.NULL_ORDINATE;else if(arguments.length===1){var s=arguments[0];this.x=s.x,this.y=s.y,this.z=s.z}else arguments.length===2?(this.x=arguments[0],this.y=arguments[1],this.z=o.NULL_ORDINATE):arguments.length===3&&(this.x=arguments[0],this.y=arguments[1],this.z=arguments[2])},Oe={DimensionalComparator:{configurable:!0},serialVersionUID:{configurable:!0},NULL_ORDINATE:{configurable:!0},X:{configurable:!0},Y:{configurable:!0},Z:{configurable:!0}};Y.prototype.setOrdinate=function(o,s){switch(o){case Y.X:this.x=s;break;case Y.Y:this.y=s;break;case Y.Z:this.z=s;break;default:throw new we("Invalid ordinate index: "+o)}},Y.prototype.equals2D=function(){if(arguments.length===1){var o=arguments[0];return this.x===o.x&&this.y===o.y}if(arguments.length===2){var s=arguments[0],d=arguments[1];return!!me.equalsWithTolerance(this.x,s.x,d)&&!!me.equalsWithTolerance(this.y,s.y,d)}},Y.prototype.getOrdinate=function(o){switch(o){case Y.X:return this.x;case Y.Y:return this.y;case Y.Z:return this.z}throw new we("Invalid ordinate index: "+o)},Y.prototype.equals3D=function(o){return this.x===o.x&&this.y===o.y&&(this.z===o.z||ne.isNaN(this.z))&&ne.isNaN(o.z)},Y.prototype.equals=function(o){return o instanceof Y&&this.equals2D(o)},Y.prototype.equalInZ=function(o,s){return me.equalsWithTolerance(this.z,o.z,s)},Y.prototype.compareTo=function(o){var s=o;return this.x<s.x?-1:this.x>s.x?1:this.y<s.y?-1:this.y>s.y?1:0},Y.prototype.clone=function(){},Y.prototype.copy=function(){return new Y(this)},Y.prototype.toString=function(){return"("+this.x+", "+this.y+", "+this.z+")"},Y.prototype.distance3D=function(o){var s=this.x-o.x,d=this.y-o.y,_=this.z-o.z;return Math.sqrt(s*s+d*d+_*_)},Y.prototype.distance=function(o){var s=this.x-o.x,d=this.y-o.y;return Math.sqrt(s*s+d*d)},Y.prototype.hashCode=function(){var o=17;return o=37*o+Y.hashCode(this.x),o=37*o+Y.hashCode(this.y)},Y.prototype.setCoordinate=function(o){this.x=o.x,this.y=o.y,this.z=o.z},Y.prototype.interfaces_=function(){return[he,ve,L]},Y.prototype.getClass=function(){return Y},Y.hashCode=function(){if(arguments.length===1){var o=arguments[0],s=ne.doubleToLongBits(o);return Math.trunc((s^s)>>>32)}},Oe.DimensionalComparator.get=function(){return pe},Oe.serialVersionUID.get=function(){return 6683108902428367e3},Oe.NULL_ORDINATE.get=function(){return ne.NaN},Oe.X.get=function(){return 0},Oe.Y.get=function(){return 1},Oe.Z.get=function(){return 2},Object.defineProperties(Y,Oe);var pe=function(o){if(this._dimensionsToTest=2,arguments.length!==0){if(arguments.length===1){var s=arguments[0];if(s!==2&&s!==3)throw new we("only 2 or 3 dimensions may be specified");this._dimensionsToTest=s}}};pe.prototype.compare=function(o,s){var d=o,_=s,w=pe.compare(d.x,_.x);if(w!==0)return w;var j=pe.compare(d.y,_.y);return j!==0?j:this._dimensionsToTest<=2?0:pe.compare(d.z,_.z)},pe.prototype.interfaces_=function(){return[te]},pe.prototype.getClass=function(){return pe},pe.compare=function(o,s){return o<s?-1:o>s?1:ne.isNaN(o)?ne.isNaN(s)?0:-1:ne.isNaN(s)?1:0};var ye=function(){};ye.prototype.create=function(){},ye.prototype.interfaces_=function(){return[]},ye.prototype.getClass=function(){return ye};var _e=function(){},X={INTERIOR:{configurable:!0},BOUNDARY:{configurable:!0},EXTERIOR:{configurable:!0},NONE:{configurable:!0}};_e.prototype.interfaces_=function(){return[]},_e.prototype.getClass=function(){return _e},_e.toLocationSymbol=function(o){switch(o){case _e.EXTERIOR:return"e";case _e.BOUNDARY:return"b";case _e.INTERIOR:return"i";case _e.NONE:return"-"}throw new we("Unknown location value: "+o)},X.INTERIOR.get=function(){return 0},X.BOUNDARY.get=function(){return 1},X.EXTERIOR.get=function(){return 2},X.NONE.get=function(){return-1},Object.defineProperties(_e,X);var Le=function(o,s){return o.interfaces_&&o.interfaces_().indexOf(s)>-1},de=function(){},be={LOG_10:{configurable:!0}};de.prototype.interfaces_=function(){return[]},de.prototype.getClass=function(){return de},de.log10=function(o){var s=Math.log(o);return ne.isInfinite(s)||ne.isNaN(s)?s:s/de.LOG_10},de.min=function(o,s,d,_){var w=o;return s<w&&(w=s),d<w&&(w=d),_<w&&(w=_),w},de.clamp=function(){if(typeof arguments[2]=="number"&&typeof arguments[0]=="number"&&typeof arguments[1]=="number"){var o=arguments[0],s=arguments[1],d=arguments[2];return o<s?s:o>d?d:o}if(Number.isInteger(arguments[2])&&Number.isInteger(arguments[0])&&Number.isInteger(arguments[1])){var _=arguments[0],w=arguments[1],j=arguments[2];return _<w?w:_>j?j:_}},de.wrap=function(o,s){return o<0?s- -o%s:o%s},de.max=function(){if(arguments.length===3){var o=arguments[0],s=arguments[1],d=arguments[2],_=o;return s>_&&(_=s),d>_&&(_=d),_}if(arguments.length===4){var w=arguments[0],j=arguments[1],ie=arguments[2],ke=arguments[3],tt=w;return j>tt&&(tt=j),ie>tt&&(tt=ie),ke>tt&&(tt=ke),tt}},de.average=function(o,s){return(o+s)/2},be.LOG_10.get=function(){return Math.log(10)},Object.defineProperties(de,be);var se=function(o){this.str=o};se.prototype.append=function(o){this.str+=o},se.prototype.setCharAt=function(o,s){this.str=this.str.substr(0,o)+s+this.str.substr(o+1)},se.prototype.toString=function(o){return this.str};var Ne=function(o){this.value=o};Ne.prototype.intValue=function(){return this.value},Ne.prototype.compareTo=function(o){return this.value<o?-1:this.value>o?1:0},Ne.isNaN=function(o){return Number.isNaN(o)};var ze=function(){};ze.isWhitespace=function(o){return o<=32&&o>=0||o===127},ze.toUpperCase=function(o){return o.toUpperCase()};var ue=function o(){if(this._hi=0,this._lo=0,arguments.length===0)this.init(0);else if(arguments.length===1){if(typeof arguments[0]=="number"){var s=arguments[0];this.init(s)}else if(arguments[0]instanceof o){var d=arguments[0];this.init(d)}else if(typeof arguments[0]=="string"){var _=arguments[0];o.call(this,o.parse(_))}}else if(arguments.length===2){var w=arguments[0],j=arguments[1];this.init(w,j)}},kt={PI:{configurable:!0},TWO_PI:{configurable:!0},PI_2:{configurable:!0},E:{configurable:!0},NaN:{configurable:!0},EPS:{configurable:!0},SPLIT:{configurable:!0},MAX_PRINT_DIGITS:{configurable:!0},TEN:{configurable:!0},ONE:{configurable:!0},SCI_NOT_EXPONENT_CHAR:{configurable:!0},SCI_NOT_ZERO:{configurable:!0}};ue.prototype.le=function(o){return(this._hi<o._hi||this._hi===o._hi)&&this._lo<=o._lo},ue.prototype.extractSignificantDigits=function(o,s){var d=this.abs(),_=ue.magnitude(d._hi),w=ue.TEN.pow(_);(d=d.divide(w)).gt(ue.TEN)?(d=d.divide(ue.TEN),_+=1):d.lt(ue.ONE)&&(d=d.multiply(ue.TEN),_-=1);for(var j=_+1,ie=new se,ke=ue.MAX_PRINT_DIGITS-1,tt=0;tt<=ke;tt++){o&&tt===j&&ie.append(".");var Pt=Math.trunc(d._hi);if(Pt<0)break;var tr=!1,st=0;Pt>9?(tr=!0,st="9"):st="0"+Pt,ie.append(st),d=d.subtract(ue.valueOf(Pt)).multiply(ue.TEN),tr&&d.selfAdd(ue.TEN);var Zt=!0,Jt=ue.magnitude(d._hi);if(Jt<0&&Math.abs(Jt)>=ke-tt&&(Zt=!1),!Zt)break}return s[0]=_,ie.toString()},ue.prototype.sqr=function(){return this.multiply(this)},ue.prototype.doubleValue=function(){return this._hi+this._lo},ue.prototype.subtract=function(){if(arguments[0]instanceof ue){var o=arguments[0];return this.add(o.negate())}if(typeof arguments[0]=="number"){var s=arguments[0];return this.add(-s)}},ue.prototype.equals=function(){if(arguments.length===1){var o=arguments[0];return this._hi===o._hi&&this._lo===o._lo}},ue.prototype.isZero=function(){return this._hi===0&&this._lo===0},ue.prototype.selfSubtract=function(){if(arguments[0]instanceof ue){var o=arguments[0];return this.isNaN()?this:this.selfAdd(-o._hi,-o._lo)}if(typeof arguments[0]=="number"){var s=arguments[0];return this.isNaN()?this:this.selfAdd(-s,0)}},ue.prototype.getSpecialNumberString=function(){return this.isZero()?"0.0":this.isNaN()?"NaN ":null},ue.prototype.min=function(o){return this.le(o)?this:o},ue.prototype.selfDivide=function(){if(arguments.length===1){if(arguments[0]instanceof ue){var o=arguments[0];return this.selfDivide(o._hi,o._lo)}if(typeof arguments[0]=="number"){var s=arguments[0];return this.selfDivide(s,0)}}else if(arguments.length===2){var d=arguments[0],_=arguments[1],w=null,j=null,ie=null,ke=null,tt=null,Pt=null,tr=null,st=null;return tt=this._hi/d,Pt=ue.SPLIT*tt,w=Pt-tt,st=ue.SPLIT*d,w=Pt-w,j=tt-w,ie=st-d,tr=tt*d,ie=st-ie,ke=d-ie,st=w*ie-tr+w*ke+j*ie+j*ke,Pt=(this._hi-tr-st+this._lo-tt*_)/d,st=tt+Pt,this._hi=st,this._lo=tt-st+Pt,this}},ue.prototype.dump=function(){return"DD<"+this._hi+", "+this._lo+">"},ue.prototype.divide=function(){if(arguments[0]instanceof ue){var o=arguments[0],s=null,d=null,_=null,w=null,j=null,ie=null,ke=null,tt=null;return d=(j=this._hi/o._hi)-(s=(ie=ue.SPLIT*j)-(s=ie-j)),tt=s*(_=(tt=ue.SPLIT*o._hi)-(_=tt-o._hi))-(ke=j*o._hi)+s*(w=o._hi-_)+d*_+d*w,ie=(this._hi-ke-tt+this._lo-j*o._lo)/o._hi,new ue(tt=j+ie,j-tt+ie)}if(typeof arguments[0]=="number"){var Pt=arguments[0];return ne.isNaN(Pt)?ue.createNaN():ue.copy(this).selfDivide(Pt,0)}},ue.prototype.ge=function(o){return(this._hi>o._hi||this._hi===o._hi)&&this._lo>=o._lo},ue.prototype.pow=function(o){if(o===0)return ue.valueOf(1);var s=new ue(this),d=ue.valueOf(1),_=Math.abs(o);if(_>1)for(;_>0;)_%2==1&&d.selfMultiply(s),(_/=2)>0&&(s=s.sqr());else d=s;return o<0?d.reciprocal():d},ue.prototype.ceil=function(){if(this.isNaN())return ue.NaN;var o=Math.ceil(this._hi),s=0;return o===this._hi&&(s=Math.ceil(this._lo)),new ue(o,s)},ue.prototype.compareTo=function(o){var s=o;return this._hi<s._hi?-1:this._hi>s._hi?1:this._lo<s._lo?-1:this._lo>s._lo?1:0},ue.prototype.rint=function(){return this.isNaN()?this:this.add(.5).floor()},ue.prototype.setValue=function(){if(arguments[0]instanceof ue){var o=arguments[0];return this.init(o),this}if(typeof arguments[0]=="number"){var s=arguments[0];return this.init(s),this}},ue.prototype.max=function(o){return this.ge(o)?this:o},ue.prototype.sqrt=function(){if(this.isZero())return ue.valueOf(0);if(this.isNegative())return ue.NaN;var o=1/Math.sqrt(this._hi),s=this._hi*o,d=ue.valueOf(s),_=this.subtract(d.sqr())._hi*(.5*o);return d.add(_)},ue.prototype.selfAdd=function(){if(arguments.length===1){if(arguments[0]instanceof ue){var o=arguments[0];return this.selfAdd(o._hi,o._lo)}if(typeof arguments[0]=="number"){var s=arguments[0],d=null,_=null,w=null,j=null,ie=null,ke=null;return w=this._hi+s,ie=w-this._hi,j=w-ie,j=s-ie+(this._hi-j),ke=j+this._lo,d=w+ke,_=ke+(w-d),this._hi=d+_,this._lo=_+(d-this._hi),this}}else if(arguments.length===2){var tt=arguments[0],Pt=arguments[1],tr=null,st=null,Zt=null,Jt=null,yr=null,v=null,Pn=null;Jt=this._hi+tt,st=this._lo+Pt,yr=Jt-(v=Jt-this._hi),Zt=st-(Pn=st-this._lo);var jn=(tr=Jt+(v=(yr=tt-v+(this._hi-yr))+st))+(v=(Zt=Pt-Pn+(this._lo-Zt))+(v+(Jt-tr))),Xe=v+(tr-jn);return this._hi=jn,this._lo=Xe,this}},ue.prototype.selfMultiply=function(){if(arguments.length===1){if(arguments[0]instanceof ue){var o=arguments[0];return this.selfMultiply(o._hi,o._lo)}if(typeof arguments[0]=="number"){var s=arguments[0];return this.selfMultiply(s,0)}}else if(arguments.length===2){var d=arguments[0],_=arguments[1],w=null,j=null,ie=null,ke=null,tt=null,Pt=null;w=(tt=ue.SPLIT*this._hi)-this._hi,Pt=ue.SPLIT*d,w=tt-w,j=this._hi-w,ie=Pt-d;var tr=(tt=this._hi*d)+(Pt=w*(ie=Pt-ie)-tt+w*(ke=d-ie)+j*ie+j*ke+(this._hi*_+this._lo*d)),st=Pt+(w=tt-tr);return this._hi=tr,this._lo=st,this}},ue.prototype.selfSqr=function(){return this.selfMultiply(this)},ue.prototype.floor=function(){if(this.isNaN())return ue.NaN;var o=Math.floor(this._hi),s=0;return o===this._hi&&(s=Math.floor(this._lo)),new ue(o,s)},ue.prototype.negate=function(){return this.isNaN()?this:new ue(-this._hi,-this._lo)},ue.prototype.clone=function(){},ue.prototype.multiply=function(){if(arguments[0]instanceof ue){var o=arguments[0];return o.isNaN()?ue.createNaN():ue.copy(this).selfMultiply(o)}if(typeof arguments[0]=="number"){var s=arguments[0];return ne.isNaN(s)?ue.createNaN():ue.copy(this).selfMultiply(s,0)}},ue.prototype.isNaN=function(){return ne.isNaN(this._hi)},ue.prototype.intValue=function(){return Math.trunc(this._hi)},ue.prototype.toString=function(){var o=ue.magnitude(this._hi);return o>=-3&&o<=20?this.toStandardNotation():this.toSciNotation()},ue.prototype.toStandardNotation=function(){var o=this.getSpecialNumberString();if(o!==null)return o;var s=new Array(1).fill(null),d=this.extractSignificantDigits(!0,s),_=s[0]+1,w=d;if(d.charAt(0)===".")w="0"+d;else if(_<0)w="0."+ue.stringOfChar("0",-_)+d;else if(d.indexOf(".")===-1){var j=_-d.length;w=d+ue.stringOfChar("0",j)+".0"}return this.isNegative()?"-"+w:w},ue.prototype.reciprocal=function(){var o=null,s=null,d=null,_=null,w=null,j=null,ie=null,ke=null;s=(w=1/this._hi)-(o=(j=ue.SPLIT*w)-(o=j-w)),d=(ke=ue.SPLIT*this._hi)-this._hi;var tt=w+(j=(1-(ie=w*this._hi)-(ke=o*(d=ke-d)-ie+o*(_=this._hi-d)+s*d+s*_)-w*this._lo)/this._hi);return new ue(tt,w-tt+j)},ue.prototype.toSciNotation=function(){if(this.isZero())return ue.SCI_NOT_ZERO;var o=this.getSpecialNumberString();if(o!==null)return o;var s=new Array(1).fill(null),d=this.extractSignificantDigits(!1,s),_=ue.SCI_NOT_EXPONENT_CHAR+s[0];if(d.charAt(0)==="0")throw new Error("Found leading zero: "+d);var w="";d.length>1&&(w=d.substring(1));var j=d.charAt(0)+"."+w;return this.isNegative()?"-"+j+_:j+_},ue.prototype.abs=function(){return this.isNaN()?ue.NaN:this.isNegative()?this.negate():new ue(this)},ue.prototype.isPositive=function(){return(this._hi>0||this._hi===0)&&this._lo>0},ue.prototype.lt=function(o){return(this._hi<o._hi||this._hi===o._hi)&&this._lo<o._lo},ue.prototype.add=function(){if(arguments[0]instanceof ue){var o=arguments[0];return ue.copy(this).selfAdd(o)}if(typeof arguments[0]=="number"){var s=arguments[0];return ue.copy(this).selfAdd(s)}},ue.prototype.init=function(){if(arguments.length===1){if(typeof arguments[0]=="number"){var o=arguments[0];this._hi=o,this._lo=0}else if(arguments[0]instanceof ue){var s=arguments[0];this._hi=s._hi,this._lo=s._lo}}else if(arguments.length===2){var d=arguments[0],_=arguments[1];this._hi=d,this._lo=_}},ue.prototype.gt=function(o){return(this._hi>o._hi||this._hi===o._hi)&&this._lo>o._lo},ue.prototype.isNegative=function(){return(this._hi<0||this._hi===0)&&this._lo<0},ue.prototype.trunc=function(){return this.isNaN()?ue.NaN:this.isPositive()?this.floor():this.ceil()},ue.prototype.signum=function(){return this._hi>0?1:this._hi<0?-1:this._lo>0?1:this._lo<0?-1:0},ue.prototype.interfaces_=function(){return[L,he,ve]},ue.prototype.getClass=function(){return ue},ue.sqr=function(o){return ue.valueOf(o).selfMultiply(o)},ue.valueOf=function(){if(typeof arguments[0]=="string"){var o=arguments[0];return ue.parse(o)}if(typeof arguments[0]=="number"){var s=arguments[0];return new ue(s)}},ue.sqrt=function(o){return ue.valueOf(o).sqrt()},ue.parse=function(o){for(var s=0,d=o.length;ze.isWhitespace(o.charAt(s));)s++;var _=!1;if(s<d){var w=o.charAt(s);w!=="-"&&w!=="+"||(s++,w==="-"&&(_=!0))}for(var j=new ue,ie=0,ke=0,tt=0;!(s>=d);){var Pt=o.charAt(s);if(s++,ze.isDigit(Pt)){var tr=Pt-"0";j.selfMultiply(ue.TEN),j.selfAdd(tr),ie++}else{if(Pt!=="."){if(Pt==="e"||Pt==="E"){var st=o.substring(s);try{tt=Ne.parseInt(st)}catch(Pn){throw Pn instanceof Error?new Error("Invalid exponent "+st+" in string "+o):Pn}break}throw new Error("Unexpected character '"+Pt+"' at position "+s+" in string "+o)}ke=ie}}var Zt=j,Jt=ie-ke-tt;if(Jt===0)Zt=j;else if(Jt>0){var yr=ue.TEN.pow(Jt);Zt=j.divide(yr)}else if(Jt<0){var v=ue.TEN.pow(-Jt);Zt=j.multiply(v)}return _?Zt.negate():Zt},ue.createNaN=function(){return new ue(ne.NaN,ne.NaN)},ue.copy=function(o){return new ue(o)},ue.magnitude=function(o){var s=Math.abs(o),d=Math.log(s)/Math.log(10),_=Math.trunc(Math.floor(d));return 10*Math.pow(10,_)<=s&&(_+=1),_},ue.stringOfChar=function(o,s){for(var d=new se,_=0;_<s;_++)d.append(o);return d.toString()},kt.PI.get=function(){return new ue(3.141592653589793,12246467991473532e-32)},kt.TWO_PI.get=function(){return new ue(6.283185307179586,24492935982947064e-32)},kt.PI_2.get=function(){return new ue(1.5707963267948966,6123233995736766e-32)},kt.E.get=function(){return new ue(2.718281828459045,14456468917292502e-32)},kt.NaN.get=function(){return new ue(ne.NaN,ne.NaN)},kt.EPS.get=function(){return 123259516440783e-46},kt.SPLIT.get=function(){return 134217729},kt.MAX_PRINT_DIGITS.get=function(){return 32},kt.TEN.get=function(){return ue.valueOf(10)},kt.ONE.get=function(){return ue.valueOf(1)},kt.SCI_NOT_EXPONENT_CHAR.get=function(){return"E"},kt.SCI_NOT_ZERO.get=function(){return"0.0E0"},Object.defineProperties(ue,kt);var Rt=function(){},cr={DP_SAFE_EPSILON:{configurable:!0}};Rt.prototype.interfaces_=function(){return[]},Rt.prototype.getClass=function(){return Rt},Rt.orientationIndex=function(o,s,d){var _=Rt.orientationIndexFilter(o,s,d);if(_<=1)return _;var w=ue.valueOf(s.x).selfAdd(-o.x),j=ue.valueOf(s.y).selfAdd(-o.y),ie=ue.valueOf(d.x).selfAdd(-s.x),ke=ue.valueOf(d.y).selfAdd(-s.y);return w.selfMultiply(ke).selfSubtract(j.selfMultiply(ie)).signum()},Rt.signOfDet2x2=function(o,s,d,_){return o.multiply(_).selfSubtract(s.multiply(d)).signum()},Rt.intersection=function(o,s,d,_){var w=ue.valueOf(_.y).selfSubtract(d.y).selfMultiply(ue.valueOf(s.x).selfSubtract(o.x)),j=ue.valueOf(_.x).selfSubtract(d.x).selfMultiply(ue.valueOf(s.y).selfSubtract(o.y)),ie=w.subtract(j),ke=ue.valueOf(_.x).selfSubtract(d.x).selfMultiply(ue.valueOf(o.y).selfSubtract(d.y)),tt=ue.valueOf(_.y).selfSubtract(d.y).selfMultiply(ue.valueOf(o.x).selfSubtract(d.x)),Pt=ke.subtract(tt).selfDivide(ie).doubleValue(),tr=ue.valueOf(o.x).selfAdd(ue.valueOf(s.x).selfSubtract(o.x).selfMultiply(Pt)).doubleValue(),st=ue.valueOf(s.x).selfSubtract(o.x).selfMultiply(ue.valueOf(o.y).selfSubtract(d.y)),Zt=ue.valueOf(s.y).selfSubtract(o.y).selfMultiply(ue.valueOf(o.x).selfSubtract(d.x)),Jt=st.subtract(Zt).selfDivide(ie).doubleValue(),yr=ue.valueOf(d.y).selfAdd(ue.valueOf(_.y).selfSubtract(d.y).selfMultiply(Jt)).doubleValue();return new Y(tr,yr)},Rt.orientationIndexFilter=function(o,s,d){var _=null,w=(o.x-d.x)*(s.y-d.y),j=(o.y-d.y)*(s.x-d.x),ie=w-j;if(w>0){if(j<=0)return Rt.signum(ie);_=w+j}else{if(!(w<0)||j>=0)return Rt.signum(ie);_=-w-j}var ke=Rt.DP_SAFE_EPSILON*_;return ie>=ke||-ie>=ke?Rt.signum(ie):2},Rt.signum=function(o){return o>0?1:o<0?-1:0},cr.DP_SAFE_EPSILON.get=function(){return 1e-15},Object.defineProperties(Rt,cr);var Ut=function(){},$r={X:{configurable:!0},Y:{configurable:!0},Z:{configurable:!0},M:{configurable:!0}};$r.X.get=function(){return 0},$r.Y.get=function(){return 1},$r.Z.get=function(){return 2},$r.M.get=function(){return 3},Ut.prototype.setOrdinate=function(o,s,d){},Ut.prototype.size=function(){},Ut.prototype.getOrdinate=function(o,s){},Ut.prototype.getCoordinate=function(){},Ut.prototype.getCoordinateCopy=function(o){},Ut.prototype.getDimension=function(){},Ut.prototype.getX=function(o){},Ut.prototype.clone=function(){},Ut.prototype.expandEnvelope=function(o){},Ut.prototype.copy=function(){},Ut.prototype.getY=function(o){},Ut.prototype.toCoordinateArray=function(){},Ut.prototype.interfaces_=function(){return[ve]},Ut.prototype.getClass=function(){return Ut},Object.defineProperties(Ut,$r);var ln=function(){},Cr=function(o){function s(){o.call(this,"Projective point not representable on the Cartesian plane.")}return o&&(s.__proto__=o),s.prototype=Object.create(o&&o.prototype),s.prototype.constructor=s,s.prototype.interfaces_=function(){return[]},s.prototype.getClass=function(){return s},s}(ln),Qr=function(){};Qr.arraycopy=function(o,s,d,_,w){for(var j=0,ie=s;ie<s+w;ie++)d[_+j]=o[ie],j++},Qr.getProperty=function(o){return{"line.separator":`
`}[o]};var Jr=function o(){if(this.x=null,this.y=null,this.w=null,arguments.length===0)this.x=0,this.y=0,this.w=1;else if(arguments.length===1){var s=arguments[0];this.x=s.x,this.y=s.y,this.w=1}else if(arguments.length===2){if(typeof arguments[0]=="number"&&typeof arguments[1]=="number"){var d=arguments[0],_=arguments[1];this.x=d,this.y=_,this.w=1}else if(arguments[0]instanceof o&&arguments[1]instanceof o){var w=arguments[0],j=arguments[1];this.x=w.y*j.w-j.y*w.w,this.y=j.x*w.w-w.x*j.w,this.w=w.x*j.y-j.x*w.y}else if(arguments[0]instanceof Y&&arguments[1]instanceof Y){var ie=arguments[0],ke=arguments[1];this.x=ie.y-ke.y,this.y=ke.x-ie.x,this.w=ie.x*ke.y-ke.x*ie.y}}else if(arguments.length===3){var tt=arguments[0],Pt=arguments[1],tr=arguments[2];this.x=tt,this.y=Pt,this.w=tr}else if(arguments.length===4){var st=arguments[0],Zt=arguments[1],Jt=arguments[2],yr=arguments[3],v=st.y-Zt.y,Pn=Zt.x-st.x,jn=st.x*Zt.y-Zt.x*st.y,Xe=Jt.y-yr.y,Ia=yr.x-Jt.x,ao=Jt.x*yr.y-yr.x*Jt.y;this.x=Pn*ao-Ia*jn,this.y=Xe*jn-v*ao,this.w=v*Ia-Xe*Pn}};Jr.prototype.getY=function(){var o=this.y/this.w;if(ne.isNaN(o)||ne.isInfinite(o))throw new Cr;return o},Jr.prototype.getX=function(){var o=this.x/this.w;if(ne.isNaN(o)||ne.isInfinite(o))throw new Cr;return o},Jr.prototype.getCoordinate=function(){var o=new Y;return o.x=this.getX(),o.y=this.getY(),o},Jr.prototype.interfaces_=function(){return[]},Jr.prototype.getClass=function(){return Jr},Jr.intersection=function(o,s,d,_){var w=o.y-s.y,j=s.x-o.x,ie=o.x*s.y-s.x*o.y,ke=d.y-_.y,tt=_.x-d.x,Pt=d.x*_.y-_.x*d.y,tr=w*tt-ke*j,st=(j*Pt-tt*ie)/tr,Zt=(ke*ie-w*Pt)/tr;if(ne.isNaN(st)||ne.isInfinite(st)||ne.isNaN(Zt)||ne.isInfinite(Zt))throw new Cr;return new Y(st,Zt)};var xr=function o(){if(this._minx=null,this._maxx=null,this._miny=null,this._maxy=null,arguments.length===0)this.init();else if(arguments.length===1){if(arguments[0]instanceof Y){var s=arguments[0];this.init(s.x,s.x,s.y,s.y)}else if(arguments[0]instanceof o){var d=arguments[0];this.init(d)}}else if(arguments.length===2){var _=arguments[0],w=arguments[1];this.init(_.x,w.x,_.y,w.y)}else if(arguments.length===4){var j=arguments[0],ie=arguments[1],ke=arguments[2],tt=arguments[3];this.init(j,ie,ke,tt)}},Gn={serialVersionUID:{configurable:!0}};xr.prototype.getArea=function(){return this.getWidth()*this.getHeight()},xr.prototype.equals=function(o){if(!(o instanceof xr))return!1;var s=o;return this.isNull()?s.isNull():this._maxx===s.getMaxX()&&this._maxy===s.getMaxY()&&this._minx===s.getMinX()&&this._miny===s.getMinY()},xr.prototype.intersection=function(o){if(this.isNull()||o.isNull()||!this.intersects(o))return new xr;var s=this._minx>o._minx?this._minx:o._minx,d=this._miny>o._miny?this._miny:o._miny,_=this._maxx<o._maxx?this._maxx:o._maxx,w=this._maxy<o._maxy?this._maxy:o._maxy;return new xr(s,_,d,w)},xr.prototype.isNull=function(){return this._maxx<this._minx},xr.prototype.getMaxX=function(){return this._maxx},xr.prototype.covers=function(){if(arguments.length===1){if(arguments[0]instanceof Y){var o=arguments[0];return this.covers(o.x,o.y)}if(arguments[0]instanceof xr){var s=arguments[0];return!this.isNull()&&!s.isNull()&&s.getMinX()>=this._minx&&s.getMaxX()<=this._maxx&&s.getMinY()>=this._miny&&s.getMaxY()<=this._maxy}}else if(arguments.length===2){var d=arguments[0],_=arguments[1];return!this.isNull()&&d>=this._minx&&d<=this._maxx&&_>=this._miny&&_<=this._maxy}},xr.prototype.intersects=function(){if(arguments.length===1){if(arguments[0]instanceof xr){var o=arguments[0];return!this.isNull()&&!o.isNull()&&!(o._minx>this._maxx||o._maxx<this._minx||o._miny>this._maxy||o._maxy<this._miny)}if(arguments[0]instanceof Y){var s=arguments[0];return this.intersects(s.x,s.y)}}else if(arguments.length===2){var d=arguments[0],_=arguments[1];return!this.isNull()&&!(d>this._maxx||d<this._minx||_>this._maxy||_<this._miny)}},xr.prototype.getMinY=function(){return this._miny},xr.prototype.getMinX=function(){return this._minx},xr.prototype.expandToInclude=function(){if(arguments.length===1){if(arguments[0]instanceof Y){var o=arguments[0];this.expandToInclude(o.x,o.y)}else if(arguments[0]instanceof xr){var s=arguments[0];if(s.isNull())return null;this.isNull()?(this._minx=s.getMinX(),this._maxx=s.getMaxX(),this._miny=s.getMinY(),this._maxy=s.getMaxY()):(s._minx<this._minx&&(this._minx=s._minx),s._maxx>this._maxx&&(this._maxx=s._maxx),s._miny<this._miny&&(this._miny=s._miny),s._maxy>this._maxy&&(this._maxy=s._maxy))}}else if(arguments.length===2){var d=arguments[0],_=arguments[1];this.isNull()?(this._minx=d,this._maxx=d,this._miny=_,this._maxy=_):(d<this._minx&&(this._minx=d),d>this._maxx&&(this._maxx=d),_<this._miny&&(this._miny=_),_>this._maxy&&(this._maxy=_))}},xr.prototype.minExtent=function(){if(this.isNull())return 0;var o=this.getWidth(),s=this.getHeight();return o<s?o:s},xr.prototype.getWidth=function(){return this.isNull()?0:this._maxx-this._minx},xr.prototype.compareTo=function(o){var s=o;return this.isNull()?s.isNull()?0:-1:s.isNull()?1:this._minx<s._minx?-1:this._minx>s._minx?1:this._miny<s._miny?-1:this._miny>s._miny?1:this._maxx<s._maxx?-1:this._maxx>s._maxx?1:this._maxy<s._maxy?-1:this._maxy>s._maxy?1:0},xr.prototype.translate=function(o,s){if(this.isNull())return null;this.init(this.getMinX()+o,this.getMaxX()+o,this.getMinY()+s,this.getMaxY()+s)},xr.prototype.toString=function(){return"Env["+this._minx+" : "+this._maxx+", "+this._miny+" : "+this._maxy+"]"},xr.prototype.setToNull=function(){this._minx=0,this._maxx=-1,this._miny=0,this._maxy=-1},xr.prototype.getHeight=function(){return this.isNull()?0:this._maxy-this._miny},xr.prototype.maxExtent=function(){if(this.isNull())return 0;var o=this.getWidth(),s=this.getHeight();return o>s?o:s},xr.prototype.expandBy=function(){if(arguments.length===1){var o=arguments[0];this.expandBy(o,o)}else if(arguments.length===2){var s=arguments[0],d=arguments[1];if(this.isNull())return null;this._minx-=s,this._maxx+=s,this._miny-=d,this._maxy+=d,(this._minx>this._maxx||this._miny>this._maxy)&&this.setToNull()}},xr.prototype.contains=function(){if(arguments.length===1){if(arguments[0]instanceof xr){var o=arguments[0];return this.covers(o)}if(arguments[0]instanceof Y){var s=arguments[0];return this.covers(s)}}else if(arguments.length===2){var d=arguments[0],_=arguments[1];return this.covers(d,_)}},xr.prototype.centre=function(){return this.isNull()?null:new Y((this.getMinX()+this.getMaxX())/2,(this.getMinY()+this.getMaxY())/2)},xr.prototype.init=function(){if(arguments.length===0)this.setToNull();else if(arguments.length===1){if(arguments[0]instanceof Y){var o=arguments[0];this.init(o.x,o.x,o.y,o.y)}else if(arguments[0]instanceof xr){var s=arguments[0];this._minx=s._minx,this._maxx=s._maxx,this._miny=s._miny,this._maxy=s._maxy}}else if(arguments.length===2){var d=arguments[0],_=arguments[1];this.init(d.x,_.x,d.y,_.y)}else if(arguments.length===4){var w=arguments[0],j=arguments[1],ie=arguments[2],ke=arguments[3];w<j?(this._minx=w,this._maxx=j):(this._minx=j,this._maxx=w),ie<ke?(this._miny=ie,this._maxy=ke):(this._miny=ke,this._maxy=ie)}},xr.prototype.getMaxY=function(){return this._maxy},xr.prototype.distance=function(o){if(this.intersects(o))return 0;var s=0;this._maxx<o._minx?s=o._minx-this._maxx:this._minx>o._maxx&&(s=this._minx-o._maxx);var d=0;return this._maxy<o._miny?d=o._miny-this._maxy:this._miny>o._maxy&&(d=this._miny-o._maxy),s===0?d:d===0?s:Math.sqrt(s*s+d*d)},xr.prototype.hashCode=function(){var o=17;return o=37*o+Y.hashCode(this._minx),o=37*o+Y.hashCode(this._maxx),o=37*o+Y.hashCode(this._miny),o=37*o+Y.hashCode(this._maxy)},xr.prototype.interfaces_=function(){return[he,L]},xr.prototype.getClass=function(){return xr},xr.intersects=function(){if(arguments.length===3){var o=arguments[0],s=arguments[1],d=arguments[2];return d.x>=(o.x<s.x?o.x:s.x)&&d.x<=(o.x>s.x?o.x:s.x)&&d.y>=(o.y<s.y?o.y:s.y)&&d.y<=(o.y>s.y?o.y:s.y)}if(arguments.length===4){var _=arguments[0],w=arguments[1],j=arguments[2],ie=arguments[3],ke=Math.min(j.x,ie.x),tt=Math.max(j.x,ie.x),Pt=Math.min(_.x,w.x),tr=Math.max(_.x,w.x);return!(Pt>tt)&&!(tr<ke)&&(ke=Math.min(j.y,ie.y),tt=Math.max(j.y,ie.y),Pt=Math.min(_.y,w.y),tr=Math.max(_.y,w.y),!(Pt>tt)&&!(tr<ke))}},Gn.serialVersionUID.get=function(){return 5873921885273102e3},Object.defineProperties(xr,Gn);var ti={typeStr:/^\s*(\w+)\s*\(\s*(.*)\s*\)\s*$/,emptyTypeStr:/^\s*(\w+)\s*EMPTY\s*$/,spaces:/\s+/,parenComma:/\)\s*,\s*\(/,doubleParenComma:/\)\s*\)\s*,\s*\(\s*\(/,trimParens:/^\s*\(?(.*?)\)?\s*$/},Vn=function(o){this.geometryFactory=o||new Ai};Vn.prototype.read=function(o){var s,d,_;o=o.replace(/[\n\r]/g," ");var w=ti.typeStr.exec(o);if(o.search("EMPTY")!==-1&&((w=ti.emptyTypeStr.exec(o))[2]=void 0),w&&(d=w[1].toLowerCase(),_=w[2],sn[d]&&(s=sn[d].apply(this,[_]))),s===void 0)throw new Error("Could not parse WKT "+o);return s},Vn.prototype.write=function(o){return this.extractGeometry(o)},Vn.prototype.extractGeometry=function(o){var s=o.getGeometryType().toLowerCase();if(!Xr[s])return null;var d=s.toUpperCase();return o.isEmpty()?d+" EMPTY":d+"("+Xr[s].apply(this,[o])+")"};var Xr={coordinate:function(o){return o.x+" "+o.y},point:function(o){return Xr.coordinate.call(this,o._coordinates._coordinates[0])},multipoint:function(o){for(var s=[],d=0,_=o._geometries.length;d<_;++d)s.push("("+Xr.point.apply(this,[o._geometries[d]])+")");return s.join(",")},linestring:function(o){for(var s=[],d=0,_=o._points._coordinates.length;d<_;++d)s.push(Xr.coordinate.apply(this,[o._points._coordinates[d]]));return s.join(",")},linearring:function(o){for(var s=[],d=0,_=o._points._coordinates.length;d<_;++d)s.push(Xr.coordinate.apply(this,[o._points._coordinates[d]]));return s.join(",")},multilinestring:function(o){for(var s=[],d=0,_=o._geometries.length;d<_;++d)s.push("("+Xr.linestring.apply(this,[o._geometries[d]])+")");return s.join(",")},polygon:function(o){var s=[];s.push("("+Xr.linestring.apply(this,[o._shell])+")");for(var d=0,_=o._holes.length;d<_;++d)s.push("("+Xr.linestring.apply(this,[o._holes[d]])+")");return s.join(",")},multipolygon:function(o){for(var s=[],d=0,_=o._geometries.length;d<_;++d)s.push("("+Xr.polygon.apply(this,[o._geometries[d]])+")");return s.join(",")},geometrycollection:function(o){for(var s=[],d=0,_=o._geometries.length;d<_;++d)s.push(this.extractGeometry(o._geometries[d]));return s.join(",")}},sn={point:function(o){if(o===void 0)return this.geometryFactory.createPoint();var s=o.trim().split(ti.spaces);return this.geometryFactory.createPoint(new Y(Number.parseFloat(s[0]),Number.parseFloat(s[1])))},multipoint:function(o){if(o===void 0)return this.geometryFactory.createMultiPoint();for(var s,d=o.trim().split(","),_=[],w=0,j=d.length;w<j;++w)s=d[w].replace(ti.trimParens,"$1"),_.push(sn.point.apply(this,[s]));return this.geometryFactory.createMultiPoint(_)},linestring:function(o){if(o===void 0)return this.geometryFactory.createLineString();for(var s,d=o.trim().split(","),_=[],w=0,j=d.length;w<j;++w)s=d[w].trim().split(ti.spaces),_.push(new Y(Number.parseFloat(s[0]),Number.parseFloat(s[1])));return this.geometryFactory.createLineString(_)},linearring:function(o){if(o===void 0)return this.geometryFactory.createLinearRing();for(var s,d=o.trim().split(","),_=[],w=0,j=d.length;w<j;++w)s=d[w].trim().split(ti.spaces),_.push(new Y(Number.parseFloat(s[0]),Number.parseFloat(s[1])));return this.geometryFactory.createLinearRing(_)},multilinestring:function(o){if(o===void 0)return this.geometryFactory.createMultiLineString();for(var s,d=o.trim().split(ti.parenComma),_=[],w=0,j=d.length;w<j;++w)s=d[w].replace(ti.trimParens,"$1"),_.push(sn.linestring.apply(this,[s]));return this.geometryFactory.createMultiLineString(_)},polygon:function(o){if(o===void 0)return this.geometryFactory.createPolygon();for(var s,d,_,w,j=o.trim().split(ti.parenComma),ie=[],ke=0,tt=j.length;ke<tt;++ke)s=j[ke].replace(ti.trimParens,"$1"),d=sn.linestring.apply(this,[s]),_=this.geometryFactory.createLinearRing(d._points),ke===0?w=_:ie.push(_);return this.geometryFactory.createPolygon(w,ie)},multipolygon:function(o){if(o===void 0)return this.geometryFactory.createMultiPolygon();for(var s,d=o.trim().split(ti.doubleParenComma),_=[],w=0,j=d.length;w<j;++w)s=d[w].replace(ti.trimParens,"$1"),_.push(sn.polygon.apply(this,[s]));return this.geometryFactory.createMultiPolygon(_)},geometrycollection:function(o){if(o===void 0)return this.geometryFactory.createGeometryCollection();for(var s=(o=o.replace(/,\s*([A-Za-z])/g,"|$1")).trim().split("|"),d=[],_=0,w=s.length;_<w;++_)d.push(this.read(s[_]));return this.geometryFactory.createGeometryCollection(d)}},yn=function(o){this.parser=new Vn(o)};yn.prototype.write=function(o){return this.parser.write(o)},yn.toLineString=function(o,s){if(arguments.length!==2)throw new Error("Not implemented");return"LINESTRING ( "+o.x+" "+o.y+", "+s.x+" "+s.y+" )"};var ki=function(o){function s(d){o.call(this,d),this.name="RuntimeException",this.message=d,this.stack=new o().stack}return o&&(s.__proto__=o),s.prototype=Object.create(o&&o.prototype),s.prototype.constructor=s,s}(Error),ri=function(o){function s(){if(o.call(this),arguments.length===0)o.call(this);else if(arguments.length===1){var d=arguments[0];o.call(this,d)}}return o&&(s.__proto__=o),s.prototype=Object.create(o&&o.prototype),s.prototype.constructor=s,s.prototype.interfaces_=function(){return[]},s.prototype.getClass=function(){return s},s}(ki),Lt=function(){};Lt.prototype.interfaces_=function(){return[]},Lt.prototype.getClass=function(){return Lt},Lt.shouldNeverReachHere=function(){if(arguments.length===0)Lt.shouldNeverReachHere(null);else if(arguments.length===1){var o=arguments[0];throw new ri("Should never reach here"+(o!==null?": "+o:""))}},Lt.isTrue=function(){var o,s;if(arguments.length===1)o=arguments[0],Lt.isTrue(o,null);else if(arguments.length===2&&(o=arguments[0],s=arguments[1],!o))throw s===null?new ri:new ri(s)},Lt.equals=function(){var o,s,d;if(arguments.length===2)o=arguments[0],s=arguments[1],Lt.equals(o,s,null);else if(arguments.length===3&&(o=arguments[0],s=arguments[1],d=arguments[2],!s.equals(o)))throw new ri("Expected "+o+" but encountered "+s+(d!==null?": "+d:""))};var J=function(){this._result=null,this._inputLines=Array(2).fill().map(function(){return Array(2)}),this._intPt=new Array(2).fill(null),this._intLineIndex=null,this._isProper=null,this._pa=null,this._pb=null,this._precisionModel=null,this._intPt[0]=new Y,this._intPt[1]=new Y,this._pa=this._intPt[0],this._pb=this._intPt[1],this._result=0},Ue={DONT_INTERSECT:{configurable:!0},DO_INTERSECT:{configurable:!0},COLLINEAR:{configurable:!0},NO_INTERSECTION:{configurable:!0},POINT_INTERSECTION:{configurable:!0},COLLINEAR_INTERSECTION:{configurable:!0}};J.prototype.getIndexAlongSegment=function(o,s){return this.computeIntLineIndex(),this._intLineIndex[o][s]},J.prototype.getTopologySummary=function(){var o=new se;return this.isEndPoint()&&o.append(" endpoint"),this._isProper&&o.append(" proper"),this.isCollinear()&&o.append(" collinear"),o.toString()},J.prototype.computeIntersection=function(o,s,d,_){this._inputLines[0][0]=o,this._inputLines[0][1]=s,this._inputLines[1][0]=d,this._inputLines[1][1]=_,this._result=this.computeIntersect(o,s,d,_)},J.prototype.getIntersectionNum=function(){return this._result},J.prototype.computeIntLineIndex=function(){if(arguments.length===0)this._intLineIndex===null&&(this._intLineIndex=Array(2).fill().map(function(){return Array(2)}),this.computeIntLineIndex(0),this.computeIntLineIndex(1));else if(arguments.length===1){var o=arguments[0];this.getEdgeDistance(o,0)>this.getEdgeDistance(o,1)?(this._intLineIndex[o][0]=0,this._intLineIndex[o][1]=1):(this._intLineIndex[o][0]=1,this._intLineIndex[o][1]=0)}},J.prototype.isProper=function(){return this.hasIntersection()&&this._isProper},J.prototype.setPrecisionModel=function(o){this._precisionModel=o},J.prototype.isInteriorIntersection=function(){if(arguments.length===0)return!!this.isInteriorIntersection(0)||!!this.isInteriorIntersection(1);if(arguments.length===1){for(var o=arguments[0],s=0;s<this._result;s++)if(!this._intPt[s].equals2D(this._inputLines[o][0])&&!this._intPt[s].equals2D(this._inputLines[o][1]))return!0;return!1}},J.prototype.getIntersection=function(o){return this._intPt[o]},J.prototype.isEndPoint=function(){return this.hasIntersection()&&!this._isProper},J.prototype.hasIntersection=function(){return this._result!==J.NO_INTERSECTION},J.prototype.getEdgeDistance=function(o,s){return J.computeEdgeDistance(this._intPt[s],this._inputLines[o][0],this._inputLines[o][1])},J.prototype.isCollinear=function(){return this._result===J.COLLINEAR_INTERSECTION},J.prototype.toString=function(){return yn.toLineString(this._inputLines[0][0],this._inputLines[0][1])+" - "+yn.toLineString(this._inputLines[1][0],this._inputLines[1][1])+this.getTopologySummary()},J.prototype.getEndpoint=function(o,s){return this._inputLines[o][s]},J.prototype.isIntersection=function(o){for(var s=0;s<this._result;s++)if(this._intPt[s].equals2D(o))return!0;return!1},J.prototype.getIntersectionAlongSegment=function(o,s){return this.computeIntLineIndex(),this._intPt[this._intLineIndex[o][s]]},J.prototype.interfaces_=function(){return[]},J.prototype.getClass=function(){return J},J.computeEdgeDistance=function(o,s,d){var _=Math.abs(d.x-s.x),w=Math.abs(d.y-s.y),j=-1;if(o.equals(s))j=0;else if(o.equals(d))j=_>w?_:w;else{var ie=Math.abs(o.x-s.x),ke=Math.abs(o.y-s.y);(j=_>w?ie:ke)!==0||o.equals(s)||(j=Math.max(ie,ke))}return Lt.isTrue(!(j===0&&!o.equals(s)),"Bad distance calculation"),j},J.nonRobustComputeEdgeDistance=function(o,s,d){var _=o.x-s.x,w=o.y-s.y,j=Math.sqrt(_*_+w*w);return Lt.isTrue(!(j===0&&!o.equals(s)),"Invalid distance calculation"),j},Ue.DONT_INTERSECT.get=function(){return 0},Ue.DO_INTERSECT.get=function(){return 1},Ue.COLLINEAR.get=function(){return 2},Ue.NO_INTERSECTION.get=function(){return 0},Ue.POINT_INTERSECTION.get=function(){return 1},Ue.COLLINEAR_INTERSECTION.get=function(){return 2},Object.defineProperties(J,Ue);var $e=function(o){function s(){o.apply(this,arguments)}return o&&(s.__proto__=o),s.prototype=Object.create(o&&o.prototype),s.prototype.constructor=s,s.prototype.isInSegmentEnvelopes=function(d){var _=new xr(this._inputLines[0][0],this._inputLines[0][1]),w=new xr(this._inputLines[1][0],this._inputLines[1][1]);return _.contains(d)&&w.contains(d)},s.prototype.computeIntersection=function(){if(arguments.length!==3)return o.prototype.computeIntersection.apply(this,arguments);var d=arguments[0],_=arguments[1],w=arguments[2];if(this._isProper=!1,xr.intersects(_,w,d)&&wt.orientationIndex(_,w,d)===0&&wt.orientationIndex(w,_,d)===0)return this._isProper=!0,(d.equals(_)||d.equals(w))&&(this._isProper=!1),this._result=o.POINT_INTERSECTION,null;this._result=o.NO_INTERSECTION},s.prototype.normalizeToMinimum=function(d,_,w,j,ie){ie.x=this.smallestInAbsValue(d.x,_.x,w.x,j.x),ie.y=this.smallestInAbsValue(d.y,_.y,w.y,j.y),d.x-=ie.x,d.y-=ie.y,_.x-=ie.x,_.y-=ie.y,w.x-=ie.x,w.y-=ie.y,j.x-=ie.x,j.y-=ie.y},s.prototype.safeHCoordinateIntersection=function(d,_,w,j){var ie=null;try{ie=Jr.intersection(d,_,w,j)}catch(ke){if(!(ke instanceof Cr))throw ke;ie=s.nearestEndpoint(d,_,w,j)}return ie},s.prototype.intersection=function(d,_,w,j){var ie=this.intersectionWithNormalization(d,_,w,j);return this.isInSegmentEnvelopes(ie)||(ie=new Y(s.nearestEndpoint(d,_,w,j))),this._precisionModel!==null&&this._precisionModel.makePrecise(ie),ie},s.prototype.smallestInAbsValue=function(d,_,w,j){var ie=d,ke=Math.abs(ie);return Math.abs(_)<ke&&(ie=_,ke=Math.abs(_)),Math.abs(w)<ke&&(ie=w,ke=Math.abs(w)),Math.abs(j)<ke&&(ie=j),ie},s.prototype.checkDD=function(d,_,w,j,ie){var ke=Rt.intersection(d,_,w,j),tt=this.isInSegmentEnvelopes(ke);Qr.out.println("DD in env = "+tt+"  --------------------- "+ke),ie.distance(ke)>1e-4&&Qr.out.println("Distance = "+ie.distance(ke))},s.prototype.intersectionWithNormalization=function(d,_,w,j){var ie=new Y(d),ke=new Y(_),tt=new Y(w),Pt=new Y(j),tr=new Y;this.normalizeToEnvCentre(ie,ke,tt,Pt,tr);var st=this.safeHCoordinateIntersection(ie,ke,tt,Pt);return st.x+=tr.x,st.y+=tr.y,st},s.prototype.computeCollinearIntersection=function(d,_,w,j){var ie=xr.intersects(d,_,w),ke=xr.intersects(d,_,j),tt=xr.intersects(w,j,d),Pt=xr.intersects(w,j,_);return ie&&ke?(this._intPt[0]=w,this._intPt[1]=j,o.COLLINEAR_INTERSECTION):tt&&Pt?(this._intPt[0]=d,this._intPt[1]=_,o.COLLINEAR_INTERSECTION):ie&&tt?(this._intPt[0]=w,this._intPt[1]=d,!w.equals(d)||ke||Pt?o.COLLINEAR_INTERSECTION:o.POINT_INTERSECTION):ie&&Pt?(this._intPt[0]=w,this._intPt[1]=_,!w.equals(_)||ke||tt?o.COLLINEAR_INTERSECTION:o.POINT_INTERSECTION):ke&&tt?(this._intPt[0]=j,this._intPt[1]=d,!j.equals(d)||ie||Pt?o.COLLINEAR_INTERSECTION:o.POINT_INTERSECTION):ke&&Pt?(this._intPt[0]=j,this._intPt[1]=_,!j.equals(_)||ie||tt?o.COLLINEAR_INTERSECTION:o.POINT_INTERSECTION):o.NO_INTERSECTION},s.prototype.normalizeToEnvCentre=function(d,_,w,j,ie){var ke=d.x<_.x?d.x:_.x,tt=d.y<_.y?d.y:_.y,Pt=d.x>_.x?d.x:_.x,tr=d.y>_.y?d.y:_.y,st=w.x<j.x?w.x:j.x,Zt=w.y<j.y?w.y:j.y,Jt=w.x>j.x?w.x:j.x,yr=w.y>j.y?w.y:j.y,v=((ke>st?ke:st)+(Pt<Jt?Pt:Jt))/2,Pn=((tt>Zt?tt:Zt)+(tr<yr?tr:yr))/2;ie.x=v,ie.y=Pn,d.x-=ie.x,d.y-=ie.y,_.x-=ie.x,_.y-=ie.y,w.x-=ie.x,w.y-=ie.y,j.x-=ie.x,j.y-=ie.y},s.prototype.computeIntersect=function(d,_,w,j){if(this._isProper=!1,!xr.intersects(d,_,w,j))return o.NO_INTERSECTION;var ie=wt.orientationIndex(d,_,w),ke=wt.orientationIndex(d,_,j);if(ie>0&&ke>0||ie<0&&ke<0)return o.NO_INTERSECTION;var tt=wt.orientationIndex(w,j,d),Pt=wt.orientationIndex(w,j,_);return tt>0&&Pt>0||tt<0&&Pt<0?o.NO_INTERSECTION:ie===0&&ke===0&&tt===0&&Pt===0?this.computeCollinearIntersection(d,_,w,j):(ie===0||ke===0||tt===0||Pt===0?(this._isProper=!1,d.equals2D(w)||d.equals2D(j)?this._intPt[0]=d:_.equals2D(w)||_.equals2D(j)?this._intPt[0]=_:ie===0?this._intPt[0]=new Y(w):ke===0?this._intPt[0]=new Y(j):tt===0?this._intPt[0]=new Y(d):Pt===0&&(this._intPt[0]=new Y(_))):(this._isProper=!0,this._intPt[0]=this.intersection(d,_,w,j)),o.POINT_INTERSECTION)},s.prototype.interfaces_=function(){return[]},s.prototype.getClass=function(){return s},s.nearestEndpoint=function(d,_,w,j){var ie=d,ke=wt.distancePointLine(d,w,j),tt=wt.distancePointLine(_,w,j);return tt<ke&&(ke=tt,ie=_),(tt=wt.distancePointLine(w,d,_))<ke&&(ke=tt,ie=w),(tt=wt.distancePointLine(j,d,_))<ke&&(ke=tt,ie=j),ie},s}(J),At=function(){};At.prototype.interfaces_=function(){return[]},At.prototype.getClass=function(){return At},At.orientationIndex=function(o,s,d){var _=s.x-o.x,w=s.y-o.y,j=d.x-s.x,ie=d.y-s.y;return At.signOfDet2x2(_,w,j,ie)},At.signOfDet2x2=function(o,s,d,_){var w=null,j=null,ie=null;if(w=1,o===0||_===0)return s===0||d===0?0:s>0?d>0?-w:w:d>0?w:-w;if(s===0||d===0)return _>0?o>0?w:-w:o>0?-w:w;if(s>0?_>0?s<=_||(w=-w,j=o,o=d,d=j,j=s,s=_,_=j):s<=-_?(w=-w,d=-d,_=-_):(j=o,o=-d,d=j,j=s,s=-_,_=j):_>0?-s<=_?(w=-w,o=-o,s=-s):(j=-o,o=d,d=j,j=-s,s=_,_=j):s>=_?(o=-o,s=-s,d=-d,_=-_):(w=-w,j=-o,o=-d,d=j,j=-s,s=-_,_=j),o>0){if(!(d>0)||!(o<=d))return w}else{if(d>0||!(o>=d))return-w;w=-w,o=-o,d=-d}for(;;){if(ie=Math.floor(d/o),d-=ie*o,(_-=ie*s)<0)return-w;if(_>s)return w;if(o>d+d){if(s<_+_)return w}else{if(s>_+_)return-w;d=o-d,_=s-_,w=-w}if(_===0)return d===0?0:-w;if(d===0||(ie=Math.floor(o/d),o-=ie*d,(s-=ie*_)<0))return w;if(s>_)return-w;if(d>o+o){if(_<s+s)return-w}else{if(_>s+s)return w;o=d-o,s=_-s,w=-w}if(s===0)return o===0?0:w;if(o===0)return-w}};var It=function(){this._p=null,this._crossingCount=0,this._isPointOnSegment=!1;var o=arguments[0];this._p=o};It.prototype.countSegment=function(o,s){if(o.x<this._p.x&&s.x<this._p.x)return null;if(this._p.x===s.x&&this._p.y===s.y)return this._isPointOnSegment=!0,null;if(o.y===this._p.y&&s.y===this._p.y){var d=o.x,_=s.x;return d>_&&(d=s.x,_=o.x),this._p.x>=d&&this._p.x<=_&&(this._isPointOnSegment=!0),null}if(o.y>this._p.y&&s.y<=this._p.y||s.y>this._p.y&&o.y<=this._p.y){var w=o.x-this._p.x,j=o.y-this._p.y,ie=s.x-this._p.x,ke=s.y-this._p.y,tt=At.signOfDet2x2(w,j,ie,ke);if(tt===0)return this._isPointOnSegment=!0,null;ke<j&&(tt=-tt),tt>0&&this._crossingCount++}},It.prototype.isPointInPolygon=function(){return this.getLocation()!==_e.EXTERIOR},It.prototype.getLocation=function(){return this._isPointOnSegment?_e.BOUNDARY:this._crossingCount%2==1?_e.INTERIOR:_e.EXTERIOR},It.prototype.isOnSegment=function(){return this._isPointOnSegment},It.prototype.interfaces_=function(){return[]},It.prototype.getClass=function(){return It},It.locatePointInRing=function(){if(arguments[0]instanceof Y&&Le(arguments[1],Ut)){for(var o=arguments[0],s=arguments[1],d=new It(o),_=new Y,w=new Y,j=1;j<s.size();j++)if(s.getCoordinate(j,_),s.getCoordinate(j-1,w),d.countSegment(_,w),d.isOnSegment())return d.getLocation();return d.getLocation()}if(arguments[0]instanceof Y&&arguments[1]instanceof Array){for(var ie=arguments[0],ke=arguments[1],tt=new It(ie),Pt=1;Pt<ke.length;Pt++){var tr=ke[Pt],st=ke[Pt-1];if(tt.countSegment(tr,st),tt.isOnSegment())return tt.getLocation()}return tt.getLocation()}};var wt=function(){},mr={CLOCKWISE:{configurable:!0},RIGHT:{configurable:!0},COUNTERCLOCKWISE:{configurable:!0},LEFT:{configurable:!0},COLLINEAR:{configurable:!0},STRAIGHT:{configurable:!0}};wt.prototype.interfaces_=function(){return[]},wt.prototype.getClass=function(){return wt},wt.orientationIndex=function(o,s,d){return Rt.orientationIndex(o,s,d)},wt.signedArea=function(){if(arguments[0]instanceof Array){var o=arguments[0];if(o.length<3)return 0;for(var s=0,d=o[0].x,_=1;_<o.length-1;_++){var w=o[_].x-d,j=o[_+1].y;s+=w*(o[_-1].y-j)}return s/2}if(Le(arguments[0],Ut)){var ie=arguments[0],ke=ie.size();if(ke<3)return 0;var tt=new Y,Pt=new Y,tr=new Y;ie.getCoordinate(0,Pt),ie.getCoordinate(1,tr);var st=Pt.x;tr.x-=st;for(var Zt=0,Jt=1;Jt<ke-1;Jt++)tt.y=Pt.y,Pt.x=tr.x,Pt.y=tr.y,ie.getCoordinate(Jt+1,tr),tr.x-=st,Zt+=Pt.x*(tt.y-tr.y);return Zt/2}},wt.distanceLineLine=function(o,s,d,_){if(o.equals(s))return wt.distancePointLine(o,d,_);if(d.equals(_))return wt.distancePointLine(_,o,s);var w=!1;if(xr.intersects(o,s,d,_)){var j=(s.x-o.x)*(_.y-d.y)-(s.y-o.y)*(_.x-d.x);if(j===0)w=!0;else{var ie=(o.y-d.y)*(_.x-d.x)-(o.x-d.x)*(_.y-d.y),ke=((o.y-d.y)*(s.x-o.x)-(o.x-d.x)*(s.y-o.y))/j,tt=ie/j;(tt<0||tt>1||ke<0||ke>1)&&(w=!0)}}else w=!0;return w?de.min(wt.distancePointLine(o,d,_),wt.distancePointLine(s,d,_),wt.distancePointLine(d,o,s),wt.distancePointLine(_,o,s)):0},wt.isPointInRing=function(o,s){return wt.locatePointInRing(o,s)!==_e.EXTERIOR},wt.computeLength=function(o){var s=o.size();if(s<=1)return 0;var d=0,_=new Y;o.getCoordinate(0,_);for(var w=_.x,j=_.y,ie=1;ie<s;ie++){o.getCoordinate(ie,_);var ke=_.x,tt=_.y,Pt=ke-w,tr=tt-j;d+=Math.sqrt(Pt*Pt+tr*tr),w=ke,j=tt}return d},wt.isCCW=function(o){var s=o.length-1;if(s<3)throw new we("Ring has fewer than 4 points, so orientation cannot be determined");for(var d=o[0],_=0,w=1;w<=s;w++){var j=o[w];j.y>d.y&&(d=j,_=w)}var ie=_;do(ie-=1)<0&&(ie=s);while(o[ie].equals2D(d)&&ie!==_);var ke=_;do ke=(ke+1)%s;while(o[ke].equals2D(d)&&ke!==_);var tt=o[ie],Pt=o[ke];if(tt.equals2D(d)||Pt.equals2D(d)||tt.equals2D(Pt))return!1;var tr=wt.computeOrientation(tt,d,Pt),st=!1;return st=tr===0?tt.x>Pt.x:tr>0,st},wt.locatePointInRing=function(o,s){return It.locatePointInRing(o,s)},wt.distancePointLinePerpendicular=function(o,s,d){var _=(d.x-s.x)*(d.x-s.x)+(d.y-s.y)*(d.y-s.y),w=((s.y-o.y)*(d.x-s.x)-(s.x-o.x)*(d.y-s.y))/_;return Math.abs(w)*Math.sqrt(_)},wt.computeOrientation=function(o,s,d){return wt.orientationIndex(o,s,d)},wt.distancePointLine=function(){if(arguments.length===2){var o=arguments[0],s=arguments[1];if(s.length===0)throw new we("Line array must contain at least one vertex");for(var d=o.distance(s[0]),_=0;_<s.length-1;_++){var w=wt.distancePointLine(o,s[_],s[_+1]);w<d&&(d=w)}return d}if(arguments.length===3){var j=arguments[0],ie=arguments[1],ke=arguments[2];if(ie.x===ke.x&&ie.y===ke.y)return j.distance(ie);var tt=(ke.x-ie.x)*(ke.x-ie.x)+(ke.y-ie.y)*(ke.y-ie.y),Pt=((j.x-ie.x)*(ke.x-ie.x)+(j.y-ie.y)*(ke.y-ie.y))/tt;if(Pt<=0)return j.distance(ie);if(Pt>=1)return j.distance(ke);var tr=((ie.y-j.y)*(ke.x-ie.x)-(ie.x-j.x)*(ke.y-ie.y))/tt;return Math.abs(tr)*Math.sqrt(tt)}},wt.isOnLine=function(o,s){for(var d=new $e,_=1;_<s.length;_++){var w=s[_-1],j=s[_];if(d.computeIntersection(o,w,j),d.hasIntersection())return!0}return!1},mr.CLOCKWISE.get=function(){return-1},mr.RIGHT.get=function(){return wt.CLOCKWISE},mr.COUNTERCLOCKWISE.get=function(){return 1},mr.LEFT.get=function(){return wt.COUNTERCLOCKWISE},mr.COLLINEAR.get=function(){return 0},mr.STRAIGHT.get=function(){return wt.COLLINEAR},Object.defineProperties(wt,mr);var vt=function(){};vt.prototype.filter=function(o){},vt.prototype.interfaces_=function(){return[]},vt.prototype.getClass=function(){return vt};var Tt=function(){var o=arguments[0];this._envelope=null,this._factory=null,this._SRID=null,this._userData=null,this._factory=o,this._SRID=o.getSRID()},Qt={serialVersionUID:{configurable:!0},SORTINDEX_POINT:{configurable:!0},SORTINDEX_MULTIPOINT:{configurable:!0},SORTINDEX_LINESTRING:{configurable:!0},SORTINDEX_LINEARRING:{configurable:!0},SORTINDEX_MULTILINESTRING:{configurable:!0},SORTINDEX_POLYGON:{configurable:!0},SORTINDEX_MULTIPOLYGON:{configurable:!0},SORTINDEX_GEOMETRYCOLLECTION:{configurable:!0},geometryChangedFilter:{configurable:!0}};Tt.prototype.isGeometryCollection=function(){return this.getSortIndex()===Tt.SORTINDEX_GEOMETRYCOLLECTION},Tt.prototype.getFactory=function(){return this._factory},Tt.prototype.getGeometryN=function(o){return this},Tt.prototype.getArea=function(){return 0},Tt.prototype.isRectangle=function(){return!1},Tt.prototype.equals=function(){if(arguments[0]instanceof Tt){var o=arguments[0];return o!==null&&this.equalsTopo(o)}if(arguments[0]instanceof Object){var s=arguments[0];if(!(s instanceof Tt))return!1;var d=s;return this.equalsExact(d)}},Tt.prototype.equalsExact=function(o){return this===o||this.equalsExact(o,0)},Tt.prototype.geometryChanged=function(){this.apply(Tt.geometryChangedFilter)},Tt.prototype.geometryChangedAction=function(){this._envelope=null},Tt.prototype.equalsNorm=function(o){return o!==null&&this.norm().equalsExact(o.norm())},Tt.prototype.getLength=function(){return 0},Tt.prototype.getNumGeometries=function(){return 1},Tt.prototype.compareTo=function(){if(arguments.length===1){var o=arguments[0],s=o;return this.getSortIndex()!==s.getSortIndex()?this.getSortIndex()-s.getSortIndex():this.isEmpty()&&s.isEmpty()?0:this.isEmpty()?-1:s.isEmpty()?1:this.compareToSameClass(o)}if(arguments.length===2){var d=arguments[0],_=arguments[1];return this.getSortIndex()!==d.getSortIndex()?this.getSortIndex()-d.getSortIndex():this.isEmpty()&&d.isEmpty()?0:this.isEmpty()?-1:d.isEmpty()?1:this.compareToSameClass(d,_)}},Tt.prototype.getUserData=function(){return this._userData},Tt.prototype.getSRID=function(){return this._SRID},Tt.prototype.getEnvelope=function(){return this.getFactory().toGeometry(this.getEnvelopeInternal())},Tt.prototype.checkNotGeometryCollection=function(o){if(o.getSortIndex()===Tt.SORTINDEX_GEOMETRYCOLLECTION)throw new we("This method does not support GeometryCollection arguments")},Tt.prototype.equal=function(o,s,d){return d===0?o.equals(s):o.distance(s)<=d},Tt.prototype.norm=function(){var o=this.copy();return o.normalize(),o},Tt.prototype.getPrecisionModel=function(){return this._factory.getPrecisionModel()},Tt.prototype.getEnvelopeInternal=function(){return this._envelope===null&&(this._envelope=this.computeEnvelopeInternal()),new xr(this._envelope)},Tt.prototype.setSRID=function(o){this._SRID=o},Tt.prototype.setUserData=function(o){this._userData=o},Tt.prototype.compare=function(o,s){for(var d=o.iterator(),_=s.iterator();d.hasNext()&&_.hasNext();){var w=d.next(),j=_.next(),ie=w.compareTo(j);if(ie!==0)return ie}return d.hasNext()?1:_.hasNext()?-1:0},Tt.prototype.hashCode=function(){return this.getEnvelopeInternal().hashCode()},Tt.prototype.isGeometryCollectionOrDerived=function(){return this.getSortIndex()===Tt.SORTINDEX_GEOMETRYCOLLECTION||this.getSortIndex()===Tt.SORTINDEX_MULTIPOINT||this.getSortIndex()===Tt.SORTINDEX_MULTILINESTRING||this.getSortIndex()===Tt.SORTINDEX_MULTIPOLYGON},Tt.prototype.interfaces_=function(){return[ve,he,L]},Tt.prototype.getClass=function(){return Tt},Tt.hasNonEmptyElements=function(o){for(var s=0;s<o.length;s++)if(!o[s].isEmpty())return!0;return!1},Tt.hasNullElements=function(o){for(var s=0;s<o.length;s++)if(o[s]===null)return!0;return!1},Qt.serialVersionUID.get=function(){return 8763622679187377e3},Qt.SORTINDEX_POINT.get=function(){return 0},Qt.SORTINDEX_MULTIPOINT.get=function(){return 1},Qt.SORTINDEX_LINESTRING.get=function(){return 2},Qt.SORTINDEX_LINEARRING.get=function(){return 3},Qt.SORTINDEX_MULTILINESTRING.get=function(){return 4},Qt.SORTINDEX_POLYGON.get=function(){return 5},Qt.SORTINDEX_MULTIPOLYGON.get=function(){return 6},Qt.SORTINDEX_GEOMETRYCOLLECTION.get=function(){return 7},Qt.geometryChangedFilter.get=function(){return Er},Object.defineProperties(Tt,Qt);var Er=function(){};Er.interfaces_=function(){return[vt]},Er.filter=function(o){o.geometryChangedAction()};var Dr=function(){};Dr.prototype.filter=function(o){},Dr.prototype.interfaces_=function(){return[]},Dr.prototype.getClass=function(){return Dr};var Yr=function(){},an={Mod2BoundaryNodeRule:{configurable:!0},EndPointBoundaryNodeRule:{configurable:!0},MultiValentEndPointBoundaryNodeRule:{configurable:!0},MonoValentEndPointBoundaryNodeRule:{configurable:!0},MOD2_BOUNDARY_RULE:{configurable:!0},ENDPOINT_BOUNDARY_RULE:{configurable:!0},MULTIVALENT_ENDPOINT_BOUNDARY_RULE:{configurable:!0},MONOVALENT_ENDPOINT_BOUNDARY_RULE:{configurable:!0},OGC_SFS_BOUNDARY_RULE:{configurable:!0}};Yr.prototype.isInBoundary=function(o){},Yr.prototype.interfaces_=function(){return[]},Yr.prototype.getClass=function(){return Yr},an.Mod2BoundaryNodeRule.get=function(){return Br},an.EndPointBoundaryNodeRule.get=function(){return en},an.MultiValentEndPointBoundaryNodeRule.get=function(){return Zn},an.MonoValentEndPointBoundaryNodeRule.get=function(){return zn},an.MOD2_BOUNDARY_RULE.get=function(){return new Br},an.ENDPOINT_BOUNDARY_RULE.get=function(){return new en},an.MULTIVALENT_ENDPOINT_BOUNDARY_RULE.get=function(){return new Zn},an.MONOVALENT_ENDPOINT_BOUNDARY_RULE.get=function(){return new zn},an.OGC_SFS_BOUNDARY_RULE.get=function(){return Yr.MOD2_BOUNDARY_RULE},Object.defineProperties(Yr,an);var Br=function(){};Br.prototype.isInBoundary=function(o){return o%2==1},Br.prototype.interfaces_=function(){return[Yr]},Br.prototype.getClass=function(){return Br};var en=function(){};en.prototype.isInBoundary=function(o){return o>0},en.prototype.interfaces_=function(){return[Yr]},en.prototype.getClass=function(){return en};var Zn=function(){};Zn.prototype.isInBoundary=function(o){return o>1},Zn.prototype.interfaces_=function(){return[Yr]},Zn.prototype.getClass=function(){return Zn};var zn=function(){};zn.prototype.isInBoundary=function(o){return o===1},zn.prototype.interfaces_=function(){return[Yr]},zn.prototype.getClass=function(){return zn};var fi=function(){};fi.prototype.add=function(){},fi.prototype.addAll=function(){},fi.prototype.isEmpty=function(){},fi.prototype.iterator=function(){},fi.prototype.size=function(){},fi.prototype.toArray=function(){},fi.prototype.remove=function(){},(k.prototype=new Error).name="IndexOutOfBoundsException";var la=function(){};la.prototype.hasNext=function(){},la.prototype.next=function(){},la.prototype.remove=function(){};var Oa=function(o){function s(){o.apply(this,arguments)}return o&&(s.__proto__=o),s.prototype=Object.create(o&&o.prototype),s.prototype.constructor=s,s.prototype.get=function(){},s.prototype.set=function(){},s.prototype.isEmpty=function(){},s}(fi);(G.prototype=new Error).name="NoSuchElementException";var Gr=function(o){function s(){o.call(this),this.array_=[],arguments[0]instanceof fi&&this.addAll(arguments[0])}return o&&(s.__proto__=o),s.prototype=Object.create(o&&o.prototype),s.prototype.constructor=s,s.prototype.ensureCapacity=function(){},s.prototype.interfaces_=function(){return[o,fi]},s.prototype.add=function(d){return arguments.length===1?this.array_.push(d):this.array_.splice(arguments[0],arguments[1]),!0},s.prototype.clear=function(){this.array_=[]},s.prototype.addAll=function(d){for(var _=d.iterator();_.hasNext();)this.add(_.next());return!0},s.prototype.set=function(d,_){var w=this.array_[d];return this.array_[d]=_,w},s.prototype.iterator=function(){return new Ns(this)},s.prototype.get=function(d){if(d<0||d>=this.size())throw new k;return this.array_[d]},s.prototype.isEmpty=function(){return this.array_.length===0},s.prototype.size=function(){return this.array_.length},s.prototype.toArray=function(){for(var d=[],_=0,w=this.array_.length;_<w;_++)d.push(this.array_[_]);return d},s.prototype.remove=function(d){for(var _=!1,w=0,j=this.array_.length;w<j;w++)if(this.array_[w]===d){this.array_.splice(w,1),_=!0;break}return _},s}(Oa),Ns=function(o){function s(d){o.call(this),this.arrayList_=d,this.position_=0}return o&&(s.__proto__=o),s.prototype=Object.create(o&&o.prototype),s.prototype.constructor=s,s.prototype.next=function(){if(this.position_===this.arrayList_.size())throw new G;return this.arrayList_.get(this.position_++)},s.prototype.hasNext=function(){return this.position_<this.arrayList_.size()},s.prototype.set=function(d){return this.arrayList_.set(this.position_-1,d)},s.prototype.remove=function(){this.arrayList_.remove(this.arrayList_.get(this.position_))},s}(la),Co=function(o){function s(){if(o.call(this),arguments.length!==0){if(arguments.length===1){var _=arguments[0];this.ensureCapacity(_.length),this.add(_,!0)}else if(arguments.length===2){var w=arguments[0],j=arguments[1];this.ensureCapacity(w.length),this.add(w,j)}}}o&&(s.__proto__=o),(s.prototype=Object.create(o&&o.prototype)).constructor=s;var d={coordArrayType:{configurable:!0}};return d.coordArrayType.get=function(){return new Array(0).fill(null)},s.prototype.getCoordinate=function(_){return this.get(_)},s.prototype.addAll=function(){if(arguments.length===2){for(var _=arguments[0],w=arguments[1],j=!1,ie=_.iterator();ie.hasNext();)this.add(ie.next(),w),j=!0;return j}return o.prototype.addAll.apply(this,arguments)},s.prototype.clone=function(){for(var _=o.prototype.clone.call(this),w=0;w<this.size();w++)_.add(w,this.get(w).copy());return _},s.prototype.toCoordinateArray=function(){return this.toArray(s.coordArrayType)},s.prototype.add=function(){if(arguments.length===1){var _=arguments[0];o.prototype.add.call(this,_)}else if(arguments.length===2){if(arguments[0]instanceof Array&&typeof arguments[1]=="boolean"){var w=arguments[0],j=arguments[1];return this.add(w,j,!0),!0}if(arguments[0]instanceof Y&&typeof arguments[1]=="boolean"){var ie=arguments[0];if(!arguments[1]&&this.size()>=1&&this.get(this.size()-1).equals2D(ie))return null;o.prototype.add.call(this,ie)}else if(arguments[0]instanceof Object&&typeof arguments[1]=="boolean"){var ke=arguments[0],tt=arguments[1];return this.add(ke,tt),!0}}else if(arguments.length===3){if(typeof arguments[2]=="boolean"&&arguments[0]instanceof Array&&typeof arguments[1]=="boolean"){var Pt=arguments[0],tr=arguments[1];if(arguments[2])for(var st=0;st<Pt.length;st++)this.add(Pt[st],tr);else for(var Zt=Pt.length-1;Zt>=0;Zt--)this.add(Pt[Zt],tr);return!0}if(typeof arguments[2]=="boolean"&&Number.isInteger(arguments[0])&&arguments[1]instanceof Y){var Jt=arguments[0],yr=arguments[1];if(!arguments[2]){var v=this.size();if(v>0&&(Jt>0&&this.get(Jt-1).equals2D(yr)||Jt<v&&this.get(Jt).equals2D(yr)))return null}o.prototype.add.call(this,Jt,yr)}}else if(arguments.length===4){var Pn=arguments[0],jn=arguments[1],Xe=arguments[2],Ia=arguments[3],ao=1;Xe>Ia&&(ao=-1);for(var xo=Xe;xo!==Ia;xo+=ao)this.add(Pn[xo],jn);return!0}},s.prototype.closeRing=function(){this.size()>0&&this.add(new Y(this.get(0)),!1)},s.prototype.interfaces_=function(){return[]},s.prototype.getClass=function(){return s},Object.defineProperties(s,d),s}(Gr),_n=function(){},xs={ForwardComparator:{configurable:!0},BidirectionalComparator:{configurable:!0},coordArrayType:{configurable:!0}};xs.ForwardComparator.get=function(){return go},xs.BidirectionalComparator.get=function(){return Fs},xs.coordArrayType.get=function(){return new Array(0).fill(null)},_n.prototype.interfaces_=function(){return[]},_n.prototype.getClass=function(){return _n},_n.isRing=function(o){return!(o.length<4)&&!!o[0].equals2D(o[o.length-1])},_n.ptNotInList=function(o,s){for(var d=0;d<o.length;d++){var _=o[d];if(_n.indexOf(_,s)<0)return _}return null},_n.scroll=function(o,s){var d=_n.indexOf(s,o);if(d<0)return null;var _=new Array(o.length).fill(null);Qr.arraycopy(o,d,_,0,o.length-d),Qr.arraycopy(o,0,_,o.length-d,d),Qr.arraycopy(_,0,o,0,o.length)},_n.equals=function(){if(arguments.length===2){var o=arguments[0],s=arguments[1];if(o===s)return!0;if(o===null||s===null||o.length!==s.length)return!1;for(var d=0;d<o.length;d++)if(!o[d].equals(s[d]))return!1;return!0}if(arguments.length===3){var _=arguments[0],w=arguments[1],j=arguments[2];if(_===w)return!0;if(_===null||w===null||_.length!==w.length)return!1;for(var ie=0;ie<_.length;ie++)if(j.compare(_[ie],w[ie])!==0)return!1;return!0}},_n.intersection=function(o,s){for(var d=new Co,_=0;_<o.length;_++)s.intersects(o[_])&&d.add(o[_],!0);return d.toCoordinateArray()},_n.hasRepeatedPoints=function(o){for(var s=1;s<o.length;s++)if(o[s-1].equals(o[s]))return!0;return!1},_n.removeRepeatedPoints=function(o){return _n.hasRepeatedPoints(o)?new Co(o,!1).toCoordinateArray():o},_n.reverse=function(o){for(var s=o.length-1,d=Math.trunc(s/2),_=0;_<=d;_++){var w=o[_];o[_]=o[s-_],o[s-_]=w}},_n.removeNull=function(o){for(var s=0,d=0;d<o.length;d++)o[d]!==null&&s++;var _=new Array(s).fill(null);if(s===0)return _;for(var w=0,j=0;j<o.length;j++)o[j]!==null&&(_[w++]=o[j]);return _},_n.copyDeep=function(){if(arguments.length===1){for(var o=arguments[0],s=new Array(o.length).fill(null),d=0;d<o.length;d++)s[d]=new Y(o[d]);return s}if(arguments.length===5)for(var _=arguments[0],w=arguments[1],j=arguments[2],ie=arguments[3],ke=arguments[4],tt=0;tt<ke;tt++)j[ie+tt]=new Y(_[w+tt])},_n.isEqualReversed=function(o,s){for(var d=0;d<o.length;d++){var _=o[d],w=s[o.length-d-1];if(_.compareTo(w)!==0)return!1}return!0},_n.envelope=function(o){for(var s=new xr,d=0;d<o.length;d++)s.expandToInclude(o[d]);return s},_n.toCoordinateArray=function(o){return o.toArray(_n.coordArrayType)},_n.atLeastNCoordinatesOrNothing=function(o,s){return s.length>=o?s:[]},_n.indexOf=function(o,s){for(var d=0;d<s.length;d++)if(o.equals(s[d]))return d;return-1},_n.increasingDirection=function(o){for(var s=0;s<Math.trunc(o.length/2);s++){var d=o.length-1-s,_=o[s].compareTo(o[d]);if(_!==0)return _}return 1},_n.compare=function(o,s){for(var d=0;d<o.length&&d<s.length;){var _=o[d].compareTo(s[d]);if(_!==0)return _;d++}return d<s.length?-1:d<o.length?1:0},_n.minCoordinate=function(o){for(var s=null,d=0;d<o.length;d++)(s===null||s.compareTo(o[d])>0)&&(s=o[d]);return s},_n.extract=function(o,s,d){s=de.clamp(s,0,o.length);var _=(d=de.clamp(d,-1,o.length))-s+1;d<0&&(_=0),s>=o.length&&(_=0),d<s&&(_=0);var w=new Array(_).fill(null);if(_===0)return w;for(var j=0,ie=s;ie<=d;ie++)w[j++]=o[ie];return w},Object.defineProperties(_n,xs);var go=function(){};go.prototype.compare=function(o,s){return _n.compare(o,s)},go.prototype.interfaces_=function(){return[te]},go.prototype.getClass=function(){return go};var Fs=function(){};Fs.prototype.compare=function(o,s){var d=o,_=s;if(d.length<_.length)return-1;if(d.length>_.length)return 1;if(d.length===0)return 0;var w=_n.compare(d,_);return _n.isEqualReversed(d,_)?0:w},Fs.prototype.OLDcompare=function(o,s){var d=o,_=s;if(d.length<_.length)return-1;if(d.length>_.length)return 1;if(d.length===0)return 0;for(var w=_n.increasingDirection(d),j=_n.increasingDirection(_),ie=w>0?0:d.length-1,ke=j>0?0:d.length-1,tt=0;tt<d.length;tt++){var Pt=d[ie].compareTo(_[ke]);if(Pt!==0)return Pt;ie+=w,ke+=j}return 0},Fs.prototype.interfaces_=function(){return[te]},Fs.prototype.getClass=function(){return Fs};var Po=function(){};Po.prototype.get=function(){},Po.prototype.put=function(){},Po.prototype.size=function(){},Po.prototype.values=function(){},Po.prototype.entrySet=function(){};var hl=function(o){function s(){o.apply(this,arguments)}return o&&(s.__proto__=o),s.prototype=Object.create(o&&o.prototype),s.prototype.constructor=s,s}(Po);(Z.prototype=new Error).name="OperationNotSupported",(F.prototype=new fi).contains=function(){};var yu=function(o){function s(){o.call(this),this.array_=[],arguments[0]instanceof fi&&this.addAll(arguments[0])}return o&&(s.__proto__=o),s.prototype=Object.create(o&&o.prototype),s.prototype.constructor=s,s.prototype.contains=function(d){for(var _=0,w=this.array_.length;_<w;_++)if(this.array_[_]===d)return!0;return!1},s.prototype.add=function(d){return!this.contains(d)&&(this.array_.push(d),!0)},s.prototype.addAll=function(d){for(var _=d.iterator();_.hasNext();)this.add(_.next());return!0},s.prototype.remove=function(d){throw new Error},s.prototype.size=function(){return this.array_.length},s.prototype.isEmpty=function(){return this.array_.length===0},s.prototype.toArray=function(){for(var d=[],_=0,w=this.array_.length;_<w;_++)d.push(this.array_[_]);return d},s.prototype.iterator=function(){return new Es(this)},s}(F),Es=function(o){function s(d){o.call(this),this.hashSet_=d,this.position_=0}return o&&(s.__proto__=o),s.prototype=Object.create(o&&o.prototype),s.prototype.constructor=s,s.prototype.next=function(){if(this.position_===this.hashSet_.size())throw new G;return this.hashSet_.array_[this.position_++]},s.prototype.hasNext=function(){return this.position_<this.hashSet_.size()},s.prototype.remove=function(){throw new Z},s}(la),cs=0;(Re.prototype=new hl).get=function(o){for(var s=this.root_;s!==null;){var d=o.compareTo(s.key);if(d<0)s=s.left;else{if(!(d>0))return s.value;s=s.right}}return null},Re.prototype.put=function(o,s){if(this.root_===null)return this.root_={key:o,value:s,left:null,right:null,parent:null,color:cs,getValue:function(){return this.value},getKey:function(){return this.key}},this.size_=1,null;var d,_,w=this.root_;do if(d=w,(_=o.compareTo(w.key))<0)w=w.left;else{if(!(_>0)){var j=w.value;return w.value=s,j}w=w.right}while(w!==null);var ie={key:o,left:null,right:null,value:s,parent:d,color:cs,getValue:function(){return this.value},getKey:function(){return this.key}};return _<0?d.left=ie:d.right=ie,this.fixAfterInsertion(ie),this.size_++,null},Re.prototype.fixAfterInsertion=function(o){for(o.color=1;o!=null&&o!==this.root_&&o.parent.color===1;)if(q(o)===fe(q(q(o)))){var s=Se(q(q(o)));z(s)===1?(ee(q(o),cs),ee(s,cs),ee(q(q(o)),1),o=q(q(o))):(o===Se(q(o))&&(o=q(o),this.rotateLeft(o)),ee(q(o),cs),ee(q(q(o)),1),this.rotateRight(q(q(o))))}else{var d=fe(q(q(o)));z(d)===1?(ee(q(o),cs),ee(d,cs),ee(q(q(o)),1),o=q(q(o))):(o===fe(q(o))&&(o=q(o),this.rotateRight(o)),ee(q(o),cs),ee(q(q(o)),1),this.rotateLeft(q(q(o))))}this.root_.color=cs},Re.prototype.values=function(){var o=new Gr,s=this.getFirstEntry();if(s!==null)for(o.add(s.value);(s=Re.successor(s))!==null;)o.add(s.value);return o},Re.prototype.entrySet=function(){var o=new yu,s=this.getFirstEntry();if(s!==null)for(o.add(s);(s=Re.successor(s))!==null;)o.add(s);return o},Re.prototype.rotateLeft=function(o){if(o!=null){var s=o.right;o.right=s.left,s.left!=null&&(s.left.parent=o),s.parent=o.parent,o.parent===null?this.root_=s:o.parent.left===o?o.parent.left=s:o.parent.right=s,s.left=o,o.parent=s}},Re.prototype.rotateRight=function(o){if(o!=null){var s=o.left;o.left=s.right,s.right!=null&&(s.right.parent=o),s.parent=o.parent,o.parent===null?this.root_=s:o.parent.right===o?o.parent.right=s:o.parent.left=s,s.right=o,o.parent=s}},Re.prototype.getFirstEntry=function(){var o=this.root_;if(o!=null)for(;o.left!=null;)o=o.left;return o},Re.successor=function(o){if(o===null)return null;if(o.right!==null){for(var s=o.right;s.left!==null;)s=s.left;return s}for(var d=o.parent,_=o;d!==null&&_===d.right;)_=d,d=d.parent;return d},Re.prototype.size=function(){return this.size_};var Ou=function(){};Ou.prototype.interfaces_=function(){return[]},Ou.prototype.getClass=function(){return Ou},De.prototype=new F,(Ve.prototype=new De).contains=function(o){for(var s=0,d=this.array_.length;s<d;s++)if(this.array_[s].compareTo(o)===0)return!0;return!1},Ve.prototype.add=function(o){if(this.contains(o))return!1;for(var s=0,d=this.array_.length;s<d;s++)if(this.array_[s].compareTo(o)===1)return this.array_.splice(s,0,o),!0;return this.array_.push(o),!0},Ve.prototype.addAll=function(o){for(var s=o.iterator();s.hasNext();)this.add(s.next());return!0},Ve.prototype.remove=function(o){throw new Z},Ve.prototype.size=function(){return this.array_.length},Ve.prototype.isEmpty=function(){return this.array_.length===0},Ve.prototype.toArray=function(){for(var o=[],s=0,d=this.array_.length;s<d;s++)o.push(this.array_[s]);return o},Ve.prototype.iterator=function(){return new Al(this)};var Al=function(o){this.treeSet_=o,this.position_=0};Al.prototype.next=function(){if(this.position_===this.treeSet_.size())throw new G;return this.treeSet_.array_[this.position_++]},Al.prototype.hasNext=function(){return this.position_<this.treeSet_.size()},Al.prototype.remove=function(){throw new Z};var ga=function(){};ga.sort=function(){var o,s,d,_,w=arguments[0];if(arguments.length===1)_=function(ie,ke){return ie.compareTo(ke)},w.sort(_);else if(arguments.length===2)d=arguments[1],_=function(ie,ke){return d.compare(ie,ke)},w.sort(_);else if(arguments.length===3){(s=w.slice(arguments[1],arguments[2])).sort();var j=w.slice(0,arguments[1]).concat(s,w.slice(arguments[2],w.length));for(w.splice(0,w.length),o=0;o<j.length;o++)w.push(j[o])}else if(arguments.length===4)for(s=w.slice(arguments[1],arguments[2]),d=arguments[3],_=function(ie,ke){return d.compare(ie,ke)},s.sort(_),j=w.slice(0,arguments[1]).concat(s,w.slice(arguments[2],w.length)),w.splice(0,w.length),o=0;o<j.length;o++)w.push(j[o])},ga.asList=function(o){for(var s=new Gr,d=0,_=o.length;d<_;d++)s.add(o[d]);return s};var Zi=function(){},Bs={P:{configurable:!0},L:{configurable:!0},A:{configurable:!0},FALSE:{configurable:!0},TRUE:{configurable:!0},DONTCARE:{configurable:!0},SYM_FALSE:{configurable:!0},SYM_TRUE:{configurable:!0},SYM_DONTCARE:{configurable:!0},SYM_P:{configurable:!0},SYM_L:{configurable:!0},SYM_A:{configurable:!0}};Bs.P.get=function(){return 0},Bs.L.get=function(){return 1},Bs.A.get=function(){return 2},Bs.FALSE.get=function(){return-1},Bs.TRUE.get=function(){return-2},Bs.DONTCARE.get=function(){return-3},Bs.SYM_FALSE.get=function(){return"F"},Bs.SYM_TRUE.get=function(){return"T"},Bs.SYM_DONTCARE.get=function(){return"*"},Bs.SYM_P.get=function(){return"0"},Bs.SYM_L.get=function(){return"1"},Bs.SYM_A.get=function(){return"2"},Zi.prototype.interfaces_=function(){return[]},Zi.prototype.getClass=function(){return Zi},Zi.toDimensionSymbol=function(o){switch(o){case Zi.FALSE:return Zi.SYM_FALSE;case Zi.TRUE:return Zi.SYM_TRUE;case Zi.DONTCARE:return Zi.SYM_DONTCARE;case Zi.P:return Zi.SYM_P;case Zi.L:return Zi.SYM_L;case Zi.A:return Zi.SYM_A}throw new we("Unknown dimension value: "+o)},Zi.toDimensionValue=function(o){switch(ze.toUpperCase(o)){case Zi.SYM_FALSE:return Zi.FALSE;case Zi.SYM_TRUE:return Zi.TRUE;case Zi.SYM_DONTCARE:return Zi.DONTCARE;case Zi.SYM_P:return Zi.P;case Zi.SYM_L:return Zi.L;case Zi.SYM_A:return Zi.A}throw new we("Unknown dimension symbol: "+o)},Object.defineProperties(Zi,Bs);var no=function(){};no.prototype.filter=function(o){},no.prototype.interfaces_=function(){return[]},no.prototype.getClass=function(){return no};var es=function(){};es.prototype.filter=function(o,s){},es.prototype.isDone=function(){},es.prototype.isGeometryChanged=function(){},es.prototype.interfaces_=function(){return[]},es.prototype.getClass=function(){return es};var Lo=function(o){function s(_,w){if(o.call(this,w),this._geometries=_||[],o.hasNullElements(this._geometries))throw new we("geometries must not contain null elements")}o&&(s.__proto__=o),(s.prototype=Object.create(o&&o.prototype)).constructor=s;var d={serialVersionUID:{configurable:!0}};return s.prototype.computeEnvelopeInternal=function(){for(var _=new xr,w=0;w<this._geometries.length;w++)_.expandToInclude(this._geometries[w].getEnvelopeInternal());return _},s.prototype.getGeometryN=function(_){return this._geometries[_]},s.prototype.getSortIndex=function(){return o.SORTINDEX_GEOMETRYCOLLECTION},s.prototype.getCoordinates=function(){for(var _=new Array(this.getNumPoints()).fill(null),w=-1,j=0;j<this._geometries.length;j++)for(var ie=this._geometries[j].getCoordinates(),ke=0;ke<ie.length;ke++)_[++w]=ie[ke];return _},s.prototype.getArea=function(){for(var _=0,w=0;w<this._geometries.length;w++)_+=this._geometries[w].getArea();return _},s.prototype.equalsExact=function(){if(arguments.length===2){var _=arguments[0],w=arguments[1];if(!this.isEquivalentClass(_))return!1;var j=_;if(this._geometries.length!==j._geometries.length)return!1;for(var ie=0;ie<this._geometries.length;ie++)if(!this._geometries[ie].equalsExact(j._geometries[ie],w))return!1;return!0}return o.prototype.equalsExact.apply(this,arguments)},s.prototype.normalize=function(){for(var _=0;_<this._geometries.length;_++)this._geometries[_].normalize();ga.sort(this._geometries)},s.prototype.getCoordinate=function(){return this.isEmpty()?null:this._geometries[0].getCoordinate()},s.prototype.getBoundaryDimension=function(){for(var _=Zi.FALSE,w=0;w<this._geometries.length;w++)_=Math.max(_,this._geometries[w].getBoundaryDimension());return _},s.prototype.getDimension=function(){for(var _=Zi.FALSE,w=0;w<this._geometries.length;w++)_=Math.max(_,this._geometries[w].getDimension());return _},s.prototype.getLength=function(){for(var _=0,w=0;w<this._geometries.length;w++)_+=this._geometries[w].getLength();return _},s.prototype.getNumPoints=function(){for(var _=0,w=0;w<this._geometries.length;w++)_+=this._geometries[w].getNumPoints();return _},s.prototype.getNumGeometries=function(){return this._geometries.length},s.prototype.reverse=function(){for(var _=this._geometries.length,w=new Array(_).fill(null),j=0;j<this._geometries.length;j++)w[j]=this._geometries[j].reverse();return this.getFactory().createGeometryCollection(w)},s.prototype.compareToSameClass=function(){if(arguments.length===1){var _=arguments[0],w=new Ve(ga.asList(this._geometries)),j=new Ve(ga.asList(_._geometries));return this.compare(w,j)}if(arguments.length===2){for(var ie=arguments[0],ke=arguments[1],tt=ie,Pt=this.getNumGeometries(),tr=tt.getNumGeometries(),st=0;st<Pt&&st<tr;){var Zt=this.getGeometryN(st),Jt=tt.getGeometryN(st),yr=Zt.compareToSameClass(Jt,ke);if(yr!==0)return yr;st++}return st<Pt?1:st<tr?-1:0}},s.prototype.apply=function(){if(Le(arguments[0],Dr))for(var _=arguments[0],w=0;w<this._geometries.length;w++)this._geometries[w].apply(_);else if(Le(arguments[0],es)){var j=arguments[0];if(this._geometries.length===0)return null;for(var ie=0;ie<this._geometries.length&&(this._geometries[ie].apply(j),!j.isDone());ie++);j.isGeometryChanged()&&this.geometryChanged()}else if(Le(arguments[0],no)){var ke=arguments[0];ke.filter(this);for(var tt=0;tt<this._geometries.length;tt++)this._geometries[tt].apply(ke)}else if(Le(arguments[0],vt)){var Pt=arguments[0];Pt.filter(this);for(var tr=0;tr<this._geometries.length;tr++)this._geometries[tr].apply(Pt)}},s.prototype.getBoundary=function(){return this.checkNotGeometryCollection(this),Lt.shouldNeverReachHere(),null},s.prototype.clone=function(){var _=o.prototype.clone.call(this);_._geometries=new Array(this._geometries.length).fill(null);for(var w=0;w<this._geometries.length;w++)_._geometries[w]=this._geometries[w].clone();return _},s.prototype.getGeometryType=function(){return"GeometryCollection"},s.prototype.copy=function(){for(var _=new Array(this._geometries.length).fill(null),w=0;w<_.length;w++)_[w]=this._geometries[w].copy();return new s(_,this._factory)},s.prototype.isEmpty=function(){for(var _=0;_<this._geometries.length;_++)if(!this._geometries[_].isEmpty())return!1;return!0},s.prototype.interfaces_=function(){return[]},s.prototype.getClass=function(){return s},d.serialVersionUID.get=function(){return-5694727726395021e3},Object.defineProperties(s,d),s}(Tt),Ni=function(o){function s(){o.apply(this,arguments)}o&&(s.__proto__=o),(s.prototype=Object.create(o&&o.prototype)).constructor=s;var d={serialVersionUID:{configurable:!0}};return s.prototype.getSortIndex=function(){return Tt.SORTINDEX_MULTILINESTRING},s.prototype.equalsExact=function(){if(arguments.length===2){var _=arguments[0],w=arguments[1];return!!this.isEquivalentClass(_)&&o.prototype.equalsExact.call(this,_,w)}return o.prototype.equalsExact.apply(this,arguments)},s.prototype.getBoundaryDimension=function(){return this.isClosed()?Zi.FALSE:0},s.prototype.isClosed=function(){if(this.isEmpty())return!1;for(var _=0;_<this._geometries.length;_++)if(!this._geometries[_].isClosed())return!1;return!0},s.prototype.getDimension=function(){return 1},s.prototype.reverse=function(){for(var _=this._geometries.length,w=new Array(_).fill(null),j=0;j<this._geometries.length;j++)w[_-1-j]=this._geometries[j].reverse();return this.getFactory().createMultiLineString(w)},s.prototype.getBoundary=function(){return new io(this).getBoundary()},s.prototype.getGeometryType=function(){return"MultiLineString"},s.prototype.copy=function(){for(var _=new Array(this._geometries.length).fill(null),w=0;w<_.length;w++)_[w]=this._geometries[w].copy();return new s(_,this._factory)},s.prototype.interfaces_=function(){return[Ou]},s.prototype.getClass=function(){return s},d.serialVersionUID.get=function(){return 8166665132445434e3},Object.defineProperties(s,d),s}(Lo),io=function(){if(this._geom=null,this._geomFact=null,this._bnRule=null,this._endpointMap=null,arguments.length===1){var o=arguments[0],s=Yr.MOD2_BOUNDARY_RULE;this._geom=o,this._geomFact=o.getFactory(),this._bnRule=s}else if(arguments.length===2){var d=arguments[0],_=arguments[1];this._geom=d,this._geomFact=d.getFactory(),this._bnRule=_}};io.prototype.boundaryMultiLineString=function(o){if(this._geom.isEmpty())return this.getEmptyMultiPoint();var s=this.computeBoundaryCoordinates(o);return s.length===1?this._geomFact.createPoint(s[0]):this._geomFact.createMultiPointFromCoords(s)},io.prototype.getBoundary=function(){return this._geom instanceof xa?this.boundaryLineString(this._geom):this._geom instanceof Ni?this.boundaryMultiLineString(this._geom):this._geom.getBoundary()},io.prototype.boundaryLineString=function(o){return this._geom.isEmpty()?this.getEmptyMultiPoint():o.isClosed()?this._bnRule.isInBoundary(2)?o.getStartPoint():this._geomFact.createMultiPoint():this._geomFact.createMultiPoint([o.getStartPoint(),o.getEndPoint()])},io.prototype.getEmptyMultiPoint=function(){return this._geomFact.createMultiPoint()},io.prototype.computeBoundaryCoordinates=function(o){var s=new Gr;this._endpointMap=new Re;for(var d=0;d<o.getNumGeometries();d++){var _=o.getGeometryN(d);_.getNumPoints()!==0&&(this.addEndpoint(_.getCoordinateN(0)),this.addEndpoint(_.getCoordinateN(_.getNumPoints()-1)))}for(var w=this._endpointMap.entrySet().iterator();w.hasNext();){var j=w.next(),ie=j.getValue().count;this._bnRule.isInBoundary(ie)&&s.add(j.getKey())}return _n.toCoordinateArray(s)},io.prototype.addEndpoint=function(o){var s=this._endpointMap.get(o);s===null&&(s=new bs,this._endpointMap.put(o,s)),s.count++},io.prototype.interfaces_=function(){return[]},io.prototype.getClass=function(){return io},io.getBoundary=function(){if(arguments.length===1){var o=arguments[0];return new io(o).getBoundary()}if(arguments.length===2){var s=arguments[0],d=arguments[1];return new io(s,d).getBoundary()}};var bs=function(){this.count=null};bs.prototype.interfaces_=function(){return[]},bs.prototype.getClass=function(){return bs};var $o=function(){},Ru={NEWLINE:{configurable:!0},SIMPLE_ORDINATE_FORMAT:{configurable:!0}};$o.prototype.interfaces_=function(){return[]},$o.prototype.getClass=function(){return $o},$o.chars=function(o,s){for(var d=new Array(s).fill(null),_=0;_<s;_++)d[_]=o;return String(d)},$o.getStackTrace=function(){if(arguments.length===1){var o=arguments[0],s=new function(){},d=new function(){}(s);return o.printStackTrace(d),s.toString()}if(arguments.length===2){for(var _=arguments[0],w=arguments[1],j="",ie=new function(){}(new function(){}($o.getStackTrace(_))),ke=0;ke<w;ke++)try{j+=ie.readLine()+$o.NEWLINE}catch(tt){if(!(tt instanceof nt))throw tt;Lt.shouldNeverReachHere()}return j}},$o.split=function(o,s){for(var d=s.length,_=new Gr,w=""+o,j=w.indexOf(s);j>=0;){var ie=w.substring(0,j);_.add(ie),j=(w=w.substring(j+d)).indexOf(s)}w.length>0&&_.add(w);for(var ke=new Array(_.size()).fill(null),tt=0;tt<ke.length;tt++)ke[tt]=_.get(tt);return ke},$o.toString=function(){if(arguments.length===1){var o=arguments[0];return $o.SIMPLE_ORDINATE_FORMAT.format(o)}},$o.spaces=function(o){return $o.chars(" ",o)},Ru.NEWLINE.get=function(){return Qr.getProperty("line.separator")},Ru.SIMPLE_ORDINATE_FORMAT.get=function(){return new function(){}("0.#")},Object.defineProperties($o,Ru);var Ca=function(){};Ca.prototype.interfaces_=function(){return[]},Ca.prototype.getClass=function(){return Ca},Ca.copyCoord=function(o,s,d,_){for(var w=Math.min(o.getDimension(),d.getDimension()),j=0;j<w;j++)d.setOrdinate(_,j,o.getOrdinate(s,j))},Ca.isRing=function(o){var s=o.size();return s===0||!(s<=3)&&o.getOrdinate(0,Ut.X)===o.getOrdinate(s-1,Ut.X)&&o.getOrdinate(0,Ut.Y)===o.getOrdinate(s-1,Ut.Y)},Ca.isEqual=function(o,s){var d=o.size();if(d!==s.size())return!1;for(var _=Math.min(o.getDimension(),s.getDimension()),w=0;w<d;w++)for(var j=0;j<_;j++){var ie=o.getOrdinate(w,j),ke=s.getOrdinate(w,j);if(o.getOrdinate(w,j)!==s.getOrdinate(w,j)&&(!ne.isNaN(ie)||!ne.isNaN(ke)))return!1}return!0},Ca.extend=function(o,s,d){var _=o.create(d,s.getDimension()),w=s.size();if(Ca.copy(s,0,_,0,w),w>0)for(var j=w;j<d;j++)Ca.copy(s,w-1,_,j,1);return _},Ca.reverse=function(o){for(var s=o.size()-1,d=Math.trunc(s/2),_=0;_<=d;_++)Ca.swap(o,_,s-_)},Ca.swap=function(o,s,d){if(s===d)return null;for(var _=0;_<o.getDimension();_++){var w=o.getOrdinate(s,_);o.setOrdinate(s,_,o.getOrdinate(d,_)),o.setOrdinate(d,_,w)}},Ca.copy=function(o,s,d,_,w){for(var j=0;j<w;j++)Ca.copyCoord(o,s+j,d,_+j)},Ca.toString=function(){if(arguments.length===1){var o=arguments[0],s=o.size();if(s===0)return"()";var d=o.getDimension(),_=new se;_.append("(");for(var w=0;w<s;w++){w>0&&_.append(" ");for(var j=0;j<d;j++)j>0&&_.append(","),_.append($o.toString(o.getOrdinate(w,j)))}return _.append(")"),_.toString()}},Ca.ensureValidRing=function(o,s){var d=s.size();return d===0?s:d<=3?Ca.createClosedRing(o,s,4):s.getOrdinate(0,Ut.X)===s.getOrdinate(d-1,Ut.X)&&s.getOrdinate(0,Ut.Y)===s.getOrdinate(d-1,Ut.Y)?s:Ca.createClosedRing(o,s,d+1)},Ca.createClosedRing=function(o,s,d){var _=o.create(d,s.getDimension()),w=s.size();Ca.copy(s,0,_,0,w);for(var j=w;j<d;j++)Ca.copy(s,0,_,j,1);return _};var xa=function(o){function s(_,w){o.call(this,w),this._points=null,this.init(_)}o&&(s.__proto__=o),(s.prototype=Object.create(o&&o.prototype)).constructor=s;var d={serialVersionUID:{configurable:!0}};return s.prototype.computeEnvelopeInternal=function(){return this.isEmpty()?new xr:this._points.expandEnvelope(new xr)},s.prototype.isRing=function(){return this.isClosed()&&this.isSimple()},s.prototype.getSortIndex=function(){return o.SORTINDEX_LINESTRING},s.prototype.getCoordinates=function(){return this._points.toCoordinateArray()},s.prototype.equalsExact=function(){if(arguments.length===2){var _=arguments[0],w=arguments[1];if(!this.isEquivalentClass(_))return!1;var j=_;if(this._points.size()!==j._points.size())return!1;for(var ie=0;ie<this._points.size();ie++)if(!this.equal(this._points.getCoordinate(ie),j._points.getCoordinate(ie),w))return!1;return!0}return o.prototype.equalsExact.apply(this,arguments)},s.prototype.normalize=function(){for(var _=0;_<Math.trunc(this._points.size()/2);_++){var w=this._points.size()-1-_;if(!this._points.getCoordinate(_).equals(this._points.getCoordinate(w)))return this._points.getCoordinate(_).compareTo(this._points.getCoordinate(w))>0&&Ca.reverse(this._points),null}},s.prototype.getCoordinate=function(){return this.isEmpty()?null:this._points.getCoordinate(0)},s.prototype.getBoundaryDimension=function(){return this.isClosed()?Zi.FALSE:0},s.prototype.isClosed=function(){return!this.isEmpty()&&this.getCoordinateN(0).equals2D(this.getCoordinateN(this.getNumPoints()-1))},s.prototype.getEndPoint=function(){return this.isEmpty()?null:this.getPointN(this.getNumPoints()-1)},s.prototype.getDimension=function(){return 1},s.prototype.getLength=function(){return wt.computeLength(this._points)},s.prototype.getNumPoints=function(){return this._points.size()},s.prototype.reverse=function(){var _=this._points.copy();return Ca.reverse(_),this.getFactory().createLineString(_)},s.prototype.compareToSameClass=function(){if(arguments.length===1){for(var _=arguments[0],w=0,j=0;w<this._points.size()&&j<_._points.size();){var ie=this._points.getCoordinate(w).compareTo(_._points.getCoordinate(j));if(ie!==0)return ie;w++,j++}return w<this._points.size()?1:j<_._points.size()?-1:0}if(arguments.length===2){var ke=arguments[0];return arguments[1].compare(this._points,ke._points)}},s.prototype.apply=function(){if(Le(arguments[0],Dr))for(var _=arguments[0],w=0;w<this._points.size();w++)_.filter(this._points.getCoordinate(w));else if(Le(arguments[0],es)){var j=arguments[0];if(this._points.size()===0)return null;for(var ie=0;ie<this._points.size()&&(j.filter(this._points,ie),!j.isDone());ie++);j.isGeometryChanged()&&this.geometryChanged()}else Le(arguments[0],no)?arguments[0].filter(this):Le(arguments[0],vt)&&arguments[0].filter(this)},s.prototype.getBoundary=function(){return new io(this).getBoundary()},s.prototype.isEquivalentClass=function(_){return _ instanceof s},s.prototype.clone=function(){var _=o.prototype.clone.call(this);return _._points=this._points.clone(),_},s.prototype.getCoordinateN=function(_){return this._points.getCoordinate(_)},s.prototype.getGeometryType=function(){return"LineString"},s.prototype.copy=function(){return new s(this._points.copy(),this._factory)},s.prototype.getCoordinateSequence=function(){return this._points},s.prototype.isEmpty=function(){return this._points.size()===0},s.prototype.init=function(_){if(_===null&&(_=this.getFactory().getCoordinateSequenceFactory().create([])),_.size()===1)throw new we("Invalid number of points in LineString (found "+_.size()+" - must be 0 or >= 2)");this._points=_},s.prototype.isCoordinate=function(_){for(var w=0;w<this._points.size();w++)if(this._points.getCoordinate(w).equals(_))return!0;return!1},s.prototype.getStartPoint=function(){return this.isEmpty()?null:this.getPointN(0)},s.prototype.getPointN=function(_){return this.getFactory().createPoint(this._points.getCoordinate(_))},s.prototype.interfaces_=function(){return[Ou]},s.prototype.getClass=function(){return s},d.serialVersionUID.get=function(){return 0x2b2b51ba435c8e00},Object.defineProperties(s,d),s}(Tt),Ku=function(){};Ku.prototype.interfaces_=function(){return[]},Ku.prototype.getClass=function(){return Ku};var uo=function(o){function s(_,w){o.call(this,w),this._coordinates=_||null,this.init(this._coordinates)}o&&(s.__proto__=o),(s.prototype=Object.create(o&&o.prototype)).constructor=s;var d={serialVersionUID:{configurable:!0}};return s.prototype.computeEnvelopeInternal=function(){if(this.isEmpty())return new xr;var _=new xr;return _.expandToInclude(this._coordinates.getX(0),this._coordinates.getY(0)),_},s.prototype.getSortIndex=function(){return o.SORTINDEX_POINT},s.prototype.getCoordinates=function(){return this.isEmpty()?[]:[this.getCoordinate()]},s.prototype.equalsExact=function(){if(arguments.length===2){var _=arguments[0],w=arguments[1];return!!this.isEquivalentClass(_)&&(!(!this.isEmpty()||!_.isEmpty())||this.isEmpty()===_.isEmpty()&&this.equal(_.getCoordinate(),this.getCoordinate(),w))}return o.prototype.equalsExact.apply(this,arguments)},s.prototype.normalize=function(){},s.prototype.getCoordinate=function(){return this._coordinates.size()!==0?this._coordinates.getCoordinate(0):null},s.prototype.getBoundaryDimension=function(){return Zi.FALSE},s.prototype.getDimension=function(){return 0},s.prototype.getNumPoints=function(){return this.isEmpty()?0:1},s.prototype.reverse=function(){return this.copy()},s.prototype.getX=function(){if(this.getCoordinate()===null)throw new Error("getX called on empty Point");return this.getCoordinate().x},s.prototype.compareToSameClass=function(){if(arguments.length===1){var _=arguments[0];return this.getCoordinate().compareTo(_.getCoordinate())}if(arguments.length===2){var w=arguments[0];return arguments[1].compare(this._coordinates,w._coordinates)}},s.prototype.apply=function(){if(Le(arguments[0],Dr)){var _=arguments[0];if(this.isEmpty())return null;_.filter(this.getCoordinate())}else if(Le(arguments[0],es)){var w=arguments[0];if(this.isEmpty())return null;w.filter(this._coordinates,0),w.isGeometryChanged()&&this.geometryChanged()}else Le(arguments[0],no)?arguments[0].filter(this):Le(arguments[0],vt)&&arguments[0].filter(this)},s.prototype.getBoundary=function(){return this.getFactory().createGeometryCollection(null)},s.prototype.clone=function(){var _=o.prototype.clone.call(this);return _._coordinates=this._coordinates.clone(),_},s.prototype.getGeometryType=function(){return"Point"},s.prototype.copy=function(){return new s(this._coordinates.copy(),this._factory)},s.prototype.getCoordinateSequence=function(){return this._coordinates},s.prototype.getY=function(){if(this.getCoordinate()===null)throw new Error("getY called on empty Point");return this.getCoordinate().y},s.prototype.isEmpty=function(){return this._coordinates.size()===0},s.prototype.init=function(_){_===null&&(_=this.getFactory().getCoordinateSequenceFactory().create([])),Lt.isTrue(_.size()<=1),this._coordinates=_},s.prototype.isSimple=function(){return!0},s.prototype.interfaces_=function(){return[Ku]},s.prototype.getClass=function(){return s},d.serialVersionUID.get=function(){return 4902022702746615e3},Object.defineProperties(s,d),s}(Tt),eu=function(){};eu.prototype.interfaces_=function(){return[]},eu.prototype.getClass=function(){return eu};var wa=function(o){function s(_,w,j){if(o.call(this,j),this._shell=null,this._holes=null,_===null&&(_=this.getFactory().createLinearRing()),w===null&&(w=[]),o.hasNullElements(w))throw new we("holes must not contain null elements");if(_.isEmpty()&&o.hasNonEmptyElements(w))throw new we("shell is empty but holes are not");this._shell=_,this._holes=w}o&&(s.__proto__=o),(s.prototype=Object.create(o&&o.prototype)).constructor=s;var d={serialVersionUID:{configurable:!0}};return s.prototype.computeEnvelopeInternal=function(){return this._shell.getEnvelopeInternal()},s.prototype.getSortIndex=function(){return o.SORTINDEX_POLYGON},s.prototype.getCoordinates=function(){if(this.isEmpty())return[];for(var _=new Array(this.getNumPoints()).fill(null),w=-1,j=this._shell.getCoordinates(),ie=0;ie<j.length;ie++)_[++w]=j[ie];for(var ke=0;ke<this._holes.length;ke++)for(var tt=this._holes[ke].getCoordinates(),Pt=0;Pt<tt.length;Pt++)_[++w]=tt[Pt];return _},s.prototype.getArea=function(){var _=0;_+=Math.abs(wt.signedArea(this._shell.getCoordinateSequence()));for(var w=0;w<this._holes.length;w++)_-=Math.abs(wt.signedArea(this._holes[w].getCoordinateSequence()));return _},s.prototype.isRectangle=function(){if(this.getNumInteriorRing()!==0||this._shell===null||this._shell.getNumPoints()!==5)return!1;for(var _=this._shell.getCoordinateSequence(),w=this.getEnvelopeInternal(),j=0;j<5;j++){var ie=_.getX(j);if(ie!==w.getMinX()&&ie!==w.getMaxX())return!1;var ke=_.getY(j);if(ke!==w.getMinY()&&ke!==w.getMaxY())return!1}for(var tt=_.getX(0),Pt=_.getY(0),tr=1;tr<=4;tr++){var st=_.getX(tr),Zt=_.getY(tr);if(st!==tt==(Zt!==Pt))return!1;tt=st,Pt=Zt}return!0},s.prototype.equalsExact=function(){if(arguments.length===2){var _=arguments[0],w=arguments[1];if(!this.isEquivalentClass(_))return!1;var j=_,ie=this._shell,ke=j._shell;if(!ie.equalsExact(ke,w)||this._holes.length!==j._holes.length)return!1;for(var tt=0;tt<this._holes.length;tt++)if(!this._holes[tt].equalsExact(j._holes[tt],w))return!1;return!0}return o.prototype.equalsExact.apply(this,arguments)},s.prototype.normalize=function(){if(arguments.length===0){this.normalize(this._shell,!0);for(var _=0;_<this._holes.length;_++)this.normalize(this._holes[_],!1);ga.sort(this._holes)}else if(arguments.length===2){var w=arguments[0],j=arguments[1];if(w.isEmpty())return null;var ie=new Array(w.getCoordinates().length-1).fill(null);Qr.arraycopy(w.getCoordinates(),0,ie,0,ie.length);var ke=_n.minCoordinate(w.getCoordinates());_n.scroll(ie,ke),Qr.arraycopy(ie,0,w.getCoordinates(),0,ie.length),w.getCoordinates()[ie.length]=ie[0],wt.isCCW(w.getCoordinates())===j&&_n.reverse(w.getCoordinates())}},s.prototype.getCoordinate=function(){return this._shell.getCoordinate()},s.prototype.getNumInteriorRing=function(){return this._holes.length},s.prototype.getBoundaryDimension=function(){return 1},s.prototype.getDimension=function(){return 2},s.prototype.getLength=function(){var _=0;_+=this._shell.getLength();for(var w=0;w<this._holes.length;w++)_+=this._holes[w].getLength();return _},s.prototype.getNumPoints=function(){for(var _=this._shell.getNumPoints(),w=0;w<this._holes.length;w++)_+=this._holes[w].getNumPoints();return _},s.prototype.reverse=function(){var _=this.copy();_._shell=this._shell.copy().reverse(),_._holes=new Array(this._holes.length).fill(null);for(var w=0;w<this._holes.length;w++)_._holes[w]=this._holes[w].copy().reverse();return _},s.prototype.convexHull=function(){return this.getExteriorRing().convexHull()},s.prototype.compareToSameClass=function(){if(arguments.length===1){var _=arguments[0],w=this._shell,j=_._shell;return w.compareToSameClass(j)}if(arguments.length===2){var ie=arguments[0],ke=arguments[1],tt=ie,Pt=this._shell,tr=tt._shell,st=Pt.compareToSameClass(tr,ke);if(st!==0)return st;for(var Zt=this.getNumInteriorRing(),Jt=tt.getNumInteriorRing(),yr=0;yr<Zt&&yr<Jt;){var v=this.getInteriorRingN(yr),Pn=tt.getInteriorRingN(yr),jn=v.compareToSameClass(Pn,ke);if(jn!==0)return jn;yr++}return yr<Zt?1:yr<Jt?-1:0}},s.prototype.apply=function(_){if(Le(_,Dr)){this._shell.apply(_);for(var w=0;w<this._holes.length;w++)this._holes[w].apply(_)}else if(Le(_,es)){if(this._shell.apply(_),!_.isDone())for(var j=0;j<this._holes.length&&(this._holes[j].apply(_),!_.isDone());j++);_.isGeometryChanged()&&this.geometryChanged()}else if(Le(_,no))_.filter(this);else if(Le(_,vt)){_.filter(this),this._shell.apply(_);for(var ie=0;ie<this._holes.length;ie++)this._holes[ie].apply(_)}},s.prototype.getBoundary=function(){if(this.isEmpty())return this.getFactory().createMultiLineString();var _=new Array(this._holes.length+1).fill(null);_[0]=this._shell;for(var w=0;w<this._holes.length;w++)_[w+1]=this._holes[w];return _.length<=1?this.getFactory().createLinearRing(_[0].getCoordinateSequence()):this.getFactory().createMultiLineString(_)},s.prototype.clone=function(){var _=o.prototype.clone.call(this);_._shell=this._shell.clone(),_._holes=new Array(this._holes.length).fill(null);for(var w=0;w<this._holes.length;w++)_._holes[w]=this._holes[w].clone();return _},s.prototype.getGeometryType=function(){return"Polygon"},s.prototype.copy=function(){for(var _=this._shell.copy(),w=new Array(this._holes.length).fill(null),j=0;j<w.length;j++)w[j]=this._holes[j].copy();return new s(_,w,this._factory)},s.prototype.getExteriorRing=function(){return this._shell},s.prototype.isEmpty=function(){return this._shell.isEmpty()},s.prototype.getInteriorRingN=function(_){return this._holes[_]},s.prototype.interfaces_=function(){return[eu]},s.prototype.getClass=function(){return s},d.serialVersionUID.get=function(){return-0x307ffefd8dc97200},Object.defineProperties(s,d),s}(Tt),lu=function(o){function s(){o.apply(this,arguments)}o&&(s.__proto__=o),(s.prototype=Object.create(o&&o.prototype)).constructor=s;var d={serialVersionUID:{configurable:!0}};return s.prototype.getSortIndex=function(){return Tt.SORTINDEX_MULTIPOINT},s.prototype.isValid=function(){return!0},s.prototype.equalsExact=function(){if(arguments.length===2){var _=arguments[0],w=arguments[1];return!!this.isEquivalentClass(_)&&o.prototype.equalsExact.call(this,_,w)}return o.prototype.equalsExact.apply(this,arguments)},s.prototype.getCoordinate=function(){if(arguments.length===1){var _=arguments[0];return this._geometries[_].getCoordinate()}return o.prototype.getCoordinate.apply(this,arguments)},s.prototype.getBoundaryDimension=function(){return Zi.FALSE},s.prototype.getDimension=function(){return 0},s.prototype.getBoundary=function(){return this.getFactory().createGeometryCollection(null)},s.prototype.getGeometryType=function(){return"MultiPoint"},s.prototype.copy=function(){for(var _=new Array(this._geometries.length).fill(null),w=0;w<_.length;w++)_[w]=this._geometries[w].copy();return new s(_,this._factory)},s.prototype.interfaces_=function(){return[Ku]},s.prototype.getClass=function(){return s},d.serialVersionUID.get=function(){return-8048474874175356e3},Object.defineProperties(s,d),s}(Lo),pr=function(o){function s(_,w){_ instanceof Y&&w instanceof Ai&&(_=w.getCoordinateSequenceFactory().create(_)),o.call(this,_,w),this.validateConstruction()}o&&(s.__proto__=o),(s.prototype=Object.create(o&&o.prototype)).constructor=s;var d={MINIMUM_VALID_SIZE:{configurable:!0},serialVersionUID:{configurable:!0}};return s.prototype.getSortIndex=function(){return Tt.SORTINDEX_LINEARRING},s.prototype.getBoundaryDimension=function(){return Zi.FALSE},s.prototype.isClosed=function(){return!!this.isEmpty()||o.prototype.isClosed.call(this)},s.prototype.reverse=function(){var _=this._points.copy();return Ca.reverse(_),this.getFactory().createLinearRing(_)},s.prototype.validateConstruction=function(){if(!this.isEmpty()&&!o.prototype.isClosed.call(this))throw new we("Points of LinearRing do not form a closed linestring");if(this.getCoordinateSequence().size()>=1&&this.getCoordinateSequence().size()<s.MINIMUM_VALID_SIZE)throw new we("Invalid number of points in LinearRing (found "+this.getCoordinateSequence().size()+" - must be 0 or >= 4)")},s.prototype.getGeometryType=function(){return"LinearRing"},s.prototype.copy=function(){return new s(this._points.copy(),this._factory)},s.prototype.interfaces_=function(){return[]},s.prototype.getClass=function(){return s},d.MINIMUM_VALID_SIZE.get=function(){return 4},d.serialVersionUID.get=function(){return-0x3b229e262367a600},Object.defineProperties(s,d),s}(xa),vn=function(o){function s(){o.apply(this,arguments)}o&&(s.__proto__=o),(s.prototype=Object.create(o&&o.prototype)).constructor=s;var d={serialVersionUID:{configurable:!0}};return s.prototype.getSortIndex=function(){return Tt.SORTINDEX_MULTIPOLYGON},s.prototype.equalsExact=function(){if(arguments.length===2){var _=arguments[0],w=arguments[1];return!!this.isEquivalentClass(_)&&o.prototype.equalsExact.call(this,_,w)}return o.prototype.equalsExact.apply(this,arguments)},s.prototype.getBoundaryDimension=function(){return 1},s.prototype.getDimension=function(){return 2},s.prototype.reverse=function(){for(var _=this._geometries.length,w=new Array(_).fill(null),j=0;j<this._geometries.length;j++)w[j]=this._geometries[j].reverse();return this.getFactory().createMultiPolygon(w)},s.prototype.getBoundary=function(){if(this.isEmpty())return this.getFactory().createMultiLineString();for(var _=new Gr,w=0;w<this._geometries.length;w++)for(var j=this._geometries[w].getBoundary(),ie=0;ie<j.getNumGeometries();ie++)_.add(j.getGeometryN(ie));var ke=new Array(_.size()).fill(null);return this.getFactory().createMultiLineString(_.toArray(ke))},s.prototype.getGeometryType=function(){return"MultiPolygon"},s.prototype.copy=function(){for(var _=new Array(this._geometries.length).fill(null),w=0;w<_.length;w++)_[w]=this._geometries[w].copy();return new s(_,this._factory)},s.prototype.interfaces_=function(){return[eu]},s.prototype.getClass=function(){return s},d.serialVersionUID.get=function(){return-0x7a5aa1369171980},Object.defineProperties(s,d),s}(Lo),lo=function(o){this._factory=o||null,this._isUserDataCopied=!1},tu={NoOpGeometryOperation:{configurable:!0},CoordinateOperation:{configurable:!0},CoordinateSequenceOperation:{configurable:!0}};lo.prototype.setCopyUserData=function(o){this._isUserDataCopied=o},lo.prototype.edit=function(o,s){if(o===null)return null;var d=this.editInternal(o,s);return this._isUserDataCopied&&d.setUserData(o.getUserData()),d},lo.prototype.editInternal=function(o,s){return this._factory===null&&(this._factory=o.getFactory()),o instanceof Lo?this.editGeometryCollection(o,s):o instanceof wa?this.editPolygon(o,s):o instanceof uo?s.edit(o,this._factory):o instanceof xa?s.edit(o,this._factory):(Lt.shouldNeverReachHere("Unsupported Geometry class: "+o.getClass().getName()),null)},lo.prototype.editGeometryCollection=function(o,s){for(var d=s.edit(o,this._factory),_=new Gr,w=0;w<d.getNumGeometries();w++){var j=this.edit(d.getGeometryN(w),s);j===null||j.isEmpty()||_.add(j)}return d.getClass()===lu?this._factory.createMultiPoint(_.toArray([])):d.getClass()===Ni?this._factory.createMultiLineString(_.toArray([])):d.getClass()===vn?this._factory.createMultiPolygon(_.toArray([])):this._factory.createGeometryCollection(_.toArray([]))},lo.prototype.editPolygon=function(o,s){var d=s.edit(o,this._factory);if(d===null&&(d=this._factory.createPolygon(null)),d.isEmpty())return d;var _=this.edit(d.getExteriorRing(),s);if(_===null||_.isEmpty())return this._factory.createPolygon();for(var w=new Gr,j=0;j<d.getNumInteriorRing();j++){var ie=this.edit(d.getInteriorRingN(j),s);ie===null||ie.isEmpty()||w.add(ie)}return this._factory.createPolygon(_,w.toArray([]))},lo.prototype.interfaces_=function(){return[]},lo.prototype.getClass=function(){return lo},lo.GeometryEditorOperation=function(){},tu.NoOpGeometryOperation.get=function(){return ru},tu.CoordinateOperation.get=function(){return Ss},tu.CoordinateSequenceOperation.get=function(){return Zs},Object.defineProperties(lo,tu);var ru=function(){};ru.prototype.edit=function(o,s){return o},ru.prototype.interfaces_=function(){return[lo.GeometryEditorOperation]},ru.prototype.getClass=function(){return ru};var Ss=function(){};Ss.prototype.edit=function(o,s){var d=this.editCoordinates(o.getCoordinates(),o);return d===null?o:o instanceof pr?s.createLinearRing(d):o instanceof xa?s.createLineString(d):o instanceof uo?d.length>0?s.createPoint(d[0]):s.createPoint():o},Ss.prototype.interfaces_=function(){return[lo.GeometryEditorOperation]},Ss.prototype.getClass=function(){return Ss};var Zs=function(){};Zs.prototype.edit=function(o,s){return o instanceof pr?s.createLinearRing(this.edit(o.getCoordinateSequence(),o)):o instanceof xa?s.createLineString(this.edit(o.getCoordinateSequence(),o)):o instanceof uo?s.createPoint(this.edit(o.getCoordinateSequence(),o)):o},Zs.prototype.interfaces_=function(){return[lo.GeometryEditorOperation]},Zs.prototype.getClass=function(){return Zs};var Va=function(){if(this._dimension=3,this._coordinates=null,arguments.length===1){if(arguments[0]instanceof Array)this._coordinates=arguments[0],this._dimension=3;else if(Number.isInteger(arguments[0])){var o=arguments[0];this._coordinates=new Array(o).fill(null);for(var s=0;s<o;s++)this._coordinates[s]=new Y}else if(Le(arguments[0],Ut)){var d=arguments[0];if(d===null)return this._coordinates=new Array(0).fill(null),null;this._dimension=d.getDimension(),this._coordinates=new Array(d.size()).fill(null);for(var _=0;_<this._coordinates.length;_++)this._coordinates[_]=d.getCoordinateCopy(_)}}else if(arguments.length===2){if(arguments[0]instanceof Array&&Number.isInteger(arguments[1])){var w=arguments[0],j=arguments[1];this._coordinates=w,this._dimension=j,w===null&&(this._coordinates=new Array(0).fill(null))}else if(Number.isInteger(arguments[0])&&Number.isInteger(arguments[1])){var ie=arguments[0],ke=arguments[1];this._coordinates=new Array(ie).fill(null),this._dimension=ke;for(var tt=0;tt<ie;tt++)this._coordinates[tt]=new Y}}},Xc={serialVersionUID:{configurable:!0}};Va.prototype.setOrdinate=function(o,s,d){switch(s){case Ut.X:this._coordinates[o].x=d;break;case Ut.Y:this._coordinates[o].y=d;break;case Ut.Z:this._coordinates[o].z=d;break;default:throw new we("invalid ordinateIndex")}},Va.prototype.size=function(){return this._coordinates.length},Va.prototype.getOrdinate=function(o,s){switch(s){case Ut.X:return this._coordinates[o].x;case Ut.Y:return this._coordinates[o].y;case Ut.Z:return this._coordinates[o].z}return ne.NaN},Va.prototype.getCoordinate=function(){if(arguments.length===1){var o=arguments[0];return this._coordinates[o]}if(arguments.length===2){var s=arguments[0],d=arguments[1];d.x=this._coordinates[s].x,d.y=this._coordinates[s].y,d.z=this._coordinates[s].z}},Va.prototype.getCoordinateCopy=function(o){return new Y(this._coordinates[o])},Va.prototype.getDimension=function(){return this._dimension},Va.prototype.getX=function(o){return this._coordinates[o].x},Va.prototype.clone=function(){for(var o=new Array(this.size()).fill(null),s=0;s<this._coordinates.length;s++)o[s]=this._coordinates[s].clone();return new Va(o,this._dimension)},Va.prototype.expandEnvelope=function(o){for(var s=0;s<this._coordinates.length;s++)o.expandToInclude(this._coordinates[s]);return o},Va.prototype.copy=function(){for(var o=new Array(this.size()).fill(null),s=0;s<this._coordinates.length;s++)o[s]=this._coordinates[s].copy();return new Va(o,this._dimension)},Va.prototype.toString=function(){if(this._coordinates.length>0){var o=new se(17*this._coordinates.length);o.append("("),o.append(this._coordinates[0]);for(var s=1;s<this._coordinates.length;s++)o.append(", "),o.append(this._coordinates[s]);return o.append(")"),o.toString()}return"()"},Va.prototype.getY=function(o){return this._coordinates[o].y},Va.prototype.toCoordinateArray=function(){return this._coordinates},Va.prototype.interfaces_=function(){return[Ut,L]},Va.prototype.getClass=function(){return Va},Xc.serialVersionUID.get=function(){return-0xcb44a778db18e00},Object.defineProperties(Va,Xc);var Cs=function(){},ts={serialVersionUID:{configurable:!0},instanceObject:{configurable:!0}};Cs.prototype.readResolve=function(){return Cs.instance()},Cs.prototype.create=function(){if(arguments.length===1){if(arguments[0]instanceof Array){var o=arguments[0];return new Va(o)}if(Le(arguments[0],Ut)){var s=arguments[0];return new Va(s)}}else if(arguments.length===2){var d=arguments[0],_=arguments[1];return _>3&&(_=3),_<2?new Va(d):new Va(d,_)}},Cs.prototype.interfaces_=function(){return[ye,L]},Cs.prototype.getClass=function(){return Cs},Cs.instance=function(){return Cs.instanceObject},ts.serialVersionUID.get=function(){return-0x38e49fa6cf6f2e00},ts.instanceObject.get=function(){return new Cs},Object.defineProperties(Cs,ts);var Pl=function(o){function s(){o.call(this),this.map_=new Map}return o&&(s.__proto__=o),s.prototype=Object.create(o&&o.prototype),s.prototype.constructor=s,s.prototype.get=function(d){return this.map_.get(d)||null},s.prototype.put=function(d,_){return this.map_.set(d,_),_},s.prototype.values=function(){for(var d=new Gr,_=this.map_.values(),w=_.next();!w.done;)d.add(w.value),w=_.next();return d},s.prototype.entrySet=function(){var d=new yu;return this.map_.entries().forEach(function(_){return d.add(_)}),d},s.prototype.size=function(){return this.map_.size()},s}(Po),zi=function o(){if(this._modelType=null,this._scale=null,arguments.length===0)this._modelType=o.FLOATING;else if(arguments.length===1){if(arguments[0]instanceof Oo){var s=arguments[0];this._modelType=s,s===o.FIXED&&this.setScale(1)}else if(typeof arguments[0]=="number"){var d=arguments[0];this._modelType=o.FIXED,this.setScale(d)}else if(arguments[0]instanceof o){var _=arguments[0];this._modelType=_._modelType,this._scale=_._scale}}},Ll={serialVersionUID:{configurable:!0},maximumPreciseValue:{configurable:!0}};zi.prototype.equals=function(o){if(!(o instanceof zi))return!1;var s=o;return this._modelType===s._modelType&&this._scale===s._scale},zi.prototype.compareTo=function(o){var s=o,d=this.getMaximumSignificantDigits(),_=s.getMaximumSignificantDigits();return new Ne(d).compareTo(new Ne(_))},zi.prototype.getScale=function(){return this._scale},zi.prototype.isFloating=function(){return this._modelType===zi.FLOATING||this._modelType===zi.FLOATING_SINGLE},zi.prototype.getType=function(){return this._modelType},zi.prototype.toString=function(){var o="UNKNOWN";return this._modelType===zi.FLOATING?o="Floating":this._modelType===zi.FLOATING_SINGLE?o="Floating-Single":this._modelType===zi.FIXED&&(o="Fixed (Scale="+this.getScale()+")"),o},zi.prototype.makePrecise=function(){if(typeof arguments[0]=="number"){var o=arguments[0];return ne.isNaN(o)||this._modelType===zi.FLOATING_SINGLE?o:this._modelType===zi.FIXED?Math.round(o*this._scale)/this._scale:o}if(arguments[0]instanceof Y){var s=arguments[0];if(this._modelType===zi.FLOATING)return null;s.x=this.makePrecise(s.x),s.y=this.makePrecise(s.y)}},zi.prototype.getMaximumSignificantDigits=function(){var o=16;return this._modelType===zi.FLOATING?o=16:this._modelType===zi.FLOATING_SINGLE?o=6:this._modelType===zi.FIXED&&(o=1+Math.trunc(Math.ceil(Math.log(this.getScale())/Math.log(10)))),o},zi.prototype.setScale=function(o){this._scale=Math.abs(o)},zi.prototype.interfaces_=function(){return[L,he]},zi.prototype.getClass=function(){return zi},zi.mostPrecise=function(o,s){return o.compareTo(s)>=0?o:s},Ll.serialVersionUID.get=function(){return 7777263578777804e3},Ll.maximumPreciseValue.get=function(){return 9007199254740992},Object.defineProperties(zi,Ll);var Oo=function o(s){this._name=s||null,o.nameToTypeMap.put(s,this)},pl={serialVersionUID:{configurable:!0},nameToTypeMap:{configurable:!0}};Oo.prototype.readResolve=function(){return Oo.nameToTypeMap.get(this._name)},Oo.prototype.toString=function(){return this._name},Oo.prototype.interfaces_=function(){return[L]},Oo.prototype.getClass=function(){return Oo},pl.serialVersionUID.get=function(){return-552860263173159e4},pl.nameToTypeMap.get=function(){return new Pl},Object.defineProperties(Oo,pl),zi.Type=Oo,zi.FIXED=new Oo("FIXED"),zi.FLOATING=new Oo("FLOATING"),zi.FLOATING_SINGLE=new Oo("FLOATING SINGLE");var Ai=function o(){this._precisionModel=new zi,this._SRID=0,this._coordinateSequenceFactory=o.getDefaultCoordinateSequenceFactory(),arguments.length===0||(arguments.length===1?Le(arguments[0],ye)?this._coordinateSequenceFactory=arguments[0]:arguments[0]instanceof zi&&(this._precisionModel=arguments[0]):arguments.length===2?(this._precisionModel=arguments[0],this._SRID=arguments[1]):arguments.length===3&&(this._precisionModel=arguments[0],this._SRID=arguments[1],this._coordinateSequenceFactory=arguments[2]))},_u={serialVersionUID:{configurable:!0}};Ai.prototype.toGeometry=function(o){return o.isNull()?this.createPoint(null):o.getMinX()===o.getMaxX()&&o.getMinY()===o.getMaxY()?this.createPoint(new Y(o.getMinX(),o.getMinY())):o.getMinX()===o.getMaxX()||o.getMinY()===o.getMaxY()?this.createLineString([new Y(o.getMinX(),o.getMinY()),new Y(o.getMaxX(),o.getMaxY())]):this.createPolygon(this.createLinearRing([new Y(o.getMinX(),o.getMinY()),new Y(o.getMinX(),o.getMaxY()),new Y(o.getMaxX(),o.getMaxY()),new Y(o.getMaxX(),o.getMinY()),new Y(o.getMinX(),o.getMinY())]),null)},Ai.prototype.createLineString=function(o){return o?o instanceof Array?new xa(this.getCoordinateSequenceFactory().create(o),this):Le(o,Ut)?new xa(o,this):void 0:new xa(this.getCoordinateSequenceFactory().create([]),this)},Ai.prototype.createMultiLineString=function(){if(arguments.length===0)return new Ni(null,this);if(arguments.length===1){var o=arguments[0];return new Ni(o,this)}},Ai.prototype.buildGeometry=function(o){for(var s=null,d=!1,_=!1,w=o.iterator();w.hasNext();){var j=w.next(),ie=j.getClass();s===null&&(s=ie),ie!==s&&(d=!0),j.isGeometryCollectionOrDerived()&&(_=!0)}if(s===null)return this.createGeometryCollection();if(d||_)return this.createGeometryCollection(Ai.toGeometryArray(o));var ke=o.iterator().next();if(o.size()>1){if(ke instanceof wa)return this.createMultiPolygon(Ai.toPolygonArray(o));if(ke instanceof xa)return this.createMultiLineString(Ai.toLineStringArray(o));if(ke instanceof uo)return this.createMultiPoint(Ai.toPointArray(o));Lt.shouldNeverReachHere("Unhandled class: "+ke.getClass().getName())}return ke},Ai.prototype.createMultiPointFromCoords=function(o){return this.createMultiPoint(o!==null?this.getCoordinateSequenceFactory().create(o):null)},Ai.prototype.createPoint=function(){if(arguments.length===0)return this.createPoint(this.getCoordinateSequenceFactory().create([]));if(arguments.length===1){if(arguments[0]instanceof Y){var o=arguments[0];return this.createPoint(o!==null?this.getCoordinateSequenceFactory().create([o]):null)}if(Le(arguments[0],Ut)){var s=arguments[0];return new uo(s,this)}}},Ai.prototype.getCoordinateSequenceFactory=function(){return this._coordinateSequenceFactory},Ai.prototype.createPolygon=function(){if(arguments.length===0)return new wa(null,null,this);if(arguments.length===1){if(Le(arguments[0],Ut)){var o=arguments[0];return this.createPolygon(this.createLinearRing(o))}if(arguments[0]instanceof Array){var s=arguments[0];return this.createPolygon(this.createLinearRing(s))}if(arguments[0]instanceof pr){var d=arguments[0];return this.createPolygon(d,null)}}else if(arguments.length===2){var _=arguments[0],w=arguments[1];return new wa(_,w,this)}},Ai.prototype.getSRID=function(){return this._SRID},Ai.prototype.createGeometryCollection=function(){if(arguments.length===0)return new Lo(null,this);if(arguments.length===1){var o=arguments[0];return new Lo(o,this)}},Ai.prototype.createGeometry=function(o){return new lo(this).edit(o,{edit:function(){if(arguments.length===2){var s=arguments[0];return this._coordinateSequenceFactory.create(s)}}})},Ai.prototype.getPrecisionModel=function(){return this._precisionModel},Ai.prototype.createLinearRing=function(){if(arguments.length===0)return this.createLinearRing(this.getCoordinateSequenceFactory().create([]));if(arguments.length===1){if(arguments[0]instanceof Array){var o=arguments[0];return this.createLinearRing(o!==null?this.getCoordinateSequenceFactory().create(o):null)}if(Le(arguments[0],Ut)){var s=arguments[0];return new pr(s,this)}}},Ai.prototype.createMultiPolygon=function(){if(arguments.length===0)return new vn(null,this);if(arguments.length===1){var o=arguments[0];return new vn(o,this)}},Ai.prototype.createMultiPoint=function(){if(arguments.length===0)return new lu(null,this);if(arguments.length===1){if(arguments[0]instanceof Array){var o=arguments[0];return new lu(o,this)}if(arguments[0]instanceof Array){var s=arguments[0];return this.createMultiPoint(s!==null?this.getCoordinateSequenceFactory().create(s):null)}if(Le(arguments[0],Ut)){var d=arguments[0];if(d===null)return this.createMultiPoint(new Array(0).fill(null));for(var _=new Array(d.size()).fill(null),w=0;w<d.size();w++){var j=this.getCoordinateSequenceFactory().create(1,d.getDimension());Ca.copy(d,w,j,0,1),_[w]=this.createPoint(j)}return this.createMultiPoint(_)}}},Ai.prototype.interfaces_=function(){return[L]},Ai.prototype.getClass=function(){return Ai},Ai.toMultiPolygonArray=function(o){var s=new Array(o.size()).fill(null);return o.toArray(s)},Ai.toGeometryArray=function(o){if(o===null)return null;var s=new Array(o.size()).fill(null);return o.toArray(s)},Ai.getDefaultCoordinateSequenceFactory=function(){return Cs.instance()},Ai.toMultiLineStringArray=function(o){var s=new Array(o.size()).fill(null);return o.toArray(s)},Ai.toLineStringArray=function(o){var s=new Array(o.size()).fill(null);return o.toArray(s)},Ai.toMultiPointArray=function(o){var s=new Array(o.size()).fill(null);return o.toArray(s)},Ai.toLinearRingArray=function(o){var s=new Array(o.size()).fill(null);return o.toArray(s)},Ai.toPointArray=function(o){var s=new Array(o.size()).fill(null);return o.toArray(s)},Ai.toPolygonArray=function(o){var s=new Array(o.size()).fill(null);return o.toArray(s)},Ai.createPointFromInternalCoord=function(o,s){return s.getPrecisionModel().makePrecise(o),s.getFactory().createPoint(o)},_u.serialVersionUID.get=function(){return-6820524753094096e3},Object.defineProperties(Ai,_u);var gf=["Point","MultiPoint","LineString","MultiLineString","Polygon","MultiPolygon"],Du=function(o){this.geometryFactory=o||new Ai};Du.prototype.read=function(o){var s,d=(s=typeof o=="string"?JSON.parse(o):o).type;if(!rs[d])throw new Error("Unknown GeoJSON type: "+s.type);return gf.indexOf(d)!==-1?rs[d].apply(this,[s.coordinates]):d==="GeometryCollection"?rs[d].apply(this,[s.geometries]):rs[d].apply(this,[s])},Du.prototype.write=function(o){var s=o.getGeometryType();if(!Mt[s])throw new Error("Geometry is not supported");return Mt[s].apply(this,[o])};var rs={Feature:function(o){var s={};for(var d in o)s[d]=o[d];if(o.geometry){var _=o.geometry.type;if(!rs[_])throw new Error("Unknown GeoJSON type: "+o.type);s.geometry=this.read(o.geometry)}return o.bbox&&(s.bbox=rs.bbox.apply(this,[o.bbox])),s},FeatureCollection:function(o){var s={};if(o.features){s.features=[];for(var d=0;d<o.features.length;++d)s.features.push(this.read(o.features[d]))}return o.bbox&&(s.bbox=this.parse.bbox.apply(this,[o.bbox])),s},coordinates:function(o){for(var s=[],d=0;d<o.length;++d){var _=o[d];s.push(new Y(_[0],_[1]))}return s},bbox:function(o){return this.geometryFactory.createLinearRing([new Y(o[0],o[1]),new Y(o[2],o[1]),new Y(o[2],o[3]),new Y(o[0],o[3]),new Y(o[0],o[1])])},Point:function(o){var s=new Y(o[0],o[1]);return this.geometryFactory.createPoint(s)},MultiPoint:function(o){for(var s=[],d=0;d<o.length;++d)s.push(rs.Point.apply(this,[o[d]]));return this.geometryFactory.createMultiPoint(s)},LineString:function(o){var s=rs.coordinates.apply(this,[o]);return this.geometryFactory.createLineString(s)},MultiLineString:function(o){for(var s=[],d=0;d<o.length;++d)s.push(rs.LineString.apply(this,[o[d]]));return this.geometryFactory.createMultiLineString(s)},Polygon:function(o){for(var s=rs.coordinates.apply(this,[o[0]]),d=this.geometryFactory.createLinearRing(s),_=[],w=1;w<o.length;++w){var j=o[w],ie=rs.coordinates.apply(this,[j]),ke=this.geometryFactory.createLinearRing(ie);_.push(ke)}return this.geometryFactory.createPolygon(d,_)},MultiPolygon:function(o){for(var s=[],d=0;d<o.length;++d){var _=o[d];s.push(rs.Polygon.apply(this,[_]))}return this.geometryFactory.createMultiPolygon(s)},GeometryCollection:function(o){for(var s=[],d=0;d<o.length;++d){var _=o[d];s.push(this.read(_))}return this.geometryFactory.createGeometryCollection(s)}},Mt={coordinate:function(o){return[o.x,o.y]},Point:function(o){return{type:"Point",coordinates:Mt.coordinate.apply(this,[o.getCoordinate()])}},MultiPoint:function(o){for(var s=[],d=0;d<o._geometries.length;++d){var _=o._geometries[d],w=Mt.Point.apply(this,[_]);s.push(w.coordinates)}return{type:"MultiPoint",coordinates:s}},LineString:function(o){for(var s=[],d=o.getCoordinates(),_=0;_<d.length;++_){var w=d[_];s.push(Mt.coordinate.apply(this,[w]))}return{type:"LineString",coordinates:s}},MultiLineString:function(o){for(var s=[],d=0;d<o._geometries.length;++d){var _=o._geometries[d],w=Mt.LineString.apply(this,[_]);s.push(w.coordinates)}return{type:"MultiLineString",coordinates:s}},Polygon:function(o){var s=[],d=Mt.LineString.apply(this,[o._shell]);s.push(d.coordinates);for(var _=0;_<o._holes.length;++_){var w=o._holes[_],j=Mt.LineString.apply(this,[w]);s.push(j.coordinates)}return{type:"Polygon",coordinates:s}},MultiPolygon:function(o){for(var s=[],d=0;d<o._geometries.length;++d){var _=o._geometries[d],w=Mt.Polygon.apply(this,[_]);s.push(w.coordinates)}return{type:"MultiPolygon",coordinates:s}},GeometryCollection:function(o){for(var s=[],d=0;d<o._geometries.length;++d){var _=o._geometries[d],w=_.getGeometryType();s.push(Mt[w].apply(this,[_]))}return{type:"GeometryCollection",geometries:s}}},He=function(o){this.geometryFactory=o||new Ai,this.precisionModel=this.geometryFactory.getPrecisionModel(),this.parser=new Du(this.geometryFactory)};He.prototype.read=function(o){var s=this.parser.read(o);return this.precisionModel.getType()===zi.FIXED&&this.reducePrecision(s),s},He.prototype.reducePrecision=function(o){var s,d;if(o.coordinate)this.precisionModel.makePrecise(o.coordinate);else if(o.points)for(s=0,d=o.points.length;s<d;s++)this.precisionModel.makePrecise(o.points[s]);else if(o.geometries)for(s=0,d=o.geometries.length;s<d;s++)this.reducePrecision(o.geometries[s])};var Gt=function(){this.parser=new Du(this.geometryFactory)};Gt.prototype.write=function(o){return this.parser.write(o)};var Ae=function(){},Be={ON:{configurable:!0},LEFT:{configurable:!0},RIGHT:{configurable:!0}};Ae.prototype.interfaces_=function(){return[]},Ae.prototype.getClass=function(){return Ae},Ae.opposite=function(o){return o===Ae.LEFT?Ae.RIGHT:o===Ae.RIGHT?Ae.LEFT:o},Be.ON.get=function(){return 0},Be.LEFT.get=function(){return 1},Be.RIGHT.get=function(){return 2},Object.defineProperties(Ae,Be),(Ee.prototype=new Error).name="EmptyStackException",(Ie.prototype=new Oa).add=function(o){return this.array_.push(o),!0},Ie.prototype.get=function(o){if(o<0||o>=this.size())throw new Error;return this.array_[o]},Ie.prototype.push=function(o){return this.array_.push(o),o},Ie.prototype.pop=function(o){if(this.array_.length===0)throw new Ee;return this.array_.pop()},Ie.prototype.peek=function(){if(this.array_.length===0)throw new Ee;return this.array_[this.array_.length-1]},Ie.prototype.empty=function(){return this.array_.length===0},Ie.prototype.isEmpty=function(){return this.empty()},Ie.prototype.search=function(o){return this.array_.indexOf(o)},Ie.prototype.size=function(){return this.array_.length},Ie.prototype.toArray=function(){for(var o=[],s=0,d=this.array_.length;s<d;s++)o.push(this.array_[s]);return o};var We=function(){this._minIndex=-1,this._minCoord=null,this._minDe=null,this._orientedDe=null};We.prototype.getCoordinate=function(){return this._minCoord},We.prototype.getRightmostSide=function(o,s){var d=this.getRightmostSideOfSegment(o,s);return d<0&&(d=this.getRightmostSideOfSegment(o,s-1)),d<0&&(this._minCoord=null,this.checkForRightmostCoordinate(o)),d},We.prototype.findRightmostEdgeAtVertex=function(){var o=this._minDe.getEdge().getCoordinates();Lt.isTrue(this._minIndex>0&&this._minIndex<o.length,"rightmost point expected to be interior vertex of edge");var s=o[this._minIndex-1],d=o[this._minIndex+1],_=wt.computeOrientation(this._minCoord,d,s),w=!1;(s.y<this._minCoord.y&&d.y<this._minCoord.y&&_===wt.COUNTERCLOCKWISE||s.y>this._minCoord.y&&d.y>this._minCoord.y&&_===wt.CLOCKWISE)&&(w=!0),w&&(this._minIndex=this._minIndex-1)},We.prototype.getRightmostSideOfSegment=function(o,s){var d=o.getEdge().getCoordinates();if(s<0||s+1>=d.length||d[s].y===d[s+1].y)return-1;var _=Ae.LEFT;return d[s].y<d[s+1].y&&(_=Ae.RIGHT),_},We.prototype.getEdge=function(){return this._orientedDe},We.prototype.checkForRightmostCoordinate=function(o){for(var s=o.getEdge().getCoordinates(),d=0;d<s.length-1;d++)(this._minCoord===null||s[d].x>this._minCoord.x)&&(this._minDe=o,this._minIndex=d,this._minCoord=s[d])},We.prototype.findRightmostEdgeAtNode=function(){var o=this._minDe.getNode().getEdges();this._minDe=o.getRightmostEdge(),this._minDe.isForward()||(this._minDe=this._minDe.getSym(),this._minIndex=this._minDe.getEdge().getCoordinates().length-1)},We.prototype.findEdge=function(o){for(var s=o.iterator();s.hasNext();){var d=s.next();d.isForward()&&this.checkForRightmostCoordinate(d)}Lt.isTrue(this._minIndex!==0||this._minCoord.equals(this._minDe.getCoordinate()),"inconsistency in rightmost processing"),this._minIndex===0?this.findRightmostEdgeAtNode():this.findRightmostEdgeAtVertex(),this._orientedDe=this._minDe,this.getRightmostSide(this._minDe,this._minIndex)===Ae.LEFT&&(this._orientedDe=this._minDe.getSym())},We.prototype.interfaces_=function(){return[]},We.prototype.getClass=function(){return We};var zt=function(o){function s(d,_){o.call(this,s.msgWithCoord(d,_)),this.pt=_?new Y(_):null,this.name="TopologyException"}return o&&(s.__proto__=o),s.prototype=Object.create(o&&o.prototype),s.prototype.constructor=s,s.prototype.getCoordinate=function(){return this.pt},s.prototype.interfaces_=function(){return[]},s.prototype.getClass=function(){return s},s.msgWithCoord=function(d,_){return _?d:d+" [ "+_+" ]"},s}(ki),hr=function(){this.array_=[]};hr.prototype.addLast=function(o){this.array_.push(o)},hr.prototype.removeFirst=function(){return this.array_.shift()},hr.prototype.isEmpty=function(){return this.array_.length===0};var Pr=function(){this._finder=null,this._dirEdgeList=new Gr,this._nodes=new Gr,this._rightMostCoord=null,this._env=null,this._finder=new We};Pr.prototype.clearVisitedEdges=function(){for(var o=this._dirEdgeList.iterator();o.hasNext();)o.next().setVisited(!1)},Pr.prototype.getRightmostCoordinate=function(){return this._rightMostCoord},Pr.prototype.computeNodeDepth=function(o){for(var s=null,d=o.getEdges().iterator();d.hasNext();){var _=d.next();if(_.isVisited()||_.getSym().isVisited()){s=_;break}}if(s===null)throw new zt("unable to find edge to compute depths at "+o.getCoordinate());o.getEdges().computeDepths(s);for(var w=o.getEdges().iterator();w.hasNext();){var j=w.next();j.setVisited(!0),this.copySymDepths(j)}},Pr.prototype.computeDepth=function(o){this.clearVisitedEdges();var s=this._finder.getEdge();s.setEdgeDepths(Ae.RIGHT,o),this.copySymDepths(s),this.computeDepths(s)},Pr.prototype.create=function(o){this.addReachable(o),this._finder.findEdge(this._dirEdgeList),this._rightMostCoord=this._finder.getCoordinate()},Pr.prototype.findResultEdges=function(){for(var o=this._dirEdgeList.iterator();o.hasNext();){var s=o.next();s.getDepth(Ae.RIGHT)>=1&&s.getDepth(Ae.LEFT)<=0&&!s.isInteriorAreaEdge()&&s.setInResult(!0)}},Pr.prototype.computeDepths=function(o){var s=new yu,d=new hr,_=o.getNode();for(d.addLast(_),s.add(_),o.setVisited(!0);!d.isEmpty();){var w=d.removeFirst();s.add(w),this.computeNodeDepth(w);for(var j=w.getEdges().iterator();j.hasNext();){var ie=j.next().getSym();if(!ie.isVisited()){var ke=ie.getNode();s.contains(ke)||(d.addLast(ke),s.add(ke))}}}},Pr.prototype.compareTo=function(o){var s=o;return this._rightMostCoord.x<s._rightMostCoord.x?-1:this._rightMostCoord.x>s._rightMostCoord.x?1:0},Pr.prototype.getEnvelope=function(){if(this._env===null){for(var o=new xr,s=this._dirEdgeList.iterator();s.hasNext();)for(var d=s.next().getEdge().getCoordinates(),_=0;_<d.length-1;_++)o.expandToInclude(d[_]);this._env=o}return this._env},Pr.prototype.addReachable=function(o){var s=new Ie;for(s.add(o);!s.empty();){var d=s.pop();this.add(d,s)}},Pr.prototype.copySymDepths=function(o){var s=o.getSym();s.setDepth(Ae.LEFT,o.getDepth(Ae.RIGHT)),s.setDepth(Ae.RIGHT,o.getDepth(Ae.LEFT))},Pr.prototype.add=function(o,s){o.setVisited(!0),this._nodes.add(o);for(var d=o.getEdges().iterator();d.hasNext();){var _=d.next();this._dirEdgeList.add(_);var w=_.getSym().getNode();w.isVisited()||s.push(w)}},Pr.prototype.getNodes=function(){return this._nodes},Pr.prototype.getDirectedEdges=function(){return this._dirEdgeList},Pr.prototype.interfaces_=function(){return[he]},Pr.prototype.getClass=function(){return Pr};var dn=function o(){if(this.location=null,arguments.length===1){if(arguments[0]instanceof Array){var s=arguments[0];this.init(s.length)}else if(Number.isInteger(arguments[0])){var d=arguments[0];this.init(1),this.location[Ae.ON]=d}else if(arguments[0]instanceof o){var _=arguments[0];if(this.init(_.location.length),_!==null)for(var w=0;w<this.location.length;w++)this.location[w]=_.location[w]}}else if(arguments.length===3){var j=arguments[0],ie=arguments[1],ke=arguments[2];this.init(3),this.location[Ae.ON]=j,this.location[Ae.LEFT]=ie,this.location[Ae.RIGHT]=ke}};dn.prototype.setAllLocations=function(o){for(var s=0;s<this.location.length;s++)this.location[s]=o},dn.prototype.isNull=function(){for(var o=0;o<this.location.length;o++)if(this.location[o]!==_e.NONE)return!1;return!0},dn.prototype.setAllLocationsIfNull=function(o){for(var s=0;s<this.location.length;s++)this.location[s]===_e.NONE&&(this.location[s]=o)},dn.prototype.isLine=function(){return this.location.length===1},dn.prototype.merge=function(o){if(o.location.length>this.location.length){var s=new Array(3).fill(null);s[Ae.ON]=this.location[Ae.ON],s[Ae.LEFT]=_e.NONE,s[Ae.RIGHT]=_e.NONE,this.location=s}for(var d=0;d<this.location.length;d++)this.location[d]===_e.NONE&&d<o.location.length&&(this.location[d]=o.location[d])},dn.prototype.getLocations=function(){return this.location},dn.prototype.flip=function(){if(this.location.length<=1)return null;var o=this.location[Ae.LEFT];this.location[Ae.LEFT]=this.location[Ae.RIGHT],this.location[Ae.RIGHT]=o},dn.prototype.toString=function(){var o=new se;return this.location.length>1&&o.append(_e.toLocationSymbol(this.location[Ae.LEFT])),o.append(_e.toLocationSymbol(this.location[Ae.ON])),this.location.length>1&&o.append(_e.toLocationSymbol(this.location[Ae.RIGHT])),o.toString()},dn.prototype.setLocations=function(o,s,d){this.location[Ae.ON]=o,this.location[Ae.LEFT]=s,this.location[Ae.RIGHT]=d},dn.prototype.get=function(o){return o<this.location.length?this.location[o]:_e.NONE},dn.prototype.isArea=function(){return this.location.length>1},dn.prototype.isAnyNull=function(){for(var o=0;o<this.location.length;o++)if(this.location[o]===_e.NONE)return!0;return!1},dn.prototype.setLocation=function(){if(arguments.length===1){var o=arguments[0];this.setLocation(Ae.ON,o)}else if(arguments.length===2){var s=arguments[0],d=arguments[1];this.location[s]=d}},dn.prototype.init=function(o){this.location=new Array(o).fill(null),this.setAllLocations(_e.NONE)},dn.prototype.isEqualOnSide=function(o,s){return this.location[s]===o.location[s]},dn.prototype.allPositionsEqual=function(o){for(var s=0;s<this.location.length;s++)if(this.location[s]!==o)return!1;return!0},dn.prototype.interfaces_=function(){return[]},dn.prototype.getClass=function(){return dn};var Mn=function o(){if(this.elt=new Array(2).fill(null),arguments.length===1){if(Number.isInteger(arguments[0])){var s=arguments[0];this.elt[0]=new dn(s),this.elt[1]=new dn(s)}else if(arguments[0]instanceof o){var d=arguments[0];this.elt[0]=new dn(d.elt[0]),this.elt[1]=new dn(d.elt[1])}}else if(arguments.length===2){var _=arguments[0],w=arguments[1];this.elt[0]=new dn(_e.NONE),this.elt[1]=new dn(_e.NONE),this.elt[_].setLocation(w)}else if(arguments.length===3){var j=arguments[0],ie=arguments[1],ke=arguments[2];this.elt[0]=new dn(j,ie,ke),this.elt[1]=new dn(j,ie,ke)}else if(arguments.length===4){var tt=arguments[0],Pt=arguments[1],tr=arguments[2],st=arguments[3];this.elt[0]=new dn(_e.NONE,_e.NONE,_e.NONE),this.elt[1]=new dn(_e.NONE,_e.NONE,_e.NONE),this.elt[tt].setLocations(Pt,tr,st)}};Mn.prototype.getGeometryCount=function(){var o=0;return this.elt[0].isNull()||o++,this.elt[1].isNull()||o++,o},Mn.prototype.setAllLocations=function(o,s){this.elt[o].setAllLocations(s)},Mn.prototype.isNull=function(o){return this.elt[o].isNull()},Mn.prototype.setAllLocationsIfNull=function(){if(arguments.length===1){var o=arguments[0];this.setAllLocationsIfNull(0,o),this.setAllLocationsIfNull(1,o)}else if(arguments.length===2){var s=arguments[0],d=arguments[1];this.elt[s].setAllLocationsIfNull(d)}},Mn.prototype.isLine=function(o){return this.elt[o].isLine()},Mn.prototype.merge=function(o){for(var s=0;s<2;s++)this.elt[s]===null&&o.elt[s]!==null?this.elt[s]=new dn(o.elt[s]):this.elt[s].merge(o.elt[s])},Mn.prototype.flip=function(){this.elt[0].flip(),this.elt[1].flip()},Mn.prototype.getLocation=function(){if(arguments.length===1){var o=arguments[0];return this.elt[o].get(Ae.ON)}if(arguments.length===2){var s=arguments[0],d=arguments[1];return this.elt[s].get(d)}},Mn.prototype.toString=function(){var o=new se;return this.elt[0]!==null&&(o.append("A:"),o.append(this.elt[0].toString())),this.elt[1]!==null&&(o.append(" B:"),o.append(this.elt[1].toString())),o.toString()},Mn.prototype.isArea=function(){if(arguments.length===0)return this.elt[0].isArea()||this.elt[1].isArea();if(arguments.length===1){var o=arguments[0];return this.elt[o].isArea()}},Mn.prototype.isAnyNull=function(o){return this.elt[o].isAnyNull()},Mn.prototype.setLocation=function(){if(arguments.length===2){var o=arguments[0],s=arguments[1];this.elt[o].setLocation(Ae.ON,s)}else if(arguments.length===3){var d=arguments[0],_=arguments[1],w=arguments[2];this.elt[d].setLocation(_,w)}},Mn.prototype.isEqualOnSide=function(o,s){return this.elt[0].isEqualOnSide(o.elt[0],s)&&this.elt[1].isEqualOnSide(o.elt[1],s)},Mn.prototype.allPositionsEqual=function(o,s){return this.elt[o].allPositionsEqual(s)},Mn.prototype.toLine=function(o){this.elt[o].isArea()&&(this.elt[o]=new dn(this.elt[o].location[0]))},Mn.prototype.interfaces_=function(){return[]},Mn.prototype.getClass=function(){return Mn},Mn.toLineLabel=function(o){for(var s=new Mn(_e.NONE),d=0;d<2;d++)s.setLocation(d,o.getLocation(d));return s};var vi=function(){this._startDe=null,this._maxNodeDegree=-1,this._edges=new Gr,this._pts=new Gr,this._label=new Mn(_e.NONE),this._ring=null,this._isHole=null,this._shell=null,this._holes=new Gr,this._geometryFactory=null;var o=arguments[0],s=arguments[1];this._geometryFactory=s,this.computePoints(o),this.computeRing()};vi.prototype.computeRing=function(){if(this._ring!==null)return null;for(var o=new Array(this._pts.size()).fill(null),s=0;s<this._pts.size();s++)o[s]=this._pts.get(s);this._ring=this._geometryFactory.createLinearRing(o),this._isHole=wt.isCCW(this._ring.getCoordinates())},vi.prototype.isIsolated=function(){return this._label.getGeometryCount()===1},vi.prototype.computePoints=function(o){this._startDe=o;var s=o,d=!0;do{if(s===null)throw new zt("Found null DirectedEdge");if(s.getEdgeRing()===this)throw new zt("Directed Edge visited twice during ring-building at "+s.getCoordinate());this._edges.add(s);var _=s.getLabel();Lt.isTrue(_.isArea()),this.mergeLabel(_),this.addPoints(s.getEdge(),s.isForward(),d),d=!1,this.setEdgeRing(s,this),s=this.getNext(s)}while(s!==this._startDe)},vi.prototype.getLinearRing=function(){return this._ring},vi.prototype.getCoordinate=function(o){return this._pts.get(o)},vi.prototype.computeMaxNodeDegree=function(){this._maxNodeDegree=0;var o=this._startDe;do{var s=o.getNode().getEdges().getOutgoingDegree(this);s>this._maxNodeDegree&&(this._maxNodeDegree=s),o=this.getNext(o)}while(o!==this._startDe);this._maxNodeDegree*=2},vi.prototype.addPoints=function(o,s,d){var _=o.getCoordinates();if(s){var w=1;d&&(w=0);for(var j=w;j<_.length;j++)this._pts.add(_[j])}else{var ie=_.length-2;d&&(ie=_.length-1);for(var ke=ie;ke>=0;ke--)this._pts.add(_[ke])}},vi.prototype.isHole=function(){return this._isHole},vi.prototype.setInResult=function(){var o=this._startDe;do o.getEdge().setInResult(!0),o=o.getNext();while(o!==this._startDe)},vi.prototype.containsPoint=function(o){var s=this.getLinearRing();if(!s.getEnvelopeInternal().contains(o)||!wt.isPointInRing(o,s.getCoordinates()))return!1;for(var d=this._holes.iterator();d.hasNext();)if(d.next().containsPoint(o))return!1;return!0},vi.prototype.addHole=function(o){this._holes.add(o)},vi.prototype.isShell=function(){return this._shell===null},vi.prototype.getLabel=function(){return this._label},vi.prototype.getEdges=function(){return this._edges},vi.prototype.getMaxNodeDegree=function(){return this._maxNodeDegree<0&&this.computeMaxNodeDegree(),this._maxNodeDegree},vi.prototype.getShell=function(){return this._shell},vi.prototype.mergeLabel=function(){if(arguments.length===1){var o=arguments[0];this.mergeLabel(o,0),this.mergeLabel(o,1)}else if(arguments.length===2){var s=arguments[0],d=arguments[1],_=s.getLocation(d,Ae.RIGHT);if(_===_e.NONE)return null;if(this._label.getLocation(d)===_e.NONE)return this._label.setLocation(d,_),null}},vi.prototype.setShell=function(o){this._shell=o,o!==null&&o.addHole(this)},vi.prototype.toPolygon=function(o){for(var s=new Array(this._holes.size()).fill(null),d=0;d<this._holes.size();d++)s[d]=this._holes.get(d).getLinearRing();return o.createPolygon(this.getLinearRing(),s)},vi.prototype.interfaces_=function(){return[]},vi.prototype.getClass=function(){return vi};var co=function(o){function s(){var d=arguments[0],_=arguments[1];o.call(this,d,_)}return o&&(s.__proto__=o),s.prototype=Object.create(o&&o.prototype),s.prototype.constructor=s,s.prototype.setEdgeRing=function(d,_){d.setMinEdgeRing(_)},s.prototype.getNext=function(d){return d.getNextMin()},s.prototype.interfaces_=function(){return[]},s.prototype.getClass=function(){return s},s}(vi),ns=function(o){function s(){var d=arguments[0],_=arguments[1];o.call(this,d,_)}return o&&(s.__proto__=o),s.prototype=Object.create(o&&o.prototype),s.prototype.constructor=s,s.prototype.buildMinimalRings=function(){var d=new Gr,_=this._startDe;do{if(_.getMinEdgeRing()===null){var w=new co(_,this._geometryFactory);d.add(w)}_=_.getNext()}while(_!==this._startDe);return d},s.prototype.setEdgeRing=function(d,_){d.setEdgeRing(_)},s.prototype.linkDirectedEdgesForMinimalEdgeRings=function(){var d=this._startDe;do d.getNode().getEdges().linkMinimalDirectedEdges(this),d=d.getNext();while(d!==this._startDe)},s.prototype.getNext=function(d){return d.getNext()},s.prototype.interfaces_=function(){return[]},s.prototype.getClass=function(){return s},s}(vi),ws=function(){if(this._label=null,this._isInResult=!1,this._isCovered=!1,this._isCoveredSet=!1,this._isVisited=!1,arguments.length!==0){if(arguments.length===1){var o=arguments[0];this._label=o}}};ws.prototype.setVisited=function(o){this._isVisited=o},ws.prototype.setInResult=function(o){this._isInResult=o},ws.prototype.isCovered=function(){return this._isCovered},ws.prototype.isCoveredSet=function(){return this._isCoveredSet},ws.prototype.setLabel=function(o){this._label=o},ws.prototype.getLabel=function(){return this._label},ws.prototype.setCovered=function(o){this._isCovered=o,this._isCoveredSet=!0},ws.prototype.updateIM=function(o){Lt.isTrue(this._label.getGeometryCount()>=2,"found partial label"),this.computeIM(o)},ws.prototype.isInResult=function(){return this._isInResult},ws.prototype.isVisited=function(){return this._isVisited},ws.prototype.interfaces_=function(){return[]},ws.prototype.getClass=function(){return ws};var Qc=function(o){function s(){o.call(this),this._coord=null,this._edges=null;var d=arguments[0],_=arguments[1];this._coord=d,this._edges=_,this._label=new Mn(0,_e.NONE)}return o&&(s.__proto__=o),s.prototype=Object.create(o&&o.prototype),s.prototype.constructor=s,s.prototype.isIncidentEdgeInResult=function(){for(var d=this.getEdges().getEdges().iterator();d.hasNext();)if(d.next().getEdge().isInResult())return!0;return!1},s.prototype.isIsolated=function(){return this._label.getGeometryCount()===1},s.prototype.getCoordinate=function(){return this._coord},s.prototype.print=function(d){d.println("node "+this._coord+" lbl: "+this._label)},s.prototype.computeIM=function(d){},s.prototype.computeMergedLocation=function(d,_){var w=_e.NONE;if(w=this._label.getLocation(_),!d.isNull(_)){var j=d.getLocation(_);w!==_e.BOUNDARY&&(w=j)}return w},s.prototype.setLabel=function(){if(arguments.length!==2)return o.prototype.setLabel.apply(this,arguments);var d=arguments[0],_=arguments[1];this._label===null?this._label=new Mn(d,_):this._label.setLocation(d,_)},s.prototype.getEdges=function(){return this._edges},s.prototype.mergeLabel=function(){if(arguments[0]instanceof s){var d=arguments[0];this.mergeLabel(d._label)}else if(arguments[0]instanceof Mn)for(var _=arguments[0],w=0;w<2;w++){var j=this.computeMergedLocation(_,w);this._label.getLocation(w)===_e.NONE&&this._label.setLocation(w,j)}},s.prototype.add=function(d){this._edges.insert(d),d.setNode(this)},s.prototype.setLabelBoundary=function(d){if(this._label===null)return null;var _=_e.NONE;this._label!==null&&(_=this._label.getLocation(d));var w=null;switch(_){case _e.BOUNDARY:w=_e.INTERIOR;break;case _e.INTERIOR:default:w=_e.BOUNDARY}this._label.setLocation(d,w)},s.prototype.interfaces_=function(){return[]},s.prototype.getClass=function(){return s},s}(ws),zs=function(){this.nodeMap=new Re,this.nodeFact=null;var o=arguments[0];this.nodeFact=o};zs.prototype.find=function(o){return this.nodeMap.get(o)},zs.prototype.addNode=function(){if(arguments[0]instanceof Y){var o=arguments[0],s=this.nodeMap.get(o);return s===null&&(s=this.nodeFact.createNode(o),this.nodeMap.put(o,s)),s}if(arguments[0]instanceof Qc){var d=arguments[0],_=this.nodeMap.get(d.getCoordinate());return _===null?(this.nodeMap.put(d.getCoordinate(),d),d):(_.mergeLabel(d),_)}},zs.prototype.print=function(o){for(var s=this.iterator();s.hasNext();)s.next().print(o)},zs.prototype.iterator=function(){return this.nodeMap.values().iterator()},zs.prototype.values=function(){return this.nodeMap.values()},zs.prototype.getBoundaryNodes=function(o){for(var s=new Gr,d=this.iterator();d.hasNext();){var _=d.next();_.getLabel().getLocation(o)===_e.BOUNDARY&&s.add(_)}return s},zs.prototype.add=function(o){var s=o.getCoordinate();this.addNode(s).add(o)},zs.prototype.interfaces_=function(){return[]},zs.prototype.getClass=function(){return zs};var ca=function(){},ec={NE:{configurable:!0},NW:{configurable:!0},SW:{configurable:!0},SE:{configurable:!0}};ca.prototype.interfaces_=function(){return[]},ca.prototype.getClass=function(){return ca},ca.isNorthern=function(o){return o===ca.NE||o===ca.NW},ca.isOpposite=function(o,s){return o===s?!1:(o-s+4)%4===2},ca.commonHalfPlane=function(o,s){if(o===s)return o;if((o-s+4)%4===2)return-1;var d=o<s?o:s;return d===0&&(o>s?o:s)===3?3:d},ca.isInHalfPlane=function(o,s){return s===ca.SE?o===ca.SE||o===ca.SW:o===s||o===s+1},ca.quadrant=function(){if(typeof arguments[0]=="number"&&typeof arguments[1]=="number"){var o=arguments[0],s=arguments[1];if(o===0&&s===0)throw new we("Cannot compute the quadrant for point ( "+o+", "+s+" )");return o>=0?s>=0?ca.NE:ca.SE:s>=0?ca.NW:ca.SW}if(arguments[0]instanceof Y&&arguments[1]instanceof Y){var d=arguments[0],_=arguments[1];if(_.x===d.x&&_.y===d.y)throw new we("Cannot compute the quadrant for two identical points "+d);return _.x>=d.x?_.y>=d.y?ca.NE:ca.SE:_.y>=d.y?ca.NW:ca.SW}},ec.NE.get=function(){return 0},ec.NW.get=function(){return 1},ec.SW.get=function(){return 2},ec.SE.get=function(){return 3},Object.defineProperties(ca,ec);var qa=function(){if(this._edge=null,this._label=null,this._node=null,this._p0=null,this._p1=null,this._dx=null,this._dy=null,this._quadrant=null,arguments.length===1){var o=arguments[0];this._edge=o}else if(arguments.length===3){var s=arguments[0],d=arguments[1],_=arguments[2];this._edge=s,this.init(d,_),this._label=null}else if(arguments.length===4){var w=arguments[0],j=arguments[1],ie=arguments[2],ke=arguments[3];this._edge=w,this.init(j,ie),this._label=ke}};qa.prototype.compareDirection=function(o){return this._dx===o._dx&&this._dy===o._dy?0:this._quadrant>o._quadrant?1:this._quadrant<o._quadrant?-1:wt.computeOrientation(o._p0,o._p1,this._p1)},qa.prototype.getDy=function(){return this._dy},qa.prototype.getCoordinate=function(){return this._p0},qa.prototype.setNode=function(o){this._node=o},qa.prototype.print=function(o){var s=Math.atan2(this._dy,this._dx),d=this.getClass().getName(),_=d.lastIndexOf("."),w=d.substring(_+1);o.print("  "+w+": "+this._p0+" - "+this._p1+" "+this._quadrant+":"+s+"   "+this._label)},qa.prototype.compareTo=function(o){var s=o;return this.compareDirection(s)},qa.prototype.getDirectedCoordinate=function(){return this._p1},qa.prototype.getDx=function(){return this._dx},qa.prototype.getLabel=function(){return this._label},qa.prototype.getEdge=function(){return this._edge},qa.prototype.getQuadrant=function(){return this._quadrant},qa.prototype.getNode=function(){return this._node},qa.prototype.toString=function(){var o=Math.atan2(this._dy,this._dx),s=this.getClass().getName(),d=s.lastIndexOf(".");return"  "+s.substring(d+1)+": "+this._p0+" - "+this._p1+" "+this._quadrant+":"+o+"   "+this._label},qa.prototype.computeLabel=function(o){},qa.prototype.init=function(o,s){this._p0=o,this._p1=s,this._dx=s.x-o.x,this._dy=s.y-o.y,this._quadrant=ca.quadrant(this._dx,this._dy),Lt.isTrue(!(this._dx===0&&this._dy===0),"EdgeEnd with identical endpoints found")},qa.prototype.interfaces_=function(){return[he]},qa.prototype.getClass=function(){return qa};var mf=function(o){function s(){var d=arguments[0],_=arguments[1];if(o.call(this,d),this._isForward=null,this._isInResult=!1,this._isVisited=!1,this._sym=null,this._next=null,this._nextMin=null,this._edgeRing=null,this._minEdgeRing=null,this._depth=[0,-999,-999],this._isForward=_,_)this.init(d.getCoordinate(0),d.getCoordinate(1));else{var w=d.getNumPoints()-1;this.init(d.getCoordinate(w),d.getCoordinate(w-1))}this.computeDirectedLabel()}return o&&(s.__proto__=o),s.prototype=Object.create(o&&o.prototype),s.prototype.constructor=s,s.prototype.getNextMin=function(){return this._nextMin},s.prototype.getDepth=function(d){return this._depth[d]},s.prototype.setVisited=function(d){this._isVisited=d},s.prototype.computeDirectedLabel=function(){this._label=new Mn(this._edge.getLabel()),this._isForward||this._label.flip()},s.prototype.getNext=function(){return this._next},s.prototype.setDepth=function(d,_){if(this._depth[d]!==-999&&this._depth[d]!==_)throw new zt("assigned depths do not match",this.getCoordinate());this._depth[d]=_},s.prototype.isInteriorAreaEdge=function(){for(var d=!0,_=0;_<2;_++)this._label.isArea(_)&&this._label.getLocation(_,Ae.LEFT)===_e.INTERIOR&&this._label.getLocation(_,Ae.RIGHT)===_e.INTERIOR||(d=!1);return d},s.prototype.setNextMin=function(d){this._nextMin=d},s.prototype.print=function(d){o.prototype.print.call(this,d),d.print(" "+this._depth[Ae.LEFT]+"/"+this._depth[Ae.RIGHT]),d.print(" ("+this.getDepthDelta()+")"),this._isInResult&&d.print(" inResult")},s.prototype.setMinEdgeRing=function(d){this._minEdgeRing=d},s.prototype.isLineEdge=function(){var d=this._label.isLine(0)||this._label.isLine(1),_=!this._label.isArea(0)||this._label.allPositionsEqual(0,_e.EXTERIOR),w=!this._label.isArea(1)||this._label.allPositionsEqual(1,_e.EXTERIOR);return d&&_&&w},s.prototype.setEdgeRing=function(d){this._edgeRing=d},s.prototype.getMinEdgeRing=function(){return this._minEdgeRing},s.prototype.getDepthDelta=function(){var d=this._edge.getDepthDelta();return this._isForward||(d=-d),d},s.prototype.setInResult=function(d){this._isInResult=d},s.prototype.getSym=function(){return this._sym},s.prototype.isForward=function(){return this._isForward},s.prototype.getEdge=function(){return this._edge},s.prototype.printEdge=function(d){this.print(d),d.print(" "),this._isForward?this._edge.print(d):this._edge.printReverse(d)},s.prototype.setSym=function(d){this._sym=d},s.prototype.setVisitedEdge=function(d){this.setVisited(d),this._sym.setVisited(d)},s.prototype.setEdgeDepths=function(d,_){var w=this.getEdge().getDepthDelta();this._isForward||(w=-w);var j=1;d===Ae.LEFT&&(j=-1);var ie=Ae.opposite(d),ke=_+w*j;this.setDepth(d,_),this.setDepth(ie,ke)},s.prototype.getEdgeRing=function(){return this._edgeRing},s.prototype.isInResult=function(){return this._isInResult},s.prototype.setNext=function(d){this._next=d},s.prototype.isVisited=function(){return this._isVisited},s.prototype.interfaces_=function(){return[]},s.prototype.getClass=function(){return s},s.depthFactor=function(d,_){return d===_e.EXTERIOR&&_===_e.INTERIOR?1:d===_e.INTERIOR&&_===_e.EXTERIOR?-1:0},s}(qa),dl=function(){};dl.prototype.createNode=function(o){return new Qc(o,null)},dl.prototype.interfaces_=function(){return[]},dl.prototype.getClass=function(){return dl};var Ta=function(){if(this._edges=new Gr,this._nodes=null,this._edgeEndList=new Gr,arguments.length===0)this._nodes=new zs(new dl);else if(arguments.length===1){var o=arguments[0];this._nodes=new zs(o)}};Ta.prototype.printEdges=function(o){o.println("Edges:");for(var s=0;s<this._edges.size();s++){o.println("edge "+s+":");var d=this._edges.get(s);d.print(o),d.eiList.print(o)}},Ta.prototype.find=function(o){return this._nodes.find(o)},Ta.prototype.addNode=function(){if(arguments[0]instanceof Qc){var o=arguments[0];return this._nodes.addNode(o)}if(arguments[0]instanceof Y){var s=arguments[0];return this._nodes.addNode(s)}},Ta.prototype.getNodeIterator=function(){return this._nodes.iterator()},Ta.prototype.linkResultDirectedEdges=function(){for(var o=this._nodes.iterator();o.hasNext();)o.next().getEdges().linkResultDirectedEdges()},Ta.prototype.debugPrintln=function(o){Qr.out.println(o)},Ta.prototype.isBoundaryNode=function(o,s){var d=this._nodes.find(s);if(d===null)return!1;var _=d.getLabel();return _!==null&&_.getLocation(o)===_e.BOUNDARY},Ta.prototype.linkAllDirectedEdges=function(){for(var o=this._nodes.iterator();o.hasNext();)o.next().getEdges().linkAllDirectedEdges()},Ta.prototype.matchInSameDirection=function(o,s,d,_){return!!o.equals(d)&&wt.computeOrientation(o,s,_)===wt.COLLINEAR&&ca.quadrant(o,s)===ca.quadrant(d,_)},Ta.prototype.getEdgeEnds=function(){return this._edgeEndList},Ta.prototype.debugPrint=function(o){Qr.out.print(o)},Ta.prototype.getEdgeIterator=function(){return this._edges.iterator()},Ta.prototype.findEdgeInSameDirection=function(o,s){for(var d=0;d<this._edges.size();d++){var _=this._edges.get(d),w=_.getCoordinates();if(this.matchInSameDirection(o,s,w[0],w[1])||this.matchInSameDirection(o,s,w[w.length-1],w[w.length-2]))return _}return null},Ta.prototype.insertEdge=function(o){this._edges.add(o)},Ta.prototype.findEdgeEnd=function(o){for(var s=this.getEdgeEnds().iterator();s.hasNext();){var d=s.next();if(d.getEdge()===o)return d}return null},Ta.prototype.addEdges=function(o){for(var s=o.iterator();s.hasNext();){var d=s.next();this._edges.add(d);var _=new mf(d,!0),w=new mf(d,!1);_.setSym(w),w.setSym(_),this.add(_),this.add(w)}},Ta.prototype.add=function(o){this._nodes.add(o),this._edgeEndList.add(o)},Ta.prototype.getNodes=function(){return this._nodes.values()},Ta.prototype.findEdge=function(o,s){for(var d=0;d<this._edges.size();d++){var _=this._edges.get(d),w=_.getCoordinates();if(o.equals(w[0])&&s.equals(w[1]))return _}return null},Ta.prototype.interfaces_=function(){return[]},Ta.prototype.getClass=function(){return Ta},Ta.linkResultDirectedEdges=function(o){for(var s=o.iterator();s.hasNext();)s.next().getEdges().linkResultDirectedEdges()};var In=function(){this._geometryFactory=null,this._shellList=new Gr;var o=arguments[0];this._geometryFactory=o};In.prototype.sortShellsAndHoles=function(o,s,d){for(var _=o.iterator();_.hasNext();){var w=_.next();w.isHole()?d.add(w):s.add(w)}},In.prototype.computePolygons=function(o){for(var s=new Gr,d=o.iterator();d.hasNext();){var _=d.next().toPolygon(this._geometryFactory);s.add(_)}return s},In.prototype.placeFreeHoles=function(o,s){for(var d=s.iterator();d.hasNext();){var _=d.next();if(_.getShell()===null){var w=this.findEdgeRingContaining(_,o);if(w===null)throw new zt("unable to assign hole to a shell",_.getCoordinate(0));_.setShell(w)}}},In.prototype.buildMinimalEdgeRings=function(o,s,d){for(var _=new Gr,w=o.iterator();w.hasNext();){var j=w.next();if(j.getMaxNodeDegree()>2){j.linkDirectedEdgesForMinimalEdgeRings();var ie=j.buildMinimalRings(),ke=this.findShell(ie);ke!==null?(this.placePolygonHoles(ke,ie),s.add(ke)):d.addAll(ie)}else _.add(j)}return _},In.prototype.containsPoint=function(o){for(var s=this._shellList.iterator();s.hasNext();)if(s.next().containsPoint(o))return!0;return!1},In.prototype.buildMaximalEdgeRings=function(o){for(var s=new Gr,d=o.iterator();d.hasNext();){var _=d.next();if(_.isInResult()&&_.getLabel().isArea()&&_.getEdgeRing()===null){var w=new ns(_,this._geometryFactory);s.add(w),w.setInResult()}}return s},In.prototype.placePolygonHoles=function(o,s){for(var d=s.iterator();d.hasNext();){var _=d.next();_.isHole()&&_.setShell(o)}},In.prototype.getPolygons=function(){return this.computePolygons(this._shellList)},In.prototype.findEdgeRingContaining=function(o,s){for(var d=o.getLinearRing(),_=d.getEnvelopeInternal(),w=d.getCoordinateN(0),j=null,ie=null,ke=s.iterator();ke.hasNext();){var tt=ke.next(),Pt=tt.getLinearRing(),tr=Pt.getEnvelopeInternal();j!==null&&(ie=j.getLinearRing().getEnvelopeInternal());var st=!1;tr.contains(_)&&wt.isPointInRing(w,Pt.getCoordinates())&&(st=!0),st&&(j===null||ie.contains(tr))&&(j=tt)}return j},In.prototype.findShell=function(o){for(var s=0,d=null,_=o.iterator();_.hasNext();){var w=_.next();w.isHole()||(d=w,s++)}return Lt.isTrue(s<=1,"found two shells in MinimalEdgeRing list"),d},In.prototype.add=function(){if(arguments.length===1){var o=arguments[0];this.add(o.getEdgeEnds(),o.getNodes())}else if(arguments.length===2){var s=arguments[0],d=arguments[1];Ta.linkResultDirectedEdges(d);var _=this.buildMaximalEdgeRings(s),w=new Gr,j=this.buildMinimalEdgeRings(_,this._shellList,w);this.sortShellsAndHoles(j,this._shellList,w),this.placeFreeHoles(this._shellList,w)}},In.prototype.interfaces_=function(){return[]},In.prototype.getClass=function(){return In};var Ju=function(){};Ju.prototype.getBounds=function(){},Ju.prototype.interfaces_=function(){return[]},Ju.prototype.getClass=function(){return Ju};var Us=function(){this._bounds=null,this._item=null;var o=arguments[0],s=arguments[1];this._bounds=o,this._item=s};Us.prototype.getItem=function(){return this._item},Us.prototype.getBounds=function(){return this._bounds},Us.prototype.interfaces_=function(){return[Ju,L]},Us.prototype.getClass=function(){return Us};var cu=function(){this._size=null,this._items=null,this._size=0,this._items=new Gr,this._items.add(null)};cu.prototype.poll=function(){if(this.isEmpty())return null;var o=this._items.get(1);return this._items.set(1,this._items.get(this._size)),this._size-=1,this.reorder(1),o},cu.prototype.size=function(){return this._size},cu.prototype.reorder=function(o){for(var s=null,d=this._items.get(o);2*o<=this._size&&((s=2*o)!==this._size&&this._items.get(s+1).compareTo(this._items.get(s))<0&&s++,this._items.get(s).compareTo(d)<0);o=s)this._items.set(o,this._items.get(s));this._items.set(o,d)},cu.prototype.clear=function(){this._size=0,this._items.clear()},cu.prototype.isEmpty=function(){return this._size===0},cu.prototype.add=function(o){this._items.add(null),this._size+=1;var s=this._size;for(this._items.set(0,o);o.compareTo(this._items.get(Math.trunc(s/2)))<0;s/=2)this._items.set(s,this._items.get(Math.trunc(s/2)));this._items.set(s,o)},cu.prototype.interfaces_=function(){return[]},cu.prototype.getClass=function(){return cu};var fu=function(){};fu.prototype.visitItem=function(o){},fu.prototype.interfaces_=function(){return[]},fu.prototype.getClass=function(){return fu};var xu=function(){};xu.prototype.insert=function(o,s){},xu.prototype.remove=function(o,s){},xu.prototype.query=function(){},xu.prototype.interfaces_=function(){return[]},xu.prototype.getClass=function(){return xu};var ni=function(){if(this._childBoundables=new Gr,this._bounds=null,this._level=null,arguments.length!==0){if(arguments.length===1){var o=arguments[0];this._level=o}}},Ro={serialVersionUID:{configurable:!0}};ni.prototype.getLevel=function(){return this._level},ni.prototype.size=function(){return this._childBoundables.size()},ni.prototype.getChildBoundables=function(){return this._childBoundables},ni.prototype.addChildBoundable=function(o){Lt.isTrue(this._bounds===null),this._childBoundables.add(o)},ni.prototype.isEmpty=function(){return this._childBoundables.isEmpty()},ni.prototype.getBounds=function(){return this._bounds===null&&(this._bounds=this.computeBounds()),this._bounds},ni.prototype.interfaces_=function(){return[Ju,L]},ni.prototype.getClass=function(){return ni},Ro.serialVersionUID.get=function(){return 6493722185909574e3},Object.defineProperties(ni,Ro);var Ha=function(){};Ha.reverseOrder=function(){return{compare:function(o,s){return s.compareTo(o)}}},Ha.min=function(o){return Ha.sort(o),o.get(0)},Ha.sort=function(o,s){var d=o.toArray();s?ga.sort(d,s):ga.sort(d);for(var _=o.iterator(),w=0,j=d.length;w<j;w++)_.next(),_.set(d[w])},Ha.singletonList=function(o){var s=new Gr;return s.add(o),s};var Ra=function(){this._boundable1=null,this._boundable2=null,this._distance=null,this._itemDistance=null;var o=arguments[0],s=arguments[1],d=arguments[2];this._boundable1=o,this._boundable2=s,this._itemDistance=d,this._distance=this.distance()};Ra.prototype.expandToQueue=function(o,s){var d=Ra.isComposite(this._boundable1),_=Ra.isComposite(this._boundable2);if(d&&_)return Ra.area(this._boundable1)>Ra.area(this._boundable2)?(this.expand(this._boundable1,this._boundable2,o,s),null):(this.expand(this._boundable2,this._boundable1,o,s),null);if(d)return this.expand(this._boundable1,this._boundable2,o,s),null;if(_)return this.expand(this._boundable2,this._boundable1,o,s),null;throw new we("neither boundable is composite")},Ra.prototype.isLeaves=function(){return!(Ra.isComposite(this._boundable1)||Ra.isComposite(this._boundable2))},Ra.prototype.compareTo=function(o){var s=o;return this._distance<s._distance?-1:this._distance>s._distance?1:0},Ra.prototype.expand=function(o,s,d,_){for(var w=o.getChildBoundables().iterator();w.hasNext();){var j=w.next(),ie=new Ra(j,s,this._itemDistance);ie.getDistance()<_&&d.add(ie)}},Ra.prototype.getBoundable=function(o){return o===0?this._boundable1:this._boundable2},Ra.prototype.getDistance=function(){return this._distance},Ra.prototype.distance=function(){return this.isLeaves()?this._itemDistance.distance(this._boundable1,this._boundable2):this._boundable1.getBounds().distance(this._boundable2.getBounds())},Ra.prototype.interfaces_=function(){return[he]},Ra.prototype.getClass=function(){return Ra},Ra.area=function(o){return o.getBounds().getArea()},Ra.isComposite=function(o){return o instanceof ni};var mo=function o(){if(this._root=null,this._built=!1,this._itemBoundables=new Gr,this._nodeCapacity=null,arguments.length===0){var s=o.DEFAULT_NODE_CAPACITY;this._nodeCapacity=s}else if(arguments.length===1){var d=arguments[0];Lt.isTrue(d>1,"Node capacity must be greater than 1"),this._nodeCapacity=d}},hu={IntersectsOp:{configurable:!0},serialVersionUID:{configurable:!0},DEFAULT_NODE_CAPACITY:{configurable:!0}};mo.prototype.getNodeCapacity=function(){return this._nodeCapacity},mo.prototype.lastNode=function(o){return o.get(o.size()-1)},mo.prototype.size=function(){if(arguments.length===0)return this.isEmpty()?0:(this.build(),this.size(this._root));if(arguments.length===1){for(var o=0,s=arguments[0].getChildBoundables().iterator();s.hasNext();){var d=s.next();d instanceof ni?o+=this.size(d):d instanceof Us&&(o+=1)}return o}},mo.prototype.removeItem=function(o,s){for(var d=null,_=o.getChildBoundables().iterator();_.hasNext();){var w=_.next();w instanceof Us&&w.getItem()===s&&(d=w)}return d!==null&&(o.getChildBoundables().remove(d),!0)},mo.prototype.itemsTree=function(){if(arguments.length===0){this.build();var o=this.itemsTree(this._root);return o===null?new Gr:o}if(arguments.length===1){for(var s=arguments[0],d=new Gr,_=s.getChildBoundables().iterator();_.hasNext();){var w=_.next();if(w instanceof ni){var j=this.itemsTree(w);j!==null&&d.add(j)}else w instanceof Us?d.add(w.getItem()):Lt.shouldNeverReachHere()}return d.size()<=0?null:d}},mo.prototype.insert=function(o,s){Lt.isTrue(!this._built,"Cannot insert items into an STR packed R-tree after it has been built."),this._itemBoundables.add(new Us(o,s))},mo.prototype.boundablesAtLevel=function(){if(arguments.length===1){var o=arguments[0],s=new Gr;return this.boundablesAtLevel(o,this._root,s),s}if(arguments.length===3){var d=arguments[0],_=arguments[1],w=arguments[2];if(Lt.isTrue(d>-2),_.getLevel()===d)return w.add(_),null;for(var j=_.getChildBoundables().iterator();j.hasNext();){var ie=j.next();ie instanceof ni?this.boundablesAtLevel(d,ie,w):(Lt.isTrue(ie instanceof Us),d===-1&&w.add(ie))}return null}},mo.prototype.query=function(){if(arguments.length===1){var o=arguments[0];this.build();var s=new Gr;return this.isEmpty()||this.getIntersectsOp().intersects(this._root.getBounds(),o)&&this.query(o,this._root,s),s}if(arguments.length===2){var d=arguments[0],_=arguments[1];if(this.build(),this.isEmpty())return null;this.getIntersectsOp().intersects(this._root.getBounds(),d)&&this.query(d,this._root,_)}else if(arguments.length===3){if(Le(arguments[2],fu)&&arguments[0]instanceof Object&&arguments[1]instanceof ni)for(var w=arguments[0],j=arguments[1],ie=arguments[2],ke=j.getChildBoundables(),tt=0;tt<ke.size();tt++){var Pt=ke.get(tt);this.getIntersectsOp().intersects(Pt.getBounds(),w)&&(Pt instanceof ni?this.query(w,Pt,ie):Pt instanceof Us?ie.visitItem(Pt.getItem()):Lt.shouldNeverReachHere())}else if(Le(arguments[2],Oa)&&arguments[0]instanceof Object&&arguments[1]instanceof ni)for(var tr=arguments[0],st=arguments[1],Zt=arguments[2],Jt=st.getChildBoundables(),yr=0;yr<Jt.size();yr++){var v=Jt.get(yr);this.getIntersectsOp().intersects(v.getBounds(),tr)&&(v instanceof ni?this.query(tr,v,Zt):v instanceof Us?Zt.add(v.getItem()):Lt.shouldNeverReachHere())}}},mo.prototype.build=function(){if(this._built)return null;this._root=this._itemBoundables.isEmpty()?this.createNode(0):this.createHigherLevels(this._itemBoundables,-1),this._itemBoundables=null,this._built=!0},mo.prototype.getRoot=function(){return this.build(),this._root},mo.prototype.remove=function(){if(arguments.length===2){var o=arguments[0],s=arguments[1];return this.build(),!!this.getIntersectsOp().intersects(this._root.getBounds(),o)&&this.remove(o,this._root,s)}if(arguments.length===3){var d=arguments[0],_=arguments[1],w=arguments[2],j=this.removeItem(_,w);if(j)return!0;for(var ie=null,ke=_.getChildBoundables().iterator();ke.hasNext();){var tt=ke.next();if(this.getIntersectsOp().intersects(tt.getBounds(),d)&&tt instanceof ni&&(j=this.remove(d,tt,w))){ie=tt;break}}return ie!==null&&ie.getChildBoundables().isEmpty()&&_.getChildBoundables().remove(ie),j}},mo.prototype.createHigherLevels=function(o,s){Lt.isTrue(!o.isEmpty());var d=this.createParentBoundables(o,s+1);return d.size()===1?d.get(0):this.createHigherLevels(d,s+1)},mo.prototype.depth=function(){if(arguments.length===0)return this.isEmpty()?0:(this.build(),this.depth(this._root));if(arguments.length===1){for(var o=0,s=arguments[0].getChildBoundables().iterator();s.hasNext();){var d=s.next();if(d instanceof ni){var _=this.depth(d);_>o&&(o=_)}}return o+1}},mo.prototype.createParentBoundables=function(o,s){Lt.isTrue(!o.isEmpty());var d=new Gr;d.add(this.createNode(s));var _=new Gr(o);Ha.sort(_,this.getComparator());for(var w=_.iterator();w.hasNext();){var j=w.next();this.lastNode(d).getChildBoundables().size()===this.getNodeCapacity()&&d.add(this.createNode(s)),this.lastNode(d).addChildBoundable(j)}return d},mo.prototype.isEmpty=function(){return this._built?this._root.isEmpty():this._itemBoundables.isEmpty()},mo.prototype.interfaces_=function(){return[L]},mo.prototype.getClass=function(){return mo},mo.compareDoubles=function(o,s){return o>s?1:o<s?-1:0},hu.IntersectsOp.get=function(){return yf},hu.serialVersionUID.get=function(){return-3886435814360241e3},hu.DEFAULT_NODE_CAPACITY.get=function(){return 10},Object.defineProperties(mo,hu);var yf=function(){},Ol=function(){};Ol.prototype.distance=function(o,s){},Ol.prototype.interfaces_=function(){return[]},Ol.prototype.getClass=function(){return Ol};var qc=function(o){function s(_){_=_||s.DEFAULT_NODE_CAPACITY,o.call(this,_)}o&&(s.__proto__=o),(s.prototype=Object.create(o&&o.prototype)).constructor=s;var d={STRtreeNode:{configurable:!0},serialVersionUID:{configurable:!0},xComparator:{configurable:!0},yComparator:{configurable:!0},intersectsOp:{configurable:!0},DEFAULT_NODE_CAPACITY:{configurable:!0}};return s.prototype.createParentBoundablesFromVerticalSlices=function(_,w){Lt.isTrue(_.length>0);for(var j=new Gr,ie=0;ie<_.length;ie++)j.addAll(this.createParentBoundablesFromVerticalSlice(_[ie],w));return j},s.prototype.createNode=function(_){return new _f(_)},s.prototype.size=function(){return arguments.length===0?o.prototype.size.call(this):o.prototype.size.apply(this,arguments)},s.prototype.insert=function(){if(arguments.length!==2)return o.prototype.insert.apply(this,arguments);var _=arguments[0],w=arguments[1];if(_.isNull())return null;o.prototype.insert.call(this,_,w)},s.prototype.getIntersectsOp=function(){return s.intersectsOp},s.prototype.verticalSlices=function(_,w){for(var j=Math.trunc(Math.ceil(_.size()/w)),ie=new Array(w).fill(null),ke=_.iterator(),tt=0;tt<w;tt++){ie[tt]=new Gr;for(var Pt=0;ke.hasNext()&&Pt<j;){var tr=ke.next();ie[tt].add(tr),Pt++}}return ie},s.prototype.query=function(){if(arguments.length===1){var _=arguments[0];return o.prototype.query.call(this,_)}if(arguments.length===2){var w=arguments[0],j=arguments[1];o.prototype.query.call(this,w,j)}else if(arguments.length===3){if(Le(arguments[2],fu)&&arguments[0]instanceof Object&&arguments[1]instanceof ni){var ie=arguments[0],ke=arguments[1],tt=arguments[2];o.prototype.query.call(this,ie,ke,tt)}else if(Le(arguments[2],Oa)&&arguments[0]instanceof Object&&arguments[1]instanceof ni){var Pt=arguments[0],tr=arguments[1],st=arguments[2];o.prototype.query.call(this,Pt,tr,st)}}},s.prototype.getComparator=function(){return s.yComparator},s.prototype.createParentBoundablesFromVerticalSlice=function(_,w){return o.prototype.createParentBoundables.call(this,_,w)},s.prototype.remove=function(){if(arguments.length===2){var _=arguments[0],w=arguments[1];return o.prototype.remove.call(this,_,w)}return o.prototype.remove.apply(this,arguments)},s.prototype.depth=function(){return arguments.length===0?o.prototype.depth.call(this):o.prototype.depth.apply(this,arguments)},s.prototype.createParentBoundables=function(_,w){Lt.isTrue(!_.isEmpty());var j=Math.trunc(Math.ceil(_.size()/this.getNodeCapacity())),ie=new Gr(_);Ha.sort(ie,s.xComparator);var ke=this.verticalSlices(ie,Math.trunc(Math.ceil(Math.sqrt(j))));return this.createParentBoundablesFromVerticalSlices(ke,w)},s.prototype.nearestNeighbour=function(){if(arguments.length===1){if(Le(arguments[0],Ol)){var _=arguments[0],w=new Ra(this.getRoot(),this.getRoot(),_);return this.nearestNeighbour(w)}if(arguments[0]instanceof Ra){var j=arguments[0];return this.nearestNeighbour(j,ne.POSITIVE_INFINITY)}}else if(arguments.length===2){if(arguments[0]instanceof s&&Le(arguments[1],Ol)){var ie=arguments[0],ke=arguments[1],tt=new Ra(this.getRoot(),ie.getRoot(),ke);return this.nearestNeighbour(tt)}if(arguments[0]instanceof Ra&&typeof arguments[1]=="number"){var Pt=arguments[0],tr=arguments[1],st=null,Zt=new cu;for(Zt.add(Pt);!Zt.isEmpty()&&tr>0;){var Jt=Zt.poll(),yr=Jt.getDistance();if(yr>=tr)break;Jt.isLeaves()?(tr=yr,st=Jt):Jt.expandToQueue(Zt,tr)}return[st.getBoundable(0).getItem(),st.getBoundable(1).getItem()]}}else if(arguments.length===3){var v=arguments[0],Pn=arguments[1],jn=arguments[2],Xe=new Us(v,Pn),Ia=new Ra(this.getRoot(),Xe,jn);return this.nearestNeighbour(Ia)[0]}},s.prototype.interfaces_=function(){return[xu,L]},s.prototype.getClass=function(){return s},s.centreX=function(_){return s.avg(_.getMinX(),_.getMaxX())},s.avg=function(_,w){return(_+w)/2},s.centreY=function(_){return s.avg(_.getMinY(),_.getMaxY())},d.STRtreeNode.get=function(){return _f},d.serialVersionUID.get=function(){return 0x39920f7d5f261e0},d.xComparator.get=function(){return{interfaces_:function(){return[te]},compare:function(_,w){return o.compareDoubles(s.centreX(_.getBounds()),s.centreX(w.getBounds()))}}},d.yComparator.get=function(){return{interfaces_:function(){return[te]},compare:function(_,w){return o.compareDoubles(s.centreY(_.getBounds()),s.centreY(w.getBounds()))}}},d.intersectsOp.get=function(){return{interfaces_:function(){return[o.IntersectsOp]},intersects:function(_,w){return _.intersects(w)}}},d.DEFAULT_NODE_CAPACITY.get=function(){return 10},Object.defineProperties(s,d),s}(mo),_f=function(o){function s(){var d=arguments[0];o.call(this,d)}return o&&(s.__proto__=o),s.prototype=Object.create(o&&o.prototype),s.prototype.constructor=s,s.prototype.computeBounds=function(){for(var d=null,_=this.getChildBoundables().iterator();_.hasNext();){var w=_.next();d===null?d=new xr(w.getBounds()):d.expandToInclude(w.getBounds())}return d},s.prototype.interfaces_=function(){return[]},s.prototype.getClass=function(){return s},s}(ni),Yo=function(){};Yo.prototype.interfaces_=function(){return[]},Yo.prototype.getClass=function(){return Yo},Yo.relativeSign=function(o,s){return o<s?-1:o>s?1:0},Yo.compare=function(o,s,d){if(s.equals2D(d))return 0;var _=Yo.relativeSign(s.x,d.x),w=Yo.relativeSign(s.y,d.y);switch(o){case 0:return Yo.compareValue(_,w);case 1:return Yo.compareValue(w,_);case 2:return Yo.compareValue(w,-_);case 3:return Yo.compareValue(-_,w);case 4:return Yo.compareValue(-_,-w);case 5:return Yo.compareValue(-w,-_);case 6:return Yo.compareValue(-w,_);case 7:return Yo.compareValue(_,-w)}return Lt.shouldNeverReachHere("invalid octant value"),0},Yo.compareValue=function(o,s){return o<0?-1:o>0?1:s<0?-1:s>0?1:0};var Gs=function(){this._segString=null,this.coord=null,this.segmentIndex=null,this._segmentOctant=null,this._isInterior=null;var o=arguments[0],s=arguments[1],d=arguments[2],_=arguments[3];this._segString=o,this.coord=new Y(s),this.segmentIndex=d,this._segmentOctant=_,this._isInterior=!s.equals2D(o.getCoordinate(d))};Gs.prototype.getCoordinate=function(){return this.coord},Gs.prototype.print=function(o){o.print(this.coord),o.print(" seg # = "+this.segmentIndex)},Gs.prototype.compareTo=function(o){var s=o;return this.segmentIndex<s.segmentIndex?-1:this.segmentIndex>s.segmentIndex?1:this.coord.equals2D(s.coord)?0:Yo.compare(this._segmentOctant,this.coord,s.coord)},Gs.prototype.isEndPoint=function(o){return this.segmentIndex===0&&!this._isInterior||this.segmentIndex===o},Gs.prototype.isInterior=function(){return this._isInterior},Gs.prototype.interfaces_=function(){return[he]},Gs.prototype.getClass=function(){return Gs};var Do=function(){this._nodeMap=new Re,this._edge=null;var o=arguments[0];this._edge=o};Do.prototype.getSplitCoordinates=function(){var o=new Co;this.addEndpoints();for(var s=this.iterator(),d=s.next();s.hasNext();){var _=s.next();this.addEdgeCoordinates(d,_,o),d=_}return o.toCoordinateArray()},Do.prototype.addCollapsedNodes=function(){var o=new Gr;this.findCollapsesFromInsertedNodes(o),this.findCollapsesFromExistingVertices(o);for(var s=o.iterator();s.hasNext();){var d=s.next().intValue();this.add(this._edge.getCoordinate(d),d)}},Do.prototype.print=function(o){o.println("Intersections:");for(var s=this.iterator();s.hasNext();)s.next().print(o)},Do.prototype.findCollapsesFromExistingVertices=function(o){for(var s=0;s<this._edge.size()-2;s++){var d=this._edge.getCoordinate(s),_=this._edge.getCoordinate(s+2);d.equals2D(_)&&o.add(new Ne(s+1))}},Do.prototype.addEdgeCoordinates=function(o,s,d){var _=this._edge.getCoordinate(s.segmentIndex),w=s.isInterior()||!s.coord.equals2D(_);d.add(new Y(o.coord),!1);for(var j=o.segmentIndex+1;j<=s.segmentIndex;j++)d.add(this._edge.getCoordinate(j));w&&d.add(new Y(s.coord))},Do.prototype.iterator=function(){return this._nodeMap.values().iterator()},Do.prototype.addSplitEdges=function(o){this.addEndpoints(),this.addCollapsedNodes();for(var s=this.iterator(),d=s.next();s.hasNext();){var _=s.next(),w=this.createSplitEdge(d,_);o.add(w),d=_}},Do.prototype.findCollapseIndex=function(o,s,d){if(!o.coord.equals2D(s.coord))return!1;var _=s.segmentIndex-o.segmentIndex;return s.isInterior()||_--,_===1&&(d[0]=o.segmentIndex+1,!0)},Do.prototype.findCollapsesFromInsertedNodes=function(o){for(var s=new Array(1).fill(null),d=this.iterator(),_=d.next();d.hasNext();){var w=d.next();this.findCollapseIndex(_,w,s)&&o.add(new Ne(s[0])),_=w}},Do.prototype.getEdge=function(){return this._edge},Do.prototype.addEndpoints=function(){var o=this._edge.size()-1;this.add(this._edge.getCoordinate(0),0),this.add(this._edge.getCoordinate(o),o)},Do.prototype.createSplitEdge=function(o,s){var d=s.segmentIndex-o.segmentIndex+2,_=this._edge.getCoordinate(s.segmentIndex),w=s.isInterior()||!s.coord.equals2D(_);w||d--;var j=new Array(d).fill(null),ie=0;j[ie++]=new Y(o.coord);for(var ke=o.segmentIndex+1;ke<=s.segmentIndex;ke++)j[ie++]=this._edge.getCoordinate(ke);return w&&(j[ie]=new Y(s.coord)),new Ma(j,this._edge.getData())},Do.prototype.add=function(o,s){var d=new Gs(this._edge,o,s,this._edge.getSegmentOctant(s)),_=this._nodeMap.get(d);return _!==null?(Lt.isTrue(_.coord.equals2D(o),"Found equal nodes with different coordinates"),_):(this._nodeMap.put(d,d),d)},Do.prototype.checkSplitEdgesCorrectness=function(o){var s=this._edge.getCoordinates(),d=o.get(0).getCoordinate(0);if(!d.equals2D(s[0]))throw new ki("bad split edge start point at "+d);var _=o.get(o.size()-1).getCoordinates(),w=_[_.length-1];if(!w.equals2D(s[s.length-1]))throw new ki("bad split edge end point at "+w)},Do.prototype.interfaces_=function(){return[]},Do.prototype.getClass=function(){return Do};var fa=function(){};fa.prototype.interfaces_=function(){return[]},fa.prototype.getClass=function(){return fa},fa.octant=function(){if(typeof arguments[0]=="number"&&typeof arguments[1]=="number"){var o=arguments[0],s=arguments[1];if(o===0&&s===0)throw new we("Cannot compute the octant for point ( "+o+", "+s+" )");var d=Math.abs(o),_=Math.abs(s);return o>=0?s>=0?d>=_?0:1:d>=_?7:6:s>=0?d>=_?3:2:d>=_?4:5}if(arguments[0]instanceof Y&&arguments[1]instanceof Y){var w=arguments[0],j=arguments[1],ie=j.x-w.x,ke=j.y-w.y;if(ie===0&&ke===0)throw new we("Cannot compute the octant for two identical points "+w);return fa.octant(ie,ke)}};var is=function(){};is.prototype.getCoordinates=function(){},is.prototype.size=function(){},is.prototype.getCoordinate=function(o){},is.prototype.isClosed=function(){},is.prototype.setData=function(o){},is.prototype.getData=function(){},is.prototype.interfaces_=function(){return[]},is.prototype.getClass=function(){return is};var Rl=function(){};Rl.prototype.addIntersection=function(o,s){},Rl.prototype.interfaces_=function(){return[is]},Rl.prototype.getClass=function(){return Rl};var Ma=function(){this._nodeList=new Do(this),this._pts=null,this._data=null;var o=arguments[0],s=arguments[1];this._pts=o,this._data=s};Ma.prototype.getCoordinates=function(){return this._pts},Ma.prototype.size=function(){return this._pts.length},Ma.prototype.getCoordinate=function(o){return this._pts[o]},Ma.prototype.isClosed=function(){return this._pts[0].equals(this._pts[this._pts.length-1])},Ma.prototype.getSegmentOctant=function(o){return o===this._pts.length-1?-1:this.safeOctant(this.getCoordinate(o),this.getCoordinate(o+1))},Ma.prototype.setData=function(o){this._data=o},Ma.prototype.safeOctant=function(o,s){return o.equals2D(s)?0:fa.octant(o,s)},Ma.prototype.getData=function(){return this._data},Ma.prototype.addIntersection=function(){if(arguments.length===2){var o=arguments[0],s=arguments[1];this.addIntersectionNode(o,s)}else if(arguments.length===4){var d=arguments[0],_=arguments[1],w=arguments[3],j=new Y(d.getIntersection(w));this.addIntersection(j,_)}},Ma.prototype.toString=function(){return yn.toLineString(new Va(this._pts))},Ma.prototype.getNodeList=function(){return this._nodeList},Ma.prototype.addIntersectionNode=function(o,s){var d=s,_=d+1;if(_<this._pts.length){var w=this._pts[_];o.equals2D(w)&&(d=_)}return this._nodeList.add(o,d)},Ma.prototype.addIntersections=function(o,s,d){for(var _=0;_<o.getIntersectionNum();_++)this.addIntersection(o,s,d,_)},Ma.prototype.interfaces_=function(){return[Rl]},Ma.prototype.getClass=function(){return Ma},Ma.getNodedSubstrings=function(){if(arguments.length===1){var o=arguments[0],s=new Gr;return Ma.getNodedSubstrings(o,s),s}if(arguments.length===2)for(var d=arguments[0],_=arguments[1],w=d.iterator();w.hasNext();)w.next().getNodeList().addSplitEdges(_)};var Sn=function(){if(this.p0=null,this.p1=null,arguments.length===0)this.p0=new Y,this.p1=new Y;else if(arguments.length===1){var o=arguments[0];this.p0=new Y(o.p0),this.p1=new Y(o.p1)}else if(arguments.length===2)this.p0=arguments[0],this.p1=arguments[1];else if(arguments.length===4){var s=arguments[0],d=arguments[1],_=arguments[2],w=arguments[3];this.p0=new Y(s,d),this.p1=new Y(_,w)}},vl={serialVersionUID:{configurable:!0}};Sn.prototype.minX=function(){return Math.min(this.p0.x,this.p1.x)},Sn.prototype.orientationIndex=function(){if(arguments[0]instanceof Sn){var o=arguments[0],s=wt.orientationIndex(this.p0,this.p1,o.p0),d=wt.orientationIndex(this.p0,this.p1,o.p1);return s>=0&&d>=0||s<=0&&d<=0?Math.max(s,d):0}if(arguments[0]instanceof Y){var _=arguments[0];return wt.orientationIndex(this.p0,this.p1,_)}},Sn.prototype.toGeometry=function(o){return o.createLineString([this.p0,this.p1])},Sn.prototype.isVertical=function(){return this.p0.x===this.p1.x},Sn.prototype.equals=function(o){if(!(o instanceof Sn))return!1;var s=o;return this.p0.equals(s.p0)&&this.p1.equals(s.p1)},Sn.prototype.intersection=function(o){var s=new $e;return s.computeIntersection(this.p0,this.p1,o.p0,o.p1),s.hasIntersection()?s.getIntersection(0):null},Sn.prototype.project=function(){if(arguments[0]instanceof Y){var o=arguments[0];if(o.equals(this.p0)||o.equals(this.p1))return new Y(o);var s=this.projectionFactor(o),d=new Y;return d.x=this.p0.x+s*(this.p1.x-this.p0.x),d.y=this.p0.y+s*(this.p1.y-this.p0.y),d}if(arguments[0]instanceof Sn){var _=arguments[0],w=this.projectionFactor(_.p0),j=this.projectionFactor(_.p1);if(w>=1&&j>=1||w<=0&&j<=0)return null;var ie=this.project(_.p0);w<0&&(ie=this.p0),w>1&&(ie=this.p1);var ke=this.project(_.p1);return j<0&&(ke=this.p0),j>1&&(ke=this.p1),new Sn(ie,ke)}},Sn.prototype.normalize=function(){this.p1.compareTo(this.p0)<0&&this.reverse()},Sn.prototype.angle=function(){return Math.atan2(this.p1.y-this.p0.y,this.p1.x-this.p0.x)},Sn.prototype.getCoordinate=function(o){return o===0?this.p0:this.p1},Sn.prototype.distancePerpendicular=function(o){return wt.distancePointLinePerpendicular(o,this.p0,this.p1)},Sn.prototype.minY=function(){return Math.min(this.p0.y,this.p1.y)},Sn.prototype.midPoint=function(){return Sn.midPoint(this.p0,this.p1)},Sn.prototype.projectionFactor=function(o){if(o.equals(this.p0))return 0;if(o.equals(this.p1))return 1;var s=this.p1.x-this.p0.x,d=this.p1.y-this.p0.y,_=s*s+d*d;return _<=0?ne.NaN:((o.x-this.p0.x)*s+(o.y-this.p0.y)*d)/_},Sn.prototype.closestPoints=function(o){var s=this.intersection(o);if(s!==null)return[s,s];var d=new Array(2).fill(null),_=ne.MAX_VALUE,w=null,j=this.closestPoint(o.p0);_=j.distance(o.p0),d[0]=j,d[1]=o.p0;var ie=this.closestPoint(o.p1);(w=ie.distance(o.p1))<_&&(_=w,d[0]=ie,d[1]=o.p1);var ke=o.closestPoint(this.p0);(w=ke.distance(this.p0))<_&&(_=w,d[0]=this.p0,d[1]=ke);var tt=o.closestPoint(this.p1);return(w=tt.distance(this.p1))<_&&(_=w,d[0]=this.p1,d[1]=tt),d},Sn.prototype.closestPoint=function(o){var s=this.projectionFactor(o);return s>0&&s<1?this.project(o):this.p0.distance(o)<this.p1.distance(o)?this.p0:this.p1},Sn.prototype.maxX=function(){return Math.max(this.p0.x,this.p1.x)},Sn.prototype.getLength=function(){return this.p0.distance(this.p1)},Sn.prototype.compareTo=function(o){var s=o,d=this.p0.compareTo(s.p0);return d!==0?d:this.p1.compareTo(s.p1)},Sn.prototype.reverse=function(){var o=this.p0;this.p0=this.p1,this.p1=o},Sn.prototype.equalsTopo=function(o){return this.p0.equals(o.p0)&&(this.p1.equals(o.p1)||this.p0.equals(o.p1))&&this.p1.equals(o.p0)},Sn.prototype.lineIntersection=function(o){try{return Jr.intersection(this.p0,this.p1,o.p0,o.p1)}catch(s){if(!(s instanceof Cr))throw s}return null},Sn.prototype.maxY=function(){return Math.max(this.p0.y,this.p1.y)},Sn.prototype.pointAlongOffset=function(o,s){var d=this.p0.x+o*(this.p1.x-this.p0.x),_=this.p0.y+o*(this.p1.y-this.p0.y),w=this.p1.x-this.p0.x,j=this.p1.y-this.p0.y,ie=Math.sqrt(w*w+j*j),ke=0,tt=0;if(s!==0){if(ie<=0)throw new Error("Cannot compute offset from zero-length line segment");ke=s*w/ie,tt=s*j/ie}return new Y(d-tt,_+ke)},Sn.prototype.setCoordinates=function(){if(arguments.length===1){var o=arguments[0];this.setCoordinates(o.p0,o.p1)}else if(arguments.length===2){var s=arguments[0],d=arguments[1];this.p0.x=s.x,this.p0.y=s.y,this.p1.x=d.x,this.p1.y=d.y}},Sn.prototype.segmentFraction=function(o){var s=this.projectionFactor(o);return s<0?s=0:(s>1||ne.isNaN(s))&&(s=1),s},Sn.prototype.toString=function(){return"LINESTRING( "+this.p0.x+" "+this.p0.y+", "+this.p1.x+" "+this.p1.y+")"},Sn.prototype.isHorizontal=function(){return this.p0.y===this.p1.y},Sn.prototype.distance=function(){if(arguments[0]instanceof Sn){var o=arguments[0];return wt.distanceLineLine(this.p0,this.p1,o.p0,o.p1)}if(arguments[0]instanceof Y){var s=arguments[0];return wt.distancePointLine(s,this.p0,this.p1)}},Sn.prototype.pointAlong=function(o){var s=new Y;return s.x=this.p0.x+o*(this.p1.x-this.p0.x),s.y=this.p0.y+o*(this.p1.y-this.p0.y),s},Sn.prototype.hashCode=function(){var o=ne.doubleToLongBits(this.p0.x);o^=31*ne.doubleToLongBits(this.p0.y);var s=Math.trunc(o)^Math.trunc(o>>32),d=ne.doubleToLongBits(this.p1.x);return d^=31*ne.doubleToLongBits(this.p1.y),s^(Math.trunc(d)^Math.trunc(d>>32))},Sn.prototype.interfaces_=function(){return[he,L]},Sn.prototype.getClass=function(){return Sn},Sn.midPoint=function(o,s){return new Y((o.x+s.x)/2,(o.y+s.y)/2)},vl.serialVersionUID.get=function(){return 0x2d2172135f411c00},Object.defineProperties(Sn,vl);var tc=function(){this.tempEnv1=new xr,this.tempEnv2=new xr,this._overlapSeg1=new Sn,this._overlapSeg2=new Sn};tc.prototype.overlap=function(){if(arguments.length!==2){if(arguments.length===4){var o=arguments[0],s=arguments[1],d=arguments[2],_=arguments[3];o.getLineSegment(s,this._overlapSeg1),d.getLineSegment(_,this._overlapSeg2),this.overlap(this._overlapSeg1,this._overlapSeg2)}}},tc.prototype.interfaces_=function(){return[]},tc.prototype.getClass=function(){return tc};var Ka=function(){this._pts=null,this._start=null,this._end=null,this._env=null,this._context=null,this._id=null;var o=arguments[0],s=arguments[1],d=arguments[2],_=arguments[3];this._pts=o,this._start=s,this._end=d,this._context=_};Ka.prototype.getLineSegment=function(o,s){s.p0=this._pts[o],s.p1=this._pts[o+1]},Ka.prototype.computeSelect=function(o,s,d,_){var w=this._pts[s],j=this._pts[d];if(_.tempEnv1.init(w,j),d-s==1)return _.select(this,s),null;if(!o.intersects(_.tempEnv1))return null;var ie=Math.trunc((s+d)/2);s<ie&&this.computeSelect(o,s,ie,_),ie<d&&this.computeSelect(o,ie,d,_)},Ka.prototype.getCoordinates=function(){for(var o=new Array(this._end-this._start+1).fill(null),s=0,d=this._start;d<=this._end;d++)o[s++]=this._pts[d];return o},Ka.prototype.computeOverlaps=function(o,s){this.computeOverlapsInternal(this._start,this._end,o,o._start,o._end,s)},Ka.prototype.setId=function(o){this._id=o},Ka.prototype.select=function(o,s){this.computeSelect(o,this._start,this._end,s)},Ka.prototype.getEnvelope=function(){if(this._env===null){var o=this._pts[this._start],s=this._pts[this._end];this._env=new xr(o,s)}return this._env},Ka.prototype.getEndIndex=function(){return this._end},Ka.prototype.getStartIndex=function(){return this._start},Ka.prototype.getContext=function(){return this._context},Ka.prototype.getId=function(){return this._id},Ka.prototype.computeOverlapsInternal=function(o,s,d,_,w,j){var ie=this._pts[o],ke=this._pts[s],tt=d._pts[_],Pt=d._pts[w];if(s-o==1&&w-_==1)return j.overlap(this,o,d,_),null;if(j.tempEnv1.init(ie,ke),j.tempEnv2.init(tt,Pt),!j.tempEnv1.intersects(j.tempEnv2))return null;var tr=Math.trunc((o+s)/2),st=Math.trunc((_+w)/2);o<tr&&(_<st&&this.computeOverlapsInternal(o,tr,d,_,st,j),st<w&&this.computeOverlapsInternal(o,tr,d,st,w,j)),tr<s&&(_<st&&this.computeOverlapsInternal(tr,s,d,_,st,j),st<w&&this.computeOverlapsInternal(tr,s,d,st,w,j))},Ka.prototype.interfaces_=function(){return[]},Ka.prototype.getClass=function(){return Ka};var fs=function(){};fs.prototype.interfaces_=function(){return[]},fs.prototype.getClass=function(){return fs},fs.getChainStartIndices=function(o){var s=0,d=new Gr;d.add(new Ne(s));do{var _=fs.findChainEnd(o,s);d.add(new Ne(_)),s=_}while(s<o.length-1);return fs.toIntArray(d)},fs.findChainEnd=function(o,s){for(var d=s;d<o.length-1&&o[d].equals2D(o[d+1]);)d++;if(d>=o.length-1)return o.length-1;for(var _=ca.quadrant(o[d],o[d+1]),w=s+1;w<o.length&&!(!o[w-1].equals2D(o[w])&&ca.quadrant(o[w-1],o[w])!==_);)w++;return w-1},fs.getChains=function(){if(arguments.length===1){var o=arguments[0];return fs.getChains(o,null)}if(arguments.length===2){for(var s=arguments[0],d=arguments[1],_=new Gr,w=fs.getChainStartIndices(s),j=0;j<w.length-1;j++){var ie=new Ka(s,w[j],w[j+1],d);_.add(ie)}return _}},fs.toIntArray=function(o){for(var s=new Array(o.size()).fill(null),d=0;d<s.length;d++)s[d]=o.get(d).intValue();return s};var gl=function(){};gl.prototype.computeNodes=function(o){},gl.prototype.getNodedSubstrings=function(){},gl.prototype.interfaces_=function(){return[]},gl.prototype.getClass=function(){return gl};var gc=function(){if(this._segInt=null,arguments.length!==0){if(arguments.length===1){var o=arguments[0];this.setSegmentIntersector(o)}}};gc.prototype.setSegmentIntersector=function(o){this._segInt=o},gc.prototype.interfaces_=function(){return[gl]},gc.prototype.getClass=function(){return gc};var mc=function(o){function s(_){_?o.call(this,_):o.call(this),this._monoChains=new Gr,this._index=new qc,this._idCounter=0,this._nodedSegStrings=null,this._nOverlaps=0}o&&(s.__proto__=o),(s.prototype=Object.create(o&&o.prototype)).constructor=s;var d={SegmentOverlapAction:{configurable:!0}};return s.prototype.getMonotoneChains=function(){return this._monoChains},s.prototype.getNodedSubstrings=function(){return Ma.getNodedSubstrings(this._nodedSegStrings)},s.prototype.getIndex=function(){return this._index},s.prototype.add=function(_){for(var w=fs.getChains(_.getCoordinates(),_).iterator();w.hasNext();){var j=w.next();j.setId(this._idCounter++),this._index.insert(j.getEnvelope(),j),this._monoChains.add(j)}},s.prototype.computeNodes=function(_){this._nodedSegStrings=_;for(var w=_.iterator();w.hasNext();)this.add(w.next());this.intersectChains()},s.prototype.intersectChains=function(){for(var _=new xf(this._segInt),w=this._monoChains.iterator();w.hasNext();)for(var j=w.next(),ie=this._index.query(j.getEnvelope()).iterator();ie.hasNext();){var ke=ie.next();if(ke.getId()>j.getId()&&(j.computeOverlaps(ke,_),this._nOverlaps++),this._segInt.isDone())return null}},s.prototype.interfaces_=function(){return[]},s.prototype.getClass=function(){return s},d.SegmentOverlapAction.get=function(){return xf},Object.defineProperties(s,d),s}(gc),xf=function(o){function s(){o.call(this),this._si=null;var d=arguments[0];this._si=d}return o&&(s.__proto__=o),s.prototype=Object.create(o&&o.prototype),s.prototype.constructor=s,s.prototype.overlap=function(){if(arguments.length!==4)return o.prototype.overlap.apply(this,arguments);var d=arguments[0],_=arguments[1],w=arguments[2],j=arguments[3],ie=d.getContext(),ke=w.getContext();this._si.processIntersections(ie,_,ke,j)},s.prototype.interfaces_=function(){return[]},s.prototype.getClass=function(){return s},s}(tc),ea=function o(){if(this._quadrantSegments=o.DEFAULT_QUADRANT_SEGMENTS,this._endCapStyle=o.CAP_ROUND,this._joinStyle=o.JOIN_ROUND,this._mitreLimit=o.DEFAULT_MITRE_LIMIT,this._isSingleSided=!1,this._simplifyFactor=o.DEFAULT_SIMPLIFY_FACTOR,arguments.length!==0){if(arguments.length===1){var s=arguments[0];this.setQuadrantSegments(s)}else if(arguments.length===2){var d=arguments[0],_=arguments[1];this.setQuadrantSegments(d),this.setEndCapStyle(_)}else if(arguments.length===4){var w=arguments[0],j=arguments[1],ie=arguments[2],ke=arguments[3];this.setQuadrantSegments(w),this.setEndCapStyle(j),this.setJoinStyle(ie),this.setMitreLimit(ke)}}},ku={CAP_ROUND:{configurable:!0},CAP_FLAT:{configurable:!0},CAP_SQUARE:{configurable:!0},JOIN_ROUND:{configurable:!0},JOIN_MITRE:{configurable:!0},JOIN_BEVEL:{configurable:!0},DEFAULT_QUADRANT_SEGMENTS:{configurable:!0},DEFAULT_MITRE_LIMIT:{configurable:!0},DEFAULT_SIMPLIFY_FACTOR:{configurable:!0}};ea.prototype.getEndCapStyle=function(){return this._endCapStyle},ea.prototype.isSingleSided=function(){return this._isSingleSided},ea.prototype.setQuadrantSegments=function(o){this._quadrantSegments=o,this._quadrantSegments===0&&(this._joinStyle=ea.JOIN_BEVEL),this._quadrantSegments<0&&(this._joinStyle=ea.JOIN_MITRE,this._mitreLimit=Math.abs(this._quadrantSegments)),o<=0&&(this._quadrantSegments=1),this._joinStyle!==ea.JOIN_ROUND&&(this._quadrantSegments=ea.DEFAULT_QUADRANT_SEGMENTS)},ea.prototype.getJoinStyle=function(){return this._joinStyle},ea.prototype.setJoinStyle=function(o){this._joinStyle=o},ea.prototype.setSimplifyFactor=function(o){this._simplifyFactor=o<0?0:o},ea.prototype.getSimplifyFactor=function(){return this._simplifyFactor},ea.prototype.getQuadrantSegments=function(){return this._quadrantSegments},ea.prototype.setEndCapStyle=function(o){this._endCapStyle=o},ea.prototype.getMitreLimit=function(){return this._mitreLimit},ea.prototype.setMitreLimit=function(o){this._mitreLimit=o},ea.prototype.setSingleSided=function(o){this._isSingleSided=o},ea.prototype.interfaces_=function(){return[]},ea.prototype.getClass=function(){return ea},ea.bufferDistanceError=function(o){var s=Math.PI/2/o;return 1-Math.cos(s/2)},ku.CAP_ROUND.get=function(){return 1},ku.CAP_FLAT.get=function(){return 2},ku.CAP_SQUARE.get=function(){return 3},ku.JOIN_ROUND.get=function(){return 1},ku.JOIN_MITRE.get=function(){return 2},ku.JOIN_BEVEL.get=function(){return 3},ku.DEFAULT_QUADRANT_SEGMENTS.get=function(){return 8},ku.DEFAULT_MITRE_LIMIT.get=function(){return 5},ku.DEFAULT_SIMPLIFY_FACTOR.get=function(){return .01},Object.defineProperties(ea,ku);var na=function(o){this._distanceTol=null,this._isDeleted=null,this._angleOrientation=wt.COUNTERCLOCKWISE,this._inputLine=o||null},Za={INIT:{configurable:!0},DELETE:{configurable:!0},KEEP:{configurable:!0},NUM_PTS_TO_CHECK:{configurable:!0}};na.prototype.isDeletable=function(o,s,d,_){var w=this._inputLine[o],j=this._inputLine[s],ie=this._inputLine[d];return!!this.isConcave(w,j,ie)&&!!this.isShallow(w,j,ie,_)&&this.isShallowSampled(w,j,o,d,_)},na.prototype.deleteShallowConcavities=function(){for(var o=1,s=this.findNextNonDeletedIndex(o),d=this.findNextNonDeletedIndex(s),_=!1;d<this._inputLine.length;){var w=!1;this.isDeletable(o,s,d,this._distanceTol)&&(this._isDeleted[s]=na.DELETE,w=!0,_=!0),o=w?d:s,s=this.findNextNonDeletedIndex(o),d=this.findNextNonDeletedIndex(s)}return _},na.prototype.isShallowConcavity=function(o,s,d,_){return wt.computeOrientation(o,s,d)!==this._angleOrientation?!1:wt.distancePointLine(s,o,d)<_},na.prototype.isShallowSampled=function(o,s,d,_,w){var j=Math.trunc((_-d)/na.NUM_PTS_TO_CHECK);j<=0&&(j=1);for(var ie=d;ie<_;ie+=j)if(!this.isShallow(o,s,this._inputLine[ie],w))return!1;return!0},na.prototype.isConcave=function(o,s,d){var _=wt.computeOrientation(o,s,d)===this._angleOrientation;return _},na.prototype.simplify=function(o){this._distanceTol=Math.abs(o),o<0&&(this._angleOrientation=wt.CLOCKWISE),this._isDeleted=new Array(this._inputLine.length).fill(null);var s=!1;do s=this.deleteShallowConcavities();while(s);return this.collapseLine()},na.prototype.findNextNonDeletedIndex=function(o){for(var s=o+1;s<this._inputLine.length&&this._isDeleted[s]===na.DELETE;)s++;return s},na.prototype.isShallow=function(o,s,d,_){return wt.distancePointLine(s,o,d)<_},na.prototype.collapseLine=function(){for(var o=new Co,s=0;s<this._inputLine.length;s++)this._isDeleted[s]!==na.DELETE&&o.add(this._inputLine[s]);return o.toCoordinateArray()},na.prototype.interfaces_=function(){return[]},na.prototype.getClass=function(){return na},na.simplify=function(o,s){return new na(o).simplify(s)},Za.INIT.get=function(){return 0},Za.DELETE.get=function(){return 1},Za.KEEP.get=function(){return 1},Za.NUM_PTS_TO_CHECK.get=function(){return 10},Object.defineProperties(na,Za);var ko=function(){this._ptList=null,this._precisionModel=null,this._minimimVertexDistance=0,this._ptList=new Gr},Nf={COORDINATE_ARRAY_TYPE:{configurable:!0}};ko.prototype.getCoordinates=function(){return this._ptList.toArray(ko.COORDINATE_ARRAY_TYPE)},ko.prototype.setPrecisionModel=function(o){this._precisionModel=o},ko.prototype.addPt=function(o){var s=new Y(o);if(this._precisionModel.makePrecise(s),this.isRedundant(s))return null;this._ptList.add(s)},ko.prototype.revere=function(){},ko.prototype.addPts=function(o,s){if(s)for(var d=0;d<o.length;d++)this.addPt(o[d]);else for(var _=o.length-1;_>=0;_--)this.addPt(o[_])},ko.prototype.isRedundant=function(o){if(this._ptList.size()<1)return!1;var s=this._ptList.get(this._ptList.size()-1);return o.distance(s)<this._minimimVertexDistance},ko.prototype.toString=function(){return new Ai().createLineString(this.getCoordinates()).toString()},ko.prototype.closeRing=function(){if(this._ptList.size()<1)return null;var o=new Y(this._ptList.get(0)),s=this._ptList.get(this._ptList.size()-1);if(o.equals(s))return null;this._ptList.add(o)},ko.prototype.setMinimumVertexDistance=function(o){this._minimimVertexDistance=o},ko.prototype.interfaces_=function(){return[]},ko.prototype.getClass=function(){return ko},Nf.COORDINATE_ARRAY_TYPE.get=function(){return new Array(0).fill(null)},Object.defineProperties(ko,Nf);var ui=function(){},hs={PI_TIMES_2:{configurable:!0},PI_OVER_2:{configurable:!0},PI_OVER_4:{configurable:!0},COUNTERCLOCKWISE:{configurable:!0},CLOCKWISE:{configurable:!0},NONE:{configurable:!0}};ui.prototype.interfaces_=function(){return[]},ui.prototype.getClass=function(){return ui},ui.toDegrees=function(o){return 180*o/Math.PI},ui.normalize=function(o){for(;o>Math.PI;)o-=ui.PI_TIMES_2;for(;o<=-Math.PI;)o+=ui.PI_TIMES_2;return o},ui.angle=function(){if(arguments.length===1){var o=arguments[0];return Math.atan2(o.y,o.x)}if(arguments.length===2){var s=arguments[0],d=arguments[1],_=d.x-s.x,w=d.y-s.y;return Math.atan2(w,_)}},ui.isAcute=function(o,s,d){var _=o.x-s.x,w=o.y-s.y;return _*(d.x-s.x)+w*(d.y-s.y)>0},ui.isObtuse=function(o,s,d){var _=o.x-s.x,w=o.y-s.y;return _*(d.x-s.x)+w*(d.y-s.y)<0},ui.interiorAngle=function(o,s,d){var _=ui.angle(s,o),w=ui.angle(s,d);return Math.abs(w-_)},ui.normalizePositive=function(o){if(o<0){for(;o<0;)o+=ui.PI_TIMES_2;o>=ui.PI_TIMES_2&&(o=0)}else{for(;o>=ui.PI_TIMES_2;)o-=ui.PI_TIMES_2;o<0&&(o=0)}return o},ui.angleBetween=function(o,s,d){var _=ui.angle(s,o),w=ui.angle(s,d);return ui.diff(_,w)},ui.diff=function(o,s){var d=null;return(d=o<s?s-o:o-s)>Math.PI&&(d=2*Math.PI-d),d},ui.toRadians=function(o){return o*Math.PI/180},ui.getTurn=function(o,s){var d=Math.sin(s-o);return d>0?ui.COUNTERCLOCKWISE:d<0?ui.CLOCKWISE:ui.NONE},ui.angleBetweenOriented=function(o,s,d){var _=ui.angle(s,o),w=ui.angle(s,d)-_;return w<=-Math.PI?w+ui.PI_TIMES_2:w>Math.PI?w-ui.PI_TIMES_2:w},hs.PI_TIMES_2.get=function(){return 2*Math.PI},hs.PI_OVER_2.get=function(){return Math.PI/2},hs.PI_OVER_4.get=function(){return Math.PI/4},hs.COUNTERCLOCKWISE.get=function(){return wt.COUNTERCLOCKWISE},hs.CLOCKWISE.get=function(){return wt.CLOCKWISE},hs.NONE.get=function(){return wt.COLLINEAR},Object.defineProperties(ui,hs);var aa=function o(){this._maxCurveSegmentError=0,this._filletAngleQuantum=null,this._closingSegLengthFactor=1,this._segList=null,this._distance=0,this._precisionModel=null,this._bufParams=null,this._li=null,this._s0=null,this._s1=null,this._s2=null,this._seg0=new Sn,this._seg1=new Sn,this._offset0=new Sn,this._offset1=new Sn,this._side=0,this._hasNarrowConcaveAngle=!1;var s=arguments[0],d=arguments[1],_=arguments[2];this._precisionModel=s,this._bufParams=d,this._li=new $e,this._filletAngleQuantum=Math.PI/2/d.getQuadrantSegments(),d.getQuadrantSegments()>=8&&d.getJoinStyle()===ea.JOIN_ROUND&&(this._closingSegLengthFactor=o.MAX_CLOSING_SEG_LEN_FACTOR),this.init(_)},Ts={OFFSET_SEGMENT_SEPARATION_FACTOR:{configurable:!0},INSIDE_TURN_VERTEX_SNAP_DISTANCE_FACTOR:{configurable:!0},CURVE_VERTEX_SNAP_DISTANCE_FACTOR:{configurable:!0},MAX_CLOSING_SEG_LEN_FACTOR:{configurable:!0}};aa.prototype.addNextSegment=function(o,s){if(this._s0=this._s1,this._s1=this._s2,this._s2=o,this._seg0.setCoordinates(this._s0,this._s1),this.computeOffsetSegment(this._seg0,this._side,this._distance,this._offset0),this._seg1.setCoordinates(this._s1,this._s2),this.computeOffsetSegment(this._seg1,this._side,this._distance,this._offset1),this._s1.equals(this._s2))return null;var d=wt.computeOrientation(this._s0,this._s1,this._s2),_=d===wt.CLOCKWISE&&this._side===Ae.LEFT||d===wt.COUNTERCLOCKWISE&&this._side===Ae.RIGHT;d===0?this.addCollinear(s):_?this.addOutsideTurn(d,s):this.addInsideTurn(d,s)},aa.prototype.addLineEndCap=function(o,s){var d=new Sn(o,s),_=new Sn;this.computeOffsetSegment(d,Ae.LEFT,this._distance,_);var w=new Sn;this.computeOffsetSegment(d,Ae.RIGHT,this._distance,w);var j=s.x-o.x,ie=s.y-o.y,ke=Math.atan2(ie,j);switch(this._bufParams.getEndCapStyle()){case ea.CAP_ROUND:this._segList.addPt(_.p1),this.addFilletArc(s,ke+Math.PI/2,ke-Math.PI/2,wt.CLOCKWISE,this._distance),this._segList.addPt(w.p1);break;case ea.CAP_FLAT:this._segList.addPt(_.p1),this._segList.addPt(w.p1);break;case ea.CAP_SQUARE:var tt=new Y;tt.x=Math.abs(this._distance)*Math.cos(ke),tt.y=Math.abs(this._distance)*Math.sin(ke);var Pt=new Y(_.p1.x+tt.x,_.p1.y+tt.y),tr=new Y(w.p1.x+tt.x,w.p1.y+tt.y);this._segList.addPt(Pt),this._segList.addPt(tr)}},aa.prototype.getCoordinates=function(){return this._segList.getCoordinates()},aa.prototype.addMitreJoin=function(o,s,d,_){var w=!0,j=null;try{j=Jr.intersection(s.p0,s.p1,d.p0,d.p1),(_<=0?1:j.distance(o)/Math.abs(_))>this._bufParams.getMitreLimit()&&(w=!1)}catch(ie){if(!(ie instanceof Cr))throw ie;j=new Y(0,0),w=!1}w?this._segList.addPt(j):this.addLimitedMitreJoin(s,d,_,this._bufParams.getMitreLimit())},aa.prototype.addFilletCorner=function(o,s,d,_,w){var j=s.x-o.x,ie=s.y-o.y,ke=Math.atan2(ie,j),tt=d.x-o.x,Pt=d.y-o.y,tr=Math.atan2(Pt,tt);_===wt.CLOCKWISE?ke<=tr&&(ke+=2*Math.PI):ke>=tr&&(ke-=2*Math.PI),this._segList.addPt(s),this.addFilletArc(o,ke,tr,_,w),this._segList.addPt(d)},aa.prototype.addOutsideTurn=function(o,s){if(this._offset0.p1.distance(this._offset1.p0)<this._distance*aa.OFFSET_SEGMENT_SEPARATION_FACTOR)return this._segList.addPt(this._offset0.p1),null;this._bufParams.getJoinStyle()===ea.JOIN_MITRE?this.addMitreJoin(this._s1,this._offset0,this._offset1,this._distance):this._bufParams.getJoinStyle()===ea.JOIN_BEVEL?this.addBevelJoin(this._offset0,this._offset1):(s&&this._segList.addPt(this._offset0.p1),this.addFilletCorner(this._s1,this._offset0.p1,this._offset1.p0,o,this._distance),this._segList.addPt(this._offset1.p0))},aa.prototype.createSquare=function(o){this._segList.addPt(new Y(o.x+this._distance,o.y+this._distance)),this._segList.addPt(new Y(o.x+this._distance,o.y-this._distance)),this._segList.addPt(new Y(o.x-this._distance,o.y-this._distance)),this._segList.addPt(new Y(o.x-this._distance,o.y+this._distance)),this._segList.closeRing()},aa.prototype.addSegments=function(o,s){this._segList.addPts(o,s)},aa.prototype.addFirstSegment=function(){this._segList.addPt(this._offset1.p0)},aa.prototype.addLastSegment=function(){this._segList.addPt(this._offset1.p1)},aa.prototype.initSideSegments=function(o,s,d){this._s1=o,this._s2=s,this._side=d,this._seg1.setCoordinates(o,s),this.computeOffsetSegment(this._seg1,d,this._distance,this._offset1)},aa.prototype.addLimitedMitreJoin=function(o,s,d,_){var w=this._seg0.p1,j=ui.angle(w,this._seg0.p0),ie=ui.angleBetweenOriented(this._seg0.p0,w,this._seg1.p1)/2,ke=ui.normalize(j+ie),tt=ui.normalize(ke+Math.PI),Pt=_*d,tr=d-Pt*Math.abs(Math.sin(ie)),st=w.x+Pt*Math.cos(tt),Zt=w.y+Pt*Math.sin(tt),Jt=new Y(st,Zt),yr=new Sn(w,Jt),v=yr.pointAlongOffset(1,tr),Pn=yr.pointAlongOffset(1,-tr);this._side===Ae.LEFT?(this._segList.addPt(v),this._segList.addPt(Pn)):(this._segList.addPt(Pn),this._segList.addPt(v))},aa.prototype.computeOffsetSegment=function(o,s,d,_){var w=s===Ae.LEFT?1:-1,j=o.p1.x-o.p0.x,ie=o.p1.y-o.p0.y,ke=Math.sqrt(j*j+ie*ie),tt=w*d*j/ke,Pt=w*d*ie/ke;_.p0.x=o.p0.x-Pt,_.p0.y=o.p0.y+tt,_.p1.x=o.p1.x-Pt,_.p1.y=o.p1.y+tt},aa.prototype.addFilletArc=function(o,s,d,_,w){var j=_===wt.CLOCKWISE?-1:1,ie=Math.abs(s-d),ke=Math.trunc(ie/this._filletAngleQuantum+.5);if(ke<1)return null;for(var tt=ie/ke,Pt=0,tr=new Y;Pt<ie;){var st=s+j*Pt;tr.x=o.x+w*Math.cos(st),tr.y=o.y+w*Math.sin(st),this._segList.addPt(tr),Pt+=tt}},aa.prototype.addInsideTurn=function(o,s){if(this._li.computeIntersection(this._offset0.p0,this._offset0.p1,this._offset1.p0,this._offset1.p1),this._li.hasIntersection())this._segList.addPt(this._li.getIntersection(0));else if(this._hasNarrowConcaveAngle=!0,this._offset0.p1.distance(this._offset1.p0)<this._distance*aa.INSIDE_TURN_VERTEX_SNAP_DISTANCE_FACTOR)this._segList.addPt(this._offset0.p1);else{if(this._segList.addPt(this._offset0.p1),this._closingSegLengthFactor>0){var d=new Y((this._closingSegLengthFactor*this._offset0.p1.x+this._s1.x)/(this._closingSegLengthFactor+1),(this._closingSegLengthFactor*this._offset0.p1.y+this._s1.y)/(this._closingSegLengthFactor+1));this._segList.addPt(d);var _=new Y((this._closingSegLengthFactor*this._offset1.p0.x+this._s1.x)/(this._closingSegLengthFactor+1),(this._closingSegLengthFactor*this._offset1.p0.y+this._s1.y)/(this._closingSegLengthFactor+1));this._segList.addPt(_)}else this._segList.addPt(this._s1);this._segList.addPt(this._offset1.p0)}},aa.prototype.createCircle=function(o){var s=new Y(o.x+this._distance,o.y);this._segList.addPt(s),this.addFilletArc(o,0,2*Math.PI,-1,this._distance),this._segList.closeRing()},aa.prototype.addBevelJoin=function(o,s){this._segList.addPt(o.p1),this._segList.addPt(s.p0)},aa.prototype.init=function(o){this._distance=o,this._maxCurveSegmentError=o*(1-Math.cos(this._filletAngleQuantum/2)),this._segList=new ko,this._segList.setPrecisionModel(this._precisionModel),this._segList.setMinimumVertexDistance(o*aa.CURVE_VERTEX_SNAP_DISTANCE_FACTOR)},aa.prototype.addCollinear=function(o){this._li.computeIntersection(this._s0,this._s1,this._s1,this._s2),this._li.getIntersectionNum()>=2&&(this._bufParams.getJoinStyle()===ea.JOIN_BEVEL||this._bufParams.getJoinStyle()===ea.JOIN_MITRE?(o&&this._segList.addPt(this._offset0.p1),this._segList.addPt(this._offset1.p0)):this.addFilletCorner(this._s1,this._offset0.p1,this._offset1.p0,wt.CLOCKWISE,this._distance))},aa.prototype.closeRing=function(){this._segList.closeRing()},aa.prototype.hasNarrowConcaveAngle=function(){return this._hasNarrowConcaveAngle},aa.prototype.interfaces_=function(){return[]},aa.prototype.getClass=function(){return aa},Ts.OFFSET_SEGMENT_SEPARATION_FACTOR.get=function(){return .001},Ts.INSIDE_TURN_VERTEX_SNAP_DISTANCE_FACTOR.get=function(){return .001},Ts.CURVE_VERTEX_SNAP_DISTANCE_FACTOR.get=function(){return 1e-6},Ts.MAX_CLOSING_SEG_LEN_FACTOR.get=function(){return 80},Object.defineProperties(aa,Ts);var Ea=function(){this._distance=0,this._precisionModel=null,this._bufParams=null;var o=arguments[0],s=arguments[1];this._precisionModel=o,this._bufParams=s};Ea.prototype.getOffsetCurve=function(o,s){if(this._distance=s,s===0)return null;var d=s<0,_=Math.abs(s),w=this.getSegGen(_);o.length<=1?this.computePointCurve(o[0],w):this.computeOffsetCurve(o,d,w);var j=w.getCoordinates();return d&&_n.reverse(j),j},Ea.prototype.computeSingleSidedBufferCurve=function(o,s,d){var _=this.simplifyTolerance(this._distance);if(s){d.addSegments(o,!0);var w=na.simplify(o,-_),j=w.length-1;d.initSideSegments(w[j],w[j-1],Ae.LEFT),d.addFirstSegment();for(var ie=j-2;ie>=0;ie--)d.addNextSegment(w[ie],!0)}else{d.addSegments(o,!1);var ke=na.simplify(o,_),tt=ke.length-1;d.initSideSegments(ke[0],ke[1],Ae.LEFT),d.addFirstSegment();for(var Pt=2;Pt<=tt;Pt++)d.addNextSegment(ke[Pt],!0)}d.addLastSegment(),d.closeRing()},Ea.prototype.computeRingBufferCurve=function(o,s,d){var _=this.simplifyTolerance(this._distance);s===Ae.RIGHT&&(_=-_);var w=na.simplify(o,_),j=w.length-1;d.initSideSegments(w[j-1],w[0],s);for(var ie=1;ie<=j;ie++){var ke=ie!==1;d.addNextSegment(w[ie],ke)}d.closeRing()},Ea.prototype.computeLineBufferCurve=function(o,s){var d=this.simplifyTolerance(this._distance),_=na.simplify(o,d),w=_.length-1;s.initSideSegments(_[0],_[1],Ae.LEFT);for(var j=2;j<=w;j++)s.addNextSegment(_[j],!0);s.addLastSegment(),s.addLineEndCap(_[w-1],_[w]);var ie=na.simplify(o,-d),ke=ie.length-1;s.initSideSegments(ie[ke],ie[ke-1],Ae.LEFT);for(var tt=ke-2;tt>=0;tt--)s.addNextSegment(ie[tt],!0);s.addLastSegment(),s.addLineEndCap(ie[1],ie[0]),s.closeRing()},Ea.prototype.computePointCurve=function(o,s){switch(this._bufParams.getEndCapStyle()){case ea.CAP_ROUND:s.createCircle(o);break;case ea.CAP_SQUARE:s.createSquare(o)}},Ea.prototype.getLineCurve=function(o,s){if(this._distance=s,s<0&&!this._bufParams.isSingleSided()||s===0)return null;var d=Math.abs(s),_=this.getSegGen(d);if(o.length<=1)this.computePointCurve(o[0],_);else if(this._bufParams.isSingleSided()){var w=s<0;this.computeSingleSidedBufferCurve(o,w,_)}else this.computeLineBufferCurve(o,_);return _.getCoordinates()},Ea.prototype.getBufferParameters=function(){return this._bufParams},Ea.prototype.simplifyTolerance=function(o){return o*this._bufParams.getSimplifyFactor()},Ea.prototype.getRingCurve=function(o,s,d){if(this._distance=d,o.length<=2)return this.getLineCurve(o,d);if(d===0)return Ea.copyCoordinates(o);var _=this.getSegGen(d);return this.computeRingBufferCurve(o,s,_),_.getCoordinates()},Ea.prototype.computeOffsetCurve=function(o,s,d){var _=this.simplifyTolerance(this._distance);if(s){var w=na.simplify(o,-_),j=w.length-1;d.initSideSegments(w[j],w[j-1],Ae.LEFT),d.addFirstSegment();for(var ie=j-2;ie>=0;ie--)d.addNextSegment(w[ie],!0)}else{var ke=na.simplify(o,_),tt=ke.length-1;d.initSideSegments(ke[0],ke[1],Ae.LEFT),d.addFirstSegment();for(var Pt=2;Pt<=tt;Pt++)d.addNextSegment(ke[Pt],!0)}d.addLastSegment()},Ea.prototype.getSegGen=function(o){return new aa(this._precisionModel,this._bufParams,o)},Ea.prototype.interfaces_=function(){return[]},Ea.prototype.getClass=function(){return Ea},Ea.copyCoordinates=function(o){for(var s=new Array(o.length).fill(null),d=0;d<s.length;d++)s[d]=new Y(o[d]);return s};var As=function(){this._subgraphs=null,this._seg=new Sn,this._cga=new wt;var o=arguments[0];this._subgraphs=o},ml={DepthSegment:{configurable:!0}};As.prototype.findStabbedSegments=function(){if(arguments.length===1){for(var o=arguments[0],s=new Gr,d=this._subgraphs.iterator();d.hasNext();){var _=d.next(),w=_.getEnvelope();o.y<w.getMinY()||o.y>w.getMaxY()||this.findStabbedSegments(o,_.getDirectedEdges(),s)}return s}if(arguments.length===3){if(Le(arguments[2],Oa)&&arguments[0]instanceof Y&&arguments[1]instanceof mf){for(var j=arguments[0],ie=arguments[1],ke=arguments[2],tt=ie.getEdge().getCoordinates(),Pt=0;Pt<tt.length-1;Pt++)if(this._seg.p0=tt[Pt],this._seg.p1=tt[Pt+1],this._seg.p0.y>this._seg.p1.y&&this._seg.reverse(),!(Math.max(this._seg.p0.x,this._seg.p1.x)<j.x)&&!(this._seg.isHorizontal()||j.y<this._seg.p0.y||j.y>this._seg.p1.y||wt.computeOrientation(this._seg.p0,this._seg.p1,j)===wt.RIGHT)){var tr=ie.getDepth(Ae.LEFT);this._seg.p0.equals(tt[Pt])||(tr=ie.getDepth(Ae.RIGHT));var st=new nu(this._seg,tr);ke.add(st)}}else if(Le(arguments[2],Oa)&&arguments[0]instanceof Y&&Le(arguments[1],Oa))for(var Zt=arguments[0],Jt=arguments[1],yr=arguments[2],v=Jt.iterator();v.hasNext();){var Pn=v.next();Pn.isForward()&&this.findStabbedSegments(Zt,Pn,yr)}}},As.prototype.getDepth=function(o){var s=this.findStabbedSegments(o);return s.size()===0?0:Ha.min(s)._leftDepth},As.prototype.interfaces_=function(){return[]},As.prototype.getClass=function(){return As},ml.DepthSegment.get=function(){return nu},Object.defineProperties(As,ml);var nu=function(){this._upwardSeg=null,this._leftDepth=null;var o=arguments[0],s=arguments[1];this._upwardSeg=new Sn(o),this._leftDepth=s};nu.prototype.compareTo=function(o){var s=o;if(this._upwardSeg.minX()>=s._upwardSeg.maxX())return 1;if(this._upwardSeg.maxX()<=s._upwardSeg.minX())return-1;var d=this._upwardSeg.orientationIndex(s._upwardSeg);return d!==0||(d=-1*s._upwardSeg.orientationIndex(this._upwardSeg))!=0?d:this._upwardSeg.compareTo(s._upwardSeg)},nu.prototype.compareX=function(o,s){var d=o.p0.compareTo(s.p0);return d!==0?d:o.p1.compareTo(s.p1)},nu.prototype.toString=function(){return this._upwardSeg.toString()},nu.prototype.interfaces_=function(){return[he]},nu.prototype.getClass=function(){return nu};var Mi=function(o,s,d){this.p0=o||null,this.p1=s||null,this.p2=d||null};Mi.prototype.area=function(){return Mi.area(this.p0,this.p1,this.p2)},Mi.prototype.signedArea=function(){return Mi.signedArea(this.p0,this.p1,this.p2)},Mi.prototype.interpolateZ=function(o){if(o===null)throw new we("Supplied point is null.");return Mi.interpolateZ(o,this.p0,this.p1,this.p2)},Mi.prototype.longestSideLength=function(){return Mi.longestSideLength(this.p0,this.p1,this.p2)},Mi.prototype.isAcute=function(){return Mi.isAcute(this.p0,this.p1,this.p2)},Mi.prototype.circumcentre=function(){return Mi.circumcentre(this.p0,this.p1,this.p2)},Mi.prototype.area3D=function(){return Mi.area3D(this.p0,this.p1,this.p2)},Mi.prototype.centroid=function(){return Mi.centroid(this.p0,this.p1,this.p2)},Mi.prototype.inCentre=function(){return Mi.inCentre(this.p0,this.p1,this.p2)},Mi.prototype.interfaces_=function(){return[]},Mi.prototype.getClass=function(){return Mi},Mi.area=function(o,s,d){return Math.abs(((d.x-o.x)*(s.y-o.y)-(s.x-o.x)*(d.y-o.y))/2)},Mi.signedArea=function(o,s,d){return((d.x-o.x)*(s.y-o.y)-(s.x-o.x)*(d.y-o.y))/2},Mi.det=function(o,s,d,_){return o*_-s*d},Mi.interpolateZ=function(o,s,d,_){var w=s.x,j=s.y,ie=d.x-w,ke=_.x-w,tt=d.y-j,Pt=_.y-j,tr=ie*Pt-ke*tt,st=o.x-w,Zt=o.y-j,Jt=(Pt*st-ke*Zt)/tr,yr=(-tt*st+ie*Zt)/tr;return s.z+Jt*(d.z-s.z)+yr*(_.z-s.z)},Mi.longestSideLength=function(o,s,d){var _=o.distance(s),w=s.distance(d),j=d.distance(o),ie=_;return w>ie&&(ie=w),j>ie&&(ie=j),ie},Mi.isAcute=function(o,s,d){return!!ui.isAcute(o,s,d)&&!!ui.isAcute(s,d,o)&&!!ui.isAcute(d,o,s)},Mi.circumcentre=function(o,s,d){var _=d.x,w=d.y,j=o.x-_,ie=o.y-w,ke=s.x-_,tt=s.y-w,Pt=2*Mi.det(j,ie,ke,tt),tr=Mi.det(ie,j*j+ie*ie,tt,ke*ke+tt*tt),st=Mi.det(j,j*j+ie*ie,ke,ke*ke+tt*tt);return new Y(_-tr/Pt,w+st/Pt)},Mi.perpendicularBisector=function(o,s){var d=s.x-o.x,_=s.y-o.y,w=new Jr(o.x+d/2,o.y+_/2,1),j=new Jr(o.x-_+d/2,o.y+d+_/2,1);return new Jr(w,j)},Mi.angleBisector=function(o,s,d){var _=s.distance(o),w=_/(_+s.distance(d)),j=d.x-o.x,ie=d.y-o.y;return new Y(o.x+w*j,o.y+w*ie)},Mi.area3D=function(o,s,d){var _=s.x-o.x,w=s.y-o.y,j=s.z-o.z,ie=d.x-o.x,ke=d.y-o.y,tt=d.z-o.z,Pt=w*tt-j*ke,tr=j*ie-_*tt,st=_*ke-w*ie,Zt=Pt*Pt+tr*tr+st*st,Jt=Math.sqrt(Zt)/2;return Jt},Mi.centroid=function(o,s,d){var _=(o.x+s.x+d.x)/3,w=(o.y+s.y+d.y)/3;return new Y(_,w)},Mi.inCentre=function(o,s,d){var _=s.distance(d),w=o.distance(d),j=o.distance(s),ie=_+w+j,ke=(_*o.x+w*s.x+j*d.x)/ie,tt=(_*o.y+w*s.y+j*d.y)/ie;return new Y(ke,tt)};var as=function(){this._inputGeom=null,this._distance=null,this._curveBuilder=null,this._curveList=new Gr;var o=arguments[0],s=arguments[1],d=arguments[2];this._inputGeom=o,this._distance=s,this._curveBuilder=d};as.prototype.addPoint=function(o){if(this._distance<=0)return null;var s=o.getCoordinates(),d=this._curveBuilder.getLineCurve(s,this._distance);this.addCurve(d,_e.EXTERIOR,_e.INTERIOR)},as.prototype.addPolygon=function(o){var s=this._distance,d=Ae.LEFT;this._distance<0&&(s=-this._distance,d=Ae.RIGHT);var _=o.getExteriorRing(),w=_n.removeRepeatedPoints(_.getCoordinates());if(this._distance<0&&this.isErodedCompletely(_,this._distance)||this._distance<=0&&w.length<3)return null;this.addPolygonRing(w,s,d,_e.EXTERIOR,_e.INTERIOR);for(var j=0;j<o.getNumInteriorRing();j++){var ie=o.getInteriorRingN(j),ke=_n.removeRepeatedPoints(ie.getCoordinates());this._distance>0&&this.isErodedCompletely(ie,-this._distance)||this.addPolygonRing(ke,s,Ae.opposite(d),_e.INTERIOR,_e.EXTERIOR)}},as.prototype.isTriangleErodedCompletely=function(o,s){var d=new Mi(o[0],o[1],o[2]),_=d.inCentre();return wt.distancePointLine(_,d.p0,d.p1)<Math.abs(s)},as.prototype.addLineString=function(o){if(this._distance<=0&&!this._curveBuilder.getBufferParameters().isSingleSided())return null;var s=_n.removeRepeatedPoints(o.getCoordinates()),d=this._curveBuilder.getLineCurve(s,this._distance);this.addCurve(d,_e.EXTERIOR,_e.INTERIOR)},as.prototype.addCurve=function(o,s,d){if(o===null||o.length<2)return null;var _=new Ma(o,new Mn(0,_e.BOUNDARY,s,d));this._curveList.add(_)},as.prototype.getCurves=function(){return this.add(this._inputGeom),this._curveList},as.prototype.addPolygonRing=function(o,s,d,_,w){if(s===0&&o.length<pr.MINIMUM_VALID_SIZE)return null;var j=_,ie=w;o.length>=pr.MINIMUM_VALID_SIZE&&wt.isCCW(o)&&(j=w,ie=_,d=Ae.opposite(d));var ke=this._curveBuilder.getRingCurve(o,d,s);this.addCurve(ke,j,ie)},as.prototype.add=function(o){if(o.isEmpty())return null;o instanceof wa?this.addPolygon(o):o instanceof xa?this.addLineString(o):o instanceof uo?this.addPoint(o):o instanceof lu?this.addCollection(o):o instanceof Ni?this.addCollection(o):o instanceof vn?this.addCollection(o):o instanceof Lo&&this.addCollection(o)},as.prototype.isErodedCompletely=function(o,s){var d=o.getCoordinates();if(d.length<4)return s<0;if(d.length===4)return this.isTriangleErodedCompletely(d,s);var _=o.getEnvelopeInternal(),w=Math.min(_.getHeight(),_.getWidth());return s<0&&2*Math.abs(s)>w},as.prototype.addCollection=function(o){for(var s=0;s<o.getNumGeometries();s++){var d=o.getGeometryN(s);this.add(d)}},as.prototype.interfaces_=function(){return[]},as.prototype.getClass=function(){return as};var iu=function(){};iu.prototype.locate=function(o){},iu.prototype.interfaces_=function(){return[]},iu.prototype.getClass=function(){return iu};var No=function(){this._parent=null,this._atStart=null,this._max=null,this._index=null,this._subcollectionIterator=null;var o=arguments[0];this._parent=o,this._atStart=!0,this._index=0,this._max=o.getNumGeometries()};No.prototype.next=function(){if(this._atStart)return this._atStart=!1,No.isAtomic(this._parent)&&this._index++,this._parent;if(this._subcollectionIterator!==null){if(this._subcollectionIterator.hasNext())return this._subcollectionIterator.next();this._subcollectionIterator=null}if(this._index>=this._max)throw new G;var o=this._parent.getGeometryN(this._index++);return o instanceof Lo?(this._subcollectionIterator=new No(o),this._subcollectionIterator.next()):o},No.prototype.remove=function(){throw new Error(this.getClass().getName())},No.prototype.hasNext=function(){if(this._atStart)return!0;if(this._subcollectionIterator!==null){if(this._subcollectionIterator.hasNext())return!0;this._subcollectionIterator=null}return!(this._index>=this._max)},No.prototype.interfaces_=function(){return[la]},No.prototype.getClass=function(){return No},No.isAtomic=function(o){return!(o instanceof Lo)};var ps=function(){this._geom=null;var o=arguments[0];this._geom=o};ps.prototype.locate=function(o){return ps.locate(o,this._geom)},ps.prototype.interfaces_=function(){return[iu]},ps.prototype.getClass=function(){return ps},ps.isPointInRing=function(o,s){return!!s.getEnvelopeInternal().intersects(o)&&wt.isPointInRing(o,s.getCoordinates())},ps.containsPointInPolygon=function(o,s){if(s.isEmpty())return!1;var d=s.getExteriorRing();if(!ps.isPointInRing(o,d))return!1;for(var _=0;_<s.getNumInteriorRing();_++){var w=s.getInteriorRingN(_);if(ps.isPointInRing(o,w))return!1}return!0},ps.containsPoint=function(o,s){if(s instanceof wa)return ps.containsPointInPolygon(o,s);if(s instanceof Lo)for(var d=new No(s);d.hasNext();){var _=d.next();if(_!==s&&ps.containsPoint(o,_))return!0}return!1},ps.locate=function(o,s){return s.isEmpty()?_e.EXTERIOR:ps.containsPoint(o,s)?_e.INTERIOR:_e.EXTERIOR};var Fo=function(){this._edgeMap=new Re,this._edgeList=null,this._ptInAreaLocation=[_e.NONE,_e.NONE]};Fo.prototype.getNextCW=function(o){this.getEdges();var s=this._edgeList.indexOf(o),d=s-1;return s===0&&(d=this._edgeList.size()-1),this._edgeList.get(d)},Fo.prototype.propagateSideLabels=function(o){for(var s=_e.NONE,d=this.iterator();d.hasNext();){var _=d.next().getLabel();_.isArea(o)&&_.getLocation(o,Ae.LEFT)!==_e.NONE&&(s=_.getLocation(o,Ae.LEFT))}if(s===_e.NONE)return null;for(var w=s,j=this.iterator();j.hasNext();){var ie=j.next(),ke=ie.getLabel();if(ke.getLocation(o,Ae.ON)===_e.NONE&&ke.setLocation(o,Ae.ON,w),ke.isArea(o)){var tt=ke.getLocation(o,Ae.LEFT),Pt=ke.getLocation(o,Ae.RIGHT);if(Pt!==_e.NONE){if(Pt!==w)throw new zt("side location conflict",ie.getCoordinate());tt===_e.NONE&&Lt.shouldNeverReachHere("found single null side (at "+ie.getCoordinate()+")"),w=tt}else Lt.isTrue(ke.getLocation(o,Ae.LEFT)===_e.NONE,"found single null side"),ke.setLocation(o,Ae.RIGHT,w),ke.setLocation(o,Ae.LEFT,w)}}},Fo.prototype.getCoordinate=function(){var o=this.iterator();return o.hasNext()?o.next().getCoordinate():null},Fo.prototype.print=function(o){Qr.out.println("EdgeEndStar:   "+this.getCoordinate());for(var s=this.iterator();s.hasNext();)s.next().print(o)},Fo.prototype.isAreaLabelsConsistent=function(o){return this.computeEdgeEndLabels(o.getBoundaryNodeRule()),this.checkAreaLabelsConsistent(0)},Fo.prototype.checkAreaLabelsConsistent=function(o){var s=this.getEdges();if(s.size()<=0)return!0;var d=s.size()-1,_=s.get(d).getLabel().getLocation(o,Ae.LEFT);Lt.isTrue(_!==_e.NONE,"Found unlabelled area edge");for(var w=_,j=this.iterator();j.hasNext();){var ie=j.next().getLabel();Lt.isTrue(ie.isArea(o),"Found non-area edge");var ke=ie.getLocation(o,Ae.LEFT),tt=ie.getLocation(o,Ae.RIGHT);if(ke===tt||tt!==w)return!1;w=ke}return!0},Fo.prototype.findIndex=function(o){this.iterator();for(var s=0;s<this._edgeList.size();s++)if(this._edgeList.get(s)===o)return s;return-1},Fo.prototype.iterator=function(){return this.getEdges().iterator()},Fo.prototype.getEdges=function(){return this._edgeList===null&&(this._edgeList=new Gr(this._edgeMap.values())),this._edgeList},Fo.prototype.getLocation=function(o,s,d){return this._ptInAreaLocation[o]===_e.NONE&&(this._ptInAreaLocation[o]=ps.locate(s,d[o].getGeometry())),this._ptInAreaLocation[o]},Fo.prototype.toString=function(){var o=new se;o.append("EdgeEndStar:   "+this.getCoordinate()),o.append(`
`);for(var s=this.iterator();s.hasNext();){var d=s.next();o.append(d),o.append(`
`)}return o.toString()},Fo.prototype.computeEdgeEndLabels=function(o){for(var s=this.iterator();s.hasNext();)s.next().computeLabel(o)},Fo.prototype.computeLabelling=function(o){this.computeEdgeEndLabels(o[0].getBoundaryNodeRule()),this.propagateSideLabels(0),this.propagateSideLabels(1);for(var s=[!1,!1],d=this.iterator();d.hasNext();)for(var _=d.next().getLabel(),w=0;w<2;w++)_.isLine(w)&&_.getLocation(w)===_e.BOUNDARY&&(s[w]=!0);for(var j=this.iterator();j.hasNext();)for(var ie=j.next(),ke=ie.getLabel(),tt=0;tt<2;tt++)if(ke.isAnyNull(tt)){var Pt=_e.NONE;if(s[tt])Pt=_e.EXTERIOR;else{var tr=ie.getCoordinate();Pt=this.getLocation(tt,tr,o)}ke.setAllLocationsIfNull(tt,Pt)}},Fo.prototype.getDegree=function(){return this._edgeMap.size()},Fo.prototype.insertEdgeEnd=function(o,s){this._edgeMap.put(o,s),this._edgeList=null},Fo.prototype.interfaces_=function(){return[]},Fo.prototype.getClass=function(){return Fo};var a0=function(o){function s(){o.call(this),this._resultAreaEdgeList=null,this._label=null,this._SCANNING_FOR_INCOMING=1,this._LINKING_TO_OUTGOING=2}return o&&(s.__proto__=o),s.prototype=Object.create(o&&o.prototype),s.prototype.constructor=s,s.prototype.linkResultDirectedEdges=function(){this.getResultAreaEdges();for(var d=null,_=null,w=this._SCANNING_FOR_INCOMING,j=0;j<this._resultAreaEdgeList.size();j++){var ie=this._resultAreaEdgeList.get(j),ke=ie.getSym();if(ie.getLabel().isArea())switch(d===null&&ie.isInResult()&&(d=ie),w){case this._SCANNING_FOR_INCOMING:if(!ke.isInResult())continue;_=ke,w=this._LINKING_TO_OUTGOING;break;case this._LINKING_TO_OUTGOING:if(!ie.isInResult())continue;_.setNext(ie),w=this._SCANNING_FOR_INCOMING}}if(w===this._LINKING_TO_OUTGOING){if(d===null)throw new zt("no outgoing dirEdge found",this.getCoordinate());Lt.isTrue(d.isInResult(),"unable to link last incoming dirEdge"),_.setNext(d)}},s.prototype.insert=function(d){var _=d;this.insertEdgeEnd(_,_)},s.prototype.getRightmostEdge=function(){var d=this.getEdges(),_=d.size();if(_<1)return null;var w=d.get(0);if(_===1)return w;var j=d.get(_-1),ie=w.getQuadrant(),ke=j.getQuadrant();return ca.isNorthern(ie)&&ca.isNorthern(ke)?w:ca.isNorthern(ie)||ca.isNorthern(ke)?w.getDy()!==0?w:j.getDy()!==0?j:(Lt.shouldNeverReachHere("found two horizontal edges incident on node"),null):j},s.prototype.print=function(d){Qr.out.println("DirectedEdgeStar: "+this.getCoordinate());for(var _=this.iterator();_.hasNext();){var w=_.next();d.print("out "),w.print(d),d.println(),d.print("in "),w.getSym().print(d),d.println()}},s.prototype.getResultAreaEdges=function(){if(this._resultAreaEdgeList!==null)return this._resultAreaEdgeList;this._resultAreaEdgeList=new Gr;for(var d=this.iterator();d.hasNext();){var _=d.next();(_.isInResult()||_.getSym().isInResult())&&this._resultAreaEdgeList.add(_)}return this._resultAreaEdgeList},s.prototype.updateLabelling=function(d){for(var _=this.iterator();_.hasNext();){var w=_.next().getLabel();w.setAllLocationsIfNull(0,d.getLocation(0)),w.setAllLocationsIfNull(1,d.getLocation(1))}},s.prototype.linkAllDirectedEdges=function(){this.getEdges();for(var d=null,_=null,w=this._edgeList.size()-1;w>=0;w--){var j=this._edgeList.get(w),ie=j.getSym();_===null&&(_=ie),d!==null&&ie.setNext(d),d=j}_.setNext(d)},s.prototype.computeDepths=function(){if(arguments.length===1){var d=arguments[0],_=this.findIndex(d),w=d.getDepth(Ae.LEFT),j=d.getDepth(Ae.RIGHT),ie=this.computeDepths(_+1,this._edgeList.size(),w);if(this.computeDepths(0,_,ie)!==j)throw new zt("depth mismatch at "+d.getCoordinate())}else if(arguments.length===3){for(var ke=arguments[0],tt=arguments[1],Pt=arguments[2],tr=ke;tr<tt;tr++){var st=this._edgeList.get(tr);st.setEdgeDepths(Ae.RIGHT,Pt),Pt=st.getDepth(Ae.LEFT)}return Pt}},s.prototype.mergeSymLabels=function(){for(var d=this.iterator();d.hasNext();){var _=d.next();_.getLabel().merge(_.getSym().getLabel())}},s.prototype.linkMinimalDirectedEdges=function(d){for(var _=null,w=null,j=this._SCANNING_FOR_INCOMING,ie=this._resultAreaEdgeList.size()-1;ie>=0;ie--){var ke=this._resultAreaEdgeList.get(ie),tt=ke.getSym();switch(_===null&&ke.getEdgeRing()===d&&(_=ke),j){case this._SCANNING_FOR_INCOMING:if(tt.getEdgeRing()!==d)continue;w=tt,j=this._LINKING_TO_OUTGOING;break;case this._LINKING_TO_OUTGOING:if(ke.getEdgeRing()!==d)continue;w.setNextMin(ke),j=this._SCANNING_FOR_INCOMING}}j===this._LINKING_TO_OUTGOING&&(Lt.isTrue(_!==null,"found null for first outgoing dirEdge"),Lt.isTrue(_.getEdgeRing()===d,"unable to link last incoming dirEdge"),w.setNextMin(_))},s.prototype.getOutgoingDegree=function(){if(arguments.length===0){for(var d=0,_=this.iterator();_.hasNext();)_.next().isInResult()&&d++;return d}if(arguments.length===1){for(var w=arguments[0],j=0,ie=this.iterator();ie.hasNext();)ie.next().getEdgeRing()===w&&j++;return j}},s.prototype.getLabel=function(){return this._label},s.prototype.findCoveredLineEdges=function(){for(var d=_e.NONE,_=this.iterator();_.hasNext();){var w=_.next(),j=w.getSym();if(!w.isLineEdge()){if(w.isInResult()){d=_e.INTERIOR;break}if(j.isInResult()){d=_e.EXTERIOR;break}}}if(d===_e.NONE)return null;for(var ie=d,ke=this.iterator();ke.hasNext();){var tt=ke.next(),Pt=tt.getSym();tt.isLineEdge()?tt.getEdge().setCovered(ie===_e.INTERIOR):(tt.isInResult()&&(ie=_e.EXTERIOR),Pt.isInResult()&&(ie=_e.INTERIOR))}},s.prototype.computeLabelling=function(d){o.prototype.computeLabelling.call(this,d),this._label=new Mn(_e.NONE);for(var _=this.iterator();_.hasNext();)for(var w=_.next().getEdge().getLabel(),j=0;j<2;j++){var ie=w.getLocation(j);ie!==_e.INTERIOR&&ie!==_e.BOUNDARY||this._label.setLocation(j,_e.INTERIOR)}},s.prototype.interfaces_=function(){return[]},s.prototype.getClass=function(){return s},s}(Fo),rc=function(o){function s(){o.apply(this,arguments)}return o&&(s.__proto__=o),s.prototype=Object.create(o&&o.prototype),s.prototype.constructor=s,s.prototype.createNode=function(d){return new Qc(d,new a0)},s.prototype.interfaces_=function(){return[]},s.prototype.getClass=function(){return s},s}(dl),ma=function o(){this._pts=null,this._orientation=null;var s=arguments[0];this._pts=s,this._orientation=o.orientation(s)};ma.prototype.compareTo=function(o){var s=o;return ma.compareOriented(this._pts,this._orientation,s._pts,s._orientation)},ma.prototype.interfaces_=function(){return[he]},ma.prototype.getClass=function(){return ma},ma.orientation=function(o){return _n.increasingDirection(o)===1},ma.compareOriented=function(o,s,d,_){for(var w=s?1:-1,j=_?1:-1,ie=s?o.length:-1,ke=_?d.length:-1,tt=s?0:o.length-1,Pt=_?0:d.length-1;;){var tr=o[tt].compareTo(d[Pt]);if(tr!==0)return tr;var st=(tt+=w)===ie,Zt=(Pt+=j)===ke;if(st&&!Zt)return-1;if(!st&&Zt)return 1;if(st&&Zt)return 0}};var Bo=function(){this._edges=new Gr,this._ocaMap=new Re};Bo.prototype.print=function(o){o.print("MULTILINESTRING ( ");for(var s=0;s<this._edges.size();s++){var d=this._edges.get(s);s>0&&o.print(","),o.print("(");for(var _=d.getCoordinates(),w=0;w<_.length;w++)w>0&&o.print(","),o.print(_[w].x+" "+_[w].y);o.println(")")}o.print(")  ")},Bo.prototype.addAll=function(o){for(var s=o.iterator();s.hasNext();)this.add(s.next())},Bo.prototype.findEdgeIndex=function(o){for(var s=0;s<this._edges.size();s++)if(this._edges.get(s).equals(o))return s;return-1},Bo.prototype.iterator=function(){return this._edges.iterator()},Bo.prototype.getEdges=function(){return this._edges},Bo.prototype.get=function(o){return this._edges.get(o)},Bo.prototype.findEqualEdge=function(o){var s=new ma(o.getCoordinates());return this._ocaMap.get(s)},Bo.prototype.add=function(o){this._edges.add(o);var s=new ma(o.getCoordinates());this._ocaMap.put(s,o)},Bo.prototype.interfaces_=function(){return[]},Bo.prototype.getClass=function(){return Bo};var Ms=function(){};Ms.prototype.processIntersections=function(o,s,d,_){},Ms.prototype.isDone=function(){},Ms.prototype.interfaces_=function(){return[]},Ms.prototype.getClass=function(){return Ms};var fo=function(){this._hasIntersection=!1,this._hasProper=!1,this._hasProperInterior=!1,this._hasInterior=!1,this._properIntersectionPoint=null,this._li=null,this._isSelfIntersection=null,this.numIntersections=0,this.numInteriorIntersections=0,this.numProperIntersections=0,this.numTests=0;var o=arguments[0];this._li=o};fo.prototype.isTrivialIntersection=function(o,s,d,_){if(o===d&&this._li.getIntersectionNum()===1){if(fo.isAdjacentSegments(s,_))return!0;if(o.isClosed()){var w=o.size()-1;if(s===0&&_===w||_===0&&s===w)return!0}}return!1},fo.prototype.getProperIntersectionPoint=function(){return this._properIntersectionPoint},fo.prototype.hasProperInteriorIntersection=function(){return this._hasProperInterior},fo.prototype.getLineIntersector=function(){return this._li},fo.prototype.hasProperIntersection=function(){return this._hasProper},fo.prototype.processIntersections=function(o,s,d,_){if(o===d&&s===_)return null;this.numTests++;var w=o.getCoordinates()[s],j=o.getCoordinates()[s+1],ie=d.getCoordinates()[_],ke=d.getCoordinates()[_+1];this._li.computeIntersection(w,j,ie,ke),this._li.hasIntersection()&&(this.numIntersections++,this._li.isInteriorIntersection()&&(this.numInteriorIntersections++,this._hasInterior=!0),this.isTrivialIntersection(o,s,d,_)||(this._hasIntersection=!0,o.addIntersections(this._li,s,0),d.addIntersections(this._li,_,1),this._li.isProper()&&(this.numProperIntersections++,this._hasProper=!0,this._hasProperInterior=!0)))},fo.prototype.hasIntersection=function(){return this._hasIntersection},fo.prototype.isDone=function(){return!1},fo.prototype.hasInteriorIntersection=function(){return this._hasInterior},fo.prototype.interfaces_=function(){return[Ms]},fo.prototype.getClass=function(){return fo},fo.isAdjacentSegments=function(o,s){return Math.abs(o-s)===1};var Wo=function(){this.coord=null,this.segmentIndex=null,this.dist=null;var o=arguments[0],s=arguments[1],d=arguments[2];this.coord=new Y(o),this.segmentIndex=s,this.dist=d};Wo.prototype.getSegmentIndex=function(){return this.segmentIndex},Wo.prototype.getCoordinate=function(){return this.coord},Wo.prototype.print=function(o){o.print(this.coord),o.print(" seg # = "+this.segmentIndex),o.println(" dist = "+this.dist)},Wo.prototype.compareTo=function(o){var s=o;return this.compare(s.segmentIndex,s.dist)},Wo.prototype.isEndPoint=function(o){return this.segmentIndex===0&&this.dist===0||this.segmentIndex===o},Wo.prototype.toString=function(){return this.coord+" seg # = "+this.segmentIndex+" dist = "+this.dist},Wo.prototype.getDistance=function(){return this.dist},Wo.prototype.compare=function(o,s){return this.segmentIndex<o?-1:this.segmentIndex>o?1:this.dist<s?-1:this.dist>s?1:0},Wo.prototype.interfaces_=function(){return[he]},Wo.prototype.getClass=function(){return Wo};var Au=function(){this._nodeMap=new Re,this.edge=null;var o=arguments[0];this.edge=o};Au.prototype.print=function(o){o.println("Intersections:");for(var s=this.iterator();s.hasNext();)s.next().print(o)},Au.prototype.iterator=function(){return this._nodeMap.values().iterator()},Au.prototype.addSplitEdges=function(o){this.addEndpoints();for(var s=this.iterator(),d=s.next();s.hasNext();){var _=s.next(),w=this.createSplitEdge(d,_);o.add(w),d=_}},Au.prototype.addEndpoints=function(){var o=this.edge.pts.length-1;this.add(this.edge.pts[0],0,0),this.add(this.edge.pts[o],o,0)},Au.prototype.createSplitEdge=function(o,s){var d=s.segmentIndex-o.segmentIndex+2,_=this.edge.pts[s.segmentIndex],w=s.dist>0||!s.coord.equals2D(_);w||d--;var j=new Array(d).fill(null),ie=0;j[ie++]=new Y(o.coord);for(var ke=o.segmentIndex+1;ke<=s.segmentIndex;ke++)j[ie++]=this.edge.pts[ke];return w&&(j[ie]=s.coord),new Dl(j,new Mn(this.edge._label))},Au.prototype.add=function(o,s,d){var _=new Wo(o,s,d),w=this._nodeMap.get(_);return w!==null?w:(this._nodeMap.put(_,_),_)},Au.prototype.isIntersection=function(o){for(var s=this.iterator();s.hasNext();)if(s.next().coord.equals(o))return!0;return!1},Au.prototype.interfaces_=function(){return[]},Au.prototype.getClass=function(){return Au};var js=function(){};js.prototype.getChainStartIndices=function(o){var s=0,d=new Gr;d.add(new Ne(s));do{var _=this.findChainEnd(o,s);d.add(new Ne(_)),s=_}while(s<o.length-1);return js.toIntArray(d)},js.prototype.findChainEnd=function(o,s){for(var d=ca.quadrant(o[s],o[s+1]),_=s+1;_<o.length&&ca.quadrant(o[_-1],o[_])===d;)_++;return _-1},js.prototype.interfaces_=function(){return[]},js.prototype.getClass=function(){return js},js.toIntArray=function(o){for(var s=new Array(o.size()).fill(null),d=0;d<s.length;d++)s[d]=o.get(d).intValue();return s};var Zr=function(){this.e=null,this.pts=null,this.startIndex=null,this.env1=new xr,this.env2=new xr;var o=arguments[0];this.e=o,this.pts=o.getCoordinates();var s=new js;this.startIndex=s.getChainStartIndices(this.pts)};Zr.prototype.getCoordinates=function(){return this.pts},Zr.prototype.getMaxX=function(o){var s=this.pts[this.startIndex[o]].x,d=this.pts[this.startIndex[o+1]].x;return s>d?s:d},Zr.prototype.getMinX=function(o){var s=this.pts[this.startIndex[o]].x,d=this.pts[this.startIndex[o+1]].x;return s<d?s:d},Zr.prototype.computeIntersectsForChain=function(){if(arguments.length===4){var o=arguments[0],s=arguments[1],d=arguments[2],_=arguments[3];this.computeIntersectsForChain(this.startIndex[o],this.startIndex[o+1],s,s.startIndex[d],s.startIndex[d+1],_)}else if(arguments.length===6){var w=arguments[0],j=arguments[1],ie=arguments[2],ke=arguments[3],tt=arguments[4],Pt=arguments[5],tr=this.pts[w],st=this.pts[j],Zt=ie.pts[ke],Jt=ie.pts[tt];if(j-w==1&&tt-ke==1)return Pt.addIntersections(this.e,w,ie.e,ke),null;if(this.env1.init(tr,st),this.env2.init(Zt,Jt),!this.env1.intersects(this.env2))return null;var yr=Math.trunc((w+j)/2),v=Math.trunc((ke+tt)/2);w<yr&&(ke<v&&this.computeIntersectsForChain(w,yr,ie,ke,v,Pt),v<tt&&this.computeIntersectsForChain(w,yr,ie,v,tt,Pt)),yr<j&&(ke<v&&this.computeIntersectsForChain(yr,j,ie,ke,v,Pt),v<tt&&this.computeIntersectsForChain(yr,j,ie,v,tt,Pt))}},Zr.prototype.getStartIndexes=function(){return this.startIndex},Zr.prototype.computeIntersects=function(o,s){for(var d=0;d<this.startIndex.length-1;d++)for(var _=0;_<o.startIndex.length-1;_++)this.computeIntersectsForChain(d,o,_,s)},Zr.prototype.interfaces_=function(){return[]},Zr.prototype.getClass=function(){return Zr};var Ja=function o(){this._depth=Array(2).fill().map(function(){return Array(3)});for(var s=0;s<2;s++)for(var d=0;d<3;d++)this._depth[s][d]=o.NULL_VALUE},yc={NULL_VALUE:{configurable:!0}};Ja.prototype.getDepth=function(o,s){return this._depth[o][s]},Ja.prototype.setDepth=function(o,s,d){this._depth[o][s]=d},Ja.prototype.isNull=function(){if(arguments.length===0){for(var o=0;o<2;o++)for(var s=0;s<3;s++)if(this._depth[o][s]!==Ja.NULL_VALUE)return!1;return!0}if(arguments.length===1){var d=arguments[0];return this._depth[d][1]===Ja.NULL_VALUE}if(arguments.length===2){var _=arguments[0],w=arguments[1];return this._depth[_][w]===Ja.NULL_VALUE}},Ja.prototype.normalize=function(){for(var o=0;o<2;o++)if(!this.isNull(o)){var s=this._depth[o][1];this._depth[o][2]<s&&(s=this._depth[o][2]),s<0&&(s=0);for(var d=1;d<3;d++){var _=0;this._depth[o][d]>s&&(_=1),this._depth[o][d]=_}}},Ja.prototype.getDelta=function(o){return this._depth[o][Ae.RIGHT]-this._depth[o][Ae.LEFT]},Ja.prototype.getLocation=function(o,s){return this._depth[o][s]<=0?_e.EXTERIOR:_e.INTERIOR},Ja.prototype.toString=function(){return"A: "+this._depth[0][1]+","+this._depth[0][2]+" B: "+this._depth[1][1]+","+this._depth[1][2]},Ja.prototype.add=function(){if(arguments.length===1)for(var o=arguments[0],s=0;s<2;s++)for(var d=1;d<3;d++){var _=o.getLocation(s,d);_!==_e.EXTERIOR&&_!==_e.INTERIOR||(this.isNull(s,d)?this._depth[s][d]=Ja.depthAtLocation(_):this._depth[s][d]+=Ja.depthAtLocation(_))}else if(arguments.length===3){var w=arguments[0],j=arguments[1];arguments[2]===_e.INTERIOR&&this._depth[w][j]++}},Ja.prototype.interfaces_=function(){return[]},Ja.prototype.getClass=function(){return Ja},Ja.depthAtLocation=function(o){return o===_e.EXTERIOR?0:o===_e.INTERIOR?1:Ja.NULL_VALUE},yc.NULL_VALUE.get=function(){return-1},Object.defineProperties(Ja,yc);var Dl=function(o){function s(){if(o.call(this),this.pts=null,this._env=null,this.eiList=new Au(this),this._name=null,this._mce=null,this._isIsolated=!0,this._depth=new Ja,this._depthDelta=0,arguments.length===1){var d=arguments[0];s.call(this,d,null)}else if(arguments.length===2){var _=arguments[0],w=arguments[1];this.pts=_,this._label=w}}return o&&(s.__proto__=o),s.prototype=Object.create(o&&o.prototype),s.prototype.constructor=s,s.prototype.getDepth=function(){return this._depth},s.prototype.getCollapsedEdge=function(){var d=new Array(2).fill(null);return d[0]=this.pts[0],d[1]=this.pts[1],new s(d,Mn.toLineLabel(this._label))},s.prototype.isIsolated=function(){return this._isIsolated},s.prototype.getCoordinates=function(){return this.pts},s.prototype.setIsolated=function(d){this._isIsolated=d},s.prototype.setName=function(d){this._name=d},s.prototype.equals=function(d){if(!(d instanceof s))return!1;var _=d;if(this.pts.length!==_.pts.length)return!1;for(var w=!0,j=!0,ie=this.pts.length,ke=0;ke<this.pts.length;ke++)if(this.pts[ke].equals2D(_.pts[ke])||(w=!1),this.pts[ke].equals2D(_.pts[--ie])||(j=!1),!w&&!j)return!1;return!0},s.prototype.getCoordinate=function(){if(arguments.length===0)return this.pts.length>0?this.pts[0]:null;if(arguments.length===1){var d=arguments[0];return this.pts[d]}},s.prototype.print=function(d){d.print("edge "+this._name+": "),d.print("LINESTRING (");for(var _=0;_<this.pts.length;_++)_>0&&d.print(","),d.print(this.pts[_].x+" "+this.pts[_].y);d.print(")  "+this._label+" "+this._depthDelta)},s.prototype.computeIM=function(d){s.updateIM(this._label,d)},s.prototype.isCollapsed=function(){return!!this._label.isArea()&&this.pts.length===3&&!!this.pts[0].equals(this.pts[2])},s.prototype.isClosed=function(){return this.pts[0].equals(this.pts[this.pts.length-1])},s.prototype.getMaximumSegmentIndex=function(){return this.pts.length-1},s.prototype.getDepthDelta=function(){return this._depthDelta},s.prototype.getNumPoints=function(){return this.pts.length},s.prototype.printReverse=function(d){d.print("edge "+this._name+": ");for(var _=this.pts.length-1;_>=0;_--)d.print(this.pts[_]+" ");d.println("")},s.prototype.getMonotoneChainEdge=function(){return this._mce===null&&(this._mce=new Zr(this)),this._mce},s.prototype.getEnvelope=function(){if(this._env===null){this._env=new xr;for(var d=0;d<this.pts.length;d++)this._env.expandToInclude(this.pts[d])}return this._env},s.prototype.addIntersection=function(d,_,w,j){var ie=new Y(d.getIntersection(j)),ke=_,tt=d.getEdgeDistance(w,j),Pt=ke+1;if(Pt<this.pts.length){var tr=this.pts[Pt];ie.equals2D(tr)&&(ke=Pt,tt=0)}this.eiList.add(ie,ke,tt)},s.prototype.toString=function(){var d=new se;d.append("edge "+this._name+": "),d.append("LINESTRING (");for(var _=0;_<this.pts.length;_++)_>0&&d.append(","),d.append(this.pts[_].x+" "+this.pts[_].y);return d.append(")  "+this._label+" "+this._depthDelta),d.toString()},s.prototype.isPointwiseEqual=function(d){if(this.pts.length!==d.pts.length)return!1;for(var _=0;_<this.pts.length;_++)if(!this.pts[_].equals2D(d.pts[_]))return!1;return!0},s.prototype.setDepthDelta=function(d){this._depthDelta=d},s.prototype.getEdgeIntersectionList=function(){return this.eiList},s.prototype.addIntersections=function(d,_,w){for(var j=0;j<d.getIntersectionNum();j++)this.addIntersection(d,_,w,j)},s.prototype.interfaces_=function(){return[]},s.prototype.getClass=function(){return s},s.updateIM=function(){if(arguments.length!==2)return o.prototype.updateIM.apply(this,arguments);var d=arguments[0],_=arguments[1];_.setAtLeastIfValid(d.getLocation(0,Ae.ON),d.getLocation(1,Ae.ON),1),d.isArea()&&(_.setAtLeastIfValid(d.getLocation(0,Ae.LEFT),d.getLocation(1,Ae.LEFT),2),_.setAtLeastIfValid(d.getLocation(0,Ae.RIGHT),d.getLocation(1,Ae.RIGHT),2))},s}(ws),yo=function(o){this._workingPrecisionModel=null,this._workingNoder=null,this._geomFact=null,this._graph=null,this._edgeList=new Bo,this._bufParams=o||null};yo.prototype.setWorkingPrecisionModel=function(o){this._workingPrecisionModel=o},yo.prototype.insertUniqueEdge=function(o){var s=this._edgeList.findEqualEdge(o);if(s!==null){var d=s.getLabel(),_=o.getLabel();s.isPointwiseEqual(o)||(_=new Mn(o.getLabel())).flip(),d.merge(_);var w=yo.depthDelta(_),j=s.getDepthDelta()+w;s.setDepthDelta(j)}else this._edgeList.add(o),o.setDepthDelta(yo.depthDelta(o.getLabel()))},yo.prototype.buildSubgraphs=function(o,s){for(var d=new Gr,_=o.iterator();_.hasNext();){var w=_.next(),j=w.getRightmostCoordinate(),ie=new As(d).getDepth(j);w.computeDepth(ie),w.findResultEdges(),d.add(w),s.add(w.getDirectedEdges(),w.getNodes())}},yo.prototype.createSubgraphs=function(o){for(var s=new Gr,d=o.getNodes().iterator();d.hasNext();){var _=d.next();if(!_.isVisited()){var w=new Pr;w.create(_),s.add(w)}}return Ha.sort(s,Ha.reverseOrder()),s},yo.prototype.createEmptyResultGeometry=function(){return this._geomFact.createPolygon()},yo.prototype.getNoder=function(o){if(this._workingNoder!==null)return this._workingNoder;var s=new mc,d=new $e;return d.setPrecisionModel(o),s.setSegmentIntersector(new fo(d)),s},yo.prototype.buffer=function(o,s){var d=this._workingPrecisionModel;d===null&&(d=o.getPrecisionModel()),this._geomFact=o.getFactory();var _=new Ea(d,this._bufParams),w=new as(o,s,_).getCurves();if(w.size()<=0)return this.createEmptyResultGeometry();this.computeNodedEdges(w,d),this._graph=new Ta(new rc),this._graph.addEdges(this._edgeList.getEdges());var j=this.createSubgraphs(this._graph),ie=new In(this._geomFact);this.buildSubgraphs(j,ie);var ke=ie.getPolygons();return ke.size()<=0?this.createEmptyResultGeometry():this._geomFact.buildGeometry(ke)},yo.prototype.computeNodedEdges=function(o,s){var d=this.getNoder(s);d.computeNodes(o);for(var _=d.getNodedSubstrings().iterator();_.hasNext();){var w=_.next(),j=w.getCoordinates();if(j.length!==2||!j[0].equals2D(j[1])){var ie=w.getData(),ke=new Dl(w.getCoordinates(),new Mn(ie));this.insertUniqueEdge(ke)}}},yo.prototype.setNoder=function(o){this._workingNoder=o},yo.prototype.interfaces_=function(){return[]},yo.prototype.getClass=function(){return yo},yo.depthDelta=function(o){var s=o.getLocation(0,Ae.LEFT),d=o.getLocation(0,Ae.RIGHT);return s===_e.INTERIOR&&d===_e.EXTERIOR?1:s===_e.EXTERIOR&&d===_e.INTERIOR?-1:0},yo.convertSegStrings=function(o){for(var s=new Ai,d=new Gr;o.hasNext();){var _=o.next(),w=s.createLineString(_.getCoordinates());d.add(w)}return s.buildGeometry(d)};var Nu=function(){if(this._noder=null,this._scaleFactor=null,this._offsetX=null,this._offsetY=null,this._isScaled=!1,arguments.length===2){var o=arguments[0],s=arguments[1];this._noder=o,this._scaleFactor=s,this._offsetX=0,this._offsetY=0,this._isScaled=!this.isIntegerPrecision()}else if(arguments.length===4){var d=arguments[0],_=arguments[1],w=arguments[2],j=arguments[3];this._noder=d,this._scaleFactor=_,this._offsetX=w,this._offsetY=j,this._isScaled=!this.isIntegerPrecision()}};Nu.prototype.rescale=function(){if(Le(arguments[0],fi))for(var o=arguments[0].iterator();o.hasNext();){var s=o.next();this.rescale(s.getCoordinates())}else if(arguments[0]instanceof Array){for(var d=arguments[0],_=0;_<d.length;_++)d[_].x=d[_].x/this._scaleFactor+this._offsetX,d[_].y=d[_].y/this._scaleFactor+this._offsetY;d.length===2&&d[0].equals2D(d[1])&&Qr.out.println(d)}},Nu.prototype.scale=function(){if(Le(arguments[0],fi)){for(var o=arguments[0],s=new Gr,d=o.iterator();d.hasNext();){var _=d.next();s.add(new Ma(this.scale(_.getCoordinates()),_.getData()))}return s}if(arguments[0]instanceof Array){for(var w=arguments[0],j=new Array(w.length).fill(null),ie=0;ie<w.length;ie++)j[ie]=new Y(Math.round((w[ie].x-this._offsetX)*this._scaleFactor),Math.round((w[ie].y-this._offsetY)*this._scaleFactor),w[ie].z);return _n.removeRepeatedPoints(j)}},Nu.prototype.isIntegerPrecision=function(){return this._scaleFactor===1},Nu.prototype.getNodedSubstrings=function(){var o=this._noder.getNodedSubstrings();return this._isScaled&&this.rescale(o),o},Nu.prototype.computeNodes=function(o){var s=o;this._isScaled&&(s=this.scale(o)),this._noder.computeNodes(s)},Nu.prototype.interfaces_=function(){return[gl]},Nu.prototype.getClass=function(){return Nu};var Eu=function(){this._li=new $e,this._segStrings=null;var o=arguments[0];this._segStrings=o},Kc={fact:{configurable:!0}};Eu.prototype.checkEndPtVertexIntersections=function(){if(arguments.length===0)for(var o=this._segStrings.iterator();o.hasNext();){var s=o.next().getCoordinates();this.checkEndPtVertexIntersections(s[0],this._segStrings),this.checkEndPtVertexIntersections(s[s.length-1],this._segStrings)}else if(arguments.length===2){for(var d=arguments[0],_=arguments[1].iterator();_.hasNext();)for(var w=_.next().getCoordinates(),j=1;j<w.length-1;j++)if(w[j].equals(d))throw new ki("found endpt/interior pt intersection at index "+j+" :pt "+d)}},Eu.prototype.checkInteriorIntersections=function(){if(arguments.length===0)for(var o=this._segStrings.iterator();o.hasNext();)for(var s=o.next(),d=this._segStrings.iterator();d.hasNext();){var _=d.next();this.checkInteriorIntersections(s,_)}else if(arguments.length===2)for(var w=arguments[0],j=arguments[1],ie=w.getCoordinates(),ke=j.getCoordinates(),tt=0;tt<ie.length-1;tt++)for(var Pt=0;Pt<ke.length-1;Pt++)this.checkInteriorIntersections(w,tt,j,Pt);else if(arguments.length===4){var tr=arguments[0],st=arguments[1],Zt=arguments[2],Jt=arguments[3];if(tr===Zt&&st===Jt)return null;var yr=tr.getCoordinates()[st],v=tr.getCoordinates()[st+1],Pn=Zt.getCoordinates()[Jt],jn=Zt.getCoordinates()[Jt+1];if(this._li.computeIntersection(yr,v,Pn,jn),this._li.hasIntersection()&&(this._li.isProper()||this.hasInteriorIntersection(this._li,yr,v)||this.hasInteriorIntersection(this._li,Pn,jn)))throw new ki("found non-noded intersection at "+yr+"-"+v+" and "+Pn+"-"+jn)}},Eu.prototype.checkValid=function(){this.checkEndPtVertexIntersections(),this.checkInteriorIntersections(),this.checkCollapses()},Eu.prototype.checkCollapses=function(){if(arguments.length===0)for(var o=this._segStrings.iterator();o.hasNext();){var s=o.next();this.checkCollapses(s)}else if(arguments.length===1)for(var d=arguments[0].getCoordinates(),_=0;_<d.length-2;_++)this.checkCollapse(d[_],d[_+1],d[_+2])},Eu.prototype.hasInteriorIntersection=function(o,s,d){for(var _=0;_<o.getIntersectionNum();_++){var w=o.getIntersection(_);if(!w.equals(s)&&!w.equals(d))return!0}return!1},Eu.prototype.checkCollapse=function(o,s,d){if(o.equals(d))throw new ki("found non-noded collapse at "+Eu.fact.createLineString([o,s,d]))},Eu.prototype.interfaces_=function(){return[]},Eu.prototype.getClass=function(){return Eu},Kc.fact.get=function(){return new Ai},Object.defineProperties(Eu,Kc);var ds=function(){this._li=null,this._pt=null,this._originalPt=null,this._ptScaled=null,this._p0Scaled=null,this._p1Scaled=null,this._scaleFactor=null,this._minx=null,this._maxx=null,this._miny=null,this._maxy=null,this._corner=new Array(4).fill(null),this._safeEnv=null;var o=arguments[0],s=arguments[1],d=arguments[2];if(this._originalPt=o,this._pt=o,this._scaleFactor=s,this._li=d,s<=0)throw new we("Scale factor must be non-zero");s!==1&&(this._pt=new Y(this.scale(o.x),this.scale(o.y)),this._p0Scaled=new Y,this._p1Scaled=new Y),this.initCorners(this._pt)},Is={SAFE_ENV_EXPANSION_FACTOR:{configurable:!0}};ds.prototype.intersectsScaled=function(o,s){var d=Math.min(o.x,s.x),_=Math.max(o.x,s.x),w=Math.min(o.y,s.y),j=Math.max(o.y,s.y),ie=this._maxx<d||this._minx>_||this._maxy<w||this._miny>j;if(ie)return!1;var ke=this.intersectsToleranceSquare(o,s);return Lt.isTrue(!(ie&&ke),"Found bad envelope test"),ke},ds.prototype.initCorners=function(o){this._minx=o.x-.5,this._maxx=o.x+.5,this._miny=o.y-.5,this._maxy=o.y+.5,this._corner[0]=new Y(this._maxx,this._maxy),this._corner[1]=new Y(this._minx,this._maxy),this._corner[2]=new Y(this._minx,this._miny),this._corner[3]=new Y(this._maxx,this._miny)},ds.prototype.intersects=function(o,s){return this._scaleFactor===1?this.intersectsScaled(o,s):(this.copyScaled(o,this._p0Scaled),this.copyScaled(s,this._p1Scaled),this.intersectsScaled(this._p0Scaled,this._p1Scaled))},ds.prototype.scale=function(o){return Math.round(o*this._scaleFactor)},ds.prototype.getCoordinate=function(){return this._originalPt},ds.prototype.copyScaled=function(o,s){s.x=this.scale(o.x),s.y=this.scale(o.y)},ds.prototype.getSafeEnvelope=function(){if(this._safeEnv===null){var o=ds.SAFE_ENV_EXPANSION_FACTOR/this._scaleFactor;this._safeEnv=new xr(this._originalPt.x-o,this._originalPt.x+o,this._originalPt.y-o,this._originalPt.y+o)}return this._safeEnv},ds.prototype.intersectsPixelClosure=function(o,s){return this._li.computeIntersection(o,s,this._corner[0],this._corner[1]),!!this._li.hasIntersection()||(this._li.computeIntersection(o,s,this._corner[1],this._corner[2]),!!this._li.hasIntersection()||(this._li.computeIntersection(o,s,this._corner[2],this._corner[3]),!!this._li.hasIntersection()||(this._li.computeIntersection(o,s,this._corner[3],this._corner[0]),!!this._li.hasIntersection())))},ds.prototype.intersectsToleranceSquare=function(o,s){var d=!1,_=!1;return this._li.computeIntersection(o,s,this._corner[0],this._corner[1]),!!this._li.isProper()||(this._li.computeIntersection(o,s,this._corner[1],this._corner[2]),!!this._li.isProper()||(this._li.hasIntersection()&&(d=!0),this._li.computeIntersection(o,s,this._corner[2],this._corner[3]),!!this._li.isProper()||(this._li.hasIntersection()&&(_=!0),this._li.computeIntersection(o,s,this._corner[3],this._corner[0]),!!this._li.isProper()||!(!d||!_)||!!o.equals(this._pt)||!!s.equals(this._pt))))},ds.prototype.addSnappedNode=function(o,s){var d=o.getCoordinate(s),_=o.getCoordinate(s+1);return!!this.intersects(d,_)&&(o.addIntersection(this.getCoordinate(),s),!0)},ds.prototype.interfaces_=function(){return[]},ds.prototype.getClass=function(){return ds},Is.SAFE_ENV_EXPANSION_FACTOR.get=function(){return .75},Object.defineProperties(ds,Is);var kl=function(){this.tempEnv1=new xr,this.selectedSegment=new Sn};kl.prototype.select=function(){if(arguments.length!==1){if(arguments.length===2){var o=arguments[0],s=arguments[1];o.getLineSegment(s,this.selectedSegment),this.select(this.selectedSegment)}}},kl.prototype.interfaces_=function(){return[]},kl.prototype.getClass=function(){return kl};var el=function(){this._index=null;var o=arguments[0];this._index=o},Jc={HotPixelSnapAction:{configurable:!0}};el.prototype.snap=function(){if(arguments.length===1){var o=arguments[0];return this.snap(o,null,-1)}if(arguments.length===3){var s=arguments[0],d=arguments[1],_=arguments[2],w=s.getSafeEnvelope(),j=new Ff(s,d,_);return this._index.query(w,{interfaces_:function(){return[fu]},visitItem:function(ie){ie.select(w,j)}}),j.isNodeAdded()}},el.prototype.interfaces_=function(){return[]},el.prototype.getClass=function(){return el},Jc.HotPixelSnapAction.get=function(){return Ff},Object.defineProperties(el,Jc);var Ff=function(o){function s(){o.call(this),this._hotPixel=null,this._parentEdge=null,this._hotPixelVertexIndex=null,this._isNodeAdded=!1;var d=arguments[0],_=arguments[1],w=arguments[2];this._hotPixel=d,this._parentEdge=_,this._hotPixelVertexIndex=w}return o&&(s.__proto__=o),s.prototype=Object.create(o&&o.prototype),s.prototype.constructor=s,s.prototype.isNodeAdded=function(){return this._isNodeAdded},s.prototype.select=function(){if(arguments.length!==2)return o.prototype.select.apply(this,arguments);var d=arguments[0],_=arguments[1],w=d.getContext();if(this._parentEdge!==null&&w===this._parentEdge&&_===this._hotPixelVertexIndex)return null;this._isNodeAdded=this._hotPixel.addSnappedNode(w,_)},s.prototype.interfaces_=function(){return[]},s.prototype.getClass=function(){return s},s}(kl),yl=function(){this._li=null,this._interiorIntersections=null;var o=arguments[0];this._li=o,this._interiorIntersections=new Gr};yl.prototype.processIntersections=function(o,s,d,_){if(o===d&&s===_)return null;var w=o.getCoordinates()[s],j=o.getCoordinates()[s+1],ie=d.getCoordinates()[_],ke=d.getCoordinates()[_+1];if(this._li.computeIntersection(w,j,ie,ke),this._li.hasIntersection()&&this._li.isInteriorIntersection()){for(var tt=0;tt<this._li.getIntersectionNum();tt++)this._interiorIntersections.add(this._li.getIntersection(tt));o.addIntersections(this._li,s,0),d.addIntersections(this._li,_,1)}},yl.prototype.isDone=function(){return!1},yl.prototype.getInteriorIntersections=function(){return this._interiorIntersections},yl.prototype.interfaces_=function(){return[Ms]},yl.prototype.getClass=function(){return yl};var bu=function(){this._pm=null,this._li=null,this._scaleFactor=null,this._noder=null,this._pointSnapper=null,this._nodedSegStrings=null;var o=arguments[0];this._pm=o,this._li=new $e,this._li.setPrecisionModel(o),this._scaleFactor=o.getScale()};bu.prototype.checkCorrectness=function(o){var s=Ma.getNodedSubstrings(o),d=new Eu(s);try{d.checkValid()}catch(_){if(!(_ instanceof ln))throw _;_.printStackTrace()}},bu.prototype.getNodedSubstrings=function(){return Ma.getNodedSubstrings(this._nodedSegStrings)},bu.prototype.snapRound=function(o,s){var d=this.findInteriorIntersections(o,s);this.computeIntersectionSnaps(d),this.computeVertexSnaps(o)},bu.prototype.findInteriorIntersections=function(o,s){var d=new yl(s);return this._noder.setSegmentIntersector(d),this._noder.computeNodes(o),d.getInteriorIntersections()},bu.prototype.computeVertexSnaps=function(){if(Le(arguments[0],fi))for(var o=arguments[0].iterator();o.hasNext();){var s=o.next();this.computeVertexSnaps(s)}else if(arguments[0]instanceof Ma)for(var d=arguments[0],_=d.getCoordinates(),w=0;w<_.length;w++){var j=new ds(_[w],this._scaleFactor,this._li);this._pointSnapper.snap(j,d,w)&&d.addIntersection(_[w],w)}},bu.prototype.computeNodes=function(o){this._nodedSegStrings=o,this._noder=new mc,this._pointSnapper=new el(this._noder.getIndex()),this.snapRound(o,this._li)},bu.prototype.computeIntersectionSnaps=function(o){for(var s=o.iterator();s.hasNext();){var d=s.next(),_=new ds(d,this._scaleFactor,this._li);this._pointSnapper.snap(_)}},bu.prototype.interfaces_=function(){return[gl]},bu.prototype.getClass=function(){return bu};var wo=function(){if(this._argGeom=null,this._distance=null,this._bufParams=new ea,this._resultGeometry=null,this._saveException=null,arguments.length===1){var o=arguments[0];this._argGeom=o}else if(arguments.length===2){var s=arguments[0],d=arguments[1];this._argGeom=s,this._bufParams=d}},_l={CAP_ROUND:{configurable:!0},CAP_BUTT:{configurable:!0},CAP_FLAT:{configurable:!0},CAP_SQUARE:{configurable:!0},MAX_PRECISION_DIGITS:{configurable:!0}};wo.prototype.bufferFixedPrecision=function(o){var s=new Nu(new bu(new zi(1)),o.getScale()),d=new yo(this._bufParams);d.setWorkingPrecisionModel(o),d.setNoder(s),this._resultGeometry=d.buffer(this._argGeom,this._distance)},wo.prototype.bufferReducedPrecision=function(){var o=this;if(arguments.length===0){for(var s=wo.MAX_PRECISION_DIGITS;s>=0;s--){try{o.bufferReducedPrecision(s)}catch(j){if(!(j instanceof zt))throw j;o._saveException=j}if(o._resultGeometry!==null)return null}throw this._saveException}if(arguments.length===1){var d=arguments[0],_=wo.precisionScaleFactor(this._argGeom,this._distance,d),w=new zi(_);this.bufferFixedPrecision(w)}},wo.prototype.computeGeometry=function(){if(this.bufferOriginalPrecision(),this._resultGeometry!==null)return null;var o=this._argGeom.getFactory().getPrecisionModel();o.getType()===zi.FIXED?this.bufferFixedPrecision(o):this.bufferReducedPrecision()},wo.prototype.setQuadrantSegments=function(o){this._bufParams.setQuadrantSegments(o)},wo.prototype.bufferOriginalPrecision=function(){try{var o=new yo(this._bufParams);this._resultGeometry=o.buffer(this._argGeom,this._distance)}catch(s){if(!(s instanceof ki))throw s;this._saveException=s}},wo.prototype.getResultGeometry=function(o){return this._distance=o,this.computeGeometry(),this._resultGeometry},wo.prototype.setEndCapStyle=function(o){this._bufParams.setEndCapStyle(o)},wo.prototype.interfaces_=function(){return[]},wo.prototype.getClass=function(){return wo},wo.bufferOp=function(){if(arguments.length===2){var o=arguments[0],s=arguments[1];return new wo(o).getResultGeometry(s)}if(arguments.length===3){if(Number.isInteger(arguments[2])&&arguments[0]instanceof Tt&&typeof arguments[1]=="number"){var d=arguments[0],_=arguments[1],w=arguments[2],j=new wo(d);return j.setQuadrantSegments(w),j.getResultGeometry(_)}if(arguments[2]instanceof ea&&arguments[0]instanceof Tt&&typeof arguments[1]=="number"){var ie=arguments[0],ke=arguments[1],tt=arguments[2];return new wo(ie,tt).getResultGeometry(ke)}}else if(arguments.length===4){var Pt=arguments[0],tr=arguments[1],st=arguments[2],Zt=arguments[3],Jt=new wo(Pt);return Jt.setQuadrantSegments(st),Jt.setEndCapStyle(Zt),Jt.getResultGeometry(tr)}},wo.precisionScaleFactor=function(o,s,d){var _=o.getEnvelopeInternal(),w=de.max(Math.abs(_.getMaxX()),Math.abs(_.getMaxY()),Math.abs(_.getMinX()),Math.abs(_.getMinY()))+2*(s>0?s:0),j=d-Math.trunc(Math.log(w)/Math.log(10)+1);return Math.pow(10,j)},_l.CAP_ROUND.get=function(){return ea.CAP_ROUND},_l.CAP_BUTT.get=function(){return ea.CAP_FLAT},_l.CAP_FLAT.get=function(){return ea.CAP_FLAT},_l.CAP_SQUARE.get=function(){return ea.CAP_SQUARE},_l.MAX_PRECISION_DIGITS.get=function(){return 12},Object.defineProperties(wo,_l);var Zo=function(){this._pt=[new Y,new Y],this._distance=ne.NaN,this._isNull=!0};Zo.prototype.getCoordinates=function(){return this._pt},Zo.prototype.getCoordinate=function(o){return this._pt[o]},Zo.prototype.setMinimum=function(){if(arguments.length===1){var o=arguments[0];this.setMinimum(o._pt[0],o._pt[1])}else if(arguments.length===2){var s=arguments[0],d=arguments[1];if(this._isNull)return this.initialize(s,d),null;var _=s.distance(d);_<this._distance&&this.initialize(s,d,_)}},Zo.prototype.initialize=function(){if(arguments.length===0)this._isNull=!0;else if(arguments.length===2){var o=arguments[0],s=arguments[1];this._pt[0].setCoordinate(o),this._pt[1].setCoordinate(s),this._distance=o.distance(s),this._isNull=!1}else if(arguments.length===3){var d=arguments[0],_=arguments[1],w=arguments[2];this._pt[0].setCoordinate(d),this._pt[1].setCoordinate(_),this._distance=w,this._isNull=!1}},Zo.prototype.getDistance=function(){return this._distance},Zo.prototype.setMaximum=function(){if(arguments.length===1){var o=arguments[0];this.setMaximum(o._pt[0],o._pt[1])}else if(arguments.length===2){var s=arguments[0],d=arguments[1];if(this._isNull)return this.initialize(s,d),null;var _=s.distance(d);_>this._distance&&this.initialize(s,d,_)}},Zo.prototype.interfaces_=function(){return[]},Zo.prototype.getClass=function(){return Zo};var Su=function(){};Su.prototype.interfaces_=function(){return[]},Su.prototype.getClass=function(){return Su},Su.computeDistance=function(){if(arguments[2]instanceof Zo&&arguments[0]instanceof xa&&arguments[1]instanceof Y)for(var o=arguments[0],s=arguments[1],d=arguments[2],_=o.getCoordinates(),w=new Sn,j=0;j<_.length-1;j++){w.setCoordinates(_[j],_[j+1]);var ie=w.closestPoint(s);d.setMinimum(ie,s)}else if(arguments[2]instanceof Zo&&arguments[0]instanceof wa&&arguments[1]instanceof Y){var ke=arguments[0],tt=arguments[1],Pt=arguments[2];Su.computeDistance(ke.getExteriorRing(),tt,Pt);for(var tr=0;tr<ke.getNumInteriorRing();tr++)Su.computeDistance(ke.getInteriorRingN(tr),tt,Pt)}else if(arguments[2]instanceof Zo&&arguments[0]instanceof Tt&&arguments[1]instanceof Y){var st=arguments[0],Zt=arguments[1],Jt=arguments[2];if(st instanceof xa)Su.computeDistance(st,Zt,Jt);else if(st instanceof wa)Su.computeDistance(st,Zt,Jt);else if(st instanceof Lo)for(var yr=st,v=0;v<yr.getNumGeometries();v++){var Pn=yr.getGeometryN(v);Su.computeDistance(Pn,Zt,Jt)}else Jt.setMinimum(st.getCoordinate(),Zt)}else if(arguments[2]instanceof Zo&&arguments[0]instanceof Sn&&arguments[1]instanceof Y){var jn=arguments[0],Xe=arguments[1],Ia=arguments[2],ao=jn.closestPoint(Xe);Ia.setMinimum(ao,Xe)}};var Fu=function(o){this._maxPtDist=new Zo,this._inputGeom=o||null},ef={MaxPointDistanceFilter:{configurable:!0},MaxMidpointDistanceFilter:{configurable:!0}};Fu.prototype.computeMaxMidpointDistance=function(o){var s=new Bu(this._inputGeom);o.apply(s),this._maxPtDist.setMaximum(s.getMaxPointDistance())},Fu.prototype.computeMaxVertexDistance=function(o){var s=new xl(this._inputGeom);o.apply(s),this._maxPtDist.setMaximum(s.getMaxPointDistance())},Fu.prototype.findDistance=function(o){return this.computeMaxVertexDistance(o),this.computeMaxMidpointDistance(o),this._maxPtDist.getDistance()},Fu.prototype.getDistancePoints=function(){return this._maxPtDist},Fu.prototype.interfaces_=function(){return[]},Fu.prototype.getClass=function(){return Fu},ef.MaxPointDistanceFilter.get=function(){return xl},ef.MaxMidpointDistanceFilter.get=function(){return Bu},Object.defineProperties(Fu,ef);var xl=function(o){this._maxPtDist=new Zo,this._minPtDist=new Zo,this._geom=o||null};xl.prototype.filter=function(o){this._minPtDist.initialize(),Su.computeDistance(this._geom,o,this._minPtDist),this._maxPtDist.setMaximum(this._minPtDist)},xl.prototype.getMaxPointDistance=function(){return this._maxPtDist},xl.prototype.interfaces_=function(){return[Dr]},xl.prototype.getClass=function(){return xl};var Bu=function(o){this._maxPtDist=new Zo,this._minPtDist=new Zo,this._geom=o||null};Bu.prototype.filter=function(o,s){if(s===0)return null;var d=o.getCoordinate(s-1),_=o.getCoordinate(s),w=new Y((d.x+_.x)/2,(d.y+_.y)/2);this._minPtDist.initialize(),Su.computeDistance(this._geom,w,this._minPtDist),this._maxPtDist.setMaximum(this._minPtDist)},Bu.prototype.isDone=function(){return!1},Bu.prototype.isGeometryChanged=function(){return!1},Bu.prototype.getMaxPointDistance=function(){return this._maxPtDist},Bu.prototype.interfaces_=function(){return[es]},Bu.prototype.getClass=function(){return Bu};var pu=function(o){this._comps=o||null};pu.prototype.filter=function(o){o instanceof wa&&this._comps.add(o)},pu.prototype.interfaces_=function(){return[no]},pu.prototype.getClass=function(){return pu},pu.getPolygons=function(){if(arguments.length===1){var o=arguments[0];return pu.getPolygons(o,new Gr)}if(arguments.length===2){var s=arguments[0],d=arguments[1];return s instanceof wa?d.add(s):s instanceof Lo&&s.apply(new pu(d)),d}};var _o=function(){if(this._lines=null,this._isForcedToLineString=!1,arguments.length===1){var o=arguments[0];this._lines=o}else if(arguments.length===2){var s=arguments[0],d=arguments[1];this._lines=s,this._isForcedToLineString=d}};_o.prototype.filter=function(o){if(this._isForcedToLineString&&o instanceof pr){var s=o.getFactory().createLineString(o.getCoordinateSequence());return this._lines.add(s),null}o instanceof xa&&this._lines.add(o)},_o.prototype.setForceToLineString=function(o){this._isForcedToLineString=o},_o.prototype.interfaces_=function(){return[vt]},_o.prototype.getClass=function(){return _o},_o.getGeometry=function(){if(arguments.length===1){var o=arguments[0];return o.getFactory().buildGeometry(_o.getLines(o))}if(arguments.length===2){var s=arguments[0],d=arguments[1];return s.getFactory().buildGeometry(_o.getLines(s,d))}},_o.getLines=function(){if(arguments.length===1){var o=arguments[0];return _o.getLines(o,!1)}if(arguments.length===2){if(Le(arguments[0],fi)&&Le(arguments[1],fi)){for(var s=arguments[0],d=arguments[1],_=s.iterator();_.hasNext();){var w=_.next();_o.getLines(w,d)}return d}if(arguments[0]instanceof Tt&&typeof arguments[1]=="boolean"){var j=arguments[0],ie=arguments[1],ke=new Gr;return j.apply(new _o(ke,ie)),ke}if(arguments[0]instanceof Tt&&Le(arguments[1],fi)){var tt=arguments[0],Pt=arguments[1];return tt instanceof xa?Pt.add(tt):tt.apply(new _o(Pt)),Pt}}else if(arguments.length===3){if(typeof arguments[2]=="boolean"&&Le(arguments[0],fi)&&Le(arguments[1],fi)){for(var tr=arguments[0],st=arguments[1],Zt=arguments[2],Jt=tr.iterator();Jt.hasNext();){var yr=Jt.next();_o.getLines(yr,st,Zt)}return st}if(typeof arguments[2]=="boolean"&&arguments[0]instanceof Tt&&Le(arguments[1],fi)){var v=arguments[0],Pn=arguments[1],jn=arguments[2];return v.apply(new _o(Pn,jn)),Pn}}};var Cu=function(){if(this._boundaryRule=Yr.OGC_SFS_BOUNDARY_RULE,this._isIn=null,this._numBoundaries=null,arguments.length!==0){if(arguments.length===1){var o=arguments[0];if(o===null)throw new we("Rule must be non-null");this._boundaryRule=o}}};Cu.prototype.locateInternal=function(){if(arguments[0]instanceof Y&&arguments[1]instanceof wa){var o=arguments[0],s=arguments[1];if(s.isEmpty())return _e.EXTERIOR;var d=s.getExteriorRing(),_=this.locateInPolygonRing(o,d);if(_===_e.EXTERIOR)return _e.EXTERIOR;if(_===_e.BOUNDARY)return _e.BOUNDARY;for(var w=0;w<s.getNumInteriorRing();w++){var j=s.getInteriorRingN(w),ie=this.locateInPolygonRing(o,j);if(ie===_e.INTERIOR)return _e.EXTERIOR;if(ie===_e.BOUNDARY)return _e.BOUNDARY}return _e.INTERIOR}if(arguments[0]instanceof Y&&arguments[1]instanceof xa){var ke=arguments[0],tt=arguments[1];if(!tt.getEnvelopeInternal().intersects(ke))return _e.EXTERIOR;var Pt=tt.getCoordinates();return tt.isClosed()||!ke.equals(Pt[0])&&!ke.equals(Pt[Pt.length-1])?wt.isOnLine(ke,Pt)?_e.INTERIOR:_e.EXTERIOR:_e.BOUNDARY}if(arguments[0]instanceof Y&&arguments[1]instanceof uo){var tr=arguments[0];return arguments[1].getCoordinate().equals2D(tr)?_e.INTERIOR:_e.EXTERIOR}},Cu.prototype.locateInPolygonRing=function(o,s){return s.getEnvelopeInternal().intersects(o)?wt.locatePointInRing(o,s.getCoordinates()):_e.EXTERIOR},Cu.prototype.intersects=function(o,s){return this.locate(o,s)!==_e.EXTERIOR},Cu.prototype.updateLocationInfo=function(o){o===_e.INTERIOR&&(this._isIn=!0),o===_e.BOUNDARY&&this._numBoundaries++},Cu.prototype.computeLocation=function(o,s){if(s instanceof uo&&this.updateLocationInfo(this.locateInternal(o,s)),s instanceof xa)this.updateLocationInfo(this.locateInternal(o,s));else if(s instanceof wa)this.updateLocationInfo(this.locateInternal(o,s));else if(s instanceof Ni)for(var d=s,_=0;_<d.getNumGeometries();_++){var w=d.getGeometryN(_);this.updateLocationInfo(this.locateInternal(o,w))}else if(s instanceof vn)for(var j=s,ie=0;ie<j.getNumGeometries();ie++){var ke=j.getGeometryN(ie);this.updateLocationInfo(this.locateInternal(o,ke))}else if(s instanceof Lo)for(var tt=new No(s);tt.hasNext();){var Pt=tt.next();Pt!==s&&this.computeLocation(o,Pt)}},Cu.prototype.locate=function(o,s){return s.isEmpty()?_e.EXTERIOR:s instanceof xa?this.locateInternal(o,s):s instanceof wa?this.locateInternal(o,s):(this._isIn=!1,this._numBoundaries=0,this.computeLocation(o,s),this._boundaryRule.isInBoundary(this._numBoundaries)?_e.BOUNDARY:this._numBoundaries>0||this._isIn?_e.INTERIOR:_e.EXTERIOR)},Cu.prototype.interfaces_=function(){return[]},Cu.prototype.getClass=function(){return Cu};var ho=function o(){if(this._component=null,this._segIndex=null,this._pt=null,arguments.length===2){var s=arguments[0],d=arguments[1];o.call(this,s,o.INSIDE_AREA,d)}else if(arguments.length===3){var _=arguments[0],w=arguments[1],j=arguments[2];this._component=_,this._segIndex=w,this._pt=j}},o0={INSIDE_AREA:{configurable:!0}};ho.prototype.isInsideArea=function(){return this._segIndex===ho.INSIDE_AREA},ho.prototype.getCoordinate=function(){return this._pt},ho.prototype.getGeometryComponent=function(){return this._component},ho.prototype.getSegmentIndex=function(){return this._segIndex},ho.prototype.interfaces_=function(){return[]},ho.prototype.getClass=function(){return ho},o0.INSIDE_AREA.get=function(){return-1},Object.defineProperties(ho,o0);var tl=function(o){this._pts=o||null};tl.prototype.filter=function(o){o instanceof uo&&this._pts.add(o)},tl.prototype.interfaces_=function(){return[no]},tl.prototype.getClass=function(){return tl},tl.getPoints=function(){if(arguments.length===1){var o=arguments[0];return o instanceof uo?Ha.singletonList(o):tl.getPoints(o,new Gr)}if(arguments.length===2){var s=arguments[0],d=arguments[1];return s instanceof uo?d.add(s):s instanceof Lo&&s.apply(new tl(d)),d}};var nc=function(){this._locations=null;var o=arguments[0];this._locations=o};nc.prototype.filter=function(o){(o instanceof uo||o instanceof xa||o instanceof wa)&&this._locations.add(new ho(o,0,o.getCoordinate()))},nc.prototype.interfaces_=function(){return[no]},nc.prototype.getClass=function(){return nc},nc.getLocations=function(o){var s=new Gr;return o.apply(new nc(s)),s};var zo=function(){if(this._geom=null,this._terminateDistance=0,this._ptLocator=new Cu,this._minDistanceLocation=null,this._minDistance=ne.MAX_VALUE,arguments.length===2){var o=arguments[0],s=arguments[1];this._geom=[o,s],this._terminateDistance=0}else if(arguments.length===3){var d=arguments[0],_=arguments[1],w=arguments[2];this._geom=new Array(2).fill(null),this._geom[0]=d,this._geom[1]=_,this._terminateDistance=w}};zo.prototype.computeContainmentDistance=function(){if(arguments.length===0){var o=new Array(2).fill(null);if(this.computeContainmentDistance(0,o),this._minDistance<=this._terminateDistance)return null;this.computeContainmentDistance(1,o)}else if(arguments.length===2){var s=arguments[0],d=arguments[1],_=1-s,w=pu.getPolygons(this._geom[s]);if(w.size()>0){var j=nc.getLocations(this._geom[_]);if(this.computeContainmentDistance(j,w,d),this._minDistance<=this._terminateDistance)return this._minDistanceLocation[_]=d[0],this._minDistanceLocation[s]=d[1],null}}else if(arguments.length===3){if(arguments[2]instanceof Array&&Le(arguments[0],Oa)&&Le(arguments[1],Oa)){for(var ie=arguments[0],ke=arguments[1],tt=arguments[2],Pt=0;Pt<ie.size();Pt++)for(var tr=ie.get(Pt),st=0;st<ke.size();st++)if(this.computeContainmentDistance(tr,ke.get(st),tt),this._minDistance<=this._terminateDistance)return null}else if(arguments[2]instanceof Array&&arguments[0]instanceof ho&&arguments[1]instanceof wa){var Zt=arguments[0],Jt=arguments[1],yr=arguments[2],v=Zt.getCoordinate();if(_e.EXTERIOR!==this._ptLocator.locate(v,Jt))return this._minDistance=0,yr[0]=Zt,yr[1]=new ho(Jt,v),null}}},zo.prototype.computeMinDistanceLinesPoints=function(o,s,d){for(var _=0;_<o.size();_++)for(var w=o.get(_),j=0;j<s.size();j++){var ie=s.get(j);if(this.computeMinDistance(w,ie,d),this._minDistance<=this._terminateDistance)return null}},zo.prototype.computeFacetDistance=function(){var o=new Array(2).fill(null),s=_o.getLines(this._geom[0]),d=_o.getLines(this._geom[1]),_=tl.getPoints(this._geom[0]),w=tl.getPoints(this._geom[1]);return this.computeMinDistanceLines(s,d,o),this.updateMinDistance(o,!1),this._minDistance<=this._terminateDistance?null:(o[0]=null,o[1]=null,this.computeMinDistanceLinesPoints(s,w,o),this.updateMinDistance(o,!1),this._minDistance<=this._terminateDistance?null:(o[0]=null,o[1]=null,this.computeMinDistanceLinesPoints(d,_,o),this.updateMinDistance(o,!0),this._minDistance<=this._terminateDistance?null:(o[0]=null,o[1]=null,this.computeMinDistancePoints(_,w,o),void this.updateMinDistance(o,!1))))},zo.prototype.nearestLocations=function(){return this.computeMinDistance(),this._minDistanceLocation},zo.prototype.updateMinDistance=function(o,s){if(o[0]===null)return null;s?(this._minDistanceLocation[0]=o[1],this._minDistanceLocation[1]=o[0]):(this._minDistanceLocation[0]=o[0],this._minDistanceLocation[1]=o[1])},zo.prototype.nearestPoints=function(){return this.computeMinDistance(),[this._minDistanceLocation[0].getCoordinate(),this._minDistanceLocation[1].getCoordinate()]},zo.prototype.computeMinDistance=function(){if(arguments.length===0){if(this._minDistanceLocation!==null||(this._minDistanceLocation=new Array(2).fill(null),this.computeContainmentDistance(),this._minDistance<=this._terminateDistance))return null;this.computeFacetDistance()}else if(arguments.length===3){if(arguments[2]instanceof Array&&arguments[0]instanceof xa&&arguments[1]instanceof uo){var o=arguments[0],s=arguments[1],d=arguments[2];if(o.getEnvelopeInternal().distance(s.getEnvelopeInternal())>this._minDistance)return null;for(var _=o.getCoordinates(),w=s.getCoordinate(),j=0;j<_.length-1;j++){var ie=wt.distancePointLine(w,_[j],_[j+1]);if(ie<this._minDistance){this._minDistance=ie;var ke=new Sn(_[j],_[j+1]).closestPoint(w);d[0]=new ho(o,j,ke),d[1]=new ho(s,0,w)}if(this._minDistance<=this._terminateDistance)return null}}else if(arguments[2]instanceof Array&&arguments[0]instanceof xa&&arguments[1]instanceof xa){var tt=arguments[0],Pt=arguments[1],tr=arguments[2];if(tt.getEnvelopeInternal().distance(Pt.getEnvelopeInternal())>this._minDistance)return null;for(var st=tt.getCoordinates(),Zt=Pt.getCoordinates(),Jt=0;Jt<st.length-1;Jt++)for(var yr=0;yr<Zt.length-1;yr++){var v=wt.distanceLineLine(st[Jt],st[Jt+1],Zt[yr],Zt[yr+1]);if(v<this._minDistance){this._minDistance=v;var Pn=new Sn(st[Jt],st[Jt+1]),jn=new Sn(Zt[yr],Zt[yr+1]),Xe=Pn.closestPoints(jn);tr[0]=new ho(tt,Jt,Xe[0]),tr[1]=new ho(Pt,yr,Xe[1])}if(this._minDistance<=this._terminateDistance)return null}}}},zo.prototype.computeMinDistancePoints=function(o,s,d){for(var _=0;_<o.size();_++)for(var w=o.get(_),j=0;j<s.size();j++){var ie=s.get(j),ke=w.getCoordinate().distance(ie.getCoordinate());if(ke<this._minDistance&&(this._minDistance=ke,d[0]=new ho(w,0,w.getCoordinate()),d[1]=new ho(ie,0,ie.getCoordinate())),this._minDistance<=this._terminateDistance)return null}},zo.prototype.distance=function(){if(this._geom[0]===null||this._geom[1]===null)throw new we("null geometries are not supported");return this._geom[0].isEmpty()||this._geom[1].isEmpty()?0:(this.computeMinDistance(),this._minDistance)},zo.prototype.computeMinDistanceLines=function(o,s,d){for(var _=0;_<o.size();_++)for(var w=o.get(_),j=0;j<s.size();j++){var ie=s.get(j);if(this.computeMinDistance(w,ie,d),this._minDistance<=this._terminateDistance)return null}},zo.prototype.interfaces_=function(){return[]},zo.prototype.getClass=function(){return zo},zo.distance=function(o,s){return new zo(o,s).distance()},zo.isWithinDistance=function(o,s,d){return new zo(o,s,d).distance()<=d},zo.nearestPoints=function(o,s){return new zo(o,s).nearestPoints()};var Xo=function(){this._pt=[new Y,new Y],this._distance=ne.NaN,this._isNull=!0};Xo.prototype.getCoordinates=function(){return this._pt},Xo.prototype.getCoordinate=function(o){return this._pt[o]},Xo.prototype.setMinimum=function(){if(arguments.length===1){var o=arguments[0];this.setMinimum(o._pt[0],o._pt[1])}else if(arguments.length===2){var s=arguments[0],d=arguments[1];if(this._isNull)return this.initialize(s,d),null;var _=s.distance(d);_<this._distance&&this.initialize(s,d,_)}},Xo.prototype.initialize=function(){if(arguments.length===0)this._isNull=!0;else if(arguments.length===2){var o=arguments[0],s=arguments[1];this._pt[0].setCoordinate(o),this._pt[1].setCoordinate(s),this._distance=o.distance(s),this._isNull=!1}else if(arguments.length===3){var d=arguments[0],_=arguments[1],w=arguments[2];this._pt[0].setCoordinate(d),this._pt[1].setCoordinate(_),this._distance=w,this._isNull=!1}},Xo.prototype.toString=function(){return yn.toLineString(this._pt[0],this._pt[1])},Xo.prototype.getDistance=function(){return this._distance},Xo.prototype.setMaximum=function(){if(arguments.length===1){var o=arguments[0];this.setMaximum(o._pt[0],o._pt[1])}else if(arguments.length===2){var s=arguments[0],d=arguments[1];if(this._isNull)return this.initialize(s,d),null;var _=s.distance(d);_>this._distance&&this.initialize(s,d,_)}},Xo.prototype.interfaces_=function(){return[]},Xo.prototype.getClass=function(){return Xo};var Vs=function(){};Vs.prototype.interfaces_=function(){return[]},Vs.prototype.getClass=function(){return Vs},Vs.computeDistance=function(){if(arguments[2]instanceof Xo&&arguments[0]instanceof xa&&arguments[1]instanceof Y)for(var o=arguments[0],s=arguments[1],d=arguments[2],_=new Sn,w=o.getCoordinates(),j=0;j<w.length-1;j++){_.setCoordinates(w[j],w[j+1]);var ie=_.closestPoint(s);d.setMinimum(ie,s)}else if(arguments[2]instanceof Xo&&arguments[0]instanceof wa&&arguments[1]instanceof Y){var ke=arguments[0],tt=arguments[1],Pt=arguments[2];Vs.computeDistance(ke.getExteriorRing(),tt,Pt);for(var tr=0;tr<ke.getNumInteriorRing();tr++)Vs.computeDistance(ke.getInteriorRingN(tr),tt,Pt)}else if(arguments[2]instanceof Xo&&arguments[0]instanceof Tt&&arguments[1]instanceof Y){var st=arguments[0],Zt=arguments[1],Jt=arguments[2];if(st instanceof xa)Vs.computeDistance(st,Zt,Jt);else if(st instanceof wa)Vs.computeDistance(st,Zt,Jt);else if(st instanceof Lo)for(var yr=st,v=0;v<yr.getNumGeometries();v++){var Pn=yr.getGeometryN(v);Vs.computeDistance(Pn,Zt,Jt)}else Jt.setMinimum(st.getCoordinate(),Zt)}else if(arguments[2]instanceof Xo&&arguments[0]instanceof Sn&&arguments[1]instanceof Y){var jn=arguments[0],Xe=arguments[1],Ia=arguments[2],ao=jn.closestPoint(Xe);Ia.setMinimum(ao,Xe)}};var Hs=function(){this._g0=null,this._g1=null,this._ptDist=new Xo,this._densifyFrac=0;var o=arguments[0],s=arguments[1];this._g0=o,this._g1=s},_c={MaxPointDistanceFilter:{configurable:!0},MaxDensifiedByFractionDistanceFilter:{configurable:!0}};Hs.prototype.getCoordinates=function(){return this._ptDist.getCoordinates()},Hs.prototype.setDensifyFraction=function(o){if(o>1||o<=0)throw new we("Fraction is not in range (0.0 - 1.0]");this._densifyFrac=o},Hs.prototype.compute=function(o,s){this.computeOrientedDistance(o,s,this._ptDist),this.computeOrientedDistance(s,o,this._ptDist)},Hs.prototype.distance=function(){return this.compute(this._g0,this._g1),this._ptDist.getDistance()},Hs.prototype.computeOrientedDistance=function(o,s,d){var _=new Ps(s);if(o.apply(_),d.setMaximum(_.getMaxPointDistance()),this._densifyFrac>0){var w=new El(s,this._densifyFrac);o.apply(w),d.setMaximum(w.getMaxPointDistance())}},Hs.prototype.orientedDistance=function(){return this.computeOrientedDistance(this._g0,this._g1,this._ptDist),this._ptDist.getDistance()},Hs.prototype.interfaces_=function(){return[]},Hs.prototype.getClass=function(){return Hs},Hs.distance=function(){if(arguments.length===2){var o=arguments[0],s=arguments[1];return new Hs(o,s).distance()}if(arguments.length===3){var d=arguments[0],_=arguments[1],w=arguments[2],j=new Hs(d,_);return j.setDensifyFraction(w),j.distance()}},_c.MaxPointDistanceFilter.get=function(){return Ps},_c.MaxDensifiedByFractionDistanceFilter.get=function(){return El},Object.defineProperties(Hs,_c);var Ps=function(){this._maxPtDist=new Xo,this._minPtDist=new Xo,this._euclideanDist=new Vs,this._geom=null;var o=arguments[0];this._geom=o};Ps.prototype.filter=function(o){this._minPtDist.initialize(),Vs.computeDistance(this._geom,o,this._minPtDist),this._maxPtDist.setMaximum(this._minPtDist)},Ps.prototype.getMaxPointDistance=function(){return this._maxPtDist},Ps.prototype.interfaces_=function(){return[Dr]},Ps.prototype.getClass=function(){return Ps};var El=function(){this._maxPtDist=new Xo,this._minPtDist=new Xo,this._geom=null,this._numSubSegs=0;var o=arguments[0],s=arguments[1];this._geom=o,this._numSubSegs=Math.trunc(Math.round(1/s))};El.prototype.filter=function(o,s){if(s===0)return null;for(var d=o.getCoordinate(s-1),_=o.getCoordinate(s),w=(_.x-d.x)/this._numSubSegs,j=(_.y-d.y)/this._numSubSegs,ie=0;ie<this._numSubSegs;ie++){var ke=d.x+ie*w,tt=d.y+ie*j,Pt=new Y(ke,tt);this._minPtDist.initialize(),Vs.computeDistance(this._geom,Pt,this._minPtDist),this._maxPtDist.setMaximum(this._minPtDist)}},El.prototype.isDone=function(){return!1},El.prototype.isGeometryChanged=function(){return!1},El.prototype.getMaxPointDistance=function(){return this._maxPtDist},El.prototype.interfaces_=function(){return[es]},El.prototype.getClass=function(){return El};var To=function(o,s,d){this._minValidDistance=null,this._maxValidDistance=null,this._minDistanceFound=null,this._maxDistanceFound=null,this._isValid=!0,this._errMsg=null,this._errorLocation=null,this._errorIndicator=null,this._input=o||null,this._bufDistance=s||null,this._result=d||null},Ls={VERBOSE:{configurable:!0},MAX_DISTANCE_DIFF_FRAC:{configurable:!0}};To.prototype.checkMaximumDistance=function(o,s,d){var _=new Hs(s,o);if(_.setDensifyFraction(.25),this._maxDistanceFound=_.orientedDistance(),this._maxDistanceFound>d){this._isValid=!1;var w=_.getCoordinates();this._errorLocation=w[1],this._errorIndicator=o.getFactory().createLineString(w),this._errMsg="Distance between buffer curve and input is too large ("+this._maxDistanceFound+" at "+yn.toLineString(w[0],w[1])+")"}},To.prototype.isValid=function(){var o=Math.abs(this._bufDistance),s=To.MAX_DISTANCE_DIFF_FRAC*o;return this._minValidDistance=o-s,this._maxValidDistance=o+s,!(!this._input.isEmpty()&&!this._result.isEmpty())||(this._bufDistance>0?this.checkPositiveValid():this.checkNegativeValid(),To.VERBOSE&&Qr.out.println("Min Dist= "+this._minDistanceFound+"  err= "+(1-this._minDistanceFound/this._bufDistance)+"  Max Dist= "+this._maxDistanceFound+"  err= "+(this._maxDistanceFound/this._bufDistance-1)),this._isValid)},To.prototype.checkNegativeValid=function(){if(!(this._input instanceof wa||this._input instanceof vn||this._input instanceof Lo))return null;var o=this.getPolygonLines(this._input);if(this.checkMinimumDistance(o,this._result,this._minValidDistance),!this._isValid)return null;this.checkMaximumDistance(o,this._result,this._maxValidDistance)},To.prototype.getErrorIndicator=function(){return this._errorIndicator},To.prototype.checkMinimumDistance=function(o,s,d){var _=new zo(o,s,d);if(this._minDistanceFound=_.distance(),this._minDistanceFound<d){this._isValid=!1;var w=_.nearestPoints();this._errorLocation=_.nearestPoints()[1],this._errorIndicator=o.getFactory().createLineString(w),this._errMsg="Distance between buffer curve and input is too small ("+this._minDistanceFound+" at "+yn.toLineString(w[0],w[1])+" )"}},To.prototype.checkPositiveValid=function(){var o=this._result.getBoundary();if(this.checkMinimumDistance(this._input,o,this._minValidDistance),!this._isValid)return null;this.checkMaximumDistance(this._input,o,this._maxValidDistance)},To.prototype.getErrorLocation=function(){return this._errorLocation},To.prototype.getPolygonLines=function(o){for(var s=new Gr,d=new _o(s),_=pu.getPolygons(o).iterator();_.hasNext();)_.next().apply(d);return o.getFactory().buildGeometry(s)},To.prototype.getErrorMessage=function(){return this._errMsg},To.prototype.interfaces_=function(){return[]},To.prototype.getClass=function(){return To},Ls.VERBOSE.get=function(){return!1},Ls.MAX_DISTANCE_DIFF_FRAC.get=function(){return .012},Object.defineProperties(To,Ls);var za=function(o,s,d){this._isValid=!0,this._errorMsg=null,this._errorLocation=null,this._errorIndicator=null,this._input=o||null,this._distance=s||null,this._result=d||null},ur={VERBOSE:{configurable:!0},MAX_ENV_DIFF_FRAC:{configurable:!0}};za.prototype.isValid=function(){return this.checkPolygonal(),this._isValid?(this.checkExpectedEmpty(),this._isValid?(this.checkEnvelope(),this._isValid?(this.checkArea(),this._isValid?(this.checkDistance(),this._isValid):this._isValid):this._isValid):this._isValid):this._isValid},za.prototype.checkEnvelope=function(){if(this._distance<0)return null;var o=this._distance*za.MAX_ENV_DIFF_FRAC;o===0&&(o=.001);var s=new xr(this._input.getEnvelopeInternal());s.expandBy(this._distance);var d=new xr(this._result.getEnvelopeInternal());d.expandBy(o),d.contains(s)||(this._isValid=!1,this._errorMsg="Buffer envelope is incorrect",this._errorIndicator=this._input.getFactory().toGeometry(d)),this.report("Envelope")},za.prototype.checkDistance=function(){var o=new To(this._input,this._distance,this._result);o.isValid()||(this._isValid=!1,this._errorMsg=o.getErrorMessage(),this._errorLocation=o.getErrorLocation(),this._errorIndicator=o.getErrorIndicator()),this.report("Distance")},za.prototype.checkArea=function(){var o=this._input.getArea(),s=this._result.getArea();this._distance>0&&o>s&&(this._isValid=!1,this._errorMsg="Area of positive buffer is smaller than input",this._errorIndicator=this._result),this._distance<0&&o<s&&(this._isValid=!1,this._errorMsg="Area of negative buffer is larger than input",this._errorIndicator=this._result),this.report("Area")},za.prototype.checkPolygonal=function(){this._result instanceof wa||this._result instanceof vn||(this._isValid=!1),this._errorMsg="Result is not polygonal",this._errorIndicator=this._result,this.report("Polygonal")},za.prototype.getErrorIndicator=function(){return this._errorIndicator},za.prototype.getErrorLocation=function(){return this._errorLocation},za.prototype.checkExpectedEmpty=function(){return this._input.getDimension()>=2||this._distance>0?null:(this._result.isEmpty()||(this._isValid=!1,this._errorMsg="Result is non-empty",this._errorIndicator=this._result),void this.report("ExpectedEmpty"))},za.prototype.report=function(o){if(!za.VERBOSE)return null;Qr.out.println("Check "+o+": "+(this._isValid?"passed":"FAILED"))},za.prototype.getErrorMessage=function(){return this._errorMsg},za.prototype.interfaces_=function(){return[]},za.prototype.getClass=function(){return za},za.isValidMsg=function(o,s,d){var _=new za(o,s,d);return _.isValid()?null:_.getErrorMessage()},za.isValid=function(o,s,d){return!!new za(o,s,d).isValid()},ur.VERBOSE.get=function(){return!1},ur.MAX_ENV_DIFF_FRAC.get=function(){return .012},Object.defineProperties(za,ur);var xt=function(){this._pts=null,this._data=null;var o=arguments[0],s=arguments[1];this._pts=o,this._data=s};xt.prototype.getCoordinates=function(){return this._pts},xt.prototype.size=function(){return this._pts.length},xt.prototype.getCoordinate=function(o){return this._pts[o]},xt.prototype.isClosed=function(){return this._pts[0].equals(this._pts[this._pts.length-1])},xt.prototype.getSegmentOctant=function(o){return o===this._pts.length-1?-1:fa.octant(this.getCoordinate(o),this.getCoordinate(o+1))},xt.prototype.setData=function(o){this._data=o},xt.prototype.getData=function(){return this._data},xt.prototype.toString=function(){return yn.toLineString(new Va(this._pts))},xt.prototype.interfaces_=function(){return[is]},xt.prototype.getClass=function(){return xt};var Me=function(){this._findAllIntersections=!1,this._isCheckEndSegmentsOnly=!1,this._li=null,this._interiorIntersection=null,this._intSegments=null,this._intersections=new Gr,this._intersectionCount=0,this._keepIntersections=!0;var o=arguments[0];this._li=o,this._interiorIntersection=null};Me.prototype.getInteriorIntersection=function(){return this._interiorIntersection},Me.prototype.setCheckEndSegmentsOnly=function(o){this._isCheckEndSegmentsOnly=o},Me.prototype.getIntersectionSegments=function(){return this._intSegments},Me.prototype.count=function(){return this._intersectionCount},Me.prototype.getIntersections=function(){return this._intersections},Me.prototype.setFindAllIntersections=function(o){this._findAllIntersections=o},Me.prototype.setKeepIntersections=function(o){this._keepIntersections=o},Me.prototype.processIntersections=function(o,s,d,_){if(!this._findAllIntersections&&this.hasIntersection()||o===d&&s===_||this._isCheckEndSegmentsOnly&&!(this.isEndSegment(o,s)||this.isEndSegment(d,_)))return null;var w=o.getCoordinates()[s],j=o.getCoordinates()[s+1],ie=d.getCoordinates()[_],ke=d.getCoordinates()[_+1];this._li.computeIntersection(w,j,ie,ke),this._li.hasIntersection()&&this._li.isInteriorIntersection()&&(this._intSegments=new Array(4).fill(null),this._intSegments[0]=w,this._intSegments[1]=j,this._intSegments[2]=ie,this._intSegments[3]=ke,this._interiorIntersection=this._li.getIntersection(0),this._keepIntersections&&this._intersections.add(this._interiorIntersection),this._intersectionCount++)},Me.prototype.isEndSegment=function(o,s){return s===0||s>=o.size()-2},Me.prototype.hasIntersection=function(){return this._interiorIntersection!==null},Me.prototype.isDone=function(){return!this._findAllIntersections&&this._interiorIntersection!==null},Me.prototype.interfaces_=function(){return[Ms]},Me.prototype.getClass=function(){return Me},Me.createAllIntersectionsFinder=function(o){var s=new Me(o);return s.setFindAllIntersections(!0),s},Me.createAnyIntersectionFinder=function(o){return new Me(o)},Me.createIntersectionCounter=function(o){var s=new Me(o);return s.setFindAllIntersections(!0),s.setKeepIntersections(!1),s};var $s=function(){this._li=new $e,this._segStrings=null,this._findAllIntersections=!1,this._segInt=null,this._isValid=!0;var o=arguments[0];this._segStrings=o};$s.prototype.execute=function(){if(this._segInt!==null)return null;this.checkInteriorIntersections()},$s.prototype.getIntersections=function(){return this._segInt.getIntersections()},$s.prototype.isValid=function(){return this.execute(),this._isValid},$s.prototype.setFindAllIntersections=function(o){this._findAllIntersections=o},$s.prototype.checkInteriorIntersections=function(){this._isValid=!0,this._segInt=new Me(this._li),this._segInt.setFindAllIntersections(this._findAllIntersections);var o=new mc;if(o.setSegmentIntersector(this._segInt),o.computeNodes(this._segStrings),this._segInt.hasIntersection())return this._isValid=!1,null},$s.prototype.checkValid=function(){if(this.execute(),!this._isValid)throw new zt(this.getErrorMessage(),this._segInt.getInteriorIntersection())},$s.prototype.getErrorMessage=function(){if(this._isValid)return"no intersections found";var o=this._segInt.getIntersectionSegments();return"found non-noded intersection between "+yn.toLineString(o[0],o[1])+" and "+yn.toLineString(o[2],o[3])},$s.prototype.interfaces_=function(){return[]},$s.prototype.getClass=function(){return $s},$s.computeIntersections=function(o){var s=new $s(o);return s.setFindAllIntersections(!0),s.isValid(),s.getIntersections()};var it=function o(){this._nv=null;var s=arguments[0];this._nv=new $s(o.toSegmentStrings(s))};it.prototype.checkValid=function(){this._nv.checkValid()},it.prototype.interfaces_=function(){return[]},it.prototype.getClass=function(){return it},it.toSegmentStrings=function(o){for(var s=new Gr,d=o.iterator();d.hasNext();){var _=d.next();s.add(new xt(_.getCoordinates(),_))}return s},it.checkValid=function(o){new it(o).checkValid()};var rl=function(o){this._mapOp=o};rl.prototype.map=function(o){for(var s=new Gr,d=0;d<o.getNumGeometries();d++){var _=this._mapOp.map(o.getGeometryN(d));_.isEmpty()||s.add(_)}return o.getFactory().createGeometryCollection(Ai.toGeometryArray(s))},rl.prototype.interfaces_=function(){return[]},rl.prototype.getClass=function(){return rl},rl.map=function(o,s){return new rl(s).map(o)};var ha=function(){this._op=null,this._geometryFactory=null,this._ptLocator=null,this._lineEdgesList=new Gr,this._resultLineList=new Gr;var o=arguments[0],s=arguments[1],d=arguments[2];this._op=o,this._geometryFactory=s,this._ptLocator=d};ha.prototype.collectLines=function(o){for(var s=this._op.getGraph().getEdgeEnds().iterator();s.hasNext();){var d=s.next();this.collectLineEdge(d,o,this._lineEdgesList),this.collectBoundaryTouchEdge(d,o,this._lineEdgesList)}},ha.prototype.labelIsolatedLine=function(o,s){var d=this._ptLocator.locate(o.getCoordinate(),this._op.getArgGeometry(s));o.getLabel().setLocation(s,d)},ha.prototype.build=function(o){return this.findCoveredLineEdges(),this.collectLines(o),this.buildLines(o),this._resultLineList},ha.prototype.collectLineEdge=function(o,s,d){var _=o.getLabel(),w=o.getEdge();o.isLineEdge()&&(o.isVisited()||!Fn.isResultOfOp(_,s)||w.isCovered()||(d.add(w),o.setVisitedEdge(!0)))},ha.prototype.findCoveredLineEdges=function(){for(var o=this._op.getGraph().getNodes().iterator();o.hasNext();)o.next().getEdges().findCoveredLineEdges();for(var s=this._op.getGraph().getEdgeEnds().iterator();s.hasNext();){var d=s.next(),_=d.getEdge();if(d.isLineEdge()&&!_.isCoveredSet()){var w=this._op.isCoveredByA(d.getCoordinate());_.setCovered(w)}}},ha.prototype.labelIsolatedLines=function(o){for(var s=o.iterator();s.hasNext();){var d=s.next(),_=d.getLabel();d.isIsolated()&&(_.isNull(0)?this.labelIsolatedLine(d,0):this.labelIsolatedLine(d,1))}},ha.prototype.buildLines=function(o){for(var s=this._lineEdgesList.iterator();s.hasNext();){var d=s.next(),_=this._geometryFactory.createLineString(d.getCoordinates());this._resultLineList.add(_),d.setInResult(!0)}},ha.prototype.collectBoundaryTouchEdge=function(o,s,d){var _=o.getLabel();return o.isLineEdge()||o.isVisited()||o.isInteriorAreaEdge()||o.getEdge().isInResult()?null:(Lt.isTrue(!(o.isInResult()||o.getSym().isInResult())||!o.getEdge().isInResult()),void(Fn.isResultOfOp(_,s)&&s===Fn.INTERSECTION&&(d.add(o.getEdge()),o.setVisitedEdge(!0))))},ha.prototype.interfaces_=function(){return[]},ha.prototype.getClass=function(){return ha};var Ys=function(){this._op=null,this._geometryFactory=null,this._resultPointList=new Gr;var o=arguments[0],s=arguments[1];this._op=o,this._geometryFactory=s};Ys.prototype.filterCoveredNodeToPoint=function(o){var s=o.getCoordinate();if(!this._op.isCoveredByLA(s)){var d=this._geometryFactory.createPoint(s);this._resultPointList.add(d)}},Ys.prototype.extractNonCoveredResultNodes=function(o){for(var s=this._op.getGraph().getNodes().iterator();s.hasNext();){var d=s.next();if(!d.isInResult()&&!d.isIncidentEdgeInResult()&&(d.getEdges().getDegree()===0||o===Fn.INTERSECTION)){var _=d.getLabel();Fn.isResultOfOp(_,o)&&this.filterCoveredNodeToPoint(d)}}},Ys.prototype.build=function(o){return this.extractNonCoveredResultNodes(o),this._resultPointList},Ys.prototype.interfaces_=function(){return[]},Ys.prototype.getClass=function(){return Ys};var oi=function(){this._inputGeom=null,this._factory=null,this._pruneEmptyGeometry=!0,this._preserveGeometryCollectionType=!0,this._preserveCollections=!1,this._preserveType=!1};oi.prototype.transformPoint=function(o,s){return this._factory.createPoint(this.transformCoordinates(o.getCoordinateSequence(),o))},oi.prototype.transformPolygon=function(o,s){var d=!0,_=this.transformLinearRing(o.getExteriorRing(),o);_!==null&&_ instanceof pr&&!_.isEmpty()||(d=!1);for(var w=new Gr,j=0;j<o.getNumInteriorRing();j++){var ie=this.transformLinearRing(o.getInteriorRingN(j),o);ie===null||ie.isEmpty()||(ie instanceof pr||(d=!1),w.add(ie))}if(d)return this._factory.createPolygon(_,w.toArray([]));var ke=new Gr;return _!==null&&ke.add(_),ke.addAll(w),this._factory.buildGeometry(ke)},oi.prototype.createCoordinateSequence=function(o){return this._factory.getCoordinateSequenceFactory().create(o)},oi.prototype.getInputGeometry=function(){return this._inputGeom},oi.prototype.transformMultiLineString=function(o,s){for(var d=new Gr,_=0;_<o.getNumGeometries();_++){var w=this.transformLineString(o.getGeometryN(_),o);w!==null&&(w.isEmpty()||d.add(w))}return this._factory.buildGeometry(d)},oi.prototype.transformCoordinates=function(o,s){return this.copy(o)},oi.prototype.transformLineString=function(o,s){return this._factory.createLineString(this.transformCoordinates(o.getCoordinateSequence(),o))},oi.prototype.transformMultiPoint=function(o,s){for(var d=new Gr,_=0;_<o.getNumGeometries();_++){var w=this.transformPoint(o.getGeometryN(_),o);w!==null&&(w.isEmpty()||d.add(w))}return this._factory.buildGeometry(d)},oi.prototype.transformMultiPolygon=function(o,s){for(var d=new Gr,_=0;_<o.getNumGeometries();_++){var w=this.transformPolygon(o.getGeometryN(_),o);w!==null&&(w.isEmpty()||d.add(w))}return this._factory.buildGeometry(d)},oi.prototype.copy=function(o){return o.copy()},oi.prototype.transformGeometryCollection=function(o,s){for(var d=new Gr,_=0;_<o.getNumGeometries();_++){var w=this.transform(o.getGeometryN(_));w!==null&&(this._pruneEmptyGeometry&&w.isEmpty()||d.add(w))}return this._preserveGeometryCollectionType?this._factory.createGeometryCollection(Ai.toGeometryArray(d)):this._factory.buildGeometry(d)},oi.prototype.transform=function(o){if(this._inputGeom=o,this._factory=o.getFactory(),o instanceof uo)return this.transformPoint(o,null);if(o instanceof lu)return this.transformMultiPoint(o,null);if(o instanceof pr)return this.transformLinearRing(o,null);if(o instanceof xa)return this.transformLineString(o,null);if(o instanceof Ni)return this.transformMultiLineString(o,null);if(o instanceof wa)return this.transformPolygon(o,null);if(o instanceof vn)return this.transformMultiPolygon(o,null);if(o instanceof Lo)return this.transformGeometryCollection(o,null);throw new we("Unknown Geometry subtype: "+o.getClass().getName())},oi.prototype.transformLinearRing=function(o,s){var d=this.transformCoordinates(o.getCoordinateSequence(),o);if(d===null)return this._factory.createLinearRing(null);var _=d.size();return _>0&&_<4&&!this._preserveType?this._factory.createLineString(d):this._factory.createLinearRing(d)},oi.prototype.interfaces_=function(){return[]},oi.prototype.getClass=function(){return oi};var Aa=function o(){if(this._snapTolerance=0,this._srcPts=null,this._seg=new Sn,this._allowSnappingToSourceVertices=!1,this._isClosed=!1,arguments[0]instanceof xa&&typeof arguments[1]=="number"){var s=arguments[0],d=arguments[1];o.call(this,s.getCoordinates(),d)}else if(arguments[0]instanceof Array&&typeof arguments[1]=="number"){var _=arguments[0],w=arguments[1];this._srcPts=_,this._isClosed=o.isClosed(_),this._snapTolerance=w}};Aa.prototype.snapVertices=function(o,s){for(var d=this._isClosed?o.size()-1:o.size(),_=0;_<d;_++){var w=o.get(_),j=this.findSnapForVertex(w,s);j!==null&&(o.set(_,new Y(j)),_===0&&this._isClosed&&o.set(o.size()-1,new Y(j)))}},Aa.prototype.findSnapForVertex=function(o,s){for(var d=0;d<s.length;d++){if(o.equals2D(s[d]))return null;if(o.distance(s[d])<this._snapTolerance)return s[d]}return null},Aa.prototype.snapTo=function(o){var s=new Co(this._srcPts);return this.snapVertices(s,o),this.snapSegments(s,o),s.toCoordinateArray()},Aa.prototype.snapSegments=function(o,s){if(s.length===0)return null;var d=s.length;s[0].equals2D(s[s.length-1])&&(d=s.length-1);for(var _=0;_<d;_++){var w=s[_],j=this.findSegmentIndexToSnap(w,o);j>=0&&o.add(j+1,new Y(w),!1)}},Aa.prototype.findSegmentIndexToSnap=function(o,s){for(var d=ne.MAX_VALUE,_=-1,w=0;w<s.size()-1;w++){if(this._seg.p0=s.get(w),this._seg.p1=s.get(w+1),this._seg.p0.equals2D(o)||this._seg.p1.equals2D(o)){if(this._allowSnappingToSourceVertices)continue;return-1}var j=this._seg.distance(o);j<this._snapTolerance&&j<d&&(d=j,_=w)}return _},Aa.prototype.setAllowSnappingToSourceVertices=function(o){this._allowSnappingToSourceVertices=o},Aa.prototype.interfaces_=function(){return[]},Aa.prototype.getClass=function(){return Aa},Aa.isClosed=function(o){return!(o.length<=1)&&o[0].equals2D(o[o.length-1])};var bi=function(o){this._srcGeom=o||null},$a={SNAP_PRECISION_FACTOR:{configurable:!0}};bi.prototype.snapTo=function(o,s){var d=this.extractTargetCoordinates(o);return new Ii(s,d).transform(this._srcGeom)},bi.prototype.snapToSelf=function(o,s){var d=this.extractTargetCoordinates(this._srcGeom),_=new Ii(o,d,!0).transform(this._srcGeom),w=_;return s&&Le(w,eu)&&(w=_.buffer(0)),w},bi.prototype.computeSnapTolerance=function(o){return this.computeMinimumSegmentLength(o)/10},bi.prototype.extractTargetCoordinates=function(o){for(var s=new Ve,d=o.getCoordinates(),_=0;_<d.length;_++)s.add(d[_]);return s.toArray(new Array(0).fill(null))},bi.prototype.computeMinimumSegmentLength=function(o){for(var s=ne.MAX_VALUE,d=0;d<o.length-1;d++){var _=o[d].distance(o[d+1]);_<s&&(s=_)}return s},bi.prototype.interfaces_=function(){return[]},bi.prototype.getClass=function(){return bi},bi.snap=function(o,s,d){var _=new Array(2).fill(null),w=new bi(o);_[0]=w.snapTo(s,d);var j=new bi(s);return _[1]=j.snapTo(_[0],d),_},bi.computeOverlaySnapTolerance=function(){if(arguments.length===1){var o=arguments[0],s=bi.computeSizeBasedSnapTolerance(o),d=o.getPrecisionModel();if(d.getType()===zi.FIXED){var _=1/d.getScale()*2/1.415;_>s&&(s=_)}return s}if(arguments.length===2){var w=arguments[0],j=arguments[1];return Math.min(bi.computeOverlaySnapTolerance(w),bi.computeOverlaySnapTolerance(j))}},bi.computeSizeBasedSnapTolerance=function(o){var s=o.getEnvelopeInternal();return Math.min(s.getHeight(),s.getWidth())*bi.SNAP_PRECISION_FACTOR},bi.snapToSelf=function(o,s,d){return new bi(o).snapToSelf(s,d)},$a.SNAP_PRECISION_FACTOR.get=function(){return 1e-9},Object.defineProperties(bi,$a);var Ii=function(o){function s(d,_,w){o.call(this),this._snapTolerance=d||null,this._snapPts=_||null,this._isSelfSnap=w!==void 0&&w}return o&&(s.__proto__=o),s.prototype=Object.create(o&&o.prototype),s.prototype.constructor=s,s.prototype.snapLine=function(d,_){var w=new Aa(d,this._snapTolerance);return w.setAllowSnappingToSourceVertices(this._isSelfSnap),w.snapTo(_)},s.prototype.transformCoordinates=function(d,_){var w=d.toCoordinateArray(),j=this.snapLine(w,this._snapPts);return this._factory.getCoordinateSequenceFactory().create(j)},s.prototype.interfaces_=function(){return[]},s.prototype.getClass=function(){return s},s}(oi),Hn=function(){this._isFirst=!0,this._commonMantissaBitsCount=53,this._commonBits=0,this._commonSignExp=null};Hn.prototype.getCommon=function(){return ne.longBitsToDouble(this._commonBits)},Hn.prototype.add=function(o){var s=ne.doubleToLongBits(o);if(this._isFirst)return this._commonBits=s,this._commonSignExp=Hn.signExpBits(this._commonBits),this._isFirst=!1,null;if(Hn.signExpBits(s)!==this._commonSignExp)return this._commonBits=0,null;this._commonMantissaBitsCount=Hn.numCommonMostSigMantissaBits(this._commonBits,s),this._commonBits=Hn.zeroLowerBits(this._commonBits,64-(12+this._commonMantissaBitsCount))},Hn.prototype.toString=function(){if(arguments.length===1){var o=arguments[0],s=ne.longBitsToDouble(o),d="0000000000000000000000000000000000000000000000000000000000000000"+ne.toBinaryString(o),_=d.substring(d.length-64);return _.substring(0,1)+"  "+_.substring(1,12)+"(exp) "+_.substring(12)+" [ "+s+" ]"}},Hn.prototype.interfaces_=function(){return[]},Hn.prototype.getClass=function(){return Hn},Hn.getBit=function(o,s){return o&1<<s?1:0},Hn.signExpBits=function(o){return o>>52},Hn.zeroLowerBits=function(o,s){return o&~((1<<s)-1)},Hn.numCommonMostSigMantissaBits=function(o,s){for(var d=0,_=52;_>=0;_--){if(Hn.getBit(o,_)!==Hn.getBit(s,_))return d;d++}return 52};var yi=function(){this._commonCoord=null,this._ccFilter=new _i},Yi={CommonCoordinateFilter:{configurable:!0},Translater:{configurable:!0}};yi.prototype.addCommonBits=function(o){var s=new di(this._commonCoord);o.apply(s),o.geometryChanged()},yi.prototype.removeCommonBits=function(o){if(this._commonCoord.x===0&&this._commonCoord.y===0)return o;var s=new Y(this._commonCoord);s.x=-s.x,s.y=-s.y;var d=new di(s);return o.apply(d),o.geometryChanged(),o},yi.prototype.getCommonCoordinate=function(){return this._commonCoord},yi.prototype.add=function(o){o.apply(this._ccFilter),this._commonCoord=this._ccFilter.getCommonCoordinate()},yi.prototype.interfaces_=function(){return[]},yi.prototype.getClass=function(){return yi},Yi.CommonCoordinateFilter.get=function(){return _i},Yi.Translater.get=function(){return di},Object.defineProperties(yi,Yi);var _i=function(){this._commonBitsX=new Hn,this._commonBitsY=new Hn};_i.prototype.filter=function(o){this._commonBitsX.add(o.x),this._commonBitsY.add(o.y)},_i.prototype.getCommonCoordinate=function(){return new Y(this._commonBitsX.getCommon(),this._commonBitsY.getCommon())},_i.prototype.interfaces_=function(){return[Dr]},_i.prototype.getClass=function(){return _i};var di=function(){this.trans=null;var o=arguments[0];this.trans=o};di.prototype.filter=function(o,s){var d=o.getOrdinate(s,0)+this.trans.x,_=o.getOrdinate(s,1)+this.trans.y;o.setOrdinate(s,0,d),o.setOrdinate(s,1,_)},di.prototype.isDone=function(){return!1},di.prototype.isGeometryChanged=function(){return!0},di.prototype.interfaces_=function(){return[es]},di.prototype.getClass=function(){return di};var wn=function(o,s){this._geom=new Array(2).fill(null),this._snapTolerance=null,this._cbr=null,this._geom[0]=o,this._geom[1]=s,this.computeSnapTolerance()};wn.prototype.selfSnap=function(o){return new bi(o).snapTo(o,this._snapTolerance)},wn.prototype.removeCommonBits=function(o){this._cbr=new yi,this._cbr.add(o[0]),this._cbr.add(o[1]);var s=new Array(2).fill(null);return s[0]=this._cbr.removeCommonBits(o[0].copy()),s[1]=this._cbr.removeCommonBits(o[1].copy()),s},wn.prototype.prepareResult=function(o){return this._cbr.addCommonBits(o),o},wn.prototype.getResultGeometry=function(o){var s=this.snap(this._geom),d=Fn.overlayOp(s[0],s[1],o);return this.prepareResult(d)},wn.prototype.checkValid=function(o){o.isValid()||Qr.out.println("Snapped geometry is invalid")},wn.prototype.computeSnapTolerance=function(){this._snapTolerance=bi.computeOverlaySnapTolerance(this._geom[0],this._geom[1])},wn.prototype.snap=function(o){var s=this.removeCommonBits(o);return bi.snap(s[0],s[1],this._snapTolerance)},wn.prototype.interfaces_=function(){return[]},wn.prototype.getClass=function(){return wn},wn.overlayOp=function(o,s,d){return new wn(o,s).getResultGeometry(d)},wn.union=function(o,s){return wn.overlayOp(o,s,Fn.UNION)},wn.intersection=function(o,s){return wn.overlayOp(o,s,Fn.INTERSECTION)},wn.symDifference=function(o,s){return wn.overlayOp(o,s,Fn.SYMDIFFERENCE)},wn.difference=function(o,s){return wn.overlayOp(o,s,Fn.DIFFERENCE)};var Wn=function(o,s){this._geom=new Array(2).fill(null),this._geom[0]=o,this._geom[1]=s};Wn.prototype.getResultGeometry=function(o){var s=null,d=!1,_=null;try{s=Fn.overlayOp(this._geom[0],this._geom[1],o),d=!0}catch(w){if(!(w instanceof ki))throw w;_=w}if(!d)try{s=wn.overlayOp(this._geom[0],this._geom[1],o)}catch(w){throw w instanceof ki?_:w}return s},Wn.prototype.interfaces_=function(){return[]},Wn.prototype.getClass=function(){return Wn},Wn.overlayOp=function(o,s,d){return new Wn(o,s).getResultGeometry(d)},Wn.union=function(o,s){return Wn.overlayOp(o,s,Fn.UNION)},Wn.intersection=function(o,s){return Wn.overlayOp(o,s,Fn.INTERSECTION)},Wn.symDifference=function(o,s){return Wn.overlayOp(o,s,Fn.SYMDIFFERENCE)},Wn.difference=function(o,s){return Wn.overlayOp(o,s,Fn.DIFFERENCE)};var Pi=function(){this.mce=null,this.chainIndex=null;var o=arguments[0],s=arguments[1];this.mce=o,this.chainIndex=s};Pi.prototype.computeIntersections=function(o,s){this.mce.computeIntersectsForChain(this.chainIndex,o.mce,o.chainIndex,s)},Pi.prototype.interfaces_=function(){return[]},Pi.prototype.getClass=function(){return Pi};var qn=function o(){if(this._label=null,this._xValue=null,this._eventType=null,this._insertEvent=null,this._deleteEventIndex=null,this._obj=null,arguments.length===2){var s=arguments[0],d=arguments[1];this._eventType=o.DELETE,this._xValue=s,this._insertEvent=d}else if(arguments.length===3){var _=arguments[0],w=arguments[1],j=arguments[2];this._eventType=o.INSERT,this._label=_,this._xValue=w,this._obj=j}},Ui={INSERT:{configurable:!0},DELETE:{configurable:!0}};qn.prototype.isDelete=function(){return this._eventType===qn.DELETE},qn.prototype.setDeleteEventIndex=function(o){this._deleteEventIndex=o},qn.prototype.getObject=function(){return this._obj},qn.prototype.compareTo=function(o){var s=o;return this._xValue<s._xValue?-1:this._xValue>s._xValue?1:this._eventType<s._eventType?-1:this._eventType>s._eventType?1:0},qn.prototype.getInsertEvent=function(){return this._insertEvent},qn.prototype.isInsert=function(){return this._eventType===qn.INSERT},qn.prototype.isSameLabel=function(o){return this._label!==null&&this._label===o._label},qn.prototype.getDeleteEventIndex=function(){return this._deleteEventIndex},qn.prototype.interfaces_=function(){return[he]},qn.prototype.getClass=function(){return qn},Ui.INSERT.get=function(){return 1},Ui.DELETE.get=function(){return 2},Object.defineProperties(qn,Ui);var Gi=function(){};Gi.prototype.interfaces_=function(){return[]},Gi.prototype.getClass=function(){return Gi};var Nn=function(){this._hasIntersection=!1,this._hasProper=!1,this._hasProperInterior=!1,this._properIntersectionPoint=null,this._li=null,this._includeProper=null,this._recordIsolated=null,this._isSelfIntersection=null,this._numIntersections=0,this.numTests=0,this._bdyNodes=null,this._isDone=!1,this._isDoneWhenProperInt=!1;var o=arguments[0],s=arguments[1],d=arguments[2];this._li=o,this._includeProper=s,this._recordIsolated=d};Nn.prototype.isTrivialIntersection=function(o,s,d,_){if(o===d&&this._li.getIntersectionNum()===1){if(Nn.isAdjacentSegments(s,_))return!0;if(o.isClosed()){var w=o.getNumPoints()-1;if(s===0&&_===w||_===0&&s===w)return!0}}return!1},Nn.prototype.getProperIntersectionPoint=function(){return this._properIntersectionPoint},Nn.prototype.setIsDoneIfProperInt=function(o){this._isDoneWhenProperInt=o},Nn.prototype.hasProperInteriorIntersection=function(){return this._hasProperInterior},Nn.prototype.isBoundaryPointInternal=function(o,s){for(var d=s.iterator();d.hasNext();){var _=d.next().getCoordinate();if(o.isIntersection(_))return!0}return!1},Nn.prototype.hasProperIntersection=function(){return this._hasProper},Nn.prototype.hasIntersection=function(){return this._hasIntersection},Nn.prototype.isDone=function(){return this._isDone},Nn.prototype.isBoundaryPoint=function(o,s){return s!==null&&(!!this.isBoundaryPointInternal(o,s[0])||!!this.isBoundaryPointInternal(o,s[1]))},Nn.prototype.setBoundaryNodes=function(o,s){this._bdyNodes=new Array(2).fill(null),this._bdyNodes[0]=o,this._bdyNodes[1]=s},Nn.prototype.addIntersections=function(o,s,d,_){if(o===d&&s===_)return null;this.numTests++;var w=o.getCoordinates()[s],j=o.getCoordinates()[s+1],ie=d.getCoordinates()[_],ke=d.getCoordinates()[_+1];this._li.computeIntersection(w,j,ie,ke),this._li.hasIntersection()&&(this._recordIsolated&&(o.setIsolated(!1),d.setIsolated(!1)),this._numIntersections++,this.isTrivialIntersection(o,s,d,_)||(this._hasIntersection=!0,!this._includeProper&&this._li.isProper()||(o.addIntersections(this._li,s,0),d.addIntersections(this._li,_,1)),this._li.isProper()&&(this._properIntersectionPoint=this._li.getIntersection(0).copy(),this._hasProper=!0,this._isDoneWhenProperInt&&(this._isDone=!0),this.isBoundaryPoint(this._li,this._bdyNodes)||(this._hasProperInterior=!0))))},Nn.prototype.interfaces_=function(){return[]},Nn.prototype.getClass=function(){return Nn},Nn.isAdjacentSegments=function(o,s){return Math.abs(o-s)===1};var Wi=function(o){function s(){o.call(this),this.events=new Gr,this.nOverlaps=null}return o&&(s.__proto__=o),s.prototype=Object.create(o&&o.prototype),s.prototype.constructor=s,s.prototype.prepareEvents=function(){Ha.sort(this.events);for(var d=0;d<this.events.size();d++){var _=this.events.get(d);_.isDelete()&&_.getInsertEvent().setDeleteEventIndex(d)}},s.prototype.computeIntersections=function(){if(arguments.length===1){var d=arguments[0];this.nOverlaps=0,this.prepareEvents();for(var _=0;_<this.events.size();_++){var w=this.events.get(_);if(w.isInsert()&&this.processOverlaps(_,w.getDeleteEventIndex(),w,d),d.isDone())break}}else if(arguments.length===3){if(arguments[2]instanceof Nn&&Le(arguments[0],Oa)&&Le(arguments[1],Oa)){var j=arguments[0],ie=arguments[1],ke=arguments[2];this.addEdges(j,j),this.addEdges(ie,ie),this.computeIntersections(ke)}else if(typeof arguments[2]=="boolean"&&Le(arguments[0],Oa)&&arguments[1]instanceof Nn){var tt=arguments[0],Pt=arguments[1];arguments[2]?this.addEdges(tt,null):this.addEdges(tt),this.computeIntersections(Pt)}}},s.prototype.addEdge=function(d,_){for(var w=d.getMonotoneChainEdge(),j=w.getStartIndexes(),ie=0;ie<j.length-1;ie++){var ke=new Pi(w,ie),tt=new qn(_,w.getMinX(ie),ke);this.events.add(tt),this.events.add(new qn(w.getMaxX(ie),tt))}},s.prototype.processOverlaps=function(d,_,w,j){for(var ie=w.getObject(),ke=d;ke<_;ke++){var tt=this.events.get(ke);if(tt.isInsert()){var Pt=tt.getObject();w.isSameLabel(tt)||(ie.computeIntersections(Pt,j),this.nOverlaps++)}}},s.prototype.addEdges=function(){if(arguments.length===1)for(var d=arguments[0].iterator();d.hasNext();){var _=d.next();this.addEdge(_,_)}else if(arguments.length===2)for(var w=arguments[0],j=arguments[1],ie=w.iterator();ie.hasNext();){var ke=ie.next();this.addEdge(ke,j)}},s.prototype.interfaces_=function(){return[]},s.prototype.getClass=function(){return s},s}(Gi),$n=function(){this._min=ne.POSITIVE_INFINITY,this._max=ne.NEGATIVE_INFINITY},Li={NodeComparator:{configurable:!0}};$n.prototype.getMin=function(){return this._min},$n.prototype.intersects=function(o,s){return!(this._min>s||this._max<o)},$n.prototype.getMax=function(){return this._max},$n.prototype.toString=function(){return yn.toLineString(new Y(this._min,0),new Y(this._max,0))},$n.prototype.interfaces_=function(){return[]},$n.prototype.getClass=function(){return $n},Li.NodeComparator.get=function(){return Oi},Object.defineProperties($n,Li);var Oi=function(){};Oi.prototype.compare=function(o,s){var d=o,_=s,w=(d._min+d._max)/2,j=(_._min+_._max)/2;return w<j?-1:w>j?1:0},Oi.prototype.interfaces_=function(){return[te]},Oi.prototype.getClass=function(){return Oi};var Qi=function(o){function s(){o.call(this),this._item=null;var d=arguments[0],_=arguments[1],w=arguments[2];this._min=d,this._max=_,this._item=w}return o&&(s.__proto__=o),s.prototype=Object.create(o&&o.prototype),s.prototype.constructor=s,s.prototype.query=function(d,_,w){if(!this.intersects(d,_))return null;w.visitItem(this._item)},s.prototype.interfaces_=function(){return[]},s.prototype.getClass=function(){return s},s}($n),qi=function(o){function s(){o.call(this),this._node1=null,this._node2=null;var d=arguments[0],_=arguments[1];this._node1=d,this._node2=_,this.buildExtent(this._node1,this._node2)}return o&&(s.__proto__=o),s.prototype=Object.create(o&&o.prototype),s.prototype.constructor=s,s.prototype.buildExtent=function(d,_){this._min=Math.min(d._min,_._min),this._max=Math.max(d._max,_._max)},s.prototype.query=function(d,_,w){if(!this.intersects(d,_))return null;this._node1!==null&&this._node1.query(d,_,w),this._node2!==null&&this._node2.query(d,_,w)},s.prototype.interfaces_=function(){return[]},s.prototype.getClass=function(){return s},s}($n),hi=function(){this._leaves=new Gr,this._root=null,this._level=0};hi.prototype.buildTree=function(){Ha.sort(this._leaves,new $n.NodeComparator);for(var o=this._leaves,s=null,d=new Gr;;){if(this.buildLevel(o,d),d.size()===1)return d.get(0);s=o,o=d,d=s}},hi.prototype.insert=function(o,s,d){if(this._root!==null)throw new Error("Index cannot be added to once it has been queried");this._leaves.add(new Qi(o,s,d))},hi.prototype.query=function(o,s,d){this.init(),this._root.query(o,s,d)},hi.prototype.buildRoot=function(){if(this._root!==null)return null;this._root=this.buildTree()},hi.prototype.printNode=function(o){Qr.out.println(yn.toLineString(new Y(o._min,this._level),new Y(o._max,this._level)))},hi.prototype.init=function(){if(this._root!==null)return null;this.buildRoot()},hi.prototype.buildLevel=function(o,s){this._level++,s.clear();for(var d=0;d<o.size();d+=2){var _=o.get(d);if((d+1<o.size()?o.get(d):null)===null)s.add(_);else{var w=new qi(o.get(d),o.get(d+1));s.add(w)}}},hi.prototype.interfaces_=function(){return[]},hi.prototype.getClass=function(){return hi};var Si=function(){this._items=new Gr};Si.prototype.visitItem=function(o){this._items.add(o)},Si.prototype.getItems=function(){return this._items},Si.prototype.interfaces_=function(){return[fu]},Si.prototype.getClass=function(){return Si};var Ci=function(){this._index=null;var o=arguments[0];if(!Le(o,eu))throw new we("Argument must be Polygonal");this._index=new wu(o)},ji={SegmentVisitor:{configurable:!0},IntervalIndexedGeometry:{configurable:!0}};Ci.prototype.locate=function(o){var s=new It(o),d=new li(s);return this._index.query(o.y,o.y,d),s.getLocation()},Ci.prototype.interfaces_=function(){return[iu]},Ci.prototype.getClass=function(){return Ci},ji.SegmentVisitor.get=function(){return li},ji.IntervalIndexedGeometry.get=function(){return wu},Object.defineProperties(Ci,ji);var li=function(){this._counter=null;var o=arguments[0];this._counter=o};li.prototype.visitItem=function(o){var s=o;this._counter.countSegment(s.getCoordinate(0),s.getCoordinate(1))},li.prototype.interfaces_=function(){return[fu]},li.prototype.getClass=function(){return li};var wu=function(){this._index=new hi;var o=arguments[0];this.init(o)};wu.prototype.init=function(o){for(var s=_o.getLines(o).iterator();s.hasNext();){var d=s.next().getCoordinates();this.addLine(d)}},wu.prototype.addLine=function(o){for(var s=1;s<o.length;s++){var d=new Sn(o[s-1],o[s]),_=Math.min(d.p0.y,d.p1.y),w=Math.max(d.p0.y,d.p1.y);this._index.insert(_,w,d)}},wu.prototype.query=function(){if(arguments.length===2){var o=arguments[0],s=arguments[1],d=new Si;return this._index.query(o,s,d),d.getItems()}if(arguments.length===3){var _=arguments[0],w=arguments[1],j=arguments[2];this._index.query(_,w,j)}},wu.prototype.interfaces_=function(){return[]},wu.prototype.getClass=function(){return wu};var Qo=function(o){function s(){if(o.call(this),this._parentGeom=null,this._lineEdgeMap=new Pl,this._boundaryNodeRule=null,this._useBoundaryDeterminationRule=!0,this._argIndex=null,this._boundaryNodes=null,this._hasTooFewPoints=!1,this._invalidPoint=null,this._areaPtLocator=null,this._ptLocator=new Cu,arguments.length===2){var d=arguments[0],_=arguments[1],w=Yr.OGC_SFS_BOUNDARY_RULE;this._argIndex=d,this._parentGeom=_,this._boundaryNodeRule=w,_!==null&&this.add(_)}else if(arguments.length===3){var j=arguments[0],ie=arguments[1],ke=arguments[2];this._argIndex=j,this._parentGeom=ie,this._boundaryNodeRule=ke,ie!==null&&this.add(ie)}}return o&&(s.__proto__=o),s.prototype=Object.create(o&&o.prototype),s.prototype.constructor=s,s.prototype.insertBoundaryPoint=function(d,_){var w=this._nodes.addNode(_).getLabel(),j=1;_e.NONE,w.getLocation(d,Ae.ON)===_e.BOUNDARY&&j++;var ie=s.determineBoundary(this._boundaryNodeRule,j);w.setLocation(d,ie)},s.prototype.computeSelfNodes=function(){if(arguments.length===2){var d=arguments[0],_=arguments[1];return this.computeSelfNodes(d,_,!1)}if(arguments.length===3){var w=arguments[0],j=arguments[1],ie=arguments[2],ke=new Nn(w,!0,!1);ke.setIsDoneIfProperInt(ie);var tt=this.createEdgeSetIntersector(),Pt=this._parentGeom instanceof pr||this._parentGeom instanceof wa||this._parentGeom instanceof vn,tr=j||!Pt;return tt.computeIntersections(this._edges,ke,tr),this.addSelfIntersectionNodes(this._argIndex),ke}},s.prototype.computeSplitEdges=function(d){for(var _=this._edges.iterator();_.hasNext();)_.next().eiList.addSplitEdges(d)},s.prototype.computeEdgeIntersections=function(d,_,w){var j=new Nn(_,w,!0);return j.setBoundaryNodes(this.getBoundaryNodes(),d.getBoundaryNodes()),this.createEdgeSetIntersector().computeIntersections(this._edges,d._edges,j),j},s.prototype.getGeometry=function(){return this._parentGeom},s.prototype.getBoundaryNodeRule=function(){return this._boundaryNodeRule},s.prototype.hasTooFewPoints=function(){return this._hasTooFewPoints},s.prototype.addPoint=function(){if(arguments[0]instanceof uo){var d=arguments[0].getCoordinate();this.insertPoint(this._argIndex,d,_e.INTERIOR)}else if(arguments[0]instanceof Y){var _=arguments[0];this.insertPoint(this._argIndex,_,_e.INTERIOR)}},s.prototype.addPolygon=function(d){this.addPolygonRing(d.getExteriorRing(),_e.EXTERIOR,_e.INTERIOR);for(var _=0;_<d.getNumInteriorRing();_++){var w=d.getInteriorRingN(_);this.addPolygonRing(w,_e.INTERIOR,_e.EXTERIOR)}},s.prototype.addEdge=function(d){this.insertEdge(d);var _=d.getCoordinates();this.insertPoint(this._argIndex,_[0],_e.BOUNDARY),this.insertPoint(this._argIndex,_[_.length-1],_e.BOUNDARY)},s.prototype.addLineString=function(d){var _=_n.removeRepeatedPoints(d.getCoordinates());if(_.length<2)return this._hasTooFewPoints=!0,this._invalidPoint=_[0],null;var w=new Dl(_,new Mn(this._argIndex,_e.INTERIOR));this._lineEdgeMap.put(d,w),this.insertEdge(w),Lt.isTrue(_.length>=2,"found LineString with single point"),this.insertBoundaryPoint(this._argIndex,_[0]),this.insertBoundaryPoint(this._argIndex,_[_.length-1])},s.prototype.getInvalidPoint=function(){return this._invalidPoint},s.prototype.getBoundaryPoints=function(){for(var d=this.getBoundaryNodes(),_=new Array(d.size()).fill(null),w=0,j=d.iterator();j.hasNext();){var ie=j.next();_[w++]=ie.getCoordinate().copy()}return _},s.prototype.getBoundaryNodes=function(){return this._boundaryNodes===null&&(this._boundaryNodes=this._nodes.getBoundaryNodes(this._argIndex)),this._boundaryNodes},s.prototype.addSelfIntersectionNode=function(d,_,w){if(this.isBoundaryNode(d,_))return null;w===_e.BOUNDARY&&this._useBoundaryDeterminationRule?this.insertBoundaryPoint(d,_):this.insertPoint(d,_,w)},s.prototype.addPolygonRing=function(d,_,w){if(d.isEmpty())return null;var j=_n.removeRepeatedPoints(d.getCoordinates());if(j.length<4)return this._hasTooFewPoints=!0,this._invalidPoint=j[0],null;var ie=_,ke=w;wt.isCCW(j)&&(ie=w,ke=_);var tt=new Dl(j,new Mn(this._argIndex,_e.BOUNDARY,ie,ke));this._lineEdgeMap.put(d,tt),this.insertEdge(tt),this.insertPoint(this._argIndex,j[0],_e.BOUNDARY)},s.prototype.insertPoint=function(d,_,w){var j=this._nodes.addNode(_),ie=j.getLabel();ie===null?j._label=new Mn(d,w):ie.setLocation(d,w)},s.prototype.createEdgeSetIntersector=function(){return new Wi},s.prototype.addSelfIntersectionNodes=function(d){for(var _=this._edges.iterator();_.hasNext();)for(var w=_.next(),j=w.getLabel().getLocation(d),ie=w.eiList.iterator();ie.hasNext();){var ke=ie.next();this.addSelfIntersectionNode(d,ke.coord,j)}},s.prototype.add=function(){if(arguments.length!==1)return o.prototype.add.apply(this,arguments);var d=arguments[0];if(d.isEmpty())return null;if(d instanceof vn&&(this._useBoundaryDeterminationRule=!1),d instanceof wa)this.addPolygon(d);else if(d instanceof xa)this.addLineString(d);else if(d instanceof uo)this.addPoint(d);else if(d instanceof lu)this.addCollection(d);else if(d instanceof Ni)this.addCollection(d);else if(d instanceof vn)this.addCollection(d);else{if(!(d instanceof Lo))throw new Error(d.getClass().getName());this.addCollection(d)}},s.prototype.addCollection=function(d){for(var _=0;_<d.getNumGeometries();_++){var w=d.getGeometryN(_);this.add(w)}},s.prototype.locate=function(d){return Le(this._parentGeom,eu)&&this._parentGeom.getNumGeometries()>50?(this._areaPtLocator===null&&(this._areaPtLocator=new Ci(this._parentGeom)),this._areaPtLocator.locate(d)):this._ptLocator.locate(d,this._parentGeom)},s.prototype.findEdge=function(){if(arguments.length===1){var d=arguments[0];return this._lineEdgeMap.get(d)}return o.prototype.findEdge.apply(this,arguments)},s.prototype.interfaces_=function(){return[]},s.prototype.getClass=function(){return s},s.determineBoundary=function(d,_){return d.isInBoundary(_)?_e.BOUNDARY:_e.INTERIOR},s}(Ta),nl=function(){if(this._li=new $e,this._resultPrecisionModel=null,this._arg=null,arguments.length===1){var o=arguments[0];this.setComputationPrecision(o.getPrecisionModel()),this._arg=new Array(1).fill(null),this._arg[0]=new Qo(0,o)}else if(arguments.length===2){var s=arguments[0],d=arguments[1],_=Yr.OGC_SFS_BOUNDARY_RULE;s.getPrecisionModel().compareTo(d.getPrecisionModel())>=0?this.setComputationPrecision(s.getPrecisionModel()):this.setComputationPrecision(d.getPrecisionModel()),this._arg=new Array(2).fill(null),this._arg[0]=new Qo(0,s,_),this._arg[1]=new Qo(1,d,_)}else if(arguments.length===3){var w=arguments[0],j=arguments[1],ie=arguments[2];w.getPrecisionModel().compareTo(j.getPrecisionModel())>=0?this.setComputationPrecision(w.getPrecisionModel()):this.setComputationPrecision(j.getPrecisionModel()),this._arg=new Array(2).fill(null),this._arg[0]=new Qo(0,w,ie),this._arg[1]=new Qo(1,j,ie)}};nl.prototype.getArgGeometry=function(o){return this._arg[o].getGeometry()},nl.prototype.setComputationPrecision=function(o){this._resultPrecisionModel=o,this._li.setPrecisionModel(this._resultPrecisionModel)},nl.prototype.interfaces_=function(){return[]},nl.prototype.getClass=function(){return nl};var Zu=function(){};Zu.prototype.interfaces_=function(){return[]},Zu.prototype.getClass=function(){return Zu},Zu.map=function(){if(arguments[0]instanceof Tt&&Le(arguments[1],Zu.MapOp)){for(var o=arguments[0],s=arguments[1],d=new Gr,_=0;_<o.getNumGeometries();_++){var w=s.map(o.getGeometryN(_));w!==null&&d.add(w)}return o.getFactory().buildGeometry(d)}if(Le(arguments[0],fi)&&Le(arguments[1],Zu.MapOp)){for(var j=arguments[0],ie=arguments[1],ke=new Gr,tt=j.iterator();tt.hasNext();){var Pt=tt.next(),tr=ie.map(Pt);tr!==null&&ke.add(tr)}return ke}},Zu.MapOp=function(){};var Fn=function(o){function s(){var d=arguments[0],_=arguments[1];o.call(this,d,_),this._ptLocator=new Cu,this._geomFact=null,this._resultGeom=null,this._graph=null,this._edgeList=new Bo,this._resultPolyList=new Gr,this._resultLineList=new Gr,this._resultPointList=new Gr,this._graph=new Ta(new rc),this._geomFact=d.getFactory()}return o&&(s.__proto__=o),s.prototype=Object.create(o&&o.prototype),s.prototype.constructor=s,s.prototype.insertUniqueEdge=function(d){var _=this._edgeList.findEqualEdge(d);if(_!==null){var w=_.getLabel(),j=d.getLabel();_.isPointwiseEqual(d)||(j=new Mn(d.getLabel())).flip();var ie=_.getDepth();ie.isNull()&&ie.add(w),ie.add(j),w.merge(j)}else this._edgeList.add(d)},s.prototype.getGraph=function(){return this._graph},s.prototype.cancelDuplicateResultEdges=function(){for(var d=this._graph.getEdgeEnds().iterator();d.hasNext();){var _=d.next(),w=_.getSym();_.isInResult()&&w.isInResult()&&(_.setInResult(!1),w.setInResult(!1))}},s.prototype.isCoveredByLA=function(d){return!!this.isCovered(d,this._resultLineList)||!!this.isCovered(d,this._resultPolyList)},s.prototype.computeGeometry=function(d,_,w,j){var ie=new Gr;return ie.addAll(d),ie.addAll(_),ie.addAll(w),ie.isEmpty()?s.createEmptyResult(j,this._arg[0].getGeometry(),this._arg[1].getGeometry(),this._geomFact):this._geomFact.buildGeometry(ie)},s.prototype.mergeSymLabels=function(){for(var d=this._graph.getNodes().iterator();d.hasNext();)d.next().getEdges().mergeSymLabels()},s.prototype.isCovered=function(d,_){for(var w=_.iterator();w.hasNext();){var j=w.next();if(this._ptLocator.locate(d,j)!==_e.EXTERIOR)return!0}return!1},s.prototype.replaceCollapsedEdges=function(){for(var d=new Gr,_=this._edgeList.iterator();_.hasNext();){var w=_.next();w.isCollapsed()&&(_.remove(),d.add(w.getCollapsedEdge()))}this._edgeList.addAll(d)},s.prototype.updateNodeLabelling=function(){for(var d=this._graph.getNodes().iterator();d.hasNext();){var _=d.next(),w=_.getEdges().getLabel();_.getLabel().merge(w)}},s.prototype.getResultGeometry=function(d){return this.computeOverlay(d),this._resultGeom},s.prototype.insertUniqueEdges=function(d){for(var _=d.iterator();_.hasNext();){var w=_.next();this.insertUniqueEdge(w)}},s.prototype.computeOverlay=function(d){this.copyPoints(0),this.copyPoints(1),this._arg[0].computeSelfNodes(this._li,!1),this._arg[1].computeSelfNodes(this._li,!1),this._arg[0].computeEdgeIntersections(this._arg[1],this._li,!0);var _=new Gr;this._arg[0].computeSplitEdges(_),this._arg[1].computeSplitEdges(_),this.insertUniqueEdges(_),this.computeLabelsFromDepths(),this.replaceCollapsedEdges(),it.checkValid(this._edgeList.getEdges()),this._graph.addEdges(this._edgeList.getEdges()),this.computeLabelling(),this.labelIncompleteNodes(),this.findResultAreaEdges(d),this.cancelDuplicateResultEdges();var w=new In(this._geomFact);w.add(this._graph),this._resultPolyList=w.getPolygons();var j=new ha(this,this._geomFact,this._ptLocator);this._resultLineList=j.build(d);var ie=new Ys(this,this._geomFact,this._ptLocator);this._resultPointList=ie.build(d),this._resultGeom=this.computeGeometry(this._resultPointList,this._resultLineList,this._resultPolyList,d)},s.prototype.labelIncompleteNode=function(d,_){var w=this._ptLocator.locate(d.getCoordinate(),this._arg[_].getGeometry());d.getLabel().setLocation(_,w)},s.prototype.copyPoints=function(d){for(var _=this._arg[d].getNodeIterator();_.hasNext();){var w=_.next();this._graph.addNode(w.getCoordinate()).setLabel(d,w.getLabel().getLocation(d))}},s.prototype.findResultAreaEdges=function(d){for(var _=this._graph.getEdgeEnds().iterator();_.hasNext();){var w=_.next(),j=w.getLabel();j.isArea()&&!w.isInteriorAreaEdge()&&s.isResultOfOp(j.getLocation(0,Ae.RIGHT),j.getLocation(1,Ae.RIGHT),d)&&w.setInResult(!0)}},s.prototype.computeLabelsFromDepths=function(){for(var d=this._edgeList.iterator();d.hasNext();){var _=d.next(),w=_.getLabel(),j=_.getDepth();if(!j.isNull()){j.normalize();for(var ie=0;ie<2;ie++)w.isNull(ie)||!w.isArea()||j.isNull(ie)||(j.getDelta(ie)===0?w.toLine(ie):(Lt.isTrue(!j.isNull(ie,Ae.LEFT),"depth of LEFT side has not been initialized"),w.setLocation(ie,Ae.LEFT,j.getLocation(ie,Ae.LEFT)),Lt.isTrue(!j.isNull(ie,Ae.RIGHT),"depth of RIGHT side has not been initialized"),w.setLocation(ie,Ae.RIGHT,j.getLocation(ie,Ae.RIGHT))))}}},s.prototype.computeLabelling=function(){for(var d=this._graph.getNodes().iterator();d.hasNext();)d.next().getEdges().computeLabelling(this._arg);this.mergeSymLabels(),this.updateNodeLabelling()},s.prototype.labelIncompleteNodes=function(){for(var d=this._graph.getNodes().iterator();d.hasNext();){var _=d.next(),w=_.getLabel();_.isIsolated()&&(w.isNull(0)?this.labelIncompleteNode(_,0):this.labelIncompleteNode(_,1)),_.getEdges().updateLabelling(w)}},s.prototype.isCoveredByA=function(d){return!!this.isCovered(d,this._resultPolyList)},s.prototype.interfaces_=function(){return[]},s.prototype.getClass=function(){return s},s}(nl);Fn.overlayOp=function(o,s,d){return new Fn(o,s).getResultGeometry(d)},Fn.intersection=function(o,s){if(o.isEmpty()||s.isEmpty())return Fn.createEmptyResult(Fn.INTERSECTION,o,s,o.getFactory());if(o.isGeometryCollection()){var d=s;return rl.map(o,{interfaces_:function(){return[Zu.MapOp]},map:function(_){return _.intersection(d)}})}return o.checkNotGeometryCollection(o),o.checkNotGeometryCollection(s),Wn.overlayOp(o,s,Fn.INTERSECTION)},Fn.symDifference=function(o,s){if(o.isEmpty()||s.isEmpty()){if(o.isEmpty()&&s.isEmpty())return Fn.createEmptyResult(Fn.SYMDIFFERENCE,o,s,o.getFactory());if(o.isEmpty())return s.copy();if(s.isEmpty())return o.copy()}return o.checkNotGeometryCollection(o),o.checkNotGeometryCollection(s),Wn.overlayOp(o,s,Fn.SYMDIFFERENCE)},Fn.resultDimension=function(o,s,d){var _=s.getDimension(),w=d.getDimension(),j=-1;switch(o){case Fn.INTERSECTION:j=Math.min(_,w);break;case Fn.UNION:j=Math.max(_,w);break;case Fn.DIFFERENCE:j=_;break;case Fn.SYMDIFFERENCE:j=Math.max(_,w)}return j},Fn.createEmptyResult=function(o,s,d,_){var w=null;switch(Fn.resultDimension(o,s,d)){case-1:w=_.createGeometryCollection(new Array(0).fill(null));break;case 0:w=_.createPoint();break;case 1:w=_.createLineString();break;case 2:w=_.createPolygon()}return w},Fn.difference=function(o,s){return o.isEmpty()?Fn.createEmptyResult(Fn.DIFFERENCE,o,s,o.getFactory()):s.isEmpty()?o.copy():(o.checkNotGeometryCollection(o),o.checkNotGeometryCollection(s),Wn.overlayOp(o,s,Fn.DIFFERENCE))},Fn.isResultOfOp=function(){if(arguments.length===2){var o=arguments[0],s=arguments[1],d=o.getLocation(0),_=o.getLocation(1);return Fn.isResultOfOp(d,_,s)}if(arguments.length===3){var w=arguments[0],j=arguments[1],ie=arguments[2];switch(w===_e.BOUNDARY&&(w=_e.INTERIOR),j===_e.BOUNDARY&&(j=_e.INTERIOR),ie){case Fn.INTERSECTION:return w===_e.INTERIOR&&j===_e.INTERIOR;case Fn.UNION:return w===_e.INTERIOR||j===_e.INTERIOR;case Fn.DIFFERENCE:return w===_e.INTERIOR&&j!==_e.INTERIOR;case Fn.SYMDIFFERENCE:return w===_e.INTERIOR&&j!==_e.INTERIOR||w!==_e.INTERIOR&&j===_e.INTERIOR}return!1}},Fn.INTERSECTION=1,Fn.UNION=2,Fn.DIFFERENCE=3,Fn.SYMDIFFERENCE=4;var qo=function(){this._g=null,this._boundaryDistanceTolerance=null,this._linework=null,this._ptLocator=new Cu,this._seg=new Sn;var o=arguments[0],s=arguments[1];this._g=o,this._boundaryDistanceTolerance=s,this._linework=this.extractLinework(o)};qo.prototype.isWithinToleranceOfBoundary=function(o){for(var s=0;s<this._linework.getNumGeometries();s++)for(var d=this._linework.getGeometryN(s).getCoordinateSequence(),_=0;_<d.size()-1;_++)if(d.getCoordinate(_,this._seg.p0),d.getCoordinate(_+1,this._seg.p1),this._seg.distance(o)<=this._boundaryDistanceTolerance)return!0;return!1},qo.prototype.getLocation=function(o){return this.isWithinToleranceOfBoundary(o)?_e.BOUNDARY:this._ptLocator.locate(o,this._g)},qo.prototype.extractLinework=function(o){var s=new Ws;o.apply(s);var d=s.getLinework(),_=Ai.toLineStringArray(d);return o.getFactory().createMultiLineString(_)},qo.prototype.interfaces_=function(){return[]},qo.prototype.getClass=function(){return qo};var Ws=function(){this._linework=null,this._linework=new Gr};Ws.prototype.getLinework=function(){return this._linework},Ws.prototype.filter=function(o){if(o instanceof wa){var s=o;this._linework.add(s.getExteriorRing());for(var d=0;d<s.getNumInteriorRing();d++)this._linework.add(s.getInteriorRingN(d))}},Ws.prototype.interfaces_=function(){return[no]},Ws.prototype.getClass=function(){return Ws};var du=function(){this._g=null,this._doLeft=!0,this._doRight=!0;var o=arguments[0];this._g=o};du.prototype.extractPoints=function(o,s,d){for(var _=o.getCoordinates(),w=0;w<_.length-1;w++)this.computeOffsetPoints(_[w],_[w+1],s,d)},du.prototype.setSidesToGenerate=function(o,s){this._doLeft=o,this._doRight=s},du.prototype.getPoints=function(o){for(var s=new Gr,d=_o.getLines(this._g).iterator();d.hasNext();){var _=d.next();this.extractPoints(_,o,s)}return s},du.prototype.computeOffsetPoints=function(o,s,d,_){var w=s.x-o.x,j=s.y-o.y,ie=Math.sqrt(w*w+j*j),ke=d*w/ie,tt=d*j/ie,Pt=(s.x+o.x)/2,tr=(s.y+o.y)/2;if(this._doLeft){var st=new Y(Pt-tt,tr+ke);_.add(st)}if(this._doRight){var Zt=new Y(Pt+tt,tr-ke);_.add(Zt)}},du.prototype.interfaces_=function(){return[]},du.prototype.getClass=function(){return du};var vs=function o(){this._geom=null,this._locFinder=null,this._location=new Array(3).fill(null),this._invalidLocation=null,this._boundaryDistanceTolerance=o.TOLERANCE,this._testCoords=new Gr;var s=arguments[0],d=arguments[1],_=arguments[2];this._boundaryDistanceTolerance=o.computeBoundaryDistanceTolerance(s,d),this._geom=[s,d,_],this._locFinder=[new qo(this._geom[0],this._boundaryDistanceTolerance),new qo(this._geom[1],this._boundaryDistanceTolerance),new qo(this._geom[2],this._boundaryDistanceTolerance)]},bl={TOLERANCE:{configurable:!0}};vs.prototype.reportResult=function(o,s,d){Qr.out.println("Overlay result invalid - A:"+_e.toLocationSymbol(s[0])+" B:"+_e.toLocationSymbol(s[1])+" expected:"+(d?"i":"e")+" actual:"+_e.toLocationSymbol(s[2]))},vs.prototype.isValid=function(o){this.addTestPts(this._geom[0]),this.addTestPts(this._geom[1]);var s=this.checkValid(o);return s},vs.prototype.checkValid=function(){if(arguments.length===1){for(var o=arguments[0],s=0;s<this._testCoords.size();s++){var d=this._testCoords.get(s);if(!this.checkValid(o,d))return this._invalidLocation=d,!1}return!0}if(arguments.length===2){var _=arguments[0],w=arguments[1];return this._location[0]=this._locFinder[0].getLocation(w),this._location[1]=this._locFinder[1].getLocation(w),this._location[2]=this._locFinder[2].getLocation(w),!!vs.hasLocation(this._location,_e.BOUNDARY)||this.isValidResult(_,this._location)}},vs.prototype.addTestPts=function(o){var s=new du(o);this._testCoords.addAll(s.getPoints(5*this._boundaryDistanceTolerance))},vs.prototype.isValidResult=function(o,s){var d=Fn.isResultOfOp(s[0],s[1],o),_=!(d^s[2]===_e.INTERIOR);return _||this.reportResult(o,s,d),_},vs.prototype.getInvalidLocation=function(){return this._invalidLocation},vs.prototype.interfaces_=function(){return[]},vs.prototype.getClass=function(){return vs},vs.hasLocation=function(o,s){for(var d=0;d<3;d++)if(o[d]===s)return!0;return!1},vs.computeBoundaryDistanceTolerance=function(o,s){return Math.min(bi.computeSizeBasedSnapTolerance(o),bi.computeSizeBasedSnapTolerance(s))},vs.isValid=function(o,s,d,_){return new vs(o,s,_).isValid(d)},bl.TOLERANCE.get=function(){return 1e-6},Object.defineProperties(vs,bl);var gs=function o(s){this._geomFactory=null,this._skipEmpty=!1,this._inputGeoms=null,this._geomFactory=o.extractFactory(s),this._inputGeoms=s};gs.prototype.extractElements=function(o,s){if(o===null)return null;for(var d=0;d<o.getNumGeometries();d++){var _=o.getGeometryN(d);this._skipEmpty&&_.isEmpty()||s.add(_)}},gs.prototype.combine=function(){for(var o=new Gr,s=this._inputGeoms.iterator();s.hasNext();){var d=s.next();this.extractElements(d,o)}return o.size()===0?this._geomFactory!==null?this._geomFactory.createGeometryCollection(null):null:this._geomFactory.buildGeometry(o)},gs.prototype.interfaces_=function(){return[]},gs.prototype.getClass=function(){return gs},gs.combine=function(){if(arguments.length===1){var o=arguments[0];return new gs(o).combine()}if(arguments.length===2){var s=arguments[0],d=arguments[1];return new gs(gs.createList(s,d)).combine()}if(arguments.length===3){var _=arguments[0],w=arguments[1],j=arguments[2];return new gs(gs.createList(_,w,j)).combine()}},gs.extractFactory=function(o){return o.isEmpty()?null:o.iterator().next().getFactory()},gs.createList=function(){if(arguments.length===2){var o=arguments[0],s=arguments[1],d=new Gr;return d.add(o),d.add(s),d}if(arguments.length===3){var _=arguments[0],w=arguments[1],j=arguments[2],ie=new Gr;return ie.add(_),ie.add(w),ie.add(j),ie}};var Da=function(){this._inputPolys=null,this._geomFactory=null;var o=arguments[0];this._inputPolys=o,this._inputPolys===null&&(this._inputPolys=new Gr)},il={STRTREE_NODE_CAPACITY:{configurable:!0}};Da.prototype.reduceToGeometries=function(o){for(var s=new Gr,d=o.iterator();d.hasNext();){var _=d.next(),w=null;Le(_,Oa)?w=this.unionTree(_):_ instanceof Tt&&(w=_),s.add(w)}return s},Da.prototype.extractByEnvelope=function(o,s,d){for(var _=new Gr,w=0;w<s.getNumGeometries();w++){var j=s.getGeometryN(w);j.getEnvelopeInternal().intersects(o)?_.add(j):d.add(j)}return this._geomFactory.buildGeometry(_)},Da.prototype.unionOptimized=function(o,s){var d=o.getEnvelopeInternal(),_=s.getEnvelopeInternal();if(!d.intersects(_))return gs.combine(o,s);if(o.getNumGeometries()<=1&&s.getNumGeometries()<=1)return this.unionActual(o,s);var w=d.intersection(_);return this.unionUsingEnvelopeIntersection(o,s,w)},Da.prototype.union=function(){if(this._inputPolys===null)throw new Error("union() method cannot be called twice");if(this._inputPolys.isEmpty())return null;this._geomFactory=this._inputPolys.iterator().next().getFactory();for(var o=new qc(Da.STRTREE_NODE_CAPACITY),s=this._inputPolys.iterator();s.hasNext();){var d=s.next();o.insert(d.getEnvelopeInternal(),d)}this._inputPolys=null;var _=o.itemsTree();return this.unionTree(_)},Da.prototype.binaryUnion=function(){if(arguments.length===1){var o=arguments[0];return this.binaryUnion(o,0,o.size())}if(arguments.length===3){var s=arguments[0],d=arguments[1],_=arguments[2];if(_-d<=1){var w=Da.getGeometry(s,d);return this.unionSafe(w,null)}if(_-d==2)return this.unionSafe(Da.getGeometry(s,d),Da.getGeometry(s,d+1));var j=Math.trunc((_+d)/2),ie=this.binaryUnion(s,d,j),ke=this.binaryUnion(s,j,_);return this.unionSafe(ie,ke)}},Da.prototype.repeatedUnion=function(o){for(var s=null,d=o.iterator();d.hasNext();){var _=d.next();s=s===null?_.copy():s.union(_)}return s},Da.prototype.unionSafe=function(o,s){return o===null&&s===null?null:o===null?s.copy():s===null?o.copy():this.unionOptimized(o,s)},Da.prototype.unionActual=function(o,s){return Da.restrictToPolygons(o.union(s))},Da.prototype.unionTree=function(o){var s=this.reduceToGeometries(o);return this.binaryUnion(s)},Da.prototype.unionUsingEnvelopeIntersection=function(o,s,d){var _=new Gr,w=this.extractByEnvelope(d,o,_),j=this.extractByEnvelope(d,s,_),ie=this.unionActual(w,j);return _.add(ie),gs.combine(_)},Da.prototype.bufferUnion=function(){if(arguments.length===1){var o=arguments[0];return o.get(0).getFactory().buildGeometry(o).buffer(0)}if(arguments.length===2){var s=arguments[0],d=arguments[1];return s.getFactory().createGeometryCollection([s,d]).buffer(0)}},Da.prototype.interfaces_=function(){return[]},Da.prototype.getClass=function(){return Da},Da.restrictToPolygons=function(o){if(Le(o,eu))return o;var s=pu.getPolygons(o);return s.size()===1?s.get(0):o.getFactory().createMultiPolygon(Ai.toPolygonArray(s))},Da.getGeometry=function(o,s){return s>=o.size()?null:o.get(s)},Da.union=function(o){return new Da(o).union()},il.STRTREE_NODE_CAPACITY.get=function(){return 4},Object.defineProperties(Da,il);var tf=function(){};tf.prototype.interfaces_=function(){return[]},tf.prototype.getClass=function(){return tf},tf.union=function(o,s){if(o.isEmpty()||s.isEmpty()){if(o.isEmpty()&&s.isEmpty())return Fn.createEmptyResult(Fn.UNION,o,s,o.getFactory());if(o.isEmpty())return s.copy();if(s.isEmpty())return o.copy()}return o.checkNotGeometryCollection(o),o.checkNotGeometryCollection(s),Wn.overlayOp(o,s,Fn.UNION)},C.GeoJSONReader=He,C.GeoJSONWriter=Gt,C.OverlayOp=Fn,C.UnionOp=tf,C.BufferOp=wo,Object.defineProperty(C,"__esModule",{value:!0})})},64687:function(le,$,C){var L=C(17061)();le.exports=L;try{regeneratorRuntime=L}catch(k){typeof globalThis=="object"?globalThis.regeneratorRuntime=L:Function("r","regeneratorRuntime = r")(L)}},95:function(le,$,C){"use strict";C.d($,{Z:function(){return k}});var L=C(1449);function k(G,Z){Z===void 0&&(Z={});var F=Number(G[0]),z=Number(G[1]),q=Number(G[2]),ee=Number(G[3]);if(G.length===6)throw new Error("@turf/bbox-polygon does not support BBox with 6 positions");var fe=[F,z],Se=[F,ee],Re=[q,ee],De=[q,z];return(0,L.yu)([[fe,De,Re,Se,fe]],Z.properties,{bbox:G,id:Z.id})}},62096:function(le,$,C){"use strict";var L=C(39034);function k(G){var Z=[1/0,1/0,-1/0,-1/0];return(0,L.pZ)(G,function(F){Z[0]>F[0]&&(Z[0]=F[0]),Z[1]>F[1]&&(Z[1]=F[1]),Z[2]<F[0]&&(Z[2]=F[0]),Z[3]<F[1]&&(Z[3]=F[1])}),Z}k.default=k,$.Z=k},1449:function(le,$,C){"use strict";C.d($,{Tu:function(){return Re},ot:function(){return Ee},tw:function(){return Ie},uf:function(){return Ve},xm:function(){return q},yu:function(){return fe},zL:function(){return F}});var L=63710088e-1,k={centimeters:L*100,centimetres:L*100,degrees:L/111325,feet:L*3.28084,inches:L*39.37,kilometers:L/1e3,kilometres:L/1e3,meters:L,metres:L,miles:L/1609.344,millimeters:L*1e3,millimetres:L*1e3,nauticalmiles:L/1852,radians:1,yards:L*1.0936},G={centimeters:100,centimetres:100,degrees:1/111325,feet:3.28084,inches:39.37,kilometers:1/1e3,kilometres:1/1e3,meters:1,metres:1,miles:1/1609.344,millimeters:1e3,millimetres:1e3,nauticalmiles:1/1852,radians:1/L,yards:1.0936133},Z={acres:247105e-9,centimeters:1e4,centimetres:1e4,feet:10.763910417,hectares:1e-4,inches:1550.003100006,kilometers:1e-6,kilometres:1e-6,meters:1,metres:1,miles:386e-9,millimeters:1e6,millimetres:1e6,yards:1.195990046};function F(de,be,se){se===void 0&&(se={});var Ne={type:"Feature"};return(se.id===0||se.id)&&(Ne.id=se.id),se.bbox&&(Ne.bbox=se.bbox),Ne.properties=be||{},Ne.geometry=de,Ne}function z(de,be,se){switch(se===void 0&&(se={}),de){case"Point":return q(be).geometry;case"LineString":return Re(be).geometry;case"Polygon":return fe(be).geometry;case"MultiPoint":return Ee(be).geometry;case"MultiLineString":return nt(be).geometry;case"MultiPolygon":return Ie(be).geometry;default:throw new Error(de+" is invalid")}}function q(de,be,se){if(se===void 0&&(se={}),!de)throw new Error("coordinates is required");if(!Array.isArray(de))throw new Error("coordinates must be an Array");if(de.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!ye(de[0])||!ye(de[1]))throw new Error("coordinates must contain numbers");var Ne={type:"Point",coordinates:de};return F(Ne,be,se)}function ee(de,be,se){return se===void 0&&(se={}),Ve(de.map(function(Ne){return q(Ne,be)}),se)}function fe(de,be,se){se===void 0&&(se={});for(var Ne=0,ze=de;Ne<ze.length;Ne++){var ue=ze[Ne];if(ue.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var kt=0;kt<ue[ue.length-1].length;kt++)if(ue[ue.length-1][kt]!==ue[0][kt])throw new Error("First and last Position are not equivalent.")}var Rt={type:"Polygon",coordinates:de};return F(Rt,be,se)}function Se(de,be,se){return se===void 0&&(se={}),Ve(de.map(function(Ne){return fe(Ne,be)}),se)}function Re(de,be,se){if(se===void 0&&(se={}),de.length<2)throw new Error("coordinates must be an array of two or more positions");var Ne={type:"LineString",coordinates:de};return F(Ne,be,se)}function De(de,be,se){return se===void 0&&(se={}),Ve(de.map(function(Ne){return Re(Ne,be)}),se)}function Ve(de,be){be===void 0&&(be={});var se={type:"FeatureCollection"};return be.id&&(se.id=be.id),be.bbox&&(se.bbox=be.bbox),se.features=de,se}function nt(de,be,se){se===void 0&&(se={});var Ne={type:"MultiLineString",coordinates:de};return F(Ne,be,se)}function Ee(de,be,se){se===void 0&&(se={});var Ne={type:"MultiPoint",coordinates:de};return F(Ne,be,se)}function Ie(de,be,se){se===void 0&&(se={});var Ne={type:"MultiPolygon",coordinates:de};return F(Ne,be,se)}function me(de,be,se){se===void 0&&(se={});var Ne={type:"GeometryCollection",geometries:de};return F(Ne,be,se)}function we(de,be){if(be===void 0&&(be=0),be&&!(be>=0))throw new Error("precision must be a positive number");var se=Math.pow(10,be||0);return Math.round(de*se)/se}function ne(de,be){be===void 0&&(be="kilometers");var se=k[be];if(!se)throw new Error(be+" units is invalid");return de*se}function Pe(de,be){be===void 0&&(be="kilometers");var se=k[be];if(!se)throw new Error(be+" units is invalid");return de/se}function he(de,be){return te(Pe(de,be))}function ve(de){var be=de%360;return be<0&&(be+=360),be}function te(de){var be=de%(2*Math.PI);return be*180/Math.PI}function Y(de){var be=de%360;return be*Math.PI/180}function Oe(de,be,se){if(be===void 0&&(be="kilometers"),se===void 0&&(se="kilometers"),!(de>=0))throw new Error("length must be a positive number");return ne(Pe(de,be),se)}function pe(de,be,se){if(be===void 0&&(be="meters"),se===void 0&&(se="kilometers"),!(de>=0))throw new Error("area must be a positive number");var Ne=Z[be];if(!Ne)throw new Error("invalid original units");var ze=Z[se];if(!ze)throw new Error("invalid final units");return de/Ne*ze}function ye(de){return!isNaN(de)&&de!==null&&!Array.isArray(de)}function _e(de){return!!de&&de.constructor===Object}function X(de){if(!de)throw new Error("bbox is required");if(!Array.isArray(de))throw new Error("bbox must be an Array");if(de.length!==4&&de.length!==6)throw new Error("bbox must be an Array of 4 or 6 numbers");de.forEach(function(be){if(!ye(be))throw new Error("bbox must only contain numbers")})}function Le(de){if(!de)throw new Error("id is required");if(["string","number"].indexOf(typeof de)===-1)throw new Error("id must be a number or a string")}},36987:function(le,$,C){"use strict";C.d($,{c9:function(){return k},nK:function(){return z},r7:function(){return G},wA:function(){return ee}});var L=C(1449);function k(Se){if(!Se)throw new Error("coord is required");if(!Array.isArray(Se)){if(Se.type==="Feature"&&Se.geometry!==null&&Se.geometry.type==="Point")return Se.geometry.coordinates;if(Se.type==="Point")return Se.coordinates}if(Array.isArray(Se)&&Se.length>=2&&!Array.isArray(Se[0])&&!Array.isArray(Se[1]))return Se;throw new Error("coord must be GeoJSON Point or an Array of numbers")}function G(Se){if(Array.isArray(Se))return Se;if(Se.type==="Feature"){if(Se.geometry!==null)return Se.geometry.coordinates}else if(Se.coordinates)return Se.coordinates;throw new Error("coords must be GeoJSON Feature, Geometry Object or an Array")}function Z(Se){if(Se.length>1&&isNumber(Se[0])&&isNumber(Se[1]))return!0;if(Array.isArray(Se[0])&&Se[0].length)return Z(Se[0]);throw new Error("coordinates must only contain numbers")}function F(Se,Re,De){if(!Re||!De)throw new Error("type and name required");if(!Se||Se.type!==Re)throw new Error("Invalid input to "+De+": must be a "+Re+", given "+Se.type)}function z(Se,Re,De){if(!Se)throw new Error("No feature passed");if(!De)throw new Error(".featureOf() requires a name");if(!Se||Se.type!=="Feature"||!Se.geometry)throw new Error("Invalid input to "+De+", Feature with geometry required");if(!Se.geometry||Se.geometry.type!==Re)throw new Error("Invalid input to "+De+": must be a "+Re+", given "+Se.geometry.type)}function q(Se,Re,De){if(!Se)throw new Error("No featureCollection passed");if(!De)throw new Error(".collectionOf() requires a name");if(!Se||Se.type!=="FeatureCollection")throw new Error("Invalid input to "+De+", FeatureCollection required");for(var Ve=0,nt=Se.features;Ve<nt.length;Ve++){var Ee=nt[Ve];if(!Ee||Ee.type!=="Feature"||!Ee.geometry)throw new Error("Invalid input to "+De+", Feature with geometry required");if(!Ee.geometry||Ee.geometry.type!==Re)throw new Error("Invalid input to "+De+": must be a "+Re+", given "+Ee.geometry.type)}}function ee(Se){return Se.type==="Feature"?Se.geometry:Se}function fe(Se,Re){return Se.type==="FeatureCollection"?"FeatureCollection":Se.type==="GeometryCollection"?"GeometryCollection":Se.type==="Feature"&&Se.geometry!==null?Se.geometry.type:Se.type}},39034:function(le,$,C){"use strict";C.d($,{Lo:function(){return G},nG:function(){return Re},pZ:function(){return k}});var L=C(1449);function k(ne,Pe,he){if(ne!==null)for(var ve,te,Y,Oe,pe,ye,_e,X=0,Le=0,de,be=ne.type,se=be==="FeatureCollection",Ne=be==="Feature",ze=se?ne.features.length:1,ue=0;ue<ze;ue++){_e=se?ne.features[ue].geometry:Ne?ne.geometry:ne,de=_e?_e.type==="GeometryCollection":!1,pe=de?_e.geometries.length:1;for(var kt=0;kt<pe;kt++){var Rt=0,cr=0;if(Oe=de?_e.geometries[kt]:_e,Oe!==null){ye=Oe.coordinates;var Ut=Oe.type;switch(X=he&&(Ut==="Polygon"||Ut==="MultiPolygon")?1:0,Ut){case null:break;case"Point":if(Pe(ye,Le,ue,Rt,cr)===!1)return!1;Le++,Rt++;break;case"LineString":case"MultiPoint":for(ve=0;ve<ye.length;ve++){if(Pe(ye[ve],Le,ue,Rt,cr)===!1)return!1;Le++,Ut==="MultiPoint"&&Rt++}Ut==="LineString"&&Rt++;break;case"Polygon":case"MultiLineString":for(ve=0;ve<ye.length;ve++){for(te=0;te<ye[ve].length-X;te++){if(Pe(ye[ve][te],Le,ue,Rt,cr)===!1)return!1;Le++}Ut==="MultiLineString"&&Rt++,Ut==="Polygon"&&cr++}Ut==="Polygon"&&Rt++;break;case"MultiPolygon":for(ve=0;ve<ye.length;ve++){for(cr=0,te=0;te<ye[ve].length;te++){for(Y=0;Y<ye[ve][te].length-X;Y++){if(Pe(ye[ve][te][Y],Le,ue,Rt,cr)===!1)return!1;Le++}cr++}Rt++}break;case"GeometryCollection":for(ve=0;ve<Oe.geometries.length;ve++)if(k(Oe.geometries[ve],Pe,he)===!1)return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function G(ne,Pe,he,ve){var te=he;return k(ne,function(Y,Oe,pe,ye,_e){Oe===0&&he===void 0?te=Y:te=Pe(te,Y,Oe,pe,ye,_e)},ve),te}function Z(ne,Pe){var he;switch(ne.type){case"FeatureCollection":for(he=0;he<ne.features.length&&Pe(ne.features[he].properties,he)!==!1;he++);break;case"Feature":Pe(ne.properties,0);break}}function F(ne,Pe,he){var ve=he;return Z(ne,function(te,Y){Y===0&&he===void 0?ve=te:ve=Pe(ve,te,Y)}),ve}function z(ne,Pe){if(ne.type==="Feature")Pe(ne,0);else if(ne.type==="FeatureCollection")for(var he=0;he<ne.features.length&&Pe(ne.features[he],he)!==!1;he++);}function q(ne,Pe,he){var ve=he;return z(ne,function(te,Y){Y===0&&he===void 0?ve=te:ve=Pe(ve,te,Y)}),ve}function ee(ne){var Pe=[];return k(ne,function(he){Pe.push(he)}),Pe}function fe(ne,Pe){var he,ve,te,Y,Oe,pe,ye,_e,X,Le,de=0,be=ne.type==="FeatureCollection",se=ne.type==="Feature",Ne=be?ne.features.length:1;for(he=0;he<Ne;he++){for(pe=be?ne.features[he].geometry:se?ne.geometry:ne,_e=be?ne.features[he].properties:se?ne.properties:{},X=be?ne.features[he].bbox:se?ne.bbox:void 0,Le=be?ne.features[he].id:se?ne.id:void 0,ye=pe?pe.type==="GeometryCollection":!1,Oe=ye?pe.geometries.length:1,te=0;te<Oe;te++){if(Y=ye?pe.geometries[te]:pe,Y===null){if(Pe(null,de,_e,X,Le)===!1)return!1;continue}switch(Y.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":{if(Pe(Y,de,_e,X,Le)===!1)return!1;break}case"GeometryCollection":{for(ve=0;ve<Y.geometries.length;ve++)if(Pe(Y.geometries[ve],de,_e,X,Le)===!1)return!1;break}default:throw new Error("Unknown Geometry Type")}}de++}}function Se(ne,Pe,he){var ve=he;return fe(ne,function(te,Y,Oe,pe,ye){Y===0&&he===void 0?ve=te:ve=Pe(ve,te,Y,Oe,pe,ye)}),ve}function Re(ne,Pe){fe(ne,function(he,ve,te,Y,Oe){var pe=he===null?null:he.type;switch(pe){case null:case"Point":case"LineString":case"Polygon":return Pe((0,L.zL)(he,te,{bbox:Y,id:Oe}),ve,0)===!1?!1:void 0}var ye;switch(pe){case"MultiPoint":ye="Point";break;case"MultiLineString":ye="LineString";break;case"MultiPolygon":ye="Polygon";break}for(var _e=0;_e<he.coordinates.length;_e++){var X=he.coordinates[_e],Le={type:ye,coordinates:X};if(Pe((0,L.zL)(Le,te),ve,_e)===!1)return!1}})}function De(ne,Pe,he){var ve=he;return Re(ne,function(te,Y,Oe){Y===0&&Oe===0&&he===void 0?ve=te:ve=Pe(ve,te,Y,Oe)}),ve}function Ve(ne,Pe){Re(ne,function(he,ve,te){var Y=0;if(he.geometry){var Oe=he.geometry.type;if(!(Oe==="Point"||Oe==="MultiPoint")){var pe,ye=0,_e=0,X=0;if(k(he,function(Le,de,be,se,Ne){if(pe===void 0||ve>ye||se>_e||Ne>X){pe=Le,ye=ve,_e=se,X=Ne,Y=0;return}var ze=lineString([pe,Le],he.properties);if(Pe(ze,ve,te,Ne,Y)===!1)return!1;Y++,pe=Le})===!1)return!1}}})}function nt(ne,Pe,he){var ve=he,te=!1;return Ve(ne,function(Y,Oe,pe,ye,_e){te===!1&&he===void 0?ve=Y:ve=Pe(ve,Y,Oe,pe,ye,_e),te=!0}),ve}function Ee(ne,Pe){if(!ne)throw new Error("geojson is required");Re(ne,function(he,ve,te){if(he.geometry!==null){var Y=he.geometry.type,Oe=he.geometry.coordinates;switch(Y){case"LineString":if(Pe(he,ve,te,0,0)===!1)return!1;break;case"Polygon":for(var pe=0;pe<Oe.length;pe++)if(Pe(lineString(Oe[pe],he.properties),ve,te,pe)===!1)return!1;break}}})}function Ie(ne,Pe,he){var ve=he;return Ee(ne,function(te,Y,Oe,pe){Y===0&&he===void 0?ve=te:ve=Pe(ve,te,Y,Oe,pe)}),ve}function me(ne,Pe){if(Pe=Pe||{},!isObject(Pe))throw new Error("options is invalid");var he=Pe.featureIndex||0,ve=Pe.multiFeatureIndex||0,te=Pe.geometryIndex||0,Y=Pe.segmentIndex||0,Oe=Pe.properties,pe;switch(ne.type){case"FeatureCollection":he<0&&(he=ne.features.length+he),Oe=Oe||ne.features[he].properties,pe=ne.features[he].geometry;break;case"Feature":Oe=Oe||ne.properties,pe=ne.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":pe=ne;break;default:throw new Error("geojson is invalid")}if(pe===null)return null;var ye=pe.coordinates;switch(pe.type){case"Point":case"MultiPoint":return null;case"LineString":return Y<0&&(Y=ye.length+Y-1),lineString([ye[Y],ye[Y+1]],Oe,Pe);case"Polygon":return te<0&&(te=ye.length+te),Y<0&&(Y=ye[te].length+Y-1),lineString([ye[te][Y],ye[te][Y+1]],Oe,Pe);case"MultiLineString":return ve<0&&(ve=ye.length+ve),Y<0&&(Y=ye[ve].length+Y-1),lineString([ye[ve][Y],ye[ve][Y+1]],Oe,Pe);case"MultiPolygon":return ve<0&&(ve=ye.length+ve),te<0&&(te=ye[ve].length+te),Y<0&&(Y=ye[ve][te].length-Y-1),lineString([ye[ve][te][Y],ye[ve][te][Y+1]],Oe,Pe)}throw new Error("geojson is invalid")}function we(ne,Pe){if(Pe=Pe||{},!isObject(Pe))throw new Error("options is invalid");var he=Pe.featureIndex||0,ve=Pe.multiFeatureIndex||0,te=Pe.geometryIndex||0,Y=Pe.coordIndex||0,Oe=Pe.properties,pe;switch(ne.type){case"FeatureCollection":he<0&&(he=ne.features.length+he),Oe=Oe||ne.features[he].properties,pe=ne.features[he].geometry;break;case"Feature":Oe=Oe||ne.properties,pe=ne.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":pe=ne;break;default:throw new Error("geojson is invalid")}if(pe===null)return null;var ye=pe.coordinates;switch(pe.type){case"Point":return point(ye,Oe,Pe);case"MultiPoint":return ve<0&&(ve=ye.length+ve),point(ye[ve],Oe,Pe);case"LineString":return Y<0&&(Y=ye.length+Y),point(ye[Y],Oe,Pe);case"Polygon":return te<0&&(te=ye.length+te),Y<0&&(Y=ye[te].length+Y),point(ye[te][Y],Oe,Pe);case"MultiLineString":return ve<0&&(ve=ye.length+ve),Y<0&&(Y=ye[ve].length+Y),point(ye[ve][Y],Oe,Pe);case"MultiPolygon":return ve<0&&(ve=ye.length+ve),te<0&&(te=ye[ve].length+te),Y<0&&(Y=ye[ve][te].length-Y),point(ye[ve][te][Y],Oe,Pe)}throw new Error("geojson is invalid")}},26137:function(le,$,C){"use strict";C.d($,{uf4:function(){return Z.uf},yue:function(){return Z.yu},dtN:function(){return gi}});var L=C(62096),k=C(39034),G=C(36987),Z=C(1449),F=C(27418);var z={successCallback:null,verbose:!1},q={};function ee(l,A,y){y=y||{};for(var b=Object.keys(z),T=0;T<b.length;T++){var P=b[T],R=y[P];R=typeof R!="undefined"&&R!==null?R:z[P],q[P]=R}q.verbose&&console.log("MarchingSquaresJS-isoContours: computing isocontour for "+A);var U=Ee(Se(l,A));return typeof q.successCallback=="function"&&q.successCallback(U),U}function fe(l,A,y){return(l-A)/(y-A)}function Se(l,A){for(var y=l.length-1,b=l[0].length-1,T={rows:y,cols:b,cells:[]},P=0;P<y;++P){T.cells[P]=[];for(var R=0;R<b;++R){var U=0,H=l[P+1][R],N=l[P+1][R+1],Q=l[P][R+1],K=l[P][R];if(!(isNaN(H)||isNaN(N)||isNaN(Q)||isNaN(K))){U|=H>=A?8:0,U|=N>=A?4:0,U|=Q>=A?2:0,U|=K>=A?1:0;var ae=!1;if(U===5||U===10){var ge=(H+N+Q+K)/4;U===5&&ge<A?(U=10,ae=!0):U===10&&ge<A&&(U=5,ae=!0)}if(U!==0&&U!==15){var pt,at,Nt,dt;pt=at=Nt=dt=.5,U===1?(Nt=1-fe(A,H,K),at=1-fe(A,Q,K)):U===2?(at=fe(A,K,Q),dt=1-fe(A,N,Q)):U===3?(Nt=1-fe(A,H,K),dt=1-fe(A,N,Q)):U===4?(pt=fe(A,H,N),dt=fe(A,Q,N)):U===5?(pt=fe(A,H,N),dt=fe(A,Q,N),at=1-fe(A,Q,K),Nt=1-fe(A,H,K)):U===6?(at=fe(A,K,Q),pt=fe(A,H,N)):U===7?(Nt=1-fe(A,H,K),pt=fe(A,H,N)):U===8?(Nt=fe(A,K,H),pt=1-fe(A,N,H)):U===9?(at=1-fe(A,Q,K),pt=1-fe(A,N,H)):U===10?(pt=1-fe(A,N,H),dt=1-fe(A,N,Q),at=fe(A,K,Q),Nt=fe(A,K,H)):U===11?(pt=1-fe(A,N,H),dt=1-fe(A,N,Q)):U===12?(Nt=fe(A,K,H),dt=fe(A,Q,N)):U===13?(at=1-fe(A,Q,K),dt=fe(A,Q,N)):U===14?(Nt=fe(A,K,H),at=fe(A,K,Q)):console.log("MarchingSquaresJS-isoContours: Illegal cval detected: "+U),T.cells[P][R]={cval:U,flipped:ae,top:pt,right:dt,bottom:at,left:Nt}}}}}return T}function Re(l){return l.cval===5||l.cval===10}function De(l){return l.cval===0||l.cval===15}function Ve(l){!De(l)&&l.cval!==5&&l.cval!==10&&(l.cval=15)}function nt(l,A){if(A==="top")return[l.top,1];if(A==="bottom")return[l.bottom,0];if(A==="right")return[1,l.right];if(A==="left")return[0,l.left]}function Ee(l){var A=[],y=0,b=1e-7;return l.cells.forEach(function(T,P){T.forEach(function(R,U){if(typeof R!="undefined"&&!Re(R)&&!De(R)){var H=Ie(l.cells,P,U),N=!1;if(H.info==="mergeable"){for(var Q=H.path[H.path.length-1][0],K=H.path[H.path.length-1][1],ae=y-1;ae>=0;ae--)if(Math.abs(A[ae][0][0]-Q)<=b&&Math.abs(A[ae][0][1]-K)<=b){for(var ge=H.path.length-2;ge>=0;--ge)A[ae].unshift(H.path[ge]);N=!0;break}}N||(A[y++]=H.path)}})}),A}function Ie(l,A,y){var b=l.length,T=[],P=[0,0,1,1,0,0,0,0,-1,0,1,1,-1,0,-1,0],R=[0,-1,0,0,1,1,1,1,0,-1,0,0,0,-1,0,0],U,H,N=["none","left","bottom","left","right","none","bottom","left","top","top","none","top","right","right","bottom","none"],Q=["none","bottom","right","right","top","top","top","top","left","bottom","right","right","left","bottom","left","none"],ge,K=l[A][y],ae=K.cval,ge=N[ae],pt=nt(K,ge);T.push([y+pt[0],A+pt[1]]),ge=Q[ae],pt=nt(K,ge),T.push([y+pt[0],A+pt[1]]),Ve(K);for(var at=y+P[ae],Nt=A+R[ae],dt=ae;at>=0&&Nt>=0&&Nt<b&&(at!=y||Nt!=A)&&(K=l[Nt][at],typeof K!="undefined");){if(ae=K.cval,ae===0||ae===15)return{path:T,info:"mergeable"};ge=Q[ae],U=P[ae],H=R[ae],(ae===5||ae===10)&&(ae===5?K.flipped?R[dt]===-1?(ge="left",U=-1,H=0):(ge="right",U=1,H=0):P[dt]===-1&&(ge="bottom",U=0,H=-1):ae===10&&(K.flipped?P[dt]===-1?(ge="top",U=0,H=1):(ge="bottom",U=0,H=-1):R[dt]===1&&(ge="left",U=-1,H=0))),pt=nt(K,ge),T.push([at+pt[0],Nt+pt[1]]),Ve(K),at+=U,Nt+=H,dt=ae}return{path:T,info:"closed"}}function me(l,A){if(A=A||{},!isObject(A))throw new Error("options is invalid");var y=A.zProperty||"elevation",b=A.flip,T=A.flags;collectionOf(l,"Point","input must contain Points");for(var P=we(l,b),R=[],U=0;U<P.length;U++){for(var H=P[U],N=[],Q=0;Q<H.length;Q++){var K=H[Q];K.properties[y]?N.push(K.properties[y]):N.push(0),T===!0&&(K.properties.matrixPosition=[U,Q])}R.push(N)}return R}function we(l,A){var y={};featureEach(l,function(P){var R=getCoords(P)[1];y[R]||(y[R]=[]),y[R].push(P)});var b=Object.keys(y).map(function(P){var R=y[P],U=R.sort(function(H,N){return getCoords(H)[0]-getCoords(N)[0]});return U}),T=b.sort(function(P,R){return A?getCoords(P[0])[1]-getCoords(R[0])[1]:getCoords(R[0])[1]-getCoords(P[0])[1]});return T}function ne(l,A,y){if(y=y||{},!isObject(y))throw new Error("options is invalid");var b=y.zProperty||"elevation",T=y.commonProperties||{},P=y.breaksProperties||[];if(collectionOf(l,"Point","Input must contain Points"),!A)throw new Error("breaks is required");if(!Array.isArray(A))throw new Error("breaks must be an Array");if(!isObject(T))throw new Error("commonProperties must be an Object");if(!Array.isArray(P))throw new Error("breaksProperties must be an Array");var R=me(l,{zProperty:b,flip:!0}),U=Pe(R,A,b,T,P),H=he(U,R,l);return featureCollection(H)}function Pe(l,A,y,b,T){for(var P=[],R=1;R<A.length;R++){var U=+A[R],H=objectAssign({},b,T[R]);H[y]=U;var N=multiLineString(ee(l,U),H);P.push(N)}return P}function he(l,A,y){var b=bbox(y),T=b[2]-b[0],P=b[3]-b[1],R=b[0],U=b[1],H=A[0].length-1,N=A.length-1,Q=T/H,K=P/N,ae=function(ge){ge[0]=ge[0]*Q+R,ge[1]=ge[1]*K+U};return l.forEach(function(ge){coordEach(ge,ae)}),l}var ve=null,te=C(72273);function Y(l,A){A===void 0&&(A={}),A.concavity=A.concavity||1/0;var y=[];if(coordEach(l,function(T){y.push([T[0],T[1]])}),!y.length)return null;var b=concaveman(y,A.concavity);return b.length>3?polygon([b]):null}function Oe(l,A,y){if(y===void 0&&(y={}),!l)throw new Error("point is required");if(!A)throw new Error("polygon is required");var b=(0,G.c9)(l),T=(0,G.wA)(A),P=T.type,R=A.bbox,U=T.coordinates;if(R&&ye(b,R)===!1)return!1;P==="Polygon"&&(U=[U]);for(var H=!1,N=0;N<U.length&&!H;N++)if(pe(b,U[N][0],y.ignoreBoundary)){for(var Q=!1,K=1;K<U[N].length&&!Q;)pe(b,U[N][K],!y.ignoreBoundary)&&(Q=!0),K++;Q||(H=!0)}return H}function pe(l,A,y){var b=!1;A[0][0]===A[A.length-1][0]&&A[0][1]===A[A.length-1][1]&&(A=A.slice(0,A.length-1));for(var T=0,P=A.length-1;T<A.length;P=T++){var R=A[T][0],U=A[T][1],H=A[P][0],N=A[P][1],Q=l[1]*(R-H)+U*(H-l[0])+N*(l[0]-R)===0&&(R-l[0])*(H-l[0])<=0&&(U-l[1])*(N-l[1])<=0;if(Q)return!y;var K=U>l[1]!=N>l[1]&&l[0]<(H-R)*(l[1]-U)/(N-U)+R;K&&(b=!b)}return b}function ye(l,A){return A[0]<=l[0]&&A[1]<=l[1]&&A[2]>=l[0]&&A[3]>=l[1]}function _e(l,A){var y=[];return featureEach(l,function(b){var T=!1;if(b.geometry.type==="Point")geomEach(A,function(R){pointInPolygon(b,R)&&(T=!0)}),T&&y.push(b);else if(b.geometry.type==="MultiPoint"){var P=[];geomEach(A,function(R){coordEach(b,function(U){pointInPolygon(U,R)&&(T=!0,P.push(U))})}),T&&y.push(multiPoint(P))}else throw new Error("Input geometry must be a Point or MultiPoint")}),featureCollection(y)}var X=null;function Le(l,A,y){y===void 0&&(y={});var b=getCoord(l),T=getCoord(A),P=degreesToRadians(T[1]-b[1]),R=degreesToRadians(T[0]-b[0]),U=degreesToRadians(b[1]),H=degreesToRadians(T[1]),N=Math.pow(Math.sin(P/2),2)+Math.pow(Math.sin(R/2),2)*Math.cos(U)*Math.cos(H);return radiansToLength(2*Math.atan2(Math.sqrt(N),Math.sqrt(1-N)),y.units)}var de=null;function be(l,A){var y=!1;return featureCollection(ue(l.features.map(function(b){var T={x:b.geometry.coordinates[0],y:b.geometry.coordinates[1]};return A?T.z=b.properties[A]:b.geometry.coordinates.length===3&&(y=!0,T.z=b.geometry.coordinates[2]),T})).map(function(b){var T=[b.a.x,b.a.y],P=[b.b.x,b.b.y],R=[b.c.x,b.c.y],U={};return y?(T.push(b.a.z),P.push(b.b.z),R.push(b.c.z)):U={a:b.a.z,b:b.b.z,c:b.c.z},polygon([[T,P,R,T]],U)}))}var se=function(){function l(A,y,b){this.a=A,this.b=y,this.c=b;var T=y.x-A.x,P=y.y-A.y,R=b.x-A.x,U=b.y-A.y,H=T*(A.x+y.x)+P*(A.y+y.y),N=R*(A.x+b.x)+U*(A.y+b.y),Q=2*(T*(b.y-y.y)-P*(b.x-y.x)),K,ae;this.x=(U*H-P*N)/Q,this.y=(T*N-R*H)/Q,K=this.x-A.x,ae=this.y-A.y,this.r=K*K+ae*ae}return l}();function Ne(l,A){return A.x-l.x}function ze(l){var A=l.length,y,b,T,P,R;e:for(;A;)for(b=l[--A],y=l[--A],T=A;T;)if(R=l[--T],P=l[--T],y===P&&b===R||y===R&&b===P){l.splice(A,2),l.splice(T,2),A-=2;continue e}}function ue(l){if(l.length<3)return[];l.sort(Ne);for(var A=l.length-1,y=l[A].x,b=l[0].x,T=l[A].y,P=T,R=1e-12,U,H,N,Q,K,ae;A--;)l[A].y<T&&(T=l[A].y),l[A].y>P&&(P=l[A].y);var ge=b-y,pt=P-T,at=ge>pt?ge:pt,Nt=(b+y)*.5,dt=(P+T)*.5,Ke=[new se({__sentinel:!0,x:Nt-20*at,y:dt-at},{__sentinel:!0,x:Nt,y:dt+20*at},{__sentinel:!0,x:Nt+20*at,y:dt-at})],ht=[],Ht=[],Bt;for(A=l.length;A--;){for(Ht.length=0,Bt=Ke.length;Bt--;){if(ge=l[A].x-Ke[Bt].x,ge>0&&ge*ge>Ke[Bt].r){ht.push(Ke[Bt]),Ke.splice(Bt,1);continue}pt=l[A].y-Ke[Bt].y,!(ge*ge+pt*pt>Ke[Bt].r)&&(Ht.push(Ke[Bt].a,Ke[Bt].b,Ke[Bt].b,Ke[Bt].c,Ke[Bt].c,Ke[Bt].a),Ke.splice(Bt,1))}for(ze(Ht),Bt=Ht.length;Bt;)H=Ht[--Bt],U=Ht[--Bt],N=l[A],Q=H.x-U.x,K=H.y-U.y,ae=2*(Q*(N.y-H.y)-K*(N.x-H.x)),Math.abs(ae)>R&&Ke.push(new se(U,H,N))}for(Array.prototype.push.apply(ht,Ke),A=ht.length;A--;)(ht[A].a.__sentinel||ht[A].b.__sentinel||ht[A].c.__sentinel)&&ht.splice(A,1);return ht}function kt(l,A){if(A===void 0&&(A={}),A=A||{},!isObject(A))throw new Error("options is invalid");var y=A.mutate;if(getType(l)!=="FeatureCollection")throw new Error("geojson must be a FeatureCollection");if(!l.features.length)throw new Error("geojson is empty");(y===!1||y===void 0)&&(l=clone(l));var b=[],T=lineReduce(l,function(P,R){var U=cr(P,R);return U||(b.push(P),R)});return T&&b.push(T),b.length?b.length===1?b[0]:multiLineString(b.map(function(P){return P.coordinates})):null}function Rt(l){return l[0].toString()+","+l[1].toString()}function cr(l,A){var y=l.geometry.coordinates,b=A.geometry.coordinates,T=Rt(y[0]),P=Rt(y[y.length-1]),R=Rt(b[0]),U=Rt(b[b.length-1]),H;if(T===U)H=b.concat(y.slice(1));else if(R===P)H=y.concat(b.slice(1));else if(T===R)H=y.slice(1).reverse().concat(b);else if(P===U)H=y.concat(b.reverse().slice(1));else return null;return lineString(H)}var Ut=null,$r=Object.prototype.hasOwnProperty;function ln(l){var A=1/0,y=1/0,b=-1/0,T=-1/0;function P(K){K!=null&&hasOwnProperty.call(R,K.type)&&R[K.type](K)}var R={GeometryCollection:function(K){K.geometries.forEach(P)},Point:function(K){U(K.coordinates)},MultiPoint:function(K){K.coordinates.forEach(U)},LineString:function(K){H(K.arcs)},MultiLineString:function(K){K.arcs.forEach(H)},Polygon:function(K){K.arcs.forEach(H)},MultiPolygon:function(K){K.arcs.forEach(N)}};function U(K){var ae=K[0],ge=K[1];ae<A&&(A=ae),ae>b&&(b=ae),ge<y&&(y=ge),ge>T&&(T=ge)}function H(K){K.forEach(U)}function N(K){K.forEach(H)}for(var Q in l)P(l[Q]);return b>=A&&T>=y?[A,y,b,T]:void 0}var Cr=new ArrayBuffer(16),Qr=new Float64Array(Cr),Jr=new Uint32Array(Cr);function xr(l){Qr[0]=l[0],Qr[1]=l[1];var A=Jr[0]^Jr[1];return A=A<<5^A>>7^Jr[2]^Jr[3],A&2147483647}function Gn(l){var A=l.coordinates,y=l.lines,b=l.rings,T=ir(),P=new Int32Array(A.length),R=new Int32Array(A.length),U=new Int32Array(A.length),H=new Int8Array(A.length),N=0,Q,K,ae,ge,pt;for(Q=0,K=A.length;Q<K;++Q)P[Q]=R[Q]=U[Q]=-1;for(Q=0,K=y.length;Q<K;++Q){var at=y[Q],Nt=at[0],dt=at[1];for(ge=T[Nt],pt=T[++Nt],++N,H[ge]=1;++Nt<=dt;)Bt(Q,ae=ge,ge=pt,pt=T[Nt]);++N,H[pt]=1}for(Q=0,K=A.length;Q<K;++Q)P[Q]=-1;for(Q=0,K=b.length;Q<K;++Q){var Ke=b[Q],ht=Ke[0]+1,Ht=Ke[1];for(ae=T[Ht-1],ge=T[ht-1],pt=T[ht],Bt(Q,ae,ge,pt);++ht<=Ht;)Bt(Q,ae=ge,ge=pt,pt=T[ht])}function Bt(bn,Ei,$i,on){if(P[$i]!==bn){P[$i]=bn;var ai=R[$i];if(ai>=0){var kn=U[$i];(ai!==Ei||kn!==on)&&(ai!==on||kn!==Ei)&&(++N,H[$i]=1)}else R[$i]=Ei,U[$i]=on}}function ir(){for(var bn=hashmap(A.length*1.4,Kt,fr,Int32Array,-1,Int32Array),Ei=new Int32Array(A.length),$i=0,on=A.length;$i<on;++$i)Ei[$i]=bn.maybeSet($i,$i);return Ei}function Kt(bn){return hashPoint(A[bn])}function fr(bn,Ei){return equalPoint(A[bn],A[Ei])}P=R=U=null;var Ct=hashset(N*1.4,hashPoint,equalPoint),si;for(Q=0,K=A.length;Q<K;++Q)H[si=T[Q]]&&Ct.add(A[si]);return Ct}function ti(l){var A=join(l),y=l.coordinates,b=l.lines,T=l.rings,P,R,U;for(R=0,U=b.length;R<U;++R)for(var H=b[R],N=H[0],Q=H[1];++N<Q;)A.has(y[N])&&(P={0:N,1:H[1]},H[1]=N,H=H.next=P);for(R=0,U=T.length;R<U;++R)for(var K=T[R],ae=K[0],ge=ae,pt=K[1],at=A.has(y[ae]);++ge<pt;)A.has(y[ge])&&(at?(P={0:ge,1:K[1]},K[1]=ge,K=K.next=P):(Vn(y,ae,pt,pt-ge),y[pt]=y[ae],at=!0,ge=ae));return l}function Vn(l,A,y,b){Xr(l,A,y),Xr(l,A,A+b),Xr(l,A+b,y)}function Xr(l,A,y){for(var b=A+(y---A>>1),T;A<b;++A,--y)T=l[A],l[A]=l[y],l[y]=T}function sn(l){var A=l.coordinates,y=l.lines,b,T=l.rings,P,R=y.length+T.length,U,H;for(delete l.lines,delete l.rings,U=0,H=y.length;U<H;++U)for(b=y[U];b=b.next;)++R;for(U=0,H=T.length;U<H;++U)for(P=T[U];P=P.next;)++R;var N=hashmap(R*2*1.4,hashPoint,equalPoint),Q=l.arcs=[];for(U=0,H=y.length;U<H;++U){b=y[U];do K(b);while(b=b.next)}for(U=0,H=T.length;U<H;++U)if(P=T[U],P.next)do K(P);while(P=P.next);else ae(P);function K(Ke){var ht,Ht,Bt,ir,Kt,fr,Ct,si;if(Bt=N.get(ht=A[Ke[0]])){for(Ct=0,si=Bt.length;Ct<si;++Ct)if(ir=Bt[Ct],ge(ir,Ke)){Ke[0]=ir[0],Ke[1]=ir[1];return}}if(Kt=N.get(Ht=A[Ke[1]])){for(Ct=0,si=Kt.length;Ct<si;++Ct)if(fr=Kt[Ct],pt(fr,Ke)){Ke[1]=fr[0],Ke[0]=fr[1];return}}Bt?Bt.push(Ke):N.set(ht,[Ke]),Kt?Kt.push(Ke):N.set(Ht,[Ke]),Q.push(Ke)}function ae(Ke){var ht,Ht,Bt,ir,Kt;if(Ht=N.get(ht=A[Ke[0]]))for(ir=0,Kt=Ht.length;ir<Kt;++ir){if(Bt=Ht[ir],at(Bt,Ke)){Ke[0]=Bt[0],Ke[1]=Bt[1];return}if(Nt(Bt,Ke)){Ke[0]=Bt[1],Ke[1]=Bt[0];return}}if(Ht=N.get(ht=A[Ke[0]+dt(Ke)]))for(ir=0,Kt=Ht.length;ir<Kt;++ir){if(Bt=Ht[ir],at(Bt,Ke)){Ke[0]=Bt[0],Ke[1]=Bt[1];return}if(Nt(Bt,Ke)){Ke[0]=Bt[1],Ke[1]=Bt[0];return}}Ht?Ht.push(Ke):N.set(ht,[Ke]),Q.push(Ke)}function ge(Ke,ht){var Ht=Ke[0],Bt=ht[0],ir=Ke[1],Kt=ht[1];if(Ht-ir!==Bt-Kt)return!1;for(;Ht<=ir;++Ht,++Bt)if(!equalPoint(A[Ht],A[Bt]))return!1;return!0}function pt(Ke,ht){var Ht=Ke[0],Bt=ht[0],ir=Ke[1],Kt=ht[1];if(Ht-ir!==Bt-Kt)return!1;for(;Ht<=ir;++Ht,--Kt)if(!equalPoint(A[Ht],A[Kt]))return!1;return!0}function at(Ke,ht){var Ht=Ke[0],Bt=ht[0],ir=Ke[1],Kt=ht[1],fr=ir-Ht;if(fr!==Kt-Bt)return!1;for(var Ct=dt(Ke),si=dt(ht),bn=0;bn<fr;++bn)if(!equalPoint(A[Ht+(bn+Ct)%fr],A[Bt+(bn+si)%fr]))return!1;return!0}function Nt(Ke,ht){var Ht=Ke[0],Bt=ht[0],ir=Ke[1],Kt=ht[1],fr=ir-Ht;if(fr!==Kt-Bt)return!1;for(var Ct=dt(Ke),si=fr-dt(ht),bn=0;bn<fr;++bn)if(!equalPoint(A[Ht+(bn+Ct)%fr],A[Kt-(bn+si)%fr]))return!1;return!0}function dt(Ke){for(var ht=Ke[0],Ht=Ke[1],Bt=ht,ir=Bt,Kt=A[Bt];++Bt<Ht;){var fr=A[Bt];(fr[0]<Kt[0]||fr[0]===Kt[0]&&fr[1]<Kt[1])&&(ir=Bt,Kt=fr)}return ir-ht}return l}function yn(l){var A=-1,y=[],b=[],T=[];function P(K){K&&hasOwnProperty.call(R,K.type)&&R[K.type](K)}var R={GeometryCollection:function(K){K.geometries.forEach(P)},LineString:function(K){K.arcs=U(K.arcs)},MultiLineString:function(K){K.arcs=K.arcs.map(U)},Polygon:function(K){K.arcs=K.arcs.map(H)},MultiPolygon:function(K){K.arcs=K.arcs.map(N)}};function U(K){for(var ae=0,ge=K.length;ae<ge;++ae)T[++A]=K[ae];var pt={0:A-ge+1,1:A};return y.push(pt),pt}function H(K){for(var ae=0,ge=K.length;ae<ge;++ae)T[++A]=K[ae];var pt={0:A-ge+1,1:A};return b.push(pt),pt}function N(K){return K.map(H)}for(var Q in l)P(l[Q]);return{type:"Topology",coordinates:T,lines:y,rings:b,objects:l}}function ki(l,A,y){var b=A[0],T=A[1],P=A[2],R=A[3],U=P-b?(y-1)/(P-b):1,H=R-T?(y-1)/(R-T):1;function N(dt){return[Math.round((dt[0]-b)*U),Math.round((dt[1]-T)*H)]}function Q(dt,Ke){for(var ht=-1,Ht=0,Bt=dt.length,ir=new Array(Bt),Kt,fr,Ct,si,bn;++ht<Bt;)Kt=dt[ht],si=Math.round((Kt[0]-b)*U),bn=Math.round((Kt[1]-T)*H),(si!==fr||bn!==Ct)&&(ir[Ht++]=[fr=si,Ct=bn]);for(ir.length=Ht;Ht<Ke;)Ht=ir.push([ir[0][0],ir[0][1]]);return ir}function K(dt){return Q(dt,2)}function ae(dt){return Q(dt,4)}function ge(dt){return dt.map(ae)}function pt(dt){dt!=null&&hasOwnProperty.call(at,dt.type)&&at[dt.type](dt)}var at={GeometryCollection:function(dt){dt.geometries.forEach(pt)},Point:function(dt){dt.coordinates=N(dt.coordinates)},MultiPoint:function(dt){dt.coordinates=dt.coordinates.map(N)},LineString:function(dt){dt.arcs=K(dt.arcs)},MultiLineString:function(dt){dt.arcs=dt.arcs.map(K)},Polygon:function(dt){dt.arcs=ge(dt.arcs)},MultiPolygon:function(dt){dt.arcs=dt.arcs.map(ge)}};for(var Nt in l)pt(l[Nt]);return{scale:[1/U,1/H],translate:[b,T]}}function ri(l,A){var y=bounds(l=geometry(l)),b=A>0&&y&&prequantize(l,y,A),T=dedup(cut(extract(l))),P=T.coordinates,R=hashmap(T.arcs.length*1.4,Lt,J);l=T.objects,T.bbox=y,T.arcs=T.arcs.map(function(ae,ge){return R.set(ae,ge),P.slice(ae[0],ae[1]+1)}),delete T.coordinates,P=null;function U(ae){ae&&hasOwnProperty.call(H,ae.type)&&H[ae.type](ae)}var H={GeometryCollection:function(ae){ae.geometries.forEach(U)},LineString:function(ae){ae.arcs=N(ae.arcs)},MultiLineString:function(ae){ae.arcs=ae.arcs.map(N)},Polygon:function(ae){ae.arcs=ae.arcs.map(N)},MultiPolygon:function(ae){ae.arcs=ae.arcs.map(Q)}};function N(ae){var ge=[];do{var pt=R.get(ae);ge.push(ae[0]<ae[1]?pt:~pt)}while(ae=ae.next);return ge}function Q(ae){return ae.map(N)}for(var K in l)U(l[K]);return b&&(T.transform=b,T.arcs=delta(T.arcs)),T}function Lt(l){var A=l[0],y=l[1],b;return y<A&&(b=A,A=y,y=b),A+31*y}function J(l,A){var y=l[0],b=l[1],T=A[0],P=A[1],R;return b<y&&(R=y,y=b,b=R),P<T&&(R=T,T=P,P=R),y===T&&b===P}function Ue(l,A){if(A===void 0&&(A={}),getType(l)!=="FeatureCollection")throw new Error("geojson must be a FeatureCollection");if(!l.features.length)throw new Error("geojson is empty");(A.mutate===!1||A.mutate===void 0)&&(l=clone(l));var y=[];flattenEach(l,function(P){y.push(P.geometry)});var b=topology({geoms:geometryCollection(y).geometry}),T=merge(b,b.objects.geoms.geometries);return T}function $e(l,A){if(A===void 0&&(A={}),A=A||{},!isObject(A))throw new Error("options is invalid");var y=A.mutate;if(getType(l)!=="FeatureCollection")throw new Error("geojson must be a FeatureCollection");if(!l.features.length)throw new Error("geojson is empty");(y===!1||y===void 0)&&(l=clone(l));var b=At(l);if(!b)throw new Error("geojson must be homogenous");var T=l;switch(b){case"LineString":return lineDissolve(T,A);case"Polygon":return polygonDissolve(T,A);default:throw new Error(b+" is not supported")}}function At(l){var A={};flattenEach(l,function(b){A[b.geometry.type]=!0});var y=Object.keys(A);return y.length===1?y[0]:null}var It=null;function wt(l,A){A===void 0&&(A={});var y=A.maxEdge||1/0,b=mr(l),T=tin(b);if(T.features=T.features.filter(function(R){var U=R.geometry.coordinates[0][0],H=R.geometry.coordinates[0][1],N=R.geometry.coordinates[0][2],Q=distance(U,H,A),K=distance(H,N,A),ae=distance(U,N,A);return Q<=y&&K<=y&&ae<=y}),T.features.length<1)return null;var P=dissolve(T);return P.coordinates.length===1&&(P.coordinates=P.coordinates[0],P.type="Polygon"),feature(P)}function mr(l){var A=[],y={};return featureEach(l,function(b){if(b.geometry){var T=b.geometry.coordinates.join("-");Object.prototype.hasOwnProperty.call(y,T)||(A.push(b),y[T]=!0)}}),featureCollection(A)}var vt=null,Tt=C(65510);function Qt(l,A,y,b){var T=rbush(6),P=A.features.map(function(R){var U;return{minX:R.geometry.coordinates[0],minY:R.geometry.coordinates[1],maxX:R.geometry.coordinates[0],maxY:R.geometry.coordinates[1],property:(U=R.properties)===null||U===void 0?void 0:U[y]}});return T.load(P),l.features.forEach(function(R){R.properties||(R.properties={});var U=turfbbox(R),H=T.search({minX:U[0],minY:U[1],maxX:U[2],maxY:U[3]}),N=[];H.forEach(function(Q){booleanPointInPolygon([Q.minX,Q.minY],R)&&N.push(Q.property)}),R.properties[b]=N}),l}var Er=null;function Dr(l,A){if(A=A||{},!isObject(A))throw new Error("options is invalid");var y=A.mutate;if(!l)throw new Error("geojson is required");return(y===!1||y===void 0)&&(l=clone(l)),coordEach(l,function(b){var T=b[0],P=b[1];b[0]=P,b[1]=T}),l}var Yr=null;function an(l,A){A===void 0&&(A={});var y=typeof A=="object"?A.mutate:A;if(!l)throw new Error("geojson is required");var b=getType(l),T=[];switch(b){case"LineString":T=Br(l);break;case"MultiLineString":case"Polygon":getCoords(l).forEach(function(R){T.push(Br(R))});break;case"MultiPolygon":getCoords(l).forEach(function(R){var U=[];R.forEach(function(H){U.push(Br(H))}),T.push(U)});break;case"Point":return l;case"MultiPoint":var P={};getCoords(l).forEach(function(R){var U=R.join("-");Object.prototype.hasOwnProperty.call(P,U)||(T.push(R),P[U]=!0)});break;default:throw new Error(b+" geometry not supported")}return l.coordinates?y===!0?(l.coordinates=T,l):{type:b,coordinates:T}:y===!0?(l.geometry.coordinates=T,l):feature({type:b,coordinates:T},l.properties,{bbox:l.bbox,id:l.id})}function Br(l){var A=getCoords(l);if(A.length===2&&!en(A[0],A[1]))return A;var y=[],b=A.length-1,T=y.length;y.push(A[0]);for(var P=1;P<b;P++){var R=y[y.length-1];A[P][0]===R[0]&&A[P][1]===R[1]||(y.push(A[P]),T=y.length,T>2&&Zn(y[T-3],y[T-1],y[T-2])&&y.splice(y.length-2,1))}if(y.push(A[A.length-1]),T=y.length,en(A[0],A[A.length-1])&&T<4)throw new Error("invalid polygon");return Zn(y[T-3],y[T-1],y[T-2])&&y.splice(y.length-2,1),y}function en(l,A){return l[0]===A[0]&&l[1]===A[1]}function Zn(l,A,y){var b=y[0],T=y[1],P=l[0],R=l[1],U=A[0],H=A[1],N=b-P,Q=T-R,K=U-P,ae=H-R,ge=N*ae-Q*K;return ge!==0?!1:Math.abs(K)>=Math.abs(ae)?K>0?P<=b&&b<=U:U<=b&&b<=P:ae>0?R<=T&&T<=H:H<=T&&T<=R}var zn=null;function fi(l,A){var y=l.x-A.x,b=l.y-A.y;return y*y+b*b}function la(l,A,y){var b=A.x,T=A.y,P=y.x-b,R=y.y-T;if(P!==0||R!==0){var U=((l.x-b)*P+(l.y-T)*R)/(P*P+R*R);U>1?(b=y.x,T=y.y):U>0&&(b+=P*U,T+=R*U)}return P=l.x-b,R=l.y-T,P*P+R*R}function Oa(l,A){for(var y=l[0],b=[y],T,P=1,R=l.length;P<R;P++)T=l[P],fi(T,y)>A&&(b.push(T),y=T);return y!==T&&b.push(T),b}function Gr(l,A,y,b,T){for(var P=b,R,U=A+1;U<y;U++){var H=la(l[U],l[A],l[y]);H>P&&(R=U,P=H)}P>b&&(R-A>1&&Gr(l,A,R,b,T),T.push(l[R]),y-R>1&&Gr(l,R,y,b,T))}function Ns(l,A){var y=l.length-1,b=[l[0]];return Gr(l,0,y,A,b),b.push(l[y]),b}function Co(l,A,y){if(l.length<=2)return l;var b=A!==void 0?A*A:1;return l=y?l:Oa(l,b),l=Ns(l,b),l}function _n(l,A){if(A=A||{},!isObject(A))throw new Error("options is invalid");var y=A.tolerance!==void 0?A.tolerance:1,b=A.highQuality||!1,T=A.mutate||!1;if(!l)throw new Error("geojson is required");if(y&&y<0)throw new Error("invalid tolerance");return T!==!0&&(l=clone(l)),geomEach(l,function(P){xs(P,y,b)}),l}function xs(l,A,y){var b=l.type;if(b==="Point"||b==="MultiPoint")return l;cleanCoords(l,!0);var T=l.coordinates;switch(b){case"LineString":l.coordinates=go(T,A,y);break;case"MultiLineString":l.coordinates=T.map(function(P){return go(P,A,y)});break;case"Polygon":l.coordinates=Fs(T,A,y);break;case"MultiPolygon":l.coordinates=T.map(function(P){return Fs(P,A,y)})}return l}function go(l,A,y){return Co(l.map(function(b){return{x:b[0],y:b[1],z:b[2]}}),A,y).map(function(b){return b.z?[b.x,b.y,b.z]:[b.x,b.y]})}function Fs(l,A,y){return l.map(function(b){var T=b.map(function(R){return{x:R[0],y:R[1]}});if(T.length<4)throw new Error("invalid polygon");for(var P=Co(T,A,y).map(function(R){return[R.x,R.y]});!Po(P);)A-=A*.01,P=Co(T,A,y).map(function(R){return[R.x,R.y]});return(P[P.length-1][0]!==P[0][0]||P[P.length-1][1]!==P[0][1])&&P.push(P[0]),P})}function Po(l){return l.length<3?!1:!(l.length===3&&l[2][0]===l[0][0]&&l[2][1]===l[0][1])}var hl=null,yu=function(){function l(A){this.points=A.points||[],this.duration=A.duration||1e4,this.sharpness=A.sharpness||.85,this.centers=[],this.controls=[],this.stepLength=A.stepLength||60,this.length=this.points.length,this.delay=0;for(var y=0;y<this.length;y++)this.points[y].z=this.points[y].z||0;for(var y=0;y<this.length-1;y++){var b=this.points[y],T=this.points[y+1];this.centers.push({x:(b.x+T.x)/2,y:(b.y+T.y)/2,z:(b.z+T.z)/2})}this.controls.push([this.points[0],this.points[0]]);for(var y=0;y<this.centers.length-1;y++){var P=this.points[y+1].x-(this.centers[y].x+this.centers[y+1].x)/2,R=this.points[y+1].y-(this.centers[y].y+this.centers[y+1].y)/2,U=this.points[y+1].z-(this.centers[y].y+this.centers[y+1].z)/2;this.controls.push([{x:(1-this.sharpness)*this.points[y+1].x+this.sharpness*(this.centers[y].x+P),y:(1-this.sharpness)*this.points[y+1].y+this.sharpness*(this.centers[y].y+R),z:(1-this.sharpness)*this.points[y+1].z+this.sharpness*(this.centers[y].z+U)},{x:(1-this.sharpness)*this.points[y+1].x+this.sharpness*(this.centers[y+1].x+P),y:(1-this.sharpness)*this.points[y+1].y+this.sharpness*(this.centers[y+1].y+R),z:(1-this.sharpness)*this.points[y+1].z+this.sharpness*(this.centers[y+1].z+U)}])}return this.controls.push([this.points[this.length-1],this.points[this.length-1]]),this.steps=this.cacheSteps(this.stepLength),this}return l.prototype.cacheSteps=function(A){var y=[],b=this.pos(0);y.push(0);for(var T=0;T<this.duration;T+=10){var P=this.pos(T),R=Math.sqrt((P.x-b.x)*(P.x-b.x)+(P.y-b.y)*(P.y-b.y)+(P.z-b.z)*(P.z-b.z));R>A&&(y.push(T),b=P)}return y},l.prototype.vector=function(A){var y=this.pos(A+10),b=this.pos(A-10);return{angle:180*Math.atan2(y.y-b.y,y.x-b.x)/3.14,speed:Math.sqrt((b.x-y.x)*(b.x-y.x)+(b.y-y.y)*(b.y-y.y)+(b.z-y.z)*(b.z-y.z))}},l.prototype.pos=function(A){var y=A-this.delay;y<0&&(y=0),y>this.duration&&(y=this.duration-1);var b=y/this.duration;if(b>=1)return this.points[this.length-1];var T=Math.floor((this.points.length-1)*b),P=(this.length-1)*b-T;return cs(P,this.points[T],this.controls[T][1],this.controls[T+1][0],this.points[T+1])},l}(),Es=null;function cs(l,A,y,b,T){var P=Ou(l),R={x:T.x*P[0]+b.x*P[1]+y.x*P[2]+A.x*P[3],y:T.y*P[0]+b.y*P[1]+y.y*P[2]+A.y*P[3],z:T.z*P[0]+b.z*P[1]+y.z*P[2]+A.z*P[3]};return R}function Ou(l){var A=l*l,y=A*l;return[y,3*A*(1-l),3*l*(1-l)*(1-l),(1-l)*(1-l)*(1-l)]}function Al(l,A){A===void 0&&(A={});for(var y=A.resolution||1e4,b=A.sharpness||.85,T=[],P=getGeom(l).coordinates.map(function(N){return{x:N[0],y:N[1]}}),R=new Spline({duration:y,points:P,sharpness:b}),U=function(N){var Q=R.pos(N);Math.floor(N/100)%2===0&&T.push([Q.x,Q.y])},H=0;H<R.duration;H+=10)U(H);return U(R.duration),lineString(T,A.properties)}var ga=null;function Zi(l,A,y,b){return l=clone(l),A=clone(A),featureEach(l,function(T){T.properties||(T.properties={}),featureEach(A,function(P){T.properties[b]===void 0&&booleanPointInPolygon(T,P)&&(T.properties[b]=P.properties[y])})}),l}var Bs=null;function no(l,A){if(!l)throw new Error("featurecollection is required");if(A==null)throw new Error("num is required");if(typeof A!="number")throw new Error("num must be a number");var y=featureCollection(es(l.features,A));return y}function es(l,A){for(var y=l.slice(0),b=l.length,T=b-A,P,R;b-- >T;)R=Math.floor((b+1)*Math.random()),P=y[R],y[R]=y[b],y[b]=P;return y.slice(T)}var Lo=null,Ni=C(95);function io(l){return(0,Ni.Z)((0,L.Z)(l))}var bs=io;function $o(l){var A=l[0],y=l[1],b=l[2],T=l[3],P=distance(l.slice(0,2),[b,y]),R=distance(l.slice(0,2),[A,T]);if(P>=R){var U=(y+T)/2;return[A,U-(b-A)/2,b,U+(b-A)/2]}else{var H=(A+b)/2;return[H-(T-y)/2,y,H+(T-y)/2,T]}}var Ru=null;function Ca(l,A,y,b){b===void 0&&(b={});var T=getCoord(l),P=degreesToRadians(T[0]),R=degreesToRadians(T[1]),U=degreesToRadians(y),H=lengthToRadians(A,b.units),N=Math.asin(Math.sin(R)*Math.cos(H)+Math.cos(R)*Math.sin(H)*Math.cos(U)),Q=P+Math.atan2(Math.sin(U)*Math.sin(H)*Math.cos(R),Math.cos(H)-Math.sin(R)*Math.sin(N)),K=radiansToDegrees(Q),ae=radiansToDegrees(N);return point([K,ae],b.properties)}function xa(l,A,y){y===void 0&&(y={});for(var b=y.steps||64,T=y.properties?y.properties:!Array.isArray(l)&&l.type==="Feature"&&l.properties?l.properties:{},P=[],R=0;R<b;R++)P.push(destination(l,A,R*-360/b,y).geometry.coordinates);return P.push(P[0]),polygon([P],T)}var Ku=null;function uo(l,A,y){if(y===void 0&&(y={}),y.final===!0)return eu(l,A);var b=getCoord(l),T=getCoord(A),P=degreesToRadians(b[0]),R=degreesToRadians(T[0]),U=degreesToRadians(b[1]),H=degreesToRadians(T[1]),N=Math.sin(R-P)*Math.cos(H),Q=Math.cos(U)*Math.sin(H)-Math.sin(U)*Math.cos(H)*Math.cos(R-P);return radiansToDegrees(Math.atan2(N,Q))}function eu(l,A){var y=uo(A,l);return y=(y+180)%360,y}function wa(l,A){var y=distance(l,A),b=bearing(l,A),T=destination(l,y/2,b);return T}var lu=null;function pr(l,A){A===void 0&&(A={});var y=bbox(l),b=(y[0]+y[2])/2,T=(y[1]+y[3])/2;return point([b,T],A.properties,A)}var vn=null;function lo(l,A){A===void 0&&(A={});var y=0,b=0,T=0;return coordEach(l,function(P){y+=P[0],b+=P[1],T++},!0),point([y/T,b/T],A.properties)}var tu=null;function ru(l,A){switch(A===void 0&&(A={}),getType(l)){case"Point":return point(getCoord(l),A.properties);case"Polygon":var y=[];coordEach(l,function(Ht){y.push(Ht)});var b=centroid(l,{properties:A.properties}),T=b.geometry.coordinates,P=0,R=0,U=0,H,N,Q,K,ae,ge,pt,at,Nt=y.map(function(Ht){return[Ht[0]-T[0],Ht[1]-T[1]]});for(H=0;H<y.length-1;H++)N=Nt[H],K=N[0],ge=N[1],Q=Nt[H+1],ae=Q[0],pt=Q[1],at=K*pt-ae*ge,U+=at,P+=(K+ae)*at,R+=(ge+pt)*at;if(U===0)return b;var dt=U*.5,Ke=1/(6*dt);return point([T[0]+Ke*P,T[1]+Ke*R],A.properties);default:var ht=convex(l);return ht?ru(ht,{properties:A.properties}):centroid(l,{properties:A.properties})}}var Ss=null;function Zs(l){var A={MultiPoint:{coordinates:[],properties:[]},MultiLineString:{coordinates:[],properties:[]},MultiPolygon:{coordinates:[],properties:[]}};return featureEach(l,function(y){var b,T,P,R;switch((R=y.geometry)===null||R===void 0?void 0:R.type){case"Point":A.MultiPoint.coordinates.push(y.geometry.coordinates),A.MultiPoint.properties.push(y.properties);break;case"MultiPoint":(b=A.MultiPoint.coordinates).push.apply(b,y.geometry.coordinates),A.MultiPoint.properties.push(y.properties);break;case"LineString":A.MultiLineString.coordinates.push(y.geometry.coordinates),A.MultiLineString.properties.push(y.properties);break;case"MultiLineString":(T=A.MultiLineString.coordinates).push.apply(T,y.geometry.coordinates),A.MultiLineString.properties.push(y.properties);break;case"Polygon":A.MultiPolygon.coordinates.push(y.geometry.coordinates),A.MultiPolygon.properties.push(y.properties);break;case"MultiPolygon":(P=A.MultiPolygon.coordinates).push.apply(P,y.geometry.coordinates),A.MultiPolygon.properties.push(y.properties);break;default:break}}),featureCollection(Object.keys(A).filter(function(y){return A[y].coordinates.length}).sort().map(function(y){var b={type:y,coordinates:A[y].coordinates},T={collectedProperties:A[y].properties};return feature(b,T)}))}var Va=null;function Xc(l){var A=[];return l.type==="FeatureCollection"?featureEach(l,function(y){coordEach(y,function(b){A.push(point(b,y.properties))})}):coordEach(l,function(y){A.push(point(y,l.properties))}),featureCollection(A)}var Cs=null,ts=C(9187);function Pl(l){if(!l.geometry||l.geometry.type!=="Polygon"&&l.geometry.type!=="MultiPolygon")throw new Error("input must be a Polygon or MultiPolygon");var A={type:"FeatureCollection",features:[]};return l.geometry.type==="Polygon"?A.features=zi(l.geometry.coordinates):l.geometry.coordinates.forEach(function(y){A.features=A.features.concat(zi(y))}),A}function zi(l){var A=Ll(l),y=2,b=earcut(A.vertices,A.holes,y),T=[],P=[];b.forEach(function(H,N){var Q=b[N];P.push([A.vertices[Q*y],A.vertices[Q*y+1]])});for(var R=0;R<P.length;R+=3){var U=P.slice(R,R+3);U.push(P[R]),T.push(polygon([U]))}return T}function Ll(l){for(var A=l[0][0].length,y={vertices:[],holes:[],dimensions:A},b=0,T=0;T<l.length;T++){for(var P=0;P<l[T].length;P++)for(var R=0;R<A;R++)y.vertices.push(l[T][P][R]);T>0&&(b+=l[T-1].length,y.holes.push(b))}return y}var Oo=null;function pl(l,A){if(!l)throw new Error("targetPoint is required");if(!A)throw new Error("points is required");var y,b=1/0,T=0;return featureEach(A,function(P,R){var U=distance(l,P);U<b&&(T=R,b=U)}),y=clone(A.features[T]),y.properties.featureIndex=T,y.properties.distanceToPoint=b,y}var Ai=null;function _u(l){if(!l)throw new Error("geojson is required");var A=[];return flattenEach(l,function(y){gf(y,A)}),featureCollection(A)}function gf(l,A){var y=[],b=l.geometry;if(b!==null){switch(b.type){case"Polygon":y=getCoords(b);break;case"LineString":y=[getCoords(b)]}y.forEach(function(T){var P=Du(T,l.properties);P.forEach(function(R){R.id=A.length,A.push(R)})})}}function Du(l,A){var y=[];return l.reduce(function(b,T){var P=lineString([b,T],A);return P.bbox=rs(b,T),y.push(P),T}),y}function rs(l,A){var y=l[0],b=l[1],T=A[0],P=A[1],R=y<T?y:T,U=b<P?b:P,H=y>T?y:T,N=b>P?b:P;return[R,U,H,N]}var Mt=null,He=C(51787);function Gt(l,A){var y={},b=[];if(l.type==="LineString"&&(l=feature(l)),A.type==="LineString"&&(A=feature(A)),l.type==="Feature"&&A.type==="Feature"&&l.geometry!==null&&A.geometry!==null&&l.geometry.type==="LineString"&&A.geometry.type==="LineString"&&l.geometry.coordinates.length===2&&A.geometry.coordinates.length===2){var T=Ae(l,A);return T&&b.push(T),featureCollection(b)}var P=rbush();return P.load(lineSegment(A)),featureEach(lineSegment(l),function(R){featureEach(P.search(R),function(U){var H=Ae(R,U);if(H){var N=getCoords(H).join(",");y[N]||(y[N]=!0,b.push(H))}})}),featureCollection(b)}function Ae(l,A){var y=getCoords(l),b=getCoords(A);if(y.length!==2)throw new Error("<intersects> line1 must only contain 2 coordinates");if(b.length!==2)throw new Error("<intersects> line2 must only contain 2 coordinates");var T=y[0][0],P=y[0][1],R=y[1][0],U=y[1][1],H=b[0][0],N=b[0][1],Q=b[1][0],K=b[1][1],ae=(K-N)*(R-T)-(Q-H)*(U-P),ge=(Q-H)*(P-N)-(K-N)*(T-H),pt=(R-T)*(P-N)-(U-P)*(T-H);if(ae===0)return null;var at=ge/ae,Nt=pt/ae;if(at>=0&&at<=1&&Nt>=0&&Nt<=1){var dt=T+at*(R-T),Ke=P+at*(U-P);return point([dt,Ke])}return null}var Be=null;function We(l,A,y){y===void 0&&(y={});var b=point([1/0,1/0],{dist:1/0}),T=0;return flattenEach(l,function(P){for(var R=getCoords(P),U=0;U<R.length-1;U++){var H=point(R[U]);H.properties.dist=distance(A,H,y);var N=point(R[U+1]);N.properties.dist=distance(A,N,y);var Q=distance(H,N,y),K=Math.max(H.properties.dist,N.properties.dist),ae=bearing(H,N),ge=destination(A,K,ae+90,y),pt=destination(A,K,ae-90,y),at=lineIntersects(lineString([ge.geometry.coordinates,pt.geometry.coordinates]),lineString([H.geometry.coordinates,N.geometry.coordinates])),Nt=null;at.features.length>0&&(Nt=at.features[0],Nt.properties.dist=distance(A,Nt,y),Nt.properties.location=T+distance(H,Nt,y)),H.properties.dist<b.properties.dist&&(b=H,b.properties.index=U,b.properties.location=T),N.properties.dist<b.properties.dist&&(b=N,b.properties.index=U+1,b.properties.location=T+Q),Nt&&Nt.properties.dist<b.properties.dist&&(b=Nt,b.properties.index=U),T+=Q}}),b}var zt=null;function hr(l,A,y){y===void 0&&(y={});var b=getCoord(l),T=getCoord(A);T[0]+=T[0]-b[0]>180?-360:b[0]-T[0]>180?360:0;var P=Pr(b,T),R=convertLength(P,"meters",y.units);return R}function Pr(l,A,y){y=y===void 0?earthRadius:Number(y);var b=y,T=l[1]*Math.PI/180,P=A[1]*Math.PI/180,R=P-T,U=Math.abs(A[0]-l[0])*Math.PI/180;U>Math.PI&&(U-=2*Math.PI);var H=Math.log(Math.tan(P/2+Math.PI/4)/Math.tan(T/2+Math.PI/4)),N=Math.abs(H)>1e-11?R/H:Math.cos(T),Q=Math.sqrt(R*R+N*N*U*U),K=Q*b;return K}var dn=null;function Mn(l,A,y){if(y===void 0&&(y={}),y.method||(y.method="geodesic"),y.units||(y.units="kilometers"),!l)throw new Error("pt is required");if(Array.isArray(l)?l=point(l):l.type==="Point"?l=feature(l):featureOf(l,"Point","point"),!A)throw new Error("line is required");Array.isArray(A)?A=lineString(A):A.type==="LineString"?A=feature(A):featureOf(A,"LineString","line");var b=1/0,T=l.geometry.coordinates;return segmentEach(A,function(P){var R=P.geometry.coordinates[0],U=P.geometry.coordinates[1],H=vi(T,R,U,y);H<b&&(b=H)}),convertLength(b,"degrees",y.units)}function vi(l,A,y,b){var T=[y[0]-A[0],y[1]-A[1]],P=[l[0]-A[0],l[1]-A[1]],R=co(P,T);if(R<=0)return ns(l,A,{method:b.method,units:"degrees"});var U=co(T,T);if(U<=R)return ns(l,y,{method:b.method,units:"degrees"});var H=R/U,N=[A[0]+H*T[0],A[1]+H*T[1]];return ns(l,N,{method:b.method,units:"degrees"})}function co(l,A){return l[0]*A[0]+l[1]*A[1]}function ns(l,A,y){return y.method==="planar"?getPlanarDistance(l,A,y):getDistance(l,A,y)}var ws=null;function Qc(l,A,y){y===void 0&&(y={});var b=y.units,T=y.properties||{},P=zs(l);if(!P.features.length)throw new Error("points must contain features");if(!A)throw new Error("line is required");if(getType(A)!=="LineString")throw new Error("line must be a LineString");var R=1/0,U=null;return featureEach(P,function(H){var N=pointToLineDistance(H,A,{units:b});N<R&&(R=N,U=H)}),U&&(U.properties=objectAssign({dist:R},U.properties,T)),U}function zs(l){var A=[],y=l.geometry?l.geometry.type:l.type;switch(y){case"GeometryCollection":return geomEach(l,function(b){b.type==="Point"&&A.push({type:"Feature",properties:{},geometry:b})}),{type:"FeatureCollection",features:A};case"FeatureCollection":return l.features=l.features.filter(function(b){return b.geometry.type==="Point"}),l;default:throw new Error("points must be a Point Collection")}}var ca=null;function ec(l,A){var y=getCoord(l),b=getGeom(A),T=b.coordinates,P=T[0];if(P.length<4)throw new Error("OuterRing of a Polygon must have 4 or more Positions.");var R=A.properties||{},U=R.a,H=R.b,N=R.c,Q=y[0],K=y[1],ae=P[0][0],ge=P[0][1],pt=U!==void 0?U:P[0][2],at=P[1][0],Nt=P[1][1],dt=H!==void 0?H:P[1][2],Ke=P[2][0],ht=P[2][1],Ht=N!==void 0?N:P[2][2],Bt=(Ht*(Q-ae)*(K-Nt)+pt*(Q-at)*(K-ht)+dt*(Q-Ke)*(K-ge)-dt*(Q-ae)*(K-ht)-Ht*(Q-at)*(K-ge)-pt*(Q-Ke)*(K-Nt))/((Q-ae)*(K-Nt)+(Q-at)*(K-ht)+(Q-Ke)*(K-ge)-(Q-ae)*(K-ht)-(Q-at)*(K-ge)-(Q-Ke)*(K-Nt));return Bt}var qa=null;function mf(l){var A,y,b={type:"FeatureCollection",features:[]};if(l.type==="Feature"?y=l.geometry:y=l,y.type==="LineString")A=[y.coordinates];else if(y.type==="MultiLineString")A=y.coordinates;else if(y.type==="MultiPolygon")A=[].concat.apply([],y.coordinates);else if(y.type==="Polygon")A=y.coordinates;else throw new Error("Input must be a LineString, MultiLineString, Polygon, or MultiPolygon Feature or Geometry");return A.forEach(function(T){A.forEach(function(P){for(var R=0;R<T.length-1;R++)for(var U=R;U<P.length-1;U++)if(!(T===P&&(Math.abs(R-U)===1||R===0&&U===T.length-2&&T[R][0]===T[T.length-1][0]&&T[R][1]===T[T.length-1][1]))){var H=dl(T[R][0],T[R][1],T[R+1][0],T[R+1][1],P[U][0],P[U][1],P[U+1][0],P[U+1][1]);H&&b.features.push(point([H[0],H[1]]))}})}),b}function dl(l,A,y,b,T,P,R,U){var H,N,Q,K,ae,ge={x:null,y:null,onLine1:!1,onLine2:!1};return H=(U-P)*(y-l)-(R-T)*(b-A),H===0?ge.x!==null&&ge.y!==null?ge:!1:(N=A-P,Q=l-T,K=(R-T)*N-(U-P)*Q,ae=(y-l)*N-(b-A)*Q,N=K/H,Q=ae/H,ge.x=l+N*(y-l),ge.y=A+N*(b-A),N>=0&&N<=1&&(ge.onLine1=!0),Q>=0&&Q<=1&&(ge.onLine2=!0),ge.onLine1&&ge.onLine2?[ge.x,ge.y]:!1)}function Ta(l){for(var A=In(l),y=centroid(A),b=!1,T=0;!b&&T<A.features.length;){var P=A.features[T].geometry,R,U,H,N,Q,K,ae,ge=!1;if(P.type==="Point")y.geometry.coordinates[0]===P.coordinates[0]&&y.geometry.coordinates[1]===P.coordinates[1]&&(b=!0);else if(P.type==="MultiPoint"){var pt=!1;for(ae=0;!pt&&ae<P.coordinates.length;)y.geometry.coordinates[0]===P.coordinates[ae][0]&&y.geometry.coordinates[1]===P.coordinates[ae][1]&&(b=!0,pt=!0),ae++}else if(P.type==="LineString")for(ae=0;!ge&&ae<P.coordinates.length-1;)R=y.geometry.coordinates[0],U=y.geometry.coordinates[1],H=P.coordinates[ae][0],N=P.coordinates[ae][1],Q=P.coordinates[ae+1][0],K=P.coordinates[ae+1][1],Ju(R,U,H,N,Q,K)&&(ge=!0,b=!0),ae++;else if(P.type==="MultiLineString")for(var at=0;at<P.coordinates.length;){ge=!1,ae=0;for(var Nt=P.coordinates[at];!ge&&ae<Nt.length-1;)R=y.geometry.coordinates[0],U=y.geometry.coordinates[1],H=Nt[ae][0],N=Nt[ae][1],Q=Nt[ae+1][0],K=Nt[ae+1][1],Ju(R,U,H,N,Q,K)&&(ge=!0,b=!0),ae++;at++}else(P.type==="Polygon"||P.type==="MultiPolygon")&&booleanPointInPolygon(y,P)&&(b=!0);T++}if(b)return y;var dt=featureCollection([]);for(T=0;T<A.features.length;T++)dt.features=dt.features.concat(explode(A.features[T]).features);return point(nearestPoint(y,dt).geometry.coordinates)}function In(l){return l.type!=="FeatureCollection"?l.type!=="Feature"?featureCollection([feature(l)]):featureCollection([l]):l}function Ju(l,A,y,b,T,P){var R=Math.sqrt((T-y)*(T-y)+(P-b)*(P-b)),U=Math.sqrt((l-y)*(l-y)+(A-b)*(A-b)),H=Math.sqrt((T-l)*(T-l)+(P-A)*(P-A));return R===U+H}var Us=null,cu=6378137;function fu(l){return geomReduce(l,function(A,y){return A+xu(y)},0)}function xu(l){var A=0,y;switch(l.type){case"Polygon":return ni(l.coordinates);case"MultiPolygon":for(y=0;y<l.coordinates.length;y++)A+=ni(l.coordinates[y]);return A;case"Point":case"MultiPoint":case"LineString":case"MultiLineString":return 0}return 0}function ni(l){var A=0;if(l&&l.length>0){A+=Math.abs(Ro(l[0]));for(var y=1;y<l.length;y++)A-=Math.abs(Ro(l[y]))}return A}function Ro(l){var A,y,b,T,P,R,U,H=0,N=l.length;if(N>2){for(U=0;U<N;U++)U===N-2?(T=N-2,P=N-1,R=0):U===N-1?(T=N-1,P=0,R=1):(T=U,P=U+1,R=U+2),A=l[T],y=l[P],b=l[R],H+=(Ha(b[0])-Ha(A[0]))*Math.sin(Ha(y[1]));H=H*cu*cu/2}return H}function Ha(l){return l*Math.PI/180}function Ra(l,A,y){y===void 0&&(y={});for(var b=getGeom(l),T=b.coordinates,P=0,R=0;R<T.length&&!(A>=P&&R===T.length-1);R++)if(P>=A){var U=A-P;if(U){var H=bearing(T[R],T[R-1])-180,N=destination(T[R],U,H,y);return N}else return point(T[R])}else P+=measureDistance(T[R],T[R+1],y);return point(T[T.length-1])}function mo(l,A){return A===void 0&&(A={}),segmentReduce(l,function(y,b){var T=b.geometry.coordinates;return y+distance(T[0],T[1],A)},0)}function hu(l,A,y){var b=getCoords(y);if(getType(y)!=="LineString")throw new Error("line must be a LineString");var T=nearestPointOnLine(y,l),P=nearestPointOnLine(y,A),R;T.properties.index<=P.properties.index?R=[T,P]:R=[P,T];for(var U=[R[0].geometry.coordinates],H=R[0].properties.index+1;H<R[1].properties.index+1;H++)U.push(b[H]);return U.push(R[1].geometry.coordinates),lineString(U,y.properties)}var yf=null;function Ol(l,A,y,b){if(b=b||{},!isObject(b))throw new Error("options is invalid");var T,P=[];if(l.type==="Feature")T=l.geometry.coordinates;else if(l.type==="LineString")T=l.coordinates;else throw new Error("input must be a LineString Feature or Geometry");for(var R=T.length,U=0,H,N,Q,K=0;K<T.length&&!(A>=U&&K===T.length-1);K++){if(U>A&&P.length===0){if(H=A-U,!H)return P.push(T[K]),lineString(P);N=bearing(T[K],T[K-1])-180,Q=destination(T[K],H,N,b),P.push(Q.geometry.coordinates)}if(U>=y)return H=y-U,H?(N=bearing(T[K],T[K-1])-180,Q=destination(T[K],H,N,b),P.push(Q.geometry.coordinates),lineString(P)):(P.push(T[K]),lineString(P));if(U>=A&&P.push(T[K]),K===T.length-1)return lineString(P);U+=distance(T[K],T[K+1],b)}if(U<A&&T.length===R)throw new Error("Start position is beyond line");var ae=T[T.length-1];return lineString([ae,ae])}var qc=null;function _f(l,A,y){y===void 0&&(y={});for(var b=getCoord(l),T=getCoords(A),P=0;P<T.length-1;P++){var R=!1;if(y.ignoreEndVertices&&(P===0&&(R="start"),P===T.length-2&&(R="end"),P===0&&P+1===T.length-1&&(R="both")),Yo(T[P],T[P+1],b,R,typeof y.epsilon=="undefined"?null:y.epsilon))return!0}return!1}function Yo(l,A,y,b,T){var P=y[0],R=y[1],U=l[0],H=l[1],N=A[0],Q=A[1],K=y[0]-U,ae=y[1]-H,ge=N-U,pt=Q-H,at=K*pt-ae*ge;if(T!==null){if(Math.abs(at)>T)return!1}else if(at!==0)return!1;if(b){if(b==="start")return Math.abs(ge)>=Math.abs(pt)?ge>0?U<P&&P<=N:N<=P&&P<U:pt>0?H<R&&R<=Q:Q<=R&&R<H;if(b==="end")return Math.abs(ge)>=Math.abs(pt)?ge>0?U<=P&&P<N:N<P&&P<=U:pt>0?H<=R&&R<Q:Q<R&&R<=H;if(b==="both")return Math.abs(ge)>=Math.abs(pt)?ge>0?U<P&&P<N:N<P&&P<U:pt>0?H<R&&R<Q:Q<R&&R<H}else return Math.abs(ge)>=Math.abs(pt)?ge>0?U<=P&&P<=N:N<=P&&P<=U:pt>0?H<=R&&R<=Q:Q<=R&&R<=H;return!1}var Gs=null;function Do(l,A){var y=getGeom(l),b=getGeom(A),T=y.type,P=b.type;switch(T){case"Point":switch(P){case"MultiPoint":return fa(y,b);case"LineString":return booleanPointOnLine(y,b,{ignoreEndVertices:!0});case"Polygon":case"MultiPolygon":return booleanPointInPolygon(y,b,{ignoreBoundary:!0});default:throw new Error("feature2 "+P+" geometry not supported")}case"MultiPoint":switch(P){case"MultiPoint":return is(y,b);case"LineString":return Rl(y,b);case"Polygon":case"MultiPolygon":return Ma(y,b);default:throw new Error("feature2 "+P+" geometry not supported")}case"LineString":switch(P){case"LineString":return Sn(y,b);case"Polygon":case"MultiPolygon":return vl(y,b);default:throw new Error("feature2 "+P+" geometry not supported")}case"Polygon":switch(P){case"Polygon":case"MultiPolygon":return tc(y,b);default:throw new Error("feature2 "+P+" geometry not supported")}default:throw new Error("feature1 "+T+" geometry not supported")}}function fa(l,A){var y,b=!1;for(y=0;y<A.coordinates.length;y++)if(fs(A.coordinates[y],l.coordinates)){b=!0;break}return b}function is(l,A){for(var y=0;y<l.coordinates.length;y++){for(var b=!1,T=0;T<A.coordinates.length;T++)fs(l.coordinates[y],A.coordinates[T])&&(b=!0);if(!b)return!1}return!0}function Rl(l,A){for(var y=!1,b=0;b<l.coordinates.length;b++){if(!booleanPointOnLine(l.coordinates[b],A))return!1;y||(y=booleanPointOnLine(l.coordinates[b],A,{ignoreEndVertices:!0}))}return y}function Ma(l,A){for(var y=!0,b=!1,T=!1,P=0;P<l.coordinates.length;P++){if(T=booleanPointInPolygon(l.coordinates[1],A),!T){y=!1;break}b||(T=booleanPointInPolygon(l.coordinates[1],A,{ignoreBoundary:!0}))}return y&&T}function Sn(l,A){for(var y=0;y<l.coordinates.length;y++)if(!booleanPointOnLine(l.coordinates[y],A))return!1;return!0}function vl(l,A){var y=calcBbox(A),b=calcBbox(l);if(!Ka(y,b))return!1;for(var T=!1,P=0;P<l.coordinates.length-1;P++){if(!booleanPointInPolygon(l.coordinates[P],A))return!1;if(T||(T=booleanPointInPolygon(l.coordinates[P],A,{ignoreBoundary:!0})),!T){var R=gl(l.coordinates[P],l.coordinates[P+1]);T=booleanPointInPolygon(R,A,{ignoreBoundary:!0})}}return T}function tc(l,A){var y=calcBbox(l),b=calcBbox(A);if(!Ka(b,y))return!1;for(var T=0;T<l.coordinates[0].length;T++)if(!booleanPointInPolygon(l.coordinates[0][T],A))return!1;return!0}function Ka(l,A){return!(l[0]>A[0]||l[2]<A[2]||l[1]>A[1]||l[3]<A[3])}function fs(l,A){return l[0]===A[0]&&l[1]===A[1]}function gl(l,A){return[(l[0]+A[0])/2,(l[1]+A[1])/2]}var gc=null;function mc(l,A,y){y===void 0&&(y={}),y.mask&&!y.units&&(y.units="kilometers");for(var b=[],T=l[0],P=l[1],R=l[2],U=l[3],H=A/distance([T,P],[R,P],y),N=H*(R-T),Q=A/distance([T,P],[T,U],y),K=Q*(U-P),ae=R-T,ge=U-P,pt=Math.floor(ae/N),at=Math.floor(ge/K),Nt=(ae-pt*N)/2,dt=(ge-at*K)/2,Ke=T+Nt;Ke<=R;){for(var ht=P+dt;ht<=U;){var Ht=point([Ke,ht],y.properties);y.mask?within(Ht,y.mask)&&b.push(Ht):b.push(Ht),ht+=K}Ke+=N}return featureCollection(b)}var xf=null;function ea(l,A){A===void 0&&(A={});var y=A.precision,b=A.coordinates,T=A.mutate;if(y=y==null||isNaN(y)?6:y,b=b==null||isNaN(b)?3:b,!l)throw new Error("<geojson> is required");if(typeof y!="number")throw new Error("<precision> must be a number");if(typeof b!="number")throw new Error("<coordinates> must be a number");(T===!1||T===void 0)&&(l=JSON.parse(JSON.stringify(l)));var P=Math.pow(10,y);return coordEach(l,function(R){ku(R,P,b)}),l}function ku(l,A,y){l.length>y&&l.splice(y,l.length);for(var b=0;b<l.length;b++)l[b]=Math.round(l[b]*A)/A;return l}var na=null;function Za(l){if(!l)throw new Error("geojson is required");var A=[];return flattenEach(l,function(y){A.push(y)}),featureCollection(A)}var ko=null;function Nf(l,A,y){if(y=y||{},!isObject(y))throw new Error("options is invalid");var b=y.units,T=y.reverse;if(!l)throw new Error("geojson is required");if(A<=0)throw new Error("segmentLength must be greater than 0");var P=[];return flattenEach(l,function(R){T&&(R.geometry.coordinates=R.geometry.coordinates.reverse()),ui(R,A,b,function(U){P.push(U)})}),featureCollection(P)}function ui(l,A,y,b){var T=length(l,{units:y});if(T<=A)return b(l);var P=T/A;Number.isInteger(P)||(P=Math.floor(P)+1);for(var R=0;R<P;R++){var U=lineSliceAlong(l,A*R,A*(R+1),{units:y});b(U,R)}}var hs=null;function aa(l,A,y){if(l.geometry.type!=="Polygon")throw new Error("The input feature must be a Polygon");y===void 0&&(y=1);var b=l.geometry.coordinates,T=[],P={};if(y){for(var R=[],U=0;U<b.length;U++)for(var H=0;H<b[U].length-1;H++)R.push(Nt(U,H));var N=rbush();N.load(R)}for(var Q=0;Q<b.length;Q++)for(var K=0;K<b[Q].length-1;K++)if(y){var ae=N.search(Nt(Q,K));ae.forEach(function(dt){var Ke=dt.ring,ht=dt.edge;at(Q,K,Ke,ht)})}else for(var ge=0;ge<b.length;ge++)for(var pt=0;pt<b[ge].length-1;pt++)at(Q,K,ge,pt);return A||(T={type:"Feature",geometry:{type:"MultiPoint",coordinates:T}}),T;function at(dt,Ke,ht,Ht){var Bt=b[dt][Ke],ir=b[dt][Ke+1],Kt=b[ht][Ht],fr=b[ht][Ht+1],Ct=Ts(Bt,ir,Kt,fr);if(Ct!==null){var si,bn;if(ir[0]!==Bt[0]?si=(Ct[0]-Bt[0])/(ir[0]-Bt[0]):si=(Ct[1]-Bt[1])/(ir[1]-Bt[1]),fr[0]!==Kt[0]?bn=(Ct[0]-Kt[0])/(fr[0]-Kt[0]):bn=(Ct[1]-Kt[1])/(fr[1]-Kt[1]),!(si>=1||si<=0||bn>=1||bn<=0)){var Ei=Ct,$i=!P[Ei];$i&&(P[Ei]=!0),A?T.push(A(Ct,dt,Ke,Bt,ir,si,ht,Ht,Kt,fr,bn,$i)):T.push(Ct)}}}function Nt(dt,Ke){var ht=b[dt][Ke],Ht=b[dt][Ke+1],Bt,ir,Kt,fr;return ht[0]<Ht[0]?(Bt=ht[0],ir=Ht[0]):(Bt=Ht[0],ir=ht[0]),ht[1]<Ht[1]?(Kt=ht[1],fr=Ht[1]):(Kt=Ht[1],fr=ht[1]),{minX:Bt,minY:Kt,maxX:ir,maxY:fr,ring:dt,edge:Ke}}}function Ts(l,A,y,b){if(Ea(l,y)||Ea(l,b)||Ea(A,y)||Ea(b,y))return null;var T=l[0],P=l[1],R=A[0],U=A[1],H=y[0],N=y[1],Q=b[0],K=b[1],ae=(T-R)*(N-K)-(P-U)*(H-Q);if(ae===0)return null;var ge=((T*U-P*R)*(H-Q)-(T-R)*(H*K-N*Q))/ae,pt=((T*U-P*R)*(N-K)-(P-U)*(H*K-N*Q))/ae;return[ge,pt]}function Ea(l,A){if(!l||!A||l.length!==A.length)return!1;for(var y=0,b=l.length;y<b;y++)if(l[y]instanceof Array&&A[y]instanceof Array){if(!Ea(l[y],A[y]))return!1}else if(l[y]!==A[y])return!1;return!0}function As(l){if(l.type!="Feature")throw new Error("The input must a geojson object of type Feature");if(l.geometry===void 0||l.geometry==null)throw new Error("The input must a geojson object with a non-empty geometry");if(l.geometry.type!="Polygon")throw new Error("The input must be a geojson Polygon");for(var A=l.geometry.coordinates.length,y=[],Ke=0;Ke<A;Ke++){var b=l.geometry.coordinates[Ke];iu(b[0],b[b.length-1])||b.push(b[0]),y.push.apply(y,b.slice(0,b.length-1))}if(!ps(y))throw new Error("The input polygon may not have duplicate vertices (except for the first and last vertex of each ring)");var T=y.length,P=aa(l,function(po,Vo,jc,Ql,Kh,R0,Jh,hh,Wv,Xv,Qv,qv){return[po,Vo,jc,Ql,Kh,R0,Jh,hh,Wv,Xv,Qv,qv]}),R=P.length;if(R==0){for(var Kt=[],Ke=0;Ke<A;Ke++)Kt.push(polygon([l.geometry.coordinates[Ke]],{parent:-1,winding:as(l.geometry.coordinates[Ke])}));var Ji=featureCollection(Kt);return mu(),ys(),Ji}for(var U=[],H=[],Ke=0;Ke<A;Ke++){U.push([]);for(var N=0;N<l.geometry.coordinates[Ke].length-1;N++)U[Ke].push([new ml(l.geometry.coordinates[Ke][No(N+1,l.geometry.coordinates[Ke].length-1)],1,[Ke,N],[Ke,No(N+1,l.geometry.coordinates[Ke].length-1)],void 0)]),H.push(new nu(l.geometry.coordinates[Ke][N],[Ke,No(N-1,l.geometry.coordinates[Ke].length-1)],[Ke,N],void 0,void 0,!1,!0))}for(var Ke=0;Ke<R;Ke++)U[P[Ke][1]][P[Ke][2]].push(new ml(P[Ke][0],P[Ke][5],[P[Ke][1],P[Ke][2]],[P[Ke][6],P[Ke][7]],void 0)),P[Ke][11]&&H.push(new nu(P[Ke][0],[P[Ke][1],P[Ke][2]],[P[Ke][6],P[Ke][7]],void 0,void 0,!0,!0));for(var Q=H.length,Ke=0;Ke<U.length;Ke++)for(var N=0;N<U[Ke].length;N++)U[Ke][N].sort(function(Vo,jc){return Vo.param<jc.param?-1:1});for(var K=[],Ke=0;Ke<Q;Ke++)K.push({minX:H[Ke].coord[0],minY:H[Ke].coord[1],maxX:H[Ke].coord[0],maxY:H[Ke].coord[1],index:Ke});var ae=rbush();ae.load(K);for(var Ke=0;Ke<U.length;Ke++)for(var N=0;N<U[Ke].length;N++)for(var ge=0;ge<U[Ke][N].length;ge++){var pt;ge==U[Ke][N].length-1?pt=U[Ke][No(N+1,l.geometry.coordinates[Ke].length-1)][0].coord:pt=U[Ke][N][ge+1].coord;var at=ae.search({minX:pt[0],minY:pt[1],maxX:pt[0],maxY:pt[1]})[0];U[Ke][N][ge].nxtIsectAlongEdgeIn=at.index}for(var Ke=0;Ke<U.length;Ke++)for(var N=0;N<U[Ke].length;N++)for(var ge=0;ge<U[Ke][N].length;ge++){var pt=U[Ke][N][ge].coord,at=ae.search({minX:pt[0],minY:pt[1],maxX:pt[0],maxY:pt[1]})[0],Nt=at.index;Nt<T?H[Nt].nxtIsectAlongRingAndEdge2=U[Ke][N][ge].nxtIsectAlongEdgeIn:iu(H[Nt].ringAndEdge1,U[Ke][N][ge].ringAndEdgeIn)?H[Nt].nxtIsectAlongRingAndEdge1=U[Ke][N][ge].nxtIsectAlongEdgeIn:H[Nt].nxtIsectAlongRingAndEdge2=U[Ke][N][ge].nxtIsectAlongEdgeIn}for(var dt=[],Ke=0,N=0;N<A;N++){for(var ht=Ke,ge=0;ge<l.geometry.coordinates[N].length-1;ge++)H[Ke].coord[0]<H[ht].coord[0]&&(ht=Ke),Ke++;for(var Ht=H[ht].nxtIsectAlongRingAndEdge2,ge=0;ge<H.length;ge++)if(H[ge].nxtIsectAlongRingAndEdge1==ht||H[ge].nxtIsectAlongRingAndEdge2==ht){var Bt=ge;break}var ir=Mi([H[Bt].coord,H[ht].coord,H[Ht].coord],!0)?1:-1;dt.push({isect:ht,parent:-1,winding:ir})}dt.sort(function(Qa,po){return H[Qa.isect].coord>H[po.isect].coord?-1:1});for(var Kt=[];dt.length>0;){var fr=dt.pop(),Ct=fr.isect,si=fr.parent,bn=fr.winding,Ei=Kt.length,$i=[H[Ct].coord],on=Ct;if(H[Ct].ringAndEdge1Walkable)var ai=H[Ct].ringAndEdge1,kn=H[Ct].nxtIsectAlongRingAndEdge1;else var ai=H[Ct].ringAndEdge2,kn=H[Ct].nxtIsectAlongRingAndEdge2;for(;!iu(H[Ct].coord,H[kn].coord);){$i.push(H[kn].coord);for(var La=void 0,Ke=0;Ke<dt.length;Ke++)if(dt[Ke].isect==kn){La=Ke;break}if(La!=null&&dt.splice(La,1),iu(ai,H[kn].ringAndEdge1)){if(ai=H[kn].ringAndEdge2,H[kn].ringAndEdge2Walkable=!1,H[kn].ringAndEdge1Walkable){var Sa={isect:kn};Mi([H[on].coord,H[kn].coord,H[H[kn].nxtIsectAlongRingAndEdge2].coord],bn==1)?(Sa.parent=si,Sa.winding=-bn):(Sa.parent=Ei,Sa.winding=bn),dt.push(Sa)}on=kn,kn=H[kn].nxtIsectAlongRingAndEdge2}else{if(ai=H[kn].ringAndEdge1,H[kn].ringAndEdge1Walkable=!1,H[kn].ringAndEdge2Walkable){var Sa={isect:kn};Mi([H[on].coord,H[kn].coord,H[H[kn].nxtIsectAlongRingAndEdge1].coord],bn==1)?(Sa.parent=si,Sa.winding=-bn):(Sa.parent=Ei,Sa.winding=bn),dt.push(Sa)}on=kn,kn=H[kn].nxtIsectAlongRingAndEdge1}}$i.push(H[kn].coord),Kt.push(polygon([$i],{index:Ei,parent:si,winding:bn,netWinding:void 0}))}var Ji=featureCollection(Kt);mu(),ys();function mu(){for(var Qa=[],po=0;po<Ji.features.length;po++)Ji.features[po].properties.parent==-1&&Qa.push(po);if(Qa.length>1)for(var po=0;po<Qa.length;po++){for(var Vo=-1,jc=1/0,Ql=0;Ql<Ji.features.length;Ql++)Qa[po]!=Ql&&booleanPointInPolygon(Ji.features[Qa[po]].geometry.coordinates[0][0],Ji.features[Ql],{ignoreBoundary:!0})&&area(Ji.features[Ql])<jc&&(Vo=Ql);Ji.features[Qa[po]].properties.parent=Vo}}function ys(){for(var Qa=0;Qa<Ji.features.length;Qa++)if(Ji.features[Qa].properties.parent==-1){var po=Ji.features[Qa].properties.winding;Ji.features[Qa].properties.netWinding=po,su(Qa,po)}}function su(Qa,po){for(var Vo=0;Vo<Ji.features.length;Vo++)if(Ji.features[Vo].properties.parent==Qa){var jc=po+Ji.features[Vo].properties.winding;Ji.features[Vo].properties.netWinding=jc,su(Vo,jc)}}return Ji}var ml=function(l,A,y,b,T){this.coord=l,this.param=A,this.ringAndEdgeIn=y,this.ringAndEdgeOut=b,this.nxtIsectAlongEdgeIn=T},nu=function(l,A,y,b,T,P,R){this.coord=l,this.ringAndEdge1=A,this.ringAndEdge2=y,this.nxtIsectAlongRingAndEdge1=b,this.nxtIsectAlongRingAndEdge2=T,this.ringAndEdge1Walkable=P,this.ringAndEdge2Walkable=R};function Mi(l,A){if(typeof A=="undefined"&&(A=!0),l.length!=3)throw new Error("This function requires an array of three points [x,y]");var y=(l[1][0]-l[0][0])*(l[2][1]-l[0][1])-(l[1][1]-l[0][1])*(l[2][0]-l[0][0]);return y>=0==A}function as(l){for(var A=0,y=0;y<l.length-1;y++)l[y][0]<l[A][0]&&(A=y);if(Mi([l[No(A-1,l.length-1)],l[A],l[No(A+1,l.length-1)]],!0))var b=1;else var b=-1;return b}function iu(l,A){if(!l||!A||l.length!=A.length)return!1;for(var y=0,b=l.length;y<b;y++)if(l[y]instanceof Array&&A[y]instanceof Array){if(!iu(l[y],A[y]))return!1}else if(l[y]!=A[y])return!1;return!0}function No(l,A){return(l%A+A)%A}function ps(l){for(var A={},y=1,b=0,T=l.length;b<T;++b){if(Object.prototype.hasOwnProperty.call(A,l[b])){y=0;break}A[l[b]]=1}return y}function Fo(l){var A=[];return flattenEach(l,function(y){y.geometry.type==="Polygon"&&featureEach(As(y),function(b){A.push(polygon(b.geometry.coordinates,y.properties))})}),featureCollection(A)}var a0=null,rc=Math.PI/180,ma=180/Math.PI,Bo=function(l,A){this.lon=l,this.lat=A,this.x=rc*l,this.y=rc*A};Bo.prototype.view=function(){return String(this.lon).slice(0,4)+","+String(this.lat).slice(0,4)},Bo.prototype.antipode=function(){var l=-1*this.lat,A=this.lon<0?180+this.lon:(180-this.lon)*-1;return new Bo(A,l)};var Ms=function(){this.coords=[],this.length=0};Ms.prototype.move_to=function(l){this.length++,this.coords.push(l)};var fo=function(l){this.properties=l||{},this.geometries=[]};fo.prototype.json=function(){if(this.geometries.length<=0)return{geometry:{type:"LineString",coordinates:null},type:"Feature",properties:this.properties};if(this.geometries.length===1)return{geometry:{type:"LineString",coordinates:this.geometries[0].coords},type:"Feature",properties:this.properties};for(var l=[],A=0;A<this.geometries.length;A++)l.push(this.geometries[A].coords);return{geometry:{type:"MultiLineString",coordinates:l},type:"Feature",properties:this.properties}},fo.prototype.wkt=function(){for(var l="",A="LINESTRING(",y=function(P){A+=P[0]+" "+P[1]+","},b=0;b<this.geometries.length;b++){if(this.geometries[b].coords.length===0)return"LINESTRING(empty)";var T=this.geometries[b].coords;T.forEach(y),l+=A.substring(0,A.length-1)+")"}return l};var Wo=function(l,A,y){if(!l||l.x===void 0||l.y===void 0)throw new Error("GreatCircle constructor expects two args: start and end objects with x and y properties");if(!A||A.x===void 0||A.y===void 0)throw new Error("GreatCircle constructor expects two args: start and end objects with x and y properties");this.start=new Bo(l.x,l.y),this.end=new Bo(A.x,A.y),this.properties=y||{};var b=this.start.x-this.end.x,T=this.start.y-this.end.y,P=Math.pow(Math.sin(T/2),2)+Math.cos(this.start.y)*Math.cos(this.end.y)*Math.pow(Math.sin(b/2),2);if(this.g=2*Math.asin(Math.sqrt(P)),this.g===Math.PI)throw new Error("it appears "+l.view()+" and "+A.view()+" are 'antipodal', e.g diametrically opposite, thus there is no single route but rather infinite");if(isNaN(this.g))throw new Error("could not calculate great circle between "+l+" and "+A)};Wo.prototype.interpolate=function(l){var A=Math.sin((1-l)*this.g)/Math.sin(this.g),y=Math.sin(l*this.g)/Math.sin(this.g),b=A*Math.cos(this.start.y)*Math.cos(this.start.x)+y*Math.cos(this.end.y)*Math.cos(this.end.x),T=A*Math.cos(this.start.y)*Math.sin(this.start.x)+y*Math.cos(this.end.y)*Math.sin(this.end.x),P=A*Math.sin(this.start.y)+y*Math.sin(this.end.y),R=ma*Math.atan2(P,Math.sqrt(Math.pow(b,2)+Math.pow(T,2))),U=ma*Math.atan2(T,b);return[U,R]},Wo.prototype.Arc=function(l,A){var y=[];if(!l||l<=2)y.push([this.start.lon,this.start.lat]),y.push([this.end.lon,this.end.lat]);else for(var b=1/(l-1),T=0;T<l;++T){var P=b*T,R=this.interpolate(P);y.push(R)}for(var U=!1,H=0,N=A&&A.offset?A.offset:10,Q=180-N,K=-180+N,ae=360-N,ge=1;ge<y.length;++ge){var pt=y[ge-1][0],at=y[ge][0],Nt=Math.abs(at-pt);Nt>ae&&(at>Q&&pt<K||pt>Q&&at<K)?U=!0:Nt>H&&(H=Nt)}var dt=[];if(U&&H<N){var Ke=[];dt.push(Ke);for(var ht=0;ht<y.length;++ht){var Ht=parseFloat(y[ht][0]);if(ht>0&&Math.abs(Ht-y[ht-1][0])>ae){var Bt=parseFloat(y[ht-1][0]),ir=parseFloat(y[ht-1][1]),Kt=parseFloat(y[ht][0]),fr=parseFloat(y[ht][1]);if(Bt>-180&&Bt<K&&Kt===180&&ht+1<y.length&&y[ht-1][0]>-180&&y[ht-1][0]<K){Ke.push([-180,y[ht][1]]),ht++,Ke.push([y[ht][0],y[ht][1]]);continue}else if(Bt>Q&&Bt<180&&Kt===-180&&ht+1<y.length&&y[ht-1][0]>Q&&y[ht-1][0]<180){Ke.push([180,y[ht][1]]),ht++,Ke.push([y[ht][0],y[ht][1]]);continue}if(Bt<K&&Kt>Q){var Ct=Bt;Bt=Kt,Kt=Ct;var si=ir;ir=fr,fr=si}if(Bt>Q&&Kt<K&&(Kt+=360),Bt<=180&&Kt>=180&&Bt<Kt){var bn=(180-Bt)/(Kt-Bt),Ei=bn*fr+(1-bn)*ir;Ke.push([y[ht-1][0]>Q?180:-180,Ei]),Ke=[],Ke.push([y[ht-1][0]>Q?-180:180,Ei]),dt.push(Ke)}else Ke=[],dt.push(Ke);Ke.push([Ht,y[ht][1]])}else Ke.push([y[ht][0],y[ht][1]])}}else{var $i=[];dt.push($i);for(var on=0;on<y.length;++on)$i.push([y[on][0],y[on][1]])}for(var ai=new fo(this.properties),kn=0;kn<dt.length;++kn){var La=new Ms;ai.geometries.push(La);for(var Sa=dt[kn],Ji=0;Ji<Sa.length;++Ji)La.move_to(Sa[Ji])}return ai};function Au(l,A,y){if(y=y||{},typeof y!="object")throw new Error("options is invalid");var b=y.properties,T=y.npoints,P=y.offset;l=getCoord(l),A=getCoord(A),b=b||{},T=T||100,P=P||10;var R=new Wo({x:l[0],y:l[1]},{x:A[0],y:A[1]},b),U=R.Arc(T,{offset:P});return U.json()}var js=null;function Zr(l,A){if(!l)throw new Error("line is required");if(!A)throw new Error("splitter is required");var y=getType(l),b=getType(A);if(y!=="LineString")throw new Error("line must be LineString");if(b==="FeatureCollection")throw new Error("splitter cannot be a FeatureCollection");if(b==="GeometryCollection")throw new Error("splitter cannot be a GeometryCollection");var T=truncate(A,{precision:7});switch(b){case"Point":return yc(l,T);case"MultiPoint":return Ja(l,T);case"LineString":case"MultiLineString":case"Polygon":case"MultiPolygon":return Ja(l,lineIntersect(l,T))}}function Ja(l,A){var y=[],b=rbush();return flattenEach(A,function(T){if(y.forEach(function(U,H){U.id=H}),!y.length)y=yc(l,T).features,y.forEach(function(U){U.bbox||(U.bbox=square(bbox(U)))}),b.load(featureCollection(y));else{var P=b.search(T);if(P.features.length){var R=Dl(T,P);y=y.filter(function(U){return U.id!==R.id}),b.remove(R),featureEach(yc(R,T),function(U){y.push(U),b.insert(U)})}}}),featureCollection(y)}function yc(l,A){var y=[],b=getCoords(l)[0],T=getCoords(l)[l.geometry.coordinates.length-1];if(yo(b,getCoord(A))||yo(T,getCoord(A)))return featureCollection([l]);var P=rbush(),R=lineSegment(l);P.load(R);var U=P.search(A);if(!U.features.length)return featureCollection([l]);var H=Dl(A,U),N=[b],Q=featureReduce(R,function(K,ae,ge){var pt=getCoords(ae)[1],at=getCoord(A);return ge===H.id?(K.push(at),y.push(lineString(K)),yo(at,pt)?[at]:[at,pt]):(K.push(pt),K)},N);return Q.length>1&&y.push(lineString(Q)),featureCollection(y)}function Dl(l,A){if(!A.features.length)throw new Error("lines must contain features");if(A.features.length===1)return A.features[0];var y,b=1/0;return featureEach(A,function(T){var P=nearestPointOnLine(T,l),R=P.properties.dist;R<b&&(y=T,b=R)}),y}function yo(l,A){return l[0]===A[0]&&l[1]===A[1]}var Nu=null;function Eu(l,A,y,b,T){T===void 0&&(T={});var P=T.steps||64,R=Kc(y),U=Kc(b),H=!Array.isArray(l)&&l.type==="Feature"?l.properties:{};if(R===U)return lineString(circle(l,A,T).geometry.coordinates[0],H);for(var N=R,Q=R<U?U:U+360,K=N,ae=[],ge=0;K<Q;)ae.push(destination(l,A,K,T).geometry.coordinates),ge++,K=N+ge*360/P;return K>Q&&ae.push(destination(l,A,Q,T).geometry.coordinates),lineString(ae,H)}function Kc(l){var A=l%360;return A<0&&(A+=360),A}function ds(l,A){A===void 0&&(A={});var y=getGeom(l);switch(!A.properties&&l.type==="Feature"&&(A.properties=l.properties),y.type){case"Polygon":return Is(y,A);case"MultiPolygon":return kl(y,A);default:throw new Error("invalid poly")}}function Is(l,A){A===void 0&&(A={});var y=getGeom(l),b=y.coordinates,T=A.properties?A.properties:l.type==="Feature"?l.properties:{};return el(b,T)}function kl(l,A){A===void 0&&(A={});var y=getGeom(l),b=y.coordinates,T=A.properties?A.properties:l.type==="Feature"?l.properties:{},P=[];return b.forEach(function(R){P.push(el(R,T))}),featureCollection(P)}function el(l,A){return l.length>1?multiLineString(l,A):lineString(l[0],A)}function Jc(l,A){A===void 0&&(A={});var y,b,T,P=A.properties,R=(y=A.autoComplete)!==null&&y!==void 0?y:!0,U=(b=A.orderCoords)!==null&&b!==void 0?b:!0,H=(T=A.mutate)!==null&&T!==void 0?T:!1;switch(H||(l=clone(l)),l.type){case"FeatureCollection":var N=[];return l.features.forEach(function(Q){N.push(getCoords(Ff(Q,{},R,U)))}),multiPolygon(N,P);default:return Ff(l,P,R,U)}}function Ff(l,A,y,b){A=A||(l.type==="Feature"?l.properties:{});var T=getGeom(l),P=T.coordinates,R=T.type;if(!P.length)throw new Error("line must contain coordinates");switch(R){case"LineString":return y&&(P=yl(P)),polygon([P],A);case"MultiLineString":var U=[],H=0;return P.forEach(function(N){if(y&&(N=yl(N)),b){var Q=bu(turfBBox(lineString(N)));Q>H?(U.unshift(N),H=Q):U.push(N)}else U.push(N)}),polygon(U,A);default:throw new Error("geometry type "+R+" is not supported")}}function yl(l){var A=l[0],y=A[0],b=A[1],T=l[l.length-1],P=T[0],R=T[1];return(y!==P||b!==R)&&l.push(A),l}function bu(l){var A=l[0],y=l[1],b=l[2],T=l[3];return Math.abs(A-b)*Math.abs(y-T)}var wo=null;function _l(l,A){var y=getGeom(l),b=y.type,T=l.type==="Feature"?l.properties:{},P=y.coordinates;switch(b){case"LineString":case"MultiLineString":{var R=[];return b==="LineString"&&(P=[P]),P.forEach(function(U){lineclip(U,A,R)}),R.length===1?lineString(R[0],T):multiLineString(R,T)}case"Polygon":return polygon(Zo(P,A),T);case"MultiPolygon":return multiPolygon(P.map(function(U){return Zo(U,A)}),T);default:throw new Error("geometry "+b+" not supported")}}function Zo(l,A){for(var y=[],b=0,T=l;b<T.length;b++){var P=T[b],R=polygonclip(P,A);R.length>0&&((R[0][0]!==R[R.length-1][0]||R[0][1]!==R[R.length-1][1])&&R.push(R[0]),R.length>=4&&y.push(R))}return y}var Su=C(10251);function Fu(l,A,y){if(y===void 0&&(y={}),y=y||{},!isObject(y))throw new Error("options is invalid");var b=y.tolerance||0,T=[],P=rbush(),R=lineSegment(l);P.load(R);var U;return segmentEach(A,function(H){var N=!1;H&&(featureEach(P.search(H),function(Q){if(N===!1){var K=getCoords(H).sort(),ae=getCoords(Q).sort();equal(K,ae)||(b===0?booleanPointOnLine(K[0],Q)&&booleanPointOnLine(K[1],Q):nearestPointOnLine(Q,K[0]).properties.dist<=b&&nearestPointOnLine(Q,K[1]).properties.dist<=b)?(N=!0,U?U=ef(U,H):U=H):(b===0?booleanPointOnLine(ae[0],H)&&booleanPointOnLine(ae[1],H):nearestPointOnLine(H,ae[0]).properties.dist<=b&&nearestPointOnLine(H,ae[1]).properties.dist<=b)&&(U?U=ef(U,Q):U=Q)}}),N===!1&&U&&(T.push(U),U=void 0))}),U&&T.push(U),featureCollection(T)}function ef(l,A){var y=getCoords(A),b=getCoords(l),T=b[0],P=b[b.length-1],R=l.geometry.coordinates;return equal(y[0],T)?R.unshift(y[1]):equal(y[0],P)?R.push(y[1]):equal(y[1],T)?R.unshift(y[0]):equal(y[1],P)&&R.push(y[0]),l}var xl=null;function Bu(l,A,y,b,T){if(T=T||{},!isObject(T))throw new Error("options is invalid");var P=T.properties;if(!l)throw new Error("center is required");if(y==null)throw new Error("bearing1 is required");if(b==null)throw new Error("bearing2 is required");if(!A)throw new Error("radius is required");if(typeof T!="object")throw new Error("options must be an object");if(pu(y)===pu(b))return circle(l,A,T);var R=getCoords(l),U=lineArc(l,A,y,b,T),H=[[R]];return coordEach(U,function(N){H[0].push(N)}),H[0].push(R),polygon(H,P)}function pu(l){var A=l%360;return A<0&&(A+=360),A}var _o=null;function Cu(l,A,y){y===void 0&&(y={});var b;y.final?b=ho(getCoord(A),getCoord(l)):b=ho(getCoord(l),getCoord(A));var T=b>180?-(360-b):b;return T}function ho(l,A){var y=degreesToRadians(l[1]),b=degreesToRadians(A[1]),T=degreesToRadians(A[0]-l[0]);T>Math.PI&&(T-=2*Math.PI),T<-Math.PI&&(T+=2*Math.PI);var P=Math.log(Math.tan(b/2+Math.PI/4)/Math.tan(y/2+Math.PI/4)),R=Math.atan2(T,P);return(radiansToDegrees(R)+360)%360}var o0=null;function tl(l,A,y,b){b===void 0&&(b={});var T=A<0,P=convertLength(Math.abs(A),b.units,"meters");T&&(P=-Math.abs(P));var R=getCoord(l),U=nc(R,P,y);return U[0]+=U[0]-R[0]>180?-360:R[0]-U[0]>180?360:0,point(U,b.properties)}function nc(l,A,y,b){b=b===void 0?earthRadius:Number(b);var T=A/b,P=l[0]*Math.PI/180,R=degreesToRadians(l[1]),U=degreesToRadians(y),H=T*Math.cos(U),N=R+H;Math.abs(N)>Math.PI/2&&(N=N>0?Math.PI-N:-Math.PI-N);var Q=Math.log(Math.tan(N/2+Math.PI/4)/Math.tan(R/2+Math.PI/4)),K=Math.abs(Q)>1e-11?H/Q:Math.cos(R),ae=T*Math.sin(U)/K,ge=P+ae;return[(ge*180/Math.PI+540)%360-180,N*180/Math.PI]}var zo=null;function Xo(l,A){var y=getCoords(l),b=getCoords(A),T,P,R,U,H=calcBbox(A),N=0,Q=null;y[0]>H[0]&&y[0]<H[2]&&y[1]>H[1]&&y[1]<H[3]&&(Q=nearestPoint(l,explode(A)),N=Q.properties.featureIndex);var K=getType(A);switch(K){case"Polygon":T=b[0][N],P=b[0][0],Q!==null&&Q.geometry.coordinates[1]<y[1]&&(P=b[0][N]),U=Ps(b[0][0],b[0][b[0].length-1],y);var ae=Vs(b[0],y,U,R,T,P);T=ae[0],P=ae[1];break;case"MultiPolygon":for(var ge=0,pt=0,at=0,Nt=0;Nt<b[0].length;Nt++){ge=Nt;for(var dt=!1,Ke=0;Ke<b[0][Nt].length;Ke++){if(pt=Ke,at===N){dt=!0;break}at++}if(dt)break}T=b[0][ge][pt],P=b[0][ge][pt],U=Ps(b[0][0][0],b[0][0][b[0][0].length-1],y),b.forEach(function(ht){var Ht=Vs(ht[0],y,U,R,T,P);T=Ht[0],P=Ht[1]});break}return featureCollection([point(T),point(P)])}function Vs(l,A,y,b,T,P){for(var R=0;R<l.length;R++){var U=l[R],H=l[R+1];R===l.length-1&&(H=l[0]),b=Ps(U,H,A),y<=0&&b>0?_c(A,U,T)||(T=U):y>0&&b<=0&&(Hs(A,U,P)||(P=U)),y=b}return[T,P]}function Hs(l,A,y){return Ps(l,A,y)>0}function _c(l,A,y){return Ps(l,A,y)<0}function Ps(l,A,y){return(A[0]-l[0])*(y[1]-l[1])-(y[0]-l[0])*(A[1]-l[1])}var El=null;function To(l){for(var A=getCoords(l),y=0,b=1,T,P;b<A.length;)T=P||A[0],P=A[b],y+=(P[0]-T[0])*(P[1]+T[1]),b++;return y>0}function Ls(l,A){if(A=A||{},!isObject(A))throw new Error("options is invalid");var y=A.reverse||!1,b=A.mutate||!1;if(!l)throw new Error("<geojson> is required");if(typeof y!="boolean")throw new Error("<reverse> must be a boolean");if(typeof b!="boolean")throw new Error("<mutate> must be a boolean");b===!1&&(l=clone(l));var T=[];switch(l.type){case"GeometryCollection":return geomEach(l,function(P){za(P,y)}),l;case"FeatureCollection":return featureEach(l,function(P){featureEach(za(P,y),function(R){T.push(R)})}),featureCollection(T)}return za(l,y)}function za(l,A){var y=l.type==="Feature"?l.geometry.type:l.type;switch(y){case"GeometryCollection":return geomEach(l,function(b){za(b,A)}),l;case"LineString":return ur(getCoords(l),A),l;case"Polygon":return xt(getCoords(l),A),l;case"MultiLineString":return getCoords(l).forEach(function(b){ur(b,A)}),l;case"MultiPolygon":return getCoords(l).forEach(function(b){xt(b,A)}),l;case"Point":case"MultiPoint":return l}}function ur(l,A){booleanClockwise(l)===A&&l.reverse()}function xt(l,A){booleanClockwise(l[0])!==A&&l[0].reverse();for(var y=1;y<l.length;y++)booleanClockwise(l[y])===A&&l[y].reverse()}var Me=null;function $s(l,A){if(A=A||{},!isObject(A))throw new Error("options is invalid");var y=A.zProperty||"elevation",b=A.flip,T=A.flags;collectionOf(l,"Point","input must contain Points");for(var P=it(l,b),R=[],U=0;U<P.length;U++){for(var H=P[U],N=[],Q=0;Q<H.length;Q++){var K=H[Q];K.properties[y]?N.push(K.properties[y]):N.push(0),T===!0&&(K.properties.matrixPosition=[U,Q])}R.push(N)}return R}function it(l,A){var y={};featureEach(l,function(P){var R=getCoords(P)[1];y[R]||(y[R]=[]),y[R].push(P)});var b=Object.keys(y).map(function(P){var R=y[P],U=R.sort(function(H,N){return getCoords(H)[0]-getCoords(N)[0]});return U}),T=b.sort(function(P,R){return A?getCoords(P[0])[1]-getCoords(R[0])[1]:getCoords(R[0])[1]-getCoords(P[0])[1]});return T}var rl={successCallback:null,verbose:!1,polygons:!1},ha={};function Ys(l,A,y,b){b=b||{};for(var T=Object.keys(rl),P=0;P<T.length;P++){var R=T[P],U=b[R];U=typeof U!="undefined"&&U!==null?U:rl[R],ha[R]=U}ha.verbose&&console.log("MarchingSquaresJS-isoBands: computing isobands for ["+A+":"+(A+y)+"]");var H=Bi(l,A,y),N;return ha.polygons?(ha.verbose&&console.log("MarchingSquaresJS-isoBands: returning single polygons for each grid cell"),N=s0(H)):(ha.verbose&&console.log("MarchingSquaresJS-isoBands: returning polygon paths for entire data grid"),N=lt(H)),typeof ha.successCallback=="function"&&ha.successCallback(N),N}var oi=64,Aa=16,bi=4,$a=1,Ii=[],Hn=[],yi=[],Yi=[],_i=[],di=[],wn=[],Wn=[],Pi=[],qn=[],Ui=[],Gi=[],Nn=[],Wi=[],$n=[],Li=[],Oi=[],Qi=[],qi=[],hi=[],Si=[],Ci=[],ji=[],li=[];wn[85]=qn[85]=-1,Wn[85]=Ui[85]=0,Pi[85]=Gi[85]=1,qi[85]=Ci[85]=1,hi[85]=ji[85]=0,Si[85]=li[85]=1,Ii[85]=Yi[85]=0,Hn[85]=_i[85]=-1,yi[85]=$n[85]=0,Li[85]=Nn[85]=0,Oi[85]=Wi[85]=1,di[85]=Qi[85]=1,Ci[1]=Ci[169]=0,ji[1]=ji[169]=-1,li[1]=li[169]=0,Nn[1]=Nn[169]=-1,Wi[1]=Wi[169]=0,$n[1]=$n[169]=0,qn[4]=qn[166]=0,Ui[4]=Ui[166]=-1,Gi[4]=Gi[166]=1,Li[4]=Li[166]=1,Oi[4]=Oi[166]=0,Qi[4]=Qi[166]=0,wn[16]=wn[154]=0,Wn[16]=Wn[154]=1,Pi[16]=Pi[154]=1,Yi[16]=Yi[154]=1,_i[16]=_i[154]=0,di[16]=di[154]=1,qi[64]=qi[106]=0,hi[64]=hi[106]=1,Si[64]=Si[106]=0,Ii[64]=Ii[106]=-1,Hn[64]=Hn[106]=0,yi[64]=yi[106]=1,qi[2]=qi[168]=0,hi[2]=hi[168]=-1,Si[2]=Si[168]=1,Ci[2]=Ci[168]=0,ji[2]=ji[168]=-1,li[2]=li[168]=0,Nn[2]=Nn[168]=-1,Wi[2]=Wi[168]=0,$n[2]=$n[168]=0,Li[2]=Li[168]=-1,Oi[2]=Oi[168]=0,Qi[2]=Qi[168]=1,wn[8]=wn[162]=0,Wn[8]=Wn[162]=-1,Pi[8]=Pi[162]=0,qn[8]=qn[162]=0,Ui[8]=Ui[162]=-1,Gi[8]=Gi[162]=1,Nn[8]=Nn[162]=1,Wi[8]=Wi[162]=0,$n[8]=$n[162]=1,Li[8]=Li[162]=1,Oi[8]=Oi[162]=0,Qi[8]=Qi[162]=0,wn[32]=wn[138]=0,Wn[32]=Wn[138]=1,Pi[32]=Pi[138]=1,qn[32]=qn[138]=0,Ui[32]=Ui[138]=1,Gi[32]=Gi[138]=0,Ii[32]=Ii[138]=1,Hn[32]=Hn[138]=0,yi[32]=yi[138]=0,Yi[32]=Yi[138]=1,_i[32]=_i[138]=0,di[32]=di[138]=1,Ci[128]=Ci[42]=0,ji[128]=ji[42]=1,li[128]=li[42]=1,qi[128]=qi[42]=0,hi[128]=hi[42]=1,Si[128]=Si[42]=0,Ii[128]=Ii[42]=-1,Hn[128]=Hn[42]=0,yi[128]=yi[42]=1,Yi[128]=Yi[42]=-1,_i[128]=_i[42]=0,di[128]=di[42]=0,qn[5]=qn[165]=-1,Ui[5]=Ui[165]=0,Gi[5]=Gi[165]=0,Ci[5]=Ci[165]=1,ji[5]=ji[165]=0,li[5]=li[165]=0,Li[20]=Li[150]=0,Oi[20]=Oi[150]=1,Qi[20]=Qi[150]=1,Yi[20]=Yi[150]=0,_i[20]=_i[150]=-1,di[20]=di[150]=1,wn[80]=wn[90]=-1,Wn[80]=Wn[90]=0,Pi[80]=Pi[90]=1,qi[80]=qi[90]=1,hi[80]=hi[90]=0,Si[80]=Si[90]=1,Nn[65]=Nn[105]=0,Wi[65]=Wi[105]=1,$n[65]=$n[105]=0,Ii[65]=Ii[105]=0,Hn[65]=Hn[105]=-1,yi[65]=yi[105]=0,wn[160]=wn[10]=-1,Wn[160]=Wn[10]=0,Pi[160]=Pi[10]=1,qn[160]=qn[10]=-1,Ui[160]=Ui[10]=0,Gi[160]=Gi[10]=0,Ci[160]=Ci[10]=1,ji[160]=ji[10]=0,li[160]=li[10]=0,qi[160]=qi[10]=1,hi[160]=hi[10]=0,Si[160]=Si[10]=1,Li[130]=Li[40]=0,Oi[130]=Oi[40]=1,Qi[130]=Qi[40]=1,Nn[130]=Nn[40]=0,Wi[130]=Wi[40]=1,$n[130]=$n[40]=0,Ii[130]=Ii[40]=0,Hn[130]=Hn[40]=-1,yi[130]=yi[40]=0,Yi[130]=Yi[40]=0,_i[130]=_i[40]=-1,di[130]=di[40]=1,qn[37]=qn[133]=0,Ui[37]=Ui[133]=1,Gi[37]=Gi[133]=1,Ci[37]=Ci[133]=0,ji[37]=ji[133]=1,li[37]=li[133]=0,Ii[37]=Ii[133]=-1,Hn[37]=Hn[133]=0,yi[37]=yi[133]=0,Yi[37]=Yi[133]=1,_i[37]=_i[133]=0,di[37]=di[133]=0,Li[148]=Li[22]=-1,Oi[148]=Oi[22]=0,Qi[148]=Qi[22]=0,Ci[148]=Ci[22]=0,ji[148]=ji[22]=-1,li[148]=li[22]=1,qi[148]=qi[22]=0,hi[148]=hi[22]=1,Si[148]=Si[22]=1,Yi[148]=Yi[22]=-1,_i[148]=_i[22]=0,di[148]=di[22]=1,wn[82]=wn[88]=0,Wn[82]=Wn[88]=-1,Pi[82]=Pi[88]=1,Li[82]=Li[88]=1,Oi[82]=Oi[88]=0,Qi[82]=Qi[88]=1,Nn[82]=Nn[88]=-1,Wi[82]=Wi[88]=0,$n[82]=$n[88]=1,qi[82]=qi[88]=0,hi[82]=hi[88]=-1,Si[82]=Si[88]=0,wn[73]=wn[97]=0,Wn[73]=Wn[97]=1,Pi[73]=Pi[97]=0,qn[73]=qn[97]=0,Ui[73]=Ui[97]=-1,Gi[73]=Gi[97]=0,Nn[73]=Nn[97]=1,Wi[73]=Wi[97]=0,$n[73]=$n[97]=0,Ii[73]=Ii[97]=1,Hn[73]=Hn[97]=0,yi[73]=yi[97]=1,wn[145]=wn[25]=0,Wn[145]=Wn[25]=-1,Pi[145]=Pi[25]=0,Nn[145]=Nn[25]=1,Wi[145]=Wi[25]=0,$n[145]=$n[25]=1,Ci[145]=Ci[25]=0,ji[145]=ji[25]=1,li[145]=li[25]=1,Yi[145]=Yi[25]=-1,_i[145]=_i[25]=0,di[145]=di[25]=0,qn[70]=qn[100]=0,Ui[70]=Ui[100]=1,Gi[70]=Gi[100]=0,Li[70]=Li[100]=-1,Oi[70]=Oi[100]=0,Qi[70]=Qi[100]=1,qi[70]=qi[100]=0,hi[70]=hi[100]=-1,Si[70]=Si[100]=1,Ii[70]=Ii[100]=1,Hn[70]=Hn[100]=0,yi[70]=yi[100]=0,qn[101]=qn[69]=0,Ui[101]=Ui[69]=1,Gi[101]=Gi[69]=0,Ii[101]=Ii[69]=1,Hn[101]=Hn[69]=0,yi[101]=yi[69]=0,Ci[149]=Ci[21]=0,ji[149]=ji[21]=1,li[149]=li[21]=1,Yi[149]=Yi[21]=-1,_i[149]=_i[21]=0,di[149]=di[21]=0,Li[86]=Li[84]=-1,Oi[86]=Oi[84]=0,Qi[86]=Qi[84]=1,qi[86]=qi[84]=0,hi[86]=hi[84]=-1,Si[86]=Si[84]=1,wn[89]=wn[81]=0,Wn[89]=Wn[81]=-1,Pi[89]=Pi[81]=0,Nn[89]=Nn[81]=1,Wi[89]=Wi[81]=0,$n[89]=$n[81]=1,wn[96]=wn[74]=0,Wn[96]=Wn[74]=1,Pi[96]=Pi[74]=0,qn[96]=qn[74]=-1,Ui[96]=Ui[74]=0,Gi[96]=Gi[74]=1,qi[96]=qi[74]=1,hi[96]=hi[74]=0,Si[96]=Si[74]=0,Ii[96]=Ii[74]=1,Hn[96]=Hn[74]=0,yi[96]=yi[74]=1,wn[24]=wn[146]=0,Wn[24]=Wn[146]=-1,Pi[24]=Pi[146]=1,Li[24]=Li[146]=1,Oi[24]=Oi[146]=0,Qi[24]=Qi[146]=1,Nn[24]=Nn[146]=0,Wi[24]=Wi[146]=1,$n[24]=$n[146]=1,Yi[24]=Yi[146]=0,_i[24]=_i[146]=-1,di[24]=di[146]=0,qn[6]=qn[164]=-1,Ui[6]=Ui[164]=0,Gi[6]=Gi[164]=1,Li[6]=Li[164]=-1,Oi[6]=Oi[164]=0,Qi[6]=Qi[164]=0,Ci[6]=Ci[164]=0,ji[6]=ji[164]=-1,li[6]=li[164]=1,qi[6]=qi[164]=1,hi[6]=hi[164]=0,Si[6]=Si[164]=0,Nn[129]=Nn[41]=0,Wi[129]=Wi[41]=1,$n[129]=$n[41]=1,Ci[129]=Ci[41]=0,ji[129]=ji[41]=1,li[129]=li[41]=0,Ii[129]=Ii[41]=-1,Hn[129]=Hn[41]=0,yi[129]=yi[41]=0,Yi[129]=Yi[41]=0,_i[129]=_i[41]=-1,di[129]=di[41]=0,Li[66]=Li[104]=0,Oi[66]=Oi[104]=1,Qi[66]=Qi[104]=0,Nn[66]=Nn[104]=-1,Wi[66]=Wi[104]=0,$n[66]=$n[104]=1,qi[66]=qi[104]=0,hi[66]=hi[104]=-1,Si[66]=Si[104]=0,Ii[66]=Ii[104]=0,Hn[66]=Hn[104]=-1,yi[66]=yi[104]=1,wn[144]=wn[26]=-1,Wn[144]=Wn[26]=0,Pi[144]=Pi[26]=0,Ci[144]=Ci[26]=1,ji[144]=ji[26]=0,li[144]=li[26]=1,qi[144]=qi[26]=0,hi[144]=hi[26]=1,Si[144]=Si[26]=1,Yi[144]=Yi[26]=-1,_i[144]=_i[26]=0,di[144]=di[26]=1,qn[36]=qn[134]=0,Ui[36]=Ui[134]=1,Gi[36]=Gi[134]=1,Li[36]=Li[134]=0,Oi[36]=Oi[134]=1,Qi[36]=Qi[134]=0,Ii[36]=Ii[134]=0,Hn[36]=Hn[134]=-1,yi[36]=yi[134]=1,Yi[36]=Yi[134]=1,_i[36]=_i[134]=0,di[36]=di[134]=0,wn[9]=wn[161]=-1,Wn[9]=Wn[161]=0,Pi[9]=Pi[161]=0,qn[9]=qn[161]=0,Ui[9]=Ui[161]=-1,Gi[9]=Gi[161]=0,Nn[9]=Nn[161]=1,Wi[9]=Wi[161]=0,$n[9]=$n[161]=0,Ci[9]=Ci[161]=1,ji[9]=ji[161]=0,li[9]=li[161]=1,wn[136]=0,Wn[136]=1,Pi[136]=1,qn[136]=0,Ui[136]=1,Gi[136]=0,Li[136]=-1,Oi[136]=0,Qi[136]=1,Nn[136]=-1,Wi[136]=0,$n[136]=0,Ci[136]=0,ji[136]=-1,li[136]=0,qi[136]=0,hi[136]=-1,Si[136]=1,Ii[136]=1,Hn[136]=0,yi[136]=0,Yi[136]=1,_i[136]=0,di[136]=1,wn[34]=0,Wn[34]=-1,Pi[34]=0,qn[34]=0,Ui[34]=-1,Gi[34]=1,Li[34]=1,Oi[34]=0,Qi[34]=0,Nn[34]=1,Wi[34]=0,$n[34]=1,Ci[34]=0,ji[34]=1,li[34]=1,qi[34]=0,hi[34]=1,Si[34]=0,Ii[34]=-1,Hn[34]=0,yi[34]=1,Yi[34]=-1,_i[34]=0,di[34]=0,wn[35]=0,Wn[35]=1,Pi[35]=1,qn[35]=0,Ui[35]=-1,Gi[35]=1,Li[35]=1,Oi[35]=0,Qi[35]=0,Nn[35]=-1,Wi[35]=0,$n[35]=0,Ci[35]=0,ji[35]=-1,li[35]=0,qi[35]=0,hi[35]=1,Si[35]=0,Ii[35]=-1,Hn[35]=0,yi[35]=1,Yi[35]=1,_i[35]=0,di[35]=1,wn[153]=0,Wn[153]=1,Pi[153]=1,Nn[153]=-1,Wi[153]=0,$n[153]=0,Ci[153]=0,ji[153]=-1,li[153]=0,Yi[153]=1,_i[153]=0,di[153]=1,qn[102]=0,Ui[102]=-1,Gi[102]=1,Li[102]=1,Oi[102]=0,Qi[102]=0,qi[102]=0,hi[102]=1,Si[102]=0,Ii[102]=-1,Hn[102]=0,yi[102]=1,wn[155]=0,Wn[155]=-1,Pi[155]=0,Nn[155]=1,Wi[155]=0,$n[155]=1,Ci[155]=0,ji[155]=1,li[155]=1,Yi[155]=-1,_i[155]=0,di[155]=0,qn[103]=0,Ui[103]=1,Gi[103]=0,Li[103]=-1,Oi[103]=0,Qi[103]=1,qi[103]=0,hi[103]=-1,Si[103]=1,Ii[103]=1,Hn[103]=0,yi[103]=0,wn[152]=0,Wn[152]=1,Pi[152]=1,Li[152]=-1,Oi[152]=0,Qi[152]=1,Nn[152]=-1,Wi[152]=0,$n[152]=0,Ci[152]=0,ji[152]=-1,li[152]=0,qi[152]=0,hi[152]=-1,Si[152]=1,Yi[152]=1,_i[152]=0,di[152]=1,wn[156]=0,Wn[156]=-1,Pi[156]=1,Li[156]=1,Oi[156]=0,Qi[156]=1,Nn[156]=-1,Wi[156]=0,$n[156]=0,Ci[156]=0,ji[156]=-1,li[156]=0,qi[156]=0,hi[156]=1,Si[156]=1,Yi[156]=-1,_i[156]=0,di[156]=1,wn[137]=0,Wn[137]=1,Pi[137]=1,qn[137]=0,Ui[137]=1,Gi[137]=0,Nn[137]=-1,Wi[137]=0,$n[137]=0,Ci[137]=0,ji[137]=-1,li[137]=0,Ii[137]=1,Hn[137]=0,yi[137]=0,Yi[137]=1,_i[137]=0,di[137]=1,wn[139]=0,Wn[139]=1,Pi[139]=1,qn[139]=0,Ui[139]=-1,Gi[139]=0,Nn[139]=1,Wi[139]=0,$n[139]=0,Ci[139]=0,ji[139]=1,li[139]=0,Ii[139]=-1,Hn[139]=0,yi[139]=0,Yi[139]=1,_i[139]=0,di[139]=1,wn[98]=0,Wn[98]=-1,Pi[98]=0,qn[98]=0,Ui[98]=-1,Gi[98]=1,Li[98]=1,Oi[98]=0,Qi[98]=0,Nn[98]=1,Wi[98]=0,$n[98]=1,qi[98]=0,hi[98]=1,Si[98]=0,Ii[98]=-1,Hn[98]=0,yi[98]=1,wn[99]=0,Wn[99]=1,Pi[99]=0,qn[99]=0,Ui[99]=-1,Gi[99]=1,Li[99]=1,Oi[99]=0,Qi[99]=0,Nn[99]=-1,Wi[99]=0,$n[99]=1,qi[99]=0,hi[99]=-1,Si[99]=0,Ii[99]=1,Hn[99]=0,yi[99]=1,qn[38]=0,Ui[38]=-1,Gi[38]=1,Li[38]=1,Oi[38]=0,Qi[38]=0,Ci[38]=0,ji[38]=1,li[38]=1,qi[38]=0,hi[38]=1,Si[38]=0,Ii[38]=-1,Hn[38]=0,yi[38]=1,Yi[38]=-1,_i[38]=0,di[38]=0,qn[39]=0,Ui[39]=1,Gi[39]=1,Li[39]=-1,Oi[39]=0,Qi[39]=0,Ci[39]=0,ji[39]=-1,li[39]=1,qi[39]=0,hi[39]=1,Si[39]=0,Ii[39]=-1,Hn[39]=0,yi[39]=1,Yi[39]=1,_i[39]=0,di[39]=0;var wu=function(l){return[[l.bottomleft,0],[0,0],[0,l.leftbottom]]},Qo=function(l){return[[1,l.rightbottom],[1,0],[l.bottomright,0]]},nl=function(l){return[[l.topright,1],[1,1],[1,l.righttop]]},Zu=function(l){return[[0,l.lefttop],[0,1],[l.topleft,1]]},Fn=function(l){return[[l.bottomright,0],[l.bottomleft,0],[0,l.leftbottom],[0,l.lefttop]]},qo=function(l){return[[l.bottomright,0],[l.bottomleft,0],[1,l.righttop],[1,l.rightbottom]]},Ws=function(l){return[[1,l.righttop],[1,l.rightbottom],[l.topleft,1],[l.topright,1]]},du=function(l){return[[0,l.leftbottom],[0,l.lefttop],[l.topleft,1],[l.topright,1]]},vs=function(l){return[[0,0],[0,l.leftbottom],[1,l.rightbottom],[1,0]]},bl=function(l){return[[1,0],[l.bottomright,0],[l.topright,1],[1,1]]},gs=function(l){return[[1,1],[1,l.righttop],[0,l.lefttop],[0,1]]},Da=function(l){return[[l.bottomleft,0],[0,0],[0,1],[l.topleft,1]]},il=function(l){return[[1,l.righttop],[1,l.rightbottom],[0,l.leftbottom],[0,l.lefttop]]},tf=function(l){return[[l.topleft,1],[l.topright,1],[l.bottomright,0],[l.bottomleft,0]]},o=function(){return[[0,0],[0,1],[1,1],[1,0]]},s=function(l){return[[1,l.rightbottom],[1,0],[0,0],[0,1],[l.topleft,1]]},d=function(l){return[[l.topright,1],[1,1],[1,0],[0,0],[0,l.leftbottom]]},_=function(l){return[[1,0],[l.bottomright,0],[0,l.lefttop],[0,1],[1,1]]},w=function(l){return[[1,1],[1,l.righttop],[l.bottomleft,0],[0,0],[0,1]]},j=function(l){return[[1,l.righttop],[1,l.rightbottom],[0,l.lefttop],[0,1],[l.topleft,1]]},ie=function(l){return[[1,1],[1,l.righttop],[l.bottomright,0],[l.bottomleft,0],[l.topright,1]]},ke=function(l){return[[1,l.rightbottom],[1,0],[l.bottomright,0],[0,l.leftbottom],[0,l.lefttop]]},tt=function(l){return[[l.topright,1],[l.bottomleft,0],[0,0],[0,l.leftbottom],[l.topleft,1]]},Pt=function(l){return[[l.bottomright,0],[l.bottomleft,0],[0,l.lefttop],[0,1],[l.topleft,1]]},tr=function(l){return[[1,1],[1,l.righttop],[0,l.leftbottom],[0,l.lefttop],[l.topright,1]]},st=function(l){return[[1,l.rightbottom],[1,0],[l.bottomright,0],[l.topleft,1],[l.topright,1]]},Zt=function(l){return[[1,l.righttop],[1,l.rightbottom],[l.bottomleft,0],[0,0],[0,l.leftbottom]]},Jt=function(l){return[[1,l.rightbottom],[1,0],[0,0],[0,l.leftbottom],[l.topleft,1],[l.topright,1]]},yr=function(l){return[[1,1],[1,0],[l.bottomright,0],[0,l.leftbottom],[0,l.lefttop],[l.topright,1]]},v=function(l){return[[1,1],[1,l.righttop],[l.bottomright,0],[l.bottomleft,0],[0,l.lefttop],[0,1]]},Pn=function(l){return[[1,l.righttop],[1,l.rightbottom],[l.bottomleft,0],[0,0],[0,1],[l.topleft,1]]},jn=function(l){return[[1,1],[1,l.righttop],[l.bottomleft,0],[0,0],[0,l.leftbottom],[l.topright,1]]},Xe=function(l){return[[1,l.rightbottom],[1,0],[l.bottomright,0],[0,l.lefttop],[0,1],[l.topleft,1]]},Ia=function(l){return[[1,l.righttop],[1,l.rightbottom],[l.bottomright,0],[l.bottomleft,0],[0,l.leftbottom],[0,l.lefttop],[l.topleft,1],[l.topright,1]]},ao=function(l){return[[1,1],[1,l.righttop],[l.bottomleft,0],[0,0],[0,l.leftbottom],[l.topright,1]]},xo=function(l){return[[1,l.rightbottom],[1,0],[l.bottomright,0],[0,l.lefttop],[0,1],[l.topleft,1]]},sa=function(l){return[[1,1],[1,l.righttop],[l.bottomright,0],[l.bottomleft,0],[0,l.leftbottom],[0,l.lefttop],[l.topright,1]]},ka=function(l){return[[1,l.righttop],[1,l.rightbottom],[l.bottomleft,0],[0,0],[0,l.leftbottom],[l.topleft,1],[l.topright,1]]},os=function(l){return[[1,l.righttop],[1,l.rightbottom],[l.bottomright,0],[l.bottomleft,0],[0,l.lefttop],[0,1],[l.topleft,1]]},ba=function(l){return[[1,l.rightbottom],[1,0],[l.bottomright,0],[0,l.leftbottom],[0,l.lefttop],[l.topleft,1],[l.topright,1]]},Vr=[],hn=[],Yn=[],Dn=[],Kn=[],Ln=[],Fi=[],wi=[];Dn[1]=Kn[1]=18,Dn[169]=Kn[169]=18,Yn[4]=hn[4]=12,Yn[166]=hn[166]=12,Vr[16]=wi[16]=4,Vr[154]=wi[154]=4,Ln[64]=Fi[64]=22,Ln[106]=Fi[106]=22,Yn[2]=Ln[2]=17,Dn[2]=Kn[2]=18,Yn[168]=Ln[168]=17,Dn[168]=Kn[168]=18,Vr[8]=Dn[8]=9,hn[8]=Yn[8]=12,Vr[162]=Dn[162]=9,hn[162]=Yn[162]=12,Vr[32]=wi[32]=4,hn[32]=Fi[32]=1,Vr[138]=wi[138]=4,hn[138]=Fi[138]=1,Kn[128]=wi[128]=21,Ln[128]=Fi[128]=22,Kn[42]=wi[42]=21,Ln[42]=Fi[42]=22,hn[5]=Kn[5]=14,hn[165]=Kn[165]=14,Yn[20]=wi[20]=6,Yn[150]=wi[150]=6,Vr[80]=Ln[80]=11,Vr[90]=Ln[90]=11,Dn[65]=Fi[65]=3,Dn[105]=Fi[105]=3,Vr[160]=Ln[160]=11,hn[160]=Kn[160]=14,Vr[10]=Ln[10]=11,hn[10]=Kn[10]=14,Yn[130]=wi[130]=6,Dn[130]=Fi[130]=3,Yn[40]=wi[40]=6,Dn[40]=Fi[40]=3,hn[101]=Fi[101]=1,hn[69]=Fi[69]=1,Kn[149]=wi[149]=21,Kn[21]=wi[21]=21,Yn[86]=Ln[86]=17,Yn[84]=Ln[84]=17,Vr[89]=Dn[89]=9,Vr[81]=Dn[81]=9,Vr[96]=Fi[96]=0,hn[96]=Ln[96]=15,Vr[74]=Fi[74]=0,hn[74]=Ln[74]=15,Vr[24]=Yn[24]=8,Dn[24]=wi[24]=7,Vr[146]=Yn[146]=8,Dn[146]=wi[146]=7,hn[6]=Ln[6]=15,Yn[6]=Kn[6]=16,hn[164]=Ln[164]=15,Yn[164]=Kn[164]=16,Dn[129]=wi[129]=7,Kn[129]=Fi[129]=20,Dn[41]=wi[41]=7,Kn[41]=Fi[41]=20,Yn[66]=Fi[66]=2,Dn[66]=Ln[66]=19,Yn[104]=Fi[104]=2,Dn[104]=Ln[104]=19,Vr[144]=Kn[144]=10,Ln[144]=wi[144]=23,Vr[26]=Kn[26]=10,Ln[26]=wi[26]=23,hn[36]=wi[36]=5,Yn[36]=Fi[36]=2,hn[134]=wi[134]=5,Yn[134]=Fi[134]=2,Vr[9]=Kn[9]=10,hn[9]=Dn[9]=13,Vr[161]=Kn[161]=10,hn[161]=Dn[161]=13,hn[37]=wi[37]=5,Kn[37]=Fi[37]=20,hn[133]=wi[133]=5,Kn[133]=Fi[133]=20,Yn[148]=Kn[148]=16,Ln[148]=wi[148]=23,Yn[22]=Kn[22]=16,Ln[22]=wi[22]=23,Vr[82]=Yn[82]=8,Dn[82]=Ln[82]=19,Vr[88]=Yn[88]=8,Dn[88]=Ln[88]=19,Vr[73]=Fi[73]=0,hn[73]=Dn[73]=13,Vr[97]=Fi[97]=0,hn[97]=Dn[97]=13,Vr[145]=Dn[145]=9,Kn[145]=wi[145]=21,Vr[25]=Dn[25]=9,Kn[25]=wi[25]=21,hn[70]=Fi[70]=1,Yn[70]=Ln[70]=17,hn[100]=Fi[100]=1,Yn[100]=Ln[100]=17,Vr[34]=Dn[34]=9,hn[34]=Yn[34]=12,Kn[34]=wi[34]=21,Ln[34]=Fi[34]=22,Vr[136]=wi[136]=4,hn[136]=Fi[136]=1,Yn[136]=Ln[136]=17,Dn[136]=Kn[136]=18,Vr[35]=wi[35]=4,hn[35]=Yn[35]=12,Dn[35]=Kn[35]=18,Ln[35]=Fi[35]=22,Vr[153]=wi[153]=4,Dn[153]=Kn[153]=18,hn[102]=Yn[102]=12,Ln[102]=Fi[102]=22,Vr[155]=Dn[155]=9,Kn[155]=wi[155]=23,hn[103]=Fi[103]=1,Yn[103]=Ln[103]=17,Vr[152]=wi[152]=4,Yn[152]=Ln[152]=17,Dn[152]=Kn[152]=18,Vr[156]=Yn[156]=8,Dn[156]=Kn[156]=18,Ln[156]=wi[156]=23,Vr[137]=wi[137]=4,hn[137]=Fi[137]=1,Dn[137]=Kn[137]=18,Vr[139]=wi[139]=4,hn[139]=Dn[139]=13,Kn[139]=Fi[139]=20,Vr[98]=Dn[98]=9,hn[98]=Yn[98]=12,Ln[98]=Fi[98]=22,Vr[99]=Fi[99]=0,hn[99]=Yn[99]=12,Dn[99]=Ln[99]=19,hn[38]=Yn[38]=12,Kn[38]=wi[38]=21,Ln[38]=Fi[38]=22,hn[39]=wi[39]=5,Yn[39]=Kn[39]=16,Ln[39]=Fi[39]=22;var An=[];An[1]=An[169]=wu,An[4]=An[166]=Qo,An[16]=An[154]=nl,An[64]=An[106]=Zu,An[168]=An[2]=Fn,An[162]=An[8]=qo,An[138]=An[32]=Ws,An[42]=An[128]=du,An[5]=An[165]=vs,An[20]=An[150]=bl,An[80]=An[90]=gs,An[65]=An[105]=Da,An[160]=An[10]=il,An[130]=An[40]=tf,An[85]=o,An[101]=An[69]=s,An[149]=An[21]=d,An[86]=An[84]=_,An[89]=An[81]=w,An[96]=An[74]=j,An[24]=An[146]=ie,An[6]=An[164]=ke,An[129]=An[41]=tt,An[66]=An[104]=Pt,An[144]=An[26]=tr,An[36]=An[134]=st,An[9]=An[161]=Zt,An[37]=An[133]=Jt,An[148]=An[22]=yr,An[82]=An[88]=v,An[73]=An[97]=Pn,An[145]=An[25]=jn,An[70]=An[100]=Xe,An[34]=function(l){return[du(l),qo(l)]},An[35]=Ia,An[136]=function(l){return[Ws(l),Fn(l)]},An[153]=function(l){return[nl(l),wu(l)]},An[102]=function(l){return[Qo(l),Zu(l)]},An[155]=ao,An[103]=xo,An[152]=function(l){return[nl(l),Fn(l)]},An[156]=sa,An[137]=function(l){return[Ws(l),wu(l)]},An[139]=ka,An[98]=function(l){return[qo(l),Zu(l)]},An[99]=os,An[38]=function(l){return[Qo(l),du(l)]},An[39]=ba;function Ge(l,A,y){return(l-A)/(y-A)}function al(l){return l.constructor.toString().indexOf("Array")>-1}function Bi(l,A,y){for(var b=l.length-1,T=l[0].length-1,P={rows:b,cols:T,cells:[]},R=A+Math.abs(y),U=0;U<b;++U){P.cells[U]=[];for(var H=0;H<T;++H){var N=0,Q=l[U+1][H],K=l[U+1][H+1],ae=l[U][H+1],ge=l[U][H];if(!(isNaN(Q)||isNaN(K)||isNaN(ae)||isNaN(ge))){N|=Q<A?0:Q>R?128:64,N|=K<A?0:K>R?32:16,N|=ae<A?0:ae>R?8:4,N|=ge<A?0:ge>R?2:1;var pt=+N,at=0;if(N===17||N===18||N===33||N===34||N===38||N===68||N===72||N===98||N===102||N===132||N===136||N===137||N===152||N===153){var Nt=(Q+K+ae+ge)/4;at=Nt>R?2:Nt<A?0:1,N===34?at===1?N=35:at===0&&(N=136):N===136?at===1?(N=35,at=4):at===0&&(N=34):N===17?at===1?(N=155,at=4):at===0&&(N=153):N===68?at===1?(N=103,at=4):at===0&&(N=102):N===153?at===1&&(N=155):N===102?at===1&&(N=103):N===152?at<2&&(N=156,at=1):N===137?at<2&&(N=139,at=1):N===98?at<2&&(N=99,at=1):N===38?at<2&&(N=39,at=1):N===18?at>0?(N=156,at=4):N=152:N===33?at>0?(N=139,at=4):N=137:N===72?at>0?(N=99,at=4):N=98:N===132&&(at>0?(N=39,at=4):N=38)}if(N!=0&&N!=170){var dt,Ke,ht,Ht,Bt,ir,Kt,fr;dt=Ke=ht=Ht=Bt=ir=Kt=fr=.5;var Ct=[];N===1?(ht=1-Ge(A,ae,ge),fr=1-Ge(A,Q,ge),Ct.push(Dn[N])):N===169?(ht=Ge(R,ge,ae),fr=Ge(R,ge,Q),Ct.push(Dn[N])):N===4?(ir=1-Ge(A,K,ae),Ht=Ge(A,ge,ae),Ct.push(hn[N])):N===166?(ir=Ge(R,ae,K),Ht=1-Ge(R,ae,ge),Ct.push(hn[N])):N===16?(Bt=Ge(A,ae,K),Ke=Ge(A,Q,K),Ct.push(Vr[N])):N===154?(Bt=1-Ge(R,K,ae),Ke=1-Ge(R,K,Q),Ct.push(Vr[N])):N===64?(Kt=Ge(A,ge,Q),dt=1-Ge(A,K,Q),Ct.push(Ln[N])):N===106?(Kt=1-Ge(R,Q,ge),dt=Ge(R,Q,K),Ct.push(Ln[N])):N===168?(Ht=Ge(R,ge,ae),ht=Ge(A,ge,ae),fr=Ge(A,ge,Q),Kt=Ge(R,ge,Q),Ct.push(Yn[N]),Ct.push(Dn[N])):N===2?(Ht=1-Ge(A,ae,ge),ht=1-Ge(R,ae,ge),fr=1-Ge(R,Q,ge),Kt=1-Ge(A,Q,ge),Ct.push(Yn[N]),Ct.push(Dn[N])):N===162?(Bt=Ge(R,ae,K),ir=Ge(A,ae,K),Ht=1-Ge(A,ae,ge),ht=1-Ge(R,ae,ge),Ct.push(Yn[N]),Ct.push(Dn[N])):N===8?(Bt=1-Ge(A,K,ae),ir=1-Ge(R,K,ae),Ht=Ge(R,ge,ae),ht=Ge(A,ge,ae),Ct.push(Vr[N]),Ct.push(hn[N])):N===138?(Bt=1-Ge(A,K,ae),ir=1-Ge(R,K,ae),dt=1-Ge(R,K,Q),Ke=1-Ge(A,K,Q),Ct.push(Vr[N]),Ct.push(hn[N])):N===32?(Bt=Ge(R,ae,K),ir=Ge(A,ae,K),dt=Ge(A,Q,K),Ke=Ge(R,Q,K),Ct.push(Vr[N]),Ct.push(hn[N])):N===42?(fr=1-Ge(R,Q,ge),Kt=1-Ge(A,Q,ge),dt=Ge(A,Q,K),Ke=Ge(R,Q,K),Ct.push(Kn[N]),Ct.push(Ln[N])):N===128&&(fr=Ge(A,ge,Q),Kt=Ge(R,ge,Q),dt=1-Ge(R,K,Q),Ke=1-Ge(A,K,Q),Ct.push(Kn[N]),Ct.push(Ln[N])),N===5?(ir=1-Ge(A,K,ae),fr=1-Ge(A,Q,ge),Ct.push(hn[N])):N===165?(ir=Ge(R,ae,K),fr=Ge(R,ge,Q),Ct.push(hn[N])):N===20?(Ht=Ge(A,ge,ae),Ke=Ge(A,Q,K),Ct.push(Yn[N])):N===150?(Ht=1-Ge(R,ae,ge),Ke=1-Ge(R,K,Q),Ct.push(Yn[N])):N===80?(Bt=Ge(A,ae,K),Kt=Ge(A,ge,Q),Ct.push(Vr[N])):N===90?(Bt=1-Ge(R,K,ae),Kt=1-Ge(R,Q,ge),Ct.push(Vr[N])):N===65?(ht=1-Ge(A,ae,ge),dt=1-Ge(A,K,Q),Ct.push(Dn[N])):N===105?(ht=Ge(R,ge,ae),dt=Ge(R,Q,K),Ct.push(Dn[N])):N===160?(Bt=Ge(R,ae,K),ir=Ge(A,ae,K),fr=Ge(A,ge,Q),Kt=Ge(R,ge,Q),Ct.push(Vr[N]),Ct.push(hn[N])):N===10?(Bt=1-Ge(A,K,ae),ir=1-Ge(R,K,ae),fr=1-Ge(R,Q,ge),Kt=1-Ge(A,Q,ge),Ct.push(Vr[N]),Ct.push(hn[N])):N===130?(Ht=1-Ge(A,ae,ge),ht=1-Ge(R,ae,ge),dt=1-Ge(R,K,Q),Ke=1-Ge(A,K,Q),Ct.push(Yn[N]),Ct.push(Dn[N])):N===40?(Ht=Ge(R,ge,ae),ht=Ge(A,ge,ae),dt=Ge(A,Q,K),Ke=Ge(R,Q,K),Ct.push(Yn[N]),Ct.push(Dn[N])):N===101?(ir=Ge(R,ae,K),dt=Ge(R,Q,K),Ct.push(hn[N])):N===69?(ir=1-Ge(A,K,ae),dt=1-Ge(A,K,Q),Ct.push(hn[N])):N===149?(fr=Ge(R,ge,Q),Ke=1-Ge(R,K,Q),Ct.push(Kn[N])):N===21?(fr=1-Ge(A,Q,ge),Ke=Ge(A,Q,K),Ct.push(Kn[N])):N===86?(Ht=1-Ge(R,ae,ge),Kt=1-Ge(R,Q,ge),Ct.push(Yn[N])):N===84?(Ht=Ge(A,ge,ae),Kt=Ge(A,ge,Q),Ct.push(Yn[N])):N===89?(Bt=1-Ge(R,K,ae),ht=Ge(R,ge,ae),Ct.push(Dn[N])):N===81?(Bt=Ge(A,ae,K),ht=1-Ge(A,ae,ge),Ct.push(Dn[N])):N===96?(Bt=Ge(R,ae,K),ir=Ge(A,ae,K),Kt=Ge(A,ge,Q),dt=Ge(R,Q,K),Ct.push(Vr[N]),Ct.push(hn[N])):N===74?(Bt=1-Ge(A,K,ae),ir=1-Ge(R,K,ae),Kt=1-Ge(R,Q,ge),dt=1-Ge(A,K,Q),Ct.push(Vr[N]),Ct.push(hn[N])):N===24?(Bt=1-Ge(R,K,ae),Ht=Ge(R,ge,ae),ht=Ge(A,ge,ae),Ke=Ge(A,Q,K),Ct.push(Vr[N]),Ct.push(Dn[N])):N===146?(Bt=Ge(A,ae,K),Ht=1-Ge(A,ae,ge),ht=1-Ge(R,ae,ge),Ke=1-Ge(R,K,Q),Ct.push(Vr[N]),Ct.push(Dn[N])):N===6?(ir=1-Ge(A,K,ae),Ht=1-Ge(R,ae,ge),fr=1-Ge(R,Q,ge),Kt=1-Ge(A,Q,ge),Ct.push(hn[N]),Ct.push(Yn[N])):N===164?(ir=Ge(R,ae,K),Ht=Ge(A,ge,ae),fr=Ge(A,ge,Q),Kt=Ge(R,ge,Q),Ct.push(hn[N]),Ct.push(Yn[N])):N===129?(ht=1-Ge(A,ae,ge),fr=Ge(R,ge,Q),dt=1-Ge(R,K,Q),Ke=1-Ge(A,K,Q),Ct.push(Dn[N]),Ct.push(Kn[N])):N===41?(ht=Ge(R,ge,ae),fr=1-Ge(A,Q,ge),dt=Ge(A,Q,K),Ke=Ge(R,Q,K),Ct.push(Dn[N]),Ct.push(Kn[N])):N===66?(Ht=1-Ge(A,ae,ge),ht=1-Ge(R,ae,ge),Kt=1-Ge(R,Q,ge),dt=1-Ge(A,K,Q),Ct.push(Yn[N]),Ct.push(Dn[N])):N===104?(Ht=Ge(R,ge,ae),ht=Ge(A,ge,ae),Kt=Ge(A,ge,Q),dt=Ge(R,Q,K),Ct.push(Dn[N]),Ct.push(Fi[N])):N===144?(Bt=Ge(A,ae,K),fr=Ge(A,ge,Q),Kt=Ge(R,ge,Q),Ke=1-Ge(R,K,Q),Ct.push(Vr[N]),Ct.push(Ln[N])):N===26?(Bt=1-Ge(R,K,ae),fr=1-Ge(R,Q,ge),Kt=1-Ge(A,Q,ge),Ke=Ge(A,Q,K),Ct.push(Vr[N]),Ct.push(Ln[N])):N===36?(ir=Ge(R,ae,K),Ht=Ge(A,ge,ae),dt=Ge(A,Q,K),Ke=Ge(R,Q,K),Ct.push(hn[N]),Ct.push(Yn[N])):N===134?(ir=1-Ge(A,K,ae),Ht=1-Ge(R,ae,ge),dt=1-Ge(R,K,Q),Ke=1-Ge(A,K,Q),Ct.push(hn[N]),Ct.push(Yn[N])):N===9?(Bt=1-Ge(A,K,ae),ir=1-Ge(R,K,ae),ht=Ge(R,ge,ae),fr=1-Ge(A,Q,ge),Ct.push(Vr[N]),Ct.push(hn[N])):N===161?(Bt=Ge(R,ae,K),ir=Ge(A,ae,K),ht=1-Ge(A,ae,ge),fr=Ge(R,ge,Q),Ct.push(Vr[N]),Ct.push(hn[N])):N===37?(ir=Ge(R,ae,K),fr=1-Ge(A,Q,ge),dt=Ge(A,Q,K),Ke=Ge(R,Q,K),Ct.push(hn[N]),Ct.push(Kn[N])):N===133?(ir=1-Ge(A,K,ae),fr=Ge(R,ge,Q),dt=1-Ge(R,K,Q),Ke=1-Ge(A,K,Q),Ct.push(hn[N]),Ct.push(Kn[N])):N===148?(Ht=Ge(A,ge,ae),fr=Ge(A,ge,Q),Kt=Ge(R,ge,Q),Ke=1-Ge(R,K,Q),Ct.push(Yn[N]),Ct.push(Ln[N])):N===22?(Ht=1-Ge(R,ae,ge),fr=1-Ge(R,Q,ge),Kt=1-Ge(A,Q,ge),Ke=Ge(A,Q,K),Ct.push(Yn[N]),Ct.push(Ln[N])):N===82?(Bt=Ge(A,ae,K),Ht=1-Ge(A,ae,ge),ht=1-Ge(R,ae,ge),Kt=1-Ge(R,Q,ge),Ct.push(Vr[N]),Ct.push(Dn[N])):N===88?(Bt=1-Ge(R,K,ae),Ht=Ge(R,ge,ae),ht=Ge(A,ge,ae),Kt=Ge(A,ge,Q),Ct.push(Vr[N]),Ct.push(Dn[N])):N===73?(Bt=1-Ge(A,K,ae),ir=1-Ge(R,K,ae),ht=Ge(R,ge,ae),dt=1-Ge(A,K,Q),Ct.push(Vr[N]),Ct.push(hn[N])):N===97?(Bt=Ge(R,ae,K),ir=Ge(A,ae,K),ht=1-Ge(A,ae,ge),dt=Ge(R,Q,K),Ct.push(Vr[N]),Ct.push(hn[N])):N===145?(Bt=Ge(A,ae,K),ht=1-Ge(A,ae,ge),fr=Ge(R,ge,Q),Ke=1-Ge(R,K,Q),Ct.push(Vr[N]),Ct.push(Kn[N])):N===25?(Bt=1-Ge(R,K,ae),ht=Ge(R,ge,ae),fr=1-Ge(A,Q,ge),Ke=Ge(A,Q,K),Ct.push(Vr[N]),Ct.push(Kn[N])):N===70?(ir=1-Ge(A,K,ae),Ht=1-Ge(R,ae,ge),Kt=1-Ge(R,Q,ge),dt=1-Ge(A,K,Q),Ct.push(hn[N]),Ct.push(Yn[N])):N===100?(ir=Ge(R,ae,K),Ht=Ge(A,ge,ae),Kt=Ge(A,ge,Q),dt=Ge(R,Q,K),Ct.push(hn[N]),Ct.push(Yn[N])):N===34?(at===0?(Bt=1-Ge(A,K,ae),ir=1-Ge(R,K,ae),Ht=Ge(R,ge,ae),ht=Ge(A,ge,ae),fr=Ge(A,ge,Q),Kt=Ge(R,ge,Q),dt=1-Ge(R,K,Q),Ke=1-Ge(A,K,Q)):(Bt=Ge(R,ae,K),ir=Ge(A,ae,K),Ht=1-Ge(A,ae,ge),ht=1-Ge(R,ae,ge),fr=1-Ge(R,Q,ge),Kt=1-Ge(A,Q,ge),dt=Ge(A,Q,K),Ke=Ge(R,Q,K)),Ct.push(Vr[N]),Ct.push(hn[N]),Ct.push(Kn[N]),Ct.push(Ln[N])):N===35?(at===4?(Bt=1-Ge(A,K,ae),ir=1-Ge(R,K,ae),Ht=Ge(R,ge,ae),ht=Ge(A,ge,ae),fr=Ge(A,ge,Q),Kt=Ge(R,ge,Q),dt=1-Ge(R,K,Q),Ke=1-Ge(A,K,Q)):(Bt=Ge(R,ae,K),ir=Ge(A,ae,K),Ht=1-Ge(A,ae,ge),ht=1-Ge(R,ae,ge),fr=1-Ge(R,Q,ge),Kt=1-Ge(A,Q,ge),dt=Ge(A,Q,K),Ke=Ge(R,Q,K)),Ct.push(Vr[N]),Ct.push(hn[N]),Ct.push(Dn[N]),Ct.push(Ln[N])):N===136?(at===0?(Bt=Ge(R,ae,K),ir=Ge(A,ae,K),Ht=1-Ge(A,ae,ge),ht=1-Ge(R,ae,ge),fr=1-Ge(R,Q,ge),Kt=1-Ge(A,Q,ge),dt=Ge(A,Q,K),Ke=Ge(R,Q,K)):(Bt=1-Ge(A,K,ae),ir=1-Ge(R,K,ae),Ht=Ge(R,ge,ae),ht=Ge(A,ge,ae),fr=Ge(A,ge,Q),Kt=Ge(R,ge,Q),dt=1-Ge(R,K,Q),Ke=1-Ge(A,K,Q)),Ct.push(Vr[N]),Ct.push(hn[N]),Ct.push(Kn[N]),Ct.push(Ln[N])):N===153?(at===0?(Bt=Ge(A,ae,K),ht=1-Ge(A,ae,ge),fr=1-Ge(A,Q,ge),Ke=Ge(A,Q,K)):(Bt=1-Ge(R,K,ae),ht=Ge(R,ge,ae),fr=Ge(R,ge,Q),Ke=1-Ge(R,K,Q)),Ct.push(Vr[N]),Ct.push(Dn[N])):N===102?(at===0?(ir=1-Ge(A,K,ae),Ht=Ge(A,ge,ae),Kt=Ge(A,ge,Q),dt=1-Ge(A,K,Q)):(ir=Ge(R,ae,K),Ht=1-Ge(R,ae,ge),Kt=1-Ge(R,Q,ge),dt=Ge(R,Q,K)),Ct.push(hn[N]),Ct.push(Ln[N])):N===155?(at===4?(Bt=Ge(A,ae,K),ht=1-Ge(A,ae,ge),fr=1-Ge(A,Q,ge),Ke=Ge(A,Q,K)):(Bt=1-Ge(R,K,ae),ht=Ge(R,ge,ae),fr=Ge(R,ge,Q),Ke=1-Ge(R,K,Q)),Ct.push(Vr[N]),Ct.push(Kn[N])):N===103?(at===4?(ir=1-Ge(A,K,ae),Ht=Ge(A,ge,ae),Kt=Ge(A,ge,Q),dt=1-Ge(A,K,Q)):(ir=Ge(R,ae,K),Ht=1-Ge(R,ae,ge),Kt=1-Ge(R,Q,ge),dt=Ge(R,Q,K)),Ct.push(hn[N]),Ct.push(Yn[N])):N===152?(at===0?(Bt=Ge(A,ae,K),Ht=1-Ge(A,ae,ge),ht=1-Ge(R,ae,ge),fr=1-Ge(R,Q,ge),Kt=1-Ge(A,Q,ge),Ke=Ge(A,Q,K)):(Bt=1-Ge(R,K,ae),Ht=Ge(R,ge,ae),ht=Ge(A,ge,ae),fr=Ge(A,ge,Q),Kt=Ge(R,ge,Q),Ke=1-Ge(R,K,Q)),Ct.push(Vr[N]),Ct.push(Yn[N]),Ct.push(Dn[N])):N===156?(at===4?(Bt=Ge(A,ae,K),Ht=1-Ge(A,ae,ge),ht=1-Ge(R,ae,ge),fr=1-Ge(R,Q,ge),Kt=1-Ge(A,Q,ge),Ke=Ge(A,Q,K)):(Bt=1-Ge(R,K,ae),Ht=Ge(R,ge,ae),ht=Ge(A,ge,ae),fr=Ge(A,ge,Q),Kt=Ge(R,ge,Q),Ke=1-Ge(R,K,Q)),Ct.push(Vr[N]),Ct.push(Dn[N]),Ct.push(Ln[N])):N===137?(at===0?(Bt=Ge(R,ae,K),ir=Ge(A,ae,K),ht=1-Ge(A,ae,ge),fr=1-Ge(A,Q,ge),dt=Ge(A,Q,K),Ke=Ge(R,Q,K)):(Bt=1-Ge(A,K,ae),ir=1-Ge(R,K,ae),ht=Ge(R,ge,ae),fr=Ge(R,ge,Q),dt=1-Ge(R,K,Q),Ke=1-Ge(A,K,Q)),Ct.push(Vr[N]),Ct.push(hn[N]),Ct.push(Dn[N])):N===139?(at===4?(Bt=Ge(R,ae,K),ir=Ge(A,ae,K),ht=1-Ge(A,ae,ge),fr=1-Ge(A,Q,ge),dt=Ge(A,Q,K),Ke=Ge(R,Q,K)):(Bt=1-Ge(A,K,ae),ir=1-Ge(R,K,ae),ht=Ge(R,ge,ae),fr=Ge(R,ge,Q),dt=1-Ge(R,K,Q),Ke=1-Ge(A,K,Q)),Ct.push(Vr[N]),Ct.push(hn[N]),Ct.push(Kn[N])):N===98?(at===0?(Bt=1-Ge(A,K,ae),ir=1-Ge(R,K,ae),Ht=Ge(R,ge,ae),ht=Ge(A,ge,ae),Kt=Ge(A,ge,Q),dt=1-Ge(A,K,Q)):(Bt=Ge(R,ae,K),ir=Ge(A,ae,K),Ht=1-Ge(A,ae,ge),ht=1-Ge(R,ae,ge),Kt=1-Ge(R,Q,ge),dt=Ge(R,Q,K)),Ct.push(Vr[N]),Ct.push(hn[N]),Ct.push(Ln[N])):N===99?(at===4?(Bt=1-Ge(A,K,ae),ir=1-Ge(R,K,ae),Ht=Ge(R,ge,ae),ht=Ge(A,ge,ae),Kt=Ge(A,ge,Q),dt=1-Ge(A,K,Q)):(Bt=Ge(R,ae,K),ir=Ge(A,ae,K),Ht=1-Ge(A,ae,ge),ht=1-Ge(R,ae,ge),Kt=1-Ge(R,Q,ge),dt=Ge(R,Q,K)),Ct.push(Vr[N]),Ct.push(hn[N]),Ct.push(Dn[N])):N===38?(at===0?(ir=1-Ge(A,K,ae),Ht=Ge(A,ge,ae),fr=Ge(A,ge,Q),Kt=Ge(R,ge,Q),dt=1-Ge(R,K,Q),Ke=1-Ge(A,K,Q)):(ir=Ge(R,ae,K),Ht=1-Ge(R,ae,ge),fr=1-Ge(R,Q,ge),Kt=1-Ge(A,Q,ge),dt=Ge(A,Q,K),Ke=Ge(R,Q,K)),Ct.push(hn[N]),Ct.push(Kn[N]),Ct.push(Ln[N])):N===39?(at===4?(ir=1-Ge(A,K,ae),Ht=Ge(A,ge,ae),fr=Ge(A,ge,Q),Kt=Ge(R,ge,Q),dt=1-Ge(R,K,Q),Ke=1-Ge(A,K,Q)):(ir=Ge(R,ae,K),Ht=1-Ge(R,ae,ge),fr=1-Ge(R,Q,ge),Kt=1-Ge(A,Q,ge),dt=Ge(A,Q,K),Ke=Ge(R,Q,K)),Ct.push(hn[N]),Ct.push(Yn[N]),Ct.push(Ln[N])):N===85&&(Bt=1,ir=0,Ht=1,ht=0,fr=0,Kt=1,dt=0,Ke=1),(dt<0||dt>1||Ke<0||Ke>1||Bt<0||Bt>1||Ht<0||Ht>1||fr<0||fr>1||Kt<0||Kt>1)&&console.log("MarchingSquaresJS-isoBands: "+N+" "+pt+" "+Q+","+K+","+ae+","+ge+" "+at+" "+dt+" "+Ke+" "+Bt+" "+ir+" "+Ht+" "+ht+" "+fr+" "+Kt),P.cells[U][H]={cval:N,cval_real:pt,flipped:at,topleft:dt,topright:Ke,righttop:Bt,rightbottom:ir,bottomright:Ht,bottomleft:ht,leftbottom:fr,lefttop:Kt,edges:Ct}}}}}return P}function lt(l){for(var A=[],y=l.rows,b=l.cols,T=[],P=0;P<y;P++)for(var R=0;R<b;R++)if(typeof l.cells[P][R]!="undefined"&&l.cells[P][R].edges.length>0){var U=l.cells[P][R],H=Eh(U),N=null,Q=R,K=P;H!==null&&T.push([H.p[0]+Q,H.p[1]+K]);do{if(N=Ec(l.cells[K][Q],H.x,H.y,H.o),N!==null)T.push([N.p[0]+Q,N.p[1]+K]),Q+=N.x,K+=N.y,H=N;else break;if(K<0||K>=y||Q<0||Q>=b||typeof l.cells[K][Q]=="undefined"){Q-=N.x,K-=N.y;var ae=ii(l,Q,K,N.x,N.y,N.o);if(ae!==null)ae.path.forEach(function(ge){T.push(ge)}),Q=ae.i,K=ae.j,H=ae;else break}}while(typeof l.cells[K][Q]!="undefined"&&l.cells[K][Q].edges.length>0);A.push(T),T=[],l.cells[P][R].edges.length>0&&R--}return A}function ii(l,A,y,b,T,P){for(var R=l.cells[y][A],U=R.cval_real,H=A+b,N=y+T,Q=[],K=!1;!K;){if(typeof l.cells[N]=="undefined"||typeof l.cells[N][H]=="undefined")if(N-=T,H-=b,R=l.cells[N][H],U=R.cval_real,T===-1)if(P===0)if(U&$a)Q.push([H,N]),b=-1,T=0,P=0;else if(U&bi)Q.push([H+1,N]),b=1,T=0,P=0;else{Q.push([H+R.bottomright,N]),b=0,T=1,P=1,K=!0;break}else if(U&$a)Q.push([H,N]),b=-1,T=0,P=0;else if(U&bi){Q.push([H+R.bottomright,N]),b=0,T=1,P=1,K=!0;break}else{Q.push([H+R.bottomleft,N]),b=0,T=1,P=0,K=!0;break}else if(T===1)if(P===0)if(U&Aa)Q.push([H+1,N+1]),b=1,T=0,P=1;else if(U&oi){Q.push([H+R.topleft,N+1]),b=0,T=-1,P=0,K=!0;break}else{Q.push([H+R.topright,N+1]),b=0,T=-1,P=1,K=!0;break}else U&Aa?(Q.push([H+1,N+1]),b=1,T=0,P=1):(Q.push([H+1,N+1]),b=1,T=0,P=1);else if(b===-1)if(P===0)if(U&oi)Q.push([H,N+1]),b=0,T=1,P=0;else if(U&$a){Q.push([H,N+R.leftbottom]),b=1,T=0,P=0,K=!0;break}else{Q.push([H,N+R.lefttop]),b=1,T=0,P=1,K=!0;break}else if(U&oi)Q.push([H,N+1]),b=0,T=1,P=0;else{console.log("MarchingSquaresJS-isoBands: wtf");break}else if(b===1)if(P===0)if(U&bi)Q.push([H+1,N]),b=0,T=-1,P=1;else{Q.push([H+1,N+R.rightbottom]),b=-1,T=0,P=0,K=!0;break}else if(U&bi)Q.push([H+1,N]),b=0,T=-1,P=1;else if(U&Aa){Q.push([H+1,N+R.righttop]),b=-1,T=0,P=1;break}else{Q.push([H+1,N+R.rightbottom]),b=-1,T=0,P=0,K=!0;break}else{console.log("MarchingSquaresJS-isoBands: we came from nowhere!");break}else if(R=l.cells[N][H],U=R.cval_real,b===-1)if(P===0)if(typeof l.cells[N-1]!="undefined"&&typeof l.cells[N-1][H]!="undefined")b=0,T=-1,P=1;else if(U&$a)Q.push([H,N]);else{Q.push([H+R.bottomright,N]),b=0,T=1,P=1,K=!0;break}else if(U&oi)console.log("MarchingSquaresJS-isoBands: proceeding in x-direction!");else{console.log("MarchingSquaresJS-isoBands: found entry from top at "+H+","+N);break}else if(b===1)if(P===0){console.log("MarchingSquaresJS-isoBands: wtf");break}else if(typeof l.cells[N+1]!="undefined"&&typeof l.cells[N+1][H]!="undefined")b=0,T=1,P=0;else if(U&Aa)Q.push([H+1,N+1]),b=1,T=0,P=1;else{Q.push([H+R.topleft,N+1]),b=0,T=-1,P=0,K=!0;break}else if(T===-1)if(P===1)if(typeof l.cells[N][H+1]!="undefined")b=1,T=0,P=1;else if(U&bi)Q.push([H+1,N]),b=0,T=-1,P=1;else{Q.push([H+1,N+R.righttop]),b=-1,T=0,P=1,K=!0;break}else{console.log("MarchingSquaresJS-isoBands: wtf");break}else if(T===1)if(P===0)if(typeof l.cells[N][H-1]!="undefined")b=-1,T=0,P=0;else if(U&oi)Q.push([H,N+1]),b=0,T=1,P=0;else{Q.push([H,N+R.leftbottom]),b=1,T=0,P=0,K=!0;break}else{console.log("MarchingSquaresJS-isoBands: wtf");break}else{console.log("MarchingSquaresJS-isoBands: where did we came from???");break}if(H+=b,N+=T,H===A&&N===y)break}return{path:Q,i:H,j:N,x:b,y:T,o:P}}function xc(l,A){delete l.edges[A];for(var y=A+1;y<l.edges.length;y++)l.edges[y-1]=l.edges[y];l.edges.pop()}function Eh(l){if(l.edges.length>0){var A=l.edges[l.edges.length-1],y=l.cval_real;switch(A){case 0:return y&Aa?{p:[1,l.righttop],x:-1,y:0,o:1}:{p:[l.topleft,1],x:0,y:-1,o:0};case 1:return y&bi?{p:[l.topleft,1],x:0,y:-1,o:0}:{p:[1,l.rightbottom],x:-1,y:0,o:0};case 2:return y&bi?{p:[l.bottomright,0],x:0,y:1,o:1}:{p:[l.topleft,1],x:0,y:-1,o:0};case 3:return y&$a?{p:[l.topleft,1],x:0,y:-1,o:0}:{p:[l.bottomleft,0],x:0,y:1,o:0};case 4:return y&Aa?{p:[1,l.righttop],x:-1,y:0,o:1}:{p:[l.topright,1],x:0,y:-1,o:1};case 5:return y&bi?{p:[l.topright,1],x:0,y:-1,o:1}:{p:[1,l.rightbottom],x:-1,y:0,o:0};case 6:return y&bi?{p:[l.bottomright,0],x:0,y:1,o:1}:{p:[l.topright,1],x:0,y:-1,o:1};case 7:return y&$a?{p:[l.topright,1],x:0,y:-1,o:1}:{p:[l.bottomleft,0],x:0,y:1,o:0};case 8:return y&bi?{p:[l.bottomright,0],x:0,y:1,o:1}:{p:[1,l.righttop],x:-1,y:0,o:1};case 9:return y&$a?{p:[1,l.righttop],x:-1,y:0,o:1}:{p:[l.bottomleft,0],x:0,y:1,o:0};case 10:return y&$a?{p:[0,l.leftbottom],x:1,y:0,o:0}:{p:[1,l.righttop],x:-1,y:0,o:1};case 11:return y&oi?{p:[1,l.righttop],x:-1,y:0,o:1}:{p:[0,l.lefttop],x:1,y:0,o:1};case 12:return y&bi?{p:[l.bottomright,0],x:0,y:1,o:1}:{p:[1,l.rightbottom],x:-1,y:0,o:0};case 13:return y&$a?{p:[1,l.rightbottom],x:-1,y:0,o:0}:{p:[l.bottomleft,0],x:0,y:1,o:0};case 14:return y&$a?{p:[0,l.leftbottom],x:1,y:0,o:0}:{p:[1,l.rightbottom],x:-1,y:0,o:0};case 15:return y&oi?{p:[1,l.rightbottom],x:-1,y:0,o:0}:{p:[0,l.lefttop],x:1,y:0,o:1};case 16:return y&bi?{p:[l.bottomright,0],x:0,y:1,o:1}:{p:[0,l.leftbottom],x:1,y:0,o:0};case 17:return y&oi?{p:[l.bottomright,0],x:0,y:1,o:1}:{p:[0,l.lefttop],x:1,y:0,o:1};case 18:return y&$a?{p:[0,l.leftbottom],x:1,y:0,o:0}:{p:[l.bottomleft,0],x:0,y:1,o:0};case 19:return y&oi?{p:[l.bottomleft,0],x:0,y:1,o:0}:{p:[0,l.lefttop],x:1,y:0,o:1};case 20:return y&oi?{p:[l.topleft,1],x:0,y:-1,o:0}:{p:[0,l.leftbottom],x:1,y:0,o:0};case 21:return y&Aa?{p:[0,l.leftbottom],x:1,y:0,o:0}:{p:[l.topright,1],x:0,y:-1,o:1};case 22:return y&oi?{p:[l.topleft,1],x:0,y:-1,o:0}:{p:[0,l.lefttop],x:1,y:0,o:1};case 23:return y&Aa?{p:[0,l.lefttop],x:1,y:0,o:1}:{p:[l.topright,1],x:0,y:-1,o:1};default:console.log("MarchingSquaresJS-isoBands: edge index out of range!"),console.log(l);break}}return null}function Ec(l,A,y,b){var T,P,R,U,H=l.cval,N;switch(A){case-1:switch(b){case 0:T=hn[H],R=qn[H],U=Ui[H],N=Gi[H];break;default:T=Vr[H],R=wn[H],U=Wn[H],N=Pi[H];break}break;case 1:switch(b){case 0:T=Kn[H],R=Ci[H],U=ji[H],N=li[H];break;default:T=Ln[H],R=qi[H],U=hi[H],N=Si[H];break}break;default:switch(y){case-1:switch(b){case 0:T=Fi[H],R=Ii[H],U=Hn[H],N=yi[H];break;default:T=wi[H],R=Yi[H],U=_i[H],N=di[H];break}break;case 1:switch(b){case 0:T=Dn[H],R=Nn[H],U=Wi[H],N=$n[H];break;default:T=Yn[H],R=Li[H],U=Oi[H],N=Qi[H];break}break}break}if(P=l.edges.indexOf(T),typeof l.edges[P]!="undefined")xc(l,P);else return null;switch(H=l.cval_real,T){case 0:H&Aa?(A=l.topleft,y=1):(A=1,y=l.righttop);break;case 1:H&bi?(A=1,y=l.rightbottom):(A=l.topleft,y=1);break;case 2:H&bi?(A=l.topleft,y=1):(A=l.bottomright,y=0);break;case 3:H&$a?(A=l.bottomleft,y=0):(A=l.topleft,y=1);break;case 4:H&Aa?(A=l.topright,y=1):(A=1,y=l.righttop);break;case 5:H&bi?(A=1,y=l.rightbottom):(A=l.topright,y=1);break;case 6:H&bi?(A=l.topright,y=1):(A=l.bottomright,y=0);break;case 7:H&$a?(A=l.bottomleft,y=0):(A=l.topright,y=1);break;case 8:H&bi?(A=1,y=l.righttop):(A=l.bottomright,y=0);break;case 9:H&$a?(A=l.bottomleft,y=0):(A=1,y=l.righttop);break;case 10:H&$a?(A=1,y=l.righttop):(A=0,y=l.leftbottom);break;case 11:H&oi?(A=0,y=l.lefttop):(A=1,y=l.righttop);break;case 12:H&bi?(A=1,y=l.rightbottom):(A=l.bottomright,y=0);break;case 13:H&$a?(A=l.bottomleft,y=0):(A=1,y=l.rightbottom);break;case 14:H&$a?(A=1,y=l.rightbottom):(A=0,y=l.leftbottom);break;case 15:H&oi?(A=0,y=l.lefttop):(A=1,y=l.rightbottom);break;case 16:H&bi?(A=0,y=l.leftbottom):(A=l.bottomright,y=0);break;case 17:H&oi?(A=0,y=l.lefttop):(A=l.bottomright,y=0);break;case 18:H&$a?(A=l.bottomleft,y=0):(A=0,y=l.leftbottom);break;case 19:H&oi?(A=0,y=l.lefttop):(A=l.bottomleft,y=0);break;case 20:H&oi?(A=0,y=l.leftbottom):(A=l.topleft,y=1);break;case 21:H&Aa?(A=l.topright,y=1):(A=0,y=l.leftbottom);break;case 22:H&oi?(A=0,y=l.lefttop):(A=l.topleft,y=1);break;case 23:H&Aa?(A=l.topright,y=1):(A=0,y=l.lefttop);break;default:return console.log("MarchingSquaresJS-isoBands: edge index out of range!"),console.log(l),null}return(typeof A=="undefined"||typeof y=="undefined"||typeof R=="undefined"||typeof U=="undefined"||typeof N=="undefined")&&(console.log("MarchingSquaresJS-isoBands: undefined value!"),console.log(l),console.log(A+" "+y+" "+R+" "+U+" "+N)),{p:[A,y],x:R,y:U,o:N}}function s0(l){var A=[],y=0;return l.cells.forEach(function(b,T){b.forEach(function(P,R){if(typeof P!="undefined"){var U=An[P.cval](P);typeof U=="object"&&al(U)?typeof U[0]=="object"&&al(U[0])?typeof U[0][0]=="object"&&al(U[0][0])?U.forEach(function(H){H.forEach(function(N){N[0]+=R,N[1]+=T}),A[y++]=H}):(U.forEach(function(H){H[0]+=R,H[1]+=T}),A[y++]=U):console.log("MarchingSquaresJS-isoBands: bandcell polygon with malformed coordinates"):console.log("MarchingSquaresJS-isoBands: bandcell polygon with null coordinates")}})}),A}function rf(l,A,y){if(y=y||{},!isObject(y))throw new Error("options is invalid");var b=y.zProperty||"elevation",T=y.commonProperties||{},P=y.breaksProperties||[];if(collectionOf(l,"Point","Input must contain Points"),!A)throw new Error("breaks is required");if(!Array.isArray(A))throw new Error("breaks is not an Array");if(!isObject(T))throw new Error("commonProperties is not an Object");if(!Array.isArray(P))throw new Error("breaksProperties is not an Array");var R=$s(l,{zProperty:b,flip:!0}),U=Je(R,A,b);U=bc(U,R,l);var H=U.map(function(N,Q){if(P[Q]&&!isObject(P[Q]))throw new Error("Each mappedProperty is required to be an Object");var K=objectAssign({},T,P[Q]);K[b]=N[b];var ae=multiPolygon(N.groupedRings,K);return ae});return featureCollection(H)}function Je(l,A,y){for(var b=[],T=1;T<A.length;T++){var P=+A[T-1],R=+A[T],U=Ys(l,P,R-P),H=Ef(U),N=u0(H),Q={};Q.groupedRings=N,Q[y]=P+"-"+R,b.push(Q)}return b}function bc(l,A,y){var b=bbox(y),T=b[2]-b[0],P=b[3]-b[1],R=b[0],U=b[1],H=A[0].length-1,N=A.length-1,Q=T/H,K=P/N,ae=function(ge){ge[0]=ge[0]*Q+R,ge[1]=ge[1]*K+U};return l.forEach(function(ge){ge.groupedRings.forEach(function(pt){pt.forEach(function(at){at.forEach(ae)})})}),l}function Ef(l){var A=[],y=[];l.forEach(function(T){var P=area(polygon([T]));y.push(P),A.push({ring:T,area:P})}),y.sort(function(T,P){return P-T});var b=[];return y.forEach(function(T){for(var P=0;P<A.length;P++)if(A[P].area===T){b.push(A[P].ring),A.splice(P,1);break}}),b}function u0(l){for(var A=l.map(function(H){return{lrCoordinates:H,grouped:!1}}),y=[];!nf(A);)for(var b=0;b<A.length;b++)if(!A[b].grouped){var T=[];T.push(A[b].lrCoordinates),A[b].grouped=!0;for(var P=polygon([A[b].lrCoordinates]),R=b+1;R<A.length;R++)if(!A[R].grouped){var U=polygon([A[R].lrCoordinates]);Bf(U,P)&&(T.push(A[R].lrCoordinates),A[R].grouped=!0)}y.push(T)}return y}function Bf(l,A){for(var y=explode(l),b=0;b<y.features.length;b++)if(!booleanPointInPolygon(y.features[b],A))return!1;return!0}function nf(l){for(var A=0;A<l.length;A++)if(l[A].grouped===!1)return!1;return!0}var l0=null;function bf(l,A,y){if(y=y||{},!isObject(y))throw new Error("options is invalid");var b=y.pivot,T=y.mutate;if(!l)throw new Error("geojson is required");if(A==null||isNaN(A))throw new Error("angle is required");return A===0||(b||(b=centroid(l)),(T===!1||T===void 0)&&(l=clone(l)),coordEach(l,function(P){var R=rhumbBearing(b,P),U=R+A,H=rhumbDistance(b,P),N=getCoords(rhumbDestination(b,H,U));P[0]=N[0],P[1]=N[1]})),l}var U0=null;function c0(l,A,y){if(y=y||{},!isObject(y))throw new Error("options is invalid");var b=y.origin,T=y.mutate;if(!l)throw new Error("geojson required");if(typeof A!="number"||A===0)throw new Error("invalid factor");var P=Array.isArray(b)||typeof b=="object";return T!==!0&&(l=clone(l)),l.type==="FeatureCollection"&&!P?(featureEach(l,function(R,U){l.features[U]=zu(R,A,b)}),l):zu(l,A,b)}function zu(l,A,y){var b=getType(l)==="Point";return y=Uo(l,y),A===1||b||coordEach(l,function(T){var P=rhumbDistance(y,T),R=rhumbBearing(y,T),U=P*A,H=getCoords(rhumbDestination(y,U,R));T[0]=H[0],T[1]=H[1],T.length===3&&(T[2]*=A)}),l}function Uo(l,A){if(A==null&&(A="centroid"),Array.isArray(A)||typeof A=="object")return getCoord(A);var y=l.bbox?l.bbox:turfBBox(l),b=y[0],T=y[1],P=y[2],R=y[3];switch(A){case"sw":case"southwest":case"westsouth":case"bottomleft":return point([b,T]);case"se":case"southeast":case"eastsouth":case"bottomright":return point([P,T]);case"nw":case"northwest":case"westnorth":case"topleft":return point([b,R]);case"ne":case"northeast":case"eastnorth":case"topright":return point([P,R]);case"center":return center(l);case void 0:case null:case"centroid":return centroid(l);default:throw new Error("invalid origin")}}var Zf=null;function bh(l,A,y,b){if(b=b||{},!isObject(b))throw new Error("options is invalid");var T=b.units,P=b.zTranslation,R=b.mutate;if(!l)throw new Error("geojson is required");if(A==null||isNaN(A))throw new Error("distance is required");if(P&&typeof P!="number"&&isNaN(P))throw new Error("zTranslation is not a number");if(P=P!==void 0?P:0,A===0&&P===0)return l;if(y==null||isNaN(y))throw new Error("direction is required");return A<0&&(A=-A,y=y+180),(R===!1||R===void 0)&&(l=clone(l)),coordEach(l,function(U){var H=getCoords(rhumbDestination(U,A,y,{units:T}));U[0]=H[0],U[1]=H[1],P&&U.length===3&&(U[2]+=P)}),l}var zf=null;function Nl(l){var A=l[0],y=l[1];return[y[0]-A[0],y[1]-A[1]]}function Sc(l,A){return l[0]*A[1]-A[0]*l[1]}function af(l,A){return[l[0]+A[0],l[1]+A[1]]}function f0(l,A){return[l[0]-A[0],l[1]-A[1]]}function oa(l,A){return[l*A[0],l*A[1]]}function Ua(l,A){var y=l[0],b=Nl(l),T=A[0],P=Nl(A),R=Sc(b,P),U=f0(T,y),H=Sc(U,P),N=H/R,Q=af(y,oa(N,b));return Q}function Go(l,A){var y=Nl(l),b=Nl(A);return Sc(y,b)===0}function Uf(l,A){return Go(l,A)?!1:Ua(l,A)}function G0(l,A,y){if(y=y||{},!isObject(y))throw new Error("options is invalid");var b=y.units;if(!l)throw new Error("geojson is required");if(A==null||isNaN(A))throw new Error("distance is required");var T=getType(l),P=l.properties;switch(T){case"LineString":return Gf(l,A,b);case"MultiLineString":var R=[];return flattenEach(l,function(U){R.push(Gf(U,A,b).geometry.coordinates)}),multiLineString(R,P);default:throw new Error("geometry "+T+" is not supported")}}function Gf(l,A,y){var b=[],T=lengthToDegrees(A,y),P=getCoords(l),R=[];return P.forEach(function(U,H){if(H!==P.length-1){var N=h0(U,P[H+1],T);if(b.push(N),H>0){var Q=b[H-1],K=Uf(N,Q);K!==!1&&(Q[1]=K,N[0]=K),R.push(Q[0]),H===P.length-2&&(R.push(N[0]),R.push(N[1]))}P.length===2&&(R.push(N[0]),R.push(N[1]))}}),lineString(R,l.properties)}function h0(l,A,y){var b=Math.sqrt((l[0]-A[0])*(l[0]-A[0])+(l[1]-A[1])*(l[1]-A[1])),T=l[0]+y*(A[1]-l[1])/b,P=A[0]+y*(A[1]-l[1])/b,R=l[1]+y*(l[0]-A[0])/b,U=A[1]+y*(l[0]-A[0])/b;return[[T,R],[P,U]]}var jf=null;function Xi(l){return(l>0)-(l<0)||+l}function Vf(l,A,y){var b=A[0]-l[0],T=A[1]-l[1],P=y[0]-A[0],R=y[1]-A[1];return Xi(b*R-P*T)}function Fl(l,A){var y=l.geometry.coordinates[0].map(function(R){return R[0]}),b=l.geometry.coordinates[0].map(function(R){return R[1]}),T=A.geometry.coordinates[0].map(function(R){return R[0]}),P=A.geometry.coordinates[0].map(function(R){return R[1]});return Math.max.apply(null,y)===Math.max.apply(null,T)&&Math.max.apply(null,b)===Math.max.apply(null,P)&&Math.min.apply(null,y)===Math.min.apply(null,T)&&Math.min.apply(null,b)===Math.min.apply(null,P)}function au(l,A){return A.geometry.coordinates[0].every(function(y){return Oe((0,Z.xm)(y),l)})}function ic(l,A){return l[0]===A[0]&&l[1]===A[1]}var oo=function(){function l(A){this.id=l.buildId(A),this.coordinates=A,this.innerEdges=[],this.outerEdges=[],this.outerEdgesSorted=!1}return l.buildId=function(A){return A.join(",")},l.prototype.removeInnerEdge=function(A){this.innerEdges=this.innerEdges.filter(function(y){return y.from.id!==A.from.id})},l.prototype.removeOuterEdge=function(A){this.outerEdges=this.outerEdges.filter(function(y){return y.to.id!==A.to.id})},l.prototype.addOuterEdge=function(A){this.outerEdges.push(A),this.outerEdgesSorted=!1},l.prototype.sortOuterEdges=function(){var A=this;this.outerEdgesSorted||(this.outerEdges.sort(function(y,b){var T=y.to,P=b.to;if(T.coordinates[0]-A.coordinates[0]>=0&&P.coordinates[0]-A.coordinates[0]<0)return 1;if(T.coordinates[0]-A.coordinates[0]<0&&P.coordinates[0]-A.coordinates[0]>=0)return-1;if(T.coordinates[0]-A.coordinates[0]===0&&P.coordinates[0]-A.coordinates[0]===0)return T.coordinates[1]-A.coordinates[1]>=0||P.coordinates[1]-A.coordinates[1]>=0?T.coordinates[1]-P.coordinates[1]:P.coordinates[1]-T.coordinates[1];var R=Vf(A.coordinates,T.coordinates,P.coordinates);if(R<0)return 1;if(R>0)return-1;var U=Math.pow(T.coordinates[0]-A.coordinates[0],2)+Math.pow(T.coordinates[1]-A.coordinates[1],2),H=Math.pow(P.coordinates[0]-A.coordinates[0],2)+Math.pow(P.coordinates[1]-A.coordinates[1],2);return U-H}),this.outerEdgesSorted=!0)},l.prototype.getOuterEdges=function(){return this.sortOuterEdges(),this.outerEdges},l.prototype.getOuterEdge=function(A){return this.sortOuterEdges(),this.outerEdges[A]},l.prototype.addInnerEdge=function(A){this.innerEdges.push(A)},l}(),Uu=oo,Bl=function(){function l(A,y){this.from=A,this.to=y,this.next=void 0,this.label=void 0,this.symetric=void 0,this.ring=void 0,this.from.addOuterEdge(this),this.to.addInnerEdge(this)}return l.prototype.getSymetric=function(){return this.symetric||(this.symetric=new l(this.to,this.from),this.symetric.symetric=this),this.symetric},l.prototype.deleteEdge=function(){this.from.removeOuterEdge(this),this.to.removeInnerEdge(this)},l.prototype.isEqual=function(A){return this.from.id===A.from.id&&this.to.id===A.to.id},l.prototype.toString=function(){return"Edge { "+this.from.id+" -> "+this.to.id+" }"},l.prototype.toLineString=function(){return(0,Z.Tu)([this.from.coordinates,this.to.coordinates])},l.prototype.compareTo=function(A){return Vf(A.from.coordinates,A.to.coordinates,this.to.coordinates)},l}(),Sf=Bl,Mo=function(){function l(){this.edges=[],this.polygon=void 0,this.envelope=void 0}return l.prototype.push=function(A){this.edges.push(A),this.polygon=this.envelope=void 0},l.prototype.get=function(A){return this.edges[A]},Object.defineProperty(l.prototype,"length",{get:function(){return this.edges.length},enumerable:!0,configurable:!0}),l.prototype.forEach=function(A){this.edges.forEach(A)},l.prototype.map=function(A){return this.edges.map(A)},l.prototype.some=function(A){return this.edges.some(A)},l.prototype.isValid=function(){return!0},l.prototype.isHole=function(){var A=this,y=this.edges.reduce(function(R,U,H){return U.from.coordinates[1]>A.edges[R].from.coordinates[1]&&(R=H),R},0),b=(y===0?this.length:y)-1,T=(y+1)%this.length,P=Vf(this.edges[b].from.coordinates,this.edges[y].from.coordinates,this.edges[T].from.coordinates);return P===0?this.edges[b].from.coordinates[0]>this.edges[T].from.coordinates[0]:P>0},l.prototype.toMultiPoint=function(){return(0,Z.ot)(this.edges.map(function(A){return A.from.coordinates}))},l.prototype.toPolygon=function(){if(this.polygon)return this.polygon;var A=this.edges.map(function(y){return y.from.coordinates});return A.push(this.edges[0].from.coordinates),this.polygon=(0,Z.yu)([A])},l.prototype.getEnvelope=function(){return this.envelope?this.envelope:this.envelope=bs(this.toPolygon())},l.findEdgeRingContaining=function(A,y){var b=A.getEnvelope(),T,P;return y.forEach(function(R){var U=R.getEnvelope();if(P&&(T=P.getEnvelope()),!Fl(U,b)&&au(U,b)){for(var H=A.map(function(pt){return pt.from.coordinates}),N=void 0,Q=function(pt){R.some(function(at){return ic(pt,at.from.coordinates)})||(N=pt)},K=0,ae=H;K<ae.length;K++){var ge=ae[K];Q(ge)}N&&R.inside((0,Z.xm)(N))&&(!P||au(T,U))&&(P=R)}}),P},l.prototype.inside=function(A){return Oe(A,this.toPolygon())},l}(),ol=Mo;function ss(l){if(!l)throw new Error("No geojson passed");if(l.type!=="FeatureCollection"&&l.type!=="GeometryCollection"&&l.type!=="MultiLineString"&&l.type!=="LineString"&&l.type!=="Feature")throw new Error("Invalid input type '"+l.type+"'. Geojson must be FeatureCollection, GeometryCollection, LineString, MultiLineString or Feature")}var ac=function(){function l(){this.edges=[],this.nodes={}}return l.fromGeoJson=function(A){ss(A);var y=new l;return(0,k.nG)(A,function(b){(0,G.nK)(b,"LineString","Graph::fromGeoJson"),(0,k.Lo)(b,function(T,P){if(T){var R=y.getNode(T),U=y.getNode(P);y.addEdge(R,U)}return P})}),y},l.prototype.getNode=function(A){var y=Uu.buildId(A),b=this.nodes[y];return b||(b=this.nodes[y]=new Uu(A)),b},l.prototype.addEdge=function(A,y){var b=new Sf(A,y),T=b.getSymetric();this.edges.push(b),this.edges.push(T)},l.prototype.deleteDangles=function(){var A=this;Object.keys(this.nodes).map(function(y){return A.nodes[y]}).forEach(function(y){return A._removeIfDangle(y)})},l.prototype._removeIfDangle=function(A){var y=this;if(A.innerEdges.length<=1){var b=A.getOuterEdges().map(function(T){return T.to});this.removeNode(A),b.forEach(function(T){return y._removeIfDangle(T)})}},l.prototype.deleteCutEdges=function(){var A=this;this._computeNextCWEdges(),this._findLabeledEdgeRings(),this.edges.forEach(function(y){y.label===y.symetric.label&&(A.removeEdge(y.symetric),A.removeEdge(y))})},l.prototype._computeNextCWEdges=function(A){var y=this;typeof A=="undefined"?Object.keys(this.nodes).forEach(function(b){return y._computeNextCWEdges(y.nodes[b])}):A.getOuterEdges().forEach(function(b,T){A.getOuterEdge((T===0?A.getOuterEdges().length:T)-1).symetric.next=b})},l.prototype._computeNextCCWEdges=function(A,y){for(var b=A.getOuterEdges(),T,P,R=b.length-1;R>=0;--R){var U=b[R],H=U.symetric,N=void 0,Q=void 0;U.label===y&&(N=U),H.label===y&&(Q=H),!(!N||!Q)&&(Q&&(P=Q),N&&(P&&(P.next=N,P=void 0),T||(T=N)))}P&&(P.next=T)},l.prototype._findLabeledEdgeRings=function(){var A=[],y=0;return this.edges.forEach(function(b){if(!(b.label>=0)){A.push(b);var T=b;do T.label=y,T=T.next;while(!b.isEqual(T));y++}}),A},l.prototype.getEdgeRings=function(){var A=this;this._computeNextCWEdges(),this.edges.forEach(function(b){b.label=void 0}),this._findLabeledEdgeRings().forEach(function(b){A._findIntersectionNodes(b).forEach(function(T){A._computeNextCCWEdges(T,b.label)})});var y=[];return this.edges.forEach(function(b){b.ring||y.push(A._findEdgeRing(b))}),y},l.prototype._findIntersectionNodes=function(A){var y=[],b=A,T=function(){var P=0;b.from.getOuterEdges().forEach(function(R){R.label===A.label&&++P}),P>1&&y.push(b.from),b=b.next};do T();while(!A.isEqual(b));return y},l.prototype._findEdgeRing=function(A){var y=A,b=new ol;do b.push(y),y.ring=b,y=y.next;while(!A.isEqual(y));return b},l.prototype.removeNode=function(A){var y=this;A.getOuterEdges().forEach(function(b){return y.removeEdge(b)}),A.innerEdges.forEach(function(b){return y.removeEdge(b)}),delete this.nodes[A.id]},l.prototype.removeEdge=function(A){this.edges=this.edges.filter(function(y){return!y.isEqual(A)}),A.deleteEdge()},l}(),Cc=null;function Zl(l){var A=Graph.fromGeoJson(l);A.deleteDangles(),A.deleteCutEdges();var y=[],b=[];return A.getEdgeRings().filter(function(T){return T.isValid()}).forEach(function(T){T.isHole()?y.push(T):b.push(T)}),y.forEach(function(T){EdgeRing.findEdgeRingContaining(T,b)&&b.push(T)}),featureCollection(b.map(function(T){return T.toPolygon()}))}function A0(l,A){var y=!0;return flattenEach(l,function(b){flattenEach(A,function(T){if(y===!1)return!1;y=Hf(b.geometry,T.geometry)})}),y}function Hf(l,A){switch(l.type){case"Point":switch(A.type){case"Point":return!Gu(l.coordinates,A.coordinates);case"LineString":return!of(A,l);case"Polygon":return!booleanPointInPolygon(l,A)}break;case"LineString":switch(A.type){case"Point":return!of(l,A);case"LineString":return!$f(l,A);case"Polygon":return!wc(A,l)}break;case"Polygon":switch(A.type){case"Point":return!booleanPointInPolygon(A,l);case"LineString":return!wc(l,A);case"Polygon":return!Tu(A,l)}}return!1}function of(l,A){for(var y=0;y<l.coordinates.length-1;y++)if(Tc(l.coordinates[y],l.coordinates[y+1],A.coordinates))return!0;return!1}function $f(l,A){var y=lineIntersect(l,A);return y.features.length>0}function wc(l,A){for(var y=0,b=A.coordinates;y<b.length;y++){var T=b[y];if(booleanPointInPolygon(T,l))return!0}var P=lineIntersect(A,polygonToLine(l));return P.features.length>0}function Tu(l,A){for(var y=0,b=l.coordinates[0];y<b.length;y++){var T=b[y];if(booleanPointInPolygon(T,A))return!0}for(var P=0,R=A.coordinates[0];P<R.length;P++){var U=R[P];if(booleanPointInPolygon(U,l))return!0}var H=lineIntersect(polygonToLine(l),polygonToLine(A));return H.features.length>0}function Tc(l,A,y){var b=y[0]-l[0],T=y[1]-l[1],P=A[0]-l[0],R=A[1]-l[1],U=b*R-T*P;return U!==0?!1:Math.abs(P)>=Math.abs(R)?P>0?l[0]<=y[0]&&y[0]<=A[0]:A[0]<=y[0]&&y[0]<=l[0]:R>0?l[1]<=y[1]&&y[1]<=A[1]:A[1]<=y[1]&&y[1]<=l[1]}function Gu(l,A){return l[0]===A[0]&&l[1]===A[1]}var sl=null;function Mc(l,A){var y=getGeom(l),b=getGeom(A),T=y.type,P=b.type,R=y.coordinates,U=b.coordinates;switch(T){case"Point":switch(P){case"Point":return v0(R,U);default:throw new Error("feature2 "+P+" geometry not supported")}case"MultiPoint":switch(P){case"Point":return Sl(y,b);case"MultiPoint":return p0(y,b);default:throw new Error("feature2 "+P+" geometry not supported")}case"LineString":switch(P){case"Point":return isPointOnLine(b,y,{ignoreEndVertices:!0});case"LineString":return Sh(y,b);case"MultiPoint":return j0(y,b);default:throw new Error("feature2 "+P+" geometry not supported")}case"Polygon":switch(P){case"Point":return booleanPointInPolygon(b,y,{ignoreBoundary:!0});case"LineString":return Ch(y,b);case"Polygon":return V0(y,b);case"MultiPoint":return oc(y,b);default:throw new Error("feature2 "+P+" geometry not supported")}default:throw new Error("feature1 "+T+" geometry not supported")}}function Sl(l,A){var y,b=!1;for(y=0;y<l.coordinates.length;y++)if(v0(l.coordinates[y],A.coordinates)){b=!0;break}return b}function p0(l,A){for(var y=0,b=A.coordinates;y<b.length;y++){for(var T=b[y],P=!1,R=0,U=l.coordinates;R<U.length;R++){var H=U[R];if(v0(T,H)){P=!0;break}}if(!P)return!1}return!0}function j0(l,A){for(var y=!1,b=0,T=A.coordinates;b<T.length;b++){var P=T[b];if(isPointOnLine(P,l,{ignoreEndVertices:!0})&&(y=!0),!isPointOnLine(P,l))return!1}return!!y}function oc(l,A){for(var y=0,b=A.coordinates;y<b.length;y++){var T=b[y];if(!booleanPointInPolygon(T,l,{ignoreBoundary:!0}))return!1}return!0}function Sh(l,A){for(var y=!1,b=0,T=A.coordinates;b<T.length;b++){var P=T[b];if(isPointOnLine({type:"Point",coordinates:P},l,{ignoreEndVertices:!0})&&(y=!0),!isPointOnLine({type:"Point",coordinates:P},l,{ignoreEndVertices:!1}))return!1}return y}function Ch(l,A){var y=!1,b=0,T=calcBbox(l),P=calcBbox(A);if(!d0(T,P))return!1;for(b;b<A.coordinates.length-1;b++){var R=wh(A.coordinates[b],A.coordinates[b+1]);if(booleanPointInPolygon({type:"Point",coordinates:R},l,{ignoreBoundary:!0})){y=!0;break}}return y}function V0(l,A){if(l.type==="Feature"&&l.geometry===null||A.type==="Feature"&&A.geometry===null)return!1;var y=calcBbox(l),b=calcBbox(A);if(!d0(y,b))return!1;for(var T=getGeom(A).coordinates,P=0,R=T;P<R.length;P++)for(var U=R[P],H=0,N=U;H<N.length;H++){var Q=N[H];if(!booleanPointInPolygon(Q,l))return!1}return!0}function d0(l,A){return!(l[0]>A[0]||l[2]<A[2]||l[1]>A[1]||l[3]<A[3])}function v0(l,A){return l[0]===A[0]&&l[1]===A[1]}function wh(l,A){return[(l[0]+A[0])/2,(l[1]+A[1])/2]}function yA(l,A){var y=getGeom(l),b=getGeom(A),T=y.type,P=b.type;switch(T){case"MultiPoint":switch(P){case"LineString":return H0(y,b);case"Polygon":return $0(y,b);default:throw new Error("feature2 "+P+" geometry not supported")}case"LineString":switch(P){case"MultiPoint":return H0(b,y);case"LineString":return Th(y,b);case"Polygon":return sc(y,b);default:throw new Error("feature2 "+P+" geometry not supported")}case"Polygon":switch(P){case"MultiPoint":return $0(b,y);case"LineString":return sc(b,y);default:throw new Error("feature2 "+P+" geometry not supported")}default:throw new Error("feature1 "+T+" geometry not supported")}}function H0(l,A){for(var y=!1,b=!1,T=l.coordinates.length,P=0;P<T&&!y&&!b;){for(var R=0;R<A.coordinates.length-1;R++){var U=!0;(R===0||R===A.coordinates.length-2)&&(U=!1),Cf(A.coordinates[R],A.coordinates[R+1],l.coordinates[P],U)?y=!0:b=!0}P++}return y&&b}function Th(l,A){var y=lineIntersect(l,A);if(y.features.length>0)for(var b=0;b<l.coordinates.length-1;b++)for(var T=0;T<A.coordinates.length-1;T++){var P=!0;if((T===0||T===A.coordinates.length-2)&&(P=!1),Cf(l.coordinates[b],l.coordinates[b+1],A.coordinates[T],P))return!0}return!1}function sc(l,A){var y=polygonToLine(A),b=lineIntersect(l,y);return b.features.length>0}function $0(l,A){for(var y=!1,b=!1,T=l.coordinates.length,P=0;P<T&&(!y||!b);P++)booleanPointInPolygon(point(l.coordinates[P]),A)?y=!0:b=!0;return b&&y}function Cf(l,A,y,b){var T=y[0]-l[0],P=y[1]-l[1],R=A[0]-l[0],U=A[1]-l[1],H=T*U-P*R;return H!==0?!1:b?Math.abs(R)>=Math.abs(U)?R>0?l[0]<=y[0]&&y[0]<=A[0]:A[0]<=y[0]&&y[0]<=l[0]:U>0?l[1]<=y[1]&&y[1]<=A[1]:A[1]<=y[1]&&y[1]<=l[1]:Math.abs(R)>=Math.abs(U)?R>0?l[0]<y[0]&&y[0]<A[0]:A[0]<y[0]&&y[0]<l[0]:U>0?l[1]<y[1]&&y[1]<A[1]:A[1]<y[1]&&y[1]<l[1]}var _A=null,xA=C(29657);function Y0(l,A){var y=getGeom(l),b=getGeom(A),T=y.type,P=b.type;if(T==="MultiPoint"&&P!=="MultiPoint"||(T==="LineString"||T==="MultiLineString")&&P!=="LineString"&&P!=="MultiLineString"||(T==="Polygon"||T==="MultiPolygon")&&P!=="Polygon"&&P!=="MultiPolygon")throw new Error("features must be of the same type");if(T==="Point")throw new Error("Point geometry not supported");var R=new GeojsonEquality({precision:6});if(R.compare(l,A))return!1;var U=0;switch(T){case"MultiPoint":for(var H=0;H<y.coordinates.length;H++)for(var N=0;N<b.coordinates.length;N++){var Q=y.coordinates[H],K=b.coordinates[N];if(Q[0]===K[0]&&Q[1]===K[1])return!0}return!1;case"LineString":case"MultiLineString":segmentEach(l,function(ae){segmentEach(A,function(ge){lineOverlap(ae,ge).features.length&&U++})});break;case"Polygon":case"MultiPolygon":segmentEach(l,function(ae){segmentEach(A,function(ge){lineIntersect(ae,ge).features.length&&U++})});break}return U>0}function Ic(l,A){var y=getGeom(l).type,b=getGeom(A).type;if(y!==b)return!1;var T=new GeojsonEquality({precision:6});return T.compare(cleanCoords(l),cleanCoords(A))}var Pc=null;function wf(l,A){var y=!1;return flattenEach(l,function(b){flattenEach(A,function(T){if(y===!0)return!0;y=!booleanDisjoint(b.geometry,T.geometry)})}),y}var Eo=C(52606);function Xs(l,A,y){y===void 0&&(y={}),y.mutate!==!0&&(l=clone(l)),y.minPoints=y.minPoints||3;var b=new clustering.DBSCAN,T=b.run(coordAll(l),convertLength(A,y.units),y.minPoints,distance),P=-1;return T.forEach(function(R){P++,R.forEach(function(U){var H=l.features[U];H.properties||(H.properties={}),H.properties.cluster=P,H.properties.dbscan="core"})}),b.noise.forEach(function(R){var U=l.features[R];U.properties||(U.properties={}),U.properties.cluster?U.properties.dbscan="edge":U.properties.dbscan="noise"}),l}var zl=null,uc=C(21160);function ul(l,A){A===void 0&&(A={});var y=l.features.length;A.numberOfClusters=A.numberOfClusters||Math.round(Math.sqrt(y/2)),A.numberOfClusters>y&&(A.numberOfClusters=y),A.mutate!==!0&&(l=clone(l));var b=coordAll(l),T=b.slice(0,A.numberOfClusters),P=skmeans(b,A.numberOfClusters,T),R={};return P.centroids.forEach(function(U,H){R[H]=U}),featureEach(l,function(U,H){var N=P.idxs[H];U.properties.cluster=N,U.properties.centroid=R[N]}),l}var Ul=null;function Lc(l,A){if(!l)throw new Error("line1 is required");if(!A)throw new Error("line2 is required");var y=Gl(l,"line1");if(y!=="LineString")throw new Error("line1 must be a LineString");var b=Gl(A,"line2");if(b!=="LineString")throw new Error("line2 must be a LineString");for(var T=lineSegment(cleanCoords(l)).features,P=lineSegment(cleanCoords(A)).features,R=0;R<T.length;R++){var U=T[R].geometry.coordinates;if(!P[R])break;var H=P[R].geometry.coordinates;if(!sf(U,H))return!1}return!0}function sf(l,A){var y=bearingToAzimuth(rhumbBearing(l[0],l[1])),b=bearingToAzimuth(rhumbBearing(A[0],A[1]));return y===b}function Gl(l,A){if(l.geometry&&l.geometry.type)return l.geometry.type;if(l.type)return l.type;throw new Error("Invalid GeoJSON object for "+A)}var Cl=null;function pa(l){for(var A=l,y=[];A.parent;)y.unshift(A),A=A.parent;return y}function Oc(){return new Hl(function(l){return l.f})}var jl={search:function(l,A,y,b){l.cleanDirty(),b=b||{};var T=b.heuristic||jl.heuristics.manhattan,P=b.closest||!1,R=Oc(),U=A;for(A.h=T(A,y),R.push(A);R.size()>0;){var H=R.pop();if(H===y)return pa(H);H.closed=!0;for(var N=l.neighbors(H),Q=0,K=N.length;Q<K;++Q){var ae=N[Q];if(!(ae.closed||ae.isWall())){var ge=H.g+ae.getCost(H),pt=ae.visited;(!pt||ge<ae.g)&&(ae.visited=!0,ae.parent=H,ae.h=ae.h||T(ae,y),ae.g=ge,ae.f=ae.g+ae.h,l.markDirty(ae),P&&(ae.h<U.h||ae.h===U.h&&ae.g<U.g)&&(U=ae),pt?R.rescoreElement(ae):R.push(ae))}}}return P?pa(U):[]},heuristics:{manhattan:function(l,A){var y=Math.abs(A.x-l.x),b=Math.abs(A.y-l.y);return y+b},diagonal:function(l,A){var y=1,b=Math.sqrt(2),T=Math.abs(A.x-l.x),P=Math.abs(A.y-l.y);return y*(T+P)+(b-2*y)*Math.min(T,P)}},cleanNode:function(l){l.f=0,l.g=0,l.h=0,l.visited=!1,l.closed=!1,l.parent=null}};function lc(l,A){A=A||{},this.nodes=[],this.diagonal=!!A.diagonal,this.grid=[];for(var y=0;y<l.length;y++){this.grid[y]=[];for(var b=0,T=l[y];b<T.length;b++){var P=new Vl(y,b,T[b]);this.grid[y][b]=P,this.nodes.push(P)}}this.init()}lc.prototype.init=function(){this.dirtyNodes=[];for(var l=0;l<this.nodes.length;l++)jl.cleanNode(this.nodes[l])},lc.prototype.cleanDirty=function(){for(var l=0;l<this.dirtyNodes.length;l++)jl.cleanNode(this.dirtyNodes[l]);this.dirtyNodes=[]},lc.prototype.markDirty=function(l){this.dirtyNodes.push(l)},lc.prototype.neighbors=function(l){var A=[],y=l.x,b=l.y,T=this.grid;return T[y-1]&&T[y-1][b]&&A.push(T[y-1][b]),T[y+1]&&T[y+1][b]&&A.push(T[y+1][b]),T[y]&&T[y][b-1]&&A.push(T[y][b-1]),T[y]&&T[y][b+1]&&A.push(T[y][b+1]),this.diagonal&&(T[y-1]&&T[y-1][b-1]&&A.push(T[y-1][b-1]),T[y+1]&&T[y+1][b-1]&&A.push(T[y+1][b-1]),T[y-1]&&T[y-1][b+1]&&A.push(T[y-1][b+1]),T[y+1]&&T[y+1][b+1]&&A.push(T[y+1][b+1])),A},lc.prototype.toString=function(){for(var l=[],A=this.grid,y,b,T,P,R=0,U=A.length;R<U;R++){for(y=[],b=A[R],T=0,P=b.length;T<P;T++)y.push(b[T].weight);l.push(y.join(" "))}return l.join(`
`)};function Vl(l,A,y){this.x=l,this.y=A,this.weight=y}Vl.prototype.toString=function(){return"["+this.x+" "+this.y+"]"},Vl.prototype.getCost=function(l){return l&&l.x!==this.x&&l.y!==this.y?this.weight*1.41421:this.weight},Vl.prototype.isWall=function(){return this.weight===0};function Hl(l){this.content=[],this.scoreFunction=l}Hl.prototype={push:function(l){this.content.push(l),this.sinkDown(this.content.length-1)},pop:function(){var l=this.content[0],A=this.content.pop();return this.content.length>0&&(this.content[0]=A,this.bubbleUp(0)),l},remove:function(l){var A=this.content.indexOf(l),y=this.content.pop();A!==this.content.length-1&&(this.content[A]=y,this.scoreFunction(y)<this.scoreFunction(l)?this.sinkDown(A):this.bubbleUp(A))},size:function(){return this.content.length},rescoreElement:function(l){this.sinkDown(this.content.indexOf(l))},sinkDown:function(l){for(var A=this.content[l];l>0;){var y=(l+1>>1)-1,b=this.content[y];if(this.scoreFunction(A)<this.scoreFunction(b))this.content[y]=A,this.content[l]=b,l=y;else break}},bubbleUp:function(l){for(var A=this.content.length,y=this.content[l],b=this.scoreFunction(y);;){var T=l+1<<1,P=T-1,R=null,U;if(P<A){var H=this.content[P];U=this.scoreFunction(H),U<b&&(R=P)}if(T<A){var N=this.content[T],Q=this.scoreFunction(N);Q<(R===null?b:U)&&(R=T)}if(R!==null)this.content[l]=this.content[R],this.content[R]=y,l=R;else break}}};function g0(l,A,y){if(y=y||{},!isObject(y))throw new Error("options is invalid");var b=y.resolution,T=y.minDistance,P=y.obstacles||featureCollection([]);if(!l)throw new Error("start is required");if(!A)throw new Error("end is required");if(b&&!isNumber(b)||b<=0)throw new Error("options.resolution must be a number, greater than 0");if(T)throw new Error("options.minDistance is not yet implemented");var R=getCoord(l),U=getCoord(A);switch(l=point(R),A=point(U),getType(P)){case"FeatureCollection":if(P.features.length===0)return lineString([R,U]);break;case"Polygon":P=featureCollection([feature(getGeom(P))]);break;default:throw new Error("invalid obstacles")}var H=P;H.features.push(l),H.features.push(A);var N=bbox(scale(bboxPolygon(bbox(H)),1.15));if(!b){var Q=distance([N[0],N[1]],[N[2],N[1]],y);b=Q/100}H.features.pop(),H.features.pop();for(var K=N[0],ae=N[1],ge=N[2],pt=N[3],at=b/distance([K,ae],[ge,ae],y),Nt=at*(ge-K),dt=b/distance([K,ae],[K,pt],y),Ke=dt*(pt-ae),ht=ge-K,Ht=pt-ae,Bt=Math.floor(ht/Nt),ir=Math.floor(Ht/Ke),Kt=(ht-Bt*Nt)/2,fr=(Ht-ir*Ke)/2,Ct=[],si=[],bn=[],Ei=[],$i=1/0,on=1/0,ai=pt-fr,kn=0;ai>=ae;){for(var La=[],Sa=[],Ji=K+Kt,mu=0;Ji<=ge;){var ys=point([Ji,ai]),su=m0(ys,P);La.push(su?0:1),Sa.push(Ji+"|"+ai);var Qa=distance(ys,l);!su&&Qa<$i&&($i=Qa,bn={x:mu,y:kn});var po=distance(ys,A);!su&&po<on&&(on=po,Ei={x:mu,y:kn}),Ji+=Nt,mu++}si.push(La),Ct.push(Sa),ai-=Ke,kn++}var Vo=new lc(si,{diagonal:!0}),jc=Vo.grid[bn.y][bn.x],Ql=Vo.grid[Ei.y][Ei.x],Kh=jl.search(Vo,jc,Ql),R0=[R];return Kh.forEach(function(Jh){var hh=Ct[Jh.x][Jh.y].split("|");R0.push([+hh[0],+hh[1]])}),R0.push(U),cleanCoords(lineString(R0))}function m0(l,A){for(var y=0;y<A.features.length;y++)if(booleanPointInPolygon(l,A.features[y]))return!0;return!1}var Qs=null;function Rc(){this._=null}function wl(l){l.U=l.C=l.L=l.R=l.P=l.N=null}Rc.prototype={constructor:Rc,insert:function(l,A){var y,b,T;if(l){if(A.P=l,A.N=l.N,l.N&&(l.N.P=A),l.N=A,l.R){for(l=l.R;l.L;)l=l.L;l.L=A}else l.R=A;y=l}else this._?(l=Yf(this._),A.P=null,A.N=l,l.P=l.L=A,y=l):(A.P=A.N=null,this._=A,y=null);for(A.L=A.R=null,A.U=y,A.C=!0,l=A;y&&y.C;)b=y.U,y===b.L?(T=b.R,T&&T.C?(y.C=T.C=!1,b.C=!0,l=b):(l===y.R&&(ju(this,y),l=y,y=l.U),y.C=!1,b.C=!0,Mu(this,b))):(T=b.L,T&&T.C?(y.C=T.C=!1,b.C=!0,l=b):(l===y.L&&(Mu(this,y),l=y,y=l.U),y.C=!1,b.C=!0,ju(this,b))),y=l.U;this._.C=!1},remove:function(l){l.N&&(l.N.P=l.P),l.P&&(l.P.N=l.N),l.N=l.P=null;var A=l.U,y,b=l.L,T=l.R,P,R;if(b?T?P=Yf(T):P=b:P=T,A?A.L===l?A.L=P:A.R=P:this._=P,b&&T?(R=P.C,P.C=l.C,P.L=b,b.U=P,P!==T?(A=P.U,P.U=l.U,l=P.R,A.L=l,P.R=T,T.U=P):(P.U=A,A=P,l=P.R)):(R=l.C,l=P),l&&(l.U=A),!R){if(l&&l.C){l.C=!1;return}do{if(l===this._)break;if(l===A.L){if(y=A.R,y.C&&(y.C=!1,A.C=!0,ju(this,A),y=A.R),y.L&&y.L.C||y.R&&y.R.C){(!y.R||!y.R.C)&&(y.L.C=!1,y.C=!0,Mu(this,y),y=A.R),y.C=A.C,A.C=y.R.C=!1,ju(this,A),l=this._;break}}else if(y=A.L,y.C&&(y.C=!1,A.C=!0,Mu(this,A),y=A.L),y.L&&y.L.C||y.R&&y.R.C){(!y.L||!y.L.C)&&(y.R.C=!1,y.C=!0,ju(this,y),y=A.L),y.C=A.C,A.C=y.L.C=!1,Mu(this,A),l=this._;break}y.C=!0,l=A,A=A.U}while(!l.C);l&&(l.C=!1)}}};function ju(l,A){var y=A,b=A.R,T=y.U;T?T.L===y?T.L=b:T.R=b:l._=b,b.U=T,y.U=b,y.R=b.L,y.R&&(y.R.U=y),b.L=y}function Mu(l,A){var y=A,b=A.L,T=y.U;T?T.L===y?T.L=b:T.R=b:l._=b,b.U=T,y.U=b,y.L=b.R,y.L&&(y.L.U=y),b.R=y}function Yf(l){for(;l.L;)l=l.L;return l}var ou=Rc;function uf(l,A,y,b){var T=[null,null],P=Rs.push(T)-1;return T.left=l,T.right=A,y&&Yl(T,l,A,y),b&&Yl(T,A,l,b),qs[l.index].halfedges.push(P),qs[A.index].halfedges.push(P),T}function $l(l,A,y){var b=[A,y];return b.left=l,b}function Yl(l,A,y,b){!l[0]&&!l[1]?(l[0]=b,l.left=A,l.right=y):l.left===y?l[1]=b:l[0]=b}function Os(l,A,y,b,T){var P=l[0],R=l[1],U=P[0],H=P[1],N=R[0],Q=R[1],K=0,ae=1,ge=N-U,pt=Q-H,at;if(at=A-U,!(!ge&&at>0)){if(at/=ge,ge<0){if(at<K)return;at<ae&&(ae=at)}else if(ge>0){if(at>ae)return;at>K&&(K=at)}if(at=b-U,!(!ge&&at<0)){if(at/=ge,ge<0){if(at>ae)return;at>K&&(K=at)}else if(ge>0){if(at<K)return;at<ae&&(ae=at)}if(at=y-H,!(!pt&&at>0)){if(at/=pt,pt<0){if(at<K)return;at<ae&&(ae=at)}else if(pt>0){if(at>ae)return;at>K&&(K=at)}if(at=T-H,!(!pt&&at<0)){if(at/=pt,pt<0){if(at>ae)return;at>K&&(K=at)}else if(pt>0){if(at<K)return;at<ae&&(ae=at)}return!(K>0)&&!(ae<1)||(K>0&&(l[0]=[U+K*ge,H+K*pt]),ae<1&&(l[1]=[U+ae*ge,H+ae*pt])),!0}}}}}function Dc(l,A,y,b,T){var P=l[1];if(P)return!0;var R=l[0],U=l.left,H=l.right,N=U[0],Q=U[1],K=H[0],ae=H[1],ge=(N+K)/2,pt=(Q+ae)/2,at,Nt;if(ae===Q){if(ge<A||ge>=b)return;if(N>K){if(!R)R=[ge,y];else if(R[1]>=T)return;P=[ge,T]}else{if(!R)R=[ge,T];else if(R[1]<y)return;P=[ge,y]}}else if(at=(N-K)/(ae-Q),Nt=pt-at*ge,at<-1||at>1)if(N>K){if(!R)R=[(y-Nt)/at,y];else if(R[1]>=T)return;P=[(T-Nt)/at,T]}else{if(!R)R=[(T-Nt)/at,T];else if(R[1]<y)return;P=[(y-Nt)/at,y]}else if(Q<ae){if(!R)R=[A,at*A+Nt];else if(R[0]>=b)return;P=[b,at*b+Nt]}else{if(!R)R=[b,at*b+Nt];else if(R[0]<A)return;P=[A,at*A+Nt]}return l[0]=R,l[1]=P,!0}function kc(l,A,y,b){for(var T=Rs.length,P;T--;)(!Dc(P=Rs[T],l,A,y,b)||!Os(P,l,A,y,b)||!(Math.abs(P[0][0]-P[1][0])>Ya||Math.abs(P[0][1]-P[1][1])>Ya))&&delete Rs[T]}function Tl(l){return qs[l.index]={site:l,halfedges:[]}}function y0(l,A){var y=l.site,b=A.left,T=A.right;return y===T&&(T=b,b=y),T?Math.atan2(T[1]-b[1],T[0]-b[0]):(y===b?(b=A[1],T=A[0]):(b=A[0],T=A[1]),Math.atan2(b[0]-T[0],T[1]-b[1]))}function lf(l,A){return A[+(A.left!==l.site)]}function cf(l,A){return A[+(A.left===l.site)]}function Tf(){for(var l=0,A=qs.length,y,b,T,P;l<A;++l)if((y=qs[l])&&(P=(b=y.halfedges).length)){var R=new Array(P),U=new Array(P);for(T=0;T<P;++T)R[T]=T,U[T]=y0(y,Rs[b[T]]);for(R.sort(function(H,N){return U[N]-U[H]}),T=0;T<P;++T)U[T]=b[R[T]];for(T=0;T<P;++T)b[T]=U[T]}}function ms(l,A,y,b){var T=qs.length,P,R,U,H,N,Q,K,ae,ge,pt,at,Nt,dt=!0;for(P=0;P<T;++P)if(R=qs[P]){for(U=R.site,N=R.halfedges,H=N.length;H--;)Rs[N[H]]||N.splice(H,1);for(H=0,Q=N.length;H<Q;)pt=cf(R,Rs[N[H]]),at=pt[0],Nt=pt[1],K=lf(R,Rs[N[++H%Q]]),ae=K[0],ge=K[1],(Math.abs(at-ae)>Ya||Math.abs(Nt-ge)>Ya)&&(N.splice(H,0,Rs.push($l(U,pt,Math.abs(at-l)<Ya&&b-Nt>Ya?[l,Math.abs(ae-l)<Ya?ge:b]:Math.abs(Nt-b)<Ya&&y-at>Ya?[Math.abs(ge-b)<Ya?ae:y,b]:Math.abs(at-y)<Ya&&Nt-A>Ya?[y,Math.abs(ae-y)<Ya?ge:A]:Math.abs(Nt-A)<Ya&&at-l>Ya?[Math.abs(ge-A)<Ya?ae:l,A]:null))-1),++Q);Q&&(dt=!1)}if(dt){var Ke,ht,Ht,Bt=1/0;for(P=0,dt=null;P<T;++P)(R=qs[P])&&(U=R.site,Ke=U[0]-l,ht=U[1]-A,Ht=Ke*Ke+ht*ht,Ht<Bt&&(Bt=Ht,dt=R));if(dt){var ir=[l,A],Kt=[l,b],fr=[y,b],Ct=[y,A];dt.halfedges.push(Rs.push($l(U=dt.site,ir,Kt))-1,Rs.push($l(U,Kt,fr))-1,Rs.push($l(U,fr,Ct))-1,Rs.push($l(U,Ct,ir))-1)}}for(P=0;P<T;++P)(R=qs[P])&&(R.halfedges.length||delete qs[P])}var ll=[],ia;function Ko(){wl(this),this.x=this.y=this.arc=this.site=this.cy=null}function cc(l){var A=l.P,y=l.N;if(!(!A||!y)){var b=A.site,T=l.site,P=y.site;if(b!==P){var R=T[0],U=T[1],H=b[0]-R,N=b[1]-U,Q=P[0]-R,K=P[1]-U,ae=2*(H*K-N*Q);if(!(ae>=-Fc)){var ge=H*H+N*N,pt=Q*Q+K*K,at=(K*ge-N*pt)/ae,Nt=(H*pt-Q*ge)/ae,dt=ll.pop()||new Ko;dt.arc=l,dt.site=T,dt.x=at+R,dt.y=(dt.cy=Nt+U)+Math.sqrt(at*at+Nt*Nt),l.circle=dt;for(var Ke=null,ht=vu._;ht;)if(dt.y<ht.y||dt.y===ht.y&&dt.x<=ht.x)if(ht.L)ht=ht.L;else{Ke=ht.P;break}else if(ht.R)ht=ht.R;else{Ke=ht;break}vu.insert(Ke,dt),Ke||(ia=dt)}}}}function cl(l){var A=l.circle;A&&(A.P||(ia=A.N),vu.remove(A),ll.push(A),wl(A),l.circle=null)}var Mf=[];function W0(){wl(this),this.edge=this.site=this.circle=null}function Nc(l){var A=Mf.pop()||new W0;return A.site=l,A}function If(l){cl(l),Wl.remove(l),Mf.push(l),wl(l)}function Wf(l){var A=l.circle,y=A.x,b=A.cy,T=[y,b],P=l.P,R=l.N,U=[l];If(l);for(var H=P;H.circle&&Math.abs(y-H.circle.x)<Ya&&Math.abs(b-H.circle.cy)<Ya;)P=H.P,U.unshift(H),If(H),H=P;U.unshift(H),cl(H);for(var N=R;N.circle&&Math.abs(y-N.circle.x)<Ya&&Math.abs(b-N.circle.cy)<Ya;)R=N.N,U.push(N),If(N),N=R;U.push(N),cl(N);var Q=U.length,K;for(K=1;K<Q;++K)N=U[K],H=U[K-1],Yl(N.edge,H.site,N.site,T);H=U[0],N=U[Q-1],N.edge=uf(H.site,N.site,null,T),cc(H),cc(N)}function X0(l){for(var A=l[0],y=l[1],b,T,P,R,U=Wl._;U;)if(P=ff(U,y)-A,P>Ya)U=U.L;else if(R=A-Pf(U,y),R>Ya){if(!U.R){b=U;break}U=U.R}else{P>-Ya?(b=U.P,T=U):R>-Ya?(b=U,T=U.N):b=T=U;break}Tl(l);var H=Nc(l);if(Wl.insert(b,H),!(!b&&!T)){if(b===T){cl(b),T=Nc(b.site),Wl.insert(H,T),H.edge=T.edge=uf(b.site,H.site),cc(b),cc(T);return}if(!T){H.edge=uf(b.site,H.site);return}cl(b),cl(T);var N=b.site,Q=N[0],K=N[1],ae=l[0]-Q,ge=l[1]-K,pt=T.site,at=pt[0]-Q,Nt=pt[1]-K,dt=2*(ae*Nt-ge*at),Ke=ae*ae+ge*ge,ht=at*at+Nt*Nt,Ht=[(Nt*Ke-ge*ht)/dt+Q,(ae*ht-at*Ke)/dt+K];Yl(T.edge,N,pt,Ht),H.edge=uf(N,l,null,Ht),T.edge=uf(l,pt,null,Ht),cc(b),cc(T)}}function ff(l,A){var y=l.site,b=y[0],T=y[1],P=T-A;if(!P)return b;var R=l.P;if(!R)return-1/0;y=R.site;var U=y[0],H=y[1],N=H-A;if(!N)return U;var Q=U-b,K=1/P-1/N,ae=Q/N;return K?(-ae+Math.sqrt(ae*ae-2*K*(Q*Q/(-2*N)-H+N/2+T-P/2)))/K+b:(b+U)/2}function Pf(l,A){var y=l.N;if(y)return ff(y,A);var b=l.site;return b[1]===A?b[0]:1/0}var Ya=1e-6,Fc=1e-12,Wl,qs,vu,Rs;function Xf(l,A,y){return(l[0]-y[0])*(A[1]-l[1])-(l[0]-A[0])*(y[1]-l[1])}function _0(l,A){return A[1]-l[1]||A[0]-l[0]}function Ce(l,A){var y=l.sort(_0).pop(),b,T,P;for(Rs=[],qs=new Array(l.length),Wl=new ou,vu=new ou;;)if(P=ia,y&&(!P||y[1]<P.y||y[1]===P.y&&y[0]<P.x))(y[0]!==b||y[1]!==T)&&(X0(y),b=y[0],T=y[1]),y=l.pop();else if(P)Wf(P.arc);else break;if(Tf(),A){var R=+A[0][0],U=+A[0][1],H=+A[1][0],N=+A[1][1];kc(R,U,H,N),ms(R,U,H,N)}this.edges=Rs,this.cells=qs,Wl=vu=Rs=qs=null}Ce.prototype={constructor:Ce,polygons:function(){var l=this.edges;return this.cells.map(function(A){var y=A.halfedges.map(function(b){return lf(A,l[b])});return y.data=A.site.data,y})},triangles:function(){var l=[],A=this.edges;return this.cells.forEach(function(y,b){if(U=(P=y.halfedges).length)for(var T=y.site,P,R=-1,U,H,N=A[P[U-1]],Q=N.left===T?N.right:N.left;++R<U;)H=Q,N=A[P[R]],Q=N.left===T?N.right:N.left,H&&Q&&b<H.index&&b<Q.index&&Xf(T,H,Q)<0&&l.push([T.data,H.data,Q.data])}),l},links:function(){return this.edges.filter(function(l){return l.right}).map(function(l){return{source:l.left.data,target:l.right.data}})},find:function(l,A,y){for(var b=this,T,P=b._found||0,R=b.cells.length,U;!(U=b.cells[P]);)if(++P>=R)return null;var H=l-U.site[0],N=A-U.site[1],Q=H*H+N*N;do U=b.cells[T=P],P=null,U.halfedges.forEach(function(K){var ae=b.edges[K],ge=ae.left;if(!((ge===U.site||!ge)&&!(ge=ae.right))){var pt=l-ge[0],at=A-ge[1],Nt=pt*pt+at*at;Nt<Q&&(Q=Nt,P=ge.index)}});while(P!==null);return b._found=T,y==null||Q<=y*y?U.site:null}};function Qe(){var l=pointX,A=pointY,y=null;function b(T){return new Diagram(T.map(function(P,R){var U=[Math.round(l(P,R,T)/epsilon)*epsilon,Math.round(A(P,R,T)/epsilon)*epsilon];return U.index=R,U.data=P,U}),y)}return b.polygons=function(T){return b(T).polygons()},b.links=function(T){return b(T).links()},b.triangles=function(T){return b(T).triangles()},b.x=function(T){return arguments.length?(l=typeof T=="function"?T:constant(+T),b):l},b.y=function(T){return arguments.length?(A=typeof T=="function"?T:constant(+T),b):A},b.extent=function(T){return arguments.length?(y=T==null?null:[[+T[0][0],+T[0][1]],[+T[1][0],+T[1][1]]],b):y&&[[y[0][0],y[0][1]],[y[1][0],y[1][1]]]},b.size=function(T){return arguments.length?(y=T==null?null:[[0,0],[+T[0],+T[1]]],b):y&&[y[1][0]-y[0][0],y[1][1]-y[0][1]]},b}function mt(l){return l=l.slice(),l.push(l[0]),polygon([l])}function nr(l,A){if(A=A||{},!isObject(A))throw new Error("options is invalid");var y=A.bbox||[-180,-85,180,85];if(!l)throw new Error("points is required");if(!Array.isArray(y))throw new Error("bbox is invalid");return collectionOf(l,"Point","points"),featureCollection(voronoi$1().x(function(b){return b.geometry.coordinates[0]}).y(function(b){return b.geometry.coordinates[1]}).extent([[y[0],y[1]],[y[2],y[3]]]).polygons(l.features).map(mt))}var Ar=null;function er(l,A,y,b){b=b||{};var T=b.steps||64,P=b.units||"kilometers",R=b.angle||0,U=b.pivot||l,H=b.properties||l.properties||{};if(!l)throw new Error("center is required");if(!A)throw new Error("xSemiAxis is required");if(!y)throw new Error("ySemiAxis is required");if(!isObject(b))throw new Error("options must be an object");if(!isNumber(T))throw new Error("steps must be a number");if(!isNumber(R))throw new Error("angle must be a number");var N=getCoord(l);if(P==="degrees")var Q=degreesToRadians(R);else A=rhumbDestination(l,A,90,{units:P}),y=rhumbDestination(l,y,0,{units:P}),A=getCoord(A)[0]-N[0],y=getCoord(y)[1]-N[1];for(var K=[],ae=0;ae<T;ae+=1){var ge=ae*-360/T,pt=A*y/Math.sqrt(Math.pow(y,2)+Math.pow(A,2)*Math.pow(sr(ge),2)),at=A*y/Math.sqrt(Math.pow(A,2)+Math.pow(y,2)/Math.pow(sr(ge),2));if(ge<-90&&ge>=-270&&(pt=-pt),ge<-180&&ge>=-360&&(at=-at),P==="degrees"){var Nt=pt*Math.cos(Q)+at*Math.sin(Q),dt=at*Math.cos(Q)-pt*Math.sin(Q);pt=Nt,at=dt}K.push([pt+N[0],at+N[1]])}return K.push(K[0]),P==="degrees"?polygon([K],H):transformRotate(polygon([K],H),R,{pivot:U})}function sr(l){var A=l*Math.PI/180;return Math.tan(A)}var Tr=null;function Lr(l,A){A===void 0&&(A={});var y=0,b=0,T=0;return geomEach(l,function(P,R,U){var H=A.weight?U==null?void 0:U[A.weight]:void 0;if(H=H==null?1:H,!isNumber(H))throw new Error("weight value must be a number for feature index "+R);H=Number(H),H>0&&coordEach(P,function(N){y+=N[0]*H,b+=N[1]*H,T+=H})}),point([y/T,b/T],A.properties,A)}var Nr=null;function kr(l,A){if(A===void 0&&(A={}),A=A||{},!isObject(A))throw new Error("options is invalid");var y=A.counter||10;if(!isNumber(y))throw new Error("counter must be a number");var b=A.weight,T=centerMean(l,{weight:A.weight}),P=featureCollection([]);featureEach(l,function(U){var H;P.features.push(centroid(U,{properties:{weight:(H=U.properties)===null||H===void 0?void 0:H[b]}}))});var R={tolerance:A.tolerance,medianCandidates:[]};return Or(T.geometry.coordinates,[0,0],P,R,y)}function Or(l,A,y,b,T){var P=b.tolerance||.001,R=0,U=0,H=0,N=0;if(featureEach(y,function(ae){var ge,pt=(ge=ae.properties)===null||ge===void 0?void 0:ge.weight,at=pt==null?1:pt;if(at=Number(at),!isNumber(at))throw new Error("weight value must be a number");if(at>0){N+=1;var Nt=at*distance(ae,l);Nt===0&&(Nt=1);var dt=at/Nt;R+=ae.geometry.coordinates[0]*dt,U+=ae.geometry.coordinates[1]*dt,H+=dt}}),N<1)throw new Error("no features to measure");var Q=R/H,K=U/H;return N===1||T===0||Math.abs(Q-A[0])<P&&Math.abs(K-A[1])<P?point([Q,K],{medianCandidates:b.medianCandidates}):(b.medianCandidates.push([Q,K]),Or([Q,K],l,y,b,T-1))}var qr=null;function Mr(l,A){if(A=A||{},!isObject(A))throw new Error("options is invalid");var y=A.steps||64,b=A.weight,T=A.properties||{};if(!isNumber(y))throw new Error("steps must be a number");if(!isObject(T))throw new Error("properties must be a number");var P=coordAll(l).length,R=centerMean(l,{weight:b}),U=0,H=0,N=0;featureEach(l,function(Kt){var fr=Kt.properties[b]||1,Ct=zr(getCoords(Kt),getCoords(R));U+=Math.pow(Ct.x,2)*fr,H+=Math.pow(Ct.y,2)*fr,N+=Ct.x*Ct.y*fr});var Q=U-H,K=Math.sqrt(Math.pow(Q,2)+4*Math.pow(N,2)),ae=2*N,ge=Math.atan((Q+K)/ae),pt=ge*180/Math.PI,at=0,Nt=0,dt=0;featureEach(l,function(Kt){var fr=Kt.properties[b]||1,Ct=zr(getCoords(Kt),getCoords(R));at+=Math.pow(Ct.x*Math.cos(ge)-Ct.y*Math.sin(ge),2)*fr,Nt+=Math.pow(Ct.x*Math.sin(ge)+Ct.y*Math.cos(ge),2)*fr,dt+=fr});var Ke=Math.sqrt(2*at/dt),ht=Math.sqrt(2*Nt/dt),Ht=ellipse(R,Ke,ht,{units:"degrees",angle:pt,steps:y,properties:T}),Bt=pointsWithinPolygon(l,featureCollection([Ht])),ir={meanCenterCoordinates:getCoords(R),semiMajorAxis:Ke,semiMinorAxis:ht,numberOfFeatures:P,angle:pt,percentageWithinEllipse:100*coordAll(Bt).length/P};return Ht.properties.standardDeviationalEllipse=ir,Ht}function zr(l,A){return{x:l[0]-A[0],y:l[1]-A[1]}}var Vt=null;function lr(l,A,y,b){if(b===void 0&&(b={}),!isObject(b))throw new Error("options is invalid");if(!l)throw new Error("startPoint is required");if(!A)throw new Error("midPoint is required");if(!y)throw new Error("endPoint is required");var T=l,P=A,R=y,U=bearingToAzimuth(b.mercator!==!0?bearing(T,P):rhumbBearing(T,P)),H=bearingToAzimuth(b.mercator!==!0?bearing(R,P):rhumbBearing(R,P)),N=Math.abs(U-H);return b.explementary===!0?360-N:N}var Rr=null;function tn(l,A){var y=[],b=A.iterations||1;if(!l)throw new Error("inputPolys is required");return geomEach(l,function(T,P,R){var U,H,N;switch(T.type){case"Polygon":U=[[]];for(var Q=0;Q<b;Q++)N=[[]],H=T,Q>0&&(H=polygon(U).geometry),_r(H,N),U=N.slice(0);y.push(polygon(U,R));break;case"MultiPolygon":U=[[[]]];for(var K=0;K<b;K++)N=[[[]]],H=T,K>0&&(H=multiPolygon(U).geometry),cn(H,N),U=N.slice(0);y.push(multiPolygon(U,R));break;default:throw new Error("geometry is invalid, must be Polygon or MultiPolygon")}}),featureCollection(y)}function _r(l,A){var y=0,b=0;coordEach(l,function(T,P,R,U,H){H>y&&(y=H,b=P,A.push([]));var N=P-b,Q=l.coordinates[H][N+1],K=T[0],ae=T[1],ge=Q[0],pt=Q[1];A[H].push([.75*K+.25*ge,.75*ae+.25*pt]),A[H].push([.25*K+.75*ge,.25*ae+.75*pt])},!0),A.forEach(function(T){T.push(T[0])})}function cn(l,A){var y=0,b=0,T=0;coordEach(l,function(P,R,U,H,N){H>T&&(T=H,b=R,A.push([[]])),N>y&&(y=N,b=R,A[H].push([]));var Q=R-b,K=l.coordinates[H][N][Q+1],ae=P[0],ge=P[1],pt=K[0],at=K[1];A[H][N].push([.75*ae+.25*pt,.75*ge+.25*at]),A[H][N].push([.25*ae+.75*pt,.25*ge+.75*at])},!0),A.forEach(function(P){P.forEach(function(R){R.push(R[0])})})}var wr=null;function Hr(l,A,y){y===void 0&&(y=2);var b=getCoord(l),T=getCoord(A),P=b[0]-T[0],R=b[1]-T[1];return y===1?Math.abs(P)+Math.abs(R):Math.pow(Math.pow(P,y)+Math.pow(R,y),1/y)}function br(l,A){A=A||{};var y=A.threshold||1e4,b=A.p||2,T=A.binary||!1,P=A.alpha||-1,R=A.standardization||!1,U=[];featureEach(l,function(ge){U.push(centroid(ge))});for(var H=[],N=0;N<U.length;N++)H[N]=[];for(var N=0;N<U.length;N++)for(var Q=N;Q<U.length;Q++){N===Q&&(H[N][Q]=0);var K=Hr(U[N],U[Q],b);H[N][Q]=K,H[Q][N]=K}for(var N=0;N<U.length;N++)for(var Q=0;Q<U.length;Q++){var K=H[N][Q];K!==0&&(T?K<=y?H[N][Q]=1:H[N][Q]=0:K<=y?H[N][Q]=Math.pow(K,P):H[N][Q]=0)}if(R)for(var N=0;N<U.length;N++)for(var ae=H[N].reduce(function(pt,at){return pt+at},0),Q=0;Q<U.length;Q++)H[N][Q]=H[N][Q]/ae;return H}function Wr(l,A){var y=A.inputField,b=A.threshold||1e5,T=A.p||2,P=A.binary||!1,R=A.alpha||-1,U=A.standardization||!0,H=spatialWeight(l,{alpha:R,binary:P,p:T,standardization:U,threshold:b}),N=[];featureEach(l,function(bn){var Ei=bn.properties||{};N.push(Ei[y])});for(var Q=Cn(N),K=Xn(N),ae=0,ge=0,pt=0,at=0,Nt=H.length,dt=0;dt<Nt;dt++){for(var Ke=0,ht=0;ht<Nt;ht++)ae+=H[dt][ht]*(N[dt]-Q)*(N[ht]-Q),ge+=H[dt][ht],pt+=Math.pow(H[dt][ht]+H[ht][dt],2),Ke+=H[dt][ht]+H[ht][dt];at+=Math.pow(Ke,2)}pt=.5*pt;var Ht=ae/ge/K,Bt=-1/(Nt-1),ir=Nt*Nt*pt-Nt*at+3*(ge*ge),Kt=(Nt-1)*(Nt+1)*(ge*ge),fr=ir/Kt-Bt*Bt,Ct=Math.sqrt(fr),si=(Ht-Bt)/Ct;return{expectedMoranIndex:Bt,moranIndex:Ht,stdNorm:Ct,zNorm:si}}function Cn(l){for(var A=0,y=0,b=l;y<b.length;y++){var T=b[y];A+=T}return A/l.length}function Xn(l){for(var A=Cn(l),y=0,b=0,T=l;b<T.length;b++){var P=T[b];y+=Math.pow(P-A,2)}return y/l.length}function Ir(l,A){return A===void 0&&(A={}),gr(l,"mercator",A)}function Fr(l,A){return A===void 0&&(A={}),gr(l,"wgs84",A)}function gr(l,A,y){y===void 0&&(y={}),y=y||{};var b=y.mutate;if(!l)throw new Error("geojson is required");return Array.isArray(l)&&isNumber(l[0])?l=A==="mercator"?On(l):Bn(l):(b!==!0&&(l=clone(l)),coordEach(l,function(T){var P=A==="mercator"?On(T):Bn(T);T[0]=P[0],T[1]=P[1]})),l}function On(l){var A=Math.PI/180,y=6378137,b=20037508342789244e-9,T=Math.abs(l[0])<=180?l[0]:l[0]-gn(l[0])*360,P=[y*T*A,y*Math.log(Math.tan(Math.PI*.25+.5*l[1]*A))];return P[0]>b&&(P[0]=b),P[0]<-b&&(P[0]=-b),P[1]>b&&(P[1]=b),P[1]<-b&&(P[1]=-b),P}function Bn(l){var A=180/Math.PI,y=6378137;return[l[0]*A/y,(Math.PI*.5-2*Math.atan(Math.exp(-l[1]/y)))*A]}function gn(l){return l<0?-1:l>0?1:0}var xi=function(){for(var l=0,A=0,y=arguments.length;A<y;A++)l+=arguments[A].length;for(var b=Array(l),T=0,A=0;A<y;A++)for(var P=arguments[A],R=0,U=P.length;R<U;R++,T++)b[T]=P[R];return b};function Jn(l){return Array.isArray(l)?Ao(l):l&&l.bbox?Ao(l.bbox):[Io(),Na()]}function gi(l,A){A===void 0&&(A={}),l==null&&(l=1);for(var y=[],b=0;b<l;b++)y.push((0,Z.xm)(Jn(A.bbox)));return(0,Z.uf)(y)}function ta(l,A){A===void 0&&(A={}),l==null&&(l=1),(!isNumber(A.num_vertices)||A.num_vertices===void 0)&&(A.num_vertices=10),(!isNumber(A.max_radial_length)||A.max_radial_length===void 0)&&(A.max_radial_length=10);for(var y=[],b=function(P){var R=[],U=xi(Array(A.num_vertices+1)).map(Math.random);U.forEach(function(H,N,Q){Q[N]=N>0?H+Q[N-1]:H}),U.forEach(function(H){H=H*2*Math.PI/U[U.length-1];var N=Math.random();R.push([N*(A.max_radial_length||10)*Math.sin(H),N*(A.max_radial_length||10)*Math.cos(H)])}),R[R.length-1]=R[0],R=R.map(ro(Jn(A.bbox))),y.push(polygon([R]))},T=0;T<l;T++)b(T);return featureCollection(y)}function bo(l,A){if(A===void 0&&(A={}),A=A||{},!isObject(A))throw new Error("options is invalid");var y=A.bbox,b=A.num_vertices,T=A.max_length,P=A.max_rotation;l==null&&(l=1),(!isNumber(b)||b===void 0||b<2)&&(b=10),(!isNumber(T)||T===void 0)&&(T=1e-4),(!isNumber(P)||P===void 0)&&(P=Math.PI/8);for(var R=[],U=0;U<l;U++){for(var H=Jn(y),N=[H],Q=0;Q<b-1;Q++){var K=Q===0?Math.random()*2*Math.PI:Math.tan((N[Q][1]-N[Q-1][1])/(N[Q][0]-N[Q-1][0])),ae=K+(Math.random()-.5)*P*2,ge=Math.random()*T;N.push([N[Q][0]+ge*Math.cos(ae),N[Q][1]+ge*Math.sin(ae)])}R.push(lineString(N))}return featureCollection(R)}function ro(l){return function(A){return[A[0]+l[0],A[1]+l[1]]}}function Ti(){return Math.random()-.5}function Io(){return Ti()*360}function Na(){return Ti()*180}function Ao(l){return[Math.random()*(l[2]-l[0])+l[0],Math.random()*(l[3]-l[1])+l[1]]}function jo(l,A){if(!l)throw new Error("geojson is required");if(l.type!=="FeatureCollection")throw new Error("geojson must be a FeatureCollection");if(A==null)throw new Error("filter is required");var y=[];return featureEach(l,function(b){ya(b.properties,A)&&y.push(b)}),featureCollection(y)}function Fa(l,A,y){if(!l)throw new Error("geojson is required");if(l.type!=="FeatureCollection")throw new Error("geojson must be a FeatureCollection");if(A==null)throw new Error("property is required");for(var b=Tn(l,A),T=Object.keys(b),P=0;P<T.length;P++){for(var R=T[P],U=b[R],H=[],N=0;N<U.length;N++)H.push(l.features[U[N]]);y(featureCollection(H),R,P)}}function Ga(l,A,y,b){var T=b;return Fa(l,A,function(P,R,U){U===0&&b===void 0?T=P:T=y(T,P,R,U)}),T}function Tn(l,A){var y={};return featureEach(l,function(b,T){var P=b.properties||{};if(Object.prototype.hasOwnProperty.call(P,String(A))){var R=P[A];Object.prototype.hasOwnProperty.call(y,R)?y[R].push(T):y[R]=[T]}}),y}function ya(l,A){if(l===void 0)return!1;var y=typeof A;if(y==="number"||y==="string")return Object.prototype.hasOwnProperty.call(l,A);if(Array.isArray(A)){for(var b=0;b<A.length;b++)if(!ya(l,A[b]))return!1;return!0}else return un(l,A)}function un(l,A){for(var y=Object.keys(A),b=0;b<y.length;b++){var T=y[b];if(l[T]!==A[T])return!1}return!0}function da(l,A){if(!A)return{};if(!A.length)return{};for(var y={},b=0;b<A.length;b++){var T=A[b];Object.prototype.hasOwnProperty.call(l,T)&&(y[T]=l[T])}return y}var ra=C(32676);function Rn(l,A){var y=getGeom(l),b=getGeom(A),T=l.properties||{},P=polygonClipping.difference(y.coordinates,b.coordinates);return P.length===0?null:P.length===1?polygon(P[0],T):multiPolygon(P,T)}var mi=null,vr=C(20675);function Ri(){return new Xt}function Xt(){this.reset()}Xt.prototype={constructor:Xt,reset:function(){this.s=this.t=0},add:function(l){ct(Jo,l,this.t),ct(this,Jo.s,this.s),this.s?this.t+=Jo.t:this.s=Jo.t},valueOf:function(){return this.s}};var Jo=new Xt;function ct(l,A,y){var b=l.s=A+y,T=b-A,P=b-T;l.t=A-P+(y-T)}var ft=1e-6,Et=1e-12,Ur=Math.PI,Un=Ur/2,ot=Ur/4,Ye=Ur*2,St=180/Ur,Dt=Ur/180,Ft=Math.abs,h=Math.atan,f=Math.atan2,p=Math.cos,m=Math.ceil,E=Math.exp,S=Math.floor,I=Math.log,D=Math.pow,V=Math.sin,re=Math.sign||function(l){return l>0?1:l<0?-1:0},xe=Math.sqrt,Fe=Math.tan;function ut(l){return l>1?0:l<-1?Ur:Math.acos(l)}function gt(l){return l>1?Un:l<-1?-Un:Math.asin(l)}function rt(l){return(l=V(l/2))*l}function _t(){}function $t(l,A){l&&Wt.hasOwnProperty(l.type)&&Wt[l.type](l,A)}var qt={Feature:function(l,A){$t(l.geometry,A)},FeatureCollection:function(l,A){for(var y=l.features,b=-1,T=y.length;++b<T;)$t(y[b].geometry,A)}},Wt={Sphere:function(l,A){A.sphere()},Point:function(l,A){l=l.coordinates,A.point(l[0],l[1],l[2])},MultiPoint:function(l,A){for(var y=l.coordinates,b=-1,T=y.length;++b<T;)l=y[b],A.point(l[0],l[1],l[2])},LineString:function(l,A){rr(l.coordinates,A,0)},MultiLineString:function(l,A){for(var y=l.coordinates,b=-1,T=y.length;++b<T;)rr(y[b],A,0)},Polygon:function(l,A){Yt(l.coordinates,A)},MultiPolygon:function(l,A){for(var y=l.coordinates,b=-1,T=y.length;++b<T;)Yt(y[b],A)},GeometryCollection:function(l,A){for(var y=l.geometries,b=-1,T=y.length;++b<T;)$t(y[b],A)}};function rr(l,A,y){var b=-1,T=l.length-y,P;for(A.lineStart();++b<T;)P=l[b],A.point(P[0],P[1],P[2]);A.lineEnd()}function Yt(l,A){var y=-1,b=l.length;for(A.polygonStart();++y<b;)rr(l[y],A,1);A.polygonEnd()}function rn(l,A){l&&qt.hasOwnProperty(l.type)?qt[l.type](l,A):$t(l,A)}var xn=Ri(),Kr=Ri(),pn,Pa,ua,va,Vi,ci={point:_t,lineStart:_t,lineEnd:_t,polygonStart:function(){xn.reset(),ci.lineStart=Di,ci.lineEnd=Wa},polygonEnd:function(){var l=+xn;Kr.add(l<0?Ye+l:l),this.lineStart=this.lineEnd=this.point=_t},sphere:function(){Kr.add(Ye)}};function Di(){ci.point=Qn}function Wa(){Xa(pn,Pa)}function Qn(l,A){ci.point=Xa,pn=l,Pa=A,l*=Dt,A*=Dt,ua=l,va=p(A=A/2+ot),Vi=V(A)}function Xa(l,A){l*=Dt,A*=Dt,A=A/2+ot;var y=l-ua,b=y>=0?1:-1,T=b*y,P=p(A),R=V(A),U=Vi*R,H=va*P+U*p(T),N=U*b*V(T);xn.add(f(N,H)),ua=l,va=P,Vi=R}function Iu(l){return Kr.reset(),stream(l,ci),Kr*2}function Q0(l){return[f(l[1],l[0]),gt(l[2])]}function EA(l){var A=l[0],y=l[1],b=p(y);return[b*p(A),b*V(A),V(y)]}function lv(l,A){return l[0]*A[0]+l[1]*A[1]+l[2]*A[2]}function Mh(l,A){return[l[1]*A[2]-l[2]*A[1],l[2]*A[0]-l[0]*A[2],l[0]*A[1]-l[1]*A[0]]}function kp(l,A){l[0]+=A[0],l[1]+=A[1],l[2]+=A[2]}function Qg(l,A){return[l[0]*A,l[1]*A,l[2]*A]}function bA(l){var A=xe(l[0]*l[0]+l[1]*l[1]+l[2]*l[2]);l[0]/=A,l[1]/=A,l[2]/=A}var ja,Ks,So,Xl,fc,q0,K0,Qf,J0=Ri(),Lf,hf,Af={point:SA,lineStart:Np,lineEnd:Fp,polygonStart:function(){Af.point=wA,Af.lineStart=cv,Af.lineEnd=fv,J0.reset(),ci.polygonStart()},polygonEnd:function(){ci.polygonEnd(),Af.point=SA,Af.lineStart=Np,Af.lineEnd=Fp,xn<0?(ja=-(So=180),Ks=-(Xl=90)):J0>ft?Xl=90:J0<-ft&&(Ks=-90),hf[0]=ja,hf[1]=So}};function SA(l,A){Lf.push(hf=[ja=l,So=l]),A<Ks&&(Ks=A),A>Xl&&(Xl=A)}function CA(l,A){var y=EA([l*Dt,A*Dt]);if(Qf){var b=Mh(Qf,y),T=[b[1],-b[0],0],P=Mh(T,b);bA(P),P=Q0(P);var R=l-fc,U=R>0?1:-1,H=P[0]*St*U,N,Q=Ft(R)>180;Q^(U*fc<H&&H<U*l)?(N=P[1]*St,N>Xl&&(Xl=N)):(H=(H+360)%360-180,Q^(U*fc<H&&H<U*l)?(N=-P[1]*St,N<Ks&&(Ks=N)):(A<Ks&&(Ks=A),A>Xl&&(Xl=A))),Q?l<fc?Ml(ja,l)>Ml(ja,So)&&(So=l):Ml(l,So)>Ml(ja,So)&&(ja=l):So>=ja?(l<ja&&(ja=l),l>So&&(So=l)):l>fc?Ml(ja,l)>Ml(ja,So)&&(So=l):Ml(l,So)>Ml(ja,So)&&(ja=l)}else Lf.push(hf=[ja=l,So=l]);A<Ks&&(Ks=A),A>Xl&&(Xl=A),Qf=y,fc=l}function Np(){Af.point=CA}function Fp(){hf[0]=ja,hf[1]=So,Af.point=SA,Qf=null}function wA(l,A){if(Qf){var y=l-fc;J0.add(Ft(y)>180?y+(y>0?360:-360):y)}else q0=l,K0=A;ci.point(l,A),CA(l,A)}function cv(){ci.lineStart()}function fv(){wA(q0,K0),ci.lineEnd(),Ft(J0)>ft&&(ja=-(So=180)),hf[0]=ja,hf[1]=So,Qf=null}function Ml(l,A){return(A-=l)<0?A+360:A}function hv(l,A){return l[0]-A[0]}function Bp(l,A){return l[0]<=l[1]?l[0]<=A&&A<=l[1]:A<l[0]||l[1]<A}function Av(l){var A,y,b,T,P,R,U;if(Xl=So=-(ja=Ks=1/0),Lf=[],stream(l,Af),y=Lf.length){for(Lf.sort(hv),A=1,b=Lf[0],P=[b];A<y;++A)T=Lf[A],Bp(b,T[0])||Bp(b,T[1])?(Ml(b[0],T[1])>Ml(b[0],b[1])&&(b[1]=T[1]),Ml(T[0],b[1])>Ml(b[0],b[1])&&(b[0]=T[0])):P.push(b=T);for(R=-1/0,y=P.length-1,A=0,b=P[y];A<=y;b=T,++A)T=P[A],(U=Ml(b[1],T[0]))>R&&(R=U,ja=T[0],So=b[1])}return Lf=hf=null,ja===1/0||Ks===1/0?[[NaN,NaN],[NaN,NaN]]:[[ja,Ks],[So,Xl]]}var qf,Ih,Ph,eh,Lh,Oh,th,Rh,TA,MA,IA,PA,Zp,Vu,Hu,gu,hc={sphere:_t,point:LA,lineStart:OA,lineEnd:RA,polygonStart:function(){hc.lineStart=zp,hc.lineEnd=dv},polygonEnd:function(){hc.lineStart=OA,hc.lineEnd=RA}};function LA(l,A){l*=Dt,A*=Dt;var y=p(A);x0(y*p(l),y*V(l),V(A))}function x0(l,A,y){++qf,Ph+=(l-Ph)/qf,eh+=(A-eh)/qf,Lh+=(y-Lh)/qf}function OA(){hc.point=pv}function pv(l,A){l*=Dt,A*=Dt;var y=p(A);Vu=y*p(l),Hu=y*V(l),gu=V(A),hc.point=Dh,x0(Vu,Hu,gu)}function Dh(l,A){l*=Dt,A*=Dt;var y=p(A),b=y*p(l),T=y*V(l),P=V(A),R=f(xe((R=Hu*P-gu*T)*R+(R=gu*b-Vu*P)*R+(R=Vu*T-Hu*b)*R),Vu*b+Hu*T+gu*P);Ih+=R,Oh+=R*(Vu+(Vu=b)),th+=R*(Hu+(Hu=T)),Rh+=R*(gu+(gu=P)),x0(Vu,Hu,gu)}function RA(){hc.point=LA}function zp(){hc.point=vv}function dv(){DA(PA,Zp),hc.point=LA}function vv(l,A){PA=l,Zp=A,l*=Dt,A*=Dt,hc.point=DA;var y=p(A);Vu=y*p(l),Hu=y*V(l),gu=V(A),x0(Vu,Hu,gu)}function DA(l,A){l*=Dt,A*=Dt;var y=p(A),b=y*p(l),T=y*V(l),P=V(A),R=Hu*P-gu*T,U=gu*b-Vu*P,H=Vu*T-Hu*b,N=xe(R*R+U*U+H*H),Q=gt(N),K=N&&-Q/N;TA+=K*R,MA+=K*U,IA+=K*H,Ih+=Q,Oh+=Q*(Vu+(Vu=b)),th+=Q*(Hu+(Hu=T)),Rh+=Q*(gu+(gu=P)),x0(Vu,Hu,gu)}function qg(l){qf=Ih=Ph=eh=Lh=Oh=th=Rh=TA=MA=IA=0,stream(l,hc);var A=TA,y=MA,b=IA,T=A*A+y*y+b*b;return T<epsilon2&&(A=Oh,y=th,b=Rh,Ih<epsilon&&(A=Ph,y=eh,b=Lh),T=A*A+y*y+b*b,T<epsilon2)?[NaN,NaN]:[atan2(y,A)*degrees,asin(b/sqrt(T))*degrees]}function kA(l,A){return[l>Ur?l-Ye:l<-Ur?l+Ye:l,A]}kA.invert=kA;function Up(l,A,y){return(l%=tau)?A||y?compose(Gp(l),FA(A,y)):Gp(l):A||y?FA(A,y):kA}function NA(l){return function(A,y){return A+=l,[A>pi?A-tau:A<-pi?A+tau:A,y]}}function Gp(l){var A=NA(l);return A.invert=NA(-l),A}function FA(l,A){var y=cos(l),b=sin(l),T=cos(A),P=sin(A);function R(U,H){var N=cos(H),Q=cos(U)*N,K=sin(U)*N,ae=sin(H),ge=ae*y+Q*b;return[atan2(K*T-ge*P,Q*y-ae*b),asin(ge*T+K*P)]}return R.invert=function(U,H){var N=cos(H),Q=cos(U)*N,K=sin(U)*N,ae=sin(H),ge=ae*T-K*P;return[atan2(K*T+ae*P,Q*y+ge*b),asin(ge*y-Q*b)]},R}function gv(l){l=Up(l[0]*radians,l[1]*radians,l.length>2?l[2]*radians:0);function A(y){return y=l(y[0]*radians,y[1]*radians),y[0]*=degrees,y[1]*=degrees,y}return A.invert=function(y){return y=l.invert(y[0]*radians,y[1]*radians),y[0]*=degrees,y[1]*=degrees,y},A}function mv(l,A,y,b,T,P){if(y){var R=cos(A),U=sin(A),H=b*y;T==null?(T=A+b*tau,P=A-H/2):(T=pf(R,T),P=pf(R,P),(b>0?T<P:T>P)&&(T+=b*tau));for(var N,Q=T;b>0?Q>P:Q<P;Q-=H)N=spherical([R,-U*cos(Q),-U*sin(Q)]),l.point(N[0],N[1])}}function pf(l,A){A=cartesian(A),A[0]-=l,cartesianNormalizeInPlace(A);var y=acos(-A[1]);return((-A[2]<0?-y:y)+tau-epsilon)%tau}function E0(){var l=constant([0,0]),A=constant(90),y=constant(6),b,T,P={point:R};function R(H,N){b.push(H=T(H,N)),H[0]*=degrees,H[1]*=degrees}function U(){var H=l.apply(this,arguments),N=A.apply(this,arguments)*radians,Q=y.apply(this,arguments)*radians;return b=[],T=rotateRadians(-H[0]*radians,-H[1]*radians,0).invert,mv(P,N,Q,1),H={type:"Polygon",coordinates:[b]},b=T=null,H}return U.center=function(H){return arguments.length?(l=typeof H=="function"?H:constant([+H[0],+H[1]]),U):l},U.radius=function(H){return arguments.length?(A=typeof H=="function"?H:constant(+H),U):A},U.precision=function(H){return arguments.length?(y=typeof H=="function"?H:constant(+H),U):y},U}function kh(l,A){return Ft(l[0]-A[0])<ft&&Ft(l[1]-A[1])<ft}function us(l,A,y,b){this.x=l,this.z=A,this.o=y,this.e=b,this.v=!1,this.n=this.p=null}function yv(l,A,y,b,T){var P=[],R=[],U,H;if(l.forEach(function(pt){if(!((at=pt.length-1)<=0)){var at,Nt=pt[0],dt=pt[at],Ke;if(kh(Nt,dt)){for(T.lineStart(),U=0;U<at;++U)T.point((Nt=pt[U])[0],Nt[1]);T.lineEnd();return}P.push(Ke=new us(Nt,pt,null,!0)),R.push(Ke.o=new us(Nt,null,Ke,!1)),P.push(Ke=new us(dt,pt,null,!1)),R.push(Ke.o=new us(dt,null,Ke,!0))}}),!!P.length){for(R.sort(A),jp(P),jp(R),U=0,H=R.length;U<H;++U)R[U].e=y=!y;for(var N=P[0],Q,K;;){for(var ae=N,ge=!0;ae.v;)if((ae=ae.n)===N)return;Q=ae.z,T.lineStart();do{if(ae.v=ae.o.v=!0,ae.e){if(ge)for(U=0,H=Q.length;U<H;++U)T.point((K=Q[U])[0],K[1]);else b(ae.x,ae.n.x,1,T);ae=ae.n}else{if(ge)for(Q=ae.p.z,U=Q.length-1;U>=0;--U)T.point((K=Q[U])[0],K[1]);else b(ae.x,ae.p.x,-1,T);ae=ae.p}ae=ae.o,Q=ae.z,ge=!ge}while(!ae.v);T.lineEnd()}}}function jp(l){if(A=l.length){for(var A,y=0,b=l[0],T;++y<A;)b.n=T=l[y],T.p=b,b=T;b.n=T=l[0],T.p=b}}var Vp=C(61272),b0=1e9,Nh=-b0;function _v(l,A,y,b){function T(N,Q){return l<=N&&N<=y&&A<=Q&&Q<=b}function P(N,Q,K,ae){var ge=0,pt=0;if(N==null||(ge=R(N,K))!==(pt=R(Q,K))||H(N,Q)<0^K>0)do ae.point(ge===0||ge===3?l:y,ge>1?b:A);while((ge=(ge+K+4)%4)!==pt);else ae.point(Q[0],Q[1])}function R(N,Q){return abs(N[0]-l)<epsilon?Q>0?0:3:abs(N[0]-y)<epsilon?Q>0?2:1:abs(N[1]-A)<epsilon?Q>0?1:0:Q>0?3:2}function U(N,Q){return H(N.x,Q.x)}function H(N,Q){var K=R(N,1),ae=R(Q,1);return K!==ae?K-ae:K===0?Q[1]-N[1]:K===1?N[0]-Q[0]:K===2?N[1]-Q[1]:Q[0]-N[0]}return function(N){var Q=N,K=clipBuffer(),ae,ge,pt,at,Nt,dt,Ke,ht,Ht,Bt,ir,Kt={point:fr,lineStart:Ei,lineEnd:$i,polygonStart:si,polygonEnd:bn};function fr(ai,kn){T(ai,kn)&&Q.point(ai,kn)}function Ct(){for(var ai=0,kn=0,La=ge.length;kn<La;++kn)for(var Sa=ge[kn],Ji=1,mu=Sa.length,ys=Sa[0],su,Qa,po=ys[0],Vo=ys[1];Ji<mu;++Ji)su=po,Qa=Vo,ys=Sa[Ji],po=ys[0],Vo=ys[1],Qa<=b?Vo>b&&(po-su)*(b-Qa)>(Vo-Qa)*(l-su)&&++ai:Vo<=b&&(po-su)*(b-Qa)<(Vo-Qa)*(l-su)&&--ai;return ai}function si(){Q=K,ae=[],ge=[],ir=!0}function bn(){var ai=Ct(),kn=ir&&ai,La=(ae=merge(ae)).length;(kn||La)&&(N.polygonStart(),kn&&(N.lineStart(),P(null,null,1,N),N.lineEnd()),La&&clipPolygon(ae,U,ai,P,N),N.polygonEnd()),Q=N,ae=ge=pt=null}function Ei(){Kt.point=on,ge&&ge.push(pt=[]),Bt=!0,Ht=!1,Ke=ht=NaN}function $i(){ae&&(on(at,Nt),dt&&Ht&&K.rejoin(),ae.push(K.result())),Kt.point=fr,Ht&&Q.lineEnd()}function on(ai,kn){var La=T(ai,kn);if(ge&&pt.push([ai,kn]),Bt)at=ai,Nt=kn,dt=La,Bt=!1,La&&(Q.lineStart(),Q.point(ai,kn));else if(La&&Ht)Q.point(ai,kn);else{var Sa=[Ke=Math.max(Nh,Math.min(b0,Ke)),ht=Math.max(Nh,Math.min(b0,ht))],Ji=[ai=Math.max(Nh,Math.min(b0,ai)),kn=Math.max(Nh,Math.min(b0,kn))];clipLine(Sa,Ji,l,A,y,b)?(Ht||(Q.lineStart(),Q.point(Sa[0],Sa[1])),Q.point(Ji[0],Ji[1]),La||Q.lineEnd(),ir=!1):La&&(Q.lineStart(),Q.point(ai,kn),ir=!1)}Ke=ai,ht=kn,Ht=La}return Kt}}function Kg(){var l=0,A=0,y=960,b=500,T,P,R;return R={stream:function(U){return T&&P===U?T:T=_v(l,A,y,b)(P=U)},extent:function(U){return arguments.length?(l=+U[0][0],A=+U[0][1],y=+U[1][0],b=+U[1][1],T=P=null,R):[[l,A],[y,b]]}}}var BA=Ri();function Ki(l,A){var y=A[0],b=A[1],T=[V(y),-p(y),0],P=0,R=0;BA.reset();for(var U=0,H=l.length;U<H;++U)if(Q=(N=l[U]).length)for(var N,Q,K=N[Q-1],ae=K[0],ge=K[1]/2+ot,pt=V(ge),at=p(ge),Nt=0;Nt<Q;++Nt,ae=Ke,pt=Ht,at=Bt,K=dt){var dt=N[Nt],Ke=dt[0],ht=dt[1]/2+ot,Ht=V(ht),Bt=p(ht),ir=Ke-ae,Kt=ir>=0?1:-1,fr=Kt*ir,Ct=fr>Ur,si=pt*Ht;if(BA.add(f(si*Kt*V(fr),at*Bt+si*p(fr))),P+=Ct?ir+Kt*Ye:ir,Ct^ae>=y^Ke>=y){var bn=Mh(EA(K),EA(dt));bA(bn);var Ei=Mh(T,bn);bA(Ei);var $i=(Ct^ir>=0?-1:1)*gt(Ei[2]);(b>$i||b===$i&&(bn[0]||bn[1]))&&(R+=Ct^ir>=0?1:-1)}}return(P<-ft||P<ft&&BA<-ft)^R&1}var Hi=Ri(),Fh,ZA,Bh,rh={sphere:_t,point:_t,lineStart:Jg,lineEnd:_t,polygonStart:_t,polygonEnd:_t};function Jg(){rh.point=tm,rh.lineEnd=em}function em(){rh.point=rh.lineEnd=_t}function tm(l,A){l*=Dt,A*=Dt,Fh=l,ZA=V(A),Bh=p(A),rh.point=rm}function rm(l,A){l*=Dt,A*=Dt;var y=V(A),b=p(A),T=Ft(l-Fh),P=p(T),R=V(T),U=b*R,H=Bh*y-ZA*b*P,N=ZA*y+Bh*b*P;Hi.add(f(xe(U*U+H*H),N)),Fh=l,ZA=y,Bh=b}function nm(l){return Hi.reset(),rn(l,rh),+Hi}var Hp=[null,null],im={type:"LineString",coordinates:Hp};function zA(l,A){return Hp[0]=l,Hp[1]=A,nm(im)}var xv={Feature:function(l,A){return Zh(l.geometry,A)},FeatureCollection:function(l,A){for(var y=l.features,b=-1,T=y.length;++b<T;)if(Zh(y[b].geometry,A))return!0;return!1}},Ev={Sphere:function(){return!0},Point:function(l,A){return bv(l.coordinates,A)},MultiPoint:function(l,A){for(var y=l.coordinates,b=-1,T=y.length;++b<T;)if(bv(y[b],A))return!0;return!1},LineString:function(l,A){return Sv(l.coordinates,A)},MultiLineString:function(l,A){for(var y=l.coordinates,b=-1,T=y.length;++b<T;)if(Sv(y[b],A))return!0;return!1},Polygon:function(l,A){return Cv(l.coordinates,A)},MultiPolygon:function(l,A){for(var y=l.coordinates,b=-1,T=y.length;++b<T;)if(Cv(y[b],A))return!0;return!1},GeometryCollection:function(l,A){for(var y=l.geometries,b=-1,T=y.length;++b<T;)if(Zh(y[b],A))return!0;return!1}};function Zh(l,A){return l&&Ev.hasOwnProperty(l.type)?Ev[l.type](l,A):!1}function bv(l,A){return zA(l,A)===0}function Sv(l,A){var y=zA(l[0],l[1]),b=zA(l[0],A),T=zA(A,l[1]);return b+T<=y+ft}function Cv(l,A){return!!Ki(l.map(am),wv(A))}function am(l){return l=l.map(wv),l.pop(),l}function wv(l){return[l[0]*Dt,l[1]*Dt]}function Tx(l,A){return(l&&xv.hasOwnProperty(l.type)?xv[l.type]:Zh)(l,A)}function Tv(l,A,y){var b=range(l,A-epsilon,y).concat(A);return function(T){return b.map(function(P){return[T,P]})}}function Mv(l,A,y){var b=range(l,A-epsilon,y).concat(A);return function(T){return b.map(function(P){return[P,T]})}}function om(){var l,A,y,b,T,P,R,U,H=10,N=H,Q=90,K=360,ae,ge,pt,at,Nt=2.5;function dt(){return{type:"MultiLineString",coordinates:Ke()}}function Ke(){return range(ceil(b/Q)*Q,y,Q).map(pt).concat(range(ceil(U/K)*K,R,K).map(at)).concat(range(ceil(A/H)*H,l,H).filter(function(ht){return abs(ht%Q)>epsilon}).map(ae)).concat(range(ceil(P/N)*N,T,N).filter(function(ht){return abs(ht%K)>epsilon}).map(ge))}return dt.lines=function(){return Ke().map(function(ht){return{type:"LineString",coordinates:ht}})},dt.outline=function(){return{type:"Polygon",coordinates:[pt(b).concat(at(R).slice(1),pt(y).reverse().slice(1),at(U).reverse().slice(1))]}},dt.extent=function(ht){return arguments.length?dt.extentMajor(ht).extentMinor(ht):dt.extentMinor()},dt.extentMajor=function(ht){return arguments.length?(b=+ht[0][0],y=+ht[1][0],U=+ht[0][1],R=+ht[1][1],b>y&&(ht=b,b=y,y=ht),U>R&&(ht=U,U=R,R=ht),dt.precision(Nt)):[[b,U],[y,R]]},dt.extentMinor=function(ht){return arguments.length?(A=+ht[0][0],l=+ht[1][0],P=+ht[0][1],T=+ht[1][1],A>l&&(ht=A,A=l,l=ht),P>T&&(ht=P,P=T,T=ht),dt.precision(Nt)):[[A,P],[l,T]]},dt.step=function(ht){return arguments.length?dt.stepMajor(ht).stepMinor(ht):dt.stepMinor()},dt.stepMajor=function(ht){return arguments.length?(Q=+ht[0],K=+ht[1],dt):[Q,K]},dt.stepMinor=function(ht){return arguments.length?(H=+ht[0],N=+ht[1],dt):[H,N]},dt.precision=function(ht){return arguments.length?(Nt=+ht,ae=Tv(P,T,90),ge=Mv(A,l,Nt),pt=Tv(U,R,90),at=Mv(b,y,Nt),dt):Nt},dt.extentMajor([[-180,-90+epsilon],[180,90-epsilon]]).extentMinor([[-180,-80-epsilon],[180,80+epsilon]])}function Mx(){return om()()}function Ix(l,A){var y=l[0]*radians,b=l[1]*radians,T=A[0]*radians,P=A[1]*radians,R=cos(b),U=sin(b),H=cos(P),N=sin(P),Q=R*cos(y),K=R*sin(y),ae=H*cos(T),ge=H*sin(T),pt=2*asin(sqrt(haversin(P-b)+R*H*haversin(T-y))),at=sin(pt),Nt=pt?function(dt){var Ke=sin(dt*=pt)/at,ht=sin(pt-dt)/at,Ht=ht*Q+Ke*ae,Bt=ht*K+Ke*ge,ir=ht*U+Ke*N;return[atan2(Bt,Ht)*degrees,atan2(ir,sqrt(Ht*Ht+Bt*Bt))*degrees]}:function(){return[y*degrees,b*degrees]};return Nt.distance=pt,Nt}var $p=Ri(),nh=Ri(),Iv,Pv,Yp,Wp,S0={point:_t,lineStart:_t,lineEnd:_t,polygonStart:function(){S0.lineStart=sm,S0.lineEnd=lm},polygonEnd:function(){S0.lineStart=S0.lineEnd=S0.point=_t,$p.add(Ft(nh)),nh.reset()},result:function(){var l=$p/2;return $p.reset(),l}};function sm(){S0.point=um}function um(l,A){S0.point=Lv,Iv=Yp=l,Pv=Wp=A}function Lv(l,A){nh.add(Wp*l-Yp*A),Yp=l,Wp=A}function lm(){Lv(Iv,Pv)}var Px=null,ih=1/0,UA=ih,zh=-ih,C0=zh,cm={point:Xp,lineStart:_t,lineEnd:_t,polygonStart:_t,polygonEnd:_t,result:function(){var l=[[ih,UA],[zh,C0]];return zh=C0=-(UA=ih=1/0),l}};function Xp(l,A){l<ih&&(ih=l),l>zh&&(zh=l),A<UA&&(UA=A),A>C0&&(C0=A)}var Ov=null,Bc=0,df=0,w0=0,ah=0,oh=0,Of=0,Uh=0,GA=0,sh=0,jA,VA,Zc,zc,Uc={point:Kf,lineStart:T0,lineEnd:HA,polygonStart:function(){Uc.lineStart=qp,Uc.lineEnd=$A},polygonEnd:function(){Uc.point=Kf,Uc.lineStart=T0,Uc.lineEnd=HA},result:function(){var l=sh?[Uh/sh,GA/sh]:Of?[ah/Of,oh/Of]:w0?[Bc/w0,df/w0]:[NaN,NaN];return Bc=df=w0=ah=oh=Of=Uh=GA=sh=0,l}};function Kf(l,A){Bc+=l,df+=A,++w0}function T0(){Uc.point=$u}function $u(l,A){Uc.point=Qp,Kf(Zc=l,zc=A)}function Qp(l,A){var y=l-Zc,b=A-zc,T=xe(y*y+b*b);ah+=T*(Zc+l)/2,oh+=T*(zc+A)/2,Of+=T,Kf(Zc=l,zc=A)}function HA(){Uc.point=Kf}function qp(){Uc.point=Kp}function $A(){Jp(jA,VA)}function Kp(l,A){Uc.point=Jp,Kf(jA=Zc=l,VA=zc=A)}function Jp(l,A){var y=l-Zc,b=A-zc,T=xe(y*y+b*b);ah+=T*(Zc+l)/2,oh+=T*(zc+A)/2,Of+=T,T=zc*l-Zc*A,Uh+=T*(Zc+l),GA+=T*(zc+A),sh+=T*3,Kf(Zc=l,zc=A)}var fm=null;function Rv(l){this._context=l}Rv.prototype={_radius:4.5,pointRadius:function(l){return this._radius=l,this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){this._line===0&&this._context.closePath(),this._point=NaN},point:function(l,A){switch(this._point){case 0:{this._context.moveTo(l,A),this._point=1;break}case 1:{this._context.lineTo(l,A);break}default:{this._context.moveTo(l+this._radius,A),this._context.arc(l,A,this._radius,0,Ye);break}}},result:_t};var YA=Ri(),WA,ed,td,je,M0,Gh={point:_t,lineStart:function(){Gh.point=rd},lineEnd:function(){WA&&XA(ed,td),Gh.point=_t},polygonStart:function(){WA=!0},polygonEnd:function(){WA=null},result:function(){var l=+YA;return YA.reset(),l}};function rd(l,A){Gh.point=XA,ed=je=l,td=M0=A}function XA(l,A){je-=l,M0-=A,YA.add(xe(je*je+M0*M0)),je=l,M0=A}var Dv=null;function nd(){this._string=[]}nd.prototype={_radius:4.5,_circle:QA(4.5),pointRadius:function(l){return(l=+l)!==this._radius&&(this._radius=l,this._circle=null),this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){this._line===0&&this._string.push("Z"),this._point=NaN},point:function(l,A){switch(this._point){case 0:{this._string.push("M",l,",",A),this._point=1;break}case 1:{this._string.push("L",l,",",A);break}default:{this._circle==null&&(this._circle=QA(this._radius)),this._string.push("M",l,",",A,this._circle);break}}},result:function(){if(this._string.length){var l=this._string.join("");return this._string=[],l}else return null}};function QA(l){return"m0,"+l+"a"+l+","+l+" 0 1,1 0,"+-2*l+"a"+l+","+l+" 0 1,1 0,"+2*l+"z"}function I0(l,A){var y=4.5,b,T;function P(R){return R&&(typeof y=="function"&&T.pointRadius(+y.apply(this,arguments)),stream(R,b(T))),T.result()}return P.area=function(R){return stream(R,b(pathArea)),pathArea.result()},P.measure=function(R){return stream(R,b(pathMeasure)),pathMeasure.result()},P.bounds=function(R){return stream(R,b(pathBounds)),pathBounds.result()},P.centroid=function(R){return stream(R,b(pathCentroid)),pathCentroid.result()},P.projection=function(R){return arguments.length?(b=R==null?(l=null,identity):(l=R).stream,P):l},P.context=function(R){return arguments.length?(T=R==null?(A=null,new PathString):new PathContext(A=R),typeof y!="function"&&T.pointRadius(y),P):A},P.pointRadius=function(R){return arguments.length?(y=typeof R=="function"?R:(T.pointRadius(+R),+R),P):y},P.projection(l).context(A)}function id(){var l=[],A;return{point:function(y,b){A.push([y,b])},lineStart:function(){l.push(A=[])},lineEnd:_t,rejoin:function(){l.length>1&&l.push(l.pop().concat(l.shift()))},result:function(){var y=l;return l=[],A=null,y}}}function ad(l,A,y,b){return function(T,P){var R=A(P),U=T.invert(b[0],b[1]),H=id(),N=A(H),Q=!1,K,ae,ge,pt={point:at,lineStart:dt,lineEnd:Ke,polygonStart:function(){pt.point=ht,pt.lineStart=Ht,pt.lineEnd=Bt,ae=[],K=[]},polygonEnd:function(){pt.point=at,pt.lineStart=dt,pt.lineEnd=Ke,ae=(0,Vp.TS)(ae);var ir=Ki(K,U);ae.length?(Q||(P.polygonStart(),Q=!0),yv(ae,sd,ir,y,P)):ir&&(Q||(P.polygonStart(),Q=!0),P.lineStart(),y(null,null,1,P),P.lineEnd()),Q&&(P.polygonEnd(),Q=!1),ae=K=null},sphere:function(){P.polygonStart(),P.lineStart(),y(null,null,1,P),P.lineEnd(),P.polygonEnd()}};function at(ir,Kt){var fr=T(ir,Kt);l(ir=fr[0],Kt=fr[1])&&P.point(ir,Kt)}function Nt(ir,Kt){var fr=T(ir,Kt);R.point(fr[0],fr[1])}function dt(){pt.point=Nt,R.lineStart()}function Ke(){pt.point=at,R.lineEnd()}function ht(ir,Kt){ge.push([ir,Kt]);var fr=T(ir,Kt);N.point(fr[0],fr[1])}function Ht(){N.lineStart(),ge=[]}function Bt(){ht(ge[0][0],ge[0][1]),N.lineEnd();var ir=N.clean(),Kt=H.result(),fr,Ct=Kt.length,si,bn,Ei;if(ge.pop(),K.push(ge),ge=null,!!Ct){if(ir&1){if(bn=Kt[0],(si=bn.length-1)>0){for(Q||(P.polygonStart(),Q=!0),P.lineStart(),fr=0;fr<si;++fr)P.point((Ei=bn[fr])[0],Ei[1]);P.lineEnd()}return}Ct>1&&ir&2&&Kt.push(Kt.pop().concat(Kt.shift())),ae.push(Kt.filter(od))}}return pt}}function od(l){return l.length>1}function sd(l,A){return((l=l.x)[0]<0?l[1]-Un-ft:Un-l[1])-((A=A.x)[0]<0?A[1]-Un-ft:Un-A[1])}var kv=ad(function(){return!0},Nv,ud,[-Ur,-Un]);function Nv(l){var A=NaN,y=NaN,b=NaN,T;return{lineStart:function(){l.lineStart(),T=1},point:function(P,R){var U=P>0?Ur:-Ur,H=Ft(P-A);Ft(H-Ur)<ft?(l.point(A,y=(y+R)/2>0?Un:-Un),l.point(b,y),l.lineEnd(),l.lineStart(),l.point(U,y),l.point(P,y),T=0):b!==U&&H>=Ur&&(Ft(A-b)<ft&&(A-=b*ft),Ft(P-U)<ft&&(P-=U*ft),y=Fv(A,y,P,R),l.point(b,y),l.lineEnd(),l.lineStart(),l.point(U,y),T=0),l.point(A=P,y=R),b=U},lineEnd:function(){l.lineEnd(),A=y=NaN},clean:function(){return 2-T}}}function Fv(l,A,y,b){var T,P,R=V(l-y);return Ft(R)>ft?h((V(A)*(P=p(b))*V(y)-V(b)*(T=p(A))*V(l))/(T*P*R)):(A+b)/2}function ud(l,A,y,b){var T;if(l==null)T=y*Un,b.point(-Ur,T),b.point(0,T),b.point(Ur,T),b.point(Ur,0),b.point(Ur,-T),b.point(0,-T),b.point(-Ur,-T),b.point(-Ur,0),b.point(-Ur,T);else if(Ft(l[0]-A[0])>ft){var P=l[0]<A[0]?Ur:-Ur;T=y*P/2,b.point(-P,T),b.point(0,T),b.point(P,T)}else b.point(A[0],A[1])}function Bv(l,A){var y=cos(l),b=y>0,T=abs(y)>epsilon;function P(Q,K,ae,ge){circleStream(ge,l,A,ae,Q,K)}function R(Q,K){return cos(Q)*cos(K)>y}function U(Q){var K,ae,ge,pt,at;return{lineStart:function(){pt=ge=!1,at=1},point:function(Nt,dt){var Ke=[Nt,dt],ht,Ht=R(Nt,dt),Bt=b?Ht?0:N(Nt,dt):Ht?N(Nt+(Nt<0?pi:-pi),dt):0;if(!K&&(pt=ge=Ht)&&Q.lineStart(),Ht!==ge&&(ht=H(K,Ke),(!ht||pointEqual(K,ht)||pointEqual(Ke,ht))&&(Ke[0]+=epsilon,Ke[1]+=epsilon,Ht=R(Ke[0],Ke[1]))),Ht!==ge)at=0,Ht?(Q.lineStart(),ht=H(Ke,K),Q.point(ht[0],ht[1])):(ht=H(K,Ke),Q.point(ht[0],ht[1]),Q.lineEnd()),K=ht;else if(T&&K&&b^Ht){var ir;!(Bt&ae)&&(ir=H(Ke,K,!0))&&(at=0,b?(Q.lineStart(),Q.point(ir[0][0],ir[0][1]),Q.point(ir[1][0],ir[1][1]),Q.lineEnd()):(Q.point(ir[1][0],ir[1][1]),Q.lineEnd(),Q.lineStart(),Q.point(ir[0][0],ir[0][1])))}Ht&&(!K||!pointEqual(K,Ke))&&Q.point(Ke[0],Ke[1]),K=Ke,ge=Ht,ae=Bt},lineEnd:function(){ge&&Q.lineEnd(),K=null},clean:function(){return at|(pt&&ge)<<1}}}function H(Q,K,ae){var ge=cartesian(Q),pt=cartesian(K),at=[1,0,0],Nt=cartesianCross(ge,pt),dt=cartesianDot(Nt,Nt),Ke=Nt[0],ht=dt-Ke*Ke;if(!ht)return!ae&&Q;var Ht=y*dt/ht,Bt=-y*Ke/ht,ir=cartesianCross(at,Nt),Kt=cartesianScale(at,Ht),fr=cartesianScale(Nt,Bt);cartesianAddInPlace(Kt,fr);var Ct=ir,si=cartesianDot(Kt,Ct),bn=cartesianDot(Ct,Ct),Ei=si*si-bn*(cartesianDot(Kt,Kt)-1);if(!(Ei<0)){var $i=sqrt(Ei),on=cartesianScale(Ct,(-si-$i)/bn);if(cartesianAddInPlace(on,Kt),on=spherical(on),!ae)return on;var ai=Q[0],kn=K[0],La=Q[1],Sa=K[1],Ji;kn<ai&&(Ji=ai,ai=kn,kn=Ji);var mu=kn-ai,ys=abs(mu-pi)<epsilon,su=ys||mu<epsilon;if(!ys&&Sa<La&&(Ji=La,La=Sa,Sa=Ji),su?ys?La+Sa>0^on[1]<(abs(on[0]-ai)<epsilon?La:Sa):La<=on[1]&&on[1]<=Sa:mu>pi^(ai<=on[0]&&on[0]<=kn)){var Qa=cartesianScale(Ct,(-si+$i)/bn);return cartesianAddInPlace(Qa,Kt),[on,spherical(Qa)]}}}function N(Q,K){var ae=b?l:pi-l,ge=0;return Q<-ae?ge|=1:Q>ae&&(ge|=2),K<-ae?ge|=4:K>ae&&(ge|=8),ge}return clip(R,U,P,b?[0,-l]:[-pi,l-pi])}function Zv(l){return{stream:qA(l)}}function qA(l){return function(A){var y=new jh;for(var b in l)y[b]=l[b];return y.stream=A,y}}function jh(){}jh.prototype={constructor:jh,point:function(l,A){this.stream.point(l,A)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};function uh(l,A,y){var b=A[1][0]-A[0][0],T=A[1][1]-A[0][1],P=l.clipExtent&&l.clipExtent();l.scale(150).translate([0,0]),P!=null&&l.clipExtent(null),geoStream(y,l.stream(boundsStream));var R=boundsStream.result(),U=Math.min(b/(R[1][0]-R[0][0]),T/(R[1][1]-R[0][1])),H=+A[0][0]+(b-U*(R[1][0]+R[0][0]))/2,N=+A[0][1]+(T-U*(R[1][1]+R[0][1]))/2;return P!=null&&l.clipExtent(P),l.scale(U*150).translate([H,N])}function zv(l,A,y){return uh(l,[[0,0],A],y)}var KA=16,ld=p(30*Dt);function cd(l,A){return+A?fd(l,A):Uv(l)}function Uv(l){return transformer({point:function(A,y){A=l(A,y),this.stream.point(A[0],A[1])}})}function fd(l,A){function y(b,T,P,R,U,H,N,Q,K,ae,ge,pt,at,Nt){var dt=N-b,Ke=Q-T,ht=dt*dt+Ke*Ke;if(ht>4*A&&at--){var Ht=R+ae,Bt=U+ge,ir=H+pt,Kt=sqrt(Ht*Ht+Bt*Bt+ir*ir),fr=asin(ir/=Kt),Ct=abs(abs(ir)-1)<epsilon||abs(P-K)<epsilon?(P+K)/2:atan2(Bt,Ht),si=l(Ct,fr),bn=si[0],Ei=si[1],$i=bn-b,on=Ei-T,ai=Ke*$i-dt*on;(ai*ai/ht>A||abs((dt*$i+Ke*on)/ht-.5)>.3||R*ae+U*ge+H*pt<ld)&&(y(b,T,P,R,U,H,bn,Ei,Ct,Ht/=Kt,Bt/=Kt,ir,at,Nt),Nt.point(bn,Ei),y(bn,Ei,Ct,Ht,Bt,ir,N,Q,K,ae,ge,pt,at,Nt))}}return function(b){var T,P,R,U,H,N,Q,K,ae,ge,pt,at,Nt={point:dt,lineStart:Ke,lineEnd:Ht,polygonStart:function(){b.polygonStart(),Nt.lineStart=Bt},polygonEnd:function(){b.polygonEnd(),Nt.lineStart=Ke}};function dt(fr,Ct){fr=l(fr,Ct),b.point(fr[0],fr[1])}function Ke(){K=NaN,Nt.point=ht,b.lineStart()}function ht(fr,Ct){var si=cartesian([fr,Ct]),bn=l(fr,Ct);y(K,ae,Q,ge,pt,at,K=bn[0],ae=bn[1],Q=fr,ge=si[0],pt=si[1],at=si[2],KA,b),b.point(K,ae)}function Ht(){Nt.point=dt,b.lineEnd()}function Bt(){Ke(),Nt.point=ir,Nt.lineEnd=Kt}function ir(fr,Ct){ht(T=fr,Ct),P=K,R=ae,U=ge,H=pt,N=at,Nt.point=ht}function Kt(){y(K,ae,Q,ge,pt,at,P,R,T,U,H,N,KA,b),Nt.lineEnd=Ht,Ht()}return Nt}}var Gv=qA({point:function(l,A){this.stream.point(l*Dt,A*Dt)}});function hm(l){return hd(function(){return l})()}function hd(l){var A,y=150,b=480,T=250,P,R,U=0,H=0,N=0,Q=0,K=0,ae,ge,pt=null,at=clipAntimeridian,Nt=null,dt,Ke,ht,Ht=identity,Bt=.5,ir=resample(bn,Bt),Kt,fr;function Ct(on){return on=ge(on[0]*radians,on[1]*radians),[on[0]*y+P,R-on[1]*y]}function si(on){return on=ge.invert((on[0]-P)/y,(R-on[1])/y),on&&[on[0]*degrees,on[1]*degrees]}function bn(on,ai){return on=A(on,ai),[on[0]*y+P,R-on[1]*y]}Ct.stream=function(on){return Kt&&fr===on?Kt:Kt=Gv(at(ae,ir(Ht(fr=on))))},Ct.clipAngle=function(on){return arguments.length?(at=+on?clipCircle(pt=on*radians,6*radians):(pt=null,clipAntimeridian),$i()):pt*degrees},Ct.clipExtent=function(on){return arguments.length?(Ht=on==null?(Nt=dt=Ke=ht=null,identity):clipExtent(Nt=+on[0][0],dt=+on[0][1],Ke=+on[1][0],ht=+on[1][1]),$i()):Nt==null?null:[[Nt,dt],[Ke,ht]]},Ct.scale=function(on){return arguments.length?(y=+on,Ei()):y},Ct.translate=function(on){return arguments.length?(b=+on[0],T=+on[1],Ei()):[b,T]},Ct.center=function(on){return arguments.length?(U=on[0]%360*radians,H=on[1]%360*radians,Ei()):[U*degrees,H*degrees]},Ct.rotate=function(on){return arguments.length?(N=on[0]%360*radians,Q=on[1]%360*radians,K=on.length>2?on[2]%360*radians:0,Ei()):[N*degrees,Q*degrees,K*degrees]},Ct.precision=function(on){return arguments.length?(ir=resample(bn,Bt=on*on),$i()):sqrt(Bt)},Ct.fitExtent=function(on,ai){return fitExtent(Ct,on,ai)},Ct.fitSize=function(on,ai){return fitSize(Ct,on,ai)};function Ei(){ge=compose(ae=rotateRadians(N,Q,K),A);var on=A(U,H);return P=b-on[0]*y,R=T+on[1]*y,$i()}function $i(){return Kt=fr=null,Ct}return function(){return A=l.apply(this,arguments),Ct.invert=A.invert&&si,Ei()}}function Am(l){var A=0,y=pi/3,b=projectionMutator(l),T=b(A,y);return T.parallels=function(P){return arguments.length?b(A=P[0]*radians,y=P[1]*radians):[A*degrees,y*degrees]},T}function Ac(l){var A=cos(l);function y(b,T){return[b*A,sin(T)/A]}return y.invert=function(b,T){return[b/A,asin(T*A)]},y}function jv(l,A){var y=sin(l),b=(y+sin(A))/2;if(abs(b)<epsilon)return cylindricalEqualAreaRaw(l);var T=1+y*(2*b-y),P=sqrt(T)/b;function R(U,H){var N=sqrt(T-2*b*sin(H))/b;return[N*sin(U*=b),P-N*cos(U)]}return R.invert=function(U,H){var N=P-H;return[atan2(U,abs(N))/b*sign(N),asin((T-(U*U+N*N)*b*b)/(2*b))]},R}function pm(){return conicProjection(jv).scale(155.424).center([0,33.6442])}function dm(){return conicEqualArea().parallels([29.5,45.5]).scale(1070).translate([480,250]).rotate([96,0]).center([-.6,38.7])}function Vv(l){var A=l.length;return{point:function(y,b){for(var T=-1;++T<A;)l[T].point(y,b)},sphere:function(){for(var y=-1;++y<A;)l[y].sphere()},lineStart:function(){for(var y=-1;++y<A;)l[y].lineStart()},lineEnd:function(){for(var y=-1;++y<A;)l[y].lineEnd()},polygonStart:function(){for(var y=-1;++y<A;)l[y].polygonStart()},polygonEnd:function(){for(var y=-1;++y<A;)l[y].polygonEnd()}}}function Vh(){var l,A,y=albers(),b,T=conicEqualArea().rotate([154,0]).center([-2,58.5]).parallels([55,65]),P,R=conicEqualArea().rotate([157,0]).center([-3,19.9]).parallels([8,18]),U,H,N={point:function(ae,ge){H=[ae,ge]}};function Q(ae){var ge=ae[0],pt=ae[1];return H=null,b.point(ge,pt),H||(P.point(ge,pt),H)||(U.point(ge,pt),H)}Q.invert=function(ae){var ge=y.scale(),pt=y.translate(),at=(ae[0]-pt[0])/ge,Nt=(ae[1]-pt[1])/ge;return(Nt>=.12&&Nt<.234&&at>=-.425&&at<-.214?T:Nt>=.166&&Nt<.234&&at>=-.214&&at<-.115?R:y).invert(ae)},Q.stream=function(ae){return l&&A===ae?l:l=Vv([y.stream(A=ae),T.stream(ae),R.stream(ae)])},Q.precision=function(ae){return arguments.length?(y.precision(ae),T.precision(ae),R.precision(ae),K()):y.precision()},Q.scale=function(ae){return arguments.length?(y.scale(ae),T.scale(ae*.35),R.scale(ae),Q.translate(y.translate())):y.scale()},Q.translate=function(ae){if(!arguments.length)return y.translate();var ge=y.scale(),pt=+ae[0],at=+ae[1];return b=y.translate(ae).clipExtent([[pt-.455*ge,at-.238*ge],[pt+.455*ge,at+.238*ge]]).stream(N),P=T.translate([pt-.307*ge,at+.201*ge]).clipExtent([[pt-.425*ge+epsilon,at+.12*ge+epsilon],[pt-.214*ge-epsilon,at+.234*ge-epsilon]]).stream(N),U=R.translate([pt-.205*ge,at+.212*ge]).clipExtent([[pt-.214*ge+epsilon,at+.166*ge+epsilon],[pt-.115*ge-epsilon,at+.234*ge-epsilon]]).stream(N),K()},Q.fitExtent=function(ae,ge){return fitExtent(Q,ae,ge)},Q.fitSize=function(ae,ge){return fitSize(Q,ae,ge)};function K(){return l=A=null,Q}return Q.scale(1070)}function JA(l){return function(A,y){var b=p(A),T=p(y),P=l(b*T);return[P*T*V(A),P*V(y)]}}function P0(l){return function(A,y){var b=xe(A*A+y*y),T=l(b),P=V(T),R=p(T);return[f(A*P,b*R),gt(b&&y*P/b)]}}var ep=JA(function(l){return xe(2/(1+l))});ep.invert=P0(function(l){return 2*gt(l/2)});function Ad(){return projection(ep).scale(124.75).clipAngle(180-.001)}var tp=JA(function(l){return(l=ut(l))&&l/V(l)});tp.invert=P0(function(l){return l});function vm(){return projection(tp).scale(79.4188).clipAngle(180-.001)}function rp(l,A){return[l,I(Fe((Un+A)/2))]}rp.invert=function(l,A){return[l,2*h(E(A))-Un]};function pd(){return np(rp).scale(961/tau)}function np(l){var A=projection(l),y=A.center,b=A.scale,T=A.translate,P=A.clipExtent,R=null,U,H,N;A.scale=function(K){return arguments.length?(b(K),Q()):b()},A.translate=function(K){return arguments.length?(T(K),Q()):T()},A.center=function(K){return arguments.length?(y(K),Q()):y()},A.clipExtent=function(K){return arguments.length?(K==null?R=U=H=N=null:(R=+K[0][0],U=+K[0][1],H=+K[1][0],N=+K[1][1]),Q()):R==null?null:[[R,U],[H,N]]};function Q(){var K=pi*b(),ae=A(rotation(A.rotate()).invert([0,0]));return P(R==null?[[ae[0]-K,ae[1]-K],[ae[0]+K,ae[1]+K]]:l===rp?[[Math.max(ae[0]-K,R),U],[Math.min(ae[0]+K,H),N]]:[[R,Math.max(ae[1]-K,U)],[H,Math.min(ae[1]+K,N)]])}return Q()}function L0(l){return tan((halfPi+l)/2)}function Hh(l,A){var y=cos(l),b=l===A?sin(l):log(y/cos(A))/log(L0(A)/L0(l)),T=y*pow(L0(l),b)/b;if(!b)return mercatorRaw;function P(R,U){T>0?U<-halfPi+epsilon&&(U=-halfPi+epsilon):U>halfPi-epsilon&&(U=halfPi-epsilon);var H=T/pow(L0(U),b);return[H*sin(b*R),T-H*cos(b*R)]}return P.invert=function(R,U){var H=T-U,N=sign(b)*sqrt(R*R+H*H);return[atan2(R,abs(H))/b*sign(H),2*atan(pow(T/N,1/b))-halfPi]},P}function ip(){return conicProjection(Hh).scale(109.5).parallels([30,30])}function lh(l,A){return[l,A]}lh.invert=lh;function dd(){return projection(lh).scale(152.63)}function $h(l,A){var y=cos(l),b=l===A?sin(l):(y-cos(A))/(A-l),T=y/b+l;if(abs(b)<epsilon)return equirectangularRaw;function P(R,U){var H=T-U,N=b*R;return[H*sin(N),T-H*cos(N)]}return P.invert=function(R,U){var H=T-U;return[atan2(R,abs(H))/b*sign(H),T-sign(b)*sqrt(R*R+H*H)]},P}function Yh(){return conicProjection($h).scale(131.154).center([0,13.9389])}function Yu(l,A){var y=p(A),b=p(l)*y;return[y*V(l)/b,V(A)/b]}Yu.invert=P0(h);function vd(){return projection(Yu).scale(144.049).clipAngle(60)}function O0(l,A,y,b){return l===1&&A===1&&y===0&&b===0?identity:transformer({point:function(T,P){this.stream.point(T*l+y,P*A+b)}})}function Jf(){var l=1,A=0,y=0,b=1,T=1,P=identity,R=null,U,H,N,Q=identity,K,ae,ge;function pt(){return K=ae=null,ge}return ge={stream:function(at){return K&&ae===at?K:K=P(Q(ae=at))},clipExtent:function(at){return arguments.length?(Q=at==null?(R=U=H=N=null,identity):clipExtent(R=+at[0][0],U=+at[0][1],H=+at[1][0],N=+at[1][1]),pt()):R==null?null:[[R,U],[H,N]]},scale:function(at){return arguments.length?(P=O0((l=+at)*b,l*T,A,y),pt()):l},translate:function(at){return arguments.length?(P=O0(l*b,l*T,A=+at[0],y=+at[1]),pt()):[A,y]},reflectX:function(at){return arguments.length?(P=O0(l*(b=at?-1:1),l*T,A,y),pt()):b<0},reflectY:function(at){return arguments.length?(P=O0(l*b,l*(T=at?-1:1),A,y),pt()):T<0},fitExtent:function(at,Nt){return fitExtent(ge,at,Nt)},fitSize:function(at,Nt){return fitSize(ge,at,Nt)}}}function gd(l,A){var y=A*A,b=y*y;return[l*(.8707-.131979*y+b*(-.013791+b*(.003971*y-.001529*b))),A*(1.007226+y*(.015085+b*(-.044475+.028874*y-.005916*b)))]}gd.invert=function(l,A){var y=A,b=25,T;do{var P=y*y,R=P*P;y-=T=(y*(1.007226+P*(.015085+R*(-.044475+.028874*P-.005916*R)))-A)/(1.007226+P*(.015085*3+R*(-.044475*7+.028874*9*P-.005916*11*R)))}while(Ft(T)>ft&&--b>0);return[l/(.8707+(P=y*y)*(-.131979+P*(-.013791+P*P*P*(.003971-.001529*P)))),y]};function gm(){return projection(gd).scale(175.295)}function md(l,A){return[p(A)*V(l),V(A)]}md.invert=P0(gt);function Hv(){return projection(md).scale(249.5).clipAngle(90+epsilon)}function ap(l,A){var y=p(A),b=1+p(l)*y;return[y*V(l)/b,V(A)/b]}ap.invert=P0(function(l){return 2*h(l)});function Wh(){return projection(ap).scale(250).clipAngle(142)}function yd(l,A){return[I(Fe((Un+A)/2)),-l]}yd.invert=function(l,A){return[-A,2*h(E(l))-Un]};function mm(){var l=mercatorProjection(yd),A=l.center,y=l.rotate;return l.center=function(b){return arguments.length?A([-b[1],b[0]]):(b=A(),[b[1],-b[0]])},l.rotate=function(b){return arguments.length?y([b[0],b[1],b.length>2?b[2]+90:90]):(b=y(),[b[0],b[1],b[2]-90])},y([0,0,90]).scale(159.155)}function ym(l,A,y){y=y||{};var b=y.units||"kilometers",T=y.steps||8;if(!l)throw new Error("geojson is required");if(typeof y!="object")throw new Error("options must be an object");if(typeof T!="number")throw new Error("steps must be an number");if(A===void 0)throw new Error("radius is required");if(T<=0)throw new Error("steps must be greater than 0");var P=[];switch(l.type){case"GeometryCollection":return geomEach(l,function(R){var U=ch(R,A,b,T);U&&P.push(U)}),featureCollection(P);case"FeatureCollection":return featureEach(l,function(R){var U=ch(R,A,b,T);U&&featureEach(U,function(H){H&&P.push(H)})}),featureCollection(P)}return ch(l,A,b,T)}function ch(l,A,y,b){var T=l.properties||{},P=l.type==="Feature"?l.geometry:l;if(P.type==="GeometryCollection"){var R=[];return geomEach(l,function(at){var Nt=ch(at,A,y,b);Nt&&R.push(Nt)}),featureCollection(R)}var U=e0(P),H={type:P.type,coordinates:xd(P.coordinates,U)},N=new GeoJSONReader,Q=N.read(H),K=radiansToLength(lengthToRadians(A,y),"meters"),ae=BufferOp.bufferOp(Q,K,b),ge=new GeoJSONWriter;if(ae=ge.write(ae),!_d(ae.coordinates)){var pt={type:ae.type,coordinates:Ed(ae.coordinates,U)};return feature(pt,T)}}function _d(l){return Array.isArray(l[0])?_d(l[0]):isNaN(l[0])}function xd(l,A){return typeof l[0]!="object"?A(l):l.map(function(y){return xd(y,A)})}function Ed(l,A){return typeof l[0]!="object"?A.invert(l):l.map(function(y){return Ed(y,A)})}function e0(l){var A=center(l).geometry.coordinates,y=[-A[0],-A[1]];return geoAzimuthalEquidistant().rotate(y).scale(earthRadius)}var bd=null,op=C(51287);function Sd(l,A,y){y===void 0&&(y={});var b=getGeom(l),T=getGeom(A),P=polygonClipping.intersection(b.coordinates,T.coordinates);return P.length===0?null:P.length===1?polygon(P[0],y.properties):multiPolygon(P,y.properties)}function Xh(l,A){if(A=A||{},!isObject(A))throw new Error("options is invalid");var y=A.propertyName;collectionOf(l,"Polygon","dissolve");var b=[];if(A.propertyName){var T={};featureEach(l,function(H){Object.prototype.hasOwnProperty.call(T,H.properties[y])||(T[H.properties[y]]=[]),T[H.properties[y]].push(H)});for(var P=Object.keys(T),R=0;R<P.length;R++){var U=multiPolygon(polygonClipping.union.apply(null,T[P[R]].map(function(H){return H.geometry.coordinates})));U.properties[y]=P[R],b.push(U)}}else return flatten(multiPolygon(polygonClipping.union.apply(null,l.features.map(function(H){return H.geometry.coordinates}))));return flatten(featureCollection(b))}var Cd=null;function wd(l,A,y){y===void 0&&(y={});var b=JSON.stringify(y.properties||{}),T=l[0],P=l[1],R=l[2],U=l[3],H=(P+U)/2,N=(T+R)/2,Q=A*2/distance([T,H],[R,H],y),K=Q*(R-T),ae=A*2/distance([N,P],[N,U],y),ge=ae*(U-P),pt=K/2,at=pt*2,Nt=Math.sqrt(3)/2*ge,dt=R-T,Ke=U-P,ht=3/4*at,Ht=Nt,Bt=(dt-at)/(at-pt/2),ir=Math.floor(Bt),Kt=(ir*ht-pt/2-dt)/2-pt/2+ht/2,fr=Math.floor((Ke-Nt)/Nt),Ct=(Ke-fr*Nt)/2,si=fr*Nt-Ke>Nt/2;si&&(Ct-=Nt/4);for(var bn=[],Ei=[],$i=0;$i<6;$i++){var on=2*Math.PI/6*$i;bn.push(Math.cos(on)),Ei.push(Math.sin(on))}for(var ai=[],kn=0;kn<=ir;kn++)for(var La=0;La<=fr;La++){var Sa=kn%2===1;if(!(La===0&&Sa)&&!(La===0&&si)){var Ji=kn*ht+T-Kt,mu=La*Ht+P+Ct;if(Sa&&(mu-=Nt/2),y.triangles===!0)sp([Ji,mu],K/2,ge/2,JSON.parse(b),bn,Ei).forEach(function(su){y.mask?intersect(y.mask,su)&&ai.push(su):ai.push(su)});else{var ys=fh([Ji,mu],K/2,ge/2,JSON.parse(b),bn,Ei);y.mask?intersect(y.mask,ys)&&ai.push(ys):ai.push(ys)}}}return featureCollection(ai)}function fh(l,A,y,b,T,P){for(var R=[],U=0;U<6;U++){var H=l[0]+A*T[U],N=l[1]+y*P[U];R.push([H,N])}return R.push(R[0].slice()),polygon([R],b)}function sp(l,A,y,b,T,P){for(var R=[],U=0;U<6;U++){var H=[];H.push(l),H.push([l[0]+A*T[U],l[1]+y*P[U]]),H.push([l[0]+A*T[(U+1)%6],l[1]+y*P[(U+1)%6]]),H.push(l),R.push(polygon([H],b))}return R}var Qh=null;function up(l,A){var y=lp(A),b=null;return l.type==="FeatureCollection"?b=Gc(l):b=qh(polygonClipping.union(l.geometry.coordinates)),b.geometry.coordinates.forEach(function(T){y.geometry.coordinates.push(T[0])}),y}function Gc(l){var A=l.features.length===2?polygonClipping.union(l.features[0].geometry.coordinates,l.features[1].geometry.coordinates):polygonClipping.union.apply(polygonClipping,l.features.map(function(y){return y.geometry.coordinates}));return qh(A)}function qh(l){return multiPolygon(l)}function lp(l){var A=[[[180,90],[-180,90],[-180,-90],[180,-90],[180,90]]],y=l&&l.geometry.coordinates||A;return polygon(y)}var _m=null;function Lx(l,A,y,b){b===void 0&&(b={});for(var T=[],P=l[0],R=l[1],U=l[2],H=l[3],N=A/distance([P,R],[U,R],b),Q=N*(U-P),K=y/distance([P,R],[P,H],b),ae=K*(H-R),ge=U-P,pt=H-R,at=Math.floor(ge/Q),Nt=Math.floor(pt/ae),dt=(ge-at*Q)/2,Ke=(pt-Nt*ae)/2,ht=P+dt,Ht=0;Ht<at;Ht++){for(var Bt=R+Ke,ir=0;ir<Nt;ir++){var Kt=polygon([[[ht,Bt],[ht,Bt+ae],[ht+Q,Bt+ae],[ht+Q,Bt],[ht,Bt]]],b.properties);b.mask?intersect(b.mask,Kt)&&T.push(Kt):T.push(Kt),Bt+=ae}ht+=Q}return featureCollection(T)}var Td=null;function $v(l,A,y){return y===void 0&&(y={}),rectangleGrid(l,A,A,y)}function Ox(l,A,y){y===void 0&&(y={});for(var b=[],T=A/distance([l[0],l[1]],[l[2],l[1]],y),P=T*(l[2]-l[0]),R=A/distance([l[0],l[1]],[l[0],l[3]],y),U=R*(l[3]-l[1]),H=0,N=l[0];N<=l[2];){for(var Q=0,K=l[1];K<=l[3];){var ae=null,ge=null;H%2===0&&Q%2===0?(ae=polygon([[[N,K],[N,K+U],[N+P,K],[N,K]]],y.properties),ge=polygon([[[N,K+U],[N+P,K+U],[N+P,K],[N,K+U]]],y.properties)):H%2===0&&Q%2===1?(ae=polygon([[[N,K],[N+P,K+U],[N+P,K],[N,K]]],y.properties),ge=polygon([[[N,K],[N,K+U],[N+P,K+U],[N,K]]],y.properties)):Q%2===0&&H%2===1?(ae=polygon([[[N,K],[N,K+U],[N+P,K+U],[N,K]]],y.properties),ge=polygon([[[N,K],[N+P,K+U],[N+P,K],[N,K]]],y.properties)):Q%2===1&&H%2===1&&(ae=polygon([[[N,K],[N,K+U],[N+P,K],[N,K]]],y.properties),ge=polygon([[[N,K+U],[N+P,K+U],[N+P,K],[N,K+U]]],y.properties)),y.mask?(intersect(y.mask,ae)&&b.push(ae),intersect(y.mask,ge)&&b.push(ge)):(b.push(ae),b.push(ge)),K+=U,Q++}H++,N+=P}return featureCollection(b)}var Yv=null;function xm(l,A,y){if(y=y||{},typeof y!="object")throw new Error("options is invalid");var b=y.gridType,T=y.property,P=y.weight;if(!l)throw new Error("points is required");if(collectionOf(l,"Point","input must contain Points"),!A)throw new Error("cellSize is required");if(P!==void 0&&typeof P!="number")throw new Error("weight must be a number");T=T||"elevation",b=b||"square",P=P||1;var R=bbox(l),U;switch(b){case"point":case"points":U=pointGrid(R,A,y);break;case"square":case"squares":U=squareGrid(R,A,y);break;case"hex":case"hexes":U=hexGrid(R,A,y);break;case"triangle":case"triangles":U=triangleGrid(R,A,y);break;default:throw new Error("invalid gridType")}var H=[];return featureEach(U,function(N){var Q=0,K=0;featureEach(l,function(ge){var pt=b==="point"?N:centroid(N),at=distance(pt,ge,y),Nt;if(T!==void 0&&(Nt=ge.properties[T]),Nt===void 0&&(Nt=ge.geometry.coordinates[2]),Nt===void 0)throw new Error("zValue is missing");at===0&&(Q=Nt);var dt=1/Math.pow(at,P);K+=dt,Q+=dt*Nt});var ae=clone(N);ae.properties[T]=Q/K,H.push(ae)}),featureCollection(H)}var Em=null},51287:function(le,$,C){"use strict";var L=C(32676),k=C(36987),G=C(1449);function Z(F,z,q){q===void 0&&(q={});var ee=(0,k.wA)(F),fe=(0,k.wA)(z),Se=L.union(ee.coordinates,fe.coordinates);return Se.length===0?null:Se.length===1?(0,G.yu)(Se[0],q.properties):(0,G.tw)(Se,q.properties)}$.Z=Z},9950:function(le,$,C){"use strict";C.d($,{Z:function(){return fe}});function L(Se,Re){for(var De,Ve=-1,nt=Se.length;++Ve<nt;){var Ee=Re(Se[Ve]);Ee!==void 0&&(De=De===void 0?Ee:De+Ee)}return De}var k=L,G=0/0;function Z(Se,Re){var De=Se==null?0:Se.length;return De?k(Se,Re)/De:G}var F=Z;function z(Se){return Se}var q=z;function ee(Se){return F(Se,q)}var fe=ee}}]);
