!(function(){var H_=(ae,j,C)=>new Promise((I,D)=>{var G=Z=>{try{B(C.next(Z))}catch(X){D(X)}},U=Z=>{try{B(C.throw(Z))}catch(X){D(X)}},B=Z=>Z.done?I(Z.value):Promise.resolve(Z.value).then(G,U);B((C=C.apply(ae,j)).next())});(self.webpackChunkcruise_car_map=self.webpackChunkcruise_car_map||[]).push([[395],{95906:function(ae){"use strict";(function(j,C){ae.exports=C()})(this,function(){function j(q){var ie=[];return q.AMapUI&&ie.push(C(q.AMapUI)),q.Loca&&ie.push(I(q.Loca)),Promise.all(ie)}function C(q){return new Promise(function(ie,he){var Ce=[];if(q.plugins)for(var be=0;be<q.plugins.length;be+=1)G.AMapUI.plugins.indexOf(q.plugins[be])==-1&&Ce.push(q.plugins[be]);if(U.AMapUI===D.failed)he("\u524D\u6B21\u8BF7\u6C42 AMapUI \u5931\u8D25");else if(U.AMapUI===D.notload){U.AMapUI=D.loading,G.AMapUI.version=q.version||G.AMapUI.version,be=G.AMapUI.version;var Ze=document.body||document.head,qe=document.createElement("script");qe.type="text/javascript",qe.src="https://webapi.amap.com/ui/"+be+"/main.js",qe.onerror=function(De){U.AMapUI=D.failed,he("\u8BF7\u6C42 AMapUI \u5931\u8D25")},qe.onload=function(){if(U.AMapUI=D.loaded,Ce.length)window.AMapUI.loadUI(Ce,function(){for(var De=0,Ge=Ce.length;De<Ge;De++){var Re=Ce[De].split("/").slice(-1)[0];window.AMapUI[Re]=arguments[De]}for(ie();B.AMapUI.length;)B.AMapUI.splice(0,1)[0]()});else for(ie();B.AMapUI.length;)B.AMapUI.splice(0,1)[0]()},Ze.appendChild(qe)}else U.AMapUI===D.loaded?q.version&&q.version!==G.AMapUI.version?he("\u4E0D\u5141\u8BB8\u591A\u4E2A\u7248\u672C AMapUI \u6DF7\u7528"):Ce.length?window.AMapUI.loadUI(Ce,function(){for(var De=0,Ge=Ce.length;De<Ge;De++){var Re=Ce[De].split("/").slice(-1)[0];window.AMapUI[Re]=arguments[De]}ie()}):ie():q.version&&q.version!==G.AMapUI.version?he("\u4E0D\u5141\u8BB8\u591A\u4E2A\u7248\u672C AMapUI \u6DF7\u7528"):B.AMapUI.push(function(De){De?he(De):Ce.length?window.AMapUI.loadUI(Ce,function(){for(var Ge=0,Re=Ce.length;Ge<Re;Ge++){var Me=Ce[Ge].split("/").slice(-1)[0];window.AMapUI[Me]=arguments[Ge]}ie()}):ie()})})}function I(q){return new Promise(function(ie,he){if(U.Loca===D.failed)he("\u524D\u6B21\u8BF7\u6C42 Loca \u5931\u8D25");else if(U.Loca===D.notload){U.Loca=D.loading,G.Loca.version=q.version||G.Loca.version;var Ce=G.Loca.version,be=G.AMap.version.startsWith("2"),Ze=Ce.startsWith("2");if(be&&!Ze||!be&&Ze)he("JSAPI \u4E0E Loca \u7248\u672C\u4E0D\u5BF9\u5E94\uFF01\uFF01");else{be=G.key,Ze=document.body||document.head;var qe=document.createElement("script");qe.type="text/javascript",qe.src="https://webapi.amap.com/loca?v="+Ce+"&key="+be,qe.onerror=function(De){U.Loca=D.failed,he("\u8BF7\u6C42 AMapUI \u5931\u8D25")},qe.onload=function(){for(U.Loca=D.loaded,ie();B.Loca.length;)B.Loca.splice(0,1)[0]()},Ze.appendChild(qe)}}else U.Loca===D.loaded?q.version&&q.version!==G.Loca.version?he("\u4E0D\u5141\u8BB8\u591A\u4E2A\u7248\u672C Loca \u6DF7\u7528"):ie():q.version&&q.version!==G.Loca.version?he("\u4E0D\u5141\u8BB8\u591A\u4E2A\u7248\u672C Loca \u6DF7\u7528"):B.Loca.push(function(De){De?he(De):he()})})}if(!window)throw Error("AMap JSAPI can only be used in Browser.");var D;(function(q){q.notload="notload",q.loading="loading",q.loaded="loaded",q.failed="failed"})(D||(D={}));var G={key:"",AMap:{version:"1.4.15",plugins:[]},AMapUI:{version:"1.1",plugins:[]},Loca:{version:"1.3.2"}},U={AMap:D.notload,AMapUI:D.notload,Loca:D.notload},B={AMap:[],AMapUI:[],Loca:[]},Z=[],X=function(q){typeof q=="function"&&(U.AMap===D.loaded?q(window.AMap):Z.push(q))};return{load:function(q){return new Promise(function(ie,he){if(U.AMap==D.failed)he("");else if(U.AMap==D.notload){var Ce=q.key,be=q.version,Ze=q.plugins;Ce?(window.AMap&&location.host!=="lbs.amap.com"&&he("\u7981\u6B62\u591A\u79CDAPI\u52A0\u8F7D\u65B9\u5F0F\u6DF7\u7528"),G.key=Ce,G.AMap.version=be||G.AMap.version,G.AMap.plugins=Ze||G.AMap.plugins,U.AMap=D.loading,be=document.body||document.head,window.___onAPILoaded=function(De){if(delete window.___onAPILoaded,De)U.AMap=D.failed,he(De);else for(U.AMap=D.loaded,j(q).then(function(){ie(window.AMap)}).catch(he);Z.length;)Z.splice(0,1)[0]()},Ze=document.createElement("script"),Ze.type="text/javascript",Ze.src="https://webapi.amap.com/maps?callback=___onAPILoaded&v="+G.AMap.version+"&key="+Ce+"&plugin="+G.AMap.plugins.join(","),Ze.onerror=function(De){U.AMap=D.failed,he(De)},be.appendChild(Ze)):he("\u8BF7\u586B\u5199key")}else if(U.AMap==D.loaded)if(q.key&&q.key!==G.key)he("\u591A\u4E2A\u4E0D\u4E00\u81F4\u7684 key");else if(q.version&&q.version!==G.AMap.version)he("\u4E0D\u5141\u8BB8\u591A\u4E2A\u7248\u672C JSAPI \u6DF7\u7528");else{if(Ce=[],q.plugins)for(be=0;be<q.plugins.length;be+=1)G.AMap.plugins.indexOf(q.plugins[be])==-1&&Ce.push(q.plugins[be]);Ce.length?window.AMap.plugin(Ce,function(){j(q).then(function(){ie(window.AMap)}).catch(he)}):j(q).then(function(){ie(window.AMap)}).catch(he)}else if(q.key&&q.key!==G.key)he("\u591A\u4E2A\u4E0D\u4E00\u81F4\u7684 key");else if(q.version&&q.version!==G.AMap.version)he("\u4E0D\u5141\u8BB8\u591A\u4E2A\u7248\u672C JSAPI \u6DF7\u7528");else{var qe=[];if(q.plugins)for(be=0;be<q.plugins.length;be+=1)G.AMap.plugins.indexOf(q.plugins[be])==-1&&qe.push(q.plugins[be]);X(function(){qe.length?window.AMap.plugin(qe,function(){j(q).then(function(){ie(window.AMap)}).catch(he)}):j(q).then(function(){ie(window.AMap)}).catch(he)})}})},reset:function(){delete window.AMap,delete window.AMapUI,delete window.Loca,G={key:"",AMap:{version:"1.4.15",plugins:[]},AMapUI:{version:"1.1",plugins:[]},Loca:{version:"1.3.2"}},U={AMap:D.notload,AMapUI:D.notload,Loca:D.notload},B={AMap:[],AMapUI:[],Loca:[]}}}})},73503:function(){window._iconfont_svg_string_3580659='<svg><symbol id="l7-icon-area1" viewBox="0 0 1024 1024"><path d="M796.444444 56.888889a113.777778 113.777778 0 0 1 43.064889 219.136l38.798223 466.261333a113.777778 113.777778 0 1 1-133.518223 145.237334H279.210667a113.777778 113.777778 0 1 1-60.302223-137.272889L697.856 227.555556A113.777778 113.777778 0 0 1 796.444444 56.888889z m56.888889 750.933333a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222z m-682.666666 0a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222z m577.592889-534.072889L269.198222 796.444444c4.152889 7.168 7.509333 14.791111 10.012445 22.812445h465.578666a114.119111 114.119111 0 0 1 65.479111-71.224889l-38.798222-466.261333a112.924444 112.924444 0 0 1-23.210666-7.964445zM796.444444 125.155556a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222z"  ></path></symbol><symbol id="l7-icon-area" viewBox="0 0 1024 1024"><path d="M796.444444 56.888889a113.777778 113.777778 0 0 1 43.008 219.136l38.855112 466.261333a113.777778 113.777778 0 0 1-16.497778 224.540445L853.333333 967.111111a113.777778 113.777778 0 0 1-108.544-79.644444H279.210667a113.834667 113.834667 0 0 1-100.067556 79.36L170.666667 967.111111a113.777778 113.777778 0 0 1-17.066667-226.304l30.492444-351.175111a113.777778 113.777778 0 0 1 34.986667-218.680889L227.555556 170.666667a113.777778 113.777778 0 0 1 99.896888 59.221333l355.84-71.395556a113.777778 113.777778 0 0 1 104.675556-101.262222L796.444444 56.888889z m56.888889 750.933333a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222z m-682.666666 0a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222z m526.051555-582.314666L340.650667 296.903111a113.891556 113.891556 0 0 1-88.462223 98.645333l-30.947555 355.84c27.477333 13.653333 48.64 38.115556 58.026667 67.754667h465.521777a114.119111 114.119111 0 0 1 65.536-71.168l-38.855111-466.261333a113.948444 113.948444 0 0 1-74.752-56.206222zM227.555556 238.933333a45.511111 45.511111 0 1 0 0 91.022223 45.511111 45.511111 0 0 0 0-91.022223z m568.888888-113.777777a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222z"  ></path></symbol><symbol id="l7-icon-delete" viewBox="0 0 1024 1024"><path d="M705.422222 85.333333a34.133333 34.133333 0 0 1 34.133334 34.133334V227.555556h136.533333a34.133333 34.133333 0 0 1 0 68.266666h-25.543111l-24.348445 610.076445a34.133333 34.133333 0 0 1-34.133333 32.768H231.936a34.133333 34.133333 0 0 1-34.076444-32.768L173.340444 295.822222H147.911111a34.133333 34.133333 0 1 1 0-68.266666H284.444444V119.466667a34.133333 34.133333 0 0 1 34.133334-34.133334h386.844444zM241.720889 295.822222l22.983111 574.577778h494.535111l23.04-574.577778H241.720889zM671.288889 153.6H352.711111V227.555556h318.577778V153.6z"  ></path></symbol><symbol id="l7-icon-color" viewBox="0 0 1024 1024"><path d="M512 56.888889c9.841778 0 19.626667 0.341333 29.354667 0.910222 69.176889 4.437333 119.068444 62.577778 124.302222 131.072l0.455111 9.386667c0.739556 44.600889 15.303111 84.935111 44.999111 114.631111 27.022222 27.022222 62.805333 41.528889 102.570667 44.430222l12.060444 0.568889c72.476444 1.194667 135.793778 52.451556 140.458667 124.757333 1.137778 18.261333 1.251556 36.807111 0.170667 55.637334-13.198222 233.585778-211.399111 424.220444-445.326223 428.714666L512 967.111111a455.111111 455.111111 0 0 1-455.054222-464.156444c4.551111-233.927111 195.185778-432.128 428.771555-445.326223C494.535111 57.116444 503.296 56.888889 512 56.888889z m0 68.266667a385.706667 385.706667 0 0 0-22.414222 0.625777C291.726222 136.988444 129.080889 305.948444 125.155556 504.263111c-4.152889 212.366222 163.100444 387.185778 372.508444 394.353778l13.425778 0.227555 8.533333-0.113777c198.371556-3.811556 367.331556-166.456889 378.538667-364.373334a396.174222 396.174222 0 0 0-0.170667-47.331555c-1.991111-31.232-29.127111-56.604444-67.128889-60.472889l-8.248889-0.455111-14.051555-0.682667c-56.547556-4.209778-107.406222-25.884444-145.806222-64.284444-38.855111-38.798222-60.416-90.225778-64.284445-145.749334l-0.910222-21.333333c-2.901333-38.001778-28.785778-66.048-60.302222-68.096A433.891556 433.891556 0 0 0 512 125.155556zM438.044444 682.666667a68.266667 68.266667 0 1 1 0 136.533333 68.266667 68.266667 0 0 1 0-136.533333z m-170.666666-227.555556a68.266667 68.266667 0 1 1 0 136.533333 68.266667 68.266667 0 0 1 0-136.533333z m142.222222-227.555555a68.266667 68.266667 0 1 1 0 136.533333 68.266667 68.266667 0 0 1 0-136.533333z"  ></path></symbol><symbol id="l7-icon-base-map" viewBox="0 0 1024 1024"><path d="M923.761778 115.029333A34.133333 34.133333 0 0 1 967.111111 147.911111v624.128a34.133333 34.133333 0 0 1-22.186667 32.028445l-278.755555 103.992888a34.133333 34.133333 0 0 1-23.665778 0.056889L381.724444 812.714667a34.133333 34.133333 0 0 0-23.665777 0.113777L102.968889 908.060444a34.133333 34.133333 0 0 1-45.738667-26.965333L56.888889 876.088889V251.960889a34.133333 34.133333 0 0 1 22.186667-32.028445l278.755555-103.992888a34.133333 34.133333 0 0 1 20.992-0.967112l266.183111 72.988445a34.133333 34.133333 0 0 0 18.204445 0zM403.911111 192.625778v555.576889l216.177778 79.075555V251.960889l-216.177778-59.335111z m-68.266667 4.380444L125.155556 275.569778v551.310222l210.432-78.506667V197.006222zM898.844444 192.853333l-210.545777 58.936889v575.089778l210.545777-78.563556V192.853333z"  ></path></symbol><symbol id="l7-icon-dot" viewBox="0 0 1024 1024"><path d="M341.333333 739.555556a113.777778 113.777778 0 0 1 8.533334 227.271111L341.333333 967.111111a113.777778 113.777778 0 0 1-8.533333-227.271111L341.333333 739.555556z m0 68.266666a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222zM910.222222 341.333333a113.777778 113.777778 0 0 1 8.533334 227.271111L910.222222 568.888889a113.777778 113.777778 0 0 1-8.533333-227.271111L910.222222 341.333333z m0 68.266667a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222zM227.555556 56.888889a113.777778 113.777778 0 0 1 8.533333 227.271111L227.555556 284.444444a113.777778 113.777778 0 0 1-8.533334-227.271111L227.555556 56.888889z m0 68.266667a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222z"  ></path></symbol><symbol id="l7-icon-display" viewBox="0 0 1024 1024"><path d="M512 170.666667c284.444444 0 455.111111 227.555556 455.111111 341.333333s-170.666667 341.333333-455.111111 341.333333-455.111111-227.555556-455.111111-341.333333 170.666667-341.333333 455.111111-341.333333z m0 68.266666C303.729778 238.933333 125.155556 401.237333 125.155556 512c0 110.762667 178.574222 273.066667 386.844444 273.066667s386.844444-162.304 386.844444-273.066667c0-110.762667-178.574222-273.066667-386.844444-273.066667zM512 341.333333a170.666667 170.666667 0 1 1 0 341.333334 170.666667 170.666667 0 0 1 0-341.333334z m0 68.266667a102.4 102.4 0 1 0 0 204.8 102.4 102.4 0 0 0 0-204.8z"  ></path></symbol><symbol id="l7-icon-enlarge" viewBox="0 0 1024 1024"><path d="M546.133333 147.911111l-0.056889 329.955556H876.088889a34.133333 34.133333 0 0 1 0 68.266666H546.076444v329.955556a34.133333 34.133333 0 0 1-68.266666 0V546.133333H147.911111a34.133333 34.133333 0 1 1 0-68.266666h329.898667V147.911111a34.133333 34.133333 0 0 1 68.266666 0z"  ></path></symbol><symbol id="l7-icon-export-picture" viewBox="0 0 1024 1024"><path d="M883.873684 161.684211a32.336842 32.336842 0 0 1 32.336842 32.336842v582.063158a32.336842 32.336842 0 0 1-32.336842 32.336842H86.231579a32.336842 32.336842 0 0 1-32.336842-32.336842V194.021053a32.336842 32.336842 0 0 1 32.336842-32.336842h797.642105z m-32.336842 64.673684H118.568421v517.389473h170.792421a32.175158 32.175158 0 0 1 0.431158-0.646736l3.772632-4.473264 330.320842-330.374736a32.336842 32.336842 0 0 1 38.588631-5.389474l4.473263 3.018105 184.589474 147.725474V226.357895z m-202.428631 248.131368L379.850105 743.747368H851.536842v-107.304421l-202.428631-161.953684zM323.368421 323.368421a107.789474 107.789474 0 1 1 0 215.578947 107.789474 107.789474 0 0 1 0-215.578947z m0 64.673684a43.115789 43.115789 0 1 0 0 86.231579 43.115789 43.115789 0 0 0 0-86.231579z"  ></path></symbol><symbol id="l7-icon-exit-fullscreen" viewBox="0 0 1024 1024"><path d="M841.955556 591.644444a34.133333 34.133333 0 0 1 5.518222 67.811556l-5.518222 0.455111h-133.745778l192 192.056889a34.133333 34.133333 0 0 1-38.343111 55.182222l-5.176889-2.958222-4.721778-3.982222L659.911111 708.266667V841.955556a34.133333 34.133333 0 0 1-28.615111 33.678222L625.777778 876.088889a34.133333 34.133333 0 0 1-33.678222-28.615111L591.644444 841.955556V625.777778a34.133333 34.133333 0 0 1 28.615112-33.678222L625.777778 591.644444h216.177778z m-443.733334 0a34.133333 34.133333 0 0 1 33.678222 28.615112L432.355556 625.777778v216.177778a34.133333 34.133333 0 0 1-67.811556 5.518222L364.088889 841.955556v-133.745778l-192.056889 192a34.133333 34.133333 0 0 1-52.224-43.52l3.982222-4.721778L315.847111 659.911111H182.044444a34.133333 34.133333 0 0 1-33.678222-28.615111L147.911111 625.777778a34.133333 34.133333 0 0 1 28.615111-33.678222L182.044444 591.644444H398.222222zM167.310222 119.808l4.721778 3.982222L364.088889 315.847111V182.044444a34.133333 34.133333 0 0 1 28.615111-33.678222L398.222222 147.911111a34.133333 34.133333 0 0 1 33.678222 28.615111L432.355556 182.044444V398.222222a34.133333 34.133333 0 0 1-28.615112 33.678222L398.222222 432.355556H182.044444a34.133333 34.133333 0 0 1-5.518222-67.811556L182.044444 364.088889h133.802667L123.790222 172.032a34.133333 34.133333 0 0 1 43.52-52.224z m732.899556 3.982222a34.133333 34.133333 0 0 1 3.982222 43.52l-3.982222 4.721778L708.266667 364.088889H841.955556a34.133333 34.133333 0 0 1 33.678222 28.615111L876.088889 398.222222a34.133333 34.133333 0 0 1-28.615111 33.678222L841.955556 432.355556H625.777778a34.133333 34.133333 0 0 1-33.678222-28.615112L591.644444 398.222222V182.044444a34.133333 34.133333 0 0 1 67.811556-5.518222l0.455111 5.518222v133.802667l192.056889-192.056889a34.133333 34.133333 0 0 1 48.241778 0z"  ></path></symbol><symbol id="l7-icon-line" viewBox="0 0 1024 1024"><path d="M853.333333 56.888889a113.777778 113.777778 0 0 1 8.533334 227.271111L853.333333 284.444444c-19.000889 0-36.864-4.664889-52.622222-12.856888l-529.123555 529.066666a113.777778 113.777778 0 0 1-92.387556 166.115556L170.666667 967.111111a113.777778 113.777778 0 0 1-8.533334-227.271111L170.666667 739.555556c19.000889 0 36.864 4.664889 52.622222 12.856888l529.123555-529.066666a113.777778 113.777778 0 0 1 92.387556-166.115556L853.333333 56.888889zM170.666667 807.822222a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222z m682.666666-682.666666a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222z"  ></path></symbol><symbol id="l7-icon-layer" viewBox="0 0 1024 1024"><path d="M767.089778 625.777778l180.167111 82.773333a34.133333 34.133333 0 0 1 4.892444 59.278222l-4.892444 2.730667-420.977778 193.422222a34.133333 34.133333 0 0 1-22.983111 1.991111l-5.575111-1.991111-420.977778-193.422222a34.133333 34.133333 0 0 1-4.892444-59.278222l4.892444-2.730667L256.853333 625.777778l81.749334 37.546666L172.771556 739.555556 512 895.374222 851.171556 739.555556l-165.831112-76.231112 81.749334-37.546666z m0-227.555556l180.167111 82.773334a34.133333 34.133333 0 0 1 4.892444 59.278222l-4.892444 2.730666-420.977778 193.422223a34.133333 34.133333 0 0 1-22.983111 1.991111l-5.575111-1.991111-420.977778-193.422223a34.133333 34.133333 0 0 1-4.892444-59.278222l4.892444-2.730666L256.853333 398.222222l81.749334 37.546667-165.831111 76.174222L512 667.818667l339.171556-155.875556-165.831112-76.174222L767.089778 398.222222zM497.720889 60.017778a34.133333 34.133333 0 0 1 28.558222 0l420.977778 193.422222a34.133333 34.133333 0 0 1 0 62.008889l-420.977778 193.422222a34.133333 34.133333 0 0 1-28.558222 0l-420.977778-193.422222a34.133333 34.133333 0 0 1 0-62.008889zM512 128.568889L172.771556 284.387556 512 440.263111l339.171556-155.875555L512 128.568889z"  ></path></symbol><symbol id="l7-icon-narrow" viewBox="0 0 1024 1024"><path d="M910.222222 512a34.133333 34.133333 0 0 1-34.133333 34.133333H147.911111a34.133333 34.133333 0 1 1 0-68.266666h728.177778a34.133333 34.133333 0 0 1 34.133333 34.133333z"  ></path></symbol><symbol id="l7-icon-fullscreen" viewBox="0 0 1024 1024"><path d="M645.176889 597.674667l4.721778 3.982222L841.955556 793.6l0.056888-133.688889a34.133333 34.133333 0 0 1 28.615112-33.678222L876.088889 625.777778a34.133333 34.133333 0 0 1 33.678222 28.615111L910.222222 659.911111v216.177778a34.133333 34.133333 0 0 1-28.615111 33.678222L876.088889 910.222222h-216.177778a34.133333 34.133333 0 0 1-5.518222-67.811555l5.518222-0.455111h133.745778l-192-192.056889a34.133333 34.133333 0 0 1 43.52-52.224z m-222.833778 3.982222a34.133333 34.133333 0 0 1 3.982222 43.52l-3.982222 4.721778L230.286222 841.955556H364.088889a34.133333 34.133333 0 0 1 33.678222 28.615111L398.222222 876.088889a34.133333 34.133333 0 0 1-28.615111 33.678222L364.088889 910.222222H147.911111a34.133333 34.133333 0 0 1-33.678222-28.615111L113.777778 876.088889v-216.177778a34.133333 34.133333 0 0 1 67.811555-5.518222l0.455111 5.518222-0.056888 133.745778 192.113777-192a34.133333 34.133333 0 0 1 48.241778 0zM364.088889 113.777778a34.133333 34.133333 0 0 1 5.518222 67.811555L364.088889 182.044444H230.343111l192 192.056889a34.133333 34.133333 0 0 1-43.52 52.224l-4.721778-3.982222-192.113777-192.056889L182.044444 364.088889a34.133333 34.133333 0 0 1-28.615111 33.678222L147.911111 398.222222a34.133333 34.133333 0 0 1-33.678222-28.615111L113.777778 364.088889V147.911111a34.133333 34.133333 0 0 1 28.615111-33.678222L147.911111 113.777778h216.177778z m512 0a34.133333 34.133333 0 0 1 33.678222 28.615111L910.222222 147.911111v216.177778a34.133333 34.133333 0 0 1-67.811555 5.518222L841.955556 364.088889l-0.056889-133.745778-192 192a34.133333 34.133333 0 0 1-52.224-43.52l3.982222-4.721778L793.6 182.044444H659.911111a34.133333 34.133333 0 0 1-33.678222-28.615111L625.777778 147.911111a34.133333 34.133333 0 0 1 28.615111-33.678222L659.911111 113.777778h216.177778z"  ></path></symbol><symbol id="l7-icon-hide" viewBox="0 0 1024 1024"><path d="M875.52 87.836444a34.133333 34.133333 0 0 1 7.281778 43.121778l-3.527111 5.006222-682.666667 796.444445a34.133333 34.133333 0 0 1-55.409778-39.367111l3.527111-5.006222 97.166223-113.379556C123.164444 697.969778 56.888889 582.940444 56.888889 512c0-113.777778 170.666667-341.333333 455.111111-341.333333a496.64 496.64 0 0 1 208.952889 45.112889l106.439111-124.188445a34.133333 34.133333 0 0 1 48.128-3.754667z m-38.684444 202.524445C921.031111 362.951111 967.111111 452.835556 967.111111 512c0 113.777778-170.666667 341.333333-455.111111 341.333333-50.631111 0-97.678222-7.224889-140.8-19.740444l50.232889-58.595556A417.393778 417.393778 0 0 0 512 785.066667c208.270222 0 386.844444-162.304 386.844444-273.066667 0-52.849778-40.675556-117.418667-105.813333-170.496l43.804445-51.2zM512 238.933333C303.729778 238.933333 125.155556 401.237333 125.155556 512c0 66.787556 64.853333 152.291556 162.133333 209.692444L377.173333 616.675556a170.666667 170.666667 0 0 1 217.713778-253.895112l78.620445-91.704888A432.924444 432.924444 0 0 0 512 238.933333z m166.684444 236.088889a170.666667 170.666667 0 0 1-177.664 207.303111l177.607112-207.303111zM512 409.6a102.4 102.4 0 0 0-88.746667 153.486222L548.864 416.426667A102.172444 102.172444 0 0 0 512 409.6z"  ></path></symbol><symbol id="l7-icon-rectangle" viewBox="0 0 1024 1024"><path d="M170.666667 56.888889a113.777778 113.777778 0 0 1 108.544 79.644444H853.333333a34.133333 34.133333 0 0 1 33.678223 28.615111L887.466667 170.666667v574.122666a113.777778 113.777778 0 1 1-142.677334 142.734223L170.666667 887.466667a34.133333 34.133333 0 0 1-33.678223-28.615111L136.533333 853.333333V279.210667A113.777778 113.777778 0 0 1 170.666667 56.888889z m682.666666 750.933333a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222z m-34.133333-603.022222H279.210667a114.062222 114.062222 0 0 1-74.353778 74.410667L204.8 819.2h539.989333a114.062222 114.062222 0 0 1 74.410667-74.410667V204.8zM170.666667 125.155556a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222z"  ></path></symbol><symbol id="l7-icon-ranging" viewBox="0 0 1024 1024"><path d="M723.171556 50.403556l250.424888 250.424888a31.061333 31.061333 0 0 1 0 43.918223L344.746667 973.596444a31.061333 31.061333 0 0 1-43.918223 0L50.403556 723.171556a31.061333 31.061333 0 0 1 0-43.918223L679.253333 50.403556a31.061333 31.061333 0 0 1 43.918223 0z m-21.959112 74.524444l-39.765333 39.822222 98.986667 98.872889a34.133333 34.133333 0 0 1-44.088889 51.882667l-4.209778-3.640889-98.929778-98.929778-63.886222 63.886222 62.179556 62.122667a34.133333 34.133333 0 0 1-44.088889 51.882667L563.2 387.242667 501.077333 325.063111 437.191111 388.949333l98.986667 98.929778a34.133333 34.133333 0 0 1-44.088889 51.882667l-4.209778-3.640889-98.929778-98.929778-63.886222 63.886222L387.242667 563.2a34.133333 34.133333 0 0 1-44.088889 51.882667l-4.209778-3.584-62.122667-62.179556-63.886222 63.886222 98.986667 98.929778a34.133333 34.133333 0 0 1-44.088889 51.882667l-4.209778-3.640889-98.929778-98.929778-39.765333 39.822222 197.802667 197.745778 576.284444-576.284444-197.802667-197.745778z"  ></path></symbol><symbol id="l7-icon-reposition" viewBox="0 0 1024 1024"><path d="M512 56.888889a34.133333 34.133333 0 0 1 34.133333 34.133333v24.177778A398.336 398.336 0 0 1 908.856889 477.866667h24.177778a34.133333 34.133333 0 0 1 0 68.266666h-24.177778A398.336 398.336 0 0 1 546.133333 908.856889L546.133333 932.977778a34.133333 34.133333 0 0 1-68.266666 0v-24.177778A398.336 398.336 0 0 1 115.2 546.133333L91.022222 546.133333a34.133333 34.133333 0 1 1 0-68.266666h24.177778A398.336 398.336 0 0 1 477.866667 115.2V91.022222A34.133333 34.133333 0 0 1 512 56.888889z m34.190222 126.862222L546.133333 193.422222a34.133333 34.133333 0 1 1-68.266666 0v-9.671111A330.069333 330.069333 0 0 0 183.751111 477.866667h9.671111a34.133333 34.133333 0 1 1 0 68.266666l-9.671111 0.056889A330.069333 330.069333 0 0 0 477.866667 840.248889V830.577778a34.133333 34.133333 0 0 1 68.266666 0l0.056889 9.671111A330.069333 330.069333 0 0 0 840.248889 546.133333L830.577778 546.133333a34.133333 34.133333 0 0 1 0-68.266666h9.671111A330.069333 330.069333 0 0 0 546.133333 183.751111zM512 341.333333a170.666667 170.666667 0 1 1 0 341.333334 170.666667 170.666667 0 0 1 0-341.333334z m0 68.266667a102.4 102.4 0 1 0 0 204.8 102.4 102.4 0 0 0 0-204.8z"  ></path></symbol><symbol id="l7-icon-round" viewBox="0 0 1024 1024"><path d="M512 56.888889a455.111111 455.111111 0 0 1 391.395556 687.502222 113.777778 113.777778 0 0 1-159.061334 158.890667A455.111111 455.111111 0 0 1 120.604444 279.608889 113.777778 113.777778 0 0 1 279.608889 120.604444 452.835556 452.835556 0 0 1 512 56.888889z m0 68.266667a384.910222 384.910222 0 0 0-191.715556 50.744888A113.777778 113.777778 0 0 1 175.957333 320.284444a386.844444 386.844444 0 0 0 527.815111 527.758223 113.777778 113.777778 0 0 1 144.270223-144.440889A386.844444 386.844444 0 0 0 512 125.155556z m299.406222 640.739555a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222zM212.593778 167.082667a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222z"  ></path></symbol><symbol id="l7-icon-guanbi" viewBox="0 0 1024 1024"><path d="M576 512l277.333333 277.333333-64 64-277.333333-277.333333L234.666667 853.333333 170.666667 789.333333l277.333333-277.333333L170.666667 234.666667 234.666667 170.666667l277.333333 277.333333L789.333333 170.666667 853.333333 234.666667 576 512z"  ></path></symbol></svg>',function(ae){try{let ie=function(){B||(B=!0,G())},he=function(){try{U.documentElement.doScroll("left")}catch(Ce){return void setTimeout(he,50)}ie()};var X=ie,q=he,C=(C=document.getElementsByTagName("script"))[C.length-1],j=C.getAttribute("data-injectcss"),C=C.getAttribute("data-disable-injectsvg");if(!C){var I,D,G,U,B,Z=function(be,Ze){Ze.parentNode.insertBefore(be,Ze)};if(j&&!ae.__iconfont__svg__cssinject__){ae.__iconfont__svg__cssinject__=!0;try{document.write("<style>.svgfont {display: inline-block;width: 1em;height: 1em;fill: currentColor;vertical-align: -0.1em;font-size:16px;}</style>")}catch(Ce){console&&console.log(Ce)}}I=function(){var be,Ze=document.createElement("div");Ze.innerHTML=ae._iconfont_svg_string_3580659,(Ze=Ze.getElementsByTagName("svg")[0])&&(Ze.setAttribute("aria-hidden","true"),Ze.style.position="absolute",Ze.style.width=0,Ze.style.height=0,Ze.style.overflow="hidden",Ze=Ze,(be=document.body).firstChild?Z(Ze,be.firstChild):be.appendChild(Ze))},document.addEventListener?~["complete","loaded","interactive"].indexOf(document.readyState)?setTimeout(I,0):(D=function(){document.removeEventListener("DOMContentLoaded",D,!1),I()},document.addEventListener("DOMContentLoaded",D,!1)):document.attachEvent&&(G=I,U=ae.document,B=!1,he(),U.onreadystatechange=function(){U.readyState=="complete"&&(U.onreadystatechange=null,ie())})}}catch(ie){}}(window)},17701:function(ae,j,C){"use strict";C.d(j,{lg:function(){return v6},Ie:function(){return n_},Jx:function(){return M1},u7:function(){return YC},ns:function(){return og},dW:function(){return a_},xs:function(){return e8}});var I={};C.r(I),C.d(I,{add:function(){return Hp},adjoint:function(){return MA},clone:function(){return ro},copy:function(){return Yi},create:function(){return _i},determinant:function(){return W_},equals:function(){return Bu},exactEquals:function(){return Jd},frob:function(){return DA},fromQuat:function(){return Qg},fromQuat2:function(){return Gp},fromRotation:function(){return uh},fromRotationTranslation:function(){return xf},fromRotationTranslationScale:function(){return Qd},fromRotationTranslationScaleOrigin:function(){return $g},fromScaling:function(){return Xd},fromTranslation:function(){return zp},fromValues:function(){return lo},fromXRotation:function(){return Xh},fromYRotation:function(){return l0},fromZRotation:function(){return Vf},frustum:function(){return nc},getRotation:function(){return $d},getScaling:function(){return Vp},getTranslation:function(){return Yd},identity:function(){return jh},invert:function(){return jd},lookAt:function(){return Qh},mul:function(){return vl},multiply:function(){return $c},multiplyScalar:function(){return Wp},multiplyScalarAndAdd:function(){return Kd},ortho:function(){return IA},orthoNO:function(){return $h},orthoZO:function(){return PA},perspective:function(){return wA},perspectiveFromFieldOfView:function(){return Yh},perspectiveNO:function(){return qd},perspectiveZO:function(){return j_},rotate:function(){return rc},rotateX:function(){return Jo},rotateY:function(){return dl},rotateZ:function(){return Sf},scale:function(){return Do},set:function(){return Ju},str:function(){return NA},sub:function(){return gl},subtract:function(){return LA},targetTo:function(){return OA},translate:function(){return Gf},transpose:function(){return Zp}});var D={};C.r(D),C.d(D,{add:function(){return Bb},angle:function(){return Qm},bezier:function(){return Yb},ceil:function(){return kb},clone:function(){return Db},copy:function(){return Lb},create:function(){return pp},cross:function(){return n2},dist:function(){return sR},distance:function(){return K1},div:function(){return oR},divide:function(){return q1},dot:function(){return r2},equals:function(){return iR},exactEquals:function(){return nR},floor:function(){return Ub},forEach:function(){return fR},fromValues:function(){return rl},hermite:function(){return Xb},inverse:function(){return Wb},len:function(){return lR},length:function(){return Y1},lerp:function(){return jb},max:function(){return zb},min:function(){return Zb},mul:function(){return aR},multiply:function(){return Q1},negate:function(){return t2},normalize:function(){return dp},random:function(){return $b},rotateX:function(){return Kb},rotateY:function(){return Jb},rotateZ:function(){return eR},round:function(){return Gb},scale:function(){return Vb},scaleAndAdd:function(){return Hb},set:function(){return Fb},sqrDist:function(){return uR},sqrLen:function(){return cR},squaredDistance:function(){return J1},squaredLength:function(){return e2},str:function(){return rR},sub:function(){return qm},subtract:function(){return $1},transformMat3:function(){return Qb},transformMat4:function(){return dd},transformQuat:function(){return qb},zero:function(){return tR}});var G={},U={},B=function(t){return U[t]},Z=function(t,r){U[t]=r},X=function(t){return G[t]},q=function(t,r){G[t]=r},ie={},he={},Ce=34,be=10,Ze=13;function qe(e){return new Function("d","return {"+e.map(function(t,r){return JSON.stringify(t)+": d["+r+'] || ""'}).join(",")+"}")}function De(e,t){var r=qe(e);return function(n,i){return t(r(n),i,e)}}function Ge(e){var t=Object.create(null),r=[];return e.forEach(function(n){for(var i in n)i in t||r.push(t[i]=i)}),r}function Re(e,t){var r=e+"",n=r.length;return n<t?new Array(t-n+1).join(0)+r:r}function Me(e){return e<0?"-"+Re(-e,6):e>9999?"+"+Re(e,6):Re(e,4)}function ce(e){var t=e.getUTCHours(),r=e.getUTCMinutes(),n=e.getUTCSeconds(),i=e.getUTCMilliseconds();return isNaN(e)?"Invalid Date":Me(e.getUTCFullYear(),4)+"-"+Re(e.getUTCMonth()+1,2)+"-"+Re(e.getUTCDate(),2)+(i?"T"+Re(t,2)+":"+Re(r,2)+":"+Re(n,2)+"."+Re(i,3)+"Z":n?"T"+Re(t,2)+":"+Re(r,2)+":"+Re(n,2)+"Z":r||t?"T"+Re(t,2)+":"+Re(r,2)+"Z":"")}function Be(e){var t=new RegExp('["'+e+`
\r]`),r=e.charCodeAt(0);function n(R,L){var z,re,ee=i(R,function(me,Ie){if(z)return z(me,Ie-1);re=me,z=L?De(me,L):qe(me)});return ee.columns=re||[],ee}function i(R,L){var z=[],re=R.length,ee=0,me=0,Ie,He=re<=0,Xe=!1;R.charCodeAt(re-1)===be&&--re,R.charCodeAt(re-1)===Ze&&--re;function ot(){if(He)return he;if(Xe)return Xe=!1,ie;var dt,It=ee,Vt;if(R.charCodeAt(It)===Ce){for(;ee++<re&&R.charCodeAt(ee)!==Ce||R.charCodeAt(++ee)===Ce;);return(dt=ee)>=re?He=!0:(Vt=R.charCodeAt(ee++))===be?Xe=!0:Vt===Ze&&(Xe=!0,R.charCodeAt(ee)===be&&++ee),R.slice(It+1,dt-1).replace(/""/g,'"')}for(;ee<re;){if((Vt=R.charCodeAt(dt=ee++))===be)Xe=!0;else if(Vt===Ze)Xe=!0,R.charCodeAt(ee)===be&&++ee;else if(Vt!==r)continue;return R.slice(It,dt)}return He=!0,R.slice(It,re)}for(;(Ie=ot())!==he;){for(var pt=[];Ie!==ie&&Ie!==he;)pt.push(Ie),Ie=ot();L&&(pt=L(pt,me++))==null||z.push(pt)}return z}function a(R,L){return R.map(function(z){return L.map(function(re){return T(z[re])}).join(e)})}function s(R,L){return L==null&&(L=Ge(R)),[L.map(T).join(e)].concat(a(R,L)).join(`
`)}function l(R,L){return L==null&&(L=Ge(R)),a(R,L).join(`
`)}function p(R){return R.map(m).join(`
`)}function m(R){return R.map(T).join(e)}function T(R){return R==null?"":R instanceof Date?ce(R):t.test(R+="")?'"'+R.replace(/"/g,'""')+'"':R}return{parse:n,parseRows:i,format:s,formatBody:l,formatRows:p,formatRow:m,formatValue:T}}var Ee=Be(","),Se=Ee.parse,oe=Ee.parseRows,Y=Ee.format,Ne=Ee.formatBody,ge=Ee.formatRows,xe=Ee.formatRow,ye=Ee.formatValue,Q=C(74710),Pe=C(8014),Ae=C(94169),_e=C(57338),ue=C(74809),ke=C(29161),ze=C(69984),le=C(4014),Ut=C(7953);function kt(e){try{return Function.toString.call(e).indexOf("[native code]")!==-1}catch(t){return typeof e=="function"}}var pr=C(25807);function Wt(e,t,r){return(0,pr.Z)()?Wt=Reflect.construct.bind():Wt=function(i,a,s){var l=[null];l.push.apply(l,a);var p=Function.bind.apply(i,l),m=new p;return s&&(0,Ut.Z)(m,s.prototype),m},Wt.apply(null,arguments)}function Xr(e){var t=typeof Map=="function"?new Map:void 0;return Xr=function(n){if(n===null||!kt(n))return n;if(typeof n!="function")throw new TypeError("Super expression must either be null or a function");if(typeof t!="undefined"){if(t.has(n))return t.get(n);t.set(n,i)}function i(){return Wt(n,arguments,(0,le.Z)(this).constructor)}return i.prototype=Object.create(n.prototype,{constructor:{value:i,enumerable:!1,writable:!0,configurable:!0}}),(0,Ut.Z)(i,n)},Xr(e)}var fn={REGISTERED_PROTOCOLS:{}};function Ir(e){var t=Qr();return function(){var n=(0,le.Z)(e),i;if(t){var a=(0,le.Z)(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return(0,ze.Z)(this,i)}}function Qr(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var tn=function(t){return fn.REGISTERED_PROTOCOLS[t.substring(0,t.indexOf("://"))]},Mr=function(e){(0,ke.Z)(r,e);var t=Ir(r);function r(n,i,a,s){var l;return(0,ue.Z)(this,r),l=t.call(this,"AJAXError: ".concat(i," (").concat(n,"): ").concat(a)),l.status=n,l.statusText=i,l.url=a,l.body=s,l}return(0,_e.Z)(r)}(Xr(Error));function $n(e,t){var r=new XMLHttpRequest,n=Array.isArray(e.url)?e.url[0]:e.url;r.open(e.method||"GET",n,!0),e.type==="arrayBuffer"&&(r.responseType="arraybuffer");for(var i in e.headers)e.headers.hasOwnProperty(i)&&r.setRequestHeader(i,e.headers[i]);return e.type==="json"&&(r.responseType="text",r.setRequestHeader("Accept","application/json")),r.withCredentials=e.credentials==="include",r.onerror=function(){t(new Error(r.statusText))},r.onload=function(){if((r.status>=200&&r.status<300||r.status===0)&&r.response!==null){var a=r.response;if(e.type==="json")try{a=JSON.parse(r.response)}catch(l){return t(l)}t(null,a,r.getResponseHeader("Cache-Control"),r.getResponseHeader("Expires"),r)}else{var s=new Blob([r.response],{type:r.getResponseHeader("Content-Type")});t(new Mr(r.status,r.statusText,n.toString(),s))}},r.cancel=r.abort,r.send(e.body),r}function li(e){return new Promise(function(t,r){$n(e,function(n,i,a,s,l){n?r({err:n,data:null,xhr:l}):t({err:null,data:i,cacheControl:a,expires:s,xhr:l})})})}function Kn(e,t){return $n(e,t)}var $r=function(t,r){var n=tn(t.url)||Kn;return n((0,Q.Z)((0,Q.Z)({},t),{},{type:"json"}),r)},ln=function(t,r){var n=tn(t.url)||Kn;return n((0,Q.Z)((0,Q.Z)({},t),{},{type:"arrayBuffer"}),r)},Cn=function(t,r){return Kn(_objectSpread(_objectSpread({},t),{},{method:"POST"}),r)},$i=function(t,r){return Kn((0,Q.Z)((0,Q.Z)({},t),{},{method:"GET"}),r)};function ci(e){var t=window.document.createElement("a");return t.href=e,t.protocol===window.document.location.protocol&&t.host===window.document.location.host}var Ft="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";function te(e,t){var r=new window.Image,n=window.URL||window.webkitURL;r.crossOrigin="anonymous",r.onload=function(){t(null,r),n.revokeObjectURL(r.src),r.onload=null,window.requestAnimationFrame(function(){r.src=Ft})},r.onerror=function(){return t(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))};var i=new Blob([new Uint8Array(e)],{type:"image/png"});r.src=e.byteLength?n.createObjectURL(i):Ft}function We(e,t){var r=new Blob([new Uint8Array(e)],{type:"image/png"});createImageBitmap(r).then(function(n){t(null,n)}).catch(function(n){t(new Error("Could not load image because of ".concat(n.message,". Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.")))})}var Qe=function(t,r,n){var i=function(s,l){if(s)r(s);else if(l){var p=typeof createImageBitmap=="function",m=n?n(l):l;p?We(m,r):te(m,r)}};return t.type==="json"?$r(t,i):ln(t,i)},vt=function(t,r){var n=typeof createImageBitmap=="function";n?We(t,r):te(t,r)},Lt=function(e){return e.CENTER="center",e.TOP="top",e["TOP-LEFT"]="top-left",e["TOP-RIGHT"]="top-right",e.BOTTOM="bottom",e["BOTTOM-LEFT"]="bottom-left",e["BOTTOM-RIGHT"]="bottom-right",e.LEFT="left",e.RIGHT="right",e}({}),Pt={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function Cr(e,t,r){var n=e.classList;for(var i in Pt)Pt.hasOwnProperty(i)&&n.remove("l7-".concat(r,"-anchor-").concat(i));n.add("l7-".concat(r,"-anchor-").concat(t))}function yt(e,t,r){e.prototype=t.prototype=r,r.constructor=e}function Ot(e,t){var r=Object.create(e.prototype);for(var n in t)r[n]=t[n];return r}function rr(){}var Sr=.7,Lr=1/Sr,on="\\s*([+-]?\\d+)\\s*",hn="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",zr="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",rn=/^#([0-9a-f]{3,8})$/,Wn=new RegExp("^rgb\\("+[on,on,on]+"\\)$"),jn=new RegExp("^rgb\\("+[zr,zr,zr]+"\\)$"),mi=new RegExp("^rgba\\("+[on,on,on,hn]+"\\)$"),Ea=new RegExp("^rgba\\("+[zr,zr,zr,hn]+"\\)$"),ja=new RegExp("^hsl\\("+[hn,zr,zr]+"\\)$"),Wr=new RegExp("^hsla\\("+[hn,zr,zr,hn]+"\\)$"),no={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};yt(rr,Bo,{copy:function(e){return Object.assign(new this.constructor,this,e)},displayable:function(){return this.rgb().displayable()},hex:Xo,formatHex:Xo,formatHsl:Xn,formatRgb:Hs,toString:Hs});function Xo(){return this.rgb().formatHex()}function Xn(){return ta(this).formatHsl()}function Hs(){return this.rgb().formatRgb()}function Bo(e){var t,r;return e=(e+"").trim().toLowerCase(),(t=rn.exec(e))?(r=t[1].length,t=parseInt(t[1],16),r===6?iu(t):r===3?new Ds(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):r===8?ts(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):r===4?ts(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=Wn.exec(e))?new Ds(t[1],t[2],t[3],1):(t=jn.exec(e))?new Ds(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=mi.exec(e))?ts(t[1],t[2],t[3],t[4]):(t=Ea.exec(e))?ts(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=ja.exec(e))?Uu(t[1],t[2]/100,t[3]/100,1):(t=Wr.exec(e))?Uu(t[1],t[2]/100,t[3]/100,t[4]):no.hasOwnProperty(e)?iu(no[e]):e==="transparent"?new Ds(NaN,NaN,NaN,0):null}function iu(e){return new Ds(e>>16&255,e>>8&255,e&255,1)}function ts(e,t,r,n){return n<=0&&(e=t=r=NaN),new Ds(e,t,r,n)}function Vl(e){return e instanceof rr||(e=Bo(e)),e?(e=e.rgb(),new Ds(e.r,e.g,e.b,e.opacity)):new Ds}function ku(e,t,r,n){return arguments.length===1?Vl(e):new Ds(e,t,r,n==null?1:n)}function Ds(e,t,r,n){this.r=+e,this.g=+t,this.b=+r,this.opacity=+n}yt(Ds,ku,Ot(rr,{brighter:function(e){return e=e==null?Lr:Math.pow(Lr,e),new Ds(this.r*e,this.g*e,this.b*e,this.opacity)},darker:function(e){return e=e==null?Sr:Math.pow(Sr,e),new Ds(this.r*e,this.g*e,this.b*e,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:bs,formatHex:bs,formatRgb:Fa,toString:Fa}));function bs(){return"#"+uc(this.r)+uc(this.g)+uc(this.b)}function Fa(){var e=this.opacity;return e=isNaN(e)?1:Math.max(0,Math.min(1,e)),(e===1?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(e===1?")":", "+e+")")}function uc(e){return e=Math.max(0,Math.min(255,Math.round(e)||0)),(e<16?"0":"")+e.toString(16)}function Uu(e,t,r,n){return n<=0?e=t=r=NaN:r<=0||r>=1?e=t=NaN:t<=0&&(e=NaN),new mo(e,t,r,n)}function ta(e){if(e instanceof mo)return new mo(e.h,e.s,e.l,e.opacity);if(e instanceof rr||(e=Bo(e)),!e)return new mo;if(e instanceof mo)return e;e=e.rgb();var t=e.r/255,r=e.g/255,n=e.b/255,i=Math.min(t,r,n),a=Math.max(t,r,n),s=NaN,l=a-i,p=(a+i)/2;return l?(t===a?s=(r-n)/l+(r<n)*6:r===a?s=(n-t)/l+2:s=(t-r)/l+4,l/=p<.5?a+i:2-a-i,s*=60):l=p>0&&p<1?0:s,new mo(s,l,p,e.opacity)}function au(e,t,r,n){return arguments.length===1?ta(e):new mo(e,t,r,n==null?1:n)}function mo(e,t,r,n){this.h=+e,this.s=+t,this.l=+r,this.opacity=+n}yt(mo,au,Ot(rr,{brighter:function(e){return e=e==null?Lr:Math.pow(Lr,e),new mo(this.h,this.s,this.l*e,this.opacity)},darker:function(e){return e=e==null?Sr:Math.pow(Sr,e),new mo(this.h,this.s,this.l*e,this.opacity)},rgb:function(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,r=this.l,n=r+(r<.5?r:1-r)*t,i=2*r-n;return new Ds(Rs(e>=240?e-240:e+120,i,n),Rs(e,i,n),Rs(e<120?e+240:e-120,i,n),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var e=this.opacity;return e=isNaN(e)?1:Math.max(0,Math.min(1,e)),(e===1?"hsl(":"hsla(")+(this.h||0)+", "+(this.s||0)*100+"%, "+(this.l||0)*100+"%"+(e===1?")":", "+e+")")}}));function Rs(e,t,r){return(e<60?t+(r-t)*e/60:e<180?r:e<240?t+(r-t)*(240-e)/60:t)*255}function rs(e){return typeof e=="string"?!!d3.color(e):!1}function Qi(e){var t=Bo(e),r=[0,0,0,0];return t!=null&&(r[0]=t.r/255,r[1]=t.g/255,r[2]=t.b/255,r[3]=t.opacity),r}function _o(e){var t=e&&e[0],r=e&&e[1],n=e&&e[2],i=t+r*256+n*65536-1;return i}function Ws(e){return[e+1&255,e+1>>8&255,e+1>>8>>8&255]}function ds(e){var t=window.document.createElement("canvas"),r=t.getContext("2d");t.width=256,t.height=1;for(var n=null,i=r.createLinearGradient(0,0,256,1),a=e.positions[0],s=e.positions[e.positions.length-1],l=0;l<e.colors.length;++l){var p=(e.positions[l]-a)/(s-a);i.addColorStop(p,e.colors[l])}return r.fillStyle=i,r.fillRect(0,0,256,1),n=new Uint8ClampedArray(r.getImageData(0,0,256,1).data),t=null,r=null,{data:n,width:256,height:1}}function il(e,t){var r=window.document.createElement("canvas"),n=r.getContext("2d");r.width=256,r.height=1;for(var i=n.createLinearGradient(0,0,256,1),a=t[1]-t[0],s=0;s<e.colors.length;++s){var l=Math.max((e.positions[s]-t[0])/a,0);i.addColorStop(l,e.colors[s])}n.fillStyle=i,n.fillRect(0,0,256,1);var p=n.getImageData(0,0,256,1).data,m=Co(n,p);return r=null,n=null,m}function Ba(e){var t=window.document.createElement("canvas"),r=t.getContext("2d");t.width=256,t.height=1;var n=r.createImageData(256,1);return n.data.fill(0),e.positions.forEach(function(i,a){var s=Qi(e.colors[a]);n.data[i*4+0]=s[0]*255,n.data[i*4+1]=s[1]*255,n.data[i*4+2]=s[2]*255,n.data[i*4+3]=s[3]*255}),t=null,r=null,n}function Oa(e){var t=window.document.createElement("canvas"),r=t.getContext("2d");r.globalAlpha=1,t.width=256,t.height=1;for(var n=256/e.colors.length,i=0;i<e.colors.length;i++)r.beginPath(),r.lineWidth=2,r.strokeStyle=e.colors[i],r.moveTo(i*n,0),r.lineTo((i+1)*n,0),r.stroke();var a=r.getImageData(0,0,256,1).data,s=Co(r,a);return t=null,r=null,s}function Cl(e,t){var r=window.document.createElement("canvas"),n=r.getContext("2d");n.globalAlpha=1,r.width=256,r.height=1;var i=t[1]-t[0];e.positions.length-e.colors.length!==1&&console.warn("positions \u7684\u6570\u5B57\u4E2A\u6570\u5E94\u5F53\u6BD4 colors \u7684\u6837\u5F0F\u591A\u4E00\u4E2A,poisitions \u7684\u9996\u5C3E\u503C\u4E00\u822C\u4E3A\u6570\u636E\u7684\u6700\u5927\u6700\u65B0\u503C");for(var a=0;a<e.colors.length;a++)n.beginPath(),n.lineWidth=2,n.strokeStyle=e.colors[a],n.moveTo((e.positions[a]-t[0])/i*255,0),n.lineTo((e.positions[a+1]-t[0])/i*255,0),n.stroke();var s=n.getImageData(0,0,256,1).data,l=Co(n,s);return r=null,n=null,l}function Co(e,t){for(var r=e.createImageData(256,1),n=0;n<r.data.length;n+=4)r.data[n+0]=t[n+0],r.data[n+1]=t[n+1],r.data[n+2]=t[n+2],r.data[n+3]=t[n+3];return r}function gu(e){switch(e.type){case"cat":return[0,255];default:return[0,1]}}var ka={BACK:1029,FRONT:1028};function Ru(e){switch(e){case"GAODE1.x":return ka.BACK;case"GAODE2.x":return ka.BACK;case"MAPBOX":return ka.FRONT;case"SIMPLE":return ka.FRONT;case"GLOBEL":return ka.BACK;case"DEBAULT":return ka.FRONT;default:return ka.FRONT}}var cr=C(42371),yn=C(39718),bo=C(61400),mu=C.n(bo),_u=C(20250),js=C.n(_u),ou=C(41571),qa=C.n(ou),lc=C(44231),Ls=C.n(lc),su=C(26561),Nc=C.n(su),Oi=C(98621),bl=C.n(Oi),Fs=C(93544),Hl=C.n(Fs),Ri=C(68868),Rl=C.n(Ri),Yf=C(19308),al=C.n(Yf),Ka=C(7941),bt=C.n(Ka),Ye=C(18397),qt=C.n(Ye),fe=C(28440),Ue=C.n(fe),Ke=C(24602),Ht=C.n(Ke),vr=C(63536),Nr=C.n(vr),mn=C(46700),zn=C.n(mn),Mi=C(21691),Ro=C.n(Mi),Ms=C(53592),Xs=C.n(Ms),If=C(9363),uu=C.n(If),ca=C(20816),Dc=C.n(ca),ns=C(16513),Lc=C.n(ns),ol=C(34301),Xa=C.n(ol),Fn={isNil:Hl(),merge:Ue(),throttle:zn(),isString:bt(),debounce:qa(),pull:Nr(),isTypedArray:qt(),isPlainObject:al(),isNumber:Rl(),isBoolean:Nc(),isEqual:bl(),cloneDeep:js(),uniq:Ro(),clamp:mu(),upperFirst:Xs(),get:Ls(),mergeWith:Ht(),isFunction:uu(),isObject:Dc(),isUndefined:Lc(),camelCase:Xa()},Wl=Fn.pull;function Ys(e){var t=e;return typeof e=="string"&&(t=window.document.getElementById(e)),t}function lu(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}function ws(e){return lu(e).split(/\s+/)}function Mu(e){var t,r=(t=document)===null||t===void 0||(t=t.documentElement)===null||t===void 0?void 0:t.style;if(!r)return e[0];for(var n in e)if(e[n]&&e[n]in r)return e[n];return e[0]}function wi(e,t,r){var n=window.document.createElement(e);return t&&(n.className=t||""),r&&r.appendChild(n),n}function Is(e){var t=e.parentNode;t&&t.removeChild(e)}function io(e,t){if(e.classList!==void 0)for(var r=ws(t),n=0,i=r.length;n<i;n++)e.classList.add(r[n]);else if(!ko(e,t)){var a=$f(e);wu(e,(a?a+" ":"")+t)}}function Ya(e,t){if(e.classList!==void 0){var r=ws(t);r.forEach(function(n){e.classList.remove(n)})}else wu(e,lu((" "+$f(e)+" ").replace(" "+t+" "," ")))}function ko(e,t){if(e.classList!==void 0)return e.classList.contains(t);var r=$f(e);return r.length>0&&new RegExp("(^|\\s)"+t+"(\\s|$)").test(r)}function wu(e,t){e instanceof HTMLElement?e.className=t:e.className.baseVal=t}function $f(e){return e instanceof SVGElement&&(e=e.correspondingElement),e.className.baseVal===void 0?e.className:e.className.baseVal}function cc(e){for(;e&&e.firstChild;)e.removeChild(e.firstChild)}var Pf=Mu(["transform","WebkitTransform"]);function jl(e,t){e.style[Pf]=t}function vs(){if(typeof Event=="function")window.dispatchEvent(new Event("resize"));else{var e=window.document.createEvent("UIEvents");e.initUIEvent("resize",!0,!1,window,0),window.dispatchEvent(e)}}function Ml(e){var t=["padding: "+(e.height/2-8)+"px "+e.width/2+"px;","line-height: "+e.height+"px;","background-image: url("+e.toDataURL()+");"];console.log(`%c
`,t.join(""))}function yo(){var e,t=window.document.querySelector('meta[name="viewport"]');if(!t)return 1;var r=(e=t.content)===null||e===void 0?void 0:e.split(","),n=r.find(function(i){var a=i.split("="),s=(0,yn.Z)(a,1),l=s[0];return l==="initial-scale"});return n?n.split("=")[1]*1:1}var ba=yo()<1?1:window.devicePixelRatio;function gs(e,t){e.setAttribute("style","".concat(e.style.cssText).concat(t))}function Xl(e){return e.split(";").map(function(t){return t.trim()}).filter(function(t){return t})}function Ua(e,t){var r,n=Xl((r=e.getAttribute("style"))!==null&&r!==void 0?r:""),i=Xl(t),a=Wl.apply(void 0,[n].concat((0,cr.Z)(i)));e.setAttribute("style",a.join(";"))}function On(e){return Object.entries(e).map(function(t){var r=(0,yn.Z)(t,2),n=r[0],i=r[1];return"".concat(n,": ").concat(i)}).join(";")}function wl(e,t){return{left:e.left-t.left,top:e.top-t.top,right:t.left+t.width-e.left-e.width,bottom:t.top+t.height-e.top-e.height}}function fc(e,t){e.checked=t,t?e.setAttribute("checked","true"):e.removeAttribute("checked")}function is(e){e.innerHTML=""}function cu(e){e.setAttribute("draggable","false")}function Yl(e,t){if(typeof t=="string"){var r=document.createElement("div");for(r.innerHTML=t;r.firstChild;)e.append(r.firstChild)}else Array.isArray(t)?e.append.apply(e,(0,cr.Z)(t)):e.append(t)}function Fc(e,t){for(var r=Array.isArray(t)?t:[t],n=e;n instanceof Element&&n!==window.document.body;){var i,a;if(r.find(function(s){var l;return(l=n)===null||l===void 0?void 0:l.matches(s)}))return n;n=(i=(a=n)===null||a===void 0?void 0:a.parentElement)!==null&&i!==void 0?i:null}}var nf;function m0(e){return typeof ImageBitmap!="undefined"&&e instanceof ImageBitmap}function Aa(){return typeof importScripts=="function"}var Pa=Aa()?function(){return self.worker&&self.worker.referrer}:function(){return(window.location.protocol==="blob:"?window.parent:window).location.href},ma=(nf=navigator)===null||nf===void 0?void 0:nf.userAgent,Bc=!!ma.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/),ao=ma.indexOf("Android")>-1||ma.indexOf("Adr")>-1;function Qf(){for(var e=ma,t=["Android","iPhone","SymbianOS","Windows Phone","iPad","iPod"],r=!0,n=0,i=t;n<i.length;n++){var a=i[n];if(e.indexOf(a)>0){r=!1;break}}return r}function Ni(e,t){e.forEach(function(r){t[r]&&(t[r]=t[r].bind(t))})}var Yo=null,Sa=C(86461),Iu=C(8822);function Ra(e){return typeof e=="number"}var Bs=2*Math.PI*6378137/2;function af(e,t){var r=(0,yn.Z)(t,4),n=r[0],i=r[1],a=r[2],s=r[3];return e.lng>n&&e.lng<=a&&e.lat>i&&e.lat<=s}function Pu(e){var t=[1/0,1/0,-1/0,-1/0];return e.forEach(function(r){var n=r.coordinates;Gi(t,n)}),t}function Gi(e,t){return Array.isArray(t[0])?t.forEach(function(r){Gi(e,r)}):(e[0]>t[0]&&(e[0]=t[0]),e[1]>t[1]&&(e[1]=t[1]),e[2]<t[0]&&(e[2]=t[0]),e[3]<t[1]&&(e[3]=t[1])),e}function $s(e,t){return Ou(e,t)}function Ou(e,t){return Array.isArray(e[0])?e.map(function(r){return Ou(r,t)}):t(e)}function as(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{enable:!0,decimal:1};e=kc(e,t);var n=e[0],i=e[1],a=n*Bs/180,s=Math.log(Math.tan((90+i)*Math.PI/360))/(Math.PI/180);return s=s*Bs/180,r.enable&&(a=Number(a.toFixed(r.decimal)),s=Number(s.toFixed(r.decimal))),e.length===3?[a,s,e[2]]:[a,s]}function ks(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:6,r=e[0],n=e[1],i=r/Bs*180,a=n/Bs*180;return a=180/Math.PI*(2*Math.atan(Math.exp(a*Math.PI/180))-Math.PI/2),t!=null&&(i=Number(i.toFixed(t)),a=Number(a.toFixed(t))),e.length===3?[i,a,e[2]]:[i,a]}function Uo(e){if(e==null)throw new Error("lng is required");return(e>180||e<-180)&&(e=e%360,e>180&&(e=-360+e),e<-180&&(e=360+e),e===0&&(e=0)),e}function Of(e){if(e==null)throw new Error("lat is required");return(e>90||e<-90)&&(e=e%180,e>90&&(e=-180+e),e<-90&&(e=180+e),e===0&&(e=0)),e}function kc(e,t){if(t===!1)return e;var r=Uo(e[0]),n=Of(e[1]);return n>85&&(n=85),n<-85&&(n=-85),e.length===3?[r,n,e[2]]:[r,n]}function Na(e){var t=85.0511287798,r=Math.max(Math.min(t,e[1]),-t),n=256<<20,i=Math.PI/180,a=e[0]*i,s=r*i;s=Math.log(Math.tan(Math.PI/4+s/2));var l=.5/Math.PI,p=.5,m=-.5/Math.PI;return i=.5,a=n*(l*a+p),s=n*(m*s+i),[Math.floor(a),Math.floor(s)]}function Mo(e){var t=.5/Math.PI,r=.5,n=-.5/Math.PI,i=.5,a=256<<20,s=_slicedToArray(e,2),l=s[0],p=s[1];l=(l/a-r)/t,p=(p/a-i)/n,p=(Math.atan(Math.pow(Math.E,p))-Math.PI/4)*2,i=Math.PI/180;var m=p/i,T=l/i;return[T,m]}function Qs(e,t){var r=85.0511287798,n=Math.PI/180,i=6378137;return t=Math.max(Math.min(r,t),-r),e*=n,t*=n,t=Math.log(Math.tan(Math.PI/4+t/2)),[e*i,t*i]}function os(e,t){var r=Math.PI/180,n=6378137,i=e/n/r,a=2*(Math.atan(Math.exp(t/n))-Math.PI/4)/r;return[i,a]}function ms(e,t,r){var n=degreesToRadians(t[1]-e[1]),i=degreesToRadians(t[0]-e[0]),a=degreesToRadians(e[1]),s=degreesToRadians(t[1]),l=Math.pow(Math.sin(n/2),2)+Math.pow(Math.sin(i/2),2)*Math.cos(a)*Math.cos(s);return radiansToLength(2*Math.atan2(Math.sqrt(l),Math.sqrt(1-l)),r="meters")}function Nu(e){var t=Math.PI/180,r=85.0511287798,n=6378137,i=Math.max(Math.min(r,e[1]),-r),a=Math.sin(i*t),s=n*e[0]*t,l=n*Math.log((1+a)/(1-a))/2;return[s,l]}function yu(e,t){var r=Math.abs(e[1][1]-e[0][1])*t,n=Math.abs(e[1][0]-e[0][0])*t;return[[e[0][0]-n,e[0][1]-r],[e[1][0]+n,e[1][1]+r]]}function Gr(e,t){return e[0][0]<=t[0][0]&&e[0][1]<=t[0][1]&&e[1][0]>=t[1][0]&&e[1][1]>=t[1][1]}function fo(e){return[[e[0],e[1]],[e[2],e[3]]]}function of(e){var t=hc(e,[0,0]);return[e[0]/t,e[1]/t]}function hc(e,t){return Math.sqrt(Math.pow(e[0]-t[0],2)+Math.pow(e[1]-t[1],2))}function Zo(e,t){return e[0]*t[0]+e[1]*t[1]}function sl(e){return Math.sqrt(e[0]*e[0]+e[1]*e[1])}function Zu(e,t){return Math.acos(Zo(e,t)/(sl(e)*sl(t)))*180/Math.PI}function $l(e,t){return t[0]>0?t[1]>0?90-Math.atan(t[1]/t[0])*180/Math.PI:90+Math.atan(-t[1]/t[0])*180/Math.PI:t[1]<0?180+(90-Math.atan(t[1]/t[0])*180/Math.PI):270+Math.atan(t[1]/-t[0])*180/Math.PI}function Ps(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:100;if(!(!e||e.length<2)){for(var r=[0,1],n=0,i=[],a=0;a<e.length-1;a++){var s=e[a],l=e[a+1],p=hc(s,l);n+=p;var m=[s[0]-l[0],s[1]-l[1]],T=$l(r,m);if(a>0){var R=i[a-1].rotation;R-T>360-R+T&&(T=T+360)}i.push({start:s,end:l,dis:p,rotation:T,duration:0})}return i.map(function(L){L.duration=t*(L.dis/n)}),i}}function Du(e){if(Ra(e[0]))return e;if(Ra(e[0][0]))throw new Error("\u5F53\u524D\u6570\u636E\u4E0D\u652F\u6301\u6807\u6CE8");if(Ra(e[0][0][0])){var t=e,r=0,n=0,i=0;return t.forEach(function(a){a.forEach(function(s){r+=s[0],n+=s[1],i++})}),[r/i,n/i,0]}else throw new Error("\u5F53\u524D\u6570\u636E\u4E0D\u652F\u6301\u6807\u6CE8")}function Il(e){for(var t=e[0],r=e[1],n=e[0],i=e[1],a=0,s=0,l=0,p=0;p<e.length;p+=2){var m=e[p],T=e[p+1];m&&T&&(t=Math.max(m,t),r=Math.max(T,r),n=Math.min(m,n),i=Math.min(T,i),a+=m,s+=T,l++)}return{center:[a/l,s/l],radius:Math.sqrt(Math.pow(t-n,2)+Math.pow(r-i,2))/2}}function Ac(e){return(0,Sa.Z)((0,Iu.uf)([(0,Iu.Tu)(e)]))}function Oh(e){var t=131,r=137,n=0;e+="x";for(var i=Math.floor(9007199254740991/r),a=0;a<e.length;a++)n>i&&(n=Math.floor(n/r)),n=n*t+e.charCodeAt(a);return n}function _0(e){e=e.toString();for(var t=5381,r=e.length;r;)t=t*33^e.charCodeAt(--r);return t>>>0}function ul(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=Math.random()*16|0,r=e==="x"?t:t&3|8;return r.toString(16)})}var zu=function(e){return e["GAODE1.x"]="GAODE1.x",e["GAODE2.x"]="GAODE2.x",e.MAPBOX="MAPBOX",e.DEFAULT="DEFAUlTMAP",e.SIMPLE="SIMPLE",e.GLOBEL="GLOBEL",e}({});function _s(e,t,r,n,i){var a=arguments.length>5&&arguments[5]!==void 0?arguments[5]:30,s=arguments.length>6?arguments[6]:void 0,l=r;return s&&(l=Math.round(r*(a-1))/(a-1)),n?ll(e,t,l,n,i):ll(e,t,l,.314,i)}function Ql(e,t){var r=1-t;return(e[0]*r+e[1]*t)*r+(e[1]*r+e[2]*t)*t}function zo(e,t){return Math.sqrt(Math.pow(e[0]-t[0],2)+Math.pow(e[1]-t[1],2))}function Gu(e,t,r){var n=[t[0]-e[0],t[1]-e[1]],i=zo(n,[0,0]),a=Math.atan2(n[1],n[0]),s=i/2/Math.cos(r),l=a+r,p=[s*Math.cos(l)+e[0],s*Math.sin(l)+e[1]];return p}function ll(e,t,r,n,i){if(i===MapType["GAODE2.x"]){var a=amap2Project(e[0],e[1]),s=amap2Project(t[0],t[1]),l=Gu(a,s,n),p=[a[0],l[0],s[0]],m=[a[1],l[1],s[1]];return[].concat(_toConsumableArray(amap2UnProject(Ql(p,r),Ql(m,r))),[0])}else{var T=Gu(e,t,n),R=[e[0],T[0],t[0]],L=[e[1],T[1],t[1]];return[Ql(R,r),Ql(L,r),0]}}function sf(e,t,r,n,i){var a=arguments.length>5&&arguments[5]!==void 0?arguments[5]:30,s=arguments.length>6?arguments[6]:void 0,l=r;return s&&(l=Math.round(r*29)/29),wo(e,t,l,i)}function pc(e,t){var r=[t[0]-e[0],t[1]-e[1]],n=calDistance(r,[0,0]),i=Math.atan2(r[1],r[0]),a=.314,s=n/2/Math.cos(a),l=i+a,p=[s*Math.cos(l)+e[0],s*Math.sin(l)+e[1]];return p}function Vu(e,t){var r=1-t;return(e[0]*r+e[1]*t)*r+(e[1]*r+e[2]*t)*t}function Hu(e,t){var r=[e[0]-t[0],e[1]-t[1]],n=[Math.sin(r[0]/2),Math.sin(r[1]/2)],i=n[1]*n[1]+Math.cos(e[1])*Math.cos(t[1])*n[0]*n[0];return 2*Math.atan2(Math.sqrt(i),Math.sqrt(1-i))}function wo(e,t,r,n){var i=[degreesToRadians(e[0]),degreesToRadians(e[1])],a=[degreesToRadians(t[0]),degreesToRadians(t[1])];if(n==="GAODE2.x"){var s=pc(i,a),l=[i[0],s[0],a[0]],p=[i[1],s[1],a[1]];return[Vu(l,r),Vu(p,r),0]}else{var m=Hu(i,a);if(Math.abs(m-Math.PI)<.001)return[(1-r)*i[0]+r*a[0],(1-r)*i[1]+r*a[1]];var T=Math.sin((1-r)*m)/Math.sin(m),R=Math.sin(r*m)/Math.sin(m),L=[Math.sin(i[0]),Math.sin(i[1])],z=[Math.cos(i[0]),Math.cos(i[1])],re=[Math.sin(a[0]),Math.sin(a[1])],ee=[Math.cos(a[0]),Math.cos(a[1])],me=T*z[1]*z[0]+R*ee[1]*ee[0],Ie=T*z[1]*L[0]+R*ee[1]*re[0],He=T*L[1]+R*re[1];return[radiansToDegrees(Math.atan2(Ie,me)),radiansToDegrees(Math.atan2(He,Math.sqrt(me*me+Ie*Ie)))]}}function Wu(e,t){for(var r=0,n=[],i=0;i<e.length-1;i++){var a=e[i],s=e[i+1],l=X0(a,s),p=r;r+=l,n.push({p1:a,p2:s,totalDistance:r,distance:l,lastTotalDistance:p})}for(var m=r*t,T,R,L=0,z=n;L<z.length;L++){var re=z[L],ee=re.totalDistance;if(ee>m){var me=re.p1,Ie=re.p2,He=(m-re.lastTotalDistance)/re.distance,Xe=ss(Ie,me,He);T=Xe[0],R=Xe[1];break}}return{lng:T,lat:R,height:0}}function ss(e,t,r){return[e[0]*r+t[0]*(1-r),e[1]*r+t[1]*(1-r)]}function X0(e,t){return Math.sqrt(Math.pow(e[0]-t[0],2)+Math.pow(e[1]-t[1],2))}function Pl(e,t){var r=t.featureId,n=e.data.dataArray;return typeof r=="number"&&(n=n.filter(function(i){var a=i.id;return a===r})),n.map(function(i){var a=us(i,t);return _objectSpread(_objectSpread({},i),a)})}function Uc(e,t){return new Promise(function(r){e.inited?r(Pl(e,t)):e.once("update",function(){r(Pl(e,t))})})}function us(e,t){var r=t.offset,n=t.shape,i=t.thetaOffset,a=t.mapVersion,s=t.segmentNumber,l=s===void 0?30:s,p=t.autoFit,m=p===void 0?!0:p,T=e.coordinates;if(n==="line")return pathLineAtOffset(T,r);var R=T[0],L=T[1],z=typeof i=="string"?e[i]||0:i,re;switch(n){case"arc":re=arcLineAtOffset;break;case"greatcircle":re=greatCircleLineAtOffset;break;default:re=arcLineAtOffset}var ee=re(R,L,r,z,a,l,m),me=_slicedToArray(ee,3),Ie=me[0],He=me[1],Xe=me[2];return{lng:Ie,lat:He,height:Xe}}var ys=function(){function e(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:50,r=arguments.length>1?arguments[1]:void 0;(0,ue.Z)(this,e),this.limit=t,this.destroy=r||this.defaultDestroy,this.order=[],this.clear()}return(0,_e.Z)(e,[{key:"clear",value:function(){var r=this;this.order.forEach(function(n){r.delete(n)}),this.cache={},this.order=[]}},{key:"get",value:function(r){var n=this.cache[r];return n&&(this.deleteOrder(r),this.appendOrder(r)),n}},{key:"set",value:function(r,n){this.cache[r]?(this.delete(r),this.cache[r]=n,this.appendOrder(r)):(Object.keys(this.cache).length===this.limit&&this.delete(this.order[0]),this.cache[r]=n,this.appendOrder(r))}},{key:"delete",value:function(r){var n=this.cache[r];n&&(this.deleteCache(r),this.deleteOrder(r),this.destroy(n,r))}},{key:"deleteCache",value:function(r){delete this.cache[r]}},{key:"deleteOrder",value:function(r){var n=this.order.findIndex(function(i){return i===r});n>=0&&this.order.splice(n,1)}},{key:"appendOrder",value:function(r){this.order.push(r)}},{key:"defaultDestroy",value:function(r,n){return null}}]),e}();function qs(e){if(e.length===0)throw new Error("max requires at least one data point");for(var t=e[0],r=1;r<e.length;r++)e[r]>t&&(t=e[r]);return t*1}function Os(e){if(e.length===0)throw new Error("min requires at least one data point");for(var t=e[0],r=1;r<e.length;r++)e[r]<t&&(t=e[r]);return t*1}function Nf(e){if(e.length===0)return 0;for(var t=e[0]*1,r=1;r<e.length;r++)t+=e[r]*1;return t}function fu(e){if(e.length===0)throw new Error("mean requires at least one data point");return Nf(e)/e.length}function ls(e){if(e.length===0)throw new Error("mean requires at least one data point");if(e.length<3)return e[0];e.sort();for(var t=e[0],r=NaN,n=0,i=1,a=1;a<e.length+1;a++)e[a]!==t?(i>n&&(n=i,r=t),i=1,t=e[a]):i++;return r*1}var Io={min:Os,max:qs,mean:fu,sum:Nf,mode:ls};function uf(e,t){return e.map(function(r){return r[t]})}function po(e,t){return Io[e](t)}var hr=C(97100),St=C(9967),ve=C(80268),hu=C(96026),it=C.n(hu),Eu=C(39511),Si=C(40666),cl=C.n(Si),va=function(e){return e.Realtime="realtime",e.Overlap="overlap",e.Replace="replace",e}({}),pa=function(e){return e.Loading="Loading",e.Loaded="Loaded",e.Failure="Failure",e.Cancelled="Cancelled",e}({}),Bi=0,Go=1,qi=2;function ni(e){e.forEach(function(t){t.isCurrent&&(t.isVisible=t.isLoaded)})}function Pi(e){e.forEach(function(t){t.properties.state=Bi}),e.forEach(function(t){t.isCurrent&&!Ii(t)&&xi(t)}),e.forEach(function(t){t.isVisible=!!(t.properties.state&qi)})}function oa(e){e.forEach(function(r){r.properties.state=Bi}),e.forEach(function(r){r.isCurrent&&Ii(r)});var t=e.slice().sort(function(r,n){return r.z-n.z});t.forEach(function(r){r.isVisible=!!(r.properties.state&qi),r.children.length&&(r.isVisible||r.properties.state&Go)?r.children.forEach(function(n){n.properties.state=Go}):r.isCurrent&&xi(r)})}function Ii(e){for(;e;){if(e.isLoaded)return e.properties.state|=qi,!0;e=e.parent}return!1}function xi(e){e.children.forEach(function(t){t.isLoaded?t.properties.state|=qi:xi(t)})}var Un,ii=256,ki=[-1/0,-1/0,1/0,1/0],fi=.2,Vi=5,ra=(Un={},(0,ve.Z)(Un,va.Realtime,ni),(0,ve.Z)(Un,va.Overlap,Pi),(0,ve.Z)(Un,va.Replace,oa),Un),Dn=function(){};function Hi(e,t,r){var n=Math.floor((e+180)/360*Math.pow(2,r)),i=Math.floor((1-Math.log(Math.tan(t*Math.PI/180)+1/Math.cos(t*Math.PI/180))/Math.PI)/2*Math.pow(2,r));return[n,i]}function yi(e,t,r){var n=e/Math.pow(2,r)*360-180,i=Math.PI-2*Math.PI*t/Math.pow(2,r),a=180/Math.PI*Math.atan(.5*(Math.exp(i)-Math.exp(-i)));return[n,a]}var na=function(t,r,n){var i=yi(t,r,n),a=(0,yn.Z)(i,2),s=a[0],l=a[1],p=yi(t+1,r+1,n),m=(0,yn.Z)(p,2),T=m[0],R=m[1];return[s,R,T,l]};function Wi(e){var t=e.zoom,r=e.latLonBounds,n=e.maxZoom,i=n===void 0?1/0:n,a=e.minZoom,s=a===void 0?0:a,l=e.zoomOffset,p=l===void 0?0:l,m=e.extent,T=m===void 0?ki:m,R=Math.ceil(t)+p;if(Number.isFinite(s)&&R<s)return[];Number.isFinite(i)&&R>i&&(R=i);for(var L=(0,yn.Z)(r,4),z=L[0],re=L[1],ee=L[2],me=L[3],Ie=[Math.max(z,T[0]),Math.max(re,T[1]),Math.min(ee,T[2]),Math.min(me,T[3])],He=[],Xe=Hi(Ie[0],Ie[1],R),ot=(0,yn.Z)(Xe,2),pt=ot[0],dt=ot[1],It=Hi(Ie[2],Ie[3],R),Vt=(0,yn.Z)(It,2),Kt=Vt[0],yr=Vt[1],_r=pt;_r<=Kt;_r++)for(var Hr=yr;Hr<=dt;Hr++)He.push({x:_r,y:Hr,z:R});var nn=(Kt+pt)/2,Tn=(dt+yr)/2,sa=function(jo,As){return Math.abs(jo-nn)+Math.abs(As-Tn)};return He.sort(function(Fo,jo){return sa(Fo.x,Fo.y)-sa(jo.x,jo.y)}),He}var ua=function(t,r,n){var i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!0,a=Math.pow(2,n),s=a-1,l=a,p=t,m=r;return i&&(p<0?p=p+l:p>s&&(p=p%l)),{warpX:p,warpY:m}};function la(e){var t=Ti();return function(){var n=(0,le.Z)(e),i;if(t){var a=(0,le.Z)(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return(0,ze.Z)(this,i)}}function Ti(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var Ui=function(e){(0,ke.Z)(r,e);var t=la(r);function r(n){var i;(0,ue.Z)(this,r),i=t.call(this),(0,ve.Z)((0,St.Z)(i),"tileSize",256),(0,ve.Z)((0,St.Z)(i),"isVisible",!1),(0,ve.Z)((0,St.Z)(i),"isCurrent",!1),(0,ve.Z)((0,St.Z)(i),"isVisibleChange",!1),(0,ve.Z)((0,St.Z)(i),"loadedLayers",0),(0,ve.Z)((0,St.Z)(i),"isLayerLoaded",!1),(0,ve.Z)((0,St.Z)(i),"isLoad",!1),(0,ve.Z)((0,St.Z)(i),"isChildLoad",!1),(0,ve.Z)((0,St.Z)(i),"parent",null),(0,ve.Z)((0,St.Z)(i),"children",[]),(0,ve.Z)((0,St.Z)(i),"data",null),(0,ve.Z)((0,St.Z)(i),"properties",{}),(0,ve.Z)((0,St.Z)(i),"loadDataId",0);var a=n.x,s=n.y,l=n.z,p=n.tileSize,m=n.warp,T=m===void 0?!0:m;return i.x=a,i.y=s,i.z=l,i.warp=T||!0,i.tileSize=p,i}return(0,_e.Z)(r,[{key:"isLoading",get:function(){return this.loadStatus===pa.Loading}},{key:"isLoaded",get:function(){return this.loadStatus===pa.Loaded}},{key:"isFailure",get:function(){return this.loadStatus===pa.Failure}},{key:"setTileLayerLoaded",value:function(){this.isLayerLoaded=!0}},{key:"isCancelled",get:function(){return this.loadStatus===pa.Cancelled}},{key:"isDone",get:function(){return[pa.Loaded,pa.Cancelled,pa.Failure].includes(this.loadStatus)}},{key:"bounds",get:function(){return na(this.x,this.y,this.z)}},{key:"bboxPolygon",get:function(){var i=(0,yn.Z)(this.bounds,4),a=i[0],s=i[1],l=i[2],p=i[3],m=[(l-a)/2,(p-s)/2],T=(0,Eu.Z)(this.bounds,{properties:{key:this.key,id:this.key,bbox:this.bounds,center:m,meta:`
      `.concat(this.key,`
      `)}});return T}},{key:"key",get:function(){var i="".concat(this.x,"_").concat(this.y,"_").concat(this.z);return i}},{key:"layerLoad",value:function(){this.loadedLayers++,this.emit("layerLoaded")}},{key:"loadData",value:function(){var n=(0,hr.Z)(it().mark(function a(s){var l,p,m,T,R,L,z,re,ee,me,Ie,He,Xe,ot,pt,dt,It;return it().wrap(function(Kt){for(;;)switch(Kt.prev=Kt.next){case 0:return l=s.getData,p=s.onLoad,m=s.onError,this.loadDataId++,T=this.loadDataId,this.isLoading&&this.abortLoad(),this.abortController=new AbortController,this.loadStatus=pa.Loading,R=null,Kt.prev=7,z=this.x,re=this.y,ee=this.z,me=this.bounds,Ie=this.tileSize,He=this.warp,Xe=ua(z,re,ee,He),ot=Xe.warpX,pt=Xe.warpY,dt=this.abortController.signal,It={x:ot,y:pt,z:ee,bounds:me,tileSize:Ie,signal:dt,warp:He},Kt.next=14,l(It,this);case 14:R=Kt.sent,Kt.next=20;break;case 17:Kt.prev=17,Kt.t0=Kt.catch(7),L=Kt.t0;case 20:if(T===this.loadDataId){Kt.next=22;break}return Kt.abrupt("return");case 22:if(!(this.isCancelled&&!R)){Kt.next=24;break}return Kt.abrupt("return");case 24:if(!(L||!R)){Kt.next=28;break}return this.loadStatus=pa.Failure,m(L,this),Kt.abrupt("return");case 28:this.loadStatus=pa.Loaded,this.data=R,p(this);case 31:case"end":return Kt.stop()}},a,this,[[7,17]])}));function i(a){return n.apply(this,arguments)}return i}()},{key:"reloadData",value:function(i){this.isLoading&&this.abortLoad(),this.loadData(i)}},{key:"abortLoad",value:function(){this.isLoaded||this.isCancelled||(this.loadStatus=pa.Cancelled,this.abortController.abort(),this.xhrCancel&&this.xhrCancel())}}]),r}(Si.EventEmitter),Zi=function(t,r){var n=fo(t),i=yu(n,r),a=360*3-180,s=85.0511287798065,l=[Math.max(i[0][0],-a),Math.max(i[0][1],-s),Math.min(i[1][0],a),Math.min(i[1][1],s)];return l},ia=function(t,r){var n=fo(t),i=fo(r),a=Gr(n,i);return a};function Vn(e,t){var r=typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=ju(e))||t&&e&&typeof e.length=="number"){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(m){throw m},f:i}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var a=!0,s=!1,l;return{s:function(){r=r.call(e)},n:function(){var m=r.next();return a=m.done,m},e:function(m){s=!0,l=m},f:function(){try{!a&&r.return!=null&&r.return()}finally{if(s)throw l}}}}function ju(e,t){if(e){if(typeof e=="string")return ql(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return ql(e,t)}}function ql(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Us(e){var t=Lu();return function(){var n=(0,le.Z)(e),i;if(t){var a=(0,le.Z)(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return(0,ze.Z)(this,i)}}function Lu(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var Qn=Fn.throttle,cs=function(e){return e.TilesLoadStart="tiles-load-start",e.TileLoaded="tile-loaded",e.TileError="tile-error",e.TileUnload="tile-unload",e.TileUpdate="tile-update",e.TilesLoadFinished="tiles-load-finished",e}({}),Ol=function(e){(0,ke.Z)(r,e);var t=Us(r);function r(n){var i;return(0,ue.Z)(this,r),i=t.call(this),(0,ve.Z)((0,St.Z)(i),"currentTiles",[]),(0,ve.Z)((0,St.Z)(i),"cacheTiles",new Map),(0,ve.Z)((0,St.Z)(i),"throttleUpdate",Qn(function(a,s){i.update(a,s)},16)),(0,ve.Z)((0,St.Z)(i),"onTileLoad",function(a){i.emit(cs.TileLoaded,a),i.updateTileVisible(),i.loadFinished()}),(0,ve.Z)((0,St.Z)(i),"onTileError",function(a,s){i.emit(cs.TileError,{error:a,tile:s}),i.updateTileVisible(),i.loadFinished()}),(0,ve.Z)((0,St.Z)(i),"onTileUnload",function(a){i.emit(cs.TileUnload,a),i.loadFinished()}),i.options={tileSize:256,minZoom:0,maxZoom:1/0,zoomOffset:0,extent:ki,getTileData:Dn,warp:!0,updateStrategy:va.Replace},i.updateOptions(n),i}return(0,_e.Z)(r,[{key:"isLoaded",get:function(){return this.currentTiles.every(function(i){return i.isDone})}},{key:"tiles",get:function(){var i=Array.from(this.cacheTiles.values()).sort(function(a,s){return a.z-s.z});return i}},{key:"updateOptions",value:function(i){var a=i.minZoom===void 0?this.options.minZoom:Math.ceil(i.minZoom),s=i.maxZoom===void 0?this.options.maxZoom:Math.floor(i.maxZoom);this.options=(0,Q.Z)((0,Q.Z)((0,Q.Z)({},this.options),i),{},{minZoom:a,maxZoom:s})}},{key:"update",value:function(i,a){var s=this,l=Math.max(0,Math.ceil(i));if(!(this.lastViewStates&&this.lastViewStates.zoom===l&&ia(this.lastViewStates.latLonBoundsBuffer,a))){var p=Zi(a,fi);this.lastViewStates={zoom:l,latLonBounds:a,latLonBoundsBuffer:p},this.currentZoom=l;var m=!1,T=this.getTileIndices(l,p).filter(function(R){return s.options.warp||R.x>=0&&R.x<Math.pow(2,l)});this.emit(cs.TilesLoadStart),this.currentTiles=T.map(function(R){var L=R.x,z=R.y,re=R.z,ee=s.getTile(L,z,re);if(ee){var me,Ie,He=((me=ee)===null||me===void 0?void 0:me.isFailure)||((Ie=ee)===null||Ie===void 0?void 0:Ie.isCancelled);return He&&ee.loadData({getData:s.options.getTileData,onLoad:s.onTileLoad,onError:s.onTileError}),ee}return ee=s.createTile(L,z,re),m=!0,ee}),m&&this.resizeCacheTiles(),this.updateTileVisible(),this.pruneRequests()}}},{key:"reloadAll",value:function(){var i=Vn(this.cacheTiles),a;try{for(i.s();!(a=i.n()).done;){var s=(0,yn.Z)(a.value,2),l=s[0],p=s[1];if(!this.currentTiles.includes(p)){this.cacheTiles.delete(l),this.onTileUnload(p);return}this.onTileUnload(p),p.loadData({getData:this.options.getTileData,onLoad:this.onTileLoad,onError:this.onTileError})}}catch(m){i.e(m)}finally{i.f()}}},{key:"reloadTileById",value:function(i,a,s){var l=this.cacheTiles.get("".concat(a,",").concat(s,",").concat(i));l&&(this.onTileUnload(l),l.loadData({getData:this.options.getTileData,onLoad:this.onTileLoad,onError:this.onTileError}))}},{key:"reloadTileByLnglat",value:function(i,a,s){var l=this.getTileByLngLat(i,a,s);l&&this.reloadTileById(l.z,l.x,l.y)}},{key:"reloadTileByExtent",value:function(i,a){var s=this,l=this.getTileIndices(a,i);l.forEach(function(p){s.reloadTileById(p.z,p.x,p.y)})}},{key:"pruneRequests",value:function(){var i=[],a=Vn(this.cacheTiles.values()),s;try{for(a.s();!(s=a.n()).done;){var l=s.value;l.isLoading&&!l.isCurrent&&!l.isVisible&&i.push(l)}}catch(m){a.e(m)}finally{a.f()}for(;i.length>0;){var p=i.shift();p.abortLoad()}}},{key:"getTileByLngLat",value:function(i,a,s){var l=this.options.zoomOffset,p=Math.ceil(s)+l,m=Hi(i,a,p),T=this.tiles.filter(function(R){return R.key==="".concat(m[0],"_").concat(m[1],"_").concat(p)});return T[0]}},{key:"getTileExtent",value:function(i,a){return this.getTileIndices(a,i)}},{key:"getTileByZXY",value:function(i,a,s){var l=this.tiles.filter(function(p){return p.key==="".concat(a,"_").concat(s,"_").concat(i)});return l[0]}},{key:"clear",value:function(){var i=Vn(this.cacheTiles.values()),a;try{for(i.s();!(a=i.n()).done;){var s=a.value;s.isLoading?s.abortLoad():this.onTileUnload(s)}}catch(l){i.e(l)}finally{i.f()}this.lastViewStates=void 0,this.cacheTiles.clear(),this.currentTiles=[]}},{key:"destroy",value:function(){this.clear(),this.removeAllListeners()}},{key:"updateTileVisible",value:function(){var i=this.options.updateStrategy,a=new Map,s=Vn(this.cacheTiles.values()),l;try{for(s.s();!(l=s.n()).done;){var p=l.value;a.set(p.key,p.isVisible),p.isCurrent=!1,p.isVisible=!1}}catch(re){s.e(re)}finally{s.f()}var m=Vn(this.currentTiles),T;try{for(m.s();!(T=m.n()).done;){var R=T.value;R.isCurrent=!0,R.isVisible=!0}}catch(re){m.e(re)}finally{m.f()}var L=Array.from(this.cacheTiles.values());typeof i=="function"?i(L):ra[i](L);var z=!1;Array.from(this.cacheTiles.values()).forEach(function(re){re.isVisible!==a.get(re.key)?(re.isVisibleChange=!0,z=!0):re.isVisibleChange=!1}),z&&this.emit(cs.TileUpdate)}},{key:"getTileIndices",value:function(i,a){var s=this.options,l=s.tileSize,p=s.extent,m=s.zoomOffset,T=Math.floor(this.options.maxZoom),R=Math.ceil(this.options.minZoom),L=Wi({maxZoom:T,minZoom:R,zoomOffset:m,tileSize:l,zoom:i,latLonBounds:a,extent:p});return L}},{key:"getTileId",value:function(i,a,s){var l="".concat(i,",").concat(a,",").concat(s);return l}},{key:"loadFinished",value:function(){var i=!this.currentTiles.some(function(a){return!a.isDone});return i&&this.emit(cs.TilesLoadFinished),i}},{key:"getTile",value:function(i,a,s){var l=this.getTileId(i,a,s),p=this.cacheTiles.get(l);return p}},{key:"createTile",value:function(i,a,s){var l=this.getTileId(i,a,s),p=new Ui({x:i,y:a,z:s,tileSize:this.options.tileSize,warp:this.options.warp});return this.cacheTiles.set(l,p),p.loadData({getData:this.options.getTileData,onLoad:this.onTileLoad,onError:this.onTileError}),p}},{key:"resizeCacheTiles",value:function(){var i=Vi*this.currentTiles.length,a=this.cacheTiles.size>i;if(a){var s=Vn(this.cacheTiles),l;try{for(s.s();!(l=s.n()).done;){var p=(0,yn.Z)(l.value,2),m=p[0],T=p[1];if(!T.isVisible&&!this.currentTiles.includes(T)&&(this.cacheTiles.delete(m),this.onTileUnload(T)),this.cacheTiles.size<=i)break}}catch(R){s.e(R)}finally{s.f()}}this.rebuildTileTree()}},{key:"rebuildTileTree",value:function(){var i=Vn(this.cacheTiles.values()),a;try{for(i.s();!(a=i.n()).done;){var s=a.value;s.parent=null,s.children.length=0}}catch(R){i.e(R)}finally{i.f()}var l=Vn(this.cacheTiles.values()),p;try{for(l.s();!(p=l.n()).done;){var m=p.value,T=this.getNearestAncestor(m.x,m.y,m.z);m.parent=T,T!=null&&T.children&&T.children.push(m)}}catch(R){l.e(R)}finally{l.f()}}},{key:"getNearestAncestor",value:function(i,a,s){for(;s>this.options.minZoom;){i=Math.floor(i/2),a=Math.floor(a/2),s=s-1;var l=this.getTile(i,a,s);if(l)return l}return null}}]),r}(cl());function fl(e){return/(?=.*{box})(?=.*{z})(?=.*{x})(?=.*({y}|{-y}))/.test(e)}function Zs(e){var t=[],r=/\{([a-z])-([a-z])\}/.exec(e);if(r){var n=r[1].charCodeAt(0),i=r[2].charCodeAt(0),a;for(a=n;a<=i;++a)t.push(e.replace(r[0],String.fromCharCode(a)));return t}if(r=/\{(\d+)-(\d+)\}/.exec(e),r){for(var s=parseInt(r[2],10),l=parseInt(r[1],10);l<=s;l++)t.push(e.replace(r[0],l.toString()));return t}return t.push(e),t}function Kl(e,t){if(!e||!e.length)throw new Error("url is not allowed to be empty");var r=t.x,n=t.y,i=t.z,a=Zs(e),s=Math.abs(r+n)%a.length,l=tn(a[s])?"".concat(a[s],"/{z}/{x}/{y}"):a[s];return l.replace(/\{x\}/g,r.toString()).replace(/\{y\}/g,n.toString()).replace(/\{z\}/g,i.toString()).replace(/\{bbox\}/g,na(r,n,i).join(",")).replace(/\{-y\}/g,(Math.pow(2,i)-n-1).toString())}function zs(e,t){var r=t.x,n=t.y,i=t.z,a=t.layer,s=t.version,l=s===void 0?"1.0.0":s,p=t.style,m=p===void 0?"default":p,T=t.format,R=t.service,L=R===void 0?"WMTS":R,z=t.tileMatrixset,re="".concat(e,"&SERVICE=").concat(L,"&REQUEST=GetTile&VERSION=").concat(l,"&LAYER=").concat(a,"&STYLE=").concat(m,"&TILEMATRIXSET=").concat(z,"&FORMAT=").concat(T,"&TILECOL=").concat(r,"&TILEROW=").concat(n,"&TILEMATRIX=").concat(i);return re}function $a(e,t){if(!e)throw new Error(t||"web worker helper assertion failed.")}var Jl={self:typeof self!="undefined"&&self,window:typeof window!="undefined"&&window,document:typeof document!="undefined"&&document},Df=Jl.self||Jl.window||{},o=Jl.window||Jl.self||{},u=Jl.self||Jl.window||{},v=Jl.document||{},y=typeof importScripts=="function",b=typeof window!="undefined"&&typeof window.orientation!="undefined",H=function(){function e(t,r){var n=this;this.name=t,this.workerThread=r,this.isRunning=!0,this.resolve=function(){},this.reject=function(){},this.result=new Promise(function(i,a){n.resolve=i,n.reject=a})}return e.prototype.postMessage=function(t,r){this.workerThread.postMessage({source:"Main thread",type:t,payload:r})},e.prototype.done=function(t){$a(this.isRunning,"WorkerJob isRunning false."),this.isRunning=!1,this.resolve(t)},e.prototype.error=function(t){$a(this.isRunning,"WorkerJob isRunning false."),this.isRunning=!1,this.reject(t)},e}(),ne=H,Le=new Map;function tt(e){$a(e.source&&!e.url||!e.source&&e.url);var t=Le.get(e.source||e.url);return t||(e.url&&(t=Nt(e.url),Le.set(e.url,t)),e.source&&(t=ar(e.source),Le.set(e.source,t))),$a(t),t}function Nt(e){if(!e.startsWith("http"))return e;var t=st(e);return ar(t)}function ar(e){var t=new Blob([e],{type:"application/javascript"});return URL.createObjectURL(t)}function st(e){return`try {
  importScripts('`+e+`');
} catch (error) {
  console.error(error);
  throw error;
}`}function Gt(e,t,r){t===void 0&&(t=!0);var n=r||new Set;if(e){if(ir(e))n.add(e);else if(ir(e.buffer))n.add(e.buffer);else if(!ArrayBuffer.isView(e)){if(t&&typeof e=="object")for(var i in e)Gt(e[i],t,n)}}return r===void 0?Array.from(n):[]}function ir(e){return e?e instanceof ArrayBuffer||typeof MessagePort!="undefined"&&e instanceof MessagePort||typeof ImageBitmap!="undefined"&&e instanceof ImageBitmap||typeof OffscreenCanvas!="undefined"&&e instanceof OffscreenCanvas:!1}var br=function(){},g=function(){function e(t){this.terminated=!1,this.loadableURL="";var r=t.name,n=t.source,i=t.url;$a(n||i),this.name=r,this.source=n,this.url=i,this.onMessage=br,this.onError=function(a){return console.log(a)},this.worker=this.createBrowserWorker()}return e.isSupported=function(){return typeof Worker!="undefined"},e.prototype.destroy=function(){this.onMessage=br,this.onError=br,this.worker.terminate(),this.terminated=!0},Object.defineProperty(e.prototype,"isRunning",{get:function(){return!!this.onMessage},enumerable:!1,configurable:!0}),e.prototype.postMessage=function(t,r){r=r||Gt(t),this.worker.postMessage(t,r)},e.prototype.getErrorFromErrorEvent=function(t){var r="Failed to load ";return r+="worker "+this.name+" from "+this.url+". ",t.message&&(r+=t.message+" in "),t.lineno&&(r+=":"+t.lineno+":"+t.colno),new Error(r)},e.prototype.createBrowserWorker=function(){var t=this;this.loadableURL=tt({source:this.source,url:this.url});var r=new Worker(this.loadableURL,{name:this.name});return r.onmessage=function(n){n.data?t.onMessage(n.data):t.onError(new Error("No data received"))},r.onerror=function(n){t.onError(t.getErrorFromErrorEvent(n)),t.terminated=!0},r.onmessageerror=function(n){return console.error("worker "+t.name+", message error: "+n)},r},e}(),Bn=g,Jn=function(){return Jn=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e},Jn.apply(this,arguments)},et=function(e,t,r,n){function i(a){return a instanceof r?a:new r(function(s){s(a)})}return new(r||(r=Promise))(function(a,s){function l(T){try{m(n.next(T))}catch(R){s(R)}}function p(T){try{m(n.throw(T))}catch(R){s(R)}}function m(T){T.done?a(T.value):i(T.value).then(l,p)}m((n=n.apply(e,t||[])).next())})},Za=function(e,t){var r={label:0,sent:function(){if(a[0]&1)throw a[1];return a[1]},trys:[],ops:[]},n,i,a,s;return s={next:l(0),throw:l(1),return:l(2)},typeof Symbol=="function"&&(s[Symbol.iterator]=function(){return this}),s;function l(m){return function(T){return p([m,T])}}function p(m){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,i&&(a=m[0]&2?i.return:m[0]?i.throw||((a=i.return)&&a.call(i),0):i.next)&&!(a=a.call(i,m[1])).done)return a;switch(i=0,a&&(m=[m[0]&2,a.value]),m[0]){case 0:case 1:a=m;break;case 4:return r.label++,{value:m[1],done:!1};case 5:r.label++,i=m[1],m=[0];continue;case 7:m=r.ops.pop(),r.trys.pop();continue;default:if(a=r.trys,!(a=a.length>0&&a[a.length-1])&&(m[0]===6||m[0]===2)){r=0;continue}if(m[0]===3&&(!a||m[1]>a[0]&&m[1]<a[3])){r.label=m[1];break}if(m[0]===6&&r.label<a[1]){r.label=a[1],a=m;break}if(a&&r.label<a[2]){r.label=a[2],r.ops.push(m);break}a[2]&&r.ops.pop(),r.trys.pop();continue}m=t.call(e,r)}catch(T){m=[6,T],i=0}finally{n=a=0}if(m[0]&5)throw m[1];return{value:m[0]?m[1]:void 0,done:!0}}},Eo=function(){function e(t){this.name="unnamed",this.maxConcurrency=1,this.maxMobileConcurrency=1,this.onDebug=function(){},this.reuseWorkers=!0,this.props={},this.jobQueue=[],this.idleQueue=[],this.count=0,this.isDestroyed=!1,this.source=t.source,this.url=t.url,this.setProps(t)}return e.prototype.destroy=function(){this.idleQueue.forEach(function(t){return t.destroy()}),this.isDestroyed=!0},e.prototype.setProps=function(t){this.props=Jn(Jn({},this.props),t),t.name!==void 0&&(this.name=t.name),t.maxConcurrency!==void 0&&(this.maxConcurrency=t.maxConcurrency),t.maxMobileConcurrency!==void 0&&(this.maxMobileConcurrency=t.maxMobileConcurrency),t.reuseWorkers!==void 0&&(this.reuseWorkers=t.reuseWorkers),t.onDebug!==void 0&&(this.onDebug=t.onDebug)},e.prototype.startJob=function(t,r,n){return r===void 0&&(r=function(i,a,s){return i.done(s)}),n===void 0&&(n=function(i,a){return i.error(a)}),et(this,void 0,void 0,function(){var i,a=this;return Za(this,function(s){switch(s.label){case 0:return i=new Promise(function(l){return a.jobQueue.push({name:t,onMessage:r,onError:n,onStart:l}),a}),this.startQueuedJob(),[4,i];case 1:return[2,s.sent()]}})})},e.prototype.startQueuedJob=function(){return et(this,void 0,void 0,function(){var t,r,n;return Za(this,function(i){switch(i.label){case 0:if(!this.jobQueue.length)return[2];if(t=this.getAvailableWorker(),!t)return[2];if(r=this.jobQueue.shift(),!r)return[3,4];this.onDebug({message:"Starting job",name:r.name,backlog:this.jobQueue.length,workerThread:t}),n=new ne(r.name,t),t.onMessage=function(a){return r.onMessage(n,a.type,a.payload)},t.onError=function(a){return r.onError(n,a)},r.onStart(n),i.label=1;case 1:return i.trys.push([1,,3,4]),[4,n.result];case 2:return i.sent(),[3,4];case 3:return this.returnWorkerToQueue(t),[7];case 4:return[2]}})})},e.prototype.returnWorkerToQueue=function(t){var r=this.isDestroyed||!this.reuseWorkers||this.count>this.getMaxConcurrency();r?(t.destroy(),this.count--):this.idleQueue.push(t),this.isDestroyed||this.startQueuedJob()},e.prototype.getAvailableWorker=function(){if(this.idleQueue.length>0)return this.idleQueue.shift()||null;if(this.count<this.getMaxConcurrency()){this.count++;var t=this.name.toLowerCase()+" (#"+this.count+" of "+this.maxConcurrency+")";return new Bn({name:t,source:this.source,url:this.url})}return null},e.prototype.getMaxConcurrency=function(){return b?this.maxMobileConcurrency:this.maxConcurrency},e}(),oo=Eo,xa=function(){return xa=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e},xa.apply(this,arguments)},vo=function(e){var t=typeof Symbol=="function"&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&typeof e.length=="number")return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},Es={maxConcurrency:3,maxMobileConcurrency:1,onDebug:function(){},reuseWorkers:!0},Ma=function(){function e(t){this.workerPools=new Map,this.props=xa({},Es),this.setProps(t),this.workerPools=new Map}return e.isSupported=function(){return Bn.isSupported()},e.getWorkerFarm=function(t){return t===void 0&&(t={}),e.workerFarm=e.workerFarm||new e({}),e.workerFarm.setProps(t),e.workerFarm},e.prototype.destroy=function(){var t,r;try{for(var n=vo(this.workerPools.values()),i=n.next();!i.done;i=n.next()){var a=i.value;a.destroy()}}catch(s){t={error:s}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(t)throw t.error}}},e.prototype.setProps=function(t){var r,n;this.props=xa(xa({},this.props),t);try{for(var i=vo(this.workerPools.values()),a=i.next();!a.done;a=i.next()){var s=a.value;s.setProps(this.getWorkerPoolProps())}}catch(l){r={error:l}}finally{try{a&&!a.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}},e.prototype.getWorkerPool=function(t){var r=t.name,n=t.source,i=t.url,a=this.workerPools.get(r);return a||(a=new oo({name:r,source:n,url:i}),a.setProps(this.getWorkerPoolProps()),this.workerPools.set(r,a)),a},e.prototype.getWorkerPoolProps=function(){return{maxConcurrency:this.props.maxConcurrency,maxMobileConcurrency:this.props.maxMobileConcurrency,reuseWorkers:this.props.reuseWorkers,onDebug:this.props.onDebug}},e}(),Yr=null,_n=new Map,ri=function(){function e(){}return Object.defineProperty(e,"onmessage",{set:function(t){self.onmessage=function(r){if(oi(r)){var n=r.data,i=n.type,a=n.payload;t(i,a)}}},enumerable:!1,configurable:!0}),e.addEventListener=function(t){var r=_n.get(t);r||(r=function(n){if(oi(n)){var i=n.data,a=i.type,s=i.payload;t(a,s)}}),self.addEventListener("message",r)},e.removeEventListener=function(t){var r=_n.get(t);_n.delete(t),self.removeEventListener("message",r)},e.postMessage=function(t,r){if(self){var n={source:"Worker thread",type:t,payload:r},i=Gt(r);self.postMessage(n,i)}},e}(),Hn=null;function oi(e){var t=e.type,r=e.data;return t==="message"&&r&&typeof r.source=="string"&&r.source==="Main thread"}function Zn(e){return JSON.parse(Ki(e))}function Ki(e){var t=new Set;return JSON.stringify(e,function(r,n){if(typeof n=="object"&&n!==null){if(t.has(n))try{return JSON.parse(JSON.stringify(n))}catch(i){return}t.add(n)}return n})}function Ci(e){return""+e.name}function gn(e,t){t===void 0&&(t={});var r=t[e.id]||{},n=e.name+".worker.js",i=r.workerUrl;return t._workerType==="test"&&(i=e.module+"/dist/"+n),i||(i="https://unpkg.com/"+e.module+"/dist/"+n),assert(i),i}var je=function(e,t,r,n){function i(a){return a instanceof r?a:new r(function(s){s(a)})}return new(r||(r=Promise))(function(a,s){function l(T){try{m(n.next(T))}catch(R){s(R)}}function p(T){try{m(n.throw(T))}catch(R){s(R)}}function m(T){T.done?a(T.value):i(T.value).then(l,p)}m((n=n.apply(e,t||[])).next())})},Nl=function(e,t){var r={label:0,sent:function(){if(a[0]&1)throw a[1];return a[1]},trys:[],ops:[]},n,i,a,s;return s={next:l(0),throw:l(1),return:l(2)},typeof Symbol=="function"&&(s[Symbol.iterator]=function(){return this}),s;function l(m){return function(T){return p([m,T])}}function p(m){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,i&&(a=m[0]&2?i.return:m[0]?i.throw||((a=i.return)&&a.call(i),0):i.next)&&!(a=a.call(i,m[1])).done)return a;switch(i=0,a&&(m=[m[0]&2,a.value]),m[0]){case 0:case 1:a=m;break;case 4:return r.label++,{value:m[1],done:!1};case 5:r.label++,i=m[1],m=[0];continue;case 7:m=r.ops.pop(),r.trys.pop();continue;default:if(a=r.trys,!(a=a.length>0&&a[a.length-1])&&(m[0]===6||m[0]===2)){r=0;continue}if(m[0]===3&&(!a||m[1]>a[0]&&m[1]<a[3])){r.label=m[1];break}if(m[0]===6&&r.label<a[1]){r.label=a[1],a=m;break}if(a&&r.label<a[2]){r.label=a[2],r.ops.push(m);break}a[2]&&r.ops.pop(),r.trys.pop();continue}m=t.call(e,r)}catch(T){m=[6,T],i=0}finally{n=a=0}if(m[0]&5)throw m[1];return{value:m[0]?m[1]:void 0,done:!0}}};function zi(e,t){return WorkerFarm.isSupported()?e.worker&&(t==null?void 0:t.worker):!1}function ct(e,t,r,n){return r===void 0&&(r={}),n===void 0&&(n={}),je(this,void 0,void 0,function(){var i,a,s,l,p,m,T,R;return Nl(this,function(L){switch(L.label){case 0:return i=getWorkerName(e),a=getWorkerURL(e,r),s=WorkerFarm.getWorkerFarm(r),l=s.getWorkerPool({name:i,url:a}),p=r.jobName||e.name,[4,l.startJob(p,bi.bind(null,n))];case 1:return m=L.sent(),T=removeNontransferableOptions(r),m.postMessage("process",{input:t,options:T}),[4,m.result];case 2:return R=L.sent(),[2,R.result]}})})}function bi(e,t,r,n){return je(this,void 0,void 0,function(){var i,a,s,l,p,m,T;return Nl(this,function(R){switch(R.label){case 0:switch(i=r,i){case"done":return[3,1];case"error":return[3,2];case"process":return[3,3]}return[3,8];case 1:return t.done(n),[3,9];case 2:return t.error(new Error(n.error)),[3,9];case 3:a=n.id,s=n.input,l=n.options,R.label=4;case 4:return R.trys.push([4,6,,7]),e.process?[4,e.process(s,l)]:(t.postMessage("error",{id:a,error:"Worker not set up to process on main thread"}),[2]);case 5:return p=R.sent(),t.postMessage("done",{id:a,result:p}),[3,7];case 6:return m=R.sent(),T=m instanceof Error?m.message:"unknown error",t.postMessage("error",{id:a,error:T}),[3,7];case 7:return[3,9];case 8:console.warn("process-on-worker: unknown message "+r),R.label=9;case 9:return[2]}})})}var lf=function(){function e(){this._values=[],this._settlers=[],this._closed=!1}return e.prototype[Symbol.asyncIterator]=function(){return this},e.prototype.push=function(t){return this.enqueue(t)},e.prototype.enqueue=function(t){if(this._closed)throw new Error("Closed");if(this._settlers.length>0){if(this._values.length>0)throw new Error("Illegal internal state");var r=this._settlers.shift();t instanceof Error?r.reject(t):r.resolve({value:t})}else this._values.push(t)},e.prototype.close=function(){for(;this._settlers.length>0;){var t=this._settlers.shift();t.resolve({done:!0})}this._closed=!0},e.prototype.next=function(){var t=this;if(this._values.length>0){var r=this._values.shift();return r instanceof Error?Promise.reject(r):Promise.resolve({done:!1,value:r})}if(this._closed){if(this._settlers.length>0)throw new Error("Illegal internal state");return Promise.resolve({done:!0,value:void 0})}return new Promise(function(n,i){t._settlers.push({resolve:n,reject:i})})},e}(),Nh=null,cf=function(e,t,r,n){function i(a){return a instanceof r?a:new r(function(s){s(a)})}return new(r||(r=Promise))(function(a,s){function l(T){try{m(n.next(T))}catch(R){s(R)}}function p(T){try{m(n.throw(T))}catch(R){s(R)}}function m(T){T.done?a(T.value):i(T.value).then(l,p)}m((n=n.apply(e,t||[])).next())})},y0=function(e,t){var r={label:0,sent:function(){if(a[0]&1)throw a[1];return a[1]},trys:[],ops:[]},n,i,a,s;return s={next:l(0),throw:l(1),return:l(2)},typeof Symbol=="function"&&(s[Symbol.iterator]=function(){return this}),s;function l(m){return function(T){return p([m,T])}}function p(m){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,i&&(a=m[0]&2?i.return:m[0]?i.throw||((a=i.return)&&a.call(i),0):i.next)&&!(a=a.call(i,m[1])).done)return a;switch(i=0,a&&(m=[m[0]&2,a.value]),m[0]){case 0:case 1:a=m;break;case 4:return r.label++,{value:m[1],done:!1};case 5:r.label++,i=m[1],m=[0];continue;case 7:m=r.ops.pop(),r.trys.pop();continue;default:if(a=r.trys,!(a=a.length>0&&a[a.length-1])&&(m[0]===6||m[0]===2)){r=0;continue}if(m[0]===3&&(!a||m[1]>a[0]&&m[1]<a[3])){r.label=m[1];break}if(m[0]===6&&r.label<a[1]){r.label=a[1],a=m;break}if(a&&r.label<a[2]){r.label=a[2],r.ops.push(m);break}a[2]&&r.ops.pop(),r.trys.pop();continue}m=t.call(e,r)}catch(T){m=[6,T],i=0}finally{n=a=0}if(m[0]&5)throw m[1];return{value:m[0]?m[1]:void 0,done:!0}}},Dh=function(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t=e[Symbol.asyncIterator],r;return t?t.call(e):(e=typeof __values=="function"?__values(e):e[Symbol.iterator](),r={},n("next"),n("throw"),n("return"),r[Symbol.asyncIterator]=function(){return this},r);function n(a){r[a]=e[a]&&function(s){return new Promise(function(l,p){s=e[a](s),i(l,p,s.done,s.value)})}}function i(a,s,l,p){Promise.resolve(p).then(function(m){a({value:m,done:l})},s)}},nt=0,Lf,E0;function Y0(e,t){var r=this;if(typeof self!="undefined"){var n={process:$0};WorkerBody.onmessage=function(i,a){return cf(r,void 0,void 0,function(){var s,l,p,m,T,R,L,z,re,ee,me;return y0(this,function(Ie){switch(Ie.label){case 0:switch(Ie.trys.push([0,19,,20]),s=i,s){case"process":return[3,1];case"process-in-batches":return[3,3];case"input-batch":return[3,16];case"input-done":return[3,17]}return[3,18];case 1:if(!e)throw new Error("Worker does not support atomic processing");return[4,e(a.input,a.options||{},n)];case 2:return l=Ie.sent(),WorkerBody.postMessage("done",{result:l}),[3,18];case 3:if(!t)throw new Error("Worker does not support batched processing");Lf=new AsyncQueue,E0=a.options||{},p=t(Lf,E0,n),Ie.label=4;case 4:Ie.trys.push([4,9,10,15]),m=Dh(p),Ie.label=5;case 5:return[4,m.next()];case 6:if(T=Ie.sent(),!!T.done)return[3,8];R=T.value,WorkerBody.postMessage("output-batch",{result:R}),Ie.label=7;case 7:return[3,5];case 8:return[3,15];case 9:return L=Ie.sent(),ee={error:L},[3,15];case 10:return Ie.trys.push([10,,13,14]),T&&!T.done&&(me=m.return)?[4,me.call(m)]:[3,12];case 11:Ie.sent(),Ie.label=12;case 12:return[3,14];case 13:if(ee)throw ee.error;return[7];case 14:return[7];case 15:return WorkerBody.postMessage("done",{}),[3,18];case 16:return Lf.push(a.input),[3,18];case 17:return Lf.close(),[3,18];case 18:return[3,20];case 19:return z=Ie.sent(),re=z instanceof Error?z.message:"",WorkerBody.postMessage("error",{error:re}),[3,20];case 20:return[2]}})})}}}function $0(e,t){return t===void 0&&(t={}),new Promise(function(r,n){var i=nt++,a=function(l,p){if(p.id===i)switch(l){case"done":WorkerBody.removeEventListener(a),r(p.result);break;case"error":WorkerBody.removeEventListener(a),n(p.error);break;default:}};WorkerBody.addEventListener(a);var s={id:i,input:e,options:t};WorkerBody.postMessage("process",s)})}var S0=function(e,t,r,n){function i(a){return a instanceof r?a:new r(function(s){s(a)})}return new(r||(r=Promise))(function(a,s){function l(T){try{m(n.next(T))}catch(R){s(R)}}function p(T){try{m(n.throw(T))}catch(R){s(R)}}function m(T){T.done?a(T.value):i(T.value).then(l,p)}m((n=n.apply(e,t||[])).next())})},Q0=function(e,t){var r={label:0,sent:function(){if(a[0]&1)throw a[1];return a[1]},trys:[],ops:[]},n,i,a,s;return s={next:l(0),throw:l(1),return:l(2)},typeof Symbol=="function"&&(s[Symbol.iterator]=function(){return this}),s;function l(m){return function(T){return p([m,T])}}function p(m){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,i&&(a=m[0]&2?i.return:m[0]?i.throw||((a=i.return)&&a.call(i),0):i.next)&&!(a=a.call(i,m[1])).done)return a;switch(i=0,a&&(m=[m[0]&2,a.value]),m[0]){case 0:case 1:a=m;break;case 4:return r.label++,{value:m[1],done:!1};case 5:r.label++,i=m[1],m=[0];continue;case 7:m=r.ops.pop(),r.trys.pop();continue;default:if(a=r.trys,!(a=a.length>0&&a[a.length-1])&&(m[0]===6||m[0]===2)){r=0;continue}if(m[0]===3&&(!a||m[1]>a[0]&&m[1]<a[3])){r.label=m[1];break}if(m[0]===6&&r.label<a[1]){r.label=a[1],a=m;break}if(a&&r.label<a[2]){r.label=a[2],r.ops.push(m);break}a[2]&&r.ops.pop(),r.trys.pop();continue}m=t.call(e,r)}catch(T){m=[6,T],i=0}finally{n=a=0}if(m[0]&5)throw m[1];return{value:m[0]?m[1]:void 0,done:!0}}},Ff={};function q0(e,t,r){return t===void 0&&(t=null),r===void 0&&(r={}),S0(this,void 0,void 0,function(){return Q0(this,function(n){switch(n.label){case 0:return t&&(e=K0(e,t,r)),Ff[e]=Ff[e]||hl(e),[4,Ff[e]];case 1:return[2,n.sent()]}})})}function K0(e,t,r){if(e.startsWith("http"))return e;var n=r.modules||{};return n[e]?n[e]:r.CDN?(assert(r.CDN.startsWith("http")),r.CDN+"/"+t+"/dist/libs/"+e):isWorker?"../src/libs/"+e:"modules/"+t+"/src/libs/"+e}function hl(e){return S0(this,void 0,void 0,function(){var t,r,n;return Q0(this,function(i){switch(i.label){case 0:return e.endsWith("wasm")?[4,fetch(e)]:[3,3];case 1:return t=i.sent(),[4,t.arrayBuffer()];case 2:return[2,i.sent()];case 3:return isWorker?[2,importScripts(e)]:[4,fetch(e)];case 4:return r=i.sent(),[4,r.text()];case 5:return n=i.sent(),[2,Ss(n,e)]}})})}function Ss(e,t){if(isWorker)return eval.call(global,e),null;var r=document.createElement("script");r.id=t;try{r.appendChild(document.createTextNode(e))}catch(n){r.text=e}return document.body.appendChild(r),null}var J0="0.0.3",Lh={id:"null",name:"null",module:"web-worker-helper",options:{}};function x0(e){var t=e.color;return!t||!t.length?[1,1,1,1]:t}function dc(e,t,r){return r.length===2?[r[0],r[1],0]:[r[0],r[1],r[2]]}function Zc(e){var t=e.filter;return t?[1]:[0]}function Bf(e,t){return[t]}var eh=C(80569),_a=C.n(eh),Ja=1e-6,xs=typeof Float32Array!="undefined"?Float32Array:Array,qf=Math.random;function xA(e){xs=e}var T0=Math.PI/180;function C0(e){return e*T0}function b0(e,t){return Math.abs(e-t)<=Ja*Math.max(1,Math.abs(e),Math.abs(t))}Math.hypot||(Math.hypot=function(){for(var e=0,t=arguments.length;t--;)e+=arguments[t]*arguments[t];return Math.sqrt(e)});function ji(){var e=new xs(2);return xs!=Float32Array&&(e[0]=0,e[1]=0),e}function R0(e){var t=new glMatrix.ARRAY_TYPE(2);return t[0]=e[0],t[1]=e[1],t}function ec(e,t){var r=new xs(2);return r[0]=e,r[1]=t,r}function fs(e,t){return e[0]=t[0],e[1]=t[1],e}function zc(e,t,r){return e[0]=t,e[1]=r,e}function Qa(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e}function Xu(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e}function Kf(e,t,r){return e[0]=t[0]*r[0],e[1]=t[1]*r[1],e}function ff(e,t,r){return e[0]=t[0]/r[0],e[1]=t[1]/r[1],e}function $o(e,t){return e[0]=Math.ceil(t[0]),e[1]=Math.ceil(t[1]),e}function Yu(e,t){return e[0]=Math.floor(t[0]),e[1]=Math.floor(t[1]),e}function Gs(e,t,r){return e[0]=Math.min(t[0],r[0]),e[1]=Math.min(t[1],r[1]),e}function Jf(e,t,r){return e[0]=Math.max(t[0],r[0]),e[1]=Math.max(t[1],r[1]),e}function e0(e,t){return e[0]=Math.round(t[0]),e[1]=Math.round(t[1]),e}function t0(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e}function Fh(e,t,r,n){return e[0]=t[0]+r[0]*n,e[1]=t[1]+r[1]*n,e}function kf(e,t){var r=t[0]-e[0],n=t[1]-e[1];return Math.hypot(r,n)}function hf(e,t){var r=t[0]-e[0],n=t[1]-e[1];return r*r+n*n}function Bh(e){var t=e[0],r=e[1];return Math.hypot(t,r)}function r0(e){var t=e[0],r=e[1];return t*t+r*r}function vc(e,t){return e[0]=-t[0],e[1]=-t[1],e}function th(e,t){return e[0]=1/t[0],e[1]=1/t[1],e}function $u(e,t){var r=t[0],n=t[1],i=r*r+n*n;return i>0&&(i=1/Math.sqrt(i)),e[0]=t[0]*i,e[1]=t[1]*i,e}function Dl(e,t){return e[0]*t[0]+e[1]*t[1]}function Ll(e,t,r){var n=t[0]*r[1]-t[1]*r[0];return e[0]=e[1]=0,e[2]=n,e}function gc(e,t,r,n){var i=t[0],a=t[1];return e[0]=i+n*(r[0]-i),e[1]=a+n*(r[1]-a),e}function kh(e,t){t=t||1;var r=glMatrix.RANDOM()*2*Math.PI;return e[0]=Math.cos(r)*t,e[1]=Math.sin(r)*t,e}function Uh(e,t,r){var n=t[0],i=t[1];return e[0]=r[0]*n+r[2]*i,e[1]=r[1]*n+r[3]*i,e}function M0(e,t,r){var n=t[0],i=t[1];return e[0]=r[0]*n+r[2]*i+r[4],e[1]=r[1]*n+r[3]*i+r[5],e}function TA(e,t,r){var n=t[0],i=t[1];return e[0]=r[0]*n+r[3]*i+r[6],e[1]=r[1]*n+r[4]*i+r[7],e}function CA(e,t,r){var n=t[0],i=t[1];return e[0]=r[0]*n+r[4]*i+r[12],e[1]=r[1]*n+r[5]*i+r[13],e}function Zh(e,t,r,n){var i=t[0]-r[0],a=t[1]-r[1],s=Math.sin(n),l=Math.cos(n);return e[0]=i*l-a*s+r[0],e[1]=i*s+a*l+r[1],e}function zh(e,t){var r=e[0],n=e[1],i=t[0],a=t[1],s=Math.sqrt(r*r+n*n)*Math.sqrt(i*i+a*a),l=s&&(r*i+n*a)/s;return Math.acos(Math.min(Math.max(l,-1),1))}function rh(e){return e[0]=0,e[1]=0,e}function bA(e){return"vec2("+e[0]+", "+e[1]+")"}function Up(e,t){return e[0]===t[0]&&e[1]===t[1]}function Gh(e,t){var r=e[0],n=e[1],i=t[0],a=t[1];return Math.abs(r-i)<=glMatrix.EPSILON*Math.max(1,Math.abs(r),Math.abs(i))&&Math.abs(n-a)<=glMatrix.EPSILON*Math.max(1,Math.abs(n),Math.abs(a))}var RA=null,Gc=Xu,w0=null,Vc=null,nh=null,ih=null,Vh=null,Af=function(){var e=ji();return function(t,r,n,i,a,s){var l,p;for(r||(r=2),n||(n=0),i?p=Math.min(i*r+n,t.length):p=t.length,l=n;l<p;l+=r)e[0]=t[l],e[1]=t[l+1],a(e,e,s),t[l]=e[0],t[l+1]=e[1];return t}}(),pf=ji(),n0=ji(),Vo=ji(),Au=ji(),mc=ji();function Hc(e,t,r,n,i){Qa(e,r,n),$u(e,e),t=ec(-e[1],e[0]);var a=ec(-r[1],r[0]);return[i/Dl(t,a),t]}function Qu(e,t){return zc(e,-t[1],t[0])}function tc(e,t,r){return Gc(e,t,r),$u(e,e),e}function Wc(e,t){return e[0]===t[0]&&e[1]===t[1]}function df(e){for(var t=new Map,r=0;r<e.length;r++){var n=e[0].toString()+"-"+e[1].toString();t.get(n)?(e.splice(r,1),r++):t.set(n,n)}return e}var _c=function(){function e(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};(0,ue.Z)(this,e),(0,ve.Z)(this,"lastFlip",-1),(0,ve.Z)(this,"miter",ec(0,0)),(0,ve.Z)(this,"started",!1),(0,ve.Z)(this,"dash",!1),(0,ve.Z)(this,"totalDistance",0),(0,ve.Z)(this,"currentIndex",0),this.join=t.join||"miter",this.cap=t.cap||"butt",this.miterLimit=t.miterLimit||10,this.thickness=t.thickness||1,this.dash=t.dash||!1,this.complex={positions:[],indices:[],normals:[],startIndex:0,indexes:[]}}return(0,_e.Z)(e,[{key:"extrude_gaode2",value:function(r,n){var i=this.complex;if(r.length<=1)return i;this.lastFlip=-1,this.started=!1,this.normal=null,this.totalDistance=0;for(var a=r.length,s=i.startIndex,l=1;l<a;l++){var p,m,T,R=r[l-1];R.push((p=n[l-1][2])!==null&&p!==void 0?p:0);var L=n[l-1],z=r[l];z.push((m=n[l][2])!==null&&m!==void 0?m:0);var re=n[l],ee=l<r.length-1?[].concat((0,cr.Z)(r[l+1]),[(T=n[l+1][2])!==null&&T!==void 0?T:0]):null,me=l<n.length-1?n[l+1]:null,Ie=this.segment_gaode2(i,s,R,z,ee,L,re,me);s+=Ie}if(this.dash)for(var He=0;He<i.positions.length/6;He++)i.positions[He*6+5]=this.totalDistance;return i.startIndex=i.positions.length/6,i}},{key:"simpleExtrude_gaode2",value:function(r,n){var i=this.complex;if(r.length<=1)return i;this.lastFlip=-1,this.started=!1,this.normal=null,this.totalDistance=0;for(var a=r.length,s=i.startIndex,l=1;l<a;l++){var p,m,T,R=r[l-1];R.push((p=n[l-1][2])!==null&&p!==void 0?p:0);var L=n[l-1],z=r[l];z.push((m=n[l][2])!==null&&m!==void 0?m:0);var re=n[l],ee=l<r.length-1?[].concat((0,cr.Z)(r[l+1]),[(T=n[l+1][2])!==null&&T!==void 0?T:0]):null,me=l<n.length-1?n[l+1]:null,Ie=this.simpleSegment(i,s,R,z,ee,L,re,me);s+=Ie}if(this.dash)for(var He=0;He<i.positions.length/6;He++)i.positions[He*6+5]=this.totalDistance;return i.startIndex=i.positions.length/6,i}},{key:"extrude",value:function(r){var n=this.complex;if(r.length<=1)return n;this.lastFlip=-1,this.started=!1,this.normal=null,this.totalDistance=0;for(var i=r.length,a=n.startIndex,s=1;s<i;s++){var l=r[s-1],p=r[s],m=s<r.length-1?r[s+1]:null,T=this.segment(n,a,l,p,m);a+=T}if(this.dash)for(var R=0;R<n.positions.length/6;R++)n.positions[R*6+5]=this.totalDistance;return n.startIndex=n.positions.length/6,n}},{key:"simpleExtrude",value:function(r){var n=this.complex;if(r.length<=1)return n;this.lastFlip=-1,this.started=!1,this.normal=null,this.totalDistance=0;for(var i=r.length,a=n.startIndex,s=1;s<i;s++){var l=r[s-1],p=r[s],m=s<r.length-1?r[s+1]:null,T=this.simpleSegment(n,a,l,p,m);a+=T}if(this.dash)for(var R=0;R<n.positions.length/6;R++)n.positions[R*6+5]=this.totalDistance;return n.startIndex=n.positions.length/6,n}},{key:"segment_gaode2",value:function(r,n,i,a,s,l,p,m){var T=0,R=r.indices,L=r.positions,z=r.normals,re=this.cap==="square",ee=this.join==="bevel",me=Na([p[0],p[1]]),Ie=Na([l[0],l[1]]);tc(Vo,a,i);var He=0;if(this.dash&&(He=this.lineSegmentDistance(me,Ie),this.totalDistance+=He),this.normal||(this.normal=ji(),Qu(this.normal,Vo)),!this.started)if(this.started=!0,re){var Xe=ji(),ot=ji();Qa(Xe,this.normal,Vo),Qa(ot,this.normal,Vo),z.push(ot[0],ot[1],0),z.push(Xe[0],Xe[1],0),L.push(i[0],i[1],i[2]|0,this.totalDistance-He,-this.thickness,i[2]|0),this.complex.indexes.push(this.currentIndex),L.push(i[0],i[1],i[2]|0,this.totalDistance-He,this.thickness,i[2]|0),this.complex.indexes.push(this.currentIndex),this.currentIndex++}else this.extrusions(L,z,i,this.normal,this.thickness,this.totalDistance-He);if(R.push(n+0,n+1,n+2),s){Wc(a,s)&&Qa(s,a,$u(s,Xu(s,a,i))),tc(Au,s,a);var It=Hc(mc,ji(),Vo,Au,this.thickness),Vt=(0,yn.Z)(It,2),Kt=Vt[0],yr=Vt[1],_r=Dl(mc,this.normal)<0?-1:1,Hr=ee;if(!Hr&&this.join==="miter"){var nn=Kt;nn>this.miterLimit&&(Hr=!0)}Hr?(z.push(this.normal[0],this.normal[1],0),z.push(yr[0],yr[1],0),L.push(a[0],a[1],a[2]|0,this.totalDistance,-this.thickness*_r,a[2]|0),this.complex.indexes.push(this.currentIndex),L.push(a[0],a[1],a[2]|0,this.totalDistance,this.thickness*_r,a[2]|0),this.complex.indexes.push(this.currentIndex),this.currentIndex++,R.push.apply(R,(0,cr.Z)(this.lastFlip!==-_r?[n,n+2,n+3]:[n+2,n+1,n+3])),R.push(n+2,n+3,n+4),Qu(pf,Au),fs(this.normal,pf),z.push(this.normal[0],this.normal[1],0),L.push(a[0],a[1],a[2]|0,this.totalDistance,-this.thickness*_r,a[2]|0),this.complex.indexes.push(this.currentIndex),this.currentIndex++,T+=3):(this.extrusions(L,z,a,yr,Kt,this.totalDistance),R.push.apply(R,(0,cr.Z)(this.lastFlip===1?[n,n+2,n+3]:[n+2,n+1,n+3])),_r=-1,fs(this.normal,yr),T+=2),this.lastFlip=_r}else{if(Qu(this.normal,Vo),re){var pt=ji(),dt=ji();Gc(dt,Vo,this.normal),Qa(pt,Vo,this.normal),z.push(dt[0],dt[1],0),z.push(pt[0],pt[1],0),L.push(a[0],a[1],a[2]|0,this.totalDistance,this.thickness,a[2]|0),this.complex.indexes.push(this.currentIndex),L.push(a[0],a[1],a[2]|0,this.totalDistance,this.thickness,a[2]|0),this.complex.indexes.push(this.currentIndex),this.currentIndex++}else this.extrusions(L,z,a,this.normal,this.thickness,this.totalDistance);R.push.apply(R,(0,cr.Z)(this.lastFlip===1?[n,n+2,n+3]:[n+2,n+1,n+3])),T+=2}return T}},{key:"simpleSegment",value:function(r,n,i,a,s){var l=0,p=r.indices,m=r.positions,T=r.normals,R=Na([a[0],a[1]]),L=Na([i[0],i[1]]);tc(Vo,R,L);var z=0;if(this.dash&&(z=this.lineSegmentDistance(R,L),this.totalDistance+=z),this.normal||(this.normal=ji(),Qu(this.normal,Vo)),this.started||(this.started=!0,this.extrusions(m,T,i,this.normal,this.thickness,this.totalDistance-z)),p.push(n+0,n+1,n+2),!s)Qu(this.normal,Vo),this.extrusions(m,T,a,this.normal,this.thickness,this.totalDistance),p.push.apply(p,(0,cr.Z)(this.lastFlip===1?[n,n+2,n+3]:[n+2,n+1,n+3])),l+=2;else{var re=Na([s[0],s[1]]);Wc(R,re)&&Qa(re,R,$u(re,Xu(re,R,L))),tc(Au,re,R);var ee=Hc(mc,ji(),Vo,Au,this.thickness),me=(0,yn.Z)(ee,2),Ie=me[0],He=me[1],Xe=Dl(mc,this.normal)<0?-1:1;this.extrusions(m,T,a,He,Ie,this.totalDistance),p.push.apply(p,(0,cr.Z)(this.lastFlip===1?[n,n+2,n+3]:[n+2,n+1,n+3])),Xe=-1,fs(this.normal,He),l+=2,this.lastFlip=Xe}return l}},{key:"segment",value:function(r,n,i,a,s){var l=0,p=r.indices,m=r.positions,T=r.normals,R=this.cap==="square",L=this.join==="bevel",z=Na([a[0],a[1]]),re=Na([i[0],i[1]]);tc(Vo,z,re);var ee=0;if(this.dash&&(ee=this.lineSegmentDistance(z,re),this.totalDistance+=ee),this.normal||(this.normal=ji(),Qu(this.normal,Vo)),!this.started)if(this.started=!0,R){var me=ji(),Ie=ji();Qa(me,this.normal,Vo),Qa(Ie,this.normal,Vo),T.push(Ie[0],Ie[1],0),T.push(me[0],me[1],0),m.push(i[0],i[1],i[2]|0,this.totalDistance-ee,-this.thickness,i[2]|0),this.complex.indexes.push(this.currentIndex),m.push(i[0],i[1],i[2]|0,this.totalDistance-ee,this.thickness,i[2]|0),this.complex.indexes.push(this.currentIndex),this.currentIndex++}else this.extrusions(m,T,i,this.normal,this.thickness,this.totalDistance-ee);if(p.push(n+0,n+1,n+2),s){var ot=Na([s[0],s[1]]);Wc(z,ot)&&Qa(ot,z,$u(ot,Xu(ot,z,re))),tc(Au,ot,z);var pt=Hc(mc,ji(),Vo,Au,this.thickness),dt=(0,yn.Z)(pt,2),It=dt[0],Vt=dt[1],Kt=Dl(mc,this.normal)<0?-1:1,yr=L;if(!yr&&this.join==="miter"){var _r=It;_r>this.miterLimit&&(yr=!0)}yr?(T.push(this.normal[0],this.normal[1],0),T.push(Vt[0],Vt[1],0),m.push(a[0],a[1],a[2]|0,this.totalDistance,-this.thickness*Kt,a[2]|0),this.complex.indexes.push(this.currentIndex),m.push(a[0],a[1],a[2]|0,this.totalDistance,this.thickness*Kt,a[2]|0),this.complex.indexes.push(this.currentIndex),this.currentIndex++,p.push.apply(p,(0,cr.Z)(this.lastFlip!==-Kt?[n,n+2,n+3]:[n+2,n+1,n+3])),p.push(n+2,n+3,n+4),Qu(pf,Au),fs(this.normal,pf),T.push(this.normal[0],this.normal[1],0),m.push(a[0],a[1],a[2]|0,this.totalDistance,-this.thickness*Kt,a[2]|0),this.complex.indexes.push(this.currentIndex),this.currentIndex++,l+=3):(this.extrusions(m,T,a,Vt,It,this.totalDistance),p.push.apply(p,(0,cr.Z)(this.lastFlip===1?[n,n+2,n+3]:[n+2,n+1,n+3])),Kt=-1,fs(this.normal,Vt),l+=2),this.lastFlip=Kt}else{if(Qu(this.normal,Vo),R){var He=ji(),Xe=ji();Gc(Xe,Vo,this.normal),Qa(He,Vo,this.normal),T.push(Xe[0],Xe[1],0),T.push(He[0],He[1],0),m.push(a[0],a[1],a[2]|0,this.totalDistance,this.thickness,a[2]|0),this.complex.indexes.push(this.currentIndex),m.push(a[0],a[1],a[2]|0,this.totalDistance,this.thickness,a[2]|0),this.complex.indexes.push(this.currentIndex),this.currentIndex++}else this.extrusions(m,T,a,this.normal,this.thickness,this.totalDistance);p.push.apply(p,(0,cr.Z)(this.lastFlip===1?[n,n+2,n+3]:[n+2,n+1,n+3])),l+=2}return l}},{key:"extrusions",value:function(r,n,i,a,s,l){n.push(a[0],a[1],0),n.push(a[0],a[1],0),r.push(i[0],i[1],i[2]|0,l,-s,i[2]|0),this.complex.indexes.push(this.currentIndex),r.push(i[0],i[1],i[2]|0,l,s,i[2]|0),this.complex.indexes.push(this.currentIndex),this.currentIndex++}},{key:"lineSegmentDistance",value:function(r,n){var i=n[0]-r[0],a=n[1]-r[1];return Math.sqrt(i*i+a*a)}}]),e}();function vf(e){var t=e.coordinates,r=e.originCoordinates,n=e.version,i=new _c({dash:!0,join:"bevel"});if(n==="GAODE2.x"){var a=t;Array.isArray(a[0][0])||(a=[t]);var s=r;Array.isArray(s[0][0])||(s=[r]);for(var l=0;l<a.length;l++){var p=a[l],m=s[l];i.extrude_gaode2(p,m)}}else{var T=t;T[0]&&!Array.isArray(T[0][0])&&(T=[t]),T.forEach(function(L){i.extrude(L)})}var R=i.complex;return{vertices:R.positions,indices:R.indices,normals:R.normals,indexes:R.indexes,size:6}}function wa(e){var t=Du(e.coordinates);return{vertices:[].concat((0,cr.Z)(t),(0,cr.Z)(t),(0,cr.Z)(t),(0,cr.Z)(t)),indices:[0,1,2,2,3,0],size:t.length}}function yc(e){var t=e.coordinates,r=_a().flatten(t),n=r.vertices,i=r.dimensions,a=r.holes,s=_a()(n,a,i);return{indices:s,vertices:n,size:i}}var Uf=function(){var e=(0,hr.Z)(it().mark(function t(r){var n,i,a,s,l,p,m,T,R;return it().wrap(function(z){for(;;)switch(z.prev=z.next){case 0:return n=r.descriptors,i=r.features,a=r.enablePicking,s=r.iconMap,l={a_Color:x0,a_Position:dc,filter:Zc,a_vertexId:Bf,a_PickingColor:function(ee){var me=ee.id;return a?Ws(me):[0,0,0]},a_DistanceAndIndex:function(ee,me,Ie,He,Xe,ot){return ot===void 0?[Ie[3],10]:[Ie[3],ot]},a_Total_Distance:function(ee,me,Ie){return[Ie[5]]},a_Size:function(ee){var me=ee.size,Ie=me===void 0?1:me;return Array.isArray(Ie)?[Ie[0],Ie[1]]:[Ie,0]},a_Normal:function(ee,me,Ie,He,Xe){return Xe},a_Miter:function(ee,me,Ie){return[Ie[4]]},a_iconMapUV:function(ee){var me=ee.texture,Ie=s[me]||{x:0,y:0},He=Ie.x,Xe=Ie.y;return[He,Xe]}},p={sizePerElement:0,elements:[]},m=0,T=[],R=3,i.forEach(function(re,ee){var me=vf(re),Ie=me.indices,He=me.vertices,Xe=me.normals,ot=me.size,pt=me.indexes;Ie.forEach(function(Kt){T.push(Kt+m)}),R=ot;var dt=He.length/ot;p.sizePerElement=R,p.elements.push({featureIdx:ee,vertices:He,normals:Xe,offset:m}),m+=dt;for(var It=function(yr){var _r=(Xe==null?void 0:Xe.slice(yr*3,yr*3+3))||[],Hr=He.slice(yr*ot,yr*ot+ot),nn=0;pt&&pt[yr]!==void 0&&(nn=pt[yr]),n.forEach(function(Tn){if(Tn&&l[Tn.name]){var sa;(sa=Tn.buffer.data).push.apply(sa,(0,cr.Z)(l[Tn.name](re,ee,Hr,yr,_r,nn)))}})},Vt=0;Vt<dt;Vt++)It(Vt)}),z.abrupt("return",{descriptors:n,featureLayout:p,indices:T});case 8:case"end":return z.stop()}},t)}));return function(r){return e.apply(this,arguments)}}(),Ec=function(){var e=(0,hr.Z)(it().mark(function t(r){var n,i,a,s,l,p,m,T,R;return it().wrap(function(z){for(;;)switch(z.prev=z.next){case 0:return n=r.descriptors,i=r.features,a=r.enablePicking,s=r.shape2d,l={a_Color:x0,a_Position:dc,filter:Zc,a_vertexId:Bf,a_PickingColor:function(ee){var me=ee.id;return a?Ws(me):[0,0,0]},a_Shape:function(ee){var me=ee.shape,Ie=me===void 0?2:me,He=s.indexOf(Ie);return[He]},a_Extrude:function(ee,me,Ie,He){var Xe=[1,1,0,-1,1,0,-1,-1,0,1,-1,0],ot=He%4*3;return[Xe[ot],Xe[ot+1],Xe[ot+2]]},a_Size:function(ee){var me=ee.size,Ie=me===void 0?5:me;return Array.isArray(Ie)?[Ie[0]]:[Ie]}},p={sizePerElement:0,elements:[]},m=0,T=[],R=3,i.forEach(function(re,ee){var me=wa(re),Ie=me.indices,He=me.vertices,Xe=me.normals,ot=me.size,pt=me.indexes;Ie.forEach(function(Kt){T.push(Kt+m)}),R=ot;var dt=He.length/ot;p.sizePerElement=R,p.elements.push({featureIdx:ee,vertices:He,normals:Xe,offset:m}),m+=dt;for(var It=function(yr){var _r=(Xe==null?void 0:Xe.slice(yr*3,yr*3+3))||[],Hr=He.slice(yr*ot,yr*ot+ot),nn=0;pt&&pt[yr]!==void 0&&(nn=pt[yr]),n.forEach(function(Tn){if(Tn&&l[Tn.name]){var sa;(sa=Tn.buffer.data).push.apply(sa,(0,cr.Z)(l[Tn.name](re,ee,Hr,yr,_r,nn)))}})},Vt=0;Vt<dt;Vt++)It(Vt)}),z.abrupt("return",{descriptors:n,featureLayout:p,indices:T});case 8:case"end":return z.stop()}},t)}));return function(r){return e.apply(this,arguments)}}(),i0=function(){var e=(0,hr.Z)(it().mark(function t(r){var n,i,a,s,l,p,m,T;return it().wrap(function(L){for(;;)switch(L.prev=L.next){case 0:return n=r.descriptors,i=r.features,a=r.enablePicking,s={a_Color:x0,a_Position:dc,filter:Zc,a_vertexId:Bf,a_PickingColor:function(re){var ee=re.id;return a?Ws(ee):[0,0,0]}},l={sizePerElement:0,elements:[]},p=0,m=[],T=3,i.forEach(function(z,re){var ee=yc(z),me=ee.indices,Ie=ee.vertices,He=ee.normals,Xe=ee.size,ot=ee.indexes;me.forEach(function(Vt){m.push(Vt+p)}),T=Xe;var pt=Ie.length/Xe;l.sizePerElement=T,l.elements.push({featureIdx:re,vertices:Ie,normals:He,offset:p}),p+=pt;for(var dt=function(Kt){var yr=(He==null?void 0:He.slice(Kt*3,Kt*3+3))||[],_r=Ie.slice(Kt*Xe,Kt*Xe+Xe),Hr=0;ot&&ot[Kt]!==void 0&&(Hr=ot[Kt]),n.forEach(function(nn){if(nn&&s[nn.name]){var Tn;(Tn=nn.buffer.data).push.apply(Tn,(0,cr.Z)(s[nn.name](z,re,_r,Kt,yr,Hr)))}})},It=0;It<pt;It++)dt(It)}),L.abrupt("return",{descriptors:n,featureLayout:l,indices:m});case 8:case"end":return L.stop()}},t)}));return function(r){return e.apply(this,arguments)}}(),ah={pointFill:Ec,line:Uf,polygonFill:i0},Hh=(0,Q.Z)({},ah);function jc(e){return Ks.apply(this,arguments)}function Ks(){return Ks=_asyncToGenerator(_regeneratorRuntime.mark(function e(t){var r,n;return _regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(r=t.workerType,n=t.data,!Hh[r]){a.next=3;break}return a.abrupt("return",Hh[r](n));case 3:return a.abrupt("return",Promise.reject(new Error('Worker with type "'.concat(r,'" non-existent.'))));case 4:case"end":return a.stop()}},e)})),Ks.apply(this,arguments)}var Xc=new Map;function Fl(e,t){Xc.set(e,t)}function a0(e){var t=Xc.get(e);return t}var qu="l7-worker",oh=3,Ho=!0;function gf(e){registerWorkerSource(qu,e)}function Ku(){var e=getWorkerSource(qu);if(!e)throw new Error("get worker failed by workerName: ".concat(qu,"."));return e}function pu(e,t){return Sc.apply(this,arguments)}function Sc(){return Sc=_asyncToGenerator(_regeneratorRuntime.mark(function e(t,r){var n,i,a,s,l;return _regeneratorRuntime.wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return n=Ku(),i=WorkerFarm.getWorkerFarm({maxConcurrency:oh,reuseWorkers:Ho}),a=i.getWorkerPool({name:qu,source:n}),m.next=5,a.startJob(qu,function(T,R,L){return T.done(L)});case 5:return s=m.sent,s.postMessage("process",{input:{workerType:t,data:r}}),m.next=9,s.result;case 9:return l=m.sent,m.abrupt("return",l.result);case 11:case"end":return m.stop()}},e)})),Sc.apply(this,arguments)}var Yc=C(19947),o0=C.n(Yc);function I0(e,t){return e.map(function(r){return r[t]*1})}function Fu(e){return e===void 0?!1:!Array.isArray(e)&&e.data!==void 0}function Bl(e){return Array.isArray(e)?e.length===0?!1:!!Fu(e[0]):!1}function Po(e){return Array.isArray(e)?e.length===0||typeof e[0]=="number":!1}function Js(e){var t=Object.isFrozen(e)?Fn.cloneDeep(e):e;return o0()(t,!0),t}function s0(e,t){var r=t.x,n=t.y,i=t.x1,a=t.y1,s=t.coordinates,l=t.geometry,p=[];if(!Array.isArray(e))return{dataArray:[]};if(l)return e.filter(function(Ie){return Ie[l]&&Ie[l].type&&Ie[l].coordinates&&Ie[l].coordinates.length>0}).forEach(function(Ie,He){var Xe=Js(Ie[l]);(0,Ae.nG)(Xe,function(ot){var pt=(0,Pe.r7)(ot),dt=(0,Q.Z)((0,Q.Z)({},Ie),{},{_id:He,coordinates:pt});p.push(dt)})}),{dataArray:p};for(var m=0;m<e.length;m++){var T=e[m],R=[];if(s){var L="Polygon";Array.isArray(s[0])||(L="Point"),Array.isArray(s[0])&&!Array.isArray(s[0][0])&&(L="LineString");var z=Js({type:L,coordinates:T[s]});R=z.coordinates}else if(r&&n&&i&&a){var re=[parseFloat(T[r]),parseFloat(T[n])],ee=[parseFloat(T[i]),parseFloat(T[a])];R=[re,ee]}else r&&n&&(R=[parseFloat(T[r]),parseFloat(T[n])]);var me=(0,Q.Z)((0,Q.Z)({},T),{},{_id:m,coordinates:R});p.push(me)}return{dataArray:p}}function P0(e,t){var r=Se(e);return s0(r,t)}var eu=C(91002);function mf(e){for(var t=e.toString(),r=5381,n=t.length;n;)r=r*33^t.charCodeAt(--n);return r>>>0}function _f(e,t){return t===void 0?null:(0,eu.Z)(e.properties[t])*1==="number"?e.properties[t]*1:e.properties&&e.properties[t]?mf(e.properties[t]+"")%1000019:null}function Al(e,t){var r=[],n={};return e.features?(e.features=e.features.filter(function(i){var a=i.geometry;return i!=null&&a&&a.type&&a.coordinates&&a.coordinates.length>0}),e=Js(e),e.features.length===0?{dataArray:[],featureKeys:n}:((0,Ae.nG)(e,function(i,a){var s=_f(i,t==null?void 0:t.featureId);s===null&&(s=a);var l=s,p=(0,Pe.r7)(i),m=(0,Q.Z)((0,Q.Z)({},i.properties),{},{coordinates:p,_id:l});r.push(m)}),{dataArray:r,featureKeys:n})):(e.features=[],{dataArray:[]})}function u0(e,t,r,n){for(var i=n,a=r-t>>1,s=r-t,l,p=e[t],m=e[t+1],T=e[r],R=e[r+1],L=t+3;L<r;L+=3){var z=Wh(e[L],e[L+1],p,m,T,R);if(z>i)l=L,i=z;else if(z===i){var re=Math.abs(L-a);re<s&&(l=L,s=re)}}i>n&&(l-t>3&&u0(e,t,l,n),e[l+2]=i,r-l>3&&u0(e,l,r,n))}function Wh(e,t,r,n,i,a){var s=i-r,l=a-n;if(s!==0||l!==0){var p=((e-r)*s+(t-n)*l)/(s*s+l*l);p>1?(r=i,n=a):p>0&&(r+=s*p,n+=l*p)}return s=e-r,l=t-n,s*s+l*l}function yf(e,t,r,n){var i={id:typeof e=="undefined"?null:e,type:t,geometry:r,tags:n,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return O0(i),i}function O0(e){var t=e.geometry,r=e.type;if(r==="Point"||r==="MultiPoint"||r==="LineString")N0(e,t);else if(r==="Polygon"||r==="MultiLineString")for(var n=0;n<t.length;n++)N0(e,t[n]);else if(r==="MultiPolygon")for(n=0;n<t.length;n++)for(var i=0;i<t[n].length;i++)N0(e,t[n][i])}function N0(e,t){for(var r=0;r<t.length;r+=3)e.minX=Math.min(e.minX,t[r]),e.minY=Math.min(e.minY,t[r+1]),e.maxX=Math.max(e.maxX,t[r]),e.maxY=Math.max(e.maxY,t[r+1])}function sh(e,t){var r=[];if(e.type==="FeatureCollection")for(var n=0;n<e.features.length;n++)Ef(r,e.features[n],t,n);else e.type==="Feature"?Ef(r,e,t):Ef(r,{geometry:e},t);return r}function Ef(e,t,r,n){if(t.geometry){var i=t.geometry.coordinates,a=t.geometry.type,s=Math.pow(r.tolerance/((1<<r.maxZoom)*r.extent),2),l=[],p=t.id;if(r.promoteId?p=t.properties[r.promoteId]:r.generateId&&(p=n||0),a==="Point")Zf(i,l);else if(a==="MultiPoint")for(var m=0;m<i.length;m++)Zf(i[m],l);else if(a==="LineString")so(i,l,s,!1);else if(a==="MultiLineString")if(r.lineMetrics){for(m=0;m<i.length;m++)l=[],so(i[m],l,s,!1),e.push(yf(p,"LineString",l,t.properties));return}else zf(i,l,s,!1);else if(a==="Polygon")zf(i,l,s,!0);else if(a==="MultiPolygon")for(m=0;m<i.length;m++){var T=[];zf(i[m],T,s,!0),l.push(T)}else if(a==="GeometryCollection"){for(m=0;m<t.geometry.geometries.length;m++)Ef(e,{id:p,geometry:t.geometry.geometries[m],properties:t.properties},r,n);return}else throw new Error("Input data is not a valid GeoJSON object.");e.push(yf(p,a,l,t.properties))}}function Zf(e,t){t.push(xc(e[0])),t.push(Su(e[1])),t.push(0)}function so(e,t,r,n){for(var i,a,s=0,l=0;l<e.length;l++){var p=xc(e[l][0]),m=Su(e[l][1]);t.push(p),t.push(m),t.push(0),l>0&&(n?s+=(i*m-p*a)/2:s+=Math.sqrt(Math.pow(p-i,2)+Math.pow(m-a,2))),i=p,a=m}var T=t.length-3;t[2]=1,u0(t,0,T,r),t[T+2]=1,t.size=Math.abs(s),t.start=0,t.end=t.size}function zf(e,t,r,n){for(var i=0;i<e.length;i++){var a=[];so(e[i],a,r,n),t.push(a)}}function xc(e){return e/360+.5}function Su(e){var t=Math.sin(e*Math.PI/180),r=.5-.25*Math.log((1+t)/(1-t))/Math.PI;return r<0?0:r>1?1:r}function Te(e,t,r,n,i,a,s,l){if(r/=t,n/=t,a>=r&&s<n)return e;if(s<r||a>=n)return null;for(var p=[],m=0;m<e.length;m++){var T=e[m],R=T.geometry,L=T.type,z=i===0?T.minX:T.minY,re=i===0?T.maxX:T.maxY;if(z>=r&&re<n){p.push(T);continue}else if(re<r||z>=n)continue;var ee=[];if(L==="Point"||L==="MultiPoint")Je(R,ee,r,n,i);else if(L==="LineString")Et(R,ee,r,n,i,!1,l.lineMetrics);else if(L==="MultiLineString")Er(R,ee,r,n,i,!1);else if(L==="Polygon")Er(R,ee,r,n,i,!0);else if(L==="MultiPolygon")for(var me=0;me<R.length;me++){var Ie=[];Er(R[me],Ie,r,n,i,!0),Ie.length&&ee.push(Ie)}if(ee.length){if(l.lineMetrics&&L==="LineString"){for(me=0;me<ee.length;me++)p.push(yf(T.id,L,ee[me],T.tags));continue}(L==="LineString"||L==="MultiLineString")&&(ee.length===1?(L="LineString",ee=ee[0]):L="MultiLineString"),(L==="Point"||L==="MultiPoint")&&(L=ee.length===3?"Point":"MultiPoint"),p.push(yf(T.id,L,ee,T.tags))}}return p.length?p:null}function Je(e,t,r,n,i){for(var a=0;a<e.length;a+=3){var s=e[a+i];s>=r&&s<=n&&(t.push(e[a]),t.push(e[a+1]),t.push(e[a+2]))}}function Et(e,t,r,n,i,a,s){for(var l=sr(e),p=i===0?gr:kr,m=e.start,T,R,L=0;L<e.length-3;L+=3){var z=e[L],re=e[L+1],ee=e[L+2],me=e[L+3],Ie=e[L+4],He=i===0?z:re,Xe=i===0?me:Ie,ot=!1;s&&(T=Math.sqrt(Math.pow(z-me,2)+Math.pow(re-Ie,2))),He<r?Xe>r&&(R=p(l,z,re,me,Ie,r),s&&(l.start=m+T*R)):He>n?Xe<n&&(R=p(l,z,re,me,Ie,n),s&&(l.start=m+T*R)):lr(l,z,re,ee),Xe<r&&He>=r&&(R=p(l,z,re,me,Ie,r),ot=!0),Xe>n&&He<=n&&(R=p(l,z,re,me,Ie,n),ot=!0),!a&&ot&&(s&&(l.end=m+T*R),t.push(l),l=sr(e)),s&&(m+=T)}var pt=e.length-3;z=e[pt],re=e[pt+1],ee=e[pt+2],He=i===0?z:re,He>=r&&He<=n&&lr(l,z,re,ee),pt=l.length-3,a&&pt>=3&&(l[pt]!==l[0]||l[pt+1]!==l[1])&&lr(l,l[0],l[1],l[2]),l.length&&t.push(l)}function sr(e){var t=[];return t.size=e.size,t.start=e.start,t.end=e.end,t}function Er(e,t,r,n,i,a){for(var s=0;s<e.length;s++)Et(e[s],t,r,n,i,a,!1)}function lr(e,t,r,n){e.push(t),e.push(r),e.push(n)}function gr(e,t,r,n,i,a){var s=(a-t)/(n-t);return e.push(a),e.push(r+(i-r)*s),e.push(1),s}function kr(e,t,r,n,i,a){var s=(a-r)/(i-r);return e.push(t+(n-t)*s),e.push(a),e.push(1),s}function Pr(e,t){var r=t.buffer/t.extent,n=e,i=Te(e,1,-1-r,r,0,-1,2,t),a=Te(e,1,1-r,2+r,0,-1,2,t);return(i||a)&&(n=Te(e,1,-r,1+r,0,-1,2,t)||[],i&&(n=qr(i,1).concat(n)),a&&(n=n.concat(qr(a,-1)))),n}function qr(e,t){for(var r=[],n=0;n<e.length;n++){var i=e[n],a=i.type,s;if(a==="Point"||a==="MultiPoint"||a==="LineString")s=Br(i.geometry,t);else if(a==="MultiLineString"||a==="Polygon"){s=[];for(var l=0;l<i.geometry.length;l++)s.push(Br(i.geometry[l],t))}else if(a==="MultiPolygon")for(s=[],l=0;l<i.geometry.length;l++){for(var p=[],m=0;m<i.geometry[l].length;m++)p.push(Br(i.geometry[l][m],t));s.push(p)}r.push(yf(i.id,a,s,i.tags))}return r}function Br(e,t){var r=[];r.size=e.size,e.start!==void 0&&(r.start=e.start,r.end=e.end);for(var n=0;n<e.length;n+=3)r.push(e[n]+t,e[n+1],e[n+2]);return r}function Vr(e,t){if(e.transformed)return e;var r=1<<e.z,n=e.x,i=e.y,a,s,l;for(a=0;a<e.features.length;a++){var p=e.features[a],m=p.geometry,T=p.type;if(p.geometry=[],T===1)for(s=0;s<m.length;s+=2)p.geometry.push(Kr(m[s],m[s+1],t,r,n,i));else for(s=0;s<m.length;s++){var R=[];for(l=0;l<m[s].length;l+=2)R.push(Kr(m[s][l],m[s][l+1],t,r,n,i));p.geometry.push(R)}}return e.transformed=!0,e}function Kr(e,t,r,n,i,a){return[Math.round(r*(e*n-i)),Math.round(r*(t*n-a))]}function Dr(e,t,r,n,i){for(var a=t===i.maxZoom?0:i.tolerance/((1<<t)*i.extent),s={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:r,y:n,z:t,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},l=0;l<e.length;l++){s.numFeatures++,jr(s,e[l],a,i);var p=e[l].minX,m=e[l].minY,T=e[l].maxX,R=e[l].maxY;p<s.minX&&(s.minX=p),m<s.minY&&(s.minY=m),T>s.maxX&&(s.maxX=T),R>s.maxY&&(s.maxY=R)}return s}function jr(e,t,r,n){var i=t.geometry,a=t.type,s=[];if(a==="Point"||a==="MultiPoint")for(var l=0;l<i.length;l+=3)s.push(i[l]),s.push(i[l+1]),e.numPoints++,e.numSimplified++;else if(a==="LineString")jt(s,i,e,r,!1,!1);else if(a==="MultiLineString"||a==="Polygon")for(l=0;l<i.length;l++)jt(s,i[l],e,r,a==="Polygon",l===0);else if(a==="MultiPolygon")for(var p=0;p<i.length;p++){var m=i[p];for(l=0;l<m.length;l++)jt(s,m[l],e,r,!0,l===0)}if(s.length){var T=t.tags||null;if(a==="LineString"&&n.lineMetrics){T={};for(var R in t.tags)T[R]=t.tags[R];T.mapbox_clip_start=i.start/i.size,T.mapbox_clip_end=i.end/i.size}var L={geometry:s,type:a==="Polygon"||a==="MultiPolygon"?3:a==="LineString"||a==="MultiLineString"?2:1,tags:T};t.id!==null&&(L.id=t.id),e.features.push(L)}}function jt(e,t,r,n,i,a){var s=n*n;if(n>0&&t.size<(i?s:n)){r.numPoints+=t.length/3;return}for(var l=[],p=0;p<t.length;p+=3)(n===0||t[p+2]>s)&&(r.numSimplified++,l.push(t[p]),l.push(t[p+1])),r.numPoints++;i&&Ar(l,a),e.push(l)}function Ar(e,t){for(var r=0,n=0,i=e.length,a=i-2;n<i;a=n,n+=2)r+=(e[n]-e[a])*(e[n+1]+e[a+1]);if(r>0===t)for(n=0,i=e.length;n<i/2;n+=2){var s=e[n],l=e[n+1];e[n]=e[i-2-n],e[n+1]=e[i-1-n],e[i-2-n]=s,e[i-1-n]=l}}function Ur(e,t){return new Jr(e,t)}function Jr(e,t){t=this.options=An(Object.create(this.options),t);var r=t.debug;if(r&&console.time("preprocess data"),t.maxZoom<0||t.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(t.promoteId&&t.generateId)throw new Error("promoteId and generateId cannot be used together.");var n=sh(e,t);this.tiles={},this.tileCoords=[],r&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",t.indexMaxZoom,t.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),n=Pr(n,t),n.length&&this.splitTile(n,0,0,0),r&&(n.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}Jr.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},Jr.prototype.splitTile=function(e,t,r,n,i,a,s){for(var l=[e,t,r,n],p=this.options,m=p.debug;l.length;){n=l.pop(),r=l.pop(),t=l.pop(),e=l.pop();var T=1<<t,R=Rr(t,r,n),L=this.tiles[R];if(!L&&(m>1&&console.time("creation"),L=this.tiles[R]=Dr(e,t,r,n,p),this.tileCoords.push({z:t,x:r,y:n}),m)){m>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",t,r,n,L.numFeatures,L.numPoints,L.numSimplified),console.timeEnd("creation"));var z="z"+t;this.stats[z]=(this.stats[z]||0)+1,this.total++}if(L.source=e,i){if(t===p.maxZoom||t===i)continue;var re=1<<i-t;if(r!==Math.floor(a/re)||n!==Math.floor(s/re))continue}else if(t===p.indexMaxZoom||L.numPoints<=p.indexMaxPoints)continue;if(L.source=null,e.length!==0){m>1&&console.time("clipping");var ee=.5*p.buffer/p.extent,me=.5-ee,Ie=.5+ee,He=1+ee,Xe,ot,pt,dt,It,Vt;Xe=ot=pt=dt=null,It=Te(e,T,r-ee,r+Ie,0,L.minX,L.maxX,p),Vt=Te(e,T,r+me,r+He,0,L.minX,L.maxX,p),e=null,It&&(Xe=Te(It,T,n-ee,n+Ie,1,L.minY,L.maxY,p),ot=Te(It,T,n+me,n+He,1,L.minY,L.maxY,p),It=null),Vt&&(pt=Te(Vt,T,n-ee,n+Ie,1,L.minY,L.maxY,p),dt=Te(Vt,T,n+me,n+He,1,L.minY,L.maxY,p),Vt=null),m>1&&console.timeEnd("clipping"),l.push(Xe||[],t+1,r*2,n*2),l.push(ot||[],t+1,r*2,n*2+1),l.push(pt||[],t+1,r*2+1,n*2),l.push(dt||[],t+1,r*2+1,n*2+1)}}},Jr.prototype.getTile=function(e,t,r){var n=this.options,i=n.extent,a=n.debug;if(e<0||e>24)return null;var s=1<<e;t=(t%s+s)%s;var l=Rr(e,t,r);if(this.tiles[l])return Vr(this.tiles[l],i);a>1&&console.log("drilling down to z%d-%d-%d",e,t,r);for(var p=e,m=t,T=r,R;!R&&p>0;)p--,m=Math.floor(m/2),T=Math.floor(T/2),R=this.tiles[Rr(p,m,T)];return!R||!R.source?null:(a>1&&console.log("found parent tile z%d-%d-%d",p,m,T),a>1&&console.time("drilling down"),this.splitTile(R.source,p,m,T,e,t,r),a>1&&console.timeEnd("drilling down"),this.tiles[l]?Vr(this.tiles[l],i):null)};function Rr(e,t,r){return((1<<e)*r+t)*32+e}function An(e,t){for(var r in t)e[r]=t[r];return e}var Fr=function(){function e(t,r,n,i){(0,ue.Z)(this,e),(0,ve.Z)(this,"vectorLayerCache",{}),this.x=r,this.y=n,this.z=i,this.vectorTile=t}return(0,_e.Z)(e,[{key:"getTileData",value:function(r){if(!r||!this.vectorTile.layers[r])return[];if(this.vectorLayerCache[r])return this.vectorLayerCache[r];var n=this.vectorTile.layers[r];return n.features}},{key:"getFeatureById",value:function(){throw new Error("Method not implemented.")}}]),e}(),sn={tileSize:256,minZoom:0,maxZoom:1/0,zoomOffset:0};function wr(e){for(var t=0,r=0,n=e.length,i=n-1,a,s;r<n;i=r++)a=e[r],s=e[i],t+=(s.x-a.x)*(a.y+s.y);return t}function en(e){var t=e.length;if(t<=1)return[e];for(var r=[],n,i,a=0;a<t;a++){var s=wr(e[a]);s!==0&&(i===void 0&&(i=s<0),i===s<0?(n&&r.push(n),n=[e[a]]):n.push(e[a]))}return n&&r.push(n),r}var Nn=["Unknown","Point","LineString","Polygon"];function hi(e,t,r,n,i){var a=i.geometry,s=i.type,l=i.tags,p=i.id,m=e*Math.pow(2,n),T=e*t,R=e*r,L=Nn[s],z,re;function ee(He){for(var Xe=0;Xe<He.length;Xe++){var ot=He[Xe];if(ot[3])break;var pt=180-(ot[1]+R)*360/m,dt=(ot[0]+T)*360/m-180,It=360/Math.PI*Math.atan(Math.exp(pt*Math.PI/180))-90;He[Xe]=[dt,It,0,1]}}switch(s){case 1:var me=[];for(z=0;z<a.length;z++)me[z]=a[z][0];a=me,ee(a);break;case 2:for(z=0;z<a.length;z++)ee(a[z]);break;case 3:for(a=en(a),z=0;z<a.length;z++)for(re=0;re<a[z].length;re++)ee(a[z][re]);break}a.length===1?a=a[0]:L="Multi"+L;var Ie={type:"Feature",geometry:{type:L,coordinates:a},properties:l,id:p,tileOrigin:[0,0],coord:""};return Ie}var an=function(){var e=(0,hr.Z)(it().mark(function t(r,n,i,a){return it().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.abrupt("return",new Promise(function(p){var m=n.getTile(r.z,r.x,r.y),T=m?m.features.map(function(z){return hi(a,i.x,i.y,i.z,z)}):[],R={layers:{defaultLayer:{features:T}}},L=new Fr(R,r.x,r.y,r.z);p(L)}));case 1:case"end":return l.stop()}},t)}));return function(r,n,i,a){return e.apply(this,arguments)}}();function Zr(e){var t={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!0,debug:0};return e===void 0||typeof e.geojsonvtOptions=="undefined"?t:(0,Q.Z)((0,Q.Z)({},t),e.geojsonvtOptions)}function Tr(e,t){var r=Zr(t),n=r.extent||4096,i=Ur(e,r),a=function(p,m){return an(m,i,p,n)},s=(0,Q.Z)((0,Q.Z)((0,Q.Z)({},sn),t),{},{getTileData:a});return{data:e,dataArray:[],tilesetOptions:s,isTile:!0}}function ai(e,t){var r=t.extent,n=r===void 0?[121.168,30.2828,121.384,30.4219]:r,i=t.requestParameters,a=i===void 0?{}:i,s=new Promise(function(p){e instanceof HTMLImageElement||m0(e)?p([e]):Yn(e,a,function(m){p(m)})}),l={originData:e,images:s,_id:1,dataArray:[{_id:0,coordinates:[[n[0],n[1]],[n[2],n[3]]]}]};return l}function Yn(e,t,r){var n=[];if(typeof e=="string")Qe((0,Q.Z)((0,Q.Z)({},t),{},{url:e}),function(s,l){l&&(n.push(l),r(n))});else{var i=e.length,a=0;e.forEach(function(s){Qe((0,Q.Z)((0,Q.Z)({},t),{},{url:s}),function(l,p){a++,p&&n.push(p),a===i&&r(n)})})}return ai}var Pn=function(){var e=(0,hr.Z)(it().mark(function t(r,n,i,a){var s,l;return it().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return s={x:n.x,y:n.y,z:n.z},l=Kl(r,s),m.abrupt("return",new Promise(function(T){a?a(s,function(R,L){if(R||!L){var z={layers:{defaultLayer:{features:[]}}},re=new Fr(z,n.x,n.y,n.z);T(re)}else{var ee={layers:{defaultLayer:{features:L.features}}},me=new Fr(ee,n.x,n.y,n.z);T(me)}}):$i((0,Q.Z)((0,Q.Z)({},i),{},{url:l}),function(R,L){if(R||!L){var z={layers:{defaultLayer:{features:[]}}},re=new Fr(z,n.x,n.y,n.z);T(re)}else{var ee=JSON.parse(L),me={layers:{defaultLayer:{features:ee}}},Ie=new Fr(me,n.x,n.y,n.z);T(Ie)}})}));case 3:case"end":return m.stop()}},t)}));return function(r,n,i,a){return e.apply(this,arguments)}}();function Di(e,t){var r=function(a,s){return Pn(e,s,t==null?void 0:t.requestParameters,t.getCustomData)},n=(0,Q.Z)((0,Q.Z)({},t),{},{getTileData:r});return{dataArray:[],tilesetOptions:n,isTile:!0}}var ei=C(8332),qn=C(88959),ga=C.n(qn),Oo=function(){function e(t,r,n,i){(0,ue.Z)(this,e),(0,ve.Z)(this,"vectorLayerCache",{}),this.x=r,this.y=n,this.z=i,this.vectorTile=new ei.VectorTile(new(ga())(t))}return(0,_e.Z)(e,[{key:"getTileData",value:function(r){if(!r||!this.vectorTile.layers[r])return[];if(this.vectorLayerCache[r])return this.vectorLayerCache[r];var n=this.vectorTile.layers[r];if(Array.isArray(n.features))return this.vectorLayerCache[r]=n.features,n.features;for(var i=[],a=0;a<n.length;a++){var s=n.feature(a),l=s.toGeoJSON(this.x,this.y,this.z);i.push((0,Q.Z)((0,Q.Z)({},l),{},{properties:(0,Q.Z)({id:l.id},l.properties)}))}return this.vectorLayerCache[r]=i,i}},{key:"getFeatureById",value:function(){throw new Error("Method not implemented.")}}]),e}(),Wo={tileSize:256,minZoom:0,maxZoom:1/0,zoomOffset:0,warp:!0},Xi=function(){var e=(0,hr.Z)(it().mark(function t(r,n,i,a,s){var l;return it().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return l=Kl(r,n),m.abrupt("return",new Promise(function(T){if(s)s({x:i.x,y:i.y,z:i.z},function(L,z){if(L||!z)T(void 0);else{var re=new Oo(z,i.x,i.y,i.z);T(re)}});else{var R=ln((0,Q.Z)((0,Q.Z)({},a),{},{url:l}),function(L,z){if(L||!z)T(void 0);else{var re=new Oo(z,i.x,i.y,i.z);T(re)}});i.xhrCancel=function(){return R.cancel()}}}));case 2:case"end":return m.stop()}},t)}));return function(r,n,i,a,s){return e.apply(this,arguments)}}();function Qo(e,t){var r=Array.isArray(e)?e[0]:e,n=function(s,l){return Xi(r,s,l,t==null?void 0:t.requestParameters,t==null?void 0:t.getCustomData)},i=(0,Q.Z)((0,Q.Z)((0,Q.Z)({},Wo),t),{},{getTileData:n});return{data:r,dataArray:[],tilesetOptions:i,isTile:!0}}function eo(e,t,r){switch(e){case"+":return t+r;case"-":return t-r;case"*":return t*r;case"/":return t/r;case"%":return t%r;case"^":return Math.pow(t,r);case"abs":return Math.abs(t);case"floor":return Math.floor(t);case"round":return Math.round(t);case"ceil":return Math.ceil(t);case"sin":return Math.sin(t);case"cos":return Math.cos(t);case"atan":return r===-1?Math.atan(t):Math.atan2(t,r);case"min":return Math.min(t,r);case"max":return Math.max(t,r);case"log10":return Math.log(t);case"log2":return Math.log2(t);default:return console.warn("Calculate symbol err! Return default 0"),0}}function uo(e,t){for(var r=t[0],n=r.width,i=r.height,a=t.map(function(z){return z.rasterData}),s=n*i,l=[],p=JSON.stringify(e),m=0;m<s;m++){var T=JSON.parse(p),R=No(T,a,m);if(typeof R=="number")l.push(R);else{var L=Ko(T);l.push(L)}}return l}function No(e,t,r){if(e.length===2&&e[0]==="band"&&typeof e[1]=="number")try{return t[e[1]][r]}catch(n){return console.warn("Raster Data err!"),0}e.map(function(n,i){if(Array.isArray(n)&&n.length>0)switch(n[0]){case"band":try{e[i]=t[n[1]][r]}catch(a){console.warn("Raster Data err!"),e[i]=0}break;default:No(n,t,r)}})}function qo(e){var t=(0,yn.Z)(e,3),r=t[0],n=t[1],i=n===void 0?-1:n,a=t[2],s=a===void 0?-1:a;if(r===void 0)return console.warn("Express err!"),["+",0,0];var l=r.replace(/\s+/g,"");return[l,i,s]}function Ko(e){var t=qo(e),r=t[0],n=t[1],i=t[2];return Array.isArray(n)&&(n=Ko(e[1])),Array.isArray(i)&&(i=Ko(e[2])),eo(r,n,i)}var Ns={nd:{type:"operation",expression:["/",["-",["band",1],["band",0]],["+",["band",1],["band",0]]]},rgb:{type:"function",method:hs}};function hs(e,t){for(var r=e[0].rasterData,n=e[1].rasterData,i=e[2].rasterData,a=[],s=(t==null?void 0:t.countCut)||[2,98],l=(0,yn.Z)(s,2),p=l[0],m=l[1],T=(t==null?void 0:t.RMinMax)||ti(r,p,m),R=(t==null?void 0:t.GMinMax)||ti(n,p,m),L=(t==null?void 0:t.BMinMax)||ti(i,p,m),z=0;z<r.length;z++)a.push(Math.max(0,r[z]-T[0])),a.push(Math.max(0,n[z]-R[0])),a.push(Math.max(0,i[z]-L[0]));return{rasterData:a,rMinMax:T,gMinMax:R,bMinMax:L}}function ti(e,t,r){var n=e.slice().sort(function(l,p){return l-p}),i=n.length,a=n[Math.ceil(i*t/100)],s=n[Math.ceil(i*r/100)];return[a,s]}function to(e,t,r){return pn.apply(this,arguments)}function pn(){return pn=(0,hr.Z)(it().mark(function e(t,r,n){var i,a,s,l,p,m;return it().wrap(function(R){for(;;)switch(R.prev=R.next){case 0:if(t.length!==0){R.next=2;break}return R.abrupt("return",{rasterData:[0],width:1,heigh:1});case 2:return R.next=4,Promise.all(t.map(function(L){var z=L.data,re=L.bands,ee=re===void 0?[0]:re;return r(z,ee)}));case 4:i=R.sent,a=[],i.forEach(function(L){Array.isArray(L)?a.push.apply(a,(0,cr.Z)(L)):a.push(L)}),s=a[0],l=s.width,p=s.height,R.t0=(0,eu.Z)(n),R.next=R.t0==="function"?11:R.t0==="object"?13:15;break;case 11:return m=n(a),R.abrupt("break",16);case 13:return Array.isArray(n)?m={rasterData:uo(n,a)}:m=Mn(n,a),R.abrupt("break",16);case 15:m={rasterData:a[0].rasterData};case 16:return R.abrupt("return",(0,Q.Z)((0,Q.Z)({},m),{},{width:l,height:p}));case 17:case"end":return R.stop()}},e)})),pn.apply(this,arguments)}function Mn(e,t){var r=Ns[e.type];if(r.type==="function")return r.method(t,e==null?void 0:e.options);if(r.type==="operation")return e.type==="rgb"?vn(r.expression,t):{rasterData:uo(r.expression,t)}}function vn(e,t){e.r===void 0&&console.warn("Channel R lost in Operation! Use band[0] to fill!"),e.g===void 0&&console.warn("Channel G lost in Operation! Use band[0] to fill!"),e.b===void 0&&console.warn("Channel B lost in Operation! Use band[0] to fill!");var r=uo(e.r||["band",0],t),n=uo(e.g||["band",0],t),i=uo(e.b||["band",0],t);return[r,n,i]}function si(e,t,r,n){return go.apply(this,arguments)}function go(){return go=(0,hr.Z)(it().mark(function e(t,r,n,i){var a;return it().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.next=2,to(t,r,n);case 2:a=l.sent,i(null,{data:a});case 4:case"end":return l.stop()}},e)})),go.apply(this,arguments)}function pl(e,t){var r=t.extent,n=t.width,i=t.height,a=t.min,s=t.max,l=t.format,p=t.operation,m,T,R;if(l===void 0||Po(e))m=Array.from(e),T=n,R=i;else{var L=Array.isArray(e)?e:[e];m=to(L,l,p)}var z={_id:1,dataArray:[{_id:1,data:m,width:T,height:R,min:a,max:s,coordinates:[[r[0],r[1]],[r[2],r[3]]]}]};return z}var ht=C(78892),Tt=C(99311),Xt=C(11922),xt={IEventEmitter:Symbol.for("IEventEmitter"),ISceneService:Symbol.for("ISceneService"),IGlobalConfigService:Symbol.for("IGlobalConfigService"),ICameraService:Symbol.for("ICameraService"),ICoordinateSystemService:Symbol.for("ICoordinateSystemService"),ILayerService:Symbol.for("ILayerService"),IDebugService:Symbol.for("IDebugService"),ILayerMappingService:Symbol.for("ILayerMappingService"),ILayerStyleService:Symbol.for("ILayerStyleService"),IMapService:Symbol.for("IMapService"),IMarkerService:Symbol.for("IMarkerService"),IPopupService:Symbol.for("PopupService"),IFactoryMapService:Symbol.for("Factory<IMapService>"),IRendererService:Symbol.for("IRendererService"),IShaderModuleService:Symbol.for("IShaderModuleService"),IIconService:Symbol.for("IIconService"),IFontService:Symbol.for("IFontService"),IInteractionService:Symbol.for("IInteractionService"),IPickingService:Symbol.for("IPickingService"),IControlService:Symbol.for("IControlService"),IStyleAttributeService:Symbol.for("IStyleAttributeService"),ILayer:Symbol.for("ILayer"),ILayerPlugin:Symbol.for("ILayerPlugin"),INormalPass:Symbol.for("INormalPass"),IPostProcessor:Symbol.for("IPostProcessor"),IPostProcessingPass:Symbol.for("IPostProcessingPass"),IFactoryPostProcessingPass:Symbol.for("Factory<IPostProcessingPass>"),IFactoryNormalPass:Symbol.for("Factory<IFactoryNormalPass>"),IMultiPassRenderer:Symbol.for("IMultiPassRenderer"),SceneID:Symbol.for("SceneID"),MapConfig:Symbol.for("MapConfig")},di=C(52155),Da=C.n(di);function Oe(e,t){var r=typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=Ve(e))||t&&e&&typeof e.length=="number"){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(m){throw m},f:i}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var a=!0,s=!1,l;return{s:function(){r=r.call(e)},n:function(){var m=r.next();return a=m.done,m},e:function(m){s=!0,l=m},f:function(){try{!a&&r.return!=null&&r.return()}finally{if(s)throw l}}}}function Ve(e,t){if(e){if(typeof e=="string")return ft(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return ft(e,t)}}function ft(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var $t=30;function tr(e){var t=e.characterSet,r=e.getFontWidth,n=e.fontHeight,i=e.buffer,a=e.maxCanvasWidth,s=e.mapping,l=s===void 0?{}:s,p=e.xOffset,m=p===void 0?0:p,T=e.yOffset,R=T===void 0?0:T,L=0,z=m;Array.from(t).forEach(function(ee,me){if(!l[ee]){var Ie=r(ee,me);z+$t>a&&(z=0,L++),l[ee]={x:z,y:R+L*$t,width:$t,height:$t,advance:Ie},z+=$t}});var re=n+i*2;return{mapping:l,xOffset:z,yOffset:R+L*re,canvasHeight:Dt(R+(L+1)*re)}}function wt(e,t,r){var n=0,i=0,a=0,s=[],l={},p=Oe(e),m;try{for(p.s();!(m=p.n()).done;){var T=m.value;if(!l[T.id]){var R=T.size;n+R+t>r&&(Bt(l,s,i),n=0,i=a+i+t,a=0,s=[]),s.push({icon:T,xOffset:n}),n=n+R+t,a=Math.max(a,R)}}}catch(z){p.e(z)}finally{p.f()}s.length>0&&Bt(l,s,i);var L=Dt(a+i+t);return{mapping:l,canvasHeight:L}}function Bt(e,t,r){var n=Oe(t),i;try{for(n.s();!(i=n.n()).done;){var a=i.value,s=a.icon,l=a.xOffset;e[s.id]=(0,Q.Z)((0,Q.Z)({},s),{},{x:l,y:r,image:s.image,width:s.width,height:s.height})}}catch(p){n.e(p)}finally{n.f()}}function Dt(e){return Math.pow(2,Math.ceil(Math.log2(e)))}var ut,h;function f(e,t){var r=typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=d(e))||t&&e&&typeof e.length=="number"){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(m){throw m},f:i}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var a=!0,s=!1,l;return{s:function(){r=r.call(e)},n:function(){var m=r.next();return a=m.done,m},e:function(m){s=!0,l=m},f:function(){try{!a&&r.return!=null&&r.return()}finally{if(s)throw l}}}}function d(e,t){if(e){if(typeof e=="string")return E(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return E(e,t)}}function E(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function S(e){var t=M();return function(){var n=(0,le.Z)(e),i;if(t){var a=(0,le.Z)(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return(0,ze.Z)(this,i)}}function M(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var O=fr(),F="sans-serif",$="normal",pe=24,we=3,$e=.25,At=8,Rt=1024,_t=1,zt=1,xr=3,mr=null;function fr(){for(var e=[],t=32;t<128;t++)e.push(String.fromCharCode(t));return e}function ur(e,t,r,n){e.font="".concat(n," ").concat(r,"px ").concat(t),e.fillStyle="black",e.textBaseline="middle"}function er(e,t){for(var r=0;r<e.length;r++)t.data[4*r+3]=e[r]}var Sn=(ut=(0,Tt.b2)(),ut(h=function(e){(0,ke.Z)(r,e);var t=S(r);function r(){var n;(0,ue.Z)(this,r);for(var i=arguments.length,a=new Array(i),s=0;s<i;s++)a[s]=arguments[s];return n=t.call.apply(t,[this].concat(a)),(0,ve.Z)((0,St.Z)(n),"fontAtlas",void 0),(0,ve.Z)((0,St.Z)(n),"iconFontMap",void 0),(0,ve.Z)((0,St.Z)(n),"iconFontGlyphs",{}),(0,ve.Z)((0,St.Z)(n),"fontOptions",void 0),(0,ve.Z)((0,St.Z)(n),"key",void 0),(0,ve.Z)((0,St.Z)(n),"cache",new ys(xr)),n}return(0,_e.Z)(r,[{key:"scale",get:function(){return zt}},{key:"canvas",get:function(){var i=this.cache.get(this.key);return i&&i.data}},{key:"mapping",get:function(){var i=this.cache.get(this.key);return i&&i.mapping||{}}},{key:"getCanvasByKey",value:function(i){var a=this.cache.get(i);return a&&a.data}},{key:"getMappingByKey",value:function(i){var a=this.cache.get(i);return a&&a.mapping||{}}},{key:"init",value:function(){this.cache.clear(),this.fontOptions={fontFamily:F,fontWeight:$,characterSet:O,fontSize:pe,buffer:we,sdf:!0,cutoff:$e,radius:At,iconfont:!1},this.key="",this.iconFontMap=new Map}},{key:"addIconGlyphs",value:function(i){var a=this;i.forEach(function(s){a.iconFontGlyphs[s.name]=s.unicode})}},{key:"addIconFont",value:function(i,a){this.iconFontMap.set(i,a)}},{key:"getIconFontKey",value:function(i){return this.iconFontMap.get(i)||i}},{key:"getGlyph",value:function(i){return this.iconFontGlyphs[i]?String.fromCharCode(parseInt(this.iconFontGlyphs[i],16)):""}},{key:"setFontOptions",value:function(i){this.fontOptions=(0,Q.Z)((0,Q.Z)({},this.fontOptions),i),this.key=this.getKey();var a=this.getNewChars(this.key,this.fontOptions.characterSet),s=this.cache.get(this.key);if(!(s&&a.length===0)){var l=this.generateFontAtlas(this.key,a,s);this.fontAtlas=l,this.cache.set(this.key,l)}}},{key:"addFontFace",value:function(i,a){var s=this,l=document.createElement("style");l.type="text/css",l.innerText=`
        @font-face{
            font-family: '`.concat(i,`';
            src: url('`).concat(a,`') format('woff2'),
            url('`).concat(a,`') format('woff'),
            url('`).concat(a,`') format('truetype');
        }`),l.onload=function(){if(document.fonts)try{document.fonts.load("24px ".concat(i),"L7text"),document.fonts.ready.then(function(){s.emit("fontloaded",{fontFamily:i})})}catch(p){console.warn("\u5F53\u524D\u73AF\u5883\u4E0D\u652F\u6301 document.fonts !"),console.warn("\u5F53\u524D\u73AF\u5883\u4E0D\u652F\u6301 iconfont !"),console.warn(p)}},document.getElementsByTagName("head")[0].appendChild(l)}},{key:"destroy",value:function(){this.cache.clear(),this.iconFontMap.clear()}},{key:"generateFontAtlas",value:function(i,a,s){var l=this.fontOptions,p=l.fontFamily,m=l.fontWeight,T=l.fontSize,R=l.buffer,L=l.sdf,z=l.radius,re=l.cutoff,ee=l.iconfont,me=s&&s.data;me||(me=window.document.createElement("canvas"),me.width=Rt);var Ie=me.getContext("2d",{willReadFrequently:!0});ur(Ie,p,T,m);var He=tr((0,Q.Z)({getFontWidth:function(vu){return Ie.measureText(vu).width},fontHeight:T*zt,buffer:R,characterSet:a,maxCanvasWidth:Rt},s&&{mapping:s.mapping,xOffset:s.xOffset,yOffset:s.yOffset})),Xe=He.mapping,ot=He.canvasHeight,pt=He.xOffset,dt=He.yOffset,It=Ie.getImageData(0,0,me.width,me.height);if(me.height=ot,Ie.putImageData(It,0,0),ur(Ie,p,T,m),L){var Vt=new(Da())(T,R,z,re,p,m),Kt=Ie.getImageData(0,0,Vt.size,Vt.size),yr=f(a),_r;try{for(yr.s();!(_r=yr.n()).done;){var Hr=_r.value;if(ee){var nn=String.fromCharCode(parseInt(Hr.replace("&#x","").replace(";",""),16)),Tn=Vt.draw(nn);er(Tn,Kt)}else er(Vt.draw(Hr),Kt);Ie.putImageData(Kt,Xe[Hr].x,Xe[Hr].y)}}catch(As){yr.e(As)}finally{yr.f()}}else{var sa=f(a),Fo;try{for(sa.s();!(Fo=sa.n()).done;){var jo=Fo.value;Ie.fillText(jo,Xe[jo].x,Xe[jo].y+T*_t)}}catch(As){sa.e(As)}finally{sa.f()}}return{xOffset:pt,yOffset:dt,mapping:Xe,data:me,width:me.width,height:me.height}}},{key:"getKey",value:function(){var i=this.fontOptions,a=i.fontFamily,s=i.fontWeight;return"".concat(a,"_").concat(s)}},{key:"getNewChars",value:function(i,a){var s=this.cache.get(i);if(!s)return a;var l=[],p=s.mapping,m=new Set(Object.keys(p)),T=new Set(a);return T.forEach(function(R){m.has(R)||l.push(R)}),l}}]),r}(Si.EventEmitter))||h),wn,cn;function En(e){var t=Va();return function(){var n=(0,le.Z)(e),i;if(t){var a=(0,le.Z)(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return(0,ze.Z)(this,i)}}function Va(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var Ta=3,Ca=1024,Li=64,Ei=(wn=(0,Tt.b2)(),wn(cn=function(e){(0,ke.Z)(r,e);var t=En(r);function r(){var n;(0,ue.Z)(this,r);for(var i=arguments.length,a=new Array(i),s=0;s<i;s++)a[s]=arguments[s];return n=t.call.apply(t,[this].concat(a)),(0,ve.Z)((0,St.Z)(n),"canvasHeight",128),(0,ve.Z)((0,St.Z)(n),"texture",void 0),(0,ve.Z)((0,St.Z)(n),"canvas",void 0),(0,ve.Z)((0,St.Z)(n),"iconData",void 0),(0,ve.Z)((0,St.Z)(n),"iconMap",void 0),(0,ve.Z)((0,St.Z)(n),"ctx",void 0),(0,ve.Z)((0,St.Z)(n),"loadingImageCount",0),n}return(0,_e.Z)(r,[{key:"isLoading",value:function(){return this.loadingImageCount===0}},{key:"init",value:function(){this.iconData=[],this.iconMap={},this.canvas=window.document.createElement("canvas"),this.canvas.width=128,this.canvas.height=128,this.ctx=this.canvas.getContext("2d")}},{key:"addImage",value:function(){var n=(0,hr.Z)(it().mark(function a(s,l){var p,m;return it().wrap(function(R){for(;;)switch(R.prev=R.next){case 0:return p=new Image,this.loadingImageCount++,this.hasImage(s)?console.warn("Image Id already exists"):this.iconData.push({id:s,size:Li}),this.updateIconMap(),R.next=6,this.loadImage(l);case 6:p=R.sent,m=this.iconData.find(function(L){return L.id===s}),m&&(m.image=p,m.width=p.width,m.height=p.height),this.update();case 10:case"end":return R.stop()}},a,this)}));function i(a,s){return n.apply(this,arguments)}return i}()},{key:"addImageMini",value:function(i,a,s){var l=this,p=s.getSceneConfig().canvas,m=p.createImage();if(this.loadingImageCount++,this.hasImage(i))throw new Error("Image Id already exists");this.iconData.push({id:i,size:Li}),this.updateIconMap(),this.loadImageMini(a,p).then(function(T){m=T;var R=l.iconData.find(function(L){return L.id===i});R&&(R.image=m,R.width=m.width,R.height=m.height),l.update()})}},{key:"getTexture",value:function(){return this.texture}},{key:"getIconMap",value:function(){return this.iconMap}},{key:"getCanvas",value:function(){return this.canvas}},{key:"hasImage",value:function(i){return this.iconMap.hasOwnProperty(i)}},{key:"removeImage",value:function(i){this.hasImage(i)&&(this.iconData=this.iconData.filter(function(a){return a.id!==i}),delete this.iconMap[i],this.update())}},{key:"destroy",value:function(){this.removeAllListeners("imageUpdate"),this.iconData=[],this.iconMap={}}},{key:"loadImage",value:function(i){return new Promise(function(a,s){if(i instanceof HTMLImageElement){a(i);return}var l=new Image;l.crossOrigin="anonymous",l.onload=function(){a(l)},l.onerror=function(){s(new Error("Could not load image at "+i))},l.src=i instanceof File?URL.createObjectURL(i):i})}},{key:"update",value:function(){this.updateIconMap(),this.updateIconAtlas(),this.loadingImageCount--,this.loadingImageCount===0&&this.emit("imageUpdate")}},{key:"updateIconAtlas",value:function(){var i=this;this.canvas.width=Ca,this.canvas.height=this.canvasHeight,Object.keys(this.iconMap).forEach(function(a){var s=i.iconMap[a],l=s.x,p=s.y,m=s.image,T=s.width,R=T===void 0?64:T,L=s.height,z=L===void 0?64:L,re=Math.max(R,z),ee=re/Li,me=z/ee,Ie=R/ee;m&&i.ctx.drawImage(m,l+(Li-Ie)/2,p+(Li-me)/2,Ie,me)})}},{key:"updateIconMap",value:function(){var i=wt(this.iconData,Ta,Ca),a=i.mapping,s=i.canvasHeight;this.iconMap=a,this.canvasHeight=s}},{key:"loadImageMini",value:function(i,a){return new Promise(function(s,l){var p=a.createImage();p.crossOrigin="anonymous",p.onload=function(){s(p)},p.onerror=function(){l(new Error("Could not load image at "+i))},p.src=i})}}]),r}(Si.EventEmitter))||cn);function _i(){var e=new xs(16);return xs!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0),e[0]=1,e[5]=1,e[10]=1,e[15]=1,e}function ro(e){var t=new xs(16);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function Yi(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function lo(e,t,r,n,i,a,s,l,p,m,T,R,L,z,re,ee){var me=new xs(16);return me[0]=e,me[1]=t,me[2]=r,me[3]=n,me[4]=i,me[5]=a,me[6]=s,me[7]=l,me[8]=p,me[9]=m,me[10]=T,me[11]=R,me[12]=L,me[13]=z,me[14]=re,me[15]=ee,me}function Ju(e,t,r,n,i,a,s,l,p,m,T,R,L,z,re,ee,me){return e[0]=t,e[1]=r,e[2]=n,e[3]=i,e[4]=a,e[5]=s,e[6]=l,e[7]=p,e[8]=m,e[9]=T,e[10]=R,e[11]=L,e[12]=z,e[13]=re,e[14]=ee,e[15]=me,e}function jh(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function Zp(e,t){if(e===t){var r=t[1],n=t[2],i=t[3],a=t[6],s=t[7],l=t[11];e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=r,e[6]=t[9],e[7]=t[13],e[8]=n,e[9]=a,e[11]=t[14],e[12]=i,e[13]=s,e[14]=l}else e[0]=t[0],e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=t[1],e[5]=t[5],e[6]=t[9],e[7]=t[13],e[8]=t[2],e[9]=t[6],e[10]=t[10],e[11]=t[14],e[12]=t[3],e[13]=t[7],e[14]=t[11],e[15]=t[15];return e}function jd(e,t){var r=t[0],n=t[1],i=t[2],a=t[3],s=t[4],l=t[5],p=t[6],m=t[7],T=t[8],R=t[9],L=t[10],z=t[11],re=t[12],ee=t[13],me=t[14],Ie=t[15],He=r*l-n*s,Xe=r*p-i*s,ot=r*m-a*s,pt=n*p-i*l,dt=n*m-a*l,It=i*m-a*p,Vt=T*ee-R*re,Kt=T*me-L*re,yr=T*Ie-z*re,_r=R*me-L*ee,Hr=R*Ie-z*ee,nn=L*Ie-z*me,Tn=He*nn-Xe*Hr+ot*_r+pt*yr-dt*Kt+It*Vt;return Tn?(Tn=1/Tn,e[0]=(l*nn-p*Hr+m*_r)*Tn,e[1]=(i*Hr-n*nn-a*_r)*Tn,e[2]=(ee*It-me*dt+Ie*pt)*Tn,e[3]=(L*dt-R*It-z*pt)*Tn,e[4]=(p*yr-s*nn-m*Kt)*Tn,e[5]=(r*nn-i*yr+a*Kt)*Tn,e[6]=(me*ot-re*It-Ie*Xe)*Tn,e[7]=(T*It-L*ot+z*Xe)*Tn,e[8]=(s*Hr-l*yr+m*Vt)*Tn,e[9]=(n*yr-r*Hr-a*Vt)*Tn,e[10]=(re*dt-ee*ot+Ie*He)*Tn,e[11]=(R*ot-T*dt-z*He)*Tn,e[12]=(l*Kt-s*_r-p*Vt)*Tn,e[13]=(r*_r-n*Kt+i*Vt)*Tn,e[14]=(ee*Xe-re*pt-me*He)*Tn,e[15]=(T*pt-R*Xe+L*He)*Tn,e):null}function MA(e,t){var r=t[0],n=t[1],i=t[2],a=t[3],s=t[4],l=t[5],p=t[6],m=t[7],T=t[8],R=t[9],L=t[10],z=t[11],re=t[12],ee=t[13],me=t[14],Ie=t[15];return e[0]=l*(L*Ie-z*me)-R*(p*Ie-m*me)+ee*(p*z-m*L),e[1]=-(n*(L*Ie-z*me)-R*(i*Ie-a*me)+ee*(i*z-a*L)),e[2]=n*(p*Ie-m*me)-l*(i*Ie-a*me)+ee*(i*m-a*p),e[3]=-(n*(p*z-m*L)-l*(i*z-a*L)+R*(i*m-a*p)),e[4]=-(s*(L*Ie-z*me)-T*(p*Ie-m*me)+re*(p*z-m*L)),e[5]=r*(L*Ie-z*me)-T*(i*Ie-a*me)+re*(i*z-a*L),e[6]=-(r*(p*Ie-m*me)-s*(i*Ie-a*me)+re*(i*m-a*p)),e[7]=r*(p*z-m*L)-s*(i*z-a*L)+T*(i*m-a*p),e[8]=s*(R*Ie-z*ee)-T*(l*Ie-m*ee)+re*(l*z-m*R),e[9]=-(r*(R*Ie-z*ee)-T*(n*Ie-a*ee)+re*(n*z-a*R)),e[10]=r*(l*Ie-m*ee)-s*(n*Ie-a*ee)+re*(n*m-a*l),e[11]=-(r*(l*z-m*R)-s*(n*z-a*R)+T*(n*m-a*l)),e[12]=-(s*(R*me-L*ee)-T*(l*me-p*ee)+re*(l*L-p*R)),e[13]=r*(R*me-L*ee)-T*(n*me-i*ee)+re*(n*L-i*R),e[14]=-(r*(l*me-p*ee)-s*(n*me-i*ee)+re*(n*p-i*l)),e[15]=r*(l*L-p*R)-s*(n*L-i*R)+T*(n*p-i*l),e}function W_(e){var t=e[0],r=e[1],n=e[2],i=e[3],a=e[4],s=e[5],l=e[6],p=e[7],m=e[8],T=e[9],R=e[10],L=e[11],z=e[12],re=e[13],ee=e[14],me=e[15],Ie=t*s-r*a,He=t*l-n*a,Xe=t*p-i*a,ot=r*l-n*s,pt=r*p-i*s,dt=n*p-i*l,It=m*re-T*z,Vt=m*ee-R*z,Kt=m*me-L*z,yr=T*ee-R*re,_r=T*me-L*re,Hr=R*me-L*ee;return Ie*Hr-He*_r+Xe*yr+ot*Kt-pt*Vt+dt*It}function $c(e,t,r){var n=t[0],i=t[1],a=t[2],s=t[3],l=t[4],p=t[5],m=t[6],T=t[7],R=t[8],L=t[9],z=t[10],re=t[11],ee=t[12],me=t[13],Ie=t[14],He=t[15],Xe=r[0],ot=r[1],pt=r[2],dt=r[3];return e[0]=Xe*n+ot*l+pt*R+dt*ee,e[1]=Xe*i+ot*p+pt*L+dt*me,e[2]=Xe*a+ot*m+pt*z+dt*Ie,e[3]=Xe*s+ot*T+pt*re+dt*He,Xe=r[4],ot=r[5],pt=r[6],dt=r[7],e[4]=Xe*n+ot*l+pt*R+dt*ee,e[5]=Xe*i+ot*p+pt*L+dt*me,e[6]=Xe*a+ot*m+pt*z+dt*Ie,e[7]=Xe*s+ot*T+pt*re+dt*He,Xe=r[8],ot=r[9],pt=r[10],dt=r[11],e[8]=Xe*n+ot*l+pt*R+dt*ee,e[9]=Xe*i+ot*p+pt*L+dt*me,e[10]=Xe*a+ot*m+pt*z+dt*Ie,e[11]=Xe*s+ot*T+pt*re+dt*He,Xe=r[12],ot=r[13],pt=r[14],dt=r[15],e[12]=Xe*n+ot*l+pt*R+dt*ee,e[13]=Xe*i+ot*p+pt*L+dt*me,e[14]=Xe*a+ot*m+pt*z+dt*Ie,e[15]=Xe*s+ot*T+pt*re+dt*He,e}function Gf(e,t,r){var n=r[0],i=r[1],a=r[2],s,l,p,m,T,R,L,z,re,ee,me,Ie;return t===e?(e[12]=t[0]*n+t[4]*i+t[8]*a+t[12],e[13]=t[1]*n+t[5]*i+t[9]*a+t[13],e[14]=t[2]*n+t[6]*i+t[10]*a+t[14],e[15]=t[3]*n+t[7]*i+t[11]*a+t[15]):(s=t[0],l=t[1],p=t[2],m=t[3],T=t[4],R=t[5],L=t[6],z=t[7],re=t[8],ee=t[9],me=t[10],Ie=t[11],e[0]=s,e[1]=l,e[2]=p,e[3]=m,e[4]=T,e[5]=R,e[6]=L,e[7]=z,e[8]=re,e[9]=ee,e[10]=me,e[11]=Ie,e[12]=s*n+T*i+re*a+t[12],e[13]=l*n+R*i+ee*a+t[13],e[14]=p*n+L*i+me*a+t[14],e[15]=m*n+z*i+Ie*a+t[15]),e}function Do(e,t,r){var n=r[0],i=r[1],a=r[2];return e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n,e[3]=t[3]*n,e[4]=t[4]*i,e[5]=t[5]*i,e[6]=t[6]*i,e[7]=t[7]*i,e[8]=t[8]*a,e[9]=t[9]*a,e[10]=t[10]*a,e[11]=t[11]*a,e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function rc(e,t,r,n){var i=n[0],a=n[1],s=n[2],l=Math.hypot(i,a,s),p,m,T,R,L,z,re,ee,me,Ie,He,Xe,ot,pt,dt,It,Vt,Kt,yr,_r,Hr,nn,Tn,sa;return l<Ja?null:(l=1/l,i*=l,a*=l,s*=l,p=Math.sin(r),m=Math.cos(r),T=1-m,R=t[0],L=t[1],z=t[2],re=t[3],ee=t[4],me=t[5],Ie=t[6],He=t[7],Xe=t[8],ot=t[9],pt=t[10],dt=t[11],It=i*i*T+m,Vt=a*i*T+s*p,Kt=s*i*T-a*p,yr=i*a*T-s*p,_r=a*a*T+m,Hr=s*a*T+i*p,nn=i*s*T+a*p,Tn=a*s*T-i*p,sa=s*s*T+m,e[0]=R*It+ee*Vt+Xe*Kt,e[1]=L*It+me*Vt+ot*Kt,e[2]=z*It+Ie*Vt+pt*Kt,e[3]=re*It+He*Vt+dt*Kt,e[4]=R*yr+ee*_r+Xe*Hr,e[5]=L*yr+me*_r+ot*Hr,e[6]=z*yr+Ie*_r+pt*Hr,e[7]=re*yr+He*_r+dt*Hr,e[8]=R*nn+ee*Tn+Xe*sa,e[9]=L*nn+me*Tn+ot*sa,e[10]=z*nn+Ie*Tn+pt*sa,e[11]=re*nn+He*Tn+dt*sa,t!==e&&(e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e)}function Jo(e,t,r){var n=Math.sin(r),i=Math.cos(r),a=t[4],s=t[5],l=t[6],p=t[7],m=t[8],T=t[9],R=t[10],L=t[11];return t!==e&&(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[4]=a*i+m*n,e[5]=s*i+T*n,e[6]=l*i+R*n,e[7]=p*i+L*n,e[8]=m*i-a*n,e[9]=T*i-s*n,e[10]=R*i-l*n,e[11]=L*i-p*n,e}function dl(e,t,r){var n=Math.sin(r),i=Math.cos(r),a=t[0],s=t[1],l=t[2],p=t[3],m=t[8],T=t[9],R=t[10],L=t[11];return t!==e&&(e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=a*i-m*n,e[1]=s*i-T*n,e[2]=l*i-R*n,e[3]=p*i-L*n,e[8]=a*n+m*i,e[9]=s*n+T*i,e[10]=l*n+R*i,e[11]=p*n+L*i,e}function Sf(e,t,r){var n=Math.sin(r),i=Math.cos(r),a=t[0],s=t[1],l=t[2],p=t[3],m=t[4],T=t[5],R=t[6],L=t[7];return t!==e&&(e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=a*i+m*n,e[1]=s*i+T*n,e[2]=l*i+R*n,e[3]=p*i+L*n,e[4]=m*i-a*n,e[5]=T*i-s*n,e[6]=R*i-l*n,e[7]=L*i-p*n,e}function zp(e,t){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=t[0],e[13]=t[1],e[14]=t[2],e[15]=1,e}function Xd(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=t[1],e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=t[2],e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function uh(e,t,r){var n=r[0],i=r[1],a=r[2],s=Math.hypot(n,i,a),l,p,m;return s<Ja?null:(s=1/s,n*=s,i*=s,a*=s,l=Math.sin(t),p=Math.cos(t),m=1-p,e[0]=n*n*m+p,e[1]=i*n*m+a*l,e[2]=a*n*m-i*l,e[3]=0,e[4]=n*i*m-a*l,e[5]=i*i*m+p,e[6]=a*i*m+n*l,e[7]=0,e[8]=n*a*m+i*l,e[9]=i*a*m-n*l,e[10]=a*a*m+p,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e)}function Xh(e,t){var r=Math.sin(t),n=Math.cos(t);return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=n,e[6]=r,e[7]=0,e[8]=0,e[9]=-r,e[10]=n,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function l0(e,t){var r=Math.sin(t),n=Math.cos(t);return e[0]=n,e[1]=0,e[2]=-r,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=r,e[9]=0,e[10]=n,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function Vf(e,t){var r=Math.sin(t),n=Math.cos(t);return e[0]=n,e[1]=r,e[2]=0,e[3]=0,e[4]=-r,e[5]=n,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function xf(e,t,r){var n=t[0],i=t[1],a=t[2],s=t[3],l=n+n,p=i+i,m=a+a,T=n*l,R=n*p,L=n*m,z=i*p,re=i*m,ee=a*m,me=s*l,Ie=s*p,He=s*m;return e[0]=1-(z+ee),e[1]=R+He,e[2]=L-Ie,e[3]=0,e[4]=R-He,e[5]=1-(T+ee),e[6]=re+me,e[7]=0,e[8]=L+Ie,e[9]=re-me,e[10]=1-(T+z),e[11]=0,e[12]=r[0],e[13]=r[1],e[14]=r[2],e[15]=1,e}function Gp(e,t){var r=new xs(3),n=-t[0],i=-t[1],a=-t[2],s=t[3],l=t[4],p=t[5],m=t[6],T=t[7],R=n*n+i*i+a*a+s*s;return R>0?(r[0]=(l*s+T*n+p*a-m*i)*2/R,r[1]=(p*s+T*i+m*n-l*a)*2/R,r[2]=(m*s+T*a+l*i-p*n)*2/R):(r[0]=(l*s+T*n+p*a-m*i)*2,r[1]=(p*s+T*i+m*n-l*a)*2,r[2]=(m*s+T*a+l*i-p*n)*2),xf(e,t,r),e}function Yd(e,t){return e[0]=t[12],e[1]=t[13],e[2]=t[14],e}function Vp(e,t){var r=t[0],n=t[1],i=t[2],a=t[4],s=t[5],l=t[6],p=t[8],m=t[9],T=t[10];return e[0]=Math.hypot(r,n,i),e[1]=Math.hypot(a,s,l),e[2]=Math.hypot(p,m,T),e}function $d(e,t){var r=new xs(3);Vp(r,t);var n=1/r[0],i=1/r[1],a=1/r[2],s=t[0]*n,l=t[1]*i,p=t[2]*a,m=t[4]*n,T=t[5]*i,R=t[6]*a,L=t[8]*n,z=t[9]*i,re=t[10]*a,ee=s+T+re,me=0;return ee>0?(me=Math.sqrt(ee+1)*2,e[3]=.25*me,e[0]=(R-z)/me,e[1]=(L-p)/me,e[2]=(l-m)/me):s>T&&s>re?(me=Math.sqrt(1+s-T-re)*2,e[3]=(R-z)/me,e[0]=.25*me,e[1]=(l+m)/me,e[2]=(L+p)/me):T>re?(me=Math.sqrt(1+T-s-re)*2,e[3]=(L-p)/me,e[0]=(l+m)/me,e[1]=.25*me,e[2]=(R+z)/me):(me=Math.sqrt(1+re-s-T)*2,e[3]=(l-m)/me,e[0]=(L+p)/me,e[1]=(R+z)/me,e[2]=.25*me),e}function Qd(e,t,r,n){var i=t[0],a=t[1],s=t[2],l=t[3],p=i+i,m=a+a,T=s+s,R=i*p,L=i*m,z=i*T,re=a*m,ee=a*T,me=s*T,Ie=l*p,He=l*m,Xe=l*T,ot=n[0],pt=n[1],dt=n[2];return e[0]=(1-(re+me))*ot,e[1]=(L+Xe)*ot,e[2]=(z-He)*ot,e[3]=0,e[4]=(L-Xe)*pt,e[5]=(1-(R+me))*pt,e[6]=(ee+Ie)*pt,e[7]=0,e[8]=(z+He)*dt,e[9]=(ee-Ie)*dt,e[10]=(1-(R+re))*dt,e[11]=0,e[12]=r[0],e[13]=r[1],e[14]=r[2],e[15]=1,e}function $g(e,t,r,n,i){var a=t[0],s=t[1],l=t[2],p=t[3],m=a+a,T=s+s,R=l+l,L=a*m,z=a*T,re=a*R,ee=s*T,me=s*R,Ie=l*R,He=p*m,Xe=p*T,ot=p*R,pt=n[0],dt=n[1],It=n[2],Vt=i[0],Kt=i[1],yr=i[2],_r=(1-(ee+Ie))*pt,Hr=(z+ot)*pt,nn=(re-Xe)*pt,Tn=(z-ot)*dt,sa=(1-(L+Ie))*dt,Fo=(me+He)*dt,jo=(re+Xe)*It,As=(me-He)*It,vu=(1-(L+ee))*It;return e[0]=_r,e[1]=Hr,e[2]=nn,e[3]=0,e[4]=Tn,e[5]=sa,e[6]=Fo,e[7]=0,e[8]=jo,e[9]=As,e[10]=vu,e[11]=0,e[12]=r[0]+Vt-(_r*Vt+Tn*Kt+jo*yr),e[13]=r[1]+Kt-(Hr*Vt+sa*Kt+As*yr),e[14]=r[2]+yr-(nn*Vt+Fo*Kt+vu*yr),e[15]=1,e}function Qg(e,t){var r=t[0],n=t[1],i=t[2],a=t[3],s=r+r,l=n+n,p=i+i,m=r*s,T=n*s,R=n*l,L=i*s,z=i*l,re=i*p,ee=a*s,me=a*l,Ie=a*p;return e[0]=1-R-re,e[1]=T+Ie,e[2]=L-me,e[3]=0,e[4]=T-Ie,e[5]=1-m-re,e[6]=z+ee,e[7]=0,e[8]=L+me,e[9]=z-ee,e[10]=1-m-R,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function nc(e,t,r,n,i,a,s){var l=1/(r-t),p=1/(i-n),m=1/(a-s);return e[0]=a*2*l,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=a*2*p,e[6]=0,e[7]=0,e[8]=(r+t)*l,e[9]=(i+n)*p,e[10]=(s+a)*m,e[11]=-1,e[12]=0,e[13]=0,e[14]=s*a*2*m,e[15]=0,e}function qd(e,t,r,n,i){var a=1/Math.tan(t/2),s;return e[0]=a/r,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=a,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=-1,e[12]=0,e[13]=0,e[15]=0,i!=null&&i!==1/0?(s=1/(n-i),e[10]=(i+n)*s,e[14]=2*i*n*s):(e[10]=-1,e[14]=-2*n),e}var wA=qd;function j_(e,t,r,n,i){var a=1/Math.tan(t/2),s;return e[0]=a/r,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=a,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=-1,e[12]=0,e[13]=0,e[15]=0,i!=null&&i!==1/0?(s=1/(n-i),e[10]=i*s,e[14]=i*n*s):(e[10]=-1,e[14]=-n),e}function Yh(e,t,r,n){var i=Math.tan(t.upDegrees*Math.PI/180),a=Math.tan(t.downDegrees*Math.PI/180),s=Math.tan(t.leftDegrees*Math.PI/180),l=Math.tan(t.rightDegrees*Math.PI/180),p=2/(s+l),m=2/(i+a);return e[0]=p,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=m,e[6]=0,e[7]=0,e[8]=-((s-l)*p*.5),e[9]=(i-a)*m*.5,e[10]=n/(r-n),e[11]=-1,e[12]=0,e[13]=0,e[14]=n*r/(r-n),e[15]=0,e}function $h(e,t,r,n,i,a,s){var l=1/(t-r),p=1/(n-i),m=1/(a-s);return e[0]=-2*l,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*p,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=2*m,e[11]=0,e[12]=(t+r)*l,e[13]=(i+n)*p,e[14]=(s+a)*m,e[15]=1,e}var IA=$h;function PA(e,t,r,n,i,a,s){var l=1/(t-r),p=1/(n-i),m=1/(a-s);return e[0]=-2*l,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*p,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=m,e[11]=0,e[12]=(t+r)*l,e[13]=(i+n)*p,e[14]=a*m,e[15]=1,e}function Qh(e,t,r,n){var i,a,s,l,p,m,T,R,L,z,re=t[0],ee=t[1],me=t[2],Ie=n[0],He=n[1],Xe=n[2],ot=r[0],pt=r[1],dt=r[2];return Math.abs(re-ot)<Ja&&Math.abs(ee-pt)<Ja&&Math.abs(me-dt)<Ja?jh(e):(T=re-ot,R=ee-pt,L=me-dt,z=1/Math.hypot(T,R,L),T*=z,R*=z,L*=z,i=He*L-Xe*R,a=Xe*T-Ie*L,s=Ie*R-He*T,z=Math.hypot(i,a,s),z?(z=1/z,i*=z,a*=z,s*=z):(i=0,a=0,s=0),l=R*s-L*a,p=L*i-T*s,m=T*a-R*i,z=Math.hypot(l,p,m),z?(z=1/z,l*=z,p*=z,m*=z):(l=0,p=0,m=0),e[0]=i,e[1]=l,e[2]=T,e[3]=0,e[4]=a,e[5]=p,e[6]=R,e[7]=0,e[8]=s,e[9]=m,e[10]=L,e[11]=0,e[12]=-(i*re+a*ee+s*me),e[13]=-(l*re+p*ee+m*me),e[14]=-(T*re+R*ee+L*me),e[15]=1,e)}function OA(e,t,r,n){var i=t[0],a=t[1],s=t[2],l=n[0],p=n[1],m=n[2],T=i-r[0],R=a-r[1],L=s-r[2],z=T*T+R*R+L*L;z>0&&(z=1/Math.sqrt(z),T*=z,R*=z,L*=z);var re=p*L-m*R,ee=m*T-l*L,me=l*R-p*T;return z=re*re+ee*ee+me*me,z>0&&(z=1/Math.sqrt(z),re*=z,ee*=z,me*=z),e[0]=re,e[1]=ee,e[2]=me,e[3]=0,e[4]=R*me-L*ee,e[5]=L*re-T*me,e[6]=T*ee-R*re,e[7]=0,e[8]=T,e[9]=R,e[10]=L,e[11]=0,e[12]=i,e[13]=a,e[14]=s,e[15]=1,e}function NA(e){return"mat4("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+", "+e[8]+", "+e[9]+", "+e[10]+", "+e[11]+", "+e[12]+", "+e[13]+", "+e[14]+", "+e[15]+")"}function DA(e){return Math.hypot(e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8],e[9],e[10],e[11],e[12],e[13],e[14],e[15])}function Hp(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e[2]=t[2]+r[2],e[3]=t[3]+r[3],e[4]=t[4]+r[4],e[5]=t[5]+r[5],e[6]=t[6]+r[6],e[7]=t[7]+r[7],e[8]=t[8]+r[8],e[9]=t[9]+r[9],e[10]=t[10]+r[10],e[11]=t[11]+r[11],e[12]=t[12]+r[12],e[13]=t[13]+r[13],e[14]=t[14]+r[14],e[15]=t[15]+r[15],e}function LA(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e[2]=t[2]-r[2],e[3]=t[3]-r[3],e[4]=t[4]-r[4],e[5]=t[5]-r[5],e[6]=t[6]-r[6],e[7]=t[7]-r[7],e[8]=t[8]-r[8],e[9]=t[9]-r[9],e[10]=t[10]-r[10],e[11]=t[11]-r[11],e[12]=t[12]-r[12],e[13]=t[13]-r[13],e[14]=t[14]-r[14],e[15]=t[15]-r[15],e}function Wp(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e[4]=t[4]*r,e[5]=t[5]*r,e[6]=t[6]*r,e[7]=t[7]*r,e[8]=t[8]*r,e[9]=t[9]*r,e[10]=t[10]*r,e[11]=t[11]*r,e[12]=t[12]*r,e[13]=t[13]*r,e[14]=t[14]*r,e[15]=t[15]*r,e}function Kd(e,t,r,n){return e[0]=t[0]+r[0]*n,e[1]=t[1]+r[1]*n,e[2]=t[2]+r[2]*n,e[3]=t[3]+r[3]*n,e[4]=t[4]+r[4]*n,e[5]=t[5]+r[5]*n,e[6]=t[6]+r[6]*n,e[7]=t[7]+r[7]*n,e[8]=t[8]+r[8]*n,e[9]=t[9]+r[9]*n,e[10]=t[10]+r[10]*n,e[11]=t[11]+r[11]*n,e[12]=t[12]+r[12]*n,e[13]=t[13]+r[13]*n,e[14]=t[14]+r[14]*n,e[15]=t[15]+r[15]*n,e}function Jd(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]&&e[4]===t[4]&&e[5]===t[5]&&e[6]===t[6]&&e[7]===t[7]&&e[8]===t[8]&&e[9]===t[9]&&e[10]===t[10]&&e[11]===t[11]&&e[12]===t[12]&&e[13]===t[13]&&e[14]===t[14]&&e[15]===t[15]}function Bu(e,t){var r=e[0],n=e[1],i=e[2],a=e[3],s=e[4],l=e[5],p=e[6],m=e[7],T=e[8],R=e[9],L=e[10],z=e[11],re=e[12],ee=e[13],me=e[14],Ie=e[15],He=t[0],Xe=t[1],ot=t[2],pt=t[3],dt=t[4],It=t[5],Vt=t[6],Kt=t[7],yr=t[8],_r=t[9],Hr=t[10],nn=t[11],Tn=t[12],sa=t[13],Fo=t[14],jo=t[15];return Math.abs(r-He)<=Ja*Math.max(1,Math.abs(r),Math.abs(He))&&Math.abs(n-Xe)<=Ja*Math.max(1,Math.abs(n),Math.abs(Xe))&&Math.abs(i-ot)<=Ja*Math.max(1,Math.abs(i),Math.abs(ot))&&Math.abs(a-pt)<=Ja*Math.max(1,Math.abs(a),Math.abs(pt))&&Math.abs(s-dt)<=Ja*Math.max(1,Math.abs(s),Math.abs(dt))&&Math.abs(l-It)<=Ja*Math.max(1,Math.abs(l),Math.abs(It))&&Math.abs(p-Vt)<=Ja*Math.max(1,Math.abs(p),Math.abs(Vt))&&Math.abs(m-Kt)<=Ja*Math.max(1,Math.abs(m),Math.abs(Kt))&&Math.abs(T-yr)<=Ja*Math.max(1,Math.abs(T),Math.abs(yr))&&Math.abs(R-_r)<=Ja*Math.max(1,Math.abs(R),Math.abs(_r))&&Math.abs(L-Hr)<=Ja*Math.max(1,Math.abs(L),Math.abs(Hr))&&Math.abs(z-nn)<=Ja*Math.max(1,Math.abs(z),Math.abs(nn))&&Math.abs(re-Tn)<=Ja*Math.max(1,Math.abs(re),Math.abs(Tn))&&Math.abs(ee-sa)<=Ja*Math.max(1,Math.abs(ee),Math.abs(sa))&&Math.abs(me-Fo)<=Ja*Math.max(1,Math.abs(me),Math.abs(Fo))&&Math.abs(Ie-jo)<=Ja*Math.max(1,Math.abs(Ie),Math.abs(jo))}var vl=$c,gl=LA,Tc,FA,qh=(Tc=(0,Tt.b2)(),Tc(FA=function(){function e(){(0,ue.Z)(this,e),(0,ve.Z)(this,"viewport",void 0),(0,ve.Z)(this,"overridedViewProjectionMatrix",void 0),(0,ve.Z)(this,"jitteredViewProjectionMatrix",void 0),(0,ve.Z)(this,"jitteredProjectionMatrix",void 0),(0,ve.Z)(this,"viewMatrixInverse",void 0),(0,ve.Z)(this,"cameraPosition",void 0)}return(0,_e.Z)(e,[{key:"init",value:function(){}},{key:"update",value:function(r){this.viewport=r,this.viewMatrixInverse=_i(),jd(this.viewMatrixInverse,r.getViewMatrix()),this.cameraPosition=[this.viewMatrixInverse[12],this.viewMatrixInverse[13],this.viewMatrixInverse[14]]}},{key:"getProjectionMatrix",value:function(){return this.jitteredProjectionMatrix||this.viewport.getProjectionMatrix()}},{key:"getModelMatrix",value:function(){return this.viewport.getModelMatrix()}},{key:"getViewMatrix",value:function(){return this.viewport.getViewMatrix()}},{key:"getViewMatrixUncentered",value:function(){return this.viewport.getViewMatrixUncentered()}},{key:"getViewProjectionMatrixUncentered",value:function(){return this.viewport.getViewProjectionMatrixUncentered()}},{key:"getViewProjectionMatrix",value:function(){return this.overridedViewProjectionMatrix||this.jitteredViewProjectionMatrix||this.viewport.getViewProjectionMatrix()}},{key:"getZoom",value:function(){return this.viewport.getZoom()}},{key:"getZoomScale",value:function(){return this.viewport.getZoomScale()}},{key:"getCenter",value:function(){var r=this.viewport.getCenter(),n=(0,yn.Z)(r,2),i=n[0],a=n[1];return[i,a]}},{key:"getFocalDistance",value:function(){return this.viewport.getFocalDistance()}},{key:"getCameraPosition",value:function(){return this.cameraPosition}},{key:"projectFlat",value:function(r,n){return this.viewport.projectFlat(r,n)}},{key:"setViewProjectionMatrix",value:function(r){this.overridedViewProjectionMatrix=r}},{key:"jitterProjectionMatrix",value:function(r,n){var i=zp(_i(),[r,n,0]);this.jitteredProjectionMatrix=$c(_i(),i,this.viewport.getProjectionMatrix()),this.jitteredViewProjectionMatrix=$c(_i(),this.jitteredProjectionMatrix,this.viewport.getViewMatrix())}},{key:"clearJitterProjectionMatrix",value:function(){this.jitteredProjectionMatrix=void 0,this.jitteredViewProjectionMatrix=void 0}}]),e}())||FA),Kh=function(e){return e.TOPRIGHT="topright",e.TOPLEFT="topleft",e.BOTTOMRIGHT="bottomright",e.BOTTOMLEFT="bottomleft",e.TOPCENTER="topcenter",e.BOTTOMCENTER="bottomcenter",e.LEFTCENTER="leftcenter",e.RIGHTCENTER="rightcenter",e.LEFTTOP="lefttop",e.RIGHTTOP="righttop",e.LEFTBOTTOM="leftbottom",e.RIGHTBOTTOM="rightbottom",e}({}),ev,tv;function rv(e,t){var r=typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=qg(e))||t&&e&&typeof e.length=="number"){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(m){throw m},f:i}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var a=!0,s=!1,l;return{s:function(){r=r.call(e)},n:function(){var m=r.next();return a=m.done,m},e:function(m){s=!0,l=m},f:function(){try{!a&&r.return!=null&&r.return()}finally{if(s)throw l}}}}function qg(e,t){if(e){if(typeof e=="string")return nv(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return nv(e,t)}}function nv(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var Kg={topleft:"column",topright:"column",bottomright:"column",bottomleft:"column",leftcenter:"column",rightcenter:"column",topcenter:"row",bottomcenter:"row",lefttop:"row",righttop:"row",leftbottom:"row",rightbottom:"row"},iv=(ev=(0,Tt.b2)(),ev(tv=function(){function e(){(0,ue.Z)(this,e),(0,ve.Z)(this,"container",void 0),(0,ve.Z)(this,"controlCorners",void 0),(0,ve.Z)(this,"controlContainer",void 0),(0,ve.Z)(this,"scene",void 0),(0,ve.Z)(this,"mapsService",void 0),(0,ve.Z)(this,"controls",[]),(0,ve.Z)(this,"unAddControls",[])}return(0,_e.Z)(e,[{key:"init",value:function(r,n){this.container=r.container,this.scene=n,this.mapsService=n.get(xt.IMapService),this.initControlPos()}},{key:"addControl",value:function(r,n){var i=n.get(xt.IMapService);i.map?(r.addTo(this.scene),this.controls.push(r)):this.unAddControls.push(r)}},{key:"getControlByName",value:function(r){return this.controls.find(function(n){return n.controlOption.name===r})}},{key:"removeControl",value:function(r){var n=this.controls.indexOf(r);return n>-1&&this.controls.splice(n,1),r.remove(),this}},{key:"addControls",value:function(){var r=this;this.unAddControls.forEach(function(n){n.addTo(r.scene),r.controls.push(n)}),this.unAddControls=[]}},{key:"destroy",value:function(){var r=rv(this.controls),n;try{for(r.s();!(n=r.n()).done;){var i=n.value;i.remove()}}catch(a){r.e(a)}finally{r.f()}this.controls=[],this.clearControlPos()}},{key:"initControlPos",value:function(){var r=this.controlCorners={},n="l7-",i=this.controlContainer=wi("div",n+"control-container",this.container);function a(){var l=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],p=l.map(function(m){return n+m}).join(" ");r[l.filter(function(m){return!["row","column"].includes(m)}).join("")]=wi("div",p,i)}function s(l){var p=l.replace(/^(top|bottom|left|right|center)/,"$1-").split("-");return[].concat((0,cr.Z)(p),[Kg[l]])}Object.values(Kh).forEach(function(l){a(s(l))}),this.checkCornerOverlap()}},{key:"clearControlPos",value:function(){for(var r in this.controlCorners)this.controlCorners[r]&&Is(this.controlCorners[r]);this.controlContainer&&Is(this.controlContainer)}},{key:"checkCornerOverlap",value:function(){var r=this,n=window.MutationObserver;if(n)for(var i=function(){var p=s[a],m=p.match(/^(top|bottom)(left|right)$/);if(m){var T=(0,yn.Z)(m,3),R=T[1],L=T[2],z=r.controlCorners["".concat(R).concat(L)],re=new n(function(ee){var me=(0,yn.Z)(ee,1),Ie=me[0].target;z&&(z.style[R]=Ie.clientHeight+"px")});re.observe(r.controlCorners["".concat(L).concat(R)],{childList:!0,attributes:!0})}},a=0,s=Object.keys(this.controlCorners);a<s.length;a++)i()}}]),e}())||tv),Jg,BA,em=(Jg=(0,Tt.b2)(),Jg(BA=function(){function e(){(0,ue.Z)(this,e),(0,ve.Z)(this,"container",void 0),(0,ve.Z)(this,"scene",void 0),(0,ve.Z)(this,"mapsService",void 0),(0,ve.Z)(this,"markers",[]),(0,ve.Z)(this,"markerLayers",[]),(0,ve.Z)(this,"unAddMarkers",[]),(0,ve.Z)(this,"unAddMarkerLayers",[])}return(0,_e.Z)(e,[{key:"addMarkerLayer",value:function(r){this.mapsService.map&&this.mapsService.getMarkerContainer()?(this.markerLayers.push(r),r.addTo(this.scene)):this.unAddMarkerLayers.push(r)}},{key:"removeMarkerLayer",value:function(r){r.destroy(),this.markerLayers.indexOf(r);var n=this.markerLayers.indexOf(r);n>-1&&this.markerLayers.splice(n,1)}},{key:"addMarker",value:function(r){this.mapsService.map&&this.mapsService.getMarkerContainer()?(this.markers.push(r),r.addTo(this.scene)):this.unAddMarkers.push(r)}},{key:"addMarkers",value:function(){var r=this;this.unAddMarkers.forEach(function(n){n.addTo(r.scene),r.markers.push(n)}),this.unAddMarkers=[]}},{key:"addMarkerLayers",value:function(){var r=this;this.unAddMarkerLayers.forEach(function(n){r.markerLayers.push(n),n.addTo(r.scene)}),this.unAddMarkers=[]}},{key:"removeMarker",value:function(r){r.remove(),this.markers.indexOf(r);var n=this.markers.indexOf(r);n>-1&&this.markers.splice(n,1)}},{key:"removeAllMarkers",value:function(){this.destroy()}},{key:"init",value:function(r){this.scene=r,this.mapsService=r.get(xt.IMapService)}},{key:"destroy",value:function(){this.markers.forEach(function(r){r.remove()}),this.markers=[],this.markerLayers.forEach(function(r){r.destroy()}),this.markerLayers=[]}},{key:"removeMakerLayerMarker",value:function(r){r.destroy()}}]),e}())||BA),jp,Xp,av=(jp=(0,Tt.b2)(),jp(Xp=function(){function e(){(0,ue.Z)(this,e),(0,ve.Z)(this,"scene",void 0),(0,ve.Z)(this,"mapsService",void 0),(0,ve.Z)(this,"popups",[]),(0,ve.Z)(this,"unAddPopups",[])}return(0,_e.Z)(e,[{key:"isMarkerReady",get:function(){return this.mapsService.map&&this.mapsService.getMarkerContainer()}},{key:"removePopup",value:function(r){r!=null&&r.isOpen()&&r.remove();var n=this.popups.indexOf(r);n>-1&&this.popups.splice(n,1);var i=this.unAddPopups.indexOf(r);i>-1&&this.unAddPopups.splice(i,1)}},{key:"destroy",value:function(){this.popups.forEach(function(r){return r.remove()})}},{key:"addPopup",value:function(r){var n=this;r&&r.getOptions().autoClose&&[].concat((0,cr.Z)(this.popups),(0,cr.Z)(this.unAddPopups)).forEach(function(i){i.getOptions().autoClose&&n.removePopup(i)}),this.isMarkerReady?(r.addTo(this.scene),this.popups.push(r)):this.unAddPopups.push(r),r.on("close",function(){n.removePopup(r)})}},{key:"initPopup",value:function(){var r=this;this.unAddPopups.length&&this.unAddPopups.forEach(function(n){r.addPopup(n),r.unAddPopups=[]})}},{key:"init",value:function(r){this.scene=r,this.mapsService=r.get(xt.IMapService)}}]),e}())||Xp),D0=function(e){return e.normal="normal",e.additive="additive",e.subtractive="subtractive",e.min="min",e.max="max",e.none="none",e}({}),L0=function(e){return e.MULTIPLE="MULTIPLE",e.SINGLE="SINGLE",e}({}),Jh=function(e){return e.AND="and",e.OR="or",e}({}),xu=function(e){return e.INIT="init",e.UPDATE="update",e}({}),tm={MapToken:"\u60A8\u6B63\u5728\u4F7F\u7528 Demo \u6D4B\u8BD5 Token, \u751F\u4EA7\u73AF\u5883\u52A1\u5FC5\u81EA\u884C\u6CE8\u518C Token \u786E\u4FDD\u670D\u52A1\u7A33\u5B9A \u9AD8\u5FB7\u5730\u56FE\u7533\u8BF7\u5730\u5740 https://lbs.amap.com/api/javascript-api/guide/abc/prepare  Mapbox\u5730\u56FE\u7533\u8BF7\u5730\u5740 https://docs.mapbox.com/help/glossary/access-token/",SDK:"\u8BF7\u786E\u8BA4\u5F15\u5165\u4E86mapbox-gl api\u4E14\u5728L7\u4E4B\u524D\u5F15\u5165"},kA=tm,ov,Yp,rm=Fn.merge,eA={id:"map",logoPosition:"bottomleft",logoVisible:!0,antialias:!0,stencil:!0,preserveDrawingBuffer:!1,pickBufferScale:1,fitBoundsOptions:{animate:!1}},UA={colors:["rgb(103,0,31)","rgb(178,24,43)","rgb(214,96,77)","rgb(244,165,130)","rgb(253,219,199)","rgb(247,247,247)","rgb(209,229,240)","rgb(146,197,222)","rgb(67,147,195)","rgb(33,102,172)","rgb(5,48,97)"],size:10,shape:"circle",scales:{},shape2d:["circle","triangle","square","pentagon","hexagon","octogon","hexagram","rhombus","vesica"],shape3d:["cylinder","triangleColumn","hexagonColumn","squareColumn"],minZoom:-1,maxZoom:24,visible:!0,autoFit:!1,pickingBuffer:0,enablePropagation:!1,zIndex:0,blend:"normal",maskLayers:[],enableMask:!0,maskOperation:Jh.AND,pickedFeatureID:-1,enableMultiPassRenderer:!1,enablePicking:!0,active:!1,activeColor:"#2f54eb",enableHighlight:!1,enableSelect:!1,highlightColor:"#2f54eb",activeMix:0,selectColor:"blue",selectMix:0,enableTAA:!1,jitterScale:1,enableLighting:!1,animateOption:{enable:!1,interval:.2,duration:4,trailLength:.15},forward:!0},nm=(ov=(0,Tt.b2)(),ov(Yp=function(){function e(){(0,ue.Z)(this,e),(0,ve.Z)(this,"sceneConfigCache",{}),(0,ve.Z)(this,"layerConfigCache",{}),(0,ve.Z)(this,"layerAttributeConfigCache",{})}return(0,_e.Z)(e,[{key:"getSceneConfig",value:function(r){return this.sceneConfigCache[r]}},{key:"getSceneWarninfo",value:function(r){return kA[r]}},{key:"setSceneConfig",value:function(r,n){this.sceneConfigCache[r]=(0,Q.Z)((0,Q.Z)({},eA),n)}},{key:"getLayerConfig",value:function(r){return this.layerConfigCache[r]}},{key:"setLayerConfig",value:function(r,n,i){this.layerConfigCache[n]=(0,Q.Z)({},rm({},this.sceneConfigCache[r],UA,i))}},{key:"getAttributeConfig",value:function(r){return this.layerAttributeConfigCache[r]}},{key:"setAttributeConfig",value:function(r,n){this.layerAttributeConfigCache[r]=(0,Q.Z)((0,Q.Z)({},this.layerAttributeConfigCache[r]),n)}},{key:"clean",value:function(){this.sceneConfigCache={},this.layerConfigCache={}}}]),e}())||Yp);function fa(e,t,r,n){r&&Object.defineProperty(e,t,{enumerable:r.enumerable,configurable:r.configurable,writable:r.writable,value:r.initializer?r.initializer.call(n):void 0})}function Ji(e,t,r,n,i){var a={};return Object.keys(n).forEach(function(s){a[s]=n[s]}),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=r.slice().reverse().reduce(function(s,l){return l(e,t,s)||s},a),i&&a.initializer!==void 0&&(a.value=a.initializer?a.initializer.call(i):void 0,a.initializer=void 0),a.initializer===void 0&&(Object.defineProperty(e,t,a),a=null),a}function $p(){var e=new xs(4);return xs!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0,e[3]=0),e}function sv(e){var t=new glMatrix.ARRAY_TYPE(4);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t}function Qp(e,t,r,n){var i=new xs(4);return i[0]=e,i[1]=t,i[2]=r,i[3]=n,i}function qp(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e}function Kp(e,t,r,n,i){return e[0]=t,e[1]=r,e[2]=n,e[3]=i,e}function tA(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e[2]=t[2]+r[2],e[3]=t[3]+r[3],e}function X_(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e[2]=t[2]-r[2],e[3]=t[3]-r[3],e}function Y_(e,t,r){return e[0]=t[0]*r[0],e[1]=t[1]*r[1],e[2]=t[2]*r[2],e[3]=t[3]*r[3],e}function $_(e,t,r){return e[0]=t[0]/r[0],e[1]=t[1]/r[1],e[2]=t[2]/r[2],e[3]=t[3]/r[3],e}function Q_(e,t){return e[0]=Math.ceil(t[0]),e[1]=Math.ceil(t[1]),e[2]=Math.ceil(t[2]),e[3]=Math.ceil(t[3]),e}function q_(e,t){return e[0]=Math.floor(t[0]),e[1]=Math.floor(t[1]),e[2]=Math.floor(t[2]),e[3]=Math.floor(t[3]),e}function uv(e,t,r){return e[0]=Math.min(t[0],r[0]),e[1]=Math.min(t[1],r[1]),e[2]=Math.min(t[2],r[2]),e[3]=Math.min(t[3],r[3]),e}function K_(e,t,r){return e[0]=Math.max(t[0],r[0]),e[1]=Math.max(t[1],r[1]),e[2]=Math.max(t[2],r[2]),e[3]=Math.max(t[3],r[3]),e}function Jp(e,t){return e[0]=Math.round(t[0]),e[1]=Math.round(t[1]),e[2]=Math.round(t[2]),e[3]=Math.round(t[3]),e}function lv(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e}function im(e,t,r,n){return e[0]=t[0]+r[0]*n,e[1]=t[1]+r[1]*n,e[2]=t[2]+r[2]*n,e[3]=t[3]+r[3]*n,e}function ed(e,t){var r=t[0]-e[0],n=t[1]-e[1],i=t[2]-e[2],a=t[3]-e[3];return Math.hypot(r,n,i,a)}function am(e,t){var r=t[0]-e[0],n=t[1]-e[1],i=t[2]-e[2],a=t[3]-e[3];return r*r+n*n+i*i+a*a}function om(e){var t=e[0],r=e[1],n=e[2],i=e[3];return Math.hypot(t,r,n,i)}function sm(e){var t=e[0],r=e[1],n=e[2],i=e[3];return t*t+r*r+n*n+i*i}function J_(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=-t[3],e}function um(e,t){return e[0]=1/t[0],e[1]=1/t[1],e[2]=1/t[2],e[3]=1/t[3],e}function lT(e,t){var r=t[0],n=t[1],i=t[2],a=t[3],s=r*r+n*n+i*i+a*a;return s>0&&(s=1/Math.sqrt(s)),e[0]=r*s,e[1]=n*s,e[2]=i*s,e[3]=a*s,e}function lm(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]*t[3]}function cm(e,t,r,n){var i=r[0]*n[1]-r[1]*n[0],a=r[0]*n[2]-r[2]*n[0],s=r[0]*n[3]-r[3]*n[0],l=r[1]*n[2]-r[2]*n[1],p=r[1]*n[3]-r[3]*n[1],m=r[2]*n[3]-r[3]*n[2],T=t[0],R=t[1],L=t[2],z=t[3];return e[0]=R*m-L*p+z*l,e[1]=-(T*m)+L*s-z*a,e[2]=T*p-R*s+z*i,e[3]=-(T*l)+R*a-L*i,e}function ey(e,t,r,n){var i=t[0],a=t[1],s=t[2],l=t[3];return e[0]=i+n*(r[0]-i),e[1]=a+n*(r[1]-a),e[2]=s+n*(r[2]-s),e[3]=l+n*(r[3]-l),e}function cT(e,t){t=t||1;var r,n,i,a,s,l;do r=glMatrix.RANDOM()*2-1,n=glMatrix.RANDOM()*2-1,s=r*r+n*n;while(s>=1);do i=glMatrix.RANDOM()*2-1,a=glMatrix.RANDOM()*2-1,l=i*i+a*a;while(l>=1);var p=Math.sqrt((1-s)/l);return e[0]=t*r,e[1]=t*n,e[2]=t*i*p,e[3]=t*a*p,e}function cv(e,t,r){var n=t[0],i=t[1],a=t[2],s=t[3];return e[0]=r[0]*n+r[4]*i+r[8]*a+r[12]*s,e[1]=r[1]*n+r[5]*i+r[9]*a+r[13]*s,e[2]=r[2]*n+r[6]*i+r[10]*a+r[14]*s,e[3]=r[3]*n+r[7]*i+r[11]*a+r[15]*s,e}function fv(e,t,r){var n=t[0],i=t[1],a=t[2],s=r[0],l=r[1],p=r[2],m=r[3],T=m*n+l*a-p*i,R=m*i+p*n-s*a,L=m*a+s*i-l*n,z=-s*n-l*i-p*a;return e[0]=T*m+z*-s+R*-p-L*-l,e[1]=R*m+z*-l+L*-s-T*-p,e[2]=L*m+z*-p+T*-l-R*-s,e[3]=t[3],e}function hv(e){return e[0]=0,e[1]=0,e[2]=0,e[3]=0,e}function fm(e){return"vec4("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+")"}function hm(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]}function Av(e,t){var r=e[0],n=e[1],i=e[2],a=e[3],s=t[0],l=t[1],p=t[2],m=t[3];return Math.abs(r-s)<=glMatrix.EPSILON*Math.max(1,Math.abs(r),Math.abs(s))&&Math.abs(n-l)<=glMatrix.EPSILON*Math.max(1,Math.abs(n),Math.abs(l))&&Math.abs(i-p)<=glMatrix.EPSILON*Math.max(1,Math.abs(i),Math.abs(p))&&Math.abs(a-m)<=glMatrix.EPSILON*Math.max(1,Math.abs(a),Math.abs(m))}var pv=null,lh=null,ty=null,ry=null,Am=null,ny=null,fT=null,rA=function(){var e=$p();return function(t,r,n,i,a,s){var l,p;for(r||(r=4),n||(n=0),i?p=Math.min(i*r+n,t.length):p=t.length,l=n;l<p;l+=r)e[0]=t[l],e[1]=t[l+1],e[2]=t[l+2],e[3]=t[l+3],a(e,e,s),t[l]=e[0],t[l+1]=e[1],t[l+2]=e[2],t[l+3]=e[3];return t}}(),ch=Math.PI/180,nA=512,iA=4003e4;function pm(e){var t=e.latitude,r=t===void 0?0:t,n=e.zoom,i=n===void 0?0:n,a=e.scale,s=e.highPrecision,l=s===void 0?!1:s,p=e.flipY,m=p===void 0?!1:p;a=a!==void 0?a:Math.pow(2,i);var T={},R=nA*a,L=Math.cos(r*ch),z=R/360,re=z/L,ee=R/iA/L;if(T.pixelsPerMeter=[ee,-ee,ee],T.metersPerPixel=[1/ee,-1/ee,1/ee],T.pixelsPerDegree=[z,-re,ee],T.degreesPerPixel=[1/z,-1/re,1/ee],l){var me=ch*Math.tan(r*ch)/L,Ie=z*me/2,He=R/iA*me,Xe=He/re*ee;T.pixelsPerDegree2=[0,-Ie,He],T.pixelsPerMeter2=[Xe,0,Xe],m&&(T.pixelsPerDegree2[1]=-T.pixelsPerDegree2[1],T.pixelsPerMeter2[1]=-T.pixelsPerMeter2[1])}return m&&(T.pixelsPerMeter[1]=-T.pixelsPerMeter[1],T.metersPerPixel[1]=-T.metersPerPixel[1],T.pixelsPerDegree[1]=-T.pixelsPerDegree[1],T.degreesPerPixel[1]=-T.degreesPerPixel[1]),T}var c0=function(e){return e[e.LNGLAT=1]="LNGLAT",e[e.LNGLAT_OFFSET=2]="LNGLAT_OFFSET",e[e.VECTOR_TILE=3]="VECTOR_TILE",e[e.IDENTITY=4]="IDENTITY",e[e.P20=5]="P20",e[e.P20_OFFSET=6]="P20_OFFSET",e[e.METER_OFFSET=7]="METER_OFFSET",e[e.P20_2=8]="P20_2",e}({}),fh={CoordinateSystem:"u_CoordinateSystem",ViewportCenter:"u_ViewportCenter",ViewportCenterProjection:"u_ViewportCenterProjection",PixelsPerDegree:"u_PixelsPerDegree",PixelsPerDegree2:"u_PixelsPerDegree2",PixelsPerMeter:"u_PixelsPerMeter",Mvp:"u_Mvp"},ZA,zA,hh,Ah,aA,ph=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0],td=(ZA=(0,Tt.b2)(),zA=(0,Tt.f3)(xt.ICameraService),ZA(hh=(Ah=function(){function e(){(0,ue.Z)(this,e),(0,ve.Z)(this,"needRefresh",!0),fa(this,"cameraService",aA,this),(0,ve.Z)(this,"coordinateSystem",void 0),(0,ve.Z)(this,"viewportCenter",void 0),(0,ve.Z)(this,"viewportCenterProjection",void 0),(0,ve.Z)(this,"pixelsPerDegree",void 0),(0,ve.Z)(this,"pixelsPerDegree2",void 0),(0,ve.Z)(this,"pixelsPerMeter",void 0)}return(0,_e.Z)(e,[{key:"refresh",value:function(r){var n=this.cameraService.getZoom(),i=this.cameraService.getZoomScale(),a=r||this.cameraService.getCenter(),s=pm({latitude:a[1],zoom:n}),l=s.pixelsPerMeter,p=s.pixelsPerDegree;this.viewportCenter=a,this.viewportCenterProjection=[0,0,0,0],this.pixelsPerMeter=l,this.pixelsPerDegree=p,this.pixelsPerDegree2=[0,0,0],this.coordinateSystem===c0.LNGLAT||this.coordinateSystem===c0.P20?this.cameraService.setViewProjectionMatrix(void 0):this.coordinateSystem===c0.LNGLAT_OFFSET?this.calculateLnglatOffset(a,n):this.coordinateSystem===c0.P20_OFFSET&&this.calculateLnglatOffset(a,n,i,!0),this.needRefresh=!1}},{key:"getCoordinateSystem",value:function(){return this.coordinateSystem}},{key:"setCoordinateSystem",value:function(r){this.coordinateSystem=r}},{key:"getViewportCenter",value:function(){return this.viewportCenter}},{key:"getViewportCenterProjection",value:function(){return this.viewportCenterProjection}},{key:"getPixelsPerDegree",value:function(){return this.pixelsPerDegree}},{key:"getPixelsPerDegree2",value:function(){return this.pixelsPerDegree2}},{key:"getPixelsPerMeter",value:function(){return this.pixelsPerMeter}},{key:"calculateLnglatOffset",value:function(r,n,i,a){var s=pm({latitude:r[1],zoom:n,scale:i,flipY:a,highPrecision:!0}),l=s.pixelsPerMeter,p=s.pixelsPerDegree,m=s.pixelsPerDegree2,T=this.cameraService.getViewMatrix(),R=this.cameraService.getProjectionMatrix(),L=$c([],R,T),z=this.cameraService.projectFlat([Math.fround(r[0]),Math.fround(r[1])],Math.pow(2,n));this.viewportCenterProjection=cv([],[z[0],z[1],0,1],L),T=this.cameraService.getViewMatrixUncentered()||T,L=$c([],R,T),L=$c([],L,ph),this.cameraService.setViewProjectionMatrix(L),this.pixelsPerMeter=l,this.pixelsPerDegree=p,this.pixelsPerDegree2=m}}]),e}(),aA=Ji(Ah.prototype,"cameraService",[zA],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ah))||hh),GA,dh;function dv(e){var t=vv();return function(){var n=(0,le.Z)(e),i;if(t){var a=(0,le.Z)(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return(0,ze.Z)(this,i)}}function vv(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var Tf=(GA=(0,Tt.b2)(),GA(dh=function(e){(0,ke.Z)(r,e);var t=dv(r);function r(){var n;(0,ue.Z)(this,r);for(var i=arguments.length,a=new Array(i),s=0;s<i;s++)a[s]=arguments[s];return n=t.call.apply(t,[this].concat(a)),(0,ve.Z)((0,St.Z)(n),"renderMap",new Map),(0,ve.Z)((0,St.Z)(n),"enable",!1),(0,ve.Z)((0,St.Z)(n),"renderEnable",!1),(0,ve.Z)((0,St.Z)(n),"cacheLogs",{}),n}return(0,_e.Z)(r,[{key:"setEnable",value:function(i){this.enable=!!i}},{key:"log",value:function(i,a){var s=this;if(this.enable){var l=i.split("."),p=null;l.forEach(function(m,T){p!==null?(p[m]||(p[m]={}),T!==l.length-1&&(p=p[m])):(s.cacheLogs[m]||(s.cacheLogs[m]={}),T!==l.length-1&&(p=s.cacheLogs[m])),T===l.length-1&&(p[m]=(0,Q.Z)((0,Q.Z)({time:Date.now()},p[m]),a))})}}},{key:"getLog",value:function(i){var a=this;switch((0,eu.Z)(i)){case"string":return this.cacheLogs[i];case"object":return i.map(function(s){return a.cacheLogs[s]}).filter(function(s){return s!==void 0});case"undefined":return this.cacheLogs}}},{key:"removeLog",value:function(i){delete this.cacheLogs[i]}},{key:"generateRenderUid",value:function(){return this.renderEnable?ul():""}},{key:"renderDebug",value:function(i){this.renderEnable=i}},{key:"renderStart",value:function(i){if(!(!this.renderEnable||!this.enable)){var a=this.renderMap.get(i)||{};this.renderMap.set(i,(0,Q.Z)((0,Q.Z)({},a),{},{renderUid:i,renderStart:Date.now()}))}}},{key:"renderEnd",value:function(i){if(!(!this.renderEnable||!this.enable)){var a=this.renderMap.get(i);if(a){var s=a.renderStart,l=Date.now();this.emit("renderEnd",(0,Q.Z)((0,Q.Z)({},a),{},{renderEnd:l,renderDuration:l-s})),this.renderMap.delete(i)}}}},{key:"destroy",value:function(){this.cacheLogs=null,this.renderMap.clear()}}]),r}(Si.EventEmitter))||dh),Cf=C(83959),kl=C.n(Cf),Vs=function(e){return e.Hover="hover",e.Click="click",e.Select="select",e.Active="active",e.Drag="drag",e}({}),rd,gv,mv,VA,_v;function dm(e){var t=vm();return function(){var n=(0,le.Z)(e),i;if(t){var a=(0,le.Z)(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return(0,ze.Z)(this,i)}}function vm(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var yv={panstart:"dragstart",panmove:"dragging",panend:"dragend",pancancel:"dragcancel"},iy=(rd=(0,Tt.b2)(),gv=(0,Tt.f3)(xt.IMapService),rd(mv=(VA=function(e){(0,ke.Z)(r,e);var t=dm(r);function r(){var n;(0,ue.Z)(this,r);for(var i=arguments.length,a=new Array(i),s=0;s<i;s++)a[s]=arguments[s];return n=t.call.apply(t,[this].concat(a)),(0,ve.Z)((0,St.Z)(n),"indragging",!1),fa((0,St.Z)(n),"mapService",_v,(0,St.Z)(n)),(0,ve.Z)((0,St.Z)(n),"hammertime",void 0),(0,ve.Z)((0,St.Z)(n),"lastClickTime",0),(0,ve.Z)((0,St.Z)(n),"lastClickXY",[-1,-1]),(0,ve.Z)((0,St.Z)(n),"clickTimer",void 0),(0,ve.Z)((0,St.Z)(n),"$containter",void 0),(0,ve.Z)((0,St.Z)(n),"onDrag",function(l){var p=n.interactionEvent(l);p.type=yv[p.type],p.type==="dragging"?n.indragging=!0:n.indragging=!1,n.emit(Vs.Drag,p)}),(0,ve.Z)((0,St.Z)(n),"onHammer",function(l){l.srcEvent.stopPropagation();var p=n.interactionEvent(l);n.emit(Vs.Hover,p)}),(0,ve.Z)((0,St.Z)(n),"onTouch",function(l){var p=l.touches[0];n.onHover({x:p.pageX,y:p.pageY,type:"touch"})}),(0,ve.Z)((0,St.Z)(n),"onHover",function(l){var p=l.clientX,m=l.clientY,T=p,R=m,L=l.type,z=n.mapService.getMapContainer();if(z){var re=z.getBoundingClientRect(),ee=re.top,me=re.left;T=T-me-z.clientLeft,R=R-ee-z.clientTop}var Ie=n.mapService.containerToLngLat([T,R]);if(L==="click"){n.isDoubleTap(T,R,Ie);return}if(L==="touch"){n.isDoubleTap(T,R,Ie);return}L!=="click"&&L!=="dblclick"&&n.emit(Vs.Hover,{x:T,y:R,lngLat:Ie,type:L,target:l})}),n}return(0,_e.Z)(r,[{key:"init",value:function(){this.addEventListenerOnMap(),this.$containter=this.mapService.getMapContainer()}},{key:"destroy",value:function(){this.hammertime&&this.hammertime.destroy(),this.removeEventListenerOnMap(),this.off(Vs.Hover)}},{key:"triggerHover",value:function(i){var a=i.x,s=i.y;this.emit(Vs.Hover,{x:a,y:s})}},{key:"triggerSelect",value:function(i){this.emit(Vs.Select,{featureId:i})}},{key:"triggerActive",value:function(i){this.emit(Vs.Active,{featureId:i})}},{key:"handleMiniEvent",value:function(i){this.onHover({clientX:i.touches[0].pageX,clientY:i.touches[0].pageY,type:"touch"})}},{key:"addEventListenerOnMap",value:function(){var i=this.mapService.getMapContainer();if(i){var a=new(kl()).Manager(i);a.add(new(kl()).Tap({event:"dblclick",taps:2})),a.add(new(kl()).Tap({event:"click"})),a.add(new(kl()).Pan({threshold:0,pointers:0})),a.add(new(kl()).Press({})),a.on("dblclick click",this.onHammer),a.on("panstart panmove panend pancancel",this.onDrag),i.addEventListener("mousemove",this.onHover),i.addEventListener("mousedown",this.onHover,!0),i.addEventListener("mouseup",this.onHover),i.addEventListener("contextmenu",this.onHover),this.hammertime=a}}},{key:"removeEventListenerOnMap",value:function(){var i=this.mapService.getMapContainer();i&&(i.removeEventListener("mousemove",this.onHover),this.hammertime.off("dblclick click",this.onHammer),this.hammertime.off("panstart panmove panend pancancel",this.onDrag),i.removeEventListener("mousedown",this.onHover),i.removeEventListener("mouseup",this.onHover),i.removeEventListener("contextmenu",this.onHover))}},{key:"interactionEvent",value:function(i){var a=i.type,s=i.pointerType,l,p;s==="touch"?(p=Math.floor(i.pointers[0].clientY),l=Math.floor(i.pointers[0].clientX)):(p=Math.floor(i.srcEvent.y),l=Math.floor(i.srcEvent.x));var m=this.mapService.getMapContainer();if(m){var T=m.getBoundingClientRect(),R=T.top,L=T.left;l-=L,p-=R}var z=this.mapService.containerToLngLat([l,p]);return{x:l,y:p,lngLat:z,type:a,target:i.srcEvent}}},{key:"isDoubleTap",value:function(i,a,s){var l=this,p=new Date().getTime(),m="click";p-this.lastClickTime<400&&Math.abs(this.lastClickXY[0]-i)<10&&Math.abs(this.lastClickXY[1]-a)<10?(this.lastClickTime=0,this.lastClickXY=[-1,-1],this.clickTimer&&clearTimeout(this.clickTimer),m="dblclick",this.emit(Vs.Hover,{x:i,y:a,lngLat:s,type:m})):(this.lastClickTime=p,this.lastClickXY=[i,a],this.clickTimer=setTimeout(function(){m="click",l.emit(Vs.Hover,{x:i,y:a,lngLat:s,type:m})},400))}}]),r}(cl()),_v=Ji(VA.prototype,"mapService",[gv],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),VA))||mv),gm=0;function nd(e){var t=e;if(typeof e=="string"&&(t=document.getElementById(e)),t){var r=document.createElement("div");return r.style.cssText+=`
      position: absolute;
      z-index:2;
      height: 100%;
      width: 100%;
      pointer-events: none;
    `,r.id="l7-scene-".concat(gm++),r.classList.add("l7-scene"),t.appendChild(r),r}return null}function id(e){var t,r=!0;if((e==null||(t=e.target)===null||t===void 0?void 0:t.target)instanceof HTMLElement)for(var n,i=e==null||(n=e.target)===null||n===void 0?void 0:n.target;i;){var a,s=Array.from(i.classList);if(s.includes("l7-marker")||s.includes("l7-popup")){r=!1;break}i=(a=i)===null||a===void 0?void 0:a.parentElement}return r}var Fe=function(e){return e[e.DEPTH_BUFFER_BIT=256]="DEPTH_BUFFER_BIT",e[e.STENCIL_BUFFER_BIT=1024]="STENCIL_BUFFER_BIT",e[e.COLOR_BUFFER_BIT=16384]="COLOR_BUFFER_BIT",e[e.POINTS=0]="POINTS",e[e.LINES=1]="LINES",e[e.LINE_LOOP=2]="LINE_LOOP",e[e.LINE_STRIP=3]="LINE_STRIP",e[e.TRIANGLES=4]="TRIANGLES",e[e.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",e[e.TRIANGLE_FAN=6]="TRIANGLE_FAN",e[e.ZERO=0]="ZERO",e[e.ONE=1]="ONE",e[e.SRC_COLOR=768]="SRC_COLOR",e[e.ONE_MINUS_SRC_COLOR=769]="ONE_MINUS_SRC_COLOR",e[e.SRC_ALPHA=770]="SRC_ALPHA",e[e.ONE_MINUS_SRC_ALPHA=771]="ONE_MINUS_SRC_ALPHA",e[e.DST_ALPHA=772]="DST_ALPHA",e[e.ONE_MINUS_DST_ALPHA=773]="ONE_MINUS_DST_ALPHA",e[e.DST_COLOR=774]="DST_COLOR",e[e.ONE_MINUS_DST_COLOR=775]="ONE_MINUS_DST_COLOR",e[e.SRC_ALPHA_SATURATE=776]="SRC_ALPHA_SATURATE",e[e.FUNC_ADD=32774]="FUNC_ADD",e[e.BLEND_EQUATION=32777]="BLEND_EQUATION",e[e.BLEND_EQUATION_RGB=32777]="BLEND_EQUATION_RGB",e[e.BLEND_EQUATION_ALPHA=34877]="BLEND_EQUATION_ALPHA",e[e.FUNC_SUBTRACT=32778]="FUNC_SUBTRACT",e[e.FUNC_REVERSE_SUBTRACT=32779]="FUNC_REVERSE_SUBTRACT",e[e.MAX_EXT=32776]="MAX_EXT",e[e.MIN_EXT=32775]="MIN_EXT",e[e.BLEND_DST_RGB=32968]="BLEND_DST_RGB",e[e.BLEND_SRC_RGB=32969]="BLEND_SRC_RGB",e[e.BLEND_DST_ALPHA=32970]="BLEND_DST_ALPHA",e[e.BLEND_SRC_ALPHA=32971]="BLEND_SRC_ALPHA",e[e.CONSTANT_COLOR=32769]="CONSTANT_COLOR",e[e.ONE_MINUS_CONSTANT_COLOR=32770]="ONE_MINUS_CONSTANT_COLOR",e[e.CONSTANT_ALPHA=32771]="CONSTANT_ALPHA",e[e.ONE_MINUS_CONSTANT_ALPHA=32772]="ONE_MINUS_CONSTANT_ALPHA",e[e.BLEND_COLOR=32773]="BLEND_COLOR",e[e.ARRAY_BUFFER=34962]="ARRAY_BUFFER",e[e.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",e[e.ARRAY_BUFFER_BINDING=34964]="ARRAY_BUFFER_BINDING",e[e.ELEMENT_ARRAY_BUFFER_BINDING=34965]="ELEMENT_ARRAY_BUFFER_BINDING",e[e.STREAM_DRAW=35040]="STREAM_DRAW",e[e.STATIC_DRAW=35044]="STATIC_DRAW",e[e.DYNAMIC_DRAW=35048]="DYNAMIC_DRAW",e[e.BUFFER_SIZE=34660]="BUFFER_SIZE",e[e.BUFFER_USAGE=34661]="BUFFER_USAGE",e[e.CURRENT_VERTEX_ATTRIB=34342]="CURRENT_VERTEX_ATTRIB",e[e.FRONT=1028]="FRONT",e[e.BACK=1029]="BACK",e[e.FRONT_AND_BACK=1032]="FRONT_AND_BACK",e[e.CULL_FACE=2884]="CULL_FACE",e[e.BLEND=3042]="BLEND",e[e.DITHER=3024]="DITHER",e[e.STENCIL_TEST=2960]="STENCIL_TEST",e[e.DEPTH_TEST=2929]="DEPTH_TEST",e[e.SCISSOR_TEST=3089]="SCISSOR_TEST",e[e.POLYGON_OFFSET_FILL=32823]="POLYGON_OFFSET_FILL",e[e.SAMPLE_ALPHA_TO_COVERAGE=32926]="SAMPLE_ALPHA_TO_COVERAGE",e[e.SAMPLE_COVERAGE=32928]="SAMPLE_COVERAGE",e[e.NO_ERROR=0]="NO_ERROR",e[e.INVALID_ENUM=1280]="INVALID_ENUM",e[e.INVALID_VALUE=1281]="INVALID_VALUE",e[e.INVALID_OPERATION=1282]="INVALID_OPERATION",e[e.OUT_OF_MEMORY=1285]="OUT_OF_MEMORY",e[e.CW=2304]="CW",e[e.CCW=2305]="CCW",e[e.LINE_WIDTH=2849]="LINE_WIDTH",e[e.ALIASED_POINT_SIZE_RANGE=33901]="ALIASED_POINT_SIZE_RANGE",e[e.ALIASED_LINE_WIDTH_RANGE=33902]="ALIASED_LINE_WIDTH_RANGE",e[e.CULL_FACE_MODE=2885]="CULL_FACE_MODE",e[e.FRONT_FACE=2886]="FRONT_FACE",e[e.DEPTH_RANGE=2928]="DEPTH_RANGE",e[e.DEPTH_WRITEMASK=2930]="DEPTH_WRITEMASK",e[e.DEPTH_CLEAR_VALUE=2931]="DEPTH_CLEAR_VALUE",e[e.DEPTH_FUNC=2932]="DEPTH_FUNC",e[e.STENCIL_CLEAR_VALUE=2961]="STENCIL_CLEAR_VALUE",e[e.STENCIL_FUNC=2962]="STENCIL_FUNC",e[e.STENCIL_FAIL=2964]="STENCIL_FAIL",e[e.STENCIL_PASS_DEPTH_FAIL=2965]="STENCIL_PASS_DEPTH_FAIL",e[e.STENCIL_PASS_DEPTH_PASS=2966]="STENCIL_PASS_DEPTH_PASS",e[e.STENCIL_REF=2967]="STENCIL_REF",e[e.STENCIL_VALUE_MASK=2963]="STENCIL_VALUE_MASK",e[e.STENCIL_WRITEMASK=2968]="STENCIL_WRITEMASK",e[e.STENCIL_BACK_FUNC=34816]="STENCIL_BACK_FUNC",e[e.STENCIL_BACK_FAIL=34817]="STENCIL_BACK_FAIL",e[e.STENCIL_BACK_PASS_DEPTH_FAIL=34818]="STENCIL_BACK_PASS_DEPTH_FAIL",e[e.STENCIL_BACK_PASS_DEPTH_PASS=34819]="STENCIL_BACK_PASS_DEPTH_PASS",e[e.STENCIL_BACK_REF=36003]="STENCIL_BACK_REF",e[e.STENCIL_BACK_VALUE_MASK=36004]="STENCIL_BACK_VALUE_MASK",e[e.STENCIL_BACK_WRITEMASK=36005]="STENCIL_BACK_WRITEMASK",e[e.VIEWPORT=2978]="VIEWPORT",e[e.SCISSOR_BOX=3088]="SCISSOR_BOX",e[e.COLOR_CLEAR_VALUE=3106]="COLOR_CLEAR_VALUE",e[e.COLOR_WRITEMASK=3107]="COLOR_WRITEMASK",e[e.UNPACK_ALIGNMENT=3317]="UNPACK_ALIGNMENT",e[e.PACK_ALIGNMENT=3333]="PACK_ALIGNMENT",e[e.MAX_TEXTURE_SIZE=3379]="MAX_TEXTURE_SIZE",e[e.MAX_VIEWPORT_DIMS=3386]="MAX_VIEWPORT_DIMS",e[e.SUBPIXEL_BITS=3408]="SUBPIXEL_BITS",e[e.RED_BITS=3410]="RED_BITS",e[e.GREEN_BITS=3411]="GREEN_BITS",e[e.BLUE_BITS=3412]="BLUE_BITS",e[e.ALPHA_BITS=3413]="ALPHA_BITS",e[e.DEPTH_BITS=3414]="DEPTH_BITS",e[e.STENCIL_BITS=3415]="STENCIL_BITS",e[e.POLYGON_OFFSET_UNITS=10752]="POLYGON_OFFSET_UNITS",e[e.POLYGON_OFFSET_FACTOR=32824]="POLYGON_OFFSET_FACTOR",e[e.TEXTURE_BINDING_2D=32873]="TEXTURE_BINDING_2D",e[e.SAMPLE_BUFFERS=32936]="SAMPLE_BUFFERS",e[e.SAMPLES=32937]="SAMPLES",e[e.SAMPLE_COVERAGE_VALUE=32938]="SAMPLE_COVERAGE_VALUE",e[e.SAMPLE_COVERAGE_INVERT=32939]="SAMPLE_COVERAGE_INVERT",e[e.COMPRESSED_TEXTURE_FORMATS=34467]="COMPRESSED_TEXTURE_FORMATS",e[e.DONT_CARE=4352]="DONT_CARE",e[e.FASTEST=4353]="FASTEST",e[e.NICEST=4354]="NICEST",e[e.GENERATE_MIPMAP_HINT=33170]="GENERATE_MIPMAP_HINT",e[e.BYTE=5120]="BYTE",e[e.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",e[e.SHORT=5122]="SHORT",e[e.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",e[e.INT=5124]="INT",e[e.UNSIGNED_INT=5125]="UNSIGNED_INT",e[e.FLOAT=5126]="FLOAT",e[e.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",e[e.ALPHA=6406]="ALPHA",e[e.RGB=6407]="RGB",e[e.RGBA=6408]="RGBA",e[e.LUMINANCE=6409]="LUMINANCE",e[e.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",e[e.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",e[e.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",e[e.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",e[e.FRAGMENT_SHADER=35632]="FRAGMENT_SHADER",e[e.VERTEX_SHADER=35633]="VERTEX_SHADER",e[e.MAX_VERTEX_ATTRIBS=34921]="MAX_VERTEX_ATTRIBS",e[e.MAX_VERTEX_UNIFORM_VECTORS=36347]="MAX_VERTEX_UNIFORM_VECTORS",e[e.MAX_VARYING_VECTORS=36348]="MAX_VARYING_VECTORS",e[e.MAX_COMBINED_TEXTURE_IMAGE_UNITS=35661]="MAX_COMBINED_TEXTURE_IMAGE_UNITS",e[e.MAX_VERTEX_TEXTURE_IMAGE_UNITS=35660]="MAX_VERTEX_TEXTURE_IMAGE_UNITS",e[e.MAX_TEXTURE_IMAGE_UNITS=34930]="MAX_TEXTURE_IMAGE_UNITS",e[e.MAX_FRAGMENT_UNIFORM_VECTORS=36349]="MAX_FRAGMENT_UNIFORM_VECTORS",e[e.SHADER_TYPE=35663]="SHADER_TYPE",e[e.DELETE_STATUS=35712]="DELETE_STATUS",e[e.LINK_STATUS=35714]="LINK_STATUS",e[e.VALIDATE_STATUS=35715]="VALIDATE_STATUS",e[e.ATTACHED_SHADERS=35717]="ATTACHED_SHADERS",e[e.ACTIVE_UNIFORMS=35718]="ACTIVE_UNIFORMS",e[e.ACTIVE_ATTRIBUTES=35721]="ACTIVE_ATTRIBUTES",e[e.SHADING_LANGUAGE_VERSION=35724]="SHADING_LANGUAGE_VERSION",e[e.CURRENT_PROGRAM=35725]="CURRENT_PROGRAM",e[e.NEVER=512]="NEVER",e[e.LESS=513]="LESS",e[e.EQUAL=514]="EQUAL",e[e.LEQUAL=515]="LEQUAL",e[e.GREATER=516]="GREATER",e[e.NOTEQUAL=517]="NOTEQUAL",e[e.GEQUAL=518]="GEQUAL",e[e.ALWAYS=519]="ALWAYS",e[e.KEEP=7680]="KEEP",e[e.REPLACE=7681]="REPLACE",e[e.INCR=7682]="INCR",e[e.DECR=7683]="DECR",e[e.INVERT=5386]="INVERT",e[e.INCR_WRAP=34055]="INCR_WRAP",e[e.DECR_WRAP=34056]="DECR_WRAP",e[e.VENDOR=7936]="VENDOR",e[e.RENDERER=7937]="RENDERER",e[e.VERSION=7938]="VERSION",e[e.NEAREST=9728]="NEAREST",e[e.LINEAR=9729]="LINEAR",e[e.NEAREST_MIPMAP_NEAREST=9984]="NEAREST_MIPMAP_NEAREST",e[e.LINEAR_MIPMAP_NEAREST=9985]="LINEAR_MIPMAP_NEAREST",e[e.NEAREST_MIPMAP_LINEAR=9986]="NEAREST_MIPMAP_LINEAR",e[e.LINEAR_MIPMAP_LINEAR=9987]="LINEAR_MIPMAP_LINEAR",e[e.TEXTURE_MAG_FILTER=10240]="TEXTURE_MAG_FILTER",e[e.TEXTURE_MIN_FILTER=10241]="TEXTURE_MIN_FILTER",e[e.TEXTURE_WRAP_S=10242]="TEXTURE_WRAP_S",e[e.TEXTURE_WRAP_T=10243]="TEXTURE_WRAP_T",e[e.TEXTURE_2D=3553]="TEXTURE_2D",e[e.TEXTURE=5890]="TEXTURE",e[e.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",e[e.TEXTURE_BINDING_CUBE_MAP=34068]="TEXTURE_BINDING_CUBE_MAP",e[e.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",e[e.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",e[e.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",e[e.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",e[e.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",e[e.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z",e[e.MAX_CUBE_MAP_TEXTURE_SIZE=34076]="MAX_CUBE_MAP_TEXTURE_SIZE",e[e.TEXTURE0=33984]="TEXTURE0",e[e.TEXTURE1=33985]="TEXTURE1",e[e.TEXTURE2=33986]="TEXTURE2",e[e.TEXTURE3=33987]="TEXTURE3",e[e.TEXTURE4=33988]="TEXTURE4",e[e.TEXTURE5=33989]="TEXTURE5",e[e.TEXTURE6=33990]="TEXTURE6",e[e.TEXTURE7=33991]="TEXTURE7",e[e.TEXTURE8=33992]="TEXTURE8",e[e.TEXTURE9=33993]="TEXTURE9",e[e.TEXTURE10=33994]="TEXTURE10",e[e.TEXTURE11=33995]="TEXTURE11",e[e.TEXTURE12=33996]="TEXTURE12",e[e.TEXTURE13=33997]="TEXTURE13",e[e.TEXTURE14=33998]="TEXTURE14",e[e.TEXTURE15=33999]="TEXTURE15",e[e.TEXTURE16=34e3]="TEXTURE16",e[e.TEXTURE17=34001]="TEXTURE17",e[e.TEXTURE18=34002]="TEXTURE18",e[e.TEXTURE19=34003]="TEXTURE19",e[e.TEXTURE20=34004]="TEXTURE20",e[e.TEXTURE21=34005]="TEXTURE21",e[e.TEXTURE22=34006]="TEXTURE22",e[e.TEXTURE23=34007]="TEXTURE23",e[e.TEXTURE24=34008]="TEXTURE24",e[e.TEXTURE25=34009]="TEXTURE25",e[e.TEXTURE26=34010]="TEXTURE26",e[e.TEXTURE27=34011]="TEXTURE27",e[e.TEXTURE28=34012]="TEXTURE28",e[e.TEXTURE29=34013]="TEXTURE29",e[e.TEXTURE30=34014]="TEXTURE30",e[e.TEXTURE31=34015]="TEXTURE31",e[e.ACTIVE_TEXTURE=34016]="ACTIVE_TEXTURE",e[e.REPEAT=10497]="REPEAT",e[e.CLAMP_TO_EDGE=33071]="CLAMP_TO_EDGE",e[e.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT",e[e.FLOAT_VEC2=35664]="FLOAT_VEC2",e[e.FLOAT_VEC3=35665]="FLOAT_VEC3",e[e.FLOAT_VEC4=35666]="FLOAT_VEC4",e[e.INT_VEC2=35667]="INT_VEC2",e[e.INT_VEC3=35668]="INT_VEC3",e[e.INT_VEC4=35669]="INT_VEC4",e[e.BOOL=35670]="BOOL",e[e.BOOL_VEC2=35671]="BOOL_VEC2",e[e.BOOL_VEC3=35672]="BOOL_VEC3",e[e.BOOL_VEC4=35673]="BOOL_VEC4",e[e.FLOAT_MAT2=35674]="FLOAT_MAT2",e[e.FLOAT_MAT3=35675]="FLOAT_MAT3",e[e.FLOAT_MAT4=35676]="FLOAT_MAT4",e[e.SAMPLER_2D=35678]="SAMPLER_2D",e[e.SAMPLER_CUBE=35680]="SAMPLER_CUBE",e[e.VERTEX_ATTRIB_ARRAY_ENABLED=34338]="VERTEX_ATTRIB_ARRAY_ENABLED",e[e.VERTEX_ATTRIB_ARRAY_SIZE=34339]="VERTEX_ATTRIB_ARRAY_SIZE",e[e.VERTEX_ATTRIB_ARRAY_STRIDE=34340]="VERTEX_ATTRIB_ARRAY_STRIDE",e[e.VERTEX_ATTRIB_ARRAY_TYPE=34341]="VERTEX_ATTRIB_ARRAY_TYPE",e[e.VERTEX_ATTRIB_ARRAY_NORMALIZED=34922]="VERTEX_ATTRIB_ARRAY_NORMALIZED",e[e.VERTEX_ATTRIB_ARRAY_POINTER=34373]="VERTEX_ATTRIB_ARRAY_POINTER",e[e.VERTEX_ATTRIB_ARRAY_BUFFER_BINDING=34975]="VERTEX_ATTRIB_ARRAY_BUFFER_BINDING",e[e.COMPILE_STATUS=35713]="COMPILE_STATUS",e[e.LOW_FLOAT=36336]="LOW_FLOAT",e[e.MEDIUM_FLOAT=36337]="MEDIUM_FLOAT",e[e.HIGH_FLOAT=36338]="HIGH_FLOAT",e[e.LOW_INT=36339]="LOW_INT",e[e.MEDIUM_INT=36340]="MEDIUM_INT",e[e.HIGH_INT=36341]="HIGH_INT",e[e.FRAMEBUFFER=36160]="FRAMEBUFFER",e[e.RENDERBUFFER=36161]="RENDERBUFFER",e[e.RGBA4=32854]="RGBA4",e[e.RGB5_A1=32855]="RGB5_A1",e[e.RGB565=36194]="RGB565",e[e.DEPTH_COMPONENT16=33189]="DEPTH_COMPONENT16",e[e.STENCIL_INDEX=6401]="STENCIL_INDEX",e[e.STENCIL_INDEX8=36168]="STENCIL_INDEX8",e[e.DEPTH_STENCIL=34041]="DEPTH_STENCIL",e[e.RENDERBUFFER_WIDTH=36162]="RENDERBUFFER_WIDTH",e[e.RENDERBUFFER_HEIGHT=36163]="RENDERBUFFER_HEIGHT",e[e.RENDERBUFFER_INTERNAL_FORMAT=36164]="RENDERBUFFER_INTERNAL_FORMAT",e[e.RENDERBUFFER_RED_SIZE=36176]="RENDERBUFFER_RED_SIZE",e[e.RENDERBUFFER_GREEN_SIZE=36177]="RENDERBUFFER_GREEN_SIZE",e[e.RENDERBUFFER_BLUE_SIZE=36178]="RENDERBUFFER_BLUE_SIZE",e[e.RENDERBUFFER_ALPHA_SIZE=36179]="RENDERBUFFER_ALPHA_SIZE",e[e.RENDERBUFFER_DEPTH_SIZE=36180]="RENDERBUFFER_DEPTH_SIZE",e[e.RENDERBUFFER_STENCIL_SIZE=36181]="RENDERBUFFER_STENCIL_SIZE",e[e.FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE=36048]="FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE",e[e.FRAMEBUFFER_ATTACHMENT_OBJECT_NAME=36049]="FRAMEBUFFER_ATTACHMENT_OBJECT_NAME",e[e.FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL=36050]="FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL",e[e.FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE=36051]="FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE",e[e.COLOR_ATTACHMENT0=36064]="COLOR_ATTACHMENT0",e[e.DEPTH_ATTACHMENT=36096]="DEPTH_ATTACHMENT",e[e.STENCIL_ATTACHMENT=36128]="STENCIL_ATTACHMENT",e[e.DEPTH_STENCIL_ATTACHMENT=33306]="DEPTH_STENCIL_ATTACHMENT",e[e.NONE=0]="NONE",e[e.FRAMEBUFFER_COMPLETE=36053]="FRAMEBUFFER_COMPLETE",e[e.FRAMEBUFFER_INCOMPLETE_ATTACHMENT=36054]="FRAMEBUFFER_INCOMPLETE_ATTACHMENT",e[e.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT=36055]="FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT",e[e.FRAMEBUFFER_INCOMPLETE_DIMENSIONS=36057]="FRAMEBUFFER_INCOMPLETE_DIMENSIONS",e[e.FRAMEBUFFER_UNSUPPORTED=36061]="FRAMEBUFFER_UNSUPPORTED",e[e.FRAMEBUFFER_BINDING=36006]="FRAMEBUFFER_BINDING",e[e.RENDERBUFFER_BINDING=36007]="RENDERBUFFER_BINDING",e[e.MAX_RENDERBUFFER_SIZE=34024]="MAX_RENDERBUFFER_SIZE",e[e.INVALID_FRAMEBUFFER_OPERATION=1286]="INVALID_FRAMEBUFFER_OPERATION",e[e.UNPACK_FLIP_Y_WEBGL=37440]="UNPACK_FLIP_Y_WEBGL",e[e.UNPACK_PREMULTIPLY_ALPHA_WEBGL=37441]="UNPACK_PREMULTIPLY_ALPHA_WEBGL",e[e.CONTEXT_LOST_WEBGL=37442]="CONTEXT_LOST_WEBGL",e[e.UNPACK_COLORSPACE_CONVERSION_WEBGL=37443]="UNPACK_COLORSPACE_CONVERSION_WEBGL",e[e.BROWSER_DEFAULT_WEBGL=37444]="BROWSER_DEFAULT_WEBGL",e}({}),ad,vh,gh,HA,Ev,od,mm,F0,sd,_m,Sv,xv,Tv,ym=(ad=(0,Tt.b2)(),vh=(0,Tt.f3)(xt.IMapService),gh=(0,Tt.f3)(xt.IRendererService),HA=(0,Tt.f3)(xt.IGlobalConfigService),Ev=(0,Tt.f3)(xt.IInteractionService),od=(0,Tt.f3)(xt.ILayerService),ad(mm=(F0=function(){function e(){var t=this;(0,ue.Z)(this,e),(0,ve.Z)(this,"pickedColors",void 0),(0,ve.Z)(this,"pickedTileLayers",[]),fa(this,"mapService",sd,this),fa(this,"rendererService",_m,this),fa(this,"configService",Sv,this),fa(this,"interactionService",xv,this),fa(this,"layerService",Tv,this),(0,ve.Z)(this,"pickingFBO",void 0),(0,ve.Z)(this,"width",0),(0,ve.Z)(this,"height",0),(0,ve.Z)(this,"alreadyInPicking",!1),(0,ve.Z)(this,"pickBufferScale",1),(0,ve.Z)(this,"pickFromPickingFBO",function(r,n){var i=n.x,a=n.y,s=n.lngLat,l=n.type,p=n.target,m=!1,T=t.rendererService,R=T.readPixels,L=T.getContainer,z=t.getContainerSize(L()),re=z.width,ee=z.height;re*=ba,ee*=ba;var me=r.getLayerConfig(),Ie=me.enableHighlight,He=me.enableSelect,Xe=i*ba,ot=a*ba;if(Xe>re-1*ba||Xe<0||ot>ee-1*ba||ot<0)return!1;var pt=R({x:Math.floor(Xe/t.pickBufferScale),y:Math.floor((ee-(a+1)*ba)/t.pickBufferScale),width:1,height:1,data:new Uint8Array(1*1*4),framebuffer:t.pickingFBO});if(t.pickedColors=pt,pt[0]!==0||pt[1]!==0||pt[2]!==0){var dt=_o(pt),It=r.layerPickService.getFeatureById(dt);dt!==r.getCurrentPickId()&&l==="mousemove"&&(l="mouseenter");var Vt={x:i,y:a,type:l,lngLat:s,featureId:dt,feature:It,target:p};It&&(m=!0,r.setCurrentPickId(dt),t.triggerHoverOnLayer(r,Vt))}else{var Kt={x:i,y:a,lngLat:s,type:r.getCurrentPickId()!==null&&l==="mousemove"?"mouseout":"un"+l,featureId:null,target:p,feature:null};t.triggerHoverOnLayer(r,(0,Q.Z)((0,Q.Z)({},Kt),{},{type:"unpick"})),t.triggerHoverOnLayer(r,Kt),r.setCurrentPickId(null)}if(Ie&&r.layerPickService.highlightPickedFeature(pt),He&&l==="click"&&(pt==null?void 0:pt.toString())!==[0,0,0,0].toString()){var yr=_o(pt);r.getCurrentSelectedId()===null||yr!==r.getCurrentSelectedId()?(r.layerPickService.selectFeature(pt),r.setCurrentSelectedId(yr)):(r.layerPickService.selectFeature(new Uint8Array([0,0,0,0])),r.setCurrentSelectedId(null))}return m})}return(0,_e.Z)(e,[{key:"init",value:function(r){var n=this.rendererService,i=n.createTexture2D,a=n.createFramebuffer,s=n.getContainer,l=this.getContainerSize(s()),p=l.width,m=l.height;p*=ba,m*=ba,this.pickBufferScale=this.configService.getSceneConfig(r).pickBufferScale||1,this.pickingFBO=a({color:i({width:Math.round(p/this.pickBufferScale),height:Math.round(m/this.pickBufferScale),wrapS:Fe.CLAMP_TO_EDGE,wrapT:Fe.CLAMP_TO_EDGE})}),this.interactionService.on(Vs.Hover,this.pickingAllLayer.bind(this))}},{key:"boxPickLayer",value:function(){var t=(0,hr.Z)(it().mark(function n(i,a,s){var l=this,p,m,T;return it().wrap(function(L){for(;;)switch(L.prev=L.next){case 0:p=this.rendererService,m=p.useFramebuffer,T=p.clear,this.resizePickingFBO(),m(this.pickingFBO,function(){T({framebuffer:l.pickingFBO,color:[0,0,0,0],stencil:0,depth:1}),i.hooks.beforePickingEncode.call(),i.renderModels({ispick:!0}),i.hooks.afterPickingEncode.call();var z=l.pickBox(i,a);s(z)});case 3:case"end":return L.stop()}},n,this)}));function r(n,i,a){return t.apply(this,arguments)}return r}()},{key:"pickBox",value:function(r,n){var i=this,a=n.map(function(yr){var _r=yr<0?0:yr;return Math.floor(_r*ba/i.pickBufferScale)}),s=(0,yn.Z)(a,4),l=s[0],p=s[1],m=s[2],T=s[3],R=this.rendererService,L=R.readPixels,z=R.getContainer,re=this.getContainerSize(z()),ee=re.width,me=re.height;if(ee*=ba,me*=ba,l>(ee-1)*ba/this.pickBufferScale||m<0||p>(me-1)*ba/this.pickBufferScale||T<0)return[];for(var Ie=Math.min(ee/this.pickBufferScale,m)-l,He=Math.min(me/this.pickBufferScale,T)-p,Xe=L({x:l,y:Math.floor(me/this.pickBufferScale-(T+1)),width:Ie,height:He,data:new Uint8Array(Ie*He*4),framebuffer:this.pickingFBO}),ot=[],pt={},dt=0;dt<Xe.length/4;dt=dt+1){var It=Xe.slice(dt*4,dt*4+4),Vt=_o(It);if(Vt!==-1&&!pt[Vt]){var Kt=r.layerPickService.getFeatureById(Vt);ot.push((0,Q.Z)((0,Q.Z)({},Kt),{},{pickedFeatureIdx:Vt})),pt[Vt]=!0}}return ot}},{key:"handleCursor",value:function(r,n){var i=r.getLayerConfig(),a=i.cursor,s=a===void 0?"":a,l=i.cursorEnabled;if(l){var p=this.mapService.version,m=p==="GAODE2.x"?this.mapService.getMapContainer():this.mapService.getMarkerContainer(),T=m==null?void 0:m.style.getPropertyValue("cursor");n==="unmousemove"&&T!==""?m==null||m.style.setProperty("cursor",""):n==="mousemove"&&(m==null||m.style.setProperty("cursor",s))}}},{key:"destroy",value:function(){this.pickingFBO.destroy(),this.pickingFBO=null}},{key:"getContainerSize",value:function(r){return r.getContext?{width:r.width/ba,height:r.height/ba}:r.getBoundingClientRect()}},{key:"pickingAllLayer",value:function(){var t=(0,hr.Z)(it().mark(function n(i){return it().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:if(!(!this.layerService.needPick(i.type)||!this.isPickingAllLayer())){s.next=2;break}return s.abrupt("return");case 2:return this.alreadyInPicking=!0,s.next=5,this.pickingLayers(i);case 5:this.layerService.renderLayers(),this.alreadyInPicking=!1;case 7:case"end":return s.stop()}},n,this)}));function r(n){return t.apply(this,arguments)}return r}()},{key:"isPickingAllLayer",value:function(){return!(this.alreadyInPicking||this.layerService.alreadyInRendering||this.interactionService.indragging||!this.layerService.getShaderPickStat())}},{key:"resizePickingFBO",value:function(){var r=this.rendererService.getContainer,n=this.getContainerSize(r()),i=n.width,a=n.height;i*=ba,a*=ba,(this.width!==i||this.height!==a)&&(this.pickingFBO.resize({width:Math.round(i/this.pickBufferScale),height:Math.round(a/this.pickBufferScale)}),this.width=i,this.height=a)}},{key:"pickingLayers",value:function(){var t=(0,hr.Z)(it().mark(function n(i){var a=this,s,l,p;return it().wrap(function(T){for(;;)switch(T.prev=T.next){case 0:s=this.rendererService,l=s.useFramebuffer,p=s.clear,this.resizePickingFBO(),l(this.pickingFBO,function(){var R=a.layerService.getRenderList();R.filter(function(L){return L.needPick(i.type)}).reverse().some(function(L){p({framebuffer:a.pickingFBO,color:[0,0,0,0],stencil:0,depth:1}),L.layerPickService.pickRender(i);var z=a.pickFromPickingFBO(L,i);return a.layerService.pickedLayerId=z?+L.id:-1,z&&!L.getLayerConfig().enablePropagation})});case 3:case"end":return T.stop()}},n,this)}));function r(n){return t.apply(this,arguments)}return r}()},{key:"triggerHoverOnLayer",value:function(r,n){id(n)&&(this.handleCursor(r,n.type),r.emit(n.type,n))}}]),e}(),sd=Ji(F0.prototype,"mapService",[vh],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),_m=Ji(F0.prototype,"rendererService",[gh],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Sv=Ji(F0.prototype,"configService",[HA],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),xv=Ji(F0.prototype,"interactionService",[Ev],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Tv=Ji(F0.prototype,"layerService",[od],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),F0))||mm),ay=function(){function e(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;(0,ue.Z)(this,e),(0,ve.Z)(this,"autoStart",void 0),(0,ve.Z)(this,"startTime",0),(0,ve.Z)(this,"oldTime",0),(0,ve.Z)(this,"running",!1),(0,ve.Z)(this,"elapsedTime",0),this.autoStart=t}return(0,_e.Z)(e,[{key:"start",value:function(){this.startTime=(typeof performance=="undefined"?Date:performance).now(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}},{key:"stop",value:function(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}},{key:"getElapsedTime",value:function(){return this.getDelta(),this.elapsedTime}},{key:"getDelta",value:function(){var r=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){var n=(typeof performance=="undefined"?Date:performance).now();r=(n-this.oldTime)/1e3,this.oldTime=n,this.elapsedTime+=r}return r}}]),e}(),Cv,bv,Rv,Em,Sm,mh,WA,Mv,xm;function jA(e,t){var r=typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=Tm(e))||t&&e&&typeof e.length=="number"){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(m){throw m},f:i}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var a=!0,s=!1,l;return{s:function(){r=r.call(e)},n:function(){var m=r.next();return a=m.done,m},e:function(m){s=!0,l=m},f:function(){try{!a&&r.return!=null&&r.return()}finally{if(s)throw l}}}}function Tm(e,t){if(e){if(typeof e=="string")return Cm(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Cm(e,t)}}function Cm(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function bm(e){var t=Rm();return function(){var n=(0,le.Z)(e),i;if(t){var a=(0,le.Z)(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return(0,ze.Z)(this,i)}}function Rm(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var wv=Fn.throttle,oy=(Cv=(0,Tt.b2)(),bv=(0,Tt.f3)(xt.IRendererService),Rv=(0,Tt.f3)(xt.IMapService),Em=(0,Tt.f3)(xt.IDebugService),Cv(Sm=(mh=function(e){(0,ke.Z)(r,e);var t=bm(r);function r(){var n;(0,ue.Z)(this,r);for(var i=arguments.length,a=new Array(i),s=0;s<i;s++)a[s]=arguments[s];return n=t.call.apply(t,[this].concat(a)),(0,ve.Z)((0,St.Z)(n),"pickedLayerId",-1),(0,ve.Z)((0,St.Z)(n),"clock",new ay),(0,ve.Z)((0,St.Z)(n),"alreadyInRendering",!1),(0,ve.Z)((0,St.Z)(n),"layers",[]),(0,ve.Z)((0,St.Z)(n),"layerList",[]),(0,ve.Z)((0,St.Z)(n),"layerRenderID",void 0),(0,ve.Z)((0,St.Z)(n),"sceneInited",!1),(0,ve.Z)((0,St.Z)(n),"animateInstanceCount",0),(0,ve.Z)((0,St.Z)(n),"shaderPicking",!0),(0,ve.Z)((0,St.Z)(n),"enableRender",!0),fa((0,St.Z)(n),"renderService",WA,(0,St.Z)(n)),fa((0,St.Z)(n),"mapService",Mv,(0,St.Z)(n)),fa((0,St.Z)(n),"debugService",xm,(0,St.Z)(n)),(0,ve.Z)((0,St.Z)(n),"reRender",wv(function(){n.renderLayers()},32)),(0,ve.Z)((0,St.Z)(n),"throttleRenderLayers",wv(function(){n.renderLayers()},16)),n}return(0,_e.Z)(r,[{key:"needPick",value:function(i){return this.layerList.some(function(a){return a.needPick(i)})}},{key:"add",value:function(i){var a=this;this.layers.push(i),this.sceneInited&&i.init().then(function(){a.renderLayers()})}},{key:"addMask",value:function(i){var a=this;this.sceneInited&&i.init().then(function(){a.renderLayers()})}},{key:"initLayers",value:function(){var n=(0,hr.Z)(it().mark(function a(){var s=this;return it().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:this.sceneInited=!0,this.layers.forEach(function(){var m=(0,hr.Z)(it().mark(function T(R){return it().wrap(function(z){for(;;)switch(z.prev=z.next){case 0:if(R.startInit){z.next=4;break}return z.next=3,R.init();case 3:s.updateLayerRenderList();case 4:case"end":return z.stop()}},T)}));return function(T){return m.apply(this,arguments)}}());case 2:case"end":return p.stop()}},a,this)}));function i(){return n.apply(this,arguments)}return i}()},{key:"getSceneInited",value:function(){return this.sceneInited}},{key:"getRenderList",value:function(){return this.layerList}},{key:"getLayers",value:function(){return this.layers}},{key:"getLayer",value:function(i){return this.layers.find(function(a){return a.id===i})}},{key:"getLayerByName",value:function(i){return this.layers.find(function(a){return a.name===i})}},{key:"remove",value:function(){var n=(0,hr.Z)(it().mark(function a(s,l){var p,m;return it().wrap(function(R){for(;;)switch(R.prev=R.next){case 0:l?(p=l.layerChildren.indexOf(s),p>-1&&l.layerChildren.splice(p,1)):(m=this.layers.indexOf(s),m>-1&&this.layers.splice(m,1)),s.destroy(),this.reRender(),this.emit("layerChange",this.layers);case 4:case"end":return R.stop()}},a,this)}));function i(a,s){return n.apply(this,arguments)}return i}()},{key:"removeAllLayers",value:function(){var n=(0,hr.Z)(it().mark(function a(){return it().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:this.destroy(),this.reRender();case 2:case"end":return l.stop()}},a,this)}));function i(){return n.apply(this,arguments)}return i}()},{key:"setEnableRender",value:function(i){this.enableRender=i}},{key:"renderLayers",value:function(){var n=(0,hr.Z)(it().mark(function a(){var s,l,p,m,T,R;return it().wrap(function(z){for(;;)switch(z.prev=z.next){case 0:if(!(this.alreadyInRendering||!this.enableRender)){z.next=2;break}return z.abrupt("return");case 2:this.updateLayerRenderList(),s=this.debugService.generateRenderUid(),this.debugService.renderStart(s),this.alreadyInRendering=!0,this.clear(),this.renderService.beginFrame(),l=jA(this.layerList),z.prev=9,l.s();case 11:if((p=l.n()).done){z.next=24;break}if(m=p.value,T=m.getLayerConfig(),R=T.enableMask,m.masks.filter(function(re){return re.inited}).length>0&&R&&this.renderMask(m.masks),!m.getLayerConfig().enableMultiPassRenderer){z.next=20;break}return z.next=18,m.renderMultiPass();case 18:z.next=22;break;case 20:return z.next=22,m.render();case 22:z.next=11;break;case 24:z.next=29;break;case 26:z.prev=26,z.t0=z.catch(9),l.e(z.t0);case 29:return z.prev=29,l.f(),z.finish(29);case 32:this.renderService.endFrame(),this.debugService.renderEnd(s),this.alreadyInRendering=!1;case 35:case"end":return z.stop()}},a,this,[[9,26,29,32]])}));function i(){return n.apply(this,arguments)}return i}()},{key:"renderMask",value:function(i){var a=0;this.renderService.clear({stencil:0,depth:1,framebuffer:null});var s=i.length>1?L0.MULTIPLE:L0.SINGLE,l=jA(i),p;try{for(l.s();!(p=l.n()).done;){var m=p.value;m.render({isStencil:!0,stencilType:s,stencilIndex:a++})}}catch(T){l.e(T)}finally{l.f()}}},{key:"beforeRenderData",value:function(){var n=(0,hr.Z)(it().mark(function a(s){var l;return it().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return m.next=2,s.hooks.beforeRenderData.promise();case 2:l=m.sent,l&&this.renderLayers();case 4:case"end":return m.stop()}},a,this)}));function i(a){return n.apply(this,arguments)}return i}()},{key:"renderTileLayerMask",value:function(i){var a=0,s=i.getLayerConfig(),l=s.enableMask,p=l===void 0?!0:l,m=i.tileMask?1:0,T=i.masks.filter(function(ee){return ee.inited});m=m+(p?T.length:1);var R=m>1?L0.MULTIPLE:L0.SINGLE;if((i.tileMask||T.length&&p)&&this.renderService.clear({stencil:0,depth:1,framebuffer:null}),T.length&&p){var L=jA(T),z;try{for(L.s();!(z=L.n()).done;){var re=z.value;re.render({isStencil:!0,stencilType:R,stencilIndex:a++})}}catch(ee){L.e(ee)}finally{L.f()}}i.tileMask&&i.tileMask.render({isStencil:!0,stencilType:R,stencilIndex:a++,stencilOperation:Jh.OR})}},{key:"renderTileLayer",value:function(){var n=(0,hr.Z)(it().mark(function a(s){return it().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:if(this.renderTileLayerMask(s),!s.getLayerConfig().enableMultiPassRenderer){p.next=6;break}return p.next=4,s.renderMultiPass();case 4:p.next=8;break;case 6:return p.next=8,s.render();case 8:case"end":return p.stop()}},a,this)}));function i(a){return n.apply(this,arguments)}return i}()},{key:"updateLayerRenderList",value:function(){var i=this;this.layerList=[],this.layers.filter(function(a){return a.inited}).filter(function(a){return a.isVisible()}).sort(function(a,s){return a.zIndex-s.zIndex}).forEach(function(a){i.layerList.push(a)})}},{key:"destroy",value:function(){this.layers.forEach(function(i){i.destroy()}),this.layers=[],this.layerList=[],this.emit("layerChange",this.layers)}},{key:"startAnimate",value:function(){this.animateInstanceCount++===0&&(this.clock.start(),this.runRender())}},{key:"stopAnimate",value:function(){--this.animateInstanceCount===0&&(this.stopRender(),this.clock.stop())}},{key:"getOESTextureFloat",value:function(){return this.renderService.extensionObject.OES_texture_float}},{key:"enableShaderPick",value:function(){this.shaderPicking=!0}},{key:"disableShaderPick",value:function(){this.shaderPicking=!1}},{key:"getShaderPickStat",value:function(){return this.shaderPicking}},{key:"clear",value:function(){var i=Qi(this.mapService.bgColor);this.renderService.clear({color:i,depth:1,stencil:0,framebuffer:null})}},{key:"runRender",value:function(){this.renderLayers(),this.layerRenderID=window.requestAnimationFrame(this.runRender.bind(this))}},{key:"stopRender",value:function(){window.cancelAnimationFrame(this.layerRenderID)}}]),r}(Si.EventEmitter),WA=Ji(mh.prototype,"renderService",[bv],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Mv=Ji(mh.prototype,"mapService",[Rv],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),xm=Ji(mh.prototype,"debugService",[Em],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),mh))||Sm),Cc=C(52528),sy=Fn.isNil,uy=function(){function e(t){var r=this;(0,ue.Z)(this,e),(0,ve.Z)(this,"name",void 0),(0,ve.Z)(this,"type",void 0),(0,ve.Z)(this,"scale",void 0),(0,ve.Z)(this,"descriptor",void 0),(0,ve.Z)(this,"featureBufferLayout",[]),(0,ve.Z)(this,"needRescale",!1),(0,ve.Z)(this,"needRemapping",!1),(0,ve.Z)(this,"needRegenerateVertices",!1),(0,ve.Z)(this,"featureRange",{startIndex:0,endIndex:1/0}),(0,ve.Z)(this,"vertexAttribute",void 0),(0,ve.Z)(this,"defaultCallback",function(n){if(n.length===0){var i;return((i=r.scale)===null||i===void 0?void 0:i.defaultValues)||[]}return n.map(function(a,s){var l,p=(l=r.scale)===null||l===void 0?void 0:l.scalers[s].func,m=p(a);return m})}),this.setProps(t)}return(0,_e.Z)(e,[{key:"setProps",value:function(r){Object.assign(this,r)}},{key:"mapping",value:function(r){var n;if((n=this.scale)!==null&&n!==void 0&&n.callback){var i,a=(i=this.scale)===null||i===void 0?void 0:i.callback.apply(i,(0,cr.Z)(r));if(!sy(a))return[a]}return this.defaultCallback(r)}},{key:"resetDescriptor",value:function(){this.descriptor&&(this.descriptor.buffer.data=[])}}]),e}(),Mm=["buffer","update","name"],ly=["buffer","update","name"],XA,Iv,wm,ud,B0,ld,cy=(XA={},(0,ve.Z)(XA,Fe.FLOAT,4),(0,ve.Z)(XA,Fe.UNSIGNED_BYTE,1),(0,ve.Z)(XA,Fe.UNSIGNED_SHORT,2),XA),Pv=(Iv=(0,Tt.b2)(),wm=(0,Tt.f3)(xt.IRendererService),Iv(ud=(B0=function(){function e(){(0,ue.Z)(this,e),(0,ve.Z)(this,"attributesAndIndices",void 0),fa(this,"rendererService",ld,this),(0,ve.Z)(this,"attributes",[]),(0,ve.Z)(this,"triangulation",void 0),(0,ve.Z)(this,"featureLayout",{sizePerElement:0,elements:[]})}return(0,_e.Z)(e,[{key:"registerStyleAttribute",value:function(r){var n=this.getLayerStyleAttribute(r.name||"");return n?n.setProps(r):(n=new uy(r),this.attributes.push(n)),n}},{key:"unRegisterStyleAttribute",value:function(r){var n=this.attributes.findIndex(function(i){return i.name===r});n>-1&&this.attributes.splice(n,1)}},{key:"updateScaleAttribute",value:function(r){this.attributes.forEach(function(n){var i,a=n.name,s=(i=n.scale)===null||i===void 0?void 0:i.field;(r[a]||s&&r[s])&&(n.needRescale=!0,n.needRemapping=!0,n.needRegenerateVertices=!0)})}},{key:"updateStyleAttribute",value:function(r,n,i){var a=this.getLayerStyleAttribute(r);a||(a=this.registerStyleAttribute((0,Q.Z)((0,Q.Z)({},n),{},{name:r})));var s=n.scale;s&&a&&(a.scale=s,a.needRescale=!0,a.needRemapping=!0,a.needRegenerateVertices=!0,i&&i.featureRange&&(a.featureRange=i.featureRange))}},{key:"getLayerStyleAttributes",value:function(){return this.attributes}},{key:"getLayerStyleAttribute",value:function(r){return this.attributes.find(function(n){return n.name===r})}},{key:"getLayerAttributeScale",value:function(r){var n,i=this.getLayerStyleAttribute(r),a=i==null||(n=i.scale)===null||n===void 0?void 0:n.scalers;return a&&a[0]?a[0].func:null}},{key:"updateAttributeByFeatureRange",value:function(r,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,a=arguments.length>3?arguments[3]:void 0,s=arguments.length>4?arguments[4]:void 0,l=this.attributes.find(function(pt){return pt.name===r});if(l&&l.descriptor){var p=l.descriptor,m=p.update,T=p.buffer,R=p.size,L=R===void 0?0:R,z=cy[T.type||Fe.FLOAT];if(m){var re=this.featureLayout,ee=re.elements,me=re.sizePerElement,Ie=ee.slice(i,a);if(!Ie.length)return;var He=Ie[0].offset,Xe=He*L*z,ot=Ie.map(function(pt,dt){for(var It=pt.featureIdx,Vt=pt.vertices,Kt=pt.normals,yr=Vt.length/me,_r=[],Hr=0;Hr<yr;Hr++){var nn=Kt?Kt.slice(Hr*3,Hr*3+3):[];_r.push.apply(_r,(0,cr.Z)(m(n[It],It,Vt.slice(Hr*me,Hr*me+me),dt,nn)))}return _r}).reduce(function(pt,dt){return pt.push.apply(pt,(0,cr.Z)(dt)),pt},[]);l.vertexAttribute.updateBuffer({data:ot,offset:Xe}),s==null||s.emit("legend:".concat(r),{type:r,attr:l})}}}},{key:"createAttributesAndIndices",value:function(r,n,i){var a=this;this.featureLayout={sizePerElement:0,elements:[]},n&&(this.triangulation=n);var s=this.attributes.map(function(Ie){return Ie.resetDescriptor(),Ie.descriptor}),l=0,p=0,m=[],T=3;r.forEach(function(Ie,He){var Xe=a.triangulation(Ie,i),ot=Xe.indices,pt=Xe.vertices,dt=Xe.normals,It=Xe.size,Vt=Xe.indexes,Kt=Xe.count;typeof Kt=="number"&&(p+=Kt),ot.forEach(function(nn){m.push(nn+l)}),T=It;var yr=pt.length/It;a.featureLayout.sizePerElement=T,a.featureLayout.elements.push({featureIdx:He,vertices:pt,normals:dt,offset:l}),l+=yr;for(var _r=function(Tn){var sa=(dt==null?void 0:dt.slice(Tn*3,Tn*3+3))||[],Fo=pt.slice(Tn*It,Tn*It+It),jo=0;Vt&&Vt[Tn]!==void 0&&(jo=Vt[Tn]),s.forEach(function(As,vu){if(As&&As.update){var ef;(ef=As.buffer.data).push.apply(ef,(0,cr.Z)(As.update(Ie,He,Fo,Tn,sa,jo)))}})},Hr=0;Hr<yr;Hr++)_r(Hr)});var R=this.rendererService,L=R.createAttribute,z=R.createBuffer,re=R.createElements,ee={};s.forEach(function(Ie,He){if(Ie){var Xe=Ie.buffer,ot=Ie.update,pt=Ie.name,dt=(0,Cc.Z)(Ie,Mm),It=L((0,Q.Z)({buffer:z(Xe)},dt));ee[Ie.name||""]=It,a.attributes[He].vertexAttribute=It}});var me=re({data:m,type:Fe.UNSIGNED_INT,count:m.length});return this.attributesAndIndices={attributes:ee,elements:me,count:p},this.attributesAndIndices}},{key:"createAttributes",value:function(r,n){var i=this;this.featureLayout={sizePerElement:0,elements:[]},n&&(this.triangulation=n);var a=this.attributes.map(function(z){return z.resetDescriptor(),z.descriptor}),s=0,l=[],p=3;r.forEach(function(z,re){var ee=i.triangulation(z),me=ee.indices,Ie=ee.vertices,He=ee.normals,Xe=ee.size,ot=ee.indexes;me.forEach(function(Vt){l.push(Vt+s)}),p=Xe;var pt=Ie.length/Xe;i.featureLayout.sizePerElement=p,i.featureLayout.elements.push({featureIdx:re,vertices:Ie,normals:He,offset:s}),s+=pt;for(var dt=function(Kt){var yr=(He==null?void 0:He.slice(Kt*3,Kt*3+3))||[],_r=Ie.slice(Kt*Xe,Kt*Xe+Xe),Hr=0;ot&&ot[Kt]!==void 0&&(Hr=ot[Kt]),a.forEach(function(nn,Tn){if(nn&&nn.update){var sa;(sa=nn.buffer.data).push.apply(sa,(0,cr.Z)(nn.update(z,re,_r,Kt,yr,Hr)))}})},It=0;It<pt;It++)dt(It)});var m=this.rendererService,T=m.createAttribute,R=m.createBuffer,L={};return a.forEach(function(z,re){if(z){var ee=z.buffer,me=z.update,Ie=z.name,He=(0,Cc.Z)(z,ly),Xe=T((0,Q.Z)({buffer:R(ee)},He));L[z.name||""]=Xe,i.attributes[re].vertexAttribute=Xe}}),{attributes:L}}},{key:"clearAllAttributes",value:function(){var r;this.attributes.forEach(function(n){n.vertexAttribute&&n.vertexAttribute.destroy()}),(r=this.attributesAndIndices)===null||r===void 0||r.elements.destroy(),this.attributes=[]}}]),e}(),ld=Ji(B0.prototype,"rendererService",[wm],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),B0))||ud),Ov=C(97671);function oA(e,t,r,n){function i(a){return a instanceof r?a:new r(function(s){s(a)})}return new(r||(r=Promise))(function(a,s){function l(T){try{m(n.next(T))}catch(R){s(R)}}function p(T){try{m(n.throw(T))}catch(R){s(R)}}function m(T){T.done?a(T.value):i(T.value).then(l,p)}m((n=n.apply(e,t||[])).next())})}function Nv(e,t){var r={label:0,sent:function(){if(a[0]&1)throw a[1];return a[1]},trys:[],ops:[]},n,i,a,s;return s={next:l(0),throw:l(1),return:l(2)},typeof Symbol=="function"&&(s[Symbol.iterator]=function(){return this}),s;function l(m){return function(T){return p([m,T])}}function p(m){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,i&&(a=m[0]&2?i.return:m[0]?i.throw||((a=i.return)&&a.call(i),0):i.next)&&!(a=a.call(i,m[1])).done)return a;switch(i=0,a&&(m=[m[0]&2,a.value]),m[0]){case 0:case 1:a=m;break;case 4:return r.label++,{value:m[1],done:!1};case 5:r.label++,i=m[1],m=[0];continue;case 7:m=r.ops.pop(),r.trys.pop();continue;default:if(a=r.trys,!(a=a.length>0&&a[a.length-1])&&(m[0]===6||m[0]===2)){r=0;continue}if(m[0]===3&&(!a||m[1]>a[0]&&m[1]<a[3])){r.label=m[1];break}if(m[0]===6&&r.label<a[1]){r.label=a[1],a=m;break}if(a&&r.label<a[2]){r.label=a[2],r.ops.push(m);break}a[2]&&r.ops.pop(),r.trys.pop();continue}m=t.call(e,r)}catch(T){m=[6,T],i=0}finally{n=a=0}if(m[0]&5)throw m[1];return{value:m[0]?m[1]:void 0,done:!0}}}function YA(e,t){var r=typeof Symbol=="function"&&e[Symbol.iterator];if(!r)return e;var n=r.call(e),i,a=[],s;try{for(;(t===void 0||t-- >0)&&!(i=n.next()).done;)a.push(i.value)}catch(l){s={error:l}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(s)throw s.error}}return a}function k0(e,t,r){if(r||arguments.length===2)for(var n=0,i=t.length,a;n<i;n++)(a||!(n in t))&&(a||(a=Array.prototype.slice.call(t,0,n)),a[n]=t[n]);return e.concat(a||Array.prototype.slice.call(t))}function cd(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var Dv={exports:{}},_h={exports:{}},$A={exports:{}};(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=r;function r(n){return n&&typeof n.length=="number"&&n.length>=0&&n.length%1===0}e.exports=t.default})($A,$A.exports);var Ul={},Lv={exports:{}},QA={exports:{}};(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(r){return function(){for(var n=[],i=arguments.length;i--;)n[i]=arguments[i];var a=n.pop();return r.call(this,n,a)}},e.exports=t.default})(QA,QA.exports);var U0={};Object.defineProperty(U0,"__esModule",{value:!0}),U0.fallback=Im,U0.wrap=fd;var qA=U0.hasQueueMicrotask=typeof queueMicrotask=="function"&&queueMicrotask,fy=U0.hasSetImmediate=typeof setImmediate=="function"&&setImmediate,Fv=U0.hasNextTick=typeof Ov=="object"&&typeof Ov.nextTick=="function";function Im(e){setTimeout(e,0)}function fd(e){return function(t){for(var r=[],n=arguments.length-1;n-- >0;)r[n]=arguments[n+1];return e(function(){return t.apply(void 0,r)})}}var KA;qA?KA=queueMicrotask:fy?KA=setImmediate:Fv?KA=Ov.nextTick:KA=Im,U0.default=fd(KA),function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=p;var r=QA.exports,n=l(r),i=U0,a=l(i),s=Ul;function l(R){return R&&R.__esModule?R:{default:R}}function p(R){return(0,s.isAsync)(R)?function(){for(var L=[],z=arguments.length;z--;)L[z]=arguments[z];var re=L.pop(),ee=R.apply(this,L);return m(ee,re)}:(0,n.default)(function(L,z){var re;try{re=R.apply(this,L)}catch(ee){return z(ee)}if(re&&typeof re.then=="function")return m(re,z);z(null,re)})}function m(R,L){return R.then(function(z){T(L,null,z)},function(z){T(L,z&&z.message?z:new Error(z))})}function T(R,L,z){try{R(L,z)}catch(re){(0,a.default)(function(ee){throw ee},re)}}e.exports=t.default}(Lv,Lv.exports),Object.defineProperty(Ul,"__esModule",{value:!0}),Ul.isAsyncIterable=Ul.isAsyncGenerator=Ul.isAsync=void 0;var Bv=Lv.exports,hy=kv(Bv);function kv(e){return e&&e.__esModule?e:{default:e}}function Pm(e){return e[Symbol.toStringTag]==="AsyncFunction"}function Ay(e){return e[Symbol.toStringTag]==="AsyncGenerator"}function JA(e){return typeof e[Symbol.asyncIterator]=="function"}function Uv(e){if(typeof e!="function")throw new Error("expected a function");return Pm(e)?(0,hy.default)(e):e}Ul.default=Uv,Ul.isAsync=Pm,Ul.isAsyncGenerator=Ay,Ul.isAsyncIterable=JA;var f0={exports:{}};(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=r;function r(n,i){if(i===void 0&&(i=n.length),!i)throw new Error("arity is undefined");function a(){for(var s=this,l=[],p=arguments.length;p--;)l[p]=arguments[p];return typeof l[i-1]=="function"?n.apply(this,l):new Promise(function(m,T){l[i-1]=function(R){for(var L=[],z=arguments.length-1;z-- >0;)L[z]=arguments[z+1];if(R)return T(R);m(L.length>1?L:L[0])},n.apply(s,l)})}return a}e.exports=t.default})(f0,f0.exports),function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=$A.exports,n=p(r),i=Ul,a=p(i),s=f0.exports,l=p(s);function p(m){return m&&m.__esModule?m:{default:m}}t.default=(0,l.default)(function(m,T,R){var L=(0,n.default)(T)?[]:{};m(T,function(z,re,ee){(0,a.default)(z)(function(me){for(var Ie,He=[],Xe=arguments.length-1;Xe-- >0;)He[Xe]=arguments[Xe+1];He.length<2&&(Ie=He,He=Ie[0]),L[re]=He,ee(me)})},function(z){return R(z,L)})},3),e.exports=t.default}(_h,_h.exports);var ep={exports:{}},tp={exports:{}},Zv={exports:{}},rp={exports:{}};(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=r;function r(n){function i(){for(var a=[],s=arguments.length;s--;)a[s]=arguments[s];if(n!==null){var l=n;n=null,l.apply(this,a)}}return Object.assign(i,n),i}e.exports=t.default})(rp,rp.exports);var zv={exports:{}},Gv={exports:{}};(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(r){return r[Symbol.iterator]&&r[Symbol.iterator]()},e.exports=t.default})(Gv,Gv.exports),function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=T;var r=$A.exports,n=s(r),i=Gv.exports,a=s(i);function s(R){return R&&R.__esModule?R:{default:R}}function l(R){var L=-1,z=R.length;return function(){return++L<z?{value:R[L],key:L}:null}}function p(R){var L=-1;return function(){var re=R.next();return re.done?null:(L++,{value:re.value,key:L})}}function m(R){var L=R?Object.keys(R):[],z=-1,re=L.length;return function ee(){var me=L[++z];return me==="__proto__"?ee():z<re?{value:R[me],key:me}:null}}function T(R){if((0,n.default)(R))return l(R);var L=(0,a.default)(R);return L?p(L):m(R)}e.exports=t.default}(zv,zv.exports);var np={exports:{}};(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=r;function r(n){return function(){for(var i=[],a=arguments.length;a--;)i[a]=arguments[a];if(n===null)throw new Error("Callback was already called.");var s=n;n=null,s.apply(this,i)}}e.exports=t.default})(np,np.exports);var Vv={exports:{}},sA={exports:{}};(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r={};t.default=r,e.exports=t.default})(sA,sA.exports),function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=a;var r=sA.exports,n=i(r);function i(s){return s&&s.__esModule?s:{default:s}}function a(s,l,p,m){var T=!1,R=!1,L=!1,z=0,re=0;function ee(){z>=l||L||T||(L=!0,s.next().then(function(He){var Xe=He.value,ot=He.done;if(!(R||T)){if(L=!1,ot){T=!0,z<=0&&m(null);return}z++,p(Xe,re,me),re++,ee()}}).catch(Ie))}function me(He,Xe){if(z-=1,!R){if(He)return Ie(He);if(He===!1){T=!0,R=!0;return}if(Xe===n.default||T&&z<=0)return T=!0,m(null);ee()}}function Ie(He){R||(L=!1,T=!0,m(He))}ee()}e.exports=t.default}(Vv,Vv.exports),function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=rp.exports,n=z(r),i=zv.exports,a=z(i),s=np.exports,l=z(s),p=Ul,m=Vv.exports,T=z(m),R=sA.exports,L=z(R);function z(re){return re&&re.__esModule?re:{default:re}}t.default=function(re){return function(ee,me,Ie){if(Ie=(0,n.default)(Ie),re<=0)throw new RangeError("concurrency limit cannot be less than 1");if(!ee)return Ie(null);if((0,p.isAsyncGenerator)(ee))return(0,T.default)(ee,re,me,Ie);if((0,p.isAsyncIterable)(ee))return(0,T.default)(ee[Symbol.asyncIterator](),re,me,Ie);var He=(0,a.default)(ee),Xe=!1,ot=!1,pt=0,dt=!1;function It(Kt,yr){if(!ot)if(pt-=1,Kt)Xe=!0,Ie(Kt);else if(Kt===!1)Xe=!0,ot=!0;else{if(yr===L.default||Xe&&pt<=0)return Xe=!0,Ie(null);dt||Vt()}}function Vt(){for(dt=!0;pt<re&&!Xe;){var Kt=He();if(Kt===null){Xe=!0,pt<=0&&Ie(null);return}pt+=1,me(Kt.value,Kt.key,(0,l.default)(It))}dt=!1}Vt()}},e.exports=t.default}(Zv,Zv.exports),function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=Zv.exports,n=p(r),i=Ul,a=p(i),s=f0.exports,l=p(s);function p(T){return T&&T.__esModule?T:{default:T}}function m(T,R,L,z){return(0,n.default)(R)(T,(0,a.default)(L),z)}t.default=(0,l.default)(m,4),e.exports=t.default}(tp,tp.exports),function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=tp.exports,n=s(r),i=f0.exports,a=s(i);function s(p){return p&&p.__esModule?p:{default:p}}function l(p,m,T){return(0,n.default)(p,1,m,T)}t.default=(0,a.default)(l,3),e.exports=t.default}(ep,ep.exports),function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=l;var r=_h.exports,n=s(r),i=ep.exports,a=s(i);function s(p){return p&&p.__esModule?p:{default:p}}function l(p,m){return(0,n.default)(a.default,p,m)}e.exports=t.default}(Dv,Dv.exports);var ip=cd(Dv.exports),Hf=function(){function e(){this.args=[],this.tasks=[]}return e.prototype.call=function(){for(var t=arguments,r=[],n=0;n<arguments.length;n++)r[n]=t[n];return this.args=r,ip(this.tasks)},e.prototype.tap=function(t,r){var n=this;this.tasks.push(function(i){r.apply(void 0,k0([],YA(n.args),!1)),i(null,t)})},e}(),Hv={exports:{}},hd={exports:{}};(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=$A.exports,n=me(r),i=sA.exports,a=me(i),s=tp.exports,l=me(s),p=rp.exports,m=me(p),T=np.exports,R=me(T),L=Ul,z=me(L),re=f0.exports,ee=me(re);function me(ot){return ot&&ot.__esModule?ot:{default:ot}}function Ie(ot,pt,dt){dt=(0,m.default)(dt);var It=0,Vt=0,Kt=ot.length,yr=!1;Kt===0&&dt(null);function _r(Hr,nn){Hr===!1&&(yr=!0),yr!==!0&&(Hr?dt(Hr):(++Vt===Kt||nn===a.default)&&dt(null))}for(;It<Kt;It++)pt(ot[It],It,(0,R.default)(_r))}function He(ot,pt,dt){return(0,l.default)(ot,1/0,pt,dt)}function Xe(ot,pt,dt){var It=(0,n.default)(ot)?Ie:He;return It(ot,(0,z.default)(pt),dt)}t.default=(0,ee.default)(Xe,3),e.exports=t.default})(hd,hd.exports),function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=l;var r=hd.exports,n=s(r),i=_h.exports,a=s(i);function s(p){return p&&p.__esModule?p:{default:p}}function l(p,m){return(0,a.default)(n.default,p,m)}e.exports=t.default}(Hv,Hv.exports);var Wv=cd(Hv.exports),py=function(){function e(){this.tasks=[]}return e.prototype.promise=function(){return Wv(this.tasks)},e.prototype.tapPromise=function(t,r){var n=this;this.tasks.push(function(i){return oA(n,void 0,void 0,function(){return Nv(this,function(a){switch(a.label){case 0:return[4,r()];case 1:return a.sent(),i(null,t),[2]}})})})},e}(),jv={exports:{}};(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=rp.exports,n=T(r),i=np.exports,a=T(i),s=Ul,l=T(s),p=f0.exports,m=T(p);function T(L){return L&&L.__esModule?L:{default:L}}function R(L,z){if(z=(0,n.default)(z),!Array.isArray(L))return z(new Error("First argument to waterfall must be an array of functions"));if(!L.length)return z();var re=0;function ee(Ie){var He=(0,l.default)(L[re++]);He.apply(void 0,Ie.concat([(0,a.default)(me)]))}function me(Ie){for(var He=[],Xe=arguments.length-1;Xe-- >0;)He[Xe]=arguments[Xe+1];if(Ie!==!1){if(Ie||re===L.length)return z.apply(void 0,[Ie].concat(He));ee(He)}}ee([])}t.default=(0,m.default)(R),e.exports=t.default})(jv,jv.exports);var Om=cd(jv.exports),hT=function(){function e(){this.tasks=[]}return e.prototype.call=function(){return Om(this.tasks)},e.prototype.tap=function(t,r){this.tasks.length===0?this.tasks.push(function(n){var i=r();n(i?null:!1,i)}):this.tasks.push(function(n,i){var a=r.apply(void 0,k0([],YA(n),!1));i(a?null:!1,t)})},e}(),Nm=function(){function e(){this.tasks=[]}return e.prototype.call=function(){return ip(this.tasks)},e.prototype.tap=function(t,r){this.tasks.push(function(n){var i=r();n(i,t)})},e}(),dy=function(){function e(){this.args=[],this.tasks=[]}return e.prototype.promise=function(){for(var t=arguments,r=[],n=0;n<arguments.length;n++)r[n]=t[n];return this.args=r,ip(this.tasks)},e.prototype.tapPromise=function(t,r){var n=this;this.tasks.push(function(i){return oA(n,void 0,void 0,function(){return Nv(this,function(a){switch(a.label){case 0:return[4,r.apply(void 0,k0([],YA(this.args),!1))];case 1:return a.sent(),i(null,t),[2]}})})})},e}(),vy=function(){function e(){this.args=[],this.tasks=[]}return e.prototype.promise=function(){for(var t=arguments,r=[],n=0;n<arguments.length;n++)r[n]=t[n];return this.args=r,ip(this.tasks)},e.prototype.tapPromise=function(t,r){var n=this;this.tasks.push(function(i){return oA(n,void 0,void 0,function(){var a;return Nv(this,function(s){switch(s.label){case 0:return[4,r.apply(void 0,k0([],YA(this.args),!1))];case 1:return a=s.sent(),i(a,t),[2]}})})})},e}(),gy=function(){function e(){this.tasks=[]}return e.prototype.promise=function(){return Om(this.tasks)},e.prototype.tapPromise=function(t,r){this.tasks.length===0?this.tasks.push(function(n){r().then(function(i){n(null,i)})}):this.tasks.push(function(n,i){r(n).then(function(a){i(null,a)})})},e}(),Dm=C(67499),c=C.n(Dm),A,_,x,w,P,N,V,W,k,K,J,se,de,gt,at,Zt,mt,rt,lt,Qt,Yt,or,nr,dr,Mt,vi,In,Fi,aa,un,Ai,Gn,za,La,ha;function el(e){var t=tu();return function(){var n=(0,le.Z)(e),i;if(t){var a=(0,le.Z)(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return(0,ze.Z)(this,i)}}function tu(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var Tu=(A=(0,Tt.b2)(),_=(0,Tt.f3)(xt.SceneID),x=(0,Tt.f3)(xt.IIconService),w=(0,Tt.f3)(xt.IFontService),P=(0,Tt.f3)(xt.IControlService),N=(0,Tt.f3)(xt.IGlobalConfigService),V=(0,Tt.f3)(xt.IMapService),W=(0,Tt.f3)(xt.ICoordinateSystemService),k=(0,Tt.f3)(xt.IRendererService),K=(0,Tt.f3)(xt.ILayerService),J=(0,Tt.f3)(xt.IDebugService),se=(0,Tt.f3)(xt.ICameraService),de=(0,Tt.f3)(xt.IInteractionService),gt=(0,Tt.f3)(xt.IPickingService),at=(0,Tt.f3)(xt.IShaderModuleService),Zt=(0,Tt.f3)(xt.IMarkerService),mt=(0,Tt.f3)(xt.IPopupService),A(rt=(lt=function(e){(0,ke.Z)(r,e);var t=el(r);function r(){var n;return(0,ue.Z)(this,r),n=t.call(this),(0,ve.Z)((0,St.Z)(n),"destroyed",!1),(0,ve.Z)((0,St.Z)(n),"loaded",!1),fa((0,St.Z)(n),"id",Qt,(0,St.Z)(n)),fa((0,St.Z)(n),"iconService",Yt,(0,St.Z)(n)),fa((0,St.Z)(n),"fontService",or,(0,St.Z)(n)),fa((0,St.Z)(n),"controlService",nr,(0,St.Z)(n)),fa((0,St.Z)(n),"configService",dr,(0,St.Z)(n)),fa((0,St.Z)(n),"map",Mt,(0,St.Z)(n)),fa((0,St.Z)(n),"coordinateSystemService",vi,(0,St.Z)(n)),fa((0,St.Z)(n),"rendererService",In,(0,St.Z)(n)),fa((0,St.Z)(n),"layerService",Fi,(0,St.Z)(n)),fa((0,St.Z)(n),"debugService",aa,(0,St.Z)(n)),fa((0,St.Z)(n),"cameraService",un,(0,St.Z)(n)),fa((0,St.Z)(n),"interactionService",Ai,(0,St.Z)(n)),fa((0,St.Z)(n),"pickingService",Gn,(0,St.Z)(n)),fa((0,St.Z)(n),"shaderModuleService",za,(0,St.Z)(n)),fa((0,St.Z)(n),"markerService",La,(0,St.Z)(n)),fa((0,St.Z)(n),"popupService",ha,(0,St.Z)(n)),(0,ve.Z)((0,St.Z)(n),"inited",!1),(0,ve.Z)((0,St.Z)(n),"initPromise",void 0),(0,ve.Z)((0,St.Z)(n),"rendering",!1),(0,ve.Z)((0,St.Z)(n),"$container",void 0),(0,ve.Z)((0,St.Z)(n),"canvas",void 0),(0,ve.Z)((0,St.Z)(n),"markerContainer",void 0),(0,ve.Z)((0,St.Z)(n),"hooks",void 0),(0,ve.Z)((0,St.Z)(n),"handleWindowResized",function(){n.emit("resize"),n.$container&&(n.initContainer(),vs(),n.coordinateSystemService.needRefresh=!0,n.render())}),(0,ve.Z)((0,St.Z)(n),"handleMapCameraChanged",function(i){n.cameraService.update(i),n.render()}),n.hooks={init:new dy},n}return(0,_e.Z)(r,[{key:"init",value:function(i){var a=this;this.configService.setSceneConfig(this.id,i),this.shaderModuleService.registerBuiltinModules(),this.iconService.init(),this.iconService.on("imageUpdate",function(){return a.render()}),this.fontService.init(),this.hooks.init.tapPromise("initMap",(0,hr.Z)(it().mark(function s(){return it().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return a.debugService.log("map.mapInitStart",{type:a.map.version}),p.next=3,new Promise(function(m){a.map.onCameraChanged(function(T){a.cameraService.init(),a.cameraService.update(T),m()}),a.map.init()});case 3:a.map.onCameraChanged(a.handleMapCameraChanged),a.map.addMarkerContainer(),a.markerService.addMarkers(),a.markerService.addMarkerLayers(),a.popupService.initPopup(),a.interactionService.init(),a.interactionService.on(Vs.Drag,a.addSceneEvent.bind(a));case 10:case"end":return p.stop()}},s)}))),this.hooks.init.tapPromise("initRenderer",(0,hr.Z)(it().mark(function s(){var l,p,m;return it().wrap(function(R){for(;;)switch(R.prev=R.next){case 0:if(p=((l=a.map)===null||l===void 0?void 0:l.getOverlayContainer())||void 0,p?a.$container=p:a.$container=nd(a.configService.getSceneConfig(a.id).id||""),!a.$container){R.next=13;break}return a.canvas=wi("canvas","",a.$container),a.setCanvas(),R.next=7,a.rendererService.init(a.canvas,a.configService.getSceneConfig(a.id),i.gl);case 7:a.registerContextLost(),a.initContainer(),c()(a.$container,a.handleWindowResized),window.matchMedia&&((m=window.matchMedia("screen and (-webkit-min-device-pixel-ratio: 1.5)"))===null||m===void 0||m.addListener(a.handleWindowResized)),R.next=14;break;case 13:console.error("\u5BB9\u5668 id \u4E0D\u5B58\u5728");case 14:a.pickingService.init(a.id);case 15:case"end":return R.stop()}},s)}))),this.render()}},{key:"registerContextLost",value:function(){var i=this,a=this.rendererService.getCanvas();a&&a.addEventListener("webglcontextlost",function(){return i.emit("webglcontextlost")})}},{key:"initMiniScene",value:function(i){var a=this;this.configService.setSceneConfig(this.id,i),this.shaderModuleService.registerBuiltinModules(),this.iconService.init(),this.iconService.on("imageUpdate",function(){return a.render()}),this.fontService.init(),this.hooks.init.tapPromise("initMap",(0,hr.Z)(it().mark(function s(){return it().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return p.next=2,new Promise(function(m){a.map.onCameraChanged(function(T){a.cameraService.init(),a.cameraService.update(T),a.map.version!=="GAODE2.x"&&m()}),a.map.initMiniMap()});case 2:a.map.onCameraChanged(a.handleMapCameraChanged),a.interactionService.init(),a.interactionService.on(Vs.Drag,a.addSceneEvent.bind(a));case 5:case"end":return p.stop()}},s)}))),this.hooks.init.tapPromise("initRenderer",(0,hr.Z)(it().mark(function s(){var l;return it().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:if(l=i.canvas,a.$container=l||null,!a.$container){m.next=7;break}return m.next=5,a.rendererService.init(i.canvas,a.configService.getSceneConfig(a.id),void 0);case 5:m.next=8;break;case 7:console.error("\u5BB9\u5668 id \u4E0D\u5B58\u5728");case 8:a.pickingService.init(a.id);case 9:case"end":return m.stop()}},s)}))),this.initPromise=this.hooks.init.promise(),this.render()}},{key:"addLayer",value:function(i){this.layerService.sceneService=this,this.layerService.add(i)}},{key:"addMask",value:function(i){this.layerService.sceneService=this,this.layerService.addMask(i)}},{key:"render",value:function(){var n=(0,hr.Z)(it().mark(function a(){return it().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:if(!(this.rendering||this.destroyed)){l.next=2;break}return l.abrupt("return");case 2:if(this.rendering=!0,this.inited){l.next=16;break}return l.next=6,this.hooks.init.promise();case 6:return this.destroyed&&this.destroy(),l.next=9,this.layerService.initLayers();case 9:this.layerService.renderLayers(),this.controlService.addControls(),this.loaded=!0,this.emit("loaded"),this.inited=!0,l.next=20;break;case 16:return l.next=18,this.layerService.initLayers();case 18:return l.next=20,this.layerService.renderLayers();case 20:this.rendering=!1;case 21:case"end":return l.stop()}},a,this)}));function i(){return n.apply(this,arguments)}return i}()},{key:"addFontFace",value:function(i,a){this.fontService.addFontFace(i,a)}},{key:"getSceneContainer",value:function(){return this.$container}},{key:"exportPng",value:function(){var n=(0,hr.Z)(it().mark(function a(s){var l,p,m;return it().wrap(function(R){for(;;)switch(R.prev=R.next){case 0:return p=(l=this.$container)===null||l===void 0?void 0:l.getElementsByTagName("canvas")[0],R.next=3,this.render();case 3:return m=s==="jpg"?p==null?void 0:p.toDataURL("image/jpeg"):p==null?void 0:p.toDataURL("image/png"),R.abrupt("return",m);case 5:case"end":return R.stop()}},a,this)}));function i(a){return n.apply(this,arguments)}return i}()},{key:"getSceneConfig",value:function(){return this.configService.getSceneConfig(this.id)}},{key:"getPointSizeRange",value:function(){return this.rendererService.getPointSizeRange()}},{key:"addMarkerContainer",value:function(){var i=this.$container.parentElement;i!==null&&(this.markerContainer=wi("div","l7-marker-container",i))}},{key:"getMarkerContainer",value:function(){return this.markerContainer}},{key:"destroy",value:function(){var i=this,a;if(!this.inited){this.destroyed=!0;return}if((0,Dm.unbind)(this.$container,this.handleWindowResized),window.matchMedia){var s;(s=window.matchMedia("screen and (min-resolution: 2dppx)"))===null||s===void 0||s.removeListener(this.handleWindowResized)}this.pickingService.destroy(),this.layerService.destroy(),this.interactionService.destroy(),this.controlService.destroy(),this.markerService.destroy(),this.fontService.destroy(),this.iconService.destroy(),this.removeAllListeners(),this.inited=!1,this.map.destroy(),setTimeout(function(){var l;(l=i.$container)===null||l===void 0||l.removeChild(i.canvas),i.canvas=null,i.rendererService.destroy()}),(a=this.$container)===null||a===void 0||(a=a.parentNode)===null||a===void 0||a.removeChild(this.$container),this.emit("destroy")}},{key:"initContainer",value:function(){var i,a,s=ba,l=((i=this.$container)===null||i===void 0?void 0:i.clientWidth)||400,p=((a=this.$container)===null||a===void 0?void 0:a.clientHeight)||300,m=this.canvas;m&&(m.width=l*s,m.height=p*s),this.rendererService.viewport({x:0,y:0,width:s*l,height:s*p})}},{key:"setCanvas",value:function(){var i,a,s=ba,l=((i=this.$container)===null||i===void 0?void 0:i.clientWidth)||400,p=((a=this.$container)===null||a===void 0?void 0:a.clientHeight)||300,m=this.canvas;m.width=l*s,m.height=p*s,m.style.width="100%",m.style.height="100%"}},{key:"addSceneEvent",value:function(i){this.emit(i.type,i)}}]),r}(Si.EventEmitter),Qt=Ji(lt.prototype,"id",[_],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Yt=Ji(lt.prototype,"iconService",[x],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),or=Ji(lt.prototype,"fontService",[w],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),nr=Ji(lt.prototype,"controlService",[P],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),dr=Ji(lt.prototype,"configService",[N],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Mt=Ji(lt.prototype,"map",[V],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),vi=Ji(lt.prototype,"coordinateSystemService",[W],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),In=Ji(lt.prototype,"rendererService",[k],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Fi=Ji(lt.prototype,"layerService",[K],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),aa=Ji(lt.prototype,"debugService",[J],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),un=Ji(lt.prototype,"cameraService",[se],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ai=Ji(lt.prototype,"interactionService",[de],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Gn=Ji(lt.prototype,"pickingService",[gt],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),za=Ji(lt.prototype,"shaderModuleService",[at],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),La=Ji(lt.prototype,"markerService",[Zt],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ha=Ji(lt.prototype,"popupService",[mt],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),lt))||rt);function co(e){var t=0;switch(e){case"vec2":case"ivec2":t=2;break;case"vec3":case"ivec3":t=3;break;case"vec4":case"ivec4":case"mat2":t=4;break;case"mat3":t=9;break;case"mat4":t=16;break;default:}return t}var So=/uniform\s+(bool|float|int|vec2|vec3|vec4|ivec2|ivec3|ivec4|mat2|mat3|mat4|sampler2D|samplerCube)\s+([\s\S]*?);/g;function es(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,r={};return e=e.replace(So,function(n,i,a){var s=a.split(":"),l=s[0].trim(),p="";switch(s.length>1&&(p=s[1].trim()),i){case"bool":p=p==="true";break;case"float":case"int":p=Number(p);break;case"vec2":case"vec3":case"vec4":case"ivec2":case"ivec3":case"ivec4":case"mat2":case"mat3":case"mat4":p?p=p.replace("[","").replace("]","").split(",").reduce(function(m,T){return m.push(Number(T.trim())),m},[]):p=new Array(co(i)).fill(0);break;default:}return r[l]=p,"".concat(t?"uniform ":"").concat(i," ").concat(l,`;
`)}),{content:e,uniforms:r}}function bc(e){var t=es(e,!0),r=t.content,n=t.uniforms;return r=r.replace(/(\s*uniform\s*.*\s*){((?:\s*.*\s*)*?)};/g,function(i,a,s){s=s.trim().replace(/^.*$/gm,function(T){return"uniform ".concat(T)});var l=es(s),p=l.content,m=l.uniforms;return Object.assign(n,m),"".concat(a,`{
`).concat(p,`
};`)}),{content:r,uniforms:n}}function Qc(e){var t={};return e.replace(So,function(r,n,i){var a=i.trim();return t[a]?"":(t[a]=!0,"uniform ".concat(n," ").concat(a,`;
`))})}var ap,yh,op=Fn.uniq,uA="#define PI 3.14159265359",Lm=`#define SHIFT_RIGHT17 1.0 / 131072.0
#define SHIFT_RIGHT18 1.0 / 262144.0
#define SHIFT_RIGHT19 1.0 / 524288.0
#define SHIFT_RIGHT20 1.0 / 1048576.0
#define SHIFT_RIGHT21 1.0 / 2097152.0
#define SHIFT_RIGHT22 1.0 / 4194304.0
#define SHIFT_RIGHT23 1.0 / 8388608.0
#define SHIFT_RIGHT24 1.0 / 16777216.0

#define SHIFT_LEFT17 131072.0
#define SHIFT_LEFT18 262144.0
#define SHIFT_LEFT19 524288.0
#define SHIFT_LEFT20 1048576.0
#define SHIFT_LEFT21 2097152.0
#define SHIFT_LEFT22 4194304.0
#define SHIFT_LEFT23 8388608.0
#define SHIFT_LEFT24 16777216.0

vec2 unpack_float(float packedValue) {
  int packedIntValue = int(packedValue);
  int v0 = packedIntValue / 256;
  return vec2(v0, packedIntValue - v0 * 256);
}

vec4 decode_color(vec2 encodedColor) {
  return vec4(
    unpack_float(encodedColor[0]) / 255.0,
    unpack_float(encodedColor[1]) / 255.0
  );
}
`,Xv=`layout(std140) uniform SceneUniforms {
  mat4 u_ViewMatrix;
  mat4 u_ProjectionMatrix;
  mat4 u_ViewProjectionMatrix;
  mat4 u_ModelMatrix;
  mat4 u_Mvp;
  vec4 u_ViewportCenterProjection;
  vec3 u_PixelsPerDegree;
  float u_Zoom;
  vec3 u_PixelsPerDegree2;
  float u_ZoomScale;
  vec3 u_PixelsPerMeter;
  float u_CoordinateSystem;
  vec3 u_CameraPosition;
  float u_DevicePixelRatio;
  vec2 u_ViewportCenter;
  vec2 u_ViewportSize;
  vec2 u_sceneCenterMercator;
  float u_FocalDistance;
};`,Yv=`layout(std140) uniform PickingUniforms {
  vec4 u_HighlightColor;
  vec4 u_SelectColor;
  vec3 u_PickingColor;
  float u_PickingStage;
  vec3 u_CurrentSelectedId;
  float u_PickingThreshold;
  float u_PickingBuffer;
  float u_shaderPick;
  float u_EnableSelect;
  float u_activeMix;
};`,Fm=`#define ambientRatio 0.5
#define diffuseRatio 0.3
#define specularRatio 0.2


float calc_lighting(vec4 pos) {

    vec3 worldPos = vec3(pos * u_ModelMatrix);

    vec3 worldNormal = a_Normal;
      // //cal light weight
    vec3 viewDir = normalize(u_CameraPosition - worldPos);

    vec3 lightDir = normalize(vec3(1, -10.5, 12));

    vec3 halfDir = normalize(viewDir+lightDir);
      // //lambert
    float lambert = dot(worldNormal, lightDir);
        //specular
    float specular = pow(max(0.0, dot(worldNormal, halfDir)), 32.0);
        //sum to light weight
    float lightWeight = ambientRatio + diffuseRatio * lambert + specularRatio * specular;

    return lightWeight;
}
`,AT=`// Blinn-Phong model
// apply lighting in vertex shader instead of fragment shader
// @see https://learnopengl.com/Advanced-Lighting/Advanced-Lighting
uniform float u_Ambient : 1.0;
uniform float u_Diffuse : 1.0;
uniform float u_Specular : 1.0;
uniform int u_NumOfDirectionalLights : 1;
uniform int u_NumOfSpotLights : 0;

#define SHININESS 32.0
#define MAX_NUM_OF_DIRECTIONAL_LIGHTS 3
#define MAX_NUM_OF_SPOT_LIGHTS 3

struct DirectionalLight {
  vec3 direction;
  vec3 ambient;
  vec3 diffuse;
  vec3 specular;
};

struct SpotLight {
  vec3 position;
  vec3 direction;
  vec3 ambient;
  vec3 diffuse;
  vec3 specular;
  float constant;
  float linear;
  float quadratic;
  float angle;
  float blur;
  float exponent;
};

uniform DirectionalLight u_DirectionalLights[MAX_NUM_OF_DIRECTIONAL_LIGHTS];
uniform SpotLight u_SpotLights[MAX_NUM_OF_SPOT_LIGHTS];

vec3 calc_directional_light(DirectionalLight light, vec3 normal, vec3 viewDir) {
  vec3 lightDir = normalize(light.direction);
  // diffuse shading
  float diff = max(dot(normal, lightDir), 0.0);
  // Blinn-Phong specular shading
  vec3 halfwayDir = normalize(lightDir + viewDir);
  float spec = pow(max(dot(normal, halfwayDir), 0.0), SHININESS);

  vec3 ambient = light.ambient * u_Ambient;
  vec3 diffuse = light.diffuse * diff * u_Diffuse;
  vec3 specular = light.specular * spec * u_Specular;

  return ambient + diffuse + specular;
}

// vec3 calc_spot_light(SpotLight light, vec3 normal, vec3 fragPos, vec3 viewDir) {
//   vec3 lightDir = normalize(light.position - fragPos);
//   // diffuse shading
//   float diff = max(dot(normal, lightDir), 0.0);
//   // specular shading
//   vec3 reflectDir = reflect(-lightDir, normal);
//   float spec = pow(max(dot(viewDir, reflectDir), 0.0), SHININESS);
//   // attenuation
//   float distance = length(light.position - fragPos);
//   float attenuation = 1.0 / (light.constant + light.linear * distance +
//           light.quadratic * (distance * distance));

//   vec3 ambient = light.ambient * u_Ambient;
//   vec3 diffuse = light.diffuse * diff * u_Diffuse;
//   vec3 specular = light.specular * spec * u_Specular;

//   float spotEffect = dot(normalize(light.direction), -lightDir);
//   float spotCosCutoff = cos(light.angle / 180.0 * PI);
//   float spotCosOuterCutoff = cos((light.angle + light.blur) / 180.0 * PI);
//   float spotCosInnerCutoff = cos((light.angle - light.blur) / 180.0 * PI);
//   if (spotEffect > spotCosCutoff) {
//     spotEffect = pow(smoothstep(spotCosOuterCutoff, spotCosInnerCutoff, spotEffect), light.exponent);
//   } else {
//     spotEffect = 0.0;
//   }

//   return ambient + attenuation * (spotEffect * diffuse + specular);
// }

vec3 calc_lighting(vec3 position, vec3 normal, vec3 viewDir) {
  vec3 weight = vec3(0.0);
  for (int i = 0; i < MAX_NUM_OF_DIRECTIONAL_LIGHTS; i++) {
    if (i >= u_NumOfDirectionalLights) {
      break;
    }
    weight += calc_directional_light(u_DirectionalLights[i], normal, viewDir);
  }
  // for (int i = 0; i < MAX_NUM_OF_SPOT_LIGHTS; i++) {
  //   if (i >= u_NumOfSpotLights) {
  //     break;
  //   }
  //   weight += calc_spot_light(u_SpotLights[i], normal, position, viewDir);
  // }
  return weight;
}
`,pT=`
in vec4 v_PickingResult;

#pragma include "picking_uniforms"

#define PICKING_NONE 0.0
#define PICKING_ENCODE 1.0
#define PICKING_HIGHLIGHT 2.0
#define COLOR_SCALE 1. / 255.

#define HIGHLIGHT 1.0
#define SELECT 2.0

/*
 * Returns highlight color if this item is selected.
 */
vec4 filterHighlightColor(vec4 color, float weight) {
  // float selected = v_PickingResult.a;
  bool selected = bool(v_PickingResult.a);

  // if (selected == SELECT) {
  if (selected) {
  //   // \u70B9\u51FB\u9009\u4E2D\u72B6\u6001
  //   vec4 selectColor = u_SelectColor * COLOR_SCALE;
  //   return selectColor;
  // } else if (selected == HIGHLIGHT) {
  //   // hover \u9AD8\u4EAE\u72B6\u6001
    vec4 highLightColor = u_HighlightColor * COLOR_SCALE;

    float highLightAlpha = highLightColor.a;
    float highLightRatio = highLightAlpha / (highLightAlpha + color.a * (1.0 - highLightAlpha));

    vec3 resultRGB = mix(color.rgb, highLightColor.rgb, highLightRatio);
    return vec4(mix(resultRGB * weight, color.rgb, u_activeMix), color.a);
  } else {
    return color;
  }
}

/*
 * Returns picking color if picking enabled else unmodified argument.
 */
vec4 filterPickingColor(vec4 color) {
  vec3 pickingColor = v_PickingResult.rgb;
  if (u_PickingStage == PICKING_ENCODE && length(pickingColor) < 0.001) {
    discard;
  }
  return u_PickingStage == PICKING_ENCODE ? vec4(pickingColor, step(0.001,color.a)): color;
}

/*
 * Returns picking color if picking is enabled if not
 * highlight color if this item is selected, otherwise unmodified argument.
 */
vec4 filterColor(vec4 color) {
  // \u8FC7\u6EE4\u591A\u4F59\u7684 shader \u8BA1\u7B97
  // return color;
  if(u_shaderPick < 0.5) {
    return color; // \u6682\u65F6\u53BB\u9664 \u76F4\u63A5\u53D6\u6D88\u8BA1\u7B97\u5728\u9009\u4E2D\u65F6\u62D6\u62FD\u5730\u56FE\u4F1A\u6709\u95EE\u9898
  } else {
    return filterPickingColor(filterHighlightColor(color, 1.0));
  }
  
}

vec4 filterColorAlpha(vec4 color, float alpha) {
  // \u8FC7\u6EE4\u591A\u4F59\u7684 shader \u8BA1\u7B97
  // return color;
  if(u_shaderPick < 0.5) {
    return color; // \u6682\u65F6\u53BB\u9664 \u76F4\u63A5\u53D6\u6D88\u8BA1\u7B97\u5728\u9009\u4E2D\u65F6\u62D6\u62FD\u5730\u56FE\u4F1A\u6709\u95EE\u9898
  } else {
    return filterPickingColor(filterHighlightColor(color, alpha));
  }
}

`,dT=`layout(location = 2) in vec3 a_PickingColor;
out vec4 v_PickingResult;

#pragma include "picking_uniforms"

#define PICKING_NONE 0.0
#define PICKING_ENCODE 1.0
#define PICKING_HIGHLIGHT 2.0
#define COLOR_SCALE 1. / 255.

#define NORMAL 0.0
#define HIGHLIGHT 1.0
#define SELECT 2.0

bool isVertexPicked(vec3 vertexColor) {
  return distance(vertexColor,u_PickingColor.rgb) < 0.01;
}

// \u5224\u65AD\u5F53\u524D\u70B9\u662F\u5426\u5DF2\u7ECF\u88AB select \u9009\u4E2D
bool isVertexSelected(vec3 vertexColor) {
  return distance(vertexColor,u_CurrentSelectedId.rgb) < 0.01;
}

void setPickingColor(vec3 pickingColor) {
  if(u_shaderPick < 0.5) {
    return;
  }
  // compares only in highlight stage

  v_PickingResult.a = float((u_PickingStage == PICKING_HIGHLIGHT) && isVertexPicked(pickingColor));

  // Stores the picking color so that the fragment shader can render it during picking
  v_PickingResult.rgb = pickingColor * COLOR_SCALE;
}

float setPickingSize(float x) {
   return u_PickingStage == PICKING_ENCODE ? x + u_PickingBuffer : x;
}

float setPickingOrder(float z) {
   bool selected = bool(v_PickingResult.a);
   return selected ? z + 1. : 0.;
}
`,vT=`
#define E 2.718281828459045
vec2 ProjectFlat(vec2 lnglat){
  float maxs=85.0511287798;
  float lat=max(min(maxs,lnglat.y),-maxs);
  float scale= 268435456.;
  float d=PI/180.;
  float x=lnglat.x*d;
  float y=lat*d;
  y=log(tan((PI/4.)+(y/2.)));

  float a=.5/PI,
  b=.5,
  c=-.5/PI;
  d=.5;
  x=scale*(a*x+b);
  y=scale*(c*y+d);
  return vec2(x,y);
}

vec2 unProjectFlat(vec2 px){
  float a=.5/PI;
  float b=.5;
  float c=-.5/PI;
  float d=.5;
  float scale = 268435456.;
  float x=(px.x/scale-b)/a;
  float y=(px.y/scale-d)/c;
  y=(atan(pow(E,y))-(PI/4.))*2.;
  d=PI/180.;
  float lat=y/d;
  float lng=x/d;
  return vec2(lng,lat);
}

float pixelDistance(vec2 from, vec2 to) {
 vec2 a1 = ProjectFlat(from);
 vec2 b1 = ProjectFlat(to);
 return distance(a1, b1);
}

// gaode2.0
vec2 customProject(vec2 lnglat) { // \u7ECF\u7EAC\u5EA6 => \u5E73\u9762\u5750\u6807
  float t = lnglat.x;
  float e = lnglat.y;
  float Sm = 180.0 / PI;
  float Tm = 6378137.0;
  float Rm = PI / 180.0;
  float r = 85.0511287798;
  e = max(min(r, e), -r);
  t *= Rm;
  e *= Rm;
  e = log(tan(PI / 4.0 + e / 2.0));
  return vec2(t * Tm, e * Tm);
}

vec2 unProjCustomCoord(vec2 point) { // \u5E73\u9762\u5750\u6807 => \u7ECF\u7EAC\u5EA6
  float Sm = 57.29577951308232; //180 / Math.PI
  float Tm = 6378137.0;
  float t = point.x;
  float e = point.y;
  return vec2(t / Tm * Sm, (2.0 * atan(exp(e / Tm)) - PI / 2.0) * Sm);
}


float customPixelDistance(vec2 from, vec2 to) {
 vec2 a1 = ProjectFlat(from);
 vec2 b1 = ProjectFlat(to);
 return distance(a1, b1);
}`,_y=`#define TILE_SIZE 512.0
#define PI 3.1415926536
#define WORLD_SCALE TILE_SIZE / (PI * 2.0)

#define COORDINATE_SYSTEM_LNGLAT 1.0        // mapbox
#define COORDINATE_SYSTEM_LNGLAT_OFFSET 2.0 // mapbox offset
#define COORDINATE_SYSTEM_VECTOR_TILE 3.0
#define COORDINATE_SYSTEM_IDENTITY 4.0
#define COORDINATE_SYSTEM_P20 5.0           // amap
#define COORDINATE_SYSTEM_P20_OFFSET 6.0    // amap offset
#define COORDINATE_SYSTEM_METER_OFFSET 7.0

#define COORDINATE_SYSTEM_P20_2 8.0         // amap2.0
#pragma include "scene_uniforms"


// web mercator coords -> world coords
vec2 project_mercator(vec2 lnglat) {
   if (u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.0
    return lnglat;
  }
  float x = lnglat.x;
  return vec2(
    radians(x) + PI,
    PI - log(tan(PI * 0.25 + radians(lnglat.y) * 0.5))
  );
}

float project_scale(float meters) {
  return meters * u_PixelsPerMeter.z;
}


// offset coords -> world coords
vec4 project_offset(vec4 offset) {
  float dy = offset.y;
  dy = clamp(dy, -1., 1.);
  vec3 pixels_per_unit = u_PixelsPerDegree + u_PixelsPerDegree2 * dy;
  return vec4(offset.xyz * pixels_per_unit, offset.w);
}

vec3 project_normal(vec3 normal) {
  vec4 normal_modelspace = u_ModelMatrix * vec4(normal, 0.0);
  return normalize(normal_modelspace.xyz * u_PixelsPerMeter);
}

vec3 project_offset_normal(vec3 vector) {
  if (u_CoordinateSystem < COORDINATE_SYSTEM_LNGLAT + 0.01 && u_CoordinateSystem >COORDINATE_SYSTEM_LNGLAT - 0.01
    || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
    // normals generated by the polygon tesselator are in lnglat offsets instead of meters
    return normalize(vector * u_PixelsPerDegree);
  }
  return project_normal(vector);
}
// || u_CoordinateSystem < COORDINATE_SYSTEM_P20_OFFSET + 0.01 && u_CoordinateSystem >COORDINATE_SYSTEM_P20_OFFSET - 0.01
// reverse Y
vec3 reverse_offset_normal(vec3 vector) {
  if (u_CoordinateSystem == COORDINATE_SYSTEM_P20 ||u_CoordinateSystem == COORDINATE_SYSTEM_P20_OFFSET ) {
    return vector * vec3(1.0, -1.0, 1.0);
  }

  if (u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.0
    return vector;
  }
  return vector;
}

vec4 project_mvt_offset_position(vec4 position) {
  float a = COORDINATE_SYSTEM_LNGLAT_OFFSET;
  float b = COORDINATE_SYSTEM_P20_OFFSET;
  float c = COORDINATE_SYSTEM_LNGLAT;
  if (u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET || u_CoordinateSystem == COORDINATE_SYSTEM_P20_OFFSET) {
    return project_offset(vec4(0.0, 0.0, position.z, position.w));
  }
  if (u_CoordinateSystem < COORDINATE_SYSTEM_LNGLAT + 0.01 && u_CoordinateSystem >COORDINATE_SYSTEM_LNGLAT - 0.01) {
    return vec4(
      project_mercator(position.xy) * WORLD_SCALE * u_ZoomScale,
      project_scale(position.z),
      position.w
    );
  }
  return position;
}

vec4 project_position(vec4 position) {
  float a = COORDINATE_SYSTEM_LNGLAT_OFFSET;
  float b = COORDINATE_SYSTEM_P20_OFFSET;
  float c = COORDINATE_SYSTEM_LNGLAT;
  if (u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET
    || u_CoordinateSystem == COORDINATE_SYSTEM_P20_OFFSET) {
    float X = position.x - u_ViewportCenter.x;
    float Y = position.y - u_ViewportCenter.y;
    return project_offset(vec4(X, Y, position.z, position.w));
  }
  if (u_CoordinateSystem < COORDINATE_SYSTEM_LNGLAT + 0.01 && u_CoordinateSystem >COORDINATE_SYSTEM_LNGLAT - 0.01) {
    return vec4(
      project_mercator(position.xy) * WORLD_SCALE * u_ZoomScale,
      project_scale(position.z),
      position.w
    );
  }
  if (u_CoordinateSystem == COORDINATE_SYSTEM_P20) {
    return vec4(
      (project_mercator(position.xy) * WORLD_SCALE * u_ZoomScale - vec2(215440491., 106744817.)) * vec2(1., -1.),
      project_scale(position.z),
      position.w
    );
  }

  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) {
   return position;
  }
  return position;

  // TODO: \u74E6\u7247\u5750\u6807\u7CFB & \u5E38\u89C4\u4E16\u754C\u5750\u6807\u7CFB
}
vec2 project_pixel_size_to_clipspace(vec2 pixels) {
  vec2 offset = pixels / u_ViewportSize * u_DevicePixelRatio * 2.0;
  return offset * u_FocalDistance;
}



float project_pixel_allmap(float pixel) {
  if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {
    return pixel * pow(2.0, u_Zoom);
  }
  return pixel * u_FocalDistance ;
}

// \u9002\u914D\u7EB9\u7406\u8D34\u56FE\u7684\u7B49\u50CF\u7D20\u5927\u5C0F
float project_pixel_texture(float pixel) {
  // mapbox zoom > 12
  if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
    return pixel * pow(0.5, u_Zoom) * u_FocalDistance ;
  }

  // amap2 zoom > 12
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) {
    return pixel * pow(2.0, (19.0 - 3.0 - u_Zoom))* u_FocalDistance ;
  }

  // amap zoom > 12
  if (u_CoordinateSystem == COORDINATE_SYSTEM_P20_OFFSET) {
    return pixel * pow(0.5, u_Zoom)* u_FocalDistance ;
  }
  
  // amap zoom < 12
  if (u_CoordinateSystem == COORDINATE_SYSTEM_P20) {
    return pixel * pow(2.0, (20.0 - u_Zoom))* u_FocalDistance ;
  }
  return pixel * 2.0 *  u_FocalDistance;;
}

// \u5728\u4E0D\u8BBA\u4EC0\u4E48\u5E95\u56FE\u4E0B\u9700\u8981\u7EDF\u4E00\u5904\u7406\u7684\u65F6\u5019\u4F7F\u7528
float project_float_pixel(float pixel) {
  if (u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
    // mapbox P20 \u5750\u6807\u7CFB\u4E0B\uFF0C\u4E3A\u4E86\u548C Web \u58A8\u5361\u6258\u5750\u6807\u7CFB\u7EDF\u4E00\uFF0Czoom \u9ED8\u8BA4\u51CF1
    return pixel * pow(2.0, (19.0 - u_Zoom))  * u_FocalDistance ;
  }
  if (u_CoordinateSystem == COORDINATE_SYSTEM_P20 || u_CoordinateSystem == COORDINATE_SYSTEM_P20_OFFSET) {
    // amap P20 \u5750\u6807\u7CFB\u4E0B\uFF0C\u4E3A\u4E86\u548C Web \u58A8\u5361\u6258\u5750\u6807\u7CFB\u7EDF\u4E00\uFF0Czoom \u9ED8\u8BA4\u51CF1
    return pixel * pow(2.0, (19.0 - u_Zoom));
  }
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) {
    // amap2 P20_2 \u5750\u6807\u7CFB\u4E0B\uFF0C\u4E3A\u4E86\u548C Web \u58A8\u5361\u6258\u5750\u6807\u7CFB\u7EDF\u4E00\uFF0Czoom \u9ED8\u8BA4\u51CF3
    return pixel * pow(2.0, (19.0 - 3.0 - u_Zoom))* u_FocalDistance ;
  }
  return pixel * u_FocalDistance;
}

float project_pixel(float pixel) {
  if (u_CoordinateSystem == COORDINATE_SYSTEM_P20 || u_CoordinateSystem == COORDINATE_SYSTEM_P20_OFFSET) {
    // amap P20 \u5750\u6807\u7CFB\u4E0B\uFF0C\u4E3A\u4E86\u548C Web \u58A8\u5361\u6258\u5750\u6807\u7CFB\u7EDF\u4E00\uFF0Czoom \u9ED8\u8BA4\u51CF1
    return pixel * pow(2.0, (19.0 - u_Zoom)) * u_FocalDistance ;
  }
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) {
    // amap2 P20_2 \u5750\u6807\u7CFB\u4E0B\uFF0C\u4E3A\u4E86\u548C Web \u58A8\u5361\u6258\u5750\u6807\u7CFB\u7EDF\u4E00\uFF0Czoom \u9ED8\u8BA4\u51CF3
    return pixel * pow(2.0, (19.0 - 3.0 - u_Zoom)) * u_FocalDistance ;
  }
  return pixel * u_FocalDistance;
}
vec2 project_pixel(vec2 pixel) {
  if (u_CoordinateSystem == COORDINATE_SYSTEM_P20 || u_CoordinateSystem == COORDINATE_SYSTEM_P20_OFFSET) {
    // P20 \u5750\u6807\u7CFB\u4E0B\uFF0C\u4E3A\u4E86\u548C Web \u58A8\u5361\u6258\u5750\u6807\u7CFB\u7EDF\u4E00\uFF0Czoom \u9ED8\u8BA4\u51CF1
    return pixel * pow(2.0, (19.0 - u_Zoom)) * u_FocalDistance ;
  }
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) {
    // P20_2 \u5750\u6807\u7CFB\u4E0B\uFF0C\u4E3A\u4E86\u548C Web \u58A8\u5361\u6258\u5750\u6807\u7CFB\u7EDF\u4E00\uFF0Czoom \u9ED8\u8BA4\u51CF3
    return pixel * pow(2.0, (19.0 - 3.0 - u_Zoom)) * u_FocalDistance ;
  }
  return pixel * -1. * u_FocalDistance;
}
vec3 project_pixel(vec3 pixel) {
  if (u_CoordinateSystem == COORDINATE_SYSTEM_P20 || u_CoordinateSystem == COORDINATE_SYSTEM_P20_OFFSET) {
    // P20 \u5750\u6807\u7CFB\u4E0B\uFF0C\u4E3A\u4E86\u548C Web \u58A8\u5361\u6258\u5750\u6807\u7CFB\u7EDF\u4E00\uFF0Czoom \u9ED8\u8BA4\u51CF1
    return pixel * pow(2.0, (19.0 - u_Zoom)) *  u_FocalDistance ;
  }
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) {
    // P20_2 \u5750\u6807\u7CFB\u4E0B\uFF0C\u4E3A\u4E86\u548C Web \u58A8\u5361\u6258\u5750\u6807\u7CFB\u7EDF\u4E00\uFF0Czoom \u9ED8\u8BA4\u51CF3
    return pixel * pow(2.0, (19.0 - 3.0 - u_Zoom))  * u_FocalDistance ;
  }
  return pixel * -1. * u_FocalDistance;
}

vec4 project_common_position_to_clipspace(vec4 position, mat4 viewProjectionMatrix, vec4 center) {
  if (u_CoordinateSystem == COORDINATE_SYSTEM_METER_OFFSET ||
    u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
    // Needs to be divided with project_uCommonUnitsPerMeter
    position.w *= u_PixelsPerMeter.z;
  }

  return viewProjectionMatrix * position + center;
}

// Projects from common space coordinates to clip space
vec4 project_common_position_to_clipspace(vec4 position) {
  return project_common_position_to_clipspace(
    position,
    u_ViewProjectionMatrix,
    u_ViewportCenterProjection
  );
}

vec4 unproject_clipspace_to_position(vec4 clipspacePos, mat4 u_InverseViewProjectionMatrix) {
  vec4 pos = u_InverseViewProjectionMatrix * (clipspacePos - u_ViewportCenterProjection);

  if (u_CoordinateSystem == COORDINATE_SYSTEM_METER_OFFSET ||
    u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
    // Needs to be divided with project_uCommonUnitsPerMeter
     pos.w = pos.w / u_PixelsPerMeter.z;
  }
  return pos;
}


bool isEqual( float a,  float b) {
    return  a< b + 0.001 && a > b - 0.001;
}

// \u652F\u6301 GaodeV2\u3001Mapbox
vec4 project_common_position_to_clipspace_v2(vec4 position) {
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    return u_Mvp * position;
  } else {
    return project_common_position_to_clipspace(position);
  }
}`,gT=`vec2 rotate_matrix(vec2 v, float a) {
    float b = a / 180.0 * 3.1415926535897932384626433832795;
    float s = sin(b);
    float c = cos(b);
    mat2 m = mat2(c, s, -s, c);
    return m * v;
}`,mT=`/**
 * 2D signed distance field functions
 * @see http://www.iquilezles.org/www/articles/distfunctions2d/distfunctions2d.htm
 */

float ndot(vec2 a, vec2 b ) { return a.x*b.x - a.y*b.y; }

float sdCircle(vec2 p, float r) {
  return length(p) - r;
}

float sdEquilateralTriangle(vec2 p) {
  float k = sqrt(3.0);
  p.x = abs(p.x) - 1.0;
  p.y = p.y + 1.0/k;
  if( p.x + k*p.y > 0.0 ) p = vec2(p.x-k*p.y,-k*p.x-p.y)/2.0;
  p.x -= clamp( p.x, -2.0, 0.0 );
  return -length(p)*sign(p.y);
}

float sdBox(vec2 p, vec2 b) {
  vec2 d = abs(p)-b;
  return length(max(d,vec2(0))) + min(max(d.x,d.y),0.0);
}

float sdPentagon(vec2 p, float r) {
  vec3 k = vec3(0.809016994,0.587785252,0.726542528);
  p.x = abs(p.x);
  p -= 2.0*min(dot(vec2(-k.x,k.y),p),0.0)*vec2(-k.x,k.y);
  p -= 2.0*min(dot(vec2( k.x,k.y),p),0.0)*vec2( k.x,k.y);
  p -= vec2(clamp(p.x,-r*k.z,r*k.z),r);
  return length(p)*sign(p.y);
}

float sdHexagon(vec2 p, float r) {
  vec3 k = vec3(-0.866025404,0.5,0.577350269);
  p = abs(p);
  p -= 2.0*min(dot(k.xy,p),0.0)*k.xy;
  p -= vec2(clamp(p.x, -k.z*r, k.z*r), r);
  return length(p)*sign(p.y);
}

float sdOctogon(vec2 p, float r) {
  vec3 k = vec3(-0.9238795325, 0.3826834323, 0.4142135623 );
  p = abs(p);
  p -= 2.0*min(dot(vec2( k.x,k.y),p),0.0)*vec2( k.x,k.y);
  p -= 2.0*min(dot(vec2(-k.x,k.y),p),0.0)*vec2(-k.x,k.y);
  p -= vec2(clamp(p.x, -k.z*r, k.z*r), r);
  return length(p)*sign(p.y);
}

float sdHexagram(vec2 p, float r) {
  vec4 k=vec4(-0.5,0.8660254038,0.5773502692,1.7320508076);
  p = abs(p);
  p -= 2.0*min(dot(k.xy,p),0.0)*k.xy;
  p -= 2.0*min(dot(k.yx,p),0.0)*k.yx;
  p -= vec2(clamp(p.x,r*k.z,r*k.w),r);
  return length(p)*sign(p.y);
}

float sdRhombus(vec2 p, vec2 b) {
  vec2 q = abs(p);
  float h = clamp((-2.0*ndot(q,b)+ndot(b,b))/dot(b,b),-1.0,1.0);
  float d = length( q - 0.5*b*vec2(1.0-h,1.0+h) );
  return d * sign( q.x*b.y + q.y*b.x - b.x*b.y );
}

float sdVesica(vec2 p, float r, float d) {
  p = abs(p);
  float b = sqrt(r*r-d*d); // can delay this sqrt
  return ((p.y-b)*d>p.x*b)
          ? length(p-vec2(0.0,b))
          : length(p-vec2(-d,0.0))-r;
}
`,yy=/precision\s+(high|low|medium)p\s+float/,Ey=`#ifdef GL_FRAGMENT_PRECISION_HIGH
 precision highp float;
 #else
 precision mediump float;
#endif
`,_T=/#pragma include (["^+"]?["[a-zA-Z_0-9](.*)"]*?)/g,yT=/void\s+main\s*\([^)]*\)\s*\{\n?/,l8=/}\n?[^{}]*$/,ET=(ap=(0,Tt.b2)(),ap(yh=function(){function e(){(0,ue.Z)(this,e),(0,ve.Z)(this,"moduleCache",{}),(0,ve.Z)(this,"rawContentCache",{})}return(0,_e.Z)(e,[{key:"registerBuiltinModules",value:function(){this.destroy(),this.registerModule("common",{vs:uA,fs:uA}),this.registerModule("decode",{vs:Lm,fs:""}),this.registerModule("scene_uniforms",{vs:Xv,fs:Xv}),this.registerModule("picking_uniforms",{vs:Yv,fs:Yv}),this.registerModule("projection",{vs:_y,fs:_y}),this.registerModule("project",{vs:vT,fs:""}),this.registerModule("sdf_2d",{vs:"",fs:mT}),this.registerModule("lighting",{vs:AT,fs:""}),this.registerModule("light",{vs:Fm,fs:""}),this.registerModule("picking",{vs:dT,fs:pT}),this.registerModule("rotation_2d",{vs:gT,fs:""})}},{key:"registerModule",value:function(r,n){var i=n.vs,a=n.fs,s=n.uniforms,l=n.inject,p=bc(i),m=p.content,T=p.uniforms,R=bc(a),L=R.content,z=R.uniforms;this.rawContentCache[r]={fs:L,inject:l,uniforms:(0,Q.Z)((0,Q.Z)((0,Q.Z)({},T),z),s),vs:m}}},{key:"destroy",value:function(){this.moduleCache={},this.rawContentCache={}}},{key:"getModule",value:function(r){var n=this,i=this.rawContentCache[r].vs,a=this.rawContentCache[r].fs,s=this.rawContentCache[r].inject,l={};s!=null&&s["vs:#decl"]&&(i=(s==null?void 0:s["vs:#decl"])+i,l=bc(s==null?void 0:s["vs:#decl"]).uniforms),s!=null&&s["vs:#main-start"]&&(i=i.replace(yT,function(Ie){return Ie+(s==null?void 0:s["vs:#main-start"])})),s!=null&&s["fs:#decl"]&&(a=(s==null?void 0:s["fs:#decl"])+a);var p=this.processModule(i,[],"vs"),m=p.content,T=p.includeList,R=this.processModule(a,[],"fs"),L=R.content,z=R.includeList,re="",ee=op(T.concat(z).concat(r)).reduce(function(Ie,He){return(0,Q.Z)((0,Q.Z)({},Ie),n.rawContentCache[He].uniforms)},(0,Q.Z)({},l));yy.test(L)||(re=re+Ey),re=re+L;var me="";return yy.test(m)||(me=me+Ey),me=me+m,this.moduleCache[r]={fs:re.trim(),uniforms:ee,vs:me.trim()},this.moduleCache[r]}},{key:"processModule",value:function(r,n,i){var a=this,s=r.replace(_T,function(l,p){var m=p.split(" "),T=m[0].replace(/"/g,"");if(n.indexOf(T)>-1)return"";var R=a.rawContentCache[T][i];n.push(T);var L=a.processModule(R,n,i),z=L.content;return z});return{content:s,includeList:n}}},{key:"injectDefines",value:function(r){var n=Object.keys(r).reduce(function(i,a){return i+"#define ".concat(a.toUpperCase()," ").concat(r[a],`;
`)},`
`);return n}}]),e}())||yh);function ST(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=(0,le.Z)(e),e!==null););return e}function Eh(){return typeof Reflect!="undefined"&&Reflect.get?Eh=Reflect.get.bind():Eh=function(t,r,n){var i=ST(t,r);if(i){var a=Object.getOwnPropertyDescriptor(i,r);return a.get?a.get.call(arguments.length<3?t:n):a.value}},Eh.apply(this,arguments)}var sp=function(e){return e.Normal="normal",e.PostProcessing="post-processing",e}({}),Sy,xy,$v=(Sy=(0,Tt.b2)(),Sy(xy=function(){function e(){(0,ue.Z)(this,e),(0,ve.Z)(this,"shaderModuleService",void 0),(0,ve.Z)(this,"rendererService",void 0),(0,ve.Z)(this,"cameraService",void 0),(0,ve.Z)(this,"mapService",void 0),(0,ve.Z)(this,"interactionService",void 0),(0,ve.Z)(this,"layerService",void 0),(0,ve.Z)(this,"config",void 0)}return(0,_e.Z)(e,[{key:"getName",value:function(){return""}},{key:"getType",value:function(){return sp.Normal}},{key:"init",value:function(r,n){this.config=n,this.rendererService=r.getContainer().get(xt.IRendererService),this.cameraService=r.getContainer().get(xt.ICameraService),this.mapService=r.getContainer().get(xt.IMapService),this.interactionService=r.getContainer().get(xt.IInteractionService),this.layerService=r.getContainer().get(xt.ILayerService),this.shaderModuleService=r.getContainer().get(xt.IShaderModuleService)}},{key:"render",value:function(r){}}]),e}())||xy),Ty,Cy;function xT(e){var t=TT();return function(){var n=(0,le.Z)(e),i;if(t){var a=(0,le.Z)(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return(0,ze.Z)(this,i)}}function TT(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var CT=(Ty=(0,Tt.b2)(),Ty(Cy=function(e){(0,ke.Z)(r,e);var t=xT(r);function r(){return(0,ue.Z)(this,r),t.apply(this,arguments)}return(0,_e.Z)(r,[{key:"getName",value:function(){return"clear"}},{key:"init",value:function(i,a){Eh((0,le.Z)(r.prototype),"init",this).call(this,i,a)}},{key:"render",value:function(){this.rendererService.clear({color:[0,0,0,0],depth:1,framebuffer:null})}}]),r}($v))||Cy),by,Ry,My,Bm,wy;function bT(e,t){var r=typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=RT(e))||t&&e&&typeof e.length=="number"){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(m){throw m},f:i}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var a=!0,s=!1,l;return{s:function(){r=r.call(e)},n:function(){var m=r.next();return a=m.done,m},e:function(m){s=!0,l=m},f:function(){try{!a&&r.return!=null&&r.return()}finally{if(s)throw l}}}}function RT(e,t){if(e){if(typeof e=="string")return Iy(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Iy(e,t)}}function Iy(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var MT=(by=(0,Tt.b2)(),Ry=(0,Tt.f3)(xt.IPostProcessor),by(My=(Bm=function(){function e(){(0,ue.Z)(this,e),(0,ve.Z)(this,"passes",[]),fa(this,"postProcessor",wy,this),(0,ve.Z)(this,"layer",void 0),(0,ve.Z)(this,"renderFlag",void 0),(0,ve.Z)(this,"width",0),(0,ve.Z)(this,"height",0)}return(0,_e.Z)(e,[{key:"setLayer",value:function(r){this.layer=r}},{key:"setRenderFlag",value:function(r){this.renderFlag=r}},{key:"getRenderFlag",value:function(){return this.renderFlag}},{key:"getPostProcessor",value:function(){return this.postProcessor}},{key:"render",value:function(){var t=(0,hr.Z)(it().mark(function n(){var i,a,s;return it().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:i=bT(this.passes),p.prev=1,i.s();case 3:if((a=i.n()).done){p.next=9;break}return s=a.value,p.next=7,s.render(this.layer);case 7:p.next=3;break;case 9:p.next=14;break;case 11:p.prev=11,p.t0=p.catch(1),i.e(p.t0);case 14:return p.prev=14,i.f(),p.finish(14);case 17:return p.next=19,this.postProcessor.render(this.layer);case 19:case"end":return p.stop()}},n,this,[[1,11,14,17]])}));function r(){return t.apply(this,arguments)}return r}()},{key:"resize",value:function(r,n){(this.width!==r||this.height!==n)&&(this.postProcessor.resize(r,n),this.width=r,this.height=n)}},{key:"add",value:function(r,n){r.getType()===sp.PostProcessing?this.postProcessor.add(r,this.layer,n):(r.init(this.layer,n),this.passes.push(r))}},{key:"insert",value:function(r,n,i){r.init(this.layer,n),this.passes.splice(i,0,r)}},{key:"destroy",value:function(){this.passes.length=0}}]),e}(),wy=Ji(Bm.prototype,"postProcessor",[Ry],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Bm))||My),Py,Oy;function wT(e){var t=IT();return function(){var n=(0,le.Z)(e),i;if(t){var a=(0,le.Z)(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return(0,ze.Z)(this,i)}}function IT(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var PT=(Py=(0,Tt.b2)(),Py(Oy=function(e){(0,ke.Z)(r,e);var t=wT(r);function r(){var n;(0,ue.Z)(this,r);for(var i=arguments.length,a=new Array(i),s=0;s<i;s++)a[s]=arguments[s];return n=t.call.apply(t,[this].concat(a)),(0,ve.Z)((0,St.Z)(n),"pickingFBO",void 0),(0,ve.Z)((0,St.Z)(n),"layer",void 0),(0,ve.Z)((0,St.Z)(n),"width",0),(0,ve.Z)((0,St.Z)(n),"height",0),(0,ve.Z)((0,St.Z)(n),"alreadyInRendering",!1),(0,ve.Z)((0,St.Z)(n),"pickFromPickingFBO",function(l){var p=l.x,m=l.y,T=l.lngLat,R=l.type;if(!(!n.layer.isVisible()||!n.layer.needPick(R))){var L=n.rendererService,z=L.getViewportSize,re=L.readPixels,ee=L.useFramebuffer,me=z(),Ie=me.width,He=me.height,Xe=n.layer.getLayerConfig(),ot=Xe.enableHighlight,pt=Xe.enableSelect,dt=p*ba,It=m*ba;if(!(dt>Ie||dt<0||It>He||It<0)){var Vt;ee(n.pickingFBO,function(){var Kt;if(Vt=re({x:Math.round(dt),y:Math.round(He-(m+1)*ba),width:1,height:1,data:new Uint8Array(1*1*4),framebuffer:n.pickingFBO}),Vt[0]!==0||Vt[1]!==0||Vt[2]!==0){var yr=_o(Vt),_r=n.layer.getSource().getFeatureById(yr),Hr={x:p,y:m,type:R,lngLat:T,featureId:yr,feature:_r};_r&&(n.layer.setCurrentPickId(yr),n.triggerHoverOnLayer(Hr))}else{var nn={x:p,y:m,lngLat:T,type:n.layer.getCurrentPickId()===null?"un"+R:"mouseout",featureId:null,feature:null};n.triggerHoverOnLayer((0,Q.Z)((0,Q.Z)({},nn),{},{type:"unpick"})),n.triggerHoverOnLayer(nn),n.layer.setCurrentPickId(null)}ot&&n.highlightPickedFeature(Vt),pt&&R==="click"&&((Kt=Vt)===null||Kt===void 0?void 0:Kt.toString())!==[0,0,0,0].toString()&&n.selectFeature(Vt)})}}}),n}return(0,_e.Z)(r,[{key:"getType",value:function(){return sp.Normal}},{key:"getName",value:function(){return"pixelPicking"}},{key:"init",value:function(i,a){Eh((0,le.Z)(r.prototype),"init",this).call(this,i,a),this.layer=i;var s=this.rendererService,l=s.createTexture2D,p=s.createFramebuffer,m=s.getViewportSize,T=m(),R=T.width,L=T.height;this.pickingFBO=p({color:l({width:R,height:L,wrapS:Fe.CLAMP_TO_EDGE,wrapT:Fe.CLAMP_TO_EDGE})}),this.interactionService.on(Vs.Hover,this.pickFromPickingFBO),this.interactionService.on(Vs.Select,this.selectFeatureHandle.bind(this)),this.interactionService.on(Vs.Active,this.highlightFeatureHandle.bind(this))}},{key:"render",value:function(i){var a=this;if(!this.alreadyInRendering){var s=this.rendererService,l=s.getViewportSize,p=s.useFramebuffer,m=s.clear,T=l(),R=T.width,L=T.height;this.alreadyInRendering=!0,(this.width!==R||this.height!==L)&&(this.pickingFBO.resize({width:R,height:L}),this.width=R,this.height=L),p(this.pickingFBO,function(){m({framebuffer:a.pickingFBO,color:[0,0,0,0],stencil:0,depth:1});var z=a.layer.multiPassRenderer.getRenderFlag();a.layer.multiPassRenderer.setRenderFlag(!1),i.hooks.beforePickingEncode.call(),i.render(),i.hooks.afterPickingEncode.call(),a.layer.multiPassRenderer.setRenderFlag(z),a.alreadyInRendering=!1})}}},{key:"triggerHoverOnLayer",value:function(i){this.layer.emit(i.type,i)}},{key:"highlightPickedFeature",value:function(i){var a=(0,yn.Z)(i,3),s=a[0],l=a[1],p=a[2];this.layer.hooks.beforeHighlight.call([s,l,p]),this.layerService.renderLayers()}},{key:"selectFeature",value:function(i){var a=(0,yn.Z)(i,3),s=a[0],l=a[1],p=a[2];this.layer.hooks.beforeSelect.call([s,l,p]),this.layerService.renderLayers()}},{key:"selectFeatureHandle",value:function(i){var a=i.featureId,s=Ws(a);this.selectFeature(new Uint8Array(s))}},{key:"highlightFeatureHandle",value:function(i){var a=i.featureId,s=Ws(a);this.highlightPickedFeature(new Uint8Array(s))}}]),r}($v))||Oy),Ny,Dy,Ly,km,Fy,OT=Fn.camelCase,NT=Fn.isNil,DT=Fn.upperFirst,LT=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,Z0=(Ny=(0,Tt.b2)(),Dy=(0,Tt.f3)(xt.IShaderModuleService),Ny(Ly=(km=function(){function e(){(0,ue.Z)(this,e),fa(this,"shaderModuleService",Fy,this),(0,ve.Z)(this,"rendererService",void 0),(0,ve.Z)(this,"config",void 0),(0,ve.Z)(this,"quad",LT),(0,ve.Z)(this,"enabled",!0),(0,ve.Z)(this,"renderToScreen",!1),(0,ve.Z)(this,"model",void 0),(0,ve.Z)(this,"name",void 0),(0,ve.Z)(this,"optionsToUpdate",{})}return(0,_e.Z)(e,[{key:"getName",value:function(){return this.name}},{key:"setName",value:function(r){this.name=r}},{key:"getType",value:function(){return sp.PostProcessing}},{key:"init",value:function(r,n){this.config=n,this.rendererService=r.getContainer().get(xt.IRendererService),this.shaderModuleService=r.getContainer().get(xt.IShaderModuleService);var i=this.rendererService,a=i.createAttribute,s=i.createBuffer,l=i.createModel,p=this.setupShaders(),m=p.vs,T=p.fs,R=p.uniforms;this.model=l({vs:m,fs:T,attributes:{a_Position:a({buffer:s({data:[-4,-4,4,-4,0,4],type:Fe.FLOAT}),size:2})},uniforms:(0,Q.Z)((0,Q.Z)({u_Texture:null},R),this.config&&this.convertOptionsToUniforms(this.config)),depth:{enable:!1},count:3,blend:{enable:this.getName()==="copy"}})}},{key:"render",value:function(r,n){var i=this,a=r.multiPassRenderer.getPostProcessor(),s=this.rendererService,l=s.useFramebuffer,p=s.getViewportSize,m=s.clear,T=p(),R=T.width,L=T.height;l(this.renderToScreen?null:a.getWriteFBO(),function(){m({framebuffer:a.getWriteFBO(),color:[0,0,0,0],depth:1,stencil:0});var z=(0,Q.Z)({u_BloomFinal:0,u_Texture:a.getReadFBO(),u_ViewportSize:[R,L]},i.convertOptionsToUniforms(i.optionsToUpdate));n&&(z.u_BloomFinal=1,z.u_Texture2=n),i.model.draw({uniforms:z})})}},{key:"isEnabled",value:function(){return this.enabled}},{key:"setEnabled",value:function(r){this.enabled=r}},{key:"setRenderToScreen",value:function(r){this.renderToScreen=r}},{key:"updateOptions",value:function(r){this.optionsToUpdate=(0,Q.Z)((0,Q.Z)({},this.optionsToUpdate),r)}},{key:"setupShaders",value:function(){throw new Error("Method not implemented.")}},{key:"convertOptionsToUniforms",value:function(r){var n={};return Object.keys(r).forEach(function(i){NT(r[i])||(n["u_".concat(DT(OT(i)))]=r[i])}),n}}]),e}(),Fy=Ji(km.prototype,"shaderModuleService",[Dy],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),km))||Ly),By,ky;function FT(e){var t=BT();return function(){var n=(0,le.Z)(e),i;if(t){var a=(0,le.Z)(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return(0,ze.Z)(this,i)}}function BT(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var kT=`varying vec2 v_UV;

uniform float u_BloomFinal: 0.0;
uniform sampler2D u_Texture;
uniform sampler2D u_Texture2;

uniform vec2 u_ViewportSize: [1.0, 1.0];
uniform float u_radius: 5.0;
uniform float u_intensity: 0.3;
uniform float u_baseRadio: 0.5;

// https://github.com/Jam3/glsl-fast-gaussian-blur/blob/master/9.glsl
vec4 blur9(sampler2D image, vec2 uv, vec2 resolution, vec2 direction) {
  vec4 color = vec4(0.0);
  vec2 off1 = vec2(1.3846153846) * direction;
  vec2 off2 = vec2(3.2307692308) * direction;
  color += texture2D(image, uv) * 0.2270270270;
  color += texture2D(image, uv + (off1 / resolution)) * 0.3162162162;
  color += texture2D(image, uv - (off1 / resolution)) * 0.3162162162;
  color += texture2D(image, uv + (off2 / resolution)) * 0.0702702703;
  color += texture2D(image, uv - (off2 / resolution)) * 0.0702702703;
  return color;
}

float luminance(vec4 color) {
  return  0.2125 * color.r + 0.7154 * color.g + 0.0721 * color.b;
}

void main() {
  // vec4 baseColor = texture2D(u_Texture, v_UV);

  float r = sqrt(u_radius);

  vec4 c1 = blur9(u_Texture, v_UV, u_ViewportSize, vec2(u_radius, 0.0));
  // c1 *= luminance(c1);
  vec4 c2 = blur9(u_Texture, v_UV, u_ViewportSize, vec2(0.0, u_radius));
  // c2 *= luminance(c2);
  vec4 c3 = blur9(u_Texture, v_UV, u_ViewportSize, vec2(r, r));
  // c3 *= luminance(c3);
  vec4 c4 = blur9(u_Texture, v_UV, u_ViewportSize, vec2(r, -r));
  // c4 *= luminance(c4);
  vec4 inbloomColor = (c1 + c2 + c3 + c4) * 0.25;

  // float lum = luminance(inbloomColor);
  // inbloomColor.rgb *= lum;

  if(u_BloomFinal > 0.0) {
    vec4 baseColor = texture2D(u_Texture2, v_UV);
    float baselum = luminance(baseColor);
    gl_FragColor = mix(inbloomColor, baseColor, u_baseRadio);
    if(baselum <= 0.2) {
      gl_FragColor = inbloomColor * u_intensity;
    }
  } else {
    gl_FragColor = inbloomColor;
  }
}`,UT=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,Um=Fn.isNil,ZT=(By=(0,Tt.b2)(),By(ky=function(e){(0,ke.Z)(r,e);var t=FT(r);function r(){return(0,ue.Z)(this,r),t.apply(this,arguments)}return(0,_e.Z)(r,[{key:"setupShaders",value:function(){this.shaderModuleService.registerModule("blur-pass",{vs:UT,fs:kT});var i=this.shaderModuleService.getModule("blur-pass"),a=i.vs,s=i.fs,l=i.uniforms,p=this.rendererService.getViewportSize(),m=p.width,T=p.height;return{vs:a,fs:s,uniforms:(0,Q.Z)((0,Q.Z)({},l),{},{u_ViewportSize:[m,T]})}}},{key:"convertOptionsToUniforms",value:function(i){var a={};return Um(i.bloomRadius)||(a.u_radius=i.bloomRadius),Um(i.bloomIntensity)||(a.u_intensity=i.bloomIntensity),Um(i.bloomBaseRadio)||(a.u_baseRadio=i.bloomBaseRadio),a}}]),r}(Z0))||ky),Uy,Zy;function zT(e){var t=GT();return function(){var n=(0,le.Z)(e),i;if(t){var a=(0,le.Z)(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return(0,ze.Z)(this,i)}}function GT(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var VT=`varying vec2 v_UV;

uniform sampler2D u_Texture;

uniform vec2 u_ViewportSize: [1.0, 1.0];
uniform vec2 u_BlurDir: [1.0, 0.0];

// https://github.com/Jam3/glsl-fast-gaussian-blur/blob/master/9.glsl
vec4 blur9(sampler2D image, vec2 uv, vec2 resolution, vec2 direction) {
  vec4 color = vec4(0.0);
  vec2 off1 = vec2(1.3846153846) * direction;
  vec2 off2 = vec2(3.2307692308) * direction;
  color += texture2D(image, uv) * 0.2270270270;
  color += texture2D(image, uv + (off1 / resolution)) * 0.3162162162;
  color += texture2D(image, uv - (off1 / resolution)) * 0.3162162162;
  color += texture2D(image, uv + (off2 / resolution)) * 0.0702702703;
  color += texture2D(image, uv - (off2 / resolution)) * 0.0702702703;
  return color;
}

void main() {
  gl_FragColor = blur9(u_Texture, v_UV, u_ViewportSize, u_BlurDir);
}`,HT=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,WT=Fn.isNil,jT=(Uy=(0,Tt.b2)(),Uy(Zy=function(e){(0,ke.Z)(r,e);var t=zT(r);function r(){return(0,ue.Z)(this,r),t.apply(this,arguments)}return(0,_e.Z)(r,[{key:"setupShaders",value:function(){this.shaderModuleService.registerModule("blur-pass",{vs:HT,fs:VT});var i=this.shaderModuleService.getModule("blur-pass"),a=i.vs,s=i.fs,l=i.uniforms,p=this.rendererService.getViewportSize(),m=p.width,T=p.height;return{vs:a,fs:s,uniforms:(0,Q.Z)((0,Q.Z)({},l),{},{u_ViewportSize:[m,T]})}}},{key:"convertOptionsToUniforms",value:function(i){var a={};return WT(i.blurRadius)||(a.u_BlurDir=[i.blurRadius,0]),a}}]),r}(Z0))||Zy),zy,Gy;function XT(e){var t=YT();return function(){var n=(0,le.Z)(e),i;if(t){var a=(0,le.Z)(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return(0,ze.Z)(this,i)}}function YT(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var $T=`varying vec2 v_UV;

uniform sampler2D u_Texture;

uniform vec2 u_ViewportSize: [1.0, 1.0];
uniform vec2 u_BlurDir: [1.0, 0.0];

// https://github.com/Jam3/glsl-fast-gaussian-blur/blob/master/9.glsl
vec4 blur9(sampler2D image, vec2 uv, vec2 resolution, vec2 direction) {
  vec4 color = vec4(0.0);
  vec2 off1 = vec2(1.3846153846) * direction;
  vec2 off2 = vec2(3.2307692308) * direction;
  color += texture2D(image, uv) * 0.2270270270;
  color += texture2D(image, uv + (off1 / resolution)) * 0.3162162162;
  color += texture2D(image, uv - (off1 / resolution)) * 0.3162162162;
  color += texture2D(image, uv + (off2 / resolution)) * 0.0702702703;
  color += texture2D(image, uv - (off2 / resolution)) * 0.0702702703;
  return color;
}

void main() {
  gl_FragColor = blur9(u_Texture, v_UV, u_ViewportSize, u_BlurDir);
}`,QT=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,qT=Fn.isNil,KT=(zy=(0,Tt.b2)(),zy(Gy=function(e){(0,ke.Z)(r,e);var t=XT(r);function r(){return(0,ue.Z)(this,r),t.apply(this,arguments)}return(0,_e.Z)(r,[{key:"setupShaders",value:function(){this.shaderModuleService.registerModule("blur-pass",{vs:QT,fs:$T});var i=this.shaderModuleService.getModule("blur-pass"),a=i.vs,s=i.fs,l=i.uniforms,p=this.rendererService.getViewportSize(),m=p.width,T=p.height;return{vs:a,fs:s,uniforms:(0,Q.Z)((0,Q.Z)({},l),{},{u_ViewportSize:[m,T]})}}},{key:"convertOptionsToUniforms",value:function(i){var a={};return qT(i.blurRadius)||(a.u_BlurDir=[0,i.blurRadius]),a}}]),r}(Z0))||Gy),Vy,Hy;function JT(e){var t=e3();return function(){var n=(0,le.Z)(e),i;if(t){var a=(0,le.Z)(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return(0,ze.Z)(this,i)}}function e3(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var t3=`varying vec2 v_UV;

uniform sampler2D u_Texture;
uniform vec2 u_ViewportSize: [1.0, 1.0];
uniform vec2 u_Center : [0.5, 0.5];
uniform float u_Angle : 0;
uniform float u_Size : 8;

#pragma include "common"

float scale = PI / u_Size;

float pattern(float u_Angle, vec2 texSize, vec2 texCoord) {
  float s = sin(u_Angle), c = cos(u_Angle);
  vec2 tex = texCoord * texSize - u_Center * texSize;
  vec2 point = vec2(
    c * tex.x - s * tex.y,
    s * tex.x + c * tex.y
  ) * scale;
  return (sin(point.x) * sin(point.y)) * 4.0;
}

// https://github.com/evanw/glfx.js/blob/master/src/filters/fun/colorhalftone.js
vec4 colorHalftone_filterColor(vec4 color, vec2 texSize, vec2 texCoord) {
  vec3 cmy = 1.0 - color.rgb;
  float k = min(cmy.x, min(cmy.y, cmy.z));
  cmy = (cmy - k) / (1.0 - k);
  cmy = clamp(
    cmy * 10.0 - 3.0 + vec3(
      pattern(u_Angle + 0.26179, texSize, texCoord),
      pattern(u_Angle + 1.30899, texSize, texCoord),
      pattern(u_Angle, texSize, texCoord)
    ),
    0.0,
    1.0
  );
  k = clamp(k * 10.0 - 5.0 + pattern(u_Angle + 0.78539, texSize, texCoord), 0.0, 1.0);
  return vec4(1.0 - cmy - k, color.a);
}

void main() {
  gl_FragColor = vec4(texture2D(u_Texture, v_UV));
  gl_FragColor = colorHalftone_filterColor(gl_FragColor, u_ViewportSize, v_UV);
}`,r3=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,n3=(Vy=(0,Tt.b2)(),Vy(Hy=function(e){(0,ke.Z)(r,e);var t=JT(r);function r(){return(0,ue.Z)(this,r),t.apply(this,arguments)}return(0,_e.Z)(r,[{key:"setupShaders",value:function(){this.shaderModuleService.registerModule("colorhalftone-pass",{vs:r3,fs:t3});var i=this.shaderModuleService.getModule("colorhalftone-pass"),a=i.vs,s=i.fs,l=i.uniforms,p=this.rendererService.getViewportSize(),m=p.width,T=p.height;return{vs:a,fs:s,uniforms:(0,Q.Z)((0,Q.Z)({},l),{},{u_ViewportSize:[m,T]})}}}]),r}(Z0))||Hy),Wy,jy;function i3(e){var t=a3();return function(){var n=(0,le.Z)(e),i;if(t){var a=(0,le.Z)(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return(0,ze.Z)(this,i)}}function a3(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var o3=`varying vec2 v_UV;

uniform sampler2D u_Texture;

void main() {
  gl_FragColor = vec4(texture2D(u_Texture, v_UV));
}`,s3=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,u3=(Wy=(0,Tt.b2)(),Wy(jy=function(e){(0,ke.Z)(r,e);var t=i3(r);function r(){return(0,ue.Z)(this,r),t.apply(this,arguments)}return(0,_e.Z)(r,[{key:"setupShaders",value:function(){return this.shaderModuleService.registerModule("copy-pass",{vs:s3,fs:o3}),this.shaderModuleService.getModule("copy-pass")}}]),r}(Z0))||jy),Xy,Yy;function l3(e){var t=c3();return function(){var n=(0,le.Z)(e),i;if(t){var a=(0,le.Z)(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return(0,ze.Z)(this,i)}}function c3(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var f3=`varying vec2 v_UV;

uniform sampler2D u_Texture;
uniform vec2 u_ViewportSize: [1.0, 1.0];
uniform vec2 u_Center : [0.5, 0.5];
uniform float u_Scale : 10;

// https://github.com/evanw/glfx.js/blob/master/src/filters/fun/hexagonalpixelate.js
vec4 hexagonalPixelate_sampleColor(sampler2D texture, vec2 texSize, vec2 texCoord) {
  vec2 tex = (texCoord * texSize - u_Center * texSize) / u_Scale;
  tex.y /= 0.866025404;
  tex.x -= tex.y * 0.5;
  vec2 a;
  if (tex.x + tex.y - floor(tex.x) - floor(tex.y) < 1.0) {
    a = vec2(floor(tex.x), floor(tex.y));
  }
  else a = vec2(ceil(tex.x), ceil(tex.y));
  vec2 b = vec2(ceil(tex.x), floor(tex.y));
  vec2 c = vec2(floor(tex.x), ceil(tex.y));
  vec3 TEX = vec3(tex.x, tex.y, 1.0 - tex.x - tex.y);
  vec3 A = vec3(a.x, a.y, 1.0 - a.x - a.y);
  vec3 B = vec3(b.x, b.y, 1.0 - b.x - b.y);
  vec3 C = vec3(c.x, c.y, 1.0 - c.x - c.y);
  float alen = length(TEX - A);
  float blen = length(TEX - B);
  float clen = length(TEX - C);
  vec2 choice;
  if (alen < blen) {
    if (alen < clen) choice = a;
    else choice = c;
  } else {
    if (blen < clen) choice = b;
    else choice = c;
  }
  choice.x += choice.y * 0.5;
  choice.y *= 0.866025404;
  choice *= u_Scale / texSize;
  return texture2D(texture, choice + u_Center);
}

void main() {
  gl_FragColor = vec4(texture2D(u_Texture, v_UV));
  gl_FragColor = hexagonalPixelate_sampleColor(u_Texture, u_ViewportSize, v_UV);
}`,h3=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,A3=(Xy=(0,Tt.b2)(),Xy(Yy=function(e){(0,ke.Z)(r,e);var t=l3(r);function r(){return(0,ue.Z)(this,r),t.apply(this,arguments)}return(0,_e.Z)(r,[{key:"setupShaders",value:function(){this.shaderModuleService.registerModule("hexagonalpixelate-pass",{vs:h3,fs:f3});var i=this.shaderModuleService.getModule("hexagonalpixelate-pass"),a=i.vs,s=i.fs,l=i.uniforms,p=this.rendererService.getViewportSize(),m=p.width,T=p.height;return{vs:a,fs:s,uniforms:(0,Q.Z)((0,Q.Z)({},l),{},{u_ViewportSize:[m,T]})}}}]),r}(Z0))||Yy),$y,Qy;function p3(e){var t=v3();return function(){var n=(0,le.Z)(e),i;if(t){var a=(0,le.Z)(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return(0,ze.Z)(this,i)}}function v3(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var g3=`varying vec2 v_UV;

uniform sampler2D u_Texture;
uniform vec2 u_ViewportSize: [1.0, 1.0];
uniform float u_Strength : 0.6;

vec4 ink_sampleColor(sampler2D texture, vec2 texSize, vec2 texCoord) {
  vec2 dx = vec2(1.0 / texSize.x, 0.0);
  vec2 dy = vec2(0.0, 1.0 / texSize.y);
  vec4 color = texture2D(texture, texCoord);
  float bigTotal = 0.0;
  float smallTotal = 0.0;
  vec3 bigAverage = vec3(0.0);
  vec3 smallAverage = vec3(0.0);
  for (float x = -2.0; x <= 2.0; x += 1.0) {
    for (float y = -2.0; y <= 2.0; y += 1.0) {
      vec3 sample = texture2D(texture, texCoord + dx * x + dy * y).rgb;
      bigAverage += sample;
      bigTotal += 1.0;
      if (abs(x) + abs(y) < 2.0) {
        smallAverage += sample;
        smallTotal += 1.0;
      }
    }
  }
  vec3 edge = max(vec3(0.0), bigAverage / bigTotal - smallAverage / smallTotal);
  float power = u_Strength * u_Strength * u_Strength * u_Strength * u_Strength;
  return vec4(color.rgb - dot(edge, edge) * power * 100000.0, color.a);
}

void main() {
  gl_FragColor = vec4(texture2D(u_Texture, v_UV));
  gl_FragColor = ink_sampleColor(u_Texture, u_ViewportSize, v_UV);
}`,m3=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,_3=($y=(0,Tt.b2)(),$y(Qy=function(e){(0,ke.Z)(r,e);var t=p3(r);function r(){return(0,ue.Z)(this,r),t.apply(this,arguments)}return(0,_e.Z)(r,[{key:"setupShaders",value:function(){this.shaderModuleService.registerModule("ink-pass",{vs:m3,fs:g3});var i=this.shaderModuleService.getModule("ink-pass"),a=i.vs,s=i.fs,l=i.uniforms,p=this.rendererService.getViewportSize(),m=p.width,T=p.height;return{vs:a,fs:s,uniforms:(0,Q.Z)((0,Q.Z)({},l),{},{u_ViewportSize:[m,T]})}}}]),r}(Z0))||Qy),qy,Ky;function y3(e){var t=E3();return function(){var n=(0,le.Z)(e),i;if(t){var a=(0,le.Z)(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return(0,ze.Z)(this,i)}}function E3(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var S3=`varying vec2 v_UV;

uniform sampler2D u_Texture;
uniform float u_Amount : 0.5;

float rand(vec2 co) {
  return fract(sin(dot(co.xy ,vec2(12.9898,78.233))) * 43758.5453);
}

// https://github.com/evanw/glfx.js/blob/master/src/filters/adjust/noise.js
vec4 noise_filterColor(vec4 color, vec2 texCoord) {
  float diff = (rand(texCoord) - 0.5) * u_Amount;
  color.r += diff;
  color.g += diff;
  color.b += diff;
  return color;
}

void main() {
  gl_FragColor = vec4(texture2D(u_Texture, v_UV));
  gl_FragColor = noise_filterColor(gl_FragColor, v_UV);
}`,x3=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,T3=(qy=(0,Tt.b2)(),qy(Ky=function(e){(0,ke.Z)(r,e);var t=y3(r);function r(){return(0,ue.Z)(this,r),t.apply(this,arguments)}return(0,_e.Z)(r,[{key:"setupShaders",value:function(){return this.shaderModuleService.registerModule("noise-pass",{vs:x3,fs:S3}),this.shaderModuleService.getModule("noise-pass")}}]),r}(Z0))||Ky),Jy,e1;function C3(e){var t=b3();return function(){var n=(0,le.Z)(e),i;if(t){var a=(0,le.Z)(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return(0,ze.Z)(this,i)}}function b3(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var R3=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,M3=`varying vec2 v_UV;

uniform sampler2D u_Texture;

uniform float u_Amount : 0.5;

// https://github.com/evanw/glfx.js/blob/master/src/filters/adjust/sepia.js
vec4 sepia_filterColor(vec4 color) {
  float r = color.r;
  float g = color.g;
  float b = color.b;
  color.r =
    min(1.0, (r * (1.0 - (0.607 * u_Amount))) + (g * (0.769 * u_Amount)) + (b * (0.189 * u_Amount)));
  color.g = min(1.0, (r * 0.349 * u_Amount) + (g * (1.0 - (0.314 * u_Amount))) + (b * 0.168 * u_Amount));
  color.b = min(1.0, (r * 0.272 * u_Amount) + (g * 0.534 * u_Amount) + (b * (1.0 - (0.869 * u_Amount))));
  return color;
}

void main() {
  gl_FragColor = vec4(texture2D(u_Texture, v_UV));
  gl_FragColor = sepia_filterColor(gl_FragColor);
}`,w3=(Jy=(0,Tt.b2)(),Jy(e1=function(e){(0,ke.Z)(r,e);var t=C3(r);function r(){return(0,ue.Z)(this,r),t.apply(this,arguments)}return(0,_e.Z)(r,[{key:"setupShaders",value:function(){return this.shaderModuleService.registerModule("sepia-pass",{vs:R3,fs:M3}),this.shaderModuleService.getModule("sepia-pass")}}]),r}(Z0))||e1),t1,r1,n1,i1,up,a1,I3=(t1=(0,Tt.b2)(),r1=(0,Tt.f3)(xt.IRendererService),n1=(0,Tt.zY)(),t1(i1=(up=function(){function e(){(0,ue.Z)(this,e),fa(this,"rendererService",a1,this),(0,ve.Z)(this,"passes",[]),(0,ve.Z)(this,"readFBO",void 0),(0,ve.Z)(this,"writeFBO",void 0)}return(0,_e.Z)(e,[{key:"getReadFBO",value:function(){return this.readFBO}},{key:"getWriteFBO",value:function(){return this.writeFBO}},{key:"getCurrentFBOTex",value:function(){var r=this.rendererService,n=r.getViewportSize,i=r.createTexture2D,a=n(),s=a.width,l=a.height;return i({x:0,y:0,width:s,height:l,copy:!0})}},{key:"getReadFBOTex",value:function(){var r=this,n=this.rendererService.useFramebuffer;return new Promise(function(i){n(r.readFBO,(0,hr.Z)(it().mark(function a(){return it().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:i(r.getCurrentFBOTex());case 1:case"end":return l.stop()}},a)})))})}},{key:"renderBloomPass",value:function(){var t=(0,hr.Z)(it().mark(function n(i,a){var s,l;return it().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return m.next=2,this.getReadFBOTex();case 2:s=m.sent,l=0;case 4:if(!(l<4)){m.next=11;break}return m.next=7,a.render(i,s);case 7:this.swap(),l++,m.next=4;break;case 11:case"end":return m.stop()}},n,this)}));function r(n,i){return t.apply(this,arguments)}return r}()},{key:"render",value:function(){var t=(0,hr.Z)(it().mark(function n(i){var a,s;return it().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:a=0;case 1:if(!(a<this.passes.length)){p.next=15;break}if(s=this.passes[a],s.setRenderToScreen(this.isLastEnabledPass(a)),s.getName()!=="bloom"){p.next=9;break}return p.next=7,this.renderBloomPass(i,s);case 7:p.next=12;break;case 9:return p.next=11,s.render(i);case 11:a!==this.passes.length-1&&this.swap();case 12:a++,p.next=1;break;case 15:case"end":return p.stop()}},n,this)}));function r(n){return t.apply(this,arguments)}return r}()},{key:"resize",value:function(r,n){this.readFBO.resize({width:r,height:n}),this.writeFBO.resize({width:r,height:n})}},{key:"add",value:function(r,n,i){r.init(n,i),this.passes.push(r)}},{key:"insert",value:function(r,n,i,a){r.init(i,a),this.passes.splice(n,0,r)}},{key:"getPostProcessingPassByName",value:function(r){return this.passes.find(function(n){return n.getName()===r})}},{key:"init",value:function(){var r=this.rendererService,n=r.createFramebuffer,i=r.createTexture2D;this.readFBO=n({color:i({width:1,height:1,wrapS:Fe.CLAMP_TO_EDGE,wrapT:Fe.CLAMP_TO_EDGE})}),this.writeFBO=n({color:i({width:1,height:1,wrapS:Fe.CLAMP_TO_EDGE,wrapT:Fe.CLAMP_TO_EDGE})})}},{key:"isLastEnabledPass",value:function(r){for(var n=r+1;n<this.passes.length;n++)if(this.passes[n].isEnabled())return!1;return!0}},{key:"swap",value:function(){var r=this.readFBO;this.readFBO=this.writeFBO,this.writeFBO=r}}]),e}(),a1=Ji(up.prototype,"rendererService",[r1],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ji(up.prototype,"init",[n1],Object.getOwnPropertyDescriptor(up.prototype,"init"),up.prototype),up))||i1),o1,s1;function P3(e){var t=O3();return function(){var n=(0,le.Z)(e),i;if(t){var a=(0,le.Z)(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return(0,ze.Z)(this,i)}}function O3(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var N3=(o1=(0,Tt.b2)(),o1(s1=function(e){(0,ke.Z)(r,e);var t=P3(r);function r(){return(0,ue.Z)(this,r),t.apply(this,arguments)}return(0,_e.Z)(r,[{key:"getType",value:function(){return sp.Normal}},{key:"getName",value:function(){return"render"}},{key:"init",value:function(i,a){Eh((0,le.Z)(r.prototype),"init",this).call(this,i,a)}},{key:"render",value:function(i){var a=this.rendererService,s=a.useFramebuffer,l=a.clear,p=i.multiPassRenderer.getPostProcessor().getReadFBO();s(p,function(){l({color:[0,0,0,0],depth:1,stencil:0,framebuffer:p}),i.multiPassRenderer.setRenderFlag(!1),i.models.forEach(function(m){m.draw({uniforms:i.layerModel.getUninforms()})}),i.multiPassRenderer.setRenderFlag(!0)})}}]),r}($v))||s1),u1,l1,c1,Zm,f1;function D3(e){var t=L3();return function(){var n=(0,le.Z)(e),i;if(t){var a=(0,le.Z)(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return(0,ze.Z)(this,i)}}function L3(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var F3=`uniform float u_opacity : 1.0;
uniform float u_MixRatio : 0.5;

uniform sampler2D u_Diffuse1;
uniform sampler2D u_Diffuse2;

varying vec2 v_UV;

void main() {
  vec4 texel1 = texture2D(u_Diffuse1, v_UV);
  vec4 texel2 = texture2D(u_Diffuse2, v_UV);
  gl_FragColor = u_opacity * mix(texel1, texel2, u_MixRatio);
}
`,h1=`varying vec2 v_UV;

uniform sampler2D u_Texture;

void main() {
  gl_FragColor = vec4(texture2D(u_Texture, v_UV));
}`,B3=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`;function A1(e,t){for(var r=0,n=1/t,i=e;i>0;)r=r+n*(i%t),i=Math.floor(i/t),n=n/t;return r}var k3=1,U3=(u1=(0,Tt.b2)(),l1=(0,Tt.f3)(xt.IShaderModuleService),u1(c1=(Zm=function(e){(0,ke.Z)(r,e);var t=D3(r);function r(){var n;(0,ue.Z)(this,r);for(var i=arguments.length,a=new Array(i),s=0;s<i;s++)a[s]=arguments[s];return n=t.call.apply(t,[this].concat(a)),fa((0,St.Z)(n),"shaderModuleService",f1,(0,St.Z)(n)),(0,ve.Z)((0,St.Z)(n),"haltonSequence",[]),(0,ve.Z)((0,St.Z)(n),"accumulatingId",0),(0,ve.Z)((0,St.Z)(n),"frame",0),(0,ve.Z)((0,St.Z)(n),"timer",void 0),(0,ve.Z)((0,St.Z)(n),"sampleRenderTarget",void 0),(0,ve.Z)((0,St.Z)(n),"prevRenderTarget",void 0),(0,ve.Z)((0,St.Z)(n),"outputRenderTarget",void 0),(0,ve.Z)((0,St.Z)(n),"copyRenderTarget",void 0),(0,ve.Z)((0,St.Z)(n),"blendModel",void 0),(0,ve.Z)((0,St.Z)(n),"outputModel",void 0),(0,ve.Z)((0,St.Z)(n),"copyModel",void 0),n}return(0,_e.Z)(r,[{key:"getType",value:function(){return sp.Normal}},{key:"getName",value:function(){return"taa"}},{key:"init",value:function(i,a){Eh((0,le.Z)(r.prototype),"init",this).call(this,i,a);var s=this.rendererService,l=s.createFramebuffer,p=s.createTexture2D;this.sampleRenderTarget=l({color:p({width:1,height:1,wrapS:Fe.CLAMP_TO_EDGE,wrapT:Fe.CLAMP_TO_EDGE})}),this.prevRenderTarget=l({color:p({width:1,height:1,wrapS:Fe.CLAMP_TO_EDGE,wrapT:Fe.CLAMP_TO_EDGE})}),this.outputRenderTarget=l({color:p({width:1,height:1,wrapS:Fe.CLAMP_TO_EDGE,wrapT:Fe.CLAMP_TO_EDGE})}),this.copyRenderTarget=l({color:p({width:1,height:1,wrapS:Fe.CLAMP_TO_EDGE,wrapT:Fe.CLAMP_TO_EDGE})});for(var m=0;m<30;m++)this.haltonSequence.push([A1(m,2),A1(m,3)]);this.blendModel=this.createTriangleModel("blend-pass",F3),this.outputModel=this.createTriangleModel("copy-pass",h1,{blend:{enable:!0,func:{srcRGB:Fe.ONE,dstRGB:Fe.ONE_MINUS_SRC_ALPHA,srcAlpha:Fe.ONE,dstAlpha:Fe.ONE_MINUS_SRC_ALPHA},equation:{rgb:Fe.FUNC_ADD,alpha:Fe.FUNC_ADD}}}),this.copyModel=this.createTriangleModel("copy-pass",h1)}},{key:"render",value:function(i){var a=this,s=this.rendererService,l=s.clear,p=s.getViewportSize,m=s.useFramebuffer,T=p(),R=T.width,L=T.height;this.sampleRenderTarget.resize({width:R,height:L}),this.prevRenderTarget.resize({width:R,height:L}),this.outputRenderTarget.resize({width:R,height:L}),this.copyRenderTarget.resize({width:R,height:L}),this.resetFrame(),this.stopAccumulating();var z=i.multiPassRenderer.getPostProcessor().getReadFBO();m(z,function(){l({color:[0,0,0,0],depth:1,stencil:0,framebuffer:z}),i.multiPassRenderer.setRenderFlag(!1),i.render(),i.multiPassRenderer.setRenderFlag(!0)});var re=function ee(me){!a.accumulatingId||me!==a.accumulatingId||a.isFinished()||(a.doRender(i),window.requestAnimationFrame(function(){ee(me)}))};this.accumulatingId=k3++,this.timer=window.setTimeout(function(){re(a.accumulatingId)},50)}},{key:"doRender",value:function(i){var a=this,s=this.rendererService,l=s.clear,p=s.getViewportSize,m=s.useFramebuffer,T=p(),R=T.width,L=T.height,z=i.getLayerConfig(),re=z.jitterScale,ee=re===void 0?1:re,me=this.haltonSequence[this.frame%this.haltonSequence.length];this.cameraService.jitterProjectionMatrix((me[0]*2-1)/R*ee,(me[1]*2-1)/L*ee),i.multiPassRenderer.setRenderFlag(!1),i.hooks.beforeRender.call(),m(this.sampleRenderTarget,function(){l({color:[0,0,0,0],depth:1,stencil:0,framebuffer:a.sampleRenderTarget}),i.render()}),i.hooks.afterRender.call(),i.multiPassRenderer.setRenderFlag(!0);var Ie=i.getLayerConfig();m(this.outputRenderTarget,function(){a.blendModel.draw({uniforms:{u_opacity:Ie.opacity||1,u_MixRatio:a.frame===0?1:.9,u_Diffuse1:a.sampleRenderTarget,u_Diffuse2:a.frame===0?i.multiPassRenderer.getPostProcessor().getReadFBO():a.prevRenderTarget}})}),this.frame===0&&l({color:[0,0,0,0],depth:1,stencil:0,framebuffer:this.copyRenderTarget}),this.frame>=1&&(m(this.copyRenderTarget,function(){a.outputModel.draw({uniforms:{u_Texture:a.outputRenderTarget}})}),m(i.multiPassRenderer.getPostProcessor().getReadFBO(),function(){a.copyModel.draw({uniforms:{u_Texture:a.copyRenderTarget}})}),i.multiPassRenderer.getPostProcessor().render(i));var He=this.prevRenderTarget;this.prevRenderTarget=this.outputRenderTarget,this.outputRenderTarget=He,this.frame++,this.cameraService.clearJitterProjectionMatrix()}},{key:"isFinished",value:function(){return this.frame>=this.haltonSequence.length}},{key:"resetFrame",value:function(){this.frame=0}},{key:"stopAccumulating",value:function(){this.accumulatingId=0,window.clearTimeout(this.timer)}},{key:"createTriangleModel",value:function(i,a,s){this.shaderModuleService.registerModule(i,{vs:B3,fs:a});var l=this.shaderModuleService.getModule(i),p=l.vs,m=l.fs,T=l.uniforms,R=this.rendererService,L=R.createAttribute,z=R.createBuffer,re=R.createModel;return re((0,Q.Z)({vs:p,fs:m,attributes:{a_Position:L({buffer:z({data:[-4,-4,4,-4,0,4],type:Fe.FLOAT}),size:2})},uniforms:(0,Q.Z)({},T),depth:{enable:!1},count:3},s))}}]),r}($v),f1=Ji(Zm.prototype,"shaderModuleService",[l1],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Zm))||c1),Ad=new Tt.W2;Ad.bind(xt.IGlobalConfigService).to(nm).inSingletonScope(),(0,Tt.GW)((0,Tt.b2)(),Si.EventEmitter),Ad.bind(xt.IEventEmitter).to(Si.EventEmitter);var p1=(0,Xt.Z)(Ad,!1),zm=function(t){var r=p1.lazyInject(t);return function(n,i,a){r.call(this,n,i),a&&(a.initializer=function(){return n[i]})}},c8=function(t){var r=p1.lazyMultiInject(t);return function(n,i,a){r.call(this,n,i),a&&(a.initializer=function(){return n[i]})}},Rc=Ad,Z3=0;function z3(){var e=new Tt.W2;return e.parent=Ad,e.bind(xt.SceneID).toConstantValue("".concat(Z3++)),e.bind(xt.IShaderModuleService).to(ET).inSingletonScope(),e.bind(xt.ILayerService).to(oy).inSingletonScope(),e.bind(xt.IDebugService).to(Tf).inSingletonScope(),e.bind(xt.ISceneService).to(Tu).inSingletonScope(),e.bind(xt.ICameraService).to(qh).inSingletonScope(),e.bind(xt.ICoordinateSystemService).to(td).inSingletonScope(),e.bind(xt.IInteractionService).to(iy).inSingletonScope(),e.bind(xt.IPickingService).to(ym).inSingletonScope(),e.bind(xt.IControlService).to(iv).inSingletonScope(),e.bind(xt.IMarkerService).to(em).inSingletonScope(),e.bind(xt.IIconService).to(Ei).inSingletonScope(),e.bind(xt.IFontService).to(Sn).inSingletonScope(),e.bind(xt.IPopupService).to(av).inSingletonScope(),e.bind(xt.INormalPass).to(CT).whenTargetNamed("clear"),e.bind(xt.INormalPass).to(PT).whenTargetNamed("pixelPicking"),e.bind(xt.INormalPass).to(N3).whenTargetNamed("render"),e.bind(xt.INormalPass).to(U3).whenTargetNamed("taa"),e.bind(xt.IFactoryNormalPass).toFactory(function(t){return function(r){return t.container.getNamed(xt.INormalPass,r)}}),e.bind(xt.IPostProcessingPass).to(u3).whenTargetNamed("copy"),e.bind(xt.IPostProcessingPass).to(ZT).whenTargetNamed("bloom"),e.bind(xt.IPostProcessingPass).to(jT).whenTargetNamed("blurH"),e.bind(xt.IPostProcessingPass).to(KT).whenTargetNamed("blurV"),e.bind(xt.IPostProcessingPass).to(T3).whenTargetNamed("noise"),e.bind(xt.IPostProcessingPass).to(w3).whenTargetNamed("sepia"),e.bind(xt.IPostProcessingPass).to(n3).whenTargetNamed("colorHalftone"),e.bind(xt.IPostProcessingPass).to(A3).whenTargetNamed("hexagonalPixelate"),e.bind(xt.IPostProcessingPass).to(_3).whenTargetNamed("ink"),e.bind(xt.IFactoryPostProcessingPass).toFactory(function(t){return function(r){var n=t.container.getNamed(xt.IPostProcessingPass,r);return n.setName(r),n}}),e}function pd(e){var t=new Tt.W2;return t.parent=e,t.bind(xt.IStyleAttributeService).to(Pv).inSingletonScope(),t.bind(xt.IMultiPassRenderer).to(MT).inSingletonScope(),t.bind(xt.IPostProcessor).to(I3).inSingletonScope(),t}var G3=null;function f8(e){return G3.indexOf(e)}var d1=Fn.clamp,V3=2,h8=4,H3=64,A8=128,W3=256,j3=512,p8=8192,d8=16384,v8=32768,X3=null,v1=131072,g8=262144,Y3=524288,m8=1048576,$3=2097152,_8=4194304,Q3=8388608,q3=16777216,K3=null;function Qv(e,t){return e=d1(Math.floor(e),0,255),t=d1(Math.floor(t),0,255),256*e+t}function y8(e){var t=e.color,r=e.radius,n=e.tileX,i=e.tileY,a=e.shape,s=e.opacity,l=e.stroke,p=e.strokeWidth,m=e.strokeOpacity,T=[],R=[],L=[],z=[Qv(t[0],t[1]),Qv(t[2],t[3])],re=[Qv(l[0],l[1]),Qv(l[2],l[3])];return[[-1,-1],[1,-1],[1,1],[-1,1]].forEach(function(ee){var me=_slicedToArray(ee,2),Ie=me[0],He=me[1];T.push([].concat(z,[(Ie+1)*Q3+(He+1)*$3+getShapeIndex(a)*v1+r,(n+512)*Y3+(i+512)*H3])),R.push([].concat(re,[p,m])),L.push([s,0,0,0])}),{packedBuffer:T,packedBuffer2:R,packedBuffer3:L}}function E8(e,t){if(e===0&&!t)return 0;if(e===1&&t)return 4294967295;var r=t?1:0,n=Math.floor(e*127);return n*K3+r*q3+n*v1+r*X3+n*j3+r*W3+n*V3+r}var lA={ProjectionMatrix:"u_ProjectionMatrix",ViewMatrix:"u_ViewMatrix",ViewProjectionMatrix:"u_ViewProjectionMatrix",Zoom:"u_Zoom",ZoomScale:"u_ZoomScale",FocalDistance:"u_FocalDistance",CameraPosition:"u_CameraPosition"},du={MapInitStart:"mapInitStart",LayerInitStart:"layerInitStart",LayerInitEnd:"layerInitEnd",SourceInitStart:"sourceInitStart",SourceInitEnd:"sourceInitEnd",ScaleInitStart:"scaleInitStart",ScaleInitEnd:"scaleInitEnd",MappingStart:"mappingStart",MappingEnd:"mappingEnd",BuildModelStart:"buildModelStart",BuildModelEnd:"buildModelEnd"},xo=function(e){return e.LINEAR="linear",e.SEQUENTIAL="sequential",e.POWER="power",e.LOG="log",e.IDENTITY="identity",e.TIME="time",e.QUANTILE="quantile",e.QUANTIZE="quantize",e.THRESHOLD="threshold",e.CAT="cat",e.DIVERGING="diverging",e}({}),lp=function(e){return e.CONSTANT="constant",e.VARIABLE="variable",e}({}),bn=function(e){return e[e.Attribute=0]="Attribute",e[e.InstancedAttribute=1]="InstancedAttribute",e[e.Uniform=2]="Uniform",e}({}),g1=["mapload","mapchange","mapAfterFrameChange"],qv=["loaded","fontloaded","maploaded","resize","destroy","dragstart","dragging","dragend","dragcancel"],ml=function(e){return e.IMAGE="image",e.CUSTOMIMAGE="customImage",e.ARRAYBUFFER="arraybuffer",e.RGB="rgb",e.TERRAINRGB="terrainRGB",e.CUSTOMRGB="customRGB",e.CUSTOMARRAYBUFFER="customArrayBuffer",e.CUSTOMTERRAINRGB="customTerrainRGB",e}({}),J3=function(){var e=(0,hr.Z)(it().mark(function t(r,n,i,a){return it().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.abrupt("return",new Promise(function(p,m){n({x:r.x,y:r.y,z:r.z},function(T,R){if(T||R.length===0){m(T);return}R&&si([{data:R,bands:[0]}],i,a,function(L,z){L?m(L):z&&p(z)})})}));case 1:case"end":return l.stop()}},t)}));return function(r,n,i,a){return e.apply(this,arguments)}}(),eC=function(){var e=(0,hr.Z)(it().mark(function t(r,n){return it().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",new Promise(function(s,l){n({x:r.x,y:r.y,z:r.z},function(p,m){if(p||!m){l(p);return}m instanceof ArrayBuffer?vt(m,function(T,R){T&&l(T),s(R)}):m instanceof HTMLImageElement?s(m):l(p)})}));case 1:case"end":return a.stop()}},t)}));return function(r,n){return e.apply(this,arguments)}}();function tC(e,t){return Array.isArray(e)?typeof e[0]=="string"?e.map(function(r){return Kl(r,t)}):e.map(function(r){return{url:Kl(r.url,t),bands:r.bands||[0]}}):Kl(e,t)}function rC(e){return typeof e=="string"?[{url:e,bands:[0]}]:typeof e[0]=="string"?e.map(function(t){return{url:t,bands:[0]}}):e}function m1(e,t){e.xhrCancel=function(){t.map(function(r){r.abort()})}}var nC=function(){var e=(0,hr.Z)(it().mark(function t(r,n,i,a,s){var l,p,m,T,R,L;return it().wrap(function(re){for(;;)switch(re.prev=re.next){case 0:if(l=rC(n.url),!(l.length>1)){re.next=15;break}return re.next=4,iC(l,n);case 4:if(p=re.sent,m=p.rasterFiles,T=p.xhrList,R=p.errList,m1(r,T),!(R.length>0)){re.next=12;break}return i(R,null),re.abrupt("return");case 12:si(m,a,s,i),re.next=17;break;case 15:L=ln(n,function(ee,me){if(ee)i(ee);else if(me){var Ie=[{data:me,bands:l[0].bands}];si(Ie,a,s,i)}}),m1(r,[L]);case 17:case"end":return re.stop()}},t)}));return function(r,n,i,a,s){return e.apply(this,arguments)}}();function iC(e,t){return Gm.apply(this,arguments)}function Gm(){return Gm=(0,hr.Z)(it().mark(function e(t,r){var n,i,a,s,l,p,m,T,R,L,z;return it().wrap(function(ee){for(;;)switch(ee.prev=ee.next){case 0:n=[],i=[],a=[],s=0;case 4:if(!(s<t.length)){ee.next=20;break}return l=t[s],p=(0,Q.Z)((0,Q.Z)({},r),{},{url:l.url}),m=l.bands,ee.next=10,li((0,Q.Z)((0,Q.Z)({},p),{},{type:"arrayBuffer"}));case 10:T=ee.sent,R=T.err,L=T.data,z=T.xhr,R&&a.push(R),i.push(z),n.push({data:L,bands:m});case 17:s++,ee.next=4;break;case 20:return ee.abrupt("return",{rasterFiles:n,xhrList:i,errList:a});case 21:case"end":return ee.stop()}},e)})),Gm.apply(this,arguments)}var aC=function(){var e=(0,hr.Z)(it().mark(function t(r,n,i,a,s){var l;return it().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return l={url:tC(r,n)},m.abrupt("return",new Promise(function(T,R){nC(i,l,function(L,z){L?R(L):z&&T(z)},a,s)}));case 2:case"end":return m.stop()}},t)}));return function(r,n,i,a,s){return e.apply(this,arguments)}}(),_1=function(){var e=(0,hr.Z)(it().mark(function t(r,n,i,a){var s,l,p,m;return it().wrap(function(R){for(;;)switch(R.prev=R.next){case 0:return l=Array.isArray(r)?r[0]:r,a.wmtsOptions?(p=(a==null?void 0:a.getURLFromTemplate)||zs,s=p(l,(0,Q.Z)((0,Q.Z)({},n),a.wmtsOptions))):(m=(a==null?void 0:a.getURLFromTemplate)||Kl,s=m(l,n)),R.abrupt("return",new Promise(function(L,z){var re,ee=Qe({url:s,type:(a==null||(re=a.requestParameters)===null||re===void 0?void 0:re.type)||"arrayBuffer"},function(me,Ie){me?z(me):Ie&&L(Ie)},a.transformResponse);i.xhrCancel=function(){return ee.cancel()}}));case 3:case"end":return R.stop()}},t)}));return function(r,n,i,a){return e.apply(this,arguments)}}(),y1=function(){return{rasterData:new Uint8Array([0]),width:1,height:1}},oC={tileSize:256,minZoom:0,maxZoom:1/0,zoomOffset:0,warp:!0},S8=[ml.ARRAYBUFFER,ml.RGB];function sC(e){return!!(Array.isArray(e)&&e.length===0||!Array.isArray(e)&&typeof e!="string")}function uC(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(sC(e))throw new Error("tile server url is error");var r=(t==null?void 0:t.dataType)||ml.IMAGE;r===ml.RGB&&(r=ml.ARRAYBUFFER);var n=function(s,l){switch(r){case ml.IMAGE:return _1(e,s,l,t);case ml.CUSTOMIMAGE:case ml.CUSTOMTERRAINRGB:return eC(l,t==null?void 0:t.getCustomData);case ml.ARRAYBUFFER:return aC(e,s,l,(t==null?void 0:t.format)||y1,t==null?void 0:t.operation);case ml.CUSTOMARRAYBUFFER:case ml.CUSTOMRGB:return J3(l,t==null?void 0:t.getCustomData,(t==null?void 0:t.format)||y1,t==null?void 0:t.operation);default:return _1(e,s,l,t)}},i=(0,Q.Z)((0,Q.Z)((0,Q.Z)({},oC),t),{},{getTileData:n});return{data:e,dataArray:[],tilesetOptions:i,isTile:!0}}var lC=["extent","min","max","width","height","format","operation"];function cC(e,t){var r=t.extent,n=t.min,i=t.max,a=t.width,s=t.height,l=t.format,p=t.operation,m=(0,Cc.Z)(t,lC),T;if(l===void 0||Po(e))T=Array.from(e);else{var R=Array.isArray(e)?e:[e];T=to(R,l,p)}var L={_id:1,dataArray:[(0,Q.Z)((0,Q.Z)({_id:1,data:T,width:a,height:s},m),{},{min:n,max:i,coordinates:[[r[0],r[1]],[r[2],r[3]]]})]};return L}var fC={tileSize:256,minZoom:0,maxZoom:1/0,zoomOffset:0},hC=function(){var e=(0,hr.Z)(it().mark(function t(r){return it().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.abrupt("return",new Promise(function(a){var s=(0,yn.Z)(r.bounds,4),l=s[0],p=s[1],m=s[2],T=s[3],R={layers:{testTile:{features:[{type:"Feature",properties:{key:r.x+"/"+r.y+"/"+r.z,x:(l+m)/2,y:(p+T)/2},geometry:{type:"LineString",coordinates:[[m,T],[m,p],[l,p],[l,p]]}}]}}};a(R)}));case 1:case"end":return i.stop()}},t)}));return function(r){return e.apply(this,arguments)}}();function AC(e,t){var r=function(a){return hC(a)},n=(0,Q.Z)((0,Q.Z)((0,Q.Z)({},fC),t),{},{getTileData:r});return{data:e,dataArray:[],tilesetOptions:n,isTile:!0}}var pC=C(77028),E1=C.n(pC);function S1(e,t){var r=t.radius,n=r===void 0?40:r,i=t.maxZoom,a=i===void 0?18:i,s=t.minZoom,l=s===void 0?0:s,p=t.zoom,m=p===void 0?2:p;if(e.pointIndex){var T=e.pointIndex.getClusters(e.extent,Math.floor(m));return e.dataArray=dC(T),e}var R=new(E1())({radius:n,minZoom:l,maxZoom:a}),L={type:"FeatureCollection",features:[]};return L.features=e.dataArray.map(function(z){return{type:"Feature",geometry:{type:"Point",coordinates:z.coordinates},properties:(0,Q.Z)({},z)}}),R.load(L.features),R}function dC(e){return e.map(function(t,r){return(0,Q.Z)({coordinates:t.geometry.coordinates,_id:r+1},t.properties)})}function vC(e){if(e.length===0)throw new Error("max requires at least one data point");for(var t=e[0],r=1;r<e.length;r++)e[r]>t&&(t=e[r]);return t}function gC(e){if(e.length===0)throw new Error("min requires at least one data point");for(var t=e[0],r=1;r<e.length;r++)e[r]<t&&(t=e[r]);return t}function x1(e){if(e.length===0)return 0;for(var t=e[0],r=0,n,i=1;i<e.length;i++)n=t+e[i]*1,Math.abs(t)>=Math.abs(e[i])?r+=t-n+e[i]:r+=e[i]-n+t,t=n;return t+r*1}function mC(e){if(e.length===0)throw new Error("mean requires at least one data point");return x1(e)/e.length}var _C={min:gC,max:vC,mean:mC,sum:x1};function yC(e){var t=EC();return function(){var n=(0,le.Z)(e),i;if(t){var a=(0,le.Z)(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return(0,ze.Z)(this,i)}}function EC(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var SC=Fn.cloneDeep,T1=Fn.isFunction,xC=Fn.isString,TC=Fn.mergeWith;function CC(e,t){if(Array.isArray(t))return t}var bC=function(e){(0,ke.Z)(r,e);var t=yC(r);function r(n,i){var a;return(0,ue.Z)(this,r),a=t.call(this),(0,ve.Z)((0,St.Z)(a),"type","source"),(0,ve.Z)((0,St.Z)(a),"isTile",!1),(0,ve.Z)((0,St.Z)(a),"inited",!1),(0,ve.Z)((0,St.Z)(a),"hooks",{init:new Hf}),(0,ve.Z)((0,St.Z)(a),"parser",{type:"geojson"}),(0,ve.Z)((0,St.Z)(a),"transforms",[]),(0,ve.Z)((0,St.Z)(a),"cluster",!1),(0,ve.Z)((0,St.Z)(a),"clusterOptions",{enable:!1,radius:40,maxZoom:20,zoom:-99,method:"count"}),(0,ve.Z)((0,St.Z)(a),"invalidExtent",!1),(0,ve.Z)((0,St.Z)(a),"dataArrayChanged",!1),(0,ve.Z)((0,St.Z)(a),"cfg",{autoRender:!0}),a.originData=n,a.initCfg(i),a.init().then(function(){a.inited=!0,a.emit("update",{type:"inited"})}),a}return(0,_e.Z)(r,[{key:"getSourceCfg",value:function(){return this.cfg}},{key:"getClusters",value:function(i){return this.clusterIndex.getClusters(this.caculClusterExtent(2),i)}},{key:"getClustersLeaves",value:function(i){return this.clusterIndex.getLeaves(i,1/0)}},{key:"getParserType",value:function(){return this.parser.type}},{key:"updateClusterData",value:function(i){var a=this,s=this.clusterOptions,l=s.method,p=l===void 0?"sum":l,m=s.field,T=this.clusterIndex.getClusters(this.caculClusterExtent(2),Math.floor(i));this.clusterOptions.zoom=i,T.forEach(function(R){R.id||(R.properties.point_count=1)}),(m||T1(p))&&(T=T.map(function(R){var L=R.id;if(L){var z=a.clusterIndex.getLeaves(L,1/0),re=z.map(function(Ie){return Ie.properties}),ee;if(xC(p)&&m){var me=I0(re,m);ee=_C[p](me)}T1(p)&&(ee=p(re)),R.properties.stat=ee}else R.properties.point_count=1;return R})),this.data=B("geojson")({type:"FeatureCollection",features:T}),this.executeTrans()}},{key:"getFeatureById",value:function(i){var a=this.parser,s=a.type,l=s===void 0?"geojson":s,p=a.geometry;if(l==="geojson"&&!this.cluster){var m=i<this.originData.features.length?this.originData.features[i]:"null",T=SC(m);if(T!=null&&T.properties&&(this.transforms.length!==0||this.dataArrayChanged)){var R=this.data.dataArray.find(function(L){return L._id===i});T.properties=R}return T}else return l==="json"&&p?this.data.dataArray.find(function(L){return L._id===i}):i<this.data.dataArray.length?this.data.dataArray[i]:"null"}},{key:"updateFeaturePropertiesById",value:function(i,a){this.data.dataArray=this.data.dataArray.map(function(s){return s._id===i?(0,Q.Z)((0,Q.Z)({},s),a):s}),this.dataArrayChanged=!0,this.emit("update",{type:"update"})}},{key:"getFeatureId",value:function(i,a){var s=this.data.dataArray.find(function(l){return l[i]===a});return s==null?void 0:s._id}},{key:"setData",value:function(i,a){var s=this;this.originData=i,this.dataArrayChanged=!1,this.initCfg(a),this.init().then(function(){s.emit("update",{type:"update"})})}},{key:"reloadAllTile",value:function(){var i;(i=this.tileset)===null||i===void 0||i.reloadAll()}},{key:"reloadTilebyId",value:function(i,a,s){var l;(l=this.tileset)===null||l===void 0||l.reloadTileById(i,a,s)}},{key:"reloadTileByLnglat",value:function(i,a,s){var l;(l=this.tileset)===null||l===void 0||l.reloadTileByLnglat(i,a,s)}},{key:"getTileExtent",value:function(i,a){var s;return(s=this.tileset)===null||s===void 0?void 0:s.getTileExtent(i,a)}},{key:"getTileByZXY",value:function(i,a,s){var l;return(l=this.tileset)===null||l===void 0?void 0:l.getTileByZXY(i,a,s)}},{key:"reloadTileByExtent",value:function(i,a){var s;(s=this.tileset)===null||s===void 0||s.reloadTileByExtent(i,a)}},{key:"destroy",value:function(){var i;this.removeAllListeners(),this.originData=null,this.clusterIndex=null,this.data=null,(i=this.tileset)===null||i===void 0||i.destroy()}},{key:"processData",value:function(){var n=(0,hr.Z)(it().mark(function a(){var s=this;return it().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return p.abrupt("return",new Promise(function(m,T){try{s.excuteParser(),s.initCluster(),s.executeTrans(),m({})}catch(R){T(R)}}));case 1:case"end":return p.stop()}},a)}));function i(){return n.apply(this,arguments)}return i}()},{key:"initCfg",value:function(i){this.cfg=TC(this.cfg,i,CC);var a=this.cfg;a&&(a.parser&&(this.parser=a.parser),a.transforms&&(this.transforms=a.transforms),this.cluster=a.cluster||!1,a.clusterOptions&&(this.cluster=!0,this.clusterOptions=(0,Q.Z)((0,Q.Z)({},this.clusterOptions),a.clusterOptions)))}},{key:"init",value:function(){var n=(0,hr.Z)(it().mark(function a(){return it().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return this.inited=!1,l.next=3,this.processData();case 3:this.inited=!0;case 4:case"end":return l.stop()}},a,this)}));function i(){return n.apply(this,arguments)}return i}()},{key:"excuteParser",value:function(){var i=this.parser,a=i.type||"geojson",s=B(a);this.data=s(this.originData,i),this.tileset=this.initTileset(),!i.cancelExtent&&(this.extent=Pu(this.data.dataArray),this.setCenter(this.extent),this.invalidExtent=this.extent[0]===this.extent[2]||this.extent[1]===this.extent[3])}},{key:"setCenter",value:function(i){this.center=[(i[0]+i[2])/2,(i[1]+i[3])/2],(isNaN(this.center[0])||isNaN(this.center[1]))&&(this.center=[108.92361111111111,34.54083333333333])}},{key:"initTileset",value:function(){var i=this.data.tilesetOptions;if(i){if(this.isTile=!0,this.tileset)return this.tileset.updateOptions(i),this.tileset;var a=new Ol((0,Q.Z)({},i));return a}}},{key:"executeTrans",value:function(){var i=this,a=this.transforms;a.forEach(function(s){var l=s.type,p=X(l)(i.data,s);Object.assign(i.data,p)})}},{key:"initCluster",value:function(){if(this.cluster){var i=this.clusterOptions||{};this.clusterIndex=S1(this.data,i)}}},{key:"caculClusterExtent",value:function(i){var a=[[-1/0,-1/0],[1/0,1/0]];return this.invalidExtent||(a=yu(fo(this.extent),i)),a[0].concat(a[1])}}]),r}(Si.EventEmitter);function RC(e,t){var r=t.callback;return r&&(e.dataArray=e.dataArray.filter(r)),e}function C1(e,t){var r=typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=MC(e))||t&&e&&typeof e.length=="number"){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(m){throw m},f:i}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var a=!0,s=!1,l;return{s:function(){r=r.call(e)},n:function(){var m=r.next();return a=m.done,m},e:function(m){s=!0,l=m},f:function(){try{!a&&r.return!=null&&r.return()}finally{if(s)throw l}}}}function MC(e,t){if(e){if(typeof e=="string")return b1(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return b1(e,t)}}function b1(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var Vm=6378e3;function wC(e,t){var r=e.dataArray,n=t.size,i=n===void 0?10:n,a=i/(2*Math.PI*Vm)*(256<<20)/2,s=IC(r,i),l=s.gridHash,p=s.gridOffset,m=DC(l,p,t);return{yOffset:a,xOffset:a,radius:a,type:"grid",dataArray:m}}function IC(e,t){var r=1/0,n=-1/0,i,a=C1(e),s;try{for(a.s();!(s=a.n()).done;){var l=s.value;i=l.coordinates[1],Number.isFinite(i)&&(r=i<r?i:r,n=i>n?i:n)}}catch(Xe){a.e(Xe)}finally{a.f()}var p=(r+n)/2,m=PC(t,p);if(m.xOffset<=0||m.yOffset<=0)return{gridHash:{},gridOffset:m};var T={},R=C1(e),L;try{for(R.s();!(L=R.n()).done;){var z=L.value,re=z.coordinates[1],ee=z.coordinates[0];if(Number.isFinite(re)&&Number.isFinite(ee)){var me=Math.floor((re+90)/m.yOffset),Ie=Math.floor((ee+180)/m.xOffset),He="".concat(me,"-").concat(Ie);T[He]=T[He]||{count:0,points:[]},T[He].count+=1,T[He].points.push(z)}}}catch(Xe){R.e(Xe)}finally{R.f()}return{gridHash:T,gridOffset:m}}function PC(e,t){var r=OC(e),n=NC(t,e);return{yOffset:r,xOffset:n}}function OC(e){return e/Vm*(180/Math.PI)}function NC(e,t){return t/Vm*(180/Math.PI)/Math.cos(e*Math.PI/180)}function DC(e,t,r){return Object.keys(e).reduce(function(n,i,a){var s=i.split("-"),l=parseInt(s[0],10),p=parseInt(s[1],10),m={};if(r.field&&r.method){var T=uf(e[i].points,r.field);m[r.method]=Io[r.method](T)}return Object.assign(m,{_id:a,coordinates:Na([-180+t.xOffset*(p+.5),-90+t.yOffset*(l+.5)]),rawData:e[i].points,count:e[i].count}),n.push(m),n},[])}var cp=Math.PI/3,LC=[0,cp,2*cp,3*cp,4*cp,5*cp];function FC(e){return e[0]}function BC(e){return e[1]}function kC(){var e=0,t=0,r=1,n=1,i=FC,a=BC,s,l,p;function m(R){var L={},z=[],re,ee=R.length;for(re=0;re<ee;++re)if(!(isNaN(Ie=+i.call(null,me=R[re],re,R))||isNaN(He=+a.call(null,me,re,R)))){var me,Ie,He,Xe=Math.round(He=He/p),ot=Math.round(Ie=Ie/l-(Xe&1)/2),pt=He-Xe;if(Math.abs(pt)*3>1){var dt=Ie-ot,It=ot+(Ie<ot?-1:1)/2,Vt=Xe+(He<Xe?-1:1),Kt=Ie-It,yr=He-Vt;dt*dt+pt*pt>Kt*Kt+yr*yr&&(ot=It+(Xe&1?1:-1)/2,Xe=Vt)}var _r=ot+"-"+Xe,Hr=L[_r];Hr?Hr.push(me):(z.push(Hr=L[_r]=[me]),Hr.x=(ot+(Xe&1)/2)*l,Hr.y=Xe*p)}return z}function T(R){var L=0,z=0;return LC.map(function(re){var ee=Math.sin(re)*R,me=-Math.cos(re)*R,Ie=ee-L,He=me-z;return L=ee,z=me,[Ie,He]})}return m.hexagon=function(R){return"m"+T(R==null?s:+R).join("l")+"z"},m.centers=function(){for(var R=[],L=Math.round(t/p),z=Math.round(e/l),re=L*p;re<n+s;re+=p,++L)for(var ee=z*l+(L&1)*l/2;ee<r+l/2;ee+=l)R.push([ee,re]);return R},m.mesh=function(){var R=T(s).slice(0,4).join("l");return m.centers().map(function(L){return"M"+L+"m"+R}).join("")},m.x=function(R){return arguments.length?(i=R,m):i},m.y=function(R){return arguments.length?(a=R,m):a},m.radius=function(R){return arguments.length?(s=+R,l=s*2*Math.sin(cp),p=s*1.5,m):s},m.size=function(R){return arguments.length?(e=t=0,r=+R[0],n=+R[1],m):[r-e,n-t]},m.extent=function(R){return arguments.length?(e=+R[0][0],t=+R[0][1],r=+R[1][0],n=+R[1][1],m):[[e,t],[r,n]]},m.radius(1)}var UC=6378e3;function ZC(e,t){var r=e.dataArray,n=t.size,i=n===void 0?10:n,a=t.method,s=a===void 0?"sum":a,l=i/(2*Math.PI*UC)*(256<<20)/2,p=r.map(function(L){var z=Na(L.coordinates),re=(0,yn.Z)(z,2),ee=re[0],me=re[1];return(0,Q.Z)((0,Q.Z)({},L),{},{coordinates:[ee,me]})}),m=kC().radius(l).x(function(L){return L.coordinates[0]}).y(function(L){return L.coordinates[1]}),T=m(p),R={dataArray:T.map(function(L,z){var re;if(t.field&&s){var ee=uf(L,t.field);L[s]=Io[s](ee)}return re={},(0,ve.Z)(re,t.method,L[s]),(0,ve.Z)(re,"count",L.length),(0,ve.Z)(re,"rawData",L),(0,ve.Z)(re,"coordinates",[L.x,L.y]),(0,ve.Z)(re,"_id",z),re}),radius:l,xOffset:l,yOffset:l,type:"hexagon"};return R}function zC(e,t){var r=t.sourceField,n=t.targetField,i=t.data,a={};return i.forEach(function(s){a[s[r]]=s}),e.dataArray=e.dataArray.map(function(s){var l=s[n];return(0,Q.Z)((0,Q.Z)({},s),a[l])}),e}function GC(e,t){var r=t.callback;return r&&(e.dataArray=e.dataArray.map(r)),e}Z("rasterTile",uC),Z("mvt",Qo),Z("geojsonvt",Tr),Z("testTile",AC),Z("geojson",Al),Z("jsonTile",Di),Z("image",ai),Z("csv",P0),Z("json",s0),Z("raster",pl),Z("rasterRgb",cC),q("cluster",S1),q("filter",RC),q("join",zC),q("map",GC),q("grid",wC),q("hexagon",ZC);var R1=bC;function VC(e){var t=HC();return function(){var n=(0,le.Z)(e),i;if(t){var a=(0,le.Z)(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return(0,ze.Z)(this,i)}}function HC(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var M1=function(e){(0,ke.Z)(r,e);var t=VC(r);function r(n){var i;return(0,ue.Z)(this,r),i=t.call(this),(0,ve.Z)((0,St.Z)(i),"added",!1),(0,ve.Z)((0,St.Z)(i),"eventHandle",function(a){i.polyfillEvent(a),i.emit(a.type,{target:a,data:i.markerOption.extData,lngLat:i.lngLat})}),i.markerOption=(0,Q.Z)((0,Q.Z)({},i.getDefault()),n),Ni(["update","onMove","onMapClick"],(0,St.Z)(i)),i.init(),i}return(0,_e.Z)(r,[{key:"getMarkerLayerContainerSize",value:function(){}},{key:"getDefault",value:function(){return{element:void 0,anchor:Lt.BOTTOM,offsets:[0,0],color:"#5B8FF9",draggable:!1}}},{key:"addTo",value:function(i){this.scene=i,this.mapsService=i.get(xt.IMapService),this.sceneSerive=i.get(xt.ISceneService);var a=this.markerOption.element;return this.mapsService.getMarkerContainer().appendChild(a),this.registerMarkerEvent(a),this.mapsService.on("camerachange",this.update),this.update(),this.added=!0,this.emit("added"),this}},{key:"remove",value:function(){this.mapsService&&(this.mapsService.off("click",this.onMapClick),this.mapsService.off("move",this.update),this.mapsService.off("moveend",this.update),this.mapsService.off("camerachange",this.update)),this.unRegisterMarkerEvent(),this.removeAllListeners();var i=this.markerOption.element;return i&&Is(i),this.popup&&this.popup.remove(),this}},{key:"setLnglat",value:function(i){return this.lngLat=i,Array.isArray(i)&&(this.lngLat={lng:i[0],lat:i[1]}),this.popup&&this.popup.setLnglat(this.lngLat),this.update(),this}},{key:"getLnglat",value:function(){return this.lngLat}},{key:"getElement",value:function(){return this.markerOption.element}},{key:"setElement",value:function(i){var a=this;if(!this.added)return this.once("added",function(){a.setElement(i)}),this;var s=this.markerOption.element;return s&&Is(s),this.markerOption.element=i,this.init(),this.mapsService.getMarkerContainer().appendChild(i),this.registerMarkerEvent(i),this.update(),this}},{key:"openPopup",value:function(){var i=this;if(!this.added)return this.once("added",function(){i.openPopup()}),this;var a=this.popup;return a?(a.isOpen()||a.addTo(this.scene),this):this}},{key:"closePopup",value:function(){var i=this;this.added||this.once("added",function(){i.closePopup()});var a=this.popup;return a&&a.remove(),this}},{key:"setPopup",value:function(i){return this.popup=i,this.lngLat&&this.popup.setLnglat(this.lngLat),this}},{key:"togglePopup",value:function(){var i=this.popup;if(i)i.isOpen()?i.remove():i.addTo(this.scene);else return this;return this}},{key:"getPopup",value:function(){return this.popup}},{key:"getOffset",value:function(){return this.markerOption.offsets}},{key:"setDraggable",value:function(i){throw new Error("Method not implemented.")}},{key:"isDraggable",value:function(){return this.markerOption.draggable}},{key:"getExtData",value:function(){return this.markerOption.extData}},{key:"setExtData",value:function(i){this.markerOption.extData=i}},{key:"update",value:function(){if(this.mapsService){var i=this.markerOption,a=i.element,s=i.anchor;this.updatePosition(),jl(a,"".concat(Pt[s]))}}},{key:"onMapClick",value:function(i){var a=this.markerOption.element;this.popup&&a&&this.togglePopup()}},{key:"getCurrentContainerSize",value:function(){var i=this.mapsService.getContainer();return{containerHeight:(i==null?void 0:i.scrollHeight)||0,containerWidth:(i==null?void 0:i.scrollWidth)||0,bounds:this.mapsService.getBounds()}}},{key:"updatePosition",value:function(){if(this.mapsService){var i=this.markerOption,a=i.element,s=i.offsets,l=this.lngLat,p=l.lng,m=l.lat,T=this.mapsService.lngLatToContainer([p,m]);if(a){a.style.display="block",a.style.whiteSpace="nowrap";var R=this.getMarkerLayerContainerSize()||this.getCurrentContainerSize(),L=R.containerHeight,z=R.containerWidth,re=R.bounds;if(!re)return;if(Math.abs(re[0][0])>180||Math.abs(re[1][0])>180){if(T.x>z){var ee=this.mapsService.lngLatToContainer([p-360,m]);T.x=ee.x}if(T.x<0){var me=this.mapsService.lngLatToContainer([p+360,m]);T.x=me.x}}(T.x>z||T.x<0||T.y>L||T.y<0)&&(a.style.display="none"),a.style.left=T.x+s[0]+"px",a.style.top=T.y-s[1]+"px"}}}},{key:"init",value:function(){var i=this,a=this.markerOption.element,s=this.markerOption,l=s.color,p=s.anchor;if(!a){this.defaultMarker=!0,a=wi("div"),this.markerOption.element=a;var m=document.createElementNS("http://www.w3.org/2000/svg","svg");m.setAttributeNS(null,"display","block"),m.setAttributeNS(null,"height","48px"),m.setAttributeNS(null,"width","48px"),m.setAttributeNS(null,"viewBox","0 0 1024 1024");var T=document.createElementNS("http://www.w3.org/2000/svg","path");T.setAttributeNS(null,"d","M512 490.666667C453.12 490.666667 405.333333 442.88 405.333333 384 405.333333 325.12 453.12 277.333333 512 277.333333 570.88 277.333333 618.666667 325.12 618.666667 384 618.666667 442.88 570.88 490.666667 512 490.666667M512 85.333333C346.88 85.333333 213.333333 218.88 213.333333 384 213.333333 608 512 938.666667 512 938.666667 512 938.666667 810.666667 608 810.666667 384 810.666667 218.88 677.12 85.333333 512 85.333333Z"),T.setAttributeNS(null,"fill",l),m.appendChild(T),a.appendChild(m)}io(a,"l7-marker"),Object.keys(this.markerOption.style||{}).forEach(function(R){var L,z,re=((L=i.markerOption)===null||L===void 0?void 0:L.style)&&((z=i.markerOption)===null||z===void 0?void 0:z.style[R]);a&&(a.style[R]=re)}),Cr(a,p,"marker")}},{key:"registerMarkerEvent",value:function(i){i.addEventListener("click",this.onMapClick),i.addEventListener("mousemove",this.eventHandle),i.addEventListener("click",this.eventHandle),i.addEventListener("mousedown",this.eventHandle),i.addEventListener("mouseup",this.eventHandle),i.addEventListener("dblclick",this.eventHandle),i.addEventListener("contextmenu",this.eventHandle),i.addEventListener("mouseover",this.eventHandle),i.addEventListener("mouseout",this.eventHandle),i.addEventListener("touchstart",this.eventHandle),i.addEventListener("touchend",this.eventHandle)}},{key:"unRegisterMarkerEvent",value:function(){var i=this.getElement();i.removeEventListener("click",this.onMapClick),i.removeEventListener("mousemove",this.eventHandle),i.removeEventListener("click",this.eventHandle),i.removeEventListener("mousedown",this.eventHandle),i.removeEventListener("mouseup",this.eventHandle),i.removeEventListener("dblclick",this.eventHandle),i.removeEventListener("contextmenu",this.eventHandle),i.removeEventListener("mouseover",this.eventHandle),i.removeEventListener("mouseout",this.eventHandle),i.removeEventListener("touchstart",this.eventHandle),i.removeEventListener("touchend",this.eventHandle)}},{key:"polyfillEvent",value:function(i){!this.mapsService||this.mapsService.version!=="GAODE2.x"||Qf()||(i.type==="touchstart"&&(this.touchStartTime=Date.now()),i.type==="touchend"&&Date.now()-this.touchStartTime<300&&this.emit("click",{target:i,data:this.markerOption.extData,lngLat:this.lngLat}))}},{key:"addDragHandler",value:function(i){return null}},{key:"onUp",value:function(i){throw new Error("Method not implemented.")}}]),r}(Si.EventEmitter);function WC(e){var t=jC();return function(){var n=(0,le.Z)(e),i;if(t){var a=(0,le.Z)(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return(0,ze.Z)(this,i)}}function jC(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var XC=Fn.merge,YC=function(e){(0,ke.Z)(r,e);var t=WC(r);function r(n){var i,a;return(0,ue.Z)(this,r),a=t.call(this),(0,ve.Z)((0,St.Z)(a),"markers",[]),(0,ve.Z)((0,St.Z)(a),"points",[]),(0,ve.Z)((0,St.Z)(a),"clusterMarkers",[]),a.markerLayerOption=XC(a.getDefault(),n),Ni(["update"],(0,St.Z)(a)),a.zoom=((i=a.markerLayerOption.clusterOption)===null||i===void 0?void 0:i.zoom)||-99,a}return(0,_e.Z)(r,[{key:"getDefault",value:function(){return{cluster:!1,clusterOption:{radius:80,maxZoom:20,minZoom:0,zoom:-99,style:{},className:""}}}},{key:"addTo",value:function(i){return this.scene=i,this.mapsService=i.get(xt.IMapService),this.markerLayerOption.cluster&&(this.initCluster(),this.update(),this.mapsService.on("camerachange",this.update),this.mapsService.on("viewchange",this.update)),this.mapsService.on("camerachange",this.setContainerSize.bind(this)),this.mapsService.on("viewchange",this.setContainerSize.bind(this)),this.addMarkers(),this.inited=!0,this}},{key:"setContainerSize",value:function(){if(this.mapsService){var i=this.mapsService.getContainer();this.containerSize={containerWidth:(i==null?void 0:i.scrollWidth)||0,containerHeight:(i==null?void 0:i.scrollHeight)||0,bounds:this.mapsService.getBounds()}}}},{key:"getContainerSize",value:function(){return this.containerSize}},{key:"addMarker",value:function(i){var a=this.markerLayerOption.cluster;if(i.getMarkerLayerContainerSize=this.getContainerSize.bind(this),a&&(this.addPoint(i,this.markers.length),this.mapsService)){var s=this.mapsService.getZoom(),l=this.mapsService.getBounds();this.bbox=yu(l,.5),this.zoom=Math.floor(s),this.getClusterMarker(this.bbox,this.zoom)}this.markers.push(i)}},{key:"removeMarker",value:function(i){this.markers.indexOf(i);var a=this.markers.indexOf(i);a>-1&&(this.markers.splice(a,1),this.markerLayerOption.cluster&&(this.removePoint(a),this.mapsService&&this.getClusterMarker(this.bbox,this.zoom)))}},{key:"hide",value:function(){this.markers.map(function(i){i.getElement().style.opacity="0"}),this.clusterMarkers.map(function(i){i.getElement().style.opacity="0"})}},{key:"show",value:function(){this.markers.map(function(i){i.getElement().style.opacity="1"}),this.clusterMarkers.map(function(i){i.getElement().style.opacity="1"})}},{key:"getMarkers",value:function(){var i=this.markerLayerOption.cluster;return i?this.clusterMarkers:this.markers}},{key:"getOriginMarkers",value:function(){return this.markers}},{key:"addMarkers",value:function(){var i=this;this.getMarkers().forEach(function(a){a.addTo(i.scene)})}},{key:"clear",value:function(){this.markers.forEach(function(i){i.remove()}),this.clusterMarkers.forEach(function(i){i.remove()}),this.markers=[],this.points=[],this.clusterMarkers=[]}},{key:"destroy",value:function(){this.clear(),this.removeAllListeners(),this.mapsService.off("camerachange",this.update),this.mapsService.off("viewchange",this.update),this.mapsService.off("camerachange",this.setContainerSize.bind(this)),this.mapsService.off("viewchange",this.setContainerSize.bind(this))}},{key:"addPoint",value:function(i,a){var s=i.getLnglat(),l=s.lng,p=s.lat,m={geometry:{type:"Point",coordinates:[l,p]},properties:(0,Q.Z)((0,Q.Z)({},i.getExtData()),{},{marker_id:a})};this.points.push(m),this.clusterIndex&&this.clusterIndex.load(this.points)}},{key:"removePoint",value:function(i){var a=this.points.findIndex(function(s){return s.properties.marker_id===i});a>-1&&this.points.splice(a,1),this.clusterIndex&&this.clusterIndex.load(this.points)}},{key:"initCluster",value:function(){if(this.markerLayerOption.cluster){var i=this.markerLayerOption.clusterOption,a=i.radius,s=i.minZoom,l=s===void 0?0:s,p=i.maxZoom;this.clusterIndex=new(E1())({radius:a,minZoom:l,maxZoom:p}),this.clusterIndex.load(this.points)}}},{key:"getClusterMarker",value:function(i,a){var s=this,l=i[0].concat(i[1]),p=this.clusterIndex.getClusters(l,a);this.clusterMarkers.forEach(function(m){m.remove()}),this.clusterMarkers=[],p.forEach(function(m){var T,R=s.markerLayerOption.clusterOption,L=R.field,z=R.method;if((T=m.properties)!==null&&T!==void 0&&T.cluster_id){var re,ee=s.getLeaves((re=m.properties)===null||re===void 0?void 0:re.cluster_id);if(m.properties.clusterData=ee,L&&z){var me=ee==null?void 0:ee.map(function(pt){var dt=(0,ve.Z)({},L,pt.properties[L]);return dt}),Ie=uf(me,L),He=po(z,Ie),Xe="point_"+z;m.properties[Xe]=He.toFixed(2)}}var ot=s.clusterMarker(m);s.clusterMarkers.push(ot),ot.addTo(s.scene)})}},{key:"getLeaves",value:function(i){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1/0,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;return i?this.clusterIndex.getLeaves(i,a,s):null}},{key:"clusterMarker",value:function(i){var a=this.markerLayerOption.clusterOption,s=a,l=s.element,p=l===void 0?this.generateElement.bind(this):l,m=new M1({element:p(i)}).setLnglat({lng:i.geometry.coordinates[0],lat:i.geometry.coordinates[1]});return m}},{key:"normalMarker",value:function(i){var a=i.properties.marker_id;return this.markers[a]}},{key:"update",value:function(){if(this.mapsService&&this.markers.length!==0){var i=this.mapsService.getZoom(),a=this.mapsService.getBounds();(!this.bbox||Math.abs(i-this.zoom)>=1||!Gr(this.bbox,a))&&(this.bbox=yu(a,.5),this.zoom=Math.floor(i),this.getClusterMarker(this.bbox,this.zoom))}}},{key:"generateElement",value:function(i){var a=wi("div","l7-marker-cluster"),s=wi("div","",a),l=wi("span","",s),p=this.markerLayerOption.clusterOption,m=p.field,T=p.method;i.properties.point_count=i.properties.point_count||1;var R=m&&T?i.properties["point_"+T]||i.properties[m]:i.properties.point_count;return l.textContent=R,a}}]),r}(Si.EventEmitter),x8=C(73503);function $C(e){var t=QC();return function(){var n=(0,le.Z)(e),i;if(t){var a=(0,le.Z)(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return(0,ze.Z)(this,i)}}function QC(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var w1=function(e){(0,ke.Z)(r,e);var t=$C(r);function r(n){var i;return(0,ue.Z)(this,r),i=t.call(this),r.controlCount++,i.controlOption=(0,Q.Z)((0,Q.Z)({},i.getDefault(n)),n||{}),i}return(0,_e.Z)(r,[{key:"getOptions",value:function(){return this.controlOption}},{key:"setOptions",value:function(i){var a=this.getDefault(i);Object.entries(i).forEach(function(s){var l=(0,yn.Z)(s,2),p=l[0],m=l[1];m===void 0&&(i[p]=a[p])}),"position"in i&&this.setPosition(i.position),"className"in i&&this.setClassName(i.className),"style"in i&&this.setStyle(i.style),this.controlOption=(0,Q.Z)((0,Q.Z)({},this.controlOption),i)}},{key:"addTo",value:function(i){this.mapsService=i.get(xt.IMapService),this.renderService=i.get(xt.IRendererService),this.layerService=i.get(xt.ILayerService),this.controlService=i.get(xt.IControlService),this.configService=i.get(xt.IGlobalConfigService),this.scene=i.get(xt.ISceneService),this.sceneContainer=i,this.isShow=!0,this.container=this.onAdd(),io(this.container,"l7-control");var a=this.controlOption,s=a.className,l=a.style;return s&&this.setClassName(s),l&&this.setStyle(l),this.insertContainer(),this.emit("add",this),this}},{key:"remove",value:function(){if(!this.mapsService)return this;Is(this.container),this.onRemove(),this.emit("remove",this)}},{key:"onAdd",value:function(){return wi("div")}},{key:"onRemove",value:function(){}},{key:"show",value:function(){var i=this.container;Ya(i,"l7-control--hide"),this.isShow=!0,this.emit("show",this)}},{key:"hide",value:function(){var i=this.container;io(i,"l7-control--hide"),this.isShow=!1,this.emit("hide",this)}},{key:"getDefault",value:function(i){return{position:Kh.TOPRIGHT,name:"".concat(r.controlCount)}}},{key:"getContainer",value:function(){return this.container}},{key:"getIsShow",value:function(){return this.isShow}},{key:"_refocusOnMap",value:function(i){if(this.mapsService&&i&&i.screenX>0&&i.screenY>0){var a=this.mapsService.getContainer();a!==null&&a.focus()}}},{key:"setPosition",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Kh.TOPLEFT,a=this.controlService;return a&&a.removeControl(this),this.controlOption.position=i,a&&a.addControl(this,this.sceneContainer),this}},{key:"setClassName",value:function(i){var a=this.container,s=this.controlOption.className;s&&Ya(a,s),i&&io(a,i)}},{key:"setStyle",value:function(i){var a=this.container;i?a.setAttribute("style",i):a.removeAttribute("style")}},{key:"insertContainer",value:function(){var i=this.controlOption.position,a=this.container;if(i instanceof Element)i.appendChild(a);else{var s=this.controlService.controlCorners[i];["bottomleft","bottomright","righttop","rightbottom"].includes(i)?s.insertBefore(a,s.firstChild):s.appendChild(a)}}},{key:"checkUpdateOption",value:function(i,a){return a.some(function(s){return s in i})}}]),r}(cl());(0,ve.Z)(w1,"controlCount",0);function T8(e){var t=qC();return function(){var n=_getPrototypeOf(e),i;if(t){var a=_getPrototypeOf(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return _possibleConstructorReturn(this,i)}}function qC(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var C8=null;function KC(e){var t=JC();return function(){var n=(0,le.Z)(e),i;if(t){var a=(0,le.Z)(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return(0,ze.Z)(this,i)}}function JC(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var eb=function(e){(0,ke.Z)(r,e);var t=KC(r);function r(n,i){var a;return(0,ue.Z)(this,r),a=t.call(this),(0,ve.Z)((0,St.Z)(a),"isShow",!1),(0,ve.Z)((0,St.Z)(a),"timeout",null),(0,ve.Z)((0,St.Z)(a),"show",function(){return a.isShow||!a.contentDOM.innerHTML||(a.resetPopperPosition(),Ya(a.popperDOM,"l7-popper-hide"),a.isShow=!0,a.option.unique&&r.conflictPopperList.forEach(function(s){s!==(0,St.Z)(a)&&s.isShow&&s.hide()}),a.emit("show"),window.addEventListener("pointerdown",a.onPopperUnClick)),(0,St.Z)(a)}),(0,ve.Z)((0,St.Z)(a),"hide",function(){return a.isShow&&(io(a.popperDOM,"l7-popper-hide"),a.isShow=!1,a.emit("hide"),window.removeEventListener("pointerdown",a.onPopperUnClick)),(0,St.Z)(a)}),(0,ve.Z)((0,St.Z)(a),"setHideTimeout",function(){a.timeout||(a.timeout=window.setTimeout(function(){a.isShow&&(a.hide(),a.timeout=null)},300))}),(0,ve.Z)((0,St.Z)(a),"clearHideTimeout",function(){a.timeout&&(window.clearTimeout(a.timeout),a.timeout=null)}),(0,ve.Z)((0,St.Z)(a),"onBtnClick",function(){a.isShow?a.hide():a.show()}),(0,ve.Z)((0,St.Z)(a),"onPopperUnClick",function(s){Fc(s.target,[".l7-button-control",".l7-popper-content"])||a.hide()}),(0,ve.Z)((0,St.Z)(a),"onBtnMouseLeave",function(){a.setHideTimeout()}),(0,ve.Z)((0,St.Z)(a),"onBtnMouseMove",function(){a.clearHideTimeout(),!a.isShow&&a.show()}),a.button=n,a.option=i,a.init(),i.unique&&r.conflictPopperList.push((0,St.Z)(a)),a}return(0,_e.Z)(r,[{key:"buttonRect",get:function(){return this.button.getBoundingClientRect()}},{key:"getPopperDOM",value:function(){return this.popperDOM}},{key:"getIsShow",value:function(){return this.isShow}},{key:"getContent",value:function(){return this.content}},{key:"setContent",value:function(i){typeof i=="string"?this.contentDOM.innerHTML=i:i instanceof HTMLElement&&(is(this.contentDOM),this.contentDOM.appendChild(i)),this.content=i}},{key:"init",value:function(){var i=this.option.trigger;this.popperDOM=this.createPopper(),i==="click"?this.button.addEventListener("click",this.onBtnClick):(this.button.addEventListener("mousemove",this.onBtnMouseMove),this.button.addEventListener("mouseleave",this.onBtnMouseLeave),this.popperDOM.addEventListener("mousemove",this.onBtnMouseMove),this.popperDOM.addEventListener("mouseleave",this.onBtnMouseLeave))}},{key:"destroy",value:function(){this.button.removeEventListener("click",this.onBtnClick),this.button.removeEventListener("mousemove",this.onBtnMouseMove),this.button.removeEventListener("mousemove",this.onBtnMouseLeave),this.popperDOM.removeEventListener("mousemove",this.onBtnMouseMove),this.popperDOM.removeEventListener("mouseleave",this.onBtnMouseLeave),Is(this.popperDOM)}},{key:"resetPopperPosition",value:function(){var i={},a=this.option,s=a.container,l=a.offset,p=l===void 0?[0,0]:l,m=a.placement,T=(0,yn.Z)(p,2),R=T[0],L=T[1],z=this.button.getBoundingClientRect(),re=s.getBoundingClientRect(),ee=wl(z,re),me=ee.left,Ie=ee.right,He=ee.top,Xe=ee.bottom,ot=!1,pt=!1;/^(left|right)/.test(m)?(m.includes("left")?i.right="".concat(z.width+Ie,"px"):m.includes("right")&&(i.left="".concat(z.width+me,"px")),m.includes("start")?i.top="".concat(He,"px"):m.includes("end")?i.bottom="".concat(Xe,"px"):(i.top="".concat(He+z.height/2,"px"),pt=!0,i.transform="translate(".concat(R,"px, calc(").concat(L,"px - 50%))"))):/^(top|bottom)/.test(m)&&(m.includes("top")?i.bottom="".concat(z.height+Xe,"px"):m.includes("bottom")&&(i.top="".concat(z.height+He,"px")),m.includes("start")?i.left="".concat(me,"px"):m.includes("end")?i.right="".concat(Ie,"px"):(i.left="".concat(me+z.width/2,"px"),ot=!0,i.transform="translate(calc(".concat(R,"px - 50%), ").concat(L,"px)"))),i.transform="translate(calc(".concat(R,"px - ").concat(ot?"50%":"0%","), calc(").concat(L,"px - ").concat(pt?"50%":"0%",")");var dt=m.split("-");dt.length&&io(this.popperDOM,dt.map(function(It){return"l7-popper-".concat(It)}).join(" ")),gs(this.popperDOM,On(i))}},{key:"createPopper",value:function(){var i=this.option,a=i.container,s=i.className,l=s===void 0?"":s,p=i.content,m=wi("div","l7-popper l7-popper-hide ".concat(l)),T=wi("div","l7-popper-content"),R=wi("div","l7-popper-arrow");return m.appendChild(T),m.appendChild(R),a.appendChild(m),this.popperDOM=m,this.contentDOM=T,p&&this.setContent(p),m}}]),r}(Si.EventEmitter);(0,ve.Z)(eb,"conflictPopperList",[]);function b8(e){var t=tb();return function(){var n=_getPrototypeOf(e),i;if(t){var a=_getPrototypeOf(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return _possibleConstructorReturn(this,i)}}function tb(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var R8={topleft:"right-start",topcenter:"bottom",topright:"left-start",bottomleft:"right-end",bottomcenter:"top",bottomright:"left-end",lefttop:"bottom-start",leftcenter:"right",leftbottom:"top-start",righttop:"bottom-end",rightcenter:"left",rightbottom:"top-end"},M8=null;function w8(e){var t=rb();return function(){var n=_getPrototypeOf(e),i;if(t){var a=_getPrototypeOf(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return _possibleConstructorReturn(this,i)}}function rb(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var nb=function(e){return e.ActiveOptionClassName="l7-select-control-item-active",e.OptionValueAttrKey="data-option-value",e.OptionIndexAttrKey="data-option-index",e}(nb||{}),I8=null,P8=function(t){var r=document.createElementNS("http://www.w3.org/2000/svg","svg");r.classList.add("l7-iconfont"),r.setAttribute("aria-hidden","true");var n=document.createElementNS("http://www.w3.org/2000/svg","use");return n.setAttributeNS("http://www.w3.org/1999/xlink","href","#".concat(t)),r.appendChild(n),r};function O8(e){var t=ib();return function(){var n=_getPrototypeOf(e),i;if(t){var a=_getPrototypeOf(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return _possibleConstructorReturn(this,i)}}function ib(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var N8=null;function ab(e,t){var r=typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=ob(e))||t&&e&&typeof e.length=="number"){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(m){throw m},f:i}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var a=!0,s=!1,l;return{s:function(){r=r.call(e)},n:function(){var m=r.next();return a=m.done,m},e:function(m){s=!0,l=m},f:function(){try{!a&&r.return!=null&&r.return()}finally{if(s)throw l}}}}function ob(e,t){if(e){if(typeof e=="string")return I1(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return I1(e,t)}}function I1(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var P1=[["requestFullscreen","exitFullscreen","fullscreenElement","fullscreenEnabled","fullscreenchange","fullscreenerror"],["webkitRequestFullscreen","webkitExitFullscreen","webkitFullscreenElement","webkitFullscreenEnabled","webkitfullscreenchange","webkitfullscreenerror"],["webkitRequestFullScreen","webkitCancelFullScreen","webkitCurrentFullScreenElement","webkitCancelFullScreen","webkitfullscreenchange","webkitfullscreenerror"],["mozRequestFullScreen","mozCancelFullScreen","mozFullScreenElement","mozFullScreenEnabled","mozfullscreenchange","mozfullscreenerror"],["msRequestFullscreen","msExitFullscreen","msFullscreenElement","msFullscreenEnabled","MSFullscreenChange","MSFullscreenError"]],z0=function(){if(typeof document=="undefined")return!1;for(var e=P1[0],t={},r=0,n=P1;r<n.length;r++){var i=n[r],a=i==null?void 0:i[1];if(a in document){var s=ab(i.entries()),l;try{for(s.s();!(l=s.n()).done;){var p=(0,yn.Z)(l.value,2),m=p[0],T=p[1];t[e[m]]=T}}catch(R){s.e(R)}finally{s.f()}return t}}return!1}(),O1={change:z0.fullscreenchange,error:z0.fullscreenerror},bf={request:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document.documentElement,r=arguments.length>1?arguments[1]:void 0;return new Promise(function(n,i){var a=function l(){bf.off("change",l),n()};bf.on("change",a);var s=t[z0.requestFullscreen](r);s instanceof Promise&&s.then(a).catch(i)})},exit:function(){return new Promise(function(t,r){if(!bf.isFullscreen){t();return}var n=function a(){bf.off("change",a),t()};bf.on("change",n);var i=document[z0.exitFullscreen]();i instanceof Promise&&i.then(n).catch(r)})},toggle:function(t,r){return bf.isFullscreen?bf.exit():bf.request(t,r)},onchange:function(t){bf.on("change",t)},onerror:function(t){bf.on("error",t)},on:function(t,r){var n=O1[t];n&&document.addEventListener(n,r,!1)},off:function(t,r){var n=O1[t];n&&document.removeEventListener(n,r,!1)},raw:z0};Object.defineProperties(bf,{isFullscreen:{get:function(){return!!document[z0.fullscreenElement]}},element:{enumerable:!0,get:function(){var t;return(t=document[z0.fullscreenElement])!==null&&t!==void 0?t:void 0}},isEnabled:{enumerable:!0,get:function(){return!!document[z0.fullscreenEnabled]}}}),z0||(bf={isEnabled:!1});var D8=null;function L8(e){var t=sb();return function(){var n=_getPrototypeOf(e),i;if(t){var a=_getPrototypeOf(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return _possibleConstructorReturn(this,i)}}function sb(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var F8=null;function B8(e){var t=ub();return function(){var n=_getPrototypeOf(e),i;if(t){var a=_getPrototypeOf(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return _possibleConstructorReturn(this,i)}}function ub(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var k8=null;function U8(e){var t=lb();return function(){var n=_getPrototypeOf(e),i;if(t){var a=_getPrototypeOf(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return _possibleConstructorReturn(this,i)}}function lb(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}function Z8(e){return e&&e.layer}var z8=null;function cb(e){var t=fb();return function(){var n=(0,le.Z)(e),i;if(t){var a=(0,le.Z)(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return(0,ze.Z)(this,i)}}function fb(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var hb=function(e){(0,ke.Z)(r,e);var t=cb(r);function r(){return(0,ue.Z)(this,r),t.apply(this,arguments)}return(0,_e.Z)(r,[{key:"getDefault",value:function(){return{position:Kh.BOTTOMLEFT,name:"logo",href:"https://l7.antv.antgroup.com/",img:"https://gw.alipayobjects.com/mdn/rms_816329/afts/img/A*GRb1TKp4HcMAAAAAAAAAAAAAARQnAQ"}}},{key:"onAdd",value:function(){var i=wi("div","l7-control-logo");return this.setLogoContent(i),i}},{key:"onRemove",value:function(){return null}},{key:"setOptions",value:function(i){Eh((0,le.Z)(r.prototype),"setOptions",this).call(this,i),this.checkUpdateOption(i,["img","href"])&&(is(this.container),this.setLogoContent(this.container))}},{key:"setLogoContent",value:function(i){var a=this.controlOption,s=a.href,l=a.img,p=wi("img");if(p.setAttribute("src",l),p.setAttribute("aria-label","AntV logo"),cu(p),s){var m=wi("a","l7-control-logo-link");m.target="_blank",m.href=s,m.rel="noopener nofollow",m.setAttribute("rel","noopener nofollow"),m.appendChild(p),i.appendChild(m)}else i.appendChild(p)}}]),r}(w1),G8={normal:{text:"\u6807\u51C6",img:"https://mdn.alipayobjects.com/huamei_qa8qxu/afts/img/A*qdFDSbvIalgAAAAAAAAAAAAADmJ7AQ/original"},light:{text:"\u6708\u5149\u94F6",img:"https://mdn.alipayobjects.com/huamei_qa8qxu/afts/img/A*d-vcRLzu8WIAAAAAAAAAAAAADmJ7AQ/original"},dark:{text:"\u5E7B\u5F71\u9ED1",img:"https://mdn.alipayobjects.com/huamei_qa8qxu/afts/img/A*HMbRTI3XnpIAAAAAAAAAAAAADmJ7AQ/original"},fresh:{text:"\u8349\u8272\u9752",img:"https://mdn.alipayobjects.com/huamei_qa8qxu/afts/img/A*kqaGQ5kjSiAAAAAAAAAAAAAADmJ7AQ/original"},grey:{text:"\u96C5\u58EB\u7070",img:"https://mdn.alipayobjects.com/huamei_qa8qxu/afts/img/A*XegrTpZIbqAAAAAAAAAAAAAADmJ7AQ/original"},graffiti:{text:"\u6D82\u9E26",img:"https://mdn.alipayobjects.com/huamei_qa8qxu/afts/img/A*G5g9SZ_Jg4cAAAAAAAAAAAAADmJ7AQ/original"},macaron:{text:"\u9A6C\u5361\u9F99",img:"https://mdn.alipayobjects.com/huamei_qa8qxu/afts/img/A*irVvQbDpQMwAAAAAAAAAAAAADmJ7AQ/original"},darkblue:{text:"\u6781\u591C\u84DD",img:"https://mdn.alipayobjects.com/huamei_qa8qxu/afts/img/A*lKRzQYB4iR0AAAAAAAAAAAAADmJ7AQ/original"},wine:{text:"\u9171\u7C7D",img:"https://mdn.alipayobjects.com/huamei_qa8qxu/afts/img/A*orY0T7QL-lwAAAAAAAAAAAAADmJ7AQ/original"}},V8={normal:{text:"\u6807\u51C6",img:"https://mdn.alipayobjects.com/huamei_qa8qxu/afts/img/A*kIyZTok4Uk0AAAAAAAAAAAAADmJ7AQ/original"},light:{text:"\u4EAE",img:"https://mdn.alipayobjects.com/huamei_qa8qxu/afts/img/A*Z3JRQKDI-cIAAAAAAAAAAAAADmJ7AQ/original"},dark:{text:"\u6697",img:"https://mdn.alipayobjects.com/huamei_qa8qxu/afts/img/A*d7HCQbfmyaoAAAAAAAAAAAAADmJ7AQ/original"},satellite:{text:"\u536B\u661F",img:"https://mdn.alipayobjects.com/huamei_qa8qxu/afts/img/A*TytUT6pS9okAAAAAAAAAAAAADmJ7AQ/original"},outdoors:{text:"\u6237\u5916",img:"https://mdn.alipayobjects.com/huamei_qa8qxu/afts/img/A*hWwFSYJEFWsAAAAAAAAAAAAADmJ7AQ/original"}};function H8(e){var t=Ab();return function(){var n=_getPrototypeOf(e),i;if(t){var a=_getPrototypeOf(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return _possibleConstructorReturn(this,i)}}function Ab(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var W8=null;function j8(e){var t=pb();return function(){var n=_getPrototypeOf(e),i;if(t){var a=_getPrototypeOf(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return _possibleConstructorReturn(this,i)}}function pb(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var X8=null;function Y8(e){var t=db();return function(){var n=_getPrototypeOf(e),i;if(t){var a=_getPrototypeOf(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return _possibleConstructorReturn(this,i)}}function db(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var $8=null;function Q8(e){var t=vb();return function(){var n=_getPrototypeOf(e),i;if(t){var a=_getPrototypeOf(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return _possibleConstructorReturn(this,i)}}function vb(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var q8=null;function K8(e){var t=gb();return function(){var n=_getPrototypeOf(e),i;if(t){var a=_getPrototypeOf(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return _possibleConstructorReturn(this,i)}}function gb(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var J8=null;function eL(e){var t=mb();return function(){var n=_getPrototypeOf(e),i;if(t){var a=_getPrototypeOf(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return _possibleConstructorReturn(this,i)}}function mb(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var tL=Fn.get,rL=null;function _b(e,t){var r=typeof my!="undefined"&&!!my&&typeof my.showToast=="function"&&my.isFRM!==!0,n=typeof wx!="undefined"&&wx!==null&&(typeof wx.request!="undefined"||typeof wx.miniProgram!="undefined");if(!(r||n)&&(t||(t=document),!!t)){var i=t.head||t.getElementsByTagName("head")[0];if(!i){i=t.createElement("head");var a=t.body||t.getElementsByTagName("body")[0];a?a.parentNode.insertBefore(i,a):t.documentElement.appendChild(i)}var s=t.createElement("style");return s.type="text/css",s.styleSheet?s.styleSheet.cssText=e:s.appendChild(t.createTextNode(e)),i.appendChild(s),s}}_b(`.l7-marker-container {
  position: absolute;
  width: 100%;
  height: 100%;
  overflow: hidden;
}
.l7-marker {
  position: absolute !important;
  top: 0;
  left: 0;
  z-index: 5;
  cursor: pointer;
}
.l7-marker-cluster {
  width: 40px;
  height: 40px;
  background-color: rgba(181, 226, 140, 0.6);
  background-clip: padding-box;
  border-radius: 20px;
}
.l7-marker-cluster div {
  width: 30px;
  height: 30px;
  margin-top: 5px;
  margin-left: 5px;
  font: 12px 'Helvetica Neue', Arial, Helvetica, sans-serif;
  text-align: center;
  background-color: rgba(110, 204, 57, 0.6);
  border-radius: 15px;
}
.l7-marker-cluster span {
  line-height: 30px;
}
.l7-touch .l7-control-attribution,
.l7-touch .l7-control-layers,
.l7-touch .l7-bar {
  -webkit-box-shadow: none;
          box-shadow: none;
}
.l7-touch .l7-control-layers,
.l7-touch .l7-bar {
  background-clip: padding-box;
  border: 2px solid rgba(0, 0, 0, 0.2);
}
.mapboxgl-ctrl-logo,
.amap-logo {
  display: none !important;
}
.l7-select-box {
  border: 3px dashed gray;
  border-radius: 2px;
  position: absolute;
  z-index: 999;
  -webkit-box-sizing: border-box;
          box-sizing: border-box;
}
.l7-control-container {
  font: 12px/1.5 'Helvetica Neue', Arial, Helvetica, sans-serif;
}
.l7-control-container .l7-control {
  position: relative;
  z-index: 999;
  float: left;
  clear: both;
  color: #595959;
  font-size: 12px;
  pointer-events: visiblePainted;
  /* IE 9-10 doesn't have auto */
  pointer-events: auto;
}
.l7-control-container .l7-control.l7-control--hide {
  display: none;
}
.l7-control-container .l7-top {
  top: 0;
  display: -webkit-box;
  display: -ms-flexbox;
  display: flex;
  position: absolute;
  z-index: 999;
  pointer-events: none;
}
.l7-control-container .l7-top .l7-control:not(.l7-control--hide) {
  margin-top: 8px;
}
.l7-control-container .l7-right {
  right: 0;
  display: -webkit-box;
  display: -ms-flexbox;
  display: flex;
  position: absolute;
  z-index: 999;
  pointer-events: none;
}
.l7-control-container .l7-right .l7-control:not(.l7-control--hide) {
  margin-right: 8px;
}
.l7-control-container .l7-bottom {
  bottom: 0;
  display: -webkit-box;
  display: -ms-flexbox;
  display: flex;
  position: absolute;
  z-index: 999;
  pointer-events: none;
}
.l7-control-container .l7-bottom .l7-control:not(.l7-control--hide) {
  margin-bottom: 8px;
}
.l7-control-container .l7-left {
  left: 0;
  display: -webkit-box;
  display: -ms-flexbox;
  display: flex;
  position: absolute;
  z-index: 999;
  pointer-events: none;
}
.l7-control-container .l7-left .l7-control:not(.l7-control--hide) {
  margin-left: 8px;
}
.l7-control-container .l7-center {
  position: absolute;
  display: -webkit-box;
  display: -ms-flexbox;
  display: flex;
  -webkit-box-pack: center;
      -ms-flex-pack: center;
          justify-content: center;
}
.l7-control-container .l7-center.l7-top,
.l7-control-container .l7-center.l7-bottom {
  width: 100%;
}
.l7-control-container .l7-center.l7-left,
.l7-control-container .l7-center.l7-right {
  height: 100%;
}
.l7-control-container .l7-center .l7-control {
  margin-right: 8px;
  margin-bottom: 8px;
}
.l7-control-container .l7-row {
  -webkit-box-orient: horizontal;
  -webkit-box-direction: normal;
      -ms-flex-direction: row;
          flex-direction: row;
}
.l7-control-container .l7-row.l7-top {
  -webkit-box-align: start;
      -ms-flex-align: start;
          align-items: flex-start;
}
.l7-control-container .l7-row.l7-bottom {
  -webkit-box-align: end;
      -ms-flex-align: end;
          align-items: flex-end;
}
.l7-control-container .l7-column {
  -webkit-box-orient: vertical;
  -webkit-box-direction: normal;
      -ms-flex-direction: column;
          flex-direction: column;
}
.l7-control-container .l7-column.l7-left {
  -webkit-box-align: start;
      -ms-flex-align: start;
          align-items: flex-start;
}
.l7-control-container .l7-column.l7-right {
  -webkit-box-align: end;
      -ms-flex-align: end;
          align-items: flex-end;
}
.l7-button-control {
  min-width: 28px;
  height: 28px;
  background-color: #fff;
  border-width: 0;
  border-radius: 2px;
  outline: 0;
  cursor: pointer;
  -webkit-transition: all 0.2s;
  transition: all 0.2s;
  display: -webkit-box;
  display: -ms-flexbox;
  display: flex;
  -webkit-box-pack: center;
      -ms-flex-pack: center;
          justify-content: center;
  -webkit-box-align: center;
      -ms-flex-align: center;
          align-items: center;
  padding: 0 6px;
  -webkit-box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.15);
          box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.15);
  line-height: 16px;
}
.l7-button-control .l7-iconfont {
  fill: #595959;
  color: #595959;
  width: 16px;
  height: 16px;
}
.l7-button-control.l7-button-control--row {
  padding: 0 16px 0 13px;
}
.l7-button-control.l7-button-control--row * + .l7-button-control__text {
  margin-left: 8px;
}
.l7-button-control.l7-button-control--column {
  height: 44px;
  -webkit-box-orient: vertical;
  -webkit-box-direction: normal;
      -ms-flex-direction: column;
          flex-direction: column;
}
.l7-button-control.l7-button-control--column .l7-iconfont {
  margin-top: 3px;
}
.l7-button-control.l7-button-control--column .l7-button-control__text {
  margin-top: 3px;
  font-size: 10px;
  -webkit-transform: scale(0.83333);
          transform: scale(0.83333);
}
.l7-button-control:not(:disabled):hover {
  background-color: #f3f3f3;
}
.l7-button-control:not(:disabled):active {
  background-color: #f3f3f3;
}
.l7-button-control:disabled {
  background-color: #fafafa;
  color: #bdbdbd;
  cursor: not-allowed;
}
.l7-button-control:disabled .l7-iconfont {
  fill: #bdbdbd;
  color: #bdbdbd;
}
.l7-button-control:disabled:hover {
  background-color: #fafafa;
}
.l7-button-control:disabled:active {
  background-color: #fafafa;
}
.l7-popper {
  position: absolute;
  display: -webkit-box;
  display: -ms-flexbox;
  display: flex;
  -webkit-box-pack: center;
      -ms-flex-pack: center;
          justify-content: center;
  -webkit-box-align: center;
      -ms-flex-align: center;
          align-items: center;
  z-index: 5;
  color: #595959;
}
.l7-popper.l7-popper-hide {
  display: none;
}
.l7-popper .l7-popper-content {
  min-height: 28px;
  background: #fff;
  border-radius: 2px;
  -webkit-box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.15);
          box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.15);
}
.l7-popper .l7-popper-arrow {
  width: 0;
  height: 0;
  border-width: 4px;
  border-style: solid;
  border-top-color: transparent;
  border-bottom-color: transparent;
  border-left-color: transparent;
  border-right-color: transparent;
  -webkit-box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.15);
          box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.15);
}
.l7-popper.l7-popper-left {
  -webkit-box-orient: horizontal;
  -webkit-box-direction: normal;
      -ms-flex-direction: row;
          flex-direction: row;
}
.l7-popper.l7-popper-left .l7-popper-arrow {
  border-left-color: #fff;
  margin: 10px 0;
}
.l7-popper.l7-popper-right {
  -webkit-box-orient: horizontal;
  -webkit-box-direction: reverse;
      -ms-flex-direction: row-reverse;
          flex-direction: row-reverse;
}
.l7-popper.l7-popper-right .l7-popper-arrow {
  border-right-color: #fff;
  margin: 10px 0;
}
.l7-popper.l7-popper-top {
  -webkit-box-orient: vertical;
  -webkit-box-direction: normal;
      -ms-flex-direction: column;
          flex-direction: column;
}
.l7-popper.l7-popper-top .l7-popper-arrow {
  border-top-color: #fff;
  margin: 0 10px;
}
.l7-popper.l7-popper-bottom {
  -webkit-box-orient: vertical;
  -webkit-box-direction: reverse;
      -ms-flex-direction: column-reverse;
          flex-direction: column-reverse;
}
.l7-popper.l7-popper-bottom .l7-popper-arrow {
  border-bottom-color: #fff;
  margin: 0 10px;
}
.l7-popper.l7-popper-start {
  -webkit-box-align: start;
      -ms-flex-align: start;
          align-items: flex-start;
}
.l7-popper.l7-popper-end {
  -webkit-box-align: end;
      -ms-flex-align: end;
          align-items: flex-end;
}
.l7-select-control--normal {
  padding: 4px 0;
}
.l7-select-control--normal .l7-select-control-item {
  display: -webkit-box;
  display: -ms-flexbox;
  display: flex;
  -webkit-box-align: center;
      -ms-flex-align: center;
          align-items: center;
  height: 24px;
  padding: 0 16px;
  font-size: 12px;
  line-height: 24px;
}
.l7-select-control--normal .l7-select-control-item > * + * {
  margin-left: 6px;
}
.l7-select-control--normal .l7-select-control-item input[type='checkbox'] {
  width: 14px;
  height: 14px;
}
.l7-select-control--normal .l7-select-control-item:hover {
  background-color: #f3f3f3;
}
.l7-select-control--image {
  display: -webkit-box;
  display: -ms-flexbox;
  display: flex;
  -ms-flex-wrap: wrap;
      flex-wrap: wrap;
  -webkit-box-align: start;
      -ms-flex-align: start;
          align-items: flex-start;
  -webkit-box-sizing: content-box;
          box-sizing: content-box;
  max-width: 420px;
  max-height: 400px;
  margin: 12px 0 0 12px;
  overflow: auto;
}
.l7-select-control--image .l7-select-control-item {
  position: relative;
  display: -webkit-box;
  display: -ms-flexbox;
  display: flex;
  -webkit-box-orient: vertical;
  -webkit-box-direction: normal;
      -ms-flex-direction: column;
          flex-direction: column;
  -webkit-box-pack: center;
      -ms-flex-pack: center;
          justify-content: center;
  -webkit-box-sizing: content-box;
          box-sizing: content-box;
  width: 408px / 3 - 12px;
  margin-right: 12px;
  margin-bottom: 12px;
  overflow: hidden;
  font-size: 12px;
  border: 1px solid #fff;
  border-radius: 2px;
}
.l7-select-control--image .l7-select-control-item img {
  width: 100%;
  height: 80px;
}
.l7-select-control--image .l7-select-control-item input[type='checkbox'] {
  position: absolute;
  top: 0;
  right: 0;
}
.l7-select-control--image .l7-select-control-item .l7-select-control-item-row {
  display: -webkit-box;
  display: -ms-flexbox;
  display: flex;
  -webkit-box-align: center;
      -ms-flex-align: center;
          align-items: center;
  -webkit-box-pack: center;
      -ms-flex-pack: center;
          justify-content: center;
  line-height: 26px;
}
.l7-select-control--image .l7-select-control-item .l7-select-control-item-row > * + * {
  margin-left: 8px;
}
.l7-select-control--image .l7-select-control-item.l7-select-control-item-active {
  border-color: #0370fe;
}
.l7-select-control-item {
  cursor: pointer;
}
.l7-select-control-item input[type='checkbox'] {
  margin: 0;
  cursor: pointer;
}
.l7-select-control--multiple .l7-select-control-item:hover {
  background-color: transparent;
}
.l7-control-logo {
  width: 89px;
  height: 16px;
  -webkit-user-select: none;
     -moz-user-select: none;
      -ms-user-select: none;
          user-select: none;
}
.l7-control-logo img {
  height: 100%;
  width: 100%;
}
.l7-control-logo .l7-control-logo-link {
  display: block;
  cursor: pointer;
}
.l7-control-logo .l7-control-logo-link img {
  cursor: pointer;
}
.l7-control-mouse-location {
  background-color: #fff;
  border-radius: 2px;
  -webkit-box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.15);
          box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.15);
  padding: 2px 4px;
  min-width: 130px;
}
.l7-control-zoom {
  overflow: hidden;
  border-radius: 2px;
  -webkit-box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.15);
          box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.15);
}
.l7-control-zoom .l7-button-control {
  font-size: 16px;
  border-bottom: 1px solid #f0f0f0;
  border-radius: 0;
  -webkit-box-shadow: 0 0 0;
          box-shadow: 0 0 0;
}
.l7-control-zoom .l7-button-control .l7-iconfont {
  width: 14px;
  height: 14px;
}
.l7-control-zoom .l7-button-control:last-child {
  border-bottom: 0;
}
.l7-control-zoom .l7-control-zoom__number {
  color: #595959;
  padding: 0;
}
.l7-control-zoom .l7-control-zoom__number:hover {
  background-color: #fff;
}
.l7-control-scale {
  display: -webkit-box;
  display: -ms-flexbox;
  display: flex;
  -webkit-box-orient: vertical;
  -webkit-box-direction: normal;
      -ms-flex-direction: column;
          flex-direction: column;
}
.l7-control-scale .l7-control-scale-line {
  -webkit-box-sizing: border-box;
          box-sizing: border-box;
  padding: 2px 5px 1px;
  overflow: hidden;
  color: #595959;
  font-size: 10px;
  line-height: 1.1;
  white-space: nowrap;
  background: #fff;
  border: 2px solid #000;
  border-top: 0;
  -webkit-transition: width 0.1s;
  transition: width 0.1s;
}
.l7-control-scale .l7-control-scale-line + .l7-control-scale .l7-control-scale-line {
  margin-top: -2px;
  border-top: 2px solid #777;
  border-bottom: none;
}
.l7-right .l7-control-scale {
  display: -webkit-box;
  display: -ms-flexbox;
  display: flex;
  -webkit-box-align: end;
      -ms-flex-align: end;
          align-items: flex-end;
}
.l7-right .l7-control-scale .l7-control-scale-line {
  text-align: right;
}
.l7-popup {
  position: absolute;
  top: 0;
  left: 0;
  z-index: 5;
  display: -webkit-box;
  display: -ms-flexbox;
  display: flex;
  will-change: transform;
  pointer-events: none;
}
.l7-popup.l7-popup-hide {
  display: none;
}
.l7-popup .l7-popup-content {
  position: relative;
  padding: 16px;
  font-size: 14px;
  background: #fff;
  border-radius: 3px;
  -webkit-box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
          box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
}
.l7-popup .l7-popup-content .l7-popup-content__title {
  margin-bottom: 8px;
  font-weight: bold;
}
.l7-popup .l7-popup-content .l7-popup-close-button,
.l7-popup .l7-popup-content .l7-popup-content__title,
.l7-popup .l7-popup-content .l7-popup-content__panel {
  white-space: normal;
  -webkit-user-select: text;
     -moz-user-select: text;
      -ms-user-select: text;
          user-select: text;
  pointer-events: initial;
}
.l7-popup .l7-popup-content .l7-popup-close-button {
  position: absolute;
  top: 0;
  right: 0;
  width: 18px;
  height: 18px;
  padding: 0;
  font-size: 14px;
  line-height: 18px;
  text-align: center;
  background-color: transparent;
  border: 0;
  border-radius: 0 3px 0 0;
  cursor: pointer;
}
.l7-popup .l7-popup-tip {
  position: relative;
  z-index: 1;
  width: 0;
  height: 0;
  border: 10px solid transparent;
}
.l7-popup.l7-popup-anchor-bottom,
.l7-popup.l7-popup-anchor-bottom-left,
.l7-popup.l7-popup-anchor-bottom-right {
  -webkit-box-orient: vertical;
  -webkit-box-direction: reverse;
      -ms-flex-direction: column-reverse;
          flex-direction: column-reverse;
}
.l7-popup.l7-popup-anchor-bottom .l7-popup-tip,
.l7-popup.l7-popup-anchor-bottom-left .l7-popup-tip,
.l7-popup.l7-popup-anchor-bottom-right .l7-popup-tip {
  bottom: 1px;
}
.l7-popup.l7-popup-anchor-top,
.l7-popup.l7-popup-anchor-top-left,
.l7-popup.l7-popup-anchor-top-right {
  -webkit-box-orient: vertical;
  -webkit-box-direction: normal;
      -ms-flex-direction: column;
          flex-direction: column;
}
.l7-popup.l7-popup-anchor-top .l7-popup-tip,
.l7-popup.l7-popup-anchor-top-left .l7-popup-tip,
.l7-popup.l7-popup-anchor-top-right .l7-popup-tip {
  top: 1px;
}
.l7-popup.l7-popup-anchor-left {
  -webkit-box-orient: horizontal;
  -webkit-box-direction: normal;
      -ms-flex-direction: row;
          flex-direction: row;
}
.l7-popup.l7-popup-anchor-right {
  -webkit-box-orient: horizontal;
  -webkit-box-direction: reverse;
      -ms-flex-direction: row-reverse;
          flex-direction: row-reverse;
}
.l7-popup-anchor-top .l7-popup-tip {
  position: relative;
  -webkit-align-self: center;
  -ms-flex-item-align: center;
      align-self: center;
  border-top: none;
  border-bottom-color: #fff;
}
.l7-popup-anchor-top-left .l7-popup-tip {
  -webkit-align-self: flex-start;
  -ms-flex-item-align: start;
      align-self: flex-start;
  border-top: none;
  border-bottom-color: #fff;
  border-left: none;
}
.l7-popup-anchor-top-right .l7-popup-tip {
  -webkit-align-self: flex-end;
  -ms-flex-item-align: end;
      align-self: flex-end;
  border-top: none;
  border-right: none;
  border-bottom-color: #fff;
}
.l7-popup-anchor-bottom .l7-popup-tip {
  -webkit-align-self: center;
  -ms-flex-item-align: center;
      align-self: center;
  border-top-color: #fff;
  border-bottom: none;
}
.l7-popup-anchor-bottom-left .l7-popup-tip {
  -webkit-align-self: flex-start;
  -ms-flex-item-align: start;
      align-self: flex-start;
  border-top-color: #fff;
  border-bottom: none;
  border-left: none;
}
.l7-popup-anchor-bottom-right .l7-popup-tip {
  -webkit-align-self: flex-end;
  -ms-flex-item-align: end;
      align-self: flex-end;
  border-top-color: #fff;
  border-right: none;
  border-bottom: none;
}
.l7-popup-anchor-left .l7-popup-tip {
  -webkit-align-self: center;
  -ms-flex-item-align: center;
      align-self: center;
  border-right-color: #fff;
  border-left: none;
}
.l7-popup-anchor-right .l7-popup-tip {
  right: 1px;
  -webkit-align-self: center;
  -ms-flex-item-align: center;
      align-self: center;
  border-right: none;
  border-left-color: #fff;
}
.l7-popup-anchor-top-left .l7-popup-content {
  border-top-left-radius: 0;
}
.l7-popup-anchor-top-right .l7-popup-content {
  border-top-right-radius: 0;
}
.l7-popup-anchor-bottom-left .l7-popup-content {
  border-bottom-left-radius: 0;
}
.l7-popup-anchor-bottom-right .l7-popup-content {
  border-bottom-right-radius: 0;
}
.l7-popup-track-pointer {
  display: none;
}
.l7-popup-track-pointer * {
  -webkit-user-select: none;
     -moz-user-select: none;
      -ms-user-select: none;
          user-select: none;
  pointer-events: none;
}
.l7-map:hover .l7-popup-track-pointer {
  display: -webkit-box;
  display: -ms-flexbox;
  display: flex;
}
.l7-map:active .l7-popup-track-pointer {
  display: none;
}
.l7-layer-popup__row {
  font-size: 12px;
}
.l7-layer-popup__row + .l7-layer-popup__row {
  margin-top: 4px;
}
`);var Sh,N1=(Sh={},(0,ve.Z)(Sh,D0.additive,{enable:!0,func:{srcRGB:Fe.ONE,dstRGB:Fe.ONE,srcAlpha:1,dstAlpha:1}}),(0,ve.Z)(Sh,D0.none,{enable:!1}),(0,ve.Z)(Sh,D0.normal,{enable:!0,func:{srcRGB:Fe.SRC_ALPHA,dstRGB:Fe.ONE_MINUS_SRC_ALPHA,srcAlpha:1,dstAlpha:1}}),(0,ve.Z)(Sh,D0.subtractive,{enable:!0,func:{srcRGB:Fe.ONE,dstRGB:Fe.ONE,srcAlpha:Fe.ZERO,dstAlpha:Fe.ONE_MINUS_SRC_COLOR},equation:{rgb:Fe.FUNC_SUBTRACT,alpha:Fe.FUNC_SUBTRACT}}),(0,ve.Z)(Sh,D0.max,{enable:!0,func:{srcRGB:Fe.ONE,dstRGB:Fe.ONE},equation:{rgb:Fe.MAX_EXT}}),(0,ve.Z)(Sh,D0.min,{enable:!0,func:{srcRGB:Fe.ONE,dstRGB:Fe.ONE},equation:{rgb:Fe.MIN_EXT}}),Sh);function D1(e){return e.map(function(t){return typeof t=="string"&&(t=[t,{}]),t})}function L1(e,t,r,n){var i=e.multiPassRenderer,a=e.getLayerConfig(),s=a.enableTAA;return s?i.add(n("taa")):i.add(n("render")),D1(t).forEach(function(l){var p=(0,yn.Z)(l,2),m=p[0],T=p[1];i.add(r(m),T)}),i.add(r("copy")),i}var yb=function(){function e(t){(0,ue.Z)(this,e),this.layer=t}return(0,_e.Z)(e,[{key:"pickRender",value:function(r){var n=this.layer.getContainer(),i=n.get(xt.ILayerService),a=this.layer;if(a.tileLayer)return a.tileLayer.pickRender(r);a.hooks.beforePickingEncode.call(),i.renderTileLayerMask(a),a.renderModels({ispick:!0}),a.hooks.afterPickingEncode.call()}},{key:"pick",value:function(r,n){var i=this.layer.getContainer(),a=i.get(xt.IPickingService);return r.type==="RasterLayer"?this.pickRasterLayer(r,n):(this.pickRender(n),a.pickFromPickingFBO(r,n))}},{key:"pickRasterLayer",value:function(r,n,i){var a=this.layer.getContainer(),s=a.get(xt.IPickingService),l=a.get(xt.IMapService),p=this.layer.getSource().extent,m=af(n.lngLat,p),T={x:n.x,y:n.y,type:n.type,lngLat:n.lngLat,target:n,rasterValue:null},R=i||r;if(m){var L=this.readRasterValue(r,p,l,n.x,n.y);return T.rasterValue=L,s.triggerHoverOnLayer(R,T),!0}else return T.type=n.type==="mousemove"?"mouseout":"un"+n.type,s.triggerHoverOnLayer(R,(0,Q.Z)((0,Q.Z)({},T),{},{type:"unpick"})),s.triggerHoverOnLayer(R,T),!1}},{key:"readRasterValue",value:function(r,n,i,a,s){var l=r.getSource().data.dataArray[0],p=(0,yn.Z)(n,4),m=p[0],T=m===void 0?0:m,R=p[1],L=R===void 0?0:R,z=p[2],re=z===void 0?10:z,ee=p[3],me=ee===void 0?-10:ee,Ie=i.lngLatToContainer([T,L]),He=i.lngLatToContainer([re,me]),Xe=He.x-Ie.x,ot=Ie.y-He.y,pt=[(a-Ie.x)/Xe,(s-He.y)/ot],dt=l.width||1,It=l.height||1,Vt=Math.floor(pt[0]*dt),Kt=Math.floor(pt[1]*It),yr=Math.max(0,Kt-1)*dt+Vt,_r=l.data[yr];return _r}},{key:"selectFeature",value:function(r){var n=this.layer,i=(0,yn.Z)(r,3),a=i[0],s=i[1],l=i[2];n.hooks.beforeSelect.call([a,s,l])}},{key:"highlightPickedFeature",value:function(r){var n=(0,yn.Z)(r,3),i=n[0],a=n[1],s=n[2];this.layer.hooks.beforeHighlight.call([i,a,s])}},{key:"getFeatureById",value:function(r){return this.layer.getSource().getFeatureById(r)}}]),e}(),Eb=function(){function e(t){(0,ue.Z)(this,e),this.layer=t;var r=this.layer.getContainer();this.rendererService=r.get(xt.IRendererService)}return(0,_e.Z)(e,[{key:"getColorTexture",value:function(r,n){var i=this.getTextureKey(r,n);return this.key===i?this.colorTexture:(this.createColorTexture(r,n),this.key=i,this.colorTexture)}},{key:"createColorTexture",value:function(r,n){var i=this.rendererService.createTexture2D,a=this.getColorRampBar(r,n),s=i({data:new Uint8Array(a.data),width:a.width,height:a.height,flipY:!1});return this.colorTexture=s,s}},{key:"setColorTexture",value:function(r,n,i){this.key=this.getTextureKey(n,i),this.colorTexture=r}},{key:"destroy",value:function(){var r;(r=this.colorTexture)===null||r===void 0||r.destroy()}},{key:"getColorRampBar",value:function(r,n){switch(r.type){case"cat":return Ba(r);case"quantize":return Oa(r);case"custom":return Cl(r,n);case"linear":return il(r,n);default:return ds(r)}}},{key:"getTextureKey",value:function(r,n){var i;return"".concat(r.colors.join("_"),"_").concat(r==null||(i=r.positions)===null||i===void 0?void 0:i.join("_"),"_").concat(r.type,"_").concat(n==null?void 0:n.join("_"))}}]),e}(),Sb=["passes"],xb=["moduleName","vertexShader","fragmentShader","inject","triangulation","styleOption"],F1,Hm,B1;function Tb(e,t){var r=typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=Cb(e))||t&&e&&typeof e.length=="number"){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(m){throw m},f:i}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var a=!0,s=!1,l;return{s:function(){r=r.call(e)},n:function(){var m=r.next();return a=m.done,m},e:function(m){s=!0,l=m},f:function(){try{!a&&r.return!=null&&r.return()}finally{if(s)throw l}}}}function Cb(e,t){if(e){if(typeof e=="string")return k1(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return k1(e,t)}}function k1(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function bb(e){var t=Rb();return function(){var n=(0,le.Z)(e),i;if(t){var a=(0,le.Z)(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return(0,ze.Z)(this,i)}}function Rb(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var Wm=Fn.isEqual,U1=Fn.isFunction,Z1=Fn.isNumber,_l=Fn.isObject,Mb=Fn.isPlainObject,wb=Fn.isUndefined,z1=0,fp=(F1=zm(xt.IGlobalConfigService),Hm=function(e){(0,ke.Z)(r,e);var t=bb(r);function r(){var n,i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return(0,ue.Z)(this,r),n=t.call(this),(0,ve.Z)((0,St.Z)(n),"id","".concat(z1++)),(0,ve.Z)((0,St.Z)(n),"name","".concat(z1)),(0,ve.Z)((0,St.Z)(n),"visible",!0),(0,ve.Z)((0,St.Z)(n),"zIndex",0),(0,ve.Z)((0,St.Z)(n),"inited",!1),(0,ve.Z)((0,St.Z)(n),"layerModelNeedUpdate",!1),(0,ve.Z)((0,St.Z)(n),"pickedFeatureID",null),(0,ve.Z)((0,St.Z)(n),"selectedFeatureID",null),(0,ve.Z)((0,St.Z)(n),"styleNeedUpdate",!1),(0,ve.Z)((0,St.Z)(n),"forceRender",!1),(0,ve.Z)((0,St.Z)(n),"clusterZoom",0),(0,ve.Z)((0,St.Z)(n),"defaultSourceConfig",{data:[],options:{parser:{type:"json"}}}),(0,ve.Z)((0,St.Z)(n),"dataState",{dataSourceNeedUpdate:!1,dataMappingNeedUpdate:!1,filterNeedUpdate:!1,featureScaleNeedUpdate:!1,StyleAttrNeedUpdate:!1}),(0,ve.Z)((0,St.Z)(n),"hooks",{init:new vy,afterInit:new Nm,beforeRender:new Nm,beforeRenderData:new gy,afterRender:new Hf,beforePickingEncode:new Hf,afterPickingEncode:new Hf,beforeHighlight:new Hf(["pickedColor"]),afterHighlight:new Hf,beforeSelect:new Hf(["pickedColor"]),afterSelect:new Hf,beforeDestroy:new Hf,afterDestroy:new Hf}),(0,ve.Z)((0,St.Z)(n),"models",[]),(0,ve.Z)((0,St.Z)(n),"startInit",!1),(0,ve.Z)((0,St.Z)(n),"layerChildren",[]),(0,ve.Z)((0,St.Z)(n),"masks",[]),fa((0,St.Z)(n),"configService",B1,(0,St.Z)(n)),(0,ve.Z)((0,St.Z)(n),"animateOptions",{enable:!1}),(0,ve.Z)((0,St.Z)(n),"currentPickId",null),(0,ve.Z)((0,St.Z)(n),"encodeStyleAttribute",{}),(0,ve.Z)((0,St.Z)(n),"enableShaderEncodeStyles",[]),(0,ve.Z)((0,St.Z)(n),"enableDataEncodeStyles",[]),(0,ve.Z)((0,St.Z)(n),"enablg",[]),(0,ve.Z)((0,St.Z)(n),"pendingStyleAttributes",[]),(0,ve.Z)((0,St.Z)(n),"scaleOptions",{}),(0,ve.Z)((0,St.Z)(n),"animateStatus",!1),(0,ve.Z)((0,St.Z)(n),"isDestroyed",!1),(0,ve.Z)((0,St.Z)(n),"encodeDataLength",0),(0,ve.Z)((0,St.Z)(n),"sourceEvent",function(){n.dataState.dataSourceNeedUpdate=!0;var a=n.getLayerConfig();a&&a.autoFit&&n.fitBounds(a.fitBoundsOptions);var s=n.layerSource.getSourceCfg().autoRender;s&&n.reRender()}),n.name=i.name||n.id,n.zIndex=i.zIndex||0,n.rawConfig=i,n}return(0,_e.Z)(r,[{key:"addMask",value:function(i){this.masks.push(i),this.enableMask()}},{key:"removeMask",value:function(i){var a=this.masks.indexOf(i);a>-1&&this.masks.splice(a,1)}},{key:"disableMask",value:function(){this.updateLayerConfig({enableMask:!1})}},{key:"enableMask",value:function(){this.updateLayerConfig({enableMask:!0})}},{key:"addMaskLayer",value:function(i){this.masks.push(i)}},{key:"removeMaskLayer",value:function(i){var a=this.masks.indexOf(i);a>-1&&this.masks.splice(a,1),i.destroy()}},{key:"getAttribute",value:function(i){return this.styleAttributeService.getLayerStyleAttribute(i)}},{key:"getLayerConfig",value:function(){return this.configService.getLayerConfig(this.id)}},{key:"updateLayerConfig",value:function(i){var a=this;if(Object.keys(i).map(function(l){l in a.rawConfig&&(a.rawConfig[l]=i[l])}),!this.startInit)this.needUpdateConfig=(0,Q.Z)((0,Q.Z)({},this.needUpdateConfig),i);else{var s=this.container.get(xt.SceneID);this.configService.setLayerConfig(s,this.id,(0,Q.Z)((0,Q.Z)((0,Q.Z)({},this.configService.getLayerConfig(this.id)),this.needUpdateConfig),i)),this.needUpdateConfig={}}}},{key:"setContainer",value:function(i,a){this.container=i,this.sceneContainer=a}},{key:"getContainer",value:function(){return this.container}},{key:"addPlugin",value:function(i){return this.plugins.push(i),this}},{key:"init",value:function(){var n=(0,hr.Z)(it().mark(function a(){var s=this,l,p,m,T,R,L,z;return it().wrap(function(ee){for(;;)switch(ee.prev=ee.next){case 0:l=this.container.get(xt.SceneID),this.startInit=!0,this.configService.setLayerConfig(l,this.id,this.rawConfig),this.layerType=this.rawConfig.layerType,this.iconService=this.container.get(xt.IIconService),this.fontService=this.container.get(xt.IFontService),this.rendererService=this.container.get(xt.IRendererService),this.layerService=this.container.get(xt.ILayerService),this.debugService=this.container.get(xt.IDebugService),this.interactionService=this.container.get(xt.IInteractionService),this.pickingService=this.container.get(xt.IPickingService),this.mapService=this.container.get(xt.IMapService),p=this.getLayerConfig(),m=p.enableMultiPassRenderer,T=p.passes,m&&T!==null&&T!==void 0&&T.length&&T.length>0&&this.mapService.on("mapAfterFrameChange",function(){s.renderLayers()}),this.cameraService=this.container.get(xt.ICameraService),this.coordinateService=this.container.get(xt.ICoordinateSystemService),this.shaderModuleService=this.container.get(xt.IShaderModuleService),this.postProcessingPassFactory=this.container.get(xt.IFactoryPostProcessingPass),this.normalPassFactory=this.container.get(xt.IFactoryNormalPass),this.styleAttributeService=this.container.get(xt.IStyleAttributeService),m&&(this.multiPassRenderer=this.container.get(xt.IMultiPassRenderer),this.multiPassRenderer.setLayer(this)),this.pendingStyleAttributes.forEach(function(me){var Ie=me.attributeName,He=me.attributeField,Xe=me.attributeValues,ot=me.updateOptions;s.styleAttributeService.updateStyleAttribute(Ie,{scale:(0,Q.Z)({field:He},s.splitValuesAndCallbackInAttribute(Xe,He?void 0:s.getLayerConfig()[Ie]))},ot)}),this.pendingStyleAttributes=[],this.plugins=this.container.getAll(xt.ILayerPlugin),R=Tb(this.plugins);try{for(R.s();!(L=R.n()).done;)z=L.value,z.apply(this,{rendererService:this.rendererService,mapService:this.mapService,styleAttributeService:this.styleAttributeService,normalPassFactory:this.normalPassFactory,postProcessingPassFactory:this.postProcessingPassFactory})}catch(me){R.e(me)}finally{R.f()}return this.layerPickService=new yb(this),this.textureService=new Eb(this),this.log(du.LayerInitStart),ee.next=31,this.hooks.init.promise();case 31:this.log(du.LayerInitEnd),this.inited=!0,this.emit("inited",{target:this,type:"inited"}),this.emit("add",{target:this,type:"add"}),this.hooks.afterInit.call();case 36:case"end":return ee.stop()}},a,this)}));function i(){return n.apply(this,arguments)}return i}()},{key:"log",value:function(i){var a,s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"init";if(!(this.tileLayer||this.isTileLayer)){var l="".concat(this.id,".").concat(s,".").concat(i),p={id:this.id,type:this.type};(a=this.debugService)===null||a===void 0||a.log(l,p)}}},{key:"updateModelData",value:function(i){i.attributes&&i.elements?this.models.map(function(a){a.updateAttributesAndElements(i.attributes,i.elements)}):console.warn("data error")}},{key:"setLayerPickService",value:function(i){this.layerPickService=i}},{key:"prepareBuildModel",value:function(){Object.keys(this.needUpdateConfig||{}).length!==0&&this.updateLayerConfig({});var i=this.getLayerConfig(),a=i.animateOption;a!=null&&a.enable&&(this.layerService.startAnimate(),this.animateStatus=!0)}},{key:"color",value:function(i,a,s){return this.updateStyleAttribute("color",i,a,s),this}},{key:"texture",value:function(i,a,s){return this.updateStyleAttribute("texture",i,a,s),this}},{key:"rotate",value:function(i,a,s){return this.updateStyleAttribute("rotate",i,a,s),this}},{key:"size",value:function(i,a,s){return this.updateStyleAttribute("size",i,a,s),this}},{key:"filter",value:function(i,a,s){var l=this.updateStyleAttribute("filter",i,a,s);return this.dataState.dataSourceNeedUpdate=l&&this.inited,this}},{key:"shape",value:function(i,a,s){this.shapeOption={field:i,values:a};var l=this.updateStyleAttribute("shape",i,a,s);return this.dataState.dataSourceNeedUpdate=l&&this.inited,this}},{key:"label",value:function(i,a,s){return this.pendingStyleAttributes.push({attributeName:"label",attributeField:i,attributeValues:a,updateOptions:s}),this}},{key:"animate",value:function(i){var a={};return _l(i)?(a.enable=!0,a=(0,Q.Z)((0,Q.Z)({},a),i)):a.enable=i,this.updateLayerConfig({animateOption:a}),this}},{key:"source",value:function(i,a){return(i==null?void 0:i.type)==="source"?(this.setSource(i),this):(this.sourceOption={data:i,options:a},this.clusterZoom=0,this)}},{key:"setData",value:function(i,a){var s=this;return this.inited?(this.log(du.SourceInitStart,xu.UPDATE),this.layerSource.setData(i,a),this.log(du.SourceInitEnd,xu.UPDATE)):this.on("inited",function(){s.log(du.SourceInitStart,xu.UPDATE);var l=s.getSource();l?s.layerSource.setData(i,a):s.source(new R1(i,a)),s.layerSource.once("update",function(){s.log(du.SourceInitEnd,xu.UPDATE)})}),this}},{key:"style",value:function(i){var a=this,s=i.passes,l=(0,Cc.Z)(i,Sb);s&&D1(s).forEach(function(m){var T=a.multiPassRenderer.getPostProcessor().getPostProcessingPassByName(m[0]);T&&T.updateOptions(m[1])}),l.borderColor&&(l.stroke=l.borderColor),l.borderWidth&&(l.strokeWidth=l.borderWidth);var p=l;return Object.keys(l).forEach(function(m){var T=l[m];Array.isArray(T)&&T.length===2&&!Z1(T[0])&&!Z1(T[1])&&(p[m]={field:T[0],value:T[1]})}),this.encodeStyle(p),this.updateLayerConfig(p),this}},{key:"encodeStyle",value:function(i){var a=this;Object.keys(i).forEach(function(s){[].concat((0,cr.Z)(a.enableShaderEncodeStyles),(0,cr.Z)(a.enableDataEncodeStyles)).includes(s)&&Mb(i[s])&&(i[s].field||i[s].value)&&!Wm(a.encodeStyleAttribute[s],i[s])?(a.encodeStyleAttribute[s]=i[s],a.updateStyleAttribute(s,i[s].field,i[s].value),a.inited&&(a.dataState.dataMappingNeedUpdate=!0)):a.encodeStyleAttribute[s]&&(delete a.encodeStyleAttribute[s],a.dataState.dataSourceNeedUpdate=!0)})}},{key:"scale",value:function(i,a){var s=(0,Q.Z)({},this.scaleOptions);if(_l(i)?this.scaleOptions=(0,Q.Z)((0,Q.Z)({},this.scaleOptions),i):this.scaleOptions[i]=a,this.styleAttributeService&&!Wm(s,this.scaleOptions)){var l=_l(i)?i:(0,ve.Z)({},i,a);this.styleAttributeService.updateScaleAttribute(l)}return this}},{key:"renderLayers",value:function(){this.rendering=!0,this.layerService.reRender(),this.rendering=!1}},{key:"render",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.tileLayer?(this.tileLayer.render(),this):(this.layerService.beforeRenderData(this),this.encodeDataLength<=0&&!this.forceRender?this:(this.renderModels(i),this))}},{key:"renderMultiPass",value:function(){var n=(0,hr.Z)(it().mark(function a(){return it().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:if(!(this.encodeDataLength<=0&&!this.forceRender)){l.next=2;break}return l.abrupt("return");case 2:if(!(this.multiPassRenderer&&this.multiPassRenderer.getRenderFlag())){l.next=7;break}return l.next=5,this.multiPassRenderer.render();case 5:l.next=8;break;case 7:this.multiPassRenderer?this.renderModels():this.renderModels();case 8:case"end":return l.stop()}},a,this)}));function i(){return n.apply(this,arguments)}return i}()},{key:"active",value:function(i){var a={};return a.enableHighlight=_l(i)?!0:i,_l(i)?(a.enableHighlight=!0,i.color&&(a.highlightColor=i.color),i.mix&&(a.activeMix=i.mix)):a.enableHighlight=!!i,this.updateLayerConfig(a),this}},{key:"setActive",value:function(i,a){var s=this;if(_l(i)){var l=i.x,p=l===void 0?0:l,m=i.y,T=m===void 0?0:m;this.updateLayerConfig({highlightColor:_l(a)?a.color:this.getLayerConfig().highlightColor,activeMix:_l(a)?a.mix:this.getLayerConfig().activeMix}),this.pick({x:p,y:T})}else this.updateLayerConfig({pickedFeatureID:i,highlightColor:_l(a)?a.color:this.getLayerConfig().highlightColor,activeMix:_l(a)?a.mix:this.getLayerConfig().activeMix}),this.hooks.beforeHighlight.call(Ws(i)).then(function(){setTimeout(function(){s.reRender()},1)})}},{key:"select",value:function(i){var a={};return a.enableSelect=_l(i)?!0:i,_l(i)?(a.enableSelect=!0,i.color&&(a.selectColor=i.color),i.mix&&(a.selectMix=i.mix)):a.enableSelect=!!i,this.updateLayerConfig(a),this}},{key:"setSelect",value:function(i,a){var s=this;if(_l(i)){var l=i.x,p=l===void 0?0:l,m=i.y,T=m===void 0?0:m;this.updateLayerConfig({selectColor:_l(a)?a.color:this.getLayerConfig().selectColor,selectMix:_l(a)?a.mix:this.getLayerConfig().selectMix}),this.pick({x:p,y:T})}else this.updateLayerConfig({pickedFeatureID:i,selectColor:_l(a)?a.color:this.getLayerConfig().selectColor,selectMix:_l(a)?a.mix:this.getLayerConfig().selectMix}),this.hooks.beforeSelect.call(Ws(i)).then(function(){setTimeout(function(){s.reRender()},1)})}},{key:"setBlend",value:function(i){return this.updateLayerConfig({blend:i}),this.reRender(),this}},{key:"show",value:function(){return this.updateLayerConfig({visible:!0}),this.reRender(),this.emit("show"),this}},{key:"hide",value:function(){return this.updateLayerConfig({visible:!1}),this.reRender(),this.emit("hide"),this}},{key:"setIndex",value:function(i){return this.zIndex=i,this.layerService.updateLayerRenderList(),this.layerService.renderLayers(),this}},{key:"setCurrentPickId",value:function(i){this.currentPickId=i}},{key:"getCurrentPickId",value:function(){return this.currentPickId}},{key:"setCurrentSelectedId",value:function(i){this.selectedFeatureID=i}},{key:"getCurrentSelectedId",value:function(){return this.selectedFeatureID}},{key:"isVisible",value:function(){var i=this.mapService.getZoom(),a=this.getLayerConfig(),s=a.visible,l=a.minZoom,p=l===void 0?-1/0:l,m=a.maxZoom,T=m===void 0?1/0:m;return!!s&&i>=p&&i<T}},{key:"setMultiPass",value:function(i,a){if(this.updateLayerConfig({enableMultiPassRenderer:i}),a&&this.updateLayerConfig({passes:a}),i){var s=this.getLayerConfig(),l=s.passes,p=l===void 0?[]:l;this.multiPassRenderer=L1(this,p,this.postProcessingPassFactory,this.normalPassFactory),this.multiPassRenderer.setRenderFlag(!0);var m=this.rendererService.getViewportSize(),T=m.width,R=m.height;this.multiPassRenderer.resize(T,R)}return this}},{key:"setMinZoom",value:function(i){return this.updateLayerConfig({minZoom:i}),this}},{key:"getMinZoom",value:function(){var i=this.getLayerConfig(),a=i.minZoom;return a}},{key:"getMaxZoom",value:function(){var i=this.getLayerConfig(),a=i.maxZoom;return a}},{key:"get",value:function(i){var a=this.getLayerConfig();return a[i]}},{key:"setMaxZoom",value:function(i){return this.updateLayerConfig({maxZoom:i}),this}},{key:"setAutoFit",value:function(i){return this.updateLayerConfig({autoFit:i}),this}},{key:"fitBounds",value:function(i){if(!this.inited)return this.updateLayerConfig({autoFit:!0}),this;var a=this.getSource(),s=a.extent,l=s.some(function(p){return Math.abs(p)===1/0});return l?this:(this.mapService.fitBounds([[s[0],s[1]],[s[2],s[3]]],i),this)}},{key:"destroy",value:function(){var i,a,s,l,p=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(!this.isDestroyed){this.layerModel.uniformBuffers.forEach(function(R){R.destroy()}),this.layerChildren.map(function(R){return R.destroy(!1)}),this.layerChildren=[];var m=this.getLayerConfig(),T=m.maskfence;T&&(this.masks.map(function(R){return R.destroy(!1)}),this.masks=[]),this.hooks.beforeDestroy.call(),this.layerSource.off("update",this.sourceEvent),(i=this.multiPassRenderer)===null||i===void 0||i.destroy(),this.textureService.destroy(),this.styleAttributeService.clearAllAttributes(),this.hooks.afterDestroy.call(),(a=this.layerModel)===null||a===void 0||a.clearModels(p),(s=this.tileLayer)===null||s===void 0||s.destroy(),this.models=[],(l=this.debugService)===null||l===void 0||l.removeLog(this.id),this.emit("remove",{target:this,type:"remove"}),this.emit("destroy",{target:this,type:"destroy"}),this.removeAllListeners(),this.isDestroyed=!0}}},{key:"clear",value:function(){this.styleAttributeService.clearAllAttributes()}},{key:"clearModels",value:function(){var i;this.models.forEach(function(a){return a.destroy()}),(i=this.layerModel)===null||i===void 0||i.clearModels(),this.models=[]}},{key:"isDirty",value:function(){return!!(this.styleAttributeService.getLayerStyleAttributes()||[]).filter(function(i){return i.needRescale||i.needRemapping||i.needRegenerateVertices}).length}},{key:"setSource",value:function(i){var a=this;if(this.layerSource&&this.layerSource.off("update",this.sourceEvent),this.layerSource=i,this.clusterZoom=0,this.inited&&this.layerSource.cluster){var s=this.mapService.getZoom();this.layerSource.updateClusterData(s)}this.layerSource.inited&&this.sourceEvent(),this.layerSource.on("update",function(l){var p=l.type;if(a.coordCenter===void 0){var m,T=a.layerSource.center;a.coordCenter=T,(m=a.mapService)!==null&&m!==void 0&&m.setCoordCenter&&a.mapService.setCoordCenter(T)}if(p==="update"){if(a.tileLayer){a.tileLayer.reload();return}a.sourceEvent()}})}},{key:"getSource",value:function(){return this.layerSource}},{key:"getScaleOptions",value:function(){return this.scaleOptions}},{key:"setEncodedData",value:function(i){this.encodedData=i,this.encodeDataLength=i.length}},{key:"getEncodedData",value:function(){return this.encodedData}},{key:"getScale",value:function(i){return this.styleAttributeService.getLayerAttributeScale(i)}},{key:"getLegend",value:function(i){var a,s,l,p=this.styleAttributeService.getLayerStyleAttribute(i),m=(p==null||(a=p.scale)===null||a===void 0?void 0:a.scalers)||[];return{type:(s=m[0].option)===null||s===void 0?void 0:s.type,field:p==null||(l=p.scale)===null||l===void 0?void 0:l.field,items:this.getLegendItems(i)}}},{key:"getLegendItems",value:function(i){var a=this.styleAttributeService.getLayerAttributeScale(i);if(!a)return[];if(a.invertExtent){var s=a.range().map(function(m){return(0,ve.Z)({value:a.invertExtent(m)},i,m)});return s}else if(a.ticks){var l=a.ticks().map(function(m){return(0,ve.Z)({value:m},i,a(m))});return l}else if(a!=null&&a.domain){var p=a.domain().filter(function(m){return!wb(m)}).map(function(m){return(0,ve.Z)({value:m},i,a(m))});return p}return[]}},{key:"pick",value:function(i){var a=i.x,s=i.y;this.interactionService.triggerHover({x:a,y:s})}},{key:"boxSelect",value:function(i,a){this.pickingService.boxPickLayer(this,i,a)}},{key:"buildLayerModel",value:function(){var n=(0,hr.Z)(it().mark(function a(s){var l=this,p,m,T,R,L,z,re,ee,me,Ie,He,Xe;return it().wrap(function(pt){for(;;)switch(pt.prev=pt.next){case 0:return p=s.moduleName,m=s.vertexShader,T=s.fragmentShader,R=s.inject,L=s.triangulation,z=s.styleOption,re=(0,Cc.Z)(s,xb),this.shaderModuleService.registerModule(p,{vs:m,fs:T,inject:R}),ee=this.shaderModuleService.getModule(p),me=ee.vs,Ie=ee.fs,He=ee.uniforms,Xe=this.rendererService.createModel,pt.abrupt("return",new Promise(function(dt){var It=l.styleAttributeService.createAttributesAndIndices(l.encodedData,L,z),Vt=It.attributes,Kt=It.elements,yr=It.count,_r=(0,Q.Z)({attributes:Vt,uniforms:He,fs:Ie,vs:me,elements:Kt,blend:N1[D0.normal],uniformBuffers:[].concat((0,cr.Z)(l.layerModel.uniformBuffers),(0,cr.Z)(l.rendererService.uniformBuffers)),textures:l.layerModel.textures},re);yr&&(_r.count=yr);var Hr=Xe(_r);dt(Hr)}));case 5:case"end":return pt.stop()}},a,this)}));function i(a){return n.apply(this,arguments)}return i}()},{key:"createAttributes",value:function(i){var a=i.triangulation,s=this.styleAttributeService.createAttributes(this.encodedData,a),l=s.attributes;return l}},{key:"getTime",value:function(){return this.layerService.clock.getDelta()}},{key:"setAnimateStartTime",value:function(){this.animateStartTime=this.layerService.clock.getElapsedTime()}},{key:"stopAnimate",value:function(){this.animateStatus&&(this.layerService.stopAnimate(),this.animateStatus=!1,this.updateLayerConfig({animateOption:{enable:!1}}))}},{key:"getLayerAnimateTime",value:function(){return this.layerService.clock.getElapsedTime()-this.animateStartTime}},{key:"needPick",value:function(i){var a=this.getLayerConfig(),s=a.enableHighlight,l=s===void 0?!0:s,p=a.enableSelect,m=p===void 0?!0:p,T=this.eventNames().indexOf(i)!==-1||this.eventNames().indexOf("un"+i)!==-1;return(i==="click"||i==="dblclick")&&m&&(T=!0),i==="mousemove"&&(l||this.eventNames().indexOf("mouseenter")!==-1||this.eventNames().indexOf("unmousemove")!==-1||this.eventNames().indexOf("mouseout")!==-1)&&(T=!0),this.isVisible()&&T}},{key:"buildModels",value:function(){var n=(0,hr.Z)(it().mark(function a(){return it().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:throw new Error("Method not implemented.");case 1:case"end":return l.stop()}},a)}));function i(){return n.apply(this,arguments)}return i}()},{key:"rebuildModels",value:function(){var n=(0,hr.Z)(it().mark(function a(){return it().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.next=2,this.buildModels();case 2:case"end":return l.stop()}},a,this)}));function i(){return n.apply(this,arguments)}return i}()},{key:"renderMulPass",value:function(){var n=(0,hr.Z)(it().mark(function a(s){return it().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return p.next=2,s.render();case 2:case"end":return p.stop()}},a)}));function i(a){return n.apply(this,arguments)}return i}()},{key:"renderModels",value:function(){var i=this,a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.encodeDataLength<=0&&!this.forceRender?(this.clearModels(),this):(this.hooks.beforeRender.call(),this.models.forEach(function(s){s.draw({uniforms:i.layerModel.getUninforms(),blend:i.layerModel.getBlend(),stencil:i.layerModel.getStencil(a)},(a==null?void 0:a.ispick)||!1)}),this.hooks.afterRender.call(),this)}},{key:"updateStyleAttribute",value:function(i,a,s,l){var p=this.configService.getAttributeConfig(this.id)||{};return Wm(p[i],{field:a,values:s})?!1:(["color","size","texture","rotate","filter","label","shape"].indexOf(i)!==-1&&this.configService.setAttributeConfig(this.id,(0,ve.Z)({},i,{field:a,values:s})),this.startInit?this.styleAttributeService.updateStyleAttribute(i,{scale:(0,Q.Z)({field:a},this.splitValuesAndCallbackInAttribute(s,this.getLayerConfig()[a]))},l):this.pendingStyleAttributes.push({attributeName:i,attributeField:a,attributeValues:s,updateOptions:l}),!0)}},{key:"getLayerAttributeConfig",value:function(){return this.configService.getAttributeConfig(this.id)}},{key:"getShaderPickStat",value:function(){return this.layerService.getShaderPickStat()}},{key:"setEarthTime",value:function(i){console.warn("empty fn")}},{key:"processData",value:function(i){return i}},{key:"getModelType",value:function(){throw new Error("Method not implemented.")}},{key:"getDefaultConfig",value:function(){return{}}},{key:"initLayerModels",value:function(){var n=(0,hr.Z)(it().mark(function a(){return it().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return this.models.forEach(function(p){return p.destroy()}),this.models=[],l.next=4,this.layerModel.initModels();case 4:this.models=l.sent;case 5:case"end":return l.stop()}},a,this)}));function i(){return n.apply(this,arguments)}return i}()},{key:"reRender",value:function(){this.inited&&this.layerService.reRender()}},{key:"splitValuesAndCallbackInAttribute",value:function(i){return{values:U1(i)?void 0:i,callback:U1(i)?i:void 0}}}]),r}(Si.EventEmitter),B1=Ji(Hm.prototype,"configService",[F1],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Hm);function Ib(e,t){return{enable:e,mask:255,func:{cmp:Fe.EQUAL,ref:t?1:0,mask:1}}}function G1(e){return e.maskOperation===Jh.OR?{enable:!0,mask:255,func:{cmp:Fe.ALWAYS,ref:1,mask:255},opFront:{fail:Fe.KEEP,zfail:Fe.REPLACE,zpass:Fe.REPLACE}}:{enable:!0,mask:255,func:{cmp:e.stencilType===L0.SINGLE||e.stencilIndex===0?Fe.ALWAYS:Fe.LESS,ref:e.stencilType===L0.SINGLE?1:e.stencilIndex===0?2:1,mask:255},opFront:{fail:Fe.KEEP,zfail:Fe.REPLACE,zpass:Fe.REPLACE}}}var Pb={opacity:1,stroke:[1,0,0,1],offsets:[0,0],rotation:0,extrusionBase:0,strokeOpacity:1,thetaOffset:.314},Kv={opacity:"float",stroke:"vec4",offsets:"vec2",textOffset:"vec2",rotation:"float",extrusionBase:"float",strokeOpacity:"float",thetaOffset:"float"},tl=function(e){return e[e.POSITION=0]="POSITION",e[e.COLOR=1]="COLOR",e[e.VERTEX_ID=2]="VERTEX_ID",e[e.PICKING_COLOR=3]="PICKING_COLOR",e[e.STROKE=4]="STROKE",e[e.OPACITY=5]="OPACITY",e[e.OFFSETS=6]="OFFSETS",e[e.ROTATION=7]="ROTATION",e[e.EXTRUSION_BASE=8]="EXTRUSION_BASE",e[e.SIZE=9]="SIZE",e[e.SHAPE=10]="SHAPE",e[e.EXTRUDE=11]="EXTRUDE",e[e.MAX=12]="MAX",e}({});function Ob(e){switch(e){case"rotation":return{name:"Rotation",type:bn.Attribute,descriptor:{name:"a_Rotation",shaderLocation:tl.ROTATION,buffer:{usage:Fe.DYNAMIC_DRAW,data:[],type:Fe.FLOAT},size:1,update:function(r){var n=r.rotation,i=n===void 0?0:n;return Array.isArray(i)?[i[0]]:[i]}}};case"stroke":return{name:"stroke",type:bn.Attribute,descriptor:{name:"a_Stroke",shaderLocation:tl.STROKE,buffer:{usage:Fe.DYNAMIC_DRAW,data:[],type:Fe.FLOAT},size:4,update:function(r){var n=r.stroke,i=n===void 0?[1,1,1,1]:n;return i}}};case"opacity":return{name:"opacity",type:bn.Attribute,descriptor:{name:"a_Opacity",shaderLocation:tl.OPACITY,buffer:{usage:Fe.STATIC_DRAW,data:[],type:Fe.FLOAT},size:1,update:function(r){var n=r.opacity,i=n===void 0?1:n;return[i]}}};case"extrusionBase":return{name:"extrusionBase",type:bn.Attribute,descriptor:{name:"a_ExtrusionBase",shaderLocation:tl.EXTRUSION_BASE,buffer:{usage:Fe.STATIC_DRAW,data:[],type:Fe.FLOAT},size:1,update:function(r){var n=r.extrusionBase,i=n===void 0?0:n;return[i]}}};case"offsets":return{name:"offsets",type:bn.Attribute,descriptor:{name:"a_Offsets",shaderLocation:tl.OFFSETS,buffer:{usage:Fe.STATIC_DRAW,data:[],type:Fe.FLOAT},size:2,update:function(r){var n=r.offsets;return n}}};case"thetaOffset":return{name:"thetaOffset",type:bn.Attribute,descriptor:{name:"a_ThetaOffset",buffer:{usage:Fe.STATIC_DRAW,data:[],type:Fe.FLOAT},size:1,update:function(r){var n=r.thetaOffset,i=n===void 0?1:n;return[i]}}};default:return}}var V1,jm,H1,W1={opacity:tl.OPACITY,stroke:tl.STROKE,offsets:tl.OFFSETS,rotation:tl.ROTATION,extrusionBase:tl.EXTRUSION_BASE},Lo=(V1=zm(xt.IGlobalConfigService),jm=function(){function e(t){(0,ue.Z)(this,e),(0,ve.Z)(this,"uniformBuffers",[]),(0,ve.Z)(this,"textures",[]),(0,ve.Z)(this,"preStyleAttribute",{}),(0,ve.Z)(this,"encodeStyleAttribute",{}),fa(this,"configService",H1,this),this.layer=t,this.rendererService=t.getContainer().get(xt.IRendererService),this.pickingService=t.getContainer().get(xt.IPickingService),this.shaderModuleService=t.getContainer().get(xt.IShaderModuleService),this.styleAttributeService=t.getContainer().get(xt.IStyleAttributeService),this.mapService=t.getContainer().get(xt.IMapService),this.iconService=t.getContainer().get(xt.IIconService),this.fontService=t.getContainer().get(xt.IFontService),this.cameraService=t.getContainer().get(xt.ICameraService),this.layerService=t.getContainer().get(xt.ILayerService),this.registerStyleAttribute(),this.registerBuiltinAttributes(),this.startModelAnimate();var r=this.rendererService.createTexture2D;this.createTexture2D=r}return(0,_e.Z)(e,[{key:"getBlend",value:function(){var r=this.layer.getLayerConfig(),n=r.blend,i=n===void 0?"normal":n;return N1[D0[i]]}},{key:"getStencil",value:function(r){var n=this.layer.getLayerConfig(),i=n.mask,a=i===void 0?!1:i,s=n.maskInside,l=s===void 0?!0:s,p=n.enableMask,m=n.maskOperation,T=m===void 0?Jh.AND:m;if(this.layer.type==="MaskLayer")return G1({isStencil:!0,stencilType:L0.SINGLE});if(r.isStencil)return G1((0,Q.Z)((0,Q.Z)({},r),{},{maskOperation:T}));var R=a||p&&this.layer.masks.length!==0||this.layer.tileMask!==void 0;return Ib(R,l)}},{key:"getDefaultStyle",value:function(){return{}}},{key:"getUninforms",value:function(){throw new Error("Method not implemented.")}},{key:"getAnimateUniforms",value:function(){return{}}},{key:"needUpdate",value:function(){var t=(0,hr.Z)(it().mark(function n(){return it().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",!1);case 1:case"end":return a.stop()}},n)}));function r(){return t.apply(this,arguments)}return r}()},{key:"buildModels",value:function(){var t=(0,hr.Z)(it().mark(function n(){return it().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:throw new Error("Method not implemented.");case 1:case"end":return a.stop()}},n)}));function r(){return t.apply(this,arguments)}return r}()},{key:"initModels",value:function(){var t=(0,hr.Z)(it().mark(function n(){return it().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:throw new Error("Method not implemented.");case 1:case"end":return a.stop()}},n)}));function r(){return t.apply(this,arguments)}return r}()},{key:"clearModels",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0}},{key:"getAttribute",value:function(){throw new Error("Method not implemented.")}},{key:"render",value:function(r){throw new Error("Method not implemented.")}},{key:"registerBuiltinAttributes",value:function(){throw new Error("Method not implemented.")}},{key:"animateOption2Array",value:function(r){return[r.enable?0:1,r.duration||4,r.interval||.2,r.trailLength||.1]}},{key:"startModelAnimate",value:function(){var r=this.layer.getLayerConfig(),n=r.animateOption;n.enable&&this.layer.setAnimateStartTime()}},{key:"getInject",value:function(){var r=this.layer.encodeStyleAttribute,n="",i=[];this.layer.enableShaderEncodeStyles.forEach(function(l){r[l]?n+="#define USE_ATTRIBUTE_".concat(l.toUpperCase(),` 0.0; 

`):i.push("  ".concat(Kv[l]," u_").concat(l,";")),n+=`
          #ifdef USE_ATTRIBUTE_`.concat(l.toUpperCase(),`
          layout(location = `).concat(W1[l],") in ").concat(Kv[l]," a_").concat(l.charAt(0).toUpperCase()+l.slice(1),`;
        #endif

        `)});var a=i.length?`
layout(std140) uniform AttributeUniforms {
`.concat(i.join(`
`),`
};
    `):"";n+=a;var s="";return this.layer.enableShaderEncodeStyles.forEach(function(l){s+=`

    #ifdef USE_ATTRIBUTE_`.concat(l.toUpperCase(),`
      `).concat(Kv[l]," ").concat(l,"  = a_").concat(l.charAt(0).toUpperCase()+l.slice(1),`;
    #else
      `).concat(Kv[l]," ").concat(l," = u_").concat(l,`;
    #endif

    `)}),{"vs:#decl":n,"fs:#decl":a,"vs:#main-start":s}}},{key:"getStyleAttribute",value:function(){var r=this,n={};return this.layer.enableShaderEncodeStyles.forEach(function(i){if(!r.layer.encodeStyleAttribute[i]){var a=r.layer.getLayerConfig()[i],s=typeof a=="undefined"?Pb[i]:a;i==="stroke"&&(s=Qi(s)),n["u_"+i]=s}}),n}},{key:"registerStyleAttribute",value:function(){var r=this;Object.keys(this.layer.encodeStyleAttribute).forEach(function(n){var i=Ob(n);i&&(r.styleAttributeService.registerStyleAttribute(i),i.descriptor&&(i.descriptor.shaderLocation=W1[n]))})}},{key:"updateEncodeAttribute",value:function(r,n){this.encodeStyleAttribute[r]=n}}]),e}(),H1=Ji(jm.prototype,"configService",[V1],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),jm),Xm=100,nL=36,iL=40;function j1(e){return e/180*Math.acos(-1)}function X1(e){var t=j1(e[0])+Math.PI/2,r=j1(e[1]),n=Xm+Math.random()*.4,i=n*Math.cos(r)*Math.cos(t),a=n*Math.cos(r)*Math.sin(t),s=n*Math.sin(r);return[a,s,i]}function aL(e,t){var r=mat4.create(),n=mat4.create(),i=vec3.fromValues(0,1,0),a=vec3.fromValues(0,0,0);t=t||{},e=typeof e!="undefined"?e:1;for(var s=typeof t.segments!="undefined"?t.segments:32,l=2+s,p=2*l,m=[],T=[],R=[],L=[],z=[],re=[],ee=0;ee<=l;ee++){for(var me=ee/l,Ie=me*Math.PI,He=0;He<=p;He++){var Xe=He/p,ot=Xe*Math.PI*2;mat4.identity(n),mat4.rotateZ(n,n,-Ie),mat4.identity(r),mat4.rotateY(r,r,ot),vec3.transformMat4(a,i,n),vec3.transformMat4(a,a,r),vec3.scale(a,a,-e),R.push(a.slice()),L.push.apply(L,_toConsumableArray(a.slice())),vec3.normalize(a,a),z.push.apply(z,_toConsumableArray(a.slice())),re.push([Xe,1-me]),L.push(Xe,1-me)}if(ee>0)for(var pt=R.length,dt=pt-2*(p+1);dt+p+2<pt;dt++)m.push([dt,dt+1,dt+p+1]),T.push(dt,dt+1,dt+p+1),m.push([dt+p+1,dt+1,dt+p+2]),T.push(dt+p+1,dt+1,dt+p+2)}return{cells:m,positions:R,uvs:re,positionsArr:L,indicesArr:T,normalArr:z}}var Jv=ji(),oL=ji(),Cu=ji(),xh=ji(),hp=ji();function Ym(e,t,r,n,i){Qa(e,r,n),$u(e,e),t=ec(-e[1],e[0]);var a=ec(-r[1],r[0]);return[i/Dl(t,a),t]}function Th(e,t){return zc(e,-t[1],t[0])}function Ap(e,t,r){return Gc(e,t,r),$u(e,e),e}function $m(e,t){return e[0]===t[0]&&e[1]===t[1]}function sL(e){for(var t=new Map,r=0;r<e.length;r++){var n=e[0].toString()+"-"+e[1].toString();t.get(n)?(e.splice(r,1),r++):t.set(n,n)}return e}var Nb=function(){function e(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};(0,ue.Z)(this,e),(0,ve.Z)(this,"lastFlip",-1),(0,ve.Z)(this,"miter",ec(0,0)),(0,ve.Z)(this,"started",!1),(0,ve.Z)(this,"dash",!1),(0,ve.Z)(this,"totalDistance",0),(0,ve.Z)(this,"currentIndex",0),this.join=t.join||"miter",this.cap=t.cap||"butt",this.miterLimit=t.miterLimit||10,this.thickness=t.thickness||1,this.dash=t.dash||!1,this.complex={positions:[],indices:[],normals:[],startIndex:0,indexes:[]}}return(0,_e.Z)(e,[{key:"simpleExtrude",value:function(r){var n=this.complex;if(r.length<=1)return n;this.lastFlip=-1,this.started=!1,this.normal=null,this.totalDistance=0;for(var i=r.length,a=n.startIndex,s=1;s<i;s++){var l=r[s-1],p=r[s],m=s<r.length-1?r[s+1]:null,T=this.simpleSegment(n,a,l,p,m);a+=T}if(this.dash)for(var R=0;R<n.positions.length/6;R++)n.positions[R*6+5]=this.totalDistance;return n.startIndex=n.positions.length/6,n}},{key:"simpleExtrude_gaode2",value:function(r,n){var i=this.complex;if(r.length<=1)return i;this.lastFlip=-1,this.started=!1,this.normal=null,this.totalDistance=0;for(var a=r.length,s=i.startIndex,l=1;l<a;l++){var p,m,T,R=r[l-1];R.push((p=n[l-1][2])!==null&&p!==void 0?p:0);var L=n[l-1],z=r[l];z.push((m=n[l][2])!==null&&m!==void 0?m:0);var re=n[l],ee=l<r.length-1?[].concat((0,cr.Z)(r[l+1]),[(T=n[l+1][2])!==null&&T!==void 0?T:0]):null,me=l<n.length-1?n[l+1]:null,Ie=this.simpleSegment(i,s,R,z,ee,L,re,me);s+=Ie}if(this.dash)for(var He=0;He<i.positions.length/6;He++)i.positions[He*6+5]=this.totalDistance;return i.startIndex=i.positions.length/6,i}},{key:"extrude_gaode2",value:function(r,n){var i=this.complex;if(r.length<=1)return i;this.lastFlip=-1,this.started=!1,this.normal=null,this.totalDistance=0;for(var a=r.length,s=i.startIndex,l=1;l<a;l++){var p,m,T,R=r[l-1];R.push((p=n[l-1][2])!==null&&p!==void 0?p:0);var L=n[l-1],z=r[l];z.push((m=n[l][2])!==null&&m!==void 0?m:0);var re=n[l],ee=l<r.length-1?[].concat((0,cr.Z)(r[l+1]),[(T=n[l+1][2])!==null&&T!==void 0?T:0]):null,me=l<n.length-1?n[l+1]:null,Ie=this.segment_gaode2(i,s,R,z,ee,L,re,me);s+=Ie}if(this.dash)for(var He=0;He<i.positions.length/6;He++)i.positions[He*6+5]=this.totalDistance;return i.startIndex=i.positions.length/6,i}},{key:"extrude",value:function(r){var n=this.complex;if(r.length<=1)return n;this.lastFlip=-1,this.started=!1,this.normal=null,this.totalDistance=0;for(var i=r.length,a=n.startIndex,s=1;s<i;s++){var l=r[s-1],p=r[s],m=s<r.length-1?r[s+1]:null,T=this.segment(n,a,l,p,m);a+=T}if(this.dash)for(var R=0;R<n.positions.length/6;R++)n.positions[R*6+5]=this.totalDistance;return n.startIndex=n.positions.length/6,n}},{key:"simpleSegment",value:function(r,n,i,a,s){var l=0,p=r.indices,m=r.positions,T=r.normals,R=Na([a[0],a[1]]),L=Na([i[0],i[1]]);Ap(Cu,R,L);var z=0;if(this.dash&&(z=this.lineSegmentDistance(R,L),this.totalDistance+=z),this.normal||(this.normal=ji(),Th(this.normal,Cu)),this.started||(this.started=!0,this.extrusions(m,T,i,this.normal,this.thickness,this.totalDistance-z)),p.push(n+0,n+1,n+2),!s)Th(this.normal,Cu),this.extrusions(m,T,a,this.normal,this.thickness,this.totalDistance),p.push.apply(p,(0,cr.Z)(this.lastFlip===1?[n,n+2,n+3]:[n+2,n+1,n+3])),l+=2;else{var re=Na([s[0],s[1]]);$m(R,re)&&Qa(re,R,$u(re,Xu(re,R,L))),Ap(xh,re,R);var ee=Ym(hp,ji(),Cu,xh,this.thickness),me=(0,yn.Z)(ee,2),Ie=me[0],He=me[1],Xe=Dl(hp,this.normal)<0?-1:1;this.extrusions(m,T,a,He,Ie,this.totalDistance),p.push.apply(p,(0,cr.Z)(this.lastFlip===1?[n,n+2,n+3]:[n+2,n+1,n+3])),Xe=-1,fs(this.normal,He),l+=2,this.lastFlip=Xe}return l}},{key:"segment_gaode2",value:function(r,n,i,a,s,l,p,m){var T=0,R=r.indices,L=r.positions,z=r.normals,re=this.cap==="square",ee=this.join==="bevel",me=Na([p[0],p[1]]),Ie=Na([l[0],l[1]]);Ap(Cu,a,i);var He=0;if(this.dash&&(He=this.lineSegmentDistance(me,Ie),this.totalDistance+=He),this.normal||(this.normal=ji(),Th(this.normal,Cu)),!this.started)if(this.started=!0,re){var Xe=ji(),ot=ji();Qa(Xe,this.normal,Cu),Qa(ot,this.normal,Cu),z.push(ot[0],ot[1],0),z.push(Xe[0],Xe[1],0),L.push(i[0],i[1],i[2]|0,this.totalDistance-He,-this.thickness,i[2]|0),this.complex.indexes.push(this.currentIndex),L.push(i[0],i[1],i[2]|0,this.totalDistance-He,this.thickness,i[2]|0),this.complex.indexes.push(this.currentIndex),this.currentIndex++}else this.extrusions(L,z,i,this.normal,this.thickness,this.totalDistance-He);if(R.push(n+0,n+1,n+2),s){$m(a,s)&&Qa(s,a,$u(s,Xu(s,a,i))),Ap(xh,s,a);var It=Ym(hp,ji(),Cu,xh,this.thickness),Vt=(0,yn.Z)(It,2),Kt=Vt[0],yr=Vt[1],_r=Dl(hp,this.normal)<0?-1:1,Hr=ee;if(!Hr&&this.join==="miter"){var nn=Kt;nn>this.miterLimit&&(Hr=!0)}Hr?(z.push(this.normal[0],this.normal[1],0),z.push(yr[0],yr[1],0),L.push(a[0],a[1],a[2]|0,this.totalDistance,-this.thickness*_r,a[2]|0),this.complex.indexes.push(this.currentIndex),L.push(a[0],a[1],a[2]|0,this.totalDistance,this.thickness*_r,a[2]|0),this.complex.indexes.push(this.currentIndex),this.currentIndex++,R.push.apply(R,(0,cr.Z)(this.lastFlip!==-_r?[n,n+2,n+3]:[n+2,n+1,n+3])),R.push(n+2,n+3,n+4),Th(Jv,xh),fs(this.normal,Jv),z.push(this.normal[0],this.normal[1],0),L.push(a[0],a[1],a[2]|0,this.totalDistance,-this.thickness*_r,a[2]|0),this.complex.indexes.push(this.currentIndex),this.currentIndex++,T+=3):(this.extrusions(L,z,a,yr,Kt,this.totalDistance),R.push.apply(R,(0,cr.Z)(this.lastFlip===1?[n,n+2,n+3]:[n+2,n+1,n+3])),_r=-1,fs(this.normal,yr),T+=2),this.lastFlip=_r}else{if(Th(this.normal,Cu),re){var pt=ji(),dt=ji();Gc(dt,Cu,this.normal),Qa(pt,Cu,this.normal),z.push(dt[0],dt[1],0),z.push(pt[0],pt[1],0),L.push(a[0],a[1],a[2]|0,this.totalDistance,this.thickness,a[2]|0),this.complex.indexes.push(this.currentIndex),L.push(a[0],a[1],a[2]|0,this.totalDistance,this.thickness,a[2]|0),this.complex.indexes.push(this.currentIndex),this.currentIndex++}else this.extrusions(L,z,a,this.normal,this.thickness,this.totalDistance);R.push.apply(R,(0,cr.Z)(this.lastFlip===1?[n,n+2,n+3]:[n+2,n+1,n+3])),T+=2}return T}},{key:"segment",value:function(r,n,i,a,s){var l=0,p=r.indices,m=r.positions,T=r.normals,R=this.cap==="square",L=this.join==="bevel",z=Na([a[0],a[1]]),re=Na([i[0],i[1]]);Ap(Cu,z,re);var ee=0;if(this.dash&&(ee=this.lineSegmentDistance(z,re),this.totalDistance+=ee),this.normal||(this.normal=ji(),Th(this.normal,Cu)),!this.started)if(this.started=!0,R){var me=ji(),Ie=ji();Qa(me,this.normal,Cu),Qa(Ie,this.normal,Cu),T.push(Ie[0],Ie[1],0),T.push(me[0],me[1],0),m.push(i[0],i[1],i[2]|0,this.totalDistance-ee,-this.thickness,i[2]|0),this.complex.indexes.push(this.currentIndex),m.push(i[0],i[1],i[2]|0,this.totalDistance-ee,this.thickness,i[2]|0),this.complex.indexes.push(this.currentIndex),this.currentIndex++}else this.extrusions(m,T,i,this.normal,this.thickness,this.totalDistance-ee);if(p.push(n+0,n+1,n+2),s){var ot=Na([s[0],s[1]]);$m(z,ot)&&Qa(ot,z,$u(ot,Xu(ot,z,re))),Ap(xh,ot,z);var pt=Ym(hp,ji(),Cu,xh,this.thickness),dt=(0,yn.Z)(pt,2),It=dt[0],Vt=dt[1],Kt=Dl(hp,this.normal)<0?-1:1,yr=L;if(!yr&&this.join==="miter"){var _r=It;_r>this.miterLimit&&(yr=!0)}yr?(T.push(this.normal[0],this.normal[1],0),T.push(Vt[0],Vt[1],0),m.push(a[0],a[1],a[2]|0,this.totalDistance,-this.thickness*Kt,a[2]|0),this.complex.indexes.push(this.currentIndex),m.push(a[0],a[1],a[2]|0,this.totalDistance,this.thickness*Kt,a[2]|0),this.complex.indexes.push(this.currentIndex),this.currentIndex++,p.push.apply(p,(0,cr.Z)(this.lastFlip!==-Kt?[n,n+2,n+3]:[n+2,n+1,n+3])),p.push(n+2,n+3,n+4),Th(Jv,xh),fs(this.normal,Jv),T.push(this.normal[0],this.normal[1],0),m.push(a[0],a[1],a[2]|0,this.totalDistance,-this.thickness*Kt,a[2]|0),this.complex.indexes.push(this.currentIndex),this.currentIndex++,l+=3):(this.extrusions(m,T,a,Vt,It,this.totalDistance),p.push.apply(p,(0,cr.Z)(this.lastFlip===1?[n,n+2,n+3]:[n+2,n+1,n+3])),Kt=-1,fs(this.normal,Vt),l+=2),this.lastFlip=Kt}else{if(Th(this.normal,Cu),R){var He=ji(),Xe=ji();Gc(Xe,Cu,this.normal),Qa(He,Cu,this.normal),T.push(Xe[0],Xe[1],0),T.push(He[0],He[1],0),m.push(a[0],a[1],a[2]|0,this.totalDistance,this.thickness,a[2]|0),this.complex.indexes.push(this.currentIndex),m.push(a[0],a[1],a[2]|0,this.totalDistance,this.thickness,a[2]|0),this.complex.indexes.push(this.currentIndex),this.currentIndex++}else this.extrusions(m,T,a,this.normal,this.thickness,this.totalDistance);p.push.apply(p,(0,cr.Z)(this.lastFlip===1?[n,n+2,n+3]:[n+2,n+1,n+3])),l+=2}return l}},{key:"extrusions",value:function(r,n,i,a,s,l){n.push(a[0],a[1],0),n.push(a[0],a[1],0),r.push(i[0],i[1],i[2]|0,l,-s,i[2]|0),this.complex.indexes.push(this.currentIndex),r.push(i[0],i[1],i[2]|0,l,s,i[2]|0),this.complex.indexes.push(this.currentIndex),this.currentIndex++}},{key:"lineSegmentDistance",value:function(r,n){var i=n[0]-r[0],a=n[1]-r[1];return Math.sqrt(i*i+a*a)}}]),e}();function pp(){var e=new xs(3);return xs!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0),e}function Db(e){var t=new xs(3);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t}function Y1(e){var t=e[0],r=e[1],n=e[2];return Math.hypot(t,r,n)}function rl(e,t,r){var n=new xs(3);return n[0]=e,n[1]=t,n[2]=r,n}function Lb(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e}function Fb(e,t,r,n){return e[0]=t,e[1]=r,e[2]=n,e}function Bb(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e[2]=t[2]+r[2],e}function $1(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e[2]=t[2]-r[2],e}function Q1(e,t,r){return e[0]=t[0]*r[0],e[1]=t[1]*r[1],e[2]=t[2]*r[2],e}function q1(e,t,r){return e[0]=t[0]/r[0],e[1]=t[1]/r[1],e[2]=t[2]/r[2],e}function kb(e,t){return e[0]=Math.ceil(t[0]),e[1]=Math.ceil(t[1]),e[2]=Math.ceil(t[2]),e}function Ub(e,t){return e[0]=Math.floor(t[0]),e[1]=Math.floor(t[1]),e[2]=Math.floor(t[2]),e}function Zb(e,t,r){return e[0]=Math.min(t[0],r[0]),e[1]=Math.min(t[1],r[1]),e[2]=Math.min(t[2],r[2]),e}function zb(e,t,r){return e[0]=Math.max(t[0],r[0]),e[1]=Math.max(t[1],r[1]),e[2]=Math.max(t[2],r[2]),e}function Gb(e,t){return e[0]=Math.round(t[0]),e[1]=Math.round(t[1]),e[2]=Math.round(t[2]),e}function Vb(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e}function Hb(e,t,r,n){return e[0]=t[0]+r[0]*n,e[1]=t[1]+r[1]*n,e[2]=t[2]+r[2]*n,e}function K1(e,t){var r=t[0]-e[0],n=t[1]-e[1],i=t[2]-e[2];return Math.hypot(r,n,i)}function J1(e,t){var r=t[0]-e[0],n=t[1]-e[1],i=t[2]-e[2];return r*r+n*n+i*i}function e2(e){var t=e[0],r=e[1],n=e[2];return t*t+r*r+n*n}function t2(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e}function Wb(e,t){return e[0]=1/t[0],e[1]=1/t[1],e[2]=1/t[2],e}function dp(e,t){var r=t[0],n=t[1],i=t[2],a=r*r+n*n+i*i;return a>0&&(a=1/Math.sqrt(a)),e[0]=t[0]*a,e[1]=t[1]*a,e[2]=t[2]*a,e}function r2(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function n2(e,t,r){var n=t[0],i=t[1],a=t[2],s=r[0],l=r[1],p=r[2];return e[0]=i*p-a*l,e[1]=a*s-n*p,e[2]=n*l-i*s,e}function jb(e,t,r,n){var i=t[0],a=t[1],s=t[2];return e[0]=i+n*(r[0]-i),e[1]=a+n*(r[1]-a),e[2]=s+n*(r[2]-s),e}function Xb(e,t,r,n,i,a){var s=a*a,l=s*(2*a-3)+1,p=s*(a-2)+a,m=s*(a-1),T=s*(3-2*a);return e[0]=t[0]*l+r[0]*p+n[0]*m+i[0]*T,e[1]=t[1]*l+r[1]*p+n[1]*m+i[1]*T,e[2]=t[2]*l+r[2]*p+n[2]*m+i[2]*T,e}function Yb(e,t,r,n,i,a){var s=1-a,l=s*s,p=a*a,m=l*s,T=3*a*l,R=3*p*s,L=p*a;return e[0]=t[0]*m+r[0]*T+n[0]*R+i[0]*L,e[1]=t[1]*m+r[1]*T+n[1]*R+i[1]*L,e[2]=t[2]*m+r[2]*T+n[2]*R+i[2]*L,e}function $b(e,t){t=t||1;var r=qf()*2*Math.PI,n=qf()*2-1,i=Math.sqrt(1-n*n)*t;return e[0]=Math.cos(r)*i,e[1]=Math.sin(r)*i,e[2]=n*t,e}function dd(e,t,r){var n=t[0],i=t[1],a=t[2],s=r[3]*n+r[7]*i+r[11]*a+r[15];return s=s||1,e[0]=(r[0]*n+r[4]*i+r[8]*a+r[12])/s,e[1]=(r[1]*n+r[5]*i+r[9]*a+r[13])/s,e[2]=(r[2]*n+r[6]*i+r[10]*a+r[14])/s,e}function Qb(e,t,r){var n=t[0],i=t[1],a=t[2];return e[0]=n*r[0]+i*r[3]+a*r[6],e[1]=n*r[1]+i*r[4]+a*r[7],e[2]=n*r[2]+i*r[5]+a*r[8],e}function qb(e,t,r){var n=r[0],i=r[1],a=r[2],s=r[3],l=t[0],p=t[1],m=t[2],T=i*m-a*p,R=a*l-n*m,L=n*p-i*l,z=i*L-a*R,re=a*T-n*L,ee=n*R-i*T,me=s*2;return T*=me,R*=me,L*=me,z*=2,re*=2,ee*=2,e[0]=l+T+z,e[1]=p+R+re,e[2]=m+L+ee,e}function Kb(e,t,r,n){var i=[],a=[];return i[0]=t[0]-r[0],i[1]=t[1]-r[1],i[2]=t[2]-r[2],a[0]=i[0],a[1]=i[1]*Math.cos(n)-i[2]*Math.sin(n),a[2]=i[1]*Math.sin(n)+i[2]*Math.cos(n),e[0]=a[0]+r[0],e[1]=a[1]+r[1],e[2]=a[2]+r[2],e}function Jb(e,t,r,n){var i=[],a=[];return i[0]=t[0]-r[0],i[1]=t[1]-r[1],i[2]=t[2]-r[2],a[0]=i[2]*Math.sin(n)+i[0]*Math.cos(n),a[1]=i[1],a[2]=i[2]*Math.cos(n)-i[0]*Math.sin(n),e[0]=a[0]+r[0],e[1]=a[1]+r[1],e[2]=a[2]+r[2],e}function eR(e,t,r,n){var i=[],a=[];return i[0]=t[0]-r[0],i[1]=t[1]-r[1],i[2]=t[2]-r[2],a[0]=i[0]*Math.cos(n)-i[1]*Math.sin(n),a[1]=i[0]*Math.sin(n)+i[1]*Math.cos(n),a[2]=i[2],e[0]=a[0]+r[0],e[1]=a[1]+r[1],e[2]=a[2]+r[2],e}function Qm(e,t){var r=e[0],n=e[1],i=e[2],a=t[0],s=t[1],l=t[2],p=Math.sqrt(r*r+n*n+i*i),m=Math.sqrt(a*a+s*s+l*l),T=p*m,R=T&&r2(e,t)/T;return Math.acos(Math.min(Math.max(R,-1),1))}function tR(e){return e[0]=0,e[1]=0,e[2]=0,e}function rR(e){return"vec3("+e[0]+", "+e[1]+", "+e[2]+")"}function nR(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]}function iR(e,t){var r=e[0],n=e[1],i=e[2],a=t[0],s=t[1],l=t[2];return Math.abs(r-a)<=Ja*Math.max(1,Math.abs(r),Math.abs(a))&&Math.abs(n-s)<=Ja*Math.max(1,Math.abs(n),Math.abs(s))&&Math.abs(i-l)<=Ja*Math.max(1,Math.abs(i),Math.abs(l))}var qm=$1,aR=Q1,oR=q1,sR=K1,uR=J1,lR=Y1,cR=e2,fR=function(){var e=pp();return function(t,r,n,i,a,s){var l,p;for(r||(r=3),n||(n=0),i?p=Math.min(i*r+n,t.length):p=t.length,l=n;l<p;l+=r)e[0]=t[l],e[1]=t[l+1],e[2]=t[l+2],a(e,e,s),t[l]=e[0],t[l+1]=e[1],t[l+2]=e[2];return t}}();function uL(e){var t=e[0][0],r=e[0][e[0].length-1];t[0]===r[0]&&t[1]===r[1]&&(e[0]=e[0].slice(0,e[0].length-1));for(var n=e[0].length,i=earcut.flatten(e),a=i.vertices,s=i.dimensions,l=[],p=[],m=0;m<a.length/s;m++)s===2?l.push(a[m*2],a[m*2+1],1):l.push(a[m*3],a[m*3+1],1);var T=earcut(i.vertices,i.holes,i.dimensions);p.push.apply(p,_toConsumableArray(T));for(var R=function(){var re=i.vertices.slice(L*s,(L+1)*s),ee=i.vertices.slice((L+1)*s,(L+2)*s);ee.length===0&&(ee=i.vertices.slice(0,s));var me=l.length/3;l.push(re[0],re[1],1,ee[0],ee[1],1,re[0],re[1],0,ee[0],ee[1],0),p.push.apply(p,_toConsumableArray([0,2,1,2,3,1].map(function(Ie){return Ie+me})))},L=0;L<n;L++)R();return{positions:l,index:p}}function lL(e){var t=earcut.flatten(e),r=earcut(t.vertices,t.holes,t.dimensions);return{positions:t.vertices,index:r}}function i2(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,r=e[0][0],n=e[0][e[0].length-1];r[0]===n[0]&&r[1]===n[1]&&(e[0]=e[0].slice(0,e[0].length-1));for(var i=e[0].length,a=_a().flatten(e),s=a.vertices,l=a.dimensions,p=[],m=[],T=[],R=0;R<s.length/l;R++)p.push(s[R*l],s[R*l+1],1,-1,-1),T.push(0,0,1);var L=_a()(a.vertices,a.holes,a.dimensions);m.push.apply(m,(0,cr.Z)(L));for(var z=function(){var me=a.vertices.slice(re*l,(re+1)*l),Ie=a.vertices.slice((re+1)*l,(re+2)*l);Ie.length===0&&(Ie=a.vertices.slice(0,l));var He=p.length/5;p.push(me[0],me[1],1,0,0,Ie[0],Ie[1],1,.1,0,me[0],me[1],0,0,.8,Ie[0],Ie[1],0,.1,.8);var Xe=hR([Ie[0],Ie[1],1],[me[0],me[1],0],[me[0],me[1],1],t);T.push.apply(T,(0,cr.Z)(Xe).concat((0,cr.Z)(Xe),(0,cr.Z)(Xe),(0,cr.Z)(Xe))),m.push.apply(m,(0,cr.Z)([1,2,0,3,2,1].map(function(ot){return ot+He})))},re=0;re<i;re++)z();return{positions:p,index:m,normals:T}}function hR(e,t,r){var n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,i=pp(),a=pp(),s=pp();n&&(e=as(e),t=as(t),r=as(r));var l=rl.apply(D,(0,cr.Z)(e)),p=rl.apply(D,(0,cr.Z)(t)),m=rl.apply(D,(0,cr.Z)(r));qm(i,m,p),qm(a,l,p),n2(s,i,a);var T=pp();return dp(T,s),T}var Rf,vd=function(e){return e.CYLINDER="cylinder",e.SQUARECOLUMN="squareColumn",e.TRIANGLECOLUMN="triangleColumn",e.HEXAGONCOLUMN="hexagonColumn",e.PENTAGONCOLUMN="pentagonColumn",e}({}),gd=function(e){return e.CIRCLE="circle",e.SQUARE="square",e.TRIANGLE="triangle",e.HEXAGON="hexagon",e.PENTAGON="pentagon",e}({});function md(e){for(var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=Math.PI*2/e,n=[],i=0;i<e;i++)n.push(r*i+t*Math.PI/12);var a=n.map(function(s){var l=Math.sin(s+Math.PI/4),p=Math.cos(s+Math.PI/4);return[l,p,0]});return a}function Km(){return md(30)}function a2(){return md(4)}function o2(){return md(3)}function s2(){return md(6,1)}function u2(){return md(5)}var Jm=(Rf={},(0,ve.Z)(Rf,gd.CIRCLE,Km),(0,ve.Z)(Rf,gd.HEXAGON,s2),(0,ve.Z)(Rf,gd.TRIANGLE,o2),(0,ve.Z)(Rf,gd.SQUARE,a2),(0,ve.Z)(Rf,gd.PENTAGON,u2),(0,ve.Z)(Rf,vd.CYLINDER,Km),(0,ve.Z)(Rf,vd.HEXAGONCOLUMN,s2),(0,ve.Z)(Rf,vd.TRIANGLECOLUMN,o2),(0,ve.Z)(Rf,vd.SQUARECOLUMN,a2),(0,ve.Z)(Rf,vd.PENTAGONCOLUMN,u2),Rf),eg={};function tg(e){var t=Du(e.coordinates);return{vertices:[].concat((0,cr.Z)(t),(0,cr.Z)(t),(0,cr.Z)(t),(0,cr.Z)(t)),indices:[0,1,2,2,3,0],size:t.length}}function l2(e){var t=Du(e.coordinates),r=X1(t);return{vertices:[].concat((0,cr.Z)(r),(0,cr.Z)(r),(0,cr.Z)(r),(0,cr.Z)(r)),indices:[0,1,2,2,3,0],size:r.length}}function c2(e){var t=e.shape,r=_R(t,!1),n=r.positions,i=r.index,a=r.normals;return{vertices:n,indices:i,normals:a,size:5}}function AR(e){var t=Du(e.coordinates);return{vertices:(0,cr.Z)(t),indices:[0],size:t.length}}function e_(e){var t=e.coordinates,r=e.originCoordinates,n=e.version,i=new Nb({dash:!0,join:"bevel"});if(n==="GAODE2.x"){var a=t;Array.isArray(a[0][0])||(a=[t]);var s=r;Array.isArray(s[0][0])||(s=[r]);for(var l=0;l<a.length;l++){var p=a[l],m=s[l];i.extrude_gaode2(p,m)}}else{var T=t;T[0]&&!Array.isArray(T[0][0])&&(T=[t]),T.forEach(function(L){i.extrude(L)})}var R=i.complex;return{vertices:R.positions,indices:R.indices,normals:R.normals,indexes:R.indexes,size:6}}function cL(e){var t=e.coordinates.flat(),r=1,n=1;return{vertices:[1,0,0].concat(_toConsumableArray(t),[1,2,-3],_toConsumableArray(t),[1,1,-3],_toConsumableArray(t),[0,1,0],_toConsumableArray(t),[0,0,0],_toConsumableArray(t),[1,0,0],_toConsumableArray(t),[1,2,-3],_toConsumableArray(t),[1,1,-3],_toConsumableArray(t),[0,1,0],_toConsumableArray(t),[0,0,0],_toConsumableArray(t)),normals:[-r,2*n,1,2*n,-n,1,n,-n,1,n,-n,1,-r,-n,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],indices:[0,1,2,0,2,3,0,3,4,5,6,7,5,7,8,5,8,9],size:7}}function pR(e){var t=e.coordinates,r=[];if(!Array.isArray(t[0]))return{vertices:[],indices:[],normals:[],size:6,count:0};var n=dR(t),i=n.results,a=n.totalDistance;return i.map(function(s){r.push(s[0],s[1],s[2],s[3],0,a)}),{vertices:r,indices:[],normals:[],size:6,count:i.length}}function fL(e){var t=e.coordinates,r=[];if(!Array.isArray(t[0]))return{vertices:[],indices:[],size:4,count:0};var n=vR(t),i=n.results;return i.map(function(a){r.push(a[0],a[1],a[2],a[3])}),{vertices:r,indices:[],size:4,count:i.length}}function f2(e,t){var r=t[0]-e[0],n=t[1]-e[1];return Math.sqrt(r*r+n*n)}function vp(e,t){return e.length<3&&e.push(0),t!==void 0&&e.push(t),e}function dR(e){var t=e;Array.isArray(t)&&Array.isArray(t[0])&&Array.isArray(t[0][0])&&(t=e.flat());var r=0;if(t.length<2)return{results:t,totalDistance:0};var n=[],i=vp(t[0],r);n.push(i);for(var a=1;a<t.length-1;a++){var s=f2(t[a-1],t[a]);r+=s;var l=vp(t[a],r);n.push(l),n.push(l)}var p=f2(t[t.length-2],t[t.length-1]);return r+=p,n.push(vp(t[t.length-1],r)),{results:n,totalDistance:r}}function vR(e){if(e.length<2)return{results:e};var t=[],r=vp(e[0]);t.push(r);for(var n=1;n<e.length-1;n++){var i=vp(e[n]);t.push(i),t.push(i)}return t.push(vp(e[e.length-1])),{results:t}}function t_(e){var t=e.coordinates,r=_a().flatten(t),n=r.vertices,i=r.dimensions,a=r.holes;return{indices:_a()(n,a,i),vertices:n,size:i}}function gR(e){var t=e.coordinates,r=_a().flatten(t),n=r.vertices,i=r.dimensions,a=r.holes;return{indices:_a()(n,a,i),vertices:mR(n),size:i+4}}function mR(e){for(var t=[],r=Il(e),n=r.center,i=r.radius,a=0;a<e.length;a+=2){var s=e[a],l=e[a+1];t.push.apply(t,[s,l,0].concat((0,cr.Z)(n),[i]))}return t}function h2(e){var t=e.coordinates,r=i2(t,!0),n=r.positions,i=r.index,a=r.normals;return{vertices:n,indices:i,normals:a,size:5}}function hL(e){var t=e.shape,r=ER(t),n=r.positions,i=r.index;return{vertices:n,indices:i,size:3}}function rg(e){var t=e.coordinates,r=[].concat((0,cr.Z)(t[0]),[0,0,1,t[1][0],t[0][1],0,1,1],(0,cr.Z)(t[1]),[0,1,0],(0,cr.Z)(t[0]),[0,0,1],(0,cr.Z)(t[1]),[0,1,0,t[0][0],t[1][1],0,0,0]),n=[0,1,2,3,4,5];return{vertices:r,indices:n,size:5}}function ng(e,t){for(var r=t.segmentNumber,n=r===void 0?30:r,i=e.coordinates,a=[],s=[],l=function(T){a.push(T,1,T,i[0][0],i[0][1],i[1][0],i[1][1],T,-1,T,i[0][0],i[0][1],i[1][0],i[1][1]),T!==n-1&&s.push.apply(s,(0,cr.Z)([0,1,2,1,3,2].map(function(R){return T*2+R})))},p=0;p<n;p++)l(p);return{vertices:a,indices:s,size:7}}function AL(e){var t=e.coordinates;t.length===2&&t.push(0);var r=ig(-1,1),n=ig(1,1),i=ig(-1,-1),a=ig(1,-1),s=[].concat(_toConsumableArray(t),_toConsumableArray(r),_toConsumableArray(t),_toConsumableArray(i),_toConsumableArray(t),_toConsumableArray(a),_toConsumableArray(t),_toConsumableArray(n)),l=[0,1,2,3,0,2];return{vertices:s,indices:l,size:5}}function _R(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(eg&&eg[e])return eg[e];var r=Jm[e]?Jm[e]():Jm.cylinder(),n=i2([r],t);return eg[e]=n,n}function pL(e,t){for(var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:3,n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,i=new Float32Array(e.length/r*3),a,s,l,p=vec3.create(),m=vec3.create(),T=vec3.create(),R=0,L=t.length;R<L;R+=3){a=t[R+0]*3,s=t[R+1]*3,l=t[R+2]*3;var z=[e[a],e[a+1]],re=[e[s],e[s+1]],ee=[e[l],e[l+1]];n&&(z=lngLatToMeters(z),re=lngLatToMeters(re),ee=lngLatToMeters(ee));var me=z,Ie=_slicedToArray(me,2),He=Ie[0],Xe=Ie[1],ot=vec3.fromValues(He,Xe,e[a+2]),pt=re,dt=_slicedToArray(pt,2),It=dt[0],Vt=dt[1],Kt=vec3.fromValues(It,Vt,e[s+2]),yr=ee,_r=_slicedToArray(yr,2),Hr=_r[0],nn=_r[1],Tn=vec3.fromValues(Hr,nn,e[l+2]);vec3.sub(p,Tn,Kt),vec3.sub(m,ot,Kt),vec3.cross(T,p,m),i[a]+=p[0],i[a+1]+=p[1],i[a+2]+=p[2],i[s]+=p[0],i[s+1]+=p[1],i[s+2]+=p[2],i[l]+=p[0],i[l+1]+=p[1],i[l+2]+=p[2]}return yR(i),i}function yR(e){for(var t=0,r=e.length;t<r;t+=3){var n=vec3.fromValues(e[t],e[t+1],e[t+2]),i=vec3.create();vec3.normalize(i,n),e.set(i,t)}}function dL(e){var t=e[0][0],r=e[0][e[0].length-1];return t[0]===r[0]&&t[1]===r[1]}function ER(e){var t=["cylinder","triangleColumn","hexagonColumn","squareColumn"],r=geometryShape[e]?geometryShape[e]():geometryShape.circle(),n=t.indexOf(e)===-1?fillPolygon([r]):extrudePolygon([r]);return n}function ig(e,t){var r=(e+1)/2,n=(t+1)/2;return[r,n]}function vL(){var e=primitiveSphere(EARTH_RADIUS,{segments:EARTH_SEGMENTS}),t=e.positionsArr,r=e.indicesArr,n=e.normalArr;return{vertices:t,indices:r,size:5,normals:n}}function gL(){var e=primitiveSphere(EARTH_RADIUS+EARTH_RADIUS_OUTER,{segments:EARTH_SEGMENTS}),t=e.positionsArr,r=e.indicesArr,n=e.normalArr;return{vertices:t,indices:r,size:5,normals:n}}function SR(e){var t=xR();return function(){var n=(0,le.Z)(e),i;if(t){var a=(0,le.Z)(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return(0,ze.Z)(this,i)}}function xR(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var TR=`varying vec4 v_dash_array;
varying vec4 v_color;
varying float v_distance_ratio;

uniform float segmentNumber;


#pragma include "picking"

void main() {
  gl_FragColor = v_color;

  float flag = 0.;
  float dashLength = mod(v_distance_ratio, v_dash_array.x + v_dash_array.y + v_dash_array.z + v_dash_array.w);
  if(dashLength < v_dash_array.x || (dashLength > (v_dash_array.x + v_dash_array.y) && dashLength <  v_dash_array.x + v_dash_array.y + v_dash_array.z)) {
    flag = 1.;
  };
  gl_FragColor.a *=flag;
  
  gl_FragColor = filterColor(gl_FragColor);
}`,CR=`
attribute vec4 a_Color;
attribute vec3 a_Position;
attribute vec4 a_Instance;
attribute float a_Size;
uniform mat4 u_ModelMatrix;

uniform float segmentNumber;
varying vec4 v_color;


uniform vec4 u_dash_array: [10.0, 5., 0, 0];
uniform float u_lineDir: 1.0;
varying vec4 v_dash_array;
varying float v_distance_ratio;
#pragma include "projection"
#pragma include "project"
#pragma include "picking"

float bezier3(vec3 arr, float t) {
  float ut = 1. - t;
  return (arr.x * ut + arr.y * t) * ut + (arr.y * ut + arr.z * t) * t;
}
vec2 midPoint(vec2 source, vec2 target, float arcThetaOffset) {
  vec2 center = target - source;
  float r = length(center);
  float theta = atan(center.y, center.x);
  float thetaOffset = arcThetaOffset;
  float r2 = r / 2.0 / cos(thetaOffset);
  float theta2 = theta + thetaOffset;
  vec2 mid = vec2(r2*cos(theta2) + source.x, r2*sin(theta2) + source.y);
  if(u_lineDir == 1.0) { // \u6B63\u5411
    return mid;
  } else { // \u9006\u5411
    // (mid + vmin)/2 = (s + t)/2
    vec2 vmid = source + target - mid;
    return vmid;
  }
  // return mid;
}
float getSegmentRatio(float index) {
  // dash: index / (segmentNumber - 1.);
  // normal: smoothstep(0.0, 1.0, index / (segmentNumber - 1.));
  return index / (segmentNumber - 1.);
}
vec2 interpolate (vec2 source, vec2 target, float t, float arcThetaOffset) {
  // if the angularDist is PI, linear interpolation is applied. otherwise, use spherical interpolation
  vec2 mid = midPoint(source, target, arcThetaOffset);
  vec3 x = vec3(source.x, mid.x, target.x);
  vec3 y = vec3(source.y, mid.y, target.y);
  return vec2(bezier3(x ,t), bezier3(y,t));
}
vec2 getExtrusionOffset(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
   dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
  vec2 offset = dir_screenspace * offset_direction * setPickingSize(a_Size) / 2.0;
  return offset;
}
vec2 getNormal(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
   dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
   return reverse_offset_normal(vec3(dir_screenspace,1.0)).xy * sign(offset_direction);
}

void main() {
  v_color = vec4(a_Color.xyz, a_Color.w * opacity);
  
  vec2 source = a_Instance.rg;  // \u8D77\u59CB\u70B9
  vec2 target =  a_Instance.ba; // \u7EC8\u70B9
  float segmentIndex = a_Position.x;
  float segmentRatio = getSegmentRatio(segmentIndex);

  float indexDir = mix(-1.0, 1.0, step(segmentIndex, 0.0));
  float nextSegmentRatio = getSegmentRatio(segmentIndex + indexDir);

  vec2 s = source;
  vec2 t = target;
  
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    s = unProjCustomCoord(source);
    t = unProjCustomCoord(target);
  }
  float total_Distance = pixelDistance(s, t) / 2.0 * PI;
  v_dash_array = pow(2.0, 20.0 - u_Zoom) * u_dash_array / total_Distance;

  v_distance_ratio = segmentIndex / segmentNumber;

  vec4 curr = project_position(vec4(interpolate(source, target, segmentRatio, thetaOffset), 0.0, 1.0));
  vec4 next = project_position(vec4(interpolate(source, target, nextSegmentRatio, thetaOffset), 0.0, 1.0));
 
  
  vec2 offset = project_pixel(getExtrusionOffset((next.xy - curr.xy) * indexDir, a_Position.y));

  gl_Position = project_common_position_to_clipspace_v2(vec4(curr.xy + offset, 0, 1.0));

  gl_PointSize = 5.0;
  setPickingColor(a_PickingColor);
}
`,bR=`
#define Animate 0.0
#define LineTexture 1.0
uniform float u_textureBlend;
uniform float u_blur : 0.9;
uniform float u_line_type: 0.0;
// varying vec2 v_normal;
varying vec4 v_dash_array;
varying vec4 v_color;

uniform float u_time;
uniform vec4 u_animate: [ 1., 2., 1.0, 0.2 ];

uniform float u_line_texture;
uniform sampler2D u_texture;
uniform vec2 u_textSize;

uniform float segmentNumber;
varying vec2 v_iconMapUV;
varying vec4 v_lineData;


#pragma include "picking"

void main() {
  float animateSpeed = 0.0; // \u8FD0\u52A8\u901F\u5EA6
  gl_FragColor = v_color;
  

  if(u_animate.x == Animate && u_line_texture != LineTexture) {
      animateSpeed = u_time / u_animate.y;
      float alpha =1.0 - fract( mod(1.0- v_lineData.b, u_animate.z)* (1.0/ u_animate.z) + u_time / u_animate.y);
      alpha = (alpha + u_animate.w -1.0) / u_animate.w;
      // alpha = smoothstep(0., 1., alpha);
      alpha = clamp(alpha, 0.0, 1.0);
      gl_FragColor.a *= alpha;
  }

  // \u5F53\u5B58\u5728\u8D34\u56FE\u65F6\u5728\u5E95\u8272\u4E0A\u8D34\u4E0A\u8D34\u56FE
  if(u_line_texture == LineTexture) { // while load texture
    float arcRadio = smoothstep( 0.0, 1.0, (v_lineData.r / segmentNumber));
    // float arcRadio = smoothstep( 0.0, 1.0, d_distance_ratio);

    float count = v_lineData.g; // \u8D34\u56FE\u5728\u5F27\u7EBF\u4E0A\u91CD\u590D\u7684\u6570\u91CF

    float time = 0.0;
    if(u_animate.x == Animate) {
      time = u_time / u_animate.y;
    }
    float redioCount = arcRadio * count;

    float u = fract(redioCount - time);
    float v = v_lineData.a; // \u6A2A\u5411 v
    vec2 uv= v_iconMapUV / u_textSize + vec2(u, v) / u_textSize * 64.;

    vec4 pattern = texture2D(u_texture, uv);

    if(u_animate.x == Animate) {
      float currentPlane = floor(redioCount - time);
      float textureStep = floor(count * u_animate.z);
      float a = mod(currentPlane, textureStep);
      if(a < textureStep - 1.0) {
        pattern = vec4(0.0);
      }
    }

    if(u_textureBlend == 0.0) { // normal
      pattern.a = 0.0;
      gl_FragColor = filterColor(gl_FragColor + pattern);
    } else { // replace
        pattern.a *= v_color.a;
        if(gl_FragColor.a <= 0.0) {
          pattern.a = 0.0;
        }
        gl_FragColor = filterColor(pattern);
    }
    
  } else {
     gl_FragColor = filterColor(gl_FragColor);
  }
}`,RR=`#define Animate 0.0
#define LineTexture 1.0

attribute vec4 a_Color;
attribute vec3 a_Position;
attribute vec4 a_Instance;
attribute float a_Size;
uniform mat4 u_ModelMatrix;

uniform float segmentNumber;
uniform vec4 u_animate: [ 1., 2., 1.0, 0.2 ];
varying vec4 v_color;

uniform float u_lineDir: 1.0;

uniform float u_icon_step: 100;
uniform float u_line_texture: 0.0;
attribute vec2 a_iconMapUV;
varying vec2 v_iconMapUV;
varying vec4 v_lineData;
varying vec2 v_distance_ratio;


#pragma include "projection"
#pragma include "project"
#pragma include "picking"

float bezier3(vec3 arr, float t) {
  float ut = 1. - t;
  return (arr.x * ut + arr.y * t) * ut + (arr.y * ut + arr.z * t) * t;
}
vec2 midPoint(vec2 source, vec2 target, float arcThetaOffset) {
  vec2 center = target - source;
  float r = length(center);
  float theta = atan(center.y, center.x);
  float thetaOffset = arcThetaOffset;
  float r2 = r / 2.0 / cos(thetaOffset);
  float theta2 = theta + thetaOffset;
  vec2 mid = vec2(r2*cos(theta2) + source.x, r2*sin(theta2) + source.y);
  if(u_lineDir == 1.0) { // \u6B63\u5411
    return mid;
  } else { // \u9006\u5411
    // (mid + vmin)/2 = (s + t)/2
    vec2 vmid = source + target - mid;
    return vmid;
  }
  // return mid;
}
float getSegmentRatio(float index) {
    // dash: index / (segmentNumber - 1.);
    // normal: smoothstep(0.0, 1.0, index / (segmentNumber - 1.));
    return smoothstep(0.0, 1.0, index / (segmentNumber - 1.));
    //  return index / (segmentNumber - 1.);
}
vec2 interpolate (vec2 source, vec2 target, float t, float arcThetaOffset) {
  // if the angularDist is PI, linear interpolation is applied. otherwise, use spherical interpolation
  vec2 mid = midPoint(source, target, arcThetaOffset);
  vec3 x = vec3(source.x, mid.x, target.x);
  vec3 y = vec3(source.y, mid.y, target.y);
  return vec2(bezier3(x ,t), bezier3(y,t));
}
vec2 getExtrusionOffset(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
   dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
  vec2 offset = dir_screenspace * offset_direction * setPickingSize(a_Size) / 2.0;
  return offset;
}
vec2 getNormal(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
   dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
   return reverse_offset_normal(vec3(dir_screenspace,1.0)).xy * sign(offset_direction);
}

void main() {
  v_color = a_Color;
  v_color.a = v_color.a * opacity;

  vec2 source = a_Instance.rg;  // \u8D77\u59CB\u70B9
  vec2 target =  a_Instance.ba; // \u7EC8\u70B9
  float segmentIndex = a_Position.x;
  float segmentRatio = getSegmentRatio(segmentIndex);

  float indexDir = mix(-1.0, 1.0, step(segmentIndex, 0.0));
  float nextSegmentRatio = getSegmentRatio(segmentIndex + indexDir);
  float d_distance_ratio;
  
  if(u_animate.x == Animate) {
      d_distance_ratio = segmentIndex / segmentNumber;
      if(u_lineDir != 1.0) {
        d_distance_ratio = 1.0 - d_distance_ratio;
      }
  }

 v_lineData.b = d_distance_ratio;

  vec4 curr = project_position(vec4(interpolate(source, target, segmentRatio, thetaOffset), 0.0, 1.0));
  vec4 next = project_position(vec4(interpolate(source, target, nextSegmentRatio, thetaOffset), 0.0, 1.0));

  
  vec2 offset = project_pixel(getExtrusionOffset((next.xy - curr.xy) * indexDir, a_Position.y));


  float d_segmentIndex = a_Position.x + 1.0; // \u5F53\u524D\u9876\u70B9\u5728\u5F27\u7EBF\u4E2D\u6240\u5904\u7684\u5206\u6BB5\u4F4D\u7F6E
 v_lineData.r = d_segmentIndex;

  if(LineTexture == u_line_texture) { // \u5F00\u542F\u8D34\u56FE\u6A21\u5F0F

    float arcDistrance = length(source - target); // \u8D77\u59CB\u70B9\u548C\u7EC8\u70B9\u7684\u8DDD\u79BB
    if(u_CoordinateSystem == COORDINATE_SYSTEM_P20) { // amap
      arcDistrance *= 1000000.0;
    }
    if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) { // mapbox
      // arcDistrance *= 8.0;
      arcDistrance = project_pixel_allmap(arcDistrance);
    }
    v_iconMapUV = a_iconMapUV;

    float pixelLen = project_pixel_texture(u_icon_step); // \u8D34\u56FE\u6CBF\u5F27\u7EBF\u65B9\u5411\u7684\u957F\u5EA6 - \u968F\u5730\u56FE\u7F29\u653E\u6539\u53D8
    float texCount = floor(arcDistrance/pixelLen); // \u8D34\u56FE\u5728\u5F27\u7EBF\u4E0A\u91CD\u590D\u7684\u6570\u91CF
    v_lineData.g = texCount;

    float lineOffsetWidth = length(offset + offset * sign(a_Position.y)); // \u7EBF\u6A2A\u5411\u504F\u79FB\u7684\u8DDD\u79BB
    float linePixelSize = project_pixel(a_Size); // \u5B9A\u70B9\u4F4D\u7F6E\u504F\u79FB
    v_lineData.a = lineOffsetWidth/linePixelSize; // \u7EBF\u56FE\u5C42\u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\u503C
  }

  gl_Position = project_common_position_to_clipspace_v2(vec4(curr.xy + offset, 0, 1.0));

  setPickingColor(a_PickingColor);
}
`,MR=`varying vec4 v_color;

#pragma include "picking"

void main() {
// \u5F53\u524D\u9876\u70B9\u5728\u5F27\u7EBF\u4E2D\u6240\u5904\u7684\u5206\u6BB5\u4F4D\u7F6E

  gl_FragColor = v_color;
  gl_FragColor = filterColor(gl_FragColor);
}`,wR=`
attribute vec4 a_Color;
attribute vec3 a_Position;
attribute vec4 a_Instance;
attribute float a_Size;
uniform mat4 u_ModelMatrix;

uniform float segmentNumber;
varying vec4 v_color;
varying float v_segmentIndex;

uniform float u_lineDir: 1.0;

uniform vec4 u_sourceColor;
uniform vec4 u_targetColor;




#pragma include "projection"
#pragma include "project"
#pragma include "picking"

float bezier3(vec3 arr, float t) {
  float ut = 1. - t;
  return (arr.x * ut + arr.y * t) * ut + (arr.y * ut + arr.z * t) * t;
}
vec2 midPoint(vec2 source, vec2 target, float arcThetaOffset) {
  vec2 center = target - source;
  float r = length(center);
  float theta = atan(center.y, center.x);
  float thetaOffset = arcThetaOffset;
  float r2 = r / 2.0 / cos(thetaOffset);
  float theta2 = theta + thetaOffset;
  vec2 mid = vec2(r2*cos(theta2) + source.x, r2*sin(theta2) + source.y);
  if(u_lineDir == 1.0) { // \u6B63\u5411
    return mid;
  } else { // \u9006\u5411
    // (mid + vmin)/2 = (s + t)/2
    vec2 vmid = source + target - mid;
    return vmid;
  }
  // return mid;
}
float getSegmentRatio(float index) {
    return smoothstep(0.0, 1.0, index / (segmentNumber - 1.));
}
vec2 interpolate (vec2 source, vec2 target, float t, float arcThetaOffset) {
  // if the angularDist is PI, linear interpolation is applied. otherwise, use spherical interpolation
  vec2 mid = midPoint(source, target, arcThetaOffset);
  vec3 x = vec3(source.x, mid.x, target.x);
  vec3 y = vec3(source.y, mid.y, target.y);
  return vec2(bezier3(x ,t), bezier3(y,t));
}
vec2 getExtrusionOffset(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
   dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
  vec2 offset = dir_screenspace * offset_direction * setPickingSize(a_Size) / 2.0;
  return offset;
}
vec2 getNormal(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
   dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
   return reverse_offset_normal(vec3(dir_screenspace,1.0)).xy * sign(offset_direction);
}

void main() {
  v_color = a_Color;

  vec2 source = a_Instance.rg;  // \u8D77\u59CB\u70B9
  vec2 target =  a_Instance.ba; // \u7EC8\u70B9
  float segmentIndex = a_Position.x;
  float segmentRatio = getSegmentRatio(segmentIndex);

  float indexDir = mix(-1.0, 1.0, step(segmentIndex, 0.0));
  float nextSegmentRatio = getSegmentRatio(segmentIndex + indexDir);
  float d_distance_ratio;
  vec4 curr = project_position(vec4(interpolate(source, target, segmentRatio, thetaOffset), 0.0, 1.0));
  vec4 next = project_position(vec4(interpolate(source, target, nextSegmentRatio, thetaOffset), 0.0, 1.0));
  // v_normal = getNormal((next.xy - curr.xy) * indexDir, a_Position.y);
  //unProjCustomCoord
  
  vec2 offset = project_pixel(getExtrusionOffset((next.xy - curr.xy) * indexDir, a_Position.y));


  float d_segmentIndex = a_Position.x + 1.0; // \u5F53\u524D\u9876\u70B9\u5728\u5F27\u7EBF\u4E2D\u6240\u5904\u7684\u5206\u6BB5\u4F4D\u7F6E

  v_color = mix(u_sourceColor, u_targetColor, d_segmentIndex/segmentNumber);
  v_color.a *= opacity;

  gl_Position = project_common_position_to_clipspace_v2(vec4(curr.xy + offset, 0, 1.0));

  setPickingColor(a_PickingColor);
}
`,IR={solid:0,dash:1},mL=Fn.isNumber,PR=function(e){(0,ke.Z)(r,e);var t=SR(r);function r(){var n;(0,ue.Z)(this,r);for(var i=arguments.length,a=new Array(i),s=0;s<i;s++)a[s]=arguments[s];return n=t.call.apply(t,[this].concat(a)),(0,ve.Z)((0,St.Z)(n),"updateTexture",function(){var l=n.rendererService.createTexture2D;if(n.texture){n.texture.update({data:n.iconService.getCanvas()}),n.layer.render();return}n.texture=l({data:n.iconService.getCanvas(),mag:Fe.NEAREST,min:Fe.NEAREST,premultiplyAlpha:!1,width:1024,height:n.iconService.canvasHeight||128})}),n}return(0,_e.Z)(r,[{key:"getUninforms",value:function(){var i=this.layer.getLayerConfig(),a=i.opacity,s=a===void 0?1:a,l=i.sourceColor,p=i.targetColor,m=i.textureBlend,T=m===void 0?"normal":m,R=i.lineType,L=R===void 0?"solid":R,z=i.dashArray,re=z===void 0?[10,5]:z,ee=i.forward,me=ee===void 0?!0:ee,Ie=i.lineTexture,He=Ie===void 0?!1:Ie,Xe=i.iconStep,ot=Xe===void 0?100:Xe,pt=i.segmentNumber,dt=pt===void 0?30:pt;re.length===2&&re.push(0,0);var It=0,Vt=[0,0,0,0],Kt=[0,0,0,0];return l&&p&&(Vt=Qi(l),Kt=Qi(p),It=1),this.rendererService.getDirty()&&this.texture.bind(),(0,Q.Z)({u_textureBlend:T==="normal"?0:1,segmentNumber:dt,u_line_type:IR[L||"solid"],u_dash_array:re,u_blur:.9,u_lineDir:me?1:-1,u_texture:this.texture,u_line_texture:He?1:0,u_icon_step:ot,u_textSize:[1024,this.iconService.canvasHeight||128],u_linearColor:It,u_sourceColor:Vt,u_targetColor:Kt},this.getStyleAttribute())}},{key:"getAnimateUniforms",value:function(){var i=this.layer.getLayerConfig(),a=i.animateOption;return{u_animate:this.animateOption2Array(a),u_time:this.layer.getLayerAnimateTime()}}},{key:"initModels",value:function(){var n=(0,hr.Z)(it().mark(function a(){return it().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return this.updateTexture(),this.iconService.on("imageUpdate",this.updateTexture),l.abrupt("return",this.buildModels());case 3:case"end":return l.stop()}},a,this)}));function i(){return n.apply(this,arguments)}return i}()},{key:"clearModels",value:function(){var i;(i=this.texture)===null||i===void 0||i.destroy(),this.iconService.off("imageUpdate",this.updateTexture)}},{key:"getShaders",value:function(){var i=this.layer.getLayerConfig(),a=i.sourceColor,s=i.targetColor,l=i.lineType;return l==="dash"?{frag:TR,vert:CR,type:"Dash"}:a&&s?{frag:MR,vert:wR,type:"Linear"}:{frag:bR,vert:RR,type:""}}},{key:"buildModels",value:function(){var n=(0,hr.Z)(it().mark(function a(){var s,l,p,m,T,R,L,z;return it().wrap(function(ee){for(;;)switch(ee.prev=ee.next){case 0:return s=this.layer.getLayerConfig(),l=s.segmentNumber,p=l===void 0?30:l,m=this.getShaders(),T=m.frag,R=m.vert,L=m.type,ee.next=4,this.layer.buildLayerModel({moduleName:"lineArc2d"+L,vertexShader:R,fragmentShader:T,inject:this.getInject(),triangulation:ng,depth:{enable:!1},styleOption:{segmentNumber:p}});case 4:return z=ee.sent,ee.abrupt("return",[z]);case 6:case"end":return ee.stop()}},a,this)}));function i(){return n.apply(this,arguments)}return i}()},{key:"registerBuiltinAttributes",value:function(){var i=this;this.styleAttributeService.registerStyleAttribute({name:"size",type:bn.Attribute,descriptor:{name:"a_Size",buffer:{usage:Fe.DYNAMIC_DRAW,data:[],type:Fe.FLOAT},size:1,update:function(s){var l=s.size,p=l===void 0?1:l;return Array.isArray(p)?[p[0]]:[p]}}}),this.styleAttributeService.registerStyleAttribute({name:"instance",type:bn.Attribute,descriptor:{name:"a_Instance",buffer:{usage:Fe.STATIC_DRAW,data:[],type:Fe.FLOAT},size:4,update:function(s,l,p){return[p[3],p[4],p[5],p[6]]}}}),this.styleAttributeService.registerStyleAttribute({name:"uv",type:bn.Attribute,descriptor:{name:"a_iconMapUV",buffer:{usage:Fe.DYNAMIC_DRAW,data:[],type:Fe.FLOAT},size:2,update:function(s){var l=i.iconService.getIconMap(),p=s.texture,m=l[p]||{x:0,y:0},T=m.x,R=m.y;return[T,R]}}})}}]),r}(Lo);function OR(e){var t=NR();return function(){var n=(0,le.Z)(e),i;if(t){var a=(0,le.Z)(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return(0,ze.Z)(this,i)}}function NR(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var DR=`#define LineTypeSolid 0.0
#define LineTypeDash 1.0
#define Animate 0.0
#define LineTexture 1.0

uniform float u_textureBlend;
uniform float u_blur : 0.9;
uniform float u_line_type: 0.0;
// varying vec2 v_normal;
varying vec4 v_dash_array;
varying vec4 v_color;
varying vec4 v_line_data;

uniform float u_line_texture: 0.0;
uniform sampler2D u_texture;
uniform vec2 u_textSize;
varying float v_segmentIndex;
uniform float segmentNumber;


varying vec2 v_iconMapUV;

uniform float u_time;
uniform vec4 u_animate: [ 1., 2., 1.0, 0.2 ];


#pragma include "picking"

void main() {
  float animateSpeed = 0.0; // \u8FD0\u52A8\u901F\u5EA6
  float d_distance_ratio = v_line_data.g; // \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B
  gl_FragColor = v_color;

  if(u_line_type == LineTypeDash) {
    float flag = 0.;
    float dashLength = mod(d_distance_ratio, v_dash_array.x + v_dash_array.y + v_dash_array.z + v_dash_array.w);
    if(dashLength < v_dash_array.x || (dashLength > (v_dash_array.x + v_dash_array.y) && dashLength <  v_dash_array.x + v_dash_array.y + v_dash_array.z)) {
      flag = 1.;
    }
    gl_FragColor.a *=flag;
  }

  if(u_animate.x == Animate && u_line_texture != LineTexture) {
      animateSpeed = u_time / u_animate.y;
      float alpha =1.0 - fract( mod(1.0- d_distance_ratio, u_animate.z)* (1.0/ u_animate.z) + u_time / u_animate.y);

      alpha = (alpha + u_animate.w -1.0) / u_animate.w;
      // alpha = smoothstep(0., 1., alpha);
      alpha = clamp(alpha, 0.0, 1.0);
      gl_FragColor.a *= alpha;

      // u_animate 
      // x enable
      // y duration
      // z interval
      // w trailLength
  }

  if(u_line_texture == LineTexture && u_line_type != LineTypeDash) { // while load texture
    // float arcRadio = smoothstep( 0.0, 1.0, (v_segmentIndex / segmentNumber));
    float arcRadio = v_segmentIndex / (segmentNumber - 1.0);
    float count = v_line_data.b; // // \u8D34\u56FE\u5728\u5F27\u7EBF\u4E0A\u91CD\u590D\u7684\u6570\u91CF

    float time = 0.0;
    if(u_animate.x == Animate) {
      time = u_time / u_animate.y;
    }
    float redioCount = arcRadio * count;

    float u = fract(redioCount - time);

    float v = v_line_data.a;  // \u7EBF\u56FE\u5C42\u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\u503C
    vec2 uv= v_iconMapUV / u_textSize + vec2(u, v) / u_textSize * 64.;
    vec4 pattern = texture2D(u_texture, uv);

    if(u_animate.x == Animate) {
      float currentPlane = floor(redioCount - time);
      float textureStep = floor(count * u_animate.z);
      float a = mod(currentPlane, textureStep);
      if(a < textureStep - 1.0) {
        pattern = vec4(0.0);
      }
    }

    if(u_textureBlend == 0.0) { // normal
      pattern.a = 0.0;
      gl_FragColor = filterColor(gl_FragColor + pattern);
    } else { // replace
        pattern.a *= v_color.a;
        if(gl_FragColor.a <= 0.0) {
          pattern.a = 0.0;
          discard;
        } else {
          gl_FragColor = filterColor(pattern);
        }
    }

  } else {
    gl_FragColor = filterColor(gl_FragColor);
  }
}
`,LR=`#define LineTypeSolid 0.0
#define LineTypeDash 1.0
#define Animate 0.0
#define LineTexture 1.0
attribute vec3 a_Position;
attribute vec4 a_Instance;
attribute vec4 a_Color;
attribute float a_Size;

uniform float u_globel;
uniform float u_globel_radius;
uniform float u_global_height: 10;
uniform mat4 u_ModelMatrix;

uniform float segmentNumber;
uniform vec4 u_animate: [ 1., 2., 1.0, 0.2 ];
varying vec4 v_color;

uniform float u_line_type: 0.0;
uniform vec4 u_dash_array: [10.0, 5., 0, 0];
varying vec4 v_dash_array;

uniform float u_icon_step: 100;
uniform float u_line_texture: 0.0;
varying float v_segmentIndex;

attribute vec2 a_iconMapUV;
varying vec2 v_iconMapUV;
varying vec4 v_line_data;

#pragma include "projection"
#pragma include "project"
#pragma include "picking"

float maps (float value, float start1, float stop1, float start2, float stop2) {
  return start2 + (stop2 - start2) * ((value - start1) / (stop1 - start1));
}

float getSegmentRatio(float index) {
  return smoothstep(0.0, 1.0, index / (segmentNumber - 1.0));
}

float paraboloid(vec2 source, vec2 target, float ratio) {
  vec2 x = mix(source, target, ratio);
  vec2 center = mix(source, target, 0.5);
  float dSourceCenter = distance(source, center);
  float dXCenter = distance(x, center);
  return (dSourceCenter + dXCenter) * (dSourceCenter - dXCenter);
}

vec3 getPos(vec2 source, vec2 target, float segmentRatio) {
  float vertex_height = paraboloid(source, target, segmentRatio);

  return vec3(
    mix(source, target, segmentRatio),
    sqrt(max(0.0, vertex_height))
  );
}
vec2 getExtrusionOffset(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
  dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);

  vec2 offset = dir_screenspace * offset_direction * setPickingSize(a_Size) / 2.0;

  return offset;
}
vec2 getNormal(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
  dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
  return reverse_offset_normal(vec3(dir_screenspace,1.0)).xy * sign(offset_direction);
}

float torad(float deg) {
  return (deg / 180.0) * acos(-1.0);
}

vec3 lglt2xyz(vec2 lnglat) {
  float pi = 3.1415926;
  // + Math.PI/2 \u662F\u4E3A\u4E86\u5BF9\u9F50\u5750\u6807
  float lng = torad(lnglat.x) + pi / 2.0;
  float lat = torad(lnglat.y);

  // \u624B\u52A8\u589E\u52A0\u4E00\u4E9B\u504F\u79FB\uFF0C\u51CF\u8F7B\u9762\u7684\u51B2\u7A81
  float radius = u_globel_radius;

  float z = radius * cos(lat) * cos(lng);
  float x = radius * cos(lat) * sin(lng);
  float y = radius * sin(lat);
  return vec3(x, y, z);
}

void main() {

  v_color = a_Color;
  v_color.a = v_color.a * opacity;
  vec2 source = project_position(vec4(a_Instance.rg, 0, 0)).xy;
  vec2 target = project_position(vec4(a_Instance.ba, 0, 0)).xy;
  float segmentIndex = a_Position.x;
  float segmentRatio = getSegmentRatio(segmentIndex);
  float indexDir = mix(-1.0, 1.0, step(segmentIndex, 0.0));

  float d_distance_ratio;
   if(u_line_type == LineTypeDash) {
    d_distance_ratio = segmentIndex / segmentNumber;
    vec2 s = source;
    vec2 t = target;
    
    if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
      s = unProjCustomCoord(source);
      t = unProjCustomCoord(target);
    }
    float total_Distance = pixelDistance(s, t) / 2.0 * PI;
    v_dash_array = pow(2.0, 20.0 - u_Zoom) * u_dash_array / (total_Distance / segmentNumber * segmentIndex);
  }
    if(u_animate.x == Animate) {
      d_distance_ratio = segmentIndex / segmentNumber;
  }
  v_line_data.g = d_distance_ratio; // \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B

  float nextSegmentRatio = getSegmentRatio(segmentIndex + indexDir);
  vec3 curr = getPos(source, target, segmentRatio);
  vec3 next = getPos(source, target, nextSegmentRatio);
  vec2 offset = getExtrusionOffset((next.xy - curr.xy) * indexDir, a_Position.y);
  // v_normal = getNormal((next.xy - curr.xy) * indexDir, a_Position.y);


  v_segmentIndex = a_Position.x;
  if(LineTexture == u_line_texture && u_line_type != LineTypeDash) { // \u5F00\u542F\u8D34\u56FE\u6A21\u5F0F  

    float arcDistrance = length(source - target);
    float pixelLen =  project_pixel_texture(u_icon_step);
    v_line_data.b = floor(arcDistrance/pixelLen); // \u8D34\u56FE\u5728\u5F27\u7EBF\u4E0A\u91CD\u590D\u7684\u6570\u91CF

    vec2 projectOffset = project_pixel(offset);
    float lineOffsetWidth = length(projectOffset + projectOffset * sign(a_Position.y)); // \u7EBF\u6A2A\u5411\u504F\u79FB\u7684\u8DDD\u79BB
    float linePixelSize = project_pixel(a_Size);  // \u5B9A\u70B9\u4F4D\u7F6E\u504F\u79FB\uFF0C\u6309\u5730\u56FE\u7B49\u7EA7\u7F29\u653E\u540E\u7684\u8DDD\u79BB
    v_line_data.a = lineOffsetWidth/linePixelSize;  // \u7EBF\u56FE\u5C42\u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\u503C

    v_iconMapUV = a_iconMapUV;
  }


  gl_Position = project_common_position_to_clipspace_v2(vec4(curr.xy + project_pixel(offset), curr.z * thetaOffset, 1.0));

  // \u5730\u7403\u6A21\u5F0F
  if(u_globel > 0.0) {
    vec3 startLngLat = lglt2xyz(a_Instance.rg);
    vec3 endLngLat = lglt2xyz(a_Instance.ba);
    float globalRadius = length(startLngLat);

    vec3 lineDir = normalize(endLngLat - startLngLat);
    vec3 midPointDir = normalize((startLngLat + endLngLat)/2.0);

    // \u7EBF\u7684\u504F\u79FB
    vec3 lnglatOffset = cross(lineDir, midPointDir) * a_Position.y;
    // \u8BA1\u7B97\u8D77\u59CB\u70B9\u548C\u7EC8\u6B62\u70B9\u7684\u8DDD\u79BB
    float lnglatLength = length(a_Instance.rg - a_Instance.ba)/50.0;
    // \u8BA1\u7B97\u98DE\u7EBF\u5404\u4E2A\u8282\u70B9\u76F8\u5E94\u7684\u9AD8\u5EA6
    float lineHeight = u_global_height * (-4.0*segmentRatio*segmentRatio + 4.0 * segmentRatio) * lnglatLength;
    // \u5730\u7403\u70B9\u4F4D
    vec3 globalPoint = normalize(mix(startLngLat, endLngLat, segmentRatio)) * (globalRadius + lineHeight) + lnglatOffset * a_Size;
    
    gl_Position = u_ViewProjectionMatrix * vec4(globalPoint, 1.0);
  }
 

  setPickingColor(a_PickingColor);
}
`,FR=`
#define Animate 0.0
uniform float u_time;
uniform vec4 u_animate: [ 1., 2., 1.0, 0.2 ];
varying vec4 v_Color;

varying float v_distance_ratio;
#pragma include "picking"

void main() {

  float animateSpeed = 0.0; // \u8FD0\u52A8\u901F\u5EA6
  gl_FragColor = v_Color;

  if(u_animate.x == Animate) {
      animateSpeed = u_time / u_animate.y;
      float alpha =1.0 - fract( mod(1.0- v_distance_ratio, u_animate.z)* (1.0/ u_animate.z) + u_time / u_animate.y);

      alpha = (alpha + u_animate.w -1.0) / u_animate.w;
      // alpha = smoothstep(0., 1., alpha);
      alpha = clamp(alpha, 0.0, 1.0);
      gl_FragColor.a *= alpha;

      // u_animate 
      // x enable
      // y duration
      // z interval
      // w trailLength
  }

  gl_FragColor = filterColor(gl_FragColor);
}
`,BR=`#define LineTypeSolid 0.0
#define LineTypeDash 1.0
#define Animate 0.0
#define LineTexture 1.0
attribute vec3 a_Position;
attribute vec4 a_Instance;
attribute vec4 a_Color;
attribute float a_Size;
attribute vec2 a_iconMapUV;

uniform float u_globel;
uniform float u_globel_radius;
uniform float u_global_height: 10;
uniform mat4 u_ModelMatrix;

uniform float segmentNumber;
uniform vec4 u_animate: [ 1., 2., 1.0, 0.2 ];
uniform vec4 u_sourceColor;
uniform vec4 u_targetColor;

uniform float u_line_type: 0.0;
uniform vec4 u_dash_array: [10.0, 5., 0, 0];
uniform float u_icon_step: 100;
uniform float u_line_texture: 0.0;
varying float v_distance_ratio;

varying vec4 v_dash_array;
varying vec4 v_color;
varying vec2 v_iconMapUV;
varying vec4 v_Color;

#pragma include "projection"
#pragma include "project"
#pragma include "picking"

float maps (float value, float start1, float stop1, float start2, float stop2) {
  return start2 + (stop2 - start2) * ((value - start1) / (stop1 - start1));
}

float getSegmentRatio(float index) {
  return smoothstep(0.0, 1.0, index / (segmentNumber - 1.0));
}

float paraboloid(vec2 source, vec2 target, float ratio) {
  vec2 x = mix(source, target, ratio);
  vec2 center = mix(source, target, 0.5);
  float dSourceCenter = distance(source, center);
  float dXCenter = distance(x, center);
  return (dSourceCenter + dXCenter) * (dSourceCenter - dXCenter);
}

vec3 getPos(vec2 source, vec2 target, float segmentRatio) {
  float vertex_height = paraboloid(source, target, segmentRatio);

  return vec3(
    mix(source, target, segmentRatio),
    sqrt(max(0.0, vertex_height))
  );
}
vec2 getExtrusionOffset(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
  dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);

  vec2 offset = dir_screenspace * offset_direction * setPickingSize(a_Size) / 2.0;

  return offset;
}
vec2 getNormal(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
  dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
  return reverse_offset_normal(vec3(dir_screenspace,1.0)).xy * sign(offset_direction);
}

float torad(float deg) {
  return (deg / 180.0) * acos(-1.0);
}

vec3 lglt2xyz(vec2 lnglat) {
  float pi = 3.1415926;
  // + Math.PI/2 \u662F\u4E3A\u4E86\u5BF9\u9F50\u5750\u6807
  float lng = torad(lnglat.x) + pi / 2.0;
  float lat = torad(lnglat.y);

  // \u624B\u52A8\u589E\u52A0\u4E00\u4E9B\u504F\u79FB\uFF0C\u51CF\u8F7B\u9762\u7684\u51B2\u7A81
  float radius = u_globel_radius;

  float z = radius * cos(lat) * cos(lng);
  float x = radius * cos(lat) * sin(lng);
  float y = radius * sin(lat);
  return vec3(x, y, z);
}

void main() {
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97

  v_color = a_Color;
  vec2 source = project_position(vec4(a_Instance.rg, 0, 0)).xy;
  vec2 target = project_position(vec4(a_Instance.ba, 0, 0)).xy;
  float segmentIndex = a_Position.x;
  float segmentRatio = getSegmentRatio(segmentIndex);
  float indexDir = mix(-1.0, 1.0, step(segmentIndex, 0.0));

  float d_distance_ratio;
   if(u_line_type == LineTypeDash) {
    d_distance_ratio = segmentIndex / segmentNumber;
    // float total_Distance = pixelDistance(a_Instance.rg, a_Instance.ba) / 2.0 * PI;
    vec2 s = source;
    vec2 t = target;
    
    if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
      s = unProjCustomCoord(source);
      t = unProjCustomCoord(target);
    }
    float total_Distance = pixelDistance(s, t) / 2.0 * PI;
    v_dash_array = pow(2.0, 20.0 - u_Zoom) * u_dash_array / (total_Distance / segmentNumber * segmentIndex);
  }
    if(u_animate.x == Animate) {
      v_distance_ratio = segmentIndex / segmentNumber;
  }


  float nextSegmentRatio = getSegmentRatio(segmentIndex + indexDir);
  vec3 curr = getPos(source, target, segmentRatio);
  vec3 next = getPos(source, target, nextSegmentRatio);
  vec2 offset = getExtrusionOffset((next.xy - curr.xy) * indexDir, a_Position.y);

  float animateSpeed = 0.0; // \u8FD0\u52A8\u901F\u5EA6
  v_Color = mix(u_sourceColor, u_targetColor, a_Position.x/segmentNumber);

  v_Color.a *= opacity;

  gl_Position = project_common_position_to_clipspace_v2(vec4(curr.xy + project_pixel(offset), curr.z, 1.0));

  // \u5730\u7403\u6A21\u5F0F
  if(u_globel > 0.0) {
    vec3 startLngLat = lglt2xyz(a_Instance.rg);
    vec3 endLngLat = lglt2xyz(a_Instance.ba);
    float globalRadius = length(startLngLat);

    vec3 lineDir = normalize(endLngLat - startLngLat);
    vec3 midPointDir = normalize((startLngLat + endLngLat)/2.0);

    // \u7EBF\u7684\u504F\u79FB
    vec3 lnglatOffset = cross(lineDir, midPointDir) * a_Position.y;
    // \u8BA1\u7B97\u8D77\u59CB\u70B9\u548C\u7EC8\u6B62\u70B9\u7684\u8DDD\u79BB
    float lnglatLength = length(a_Instance.rg - a_Instance.ba)/50.0;
    // \u8BA1\u7B97\u98DE\u7EBF\u5404\u4E2A\u8282\u70B9\u76F8\u5E94\u7684\u9AD8\u5EA6
    float lineHeight = u_global_height * (-4.0*segmentRatio*segmentRatio + 4.0 * segmentRatio) * lnglatLength;
    // \u5730\u7403\u70B9\u4F4D
    vec3 globalPoint = normalize(mix(startLngLat, endLngLat, segmentRatio)) * (globalRadius + lineHeight) + lnglatOffset * a_Size;
    
    gl_Position = u_ViewProjectionMatrix * vec4(globalPoint, 1.0);
  }
 

  setPickingColor(a_PickingColor);
}
`,kR={solid:0,dash:1},UR=function(e){(0,ke.Z)(r,e);var t=OR(r);function r(){var n;(0,ue.Z)(this,r);for(var i=arguments.length,a=new Array(i),s=0;s<i;s++)a[s]=arguments[s];return n=t.call.apply(t,[this].concat(a)),(0,ve.Z)((0,St.Z)(n),"updateTexture",function(){var l=n.rendererService.createTexture2D;if(n.texture){n.texture.update({data:n.iconService.getCanvas()}),n.layer.render();return}n.texture=l({data:n.iconService.getCanvas(),mag:Fe.NEAREST,min:Fe.NEAREST,premultiplyAlpha:!1,width:1024,height:n.iconService.canvasHeight||128})}),n}return(0,_e.Z)(r,[{key:"getUninforms",value:function(){var i=this.layer.getLayerConfig(),a=i.sourceColor,s=i.targetColor,l=i.textureBlend,p=l===void 0?"normal":l,m=i.lineType,T=m===void 0?"solid":m,R=i.dashArray,L=R===void 0?[10,5]:R,z=i.lineTexture,re=z===void 0?!1:z,ee=i.iconStep,me=ee===void 0?100:ee,Ie=i.segmentNumber,He=Ie===void 0?30:Ie,Xe=i.globalArcHeight,ot=Xe===void 0?10:Xe;L.length===2&&L.push(0,0);var pt=0,dt=[0,0,0,0],It=[0,0,0,0];return a&&s&&(dt=Qi(a),It=Qi(s),pt=1),this.rendererService.getDirty()&&this.texture.bind(),(0,Q.Z)({u_globel:this.mapService.version==="GLOBEL"?1:0,u_globel_radius:Xm,u_global_height:ot,u_textureBlend:p==="normal"?0:1,segmentNumber:He,u_line_type:kR[T]||0,u_dash_array:L,u_texture:this.texture,u_line_texture:re?1:0,u_icon_step:me,u_textSize:[1024,this.iconService.canvasHeight||128],u_linearColor:pt,u_sourceColor:dt,u_targetColor:It},this.getStyleAttribute())}},{key:"getAnimateUniforms",value:function(){var i=this.layer.getLayerConfig(),a=i.animateOption;return{u_animate:this.animateOption2Array(a),u_time:this.layer.getLayerAnimateTime()}}},{key:"initModels",value:function(){var n=(0,hr.Z)(it().mark(function a(){return it().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return this.updateTexture(),this.iconService.on("imageUpdate",this.updateTexture),l.abrupt("return",this.buildModels());case 3:case"end":return l.stop()}},a,this)}));function i(){return n.apply(this,arguments)}return i}()},{key:"clearModels",value:function(){var i;(i=this.texture)===null||i===void 0||i.destroy(),this.iconService.off("imageUpdate",this.updateTexture)}},{key:"getShaders",value:function(){var i=this.layer.getLayerConfig(),a=i.sourceColor,s=i.targetColor;return a&&s?{frag:FR,vert:BR,type:"Linear"}:{frag:DR,vert:LR,type:""}}},{key:"buildModels",value:function(){var n=(0,hr.Z)(it().mark(function a(){var s,l,p,m,T,R,L,z;return it().wrap(function(ee){for(;;)switch(ee.prev=ee.next){case 0:return s=this.layer.getLayerConfig(),l=s.segmentNumber,p=l===void 0?30:l,m=this.getShaders(),T=m.frag,R=m.vert,L=m.type,ee.next=4,this.layer.buildLayerModel({moduleName:"lineArc3d"+L,vertexShader:R,fragmentShader:T,inject:this.getInject(),triangulation:ng,styleOption:{segmentNumber:p}});case 4:return z=ee.sent,ee.abrupt("return",[z]);case 6:case"end":return ee.stop()}},a,this)}));function i(){return n.apply(this,arguments)}return i}()},{key:"registerBuiltinAttributes",value:function(){var i=this;this.styleAttributeService.registerStyleAttribute({name:"size",type:bn.Attribute,descriptor:{name:"a_Size",buffer:{usage:Fe.DYNAMIC_DRAW,data:[],type:Fe.FLOAT},size:1,update:function(s){var l=s.size,p=l===void 0?1:l;return Array.isArray(p)?[p[0]]:[p]}}}),this.styleAttributeService.registerStyleAttribute({name:"instance",type:bn.Attribute,descriptor:{name:"a_Instance",buffer:{usage:Fe.STATIC_DRAW,data:[],type:Fe.FLOAT},size:4,update:function(s,l,p){return[p[3],p[4],p[5],p[6]]}}}),this.styleAttributeService.registerStyleAttribute({name:"uv",type:bn.Attribute,descriptor:{name:"a_iconMapUV",buffer:{usage:Fe.DYNAMIC_DRAW,data:[],type:Fe.FLOAT},size:2,update:function(s){var l=i.iconService.getIconMap(),p=s.texture,m=l[p]||{x:0,y:0},T=m.x,R=m.y;return[T,R]}}})}}]),r}(Lo);function ZR(e){var t=zR();return function(){var n=(0,le.Z)(e),i;if(t){var a=(0,le.Z)(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return(0,ze.Z)(this,i)}}function zR(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var GR=`#define LineTypeSolid 0.0
#define LineTypeDash 1.0
#define Animate 0.0
#define LineTexture 1.0

uniform float u_textureBlend;
uniform float u_blur : 0.9;
uniform float u_line_type: 0.0;
// varying vec2 v_normal;
varying vec4 v_dash_array;
varying vec4 v_color;
varying vec4 v_line_data;

uniform float u_line_texture: 0.0;
uniform sampler2D u_texture;
uniform vec2 u_textSize;
varying float v_segmentIndex;
uniform float segmentNumber;


varying vec2 v_iconMapUV;

uniform float u_time;
uniform vec4 u_animate: [ 1., 2., 1.0, 0.2 ];


#pragma include "picking"

void main() {
  float animateSpeed = 0.0; // \u8FD0\u52A8\u901F\u5EA6
  float d_distance_ratio = v_line_data.g; // \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B
  gl_FragColor = v_color;

  if(u_line_type == LineTypeDash) {
    float flag = 0.;
    float dashLength = mod(d_distance_ratio, v_dash_array.x + v_dash_array.y + v_dash_array.z + v_dash_array.w);
    if(dashLength < v_dash_array.x || (dashLength > (v_dash_array.x + v_dash_array.y) && dashLength <  v_dash_array.x + v_dash_array.y + v_dash_array.z)) {
      flag = 1.;
    }
    gl_FragColor.a *=flag;
  }

  if(u_animate.x == Animate && u_line_texture != LineTexture) {
      animateSpeed = u_time / u_animate.y;
      float alpha =1.0 - fract( mod(1.0- d_distance_ratio, u_animate.z)* (1.0/ u_animate.z) + u_time / u_animate.y);

      alpha = (alpha + u_animate.w -1.0) / u_animate.w;
      // alpha = smoothstep(0., 1., alpha);
      alpha = clamp(alpha, 0.0, 1.0);
      gl_FragColor.a *= alpha;

      // u_animate 
      // x enable
      // y duration
      // z interval
      // w trailLength
  }

  if(u_line_texture == LineTexture && u_line_type != LineTypeDash) { // while load texture
    // float arcRadio = smoothstep( 0.0, 1.0, (v_segmentIndex / segmentNumber));
    float arcRadio = v_segmentIndex / (segmentNumber - 1.0);
    float count = v_line_data.b; // // \u8D34\u56FE\u5728\u5F27\u7EBF\u4E0A\u91CD\u590D\u7684\u6570\u91CF

    float time = 0.0;
    if(u_animate.x == Animate) {
      time = u_time / u_animate.y;
    }
    float redioCount = arcRadio * count;

    float u = fract(redioCount - time);

    float v = v_line_data.a;  // \u7EBF\u56FE\u5C42\u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\u503C
    vec2 uv= v_iconMapUV / u_textSize + vec2(u, v) / u_textSize * 64.;
    vec4 pattern = texture2D(u_texture, uv);

    if(u_animate.x == Animate) {
      float currentPlane = floor(redioCount - time);
      float textureStep = floor(count * u_animate.z);
      float a = mod(currentPlane, textureStep);
      if(a < textureStep - 1.0) {
        pattern = vec4(0.0);
      }
    }

    if(u_textureBlend == 0.0) { // normal
      pattern.a = 0.0;
      gl_FragColor = filterColor(gl_FragColor + pattern);
    } else { // replace
        pattern.a *= v_color.a;
        if(gl_FragColor.a <= 0.0) {
          pattern.a = 0.0;
          discard;
        } else {
          gl_FragColor = filterColor(pattern);
        }
    }

  } else {
    gl_FragColor = filterColor(gl_FragColor);
  }
}
`,VR=`#define LineTypeSolid 0.0
#define LineTypeDash 1.0
#define Animate 0.0
#define LineTexture 1.0
attribute vec3 a_Position;
attribute vec4 a_Instance;
attribute vec4 a_Color;
attribute float a_Size;

uniform float u_globel;
uniform float u_globel_radius;
uniform float u_global_height: 10;
uniform mat4 u_ModelMatrix;

uniform float segmentNumber;
uniform vec4 u_animate: [ 1., 2., 1.0, 0.2 ];
varying vec4 v_color;

uniform float u_line_type: 0.0;
uniform vec4 u_dash_array: [10.0, 5., 0, 0];
varying vec4 v_dash_array;

uniform float u_icon_step: 100;
uniform float u_line_texture: 0.0;
varying float v_segmentIndex;

attribute vec2 a_iconMapUV;
varying vec2 v_iconMapUV;
varying vec4 v_line_data;

#pragma include "projection"
#pragma include "project"
#pragma include "picking"

float maps (float value, float start1, float stop1, float start2, float stop2) {
  return start2 + (stop2 - start2) * ((value - start1) / (stop1 - start1));
}

float getSegmentRatio(float index) {
  return smoothstep(0.0, 1.0, index / (segmentNumber - 1.0));
}

float paraboloid(vec2 source, vec2 target, float ratio) {
  vec2 x = mix(source, target, ratio);
  vec2 center = mix(source, target, 0.5);
  float dSourceCenter = distance(source, center);
  float dXCenter = distance(x, center);
  return (dSourceCenter + dXCenter) * (dSourceCenter - dXCenter);
}

vec3 getPos(vec2 source, vec2 target, float segmentRatio) {
  float vertex_height = paraboloid(source, target, segmentRatio);

  return vec3(
    mix(source, target, segmentRatio),
    sqrt(max(0.0, vertex_height))
  );
}
vec2 getExtrusionOffset(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
  dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);

  vec2 offset = dir_screenspace * offset_direction * setPickingSize(a_Size) / 2.0;

  return offset;
}
vec2 getNormal(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
  dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
  return reverse_offset_normal(vec3(dir_screenspace,1.0)).xy * sign(offset_direction);
}

float torad(float deg) {
  return (deg / 180.0) * acos(-1.0);
}

vec3 lglt2xyz(vec2 lnglat) {
  float pi = 3.1415926;
  // + Math.PI/2 \u662F\u4E3A\u4E86\u5BF9\u9F50\u5750\u6807
  float lng = torad(lnglat.x) + pi / 2.0;
  float lat = torad(lnglat.y);

  // \u624B\u52A8\u589E\u52A0\u4E00\u4E9B\u504F\u79FB\uFF0C\u51CF\u8F7B\u9762\u7684\u51B2\u7A81
  float radius = u_globel_radius;

  float z = radius * cos(lat) * cos(lng);
  float x = radius * cos(lat) * sin(lng);
  float y = radius * sin(lat);
  return vec3(x, y, z);
}

void main() {

  v_color = a_Color;
  v_color.a = v_color.a * opacity;
  vec2 source = project_position(vec4(a_Instance.rg, 0, 0)).xy;
  vec2 target = project_position(vec4(a_Instance.ba, 0, 0)).xy;
  float segmentIndex = a_Position.x;
  float segmentRatio = getSegmentRatio(segmentIndex);
  float indexDir = mix(-1.0, 1.0, step(segmentIndex, 0.0));

  float d_distance_ratio;
   if(u_line_type == LineTypeDash) {
    d_distance_ratio = segmentIndex / segmentNumber;
    vec2 s = source;
    vec2 t = target;
    
    if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
      s = unProjCustomCoord(source);
      t = unProjCustomCoord(target);
    }
    float total_Distance = pixelDistance(s, t) / 2.0 * PI;
    v_dash_array = pow(2.0, 20.0 - u_Zoom) * u_dash_array / (total_Distance / segmentNumber * segmentIndex);
  }
    if(u_animate.x == Animate) {
      d_distance_ratio = segmentIndex / segmentNumber;
  }
  v_line_data.g = d_distance_ratio; // \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B

  float nextSegmentRatio = getSegmentRatio(segmentIndex + indexDir);
  vec3 curr = getPos(source, target, segmentRatio);
  vec3 next = getPos(source, target, nextSegmentRatio);
  vec2 offset = getExtrusionOffset((next.xy - curr.xy) * indexDir, a_Position.y);
  // v_normal = getNormal((next.xy - curr.xy) * indexDir, a_Position.y);


  v_segmentIndex = a_Position.x;
  if(LineTexture == u_line_texture && u_line_type != LineTypeDash) { // \u5F00\u542F\u8D34\u56FE\u6A21\u5F0F  

    float arcDistrance = length(source - target);
    float pixelLen =  project_pixel_texture(u_icon_step);
    v_line_data.b = floor(arcDistrance/pixelLen); // \u8D34\u56FE\u5728\u5F27\u7EBF\u4E0A\u91CD\u590D\u7684\u6570\u91CF

    vec2 projectOffset = project_pixel(offset);
    float lineOffsetWidth = length(projectOffset + projectOffset * sign(a_Position.y)); // \u7EBF\u6A2A\u5411\u504F\u79FB\u7684\u8DDD\u79BB
    float linePixelSize = project_pixel(a_Size);  // \u5B9A\u70B9\u4F4D\u7F6E\u504F\u79FB\uFF0C\u6309\u5730\u56FE\u7B49\u7EA7\u7F29\u653E\u540E\u7684\u8DDD\u79BB
    v_line_data.a = lineOffsetWidth/linePixelSize;  // \u7EBF\u56FE\u5C42\u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\u503C

    v_iconMapUV = a_iconMapUV;
  }


  gl_Position = project_common_position_to_clipspace_v2(vec4(curr.xy + project_pixel(offset), curr.z * thetaOffset, 1.0));

  // \u5730\u7403\u6A21\u5F0F
  if(u_globel > 0.0) {
    vec3 startLngLat = lglt2xyz(a_Instance.rg);
    vec3 endLngLat = lglt2xyz(a_Instance.ba);
    float globalRadius = length(startLngLat);

    vec3 lineDir = normalize(endLngLat - startLngLat);
    vec3 midPointDir = normalize((startLngLat + endLngLat)/2.0);

    // \u7EBF\u7684\u504F\u79FB
    vec3 lnglatOffset = cross(lineDir, midPointDir) * a_Position.y;
    // \u8BA1\u7B97\u8D77\u59CB\u70B9\u548C\u7EC8\u6B62\u70B9\u7684\u8DDD\u79BB
    float lnglatLength = length(a_Instance.rg - a_Instance.ba)/50.0;
    // \u8BA1\u7B97\u98DE\u7EBF\u5404\u4E2A\u8282\u70B9\u76F8\u5E94\u7684\u9AD8\u5EA6
    float lineHeight = u_global_height * (-4.0*segmentRatio*segmentRatio + 4.0 * segmentRatio) * lnglatLength;
    // \u5730\u7403\u70B9\u4F4D
    vec3 globalPoint = normalize(mix(startLngLat, endLngLat, segmentRatio)) * (globalRadius + lineHeight) + lnglatOffset * a_Size;
    
    gl_Position = u_ViewProjectionMatrix * vec4(globalPoint, 1.0);
  }
 

  setPickingColor(a_PickingColor);
}
`,HR=`
#define Animate 0.0
uniform float u_time;
uniform vec4 u_animate: [ 1., 2., 1.0, 0.2 ];
varying vec4 v_Color;

varying float v_distance_ratio;
#pragma include "picking"

void main() {

  float animateSpeed = 0.0; // \u8FD0\u52A8\u901F\u5EA6
  gl_FragColor = v_Color;

  if(u_animate.x == Animate) {
      animateSpeed = u_time / u_animate.y;
      float alpha =1.0 - fract( mod(1.0- v_distance_ratio, u_animate.z)* (1.0/ u_animate.z) + u_time / u_animate.y);

      alpha = (alpha + u_animate.w -1.0) / u_animate.w;
      // alpha = smoothstep(0., 1., alpha);
      alpha = clamp(alpha, 0.0, 1.0);
      gl_FragColor.a *= alpha;

      // u_animate 
      // x enable
      // y duration
      // z interval
      // w trailLength
  }

  gl_FragColor = filterColor(gl_FragColor);
}
`,WR=`#define LineTypeSolid 0.0
#define LineTypeDash 1.0
#define Animate 0.0
#define LineTexture 1.0
attribute vec3 a_Position;
attribute vec4 a_Instance;
attribute vec4 a_Color;
attribute float a_Size;
attribute vec2 a_iconMapUV;

uniform float u_globel;
uniform float u_globel_radius;
uniform float u_global_height: 10;
uniform mat4 u_ModelMatrix;

uniform float segmentNumber;
uniform vec4 u_animate: [ 1., 2., 1.0, 0.2 ];
uniform vec4 u_sourceColor;
uniform vec4 u_targetColor;

uniform float u_line_type: 0.0;
uniform vec4 u_dash_array: [10.0, 5., 0, 0];
uniform float u_icon_step: 100;
uniform float u_line_texture: 0.0;
varying float v_distance_ratio;

varying vec4 v_dash_array;
varying vec4 v_color;
varying vec2 v_iconMapUV;
varying vec4 v_Color;

#pragma include "projection"
#pragma include "project"
#pragma include "picking"

float maps (float value, float start1, float stop1, float start2, float stop2) {
  return start2 + (stop2 - start2) * ((value - start1) / (stop1 - start1));
}

float getSegmentRatio(float index) {
  return smoothstep(0.0, 1.0, index / (segmentNumber - 1.0));
}

float paraboloid(vec2 source, vec2 target, float ratio) {
  vec2 x = mix(source, target, ratio);
  vec2 center = mix(source, target, 0.5);
  float dSourceCenter = distance(source, center);
  float dXCenter = distance(x, center);
  return (dSourceCenter + dXCenter) * (dSourceCenter - dXCenter);
}

vec3 getPos(vec2 source, vec2 target, float segmentRatio) {
  float vertex_height = paraboloid(source, target, segmentRatio);

  return vec3(
    mix(source, target, segmentRatio),
    sqrt(max(0.0, vertex_height))
  );
}
vec2 getExtrusionOffset(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
  dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);

  vec2 offset = dir_screenspace * offset_direction * setPickingSize(a_Size) / 2.0;

  return offset;
}
vec2 getNormal(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
  dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
  return reverse_offset_normal(vec3(dir_screenspace,1.0)).xy * sign(offset_direction);
}

float torad(float deg) {
  return (deg / 180.0) * acos(-1.0);
}

vec3 lglt2xyz(vec2 lnglat) {
  float pi = 3.1415926;
  // + Math.PI/2 \u662F\u4E3A\u4E86\u5BF9\u9F50\u5750\u6807
  float lng = torad(lnglat.x) + pi / 2.0;
  float lat = torad(lnglat.y);

  // \u624B\u52A8\u589E\u52A0\u4E00\u4E9B\u504F\u79FB\uFF0C\u51CF\u8F7B\u9762\u7684\u51B2\u7A81
  float radius = u_globel_radius;

  float z = radius * cos(lat) * cos(lng);
  float x = radius * cos(lat) * sin(lng);
  float y = radius * sin(lat);
  return vec3(x, y, z);
}

void main() {
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97

  v_color = a_Color;
  vec2 source = project_position(vec4(a_Instance.rg, 0, 0)).xy;
  vec2 target = project_position(vec4(a_Instance.ba, 0, 0)).xy;
  float segmentIndex = a_Position.x;
  float segmentRatio = getSegmentRatio(segmentIndex);
  float indexDir = mix(-1.0, 1.0, step(segmentIndex, 0.0));

  float d_distance_ratio;
   if(u_line_type == LineTypeDash) {
    d_distance_ratio = segmentIndex / segmentNumber;
    // float total_Distance = pixelDistance(a_Instance.rg, a_Instance.ba) / 2.0 * PI;
    vec2 s = source;
    vec2 t = target;
    
    if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
      s = unProjCustomCoord(source);
      t = unProjCustomCoord(target);
    }
    float total_Distance = pixelDistance(s, t) / 2.0 * PI;
    v_dash_array = pow(2.0, 20.0 - u_Zoom) * u_dash_array / (total_Distance / segmentNumber * segmentIndex);
  }
    if(u_animate.x == Animate) {
      v_distance_ratio = segmentIndex / segmentNumber;
  }


  float nextSegmentRatio = getSegmentRatio(segmentIndex + indexDir);
  vec3 curr = getPos(source, target, segmentRatio);
  vec3 next = getPos(source, target, nextSegmentRatio);
  vec2 offset = getExtrusionOffset((next.xy - curr.xy) * indexDir, a_Position.y);

  float animateSpeed = 0.0; // \u8FD0\u52A8\u901F\u5EA6
  v_Color = mix(u_sourceColor, u_targetColor, a_Position.x/segmentNumber);

  v_Color.a *= opacity;

  gl_Position = project_common_position_to_clipspace_v2(vec4(curr.xy + project_pixel(offset), curr.z, 1.0));

  // \u5730\u7403\u6A21\u5F0F
  if(u_globel > 0.0) {
    vec3 startLngLat = lglt2xyz(a_Instance.rg);
    vec3 endLngLat = lglt2xyz(a_Instance.ba);
    float globalRadius = length(startLngLat);

    vec3 lineDir = normalize(endLngLat - startLngLat);
    vec3 midPointDir = normalize((startLngLat + endLngLat)/2.0);

    // \u7EBF\u7684\u504F\u79FB
    vec3 lnglatOffset = cross(lineDir, midPointDir) * a_Position.y;
    // \u8BA1\u7B97\u8D77\u59CB\u70B9\u548C\u7EC8\u6B62\u70B9\u7684\u8DDD\u79BB
    float lnglatLength = length(a_Instance.rg - a_Instance.ba)/50.0;
    // \u8BA1\u7B97\u98DE\u7EBF\u5404\u4E2A\u8282\u70B9\u76F8\u5E94\u7684\u9AD8\u5EA6
    float lineHeight = u_global_height * (-4.0*segmentRatio*segmentRatio + 4.0 * segmentRatio) * lnglatLength;
    // \u5730\u7403\u70B9\u4F4D
    vec3 globalPoint = normalize(mix(startLngLat, endLngLat, segmentRatio)) * (globalRadius + lineHeight) + lnglatOffset * a_Size;
    
    gl_Position = u_ViewProjectionMatrix * vec4(globalPoint, 1.0);
  }
 

  setPickingColor(a_PickingColor);
}
`,jR={solid:0,dash:1},XR=function(e){(0,ke.Z)(r,e);var t=ZR(r);function r(){var n;(0,ue.Z)(this,r);for(var i=arguments.length,a=new Array(i),s=0;s<i;s++)a[s]=arguments[s];return n=t.call.apply(t,[this].concat(a)),(0,ve.Z)((0,St.Z)(n),"updateTexture",function(){var l=n.rendererService.createTexture2D;if(n.texture){n.texture.update({data:n.iconService.getCanvas()}),n.layer.render();return}n.texture=l({data:n.iconService.getCanvas(),mag:Fe.NEAREST,min:Fe.NEAREST,premultiplyAlpha:!1,width:1024,height:n.iconService.canvasHeight||128})}),n}return(0,_e.Z)(r,[{key:"getUninforms",value:function(){var i=this.layer.getLayerConfig(),a=i.opacity,s=a===void 0?1:a,l=i.sourceColor,p=i.targetColor,m=i.textureBlend,T=m===void 0?"normal":m,R=i.lineType,L=R===void 0?"solid":R,z=i.dashArray,re=z===void 0?[10,5]:z,ee=i.lineTexture,me=ee===void 0?!1:ee,Ie=i.iconStep,He=Ie===void 0?100:Ie,Xe=i.segmentNumber,ot=Xe===void 0?30:Xe,pt=i.globalArcHeight,dt=pt===void 0?10:pt;re.length===2&&re.push(0,0);var It=0,Vt=[0,0,0,0],Kt=[0,0,0,0];return l&&p&&(Vt=Qi(l),Kt=Qi(p),It=1),this.rendererService.getDirty()&&this.texture.bind(),{u_globel:1,u_globel_radius:Xm,u_global_height:dt,u_opacity:s,u_textureBlend:T==="normal"?0:1,segmentNumber:ot,u_line_type:jR[L]||0,u_dash_array:re,u_texture:this.texture,u_line_texture:me?1:0,u_icon_step:He,u_textSize:[1024,this.iconService.canvasHeight||128],u_linearColor:It,u_sourceColor:Vt,u_targetColor:Kt}}},{key:"getAnimateUniforms",value:function(){var i=this.layer.getLayerConfig(),a=i.animateOption;return{u_animate:this.animateOption2Array(a),u_time:this.layer.getLayerAnimateTime()}}},{key:"initModels",value:function(){var n=(0,hr.Z)(it().mark(function a(){return it().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return this.updateTexture(),this.iconService.on("imageUpdate",this.updateTexture),l.abrupt("return",this.buildModels());case 3:case"end":return l.stop()}},a,this)}));function i(){return n.apply(this,arguments)}return i}()},{key:"clearModels",value:function(){var i;(i=this.texture)===null||i===void 0||i.destroy(),this.iconService.off("imageUpdate",this.updateTexture)}},{key:"getShaders",value:function(){var i=this.layer.getLayerConfig(),a=i.sourceColor,s=i.targetColor;return a&&s?{frag:HR,vert:WR,type:"Linear"}:{frag:GR,vert:VR,type:""}}},{key:"buildModels",value:function(){var n=(0,hr.Z)(it().mark(function a(){var s,l,p,m,T,R,L,z;return it().wrap(function(ee){for(;;)switch(ee.prev=ee.next){case 0:return s=this.layer.getLayerConfig(),l=s.segmentNumber,p=l===void 0?30:l,m=this.getShaders(),T=m.frag,R=m.vert,L=m.type,ee.next=4,this.layer.buildLayerModel({moduleName:"lineEarthArc3d"+L,vertexShader:R,fragmentShader:T,triangulation:ng,depth:{enable:!0},styleOption:{segmentNumber:p}});case 4:return z=ee.sent,ee.abrupt("return",[z]);case 6:case"end":return ee.stop()}},a,this)}));function i(){return n.apply(this,arguments)}return i}()},{key:"registerBuiltinAttributes",value:function(){var i=this;this.styleAttributeService.registerStyleAttribute({name:"size",type:bn.Attribute,descriptor:{name:"a_Size",buffer:{usage:Fe.DYNAMIC_DRAW,data:[],type:Fe.FLOAT},size:1,update:function(s){var l=s.size,p=l===void 0?1:l;return Array.isArray(p)?[p[0]]:[p]}}}),this.styleAttributeService.registerStyleAttribute({name:"instance",type:bn.Attribute,descriptor:{name:"a_Instance",buffer:{usage:Fe.STATIC_DRAW,data:[],type:Fe.FLOAT},size:4,update:function(s,l,p){return[p[3],p[4],p[5],p[6]]}}}),this.styleAttributeService.registerStyleAttribute({name:"uv",type:bn.Attribute,descriptor:{name:"a_iconMapUV",buffer:{usage:Fe.DYNAMIC_DRAW,data:[],type:Fe.FLOAT},size:2,update:function(s){var l=i.iconService.getIconMap(),p=s.texture,m=l[p]||{x:0,y:0},T=m.x,R=m.y;return[T,R]}}})}}]),r}(Lo),A2={circle:2,triangle:2,diamond:4,rect:2,classic:3,halfTriangle:2,none:0},Mc=1/2;function YR(e,t){var r=t.width,n=r===void 0?2:r,i=t.height,a=i===void 0?1:i;return{vertices:[0,Mc*e,1*e*n,-(a+Mc)*e,1*e*n,(a-Mc)*e,0,Mc*e,1*e*n,-(a+Mc)*e,1*e*n,(a-Mc)*e],indices:[3,4,5],outLineIndices:[0,1,2],normals:[1*e,-2*e,1,-2*e,1.5*e,1,1*e,1.5*e,1,0,0,0,0,0,0,0,0,0],dimensions:2}}function $R(e,t){var r=t.width,n=r===void 0?2:r,i=t.height,a=i===void 0?3:i;return{vertices:[0,0,1*e*n,1*a,1*e*n,-1*a,0,0,1*e*n,1*a,1*e*n,-1*a],outLineIndices:[0,1,2],indices:[3,4,5],normals:[0,-1.5*e,1,2,1*e,1,-2,1*e,1,0,0,0,0,0,0,0,0,0],dimensions:2}}function QR(e,t){var r=t.width,n=r===void 0?2:r,i=t.height,a=i===void 0?2:i;return{vertices:[0,a/2,e*n*1,a/2,e*n*1,-a/2,0,-a/2,0,a/2,e*n*1,a/2,e*n*1,-a/2,0,-a/2],dimensions:2,indices:[4,5,6,4,6,7],outLineIndices:[0,1,2,0,2,3],normals:[0,-e,1,1,0,1,0,-e,1,-1,-0,1,0,0,0,0,0,0,0,0,0,0,0,0]}}function qR(e,t){var r=t.width,n=r===void 0?2:r,i=t.height,a=i===void 0?3:i;return{vertices:[0,0,1*n*e,.5*a,2*n*e,0,1*n*e,-.5*a,0,0,1*n*e,.5*a,2*n*e,0,1*n*e,-.5*a],dimensions:2,indices:[4,5,6,4,6,7],outLineIndices:[0,1,2,0,2,3],normals:[0,-e,1,1,0,1,0,-e,1,-1,-0,1,0,0,0,0,0,0,0,0,0,0,0,0]}}function KR(e,t){var r=t.width,n=r===void 0?2:r,i=t.height,a=i===void 0?3:i;return{vertices:[0,0,2*e*n,1*a,1.5*e*n,0,2*e*n,-1*a,0,0,2*e*n,1*a,1.5*e*n,0,2*e*n,-1*a],dimensions:2,indices:[4,5,6,4,6,7],outLineIndices:[0,1,2,0,2,3],normals:[0,-e,1,1,0,1,0,-e,1,-1,-0,1,0,0,0,0,0,0,0,0,0,0,0,0]}}function JR(e,t){var r=t.width,n=r===void 0?2:r,i=t.height,a=i===void 0?2:i,s=Km(),l=_a().flatten([s]),p=_a()(l.vertices,l.holes,l.dimensions),m=s.map(function(T){return[T[0]*n*e,T[1]*a]}).flat();return{vertices:[].concat((0,cr.Z)(m),(0,cr.Z)(m)),dimensions:2,indices:p.map(function(T){return T+s.length}),outLineIndices:p,normals:[].concat((0,cr.Z)(s.map(function(T){return[T[1]*a,T[0]*n*e,1]}).flat()),(0,cr.Z)(new Array(s.length*3).fill(0)))}}function eM(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=arguments.length>2?arguments[2]:void 0,n=(0,eu.Z)(r.source)==="object"?r.source.type:r.source,i=(0,eu.Z)(r.target)==="object"?r.target.type:r.target,a=(0,eu.Z)(r.source)==="object"?r.source:{},s=a.width,l=s===void 0?n?A2[n]:0:s,p=a.height,m=p===void 0?2:p,T=(0,eu.Z)(r.target)==="object"?r.target:{},R=T.width,L=R===void 0?i?A2[i]:0:R,z=T.height,re=z===void 0?2:z;return{vertices:[0,Mc,1*l].concat((0,cr.Z)(e),[1,Mc,-1*L],(0,cr.Z)(e),[1,-Mc,-1*L],(0,cr.Z)(e),[0,-Mc,1*l],(0,cr.Z)(e),[0,Mc,1*l],(0,cr.Z)(e),[1,Mc,-1*L],(0,cr.Z)(e),[1,-Mc,-1*L],(0,cr.Z)(e),[0,-Mc,1*l],(0,cr.Z)(e)),outLineIndices:[0,1,2,0,2,3].map(function(ee){return ee+t}),indices:[4,5,6,4,6,7].map(function(ee){return ee+t}),normals:[1,-1,1,1,1,1,-1,0,1,-1,0,1,0,0,0,0,0,0,0,0,0,0,0,0],dimensions:2}}function p2(e,t){var r=(0,eu.Z)(e)==="object"?e.type:e,n=t==="source"?1:-1,i=(0,eu.Z)(e)==="object"?e:{};switch(r){case"circle":return JR(n,i);case"triangle":return $R(n,i);case"diamond":return qR(n,i);case"rect":return QR(n,i);case"classic":return KR(n,i);case"halfTriangle":return YR(n,i);default:return{vertices:[],indices:[],normals:[],dimensions:2,outLineIndices:[],outLineNormals:[]}}}function tM(e){var t=e.coordinates.flat(),r=1,n=1;return{vertices:[1,0,0].concat((0,cr.Z)(t),[1,2,-3],(0,cr.Z)(t),[1,1,-3],(0,cr.Z)(t),[0,1,0],(0,cr.Z)(t),[0,0,0],(0,cr.Z)(t),[1,0,0],(0,cr.Z)(t),[1,2,-3],(0,cr.Z)(t),[1,1,-3],(0,cr.Z)(t),[0,1,0],(0,cr.Z)(t),[0,0,0],(0,cr.Z)(t)),normals:[-r,2*n,1,2*n,-n,1,n,-n,1,n,-n,1,-r,-n,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],indices:[0,1,2,0,2,3,0,3,4,5,6,7,5,7,8,5,8,9],size:7}}function rM(e,t){return t?nM(e,t):tM(e)}function nM(e,t){var r=e.coordinates.flat(),n=t,i=n.target,a=i===void 0?"classic":i,s=n.source,l=s===void 0?"circle":s,p=d2(p2(l,"source"),r,0,0),m=eM(r,p.vertices.length/7,t),T=d2(p2(a,"target"),r,1,p.vertices.length/7+m.vertices.length/7),R={vertices:[].concat((0,cr.Z)(p.vertices),(0,cr.Z)(m.vertices),(0,cr.Z)(T.vertices)),indices:[].concat((0,cr.Z)(p.outLineIndices),(0,cr.Z)(m.outLineIndices),(0,cr.Z)(T.outLineIndices),(0,cr.Z)(p.indices),(0,cr.Z)(m.indices),(0,cr.Z)(T.indices)),normals:[].concat((0,cr.Z)(p.normals),(0,cr.Z)(m.normals),(0,cr.Z)(T.normals)),size:7};return R}function d2(e,t){for(var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,i=[],a=e.vertices,s=e.indices,l=e.dimensions,p=e.outLineIndices,m=0;m<a.length;m+=l)i.push.apply(i,[r,a[m+1],a[m]].concat((0,cr.Z)(t)));return(0,Q.Z)((0,Q.Z)({},e),{},{vertices:i,indices:s.map(function(T){return T+n}),outLineIndices:p.map(function(T){return T+n})})}function iM(e){var t=aM();return function(){var n=(0,le.Z)(e),i;if(t){var a=(0,le.Z)(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return(0,ze.Z)(this,i)}}function aM(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var oM=`#extension GL_OES_standard_derivatives : enable

varying vec4 v_color;


// line texture

#pragma include "picking"

void main() {
gl_FragColor = v_color;
gl_FragColor = filterColor(gl_FragColor);
}
`,sM=`attribute vec4 a_Color;
attribute vec2 a_Size;
attribute vec4 a_Instance;
attribute vec3 a_Normal;
attribute vec3 a_Position;

uniform mat4 u_ModelMatrix;


#pragma include "projection"
#pragma include "project"
#pragma include "picking"
varying vec4 v_color;
uniform float u_gap_width: 1.0;
uniform float u_stroke_width: 1.0;
uniform float u_stroke_opacity: 1.0;

vec2 project_pixel_offset(vec2 offsets) {

   vec2 data = project_pixel(offsets);
   if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) {
    // P20_2 \u5750\u6807\u7CFB\u4E0B\uFF0C\u4E3A\u4E86\u548C Web \u58A8\u5361\u6258\u5750\u6807\u7CFB\u7EDF\u4E00\uFF0Czoom \u9ED8\u8BA4\u51CF3
    return data;
  }

  return vec2(data.x, -data.y);;
}

vec2 line_dir(vec2 target, vec2 source) {

   if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) {
    // P20_2 \u5750\u6807\u7CFB\u4E0B\uFF0C\u4E3A\u4E86\u548C Web \u58A8\u5361\u6258\u5750\u6807\u7CFB\u7EDF\u4E00\uFF0Czoom \u9ED8\u8BA4\u51CF3
     return normalize(target - source);
  }
  return normalize(ProjectFlat(target) - ProjectFlat(source));
}

float flag_gap() {
   if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) {
    // P20_2 \u5750\u6807\u7CFB\u4E0B\uFF0C\u4E3A\u4E86\u548C Web \u58A8\u5361\u6258\u5750\u6807\u7CFB\u7EDF\u4E00\uFF0Czoom \u9ED8\u8BA4\u51CF3
     return 1.;
  }
  return -1.;

}


void main() {

// \u900F\u660E\u5EA6\u8BA1\u7B97
  vec2 source = a_Instance.rg;  // \u8D77\u59CB\u70B9
  vec2 target =  a_Instance.ba; // \u7EC8\u70B9
  vec2 flowlineDir = line_dir(target,source);
  vec2 perpendicularDir = vec2(flowlineDir.y, flowlineDir.x); // mapbox || \u9AD8\u5FB7


  vec2 position = mix(source, target, a_Position.x);
  
  float lengthCommon = length(project_position(vec4(target,0,1)) - project_position(vec4(source,0,1)));  //    
  vec2 offsetDistances = a_Size.x * project_pixel_offset(vec2(a_Position.y, a_Position.z)); // Mapbox || \u9AD8\u5FB7
  vec2 limitedOffsetDistances = clamp(   
   offsetDistances,
   project_pixel(-lengthCommon*.2), project_pixel(lengthCommon*.2)
  );


  float startOffsetCommon = project_pixel(offsets[0]);
  float endOffsetCommon = project_pixel(offsets[1]);
  float endpointOffset = mix(
    clamp(startOffsetCommon, 0.0, lengthCommon*.2),
    -clamp(endOffsetCommon, 0.0, lengthCommon*.2),
    a_Position.x
  );

  vec2 normalsCommon =  u_stroke_width * project_pixel_offset(vec2(a_Normal.x, a_Normal.y)); // mapbox || \u9AD8\u5FB7

  float gapCommon = flag_gap() * project_pixel(u_gap_width);
  vec3 offsetCommon = vec3(
    flowlineDir * (limitedOffsetDistances[1] + normalsCommon.y + endpointOffset * 1.05) -
    perpendicularDir * (limitedOffsetDistances[0] + gapCommon + normalsCommon.x),
    0.0
  );


  vec4 project_pos = project_position(vec4(position.xy, 0, 1.0));

  vec4 fillColor = vec4(a_Color.rgb, a_Color.a * opacity);
  v_color = mix(fillColor, vec4(u_stroke.xyz, u_stroke.w * fillColor.w * u_stroke_opacity), a_Normal.z);

  gl_Position = project_common_position_to_clipspace_v2(vec4(project_pos.xy + offsetCommon.xy, 0., 1.0));



  setPickingColor(a_PickingColor);
}
`,uM=function(e){(0,ke.Z)(r,e);var t=iM(r);function r(){return(0,ue.Z)(this,r),t.apply(this,arguments)}return(0,_e.Z)(r,[{key:"getUninforms",value:function(){var i=this.layer.getLayerConfig(),a=i.gapWidth,s=a===void 0?2:a,l=i.strokeWidth,p=l===void 0?1:l,m=i.stroke,T=m===void 0?"#000":m,R=i.strokeOpacity,L=R===void 0?1:R;return(0,Q.Z)({u_gap_width:s,u_stroke_width:p,u_stroke:Qi(T),u_stroke_opacity:L},this.getStyleAttribute())}},{key:"initModels",value:function(){var n=(0,hr.Z)(it().mark(function a(){return it().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.abrupt("return",this.buildModels());case 1:case"end":return l.stop()}},a,this)}));function i(){return n.apply(this,arguments)}return i}()},{key:"buildModels",value:function(){var n=(0,hr.Z)(it().mark(function a(){var s;return it().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return p.next=2,this.layer.buildLayerModel({moduleName:"flow_line",vertexShader:sM,fragmentShader:oM,inject:this.getInject(),triangulation:rM,styleOption:this.layer.getLayerConfig().symbol,primitive:Fe.TRIANGLES,depth:{enable:!1},pick:!1});case 2:return s=p.sent,p.abrupt("return",[s]);case 4:case"end":return p.stop()}},a,this)}));function i(){return n.apply(this,arguments)}return i}()},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"size",type:bn.Attribute,descriptor:{name:"a_Size",buffer:{usage:Fe.DYNAMIC_DRAW,data:[],type:Fe.FLOAT},size:2,update:function(a){var s=a.size,l=s===void 0?1:s;return Array.isArray(l)?[l[0],l[1]]:[l,0]}}}),this.styleAttributeService.registerStyleAttribute({name:"instance",type:bn.Attribute,descriptor:{name:"a_Instance",buffer:{usage:Fe.STATIC_DRAW,data:[],type:Fe.FLOAT},size:4,update:function(a,s,l){return[l[3],l[4],l[5],l[6]]}}}),this.styleAttributeService.registerStyleAttribute({name:"normal",type:bn.Attribute,descriptor:{name:"a_Normal",buffer:{usage:Fe.STATIC_DRAW,data:[],type:Fe.FLOAT},size:3,update:function(a,s,l,p,m){return m}}})}}]),r}(Lo);function lM(e){var t=cM();return function(){var n=(0,le.Z)(e),i;if(t){var a=(0,le.Z)(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return(0,ze.Z)(this,i)}}function cM(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var fM=`#define LineTypeSolid 0.0
#define LineTypeDash 1.0
#define Animate 0.0
#define LineTexture 1.0

uniform float u_textureBlend;
uniform float u_blur : 0.9;
uniform float u_line_type: 0.0;
// varying vec2 v_normal;
varying vec4 v_dash_array;
varying float v_distance_ratio;
varying vec4 v_color;

uniform float u_time;
uniform vec4 u_animate: [ 1., 2., 1.0, 0.2 ];

uniform float u_line_texture: 0.0;
uniform sampler2D u_texture;
uniform vec2 u_textSize;
uniform float segmentNumber;

varying vec2 v_iconMapUV;

uniform float u_linearColor: 0;
uniform vec4 u_sourceColor;
uniform vec4 u_targetColor;
varying vec4 v_line_data;

#pragma include "picking"
#pragma include "project"
#pragma include "projection"

void main() {

  float animateSpeed = 0.0;
  float d_segmentIndex = v_line_data.g;
  
  // \u8BBE\u7F6E\u5F27\u7EBF\u7684\u5E95\u8272
  if(u_linearColor == 1.0) { // \u4F7F\u7528\u6E10\u53D8\u989C\u8272
    gl_FragColor = mix(u_sourceColor, u_targetColor, d_segmentIndex/segmentNumber);
     gl_FragColor.a *= v_color.a;
  } else { // \u4F7F\u7528 color \u65B9\u6CD5\u4F20\u5165\u7684\u989C\u8272
     gl_FragColor = v_color;
  }

  // float blur = 1.- smoothstep(u_blur, 1., length(v_normal.xy));
  // float blur = smoothstep(1.0, u_blur, length(v_normal.xy));
  if(u_line_type == LineTypeDash) {
    float dashLength = mod(v_distance_ratio, v_dash_array.x + v_dash_array.y + v_dash_array.z + v_dash_array.w);
    if(dashLength < v_dash_array.x || (dashLength > (v_dash_array.x + v_dash_array.y) && dashLength <  v_dash_array.x + v_dash_array.y + v_dash_array.z)) {
      // \u5B9E\u7EBF\u90E8\u5206
    } else {
      // \u865A\u7EBF\u90E8\u5206
      discard;
    };
  }

  // \u8BBE\u7F6E\u5F27\u7EBF\u7684\u52A8\u753B\u6A21\u5F0F
  if(u_animate.x == Animate) {
      animateSpeed = u_time / u_animate.y;
      float alpha =1.0 - fract( mod(1.0- v_distance_ratio, u_animate.z)* (1.0/ u_animate.z) + u_time / u_animate.y);
      alpha = (alpha + u_animate.w -1.0) / u_animate.w;
      alpha = smoothstep(0., 1., alpha);
      gl_FragColor.a *= alpha;
  }

  // \u8BBE\u7F6E\u5F27\u7EBF\u7684\u8D34\u56FE
  if(LineTexture == u_line_texture && u_line_type != LineTypeDash) { 
    float arcRadio = smoothstep( 0.0, 1.0, (d_segmentIndex / (segmentNumber - 1.0)));
    // float arcRadio = d_segmentIndex / (segmentNumber - 1.0);
    float count = v_line_data.b; // \u8D34\u56FE\u5728\u5F27\u7EBF\u4E0A\u91CD\u590D\u7684\u6570\u91CF
    float u = fract(arcRadio * count - animateSpeed * count);
    // float u = fract(arcRadio * count - animateSpeed);
    if(u_animate.x == Animate) {
      u = gl_FragColor.a/v_color.a;
    }

    float v = v_line_data.a; // \u7EBF\u56FE\u5C42\u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\u503C

    vec2 uv= v_iconMapUV / u_textSize + vec2(u, v) / u_textSize * 64.;
    vec4 pattern = texture2D(u_texture, uv);
    
    // \u8BBE\u7F6E\u8D34\u56FE\u548C\u5E95\u8272\u7684\u53E0\u52A0\u6A21\u5F0F
    if(u_textureBlend == 0.0) { // normal
      pattern.a = 0.0;
      gl_FragColor = filterColor(gl_FragColor + pattern);
    } else { // replace
        pattern.a *= v_color.a;
        if(gl_FragColor.a <= 0.0) {
          pattern.a = 0.0;
        }
        gl_FragColor = filterColor(pattern);
    }
  } else {
    gl_FragColor = filterColor(gl_FragColor);
  }

  // gl_FragColor = filterColor(gl_FragColor);
}`,hM=`#define LineTypeSolid 0.0
#define LineTypeDash 1.0
#define Animate 0.0
#define LineTexture 1.0

attribute vec4 a_Color;
attribute vec3 a_Position;
attribute vec4 a_Instance;
attribute float a_Size;
uniform mat4 u_ModelMatrix;

uniform float segmentNumber;
uniform vec4 u_animate: [ 1., 2., 1.0, 0.2 ];
varying vec4 v_color;

varying float v_distance_ratio;
uniform float u_line_type: 0.0;
uniform vec4 u_dash_array: [10.0, 5., 0, 0];
varying vec4 v_dash_array;

uniform float u_icon_step: 100;
uniform float u_line_texture: 0.0;

attribute vec2 a_iconMapUV;
varying vec2 v_iconMapUV;
varying vec4 v_line_data;


#pragma include "projection"
#pragma include "project"
#pragma include "picking"

float maps (float value, float start1, float stop1, float start2, float stop2) {
    return start2 + (stop2 - start2) * ((value - start1) / (stop1 - start1));
}

float getSegmentRatio(float index) {
    return index / (segmentNumber - 1.);
}

float paraboloid(vec2 source, vec2 target, float ratio) {
    vec2 x = mix(source, target, ratio);
    vec2 center = mix(source, target, 0.5);
    float dSourceCenter = distance(source, center);
    float dXCenter = distance(x, center);
    return (dSourceCenter + dXCenter) * (dSourceCenter - dXCenter);
}

vec3 getPos(vec2 source, vec2 target, float segmentRatio) {
     float vertex_height = paraboloid(source, target, segmentRatio);

    return vec3(
    mix(source, target, segmentRatio),
    sqrt(max(0.0, vertex_height))
    );
}
vec2 getExtrusionOffset(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
   dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
  vec2 offset = dir_screenspace * offset_direction * setPickingSize(a_Size)/ 2.0;
  return offset;
}
vec2 getNormal(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
   dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
   return reverse_offset_normal(vec3(dir_screenspace,1.0)).xy * sign(offset_direction);
}
float getAngularDist (vec2 source, vec2 target) {
  vec2 delta = source - target;
  vec2 sin_half_delta = sin(delta / 2.0);
  float a =
    sin_half_delta.y * sin_half_delta.y +
    cos(source.y) * cos(target.y) *
    sin_half_delta.x * sin_half_delta.x;
  return 2.0 * atan(sqrt(a), sqrt(1.0 - a));
}

vec2 midPoint(vec2 source, vec2 target) {
  vec2 center = target - source;
  float r = length(center);
  float theta = atan(center.y, center.x);
  float thetaOffset = 0.314;
  float r2 = r / 2.0 / cos(thetaOffset);
  float theta2 = theta + thetaOffset;
  vec2 mid = vec2(r2*cos(theta2) + source.x, r2*sin(theta2) + source.y);
  return mid;
}
float bezier3(vec3 arr, float t) {
  float ut = 1. - t;
  return (arr.x * ut + arr.y * t) * ut + (arr.y * ut + arr.z * t) * t;
}

vec2 interpolate (vec2 source, vec2 target, float angularDist, float t) {
  // if the angularDist is PI, linear interpolation is applied. otherwise, use spherical interpolation
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    vec2 mid = midPoint(source, target);
    vec3 x = vec3(source.x, mid.x, target.x);
    vec3 y = vec3(source.y, mid.y, target.y);
    return vec2(bezier3(x ,t), bezier3(y,t));
  }else {
    if(abs(angularDist - PI) < 0.001) {
      return (1.0 - t) * source + t * target;
    }
    float a = sin((1.0 - t) * angularDist) / sin(angularDist);
    float b = sin(t * angularDist) / sin(angularDist);
    vec2 sin_source = sin(source);
    vec2 cos_source = cos(source);
    vec2 sin_target = sin(target);
    vec2 cos_target = cos(target);
    float x = a * cos_source.y * cos_source.x + b * cos_target.y * cos_target.x;
    float y = a * cos_source.y * sin_source.x + b * cos_target.y * sin_target.x;
    float z = a * sin_source.y + b * sin_target.y;
    return vec2(atan(y, x), atan(z, sqrt(x * x + y * y)));
  }
}

void main() {
  v_color = a_Color;
  v_color.a = v_color.a * opacity;
  vec2 source = radians(a_Instance.rg);
  vec2 target = radians(a_Instance.ba);
  float angularDist = getAngularDist(source, target);
  float segmentIndex = a_Position.x;
  float segmentRatio = getSegmentRatio(segmentIndex);
  float indexDir = mix(-1.0, 1.0, step(segmentIndex, 0.0));

  if(u_line_type == LineTypeDash) {
    v_distance_ratio = segmentIndex / segmentNumber;
    vec2 s = source;
    vec2 t = target;
    
    if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
      s = unProjCustomCoord(source);
      t = unProjCustomCoord(target);
    }
    float total_Distance = pixelDistance(s, t) / 2.0 * PI;
    total_Distance = total_Distance*16.0; // total_Distance*16.0 \u8C03\u6574\u9ED8\u8BA4\u7684\u6548\u679C
    v_dash_array = pow(2.0, 20.0 - u_Zoom) * u_dash_array / total_Distance;
  }

  if(u_animate.x == Animate) {
      v_distance_ratio = segmentIndex / segmentNumber;
  }

  float nextSegmentRatio = getSegmentRatio(segmentIndex + indexDir);
  v_distance_ratio = segmentIndex / segmentNumber;
  vec4 curr = project_position(vec4(degrees(interpolate(source, target, angularDist, segmentRatio)), 0.0, 1.0));
  vec4 next = project_position(vec4(degrees(interpolate(source, target, angularDist, nextSegmentRatio)), 0.0, 1.0));
  // v_normal = getNormal((next.xy - curr.xy) * indexDir, a_Position.y);
  vec2 offset = project_pixel(getExtrusionOffset((next.xy - curr.xy) * indexDir, a_Position.y));
  //  vec4 project_pos = project_position(vec4(curr.xy, 0, 1.0));
  // gl_Position = project_common_position_to_clipspace(vec4(curr.xy + offset, curr.z, 1.0));

v_line_data.g = a_Position.x; // \u8BE5\u9876\u70B9\u5728\u5F27\u7EBF\u4E0A\u7684\u5206\u6BB5\u6392\u5E8F
  if(LineTexture == u_line_texture) { // \u5F00\u542F\u8D34\u56FE\u6A21\u5F0F  
    // float mapZoomScale = u_CoordinateSystem !== COORDINATE_SYSTEM_P20_2?10000000.0:1.0;
    float d_arcDistrance = length(source - target);
    if(u_CoordinateSystem == COORDINATE_SYSTEM_P20) { // amap
      d_arcDistrance = d_arcDistrance * 1000000.0;
    }
    if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) { // mapbox
      d_arcDistrance = project_pixel_allmap(d_arcDistrance);
    }
    float d_pixelLen = project_pixel(u_icon_step)/8.0;
v_line_data.b = floor(d_arcDistrance/d_pixelLen); // \u8D34\u56FE\u5728\u5F27\u7EBF\u4E0A\u91CD\u590D\u7684\u6570\u91CF

    float lineOffsetWidth = length(offset + offset * sign(a_Position.y)); // \u7EBF\u6A2A\u5411\u504F\u79FB\u7684\u8DDD\u79BB
    float linePixelSize = project_pixel(a_Size);  // \u5B9A\u70B9\u4F4D\u7F6E\u504F\u79FB\uFF0C\u6309\u5730\u56FE\u7B49\u7EA7\u7F29\u653E\u540E\u7684\u8DDD\u79BB
v_line_data.a = lineOffsetWidth/linePixelSize;  // \u7EBF\u56FE\u5C42\u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\u503C

    v_iconMapUV = a_iconMapUV;
  }



  gl_Position = project_common_position_to_clipspace_v2(vec4(curr.xy + offset, 0, 1.0));
  setPickingColor(a_PickingColor);
}

`,AM={solid:0,dash:1},pM=function(e){(0,ke.Z)(r,e);var t=lM(r);function r(){var n;(0,ue.Z)(this,r);for(var i=arguments.length,a=new Array(i),s=0;s<i;s++)a[s]=arguments[s];return n=t.call.apply(t,[this].concat(a)),(0,ve.Z)((0,St.Z)(n),"updateTexture",function(){var l=n.rendererService.createTexture2D;if(n.texture){n.texture.update({data:n.iconService.getCanvas()}),n.layer.render();return}n.texture=l({data:n.iconService.getCanvas(),mag:Fe.NEAREST,min:Fe.NEAREST,premultiplyAlpha:!1,width:1024,height:n.iconService.canvasHeight||128})}),n}return(0,_e.Z)(r,[{key:"getUninforms",value:function(){var i=this.layer.getLayerConfig(),a=i.sourceColor,s=i.targetColor,l=i.textureBlend,p=l===void 0?"normal":l,m=i.lineType,T=m===void 0?"solid":m,R=i.dashArray,L=R===void 0?[10,5]:R,z=i.lineTexture,re=z===void 0?!1:z,ee=i.iconStep,me=ee===void 0?100:ee,Ie=i.segmentNumber,He=Ie===void 0?30:Ie;L.length===2&&L.push(0,0),this.rendererService.getDirty()&&this.texture.bind();var Xe=0,ot=[0,0,0,0],pt=[0,0,0,0];return a&&s&&(ot=Qi(a),pt=Qi(s),Xe=1),(0,Q.Z)({u_textureBlend:p==="normal"?0:1,segmentNumber:He,u_line_type:AM[T]||0,u_dash_array:L,u_texture:this.texture,u_line_texture:re?1:0,u_icon_step:me,u_textSize:[1024,this.iconService.canvasHeight||128],u_linearColor:Xe,u_sourceColor:ot,u_targetColor:pt},this.getStyleAttribute())}},{key:"getAnimateUniforms",value:function(){var i=this.layer.getLayerConfig(),a=i.animateOption;return{u_animate:this.animateOption2Array(a),u_time:this.layer.getLayerAnimateTime()}}},{key:"initModels",value:function(){var n=(0,hr.Z)(it().mark(function a(){return it().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return this.updateTexture(),this.iconService.on("imageUpdate",this.updateTexture),l.abrupt("return",this.buildModels());case 3:case"end":return l.stop()}},a,this)}));function i(){return n.apply(this,arguments)}return i}()},{key:"clearModels",value:function(){var i;(i=this.texture)===null||i===void 0||i.destroy(),this.iconService.off("imageUpdate",this.updateTexture)}},{key:"buildModels",value:function(){var n=(0,hr.Z)(it().mark(function a(){var s;return it().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return p.next=2,this.layer.buildLayerModel({moduleName:"lineGreatCircle",vertexShader:hM,fragmentShader:fM,triangulation:ng,inject:this.getInject(),depth:{enable:!1}});case 2:return s=p.sent,p.abrupt("return",[s]);case 4:case"end":return p.stop()}},a,this)}));function i(){return n.apply(this,arguments)}return i}()},{key:"registerBuiltinAttributes",value:function(){var i=this;this.styleAttributeService.registerStyleAttribute({name:"size",type:bn.Attribute,descriptor:{name:"a_Size",buffer:{usage:Fe.DYNAMIC_DRAW,data:[],type:Fe.FLOAT},size:1,update:function(s){var l=s.size,p=l===void 0?1:l;return Array.isArray(p)?[p[0]]:[p]}}}),this.styleAttributeService.registerStyleAttribute({name:"instance",type:bn.Attribute,descriptor:{name:"a_Instance",buffer:{usage:Fe.STATIC_DRAW,data:[],type:Fe.FLOAT},size:4,update:function(s,l,p){return[p[3],p[4],p[5],p[6]]}}}),this.styleAttributeService.registerStyleAttribute({name:"uv",type:bn.Attribute,descriptor:{name:"a_iconMapUV",buffer:{usage:Fe.DYNAMIC_DRAW,data:[],type:Fe.FLOAT},size:2,update:function(s){var l=i.iconService.getIconMap(),p=s.texture,m=l[p]||{x:0,y:0},T=m.x,R=m.y;return[T,R]}}})}}]),r}(Lo),_L=function(e){return e[e.solid=0]="solid",e[e.dash=1]="dash",e}({}),ag=function(e){return e.VERTICAL="vertical",e.HORIZONTAL="horizontal",e}({}),dM=function(e){return e.NORMAL="normal",e.REPLACE="replace",e}({}),r_=function(e){return e[e.pixel=0]="pixel",e[e.meter=1]="meter",e}({}),yL=function(e){return e.ALWAYS="always",e.DRAGEND="dragend",e}({});function vM(e){var t=gM();return function(){var n=(0,le.Z)(e),i;if(t){var a=(0,le.Z)(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return(0,ze.Z)(this,i)}}function gM(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var mM=`#define LineTypeSolid 0.0
varying vec4 v_color;

// dash
varying vec4 v_dash_array;
varying float v_d_distance_ratio;

#pragma include "picking"

uniform float u_time;
uniform vec4 u_animate: [ 1., 2., 1.0, 0.2 ]; // \u63A7\u5236\u8FD0\u52A8

// [animate, duration, interval, trailLength],
void main() {

  gl_FragColor = v_color;

  float dashLength = mod(v_d_distance_ratio, v_dash_array.x + v_dash_array.y + v_dash_array.z + v_dash_array.w);
  if(dashLength < v_dash_array.x || (dashLength > (v_dash_array.x + v_dash_array.y) && dashLength <  v_dash_array.x + v_dash_array.y + v_dash_array.z)) {
    // \u5B9E\u7EBF\u90E8\u5206
  } else {
    // \u865A\u7EBF\u90E8\u5206
    discard;
  };

  gl_FragColor = filterColor(gl_FragColor);
}
`,_M=`#define LineTypeSolid 0.0
#define LineTypeDash 1.0
#define Animate 0.0

attribute float a_Miter;
attribute vec4 a_Color;
attribute vec2 a_Size;
attribute vec3 a_Normal;
attribute vec3 a_Position;

attribute vec2 a_iconMapUV;

// dash line
attribute float a_Total_Distance;
attribute vec2 a_DistanceAndIndex;
uniform float u_raisingHeight: 0.0;
uniform float u_heightfixed: 0.0;

uniform mat4 u_ModelMatrix;

uniform vec4 u_dash_array: [10.0, 5., 0, 0];

uniform float u_vertexScale: 1.0;

#pragma include "projection"
#pragma include "picking"

varying vec4 v_color;
varying vec4 v_dash_array;
varying float v_d_distance_ratio;


void main() {

  v_dash_array = pow(2.0, 20.0 - u_Zoom) * u_dash_array / a_Total_Distance;
  v_color = vec4(a_Color.xyz, a_Color.w * opacity);

  vec3 size = a_Miter * setPickingSize(a_Size.x) * reverse_offset_normal(a_Normal);
  vec2 offset = project_pixel(size.xy);
  v_d_distance_ratio = a_DistanceAndIndex.x / a_Total_Distance;


  vec4 project_pos = project_position(vec4(a_Position.xy, 0, 1.0));
  
 float h = float(a_Position.z) * u_vertexScale; // \u7EBF\u9876\u70B9\u7684\u9AD8\u5EA6 - \u517C\u5BB9\u4E0D\u5B58\u5728\u7B2C\u4E09\u4E2A\u6570\u503C\u7684\u60C5\u51B5 vertex height
  float lineHeight = a_Size.y; // size \u7B2C\u4E8C\u4E2A\u53C2\u6570\u4EE3\u8868\u7684\u9AD8\u5EA6 [linewidth, lineheight]

  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    lineHeight *= 0.2; // \u4FDD\u6301\u548C amap/mapbox \u4E00\u81F4\u7684\u6548\u679C
    h *= 0.2;
    if(u_heightfixed < 1.0) {
      lineHeight = project_pixel(a_Size.y);
    }
    gl_Position = u_Mvp * (vec4(project_pos.xy + offset, lineHeight + h + u_raisingHeight, 1.0));
  } else {
    // mapbox -  amap
    
    // \u517C\u5BB9 mapbox \u5728\u7EBF\u9AD8\u5EA6\u4E0A\u7684\u6548\u679C\u8868\u73B0\u57FA\u672C\u4E00\u81F4
    if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
      // mapbox
      // \u4FDD\u6301\u9AD8\u5EA6\u76F8\u5BF9\u4E0D\u53D8
      float mapboxZoomScale = 4.0/pow(2.0, 21.0 - u_Zoom);
      h *= mapboxZoomScale;
      h += u_raisingHeight * mapboxZoomScale;
      if(u_heightfixed > 0.0) {
        lineHeight *= mapboxZoomScale;
      }
      
    } else {
      // amap
      h += u_raisingHeight;
      // lineHeight \u9876\u70B9\u504F\u79FB\u9AD8\u5EA6
      if(u_heightfixed < 1.0) {
        lineHeight *= pow(2.0, 20.0 - u_Zoom);
      }
    }

    gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, lineHeight + h, 1.0));
  }

  setPickingColor(a_PickingColor);
}
`,yM=`#extension GL_OES_standard_derivatives : enable
#define Animate 0.0
#define LineTexture 1.0
uniform float u_textureBlend;

uniform float u_strokeWidth: 0.0;

uniform vec3 u_blur;
varying vec4 v_color;
varying vec4 v_stroke;

// line texture
uniform float u_line_texture;
uniform sampler2D u_texture;
uniform vec2 u_textSize;
varying vec2 v_iconMapUV;
varying vec4 v_texture_data;


#pragma include "picking"

uniform float u_time;
uniform vec4 u_animate: [ 1, 2., 1.0, 0.2 ]; // \u63A7\u5236\u8FD0\u52A8
// [animate, duration, interval, trailLength],
void main() {
  float animateSpeed = 0.0; // \u8FD0\u52A8\u901F\u5EA6
  float d_distance_ratio = v_texture_data.r; // \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B
  gl_FragColor = v_color;
  // anti-alias
  // float blur = 1.0 - smoothstep(u_blur, 1., length(v_normal.xy));
  if(u_animate.x == Animate) {
      animateSpeed = u_time / u_animate.y;
       float alpha =1.0 - fract( mod(1.0- d_distance_ratio, u_animate.z)* (1.0/ u_animate.z) + animateSpeed);
      alpha = (alpha + u_animate.w -1.0) / u_animate.w;
      alpha = smoothstep(0., 1., alpha);
      gl_FragColor.a *= alpha;
  }

  if(u_line_texture == LineTexture) { // while load texture
    float aDistance = v_texture_data.g;      // \u5F53\u524D\u9876\u70B9\u7684\u8DDD\u79BB
    float d_texPixelLen = v_texture_data.b;  // \u8D34\u56FE\u7684\u50CF\u7D20\u957F\u5EA6\uFF0C\u6839\u636E\u5730\u56FE\u5C42\u7EA7\u7F29\u653E
    float u = fract(mod(aDistance, d_texPixelLen)/d_texPixelLen - animateSpeed);
    float v = v_texture_data.a;  // \u7EBF\u56FE\u5C42\u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\u503C

    // v = max(smoothstep(0.95, 1.0, v), v);
    vec2 uv= v_iconMapUV / u_textSize + vec2(u, v) / u_textSize * 64.;
     vec4 pattern = texture2D(u_texture, uv);

    if(u_textureBlend == 0.0) { // normal
      pattern.a = 0.0;
      gl_FragColor += pattern;
    } else { // replace
        pattern.a *= v_color.a;
        if(gl_FragColor.a <= 0.0) {
          pattern.a = 0.0;
        }
        gl_FragColor = pattern;
    }
  } 

  float v = v_texture_data.a;
  float strokeWidth = min(0.5, u_strokeWidth);
  // \u7ED8\u5236 border
  if(strokeWidth > 0.01) {
    float borderOuterWidth = strokeWidth / 2.0;


    if(v >= 1.0 - strokeWidth || v <= strokeWidth) {
      if(v > strokeWidth) { // \u5916\u4FA7
        float linear = smoothstep(0.0, 1.0, (v - (1.0 - strokeWidth))/strokeWidth);
        //  float linear = step(0.0, (v - (1.0 - borderWidth))/borderWidth);
        gl_FragColor.rgb = mix(gl_FragColor.rgb, v_stroke.rgb, linear);
      } else if(v <= strokeWidth) {
        float linear = smoothstep(0.0, 1.0, v/strokeWidth);
        gl_FragColor.rgb = mix(v_stroke.rgb, gl_FragColor.rgb, linear);
      }
    }

    if(v < borderOuterWidth) {
      gl_FragColor.a = mix(0.0, gl_FragColor.a, v/borderOuterWidth);
    } else if(v > 1.0 - borderOuterWidth) {
      gl_FragColor.a = mix(gl_FragColor.a, 0.0, (v - (1.0 - borderOuterWidth))/borderOuterWidth);
    }
  }

  // blur
  float blurV = v_texture_data.a;
  if(blurV < 0.5) {
    gl_FragColor.a *= mix(u_blur.r, u_blur.g, blurV/0.5);
  } else {
    gl_FragColor.a *= mix(u_blur.g, u_blur.b, (blurV - 0.5)/0.5);
  }
  
  gl_FragColor = filterColor(gl_FragColor);
}
`,v2=`
#define Animate 0.0

attribute float a_Miter;
attribute vec4 a_Color;
attribute vec2 a_Size;
attribute vec3 a_Normal;
attribute vec3 a_Position;

attribute vec2 a_iconMapUV;

// dash line
attribute float a_Total_Distance;
attribute vec2 a_DistanceAndIndex;

uniform mat4 u_ModelMatrix;

uniform vec4 u_animate: [ 1., 2., 1.0, 0.2 ];
uniform float u_icon_step: 100;

uniform float u_heightfixed: 0.0;
uniform float u_vertexScale: 1.0;
uniform float u_raisingHeight: 0.0;

#pragma include "projection"
#pragma include "picking"

varying vec4 v_color;
varying vec4 v_stroke;

// texV \u7EBF\u56FE\u5C42 - \u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\uFF08\u7EBF\u7684\u5BBD\u5EA6\u65B9\u5411\uFF09
varying vec2 v_iconMapUV;


uniform float u_linearColor: 0;
uniform float u_arrow: 0.0;
uniform float u_arrowHeight: 3.0;
uniform float u_arrowWidth: 2.0;
uniform float u_tailWidth: 1.0;

varying vec4 v_texture_data;

vec2 calculateArrow(vec2 offset) {
  /*
  * \u5728\u652F\u6301\u7BAD\u5934\u7684\u65F6\u5019\uFF0C\u7B2C\u4E8C\u3001\u7B2C\u4E09\u7EC4\u9876\u70B9\u662F\u989D\u5916\u63D2\u5165\u7528\u4E8E\u6784\u5EFA\u9876\u70B9\u7684
  */
  float arrowFlag = -1.0;
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) {
    // \u9AD8\u5FB7 2.0 \u7684\u65CB\u8F6C\u89D2\u5EA6\u4E0D\u540C
    arrowFlag = 1.0;
  }
  float pi = arrowFlag * 3.1415926/2.;
  if(a_Miter < 0.) {
    // \u6839\u636E\u7EBF\u7684\u4E24\u4FA7\u504F\u79FB\u4E0D\u540C\u3001\u65CB\u8F6C\u7684\u65B9\u5411\u76F8\u53CD
    pi = -pi;
  }
  highp float angle_sin = sin(pi);
  highp float angle_cos = cos(pi);
  // \u8BA1\u7B97\u5782\u76F4\u4E0E\u7EBF\u65B9\u5411\u7684\u65CB\u8F6C\u77E9\u9635
  mat2 rotation_matrix = mat2(angle_cos, -1.0 * angle_sin, angle_sin, angle_cos);
  float arrowWidth = u_arrowWidth;
  float arrowHeight = u_arrowHeight;

  vec2 arrowOffset = vec2(0.0);
  /*
  * a_DistanceAndIndex.y \u7528\u4E8E\u6807\u8BB0\u5F53\u524D\u9876\u70B9\u5C5E\u4E8E\u54EA\u4E00\u7EC4\uFF08\u4E24\u4E2A\u9876\u70B9\u4E00\u7EC4\uFF0C\u6784\u6210\u7EBF\u7684\u5176\u5B9E\u662F\u77E9\u5F62\uFF0C\u6700\u7B80\u9700\u8981\u56DB\u4E2A\u9876\u70B9\u3001\u4E24\u7EC4\u9876\u70B9\u6784\u6210\uFF09
  */
  if(a_DistanceAndIndex.y == 0.0) {
    // \u7BAD\u5934\u5C16\u90E8
    offset = vec2(0.0);
  } else if(a_DistanceAndIndex.y == 1.0) {
    // \u7BAD\u5934\u4E24\u4FA7
    arrowOffset = rotation_matrix*(offset * arrowHeight);
    offset += arrowOffset; // \u6CBF\u7EBF\u504F\u79FB
    offset = offset * arrowWidth; // \u5782\u76F4\u7EBF\u5411\u5916\u504F\u79FB\uFF08\u662F\u6784\u5EFA\u7BAD\u5934\u4E24\u4FA7\u7684\u9876\u70B9\uFF09
  } else if(a_DistanceAndIndex.y == 2.0 || a_DistanceAndIndex.y == 3.0 || a_DistanceAndIndex.y == 4.0) {
    // \u504F\u79FB\u5176\u4F59\u7684\u70B9\u4F4D\uFF08\u5C06\u957F\u5EA6\u8BA9\u4F4D\u7ED9\u7BAD\u5934\uFF09
    arrowOffset = rotation_matrix*(offset * arrowHeight) * arrowWidth;
    offset += arrowOffset;// \u6CBF\u7EBF\u504F\u79FB
  }

  return offset;
}

void main() {
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97

  
  float d_texPixelLen;    // \u8D34\u56FE\u7684\u50CF\u7D20\u957F\u5EA6\uFF0C\u6839\u636E\u5730\u56FE\u5C42\u7EA7\u7F29\u653E

  v_iconMapUV = a_iconMapUV;
  d_texPixelLen = project_float_pixel(u_icon_step);
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) {
    d_texPixelLen *= 10.0;
  }

  v_color = a_Color;
  v_color.a *= opacity;
  v_stroke = stroke;

  vec3 size = a_Miter * setPickingSize(a_Size.x) * reverse_offset_normal(a_Normal);
  
  vec2 offset = project_pixel(size.xy);

  float lineDistance = a_DistanceAndIndex.x;
  float currentLinePointRatio = lineDistance / a_Total_Distance;
 
  if(u_arrow > 0.0) {
      //  \u8BA1\u7B97\u7BAD\u5934
    offset = calculateArrow(offset);

    if(a_DistanceAndIndex.y > 4.0) {
      offset *= mix(1.0, u_tailWidth, currentLinePointRatio);
    }
  }

  float lineOffsetWidth = length(offset + offset * sign(a_Miter)); // \u7EBF\u6A2A\u5411\u504F\u79FB\u7684\u8DDD\u79BB\uFF08\u5411\u4E24\u4FA7\u504F\u79FB\u7684\u548C\uFF09
  float linePixelSize = project_pixel(a_Size.x) * 2.0;  // \u5B9A\u70B9\u4F4D\u7F6E\u504F\u79FB\uFF0C\u6309\u5730\u56FE\u7B49\u7EA7\u7F29\u653E\u540E\u7684\u8DDD\u79BB \u5355\u4FA7 * 2
  float texV = lineOffsetWidth/linePixelSize; // \u7EBF\u56FE\u5C42\u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\u503C
  
  v_texture_data = vec4(currentLinePointRatio, lineDistance, d_texPixelLen, texV);
  // \u8BBE\u7F6E\u6570\u636E\u96C6\u7684\u53C2\u6570

  vec4 project_pos = project_position(vec4(a_Position.xy, 0, 1.0));

  // gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, a_Size.y, 1.0));

  float h = float(a_Position.z) * u_vertexScale; // \u7EBF\u9876\u70B9\u7684\u9AD8\u5EA6 - \u517C\u5BB9\u4E0D\u5B58\u5728\u7B2C\u4E09\u4E2A\u6570\u503C\u7684\u60C5\u51B5 vertex height
  float lineHeight = a_Size.y; // size \u7B2C\u4E8C\u4E2A\u53C2\u6570\u4EE3\u8868\u7684\u9AD8\u5EA6 [linewidth, lineheight]

  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    lineHeight *= 0.2; // \u4FDD\u6301\u548C amap/mapbox \u4E00\u81F4\u7684\u6548\u679C
    h *= 0.2;
    if(u_heightfixed < 1.0) {
      lineHeight = project_pixel(a_Size.y);
    }
    gl_Position = u_Mvp * (vec4(project_pos.xy + offset, lineHeight + h + u_raisingHeight, 1.0));
  } else {
    // mapbox -  amap
    
    // \u517C\u5BB9 mapbox \u5728\u7EBF\u9AD8\u5EA6\u4E0A\u7684\u6548\u679C\u8868\u73B0\u57FA\u672C\u4E00\u81F4
    if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
      // mapbox
      // \u4FDD\u6301\u9AD8\u5EA6\u76F8\u5BF9\u4E0D\u53D8
      float mapboxZoomScale = 4.0/pow(2.0, 21.0 - u_Zoom);
      h *= mapboxZoomScale;
      h += u_raisingHeight * mapboxZoomScale;
      if(u_heightfixed > 0.0) {
        lineHeight *= mapboxZoomScale;
      }
      
    } else {
      // amap
      h += u_raisingHeight;
      // lineHeight \u9876\u70B9\u504F\u79FB\u9AD8\u5EA6
      if(u_heightfixed < 1.0) {
        lineHeight *= pow(2.0, 20.0 - u_Zoom);
      }
    }

    gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, lineHeight + h, 1.0));
  }

  setPickingColor(a_PickingColor);
}
`,EM=`varying vec4 v_color;
varying vec4 v_texture_data;
uniform float u_linearDir: 1.0;
uniform float u_linearColor: 0;
uniform vec4 u_sourceColor;
uniform vec4 u_targetColor;

#pragma include "picking"


void main() {
  float linearRadio = v_texture_data.r; // \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B
  if(u_linearDir < 1.0) {
    linearRadio = v_texture_data.a;
  }

  if(u_linearColor == 1.0) { // \u4F7F\u7528\u6E10\u53D8\u989C\u8272
    gl_FragColor = mix(u_sourceColor, u_targetColor, linearRadio);
    gl_FragColor.a *= v_color.a;
  } else { // \u4F7F\u7528 color \u65B9\u6CD5\u4F20\u5165\u7684\u989C\u8272
     gl_FragColor = v_color;
  }

  gl_FragColor = filterColor(gl_FragColor);
}
`,SM={solid:0,dash:1},g2=function(e){(0,ke.Z)(r,e);var t=vM(r);function r(){var n;(0,ue.Z)(this,r);for(var i=arguments.length,a=new Array(i),s=0;s<i;s++)a[s]=arguments[s];return n=t.call.apply(t,[this].concat(a)),(0,ve.Z)((0,St.Z)(n),"textureEventFlag",!1),(0,ve.Z)((0,St.Z)(n),"texture",n.createTexture2D({data:[0,0,0,0],mag:Fe.NEAREST,min:Fe.NEAREST,premultiplyAlpha:!1,width:1,height:1})),(0,ve.Z)((0,St.Z)(n),"updateTexture",function(){var l=n.rendererService.createTexture2D;if(n.texture){n.texture.update({data:n.iconService.getCanvas()}),n.layer.render();return}n.texture=l({data:n.iconService.getCanvas(),mag:Fe.NEAREST,min:Fe.NEAREST,premultiplyAlpha:!1,width:1024,height:n.iconService.canvasHeight||128})}),n}return(0,_e.Z)(r,[{key:"getUninforms",value:function(){var i=this.layer.getLayerConfig(),a=i.sourceColor,s=i.targetColor,l=i.textureBlend,p=l===void 0?"normal":l,m=i.lineType,T=m===void 0?"solid":m,R=i.dashArray,L=R===void 0?[10,5,0,0]:R,z=i.lineTexture,re=z===void 0?!1:z,ee=i.iconStep,me=ee===void 0?100:ee,Ie=i.vertexHeightScale,He=Ie===void 0?20:Ie,Xe=i.strokeWidth,ot=Xe===void 0?0:Xe,pt=i.raisingHeight,dt=pt===void 0?0:pt,It=i.heightfixed,Vt=It===void 0?!1:It,Kt=i.linearDir,yr=Kt===void 0?ag.VERTICAL:Kt,_r=i.blur,Hr=_r===void 0?[1,1,1]:_r;L.length===2&&L.push(0,0),this.rendererService.getDirty()&&this.texture&&this.texture.bind();var nn=0,Tn=[0,0,0,0],sa=[0,0,0,0];return a&&s&&(Tn=Qi(a),sa=Qi(s),nn=1),(0,Q.Z)({u_textureBlend:p===dM.NORMAL?0:1,u_line_type:SM[T],u_dash_array:L,u_blur:Hr,u_texture:this.texture,u_line_texture:re?1:0,u_icon_step:me,u_textSize:[1024,this.iconService.canvasHeight||128],u_strokeWidth:ot,u_linearDir:yr===ag.VERTICAL?1:0,u_linearColor:nn,u_sourceColor:Tn,u_targetColor:sa,u_heightfixed:Number(Vt),u_vertexScale:He,u_raisingHeight:Number(dt)},this.getStyleAttribute())}},{key:"getAnimateUniforms",value:function(){var i=this.layer.getLayerConfig(),a=i.animateOption;return{u_animate:this.animateOption2Array(a),u_time:this.layer.getLayerAnimateTime()}}},{key:"initModels",value:function(){var n=(0,hr.Z)(it().mark(function a(){return it().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return this.textureEventFlag||(this.textureEventFlag=!0,this.updateTexture(),this.iconService.on("imageUpdate",this.updateTexture)),l.abrupt("return",this.buildModels());case 2:case"end":return l.stop()}},a,this)}));function i(){return n.apply(this,arguments)}return i}()},{key:"clearModels",value:function(){var i;(i=this.texture)===null||i===void 0||i.destroy(),this.iconService.off("imageUpdate",this.updateTexture)}},{key:"buildModels",value:function(){var n=(0,hr.Z)(it().mark(function a(){var s,l,p,m,T,R,L,z;return it().wrap(function(ee){for(;;)switch(ee.prev=ee.next){case 0:return s=this.layer.getLayerConfig(),l=s.depth,p=l===void 0?!1:l,m=this.getShaders(),T=m.frag,R=m.vert,L=m.type,this.layer.triangulation=vf,ee.next=5,this.layer.buildLayerModel({moduleName:"line"+L,vertexShader:R,fragmentShader:T,triangulation:vf,inject:this.getInject(),depth:{enable:p}});case 5:return z=ee.sent,ee.abrupt("return",[z]);case 7:case"end":return ee.stop()}},a,this)}));function i(){return n.apply(this,arguments)}return i}()},{key:"getShaders",value:function(){var i=this.layer.getLayerConfig(),a=i.sourceColor,s=i.targetColor,l=i.lineType;return l==="dash"?{frag:mM,vert:_M,type:"Dash"}:a&&s?{frag:EM,vert:v2,type:"Linear"}:{frag:yM,vert:v2,type:""}}},{key:"registerBuiltinAttributes",value:function(){var i=this;this.styleAttributeService.registerStyleAttribute({name:"distanceAndIndex",type:bn.Attribute,descriptor:{name:"a_DistanceAndIndex",buffer:{usage:Fe.STATIC_DRAW,data:[],type:Fe.FLOAT},size:2,update:function(s,l,p,m,T,R){return R===void 0?[p[3],10]:[p[3],R]}}}),this.styleAttributeService.registerStyleAttribute({name:"total_distance",type:bn.Attribute,descriptor:{name:"a_Total_Distance",buffer:{usage:Fe.STATIC_DRAW,data:[],type:Fe.FLOAT},size:1,update:function(s,l,p){return[p[5]]}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:bn.Attribute,descriptor:{name:"a_Size",buffer:{usage:Fe.DYNAMIC_DRAW,data:[],type:Fe.FLOAT},size:2,update:function(s){var l=s.size,p=l===void 0?1:l;return Array.isArray(p)?[p[0],p[1]]:[p,0]}}}),this.styleAttributeService.registerStyleAttribute({name:"normal",type:bn.Attribute,descriptor:{name:"a_Normal",buffer:{usage:Fe.STATIC_DRAW,data:[],type:Fe.FLOAT},size:3,update:function(s,l,p,m,T){return T}}}),this.styleAttributeService.registerStyleAttribute({name:"miter",type:bn.Attribute,descriptor:{name:"a_Miter",buffer:{usage:Fe.STATIC_DRAW,data:[],type:Fe.FLOAT},size:1,update:function(s,l,p){return[p[4]]}}}),this.styleAttributeService.registerStyleAttribute({name:"uv",type:bn.Attribute,descriptor:{name:"a_iconMapUV",buffer:{usage:Fe.DYNAMIC_DRAW,data:[],type:Fe.FLOAT},size:2,update:function(s){var l=i.iconService.getIconMap(),p=s.texture,m=l[p]||{x:0,y:0},T=m.x,R=m.y;return[T,R]}}})}}]),r}(Lo);function xM(e){var t=TM();return function(){var n=(0,le.Z)(e),i;if(t){var a=(0,le.Z)(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return(0,ze.Z)(this,i)}}function TM(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var CM=`
varying vec4 v_Color;
#pragma include "picking"
void main() {

  gl_FragColor = v_Color; // \u5168\u5C40\u900F\u660E\u5EA6
  gl_FragColor = filterColor(gl_FragColor);
}
`,bM=`
attribute float a_Miter;
attribute vec2 a_Size;
attribute vec3 a_Normal;
attribute vec3 a_Position;

// dash line
attribute float a_Total_Distance;
attribute vec2 a_DistanceAndIndex;

uniform mat4 u_ModelMatrix;


uniform float u_heightfixed: 0.0;
uniform float u_vertexScale: 1.0;
uniform float u_raisingHeight: 0.0;
uniform sampler2D u_texture;
uniform float u_linearDir: 1.0;
varying vec4 v_Color;


#pragma include "projection"
#pragma include "picking"


void main() {


  vec3 size = a_Miter * setPickingSize(a_Size.x) * reverse_offset_normal(a_Normal);
  
  vec2 offset = project_pixel(size.xy);

  float lineDistance = a_DistanceAndIndex.x;
  float currentLinePointRatio = lineDistance / a_Total_Distance;
 

  float lineOffsetWidth = length(offset + offset * sign(a_Miter)); // \u7EBF\u6A2A\u5411\u504F\u79FB\u7684\u8DDD\u79BB\uFF08\u5411\u4E24\u4FA7\u504F\u79FB\u7684\u548C\uFF09
  float linePixelSize = project_pixel(a_Size.x) * 2.0;  // \u5B9A\u70B9\u4F4D\u7F6E\u504F\u79FB\uFF0C\u6309\u5730\u56FE\u7B49\u7EA7\u7F29\u653E\u540E\u7684\u8DDD\u79BB \u5355\u4FA7 * 2
  float texV = lineOffsetWidth/linePixelSize; // \u7EBF\u56FE\u5C42\u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\u503C

  float linearRadio =currentLinePointRatio; // \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B
  if(u_linearDir < 1.0) {
    linearRadio = texV;
  }

  v_Color = texture2D(u_texture, vec2(linearRadio, 0.5));

  v_Color.a *= opacity; // \u5168\u5C40\u900F\u660E\u5EA6



  vec4 project_pos = project_position(vec4(a_Position.xy, 0, 1.0));

  // gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, a_Size.y, 1.0));

  float h = float(a_Position.z) * u_vertexScale; // \u7EBF\u9876\u70B9\u7684\u9AD8\u5EA6 - \u517C\u5BB9\u4E0D\u5B58\u5728\u7B2C\u4E09\u4E2A\u6570\u503C\u7684\u60C5\u51B5 vertex height
  float lineHeight = a_Size.y; // size \u7B2C\u4E8C\u4E2A\u53C2\u6570\u4EE3\u8868\u7684\u9AD8\u5EA6 [linewidth, lineheight]

  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    lineHeight *= 0.2; // \u4FDD\u6301\u548C amap/mapbox \u4E00\u81F4\u7684\u6548\u679C
    h *= 0.2;
    if(u_heightfixed < 1.0) {
      lineHeight = project_pixel(a_Size.y);
    }
    gl_Position = u_Mvp * (vec4(project_pos.xy + offset, lineHeight + h + u_raisingHeight, 1.0));
  } else {
    // mapbox -  amap
    
    // \u517C\u5BB9 mapbox \u5728\u7EBF\u9AD8\u5EA6\u4E0A\u7684\u6548\u679C\u8868\u73B0\u57FA\u672C\u4E00\u81F4
    if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
      // mapbox
      // \u4FDD\u6301\u9AD8\u5EA6\u76F8\u5BF9\u4E0D\u53D8
      float mapboxZoomScale = 4.0/pow(2.0, 21.0 - u_Zoom);
      h *= mapboxZoomScale;
      h += u_raisingHeight * mapboxZoomScale;
      if(u_heightfixed > 0.0) {
        lineHeight *= mapboxZoomScale;
      }
      
    } else {
      // amap
      h += u_raisingHeight;
      // lineHeight \u9876\u70B9\u504F\u79FB\u9AD8\u5EA6
      if(u_heightfixed < 1.0) {
        lineHeight *= pow(2.0, 20.0 - u_Zoom);
      }
    }

    gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, lineHeight + h, 1.0));
  }

  setPickingColor(a_PickingColor);
}
`,EL=Fn.isNumber,RM=function(e){(0,ke.Z)(r,e);var t=xM(r);function r(){var n;(0,ue.Z)(this,r);for(var i=arguments.length,a=new Array(i),s=0;s<i;s++)a[s]=arguments[s];return n=t.call.apply(t,[this].concat(a)),(0,ve.Z)((0,St.Z)(n),"updateTexture",function(){var l=n.rendererService.createTexture2D;n.colorTexture&&n.colorTexture.destroy();var p=n.layer.getLayerConfig(),m=p.rampColors,T=ds(m);n.colorTexture=l({data:new Uint8Array(T.data),width:T.width,height:T.height,wrapS:Fe.CLAMP_TO_EDGE,wrapT:Fe.CLAMP_TO_EDGE,min:Fe.NEAREST,mag:Fe.NEAREST,flipY:!1})}),n}return(0,_e.Z)(r,[{key:"getUninforms",value:function(){var i=this.layer.getLayerConfig(),a=i.opacity,s=a===void 0?1:a,l=i.vertexHeightScale,p=l===void 0?20:l,m=i.raisingHeight,T=m===void 0?0:m,R=i.heightfixed,L=R===void 0?!1:R,z=i.linearDir,re=z===void 0?ag.VERTICAL:z;return this.rendererService.getDirty()&&this.colorTexture.bind(),(0,Q.Z)({u_linearDir:re===ag.VERTICAL?1:0,u_texture:this.colorTexture,u_heightfixed:Number(L),u_vertexScale:p,u_raisingHeight:Number(T)},this.getStyleAttribute())}},{key:"initModels",value:function(){var n=(0,hr.Z)(it().mark(function a(){return it().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return this.updateTexture(),l.abrupt("return",this.buildModels());case 2:case"end":return l.stop()}},a,this)}));function i(){return n.apply(this,arguments)}return i}()},{key:"clearModels",value:function(){var i;(i=this.colorTexture)===null||i===void 0||i.destroy()}},{key:"buildModels",value:function(){var n=(0,hr.Z)(it().mark(function a(){var s,l,p,m;return it().wrap(function(R){for(;;)switch(R.prev=R.next){case 0:return s=this.layer.getLayerConfig(),l=s.depth,p=l===void 0?!1:l,this.layer.triangulation=e_,R.next=4,this.layer.buildLayerModel({moduleName:"lineRampColors",vertexShader:bM,fragmentShader:CM,triangulation:e_,inject:this.getInject(),depth:{enable:p}});case 4:return m=R.sent,R.abrupt("return",[m]);case 6:case"end":return R.stop()}},a,this)}));function i(){return n.apply(this,arguments)}return i}()},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"distanceAndIndex",type:bn.Attribute,descriptor:{name:"a_DistanceAndIndex",buffer:{usage:Fe.STATIC_DRAW,data:[],type:Fe.FLOAT},size:2,update:function(a,s,l,p,m,T){return T===void 0?[l[3],10]:[l[3],T]}}}),this.styleAttributeService.registerStyleAttribute({name:"total_distance",type:bn.Attribute,descriptor:{name:"a_Total_Distance",buffer:{usage:Fe.STATIC_DRAW,data:[],type:Fe.FLOAT},size:1,update:function(a,s,l){return[l[5]]}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:bn.Attribute,descriptor:{name:"a_Size",buffer:{usage:Fe.DYNAMIC_DRAW,data:[],type:Fe.FLOAT},size:2,update:function(a){var s=a.size,l=s===void 0?1:s;return Array.isArray(l)?[l[0],l[1]]:[l,0]}}}),this.styleAttributeService.registerStyleAttribute({name:"normal",type:bn.Attribute,descriptor:{name:"a_Normal",buffer:{usage:Fe.STATIC_DRAW,data:[],type:Fe.FLOAT},size:3,update:function(a,s,l,p,m){return m}}}),this.styleAttributeService.registerStyleAttribute({name:"miter",type:bn.Attribute,descriptor:{name:"a_Miter",buffer:{usage:Fe.STATIC_DRAW,data:[],type:Fe.FLOAT},size:1,update:function(a,s,l){return[l[4]]}}})}}]),r}(Lo);function MM(e){var t=wM();return function(){var n=(0,le.Z)(e),i;if(t){var a=(0,le.Z)(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return(0,ze.Z)(this,i)}}function wM(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var IM=`
varying vec4 v_color;
void main() {
  gl_FragColor = v_color;

}
`,PM=`uniform vec4 u_sourceColor;
uniform vec4 u_targetColor;
varying float v_distanceScale;
varying vec4 v_color;
void main() {
  gl_FragColor = mix(u_sourceColor, u_targetColor, v_distanceScale);
  gl_FragColor.a *= v_color.a; // \u5168\u5C40\u900F\u660E\u5EA6
}
`,m2=`attribute vec4 a_Color;
attribute vec2 a_Size;
attribute vec3 a_Position;

attribute float a_Total_Distance;
attribute float a_Distance;

uniform mat4 u_ModelMatrix;


uniform float u_vertexScale: 1.0;
uniform vec4 u_sourceColor;
uniform vec4 u_targetColor;



#pragma include "projection"

varying vec4 v_color;
varying float v_distanceScale;

void main() {

  v_color = a_Color; 
  v_distanceScale = a_Distance / a_Total_Distance;
  v_color.a = v_color.a * opacity;
  vec4 project_pos = project_position(vec4(a_Position.xy, 0, 1.0));

  float h = float(a_Position.z) * u_vertexScale; // \u7EBF\u9876\u70B9\u7684\u9AD8\u5EA6 - \u517C\u5BB9\u4E0D\u5B58\u5728\u7B2C\u4E09\u4E2A\u6570\u503C\u7684\u60C5\u51B5

  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    gl_Position = u_Mvp * (vec4(project_pos.xy, project_pixel(a_Size.y) + h * 0.2, 1.0));
  } else {
    float lineHeight = a_Size.y;
    // \u517C\u5BB9 mapbox \u5728\u7EBF\u9AD8\u5EA6\u4E0A\u7684\u6548\u679C\u8868\u73B0\u57FA\u672C\u4E00\u81F4
    if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
      // \u4FDD\u6301\u9AD8\u5EA6\u76F8\u5BF9\u4E0D\u53D8
      h *= 2.0/pow(2.0, 20.0 - u_Zoom);
    }

    // amap1.x
    if(u_CoordinateSystem == COORDINATE_SYSTEM_P20 || u_CoordinateSystem == COORDINATE_SYSTEM_P20_OFFSET) {
      // \u4FDD\u6301\u9AD8\u5EA6\u76F8\u5BF9\u4E0D\u53D8
      lineHeight *= pow(2.0, 20.0 - u_Zoom);
    }

    gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy, lineHeight + h, 1.0));
    gl_PointSize = 10.0;
  }
}
`,SL=Fn.isNumber,OM=function(e){(0,ke.Z)(r,e);var t=MM(r);function r(){return(0,ue.Z)(this,r),t.apply(this,arguments)}return(0,_e.Z)(r,[{key:"getUninforms",value:function(){var i=this.layer.getLayerConfig(),a=i.opacity,s=a===void 0?1:a,l=i.sourceColor,p=i.targetColor,m=i.vertexHeightScale,T=m===void 0?20:m,R=0,L=[0,0,0,0],z=[0,0,0,0];return l&&p&&(L=Qi(l),z=Qi(p),R=1),(0,Q.Z)({u_linearColor:R,u_sourceColor:L,u_targetColor:z,u_vertexScale:T},this.getStyleAttribute())}},{key:"initModels",value:function(){var n=(0,hr.Z)(it().mark(function a(){return it().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.abrupt("return",this.buildModels());case 1:case"end":return l.stop()}},a,this)}));function i(){return n.apply(this,arguments)}return i}()},{key:"getShaders",value:function(){var i=this.layer.getLayerConfig(),a=i.sourceColor,s=i.targetColor;return a&&s?{frag:PM,vert:m2,type:"lineSimpleLinear"}:{frag:IM,vert:m2,type:"lineSimpleNormal"}}},{key:"buildModels",value:function(){var n=(0,hr.Z)(it().mark(function a(){var s,l,p,m,T;return it().wrap(function(L){for(;;)switch(L.prev=L.next){case 0:return s=this.getShaders(),l=s.frag,p=s.vert,m=s.type,L.next=3,this.layer.buildLayerModel({moduleName:m,vertexShader:p,fragmentShader:l,triangulation:pR,inject:this.getInject(),primitive:Fe.LINES,depth:{enable:!1},pick:!1});case 3:return T=L.sent,L.abrupt("return",[T]);case 5:case"end":return L.stop()}},a,this)}));function i(){return n.apply(this,arguments)}return i}()},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"distance",type:bn.Attribute,descriptor:{name:"a_Distance",buffer:{usage:Fe.STATIC_DRAW,data:[],type:Fe.FLOAT},size:1,update:function(a,s,l){return[l[3]]}}}),this.styleAttributeService.registerStyleAttribute({name:"total_distance",type:bn.Attribute,descriptor:{name:"a_Total_Distance",buffer:{usage:Fe.STATIC_DRAW,data:[],type:Fe.FLOAT},size:1,update:function(a,s,l){return[l[5]]}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:bn.Attribute,descriptor:{name:"a_Size",buffer:{usage:Fe.DYNAMIC_DRAW,data:[],type:Fe.FLOAT},size:2,update:function(a){var s=a.size,l=s===void 0?1:s;return Array.isArray(l)?[l[0],l[1]]:[l,0]}}})}}]),r}(Lo);function NM(e){var t=DM();return function(){var n=(0,le.Z)(e),i;if(t){var a=(0,le.Z)(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return(0,ze.Z)(this,i)}}function DM(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var LM=`#define Animate 0.0
#define LineTexture 1.0

// line texture
uniform float u_line_texture;
uniform sampler2D u_texture;
uniform vec2 u_textSize;
uniform float u_linearColor: 0;
uniform vec4 u_sourceColor;
uniform vec4 u_targetColor;
uniform float u_opacity : 1.0;
uniform float u_textureBlend;
uniform float u_iconStepCount;
uniform float u_time;
uniform vec4 u_animate: [ 1., 2., 1.0, 0.2 ]; // \u63A7\u5236\u8FD0\u52A8

varying vec2 v_iconMapUV;
varying float v_blur;
varying float v_radio;
varying vec4 v_color;
varying vec4 v_dataset;

#pragma include "picking"

void main() {
  float opacity = u_opacity;
  float animateSpeed = 0.0; // \u8FD0\u52A8\u901F\u5EA6
  float d_distance_ratio = v_dataset.r; // \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B
  float v = v_dataset.a;

  if(u_linearColor == 1.0) { // \u4F7F\u7528\u6E10\u53D8\u989C\u8272
    gl_FragColor = mix(u_sourceColor, u_targetColor, v);
  } else { // \u4F7F\u7528 color \u65B9\u6CD5\u4F20\u5165\u7684\u989C\u8272
     gl_FragColor = v_color;
  }

  gl_FragColor.a *= opacity; // \u5168\u5C40\u900F\u660E\u5EA6
  if(u_animate.x == Animate) {
      animateSpeed = u_time / u_animate.y;
       float alpha =1.0 - fract( mod(1.0- d_distance_ratio, u_animate.z)* (1.0/ u_animate.z) + animateSpeed);
      alpha = (alpha + u_animate.w -1.0) / u_animate.w;
      alpha = smoothstep(0., 1., alpha);
      gl_FragColor.a *= alpha;
  }

  if(u_line_texture == LineTexture) { // while load texture
    float aDistance = v_dataset.g;      // \u5F53\u524D\u9876\u70B9\u7684\u8DDD\u79BB
    float d_texPixelLen = v_dataset.b;  // \u8D34\u56FE\u7684\u50CF\u7D20\u957F\u5EA6\uFF0C\u6839\u636E\u5730\u56FE\u5C42\u7EA7\u7F29\u653E
    float u = fract(mod(aDistance, d_texPixelLen)/d_texPixelLen - animateSpeed);
    float v = v_dataset.a;  // \u7EBF\u56FE\u5C42\u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\u503C

    // \u8BA1\u7B97\u7EB9\u7406\u95F4\u9694 start
    float flag = 0.0;
    if(u > 1.0/u_iconStepCount) {
      flag = 1.0;
    }
    u = fract(u*u_iconStepCount);
    // \u8BA1\u7B97\u7EB9\u7406\u95F4\u9694 end

    vec2 uv= v_iconMapUV / u_textSize + vec2(u, v) / u_textSize * 64.;
    vec4 pattern = texture2D(u_texture, uv);

    // Tip: \u5224\u65AD\u7EB9\u7406\u95F4\u9694
    if(flag > 0.0) {
      pattern = vec4(0.0);
    }

    if(u_textureBlend == 0.0) { // normal
      pattern.a = 0.0;
      gl_FragColor = filterColor(gl_FragColor + pattern);
    } else { // replace
        pattern.a *= opacity;
        if(gl_FragColor.a <= 0.0) {
          pattern.a = 0.0;
        }
        gl_FragColor = filterColor(pattern);
    }
  }
  

  // blur - AA
  if(v < v_blur) {
    gl_FragColor.a = mix(0.0, gl_FragColor.a, v/v_blur);
  } else if(v > 1.0 - v_blur) {
    gl_FragColor.a = mix(gl_FragColor.a, 0.0, (v - (1.0 - v_blur))/v_blur);
  }

  gl_FragColor = filterColor(gl_FragColor);
}
`,FM=`#define Animate 0.0

attribute float a_Miter;
attribute vec4 a_Color;
attribute vec2 a_Size;
attribute vec3 a_Normal;
attribute vec3 a_Position;
attribute vec2 a_iconMapUV;
attribute float a_Total_Distance;
attribute float a_Distance;

uniform mat4 u_ModelMatrix;

uniform vec4 u_animate: [ 1., 2., 1.0, 0.2 ];
uniform float u_icon_step: 100;
uniform float u_heightfixed;
uniform float u_linearColor: 0;

#pragma include "projection"
#pragma include "light"
#pragma include "picking"

// texV \u7EBF\u56FE\u5C42 - \u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\uFF08\u7EBF\u7684\u5BBD\u5EA6\u65B9\u5411\uFF09
varying vec2 v_iconMapUV;
varying vec4 v_color;
varying float v_blur;
varying float v_radio;
varying vec4 v_dataset;

void main() {


  float d_distance_ratio; // \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B
  float d_texPixelLen;    // \u8D34\u56FE\u7684\u50CF\u7D20\u957F\u5EA6\uFF0C\u6839\u636E\u5730\u56FE\u5C42\u7EA7\u7F29\u653E

  v_iconMapUV = a_iconMapUV;
  if(u_heightfixed < 1.0) {     // \u9AD8\u5EA6\u968F zoom \u8C03\u6574
    d_texPixelLen = project_pixel(u_icon_step);
  } else {
    d_texPixelLen = u_icon_step;
  }
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) {
    d_texPixelLen *= 10.0;
  }

  if(u_animate.x == Animate || u_linearColor == 1.0) {
      d_distance_ratio = a_Distance / a_Total_Distance;
  }

  float miter = (a_Miter + 1.0)/2.0;
  // \u8BBE\u7F6E\u6570\u636E\u96C6\u7684\u53C2\u6570
  v_dataset[0] = d_distance_ratio; // \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B
  v_dataset[1] = a_Distance;       // \u5F53\u524D\u9876\u70B9\u7684\u8DDD\u79BB
  v_dataset[2] = d_texPixelLen;    // \u8D34\u56FE\u7684\u50CF\u7D20\u957F\u5EA6\uFF0C\u6839\u636E\u5730\u56FE\u5C42\u7EA7\u7F29\u653E
  v_dataset[3] = miter;          // \u7EBF\u56FE\u5C42\u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\u503C 0 - 1

  vec4 project_pos = project_position(vec4(a_Position.xy, 0, 1.0));

  float originSize = a_Size.x;  // \u56FA\u5B9A\u9AD8\u5EA6
  if(u_heightfixed < 1.0) {     // \u9AD8\u5EA6\u968F zoom \u8C03\u6574
    originSize = project_float_pixel(a_Size.x);
  }

  float wallHeight = originSize * miter;
  float lightWeight = calc_lighting(vec4(project_pos.xy, wallHeight, 1.0));

  v_blur = min(project_float_pixel(2.0) / originSize, 0.05);
  v_color = vec4(a_Color.rgb * lightWeight, a_Color.w);

  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    gl_Position = u_Mvp * (vec4(project_pos.xy, wallHeight, 1.0));
  } else {
    gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy, wallHeight, 1.0));
  }

  setPickingColor(a_PickingColor);
}
`,xL=Fn.isNumber,BM=function(e){(0,ke.Z)(r,e);var t=NM(r);function r(){var n;(0,ue.Z)(this,r);for(var i=arguments.length,a=new Array(i),s=0;s<i;s++)a[s]=arguments[s];return n=t.call.apply(t,[this].concat(a)),(0,ve.Z)((0,St.Z)(n),"updateTexture",function(){var l=n.rendererService.createTexture2D;if(n.texture){n.texture.update({data:n.iconService.getCanvas()}),n.layer.render();return}n.texture=l({data:n.iconService.getCanvas(),mag:Fe.NEAREST,min:Fe.NEAREST,premultiplyAlpha:!1,width:1024,height:n.iconService.canvasHeight||128})}),n}return(0,_e.Z)(r,[{key:"getUninforms",value:function(){var i=this.layer.getLayerConfig(),a=i.sourceColor,s=i.targetColor,l=i.textureBlend,p=l===void 0?"normal":l,m=i.heightfixed,T=m===void 0?!1:m,R=i.lineTexture,L=R===void 0?!1:R,z=i.iconStep,re=z===void 0?100:z,ee=i.iconStepCount,me=ee===void 0?1:ee;this.rendererService.getDirty()&&this.texture.bind();var Ie=0,He=[0,0,0,0],Xe=[0,0,0,0];return a&&s&&(He=Qi(a),Xe=Qi(s),Ie=1),(0,Q.Z)({u_heightfixed:Number(T),u_textureBlend:p==="normal"?0:1,u_texture:this.texture,u_line_texture:L?1:0,u_iconStepCount:me,u_icon_step:re,u_textSize:[1024,this.iconService.canvasHeight||128],u_linearColor:Ie,u_sourceColor:He,u_targetColor:Xe},this.getStyleAttribute())}},{key:"getAnimateUniforms",value:function(){var i=this.layer.getLayerConfig(),a=i.animateOption;return{u_animate:this.animateOption2Array(a),u_time:this.layer.getLayerAnimateTime()}}},{key:"initModels",value:function(){var n=(0,hr.Z)(it().mark(function a(){return it().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return this.updateTexture(),this.iconService.on("imageUpdate",this.updateTexture),l.abrupt("return",this.buildModels());case 3:case"end":return l.stop()}},a,this)}));function i(){return n.apply(this,arguments)}return i}()},{key:"clearModels",value:function(){var i;(i=this.texture)===null||i===void 0||i.destroy(),this.iconService.off("imageUpdate",this.updateTexture)}},{key:"buildModels",value:function(){var n=(0,hr.Z)(it().mark(function a(){var s;return it().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return p.next=2,this.layer.buildLayerModel({moduleName:"lineWall",vertexShader:FM,fragmentShader:LM,triangulation:e_,inject:this.getInject(),depth:{enable:!1},blend:this.getBlend()});case 2:return s=p.sent,p.abrupt("return",[s]);case 4:case"end":return p.stop()}},a,this)}));function i(){return n.apply(this,arguments)}return i}()},{key:"registerBuiltinAttributes",value:function(){var i=this;this.styleAttributeService.registerStyleAttribute({name:"distance",type:bn.Attribute,descriptor:{name:"a_Distance",buffer:{usage:Fe.STATIC_DRAW,data:[],type:Fe.FLOAT},size:1,update:function(s,l,p){return[p[3]]}}}),this.styleAttributeService.registerStyleAttribute({name:"total_distance",type:bn.Attribute,descriptor:{name:"a_Total_Distance",buffer:{usage:Fe.STATIC_DRAW,data:[],type:Fe.FLOAT},size:1,update:function(s,l,p){return[p[5]]}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:bn.Attribute,descriptor:{name:"a_Size",buffer:{usage:Fe.DYNAMIC_DRAW,data:[],type:Fe.FLOAT},size:2,update:function(s){var l=s.size,p=l===void 0?1:l;return Array.isArray(p)?[p[0],p[1]]:[p,0]}}}),this.styleAttributeService.registerStyleAttribute({name:"normal",type:bn.Attribute,descriptor:{name:"a_Normal",buffer:{usage:Fe.STATIC_DRAW,data:[],type:Fe.FLOAT},size:3,update:function(s,l,p,m,T){return T}}}),this.styleAttributeService.registerStyleAttribute({name:"miter",type:bn.Attribute,descriptor:{name:"a_Miter",buffer:{usage:Fe.STATIC_DRAW,data:[],type:Fe.FLOAT},size:1,update:function(s,l,p){return[p[4]]}}}),this.styleAttributeService.registerStyleAttribute({name:"uv",type:bn.Attribute,descriptor:{name:"a_iconMapUV",buffer:{usage:Fe.DYNAMIC_DRAW,data:[],type:Fe.FLOAT},size:2,update:function(s){var l=i.iconService.getIconMap(),p=s.texture,m=l[p]||{x:0,y:0},T=m.x,R=m.y;return[T,R]}}})}}]),r}(Lo),kM={arc:PR,arc3d:UR,greatcircle:pM,wall:BM,line:g2,simple:OM,linearline:RM,earthArc3d:XR,flowline:uM},UM=kM;function ZM(e){var t=zM();return function(){var n=(0,le.Z)(e),i;if(t){var a=(0,le.Z)(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return(0,ze.Z)(this,i)}}function zM(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var n_=function(e){(0,ke.Z)(r,e);var t=ZM(r);function r(){var n;(0,ue.Z)(this,r);for(var i=arguments.length,a=new Array(i),s=0;s<i;s++)a[s]=arguments[s];return n=t.call.apply(t,[this].concat(a)),(0,ve.Z)((0,St.Z)(n),"type","LineLayer"),(0,ve.Z)((0,St.Z)(n),"enableShaderEncodeStyles",["opacity","offsets","stroke","thetaOffset"]),(0,ve.Z)((0,St.Z)(n),"arrowInsertCount",0),(0,ve.Z)((0,St.Z)(n),"defaultSourceConfig",{data:[{lng1:100,lat1:30,lng2:130,lat2:30}],options:{parser:{type:"json",x:"lng1",y:"lat1",x1:"lng2",y1:"lat2"}}}),n}return(0,_e.Z)(r,[{key:"buildModels",value:function(){var n=(0,hr.Z)(it().mark(function a(){var s;return it().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return s=this.getModelType(),this.layerModel=new UM[s](this),p.next=4,this.initLayerModels();case 4:case"end":return p.stop()}},a,this)}));function i(){return n.apply(this,arguments)}return i}()},{key:"getDefaultConfig",value:function(){var i=this.getModelType(),a={line:{},linearline:{},simple:{},wall:{},arc3d:{blend:"additive"},arc:{blend:"additive"},greatcircle:{blend:"additive"},tileLine:{},earthArc3d:{},flowline:{},arrow:{}};return a[i]}},{key:"getModelType",value:function(){var i;if(this.layerType)return this.layerType;var a=this.styleAttributeService.getLayerStyleAttribute("shape"),s=a==null||(i=a.scale)===null||i===void 0?void 0:i.field;return s||"line"}},{key:"processData",value:function(i){if(this.getModelType()!=="simple")return i;var a=[];return i.map(function(s){if(Array.isArray(s.coordinates)&&Array.isArray(s.coordinates[0])&&Array.isArray(s.coordinates[0][0])){var l=(0,Q.Z)({},s);s.coordinates.map(function(p){a.push((0,Q.Z)((0,Q.Z)({},l),{},{coordinates:p}))})}else a.push(s)}),a}}]),r}(fp);function GM(e){var t=VM();return function(){var n=(0,le.Z)(e),i;if(t){var a=(0,le.Z)(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return(0,ze.Z)(this,i)}}function VM(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var HM=`
uniform float u_additive;
uniform float u_stroke_opacity : 1;

uniform vec4 u_stroke_color : [0.0, 0.0, 0.0, 0.0];

varying vec4 v_color;
varying float v_blur;
varying float v_innerRadius;

#pragma include "picking"
void main() {
  vec2 center = vec2(0.5);

  // Tip: \u7247\u5143\u5230\u4E2D\u5FC3\u70B9\u7684\u8DDD\u79BB 0 - 1
  float fragmengTocenter = distance(center, gl_PointCoord) * 2.0;
  // Tip: \u7247\u5143\u7684\u526A\u5207\u6210\u5706\u5F62
  float circleClipOpacity = 1.0 - smoothstep(v_blur, 1.0, fragmengTocenter);


  if(v_innerRadius < 0.99) {
    // \u5F53\u5B58\u5728 stroke \u4E14 stroke > 0.01
    float blurWidth = (1.0 - v_blur)/2.0;
    vec4 stroke = vec4(u_stroke_color.rgb, u_stroke_opacity);
    if(fragmengTocenter > v_innerRadius + blurWidth) {
      gl_FragColor = stroke;
    } else if(fragmengTocenter > v_innerRadius - blurWidth){
      float mixR = (fragmengTocenter - (v_innerRadius - blurWidth)) / (blurWidth * 2.0);
      gl_FragColor = mix(v_color, stroke, mixR);
    } else {
      gl_FragColor = v_color;
    }
  } else {
    // \u5F53\u4E0D\u5B58\u5728 stroke \u6216 stroke <= 0.01
    gl_FragColor = v_color;
  }

  gl_FragColor = filterColor(gl_FragColor);
  
  if(u_additive > 0.0) {
    gl_FragColor *= circleClipOpacity;
  } else {
    gl_FragColor.a *= circleClipOpacity;
  }

}
`,WM=`
attribute vec3 a_Position;
uniform mat4 u_ModelMatrix;

attribute float a_Size;
attribute vec4 a_Color;
varying vec4 v_color;

uniform float u_opacity : 1;
uniform vec2 u_offsets;
uniform float u_stroke_width;

varying float v_blur;
varying float v_innerRadius;



#pragma include "projection"
#pragma include "picking"
#pragma include "project"
void main() {
  v_color = vec4(a_Color.xyz, a_Color.w * u_opacity);
  v_blur = 1.0 - max(2.0/a_Size, 0.05);
  v_innerRadius = max((a_Size - u_stroke_width) / a_Size, 0.0);
  
  vec2 offset = project_pixel(u_offsets);
  
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    gl_Position = u_Mvp * vec4(a_Position.xy + offset, a_Position.z, 1.0);
  } else { // else
    vec4 project_pos = project_position(vec4(a_Position, 1.0)) + vec4(a_Size / 2.,-a_Size /2.,0.,0.);
    gl_Position = project_common_position_to_clipspace(vec4(vec2(project_pos.xy+offset),project_pos.z,project_pos.w));
  }
  
  gl_PointSize = a_Size * 2.0 * u_DevicePixelRatio;
  setPickingColor(a_PickingColor);
}
`;function _2(e){var t=e.coordinates;return{vertices:(0,cr.Z)(t),indices:[0],size:t.length}}var jM=function(e){(0,ke.Z)(r,e);var t=GM(r);function r(){return(0,ue.Z)(this,r),t.apply(this,arguments)}return(0,_e.Z)(r,[{key:"getDefaultStyle",value:function(){return{blend:"additive"}}},{key:"getUninforms",value:function(){var i=this.layer.getLayerConfig(),a=i.opacity,s=a===void 0?1:a,l=i.offsets,p=l===void 0?[0,0]:l,m=i.blend,T=i.strokeOpacity,R=T===void 0?1:T,L=i.strokeWidth,z=L===void 0?0:L,re=i.stroke,ee=re===void 0?"#fff":re;return{u_additive:m==="additive"?1:0,u_opacity:s,u_offsets:p,u_stroke_opacity:R,u_stroke_width:z,u_stroke_color:Qi(ee)}}},{key:"initModels",value:function(){var n=(0,hr.Z)(it().mark(function a(){return it().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.abrupt("return",this.buildModels());case 1:case"end":return l.stop()}},a,this)}));function i(){return n.apply(this,arguments)}return i}()},{key:"buildModels",value:function(){var n=(0,hr.Z)(it().mark(function a(){var s;return it().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return this.layer.triangulation=_2,p.next=3,this.layer.buildLayerModel({moduleName:"pointSimple",vertexShader:WM,fragmentShader:HM,triangulation:_2,depth:{enable:!1},primitive:Fe.POINTS});case 3:return s=p.sent,p.abrupt("return",[s]);case 5:case"end":return p.stop()}},a,this)}));function i(){return n.apply(this,arguments)}return i}()},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"size",type:bn.Attribute,descriptor:{name:"a_Size",buffer:{usage:Fe.DYNAMIC_DRAW,data:[],type:Fe.FLOAT},size:1,update:function(a){var s=a.size,l=s===void 0?1:s;return Array.isArray(l)?[l[0]]:[l]}}})}}]),r}(Lo);function XM(e){var t=YM();return function(){var n=(0,le.Z)(e),i;if(t){var a=(0,le.Z)(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return(0,ze.Z)(this,i)}}function YM(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var $M=`varying vec4 v_color;
uniform float u_opacity: 1.0;

uniform float u_pickLight: 0.0;

#pragma include "picking"


uniform float u_linearColor: 0;
uniform vec4 u_sourceColor;
uniform vec4 u_targetColor;

uniform float u_opacitylinear: 0.0;
uniform float u_opacitylinear_dir: 1.0;
varying float v_lightWeight;
varying float v_barLinearZ;
void main() {

   gl_FragColor = v_color;

  // \u5F00\u542F\u900F\u660E\u5EA6\u6E10\u53D8
  if(u_opacitylinear > 0.0) {
    gl_FragColor.a *= u_opacitylinear_dir > 0.0 ? (1.0 - v_barLinearZ): v_barLinearZ;
  }

  // picking
  if(u_pickLight > 0.0) {
    gl_FragColor = filterColorAlpha(gl_FragColor, v_lightWeight);
  } else {
    gl_FragColor = filterColor(gl_FragColor);
  }
}
`,QM=`precision highp float;

#define pi 3.1415926535
#define ambientRatio 0.5
#define diffuseRatio 0.3
#define specularRatio 0.2

attribute vec3 a_Position;
attribute vec3 a_Pos;
attribute vec4 a_Color;
attribute vec3 a_Size;
attribute vec3 a_Normal;

uniform float u_heightfixed: 0.0; // \u9ED8\u8BA4\u4E0D\u56FA\u5B9A
uniform float u_globel;
uniform float u_r;
uniform mat4 u_ModelMatrix;

varying vec4 v_color;

uniform float u_opacity : 1;
uniform float u_lightEnable: 1;
varying float v_lightWeight;
varying float v_barLinearZ;
// \u7528\u4E8E\u5C06\u5728\u9876\u70B9\u7740\u8272\u5668\u4E2D\u8BA1\u7B97\u597D\u7684\u6837\u5F0F\u503C\u4F20\u9012\u7ED9\u7247\u5143


#pragma include "projection"
#pragma include "light"
#pragma include "picking"

float getYRadian(float x, float z) {
  if(x > 0.0 && z > 0.0) {
    return atan(x/z);
  } else if(x > 0.0 && z <= 0.0){
    return atan(-z/x) + pi/2.0;
  } else if(x <= 0.0 && z <= 0.0) {
    return  pi + atan(x/z); //atan(x/z) + 
  } else {
    return atan(z/-x) + pi*3.0/2.0;
  }
}

float getXRadian(float y, float r) {
  return atan(y/r);
}

void main() {

  
  float textureOffset = 0.0; // \u5728 cell \u4E2D\u53D6\u503C\u7684\u504F\u79FB\u91CF

  textureOffset = opacityAndOffset.g;
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
  vec3 size = a_Size * a_Position;

  // a_Position.z \u662F\u5728\u6784\u5EFA\u7F51\u683C\u7684\u65F6\u5019\u4F20\u5165\u7684\u6807\u51C6\u503C 0 - 1\uFF0C\u5728\u63D2\u503C\u5668\u63D2\u503C\u53EF\u4EE5\u83B7\u53D6 0\uFF5E1 \u7EBF\u6027\u6E10\u53D8\u7684\u503C
  v_barLinearZ =  a_Position.z;

  vec3 offset = size; // \u63A7\u5236\u5706\u67F1\u4F53\u7684\u5927\u5C0F - \u4ECE\u6807\u51C6\u5355\u4F4D\u5706\u67F1\u4F53\u8FDB\u884C\u504F\u79FB
  if(u_heightfixed < 1.0) { // \u5706\u67F1\u4F53\u4E0D\u56FA\u5B9A\u9AD8\u5EA6
    
    if (u_CoordinateSystem == COORDINATE_SYSTEM_P20 || u_CoordinateSystem == COORDINATE_SYSTEM_P20_OFFSET) {
      // P20 \u5750\u6807\u7CFB\u4E0B\uFF0C\u4E3A\u4E86\u548C Web \u58A8\u5361\u6258\u5750\u6807\u7CFB\u7EDF\u4E00\uFF0Czoom \u9ED8\u8BA4\u51CF1
      offset = offset * pow(2.0, (19.0 - u_Zoom));
    }
    if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) {
      // P20_2 \u5750\u6807\u7CFB\u4E0B\uFF0C\u4E3A\u4E86\u548C Web \u58A8\u5361\u6258\u5750\u6807\u7CFB\u7EDF\u4E00\uFF0Czoom \u9ED8\u8BA4\u51CF3
      offset = offset * pow(2.0, (19.0 - 3.0 - u_Zoom));
    }
  } else {// \u5706\u67F1\u4F53\u56FA\u5B9A\u9AD8\u5EA6 \uFF08 \u5904\u7406 mapbox \uFF09
    if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
      offset *= 4.0/pow(2.0, 21.0 - u_Zoom);
    }
  }


  vec4 project_pos = project_position(vec4(a_Pos.xy, 0., 1.0));

  // u_r \u63A7\u5236\u5706\u67F1\u7684\u751F\u957F
  vec4 pos = vec4(project_pos.xy + offset.xy, offset.z * u_r, 1.0);

  // \u5706\u67F1\u5149\u7167\u6548\u679C
  float lightWeight = 1.0;
  if(u_lightEnable > 0.0) { // \u53D6\u6D88\u4E09\u5143\u8868\u8FBE\u5F0F\uFF0C\u589E\u5F3A\u5065\u58EE\u6027
    lightWeight = calc_lighting(pos);
  }
  v_lightWeight = lightWeight;
  // \u8BBE\u7F6E\u5706\u67F1\u7684\u5E95\u8272
  if(u_linearColor == 1.0) { // \u4F7F\u7528\u6E10\u53D8\u989C\u8272
    v_color = mix(u_sourceColor, u_targetColor, barLinearZ);
    v_color.rgb *= lightWeight;
  } else { // \u4F7F\u7528 color \u65B9\u6CD5\u4F20\u5165\u7684\u989C\u8272
     v_color = a_Color;
  }
  v_color.a *= u_opacity;

    
  // \u5728\u5730\u7403\u6A21\u5F0F\u4E0B\uFF0C\u5C06\u539F\u672C\u5782\u76F4\u4E8E xy \u5E73\u9762\u7684\u5706\u67F1\u8C03\u6574\u59FF\u6001\u5230\u9002\u5E94\u5706\u7684\u89D2\u5EA6
  //\u65CB\u8F6C\u77E9\u9635mx\uFF0C\u521B\u5EFA\u7ED5x\u8F74\u65CB\u8F6C\u77E9\u9635
  float r = sqrt(a_Pos.z*a_Pos.z + a_Pos.x*a_Pos.x);
  float xRadian = getXRadian(a_Pos.y, r);
  float xcos = cos(xRadian);//\u6C42\u89E3\u65CB\u8F6C\u89D2\u5EA6\u4F59\u5F26\u503C
  float xsin = sin(xRadian);//\u6C42\u89E3\u65CB\u8F6C\u89D2\u5EA6\u6B63\u5F26\u503C
  mat4 mx = mat4(
    1,0,0,0,  
    0,xcos,-xsin,0,  
    0,xsin,xcos,0,  
    0,0,0,1);

  //\u65CB\u8F6C\u77E9\u9635my\uFF0C\u521B\u5EFA\u7ED5y\u8F74\u65CB\u8F6C\u77E9\u9635
  float yRadian = getYRadian(a_Pos.x, a_Pos.z);
  float ycos = cos(yRadian);//\u6C42\u89E3\u65CB\u8F6C\u89D2\u5EA6\u4F59\u5F26\u503C
  float ysin = sin(yRadian);//\u6C42\u89E3\u65CB\u8F6C\u89D2\u5EA6\u6B63\u5F26\u503C
  mat4 my = mat4(
    ycos,0,-ysin,0,  
    0,1,0,0,  
    ysin,0,ycos,0,  
    0,0,0,1);

  gl_Position = u_ViewProjectionMatrix * vec4(( my * mx *  vec4(a_Position * a_Size, 1.0)).xyz + a_Pos, 1.0);
  

  setPickingColor(a_PickingColor);
}
`,qM=Fn.isNumber,KM=function(e){(0,ke.Z)(r,e);var t=XM(r);function r(){var n;(0,ue.Z)(this,r);for(var i=arguments.length,a=new Array(i),s=0;s<i;s++)a[s]=arguments[s];return n=t.call.apply(t,[this].concat(a)),(0,ve.Z)((0,St.Z)(n),"raiseCount",0),(0,ve.Z)((0,St.Z)(n),"raiseRepeat",0),n}return(0,_e.Z)(r,[{key:"getUninforms",value:function(){var i=this.layer.getLayerConfig(),a=i.animateOption,s=a===void 0?{enable:!1,speed:.01,repeat:!1}:a,l=i.opacity,p=l===void 0?1:l,m=i.sourceColor,T=i.targetColor,R=i.pickLight,L=R===void 0?!1:R,z=i.heightfixed,re=z===void 0?!1:z,ee=i.opacityLinear,me=ee===void 0?{enable:!1,dir:"up"}:ee,Ie=i.lightEnable,He=Ie===void 0?!0:Ie,Xe=0,ot=[0,0,0,0],pt=[0,0,0,0];if(m&&T&&(ot=Qi(m),pt=Qi(T),Xe=1),this.raiseCount<1&&this.raiseRepeat>0&&s.enable){var dt=s.speed,It=dt===void 0?.01:dt;this.raiseCount+=It,this.raiseCount>=1&&(this.raiseRepeat>1?(this.raiseCount=0,this.raiseRepeat--):this.raiseCount=1)}return{u_pickLight:Number(L),u_heightfixed:Number(re),u_r:s.enable&&this.raiseRepeat>0?this.raiseCount:1,u_opacity:qM(p)?p:1,u_linearColor:Xe,u_sourceColor:ot,u_targetColor:pt,u_opacitylinear:Number(me.enable),u_opacitylinear_dir:me.dir==="up"?1:0,u_lightEnable:Number(He)}}},{key:"initModels",value:function(){var n=(0,hr.Z)(it().mark(function a(){return it().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.abrupt("return",this.buildModels());case 1:case"end":return l.stop()}},a,this)}));function i(){return n.apply(this,arguments)}return i}()},{key:"buildModels",value:function(){var n=(0,hr.Z)(it().mark(function a(){var s,l,p,m;return it().wrap(function(R){for(;;)switch(R.prev=R.next){case 0:return s=this.layer.getLayerConfig(),l=s.animateOption.repeat,p=l===void 0?1:l,this.raiseRepeat=p,R.next=4,this.layer.buildLayerModel({moduleName:"pointEarthExtrude",vertexShader:QM,fragmentShader:$M,triangulation:c2,depth:{enable:!0},cull:{enable:!0,face:Ru(this.mapService.version)},blend:this.getBlend()});case 4:return m=R.sent,R.abrupt("return",[m]);case 6:case"end":return R.stop()}},a,this)}));function i(){return n.apply(this,arguments)}return i}()},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"size",type:bn.Attribute,descriptor:{name:"a_Size",buffer:{usage:Fe.DYNAMIC_DRAW,data:[],type:Fe.FLOAT},size:3,update:function(a){var s=a.size;if(s){var l=[];return Array.isArray(s)&&(l=s.length===2?[s[0],s[0],s[1]]:s),Array.isArray(s)||(l=[s,s,s]),l}else return[2,2,2]}}}),this.styleAttributeService.registerStyleAttribute({name:"normal",type:bn.Attribute,descriptor:{name:"a_Normal",buffer:{usage:Fe.STATIC_DRAW,data:[],type:Fe.FLOAT},size:3,update:function(a,s,l,p,m){return m}}}),this.styleAttributeService.registerStyleAttribute({name:"pos",type:bn.Attribute,descriptor:{name:"a_Pos",buffer:{usage:Fe.DYNAMIC_DRAW,data:[],type:Fe.FLOAT},size:3,update:function(a){var s=Du(a.coordinates);return X1([s[0],s[1]])}}})}}]),r}(Lo);function JM(e){var t=ew();return function(){var n=(0,le.Z)(e),i;if(t){var a=(0,le.Z)(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return(0,ze.Z)(this,i)}}function ew(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var tw=`uniform float u_additive;
uniform float u_opacity : 1;
uniform float u_stroke_opacity : 1;
uniform float u_stroke_width : 2;

varying vec4 v_data;
varying vec4 v_color;
varying float v_radius;

#pragma include "sdf_2d"
#pragma include "picking"


void main() {
  int shape = int(floor(v_data.w + 0.5));

  vec4 strokeColor = textrueStroke == vec4(0) ? v_color : textrueStroke;

  lowp float antialiasblur = v_data.z;
  float r = v_radius / (v_radius + strokeWidth);

  float outer_df;
  float inner_df;
  // 'circle', 'triangle', 'square', 'pentagon', 'hexagon', 'octogon', 'hexagram', 'rhombus', 'vesica'
  if (shape == 0) {
    outer_df = sdCircle(v_data.xy, 1.0);
    inner_df = sdCircle(v_data.xy, r);
  } else if (shape == 1) {
    outer_df = sdEquilateralTriangle(1.1 * v_data.xy);
    inner_df = sdEquilateralTriangle(1.1 / r * v_data.xy);
  } else if (shape == 2) {
    outer_df = sdBox(v_data.xy, vec2(1.));
    inner_df = sdBox(v_data.xy, vec2(r));
  } else if (shape == 3) {
    outer_df = sdPentagon(v_data.xy, 0.8);
    inner_df = sdPentagon(v_data.xy, r * 0.8);
  } else if (shape == 4) {
    outer_df = sdHexagon(v_data.xy, 0.8);
    inner_df = sdHexagon(v_data.xy, r * 0.8);
  } else if (shape == 5) {
    outer_df = sdOctogon(v_data.xy, 1.0);
    inner_df = sdOctogon(v_data.xy, r);
  } else if (shape == 6) {
    outer_df = sdHexagram(v_data.xy, 0.52);
    inner_df = sdHexagram(v_data.xy, r * 0.52);
  } else if (shape == 7) {
    outer_df = sdRhombus(v_data.xy, vec2(1.0));
    inner_df = sdRhombus(v_data.xy, vec2(r));
  } else if (shape == 8) {
    outer_df = sdVesica(v_data.xy, 1.1, 0.8);
    inner_df = sdVesica(v_data.xy, r * 1.1, r * 0.8);
  }

  if(outer_df > antialiasblur + 0.018) discard;

  float opacity_t = smoothstep(0.0, antialiasblur, outer_df);

  float color_t = strokeWidth < 0.01 ? 0.0 : smoothstep(
    antialiasblur,
    0.0,
    inner_df
  );

  if(strokeWidth < 0.01) {
    gl_FragColor = vec4(v_color.rgb, v_color.a * u_opacity);
  } else {
    gl_FragColor = mix(vec4(v_color.rgb, v_color.a * u_opacity), u_stroke_color * u_stroke_opacity, color_t);
  }

  if(u_additive > 0.0) {
    gl_FragColor *= opacity_t;
    gl_FragColor = filterColorAlpha(gl_FragColor, gl_FragColor.a);
  } else {
    gl_FragColor.a *= opacity_t;
    gl_FragColor = filterColor(gl_FragColor);
  }
}
`,rw=`attribute vec4 a_Color;
attribute vec3 a_Position;
attribute vec3 a_Extrude;
attribute float a_Size;
attribute float a_Shape;
uniform mat4 u_ModelMatrix;


varying vec4 v_data;
varying vec4 v_color;
varying float v_radius;

uniform float u_opacity : 1;
uniform float u_stroke_opacity : 1;
uniform float u_stroke_width : 2;
uniform vec4 u_stroke_color : [0.0, 0.0, 0.0, 0.0];
uniform vec2 u_offsets;

uniform float u_blur : 0.0;

#pragma include "projection"
#pragma include "picking"


void main() {
  vec3 extrude = a_Extrude;
  float shape_type = a_Shape;
  /*
  *  setPickingSize \u8BBE\u7F6E\u62FE\u53D6\u5927\u5C0F
  */
  float newSize = setPickingSize(a_Size);
  // float newSize = setPickingSize(a_Size) * 0.00001038445708445579;

  // unpack color(vec2)
  v_color = a_Color;

  // radius(16-bit)
  v_radius = newSize;

  // anti-alias
  //  float antialiased_blur = -max(u_blur, antialiasblur);
  float antialiasblur = -max(2.0 / u_DevicePixelRatio / newSize, u_blur);

  // TODP: /abs(extrude.x) \u662F\u4E3A\u4E86\u517C\u5BB9\u5730\u7403\u6A21\u5F0F
  v_data = vec4(extrude.x/abs(extrude.x), extrude.y/abs(extrude.y), antialiasblur,shape_type);


  gl_Position = u_ViewProjectionMatrix * vec4(a_Position + extrude * newSize * 0.1 + u_offsets, 1.0);

  setPickingColor(a_PickingColor);
}
`,nw=function(e){(0,ke.Z)(r,e);var t=JM(r);function r(){return(0,ue.Z)(this,r),t.apply(this,arguments)}return(0,_e.Z)(r,[{key:"getUninforms",value:function(){var i=this.layer.getLayerConfig(),a=i.opacity,s=a===void 0?1:a,l=i.strokeOpacity,p=l===void 0?1:l,m=i.strokeWidth,T=m===void 0?0:m,R=i.stroke,L=R===void 0?"rgba(0,0,0,0)":R,z=i.blend,re=i.blur,ee=re===void 0?0:re;return{u_blur:ee,u_additive:z==="additive"?1:0,u_opacity:s,u_stroke_opacity:p,u_stroke_width:T,u_stroke_color:Qi(L)}}},{key:"getAnimateUniforms",value:function(){var i=this.layer.getLayerConfig(),a=i.animateOption,s=a===void 0?{enable:!1}:a;return{u_animate:this.animateOption2Array(s),u_time:this.layer.getLayerAnimateTime()}}},{key:"initModels",value:function(){var n=(0,hr.Z)(it().mark(function a(){return it().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.abrupt("return",this.buildModels());case 1:case"end":return l.stop()}},a,this)}));function i(){return n.apply(this,arguments)}return i}()},{key:"buildModels",value:function(){var n=(0,hr.Z)(it().mark(function a(){var s;return it().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return this.layer.triangulation=l2,p.next=3,this.layer.buildLayerModel({moduleName:"pointEarthFill",vertexShader:rw,fragmentShader:tw,triangulation:l2,depth:{enable:!0},blend:this.getBlend()});case 3:return s=p.sent,p.abrupt("return",[s]);case 5:case"end":return p.stop()}},a,this)}));function i(){return n.apply(this,arguments)}return i}()},{key:"animateOption2Array",value:function(i){return[i.enable?0:1,i.speed||1,i.rings||3,0]}},{key:"registerBuiltinAttributes",value:function(){var i=this;this.styleAttributeService.registerStyleAttribute({name:"extrude",type:bn.Attribute,descriptor:{name:"a_Extrude",buffer:{usage:Fe.DYNAMIC_DRAW,data:[],type:Fe.FLOAT},size:3,update:function(s,l,p,m){var T=(0,yn.Z)(p,3),R=T[0],L=T[1],z=T[2],re=rl(0,0,1),ee=rl(R,0,z),me=R>=0?Qm(re,ee):Math.PI*2-Qm(re,ee),Ie=Math.PI*2-Math.asin(L/100),He=_i();dl(He,He,me),Jo(He,He,Ie);var Xe=rl(1,1,0);dd(Xe,Xe,He),dp(Xe,Xe);var ot=rl(-1,1,0);dd(ot,ot,He),dp(ot,ot);var pt=rl(-1,-1,0);dd(pt,pt,He),dp(pt,pt);var dt=rl(1,-1,0);dd(dt,dt,He),dp(dt,dt);var It=[].concat((0,cr.Z)(Xe),(0,cr.Z)(ot),(0,cr.Z)(pt),(0,cr.Z)(dt)),Vt=m%4*3;return[It[Vt],It[Vt+1],It[Vt+2]]}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:bn.Attribute,descriptor:{name:"a_Size",buffer:{usage:Fe.DYNAMIC_DRAW,data:[],type:Fe.FLOAT},size:1,update:function(s){var l=s.size,p=l===void 0?5:l;return Array.isArray(p)?[p[0]]:[p]}}}),this.styleAttributeService.registerStyleAttribute({name:"shape",type:bn.Attribute,descriptor:{name:"a_Shape",buffer:{usage:Fe.DYNAMIC_DRAW,data:[],type:Fe.FLOAT},size:1,update:function(s){var l=s.shape,p=l===void 0?2:l,m=i.layer.getLayerConfig().shape2d,T=m.indexOf(p);return[T]}}})}}]),r}(Lo);function iw(e){var t=aw();return function(){var n=(0,le.Z)(e),i;if(t){var a=(0,le.Z)(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return(0,ze.Z)(this,i)}}function aw(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var ow=`varying vec4 v_color;
varying float v_lightWeight;
uniform float u_pickLight: 0.0;

#pragma include "picking"


void main() {

  gl_FragColor = v_color;
  // \u5F00\u542F\u900F\u660E\u5EA6\u6E10\u53D8
  // picking
  if(u_pickLight > 0.0) {
    gl_FragColor = filterColorAlpha(gl_FragColor, v_lightWeight);
  } else {
    gl_FragColor = filterColor(gl_FragColor);
  }
}
`,sw=`precision highp float;

#define pi 3.1415926535
#define ambientRatio 0.5
#define diffuseRatio 0.3
#define specularRatio 0.2

attribute vec3 a_Position;
attribute vec3 a_Pos;
attribute vec4 a_Color;
attribute vec3 a_Size;
attribute vec3 a_Normal;

uniform float u_heightfixed: 0.0; // \u9ED8\u8BA4\u4E0D\u56FA\u5B9A
uniform float u_r;
uniform mat4 u_ModelMatrix;

varying vec4 v_color;
varying float v_lightWeight;
varying float v_barLinearZ;

uniform float u_opacity : 1;
uniform float u_lightEnable: 1;
uniform float u_opacitylinear: 0.0;
uniform vec4 u_sourceColor;
uniform vec4 u_targetColor;
uniform float u_opacitylinear_dir: 1.0;
uniform float  u_linearColor: 0.0;


#pragma include "projection"
#pragma include "light"
#pragma include "picking"

float getYRadian(float x, float z) {
  if(x > 0.0 && z > 0.0) {
    return atan(x/z);
  } else if(x > 0.0 && z <= 0.0){
    return atan(-z/x) + pi/2.0;
  } else if(x <= 0.0 && z <= 0.0) {
    return  pi + atan(x/z); //atan(x/z) + 
  } else {
    return atan(z/-x) + pi*3.0/2.0;
  }
}

float getXRadian(float y, float r) {
  return atan(y/r);
}

void main() {


  vec3 size = a_Size * a_Position;

  vec3 offset = size; // \u63A7\u5236\u5706\u67F1\u4F53\u7684\u5927\u5C0F - \u4ECE\u6807\u51C6\u5355\u4F4D\u5706\u67F1\u4F53\u8FDB\u884C\u504F\u79FB

  if(u_heightfixed < 1.0) { // \u5706\u67F1\u4F53\u4E0D\u56FA\u5B9A\u9AD8\u5EA6
    
    if (u_CoordinateSystem == COORDINATE_SYSTEM_P20 || u_CoordinateSystem == COORDINATE_SYSTEM_P20_OFFSET) {
      // P20 \u5750\u6807\u7CFB\u4E0B\uFF0C\u4E3A\u4E86\u548C Web \u58A8\u5361\u6258\u5750\u6807\u7CFB\u7EDF\u4E00\uFF0Czoom \u9ED8\u8BA4\u51CF1
      offset = offset * pow(2.0, (19.0 - u_Zoom));
    }
    if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) {
      // P20_2 \u5750\u6807\u7CFB\u4E0B\uFF0C\u4E3A\u4E86\u548C Web \u58A8\u5361\u6258\u5750\u6807\u7CFB\u7EDF\u4E00\uFF0Czoom \u9ED8\u8BA4\u51CF3
      offset = offset * pow(2.0, (19.0 - 3.0 - u_Zoom));
    }
  } else {// \u5706\u67F1\u4F53\u56FA\u5B9A\u9AD8\u5EA6 \uFF08 \u5904\u7406 mapbox \uFF09
    if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
      offset *= 4.0/pow(2.0, 21.0 - u_Zoom);
    }
  }


  vec4 project_pos = project_position(vec4(a_Pos.xy, 0., 1.0));

  // u_r \u63A7\u5236\u5706\u67F1\u7684\u751F\u957F
  vec4 pos = vec4(project_pos.xy + offset.xy, offset.z * u_r, 1.0);

  // // \u5706\u67F1\u5149\u7167\u6548\u679C
  float lightWeight = 1.0;

  if(u_lightEnable > 0.0) { // \u53D6\u6D88\u4E09\u5143\u8868\u8FBE\u5F0F\uFF0C\u589E\u5F3A\u5065\u58EE\u6027
    lightWeight = calc_lighting(pos);
  }

  v_lightWeight = lightWeight;

  v_color = a_Color;

    // \u8BBE\u7F6E\u5706\u67F1\u7684\u5E95\u8272
  if(u_linearColor == 1.0) { // \u4F7F\u7528\u6E10\u53D8\u989C\u8272
    v_color = mix(u_sourceColor, u_targetColor, a_Position.z);
    v_color.a =  v_color.a * u_opacity;
  } else {
    v_color = vec4(a_Color.rgb * lightWeight, a_Color.w * u_opacity);
  }

    if(u_opacitylinear > 0.0) {
    v_color.a *= u_opacitylinear_dir > 0.0 ? (1.0 - a_Position.z): a_Position.z;
  }


  // gl_Position = project_common_position_to_clipspace(pos);

  gl_Position = project_common_position_to_clipspace_v2(pos);

  setPickingColor(a_PickingColor);
}
`,y2=function(e){(0,ke.Z)(r,e);var t=iw(r);function r(){var n;(0,ue.Z)(this,r);for(var i=arguments.length,a=new Array(i),s=0;s<i;s++)a[s]=arguments[s];return n=t.call.apply(t,[this].concat(a)),(0,ve.Z)((0,St.Z)(n),"raiseCount",0),(0,ve.Z)((0,St.Z)(n),"raiseRepeat",0),n}return(0,_e.Z)(r,[{key:"getUninforms",value:function(){var i=this.layer.getLayerConfig(),a=i.animateOption,s=a===void 0?{enable:!1,speed:.01,repeat:!1}:a,l=i.opacity,p=l===void 0?1:l,m=i.sourceColor,T=i.targetColor,R=i.pickLight,L=R===void 0?!1:R,z=i.heightfixed,re=z===void 0?!1:z,ee=i.opacityLinear,me=ee===void 0?{enable:!1,dir:"up"}:ee,Ie=i.lightEnable,He=Ie===void 0?!0:Ie,Xe=0,ot=[0,0,0,0],pt=[0,0,0,0];if(m&&T&&(ot=Qi(m),pt=Qi(T),Xe=1),this.raiseCount<1&&this.raiseRepeat>0&&s.enable){var dt=s.speed,It=dt===void 0?.01:dt;this.raiseCount+=It,this.raiseCount>=1&&(this.raiseRepeat>1?(this.raiseCount=0,this.raiseRepeat--):this.raiseCount=1)}return{u_pickLight:Number(L),u_heightfixed:Number(re),u_r:s.enable&&this.raiseRepeat>0?this.raiseCount:1,u_opacity:p,u_linearColor:Xe,u_sourceColor:ot,u_targetColor:pt,u_opacitylinear:Number(me.enable),u_opacitylinear_dir:me.dir==="up"?1:0,u_lightEnable:Number(He)}}},{key:"initModels",value:function(){var n=(0,hr.Z)(it().mark(function a(){return it().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.abrupt("return",this.buildModels());case 1:case"end":return l.stop()}},a,this)}));function i(){return n.apply(this,arguments)}return i}()},{key:"buildModels",value:function(){var n=(0,hr.Z)(it().mark(function a(){var s,l,p,m,T,R;return it().wrap(function(z){for(;;)switch(z.prev=z.next){case 0:return s=this.layer.getLayerConfig(),l=s.depth,p=l===void 0?!0:l,m=s.animateOption.repeat,T=m===void 0?1:m,this.raiseRepeat=T,z.next=4,this.layer.buildLayerModel({moduleName:"pointExtrude",vertexShader:sw,fragmentShader:ow,triangulation:c2,cull:{enable:!0,face:Ru(this.mapService.version)},depth:{enable:p}});case 4:return R=z.sent,z.abrupt("return",[R]);case 6:case"end":return z.stop()}},a,this)}));function i(){return n.apply(this,arguments)}return i}()},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"size",type:bn.Attribute,descriptor:{name:"a_Size",buffer:{usage:Fe.DYNAMIC_DRAW,data:[],type:Fe.FLOAT},size:3,update:function(a){var s=a.size;if(s){var l=[];return Array.isArray(s)&&(l=s.length===2?[s[0],s[0],s[1]]:s),Array.isArray(s)||(l=[s,s,s]),l}else return[2,2,2]}}}),this.styleAttributeService.registerStyleAttribute({name:"normal",type:bn.Attribute,descriptor:{name:"a_Normal",buffer:{usage:Fe.STATIC_DRAW,data:[],type:Fe.FLOAT},size:3,update:function(a,s,l,p,m){return m}}}),this.styleAttributeService.registerStyleAttribute({name:"pos",type:bn.Attribute,descriptor:{name:"a_Pos",buffer:{usage:Fe.DYNAMIC_DRAW,data:[],type:Fe.FLOAT},size:3,update:function(a){var s=Du(a.coordinates);return[s[0],s[1],0]}}})}}]),r}(Lo);function uw(e){var t=lw();return function(){var n=(0,le.Z)(e),i;if(t){var a=(0,le.Z)(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return(0,ze.Z)(this,i)}}function lw(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var E2=`
uniform float u_additive;


varying vec4 v_data;
varying vec4 v_color;
varying float v_radius;
uniform float u_time;
uniform vec4 u_animate: [ 1., 2., 1.0, 0.2 ];

#pragma include "sdf_2d"
#pragma include "picking"

void main() {

  lowp float antialiasblur = v_data.z;
  float r = v_radius / (v_radius);

  float outer_df;
  float inner_df;
  // 'circle', 'triangle', 'square', 'pentagon', 'hexagon', 'octogon', 'hexagram', 'rhombus', 'vesica'
  
  outer_df = sdCircle(v_data.xy, 1.0);
  inner_df = sdCircle(v_data.xy, r);


  float opacity_t = smoothstep(0.0, antialiasblur, outer_df);

  float color_t = smoothstep(
    antialiasblur,
    0.0,
    inner_df
  );
  float PI = 3.14159;
  float N_RINGS = 3.0;
  float FREQ = 1.0;

  gl_FragColor = v_color;

  float d = length(v_data.xy);
  if(d > 0.5) {
    discard;
  }
  float intensity = clamp(cos(d * PI), 0.0, 1.0) * clamp(cos(2.0 * PI * (d * 2.0 * u_animate.z - u_animate.y * u_time)), 0.0, 1.0);
  
  // \u6839\u636E\u53E0\u52A0\u6A21\u5F0F\u9009\u62E9\u6548\u679C
  if(u_additive > 0.0) {
    gl_FragColor *= intensity;
    // \u4F18\u5316\u6C34\u6CE2\u70B9 blend additive \u6A21\u5F0F\u4E0B\u6709\u7684\u62FE\u53D6\u6548\u679C 
    gl_FragColor = filterColorAlpha(gl_FragColor, gl_FragColor.a);
  } else {
    gl_FragColor = vec4(gl_FragColor.xyz, gl_FragColor.a * intensity);
    gl_FragColor = filterColor(gl_FragColor);
  }
}
`,cw=`
layout(std140) uniform commonUniforms {
  vec3 u_blur_height_fixed;
  float u_stroke_width;
  float u_additive;
  float u_stroke_opacity;
  float u_size_unit;
};

in vec4 v_color;
in vec4 v_stroke;
in vec4 v_data;
in float v_radius;

#pragma include "scene_uniforms"
#pragma include "sdf_2d"
#pragma include "picking"

out vec4 outputColor;

void main() {
  int shape = int(floor(v_data.w + 0.5));
  lowp float antialiasblur = v_data.z;
  float r = v_radius / (v_radius + u_stroke_width);

  float outer_df;
  float inner_df;
  // 'circle', 'triangle', 'square', 'pentagon', 'hexagon', 'octogon', 'hexagram', 'rhombus', 'vesica'
  if (shape == 0) {
    outer_df = sdCircle(v_data.xy, 1.0);
    inner_df = sdCircle(v_data.xy, r);
  } else if (shape == 1) {
    outer_df = sdEquilateralTriangle(1.1 * v_data.xy);
    inner_df = sdEquilateralTriangle(1.1 / r * v_data.xy);
  } else if (shape == 2) {
    outer_df = sdBox(v_data.xy, vec2(1.));
    inner_df = sdBox(v_data.xy, vec2(r));
  } else if (shape == 3) {
    outer_df = sdPentagon(v_data.xy, 0.8);
    inner_df = sdPentagon(v_data.xy, r * 0.8);
  } else if (shape == 4) {
    outer_df = sdHexagon(v_data.xy, 0.8);
    inner_df = sdHexagon(v_data.xy, r * 0.8);
  } else if (shape == 5) {
    outer_df = sdOctogon(v_data.xy, 1.0);
    inner_df = sdOctogon(v_data.xy, r);
  } else if (shape == 6) {
    outer_df = sdHexagram(v_data.xy, 0.52);
    inner_df = sdHexagram(v_data.xy, r * 0.52);
  } else if (shape == 7) {
    outer_df = sdRhombus(v_data.xy, vec2(1.0));
    inner_df = sdRhombus(v_data.xy, vec2(r));
  } else if (shape == 8) {
    outer_df = sdVesica(v_data.xy, 1.1, 0.8);
    inner_df = sdVesica(v_data.xy, r * 1.1, r * 0.8);
  }

  float opacity_t = smoothstep(0.0, antialiasblur, outer_df);

  float color_t = u_stroke_width < 0.01 ? 0.0 : smoothstep(
    antialiasblur,
    0.0,
    inner_df
  );

  if(u_stroke_width < 0.01) {
    outputColor = v_color;
  } else {
    outputColor = mix(v_color, v_stroke * u_stroke_opacity, color_t);
  }

  if(u_additive > 0.0) {
    outputColor *= opacity_t;
    outputColor = filterColorAlpha(outputColor, outputColor.a);
  } else {
    outputColor.a *= opacity_t;
    outputColor = filterColor(outputColor);
  }
   // \u4F5C\u4E3A mask \u6A21\u677F\u65F6\u9700\u8981\u4E22\u5F03\u900F\u660E\u7684\u50CF\u7D20
  if(outputColor.a < 0.01) {
    discard;
  } 
}
`,i_=`layout(location = 0) in vec3 a_Position;
layout(location = 1) in vec4 a_Color;
layout(location = 9) in float a_Size;
layout(location = 11) in vec3 a_Extrude;
layout(location = 10) in float a_Shape;

layout(std140) uniform commonUniforms {
  vec3 u_blur_height_fixed;
  float u_stroke_width;
  float u_additive;
  float u_stroke_opacity;
  float u_size_unit;
};

out vec4 v_color;
out vec4 v_stroke;
out vec4 v_data;
out float v_radius;

#pragma include "projection"
#pragma include "picking"
#pragma include "rotation_2d"

void main() {
  // \u900F\u660E\u5EA6\u8BA1\u7B97
   v_stroke = stroke;  
  vec3 extrude = a_Extrude;
  float shape_type = a_Shape;
  /*
  *  setPickingSize \u8BBE\u7F6E\u62FE\u53D6\u5927\u5C0F
  *  u_meter2coord \u5728\u7B49\u9762\u79EF\u5927\u5C0F\u7684\u65F6\u5019\u8BBE\u7F6E\u5355\u4F4D
  */
  float newSize = setPickingSize(a_Size);
  // float newSize = setPickingSize(a_Size) * 0.00001038445708445579;



  // unpack color(vec2)
  v_color = vec4(a_Color.xyz, a_Color.w * opacity);

  if(u_size_unit == 1.0) {
    newSize = newSize  * u_PixelsPerMeter.z;
  }

   v_radius = newSize;

  // anti-alias
  //  float antialiased_blur = -max(u_blur, antialiasblur);
  float antialiasblur = -max(2.0 / u_DevicePixelRatio / newSize, u_blur_height_fixed.x);

  vec2 offset = (extrude.xy * (newSize + u_stroke_width) + u_offsets);
  vec3 aPosition = a_Position;

  offset = project_pixel(offset);
  offset = rotate_matrix(offset,rotation);
  
  // TODP: /abs(extrude.x) \u662F\u4E3A\u4E86\u517C\u5BB9\u5730\u7403\u6A21\u5F0F
  v_data = vec4(extrude.x/abs(extrude.x), extrude.y/abs(extrude.y), antialiasblur,shape_type);


  // vec4 project_pos = project_position(vec4(a_Position.xy, 0.0, 1.0));
  vec4 project_pos = project_position(vec4(aPosition.xy, 0.0, 1.0));
  // gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, project_pixel(setPickingOrder(0.0)), 1.0));

  float raisingHeight = u_blur_height_fixed.y;

  if(u_blur_height_fixed.z < 1.0) { // false
    raisingHeight = project_pixel(u_blur_height_fixed.y);
  } else {
     if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
      float mapboxZoomScale = 4.0/pow(2.0, 21.0 - u_Zoom);
      raisingHeight = u_blur_height_fixed.y * mapboxZoomScale;
    }
  }
  
  gl_Position = project_common_position_to_clipspace_v2(vec4(project_pos.xy + offset, raisingHeight, 1.0));

  setPickingColor(a_PickingColor);
}
`,S2=function(e){(0,ke.Z)(r,e);var t=uw(r);function r(){return(0,ue.Z)(this,r),t.apply(this,arguments)}return(0,_e.Z)(r,[{key:"getUninforms",value:function(){var i=this.layer.getLayerConfig(),a=i.strokeOpacity,s=a===void 0?1:a,l=i.strokeWidth,p=l===void 0?0:l,m=i.blend,T=i.blur,R=T===void 0?0:T,L=i.raisingHeight,z=L===void 0?0:L,re=i.heightfixed,ee=re===void 0?!1:re,me=i.unit,Ie=me===void 0?"pixel":me,He=(0,Q.Z)({u_blur_height_fixed:[R,Number(z),Number(ee)],u_additive:m==="additive"?1:0,u_stroke_opacity:s,u_stroke_width:p,u_size_unit:r_[Ie]},this.getStyleAttribute()),Xe=this.getStyleAttribute();return this.uniformBuffers[0].subData({offset:0,data:new Uint8Array(new Float32Array([].concat((0,cr.Z)(Xe.u_stroke),(0,cr.Z)(Xe.u_offsets),[Xe.u_opacity,Xe.u_rotation])).buffer)}),this.uniformBuffers[1].subData({offset:0,data:new Uint8Array(new Float32Array([].concat((0,cr.Z)(He.u_blur_height_fixed),[He.u_stroke_width,He.u_stroke_opacity,He.u_additive,He.u_size_unit])).buffer)}),He}},{key:"getAnimateUniforms",value:function(){var i=this.layer.getLayerConfig(),a=i.animateOption,s=a===void 0?{enable:!1}:a;return{u_animate:this.animateOption2Array(s),u_time:this.layer.getLayerAnimateTime()}}},{key:"getAttribute",value:function(){return this.styleAttributeService.createAttributesAndIndices(this.layer.getEncodedData(),wa)}},{key:"initModels",value:function(){var n=(0,hr.Z)(it().mark(function a(){return it().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.abrupt("return",this.buildModels());case 1:case"end":return l.stop()}},a,this)}));function i(){return n.apply(this,arguments)}return i}()},{key:"buildModels",value:function(){var n=(0,hr.Z)(it().mark(function a(){var s,l,p,m,T,R,L,z,re,ee;return it().wrap(function(Ie){for(;;)switch(Ie.prev=Ie.next){case 0:return s=this.layer.getLayerConfig(),l=s.animateOption,p=l===void 0?{enable:!1}:l,m=this.getShaders(p),T=m.frag,R=m.vert,L=m.type,this.layer.triangulation=wa,z=this.rendererService.createBuffer({data:new Float32Array(8),isUBO:!0}),re=this.rendererService.createBuffer({data:new Float32Array(8),isUBO:!0}),this.uniformBuffers.push(z,re),Ie.next=8,this.layer.buildLayerModel({moduleName:L,vertexShader:R,fragmentShader:T,inject:this.getInject(),triangulation:wa,depth:{enable:!1}});case 8:return ee=Ie.sent,Ie.abrupt("return",[ee]);case 10:case"end":return Ie.stop()}},a,this)}));function i(){return n.apply(this,arguments)}return i}()},{key:"getShaders",value:function(i){if(i.enable)switch(i.type){case"wave":return{frag:E2,vert:i_,type:"pointWave"};default:return{frag:E2,vert:i_,type:"pointWave"}}else return{frag:cw,vert:i_,type:"pointFill"}}},{key:"animateOption2Array",value:function(i){return[i.enable?0:1,i.speed||1,i.rings||3,0]}},{key:"registerBuiltinAttributes",value:function(){var i=this.layer.getLayerConfig().shape2d;this.styleAttributeService.registerStyleAttribute({name:"extrude",type:bn.Attribute,descriptor:{name:"a_Extrude",shaderLocation:tl.EXTRUDE,buffer:{usage:Fe.DYNAMIC_DRAW,data:[],type:Fe.FLOAT},size:3,update:function(s,l,p,m){var T=[1,1,0,-1,1,0,-1,-1,0,1,-1,0],R=m%4*3;return[T[R],T[R+1],T[R+2]]}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:bn.Attribute,descriptor:{name:"a_Size",shaderLocation:tl.SIZE,buffer:{usage:Fe.DYNAMIC_DRAW,data:[],type:Fe.FLOAT},size:1,update:function(s){var l=s.size,p=l===void 0?5:l;return Array.isArray(p)?[p[0]]:[p]}}}),this.styleAttributeService.registerStyleAttribute({name:"shape",type:bn.Attribute,descriptor:{name:"a_Shape",shaderLocation:tl.SHAPE,buffer:{usage:Fe.DYNAMIC_DRAW,data:[],type:Fe.FLOAT},size:1,update:function(s){var l=s.shape,p=l===void 0?2:l,m=i.indexOf(p);return[m]}}})}}]),r}(Lo);function fw(e){var t=hw();return function(){var n=(0,le.Z)(e),i;if(t){var a=(0,le.Z)(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return(0,ze.Z)(this,i)}}function hw(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var Aw=`uniform sampler2D u_texture;
uniform vec2 u_textSize;
uniform float u_opacity : 1;

#pragma include "sdf_2d"
#pragma include "picking"
varying vec2 v_uv; // \u672C\u8EAB\u7684 uv \u5750\u6807
varying vec2 v_Iconuv;
varying float v_opacity;

void main() {

  vec2 pos = v_Iconuv / u_textSize + v_uv / u_textSize * 64.;
  gl_FragColor = texture2D(u_texture, pos);
  gl_FragColor.a *= v_opacity;

  gl_FragColor = filterColor(gl_FragColor);
}
`,pw=`attribute vec4 a_Color;
attribute vec3 a_Position;
attribute vec3 a_Extrude;
attribute float a_Size;
attribute vec2 a_Uv;

uniform mat4 u_ModelMatrix;

uniform mat2 u_RotateMatrix;
uniform int u_size_unit;

varying vec2 v_uv; // \u672C\u8EAB\u7684 uv \u5750\u6807
varying vec2 v_Iconuv; // icon \u8D34\u56FE\u7684 uv \u5750\u6807

uniform float u_raisingHeight: 0.0;
uniform float u_heightfixed: 0.0;
varying float v_opacity;
// uniform vec2 u_offsets; // shader \u6CE8\u5165


#pragma include "projection"
#pragma include "picking"
#pragma include "rotation_2d"

void main() {
  vec3 extrude = a_Extrude;
  v_uv = (a_Extrude.xy + 1.0)/2.0;
  v_uv.y = 1.0 - v_uv.y;
  v_Iconuv = a_Uv;
  v_opacity = opacity;
  float newSize = a_Size;
  if(u_size_unit == 1) {
    newSize = newSize  * u_PixelsPerMeter.z;
  }
  
  // vec2 offset = (u_RotateMatrix * extrude.xy * (a_Size) + textrueOffsets);
  vec2 offset = (extrude.xy * (newSize) + offsets);

  offset = rotate_matrix(offset,rotation);

  vec3 aPosition = a_Position;

  offset = project_pixel(offset);

  vec4 project_pos = project_position(vec4(aPosition.xy, 0.0, 1.0));
  float raisingHeight = u_raisingHeight;
  if(u_heightfixed < 1.0) { // height fixed
    raisingHeight = project_pixel(u_raisingHeight);
  } else {
    if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
      float mapboxZoomScale = 4.0/pow(2.0, 21.0 - u_Zoom);
      raisingHeight = u_raisingHeight * mapboxZoomScale;
    }
  }

  gl_Position = project_common_position_to_clipspace_v2(vec4(project_pos.xy + offset, 0.0, 1.0));

  setPickingColor(a_PickingColor);
}
`,dw=function(e){(0,ke.Z)(r,e);var t=fw(r);function r(){var n;(0,ue.Z)(this,r);for(var i=arguments.length,a=new Array(i),s=0;s<i;s++)a[s]=arguments[s];return n=t.call.apply(t,[this].concat(a)),(0,ve.Z)((0,St.Z)(n),"meter2coord",1),(0,ve.Z)((0,St.Z)(n),"isMeter",!1),(0,ve.Z)((0,St.Z)(n),"radian",0),(0,ve.Z)((0,St.Z)(n),"updateTexture",function(){var l=n.rendererService.createTexture2D;if(n.texture){n.texture.update({data:n.iconService.getCanvas(),mag:"linear",min:"linear mipmap nearest",mipmap:!0}),n.layerService.throttleRenderLayers();return}n.texture=l({data:n.iconService.getCanvas(),mag:Fe.LINEAR,min:Fe.LINEAR_MIPMAP_LINEAR,premultiplyAlpha:!1,width:1024,height:n.iconService.canvasHeight||128,mipmap:!0})}),n}return(0,_e.Z)(r,[{key:"getUninforms",value:function(){var i=this.layer.getLayerConfig(),a=i.raisingHeight,s=a===void 0?0:a,l=i.heightfixed,p=l===void 0?!1:l,m=i.unit,T=m===void 0?"pixel":m;return this.rendererService.getDirty()&&this.texture.bind(),(0,Q.Z)({u_raisingHeight:Number(s),u_heightfixed:Number(p),u_size_unit:r_[T],u_texture:this.texture,u_textSize:[1024,this.iconService.canvasHeight||128]},this.getStyleAttribute())}},{key:"getAttribute",value:function(){return this.styleAttributeService.createAttributesAndIndices(this.layer.getEncodedData(),tg)}},{key:"initModels",value:function(){var n=(0,hr.Z)(it().mark(function a(){return it().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return this.iconService.on("imageUpdate",this.updateTexture),this.updateTexture(),l.abrupt("return",this.buildModels());case 3:case"end":return l.stop()}},a,this)}));function i(){return n.apply(this,arguments)}return i}()},{key:"buildModels",value:function(){var n=(0,hr.Z)(it().mark(function a(){var s;return it().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return p.next=2,this.layer.buildLayerModel({moduleName:"pointFillImage",vertexShader:pw,fragmentShader:Aw,triangulation:tg,depth:{enable:!1},inject:this.getInject(),cull:{enable:!0,face:Ru(this.mapService.version)}});case 2:return s=p.sent,p.abrupt("return",[s]);case 4:case"end":return p.stop()}},a,this)}));function i(){return n.apply(this,arguments)}return i}()},{key:"clearModels",value:function(){var i;this.iconService.off("imageUpdate",this.updateTexture),(i=this.texture)===null||i===void 0||i.destroy()}},{key:"registerBuiltinAttributes",value:function(){var i=this;this.styleAttributeService.registerStyleAttribute({name:"uv",type:bn.Attribute,descriptor:{name:"a_Uv",buffer:{usage:Fe.DYNAMIC_DRAW,data:[],type:Fe.FLOAT},size:2,update:function(s){var l=i.iconService.getIconMap(),p=s.shape,m=l[p]||{x:-64,y:-64},T=m.x,R=m.y;return[T,R]}}}),this.styleAttributeService.registerStyleAttribute({name:"extrude",type:bn.Attribute,descriptor:{name:"a_Extrude",buffer:{usage:Fe.DYNAMIC_DRAW,data:[],type:Fe.FLOAT},size:3,update:function(s,l,p,m){var T=[1,1,0,-1,1,0,-1,-1,0,1,-1,0],R=m%4*3;return[T[R],T[R+1],T[R+2]]}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:bn.Attribute,descriptor:{name:"a_Size",buffer:{usage:Fe.DYNAMIC_DRAW,data:[],type:Fe.FLOAT},size:1,update:function(s){var l=s.size,p=l===void 0?5:l;return Array.isArray(p)?[p[0]]:[p]}}})}}]),r}(Lo);function vw(e){var t=gw();return function(){var n=(0,le.Z)(e),i;if(t){var a=(0,le.Z)(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return(0,ze.Z)(this,i)}}function gw(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var mw=`
uniform sampler2D u_texture;
varying vec4 v_color;
varying vec2 v_uv;
varying float v_opacity;
uniform vec2 u_textSize;

#pragma include "picking"

void main(){
      vec2 pos = v_uv / u_textSize + gl_PointCoord / u_textSize * 64.;
      vec4 textureColor;

      // Y = 0.299R + 0.587G + 0.114B // \u4EAE\u5EA6\u63D0\u53D6
     
      textureColor = texture2D(u_texture, pos);

      // Tip: \u53BB\u9664\u8FB9\u7F18\u90E8\u5206 mipmap \u5BFC\u81F4\u7684\u6DF7\u5408\u53D8\u6697
      float fragmengTocenter = distance(vec2(0.5), gl_PointCoord);
      if(fragmengTocenter >= 0.5) {
            float luma = 0.299 * textureColor.r + 0.587 * textureColor.g + 0.114 * textureColor.b;
            textureColor.a *= luma;
      }
      
      

      if(all(lessThan(v_color, vec4(1.0+0.00001))) && all(greaterThan(v_color, vec4(1.0-0.00001))) || v_color==vec4(1.0)){
            gl_FragColor= textureColor;
      }else {
            gl_FragColor= step(0.01, textureColor.z) * v_color;
      }
      gl_FragColor.a *= v_opacity;
      if (gl_FragColor.a < 0.01) {
         discard;
      }
      gl_FragColor = filterColor(gl_FragColor);
}
`,_w=`precision highp float;
attribute vec3 a_Position;
attribute vec4 a_Color;
attribute vec2 a_Uv;
attribute float a_Size;
varying vec4 v_color;
varying vec2 v_uv;
varying float v_opacity;
uniform mat4 u_ModelMatrix;


uniform float u_raisingHeight: 0.0;
uniform float u_heightfixed: 0.0;

#pragma include "projection"
#pragma include "picking"

void main() {

  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
  v_color = a_Color;
  v_opacity = opacity;
  v_uv = a_Uv;
  vec4 project_pos = project_position(vec4(a_Position, 1.0));
   
  vec2 offset = project_pixel(offsets);

  float raisingHeight = u_raisingHeight;
  if(u_heightfixed < 1.0) { // false
    raisingHeight = project_pixel(u_raisingHeight);
  } else {
     if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
      float mapboxZoomScale = 4.0/pow(2.0, 21.0 - u_Zoom);
      raisingHeight = u_raisingHeight * mapboxZoomScale;
    }
  }


  gl_Position = project_common_position_to_clipspace_v2(vec4(project_pos.xy + offset, raisingHeight, 1.0));

  gl_PointSize = a_Size * 2.0 * u_DevicePixelRatio;
  setPickingColor(a_PickingColor);
}
`,x2=function(e){(0,ke.Z)(r,e);var t=vw(r);function r(){var n;(0,ue.Z)(this,r);for(var i=arguments.length,a=new Array(i),s=0;s<i;s++)a[s]=arguments[s];return n=t.call.apply(t,[this].concat(a)),(0,ve.Z)((0,St.Z)(n),"updateTexture",function(){var l=n.rendererService.createTexture2D;if(n.texture){n.texture.update({data:n.iconService.getCanvas(),mag:"linear",min:"linear mipmap nearest",mipmap:!0}),setTimeout(function(){n.layerService.throttleRenderLayers()});return}n.texture=l({data:n.iconService.getCanvas(),mag:Fe.LINEAR,min:Fe.LINEAR_MIPMAP_LINEAR,premultiplyAlpha:!1,width:1024,height:n.iconService.canvasHeight||128,mipmap:!0})}),n}return(0,_e.Z)(r,[{key:"getUninforms",value:function(){var i=this.layer.getLayerConfig(),a=i.opacity,s=a===void 0?1:a,l=i.offsets,p=l===void 0?[0,0]:l,m=i.raisingHeight,T=m===void 0?0:m,R=i.heightfixed,L=R===void 0?!1:R;return this.rendererService.getDirty()&&this.texture.bind(),(0,Q.Z)({u_raisingHeight:Number(T),u_heightfixed:Number(L),u_texture:this.texture,u_textSize:[1024,this.iconService.canvasHeight||128]},this.getStyleAttribute())}},{key:"initModels",value:function(){var n=(0,hr.Z)(it().mark(function a(){return it().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return this.iconService.on("imageUpdate",this.updateTexture),this.updateTexture(),l.abrupt("return",this.buildModels());case 3:case"end":return l.stop()}},a,this)}));function i(){return n.apply(this,arguments)}return i}()},{key:"clearModels",value:function(){var i;(i=this.texture)===null||i===void 0||i.destroy(),this.iconService.off("imageUpdate",this.updateTexture)}},{key:"buildModels",value:function(){var n=(0,hr.Z)(it().mark(function a(){var s;return it().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return p.next=2,this.layer.buildLayerModel({moduleName:"pointImage",vertexShader:_w,fragmentShader:mw,triangulation:AR,inject:this.getInject(),depth:{enable:!1},primitive:Fe.POINTS});case 2:return s=p.sent,p.abrupt("return",[s]);case 4:case"end":return p.stop()}},a,this)}));function i(){return n.apply(this,arguments)}return i}()},{key:"registerBuiltinAttributes",value:function(){var i=this;this.styleAttributeService.registerStyleAttribute({name:"size",type:bn.Attribute,descriptor:{name:"a_Size",buffer:{usage:Fe.DYNAMIC_DRAW,data:[],type:Fe.FLOAT},size:1,update:function(s){var l=s.size,p=l===void 0?5:l;return Array.isArray(p)?[p[0]]:[p]}}}),this.styleAttributeService.registerStyleAttribute({name:"uv",type:bn.Attribute,descriptor:{name:"a_Uv",buffer:{usage:Fe.DYNAMIC_DRAW,data:[],type:Fe.FLOAT},size:2,update:function(s){var l=i.iconService.getIconMap(),p=s.shape,m=l[p]||{x:-64,y:-64},T=m.x,R=m.y;return[T,R]}}})}}]),r}(Lo);function yw(e){var t=Ew();return function(){var n=(0,le.Z)(e),i;if(t){var a=(0,le.Z)(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return(0,ze.Z)(this,i)}}function Ew(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var Sw=`in vec4 v_color;
out vec4 outputColor;
void main() {
  outputColor = v_color;
}`,xw=`layout(location = 0) in vec3 a_Position;
layout(location = 1) in vec4 a_Color;
layout(location = 9) in float a_Size;

layout(std140) uniform u_Common {
  float u_size_scale;
};

out vec4 v_color;

#pragma include "projection"
#pragma include "project"

void main() {
  v_color = vec4(a_Color.xyz, a_Color.w * opacity);

  if (u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    gl_Position = u_Mvp * vec4(a_Position, 1.0);
  } else {
    vec4 project_pos = project_position(vec4(a_Position, 1.0)) + vec4(a_Size / 2., -a_Size /2., 0., 0.);
    gl_Position = project_common_position_to_clipspace(project_pos);
  }

  gl_PointSize = a_Size * u_size_scale *  2.0  * u_DevicePixelRatio;
}
`;function T2(e){var t=e.coordinates;return{vertices:(0,cr.Z)(t),indices:[0],size:t.length}}var C2=function(e){(0,ke.Z)(r,e);var t=yw(r);function r(){return(0,ue.Z)(this,r),t.apply(this,arguments)}return(0,_e.Z)(r,[{key:"getDefaultStyle",value:function(){return{blend:"additive"}}},{key:"getUninforms",value:function(){var i=this.getStyleAttribute();return this.uniformBuffers[0].subData({offset:0,data:new Uint8Array(new Float32Array([].concat((0,cr.Z)(i.u_stroke),(0,cr.Z)(i.u_offsets),[i.u_opacity,i.u_rotation])).buffer)}),this.uniformBuffers[1].subData({offset:0,data:new Uint8Array(new Float32Array([.5]).buffer)}),(0,Q.Z)({u_size_scale:.5},i)}},{key:"initModels",value:function(){var n=(0,hr.Z)(it().mark(function a(){return it().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.abrupt("return",this.buildModels());case 1:case"end":return l.stop()}},a,this)}));function i(){return n.apply(this,arguments)}return i}()},{key:"buildModels",value:function(){var n=(0,hr.Z)(it().mark(function a(){var s,l,p;return it().wrap(function(T){for(;;)switch(T.prev=T.next){case 0:return this.layer.triangulation=T2,s=this.rendererService.createBuffer({data:new Float32Array(8),isUBO:!0}),l=this.rendererService.createBuffer({data:new Float32Array(4),isUBO:!0}),this.uniformBuffers.push(s,l),T.next=6,this.layer.buildLayerModel({moduleName:"pointNormal",vertexShader:xw,fragmentShader:Sw,triangulation:T2,inject:this.getInject(),depth:{enable:!1},primitive:Fe.POINTS,pick:!1});case 6:return p=T.sent,T.abrupt("return",[p]);case 8:case"end":return T.stop()}},a,this)}));function i(){return n.apply(this,arguments)}return i}()},{key:"clearModels",value:function(){}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"size",type:bn.Attribute,descriptor:{name:"a_Size",shaderLocation:tl.SIZE,buffer:{usage:Fe.DYNAMIC_DRAW,data:[],type:Fe.FLOAT},size:1,update:function(a){var s=a.size,l=s===void 0?1:s;return Array.isArray(l)?[l[0]]:[l]}}})}}]),r}(Lo);function Tw(e){var t=Cw();return function(){var n=(0,le.Z)(e),i;if(t){var a=(0,le.Z)(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return(0,ze.Z)(this,i)}}function Cw(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var bw=`
uniform float u_additive;
uniform float u_opacity: 1.0;

varying vec4 v_data;
varying vec4 v_color;
varying float v_radius;
varying vec2 v_exteude;
#pragma include "sdf_2d"
#pragma include "picking"

void main() {

  lowp float antialiasblur = v_data.z;
  float r = v_radius / (v_radius);

  float outer_df = sdCircle(v_data.xy, 1.0);
  float inner_df = sdCircle(v_data.xy, r);

  float opacity_t = smoothstep(0.0, antialiasblur, outer_df);

  gl_FragColor = vec4(v_color.rgb, v_color.a * u_opacity);

  if(u_additive > 0.0) {
    gl_FragColor *= opacity_t;
  } else {
    gl_FragColor.a *= opacity_t;
  }

  if(gl_FragColor.a > 0.0) {
    gl_FragColor = filterColor(gl_FragColor);
  }

  vec2 extrude =  v_exteude;
  vec2 dir = normalize(extrude);
  vec2 baseDir = vec2(1.0, 0.0);
  float pi = 3.14159265359;
  float flag = sign(dir.y);
  float rades = dot(dir, baseDir);
  float radar_v = (flag - 1.0) * -0.5 * acos(rades)/pi;
  // simple AA
  if(radar_v > 0.99) {
    radar_v = 1.0 - (radar_v - 0.99)/0.01;
  }

  gl_FragColor.a *= radar_v;
}
`,Rw=`attribute vec4 a_Color;
attribute vec3 a_Position;
attribute vec3 a_Extrude;
attribute float a_Size;
uniform float u_speed: 1.0;
uniform float u_time;

uniform mat4 u_ModelMatrix;

uniform int u_size_unit;

varying vec4 v_data;
varying vec4 v_color;
varying float v_radius;
varying vec2 v_exteude;

#pragma include "projection"
#pragma include "picking"

void main() {
  vec3 extrude = a_Extrude;
  float newSize = setPickingSize(a_Size);

  float time = u_time * u_speed;
  mat2 rotateMatrix = mat2( 
    cos(time), sin(time), 
    -sin(time), cos(time)
  );
  v_exteude = rotateMatrix * a_Extrude.xy;

  // unpack color(vec2)
  v_color = a_Color;

  // anti-alias
  float blur = 0.0;
  float antialiasblur = -max(2.0 / u_DevicePixelRatio / a_Size, blur);

  if(u_size_unit == 1) {
    newSize = newSize  * u_PixelsPerMeter.z;
  }
  // radius(16-bit)
  v_radius = newSize;

  vec2 offset = (extrude.xy * (newSize));
  vec3 aPosition = a_Position;
  
    // \u4E0D\u4EE5\u7C73\u4E3A\u5B9E\u9645\u5355\u4F4D
  offset = project_pixel(offset);
  
  v_data = vec4(extrude.x, extrude.y, antialiasblur, -1.0);

  vec4 project_pos = project_position(vec4(aPosition.xy, 0.0, 1.0));
  gl_Position = project_common_position_to_clipspace_v2(vec4(project_pos.xy + offset, project_pixel(setPickingOrder(0.0)), 1.0));

  setPickingColor(a_PickingColor);
}
`,Mw=function(e){(0,ke.Z)(r,e);var t=Tw(r);function r(){return(0,ue.Z)(this,r),t.apply(this,arguments)}return(0,_e.Z)(r,[{key:"getUninforms",value:function(){var i=this.layer.getLayerConfig(),a=i.opacity,s=a===void 0?1:a,l=i.blend,p=i.speed,m=p===void 0?1:p,T=i.unit,R=T===void 0?"pixel":T;return{u_size_unit:r_[R],u_speed:m,u_additive:l==="additive"?1:0,u_opacity:s}}},{key:"getAnimateUniforms",value:function(){var i=this.layer.getLayerConfig(),a=i.animateOption,s=a===void 0?{enable:!1}:a;return{u_animate:this.animateOption2Array(s),u_time:this.layer.getLayerAnimateTime()}}},{key:"getAttribute",value:function(){return this.styleAttributeService.createAttributesAndIndices(this.layer.getEncodedData(),tg)}},{key:"initModels",value:function(){var n=(0,hr.Z)(it().mark(function a(){return it().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.abrupt("return",this.buildModels());case 1:case"end":return l.stop()}},a,this)}));function i(){return n.apply(this,arguments)}return i}()},{key:"buildModels",value:function(){var n=(0,hr.Z)(it().mark(function a(){var s;return it().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return p.next=2,this.layer.buildLayerModel({moduleName:"pointRadar",vertexShader:Rw,fragmentShader:bw,triangulation:tg,depth:{enable:!1}});case 2:return s=p.sent,p.abrupt("return",[s]);case 4:case"end":return p.stop()}},a,this)}));function i(){return n.apply(this,arguments)}return i}()},{key:"animateOption2Array",value:function(i){return[i.enable?0:1,i.speed||1,i.rings||3,0]}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"extrude",type:bn.Attribute,descriptor:{name:"a_Extrude",buffer:{usage:Fe.DYNAMIC_DRAW,data:[],type:Fe.FLOAT},size:3,update:function(a,s,l,p){var m=[1,1,0,-1,1,0,-1,-1,0,1,-1,0],T=p%4*3;return[m[T],m[T+1],m[T+2]]}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:bn.Attribute,descriptor:{name:"a_Size",buffer:{usage:Fe.DYNAMIC_DRAW,data:[],type:Fe.FLOAT},size:1,update:function(a){var s=a.size,l=s===void 0?5:s;return Array.isArray(l)?[l[0]]:[l]}}})}}]),r}(Lo);function ww(e,t){var r=typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=Iw(e))||t&&e&&typeof e.length=="number"){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(m){throw m},f:i}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var a=!0,s=!1,l;return{s:function(){r=r.call(e)},n:function(){var m=r.next();return a=m.done,m},e:function(m){s=!0,l=m},f:function(){try{!a&&r.return!=null&&r.return()}finally{if(s)throw l}}}}function Iw(e,t){if(e){if(typeof e=="string")return b2(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return b2(e,t)}}function b2(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var Pw=function(){function e(t,r,n){(0,ue.Z)(this,e),(0,ve.Z)(this,"boxCells",[]);var i=this.boxCells;this.xCellCount=Math.ceil(t/n),this.yCellCount=Math.ceil(r/n);for(var a=0;a<this.xCellCount*this.yCellCount;a++)i.push([]);this.boxKeys=[],this.bboxes=[],this.width=t,this.height=r,this.xScale=this.xCellCount/t,this.yScale=this.yCellCount/r,this.boxUid=0}return(0,_e.Z)(e,[{key:"insert",value:function(r,n,i,a,s){this.forEachCell(n,i,a,s,this.insertBoxCell,this.boxUid++),this.boxKeys.push(r),this.bboxes.push(n),this.bboxes.push(i),this.bboxes.push(a),this.bboxes.push(s)}},{key:"query",value:function(r,n,i,a,s){return this.queryHitTest(r,n,i,a,!1,s)}},{key:"hitTest",value:function(r,n,i,a,s){return this.queryHitTest(r,n,i,a,!0,s)}},{key:"insertBoxCell",value:function(r,n,i,a,s,l){this.boxCells[s].push(l)}},{key:"queryHitTest",value:function(r,n,i,a,s,l){if(i<0||r>this.width||a<0||n>this.height)return s?!1:[];var p=[];if(r<=0&&n<=0&&this.width<=i&&this.height<=a){if(s)return!0;for(var m=0;m<this.boxKeys.length;m++)p.push({key:this.boxKeys[m],x1:this.bboxes[m*4],y1:this.bboxes[m*4+1],x2:this.bboxes[m*4+2],y2:this.bboxes[m*4+3]});return l?p.filter(l):p}var T={hitTest:s,seenUids:{box:{},circle:{}}};return this.forEachCell(r,n,i,a,this.queryCell,p,T,l),s?p.length>0:p}},{key:"queryCell",value:function(r,n,i,a,s,l,p,m){var T=p.seenUids,R=this.boxCells[s];if(R!==null){var L=this.bboxes,z=ww(R),re;try{for(z.s();!(re=z.n()).done;){var ee=re.value;if(!T.box[ee]){T.box[ee]=!0;var me=ee*4;if(r<=L[me+2]&&n<=L[me+3]&&i>=L[me+0]&&a>=L[me+1]&&(!m||m(this.boxKeys[ee]))){if(p.hitTest)return l.push(!0),!0;l.push({key:this.boxKeys[ee],x1:L[me],y1:L[me+1],x2:L[me+2],y2:L[me+3]})}}}}catch(Ie){z.e(Ie)}finally{z.f()}}return!1}},{key:"forEachCell",value:function(r,n,i,a,s,l,p,m){for(var T=this.convertToXCellCoord(r),R=this.convertToYCellCoord(n),L=this.convertToXCellCoord(i),z=this.convertToYCellCoord(a),re=T;re<=L;re++)for(var ee=R;ee<=z;ee++){var me=this.xCellCount*ee+re;if(s.call(this,r,n,i,a,me,l,p,m))return}}},{key:"convertToXCellCoord",value:function(r){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(r*this.xScale)))}},{key:"convertToYCellCoord",value:function(r){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(r*this.yScale)))}}]),e}(),Ow=Pw,Nw=function(){function e(t,r){(0,ue.Z)(this,e),(0,ve.Z)(this,"viewportPadding",100),this.width=t,this.height=r,this.viewportPadding=Math.max(t,r),this.grid=new Ow(t+this.viewportPadding,r+this.viewportPadding,25),this.screenRightBoundary=t+this.viewportPadding,this.screenBottomBoundary=r+this.viewportPadding,this.gridRightBoundary=t+2*this.viewportPadding,this.gridBottomBoundary=r+2*this.viewportPadding}return(0,_e.Z)(e,[{key:"placeCollisionBox",value:function(r){var n=r.x1+r.anchorPointX+this.viewportPadding,i=r.y1+r.anchorPointY+this.viewportPadding,a=r.x2+r.anchorPointX+this.viewportPadding,s=r.y2+r.anchorPointY+this.viewportPadding;return!this.isInsideGrid(n,i,a,s)||this.grid.hitTest(n,i,a,s)?{box:[]}:{box:[n,i,a,s]}}},{key:"insertCollisionBox",value:function(r,n){var i={featureIndex:n};this.grid.insert(i,r[0],r[1],r[2],r[3])}},{key:"project",value:function(r,n,i){var a=Qp(n,i,0,1),s=$p(),l=lo.apply(I,(0,cr.Z)(r));return cv(s,a,l),{x:(s[0]/s[3]+1)/2*this.width+this.viewportPadding,y:(-s[1]/s[3]+1)/2*this.height+this.viewportPadding}}},{key:"isInsideGrid",value:function(r,n,i,a){return i>=0&&r<this.gridRightBoundary&&a>=0&&n<this.gridBottomBoundary}}]),e}();function R2(e,t){var r=typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=Dw(e))||t&&e&&typeof e.length=="number"){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(m){throw m},f:i}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var a=!0,s=!1,l;return{s:function(){r=r.call(e)},n:function(){var m=r.next();return a=m.done,m},e:function(m){s=!0,l=m},f:function(){try{!a&&r.return!=null&&r.return()}finally{if(s)throw l}}}}function Dw(e,t){if(e){if(typeof e=="string")return M2(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return M2(e,t)}}function M2(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function w2(e){var t=.5,r=.5;switch(e){case"right":case"top-right":case"bottom-right":t=1;break;case"left":case"top-left":case"bottom-left":t=0;break;default:t=.5}switch(e){case"bottom":case"bottom-right":case"bottom-left":r=1;break;case"top":case"top-right":case"top-left":r=0;break;default:r=.5}return{horizontalAlign:t,verticalAlign:r}}function I2(e,t,r,n,i){if(i){var a=e[n],s=a.glyph;if(s)for(var l=t[s].advance*a.scale,p=(e[n].x+l)*i,m=r;m<=n;m++)e[m].x-=p}}function P2(e,t,r,n,i,a,s){var l=(t-r)*i,p=(-n*s+.5)*a,m=R2(e),T;try{for(m.s();!(T=m.n()).done;){var R=T.value;R.x+=l,R.y+=p}}catch(L){m.e(L)}finally{m.f()}}function Lw(e,t,r,n,i,a,s){var l=-8,p=0,m=l,T=0,R=e.positionedGlyphs,L=a==="right"?1:a==="left"?0:.5,z=R.length;r.forEach(function(He){if(He.split("").forEach(function(ot){var pt=t[ot],dt=0;pt&&(R.push({glyph:ot,x:p,y:m+dt,vertical:!1,scale:1,metrics:pt}),p+=pt.advance+s)}),R.length!==z){var Xe=p-s;T=Math.max(Xe,T),I2(R,t,z,R.length-1,L)}p=0,m-=n+5});var re=w2(i),ee=re.horizontalAlign,me=re.verticalAlign;P2(R,L,ee,me,T,n,r.length);var Ie=m-l;e.top+=-me*Ie,e.bottom=e.top-Ie,e.left+=-ee*T,e.right=e.left+T}function Fw(e,t,r,n,i,a,s){var l=-8,p=0,m=l,T=0,R=e.positionedGlyphs,L=a==="right"?1:a==="left"?0:.5,z=R.length;r.forEach(function(He){var Xe=t[He],ot=0;if(Xe&&(R.push({glyph:He,x:Xe.advance/2,y:m+ot,vertical:!1,scale:1,metrics:Xe}),p+=Xe.advance+s),R.length!==z){var pt=p-s;T=Math.max(pt,T),I2(R,t,z,R.length-1,L)}p=0,m-=n+5});var re=w2(i),ee=re.horizontalAlign,me=re.verticalAlign;P2(R,L,ee,me,T,n,r.length);var Ie=m-l;e.top+=-me*Ie,e.bottom=e.top-Ie,e.left+=-ee*T,e.right=e.left+T}function Bw(e,t,r,n,i,a){var s=arguments.length>6&&arguments[6]!==void 0?arguments[6]:[0,0],l=arguments.length>7?arguments[7]:void 0,p=e.split(`
`),m=[],T={positionedGlyphs:m,top:s[1],bottom:s[1],left:s[0],right:s[0],lineCount:p.length,text:e};return l?Fw(T,t,p,r,n,i,a):Lw(T,t,p,r,n,i,a),m.length?T:!1}function kw(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[0,0],r=arguments.length>2?arguments[2]:void 0,n=e.positionedGlyphs,i=n===void 0?[]:n,a=[],s=R2(i),l;try{for(s.s();!(l=s.n()).done;){var p=l.value,m=p.metrics,T=4,R=m.advance*p.scale/2,L=r?[p.x+R,p.y]:[0,0],z=r?[0,0]:[p.x+R+t[0],p.y+t[1]],re=(0-T)*p.scale-R+z[0],ee=(0-T)*p.scale+z[1],me=re+m.width*p.scale,Ie=ee+m.height*p.scale,He={x:re,y:ee},Xe={x:me,y:ee},ot={x:re,y:Ie},pt={x:me,y:Ie};a.push({tl:He,tr:Xe,bl:ot,br:pt,tex:m,glyphOffset:L})}}catch(dt){s.e(dt)}finally{s.f()}return a}function Uw(e,t){var r=typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=Zw(e))||t&&e&&typeof e.length=="number"){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(m){throw m},f:i}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var a=!0,s=!1,l;return{s:function(){r=r.call(e)},n:function(){var m=r.next();return a=m.done,m},e:function(m){s=!0,l=m},f:function(){try{!a&&r.return!=null&&r.return()}finally{if(s)throw l}}}}function Zw(e,t){if(e){if(typeof e=="string")return O2(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return O2(e,t)}}function O2(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function zw(e){var t=Gw();return function(){var n=(0,le.Z)(e),i;if(t){var a=(0,le.Z)(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return(0,ze.Z)(this,i)}}function Gw(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var N2=`#define SDF_PX 8.0
#define EDGE_GAMMA 0.105
#define FONT_SIZE 48.0
uniform sampler2D u_sdf_map;
uniform float u_gamma_scale : 0.5;
uniform float u_stroke_width : 2.0;
uniform float u_halo_blur : 0.5;
uniform float u_DevicePixelRatio;

varying vec4 v_color;
varying vec4 v_stroke_color;
varying vec2 v_uv;
varying float v_gamma_scale;
varying float v_fontScale;


#pragma include "picking"
void main() {
  // get style data mapping

  // get sdf from atlas
  float dist = texture2D(u_sdf_map, v_uv).a;

  lowp float buff = (6.0 - u_stroke_width / v_fontScale) / SDF_PX;
  highp float gamma = (u_halo_blur * 1.19 / SDF_PX + EDGE_GAMMA) / (v_fontScale * u_gamma_scale) / 1.0;

  highp float gamma_scaled = gamma * v_gamma_scale;

  highp float alpha = smoothstep(buff - gamma_scaled, buff + gamma_scaled, dist);

  gl_FragColor = mix(v_color, v_stroke_color, smoothstep(0., 0.5, 1.- dist));

  gl_FragColor.a *= alpha;
   // \u4F5C\u4E3A mask \u6A21\u677F\u65F6\u9700\u8981\u4E22\u5F03\u900F\u660E\u7684\u50CF\u7D20
  if (gl_FragColor.a < 0.01) {
    discard;
  }
  gl_FragColor = filterColor(gl_FragColor);
}
`,D2=`#define SDF_PX 8.0
#define EDGE_GAMMA 0.105
#define FONT_SIZE 24.0
attribute vec3 a_Position;
attribute vec2 a_tex;
attribute vec2 a_textOffsets;
attribute vec4 a_Color;
attribute float a_Size;

uniform vec2 u_sdf_map_size;
uniform mat4 u_ModelMatrix;

uniform float u_raisingHeight: 0.0;

varying vec2 v_uv;
varying float v_gamma_scale;
varying vec4 v_color;
varying vec4 v_stroke_color;
varying float v_fontScale;
uniform float u_stroke_width : 2;
uniform vec4 u_stroke_color : [0.0, 0.0, 0.0, 0.0];



#pragma include "projection"
#pragma include "picking"
#pragma include "rotation_2d"

void main() {
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
  
  v_uv = a_tex / u_sdf_map_size;



  v_color = vec4(a_Color.xyz, a_Color.w * opacity);
  v_stroke_color = vec4(u_stroke_color.xyz, u_stroke_color.w * opacity);

  // \u6587\u672C\u7F29\u653E\u6BD4\u4F8B
  float fontScale = a_Size / FONT_SIZE;
  v_fontScale = fontScale;

  vec4 project_pos = project_position(vec4(a_Position, 1.0));
  // vec4 projected_position  = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));

  vec2 offset = rotate_matrix(a_textOffsets,rotation);
  
  // gl_Position = vec4(projected_position.xy / projected_position.w + rotation_matrix * a_textOffsets * fontScale / u_ViewportSize * 2.0 * u_DevicePixelRatio, 0.0, 1.0);

  float raiseHeight = u_raisingHeight;
  if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
    float mapboxZoomScale = 4.0/pow(2.0, 21.0 - u_Zoom);
    raiseHeight = u_raisingHeight * mapboxZoomScale;
  }

  vec4 projected_position = project_common_position_to_clipspace_v2(vec4(project_pos.xyz + vec3(0.0, 0.0, raiseHeight), 1.0));

  gl_Position = vec4(
    projected_position.xy / projected_position.w + offset * fontScale / u_ViewportSize * 2.0 * u_DevicePixelRatio, 0.0, 1.0);
  v_gamma_scale = gl_Position.w;
  setPickingColor(a_PickingColor);

}
`,_d=Fn.isEqual;function L2(e){var t=this,r=e.id,n=[],i=[];if(!t.glyphInfoMap||!t.glyphInfoMap[r])return{vertices:[],indices:[],size:7};var a=t.glyphInfoMap[r].centroid,s=a.length===2?[a[0],a[1],0]:a;return t.glyphInfoMap[r].glyphQuads.forEach(function(l,p){n.push.apply(n,(0,cr.Z)(s).concat([l.tex.x,l.tex.y+l.tex.height,l.tl.x,l.tl.y],(0,cr.Z)(s),[l.tex.x+l.tex.width,l.tex.y+l.tex.height,l.tr.x,l.tr.y],(0,cr.Z)(s),[l.tex.x+l.tex.width,l.tex.y,l.br.x,l.br.y],(0,cr.Z)(s),[l.tex.x,l.tex.y,l.bl.x,l.bl.y])),i.push(0+p*4,1+p*4,2+p*4,2+p*4,3+p*4,0+p*4)}),{vertices:n,indices:i,size:7}}var F2=function(e){(0,ke.Z)(r,e);var t=zw(r);function r(){var n;(0,ue.Z)(this,r);for(var i=arguments.length,a=new Array(i),s=0;s<i;s++)a[s]=arguments[s];return n=t.call.apply(t,[this].concat(a)),(0,ve.Z)((0,St.Z)(n),"glyphInfoMap",{}),(0,ve.Z)((0,St.Z)(n),"currentZoom",-1),(0,ve.Z)((0,St.Z)(n),"textureHeight",0),(0,ve.Z)((0,St.Z)(n),"textCount",0),(0,ve.Z)((0,St.Z)(n),"preTextStyle",{}),(0,ve.Z)((0,St.Z)(n),"mapping",(0,hr.Z)(it().mark(function l(){return it().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return n.initGlyph(),n.updateTexture(),m.next=4,n.reBuildModel();case 4:case"end":return m.stop()}},l)}))),n}return(0,_e.Z)(r,[{key:"getUninforms",value:function(){var i=this.layer.getLayerConfig(),a=i.stroke,s=a===void 0?"#fff":a,l=i.strokeWidth,p=l===void 0?0:l,m=i.halo,T=m===void 0?.5:m,R=i.gamma,L=R===void 0?2:R,z=i.raisingHeight,re=z===void 0?0:z,ee=this.getFontServiceMapping(),me=this.getFontServiceCanvas();return ee&&Object.keys(ee).length!==this.textCount&&me&&(this.updateTexture(),this.textCount=Object.keys(ee).length),this.preTextStyle=this.getTextStyle(),(0,Q.Z)({u_raisingHeight:Number(re),u_stroke_width:p,u_stroke_color:Qi(s),u_sdf_map:this.texture,u_halo_blur:T,u_gamma_scale:L,u_sdf_map_size:[(me==null?void 0:me.width)||1,(me==null?void 0:me.height)||1]},this.getStyleAttribute())}},{key:"initModels",value:function(){var n=(0,hr.Z)(it().mark(function a(){return it().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return this.bindEvent(),this.extent=this.textExtent(),this.rawEncodeData=this.layer.getEncodedData(),this.preTextStyle=this.getTextStyle(),l.abrupt("return",this.buildModels());case 5:case"end":return l.stop()}},a,this)}));function i(){return n.apply(this,arguments)}return i}()},{key:"buildModels",value:function(){var n=(0,hr.Z)(it().mark(function a(){var s,l,p,m;return it().wrap(function(R){for(;;)switch(R.prev=R.next){case 0:return s=this.layer.getLayerConfig(),l=s.textAllowOverlap,p=l===void 0?!1:l,this.initGlyph(),this.updateTexture(),p||this.filterGlyphs(),R.next=6,this.layer.buildLayerModel({moduleName:"pointText",vertexShader:D2,fragmentShader:N2,inject:this.getInject(),triangulation:L2.bind(this),depth:{enable:!1}});case 6:return m=R.sent,R.abrupt("return",[m]);case 8:case"end":return R.stop()}},a,this)}));function i(){return n.apply(this,arguments)}return i}()},{key:"needUpdate",value:function(){var n=(0,hr.Z)(it().mark(function a(){var s,l,p,m,T,R,L,z,re,ee,me,Ie;return it().wrap(function(Xe){for(;;)switch(Xe.prev=Xe.next){case 0:if(s=this.getTextStyle(),l=s.textAllowOverlap,p=l===void 0?!1:l,m=s.textAnchor,T=m===void 0?"center":m,R=s.textOffset,L=s.padding,z=s.fontFamily,re=s.fontWeight,!(!_d(L,this.preTextStyle.padding)||!_d(R,this.preTextStyle.textOffset)||!_d(T,this.preTextStyle.textAnchor)||!_d(z,this.preTextStyle.fontFamily)||!_d(re,this.preTextStyle.fontWeight))){Xe.next=5;break}return Xe.next=4,this.mapping();case 4:return Xe.abrupt("return",!0);case 5:if(!p){Xe.next=7;break}return Xe.abrupt("return",!1);case 7:if(ee=this.mapService.getZoom(),me=this.mapService.getBounds(),Ie=Gr(this.extent,me),!(Math.abs(this.currentZoom-ee)>.5||!Ie||p!==this.preTextStyle.textAllowOverlap)){Xe.next=14;break}return Xe.next=13,this.reBuildModel();case 13:return Xe.abrupt("return",!0);case 14:return Xe.abrupt("return",!1);case 15:case"end":return Xe.stop()}},a,this)}));function i(){return n.apply(this,arguments)}return i}()},{key:"clearModels",value:function(){var i;(i=this.texture)===null||i===void 0||i.destroy(),this.layer.off("remapping",this.mapping)}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"textOffsets",type:bn.Attribute,descriptor:{name:"a_textOffsets",buffer:{usage:Fe.STATIC_DRAW,data:[],type:Fe.FLOAT},size:2,update:function(a,s,l){return[l[5],l[6]]}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:bn.Attribute,descriptor:{name:"a_Size",buffer:{usage:Fe.DYNAMIC_DRAW,data:[],type:Fe.FLOAT},size:1,update:function(a){var s=a.size,l=s===void 0?12:s;return Array.isArray(l)?[l[0]]:[l]}}}),this.styleAttributeService.registerStyleAttribute({name:"textUv",type:bn.Attribute,descriptor:{name:"a_tex",buffer:{usage:Fe.DYNAMIC_DRAW,data:[],type:Fe.FLOAT},size:2,update:function(a,s,l){return[l[3],l[4]]}}})}},{key:"bindEvent",value:function(){this.layer.isTileLayer||this.layer.on("remapping",this.mapping)}},{key:"textExtent",value:function(){var i=this.mapService.getBounds();return yu(i,.5)}},{key:"initTextFont",value:function(){var i=this.getTextStyle(),a=i.fontWeight,s=i.fontFamily,l=this.rawEncodeData,p=[];l.forEach(function(m){var T=m.shape,R=T===void 0?"":T;R=R.toString();var L=Uw(R),z;try{for(L.s();!(z=L.n()).done;){var re=z.value;p.indexOf(re)===-1&&p.push(re)}}catch(ee){L.e(ee)}finally{L.f()}}),this.fontService.setFontOptions({characterSet:p,fontWeight:a,fontFamily:s,iconfont:!1})}},{key:"initIconFontTex",value:function(){var i=this.getTextStyle(),a=i.fontWeight,s=i.fontFamily,l=this.rawEncodeData,p=[];l.forEach(function(m){var T=m.shape,R=T===void 0?"":T;R="".concat(R),p.indexOf(R)===-1&&p.push(R)}),this.fontService.setFontOptions({characterSet:p,fontWeight:a,fontFamily:s,iconfont:!0})}},{key:"getTextStyle",value:function(){var i=this.layer.getLayerConfig(),a=i.fontWeight,s=a===void 0?"400":a,l=i.fontFamily,p=l===void 0?"sans-serif":l,m=i.textAllowOverlap,T=m===void 0?!1:m,R=i.padding,L=R===void 0?[0,0]:R,z=i.textAnchor,re=z===void 0?"center":z,ee=i.textOffset,me=ee===void 0?[0,0]:ee,Ie=i.opacity,He=Ie===void 0?1:Ie,Xe=i.strokeOpacity,ot=Xe===void 0?1:Xe,pt=i.strokeWidth,dt=pt===void 0?0:pt,It=i.stroke,Vt=It===void 0?"#000":It;return{fontWeight:s,fontFamily:p,textAllowOverlap:T,padding:L,textAnchor:re,textOffset:me,opacity:He,strokeOpacity:ot,strokeWidth:dt,stroke:Vt}}},{key:"generateGlyphLayout",value:function(i){var a=this,s=this.getFontServiceMapping(),l=this.layer.getLayerConfig(),p=l.spacing,m=p===void 0?2:p,T=l.textAnchor,R=T===void 0?"center":T,L=l.textOffset,z=this.rawEncodeData;this.glyphInfo=z.map(function(re){var ee=re.shape,me=ee===void 0?"":ee,Ie=re.id,He=re.size,Xe=He===void 0?1:He,ot=re.textOffset?re.textOffset:L||[0,0],pt=re.textAnchor?re.textAnchor:R||"center",dt=Bw(me.toString(),s,Xe,pt,"left",m,ot,i),It=kw(dt,ot,!1);return re.shaping=dt,re.glyphQuads=It,re.centroid=Du(re.coordinates),re.originCentroid=re.version==="GAODE2.x"?Du(re.originCoordinates):re.originCentroid=re.centroid,a.glyphInfoMap[Ie]={shaping:dt,glyphQuads:It,centroid:Du(re.coordinates)},re})}},{key:"getFontServiceMapping",value:function(){var i=this.layer.getLayerConfig(),a=i.fontWeight,s=a===void 0?"400":a,l=i.fontFamily,p=l===void 0?"sans-serif":l;return this.fontService.getMappingByKey("".concat(p,"_").concat(s))}},{key:"getFontServiceCanvas",value:function(){var i=this.layer.getLayerConfig(),a=i.fontWeight,s=a===void 0?"400":a,l=i.fontFamily,p=l===void 0?"sans-serif":l;return this.fontService.getCanvasByKey("".concat(p,"_").concat(s))}},{key:"filterGlyphs",value:function(){var i=this,a=this.layer.getLayerConfig(),s=a.padding,l=s===void 0?[0,0]:s,p=a.textAllowOverlap,m=p===void 0?!1:p;if(!m){this.glyphInfoMap={},this.currentZoom=this.mapService.getZoom(),this.extent=this.textExtent();var T=this.rendererService.getViewportSize(),R=T.width,L=T.height,z=new Nw(R,L),re=this.glyphInfo.filter(function(ee){var me=ee.shaping,Ie=ee.id,He=Ie===void 0?0:Ie,Xe=ee.version==="GAODE2.x"?ee.originCentroid:ee.centroid,ot=ee.size,pt=ot/16,dt=i.mapService.lngLatToContainer(Xe),It=z.placeCollisionBox({x1:me.left*pt-l[0],x2:me.right*pt+l[0],y1:me.top*pt-l[1],y2:me.bottom*pt+l[1],anchorPointX:dt.x,anchorPointY:dt.y}),Vt=It.box;return Vt&&Vt.length?(z.insertCollisionBox(Vt,He),!0):!1});re.forEach(function(ee){i.glyphInfoMap[ee.id]=ee})}}},{key:"initGlyph",value:function(){var i=this.layer.getLayerConfig(),a=i.iconfont,s=a===void 0?!1:a;s?this.initIconFontTex():this.initTextFont(),this.generateGlyphLayout(s)}},{key:"updateTexture",value:function(){var i=this.rendererService.createTexture2D,a=this.getFontServiceCanvas();this.textureHeight=a.height,this.texture&&this.texture.destroy(),this.texture=i({data:a,mag:Fe.LINEAR,min:Fe.LINEAR,width:a.width,height:a.height})}},{key:"reBuildModel",value:function(){var n=(0,hr.Z)(it().mark(function a(){var s;return it().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return this.filterGlyphs(),p.next=3,this.layer.buildLayerModel({moduleName:"pointText",vertexShader:D2,fragmentShader:N2,triangulation:L2.bind(this),inject:this.getInject(),depth:{enable:!1}});case 3:s=p.sent,this.layer.models=[s];case 5:case"end":return p.stop()}},a,this)}));function i(){return n.apply(this,arguments)}return i}()}]),r}(Lo),Vw={fillImage:dw,fill:S2,radar:Mw,image:x2,normal:C2,simplePoint:jM,extrude:y2,text:F2,earthFill:nw,earthExtrude:KM},Hw=Vw;function Ww(e,t){var r=typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=jw(e))||t&&e&&typeof e.length=="number"){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(m){throw m},f:i}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var a=!0,s=!1,l;return{s:function(){r=r.call(e)},n:function(){var m=r.next();return a=m.done,m},e:function(m){s=!0,l=m},f:function(){try{!a&&r.return!=null&&r.return()}finally{if(s)throw l}}}}function jw(e,t){if(e){if(typeof e=="string")return B2(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return B2(e,t)}}function B2(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Xw(e){var t=Yw();return function(){var n=(0,le.Z)(e),i;if(t){var a=(0,le.Z)(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return(0,ze.Z)(this,i)}}function Yw(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var og=function(e){(0,ke.Z)(r,e);var t=Xw(r);function r(){var n;(0,ue.Z)(this,r);for(var i=arguments.length,a=new Array(i),s=0;s<i;s++)a[s]=arguments[s];return n=t.call.apply(t,[this].concat(a)),(0,ve.Z)((0,St.Z)(n),"type","PointLayer"),(0,ve.Z)((0,St.Z)(n),"enableShaderEncodeStyles",["stroke","offsets","opacity","rotation"]),(0,ve.Z)((0,St.Z)(n),"enableDataEncodeStyles",["textOffset","textAnchor"]),(0,ve.Z)((0,St.Z)(n),"defaultSourceConfig",{data:[],options:{parser:{type:"json",x:"lng",y:"lat"}}}),n}return(0,_e.Z)(r,[{key:"buildModels",value:function(){var n=(0,hr.Z)(it().mark(function a(){var s;return it().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return s=this.getModelType(),this.layerModel&&this.layerModel.clearModels(),this.layerModel=new Hw[s](this),p.next=5,this.initLayerModels();case 5:case"end":return p.stop()}},a,this)}));function i(){return n.apply(this,arguments)}return i}()},{key:"rebuildModels",value:function(){var n=(0,hr.Z)(it().mark(function a(){return it().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.next=2,this.buildModels();case 2:case"end":return l.stop()}},a,this)}));function i(){return n.apply(this,arguments)}return i}()},{key:"getModelTypeWillEmptyData",value:function(){if(this.shapeOption){var i=this.shapeOption,a=i.field,s=i.values,l=this.getLayerConfig(),p=l.shape2d,m=this.iconService.getIconMap();if(a&&(p==null?void 0:p.indexOf(a))!==-1)return"fill";if(s==="text")return"text";if(s&&s instanceof Array){var T=Ww(s),R;try{for(T.s();!(R=T.n()).done;){var L=R.value;if(typeof L=="string"&&m.hasOwnProperty(L))return"image"}}catch(z){T.e(z)}finally{T.f()}}}return"normal"}},{key:"getDefaultConfig",value:function(){var i=this.getModelType(),a={fillImage:{},normal:{blend:"additive"},radar:{},simplePoint:{},fill:{blend:"normal"},extrude:{},image:{},text:{blend:"normal"},tile:{},tileText:{},earthFill:{},earthExtrude:{}};return a[i]}},{key:"getModelType",value:function(){var i=this.getEncodedData(),a=this.getLayerConfig(),s=a.shape2d,l=a.shape3d,p=a.billboard,m=p===void 0?!0:p,T=this.iconService.getIconMap(),R=i.find(function(z){return z.hasOwnProperty("shape")});if(R){var L=R.shape;return L==="dot"?"normal":L==="simple"?"simplePoint":L==="radar"?"radar":this.layerType==="fillImage"||m===!1?"fillImage":(s==null?void 0:s.indexOf(L))!==-1?this.mapService.version==="GLOBEL"?"earthFill":"fill":(l==null?void 0:l.indexOf(L))!==-1?this.mapService.version==="GLOBEL"?"earthExtrude":"extrude":T.hasOwnProperty(L)?"image":"text"}else return this.getModelTypeWillEmptyData()}}]),r}(fp);function $w(e){var t=Qw();return function(){var n=(0,le.Z)(e),i;if(t){var a=(0,le.Z)(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return(0,ze.Z)(this,i)}}function Qw(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var qw=`uniform vec4 u_sourceColor;
uniform vec4 u_targetColor;
uniform float u_linearColor: 0;

uniform float u_topsurface: 1.0;
uniform float u_sidesurface: 1.0;

varying vec4 v_Color;

#pragma include "picking"

void main() {


     // top face
    if(u_topsurface < 1.0) {
      discard;
    }

    gl_FragColor = v_Color;
  

  gl_FragColor = filterColor(gl_FragColor);
}
`,Kw=`precision highp float;

#define ambientRatio 0.5
#define diffuseRatio 0.3
#define specularRatio 0.2

attribute vec4 a_Color;
attribute vec3 a_Position;
attribute vec3 a_Normal;
attribute float a_Size;
attribute vec3 a_uvs;
uniform mat4 u_ModelMatrix;

uniform vec4 u_sourceColor;
uniform vec4 u_targetColor;
uniform float u_linearColor: 0;

uniform float u_topsurface: 1.0;
uniform float u_sidesurface: 1.0;

varying vec4 v_Color;
uniform float u_heightfixed: 0.0; // \u9ED8\u8BA4\u4E0D\u56FA\u5B9A
uniform float u_raisingHeight: 0.0;

#pragma include "projection"
#pragma include "light"
#pragma include "picking"

void main() {
 
  float isSide = a_Position.z;
 float topU = a_uvs[0];
 float topV = 1.0 - a_uvs[1];
 float sidey = a_uvs[2];

  vec4 pos = vec4(a_Position.xy, a_Position.z * a_Size, 1.0);
  float lightWeight = calc_lighting(pos);

  vec4 project_pos = project_position(pos);

  if(u_heightfixed > 0.0) { // \u5224\u65AD\u51E0\u4F55\u4F53\u662F\u5426\u56FA\u5B9A\u9AD8\u5EA6
    project_pos.z = a_Position.z * a_Size;
    project_pos.z += u_raisingHeight;

    if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
      float mapboxZoomScale = 4.0/pow(2.0, 21.0 - u_Zoom);
      project_pos.z *= mapboxZoomScale;
      project_pos.z += u_raisingHeight * mapboxZoomScale;
    }
  }


 gl_Position = project_common_position_to_clipspace_v2(vec4(project_pos.xyz, 1.0));

  // Tip: \u90E8\u5206\u673A\u578B GPU \u8BA1\u7B97\u7CBE\u5EA6\u517C\u5BB9
  if(isSide < 0.999) {
    // side face
    // if(u_sidesurface < 1.0) {
    //   discard;
    // }

    if(u_linearColor == 1.0) {
      vec4 linearColor = mix(u_targetColor, u_sourceColor, sidey);
      linearColor.rgb *= lightWeight;
      v_Color = linearColor;
    } else {
      v_Color = a_Color;
    }

  } else {
    v_Color = a_Color;
  }

  v_Color = vec4(v_Color.rgb * lightWeight, v_Color.w * opacity);


  setPickingColor(a_PickingColor);
}
`,Jw=`uniform sampler2D u_texture;
uniform float u_opacity: 1.0;
uniform vec4 u_sourceColor;
uniform vec4 u_targetColor;
uniform float u_linearColor: 0;

uniform float u_topsurface: 1.0;
uniform float u_sidesurface: 1.0;

varying vec4 v_Color;
varying vec3 v_uvs;
varying vec2 v_texture_data;


#pragma include "picking"

void main() {
  float opacity = u_opacity;
  float isSide = v_texture_data.x;
  float lightWeight = v_texture_data.y;
  float topU = v_uvs[0];
  float topV = 1.0 - v_uvs[1];
  float sidey = v_uvs[2];
  // Tip: \u90E8\u5206\u673A\u578B GPU \u8BA1\u7B97\u7CBE\u5EA6\u517C\u5BB9
  if(isSide < 0.999) {// \u662F\u5426\u662F\u8FB9\u7F18
    // side face
    if(u_sidesurface < 1.0) {
      discard;
    }

    if(u_linearColor == 1.0) {
      vec4 linearColor = mix(u_targetColor, u_sourceColor, sidey);
      linearColor.rgb *= lightWeight;
      gl_FragColor = linearColor;
    } else {
      gl_FragColor = v_Color;
    }
  } else {

     // top face
    if(u_topsurface < 1.0) {
      discard;
    }

    gl_FragColor = texture2D(u_texture, vec2(topU, topV));
    // gl_FragColor = vec4(1.0, 0., 0., 1.0);
  }
  

  gl_FragColor.a *= opacity;
  gl_FragColor = filterColor(gl_FragColor);
}
`,eI=`precision highp float;

#define ambientRatio 0.5
#define diffuseRatio 0.3
#define specularRatio 0.2

attribute vec4 a_Color;
attribute vec3 a_Position;
attribute vec3 a_Normal;
attribute float a_Size;
attribute vec3 a_uvs;
uniform mat4 u_ModelMatrix;

uniform sampler2D u_texture;


uniform vec4 u_sourceColor;
uniform vec4 u_targetColor;
uniform float u_topsurface: 1.0;
uniform float u_sidesurface: 1.0;
varying vec4 v_Color;
uniform float u_heightfixed: 0.0; // \u9ED8\u8BA4\u4E0D\u56FA\u5B9A
uniform float u_raisingHeight: 0.0;
uniform float u_linearColor: 0.0;

varying vec2 v_texture_data;
varying vec3 v_uvs;

#pragma include "projection"
#pragma include "light"
#pragma include "picking"

void main() {
 
  vec4 pos = vec4(a_Position.xy, a_Position.z * a_Size, 1.0);
  float lightWeight = calc_lighting(pos);
  vec4 project_pos = project_position(pos);
  v_uvs = a_uvs;

  v_texture_data = vec2(a_Position.z, lightWeight);

  if(u_heightfixed > 0.0) { // \u5224\u65AD\u51E0\u4F55\u4F53\u662F\u5426\u56FA\u5B9A\u9AD8\u5EA6
    project_pos.z = a_Position.z * a_Size;
    project_pos.z += u_raisingHeight;

    if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
      float mapboxZoomScale = 4.0/pow(2.0, 21.0 - u_Zoom);
      project_pos.z *= mapboxZoomScale;
      project_pos.z += u_raisingHeight * mapboxZoomScale;
    }
  }


    gl_Position = project_common_position_to_clipspace_v2(vec4(project_pos.xyz, 1.0));



  setPickingColor(a_PickingColor);
}
`,tI=`uniform float u_opacity: 1.0;
uniform vec4 u_sourceColor;
uniform vec4 u_targetColor;
uniform float u_linearColor: 0;

uniform float u_topsurface: 1.0;
uniform float u_sidesurface: 1.0;

varying vec4 v_Color;
varying vec3 v_uvs;
varying vec2 v_texture_data;

#pragma include "picking"

void main() {
  float opacity = u_opacity;
  float isSide =  v_texture_data.x;
  float sidey = v_uvs[2];
  float lightWeight = v_texture_data.y;

  // Tip: \u90E8\u5206\u673A\u578B GPU \u8BA1\u7B97\u7CBE\u5EA6\u517C\u5BB9
  if(isSide < 0.999) {
    // side face
    if(u_sidesurface < 1.0) {
      discard;
    }
    
    if( u_linearColor == 1.0) {
      // side use linear
      vec4 linearColor = mix(u_targetColor, u_sourceColor, sidey);
      linearColor.rgb *= lightWeight;
      gl_FragColor = linearColor;
    } else {
      // side notuse linear
       gl_FragColor = v_Color;
    }
  } else {
    // top face
    if(u_topsurface < 1.0) {
      discard;
    }
    gl_FragColor = v_Color;
  }

  gl_FragColor.a *= opacity;
  gl_FragColor = filterColorAlpha(gl_FragColor, lightWeight);
}
`,rI=`precision highp float;

#define ambientRatio 0.5
#define diffuseRatio 0.3
#define specularRatio 0.2

attribute vec4 a_Color;
attribute vec3 a_Position;
attribute vec3 a_Normal;
attribute float a_Size;
attribute vec3 a_uvs;
uniform mat4 u_ModelMatrix;


uniform float u_heightfixed: 0.0; // \u9ED8\u8BA4\u4E0D\u56FA\u5B9A
uniform float u_raisingHeight: 0.0;

varying vec2 v_texture_data;
varying vec3 v_uvs;
varying vec4 v_Color;


#pragma include "projection"
#pragma include "light"
#pragma include "picking"

void main() {


  v_uvs = a_uvs;
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
  vec4 pos = vec4(a_Position.xy, a_Position.z * a_Size, 1.0);
  vec4 project_pos = project_position(pos);

  if(u_heightfixed > 0.0) { // \u5224\u65AD\u51E0\u4F55\u4F53\u662F\u5426\u56FA\u5B9A\u9AD8\u5EA6
    project_pos.z = a_Position.z * a_Size;
    project_pos.z += u_raisingHeight;
    if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
      float mapboxZoomScale = 4.0/pow(2.0, 21.0 - u_Zoom);
      project_pos.z *= mapboxZoomScale;
      project_pos.z += u_raisingHeight * mapboxZoomScale;
    }
  }

  gl_Position = project_common_position_to_clipspace_v2(vec4(project_pos.xyz, 1.0));
  float lightWeight = calc_lighting(pos);
  v_texture_data = vec2(a_Position.z,lightWeight);

  v_Color = vec4(a_Color.rgb * lightWeight, a_Color.w);

  setPickingColor(a_PickingColor);
}
`,nI=function(e){(0,ke.Z)(r,e);var t=$w(r);function r(){return(0,ue.Z)(this,r),t.apply(this,arguments)}return(0,_e.Z)(r,[{key:"getUninforms",value:function(){var i=this.layer.getLayerConfig(),a=i.heightfixed,s=a===void 0?!1:a,l=i.raisingHeight,p=l===void 0?0:l,m=i.topsurface,T=m===void 0?!0:m,R=i.sidesurface,L=R===void 0?!0:R,z=i.sourceColor,re=i.targetColor,ee=0,me=[1,1,1,1],Ie=[1,1,1,1];return z&&re&&(me=Qi(z),Ie=Qi(re),ee=1),(0,Q.Z)({u_topsurface:Number(T),u_sidesurface:Number(L),u_heightfixed:Number(s),u_raisingHeight:Number(p),u_linearColor:ee,u_sourceColor:me,u_targetColor:Ie,u_texture:this.texture},this.getStyleAttribute())}},{key:"initModels",value:function(){var n=(0,hr.Z)(it().mark(function a(){return it().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.next=2,this.loadTexture();case 2:return l.abrupt("return",this.buildModels());case 3:case"end":return l.stop()}},a,this)}));function i(){return n.apply(this,arguments)}return i}()},{key:"buildModels",value:function(){var n=(0,hr.Z)(it().mark(function a(){var s,l,p,m,T;return it().wrap(function(L){for(;;)switch(L.prev=L.next){case 0:return s=this.getShaders(),l=s.frag,p=s.vert,m=s.type,L.next=3,this.layer.buildLayerModel({moduleName:m,vertexShader:p,fragmentShader:l,inject:this.getInject(),triangulation:h2});case 3:return T=L.sent,L.abrupt("return",[T]);case 5:case"end":return L.stop()}},a,this)}));function i(){return n.apply(this,arguments)}return i}()},{key:"getShaders",value:function(){var i=this.layer.getLayerConfig(),a=i.pickLight,s=i.mapTexture;return s?{frag:Jw,vert:eI,type:"polygonExtrudeTexture"}:a?{frag:tI,vert:rI,type:"polygonExtrudePickLight"}:{frag:qw,vert:Kw,type:"polygonExtrude"}}},{key:"clearModels",value:function(){var i;(i=this.texture)===null||i===void 0||i.destroy()}},{key:"registerBuiltinAttributes",value:function(){var i=this.layer.getSource().extent,a=i,s=this.layer.coordCenter||this.layer.getSource().center,l=a[2]-a[0],p=a[3]-a[1];if(this.mapService.version==="GAODE2.x"){var m=this.mapService.coordToAMap2RelativeCoordinates([i[0],i[1]],s),T=(0,yn.Z)(m,2),R=T[0],L=T[1],z=this.mapService.coordToAMap2RelativeCoordinates([i[2],i[3]],s),re=(0,yn.Z)(z,2),ee=re[0],me=re[1];l=ee-R,p=me-L,a=[R,L,ee,me]}this.styleAttributeService.registerStyleAttribute({name:"uvs",type:bn.Attribute,descriptor:{name:"a_uvs",buffer:{usage:Fe.STATIC_DRAW,data:[],type:Fe.FLOAT},size:3,update:function(He,Xe,ot){var pt=ot[0],dt=ot[1];return[(pt-a[0])/l,(dt-a[1])/p,ot[4]]}}}),this.styleAttributeService.registerStyleAttribute({name:"normal",type:bn.Attribute,descriptor:{name:"a_Normal",buffer:{usage:Fe.STATIC_DRAW,data:[],type:Fe.FLOAT},size:3,update:function(He,Xe,ot,pt,dt){return dt}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:bn.Attribute,descriptor:{name:"a_Size",buffer:{usage:Fe.DYNAMIC_DRAW,data:[],type:Fe.FLOAT},size:1,update:function(He){var Xe=He.size,ot=Xe===void 0?10:Xe;return Array.isArray(ot)?[ot[0]]:[ot]}}})}},{key:"loadTexture",value:function(){var n=(0,hr.Z)(it().mark(function a(){var s=this,l,p,m;return it().wrap(function(R){for(;;)switch(R.prev=R.next){case 0:if(l=this.layer.getLayerConfig(),p=l.mapTexture,m=this.rendererService.createTexture2D,this.texture=m({height:0,width:0}),!p){R.next=5;break}return R.abrupt("return",new Promise(function(L,z){var re=new Image;re.crossOrigin="anonymous",re.src=p,re.onload=function(){return s.texture=m({data:re,width:re.width,height:re.height,wrapS:Fe.CLAMP_TO_EDGE,wrapT:Fe.CLAMP_TO_EDGE,min:Fe.LINEAR,mag:Fe.LINEAR}),L(null)},re.onerror=function(){z(new Error("image load error"))}}));case 5:case"end":return R.stop()}},a,this)}));function i(){return n.apply(this,arguments)}return i}()}]),r}(Lo);function iI(e){var t=aI();return function(){var n=(0,le.Z)(e),i;if(t){var a=(0,le.Z)(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return(0,ze.Z)(this,i)}}function aI(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var oI=`
uniform float u_opacity: 1.0;
varying vec4 v_Color;
varying vec2 v_texture_data;


#pragma include "picking"

void main() {

  gl_FragColor = v_Color;
  gl_FragColor = filterColor(gl_FragColor);
}
`,sI=`precision highp float;

#define ambientRatio 0.5
#define diffuseRatio 0.3
#define specularRatio 0.2

attribute vec4 a_Color;
attribute vec3 a_Position;
attribute vec3 a_Normal;
attribute float a_Size;
uniform mat4 u_ModelMatrix;




varying vec4 v_Color;

#pragma include "projection"
#pragma include "light"
#pragma include "picking"

void main() {
 
  vec4 pos = vec4(a_Position.xy, a_Position.z * a_Size + (1.0 - a_Position.z) * extrusionBase, 1.0);
  float lightWeight = calc_lighting(pos);
  vec4 project_pos = project_position(pos);
  v_Color = a_Color;
  v_Color = vec4(v_Color.rgb * lightWeight, v_Color.w * opacity);

  gl_Position = project_common_position_to_clipspace_v2(vec4(project_pos.xyz, 1.0));

  setPickingColor(a_PickingColor);
}
`,uI=function(e){(0,ke.Z)(r,e);var t=iI(r);function r(){return(0,ue.Z)(this,r),t.apply(this,arguments)}return(0,_e.Z)(r,[{key:"getUninforms",value:function(){return(0,Q.Z)({},this.getStyleAttribute())}},{key:"initModels",value:function(){var n=(0,hr.Z)(it().mark(function a(){return it().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.abrupt("return",this.buildModels());case 1:case"end":return l.stop()}},a,this)}));function i(){return n.apply(this,arguments)}return i}()},{key:"buildModels",value:function(){var n=(0,hr.Z)(it().mark(function a(){var s,l,p,m,T;return it().wrap(function(L){for(;;)switch(L.prev=L.next){case 0:return s=this.getShaders(),l=s.frag,p=s.vert,m=s.type,L.next=3,this.layer.buildLayerModel({moduleName:m,vertexShader:p,fragmentShader:l,inject:this.getInject(),triangulation:h2});case 3:return T=L.sent,L.abrupt("return",[T]);case 5:case"end":return L.stop()}},a,this)}));function i(){return n.apply(this,arguments)}return i}()},{key:"getShaders",value:function(){return{frag:oI,vert:sI,type:"polygonExtrude"}}},{key:"clearModels",value:function(){var i;(i=this.texture)===null||i===void 0||i.destroy()}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"normal",type:bn.Attribute,descriptor:{name:"a_Normal",buffer:{usage:Fe.STATIC_DRAW,data:[],type:Fe.FLOAT},size:3,update:function(a,s,l,p,m){return m}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:bn.Attribute,descriptor:{name:"a_Size",buffer:{usage:Fe.DYNAMIC_DRAW,data:[],type:Fe.FLOAT},size:1,update:function(a){var s=a.size,l=s===void 0?10:s;return Array.isArray(l)?[l[0]]:[l]}}})}}]),r}(Lo);function lI(e){var t=cI();return function(){var n=(0,le.Z)(e),i;if(t){var a=(0,le.Z)(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return(0,ze.Z)(this,i)}}function cI(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var fI=`varying vec4 v_color;
#pragma include "picking"

void main() {
  gl_FragColor = v_color;
  gl_FragColor = filterColor(gl_FragColor);
}
`,hI=`#pragma include "picking"
uniform float u_opacitylinear: 0.0;
uniform float u_dir: 1.0;
varying vec3 v_linear;
varying vec2 v_pos;
varying vec4 v_Color;


void main() {
   gl_FragColor = v_Color;
  if(u_opacitylinear > 0.0) {
    gl_FragColor.a *= u_dir == 1.0 ? 1.0 - length(v_pos - v_linear.xy)/v_linear.z : length(v_pos - v_linear.xy)/v_linear.z;
  }
  gl_FragColor = filterColor(gl_FragColor);
}
`,AI=`attribute vec4 a_Color;
attribute vec3 a_Position;

uniform mat4 u_ModelMatrix;

uniform float u_raisingHeight: 0.0;

varying vec4 v_Color;


#pragma include "projection"
#pragma include "picking"

uniform float u_opacitylinear: 0.0;

attribute vec3 a_linear;
varying vec3 v_linear;
varying vec2 v_pos;

void main() {
  if(u_opacitylinear > 0.0) {
    v_linear = a_linear;
    v_pos = a_Position.xy;
  }
  v_Color = vec4(a_Color.xyz, a_Color.w * opacity);
  vec4 project_pos = project_position(vec4(a_Position, 1.0));
  project_pos.z += u_raisingHeight;

  if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
    float mapboxZoomScale = 4.0/pow(2.0, 21.0 - u_Zoom);
    project_pos.z *= mapboxZoomScale;
    project_pos.z += u_raisingHeight * mapboxZoomScale;
  }

   gl_Position = project_common_position_to_clipspace_v2(vec4(project_pos.xyz, 1.0));
  setPickingColor(a_PickingColor);
}`,pI=`attribute vec4 a_Color;
attribute vec3 a_Position;

uniform mat4 u_ModelMatrix;


uniform float u_raisingHeight: 0.0;

varying vec4 v_color;


#pragma include "projection"
#pragma include "picking"

void main() {
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97

  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97

  v_color = vec4(a_Color.xyz, a_Color.w * opacity);
  vec4 project_pos = project_position(vec4(a_Position, 1.0));
  // gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));

  project_pos.z += u_raisingHeight;

  if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
    float mapboxZoomScale = 4.0/pow(2.0, 21.0 - u_Zoom);
    project_pos.z *= mapboxZoomScale;
    project_pos.z += u_raisingHeight * mapboxZoomScale;
  }

 
  gl_Position = project_common_position_to_clipspace_v2(vec4(project_pos.xyz, 1.0));

  setPickingColor(a_PickingColor);
}

`,dI=function(e){(0,ke.Z)(r,e);var t=lI(r);function r(){return(0,ue.Z)(this,r),t.apply(this,arguments)}return(0,_e.Z)(r,[{key:"getUninforms",value:function(){var i=this.layer.getLayerConfig(),a=i.raisingHeight,s=a===void 0?0:a,l=i.opacityLinear,p=l===void 0?{enable:!1,dir:"in"}:l;return(0,Q.Z)({u_raisingHeight:Number(s),u_opacitylinear:Number(p.enable),u_dir:p.dir==="in"?1:0},this.getStyleAttribute())}},{key:"initModels",value:function(){var n=(0,hr.Z)(it().mark(function a(){return it().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.abrupt("return",this.buildModels());case 1:case"end":return l.stop()}},a,this)}));function i(){return n.apply(this,arguments)}return i}()},{key:"buildModels",value:function(){var n=(0,hr.Z)(it().mark(function a(){var s,l,p,m,T,R;return it().wrap(function(z){for(;;)switch(z.prev=z.next){case 0:return s=this.getModelParams(),l=s.frag,p=s.vert,m=s.triangulation,T=s.type,this.layer.triangulation=m,z.next=4,this.layer.buildLayerModel({moduleName:T,vertexShader:p,fragmentShader:l,inject:this.getInject(),triangulation:m,primitive:Fe.TRIANGLES,depth:{enable:!1}});case 4:return R=z.sent,z.abrupt("return",[R]);case 6:case"end":return z.stop()}},a,this)}));function i(){return n.apply(this,arguments)}return i}()},{key:"registerBuiltinAttributes",value:function(){var i=this.layer.getLayerConfig(),a=i.opacityLinear,s=a===void 0?{enable:!1,dir:"in"}:a;s.enable&&this.styleAttributeService.registerStyleAttribute({name:"linear",type:bn.Attribute,descriptor:{name:"a_linear",buffer:{usage:Fe.STATIC_DRAW,data:[],type:Fe.FLOAT},size:3,update:function(p,m,T){return[T[3],T[4],T[5]]}}})}},{key:"getModelParams",value:function(){var i=this.layer.getLayerConfig(),a=i.opacityLinear,s=a===void 0?{enable:!1}:a;return s.enable?{frag:hI,vert:AI,type:"polygonLinear",triangulation:gR}:{frag:fI,vert:pI,type:"polygonFill",triangulation:yc}}}]),r}(Lo);function vI(e){var t=gI();return function(){var n=(0,le.Z)(e),i;if(t){var a=(0,le.Z)(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return(0,ze.Z)(this,i)}}function gI(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var mI=`
uniform float u_time: 0.0;
uniform float u_opacity: 1.0;

varying vec2 v_uv;

float coast2water_fadedepth = 0.10;
float large_waveheight      = .750; // change to adjust the "heavy" waves
float large_wavesize        = 3.4;  // factor to adjust the large wave size
float small_waveheight      = 0.6;  // change to adjust the small random waves
float small_wavesize        = 0.5;   // factor to ajust the small wave size
float water_softlight_fact  = 15.;  // range [1..200] (should be << smaller than glossy-fact)
float water_glossylight_fact= 120.; // range [1..200]
float particle_amount       = 70.;
// vec3 watercolor             = vec3(0.43, 0.60, 0.66); // 'transparent' low-water color (RGB)
// vec3 watercolor2            = vec3(0.06, 0.07, 0.11); // deep-water color (RGB, should be darker than the low-water color)
uniform vec4 u_watercolor;
uniform vec4 u_watercolor2;
vec3 water_specularcolor    = vec3(1.3, 1.3, 0.9);    // specular Color (RGB) of the water-highlights
#define light                 vec3(-0., sin(u_time*0.5)*.5 + .35, 2.8) // position of the sun

uniform sampler2D u_texture1;
uniform sampler2D u_texture2;
uniform sampler2D u_texture3;

  

float hash( float n ) {
    return fract(sin(n)*43758.5453123);
}

// 2d noise function
float noise1( in vec2 x ) {
  vec2 p  = floor(x);
  vec2 f  = smoothstep(0.0, 1.0, fract(x));
  float n = p.x + p.y*57.0;
  return mix(mix( hash(n+  0.0), hash(n+  1.0),f.x),
    mix( hash(n+ 57.0), hash(n+ 58.0),f.x),f.y);
}

float noise(vec2 p) {
    return texture2D(u_texture2,p*vec2(1./256.)).x;
}

vec4 highness(vec2 p) {
    vec4 t = texture2D(u_texture1,fract(p));
    float clipped = -2.0-smoothstep(3.,10.,t.a)*6.9-smoothstep(10.,100.,t.a)*89.9-smoothstep(0.,10000.,t.a)*10000.0;
    return clamp(t, 0.0,3.0)+clamp(t/3.0-1.0, 0.0,1.0)+clamp(t/16.0-1.0, 0.0,1.0);
}

float height_map( vec2 p ) {
    vec4 height=highness(p);
    /*
    height = -0.5+
        0.5*smoothstep(-100.,0.,-height)+
        2.75*smoothstep(0.,2.,height)+
        1.75*smoothstep(2.,4.,height)+
        2.75*smoothstep(4.,16.,height)+
        1.5*smoothstep(16.,1000.,height);
    */

    mat2 m = mat2( 0.9563*1.4,  -0.2924*1.4,  0.2924*1.4,  0.9563*1.4 );
    //p = p*6.;
    float f = 0.6000*noise1( p ); p = m*p*1.1*6.;
    f += 0.2500*noise( p ); p = m*p*1.32;
    f += 0.1666*noise( p ); p = m*p*1.11;
    f += 0.0834*noise( p ); p = m*p*1.12;
    f += 0.0634*noise( p ); p = m*p*1.13;
    f += 0.0444*noise( p ); p = m*p*1.14;
    f += 0.0274*noise( p ); p = m*p*1.15;
    f += 0.0134*noise( p ); p = m*p*1.16;
    f += 0.0104*noise( p ); p = m*p*1.17;
    f += 0.0084*noise( p );
    f = .25*f+dot(height,vec4(-.03125,-.125,.25,.25))*.5;
        const float FLAT_LEVEL = 0.92525;
        //f = f*0.25+height*0.75;
    if (f<FLAT_LEVEL)
        f = f;
    else
        f = pow((f-FLAT_LEVEL)/(1.-FLAT_LEVEL), 2.)*(1.-FLAT_LEVEL)*2.0+FLAT_LEVEL; // makes a smooth coast-increase
    return clamp(f, 0., 10.);
}

vec3 plasma_quintic( float x ) {
    x = clamp( x, 0.0, 1.0);
    vec4 x1 = vec4( 1.0, x, x * x, x * x * x ); // 1 x x2 x3
    vec4 x2 = x1 * x1.w * x; // x4 x5 x6 x7
    return vec3(
        dot( x1.xyzw, vec4( +0.063861086, +1.992659096, -1.023901152, -0.490832805 ) ) + dot( x2.xy, vec2( +1.308442123, -0.914547012 ) ),
        dot( x1.xyzw, vec4( +0.049718590, -0.791144343, +2.892305078, +0.811726816 ) ) + dot( x2.xy, vec2( -4.686502417, +2.717794514 ) ),
        dot( x1.xyzw, vec4( +0.513275779, +1.580255060, -5.164414457, +4.559573646 ) ) + dot( x2.xy, vec2( -1.916810682, +0.570638854 ) ) );
}

vec4 color(vec2 p){
    vec4 c1 = vec4(1.7,1.6,.9,1);
    vec4 c2 = vec4(.2,.94,.1,1);
    vec4 c3 = vec4(.3,.2,.0,1);
    vec4 c4 = vec4(.99,.99,1.6,1);
    vec4 v = highness(p);
    float los = smoothstep(0.1,1.1,v.b);
    float his = smoothstep(3.5,6.5,v.b);
    float ces = smoothstep(1.,5.,v.a);
    vec4 lo = mix(c1,c2,los);
    vec4 hi = mix(c3,c4,his);
    vec4 ce = mix(lo,hi,ces);

    return vec4(plasma_quintic(ces),1).ragb;
}

vec3 terrain_map( vec2 p )
{
  return color(p).rgb*0.75+0.25*vec3(0.7, .55, .4)+texture2D(u_texture3, fract(p*5.)).rgb*.5; // test-terrain is simply 'sandstone'
}

const mat2 m = mat2( 0.72, -1.60,  1.60,  0.72 );

float water_map( vec2 p, float height ) {
    vec2 p2 = p*large_wavesize;
    vec2 shift1 = 0.001*vec2( u_time*160.0*2.0, u_time*120.0*2.0 );
    vec2 shift2 = 0.001*vec2( u_time*190.0*2.0, -u_time*130.0*2.0 );

    // coarse crossing 'ocean' waves...
    float f = 0.6000*noise( p );
    f += 0.2500*noise( p*m );
    f += 0.1666*noise( p*m*m );
    float wave = sin(p2.x*0.622+p2.y*0.622+shift2.x*4.269)*large_waveheight*f*height*height ;

    p *= small_wavesize;
    f = 0.;
    float amp = 1.0, s = .5;
    for (int i=0; i<9; i++)
    { p = m*p*.947; f -= amp*abs(sin((noise( p+shift1*s )-.5)*2.)); amp = amp*.59; s*=-1.329; }
    
    return wave+f*small_waveheight;
}

float nautic(vec2 p) {
    p *= 18.;
    float f = 0.;
    float amp = 1.0, s = .5;
    for (int i=0; i<3; i++)
    { p = m*p*1.2; f += amp*abs(smoothstep(0., 1., noise( p+u_time*s ))-.5); amp = amp*.5; s*=-1.227; }
    return pow(1.-f, 5.);
}

float particles(vec2 p) {
    p *= 200.;
    float f = 0.;
    float amp = 1.0, s = 1.5;
    for (int i=0; i<3; i++)
    { p = m*p*1.2; f += amp*noise( p+u_time*s ); amp = amp*.5; s*=-1.227; }
    return pow(f*.35, 7.)*particle_amount;
}

float test_shadow( vec2 xy, float height) {
    vec3 r0 = vec3(xy, height);
    vec3 rd = normalize( light - r0 );
    
    float hit = 1.0;
    float t   = 0.001;
    for (int j=1; j<25; j++)
    {
        vec3 p = r0 + t*rd;
        float h = height_map( p.xy );
        float height_diff = p.z - h;
        if (height_diff<0.0)
        {
            return 0.0;
        }
        t += 0.01+height_diff*.02;
        hit = min(hit, 2.*height_diff/t); // soft shaddow   
    }
    return hit;
}

vec3 CalcTerrain(vec2 uv, float height) {
    vec3 col = terrain_map( uv );
    vec2 iResolution = vec2(512.);
    float h1 = height_map(uv-vec2(0., 0.5)/ iResolution.xy);
    float h2 = height_map(uv+vec2(0., 0.5)/ iResolution.xy);
    float h3 = height_map(uv-vec2(0.5, 0.)/ iResolution.xy);
    float h4 = height_map(uv+vec2(0.5, 0.)/ iResolution.xy);
    vec3 norm = normalize(vec3(h3-h4, h1-h2, 1.));
    vec3 r0 = vec3(uv, height);
    vec3 rd = normalize( light - r0 );
    float grad = dot(norm, rd);
    col *= grad+pow(grad, 8.);
    float terrainshade = test_shadow( uv, height );
    col = mix(col*.25, col, terrainshade);
    return col;
}


void main() {
  vec3 watercolor = u_watercolor.rgb;
  vec3 watercolor2 = u_watercolor2.rgb;
  vec2 uv = v_uv;
  float WATER_LEVEL = 0.84; // Water level (range: 0.0 - 2.0)
  float deepwater_fadedepth   = 0.4 + coast2water_fadedepth;
  float height = height_map( uv );
  vec3 col;

    float waveheight = clamp(WATER_LEVEL*3.-1.5, 0., 1.);
    float level = WATER_LEVEL + .2*water_map(uv*15. + vec2(u_time*.1), waveheight);
    if (height > level)
    {
        col = CalcTerrain(uv, height);
    }
    if (height <= level)
    {
        vec2 dif = vec2(.0, .01);
        vec2 pos = uv*15. + vec2(u_time*.01);
        float h1 = water_map(pos-dif,waveheight);
        float h2 = water_map(pos+dif,waveheight);
        float h3 = water_map(pos-dif.yx,waveheight);
        float h4 = water_map(pos+dif.yx,waveheight);
        vec3 normwater = normalize(vec3(h3-h4, h1-h2, .125)); // norm-vector of the 'bumpy' water-plane
        uv += normwater.xy*.002*(level-height);
        
        col = CalcTerrain(uv, height);

        float coastfade = clamp((level-height)/coast2water_fadedepth, 0., 1.);
        float coastfade2= clamp((level-height)/deepwater_fadedepth, 0., 1.);
        float intensity = col.r*.2126+col.g*.7152+col.b*.0722;
        watercolor = mix(watercolor*intensity, watercolor2, smoothstep(0., 1., coastfade2));

        vec3 r0 = vec3(uv, WATER_LEVEL);
        vec3 rd = normalize( light - r0 ); // ray-direction to the light from water-position
        float grad     = dot(normwater, rd); // dot-product of norm-vector and light-direction
        float specular = pow(grad, water_softlight_fact);  // used for soft highlights                          
        float specular2= pow(grad, water_glossylight_fact); // used for glossy highlights
        float gradpos  = dot(vec3(0., 0., 1.), rd);
        float specular1= smoothstep(0., 1., pow(gradpos, 5.));  // used for diffusity (some darker corona around light's specular reflections...)                          
        float watershade  = test_shadow( uv, level );
        watercolor *= 2.2+watershade;
        watercolor += (.2+.8*watershade) * ((grad-1.0)*.5+specular) * .25;
        watercolor /= (1.+specular1*1.25);
        watercolor += watershade*specular2*water_specularcolor;
        watercolor += watershade*coastfade*(1.-coastfade2)*(vec3(.5, .6, .7)*nautic(uv)+vec3(1., 1., 1.)*particles(uv));
        
        col = mix(col, watercolor, coastfade);
    }
    

  float opacity = u_opacity;
  gl_FragColor = vec4(col, opacity);  
}
`,_I=`attribute vec2 a_uv;
attribute vec3 a_Position;
uniform mat4 u_ModelMatrix;


varying vec2 v_uv;

#pragma include "projection"

void main() {
  v_uv = a_uv;

  vec4 project_pos = project_position(vec4(a_Position, 1.0));
  gl_Position = project_common_position_to_clipspace_v2(vec4(project_pos.xyz, 1.0));
}

`,yI=Fn.isNumber,EI=function(e){(0,ke.Z)(r,e);var t=vI(r);function r(){return(0,ue.Z)(this,r),t.apply(this,arguments)}return(0,_e.Z)(r,[{key:"getUninforms",value:function(){var i=this.layer.getLayerConfig(),a=i.opacity,s=a===void 0?1:a,l=i.watercolor,p=l===void 0?"#6D99A8":l,m=i.watercolor2,T=m===void 0?"#0F121C":m;return{u_texture1:this.texture1,u_texture2:this.texture2,u_texture3:this.texture3,u_watercolor:Qi(p),u_watercolor2:Qi(T),u_opacity:yI(s)?s:1}}},{key:"getAnimateUniforms",value:function(){return{u_time:this.layer.getLayerAnimateTime()}}},{key:"initModels",value:function(){var n=(0,hr.Z)(it().mark(function a(){return it().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return this.loadTexture(),l.abrupt("return",this.buildModels());case 2:case"end":return l.stop()}},a,this)}));function i(){return n.apply(this,arguments)}return i}()},{key:"buildModels",value:function(){var n=(0,hr.Z)(it().mark(function a(){var s;return it().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return p.next=2,this.layer.buildLayerModel({moduleName:"polygonOcean",vertexShader:_I,fragmentShader:mI,triangulation:t_,primitive:Fe.TRIANGLES,depth:{enable:!1}});case 2:return s=p.sent,p.abrupt("return",[s]);case 4:case"end":return p.stop()}},a,this)}));function i(){return n.apply(this,arguments)}return i}()},{key:"clearModels",value:function(){var i,a,s;(i=this.texture1)===null||i===void 0||i.destroy(),(a=this.texture2)===null||a===void 0||a.destroy(),(s=this.texture3)===null||s===void 0||s.destroy()}},{key:"registerBuiltinAttributes",value:function(){var i=this.layer.getSource().extent,a=(0,yn.Z)(i,4),s=a[0],l=a[1],p=a[2],m=a[3],T=p-s,R=m-l;this.styleAttributeService.registerStyleAttribute({name:"oceanUv",type:bn.Attribute,descriptor:{name:"a_uv",buffer:{usage:Fe.STATIC_DRAW,data:[],type:Fe.FLOAT},size:2,update:function(z,re,ee,me){var Ie=z.version==="GAODE2.x"?z.originCoordinates[0][me]:ee,He=(0,yn.Z)(Ie,2),Xe=He[0],ot=He[1];return[(Xe-s)/T,(ot-l)/R]}}})}},{key:"loadTexture",value:function(){var i=this,a=this.rendererService.createTexture2D,s={height:0,width:0};this.texture1=a(s),this.texture2=a(s),this.texture3=a(s),l(function(m){i.texture1=p(m[0]),i.texture2=p(m[1]),i.texture3=p(m[2]),i.layerService.reRender()});function l(m){var T=0,R=[],L=["https://gw.alipayobjects.com/mdn/rms_816329/afts/img/A*EojwT4VzSiYAAAAAAAAAAAAAARQnAQ","https://gw.alipayobjects.com/mdn/rms_816329/afts/img/A*MJ22QbpuCzIAAAAAAAAAAAAAARQnAQ","https://gw.alipayobjects.com/mdn/rms_816329/afts/img/A*-z2HSIVDsHIAAAAAAAAAAAAAARQnAQ"];L.map(function(z){var re=new Image;re.crossOrigin="",re.src=z,R.push(re),re.onload=function(){T++,T===3&&m(R)}})}function p(m){return a({data:m,width:m.width,height:m.height,wrapS:Fe.MIRRORED_REPEAT,wrapT:Fe.MIRRORED_REPEAT,min:Fe.LINEAR,mag:Fe.LINEAR})}}}]),r}(Lo);function SI(e){var t=xI();return function(){var n=(0,le.Z)(e),i;if(t){var a=(0,le.Z)(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return(0,ze.Z)(this,i)}}function xI(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var TI=`uniform sampler2D u_texture;
uniform float u_time: 0.0;
uniform float u_speed: 1.0;
uniform float u_opacity: 1.0;

varying vec4 v_Color;
varying vec2 v_uv;

float rand(vec2 n) { return 0.5 + 0.5 * fract(sin(dot(n.xy, vec2(12.9898, 78.233)))* 43758.5453); }

float water(vec3 p) {
  float t = u_time * u_speed;
  p.z += t * 2.; p.x += t * 2.;
  vec3 c1 = texture2D(u_texture, p.xz / 30.).xyz;
  p.z += t * 3.; p.x += t * 0.52;
  vec3 c2 = texture2D(u_texture, p.xz / 30.).xyz;
  p.z += t * 4.; p.x += t * 0.8;
  vec3 c3 = texture2D(u_texture, p.xz / 30.).xyz;
  c1 += c2 - c3;
  float z = (c1.x + c1.y + c1.z) / 3.;
  return p.y + z / 4.;
}

float map(vec3 p) {
  float d = 100.0;
  d = water(p);
  return d;
}

float intersect(vec3 ro, vec3 rd) {
  float d = 0.0;
  for (int i = 0; i <= 100; i++) {
    float h = map(ro + rd * d);
    if (h < 0.1) return  d;
    d += h;
  }
  return 0.0;
}

vec3 norm(vec3 p) {
  float eps = .1;
  return normalize(vec3(
    map(p + vec3(eps, 0, 0)) - map(p + vec3(-eps, 0, 0)),
    map(p + vec3(0, eps, 0)) - map(p + vec3(0, -eps, 0)),
    map(p + vec3(0, 0, eps)) - map(p + vec3(0, 0, -eps))
  ));
} 

float calSpc() {
  vec3 l1 = normalize(vec3(1, 1, 1));
  vec3 ro = vec3(-3, 20, -8);
  vec3 rc = vec3(0, 0, 0);
  vec3 ww = normalize(rc - ro);
  vec3 uu = normalize(cross(vec3(0,1,0), ww));
  vec3 vv = normalize(cross(rc - ro, uu));
  vec3 rd = normalize(uu * v_uv.x + vv * v_uv.y + ww);
  float d = intersect(ro, rd);
  vec3 p = ro + rd * d;
  vec3 n = norm(p);
  float spc = pow(max(0.0, dot(reflect(l1, n), rd)), 30.0);
  return spc;
}

void main() {
  float opacity = u_opacity;
  gl_FragColor = v_Color;
  gl_FragColor.a *= opacity;

  float spc = calSpc();
  gl_FragColor += spc * 0.4;
}
`,CI=`attribute vec4 a_Color;
attribute vec2 a_uv;
attribute vec3 a_Position;
uniform mat4 u_ModelMatrix;


varying vec4 v_Color;
varying vec2 v_uv;
uniform float u_opacity: 1.0;


#pragma include "projection"

void main() {
  v_uv = a_uv;

  v_Color = a_Color;
  vec4 project_pos = project_position(vec4(a_Position, 1.0));

  gl_Position = project_common_position_to_clipspace_v2(vec4(project_pos.xyz, 1.0));
}

`,bI=Fn.isNumber,RI=function(e){(0,ke.Z)(r,e);var t=SI(r);function r(){return(0,ue.Z)(this,r),t.apply(this,arguments)}return(0,_e.Z)(r,[{key:"getUninforms",value:function(){var i=this.layer.getLayerConfig(),a=i.opacity,s=a===void 0?1:a,l=i.speed,p=l===void 0?.5:l;return{u_texture:this.texture,u_speed:p,u_opacity:bI(s)?s:1}}},{key:"getAnimateUniforms",value:function(){return{u_time:this.layer.getLayerAnimateTime()}}},{key:"initModels",value:function(){var n=(0,hr.Z)(it().mark(function a(){return it().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return this.loadTexture(),l.abrupt("return",this.buildModels());case 2:case"end":return l.stop()}},a,this)}));function i(){return n.apply(this,arguments)}return i}()},{key:"buildModels",value:function(){var n=(0,hr.Z)(it().mark(function a(){var s;return it().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return p.next=2,this.layer.buildLayerModel({moduleName:"polygonWater",vertexShader:CI,fragmentShader:TI,triangulation:t_,primitive:Fe.TRIANGLES,depth:{enable:!1}});case 2:return s=p.sent,p.abrupt("return",[s]);case 4:case"end":return p.stop()}},a,this)}));function i(){return n.apply(this,arguments)}return i}()},{key:"clearModels",value:function(){var i;(i=this.texture)===null||i===void 0||i.destroy()}},{key:"registerBuiltinAttributes",value:function(){var i=this.layer.getSource().extent,a=(0,yn.Z)(i,4),s=a[0],l=a[1],p=a[2],m=a[3],T=p-s,R=m-l;this.styleAttributeService.registerStyleAttribute({name:"waterUv",type:bn.Attribute,descriptor:{name:"a_uv",buffer:{usage:Fe.STATIC_DRAW,data:[],type:Fe.FLOAT},size:2,update:function(z,re,ee,me){var Ie=z.version==="GAODE2.x"?z.originCoordinates[0][me]:ee,He=(0,yn.Z)(Ie,2),Xe=He[0],ot=He[1];return[(Xe-s)/T,(ot-l)/R]}}})}},{key:"loadTexture",value:function(){var i=this,a=this.layer.getLayerConfig(),s=a.waterTexture,l=this.rendererService.createTexture2D;this.texture=l({height:0,width:0});var p=new Image;p.crossOrigin="",s?(console.warn("L7 recommend\uFF1Ahttps://gw.alipayobjects.com/mdn/rms_816329/afts/img/A*EojwT4VzSiYAAAAAAAAAAAAAARQnAQ"),p.src=s):p.src="https://gw.alipayobjects.com/mdn/rms_816329/afts/img/A*EojwT4VzSiYAAAAAAAAAAAAAARQnAQ",p.onload=function(){i.texture=l({data:p,width:p.width,height:p.height,wrapS:Fe.MIRRORED_REPEAT,wrapT:Fe.MIRRORED_REPEAT,min:Fe.LINEAR,mag:Fe.LINEAR}),i.layerService.reRender()}}}]),r}(Lo),MI={fill:dI,line:g2,extrude:nI,text:F2,point_fill:S2,point_image:x2,point_normal:C2,point_extrude:y2,water:RI,ocean:EI,extrusion:uI},wI=MI;function II(e){var t=PI();return function(){var n=(0,le.Z)(e),i;if(t){var a=(0,le.Z)(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return(0,ze.Z)(this,i)}}function PI(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var a_=function(e){(0,ke.Z)(r,e);var t=II(r);function r(){var n;(0,ue.Z)(this,r);for(var i=arguments.length,a=new Array(i),s=0;s<i;s++)a[s]=arguments[s];return n=t.call.apply(t,[this].concat(a)),(0,ve.Z)((0,St.Z)(n),"type","PolygonLayer"),(0,ve.Z)((0,St.Z)(n),"enableShaderEncodeStyles",["opacity","extrusionBase","rotation","offsets","stroke"]),n}return(0,_e.Z)(r,[{key:"buildModels",value:function(){var n=(0,hr.Z)(it().mark(function a(){var s;return it().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return s=this.getModelType(),this.layerModel=new wI[s](this),p.next=4,this.initLayerModels();case 4:case"end":return p.stop()}},a,this)}));function i(){return n.apply(this,arguments)}return i}()},{key:"getModelType",value:function(){var i,a=this.styleAttributeService.getLayerStyleAttribute("shape"),s=a==null||(i=a.scale)===null||i===void 0?void 0:i.field;return s==="fill"||!s?"fill":s==="extrude"?"extrude":s==="extrusion"?"extrusion":s==="water"?"water":s==="ocean"?"ocean":s==="line"?"line":this.getPointModelType()}},{key:"getPointModelType",value:function(){var i=this.getEncodedData(),a=this.getLayerConfig(),s=a.shape2d,l=a.shape3d,p=this.iconService.getIconMap(),m=i.find(function(R){return R.hasOwnProperty("shape")});if(m){var T=m.shape;return T==="dot"?"point_normal":(s==null?void 0:s.indexOf(T))!==-1?"point_fill":(l==null?void 0:l.indexOf(T))!==-1?"point_extrude":p.hasOwnProperty(T)?"point_image":"text"}else return"fill"}}]),r}(fp);function OI(e){var t=NI();return function(){var n=(0,le.Z)(e),i;if(t){var a=(0,le.Z)(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return(0,ze.Z)(this,i)}}function NI(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var DI=`uniform float u_opacity : 1.0;
uniform vec4 u_color;

void main() {
  gl_FragColor = u_color;
  gl_FragColor.a *= u_opacity;
}
`,LI=`attribute vec3 a_Position;
uniform mat4 u_ModelMatrix;


#pragma include "projection"

void main() {
  vec4 project_pos = project_position(vec4(a_Position, 1.0));

  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    gl_Position = u_Mvp * (vec4(project_pos.xyz, 1.0));
  } else {
    gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));
  }
}

`,FI=Fn.isNumber,BI=function(e){(0,ke.Z)(r,e);var t=OI(r);function r(){return(0,ue.Z)(this,r),t.apply(this,arguments)}return(0,_e.Z)(r,[{key:"getUninforms",value:function(){var i=this.layer.getLayerConfig(),a=i.opacity,s=a===void 0?1:a,l=i.color,p=l===void 0?"#000":l;return{u_opacity:FI(s)?s:0,u_color:Qi(p)}}},{key:"initModels",value:function(){var n=(0,hr.Z)(it().mark(function a(){return it().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.abrupt("return",this.buildModels());case 1:case"end":return l.stop()}},a,this)}));function i(){return n.apply(this,arguments)}return i}()},{key:"buildModels",value:function(){var n=(0,hr.Z)(it().mark(function a(){var s;return it().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return p.next=2,this.layer.buildLayerModel({moduleName:"mask",vertexShader:LI,fragmentShader:DI,triangulation:t_,depth:{enable:!1},pick:!1});case 2:return s=p.sent,p.abrupt("return",[s]);case 4:case"end":return p.stop()}},a,this)}));function i(){return n.apply(this,arguments)}return i}()},{key:"clearModels",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;i&&this.layerService.clear()}},{key:"registerBuiltinAttributes",value:function(){return""}}]),r}(Lo),kI={fill:BI},UI=kI;function ZI(e){var t=zI();return function(){var n=(0,le.Z)(e),i;if(t){var a=(0,le.Z)(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return(0,ze.Z)(this,i)}}function zI(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var k2=function(e){(0,ke.Z)(r,e);var t=ZI(r);function r(){var n;(0,ue.Z)(this,r);for(var i=arguments.length,a=new Array(i),s=0;s<i;s++)a[s]=arguments[s];return n=t.call.apply(t,[this].concat(a)),(0,ve.Z)((0,St.Z)(n),"type","MaskLayer"),n}return(0,_e.Z)(r,[{key:"buildModels",value:function(){var n=(0,hr.Z)(it().mark(function a(){var s;return it().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return s=this.getModelType(),this.layerModel=new UI[s](this),p.next=4,this.initLayerModels();case 4:case"end":return p.stop()}},a,this)}));function i(){return n.apply(this,arguments)}return i}()},{key:"getModelType",value:function(){return"fill"}}]),r}(fp),U2,Z2,z2,G2,sg,V2,H2,GI=Fn.cloneDeep,VI=(U2=(0,Tt.b2)(),Z2=(0,Tt.f3)(xt.IMapService),z2=(0,Tt.f3)(xt.IFontService),U2(G2=(sg=function(){function e(){(0,ue.Z)(this,e),fa(this,"mapService",V2,this),fa(this,"fontService",H2,this)}return(0,_e.Z)(e,[{key:"apply",value:function(r,n){var i=this,a=n.styleAttributeService;r.hooks.init.tapPromise("DataMappingPlugin",(0,hr.Z)(it().mark(function s(){return it().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:r.log(du.MappingStart,xu.INIT),i.generateMaping(r,{styleAttributeService:a}),r.log(du.MappingEnd,xu.INIT);case 3:case"end":return p.stop()}},s)}))),r.hooks.beforeRenderData.tapPromise("DataMappingPlugin",function(){var s=(0,hr.Z)(it().mark(function l(p){var m;return it().wrap(function(R){for(;;)switch(R.prev=R.next){case 0:if(p){R.next=2;break}return R.abrupt("return",p);case 2:return r.dataState.dataMappingNeedUpdate=!1,r.log(du.MappingStart,xu.UPDATE),m=i.generateMaping(r,{styleAttributeService:a}),r.log(du.MappingEnd,xu.UPDATE),R.abrupt("return",m);case 7:case"end":return R.stop()}},l)}));return function(l){return s.apply(this,arguments)}}()),r.hooks.beforeRender.tap("DataMappingPlugin",function(){var s=r.getSource();if(!(r.layerModelNeedUpdate||!s||!s.inited)){var l=a.getLayerStyleAttributes()||[],p=a.getLayerStyleAttribute("filter"),m=s.data.dataArray;if(!(Array.isArray(m)&&m.length===0)){var T=l.filter(function(z){return z.needRemapping}),R=m;if(p!=null&&p.needRemapping&&p!==null&&p!==void 0&&p.scale&&(R=m.filter(function(z){return i.applyAttributeMapping(p,z)[0]})),T.length){var L=i.mapping(r,T,R,r.getEncodedData());r.setEncodedData(L)}}}})}},{key:"generateMaping",value:function(r,n){var i=this,a=n.styleAttributeService,s=a.getLayerStyleAttributes()||[],l=a.getLayerStyleAttribute("filter"),p=r.getSource().data.dataArray,m=p;l!=null&&l.scale&&(m=p.filter(function(R){return i.applyAttributeMapping(l,R)[0]})),m=r.processData(m);var T=this.mapping(r,s,m,void 0);return r.setEncodedData(T),p.length===0&&r.encodeDataLength===0?!1:(r.emit("dataUpdate",null),!0)}},{key:"mapping",value:function(r,n,i,a){var s=this,l=n.filter(function(m){return m.scale!==void 0}).filter(function(m){return m.name!=="filter"}),p=i.map(function(m,T){var R=a?a[T]:{},L=(0,Q.Z)({id:m._id,coordinates:m.coordinates},R);return l.forEach(function(z){var re=s.applyAttributeMapping(z,m);(z.name==="color"||z.name==="stroke")&&(re=re.map(function(ee){return Qi(ee)})),L[z.name]=Array.isArray(re)&&re.length===1?re[0]:re,z.name==="shape"&&(L.shape=s.fontService.getIconFontKey(L[z.name]))}),L});return n.forEach(function(m){m.needRemapping=!1}),this.adjustData2Amap2Coordinates(p,r),this.adjustData2SimpleCoordinates(p),p}},{key:"adjustData2Amap2Coordinates",value:function(r,n){var i=this;if(r.length>0&&this.mapService.version==="GAODE2.x"){var a=n.coordCenter||n.getSource().center;r.filter(function(s){return!s.originCoordinates}).map(function(s){s.version="GAODE2.x",s.originCoordinates=GI(s.coordinates),s.coordinates=i.mapService.coordToAMap2RelativeCoordinates(s.coordinates,a)})}}},{key:"adjustData2SimpleCoordinates",value:function(r){var n=this;r.length>0&&this.mapService.version==="SIMPLE"&&r.map(function(i){i.simpleCoordinate||(i.coordinates=n.unProjectCoordinates(i.coordinates),i.simpleCoordinate=!0)})}},{key:"unProjectCoordinates",value:function(r){var n=this;if(typeof r[0]=="number")return this.mapService.simpleMapCoord.unproject(r);if(r[0]&&r[0][0]instanceof Array){var i=[];return r.map(function(s){var l=[];s.map(function(p){l.push(n.mapService.simpleMapCoord.unproject(p))}),i.push(l)}),i}else{var a=[];return r.map(function(s){a.push(n.mapService.simpleMapCoord.unproject(s))}),a}}},{key:"applyAttributeMapping",value:function(r,n){var i;if(!r.scale)return[];var a=(r==null||(i=r.scale)===null||i===void 0?void 0:i.scalers)||[],s=[];a.forEach(function(p){var m,T=p.field;(n.hasOwnProperty(T)||((m=r.scale)===null||m===void 0?void 0:m.type)==="variable")&&s.push(n[T])});var l=r.mapping?r.mapping(s):[];return l}},{key:"getArrowPoints",value:function(r,n){var i=[n[0]-r[0],n[1]-r[1]],a=of(i),s=[r[0]+a[0]*1e-4,r[1]+a[1]*1e-4];return s}}]),e}(),V2=Ji(sg.prototype,"mapService",[Z2],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),H2=Ji(sg.prototype,"fontService",[z2],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),sg))||G2),W2,j2,HI=(W2=(0,Tt.b2)(),W2(j2=function(){function e(){(0,ue.Z)(this,e)}return(0,_e.Z)(e,[{key:"apply",value:function(r){var n=this;this.mapService=r.getContainer().get(xt.IMapService),r.hooks.init.tapPromise("DataSourcePlugin",(0,hr.Z)(it().mark(function i(){var a,s,l,p;return it().wrap(function(T){for(;;)switch(T.prev=T.next){case 0:if(r.log(du.SourceInitStart,xu.INIT),a=r.getSource(),a||(s=r.sourceOption||r.defaultSourceConfig,l=s.data,p=s.options,a=new R1(l,p),r.setSource(a)),!a.inited){T.next=8;break}n.updateClusterData(r),r.log(du.SourceInitEnd,xu.INIT),T.next=10;break;case 8:return T.next=10,new Promise(function(R){a.on("update",function(L){L.type==="inited"&&(n.updateClusterData(r),r.log(du.SourceInitEnd,xu.INIT)),R(null)})});case 10:case"end":return T.stop()}},i)}))),r.hooks.beforeRenderData.tapPromise("DataSourcePlugin",(0,hr.Z)(it().mark(function i(){var a,s,l;return it().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return a=n.updateClusterData(r),s=r.dataState.dataSourceNeedUpdate,r.dataState.dataSourceNeedUpdate=!1,l=a||s,m.abrupt("return",l);case 5:case"end":return m.stop()}},i)})))}},{key:"updateClusterData",value:function(r){if(r.isTileLayer||r.tileLayer||!r.getSource())return!1;var n=r.getSource(),i=n.cluster,a=n.clusterOptions.zoom,s=a===void 0?0:a,l=this.mapService.getZoom()-1,p=r.dataState.dataSourceNeedUpdate;return i&&p&&n.updateClusterData(Math.floor(l)),i&&Math.abs(r.clusterZoom-l)>=1?(s!==Math.floor(l)&&n.updateClusterData(Math.floor(l)),r.clusterZoom=l,!0):!1}}]),e}())||j2),yl=C(57965);function X2(e,t,r,n,i){var a=e*e,s=a*e;return((1-3*e+3*a-s)*t+(4-6*a+3*s)*r+(1+3*e+3*a-3*s)*n+s*i)/6}function WI(e){var t=e.length-1;return function(r){var n=r<=0?r=0:r>=1?(r=1,t-1):Math.floor(r*t),i=e[n],a=e[n+1],s=n>0?e[n-1]:2*i-a,l=n<t-1?e[n+2]:2*a-i;return X2((r-n/t)*t,s,i,a,l)}}function jI(e){var t=e.length;return function(r){var n=Math.floor(((r%=1)<0?++r:r)*t),i=e[(n+t-1)%t],a=e[n%t],s=e[(n+1)%t],l=e[(n+2)%t];return X2((r-n/t)*t,i,a,s,l)}}function o_(e){return function(){return e}}function Y2(e,t){return function(r){return e+r*t}}function XI(e,t,r){return e=Math.pow(e,r),t=Math.pow(t,r)-e,r=1/r,function(n){return Math.pow(e+n*t,r)}}function TL(e,t){var r=t-e;return r?Y2(e,r>180||r<-180?r-360*Math.round(r/360):r):constant(isNaN(e)?t:e)}function YI(e){return(e=+e)==1?$2:function(t,r){return r-t?XI(t,r,e):o_(isNaN(t)?r:t)}}function $2(e,t){var r=t-e;return r?Y2(e,r):o_(isNaN(e)?t:e)}var Q2=function e(t){var r=YI(t);function n(i,a){var s=r((i=ku(i)).r,(a=ku(a)).r),l=r(i.g,a.g),p=r(i.b,a.b),m=$2(i.opacity,a.opacity);return function(T){return i.r=s(T),i.g=l(T),i.b=p(T),i.opacity=m(T),i+""}}return n.gamma=e,n}(1);function q2(e){return function(t){var r=t.length,n=new Array(r),i=new Array(r),a=new Array(r),s,l;for(s=0;s<r;++s)l=ku(t[s]),n[s]=l.r||0,i[s]=l.g||0,a[s]=l.b||0;return n=e(n),i=e(i),a=e(a),l.opacity=1,function(p){return l.r=n(p),l.g=i(p),l.b=a(p),l+""}}}var $I=q2(WI),CL=q2(jI),Mf="$";function ug(){}ug.prototype=K2.prototype={constructor:ug,has:function(e){return Mf+e in this},get:function(e){return this[Mf+e]},set:function(e,t){return this[Mf+e]=t,this},remove:function(e){var t=Mf+e;return t in this&&delete this[t]},clear:function(){for(var e in this)e[0]===Mf&&delete this[e]},keys:function(){var e=[];for(var t in this)t[0]===Mf&&e.push(t.slice(1));return e},values:function(){var e=[];for(var t in this)t[0]===Mf&&e.push(this[t]);return e},entries:function(){var e=[];for(var t in this)t[0]===Mf&&e.push({key:t.slice(1),value:this[t]});return e},size:function(){var e=0;for(var t in this)t[0]===Mf&&++e;return e},empty:function(){for(var e in this)if(e[0]===Mf)return!1;return!0},each:function(e){for(var t in this)t[0]===Mf&&e(this[t],t.slice(1),this)}};function K2(e,t){var r=new ug;if(e instanceof ug)e.each(function(l,p){r.set(p,l)});else if(Array.isArray(e)){var n=-1,i=e.length,a;if(t==null)for(;++n<i;)r.set(n,e[n]);else for(;++n<i;)r.set(t(a=e[n],n,e),a)}else if(e)for(var s in e)r.set(s,e[s]);return r}var s_=K2;function bL(){var e=[],t=[],r,n,i;function a(l,p,m,T){if(p>=e.length)return r!=null&&l.sort(r),n!=null?n(l):l;for(var R=-1,L=l.length,z=e[p++],re,ee,me=map(),Ie,He=m();++R<L;)(Ie=me.get(re=z(ee=l[R])+""))?Ie.push(ee):me.set(re,[ee]);return me.each(function(Xe,ot){T(He,ot,a(Xe,p,m,T))}),He}function s(l,p){if(++p>e.length)return l;var m,T=t[p-1];return n!=null&&p>=e.length?m=l.entries():(m=[],l.each(function(R,L){m.push({key:L,values:s(R,p)})})),T!=null?m.sort(function(R,L){return T(R.key,L.key)}):m}return i={object:function(l){return a(l,0,QI,qI)},map:function(l){return a(l,0,J2,eE)},entries:function(l){return s(a(l,0,J2,eE),0)},key:function(l){return e.push(l),i},sortKeys:function(l){return t[e.length-1]=l,i},sortValues:function(l){return r=l,i},rollup:function(l){return n=l,i}}}function QI(){return{}}function qI(e,t,r){e[t]=r}function J2(){return map()}function eE(e,t,r){e.set(t,r)}function lg(){}var cA=s_.prototype;lg.prototype=KI.prototype={constructor:lg,has:cA.has,add:function(e){return e+="",this[Mf+e]=e,this},remove:cA.remove,clear:cA.clear,values:cA.keys,size:cA.size,empty:cA.empty,each:cA.each};function KI(e,t){var r=new lg;if(e instanceof lg)e.each(function(a){r.add(a)});else if(e){var n=-1,i=e.length;if(t==null)for(;++n<i;)r.add(e[n]);else for(;++n<i;)r.add(t(e[n],n,e))}return r}var RL=null,tE=Array.prototype,rE=tE.map,fA=tE.slice;function Ch(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e);break}return this}function nE(e,t){switch(arguments.length){case 0:break;case 1:this.interpolator(e);break;default:this.interpolator(t).domain(e);break}return this}var iE={name:"implicit"};function cg(){var e=s_(),t=[],r=[],n=iE;function i(a){var s=a+"",l=e.get(s);if(!l){if(n!==iE)return n;e.set(s,l=t.push(a))}return r[(l-1)%r.length]}return i.domain=function(a){if(!arguments.length)return t.slice();t=[],e=s_();for(var s=-1,l=a.length,p,m;++s<l;)e.has(m=(p=a[s])+"")||e.set(m,t.push(p));return i},i.range=function(a){return arguments.length?(r=fA.call(a),i):r.slice()},i.unknown=function(a){return arguments.length?(n=a,i):n},i.copy=function(){return cg(t,r).unknown(n)},Ch.apply(i,arguments),i}function aE(){var e=ordinal().unknown(void 0),t=e.domain,r=e.range,n=[0,1],i,a,s=!1,l=0,p=0,m=.5;delete e.unknown;function T(){var R=t().length,L=n[1]<n[0],z=n[L-0],re=n[1-L];i=(re-z)/Math.max(1,R-l+p*2),s&&(i=Math.floor(i)),z+=(re-z-i*(R-l))*m,a=i*(1-l),s&&(z=Math.round(z),a=Math.round(a));var ee=sequence(R).map(function(me){return z+i*me});return r(L?ee.reverse():ee)}return e.domain=function(R){return arguments.length?(t(R),T()):t()},e.range=function(R){return arguments.length?(n=[+R[0],+R[1]],T()):n.slice()},e.rangeRound=function(R){return n=[+R[0],+R[1]],s=!0,T()},e.bandwidth=function(){return a},e.step=function(){return i},e.round=function(R){return arguments.length?(s=!!R,T()):s},e.padding=function(R){return arguments.length?(l=Math.min(1,p=+R),T()):l},e.paddingInner=function(R){return arguments.length?(l=Math.min(1,R),T()):l},e.paddingOuter=function(R){return arguments.length?(p=+R,T()):p},e.align=function(R){return arguments.length?(m=Math.max(0,Math.min(1,R)),T()):m},e.copy=function(){return aE(t(),n).round(s).paddingInner(l).paddingOuter(p).align(m)},initRange.apply(T(),arguments)}function oE(e){var t=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,delete e.paddingOuter,e.copy=function(){return oE(t())},e}function ML(){return oE(aE.apply(null,arguments).paddingInner(1))}function wL(e,t){return(isNumberArray(t)?numberArray:sE)(e,t)}function sE(e,t){var r=t?t.length:0,n=e?Math.min(r,e.length):0,i=new Array(n),a=new Array(r),s;for(s=0;s<n;++s)i[s]=c_(e[s],t[s]);for(;s<r;++s)a[s]=t[s];return function(l){for(s=0;s<n;++s)a[s]=i[s](l);return a}}function JI(e,t){var r=new Date;return e=+e,t=+t,function(n){return r.setTime(e*(1-n)+t*n),r}}function fg(e,t){return e=+e,t=+t,function(r){return e*(1-r)+t*r}}function e4(e,t){var r={},n={},i;(e===null||typeof e!="object")&&(e={}),(t===null||typeof t!="object")&&(t={});for(i in t)i in e?r[i]=c_(e[i],t[i]):n[i]=t[i];return function(a){for(i in r)n[i]=r[i](a);return n}}var u_=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,l_=new RegExp(u_.source,"g");function t4(e){return function(){return e}}function r4(e){return function(t){return e(t)+""}}function n4(e,t){var r=u_.lastIndex=l_.lastIndex=0,n,i,a,s=-1,l=[],p=[];for(e=e+"",t=t+"";(n=u_.exec(e))&&(i=l_.exec(t));)(a=i.index)>r&&(a=t.slice(r,a),l[s]?l[s]+=a:l[++s]=a),(n=n[0])===(i=i[0])?l[s]?l[s]+=i:l[++s]=i:(l[++s]=null,p.push({i:s,x:fg(n,i)})),r=l_.lastIndex;return r<t.length&&(a=t.slice(r),l[s]?l[s]+=a:l[++s]=a),l.length<2?p[0]?r4(p[0].x):t4(t):(t=p.length,function(m){for(var T=0,R;T<t;++T)l[(R=p[T]).i]=R.x(m);return l.join("")})}function i4(e,t){t||(t=[]);var r=e?Math.min(t.length,e.length):0,n=t.slice(),i;return function(a){for(i=0;i<r;++i)n[i]=e[i]*(1-a)+t[i]*a;return n}}function a4(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function c_(e,t){var r=typeof t,n;return t==null||r==="boolean"?o_(t):(r==="number"?fg:r==="string"?(n=Bo(t))?(t=n,Q2):n4:t instanceof Bo?Q2:t instanceof Date?JI:a4(t)?i4:Array.isArray(t)?sE:typeof t.valueOf!="function"&&typeof t.toString!="function"||isNaN(t)?e4:fg)(e,t)}function o4(e,t){return e=+e,t=+t,function(r){return Math.round(e*(1-r)+t*r)}}function s4(e){return function(){return e}}function u4(e){return+e}var uE=[0,1];function Zl(e){return e}function f_(e,t){return(t-=e=+e)?function(r){return(r-e)/t}:s4(isNaN(t)?NaN:.5)}function lE(e){var t=e[0],r=e[e.length-1],n;return t>r&&(n=t,t=r,r=n),function(i){return Math.max(t,Math.min(r,i))}}function l4(e,t,r){var n=e[0],i=e[1],a=t[0],s=t[1];return i<n?(n=f_(i,n),a=r(s,a)):(n=f_(n,i),a=r(a,s)),function(l){return a(n(l))}}function c4(e,t,r){var n=Math.min(e.length,t.length)-1,i=new Array(n),a=new Array(n),s=-1;for(e[n]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++s<n;)i[s]=f_(e[s],e[s+1]),a[s]=r(t[s],t[s+1]);return function(l){var p=(0,yl.b4)(e,l,1,n)-1;return a[p](i[p](l))}}function hg(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function h_(){var e=uE,t=uE,r=c_,n,i,a,s=Zl,l,p,m;function T(){return l=Math.min(e.length,t.length)>2?c4:l4,p=m=null,R}function R(L){return isNaN(L=+L)?a:(p||(p=l(e.map(n),t,r)))(n(s(L)))}return R.invert=function(L){return s(i((m||(m=l(t,e.map(n),fg)))(L)))},R.domain=function(L){return arguments.length?(e=rE.call(L,u4),s===Zl||(s=lE(e)),T()):e.slice()},R.range=function(L){return arguments.length?(t=fA.call(L),T()):t.slice()},R.rangeRound=function(L){return t=fA.call(L),r=o4,T()},R.clamp=function(L){return arguments.length?(s=L?lE(e):Zl,R):s!==Zl},R.interpolate=function(L){return arguments.length?(r=L,T()):r},R.unknown=function(L){return arguments.length?(a=L,R):a},function(L,z){return n=L,i=z,T()}}function cE(e,t){return h_()(e,t)}var f4=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function Ag(e){if(!(t=f4.exec(e)))throw new Error("invalid format: "+e);var t;return new A_({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}Ag.prototype=A_.prototype;function A_(e){this.fill=e.fill===void 0?" ":e.fill+"",this.align=e.align===void 0?">":e.align+"",this.sign=e.sign===void 0?"-":e.sign+"",this.symbol=e.symbol===void 0?"":e.symbol+"",this.zero=!!e.zero,this.width=e.width===void 0?void 0:+e.width,this.comma=!!e.comma,this.precision=e.precision===void 0?void 0:+e.precision,this.trim=!!e.trim,this.type=e.type===void 0?"":e.type+""}A_.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function h4(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)}function pg(e,t){if((r=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var r,n=e.slice(0,r);return[n.length>1?n[0]+n.slice(2):n,+e.slice(r+1)]}function gp(e){return e=pg(Math.abs(e)),e?e[1]:NaN}function A4(e,t){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(gp(t)/3)))*3-gp(Math.abs(e)))}function p4(e,t){return function(r,n){for(var i=r.length,a=[],s=0,l=e[0],p=0;i>0&&l>0&&(p+l+1>n&&(l=Math.max(1,n-p)),a.push(r.substring(i-=l,i+l)),!((p+=l+1)>n));)l=e[s=(s+1)%e.length];return a.reverse().join(t)}}function d4(e){return function(t){return t.replace(/[0-9]/g,function(r){return e[+r]})}}function v4(e){e:for(var t=e.length,r=1,n=-1,i;r<t;++r)switch(e[r]){case".":n=i=r;break;case"0":n===0&&(n=r),i=r;break;default:if(!+e[r])break e;n>0&&(n=0);break}return n>0?e.slice(0,n)+e.slice(i+1):e}var fE;function g4(e,t){var r=pg(e,t);if(!r)return e+"";var n=r[0],i=r[1],a=i-(fE=Math.max(-8,Math.min(8,Math.floor(i/3)))*3)+1,s=n.length;return a===s?n:a>s?n+new Array(a-s+1).join("0"):a>0?n.slice(0,a)+"."+n.slice(a):"0."+new Array(1-a).join("0")+pg(e,Math.max(0,t+a-1))[0]}function hE(e,t){var r=pg(e,t);if(!r)return e+"";var n=r[0],i=r[1];return i<0?"0."+new Array(-i).join("0")+n:n.length>i+1?n.slice(0,i+1)+"."+n.slice(i+1):n+new Array(i-n.length+2).join("0")}var AE={"%":function(e,t){return(e*100).toFixed(t)},b:function(e){return Math.round(e).toString(2)},c:function(e){return e+""},d:h4,e:function(e,t){return e.toExponential(t)},f:function(e,t){return e.toFixed(t)},g:function(e,t){return e.toPrecision(t)},o:function(e){return Math.round(e).toString(8)},p:function(e,t){return hE(e*100,t)},r:hE,s:g4,X:function(e){return Math.round(e).toString(16).toUpperCase()},x:function(e){return Math.round(e).toString(16)}};function pE(e){return e}var dE=Array.prototype.map,vE=["y","z","a","f","p","n","\xB5","m","","k","M","G","T","P","E","Z","Y"];function m4(e){var t=e.grouping===void 0||e.thousands===void 0?pE:p4(dE.call(e.grouping,Number),e.thousands+""),r=e.currency===void 0?"":e.currency[0]+"",n=e.currency===void 0?"":e.currency[1]+"",i=e.decimal===void 0?".":e.decimal+"",a=e.numerals===void 0?pE:d4(dE.call(e.numerals,String)),s=e.percent===void 0?"%":e.percent+"",l=e.minus===void 0?"-":e.minus+"",p=e.nan===void 0?"NaN":e.nan+"";function m(R){R=Ag(R);var L=R.fill,z=R.align,re=R.sign,ee=R.symbol,me=R.zero,Ie=R.width,He=R.comma,Xe=R.precision,ot=R.trim,pt=R.type;pt==="n"?(He=!0,pt="g"):AE[pt]||(Xe===void 0&&(Xe=12),ot=!0,pt="g"),(me||L==="0"&&z==="=")&&(me=!0,L="0",z="=");var dt=ee==="$"?r:ee==="#"&&/[boxX]/.test(pt)?"0"+pt.toLowerCase():"",It=ee==="$"?n:/[%p]/.test(pt)?s:"",Vt=AE[pt],Kt=/[defgprs%]/.test(pt);Xe=Xe===void 0?6:/[gprs]/.test(pt)?Math.max(1,Math.min(21,Xe)):Math.max(0,Math.min(20,Xe));function yr(_r){var Hr=dt,nn=It,Tn,sa,Fo;if(pt==="c")nn=Vt(_r)+nn,_r="";else{_r=+_r;var jo=_r<0||1/_r<0;if(_r=isNaN(_r)?p:Vt(Math.abs(_r),Xe),ot&&(_r=v4(_r)),jo&&+_r==0&&re!=="+"&&(jo=!1),Hr=(jo?re==="("?re:l:re==="-"||re==="("?"":re)+Hr,nn=(pt==="s"?vE[8+fE/3]:"")+nn+(jo&&re==="("?")":""),Kt){for(Tn=-1,sa=_r.length;++Tn<sa;)if(Fo=_r.charCodeAt(Tn),48>Fo||Fo>57){nn=(Fo===46?i+_r.slice(Tn+1):_r.slice(Tn))+nn,_r=_r.slice(0,Tn);break}}}He&&!me&&(_r=t(_r,1/0));var As=Hr.length+_r.length+nn.length,vu=As<Ie?new Array(Ie-As+1).join(L):"";switch(He&&me&&(_r=t(vu+_r,vu.length?Ie-nn.length:1/0),vu=""),z){case"<":_r=Hr+_r+nn+vu;break;case"=":_r=Hr+vu+_r+nn;break;case"^":_r=vu.slice(0,As=vu.length>>1)+Hr+_r+nn+vu.slice(As);break;default:_r=vu+Hr+_r+nn;break}return a(_r)}return yr.toString=function(){return R+""},yr}function T(R,L){var z=m((R=Ag(R),R.type="f",R)),re=Math.max(-8,Math.min(8,Math.floor(gp(L)/3)))*3,ee=Math.pow(10,-re),me=vE[8+re/3];return function(Ie){return z(ee*Ie)+me}}return{format:m,formatPrefix:T}}var dg,p_,gE;_4({decimal:".",thousands:",",grouping:[3],currency:["$",""],minus:"-"});function _4(e){return dg=m4(e),p_=dg.format,gE=dg.formatPrefix,dg}function y4(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,gp(t)-gp(e))+1}function E4(e){return Math.max(0,-gp(Math.abs(e)))}function S4(e,t,r,n){var i=(0,yl.ly)(e,t,r),a;switch(n=Ag(n==null?",f":n),n.type){case"s":{var s=Math.max(Math.abs(e),Math.abs(t));return n.precision==null&&!isNaN(a=A4(i,s))&&(n.precision=a),gE(n,s)}case"":case"e":case"g":case"p":case"r":{n.precision==null&&!isNaN(a=y4(i,Math.max(Math.abs(e),Math.abs(t))))&&(n.precision=a-(n.type==="e"));break}case"f":case"%":{n.precision==null&&!isNaN(a=E4(i))&&(n.precision=a-(n.type==="%")*2);break}}return p_(n)}function yd(e){var t=e.domain;return e.ticks=function(r){var n=t();return(0,yl.sd)(n[0],n[n.length-1],r==null?10:r)},e.tickFormat=function(r,n){var i=t();return S4(i[0],i[i.length-1],r==null?10:r,n)},e.nice=function(r){r==null&&(r=10);var n=t(),i=0,a=n.length-1,s=n[i],l=n[a],p;return l<s&&(p=s,s=l,l=p,p=i,i=a,a=p),p=(0,yl.G9)(s,l,r),p>0?(s=Math.floor(s/p)*p,l=Math.ceil(l/p)*p,p=(0,yl.G9)(s,l,r)):p<0&&(s=Math.ceil(s*p)/p,l=Math.floor(l*p)/p,p=(0,yl.G9)(s,l,r)),p>0?(n[i]=Math.floor(s/p)*p,n[a]=Math.ceil(l/p)*p,t(n)):p<0&&(n[i]=Math.ceil(s*p)/p,n[a]=Math.floor(l*p)/p,t(n)),e},e}function mE(){var e=cE(Zl,Zl);return e.copy=function(){return hg(e,mE())},Ch.apply(e,arguments),yd(e)}function x4(e){var t;function r(n){return isNaN(n=+n)?t:n}return r.invert=r,r.domain=r.range=function(n){return arguments.length?(e=map.call(n,number),r):e.slice()},r.unknown=function(n){return arguments.length?(t=n,r):t},r.copy=function(){return x4(e).unknown(t)},e=arguments.length?map.call(e,number):[0,1],linearish(r)}function _E(e,t){e=e.slice();var r=0,n=e.length-1,i=e[r],a=e[n],s;return a<i&&(s=r,r=n,n=s,s=i,i=a,a=s),e[r]=t.floor(i),e[n]=t.ceil(a),e}function yE(e){return Math.log(e)}function EE(e){return Math.exp(e)}function T4(e){return-Math.log(-e)}function C4(e){return-Math.exp(-e)}function b4(e){return isFinite(e)?+("1e"+e):e<0?0:e}function R4(e){return e===10?b4:e===Math.E?Math.exp:function(t){return Math.pow(e,t)}}function M4(e){return e===Math.E?Math.log:e===10&&Math.log10||e===2&&Math.log2||(e=Math.log(e),function(t){return Math.log(t)/e})}function SE(e){return function(t){return-e(-t)}}function w4(e){var t=e(yE,EE),r=t.domain,n=10,i,a;function s(){return i=M4(n),a=R4(n),r()[0]<0?(i=SE(i),a=SE(a),e(T4,C4)):e(yE,EE),t}return t.base=function(l){return arguments.length?(n=+l,s()):n},t.domain=function(l){return arguments.length?(r(l),s()):r()},t.ticks=function(l){var p=r(),m=p[0],T=p[p.length-1],R;(R=T<m)&&(L=m,m=T,T=L);var L=i(m),z=i(T),re,ee,me,Ie=l==null?10:+l,He=[];if(!(n%1)&&z-L<Ie){if(L=Math.round(L)-1,z=Math.round(z)+1,m>0){for(;L<z;++L)for(ee=1,re=a(L);ee<n;++ee)if(me=re*ee,!(me<m)){if(me>T)break;He.push(me)}}else for(;L<z;++L)for(ee=n-1,re=a(L);ee>=1;--ee)if(me=re*ee,!(me<m)){if(me>T)break;He.push(me)}}else He=(0,yl.sd)(L,z,Math.min(z-L,Ie)).map(a);return R?He.reverse():He},t.tickFormat=function(l,p){if(p==null&&(p=n===10?".0e":","),typeof p!="function"&&(p=p_(p)),l===1/0)return p;l==null&&(l=10);var m=Math.max(1,n*l/t.ticks().length);return function(T){var R=T/a(Math.round(i(T)));return R*n<n-.5&&(R*=n),R<=m?p(T):""}},t.nice=function(){return r(_E(r(),{floor:function(l){return a(Math.floor(i(l)))},ceil:function(l){return a(Math.ceil(i(l)))}}))},t}function xE(){var e=w4(h_()).domain([1,10]);return e.copy=function(){return hg(e,xE()).base(e.base())},Ch.apply(e,arguments),e}function TE(e){return function(t){return Math.sign(t)*Math.log1p(Math.abs(t/e))}}function CE(e){return function(t){return Math.sign(t)*Math.expm1(Math.abs(t))*e}}function I4(e){var t=1,r=e(TE(t),CE(t));return r.constant=function(n){return arguments.length?e(TE(t=+n),CE(t)):t},linearish(r)}function P4(){var e=I4(transformer());return e.copy=function(){return copy(e,P4()).constant(e.constant())},initRange.apply(e,arguments)}function bE(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function O4(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function N4(e){return e<0?-e*e:e*e}function D4(e){var t=e(Zl,Zl),r=1;function n(){return r===1?e(Zl,Zl):r===.5?e(O4,N4):e(bE(r),bE(1/r))}return t.exponent=function(i){return arguments.length?(r=+i,n()):r},yd(t)}function d_(){var e=D4(h_());return e.copy=function(){return hg(e,d_()).exponent(e.exponent())},Ch.apply(e,arguments),e}function IL(){return d_.apply(null,arguments).exponent(.5)}function RE(){var e=[],t=[],r=[],n;function i(){var s=0,l=Math.max(1,t.length);for(r=new Array(l-1);++s<l;)r[s-1]=(0,yl.VR)(e,s/l);return a}function a(s){return isNaN(s=+s)?n:t[(0,yl.b4)(r,s)]}return a.invertExtent=function(s){var l=t.indexOf(s);return l<0?[NaN,NaN]:[l>0?r[l-1]:e[0],l<r.length?r[l]:e[e.length-1]]},a.domain=function(s){if(!arguments.length)return e.slice();e=[];for(var l=0,p=s.length,m;l<p;++l)m=s[l],m!=null&&!isNaN(m=+m)&&e.push(m);return e.sort(yl.j2),i()},a.range=function(s){return arguments.length?(t=fA.call(s),i()):t.slice()},a.unknown=function(s){return arguments.length?(n=s,a):n},a.quantiles=function(){return r.slice()},a.copy=function(){return RE().domain(e).range(t).unknown(n)},Ch.apply(a,arguments)}function ME(){var e=0,t=1,r=1,n=[.5],i=[0,1],a;function s(p){return p<=p?i[(0,yl.b4)(n,p,0,r)]:a}function l(){var p=-1;for(n=new Array(r);++p<r;)n[p]=((p+1)*t-(p-r)*e)/(r+1);return s}return s.domain=function(p){return arguments.length?(e=+p[0],t=+p[1],l()):[e,t]},s.range=function(p){return arguments.length?(r=(i=fA.call(p)).length-1,l()):i.slice()},s.invertExtent=function(p){var m=i.indexOf(p);return m<0?[NaN,NaN]:m<1?[e,n[0]]:m>=r?[n[r-1],t]:[n[m-1],n[m]]},s.unknown=function(p){return arguments.length&&(a=p),s},s.thresholds=function(){return n.slice()},s.copy=function(){return ME().domain([e,t]).range(i).unknown(a)},Ch.apply(yd(s),arguments)}function wE(){var e=[.5],t=[0,1],r,n=1;function i(a){return a<=a?t[(0,yl.b4)(e,a,0,n)]:r}return i.domain=function(a){return arguments.length?(e=fA.call(a),n=Math.min(e.length,t.length-1),i):e.slice()},i.range=function(a){return arguments.length?(t=fA.call(a),n=Math.min(e.length,t.length-1),i):t.slice()},i.invertExtent=function(a){var s=t.indexOf(a);return[e[s-1],e[s]]},i.unknown=function(a){return arguments.length?(r=a,i):r},i.copy=function(){return wE().domain(e).range(t).unknown(r)},Ch.apply(i,arguments)}var v_=new Date,g_=new Date;function ic(e,t,r,n){function i(a){return e(a=arguments.length===0?new Date:new Date(+a)),a}return i.floor=function(a){return e(a=new Date(+a)),a},i.ceil=function(a){return e(a=new Date(a-1)),t(a,1),e(a),a},i.round=function(a){var s=i(a),l=i.ceil(a);return a-s<l-a?s:l},i.offset=function(a,s){return t(a=new Date(+a),s==null?1:Math.floor(s)),a},i.range=function(a,s,l){var p=[],m;if(a=i.ceil(a),l=l==null?1:Math.floor(l),!(a<s)||!(l>0))return p;do p.push(m=new Date(+a)),t(a,l),e(a);while(m<a&&a<s);return p},i.filter=function(a){return ic(function(s){if(s>=s)for(;e(s),!a(s);)s.setTime(s-1)},function(s,l){if(s>=s)if(l<0)for(;++l<=0;)for(;t(s,-1),!a(s););else for(;--l>=0;)for(;t(s,1),!a(s););})},r&&(i.count=function(a,s){return v_.setTime(+a),g_.setTime(+s),e(v_),e(g_),Math.floor(r(v_,g_))},i.every=function(a){return a=Math.floor(a),!isFinite(a)||!(a>0)?null:a>1?i.filter(n?function(s){return n(s)%a===0}:function(s){return i.count(0,s)%a===0}):i}),i}var m_=ic(function(e){e.setMonth(0,1),e.setHours(0,0,0,0)},function(e,t){e.setFullYear(e.getFullYear()+t)},function(e,t){return t.getFullYear()-e.getFullYear()},function(e){return e.getFullYear()});m_.every=function(e){return!isFinite(e=Math.floor(e))||!(e>0)?null:ic(function(t){t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)},function(t,r){t.setFullYear(t.getFullYear()+r*e)})};var mp=m_,PL=m_.range,IE=ic(function(e){e.setDate(1),e.setHours(0,0,0,0)},function(e,t){e.setMonth(e.getMonth()+t)},function(e,t){return t.getMonth()-e.getMonth()+(t.getFullYear()-e.getFullYear())*12},function(e){return e.getMonth()}),L4=IE,OL=IE.range,vg=1e3,Ed=6e4,PE=36e5,OE=864e5,NE=6048e5;function hA(e){return ic(function(t){t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)},function(t,r){t.setDate(t.getDate()+r*7)},function(t,r){return(r-t-(r.getTimezoneOffset()-t.getTimezoneOffset())*Ed)/NE})}var __=hA(0),gg=hA(1),F4=hA(2),B4=hA(3),_p=hA(4),k4=hA(5),U4=hA(6),NL=__.range,DL=gg.range,LL=F4.range,FL=B4.range,BL=_p.range,kL=k4.range,UL=U4.range,DE=ic(function(e){e.setHours(0,0,0,0)},function(e,t){e.setDate(e.getDate()+t)},function(e,t){return(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*Ed)/OE},function(e){return e.getDate()-1}),y_=DE,ZL=DE.range,LE=ic(function(e){e.setTime(e-e.getMilliseconds()-e.getSeconds()*vg-e.getMinutes()*Ed)},function(e,t){e.setTime(+e+t*PE)},function(e,t){return(t-e)/PE},function(e){return e.getHours()}),Z4=LE,zL=LE.range,FE=ic(function(e){e.setTime(e-e.getMilliseconds()-e.getSeconds()*vg)},function(e,t){e.setTime(+e+t*Ed)},function(e,t){return(t-e)/Ed},function(e){return e.getMinutes()}),z4=FE,GL=FE.range,BE=ic(function(e){e.setTime(e-e.getMilliseconds())},function(e,t){e.setTime(+e+t*vg)},function(e,t){return(t-e)/vg},function(e){return e.getUTCSeconds()}),G4=BE,VL=BE.range,mg=ic(function(){},function(e,t){e.setTime(+e+t)},function(e,t){return t-e});mg.every=function(e){return e=Math.floor(e),!isFinite(e)||!(e>0)?null:e>1?ic(function(t){t.setTime(Math.floor(t/e)*e)},function(t,r){t.setTime(+t+r*e)},function(t,r){return(r-t)/e}):mg};var V4=mg,HL=mg.range;function AA(e){return ic(function(t){t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)},function(t,r){t.setUTCDate(t.getUTCDate()+r*7)},function(t,r){return(r-t)/NE})}var kE=AA(0),_g=AA(1),H4=AA(2),W4=AA(3),yp=AA(4),j4=AA(5),X4=AA(6),WL=kE.range,jL=_g.range,XL=H4.range,YL=W4.range,$L=yp.range,QL=j4.range,qL=X4.range,UE=ic(function(e){e.setUTCHours(0,0,0,0)},function(e,t){e.setUTCDate(e.getUTCDate()+t)},function(e,t){return(t-e)/OE},function(e){return e.getUTCDate()-1}),ZE=UE,KL=UE.range,E_=ic(function(e){e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},function(e,t){e.setUTCFullYear(e.getUTCFullYear()+t)},function(e,t){return t.getUTCFullYear()-e.getUTCFullYear()},function(e){return e.getUTCFullYear()});E_.every=function(e){return!isFinite(e=Math.floor(e))||!(e>0)?null:ic(function(t){t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},function(t,r){t.setUTCFullYear(t.getUTCFullYear()+r*e)})};var Sd=E_,JL=E_.range;function S_(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function x_(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function xd(e,t,r){return{y:e,m:t,d:r,H:0,M:0,S:0,L:0}}function Y4(e){var t=e.dateTime,r=e.date,n=e.time,i=e.periods,a=e.days,s=e.shortDays,l=e.months,p=e.shortMonths,m=Td(i),T=Cd(i),R=Td(a),L=Cd(a),z=Td(s),re=Cd(s),ee=Td(l),me=Cd(l),Ie=Td(p),He=Cd(p),Xe={a:jo,A:As,b:vu,B:ef,c:null,d:jE,e:jE,f:gP,g:RP,G:wP,H:pP,I:dP,j:vP,L:XE,m:mP,M:_P,p:t8,q:r8,Q:JE,s:eS,S:yP,u:EP,U:SP,V:xP,w:TP,W:CP,x:null,X:null,y:bP,Y:MP,Z:IP,"%":KE},ot={a:n8,A:i8,b:a8,B:o8,c:null,d:$E,e:$E,f:DP,g:HP,G:jP,H:PP,I:OP,j:NP,L:QE,m:LP,M:FP,p:s8,q:u8,Q:JE,s:eS,S:BP,u:kP,U:UP,V:ZP,w:zP,W:GP,x:null,X:null,y:VP,Y:WP,Z:XP,"%":KE},pt={a:yr,A:_r,b:Hr,B:nn,c:Tn,d:HE,e:HE,f:cP,g:VE,G:GE,H:WE,I:WE,j:oP,L:lP,m:aP,M:sP,p:Kt,q:iP,Q:hP,s:AP,S:uP,u:J4,U:eP,V:tP,w:K4,W:rP,x:sa,X:Fo,y:VE,Y:GE,Z:nP,"%":fP};Xe.x=dt(r,Xe),Xe.X=dt(n,Xe),Xe.c=dt(t,Xe),ot.x=dt(r,ot),ot.X=dt(n,ot),ot.c=dt(t,ot);function dt(ui,Wa){return function(Ao){var dn=[],Oc=-1,ps=0,tf=ui.length,rf,SA,uT;for(Ao instanceof Date||(Ao=new Date(+Ao));++Oc<tf;)ui.charCodeAt(Oc)===37&&(dn.push(ui.slice(ps,Oc)),(SA=zE[rf=ui.charAt(++Oc)])!=null?rf=ui.charAt(++Oc):SA=rf==="e"?" ":"0",(uT=Wa[rf])&&(rf=uT(Ao,SA)),dn.push(rf),ps=Oc+1);return dn.push(ui.slice(ps,Oc)),dn.join("")}}function It(ui,Wa){return function(Ao){var dn=xd(1900,void 0,1),Oc=Vt(dn,ui,Ao+="",0),ps,tf;if(Oc!=Ao.length)return null;if("Q"in dn)return new Date(dn.Q);if("s"in dn)return new Date(dn.s*1e3+("L"in dn?dn.L:0));if(Wa&&!("Z"in dn)&&(dn.Z=0),"p"in dn&&(dn.H=dn.H%12+dn.p*12),dn.m===void 0&&(dn.m="q"in dn?dn.q:0),"V"in dn){if(dn.V<1||dn.V>53)return null;"w"in dn||(dn.w=1),"Z"in dn?(ps=x_(xd(dn.y,0,1)),tf=ps.getUTCDay(),ps=tf>4||tf===0?_g.ceil(ps):_g(ps),ps=ZE.offset(ps,(dn.V-1)*7),dn.y=ps.getUTCFullYear(),dn.m=ps.getUTCMonth(),dn.d=ps.getUTCDate()+(dn.w+6)%7):(ps=S_(xd(dn.y,0,1)),tf=ps.getDay(),ps=tf>4||tf===0?gg.ceil(ps):gg(ps),ps=y_.offset(ps,(dn.V-1)*7),dn.y=ps.getFullYear(),dn.m=ps.getMonth(),dn.d=ps.getDate()+(dn.w+6)%7)}else("W"in dn||"U"in dn)&&("w"in dn||(dn.w="u"in dn?dn.u%7:"W"in dn?1:0),tf="Z"in dn?x_(xd(dn.y,0,1)).getUTCDay():S_(xd(dn.y,0,1)).getDay(),dn.m=0,dn.d="W"in dn?(dn.w+6)%7+dn.W*7-(tf+5)%7:dn.w+dn.U*7-(tf+6)%7);return"Z"in dn?(dn.H+=dn.Z/100|0,dn.M+=dn.Z%100,x_(dn)):S_(dn)}}function Vt(ui,Wa,Ao,dn){for(var Oc=0,ps=Wa.length,tf=Ao.length,rf,SA;Oc<ps;){if(dn>=tf)return-1;if(rf=Wa.charCodeAt(Oc++),rf===37){if(rf=Wa.charAt(Oc++),SA=pt[rf in zE?Wa.charAt(Oc++):rf],!SA||(dn=SA(ui,Ao,dn))<0)return-1}else if(rf!=Ao.charCodeAt(dn++))return-1}return dn}function Kt(ui,Wa,Ao){var dn=m.exec(Wa.slice(Ao));return dn?(ui.p=T[dn[0].toLowerCase()],Ao+dn[0].length):-1}function yr(ui,Wa,Ao){var dn=z.exec(Wa.slice(Ao));return dn?(ui.w=re[dn[0].toLowerCase()],Ao+dn[0].length):-1}function _r(ui,Wa,Ao){var dn=R.exec(Wa.slice(Ao));return dn?(ui.w=L[dn[0].toLowerCase()],Ao+dn[0].length):-1}function Hr(ui,Wa,Ao){var dn=Ie.exec(Wa.slice(Ao));return dn?(ui.m=He[dn[0].toLowerCase()],Ao+dn[0].length):-1}function nn(ui,Wa,Ao){var dn=ee.exec(Wa.slice(Ao));return dn?(ui.m=me[dn[0].toLowerCase()],Ao+dn[0].length):-1}function Tn(ui,Wa,Ao){return Vt(ui,t,Wa,Ao)}function sa(ui,Wa,Ao){return Vt(ui,r,Wa,Ao)}function Fo(ui,Wa,Ao){return Vt(ui,n,Wa,Ao)}function jo(ui){return s[ui.getDay()]}function As(ui){return a[ui.getDay()]}function vu(ui){return p[ui.getMonth()]}function ef(ui){return l[ui.getMonth()]}function t8(ui){return i[+(ui.getHours()>=12)]}function r8(ui){return 1+~~(ui.getMonth()/3)}function n8(ui){return s[ui.getUTCDay()]}function i8(ui){return a[ui.getUTCDay()]}function a8(ui){return p[ui.getUTCMonth()]}function o8(ui){return l[ui.getUTCMonth()]}function s8(ui){return i[+(ui.getUTCHours()>=12)]}function u8(ui){return 1+~~(ui.getUTCMonth()/3)}return{format:function(ui){var Wa=dt(ui+="",Xe);return Wa.toString=function(){return ui},Wa},parse:function(ui){var Wa=It(ui+="",!1);return Wa.toString=function(){return ui},Wa},utcFormat:function(ui){var Wa=dt(ui+="",ot);return Wa.toString=function(){return ui},Wa},utcParse:function(ui){var Wa=It(ui+="",!0);return Wa.toString=function(){return ui},Wa}}}var zE={"-":"",_:" ",0:"0"},nl=/^\s*\d+/,$4=/^%/,Q4=/[\\^$*+?|[\]().{}]/g;function ho(e,t,r){var n=e<0?"-":"",i=(n?-e:e)+"",a=i.length;return n+(a<r?new Array(r-a+1).join(t)+i:i)}function q4(e){return e.replace(Q4,"\\$&")}function Td(e){return new RegExp("^(?:"+e.map(q4).join("|")+")","i")}function Cd(e){for(var t={},r=-1,n=e.length;++r<n;)t[e[r].toLowerCase()]=r;return t}function K4(e,t,r){var n=nl.exec(t.slice(r,r+1));return n?(e.w=+n[0],r+n[0].length):-1}function J4(e,t,r){var n=nl.exec(t.slice(r,r+1));return n?(e.u=+n[0],r+n[0].length):-1}function eP(e,t,r){var n=nl.exec(t.slice(r,r+2));return n?(e.U=+n[0],r+n[0].length):-1}function tP(e,t,r){var n=nl.exec(t.slice(r,r+2));return n?(e.V=+n[0],r+n[0].length):-1}function rP(e,t,r){var n=nl.exec(t.slice(r,r+2));return n?(e.W=+n[0],r+n[0].length):-1}function GE(e,t,r){var n=nl.exec(t.slice(r,r+4));return n?(e.y=+n[0],r+n[0].length):-1}function VE(e,t,r){var n=nl.exec(t.slice(r,r+2));return n?(e.y=+n[0]+(+n[0]>68?1900:2e3),r+n[0].length):-1}function nP(e,t,r){var n=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(r,r+6));return n?(e.Z=n[1]?0:-(n[2]+(n[3]||"00")),r+n[0].length):-1}function iP(e,t,r){var n=nl.exec(t.slice(r,r+1));return n?(e.q=n[0]*3-3,r+n[0].length):-1}function aP(e,t,r){var n=nl.exec(t.slice(r,r+2));return n?(e.m=n[0]-1,r+n[0].length):-1}function HE(e,t,r){var n=nl.exec(t.slice(r,r+2));return n?(e.d=+n[0],r+n[0].length):-1}function oP(e,t,r){var n=nl.exec(t.slice(r,r+3));return n?(e.m=0,e.d=+n[0],r+n[0].length):-1}function WE(e,t,r){var n=nl.exec(t.slice(r,r+2));return n?(e.H=+n[0],r+n[0].length):-1}function sP(e,t,r){var n=nl.exec(t.slice(r,r+2));return n?(e.M=+n[0],r+n[0].length):-1}function uP(e,t,r){var n=nl.exec(t.slice(r,r+2));return n?(e.S=+n[0],r+n[0].length):-1}function lP(e,t,r){var n=nl.exec(t.slice(r,r+3));return n?(e.L=+n[0],r+n[0].length):-1}function cP(e,t,r){var n=nl.exec(t.slice(r,r+6));return n?(e.L=Math.floor(n[0]/1e3),r+n[0].length):-1}function fP(e,t,r){var n=$4.exec(t.slice(r,r+1));return n?r+n[0].length:-1}function hP(e,t,r){var n=nl.exec(t.slice(r));return n?(e.Q=+n[0],r+n[0].length):-1}function AP(e,t,r){var n=nl.exec(t.slice(r));return n?(e.s=+n[0],r+n[0].length):-1}function jE(e,t){return ho(e.getDate(),t,2)}function pP(e,t){return ho(e.getHours(),t,2)}function dP(e,t){return ho(e.getHours()%12||12,t,2)}function vP(e,t){return ho(1+y_.count(mp(e),e),t,3)}function XE(e,t){return ho(e.getMilliseconds(),t,3)}function gP(e,t){return XE(e,t)+"000"}function mP(e,t){return ho(e.getMonth()+1,t,2)}function _P(e,t){return ho(e.getMinutes(),t,2)}function yP(e,t){return ho(e.getSeconds(),t,2)}function EP(e){var t=e.getDay();return t===0?7:t}function SP(e,t){return ho(__.count(mp(e)-1,e),t,2)}function YE(e){var t=e.getDay();return t>=4||t===0?_p(e):_p.ceil(e)}function xP(e,t){return e=YE(e),ho(_p.count(mp(e),e)+(mp(e).getDay()===4),t,2)}function TP(e){return e.getDay()}function CP(e,t){return ho(gg.count(mp(e)-1,e),t,2)}function bP(e,t){return ho(e.getFullYear()%100,t,2)}function RP(e,t){return e=YE(e),ho(e.getFullYear()%100,t,2)}function MP(e,t){return ho(e.getFullYear()%1e4,t,4)}function wP(e,t){var r=e.getDay();return e=r>=4||r===0?_p(e):_p.ceil(e),ho(e.getFullYear()%1e4,t,4)}function IP(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+ho(t/60|0,"0",2)+ho(t%60,"0",2)}function $E(e,t){return ho(e.getUTCDate(),t,2)}function PP(e,t){return ho(e.getUTCHours(),t,2)}function OP(e,t){return ho(e.getUTCHours()%12||12,t,2)}function NP(e,t){return ho(1+ZE.count(Sd(e),e),t,3)}function QE(e,t){return ho(e.getUTCMilliseconds(),t,3)}function DP(e,t){return QE(e,t)+"000"}function LP(e,t){return ho(e.getUTCMonth()+1,t,2)}function FP(e,t){return ho(e.getUTCMinutes(),t,2)}function BP(e,t){return ho(e.getUTCSeconds(),t,2)}function kP(e){var t=e.getUTCDay();return t===0?7:t}function UP(e,t){return ho(kE.count(Sd(e)-1,e),t,2)}function qE(e){var t=e.getUTCDay();return t>=4||t===0?yp(e):yp.ceil(e)}function ZP(e,t){return e=qE(e),ho(yp.count(Sd(e),e)+(Sd(e).getUTCDay()===4),t,2)}function zP(e){return e.getUTCDay()}function GP(e,t){return ho(_g.count(Sd(e)-1,e),t,2)}function VP(e,t){return ho(e.getUTCFullYear()%100,t,2)}function HP(e,t){return e=qE(e),ho(e.getUTCFullYear()%100,t,2)}function WP(e,t){return ho(e.getUTCFullYear()%1e4,t,4)}function jP(e,t){var r=e.getUTCDay();return e=r>=4||r===0?yp(e):yp.ceil(e),ho(e.getUTCFullYear()%1e4,t,4)}function XP(){return"+0000"}function KE(){return"%"}function JE(e){return+e}function eS(e){return Math.floor(+e/1e3)}var Ep,tS,YP,$P,QP;qP({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function qP(e){return Ep=Y4(e),tS=Ep.format,YP=Ep.parse,$P=Ep.utcFormat,QP=Ep.utcParse,Ep}var bd=1e3,Rd=bd*60,Md=Rd*60,wd=Md*24,KP=wd*7,rS=wd*30,T_=wd*365;function JP(e){return new Date(e)}function eO(e){return e instanceof Date?+e:+new Date(+e)}function nS(e,t,r,n,i,a,s,l,p){var m=cE(Zl,Zl),T=m.invert,R=m.domain,L=p(".%L"),z=p(":%S"),re=p("%I:%M"),ee=p("%I %p"),me=p("%a %d"),Ie=p("%b %d"),He=p("%B"),Xe=p("%Y"),ot=[[s,1,bd],[s,5,5*bd],[s,15,15*bd],[s,30,30*bd],[a,1,Rd],[a,5,5*Rd],[a,15,15*Rd],[a,30,30*Rd],[i,1,Md],[i,3,3*Md],[i,6,6*Md],[i,12,12*Md],[n,1,wd],[n,2,2*wd],[r,1,KP],[t,1,rS],[t,3,3*rS],[e,1,T_]];function pt(It){return(s(It)<It?L:a(It)<It?z:i(It)<It?re:n(It)<It?ee:t(It)<It?r(It)<It?me:Ie:e(It)<It?He:Xe)(It)}function dt(It,Vt,Kt,yr){if(It==null&&(It=10),typeof It=="number"){var _r=Math.abs(Kt-Vt)/It,Hr=(0,yl.YF)(function(nn){return nn[2]}).right(ot,_r);Hr===ot.length?(yr=(0,yl.ly)(Vt/T_,Kt/T_,It),It=e):Hr?(Hr=ot[_r/ot[Hr-1][2]<ot[Hr][2]/_r?Hr-1:Hr],yr=Hr[1],It=Hr[0]):(yr=Math.max((0,yl.ly)(Vt,Kt,It),1),It=l)}return yr==null?It:It.every(yr)}return m.invert=function(It){return new Date(T(It))},m.domain=function(It){return arguments.length?R(rE.call(It,eO)):R().map(JP)},m.ticks=function(It,Vt){var Kt=R(),yr=Kt[0],_r=Kt[Kt.length-1],Hr=_r<yr,nn;return Hr&&(nn=yr,yr=_r,_r=nn),nn=dt(It,yr,_r,Vt),nn=nn?nn.range(yr,_r+1):[],Hr?nn.reverse():nn},m.tickFormat=function(It,Vt){return Vt==null?pt:p(Vt)},m.nice=function(It,Vt){var Kt=R();return(It=dt(It,Kt[0],Kt[Kt.length-1],Vt))?R(_E(Kt,It)):m},m.copy=function(){return hg(m,nS(e,t,r,n,i,a,s,l,p))},m}function tO(){return Ch.apply(nS(mp,L4,__,y_,Z4,z4,G4,V4,tS).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function eF(){return initRange.apply(calendar(utcYear,utcMonth,utcWeek,utcDay,utcHour,utcMinute,utcSecond,utcMillisecond,utcFormat).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function yg(){var e=0,t=1,r,n,i,a,s=Zl,l=!1,p;function m(T){return isNaN(T=+T)?p:s(i===0?.5:(T=(a(T)-r)*i,l?Math.max(0,Math.min(1,T)):T))}return m.domain=function(T){return arguments.length?(r=a(e=+T[0]),n=a(t=+T[1]),i=r===n?0:1/(n-r),m):[e,t]},m.clamp=function(T){return arguments.length?(l=!!T,m):l},m.interpolator=function(T){return arguments.length?(s=T,m):s},m.unknown=function(T){return arguments.length?(p=T,m):p},function(T){return a=T,r=T(e),n=T(t),i=r===n?0:1/(n-r),m}}function Id(e,t){return t.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function iS(){var e=yd(yg()(Zl));return e.copy=function(){return Id(e,iS())},nE.apply(e,arguments)}function rO(){var e=loggish(yg()).domain([1,10]);return e.copy=function(){return Id(e,rO()).base(e.base())},initInterpolator.apply(e,arguments)}function nO(){var e=symlogish(yg());return e.copy=function(){return Id(e,nO()).constant(e.constant())},initInterpolator.apply(e,arguments)}function aS(){var e=powish(yg());return e.copy=function(){return Id(e,aS()).exponent(e.exponent())},initInterpolator.apply(e,arguments)}function tF(){return aS.apply(null,arguments).exponent(.5)}function iO(){var e=[],t=identity;function r(n){if(!isNaN(n=+n))return t((bisect(e,n)-1)/(e.length-1))}return r.domain=function(n){if(!arguments.length)return e.slice();e=[];for(var i=0,a=n.length,s;i<a;++i)s=n[i],s!=null&&!isNaN(s=+s)&&e.push(s);return e.sort(ascending),r},r.interpolator=function(n){return arguments.length?(t=n,r):t},r.copy=function(){return iO(t).domain(e)},initInterpolator.apply(r,arguments)}function Eg(){var e=0,t=.5,r=1,n,i,a,s,l,p=Zl,m,T=!1,R;function L(z){return isNaN(z=+z)?R:(z=.5+((z=+m(z))-i)*(z<i?s:l),p(T?Math.max(0,Math.min(1,z)):z))}return L.domain=function(z){return arguments.length?(n=m(e=+z[0]),i=m(t=+z[1]),a=m(r=+z[2]),s=n===i?0:.5/(i-n),l=i===a?0:.5/(a-i),L):[e,t,r]},L.clamp=function(z){return arguments.length?(T=!!z,L):T},L.interpolator=function(z){return arguments.length?(p=z,L):p},L.unknown=function(z){return arguments.length?(R=z,L):R},function(z){return m=z,n=z(e),i=z(t),a=z(r),s=n===i?0:.5/(i-n),l=i===a?0:.5/(a-i),L}}function oS(){var e=yd(Eg()(Zl));return e.copy=function(){return Id(e,oS())},nE.apply(e,arguments)}function aO(){var e=loggish(Eg()).domain([.1,1,10]);return e.copy=function(){return copy(e,aO()).base(e.base())},initInterpolator.apply(e,arguments)}function oO(){var e=symlogish(Eg());return e.copy=function(){return copy(e,oO()).constant(e.constant())},initInterpolator.apply(e,arguments)}function sS(){var e=powish(Eg());return e.copy=function(){return copy(e,sS()).exponent(e.exponent())},initInterpolator.apply(e,arguments)}function rF(){return sS.apply(null,arguments).exponent(.5)}function uS(e){var t,r=[];function n(i){return i==null?t:i}return n.invert=n,n.domain=n.range=function(i){return i?(r=i,i):r},n.unknown=function(i){return i?(t=i,i):t},n.copy=function(){return uS(e).unknown(t)},n}var qc,lS,cS,C_=Fn.isNil,sO=Fn.isString,uO=Fn.uniq,lO=/^(?:(?!0000)[0-9]{4}([-/.]+)(?:(?:0?[1-9]|1[0-2])\1(?:0?[1-9]|1[0-9]|2[0-8])|(?:0?[13-9]|1[0-2])\1(?:29|30)|(?:0?[13578]|1[02])\1(?:31))|(?:[0-9]{2}(?:0[48]|[2468][048]|[13579][26])|(?:0[48]|[2468][048]|[13579][26])00)([-/.]?)0?2\2(?:29))(\s+([01]|([01][0-9]|2[0-3])):([0-9]|[0-5][0-9]):([0-9]|[0-5][0-9]))?$/,cO=(qc={},(0,ve.Z)(qc,xo.LINEAR,mE),(0,ve.Z)(qc,xo.POWER,d_),(0,ve.Z)(qc,xo.LOG,xE),(0,ve.Z)(qc,xo.IDENTITY,uS),(0,ve.Z)(qc,xo.SEQUENTIAL,iS),(0,ve.Z)(qc,xo.TIME,tO),(0,ve.Z)(qc,xo.QUANTILE,RE),(0,ve.Z)(qc,xo.QUANTIZE,ME),(0,ve.Z)(qc,xo.THRESHOLD,wE),(0,ve.Z)(qc,xo.CAT,cg),(0,ve.Z)(qc,xo.DIVERGING,oS),qc),fO=(lS=(0,Tt.b2)(),lS(cS=function(){function e(){(0,ue.Z)(this,e),(0,ve.Z)(this,"scaleOptions",{})}return(0,_e.Z)(e,[{key:"apply",value:function(r,n){var i=this,a=n.styleAttributeService;r.hooks.init.tapPromise("FeatureScalePlugin",(0,hr.Z)(it().mark(function s(){var l,p,m;return it().wrap(function(R){for(;;)switch(R.prev=R.next){case 0:if(r.log(du.ScaleInitStart,xu.INIT),i.scaleOptions=r.getScaleOptions(),p=a.getLayerStyleAttributes(),m=(l=r.getSource())===null||l===void 0?void 0:l.data.dataArray,!(Array.isArray(m)&&m.length===0)){R.next=8;break}return R.abrupt("return");case 8:i.caculateScalesForAttributes(p||[],m);case 9:r.log(du.ScaleInitEnd,xu.INIT);case 10:case"end":return R.stop()}},s)}))),r.hooks.beforeRenderData.tapPromise("FeatureScalePlugin",function(){var s=(0,hr.Z)(it().mark(function l(p){var m,T;return it().wrap(function(L){for(;;)switch(L.prev=L.next){case 0:if(p){L.next=2;break}return L.abrupt("return",p);case 2:if(r.log(du.ScaleInitStart,xu.UPDATE),i.scaleOptions=r.getScaleOptions(),m=a.getLayerStyleAttributes(),T=r.getSource().data.dataArray,!(Array.isArray(T)&&T.length===0)){L.next=8;break}return L.abrupt("return",!0);case 8:return i.caculateScalesForAttributes(m||[],T),r.log(du.ScaleInitEnd,xu.UPDATE),r.layerModelNeedUpdate=!0,L.abrupt("return",!0);case 12:case"end":return L.stop()}},l)}));return function(l){return s.apply(this,arguments)}}()),r.hooks.beforeRender.tap("FeatureScalePlugin",function(){if(!r.layerModelNeedUpdate){i.scaleOptions=r.getScaleOptions();var s=a.getLayerStyleAttributes(),l=r.getSource().data.dataArray;if(!(Array.isArray(l)&&l.length===0)&&s){var p=s.filter(function(m){return m.needRescale});p.length&&i.caculateScalesForAttributes(p,l)}}})}},{key:"isNumber",value:function(r){return!isNaN(parseFloat(r))&&isFinite(r)}},{key:"caculateScalesForAttributes",value:function(r,n){var i=this;r.forEach(function(a){if(a.scale){var s=a.scale,l=a.scale.field;s.names=i.parseFields(C_(l)?[]:l);var p=[];s.names.forEach(function(m){var T;p.push(i.createScale(m,a.name,(T=a.scale)===null||T===void 0?void 0:T.values,n))}),p.some(function(m){return m.type===lp.VARIABLE})?(s.type=lp.VARIABLE,p.forEach(function(m){if(!s.callback&&s.values!=="text"){var T;switch((T=m.option)===null||T===void 0?void 0:T.type){case xo.LOG:case xo.LINEAR:case xo.POWER:if(s.values&&s.values.length>2){var R=m.scale.ticks(s.values.length);m.scale.domain(R)}s.values?m.scale.range(s.values):m.scale.range(m.option.domain);break;case xo.QUANTILE:case xo.QUANTIZE:case xo.THRESHOLD:m.scale.range(s.values);break;case xo.IDENTITY:break;case xo.CAT:s.values?m.scale.range(s.values):m.scale.range(m.option.domain);break;case xo.DIVERGING:case xo.SEQUENTIAL:m.scale.interpolator($I(s.values));break}}if(s.values==="text"){var L;m.scale.range((L=m.option)===null||L===void 0?void 0:L.domain)}})):(s.type=lp.CONSTANT,s.defaultValues=p.map(function(m,T){return m.scale(s.names[T])})),s.scalers=p.map(function(m){return{field:m.field,func:m.scale,option:m.option}}),a.needRescale=!1}})}},{key:"parseFields",value:function(r){return Array.isArray(r)?r:sO(r)?r.split("*"):[r]}},{key:"createScale",value:function(r,n,i,a){var s,l,p=this.scaleOptions[n]&&((s=this.scaleOptions[n])===null||s===void 0?void 0:s.field)===r?this.scaleOptions[n]:this.scaleOptions[r],m={field:r,scale:void 0,type:lp.VARIABLE,option:p};if(!a||!a.length)return p&&p.type?m.scale=this.createDefaultScale(p):(m.scale=cg([r]),m.type=lp.CONSTANT),m;var T=(l=a.find(function(z){return!C_(z[r])}))===null||l===void 0?void 0:l[r];if(this.isNumber(r)||C_(T)&&!p)m.scale=cg([r]),m.type=lp.CONSTANT;else{var R=p&&p.type||this.getDefaultType(T);i==="text"&&(R=xo.CAT),i===void 0&&(R=xo.IDENTITY);var L=this.createScaleConfig(R,r,p,a);m.scale=this.createDefaultScale(L),m.option=L}return m}},{key:"getDefaultType",value:function(r){var n=xo.LINEAR;return typeof r=="string"&&(n=lO.test(r)?xo.TIME:xo.CAT),n}},{key:"createScaleConfig",value:function(r,n,i,a){var s={type:r},l=(a==null?void 0:a.map(function(T){return T[n]}))||[];if(i!=null&&i.domain)s.domain=i==null?void 0:i.domain;else if(r===xo.CAT||r===xo.IDENTITY)s.domain=uO(l);else if(r===xo.QUANTILE)s.domain=l;else if(r===xo.DIVERGING){var p=(0,yl.We)(l),m=(i==null?void 0:i.neutral)!==void 0?i==null?void 0:i.neutral:(p[0]+p[1])/2;s.domain=[p[0],m,p[1]]}else s.domain=(0,yl.We)(l);return(0,Q.Z)((0,Q.Z)({},s),i)}},{key:"createDefaultScale",value:function(r){var n=r.type,i=r.domain,a=r.unknown,s=r.clamp,l=r.nice,p=cO[n]();return i&&p.domain&&p.domain(i),a&&p.unknown(a),s!==void 0&&p.clamp&&p.clamp(s),l!==void 0&&p.nice&&p.nice(l),p}}]),e}())||cS),fS,hS,hO=(fS=(0,Tt.b2)(),fS(hS=function(){function e(){(0,ue.Z)(this,e)}return(0,_e.Z)(e,[{key:"apply",value:function(r){r.hooks.beforeRender.tap("LayerAnimateStylePlugin",function(){var n=r.animateStatus;n&&r.models.forEach(function(i){i.addUniforms((0,Q.Z)({},r.layerModel.getAnimateUniforms()))})})}}]),e}())||hS),AS,pS,AO=(AS=(0,Tt.b2)(),AS(pS=function(){function e(){(0,ue.Z)(this,e)}return(0,_e.Z)(e,[{key:"apply",value:function(r){r.hooks.afterInit.tap("LayerMaskPlugin",function(){var n=r.getLayerConfig(),i=n.maskLayers,a=n.enableMask;if(!r.tileLayer&&i&&i.length>0){var s;(s=r.masks).push.apply(s,(0,cr.Z)(i)),r.updateLayerConfig({mask:a})}})}}]),e}())||pS),pO=function(){function e(t){var r=t.rendererService,n=t.layerService,i=t.parent;(0,ue.Z)(this,e),(0,ve.Z)(this,"tileResource",new Map),(0,ve.Z)(this,"layerTiles",[]),this.rendererService=r,this.layerService=n,this.parent=i}return(0,_e.Z)(e,[{key:"tiles",get:function(){return this.layerTiles}},{key:"hasTile",value:function(r){return this.layerTiles.some(function(n){return n.key===r})}},{key:"addTile",value:function(r){this.layerTiles.push(r)}},{key:"getTile",value:function(r){return this.layerTiles.find(function(n){return n.key===r})}},{key:"getVisibleTileBylngLat",value:function(r){return this.layerTiles.find(function(n){return n.isLoaded&&n.visible&&n.lnglatInBounds(r)})}},{key:"removeTile",value:function(r){var n=this.layerTiles.findIndex(function(a){return a.key===r}),i=this.layerTiles.splice(n,1);i[0]&&i[0].destroy()}},{key:"updateTileVisible",value:function(r){var n=this.getTile(r.key);if(r.isVisible)if(r.parent){var i=this.isChildrenLoaded(r.parent);n==null||n.updateVisible(i)}else n==null||n.updateVisible(!0);else if(r.parent){var a=this.isChildrenLoaded(r.parent);n==null||n.updateVisible(!a)}else n==null||n.updateVisible(!1)}},{key:"isParentLoaded",value:function(r){var n=r.parent;if(!n)return!0;var i=this.getTile(n==null?void 0:n.key);return!!(i!=null&&i.isLoaded)}},{key:"isChildrenLoaded",value:function(r){var n=this,i=r==null?void 0:r.children;return i.length===0?!0:i.every(function(a){var s=n.getTile(a==null?void 0:a.key);return s?(s==null?void 0:s.isLoaded)===!0:!0})}},{key:"render",value:function(){var t=(0,hr.Z)(it().mark(function n(){var i=this,a,s;return it().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return a=this.getRenderLayers(),s=a.map(function(){var m=(0,hr.Z)(it().mark(function T(R){return it().wrap(function(z){for(;;)switch(z.prev=z.next){case 0:return z.next=2,i.layerService.renderTileLayer(R);case 2:case"end":return z.stop()}},T)}));return function(T){return m.apply(this,arguments)}}()),p.next=4,Promise.all(s);case 4:case"end":return p.stop()}},n,this)}));function r(){return t.apply(this,arguments)}return r}()},{key:"getRenderLayers",value:function(){var r=this.layerTiles.filter(function(i){return i.visible&&i.isLoaded}),n=[];return r.map(function(i){return n.push.apply(n,(0,cr.Z)(i.getLayers()))}),n}},{key:"getLayers",value:function(){var r=this.layerTiles.filter(function(i){return i.isLoaded}),n=[];return r.map(function(i){return n.push.apply(n,(0,cr.Z)(i.getLayers()))}),n}},{key:"getTiles",value:function(){return this.layerTiles}},{key:"destroy",value:function(){this.layerTiles.forEach(function(r){return r.destroy()}),this.tileResource.clear()}}]),e}(),dO=C(35486),vO=function(){function e(){(0,ue.Z)(this,e)}return(0,_e.Z)(e,[{key:"getCombineFeature",value:function(r){var n=null,i=r[0];return r.map(function(a){var s=Iu.yu(a.coordinates);n===null?n=s:n=(0,dO.Z)(n,s)}),i&&(n.properties=(0,Q.Z)({},i)),n}}]),e}(),Pd="select",Od="active",gO=function(){function e(t){var r=t.layerService,n=t.tileLayerService,i=t.parent;(0,ue.Z)(this,e),(0,ve.Z)(this,"tilePickID",new Map),this.layerService=r,this.tileLayerService=n,this.parent=i,this.tileSourceService=new vO}return(0,_e.Z)(e,[{key:"pickRender",value:function(r){var n=this.tileLayerService.getVisibleTileBylngLat(r.lngLat);if(n){var i=n.getMainLayer();i==null||i.layerPickService.pickRender(r)}}},{key:"pick",value:function(r,n){var i=this.parent.getContainer(),a=i.get(xt.IPickingService);if(r.type==="RasterLayer"){var s=this.tileLayerService.getVisibleTileBylngLat(n.lngLat);if(s&&s.getMainLayer()!==void 0){var l=s.getMainLayer();return l.layerPickService.pickRasterLayer(l,n,this.parent)}return!1}return this.pickRender(n),a.pickFromPickingFBO(r,n)}},{key:"selectFeature",value:function(r){var n=(0,yn.Z)(r,3),i=n[0],a=n[1],s=n[2],l=this.color2PickId(i,a,s);this.tilePickID.set(Pd,l),this.updateHighLight(i,a,s,Pd)}},{key:"highlightPickedFeature",value:function(r){var n=(0,yn.Z)(r,3),i=n[0],a=n[1],s=n[2],l=this.color2PickId(i,a,s);this.tilePickID.set(Od,l),this.updateHighLight(i,a,s,Od)}},{key:"updateHighLight",value:function(r,n,i,a){this.tileLayerService.tiles.map(function(s){var l=s.getMainLayer();switch(a){case Pd:l==null||l.hooks.beforeSelect.call([r,n,i]);break;case Od:l==null||l.hooks.beforeHighlight.call([r,n,i]);break}})}},{key:"setPickState",value:function(){var r=this.tilePickID.get(Pd),n=this.tilePickID.get(Od);if(r){var i=this.pickId2Color(r),a=(0,yn.Z)(i,3),s=a[0],l=a[1],p=a[2];this.updateHighLight(s,l,p,Pd);return}if(n){var m=this.pickId2Color(n),T=(0,yn.Z)(m,3),R=T[0],L=T[1],z=T[2];this.updateHighLight(R,L,z,Od);return}}},{key:"color2PickId",value:function(r,n,i){return _o(new Uint8Array([r,n,i]))}},{key:"pickId2Color",value:function(r){return Ws(r)}},{key:"getFeatureById",value:function(r){var n=this.tileLayerService.getTiles().filter(function(a){return a.visible}),i=[];return n.forEach(function(a){i.push.apply(i,(0,cr.Z)(a.getFeatureById(r)))}),i}},{key:"pickRasterLayer",value:function(r,n,i){return!1}}]),e}();function mO(e){return e==="PolygonLayer"?a_:e==="LineLayer"?n_:og}function _O(e){return["PolygonLayer","LineLayer"].indexOf(e)!==-1}function yO(e){var t=EO();return function(){var n=(0,le.Z)(e),i;if(t){var a=(0,le.Z)(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return(0,ze.Z)(this,i)}}function EO(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var pA=function(e){(0,ke.Z)(r,e);var t=yO(r);function r(n,i){var a;return(0,ue.Z)(this,r),a=t.call(this),(0,ve.Z)((0,St.Z)(a),"visible",!0),(0,ve.Z)((0,St.Z)(a),"layers",[]),(0,ve.Z)((0,St.Z)(a),"isLoaded",!1),(0,ve.Z)((0,St.Z)(a),"tileMaskLayers",[]),a.parent=i,a.sourceTile=n,a.x=n.x,a.y=n.y,a.z=n.z,a.key="".concat(a.x,"_").concat(a.y,"_").concat(a.z),a}return(0,_e.Z)(r,[{key:"getLayers",value:function(){return this.layers}},{key:"styleUpdate",value:function(){}},{key:"lnglatInBounds",value:function(i){var a=(0,yn.Z)(this.sourceTile.bounds,4),s=a[0],l=a[1],p=a[2],m=a[3],T=i.lng,R=i.lat;return T>=s&&T<=p&&R>=l&&R<=m}},{key:"getLayerOptions",value:function(){var i,a=this.parent.getLayerConfig();return(0,Q.Z)((0,Q.Z)({},a),{},{textAllowOverlap:!0,autoFit:!1,maskLayers:this.getMaskLayer(),tileMask:_O(this.parent.type),mask:a.mask||((i=a.maskLayers)===null||i===void 0?void 0:i.length)!==0&&a.enableMask})}},{key:"getMaskLayer",value:function(){var i=this,a=this.parent.getLayerConfig(),s=a.maskLayers,l=[];return s==null||s.forEach(function(p){if(!p.tileLayer)return l.push(p),p;var m=p.tileLayer,T=m.getTile(i.sourceTile.key),R=T==null?void 0:T.getLayers()[0];R&&l.push(R)}),l}},{key:"addTileMask",value:function(){var n=(0,hr.Z)(it().mark(function a(){var s,l,p;return it().wrap(function(T){for(;;)switch(T.prev=T.next){case 0:return s=new a_({visible:!1,enablePicking:!1}).source({type:"FeatureCollection",features:[this.sourceTile.bboxPolygon]},{parser:{type:"geojson",featureId:"id"}}).shape("fill").style({opacity:.5}),l=pd(this.parent.sceneContainer),s.setContainer(l,this.parent.sceneContainer),T.next=5,s.init();case 5:return this.tileMask=s,p=this.getMainLayer(),p!==void 0&&(p.tileMask=s),T.abrupt("return",s);case 9:case"end":return T.stop()}},a,this)}));function i(){return n.apply(this,arguments)}return i}()},{key:"addMask",value:function(){var n=(0,hr.Z)(it().mark(function a(s,l){var p;return it().wrap(function(T){for(;;)switch(T.prev=T.next){case 0:return p=pd(this.parent.sceneContainer),l.setContainer(p,this.parent.sceneContainer),T.next=4,l.init();case 4:s.addMask(l),this.tileMaskLayers.push(l);case 6:case"end":return T.stop()}},a,this)}));function i(a,s){return n.apply(this,arguments)}return i}()},{key:"addLayer",value:function(){var n=(0,hr.Z)(it().mark(function a(s){var l;return it().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return s.isTileLayer=!0,l=pd(this.parent.sceneContainer),s.setContainer(l,this.parent.sceneContainer),this.layers.push(s),m.next=6,s.init();case 6:case"end":return m.stop()}},a,this)}));function i(a){return n.apply(this,arguments)}return i}()},{key:"updateVisible",value:function(i){this.visible=i,this.updateOptions("visible",i)}},{key:"updateOptions",value:function(i,a){this.layers.forEach(function(s){s.updateLayerConfig((0,ve.Z)({},i,a))})}},{key:"getMainLayer",value:function(){return this.layers[0]}},{key:"getFeatures",value:function(i){return[]}},{key:"getFeatureById",value:function(i){return[]}},{key:"destroy",value:function(){var i;(i=this.tileMask)===null||i===void 0||i.destroy(),this.layers.forEach(function(a){return a.destroy()})}}]),r}(Si.EventEmitter);function SO(e){var t=xO();return function(){var n=(0,le.Z)(e),i;if(t){var a=(0,le.Z)(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return(0,ze.Z)(this,i)}}function xO(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var TO=function(e){(0,ke.Z)(r,e);var t=SO(r);function r(){return(0,ue.Z)(this,r),t.apply(this,arguments)}return(0,_e.Z)(r,[{key:"initTileLayer",value:function(){var n=(0,hr.Z)(it().mark(function a(){var s,l,p,m;return it().wrap(function(R){for(;;)switch(R.prev=R.next){case 0:return s=this.getSourceOption(),l=s.data.features[0].properties,p=new n_().source(s.data,s.options).size(1).shape("line").color("red"),m=new og({minZoom:this.z-1,maxZoom:this.z+1,textAllowOverlap:!0}).source([l],{parser:{type:"json",x:"x",y:"y"}}).size(20).color("red").shape(this.key).style({stroke:"#fff",strokeWidth:2}),R.next=6,this.addLayer(p);case 6:return R.next=8,this.addLayer(m);case 8:this.isLoaded=!0;case 9:case"end":return R.stop()}},a,this)}));function i(){return n.apply(this,arguments)}return i}()},{key:"getSourceOption",value:function(){var i=this.parent.getSource(),a=this.sourceTile.data.layers.testTile.features;return{data:{type:"FeatureCollection",features:a},options:{parser:{type:"geojson"},transforms:i.transforms}}}}]),r}(pA);function CO(e){var t=bO();return function(){var n=(0,le.Z)(e),i;if(t){var a=(0,le.Z)(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return(0,ze.Z)(this,i)}}function bO(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var RO=`precision mediump float;
uniform float u_opacity: 1.0;
uniform sampler2D u_texture;
varying vec2 v_texCoord;
void main() {
  vec4 color = texture2D(u_texture,vec2(v_texCoord.x,v_texCoord.y));
  gl_FragColor = color;
  gl_FragColor.a *= u_opacity;
  if(gl_FragColor.a < 0.01)
    discard;
}
`,MO=`precision highp float;
uniform mat4 u_ModelMatrix;

attribute vec3 a_Position;
attribute vec2 a_Uv;
varying vec2 v_texCoord;
#pragma include "projection"
void main() {
   v_texCoord = a_Uv;
   vec4 project_pos = project_position(vec4(a_Position, 1.0));
   gl_Position = project_common_position_to_clipspace_v2(vec4(project_pos.xy,0., 1.0));
 
}
`,wO=function(e){(0,ke.Z)(r,e);var t=CO(r);function r(){return(0,ue.Z)(this,r),t.apply(this,arguments)}return(0,_e.Z)(r,[{key:"getUninforms",value:function(){var i=this.layer.getLayerConfig(),a=i.opacity;return{u_opacity:a||1,u_texture:this.texture}}},{key:"initModels",value:function(){var n=(0,hr.Z)(it().mark(function a(){var s,l,p,m;return it().wrap(function(R){for(;;)switch(R.prev=R.next){case 0:return s=this.layer.getSource(),l=this.rendererService.createTexture2D,this.texture=l({height:0,width:0}),R.next=5,s.data.images;case 5:return p=R.sent,this.texture=l({data:p[0],width:p[0].width,height:p[0].height,mag:Fe.LINEAR,min:Fe.LINEAR}),R.next=9,this.layer.buildLayerModel({moduleName:"rasterImage",vertexShader:MO,fragmentShader:RO,triangulation:rg,primitive:Fe.TRIANGLES,blend:{enable:!0},depth:{enable:!1}});case 9:return m=R.sent,R.abrupt("return",[m]);case 11:case"end":return R.stop()}},a,this)}));function i(){return n.apply(this,arguments)}return i}()},{key:"clearModels",value:function(){var i;(i=this.texture)===null||i===void 0||i.destroy()}},{key:"buildModels",value:function(){var n=(0,hr.Z)(it().mark(function a(){return it().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.abrupt("return",this.initModels());case 1:case"end":return l.stop()}},a,this)}));function i(){return n.apply(this,arguments)}return i}()},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"uv",type:bn.Attribute,descriptor:{name:"a_Uv",buffer:{usage:Fe.DYNAMIC_DRAW,data:[],type:Fe.FLOAT},size:2,update:function(a,s,l){return[l[3],l[4]]}}})}}]),r}(Lo),IO={image:wO},PO=IO;function OO(e){var t=NO();return function(){var n=(0,le.Z)(e),i;if(t){var a=(0,le.Z)(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return(0,ze.Z)(this,i)}}function NO(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var DO=function(e){(0,ke.Z)(r,e);var t=OO(r);function r(){var n;(0,ue.Z)(this,r);for(var i=arguments.length,a=new Array(i),s=0;s<i;s++)a[s]=arguments[s];return n=t.call.apply(t,[this].concat(a)),(0,ve.Z)((0,St.Z)(n),"type","ImageLayer"),n}return(0,_e.Z)(r,[{key:"buildModels",value:function(){var n=(0,hr.Z)(it().mark(function a(){var s;return it().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return s=this.getModelType(),this.layerModel=new PO[s](this),p.next=4,this.initLayerModels();case 4:case"end":return p.stop()}},a,this)}));function i(){return n.apply(this,arguments)}return i}()},{key:"getDefaultConfig",value:function(){var i=this.getModelType(),a={image:{}};return a[i]}},{key:"getModelType",value:function(){return"image"}}]),r}(fp);function LO(e){var t=FO();return function(){var n=(0,le.Z)(e),i;if(t){var a=(0,le.Z)(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return(0,ze.Z)(this,i)}}function FO(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var BO=function(e){(0,ke.Z)(r,e);var t=LO(r);function r(){return(0,ue.Z)(this,r),t.apply(this,arguments)}return(0,_e.Z)(r,[{key:"initTileLayer",value:function(){var n=(0,hr.Z)(it().mark(function a(){var s,l,p,m;return it().wrap(function(R){for(;;)switch(R.prev=R.next){case 0:return s=this.parent.getLayerAttributeConfig(),l=this.getLayerOptions(),p=this.getSourceOption(),m=new DO((0,Q.Z)({},l)).source(p.data,p.options),s&&Object.keys(s).forEach(function(L){var z,re,ee=L;m[ee]((z=s[ee])===null||z===void 0?void 0:z.field,(re=s[ee])===null||re===void 0?void 0:re.values)}),R.next=7,this.addLayer(m);case 7:this.isLoaded=!0;case 8:case"end":return R.stop()}},a,this)}));function i(){return n.apply(this,arguments)}return i}()},{key:"getSourceOption",value:function(){var i=this.parent.getSource();return{data:this.sourceTile.data,options:{parser:{type:"image",extent:this.sourceTile.bounds},transforms:i.transforms}}}}]),r}(pA);function kO(e){var t=UO();return function(){var n=(0,le.Z)(e),i;if(t){var a=(0,le.Z)(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return(0,ze.Z)(this,i)}}function UO(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var ZO=function(e){(0,ke.Z)(r,e);var t=kO(r);function r(){return(0,ue.Z)(this,r),t.apply(this,arguments)}return(0,_e.Z)(r,[{key:"initTileLayer",value:function(){var n=(0,hr.Z)(it().mark(function a(){var s,l,p,m;return it().wrap(function(R){for(;;)switch(R.prev=R.next){case 0:return s=this.parent.getLayerAttributeConfig(),l=this.getLayerOptions(),p=this.getSourceOption(),m=new k2((0,Q.Z)({},l)).source(p.data,p.options),s&&Object.keys(s).forEach(function(L){var z,re,ee=L;m[ee]((z=s[ee])===null||z===void 0?void 0:z.field,(re=s[ee])===null||re===void 0?void 0:re.values)}),R.next=7,this.addLayer(m);case 7:this.isLoaded=!0;case 8:case"end":return R.stop()}},a,this)}));function i(){return n.apply(this,arguments)}return i}()},{key:"getFeatures",value:function(i){if(!i)return[];var a=this.sourceTile.data;return a.getTileData(i)}},{key:"getSourceOption",value:function(){var i=this.parent.getSource(),a=this.parent.getLayerConfig(),s=a.sourceLayer,l=a.featureId,p=this.getFeatures(s);return{data:{type:"FeatureCollection",features:p},options:{parser:{type:"geojson",featureId:l},transforms:i.transforms}}}}]),r}(pA);function zO(e){var t=GO();return function(){var n=(0,le.Z)(e),i;if(t){var a=(0,le.Z)(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return(0,ze.Z)(this,i)}}function GO(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var VO=`precision mediump float;
uniform float u_opacity: 1.0;
uniform sampler2D u_texture;
uniform sampler2D u_colorTexture;
uniform float u_min;
uniform float u_max;
uniform vec2 u_domain;
uniform float u_noDataValue;
uniform bool u_clampLow: true;
uniform bool u_clampHigh: true;
varying vec2 v_texCoord;
bool isnan_emu(float x) { return (x > 0.0 || x < 0.0) ? x != x : x != 0.0; }


void main() {

  float value = texture2D(u_texture,vec2(v_texCoord.x,v_texCoord.y)).r;
  if (value == u_noDataValue || isnan_emu(value))
      discard;
  else if ((!u_clampLow && value < u_domain[0]) || (!u_clampHigh && value > u_domain[1]))
     discard;
  else {
    float normalisedValue =(value - u_domain[0]) / (u_domain[1] -u_domain[0]);
    vec4 color = texture2D(u_colorTexture,vec2(normalisedValue, 0));
    
    gl_FragColor = color;
    gl_FragColor.a =  gl_FragColor.a * u_opacity ;
    if(gl_FragColor.a < 0.01)
      discard;
   
  }
}
`,HO=`precision highp float;
uniform mat4 u_ModelMatrix;

attribute vec3 a_Position;
attribute vec2 a_Uv;
varying vec2 v_texCoord;
#pragma include "projection"
void main() {
   v_texCoord = a_Uv;
   vec4 project_pos = project_position(vec4(a_Position, 1.0));

    gl_Position = project_common_position_to_clipspace_v2(vec4(project_pos.xy,0., 1.0));
}
`,dS=function(e){(0,ke.Z)(r,e);var t=zO(r);function r(){return(0,ue.Z)(this,r),t.apply(this,arguments)}return(0,_e.Z)(r,[{key:"getUninforms",value:function(){var i=this.layer.getLayerConfig(),a=i.opacity,s=a===void 0?1:a,l=i.clampLow,p=l===void 0?!0:l,m=i.clampHigh,T=m===void 0?!0:m,R=i.noDataValue,L=R===void 0?-9999999:R,z=i.domain,re=i.rampColors,ee=z||gu(re);return this.colorTexture=this.layer.textureService.getColorTexture(re,ee),{u_opacity:s||1,u_texture:this.texture,u_domain:ee,u_clampLow:p,u_clampHigh:typeof T!="undefined"?T:p,u_noDataValue:L,u_colorTexture:this.colorTexture}}},{key:"getRasterData",value:function(){var n=(0,hr.Z)(it().mark(function a(s){var l,p,m,T;return it().wrap(function(L){for(;;)switch(L.prev=L.next){case 0:if(!Array.isArray(s.data)){L.next=4;break}return L.abrupt("return",{data:s.data,width:s.width,height:s.height});case 4:return L.next=6,s.data;case 6:return l=L.sent,p=l.rasterData,m=l.width,T=l.height,L.abrupt("return",{data:Array.from(p),width:m,height:T});case 11:case"end":return L.stop()}},a)}));function i(a){return n.apply(this,arguments)}return i}()},{key:"initModels",value:function(){var n=(0,hr.Z)(it().mark(function a(){var s,l,p,m,T,R,L,z;return it().wrap(function(ee){for(;;)switch(ee.prev=ee.next){case 0:return s=this.layer.getSource(),l=this.rendererService.createTexture2D,p=s.data.dataArray[0],ee.next=5,this.getRasterData(p);case 5:return m=ee.sent,T=m.data,R=m.width,L=m.height,this.texture=l({data:T,width:R,height:L,format:Fe.LUMINANCE,type:Fe.FLOAT}),ee.next=12,this.layer.buildLayerModel({moduleName:"rasterImageData",vertexShader:HO,fragmentShader:VO,triangulation:rg,primitive:Fe.TRIANGLES,depth:{enable:!1}});case 12:return z=ee.sent,ee.abrupt("return",[z]);case 14:case"end":return ee.stop()}},a,this)}));function i(){return n.apply(this,arguments)}return i}()},{key:"buildModels",value:function(){var n=(0,hr.Z)(it().mark(function a(){return it().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.abrupt("return",this.initModels());case 1:case"end":return l.stop()}},a,this)}));function i(){return n.apply(this,arguments)}return i}()},{key:"clearModels",value:function(){var i,a;(i=this.texture)===null||i===void 0||i.destroy(),(a=this.colorTexture)===null||a===void 0||a.destroy()}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"uv",type:bn.Attribute,descriptor:{name:"a_Uv",buffer:{usage:Fe.DYNAMIC_DRAW,data:[],type:Fe.FLOAT},size:2,update:function(a,s,l){return[l[3],l[4]]}}})}}]),r}(Lo),WO=["data"],jO=["rasterData"];function XO(e){var t=YO();return function(){var n=(0,le.Z)(e),i;if(t){var a=(0,le.Z)(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return(0,ze.Z)(this,i)}}function YO(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var $O=`precision highp float;
uniform mat4 u_ModelMatrix;

attribute vec3 a_Position;
attribute vec2 a_Uv;
varying vec2 v_texCoord;
#pragma include "projection"
void main() {
   v_texCoord = a_Uv;
   vec4 project_pos = project_position(vec4(a_Position, 1.0));

    gl_Position = project_common_position_to_clipspace_v2(vec4(project_pos.xy,0., 1.0));
}
`,QO=`precision mediump float;
uniform vec2 u_rminmax: vec2(0,255); 
uniform vec2 u_gminmax: vec2(0,255);
uniform vec2 u_bminmax: vec2(0,255);
uniform float u_opacity: 1.0;
uniform sampler2D u_texture;
uniform float u_noDataValue : 0.0;
varying vec2 v_texCoord;

void main() {
  vec3 rgb = texture2D(u_texture,vec2(v_texCoord.x,v_texCoord.y)).rgb;
  if(rgb == vec3(u_noDataValue)) {
    gl_FragColor = vec4(0.0, 0, 0, 0.0);
  } else {
    gl_FragColor = vec4(rgb.r / (u_rminmax.y -u_rminmax.x), rgb.g /(u_gminmax.y -u_gminmax.x), rgb.b/ (u_bminmax.y - u_bminmax.x), u_opacity);
  }
  if(gl_FragColor.a < 0.01)
    discard;
 
}`,qO=function(e){(0,ke.Z)(r,e);var t=XO(r);function r(){var n;(0,ue.Z)(this,r);for(var i=arguments.length,a=new Array(i),s=0;s<i;s++)a[s]=arguments[s];return n=t.call.apply(t,[this].concat(a)),(0,ve.Z)((0,St.Z)(n),"dataOption",{}),n}return(0,_e.Z)(r,[{key:"getUninforms",value:function(){var i=this.layer.getLayerConfig(),a=i.opacity,s=a===void 0?1:a,l=i.noDataValue,p=l===void 0?0:l,m=this.dataOption,T=m.rMinMax,R=m.gMinMax,L=m.bMinMax;return{u_opacity:s||1,u_texture:this.texture,u_noDataValue:p,u_rminmax:T,u_gminmax:R,u_bminmax:L}}},{key:"getRasterData",value:function(){var n=(0,hr.Z)(it().mark(function a(s){var l,p,m,T,R;return it().wrap(function(z){for(;;)switch(z.prev=z.next){case 0:if(!Array.isArray(s.data)){z.next=4;break}return l=s.data,p=(0,Cc.Z)(s,WO),this.dataOption=p,z.abrupt("return",(0,Q.Z)({data:l},p));case 4:return z.next=6,s.data;case 6:if(m=z.sent,T=m.rasterData,R=(0,Cc.Z)(m,jO),this.dataOption=R,!Array.isArray(T)){z.next=14;break}return z.abrupt("return",(0,Q.Z)({data:T},R));case 14:return z.abrupt("return",(0,Q.Z)({data:Array.from(T)},R));case 15:case"end":return z.stop()}},a,this)}));function i(a){return n.apply(this,arguments)}return i}()},{key:"initModels",value:function(){var n=(0,hr.Z)(it().mark(function a(){var s,l,p,m,T,R,L,z;return it().wrap(function(ee){for(;;)switch(ee.prev=ee.next){case 0:return s=this.layer.getSource(),l=this.rendererService.createTexture2D,p=s.data.dataArray[0],ee.next=5,this.getRasterData(p);case 5:return m=ee.sent,T=m.data,R=m.width,L=m.height,this.texture=l({data:T,width:R,height:L,format:Fe.RGB,type:Fe.FLOAT}),ee.next=12,this.layer.buildLayerModel({moduleName:"rasterImageDataRGBA",vertexShader:$O,fragmentShader:QO,triangulation:rg,primitive:Fe.TRIANGLES,depth:{enable:!1}});case 12:return z=ee.sent,ee.abrupt("return",[z]);case 14:case"end":return ee.stop()}},a,this)}));function i(){return n.apply(this,arguments)}return i}()},{key:"buildModels",value:function(){var n=(0,hr.Z)(it().mark(function a(){return it().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.abrupt("return",this.initModels());case 1:case"end":return l.stop()}},a,this)}));function i(){return n.apply(this,arguments)}return i}()},{key:"clearModels",value:function(){var i;(i=this.texture)===null||i===void 0||i.destroy()}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"uv",type:bn.Attribute,descriptor:{name:"a_Uv",buffer:{usage:Fe.DYNAMIC_DRAW,data:[],type:Fe.FLOAT},size:2,update:function(a,s,l){return[l[3],l[4]]}}})}}]),r}(Lo);function KO(e){var t=JO();return function(){var n=(0,le.Z)(e),i;if(t){var a=(0,le.Z)(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return(0,ze.Z)(this,i)}}function JO(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var eN=`precision mediump float;
uniform float u_opacity: 1.0;

uniform sampler2D u_texture;
uniform sampler2D u_colorTexture;

varying vec2 v_texCoord;

uniform vec2 u_domain;
uniform float u_noDataValue;
uniform bool u_clampLow: true;
uniform bool u_clampHigh: true;
uniform vec4 u_unpack;

float getElevation(vec2 coord, float bias) {
    // Convert encoded elevation value to meters
    vec4 data = texture2D(u_texture, coord,bias) * 255.0;
    data.a = -1.0;
    return dot(data, u_unpack);
}

vec4 getColor(float value) {
   float normalisedValue =(value- u_domain[0]) / (u_domain[1] - u_domain[0]);
    vec2 coord = vec2(normalisedValue, 0);
    return texture2D(u_colorTexture, coord);
}

void main() {
  float value = getElevation(v_texCoord,0.0);
  if (value == u_noDataValue) {
    gl_FragColor = vec4(0.0, 0, 0, 0.0);
  } else if ((!u_clampLow && value < u_domain[0]) || (!u_clampHigh && value > u_domain[1])) {
     gl_FragColor = vec4(0.0, 0, 0, 0.0);
  } else {
   
    gl_FragColor = getColor(value);
    gl_FragColor.a =  gl_FragColor.a * u_opacity ;
      if(gl_FragColor.a < 0.01)
      discard;
  }
}
`,tN=`precision highp float;
uniform mat4 u_ModelMatrix;

attribute vec3 a_Position;
attribute vec2 a_Uv;
varying vec2 v_texCoord;
#pragma include "projection"
void main() {
   v_texCoord = a_Uv;
   vec4 project_pos = project_position(vec4(a_Position, 1.0));
   gl_Position = project_common_position_to_clipspace_v2(vec4(project_pos.xy,0., 1.0));
}
`,rN=function(e){(0,ke.Z)(r,e);var t=KO(r);function r(){return(0,ue.Z)(this,r),t.apply(this,arguments)}return(0,_e.Z)(r,[{key:"getUninforms",value:function(){var i=this.layer.getLayerConfig(),a=i.opacity,s=i.clampLow,l=s===void 0?!0:s,p=i.clampHigh,m=p===void 0?!0:p,T=i.noDataValue,R=T===void 0?-9999999:T,L=i.domain,z=i.rampColors,re=i.colorTexture,ee=i.rScaler,me=ee===void 0?6553.6:ee,Ie=i.gScaler,He=Ie===void 0?25.6:Ie,Xe=i.bScaler,ot=Xe===void 0?.1:Xe,pt=i.offset,dt=pt===void 0?1e4:pt,It=L||gu(z),Vt=re;return re?this.layer.textureService.setColorTexture(re,z,It):Vt=this.layer.textureService.getColorTexture(z,It),{u_opacity:a||1,u_texture:this.texture,u_domain:It,u_clampLow:l,u_clampHigh:typeof m!="undefined"?m:l,u_noDataValue:R,u_unpack:[me,He,ot,dt],u_colorTexture:Vt}}},{key:"initModels",value:function(){var n=(0,hr.Z)(it().mark(function a(){var s,l,p,m;return it().wrap(function(R){for(;;)switch(R.prev=R.next){case 0:return s=this.layer.getSource(),l=this.rendererService.createTexture2D,R.next=4,s.data.images;case 4:return p=R.sent,this.texture=l({data:p[0],width:p[0].width,height:p[0].height,min:Fe.LINEAR,mag:Fe.LINEAR}),R.next=8,this.layer.buildLayerModel({moduleName:"RasterTileDataImage",vertexShader:tN,fragmentShader:eN,triangulation:rg,primitive:Fe.TRIANGLES,depth:{enable:!1}});case 8:return m=R.sent,R.abrupt("return",[m]);case 10:case"end":return R.stop()}},a,this)}));function i(){return n.apply(this,arguments)}return i}()},{key:"clearModels",value:function(){var i;(i=this.texture)===null||i===void 0||i.destroy()}},{key:"buildModels",value:function(){var n=(0,hr.Z)(it().mark(function a(){return it().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.abrupt("return",this.initModels());case 1:case"end":return l.stop()}},a,this)}));function i(){return n.apply(this,arguments)}return i}()},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"uv",type:bn.Attribute,descriptor:{name:"a_Uv",buffer:{usage:Fe.DYNAMIC_DRAW,data:[],type:Fe.FLOAT},size:2,update:function(a,s,l){return[l[3],l[4]]}}})}}]),r}(Lo),nN={raster:dS,rasterRgb:qO,raster3d:dS,rasterTerrainRgb:rN},iN=nN;function aN(e){var t=oN();return function(){var n=(0,le.Z)(e),i;if(t){var a=(0,le.Z)(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return(0,ze.Z)(this,i)}}function oN(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var b_=function(e){(0,ke.Z)(r,e);var t=aN(r);function r(){var n;(0,ue.Z)(this,r);for(var i=arguments.length,a=new Array(i),s=0;s<i;s++)a[s]=arguments[s];return n=t.call.apply(t,[this].concat(a)),(0,ve.Z)((0,St.Z)(n),"type","RasterLayer"),n}return(0,_e.Z)(r,[{key:"buildModels",value:function(){var n=(0,hr.Z)(it().mark(function a(){var s;return it().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return s=this.getModelType(),this.layerModel=new iN[s](this),p.next=4,this.initLayerModels();case 4:case"end":return p.stop()}},a,this)}));function i(){return n.apply(this,arguments)}return i}()},{key:"getDefaultConfig",value:function(){var i=this.getModelType(),a={raster:{},rasterRgb:{},raster3d:{},rasterTerrainRgb:{}};return a[i]}},{key:"getModelType",value:function(){var i=this.layerSource.getParserType();switch(i){case"raster":return"raster";case"rasterRgb":return"rasterRgb";case"image":return"rasterTerrainRgb";default:return"raster"}}}]),r}(fp),sN=["rasterData"];function uN(e){var t=lN();return function(){var n=(0,le.Z)(e),i;if(t){var a=(0,le.Z)(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return(0,ze.Z)(this,i)}}function lN(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var cN=function(e){(0,ke.Z)(r,e);var t=uN(r);function r(){return(0,ue.Z)(this,r),t.apply(this,arguments)}return(0,_e.Z)(r,[{key:"initTileLayer",value:function(){var n=(0,hr.Z)(it().mark(function a(){var s,l,p,m;return it().wrap(function(R){for(;;)switch(R.prev=R.next){case 0:return s=this.parent.getLayerAttributeConfig(),l=this.getLayerOptions(),p=this.getSourceOption(),m=new b_((0,Q.Z)({},l)).source(p.data,p.options),s&&Object.keys(s).forEach(function(L){var z,re,ee=L;m[ee]((z=s[ee])===null||z===void 0?void 0:z.field,(re=s[ee])===null||re===void 0?void 0:re.values)}),R.next=7,this.addLayer(m);case 7:this.isLoaded=!0;case 8:case"end":return R.stop()}},a,this)}));function i(){return n.apply(this,arguments)}return i}()},{key:"getSourceOption",value:function(){var i=this.parent.getSource(),a=this.sourceTile.data.data,s=a.rasterData,l=(0,Cc.Z)(a,sN);return{data:s,options:{parser:(0,Q.Z)({type:"rasterRgb",extent:this.sourceTile.bounds},l),transforms:i.transforms}}}}]),r}(pA);function fN(e){var t=hN();return function(){var n=(0,le.Z)(e),i;if(t){var a=(0,le.Z)(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return(0,ze.Z)(this,i)}}function hN(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var AN=function(e){(0,ke.Z)(r,e);var t=fN(r);function r(){return(0,ue.Z)(this,r),t.apply(this,arguments)}return(0,_e.Z)(r,[{key:"initTileLayer",value:function(){var n=(0,hr.Z)(it().mark(function a(){var s,l,p,m;return it().wrap(function(R){for(;;)switch(R.prev=R.next){case 0:return s=this.parent.getLayerAttributeConfig(),l=this.getLayerOptions(),p=this.getSourceOption(),m=new b_((0,Q.Z)({},l)).source(p.data,p.options),s&&Object.keys(s).forEach(function(L){var z,re,ee=L;m[ee]((z=s[ee])===null||z===void 0?void 0:z.field,(re=s[ee])===null||re===void 0?void 0:re.values)}),R.next=7,this.addLayer(m);case 7:this.isLoaded=!0;case 8:case"end":return R.stop()}},a,this)}));function i(){return n.apply(this,arguments)}return i}()},{key:"getSourceOption",value:function(){var i=this.parent.getSource();return{data:this.sourceTile.data,options:{parser:{type:"image",extent:this.sourceTile.bounds},transforms:i.transforms}}}}]),r}(pA),pN=["rasterData"];function dN(e){var t=vN();return function(){var n=(0,le.Z)(e),i;if(t){var a=(0,le.Z)(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return(0,ze.Z)(this,i)}}function vN(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var gN={positions:[0,1],colors:["#000","#fff"]},mN=function(e){(0,ke.Z)(r,e);var t=dN(r);function r(){return(0,ue.Z)(this,r),t.apply(this,arguments)}return(0,_e.Z)(r,[{key:"initTileLayer",value:function(){var n=(0,hr.Z)(it().mark(function a(){var s,l,p,m,T,R,L;return it().wrap(function(re){for(;;)switch(re.prev=re.next){case 0:return s=this.parent.getLayerAttributeConfig(),l=this.getLayerOptions(),p=this.getSourceOption(),m=this.getLayerOptions(),T=m.rampColors,R=m.domain,this.colorTexture=this.parent.textureService.getColorTexture(T,R),L=new b_((0,Q.Z)((0,Q.Z)({},l),{},{colorTexture:this.colorTexture})).source(p.data,p.options),s&&Object.keys(s).forEach(function(ee){var me,Ie,He=ee;L[He]((me=s[He])===null||me===void 0?void 0:me.field,(Ie=s[He])===null||Ie===void 0?void 0:Ie.values)}),re.next=9,this.addLayer(L);case 9:this.isLoaded=!0;case 10:case"end":return re.stop()}},a,this)}));function i(){return n.apply(this,arguments)}return i}()},{key:"getSourceOption",value:function(){var i=this.parent.getSource(),a=this.sourceTile.data.data,s=a.rasterData,l=(0,Cc.Z)(a,pN);return{data:s,options:{parser:(0,Q.Z)({type:"raster",extent:this.sourceTile.bounds},l),transforms:i.transforms}}}},{key:"styleUpdate",value:function(){for(var i=this,a=arguments.length,s=new Array(a),l=0;l<a;l++)s[l]=arguments[l];var p=s,m=p.rampColors,T=m===void 0?gN:m,R=p.domain;this.colorTexture=this.parent.textureService.getColorTexture(T,R||gu(T)),this.layers.forEach(function(L){return L.style({colorTexture:i.colorTexture})})}},{key:"destroy",value:function(){this.layers.forEach(function(i){return i.destroy()})}}]),r}(pA);function _N(e){var t=yN();return function(){var n=(0,le.Z)(e),i;if(t){var a=(0,le.Z)(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return(0,ze.Z)(this,i)}}function yN(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var Sg=function(e){(0,ke.Z)(r,e);var t=_N(r);function r(){return(0,ue.Z)(this,r),t.apply(this,arguments)}return(0,_e.Z)(r,[{key:"initTileLayer",value:function(){var n=(0,hr.Z)(it().mark(function a(){var s,l,p,m,T;return it().wrap(function(L){for(;;)switch(L.prev=L.next){case 0:if(s=this.parent.getLayerAttributeConfig(),l=this.getLayerOptions(),p=mO(this.parent.type),m=this.getSourceOption(),m){L.next=8;break}return this.isLoaded=!0,this.emit("loaded"),L.abrupt("return");case 8:return T=new p((0,Q.Z)({},l)).source(m.data,m.options),Object.keys(s).forEach(function(z){var re,ee,me=z;T[me]((re=s[me])===null||re===void 0?void 0:re.field,(ee=s[me])===null||ee===void 0?void 0:ee.values)}),L.next=12,this.addLayer(T);case 12:if(!l.tileMask){L.next=15;break}return L.next=15,this.addTileMask();case 15:this.setLayerMinMaxZoom(T),this.isLoaded=!0,this.emit("loaded");case 18:case"end":return L.stop()}},a,this)}));function i(){return n.apply(this,arguments)}return i}()},{key:"getSourceOption",value:function(){var i=this.parent.getSource(),a=this.parent.getLayerConfig(),s=a.sourceLayer,l=s===void 0?"defaultLayer":s,p=a.featureId,m=p===void 0?"id":p,T=this.getFeatures(l);return{data:{type:"FeatureCollection",features:T},options:{parser:{type:"geojson",featureId:m},transforms:i.transforms}}}},{key:"setLayerMinMaxZoom",value:function(i){i.getModelType()==="text"&&i.updateLayerConfig({maxZoom:this.z+1,minZoom:this.z-1})}},{key:"getFeatures",value:function(i){var a=this.sourceTile.data;return a.getTileData(i)}},{key:"getFeatureById",value:function(i){var a=this.getMainLayer();if(!a)return[];var s=a.getSource().data.dataArray.filter(function(l){return l._id===i});return s}}]),r}(pA);function EN(e){var t=e.type;switch(t){case"PolygonLayer":return Sg;case"LineLayer":return Sg;case"PointLayer":return Sg;case"TileDebugLayer":return TO;case"MaskLayer":return ZO;case"RasterLayer":var r=e.getSource().parser.dataType;switch(r){case ml.RGB:case ml.CUSTOMRGB:return cN;case ml.ARRAYBUFFER:case ml.CUSTOMARRAYBUFFER:return mN;case ml.TERRAINRGB:case ml.CUSTOMTERRAINRGB:return AN;default:return BO}default:return Sg}}var SN=["shape","color","size","style","animate","filter","rotate","scale","setBlend","setSelect","setActive","disableMask","enableMask"],xN=Fn.debounce,vS=function(){function e(t){var r=this;(0,ue.Z)(this,e),(0,ve.Z)(this,"initedTileset",!1),(0,ve.Z)(this,"mapchange",function(){var i;if(r.parent.isVisible()!==!1){var a=r.getCurrentView(),s=a.latLonBounds,l=a.zoom;if(r.mapService.version==="GAODE1.x"){var p=r.parent.getLayerConfig(),m=p.visible;l<2&&m?(r.parent.updateLayerConfig({visible:!1}),r.layerService.reRender()):l>=2&&!m&&(r.parent.updateLayerConfig({visible:!0}),r.layerService.reRender())}r.lastViewStates&&r.lastViewStates.zoom===l&&r.lastViewStates.latLonBounds.toString()===s.toString()||(r.lastViewStates={zoom:l,latLonBounds:s},(i=r.tilesetManager)===null||i===void 0||i.throttleUpdate(l,s))}}),(0,ve.Z)(this,"viewchange",xN(this.mapchange,24)),this.parent=t;var n=this.parent.getContainer();this.rendererService=n.get(xt.IRendererService),this.layerService=n.get(xt.ILayerService),this.mapService=n.get(xt.IMapService),this.pickingService=n.get(xt.IPickingService),this.tileLayerService=new pO({rendererService:this.rendererService,layerService:this.layerService,parent:t}),this.tilePickService=new gO({tileLayerService:this.tileLayerService,layerService:this.layerService,parent:t}),this.parent.setLayerPickService(this.tilePickService),this.proxy(t),this.initTileSetManager()}return(0,_e.Z)(e,[{key:"initTileSetManager",value:function(){var r,n=this.parent.getSource();if(this.tilesetManager=n.tileset,this.initedTileset||(this.bindTilesetEvent(),this.initedTileset=!0),this.parent.isVisible()!==!1){var i=this.getCurrentView(),a=i.latLonBounds,s=i.zoom;(r=this.tilesetManager)===null||r===void 0||r.update(s,a)}}},{key:"getCurrentView",value:function(){var r=this.mapService.getBounds(),n=[r[0][0],r[0][1],r[1][0],r[1][1]],i=this.mapService.getZoom();return{latLonBounds:n,zoom:i}}},{key:"bindTilesetEvent",value:function(){var r=this;this.tilesetManager.on("tile-loaded",function(n){}),this.tilesetManager.on("tile-unload",function(n){r.tileUnLoad(n)}),this.tilesetManager.on("tile-error",function(n,i){r.tileError(n)}),this.tilesetManager.on("tile-update",function(){r.tileUpdate()}),this.mapService.on("zoomend",this.mapchange),this.mapService.on("moveend",this.viewchange)}},{key:"render",value:function(){this.tileLayerService.render()}},{key:"getLayers",value:function(){return this.tileLayerService.getLayers()}},{key:"getTiles",value:function(){return this.tileLayerService.getTiles()}},{key:"getTile",value:function(r){return this.tileLayerService.getTile(r)}},{key:"tileLoaded",value:function(r){}},{key:"tileError",value:function(r){console.warn("error:",r)}},{key:"destroy",value:function(){var r;this.mapService.off("zoomend",this.mapchange),this.mapService.off("moveend",this.viewchange),(r=this.tilesetManager)===null||r===void 0||r.destroy(),this.tileLayerService.destroy()}},{key:"reload",value:function(){var r;this.tilesetManager.clear();var n=this.getCurrentView(),i=n.latLonBounds,a=n.zoom;(r=this.tilesetManager)===null||r===void 0||r.update(a,i)}},{key:"tileUnLoad",value:function(r){this.tileLayerService.removeTile(r.key)}},{key:"tileUpdate",value:function(){var t=(0,hr.Z)(it().mark(function n(){var i=this,a,s;return it().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:if(this.tilesetManager){p.next=2;break}return p.abrupt("return");case 2:return a=this.parent.getMinZoom(),s=this.parent.getMaxZoom(),p.next=6,Promise.all(this.tilesetManager.tiles.filter(function(m){return m.isLoaded}).filter(function(m){return m.isVisibleChange}).filter(function(m){return m.data}).filter(function(m){return m.z>=a&&m.z<s}).map(function(){var m=(0,hr.Z)(it().mark(function T(R){var L,z;return it().wrap(function(ee){for(;;)switch(ee.prev=ee.next){case 0:if(i.tileLayerService.hasTile(R.key)){ee.next=9;break}return L=EN(i.parent),z=new L(R,i.parent),ee.next=5,z.initTileLayer();case 5:i.tilePickService.setPickState(),z.getLayers().length!==0&&(i.tileLayerService.addTile(z),i.tileLayerService.updateTileVisible(R),i.layerService.reRender()),ee.next=12;break;case 9:i.tileLayerService.updateTileVisible(R),i.tilePickService.setPickState(),i.layerService.reRender();case 12:case"end":return ee.stop()}},T)}));return function(T){return m.apply(this,arguments)}}()));case 6:this.tilesetManager.isLoaded&&this.parent.emit("tiles-loaded",this.tilesetManager.currentTiles);case 7:case"end":return p.stop()}},n,this)}));function r(){return t.apply(this,arguments)}return r}()},{key:"setPickState",value:function(r){}},{key:"pickRender",value:function(r){this.tilePickService.pickRender(r)}},{key:"selectFeature",value:function(r){this.tilePickService.selectFeature(r)}},{key:"highlightPickedFeature",value:function(r){this.tilePickService.highlightPickedFeature(r)}},{key:"proxy",value:function(r){var n=this;SN.forEach(function(i){var a=r[i].bind(r);r[i]=function(){for(var s=arguments.length,l=new Array(s),p=0;p<s;p++)l[p]=arguments[p];return a.apply(void 0,l),n.getLayers().map(function(m){m[i].apply(m,l)}),i==="style"&&n.getTiles().forEach(function(m){return m.styleUpdate.apply(m,l)}),r}})}}]),e}(),gS,mS,TN=(gS=(0,Tt.b2)(),gS(mS=function(){function e(){(0,ue.Z)(this,e)}return(0,_e.Z)(e,[{key:"build",value:function(){var t=(0,hr.Z)(it().mark(function n(i){return it().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return i.prepareBuildModel(),s.next=3,i.buildModels();case 3:case"end":return s.stop()}},n)}));function r(n){return t.apply(this,arguments)}return r}()},{key:"initLayerModel",value:function(){var t=(0,hr.Z)(it().mark(function n(i){return it().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,this.build(i);case 2:i.styleNeedUpdate=!1;case 3:case"end":return s.stop()}},n,this)}));function r(n){return t.apply(this,arguments)}return r}()},{key:"prepareLayerModel",value:function(){var t=(0,hr.Z)(it().mark(function n(i){return it().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,this.build(i);case 2:i.styleNeedUpdate=!1;case 3:case"end":return s.stop()}},n,this)}));function r(n){return t.apply(this,arguments)}return r}()},{key:"apply",value:function(r){var n=this;r.hooks.init.tapPromise("LayerModelPlugin",(0,hr.Z)(it().mark(function i(){return it().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:if(!r.getSource().isTile){s.next=4;break}return r.prepareBuildModel(),r.tileLayer=new vS(r),s.abrupt("return");case 4:return r.log(du.BuildModelStart,xu.INIT),s.next=7,n.initLayerModel(r);case 7:r.log(du.BuildModelEnd,xu.INIT);case 8:case"end":return s.stop()}},i)}))),r.hooks.beforeRenderData.tapPromise("LayerModelPlugin",function(){var i=(0,hr.Z)(it().mark(function a(s){return it().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:if(s){p.next=2;break}return p.abrupt("return",!1);case 2:if(!r.getSource().isTile){p.next=5;break}return r.tileLayer=new vS(r),p.abrupt("return",!1);case 5:return r.log(du.BuildModelStart,xu.UPDATE),p.next=8,n.prepareLayerModel(r);case 8:return r.log(du.BuildModelEnd,xu.UPDATE),p.abrupt("return",!0);case 10:case"end":return p.stop()}},a)}));return function(a){return i.apply(this,arguments)}}())}}]),e}())||mS),_S,yS,CN=(_S=(0,Tt.b2)(),_S(yS=function(){function e(){(0,ue.Z)(this,e)}return(0,_e.Z)(e,[{key:"apply",value:function(r){r.hooks.afterInit.tap("LayerStylePlugin",function(){var n=r.getLayerConfig(),i=n.autoFit,a=n.fitBoundsOptions;i&&r.fitBounds(a),r.styleNeedUpdate=!1})}}]),e}())||yS),ES,SS,bN=["type"],xS={directional:{lights:"u_DirectionalLights",num:"u_NumOfDirectionalLights"},spot:{lights:"u_SpotLights",num:"u_NumOfSpotLights"}},RN={type:"directional",direction:[1,10.5,12],ambient:[.2,.2,.2],diffuse:[.6,.6,.6],specular:[.1,.1,.1]},MN={direction:[0,0,0],ambient:[0,0,0],diffuse:[0,0,0],specular:[0,0,0]},wN={position:[0,0,0],direction:[0,0,0],ambient:[0,0,0],diffuse:[0,0,0],specular:[0,0,0],constant:1,linear:0,quadratic:0,angle:14,exponent:40,blur:5};function IN(e){var t={u_DirectionalLights:new Array(3).fill((0,Q.Z)({},MN)),u_NumOfDirectionalLights:0,u_SpotLights:new Array(3).fill((0,Q.Z)({},wN)),u_NumOfSpotLights:0};return(!e||!e.length)&&(e=[RN]),e.forEach(function(r){var n=r.type,i=n===void 0?"directional":n,a=(0,Cc.Z)(r,bN),s=xS[i].lights,l=xS[i].num,p=t[l];t[s][p]=(0,Q.Z)((0,Q.Z)({},t[s][p]),a),t[l]++}),t}var PN=(ES=(0,Tt.b2)(),ES(SS=function(){function e(){(0,ue.Z)(this,e)}return(0,_e.Z)(e,[{key:"apply",value:function(r){r.hooks.beforeRender.tap("LightingPlugin",function(){var n=r.getLayerConfig(),i=n.enableLighting;i&&r.models.forEach(function(a){return a.addUniforms((0,Q.Z)({},IN()))})})}}]),e}())||SS),TS,CS,ON=(TS=(0,Tt.b2)(),TS(CS=function(){function e(){(0,ue.Z)(this,e)}return(0,_e.Z)(e,[{key:"apply",value:function(r,n){var i=this,a=n.rendererService,s=n.postProcessingPassFactory,l=n.normalPassFactory;r.hooks.init.tapPromise("MultiPassRendererPlugin",function(){var p=r.getLayerConfig(),m=p.enableMultiPassRenderer,T=p.passes,R=T===void 0?[]:T;i.enabled=!!m&&r.getLayerConfig().enableMultiPassRenderer!==!1,i.enabled&&(r.multiPassRenderer=L1(r,R,s,l),r.multiPassRenderer.setRenderFlag(!0))}),r.hooks.beforeRender.tap("MultiPassRendererPlugin",function(){if(i.enabled){var p=a.getViewportSize(),m=p.width,T=p.height;r.multiPassRenderer.resize(m,T)}})}}]),e}())||CS),bS,RS,Sp={NONE:0,ENCODE:1,HIGHLIGHT:2},NN=(bS=(0,Tt.b2)(),bS(RS=function(){function e(){(0,ue.Z)(this,e),(0,ve.Z)(this,"PickOption",{u_HighlightColor:[1,0,0,1],u_SelectColor:[1,0,0,1],u_PickingColor:[0,0,0],u_PickingStage:0,u_CurrentSelectedId:[0,0,0],u_PickingThreshold:10,u_PickingBuffer:0,u_shaderPick:0,u_EnableSelect:0,u_activeMix:0})}return(0,_e.Z)(e,[{key:"pickOption2Array",value:function(){return Object.values(this.PickOption).flat()}},{key:"updatePickOption",value:function(r,n){var i=this;Object.keys(r).forEach(function(a){i.PickOption[a]=r[a]}),n.uniformBuffers[1].subData({offset:0,data:new Uint8Array(new Float32Array(this.pickOption2Array()))})}},{key:"apply",value:function(r,n){var i=this,a=n.rendererService,s=n.styleAttributeService;if(!a.uniformBuffers[1]){var l=a.createBuffer({data:new Float32Array(this.pickOption2Array().length),isUBO:!0});a.uniformBuffers[1]=l,this.updatePickOption({},a)}r.hooks.init.tapPromise("PixelPickingPlugin",function(){var p=r.getLayerConfig(),m=p.enablePicking;s.registerStyleAttribute({name:"pickingColor",type:bn.Attribute,descriptor:{name:"a_PickingColor",shaderLocation:tl.PICKING_COLOR,buffer:{data:[],type:Fe.FLOAT},size:3,update:function(R){var L=R.id;return m?Ws(L):[0,0,0]}}})}),r.hooks.beforePickingEncode.tap("PixelPickingPlugin",function(){var p=r.getLayerConfig(),m=p.enablePicking;m&&r.isVisible()&&(i.updatePickOption({u_PickingStage:Sp.ENCODE},a),r.models.forEach(function(T){return T.addUniforms({u_PickingStage:Sp.ENCODE})}))}),r.hooks.afterPickingEncode.tap("PixelPickingPlugin",function(){var p=r.getLayerConfig(),m=p.enablePicking;m&&r.isVisible()&&(i.updatePickOption({u_PickingStage:Sp.HIGHLIGHT},a),r.models.forEach(function(T){return T.addUniforms({u_PickingStage:Sp.HIGHLIGHT})}))}),r.hooks.beforeHighlight.tap("PixelPickingPlugin",function(p){var m=r.getLayerConfig(),T=m.highlightColor,R=m.activeMix,L=R===void 0?0:R,z=typeof T=="string"?Qi(T):T||[1,0,0,1];r.updateLayerConfig({pickedFeatureID:_o(new Uint8Array(p))});var re={u_PickingStage:Sp.HIGHLIGHT,u_PickingColor:p,u_HighlightColor:z.map(function(ee){return ee*255}),u_activeMix:L};i.updatePickOption(re,a),r.models.forEach(function(ee){return ee.addUniforms(re)})}),r.hooks.beforeSelect.tap("PixelPickingPlugin",function(p){var m=r.getLayerConfig(),T=m.selectColor,R=m.selectMix,L=R===void 0?0:R,z=typeof T=="string"?Qi(T):T||[1,0,0,1];r.updateLayerConfig({pickedFeatureID:_o(new Uint8Array(p))});var re={u_PickingStage:Sp.HIGHLIGHT,u_PickingColor:p,u_HighlightColor:z.map(function(ee){return ee*255}),u_activeMix:L,u_CurrentSelectedId:p,u_SelectColor:z.map(function(ee){return ee*255}),u_EnableSelect:1};console.log(re),i.updatePickOption(re,a),r.models.forEach(function(ee){return ee.addUniforms(re)})})}}]),e}())||RS),DN=["mvt","geojsonvt","testTile"];function LN(e){var t=e.getSource();return DN.includes(t.parser.type)}function nF(e){return e.getContext?{width:e.width/DOM.DPR,height:e.height/DOM.DPR}:e.getBoundingClientRect()}var MS,wS,FN=(MS=(0,Tt.b2)(),MS(wS=function(){function e(){(0,ue.Z)(this,e)}return(0,_e.Z)(e,[{key:"apply",value:function(r,n){var i=this,a=n.styleAttributeService;r.hooks.init.tapPromise("RegisterStyleAttributePlugin",function(){LN(r)||i.registerBuiltinAttributes(a,r)})}},{key:"registerBuiltinAttributes",value:function(r,n){if(n.type==="MaskLayer"){this.registerPositionAttribute(r);return}this.registerPositionAttribute(r),this.registerColorAttribute(r),this.registerVertexIdAttribute(r)}},{key:"registerPositionAttribute",value:function(r){r.registerStyleAttribute({name:"position",type:bn.Attribute,descriptor:{name:"a_Position",shaderLocation:tl.POSITION,buffer:{data:[],type:Fe.FLOAT},size:3,update:function(i,a,s){return s.length===2?[s[0],s[1],0]:[s[0],s[1],s[2]]}}})}},{key:"registerColorAttribute",value:function(r){r.registerStyleAttribute({name:"color",type:bn.Attribute,descriptor:{name:"a_Color",shaderLocation:tl.COLOR,buffer:{usage:Fe.DYNAMIC_DRAW,data:[],type:Fe.FLOAT},size:4,update:function(i){var a=i.color;return!a||!a.length?[1,1,1,1]:a}}})}},{key:"registerVertexIdAttribute",value:function(r){r.registerStyleAttribute({name:"vertexId",type:bn.Attribute,descriptor:{name:"a_vertexId",shaderLocation:tl.VERTEX_ID,buffer:{usage:Fe.DYNAMIC_DRAW,data:[],type:Fe.FLOAT},size:1,update:function(i,a){return[a]}}})}}]),e}())||wS),IS,PS,OS,NS,DS,LS,FS,dA,BS,kS,US,ZS,zS,BN=(IS=(0,Tt.b2)(),PS=(0,Tt.f3)(xt.ICameraService),OS=(0,Tt.f3)(xt.ICoordinateSystemService),NS=(0,Tt.f3)(xt.IRendererService),DS=(0,Tt.f3)(xt.IMapService),LS=(0,Tt.f3)(xt.ILayerService),IS(FS=(dA=function(){function e(){(0,ue.Z)(this,e),fa(this,"cameraService",BS,this),fa(this,"coordinateSystemService",kS,this),fa(this,"rendererService",US,this),fa(this,"mapService",ZS,this),fa(this,"layerService",zS,this)}return(0,_e.Z)(e,[{key:"apply",value:function(r){var n=this,i=this.mapService.version,a=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],s=[0,0],l;this.rendererService.uniformBuffers[0]||(l=this.rendererService.createBuffer({data:new Float32Array(16*5+4*6+4),isUBO:!0}),this.rendererService.uniformBuffers[0]=l),r.hooks.beforeRender.tap("ShaderUniformPlugin",function(){var p=r.getLayerConfig().tileOrigin;n.coordinateSystemService.refresh(p),i==="GAODE2.x"&&(n.setLayerCenter(r),a=n.mapService.map.customCoords.getMVPMatrix(),s=n.mapService.getCustomCoordCenter());var m=n.rendererService.getViewportSize(),T=m.width,R=m.height,L=n.generateUBO(a,s,T,R),z=L.data,re=L.uniforms;n.layerService.alreadyInRendering&&l&&l.subData({offset:0,data:z}),r.models.forEach(function(ee){ee.addUniforms((0,Q.Z)((0,Q.Z)({},re),{},{u_PickingBuffer:r.getLayerConfig().pickingBuffer||0,u_shaderPick:Number(r.getShaderPickStat())}))})})}},{key:"setLayerCenter",value:function(r){r.coordCenter===void 0&&(r.coordCenter=r.getSource().center),this.mapService.setCoordCenter&&this.mapService.setCoordCenter(r.coordCenter)}},{key:"generateUBO",value:function(r,n,i,a){var s,l=this.cameraService.getProjectionMatrix(),p=this.cameraService.getViewMatrix(),m=this.cameraService.getViewProjectionMatrix(),T=this.cameraService.getModelMatrix(),R=this.coordinateSystemService.getViewportCenterProjection(),L=this.coordinateSystemService.getPixelsPerDegree(),z=this.cameraService.getZoom(),re=this.coordinateSystemService.getPixelsPerDegree2(),ee=this.cameraService.getZoomScale(),me=this.coordinateSystemService.getPixelsPerMeter(),Ie=this.coordinateSystemService.getCoordinateSystem(),He=this.cameraService.getCameraPosition(),Xe=window.devicePixelRatio,ot=this.coordinateSystemService.getViewportCenter(),pt=[i,a],dt=this.cameraService.getFocalDistance(),It=[].concat((0,cr.Z)(p),(0,cr.Z)(l),(0,cr.Z)(m),(0,cr.Z)(T),(0,cr.Z)(r),(0,cr.Z)(R),(0,cr.Z)(L),[z],(0,cr.Z)(re),[ee],(0,cr.Z)(me),[Ie],(0,cr.Z)(He),[Xe],(0,cr.Z)(ot),pt,(0,cr.Z)(n),[dt,0]);return{data:It,uniforms:(s={},(0,ve.Z)(s,lA.ProjectionMatrix,l),(0,ve.Z)(s,lA.ViewMatrix,p),(0,ve.Z)(s,lA.ViewProjectionMatrix,m),(0,ve.Z)(s,lA.Zoom,z),(0,ve.Z)(s,lA.ZoomScale,ee),(0,ve.Z)(s,lA.FocalDistance,dt),(0,ve.Z)(s,lA.CameraPosition,He),(0,ve.Z)(s,fh.CoordinateSystem,Ie),(0,ve.Z)(s,fh.ViewportCenter,ot),(0,ve.Z)(s,fh.ViewportCenterProjection,R),(0,ve.Z)(s,fh.PixelsPerDegree,L),(0,ve.Z)(s,fh.PixelsPerDegree2,re),(0,ve.Z)(s,fh.PixelsPerMeter,me),(0,ve.Z)(s,fh.Mvp,r),(0,ve.Z)(s,"u_sceneCenterMercator",n),(0,ve.Z)(s,"u_ViewportSize",pt),(0,ve.Z)(s,"u_ModelMatrix",T),(0,ve.Z)(s,"u_DevicePixelRatio",Xe),s)}}}]),e}(),BS=Ji(dA.prototype,"cameraService",[PS],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),kS=Ji(dA.prototype,"coordinateSystemService",[OS],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),US=Ji(dA.prototype,"rendererService",[NS],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ZS=Ji(dA.prototype,"mapService",[DS],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),zS=Ji(dA.prototype,"layerService",[LS],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),dA))||FS),GS,VS,kN=(GS=(0,Tt.b2)(),GS(VS=function(){function e(){(0,ue.Z)(this,e)}return(0,_e.Z)(e,[{key:"apply",value:function(r){r.hooks.beforeRender.tap("UpdateModelPlugin",function(){r.layerModel&&r.layerModel.needUpdate().then(function(n){n&&r.renderLayers()})}),r.hooks.afterRender.tap("UpdateModelPlugin",function(){r.layerModelNeedUpdate=!1})}}]),e}())||VS),HS,WS,UN=(HS=(0,Tt.b2)(),HS(WS=function(){function e(){(0,ue.Z)(this,e)}return(0,_e.Z)(e,[{key:"apply",value:function(r,n){var i=this,a=n.styleAttributeService;r.hooks.init.tapPromise("UpdateStyleAttributePlugin",function(){i.initStyleAttribute(r,{styleAttributeService:a})}),r.hooks.beforeRender.tap("UpdateStyleAttributePlugin",function(){r.layerModelNeedUpdate||r.inited&&i.updateStyleAttribute(r,{styleAttributeService:a})})}},{key:"updateStyleAttribute",value:function(r,n){var i=n.styleAttributeService,a=i.getLayerStyleAttributes()||[],s=i.getLayerStyleAttribute("filter");if(s&&s.needRegenerateVertices){r.layerModelNeedUpdate=!0,a.forEach(function(l){return l.needRegenerateVertices=!1});return}a.filter(function(l){return l.needRegenerateVertices}).forEach(function(l){i.updateAttributeByFeatureRange(l.name,r.getEncodedData(),l.featureRange.startIndex,l.featureRange.endIndex,r),l.needRegenerateVertices=!1})}},{key:"initStyleAttribute",value:function(r,n){var i=n.styleAttributeService,a=i.getLayerStyleAttributes()||[];a.filter(function(s){return s.needRegenerateVertices}).forEach(function(s){i.updateAttributeByFeatureRange(s.name,r.getEncodedData(),s.featureRange.startIndex,s.featureRange.endIndex),s.needRegenerateVertices=!1})}}]),e}())||WS);Rc.bind(xt.ILayerPlugin).to(HI).inRequestScope(),Rc.bind(xt.ILayerPlugin).to(FN).inRequestScope(),Rc.bind(xt.ILayerPlugin).to(fO).inRequestScope(),Rc.bind(xt.ILayerPlugin).to(VI).inRequestScope(),Rc.bind(xt.ILayerPlugin).to(CN).inRequestScope(),Rc.bind(xt.ILayerPlugin).to(AO).inRequestScope(),Rc.bind(xt.ILayerPlugin).to(UN).inRequestScope(),Rc.bind(xt.ILayerPlugin).to(kN).inRequestScope(),Rc.bind(xt.ILayerPlugin).to(ON).inRequestScope(),Rc.bind(xt.ILayerPlugin).to(BN).inRequestScope(),Rc.bind(xt.ILayerPlugin).to(hO).inRequestScope(),Rc.bind(xt.ILayerPlugin).to(PN).inRequestScope(),Rc.bind(xt.ILayerPlugin).to(NN).inRequestScope(),Rc.bind(xt.ILayerPlugin).to(TN).inRequestScope();var jS,R_,XS,ZN=(jS=zm(xt.IGlobalConfigService),R_=function(){function e(t){(0,ue.Z)(this,e),fa(this,"configService",XS,this),this.config=t}return(0,_e.Z)(e,[{key:"setContainer",value:function(r,n,i,a){r.bind(xt.MapConfig).toConstantValue((0,Q.Z)((0,Q.Z)({},this.config),{},{id:n,canvas:i,hasBaseMap:a})),r.bind(xt.IMapService).to(this.getServiceConstructor()).inSingletonScope()}},{key:"getServiceConstructor",value:function(){throw new Error("Method not implemented.")}}]),e}(),XS=Ji(R_.prototype,"configService",[jS],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),R_),zN=C(95906),YS=C.n(zN);function Nd(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function xg(e,t){var r=cv([],t,e);return lv(r,r,1/r[3]),r}function iF(e,t){var r=e%t;return r<0?t+r:r}function aF(e,t,r){return r*t+(1-r)*e}function vA(e,t){if(!e)throw new Error(t||"viewport-mercator-project: assertion failed.")}var Wf=Math.PI,$S=Wf/4,G0=Wf/180,QS=180/Wf,M_=512,w_=4003e4,GN=1.5;function qS(e){return Math.pow(2,e)}function VN(e){return Math.log2(e)}function Tg(e,t){var r=(0,yn.Z)(e,2),n=r[0],i=r[1];vA(Number.isFinite(n)&&Number.isFinite(t)),vA(Number.isFinite(i)&&i>=-90&&i<=90,"invalid latitude"),t*=M_;var a=n*G0,s=i*G0,l=t*(a+Wf)/(2*Wf),p=t*(Wf-Math.log(Math.tan($S+s*.5)))/(2*Wf);return[l,p]}function I_(e,t){var r=(0,yn.Z)(e,2),n=r[0],i=r[1];t*=M_;var a=n/t*(2*Wf)-Wf,s=2*(Math.atan(Math.exp(Wf-i/t*(2*Wf)))-$S);return[a*QS,s*QS]}function oF(e){var t=e.latitude;assert(Number.isFinite(t));var r=Math.cos(t*G0);return VN(w_*r)-9}function KS(e){var t=e.latitude,r=e.longitude,n=e.zoom,i=e.scale,a=e.highPrecision,s=a===void 0?!1:a;i=i!==void 0?i:qS(n),vA(Number.isFinite(t)&&Number.isFinite(r)&&Number.isFinite(i));var l={},p=M_*i,m=Math.cos(t*G0),T=p/360,R=T/m,L=p/w_/m;if(l.pixelsPerMeter=[L,-L,L],l.metersPerPixel=[1/L,-1/L,1/L],l.pixelsPerDegree=[T,-R,L],l.degreesPerPixel=[1/T,-1/R,1/L],s){var z=G0*Math.tan(t*G0)/m,re=T*z/2,ee=p/w_*z,me=ee/R*L;l.pixelsPerDegree2=[0,-re,ee],l.pixelsPerMeter2=[me,0,me]}return l}function sF(e,t){var r=_slicedToArray(e,3),n=r[0],i=r[1],a=r[2],s=_slicedToArray(t,3),l=s[0],p=s[1],m=s[2],T=1,R=KS({longitude:n,latitude:i,scale:T,highPrecision:!0}),L=R.pixelsPerMeter,z=R.pixelsPerMeter2,re=Tg(e,T);re[0]+=l*(L[0]+z[0]*p),re[1]+=p*(L[1]+z[1]*p);var ee=I_(re,T),me=(a||0)+(m||0);return Number.isFinite(a)||Number.isFinite(m)?[ee[0],ee[1],me]:ee}function HN(e){var t=e.height,r=e.pitch,n=e.bearing,i=e.altitude,a=e.center,s=a===void 0?null:a,l=e.flipY,p=l===void 0?!1:l,m=Nd();return Gf(m,m,[0,0,-i]),Do(m,m,[1,1,1/t]),Jo(m,m,-r*G0),Sf(m,m,n*G0),p&&Do(m,m,[1,-1,1]),s&&Gf(m,m,t2([],s)),m}function WN(e){var t=e.width,r=e.height,n=e.altitude,i=n===void 0?GN:n,a=e.pitch,s=a===void 0?0:a,l=e.nearZMultiplier,p=l===void 0?1:l,m=e.farZMultiplier,T=m===void 0?1:m,R=s*G0,L=Math.atan(.5/i),z=Math.sin(L)*i/Math.sin(Math.PI/2-R-L),re=Math.cos(Math.PI/2-R)*z+i;return{fov:2*Math.atan(r/2/i),aspect:t/r,focalDistance:i,near:p,far:re*T}}function jN(e){var t=e.width,r=e.height,n=e.pitch,i=e.altitude,a=e.nearZMultiplier,s=e.farZMultiplier,l=WN({width:t,height:r,altitude:i,pitch:n,nearZMultiplier:a,farZMultiplier:s}),p=l.fov,m=l.aspect,T=l.near,R=l.far,L=wA([],p,m,T,R);return L}function XN(e,t){var r=(0,yn.Z)(e,3),n=r[0],i=r[1],a=r[2],s=a===void 0?0:a;return vA(Number.isFinite(n)&&Number.isFinite(i)&&Number.isFinite(s)),xg(t,[n,i,s,1])}function JS(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,n=(0,yn.Z)(e,3),i=n[0],a=n[1],s=n[2];if(vA(Number.isFinite(i)&&Number.isFinite(a),"invalid pixel coordinate"),Number.isFinite(s)){var l=xg(t,[i,a,s,1]);return l}var p=xg(t,[i,a,0,1]),m=xg(t,[i,a,1,1]),T=p[2],R=m[2],L=T===R?0:((r||0)-T)/(R-T);return gc([],p,m,L)}var ex=Nd(),YN=function(){function e(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=t.width,n=t.height,i=t.viewMatrix,a=i===void 0?ex:i,s=t.projectionMatrix,l=s===void 0?ex:s;(0,ue.Z)(this,e),this.width=r||1,this.height=n||1,this.scale=1,this.pixelsPerMeter=1,this.viewMatrix=a,this.projectionMatrix=l;var p=Nd();$c(p,p,this.projectionMatrix),$c(p,p,this.viewMatrix),this.viewProjectionMatrix=p;var m=Nd();Do(m,m,[this.width/2,-this.height/2,1]),Gf(m,m,[1,-1,0]),$c(m,m,this.viewProjectionMatrix);var T=jd(Nd(),m);if(!T)throw new Error("Pixel project matrix not invertible");this.pixelProjectionMatrix=m,this.pixelUnprojectionMatrix=T,this.equals=this.equals.bind(this),this.project=this.project.bind(this),this.unproject=this.unproject.bind(this),this.projectPosition=this.projectPosition.bind(this),this.unprojectPosition=this.unprojectPosition.bind(this),this.projectFlat=this.projectFlat.bind(this),this.unprojectFlat=this.unprojectFlat.bind(this)}return(0,_e.Z)(e,[{key:"equals",value:function(r){return r instanceof e?r.width===this.width&&r.height===this.height&&Bu(r.projectionMatrix,this.projectionMatrix)&&Bu(r.viewMatrix,this.viewMatrix):!1}},{key:"project",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},i=n.topLeft,a=i===void 0?!0:i,s=this.projectPosition(r),l=XN(s,this.pixelProjectionMatrix),p=(0,yn.Z)(l,2),m=p[0],T=p[1],R=a?T:this.height-T;return r.length===2?[m,R]:[m,R,l[2]]}},{key:"unproject",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},i=n.topLeft,a=i===void 0?!0:i,s=n.targetZ,l=(0,yn.Z)(r,3),p=l[0],m=l[1],T=l[2],R=a?m:this.height-m,L=s&&s*this.pixelsPerMeter,z=JS([p,R,T],this.pixelUnprojectionMatrix,L),re=this.unprojectPosition(z),ee=(0,yn.Z)(re,3),me=ee[0],Ie=ee[1],He=ee[2];return Number.isFinite(T)?[me,Ie,He]:Number.isFinite(s)?[me,Ie,s]:[me,Ie]}},{key:"projectPosition",value:function(r){var n=this.projectFlat(r),i=(0,yn.Z)(n,2),a=i[0],s=i[1],l=(r[2]||0)*this.pixelsPerMeter;return[a,s,l]}},{key:"unprojectPosition",value:function(r){var n=this.unprojectFlat(r),i=(0,yn.Z)(n,2),a=i[0],s=i[1],l=(r[2]||0)/this.pixelsPerMeter;return[a,s,l]}},{key:"projectFlat",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.scale;return r}},{key:"unprojectFlat",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.scale;return r}}]),e}();function $N(e){var t=e.width,r=e.height,n=e.bounds,i=e.minExtent,a=i===void 0?0:i,s=e.maxZoom,l=s===void 0?24:s,p=e.padding,m=p===void 0?0:p,T=e.offset,R=T===void 0?[0,0]:T,L=(0,yn.Z)(n,2),z=(0,yn.Z)(L[0],2),re=z[0],ee=z[1],me=(0,yn.Z)(L[1],2),Ie=me[0],He=me[1];if(Number.isFinite(m)){var Xe=m;m={top:Xe,bottom:Xe,left:Xe,right:Xe}}else vA(Number.isFinite(m.top)&&Number.isFinite(m.bottom)&&Number.isFinite(m.left)&&Number.isFinite(m.right));var ot=new tx({width:t,height:r,longitude:0,latitude:0,zoom:0}),pt=ot.project([re,He]),dt=ot.project([Ie,ee]),It=[Math.max(Math.abs(dt[0]-pt[0]),a),Math.max(Math.abs(dt[1]-pt[1]),a)],Vt=[t-m.left-m.right-Math.abs(R[0])*2,r-m.top-m.bottom-Math.abs(R[1])*2];vA(Vt[0]>0&&Vt[1]>0);var Kt=Vt[0]/It[0],yr=Vt[1]/It[1],_r=(m.right-m.left)/2/Kt,Hr=(m.bottom-m.top)/2/yr,nn=[(dt[0]+pt[0])/2+_r,(dt[1]+pt[1])/2+Hr],Tn=ot.unproject(nn),sa=ot.zoom+Math.log2(Math.abs(Math.min(Kt,yr)));return{longitude:Tn[0],latitude:Tn[1],zoom:Math.min(sa,l)}}var tx=function(e){(0,ke.Z)(t,e);function t(){var r,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},i=n.width,a=n.height,s=n.latitude,l=s===void 0?0:s,p=n.longitude,m=p===void 0?0:p,T=n.zoom,R=T===void 0?0:T,L=n.pitch,z=L===void 0?0:L,re=n.bearing,ee=re===void 0?0:re,me=n.altitude,Ie=me===void 0?1.5:me,He=n.nearZMultiplier,Xe=n.farZMultiplier;(0,ue.Z)(this,t),i=i||1,a=a||1;var ot=qS(R);Ie=Math.max(.75,Ie);var pt=Tg([m,l],ot);pt[2]=0;var dt=jN({width:i,height:a,pitch:z,bearing:ee,altitude:Ie,nearZMultiplier:He||1/a,farZMultiplier:Xe||1.01}),It=HN({height:a,center:pt,pitch:z,bearing:ee,altitude:Ie,flipY:!0});return r=(0,ze.Z)(this,(0,le.Z)(t).call(this,{width:i,height:a,viewMatrix:It,projectionMatrix:dt})),r.latitude=l,r.longitude=m,r.zoom=R,r.pitch=z,r.bearing=ee,r.altitude=Ie,r.scale=ot,r.center=pt,r.pixelsPerMeter=KS((0,St.Z)((0,St.Z)(r))).pixelsPerMeter[2],Object.freeze((0,St.Z)((0,St.Z)(r))),r}return(0,_e.Z)(t,[{key:"projectFlat",value:function(n){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.scale;return Tg(n,i)}},{key:"unprojectFlat",value:function(n){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.scale;return I_(n,i)}},{key:"getMapCenterByLngLatPosition",value:function(n){var i=n.lngLat,a=n.pos,s=JS(a,this.pixelUnprojectionMatrix),l=Tg(i,this.scale),p=Qa([],l,vc([],s)),m=Qa([],this.center,p);return I_(m,this.scale)}},{key:"getLocationAtPoint",value:function(n){var i=n.lngLat,a=n.pos;return this.getMapCenterByLngLatPosition({lngLat:i,pos:a})}},{key:"fitBounds",value:function(n){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},a=this.width,s=this.height,l=$N(Object.assign({width:a,height:s,bounds:n},i)),p=l.longitude,m=l.latitude,T=l.zoom;return new t({width:a,height:s,longitude:p,latitude:m,zoom:T})}}]),t}(YN),QN=function(){function e(){(0,ue.Z)(this,e)}return(0,_e.Z)(e,[{key:"syncWithMapCamera",value:function(r){var n=r.center,i=r.zoom,a=r.pitch,s=r.bearing,l=r.viewportHeight,p=r.viewportWidth,m=this.viewport?{width:this.viewport.width,height:this.viewport.height,longitude:this.viewport.center[0],latitude:this.viewport.center[1],zoom:this.viewport.zoom,pitch:this.viewport.pitch,bearing:this.viewport.bearing}:{};this.viewport=new tx((0,Q.Z)((0,Q.Z)({},m),{},{width:p,height:l,longitude:n&&n[0],latitude:n&&n[1],zoom:i,pitch:a,bearing:s}))}},{key:"getZoom",value:function(){return this.viewport.zoom}},{key:"getZoomScale",value:function(){return Math.pow(2,this.getZoom())}},{key:"getCenter",value:function(){return[this.viewport.longitude,this.viewport.latitude]}},{key:"getProjectionMatrix",value:function(){return this.viewport.projectionMatrix}},{key:"getModelMatrix",value:function(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}},{key:"getViewMatrix",value:function(){return this.viewport.viewMatrix}},{key:"getViewMatrixUncentered",value:function(){return this.viewport.viewMatrixUncentered}},{key:"getViewProjectionMatrix",value:function(){return this.viewport.viewProjectionMatrix}},{key:"getViewProjectionMatrixUncentered",value:function(){return this.viewport.viewProjectionMatrix}},{key:"getFocalDistance",value:function(){return 1}},{key:"projectFlat",value:function(r,n){return this.viewport.projectFlat(r,n)}}]),e}(),qN=function(){function e(t){(0,ue.Z)(this,e),(0,ve.Z)(this,"size",1e4),this.size=t||1e4}return(0,_e.Z)(e,[{key:"setSize",value:function(r){this.size=r}},{key:"getSize",value:function(){return[this.size,this.size]}},{key:"mercatorXfromLng",value:function(r){return(180+r)/360*this.size}},{key:"mercatorYfromLat",value:function(r){return(1-(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+r*Math.PI/360)))/360)*this.size}},{key:"lngFromMercatorX",value:function(r){return r/this.size*360-180}},{key:"latFromMercatorY",value:function(r){var n=180-(1-r/this.size)*360;return 360/Math.PI*Math.atan(Math.exp(n*Math.PI/180))-90}},{key:"project",value:function(r){var n=this.mercatorXfromLng(r[0]),i=this.mercatorYfromLat(r[1]);return[n,i]}},{key:"unproject",value:function(r){var n=this.lngFromMercatorX(r[0]),i=this.latFromMercatorY(r[1]);return[n,i]}}]),e}();function rx(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t={top:0,right:0,bottom:0,left:0};if(typeof e=="number")return{top:e,right:e,bottom:e,left:e};if(Array.isArray(e)){if(e.length===4)return{top:e[0],right:e[1],bottom:e[2],left:e[3]};if(e.length===2)return{top:e[0],right:e[1],bottom:e[0],left:e[1]}}return(0,Q.Z)((0,Q.Z)({},t),e)}var KN={normal:"amap://styles/normal",light:"amap://styles/c422f5c0cfced5be9fe3a83f05f28a68?isPublic=true",dark:"amap://styles/c9f1d10cae34f8ab05e425462c5a58d7?isPublic=true",blank:"amap://styles/07c17002b38775b32a7a76c66cf90e99?isPublic=true",fresh:"amap://styles/fresh",grey:"amap://styles/grey",graffiti:"amap://styles/graffiti",macaron:"amap://styles/macaron",darkblue:"amap://styles/darkblue",wine:"amap://styles/wine"},JN=["id","style","minZoom","maxZoom","token","mapInstance","plugin"],nx,ix,ax,ox,sx,ux,xp,lx,cx,fx,hx;function e6(e,t){var r=typeof my!="undefined"&&!!my&&typeof my.showToast=="function"&&my.isFRM!==!0,n=typeof wx!="undefined"&&wx!==null&&(typeof wx.request!="undefined"||typeof wx.miniProgram!="undefined");if(!(r||n)&&(t||(t=document),!!t)){var i=t.head||t.getElementsByTagName("head")[0];if(!i){i=t.createElement("head");var a=t.body||t.getElementsByTagName("body")[0];a?a.parentNode.insertBefore(i,a):t.documentElement.appendChild(i)}var s=t.createElement("style");return s.type="text/css",s.styleSheet?s.styleSheet.cssText=e:s.appendChild(t.createTextNode(e)),i.appendChild(s),s}}e6(`.amap-logo{
 display: none !important;
}
`);var t6={contextmenu:"rightclick"},r6={contextmenu:"rightclick",camerachange:"viewchange"},Ax={"GAODE1.x":t6,"GAODE2.x":r6},n6=0;window.forceWebGL=!0;var px="15cd8a57710d40c9b7c0e3cc120f1200",i6="1.4.15",a6="amap-script",P_=!1,Cg=[],o6=12,s6=(nx=(0,Tt.b2)(),ix=(0,Tt.f3)(xt.IGlobalConfigService),ax=(0,Tt.f3)(xt.MapConfig),ox=(0,Tt.f3)(xt.ICoordinateSystemService),sx=(0,Tt.f3)(xt.IEventEmitter),nx(ux=(xp=function(){function e(){var t=this;(0,ue.Z)(this,e),(0,ve.Z)(this,"version",zu["GAODE1.x"]),(0,ve.Z)(this,"simpleMapCoord",new qN),(0,ve.Z)(this,"bgColor","rgba(0, 0, 0, 0)"),fa(this,"configService",lx,this),fa(this,"config",cx,this),fa(this,"coordinateSystemService",fx,this),fa(this,"eventEmitter",hx,this),(0,ve.Z)(this,"handleCameraChanged",function(r){var n=r.camera,i=n.fov,a=n.near,s=n.far,l=n.height,p=n.pitch,m=n.rotation,T=n.aspect,R=n.position,L=t.getCenter(),z=L.lng,re=L.lat;if(t.emit("mapchange"),t.cameraChangedCallback){t.viewport.syncWithMapCamera({aspect:T,bearing:360-m,far:s,fov:i,cameraHeight:l,near:a,pitch:p,zoom:t.map.getZoom()-1,center:[z,re],offsetOrigin:[R.x,R.y]});var ee=t.config.offsetZoom,me=ee===void 0?o6:ee;t.viewport.getZoom()>me?t.coordinateSystemService.setCoordinateSystem(c0.P20_OFFSET):t.coordinateSystemService.setCoordinateSystem(c0.P20),t.cameraChangedCallback(t.viewport)}})}return(0,_e.Z)(e,[{key:"setBgColor",value:function(r){this.bgColor=r}},{key:"addMarkerContainer",value:function(){var r=this.map.getContainer();if(r!==null){var n=r.getElementsByClassName("amap-maps")[0];this.markerContainer=wi("div","l7-marker-container",n)}}},{key:"getMarkerContainer",value:function(){return this.markerContainer}},{key:"on",value:function(r,n){g1.indexOf(r)!==-1?this.eventEmitter.on(r,n):this.map.on(Ax[this.version][r]||r,n)}},{key:"off",value:function(r,n){g1.indexOf(r)!==-1?this.eventEmitter.off(r,n):this.map.off(Ax[this.version][r]||r,n)}},{key:"getContainer",value:function(){return this.map.getContainer()}},{key:"getMapCanvasContainer",value:function(){var r;return(r=this.map.getContainer())===null||r===void 0?void 0:r.getElementsByClassName("amap-maps")[0]}},{key:"getSize",value:function(){var r=this.map.getSize();return[r.getWidth(),r.getHeight()]}},{key:"getType",value:function(){return"amap"}},{key:"getZoom",value:function(){return this.map.getZoom()-1}},{key:"setZoom",value:function(r){return this.map.setZoom(r+1)}},{key:"getCenter",value:function(r){if(r!=null&&r.padding){var n=this.getCenter(),i=rx(r.padding),a=this.lngLatToPixel([n.lng,n.lat]),s=[(i.right-i.left)/2,(i.bottom-i.top)/2],l=this.pixelToLngLat([a.x-s[0],a.y-s[1]]);return l}var p=this.map.getCenter();return{lng:p.getLng(),lat:p.getLat()}}},{key:"setCenter",value:function(r,n){if(n!=null&&n.padding){var i=rx(n.padding),a=this.lngLatToPixel(r),s=[(i.right-i.left)/2,(i.bottom-i.top)/2],l=this.pixelToLngLat([a.x+s[0],a.y+s[1]]);this.map.setCenter([l.lng,l.lat])}else this.map.setCenter(r)}},{key:"getPitch",value:function(){return this.map.getPitch()}},{key:"getRotation",value:function(){return 360-this.map.getRotation()}},{key:"getBounds",value:function(){var r=this.map.getBounds().toBounds(),n=r.getNorthEast(),i=r.getSouthWest(),a=this.getCenter(),s=a.lng>n.getLng()||a.lng<i.getLng()?180-n.getLng():n.getLng(),l=a.lng<i.getLng()?i.getLng()-180:i.getLng();return[[l,i.getLat()],[s,n.getLat()]]}},{key:"getMinZoom",value:function(){var r=this.map.get("zooms");return r[0]-1}},{key:"getMaxZoom",value:function(){var r=this.map.get("zooms");return r[1]-1}},{key:"setRotation",value:function(r){return this.map.setRotation(r)}},{key:"setPitch",value:function(r){return this.map.setPitch(r)}},{key:"zoomIn",value:function(){this.map.zoomIn()}},{key:"zoomOut",value:function(){this.map.zoomOut()}},{key:"panTo",value:function(r){this.map.panTo(r)}},{key:"panBy",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;this.map.panBy(r,n)}},{key:"fitBounds",value:function(r){this.map.setBounds(new AMap.Bounds([r[0][0],r[0][1],r[1][0],r[1][1]]))}},{key:"setZoomAndCenter",value:function(r,n){this.map.setZoomAndCenter(r+1,n)}},{key:"setMapStyle",value:function(r){this.map.setMapStyle(this.getMapStyleValue(r))}},{key:"setMapStatus",value:function(r){this.map.setStatus(r)}},{key:"getMapStyleConfig",value:function(){return KN}},{key:"getMapStyleValue",value:function(r){return this.getMapStyleConfig()[r]||r}},{key:"getMapStyle",value:function(){return this.map.getMapStyle()}},{key:"pixelToLngLat",value:function(r){var n=this.map.pixelToLngLat(new AMap.Pixel(r[0],r[1]));return{lng:n.getLng(),lat:n.getLat()}}},{key:"lngLatToPixel",value:function(r){var n=this.map.lnglatToPixel(new AMap.LngLat(r[0],r[1]));return{x:n.getX(),y:n.getY()}}},{key:"containerToLngLat",value:function(r){var n=new AMap.Pixel(r[0],r[1]),i=this.map.containerToLngLat(n);return{lng:i==null?void 0:i.getLng(),lat:i==null?void 0:i.getLat()}}},{key:"lngLatToContainer",value:function(r){var n=new AMap.LngLat(r[0],r[1]),i=this.map.lngLatToContainer(n);return{x:i.getX(),y:i.getY()}}},{key:"lngLatToCoord",value:function(r){var n=this.map.lngLatToGeodeticCoord(r),i=n.x,a=n.y;return[i,-a]}},{key:"lngLatToMercator",value:function(r,n){return{x:0,y:0,z:0}}},{key:"getModelMatrix",value:function(r,n,i){var a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:[1,1,1],s=this.viewport.projectFlat(r),l=_i();return Gf(l,l,rl(s[0],s[1],n)),Do(l,l,rl(a[0],a[1],a[2])),Jo(l,l,i[0]),dl(l,l,i[1]),Sf(l,l,i[2]),l}},{key:"init",value:function(){var t=(0,hr.Z)(it().mark(function n(){var i=this,a,s,l,p,m,T,R,L,z,re,ee,me,Ie,He;return it().wrap(function(ot){for(;;)switch(ot.prev=ot.next){case 0:return a=this.config,s=a.id,l=a.style,p=l===void 0?"light":l,m=a.minZoom,T=m===void 0?0:m,R=a.maxZoom,L=R===void 0?18:R,z=a.token,re=z===void 0?px:z,ee=a.mapInstance,me=a.plugin,Ie=me===void 0?[]:me,He=(0,Cc.Z)(a,JN),ot.next=3,new Promise(function(pt){var dt=function(){if(ee)i.map=ee,i.$mapContainer=i.map.getContainer(),setTimeout(function(){i.map.on("camerachange",i.handleCameraChanged),pt()},30);else{i.$mapContainer=i.creatMapContainer(s);var Vt=(0,Q.Z)({mapStyle:i.getMapStyleValue(p),zooms:[T,L],viewMode:"3D"},He);Vt.zoom&&(Vt.zoom+=1);var Kt=new AMap.Map(i.$mapContainer,Vt);Kt.on("camerachange",i.handleCameraChanged),Kt.on("camerachange",function(){setTimeout(function(){return i.handleAfterMapChange()})}),i.map=Kt,setTimeout(function(){pt()},10)}};!P_&&!ee?(re===px&&console.warn("%c".concat(i.configService.getSceneWarninfo("MapToken"),"!"),"color: #873bf4;font-weigh:900;font-size: 16px;"),P_=!0,Ie.push("Map3D"),YS().load({key:re,version:i6,plugins:Ie}).then(function(){dt(),Cg.length&&(Cg.forEach(function(It){return It()}),Cg=[])}).catch(function(It){throw new Error(It)})):P_&&window.AMap||ee?dt():Cg.push(dt)});case 3:this.viewport=new QN;case 4:case"end":return ot.stop()}},n,this)}));function r(){return t.apply(this,arguments)}return r}()},{key:"meterToCoord",value:function(r,n){var i=AMap.GeometryUtil.distance(Wt(AMap.LngLat,(0,cr.Z)(r)),Wt(AMap.LngLat,(0,cr.Z)(n))),a=this.lngLatToCoord(r),s=(0,yn.Z)(a,2),l=s[0],p=s[1],m=this.lngLatToCoord(n),T=(0,yn.Z)(m,2),R=T[0],L=T[1],z=Math.sqrt(Math.pow(l-R,2)+Math.pow(p-L,2));return z/i}},{key:"updateView",value:function(r){}},{key:"getOverlayContainer",value:function(){}},{key:"exportMap",value:function(r){var n,i=(n=this.getContainer())===null||n===void 0?void 0:n.getElementsByClassName("amap-layer")[0],a=r==="jpg"?i==null?void 0:i.toDataURL("image/jpeg"):i==null?void 0:i.toDataURL("image/png");return a}},{key:"emit",value:function(r){for(var n,i=arguments.length,a=new Array(i>1?i-1:0),s=1;s<i;s++)a[s-1]=arguments[s];(n=this.eventEmitter).emit.apply(n,[r].concat(a))}},{key:"once",value:function(r){for(var n,i=arguments.length,a=new Array(i>1?i-1:0),s=1;s<i;s++)a[s-1]=arguments[s];(n=this.eventEmitter).once.apply(n,[r].concat(a))}},{key:"destroy",value:function(){var r;(r=this.$mapContainer)===null||r===void 0||(r=r.parentNode)===null||r===void 0||r.removeChild(this.$mapContainer),delete window.initAMap;var n=document.getElementById(a6);n&&document.head.removeChild(n),this.map.destroy()}},{key:"getMapContainer",value:function(){return this.$mapContainer}},{key:"onCameraChanged",value:function(r){this.cameraChangedCallback=r}},{key:"handleAfterMapChange",value:function(){this.emit("mapAfterFrameChange")}},{key:"creatMapContainer",value:function(r){var n=r;typeof r=="string"&&(n=document.getElementById(r));var i=document.createElement("div");return i.style.cssText+=`
       position: absolute;
       top: 0;
       height: 100%;
       width: 100%;
     `,i.id="l7_amap_div"+n6++,n.appendChild(i),i}}]),e}(),lx=Ji(xp.prototype,"configService",[ix],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),cx=Ji(xp.prototype,"config",[ax],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),fx=Ji(xp.prototype,"coordinateSystemService",[ox],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),hx=Ji(xp.prototype,"eventEmitter",[sx],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),xp))||ux),u6=function(){function e(){(0,ue.Z)(this,e),(0,ve.Z)(this,"projectionMatrix",_i()),(0,ve.Z)(this,"viewMatrix",_i()),(0,ve.Z)(this,"viewProjectionMatrix",_i()),(0,ve.Z)(this,"ViewProjectionMatrixUncentered",_i()),(0,ve.Z)(this,"viewUncenteredMatrix",_i())}return(0,_e.Z)(e,[{key:"syncWithMapCamera",value:function(r){var n=r.zoom,i=n===void 0?1:n,a=r.center,s=a===void 0?[0,0]:a,l=r.offsetOrigin,p=l===void 0?[0,0]:l,m=r.cameraPosition,T=m===void 0?[0,0,0]:m,R=r.up,L=R===void 0?[0,1,0]:R,z=r.lookAt,re=z===void 0?[0,0,0]:z,ee=r.aspect,me=ee===void 0?1:ee,Ie=r.near,He=Ie===void 0?.1:Ie,Xe=r.far,ot=Xe===void 0?1e3:Xe,pt=r.fov,dt=pt===void 0?45:pt;this.zoom=i,this.center=s,wA(this.projectionMatrix,dt/180*Math.PI,me,He,ot);var It=rl.apply(D,(0,cr.Z)(T)),Vt=rl.apply(D,(0,cr.Z)(re)),Kt=rl.apply(D,(0,cr.Z)(L));Qh(this.viewMatrix,It,Vt,Kt),this.viewUncenteredMatrix=ro(this.viewMatrix),Gf(this.viewMatrix,this.viewMatrix,rl(-p[0],p[1],0)),$c(this.viewProjectionMatrix,this.projectionMatrix,this.viewMatrix),$c(this.ViewProjectionMatrixUncentered,this.projectionMatrix,this.viewMatrix)}},{key:"getZoom",value:function(){return this.zoom}},{key:"getZoomScale",value:function(){return 1048576}},{key:"getCenter",value:function(){var r=(0,yn.Z)(this.center,2),n=r[0],i=r[1];return[n,i]}},{key:"getProjectionMatrix",value:function(){return this.projectionMatrix}},{key:"getModelMatrix",value:function(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}},{key:"getViewMatrix",value:function(){return this.viewMatrix}},{key:"getViewMatrixUncentered",value:function(){return this.viewUncenteredMatrix}},{key:"getViewProjectionMatrix",value:function(){return this.viewProjectionMatrix}},{key:"getViewProjectionMatrixUncentered",value:function(){return this.ViewProjectionMatrixUncentered}},{key:"getFocalDistance",value:function(){return 1.2}},{key:"projectFlat",value:function(r){var n=85.0511287798,i=Math.max(Math.min(n,r[1]),-n),a=256<<20,s=Math.PI/180,l=r[0]*s,p=i*s;p=Math.log(Math.tan(Math.PI/4+p/2));var m=.5/Math.PI,T=.5,R=-.5/Math.PI;return s=.5,l=a*(m*l+T)-215440491,p=-(a*(R*p+s)-106744817),[l,p]}}]),e}(),l6=["id","style","minZoom","maxZoom","token","mapInstance","plugin","version"],dx,vx;function c6(e){var t=f6();return function(){var n=(0,le.Z)(e),i;if(t){var a=(0,le.Z)(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return(0,ze.Z)(this,i)}}function f6(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}function h6(e,t){var r=typeof my!="undefined"&&!!my&&typeof my.showToast=="function"&&my.isFRM!==!0,n=typeof wx!="undefined"&&wx!==null&&(typeof wx.request!="undefined"||typeof wx.miniProgram!="undefined");if(!(r||n)&&(t||(t=document),!!t)){var i=t.head||t.getElementsByTagName("head")[0];if(!i){i=t.createElement("head");var a=t.body||t.getElementsByTagName("body")[0];a?a.parentNode.insertBefore(i,a):t.documentElement.appendChild(i)}var s=t.createElement("style");return s.type="text/css",s.styleSheet?s.styleSheet.cssText=e:s.appendChild(t.createTextNode(e)),i.appendChild(s),s}}h6(`.amap-logo{
 display: none !important;
}
`);var gx=[108.92361,34.54083];window.forceWebGL=!0;var mx="f59bcf249433f8b05caaee19f349b3d7",_x="2.0",uF=!1,lF=null,A6=(dx=(0,Tt.b2)(),dx(vx=function(e){(0,ke.Z)(r,e);var t=c6(r);function r(){var n;(0,ue.Z)(this,r);for(var i=arguments.length,a=new Array(i),s=0;s<i;s++)a[s]=arguments[s];return n=t.call.apply(t,[this].concat(a)),(0,ve.Z)((0,St.Z)(n),"version","GAODE2.x"),(0,ve.Z)((0,St.Z)(n),"handleViewChanged",function(l){var p=n.map.customCoords.getCameraParams(),m=p.fov,T=p.near,R=p.far,L=p.aspect,z=p.position,re=p.lookAt,ee=p.up;n.emit("mapchange");var me=n.map.customCoords.getCenter();n.cameraChangedCallback&&(n.viewport.syncWithMapCamera({aspect:L,far:R,fov:m,cameraPosition:z,lookAt:re,up:ee,near:T,zoom:n.map.getZoom()-1,center:me,offsetOrigin:[z[0],z[1]]}),n.coordinateSystemService.setCoordinateSystem(c0.P20_2),n.cameraChangedCallback(n.viewport))}),n}return(0,_e.Z)(r,[{key:"setCustomCoordCenter",value:function(i){this.sceneCenter=i,this.sceneCenterMercator=Qs.apply(void 0,(0,cr.Z)(i))}},{key:"getCustomCoordCenter",value:function(){return this.sceneCenterMercator}},{key:"lngLatToCoordByLayer",value:function(i,a){var s=a||this.sceneCenterMercator,l=this._sub(Qs(i[0],i[1]),s);return i[2]&&l.push(i[2]),l}},{key:"coordToAMap2RelativeCoordinates",value:function(i,a){var s=this,l=Qs(a[0],a[1]);return typeof i[0]=="number"?this.lngLatToCoordByLayer(i,l):i.map(function(p){return Array.isArray(p)&&typeof p[0]=="number"?s.lngLatToCoordByLayer(p,l):p.map(function(m){return s.lngLatToCoordByLayer(m,l)})})}},{key:"setCoordCenter",value:function(i){this.map.customCoords.setCenter(i||gx),this.setCustomCoordCenter(i||gx)}},{key:"lngLatToCoord",value:function(i){return this.sceneCenter||(this.map.customCoords.setCenter(i),this.setCustomCoordCenter(i)),this._sub(Qs(i[0],i[1]),this.sceneCenterMercator)}},{key:"lngLatToCoords",value:function(i){var a=this;return i.map(function(s){return typeof s[0]=="number"?a.lngLatToCoord(s):s.map(function(l){return a.lngLatToCoord(l)})})}},{key:"addMarkerContainer",value:function(){if(this.map){var i=this.map.getContainer();if(i!==null){var a=i.getElementsByClassName("amap-maps")[0];a.style.zIndex="auto",this.markerContainer=wi("div","l7-marker-container2",a)}}}},{key:"updateView",value:function(i){}},{key:"getOverlayContainer",value:function(){}},{key:"getType",value:function(){return"amap2"}},{key:"getBounds",value:function(){var i=this.map.getBounds(),a=i.getNorthEast(),s=i.getSouthWest(),l=this.getCenter(),p=l.lng>a.getLng()||l.lng<s.getLng()?180-a.getLng():a.getLng(),m=l.lng<s.getLng()?s.getLng()-180:s.getLng();return[[m,s.getLat()],[p,a.getLat()]]}},{key:"getMinZoom",value:function(){var i=this.map.getZooms();return i[0]-1}},{key:"getMaxZoom",value:function(){var i=this.map.getZooms();return i[1]-1}},{key:"lngLatToContainer",value:function(i){var a=this.map.lngLatToContainer(i);return{x:a.getX(),y:a.getY()}}},{key:"lngLatToPixel",value:function(i){var a=this.map.lngLatToPixel(new AMap.LngLat(i[0],i[1]));return{x:a.getX(),y:a.getY()}}},{key:"getModelMatrix",value:function(i,a,s){var l=arguments.length>3&&arguments[3]!==void 0?arguments[3]:[1,1,1],p=this.map.customCoords.lngLatToCoord(i),m=_i();return Gf(m,m,rl(p[0],p[1],a)),Do(m,m,rl(l[0],l[1],l[2])),Jo(m,m,s[0]),dl(m,m,s[1]),Sf(m,m,s[2]),m}},{key:"init",value:function(){var n=(0,hr.Z)(it().mark(function a(){var s,l,p,m,T,R,L,z,re,ee,me,Ie,He,Xe,ot,pt,dt,It,Vt,Kt,yr,_r;return it().wrap(function(nn){for(;;)switch(nn.prev=nn.next){case 0:if(s=this.config,l=s.id,p=s.style,m=p===void 0?"light":p,T=s.minZoom,R=T===void 0?0:T,L=s.maxZoom,z=L===void 0?18:L,re=s.token,ee=re===void 0?mx:re,me=s.mapInstance,Ie=s.plugin,He=Ie===void 0?[]:Ie,Xe=s.version,ot=Xe===void 0?_x:Xe,pt=(0,Cc.Z)(s,l6),this.viewport=new u6,window.AMap||me){nn.next=6;break}return He.push("Map3D"),nn.next=6,YS().load({key:ee,version:_x,plugins:He});case 6:me?(this.map=me,this.$mapContainer=this.map.getContainer(),It=this.map.getCenter(),(dt=this.map.customCoords)===null||dt===void 0||dt.setCenter([It.lng,It.lat]),this.setCustomCoordCenter([It.lng,It.lat]),this.map.on("viewchange",this.handleViewChanged)):(this.$mapContainer=this.creatMapContainer(l),Kt=(0,Q.Z)({mapStyle:this.getMapStyleValue(m),zooms:[R,z],viewMode:"3D"},pt),Kt.zoom&&(Kt.zoom+=1),ee===mx&&(window._AMapSecurityConfig={securityJsCode:"2653011adeb04230b3a26cc9a780a800"},console.warn("%c".concat(this.configService.getSceneWarninfo("MapToken"),"!"),"color: #873bf4;font-weigh:900;font-size: 16px;")),yr=new AMap.Map(this.$mapContainer,Kt),this.map=yr,_r=yr.getCenter(),(Vt=this.map.customCoords)===null||Vt===void 0||Vt.setCenter([_r.lng,_r.lat]),this.setCustomCoordCenter([_r.lng,_r.lat]),yr.on("viewchange",this.handleViewChanged)),this.initViewPort();case 8:case"end":return nn.stop()}},a,this)}));function i(){return n.apply(this,arguments)}return i}()},{key:"getMapContainer",value:function(){return this.$mapContainer}},{key:"onCameraChanged",value:function(i){this.cameraChangedCallback=i}},{key:"initViewPort",value:function(){var i,a=(i=this.map.customCoords)===null||i===void 0?void 0:i.getCameraParams(),s=a.fov,l=a.near,p=a.far,m=a.aspect,T=a.position,R=a.lookAt,L=a.up;this.emit("mapchange");var z=this.map.customCoords.getCenter(),re=this.map.getZoom();this.cameraChangedCallback&&(this.viewport.syncWithMapCamera({aspect:m,far:p,fov:s,cameraPosition:T,lookAt:R,near:l,up:L,zoom:re-1,center:z,offsetOrigin:[T[0],T[1]]}),this.coordinateSystemService.setCoordinateSystem(c0.P20_2),this.cameraChangedCallback(this.viewport))}},{key:"_sub",value:function(i,a){var s=[0,0];return s[0]=i[0]-a[0],s[1]=i[1]-a[1],s}}]),r}(s6))||vx);function p6(e){var t=d6();return function(){var n=(0,le.Z)(e),i;if(t){var a=(0,le.Z)(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return(0,ze.Z)(this,i)}}function d6(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var v6=function(e){(0,ke.Z)(r,e);var t=p6(r);function r(){return(0,ue.Z)(this,r),t.apply(this,arguments)}return(0,_e.Z)(r,[{key:"getServiceConstructor",value:function(){return A6}}]),r}(ZN),g6=C(45409),m6=C.n(g6),_6=function(){function e(t,r){(0,ue.Z)(this,e);var n=r.buffer,i=r.offset,a=r.stride,s=r.normalized,l=r.size,p=r.divisor;this.buffer=n,this.attribute={buffer:n.get(),offset:i||0,stride:a||0,normalized:s||!1,divisor:p||0},l&&(this.attribute.size=l)}return(0,_e.Z)(e,[{key:"get",value:function(){return this.attribute}},{key:"updateBuffer",value:function(r){this.buffer.subData(r)}},{key:"destroy",value:function(){this.buffer.destroy()}}]),e}(),V0,Dd,bh,wf,Ld,Rh,Fd,bg,h0,gA,El,A0,p0,Rg,y6=(V0={},(0,ve.Z)(V0,Fe.POINTS,"points"),(0,ve.Z)(V0,Fe.LINES,"lines"),(0,ve.Z)(V0,Fe.LINE_LOOP,"line loop"),(0,ve.Z)(V0,Fe.LINE_STRIP,"line strip"),(0,ve.Z)(V0,Fe.TRIANGLES,"triangles"),(0,ve.Z)(V0,Fe.TRIANGLE_FAN,"triangle fan"),(0,ve.Z)(V0,Fe.TRIANGLE_STRIP,"triangle strip"),V0),yx=(Dd={},(0,ve.Z)(Dd,Fe.STATIC_DRAW,"static"),(0,ve.Z)(Dd,Fe.DYNAMIC_DRAW,"dynamic"),(0,ve.Z)(Dd,Fe.STREAM_DRAW,"stream"),Dd),O_=(bh={},(0,ve.Z)(bh,Fe.BYTE,"int8"),(0,ve.Z)(bh,Fe.INT,"int32"),(0,ve.Z)(bh,Fe.UNSIGNED_BYTE,"uint8"),(0,ve.Z)(bh,Fe.UNSIGNED_SHORT,"uint16"),(0,ve.Z)(bh,Fe.UNSIGNED_INT,"uint32"),(0,ve.Z)(bh,Fe.FLOAT,"float"),bh),E6=(wf={},(0,ve.Z)(wf,Fe.ALPHA,"alpha"),(0,ve.Z)(wf,Fe.LUMINANCE,"luminance"),(0,ve.Z)(wf,Fe.LUMINANCE_ALPHA,"luminance alpha"),(0,ve.Z)(wf,Fe.RGB,"rgb"),(0,ve.Z)(wf,Fe.RGBA,"rgba"),(0,ve.Z)(wf,Fe.RGBA4,"rgba4"),(0,ve.Z)(wf,Fe.RGB5_A1,"rgb5 a1"),(0,ve.Z)(wf,Fe.RGB565,"rgb565"),(0,ve.Z)(wf,Fe.DEPTH_COMPONENT,"depth"),(0,ve.Z)(wf,Fe.DEPTH_STENCIL,"depth stencil"),wf),S6=(Ld={},(0,ve.Z)(Ld,Fe.DONT_CARE,"dont care"),(0,ve.Z)(Ld,Fe.NICEST,"nice"),(0,ve.Z)(Ld,Fe.FASTEST,"fast"),Ld),Ex=(Rh={},(0,ve.Z)(Rh,Fe.NEAREST,"nearest"),(0,ve.Z)(Rh,Fe.LINEAR,"linear"),(0,ve.Z)(Rh,Fe.LINEAR_MIPMAP_LINEAR,"mipmap"),(0,ve.Z)(Rh,Fe.NEAREST_MIPMAP_LINEAR,"nearest mipmap linear"),(0,ve.Z)(Rh,Fe.LINEAR_MIPMAP_NEAREST,"linear mipmap nearest"),(0,ve.Z)(Rh,Fe.NEAREST_MIPMAP_NEAREST,"nearest mipmap nearest"),Rh),Sx=(Fd={},(0,ve.Z)(Fd,Fe.REPEAT,"repeat"),(0,ve.Z)(Fd,Fe.CLAMP_TO_EDGE,"clamp"),(0,ve.Z)(Fd,Fe.MIRRORED_REPEAT,"mirror"),Fd),x6=(bg={},(0,ve.Z)(bg,Fe.NONE,"none"),(0,ve.Z)(bg,Fe.BROWSER_DEFAULT_WEBGL,"browser"),bg),T6=(h0={},(0,ve.Z)(h0,Fe.NEVER,"never"),(0,ve.Z)(h0,Fe.ALWAYS,"always"),(0,ve.Z)(h0,Fe.LESS,"less"),(0,ve.Z)(h0,Fe.LEQUAL,"lequal"),(0,ve.Z)(h0,Fe.GREATER,"greater"),(0,ve.Z)(h0,Fe.GEQUAL,"gequal"),(0,ve.Z)(h0,Fe.EQUAL,"equal"),(0,ve.Z)(h0,Fe.NOTEQUAL,"notequal"),h0),xx=(gA={},(0,ve.Z)(gA,Fe.FUNC_ADD,"add"),(0,ve.Z)(gA,Fe.MIN_EXT,"min"),(0,ve.Z)(gA,Fe.MAX_EXT,"max"),(0,ve.Z)(gA,Fe.FUNC_SUBTRACT,"subtract"),(0,ve.Z)(gA,Fe.FUNC_REVERSE_SUBTRACT,"reverse subtract"),gA),Mg=(El={},(0,ve.Z)(El,Fe.ZERO,"zero"),(0,ve.Z)(El,Fe.ONE,"one"),(0,ve.Z)(El,Fe.SRC_COLOR,"src color"),(0,ve.Z)(El,Fe.ONE_MINUS_SRC_COLOR,"one minus src color"),(0,ve.Z)(El,Fe.SRC_ALPHA,"src alpha"),(0,ve.Z)(El,Fe.ONE_MINUS_SRC_ALPHA,"one minus src alpha"),(0,ve.Z)(El,Fe.DST_COLOR,"dst color"),(0,ve.Z)(El,Fe.ONE_MINUS_DST_COLOR,"one minus dst color"),(0,ve.Z)(El,Fe.DST_ALPHA,"dst alpha"),(0,ve.Z)(El,Fe.ONE_MINUS_DST_ALPHA,"one minus dst alpha"),(0,ve.Z)(El,Fe.CONSTANT_COLOR,"constant color"),(0,ve.Z)(El,Fe.ONE_MINUS_CONSTANT_COLOR,"one minus constant color"),(0,ve.Z)(El,Fe.CONSTANT_ALPHA,"constant alpha"),(0,ve.Z)(El,Fe.ONE_MINUS_CONSTANT_ALPHA,"one minus constant alpha"),(0,ve.Z)(El,Fe.SRC_ALPHA_SATURATE,"src alpha saturate"),El),C6=(A0={},(0,ve.Z)(A0,Fe.NEVER,"never"),(0,ve.Z)(A0,Fe.ALWAYS,"always"),(0,ve.Z)(A0,Fe.LESS,"less"),(0,ve.Z)(A0,Fe.LEQUAL,"lequal"),(0,ve.Z)(A0,Fe.GREATER,"greater"),(0,ve.Z)(A0,Fe.GEQUAL,"gequal"),(0,ve.Z)(A0,Fe.EQUAL,"equal"),(0,ve.Z)(A0,Fe.NOTEQUAL,"notequal"),A0),Tp=(p0={},(0,ve.Z)(p0,Fe.ZERO,"zero"),(0,ve.Z)(p0,Fe.KEEP,"keep"),(0,ve.Z)(p0,Fe.REPLACE,"replace"),(0,ve.Z)(p0,Fe.INVERT,"invert"),(0,ve.Z)(p0,Fe.INCR,"increment"),(0,ve.Z)(p0,Fe.DECR,"decrement"),(0,ve.Z)(p0,Fe.INCR_WRAP,"increment wrap"),(0,ve.Z)(p0,Fe.DECR_WRAP,"decrement wrap"),p0),b6=(Rg={},(0,ve.Z)(Rg,Fe.FRONT,"front"),(0,ve.Z)(Rg,Fe.BACK,"back"),Rg),R6=function(){function e(t,r){(0,ue.Z)(this,e),(0,ve.Z)(this,"isDestroyed",!1);var n=r.data,i=r.usage,a=r.type;this.buffer=t.buffer({data:n,usage:yx[i||Fe.STATIC_DRAW],type:O_[a||Fe.UNSIGNED_BYTE]})}return(0,_e.Z)(e,[{key:"get",value:function(){return this.buffer}},{key:"destroy",value:function(){this.isDestroyed||this.buffer.destroy(),this.isDestroyed=!0}},{key:"subData",value:function(r){var n=r.data,i=r.offset;this.buffer.subdata(n,i)}}]),e}(),M6=function(){function e(t,r){(0,ue.Z)(this,e);var n=r.data,i=r.usage,a=r.type,s=r.count;this.elements=t.elements({data:n,usage:yx[i||Fe.STATIC_DRAW],type:O_[a||Fe.UNSIGNED_BYTE],count:s})}return(0,_e.Z)(e,[{key:"get",value:function(){return this.elements}},{key:"subData",value:function(r){var n=r.data;this.elements.subdata(n)}},{key:"destroy",value:function(){}}]),e}(),w6=function(){function e(t,r){(0,ue.Z)(this,e);var n=r.width,i=r.height,a=r.color,s=r.colors,l={width:n,height:i};Array.isArray(s)&&(l.colors=s.map(function(p){return p.get()})),a&&typeof a!="boolean"&&(l.color=a.get()),this.framebuffer=t.framebuffer(l)}return(0,_e.Z)(e,[{key:"get",value:function(){return this.framebuffer}},{key:"destroy",value:function(){this.framebuffer.destroy()}},{key:"resize",value:function(r){var n=r.width,i=r.height;this.framebuffer.resize(n,i)}}]),e}(),I6={}.toString,P6=function(e,t){return I6.call(e)==="[object "+t+"]"},O6=P6,N6=function(e){return O6(e,"Number")},Cp=N6,D6=function(e){return e==null},bp=D6,L6=function(e,t,r){return e<t?t:e>r?r:e},F6=L6,Rn=C(32290),B6=C(37271),Tx=B6,Ct;(function(e){e[e.DEPTH_BUFFER_BIT=256]="DEPTH_BUFFER_BIT",e[e.STENCIL_BUFFER_BIT=1024]="STENCIL_BUFFER_BIT",e[e.COLOR_BUFFER_BIT=16384]="COLOR_BUFFER_BIT",e[e.POINTS=0]="POINTS",e[e.LINES=1]="LINES",e[e.LINE_LOOP=2]="LINE_LOOP",e[e.LINE_STRIP=3]="LINE_STRIP",e[e.TRIANGLES=4]="TRIANGLES",e[e.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",e[e.TRIANGLE_FAN=6]="TRIANGLE_FAN",e[e.ZERO=0]="ZERO",e[e.ONE=1]="ONE",e[e.SRC_COLOR=768]="SRC_COLOR",e[e.ONE_MINUS_SRC_COLOR=769]="ONE_MINUS_SRC_COLOR",e[e.SRC_ALPHA=770]="SRC_ALPHA",e[e.ONE_MINUS_SRC_ALPHA=771]="ONE_MINUS_SRC_ALPHA",e[e.DST_ALPHA=772]="DST_ALPHA",e[e.ONE_MINUS_DST_ALPHA=773]="ONE_MINUS_DST_ALPHA",e[e.DST_COLOR=774]="DST_COLOR",e[e.ONE_MINUS_DST_COLOR=775]="ONE_MINUS_DST_COLOR",e[e.SRC_ALPHA_SATURATE=776]="SRC_ALPHA_SATURATE",e[e.CONSTANT_COLOR=32769]="CONSTANT_COLOR",e[e.ONE_MINUS_CONSTANT_COLOR=32770]="ONE_MINUS_CONSTANT_COLOR",e[e.CONSTANT_ALPHA=32771]="CONSTANT_ALPHA",e[e.ONE_MINUS_CONSTANT_ALPHA=32772]="ONE_MINUS_CONSTANT_ALPHA",e[e.FUNC_ADD=32774]="FUNC_ADD",e[e.FUNC_SUBTRACT=32778]="FUNC_SUBTRACT",e[e.FUNC_REVERSE_SUBTRACT=32779]="FUNC_REVERSE_SUBTRACT",e[e.BLEND_EQUATION=32777]="BLEND_EQUATION",e[e.BLEND_EQUATION_RGB=32777]="BLEND_EQUATION_RGB",e[e.BLEND_EQUATION_ALPHA=34877]="BLEND_EQUATION_ALPHA",e[e.BLEND_DST_RGB=32968]="BLEND_DST_RGB",e[e.BLEND_SRC_RGB=32969]="BLEND_SRC_RGB",e[e.BLEND_DST_ALPHA=32970]="BLEND_DST_ALPHA",e[e.BLEND_SRC_ALPHA=32971]="BLEND_SRC_ALPHA",e[e.BLEND_COLOR=32773]="BLEND_COLOR",e[e.ARRAY_BUFFER_BINDING=34964]="ARRAY_BUFFER_BINDING",e[e.ELEMENT_ARRAY_BUFFER_BINDING=34965]="ELEMENT_ARRAY_BUFFER_BINDING",e[e.LINE_WIDTH=2849]="LINE_WIDTH",e[e.ALIASED_POINT_SIZE_RANGE=33901]="ALIASED_POINT_SIZE_RANGE",e[e.ALIASED_LINE_WIDTH_RANGE=33902]="ALIASED_LINE_WIDTH_RANGE",e[e.CULL_FACE_MODE=2885]="CULL_FACE_MODE",e[e.FRONT_FACE=2886]="FRONT_FACE",e[e.DEPTH_RANGE=2928]="DEPTH_RANGE",e[e.DEPTH_WRITEMASK=2930]="DEPTH_WRITEMASK",e[e.DEPTH_CLEAR_VALUE=2931]="DEPTH_CLEAR_VALUE",e[e.DEPTH_FUNC=2932]="DEPTH_FUNC",e[e.STENCIL_CLEAR_VALUE=2961]="STENCIL_CLEAR_VALUE",e[e.STENCIL_FUNC=2962]="STENCIL_FUNC",e[e.STENCIL_FAIL=2964]="STENCIL_FAIL",e[e.STENCIL_PASS_DEPTH_FAIL=2965]="STENCIL_PASS_DEPTH_FAIL",e[e.STENCIL_PASS_DEPTH_PASS=2966]="STENCIL_PASS_DEPTH_PASS",e[e.STENCIL_REF=2967]="STENCIL_REF",e[e.STENCIL_VALUE_MASK=2963]="STENCIL_VALUE_MASK",e[e.STENCIL_WRITEMASK=2968]="STENCIL_WRITEMASK",e[e.STENCIL_BACK_FUNC=34816]="STENCIL_BACK_FUNC",e[e.STENCIL_BACK_FAIL=34817]="STENCIL_BACK_FAIL",e[e.STENCIL_BACK_PASS_DEPTH_FAIL=34818]="STENCIL_BACK_PASS_DEPTH_FAIL",e[e.STENCIL_BACK_PASS_DEPTH_PASS=34819]="STENCIL_BACK_PASS_DEPTH_PASS",e[e.STENCIL_BACK_REF=36003]="STENCIL_BACK_REF",e[e.STENCIL_BACK_VALUE_MASK=36004]="STENCIL_BACK_VALUE_MASK",e[e.STENCIL_BACK_WRITEMASK=36005]="STENCIL_BACK_WRITEMASK",e[e.VIEWPORT=2978]="VIEWPORT",e[e.SCISSOR_BOX=3088]="SCISSOR_BOX",e[e.COLOR_CLEAR_VALUE=3106]="COLOR_CLEAR_VALUE",e[e.COLOR_WRITEMASK=3107]="COLOR_WRITEMASK",e[e.UNPACK_ALIGNMENT=3317]="UNPACK_ALIGNMENT",e[e.PACK_ALIGNMENT=3333]="PACK_ALIGNMENT",e[e.MAX_TEXTURE_SIZE=3379]="MAX_TEXTURE_SIZE",e[e.MAX_VIEWPORT_DIMS=3386]="MAX_VIEWPORT_DIMS",e[e.SUBPIXEL_BITS=3408]="SUBPIXEL_BITS",e[e.RED_BITS=3410]="RED_BITS",e[e.GREEN_BITS=3411]="GREEN_BITS",e[e.BLUE_BITS=3412]="BLUE_BITS",e[e.ALPHA_BITS=3413]="ALPHA_BITS",e[e.DEPTH_BITS=3414]="DEPTH_BITS",e[e.STENCIL_BITS=3415]="STENCIL_BITS",e[e.POLYGON_OFFSET_UNITS=10752]="POLYGON_OFFSET_UNITS",e[e.POLYGON_OFFSET_FACTOR=32824]="POLYGON_OFFSET_FACTOR",e[e.TEXTURE_BINDING_2D=32873]="TEXTURE_BINDING_2D",e[e.SAMPLE_BUFFERS=32936]="SAMPLE_BUFFERS",e[e.SAMPLES=32937]="SAMPLES",e[e.SAMPLE_COVERAGE_VALUE=32938]="SAMPLE_COVERAGE_VALUE",e[e.SAMPLE_COVERAGE_INVERT=32939]="SAMPLE_COVERAGE_INVERT",e[e.COMPRESSED_TEXTURE_FORMATS=34467]="COMPRESSED_TEXTURE_FORMATS",e[e.VENDOR=7936]="VENDOR",e[e.RENDERER=7937]="RENDERER",e[e.VERSION=7938]="VERSION",e[e.IMPLEMENTATION_COLOR_READ_TYPE=35738]="IMPLEMENTATION_COLOR_READ_TYPE",e[e.IMPLEMENTATION_COLOR_READ_FORMAT=35739]="IMPLEMENTATION_COLOR_READ_FORMAT",e[e.BROWSER_DEFAULT_WEBGL=37444]="BROWSER_DEFAULT_WEBGL",e[e.STATIC_DRAW=35044]="STATIC_DRAW",e[e.STREAM_DRAW=35040]="STREAM_DRAW",e[e.DYNAMIC_DRAW=35048]="DYNAMIC_DRAW",e[e.ARRAY_BUFFER=34962]="ARRAY_BUFFER",e[e.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",e[e.BUFFER_SIZE=34660]="BUFFER_SIZE",e[e.BUFFER_USAGE=34661]="BUFFER_USAGE",e[e.CURRENT_VERTEX_ATTRIB=34342]="CURRENT_VERTEX_ATTRIB",e[e.VERTEX_ATTRIB_ARRAY_ENABLED=34338]="VERTEX_ATTRIB_ARRAY_ENABLED",e[e.VERTEX_ATTRIB_ARRAY_SIZE=34339]="VERTEX_ATTRIB_ARRAY_SIZE",e[e.VERTEX_ATTRIB_ARRAY_STRIDE=34340]="VERTEX_ATTRIB_ARRAY_STRIDE",e[e.VERTEX_ATTRIB_ARRAY_TYPE=34341]="VERTEX_ATTRIB_ARRAY_TYPE",e[e.VERTEX_ATTRIB_ARRAY_NORMALIZED=34922]="VERTEX_ATTRIB_ARRAY_NORMALIZED",e[e.VERTEX_ATTRIB_ARRAY_POINTER=34373]="VERTEX_ATTRIB_ARRAY_POINTER",e[e.VERTEX_ATTRIB_ARRAY_BUFFER_BINDING=34975]="VERTEX_ATTRIB_ARRAY_BUFFER_BINDING",e[e.CULL_FACE=2884]="CULL_FACE",e[e.FRONT=1028]="FRONT",e[e.BACK=1029]="BACK",e[e.FRONT_AND_BACK=1032]="FRONT_AND_BACK",e[e.BLEND=3042]="BLEND",e[e.DEPTH_TEST=2929]="DEPTH_TEST",e[e.DITHER=3024]="DITHER",e[e.POLYGON_OFFSET_FILL=32823]="POLYGON_OFFSET_FILL",e[e.SAMPLE_ALPHA_TO_COVERAGE=32926]="SAMPLE_ALPHA_TO_COVERAGE",e[e.SAMPLE_COVERAGE=32928]="SAMPLE_COVERAGE",e[e.SCISSOR_TEST=3089]="SCISSOR_TEST",e[e.STENCIL_TEST=2960]="STENCIL_TEST",e[e.NO_ERROR=0]="NO_ERROR",e[e.INVALID_ENUM=1280]="INVALID_ENUM",e[e.INVALID_VALUE=1281]="INVALID_VALUE",e[e.INVALID_OPERATION=1282]="INVALID_OPERATION",e[e.OUT_OF_MEMORY=1285]="OUT_OF_MEMORY",e[e.CONTEXT_LOST_WEBGL=37442]="CONTEXT_LOST_WEBGL",e[e.CW=2304]="CW",e[e.CCW=2305]="CCW",e[e.DONT_CARE=4352]="DONT_CARE",e[e.FASTEST=4353]="FASTEST",e[e.NICEST=4354]="NICEST",e[e.GENERATE_MIPMAP_HINT=33170]="GENERATE_MIPMAP_HINT",e[e.BYTE=5120]="BYTE",e[e.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",e[e.SHORT=5122]="SHORT",e[e.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",e[e.INT=5124]="INT",e[e.UNSIGNED_INT=5125]="UNSIGNED_INT",e[e.FLOAT=5126]="FLOAT",e[e.DOUBLE=5130]="DOUBLE",e[e.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",e[e.ALPHA=6406]="ALPHA",e[e.RGB=6407]="RGB",e[e.RGBA=6408]="RGBA",e[e.LUMINANCE=6409]="LUMINANCE",e[e.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",e[e.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",e[e.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",e[e.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",e[e.FRAGMENT_SHADER=35632]="FRAGMENT_SHADER",e[e.VERTEX_SHADER=35633]="VERTEX_SHADER",e[e.COMPILE_STATUS=35713]="COMPILE_STATUS",e[e.DELETE_STATUS=35712]="DELETE_STATUS",e[e.LINK_STATUS=35714]="LINK_STATUS",e[e.VALIDATE_STATUS=35715]="VALIDATE_STATUS",e[e.ATTACHED_SHADERS=35717]="ATTACHED_SHADERS",e[e.ACTIVE_ATTRIBUTES=35721]="ACTIVE_ATTRIBUTES",e[e.ACTIVE_UNIFORMS=35718]="ACTIVE_UNIFORMS",e[e.MAX_VERTEX_ATTRIBS=34921]="MAX_VERTEX_ATTRIBS",e[e.MAX_VERTEX_UNIFORM_VECTORS=36347]="MAX_VERTEX_UNIFORM_VECTORS",e[e.MAX_VARYING_VECTORS=36348]="MAX_VARYING_VECTORS",e[e.MAX_COMBINED_TEXTURE_IMAGE_UNITS=35661]="MAX_COMBINED_TEXTURE_IMAGE_UNITS",e[e.MAX_VERTEX_TEXTURE_IMAGE_UNITS=35660]="MAX_VERTEX_TEXTURE_IMAGE_UNITS",e[e.MAX_TEXTURE_IMAGE_UNITS=34930]="MAX_TEXTURE_IMAGE_UNITS",e[e.MAX_FRAGMENT_UNIFORM_VECTORS=36349]="MAX_FRAGMENT_UNIFORM_VECTORS",e[e.SHADER_TYPE=35663]="SHADER_TYPE",e[e.SHADING_LANGUAGE_VERSION=35724]="SHADING_LANGUAGE_VERSION",e[e.CURRENT_PROGRAM=35725]="CURRENT_PROGRAM",e[e.NEVER=512]="NEVER",e[e.ALWAYS=519]="ALWAYS",e[e.LESS=513]="LESS",e[e.EQUAL=514]="EQUAL",e[e.LEQUAL=515]="LEQUAL",e[e.GREATER=516]="GREATER",e[e.GEQUAL=518]="GEQUAL",e[e.NOTEQUAL=517]="NOTEQUAL",e[e.KEEP=7680]="KEEP",e[e.REPLACE=7681]="REPLACE",e[e.INCR=7682]="INCR",e[e.DECR=7683]="DECR",e[e.INVERT=5386]="INVERT",e[e.INCR_WRAP=34055]="INCR_WRAP",e[e.DECR_WRAP=34056]="DECR_WRAP",e[e.NEAREST=9728]="NEAREST",e[e.LINEAR=9729]="LINEAR",e[e.NEAREST_MIPMAP_NEAREST=9984]="NEAREST_MIPMAP_NEAREST",e[e.LINEAR_MIPMAP_NEAREST=9985]="LINEAR_MIPMAP_NEAREST",e[e.NEAREST_MIPMAP_LINEAR=9986]="NEAREST_MIPMAP_LINEAR",e[e.LINEAR_MIPMAP_LINEAR=9987]="LINEAR_MIPMAP_LINEAR",e[e.TEXTURE_MAG_FILTER=10240]="TEXTURE_MAG_FILTER",e[e.TEXTURE_MIN_FILTER=10241]="TEXTURE_MIN_FILTER",e[e.TEXTURE_WRAP_S=10242]="TEXTURE_WRAP_S",e[e.TEXTURE_WRAP_T=10243]="TEXTURE_WRAP_T",e[e.TEXTURE_2D=3553]="TEXTURE_2D",e[e.TEXTURE=5890]="TEXTURE",e[e.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",e[e.TEXTURE_BINDING_CUBE_MAP=34068]="TEXTURE_BINDING_CUBE_MAP",e[e.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",e[e.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",e[e.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",e[e.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",e[e.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",e[e.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z",e[e.MAX_CUBE_MAP_TEXTURE_SIZE=34076]="MAX_CUBE_MAP_TEXTURE_SIZE",e[e.TEXTURE0=33984]="TEXTURE0",e[e.ACTIVE_TEXTURE=34016]="ACTIVE_TEXTURE",e[e.REPEAT=10497]="REPEAT",e[e.CLAMP_TO_EDGE=33071]="CLAMP_TO_EDGE",e[e.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT",e[e.TEXTURE_WIDTH=4096]="TEXTURE_WIDTH",e[e.TEXTURE_HEIGHT=4097]="TEXTURE_HEIGHT",e[e.FLOAT_VEC2=35664]="FLOAT_VEC2",e[e.FLOAT_VEC3=35665]="FLOAT_VEC3",e[e.FLOAT_VEC4=35666]="FLOAT_VEC4",e[e.INT_VEC2=35667]="INT_VEC2",e[e.INT_VEC3=35668]="INT_VEC3",e[e.INT_VEC4=35669]="INT_VEC4",e[e.BOOL=35670]="BOOL",e[e.BOOL_VEC2=35671]="BOOL_VEC2",e[e.BOOL_VEC3=35672]="BOOL_VEC3",e[e.BOOL_VEC4=35673]="BOOL_VEC4",e[e.FLOAT_MAT2=35674]="FLOAT_MAT2",e[e.FLOAT_MAT3=35675]="FLOAT_MAT3",e[e.FLOAT_MAT4=35676]="FLOAT_MAT4",e[e.SAMPLER_2D=35678]="SAMPLER_2D",e[e.SAMPLER_CUBE=35680]="SAMPLER_CUBE",e[e.LOW_FLOAT=36336]="LOW_FLOAT",e[e.MEDIUM_FLOAT=36337]="MEDIUM_FLOAT",e[e.HIGH_FLOAT=36338]="HIGH_FLOAT",e[e.LOW_INT=36339]="LOW_INT",e[e.MEDIUM_INT=36340]="MEDIUM_INT",e[e.HIGH_INT=36341]="HIGH_INT",e[e.FRAMEBUFFER=36160]="FRAMEBUFFER",e[e.RENDERBUFFER=36161]="RENDERBUFFER",e[e.RGBA4=32854]="RGBA4",e[e.RGB5_A1=32855]="RGB5_A1",e[e.RGB565=36194]="RGB565",e[e.DEPTH_COMPONENT16=33189]="DEPTH_COMPONENT16",e[e.STENCIL_INDEX=6401]="STENCIL_INDEX",e[e.STENCIL_INDEX8=36168]="STENCIL_INDEX8",e[e.DEPTH_STENCIL=34041]="DEPTH_STENCIL",e[e.RENDERBUFFER_WIDTH=36162]="RENDERBUFFER_WIDTH",e[e.RENDERBUFFER_HEIGHT=36163]="RENDERBUFFER_HEIGHT",e[e.RENDERBUFFER_INTERNAL_FORMAT=36164]="RENDERBUFFER_INTERNAL_FORMAT",e[e.RENDERBUFFER_RED_SIZE=36176]="RENDERBUFFER_RED_SIZE",e[e.RENDERBUFFER_GREEN_SIZE=36177]="RENDERBUFFER_GREEN_SIZE",e[e.RENDERBUFFER_BLUE_SIZE=36178]="RENDERBUFFER_BLUE_SIZE",e[e.RENDERBUFFER_ALPHA_SIZE=36179]="RENDERBUFFER_ALPHA_SIZE",e[e.RENDERBUFFER_DEPTH_SIZE=36180]="RENDERBUFFER_DEPTH_SIZE",e[e.RENDERBUFFER_STENCIL_SIZE=36181]="RENDERBUFFER_STENCIL_SIZE",e[e.FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE=36048]="FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE",e[e.FRAMEBUFFER_ATTACHMENT_OBJECT_NAME=36049]="FRAMEBUFFER_ATTACHMENT_OBJECT_NAME",e[e.FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL=36050]="FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL",e[e.FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE=36051]="FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE",e[e.COLOR_ATTACHMENT0=36064]="COLOR_ATTACHMENT0",e[e.DEPTH_ATTACHMENT=36096]="DEPTH_ATTACHMENT",e[e.STENCIL_ATTACHMENT=36128]="STENCIL_ATTACHMENT",e[e.DEPTH_STENCIL_ATTACHMENT=33306]="DEPTH_STENCIL_ATTACHMENT",e[e.NONE=0]="NONE",e[e.FRAMEBUFFER_COMPLETE=36053]="FRAMEBUFFER_COMPLETE",e[e.FRAMEBUFFER_INCOMPLETE_ATTACHMENT=36054]="FRAMEBUFFER_INCOMPLETE_ATTACHMENT",e[e.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT=36055]="FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT",e[e.FRAMEBUFFER_INCOMPLETE_DIMENSIONS=36057]="FRAMEBUFFER_INCOMPLETE_DIMENSIONS",e[e.FRAMEBUFFER_UNSUPPORTED=36061]="FRAMEBUFFER_UNSUPPORTED",e[e.FRAMEBUFFER_BINDING=36006]="FRAMEBUFFER_BINDING",e[e.RENDERBUFFER_BINDING=36007]="RENDERBUFFER_BINDING",e[e.READ_FRAMEBUFFER=36008]="READ_FRAMEBUFFER",e[e.DRAW_FRAMEBUFFER=36009]="DRAW_FRAMEBUFFER",e[e.MAX_RENDERBUFFER_SIZE=34024]="MAX_RENDERBUFFER_SIZE",e[e.INVALID_FRAMEBUFFER_OPERATION=1286]="INVALID_FRAMEBUFFER_OPERATION",e[e.UNPACK_FLIP_Y_WEBGL=37440]="UNPACK_FLIP_Y_WEBGL",e[e.UNPACK_PREMULTIPLY_ALPHA_WEBGL=37441]="UNPACK_PREMULTIPLY_ALPHA_WEBGL",e[e.UNPACK_COLORSPACE_CONVERSION_WEBGL=37443]="UNPACK_COLORSPACE_CONVERSION_WEBGL",e[e.READ_BUFFER=3074]="READ_BUFFER",e[e.UNPACK_ROW_LENGTH=3314]="UNPACK_ROW_LENGTH",e[e.UNPACK_SKIP_ROWS=3315]="UNPACK_SKIP_ROWS",e[e.UNPACK_SKIP_PIXELS=3316]="UNPACK_SKIP_PIXELS",e[e.PACK_ROW_LENGTH=3330]="PACK_ROW_LENGTH",e[e.PACK_SKIP_ROWS=3331]="PACK_SKIP_ROWS",e[e.PACK_SKIP_PIXELS=3332]="PACK_SKIP_PIXELS",e[e.TEXTURE_BINDING_3D=32874]="TEXTURE_BINDING_3D",e[e.UNPACK_SKIP_IMAGES=32877]="UNPACK_SKIP_IMAGES",e[e.UNPACK_IMAGE_HEIGHT=32878]="UNPACK_IMAGE_HEIGHT",e[e.MAX_3D_TEXTURE_SIZE=32883]="MAX_3D_TEXTURE_SIZE",e[e.MAX_ELEMENTS_VERTICES=33e3]="MAX_ELEMENTS_VERTICES",e[e.MAX_ELEMENTS_INDICES=33001]="MAX_ELEMENTS_INDICES",e[e.MAX_TEXTURE_LOD_BIAS=34045]="MAX_TEXTURE_LOD_BIAS",e[e.MAX_FRAGMENT_UNIFORM_COMPONENTS=35657]="MAX_FRAGMENT_UNIFORM_COMPONENTS",e[e.MAX_VERTEX_UNIFORM_COMPONENTS=35658]="MAX_VERTEX_UNIFORM_COMPONENTS",e[e.MAX_ARRAY_TEXTURE_LAYERS=35071]="MAX_ARRAY_TEXTURE_LAYERS",e[e.MIN_PROGRAM_TEXEL_OFFSET=35076]="MIN_PROGRAM_TEXEL_OFFSET",e[e.MAX_PROGRAM_TEXEL_OFFSET=35077]="MAX_PROGRAM_TEXEL_OFFSET",e[e.MAX_VARYING_COMPONENTS=35659]="MAX_VARYING_COMPONENTS",e[e.FRAGMENT_SHADER_DERIVATIVE_HINT=35723]="FRAGMENT_SHADER_DERIVATIVE_HINT",e[e.RASTERIZER_DISCARD=35977]="RASTERIZER_DISCARD",e[e.VERTEX_ARRAY_BINDING=34229]="VERTEX_ARRAY_BINDING",e[e.MAX_VERTEX_OUTPUT_COMPONENTS=37154]="MAX_VERTEX_OUTPUT_COMPONENTS",e[e.MAX_FRAGMENT_INPUT_COMPONENTS=37157]="MAX_FRAGMENT_INPUT_COMPONENTS",e[e.MAX_SERVER_WAIT_TIMEOUT=37137]="MAX_SERVER_WAIT_TIMEOUT",e[e.MAX_ELEMENT_INDEX=36203]="MAX_ELEMENT_INDEX",e[e.RED=6403]="RED",e[e.RGB8=32849]="RGB8",e[e.RGBA8=32856]="RGBA8",e[e.RGB10_A2=32857]="RGB10_A2",e[e.TEXTURE_3D=32879]="TEXTURE_3D",e[e.TEXTURE_WRAP_R=32882]="TEXTURE_WRAP_R",e[e.TEXTURE_MIN_LOD=33082]="TEXTURE_MIN_LOD",e[e.TEXTURE_MAX_LOD=33083]="TEXTURE_MAX_LOD",e[e.TEXTURE_BASE_LEVEL=33084]="TEXTURE_BASE_LEVEL",e[e.TEXTURE_MAX_LEVEL=33085]="TEXTURE_MAX_LEVEL",e[e.TEXTURE_COMPARE_MODE=34892]="TEXTURE_COMPARE_MODE",e[e.TEXTURE_COMPARE_FUNC=34893]="TEXTURE_COMPARE_FUNC",e[e.SRGB=35904]="SRGB",e[e.SRGB8=35905]="SRGB8",e[e.SRGB8_ALPHA8=35907]="SRGB8_ALPHA8",e[e.COMPARE_REF_TO_TEXTURE=34894]="COMPARE_REF_TO_TEXTURE",e[e.RGBA32F=34836]="RGBA32F",e[e.RGB32F=34837]="RGB32F",e[e.RGBA16F=34842]="RGBA16F",e[e.RGB16F=34843]="RGB16F",e[e.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY",e[e.TEXTURE_BINDING_2D_ARRAY=35869]="TEXTURE_BINDING_2D_ARRAY",e[e.R11F_G11F_B10F=35898]="R11F_G11F_B10F",e[e.RGB9_E5=35901]="RGB9_E5",e[e.RGBA32UI=36208]="RGBA32UI",e[e.RGB32UI=36209]="RGB32UI",e[e.RGBA16UI=36214]="RGBA16UI",e[e.RGB16UI=36215]="RGB16UI",e[e.RGBA8UI=36220]="RGBA8UI",e[e.RGB8UI=36221]="RGB8UI",e[e.RGBA32I=36226]="RGBA32I",e[e.RGB32I=36227]="RGB32I",e[e.RGBA16I=36232]="RGBA16I",e[e.RGB16I=36233]="RGB16I",e[e.RGBA8I=36238]="RGBA8I",e[e.RGB8I=36239]="RGB8I",e[e.RED_INTEGER=36244]="RED_INTEGER",e[e.RGB_INTEGER=36248]="RGB_INTEGER",e[e.RGBA_INTEGER=36249]="RGBA_INTEGER",e[e.R8=33321]="R8",e[e.RG8=33323]="RG8",e[e.R16F=33325]="R16F",e[e.R32F=33326]="R32F",e[e.RG16F=33327]="RG16F",e[e.RG32F=33328]="RG32F",e[e.R8I=33329]="R8I",e[e.R8UI=33330]="R8UI",e[e.R16I=33331]="R16I",e[e.R16UI=33332]="R16UI",e[e.R32I=33333]="R32I",e[e.R32UI=33334]="R32UI",e[e.RG8I=33335]="RG8I",e[e.RG8UI=33336]="RG8UI",e[e.RG16I=33337]="RG16I",e[e.RG16UI=33338]="RG16UI",e[e.RG32I=33339]="RG32I",e[e.RG32UI=33340]="RG32UI",e[e.R8_SNORM=36756]="R8_SNORM",e[e.RG8_SNORM=36757]="RG8_SNORM",e[e.RGB8_SNORM=36758]="RGB8_SNORM",e[e.RGBA8_SNORM=36759]="RGBA8_SNORM",e[e.RGB10_A2UI=36975]="RGB10_A2UI",e[e.TEXTURE_IMMUTABLE_FORMAT=37167]="TEXTURE_IMMUTABLE_FORMAT",e[e.TEXTURE_IMMUTABLE_LEVELS=33503]="TEXTURE_IMMUTABLE_LEVELS",e[e.UNSIGNED_INT_2_10_10_10_REV=33640]="UNSIGNED_INT_2_10_10_10_REV",e[e.UNSIGNED_INT_10F_11F_11F_REV=35899]="UNSIGNED_INT_10F_11F_11F_REV",e[e.UNSIGNED_INT_5_9_9_9_REV=35902]="UNSIGNED_INT_5_9_9_9_REV",e[e.FLOAT_32_UNSIGNED_INT_24_8_REV=36269]="FLOAT_32_UNSIGNED_INT_24_8_REV",e[e.UNSIGNED_INT_24_8=34042]="UNSIGNED_INT_24_8",e[e.HALF_FLOAT=5131]="HALF_FLOAT",e[e.RG=33319]="RG",e[e.RG_INTEGER=33320]="RG_INTEGER",e[e.INT_2_10_10_10_REV=36255]="INT_2_10_10_10_REV",e[e.CURRENT_QUERY=34917]="CURRENT_QUERY",e[e.QUERY_RESULT=34918]="QUERY_RESULT",e[e.QUERY_RESULT_AVAILABLE=34919]="QUERY_RESULT_AVAILABLE",e[e.ANY_SAMPLES_PASSED=35887]="ANY_SAMPLES_PASSED",e[e.ANY_SAMPLES_PASSED_CONSERVATIVE=36202]="ANY_SAMPLES_PASSED_CONSERVATIVE",e[e.MAX_DRAW_BUFFERS=34852]="MAX_DRAW_BUFFERS",e[e.DRAW_BUFFER0=34853]="DRAW_BUFFER0",e[e.DRAW_BUFFER1=34854]="DRAW_BUFFER1",e[e.DRAW_BUFFER2=34855]="DRAW_BUFFER2",e[e.DRAW_BUFFER3=34856]="DRAW_BUFFER3",e[e.DRAW_BUFFER4=34857]="DRAW_BUFFER4",e[e.DRAW_BUFFER5=34858]="DRAW_BUFFER5",e[e.DRAW_BUFFER6=34859]="DRAW_BUFFER6",e[e.DRAW_BUFFER7=34860]="DRAW_BUFFER7",e[e.DRAW_BUFFER8=34861]="DRAW_BUFFER8",e[e.DRAW_BUFFER9=34862]="DRAW_BUFFER9",e[e.DRAW_BUFFER10=34863]="DRAW_BUFFER10",e[e.DRAW_BUFFER11=34864]="DRAW_BUFFER11",e[e.DRAW_BUFFER12=34865]="DRAW_BUFFER12",e[e.DRAW_BUFFER13=34866]="DRAW_BUFFER13",e[e.DRAW_BUFFER14=34867]="DRAW_BUFFER14",e[e.DRAW_BUFFER15=34868]="DRAW_BUFFER15",e[e.MAX_COLOR_ATTACHMENTS=36063]="MAX_COLOR_ATTACHMENTS",e[e.COLOR_ATTACHMENT1=36065]="COLOR_ATTACHMENT1",e[e.COLOR_ATTACHMENT2=36066]="COLOR_ATTACHMENT2",e[e.COLOR_ATTACHMENT3=36067]="COLOR_ATTACHMENT3",e[e.COLOR_ATTACHMENT4=36068]="COLOR_ATTACHMENT4",e[e.COLOR_ATTACHMENT5=36069]="COLOR_ATTACHMENT5",e[e.COLOR_ATTACHMENT6=36070]="COLOR_ATTACHMENT6",e[e.COLOR_ATTACHMENT7=36071]="COLOR_ATTACHMENT7",e[e.COLOR_ATTACHMENT8=36072]="COLOR_ATTACHMENT8",e[e.COLOR_ATTACHMENT9=36073]="COLOR_ATTACHMENT9",e[e.COLOR_ATTACHMENT10=36074]="COLOR_ATTACHMENT10",e[e.COLOR_ATTACHMENT11=36075]="COLOR_ATTACHMENT11",e[e.COLOR_ATTACHMENT12=36076]="COLOR_ATTACHMENT12",e[e.COLOR_ATTACHMENT13=36077]="COLOR_ATTACHMENT13",e[e.COLOR_ATTACHMENT14=36078]="COLOR_ATTACHMENT14",e[e.COLOR_ATTACHMENT15=36079]="COLOR_ATTACHMENT15",e[e.SAMPLER_3D=35679]="SAMPLER_3D",e[e.SAMPLER_2D_SHADOW=35682]="SAMPLER_2D_SHADOW",e[e.SAMPLER_2D_ARRAY=36289]="SAMPLER_2D_ARRAY",e[e.SAMPLER_2D_ARRAY_SHADOW=36292]="SAMPLER_2D_ARRAY_SHADOW",e[e.SAMPLER_CUBE_SHADOW=36293]="SAMPLER_CUBE_SHADOW",e[e.INT_SAMPLER_2D=36298]="INT_SAMPLER_2D",e[e.INT_SAMPLER_3D=36299]="INT_SAMPLER_3D",e[e.INT_SAMPLER_CUBE=36300]="INT_SAMPLER_CUBE",e[e.INT_SAMPLER_2D_ARRAY=36303]="INT_SAMPLER_2D_ARRAY",e[e.UNSIGNED_INT_SAMPLER_2D=36306]="UNSIGNED_INT_SAMPLER_2D",e[e.UNSIGNED_INT_SAMPLER_3D=36307]="UNSIGNED_INT_SAMPLER_3D",e[e.UNSIGNED_INT_SAMPLER_CUBE=36308]="UNSIGNED_INT_SAMPLER_CUBE",e[e.UNSIGNED_INT_SAMPLER_2D_ARRAY=36311]="UNSIGNED_INT_SAMPLER_2D_ARRAY",e[e.MAX_SAMPLES=36183]="MAX_SAMPLES",e[e.SAMPLER_BINDING=35097]="SAMPLER_BINDING",e[e.PIXEL_PACK_BUFFER=35051]="PIXEL_PACK_BUFFER",e[e.PIXEL_UNPACK_BUFFER=35052]="PIXEL_UNPACK_BUFFER",e[e.PIXEL_PACK_BUFFER_BINDING=35053]="PIXEL_PACK_BUFFER_BINDING",e[e.PIXEL_UNPACK_BUFFER_BINDING=35055]="PIXEL_UNPACK_BUFFER_BINDING",e[e.COPY_READ_BUFFER=36662]="COPY_READ_BUFFER",e[e.COPY_WRITE_BUFFER=36663]="COPY_WRITE_BUFFER",e[e.COPY_READ_BUFFER_BINDING=36662]="COPY_READ_BUFFER_BINDING",e[e.COPY_WRITE_BUFFER_BINDING=36663]="COPY_WRITE_BUFFER_BINDING",e[e.FLOAT_MAT2x3=35685]="FLOAT_MAT2x3",e[e.FLOAT_MAT2x4=35686]="FLOAT_MAT2x4",e[e.FLOAT_MAT3x2=35687]="FLOAT_MAT3x2",e[e.FLOAT_MAT3x4=35688]="FLOAT_MAT3x4",e[e.FLOAT_MAT4x2=35689]="FLOAT_MAT4x2",e[e.FLOAT_MAT4x3=35690]="FLOAT_MAT4x3",e[e.UNSIGNED_INT_VEC2=36294]="UNSIGNED_INT_VEC2",e[e.UNSIGNED_INT_VEC3=36295]="UNSIGNED_INT_VEC3",e[e.UNSIGNED_INT_VEC4=36296]="UNSIGNED_INT_VEC4",e[e.UNSIGNED_NORMALIZED=35863]="UNSIGNED_NORMALIZED",e[e.SIGNED_NORMALIZED=36764]="SIGNED_NORMALIZED",e[e.VERTEX_ATTRIB_ARRAY_INTEGER=35069]="VERTEX_ATTRIB_ARRAY_INTEGER",e[e.VERTEX_ATTRIB_ARRAY_DIVISOR=35070]="VERTEX_ATTRIB_ARRAY_DIVISOR",e[e.TRANSFORM_FEEDBACK_BUFFER_MODE=35967]="TRANSFORM_FEEDBACK_BUFFER_MODE",e[e.MAX_TRANSFORM_FEEDBACK_SEPARATE_COMPONENTS=35968]="MAX_TRANSFORM_FEEDBACK_SEPARATE_COMPONENTS",e[e.TRANSFORM_FEEDBACK_VARYINGS=35971]="TRANSFORM_FEEDBACK_VARYINGS",e[e.TRANSFORM_FEEDBACK_BUFFER_START=35972]="TRANSFORM_FEEDBACK_BUFFER_START",e[e.TRANSFORM_FEEDBACK_BUFFER_SIZE=35973]="TRANSFORM_FEEDBACK_BUFFER_SIZE",e[e.TRANSFORM_FEEDBACK_PRIMITIVES_WRITTEN=35976]="TRANSFORM_FEEDBACK_PRIMITIVES_WRITTEN",e[e.MAX_TRANSFORM_FEEDBACK_INTERLEAVED_COMPONENTS=35978]="MAX_TRANSFORM_FEEDBACK_INTERLEAVED_COMPONENTS",e[e.MAX_TRANSFORM_FEEDBACK_SEPARATE_ATTRIBS=35979]="MAX_TRANSFORM_FEEDBACK_SEPARATE_ATTRIBS",e[e.INTERLEAVED_ATTRIBS=35980]="INTERLEAVED_ATTRIBS",e[e.SEPARATE_ATTRIBS=35981]="SEPARATE_ATTRIBS",e[e.TRANSFORM_FEEDBACK_BUFFER=35982]="TRANSFORM_FEEDBACK_BUFFER",e[e.TRANSFORM_FEEDBACK_BUFFER_BINDING=35983]="TRANSFORM_FEEDBACK_BUFFER_BINDING",e[e.TRANSFORM_FEEDBACK=36386]="TRANSFORM_FEEDBACK",e[e.TRANSFORM_FEEDBACK_PAUSED=36387]="TRANSFORM_FEEDBACK_PAUSED",e[e.TRANSFORM_FEEDBACK_ACTIVE=36388]="TRANSFORM_FEEDBACK_ACTIVE",e[e.TRANSFORM_FEEDBACK_BINDING=36389]="TRANSFORM_FEEDBACK_BINDING",e[e.FRAMEBUFFER_ATTACHMENT_COLOR_ENCODING=33296]="FRAMEBUFFER_ATTACHMENT_COLOR_ENCODING",e[e.FRAMEBUFFER_ATTACHMENT_COMPONENT_TYPE=33297]="FRAMEBUFFER_ATTACHMENT_COMPONENT_TYPE",e[e.FRAMEBUFFER_ATTACHMENT_RED_SIZE=33298]="FRAMEBUFFER_ATTACHMENT_RED_SIZE",e[e.FRAMEBUFFER_ATTACHMENT_GREEN_SIZE=33299]="FRAMEBUFFER_ATTACHMENT_GREEN_SIZE",e[e.FRAMEBUFFER_ATTACHMENT_BLUE_SIZE=33300]="FRAMEBUFFER_ATTACHMENT_BLUE_SIZE",e[e.FRAMEBUFFER_ATTACHMENT_ALPHA_SIZE=33301]="FRAMEBUFFER_ATTACHMENT_ALPHA_SIZE",e[e.FRAMEBUFFER_ATTACHMENT_DEPTH_SIZE=33302]="FRAMEBUFFER_ATTACHMENT_DEPTH_SIZE",e[e.FRAMEBUFFER_ATTACHMENT_STENCIL_SIZE=33303]="FRAMEBUFFER_ATTACHMENT_STENCIL_SIZE",e[e.FRAMEBUFFER_DEFAULT=33304]="FRAMEBUFFER_DEFAULT",e[e.DEPTH24_STENCIL8=35056]="DEPTH24_STENCIL8",e[e.DRAW_FRAMEBUFFER_BINDING=36006]="DRAW_FRAMEBUFFER_BINDING",e[e.READ_FRAMEBUFFER_BINDING=36010]="READ_FRAMEBUFFER_BINDING",e[e.RENDERBUFFER_SAMPLES=36011]="RENDERBUFFER_SAMPLES",e[e.FRAMEBUFFER_ATTACHMENT_TEXTURE_LAYER=36052]="FRAMEBUFFER_ATTACHMENT_TEXTURE_LAYER",e[e.FRAMEBUFFER_INCOMPLETE_MULTISAMPLE=36182]="FRAMEBUFFER_INCOMPLETE_MULTISAMPLE",e[e.UNIFORM_BUFFER=35345]="UNIFORM_BUFFER",e[e.UNIFORM_BUFFER_BINDING=35368]="UNIFORM_BUFFER_BINDING",e[e.UNIFORM_BUFFER_START=35369]="UNIFORM_BUFFER_START",e[e.UNIFORM_BUFFER_SIZE=35370]="UNIFORM_BUFFER_SIZE",e[e.MAX_VERTEX_UNIFORM_BLOCKS=35371]="MAX_VERTEX_UNIFORM_BLOCKS",e[e.MAX_FRAGMENT_UNIFORM_BLOCKS=35373]="MAX_FRAGMENT_UNIFORM_BLOCKS",e[e.MAX_COMBINED_UNIFORM_BLOCKS=35374]="MAX_COMBINED_UNIFORM_BLOCKS",e[e.MAX_UNIFORM_BUFFER_BINDINGS=35375]="MAX_UNIFORM_BUFFER_BINDINGS",e[e.MAX_UNIFORM_BLOCK_SIZE=35376]="MAX_UNIFORM_BLOCK_SIZE",e[e.MAX_COMBINED_VERTEX_UNIFORM_COMPONENTS=35377]="MAX_COMBINED_VERTEX_UNIFORM_COMPONENTS",e[e.MAX_COMBINED_FRAGMENT_UNIFORM_COMPONENTS=35379]="MAX_COMBINED_FRAGMENT_UNIFORM_COMPONENTS",e[e.UNIFORM_BUFFER_OFFSET_ALIGNMENT=35380]="UNIFORM_BUFFER_OFFSET_ALIGNMENT",e[e.ACTIVE_UNIFORM_BLOCKS=35382]="ACTIVE_UNIFORM_BLOCKS",e[e.UNIFORM_TYPE=35383]="UNIFORM_TYPE",e[e.UNIFORM_SIZE=35384]="UNIFORM_SIZE",e[e.UNIFORM_BLOCK_INDEX=35386]="UNIFORM_BLOCK_INDEX",e[e.UNIFORM_OFFSET=35387]="UNIFORM_OFFSET",e[e.UNIFORM_ARRAY_STRIDE=35388]="UNIFORM_ARRAY_STRIDE",e[e.UNIFORM_MATRIX_STRIDE=35389]="UNIFORM_MATRIX_STRIDE",e[e.UNIFORM_IS_ROW_MAJOR=35390]="UNIFORM_IS_ROW_MAJOR",e[e.UNIFORM_BLOCK_BINDING=35391]="UNIFORM_BLOCK_BINDING",e[e.UNIFORM_BLOCK_DATA_SIZE=35392]="UNIFORM_BLOCK_DATA_SIZE",e[e.UNIFORM_BLOCK_ACTIVE_UNIFORMS=35394]="UNIFORM_BLOCK_ACTIVE_UNIFORMS",e[e.UNIFORM_BLOCK_ACTIVE_UNIFORM_INDICES=35395]="UNIFORM_BLOCK_ACTIVE_UNIFORM_INDICES",e[e.UNIFORM_BLOCK_REFERENCED_BY_VERTEX_SHADER=35396]="UNIFORM_BLOCK_REFERENCED_BY_VERTEX_SHADER",e[e.UNIFORM_BLOCK_REFERENCED_BY_FRAGMENT_SHADER=35398]="UNIFORM_BLOCK_REFERENCED_BY_FRAGMENT_SHADER",e[e.OBJECT_TYPE=37138]="OBJECT_TYPE",e[e.SYNC_CONDITION=37139]="SYNC_CONDITION",e[e.SYNC_STATUS=37140]="SYNC_STATUS",e[e.SYNC_FLAGS=37141]="SYNC_FLAGS",e[e.SYNC_FENCE=37142]="SYNC_FENCE",e[e.SYNC_GPU_COMMANDS_COMPLETE=37143]="SYNC_GPU_COMMANDS_COMPLETE",e[e.UNSIGNALED=37144]="UNSIGNALED",e[e.SIGNALED=37145]="SIGNALED",e[e.ALREADY_SIGNALED=37146]="ALREADY_SIGNALED",e[e.TIMEOUT_EXPIRED=37147]="TIMEOUT_EXPIRED",e[e.CONDITION_SATISFIED=37148]="CONDITION_SATISFIED",e[e.WAIT_FAILED=37149]="WAIT_FAILED",e[e.SYNC_FLUSH_COMMANDS_BIT=1]="SYNC_FLUSH_COMMANDS_BIT",e[e.COLOR=6144]="COLOR",e[e.DEPTH=6145]="DEPTH",e[e.STENCIL=6146]="STENCIL",e[e.MIN=32775]="MIN",e[e.MAX=32776]="MAX",e[e.DEPTH_COMPONENT24=33190]="DEPTH_COMPONENT24",e[e.STREAM_READ=35041]="STREAM_READ",e[e.STREAM_COPY=35042]="STREAM_COPY",e[e.STATIC_READ=35045]="STATIC_READ",e[e.STATIC_COPY=35046]="STATIC_COPY",e[e.DYNAMIC_READ=35049]="DYNAMIC_READ",e[e.DYNAMIC_COPY=35050]="DYNAMIC_COPY",e[e.DEPTH_COMPONENT32F=36012]="DEPTH_COMPONENT32F",e[e.DEPTH32F_STENCIL8=36013]="DEPTH32F_STENCIL8",e[e.INVALID_INDEX=4294967295]="INVALID_INDEX",e[e.TIMEOUT_IGNORED=-1]="TIMEOUT_IGNORED",e[e.MAX_CLIENT_WAIT_TIMEOUT_WEBGL=37447]="MAX_CLIENT_WAIT_TIMEOUT_WEBGL",e[e.VERTEX_ATTRIB_ARRAY_DIVISOR_ANGLE=35070]="VERTEX_ATTRIB_ARRAY_DIVISOR_ANGLE",e[e.UNMASKED_VENDOR_WEBGL=37445]="UNMASKED_VENDOR_WEBGL",e[e.UNMASKED_RENDERER_WEBGL=37446]="UNMASKED_RENDERER_WEBGL",e[e.MAX_TEXTURE_MAX_ANISOTROPY_EXT=34047]="MAX_TEXTURE_MAX_ANISOTROPY_EXT",e[e.TEXTURE_MAX_ANISOTROPY_EXT=34046]="TEXTURE_MAX_ANISOTROPY_EXT",e[e.COMPRESSED_RGB_S3TC_DXT1_EXT=33776]="COMPRESSED_RGB_S3TC_DXT1_EXT",e[e.COMPRESSED_RGBA_S3TC_DXT1_EXT=33777]="COMPRESSED_RGBA_S3TC_DXT1_EXT",e[e.COMPRESSED_RGBA_S3TC_DXT3_EXT=33778]="COMPRESSED_RGBA_S3TC_DXT3_EXT",e[e.COMPRESSED_RGBA_S3TC_DXT5_EXT=33779]="COMPRESSED_RGBA_S3TC_DXT5_EXT",e[e.COMPRESSED_R11_EAC=37488]="COMPRESSED_R11_EAC",e[e.COMPRESSED_SIGNED_R11_EAC=37489]="COMPRESSED_SIGNED_R11_EAC",e[e.COMPRESSED_RG11_EAC=37490]="COMPRESSED_RG11_EAC",e[e.COMPRESSED_SIGNED_RG11_EAC=37491]="COMPRESSED_SIGNED_RG11_EAC",e[e.COMPRESSED_RGB8_ETC2=37492]="COMPRESSED_RGB8_ETC2",e[e.COMPRESSED_RGBA8_ETC2_EAC=37493]="COMPRESSED_RGBA8_ETC2_EAC",e[e.COMPRESSED_SRGB8_ETC2=37494]="COMPRESSED_SRGB8_ETC2",e[e.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC=37495]="COMPRESSED_SRGB8_ALPHA8_ETC2_EAC",e[e.COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2=37496]="COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2",e[e.COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2=37497]="COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2",e[e.COMPRESSED_RGB_PVRTC_4BPPV1_IMG=35840]="COMPRESSED_RGB_PVRTC_4BPPV1_IMG",e[e.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG=35842]="COMPRESSED_RGBA_PVRTC_4BPPV1_IMG",e[e.COMPRESSED_RGB_PVRTC_2BPPV1_IMG=35841]="COMPRESSED_RGB_PVRTC_2BPPV1_IMG",e[e.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG=35843]="COMPRESSED_RGBA_PVRTC_2BPPV1_IMG",e[e.COMPRESSED_RGB_ETC1_WEBGL=36196]="COMPRESSED_RGB_ETC1_WEBGL",e[e.COMPRESSED_RGB_ATC_WEBGL=35986]="COMPRESSED_RGB_ATC_WEBGL",e[e.COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL=35986]="COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL",e[e.COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL=34798]="COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL",e[e.UNSIGNED_INT_24_8_WEBGL=34042]="UNSIGNED_INT_24_8_WEBGL",e[e.HALF_FLOAT_OES=36193]="HALF_FLOAT_OES",e[e.RGBA32F_EXT=34836]="RGBA32F_EXT",e[e.RGB32F_EXT=34837]="RGB32F_EXT",e[e.FRAMEBUFFER_ATTACHMENT_COMPONENT_TYPE_EXT=33297]="FRAMEBUFFER_ATTACHMENT_COMPONENT_TYPE_EXT",e[e.UNSIGNED_NORMALIZED_EXT=35863]="UNSIGNED_NORMALIZED_EXT",e[e.MIN_EXT=32775]="MIN_EXT",e[e.MAX_EXT=32776]="MAX_EXT",e[e.SRGB_EXT=35904]="SRGB_EXT",e[e.SRGB_ALPHA_EXT=35906]="SRGB_ALPHA_EXT",e[e.SRGB8_ALPHA8_EXT=35907]="SRGB8_ALPHA8_EXT",e[e.FRAMEBUFFER_ATTACHMENT_COLOR_ENCODING_EXT=33296]="FRAMEBUFFER_ATTACHMENT_COLOR_ENCODING_EXT",e[e.FRAGMENT_SHADER_DERIVATIVE_HINT_OES=35723]="FRAGMENT_SHADER_DERIVATIVE_HINT_OES",e[e.COLOR_ATTACHMENT0_WEBGL=36064]="COLOR_ATTACHMENT0_WEBGL",e[e.COLOR_ATTACHMENT1_WEBGL=36065]="COLOR_ATTACHMENT1_WEBGL",e[e.COLOR_ATTACHMENT2_WEBGL=36066]="COLOR_ATTACHMENT2_WEBGL",e[e.COLOR_ATTACHMENT3_WEBGL=36067]="COLOR_ATTACHMENT3_WEBGL",e[e.COLOR_ATTACHMENT4_WEBGL=36068]="COLOR_ATTACHMENT4_WEBGL",e[e.COLOR_ATTACHMENT5_WEBGL=36069]="COLOR_ATTACHMENT5_WEBGL",e[e.COLOR_ATTACHMENT6_WEBGL=36070]="COLOR_ATTACHMENT6_WEBGL",e[e.COLOR_ATTACHMENT7_WEBGL=36071]="COLOR_ATTACHMENT7_WEBGL",e[e.COLOR_ATTACHMENT8_WEBGL=36072]="COLOR_ATTACHMENT8_WEBGL",e[e.COLOR_ATTACHMENT9_WEBGL=36073]="COLOR_ATTACHMENT9_WEBGL",e[e.COLOR_ATTACHMENT10_WEBGL=36074]="COLOR_ATTACHMENT10_WEBGL",e[e.COLOR_ATTACHMENT11_WEBGL=36075]="COLOR_ATTACHMENT11_WEBGL",e[e.COLOR_ATTACHMENT12_WEBGL=36076]="COLOR_ATTACHMENT12_WEBGL",e[e.COLOR_ATTACHMENT13_WEBGL=36077]="COLOR_ATTACHMENT13_WEBGL",e[e.COLOR_ATTACHMENT14_WEBGL=36078]="COLOR_ATTACHMENT14_WEBGL",e[e.COLOR_ATTACHMENT15_WEBGL=36079]="COLOR_ATTACHMENT15_WEBGL",e[e.DRAW_BUFFER0_WEBGL=34853]="DRAW_BUFFER0_WEBGL",e[e.DRAW_BUFFER1_WEBGL=34854]="DRAW_BUFFER1_WEBGL",e[e.DRAW_BUFFER2_WEBGL=34855]="DRAW_BUFFER2_WEBGL",e[e.DRAW_BUFFER3_WEBGL=34856]="DRAW_BUFFER3_WEBGL",e[e.DRAW_BUFFER4_WEBGL=34857]="DRAW_BUFFER4_WEBGL",e[e.DRAW_BUFFER5_WEBGL=34858]="DRAW_BUFFER5_WEBGL",e[e.DRAW_BUFFER6_WEBGL=34859]="DRAW_BUFFER6_WEBGL",e[e.DRAW_BUFFER7_WEBGL=34860]="DRAW_BUFFER7_WEBGL",e[e.DRAW_BUFFER8_WEBGL=34861]="DRAW_BUFFER8_WEBGL",e[e.DRAW_BUFFER9_WEBGL=34862]="DRAW_BUFFER9_WEBGL",e[e.DRAW_BUFFER10_WEBGL=34863]="DRAW_BUFFER10_WEBGL",e[e.DRAW_BUFFER11_WEBGL=34864]="DRAW_BUFFER11_WEBGL",e[e.DRAW_BUFFER12_WEBGL=34865]="DRAW_BUFFER12_WEBGL",e[e.DRAW_BUFFER13_WEBGL=34866]="DRAW_BUFFER13_WEBGL",e[e.DRAW_BUFFER14_WEBGL=34867]="DRAW_BUFFER14_WEBGL",e[e.DRAW_BUFFER15_WEBGL=34868]="DRAW_BUFFER15_WEBGL",e[e.MAX_COLOR_ATTACHMENTS_WEBGL=36063]="MAX_COLOR_ATTACHMENTS_WEBGL",e[e.MAX_DRAW_BUFFERS_WEBGL=34852]="MAX_DRAW_BUFFERS_WEBGL",e[e.VERTEX_ARRAY_BINDING_OES=34229]="VERTEX_ARRAY_BINDING_OES",e[e.QUERY_COUNTER_BITS_EXT=34916]="QUERY_COUNTER_BITS_EXT",e[e.CURRENT_QUERY_EXT=34917]="CURRENT_QUERY_EXT",e[e.QUERY_RESULT_EXT=34918]="QUERY_RESULT_EXT",e[e.QUERY_RESULT_AVAILABLE_EXT=34919]="QUERY_RESULT_AVAILABLE_EXT",e[e.TIME_ELAPSED_EXT=35007]="TIME_ELAPSED_EXT",e[e.TIMESTAMP_EXT=36392]="TIMESTAMP_EXT",e[e.GPU_DISJOINT_EXT=36795]="GPU_DISJOINT_EXT"})(Ct||(Ct={}));var Ha;(function(e){e[e.Buffer=0]="Buffer",e[e.Texture=1]="Texture",e[e.RenderTarget=2]="RenderTarget",e[e.Sampler=3]="Sampler",e[e.Program=4]="Program",e[e.Bindings=5]="Bindings",e[e.InputLayout=6]="InputLayout",e[e.RenderPipeline=7]="RenderPipeline",e[e.ComputePipeline=8]="ComputePipeline",e[e.Readback=9]="Readback",e[e.QueryPool=10]="QueryPool"})(Ha||(Ha={}));var Ga;(function(e){e[e.NEVER=512]="NEVER",e[e.LESS=513]="LESS",e[e.EQUAL=514]="EQUAL",e[e.LEQUAL=515]="LEQUAL",e[e.GREATER=516]="GREATER",e[e.NOTEQUAL=517]="NOTEQUAL",e[e.GEQUAL=518]="GEQUAL",e[e.ALWAYS=519]="ALWAYS"})(Ga||(Ga={}));var Bd;(function(e){e[e.CCW=2305]="CCW",e[e.CW=2304]="CW"})(Bd||(Bd={}));var wc;(function(e){e[e.NONE=0]="NONE",e[e.FRONT=1]="FRONT",e[e.BACK=2]="BACK",e[e.FRONT_AND_BACK=3]="FRONT_AND_BACK"})(wc||(wc={}));var Ia;(function(e){e[e.ZERO=0]="ZERO",e[e.ONE=1]="ONE",e[e.SRC=768]="SRC",e[e.ONE_MINUS_SRC=769]="ONE_MINUS_SRC",e[e.DST=774]="DST",e[e.ONE_MINUS_DST=775]="ONE_MINUS_DST",e[e.SRC_ALPHA=770]="SRC_ALPHA",e[e.ONE_MINUS_SRC_ALPHA=771]="ONE_MINUS_SRC_ALPHA",e[e.DST_ALPHA=772]="DST_ALPHA",e[e.ONE_MINUS_DST_ALPHA=773]="ONE_MINUS_DST_ALPHA",e[e.CONST=32769]="CONST",e[e.ONE_MINUS_CONSTANT=32770]="ONE_MINUS_CONSTANT",e[e.SRC_ALPHA_SATURATE=776]="SRC_ALPHA_SATURATE"})(Ia||(Ia={}));var Sl;(function(e){e[e.ADD=32774]="ADD",e[e.SUBSTRACT=32778]="SUBSTRACT",e[e.REVERSE_SUBSTRACT=32779]="REVERSE_SUBSTRACT",e[e.MIN=32775]="MIN",e[e.MAX=32776]="MAX"})(Sl||(Sl={}));var ac;(function(e){e[e.CLAMP_TO_EDGE=0]="CLAMP_TO_EDGE",e[e.REPEAT=1]="REPEAT",e[e.MIRRORED_REPEAT=2]="MIRRORED_REPEAT"})(ac||(ac={}));var ru;(function(e){e[e.POINT=0]="POINT",e[e.BILINEAR=1]="BILINEAR"})(ru||(ru={}));var bu;(function(e){e[e.NO_MIP=0]="NO_MIP",e[e.NEAREST=1]="NEAREST",e[e.LINEAR=2]="LINEAR"})(bu||(bu={}));var nu;(function(e){e[e.POINTS=0]="POINTS",e[e.TRIANGLES=1]="TRIANGLES",e[e.TRIANGLE_STRIP=2]="TRIANGLE_STRIP",e[e.LINES=3]="LINES",e[e.LINE_STRIP=4]="LINE_STRIP"})(nu||(nu={}));var To;(function(e){e[e.MAP_READ=1]="MAP_READ",e[e.MAP_WRITE=2]="MAP_WRITE",e[e.COPY_SRC=4]="COPY_SRC",e[e.COPY_DST=8]="COPY_DST",e[e.INDEX=16]="INDEX",e[e.VERTEX=32]="VERTEX",e[e.UNIFORM=64]="UNIFORM",e[e.STORAGE=128]="STORAGE",e[e.INDIRECT=256]="INDIRECT",e[e.QUERY_RESOLVE=512]="QUERY_RESOLVE"})(To||(To={}));var jf;(function(e){e[e.STATIC=1]="STATIC",e[e.DYNAMIC=2]="DYNAMIC"})(jf||(jf={}));var mA;(function(e){e[e.VERTEX=1]="VERTEX",e[e.INSTANCE=2]="INSTANCE"})(mA||(mA={}));var Cx;(function(e){e.LOADED="loaded"})(Cx||(Cx={}));var da;(function(e){e[e.TEXTURE_2D=0]="TEXTURE_2D",e[e.TEXTURE_2D_ARRAY=1]="TEXTURE_2D_ARRAY",e[e.TEXTURE_3D=2]="TEXTURE_3D",e[e.TEXTURE_CUBE_MAP=3]="TEXTURE_CUBE_MAP"})(da||(da={}));var Kc;(function(e){e[e.SAMPLED=1]="SAMPLED",e[e.RENDER_TARGET=2]="RENDER_TARGET"})(Kc||(Kc={}));var xl;(function(e){e[e.NONE=0]="NONE",e[e.RED=1]="RED",e[e.GREEN=2]="GREEN",e[e.BLUE=4]="BLUE",e[e.ALPHA=8]="ALPHA",e[e.RGB=7]="RGB",e[e.ALL=15]="ALL"})(xl||(xl={}));var zl;(function(e){e[e.KEEP=7680]="KEEP",e[e.ZERO=0]="ZERO",e[e.REPLACE=7681]="REPLACE",e[e.INVERT=5386]="INVERT",e[e.INCREMENT_CLAMP=7682]="INCREMENT_CLAMP",e[e.DECREMENT_CLAMP=7683]="DECREMENT_CLAMP",e[e.INCREMENT_WRAP=34055]="INCREMENT_WRAP",e[e.DECREMENT_WRAP=34056]="DECREMENT_WRAP"})(zl||(zl={}));function cF(e,t,r,n){var i=da.TEXTURE_2D,a=1,s=Kc.SAMPLED;return{dimension:i,format:e,width:t,height:r,depthOrArrayLayers:a,mipLevelCount:n,usage:s}}var Ts;(function(e){e[e.Float=0]="Float",e[e.Uint=1]="Uint",e[e.Sint=2]="Sint",e[e.Depth=3]="Depth"})(Ts||(Ts={}));var Rp;(function(e){e[e.LOWER_LEFT=0]="LOWER_LEFT",e[e.UPPER_LEFT=1]="UPPER_LEFT"})(Rp||(Rp={}));var Mp;(function(e){e[e.NEGATIVE_ONE=0]="NEGATIVE_ONE",e[e.ZERO=1]="ZERO"})(Mp||(Mp={}));var wg;(function(e){e[e.OcclusionConservative=0]="OcclusionConservative"})(wg||(wg={}));var Or;(function(e){e[e.U8=1]="U8",e[e.U16=2]="U16",e[e.U32=3]="U32",e[e.S8=4]="S8",e[e.S16=5]="S16",e[e.S32=6]="S32",e[e.F16=7]="F16",e[e.F32=8]="F32",e[e.BC1=65]="BC1",e[e.BC2=66]="BC2",e[e.BC3=67]="BC3",e[e.BC4_UNORM=68]="BC4_UNORM",e[e.BC4_SNORM=69]="BC4_SNORM",e[e.BC5_UNORM=70]="BC5_UNORM",e[e.BC5_SNORM=71]="BC5_SNORM",e[e.U16_PACKED_5551=97]="U16_PACKED_5551",e[e.U16_PACKED_565=98]="U16_PACKED_565",e[e.D24=129]="D24",e[e.D32F=130]="D32F",e[e.D24S8=131]="D24S8",e[e.D32FS8=132]="D32FS8"})(Or||(Or={}));var kn;(function(e){e[e.R=1]="R",e[e.RG=2]="RG",e[e.RGB=3]="RGB",e[e.RGBA=4]="RGBA",e[e.A=5]="A"})(kn||(kn={}));function fF(e){return e}var xn;(function(e){e[e.None=0]="None",e[e.Normalized=1]="Normalized",e[e.sRGB=2]="sRGB",e[e.Depth=4]="Depth",e[e.Stencil=8]="Stencil",e[e.RenderTarget=16]="RenderTarget"})(xn||(xn={}));function gi(e,t,r){return e<<16|t<<8|r}var Jt;(function(e){e[e.ALPHA=gi(Or.U8,kn.A,xn.None)]="ALPHA",e[e.U8_LUMINANCE=gi(Or.U8,kn.A,xn.None)]="U8_LUMINANCE",e[e.F16_LUMINANCE=gi(Or.F16,kn.A,xn.None)]="F16_LUMINANCE",e[e.F32_LUMINANCE=gi(Or.F32,kn.A,xn.None)]="F32_LUMINANCE",e[e.F16_R=gi(Or.F16,kn.R,xn.None)]="F16_R",e[e.F16_RG=gi(Or.F16,kn.RG,xn.None)]="F16_RG",e[e.F16_RGB=gi(Or.F16,kn.RGB,xn.None)]="F16_RGB",e[e.F16_RGBA=gi(Or.F16,kn.RGBA,xn.None)]="F16_RGBA",e[e.F32_R=gi(Or.F32,kn.R,xn.None)]="F32_R",e[e.F32_RG=gi(Or.F32,kn.RG,xn.None)]="F32_RG",e[e.F32_RGB=gi(Or.F32,kn.RGB,xn.None)]="F32_RGB",e[e.F32_RGBA=gi(Or.F32,kn.RGBA,xn.None)]="F32_RGBA",e[e.U8_R=gi(Or.U8,kn.R,xn.None)]="U8_R",e[e.U8_R_NORM=gi(Or.U8,kn.R,xn.Normalized)]="U8_R_NORM",e[e.U8_RG=gi(Or.U8,kn.RG,xn.None)]="U8_RG",e[e.U8_RG_NORM=gi(Or.U8,kn.RG,xn.Normalized)]="U8_RG_NORM",e[e.U8_RGB=gi(Or.U8,kn.RGB,xn.None)]="U8_RGB",e[e.U8_RGB_NORM=gi(Or.U8,kn.RGB,xn.Normalized)]="U8_RGB_NORM",e[e.U8_RGB_SRGB=gi(Or.U8,kn.RGB,xn.sRGB|xn.Normalized)]="U8_RGB_SRGB",e[e.U8_RGBA=gi(Or.U8,kn.RGBA,xn.None)]="U8_RGBA",e[e.U8_RGBA_NORM=gi(Or.U8,kn.RGBA,xn.Normalized)]="U8_RGBA_NORM",e[e.U8_RGBA_SRGB=gi(Or.U8,kn.RGBA,xn.sRGB|xn.Normalized)]="U8_RGBA_SRGB",e[e.U16_R=gi(Or.U16,kn.R,xn.None)]="U16_R",e[e.U16_R_NORM=gi(Or.U16,kn.R,xn.Normalized)]="U16_R_NORM",e[e.U16_RG_NORM=gi(Or.U16,kn.RG,xn.Normalized)]="U16_RG_NORM",e[e.U16_RGBA_NORM=gi(Or.U16,kn.RGBA,xn.Normalized)]="U16_RGBA_NORM",e[e.U16_RGB=gi(Or.U16,kn.RGB,xn.None)]="U16_RGB",e[e.U32_R=gi(Or.U32,kn.R,xn.None)]="U32_R",e[e.U32_RG=gi(Or.U32,kn.RG,xn.None)]="U32_RG",e[e.S8_R=gi(Or.S8,kn.R,xn.None)]="S8_R",e[e.S8_R_NORM=gi(Or.S8,kn.R,xn.Normalized)]="S8_R_NORM",e[e.S8_RG_NORM=gi(Or.S8,kn.RG,xn.Normalized)]="S8_RG_NORM",e[e.S8_RGB_NORM=gi(Or.S8,kn.RGB,xn.Normalized)]="S8_RGB_NORM",e[e.S8_RGBA_NORM=gi(Or.S8,kn.RGBA,xn.Normalized)]="S8_RGBA_NORM",e[e.S16_R=gi(Or.S16,kn.R,xn.None)]="S16_R",e[e.S16_RG=gi(Or.S16,kn.RG,xn.None)]="S16_RG",e[e.S16_RG_NORM=gi(Or.S16,kn.RG,xn.Normalized)]="S16_RG_NORM",e[e.S16_RGB_NORM=gi(Or.S16,kn.RGB,xn.Normalized)]="S16_RGB_NORM",e[e.S16_RGBA=gi(Or.S16,kn.RGBA,xn.None)]="S16_RGBA",e[e.S16_RGBA_NORM=gi(Or.S16,kn.RGBA,xn.Normalized)]="S16_RGBA_NORM",e[e.S32_R=gi(Or.S32,kn.R,xn.None)]="S32_R",e[e.U16_RGBA_5551=gi(Or.U16_PACKED_5551,kn.RGBA,xn.Normalized)]="U16_RGBA_5551",e[e.U16_RGB_565=gi(Or.U16_PACKED_565,kn.RGB,xn.Normalized)]="U16_RGB_565",e[e.BC1=gi(Or.BC1,kn.RGBA,xn.Normalized)]="BC1",e[e.BC1_SRGB=gi(Or.BC1,kn.RGBA,xn.Normalized|xn.sRGB)]="BC1_SRGB",e[e.BC2=gi(Or.BC2,kn.RGBA,xn.Normalized)]="BC2",e[e.BC2_SRGB=gi(Or.BC2,kn.RGBA,xn.Normalized|xn.sRGB)]="BC2_SRGB",e[e.BC3=gi(Or.BC3,kn.RGBA,xn.Normalized)]="BC3",e[e.BC3_SRGB=gi(Or.BC3,kn.RGBA,xn.Normalized|xn.sRGB)]="BC3_SRGB",e[e.BC4_UNORM=gi(Or.BC4_UNORM,kn.R,xn.Normalized)]="BC4_UNORM",e[e.BC4_SNORM=gi(Or.BC4_SNORM,kn.R,xn.Normalized)]="BC4_SNORM",e[e.BC5_UNORM=gi(Or.BC5_UNORM,kn.RG,xn.Normalized)]="BC5_UNORM",e[e.BC5_SNORM=gi(Or.BC5_SNORM,kn.RG,xn.Normalized)]="BC5_SNORM",e[e.D24=gi(Or.D24,kn.R,xn.Depth)]="D24",e[e.D24_S8=gi(Or.D24S8,kn.RG,xn.Depth|xn.Stencil)]="D24_S8",e[e.D32F=gi(Or.D32F,kn.R,xn.Depth)]="D32F",e[e.D32F_S8=gi(Or.D32FS8,kn.RG,xn.Depth|xn.Stencil)]="D32F_S8",e[e.U8_RGB_RT=gi(Or.U8,kn.RGB,xn.RenderTarget|xn.Normalized)]="U8_RGB_RT",e[e.U8_RGBA_RT=gi(Or.U8,kn.RGBA,xn.RenderTarget|xn.Normalized)]="U8_RGBA_RT",e[e.U8_RGBA_RT_SRGB=gi(Or.U8,kn.RGBA,xn.RenderTarget|xn.Normalized|xn.sRGB)]="U8_RGBA_RT_SRGB"})(Jt||(Jt={}));function Ig(e){return e>>>8&255}function d0(e){return e>>>16&255}function wp(e){return e&255}function bx(e){switch(e){case Or.F32:case Or.U32:case Or.S32:return 4;case Or.U16:case Or.S16:case Or.F16:return 2;case Or.U8:case Or.S8:return 1;default:throw new Error("whoops")}}function Rx(e){return bx(d0(e))}function hF(e){return Ig(e)}function k6(e){var t=bx(d0(e)),r=Ig(e);return t*r}function AF(e,t){return e&4294967040|t}function pF(e,t){return e&4294902015|t<<8}function Mx(e){var t=wp(e);if(t&xn.Depth)return Ts.Depth;if(t&xn.Normalized)return Ts.Float;var r=d0(e);if(r===Or.F16||r===Or.F32)return Ts.Float;if(r===Or.U8||r===Or.U16||r===Or.U32)return Ts.Uint;if(r===Or.S8||r===Or.S16||r===Or.S32)return Ts.Sint;throw new Error("whoops")}function ea(e,t){if(t===void 0&&(t=""),!e)throw new Error("Assert fail: ".concat(t))}function _A(e){if(e!=null)return e;throw new Error("Missing object")}function Ix(e,t){return e.r===t.r&&e.g===t.g&&e.b===t.b&&e.a===t.a}function Px(e,t){e.r=t.r,e.g=t.g,e.b=t.b,e.a=t.a}function Ox(e){var t=e.r,r=e.g,n=e.b,i=e.a;return{r:t,g:r,b:n,a:i}}function Pg(e,t,r,n){return n===void 0&&(n=1),{r:e,g:t,b:r,a:n}}var N_=Pg(0,0,0,0),dF=Pg(0,0,0,1),U6=Pg(1,1,1,0),vF=Pg(1,1,1,1),Ip=!0;function gF(e,t){t===void 0&&(t=Ip),t&&(e[10]=-e[10],e[14]=-e[14])}function mF(e,t){t===void 0&&(t=Ip),t&&(e[10]=-e[10],e[14]=-e[14]+1)}function Z6(e,t){if(t===void 0&&(t=Ip),t)switch(e){case Ga.LESS:return Ga.GREATER;case Ga.LEQUAL:return Ga.GEQUAL;case Ga.GEQUAL:return Ga.LEQUAL;case Ga.GREATER:return Ga.LESS;default:return e}else return e}function _F(e,t){return t===void 0&&(t=Ip),t?1-e:e}function yF(e,t){return t===void 0&&(t=Ip),t?-e:e}function EF(e,t,r,n){if(n===void 0&&(n=Ip),r=Z6(r,n),r===Ga.LESS)return e<t;if(r===Ga.LEQUAL)return e<=t;if(r===Ga.GREATER)return e>t;if(r===Ga.GEQUAL)return e>=t;throw new Error("whoops")}function Og(e){return!!(e&&!(e&e-1))}function Pp(e,t){return e!=null?e:t}function z6(e){return e===void 0?null:e}function SF(e,t,r){e.length=t,e.fill(r)}function Ng(e,t){var r=t-1;return e+r&~r}function xF(e,t){return((e+t-1)/t|0)*t}function G6(e,t,r){for(var n=0,i=e.length;n<i;){var a=n+(i-n>>>1),s=r(t,e[a]);s<0?i=a:n=a+1}return n}function TF(e,t,r){var n=G6(e,t,r);e.splice(n,0,t)}function CF(e,t,r){return r?e|=t:e&=~t,e}function V6(e,t){for(var r=new Array(e),n=0;n<e;n++)r[n]=t();return r}function H6(e,t){t===void 0&&(t=1);var r=e.split(`
`);return r.map(function(n,i){return"".concat(W6(""+(t+i),4," "),"  ").concat(n)}).join(`
`)}function W6(e,t,r){for(r===void 0&&(r="0");e.length<t;)e="".concat(r).concat(e);return e}function bF(e,t){for(var r=[],n=e;n<e+t;n++)r.push(n);return r}function Nx(e,t){e.blendDstFactor=t.blendDstFactor,e.blendSrcFactor=t.blendSrcFactor,e.blendMode=t.blendMode}function Dg(e,t){return e===void 0&&(e={}),e.compare=t.compare,e.depthFailOp=t.depthFailOp,e.passOp=t.passOp,e.failOp=t.failOp,e}function Dx(e,t){return e===void 0&&(e={rgbBlendState:{},alphaBlendState:{},channelWriteMask:0}),Nx(e.rgbBlendState,t.rgbBlendState),Nx(e.alphaBlendState,t.alphaBlendState),e.channelWriteMask=t.channelWriteMask,e}function D_(e,t){e.length!==t.length&&(e.length=t.length);for(var r=0;r<t.length;r++)e[r]=Dx(e[r],t[r])}function j6(e,t){t.attachmentsState!==void 0&&D_(e.attachmentsState,t.attachmentsState),e.blendConstant&&t.blendConstant&&Px(e.blendConstant,t.blendConstant),e.depthCompare=Pp(t.depthCompare,e.depthCompare),e.depthWrite=Pp(t.depthWrite,e.depthWrite),e.stencilWrite=Pp(t.stencilWrite,e.stencilWrite),e.stencilFront&&t.stencilFront&&Dg(e.stencilFront,t.stencilFront),e.stencilBack&&t.stencilBack&&Dg(e.stencilBack,t.stencilBack),e.cullMode=Pp(t.cullMode,e.cullMode),e.frontFace=Pp(t.frontFace,e.frontFace),e.polygonOffset=Pp(t.polygonOffset,e.polygonOffset)}function Op(e){var t=Object.assign({},e);return t.attachmentsState=[],D_(t.attachmentsState,e.attachmentsState),t.blendConstant=t.blendConstant&&Ox(t.blendConstant),t.stencilFront=Dg(void 0,e.stencilFront),t.stencilBack=Dg(void 0,e.stencilBack),t}function X6(e,t){t.channelWriteMask!==void 0&&(e.channelWriteMask=t.channelWriteMask),t.rgbBlendMode!==void 0&&(e.rgbBlendState.blendMode=t.rgbBlendMode),t.alphaBlendMode!==void 0&&(e.alphaBlendState.blendMode=t.alphaBlendMode),t.rgbBlendSrcFactor!==void 0&&(e.rgbBlendState.blendSrcFactor=t.rgbBlendSrcFactor),t.alphaBlendSrcFactor!==void 0&&(e.alphaBlendState.blendSrcFactor=t.alphaBlendSrcFactor),t.rgbBlendDstFactor!==void 0&&(e.rgbBlendState.blendDstFactor=t.rgbBlendDstFactor),t.alphaBlendDstFactor!==void 0&&(e.alphaBlendState.blendDstFactor=t.alphaBlendDstFactor)}var Lx={blendMode:Sl.ADD,blendSrcFactor:Ia.ONE,blendDstFactor:Ia.ZERO},yA={attachmentsState:[{channelWriteMask:xl.ALL,rgbBlendState:Lx,alphaBlendState:Lx}],blendConstant:Ox(N_),depthWrite:!0,depthCompare:Ga.LEQUAL,stencilWrite:!1,stencilFront:{compare:Ga.ALWAYS,passOp:zl.KEEP,depthFailOp:zl.KEEP,failOp:zl.KEEP},stencilBack:{compare:Ga.ALWAYS,passOp:zl.KEEP,depthFailOp:zl.KEEP,failOp:zl.KEEP},cullMode:wc.NONE,frontFace:Bd.CCW,polygonOffset:!1};function Y6(e,t){e===void 0&&(e=null),t===void 0&&(t=yA);var r=Op(t);return e!==null&&j6(r,e),r}var RF=Y6({depthCompare:Ga.ALWAYS,depthWrite:!1},yA);function MF(e,t){return e.attachmentsState===void 0&&(e.attachmentsState=[],D_(e.attachmentsState,yA.attachmentsState)),X6(e.attachmentsState[0],t),e}var Fx={texture:null,sampler:null,formatKind:Ts.Float,dimension:da.TEXTURE_2D};function Np(e,t,r){if(e.length!==t.length)return!1;for(var n=0;n<e.length;n++)if(!r(e[n],t[n]))return!1;return!0}function Lg(e,t){for(var r=Array(e.length),n=0;n<e.length;n++)r[n]=t(e[n]);return r}function $6(e,t){return e.buffer===t.buffer&&e.size===t.size&&e.binding===t.binding&&e.offset===t.offset}function Q6(e,t){return e===null?t===null:t===null?!1:e.sampler===t.sampler&&e.texture===t.texture&&e.dimension===t.dimension&&e.formatKind===t.formatKind&&e.comparison===t.comparison}function wF(e,t){return e.samplerBindings=e.samplerBindings||[],e.uniformBufferBindings=e.uniformBufferBindings||[],t.samplerBindings=t.samplerBindings||[],t.uniformBufferBindings=t.uniformBufferBindings||[],!(e.samplerBindings.length!==t.samplerBindings.length||!Np(e.samplerBindings,t.samplerBindings,Q6)||!Np(e.uniformBufferBindings,t.uniformBufferBindings,$6))}function Bx(e,t){return e.blendMode==t.blendMode&&e.blendSrcFactor===t.blendSrcFactor&&e.blendDstFactor===t.blendDstFactor}function q6(e,t){return!(!Bx(e.rgbBlendState,t.rgbBlendState)||!Bx(e.alphaBlendState,t.alphaBlendState)||e.channelWriteMask!==t.channelWriteMask)}function Fg(e,t){return e.compare==t.compare&&e.depthFailOp===t.depthFailOp&&e.failOp===t.failOp&&e.passOp===t.passOp}function K6(e,t){return!Np(e.attachmentsState,t.attachmentsState,q6)||e.blendConstant&&t.blendConstant&&!Ix(e.blendConstant,t.blendConstant)||e.stencilFront&&t.stencilFront&&!Fg(e.stencilFront,t.stencilFront)||e.stencilBack&&t.stencilBack&&!Fg(e.stencilBack,t.stencilBack)?!1:e.depthCompare===t.depthCompare&&e.depthWrite===t.depthWrite&&e.stencilWrite===t.stencilWrite&&e.cullMode===t.cullMode&&e.frontFace===t.frontFace&&e.polygonOffset===t.polygonOffset}function kx(e,t){return e.id===t.id}function J6(e,t){return e===t}function IF(e,t){return!(e.topology!==t.topology||e.inputLayout!==t.inputLayout||e.sampleCount!==t.sampleCount||e.megaStateDescriptor&&t.megaStateDescriptor&&!K6(e.megaStateDescriptor,t.megaStateDescriptor)||!kx(e.program,t.program)||!Np(e.colorAttachmentFormats,t.colorAttachmentFormats,J6)||e.depthStencilAttachmentFormat!==t.depthStencilAttachmentFormat)}function e5(e,t){return e.offset===t.offset&&e.shaderLocation===t.shaderLocation&&e.format===t.format&&e.divisor===t.divisor}function t5(e,t){return isNil(e)?isNil(t):isNil(t)?!1:e.arrayStride===t.arrayStride&&e.stepMode===t.stepMode&&Np(e.attributes,t.attributes,e5)}function PF(e,t){return!(e.indexBufferFormat!==t.indexBufferFormat||!Np(e.vertexBufferDescriptors,t.vertexBufferDescriptors,t5)||!kx(e.program,t.program))}function OF(e,t){return e.addressModeU===t.addressModeU&&e.addressModeV===t.addressModeV&&e.minFilter===t.minFilter&&e.magFilter===t.magFilter&&e.mipmapFilter===t.mipmapFilter&&e.lodMinClamp===t.lodMinClamp&&e.lodMaxClamp===t.lodMaxClamp&&e.maxAnisotropy===t.maxAnisotropy&&e.compareFunction===t.compareFunction}function r5(e){var t=e.sampler,r=e.texture,n=e.dimension,i=e.formatKind,a=e.comparison;return{sampler:t,texture:r,dimension:n,formatKind:i,comparison:a}}function n5(e){var t=e.buffer,r=e.size,n=e.binding,i=e.offset;return{binding:n,buffer:t,offset:i,size:r}}function NF(e){var t=e.samplerBindings&&Lg(e.samplerBindings,r5),r=e.uniformBufferBindings&&Lg(e.uniformBufferBindings,n5);return{samplerBindings:t,uniformBufferBindings:r,pipeline:e.pipeline}}function DF(e){var t=e.inputLayout,r=e.program,n=e.topology,i=e.megaStateDescriptor&&Op(e.megaStateDescriptor),a=e.colorAttachmentFormats.slice(),s=e.depthStencilAttachmentFormat,l=e.sampleCount;return{inputLayout:t,megaStateDescriptor:i,program:r,topology:n,colorAttachmentFormats:a,depthStencilAttachmentFormat:s,sampleCount:l}}function i5(e){var t=e.shaderLocation,r=e.format,n=e.offset,i=e.divisor;return{shaderLocation:t,format:r,offset:n,divisor:i}}function a5(e){if(isNil(e))return e;var t=e.arrayStride,r=e.stepMode,n=Lg(e.attributes,i5);return{arrayStride:t,stepMode:r,attributes:n}}function LF(e){var t=Lg(e.vertexBufferDescriptors,a5),r=e.indexBufferFormat,n=e.program;return{vertexBufferDescriptors:t,indexBufferFormat:r,program:n}}var ya,o5=/([^[]*)(\[[0-9]+\])?/;function s5(e){if(e[e.length-1]!=="]")return{name:e,length:1,isArray:!1};var t=e.match(o5);if(!t||t.length<2)throw new Error("Failed to parse GLSL uniform name ".concat(e));return{name:t[1],length:Number(t[2])||1,isArray:!!t[2]}}function oc(){var e=null;return function(t,r,n){var i=e!==n;return i&&(t.uniform1i(r,n),e=n),i}}function Cs(e,t,r,n){var i=null,a=null;return function(s,l,p){var m=t(p,r),T=m.length,R=!1;if(i===null)i=new Float32Array(T),a=T,R=!0;else{ea(a===T,"Uniform length cannot change.");for(var L=0;L<T;++L)if(m[L]!==i[L]){R=!0;break}}return R&&(n(s,e,l,m),i.set(m)),R}}function Gl(e,t,r,n){e[t](r,n)}function H0(e,t,r,n){e[t](r,!1,n)}var u5={},l5={},c5={},Ux=[0];function L_(e,t,r,n){t===1&&typeof e=="boolean"&&(e=e?1:0),Number.isFinite(e)&&(Ux[0]=e,e=Ux);var i=e.length;if(e instanceof r)return e;var a=n[i];a||(a=new r(i),n[i]=a);for(var s=0;s<i;s++)a[s]=e[s];return a}function Jc(e,t){return L_(e,t,Float32Array,u5)}function Mh(e,t){return L_(e,t,Int32Array,l5)}function Bg(e,t){return L_(e,t,Uint32Array,c5)}var f5=(ya={},ya[Ct.FLOAT]=Cs.bind(null,"uniform1fv",Jc,1,Gl),ya[Ct.FLOAT_VEC2]=Cs.bind(null,"uniform2fv",Jc,2,Gl),ya[Ct.FLOAT_VEC3]=Cs.bind(null,"uniform3fv",Jc,3,Gl),ya[Ct.FLOAT_VEC4]=Cs.bind(null,"uniform4fv",Jc,4,Gl),ya[Ct.INT]=Cs.bind(null,"uniform1iv",Mh,1,Gl),ya[Ct.INT_VEC2]=Cs.bind(null,"uniform2iv",Mh,2,Gl),ya[Ct.INT_VEC3]=Cs.bind(null,"uniform3iv",Mh,3,Gl),ya[Ct.INT_VEC4]=Cs.bind(null,"uniform4iv",Mh,4,Gl),ya[Ct.BOOL]=Cs.bind(null,"uniform1iv",Mh,1,Gl),ya[Ct.BOOL_VEC2]=Cs.bind(null,"uniform2iv",Mh,2,Gl),ya[Ct.BOOL_VEC3]=Cs.bind(null,"uniform3iv",Mh,3,Gl),ya[Ct.BOOL_VEC4]=Cs.bind(null,"uniform4iv",Mh,4,Gl),ya[Ct.FLOAT_MAT2]=Cs.bind(null,"uniformMatrix2fv",Jc,4,H0),ya[Ct.FLOAT_MAT3]=Cs.bind(null,"uniformMatrix3fv",Jc,9,H0),ya[Ct.FLOAT_MAT4]=Cs.bind(null,"uniformMatrix4fv",Jc,16,H0),ya[Ct.UNSIGNED_INT]=Cs.bind(null,"uniform1uiv",Bg,1,Gl),ya[Ct.UNSIGNED_INT_VEC2]=Cs.bind(null,"uniform2uiv",Bg,2,Gl),ya[Ct.UNSIGNED_INT_VEC3]=Cs.bind(null,"uniform3uiv",Bg,3,Gl),ya[Ct.UNSIGNED_INT_VEC4]=Cs.bind(null,"uniform4uiv",Bg,4,Gl),ya[Ct.FLOAT_MAT2x3]=Cs.bind(null,"uniformMatrix2x3fv",Jc,6,H0),ya[Ct.FLOAT_MAT2x4]=Cs.bind(null,"uniformMatrix2x4fv",Jc,8,H0),ya[Ct.FLOAT_MAT3x2]=Cs.bind(null,"uniformMatrix3x2fv",Jc,6,H0),ya[Ct.FLOAT_MAT3x4]=Cs.bind(null,"uniformMatrix3x4fv",Jc,12,H0),ya[Ct.FLOAT_MAT4x2]=Cs.bind(null,"uniformMatrix4x2fv",Jc,8,H0),ya[Ct.FLOAT_MAT4x3]=Cs.bind(null,"uniformMatrix4x3fv",Jc,12,H0),ya[Ct.SAMPLER_2D]=oc,ya[Ct.SAMPLER_CUBE]=oc,ya[Ct.SAMPLER_3D]=oc,ya[Ct.SAMPLER_2D_SHADOW]=oc,ya[Ct.SAMPLER_2D_ARRAY]=oc,ya[Ct.SAMPLER_2D_ARRAY_SHADOW]=oc,ya[Ct.SAMPLER_CUBE_SHADOW]=oc,ya[Ct.INT_SAMPLER_2D]=oc,ya[Ct.INT_SAMPLER_3D]=oc,ya[Ct.INT_SAMPLER_CUBE]=oc,ya[Ct.INT_SAMPLER_2D_ARRAY]=oc,ya[Ct.UNSIGNED_INT_SAMPLER_2D]=oc,ya[Ct.UNSIGNED_INT_SAMPLER_3D]=oc,ya[Ct.UNSIGNED_INT_SAMPLER_CUBE]=oc,ya[Ct.UNSIGNED_INT_SAMPLER_2D_ARRAY]=oc,ya);function Zx(e,t,r){var n=f5[r.type];if(!n)throw new Error("Unknown GLSL uniform type ".concat(r.type));return n().bind(null,e,t)}var h5={"[object Int8Array]":5120,"[object Int16Array]":5122,"[object Int32Array]":5124,"[object Uint8Array]":5121,"[object Uint8ClampedArray]":5121,"[object Uint16Array]":5123,"[object Uint32Array]":5125,"[object Float32Array]":5126,"[object Float64Array]":5121,"[object ArrayBuffer]":5121};function A5(e){return Object.prototype.toString.call(e)in h5}function kd(e,t){return"#define ".concat(e," ").concat(t)}function p5(e){var t={};return e.replace(/^\s*#define\s*(\S*)\s*(\S*)\s*$/gm,function(r,n,i){var a=Number(i);return t[n]=isNaN(a)?i:a,""}),t}function d5(e,t){var r=[];return e.replace(/^\s*layout\(location\s*=\s*(\S*)\)\s*in\s+\S+\s*(.*);$/gm,function(n,i,a){var s=Number(i);return r.push({location:isNaN(s)?t[i]:s,name:a}),""}),r}function FF(e){var t=[],r=[];return e.replace(/\s*struct\s*(.*)\s*{((?:\s*.*\s*)*?)};/g,function(n,i,a){var s=[];return a.trim().split(`
`).forEach(function(l){var p=__read(l.trim().split(/\s+/),2),m=p[0],T=p[1];s.push({type:m.trim(),name:T.replace(";","").trim()})}),r.push({type:i.trim(),uniforms:s}),""}),e.replace(/\s*uniform\s*.*\s*{((?:\s*.*\s*)*?)};/g,function(n,i){return i.trim().split(`
`).forEach(function(a){var s=a.trim().split(" "),l=s[0]||"",p=s[1]||"",m=p.indexOf("[")>-1;if(p=p.replace(";","").replace("[","").trim(),!l.startsWith("#")){if(l){var T=r.find(function(z){return l===z.type});if(T)if(m)for(var R=function(z){T.uniforms.forEach(function(re){t.push("".concat(p,"[").concat(z,"].").concat(re.name))})},L=0;L<5;L++)R(L);else T.uniforms.forEach(function(z){t.push("".concat(p,".").concat(z.name))})}p&&t.push(p)}}),""}),t}function zx(e){if(e===void 0)return null;var t=/binding\s*=\s*(\d+)/.exec(e);if(t!==null){var r=parseInt(t[1],10);if(!Number.isNaN(r))return r}return null}function v5(e){var t="",r=e;return[r,t]}function wh(e,t,r,n,i){var a;n===void 0&&(n=null),i===void 0&&(i=!0);var s=e.glslVersion==="#version 100",l=t==="frag"&&((a=r.match(/^\s*layout\(location\s*=\s*\d*\)\s*out\s+vec4\s*(.*);$/gm))===null||a===void 0?void 0:a.length)>1,p=r.split(`
`).map(function(dt){return dt.replace(/[/][/].*$/,"")}).filter(function(dt){var It=!dt||/^\s+$/.test(dt);return!It}),m="";n!==null&&(m=Object.keys(n).map(function(dt){return kd(dt,n[dt])}).join(`
`));var T=p.find(function(dt){return dt.startsWith("precision")})||"precision mediump float;",R=i?p.filter(function(dt){return!dt.startsWith("precision")}).join(`
`):p.join(`
`),L="";if(e.viewportOrigin===Rp.UPPER_LEFT&&(L+="".concat(kd("VIEWPORT_ORIGIN_TL","1"),`
`)),e.clipSpaceNearZ===Mp.ZERO&&(L+="".concat(kd("CLIPSPACE_NEAR_ZERO","1"),`
`)),e.explicitBindingLocations){var z=0,re=0,ee=0;R=R.replace(/^(layout\((.*)\))?\s*uniform(.+{)$/gm,function(dt,It,Vt,Kt){var yr=Vt?"".concat(Vt,", "):"";return"layout(".concat(yr,"set = ").concat(z,", binding = ").concat(re++,") uniform ").concat(Kt)}),z++,re=0,ea(e.separateSamplerTextures),R=R.replace(/^(layout\((.*)\))?\s*uniform sampler(\w+) (.*);/gm,function(dt,It,Vt,Kt,yr){var _r=zx(Vt);_r===null&&(_r=re++);var Hr=(0,Rn.CR)(v5(Kt),2),nn=Hr[0],Tn=Hr[1];return t==="frag"?`
layout(set = `.concat(z,", binding = ").concat(_r*2+0,") uniform texture").concat(nn," T_").concat(yr,`;
layout(set = `).concat(z,", binding = ").concat(_r*2+1,") uniform sampler").concat(Tn," S_").concat(yr,";").trim():""}),R=R.replace(t==="frag"?/^\b(varying|in)\b/gm:/^\b(varying|out)\b/gm,function(dt,It){return"layout(location = ".concat(ee++,") ").concat(It)}),L+="".concat(kd("gl_VertexID","gl_VertexIndex"),`
`),L+="".concat(kd("gl_InstanceID","gl_InstanceIndex"),`
`),T=T.replace(/^precision (.*) sampler(.*);$/gm,"")}else{var me=0;R=R.replace(/^(layout\((.*)\))?\s*uniform sampler(\w+) (.*);/gm,function(dt,It,Vt,Kt,yr){var _r=zx(Vt);return _r===null&&(_r=me++),"uniform sampler".concat(Kt," ").concat(yr,"; // BINDING=").concat(_r)})}if(e.separateSamplerTextures)R=R.replace(/\bSAMPLER_(\w+)\((.*?)\)/g,function(dt,It,Vt){return"sampler".concat(It,"(T_").concat(Vt,", S_").concat(Vt,")")}),R=R.replace(/\bTEXTURE\((.*?)\)/g,function(dt,It){return"T_".concat(It)});else{var Ie=[];R=R.replace(/\bSAMPLER_(\w+)\((.*?)\)/g,function(dt,It,Vt){return Ie.push([Vt,It]),Vt}),s&&Ie.forEach(function(dt){var It=(0,Rn.CR)(dt,2),Vt=It[0],Kt=It[1];R=R.replace(new RegExp("texture\\(".concat(Vt),"g"),function(){return"texture".concat(Kt,"(").concat(Vt)})}),R=R.replace(/\bTEXTURE\((.*?)\)/g,function(dt,It){return It})}var He="".concat(s?"":e.glslVersion,`
`).concat(s&&l?`#extension GL_EXT_draw_buffers : require
`:"",`
`).concat(s&&t==="frag"?`#extension GL_OES_standard_derivatives : enable
`:"").concat(i?T:"",`
`).concat(L||"").concat(m?m+`
`:"",`
`).concat(R,`
`).trim();if(e.explicitBindingLocations&&t==="frag"&&(He=He.replace(/^\b(out)\b/g,function(dt,It){return"layout(location = 0) ".concat(It)})),s){if(t==="frag"&&(He=He.replace(/^\s*in\s+(\S+)\s*(.*);$/gm,function(dt,It,Vt){return"varying ".concat(It," ").concat(Vt,`;
`)})),t==="vert"&&(He=He.replace(/^\s*out\s+(\S+)\s*(.*);$/gm,function(dt,It,Vt){return"varying ".concat(It," ").concat(Vt,`;
`)}),He=He.replace(/^\s*layout\(location\s*=\s*\S*\)\s*in\s+(\S+)\s*(.*);$/gm,function(dt,It,Vt){return"attribute ".concat(It," ").concat(Vt,`;
`)})),He=He.replace(/\s*uniform\s*.*\s*{((?:\s*.*\s*)*?)};/g,function(dt,It){return It.trim().replace(/^.*$/gm,function(Vt){var Kt=Vt.trim();return Kt.startsWith("#")?Kt:Vt?"uniform ".concat(Kt):""})}),t==="frag")if(l){var Xe=[];He=He.replace(/^\s*layout\(location\s*=\s*\d*\)\s*out\s+vec4\s*(.*);$/gm,function(dt,It){return Xe.push(It),"vec4 ".concat(It,`;
`)});var ot=He.lastIndexOf("}");He=He.substring(0,ot)+`
    `.concat(Xe.map(function(dt,It){return"gl_FragData[".concat(It,"] = ").concat(dt,`;
    `)}).join(`
`))+He.substring(ot)}else{var pt;if(He=He.replace(/^\s*out\s+(\S+)\s*(.*);$/gm,function(dt,It,Vt){return pt=Vt,"".concat(It," ").concat(Vt,`;
`)}),pt){var ot=He.lastIndexOf("}");He=He.substring(0,ot)+`
  gl_FragColor = vec4(`.concat(pt,`);
`)+He.substring(ot)}}He=He.replace(/^\s*layout\((.*)\)/gm,"")}return He}function BF(e,t,r,n){n===void 0&&(n=null);var i=wh(e,"vert",t,n),a=wh(e,"frag",r,n);return{vert:t,frag:r,preprocessedVert:i,preprocessedFrag:a}}var Xf=function(e){(0,Rn.ZT)(t,e);function t(r){var n=r.id,i=r.device,a=e.call(this)||this;return a.id=n,a.device=i,a.device.resourceCreationTracker!==null&&a.device.resourceCreationTracker.trackResourceCreated(a),a}return t.prototype.destroy=function(){this.device.resourceCreationTracker!==null&&this.device.resourceCreationTracker.trackResourceDestroyed(this)},t}(Tx),g5=function(e){(0,Rn.ZT)(t,e);function t(r){var n=r.id,i=r.device,a=r.descriptor,s=e.call(this,{id:n,device:i})||this;s.type=Ha.Bindings;var l=a.uniformBufferBindings,p=a.samplerBindings;return s.uniformBufferBindings=l||[],s.samplerBindings=p||[],s.bindingLayouts=s.createBindingLayouts(),s}return t.prototype.createBindingLayouts=function(){var r=0,n=0,i=[],a=this.uniformBufferBindings.length,s=this.samplerBindings.length;return i.push({firstUniformBuffer:r,numUniformBuffers:a,firstSampler:n,numSamplers:s}),r+=a,n+=s,{numUniformBuffers:r,numSamplers:n,bindingLayoutTables:i}},t}(Xf);function Ln(e){return typeof WebGL2RenderingContext!="undefined"&&e instanceof WebGL2RenderingContext?!0:!!(e&&e._version===2)}function Gx(e){var t=d0(e);switch(t){case Or.BC1:case Or.BC2:case Or.BC3:case Or.BC4_UNORM:case Or.BC4_SNORM:case Or.BC5_UNORM:case Or.BC5_SNORM:return!0;default:return!1}}function Vx(e){var t=wp(e);if(t&xn.Normalized)return!1;var r=d0(e);return r===Or.S8||r===Or.S16||r===Or.S32||r===Or.U8||r===Or.U16||r===Or.U32}function m5(e){switch(e){case jf.STATIC:return Ct.STATIC_DRAW;case jf.DYNAMIC:return Ct.DYNAMIC_DRAW}}function Hx(e){if(e&To.INDEX)return Ct.ELEMENT_ARRAY_BUFFER;if(e&To.VERTEX)return Ct.ARRAY_BUFFER;if(e&To.UNIFORM)return Ct.UNIFORM_BUFFER}function _5(e){switch(e){case nu.TRIANGLES:return Ct.TRIANGLES;case nu.POINTS:return Ct.POINTS;case nu.TRIANGLE_STRIP:return Ct.TRIANGLE_STRIP;case nu.LINES:return Ct.LINES;case nu.LINE_STRIP:return Ct.LINE_STRIP;default:throw new Error("Unknown primitive topology mode")}}function y5(e){switch(e){case Or.U8:return Ct.UNSIGNED_BYTE;case Or.U16:return Ct.UNSIGNED_SHORT;case Or.U32:return Ct.UNSIGNED_INT;case Or.S8:return Ct.BYTE;case Or.S16:return Ct.SHORT;case Or.S32:return Ct.INT;case Or.F16:return Ct.HALF_FLOAT;case Or.F32:return Ct.FLOAT;default:throw new Error("whoops")}}function E5(e){switch(e){case kn.R:return 1;case kn.RG:return 2;case kn.RGB:return 3;case kn.RGBA:return 4;default:return 1}}function S5(e){var t=d0(e),r=Ig(e),n=wp(e),i=y5(t),a=E5(r),s=!!(n&xn.Normalized);return{size:a,type:i,normalized:s}}function x5(e){switch(e){case Jt.U8_R:return Ct.UNSIGNED_BYTE;case Jt.U16_R:return Ct.UNSIGNED_SHORT;case Jt.U32_R:return Ct.UNSIGNED_INT;default:throw new Error("whoops")}}function Ud(e){switch(e){case ac.CLAMP_TO_EDGE:return Ct.CLAMP_TO_EDGE;case ac.REPEAT:return Ct.REPEAT;case ac.MIRRORED_REPEAT:return Ct.MIRRORED_REPEAT;default:throw new Error("whoops")}}function kg(e,t){if(t===bu.LINEAR&&e===ru.BILINEAR)return Ct.LINEAR_MIPMAP_LINEAR;if(t===bu.LINEAR&&e===ru.POINT)return Ct.NEAREST_MIPMAP_LINEAR;if(t===bu.NEAREST&&e===ru.BILINEAR)return Ct.LINEAR_MIPMAP_NEAREST;if(t===bu.NEAREST&&e===ru.POINT)return Ct.NEAREST_MIPMAP_NEAREST;if(t===bu.NO_MIP&&e===ru.BILINEAR)return Ct.LINEAR;if(t===bu.NO_MIP&&e===ru.POINT)return Ct.NEAREST;throw new Error("Unknown texture filter mode")}function Dp(e,t){t===void 0&&(t=0);var r=e;return r.gl_buffer_pages[t/r.pageByteSize|0]}function Lp(e){var t=e;return t.gl_texture}function F_(e){var t=e;return t.gl_sampler}function Zd(e,t){e.name=t,e.__SPECTOR_Metadata={name:t}}function Wx(e,t){for(var r=[];;){var n=t.exec(e);if(!n)break;r.push(n)}return r}function Ih(e){return e.blendMode==Sl.ADD&&e.blendSrcFactor==Ia.ONE&&e.blendDstFactor===Ia.ZERO}function T5(e){switch(e){case wg.OcclusionConservative:return Ct.ANY_SAMPLES_PASSED_CONSERVATIVE;default:throw new Error("whoops")}}function C5(e){if(e===da.TEXTURE_2D)return Ct.TEXTURE_2D;if(e===da.TEXTURE_2D_ARRAY)return Ct.TEXTURE_2D_ARRAY;if(e===da.TEXTURE_CUBE_MAP)return Ct.TEXTURE_CUBE_MAP;if(e===da.TEXTURE_3D)return Ct.TEXTURE_3D;throw new Error("whoops")}function B_(e,t,r,n){return!(e%r!==0||t%n!==0)}var b5=function(e){(0,Rn.ZT)(t,e);function t(r){var n=r.id,i=r.device,a=r.descriptor,s=e.call(this,{id:n,device:i})||this;s.type=Ha.Buffer;var l=a.viewOrSize,p=a.usage,m=a.hint,T=m===void 0?jf.STATIC:m,R=i.uniformBufferMaxPageByteSize,L=i.gl,z=p&To.UNIFORM;z||(Ln(L)?L.bindVertexArray(null):i.OES_vertex_array_object.bindVertexArrayOES(null));var re=Cp(l)?Ng(l,4):Ng(l.byteLength,4);s.gl_buffer_pages=[];var ee;if(z){for(var me=re;me>0;)s.gl_buffer_pages.push(s.createBufferPage(Math.min(me,R),p,T)),me-=R;ee=R}else s.gl_buffer_pages.push(s.createBufferPage(re,p,T)),ee=re;return s.pageByteSize=ee,s.byteSize=re,s.usage=p,s.gl_target=Hx(p),Cp(l)||s.setSubData(0,new Uint8Array(l.buffer)),z||(Ln(L)?L.bindVertexArray(s.device.currentBoundVAO):i.OES_vertex_array_object.bindVertexArrayOES(s.device.currentBoundVAO)),s}return t.prototype.setSubData=function(r,n,i,a){i===void 0&&(i=0),a===void 0&&(a=n.byteLength-i);for(var s=this.device.gl,l=this.pageByteSize,p=r+a,m=r,T=r%l;m<p;){var R=Ln(s)?s.COPY_WRITE_BUFFER:this.gl_target,L=Dp(this,m);if(L.ubo)return;s.bindBuffer(R,L),Ln(s)?s.bufferSubData(R,T,n,i,Math.min(p-m,l)):s.bufferSubData(R,T,n),m+=l,T=0,i+=l,this.device.debugGroupStatisticsBufferUpload()}},t.prototype.destroy=function(){e.prototype.destroy.call(this);for(var r=0;r<this.gl_buffer_pages.length;r++)this.gl_buffer_pages[r].ubo||this.device.gl.deleteBuffer(this.gl_buffer_pages[r]);this.gl_buffer_pages=[]},t.prototype.createBufferPage=function(r,n,i){var a=this.device.gl,s=n&To.UNIFORM;if(!Ln(a)&&s)return{ubo:!0};var l=this.device.ensureResourceExists(a.createBuffer()),p=Hx(n),m=m5(i);return a.bindBuffer(p,l),a.bufferData(p,r,m),l},t}(Xf),R5=function(e){(0,Rn.ZT)(t,e);function t(r){var n,i,a,s,l=r.id,p=r.device,m=r.descriptor,T,R=e.call(this,{id:l,device:p})||this;R.type=Ha.InputLayout;var L=m.vertexBufferDescriptors,z=m.indexBufferFormat,re=m.program;ea(z===Jt.U16_R||z===Jt.U32_R||z===null);var ee=z!==null?x5(z):null,me=z!==null?Rx(z):null,Ie=R.device.gl,He=R.device.ensureResourceExists(Ln(Ie)?Ie.createVertexArray():p.OES_vertex_array_object.createVertexArrayOES());Ln(Ie)?Ie.bindVertexArray(He):p.OES_vertex_array_object.bindVertexArrayOES(He),Ie.bindBuffer(Ie.ARRAY_BUFFER,Dp(R.device.fallbackVertexBuffer));try{for(var Xe=(0,Rn.XA)(m.vertexBufferDescriptors),ot=Xe.next();!ot.done;ot=Xe.next()){var pt=ot.value,dt=pt.stepMode,It=pt.attributes;try{for(var Vt=(a=void 0,(0,Rn.XA)(It)),Kt=Vt.next();!Kt.done;Kt=Vt.next()){var yr=Kt.value,_r=yr.shaderLocation,Hr=yr.format,nn=yr.divisor,Tn=nn===void 0?1:nn,sa=Ln(Ie)?_r:(T=re.attributes[_r])===null||T===void 0?void 0:T.location,Fo=S5(Hr);if(yr.vertexFormat=Fo,!bp(sa)){Vx(Hr);var jo=Fo.size,As=Fo.type,vu=Fo.normalized;Ie.vertexAttribPointer(sa,jo,As,vu,0,0),dt===mA.INSTANCE&&(Ln(Ie)?Ie.vertexAttribDivisor(sa,Tn):p.ANGLE_instanced_arrays.vertexAttribDivisorANGLE(sa,Tn)),Ie.enableVertexAttribArray(sa)}}}catch(ef){a={error:ef}}finally{try{Kt&&!Kt.done&&(s=Vt.return)&&s.call(Vt)}finally{if(a)throw a.error}}}}catch(ef){n={error:ef}}finally{try{ot&&!ot.done&&(i=Xe.return)&&i.call(Xe)}finally{if(n)throw n.error}}return Ln(Ie)?Ie.bindVertexArray(null):p.OES_vertex_array_object.bindVertexArrayOES(null),R.vertexBufferDescriptors=L,R.vao=He,R.indexBufferFormat=z,R.indexBufferType=ee,R.indexBufferCompByteSize=me,R.program=re,R}return t.prototype.destroy=function(){e.prototype.destroy.call(this),this.device.currentBoundVAO===this.vao&&(Ln(this.device.gl)?(this.device.gl.bindVertexArray(null),this.device.gl.deleteVertexArray(this.vao)):(this.device.OES_vertex_array_object.bindVertexArrayOES(null),this.device.OES_vertex_array_object.deleteVertexArrayOES(this.vao)),this.device.currentBoundVAO=null)},t}(Xf),k_=function(e){(0,Rn.ZT)(t,e);function t(r){var n=r.id,i=r.device,a=r.descriptor,s=r.fake,l=e.call(this,{id:n,device:i})||this;l.type=Ha.Texture,a=(0,Rn.pi)({dimension:da.TEXTURE_2D,depthOrArrayLayers:1,mipLevelCount:1},a);var p=l.device.gl,m,T,R=l.clampmipLevelCount(a);if(l.immutable=a.usage===Kc.RENDER_TARGET,l.pixelStore=a.pixelStore,l.format=a.format,l.dimension=a.dimension,l.formatKind=Mx(a.format),l.width=a.width,l.height=a.height,l.depthOrArrayLayers=a.depthOrArrayLayers,l.mipmaps=R>=1,!s){T=l.device.ensureResourceExists(p.createTexture());var L=l.device.translateTextureType(a.format),z=l.device.translateTextureInternalFormat(a.format);if(l.device.setActiveTexture(p.TEXTURE0),l.device.currentTextures[0]=null,l.preprocessImage(),a.dimension===da.TEXTURE_2D){if(m=Ct.TEXTURE_2D,p.bindTexture(m,T),l.immutable)if(Ln(p))p.texStorage2D(m,R,z,a.width,a.height);else{var re=(z===Ct.DEPTH_COMPONENT||l.isNPOT(),0);(l.format===Jt.D32F||l.format===Jt.D24_S8)&&!Ln(p)&&!i.WEBGL_depth_texture||(p.texImage2D(m,re,z,a.width,a.height,0,z,L,null),l.mipmaps&&(l.mipmaps=!1,p.texParameteri(Ct.TEXTURE_2D,Ct.TEXTURE_MIN_FILTER,Ct.LINEAR),p.texParameteri(Ct.TEXTURE_2D,Ct.TEXTURE_WRAP_S,Ct.CLAMP_TO_EDGE),p.texParameteri(Ct.TEXTURE_2D,Ct.TEXTURE_WRAP_T,Ct.CLAMP_TO_EDGE)))}ea(a.depthOrArrayLayers===1)}else if(a.dimension===da.TEXTURE_2D_ARRAY)m=Ct.TEXTURE_2D_ARRAY,p.bindTexture(m,T),l.immutable&&Ln(p)&&p.texStorage3D(m,R,z,a.width,a.height,a.depthOrArrayLayers);else if(a.dimension===da.TEXTURE_3D)m=Ct.TEXTURE_3D,p.bindTexture(m,T),l.immutable&&Ln(p)&&p.texStorage3D(m,R,z,a.width,a.height,a.depthOrArrayLayers);else if(a.dimension===da.TEXTURE_CUBE_MAP)m=Ct.TEXTURE_CUBE_MAP,p.bindTexture(m,T),l.immutable&&Ln(p)&&p.texStorage2D(m,R,z,a.width,a.height),ea(a.depthOrArrayLayers===6);else throw new Error("whoops")}return l.gl_texture=T,l.gl_target=m,l.mipLevelCount=R,l}return t.prototype.setImageData=function(r,n){n===void 0&&(n=0);var i=this.device.gl;Gx(this.format);var a=this.gl_target===Ct.TEXTURE_3D||this.gl_target===Ct.TEXTURE_2D_ARRAY,s=this.gl_target===Ct.TEXTURE_CUBE_MAP,l=A5(r[0]);this.device.setActiveTexture(i.TEXTURE0),this.device.currentTextures[0]=null;var p=r[0],m,T;l?(m=this.width,T=this.height):(m=p.width,T=p.height,this.width=m,this.height=T),i.bindTexture(this.gl_target,this.gl_texture);var R=this.device.translateTextureFormat(this.format),L=this.device.translateTextureType(this.format);this.preprocessImage();for(var z=0;z<this.depthOrArrayLayers;z++){var re=r[z],ee=this.gl_target;s&&(ee=Ct.TEXTURE_CUBE_MAP_POSITIVE_X+z%6),this.immutable?i.texSubImage2D(ee,n,0,0,m,T,R,L,re):Ln(i)?a?i.texImage3D(ee,n,R,m,T,this.depthOrArrayLayers,0,R,L,re):i.texImage2D(ee,n,R,m,T,0,R,L,re):l?i.texImage2D(ee,n,R,m,T,0,R,L,re):i.texImage2D(ee,n,R,R,L,re)}this.mipmaps&&this.generateMipmap(a)},t.prototype.destroy=function(){e.prototype.destroy.call(this),this.device.gl.deleteTexture(Lp(this))},t.prototype.clampmipLevelCount=function(r){if(r.dimension===da.TEXTURE_2D_ARRAY&&r.depthOrArrayLayers>1){var n=d0(r.format);if(n===Or.BC1)for(var i=r.width,a=r.height,s=0;s<r.mipLevelCount;s++){if(i<=2||a<=2)return s-1;i=Math.max(i/2|0,1),a=Math.max(a/2|0,1)}}return r.mipLevelCount},t.prototype.preprocessImage=function(){var r=this.device.gl;this.pixelStore&&(this.pixelStore.unpackFlipY&&r.pixelStorei(Ct.UNPACK_FLIP_Y_WEBGL,!0),this.pixelStore.packAlignment&&r.pixelStorei(Ct.PACK_ALIGNMENT,this.pixelStore.packAlignment),this.pixelStore.unpackAlignment&&r.pixelStorei(Ct.UNPACK_ALIGNMENT,this.pixelStore.unpackAlignment))},t.prototype.generateMipmap=function(r){r===void 0&&(r=!1);var n=this.device.gl;return!Ln(n)&&this.isNPOT()?this:(this.gl_texture&&this.gl_target&&(n.bindTexture(this.gl_target,this.gl_texture),r?(n.texParameteri(this.gl_target,Ct.TEXTURE_BASE_LEVEL,0),n.texParameteri(this.gl_target,Ct.TEXTURE_MAX_LEVEL,Math.log2(this.width)),n.texParameteri(this.gl_target,Ct.TEXTURE_MIN_FILTER,Ct.LINEAR_MIPMAP_LINEAR),n.texParameteri(this.gl_target,Ct.TEXTURE_MAG_FILTER,Ct.LINEAR)):n.texParameteri(Ct.TEXTURE_2D,Ct.TEXTURE_MIN_FILTER,Ct.NEAREST_MIPMAP_LINEAR),n.generateMipmap(this.gl_target),n.bindTexture(this.gl_target,null)),this)},t.prototype.isNPOT=function(){var r=this.device.gl;return Ln(r)?!1:!Og(this.width)||!Og(this.height)},t}(Xf),M5=function(e){(0,Rn.ZT)(t,e);function t(r){var n=r.id,i=r.device,a=r.descriptor,s=e.call(this,{id:n,device:i})||this;s.type=Ha.RenderTarget,s.gl_renderbuffer=null,s.texture=null;var l=s.device.gl,p=a.format,m=a.width,T=a.height,R=a.sampleCount,L=R===void 0?1:R,z=a.texture,re=!1;if((p===Jt.D32F||p===Jt.D24_S8)&&z&&!Ln(l)&&!i.WEBGL_depth_texture&&(z.destroy(),s.texture=null,re=!0),!re&&z)s.texture=z;else{s.gl_renderbuffer=s.device.ensureResourceExists(l.createRenderbuffer()),l.bindRenderbuffer(l.RENDERBUFFER,s.gl_renderbuffer);var ee=s.device.translateTextureInternalFormat(p,!0);Ln(l)&&L>1?l.renderbufferStorageMultisample(Ct.RENDERBUFFER,L,ee,m,T):l.renderbufferStorage(Ct.RENDERBUFFER,ee,m,T)}return s.format=p,s.width=m,s.height=T,s.sampleCount=L,s}return t.prototype.destroy=function(){e.prototype.destroy.call(this),this.gl_renderbuffer!==null&&this.device.gl.deleteRenderbuffer(this.gl_renderbuffer),this.texture&&this.texture.destroy()},t}(Xf),Ic;(function(e){e[e.NeedsCompile=0]="NeedsCompile",e[e.Compiling=1]="Compiling",e[e.NeedsBind=2]="NeedsBind",e[e.ReadyToUse=3]="ReadyToUse"})(Ic||(Ic={}));var w5=function(e){(0,Rn.ZT)(t,e);function t(r,n){var i=r.id,a=r.device,s=r.descriptor,l=e.call(this,{id:i,device:a})||this;l.rawVertexGLSL=n,l.type=Ha.Program,l.uniformSetters={},l.attributes=[];var p=l.device.gl;return l.descriptor=s,l.gl_program=l.device.ensureResourceExists(p.createProgram()),l.gl_shader_vert=null,l.gl_shader_frag=null,l.compileState=Ic.NeedsCompile,l.tryCompileProgram(),l}return t.prototype.destroy=function(){e.prototype.destroy.call(this),this.device.gl.deleteProgram(this.gl_program),this.device.gl.deleteShader(this.gl_shader_vert),this.device.gl.deleteShader(this.gl_shader_frag)},t.prototype.tryCompileProgram=function(){var r,n;ea(this.compileState===Ic.NeedsCompile);var i=this.descriptor,a=this.device.gl;!((r=i.vertex)===null||r===void 0)&&r.glsl&&(!((n=i.fragment)===null||n===void 0)&&n.glsl)&&(this.gl_shader_vert=this.compileShader(i.vertex.glsl,a.VERTEX_SHADER),this.gl_shader_frag=this.compileShader(i.fragment.glsl,a.FRAGMENT_SHADER),a.attachShader(this.gl_program,this.gl_shader_vert),a.attachShader(this.gl_program,this.gl_shader_frag),a.linkProgram(this.gl_program),this.compileState=Ic.Compiling,Ln(a)||(this.readUniformLocationsFromLinkedProgram(),this.readAttributesFromLinkedProgram()))},t.prototype.readAttributesFromLinkedProgram=function(){for(var r,n=this.device.gl,i=n.getProgramParameter(this.gl_program,n.ACTIVE_ATTRIBUTES),a=p5(this.descriptor.vertex.glsl),s=d5(this.rawVertexGLSL,a),l=function(T){var R=n.getActiveAttrib(p.gl_program,T),L=R.name,z=R.type,re=R.size,ee=n.getAttribLocation(p.gl_program,L),me=(r=s.find(function(Ie){return Ie.name===L}))===null||r===void 0?void 0:r.location;ee>=0&&!bp(me)&&(p.attributes[me]={name:L,location:ee,type:z,size:re})},p=this,m=0;m<i;m++)l(m)},t.prototype.readUniformLocationsFromLinkedProgram=function(){for(var r=this.device.gl,n=r.getProgramParameter(this.gl_program,r.ACTIVE_UNIFORMS),i=0;i<n;i++){var a=r.getActiveUniform(this.gl_program,i),s=s5(a.name).name,l=r.getUniformLocation(this.gl_program,s);if(this.uniformSetters[s]=Zx(r,l,a),a&&a.size>1)for(var p=0;p<a.size;p++)l=r.getUniformLocation(this.gl_program,"".concat(s,"[").concat(p,"]")),this.uniformSetters["".concat(s,"[").concat(p,"]")]=Zx(r,l,a)}},t.prototype.compileShader=function(r,n){var i=this.device.gl,a=this.device.ensureResourceExists(i.createShader(n));return i.shaderSource(a,r),i.compileShader(a),a},t.prototype.setUniformsLegacy=function(r){r===void 0&&(r={});var n=this.device.gl;if(!Ln(n)){var i=!1;for(var a in r){i||(n.useProgram(this.gl_program),i=!0);var s=r[a],l=this.uniformSetters[a];if(l){var p=s;p instanceof k_&&(p=p.textureIndex),l(p)}}}return this},t}(Xf),I5=function(e){(0,Rn.ZT)(t,e);function t(r){var n=r.id,i=r.device,a=r.descriptor,s=e.call(this,{id:n,device:i})||this;s.type=Ha.QueryPool;var l=s.device.gl;if(Ln(l)){var p=a.elemCount,m=a.type;s.gl_query=V6(p,function(){return s.device.ensureResourceExists(l.createQuery())}),s.gl_query_type=T5(m)}return s}return t.prototype.queryResultOcclusion=function(r){var n=this.device.gl;if(Ln(n)){var i=this.gl_query[r];return n.getQueryParameter(i,n.QUERY_RESULT_AVAILABLE)?!!n.getQueryParameter(i,n.QUERY_RESULT):null}return null},t.prototype.destroy=function(){e.prototype.destroy.call(this);var r=this.device.gl;if(Ln(r))for(var n=0;n<this.gl_query.length;n++)r.deleteQuery(this.gl_query[n])},t}(Xf),P5=function(e){(0,Rn.ZT)(t,e);function t(r){var n=r.id,i=r.device,a=e.call(this,{id:n,device:i})||this;return a.type=Ha.Readback,a.gl_pbo=null,a.gl_sync=null,a}return t.prototype.clientWaitAsync=function(r,n,i){n===void 0&&(n=0),i===void 0&&(i=10);var a=this.device.gl;return new Promise(function(s,l){function p(){var m=a.clientWaitSync(r,n,0);if(m==a.WAIT_FAILED){l();return}if(m==a.TIMEOUT_EXPIRED){setTimeout(p,F6(i,0,a.MAX_CLIENT_WAIT_TIMEOUT_WEBGL));return}s()}p()})},t.prototype.getBufferSubDataAsync=function(r,n,i,a,s,l){return(0,Rn.mG)(this,void 0,void 0,function(){var p;return(0,Rn.Jh)(this,function(m){switch(m.label){case 0:return p=this.device.gl,Ln(p)?(this.gl_sync=p.fenceSync(p.SYNC_GPU_COMMANDS_COMPLETE,0),p.flush(),[4,this.clientWaitAsync(this.gl_sync,0,10)]):[3,2];case 1:return m.sent(),p.bindBuffer(r,n),p.getBufferSubData(r,i,a,s,l),p.bindBuffer(r,null),[2,a];case 2:return[2]}})})},t.prototype.readTexture=function(r,n,i,a,s,l,p,m){return p===void 0&&(p=0),m===void 0&&(m=l.byteLength||0),(0,Rn.mG)(this,void 0,void 0,function(){var T,R,L,z,re;return(0,Rn.Jh)(this,function(ee){return T=this.device.gl,R=r,L=this.device.translateTextureFormat(R.format),z=this.device.translateTextureType(R.format),re=k6(R.format),Ln(T)?(this.gl_pbo=this.device.ensureResourceExists(T.createBuffer()),T.bindBuffer(T.PIXEL_PACK_BUFFER,this.gl_pbo),T.bufferData(T.PIXEL_PACK_BUFFER,m,T.STREAM_READ),T.bindBuffer(T.PIXEL_PACK_BUFFER,null),T.bindFramebuffer(Ct.READ_FRAMEBUFFER,this.device.readbackFramebuffer),T.framebufferTexture2D(Ct.READ_FRAMEBUFFER,Ct.COLOR_ATTACHMENT0,Ct.TEXTURE_2D,R.gl_texture,0),T.bindBuffer(T.PIXEL_PACK_BUFFER,this.gl_pbo),T.readPixels(n,i,a,s,L,z,p*re),T.bindBuffer(T.PIXEL_PACK_BUFFER,null),[2,this.getBufferSubDataAsync(T.PIXEL_PACK_BUFFER,this.gl_pbo,0,l,p,0)]):[2,this.readTextureSync(r,n,i,a,s,l,p,m)]})})},t.prototype.readTextureSync=function(r,n,i,a,s,l,p,m){m===void 0&&(m=l.byteLength||0);var T=this.device.gl,R=r,L=this.device.translateTextureType(R.format);return T.bindFramebuffer(Ct.FRAMEBUFFER,this.device.readbackFramebuffer),T.framebufferTexture2D(Ct.FRAMEBUFFER,Ct.COLOR_ATTACHMENT0,Ct.TEXTURE_2D,R.gl_texture,0),T.pixelStorei(T.PACK_ALIGNMENT,4),T.readPixels(n,i,a,s,T.RGBA,L,l),l},t.prototype.readBuffer=function(r,n,i,a,s){return(0,Rn.mG)(this,void 0,void 0,function(){var l;return(0,Rn.Jh)(this,function(p){return l=this.device.gl,Ln(l)?[2,this.getBufferSubDataAsync(l.ARRAY_BUFFER,Dp(r,n),n,i,a,s)]:[2,Promise.reject()]})})},t.prototype.destroy=function(){e.prototype.destroy.call(this),Ln(this.device.gl)&&(this.gl_sync!==null&&this.device.gl.deleteSync(this.gl_sync),this.gl_pbo!==null&&this.device.gl.deleteBuffer(this.gl_pbo))},t}(Xf),O5=function(e){(0,Rn.ZT)(t,e);function t(r){var n=r.id,i=r.device,a=r.descriptor,s,l,p=e.call(this,{id:n,device:i})||this;return p.type=Ha.RenderPipeline,p.drawMode=_5((s=a.topology)!==null&&s!==void 0?s:nu.TRIANGLES),p.program=a.program,p.inputLayout=a.inputLayout,p.megaState=(0,Rn.pi)((0,Rn.pi)({},Op(yA)),a.megaStateDescriptor),p.colorAttachmentFormats=a.colorAttachmentFormats.slice(),p.depthStencilAttachmentFormat=a.depthStencilAttachmentFormat,p.sampleCount=(l=a.sampleCount)!==null&&l!==void 0?l:1,p}return t}(Xf),N5=function(e){(0,Rn.ZT)(t,e);function t(r){var n=r.id,i=r.device,a=r.descriptor,s=e.call(this,{id:n,device:i})||this;return s.type=Ha.ComputePipeline,s.descriptor=a,s}return t}(Xf),D5=function(){function e(){this.liveObjects=new Set,this.creationStacks=new Map,this.deletionStacks=new Map}return e.prototype.trackResourceCreated=function(t){this.creationStacks.set(t,new Error().stack),this.liveObjects.add(t)},e.prototype.trackResourceDestroyed=function(t){this.deletionStacks.has(t)&&console.warn("Object double freed:",t,`

Creation stack: `,this.creationStacks.get(t),`

Deletion stack: `,this.deletionStacks.get(t),`

This stack: `,new Error().stack),this.deletionStacks.set(t,new Error().stack),this.liveObjects.delete(t)},e.prototype.checkForLeaks=function(){var t,r;try{for(var n=(0,Rn.XA)(this.liveObjects.values()),i=n.next();!i.done;i=n.next()){var a=i.value;console.warn("Object leaked:",a,"Creation stack:",this.creationStacks.get(a))}}catch(s){t={error:s}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(t)throw t.error}}},e.prototype.setResourceLeakCheck=function(t,r){r?this.liveObjects.add(t):this.liveObjects.delete(t)},e}(),L5=function(e){(0,Rn.ZT)(t,e);function t(r){var n=r.id,i=r.device,a=r.descriptor,s,l,p=e.call(this,{id:n,device:i})||this;p.type=Ha.Sampler;var m=p.device.gl;if(Ln(m)){var T=p.device.ensureResourceExists(m.createSampler());m.samplerParameteri(T,Ct.TEXTURE_WRAP_S,Ud(a.addressModeU)),m.samplerParameteri(T,Ct.TEXTURE_WRAP_T,Ud(a.addressModeV)),m.samplerParameteri(T,Ct.TEXTURE_WRAP_R,Ud((s=a.addressModeW)!==null&&s!==void 0?s:a.addressModeU)),m.samplerParameteri(T,Ct.TEXTURE_MIN_FILTER,kg(a.minFilter,a.mipmapFilter)),m.samplerParameteri(T,Ct.TEXTURE_MAG_FILTER,kg(a.magFilter,bu.NO_MIP)),a.lodMinClamp!==void 0&&m.samplerParameterf(T,Ct.TEXTURE_MIN_LOD,a.lodMinClamp),a.lodMaxClamp!==void 0&&m.samplerParameterf(T,Ct.TEXTURE_MAX_LOD,a.lodMaxClamp),a.compareFunction!==void 0&&(m.samplerParameteri(T,m.TEXTURE_COMPARE_MODE,m.COMPARE_REF_TO_TEXTURE),m.samplerParameteri(T,m.TEXTURE_COMPARE_FUNC,a.compareFunction));var R=(l=a.maxAnisotropy)!==null&&l!==void 0?l:1;R>1&&p.device.EXT_texture_filter_anisotropic!==null&&(ea(a.minFilter===ru.BILINEAR&&a.magFilter===ru.BILINEAR&&a.mipmapFilter===bu.LINEAR),m.samplerParameterf(T,p.device.EXT_texture_filter_anisotropic.TEXTURE_MAX_ANISOTROPY_EXT,R)),p.gl_sampler=T}else p.descriptor=a;return p}return t.prototype.setTextureParameters=function(r,n,i){var a,s=this.device.gl,l=this.descriptor;this.isNPOT(n,i)?s.texParameteri(Ct.TEXTURE_2D,Ct.TEXTURE_MIN_FILTER,Ct.LINEAR):s.texParameteri(r,Ct.TEXTURE_MIN_FILTER,kg(l.minFilter,l.mipmapFilter)),s.texParameteri(Ct.TEXTURE_2D,Ct.TEXTURE_WRAP_S,Ud(l.addressModeU)),s.texParameteri(Ct.TEXTURE_2D,Ct.TEXTURE_WRAP_T,Ud(l.addressModeV)),s.texParameteri(r,Ct.TEXTURE_MAG_FILTER,kg(l.magFilter,bu.NO_MIP));var p=(a=l.maxAnisotropy)!==null&&a!==void 0?a:1;p>1&&this.device.EXT_texture_filter_anisotropic!==null&&(ea(l.minFilter===ru.BILINEAR&&l.magFilter===ru.BILINEAR&&l.mipmapFilter===bu.LINEAR),s.texParameteri(r,this.device.EXT_texture_filter_anisotropic.TEXTURE_MAX_ANISOTROPY_EXT,p))},t.prototype.destroy=function(){e.prototype.destroy.call(this),Ln(this.device.gl)&&this.device.gl.deleteSampler(F_(this))},t.prototype.isNPOT=function(r,n){return!Og(r)||!Og(n)},t}(Xf),F5=function(){function e(){}return e.prototype.dispatchWorkgroups=function(t,r,n){},e.prototype.dispatchWorkgroupsIndirect=function(t,r){},e.prototype.setPipeline=function(t){},e.prototype.setBindings=function(t){},e.prototype.pushDebugGroup=function(t){},e.prototype.popDebugGroup=function(){},e.prototype.insertDebugMarker=function(t){},e}(),jx=65536,B5=function(){function e(t,r){this.shaderDebug=!1,this.OES_vertex_array_object=null,this.ANGLE_instanced_arrays=null,this.OES_texture_float=null,this.OES_draw_buffers_indexed=null,this.WEBGL_draw_buffers=null,this.WEBGL_depth_texture=null,this.WEBGL_color_buffer_float=null,this.EXT_color_buffer_half_float=null,this.WEBGL_compressed_texture_s3tc=null,this.WEBGL_compressed_texture_s3tc_srgb=null,this.EXT_texture_compression_rgtc=null,this.EXT_texture_filter_anisotropic=null,this.KHR_parallel_shader_compile=null,this.EXT_texture_norm16=null,this.EXT_color_buffer_float=null,this.OES_texture_float_linear=null,this.OES_texture_half_float_linear=null,this.scTexture=null,this.scPlatformFramebuffer=null,this.currentActiveTexture=null,this.currentBoundVAO=null,this.currentProgram=null,this.resourceCreationTracker=null,this.resourceUniqueId=0,this.currentColorAttachments=[],this.currentColorAttachmentLevels=[],this.currentColorResolveTos=[],this.currentColorResolveToLevels=[],this.currentDepthStencilResolveTo=null,this.currentSampleCount=-1,this.currentIndexBufferByteOffset=null,this.currentMegaState=Op(yA),this.currentSamplers=[],this.currentTextures=[],this.currentUniformBuffers=[],this.currentUniformBufferByteOffsets=[],this.currentUniformBufferByteSizes=[],this.currentScissorEnabled=!1,this.currentStencilRef=null,this.currentRenderPassDescriptor=null,this.debugGroupStack=[],this.resolveColorAttachmentsChanged=!1,this.resolveDepthStencilAttachmentsChanged=!1,this.explicitBindingLocations=!1,this.separateSamplerTextures=!1,this.viewportOrigin=Rp.LOWER_LEFT,this.clipSpaceNearZ=Mp.NEGATIVE_ONE,this.supportMRT=!1,this.inBlitRenderPass=!1,this.supportedSampleCounts=[],this.occlusionQueriesRecommended=!1,this.computeShadersSupported=!1,this.gl=t,this.contextAttributes=_A(t.getContextAttributes()),Ln(t)?(this.EXT_texture_norm16=t.getExtension("EXT_texture_norm16"),this.EXT_color_buffer_float=t.getExtension("EXT_color_buffer_float")):(this.OES_vertex_array_object=t.getExtension("OES_vertex_array_object"),this.ANGLE_instanced_arrays=t.getExtension("ANGLE_instanced_arrays"),this.OES_texture_float=t.getExtension("OES_texture_float"),this.WEBGL_draw_buffers=t.getExtension("WEBGL_draw_buffers"),this.WEBGL_depth_texture=t.getExtension("WEBGL_depth_texture"),this.WEBGL_color_buffer_float=t.getExtension("WEBGL_color_buffer_float"),this.EXT_color_buffer_half_float=t.getExtension("EXT_color_buffer_half_float"),t.getExtension("EXT_frag_depth"),t.getExtension("OES_element_index_uint"),t.getExtension("OES_standard_derivatives")),this.WEBGL_compressed_texture_s3tc=t.getExtension("WEBGL_compressed_texture_s3tc"),this.WEBGL_compressed_texture_s3tc_srgb=t.getExtension("WEBGL_compressed_texture_s3tc_srgb"),this.EXT_texture_compression_rgtc=t.getExtension("EXT_texture_compression_rgtc"),this.EXT_texture_filter_anisotropic=t.getExtension("EXT_texture_filter_anisotropic"),this.EXT_texture_norm16=t.getExtension("EXT_texture_norm16"),this.OES_texture_float_linear=t.getExtension("OES_texture_float_linear"),this.OES_texture_half_float_linear=t.getExtension("OES_texture_half_float_linear"),this.KHR_parallel_shader_compile=t.getExtension("KHR_parallel_shader_compile"),Ln(t)?(this.platformString="WebGL2",this.glslVersion="#version 300 es"):(this.platformString="WebGL1",this.glslVersion="#version 100"),this.scTexture=new k_({id:this.getNextUniqueId(),device:this,descriptor:{width:0,height:0,depthOrArrayLayers:1,dimension:da.TEXTURE_2D,mipLevelCount:1,usage:Kc.RENDER_TARGET,format:this.contextAttributes.alpha===!1?Jt.U8_RGB_RT:Jt.U8_RGBA_RT},fake:!0}),this.scTexture.formatKind=Ts.Float,this.scTexture.gl_target=null,this.scTexture.gl_texture=null,this.resolveColorReadFramebuffer=this.ensureResourceExists(t.createFramebuffer()),this.resolveColorDrawFramebuffer=this.ensureResourceExists(t.createFramebuffer()),this.resolveDepthStencilReadFramebuffer=this.ensureResourceExists(t.createFramebuffer()),this.resolveDepthStencilDrawFramebuffer=this.ensureResourceExists(t.createFramebuffer()),this.renderPassDrawFramebuffer=this.ensureResourceExists(t.createFramebuffer()),this.readbackFramebuffer=this.ensureResourceExists(t.createFramebuffer()),this.fallbackTexture2D=this.createFallbackTexture(da.TEXTURE_2D,Ts.Float),this.fallbackTexture2DDepth=this.createFallbackTexture(da.TEXTURE_2D,Ts.Depth),this.fallbackVertexBuffer=this.createBuffer({viewOrSize:1,usage:To.VERTEX,hint:jf.STATIC}),Ln(t)&&(this.fallbackTexture2DArray=this.createFallbackTexture(da.TEXTURE_2D_ARRAY,Ts.Float),this.fallbackTexture3D=this.createFallbackTexture(da.TEXTURE_3D,Ts.Float),this.fallbackTextureCube=this.createFallbackTexture(da.TEXTURE_CUBE_MAP,Ts.Float)),this.currentMegaState.depthCompare=Ga.LESS,this.currentMegaState.depthWrite=!1,this.currentMegaState.attachmentsState[0].channelWriteMask=xl.ALL,t.enable(t.DEPTH_TEST),t.enable(t.STENCIL_TEST),this.checkLimits(),r.shaderDebug&&(this.shaderDebug=!0),r.trackResources&&(this.resourceCreationTracker=new D5)}return e.prototype.destroy=function(){this.blitBindings&&this.blitBindings.destroy(),this.blitInputLayout&&this.blitInputLayout.destroy(),this.blitRenderPipeline&&this.blitRenderPipeline.destroy(),this.blitVertexBuffer&&this.blitVertexBuffer.destroy(),this.blitProgram&&this.blitProgram.destroy()},e.prototype.createFallbackTexture=function(t,r){var n=t===da.TEXTURE_CUBE_MAP?6:1,i=r===Ts.Depth?Jt.D32F:Jt.U8_RGBA_NORM,a=this.createTexture({dimension:t,format:i,usage:Kc.SAMPLED,width:1,height:1,depthOrArrayLayers:n,mipLevelCount:1});return r===Ts.Float&&a.setImageData([new Uint8Array(4*n)]),Lp(a)},e.prototype.getNextUniqueId=function(){return++this.resourceUniqueId},e.prototype.checkLimits=function(){var t=this.gl;if(this.maxVertexAttribs=t.getParameter(Ct.MAX_VERTEX_ATTRIBS),Ln(t)){this.uniformBufferMaxPageByteSize=Math.min(t.getParameter(Ct.MAX_UNIFORM_BLOCK_SIZE),jx),this.uniformBufferWordAlignment=t.getParameter(t.UNIFORM_BUFFER_OFFSET_ALIGNMENT)/4;var r=t.getInternalformatParameter(t.RENDERBUFFER,t.DEPTH32F_STENCIL8,t.SAMPLES);this.supportedSampleCounts=r?(0,Rn.ev)([],(0,Rn.CR)(r),!1):[],this.occlusionQueriesRecommended=!0}else this.uniformBufferWordAlignment=64,this.uniformBufferMaxPageByteSize=jx;this.uniformBufferMaxPageWordSize=this.uniformBufferMaxPageByteSize/4,this.supportedSampleCounts.includes(1)||this.supportedSampleCounts.push(1),this.supportedSampleCounts.sort(function(n,i){return n-i})},e.prototype.configureSwapChain=function(t,r,n){var i=this.scTexture;i.width=t,i.height=r,this.scPlatformFramebuffer=z6(n)},e.prototype.getDevice=function(){return this},e.prototype.getCanvas=function(){return this.gl.canvas},e.prototype.getOnscreenTexture=function(){return this.scTexture},e.prototype.beginFrame=function(){},e.prototype.endFrame=function(){},e.prototype.translateTextureInternalFormat=function(t,r){switch(r===void 0&&(r=!1),t){case Jt.ALPHA:return Ct.ALPHA;case Jt.U8_LUMINANCE:case Jt.F16_LUMINANCE:case Jt.F32_LUMINANCE:return Ct.LUMINANCE;case Jt.F16_R:return Ct.R16F;case Jt.F16_RG:return Ct.RG16F;case Jt.F16_RGB:return Ct.RGB16F;case Jt.F16_RGBA:return Ct.RGBA16F;case Jt.F32_R:return Ct.R32F;case Jt.F32_RG:return Ct.RG32F;case Jt.F32_RGB:return Ct.RGB32F;case Jt.F32_RGBA:return Ln(this.gl)?Ct.RGBA32F:r?this.WEBGL_color_buffer_float.RGBA32F_EXT:Ct.RGBA;case Jt.U8_R_NORM:return Ct.R8;case Jt.U8_RG_NORM:return Ct.RG8;case Jt.U8_RGB_NORM:case Jt.U8_RGB_RT:return Ct.RGB8;case Jt.U8_RGB_SRGB:return Ct.SRGB8;case Jt.U8_RGBA_NORM:case Jt.U8_RGBA_RT:return Ln(this.gl)?Ct.RGBA8:r?Ct.RGBA4:Ct.RGBA;case Jt.U8_RGBA:return Ct.RGBA;case Jt.U8_RGBA_SRGB:case Jt.U8_RGBA_RT_SRGB:return Ct.SRGB8_ALPHA8;case Jt.U16_R:return Ct.R16UI;case Jt.U16_R_NORM:return this.EXT_texture_norm16.R16_EXT;case Jt.U16_RG_NORM:return this.EXT_texture_norm16.RG16_EXT;case Jt.U16_RGBA_NORM:return this.EXT_texture_norm16.RGBA16_EXT;case Jt.U16_RGBA_5551:return Ct.RGB5_A1;case Jt.U16_RGB_565:return Ct.RGB565;case Jt.U32_R:return Ct.R32UI;case Jt.S8_RGBA_NORM:return Ct.RGBA8_SNORM;case Jt.S8_RG_NORM:return Ct.RG8_SNORM;case Jt.BC1:return this.WEBGL_compressed_texture_s3tc.COMPRESSED_RGBA_S3TC_DXT1_EXT;case Jt.BC1_SRGB:return this.WEBGL_compressed_texture_s3tc_srgb.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;case Jt.BC2:return this.WEBGL_compressed_texture_s3tc.COMPRESSED_RGBA_S3TC_DXT3_EXT;case Jt.BC2_SRGB:return this.WEBGL_compressed_texture_s3tc_srgb.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;case Jt.BC3:return this.WEBGL_compressed_texture_s3tc.COMPRESSED_RGBA_S3TC_DXT5_EXT;case Jt.BC3_SRGB:return this.WEBGL_compressed_texture_s3tc_srgb.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT;case Jt.BC4_UNORM:return this.EXT_texture_compression_rgtc.COMPRESSED_RED_RGTC1_EXT;case Jt.BC4_SNORM:return this.EXT_texture_compression_rgtc.COMPRESSED_SIGNED_RED_RGTC1_EXT;case Jt.BC5_UNORM:return this.EXT_texture_compression_rgtc.COMPRESSED_RED_GREEN_RGTC2_EXT;case Jt.BC5_SNORM:return this.EXT_texture_compression_rgtc.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT;case Jt.D32F_S8:return Ln(this.gl)?Ct.DEPTH32F_STENCIL8:this.WEBGL_depth_texture?Ct.DEPTH_STENCIL:Ct.DEPTH_COMPONENT16;case Jt.D24_S8:return Ln(this.gl)?Ct.DEPTH24_STENCIL8:this.WEBGL_depth_texture?Ct.DEPTH_STENCIL:Ct.DEPTH_COMPONENT16;case Jt.D32F:return Ln(this.gl)?Ct.DEPTH_COMPONENT32F:this.WEBGL_depth_texture?Ct.DEPTH_COMPONENT:Ct.DEPTH_COMPONENT16;case Jt.D24:return Ln(this.gl)?Ct.DEPTH_COMPONENT24:this.WEBGL_depth_texture?Ct.DEPTH_COMPONENT:Ct.DEPTH_COMPONENT16;default:throw new Error("whoops")}},e.prototype.translateTextureType=function(t){var r=d0(t);switch(r){case Or.U8:return Ct.UNSIGNED_BYTE;case Or.U16:return Ct.UNSIGNED_SHORT;case Or.U32:return Ct.UNSIGNED_INT;case Or.S8:return Ct.BYTE;case Or.F16:return Ct.HALF_FLOAT;case Or.F32:return Ct.FLOAT;case Or.U16_PACKED_5551:return Ct.UNSIGNED_SHORT_5_5_5_1;case Or.D32F:return Ln(this.gl)?Ct.FLOAT:this.WEBGL_depth_texture?Ct.UNSIGNED_INT:Ct.UNSIGNED_BYTE;case Or.D24:return Ln(this.gl)?Ct.UNSIGNED_INT_24_8:this.WEBGL_depth_texture?Ct.UNSIGNED_SHORT:Ct.UNSIGNED_BYTE;case Or.D24S8:return Ln(this.gl)?Ct.UNSIGNED_INT_24_8:this.WEBGL_depth_texture?Ct.UNSIGNED_INT_24_8_WEBGL:Ct.UNSIGNED_BYTE;case Or.D32FS8:return Ct.FLOAT_32_UNSIGNED_INT_24_8_REV;default:throw new Error("whoops")}},e.prototype.translateTextureFormat=function(t){if(Gx(t)||t===Jt.F32_LUMINANCE||t===Jt.U8_LUMINANCE)return this.translateTextureInternalFormat(t);var r=Ln(this.gl)||!Ln(this.gl)&&!!this.WEBGL_depth_texture;switch(t){case Jt.D24_S8:case Jt.D32F_S8:return r?Ct.DEPTH_STENCIL:Ct.RGBA;case Jt.D24:case Jt.D32F:return r?Ct.DEPTH_COMPONENT:Ct.RGBA}var n=Vx(t),i=Ig(t);switch(i){case kn.A:return Ct.ALPHA;case kn.R:return n?Ct.RED_INTEGER:Ct.RED;case kn.RG:return n?Ct.RG_INTEGER:Ct.RG;case kn.RGB:return n?Ct.RGB_INTEGER:Ct.RGB;case kn.RGBA:return Ct.RGBA}},e.prototype.setActiveTexture=function(t){this.currentActiveTexture!==t&&(this.gl.activeTexture(t),this.currentActiveTexture=t)},e.prototype.bindVAO=function(t){this.currentBoundVAO!==t&&(Ln(this.gl)?this.gl.bindVertexArray(t):this.OES_vertex_array_object.bindVertexArrayOES(t),this.currentBoundVAO=t)},e.prototype.programCompiled=function(t){ea(t.compileState!==Ic.NeedsCompile),t.compileState===Ic.Compiling&&(t.compileState=Ic.NeedsBind,this.shaderDebug&&this.checkProgramCompilationForErrors(t))},e.prototype.useProgram=function(t){this.currentProgram!==t&&(this.programCompiled(t),this.gl.useProgram(t.gl_program),this.currentProgram=t)},e.prototype.ensureResourceExists=function(t){if(t===null){var r=this.gl.getError();throw new Error("Created resource is null; GL error encountered: ".concat(r))}else return t},e.prototype.createBuffer=function(t){return new b5({id:this.getNextUniqueId(),device:this,descriptor:t})},e.prototype.createTexture=function(t){return new k_({id:this.getNextUniqueId(),device:this,descriptor:t})},e.prototype.createSampler=function(t){return new L5({id:this.getNextUniqueId(),device:this,descriptor:t})},e.prototype.createRenderTarget=function(t){return new M5({id:this.getNextUniqueId(),device:this,descriptor:t})},e.prototype.createRenderTargetFromTexture=function(t){var r=t,n=r.format,i=r.width,a=r.height,s=r.mipLevelCount;return ea(s===1),this.createRenderTarget({format:n,width:i,height:a,sampleCount:1,texture:t})},e.prototype.createProgram=function(t){var r,n,i,a=(r=t.vertex)===null||r===void 0?void 0:r.glsl;return!((n=t.vertex)===null||n===void 0)&&n.glsl&&(t.vertex.glsl=wh(this.queryVendorInfo(),"vert",t.vertex.glsl)),!((i=t.fragment)===null||i===void 0)&&i.glsl&&(t.fragment.glsl=wh(this.queryVendorInfo(),"frag",t.fragment.glsl)),this.createProgramSimple(t,a)},e.prototype.createProgramSimple=function(t,r){var n=new w5({id:this.getNextUniqueId(),device:this,descriptor:t},r);return n},e.prototype.createBindings=function(t){return new g5({id:this.getNextUniqueId(),device:this,descriptor:t})},e.prototype.createInputLayout=function(t){return new R5({id:this.getNextUniqueId(),device:this,descriptor:t})},e.prototype.createRenderPipeline=function(t){return new O5({id:this.getNextUniqueId(),device:this,descriptor:t})},e.prototype.createComputePass=function(){return new F5},e.prototype.createComputePipeline=function(t){return new N5({id:this.getNextUniqueId(),device:this,descriptor:t})},e.prototype.createReadback=function(){return new P5({id:this.getNextUniqueId(),device:this})},e.prototype.createQueryPool=function(t,r){return new I5({id:this.getNextUniqueId(),device:this,descriptor:{type:t,elemCount:r}})},e.prototype.formatRenderPassDescriptor=function(t){var r,n,i,a,s,l,p=t.colorAttachment;t.depthClearValue=(r=t.depthClearValue)!==null&&r!==void 0?r:"load",t.stencilClearValue=(n=t.stencilClearValue)!==null&&n!==void 0?n:"load";for(var m=0;m<p.length;m++)t.colorAttachmentLevel||(t.colorAttachmentLevel=[]),t.colorAttachmentLevel[m]=(i=t.colorAttachmentLevel[m])!==null&&i!==void 0?i:0,t.colorResolveToLevel||(t.colorResolveToLevel=[]),t.colorResolveToLevel[m]=(a=t.colorResolveToLevel[m])!==null&&a!==void 0?a:0,t.colorClearColor||(t.colorClearColor=[]),t.colorClearColor[m]=(s=t.colorClearColor[m])!==null&&s!==void 0?s:"load",t.colorStore||(t.colorStore=[]),t.colorStore[m]=(l=t.colorStore[m])!==null&&l!==void 0?l:!1},e.prototype.createRenderPass=function(t){ea(this.currentRenderPassDescriptor===null),this.currentRenderPassDescriptor=t,this.formatRenderPassDescriptor(t);var r=t.colorAttachment,n=t.colorAttachmentLevel,i=t.colorClearColor,a=t.colorResolveTo,s=t.colorResolveToLevel,l=t.depthStencilAttachment,p=t.depthClearValue,m=t.stencilClearValue,T=t.depthStencilResolveTo;this.setRenderPassParametersBegin(r.length);for(var R=0;R<r.length;R++)this.setRenderPassParametersColor(R,r[R],n[R],a[R],s[R]);this.setRenderPassParametersDepthStencil(l,T),this.validateCurrentAttachments();for(var R=0;R<r.length;R++){var L=i[R];L!=="load"&&this.setRenderPassParametersClearColor(R,L.r,L.g,L.b,L.a)}return this.setRenderPassParametersClearDepthStencil(p,m),this},e.prototype.submitPass=function(t){ea(this.currentRenderPassDescriptor!==null),this.endPass(),this.currentRenderPassDescriptor=null},e.prototype.copySubTexture2D=function(t,r,n,i,a,s){var l=this.gl,p=t,m=i;if(ea(m.mipLevelCount===1),ea(p.mipLevelCount===1),Ln(l))p===this.scTexture?l.bindFramebuffer(l.DRAW_FRAMEBUFFER,this.scPlatformFramebuffer):(l.bindFramebuffer(l.DRAW_FRAMEBUFFER,this.resolveColorDrawFramebuffer),this.bindFramebufferAttachment(l.DRAW_FRAMEBUFFER,l.COLOR_ATTACHMENT0,p,0)),l.bindFramebuffer(l.READ_FRAMEBUFFER,this.resolveColorReadFramebuffer),this.bindFramebufferAttachment(l.READ_FRAMEBUFFER,l.COLOR_ATTACHMENT0,m,0),l.blitFramebuffer(a,s,a+m.width,s+m.height,r,n,r+m.width,n+m.height,l.COLOR_BUFFER_BIT,l.LINEAR),l.bindFramebuffer(l.READ_FRAMEBUFFER,null),l.bindFramebuffer(l.DRAW_FRAMEBUFFER,null);else if(p===this.scTexture){var T=this.createRenderTargetFromTexture(i);this.submitBlitRenderPass(T,p)}},e.prototype.queryLimits=function(){return this},e.prototype.queryTextureFormatSupported=function(t,r,n){switch(t){case Jt.BC1_SRGB:case Jt.BC2_SRGB:case Jt.BC3_SRGB:return this.WEBGL_compressed_texture_s3tc_srgb!==null?B_(r,n,4,4):!1;case Jt.BC1:case Jt.BC2:case Jt.BC3:return this.WEBGL_compressed_texture_s3tc!==null?B_(r,n,4,4):!1;case Jt.BC4_UNORM:case Jt.BC4_SNORM:case Jt.BC5_UNORM:case Jt.BC5_SNORM:return this.EXT_texture_compression_rgtc!==null?B_(r,n,4,4):!1;case Jt.U16_R_NORM:case Jt.U16_RG_NORM:case Jt.U16_RGBA_NORM:return this.EXT_texture_norm16!==null;case Jt.F32_R:case Jt.F32_RG:case Jt.F32_RGB:case Jt.F32_RGBA:return this.OES_texture_float_linear!==null;case Jt.F16_R:case Jt.F16_RG:case Jt.F16_RGB:case Jt.F16_RGBA:return this.OES_texture_half_float_linear!==null;default:return!0}},e.prototype.queryProgramReady=function(t){var r=this.gl;if(t.compileState===Ic.NeedsCompile)throw new Error("whoops");if(t.compileState===Ic.Compiling){var n=void 0;return this.KHR_parallel_shader_compile!==null?n=r.getProgramParameter(t.gl_program,this.KHR_parallel_shader_compile.COMPLETION_STATUS_KHR):n=!0,n&&this.programCompiled(t),n}return t.compileState===Ic.NeedsBind||t.compileState===Ic.ReadyToUse},e.prototype.queryPlatformAvailable=function(){return this.gl.isContextLost()},e.prototype.queryVendorInfo=function(){return this},e.prototype.queryRenderPass=function(t){return this.currentRenderPassDescriptor},e.prototype.queryRenderTarget=function(t){var r=t;return r},e.prototype.setResourceName=function(t,r){if(t.name=r,t.type===Ha.Buffer)for(var n=t.gl_buffer_pages,i=0;i<n.length;i++)Zd(n[i],"".concat(r," Page ").concat(i));else if(t.type===Ha.Texture)Zd(Lp(t),r);else if(t.type===Ha.Sampler)Zd(F_(t),r);else if(t.type===Ha.RenderTarget){var a=t.gl_renderbuffer;a!==null&&Zd(a,r)}else t.type===Ha.InputLayout&&Zd(t.vao,r)},e.prototype.setResourceLeakCheck=function(t,r){this.resourceCreationTracker!==null&&this.resourceCreationTracker.setResourceLeakCheck(t,r)},e.prototype.checkForLeaks=function(){this.resourceCreationTracker!==null&&this.resourceCreationTracker.checkForLeaks()},e.prototype.pushDebugGroup=function(t){},e.prototype.popDebugGroup=function(){},e.prototype.insertDebugMarker=function(t){},e.prototype.programPatched=function(t,r){ea(this.shaderDebug)},e.prototype.getBufferData=function(t,r,n){n===void 0&&(n=0);var i=this.gl;Ln(i)&&(i.bindBuffer(i.COPY_READ_BUFFER,Dp(t,n*4)),i.getBufferSubData(i.COPY_READ_BUFFER,n*4,r))},e.prototype.debugGroupStatisticsDrawCall=function(t){t===void 0&&(t=1);for(var r=this.debugGroupStack.length-1;r>=0;r--)this.debugGroupStack[r].drawCallCount+=t},e.prototype.debugGroupStatisticsBufferUpload=function(t){t===void 0&&(t=1);for(var r=this.debugGroupStack.length-1;r>=0;r--)this.debugGroupStack[r].bufferUploadCount+=t},e.prototype.debugGroupStatisticsTextureBind=function(t){t===void 0&&(t=1);for(var r=this.debugGroupStack.length-1;r>=0;r--)this.debugGroupStack[r].textureBindCount+=t},e.prototype.debugGroupStatisticsTriangles=function(t){for(var r=this.debugGroupStack.length-1;r>=0;r--)this.debugGroupStack[r].triangleCount+=t},e.prototype.reportShaderError=function(t,r){var n=this.gl,i=n.getShaderParameter(t,n.COMPILE_STATUS);if(!i){console.error(H6(r));var a=n.getExtension("WEBGL_debug_shaders");a&&console.error(a.getTranslatedShaderSource(t)),console.error(n.getShaderInfoLog(t))}return i},e.prototype.checkProgramCompilationForErrors=function(t){var r=this.gl,n=t.gl_program;if(!r.getProgramParameter(n,r.LINK_STATUS)){var i=t.descriptor;if(!this.reportShaderError(t.gl_shader_vert,i.vertex.glsl)||!this.reportShaderError(t.gl_shader_frag,i.fragment.glsl))return;console.error(r.getProgramInfoLog(t.gl_program))}},e.prototype.bindFramebufferAttachment=function(t,r,n,i){var a=this.gl;if(n===null)a.framebufferRenderbuffer(t,r,a.RENDERBUFFER,null);else if(n.type===Ha.RenderTarget)n.gl_renderbuffer!==null?a.framebufferRenderbuffer(t,r,a.RENDERBUFFER,n.gl_renderbuffer):n.texture!==null&&a.framebufferTexture2D(t,r,Ct.TEXTURE_2D,Lp(n.texture),i);else if(n.type===Ha.Texture){var s=Lp(n);n.dimension===da.TEXTURE_2D?a.framebufferTexture2D(t,r,Ct.TEXTURE_2D,s,i):Ln(a)&&(n.dimension,da.TEXTURE_2D_ARRAY)}},e.prototype.bindFramebufferDepthStencilAttachment=function(t,r){var n=this.gl,i=r!==null?wp(r.format):xn.Depth|xn.Stencil,a=!!(i&xn.Depth),s=!!(i&xn.Stencil);if(a&&s){var l=Ln(this.gl)||!Ln(this.gl)&&!!this.WEBGL_depth_texture;l?this.bindFramebufferAttachment(t,n.DEPTH_STENCIL_ATTACHMENT,r,0):this.bindFramebufferAttachment(t,n.DEPTH_ATTACHMENT,r,0)}else a?(this.bindFramebufferAttachment(t,n.DEPTH_ATTACHMENT,r,0),this.bindFramebufferAttachment(t,n.STENCIL_ATTACHMENT,null,0)):s&&(this.bindFramebufferAttachment(t,n.STENCIL_ATTACHMENT,r,0),this.bindFramebufferAttachment(t,n.DEPTH_ATTACHMENT,null,0))},e.prototype.validateCurrentAttachments=function(){for(var t=-1,r=-1,n=-1,i=0;i<this.currentColorAttachments.length;i++){var a=this.currentColorAttachments[i];a!==null&&(t===-1?(t=a.sampleCount,r=a.width,n=a.height):(ea(t===a.sampleCount),ea(r===a.width),ea(n===a.height)))}this.currentDepthStencilAttachment&&(t===-1?t=this.currentDepthStencilAttachment.sampleCount:(ea(t===this.currentDepthStencilAttachment.sampleCount),ea(r===this.currentDepthStencilAttachment.width),ea(n===this.currentDepthStencilAttachment.height))),this.currentSampleCount=t},e.prototype.setRenderPassParametersBegin=function(t){var r=this.gl;if(Ln(r)?r.bindFramebuffer(Ct.DRAW_FRAMEBUFFER,this.renderPassDrawFramebuffer):this.inBlitRenderPass||r.bindFramebuffer(Ct.FRAMEBUFFER,this.renderPassDrawFramebuffer),Ln(r)?r.drawBuffers([Ct.COLOR_ATTACHMENT0,Ct.COLOR_ATTACHMENT1,Ct.COLOR_ATTACHMENT2,Ct.COLOR_ATTACHMENT3]):!this.inBlitRenderPass&&this.WEBGL_draw_buffers&&this.WEBGL_draw_buffers.drawBuffersWEBGL([Ct.COLOR_ATTACHMENT0_WEBGL,Ct.COLOR_ATTACHMENT1_WEBGL,Ct.COLOR_ATTACHMENT2_WEBGL,Ct.COLOR_ATTACHMENT3_WEBGL]),!this.inBlitRenderPass)for(var n=t;n<this.currentColorAttachments.length;n++){var i=Ln(r)?Ct.DRAW_FRAMEBUFFER:Ct.FRAMEBUFFER,a=Ln(r)?Ct.COLOR_ATTACHMENT0:Ct.COLOR_ATTACHMENT0_WEBGL;r.framebufferRenderbuffer(i,a+n,Ct.RENDERBUFFER,null),r.framebufferTexture2D(i,a+n,Ct.TEXTURE_2D,null,0)}this.currentColorAttachments.length=t},e.prototype.setRenderPassParametersColor=function(t,r,n,i,a){var s=this.gl,l=Ln(s);(this.currentColorAttachments[t]!==r||this.currentColorAttachmentLevels[t]!==n)&&(this.currentColorAttachments[t]=r,this.currentColorAttachmentLevels[t]=n,(l||!l&&this.WEBGL_draw_buffers)&&this.bindFramebufferAttachment(l?Ct.DRAW_FRAMEBUFFER:Ct.FRAMEBUFFER,(l?Ct.COLOR_ATTACHMENT0:Ct.COLOR_ATTACHMENT0_WEBGL)+t,r,n),this.resolveColorAttachmentsChanged=!0),(this.currentColorResolveTos[t]!==i||this.currentColorResolveToLevels[t]!==a)&&(this.currentColorResolveTos[t]=i,this.currentColorResolveToLevels[t]=a,i!==null&&(this.resolveColorAttachmentsChanged=!0))},e.prototype.setRenderPassParametersDepthStencil=function(t,r){var n=this.gl;this.currentDepthStencilAttachment!==t&&(this.currentDepthStencilAttachment=t,this.inBlitRenderPass||this.bindFramebufferDepthStencilAttachment(Ln(n)?Ct.DRAW_FRAMEBUFFER:Ct.FRAMEBUFFER,this.currentDepthStencilAttachment),this.resolveDepthStencilAttachmentsChanged=!0),this.currentDepthStencilResolveTo!==r&&(this.currentDepthStencilResolveTo=r,r&&(this.resolveDepthStencilAttachmentsChanged=!0))},e.prototype.setRenderPassParametersClearColor=function(t,r,n,i,a){var s=this.gl;if(this.OES_draw_buffers_indexed!==null){var l=this.currentMegaState.attachmentsState[t];l&&l.channelWriteMask!==xl.ALL&&(this.OES_draw_buffers_indexed.colorMaskiOES(t,!0,!0,!0,!0),l.channelWriteMask=xl.ALL)}else{var l=this.currentMegaState.attachmentsState[0];l&&l.channelWriteMask!==xl.ALL&&(s.colorMask(!0,!0,!0,!0),l.channelWriteMask=xl.ALL)}this.setScissorRectEnabled(!1),Ln(s)?s.clearBufferfv(s.COLOR,t,[r,n,i,a]):(s.clearColor(r,n,i,a),s.clear(s.COLOR_BUFFER_BIT))},e.prototype.setRenderPassParametersClearDepthStencil=function(t,r){t===void 0&&(t="load"),r===void 0&&(r="load");var n=this.gl;t!=="load"&&(ea(!!this.currentDepthStencilAttachment),this.currentMegaState.depthWrite||(n.depthMask(!0),this.currentMegaState.depthWrite=!0),Ln(n)?n.clearBufferfv(n.DEPTH,0,[t]):(n.clearDepth(t),n.clear(n.DEPTH_BUFFER_BIT))),r!=="load"&&(ea(!!this.currentDepthStencilAttachment),this.currentMegaState.stencilWrite||(n.enable(n.STENCIL_TEST),n.stencilMask(255),this.currentMegaState.stencilWrite=!0),Ln(n)?n.clearBufferiv(n.STENCIL,0,[r]):(n.clearStencil(r),n.clear(n.STENCIL_BUFFER_BIT)))},e.prototype.setBindings=function(t){var r,n=this.gl,i=t,a=i.uniformBufferBindings,s=i.samplerBindings,l=i.bindingLayouts;ea(0<l.bindingLayoutTables.length);var p=l.bindingLayoutTables[0];ea(a.length>=p.numUniformBuffers),ea(s.length>=p.numSamplers);for(var m=0;m<a.length;m++){var T=a[m];if(T.size!==0){var R=p.firstUniformBuffer+m,L=T.buffer,z=T.offset||0,re=T.size||L.byteSize;if(L!==this.currentUniformBuffers[R]||z!==this.currentUniformBufferByteOffsets[R]||re!==this.currentUniformBufferByteSizes[R]){var ee=z%L.pageByteSize,me=L.gl_buffer_pages[z/L.pageByteSize|0];ea(ee+re<=L.pageByteSize),Ln(n)&&n.bindBufferRange(n.UNIFORM_BUFFER,R,me,ee,re),this.currentUniformBuffers[R]=L,this.currentUniformBufferByteOffsets[R]=z,this.currentUniformBufferByteSizes[R]=re}}}for(var m=0;m<p.numSamplers;m++){var T=s[m],Ie=p.firstSampler+m,He=T!==null&&T.sampler!==null?F_(T.sampler):null,Xe=T!==null&&T.texture!==null?Lp(T.texture):null;if(this.currentSamplers[Ie]!==He&&(Ln(n)&&n.bindSampler(Ie,He),this.currentSamplers[Ie]=He),this.currentTextures[Ie]!==Xe){if(this.setActiveTexture(n.TEXTURE0+Ie),Xe!==null){var ot=_A(T).texture,pt=ot.gl_target,dt=ot.width,It=ot.height;T.texture.textureIndex=Ie,n.bindTexture(pt,Xe),Ln(n)||(r=T.sampler)===null||r===void 0||r.setTextureParameters(pt,dt,It),this.debugGroupStatisticsTextureBind()}else{var Vt=(0,Rn.pi)((0,Rn.pi)({},T),Fx),Kt=Vt.dimension,yr=Vt.formatKind,pt=C5(Kt);n.bindTexture(pt,this.getFallbackTexture((0,Rn.pi)({gl_target:pt,formatKind:yr},Vt)))}this.currentTextures[Ie]=Xe}}},e.prototype.setViewport=function(t,r,n,i){var a=this.gl;a.viewport(t,r,n,i)},e.prototype.setScissorRect=function(t,r,n,i){var a=this.gl;this.setScissorRectEnabled(!0),a.scissor(t,r,n,i)},e.prototype.applyAttachmentStateIndexed=function(t,r,n){var i=this.gl,a=this.OES_draw_buffers_indexed;r.channelWriteMask!==n.channelWriteMask&&(a.colorMaskiOES(t,!!(n.channelWriteMask&xl.RED),!!(n.channelWriteMask&xl.GREEN),!!(n.channelWriteMask&xl.BLUE),!!(n.channelWriteMask&xl.ALPHA)),r.channelWriteMask=n.channelWriteMask);var s=r.rgbBlendState.blendMode!==n.rgbBlendState.blendMode||r.alphaBlendState.blendMode!==n.alphaBlendState.blendMode,l=r.rgbBlendState.blendSrcFactor!==n.rgbBlendState.blendSrcFactor||r.alphaBlendState.blendSrcFactor!==n.alphaBlendState.blendSrcFactor||r.rgbBlendState.blendDstFactor!==n.rgbBlendState.blendDstFactor||r.alphaBlendState.blendDstFactor!==n.alphaBlendState.blendDstFactor;(l||s)&&(Ih(r.rgbBlendState)&&Ih(r.alphaBlendState)?a.enableiOES(t,i.BLEND):Ih(n.rgbBlendState)&&Ih(n.alphaBlendState)&&a.disableiOES(t,i.BLEND)),s&&(a.blendEquationSeparateiOES(t,n.rgbBlendState.blendMode,n.alphaBlendState.blendMode),r.rgbBlendState.blendMode=n.rgbBlendState.blendMode,r.alphaBlendState.blendMode=n.alphaBlendState.blendMode),l&&(a.blendFuncSeparateiOES(t,n.rgbBlendState.blendSrcFactor,n.rgbBlendState.blendDstFactor,n.alphaBlendState.blendSrcFactor,n.alphaBlendState.blendDstFactor),r.rgbBlendState.blendSrcFactor=n.rgbBlendState.blendSrcFactor,r.alphaBlendState.blendSrcFactor=n.alphaBlendState.blendSrcFactor,r.rgbBlendState.blendDstFactor=n.rgbBlendState.blendDstFactor,r.alphaBlendState.blendDstFactor=n.alphaBlendState.blendDstFactor)},e.prototype.applyAttachmentState=function(t,r){var n=this.gl;t.channelWriteMask!==r.channelWriteMask&&(n.colorMask(!!(r.channelWriteMask&xl.RED),!!(r.channelWriteMask&xl.GREEN),!!(r.channelWriteMask&xl.BLUE),!!(r.channelWriteMask&xl.ALPHA)),t.channelWriteMask=r.channelWriteMask);var i=t.rgbBlendState.blendMode!==r.rgbBlendState.blendMode||t.alphaBlendState.blendMode!==r.alphaBlendState.blendMode,a=t.rgbBlendState.blendSrcFactor!==r.rgbBlendState.blendSrcFactor||t.alphaBlendState.blendSrcFactor!==r.alphaBlendState.blendSrcFactor||t.rgbBlendState.blendDstFactor!==r.rgbBlendState.blendDstFactor||t.alphaBlendState.blendDstFactor!==r.alphaBlendState.blendDstFactor;(a||i)&&(Ih(t.rgbBlendState)&&Ih(t.alphaBlendState)?n.enable(n.BLEND):Ih(r.rgbBlendState)&&Ih(r.alphaBlendState)&&n.disable(n.BLEND)),i&&(n.blendEquationSeparate(r.rgbBlendState.blendMode,r.alphaBlendState.blendMode),t.rgbBlendState.blendMode=r.rgbBlendState.blendMode,t.alphaBlendState.blendMode=r.alphaBlendState.blendMode),a&&(n.blendFuncSeparate(r.rgbBlendState.blendSrcFactor,r.rgbBlendState.blendDstFactor,r.alphaBlendState.blendSrcFactor,r.alphaBlendState.blendDstFactor),t.rgbBlendState.blendSrcFactor=r.rgbBlendState.blendSrcFactor,t.alphaBlendState.blendSrcFactor=r.alphaBlendState.blendSrcFactor,t.rgbBlendState.blendDstFactor=r.rgbBlendState.blendDstFactor,t.alphaBlendState.blendDstFactor=r.alphaBlendState.blendDstFactor)},e.prototype.setMegaState=function(t){var r=this.gl,n=this.currentMegaState;if(this.OES_draw_buffers_indexed!==null)for(var i=0;i<t.attachmentsState.length;i++)this.applyAttachmentStateIndexed(i,n.attachmentsState[0],t.attachmentsState[0]);else ea(t.attachmentsState.length===1),this.applyAttachmentState(n.attachmentsState[0],t.attachmentsState[0]);if(Ix(n.blendConstant,t.blendConstant)||(r.blendColor(t.blendConstant.r,t.blendConstant.g,t.blendConstant.b,t.blendConstant.a),Px(n.blendConstant,t.blendConstant)),n.depthCompare!==t.depthCompare&&(r.depthFunc(t.depthCompare),n.depthCompare=t.depthCompare),!!n.depthWrite!=!!t.depthWrite&&(r.depthMask(t.depthWrite),n.depthWrite=t.depthWrite),!!n.stencilWrite!=!!t.stencilWrite&&(r.stencilMask(t.stencilWrite?255:0),n.stencilWrite=t.stencilWrite),!Fg(n.stencilFront,t.stencilFront)){var a=t.stencilFront,s=a.passOp,l=a.failOp,p=a.depthFailOp,m=a.compare;(n.stencilFront.passOp!==s||n.stencilFront.failOp!==l||n.stencilFront.depthFailOp!==p)&&(r.stencilOpSeparate(r.FRONT,l,p,s),n.stencilFront.passOp=s,n.stencilFront.failOp=l,n.stencilFront.depthFailOp=p),n.stencilFront.compare!==m&&(this.setStencilReference(0),n.stencilFront.compare=m)}if(!Fg(n.stencilBack,t.stencilBack)){var T=t.stencilBack,s=T.passOp,l=T.failOp,p=T.depthFailOp,m=T.compare;(n.stencilBack.passOp!==s||n.stencilBack.failOp!==l||n.stencilBack.depthFailOp!==p)&&(r.stencilOpSeparate(r.BACK,l,p,s),n.stencilBack.passOp=s,n.stencilBack.failOp=l,n.stencilBack.depthFailOp=p),n.stencilBack.compare!==m&&(this.setStencilReference(0),n.stencilBack.compare=m)}n.cullMode!==t.cullMode&&(n.cullMode===wc.NONE?r.enable(r.CULL_FACE):t.cullMode===wc.NONE&&r.disable(r.CULL_FACE),t.cullMode===wc.BACK?r.cullFace(r.BACK):t.cullMode===wc.FRONT?r.cullFace(r.FRONT):t.cullMode===wc.FRONT_AND_BACK&&r.cullFace(r.FRONT_AND_BACK),n.cullMode=t.cullMode),n.frontFace!==t.frontFace&&(r.frontFace(t.frontFace),n.frontFace=t.frontFace),n.polygonOffset!==t.polygonOffset&&(t.polygonOffset?(r.polygonOffset(1,1),r.enable(r.POLYGON_OFFSET_FILL)):r.disable(r.POLYGON_OFFSET_FILL),n.polygonOffset=t.polygonOffset)},e.prototype.validatePipelineFormats=function(t){for(var r=0;r<this.currentColorAttachments.length;r++)var n=this.currentColorAttachments[r];this.currentDepthStencilAttachment&&ea(this.currentDepthStencilAttachment.format===t.depthStencilAttachmentFormat),this.currentSampleCount!==-1&&ea(this.currentSampleCount===t.sampleCount)},e.prototype.setPipeline=function(t){this.currentPipeline=t,this.validatePipelineFormats(this.currentPipeline),this.setMegaState(this.currentPipeline.megaState);var r=this.currentPipeline.program;if(this.useProgram(r),r.compileState===Ic.NeedsBind){var n=this.gl,i=r.gl_program,a=r.descriptor,s=Wx(a.vertex.glsl,/uniform (\w+) {([^]*?)}/g);if(Ln(n))for(var l=0;l<s.length;l++){var p=(0,Rn.CR)(s[l],2),m=p[1],T=n.getUniformBlockIndex(i,m);T!==-1&&T!==4294967295&&n.uniformBlockBinding(i,T,l)}for(var R=Wx(a.vertex.glsl,/^uniform .*sampler\S+ (\w+);\s* \/\/ BINDING=(\d+)$/gm),l=0;l<R.length;l++){var L=(0,Rn.CR)(R[l],3),z=L[1],re=L[2],ee=n.getUniformLocation(i,z);n.uniform1i(ee,parseInt(re))}r.compileState=Ic.ReadyToUse}},e.prototype.setVertexInput=function(t,r,n){var i,a,s;if(t!==null){ea(this.currentPipeline.inputLayout===t);var l=t;this.bindVAO(l.vao);for(var p=this.gl,m=0;m<l.vertexBufferDescriptors.length;m++){var T=l.vertexBufferDescriptors[m],R=T.arrayStride,L=T.attributes;try{for(var z=(i=void 0,(0,Rn.XA)(L)),re=z.next();!re.done;re=z.next()){var ee=re.value,me=ee.shaderLocation,Ie=ee.offset,He=Ln(p)?me:(s=l.program.attributes[me])===null||s===void 0?void 0:s.location;if(!bp(He)){var Xe=r[m];if(Xe===null)continue;var ot=ee.vertexFormat;p.bindBuffer(p.ARRAY_BUFFER,Dp(Xe.buffer));var pt=(Xe.offset||0)+Ie;p.vertexAttribPointer(He,ot.size,ot.type,ot.normalized,R,pt)}}}catch(It){i={error:It}}finally{try{re&&!re.done&&(a=z.return)&&a.call(z)}finally{if(i)throw i.error}}}if(ea(n!==null==(l.indexBufferFormat!==null)),n!==null){var dt=n.buffer;ea(dt.usage===To.INDEX),p.bindBuffer(p.ELEMENT_ARRAY_BUFFER,Dp(dt)),this.currentIndexBufferByteOffset=n.offset||0}else this.currentIndexBufferByteOffset=null}else ea(this.currentPipeline.inputLayout===null),ea(n===null),this.bindVAO(null),this.currentIndexBufferByteOffset=0},e.prototype.setStencilReference=function(t){this.currentStencilRef!==t&&(this.currentStencilRef=t,this.applyStencil())},e.prototype.draw=function(t,r,n,i){var a,s=this.gl,l=this.currentPipeline;if(r){var p=[l.drawMode,n||0,t,r];Ln(s)?s.drawArraysInstanced.apply(s,(0,Rn.ev)([],(0,Rn.CR)(p),!1)):(a=this.ANGLE_instanced_arrays).drawArraysInstancedANGLE.apply(a,(0,Rn.ev)([],(0,Rn.CR)(p),!1))}else s.drawArrays(l.drawMode,n,t);this.debugGroupStatisticsDrawCall(),this.debugGroupStatisticsTriangles(t/3*Math.max(r,1))},e.prototype.drawIndexed=function(t,r,n,i,a){var s,l=this.gl,p=this.currentPipeline,m=_A(p.inputLayout),T=_A(this.currentIndexBufferByteOffset)+n*m.indexBufferCompByteSize;if(r){var R=[p.drawMode,t,m.indexBufferType,T,r];Ln(l)?l.drawElementsInstanced.apply(l,(0,Rn.ev)([],(0,Rn.CR)(R),!1)):(s=this.ANGLE_instanced_arrays).drawElementsInstancedANGLE.apply(s,(0,Rn.ev)([],(0,Rn.CR)(R),!1))}else l.drawElements(p.drawMode,t,m.indexBufferType,T);this.debugGroupStatisticsDrawCall(),this.debugGroupStatisticsTriangles(t/3*Math.max(r,1))},e.prototype.drawIndirect=function(t,r){},e.prototype.drawIndexedIndirect=function(t,r){},e.prototype.beginOcclusionQuery=function(t){var r=this.gl;if(Ln(r)){var n=this.currentRenderPassDescriptor.occlusionQueryPool;r.beginQuery(n.gl_query_type,n.gl_query[t])}},e.prototype.endOcclusionQuery=function(){var t=this.gl;if(Ln(t)){var r=this.currentRenderPassDescriptor.occlusionQueryPool;t.endQuery(r.gl_query_type)}},e.prototype.pipelineQueryReady=function(t){var r=t;return this.queryProgramReady(r.program)},e.prototype.pipelineForceReady=function(t){},e.prototype.endPass=function(){for(var t=this.gl,r=Ln(t),n=!1,i=0;i<this.currentColorAttachments.length;i++){var a=this.currentColorAttachments[i];if(a!==null){var s=this.currentColorResolveTos[i],l=!1;s!==null&&(ea(a.width===s.width&&a.height===s.height),this.setScissorRectEnabled(!1),r&&t.bindFramebuffer(t.READ_FRAMEBUFFER,this.resolveColorReadFramebuffer),this.resolveColorAttachmentsChanged&&r&&this.bindFramebufferAttachment(t.READ_FRAMEBUFFER,t.COLOR_ATTACHMENT0,a,this.currentColorAttachmentLevels[i]),l=!0,s===this.scTexture?t.bindFramebuffer(r?Ct.DRAW_FRAMEBUFFER:Ct.FRAMEBUFFER,this.scPlatformFramebuffer):(t.bindFramebuffer(r?Ct.DRAW_FRAMEBUFFER:Ct.FRAMEBUFFER,this.resolveColorDrawFramebuffer),this.resolveColorAttachmentsChanged&&t.framebufferTexture2D(r?Ct.DRAW_FRAMEBUFFER:Ct.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,s.gl_texture,this.currentColorResolveToLevels[i])),r?(t.blitFramebuffer(0,0,a.width,a.height,0,0,s.width,s.height,t.COLOR_BUFFER_BIT,t.LINEAR),t.bindFramebuffer(t.DRAW_FRAMEBUFFER,null)):this.submitBlitRenderPass(a,s),n=!0),this.currentRenderPassDescriptor.colorStore[i]||l||(t.bindFramebuffer(r?Ct.READ_FRAMEBUFFER:Ct.FRAMEBUFFER,this.resolveColorReadFramebuffer),this.resolveColorAttachmentsChanged&&this.bindFramebufferAttachment(r?Ct.READ_FRAMEBUFFER:Ct.FRAMEBUFFER,t.COLOR_ATTACHMENT0,a,this.currentColorAttachmentLevels[i])),t.bindFramebuffer(r?Ct.READ_FRAMEBUFFER:Ct.FRAMEBUFFER,null)}}this.resolveColorAttachmentsChanged=!1;var p=this.currentDepthStencilAttachment;if(p){var m=this.currentDepthStencilResolveTo,l=!1;m&&(ea(p.width===m.width&&p.height===m.height),this.setScissorRectEnabled(!1),t.bindFramebuffer(r?Ct.READ_FRAMEBUFFER:Ct.FRAMEBUFFER,this.resolveDepthStencilReadFramebuffer),t.bindFramebuffer(r?Ct.DRAW_FRAMEBUFFER:Ct.FRAMEBUFFER,this.resolveDepthStencilDrawFramebuffer),this.resolveDepthStencilAttachmentsChanged&&(this.bindFramebufferDepthStencilAttachment(r?Ct.READ_FRAMEBUFFER:Ct.FRAMEBUFFER,p),this.bindFramebufferDepthStencilAttachment(r?Ct.DRAW_FRAMEBUFFER:Ct.FRAMEBUFFER,m)),l=!0,r&&t.blitFramebuffer(0,0,p.width,p.height,0,0,m.width,m.height,t.DEPTH_BUFFER_BIT,t.NEAREST),t.bindFramebuffer(r?Ct.DRAW_FRAMEBUFFER:Ct.FRAMEBUFFER,null),n=!0),this.currentRenderPassDescriptor.depthStencilStore||(l||(t.bindFramebuffer(r?Ct.READ_FRAMEBUFFER:Ct.FRAMEBUFFER,this.resolveDepthStencilReadFramebuffer),this.resolveDepthStencilAttachmentsChanged&&this.bindFramebufferDepthStencilAttachment(r?Ct.READ_FRAMEBUFFER:Ct.FRAMEBUFFER,p),l=!0),r&&t.invalidateFramebuffer(t.READ_FRAMEBUFFER,[t.DEPTH_STENCIL_ATTACHMENT])),l&&t.bindFramebuffer(r?Ct.READ_FRAMEBUFFER:Ct.FRAMEBUFFER,null),this.resolveDepthStencilAttachmentsChanged=!1}n||t.bindFramebuffer(r?Ct.DRAW_FRAMEBUFFER:Ct.FRAMEBUFFER,null)},e.prototype.setScissorRectEnabled=function(t){if(this.currentScissorEnabled!==t){var r=this.gl;t?r.enable(r.SCISSOR_TEST):r.disable(r.SCISSOR_TEST),this.currentScissorEnabled=t}},e.prototype.applyStencil=function(){bp(this.currentStencilRef)||(this.gl.stencilFuncSeparate(Ct.FRONT,this.currentMegaState.stencilFront.compare,this.currentStencilRef,255),this.gl.stencilFuncSeparate(Ct.BACK,this.currentMegaState.stencilBack.compare,this.currentStencilRef,255))},e.prototype.getFallbackTexture=function(t){var r=t.gl_target,n=t.formatKind;if(r===Ct.TEXTURE_2D)return n===Ts.Depth?this.fallbackTexture2DDepth:this.fallbackTexture2D;if(r===Ct.TEXTURE_2D_ARRAY)return this.fallbackTexture2DArray;if(r===Ct.TEXTURE_3D)return this.fallbackTexture3D;if(r===Ct.TEXTURE_CUBE_MAP)return this.fallbackTextureCube;throw new Error("whoops")},e.prototype.submitBlitRenderPass=function(t,r){this.blitRenderPipeline||(this.blitProgram=this.createProgram({vertex:{glsl:`layout(location = 0) in vec2 a_Position;
out vec2 v_TexCoord;
void main() {
  v_TexCoord = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);

  #ifdef VIEWPORT_ORIGIN_TL
    v_TexCoord.y = 1.0 - v_TexCoord.y;
  #endif
}`},fragment:{glsl:`uniform sampler2D u_Texture;
in vec2 v_TexCoord;
out vec4 outputColor;
void main() {
  outputColor = texture(SAMPLER_2D(u_Texture), v_TexCoord);
}`}}),this.blitVertexBuffer=this.createBuffer({usage:To.VERTEX|To.COPY_DST,viewOrSize:new Float32Array([-4,-4,4,-4,0,4])}),this.blitInputLayout=this.createInputLayout({vertexBufferDescriptors:[{arrayStride:4*2,stepMode:mA.VERTEX,attributes:[{format:Jt.F32_RG,offset:4*0,shaderLocation:0}]}],indexBufferFormat:null,program:this.blitProgram}),this.blitRenderPipeline=this.createRenderPipeline({topology:nu.TRIANGLES,sampleCount:1,program:this.blitProgram,colorAttachmentFormats:[Jt.U8_RGBA_RT],depthStencilAttachmentFormat:null,inputLayout:this.blitInputLayout,megaStateDescriptor:Op(yA)}),this.blitBindings=this.createBindings({samplerBindings:[{sampler:null,texture:t.texture}],uniformBufferBindings:[]}),this.blitProgram.setUniformsLegacy({u_Texture:t}));var n=this.currentRenderPassDescriptor;this.currentRenderPassDescriptor=null,this.inBlitRenderPass=!0;var i=this.createRenderPass({colorAttachment:[t],colorResolveTo:[r],colorClearColor:[U6]}),a=this.getCanvas(),s=a.width,l=a.height;i.setPipeline(this.blitRenderPipeline),i.setBindings(this.blitBindings),i.setVertexInput(this.blitInputLayout,[{buffer:this.blitVertexBuffer}],null),i.setViewport(0,0,s,l),this.gl.disable(this.gl.BLEND),i.draw(3,0),this.gl.enable(this.gl.BLEND),this.currentRenderPassDescriptor=n,this.inBlitRenderPass=!1},e}(),k5=function(){function e(t){this.pluginOptions=t}return e.prototype.createSwapChain=function(t){return(0,Rn.mG)(this,void 0,void 0,function(){var r,n,i,a,s,l,p,m,T,R,L;return(0,Rn.Jh)(this,function(z){return r=this.pluginOptions,n=r.targets,i=r.xrCompatible,a=r.antialias,s=a===void 0?!1:a,l=r.preserveDrawingBuffer,p=l===void 0?!1:l,m=r.premultipliedAlpha,T=m===void 0?!0:m,R={antialias:s,preserveDrawingBuffer:p,stencil:!0,premultipliedAlpha:T,xrCompatible:i},this.handleContextEvents(t),n.includes("webgl2")&&(L=t.getContext("webgl2",R)||t.getContext("experimental-webgl2",R)),!L&&n.includes("webgl1")&&(L=t.getContext("webgl",R)||t.getContext("experimental-webgl",R)),[2,new B5(L,{shaderDebug:!0,trackResources:!0})]})})},e.prototype.handleContextEvents=function(t){var r=this.pluginOptions,n=r.onContextLost,i=r.onContextRestored,a=r.onContextCreationError;a&&t.addEventListener("webglcontextcreationerror",a,!1),n&&t.addEventListener("webglcontextlost",n,!1),i&&t.addEventListener("webglcontextrestored",i,!1)},e}();let Pc;const Xx=typeof TextDecoder!="undefined"?new TextDecoder("utf-8",{ignoreBOM:!0,fatal:!0}):{decode:()=>{throw Error("TextDecoder not available")}};typeof TextDecoder!="undefined"&&Xx.decode();let zd=null;function Ug(){return(zd===null||zd.byteLength===0)&&(zd=new Uint8Array(Pc.memory.buffer)),zd}function U_(e,t){return e=e>>>0,Xx.decode(Ug().subarray(e,e+t))}const W0=new Array(128).fill(void 0);W0.push(void 0,null,!0,!1);let Gd=W0.length;function U5(e){Gd===W0.length&&W0.push(W0.length+1);const t=Gd;return Gd=W0[t],W0[t]=e,t}function Zg(e){return W0[e]}function Z5(e){e<132||(W0[e]=Gd,Gd=e)}function z5(e){const t=Zg(e);return Z5(e),t}let zg=0;const Gg=typeof TextEncoder!="undefined"?new TextEncoder("utf-8"):{encode:()=>{throw Error("TextEncoder not available")}},G5=typeof Gg.encodeInto=="function"?function(e,t){return Gg.encodeInto(e,t)}:function(e,t){const r=Gg.encode(e);return t.set(r),{read:e.length,written:r.length}};function Yx(e,t,r){if(r===void 0){const l=Gg.encode(e),p=t(l.length,1)>>>0;return Ug().subarray(p,p+l.length).set(l),zg=l.length,p}let n=e.length,i=t(n,1)>>>0;const a=Ug();let s=0;for(;s<n;s++){const l=e.charCodeAt(s);if(l>127)break;a[i+s]=l}if(s!==n){s!==0&&(e=e.slice(s)),i=r(i,n,n=s+e.length*3,1)>>>0;const l=Ug().subarray(i+s,i+n),p=G5(e,l);s+=p.written}return zg=s,i}let Vd=null;function $x(){return(Vd===null||Vd.byteLength===0)&&(Vd=new Int32Array(Pc.memory.buffer)),Vd}function V5(e,t,r){let n,i;try{const l=Pc.__wbindgen_add_to_stack_pointer(-16),p=Yx(e,Pc.__wbindgen_malloc,Pc.__wbindgen_realloc),m=zg,T=Yx(t,Pc.__wbindgen_malloc,Pc.__wbindgen_realloc),R=zg;Pc.glsl_compile(l,p,m,T,R,r);var a=$x()[l/4+0],s=$x()[l/4+1];return n=a,i=s,U_(a,s)}finally{Pc.__wbindgen_add_to_stack_pointer(16),Pc.__wbindgen_free(n,i,1)}}function H5(e,t){return H_(this,null,function*(){if(typeof Response=="function"&&e instanceof Response){if(typeof WebAssembly.instantiateStreaming=="function")try{return yield WebAssembly.instantiateStreaming(e,t)}catch(n){if(e.headers.get("Content-Type")!="application/wasm")console.warn("`WebAssembly.instantiateStreaming` failed because your server does not serve wasm with `application/wasm` MIME type. Falling back to `WebAssembly.instantiate` which is slower. Original error:\n",n);else throw n}const r=yield e.arrayBuffer();return yield WebAssembly.instantiate(r,t)}else{const r=yield WebAssembly.instantiate(e,t);return r instanceof WebAssembly.Instance?{instance:r,module:e}:r}})}function W5(){const e={};return e.wbg={},e.wbg.__wbindgen_string_new=function(t,r){const n=U_(t,r);return U5(n)},e.wbg.__wbindgen_object_drop_ref=function(t){z5(t)},e.wbg.__wbg_log_1d3ae0273d8f4f8a=function(t){console.log(Zg(t))},e.wbg.__wbg_log_576ca876af0d4a77=function(t,r){console.log(Zg(t),Zg(r))},e.wbg.__wbindgen_throw=function(t,r){throw new Error(U_(t,r))},e}function j5(e,t){return Pc=e.exports,Qx.__wbindgen_wasm_module=t,Vd=null,zd=null,Pc}function Qx(e){return H_(this,null,function*(){if(Pc!==void 0)return Pc;const t=W5();(typeof e=="string"||typeof Request=="function"&&e instanceof Request||typeof URL=="function"&&e instanceof URL)&&(e=fetch(e));const{instance:r,module:n}=yield H5(yield e,t);return j5(r,n)})}var sc;(function(e){e[e.COPY_SRC=1]="COPY_SRC",e[e.COPY_DST=2]="COPY_DST",e[e.TEXTURE_BINDING=4]="TEXTURE_BINDING",e[e.STORAGE_BINDING=8]="STORAGE_BINDING",e[e.STORAGE=8]="STORAGE",e[e.RENDER_ATTACHMENT=16]="RENDER_ATTACHMENT"})(sc||(sc={}));var Z_;(function(e){e[e.READ=1]="READ",e[e.WRITE=2]="WRITE"})(Z_||(Z_={}));function X5(e){var t=0;return e&Kc.SAMPLED&&(t|=sc.TEXTURE_BINDING|sc.COPY_DST),e&Kc.RENDER_TARGET&&(t|=sc.RENDER_ATTACHMENT|sc.TEXTURE_BINDING|sc.COPY_SRC|sc.COPY_DST),t}function z_(e){if(e===Jt.U8_R_NORM)return"r8unorm";if(e===Jt.U8_RG_NORM)return"rg8unorm";if(e===Jt.U8_RGBA_RT)return"bgra8unorm";if(e===Jt.U8_RGBA_RT_SRGB)return"bgra8unorm-srgb";if(e===Jt.U8_RGBA_NORM)return"rgba8unorm";if(e===Jt.U8_RGBA_SRGB)return"rgba8unorm-srgb";if(e===Jt.S8_R_NORM)return"r8snorm";if(e===Jt.S8_RG_NORM)return"rg8snorm";if(e===Jt.S8_RGBA_NORM)return"rgba8snorm";if(e===Jt.U32_R)return"r32uint";if(e===Jt.F16_RGBA)return"rgba16float";if(e===Jt.F32_RGBA)return"rgba32float";if(e===Jt.D24)return"depth24plus";if(e===Jt.D24_S8)return"depth24plus-stencil8";if(e===Jt.D32F)return"depth32float";if(e===Jt.D32F_S8)return"depth32float-stencil8";if(e===Jt.BC1)return"bc1-rgba-unorm";if(e===Jt.BC1_SRGB)return"bc1-rgba-unorm-srgb";if(e===Jt.BC2)return"bc2-rgba-unorm";if(e===Jt.BC2_SRGB)return"bc2-rgba-unorm-srgb";if(e===Jt.BC3)return"bc3-rgba-unorm";if(e===Jt.BC3_SRGB)return"bc3-rgba-unorm-srgb";if(e===Jt.BC4_SNORM)return"bc4-r-snorm";if(e===Jt.BC4_UNORM)return"bc4-r-unorm";if(e===Jt.BC5_SNORM)return"bc5-rg-snorm";if(e===Jt.BC5_UNORM)return"bc5-rg-unorm";throw"whoops"}function Y5(e){if(e===da.TEXTURE_2D)return"2d";if(e===da.TEXTURE_CUBE_MAP)return"2d";if(e===da.TEXTURE_2D_ARRAY)return"2d";if(e===da.TEXTURE_3D)return"3d";throw new Error("whoops")}function $5(e){if(e===da.TEXTURE_2D)return"2d";if(e===da.TEXTURE_CUBE_MAP)return"cube";if(e===da.TEXTURE_2D_ARRAY)return"2d-array";if(e===da.TEXTURE_3D)return"3d";throw new Error("whoops")}function Q5(e){var t=0;return e&To.INDEX&&(t|=GPUBufferUsage.INDEX),e&To.VERTEX&&(t|=GPUBufferUsage.VERTEX),e&To.UNIFORM&&(t|=GPUBufferUsage.UNIFORM),e&To.STORAGE&&(t|=GPUBufferUsage.STORAGE),e&To.COPY_SRC&&(t|=GPUBufferUsage.COPY_SRC),t|=GPUBufferUsage.COPY_DST,t}function G_(e){if(e===ac.CLAMP_TO_EDGE)return"clamp-to-edge";if(e===ac.REPEAT)return"repeat";if(e===ac.MIRRORED_REPEAT)return"mirror-repeat";throw new Error("whoops")}function qx(e){if(e===ru.BILINEAR)return"linear";if(e===ru.POINT)return"nearest";throw new Error("whoops")}function q5(e){if(e===bu.LINEAR)return"linear";if(e===bu.NEAREST)return"nearest";if(e===bu.NO_MIP)return"nearest";throw new Error("whoops")}function Fp(e){var t=e;return t.gpuBuffer}function K5(e){var t=e;return t.gpuSampler}function J5(e){var t=e;return t.querySet}function eD(e){if(e===wg.OcclusionConservative)return"occlusion";throw new Error("whoops")}function tD(e){switch(e){case nu.TRIANGLES:return"triangle-list";case nu.POINTS:return"point-list";case nu.TRIANGLE_STRIP:return"triangle-strip";case nu.LINES:return"line-list";case nu.LINE_STRIP:return"line-strip";default:throw new Error("Unknown primitive topology mode")}}function rD(e){if(e===wc.NONE)return"none";if(e===wc.FRONT)return"front";if(e===wc.BACK)return"back";throw new Error("whoops")}function nD(e){if(e===Bd.CCW)return"ccw";if(e===Bd.CW)return"cw";throw new Error("whoops")}function iD(e,t){return{topology:tD(e),cullMode:rD(t.cullMode),frontFace:nD(t.frontFace)}}function Kx(e){if(e===Ia.ZERO)return"zero";if(e===Ia.ONE)return"one";if(e===Ia.SRC)return"src";if(e===Ia.ONE_MINUS_SRC)return"one-minus-src";if(e===Ia.DST)return"dst";if(e===Ia.ONE_MINUS_DST)return"one-minus-dst";if(e===Ia.SRC_ALPHA)return"src-alpha";if(e===Ia.ONE_MINUS_SRC_ALPHA)return"one-minus-src-alpha";if(e===Ia.DST_ALPHA)return"dst-alpha";if(e===Ia.ONE_MINUS_DST_ALPHA)return"one-minus-dst-alpha";if(e===Ia.CONST)return"constant";if(e===Ia.ONE_MINUS_CONSTANT)return"one-minus-constant";if(e===Ia.SRC_ALPHA_SATURATE)return"src-alpha-saturated";throw new Error("whoops")}function aD(e){if(e===Sl.ADD)return"add";if(e===Sl.SUBSTRACT)return"subtract";if(e===Sl.REVERSE_SUBSTRACT)return"reverse-subtract";if(e===Sl.MIN)return"min";if(e===Sl.MAX)return"max";throw new Error("whoops")}function Jx(e){return{operation:aD(e.blendMode),srcFactor:Kx(e.blendSrcFactor),dstFactor:Kx(e.blendDstFactor)}}function eT(e){return e.blendMode===Sl.ADD&&e.blendSrcFactor===Ia.ONE&&e.blendDstFactor===Ia.ZERO}function oD(e){if(!(eT(e.rgbBlendState)&&eT(e.alphaBlendState)))return{color:Jx(e.rgbBlendState),alpha:Jx(e.alphaBlendState)}}function sD(e,t){return{format:z_(t),blend:oD(e),writeMask:e.channelWriteMask}}function uD(e,t){return t.attachmentsState.map(function(r,n){return sD(r,e[n])})}function Vg(e){if(e===Ga.NEVER)return"never";if(e===Ga.LESS)return"less";if(e===Ga.EQUAL)return"equal";if(e===Ga.LEQUAL)return"less-equal";if(e===Ga.GREATER)return"greater";if(e===Ga.NOTEQUAL)return"not-equal";if(e===Ga.GEQUAL)return"greater-equal";if(e===Ga.ALWAYS)return"always";throw new Error("whoops")}function Bp(e){if(e===zl.KEEP)return"keep";if(e===zl.REPLACE)return"replace";if(e===zl.ZERO)return"zero";if(e===zl.DECREMENT_CLAMP)return"decrement-clamp";if(e===zl.DECREMENT_WRAP)return"decrement-wrap";if(e===zl.INCREMENT_CLAMP)return"increment-clamp";if(e===zl.INCREMENT_WRAP)return"increment-wrap";if(e===zl.INVERT)return"invert";throw new Error("whoops")}function lD(e,t){if(!bp(e))return{format:z_(e),depthWriteEnabled:!!t.depthWrite,depthCompare:Vg(t.depthCompare),depthBias:t.polygonOffset?1:0,depthBiasSlopeScale:t.polygonOffset?1:0,stencilFront:{compare:Vg(t.stencilFront.compare),passOp:Bp(t.stencilFront.passOp),failOp:Bp(t.stencilFront.failOp),depthFailOp:Bp(t.stencilFront.depthFailOp)},stencilBack:{compare:Vg(t.stencilBack.compare),passOp:Bp(t.stencilBack.passOp),failOp:Bp(t.stencilBack.failOp),depthFailOp:Bp(t.stencilBack.depthFailOp)},stencilReadMask:1,stencilWriteMask:1}}function cD(e){if(e!==null){if(e===Jt.U16_R)return"uint16";if(e===Jt.U32_R)return"uint32";throw new Error("whoops")}}function fD(e){if(e===mA.VERTEX)return"vertex";if(e===mA.INSTANCE)return"instance";throw new Error("whoops")}function hD(e){if(e===Jt.U8_R)return"uint8x2";if(e===Jt.U8_RG)return"uint8x2";if(e===Jt.U8_RGB)return"uint8x4";if(e===Jt.U8_RGBA)return"uint8x4";if(e===Jt.U8_RG_NORM)return"unorm8x2";if(e===Jt.U8_RGBA_NORM)return"unorm8x4";if(e===Jt.S8_RGB_NORM)return"snorm8x4";if(e===Jt.S8_RGBA_NORM)return"snorm8x4";if(e===Jt.U16_RG_NORM)return"unorm16x2";if(e===Jt.U16_RGBA_NORM)return"unorm16x4";if(e===Jt.S16_RG_NORM)return"snorm16x2";if(e===Jt.S16_RGBA_NORM)return"snorm16x4";if(e===Jt.S16_RG)return"uint16x2";if(e===Jt.F16_RG)return"float16x2";if(e===Jt.F16_RGBA)return"float16x4";if(e===Jt.F32_R)return"float32";if(e===Jt.F32_RG)return"float32x2";if(e===Jt.F32_RGB)return"float32x3";if(e===Jt.F32_RGBA)return"float32x4";throw"whoops"}function AD(e){var t=d0(e);switch(t){case Or.BC1:case Or.BC2:case Or.BC3:case Or.BC4_SNORM:case Or.BC4_UNORM:case Or.BC5_SNORM:case Or.BC5_UNORM:return!0;default:return!1}}function pD(e){var t=d0(e);switch(t){case Or.BC1:case Or.BC2:case Or.BC3:case Or.BC4_SNORM:case Or.BC4_UNORM:case Or.BC5_SNORM:case Or.BC5_UNORM:return 4;default:return 1}}function tT(e,t,r,n){switch(r===void 0&&(r=!1),e){case Jt.S8_R:case Jt.S8_R_NORM:case Jt.S8_RG_NORM:case Jt.S8_RGB_NORM:case Jt.S8_RGBA_NORM:{var i=t instanceof ArrayBuffer?new Int8Array(t):new Int8Array(t);return n&&i.set(new Int8Array(n)),i}case Jt.U8_R:case Jt.U8_R_NORM:case Jt.U8_RG:case Jt.U8_RG_NORM:case Jt.U8_RGB:case Jt.U8_RGB_NORM:case Jt.U8_RGB_SRGB:case Jt.U8_RGBA:case Jt.U8_RGBA_NORM:case Jt.U8_RGBA_SRGB:{var a=t instanceof ArrayBuffer?new Uint8Array(t):new Uint8Array(t);return n&&a.set(new Uint8Array(n)),a}case Jt.S16_R:case Jt.S16_RG:case Jt.S16_RG_NORM:case Jt.S16_RGB_NORM:case Jt.S16_RGBA:case Jt.S16_RGBA_NORM:{var s=t instanceof ArrayBuffer?new Int16Array(t):new Int16Array(r?t/2:t);return n&&s.set(new Int16Array(n)),s}case Jt.U16_R:case Jt.U16_RGB:case Jt.U16_RGBA_5551:case Jt.U16_RGBA_NORM:case Jt.U16_RG_NORM:case Jt.U16_R_NORM:{var l=t instanceof ArrayBuffer?new Uint16Array(t):new Uint16Array(r?t/2:t);return n&&l.set(new Uint16Array(n)),l}case Jt.S32_R:{var p=t instanceof ArrayBuffer?new Int32Array(t):new Int32Array(r?t/4:t);return n&&p.set(new Int32Array(n)),p}case Jt.U32_R:case Jt.U32_RG:{var m=t instanceof ArrayBuffer?new Uint32Array(t):new Uint32Array(r?t/4:t);return n&&m.set(new Uint32Array(n)),m}case Jt.F32_R:case Jt.F32_RG:case Jt.F32_RGB:case Jt.F32_RGBA:{var T=t instanceof ArrayBuffer?new Float32Array(t):new Float32Array(r?t/4:t);return n&&T.set(new Float32Array(n)),T}}var R=t instanceof ArrayBuffer?new Uint8Array(t):new Uint8Array(t);return n&&R.set(new Uint8Array(n)),R}function dD(e){var t=(e&32768)>>15,r=(e&31744)>>10,n=e&1023;return r===0?(t?-1:1)*Math.pow(2,-14)*(n/Math.pow(2,10)):r==31?n?NaN:(t?-1:1)*(1/0):(t?-1:1)*Math.pow(2,r-15)*(1+n/Math.pow(2,10))}var v0=function(e){(0,Rn.ZT)(t,e);function t(r){var n=r.id,i=r.device,a=e.call(this)||this;return a.id=n,a.device=i,a}return t.prototype.destroy=function(){},t}(Tx),vD=function(e){(0,Rn.ZT)(t,e);function t(r){var n=r.id,i=r.device,a=r.descriptor,s=e.call(this,{id:n,device:i})||this;s.type=Ha.Bindings;var l=a.pipeline;ea(!!l);var p=a.uniformBufferBindings,m=a.storageBufferBindings,T=a.samplerBindings;s.numUniformBuffers=(p==null?void 0:p.length)||0;var R=[[],[]],L=0;if(m&&m.length)for(var z=0;z<m.length;z++){var re=a.storageBufferBindings[z],ee=re.binding,me=re.size,Ie=re.offset,He=re.buffer,Xe={buffer:Fp(He),offset:Ie!=null?Ie:0,size:me};R[0].push({binding:ee!=null?ee:L++,resource:Xe})}if(p&&p.length)for(var z=0;z<p.length;z++){var ot=a.uniformBufferBindings[z],ee=ot.binding,me=ot.size,Ie=ot.offset,He=ot.buffer,Xe={buffer:Fp(He),offset:Ie!=null?Ie:0,size:me};R[0].push({binding:ee!=null?ee:L++,resource:Xe})}if(T&&T.length){L=0;for(var z=0;z<T.length;z++){var pt=(0,Rn.pi)((0,Rn.pi)({},T[z]),Fx),ee=a.samplerBindings[z],dt=ee.texture!==null?ee.texture:s.device.getFallbackTexture(pt);pt.dimension=dt.dimension,pt.formatKind=Mx(dt.format);var It=dt.gpuTextureView;R[1].push({binding:L++,resource:It});var Vt=ee.sampler!==null?ee.sampler:s.device.getFallbackSampler(pt),Kt=K5(Vt);R[1].push({binding:L++,resource:Kt})}}return s.gpuBindGroup=R.filter(function(yr){return yr.length>0}).map(function(yr,_r){return s.device.device.createBindGroup({layout:l.getBindGroupLayout(_r),entries:yr})}),s}return t}(v0),gD=function(e){(0,Rn.ZT)(t,e);function t(r){var n=r.id,i=r.device,a=r.descriptor,s=e.call(this,{id:n,device:i})||this;s.type=Ha.Buffer;var l=a.usage,p=a.viewOrSize,m=!!(l&To.MAP_READ);s.usage=Q5(l),m&&(s.usage=To.MAP_READ|To.COPY_DST);var T=!Cp(p);if(s.view=Cp(p)?null:p,s.size=Cp(p)?Ng(p,4):Ng(p.byteLength,4),Cp(p))s.gpuBuffer=s.device.device.createBuffer({usage:s.usage,size:s.size,mappedAtCreation:m?T:!1});else{s.gpuBuffer=s.device.device.createBuffer({usage:s.usage,size:s.size,mappedAtCreation:!0});var R=p&&p.constructor||Float32Array;new R(s.gpuBuffer.getMappedRange()).set(p),s.gpuBuffer.unmap()}return s}return t.prototype.setSubData=function(r,n,i,a){i===void 0&&(i=0),a===void 0&&(a=0);var s=this.gpuBuffer;a=a||n.byteLength,a=Math.min(a,this.size-r);var l=n.byteOffset+i,p=l+a,m=a+3&-4;if(m!==a){var T=new Uint8Array(n.buffer.slice(l,p));n=new Uint8Array(m),n.set(T),i=0,l=0,p=m,a=m}for(var R=1024*1024*15,L=0;p-(l+L)>R;)this.device.device.queue.writeBuffer(s,r+L,n.buffer,l+L,R),L+=R;this.device.device.queue.writeBuffer(s,r+L,n.buffer,l+L,a-L)},t.prototype.destroy=function(){e.prototype.destroy.call(this),this.gpuBuffer.destroy()},t}(v0),mD=function(){function e(){this.commandEncoder=null,this.gpuComputePassEncoder=null}return e.prototype.dispatchWorkgroups=function(t,r,n){this.gpuComputePassEncoder.dispatchWorkgroups(t,r,n)},e.prototype.dispatchWorkgroupsIndirect=function(t,r){this.gpuComputePassEncoder.dispatchWorkgroupsIndirect(t.gpuBuffer,r)},e.prototype.finish=function(){return this.gpuComputePassEncoder.end(),this.gpuComputePassEncoder=null,this.commandEncoder.finish()},e.prototype.beginComputePass=function(){ea(this.gpuComputePassEncoder===null),this.gpuComputePassEncoder=this.commandEncoder.beginComputePass(this.gpuComputePassDescriptor)},e.prototype.setPipeline=function(t){var r=t,n=_A(r.gpuComputePipeline);this.gpuComputePassEncoder.setPipeline(n)},e.prototype.setBindings=function(t){var r=t;this.gpuComputePassEncoder.setBindGroup(0,r.gpuBindGroup[0])},e.prototype.pushDebugGroup=function(t){this.gpuComputePassEncoder.pushDebugGroup(t)},e.prototype.popDebugGroup=function(){this.gpuComputePassEncoder.popDebugGroup()},e.prototype.insertDebugMarker=function(t){this.gpuComputePassEncoder.insertDebugMarker(t)},e}(),_D=function(e){(0,Rn.ZT)(t,e);function t(r){var n=r.id,i=r.device,a=r.descriptor,s=e.call(this,{id:n,device:i})||this;s.type=Ha.ComputePipeline,s.gpuComputePipeline=null,s.descriptor=a;var l=a.program,p=l.computeStage;if(p===null)return s;var m={layout:"auto",compute:(0,Rn.pi)({},p)};return s.gpuComputePipeline=s.device.device.createComputePipeline(m),s.name!==void 0&&(s.gpuComputePipeline.label=s.name),s}return t.prototype.getBindGroupLayout=function(r){return this.gpuComputePipeline.getBindGroupLayout(r)},t}(v0),yD=function(e){(0,Rn.ZT)(t,e);function t(r){var n,i,a,s,l=r.id,p=r.device,m=r.descriptor,T=e.call(this,{id:l,device:p})||this;T.type=Ha.InputLayout;var R=[];try{for(var L=(0,Rn.XA)(m.vertexBufferDescriptors),z=L.next();!z.done;z=L.next()){var re=z.value,ee=re.arrayStride,me=re.stepMode,Ie=re.attributes;R.push({arrayStride:ee,stepMode:fD(me),attributes:[]});try{for(var He=(a=void 0,(0,Rn.XA)(Ie)),Xe=He.next();!Xe.done;Xe=He.next()){var ot=Xe.value,pt=ot.shaderLocation,dt=ot.format,It=ot.offset;R[R.length-1].attributes.push({shaderLocation:pt,format:hD(dt),offset:It})}}catch(Vt){a={error:Vt}}finally{try{Xe&&!Xe.done&&(s=He.return)&&s.call(He)}finally{if(a)throw a.error}}}}catch(Vt){n={error:Vt}}finally{try{z&&!z.done&&(i=L.return)&&i.call(L)}finally{if(n)throw n.error}}return T.indexFormat=cD(m.indexBufferFormat),T.buffers=R,T}return t}(v0),ED=function(e){(0,Rn.ZT)(t,e);function t(r){var n=r.id,i=r.device,a=r.descriptor,s=e.call(this,{id:n,device:i})||this;return s.type=Ha.Program,s.vertexStage=null,s.fragmentStage=null,s.computeStage=null,s.descriptor=a,a.vertex&&(s.vertexStage=s.createShaderStage(a.vertex,"vertex")),a.fragment&&(s.fragmentStage=s.createShaderStage(a.fragment,"fragment")),a.compute&&(s.computeStage=s.createShaderStage(a.compute,"compute")),s}return t.prototype.setUniformsLegacy=function(r){},t.prototype.createShaderStage=function(r,n){var i,a,s=r.glsl,l=r.wgsl,p=r.entryPoint,m=!1,T=l;if(!T)try{T=this.device.glsl_compile(s,n,m)}catch(me){throw console.error(me,s),new Error("whoops")}var R=function(me){if(!T.includes(me))return"continue";T=T.replace("var T_".concat(me,": texture_2d<f32>;"),"var T_".concat(me,": texture_depth_2d;")),T=T.replace(new RegExp("textureSample\\(T_".concat(me,"(.*)\\);$"),"gm"),function(Ie,He){return"vec4<f32>(textureSample(T_".concat(me).concat(He,"), 0.0, 0.0, 0.0);")})};try{for(var L=(0,Rn.XA)(["u_TextureFramebufferDepth"]),z=L.next();!z.done;z=L.next()){var re=z.value;R(re)}}catch(me){i={error:me}}finally{try{z&&!z.done&&(a=L.return)&&a.call(L)}finally{if(i)throw i.error}}var ee=this.device.device.createShaderModule({code:T});return{module:ee,entryPoint:p||"main"}},t}(v0),SD=function(e){(0,Rn.ZT)(t,e);function t(r){var n=r.id,i=r.device,a=r.descriptor,s=e.call(this,{id:n,device:i})||this;s.type=Ha.QueryPool;var l=a.elemCount,p=a.type;return s.querySet=s.device.device.createQuerySet({type:eD(p),count:l}),s.resolveBuffer=s.device.device.createBuffer({size:l*8,usage:GPUBufferUsage.QUERY_RESOLVE|GPUBufferUsage.COPY_SRC}),s.cpuBuffer=s.device.device.createBuffer({size:l*8,usage:GPUBufferUsage.COPY_DST|GPUBufferUsage.MAP_READ}),s.results=null,s}return t.prototype.queryResultOcclusion=function(r){return this.results===null?null:this.results[r]!==BigInt(0)},t.prototype.destroy=function(){e.prototype.destroy.call(this),this.querySet.destroy(),this.resolveBuffer.destroy(),this.cpuBuffer.destroy()},t}(v0),xD=function(e){(0,Rn.ZT)(t,e);function t(r){var n=r.id,i=r.device,a=e.call(this,{id:n,device:i})||this;return a.type=Ha.Readback,a}return t.prototype.readTexture=function(r,n,i,a,s,l,p,m){return p===void 0&&(p=0),(0,Rn.mG)(this,void 0,void 0,function(){var T,R,L,z,re,ee,me,Ie;return(0,Rn.Jh)(this,function(He){return T=r,R=0,L=this.getBlockInformationFromFormat(T.gpuTextureformat),z=Math.ceil(a/L.width)*L.length,re=Math.ceil(z/256)*256,ee=re*s,me=this.device.createBuffer({usage:To.STORAGE|To.MAP_READ|To.COPY_DST,hint:jf.STATIC,viewOrSize:ee}),Ie=this.device.device.createCommandEncoder(),Ie.copyTextureToBuffer({texture:T.gpuTexture,mipLevel:0,origin:{x:n,y:i,z:Math.max(R,0)}},{buffer:me.gpuBuffer,offset:0,bytesPerRow:re},{width:a,height:s,depthOrArrayLayers:1}),this.device.device.queue.submit([Ie.finish()]),[2,this.readBuffer(me,0,l.byteLength===ee?l:null,p,ee,T.format)]})})},t.prototype.readTextureSync=function(r,n,i,a,s,l,p,m){throw new Error("ERROR_MSG_METHOD_NOT_IMPLEMENTED")},t.prototype.readBuffer=function(r,n,i,a,s,l,p,m){var T=this;n===void 0&&(n=0),i===void 0&&(i=null),s===void 0&&(s=0),l===void 0&&(l=Jt.U8_RGB),p===void 0&&(p=!1);var R=r,L=s||R.size,z=i||R.view,re=z&&z.constructor&&z.constructor.BYTES_PER_ELEMENT||Rx(l),ee=R;if(!(R.usage&To.MAP_READ&&R.usage&To.COPY_DST)){var me=this.device.device.createCommandEncoder();ee=this.device.createBuffer({usage:To.STORAGE|To.MAP_READ|To.COPY_DST,hint:jf.STATIC,viewOrSize:L}),me.copyBufferToBuffer(R.gpuBuffer,n,ee.gpuBuffer,0,L),this.device.device.queue.submit([me.finish()])}return new Promise(function(Ie,He){ee.gpuBuffer.mapAsync(Z_.READ,n,L).then(function(){var Xe=ee.gpuBuffer.getMappedRange(n,L),ot=z;if(p)ot===null?ot=tT(l,L,!0,Xe):ot=tT(l,ot.buffer,void 0,Xe);else if(ot===null)switch(re){case 1:ot=new Uint8Array(L),ot.set(new Uint8Array(Xe));break;case 2:ot=T.getHalfFloatAsFloatRGBAArrayBuffer(L/2,Xe);break;case 4:ot=new Float32Array(L/4),ot.set(new Float32Array(Xe));break}else switch(re){case 1:ot=new Uint8Array(ot.buffer),ot.set(new Uint8Array(Xe));break;case 2:ot=T.getHalfFloatAsFloatRGBAArrayBuffer(L/2,Xe,z);break;case 4:var pt=z&&z.constructor||Float32Array;ot=new pt(ot.buffer),ot.set(new pt(Xe));break}ee.gpuBuffer.unmap(),Ie(ot)},function(Xe){return He(Xe)})})},t.prototype.getHalfFloatAsFloatRGBAArrayBuffer=function(r,n,i){i||(i=new Float32Array(r));for(var a=new Uint16Array(n);r--;)i[r]=dD(a[r]);return i},t.prototype.getBlockInformationFromFormat=function(r){switch(r){case"r8unorm":case"r8snorm":case"r8uint":case"r8sint":return{width:1,height:1,length:1};case"r16uint":case"r16sint":case"r16float":case"rg8unorm":case"rg8snorm":case"rg8uint":case"rg8sint":return{width:1,height:1,length:2};case"r32uint":case"r32sint":case"r32float":case"rg16uint":case"rg16sint":case"rg16float":case"rgba8unorm":case"rgba8unorm-srgb":case"rgba8snorm":case"rgba8uint":case"rgba8sint":case"bgra8unorm":case"bgra8unorm-srgb":case"rgb9e5ufloat":case"rgb10a2unorm":case"rg11b10ufloat":return{width:1,height:1,length:4};case"rg32uint":case"rg32sint":case"rg32float":case"rgba16uint":case"rgba16sint":case"rgba16float":return{width:1,height:1,length:8};case"rgba32uint":case"rgba32sint":case"rgba32float":return{width:1,height:1,length:16};case"stencil8":throw new Error("No fixed size for Stencil8 format!");case"depth16unorm":return{width:1,height:1,length:2};case"depth24plus":throw new Error("No fixed size for Depth24Plus format!");case"depth24plus-stencil8":throw new Error("No fixed size for Depth24PlusStencil8 format!");case"depth32float":return{width:1,height:1,length:4};case"depth32float-stencil8":return{width:1,height:1,length:5};case"bc7-rgba-unorm":case"bc7-rgba-unorm-srgb":case"bc6h-rgb-ufloat":case"bc6h-rgb-float":case"bc2-rgba-unorm":case"bc2-rgba-unorm-srgb":case"bc3-rgba-unorm":case"bc3-rgba-unorm-srgb":case"bc5-rg-unorm":case"bc5-rg-snorm":return{width:4,height:4,length:16};case"bc4-r-unorm":case"bc4-r-snorm":case"bc1-rgba-unorm":case"bc1-rgba-unorm-srgb":return{width:4,height:4,length:8};default:return{width:1,height:1,length:4}}},t}(v0),TD=function(){function e(t){this.device=t,this.commandEncoder=null,this.gpuRenderPassEncoder=null,this.gfxColorAttachment=[],this.gfxColorAttachmentLevel=[],this.gfxColorResolveTo=[],this.gfxColorResolveToLevel=[],this.gfxDepthStencilAttachment=null,this.gfxDepthStencilResolveTo=null,this.gpuColorAttachments=[],this.gpuDepthStencilAttachment={view:null,depthLoadOp:"load",depthStoreOp:"store",stencilLoadOp:"load",stencilStoreOp:"store"},this.gpuRenderPassDescriptor={colorAttachments:this.gpuColorAttachments,depthStencilAttachment:this.gpuDepthStencilAttachment}}return e.prototype.getTextureView=function(t,r){return ea(r<t.mipLevelCount),t.mipLevelCount===1?t.gpuTextureView:t.gpuTexture.createView({baseMipLevel:r,mipLevelCount:1})},e.prototype.setRenderPassDescriptor=function(t){var r,n,i,a,s,l;this.descriptor=t,this.gpuRenderPassDescriptor.colorAttachments=this.gpuColorAttachments;var p=t.colorAttachment.length;this.gfxColorAttachment.length=p,this.gfxColorResolveTo.length=p;for(var m=0;m<t.colorAttachment.length;m++){var T=t.colorAttachment[m],R=t.colorResolveTo[m];if(T===null&&R!==null&&(T=R,R=null),this.gfxColorAttachment[m]=T,this.gfxColorResolveTo[m]=R,this.gfxColorAttachmentLevel[m]=((r=t.colorAttachmentLevel)===null||r===void 0?void 0:r[m])||0,this.gfxColorResolveToLevel[m]=((n=t.colorResolveToLevel)===null||n===void 0?void 0:n[m])||0,T!==null){this.gpuColorAttachments[m]===void 0&&(this.gpuColorAttachments[m]={});var L=this.gpuColorAttachments[m];L.view=this.getTextureView(T,((i=this.gfxColorAttachmentLevel)===null||i===void 0?void 0:i[m])||0);var z=(s=(a=t.colorClearColor)===null||a===void 0?void 0:a[m])!==null&&s!==void 0?s:"load";z==="load"?L.loadOp="load":(L.loadOp="clear",L.clearValue=z),L.storeOp=!((l=t.colorStore)===null||l===void 0)&&l[m]?"store":"discard",L.resolveTarget=void 0,R!==null&&(T.sampleCount>1?L.resolveTarget=this.getTextureView(R,this.gfxColorResolveToLevel[m]):L.storeOp="store")}else{this.gpuColorAttachments.length=m,this.gfxColorAttachment.length=m,this.gfxColorResolveTo.length=m;break}}if(this.gfxDepthStencilAttachment=t.depthStencilAttachment,this.gfxDepthStencilResolveTo=t.depthStencilResolveTo,t.depthStencilAttachment){var re=t.depthStencilAttachment,L=this.gpuDepthStencilAttachment;L.view=re.gpuTextureView;var ee=!!(wp(re.format)&xn.Depth);ee?(t.depthClearValue==="load"?L.depthLoadOp="load":(L.depthLoadOp="clear",L.depthClearValue=t.depthClearValue),t.depthStencilStore||this.gfxDepthStencilResolveTo!==null?L.depthStoreOp="store":L.depthStoreOp="discard"):(L.depthLoadOp=void 0,L.depthStoreOp=void 0);var me=!!(wp(re.format)&xn.Stencil);me?(t.stencilClearValue==="load"?L.stencilLoadOp="load":(L.stencilLoadOp="clear",L.stencilClearValue=t.stencilClearValue),t.depthStencilStore||this.gfxDepthStencilResolveTo!==null?L.stencilStoreOp="store":L.stencilStoreOp="discard"):(L.stencilLoadOp=void 0,L.stencilStoreOp=void 0),this.gpuRenderPassDescriptor.depthStencilAttachment=this.gpuDepthStencilAttachment}else this.gpuRenderPassDescriptor.depthStencilAttachment=void 0;this.gpuRenderPassDescriptor.occlusionQuerySet=bp(t.occlusionQueryPool)?void 0:J5(t.occlusionQueryPool)},e.prototype.beginRenderPass=function(t){ea(this.gpuRenderPassEncoder===null),this.setRenderPassDescriptor(t),this.gpuRenderPassEncoder=this.commandEncoder.beginRenderPass(this.gpuRenderPassDescriptor)},e.prototype.flipY=function(t,r){var n=this.device.swapChainHeight;return n-t-r},e.prototype.setViewport=function(t,r,n,i,a,s){a===void 0&&(a=0),s===void 0&&(s=1),this.gpuRenderPassEncoder.setViewport(t,this.flipY(r,i),n,i,a,s)},e.prototype.setScissorRect=function(t,r,n,i){this.gpuRenderPassEncoder.setScissorRect(t,this.flipY(r,i),n,i)},e.prototype.setPipeline=function(t){var r=t,n=_A(r.gpuRenderPipeline);this.gpuRenderPassEncoder.setPipeline(n)},e.prototype.setVertexInput=function(t,r,n){if(t!==null){var i=t;n!==null&&this.gpuRenderPassEncoder.setIndexBuffer(Fp(n.buffer),_A(i.indexFormat),n.offset);for(var a=0;a<r.length;a++){var s=r[a];s!==null&&this.gpuRenderPassEncoder.setVertexBuffer(a,Fp(s.buffer),s.offset)}}},e.prototype.setBindings=function(t){var r=t;this.gpuRenderPassEncoder.setBindGroup(0,r.gpuBindGroup[0]),r.gpuBindGroup[1]&&this.gpuRenderPassEncoder.setBindGroup(1,r.gpuBindGroup[1])},e.prototype.setStencilReference=function(t){this.gpuRenderPassEncoder.setStencilReference(t)},e.prototype.draw=function(t,r,n,i){this.gpuRenderPassEncoder.draw(t,r,n,i)},e.prototype.drawIndexed=function(t,r,n,i,a){this.gpuRenderPassEncoder.drawIndexed(t,r,n,i,a)},e.prototype.drawIndirect=function(t,r){this.gpuRenderPassEncoder.drawIndirect(Fp(t),r)},e.prototype.drawIndexedIndirect=function(t,r){this.gpuRenderPassEncoder.drawIndexedIndirect(Fp(t),r)},e.prototype.beginOcclusionQuery=function(t){this.gpuRenderPassEncoder.beginOcclusionQuery(t)},e.prototype.endOcclusionQuery=function(){this.gpuRenderPassEncoder.endOcclusionQuery()},e.prototype.pushDebugGroup=function(t){this.gpuRenderPassEncoder.pushDebugGroup(t)},e.prototype.popDebugGroup=function(){this.gpuRenderPassEncoder.popDebugGroup()},e.prototype.insertDebugMarker=function(t){this.gpuRenderPassEncoder.insertDebugMarker(t)},e.prototype.finish=function(){this.gpuRenderPassEncoder.end(),this.gpuRenderPassEncoder=null;for(var t=0;t<this.gfxColorAttachment.length;t++){var r=this.gfxColorAttachment[t],n=this.gfxColorResolveTo[t];r!==null&&n!==null&&r.sampleCount===1&&this.copyAttachment(n,this.gfxColorAttachmentLevel[t],r,this.gfxColorResolveToLevel[t])}return this.gfxDepthStencilAttachment&&this.gfxDepthStencilResolveTo&&(this.gfxDepthStencilAttachment.sampleCount>1||this.copyAttachment(this.gfxDepthStencilResolveTo,0,this.gfxDepthStencilAttachment,0)),this.commandEncoder.finish()},e.prototype.copyAttachment=function(t,r,n,i){ea(n.sampleCount===1);var a={texture:n.gpuTexture,mipLevel:i},s={texture:t.gpuTexture,mipLevel:r};ea(n.width>>>i===t.width>>>r),ea(n.height>>>i===t.height>>>r),ea(!!(n.usage&sc.COPY_SRC)),ea(!!(t.usage&sc.COPY_DST)),this.commandEncoder.copyTextureToTexture(a,s,[t.width,t.height,1])},e}(),CD=function(e){(0,Rn.ZT)(t,e);function t(r){var n=r.id,i=r.device,a=r.descriptor,s=e.call(this,{id:n,device:i})||this;return s.type=Ha.RenderPipeline,s.isCreatingAsync=!1,s.gpuRenderPipeline=null,s.descriptor=a,s.device.createRenderPipelineInternal(s,!1),s}return t.prototype.getBindGroupLayout=function(r){return this.gpuRenderPipeline.getBindGroupLayout(r)},t}(v0),bD=function(e){(0,Rn.ZT)(t,e);function t(r){var n=r.id,i=r.device,a=r.descriptor,s,l,p=e.call(this,{id:n,device:i})||this;p.type=Ha.Sampler;var m=a.lodMinClamp,T=a.mipmapFilter===bu.NO_MIP?a.lodMinClamp:a.lodMaxClamp,R=(s=a.maxAnisotropy)!==null&&s!==void 0?s:1;return R>1&&ea(a.minFilter===ru.BILINEAR&&a.magFilter===ru.BILINEAR&&a.mipmapFilter===bu.LINEAR),p.gpuSampler=p.device.device.createSampler({addressModeU:G_(a.addressModeU),addressModeV:G_(a.addressModeV),addressModeW:G_((l=a.addressModeW)!==null&&l!==void 0?l:a.addressModeU),lodMinClamp:m,lodMaxClamp:T,minFilter:qx(a.minFilter),magFilter:qx(a.magFilter),mipmapFilter:q5(a.mipmapFilter),compare:a.compareFunction!==void 0?Vg(a.compareFunction):void 0,maxAnisotropy:R}),p}return t}(v0),Hg=function(e){(0,Rn.ZT)(t,e);function t(r){var n=r.id,i=r.device,a=r.descriptor,s=r.skipCreate,l=r.sampleCount,p=e.call(this,{id:n,device:i})||this;p.type=Ha.Texture;var m=a.format,T=a.dimension,R=a.width,L=a.height,z=a.depthOrArrayLayers,re=a.mipLevelCount,ee=a.usage;return p.device.createTextureShared({format:m,dimension:T!=null?T:da.TEXTURE_2D,width:R,height:L,depthOrArrayLayers:z!=null?z:1,mipLevelCount:re!=null?re:1,usage:ee,sampleCount:l!=null?l:1},p,s),p}return t.prototype.textureFromImageBitmapOrCanvas=function(r,n,i){for(var a=n[0].width,s=n[0].height,l={size:{width:a,height:s,depthOrArrayLayers:i},format:"rgba8unorm",usage:GPUTextureUsage.TEXTURE_BINDING|GPUTextureUsage.COPY_DST|GPUTextureUsage.RENDER_ATTACHMENT},p=r.createTexture(l),m=0;m<n.length;m++)r.queue.copyExternalImageToTexture({source:n[m]},{texture:p,origin:[0,0,m]},[a,s]);return[p,a,s]},t.prototype.isImageBitmapOrCanvases=function(r){var n=r[0];return n instanceof ImageBitmap||n instanceof HTMLCanvasElement||n instanceof OffscreenCanvas},t.prototype.isVideo=function(r){var n=r[0];return n instanceof HTMLVideoElement},t.prototype.setImageData=function(r,n){var i,a=this.device.device,s,l,p;this.isImageBitmapOrCanvases(r)?(i=(0,Rn.CR)(this.textureFromImageBitmapOrCanvas(a,r,this.depthOrArrayLayers),3),s=i[0],l=i[1],p=i[2]):this.isVideo(r)&&(s=a.importExternalTexture({source:r[0]})),this.width=l,this.height=p,this.gpuTexture=s,this.gpuTextureView=s.createView({dimension:$5(this.dimension)})},t.prototype.destroy=function(){e.prototype.destroy.call(this),this.gpuTexture.destroy()},t}(v0),RD=function(){function e(t,r,n,i,a){this.swapChainWidth=0,this.swapChainHeight=0,this.swapChainTextureUsage=sc.RENDER_ATTACHMENT|sc.COPY_DST,this._resourceUniqueId=0,this.renderPassPool=[],this.computePassPool=[],this.featureTextureCompressionBC=!1,this.platformString="WebGPU",this.glslVersion="#version 440",this.explicitBindingLocations=!0,this.separateSamplerTextures=!0,this.viewportOrigin=Rp.UPPER_LEFT,this.clipSpaceNearZ=Mp.ZERO,this.supportsSyncPipelineCompilation=!1,this.supportMRT=!0,this.device=r,this.canvas=n,this.canvasContext=i,this.glsl_compile=a,this.fallbackTexture2D=this.createFallbackTexture(da.TEXTURE_2D,Ts.Float),this.setResourceName(this.fallbackTexture2D,"Fallback Texture2D"),this.fallbackTexture2DDepth=this.createFallbackTexture(da.TEXTURE_2D,Ts.Depth),this.setResourceName(this.fallbackTexture2DDepth,"Fallback Depth Texture2D"),this.fallbackTexture2DArray=this.createFallbackTexture(da.TEXTURE_2D_ARRAY,Ts.Float),this.setResourceName(this.fallbackTexture2DArray,"Fallback Texture2DArray"),this.fallbackTexture3D=this.createFallbackTexture(da.TEXTURE_3D,Ts.Float),this.setResourceName(this.fallbackTexture3D,"Fallback Texture3D"),this.fallbackTextureCube=this.createFallbackTexture(da.TEXTURE_CUBE_MAP,Ts.Float),this.setResourceName(this.fallbackTextureCube,"Fallback TextureCube"),this.fallbackSamplerFiltering=this.createSampler({addressModeU:ac.REPEAT,addressModeV:ac.REPEAT,minFilter:ru.POINT,magFilter:ru.POINT,mipmapFilter:bu.NEAREST}),this.setResourceName(this.fallbackSamplerFiltering,"Fallback Sampler Filtering"),this.fallbackSamplerComparison=this.createSampler({addressModeU:ac.REPEAT,addressModeV:ac.REPEAT,minFilter:ru.POINT,magFilter:ru.POINT,mipmapFilter:bu.NEAREST,compareFunction:Ga.ALWAYS}),this.setResourceName(this.fallbackSamplerComparison,"Fallback Sampler Comparison Filtering"),this.device.features&&(this.featureTextureCompressionBC=this.device.features.has("texture-compression-bc")),this.device.onuncapturederror=function(s){console.error(s.error)},this.swapChainFormat=navigator.gpu.getPreferredCanvasFormat(),this.canvasContext.configure({device:this.device,format:this.swapChainFormat,usage:this.swapChainTextureUsage,alphaMode:"premultiplied"})}return e.prototype.destroy=function(){},e.prototype.configureSwapChain=function(t,r){this.swapChainWidth===t&&this.swapChainHeight===r||(this.swapChainWidth=t,this.swapChainHeight=r)},e.prototype.getOnscreenTexture=function(){var t=this.canvasContext.getCurrentTexture(),r=t.createView(),n=new Hg({id:0,device:this,descriptor:{format:Jt.U8_RGBA_RT,width:this.swapChainWidth,height:this.swapChainHeight,depthOrArrayLayers:0,dimension:da.TEXTURE_2D,mipLevelCount:1,usage:this.swapChainTextureUsage},skipCreate:!0});return n.depthOrArrayLayers=1,n.sampleCount=1,n.gpuTexture=t,n.gpuTextureView=r,n.name="Onscreen",this.setResourceName(n,"Onscreen Texture"),n},e.prototype.getDevice=function(){return this},e.prototype.getCanvas=function(){return this.canvas},e.prototype.beginFrame=function(){},e.prototype.endFrame=function(){},e.prototype.getNextUniqueId=function(){return++this._resourceUniqueId},e.prototype.createBuffer=function(t){return new gD({id:this.getNextUniqueId(),device:this,descriptor:t})},e.prototype.createTexture=function(t){return new Hg({id:this.getNextUniqueId(),device:this,descriptor:t})},e.prototype.createSampler=function(t){return new bD({id:this.getNextUniqueId(),device:this,descriptor:t})},e.prototype.createRenderTarget=function(t){var r=new Hg({id:this.getNextUniqueId(),device:this,descriptor:(0,Rn.pi)((0,Rn.pi)({},t),{dimension:da.TEXTURE_2D,mipLevelCount:1,depthOrArrayLayers:1,usage:Kc.RENDER_TARGET}),sampleCount:t.sampleCount});return r.depthOrArrayLayers=1,r.type=Ha.RenderTarget,r},e.prototype.createRenderTargetFromTexture=function(t){var r=t,n=r.format,i=r.width,a=r.height,s=r.depthOrArrayLayers,l=r.sampleCount,p=r.mipLevelCount,m=r.gpuTexture,T=r.gpuTextureView,R=r.usage;ea(!!(R&sc.RENDER_ATTACHMENT));var L=new Hg({id:this.getNextUniqueId(),device:this,descriptor:{format:n,width:i,height:a,depthOrArrayLayers:s,dimension:da.TEXTURE_2D,mipLevelCount:p,usage:R},skipCreate:!0});return L.depthOrArrayLayers=s,L.sampleCount=l,L.gpuTexture=m,L.gpuTextureView=T,L},e.prototype.createProgram=function(t){var r,n;return!((r=t.vertex)===null||r===void 0)&&r.glsl&&(t.vertex.glsl=wh(this.queryVendorInfo(),"vert",t.vertex.glsl)),!((n=t.fragment)===null||n===void 0)&&n.glsl&&(t.fragment.glsl=wh(this.queryVendorInfo(),"frag",t.fragment.glsl)),new ED({id:this.getNextUniqueId(),device:this,descriptor:t})},e.prototype.createTextureShared=function(t,r,n){var i={width:t.width,height:t.height,depthOrArrayLayers:t.depthOrArrayLayers},a=t.mipLevelCount,s=z_(t.format),l=Y5(t.dimension),p=X5(t.usage);if(r.gpuTextureformat=s,r.dimension=t.dimension,r.format=t.format,r.width=t.width,r.height=t.height,r.depthOrArrayLayers=t.depthOrArrayLayers,r.mipLevelCount=a,r.usage=p,r.sampleCount=t.sampleCount,!n){var m=this.device.createTexture({size:i,mipLevelCount:a,format:s,dimension:l,sampleCount:t.sampleCount,usage:p}),T=m.createView();r.gpuTexture=m,r.gpuTextureView=T}},e.prototype.getFallbackSampler=function(t){var r=t.formatKind;return r===Ts.Depth&&t.comparison?this.fallbackSamplerComparison:this.fallbackSamplerFiltering},e.prototype.getFallbackTexture=function(t){var r=t.dimension,n=t.formatKind;if(r===da.TEXTURE_2D)return n===Ts.Depth?this.fallbackTexture2DDepth:this.fallbackTexture2D;if(r===da.TEXTURE_2D_ARRAY)return this.fallbackTexture2DArray;if(r===da.TEXTURE_3D)return this.fallbackTexture3D;if(r===da.TEXTURE_CUBE_MAP)return this.fallbackTextureCube;throw new Error("whoops")},e.prototype.createFallbackTexture=function(t,r){var n=t===da.TEXTURE_CUBE_MAP?6:1,i=r===Ts.Float?Jt.U8_RGBA_NORM:Jt.D24;return this.createTexture({dimension:t,format:i,usage:Kc.SAMPLED,width:1,height:1,depthOrArrayLayers:n,mipLevelCount:1})},e.prototype.createBindings=function(t){return new vD({id:this.getNextUniqueId(),device:this,descriptor:t})},e.prototype.createInputLayout=function(t){return new yD({id:this.getNextUniqueId(),device:this,descriptor:t})},e.prototype.createComputePipeline=function(t){return new _D({id:this.getNextUniqueId(),device:this,descriptor:t})},e.prototype.createRenderPipeline=function(t){return new CD({id:this.getNextUniqueId(),device:this,descriptor:(0,Rn.pi)({},t)})},e.prototype.createQueryPool=function(t,r){return new SD({id:this.getNextUniqueId(),device:this,descriptor:{type:t,elemCount:r}})},e.prototype.createRenderPipelineInternal=function(t,r){var n;if(t.gpuRenderPipeline===null){var i=t.descriptor,a=i.program,s=a.vertexStage,l=a.fragmentStage;if(!(s===null||l===null)){var p=i.megaStateDescriptor||{},m=p.stencilBack,T=p.stencilFront,R=(0,Rn._T)(p,["stencilBack","stencilFront"]),L=Op(yA);i.megaStateDescriptor=(0,Rn.pi)((0,Rn.pi)((0,Rn.pi)({},L),{stencilBack:(0,Rn.pi)((0,Rn.pi)({},L.stencilBack),m),stencilFront:(0,Rn.pi)((0,Rn.pi)({},L.stencilFront),T)}),R);var z=i.megaStateDescriptor.attachmentsState[0];i.colorAttachmentFormats.forEach(function(ot,pt){i.megaStateDescriptor.attachmentsState[pt]||(i.megaStateDescriptor.attachmentsState[pt]=Dx(void 0,z))});var re=iD((n=i.topology)!==null&&n!==void 0?n:nu.TRIANGLES,i.megaStateDescriptor),ee=uD(i.colorAttachmentFormats,i.megaStateDescriptor),me=lD(i.depthStencilAttachmentFormat,i.megaStateDescriptor),Ie=void 0;i.inputLayout!==null&&(Ie=i.inputLayout.buffers);var He=i.sampleCount,Xe={layout:"auto",vertex:(0,Rn.pi)((0,Rn.pi)({},s),{buffers:Ie}),primitive:re,depthStencil:me,multisample:{count:He},fragment:(0,Rn.pi)((0,Rn.pi)({},l),{targets:ee})};t.gpuRenderPipeline=this.device.createRenderPipeline(Xe)}}},e.prototype.createReadback=function(){return new xD({id:this.getNextUniqueId(),device:this})},e.prototype.createRenderPass=function(t){var r=this.renderPassPool.pop();return r===void 0&&(r=new TD(this)),r.commandEncoder=this.device.createCommandEncoder(),r.beginRenderPass(t),r},e.prototype.createComputePass=function(){var t=this.computePassPool.pop();return t===void 0&&(t=new mD),t.commandEncoder=this.device.createCommandEncoder(),t.beginComputePass(),t},e.prototype.submitPass=function(t){var r=this.device.queue,n=t,i=n.finish();r.submit([i]),n.commandEncoder=null},e.prototype.copySubTexture2D=function(t,r,n,i,a,s){var l=this.device.createCommandEncoder(),p=t,m=i,T={texture:m.gpuTexture,origin:[a,s,0]},R={texture:p.gpuTexture,origin:[r,n,0]};ea(!!(m.usage&sc.COPY_SRC)),ea(!!(p.usage&sc.COPY_DST)),l.copyTextureToTexture(T,R,[m.width,m.height,1]),this.device.queue.submit([l.finish()])},e.prototype.queryLimits=function(){return{uniformBufferMaxPageWordSize:this.device.limits.maxUniformBufferBindingSize>>>2,uniformBufferWordAlignment:this.device.limits.minUniformBufferOffsetAlignment>>>2,supportedSampleCounts:[1],occlusionQueriesRecommended:!0,computeShadersSupported:!0}},e.prototype.queryTextureFormatSupported=function(t,r,n){if(AD(t)){if(!this.featureTextureCompressionBC)return!1;var i=pD(t);return r%i!==0||n%i!==0?!1:this.featureTextureCompressionBC}switch(t){case Jt.U16_RGBA_NORM:return!1;case Jt.F32_RGBA:return!1}return!0},e.prototype.queryPlatformAvailable=function(){return!0},e.prototype.queryVendorInfo=function(){return this},e.prototype.queryRenderPass=function(t){var r=t;return r.descriptor},e.prototype.queryRenderTarget=function(t){var r=t;return r},e.prototype.setResourceName=function(t,r){if(t.name=r,t.type===Ha.Buffer){var n=t;n.gpuBuffer.label=r}else if(t.type===Ha.Texture){var n=t;n.gpuTexture.label=r,n.gpuTextureView.label=r}else if(t.type===Ha.RenderTarget){var n=t;n.gpuTexture.label=r,n.gpuTextureView.label=r}else if(t.type===Ha.Sampler){var n=t;n.gpuSampler.label=r}else if(t.type===Ha.RenderPipeline){var n=t;n.gpuRenderPipeline!==null&&(n.gpuRenderPipeline.label=r)}},e.prototype.setResourceLeakCheck=function(t,r){},e.prototype.checkForLeaks=function(){},e.prototype.programPatched=function(t){},e.prototype.pipelineQueryReady=function(t){var r=t;return r.gpuRenderPipeline!==null},e.prototype.pipelineForceReady=function(t){var r=t;this.createRenderPipelineInternal(r,!1)},e}(),MD=function(){function e(t){this.pluginOptions=t}return e.prototype.createSwapChain=function(t){return(0,Rn.mG)(this,void 0,void 0,function(){var r,n,i,a,s,l,p,m;return(0,Rn.Jh)(this,function(T){switch(T.label){case 0:if(globalThis.navigator.gpu===void 0)return[2,null];r=null,T.label=1;case 1:return T.trys.push([1,3,,4]),n=this.pluginOptions.xrCompatible,[4,globalThis.navigator.gpu.requestAdapter({xrCompatible:n})];case 2:return r=T.sent(),[3,4];case 3:return i=T.sent(),console.log(i),[3,4];case 4:return r===null?[2,null]:(a=["depth32float-stencil8","texture-compression-bc"],s=a.filter(function(R){return r.features.has(R)}),[4,r.requestDevice({requiredFeatures:s})]);case 5:if(l=T.sent(),l&&(p=this.pluginOptions.onContextLost,l.lost.then(function(){p&&p()})),l===null)return[2,null];if(m=t.getContext("webgpu"),!m)return[2,null];T.label=6;case 6:return T.trys.push([6,8,,9]),[4,Qx(this.pluginOptions.shaderCompilerPath)];case 7:return T.sent(),[3,9];case 8:return T.sent(),[3,9];case 9:return[2,new RD(r,l,t,m,V5)]}})})},e}(),wD=Fn.isPlainObject,ID=Fn.isTypedArray,PD=function(){function e(t,r){(0,ue.Z)(this,e),(0,ve.Z)(this,"destroyed",!1),(0,ve.Z)(this,"uniforms",{}),this.reGl=t;var n=r.vs,i=r.fs,a=r.attributes,s=r.uniforms,l=r.primitive,p=r.count,m=r.elements,T=r.depth,R=r.cull,L=r.instances,z={platformString:"WebGL1",glslVersion:"#version 100",explicitBindingLocations:!1,separateSamplerTextures:!1,viewportOrigin:Rp.LOWER_LEFT,clipSpaceNearZ:Mp.NEGATIVE_ONE,supportMRT:!1},re={};this.options=r,s&&(this.uniforms=this.extractUniforms(s),Object.keys(s).forEach(function(Ie){re[Ie]=t.prop(Ie)}));var ee={};Object.keys(a).forEach(function(Ie){ee[Ie]=a[Ie].get()});var me={attributes:ee,frag:Qc(wh(z,"frag",i,null,!1)),uniforms:re,vert:Qc(wh(z,"vert",n,null,!1)),colorMask:t.prop("colorMask"),lineWidth:1,blend:{enable:t.prop("blend.enable"),func:t.prop("blend.func"),equation:t.prop("blend.equation"),color:t.prop("blend.color")},stencil:{enable:t.prop("stencil.enable"),mask:t.prop("stencil.mask"),func:t.prop("stencil.func"),opFront:t.prop("stencil.opFront"),opBack:t.prop("stencil.opBack")},primitive:y6[l===void 0?Fe.TRIANGLES:l]};L&&(me.instances=L),p?me.count=p:m&&(me.elements=m.get()),this.initDepthDrawParams({depth:T},me),this.initCullDrawParams({cull:R},me),this.drawCommand=t(me),this.drawParams=me}return(0,_e.Z)(e,[{key:"updateAttributesAndElements",value:function(r,n){var i={};Object.keys(r).forEach(function(a){i[a]=r[a].get()}),this.drawParams.attributes=i,this.drawParams.elements=n.get(),this.drawCommand=this.reGl(this.drawParams)}},{key:"updateAttributes",value:function(r){var n={};Object.keys(r).forEach(function(i){n[i]=r[i].get()}),this.drawParams.attributes=n,this.drawCommand=this.reGl(this.drawParams)}},{key:"addUniforms",value:function(r){this.uniforms=(0,Q.Z)((0,Q.Z)({},this.uniforms),this.extractUniforms(r))}},{key:"draw",value:function(r,n){if(!(this.drawParams.attributes&&Object.keys(this.drawParams.attributes).length===0)){var i=(0,Q.Z)((0,Q.Z)({},this.uniforms),this.extractUniforms(r.uniforms||{})),a={};Object.keys(i).forEach(function(s){var l=(0,eu.Z)(i[s]);l==="boolean"||l==="number"||Array.isArray(i[s])||i[s].BYTES_PER_ELEMENT?a[s]=i[s]:a[s]=i[s].get()}),a.blend=n?this.getBlendDrawParams({blend:{enable:!1}}):this.getBlendDrawParams(r),a.stencil=this.getStencilDrawParams(r),a.colorMask=this.getColorMaskDrawParams(r,n),this.drawCommand(a)}}},{key:"destroy",value:function(){var r;(r=this.drawParams)===null||r===void 0||(r=r.elements)===null||r===void 0||r.destroy(),this.options.attributes&&Object.values(this.options.attributes).forEach(function(n){n==null||n.destroy()}),this.destroyed=!0}},{key:"initDepthDrawParams",value:function(r,n){var i=r.depth;i&&(n.depth={enable:i.enable===void 0?!0:!!i.enable,mask:i.mask===void 0?!0:!!i.mask,func:T6[i.func||Fe.LESS],range:i.range||[0,1]})}},{key:"getBlendDrawParams",value:function(r){var n=r.blend,i=n||{},a=i.enable,s=i.func,l=i.equation,p=i.color,m=p===void 0?[0,0,0,0]:p;return{enable:!!a,func:{srcRGB:Mg[s&&s.srcRGB||Fe.SRC_ALPHA],srcAlpha:Mg[s&&s.srcAlpha||Fe.SRC_ALPHA],dstRGB:Mg[s&&s.dstRGB||Fe.ONE_MINUS_SRC_ALPHA],dstAlpha:Mg[s&&s.dstAlpha||Fe.ONE_MINUS_SRC_ALPHA]},equation:{rgb:xx[l&&l.rgb||Fe.FUNC_ADD],alpha:xx[l&&l.alpha||Fe.FUNC_ADD]},color:m}}},{key:"getStencilDrawParams",value:function(r){var n=r.stencil,i=n||{},a=i.enable,s=i.mask,l=s===void 0?-1:s,p=i.func,m=p===void 0?{cmp:Fe.ALWAYS,ref:0,mask:-1}:p,T=i.opFront,R=T===void 0?{fail:Fe.KEEP,zfail:Fe.KEEP,zpass:Fe.KEEP}:T,L=i.opBack,z=L===void 0?{fail:Fe.KEEP,zfail:Fe.KEEP,zpass:Fe.KEEP}:L;return{enable:!!a,mask:l,func:(0,Q.Z)((0,Q.Z)({},m),{},{cmp:C6[m.cmp]}),opFront:{fail:Tp[R.fail],zfail:Tp[R.zfail],zpass:Tp[R.zpass]},opBack:{fail:Tp[z.fail],zfail:Tp[z.zfail],zpass:Tp[z.zpass]}}}},{key:"getColorMaskDrawParams",value:function(r,n){var i=r.stencil,a=i!=null&&i.enable&&i.opFront&&!n?[!1,!1,!1,!1]:[!0,!0,!0,!0];return a}},{key:"initCullDrawParams",value:function(r,n){var i=r.cull;if(i){var a=i.enable,s=i.face,l=s===void 0?Fe.BACK:s;n.cull={enable:!!a,face:b6[l]}}}},{key:"extractUniforms",value:function(r){var n=this,i={};return Object.keys(r).forEach(function(a){n.extractUniformsRecursively(a,r[a],i,"")}),i}},{key:"extractUniformsRecursively",value:function(r,n,i,a){var s=this;if(n===null||typeof n=="number"||typeof n=="boolean"||Array.isArray(n)&&typeof n[0]=="number"||ID(n)||n===""||"resize"in n){i["".concat(a&&a+".").concat(r)]=n;return}wD(n)&&Object.keys(n).forEach(function(l){s.extractUniformsRecursively(l,n[l],i,"".concat(a&&a+".").concat(r))}),Array.isArray(n)&&n.forEach(function(l,p){Object.keys(l).forEach(function(m){s.extractUniformsRecursively(m,l[m],i,"".concat(a&&a+".").concat(r,"[").concat(p,"]"))})})}}]),e}(),OD=function(){function e(t,r){(0,ue.Z)(this,e),(0,ve.Z)(this,"isDestroy",!1);var n=r.data,i=r.type,a=i===void 0?Fe.UNSIGNED_BYTE:i,s=r.width,l=r.height,p=r.flipY,m=p===void 0?!1:p,T=r.format,R=T===void 0?Fe.RGBA:T,L=r.mipmap,z=L===void 0?!1:L,re=r.wrapS,ee=re===void 0?Fe.CLAMP_TO_EDGE:re,me=r.wrapT,Ie=me===void 0?Fe.CLAMP_TO_EDGE:me,He=r.aniso,Xe=He===void 0?0:He,ot=r.alignment,pt=ot===void 0?1:ot,dt=r.premultiplyAlpha,It=dt===void 0?!1:dt,Vt=r.mag,Kt=Vt===void 0?Fe.NEAREST:Vt,yr=r.min,_r=yr===void 0?Fe.NEAREST:yr,Hr=r.colorSpace,nn=Hr===void 0?Fe.BROWSER_DEFAULT_WEBGL:Hr,Tn=r.x,sa=Tn===void 0?0:Tn,Fo=r.y,jo=Fo===void 0?0:Fo,As=r.copy,vu=As===void 0?!1:As;this.width=s,this.height=l;var ef={width:s,height:l,type:O_[a],format:E6[R],wrapS:Sx[ee],wrapT:Sx[Ie],mag:Ex[Kt],min:Ex[_r],alignment:pt,flipY:m,colorSpace:x6[nn],premultiplyAlpha:It,aniso:Xe,x:sa,y:jo,copy:vu};n&&(ef.data=n),typeof z=="number"?ef.mipmap=S6[z]:typeof z=="boolean"&&(ef.mipmap=z),this.texture=t.texture(ef)}return(0,_e.Z)(e,[{key:"get",value:function(){return this.texture}},{key:"update",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.texture(r)}},{key:"bind",value:function(){this.texture._texture.bind()}},{key:"resize",value:function(r){var n=r.width,i=r.height;this.texture.resize(n,i),this.width=n,this.height=i}},{key:"getSize",value:function(){return[this.width,this.height]}},{key:"destroy",value:function(){if(!this.isDestroy){var r;(r=this.texture)===null||r===void 0||r.destroy()}this.isDestroy=!0}}]),e}(),rT,nT,ND=(rT=(0,Tt.b2)(),rT(nT=function(){function e(){var t=this;(0,ue.Z)(this,e),(0,ve.Z)(this,"uniformBuffers",[]),(0,ve.Z)(this,"createModel",function(r){return new PD(t.gl,r)}),(0,ve.Z)(this,"createAttribute",function(r){return new _6(t.gl,r)}),(0,ve.Z)(this,"createBuffer",function(r){return new R6(t.gl,r)}),(0,ve.Z)(this,"createElements",function(r){return new M6(t.gl,r)}),(0,ve.Z)(this,"createTexture2D",function(r){return new OD(t.gl,r)}),(0,ve.Z)(this,"createFramebuffer",function(r){return new w6(t.gl,r)}),(0,ve.Z)(this,"useFramebuffer",function(r,n){t.gl({framebuffer:r?r.get():null})(n)}),(0,ve.Z)(this,"clear",function(r){var n,i=r.color,a=r.depth,s=r.stencil,l=r.framebuffer,p=l===void 0?null:l,m={color:i,depth:a,stencil:s};m.framebuffer=p===null?p:p.get(),(n=t.gl)===null||n===void 0||n.clear(m)}),(0,ve.Z)(this,"viewport",function(r){var n=r.x,i=r.y,a=r.width,s=r.height;t.gl._gl.viewport(n,i,a,s),t.width=a,t.height=s,t.gl._refresh()}),(0,ve.Z)(this,"readPixels",function(r){var n=r.framebuffer,i=r.x,a=r.y,s=r.width,l=r.height,p={x:i,y:a,width:s,height:l};return n&&(p.framebuffer=n.get()),t.gl.read(p)}),(0,ve.Z)(this,"getViewportSize",function(){return{width:t.gl._gl.drawingBufferWidth,height:t.gl._gl.drawingBufferHeight}}),(0,ve.Z)(this,"getContainer",function(){var r;return(r=t.canvas)===null||r===void 0?void 0:r.parentElement}),(0,ve.Z)(this,"getCanvas",function(){return t.canvas}),(0,ve.Z)(this,"getGLContext",function(){return t.gl._gl}),(0,ve.Z)(this,"destroy",function(){var r;t.canvas=null,(r=t.gl)===null||r===void 0||(r=r._gl)===null||r===void 0||(r=r.getExtension("WEBGL_lose_context"))===null||r===void 0||r.loseContext(),t.gl.destroy(),t.gl=null})}return(0,_e.Z)(e,[{key:"init",value:function(){var t=(0,hr.Z)(it().mark(function n(i,a,s){var l=this;return it().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:if(this.canvas=i,!s){m.next=5;break}this.gl=s,m.next=8;break;case 5:return m.next=7,new Promise(function(T,R){m6()({canvas:l.canvas,attributes:{alpha:!0,antialias:a.antialias,premultipliedAlpha:!0,preserveDrawingBuffer:a.preserveDrawingBuffer,stencil:a.stencil},extensions:["OES_element_index_uint","OES_standard_derivatives","ANGLE_instanced_arrays"],optionalExtensions:["oes_texture_float_linear","OES_texture_float","EXT_texture_filter_anisotropic","EXT_blend_minmax","WEBGL_depth_texture","WEBGL_lose_context"],profile:!0,onDone:function(z,re){(z||!re)&&R(z),T(re)}})});case 7:this.gl=m.sent;case 8:this.extensionObject={OES_texture_float:this.testExtension("OES_texture_float")};case 9:case"end":return m.stop()}},n,this)}));function r(n,i,a){return t.apply(this,arguments)}return r}()},{key:"getPointSizeRange",value:function(){return this.gl._gl.getParameter(this.gl._gl.ALIASED_POINT_SIZE_RANGE)}},{key:"testExtension",value:function(r){return!!this.getGLContext().getExtension(r)}},{key:"setState",value:function(){this.gl({cull:{enable:!1,face:"back"},viewport:{x:0,y:0,height:this.width,width:this.height},blend:{enable:!0,equation:"add"},framebuffer:null}),this.gl._refresh()}},{key:"setBaseState",value:function(){this.gl({cull:{enable:!1,face:"back"},viewport:{x:0,y:0,height:this.width,width:this.height},blend:{enable:!1,equation:"add"},framebuffer:null}),this.gl._refresh()}},{key:"setCustomLayerDefaults",value:function(){var r=this.getGLContext();r.disable(r.CULL_FACE)}},{key:"setDirty",value:function(r){this.isDirty=r}},{key:"getDirty",value:function(){return this.isDirty}},{key:"beginFrame",value:function(){}},{key:"endFrame",value:function(){}}]),e}())||nT),DD=function(){function e(t,r){(0,ue.Z)(this,e);var n=r.buffer,i=r.offset,a=r.stride,s=r.normalized,l=r.size,p=r.divisor,m=r.shaderLocation;this.buffer=n,this.attribute={shaderLocation:m,buffer:n.get(),offset:i||0,stride:a||0,normalized:s||!1,divisor:p||0},l&&(this.attribute.size=l)}return(0,_e.Z)(e,[{key:"get",value:function(){return this.buffer}},{key:"updateBuffer",value:function(r){this.buffer.subData(r)}},{key:"destroy",value:function(){this.buffer.destroy()}}]),e}(),Ph,j0,kp,Hd,Wd,g0,Wg,EA,Tl,jg=(Ph={},(0,ve.Z)(Ph,Fe.FLOAT,Float32Array),(0,ve.Z)(Ph,Fe.UNSIGNED_BYTE,Uint8Array),(0,ve.Z)(Ph,Fe.SHORT,Int16Array),(0,ve.Z)(Ph,Fe.UNSIGNED_SHORT,Uint16Array),(0,ve.Z)(Ph,Fe.INT,Int32Array),(0,ve.Z)(Ph,Fe.UNSIGNED_INT,Uint32Array),Ph),LD=(j0={},(0,ve.Z)(j0,Fe.POINTS,nu.POINTS),(0,ve.Z)(j0,Fe.LINES,nu.LINES),(0,ve.Z)(j0,Fe.LINE_LOOP,nu.LINES),(0,ve.Z)(j0,Fe.LINE_STRIP,nu.LINE_STRIP),(0,ve.Z)(j0,Fe.TRIANGLES,nu.TRIANGLES),(0,ve.Z)(j0,Fe.TRIANGLE_FAN,nu.TRIANGLES),(0,ve.Z)(j0,Fe.TRIANGLE_STRIP,nu.TRIANGLE_STRIP),j0),FD=(kp={},(0,ve.Z)(kp,1,Jt.F32_R),(0,ve.Z)(kp,2,Jt.F32_RG),(0,ve.Z)(kp,3,Jt.F32_RGB),(0,ve.Z)(kp,4,Jt.F32_RGBA),kp),BD=(Hd={},(0,ve.Z)(Hd,Fe.STATIC_DRAW,jf.STATIC),(0,ve.Z)(Hd,Fe.DYNAMIC_DRAW,jf.DYNAMIC),(0,ve.Z)(Hd,Fe.STREAM_DRAW,jf.DYNAMIC),Hd),iT=(Wd={},(0,ve.Z)(Wd,Fe.REPEAT,ac.REPEAT),(0,ve.Z)(Wd,Fe.CLAMP_TO_EDGE,ac.CLAMP_TO_EDGE),(0,ve.Z)(Wd,Fe.MIRRORED_REPEAT,ac.MIRRORED_REPEAT),Wd),kD=(g0={},(0,ve.Z)(g0,Fe.NEVER,Ga.NEVER),(0,ve.Z)(g0,Fe.ALWAYS,Ga.ALWAYS),(0,ve.Z)(g0,Fe.LESS,Ga.LESS),(0,ve.Z)(g0,Fe.LEQUAL,Ga.LEQUAL),(0,ve.Z)(g0,Fe.GREATER,Ga.GREATER),(0,ve.Z)(g0,Fe.GEQUAL,Ga.GEQUAL),(0,ve.Z)(g0,Fe.EQUAL,Ga.EQUAL),(0,ve.Z)(g0,Fe.NOTEQUAL,Ga.NOTEQUAL),g0),UD=(Wg={},(0,ve.Z)(Wg,Fe.FRONT,wc.FRONT),(0,ve.Z)(Wg,Fe.BACK,wc.BACK),Wg),aT=(EA={},(0,ve.Z)(EA,Fe.FUNC_ADD,Sl.ADD),(0,ve.Z)(EA,Fe.MIN_EXT,Sl.MIN),(0,ve.Z)(EA,Fe.MAX_EXT,Sl.MAX),(0,ve.Z)(EA,Fe.FUNC_SUBTRACT,Sl.SUBSTRACT),(0,ve.Z)(EA,Fe.FUNC_REVERSE_SUBTRACT,Sl.REVERSE_SUBSTRACT),EA),Xg=(Tl={},(0,ve.Z)(Tl,Fe.ZERO,Ia.ZERO),(0,ve.Z)(Tl,Fe.ONE,Ia.ONE),(0,ve.Z)(Tl,Fe.SRC_COLOR,Ia.SRC),(0,ve.Z)(Tl,Fe.ONE_MINUS_SRC_COLOR,Ia.ONE_MINUS_SRC),(0,ve.Z)(Tl,Fe.SRC_ALPHA,Ia.SRC_ALPHA),(0,ve.Z)(Tl,Fe.ONE_MINUS_SRC_ALPHA,Ia.ONE_MINUS_SRC_ALPHA),(0,ve.Z)(Tl,Fe.DST_COLOR,Ia.DST),(0,ve.Z)(Tl,Fe.ONE_MINUS_DST_COLOR,Ia.ONE_MINUS_DST),(0,ve.Z)(Tl,Fe.DST_ALPHA,Ia.DST_ALPHA),(0,ve.Z)(Tl,Fe.ONE_MINUS_DST_ALPHA,Ia.ONE_MINUS_DST_ALPHA),(0,ve.Z)(Tl,Fe.CONSTANT_COLOR,Ia.CONST),(0,ve.Z)(Tl,Fe.ONE_MINUS_CONSTANT_COLOR,Ia.ONE_MINUS_CONSTANT),(0,ve.Z)(Tl,Fe.CONSTANT_ALPHA,Ia.CONST),(0,ve.Z)(Tl,Fe.ONE_MINUS_CONSTANT_ALPHA,Ia.ONE_MINUS_CONSTANT),(0,ve.Z)(Tl,Fe.SRC_ALPHA_SATURATE,Ia.SRC_ALPHA_SATURATE),Tl),ZD={"[object Int8Array]":5120,"[object Int16Array]":5122,"[object Int32Array]":5124,"[object Uint8Array]":5121,"[object Uint8ClampedArray]":5121,"[object Uint16Array]":5123,"[object Uint32Array]":5125,"[object Float32Array]":5126,"[object Float64Array]":5121,"[object ArrayBuffer]":5121};function Yg(e){return Object.prototype.toString.call(e)in ZD}var zD=function(){function e(t,r){(0,ue.Z)(this,e),(0,ve.Z)(this,"isDestroyed",!1);var n=r.data,i=r.usage,a=r.type,s=r.isUBO,l;Yg(n)?l=n:l=new jg[this.type||Fe.FLOAT](n),this.type=a,this.size=l.byteLength,this.buffer=t.createBuffer({viewOrSize:l,usage:s?To.UNIFORM:To.VERTEX,hint:BD[i||Fe.STATIC_DRAW]})}return(0,_e.Z)(e,[{key:"get",value:function(){return this.buffer}},{key:"destroy",value:function(){this.isDestroyed||this.buffer.destroy(),this.isDestroyed=!0}},{key:"subData",value:function(r){var n=r.data,i=r.offset,a;Yg(n)?a=n:a=new jg[this.type||Fe.FLOAT](n),this.buffer.setSubData(i,new Uint8Array(a.buffer))}}]),e}(),GD=function(){function e(t,r){(0,ue.Z)(this,e);var n=r.data,i=r.type,a=r.count,s=a===void 0?0:a,l;Yg(n)?l=n:l=new jg[this.type||Fe.UNSIGNED_INT](n),this.type=i,this.count=s,this.indexBuffer=t.createBuffer({viewOrSize:l,usage:To.INDEX})}return(0,_e.Z)(e,[{key:"get",value:function(){return this.indexBuffer}},{key:"subData",value:function(r){var n=r.data,i;Yg(n)?i=n:i=new jg[this.type||Fe.UNSIGNED_INT](n),this.indexBuffer.setSubData(0,new Uint8Array(i.buffer))}},{key:"destroy",value:function(){this.indexBuffer.destroy()}}]),e}();function VD(e){return!1}var HD=function(){function e(t,r){(0,ue.Z)(this,e),(0,ve.Z)(this,"isDestroy",!1);var n=r.data,i=r.type,a=i===void 0?Fe.UNSIGNED_BYTE:i,s=r.width,l=r.height,p=r.flipY,m=p===void 0?!1:p,T=r.format,R=T===void 0?Fe.RGBA:T,L=r.wrapS,z=L===void 0?Fe.CLAMP_TO_EDGE:L,re=r.wrapT,ee=re===void 0?Fe.CLAMP_TO_EDGE:re,me=r.alignment,Ie=me===void 0?1:me;this.width=s,this.height=l;var He=Jt.U8_RGBA_RT;if(a===Fe.UNSIGNED_BYTE&&R===Fe.RGBA)He=Jt.U8_RGBA_RT;else if(R===Fe.LUMINANCE&&a===Fe.FLOAT)He=Jt.F32_LUMINANCE;else if(R===Fe.LUMINANCE&&a===Fe.UNSIGNED_BYTE)He=Jt.U8_LUMINANCE;else throw new Error("create texture error, type: ".concat(a,", format: ").concat(R));this.texture=t.createTexture({format:He,width:s,height:l,usage:Kc.SAMPLED,pixelStore:{unpackFlipY:m,packAlignment:Ie}}),n&&this.texture.setImageData([n]),this.sampler=t.createSampler({addressModeU:iT[z],addressModeV:iT[ee],minFilter:ru.POINT,magFilter:ru.BILINEAR,mipmapFilter:bu.NO_MIP,lodMinClamp:0,lodMaxClamp:0})}return(0,_e.Z)(e,[{key:"get",value:function(){return this.texture}},{key:"update",value:function(r){var n=r.data;this.texture.setImageData([n])}},{key:"bind",value:function(){}},{key:"resize",value:function(r){var n=r.width,i=r.height;this.width=n,this.height=i}},{key:"getSize",value:function(){return[this.width,this.height]}},{key:"destroy",value:function(){if(!this.isDestroy){var r;(r=this.texture)===null||r===void 0||r.destroy()}this.isDestroy=!0}}]),e}(),WD=function(){function e(t,r){(0,ue.Z)(this,e),this.device=t;var n=r.width,i=r.height,a=r.color;VD(a)?(this.renderTarget=t.createRenderTargetFromTexture(a.get()),this.width=a.width,this.height=a.height):n&&i&&(this.renderTarget=t.createRenderTarget({format:Jt.U8_RGBA_RT,width:n,height:i}),this.width=n,this.height=i)}return(0,_e.Z)(e,[{key:"get",value:function(){return this.renderTarget}},{key:"destroy",value:function(){this.renderTarget.destroy()}},{key:"resize",value:function(r){var n=r.width,i=r.height;(this.width!==n||this.height!==i)&&(this.renderTarget&&this.renderTarget.destroy(),this.renderTarget=this.device.createRenderTarget({format:Jt.U8_RGBA_RT,width:n,height:i}),this.width=n,this.height=i)}}]),e}(),jD=Fn.isPlainObject,XD=Fn.isTypedArray,YD=function(){function e(t,r){var n=this;(0,ue.Z)(this,e),(0,ve.Z)(this,"destroyed",!1),(0,ve.Z)(this,"uniforms",{}),(0,ve.Z)(this,"vertexBuffers",[]),this.device=t,this.options=r;var i=r.vs,a=r.fs,s=r.attributes,l=r.uniforms,p=r.count,m=r.elements;this.options=r;var T=t.createProgram({vertex:{glsl:i},fragment:{glsl:a}});this.program=T,l&&(this.uniforms=this.extractUniforms(l));var R=[],L=0;Object.keys(s).forEach(function(re){var ee=s[re],me=ee.get();n.vertexBuffers.push(me.get());var Ie=ee.attribute,He=Ie.offset,Xe=He===void 0?0:He,ot=Ie.stride,pt=ot===void 0?0:ot,dt=Ie.size,It=dt===void 0?1:dt,Vt=Ie.divisor,Kt=Vt===void 0?0:Vt,yr=Ie.shaderLocation,_r=yr===void 0?0:yr;R.push({arrayStride:pt||It*4,stepMode:mA.VERTEX,attributes:[{format:FD[It],shaderLocation:_r,offset:Xe,divisor:Kt}]}),L=me.size/It}),p||(this.options.count=L),m&&(this.indexBuffer=m.get());var z=t.createInputLayout({vertexBufferDescriptors:R,indexBufferFormat:m?Jt.U32_R:null,program:T});this.inputLayout=z,this.pipeline=this.createPipeline(r)}return(0,_e.Z)(e,[{key:"createPipeline",value:function(r){var n=r.primitive,i=n===void 0?Fe.TRIANGLES:n,a=r.depth,s=r.cull,l=r.blend,p=this.initDepthDrawParams({depth:a}),m=!!(p&&p.enable),T=this.initCullDrawParams({cull:s}),R=!!(T&&T.enable),L=this.getBlendDrawParams({blend:l}),z=!!(L&&L.enable);return this.device.createRenderPipeline({inputLayout:this.inputLayout,program:this.program,topology:LD[i],colorAttachmentFormats:[Jt.U8_RGBA_RT],depthStencilAttachmentFormat:Jt.D24_S8,megaStateDescriptor:{attachmentsState:[{channelWriteMask:xl.ALL,rgbBlendState:{blendMode:z&&L.equation.rgb||Sl.ADD,blendSrcFactor:z&&L.func.srcRGB||Ia.SRC_ALPHA,blendDstFactor:z&&L.func.dstRGB||Ia.ONE_MINUS_SRC_ALPHA},alphaBlendState:{blendMode:z&&L.equation.alpha||Sl.ADD,blendSrcFactor:z&&L.func.srcAlpha||Ia.ONE,blendDstFactor:z&&L.func.dstAlpha||Ia.ONE_MINUS_SRC_ALPHA}}],blendConstant:N_,depthWrite:m,depthCompare:m&&p.func||Ga.LESS,cullMode:R&&T.face||wc.NONE,stencilWrite:!1}})}},{key:"updateAttributesAndElements",value:function(){}},{key:"updateAttributes",value:function(){}},{key:"addUniforms",value:function(r){this.uniforms=(0,Q.Z)((0,Q.Z)({},this.uniforms),this.extractUniforms(r))}},{key:"draw",value:function(r){var n=(0,Q.Z)((0,Q.Z)({},this.options),r),i=n.count,a=i===void 0?0:i,s=n.instances,l=n.elements,p=n.uniforms,m=p===void 0?{}:p,T=n.uniformBuffers,R=n.textures;this.uniforms=(0,Q.Z)((0,Q.Z)({},this.uniforms),this.extractUniforms(m));var L=this.device,z=L.width,re=L.height,ee=this.device.renderPass;if(this.pipeline=this.createPipeline(n),ee.setPipeline(this.pipeline),ee.setVertexInput(this.inputLayout,this.vertexBuffers.map(function(Ie){return{buffer:Ie}}),l?{buffer:this.indexBuffer,offset:0}:null),ee.setViewport(0,0,z,re),T&&(this.bindings=this.device.createBindings({pipeline:this.pipeline,uniformBufferBindings:T.map(function(Ie,He){var Xe=Ie;return{binding:He,buffer:Xe.get(),size:Xe.size}}),samplerBindings:R==null?void 0:R.map(function(Ie){return{texture:Ie.texture,sampler:Ie.sampler}})})),this.bindings&&(ee.setBindings(this.bindings),this.program.setUniformsLegacy(this.uniforms)),l){var me=l.count;me===0?ee.draw(a,s):ee.drawIndexed(me,s)}else ee.draw(a,s)}},{key:"destroy",value:function(){var r,n,i;this.program.destroy(),(r=this.vertexBuffers)===null||r===void 0||r.forEach(function(a){return a.destroy()}),(n=this.indexBuffer)===null||n===void 0||n.destroy(),(i=this.bindings)===null||i===void 0||i.destroy(),this.inputLayout.destroy(),this.pipeline.destroy(),this.destroyed=!0}},{key:"initDepthDrawParams",value:function(r){var n=r.depth;if(n)return{enable:n.enable===void 0?!0:!!n.enable,mask:n.mask===void 0?!0:!!n.mask,func:kD[n.func||Fe.LESS],range:n.range||[0,1]}}},{key:"getBlendDrawParams",value:function(r){var n=r.blend,i=n||{},a=i.enable,s=i.func,l=i.equation,p=i.color,m=p===void 0?[0,0,0,0]:p;return{enable:!!a,func:{srcRGB:Xg[s&&s.srcRGB||Fe.SRC_ALPHA],srcAlpha:Xg[s&&s.srcAlpha||Fe.SRC_ALPHA],dstRGB:Xg[s&&s.dstRGB||Fe.ONE_MINUS_SRC_ALPHA],dstAlpha:Xg[s&&s.dstAlpha||Fe.ONE_MINUS_SRC_ALPHA]},equation:{rgb:aT[l&&l.rgb||Fe.FUNC_ADD],alpha:aT[l&&l.alpha||Fe.FUNC_ADD]},color:m}}},{key:"initCullDrawParams",value:function(r){var n=r.cull;if(n){var i=n.enable,a=n.face,s=a===void 0?Fe.BACK:a;return{enable:!!i,face:UD[s]}}}},{key:"extractUniforms",value:function(r){var n=this,i={};return Object.keys(r).forEach(function(a){n.extractUniformsRecursively(a,r[a],i,"")}),i}},{key:"extractUniformsRecursively",value:function(r,n,i,a){var s=this;if(n===null||typeof n=="number"||typeof n=="boolean"||Array.isArray(n)&&typeof n[0]=="number"||XD(n)||n===""||"resize"in n){i["".concat(a&&a+".").concat(r)]=n;return}jD(n)&&Object.keys(n).forEach(function(l){s.extractUniformsRecursively(l,n[l],i,"".concat(a&&a+".").concat(r))}),Array.isArray(n)&&n.forEach(function(l,p){Object.keys(l).forEach(function(m){s.extractUniformsRecursively(m,l[m],i,"".concat(a&&a+".").concat(r,"[").concat(p,"]"))})})}}]),e}();function $D(e){return typeof WebGL2RenderingContext!="undefined"&&e instanceof WebGL2RenderingContext?!0:!!(e&&e._version===2)}var oT,sT,QD=(oT=(0,Tt.b2)(),oT(sT=function(){function e(){var t=this;(0,ue.Z)(this,e),(0,ve.Z)(this,"uniformBuffers",[]),(0,ve.Z)(this,"createModel",function(r){return new YD(t.device,r)}),(0,ve.Z)(this,"createAttribute",function(r){return new DD(t.device,r)}),(0,ve.Z)(this,"createBuffer",function(r){return new zD(t.device,r)}),(0,ve.Z)(this,"createElements",function(r){return new GD(t.device,r)}),(0,ve.Z)(this,"createTexture2D",function(r){return new HD(t.device,r)}),(0,ve.Z)(this,"createFramebuffer",function(r){return new WD(t.device,r)}),(0,ve.Z)(this,"useFramebuffer",function(){}),(0,ve.Z)(this,"clear",function(){}),(0,ve.Z)(this,"viewport",function(r){var n=r.width,i=r.height;t.width=n,t.height=i,t.device.width=n,t.device.height=i}),(0,ve.Z)(this,"readPixels",function(){return new Uint8Array}),(0,ve.Z)(this,"getViewportSize",function(){return{width:t.device.width,height:t.device.height}}),(0,ve.Z)(this,"getContainer",function(){var r;return(r=t.canvas)===null||r===void 0?void 0:r.parentElement}),(0,ve.Z)(this,"getCanvas",function(){return t.canvas}),(0,ve.Z)(this,"getGLContext",function(){return t.device.gl}),(0,ve.Z)(this,"destroy",function(){var r;t.canvas=null,(r=t.uniformBuffers)===null||r===void 0||r.forEach(function(n){n.destroy()}),t.device.destroy()})}return(0,_e.Z)(e,[{key:"init",value:function(){var t=(0,hr.Z)(it().mark(function n(i,a){var s,l,p,m,T,R;return it().wrap(function(z){for(;;)switch(z.prev=z.next){case 0:return s=a.enableWebGPU,l=a.shaderCompilerPath,this.canvas=i,p=s?new MD({shaderCompilerPath:l}):new k5({targets:["webgl2","webgl1"],onContextLost:function(ee){console.warn("context lost",ee)},onContextCreationError:function(ee){console.warn("context creation error",ee)},onContextRestored:function(ee){console.warn("context restored",ee)}}),z.next=5,p.createSwapChain(i);case 5:m=z.sent,m.configureSwapChain(i.width,i.height),this.device=m.getDevice(),this.swapChain=m,T=this.device.gl,this.extensionObject={OES_texture_float:!$D(T)&&this.device.OES_texture_float},R=this.device.createTexture({format:Jt.U8_RGBA_RT,width:i.width,height:i.height,usage:Kc.RENDER_TARGET}),this.renderTarget=this.device.createRenderTargetFromTexture(R),this.mainDepthRT=this.device.createRenderTargetFromTexture(this.device.createTexture({format:Jt.D24_S8,width:i.width,height:i.height,usage:Kc.RENDER_TARGET}));case 14:case"end":return z.stop()}},n,this)}));function r(n,i){return t.apply(this,arguments)}return r}()},{key:"beginFrame",value:function(){var r=this.swapChain.getOnscreenTexture();this.renderPass=this.device.createRenderPass({colorAttachment:[this.renderTarget],colorResolveTo:[r],colorClearColor:[N_],depthStencilAttachment:this.mainDepthRT,depthClearValue:1}),this.device.renderPass=this.renderPass}},{key:"endFrame",value:function(){this.device.submitPass(this.renderPass)}},{key:"getPointSizeRange",value:function(){var r=this.device.gl;return r.getParameter(r.ALIASED_POINT_SIZE_RANGE)}},{key:"testExtension",value:function(r){return!!this.getGLContext().getExtension(r)}},{key:"setState",value:function(){}},{key:"setBaseState",value:function(){}},{key:"setCustomLayerDefaults",value:function(){}},{key:"setDirty",value:function(r){this.isDirty=r}},{key:"getDirty",value:function(){return this.isDirty}}]),e}())||sT);function qD(e){var t=KD();return function(){var n=(0,le.Z)(e),i;if(t){var a=(0,le.Z)(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return(0,ze.Z)(this,i)}}function KD(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var V_=["selectstart","selecting","selectend"],JD=function(e){(0,ke.Z)(r,e);var t=qD(r);function r(n){var i,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return(0,ue.Z)(this,r),i=t.call(this),(0,ve.Z)((0,St.Z)(i),"isEnable",!1),(0,ve.Z)((0,St.Z)(i),"onDragStart",function(s){i.box.style.display="block",i.startEvent=i.endEvent=s,i.syncBoxBound(),i.emit("selectstart",i.getLngLatBox(),i.startEvent,i.endEvent)}),(0,ve.Z)((0,St.Z)(i),"onDragging",function(s){i.endEvent=s,i.syncBoxBound(),i.emit("selecting",i.getLngLatBox(),i.startEvent,i.endEvent)}),(0,ve.Z)((0,St.Z)(i),"onDragEnd",function(s){i.endEvent=s,i.box.style.display="none",i.emit("selectend",i.getLngLatBox(),i.startEvent,i.endEvent)}),i.scene=n,i.options=a,i}return(0,_e.Z)(r,[{key:"container",get:function(){return this.scene.getMapService().getMarkerContainer()}},{key:"enable",value:function(){if(!this.isEnable){var i=this.options.className;if(this.scene.setMapStatus({dragEnable:!1}),this.container.style.cursor="crosshair",!this.box){var a=wi("div",void 0,this.container);a.classList.add("l7-select-box"),i&&a.classList.add(i),a.style.display="none",this.box=a}this.scene.on("dragstart",this.onDragStart),this.scene.on("dragging",this.onDragging),this.scene.on("dragend",this.onDragEnd),this.isEnable=!0}}},{key:"disable",value:function(){this.isEnable&&(this.scene.setMapStatus({dragEnable:!0}),this.container.style.cursor="auto",this.scene.off("dragstart",this.onDragStart),this.scene.off("dragging",this.onDragging),this.scene.off("dragend",this.onDragEnd),this.isEnable=!1)}},{key:"syncBoxBound",value:function(){var i=this.startEvent,a=i.x,s=i.y,l=this.endEvent,p=l.x,m=l.y,T=Math.min(a,p),R=Math.min(s,m),L=Math.abs(a-p),z=Math.abs(s-m);this.box.style.top="".concat(R,"px"),this.box.style.left="".concat(T,"px"),this.box.style.width="".concat(L,"px"),this.box.style.height="".concat(z,"px")}},{key:"getLngLatBox",value:function(){var i=this.startEvent.lngLat,a=i.lng,s=i.lat,l=this.endEvent.lngLat,p=l.lng,m=l.lat;return Ac([[a,s],[p,m]])}}]),r}(Si.EventEmitter),e8=function(){function e(t){(0,ue.Z)(this,e);var r=t.id,n=t.map,i=t.canvas,a=t.hasBaseMap,s=t.renderer,l=s===void 0?"regl":s,p=z3();this.container=p,n.setContainer(p,r,i,a),p.bind(xt.IRendererService).to(l==="regl"?ND:QD).inSingletonScope(),this.sceneService=p.get(xt.ISceneService),this.mapService=p.get(xt.IMapService),this.iconService=p.get(xt.IIconService),this.fontService=p.get(xt.IFontService),this.controlService=p.get(xt.IControlService),this.layerService=p.get(xt.ILayerService),this.debugService=p.get(xt.IDebugService),this.debugService.setEnable(t.debug),this.markerService=p.get(xt.IMarkerService),this.interactionService=p.get(xt.IInteractionService),this.popupService=p.get(xt.IPopupService),this.boxSelect=new JD(this,{}),this.initComponent(r),this.sceneService.init(t),this.initControl()}return(0,_e.Z)(e,[{key:"map",get:function(){return this.mapService.map}},{key:"loaded",get:function(){return this.sceneService.loaded}},{key:"getServiceContainer",value:function(){return this.container}},{key:"getSize",value:function(){return this.mapService.getSize()}},{key:"getMinZoom",value:function(){return this.mapService.getMinZoom()}},{key:"getMaxZoom",value:function(){return this.mapService.getMaxZoom()}},{key:"getType",value:function(){return this.mapService.getType()}},{key:"getMapContainer",value:function(){return this.mapService.getMapContainer()}},{key:"getMapCanvasContainer",value:function(){return this.mapService.getMapCanvasContainer()}},{key:"getMapService",value:function(){return this.mapService}},{key:"getDebugService",value:function(){return this.debugService}},{key:"exportPng",value:function(){var t=(0,hr.Z)(it().mark(function n(i){return it().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.abrupt("return",this.sceneService.exportPng(i));case 1:case"end":return s.stop()}},n,this)}));function r(n){return t.apply(this,arguments)}return r}()},{key:"exportMap",value:function(){var t=(0,hr.Z)(it().mark(function n(i){return it().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.abrupt("return",this.sceneService.exportPng(i));case 1:case"end":return s.stop()}},n,this)}));function r(n){return t.apply(this,arguments)}return r}()},{key:"registerRenderService",value:function(r){var n=this;if(this.sceneService.loaded){var i=new r(this);i.init()}else this.on("loaded",function(){var a=new r(n);a.init()})}},{key:"setBgColor",value:function(r){this.mapService.setBgColor(r)}},{key:"addLayer",value:function(r){var n=this,i=pd(this.container);if(r.setContainer(i,this.container),this.sceneService.addLayer(r),r.inited){var a=this.initMask(r);this.addMask(a,r.id)}else r.on("inited",function(){var s=n.initMask(r);n.addMask(s,r.id)})}},{key:"initMask",value:function(r){var n=r.getLayerConfig(),i=n.mask,a=n.maskfence,s=n.maskColor,l=s===void 0?"#000":s,p=n.maskOpacity,m=p===void 0?0:p;if(!(!i||!a)){var T=new k2().source(a).shape("fill").style({color:l,opacity:m});return T}}},{key:"addMask",value:function(r,n){if(r){var i=this.getLayer(n);if(i){var a=pd(this.container);r.setContainer(a,this.container),i.addMaskLayer(r),this.sceneService.addMask(r)}else console.warn("parent layer not find!")}}},{key:"getPickedLayer",value:function(){return this.layerService.pickedLayerId}},{key:"getLayers",value:function(){return this.layerService.getLayers()}},{key:"getLayer",value:function(r){return this.layerService.getLayer(r)}},{key:"getLayerByName",value:function(r){return this.layerService.getLayerByName(r)}},{key:"removeLayer",value:function(){var t=(0,hr.Z)(it().mark(function n(i,a){return it().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.next=2,this.layerService.remove(i,a);case 2:case"end":return l.stop()}},n,this)}));function r(n,i){return t.apply(this,arguments)}return r}()},{key:"removeAllLayer",value:function(){var t=(0,hr.Z)(it().mark(function n(){return it().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,this.layerService.removeAllLayers();case 2:case"end":return a.stop()}},n,this)}));function r(){return t.apply(this,arguments)}return r}()},{key:"render",value:function(){this.sceneService.render()}},{key:"setEnableRender",value:function(r){this.layerService.setEnableRender(r)}},{key:"addIconFont",value:function(r,n){this.fontService.addIconFont(r,n)}},{key:"addIconFonts",value:function(r){var n=this;r.forEach(function(i){var a=(0,yn.Z)(i,2),s=a[0],l=a[1];n.fontService.addIconFont(s,l)})}},{key:"addFontFace",value:function(r,n){var i=this;this.fontService.once("fontloaded",function(a){i.emit("fontloaded",a)}),this.fontService.addFontFace(r,n)}},{key:"addImage",value:function(){var t=(0,hr.Z)(it().mark(function n(i,a){return it().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.next=2,this.iconService.addImage(i,a);case 2:case"end":return l.stop()}},n,this)}));function r(n,i){return t.apply(this,arguments)}return r}()},{key:"hasImage",value:function(r){return this.iconService.hasImage(r)}},{key:"removeImage",value:function(r){this.iconService.removeImage(r)}},{key:"addIconFontGlyphs",value:function(r,n){this.fontService.addIconGlyphs(n)}},{key:"addControl",value:function(r){this.controlService.addControl(r,this.container)}},{key:"removeControl",value:function(r){this.controlService.removeControl(r)}},{key:"getControlByName",value:function(r){return this.controlService.getControlByName(r)}},{key:"addMarker",value:function(r){this.markerService.addMarker(r)}},{key:"addMarkerLayer",value:function(r){this.markerService.addMarkerLayer(r)}},{key:"removeMarkerLayer",value:function(r){this.markerService.removeMarkerLayer(r)}},{key:"removeAllMarkers",value:function(){this.markerService.removeAllMarkers()}},{key:"removeAllMakers",value:function(){console.warn("removeAllMakers \u5DF2\u5E9F\u5F03\uFF0C\u8BF7\u4F7F\u7528 removeAllMarkers"),this.markerService.removeAllMarkers()}},{key:"addPopup",value:function(r){this.popupService.addPopup(r)}},{key:"removePopup",value:function(r){this.popupService.removePopup(r)}},{key:"on",value:function(r,n){if(V_.includes(r)){var i;(i=this.boxSelect)===null||i===void 0||i.on(r,n)}else qv.includes(r)?this.sceneService.on(r,n):this.mapService.on(r,n)}},{key:"once",value:function(r,n){if(V_.includes(r)){var i;(i=this.boxSelect)===null||i===void 0||i.once(r,n)}else qv.includes(r)?this.sceneService.once(r,n):this.mapService.once(r,n)}},{key:"emit",value:function(r,n){qv.indexOf(r)===-1?this.mapService.on(r,n):this.sceneService.emit(r,n)}},{key:"off",value:function(r,n){if(V_.includes(r)){var i;(i=this.boxSelect)===null||i===void 0||i.off(r,n)}else qv.includes(r)?this.sceneService.off(r,n):this.mapService.off(r,n)}},{key:"getZoom",value:function(){return this.mapService.getZoom()}},{key:"getCenter",value:function(r){return this.mapService.getCenter(r)}},{key:"setCenter",value:function(r,n){return this.mapService.setCenter(r,n)}},{key:"getPitch",value:function(){return this.mapService.getPitch()}},{key:"setPitch",value:function(r){return this.mapService.setPitch(r)}},{key:"getRotation",value:function(){return this.mapService.getRotation()}},{key:"getBounds",value:function(){return this.mapService.getBounds()}},{key:"setRotation",value:function(r){this.mapService.setRotation(r)}},{key:"zoomIn",value:function(){this.mapService.zoomIn()}},{key:"zoomOut",value:function(){this.mapService.zoomOut()}},{key:"panTo",value:function(r){this.mapService.panTo(r)}},{key:"panBy",value:function(r,n){this.mapService.panBy(r,n)}},{key:"getContainer",value:function(){return this.mapService.getContainer()}},{key:"setZoom",value:function(r){this.mapService.setZoom(r)}},{key:"fitBounds",value:function(r,n){var i=this.sceneService.getSceneConfig(),a=i.fitBoundsOptions,s=i.animate;this.mapService.fitBounds(r,n||(0,Q.Z)((0,Q.Z)({},a),{},{animate:s}))}},{key:"setZoomAndCenter",value:function(r,n){this.mapService.setZoomAndCenter(r,n)}},{key:"setMapStyle",value:function(r){this.mapService.setMapStyle(r)}},{key:"setMapStatus",value:function(r){this.mapService.setMapStatus(r)}},{key:"pixelToLngLat",value:function(r){return this.mapService.pixelToLngLat(r)}},{key:"lngLatToPixel",value:function(r){return this.mapService.lngLatToPixel(r)}},{key:"containerToLngLat",value:function(r){return this.mapService.containerToLngLat(r)}},{key:"lngLatToContainer",value:function(r){return this.mapService.lngLatToContainer(r)}},{key:"destroy",value:function(){this.sceneService.destroy()}},{key:"registerPostProcessingPass",value:function(r,n){this.container.bind(xt.IPostProcessingPass).to(r).whenTargetNamed(n)}},{key:"enableShaderPick",value:function(){this.layerService.enableShaderPick()}},{key:"diasbleShaderPick",value:function(){this.layerService.disableShaderPick()}},{key:"enableBoxSelect",value:function(){var r=this,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.boxSelect.enable(),n&&this.boxSelect.once("selectend",function(){r.disableBoxSelect()})}},{key:"disableBoxSelect",value:function(){this.boxSelect.disable()}},{key:"getProtocol",value:function(r){return fn.REGISTERED_PROTOCOLS[r]}},{key:"getPointSizeRange",value:function(){return this.sceneService.getPointSizeRange()}},{key:"initComponent",value:function(r){this.controlService.init({container:Ys(r)},this.container),this.markerService.init(this.container),this.popupService.init(this.container)}},{key:"initControl",value:function(){var r=this.sceneService.getSceneConfig(),n=r.logoVisible,i=r.logoPosition;n&&this.addControl(new hb({position:i}))}}],[{key:"addProtocol",value:function(r,n){fn.REGISTERED_PROTOCOLS[r]=n}},{key:"removeProtocol",value:function(r){delete fn.REGISTERED_PROTOCOLS[r]}}]),e}(),kF="2.20.0"},19947:function(ae){ae.exports=j;function j(D,G){var U=D&&D.type,B;if(U==="FeatureCollection")for(B=0;B<D.features.length;B++)j(D.features[B],G);else if(U==="GeometryCollection")for(B=0;B<D.geometries.length;B++)j(D.geometries[B],G);else if(U==="Feature")j(D.geometry,G);else if(U==="Polygon")C(D.coordinates,G);else if(U==="MultiPolygon")for(B=0;B<D.coordinates.length;B++)C(D.coordinates[B],G);return D}function C(D,G){if(D.length!==0){I(D[0],G);for(var U=1;U<D.length;U++)I(D[U],!G)}}function I(D,G){for(var U=0,B=0,Z=0,X=D.length,q=X-1;Z<X;q=Z++){var ie=(D[Z][0]-D[q][0])*(D[q][1]+D[Z][1]),he=U+ie;B+=Math.abs(U)>=Math.abs(ie)?U-he+ie:ie-he+U,U=he}U+B>=0!=!!G&&D.reverse()}},59263:function(ae){"use strict";ae.exports=j;function j(C,I){this.x=C,this.y=I}j.prototype={clone:function(){return new j(this.x,this.y)},add:function(C){return this.clone()._add(C)},sub:function(C){return this.clone()._sub(C)},multByPoint:function(C){return this.clone()._multByPoint(C)},divByPoint:function(C){return this.clone()._divByPoint(C)},mult:function(C){return this.clone()._mult(C)},div:function(C){return this.clone()._div(C)},rotate:function(C){return this.clone()._rotate(C)},rotateAround:function(C,I){return this.clone()._rotateAround(C,I)},matMult:function(C){return this.clone()._matMult(C)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(C){return this.x===C.x&&this.y===C.y},dist:function(C){return Math.sqrt(this.distSqr(C))},distSqr:function(C){var I=C.x-this.x,D=C.y-this.y;return I*I+D*D},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(C){return Math.atan2(this.y-C.y,this.x-C.x)},angleWith:function(C){return this.angleWithSep(C.x,C.y)},angleWithSep:function(C,I){return Math.atan2(this.x*I-this.y*C,this.x*C+this.y*I)},_matMult:function(C){var I=C[0]*this.x+C[1]*this.y,D=C[2]*this.x+C[3]*this.y;return this.x=I,this.y=D,this},_add:function(C){return this.x+=C.x,this.y+=C.y,this},_sub:function(C){return this.x-=C.x,this.y-=C.y,this},_mult:function(C){return this.x*=C,this.y*=C,this},_div:function(C){return this.x/=C,this.y/=C,this},_multByPoint:function(C){return this.x*=C.x,this.y*=C.y,this},_divByPoint:function(C){return this.x/=C.x,this.y/=C.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var C=this.y;return this.y=this.x,this.x=-C,this},_rotate:function(C){var I=Math.cos(C),D=Math.sin(C),G=I*this.x-D*this.y,U=D*this.x+I*this.y;return this.x=G,this.y=U,this},_rotateAround:function(C,I){var D=Math.cos(C),G=Math.sin(C),U=I.x+D*(this.x-I.x)-G*(this.y-I.y),B=I.y+G*(this.x-I.x)+D*(this.y-I.y);return this.x=U,this.y=B,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},j.convert=function(C){return C instanceof j?C:Array.isArray(C)?new j(C[0],C[1]):C}},52155:function(ae){"use strict";ae.exports=C,ae.exports.default=C;var j=1e20;function C(B,Z,X,q,ie,he){this.fontSize=B||24,this.buffer=Z===void 0?3:Z,this.cutoff=q||.25,this.fontFamily=ie||"sans-serif",this.fontWeight=he||"normal",this.radius=X||8;var Ce=this.size=this.fontSize+this.buffer*2,be=Ce+this.buffer*2;this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=Ce,this.ctx=this.canvas.getContext("2d"),this.ctx.font=this.fontWeight+" "+this.fontSize+"px "+this.fontFamily,this.ctx.textAlign="left",this.ctx.fillStyle="black",this.gridOuter=new Float64Array(be*be),this.gridInner=new Float64Array(be*be),this.f=new Float64Array(be),this.z=new Float64Array(be+1),this.v=new Uint16Array(be),this.useMetrics=this.ctx.measureText("A").actualBoundingBoxLeft!==void 0,this.middle=Math.round(Ce/2*(navigator.userAgent.indexOf("Gecko/")>=0?1.2:1))}function I(B,Z,X,q,ie,he,Ce){he.fill(j,0,Z*X),Ce.fill(0,0,Z*X);for(var be=(Z-q)/2,Ze=0;Ze<ie;Ze++)for(var qe=0;qe<q;qe++){var De=(Ze+be)*Z+qe+be,Ge=B.data[4*(Ze*q+qe)+3]/255;if(Ge===1)he[De]=0,Ce[De]=j;else if(Ge===0)he[De]=j,Ce[De]=0;else{var Re=Math.max(0,.5-Ge),Me=Math.max(0,Ge-.5);he[De]=Re*Re,Ce[De]=Me*Me}}}function D(B,Z,X,q,ie,he,Ce){for(var be=0;be<Z*X;be++){var Ze=Math.sqrt(q[be])-Math.sqrt(ie[be]);B[be]=Math.round(255-255*(Ze/he+Ce))}}C.prototype._draw=function(B,Z){var X=this.ctx.measureText(B),q=X.width,ie=2*this.buffer,he,Ce,be,Ze,qe,De,Ge,Re;Z&&this.useMetrics?(qe=Math.floor(X.actualBoundingBoxAscent),Re=this.buffer+Math.ceil(X.actualBoundingBoxAscent),De=this.buffer,Ge=this.buffer,Ce=Math.min(this.size,Math.ceil(X.actualBoundingBoxRight-X.actualBoundingBoxLeft)),Ze=Math.min(this.size-De,Math.ceil(X.actualBoundingBoxAscent+X.actualBoundingBoxDescent)),he=Ce+ie,be=Ze+ie,this.ctx.textBaseline="alphabetic"):(he=Ce=this.size,be=Ze=this.size,qe=19*this.fontSize/24,De=Ge=0,Re=this.middle,this.ctx.textBaseline="middle");var Me;Ce&&Ze&&(this.ctx.clearRect(Ge,De,Ce,Ze),this.ctx.fillText(B,this.buffer,Re),Me=this.ctx.getImageData(Ge,De,Ce,Ze));var ce=new Uint8ClampedArray(he*be);return I(Me,he,be,Ce,Ze,this.gridOuter,this.gridInner),G(this.gridOuter,he,be,this.f,this.v,this.z),G(this.gridInner,he,be,this.f,this.v,this.z),D(ce,he,be,this.gridOuter,this.gridInner,this.radius,this.cutoff),{data:ce,metrics:{width:Ce,height:Ze,sdfWidth:he,sdfHeight:be,top:qe,left:0,advance:q}}},C.prototype.draw=function(B){return this._draw(B,!1).data},C.prototype.drawWithMetrics=function(B){return this._draw(B,!0)};function G(B,Z,X,q,ie,he){for(var Ce=0;Ce<Z;Ce++)U(B,Ce,Z,X,q,ie,he);for(var be=0;be<X;be++)U(B,be*Z,1,Z,q,ie,he)}function U(B,Z,X,q,ie,he,Ce){var be,Ze,qe,De;for(he[0]=0,Ce[0]=-j,Ce[1]=j,be=0;be<q;be++)ie[be]=B[Z+be*X];for(be=1,Ze=0,qe=0;be<q;be++){do De=he[Ze],qe=(ie[be]-ie[De]+be*be-De*De)/(be-De)/2;while(qe<=Ce[Ze]&&--Ze>-1);Ze++,he[Ze]=be,Ce[Ze]=qe,Ce[Ze+1]=j}for(be=0,Ze=0;be<q;be++){for(;Ce[Ze+1]<be;)Ze++;De=he[Ze],B[Z+be*X]=ie[De]+(be-De)*(be-De)}}},8332:function(ae,j,C){ae.exports.VectorTile=C(29148),C(82442),C(37815)},29148:function(ae,j,C){"use strict";var I=C(37815);ae.exports=D;function D(U,B){this.layers=U.readFields(G,{},B)}function G(U,B,Z){if(U===3){var X=new I(Z,Z.readVarint()+Z.pos);X.length&&(B[X.name]=X)}}},82442:function(ae,j,C){"use strict";var I=C(59263);ae.exports=D;function D(X,q,ie,he,Ce){this.properties={},this.extent=ie,this.type=0,this._pbf=X,this._geometry=-1,this._keys=he,this._values=Ce,X.readFields(G,this,q)}function G(X,q,ie){X==1?q.id=ie.readVarint():X==2?U(ie,q):X==3?q.type=ie.readVarint():X==4&&(q._geometry=ie.pos)}function U(X,q){for(var ie=X.readVarint()+X.pos;X.pos<ie;){var he=q._keys[X.readVarint()],Ce=q._values[X.readVarint()];q.properties[he]=Ce}}D.types=["Unknown","Point","LineString","Polygon"],D.prototype.loadGeometry=function(){var X=this._pbf;X.pos=this._geometry;for(var q=X.readVarint()+X.pos,ie=1,he=0,Ce=0,be=0,Ze=[],qe;X.pos<q;){if(he<=0){var De=X.readVarint();ie=De&7,he=De>>3}if(he--,ie===1||ie===2)Ce+=X.readSVarint(),be+=X.readSVarint(),ie===1&&(qe&&Ze.push(qe),qe=[]),qe.push(new I(Ce,be));else if(ie===7)qe&&qe.push(qe[0].clone());else throw new Error("unknown command "+ie)}return qe&&Ze.push(qe),Ze},D.prototype.bbox=function(){var X=this._pbf;X.pos=this._geometry;for(var q=X.readVarint()+X.pos,ie=1,he=0,Ce=0,be=0,Ze=1/0,qe=-1/0,De=1/0,Ge=-1/0;X.pos<q;){if(he<=0){var Re=X.readVarint();ie=Re&7,he=Re>>3}if(he--,ie===1||ie===2)Ce+=X.readSVarint(),be+=X.readSVarint(),Ce<Ze&&(Ze=Ce),Ce>qe&&(qe=Ce),be<De&&(De=be),be>Ge&&(Ge=be);else if(ie!==7)throw new Error("unknown command "+ie)}return[Ze,De,qe,Ge]},D.prototype.toGeoJSON=function(X,q,ie){var he=this.extent*Math.pow(2,ie),Ce=this.extent*X,be=this.extent*q,Ze=this.loadGeometry(),qe=D.types[this.type],De,Ge;function Re(Be){for(var Ee=0;Ee<Be.length;Ee++){var Se=Be[Ee],oe=180-(Se.y+be)*360/he;Be[Ee]=[(Se.x+Ce)*360/he-180,360/Math.PI*Math.atan(Math.exp(oe*Math.PI/180))-90]}}switch(this.type){case 1:var Me=[];for(De=0;De<Ze.length;De++)Me[De]=Ze[De][0];Ze=Me,Re(Ze);break;case 2:for(De=0;De<Ze.length;De++)Re(Ze[De]);break;case 3:for(Ze=B(Ze),De=0;De<Ze.length;De++)for(Ge=0;Ge<Ze[De].length;Ge++)Re(Ze[De][Ge]);break}Ze.length===1?Ze=Ze[0]:qe="Multi"+qe;var ce={type:"Feature",geometry:{type:qe,coordinates:Ze},properties:this.properties};return"id"in this&&(ce.id=this.id),ce};function B(X){var q=X.length;if(q<=1)return[X];for(var ie=[],he,Ce,be=0;be<q;be++){var Ze=Z(X[be]);Ze!==0&&(Ce===void 0&&(Ce=Ze<0),Ce===Ze<0?(he&&ie.push(he),he=[X[be]]):he.push(X[be]))}return he&&ie.push(he),ie}function Z(X){for(var q=0,ie=0,he=X.length,Ce=he-1,be,Ze;ie<he;Ce=ie++)be=X[ie],Ze=X[Ce],q+=(Ze.x-be.x)*(be.y+Ze.y);return q}},37815:function(ae,j,C){"use strict";var I=C(82442);ae.exports=D;function D(B,Z){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=B,this._keys=[],this._values=[],this._features=[],B.readFields(G,this,Z),this.length=this._features.length}function G(B,Z,X){B===15?Z.version=X.readVarint():B===1?Z.name=X.readString():B===5?Z.extent=X.readVarint():B===2?Z._features.push(X.pos):B===3?Z._keys.push(X.readString()):B===4&&Z._values.push(U(X))}function U(B){for(var Z=null,X=B.readVarint()+B.pos;B.pos<X;){var q=B.readVarint()>>3;Z=q===1?B.readString():q===2?B.readFloat():q===3?B.readDouble():q===4?B.readVarint64():q===5?B.readVarint():q===6?B.readSVarint():q===7?B.readBoolean():null}return Z}D.prototype.feature=function(B){if(B<0||B>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[B];var Z=this._pbf.readVarint()+this._pbf.pos;return new I(this._pbf,Z,this.extent,this._keys,this._values)}},76314:function(ae,j,C){"use strict";var I;I={value:!0};var D=C(9750);function G(U){var B=[1/0,1/0,-1/0,-1/0];return D.coordEach(U,function(Z){B[0]>Z[0]&&(B[0]=Z[0]),B[1]>Z[1]&&(B[1]=Z[1]),B[2]<Z[0]&&(B[2]=Z[0]),B[3]<Z[1]&&(B[3]=Z[1])}),B}G.default=G,j.Z=G},78161:function(ae,j){"use strict";Object.defineProperty(j,"__esModule",{value:!0}),j.earthRadius=63710088e-1,j.factors={centimeters:j.earthRadius*100,centimetres:j.earthRadius*100,degrees:j.earthRadius/111325,feet:j.earthRadius*3.28084,inches:j.earthRadius*39.37,kilometers:j.earthRadius/1e3,kilometres:j.earthRadius/1e3,meters:j.earthRadius,metres:j.earthRadius,miles:j.earthRadius/1609.344,millimeters:j.earthRadius*1e3,millimetres:j.earthRadius*1e3,nauticalmiles:j.earthRadius/1852,radians:1,yards:j.earthRadius*1.0936},j.unitsFactors={centimeters:100,centimetres:100,degrees:1/111325,feet:3.28084,inches:39.37,kilometers:1/1e3,kilometres:1/1e3,meters:1,metres:1,miles:1/1609.344,millimeters:1e3,millimetres:1e3,nauticalmiles:1/1852,radians:1/j.earthRadius,yards:1.0936133},j.areaFactors={acres:247105e-9,centimeters:1e4,centimetres:1e4,feet:10.763910417,hectares:1e-4,inches:1550.003100006,kilometers:1e-6,kilometres:1e-6,meters:1,metres:1,miles:386e-9,millimeters:1e6,millimetres:1e6,yards:1.195990046};function C(ge,xe,ye){ye===void 0&&(ye={});var Q={type:"Feature"};return(ye.id===0||ye.id)&&(Q.id=ye.id),ye.bbox&&(Q.bbox=ye.bbox),Q.properties=xe||{},Q.geometry=ge,Q}j.feature=C;function I(ge,xe,ye){switch(ye===void 0&&(ye={}),ge){case"Point":return D(xe).geometry;case"LineString":return Z(xe).geometry;case"Polygon":return U(xe).geometry;case"MultiPoint":return he(xe).geometry;case"MultiLineString":return ie(xe).geometry;case"MultiPolygon":return Ce(xe).geometry;default:throw new Error(ge+" is invalid")}}j.geometry=I;function D(ge,xe,ye){if(ye===void 0&&(ye={}),!ge)throw new Error("coordinates is required");if(!Array.isArray(ge))throw new Error("coordinates must be an Array");if(ge.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!Se(ge[0])||!Se(ge[1]))throw new Error("coordinates must contain numbers");var Q={type:"Point",coordinates:ge};return C(Q,xe,ye)}j.point=D;function G(ge,xe,ye){return ye===void 0&&(ye={}),q(ge.map(function(Q){return D(Q,xe)}),ye)}j.points=G;function U(ge,xe,ye){ye===void 0&&(ye={});for(var Q=0,Pe=ge;Q<Pe.length;Q++){var Ae=Pe[Q];if(Ae.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var _e=0;_e<Ae[Ae.length-1].length;_e++)if(Ae[Ae.length-1][_e]!==Ae[0][_e])throw new Error("First and last Position are not equivalent.")}var ue={type:"Polygon",coordinates:ge};return C(ue,xe,ye)}j.polygon=U;function B(ge,xe,ye){return ye===void 0&&(ye={}),q(ge.map(function(Q){return U(Q,xe)}),ye)}j.polygons=B;function Z(ge,xe,ye){if(ye===void 0&&(ye={}),ge.length<2)throw new Error("coordinates must be an array of two or more positions");var Q={type:"LineString",coordinates:ge};return C(Q,xe,ye)}j.lineString=Z;function X(ge,xe,ye){return ye===void 0&&(ye={}),q(ge.map(function(Q){return Z(Q,xe)}),ye)}j.lineStrings=X;function q(ge,xe){xe===void 0&&(xe={});var ye={type:"FeatureCollection"};return xe.id&&(ye.id=xe.id),xe.bbox&&(ye.bbox=xe.bbox),ye.features=ge,ye}j.featureCollection=q;function ie(ge,xe,ye){ye===void 0&&(ye={});var Q={type:"MultiLineString",coordinates:ge};return C(Q,xe,ye)}j.multiLineString=ie;function he(ge,xe,ye){ye===void 0&&(ye={});var Q={type:"MultiPoint",coordinates:ge};return C(Q,xe,ye)}j.multiPoint=he;function Ce(ge,xe,ye){ye===void 0&&(ye={});var Q={type:"MultiPolygon",coordinates:ge};return C(Q,xe,ye)}j.multiPolygon=Ce;function be(ge,xe,ye){ye===void 0&&(ye={});var Q={type:"GeometryCollection",geometries:ge};return C(Q,xe,ye)}j.geometryCollection=be;function Ze(ge,xe){if(xe===void 0&&(xe=0),xe&&!(xe>=0))throw new Error("precision must be a positive number");var ye=Math.pow(10,xe||0);return Math.round(ge*ye)/ye}j.round=Ze;function qe(ge,xe){xe===void 0&&(xe="kilometers");var ye=j.factors[xe];if(!ye)throw new Error(xe+" units is invalid");return ge*ye}j.radiansToLength=qe;function De(ge,xe){xe===void 0&&(xe="kilometers");var ye=j.factors[xe];if(!ye)throw new Error(xe+" units is invalid");return ge/ye}j.lengthToRadians=De;function Ge(ge,xe){return Me(De(ge,xe))}j.lengthToDegrees=Ge;function Re(ge){var xe=ge%360;return xe<0&&(xe+=360),xe}j.bearingToAzimuth=Re;function Me(ge){var xe=ge%(2*Math.PI);return xe*180/Math.PI}j.radiansToDegrees=Me;function ce(ge){var xe=ge%360;return xe*Math.PI/180}j.degreesToRadians=ce;function Be(ge,xe,ye){if(xe===void 0&&(xe="kilometers"),ye===void 0&&(ye="kilometers"),!(ge>=0))throw new Error("length must be a positive number");return qe(De(ge,xe),ye)}j.convertLength=Be;function Ee(ge,xe,ye){if(xe===void 0&&(xe="meters"),ye===void 0&&(ye="kilometers"),!(ge>=0))throw new Error("area must be a positive number");var Q=j.areaFactors[xe];if(!Q)throw new Error("invalid original units");var Pe=j.areaFactors[ye];if(!Pe)throw new Error("invalid final units");return ge/Q*Pe}j.convertArea=Ee;function Se(ge){return!isNaN(ge)&&ge!==null&&!Array.isArray(ge)}j.isNumber=Se;function oe(ge){return!!ge&&ge.constructor===Object}j.isObject=oe;function Y(ge){if(!ge)throw new Error("bbox is required");if(!Array.isArray(ge))throw new Error("bbox must be an Array");if(ge.length!==4&&ge.length!==6)throw new Error("bbox must be an Array of 4 or 6 numbers");ge.forEach(function(xe){if(!Se(xe))throw new Error("bbox must only contain numbers")})}j.validateBBox=Y;function Ne(ge){if(!ge)throw new Error("id is required");if(["string","number"].indexOf(typeof ge)===-1)throw new Error("id must be a number or a string")}j.validateId=Ne},9750:function(ae,j,C){"use strict";Object.defineProperty(j,"__esModule",{value:!0});var I=C(78161);function D(ce,Be,Ee){if(ce!==null)for(var Se,oe,Y,Ne,ge,xe,ye,Q=0,Pe=0,Ae,_e=ce.type,ue=_e==="FeatureCollection",ke=_e==="Feature",ze=ue?ce.features.length:1,le=0;le<ze;le++){ye=ue?ce.features[le].geometry:ke?ce.geometry:ce,Ae=ye?ye.type==="GeometryCollection":!1,ge=Ae?ye.geometries.length:1;for(var Ut=0;Ut<ge;Ut++){var kt=0,pr=0;if(Ne=Ae?ye.geometries[Ut]:ye,Ne!==null){xe=Ne.coordinates;var Wt=Ne.type;switch(Q=Ee&&(Wt==="Polygon"||Wt==="MultiPolygon")?1:0,Wt){case null:break;case"Point":if(Be(xe,Pe,le,kt,pr)===!1)return!1;Pe++,kt++;break;case"LineString":case"MultiPoint":for(Se=0;Se<xe.length;Se++){if(Be(xe[Se],Pe,le,kt,pr)===!1)return!1;Pe++,Wt==="MultiPoint"&&kt++}Wt==="LineString"&&kt++;break;case"Polygon":case"MultiLineString":for(Se=0;Se<xe.length;Se++){for(oe=0;oe<xe[Se].length-Q;oe++){if(Be(xe[Se][oe],Pe,le,kt,pr)===!1)return!1;Pe++}Wt==="MultiLineString"&&kt++,Wt==="Polygon"&&pr++}Wt==="Polygon"&&kt++;break;case"MultiPolygon":for(Se=0;Se<xe.length;Se++){for(pr=0,oe=0;oe<xe[Se].length;oe++){for(Y=0;Y<xe[Se][oe].length-Q;Y++){if(Be(xe[Se][oe][Y],Pe,le,kt,pr)===!1)return!1;Pe++}pr++}kt++}break;case"GeometryCollection":for(Se=0;Se<Ne.geometries.length;Se++)if(D(Ne.geometries[Se],Be,Ee)===!1)return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function G(ce,Be,Ee,Se){var oe=Ee;return D(ce,function(Y,Ne,ge,xe,ye){Ne===0&&Ee===void 0?oe=Y:oe=Be(oe,Y,Ne,ge,xe,ye)},Se),oe}function U(ce,Be){var Ee;switch(ce.type){case"FeatureCollection":for(Ee=0;Ee<ce.features.length&&Be(ce.features[Ee].properties,Ee)!==!1;Ee++);break;case"Feature":Be(ce.properties,0);break}}function B(ce,Be,Ee){var Se=Ee;return U(ce,function(oe,Y){Y===0&&Ee===void 0?Se=oe:Se=Be(Se,oe,Y)}),Se}function Z(ce,Be){if(ce.type==="Feature")Be(ce,0);else if(ce.type==="FeatureCollection")for(var Ee=0;Ee<ce.features.length&&Be(ce.features[Ee],Ee)!==!1;Ee++);}function X(ce,Be,Ee){var Se=Ee;return Z(ce,function(oe,Y){Y===0&&Ee===void 0?Se=oe:Se=Be(Se,oe,Y)}),Se}function q(ce){var Be=[];return D(ce,function(Ee){Be.push(Ee)}),Be}function ie(ce,Be){var Ee,Se,oe,Y,Ne,ge,xe,ye,Q,Pe,Ae=0,_e=ce.type==="FeatureCollection",ue=ce.type==="Feature",ke=_e?ce.features.length:1;for(Ee=0;Ee<ke;Ee++){for(ge=_e?ce.features[Ee].geometry:ue?ce.geometry:ce,ye=_e?ce.features[Ee].properties:ue?ce.properties:{},Q=_e?ce.features[Ee].bbox:ue?ce.bbox:void 0,Pe=_e?ce.features[Ee].id:ue?ce.id:void 0,xe=ge?ge.type==="GeometryCollection":!1,Ne=xe?ge.geometries.length:1,oe=0;oe<Ne;oe++){if(Y=xe?ge.geometries[oe]:ge,Y===null){if(Be(null,Ae,ye,Q,Pe)===!1)return!1;continue}switch(Y.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":{if(Be(Y,Ae,ye,Q,Pe)===!1)return!1;break}case"GeometryCollection":{for(Se=0;Se<Y.geometries.length;Se++)if(Be(Y.geometries[Se],Ae,ye,Q,Pe)===!1)return!1;break}default:throw new Error("Unknown Geometry Type")}}Ae++}}function he(ce,Be,Ee){var Se=Ee;return ie(ce,function(oe,Y,Ne,ge,xe){Y===0&&Ee===void 0?Se=oe:Se=Be(Se,oe,Y,Ne,ge,xe)}),Se}function Ce(ce,Be){ie(ce,function(Ee,Se,oe,Y,Ne){var ge=Ee===null?null:Ee.type;switch(ge){case null:case"Point":case"LineString":case"Polygon":return Be(I.feature(Ee,oe,{bbox:Y,id:Ne}),Se,0)===!1?!1:void 0}var xe;switch(ge){case"MultiPoint":xe="Point";break;case"MultiLineString":xe="LineString";break;case"MultiPolygon":xe="Polygon";break}for(var ye=0;ye<Ee.coordinates.length;ye++){var Q=Ee.coordinates[ye],Pe={type:xe,coordinates:Q};if(Be(I.feature(Pe,oe),Se,ye)===!1)return!1}})}function be(ce,Be,Ee){var Se=Ee;return Ce(ce,function(oe,Y,Ne){Y===0&&Ne===0&&Ee===void 0?Se=oe:Se=Be(Se,oe,Y,Ne)}),Se}function Ze(ce,Be){Ce(ce,function(Ee,Se,oe){var Y=0;if(Ee.geometry){var Ne=Ee.geometry.type;if(!(Ne==="Point"||Ne==="MultiPoint")){var ge,xe=0,ye=0,Q=0;if(D(Ee,function(Pe,Ae,_e,ue,ke){if(ge===void 0||Se>xe||ue>ye||ke>Q){ge=Pe,xe=Se,ye=ue,Q=ke,Y=0;return}var ze=I.lineString([ge,Pe],Ee.properties);if(Be(ze,Se,oe,ke,Y)===!1)return!1;Y++,ge=Pe})===!1)return!1}}})}function qe(ce,Be,Ee){var Se=Ee,oe=!1;return Ze(ce,function(Y,Ne,ge,xe,ye){oe===!1&&Ee===void 0?Se=Y:Se=Be(Se,Y,Ne,ge,xe,ye),oe=!0}),Se}function De(ce,Be){if(!ce)throw new Error("geojson is required");Ce(ce,function(Ee,Se,oe){if(Ee.geometry!==null){var Y=Ee.geometry.type,Ne=Ee.geometry.coordinates;switch(Y){case"LineString":if(Be(Ee,Se,oe,0,0)===!1)return!1;break;case"Polygon":for(var ge=0;ge<Ne.length;ge++)if(Be(I.lineString(Ne[ge],Ee.properties),Se,oe,ge)===!1)return!1;break}}})}function Ge(ce,Be,Ee){var Se=Ee;return De(ce,function(oe,Y,Ne,ge){Y===0&&Ee===void 0?Se=oe:Se=Be(Se,oe,Y,Ne,ge)}),Se}function Re(ce,Be){if(Be=Be||{},!I.isObject(Be))throw new Error("options is invalid");var Ee=Be.featureIndex||0,Se=Be.multiFeatureIndex||0,oe=Be.geometryIndex||0,Y=Be.segmentIndex||0,Ne=Be.properties,ge;switch(ce.type){case"FeatureCollection":Ee<0&&(Ee=ce.features.length+Ee),Ne=Ne||ce.features[Ee].properties,ge=ce.features[Ee].geometry;break;case"Feature":Ne=Ne||ce.properties,ge=ce.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":ge=ce;break;default:throw new Error("geojson is invalid")}if(ge===null)return null;var xe=ge.coordinates;switch(ge.type){case"Point":case"MultiPoint":return null;case"LineString":return Y<0&&(Y=xe.length+Y-1),I.lineString([xe[Y],xe[Y+1]],Ne,Be);case"Polygon":return oe<0&&(oe=xe.length+oe),Y<0&&(Y=xe[oe].length+Y-1),I.lineString([xe[oe][Y],xe[oe][Y+1]],Ne,Be);case"MultiLineString":return Se<0&&(Se=xe.length+Se),Y<0&&(Y=xe[Se].length+Y-1),I.lineString([xe[Se][Y],xe[Se][Y+1]],Ne,Be);case"MultiPolygon":return Se<0&&(Se=xe.length+Se),oe<0&&(oe=xe[Se].length+oe),Y<0&&(Y=xe[Se][oe].length-Y-1),I.lineString([xe[Se][oe][Y],xe[Se][oe][Y+1]],Ne,Be)}throw new Error("geojson is invalid")}function Me(ce,Be){if(Be=Be||{},!I.isObject(Be))throw new Error("options is invalid");var Ee=Be.featureIndex||0,Se=Be.multiFeatureIndex||0,oe=Be.geometryIndex||0,Y=Be.coordIndex||0,Ne=Be.properties,ge;switch(ce.type){case"FeatureCollection":Ee<0&&(Ee=ce.features.length+Ee),Ne=Ne||ce.features[Ee].properties,ge=ce.features[Ee].geometry;break;case"Feature":Ne=Ne||ce.properties,ge=ce.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":ge=ce;break;default:throw new Error("geojson is invalid")}if(ge===null)return null;var xe=ge.coordinates;switch(ge.type){case"Point":return I.point(xe,Ne,Be);case"MultiPoint":return Se<0&&(Se=xe.length+Se),I.point(xe[Se],Ne,Be);case"LineString":return Y<0&&(Y=xe.length+Y),I.point(xe[Y],Ne,Be);case"Polygon":return oe<0&&(oe=xe.length+oe),Y<0&&(Y=xe[oe].length+Y),I.point(xe[oe][Y],Ne,Be);case"MultiLineString":return Se<0&&(Se=xe.length+Se),Y<0&&(Y=xe[Se].length+Y),I.point(xe[Se][Y],Ne,Be);case"MultiPolygon":return Se<0&&(Se=xe.length+Se),oe<0&&(oe=xe[Se].length+oe),Y<0&&(Y=xe[Se][oe].length-Y),I.point(xe[Se][oe][Y],Ne,Be)}throw new Error("geojson is invalid")}j.coordAll=q,j.coordEach=D,j.coordReduce=G,j.featureEach=Z,j.featureReduce=X,j.findPoint=Me,j.findSegment=Re,j.flattenEach=Ce,j.flattenReduce=be,j.geomEach=ie,j.geomReduce=he,j.lineEach=De,j.lineReduce=Ge,j.propEach=U,j.propReduce=B,j.segmentEach=Ze,j.segmentReduce=qe},97683:function(ae,j,C){"use strict";var I=C(44532),D=C(71262),G=D(I("String.prototype.indexOf"));ae.exports=function(B,Z){var X=I(B,!!Z);return typeof X=="function"&&G(B,".prototype.")>-1?D(X):X}},71262:function(ae,j,C){"use strict";var I=C(36723),D=C(44532),G=C(59662),U=D("%TypeError%"),B=D("%Function.prototype.apply%"),Z=D("%Function.prototype.call%"),X=D("%Reflect.apply%",!0)||I.call(Z,B),q=D("%Object.defineProperty%",!0),ie=D("%Math.max%");if(q)try{q({},"a",{value:1})}catch(Ce){q=null}ae.exports=function(be){if(typeof be!="function")throw new U("a function is required");var Ze=X(I,Z,arguments);return G(Ze,1+ie(0,be.length-(arguments.length-1)),!0)};var he=function(){return X(I,B,arguments)};q?q(ae.exports,"apply",{value:he}):ae.exports.apply=he},24538:function(ae,j,C){"use strict";var I=C(79535),D=C(93285),G=C(76469),U=C(45229).orient2d;D.default&&(D=D.default),ae.exports=B,ae.exports.default=B;function B(Ee,Se,oe){Se=Math.max(0,Se===void 0?2:Se),oe=oe||0;var Y=qe(Ee),Ne=new I(16);Ne.toBBox=function(pr){return{minX:pr[0],minY:pr[1],maxX:pr[0],maxY:pr[1]}},Ne.compareMinX=function(pr,Wt){return pr[0]-Wt[0]},Ne.compareMinY=function(pr,Wt){return pr[1]-Wt[1]},Ne.load(Ee);for(var ge=[],xe=0,ye;xe<Y.length;xe++){var Q=Y[xe];Ne.remove(Q),ye=De(Q,ye),ge.push(ye)}var Pe=new I(16);for(xe=0;xe<ge.length;xe++)Pe.insert(Ze(ge[xe]));for(var Ae=Se*Se,_e=oe*oe;ge.length;){var ue=ge.shift(),ke=ue.p,ze=ue.next.p,le=Ge(ke,ze);if(!(le<_e)){var Ut=le/Ae;Q=Z(Ne,ue.prev.p,ke,ze,ue.next.next.p,Ut,Pe),Q&&Math.min(Ge(Q,ke),Ge(Q,ze))<=Ut&&(ge.push(ue),ge.push(De(Q,ue)),Ne.remove(Q),Pe.remove(ue),Pe.insert(Ze(ue)),Pe.insert(Ze(ue.next)))}}ue=ye;var kt=[];do kt.push(ue.p),ue=ue.next;while(ue!==ye);return kt.push(ue.p),kt}function Z(Ee,Se,oe,Y,Ne,ge,xe){for(var ye=new D([],X),Q=Ee.data;Q;){for(var Pe=0;Pe<Q.children.length;Pe++){var Ae=Q.children[Pe],_e=Q.leaf?Re(Ae,oe,Y):q(oe,Y,Ae);_e>ge||ye.push({node:Ae,dist:_e})}for(;ye.length&&!ye.peek().node.children;){var ue=ye.pop(),ke=ue.node,ze=Re(ke,Se,oe),le=Re(ke,Y,Ne);if(ue.dist<ze&&ue.dist<le&&he(oe,ke,xe)&&he(Y,ke,xe))return ke}Q=ye.pop(),Q&&(Q=Q.node)}return null}function X(Ee,Se){return Ee.dist-Se.dist}function q(Ee,Se,oe){if(ie(Ee,oe)||ie(Se,oe))return 0;var Y=Me(Ee[0],Ee[1],Se[0],Se[1],oe.minX,oe.minY,oe.maxX,oe.minY);if(Y===0)return 0;var Ne=Me(Ee[0],Ee[1],Se[0],Se[1],oe.minX,oe.minY,oe.minX,oe.maxY);if(Ne===0)return 0;var ge=Me(Ee[0],Ee[1],Se[0],Se[1],oe.maxX,oe.minY,oe.maxX,oe.maxY);if(ge===0)return 0;var xe=Me(Ee[0],Ee[1],Se[0],Se[1],oe.minX,oe.maxY,oe.maxX,oe.maxY);return xe===0?0:Math.min(Y,Ne,ge,xe)}function ie(Ee,Se){return Ee[0]>=Se.minX&&Ee[0]<=Se.maxX&&Ee[1]>=Se.minY&&Ee[1]<=Se.maxY}function he(Ee,Se,oe){for(var Y=Math.min(Ee[0],Se[0]),Ne=Math.min(Ee[1],Se[1]),ge=Math.max(Ee[0],Se[0]),xe=Math.max(Ee[1],Se[1]),ye=oe.search({minX:Y,minY:Ne,maxX:ge,maxY:xe}),Q=0;Q<ye.length;Q++)if(be(ye[Q].p,ye[Q].next.p,Ee,Se))return!1;return!0}function Ce(Ee,Se,oe){return U(Ee[0],Ee[1],Se[0],Se[1],oe[0],oe[1])}function be(Ee,Se,oe,Y){return Ee!==Y&&Se!==oe&&Ce(Ee,Se,oe)>0!=Ce(Ee,Se,Y)>0&&Ce(oe,Y,Ee)>0!=Ce(oe,Y,Se)>0}function Ze(Ee){var Se=Ee.p,oe=Ee.next.p;return Ee.minX=Math.min(Se[0],oe[0]),Ee.minY=Math.min(Se[1],oe[1]),Ee.maxX=Math.max(Se[0],oe[0]),Ee.maxY=Math.max(Se[1],oe[1]),Ee}function qe(Ee){for(var Se=Ee[0],oe=Ee[0],Y=Ee[0],Ne=Ee[0],ge=0;ge<Ee.length;ge++){var xe=Ee[ge];xe[0]<Se[0]&&(Se=xe),xe[0]>Y[0]&&(Y=xe),xe[1]<oe[1]&&(oe=xe),xe[1]>Ne[1]&&(Ne=xe)}var ye=[Se,oe,Y,Ne],Q=ye.slice();for(ge=0;ge<Ee.length;ge++)G(Ee[ge],ye)||Q.push(Ee[ge]);return Be(Q)}function De(Ee,Se){var oe={p:Ee,prev:null,next:null,minX:0,minY:0,maxX:0,maxY:0};return Se?(oe.next=Se.next,oe.prev=Se,Se.next.prev=oe,Se.next=oe):(oe.prev=oe,oe.next=oe),oe}function Ge(Ee,Se){var oe=Ee[0]-Se[0],Y=Ee[1]-Se[1];return oe*oe+Y*Y}function Re(Ee,Se,oe){var Y=Se[0],Ne=Se[1],ge=oe[0]-Y,xe=oe[1]-Ne;if(ge!==0||xe!==0){var ye=((Ee[0]-Y)*ge+(Ee[1]-Ne)*xe)/(ge*ge+xe*xe);ye>1?(Y=oe[0],Ne=oe[1]):ye>0&&(Y+=ge*ye,Ne+=xe*ye)}return ge=Ee[0]-Y,xe=Ee[1]-Ne,ge*ge+xe*xe}function Me(Ee,Se,oe,Y,Ne,ge,xe,ye){var Q=oe-Ee,Pe=Y-Se,Ae=xe-Ne,_e=ye-ge,ue=Ee-Ne,ke=Se-ge,ze=Q*Q+Pe*Pe,le=Q*Ae+Pe*_e,Ut=Ae*Ae+_e*_e,kt=Q*ue+Pe*ke,pr=Ae*ue+_e*ke,Wt=ze*Ut-le*le,Xr,fn,Ir,Qr,tn=Wt,Mr=Wt;Wt===0?(fn=0,tn=1,Qr=pr,Mr=Ut):(fn=le*pr-Ut*kt,Qr=ze*pr-le*kt,fn<0?(fn=0,Qr=pr,Mr=Ut):fn>tn&&(fn=tn,Qr=pr+le,Mr=Ut)),Qr<0?(Qr=0,-kt<0?fn=0:-kt>ze?fn=tn:(fn=-kt,tn=ze)):Qr>Mr&&(Qr=Mr,-kt+le<0?fn=0:-kt+le>ze?fn=tn:(fn=-kt+le,tn=ze)),Xr=fn===0?0:fn/tn,Ir=Qr===0?0:Qr/Mr;var $n=(1-Xr)*Ee+Xr*oe,li=(1-Xr)*Se+Xr*Y,Kn=(1-Ir)*Ne+Ir*xe,$r=(1-Ir)*ge+Ir*ye,ln=Kn-$n,Cn=$r-li;return ln*ln+Cn*Cn}function ce(Ee,Se){return Ee[0]===Se[0]?Ee[1]-Se[1]:Ee[0]-Se[0]}function Be(Ee){Ee.sort(ce);for(var Se=[],oe=0;oe<Ee.length;oe++){for(;Se.length>=2&&Ce(Se[Se.length-2],Se[Se.length-1],Ee[oe])<=0;)Se.pop();Se.push(Ee[oe])}for(var Y=[],Ne=Ee.length-1;Ne>=0;Ne--){for(;Y.length>=2&&Ce(Y[Y.length-2],Y[Y.length-1],Ee[Ne])<=0;)Y.pop();Y.push(Ee[Ne])}return Y.pop(),Se.pop(),Se.concat(Y)}},57965:function(ae,j,C){"use strict";C.d(j,{j2:function(){return I},b4:function(){return X},YF:function(){return D},We:function(){return q},TS:function(){return Be},VR:function(){return Se},G9:function(){return Ge},ly:function(){return Re},sd:function(){return De}});function I(oe,Y){return oe<Y?-1:oe>Y?1:oe>=Y?0:NaN}function D(oe){return oe.length===1&&(oe=G(oe)),{left:function(Y,Ne,ge,xe){for(ge==null&&(ge=0),xe==null&&(xe=Y.length);ge<xe;){var ye=ge+xe>>>1;oe(Y[ye],Ne)<0?ge=ye+1:xe=ye}return ge},right:function(Y,Ne,ge,xe){for(ge==null&&(ge=0),xe==null&&(xe=Y.length);ge<xe;){var ye=ge+xe>>>1;oe(Y[ye],Ne)>0?xe=ye:ge=ye+1}return ge}}}function G(oe){return function(Y,Ne){return I(oe(Y),Ne)}}var U=D(I),B=U.right,Z=U.left,X=B;function q(oe,Y){var Ne=oe.length,ge=-1,xe,ye,Q;if(Y==null){for(;++ge<Ne;)if((xe=oe[ge])!=null&&xe>=xe)for(ye=Q=xe;++ge<Ne;)(xe=oe[ge])!=null&&(ye>xe&&(ye=xe),Q<xe&&(Q=xe))}else for(;++ge<Ne;)if((xe=Y(oe[ge],ge,oe))!=null&&xe>=xe)for(ye=Q=xe;++ge<Ne;)(xe=Y(oe[ge],ge,oe))!=null&&(ye>xe&&(ye=xe),Q<xe&&(Q=xe));return[ye,Q]}var ie=Array.prototype,he=ie.slice,Ce=ie.map,be=Math.sqrt(50),Ze=Math.sqrt(10),qe=Math.sqrt(2);function De(oe,Y,Ne){var ge,xe=-1,ye,Q,Pe;if(Y=+Y,oe=+oe,Ne=+Ne,oe===Y&&Ne>0)return[oe];if((ge=Y<oe)&&(ye=oe,oe=Y,Y=ye),(Pe=Ge(oe,Y,Ne))===0||!isFinite(Pe))return[];if(Pe>0)for(oe=Math.ceil(oe/Pe),Y=Math.floor(Y/Pe),Q=new Array(ye=Math.ceil(Y-oe+1));++xe<ye;)Q[xe]=(oe+xe)*Pe;else for(oe=Math.floor(oe*Pe),Y=Math.ceil(Y*Pe),Q=new Array(ye=Math.ceil(oe-Y+1));++xe<ye;)Q[xe]=(oe-xe)/Pe;return ge&&Q.reverse(),Q}function Ge(oe,Y,Ne){var ge=(Y-oe)/Math.max(0,Ne),xe=Math.floor(Math.log(ge)/Math.LN10),ye=ge/Math.pow(10,xe);return xe>=0?(ye>=be?10:ye>=Ze?5:ye>=qe?2:1)*Math.pow(10,xe):-Math.pow(10,-xe)/(ye>=be?10:ye>=Ze?5:ye>=qe?2:1)}function Re(oe,Y,Ne){var ge=Math.abs(Y-oe)/Math.max(0,Ne),xe=Math.pow(10,Math.floor(Math.log(ge)/Math.LN10)),ye=ge/xe;return ye>=be?xe*=10:ye>=Ze?xe*=5:ye>=qe&&(xe*=2),Y<oe?-xe:xe}function Me(){var oe=identity,Y=extent,Ne=sturges;function ge(xe){var ye,Q=xe.length,Pe,Ae=new Array(Q);for(ye=0;ye<Q;++ye)Ae[ye]=oe(xe[ye],ye,xe);var _e=Y(Ae),ue=_e[0],ke=_e[1],ze=Ne(Ae,ue,ke);Array.isArray(ze)||(ze=tickStep(ue,ke,ze),ze=range(Math.ceil(ue/ze)*ze,ke,ze));for(var le=ze.length;ze[0]<=ue;)ze.shift(),--le;for(;ze[le-1]>ke;)ze.pop(),--le;var Ut=new Array(le+1),kt;for(ye=0;ye<=le;++ye)kt=Ut[ye]=[],kt.x0=ye>0?ze[ye-1]:ue,kt.x1=ye<le?ze[ye]:ke;for(ye=0;ye<Q;++ye)Pe=Ae[ye],ue<=Pe&&Pe<=ke&&Ut[bisect(ze,Pe,0,le)].push(xe[ye]);return Ut}return ge.value=function(xe){return arguments.length?(oe=typeof xe=="function"?xe:constant(xe),ge):oe},ge.domain=function(xe){return arguments.length?(Y=typeof xe=="function"?xe:constant([xe[0],xe[1]]),ge):Y},ge.thresholds=function(xe){return arguments.length?(Ne=typeof xe=="function"?xe:Array.isArray(xe)?constant(slice.call(xe)):constant(xe),ge):Ne},ge}function ce(oe,Y,Ne){return oe=map.call(oe,number).sort(ascending),Math.ceil((Ne-Y)/(2*(quantile(oe,.75)-quantile(oe,.25))*Math.pow(oe.length,-1/3)))}function Be(oe){for(var Y=oe.length,Ne,ge=-1,xe=0,ye,Q;++ge<Y;)xe+=oe[ge].length;for(ye=new Array(xe);--Y>=0;)for(Q=oe[Y],Ne=Q.length;--Ne>=0;)ye[--xe]=Q[Ne];return ye}function Ee(oe){return oe===null?NaN:+oe}function Se(oe,Y,Ne){if(Ne==null&&(Ne=Ee),!!(ge=oe.length)){if((Y=+Y)<=0||ge<2)return+Ne(oe[0],0,oe);if(Y>=1)return+Ne(oe[ge-1],ge-1,oe);var ge,xe=(ge-1)*Y,ye=Math.floor(xe),Q=+Ne(oe[ye],ye,oe),Pe=+Ne(oe[ye+1],ye+1,oe);return Q+(Pe-Q)*(xe-ye)}}},19545:function(ae,j,C){var I=C(64253),D=C(76051),G=C(6392),U=C(11644),B=C(61245),Z=C(5012),X=Date.prototype.getTime;function q(be,Ze,qe){var De=qe||{};return(De.strict?G(be,Ze):be===Ze)?!0:!be||!Ze||typeof be!="object"&&typeof Ze!="object"?De.strict?G(be,Ze):be==Ze:Ce(be,Ze,De)}function ie(be){return be==null}function he(be){return!(!be||typeof be!="object"||typeof be.length!="number"||typeof be.copy!="function"||typeof be.slice!="function"||be.length>0&&typeof be[0]!="number")}function Ce(be,Ze,qe){var De,Ge;if(typeof be!=typeof Ze||ie(be)||ie(Ze)||be.prototype!==Ze.prototype||D(be)!==D(Ze))return!1;var Re=U(be),Me=U(Ze);if(Re!==Me)return!1;if(Re||Me)return be.source===Ze.source&&B(be)===B(Ze);if(Z(be)&&Z(Ze))return X.call(be)===X.call(Ze);var ce=he(be),Be=he(Ze);if(ce!==Be)return!1;if(ce||Be){if(be.length!==Ze.length)return!1;for(De=0;De<be.length;De++)if(be[De]!==Ze[De])return!1;return!0}if(typeof be!=typeof Ze)return!1;try{var Ee=I(be),Se=I(Ze)}catch(oe){return!1}if(Ee.length!==Se.length)return!1;for(Ee.sort(),Se.sort(),De=Ee.length-1;De>=0;De--)if(Ee[De]!=Se[De])return!1;for(De=Ee.length-1;De>=0;De--)if(Ge=Ee[De],!q(be[Ge],Ze[Ge],qe))return!1;return!0}ae.exports=q},51494:function(ae,j,C){"use strict";var I=C(38262)(),D=C(44532),G=I&&D("%Object.defineProperty%",!0);if(G)try{G({},"a",{value:1})}catch(X){G=!1}var U=D("%SyntaxError%"),B=D("%TypeError%"),Z=C(67747);ae.exports=function(q,ie,he){if(!q||typeof q!="object"&&typeof q!="function")throw new B("`obj` must be an object or a function`");if(typeof ie!="string"&&typeof ie!="symbol")throw new B("`property` must be a string or a symbol`");if(arguments.length>3&&typeof arguments[3]!="boolean"&&arguments[3]!==null)throw new B("`nonEnumerable`, if provided, must be a boolean or null");if(arguments.length>4&&typeof arguments[4]!="boolean"&&arguments[4]!==null)throw new B("`nonWritable`, if provided, must be a boolean or null");if(arguments.length>5&&typeof arguments[5]!="boolean"&&arguments[5]!==null)throw new B("`nonConfigurable`, if provided, must be a boolean or null");if(arguments.length>6&&typeof arguments[6]!="boolean")throw new B("`loose`, if provided, must be a boolean");var Ce=arguments.length>3?arguments[3]:null,be=arguments.length>4?arguments[4]:null,Ze=arguments.length>5?arguments[5]:null,qe=arguments.length>6?arguments[6]:!1,De=!!Z&&Z(q,ie);if(G)G(q,ie,{configurable:Ze===null&&De?De.configurable:!Ze,enumerable:Ce===null&&De?De.enumerable:!Ce,value:he,writable:be===null&&De?De.writable:!be});else if(qe||!Ce&&!be&&!Ze)q[ie]=he;else throw new U("This environment does not support defining a property as non-configurable, non-writable, or non-enumerable.")}},8263:function(ae,j,C){"use strict";var I=C(64253),D=typeof Symbol=="function"&&typeof Symbol("foo")=="symbol",G=Object.prototype.toString,U=Array.prototype.concat,B=C(51494),Z=function(he){return typeof he=="function"&&G.call(he)==="[object Function]"},X=C(38262)(),q=function(he,Ce,be,Ze){if(Ce in he){if(Ze===!0){if(he[Ce]===be)return}else if(!Z(Ze)||!Ze())return}X?B(he,Ce,be,!0):B(he,Ce,be)},ie=function(he,Ce){var be=arguments.length>2?arguments[2]:{},Ze=I(Ce);D&&(Ze=U.call(Ze,Object.getOwnPropertySymbols(Ce)));for(var qe=0;qe<Ze.length;qe+=1)q(he,Ze[qe],Ce[Ze[qe]],be[Ze[qe]])};ie.supportsDescriptors=!!X,ae.exports=ie},12009:function(ae){function j(C,I,D,G){this.dataset=[],this.epsilon=1,this.minPts=2,this.distance=this._euclideanDistance,this.clusters=[],this.noise=[],this._visited=[],this._assigned=[],this._datasetLength=0,this._init(C,I,D,G)}j.prototype.run=function(C,I,D,G){this._init(C,I,D,G);for(var U=0;U<this._datasetLength;U++)if(this._visited[U]!==1){this._visited[U]=1;var B=this._regionQuery(U);if(B.length<this.minPts)this.noise.push(U);else{var Z=this.clusters.length;this.clusters.push([]),this._addToCluster(U,Z),this._expandCluster(Z,B)}}return this.clusters},j.prototype._init=function(C,I,D,G){if(C){if(!(C instanceof Array))throw Error("Dataset must be of type array, "+typeof C+" given");this.dataset=C,this.clusters=[],this.noise=[],this._datasetLength=C.length,this._visited=new Array(this._datasetLength),this._assigned=new Array(this._datasetLength)}I&&(this.epsilon=I),D&&(this.minPts=D),G&&(this.distance=G)},j.prototype._expandCluster=function(C,I){for(var D=0;D<I.length;D++){var G=I[D];if(this._visited[G]!==1){this._visited[G]=1;var U=this._regionQuery(G);U.length>=this.minPts&&(I=this._mergeArrays(I,U))}this._assigned[G]!==1&&this._addToCluster(G,C)}},j.prototype._addToCluster=function(C,I){this.clusters[I].push(C),this._assigned[C]=1},j.prototype._regionQuery=function(C){for(var I=[],D=0;D<this._datasetLength;D++){var G=this.distance(this.dataset[C],this.dataset[D]);G<this.epsilon&&I.push(D)}return I},j.prototype._mergeArrays=function(C,I){for(var D=I.length,G=0;G<D;G++){var U=I[G];C.indexOf(U)<0&&C.push(U)}return C},j.prototype._euclideanDistance=function(C,I){for(var D=0,G=Math.min(C.length,I.length);G--;)D+=(C[G]-I[G])*(C[G]-I[G]);return Math.sqrt(D)},ae.exports&&(ae.exports=j)},72561:function(ae){function j(C,I,D){this.k=3,this.dataset=[],this.assignments=[],this.centroids=[],this.init(C,I,D)}j.prototype.init=function(C,I,D){this.assignments=[],this.centroids=[],typeof C!="undefined"&&(this.dataset=C),typeof I!="undefined"&&(this.k=I),typeof D!="undefined"&&(this.distance=D)},j.prototype.run=function(C,I){this.init(C,I);for(var D=this.dataset.length,G=0;G<this.k;G++)this.centroids[G]=this.randomCentroid();for(var U=!0;U;){U=this.assign();for(var B=0;B<this.k;B++){for(var Z=new Array(he),X=0,q=0;q<he;q++)Z[q]=0;for(var ie=0;ie<D;ie++){var he=this.dataset[ie].length;if(B===this.assignments[ie]){for(var q=0;q<he;q++)Z[q]+=this.dataset[ie][q];X++}}if(X>0){for(var q=0;q<he;q++)Z[q]/=X;this.centroids[B]=Z}else this.centroids[B]=this.randomCentroid(),U=!0}}return this.getClusters()},j.prototype.randomCentroid=function(){var C=this.dataset.length-1,I,D;do D=Math.round(Math.random()*C),I=this.dataset[D];while(this.centroids.indexOf(I)>=0);return I},j.prototype.assign=function(){for(var C=!1,I=this.dataset.length,D,G=0;G<I;G++)D=this.argmin(this.dataset[G],this.centroids,this.distance),D!=this.assignments[G]&&(this.assignments[G]=D,C=!0);return C},j.prototype.getClusters=function(){for(var C=new Array(this.k),I,D=0;D<this.assignments.length;D++)I=this.assignments[D],typeof C[I]=="undefined"&&(C[I]=[]),C[I].push(D);return C},j.prototype.argmin=function(C,I,D){for(var G=Number.MAX_VALUE,U=0,B=I.length,Z,X=0;X<B;X++)Z=D(C,I[X]),Z<G&&(G=Z,U=X);return U},j.prototype.distance=function(C,I){for(var D=0,G=Math.min(C.length,I.length);G--;){var U=C[G]-I[G];D+=U*U}return Math.sqrt(D)},ae.exports&&(ae.exports=j)},88521:function(ae,j,C){if(ae.exports)var I=C(18909);function D(G,U,B,Z){this.epsilon=1,this.minPts=1,this.distance=this._euclideanDistance,this._reachability=[],this._processed=[],this._coreDistance=0,this._orderedList=[],this._init(G,U,B,Z)}D.prototype.run=function(G,U,B,Z){this._init(G,U,B,Z);for(var X=0,q=this.dataset.length;X<q;X++)if(this._processed[X]!==1){this._processed[X]=1,this.clusters.push([X]);var ie=this.clusters.length-1;this._orderedList.push(X);var he=new I(null,null,"asc"),Ce=this._regionQuery(X);this._distanceToCore(X)!==void 0&&(this._updateQueue(X,Ce,he),this._expandCluster(ie,he))}return this.clusters},D.prototype.getReachabilityPlot=function(){for(var G=[],U=0,B=this._orderedList.length;U<B;U++){var Z=this._orderedList[U],X=this._reachability[Z];G.push([Z,X])}return G},D.prototype._init=function(G,U,B,Z){if(G){if(!(G instanceof Array))throw Error("Dataset must be of type array, "+typeof G+" given");this.dataset=G,this.clusters=[],this._reachability=new Array(this.dataset.length),this._processed=new Array(this.dataset.length),this._coreDistance=0,this._orderedList=[]}U&&(this.epsilon=U),B&&(this.minPts=B),Z&&(this.distance=Z)},D.prototype._updateQueue=function(G,U,B){var Z=this;this._coreDistance=this._distanceToCore(G),U.forEach(function(X){if(Z._processed[X]===void 0){var q=Z.distance(Z.dataset[G],Z.dataset[X]),ie=Math.max(Z._coreDistance,q);Z._reachability[X]===void 0?(Z._reachability[X]=ie,B.insert(X,ie)):ie<Z._reachability[X]&&(Z._reachability[X]=ie,B.remove(X),B.insert(X,ie))}})},D.prototype._expandCluster=function(G,U){for(var B=U.getElements(),Z=0,X=B.length;Z<X;Z++){var q=B[Z];if(this._processed[q]===void 0){var ie=this._regionQuery(q);this._processed[q]=1,this.clusters[G].push(q),this._orderedList.push(q),this._distanceToCore(q)!==void 0&&(this._updateQueue(q,ie,U),this._expandCluster(G,U))}}},D.prototype._distanceToCore=function(G){for(var U=this.epsilon,B=0;B<U;B++){var Z=this._regionQuery(G,B);if(Z.length>=this.minPts)return B}},D.prototype._regionQuery=function(G,U){U=U||this.epsilon;for(var B=[],Z=0,X=this.dataset.length;Z<X;Z++)this.distance(this.dataset[G],this.dataset[Z])<U&&B.push(Z);return B},D.prototype._euclideanDistance=function(G,U){for(var B=0,Z=Math.min(G.length,U.length);Z--;)B+=(G[Z]-U[Z])*(G[Z]-U[Z]);return Math.sqrt(B)},ae.exports&&(ae.exports=D)},18909:function(ae){function j(C,I,D){this._queue=[],this._priorities=[],this._sorting="desc",this._init(C,I,D)}j.prototype.insert=function(C,I){for(var D=this._queue.length,G=D;G--;){var U=this._priorities[G];this._sorting==="desc"?I>U&&(D=G):I<U&&(D=G)}this._insertAt(C,I,D)},j.prototype.remove=function(C){for(var I=this._queue.length;I--;){var D=this._queue[I];if(C===D){this._queue.splice(I,1),this._priorities.splice(I,1);break}}},j.prototype.forEach=function(C){this._queue.forEach(C)},j.prototype.getElements=function(){return this._queue},j.prototype.getElementPriority=function(C){return this._priorities[C]},j.prototype.getPriorities=function(){return this._priorities},j.prototype.getElementsWithPriorities=function(){for(var C=[],I=0,D=this._queue.length;I<D;I++)C.push([this._queue[I],this._priorities[I]]);return C},j.prototype._init=function(C,I,D){if(C&&I){if(this._queue=[],this._priorities=[],C.length!==I.length)throw new Error("Arrays must have the same length");for(var G=0;G<C.length;G++)this.insert(C[G],I[G])}D&&(this._sorting=D)},j.prototype._insertAt=function(C,I,D){this._queue.length===D?(this._queue.push(C),this._priorities.push(I)):(this._queue.splice(D,0,C),this._priorities.splice(D,0,I))},ae.exports&&(ae.exports=j)},70298:function(ae,j,C){ae.exports&&(ae.exports={DBSCAN:C(12009),KMEANS:C(72561),OPTICS:C(88521),PriorityQueue:C(18909)})},80569:function(ae){"use strict";ae.exports=j,ae.exports.default=j;function j(Ae,_e,ue){ue=ue||2;var ke=_e&&_e.length,ze=ke?_e[0]*ue:Ae.length,le=C(Ae,0,ze,ue,!0),Ut=[];if(!le||le.next===le.prev)return Ut;var kt,pr,Wt,Xr,fn,Ir,Qr;if(ke&&(le=X(Ae,_e,le,ue)),Ae.length>80*ue){kt=Wt=Ae[0],pr=Xr=Ae[1];for(var tn=ue;tn<ze;tn+=ue)fn=Ae[tn],Ir=Ae[tn+1],fn<kt&&(kt=fn),Ir<pr&&(pr=Ir),fn>Wt&&(Wt=fn),Ir>Xr&&(Xr=Ir);Qr=Math.max(Wt-kt,Xr-pr),Qr=Qr!==0?32767/Qr:0}return D(le,Ut,ue,kt,pr,Qr,0),Ut}function C(Ae,_e,ue,ke,ze){var le,Ut;if(ze===Pe(Ae,_e,ue,ke)>0)for(le=_e;le<ue;le+=ke)Ut=xe(le,Ae[le],Ae[le+1],Ut);else for(le=ue-ke;le>=_e;le-=ke)Ut=xe(le,Ae[le],Ae[le+1],Ut);return Ut&&ce(Ut,Ut.next)&&(ye(Ut),Ut=Ut.next),Ut}function I(Ae,_e){if(!Ae)return Ae;_e||(_e=Ae);var ue=Ae,ke;do if(ke=!1,!ue.steiner&&(ce(ue,ue.next)||Me(ue.prev,ue,ue.next)===0)){if(ye(ue),ue=_e=ue.prev,ue===ue.next)break;ke=!0}else ue=ue.next;while(ke||ue!==_e);return _e}function D(Ae,_e,ue,ke,ze,le,Ut){if(Ae){!Ut&&le&&be(Ae,ke,ze,le);for(var kt=Ae,pr,Wt;Ae.prev!==Ae.next;){if(pr=Ae.prev,Wt=Ae.next,le?U(Ae,ke,ze,le):G(Ae)){_e.push(pr.i/ue|0),_e.push(Ae.i/ue|0),_e.push(Wt.i/ue|0),ye(Ae),Ae=Wt.next,kt=Wt.next;continue}if(Ae=Wt,Ae===kt){Ut?Ut===1?(Ae=B(I(Ae),_e,ue),D(Ae,_e,ue,ke,ze,le,2)):Ut===2&&Z(Ae,_e,ue,ke,ze,le):D(I(Ae),_e,ue,ke,ze,le,1);break}}}}function G(Ae){var _e=Ae.prev,ue=Ae,ke=Ae.next;if(Me(_e,ue,ke)>=0)return!1;for(var ze=_e.x,le=ue.x,Ut=ke.x,kt=_e.y,pr=ue.y,Wt=ke.y,Xr=ze<le?ze<Ut?ze:Ut:le<Ut?le:Ut,fn=kt<pr?kt<Wt?kt:Wt:pr<Wt?pr:Wt,Ir=ze>le?ze>Ut?ze:Ut:le>Ut?le:Ut,Qr=kt>pr?kt>Wt?kt:Wt:pr>Wt?pr:Wt,tn=ke.next;tn!==_e;){if(tn.x>=Xr&&tn.x<=Ir&&tn.y>=fn&&tn.y<=Qr&&Ge(ze,kt,le,pr,Ut,Wt,tn.x,tn.y)&&Me(tn.prev,tn,tn.next)>=0)return!1;tn=tn.next}return!0}function U(Ae,_e,ue,ke){var ze=Ae.prev,le=Ae,Ut=Ae.next;if(Me(ze,le,Ut)>=0)return!1;for(var kt=ze.x,pr=le.x,Wt=Ut.x,Xr=ze.y,fn=le.y,Ir=Ut.y,Qr=kt<pr?kt<Wt?kt:Wt:pr<Wt?pr:Wt,tn=Xr<fn?Xr<Ir?Xr:Ir:fn<Ir?fn:Ir,Mr=kt>pr?kt>Wt?kt:Wt:pr>Wt?pr:Wt,$n=Xr>fn?Xr>Ir?Xr:Ir:fn>Ir?fn:Ir,li=qe(Qr,tn,_e,ue,ke),Kn=qe(Mr,$n,_e,ue,ke),$r=Ae.prevZ,ln=Ae.nextZ;$r&&$r.z>=li&&ln&&ln.z<=Kn;){if($r.x>=Qr&&$r.x<=Mr&&$r.y>=tn&&$r.y<=$n&&$r!==ze&&$r!==Ut&&Ge(kt,Xr,pr,fn,Wt,Ir,$r.x,$r.y)&&Me($r.prev,$r,$r.next)>=0||($r=$r.prevZ,ln.x>=Qr&&ln.x<=Mr&&ln.y>=tn&&ln.y<=$n&&ln!==ze&&ln!==Ut&&Ge(kt,Xr,pr,fn,Wt,Ir,ln.x,ln.y)&&Me(ln.prev,ln,ln.next)>=0))return!1;ln=ln.nextZ}for(;$r&&$r.z>=li;){if($r.x>=Qr&&$r.x<=Mr&&$r.y>=tn&&$r.y<=$n&&$r!==ze&&$r!==Ut&&Ge(kt,Xr,pr,fn,Wt,Ir,$r.x,$r.y)&&Me($r.prev,$r,$r.next)>=0)return!1;$r=$r.prevZ}for(;ln&&ln.z<=Kn;){if(ln.x>=Qr&&ln.x<=Mr&&ln.y>=tn&&ln.y<=$n&&ln!==ze&&ln!==Ut&&Ge(kt,Xr,pr,fn,Wt,Ir,ln.x,ln.y)&&Me(ln.prev,ln,ln.next)>=0)return!1;ln=ln.nextZ}return!0}function B(Ae,_e,ue){var ke=Ae;do{var ze=ke.prev,le=ke.next.next;!ce(ze,le)&&Be(ze,ke,ke.next,le)&&Y(ze,le)&&Y(le,ze)&&(_e.push(ze.i/ue|0),_e.push(ke.i/ue|0),_e.push(le.i/ue|0),ye(ke),ye(ke.next),ke=Ae=le),ke=ke.next}while(ke!==Ae);return I(ke)}function Z(Ae,_e,ue,ke,ze,le){var Ut=Ae;do{for(var kt=Ut.next.next;kt!==Ut.prev;){if(Ut.i!==kt.i&&Re(Ut,kt)){var pr=ge(Ut,kt);Ut=I(Ut,Ut.next),pr=I(pr,pr.next),D(Ut,_e,ue,ke,ze,le,0),D(pr,_e,ue,ke,ze,le,0);return}kt=kt.next}Ut=Ut.next}while(Ut!==Ae)}function X(Ae,_e,ue,ke){var ze=[],le,Ut,kt,pr,Wt;for(le=0,Ut=_e.length;le<Ut;le++)kt=_e[le]*ke,pr=le<Ut-1?_e[le+1]*ke:Ae.length,Wt=C(Ae,kt,pr,ke,!1),Wt===Wt.next&&(Wt.steiner=!0),ze.push(De(Wt));for(ze.sort(q),le=0;le<ze.length;le++)ue=ie(ze[le],ue);return ue}function q(Ae,_e){return Ae.x-_e.x}function ie(Ae,_e){var ue=he(Ae,_e);if(!ue)return _e;var ke=ge(ue,Ae);return I(ke,ke.next),I(ue,ue.next)}function he(Ae,_e){var ue=_e,ke=Ae.x,ze=Ae.y,le=-1/0,Ut;do{if(ze<=ue.y&&ze>=ue.next.y&&ue.next.y!==ue.y){var kt=ue.x+(ze-ue.y)*(ue.next.x-ue.x)/(ue.next.y-ue.y);if(kt<=ke&&kt>le&&(le=kt,Ut=ue.x<ue.next.x?ue:ue.next,kt===ke))return Ut}ue=ue.next}while(ue!==_e);if(!Ut)return null;var pr=Ut,Wt=Ut.x,Xr=Ut.y,fn=1/0,Ir;ue=Ut;do ke>=ue.x&&ue.x>=Wt&&ke!==ue.x&&Ge(ze<Xr?ke:le,ze,Wt,Xr,ze<Xr?le:ke,ze,ue.x,ue.y)&&(Ir=Math.abs(ze-ue.y)/(ke-ue.x),Y(ue,Ae)&&(Ir<fn||Ir===fn&&(ue.x>Ut.x||ue.x===Ut.x&&Ce(Ut,ue)))&&(Ut=ue,fn=Ir)),ue=ue.next;while(ue!==pr);return Ut}function Ce(Ae,_e){return Me(Ae.prev,Ae,_e.prev)<0&&Me(_e.next,Ae,Ae.next)<0}function be(Ae,_e,ue,ke){var ze=Ae;do ze.z===0&&(ze.z=qe(ze.x,ze.y,_e,ue,ke)),ze.prevZ=ze.prev,ze.nextZ=ze.next,ze=ze.next;while(ze!==Ae);ze.prevZ.nextZ=null,ze.prevZ=null,Ze(ze)}function Ze(Ae){var _e,ue,ke,ze,le,Ut,kt,pr,Wt=1;do{for(ue=Ae,Ae=null,le=null,Ut=0;ue;){for(Ut++,ke=ue,kt=0,_e=0;_e<Wt&&(kt++,ke=ke.nextZ,!!ke);_e++);for(pr=Wt;kt>0||pr>0&&ke;)kt!==0&&(pr===0||!ke||ue.z<=ke.z)?(ze=ue,ue=ue.nextZ,kt--):(ze=ke,ke=ke.nextZ,pr--),le?le.nextZ=ze:Ae=ze,ze.prevZ=le,le=ze;ue=ke}le.nextZ=null,Wt*=2}while(Ut>1);return Ae}function qe(Ae,_e,ue,ke,ze){return Ae=(Ae-ue)*ze|0,_e=(_e-ke)*ze|0,Ae=(Ae|Ae<<8)&16711935,Ae=(Ae|Ae<<4)&252645135,Ae=(Ae|Ae<<2)&858993459,Ae=(Ae|Ae<<1)&1431655765,_e=(_e|_e<<8)&16711935,_e=(_e|_e<<4)&252645135,_e=(_e|_e<<2)&858993459,_e=(_e|_e<<1)&1431655765,Ae|_e<<1}function De(Ae){var _e=Ae,ue=Ae;do(_e.x<ue.x||_e.x===ue.x&&_e.y<ue.y)&&(ue=_e),_e=_e.next;while(_e!==Ae);return ue}function Ge(Ae,_e,ue,ke,ze,le,Ut,kt){return(ze-Ut)*(_e-kt)>=(Ae-Ut)*(le-kt)&&(Ae-Ut)*(ke-kt)>=(ue-Ut)*(_e-kt)&&(ue-Ut)*(le-kt)>=(ze-Ut)*(ke-kt)}function Re(Ae,_e){return Ae.next.i!==_e.i&&Ae.prev.i!==_e.i&&!oe(Ae,_e)&&(Y(Ae,_e)&&Y(_e,Ae)&&Ne(Ae,_e)&&(Me(Ae.prev,Ae,_e.prev)||Me(Ae,_e.prev,_e))||ce(Ae,_e)&&Me(Ae.prev,Ae,Ae.next)>0&&Me(_e.prev,_e,_e.next)>0)}function Me(Ae,_e,ue){return(_e.y-Ae.y)*(ue.x-_e.x)-(_e.x-Ae.x)*(ue.y-_e.y)}function ce(Ae,_e){return Ae.x===_e.x&&Ae.y===_e.y}function Be(Ae,_e,ue,ke){var ze=Se(Me(Ae,_e,ue)),le=Se(Me(Ae,_e,ke)),Ut=Se(Me(ue,ke,Ae)),kt=Se(Me(ue,ke,_e));return!!(ze!==le&&Ut!==kt||ze===0&&Ee(Ae,ue,_e)||le===0&&Ee(Ae,ke,_e)||Ut===0&&Ee(ue,Ae,ke)||kt===0&&Ee(ue,_e,ke))}function Ee(Ae,_e,ue){return _e.x<=Math.max(Ae.x,ue.x)&&_e.x>=Math.min(Ae.x,ue.x)&&_e.y<=Math.max(Ae.y,ue.y)&&_e.y>=Math.min(Ae.y,ue.y)}function Se(Ae){return Ae>0?1:Ae<0?-1:0}function oe(Ae,_e){var ue=Ae;do{if(ue.i!==Ae.i&&ue.next.i!==Ae.i&&ue.i!==_e.i&&ue.next.i!==_e.i&&Be(ue,ue.next,Ae,_e))return!0;ue=ue.next}while(ue!==Ae);return!1}function Y(Ae,_e){return Me(Ae.prev,Ae,Ae.next)<0?Me(Ae,_e,Ae.next)>=0&&Me(Ae,Ae.prev,_e)>=0:Me(Ae,_e,Ae.prev)<0||Me(Ae,Ae.next,_e)<0}function Ne(Ae,_e){var ue=Ae,ke=!1,ze=(Ae.x+_e.x)/2,le=(Ae.y+_e.y)/2;do ue.y>le!=ue.next.y>le&&ue.next.y!==ue.y&&ze<(ue.next.x-ue.x)*(le-ue.y)/(ue.next.y-ue.y)+ue.x&&(ke=!ke),ue=ue.next;while(ue!==Ae);return ke}function ge(Ae,_e){var ue=new Q(Ae.i,Ae.x,Ae.y),ke=new Q(_e.i,_e.x,_e.y),ze=Ae.next,le=_e.prev;return Ae.next=_e,_e.prev=Ae,ue.next=ze,ze.prev=ue,ke.next=ue,ue.prev=ke,le.next=ke,ke.prev=le,ke}function xe(Ae,_e,ue,ke){var ze=new Q(Ae,_e,ue);return ke?(ze.next=ke.next,ze.prev=ke,ke.next.prev=ze,ke.next=ze):(ze.prev=ze,ze.next=ze),ze}function ye(Ae){Ae.next.prev=Ae.prev,Ae.prev.next=Ae.next,Ae.prevZ&&(Ae.prevZ.nextZ=Ae.nextZ),Ae.nextZ&&(Ae.nextZ.prevZ=Ae.prevZ)}function Q(Ae,_e,ue){this.i=Ae,this.x=_e,this.y=ue,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}j.deviation=function(Ae,_e,ue,ke){var ze=_e&&_e.length,le=ze?_e[0]*ue:Ae.length,Ut=Math.abs(Pe(Ae,0,le,ue));if(ze)for(var kt=0,pr=_e.length;kt<pr;kt++){var Wt=_e[kt]*ue,Xr=kt<pr-1?_e[kt+1]*ue:Ae.length;Ut-=Math.abs(Pe(Ae,Wt,Xr,ue))}var fn=0;for(kt=0;kt<ke.length;kt+=3){var Ir=ke[kt]*ue,Qr=ke[kt+1]*ue,tn=ke[kt+2]*ue;fn+=Math.abs((Ae[Ir]-Ae[tn])*(Ae[Qr+1]-Ae[Ir+1])-(Ae[Ir]-Ae[Qr])*(Ae[tn+1]-Ae[Ir+1]))}return Ut===0&&fn===0?0:Math.abs((fn-Ut)/Ut)};function Pe(Ae,_e,ue,ke){for(var ze=0,le=_e,Ut=ue-ke;le<ue;le+=ke)ze+=(Ae[Ut]-Ae[le])*(Ae[le+1]+Ae[Ut+1]),Ut=le;return ze}j.flatten=function(Ae){for(var _e=Ae[0][0].length,ue={vertices:[],holes:[],dimensions:_e},ke=0,ze=0;ze<Ae.length;ze++){for(var le=0;le<Ae[ze].length;le++)for(var Ut=0;Ut<_e;Ut++)ue.vertices.push(Ae[ze][le][Ut]);ze>0&&(ke+=Ae[ze-1].length,ue.holes.push(ke))}return ue}},67499:function(ae){function j(I){var D=I.target||I.srcElement;D.__resizeRAF__&&cancelAnimationFrame(D.__resizeRAF__),D.__resizeRAF__=requestAnimationFrame(function(){var G=D.__resizeTrigger__,U=G&&G.__resizeListeners__;U&&U.forEach(function(B){B.call(G,I)})})}var C=function(D,G){var U=this,B=U.document,Z,X=B.attachEvent;typeof navigator!="undefined"&&(Z=navigator.userAgent.match(/Trident/)||navigator.userAgent.match(/Edge/));function q(){this.contentDocument.defaultView.__resizeTrigger__=this.__resizeElement__,this.contentDocument.defaultView.addEventListener("resize",j)}if(!D.__resizeListeners__)if(D.__resizeListeners__=[],X)D.__resizeTrigger__=D,D.attachEvent("onresize",j);else{getComputedStyle(D).position==="static"&&(D.style.position="relative");var ie=D.__resizeTrigger__=B.createElement("object");ie.setAttribute("style","position: absolute; top: 0; left: 0; height: 100%; width: 100%; pointer-events: none; z-index: -1; opacity: 0;"),ie.setAttribute("class","resize-sensor"),ie.setAttribute("tabindex","-1"),ie.setAttribute("title",""),ie.__resizeElement__=D,ie.onload=q,ie.type="text/html",Z&&D.appendChild(ie),ie.data="about:blank",Z||D.appendChild(ie)}D.__resizeListeners__.push(G)};ae.exports=typeof window=="undefined"?C:C.bind(window),ae.exports.unbind=function(I,D){var G=document.attachEvent,U=I.__resizeListeners__||[];if(D){var B=U.indexOf(D);B!==-1&&U.splice(B,1)}else U=I.__resizeListeners__=[];if(!U.length){if(G)I.detachEvent("onresize",j);else if(I.__resizeTrigger__){var Z=I.__resizeTrigger__.contentDocument,X=Z&&Z.defaultView;X&&(X.removeEventListener("resize",j),delete X.__resizeTrigger__),I.__resizeTrigger__=!I.removeChild(I.__resizeTrigger__)}delete I.__resizeListeners__}}},40666:function(ae){"use strict";var j=Object.prototype.hasOwnProperty,C="~";function I(){}Object.create&&(I.prototype=Object.create(null),new I().__proto__||(C=!1));function D(Z,X,q){this.fn=Z,this.context=X,this.once=q||!1}function G(Z,X,q,ie,he){if(typeof q!="function")throw new TypeError("The listener must be a function");var Ce=new D(q,ie||Z,he),be=C?C+X:X;return Z._events[be]?Z._events[be].fn?Z._events[be]=[Z._events[be],Ce]:Z._events[be].push(Ce):(Z._events[be]=Ce,Z._eventsCount++),Z}function U(Z,X){--Z._eventsCount===0?Z._events=new I:delete Z._events[X]}function B(){this._events=new I,this._eventsCount=0}B.prototype.eventNames=function(){var X=[],q,ie;if(this._eventsCount===0)return X;for(ie in q=this._events)j.call(q,ie)&&X.push(C?ie.slice(1):ie);return Object.getOwnPropertySymbols?X.concat(Object.getOwnPropertySymbols(q)):X},B.prototype.listeners=function(X){var q=C?C+X:X,ie=this._events[q];if(!ie)return[];if(ie.fn)return[ie.fn];for(var he=0,Ce=ie.length,be=new Array(Ce);he<Ce;he++)be[he]=ie[he].fn;return be},B.prototype.listenerCount=function(X){var q=C?C+X:X,ie=this._events[q];return ie?ie.fn?1:ie.length:0},B.prototype.emit=function(X,q,ie,he,Ce,be){var Ze=C?C+X:X;if(!this._events[Ze])return!1;var qe=this._events[Ze],De=arguments.length,Ge,Re;if(qe.fn){switch(qe.once&&this.removeListener(X,qe.fn,void 0,!0),De){case 1:return qe.fn.call(qe.context),!0;case 2:return qe.fn.call(qe.context,q),!0;case 3:return qe.fn.call(qe.context,q,ie),!0;case 4:return qe.fn.call(qe.context,q,ie,he),!0;case 5:return qe.fn.call(qe.context,q,ie,he,Ce),!0;case 6:return qe.fn.call(qe.context,q,ie,he,Ce,be),!0}for(Re=1,Ge=new Array(De-1);Re<De;Re++)Ge[Re-1]=arguments[Re];qe.fn.apply(qe.context,Ge)}else{var Me=qe.length,ce;for(Re=0;Re<Me;Re++)switch(qe[Re].once&&this.removeListener(X,qe[Re].fn,void 0,!0),De){case 1:qe[Re].fn.call(qe[Re].context);break;case 2:qe[Re].fn.call(qe[Re].context,q);break;case 3:qe[Re].fn.call(qe[Re].context,q,ie);break;case 4:qe[Re].fn.call(qe[Re].context,q,ie,he);break;default:if(!Ge)for(ce=1,Ge=new Array(De-1);ce<De;ce++)Ge[ce-1]=arguments[ce];qe[Re].fn.apply(qe[Re].context,Ge)}}return!0},B.prototype.on=function(X,q,ie){return G(this,X,q,ie,!1)},B.prototype.once=function(X,q,ie){return G(this,X,q,ie,!0)},B.prototype.removeListener=function(X,q,ie,he){var Ce=C?C+X:X;if(!this._events[Ce])return this;if(!q)return U(this,Ce),this;var be=this._events[Ce];if(be.fn)be.fn===q&&(!he||be.once)&&(!ie||be.context===ie)&&U(this,Ce);else{for(var Ze=0,qe=[],De=be.length;Ze<De;Ze++)(be[Ze].fn!==q||he&&!be[Ze].once||ie&&be[Ze].context!==ie)&&qe.push(be[Ze]);qe.length?this._events[Ce]=qe.length===1?qe[0]:qe:U(this,Ce)}return this},B.prototype.removeAllListeners=function(X){var q;return X?(q=C?C+X:X,this._events[q]&&U(this,q)):(this._events=new I,this._eventsCount=0),this},B.prototype.off=B.prototype.removeListener,B.prototype.addListener=B.prototype.on,B.prefixed=C,B.EventEmitter=B,ae.exports=B},37271:function(ae){"use strict";var j=Object.prototype.hasOwnProperty,C="~";function I(){}Object.create&&(I.prototype=Object.create(null),new I().__proto__||(C=!1));function D(Z,X,q){this.fn=Z,this.context=X,this.once=q||!1}function G(Z,X,q,ie,he){if(typeof q!="function")throw new TypeError("The listener must be a function");var Ce=new D(q,ie||Z,he),be=C?C+X:X;return Z._events[be]?Z._events[be].fn?Z._events[be]=[Z._events[be],Ce]:Z._events[be].push(Ce):(Z._events[be]=Ce,Z._eventsCount++),Z}function U(Z,X){--Z._eventsCount===0?Z._events=new I:delete Z._events[X]}function B(){this._events=new I,this._eventsCount=0}B.prototype.eventNames=function(){var X=[],q,ie;if(this._eventsCount===0)return X;for(ie in q=this._events)j.call(q,ie)&&X.push(C?ie.slice(1):ie);return Object.getOwnPropertySymbols?X.concat(Object.getOwnPropertySymbols(q)):X},B.prototype.listeners=function(X){var q=C?C+X:X,ie=this._events[q];if(!ie)return[];if(ie.fn)return[ie.fn];for(var he=0,Ce=ie.length,be=new Array(Ce);he<Ce;he++)be[he]=ie[he].fn;return be},B.prototype.listenerCount=function(X){var q=C?C+X:X,ie=this._events[q];return ie?ie.fn?1:ie.length:0},B.prototype.emit=function(X,q,ie,he,Ce,be){var Ze=C?C+X:X;if(!this._events[Ze])return!1;var qe=this._events[Ze],De=arguments.length,Ge,Re;if(qe.fn){switch(qe.once&&this.removeListener(X,qe.fn,void 0,!0),De){case 1:return qe.fn.call(qe.context),!0;case 2:return qe.fn.call(qe.context,q),!0;case 3:return qe.fn.call(qe.context,q,ie),!0;case 4:return qe.fn.call(qe.context,q,ie,he),!0;case 5:return qe.fn.call(qe.context,q,ie,he,Ce),!0;case 6:return qe.fn.call(qe.context,q,ie,he,Ce,be),!0}for(Re=1,Ge=new Array(De-1);Re<De;Re++)Ge[Re-1]=arguments[Re];qe.fn.apply(qe.context,Ge)}else{var Me=qe.length,ce;for(Re=0;Re<Me;Re++)switch(qe[Re].once&&this.removeListener(X,qe[Re].fn,void 0,!0),De){case 1:qe[Re].fn.call(qe[Re].context);break;case 2:qe[Re].fn.call(qe[Re].context,q);break;case 3:qe[Re].fn.call(qe[Re].context,q,ie);break;case 4:qe[Re].fn.call(qe[Re].context,q,ie,he);break;default:if(!Ge)for(ce=1,Ge=new Array(De-1);ce<De;ce++)Ge[ce-1]=arguments[ce];qe[Re].fn.apply(qe[Re].context,Ge)}}return!0},B.prototype.on=function(X,q,ie){return G(this,X,q,ie,!1)},B.prototype.once=function(X,q,ie){return G(this,X,q,ie,!0)},B.prototype.removeListener=function(X,q,ie,he){var Ce=C?C+X:X;if(!this._events[Ce])return this;if(!q)return U(this,Ce),this;var be=this._events[Ce];if(be.fn)be.fn===q&&(!he||be.once)&&(!ie||be.context===ie)&&U(this,Ce);else{for(var Ze=0,qe=[],De=be.length;Ze<De;Ze++)(be[Ze].fn!==q||he&&!be[Ze].once||ie&&be[Ze].context!==ie)&&qe.push(be[Ze]);qe.length?this._events[Ce]=qe.length===1?qe[0]:qe:U(this,Ce)}return this},B.prototype.removeAllListeners=function(X){var q;return X?(q=C?C+X:X,this._events[q]&&U(this,q)):(this._events=new I,this._eventsCount=0),this},B.prototype.off=B.prototype.removeListener,B.prototype.addListener=B.prototype.on,B.prefixed=C,B.EventEmitter=B,ae.exports=B},98269:function(ae){"use strict";var j="Function.prototype.bind called on incompatible ",C=Object.prototype.toString,I=Math.max,D="[object Function]",G=function(X,q){for(var ie=[],he=0;he<X.length;he+=1)ie[he]=X[he];for(var Ce=0;Ce<q.length;Ce+=1)ie[Ce+X.length]=q[Ce];return ie},U=function(X,q){for(var ie=[],he=q||0,Ce=0;he<X.length;he+=1,Ce+=1)ie[Ce]=X[he];return ie},B=function(Z,X){for(var q="",ie=0;ie<Z.length;ie+=1)q+=Z[ie],ie+1<Z.length&&(q+=X);return q};ae.exports=function(X){var q=this;if(typeof q!="function"||C.apply(q)!==D)throw new TypeError(j+q);for(var ie=U(arguments,1),he,Ce=function(){if(this instanceof he){var Ge=q.apply(this,G(ie,arguments));return Object(Ge)===Ge?Ge:this}return q.apply(X,G(ie,arguments))},be=I(0,q.length-ie.length),Ze=[],qe=0;qe<be;qe++)Ze[qe]="$"+qe;if(he=Function("binder","return function ("+B(Ze,",")+"){ return binder.apply(this,arguments); }")(Ce),q.prototype){var De=function(){};De.prototype=q.prototype,he.prototype=new De,De.prototype=null}return he}},36723:function(ae,j,C){"use strict";var I=C(98269);ae.exports=Function.prototype.bind||I},8325:function(ae){"use strict";var j=function(){return typeof function(){}.name=="string"},C=Object.getOwnPropertyDescriptor;if(C)try{C([],"length")}catch(D){C=null}j.functionsHaveConfigurableNames=function(){if(!j()||!C)return!1;var G=C(function(){},"name");return!!G&&!!G.configurable};var I=Function.prototype.bind;j.boundFunctionsHaveNames=function(){return j()&&typeof I=="function"&&function(){}.bind().name!==""},ae.exports=j},15468:function(ae,j,C){var I=C(19545),D=function(Z){this.precision=Z&&Z.precision?Z.precision:17,this.direction=Z&&Z.direction?Z.direction:!1,this.pseudoNode=Z&&Z.pseudoNode?Z.pseudoNode:!1,this.objectComparator=Z&&Z.objectComparator?Z.objectComparator:B};D.prototype.compare=function(Z,X){if(Z.type!==X.type||!U(Z,X))return!1;switch(Z.type){case"Point":return this.compareCoord(Z.coordinates,X.coordinates);case"LineString":return this.compareLine(Z.coordinates,X.coordinates,0,!1);case"Polygon":return this.comparePolygon(Z,X);case"Feature":return this.compareFeature(Z,X);default:if(Z.type.indexOf("Multi")===0){var q=this,ie=G(Z),he=G(X);return ie.every(function(Ce){return this.some(function(be){return q.compare(Ce,be)})},he)}}return!1};function G(Z){return Z.coordinates.map(function(X){return{type:Z.type.replace("Multi",""),coordinates:X}})}function U(Z,X){return Z.hasOwnProperty("coordinates")?Z.coordinates.length===X.coordinates.length:Z.length===X.length}D.prototype.compareCoord=function(Z,X){if(Z.length!==X.length)return!1;for(var q=0;q<Z.length;q++)if(Z[q].toFixed(this.precision)!==X[q].toFixed(this.precision))return!1;return!0},D.prototype.compareLine=function(Z,X,q,ie){if(!U(Z,X))return!1;var he=this.pseudoNode?Z:this.removePseudo(Z),Ce=this.pseudoNode?X:this.removePseudo(X);if(!(ie&&!this.compareCoord(he[0],Ce[0])&&(Ce=this.fixStartIndex(Ce,he),!Ce))){var be=this.compareCoord(he[q],Ce[q]);return this.direction||be?this.comparePath(he,Ce):this.compareCoord(he[q],Ce[Ce.length-(1+q)])?this.comparePath(he.slice().reverse(),Ce):!1}},D.prototype.fixStartIndex=function(Z,X){for(var q,ie=-1,he=0;he<Z.length;he++)if(this.compareCoord(Z[he],X[0])){ie=he;break}return ie>=0&&(q=[].concat(Z.slice(ie,Z.length),Z.slice(1,ie+1))),q},D.prototype.comparePath=function(Z,X){var q=this;return Z.every(function(ie,he){return q.compareCoord(ie,this[he])},X)},D.prototype.comparePolygon=function(Z,X){if(this.compareLine(Z.coordinates[0],X.coordinates[0],1,!0)){var q=Z.coordinates.slice(1,Z.coordinates.length),ie=X.coordinates.slice(1,X.coordinates.length),he=this;return q.every(function(Ce){return this.some(function(be){return he.compareLine(Ce,be,1,!0)})},ie)}else return!1},D.prototype.compareFeature=function(Z,X){return Z.id!==X.id||!this.objectComparator(Z.properties,X.properties)||!this.compareBBox(Z,X)?!1:this.compare(Z.geometry,X.geometry)},D.prototype.compareBBox=function(Z,X){return!!(!Z.bbox&&!X.bbox||Z.bbox&&X.bbox&&this.compareCoord(Z.bbox,X.bbox))},D.prototype.removePseudo=function(Z){return Z};function B(Z,X){return I(Z,X,{strict:!0})}ae.exports=D},56898:function(ae,j,C){var I=C(79535),D=C(78161),G=C(9750),U=C(76314).Z,B=G.featureEach,Z=G.coordEach,X=D.polygon,q=D.featureCollection;function ie(he){var Ce=new I(he);return Ce.insert=function(be){if(be.type!=="Feature")throw new Error("invalid feature");return be.bbox=be.bbox?be.bbox:U(be),I.prototype.insert.call(this,be)},Ce.load=function(be){var Ze=[];return Array.isArray(be)?be.forEach(function(qe){if(qe.type!=="Feature")throw new Error("invalid features");qe.bbox=qe.bbox?qe.bbox:U(qe),Ze.push(qe)}):B(be,function(qe){if(qe.type!=="Feature")throw new Error("invalid features");qe.bbox=qe.bbox?qe.bbox:U(qe),Ze.push(qe)}),I.prototype.load.call(this,Ze)},Ce.remove=function(be,Ze){if(be.type!=="Feature")throw new Error("invalid feature");return be.bbox=be.bbox?be.bbox:U(be),I.prototype.remove.call(this,be,Ze)},Ce.clear=function(){return I.prototype.clear.call(this)},Ce.search=function(be){var Ze=I.prototype.search.call(this,this.toBBox(be));return q(Ze)},Ce.collides=function(be){return I.prototype.collides.call(this,this.toBBox(be))},Ce.all=function(){var be=I.prototype.all.call(this);return q(be)},Ce.toJSON=function(){return I.prototype.toJSON.call(this)},Ce.fromJSON=function(be){return I.prototype.fromJSON.call(this,be)},Ce.toBBox=function(be){var Ze;if(be.bbox)Ze=be.bbox;else if(Array.isArray(be)&&be.length===4)Ze=be;else if(Array.isArray(be)&&be.length===6)Ze=[be[0],be[1],be[3],be[4]];else if(be.type==="Feature")Ze=U(be);else if(be.type==="FeatureCollection")Ze=U(be);else throw new Error("invalid geojson");return{minX:Ze[0],minY:Ze[1],maxX:Ze[2],maxY:Ze[3]}},Ce}ae.exports=ie,ae.exports.default=ie},44532:function(ae,j,C){"use strict";var I,D=SyntaxError,G=Function,U=TypeError,B=function(Q){try{return G('"use strict"; return ('+Q+").constructor;")()}catch(Pe){}},Z=Object.getOwnPropertyDescriptor;if(Z)try{Z({},"")}catch(Q){Z=null}var X=function(){throw new U},q=Z?function(){try{return arguments.callee,X}catch(Q){try{return Z(arguments,"callee").get}catch(Pe){return X}}}():X,ie=C(9997)(),he=C(77916)(),Ce=Object.getPrototypeOf||(he?function(Q){return Q.__proto__}:null),be={},Ze=typeof Uint8Array=="undefined"||!Ce?I:Ce(Uint8Array),qe={"%AggregateError%":typeof AggregateError=="undefined"?I:AggregateError,"%Array%":Array,"%ArrayBuffer%":typeof ArrayBuffer=="undefined"?I:ArrayBuffer,"%ArrayIteratorPrototype%":ie&&Ce?Ce([][Symbol.iterator]()):I,"%AsyncFromSyncIteratorPrototype%":I,"%AsyncFunction%":be,"%AsyncGenerator%":be,"%AsyncGeneratorFunction%":be,"%AsyncIteratorPrototype%":be,"%Atomics%":typeof Atomics=="undefined"?I:Atomics,"%BigInt%":typeof BigInt=="undefined"?I:BigInt,"%BigInt64Array%":typeof BigInt64Array=="undefined"?I:BigInt64Array,"%BigUint64Array%":typeof BigUint64Array=="undefined"?I:BigUint64Array,"%Boolean%":Boolean,"%DataView%":typeof DataView=="undefined"?I:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":Error,"%eval%":eval,"%EvalError%":EvalError,"%Float32Array%":typeof Float32Array=="undefined"?I:Float32Array,"%Float64Array%":typeof Float64Array=="undefined"?I:Float64Array,"%FinalizationRegistry%":typeof FinalizationRegistry=="undefined"?I:FinalizationRegistry,"%Function%":G,"%GeneratorFunction%":be,"%Int8Array%":typeof Int8Array=="undefined"?I:Int8Array,"%Int16Array%":typeof Int16Array=="undefined"?I:Int16Array,"%Int32Array%":typeof Int32Array=="undefined"?I:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":ie&&Ce?Ce(Ce([][Symbol.iterator]())):I,"%JSON%":typeof JSON=="object"?JSON:I,"%Map%":typeof Map=="undefined"?I:Map,"%MapIteratorPrototype%":typeof Map=="undefined"||!ie||!Ce?I:Ce(new Map()[Symbol.iterator]()),"%Math%":Math,"%Number%":Number,"%Object%":Object,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":typeof Promise=="undefined"?I:Promise,"%Proxy%":typeof Proxy=="undefined"?I:Proxy,"%RangeError%":RangeError,"%ReferenceError%":ReferenceError,"%Reflect%":typeof Reflect=="undefined"?I:Reflect,"%RegExp%":RegExp,"%Set%":typeof Set=="undefined"?I:Set,"%SetIteratorPrototype%":typeof Set=="undefined"||!ie||!Ce?I:Ce(new Set()[Symbol.iterator]()),"%SharedArrayBuffer%":typeof SharedArrayBuffer=="undefined"?I:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":ie&&Ce?Ce(""[Symbol.iterator]()):I,"%Symbol%":ie?Symbol:I,"%SyntaxError%":D,"%ThrowTypeError%":q,"%TypedArray%":Ze,"%TypeError%":U,"%Uint8Array%":typeof Uint8Array=="undefined"?I:Uint8Array,"%Uint8ClampedArray%":typeof Uint8ClampedArray=="undefined"?I:Uint8ClampedArray,"%Uint16Array%":typeof Uint16Array=="undefined"?I:Uint16Array,"%Uint32Array%":typeof Uint32Array=="undefined"?I:Uint32Array,"%URIError%":URIError,"%WeakMap%":typeof WeakMap=="undefined"?I:WeakMap,"%WeakRef%":typeof WeakRef=="undefined"?I:WeakRef,"%WeakSet%":typeof WeakSet=="undefined"?I:WeakSet};if(Ce)try{null.error}catch(Q){var De=Ce(Ce(Q));qe["%Error.prototype%"]=De}var Ge=function Q(Pe){var Ae;if(Pe==="%AsyncFunction%")Ae=B("async function () {}");else if(Pe==="%GeneratorFunction%")Ae=B("function* () {}");else if(Pe==="%AsyncGeneratorFunction%")Ae=B("async function* () {}");else if(Pe==="%AsyncGenerator%"){var _e=Q("%AsyncGeneratorFunction%");_e&&(Ae=_e.prototype)}else if(Pe==="%AsyncIteratorPrototype%"){var ue=Q("%AsyncGenerator%");ue&&Ce&&(Ae=Ce(ue.prototype))}return qe[Pe]=Ae,Ae},Re={"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},Me=C(36723),ce=C(68854),Be=Me.call(Function.call,Array.prototype.concat),Ee=Me.call(Function.apply,Array.prototype.splice),Se=Me.call(Function.call,String.prototype.replace),oe=Me.call(Function.call,String.prototype.slice),Y=Me.call(Function.call,RegExp.prototype.exec),Ne=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,ge=/\\(\\)?/g,xe=function(Pe){var Ae=oe(Pe,0,1),_e=oe(Pe,-1);if(Ae==="%"&&_e!=="%")throw new D("invalid intrinsic syntax, expected closing `%`");if(_e==="%"&&Ae!=="%")throw new D("invalid intrinsic syntax, expected opening `%`");var ue=[];return Se(Pe,Ne,function(ke,ze,le,Ut){ue[ue.length]=le?Se(Ut,ge,"$1"):ze||ke}),ue},ye=function(Pe,Ae){var _e=Pe,ue;if(ce(Re,_e)&&(ue=Re[_e],_e="%"+ue[0]+"%"),ce(qe,_e)){var ke=qe[_e];if(ke===be&&(ke=Ge(_e)),typeof ke=="undefined"&&!Ae)throw new U("intrinsic "+Pe+" exists, but is not available. Please file an issue!");return{alias:ue,name:_e,value:ke}}throw new D("intrinsic "+Pe+" does not exist!")};ae.exports=function(Pe,Ae){if(typeof Pe!="string"||Pe.length===0)throw new U("intrinsic name must be a non-empty string");if(arguments.length>1&&typeof Ae!="boolean")throw new U('"allowMissing" argument must be a boolean');if(Y(/^%?[^%]*%?$/,Pe)===null)throw new D("`%` may not be present anywhere but at the beginning and end of the intrinsic name");var _e=xe(Pe),ue=_e.length>0?_e[0]:"",ke=ye("%"+ue+"%",Ae),ze=ke.name,le=ke.value,Ut=!1,kt=ke.alias;kt&&(ue=kt[0],Ee(_e,Be([0,1],kt)));for(var pr=1,Wt=!0;pr<_e.length;pr+=1){var Xr=_e[pr],fn=oe(Xr,0,1),Ir=oe(Xr,-1);if((fn==='"'||fn==="'"||fn==="`"||Ir==='"'||Ir==="'"||Ir==="`")&&fn!==Ir)throw new D("property names with quotes must have matching quotes");if((Xr==="constructor"||!Wt)&&(Ut=!0),ue+="."+Xr,ze="%"+ue+"%",ce(qe,ze))le=qe[ze];else if(le!=null){if(!(Xr in le)){if(!Ae)throw new U("base intrinsic for "+Pe+" exists, but the property is not available.");return}if(Z&&pr+1>=_e.length){var Qr=Z(le,Xr);Wt=!!Qr,Wt&&"get"in Qr&&!("originalValue"in Qr.get)?le=Qr.get:le=le[Xr]}else Wt=ce(le,Xr),le=le[Xr];Wt&&!Ut&&(qe[ze]=le)}}return le}},67747:function(ae,j,C){"use strict";var I=C(44532),D=I("%Object.getOwnPropertyDescriptor%",!0);if(D)try{D([],"length")}catch(G){D=null}ae.exports=D},51831:function(ae,j,C){"use strict";C.d(j,{jf:function(){return Fa},mD:function(){return Ds}});var I=function(bt){bt=bt||{};var Ye=typeof bt!="undefined"?bt:{},qt={},fe;for(fe in Ye)Ye.hasOwnProperty(fe)&&(qt[fe]=Ye[fe]);var Ue=[],Ke="";function Ht(st){return Ye.locateFile?Ye.locateFile(st,Ke):Ke+st}var vr;typeof document!="undefined"&&document.currentScript&&(Ke=document.currentScript.src),Ke.indexOf("blob:")!==0?Ke=Ke.substr(0,Ke.lastIndexOf("/")+1):Ke="",vr=function(Gt,ir,br){var g=new XMLHttpRequest;g.open("GET",Gt,!0),g.responseType="arraybuffer",g.onload=function(){if(g.status==200||g.status==0&&g.response){ir(g.response);return}var Jn=ms(Gt);if(Jn){ir(Jn.buffer);return}br()},g.onerror=br,g.send(null)};var Nr=Ye.print||console.log.bind(console),mn=Ye.printErr||console.warn.bind(console);for(fe in qt)qt.hasOwnProperty(fe)&&(Ye[fe]=qt[fe]);qt=null,Ye.arguments&&(Ue=Ye.arguments);var zn=0,Mi=function(st){zn=st},Ro=function(){return zn},Ms=8;function Xs(st,Gt,ir,br){switch(ir=ir||"i8",ir.charAt(ir.length-1)==="*"&&(ir="i32"),ir){case"i1":Is[st>>0]=Gt;break;case"i8":Is[st>>0]=Gt;break;case"i16":Ya[st>>1]=Gt;break;case"i32":wu[st>>2]=Gt;break;case"i64":Bs=[Gt>>>0,(Ra=Gt,+nf(Ra)>=1?Ra>0?(Pa(+Aa(Ra/4294967296),4294967295)|0)>>>0:~~+m0((Ra-+(~~Ra>>>0))/4294967296)>>>0:0)],wu[st>>2]=Bs[0],wu[st+4>>2]=Bs[1];break;case"float":cc[st>>2]=Gt;break;case"double":Pf[st>>3]=Gt;break;default:ar("invalid type for setValue: "+ir)}}function If(st,Gt,ir){switch(Gt=Gt||"i8",Gt.charAt(Gt.length-1)==="*"&&(Gt="i32"),Gt){case"i1":return Is[st>>0];case"i8":return Is[st>>0];case"i16":return Ya[st>>1];case"i32":return wu[st>>2];case"i64":return wu[st>>2];case"float":return cc[st>>2];case"double":return Pf[st>>3];default:ar("invalid type for getValue: "+Gt)}return null}var uu=!1;function ca(st,Gt){st||ar("Assertion failed: "+Gt)}function Dc(st){var Gt=Ye["_"+st];return ca(Gt,"Cannot call unknown function "+st+", make sure it is exported"),Gt}function ns(st,Gt,ir,br,g){var Bn={string:function(Es){var Ma=0;if(Es!=null&&Es!==0){var Yr=(Es.length<<2)+1;Ma=u(Yr),Ys(Es,Ma,Yr)}return Ma},array:function(Es){var Ma=u(Es.length);return ws(Es,Ma),Ma}};function Jn(Es){return Gt==="string"?Fn(Es):Gt==="boolean"?!!Es:Es}var et=Dc(st),Za=[],Eo=0;if(br)for(var oo=0;oo<br.length;oo++){var xa=Bn[ir[oo]];xa?(Eo===0&&(Eo=y()),Za[oo]=xa(br[oo])):Za[oo]=br[oo]}var vo=et.apply(null,Za);return vo=Jn(vo),Eo!==0&&v(Eo),vo}function Lc(st,Gt,ir,br){ir=ir||[];var g=ir.every(function(Jn){return Jn==="number"}),Bn=Gt!=="string";return Bn&&g&&!br?Dc(st):function(){return ns(st,Gt,ir,arguments,br)}}var ol=typeof TextDecoder!="undefined"?new TextDecoder("utf8"):void 0;function Xa(st,Gt,ir){for(var br=Gt+ir,g=Gt;st[g]&&!(g>=br);)++g;if(g-Gt>16&&st.subarray&&ol)return ol.decode(st.subarray(Gt,g));for(var Bn="";Gt<g;){var Jn=st[Gt++];if(!(Jn&128)){Bn+=String.fromCharCode(Jn);continue}var et=st[Gt++]&63;if((Jn&224)==192){Bn+=String.fromCharCode((Jn&31)<<6|et);continue}var Za=st[Gt++]&63;if((Jn&240)==224?Jn=(Jn&15)<<12|et<<6|Za:Jn=(Jn&7)<<18|et<<12|Za<<6|st[Gt++]&63,Jn<65536)Bn+=String.fromCharCode(Jn);else{var Eo=Jn-65536;Bn+=String.fromCharCode(55296|Eo>>10,56320|Eo&1023)}}return Bn}function Fn(st,Gt){return st?Xa(io,st,Gt):""}function Wl(st,Gt,ir,br){if(!(br>0))return 0;for(var g=ir,Bn=ir+br-1,Jn=0;Jn<st.length;++Jn){var et=st.charCodeAt(Jn);if(et>=55296&&et<=57343){var Za=st.charCodeAt(++Jn);et=65536+((et&1023)<<10)|Za&1023}if(et<=127){if(ir>=Bn)break;Gt[ir++]=et}else if(et<=2047){if(ir+1>=Bn)break;Gt[ir++]=192|et>>6,Gt[ir++]=128|et&63}else if(et<=65535){if(ir+2>=Bn)break;Gt[ir++]=224|et>>12,Gt[ir++]=128|et>>6&63,Gt[ir++]=128|et&63}else{if(ir+3>=Bn)break;Gt[ir++]=240|et>>18,Gt[ir++]=128|et>>12&63,Gt[ir++]=128|et>>6&63,Gt[ir++]=128|et&63}}return Gt[ir]=0,ir-g}function Ys(st,Gt,ir){return Wl(st,io,Gt,ir)}var lu=typeof TextDecoder!="undefined"?new TextDecoder("utf-16le"):void 0;function ws(st,Gt){Is.set(st,Gt)}function Mu(st,Gt){return st%Gt>0&&(st+=Gt-st%Gt),st}var wi,Is,io,Ya,ko,wu,$f,cc,Pf;function jl(st){wi=st,Ye.HEAP8=Is=new Int8Array(st),Ye.HEAP16=Ya=new Int16Array(st),Ye.HEAP32=wu=new Int32Array(st),Ye.HEAPU8=io=new Uint8Array(st),Ye.HEAPU16=ko=new Uint16Array(st),Ye.HEAPU32=$f=new Uint32Array(st),Ye.HEAPF32=cc=new Float32Array(st),Ye.HEAPF64=Pf=new Float64Array(st)}var vs=5267040,Ml=24128,yo=Ye.TOTAL_MEMORY||33554432;Ye.buffer?wi=Ye.buffer:wi=new ArrayBuffer(yo),yo=wi.byteLength,jl(wi),wu[Ml>>2]=vs;function ba(st){for(;st.length>0;){var Gt=st.shift();if(typeof Gt=="function"){Gt();continue}var ir=Gt.func;typeof ir=="number"?Gt.arg===void 0?Ye.dynCall_v(ir):Ye.dynCall_vi(ir,Gt.arg):ir(Gt.arg===void 0?null:Gt.arg)}}var gs=[],Xl=[],Ua=[],On=[];function wl(){if(Ye.preRun)for(typeof Ye.preRun=="function"&&(Ye.preRun=[Ye.preRun]);Ye.preRun.length;)Yl(Ye.preRun.shift());ba(gs)}function fc(){ba(Xl)}function is(){ba(Ua)}function cu(){if(Ye.postRun)for(typeof Ye.postRun=="function"&&(Ye.postRun=[Ye.postRun]);Ye.postRun.length;)Fc(Ye.postRun.shift());ba(On)}function Yl(st){gs.unshift(st)}function Fc(st){On.unshift(st)}var nf=Math.abs,m0=Math.ceil,Aa=Math.floor,Pa=Math.min,ma=0,Bc=null,ao=null;function Qf(st){ma++,Ye.monitorRunDependencies&&Ye.monitorRunDependencies(ma)}function Ni(st){if(ma--,Ye.monitorRunDependencies&&Ye.monitorRunDependencies(ma),ma==0&&(Bc!==null&&(clearInterval(Bc),Bc=null),ao)){var Gt=ao;ao=null,Gt()}}Ye.preloadedImages={},Ye.preloadedAudios={};var Yo=null,Sa="data:application/octet-stream;base64,";function Iu(st){return String.prototype.startsWith?st.startsWith(Sa):st.indexOf(Sa)===0}var Ra,Bs;Yo="data:application/octet-stream;base64,AAAAAAAAAAAAAAAAAQAAAAIAAAADAAAABAAAAAUAAAAGAAAAAQAAAAQAAAADAAAABgAAAAUAAAACAAAAAAAAAAIAAAADAAAAAQAAAAQAAAAGAAAAAAAAAAUAAAADAAAABgAAAAQAAAAFAAAAAAAAAAEAAAACAAAABAAAAAUAAAAGAAAAAAAAAAIAAAADAAAAAQAAAAUAAAACAAAAAAAAAAEAAAADAAAABgAAAAQAAAAGAAAAAAAAAAUAAAACAAAAAQAAAAQAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAEAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAIAAAADAAAAAAAAAAAAAAACAAAAAAAAAAEAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAABAAAAAYAAAAAAAAABQAAAAAAAAAAAAAABAAAAAUAAAAAAAAAAAAAAAAAAAACAAAAAAAAAAYAAAAAAAAABgAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAgAAAAMAAAAEAAAABQAAAAYAAAABAAAAAgAAAAMAAAAEAAAABQAAAAYAAAAAAAAAAgAAAAMAAAAEAAAABQAAAAYAAAAAAAAAAQAAAAMAAAAEAAAABQAAAAYAAAAAAAAAAQAAAAIAAAAEAAAABQAAAAYAAAAAAAAAAQAAAAIAAAADAAAABQAAAAYAAAAAAAAAAQAAAAIAAAADAAAABAAAAAYAAAAAAAAAAQAAAAIAAAADAAAABAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAwAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAgAAAAIAAAAAAAAAAAAAAAYAAAAAAAAAAwAAAAIAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAFAAAABAAAAAAAAAABAAAAAAAAAAAAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAYAAAAAAAAABAAAAAAAAAAGAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAFAAAAAgAAAAQAAAADAAAACAAAAAEAAAAHAAAABgAAAAkAAAAAAAAAAwAAAAIAAAACAAAABgAAAAoAAAALAAAAAAAAAAEAAAAFAAAAAwAAAA0AAAABAAAABwAAAAQAAAAMAAAAAAAAAAQAAAB/AAAADwAAAAgAAAADAAAAAAAAAAwAAAAFAAAAAgAAABIAAAAKAAAACAAAAAAAAAAQAAAABgAAAA4AAAALAAAAEQAAAAEAAAAJAAAAAgAAAAcAAAAVAAAACQAAABMAAAADAAAADQAAAAEAAAAIAAAABQAAABYAAAAQAAAABAAAAAAAAAAPAAAACQAAABMAAAAOAAAAFAAAAAEAAAAHAAAABgAAAAoAAAALAAAAGAAAABcAAAAFAAAAAgAAABIAAAALAAAAEQAAABcAAAAZAAAAAgAAAAYAAAAKAAAADAAAABwAAAANAAAAGgAAAAQAAAAPAAAAAwAAAA0AAAAaAAAAFQAAAB0AAAADAAAADAAAAAcAAAAOAAAAfwAAABEAAAAbAAAACQAAABQAAAAGAAAADwAAABYAAAAcAAAAHwAAAAQAAAAIAAAADAAAABAAAAASAAAAIQAAAB4AAAAIAAAABQAAABYAAAARAAAACwAAAA4AAAAGAAAAIwAAABkAAAAbAAAAEgAAABgAAAAeAAAAIAAAAAUAAAAKAAAAEAAAABMAAAAiAAAAFAAAACQAAAAHAAAAFQAAAAkAAAAUAAAADgAAABMAAAAJAAAAKAAAABsAAAAkAAAAFQAAACYAAAATAAAAIgAAAA0AAAAdAAAABwAAABYAAAAQAAAAKQAAACEAAAAPAAAACAAAAB8AAAAXAAAAGAAAAAsAAAAKAAAAJwAAACUAAAAZAAAAGAAAAH8AAAAgAAAAJQAAAAoAAAAXAAAAEgAAABkAAAAXAAAAEQAAAAsAAAAtAAAAJwAAACMAAAAaAAAAKgAAAB0AAAArAAAADAAAABwAAAANAAAAGwAAACgAAAAjAAAALgAAAA4AAAAUAAAAEQAAABwAAAAfAAAAKgAAACwAAAAMAAAADwAAABoAAAAdAAAAKwAAACYAAAAvAAAADQAAABoAAAAVAAAAHgAAACAAAAAwAAAAMgAAABAAAAASAAAAIQAAAB8AAAApAAAALAAAADUAAAAPAAAAFgAAABwAAAAgAAAAHgAAABgAAAASAAAANAAAADIAAAAlAAAAIQAAAB4AAAAxAAAAMAAAABYAAAAQAAAAKQAAACIAAAATAAAAJgAAABUAAAA2AAAAJAAAADMAAAAjAAAALgAAAC0AAAA4AAAAEQAAABsAAAAZAAAAJAAAABQAAAAiAAAAEwAAADcAAAAoAAAANgAAACUAAAAnAAAANAAAADkAAAAYAAAAFwAAACAAAAAmAAAAfwAAACIAAAAzAAAAHQAAAC8AAAAVAAAAJwAAACUAAAAZAAAAFwAAADsAAAA5AAAALQAAACgAAAAbAAAAJAAAABQAAAA8AAAALgAAADcAAAApAAAAMQAAADUAAAA9AAAAFgAAACEAAAAfAAAAKgAAADoAAAArAAAAPgAAABwAAAAsAAAAGgAAACsAAAA+AAAALwAAAEAAAAAaAAAAKgAAAB0AAAAsAAAANQAAADoAAABBAAAAHAAAAB8AAAAqAAAALQAAACcAAAAjAAAAGQAAAD8AAAA7AAAAOAAAAC4AAAA8AAAAOAAAAEQAAAAbAAAAKAAAACMAAAAvAAAAJgAAACsAAAAdAAAARQAAADMAAABAAAAAMAAAADEAAAAeAAAAIQAAAEMAAABCAAAAMgAAADEAAAB/AAAAPQAAAEIAAAAhAAAAMAAAACkAAAAyAAAAMAAAACAAAAAeAAAARgAAAEMAAAA0AAAAMwAAAEUAAAA2AAAARwAAACYAAAAvAAAAIgAAADQAAAA5AAAARgAAAEoAAAAgAAAAJQAAADIAAAA1AAAAPQAAAEEAAABLAAAAHwAAACkAAAAsAAAANgAAAEcAAAA3AAAASQAAACIAAAAzAAAAJAAAADcAAAAoAAAANgAAACQAAABIAAAAPAAAAEkAAAA4AAAARAAAAD8AAABNAAAAIwAAAC4AAAAtAAAAOQAAADsAAABKAAAATgAAACUAAAAnAAAANAAAADoAAAB/AAAAPgAAAEwAAAAsAAAAQQAAACoAAAA7AAAAPwAAAE4AAABPAAAAJwAAAC0AAAA5AAAAPAAAAEgAAABEAAAAUAAAACgAAAA3AAAALgAAAD0AAAA1AAAAMQAAACkAAABRAAAASwAAAEIAAAA+AAAAKwAAADoAAAAqAAAAUgAAAEAAAABMAAAAPwAAAH8AAAA4AAAALQAAAE8AAAA7AAAATQAAAEAAAAAvAAAAPgAAACsAAABUAAAARQAAAFIAAABBAAAAOgAAADUAAAAsAAAAVgAAAEwAAABLAAAAQgAAAEMAAABRAAAAVQAAADEAAAAwAAAAPQAAAEMAAABCAAAAMgAAADAAAABXAAAAVQAAAEYAAABEAAAAOAAAADwAAAAuAAAAWgAAAE0AAABQAAAARQAAADMAAABAAAAALwAAAFkAAABHAAAAVAAAAEYAAABDAAAANAAAADIAAABTAAAAVwAAAEoAAABHAAAAWQAAAEkAAABbAAAAMwAAAEUAAAA2AAAASAAAAH8AAABJAAAANwAAAFAAAAA8AAAAWAAAAEkAAABbAAAASAAAAFgAAAA2AAAARwAAADcAAABKAAAATgAAAFMAAABcAAAANAAAADkAAABGAAAASwAAAEEAAAA9AAAANQAAAF4AAABWAAAAUQAAAEwAAABWAAAAUgAAAGAAAAA6AAAAQQAAAD4AAABNAAAAPwAAAEQAAAA4AAAAXQAAAE8AAABaAAAATgAAAEoAAAA7AAAAOQAAAF8AAABcAAAATwAAAE8AAABOAAAAPwAAADsAAABdAAAAXwAAAE0AAABQAAAARAAAAEgAAAA8AAAAYwAAAFoAAABYAAAAUQAAAFUAAABeAAAAZQAAAD0AAABCAAAASwAAAFIAAABgAAAAVAAAAGIAAAA+AAAATAAAAEAAAABTAAAAfwAAAEoAAABGAAAAZAAAAFcAAABcAAAAVAAAAEUAAABSAAAAQAAAAGEAAABZAAAAYgAAAFUAAABXAAAAZQAAAGYAAABCAAAAQwAAAFEAAABWAAAATAAAAEsAAABBAAAAaAAAAGAAAABeAAAAVwAAAFMAAABmAAAAZAAAAEMAAABGAAAAVQAAAFgAAABIAAAAWwAAAEkAAABjAAAAUAAAAGkAAABZAAAAYQAAAFsAAABnAAAARQAAAFQAAABHAAAAWgAAAE0AAABQAAAARAAAAGoAAABdAAAAYwAAAFsAAABJAAAAWQAAAEcAAABpAAAAWAAAAGcAAABcAAAAUwAAAE4AAABKAAAAbAAAAGQAAABfAAAAXQAAAE8AAABaAAAATQAAAG0AAABfAAAAagAAAF4AAABWAAAAUQAAAEsAAABrAAAAaAAAAGUAAABfAAAAXAAAAE8AAABOAAAAbQAAAGwAAABdAAAAYAAAAGgAAABiAAAAbgAAAEwAAABWAAAAUgAAAGEAAAB/AAAAYgAAAFQAAABnAAAAWQAAAG8AAABiAAAAbgAAAGEAAABvAAAAUgAAAGAAAABUAAAAYwAAAFAAAABpAAAAWAAAAGoAAABaAAAAcQAAAGQAAABmAAAAUwAAAFcAAABsAAAAcgAAAFwAAABlAAAAZgAAAGsAAABwAAAAUQAAAFUAAABeAAAAZgAAAGUAAABXAAAAVQAAAHIAAABwAAAAZAAAAGcAAABbAAAAYQAAAFkAAAB0AAAAaQAAAG8AAABoAAAAawAAAG4AAABzAAAAVgAAAF4AAABgAAAAaQAAAFgAAABnAAAAWwAAAHEAAABjAAAAdAAAAGoAAABdAAAAYwAAAFoAAAB1AAAAbQAAAHEAAABrAAAAfwAAAGUAAABeAAAAcwAAAGgAAABwAAAAbAAAAGQAAABfAAAAXAAAAHYAAAByAAAAbQAAAG0AAABsAAAAXQAAAF8AAAB1AAAAdgAAAGoAAABuAAAAYgAAAGgAAABgAAAAdwAAAG8AAABzAAAAbwAAAGEAAABuAAAAYgAAAHQAAABnAAAAdwAAAHAAAABrAAAAZgAAAGUAAAB4AAAAcwAAAHIAAABxAAAAYwAAAHQAAABpAAAAdQAAAGoAAAB5AAAAcgAAAHAAAABkAAAAZgAAAHYAAAB4AAAAbAAAAHMAAABuAAAAawAAAGgAAAB4AAAAdwAAAHAAAAB0AAAAZwAAAHcAAABvAAAAcQAAAGkAAAB5AAAAdQAAAH8AAABtAAAAdgAAAHEAAAB5AAAAagAAAHYAAAB4AAAAbAAAAHIAAAB1AAAAeQAAAG0AAAB3AAAAbwAAAHMAAABuAAAAeQAAAHQAAAB4AAAAeAAAAHMAAAByAAAAcAAAAHkAAAB3AAAAdgAAAHkAAAB0AAAAeAAAAHcAAAB1AAAAcQAAAHYAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAABAAAABQAAAAEAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAACAAAABQAAAAEAAAAAAAAA/////wEAAAAAAAAAAwAAAAQAAAACAAAAAAAAAAAAAAABAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAMAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAFAAAAAQAAAAAAAAAAAAAAAQAAAAMAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAEAAAADAAAAAAAAAAAAAAABAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAADAAAABQAAAAEAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAABAAAAAAAAAP////8DAAAAAAAAAAUAAAACAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAEAAAABQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAAFAAAABQAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAD/////AwAAAAAAAAAFAAAAAgAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAAAAAABAAAAAwAAAAAAAAAAAAAAAQAAAAAAAAADAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAQAAAAMAAAAAAAAAAAAAAAEAAAAAAAAAAwAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAADAAAAAAAAAP////8DAAAAAAAAAAUAAAACAAAAAAAAAAAAAAADAAAAAAAAAAAAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAUAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAFAAAABQAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAwAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAADAAAAAwAAAAMAAAAAAAAAAwAAAAAAAAAAAAAA/////wMAAAAAAAAABQAAAAIAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAA/////wMAAAAAAAAABQAAAAIAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAMAAAADAAAAAAAAAAAAAAADAAAAAwAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAMAAAADAAAAAwAAAAMAAAAAAAAAAwAAAAAAAAD/////AwAAAAAAAAAFAAAAAgAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAAAAAADAAAAAAAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAAAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAAAAAD/////AwAAAAAAAAAFAAAAAgAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAADAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAFAAAAAAAAAAAAAAADAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAADAAAAAQAAAAAAAAABAAAAAAAAAAAAAAABAAAAAwAAAAEAAAAAAAAAAQAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAADAAAAAAAAAP////8DAAAAAAAAAAUAAAACAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAAAAAAAAAAADAAAAAwAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAUAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAFAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAA/////wMAAAAAAAAABQAAAAIAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAAFAAAAAAAAAAAAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAEAAAADAAAAAQAAAAAAAAABAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAADAAAAAQAAAAAAAAABAAAAAAAAAAMAAAADAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAEAAAAAAAAAAwAAAAUAAAABAAAAAAAAAP////8DAAAAAAAAAAUAAAACAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAABAAAAAUAAAABAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAIAAAAFAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAEAAAADAAAAAQAAAAAAAAABAAAAAAAAAAUAAAAAAAAAAAAAAAUAAAAFAAAAAAAAAAAAAAD/////AQAAAAAAAAADAAAABAAAAAIAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAUAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAFAAAAAAAAAAAAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAUAAAABAAAAAAAAAAAAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAAAAAAEAAAD//////////wEAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAADAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAsAAAACAAAAAAAAAAAAAAABAAAAAgAAAAYAAAAEAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAYAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAcAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAACAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAYAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAKAAAAAgAAAAAAAAAAAAAAAQAAAAEAAAAFAAAABgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAALAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAABAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAABwAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAsAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACgAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAACAAAAAAAAAAAAAAABAAAAAwAAAAcAAAAGAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAABwAAAAEAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAGAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAADgAAAAIAAAAAAAAAAAAAAAEAAAAAAAAACQAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACgAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAMAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAABwAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAsAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAKAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADQAAAAIAAAAAAAAAAAAAAAEAAAAEAAAACAAAAAoAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAALAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAACQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAGAAAAAgAAAAAAAAAAAAAAAQAAAAsAAAAPAAAACAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAkAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAOAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAEAAAAAAAAAAQAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAIAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAABQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAgAAAAAAAAAAAAAAAQAAAAwAAAAQAAAADAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAoAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAJAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAPAAAAAAAAAAEAAAABAAAAAAAAAAAAAAAAAAAADwAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAADQAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAACAAAAAAAAAAAAAAABAAAACgAAABMAAAAIAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAkAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAEQAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEQAAAAAAAAABAAAAAQAAAAAAAAAAAAAAAAAAAA8AAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAQAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAACQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAANAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAAAAIAAAAAAAAAAAAAAAEAAAANAAAAEQAAAA0AAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAARAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAEwAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAA4AAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAATAAAAAAAAAAEAAAABAAAAAAAAAAAAAAAAAAAAEQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAA0AAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAARAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAkAAAACAAAAAAAAAAAAAAABAAAADgAAABIAAAAPAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAADwAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABIAAAAAAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAASAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAEwAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAABEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAATAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAABIAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAATAAAAAgAAAAAAAAAAAAAAAQAAAP//////////EwAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAATAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAEgAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAASAAAAAAAAABgAAAAAAAAAIQAAAAAAAAAeAAAAAAAAACAAAAADAAAAMQAAAAEAAAAwAAAAAwAAADIAAAADAAAACAAAAAAAAAAFAAAABQAAAAoAAAAFAAAAFgAAAAAAAAAQAAAAAAAAABIAAAAAAAAAKQAAAAEAAAAhAAAAAAAAAB4AAAAAAAAABAAAAAAAAAAAAAAABQAAAAIAAAAFAAAADwAAAAEAAAAIAAAAAAAAAAUAAAAFAAAAHwAAAAEAAAAWAAAAAAAAABAAAAAAAAAAAgAAAAAAAAAGAAAAAAAAAA4AAAAAAAAACgAAAAAAAAALAAAAAAAAABEAAAADAAAAGAAAAAEAAAAXAAAAAwAAABkAAAADAAAAAAAAAAAAAAABAAAABQAAAAkAAAAFAAAABQAAAAAAAAACAAAAAAAAAAYAAAAAAAAAEgAAAAEAAAAKAAAAAAAAAAsAAAAAAAAABAAAAAEAAAADAAAABQAAAAcAAAAFAAAACAAAAAEAAAAAAAAAAAAAAAEAAAAFAAAAEAAAAAEAAAAFAAAAAAAAAAIAAAAAAAAABwAAAAAAAAAVAAAAAAAAACYAAAAAAAAACQAAAAAAAAATAAAAAAAAACIAAAADAAAADgAAAAEAAAAUAAAAAwAAACQAAAADAAAAAwAAAAAAAAANAAAABQAAAB0AAAAFAAAAAQAAAAAAAAAHAAAAAAAAABUAAAAAAAAABgAAAAEAAAAJAAAAAAAAABMAAAAAAAAABAAAAAIAAAAMAAAABQAAABoAAAAFAAAAAAAAAAEAAAADAAAAAAAAAA0AAAAFAAAAAgAAAAEAAAABAAAAAAAAAAcAAAAAAAAAGgAAAAAAAAAqAAAAAAAAADoAAAAAAAAAHQAAAAAAAAArAAAAAAAAAD4AAAADAAAAJgAAAAEAAAAvAAAAAwAAAEAAAAADAAAADAAAAAAAAAAcAAAABQAAACwAAAAFAAAADQAAAAAAAAAaAAAAAAAAACoAAAAAAAAAFQAAAAEAAAAdAAAAAAAAACsAAAAAAAAABAAAAAMAAAAPAAAABQAAAB8AAAAFAAAAAwAAAAEAAAAMAAAAAAAAABwAAAAFAAAABwAAAAEAAAANAAAAAAAAABoAAAAAAAAAHwAAAAAAAAApAAAAAAAAADEAAAAAAAAALAAAAAAAAAA1AAAAAAAAAD0AAAADAAAAOgAAAAEAAABBAAAAAwAAAEsAAAADAAAADwAAAAAAAAAWAAAABQAAACEAAAAFAAAAHAAAAAAAAAAfAAAAAAAAACkAAAAAAAAAKgAAAAEAAAAsAAAAAAAAADUAAAAAAAAABAAAAAQAAAAIAAAABQAAABAAAAAFAAAADAAAAAEAAAAPAAAAAAAAABYAAAAFAAAAGgAAAAEAAAAcAAAAAAAAAB8AAAAAAAAAMgAAAAAAAAAwAAAAAAAAADEAAAADAAAAIAAAAAAAAAAeAAAAAwAAACEAAAADAAAAGAAAAAMAAAASAAAAAwAAABAAAAADAAAARgAAAAAAAABDAAAAAAAAAEIAAAADAAAANAAAAAMAAAAyAAAAAAAAADAAAAAAAAAAJQAAAAMAAAAgAAAAAAAAAB4AAAADAAAAUwAAAAAAAABXAAAAAwAAAFUAAAADAAAASgAAAAMAAABGAAAAAAAAAEMAAAAAAAAAOQAAAAEAAAA0AAAAAwAAADIAAAAAAAAAGQAAAAAAAAAXAAAAAAAAABgAAAADAAAAEQAAAAAAAAALAAAAAwAAAAoAAAADAAAADgAAAAMAAAAGAAAAAwAAAAIAAAADAAAALQAAAAAAAAAnAAAAAAAAACUAAAADAAAAIwAAAAMAAAAZAAAAAAAAABcAAAAAAAAAGwAAAAMAAAARAAAAAAAAAAsAAAADAAAAPwAAAAAAAAA7AAAAAwAAADkAAAADAAAAOAAAAAMAAAAtAAAAAAAAACcAAAAAAAAALgAAAAMAAAAjAAAAAwAAABkAAAAAAAAAJAAAAAAAAAAUAAAAAAAAAA4AAAADAAAAIgAAAAAAAAATAAAAAwAAAAkAAAADAAAAJgAAAAMAAAAVAAAAAwAAAAcAAAADAAAANwAAAAAAAAAoAAAAAAAAABsAAAADAAAANgAAAAMAAAAkAAAAAAAAABQAAAAAAAAAMwAAAAMAAAAiAAAAAAAAABMAAAADAAAASAAAAAAAAAA8AAAAAwAAAC4AAAADAAAASQAAAAMAAAA3AAAAAAAAACgAAAAAAAAARwAAAAMAAAA2AAAAAwAAACQAAAAAAAAAQAAAAAAAAAAvAAAAAAAAACYAAAADAAAAPgAAAAAAAAArAAAAAwAAAB0AAAADAAAAOgAAAAMAAAAqAAAAAwAAABoAAAADAAAAVAAAAAAAAABFAAAAAAAAADMAAAADAAAAUgAAAAMAAABAAAAAAAAAAC8AAAAAAAAATAAAAAMAAAA+AAAAAAAAACsAAAADAAAAYQAAAAAAAABZAAAAAwAAAEcAAAADAAAAYgAAAAMAAABUAAAAAAAAAEUAAAAAAAAAYAAAAAMAAABSAAAAAwAAAEAAAAAAAAAASwAAAAAAAABBAAAAAAAAADoAAAADAAAAPQAAAAAAAAA1AAAAAwAAACwAAAADAAAAMQAAAAMAAAApAAAAAwAAAB8AAAADAAAAXgAAAAAAAABWAAAAAAAAAEwAAAADAAAAUQAAAAMAAABLAAAAAAAAAEEAAAAAAAAAQgAAAAMAAAA9AAAAAAAAADUAAAADAAAAawAAAAAAAABoAAAAAwAAAGAAAAADAAAAZQAAAAMAAABeAAAAAAAAAFYAAAAAAAAAVQAAAAMAAABRAAAAAwAAAEsAAAAAAAAAOQAAAAAAAAA7AAAAAAAAAD8AAAADAAAASgAAAAAAAABOAAAAAwAAAE8AAAADAAAAUwAAAAMAAABcAAAAAwAAAF8AAAADAAAAJQAAAAAAAAAnAAAAAwAAAC0AAAADAAAANAAAAAAAAAA5AAAAAAAAADsAAAAAAAAARgAAAAMAAABKAAAAAAAAAE4AAAADAAAAGAAAAAAAAAAXAAAAAwAAABkAAAADAAAAIAAAAAMAAAAlAAAAAAAAACcAAAADAAAAMgAAAAMAAAA0AAAAAAAAADkAAAAAAAAALgAAAAAAAAA8AAAAAAAAAEgAAAADAAAAOAAAAAAAAABEAAAAAwAAAFAAAAADAAAAPwAAAAMAAABNAAAAAwAAAFoAAAADAAAAGwAAAAAAAAAoAAAAAwAAADcAAAADAAAAIwAAAAAAAAAuAAAAAAAAADwAAAAAAAAALQAAAAMAAAA4AAAAAAAAAEQAAAADAAAADgAAAAAAAAAUAAAAAwAAACQAAAADAAAAEQAAAAMAAAAbAAAAAAAAACgAAAADAAAAGQAAAAMAAAAjAAAAAAAAAC4AAAAAAAAARwAAAAAAAABZAAAAAAAAAGEAAAADAAAASQAAAAAAAABbAAAAAwAAAGcAAAADAAAASAAAAAMAAABYAAAAAwAAAGkAAAADAAAAMwAAAAAAAABFAAAAAwAAAFQAAAADAAAANgAAAAAAAABHAAAAAAAAAFkAAAAAAAAANwAAAAMAAABJAAAAAAAAAFsAAAADAAAAJgAAAAAAAAAvAAAAAwAAAEAAAAADAAAAIgAAAAMAAAAzAAAAAAAAAEUAAAADAAAAJAAAAAMAAAA2AAAAAAAAAEcAAAAAAAAAYAAAAAAAAABoAAAAAAAAAGsAAAADAAAAYgAAAAAAAABuAAAAAwAAAHMAAAADAAAAYQAAAAMAAABvAAAAAwAAAHcAAAADAAAATAAAAAAAAABWAAAAAwAAAF4AAAADAAAAUgAAAAAAAABgAAAAAAAAAGgAAAAAAAAAVAAAAAMAAABiAAAAAAAAAG4AAAADAAAAOgAAAAAAAABBAAAAAwAAAEsAAAADAAAAPgAAAAMAAABMAAAAAAAAAFYAAAADAAAAQAAAAAMAAABSAAAAAAAAAGAAAAAAAAAAVQAAAAAAAABXAAAAAAAAAFMAAAADAAAAZQAAAAAAAABmAAAAAwAAAGQAAAADAAAAawAAAAMAAABwAAAAAwAAAHIAAAADAAAAQgAAAAAAAABDAAAAAwAAAEYAAAADAAAAUQAAAAAAAABVAAAAAAAAAFcAAAAAAAAAXgAAAAMAAABlAAAAAAAAAGYAAAADAAAAMQAAAAAAAAAwAAAAAwAAADIAAAADAAAAPQAAAAMAAABCAAAAAAAAAEMAAAADAAAASwAAAAMAAABRAAAAAAAAAFUAAAAAAAAAXwAAAAAAAABcAAAAAAAAAFMAAAAAAAAATwAAAAAAAABOAAAAAAAAAEoAAAADAAAAPwAAAAEAAAA7AAAAAwAAADkAAAADAAAAbQAAAAAAAABsAAAAAAAAAGQAAAAFAAAAXQAAAAEAAABfAAAAAAAAAFwAAAAAAAAATQAAAAEAAABPAAAAAAAAAE4AAAAAAAAAdQAAAAQAAAB2AAAABQAAAHIAAAAFAAAAagAAAAEAAABtAAAAAAAAAGwAAAAAAAAAWgAAAAEAAABdAAAAAQAAAF8AAAAAAAAAWgAAAAAAAABNAAAAAAAAAD8AAAAAAAAAUAAAAAAAAABEAAAAAAAAADgAAAADAAAASAAAAAEAAAA8AAAAAwAAAC4AAAADAAAAagAAAAAAAABdAAAAAAAAAE8AAAAFAAAAYwAAAAEAAABaAAAAAAAAAE0AAAAAAAAAWAAAAAEAAABQAAAAAAAAAEQAAAAAAAAAdQAAAAMAAABtAAAABQAAAF8AAAAFAAAAcQAAAAEAAABqAAAAAAAAAF0AAAAAAAAAaQAAAAEAAABjAAAAAQAAAFoAAAAAAAAAaQAAAAAAAABYAAAAAAAAAEgAAAAAAAAAZwAAAAAAAABbAAAAAAAAAEkAAAADAAAAYQAAAAEAAABZAAAAAwAAAEcAAAADAAAAcQAAAAAAAABjAAAAAAAAAFAAAAAFAAAAdAAAAAEAAABpAAAAAAAAAFgAAAAAAAAAbwAAAAEAAABnAAAAAAAAAFsAAAAAAAAAdQAAAAIAAABqAAAABQAAAFoAAAAFAAAAeQAAAAEAAABxAAAAAAAAAGMAAAAAAAAAdwAAAAEAAAB0AAAAAQAAAGkAAAAAAAAAdwAAAAAAAABvAAAAAAAAAGEAAAAAAAAAcwAAAAAAAABuAAAAAAAAAGIAAAADAAAAawAAAAEAAABoAAAAAwAAAGAAAAADAAAAeQAAAAAAAAB0AAAAAAAAAGcAAAAFAAAAeAAAAAEAAAB3AAAAAAAAAG8AAAAAAAAAcAAAAAEAAABzAAAAAAAAAG4AAAAAAAAAdQAAAAEAAABxAAAABQAAAGkAAAAFAAAAdgAAAAEAAAB5AAAAAAAAAHQAAAAAAAAAcgAAAAEAAAB4AAAAAQAAAHcAAAAAAAAAcgAAAAAAAABwAAAAAAAAAGsAAAAAAAAAZAAAAAAAAABmAAAAAAAAAGUAAAADAAAAUwAAAAEAAABXAAAAAwAAAFUAAAADAAAAdgAAAAAAAAB4AAAAAAAAAHMAAAAFAAAAbAAAAAEAAAByAAAAAAAAAHAAAAAAAAAAXAAAAAEAAABkAAAAAAAAAGYAAAAAAAAAdQAAAAAAAAB5AAAABQAAAHcAAAAFAAAAbQAAAAEAAAB2AAAAAAAAAHgAAAAAAAAAXwAAAAEAAABsAAAAAQAAAHIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAEAAAABAAAAAQAAAAAAAAAAAAAAAQAAAAAAAAABAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAGAAAAAgAAAAUAAAABAAAABAAAAAAAAAAAAAAABQAAAAMAAAABAAAABgAAAAQAAAACAAAAAAAAAH6iBfbytuk/Gq6akm/58z/Xrm0Liez0P5doSdOpSwRAWs602ULg8D/dT7Rcbo/1v1N1RQHFNOM/g9Snx7HW3L8HWsP8Q3jfP6VwOLosutk/9rjk1YQcxj+gnmKMsNn6P/HDeuPFY+M/YHwDjqKhB0Ci19/fCVrbP4UxKkDWOP6/pvljWa09tL9wi7wrQXjnv/Z6yLImkM2/3yTlOzY14D+m+WNZrT20PzwKVQnrQwNA9nrIsiaQzT/g40rFrRQFwPa45NWEHMa/kbslHEZq97/xw3rjxWPjv4cLC2SMBci/otff3wla27+rKF5oIAv0P1N1RQHFNOO/iDJPGyWHBUAHWsP8Q3jfvwQf/by16gXAfqIF9vK26b8XrO0Vh0r+v9eubQuJ7PS/BxLrA0ZZ479azrTZQuDwv1MK1EuItPw/yscgV9Z6FkAwHBR2WjQMQJNRzXsQ5vY/GlUHVJYKF0DONuFv2lMNQNCGZ28QJfk/0WUwoIL36D8ggDOMQuATQNqMOeAy/wZAWFYOYM+M2z/LWC4uH3oSQDE+LyTsMgRAkJzhRGWFGEDd4soovCQQQKqk0DJMEP8/rGmNdwOLBUAW2X/9xCbjP4hu3dcqJhNAzuYItRvdB0CgzW3zJW/sPxotm/Y2TxRAQAk9XmdDDEC1Kx9MKgT3P1M+NctcghZAFVqcLlb0C0Bgzd3sB2b2P77mZDPUWhZAFROHJpUGCEDAfma5CxXtPz1DWq/zYxRAmhYY5824F0DOuQKWSbAOQNCMqrvu3fs/L6DR22K2wT9nAAxPBU8RQGiN6mW43AFAZhu25b633D8c1YgmzowSQNM25BRKWARArGS08/lNxD+LFssHwmMRQLC5aNcxBgJABL9HT0WRF0CjCmJmOGEOQHsuaVzMP/s/TWJCaGGwBUCeu1PAPLzjP9nqN9DZOBNAKE4JcydbCkCGtbd1qjPzP8dgm9U8jhVAtPeKTkVwDkCeCLss5l37P401XMPLmBdAFd29VMVQDUBg0yA55h75Pz6odcYLCRdApBM4rBrkAkDyAVWgQxbRP4XDMnK20hFAymLlF7EmzD8GUgo9XBHlP3lbK7T9COc/k+OhPthhy7+YGEpnrOvCPzBFhLs15u4/epbqB6H4uz9IuuLF5svev6lzLKY31es/CaQ0envF5z8ZY0xlUADXv7zaz7HYEuI/CfbK1sn16T8uAQfWwxLWPzKn/YuFN94/5KdbC1AFu793fyCSnlfvPzK2y4doAMY/NRg5t1/X6b/shq4QJaHDP5yNIAKPOeI/vpn7BSE30r/X4YQrO6nrv78Ziv/Thto/DqJ1Y6+y5z9l51NaxFrlv8QlA65HOLS/86dxiEc96z+Hj0+LFjneP6LzBZ8LTc2/DaJ1Y6+y579l51NaxFrlP8QlA65HOLQ/8qdxiEc967+Jj0+LFjnev6LzBZ8LTc0/1qdbC1AFuz93fyCSnlfvvzK2y4doAMa/NRg5t1/X6T/vhq4QJaHDv5yNIAKPOeK/wJn7BSE30j/W4YQrO6nrP78Ziv/Thtq/CaQ0envF578XY0xlUADXP7zaz7HYEuK/CvbK1sn16b8rAQfWwxLWvzKn/YuFN96/zWLlF7EmzL8GUgo9XBHlv3lbK7T9COe/kOOhPthhyz+cGEpnrOvCvzBFhLs15u6/c5bqB6H4u79IuuLF5sveP6lzLKY31eu/AQAAAP////8HAAAA/////zEAAAD/////VwEAAP////9hCQAA/////6dBAAD/////kcsBAP/////3kAwA/////8H2VwAAAAAAAAAAAAAAAAACAAAA/////w4AAAD/////YgAAAP////+uAgAA/////8ISAAD/////ToMAAP////8ilwMA/////+4hGQD/////gu2vAAAAAAAAAAAAAAAAAAAAAAACAAAA//////////8BAAAAAwAAAP//////////////////////////////////////////////////////////////////////////AQAAAAAAAAACAAAA////////////////AwAAAP//////////////////////////////////////////////////////////////////////////AQAAAAAAAAACAAAA////////////////AwAAAP//////////////////////////////////////////////////////////////////////////AQAAAAAAAAACAAAA////////////////AwAAAP//////////////////////////////////////////////////////////AgAAAP//////////AQAAAAAAAAD/////////////////////AwAAAP////////////////////////////////////////////////////8DAAAA/////////////////////wAAAAD/////////////////////AQAAAP///////////////wIAAAD///////////////////////////////8DAAAA/////////////////////wAAAAD///////////////8CAAAAAQAAAP////////////////////////////////////////////////////8DAAAA/////////////////////wAAAAD///////////////8CAAAAAQAAAP////////////////////////////////////////////////////8DAAAA/////////////////////wAAAAD///////////////8CAAAAAQAAAP////////////////////////////////////////////////////8DAAAA/////////////////////wAAAAD///////////////8CAAAAAQAAAP////////////////////////////////////////////////////8BAAAAAgAAAP///////////////wAAAAD/////////////////////AwAAAP////////////////////////////////////////////////////8BAAAAAgAAAP///////////////wAAAAD/////////////////////AwAAAP////////////////////////////////////////////////////8BAAAAAgAAAP///////////////wAAAAD/////////////////////AwAAAP////////////////////////////////////////////////////8BAAAAAgAAAP///////////////wAAAAD/////////////////////AwAAAP///////////////////////////////wIAAAD///////////////8BAAAA/////////////////////wAAAAD/////////////////////AwAAAP////////////////////////////////////////////////////8DAAAA/////////////////////wAAAAABAAAA//////////8CAAAA//////////////////////////////////////////////////////////8DAAAA////////////////AgAAAAAAAAABAAAA//////////////////////////////////////////////////////////////////////////8DAAAA////////////////AgAAAAAAAAABAAAA//////////////////////////////////////////////////////////////////////////8DAAAA////////////////AgAAAAAAAAABAAAA//////////////////////////////////////////////////////////////////////////8DAAAAAQAAAP//////////AgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAACAAAAAAAAAAIAAAABAAAAAQAAAAIAAAACAAAAAAAAAAUAAAAFAAAAAAAAAAIAAAACAAAAAwAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAgAAAAEAAAACAAAAAgAAAAIAAAAAAAAABQAAAAYAAAAAAAAAAgAAAAIAAAADAAAAAgAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAgAAAAAAAAACAAAAAQAAAAMAAAACAAAAAgAAAAAAAAAFAAAABwAAAAAAAAACAAAAAgAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAACAAAAAAAAAAIAAAABAAAABAAAAAIAAAACAAAAAAAAAAUAAAAIAAAAAAAAAAIAAAACAAAAAwAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAIAAAAAAAAAAgAAAAEAAAAAAAAAAgAAAAIAAAAAAAAABQAAAAkAAAAAAAAAAgAAAAIAAAADAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAKAAAAAgAAAAIAAAAAAAAAAwAAAA4AAAACAAAAAAAAAAIAAAADAAAAAAAAAAAAAAACAAAAAgAAAAMAAAAGAAAAAAAAAAAAAAAAAAAAAAAAAAsAAAACAAAAAgAAAAAAAAADAAAACgAAAAIAAAAAAAAAAgAAAAMAAAABAAAAAAAAAAIAAAACAAAAAwAAAAcAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAIAAAACAAAAAAAAAAMAAAALAAAAAgAAAAAAAAACAAAAAwAAAAIAAAAAAAAAAgAAAAIAAAADAAAACAAAAAAAAAAAAAAAAAAAAAAAAAANAAAAAgAAAAIAAAAAAAAAAwAAAAwAAAACAAAAAAAAAAIAAAADAAAAAwAAAAAAAAACAAAAAgAAAAMAAAAJAAAAAAAAAAAAAAAAAAAAAAAAAA4AAAACAAAAAgAAAAAAAAADAAAADQAAAAIAAAAAAAAAAgAAAAMAAAAEAAAAAAAAAAIAAAACAAAAAwAAAAoAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAIAAAACAAAAAAAAAAMAAAAGAAAAAgAAAAAAAAACAAAAAwAAAA8AAAAAAAAAAgAAAAIAAAADAAAACwAAAAAAAAAAAAAAAAAAAAAAAAAGAAAAAgAAAAIAAAAAAAAAAwAAAAcAAAACAAAAAAAAAAIAAAADAAAAEAAAAAAAAAACAAAAAgAAAAMAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAcAAAACAAAAAgAAAAAAAAADAAAACAAAAAIAAAAAAAAAAgAAAAMAAAARAAAAAAAAAAIAAAACAAAAAwAAAA0AAAAAAAAAAAAAAAAAAAAAAAAACAAAAAIAAAACAAAAAAAAAAMAAAAJAAAAAgAAAAAAAAACAAAAAwAAABIAAAAAAAAAAgAAAAIAAAADAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAJAAAAAgAAAAIAAAAAAAAAAwAAAAUAAAACAAAAAAAAAAIAAAADAAAAEwAAAAAAAAACAAAAAgAAAAMAAAAPAAAAAAAAAAAAAAAAAAAAAAAAABAAAAACAAAAAAAAAAIAAAABAAAAEwAAAAIAAAACAAAAAAAAAAUAAAAKAAAAAAAAAAIAAAACAAAAAwAAABAAAAAAAAAAAAAAAAAAAAAAAAAAEQAAAAIAAAAAAAAAAgAAAAEAAAAPAAAAAgAAAAIAAAAAAAAABQAAAAsAAAAAAAAAAgAAAAIAAAADAAAAEQAAAAAAAAAAAAAAAAAAAAAAAAASAAAAAgAAAAAAAAACAAAAAQAAABAAAAACAAAAAgAAAAAAAAAFAAAADAAAAAAAAAACAAAAAgAAAAMAAAASAAAAAAAAAAAAAAAAAAAAAAAAABMAAAACAAAAAAAAAAIAAAABAAAAEQAAAAIAAAACAAAAAAAAAAUAAAANAAAAAAAAAAIAAAACAAAAAwAAABMAAAAAAAAAAAAAAAAAAAAAAAAADwAAAAIAAAAAAAAAAgAAAAEAAAASAAAAAgAAAAIAAAAAAAAABQAAAA4AAAAAAAAAAgAAAAIAAAADAAAAAgAAAAEAAAAAAAAAAQAAAAIAAAAAAAAAAAAAAAIAAAABAAAAAAAAAAEAAAACAAAAAQAAAAAAAAACAAAAAAAAAAUAAAAEAAAAAAAAAAEAAAAFAAAAAAAAAAAAAAAFAAAABAAAAAAAAAABAAAABQAAAAQAAAAAAAAABQAAAAAAAAACAAAAAQAAAAAAAAABAAAAAgAAAAAAAAAAAAAAAgAAAAEAAAAAAAAAAQAAAAIAAAABAAAAAAAAAAIAAAACAAAAAAAAAAEAAAAAAAAAAAAAAAUAAAAEAAAAAAAAAAEAAAAFAAAAAAAAAAAAAAAFAAAABAAAAAAAAAABAAAABQAAAAQAAAAAAAAABQAAAAUAAAAAAAAAAQAAAAAAAAAAAAAAOgehWlKfUEEz1zLi+JsiQa2og3wcMfVAWCbHorc0yEDi+Yn/Y6mbQJ11/mfsnG9At6bnG4UQQkBvMCQWKqUUQJVmwwswmOc/3hVgVBL3uj//qqOEOdGOPw/WDN4gnGE/H3ANkCUgND+AA8btKgAHPwTXBqJVSdo+XfRQAqsKrj4fc+zLYbSPQklEmCZHv2FCUP+uDso1NEKYtPhwphUHQptxnyFXYdpB7CddZAMmrkGAt1AxSTqBQUibBVdTsFNBSuX3MV+AJkFocv82SLf5QAqmgj7AY81A23VDSEnLoEDGEJVSeDFzQDYrqvBk70VA8U157pcRGUBWfEF+ZKbsP7KBdLHZTpFAqKYk69AqekDbeGY41MdjQD8AZzHK501A1vcrrjubNkD5LnquvBYhQCbiRRD71QlAqt72EbOH8z8Eu+jL1YbdP4uaox/xUcY/abedg1XfsD+BsUdzJ4KZP5wE9YFySIM/rW1kAKMpbT+rZFthVRhWPy4PKlXIs0A/qMZLlwDnMEHByqEF0I0ZQQYSFD8lUQNBPpY+dFs07UAH8BZImBPWQN9RY0I0sMBA2T7kLfc6qUByFYvfhBKTQMq+0Mis1XxA0XQbeQXMZUBJJ5aEGXpQQP7/SY0a6ThAaMD92b/UIkAs8s8yqXoMQNIegOvCk/U/aOi7NZJP4D8AAAAA/////wAAAAAAAAAAAAAAAAAAAAAAAAAA/////////////////////////////////////wAAAAD/////AAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAA/////wAAAAAAAAAAAQAAAAEAAAAAAAAAAAAAAP////8AAAAABQAAAAAAAAAAAAAAAAAAAAAAAAD/////BQAAAAUAAAAAAAAAAAAAAAAAAAAAAAAA/////wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAP////////////////////////////////////8AAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD/////////////////////////////////////AAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAABQAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA/////////////////////////////////////wAAAAABAAAAAQAAAAEAAAABAAAAAQAAAAEAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAEAAAABAAAAAQAAAAAAAAABAAAAAAAAAAUAAAABAAAAAQAAAAAAAAAAAAAAAQAAAAEAAAAAAAAAAQAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQEAAAAAAAEAAQAAAQEAAAAAAAEAAAABAAAAAQABAAAAAAAAAAAAAAAAAAAAAAcAAAAHAAAAAQAAAAIAAAAEAAAAAwAAAAAAAAAAAAAABwAAAAMAAAABAAAAAgAAAAUAAAAEAAAAAAAAAAAAAAAEAAAABAAAAAAAAAACAAAAAQAAAAMAAAAOAAAABgAAAAsAAAACAAAABwAAAAEAAAAYAAAABQAAAAoAAAABAAAABgAAAAAAAAAmAAAABwAAAAwAAAADAAAACAAAAAIAAAAxAAAACQAAAA4AAAAAAAAABQAAAAQAAAA6AAAACAAAAA0AAAAEAAAACQAAAAMAAAA/AAAACwAAAAYAAAAPAAAACgAAABAAAABIAAAADAAAAAcAAAAQAAAACwAAABEAAABTAAAACgAAAAUAAAATAAAADgAAAA8AAABhAAAADQAAAAgAAAARAAAADAAAABIAAABrAAAADgAAAAkAAAASAAAADQAAABMAAAB1AAAADwAAABMAAAARAAAAEgAAABAAAAAGAAAAAgAAAAMAAAAFAAAABAAAAAAAAAAAAAAAAAAAAAYAAAACAAAAAwAAAAEAAAAFAAAABAAAAAAAAAAAAAAABwAAAAUAAAADAAAABAAAAAEAAAAAAAAAAgAAAAAAAAACAAAAAwAAAAEAAAAFAAAABAAAAAYAAAAAAAAAAAAAAGFsZ29zLmMAaDNOZWlnaGJvclJvdGF0aW9ucwBjb29yZGlqay5jAF91cEFwN0NoZWNrZWQAX3VwQXA3ckNoZWNrZWQAZGlyZWN0ZWRFZGdlLmMAZGlyZWN0ZWRFZGdlVG9Cb3VuZGFyeQBhZGphY2VudEZhY2VEaXJbdG1wRmlqay5mYWNlXVtmaWprLmZhY2VdID09IEtJAGZhY2VpamsuYwBfZmFjZUlqa1BlbnRUb0NlbGxCb3VuZGFyeQBhZGphY2VudEZhY2VEaXJbY2VudGVySUpLLmZhY2VdW2ZhY2UyXSA9PSBLSQBfZmFjZUlqa1RvQ2VsbEJvdW5kYXJ5AGgzSW5kZXguYwBjb21wYWN0Q2VsbHMAbGF0TG5nVG9DZWxsAGNlbGxUb0NoaWxkUG9zAHZhbGlkYXRlQ2hpbGRQb3MAbGF0TG5nLmMAY2VsbEFyZWFSYWRzMgBwb2x5Z29uLT5uZXh0ID09IE5VTEwAbGlua2VkR2VvLmMAYWRkTmV3TGlua2VkUG9seWdvbgBuZXh0ICE9IE5VTEwAbG9vcCAhPSBOVUxMAGFkZE5ld0xpbmtlZExvb3AAcG9seWdvbi0+Zmlyc3QgPT0gTlVMTABhZGRMaW5rZWRMb29wAGNvb3JkICE9IE5VTEwAYWRkTGlua2VkQ29vcmQAbG9vcC0+Zmlyc3QgPT0gTlVMTABpbm5lckxvb3BzICE9IE5VTEwAbm9ybWFsaXplTXVsdGlQb2x5Z29uAGJib3hlcyAhPSBOVUxMAGNhbmRpZGF0ZXMgIT0gTlVMTABmaW5kUG9seWdvbkZvckhvbGUAY2FuZGlkYXRlQkJveGVzICE9IE5VTEwAcmV2RGlyICE9IElOVkFMSURfRElHSVQAbG9jYWxpai5jAGNlbGxUb0xvY2FsSWprAGJhc2VDZWxsICE9IG9yaWdpbkJhc2VDZWxsACEob3JpZ2luT25QZW50ICYmIGluZGV4T25QZW50KQBiYXNlQ2VsbCA9PSBvcmlnaW5CYXNlQ2VsbABiYXNlQ2VsbCAhPSBJTlZBTElEX0JBU0VfQ0VMTABsb2NhbElqa1RvQ2VsbAAhX2lzQmFzZUNlbGxQZW50YWdvbihiYXNlQ2VsbCkAYmFzZUNlbGxSb3RhdGlvbnMgPj0gMABncmlkUGF0aENlbGxzADAAdmVydGV4LmMAY2VsbFRvVmVydGV4AGdyYXBoLT5idWNrZXRzICE9IE5VTEwAdmVydGV4R3JhcGguYwBpbml0VmVydGV4R3JhcGgAbm9kZSAhPSBOVUxMAGFkZFZlcnRleE5vZGU=";var af=24144;function Pu(st){return st}function Gi(st){var Gt=/\b__Z[\w\d_]+/g;return st.replace(Gt,function(ir){var br=ir;return ir===br?ir:br+" ["+ir+"]"})}function $s(){var st=new Error;if(!st.stack){try{throw new Error(0)}catch(Gt){st=Gt}if(!st.stack)return"(no stack trace available)"}return st.stack.toString()}function Ou(){var st=$s();return Ye.extraStackTrace&&(st+=`
`+Ye.extraStackTrace()),Gi(st)}function as(st,Gt,ir,br){ar("Assertion failed: "+Fn(st)+", at: "+[Gt?Fn(Gt):"unknown filename",ir,br?Fn(br):"unknown function"])}function ks(){return Is.length}function Uo(st,Gt,ir){io.set(io.subarray(Gt,Gt+ir),st)}function Of(st){return Ye.___errno_location&&(wu[Ye.___errno_location()>>2]=st),st}function kc(st){ar("OOM")}function Na(st){try{var Gt=new ArrayBuffer(st);return Gt.byteLength!=st?void 0:(new Int8Array(Gt).set(Is),qs(Gt),jl(Gt),1)}catch(ir){}}function Mo(st){var Gt=ks(),ir=16777216,br=2147483648-ir;if(st>br)return!1;for(var g=16777216,Bn=Math.max(Gt,g);Bn<st;)Bn<=536870912?Bn=Mu(2*Bn,ir):Bn=Math.min(Mu((3*Bn+2147483648)/4,ir),br);var Jn=Na(Bn);return!!Jn}var Qs=typeof atob=="function"?atob:function(st){var Gt="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",ir="",br,g,Bn,Jn,et,Za,Eo,oo=0;st=st.replace(/[^A-Za-z0-9\+\/\=]/g,"");do Jn=Gt.indexOf(st.charAt(oo++)),et=Gt.indexOf(st.charAt(oo++)),Za=Gt.indexOf(st.charAt(oo++)),Eo=Gt.indexOf(st.charAt(oo++)),br=Jn<<2|et>>4,g=(et&15)<<4|Za>>2,Bn=(Za&3)<<6|Eo,ir=ir+String.fromCharCode(br),Za!==64&&(ir=ir+String.fromCharCode(g)),Eo!==64&&(ir=ir+String.fromCharCode(Bn));while(oo<st.length);return ir};function os(st){try{for(var Gt=Qs(st),ir=new Uint8Array(Gt.length),br=0;br<Gt.length;++br)ir[br]=Gt.charCodeAt(br);return ir}catch(g){throw new Error("Converting base64 string to bytes failed.")}}function ms(st){if(Iu(st))return os(st.slice(Sa.length))}var Nu={Math,Int8Array,Int32Array,Uint8Array,Float32Array,Float64Array},yu={a:ar,b:Mi,c:Ro,d:as,e:Of,f:ks,g:Uo,h:Mo,i:kc,j:Pu,k:Gi,l:Na,m:$s,n:Ou,o:af,p:Ml},Gr=function(st,Gt,ir){"almost asm";var br=new st.Int8Array(ir),g=new st.Int32Array(ir),Bn=new st.Uint8Array(ir),Jn=new st.Float32Array(ir),et=new st.Float64Array(ir),Za=Gt.o|0,Eo=Gt.p|0,oo=st.Math.floor,xa=st.Math.abs,vo=st.Math.sqrt,Es=st.Math.pow,Ma=st.Math.cos,Yr=st.Math.sin,_n=st.Math.tan,ri=st.Math.acos,Hn=st.Math.asin,oi=st.Math.atan,Zn=st.Math.atan2,Ki=st.Math.ceil,Ci=st.Math.imul,gn=st.Math.min,je=st.Math.max,Nl=st.Math.clz32,zi=Gt.b,ct=Gt.c,bi=Gt.d,lf=Gt.e,Nh=Gt.f,cf=Gt.g,y0=Gt.h,Dh=Gt.i,nt=24160;function Lf(h){return br=new Int8Array(h),Bn=new Uint8Array(h),g=new Int32Array(h),Jn=new Float32Array(h),et=new Float64Array(h),ir=h,!0}function E0(h){h=h|0;var f=0;return f=nt,nt=nt+h|0,nt=nt+15&-16,f|0}function Y0(){return nt|0}function $0(h){h=h|0,nt=h}function S0(h,f){h=h|0,f=f|0,nt=h}function Q0(h,f){h=h|0,f=f|0;var d=0,E=0,S=0;return(h|0)<0?(f=2,f|0):(h|0)>13780509?(f=Zf(15,f)|0,f|0):(d=((h|0)<0)<<31>>31,S=Xt(h|0,d|0,3,0)|0,E=ct()|0,d=vn(h|0,d|0,1,0)|0,d=Xt(S|0,E|0,d|0,ct()|0)|0,d=vn(d|0,ct()|0,1,0)|0,h=ct()|0,g[f>>2]=d,g[f+4>>2]=h,f=0,f|0)}function Ff(h,f,d,E){return h=h|0,f=f|0,d=d|0,E=E|0,q0(h,f,d,E,0)|0}function q0(h,f,d,E,S){h=h|0,f=f|0,d=d|0,E=E|0,S=S|0;var M=0,O=0,F=0,$=0,pe=0;if($=nt,nt=nt+16|0,O=$,!(K0(h,f,d,E,S)|0))return E=0,nt=$,E|0;do if((d|0)>=0){if((d|0)>13780509){if(M=Zf(15,O)|0,M|0)break;F=O,O=g[F>>2]|0,F=g[F+4>>2]|0}else M=((d|0)<0)<<31>>31,pe=Xt(d|0,M|0,3,0)|0,F=ct()|0,M=vn(d|0,M|0,1,0)|0,M=Xt(pe|0,F|0,M|0,ct()|0)|0,M=vn(M|0,ct()|0,1,0)|0,F=ct()|0,g[O>>2]=M,g[O+4>>2]=F,O=M;if(Bt(E|0,0,O<<3|0)|0,S|0){Bt(S|0,0,O<<2|0)|0,M=hl(h,f,d,E,S,O,F,0)|0;break}M=Mn(O,4)|0,M?(pe=hl(h,f,d,E,M,O,F,0)|0,pn(M),M=pe):M=13}else M=2;while(0);return pe=M,nt=$,pe|0}function K0(h,f,d,E,S){h=h|0,f=f|0,d=d|0,E=E|0,S=S|0;var M=0,O=0,F=0,$=0,pe=0,we=0,$e=0,At=0,Rt=0,_t=0,zt=0;if(zt=nt,nt=nt+16|0,Rt=zt,_t=zt+8|0,At=Rt,g[At>>2]=h,g[At+4>>2]=f,(d|0)<0)return _t=2,nt=zt,_t|0;if(M=E,g[M>>2]=h,g[M+4>>2]=f,M=(S|0)!=0,M&&(g[S>>2]=0),wa(h,f)|0)return _t=9,nt=zt,_t|0;g[_t>>2]=0;e:do if((d|0)>=1)if(M)for(we=1,pe=0,$e=0,At=1,M=h;;){if(!(pe|$e)){if(M=Ss(M,f,4,_t,Rt)|0,M|0)break e;if(f=Rt,M=g[f>>2]|0,f=g[f+4>>2]|0,wa(M,f)|0){M=9;break e}}if(M=Ss(M,f,g[22384+($e<<2)>>2]|0,_t,Rt)|0,M|0)break e;if(f=Rt,M=g[f>>2]|0,f=g[f+4>>2]|0,h=E+(we<<3)|0,g[h>>2]=M,g[h+4>>2]=f,g[S+(we<<2)>>2]=At,h=pe+1|0,O=(h|0)==(At|0),F=$e+1|0,$=(F|0)==6,wa(M,f)|0){M=9;break e}if(At=At+($&O&1)|0,(At|0)>(d|0)){M=0;break}else we=we+1|0,pe=O?0:h,$e=O?$?0:F:$e}else for(we=1,pe=0,$e=0,At=1,M=h;;){if(!(pe|$e)){if(M=Ss(M,f,4,_t,Rt)|0,M|0)break e;if(f=Rt,M=g[f>>2]|0,f=g[f+4>>2]|0,wa(M,f)|0){M=9;break e}}if(M=Ss(M,f,g[22384+($e<<2)>>2]|0,_t,Rt)|0,M|0)break e;if(f=Rt,M=g[f>>2]|0,f=g[f+4>>2]|0,h=E+(we<<3)|0,g[h>>2]=M,g[h+4>>2]=f,h=pe+1|0,O=(h|0)==(At|0),F=$e+1|0,$=(F|0)==6,wa(M,f)|0){M=9;break e}if(At=At+($&O&1)|0,(At|0)>(d|0)){M=0;break}else we=we+1|0,pe=O?0:h,$e=O?$?0:F:$e}else M=0;while(0);return _t=M,nt=zt,_t|0}function hl(h,f,d,E,S,M,O,F){h=h|0,f=f|0,d=d|0,E=E|0,S=S|0,M=M|0,O=O|0,F=F|0;var $=0,pe=0,we=0,$e=0,At=0,Rt=0,_t=0,zt=0,xr=0,mr=0;if(zt=nt,nt=nt+16|0,Rt=zt+8|0,_t=zt,$=di(h|0,f|0,M|0,O|0)|0,we=ct()|0,$e=E+($<<3)|0,xr=$e,mr=g[xr>>2]|0,xr=g[xr+4>>2]|0,pe=(mr|0)==(h|0)&(xr|0)==(f|0),!((mr|0)==0&(xr|0)==0|pe))do $=vn($|0,we|0,1,0)|0,$=xt($|0,ct()|0,M|0,O|0)|0,we=ct()|0,$e=E+($<<3)|0,mr=$e,xr=g[mr>>2]|0,mr=g[mr+4>>2]|0,pe=(xr|0)==(h|0)&(mr|0)==(f|0);while(!((xr|0)==0&(mr|0)==0|pe));if($=S+($<<2)|0,pe&&(g[$>>2]|0)<=(F|0)||(mr=$e,g[mr>>2]=h,g[mr+4>>2]=f,g[$>>2]=F,(F|0)>=(d|0)))return mr=0,nt=zt,mr|0;switch(pe=F+1|0,g[Rt>>2]=0,$=Ss(h,f,2,Rt,_t)|0,$|0){case 9:{At=9;break}case 0:{$=_t,$=hl(g[$>>2]|0,g[$+4>>2]|0,d,E,S,M,O,pe)|0,$||(At=9);break}default:}e:do if((At|0)==9){switch(g[Rt>>2]=0,$=Ss(h,f,3,Rt,_t)|0,$|0){case 9:break;case 0:{if($=_t,$=hl(g[$>>2]|0,g[$+4>>2]|0,d,E,S,M,O,pe)|0,$|0)break e;break}default:break e}switch(g[Rt>>2]=0,$=Ss(h,f,1,Rt,_t)|0,$|0){case 9:break;case 0:{if($=_t,$=hl(g[$>>2]|0,g[$+4>>2]|0,d,E,S,M,O,pe)|0,$|0)break e;break}default:break e}switch(g[Rt>>2]=0,$=Ss(h,f,5,Rt,_t)|0,$|0){case 9:break;case 0:{if($=_t,$=hl(g[$>>2]|0,g[$+4>>2]|0,d,E,S,M,O,pe)|0,$|0)break e;break}default:break e}switch(g[Rt>>2]=0,$=Ss(h,f,4,Rt,_t)|0,$|0){case 9:break;case 0:{if($=_t,$=hl(g[$>>2]|0,g[$+4>>2]|0,d,E,S,M,O,pe)|0,$|0)break e;break}default:break e}switch(g[Rt>>2]=0,$=Ss(h,f,6,Rt,_t)|0,$|0){case 9:break;case 0:{if($=_t,$=hl(g[$>>2]|0,g[$+4>>2]|0,d,E,S,M,O,pe)|0,$|0)break e;break}default:break e}return mr=0,nt=zt,mr|0}while(0);return mr=$,nt=zt,mr|0}function Ss(h,f,d,E,S){h=h|0,f=f|0,d=d|0,E=E|0,S=S|0;var M=0,O=0,F=0,$=0,pe=0,we=0,$e=0,At=0,Rt=0,_t=0;if(d>>>0>6)return S=1,S|0;if($e=(g[E>>2]|0)%6|0,g[E>>2]=$e,($e|0)>0){M=0;do d=Ll(d)|0,M=M+1|0;while((M|0)<(g[E>>2]|0))}if($e=Oe(h|0,f|0,45)|0,ct()|0,we=$e&127,we>>>0>121)return S=5,S|0;$=Ks(h,f)|0,M=Oe(h|0,f|0,52)|0,ct()|0,M=M&15;e:do if(!M)pe=8;else{for(;;){if(O=(15-M|0)*3|0,F=Oe(h|0,f|0,O|0)|0,ct()|0,F=F&7,(F|0)==7){f=5;break}if(_t=(Ho(M)|0)==0,M=M+-1|0,At=Ve(7,0,O|0)|0,f=f&~(ct()|0),Rt=Ve(g[(_t?432:16)+(F*28|0)+(d<<2)>>2]|0,0,O|0)|0,O=ct()|0,d=g[(_t?640:224)+(F*28|0)+(d<<2)>>2]|0,h=Rt|h&~At,f=O|f,!d){d=0;break e}if(!M){pe=8;break e}}return f|0}while(0);(pe|0)==8&&(_t=g[848+(we*28|0)+(d<<2)>>2]|0,Rt=Ve(_t|0,0,45)|0,h=Rt|h,f=ct()|0|f&-1040385,d=g[4272+(we*28|0)+(d<<2)>>2]|0,(_t&127|0)==127&&(_t=Ve(g[848+(we*28|0)+20>>2]|0,0,45)|0,f=ct()|0|f&-1040385,d=g[4272+(we*28|0)+20>>2]|0,h=Fl(_t|h,f)|0,f=ct()|0,g[E>>2]=(g[E>>2]|0)+1)),F=Oe(h|0,f|0,45)|0,ct()|0,F=F&127;e:do if(_a(F)|0){t:do if((Ks(h,f)|0)==1){if((we|0)!=(F|0))if(C0(F,g[7696+(we*28|0)>>2]|0)|0){h=qu(h,f)|0,O=1,f=ct()|0;break}else bi(23313,22416,436,22424);switch($|0){case 3:{h=Fl(h,f)|0,f=ct()|0,g[E>>2]=(g[E>>2]|0)+1,O=0;break t}case 5:{h=qu(h,f)|0,f=ct()|0,g[E>>2]=(g[E>>2]|0)+5,O=0;break t}case 0:return _t=9,_t|0;default:return _t=1,_t|0}}else O=0;while(0);if((d|0)>0){M=0;do h=Xc(h,f)|0,f=ct()|0,M=M+1|0;while((M|0)!=(d|0))}if((we|0)!=(F|0)){if(!(Ja(F)|0)){if((O|0)!=0|(Ks(h,f)|0)!=5)break;g[E>>2]=(g[E>>2]|0)+1;break}switch($e&127){case 8:case 118:break e;default:}(Ks(h,f)|0)!=3&&(g[E>>2]=(g[E>>2]|0)+1)}}else if((d|0)>0){M=0;do h=Fl(h,f)|0,f=ct()|0,M=M+1|0;while((M|0)!=(d|0))}while(0);return g[E>>2]=((g[E>>2]|0)+d|0)%6|0,_t=S,g[_t>>2]=h,g[_t+4>>2]=f,_t=0,_t|0}function J0(h,f,d,E){h=h|0,f=f|0,d=d|0,E=E|0;var S=0,M=0,O=0,F=0,$=0,pe=0;for(F=nt,nt=nt+16|0,M=F,O=F+8|0,S=(wa(h,f)|0)==0,S=S?1:2;;){if(g[O>>2]=0,pe=(Ss(h,f,S,O,M)|0)==0,$=M,pe&((g[$>>2]|0)==(d|0)?(g[$+4>>2]|0)==(E|0):0)){h=4;break}if(S=S+1|0,S>>>0>=7){S=7,h=4;break}}return(h|0)==4?(nt=F,S|0):0}function Lh(h,f,d,E){h=h|0,f=f|0,d=d|0,E=E|0;var S=0,M=0,O=0,F=0,$=0,pe=0,we=0,$e=0,At=0,Rt=0,_t=0;if(_t=nt,nt=nt+16|0,At=_t,Rt=_t+8|0,$e=At,g[$e>>2]=h,g[$e+4>>2]=f,!d)return Rt=E,g[Rt>>2]=h,g[Rt+4>>2]=f,Rt=0,nt=_t,Rt|0;g[Rt>>2]=0;e:do if(wa(h,f)|0)h=9;else{if(M=(d|0)>0,M){S=0,$e=h;do{if(h=Ss($e,f,4,Rt,At)|0,h|0)break e;if(f=At,$e=g[f>>2]|0,f=g[f+4>>2]|0,S=S+1|0,wa($e,f)|0){h=9;break e}}while((S|0)<(d|0));if(we=E,g[we>>2]=$e,g[we+4>>2]=f,we=d+-1|0,M){pe=0,h=1;do{if(S=22384+(pe<<2)|0,(pe|0)==5)for(O=g[S>>2]|0,M=0,S=h;;){if(h=At,h=Ss(g[h>>2]|0,g[h+4>>2]|0,O,Rt,At)|0,h|0)break e;if((M|0)!=(we|0))if($=At,F=g[$>>2]|0,$=g[$+4>>2]|0,h=E+(S<<3)|0,g[h>>2]=F,g[h+4>>2]=$,!(wa(F,$)|0))h=S+1|0;else{h=9;break e}else h=S;if(M=M+1|0,(M|0)>=(d|0))break;S=h}else for(O=At,$=g[S>>2]|0,F=0,S=h,M=g[O>>2]|0,O=g[O+4>>2]|0;;){if(h=Ss(M,O,$,Rt,At)|0,h|0)break e;if(O=At,M=g[O>>2]|0,O=g[O+4>>2]|0,h=E+(S<<3)|0,g[h>>2]=M,g[h+4>>2]=O,h=S+1|0,wa(M,O)|0){h=9;break e}if(F=F+1|0,(F|0)>=(d|0))break;S=h}pe=pe+1|0}while(pe>>>0<6);h=At,O=$e,S=g[h>>2]|0,M=f,h=g[h+4>>2]|0}else O=$e,S=$e,M=f,h=f}else O=E,g[O>>2]=h,g[O+4>>2]=f,O=h,S=h,M=f,h=f;h=(O|0)==(S|0)&(M|0)==(h|0)?0:9}while(0);return Rt=h,nt=_t,Rt|0}function x0(h,f,d,E){h=h|0,f=f|0,d=d|0,E=E|0;var S=0,M=0,O=0,F=0,$=0,pe=0;if(F=nt,nt=nt+48|0,S=F+16|0,M=F+8|0,O=F,d|0)return O=15,nt=F,O|0;if(pe=h,$=g[pe+4>>2]|0,d=M,g[d>>2]=g[pe>>2],g[d+4>>2]=$,Ur(M,S),f=Qa(S,f,O)|0,!f){if(d=g[M>>2]|0,M=g[h+8>>2]|0,(M|0)>0){S=g[h+12>>2]|0,f=0;do d=(g[S+(f<<3)>>2]|0)+d|0,f=f+1|0;while((f|0)<(M|0))}f=O,S=g[f>>2]|0,f=g[f+4>>2]|0,M=((d|0)<0)<<31>>31,(f|0)<(M|0)|(f|0)==(M|0)&S>>>0<d>>>0?(f=O,g[f>>2]=d,g[f+4>>2]=M,f=M):d=S,$=vn(d|0,f|0,12,0)|0,pe=ct()|0,f=O,g[f>>2]=$,g[f+4>>2]=pe,f=E,g[f>>2]=$,g[f+4>>2]=pe,f=0}return pe=f,nt=F,pe|0}function dc(h,f,d,E,S,M,O){h=h|0,f=f|0,d=d|0,E=E|0,S=S|0,M=M|0,O=O|0;var F=0,$=0,pe=0,we=0,$e=0,At=0,Rt=0,_t=0,zt=0,xr=0,mr=0,fr=0,ur=0,er=0,Sn=0,wn=0,cn=0,En=0,Va=0,Ta=0,Ca=0,Li=0,Ei=0,_i=0,ro=0,Yi=0,lo=0,Ju=0,jh=0;if(ro=nt,nt=nt+64|0,Ca=ro+48|0,Li=ro+32|0,Ei=ro+24|0,Sn=ro+8|0,wn=ro,$=g[h>>2]|0,($|0)<=0)return _i=0,nt=ro,_i|0;for(cn=h+4|0,En=Ca+8|0,Va=Li+8|0,Ta=Sn+8|0,F=0,ur=0;;){pe=g[cn>>2]|0,fr=pe+(ur<<4)|0,g[Ca>>2]=g[fr>>2],g[Ca+4>>2]=g[fr+4>>2],g[Ca+8>>2]=g[fr+8>>2],g[Ca+12>>2]=g[fr+12>>2],(ur|0)==($+-1|0)?(g[Li>>2]=g[pe>>2],g[Li+4>>2]=g[pe+4>>2],g[Li+8>>2]=g[pe+8>>2],g[Li+12>>2]=g[pe+12>>2]):(fr=pe+(ur+1<<4)|0,g[Li>>2]=g[fr>>2],g[Li+4>>2]=g[fr+4>>2],g[Li+8>>2]=g[fr+8>>2],g[Li+12>>2]=g[fr+12>>2]),$=Xu(Ca,Li,E,Ei)|0;e:do if($)pe=0,F=$;else if(pe=Ei,$=g[pe>>2]|0,pe=g[pe+4>>2]|0,(pe|0)>0|(pe|0)==0&$>>>0>0){mr=0,fr=0;t:for(;;){if(jh=+et[Ca>>3],xr=si($|0,pe|0,mr|0,fr|0)|0,Ju=+(xr>>>0)+4294967296*+(ct()|0),Yi=+($>>>0)+4294967296*+(pe|0),lo=+(mr>>>0)+4294967296*+(fr|0),et[Sn>>3]=jh*Ju/Yi+ +et[Li>>3]*lo/Yi,et[Ta>>3]=+et[En>>3]*Ju/Yi+ +et[Va>>3]*lo/Yi,$=gf(Sn,E,wn)|0,$|0){F=$;break}xr=wn,zt=g[xr>>2]|0,xr=g[xr+4>>2]|0,At=di(zt|0,xr|0,f|0,d|0)|0,we=ct()|0,$=O+(At<<3)|0,$e=$,pe=g[$e>>2]|0,$e=g[$e+4>>2]|0;r:do if((pe|0)==0&($e|0)==0)er=$,_i=16;else for(Rt=0,_t=0;;){if((Rt|0)>(d|0)|(Rt|0)==(d|0)&_t>>>0>f>>>0){F=1;break t}if((pe|0)==(zt|0)&($e|0)==(xr|0))break r;if($=vn(At|0,we|0,1,0)|0,At=xt($|0,ct()|0,f|0,d|0)|0,we=ct()|0,_t=vn(_t|0,Rt|0,1,0)|0,Rt=ct()|0,$=O+(At<<3)|0,$e=$,pe=g[$e>>2]|0,$e=g[$e+4>>2]|0,(pe|0)==0&($e|0)==0){er=$,_i=16;break}}while(0);if((_i|0)==16&&(_i=0,!((zt|0)==0&(xr|0)==0))&&(_t=er,g[_t>>2]=zt,g[_t+4>>2]=xr,_t=M+(g[S>>2]<<3)|0,g[_t>>2]=zt,g[_t+4>>2]=xr,_t=S,_t=vn(g[_t>>2]|0,g[_t+4>>2]|0,1,0)|0,zt=ct()|0,xr=S,g[xr>>2]=_t,g[xr+4>>2]=zt),mr=vn(mr|0,fr|0,1,0)|0,fr=ct()|0,pe=Ei,$=g[pe>>2]|0,pe=g[pe+4>>2]|0,!((pe|0)>(fr|0)|(pe|0)==(fr|0)&$>>>0>mr>>>0)){pe=1;break e}}pe=0}else pe=1;while(0);if(ur=ur+1|0,!pe){_i=21;break}if($=g[h>>2]|0,(ur|0)>=($|0)){F=0,_i=21;break}}return(_i|0)==21?(nt=ro,F|0):0}function Zc(h,f,d,E){h=h|0,f=f|0,d=d|0,E=E|0;var S=0,M=0,O=0,F=0,$=0,pe=0,we=0,$e=0,At=0,Rt=0,_t=0,zt=0,xr=0,mr=0,fr=0,ur=0,er=0,Sn=0,wn=0,cn=0,En=0,Va=0,Ta=0,Ca=0,Li=0,Ei=0,_i=0,ro=0,Yi=0,lo=0,Ju=0;if(Ju=nt,nt=nt+112|0,_i=Ju+80|0,$=Ju+72|0,ro=Ju,Yi=Ju+56|0,d|0)return lo=15,nt=Ju,lo|0;if(pe=h+8|0,lo=to((g[pe>>2]<<5)+32|0)|0,!lo)return lo=13,nt=Ju,lo|0;if(Jr(h,lo),Li=h,Ei=g[Li+4>>2]|0,d=$,g[d>>2]=g[Li>>2],g[d+4>>2]=Ei,Ur($,_i),d=Qa(_i,f,ro)|0,d)Li=0,Ei=0;else{if(d=g[$>>2]|0,M=g[pe>>2]|0,(M|0)>0){O=g[h+12>>2]|0,S=0;do d=(g[O+(S<<3)>>2]|0)+d|0,S=S+1|0;while((S|0)!=(M|0));S=d}else S=d;d=ro,M=g[d>>2]|0,d=g[d+4>>2]|0,O=((S|0)<0)<<31>>31,(d|0)<(O|0)|(d|0)==(O|0)&M>>>0<S>>>0?(d=ro,g[d>>2]=S,g[d+4>>2]=O,d=O):S=M,Li=vn(S|0,d|0,12,0)|0,Ei=ct()|0,d=ro,g[d>>2]=Li,g[d+4>>2]=Ei,d=0}if(d|0)return pn(lo),lo=d,nt=Ju,lo|0;if(S=Mn(Li,8)|0,!S)return pn(lo),lo=13,nt=Ju,lo|0;if(F=Mn(Li,8)|0,!F)return pn(lo),pn(S),lo=13,nt=Ju,lo|0;Ta=_i,g[Ta>>2]=0,g[Ta+4>>2]=0,Ta=h,Ca=g[Ta+4>>2]|0,d=$,g[d>>2]=g[Ta>>2],g[d+4>>2]=Ca,d=dc($,Li,Ei,f,_i,S,F)|0;e:do if(d)pn(S),pn(F),pn(lo);else{t:do if((g[pe>>2]|0)>0){for(O=h+12|0,M=0;d=dc((g[O>>2]|0)+(M<<3)|0,Li,Ei,f,_i,S,F)|0,M=M+1|0,!(d|0);)if((M|0)>=(g[pe>>2]|0))break t;pn(S),pn(F),pn(lo);break e}while(0);(Ei|0)>0|(Ei|0)==0&Li>>>0>0&&Bt(F|0,0,Li<<3|0)|0,Ca=_i,Ta=g[Ca+4>>2]|0;t:do if((Ta|0)>0|(Ta|0)==0&(g[Ca>>2]|0)>>>0>0){cn=S,En=F,Va=S,Ta=F,Ca=S,d=S,er=S,Sn=F,wn=F,S=F;r:for(;;){for(xr=0,mr=0,fr=0,ur=0,M=0,O=0;;){F=ro,$=F+56|0;do g[F>>2]=0,F=F+4|0;while((F|0)<($|0));if(f=cn+(xr<<3)|0,pe=g[f>>2]|0,f=g[f+4>>2]|0,K0(pe,f,1,ro,0)|0){F=ro,$=F+56|0;do g[F>>2]=0,F=F+4|0;while((F|0)<($|0));F=Mn(7,4)|0,F|0&&(hl(pe,f,1,ro,F,7,0,0)|0,pn(F))}for(zt=0;;){_t=ro+(zt<<3)|0,Rt=g[_t>>2]|0,_t=g[_t+4>>2]|0;n:do if((Rt|0)==0&(_t|0)==0)F=M,$=O;else{if(we=di(Rt|0,_t|0,Li|0,Ei|0)|0,pe=ct()|0,F=E+(we<<3)|0,f=F,$=g[f>>2]|0,f=g[f+4>>2]|0,!(($|0)==0&(f|0)==0)){$e=0,At=0;do{if(($e|0)>(Ei|0)|($e|0)==(Ei|0)&At>>>0>Li>>>0)break r;if(($|0)==(Rt|0)&(f|0)==(_t|0)){F=M,$=O;break n}F=vn(we|0,pe|0,1,0)|0,we=xt(F|0,ct()|0,Li|0,Ei|0)|0,pe=ct()|0,At=vn(At|0,$e|0,1,0)|0,$e=ct()|0,F=E+(we<<3)|0,f=F,$=g[f>>2]|0,f=g[f+4>>2]|0}while(!(($|0)==0&(f|0)==0))}(Rt|0)==0&(_t|0)==0?(F=M,$=O):(Sc(Rt,_t,Yi)|0,Rr(h,lo,Yi)|0&&(At=vn(M|0,O|0,1,0)|0,O=ct()|0,$e=F,g[$e>>2]=Rt,g[$e+4>>2]=_t,M=En+(M<<3)|0,g[M>>2]=Rt,g[M+4>>2]=_t,M=At),F=M,$=O)}while(0);if(zt=zt+1|0,zt>>>0>=7)break;M=F,O=$}if(xr=vn(xr|0,mr|0,1,0)|0,mr=ct()|0,fr=vn(fr|0,ur|0,1,0)|0,ur=ct()|0,O=_i,M=g[O>>2]|0,O=g[O+4>>2]|0,(ur|0)<(O|0)|(ur|0)==(O|0)&fr>>>0<M>>>0)M=F,O=$;else break}if((O|0)>0|(O|0)==0&M>>>0>0){M=0,O=0;do ur=cn+(M<<3)|0,g[ur>>2]=0,g[ur+4>>2]=0,M=vn(M|0,O|0,1,0)|0,O=ct()|0,ur=_i,fr=g[ur+4>>2]|0;while((O|0)<(fr|0)|((O|0)==(fr|0)?M>>>0<(g[ur>>2]|0)>>>0:0))}if(ur=_i,g[ur>>2]=F,g[ur+4>>2]=$,($|0)>0|($|0)==0&F>>>0>0)zt=S,xr=wn,mr=Ca,fr=Sn,ur=En,S=er,wn=d,Sn=Va,er=zt,d=xr,Ca=Ta,Ta=mr,Va=fr,En=cn,cn=ur;else break t}pn(Va),pn(Ta),pn(lo),d=1;break e}else d=F;while(0);pn(lo),pn(S),pn(d),d=0}while(0);return lo=d,nt=Ju,lo|0}function Bf(h,f,d){h=h|0,f=f|0,d=d|0;var E=0,S=0,M=0,O=0,F=0,$=0,pe=0,we=0;if(we=nt,nt=nt+176|0,$=we,(f|0)<1)return Xi(d,0,0),pe=0,nt=we,pe|0;for(F=h,F=Oe(g[F>>2]|0,g[F+4>>2]|0,52)|0,ct()|0,Xi(d,(f|0)>6?f:6,F&15),F=0;E=h+(F<<3)|0,E=Yc(g[E>>2]|0,g[E+4>>2]|0,$)|0,!(E|0);){if(E=g[$>>2]|0,(E|0)>0){O=0;do M=$+8+(O<<4)|0,O=O+1|0,E=$+8+(((O|0)%(E|0)|0)<<4)|0,S=qo(d,E,M)|0,S?uo(d,S)|0:No(d,M,E)|0,E=g[$>>2]|0;while((O|0)<(E|0))}if(F=F+1|0,(F|0)>=(f|0)){E=0,pe=13;break}}return(pe|0)==13?(nt=we,E|0):(Qo(d),pe=E,nt=we,pe|0)}function eh(h,f,d){h=h|0,f=f|0,d=d|0;var E=0,S=0,M=0,O=0;if(M=nt,nt=nt+32|0,E=M,S=M+16|0,h=Bf(h,f,S)|0,h|0)return d=h,nt=M,d|0;if(g[d>>2]=0,g[d+4>>2]=0,g[d+8>>2]=0,h=eo(S)|0,h|0)do{f=sr(d)|0;do Er(f,h)|0,O=h+16|0,g[E>>2]=g[O>>2],g[E+4>>2]=g[O+4>>2],g[E+8>>2]=g[O+8>>2],g[E+12>>2]=g[O+12>>2],uo(S,h)|0,h=Ko(S,E)|0;while(h|0);h=eo(S)|0}while(h|0);return Qo(S),h=gr(d)|0,h?(lr(d),O=h,nt=M,O|0):(O=0,nt=M,O|0)}function _a(h){return h=h|0,h>>>0>121?(h=0,h|0):(h=g[7696+(h*28|0)+16>>2]|0,h|0)}function Ja(h){return h=h|0,(h|0)==4|(h|0)==117|0}function xs(h){return h=h|0,g[11120+((g[h>>2]|0)*216|0)+((g[h+4>>2]|0)*72|0)+((g[h+8>>2]|0)*24|0)+(g[h+12>>2]<<3)>>2]|0}function qf(h){return h=h|0,g[11120+((g[h>>2]|0)*216|0)+((g[h+4>>2]|0)*72|0)+((g[h+8>>2]|0)*24|0)+(g[h+12>>2]<<3)+4>>2]|0}function xA(h,f){h=h|0,f=f|0,h=7696+(h*28|0)|0,g[f>>2]=g[h>>2],g[f+4>>2]=g[h+4>>2],g[f+8>>2]=g[h+8>>2],g[f+12>>2]=g[h+12>>2]}function T0(h,f){h=h|0,f=f|0;var d=0,E=0;if(f>>>0>20)return f=-1,f|0;do if((g[11120+(f*216|0)>>2]|0)!=(h|0))if((g[11120+(f*216|0)+8>>2]|0)!=(h|0))if((g[11120+(f*216|0)+16>>2]|0)!=(h|0))if((g[11120+(f*216|0)+24>>2]|0)!=(h|0))if((g[11120+(f*216|0)+32>>2]|0)!=(h|0))if((g[11120+(f*216|0)+40>>2]|0)!=(h|0))if((g[11120+(f*216|0)+48>>2]|0)!=(h|0))if((g[11120+(f*216|0)+56>>2]|0)!=(h|0))if((g[11120+(f*216|0)+64>>2]|0)!=(h|0))if((g[11120+(f*216|0)+72>>2]|0)!=(h|0))if((g[11120+(f*216|0)+80>>2]|0)!=(h|0))if((g[11120+(f*216|0)+88>>2]|0)!=(h|0))if((g[11120+(f*216|0)+96>>2]|0)!=(h|0))if((g[11120+(f*216|0)+104>>2]|0)!=(h|0))if((g[11120+(f*216|0)+112>>2]|0)!=(h|0))if((g[11120+(f*216|0)+120>>2]|0)!=(h|0))if((g[11120+(f*216|0)+128>>2]|0)!=(h|0))if((g[11120+(f*216|0)+136>>2]|0)==(h|0))h=2,d=1,E=2;else{if((g[11120+(f*216|0)+144>>2]|0)==(h|0)){h=0,d=2,E=0;break}if((g[11120+(f*216|0)+152>>2]|0)==(h|0)){h=0,d=2,E=1;break}if((g[11120+(f*216|0)+160>>2]|0)==(h|0)){h=0,d=2,E=2;break}if((g[11120+(f*216|0)+168>>2]|0)==(h|0)){h=1,d=2,E=0;break}if((g[11120+(f*216|0)+176>>2]|0)==(h|0)){h=1,d=2,E=1;break}if((g[11120+(f*216|0)+184>>2]|0)==(h|0)){h=1,d=2,E=2;break}if((g[11120+(f*216|0)+192>>2]|0)==(h|0)){h=2,d=2,E=0;break}if((g[11120+(f*216|0)+200>>2]|0)==(h|0)){h=2,d=2,E=1;break}if((g[11120+(f*216|0)+208>>2]|0)==(h|0)){h=2,d=2,E=2;break}else h=-1;return h|0}else h=2,d=1,E=1;else h=2,d=1,E=0;else h=1,d=1,E=2;else h=1,d=1,E=1;else h=1,d=1,E=0;else h=0,d=1,E=2;else h=0,d=1,E=1;else h=0,d=1,E=0;else h=2,d=0,E=2;else h=2,d=0,E=1;else h=2,d=0,E=0;else h=1,d=0,E=2;else h=1,d=0,E=1;else h=1,d=0,E=0;else h=0,d=0,E=2;else h=0,d=0,E=1;else h=0,d=0,E=0;while(0);return f=g[11120+(f*216|0)+(d*72|0)+(h*24|0)+(E<<3)+4>>2]|0,f|0}function C0(h,f){return h=h|0,f=f|0,(g[7696+(h*28|0)+20>>2]|0)==(f|0)?(f=1,f|0):(f=(g[7696+(h*28|0)+24>>2]|0)==(f|0),f|0)}function b0(h,f){return h=h|0,f=f|0,g[848+(h*28|0)+(f<<2)>>2]|0}function ji(h,f){return h=h|0,f=f|0,(g[848+(h*28|0)>>2]|0)==(f|0)?(f=0,f|0):(g[848+(h*28|0)+4>>2]|0)==(f|0)?(f=1,f|0):(g[848+(h*28|0)+8>>2]|0)==(f|0)?(f=2,f|0):(g[848+(h*28|0)+12>>2]|0)==(f|0)?(f=3,f|0):(g[848+(h*28|0)+16>>2]|0)==(f|0)?(f=4,f|0):(g[848+(h*28|0)+20>>2]|0)==(f|0)?(f=5,f|0):((g[848+(h*28|0)+24>>2]|0)==(f|0)?6:7)|0}function R0(){return 122}function ec(h){h=h|0;var f=0,d=0,E=0;f=0;do Ve(f|0,0,45)|0,E=ct()|0|134225919,d=h+(f<<3)|0,g[d>>2]=-1,g[d+4>>2]=E,f=f+1|0;while((f|0)!=122);return 0}function fs(h){return h=h|0,+et[h+16>>3]<+et[h+24>>3]|0}function zc(h,f){h=h|0,f=f|0;var d=0,E=0,S=0;return d=+et[f>>3],!(d>=+et[h+8>>3])||!(d<=+et[h>>3])?(f=0,f|0):(E=+et[h+16>>3],d=+et[h+24>>3],S=+et[f+8>>3],f=S>=d,h=S<=E&1,E<d?f&&(h=1):f||(h=0),f=(h|0)!=0,f|0)}function Qa(h,f,d){h=h|0,f=f|0,d=d|0;var E=0,S=0,M=0,O=0,F=0,$=0,pe=0,we=0,$e=0,At=0,Rt=0,_t=0,zt=0,xr=0;_t=nt,nt=nt+288|0,we=_t+264|0,$e=_t+96|0,pe=_t,F=pe,$=F+96|0;do g[F>>2]=0,F=F+4|0;while((F|0)<($|0));return f=Bl(f,pe)|0,f|0?(Rt=f,nt=_t,Rt|0):($=pe,pe=g[$>>2]|0,$=g[$+4>>2]|0,Sc(pe,$,we)|0,Yc(pe,$,$e)|0,O=+Al(we,$e+8|0),et[we>>3]=+et[h>>3],$=we+8|0,et[$>>3]=+et[h+16>>3],et[$e>>3]=+et[h+8>>3],pe=$e+8|0,et[pe>>3]=+et[h+24>>3],S=+Al(we,$e),xr=+et[$>>3]-+et[pe>>3],M=+xa(+xr),zt=+et[we>>3]-+et[$e>>3],E=+xa(+zt),!(xr==0|zt==0)&&(xr=+ft(+M,+E),xr=+Ki(+(S*S/+$t(+(xr/+$t(+M,+E)),3)/(O*(O*2.59807621135)*.8))),et[Za>>3]=xr,At=~~xr>>>0,Rt=+xa(xr)>=1?xr>0?~~+gn(+oo(xr/4294967296),4294967295)>>>0:~~+Ki((xr-+(~~xr>>>0))/4294967296)>>>0:0,(g[Za+4>>2]&2146435072|0)!=2146435072)?($e=(At|0)==0&(Rt|0)==0,f=d,g[f>>2]=$e?1:At,g[f+4>>2]=$e?0:Rt,f=0):f=1,Rt=f,nt=_t,Rt|0)}function Xu(h,f,d,E){h=h|0,f=f|0,d=d|0,E=E|0;var S=0,M=0,O=0,F=0,$=0,pe=0,we=0;pe=nt,nt=nt+288|0,O=pe+264|0,F=pe+96|0,$=pe,S=$,M=S+96|0;do g[S>>2]=0,S=S+4|0;while((S|0)<(M|0));return d=Bl(d,$)|0,d|0?(E=d,nt=pe,E|0):(d=$,S=g[d>>2]|0,d=g[d+4>>2]|0,Sc(S,d,O)|0,Yc(S,d,F)|0,we=+Al(O,F+8|0),we=+Ki(+(+Al(h,f)/(we*2))),et[Za>>3]=we,d=~~we>>>0,S=+xa(we)>=1?we>0?~~+gn(+oo(we/4294967296),4294967295)>>>0:~~+Ki((we-+(~~we>>>0))/4294967296)>>>0:0,(g[Za+4>>2]&2146435072|0)==2146435072?(E=1,nt=pe,E|0):($=(d|0)==0&(S|0)==0,g[E>>2]=$?1:d,g[E+4>>2]=$?0:S,E=0,nt=pe,E|0))}function Kf(h,f,d,E){h=h|0,f=f|0,d=d|0,E=E|0,g[h>>2]=f,g[h+4>>2]=d,g[h+8>>2]=E}function ff(h,f){h=h|0,f=f|0;var d=0,E=0,S=0,M=0,O=0,F=0,$=0,pe=0,we=0,$e=0,At=0;$e=f+8|0,g[$e>>2]=0,$=+et[h>>3],O=+xa(+$),pe=+et[h+8>>3],F=+xa(+pe)/.8660254037844386,O=O+F*.5,d=~~O,h=~~F,O=O-+(d|0),F=F-+(h|0);do if(O<.5)if(O<.3333333333333333)if(g[f>>2]=d,F<(O+1)*.5){g[f+4>>2]=h;break}else{h=h+1|0,g[f+4>>2]=h;break}else if(At=1-O,h=(!(F<At)&1)+h|0,g[f+4>>2]=h,At<=F&F<O*2){d=d+1|0,g[f>>2]=d;break}else{g[f>>2]=d;break}else{if(!(O<.6666666666666666))if(d=d+1|0,g[f>>2]=d,F<O*.5){g[f+4>>2]=h;break}else{h=h+1|0,g[f+4>>2]=h;break}if(F<1-O){if(g[f+4>>2]=h,O*2+-1<F){g[f>>2]=d;break}}else h=h+1|0,g[f+4>>2]=h;d=d+1|0,g[f>>2]=d}while(0);do if($<0)if(h&1){we=(h+1|0)/2|0,we=si(d|0,((d|0)<0)<<31>>31|0,we|0,((we|0)<0)<<31>>31|0)|0,d=~~(+(d|0)-((+(we>>>0)+4294967296*+(ct()|0))*2+1)),g[f>>2]=d;break}else{we=(h|0)/2|0,we=si(d|0,((d|0)<0)<<31>>31|0,we|0,((we|0)<0)<<31>>31|0)|0,d=~~(+(d|0)-(+(we>>>0)+4294967296*+(ct()|0))*2),g[f>>2]=d;break}while(0);we=f+4|0,pe<0&&(d=d-((h<<1|1|0)/2|0)|0,g[f>>2]=d,h=0-h|0,g[we>>2]=h),E=h-d|0,(d|0)<0?(S=0-d|0,g[we>>2]=E,g[$e>>2]=S,g[f>>2]=0,h=E,d=0):S=0,(h|0)<0&&(d=d-h|0,g[f>>2]=d,S=S-h|0,g[$e>>2]=S,g[we>>2]=0,h=0),M=d-S|0,E=h-S|0,(S|0)<0&&(g[f>>2]=M,g[we>>2]=E,g[$e>>2]=0,h=E,d=M,S=0),E=(h|0)<(d|0)?h:d,E=(S|0)<(E|0)?S:E,!((E|0)<=0)&&(g[f>>2]=d-E,g[we>>2]=h-E,g[$e>>2]=S-E)}function $o(h){h=h|0;var f=0,d=0,E=0,S=0,M=0,O=0;f=g[h>>2]|0,O=h+4|0,d=g[O>>2]|0,(f|0)<0&&(d=d-f|0,g[O>>2]=d,M=h+8|0,g[M>>2]=(g[M>>2]|0)-f,g[h>>2]=0,f=0),(d|0)<0?(f=f-d|0,g[h>>2]=f,M=h+8|0,S=(g[M>>2]|0)-d|0,g[M>>2]=S,g[O>>2]=0,d=0):(S=h+8|0,M=S,S=g[S>>2]|0),(S|0)<0&&(f=f-S|0,g[h>>2]=f,d=d-S|0,g[O>>2]=d,g[M>>2]=0,S=0),E=(d|0)<(f|0)?d:f,E=(S|0)<(E|0)?S:E,!((E|0)<=0)&&(g[h>>2]=f-E,g[O>>2]=d-E,g[M>>2]=S-E)}function Yu(h,f){h=h|0,f=f|0;var d=0,E=0;E=g[h+8>>2]|0,d=+((g[h+4>>2]|0)-E|0),et[f>>3]=+((g[h>>2]|0)-E|0)-d*.5,et[f+8>>3]=d*.8660254037844386}function Gs(h,f,d){h=h|0,f=f|0,d=d|0,g[d>>2]=(g[f>>2]|0)+(g[h>>2]|0),g[d+4>>2]=(g[f+4>>2]|0)+(g[h+4>>2]|0),g[d+8>>2]=(g[f+8>>2]|0)+(g[h+8>>2]|0)}function Jf(h,f,d){h=h|0,f=f|0,d=d|0,g[d>>2]=(g[h>>2]|0)-(g[f>>2]|0),g[d+4>>2]=(g[h+4>>2]|0)-(g[f+4>>2]|0),g[d+8>>2]=(g[h+8>>2]|0)-(g[f+8>>2]|0)}function e0(h,f){h=h|0,f=f|0;var d=0,E=0;d=Ci(g[h>>2]|0,f)|0,g[h>>2]=d,d=h+4|0,E=Ci(g[d>>2]|0,f)|0,g[d>>2]=E,h=h+8|0,f=Ci(g[h>>2]|0,f)|0,g[h>>2]=f}function t0(h){h=h|0;var f=0,d=0,E=0,S=0,M=0,O=0,F=0;O=g[h>>2]|0,F=(O|0)<0,E=(g[h+4>>2]|0)-(F?O:0)|0,M=(E|0)<0,S=(M?0-E|0:0)+((g[h+8>>2]|0)-(F?O:0))|0,d=(S|0)<0,h=d?0:S,f=(M?0:E)-(d?S:0)|0,S=(F?0:O)-(M?E:0)-(d?S:0)|0,d=(f|0)<(S|0)?f:S,d=(h|0)<(d|0)?h:d,E=(d|0)>0,h=h-(E?d:0)|0,f=f-(E?d:0)|0;e:do switch(S-(E?d:0)|0){case 0:switch(f|0){case 0:return F=h|0?(h|0)==1?1:7:0,F|0;case 1:return F=h|0?(h|0)==1?3:7:2,F|0;default:break e}case 1:switch(f|0){case 0:return F=h|0?(h|0)==1?5:7:4,F|0;case 1:{if(!h)h=6;else break e;return h|0}default:break e}default:}while(0);return F=7,F|0}function Fh(h){h=h|0;var f=0,d=0,E=0,S=0,M=0,O=0,F=0;O=h+8|0,S=g[O>>2]|0,M=(g[h>>2]|0)-S|0,F=h+4|0,S=(g[F>>2]|0)-S|0;do if(M>>>0>715827881|S>>>0>715827881){if(d=(M|0)>0,d){if((2147483647-M|0)<(M|0)||(2147483647-(M<<1)|0)<(M|0))return F=1,F|0}else if((-2147483648-M|0)>(M|0)||(-2147483648-(M<<1)|0)>(M|0))return F=1,F|0;if(f=M*3|0,(S|0)>0){if((2147483647-S|0)<(S|0))return F=1,F|0}else if((-2147483648-S|0)>(S|0))return F=1,F|0;if(E=S<<1,(M|0)>-1){if((f|-2147483648|0)>=(S|0))return F=1,F|0}else if((f^-2147483648|0)<(S|0))return F=1,F|0;if(d){if((2147483647-M|0)<(E|0))f=1;else{d=E;break}return f|0}else{if((-2147483648-M|0)>(E|0))f=1;else{d=E;break}return f|0}}else d=S<<1,f=M*3|0;while(0);E=ti(+(f-S|0)/7)|0,g[h>>2]=E,S=ti(+(d+M|0)/7)|0,g[F>>2]=S,g[O>>2]=0,d=(S|0)<(E|0),f=d?E:S,d=d?S:E;do if((d|0)<0){if((f|0)>0){if((f|-2147483648|0)<(d|0)&((d|0)!=-2147483648&(2147483647-f|0)>=(d|0)))break;bi(23313,22444,355,22455)}if((d|0)==-2147483648|(-2147483648-f|0)>(d|0)&&bi(23313,22444,355,22455),(f|0)>-1){if((f|-2147483648|0)<(d|0))break;bi(23313,22444,355,22455)}else{if((f^-2147483648|0)>=(d|0))break;bi(23313,22444,355,22455)}}while(0);return f=S-E|0,(E|0)<0?(d=0-E|0,g[F>>2]=f,g[O>>2]=d,g[h>>2]=0,E=0):(f=S,d=0),(f|0)<0&&(E=E-f|0,g[h>>2]=E,d=d-f|0,g[O>>2]=d,g[F>>2]=0,f=0),M=E-d|0,S=f-d|0,(d|0)<0?(g[h>>2]=M,g[F>>2]=S,g[O>>2]=0,f=S,S=M,d=0):S=E,E=(f|0)<(S|0)?f:S,E=(d|0)<(E|0)?d:E,(E|0)<=0?(F=0,F|0):(g[h>>2]=S-E,g[F>>2]=f-E,g[O>>2]=d-E,F=0,F|0)}function kf(h){h=h|0;var f=0,d=0,E=0,S=0,M=0,O=0,F=0;O=h+8|0,S=g[O>>2]|0,M=(g[h>>2]|0)-S|0,F=h+4|0,S=(g[F>>2]|0)-S|0;do if(M>>>0>715827881|S>>>0>715827881){if(d=(M|0)>0,d){if((2147483647-M|0)<(M|0))return F=1,F|0}else if((-2147483648-M|0)>(M|0))return F=1,F|0;if(f=M<<1,(S|0)>0){if((2147483647-S|0)<(S|0)||(2147483647-(S<<1)|0)<(S|0))return F=1,F|0}else if((-2147483648-S|0)>(S|0)||(-2147483648-(S<<1)|0)>(S|0))return F=1,F|0;if(E=S*3|0,d){if((2147483647-f|0)<(S|0))return F=1,F|0}else if((-2147483648-f|0)>(S|0))return F=1,F|0;if((S|0)>-1){if((E|-2147483648|0)<(M|0)){d=E;break}else f=1;return f|0}else{if((E^-2147483648|0)<(M|0))f=1;else{d=E;break}return f|0}}else d=S*3|0,f=M<<1;while(0);E=ti(+(f+S|0)/7)|0,g[h>>2]=E,S=ti(+(d-M|0)/7)|0,g[F>>2]=S,g[O>>2]=0,d=(S|0)<(E|0),f=d?E:S,d=d?S:E;do if((d|0)<0){if((f|0)>0){if((f|-2147483648|0)<(d|0)&((d|0)!=-2147483648&(2147483647-f|0)>=(d|0)))break;bi(23313,22444,404,22469)}if((d|0)==-2147483648|(-2147483648-f|0)>(d|0)&&bi(23313,22444,404,22469),(f|0)>-1){if((f|-2147483648|0)<(d|0))break;bi(23313,22444,404,22469)}else{if((f^-2147483648|0)>=(d|0))break;bi(23313,22444,404,22469)}}while(0);return f=S-E|0,(E|0)<0?(d=0-E|0,g[F>>2]=f,g[O>>2]=d,g[h>>2]=0,E=0):(f=S,d=0),(f|0)<0&&(E=E-f|0,g[h>>2]=E,d=d-f|0,g[O>>2]=d,g[F>>2]=0,f=0),M=E-d|0,S=f-d|0,(d|0)<0?(g[h>>2]=M,g[F>>2]=S,g[O>>2]=0,f=S,S=M,d=0):S=E,E=(f|0)<(S|0)?f:S,E=(d|0)<(E|0)?d:E,(E|0)<=0?(F=0,F|0):(g[h>>2]=S-E,g[F>>2]=f-E,g[O>>2]=d-E,F=0,F|0)}function hf(h){h=h|0;var f=0,d=0,E=0,S=0,M=0,O=0,F=0;O=h+8|0,d=g[O>>2]|0,f=(g[h>>2]|0)-d|0,F=h+4|0,d=(g[F>>2]|0)-d|0,E=ti(+((f*3|0)-d|0)/7)|0,g[h>>2]=E,f=ti(+((d<<1)+f|0)/7)|0,g[F>>2]=f,g[O>>2]=0,d=f-E|0,(E|0)<0?(M=0-E|0,g[F>>2]=d,g[O>>2]=M,g[h>>2]=0,f=d,E=0,d=M):d=0,(f|0)<0&&(E=E-f|0,g[h>>2]=E,d=d-f|0,g[O>>2]=d,g[F>>2]=0,f=0),M=E-d|0,S=f-d|0,(d|0)<0?(g[h>>2]=M,g[F>>2]=S,g[O>>2]=0,f=S,S=M,d=0):S=E,E=(f|0)<(S|0)?f:S,E=(d|0)<(E|0)?d:E,!((E|0)<=0)&&(g[h>>2]=S-E,g[F>>2]=f-E,g[O>>2]=d-E)}function Bh(h){h=h|0;var f=0,d=0,E=0,S=0,M=0,O=0,F=0;O=h+8|0,d=g[O>>2]|0,f=(g[h>>2]|0)-d|0,F=h+4|0,d=(g[F>>2]|0)-d|0,E=ti(+((f<<1)+d|0)/7)|0,g[h>>2]=E,f=ti(+((d*3|0)-f|0)/7)|0,g[F>>2]=f,g[O>>2]=0,d=f-E|0,(E|0)<0?(M=0-E|0,g[F>>2]=d,g[O>>2]=M,g[h>>2]=0,f=d,E=0,d=M):d=0,(f|0)<0&&(E=E-f|0,g[h>>2]=E,d=d-f|0,g[O>>2]=d,g[F>>2]=0,f=0),M=E-d|0,S=f-d|0,(d|0)<0?(g[h>>2]=M,g[F>>2]=S,g[O>>2]=0,f=S,S=M,d=0):S=E,E=(f|0)<(S|0)?f:S,E=(d|0)<(E|0)?d:E,!((E|0)<=0)&&(g[h>>2]=S-E,g[F>>2]=f-E,g[O>>2]=d-E)}function r0(h){h=h|0;var f=0,d=0,E=0,S=0,M=0,O=0,F=0;f=g[h>>2]|0,O=h+4|0,d=g[O>>2]|0,F=h+8|0,E=g[F>>2]|0,S=d+(f*3|0)|0,g[h>>2]=S,d=E+(d*3|0)|0,g[O>>2]=d,f=(E*3|0)+f|0,g[F>>2]=f,E=d-S|0,(S|0)<0?(f=f-S|0,g[O>>2]=E,g[F>>2]=f,g[h>>2]=0,d=E,E=0):E=S,(d|0)<0&&(E=E-d|0,g[h>>2]=E,f=f-d|0,g[F>>2]=f,g[O>>2]=0,d=0),M=E-f|0,S=d-f|0,(f|0)<0?(g[h>>2]=M,g[O>>2]=S,g[F>>2]=0,E=M,f=0):S=d,d=(S|0)<(E|0)?S:E,d=(f|0)<(d|0)?f:d,!((d|0)<=0)&&(g[h>>2]=E-d,g[O>>2]=S-d,g[F>>2]=f-d)}function vc(h){h=h|0;var f=0,d=0,E=0,S=0,M=0,O=0,F=0;S=g[h>>2]|0,O=h+4|0,f=g[O>>2]|0,F=h+8|0,d=g[F>>2]|0,E=(f*3|0)+S|0,S=d+(S*3|0)|0,g[h>>2]=S,g[O>>2]=E,f=(d*3|0)+f|0,g[F>>2]=f,d=E-S|0,(S|0)<0?(f=f-S|0,g[O>>2]=d,g[F>>2]=f,g[h>>2]=0,S=0):d=E,(d|0)<0&&(S=S-d|0,g[h>>2]=S,f=f-d|0,g[F>>2]=f,g[O>>2]=0,d=0),M=S-f|0,E=d-f|0,(f|0)<0?(g[h>>2]=M,g[O>>2]=E,g[F>>2]=0,S=M,f=0):E=d,d=(E|0)<(S|0)?E:S,d=(f|0)<(d|0)?f:d,!((d|0)<=0)&&(g[h>>2]=S-d,g[O>>2]=E-d,g[F>>2]=f-d)}function th(h,f){h=h|0,f=f|0;var d=0,E=0,S=0,M=0,O=0,F=0;(f+-1|0)>>>0>=6||(S=(g[15440+(f*12|0)>>2]|0)+(g[h>>2]|0)|0,g[h>>2]=S,F=h+4|0,E=(g[15440+(f*12|0)+4>>2]|0)+(g[F>>2]|0)|0,g[F>>2]=E,O=h+8|0,f=(g[15440+(f*12|0)+8>>2]|0)+(g[O>>2]|0)|0,g[O>>2]=f,d=E-S|0,(S|0)<0?(f=f-S|0,g[F>>2]=d,g[O>>2]=f,g[h>>2]=0,E=0):(d=E,E=S),(d|0)<0&&(E=E-d|0,g[h>>2]=E,f=f-d|0,g[O>>2]=f,g[F>>2]=0,d=0),M=E-f|0,S=d-f|0,(f|0)<0?(g[h>>2]=M,g[F>>2]=S,g[O>>2]=0,E=M,f=0):S=d,d=(S|0)<(E|0)?S:E,d=(f|0)<(d|0)?f:d,!((d|0)<=0)&&(g[h>>2]=E-d,g[F>>2]=S-d,g[O>>2]=f-d))}function $u(h){h=h|0;var f=0,d=0,E=0,S=0,M=0,O=0,F=0;S=g[h>>2]|0,O=h+4|0,f=g[O>>2]|0,F=h+8|0,d=g[F>>2]|0,E=f+S|0,S=d+S|0,g[h>>2]=S,g[O>>2]=E,f=d+f|0,g[F>>2]=f,d=E-S|0,(S|0)<0?(f=f-S|0,g[O>>2]=d,g[F>>2]=f,g[h>>2]=0,E=0):(d=E,E=S),(d|0)<0&&(E=E-d|0,g[h>>2]=E,f=f-d|0,g[F>>2]=f,g[O>>2]=0,d=0),M=E-f|0,S=d-f|0,(f|0)<0?(g[h>>2]=M,g[O>>2]=S,g[F>>2]=0,E=M,f=0):S=d,d=(S|0)<(E|0)?S:E,d=(f|0)<(d|0)?f:d,!((d|0)<=0)&&(g[h>>2]=E-d,g[O>>2]=S-d,g[F>>2]=f-d)}function Dl(h){h=h|0;var f=0,d=0,E=0,S=0,M=0,O=0,F=0;f=g[h>>2]|0,O=h+4|0,E=g[O>>2]|0,F=h+8|0,d=g[F>>2]|0,S=E+f|0,g[h>>2]=S,E=d+E|0,g[O>>2]=E,f=d+f|0,g[F>>2]=f,d=E-S|0,(S|0)<0?(f=f-S|0,g[O>>2]=d,g[F>>2]=f,g[h>>2]=0,E=0):(d=E,E=S),(d|0)<0&&(E=E-d|0,g[h>>2]=E,f=f-d|0,g[F>>2]=f,g[O>>2]=0,d=0),M=E-f|0,S=d-f|0,(f|0)<0?(g[h>>2]=M,g[O>>2]=S,g[F>>2]=0,E=M,f=0):S=d,d=(S|0)<(E|0)?S:E,d=(f|0)<(d|0)?f:d,!((d|0)<=0)&&(g[h>>2]=E-d,g[O>>2]=S-d,g[F>>2]=f-d)}function Ll(h){switch(h=h|0,h|0){case 1:{h=5;break}case 5:{h=4;break}case 4:{h=6;break}case 6:{h=2;break}case 2:{h=3;break}case 3:{h=1;break}default:}return h|0}function gc(h){switch(h=h|0,h|0){case 1:{h=3;break}case 3:{h=2;break}case 2:{h=6;break}case 6:{h=4;break}case 4:{h=5;break}case 5:{h=1;break}default:}return h|0}function kh(h){h=h|0;var f=0,d=0,E=0,S=0,M=0,O=0,F=0;f=g[h>>2]|0,O=h+4|0,d=g[O>>2]|0,F=h+8|0,E=g[F>>2]|0,S=d+(f<<1)|0,g[h>>2]=S,d=E+(d<<1)|0,g[O>>2]=d,f=(E<<1)+f|0,g[F>>2]=f,E=d-S|0,(S|0)<0?(f=f-S|0,g[O>>2]=E,g[F>>2]=f,g[h>>2]=0,d=E,E=0):E=S,(d|0)<0&&(E=E-d|0,g[h>>2]=E,f=f-d|0,g[F>>2]=f,g[O>>2]=0,d=0),M=E-f|0,S=d-f|0,(f|0)<0?(g[h>>2]=M,g[O>>2]=S,g[F>>2]=0,E=M,f=0):S=d,d=(S|0)<(E|0)?S:E,d=(f|0)<(d|0)?f:d,!((d|0)<=0)&&(g[h>>2]=E-d,g[O>>2]=S-d,g[F>>2]=f-d)}function Uh(h){h=h|0;var f=0,d=0,E=0,S=0,M=0,O=0,F=0;S=g[h>>2]|0,O=h+4|0,f=g[O>>2]|0,F=h+8|0,d=g[F>>2]|0,E=(f<<1)+S|0,S=d+(S<<1)|0,g[h>>2]=S,g[O>>2]=E,f=(d<<1)+f|0,g[F>>2]=f,d=E-S|0,(S|0)<0?(f=f-S|0,g[O>>2]=d,g[F>>2]=f,g[h>>2]=0,S=0):d=E,(d|0)<0&&(S=S-d|0,g[h>>2]=S,f=f-d|0,g[F>>2]=f,g[O>>2]=0,d=0),M=S-f|0,E=d-f|0,(f|0)<0?(g[h>>2]=M,g[O>>2]=E,g[F>>2]=0,S=M,f=0):E=d,d=(E|0)<(S|0)?E:S,d=(f|0)<(d|0)?f:d,!((d|0)<=0)&&(g[h>>2]=S-d,g[O>>2]=E-d,g[F>>2]=f-d)}function M0(h,f){h=h|0,f=f|0;var d=0,E=0,S=0,M=0,O=0,F=0;return O=(g[h>>2]|0)-(g[f>>2]|0)|0,F=(O|0)<0,E=(g[h+4>>2]|0)-(g[f+4>>2]|0)-(F?O:0)|0,M=(E|0)<0,S=(F?0-O|0:0)+(g[h+8>>2]|0)-(g[f+8>>2]|0)+(M?0-E|0:0)|0,h=(S|0)<0,f=h?0:S,d=(M?0:E)-(h?S:0)|0,S=(F?0:O)-(M?E:0)-(h?S:0)|0,h=(d|0)<(S|0)?d:S,h=(f|0)<(h|0)?f:h,E=(h|0)>0,f=f-(E?h:0)|0,d=d-(E?h:0)|0,h=S-(E?h:0)|0,h=(h|0)>-1?h:0-h|0,d=(d|0)>-1?d:0-d|0,f=(f|0)>-1?f:0-f|0,f=(d|0)>(f|0)?d:f,((h|0)>(f|0)?h:f)|0}function TA(h,f){h=h|0,f=f|0;var d=0;d=g[h+8>>2]|0,g[f>>2]=(g[h>>2]|0)-d,g[f+4>>2]=(g[h+4>>2]|0)-d}function CA(h,f){h=h|0,f=f|0;var d=0,E=0,S=0,M=0,O=0,F=0;E=g[h>>2]|0,g[f>>2]=E,S=g[h+4>>2]|0,O=f+4|0,g[O>>2]=S,F=f+8|0,g[F>>2]=0,d=(S|0)<(E|0),h=d?E:S,d=d?S:E;do if((d|0)<0){if((h|0)>0){if((h|-2147483648|0)<(d|0)&((d|0)!=-2147483648&(2147483647-h|0)>=(d|0)))break;return h=1,h|0}if((d|0)==-2147483648|(-2147483648-h|0)>(d|0))return f=1,f|0;if((h|0)>-1){if((h|-2147483648|0)<(d|0))break;return h=1,h|0}else{if((h^-2147483648|0)<(d|0))h=1;else break;return h|0}}while(0);return h=S-E|0,(E|0)<0?(d=0-E|0,g[O>>2]=h,g[F>>2]=d,g[f>>2]=0,E=0):(h=S,d=0),(h|0)<0&&(E=E-h|0,g[f>>2]=E,d=d-h|0,g[F>>2]=d,g[O>>2]=0,h=0),M=E-d|0,S=h-d|0,(d|0)<0?(g[f>>2]=M,g[O>>2]=S,g[F>>2]=0,h=S,S=M,d=0):S=E,E=(h|0)<(S|0)?h:S,E=(d|0)<(E|0)?d:E,(E|0)<=0?(f=0,f|0):(g[f>>2]=S-E,g[O>>2]=h-E,g[F>>2]=d-E,f=0,f|0)}function Zh(h){h=h|0;var f=0,d=0,E=0,S=0;f=h+8|0,S=g[f>>2]|0,d=S-(g[h>>2]|0)|0,g[h>>2]=d,E=h+4|0,h=(g[E>>2]|0)-S|0,g[E>>2]=h,g[f>>2]=0-(h+d)}function zh(h){h=h|0;var f=0,d=0,E=0,S=0,M=0,O=0,F=0;d=g[h>>2]|0,f=0-d|0,g[h>>2]=f,O=h+8|0,g[O>>2]=0,F=h+4|0,E=g[F>>2]|0,S=E+d|0,(d|0)>0?(g[F>>2]=S,g[O>>2]=d,g[h>>2]=0,f=0,E=S):d=0,(E|0)<0?(M=f-E|0,g[h>>2]=M,d=d-E|0,g[O>>2]=d,g[F>>2]=0,S=M-d|0,f=0-d|0,(d|0)<0?(g[h>>2]=S,g[F>>2]=f,g[O>>2]=0,E=f,d=0):(E=0,S=M)):S=f,f=(E|0)<(S|0)?E:S,f=(d|0)<(f|0)?d:f,!((f|0)<=0)&&(g[h>>2]=S-f,g[F>>2]=E-f,g[O>>2]=d-f)}function rh(h,f,d,E,S){h=h|0,f=f|0,d=d|0,E=E|0,S=S|0;var M=0,O=0,F=0,$=0,pe=0,we=0,$e=0;if($e=nt,nt=nt+64|0,we=$e,F=$e+56|0,!(!0&(f&2013265920|0)==134217728&(!0&(E&2013265920|0)==134217728)))return S=5,nt=$e,S|0;if((h|0)==(d|0)&(f|0)==(E|0))return g[S>>2]=0,S=0,nt=$e,S|0;if(O=Oe(h|0,f|0,52)|0,ct()|0,O=O&15,pe=Oe(d|0,E|0,52)|0,ct()|0,(O|0)!=(pe&15|0))return S=12,nt=$e,S|0;if(M=O+-1|0,O>>>0>1){_c(h,f,M,we)|0,_c(d,E,M,F)|0,pe=we,$=g[pe>>2]|0,pe=g[pe+4>>2]|0;e:do if(($|0)==(g[F>>2]|0)&&(pe|0)==(g[F+4>>2]|0)){O=(O^15)*3|0,M=Oe(h|0,f|0,O|0)|0,ct()|0,M=M&7,O=Oe(d|0,E|0,O|0)|0,ct()|0,O=O&7;do if((M|0)==0|(O|0)==0)g[S>>2]=1,M=0;else if((M|0)==7)M=5;else{if((M|0)==1|(O|0)==1&&wa($,pe)|0){M=5;break}if((g[15536+(M<<2)>>2]|0)!=(O|0)&&(g[15568+(M<<2)>>2]|0)!=(O|0))break e;g[S>>2]=1,M=0}while(0);return S=M,nt=$e,S|0}while(0)}M=we,O=M+56|0;do g[M>>2]=0,M=M+4|0;while((M|0)<(O|0));return Ff(h,f,1,we)|0,f=we,!((g[f>>2]|0)==(d|0)&&(g[f+4>>2]|0)==(E|0))&&(f=we+8|0,!((g[f>>2]|0)==(d|0)&&(g[f+4>>2]|0)==(E|0)))&&(f=we+16|0,!((g[f>>2]|0)==(d|0)&&(g[f+4>>2]|0)==(E|0)))&&(f=we+24|0,!((g[f>>2]|0)==(d|0)&&(g[f+4>>2]|0)==(E|0)))&&(f=we+32|0,!((g[f>>2]|0)==(d|0)&&(g[f+4>>2]|0)==(E|0)))&&(f=we+40|0,!((g[f>>2]|0)==(d|0)&&(g[f+4>>2]|0)==(E|0)))?(M=we+48|0,M=((g[M>>2]|0)==(d|0)?(g[M+4>>2]|0)==(E|0):0)&1):M=1,g[S>>2]=M,S=0,nt=$e,S|0}function bA(h,f,d,E,S){return h=h|0,f=f|0,d=d|0,E=E|0,S=S|0,d=J0(h,f,d,E)|0,(d|0)==7?(S=11,S|0):(E=Ve(d|0,0,56)|0,f=f&-2130706433|(ct()|0)|268435456,g[S>>2]=h|E,g[S+4>>2]=f,S=0,S|0)}function Up(h,f,d){return h=h|0,f=f|0,d=d|0,!0&(f&2013265920|0)==268435456?(g[d>>2]=h,g[d+4>>2]=f&-2130706433|134217728,d=0,d|0):(d=6,d|0)}function Gh(h,f,d){h=h|0,f=f|0,d=d|0;var E=0,S=0,M=0;return S=nt,nt=nt+16|0,E=S,g[E>>2]=0,!0&(f&2013265920|0)==268435456?(M=Oe(h|0,f|0,56)|0,ct()|0,E=Ss(h,f&-2130706433|134217728,M&7,E,d)|0,nt=S,E|0):(E=6,nt=S,E|0)}function RA(h,f){h=h|0,f=f|0;var d=0;switch(d=Oe(h|0,f|0,56)|0,ct()|0,d&7){case 0:case 7:return d=0,d|0;default:}return d=f&-2130706433|134217728,!(!0&(f&2013265920|0)==268435456)||!0&(f&117440512|0)==16777216&(wa(h,d)|0)!=0?(d=0,d|0):(d=df(h,d)|0,d|0)}function Gc(h,f,d){h=h|0,f=f|0,d=d|0;var E=0,S=0,M=0,O=0;return S=nt,nt=nt+16|0,E=S,!0&(f&2013265920|0)==268435456?(M=f&-2130706433|134217728,O=d,g[O>>2]=h,g[O+4>>2]=M,g[E>>2]=0,f=Oe(h|0,f|0,56)|0,ct()|0,E=Ss(h,M,f&7,E,d+8|0)|0,nt=S,E|0):(E=6,nt=S,E|0)}function w0(h,f,d){h=h|0,f=f|0,d=d|0;var E=0,S=0;return S=(wa(h,f)|0)==0,f=f&-2130706433,E=d,g[E>>2]=S?h:0,g[E+4>>2]=S?f|285212672:0,E=d+8|0,g[E>>2]=h,g[E+4>>2]=f|301989888,E=d+16|0,g[E>>2]=h,g[E+4>>2]=f|318767104,E=d+24|0,g[E>>2]=h,g[E+4>>2]=f|335544320,E=d+32|0,g[E>>2]=h,g[E+4>>2]=f|352321536,d=d+40|0,g[d>>2]=h,g[d+4>>2]=f|369098752,0}function Vc(h,f,d){h=h|0,f=f|0,d=d|0;var E=0,S=0,M=0,O=0;return O=nt,nt=nt+16|0,S=O,M=f&-2130706433|134217728,!0&(f&2013265920|0)==268435456?(E=Oe(h|0,f|0,56)|0,ct()|0,E=Di(h,M,E&7)|0,(E|0)==-1?(g[d>>2]=0,M=6,nt=O,M|0):(pu(h,M,S)|0&&bi(23313,22484,282,22499),f=Oe(h|0,f|0,52)|0,ct()|0,f=f&15,wa(h,M)|0?n0(S,f,E,2,d):Hc(S,f,E,2,d),M=0,nt=O,M|0)):(M=6,nt=O,M|0)}function nh(h,f,d){h=h|0,f=f|0,d=d|0;var E=0,S=0;E=nt,nt=nt+16|0,S=E,ih(h,f,d,S),ff(S,d+4|0),nt=E}function ih(h,f,d,E){h=h|0,f=f|0,d=d|0,E=E|0;var S=0,M=0,O=0,F=0,$=0;if(F=nt,nt=nt+16|0,$=F,Vh(h,d,$),M=+ri(+(1-+et[$>>3]*.5)),M<1e-16){g[E>>2]=0,g[E+4>>2]=0,g[E+8>>2]=0,g[E+12>>2]=0,nt=F;return}if($=g[d>>2]|0,S=+et[15920+($*24|0)>>3],S=+eu(S-+eu(+Wh(15600+($<<4)|0,h))),Ho(f)|0?O=+eu(S+-.3334731722518321):O=S,S=+_n(+M)/.381966011250105,(f|0)>0){h=0;do S=S*2.6457513110645907,h=h+1|0;while((h|0)!=(f|0))}M=+Ma(+O)*S,et[E>>3]=M,O=+Yr(+O)*S,et[E+8>>3]=O,nt=F}function Vh(h,f,d){h=h|0,f=f|0,d=d|0;var E=0,S=0,M=0;if(M=nt,nt=nt+32|0,S=M,Pn(h,S),g[f>>2]=0,et[d>>3]=5,E=+Yn(16400,S),E<+et[d>>3]&&(g[f>>2]=0,et[d>>3]=E),E=+Yn(16424,S),E<+et[d>>3]&&(g[f>>2]=1,et[d>>3]=E),E=+Yn(16448,S),E<+et[d>>3]&&(g[f>>2]=2,et[d>>3]=E),E=+Yn(16472,S),E<+et[d>>3]&&(g[f>>2]=3,et[d>>3]=E),E=+Yn(16496,S),E<+et[d>>3]&&(g[f>>2]=4,et[d>>3]=E),E=+Yn(16520,S),E<+et[d>>3]&&(g[f>>2]=5,et[d>>3]=E),E=+Yn(16544,S),E<+et[d>>3]&&(g[f>>2]=6,et[d>>3]=E),E=+Yn(16568,S),E<+et[d>>3]&&(g[f>>2]=7,et[d>>3]=E),E=+Yn(16592,S),E<+et[d>>3]&&(g[f>>2]=8,et[d>>3]=E),E=+Yn(16616,S),E<+et[d>>3]&&(g[f>>2]=9,et[d>>3]=E),E=+Yn(16640,S),E<+et[d>>3]&&(g[f>>2]=10,et[d>>3]=E),E=+Yn(16664,S),E<+et[d>>3]&&(g[f>>2]=11,et[d>>3]=E),E=+Yn(16688,S),E<+et[d>>3]&&(g[f>>2]=12,et[d>>3]=E),E=+Yn(16712,S),E<+et[d>>3]&&(g[f>>2]=13,et[d>>3]=E),E=+Yn(16736,S),E<+et[d>>3]&&(g[f>>2]=14,et[d>>3]=E),E=+Yn(16760,S),E<+et[d>>3]&&(g[f>>2]=15,et[d>>3]=E),E=+Yn(16784,S),E<+et[d>>3]&&(g[f>>2]=16,et[d>>3]=E),E=+Yn(16808,S),E<+et[d>>3]&&(g[f>>2]=17,et[d>>3]=E),E=+Yn(16832,S),E<+et[d>>3]&&(g[f>>2]=18,et[d>>3]=E),E=+Yn(16856,S),!(E<+et[d>>3])){nt=M;return}g[f>>2]=19,et[d>>3]=E,nt=M}function Af(h,f,d,E,S){h=h|0,f=f|0,d=d|0,E=E|0,S=S|0;var M=0,O=0;if(M=+Zr(h),M<1e-16){f=15600+(f<<4)|0,g[S>>2]=g[f>>2],g[S+4>>2]=g[f+4>>2],g[S+8>>2]=g[f+8>>2],g[S+12>>2]=g[f+12>>2];return}if(O=+Zn(+ +et[h+8>>3],+ +et[h>>3]),(d|0)>0){h=0;do M=M/2.6457513110645907,h=h+1|0;while((h|0)!=(d|0))}E?(M=M/3,d=(Ho(d)|0)==0,M=+oi(+((d?M:M/2.6457513110645907)*.381966011250105))):(M=+oi(+(M*.381966011250105)),Ho(d)|0&&(O=+eu(O+.3334731722518321))),yf(15600+(f<<4)|0,+eu(+et[15920+(f*24|0)>>3]-O),M,S)}function pf(h,f,d){h=h|0,f=f|0,d=d|0;var E=0,S=0;E=nt,nt=nt+16|0,S=E,Yu(h+4|0,S),Af(S,g[h>>2]|0,f,0,d),nt=E}function n0(h,f,d,E,S){h=h|0,f=f|0,d=d|0,E=E|0,S=S|0;var M=0,O=0,F=0,$=0,pe=0,we=0,$e=0,At=0,Rt=0,_t=0,zt=0,xr=0,mr=0,fr=0,ur=0,er=0,Sn=0,wn=0,cn=0,En=0,Va=0,Ta=0,Ca=0,Li=0,Ei=0,_i=0,ro=0,Yi=0;if(_i=nt,nt=nt+272|0,M=_i+256|0,fr=_i+240|0,Ca=_i,Li=_i+224|0,Ei=_i+208|0,ur=_i+176|0,er=_i+160|0,Sn=_i+192|0,wn=_i+144|0,cn=_i+128|0,En=_i+112|0,Va=_i+96|0,Ta=_i+80|0,g[M>>2]=f,g[fr>>2]=g[h>>2],g[fr+4>>2]=g[h+4>>2],g[fr+8>>2]=g[h+8>>2],g[fr+12>>2]=g[h+12>>2],Vo(fr,M,Ca),g[S>>2]=0,fr=E+d+((E|0)==5&1)|0,(fr|0)<=(d|0)){nt=_i;return}$=g[M>>2]|0,pe=Li+4|0,we=ur+4|0,$e=d+5|0,At=16880+($<<2)|0,Rt=16960+($<<2)|0,_t=cn+8|0,zt=En+8|0,xr=Va+8|0,mr=Ei+4|0,F=d;e:for(;;){O=Ca+(((F|0)%5|0)<<4)|0,g[Ei>>2]=g[O>>2],g[Ei+4>>2]=g[O+4>>2],g[Ei+8>>2]=g[O+8>>2],g[Ei+12>>2]=g[O+12>>2];do;while((Au(Ei,$,0,1)|0)==2);if((F|0)>(d|0)&(Ho(f)|0)!=0){if(g[ur>>2]=g[Ei>>2],g[ur+4>>2]=g[Ei+4>>2],g[ur+8>>2]=g[Ei+8>>2],g[ur+12>>2]=g[Ei+12>>2],Yu(pe,er),E=g[ur>>2]|0,M=g[17040+(E*80|0)+(g[Li>>2]<<2)>>2]|0,g[ur>>2]=g[18640+(E*80|0)+(M*20|0)>>2],O=g[18640+(E*80|0)+(M*20|0)+16>>2]|0,(O|0)>0){h=0;do $u(we),h=h+1|0;while((h|0)<(O|0))}switch(O=18640+(E*80|0)+(M*20|0)+4|0,g[Sn>>2]=g[O>>2],g[Sn+4>>2]=g[O+4>>2],g[Sn+8>>2]=g[O+8>>2],e0(Sn,(g[At>>2]|0)*3|0),Gs(we,Sn,we),$o(we),Yu(we,wn),ro=+(g[Rt>>2]|0),et[cn>>3]=ro*3,et[_t>>3]=0,Yi=ro*-1.5,et[En>>3]=Yi,et[zt>>3]=ro*2.598076211353316,et[Va>>3]=Yi,et[xr>>3]=ro*-2.598076211353316,g[17040+((g[ur>>2]|0)*80|0)+(g[Ei>>2]<<2)>>2]|0){case 1:{h=En,E=cn;break}case 3:{h=Va,E=En;break}case 2:{h=cn,E=Va;break}default:{h=12;break e}}Tr(er,wn,E,h,Ta),Af(Ta,g[ur>>2]|0,$,1,S+8+(g[S>>2]<<4)|0),g[S>>2]=(g[S>>2]|0)+1}if((F|0)<($e|0)&&(Yu(mr,ur),Af(ur,g[Ei>>2]|0,$,1,S+8+(g[S>>2]<<4)|0),g[S>>2]=(g[S>>2]|0)+1),g[Li>>2]=g[Ei>>2],g[Li+4>>2]=g[Ei+4>>2],g[Li+8>>2]=g[Ei+8>>2],g[Li+12>>2]=g[Ei+12>>2],F=F+1|0,(F|0)>=(fr|0)){h=3;break}}if((h|0)==3){nt=_i;return}else(h|0)==12&&bi(22522,22569,571,22579)}function Vo(h,f,d){h=h|0,f=f|0,d=d|0;var E=0,S=0,M=0,O=0,F=0,$=0;$=nt,nt=nt+128|0,E=$+64|0,S=$,M=E,O=20240,F=M+60|0;do g[M>>2]=g[O>>2],M=M+4|0,O=O+4|0;while((M|0)<(F|0));M=S,O=20304,F=M+60|0;do g[M>>2]=g[O>>2],M=M+4|0,O=O+4|0;while((M|0)<(F|0));F=(Ho(g[f>>2]|0)|0)==0,E=F?E:S,S=h+4|0,kh(S),Uh(S),Ho(g[f>>2]|0)|0&&(vc(S),g[f>>2]=(g[f>>2]|0)+1),g[d>>2]=g[h>>2],f=d+4|0,Gs(S,E,f),$o(f),g[d+16>>2]=g[h>>2],f=d+20|0,Gs(S,E+12|0,f),$o(f),g[d+32>>2]=g[h>>2],f=d+36|0,Gs(S,E+24|0,f),$o(f),g[d+48>>2]=g[h>>2],f=d+52|0,Gs(S,E+36|0,f),$o(f),g[d+64>>2]=g[h>>2],d=d+68|0,Gs(S,E+48|0,d),$o(d),nt=$}function Au(h,f,d,E){h=h|0,f=f|0,d=d|0,E=E|0;var S=0,M=0,O=0,F=0,$=0,pe=0,we=0,$e=0,At=0,Rt=0,_t=0;if(_t=nt,nt=nt+32|0,At=_t+12|0,F=_t,Rt=h+4|0,$e=g[16960+(f<<2)>>2]|0,we=(E|0)!=0,$e=we?$e*3|0:$e,S=g[Rt>>2]|0,pe=h+8|0,O=g[pe>>2]|0,we){if(M=h+12|0,E=g[M>>2]|0,S=O+S+E|0,(S|0)==($e|0))return Rt=1,nt=_t,Rt|0;$=M}else $=h+12|0,E=g[$>>2]|0,S=O+S+E|0;if((S|0)<=($e|0))return Rt=0,nt=_t,Rt|0;do if((E|0)>0){if(E=g[h>>2]|0,(O|0)>0){M=18640+(E*80|0)+60|0,E=h;break}E=18640+(E*80|0)+40|0,d?(Kf(At,$e,0,0),Jf(Rt,At,F),Dl(F),Gs(F,At,Rt),M=E,E=h):(M=E,E=h)}else M=18640+((g[h>>2]|0)*80|0)+20|0,E=h;while(0);if(g[E>>2]=g[M>>2],S=M+16|0,(g[S>>2]|0)>0){E=0;do $u(Rt),E=E+1|0;while((E|0)<(g[S>>2]|0))}return h=M+4|0,g[At>>2]=g[h>>2],g[At+4>>2]=g[h+4>>2],g[At+8>>2]=g[h+8>>2],f=g[16880+(f<<2)>>2]|0,e0(At,we?f*3|0:f),Gs(Rt,At,Rt),$o(Rt),we?E=((g[pe>>2]|0)+(g[Rt>>2]|0)+(g[$>>2]|0)|0)==($e|0)?1:2:E=2,Rt=E,nt=_t,Rt|0}function mc(h,f){h=h|0,f=f|0;var d=0;do d=Au(h,f,0,1)|0;while((d|0)==2);return d|0}function Hc(h,f,d,E,S){h=h|0,f=f|0,d=d|0,E=E|0,S=S|0;var M=0,O=0,F=0,$=0,pe=0,we=0,$e=0,At=0,Rt=0,_t=0,zt=0,xr=0,mr=0,fr=0,ur=0,er=0,Sn=0,wn=0,cn=0,En=0,Va=0,Ta=0,Ca=0;if(Va=nt,nt=nt+240|0,M=Va+224|0,Sn=Va+208|0,wn=Va,cn=Va+192|0,En=Va+176|0,xr=Va+160|0,mr=Va+144|0,fr=Va+128|0,ur=Va+112|0,er=Va+96|0,g[M>>2]=f,g[Sn>>2]=g[h>>2],g[Sn+4>>2]=g[h+4>>2],g[Sn+8>>2]=g[h+8>>2],g[Sn+12>>2]=g[h+12>>2],Qu(Sn,M,wn),g[S>>2]=0,zt=E+d+((E|0)==6&1)|0,(zt|0)<=(d|0)){nt=Va;return}$=g[M>>2]|0,pe=d+6|0,we=16960+($<<2)|0,$e=mr+8|0,At=fr+8|0,Rt=ur+8|0,_t=cn+4|0,O=0,F=d,E=-1;e:for(;;){if(M=(F|0)%6|0,h=wn+(M<<4)|0,g[cn>>2]=g[h>>2],g[cn+4>>2]=g[h+4>>2],g[cn+8>>2]=g[h+8>>2],g[cn+12>>2]=g[h+12>>2],h=O,O=Au(cn,$,0,1)|0,(F|0)>(d|0)&(Ho(f)|0)!=0&&(h|0)!=1&&(g[cn>>2]|0)!=(E|0)){switch(Yu(wn+(((M+5|0)%6|0)<<4)+4|0,En),Yu(wn+(M<<4)+4|0,xr),Ta=+(g[we>>2]|0),et[mr>>3]=Ta*3,et[$e>>3]=0,Ca=Ta*-1.5,et[fr>>3]=Ca,et[At>>3]=Ta*2.598076211353316,et[ur>>3]=Ca,et[Rt>>3]=Ta*-2.598076211353316,M=g[Sn>>2]|0,g[17040+(M*80|0)+(((E|0)==(M|0)?g[cn>>2]|0:E)<<2)>>2]|0){case 1:{h=fr,E=mr;break}case 3:{h=ur,E=fr;break}case 2:{h=mr,E=ur;break}default:{h=8;break e}}Tr(En,xr,E,h,er),!(ai(En,er)|0)&&!(ai(xr,er)|0)&&(Af(er,g[Sn>>2]|0,$,1,S+8+(g[S>>2]<<4)|0),g[S>>2]=(g[S>>2]|0)+1)}if((F|0)<(pe|0)&&(Yu(_t,En),Af(En,g[cn>>2]|0,$,1,S+8+(g[S>>2]<<4)|0),g[S>>2]=(g[S>>2]|0)+1),F=F+1|0,(F|0)>=(zt|0)){h=3;break}else E=g[cn>>2]|0}if((h|0)==3){nt=Va;return}else(h|0)==8&&bi(22606,22569,736,22651)}function Qu(h,f,d){h=h|0,f=f|0,d=d|0;var E=0,S=0,M=0,O=0,F=0,$=0;$=nt,nt=nt+160|0,E=$+80|0,S=$,M=E,O=20368,F=M+72|0;do g[M>>2]=g[O>>2],M=M+4|0,O=O+4|0;while((M|0)<(F|0));M=S,O=20448,F=M+72|0;do g[M>>2]=g[O>>2],M=M+4|0,O=O+4|0;while((M|0)<(F|0));F=(Ho(g[f>>2]|0)|0)==0,E=F?E:S,S=h+4|0,kh(S),Uh(S),Ho(g[f>>2]|0)|0&&(vc(S),g[f>>2]=(g[f>>2]|0)+1),g[d>>2]=g[h>>2],f=d+4|0,Gs(S,E,f),$o(f),g[d+16>>2]=g[h>>2],f=d+20|0,Gs(S,E+12|0,f),$o(f),g[d+32>>2]=g[h>>2],f=d+36|0,Gs(S,E+24|0,f),$o(f),g[d+48>>2]=g[h>>2],f=d+52|0,Gs(S,E+36|0,f),$o(f),g[d+64>>2]=g[h>>2],f=d+68|0,Gs(S,E+48|0,f),$o(f),g[d+80>>2]=g[h>>2],d=d+84|0,Gs(S,E+60|0,d),$o(d),nt=$}function tc(h,f){return h=h|0,f=f|0,f=Oe(h|0,f|0,52)|0,ct()|0,f&15|0}function Wc(h,f){return h=h|0,f=f|0,f=Oe(h|0,f|0,45)|0,ct()|0,f&127|0}function df(h,f){h=h|0,f=f|0;var d=0,E=0,S=0,M=0,O=0,F=0;if(!(!0&(f&-16777216|0)==134217728)||(O=Oe(h|0,f|0,45)|0,ct()|0,O=O&127,O>>>0>121))return f=0,f|0;d=Oe(h|0,f|0,52)|0,ct()|0,d=d&15;do if(d|0){for(S=1,E=0;;){if(M=Oe(h|0,f|0,(15-S|0)*3|0)|0,ct()|0,M=M&7,(M|0)!=0&(E^1))if((M|0)==1&(_a(O)|0)!=0){F=0,E=13;break}else E=1;if((M|0)==7){F=0,E=13;break}if(S>>>0<d>>>0)S=S+1|0;else{E=9;break}}if((E|0)==9){if((d|0)==15)F=1;else break;return F|0}else if((E|0)==13)return F|0}while(0);for(;;){if(F=Oe(h|0,f|0,(14-d|0)*3|0)|0,ct()|0,!((F&7|0)==7&!0)){F=0,E=13;break}if(d>>>0<14)d=d+1|0;else{F=1,E=13;break}}return(E|0)==13?F|0:0}function _c(h,f,d,E){h=h|0,f=f|0,d=d|0,E=E|0;var S=0,M=0;if(M=Oe(h|0,f|0,52)|0,ct()|0,M=M&15,d>>>0>15)return E=4,E|0;if((M|0)<(d|0))return E=12,E|0;if((M|0)==(d|0))return g[E>>2]=h,g[E+4>>2]=f,E=0,E|0;if(S=Ve(d|0,0,52)|0,S=S|h,h=ct()|0|f&-15728641,(M|0)>(d|0))do f=Ve(7,0,(14-d|0)*3|0)|0,d=d+1|0,S=f|S,h=ct()|0|h;while((d|0)<(M|0));return g[E>>2]=S,g[E+4>>2]=h,E=0,E|0}function vf(h,f,d,E){h=h|0,f=f|0,d=d|0,E=E|0;var S=0,M=0,O=0;if(M=Oe(h|0,f|0,52)|0,ct()|0,M=M&15,!((d|0)<16&(M|0)<=(d|0)))return E=4,E|0;S=d-M|0,d=Oe(h|0,f|0,45)|0,ct()|0;e:do if(!(_a(d&127)|0))d=jt(7,0,S,((S|0)<0)<<31>>31)|0,S=ct()|0;else{t:do if(M|0){for(d=1;O=Ve(7,0,(15-d|0)*3|0)|0,!!((O&h|0)==0&((ct()|0)&f|0)==0);)if(d>>>0<M>>>0)d=d+1|0;else break t;d=jt(7,0,S,((S|0)<0)<<31>>31)|0,S=ct()|0;break e}while(0);d=jt(7,0,S,((S|0)<0)<<31>>31)|0,d=Xt(d|0,ct()|0,5,0)|0,d=vn(d|0,ct()|0,-5,-1)|0,d=ht(d|0,ct()|0,6,0)|0,d=vn(d|0,ct()|0,1,0)|0,S=ct()|0}while(0);return O=E,g[O>>2]=d,g[O+4>>2]=S,O=0,O|0}function wa(h,f){h=h|0,f=f|0;var d=0,E=0,S=0;if(S=Oe(h|0,f|0,45)|0,ct()|0,!(_a(S&127)|0))return S=0,S|0;S=Oe(h|0,f|0,52)|0,ct()|0,S=S&15;e:do if(!S)d=0;else for(E=1;;){if(d=Oe(h|0,f|0,(15-E|0)*3|0)|0,ct()|0,d=d&7,d|0)break e;if(E>>>0<S>>>0)E=E+1|0;else{d=0;break}}while(0);return S=(d|0)==0&1,S|0}function yc(h,f,d,E){h=h|0,f=f|0,d=d|0,E=E|0;var S=0,M=0,O=0,F=0;if(O=nt,nt=nt+16|0,M=O,s0(M,h,f,d),f=M,h=g[f>>2]|0,f=g[f+4>>2]|0,(h|0)==0&(f|0)==0)return nt=O,0;S=0,d=0;do F=E+(S<<3)|0,g[F>>2]=h,g[F+4>>2]=f,S=vn(S|0,d|0,1,0)|0,d=ct()|0,P0(M),F=M,h=g[F>>2]|0,f=g[F+4>>2]|0;while(!((h|0)==0&(f|0)==0));return nt=O,0}function Uf(h,f,d,E){return h=h|0,f=f|0,d=d|0,E=E|0,(E|0)<(d|0)?(d=f,E=h,zi(d|0),E|0):(d=Ve(-1,-1,((E-d|0)*3|0)+3|0)|0,E=Ve(~d|0,~(ct()|0)|0,(15-E|0)*3|0)|0,d=~(ct()|0)&f,E=~E&h,zi(d|0),E|0)}function Ec(h,f,d,E){h=h|0,f=f|0,d=d|0,E=E|0;var S=0;return S=Oe(h|0,f|0,52)|0,ct()|0,S=S&15,(d|0)<16&(S|0)<=(d|0)?((S|0)<(d|0)&&(S=Ve(-1,-1,((d+-1-S|0)*3|0)+3|0)|0,S=Ve(~S|0,~(ct()|0)|0,(15-d|0)*3|0)|0,f=~(ct()|0)&f,h=~S&h),S=Ve(d|0,0,52)|0,d=f&-15728641|(ct()|0),g[E>>2]=h|S,g[E+4>>2]=d,E=0,E|0):(E=4,E|0)}function i0(h,f,d,E){h=h|0,f=f|0,d=d|0,E=E|0;var S=0,M=0,O=0,F=0,$=0,pe=0,we=0,$e=0,At=0,Rt=0,_t=0,zt=0,xr=0,mr=0,fr=0,ur=0,er=0,Sn=0,wn=0,cn=0,En=0;if((d|0)==0&(E|0)==0)return cn=0,cn|0;if(S=h,M=g[S>>2]|0,S=g[S+4>>2]|0,!0&(S&15728640|0)==0){if(!((E|0)>0|(E|0)==0&d>>>0>0)||(cn=f,g[cn>>2]=M,g[cn+4>>2]=S,(d|0)==1&(E|0)==0))return cn=0,cn|0;S=1;do Sn=h+(S<<3)|0,wn=g[Sn+4>>2]|0,cn=f+(S<<3)|0,g[cn>>2]=g[Sn>>2],g[cn+4>>2]=wn,S=S+1|0;while(0<(E|0)|(E|0)==0&S>>>0<d>>>0);return S=0,S|0}if(er=d<<3,wn=to(er)|0,!wn)return cn=13,cn|0;if(wt(wn|0,h|0,er|0)|0,Sn=Mn(d,8)|0,!Sn)return pn(wn),cn=13,cn|0;e:do if(d|0){t:for(;;){S=wn,mr=g[S>>2]|0,S=g[S+4>>2]|0,fr=Oe(mr|0,S|0,52)|0,ct()|0,fr=fr&15,ur=fr+-1|0,xr=(d|0)>0;r:do if((fr|0)!=0&xr){if(Rt=((d|0)<0)<<31>>31,_t=Ve(ur|0,0,52)|0,zt=ct()|0,ur>>>0>15){if(!((mr|0)==0&(S|0)==0)){cn=17;break t}for(M=0;;){if(M=M+1|0,(M|0)>=(d|0))break r;if(E=wn+(M<<3)|0,zt=g[E>>2]|0,E=g[E+4>>2]|0,!((zt|0)==0&(E|0)==0)){S=E,cn=17;break t}}}for(M=0,h=mr,E=S;;){if(!((h|0)==0&(E|0)==0)){if(!(!0&(E&117440512|0)==0)){cn=22;break t}if(F=Oe(h|0,E|0,52)|0,ct()|0,F=F&15,(F|0)<(ur|0)){S=12,cn=28;break t}if((F|0)!=(ur|0)&&(h=h|_t,E=E&-15728641|zt,F>>>0>=fr>>>0)){O=ur;do At=Ve(7,0,(14-O|0)*3|0)|0,O=O+1|0,h=At|h,E=ct()|0|E;while(O>>>0<F>>>0)}if(O=di(h|0,E|0,d|0,Rt|0)|0,ct()|0,pe=Sn+(O<<3)|0,F=pe,$=g[F>>2]|0,F=g[F+4>>2]|0,($|0)==0&(F|0)==0)O=pe;else for(At=0;;){if((At|0)>(d|0)){cn=32;break t}if(($|0)==(h|0)&(F&-117440513|0)==(E|0)){we=Oe($|0,F|0,56)|0,ct()|0,we=we&7,$e=we+1|0,En=Oe($|0,F|0,45)|0,ct()|0;n:do if(!(_a(En&127)|0))F=7;else{if($=Oe($|0,F|0,52)|0,ct()|0,$=$&15,!$){F=6;break}for(F=1;;){if(En=Ve(7,0,(15-F|0)*3|0)|0,!((En&h|0)==0&((ct()|0)&E|0)==0)){F=7;break n}if(F>>>0<$>>>0)F=F+1|0;else{F=6;break}}}while(0);if((we+2|0)>>>0>F>>>0){cn=42;break t}En=Ve($e|0,0,56)|0,E=ct()|0|E&-117440513,$e=pe,g[$e>>2]=0,g[$e+4>>2]=0,h=En|h}else O=(O+1|0)%(d|0)|0;if(pe=Sn+(O<<3)|0,F=pe,$=g[F>>2]|0,F=g[F+4>>2]|0,($|0)==0&(F|0)==0){O=pe;break}else At=At+1|0}En=O,g[En>>2]=h,g[En+4>>2]=E}if(M=M+1|0,(M|0)>=(d|0))break r;E=wn+(M<<3)|0,h=g[E>>2]|0,E=g[E+4>>2]|0}}while(0);if((d+5|0)>>>0<11){cn=85;break}if(zt=Mn((d|0)/6|0,8)|0,!zt){cn=49;break}r:do if(xr){At=0,$e=0;do{if(F=Sn+(At<<3)|0,E=F,M=g[E>>2]|0,E=g[E+4>>2]|0,!((M|0)==0&(E|0)==0)){$=Oe(M|0,E|0,56)|0,ct()|0,$=$&7,h=$+1|0,pe=E&-117440513,En=Oe(M|0,E|0,45)|0,ct()|0;n:do if(_a(En&127)|0){if(we=Oe(M|0,E|0,52)|0,ct()|0,we=we&15,we|0)for(O=1;;){if(En=Ve(7,0,(15-O|0)*3|0)|0,!((M&En|0)==0&(pe&(ct()|0)|0)==0))break n;if(O>>>0<we>>>0)O=O+1|0;else break}E=Ve(h|0,0,56)|0,M=E|M,E=ct()|0|pe,h=F,g[h>>2]=M,g[h+4>>2]=E,h=$+2|0}while(0);(h|0)==7&&(En=zt+($e<<3)|0,g[En>>2]=M,g[En+4>>2]=E&-117440513,$e=$e+1|0)}At=At+1|0}while((At|0)!=(d|0));if(xr){if(At=((d|0)<0)<<31>>31,Rt=Ve(ur|0,0,52)|0,_t=ct()|0,ur>>>0>15){if(!((mr|0)==0&(S|0)==0)){S=4,cn=84;break t}for(S=0;;){if(S=S+1|0,(S|0)>=(d|0)){M=0,S=$e;break r}if(En=wn+(S<<3)|0,!((g[En>>2]|0)==0&(g[En+4>>2]|0)==0)){S=4,cn=84;break t}}}for(we=0,M=0,pe=mr;;){do if(!((pe|0)==0&(S|0)==0)){if(F=Oe(pe|0,S|0,52)|0,ct()|0,F=F&15,(F|0)<(ur|0)){S=12,cn=84;break t}do if((F|0)==(ur|0))E=pe,F=S;else{if(E=pe|Rt,h=S&-15728641|_t,F>>>0<fr>>>0){F=h;break}O=ur;do En=Ve(7,0,(14-O|0)*3|0)|0,O=O+1|0,E=En|E,h=ct()|0|h;while(O>>>0<F>>>0);F=h}while(0);for(O=di(E|0,F|0,d|0,At|0)|0,ct()|0,h=0;;){if((h|0)>(d|0)){cn=77;break t}if(En=Sn+(O<<3)|0,$=g[En+4>>2]|0,($&-117440513|0)==(F|0)&&(g[En>>2]|0)==(E|0)){cn=79;break}if(O=(O+1|0)%(d|0)|0,En=Sn+(O<<3)|0,(g[En>>2]|0)==(E|0)&&(g[En+4>>2]|0)==(F|0))break;h=h+1|0}if((cn|0)==79&&(cn=0,!0&($&117440512|0)==100663296))break;En=f+(M<<3)|0,g[En>>2]=pe,g[En+4>>2]=S,M=M+1|0}while(0);if(S=we+1|0,(S|0)>=(d|0)){S=$e;break r}En=wn+(S<<3)|0,we=S,pe=g[En>>2]|0,S=g[En+4>>2]|0}}else M=0,S=$e}else M=0,S=0;while(0);if(Bt(Sn|0,0,er|0)|0,wt(wn|0,zt|0,S<<3|0)|0,pn(zt),S)f=f+(M<<3)|0,d=S;else break e}if((cn|0)==17)!0&(S&117440512|0)==0?(S=4,cn=28):cn=22;else if((cn|0)==32)bi(23313,22674,362,22684);else{if((cn|0)==42)return pn(wn),pn(Sn),En=10,En|0;if((cn|0)==49)return pn(wn),pn(Sn),En=13,En|0;if((cn|0)==77)bi(23313,22674,462,22684);else{if((cn|0)==84)return pn(zt),pn(wn),pn(Sn),En=S,En|0;if((cn|0)==85){wt(f|0,wn|0,d<<3|0)|0;break}}}if((cn|0)==22)return pn(wn),pn(Sn),En=5,En|0;if((cn|0)==28)return pn(wn),pn(Sn),En=S,En|0}while(0);return pn(wn),pn(Sn),En=0,En|0}function ah(h,f,d,E,S,M,O){h=h|0,f=f|0,d=d|0,E=E|0,S=S|0,M=M|0,O=O|0;var F=0,$=0,pe=0,we=0,$e=0,At=0,Rt=0,_t=0,zt=0;if(zt=nt,nt=nt+16|0,_t=zt,!((d|0)>0|(d|0)==0&f>>>0>0))return _t=0,nt=zt,_t|0;if((O|0)>=16)return _t=12,nt=zt,_t|0;At=0,Rt=0,$e=0,F=0;e:for(;;){if(pe=h+(At<<3)|0,$=g[pe>>2]|0,pe=g[pe+4>>2]|0,we=Oe($|0,pe|0,52)|0,ct()|0,(we&15|0)>(O|0)){F=12,$=11;break}if(s0(_t,$,pe,O),we=_t,pe=g[we>>2]|0,we=g[we+4>>2]|0,(pe|0)==0&(we|0)==0)$=$e;else{$=$e;do{if(!((F|0)<(M|0)|(F|0)==(M|0)&$>>>0<S>>>0)){$=10;break e}$e=E+($<<3)|0,g[$e>>2]=pe,g[$e+4>>2]=we,$=vn($|0,F|0,1,0)|0,F=ct()|0,P0(_t),$e=_t,pe=g[$e>>2]|0,we=g[$e+4>>2]|0}while(!((pe|0)==0&(we|0)==0))}if(At=vn(At|0,Rt|0,1,0)|0,Rt=ct()|0,(Rt|0)<(d|0)|(Rt|0)==(d|0)&At>>>0<f>>>0)$e=$;else{F=0,$=11;break}}return($|0)==10?(_t=14,nt=zt,_t|0):($|0)==11?(nt=zt,F|0):0}function Hh(h,f,d,E,S){h=h|0,f=f|0,d=d|0,E=E|0,S=S|0;var M=0,O=0,F=0,$=0,pe=0,we=0,$e=0,At=0;At=nt,nt=nt+16|0,$e=At;e:do if((d|0)>0|(d|0)==0&f>>>0>0){for(pe=0,O=0,M=0,we=0;;){if($=h+(pe<<3)|0,F=g[$>>2]|0,$=g[$+4>>2]|0,!((F|0)==0&($|0)==0)&&($=(vf(F,$,E,$e)|0)==0,F=$e,O=vn(g[F>>2]|0,g[F+4>>2]|0,O|0,M|0)|0,M=ct()|0,!$)){M=12;break}if(pe=vn(pe|0,we|0,1,0)|0,we=ct()|0,!((we|0)<(d|0)|(we|0)==(d|0)&pe>>>0<f>>>0))break e}return nt=At,M|0}else O=0,M=0;while(0);return g[S>>2]=O,g[S+4>>2]=M,S=0,nt=At,S|0}function jc(h,f){return h=h|0,f=f|0,f=Oe(h|0,f|0,52)|0,ct()|0,f&1|0}function Ks(h,f){h=h|0,f=f|0;var d=0,E=0,S=0;if(S=Oe(h|0,f|0,52)|0,ct()|0,S=S&15,!S)return S=0,S|0;for(E=1;;){if(d=Oe(h|0,f|0,(15-E|0)*3|0)|0,ct()|0,d=d&7,d|0){E=5;break}if(E>>>0<S>>>0)E=E+1|0;else{d=0,E=5;break}}return(E|0)==5?d|0:0}function Xc(h,f){h=h|0,f=f|0;var d=0,E=0,S=0,M=0,O=0,F=0,$=0;if($=Oe(h|0,f|0,52)|0,ct()|0,$=$&15,!$)return F=f,$=h,zi(F|0),$|0;for(F=1,d=0;;){M=(15-F|0)*3|0,E=Ve(7,0,M|0)|0,S=ct()|0,O=Oe(h|0,f|0,M|0)|0,ct()|0,M=Ve(Ll(O&7)|0,0,M|0)|0,O=ct()|0,h=M|h&~E,f=O|f&~S;e:do if(!d)if((M&E|0)==0&(O&S|0)==0)d=0;else if(E=Oe(h|0,f|0,52)|0,ct()|0,E=E&15,!E)d=1;else{d=1;t:for(;;){switch(O=Oe(h|0,f|0,(15-d|0)*3|0)|0,ct()|0,O&7){case 1:break t;case 0:break;default:{d=1;break e}}if(d>>>0<E>>>0)d=d+1|0;else{d=1;break e}}for(d=1;;)if(O=(15-d|0)*3|0,S=Oe(h|0,f|0,O|0)|0,ct()|0,M=Ve(7,0,O|0)|0,f=f&~(ct()|0),O=Ve(Ll(S&7)|0,0,O|0)|0,h=h&~M|O,f=f|(ct()|0),d>>>0<E>>>0)d=d+1|0;else{d=1;break}}while(0);if(F>>>0<$>>>0)F=F+1|0;else break}return zi(f|0),h|0}function Fl(h,f){h=h|0,f=f|0;var d=0,E=0,S=0,M=0,O=0;if(E=Oe(h|0,f|0,52)|0,ct()|0,E=E&15,!E)return d=f,E=h,zi(d|0),E|0;for(d=1;M=(15-d|0)*3|0,O=Oe(h|0,f|0,M|0)|0,ct()|0,S=Ve(7,0,M|0)|0,f=f&~(ct()|0),M=Ve(Ll(O&7)|0,0,M|0)|0,h=M|h&~S,f=ct()|0|f,d>>>0<E>>>0;)d=d+1|0;return zi(f|0),h|0}function a0(h,f){h=h|0,f=f|0;var d=0,E=0,S=0,M=0,O=0,F=0,$=0;if($=Oe(h|0,f|0,52)|0,ct()|0,$=$&15,!$)return F=f,$=h,zi(F|0),$|0;for(F=1,d=0;;){M=(15-F|0)*3|0,E=Ve(7,0,M|0)|0,S=ct()|0,O=Oe(h|0,f|0,M|0)|0,ct()|0,M=Ve(gc(O&7)|0,0,M|0)|0,O=ct()|0,h=M|h&~E,f=O|f&~S;e:do if(!d)if((M&E|0)==0&(O&S|0)==0)d=0;else if(E=Oe(h|0,f|0,52)|0,ct()|0,E=E&15,!E)d=1;else{d=1;t:for(;;){switch(O=Oe(h|0,f|0,(15-d|0)*3|0)|0,ct()|0,O&7){case 1:break t;case 0:break;default:{d=1;break e}}if(d>>>0<E>>>0)d=d+1|0;else{d=1;break e}}for(d=1;;)if(S=(15-d|0)*3|0,M=Ve(7,0,S|0)|0,O=f&~(ct()|0),f=Oe(h|0,f|0,S|0)|0,ct()|0,f=Ve(gc(f&7)|0,0,S|0)|0,h=h&~M|f,f=O|(ct()|0),d>>>0<E>>>0)d=d+1|0;else{d=1;break}}while(0);if(F>>>0<$>>>0)F=F+1|0;else break}return zi(f|0),h|0}function qu(h,f){h=h|0,f=f|0;var d=0,E=0,S=0,M=0,O=0;if(E=Oe(h|0,f|0,52)|0,ct()|0,E=E&15,!E)return d=f,E=h,zi(d|0),E|0;for(d=1;O=(15-d|0)*3|0,M=Ve(7,0,O|0)|0,S=f&~(ct()|0),f=Oe(h|0,f|0,O|0)|0,ct()|0,f=Ve(gc(f&7)|0,0,O|0)|0,h=f|h&~M,f=ct()|0|S,d>>>0<E>>>0;)d=d+1|0;return zi(f|0),h|0}function oh(h,f){h=h|0,f=f|0;var d=0,E=0,S=0,M=0,O=0,F=0,$=0,pe=0,we=0;if($=nt,nt=nt+64|0,F=$+40|0,E=$+24|0,S=$+12|0,M=$,Ve(f|0,0,52)|0,d=ct()|0|134225919,!f)return(g[h+4>>2]|0)>2||(g[h+8>>2]|0)>2||(g[h+12>>2]|0)>2?(O=0,F=0,zi(O|0),nt=$,F|0):(Ve(xs(h)|0,0,45)|0,O=ct()|0|d,F=-1,zi(O|0),nt=$,F|0);if(g[F>>2]=g[h>>2],g[F+4>>2]=g[h+4>>2],g[F+8>>2]=g[h+8>>2],g[F+12>>2]=g[h+12>>2],O=F+4|0,(f|0)>0)for(h=-1;g[E>>2]=g[O>>2],g[E+4>>2]=g[O+4>>2],g[E+8>>2]=g[O+8>>2],f&1?(hf(O),g[S>>2]=g[O>>2],g[S+4>>2]=g[O+4>>2],g[S+8>>2]=g[O+8>>2],r0(S)):(Bh(O),g[S>>2]=g[O>>2],g[S+4>>2]=g[O+4>>2],g[S+8>>2]=g[O+8>>2],vc(S)),Jf(E,S,M),$o(M),we=(15-f|0)*3|0,pe=Ve(7,0,we|0)|0,d=d&~(ct()|0),we=Ve(t0(M)|0,0,we|0)|0,h=we|h&~pe,d=ct()|0|d,(f|0)>1;)f=f+-1|0;else h=-1;e:do if((g[O>>2]|0)<=2&&(g[F+8>>2]|0)<=2&&(g[F+12>>2]|0)<=2){if(E=xs(F)|0,f=Ve(E|0,0,45)|0,f=f|h,h=ct()|0|d&-1040385,M=qf(F)|0,!(_a(E)|0)){if((M|0)<=0)break;for(S=0;;){if(E=Oe(f|0,h|0,52)|0,ct()|0,E=E&15,E)for(d=1;we=(15-d|0)*3|0,F=Oe(f|0,h|0,we|0)|0,ct()|0,pe=Ve(7,0,we|0)|0,h=h&~(ct()|0),we=Ve(Ll(F&7)|0,0,we|0)|0,f=f&~pe|we,h=h|(ct()|0),d>>>0<E>>>0;)d=d+1|0;if(S=S+1|0,(S|0)==(M|0))break e}}S=Oe(f|0,h|0,52)|0,ct()|0,S=S&15;t:do if(S){d=1;r:for(;;){switch(we=Oe(f|0,h|0,(15-d|0)*3|0)|0,ct()|0,we&7){case 1:break r;case 0:break;default:break t}if(d>>>0<S>>>0)d=d+1|0;else break t}if(C0(E,g[F>>2]|0)|0)for(d=1;F=(15-d|0)*3|0,pe=Ve(7,0,F|0)|0,we=h&~(ct()|0),h=Oe(f|0,h|0,F|0)|0,ct()|0,h=Ve(gc(h&7)|0,0,F|0)|0,f=f&~pe|h,h=we|(ct()|0),d>>>0<S>>>0;)d=d+1|0;else for(d=1;we=(15-d|0)*3|0,F=Oe(f|0,h|0,we|0)|0,ct()|0,pe=Ve(7,0,we|0)|0,h=h&~(ct()|0),we=Ve(Ll(F&7)|0,0,we|0)|0,f=f&~pe|we,h=h|(ct()|0),d>>>0<S>>>0;)d=d+1|0}while(0);if((M|0)>0){d=0;do f=Xc(f,h)|0,h=ct()|0,d=d+1|0;while((d|0)!=(M|0))}}else f=0,h=0;while(0);return pe=h,we=f,zi(pe|0),nt=$,we|0}function Ho(h){return h=h|0,(h|0)%2|0|0}function gf(h,f,d){h=h|0,f=f|0,d=d|0;var E=0,S=0;return S=nt,nt=nt+16|0,E=S,f>>>0>15?(E=4,nt=S,E|0):(g[h+4>>2]&2146435072|0)==2146435072||(g[h+8+4>>2]&2146435072|0)==2146435072?(E=3,nt=S,E|0):(nh(h,f,E),f=oh(E,f)|0,E=ct()|0,g[d>>2]=f,g[d+4>>2]=E,(f|0)==0&(E|0)==0&&bi(23313,22674,786,22697),E=0,nt=S,E|0)}function Ku(h,f,d){h=h|0,f=f|0,d=d|0;var E=0,S=0,M=0,O=0;if(S=d+4|0,M=Oe(h|0,f|0,52)|0,ct()|0,M=M&15,O=Oe(h|0,f|0,45)|0,ct()|0,E=(M|0)==0,_a(O&127)|0){if(E)return O=1,O|0;E=1}else{if(E)return O=0,O|0;!(g[S>>2]|0)&&!(g[d+8>>2]|0)?E=(g[d+12>>2]|0)!=0&1:E=1}for(d=1;d&1?r0(S):vc(S),O=Oe(h|0,f|0,(15-d|0)*3|0)|0,ct()|0,th(S,O&7),d>>>0<M>>>0;)d=d+1|0;return E|0}function pu(h,f,d){h=h|0,f=f|0,d=d|0;var E=0,S=0,M=0,O=0,F=0,$=0,pe=0,we=0;if(we=nt,nt=nt+16|0,$=we,pe=Oe(h|0,f|0,45)|0,ct()|0,pe=pe&127,pe>>>0>121)return g[d>>2]=0,g[d+4>>2]=0,g[d+8>>2]=0,g[d+12>>2]=0,pe=5,nt=we,pe|0;e:do if(_a(pe)|0&&(M=Oe(h|0,f|0,52)|0,ct()|0,M=M&15,(M|0)!=0)){E=1;t:for(;;){switch(F=Oe(h|0,f|0,(15-E|0)*3|0)|0,ct()|0,F&7){case 5:break t;case 0:break;default:{E=f;break e}}if(E>>>0<M>>>0)E=E+1|0;else{E=f;break e}}for(S=1,E=f;f=(15-S|0)*3|0,O=Ve(7,0,f|0)|0,F=E&~(ct()|0),E=Oe(h|0,E|0,f|0)|0,ct()|0,E=Ve(gc(E&7)|0,0,f|0)|0,h=h&~O|E,E=F|(ct()|0),S>>>0<M>>>0;)S=S+1|0}else E=f;while(0);if(F=7696+(pe*28|0)|0,g[d>>2]=g[F>>2],g[d+4>>2]=g[F+4>>2],g[d+8>>2]=g[F+8>>2],g[d+12>>2]=g[F+12>>2],!(Ku(h,E,d)|0))return pe=0,nt=we,pe|0;if(O=d+4|0,g[$>>2]=g[O>>2],g[$+4>>2]=g[O+4>>2],g[$+8>>2]=g[O+8>>2],M=Oe(h|0,E|0,52)|0,ct()|0,F=M&15,M&1?(vc(O),M=F+1|0):M=F,!(_a(pe)|0))E=0;else{e:do if(!F)E=0;else for(f=1;;){if(S=Oe(h|0,E|0,(15-f|0)*3|0)|0,ct()|0,S=S&7,S|0){E=S;break e}if(f>>>0<F>>>0)f=f+1|0;else{E=0;break}}while(0);E=(E|0)==4&1}if(!(Au(d,M,E,0)|0))(M|0)!=(F|0)&&(g[O>>2]=g[$>>2],g[O+4>>2]=g[$+4>>2],g[O+8>>2]=g[$+8>>2]);else{if(_a(pe)|0)do;while(Au(d,M,0,0)|0);(M|0)!=(F|0)&&Bh(O)}return pe=0,nt=we,pe|0}function Sc(h,f,d){h=h|0,f=f|0,d=d|0;var E=0,S=0,M=0;return M=nt,nt=nt+16|0,E=M,S=pu(h,f,E)|0,S|0?(nt=M,S|0):(S=Oe(h|0,f|0,52)|0,ct()|0,pf(E,S&15,d),S=0,nt=M,S|0)}function Yc(h,f,d){h=h|0,f=f|0,d=d|0;var E=0,S=0,M=0,O=0,F=0;if(O=nt,nt=nt+16|0,M=O,E=pu(h,f,M)|0,E|0)return M=E,nt=O,M|0;E=Oe(h|0,f|0,45)|0,ct()|0,E=(_a(E&127)|0)==0,S=Oe(h|0,f|0,52)|0,ct()|0,S=S&15;e:do if(!E){if(S|0)for(E=1;;){if(F=Ve(7,0,(15-E|0)*3|0)|0,!((F&h|0)==0&((ct()|0)&f|0)==0))break e;if(E>>>0<S>>>0)E=E+1|0;else break}return n0(M,S,0,5,d),F=0,nt=O,F|0}while(0);return Hc(M,S,0,6,d),F=0,nt=O,F|0}function o0(h,f,d){h=h|0,f=f|0,d=d|0;var E=0,S=0,M=0;if(S=Oe(h|0,f|0,45)|0,ct()|0,!(_a(S&127)|0))return S=2,g[d>>2]=S,0;if(S=Oe(h|0,f|0,52)|0,ct()|0,S=S&15,!S)return S=5,g[d>>2]=S,0;for(E=1;;){if(M=Ve(7,0,(15-E|0)*3|0)|0,!((M&h|0)==0&((ct()|0)&f|0)==0)){E=2,h=6;break}if(E>>>0<S>>>0)E=E+1|0;else{E=5,h=6;break}}return(h|0)==6&&(g[d>>2]=E),0}function I0(h,f,d){h=h|0,f=f|0,d=d|0;var E=0,S=0,M=0,O=0,F=0,$=0,pe=0,we=0,$e=0;$e=nt,nt=nt+128|0,pe=$e+112|0,M=$e+96|0,we=$e,S=Oe(h|0,f|0,52)|0,ct()|0,F=S&15,g[pe>>2]=F,O=Oe(h|0,f|0,45)|0,ct()|0,O=O&127;e:do if(_a(O)|0){if(F|0)for(E=1;;){if($=Ve(7,0,(15-E|0)*3|0)|0,!(($&h|0)==0&((ct()|0)&f|0)==0)){S=0;break e}if(E>>>0<F>>>0)E=E+1|0;else break}if(S&1)S=1;else return $=Ve(F+1|0,0,52)|0,we=ct()|0|f&-15728641,pe=Ve(7,0,(14-F|0)*3|0)|0,we=I0(($|h)&~pe,we&~(ct()|0),d)|0,nt=$e,we|0}else S=0;while(0);if(E=pu(h,f,M)|0,!E){S?(Vo(M,pe,we),$=5):(Qu(M,pe,we),$=6);e:do if(_a(O)|0)if(!F)h=5;else for(E=1;;){if(O=Ve(7,0,(15-E|0)*3|0)|0,!((O&h|0)==0&((ct()|0)&f|0)==0)){h=2;break e}if(E>>>0<F>>>0)E=E+1|0;else{h=5;break}}else h=2;while(0);Bt(d|0,-1,h<<2|0)|0;e:do if(S)for(M=0;;){if(O=we+(M<<4)|0,mc(O,g[pe>>2]|0)|0,O=g[O>>2]|0,F=g[d>>2]|0,(F|0)==-1|(F|0)==(O|0))E=d;else{S=0;do{if(S=S+1|0,S>>>0>=h>>>0){E=1;break e}E=d+(S<<2)|0,F=g[E>>2]|0}while(!((F|0)==-1|(F|0)==(O|0)))}if(g[E>>2]=O,M=M+1|0,M>>>0>=$>>>0){E=0;break}}else for(M=0;;){if(O=we+(M<<4)|0,Au(O,g[pe>>2]|0,0,1)|0,O=g[O>>2]|0,F=g[d>>2]|0,(F|0)==-1|(F|0)==(O|0))E=d;else{S=0;do{if(S=S+1|0,S>>>0>=h>>>0){E=1;break e}E=d+(S<<2)|0,F=g[E>>2]|0}while(!((F|0)==-1|(F|0)==(O|0)))}if(g[E>>2]=O,M=M+1|0,M>>>0>=$>>>0){E=0;break}}while(0)}return we=E,nt=$e,we|0}function Fu(){return 12}function Bl(h,f){h=h|0,f=f|0;var d=0,E=0,S=0,M=0,O=0,F=0,$=0;if(h>>>0>15)return F=4,F|0;if(Ve(h|0,0,52)|0,F=ct()|0|134225919,!h){d=0,E=0;do _a(E)|0&&(Ve(E|0,0,45)|0,O=F|(ct()|0),h=f+(d<<3)|0,g[h>>2]=-1,g[h+4>>2]=O,d=d+1|0),E=E+1|0;while((E|0)!=122);return d=0,d|0}d=0,O=0;do{if(_a(O)|0){for(Ve(O|0,0,45)|0,E=1,S=-1,M=F|(ct()|0);$=Ve(7,0,(15-E|0)*3|0)|0,S=S&~$,M=M&~(ct()|0),(E|0)!=(h|0);)E=E+1|0;$=f+(d<<3)|0,g[$>>2]=S,g[$+4>>2]=M,d=d+1|0}O=O+1|0}while((O|0)!=122);return d=0,d|0}function Po(h,f,d,E){h=h|0,f=f|0,d=d|0,E=E|0;var S=0,M=0,O=0,F=0,$=0,pe=0,we=0,$e=0,At=0,Rt=0,_t=0,zt=0,xr=0,mr=0,fr=0;if(fr=nt,nt=nt+16|0,xr=fr,mr=Oe(h|0,f|0,52)|0,ct()|0,mr=mr&15,d>>>0>15)return mr=4,nt=fr,mr|0;if((mr|0)<(d|0))return mr=12,nt=fr,mr|0;if((mr|0)!=(d|0))if(M=Ve(d|0,0,52)|0,M=M|h,F=ct()|0|f&-15728641,(mr|0)>(d|0)){$=d;do zt=Ve(7,0,(14-$|0)*3|0)|0,$=$+1|0,M=zt|M,F=ct()|0|F;while(($|0)<(mr|0));zt=M}else zt=M;else zt=h,F=f;_t=Oe(zt|0,F|0,45)|0,ct()|0;e:do if(_a(_t&127)|0){if($=Oe(zt|0,F|0,52)|0,ct()|0,$=$&15,$|0)for(M=1;;){if(_t=Ve(7,0,(15-M|0)*3|0)|0,!((_t&zt|0)==0&((ct()|0)&F|0)==0)){pe=33;break e}if(M>>>0<$>>>0)M=M+1|0;else break}if(_t=E,g[_t>>2]=0,g[_t+4>>2]=0,(mr|0)>(d|0)){for(_t=f&-15728641,Rt=mr;;){if(At=Rt,Rt=Rt+-1|0,Rt>>>0>15|(mr|0)<(Rt|0)){pe=19;break}if((mr|0)!=(Rt|0))if(M=Ve(Rt|0,0,52)|0,M=M|h,$=ct()|0|_t,(mr|0)<(At|0))$e=M;else{pe=Rt;do $e=Ve(7,0,(14-pe|0)*3|0)|0,pe=pe+1|0,M=$e|M,$=ct()|0|$;while((pe|0)<(mr|0));$e=M}else $e=h,$=f;if(we=Oe($e|0,$|0,45)|0,ct()|0,!(_a(we&127)|0))M=0;else{we=Oe($e|0,$|0,52)|0,ct()|0,we=we&15;t:do if(!we)M=0;else for(pe=1;;){if(M=Oe($e|0,$|0,(15-pe|0)*3|0)|0,ct()|0,M=M&7,M|0)break t;if(pe>>>0<we>>>0)pe=pe+1|0;else{M=0;break}}while(0);M=(M|0)==0&1}if($=Oe(h|0,f|0,(15-At|0)*3|0)|0,ct()|0,$=$&7,($|0)==7){S=5,pe=42;break}if(M=(M|0)!=0,($|0)==1&M){S=5,pe=42;break}if($e=$+((($|0)!=0&M)<<31>>31)|0,$e|0&&(pe=mr-At|0,pe=jt(7,0,pe,((pe|0)<0)<<31>>31)|0,we=ct()|0,M?(M=Xt(pe|0,we|0,5,0)|0,M=vn(M|0,ct()|0,-5,-1)|0,M=ht(M|0,ct()|0,6,0)|0,M=vn(M|0,ct()|0,1,0)|0,$=ct()|0):(M=pe,$=we),At=$e+-1|0,At=Xt(pe|0,we|0,At|0,((At|0)<0)<<31>>31|0)|0,At=vn(M|0,$|0,At|0,ct()|0)|0,$e=ct()|0,we=E,we=vn(At|0,$e|0,g[we>>2]|0,g[we+4>>2]|0)|0,$e=ct()|0,At=E,g[At>>2]=we,g[At+4>>2]=$e),(Rt|0)<=(d|0)){pe=37;break}}if((pe|0)==19)bi(23313,22674,1099,22710);else if((pe|0)==37){O=E,S=g[O+4>>2]|0,O=g[O>>2]|0;break}else if((pe|0)==42)return nt=fr,S|0}else S=0,O=0}else pe=33;while(0);e:do if((pe|0)==33)if(_t=E,g[_t>>2]=0,g[_t+4>>2]=0,(mr|0)>(d|0)){for(M=mr;;){if(S=Oe(h|0,f|0,(15-M|0)*3|0)|0,ct()|0,S=S&7,(S|0)==7){S=5;break}if(O=mr-M|0,O=jt(7,0,O,((O|0)<0)<<31>>31)|0,S=Xt(O|0,ct()|0,S|0,0)|0,O=ct()|0,_t=E,O=vn(g[_t>>2]|0,g[_t+4>>2]|0,S|0,O|0)|0,S=ct()|0,_t=E,g[_t>>2]=O,g[_t+4>>2]=S,M=M+-1|0,(M|0)<=(d|0))break e}return nt=fr,S|0}else S=0,O=0;while(0);return vf(zt,F,mr,xr)|0&&bi(23313,22674,1063,22725),mr=xr,xr=g[mr+4>>2]|0,((S|0)>-1|(S|0)==-1&O>>>0>4294967295)&((xr|0)>(S|0)|((xr|0)==(S|0)?(g[mr>>2]|0)>>>0>O>>>0:0))?(mr=0,nt=fr,mr|0):(bi(23313,22674,1139,22710),0)}function Js(h,f,d,E,S,M){h=h|0,f=f|0,d=d|0,E=E|0,S=S|0,M=M|0;var O=0,F=0,$=0,pe=0,we=0,$e=0,At=0,Rt=0,_t=0,zt=0;if($e=nt,nt=nt+16|0,O=$e,S>>>0>15)return M=4,nt=$e,M|0;if(F=Oe(d|0,E|0,52)|0,ct()|0,F=F&15,(F|0)>(S|0))return M=12,nt=$e,M|0;if(vf(d,E,S,O)|0&&bi(23313,22674,1063,22725),we=O,pe=g[we+4>>2]|0,!(((f|0)>-1|(f|0)==-1&h>>>0>4294967295)&((pe|0)>(f|0)|((pe|0)==(f|0)?(g[we>>2]|0)>>>0>h>>>0:0))))return M=2,nt=$e,M|0;we=S-F|0,S=Ve(S|0,0,52)|0,$=ct()|0|E&-15728641,pe=M,g[pe>>2]=S|d,g[pe+4>>2]=$,pe=Oe(d|0,E|0,45)|0,ct()|0;e:do if(_a(pe&127)|0){if(F|0)for(O=1;;){if(pe=Ve(7,0,(15-O|0)*3|0)|0,!((pe&d|0)==0&((ct()|0)&E|0)==0))break e;if(O>>>0<F>>>0)O=O+1|0;else break}if((we|0)<1)return M=0,nt=$e,M|0;for(pe=F^15,E=-1,$=1,O=1;;){F=we-$|0,F=jt(7,0,F,((F|0)<0)<<31>>31)|0,d=ct()|0;do if(O)if(O=Xt(F|0,d|0,5,0)|0,O=vn(O|0,ct()|0,-5,-1)|0,O=ht(O|0,ct()|0,6,0)|0,S=ct()|0,(f|0)>(S|0)|(f|0)==(S|0)&h>>>0>O>>>0){f=vn(h|0,f|0,-1,-1)|0,f=si(f|0,ct()|0,O|0,S|0)|0,O=ct()|0,At=M,_t=g[At>>2]|0,At=g[At+4>>2]|0,zt=(pe+E|0)*3|0,Rt=Ve(7,0,zt|0)|0,At=At&~(ct()|0),E=ht(f|0,O|0,F|0,d|0)|0,h=ct()|0,S=vn(E|0,h|0,2,0)|0,zt=Ve(S|0,ct()|0,zt|0)|0,At=ct()|0|At,S=M,g[S>>2]=zt|_t&~Rt,g[S+4>>2]=At,h=Xt(E|0,h|0,F|0,d|0)|0,h=si(f|0,O|0,h|0,ct()|0)|0,O=0,f=ct()|0;break}else{zt=M,Rt=g[zt>>2]|0,zt=g[zt+4>>2]|0,_t=Ve(7,0,(pe+E|0)*3|0)|0,zt=zt&~(ct()|0),O=M,g[O>>2]=Rt&~_t,g[O+4>>2]=zt,O=1;break}else Rt=M,S=g[Rt>>2]|0,Rt=g[Rt+4>>2]|0,E=(pe+E|0)*3|0,At=Ve(7,0,E|0)|0,Rt=Rt&~(ct()|0),zt=ht(h|0,f|0,F|0,d|0)|0,O=ct()|0,E=Ve(zt|0,O|0,E|0)|0,Rt=ct()|0|Rt,_t=M,g[_t>>2]=E|S&~At,g[_t+4>>2]=Rt,O=Xt(zt|0,O|0,F|0,d|0)|0,h=si(h|0,f|0,O|0,ct()|0)|0,O=0,f=ct()|0;while(0);if((we|0)>($|0))E=~$,$=$+1|0;else{f=0;break}}return nt=$e,f|0}while(0);if((we|0)<1)return zt=0,nt=$e,zt|0;for(S=F^15,O=1;;)if(_t=we-O|0,_t=jt(7,0,_t,((_t|0)<0)<<31>>31)|0,zt=ct()|0,$=M,d=g[$>>2]|0,$=g[$+4>>2]|0,F=(S-O|0)*3|0,E=Ve(7,0,F|0)|0,$=$&~(ct()|0),At=ht(h|0,f|0,_t|0,zt|0)|0,Rt=ct()|0,F=Ve(At|0,Rt|0,F|0)|0,$=ct()|0|$,pe=M,g[pe>>2]=F|d&~E,g[pe+4>>2]=$,zt=Xt(At|0,Rt|0,_t|0,zt|0)|0,h=si(h|0,f|0,zt|0,ct()|0)|0,f=ct()|0,(we|0)<=(O|0)){f=0;break}else O=O+1|0;return nt=$e,f|0}function s0(h,f,d,E){h=h|0,f=f|0,d=d|0,E=E|0;var S=0,M=0;S=Oe(f|0,d|0,52)|0,ct()|0,S=S&15,(f|0)==0&(d|0)==0|((E|0)>15|(S|0)>(E|0))?(E=-1,S=-1,f=0,d=0):(M=Uf(f,d,S+1|0,E)|0,d=(ct()|0)&-15728641,f=Ve(E|0,0,52)|0,f=M|f,d=d|(ct()|0),M=(wa(f,d)|0)==0,E=M?-1:E),M=h,g[M>>2]=f,g[M+4>>2]=d,g[h+8>>2]=S,g[h+12>>2]=E}function P0(h){h=h|0;var f=0,d=0,E=0,S=0,M=0,O=0,F=0,$=0,pe=0;if(d=h,f=g[d>>2]|0,d=g[d+4>>2]|0,!((f|0)==0&(d|0)==0)&&(E=Oe(f|0,d|0,52)|0,ct()|0,E=E&15,F=Ve(1,0,(E^15)*3|0)|0,f=vn(F|0,ct()|0,f|0,d|0)|0,d=ct()|0,F=h,g[F>>2]=f,g[F+4>>2]=d,F=h+8|0,O=g[F>>2]|0,!((E|0)<(O|0)))){for($=h+12|0,M=E;;){if((M|0)==(O|0)){E=5;break}if(pe=(M|0)==(g[$>>2]|0),S=(15-M|0)*3|0,E=Oe(f|0,d|0,S|0)|0,ct()|0,E=E&7,pe&((E|0)==1&!0)){E=7;break}if(!((E|0)==7&!0)){E=10;break}if(pe=Ve(1,0,S|0)|0,f=vn(f|0,d|0,pe|0,ct()|0)|0,d=ct()|0,pe=h,g[pe>>2]=f,g[pe+4>>2]=d,(M|0)>(O|0))M=M+-1|0;else{E=10;break}}if((E|0)==5){pe=h,g[pe>>2]=0,g[pe+4>>2]=0,g[F>>2]=-1,g[$>>2]=-1;return}else if((E|0)==7){O=Ve(1,0,S|0)|0,O=vn(f|0,d|0,O|0,ct()|0)|0,F=ct()|0,pe=h,g[pe>>2]=O,g[pe+4>>2]=F,g[$>>2]=M+-1;return}else if((E|0)==10)return}}function eu(h){h=+h;var f=0;return f=h<0?h+6.283185307179586:h,+(h>=6.283185307179586?f+-6.283185307179586:f)}function mf(h,f){return h=h|0,f=f|0,+xa(+(+et[h>>3]-+et[f>>3]))<17453292519943298e-27?(f=+xa(+(+et[h+8>>3]-+et[f+8>>3]))<17453292519943298e-27,f|0):(f=0,f|0)}function _f(h,f){h=h|0,f=f|0;var d=0,E=0,S=0,M=0;return S=+et[f>>3],E=+et[h>>3],M=+Yr(+((S-E)*.5)),d=+Yr(+((+et[f+8>>3]-+et[h+8>>3])*.5)),d=M*M+d*(+Ma(+S)*+Ma(+E)*d),+(+Zn(+ +vo(+d),+ +vo(+(1-d)))*2)}function Al(h,f){h=h|0,f=f|0;var d=0,E=0,S=0,M=0;return S=+et[f>>3],E=+et[h>>3],M=+Yr(+((S-E)*.5)),d=+Yr(+((+et[f+8>>3]-+et[h+8>>3])*.5)),d=M*M+d*(+Ma(+S)*+Ma(+E)*d),+(+Zn(+ +vo(+d),+ +vo(+(1-d)))*2*6371.007180918475)}function u0(h,f){h=h|0,f=f|0;var d=0,E=0,S=0,M=0;return S=+et[f>>3],E=+et[h>>3],M=+Yr(+((S-E)*.5)),d=+Yr(+((+et[f+8>>3]-+et[h+8>>3])*.5)),d=M*M+d*(+Ma(+S)*+Ma(+E)*d),+(+Zn(+ +vo(+d),+ +vo(+(1-d)))*2*6371.007180918475*1e3)}function Wh(h,f){h=h|0,f=f|0;var d=0,E=0,S=0,M=0,O=0;return M=+et[f>>3],E=+Ma(+M),S=+et[f+8>>3]-+et[h+8>>3],O=E*+Yr(+S),d=+et[h>>3],+ +Zn(+O,+(+Yr(+M)*+Ma(+d)-+Ma(+S)*(E*+Yr(+d))))}function yf(h,f,d,E){h=h|0,f=+f,d=+d,E=E|0;var S=0,M=0,O=0,F=0;if(d<1e-16){g[E>>2]=g[h>>2],g[E+4>>2]=g[h+4>>2],g[E+8>>2]=g[h+8>>2],g[E+12>>2]=g[h+12>>2];return}M=f<0?f+6.283185307179586:f,M=f>=6.283185307179586?M+-6.283185307179586:M;do if(M<1e-16)f=+et[h>>3]+d,et[E>>3]=f,S=E;else{if(S=+xa(+(M+-3.141592653589793))<1e-16,f=+et[h>>3],S){f=f-d,et[E>>3]=f,S=E;break}if(O=+Ma(+d),d=+Yr(+d),f=O*+Yr(+f)+ +Ma(+M)*(d*+Ma(+f)),f=f>1?1:f,f=+Hn(+(f<-1?-1:f)),et[E>>3]=f,+xa(+(f+-1.5707963267948966))<1e-16){et[E>>3]=1.5707963267948966,et[E+8>>3]=0;return}if(+xa(+(f+1.5707963267948966))<1e-16){et[E>>3]=-1.5707963267948966,et[E+8>>3]=0;return}if(F=+Ma(+f),M=d*+Yr(+M)/F,d=+et[h>>3],f=(O-+Yr(+f)*+Yr(+d))/+Ma(+d)/F,O=M>1?1:M,f=f>1?1:f,f=+et[h+8>>3]+ +Zn(+(O<-1?-1:O),+(f<-1?-1:f)),f>3.141592653589793)do f=f+-6.283185307179586;while(f>3.141592653589793);if(f<-3.141592653589793)do f=f+6.283185307179586;while(f<-3.141592653589793);et[E+8>>3]=f;return}while(0);if(+xa(+(f+-1.5707963267948966))<1e-16){et[S>>3]=1.5707963267948966,et[E+8>>3]=0;return}if(+xa(+(f+1.5707963267948966))<1e-16){et[S>>3]=-1.5707963267948966,et[E+8>>3]=0;return}if(f=+et[h+8>>3],f>3.141592653589793)do f=f+-6.283185307179586;while(f>3.141592653589793);if(f<-3.141592653589793)do f=f+6.283185307179586;while(f<-3.141592653589793);et[E+8>>3]=f}function O0(h,f){return h=h|0,f=f|0,h>>>0>15?(f=4,f|0):(et[f>>3]=+et[20528+(h<<3)>>3],f=0,f|0)}function N0(h,f){return h=h|0,f=f|0,h>>>0>15?(f=4,f|0):(et[f>>3]=+et[20656+(h<<3)>>3],f=0,f|0)}function sh(h,f){return h=h|0,f=f|0,h>>>0>15?(f=4,f|0):(et[f>>3]=+et[20784+(h<<3)>>3],f=0,f|0)}function Ef(h,f){return h=h|0,f=f|0,h>>>0>15?(f=4,f|0):(et[f>>3]=+et[20912+(h<<3)>>3],f=0,f|0)}function Zf(h,f){h=h|0,f=f|0;var d=0;return h>>>0>15?(f=4,f|0):(d=jt(7,0,h,((h|0)<0)<<31>>31)|0,d=Xt(d|0,ct()|0,120,0)|0,h=ct()|0,g[f>>2]=d|2,g[f+4>>2]=h,f=0,f|0)}function so(h,f,d){h=h|0,f=f|0,d=d|0;var E=0,S=0,M=0,O=0,F=0,$=0,pe=0,we=0,$e=0,At=0;return At=+et[f>>3],we=+et[h>>3],$=+Yr(+((At-we)*.5)),M=+et[f+8>>3],pe=+et[h+8>>3],O=+Yr(+((M-pe)*.5)),F=+Ma(+we),$e=+Ma(+At),O=$*$+O*($e*F*O),O=+Zn(+ +vo(+O),+ +vo(+(1-O)))*2,$=+et[d>>3],At=+Yr(+(($-At)*.5)),E=+et[d+8>>3],M=+Yr(+((E-M)*.5)),S=+Ma(+$),M=At*At+M*($e*S*M),M=+Zn(+ +vo(+M),+ +vo(+(1-M)))*2,$=+Yr(+((we-$)*.5)),E=+Yr(+((pe-E)*.5)),E=$*$+E*(F*S*E),E=+Zn(+ +vo(+E),+ +vo(+(1-E)))*2,S=(O+M+E)*.5,+(+oi(+ +vo(+(+_n(+(S*.5))*+_n(+((S-O)*.5))*+_n(+((S-M)*.5))*+_n(+((S-E)*.5)))))*4)}function zf(h,f,d){h=h|0,f=f|0,d=d|0;var E=0,S=0,M=0,O=0,F=0;if(F=nt,nt=nt+192|0,M=F+168|0,O=F,S=Sc(h,f,M)|0,S|0)return d=S,nt=F,d|0;if(Yc(h,f,O)|0&&bi(23313,22742,386,22751),f=g[O>>2]|0,(f|0)>0){if(E=+so(O+8|0,O+8+(((f|0)!=1&1)<<4)|0,M)+0,(f|0)!=1){h=1;do S=h,h=h+1|0,E=E+ +so(O+8+(S<<4)|0,O+8+(((h|0)%(f|0)|0)<<4)|0,M);while((h|0)<(f|0))}}else E=0;return et[d>>3]=E,d=0,nt=F,d|0}function xc(h,f,d){return h=h|0,f=f|0,d=d|0,h=zf(h,f,d)|0,h|0||(et[d>>3]=+et[d>>3]*6371.007180918475*6371.007180918475),h|0}function Su(h,f,d){return h=h|0,f=f|0,d=d|0,h=zf(h,f,d)|0,h|0||(et[d>>3]=+et[d>>3]*6371.007180918475*6371.007180918475*1e3*1e3),h|0}function Te(h,f,d){h=h|0,f=f|0,d=d|0;var E=0,S=0,M=0,O=0,F=0,$=0,pe=0,we=0;if(F=nt,nt=nt+176|0,O=F,h=Vc(h,f,O)|0,h|0)return O=h,nt=F,O|0;if(et[d>>3]=0,h=g[O>>2]|0,(h|0)<=1)return O=0,nt=F,O|0;f=h+-1|0,h=0,E=+et[O+8>>3],S=+et[O+16>>3],M=0;do h=h+1|0,pe=E,E=+et[O+8+(h<<4)>>3],we=+Yr(+((E-pe)*.5)),$=S,S=+et[O+8+(h<<4)+8>>3],$=+Yr(+((S-$)*.5)),$=we*we+$*(+Ma(+E)*+Ma(+pe)*$),M=M+ +Zn(+ +vo(+$),+ +vo(+(1-$)))*2;while((h|0)<(f|0));return et[d>>3]=M,O=0,nt=F,O|0}function Je(h,f,d){h=h|0,f=f|0,d=d|0;var E=0,S=0,M=0,O=0,F=0,$=0,pe=0,we=0;if(F=nt,nt=nt+176|0,O=F,h=Vc(h,f,O)|0,h|0)return O=h,M=+et[d>>3],M=M*6371.007180918475,et[d>>3]=M,nt=F,O|0;if(et[d>>3]=0,h=g[O>>2]|0,(h|0)<=1)return O=0,M=0,M=M*6371.007180918475,et[d>>3]=M,nt=F,O|0;f=h+-1|0,h=0,E=+et[O+8>>3],S=+et[O+16>>3],M=0;do h=h+1|0,pe=E,E=+et[O+8+(h<<4)>>3],we=+Yr(+((E-pe)*.5)),$=S,S=+et[O+8+(h<<4)+8>>3],$=+Yr(+((S-$)*.5)),$=we*we+$*(+Ma(+pe)*+Ma(+E)*$),M=M+ +Zn(+ +vo(+$),+ +vo(+(1-$)))*2;while((h|0)!=(f|0));return et[d>>3]=M,O=0,we=M,we=we*6371.007180918475,et[d>>3]=we,nt=F,O|0}function Et(h,f,d){h=h|0,f=f|0,d=d|0;var E=0,S=0,M=0,O=0,F=0,$=0,pe=0,we=0;if(F=nt,nt=nt+176|0,O=F,h=Vc(h,f,O)|0,h|0)return O=h,M=+et[d>>3],M=M*6371.007180918475,M=M*1e3,et[d>>3]=M,nt=F,O|0;if(et[d>>3]=0,h=g[O>>2]|0,(h|0)<=1)return O=0,M=0,M=M*6371.007180918475,M=M*1e3,et[d>>3]=M,nt=F,O|0;f=h+-1|0,h=0,E=+et[O+8>>3],S=+et[O+16>>3],M=0;do h=h+1|0,pe=E,E=+et[O+8+(h<<4)>>3],we=+Yr(+((E-pe)*.5)),$=S,S=+et[O+8+(h<<4)+8>>3],$=+Yr(+((S-$)*.5)),$=we*we+$*(+Ma(+pe)*+Ma(+E)*$),M=M+ +Zn(+ +vo(+$),+ +vo(+(1-$)))*2;while((h|0)!=(f|0));return et[d>>3]=M,O=0,we=M,we=we*6371.007180918475,we=we*1e3,et[d>>3]=we,nt=F,O|0}function sr(h){h=h|0;var f=0,d=0,E=0;return f=Mn(1,12)|0,f||bi(22832,22787,49,22845),d=h+4|0,E=g[d>>2]|0,E|0?(E=E+8|0,g[E>>2]=f,g[d>>2]=f,f|0):(g[h>>2]|0&&bi(22862,22787,61,22885),E=h,g[E>>2]=f,g[d>>2]=f,f|0)}function Er(h,f){h=h|0,f=f|0;var d=0,E=0;return E=to(24)|0,E||bi(22899,22787,78,22913),g[E>>2]=g[f>>2],g[E+4>>2]=g[f+4>>2],g[E+8>>2]=g[f+8>>2],g[E+12>>2]=g[f+12>>2],g[E+16>>2]=0,f=h+4|0,d=g[f>>2]|0,d|0?(g[d+16>>2]=E,g[f>>2]=E,E|0):(g[h>>2]|0&&bi(22928,22787,82,22913),g[h>>2]=E,g[f>>2]=E,E|0)}function lr(h){h=h|0;var f=0,d=0,E=0,S=0;if(h)for(E=1;;){if(f=g[h>>2]|0,f|0)do{if(d=g[f>>2]|0,d|0)do S=d,d=g[d+16>>2]|0,pn(S);while(d|0);S=f,f=g[f+8>>2]|0,pn(S)}while(f|0);if(f=h,h=g[h+8>>2]|0,E||pn(f),h)E=0;else break}}function gr(h){h=h|0;var f=0,d=0,E=0,S=0,M=0,O=0,F=0,$=0,pe=0,we=0,$e=0,At=0,Rt=0,_t=0,zt=0,xr=0,mr=0,fr=0,ur=0,er=0,Sn=0,wn=0,cn=0,En=0,Va=0,Ta=0,Ca=0,Li=0,Ei=0,_i=0,ro=0,Yi=0;if(S=h+8|0,g[S>>2]|0)return Yi=1,Yi|0;if(E=g[h>>2]|0,!E)return Yi=0,Yi|0;f=E,d=0;do d=d+1|0,f=g[f+8>>2]|0;while(f|0);if(d>>>0<2)return Yi=0,Yi|0;_i=to(d<<2)|0,_i||bi(22948,22787,317,22967),Ei=to(d<<5)|0,Ei||bi(22989,22787,321,22967),g[h>>2]=0,wn=h+4|0,g[wn>>2]=0,g[S>>2]=0,d=0,Li=0,Sn=0,$e=0;e:for(;;){if(we=g[E>>2]|0,we){M=0,O=we;do{if($=+et[O+8>>3],f=O,O=g[O+16>>2]|0,pe=(O|0)==0,S=pe?we:O,F=+et[S+8>>3],+xa(+($-F))>3.141592653589793){Yi=14;break}M=M+(F-$)*(+et[f>>3]+ +et[S>>3])}while(!pe);if((Yi|0)==14){Yi=0,M=0,f=we;do er=+et[f+8>>3],Ca=f+16|0,Ta=g[Ca>>2]|0,Ta=Ta|0?Ta:we,ur=+et[Ta+8>>3],M=M+(+et[f>>3]+ +et[Ta>>3])*((ur<0?ur+6.283185307179586:ur)-(er<0?er+6.283185307179586:er)),f=g[(f|0?Ca:E)>>2]|0;while(f|0)}M>0?(g[_i+(Li<<2)>>2]=E,Li=Li+1|0,S=Sn,f=$e):Yi=19}else Yi=19;if((Yi|0)==19){Yi=0;do if(d){if(f=d+8|0,g[f>>2]|0){Yi=21;break e}if(d=Mn(1,12)|0,!d){Yi=23;break e}g[f>>2]=d,S=d+4|0,O=d,f=$e}else if($e){S=wn,O=$e+8|0,f=E,d=h;break}else if(g[h>>2]|0){Yi=27;break e}else{S=wn,O=h,f=E,d=h;break}while(0);if(g[O>>2]=E,g[S>>2]=E,O=Ei+(Sn<<5)|0,pe=g[E>>2]|0,pe){for(we=Ei+(Sn<<5)+8|0,et[we>>3]=17976931348623157e292,$e=Ei+(Sn<<5)+24|0,et[$e>>3]=17976931348623157e292,et[O>>3]=-17976931348623157e292,At=Ei+(Sn<<5)+16|0,et[At>>3]=-17976931348623157e292,mr=17976931348623157e292,fr=-17976931348623157e292,S=0,Rt=pe,$=17976931348623157e292,zt=17976931348623157e292,xr=-17976931348623157e292,F=-17976931348623157e292;M=+et[Rt>>3],er=+et[Rt+8>>3],Rt=g[Rt+16>>2]|0,_t=(Rt|0)==0,ur=+et[(_t?pe:Rt)+8>>3],M<$&&(et[we>>3]=M,$=M),er<zt&&(et[$e>>3]=er,zt=er),M>xr?et[O>>3]=M:M=xr,er>F&&(et[At>>3]=er,F=er),mr=er>0&er<mr?er:mr,fr=er<0&er>fr?er:fr,S=S|+xa(+(er-ur))>3.141592653589793,!_t;)xr=M;S&&(et[At>>3]=fr,et[$e>>3]=mr)}else g[O>>2]=0,g[O+4>>2]=0,g[O+8>>2]=0,g[O+12>>2]=0,g[O+16>>2]=0,g[O+20>>2]=0,g[O+24>>2]=0,g[O+28>>2]=0;S=Sn+1|0}if(Ca=E+8|0,E=g[Ca>>2]|0,g[Ca>>2]=0,E)Sn=S,$e=f;else{Yi=45;break}}if((Yi|0)==21)bi(22765,22787,35,22799);else if((Yi|0)==23)bi(22819,22787,37,22799);else if((Yi|0)==27)bi(22862,22787,61,22885);else if((Yi|0)==45){e:do if((Li|0)>0){for(Ca=(S|0)==0,Va=S<<2,Ta=(h|0)==0,En=0,f=0;;){if(cn=g[_i+(En<<2)>>2]|0,Ca)Yi=73;else{if(Sn=to(Va)|0,!Sn){Yi=50;break}if(wn=to(Va)|0,!wn){Yi=52;break}t:do if(Ta)d=0;else{for(S=0,d=0,O=h;E=Ei+(S<<5)|0,kr(g[O>>2]|0,E,g[cn>>2]|0)|0?(g[Sn+(d<<2)>>2]=O,g[wn+(d<<2)>>2]=E,_t=d+1|0):_t=d,O=g[O+8>>2]|0,O;)S=S+1|0,d=_t;if((_t|0)>0)if(E=g[Sn>>2]|0,(_t|0)==1)d=E;else for(At=0,Rt=-1,d=E,$e=E;;){for(pe=g[$e>>2]|0,E=0,O=0;S=g[g[Sn+(O<<2)>>2]>>2]|0,(S|0)==(pe|0)?we=E:we=E+((kr(S,g[wn+(O<<2)>>2]|0,g[pe>>2]|0)|0)&1)|0,O=O+1|0,(O|0)!=(_t|0);)E=we;if(S=(we|0)>(Rt|0),d=S?$e:d,E=At+1|0,(E|0)==(_t|0))break t;At=E,Rt=S?we:Rt,$e=g[Sn+(E<<2)>>2]|0}else d=0}while(0);if(pn(Sn),pn(wn),d){if(S=d+4|0,E=g[S>>2]|0,E)d=E+8|0;else if(g[d>>2]|0){Yi=70;break}g[d>>2]=cn,g[S>>2]=cn}else Yi=73}if((Yi|0)==73){if(Yi=0,f=g[cn>>2]|0,f|0)do wn=f,f=g[f+16>>2]|0,pn(wn);while(f|0);pn(cn),f=1}if(En=En+1|0,(En|0)>=(Li|0)){ro=f;break e}}(Yi|0)==50?bi(23004,22787,249,23023):(Yi|0)==52?bi(23042,22787,252,23023):(Yi|0)==70&&bi(22862,22787,61,22885)}else ro=0;while(0);return pn(_i),pn(Ei),Yi=ro,Yi|0}return 0}function kr(h,f,d){h=h|0,f=f|0,d=d|0;var E=0,S=0,M=0,O=0,F=0,$=0,pe=0,we=0;if(!(zc(f,d)|0)||(f=fs(f)|0,E=+et[d>>3],S=+et[d+8>>3],S=f&S<0?S+6.283185307179586:S,h=g[h>>2]|0,!h))return h=0,h|0;if(f){f=0,pe=S,d=h;e:for(;;){for(;O=+et[d>>3],S=+et[d+8>>3],d=d+16|0,we=g[d>>2]|0,we=we|0?we:h,M=+et[we>>3],F=+et[we+8>>3],O>M?($=O,O=F):($=M,M=O,O=S,S=F),E=E==M|E==$?E+2220446049250313e-31:E,!!(E<M|E>$);)if(d=g[d>>2]|0,!d){d=22;break e}if(F=O<0?O+6.283185307179586:O,O=S<0?S+6.283185307179586:S,pe=F==pe|O==pe?pe+-2220446049250313e-31:pe,$=F+(O-F)*((E-M)/($-M)),($<0?$+6.283185307179586:$)>pe&&(f=f^1),d=g[d>>2]|0,!d){d=22;break}}if((d|0)==22)return f|0}else{f=0,pe=S,d=h;e:for(;;){for(;O=+et[d>>3],S=+et[d+8>>3],d=d+16|0,we=g[d>>2]|0,we=we|0?we:h,M=+et[we>>3],F=+et[we+8>>3],O>M?($=O,O=F):($=M,M=O,O=S,S=F),E=E==M|E==$?E+2220446049250313e-31:E,!!(E<M|E>$);)if(d=g[d>>2]|0,!d){d=22;break e}if(pe=O==pe|S==pe?pe+-2220446049250313e-31:pe,O+(S-O)*((E-M)/($-M))>pe&&(f=f^1),d=g[d>>2]|0,!d){d=22;break}}if((d|0)==22)return f|0}return 0}function Pr(h,f,d,E,S){h=h|0,f=f|0,d=d|0,E=E|0,S=S|0;var M=0,O=0,F=0,$=0,pe=0,we=0,$e=0,At=0,Rt=0,_t=0,zt=0,xr=0,mr=0,fr=0;if(fr=nt,nt=nt+32|0,mr=fr+16|0,xr=fr,M=Oe(h|0,f|0,52)|0,ct()|0,M=M&15,Rt=Oe(d|0,E|0,52)|0,ct()|0,(M|0)!=(Rt&15|0))return mr=12,nt=fr,mr|0;if(pe=Oe(h|0,f|0,45)|0,ct()|0,pe=pe&127,we=Oe(d|0,E|0,45)|0,ct()|0,we=we&127,pe>>>0>121|we>>>0>121)return mr=5,nt=fr,mr|0;if(Rt=(pe|0)!=(we|0),Rt){if(F=ji(pe,we)|0,(F|0)==7)return mr=1,nt=fr,mr|0;$=ji(we,pe)|0,($|0)==7?bi(23066,23090,161,23100):(_t=F,O=$)}else _t=0,O=0;$e=_a(pe)|0,At=_a(we)|0,g[mr>>2]=0,g[mr+4>>2]=0,g[mr+8>>2]=0,g[mr+12>>2]=0;do if(_t){if(we=g[4272+(pe*28|0)+(_t<<2)>>2]|0,F=(we|0)>0,At)if(F){pe=0,$=d,F=E;do $=a0($,F)|0,F=ct()|0,O=gc(O)|0,(O|0)==1&&(O=gc(1)|0),pe=pe+1|0;while((pe|0)!=(we|0));we=O,pe=$,$=F}else we=O,pe=d,$=E;else if(F){pe=0,$=d,F=E;do $=qu($,F)|0,F=ct()|0,O=gc(O)|0,pe=pe+1|0;while((pe|0)!=(we|0));we=O,pe=$,$=F}else we=O,pe=d,$=E;if(Ku(pe,$,mr)|0,Rt||bi(23115,23090,191,23100),F=($e|0)!=0,O=(At|0)!=0,F&O&&bi(23142,23090,192,23100),F){if(O=Ks(h,f)|0,(O|0)==7){M=5;break}if(br[21872+(O*7|0)+_t>>0]|0){M=1;break}$=g[21040+(O*28|0)+(_t<<2)>>2]|0,pe=$}else if(O){if(O=Ks(pe,$)|0,(O|0)==7){M=5;break}if(br[21872+(O*7|0)+we>>0]|0){M=1;break}pe=0,$=g[21040+(we*28|0)+(O<<2)>>2]|0}else pe=0,$=0;if((pe|$|0)<0)M=5;else{if(($|0)>0){F=mr+4|0,O=0;do Dl(F),O=O+1|0;while((O|0)!=($|0))}if(g[xr>>2]=0,g[xr+4>>2]=0,g[xr+8>>2]=0,th(xr,_t),M|0)for(;Ho(M)|0?r0(xr):vc(xr),(M|0)>1;)M=M+-1|0;if((pe|0)>0){M=0;do Dl(xr),M=M+1|0;while((M|0)!=(pe|0))}zt=mr+4|0,Gs(zt,xr,zt),$o(zt),zt=51}}else if(Ku(d,E,mr)|0,($e|0)!=0&(At|0)!=0)if((we|0)!=(pe|0)&&bi(23173,23090,261,23100),O=Ks(h,f)|0,M=Ks(d,E)|0,(O|0)==7|(M|0)==7)M=5;else if(br[21872+(O*7|0)+M>>0]|0)M=1;else if(O=g[21040+(O*28|0)+(M<<2)>>2]|0,(O|0)>0){F=mr+4|0,M=0;do Dl(F),M=M+1|0;while((M|0)!=(O|0));zt=51}else zt=51;else zt=51;while(0);return(zt|0)==51&&(M=mr+4|0,g[S>>2]=g[M>>2],g[S+4>>2]=g[M+4>>2],g[S+8>>2]=g[M+8>>2],M=0),mr=M,nt=fr,mr|0}function qr(h,f,d,E){h=h|0,f=f|0,d=d|0,E=E|0;var S=0,M=0,O=0,F=0,$=0,pe=0,we=0,$e=0,At=0,Rt=0,_t=0,zt=0,xr=0,mr=0,fr=0,ur=0;if(zt=nt,nt=nt+48|0,pe=zt+36|0,O=zt+24|0,F=zt+12|0,$=zt,S=Oe(h|0,f|0,52)|0,ct()|0,S=S&15,At=Oe(h|0,f|0,45)|0,ct()|0,At=At&127,At>>>0>121)return E=5,nt=zt,E|0;if(we=_a(At)|0,Ve(S|0,0,52)|0,xr=ct()|0|134225919,M=E,g[M>>2]=-1,g[M+4>>2]=xr,!S)return S=t0(d)|0,(S|0)==7||(S=b0(At,S)|0,(S|0)==127)?(xr=1,nt=zt,xr|0):(Rt=Ve(S|0,0,45)|0,_t=ct()|0,At=E,_t=g[At+4>>2]&-1040385|_t,xr=E,g[xr>>2]=g[At>>2]|Rt,g[xr+4>>2]=_t,xr=0,nt=zt,xr|0);for(g[pe>>2]=g[d>>2],g[pe+4>>2]=g[d+4>>2],g[pe+8>>2]=g[d+8>>2],d=S;;){if(M=d,d=d+-1|0,g[O>>2]=g[pe>>2],g[O+4>>2]=g[pe+4>>2],g[O+8>>2]=g[pe+8>>2],Ho(M)|0){if(S=Fh(pe)|0,S|0){d=13;break}g[F>>2]=g[pe>>2],g[F+4>>2]=g[pe+4>>2],g[F+8>>2]=g[pe+8>>2],r0(F)}else{if(S=kf(pe)|0,S|0){d=13;break}g[F>>2]=g[pe>>2],g[F+4>>2]=g[pe+4>>2],g[F+8>>2]=g[pe+8>>2],vc(F)}if(Jf(O,F,$),$o($),S=E,fr=g[S>>2]|0,S=g[S+4>>2]|0,ur=(15-M|0)*3|0,mr=Ve(7,0,ur|0)|0,S=S&~(ct()|0),ur=Ve(t0($)|0,0,ur|0)|0,S=ct()|0|S,xr=E,g[xr>>2]=ur|fr&~mr,g[xr+4>>2]=S,(M|0)<=1){d=14;break}}e:do if((d|0)!=13&&(d|0)==14)if((g[pe>>2]|0)<=1&&(g[pe+4>>2]|0)<=1&&(g[pe+8>>2]|0)<=1){d=t0(pe)|0,S=b0(At,d)|0,(S|0)==127?$=0:$=_a(S)|0;t:do if(d){if(we){if(S=Ks(h,f)|0,(S|0)==7){S=5;break e}if(M=g[21248+(S*28|0)+(d<<2)>>2]|0,(M|0)>0){S=d,d=0;do S=Ll(S)|0,d=d+1|0;while((d|0)!=(M|0))}else S=d;if((S|0)==1){S=9;break e}d=b0(At,S)|0,(d|0)==127&&bi(23200,23090,411,23230),_a(d)|0?bi(23245,23090,412,23230):(_t=d,Rt=M,$e=S)}else _t=S,Rt=0,$e=d;if(F=g[4272+(At*28|0)+($e<<2)>>2]|0,(F|0)<=-1&&bi(23276,23090,419,23230),!$){if((Rt|0)<0){S=5;break e}if(Rt|0){M=E,S=0,d=g[M>>2]|0,M=g[M+4>>2]|0;do d=Fl(d,M)|0,M=ct()|0,ur=E,g[ur>>2]=d,g[ur+4>>2]=M,S=S+1|0;while((S|0)<(Rt|0))}if((F|0)<=0){S=_t,d=58;break}for(M=E,S=0,d=g[M>>2]|0,M=g[M+4>>2]|0;;)if(d=Fl(d,M)|0,M=ct()|0,ur=E,g[ur>>2]=d,g[ur+4>>2]=M,S=S+1|0,(S|0)==(F|0)){S=_t,d=58;break t}}if(O=ji(_t,At)|0,(O|0)==7&&bi(23066,23090,428,23230),S=E,d=g[S>>2]|0,S=g[S+4>>2]|0,(F|0)>0){M=0;do d=Fl(d,S)|0,S=ct()|0,ur=E,g[ur>>2]=d,g[ur+4>>2]=S,M=M+1|0;while((M|0)!=(F|0))}if(S=Ks(d,S)|0,(S|0)==7&&bi(23313,23090,440,23230),d=Ja(_t)|0,d=g[(d?21664:21456)+(O*28|0)+(S<<2)>>2]|0,(d|0)<0&&bi(23313,23090,454,23230),!d)S=_t,d=58;else{O=E,S=0,M=g[O>>2]|0,O=g[O+4>>2]|0;do M=Xc(M,O)|0,O=ct()|0,ur=E,g[ur>>2]=M,g[ur+4>>2]=O,S=S+1|0;while((S|0)<(d|0));S=_t,d=58}}else if((we|0)!=0&($|0)!=0){if(d=Ks(h,f)|0,M=E,M=Ks(g[M>>2]|0,g[M+4>>2]|0)|0,(d|0)==7|(M|0)==7){S=5;break e}if(M=g[21248+(d*28|0)+(M<<2)>>2]|0,(M|0)<0){S=5;break e}if(!M)d=59;else{F=E,d=0,O=g[F>>2]|0,F=g[F+4>>2]|0;do O=Fl(O,F)|0,F=ct()|0,ur=E,g[ur>>2]=O,g[ur+4>>2]=F,d=d+1|0;while((d|0)<(M|0));d=58}}else d=58;while(0);if((d|0)==58&&$&&(d=59),(d|0)==59&&(ur=E,(Ks(g[ur>>2]|0,g[ur+4>>2]|0)|0)==1)){S=9;break}ur=E,mr=g[ur>>2]|0,ur=g[ur+4>>2]&-1040385,fr=Ve(S|0,0,45)|0,ur=ur|(ct()|0),S=E,g[S>>2]=mr|fr,g[S+4>>2]=ur,S=0}else S=1;while(0);return ur=S,nt=zt,ur|0}function Br(h,f,d,E,S,M){h=h|0,f=f|0,d=d|0,E=E|0,S=S|0,M=M|0;var O=0,F=0;return F=nt,nt=nt+16|0,O=F,S?h=15:(h=Pr(h,f,d,E,O)|0,h||(TA(O,M),h=0)),nt=F,h|0}function Vr(h,f,d,E,S){h=h|0,f=f|0,d=d|0,E=E|0,S=S|0;var M=0,O=0;return O=nt,nt=nt+16|0,M=O,E?d=15:(d=CA(d,M)|0,d||(d=qr(h,f,M,S)|0)),nt=O,d|0}function Kr(h,f,d,E,S){h=h|0,f=f|0,d=d|0,E=E|0,S=S|0;var M=0,O=0,F=0,$=0;return $=nt,nt=nt+32|0,O=$+12|0,F=$,M=Pr(h,f,h,f,O)|0,M|0?(F=M,nt=$,F|0):(h=Pr(h,f,d,E,F)|0,h|0?(F=h,nt=$,F|0):(O=M0(O,F)|0,F=S,g[F>>2]=O,g[F+4>>2]=((O|0)<0)<<31>>31,F=0,nt=$,F|0))}function Dr(h,f,d,E,S){h=h|0,f=f|0,d=d|0,E=E|0,S=S|0;var M=0,O=0,F=0,$=0;return $=nt,nt=nt+32|0,O=$+12|0,F=$,M=Pr(h,f,h,f,O)|0,!M&&(M=Pr(h,f,d,E,F)|0,!M)?(E=M0(O,F)|0,E=vn(E|0,((E|0)<0)<<31>>31|0,1,0)|0,O=ct()|0,F=S,g[F>>2]=E,g[F+4>>2]=O,F=0,nt=$,F|0):(F=M,nt=$,F|0)}function jr(h,f,d,E,S){h=h|0,f=f|0,d=d|0,E=E|0,S=S|0;var M=0,O=0,F=0,$=0,pe=0,we=0,$e=0,At=0,Rt=0,_t=0,zt=0,xr=0,mr=0,fr=0,ur=0,er=0,Sn=0,wn=0,cn=0,En=0;if(cn=nt,nt=nt+48|0,O=cn+24|0,F=cn+12|0,wn=cn,M=Pr(h,f,h,f,O)|0,!M&&(M=Pr(h,f,d,E,F)|0,!M)){er=M0(O,F)|0,Sn=((er|0)<0)<<31>>31,g[O>>2]=0,g[O+4>>2]=0,g[O+8>>2]=0,g[F>>2]=0,g[F+4>>2]=0,g[F+8>>2]=0,Pr(h,f,h,f,O)|0&&bi(23313,23090,691,23299),Pr(h,f,d,E,F)|0&&bi(23313,23090,696,23299),Zh(O),Zh(F),er?($e=g[O>>2]|0,_t=+(er|0),mr=O+4|0,At=g[mr>>2]|0,fr=O+8|0,Rt=g[fr>>2]|0,ur=O,E=$e,M=At,d=Rt,zt=+((g[F>>2]|0)-$e|0)/_t,xr=+((g[F+4>>2]|0)-At|0)/_t,_t=+((g[F+8>>2]|0)-Rt|0)/_t):(M=O+4|0,d=O+8|0,mr=M,fr=d,ur=O,E=g[O>>2]|0,M=g[M>>2]|0,d=g[d>>2]|0,zt=0,xr=0,_t=0),g[wn>>2]=E,Rt=wn+4|0,g[Rt>>2]=M,At=wn+8|0,g[At>>2]=d;e:do if((er|0)<0)M=0;else for(we=0,$e=0,M=E;;){pe=+($e>>>0)+4294967296*+(we|0),En=zt*pe+ +(M|0),$=xr*pe+ +(g[mr>>2]|0),pe=_t*pe+ +(g[fr>>2]|0),d=~~+tr(+En),O=~~+tr(+$),M=~~+tr(+pe),En=+xa(+(+(d|0)-En)),$=+xa(+(+(O|0)-$)),pe=+xa(+(+(M|0)-pe));do if(En>$&En>pe)d=0-(O+M)|0,E=O;else if(F=0-d|0,$>pe){E=F-M|0;break}else{E=O,M=F-O|0;break}while(0);if(g[wn>>2]=d,g[Rt>>2]=E,g[At>>2]=M,zh(wn),M=qr(h,f,wn,S+($e<<3)|0)|0,M|0)break e;if(!((we|0)<(Sn|0)|(we|0)==(Sn|0)&$e>>>0<er>>>0)){M=0;break e}M=vn($e|0,we|0,1,0)|0,F=ct()|0,we=F,$e=M,M=g[ur>>2]|0}while(0);return wn=M,nt=cn,wn|0}return wn=M,nt=cn,wn|0}function jt(h,f,d,E){h=h|0,f=f|0,d=d|0,E=E|0;var S=0,M=0,O=0;if((d|0)==0&(E|0)==0)return S=0,M=1,zi(S|0),M|0;M=h,S=f,h=1,f=0;do O=(d&1|0)==0&!0,h=Xt((O?1:M)|0,(O?0:S)|0,h|0,f|0)|0,f=ct()|0,d=Da(d|0,E|0,1)|0,E=ct()|0,M=Xt(M|0,S|0,M|0,S|0)|0,S=ct()|0;while(!((d|0)==0&(E|0)==0));return zi(f|0),h|0}function Ar(h,f,d){h=h|0,f=f|0,d=d|0;var E=0,S=0,M=0,O=0,F=0,$=0,pe=0,we=0,$e=0,At=0;if(!(zc(f,d)|0)||(f=fs(f)|0,E=+et[d>>3],S=+et[d+8>>3],S=f&S<0?S+6.283185307179586:S,At=g[h>>2]|0,(At|0)<=0))return At=0,At|0;if($e=g[h+4>>2]|0,f){f=0,we=S,d=-1,h=0;e:for(;;){for(pe=h;O=+et[$e+(pe<<4)>>3],S=+et[$e+(pe<<4)+8>>3],h=(d+2|0)%(At|0)|0,M=+et[$e+(h<<4)>>3],F=+et[$e+(h<<4)+8>>3],O>M?($=O,O=F):($=M,M=O,O=S,S=F),E=E==M|E==$?E+2220446049250313e-31:E,!!(E<M|E>$);)if(d=pe+1|0,(d|0)>=(At|0)){d=22;break e}else h=pe,pe=d,d=h;if(F=O<0?O+6.283185307179586:O,O=S<0?S+6.283185307179586:S,we=F==we|O==we?we+-2220446049250313e-31:we,$=F+(O-F)*((E-M)/($-M)),($<0?$+6.283185307179586:$)>we&&(f=f^1),h=pe+1|0,(h|0)>=(At|0)){d=22;break}else d=pe}if((d|0)==22)return f|0}else{f=0,we=S,d=-1,h=0;e:for(;;){for(pe=h;O=+et[$e+(pe<<4)>>3],S=+et[$e+(pe<<4)+8>>3],h=(d+2|0)%(At|0)|0,M=+et[$e+(h<<4)>>3],F=+et[$e+(h<<4)+8>>3],O>M?($=O,O=F):($=M,M=O,O=S,S=F),E=E==M|E==$?E+2220446049250313e-31:E,!!(E<M|E>$);)if(d=pe+1|0,(d|0)>=(At|0)){d=22;break e}else h=pe,pe=d,d=h;if(we=O==we|S==we?we+-2220446049250313e-31:we,O+(S-O)*((E-M)/($-M))>we&&(f=f^1),h=pe+1|0,(h|0)>=(At|0)){d=22;break}else d=pe}if((d|0)==22)return f|0}return 0}function Ur(h,f){h=h|0,f=f|0;var d=0,E=0,S=0,M=0,O=0,F=0,$=0,pe=0,we=0,$e=0,At=0,Rt=0,_t=0,zt=0,xr=0,mr=0,fr=0;if(_t=g[h>>2]|0,!_t){g[f>>2]=0,g[f+4>>2]=0,g[f+8>>2]=0,g[f+12>>2]=0,g[f+16>>2]=0,g[f+20>>2]=0,g[f+24>>2]=0,g[f+28>>2]=0;return}if(zt=f+8|0,et[zt>>3]=17976931348623157e292,xr=f+24|0,et[xr>>3]=17976931348623157e292,et[f>>3]=-17976931348623157e292,mr=f+16|0,et[mr>>3]=-17976931348623157e292,!((_t|0)<=0)){for(At=g[h+4>>2]|0,pe=17976931348623157e292,we=-17976931348623157e292,$e=0,h=-1,M=17976931348623157e292,O=17976931348623157e292,$=-17976931348623157e292,E=-17976931348623157e292,Rt=0;d=+et[At+(Rt<<4)>>3],F=+et[At+(Rt<<4)+8>>3],h=h+2|0,S=+et[At+(((h|0)==(_t|0)?0:h)<<4)+8>>3],d<M&&(et[zt>>3]=d,M=d),F<O&&(et[xr>>3]=F,O=F),d>$?et[f>>3]=d:d=$,F>E&&(et[mr>>3]=F,E=F),pe=F>0&F<pe?F:pe,we=F<0&F>we?F:we,$e=$e|+xa(+(F-S))>3.141592653589793,h=Rt+1|0,(h|0)!=(_t|0);)fr=Rt,$=d,Rt=h,h=fr;$e&&(et[mr>>3]=we,et[xr>>3]=pe)}}function Jr(h,f){h=h|0,f=f|0;var d=0,E=0,S=0,M=0,O=0,F=0,$=0,pe=0,we=0,$e=0,At=0,Rt=0,_t=0,zt=0,xr=0,mr=0,fr=0,ur=0,er=0,Sn=0,wn=0,cn=0;if(_t=g[h>>2]|0,_t){if(zt=f+8|0,et[zt>>3]=17976931348623157e292,xr=f+24|0,et[xr>>3]=17976931348623157e292,et[f>>3]=-17976931348623157e292,mr=f+16|0,et[mr>>3]=-17976931348623157e292,(_t|0)>0){for(S=g[h+4>>2]|0,At=17976931348623157e292,Rt=-17976931348623157e292,E=0,d=-1,$=17976931348623157e292,pe=17976931348623157e292,$e=-17976931348623157e292,O=-17976931348623157e292,fr=0;M=+et[S+(fr<<4)>>3],we=+et[S+(fr<<4)+8>>3],wn=d+2|0,F=+et[S+(((wn|0)==(_t|0)?0:wn)<<4)+8>>3],M<$&&(et[zt>>3]=M,$=M),we<pe&&(et[xr>>3]=we,pe=we),M>$e?et[f>>3]=M:M=$e,we>O&&(et[mr>>3]=we,O=we),At=we>0&we<At?we:At,Rt=we<0&we>Rt?we:Rt,E=E|+xa(+(we-F))>3.141592653589793,d=fr+1|0,(d|0)!=(_t|0);)wn=fr,$e=M,fr=d,d=wn;E&&(et[mr>>3]=Rt,et[xr>>3]=At)}}else g[f>>2]=0,g[f+4>>2]=0,g[f+8>>2]=0,g[f+12>>2]=0,g[f+16>>2]=0,g[f+20>>2]=0,g[f+24>>2]=0,g[f+28>>2]=0;if(wn=h+8|0,d=g[wn>>2]|0,!((d|0)<=0)){Sn=h+12|0,er=0;do if(S=g[Sn>>2]|0,E=er,er=er+1|0,xr=f+(er<<5)|0,mr=g[S+(E<<3)>>2]|0,mr){if(fr=f+(er<<5)+8|0,et[fr>>3]=17976931348623157e292,h=f+(er<<5)+24|0,et[h>>3]=17976931348623157e292,et[xr>>3]=-17976931348623157e292,ur=f+(er<<5)+16|0,et[ur>>3]=-17976931348623157e292,(mr|0)>0){for(_t=g[S+(E<<3)+4>>2]|0,At=17976931348623157e292,Rt=-17976931348623157e292,S=0,E=-1,zt=0,$=17976931348623157e292,pe=17976931348623157e292,we=-17976931348623157e292,O=-17976931348623157e292;M=+et[_t+(zt<<4)>>3],$e=+et[_t+(zt<<4)+8>>3],E=E+2|0,F=+et[_t+(((E|0)==(mr|0)?0:E)<<4)+8>>3],M<$&&(et[fr>>3]=M,$=M),$e<pe&&(et[h>>3]=$e,pe=$e),M>we?et[xr>>3]=M:M=we,$e>O&&(et[ur>>3]=$e,O=$e),At=$e>0&$e<At?$e:At,Rt=$e<0&$e>Rt?$e:Rt,S=S|+xa(+($e-F))>3.141592653589793,E=zt+1|0,(E|0)!=(mr|0);)cn=zt,zt=E,we=M,E=cn;S&&(et[ur>>3]=Rt,et[h>>3]=At)}}else g[xr>>2]=0,g[xr+4>>2]=0,g[xr+8>>2]=0,g[xr+12>>2]=0,g[xr+16>>2]=0,g[xr+20>>2]=0,g[xr+24>>2]=0,g[xr+28>>2]=0,d=g[wn>>2]|0;while((er|0)<(d|0))}}function Rr(h,f,d){h=h|0,f=f|0,d=d|0;var E=0,S=0,M=0;if(!(Ar(h,f,d)|0))return S=0,S|0;if(S=h+8|0,(g[S>>2]|0)<=0)return S=1,S|0;for(E=h+12|0,h=0;;){if(M=h,h=h+1|0,Ar((g[E>>2]|0)+(M<<3)|0,f+(h<<5)|0,d)|0){h=0,E=6;break}if((h|0)>=(g[S>>2]|0)){h=1,E=6;break}}return(E|0)==6?h|0:0}function An(){return 8}function Fr(){return 16}function sn(){return 168}function wr(){return 8}function en(){return 16}function Nn(){return 12}function hi(){return 8}function an(h){return h=h|0,+(+((g[h>>2]|0)>>>0)+4294967296*+(g[h+4>>2]|0))}function Zr(h){h=h|0;var f=0,d=0;return d=+et[h>>3],f=+et[h+8>>3],+ +vo(+(d*d+f*f))}function Tr(h,f,d,E,S){h=h|0,f=f|0,d=d|0,E=E|0,S=S|0;var M=0,O=0,F=0,$=0,pe=0,we=0,$e=0,At=0;pe=+et[h>>3],$=+et[f>>3]-pe,F=+et[h+8>>3],O=+et[f+8>>3]-F,$e=+et[d>>3],M=+et[E>>3]-$e,At=+et[d+8>>3],we=+et[E+8>>3]-At,M=(M*(F-At)-(pe-$e)*we)/($*we-O*M),et[S>>3]=pe+$*M,et[S+8>>3]=F+O*M}function ai(h,f){return h=h|0,f=f|0,+xa(+(+et[h>>3]-+et[f>>3]))<11920928955078125e-23?(f=+xa(+(+et[h+8>>3]-+et[f+8>>3]))<11920928955078125e-23,f|0):(f=0,f|0)}function Yn(h,f){h=h|0,f=f|0;var d=0,E=0,S=0;return S=+et[h>>3]-+et[f>>3],E=+et[h+8>>3]-+et[f+8>>3],d=+et[h+16>>3]-+et[f+16>>3],+(S*S+E*E+d*d)}function Pn(h,f){h=h|0,f=f|0;var d=0,E=0,S=0;d=+et[h>>3],E=+Ma(+d),d=+Yr(+d),et[f+16>>3]=d,d=+et[h+8>>3],S=E*+Ma(+d),et[f>>3]=S,d=E*+Yr(+d),et[f+8>>3]=d}function Di(h,f,d){h=h|0,f=f|0,d=d|0;var E=0,S=0,M=0;if(M=nt,nt=nt+16|0,S=M,E=wa(h,f)|0,(d+-1|0)>>>0>5||(E=(E|0)!=0,(d|0)==1&E))return S=-1,nt=M,S|0;do if(ei(h,f,S)|0)E=-1;else if(E){E=((g[21936+(d<<2)>>2]|0)+5-(g[S>>2]|0)|0)%5|0;break}else{E=((g[21968+(d<<2)>>2]|0)+6-(g[S>>2]|0)|0)%6|0;break}while(0);return S=E,nt=M,S|0}function ei(h,f,d){h=h|0,f=f|0,d=d|0;var E=0,S=0,M=0,O=0,F=0,$=0,pe=0;if(pe=nt,nt=nt+32|0,O=pe+16|0,F=pe,E=pu(h,f,O)|0,E|0)return d=E,nt=pe,d|0;M=Wc(h,f)|0,$=Ks(h,f)|0,xA(M,F),E=T0(M,g[O>>2]|0)|0;e:do if(_a(M)|0){do switch(M|0){case 4:{h=0;break}case 14:{h=1;break}case 24:{h=2;break}case 38:{h=3;break}case 49:{h=4;break}case 58:{h=5;break}case 63:{h=6;break}case 72:{h=7;break}case 83:{h=8;break}case 97:{h=9;break}case 107:{h=10;break}case 117:{h=11;break}default:{E=1;break e}}while(0);if(S=g[22e3+(h*24|0)+8>>2]|0,f=g[22e3+(h*24|0)+16>>2]|0,h=g[O>>2]|0,(h|0)!=(g[F>>2]|0)&&(F=Ja(M)|0,h=g[O>>2]|0,F|(h|0)==(f|0)&&(E=(E+1|0)%6|0)),($|0)==3&(h|0)==(f|0)){E=(E+5|0)%6|0,S=22;break}($|0)==5&(h|0)==(S|0)&&(E=(E+1|0)%6|0),S=22}else S=22;while(0);return(S|0)==22&&(g[d>>2]=E,E=0),d=E,nt=pe,d|0}function qn(h,f,d,E){h=h|0,f=f|0,d=d|0,E=E|0;var S=0,M=0,O=0,F=0,$=0,pe=0,we=0,$e=0,At=0,Rt=0,_t=0,zt=0,xr=0,mr=0,fr=0,ur=0;if(ur=nt,nt=nt+32|0,fr=ur+24|0,xr=ur+20|0,_t=ur+8|0,Rt=ur+16|0,At=ur,$=(wa(h,f)|0)==0,$=$?6:5,we=Oe(h|0,f|0,52)|0,ct()|0,we=we&15,$>>>0<=d>>>0)return E=2,nt=ur,E|0;$e=(we|0)==0,!$e&&(zt=Ve(7,0,(we^15)*3|0)|0,(zt&h|0)==0&((ct()|0)&f|0)==0)?S=d:M=4;e:do if((M|0)==4){if(S=(wa(h,f)|0)!=0,((S?4:5)|0)<(d|0)||ei(h,f,fr)|0||(M=(g[fr>>2]|0)+d|0,S?S=22288+(((M|0)%5|0)<<2)|0:S=22320+(((M|0)%6|0)<<2)|0,zt=g[S>>2]|0,(zt|0)==7))return E=1,nt=ur,E|0;g[xr>>2]=0,S=Ss(h,f,zt,xr,_t)|0;do if(!S){if(F=_t,pe=g[F>>2]|0,F=g[F+4>>2]|0,O=F>>>0<f>>>0|(F|0)==(f|0)&pe>>>0<h>>>0,M=O?pe:h,O=O?F:f,!$e&&($e=Ve(7,0,(we^15)*3|0)|0,(pe&$e|0)==0&(F&(ct()|0)|0)==0))S=d;else{if(F=(d+-1+$|0)%($|0)|0,S=wa(h,f)|0,(F|0)<0&&bi(23313,23315,245,23324),$=(S|0)!=0,(($?4:5)|0)<(F|0)&&bi(23313,23315,245,23324),ei(h,f,fr)|0&&bi(23313,23315,245,23324),S=(g[fr>>2]|0)+F|0,$?S=22288+(((S|0)%5|0)<<2)|0:S=22320+(((S|0)%6|0)<<2)|0,F=g[S>>2]|0,(F|0)==7&&bi(23313,23315,245,23324),g[Rt>>2]=0,S=Ss(h,f,F,Rt,At)|0,S|0)break;pe=At,$=g[pe>>2]|0,pe=g[pe+4>>2]|0;do if(pe>>>0<O>>>0|(pe|0)==(O|0)&$>>>0<M>>>0){if(wa($,pe)|0?M=J0($,pe,h,f)|0:M=g[22384+((((g[Rt>>2]|0)+(g[22352+(F<<2)>>2]|0)|0)%6|0)<<2)>>2]|0,S=wa($,pe)|0,(M+-1|0)>>>0>5){S=-1,M=$,O=pe;break}if(S=(S|0)!=0,(M|0)==1&S){S=-1,M=$,O=pe;break}do if(ei($,pe,fr)|0)S=-1;else if(S){S=((g[21936+(M<<2)>>2]|0)+5-(g[fr>>2]|0)|0)%5|0;break}else{S=((g[21968+(M<<2)>>2]|0)+6-(g[fr>>2]|0)|0)%6|0;break}while(0);M=$,O=pe}else S=d;while(0);F=_t,pe=g[F>>2]|0,F=g[F+4>>2]|0}if((M|0)==(pe|0)&(O|0)==(F|0)){if($=(wa(pe,F)|0)!=0,$?h=J0(pe,F,h,f)|0:h=g[22384+((((g[xr>>2]|0)+(g[22352+(zt<<2)>>2]|0)|0)%6|0)<<2)>>2]|0,S=wa(pe,F)|0,(h+-1|0)>>>0<=5&&(mr=(S|0)!=0,!((h|0)==1&mr)))do if(ei(pe,F,fr)|0)S=-1;else if(mr){S=((g[21936+(h<<2)>>2]|0)+5-(g[fr>>2]|0)|0)%5|0;break}else{S=((g[21968+(h<<2)>>2]|0)+6-(g[fr>>2]|0)|0)%6|0;break}while(0);else S=-1;S=S+1|0,S=(S|0)==6|$&(S|0)==5?0:S}f=O,h=M;break e}while(0);return E=S,nt=ur,E|0}while(0);return mr=Ve(S|0,0,56)|0,fr=ct()|0|f&-2130706433|536870912,g[E>>2]=mr|h,g[E+4>>2]=fr,E=0,nt=ur,E|0}function ga(h,f,d){h=h|0,f=f|0,d=d|0;var E=0,S=0,M=0;return M=(wa(h,f)|0)==0,E=qn(h,f,0,d)|0,S=(E|0)==0,M?!S||(E=qn(h,f,1,d+8|0)|0,E|0)||(E=qn(h,f,2,d+16|0)|0,E|0)||(E=qn(h,f,3,d+24|0)|0,E|0)||(E=qn(h,f,4,d+32|0)|0,E)?(M=E,M|0):qn(h,f,5,d+40|0)|0:!S||(E=qn(h,f,1,d+8|0)|0,E|0)||(E=qn(h,f,2,d+16|0)|0,E|0)||(E=qn(h,f,3,d+24|0)|0,E|0)||(E=qn(h,f,4,d+32|0)|0,E|0)?(M=E,M|0):(M=d+40|0,g[M>>2]=0,g[M+4>>2]=0,M=0,M|0)}function Oo(h,f,d){h=h|0,f=f|0,d=d|0;var E=0,S=0,M=0,O=0,F=0,$=0;return $=nt,nt=nt+192|0,S=$,M=$+168|0,O=Oe(h|0,f|0,56)|0,ct()|0,O=O&7,F=f&-2130706433|134217728,E=pu(h,F,M)|0,E|0?(F=E,nt=$,F|0):(f=Oe(h|0,f|0,52)|0,ct()|0,f=f&15,wa(h,F)|0?n0(M,f,O,1,S):Hc(M,f,O,1,S),F=S+8|0,g[d>>2]=g[F>>2],g[d+4>>2]=g[F+4>>2],g[d+8>>2]=g[F+8>>2],g[d+12>>2]=g[F+12>>2],F=0,nt=$,F|0)}function Wo(h,f){h=h|0,f=f|0;var d=0,E=0,S=0,M=0;return S=nt,nt=nt+16|0,d=S,!(!0&(f&2013265920|0)==536870912)||(E=f&-2130706433|134217728,!(df(h,E)|0))?(E=0,nt=S,E|0):(M=Oe(h|0,f|0,56)|0,ct()|0,M=(qn(h,E,M&7,d)|0)==0,E=d,E=M&((g[E>>2]|0)==(h|0)?(g[E+4>>2]|0)==(f|0):0)&1,nt=S,E|0)}function Xi(h,f,d){h=h|0,f=f|0,d=d|0;var E=0;(f|0)>0?(E=Mn(f,4)|0,g[h>>2]=E,E||bi(23337,23360,40,23374)):g[h>>2]=0,g[h+4>>2]=f,g[h+8>>2]=0,g[h+12>>2]=d}function Qo(h){h=h|0;var f=0,d=0,E=0,S=0,M=0,O=0,F=0;S=h+4|0,M=h+12|0,O=h+8|0;e:for(;;){for(d=g[S>>2]|0,f=0;;){if((f|0)>=(d|0))break e;if(E=g[h>>2]|0,F=g[E+(f<<2)>>2]|0,!F)f=f+1|0;else break}f=E+(~~(+xa(+(+Es(10,+ +(15-(g[M>>2]|0)|0))*(+et[F>>3]+ +et[F+8>>3])))%+(d|0))>>>0<<2)|0,d=g[f>>2]|0;t:do if(d|0){if(E=F+32|0,(d|0)==(F|0))g[f>>2]=g[E>>2];else{if(d=d+32|0,f=g[d>>2]|0,!f)break;for(;(f|0)!=(F|0);)if(d=f+32|0,f=g[d>>2]|0,!f)break t;g[d>>2]=g[E>>2]}pn(F),g[O>>2]=(g[O>>2]|0)+-1}while(0)}pn(g[h>>2]|0)}function eo(h){h=h|0;var f=0,d=0,E=0;for(E=g[h+4>>2]|0,d=0;;){if((d|0)>=(E|0)){f=0,d=4;break}if(f=g[(g[h>>2]|0)+(d<<2)>>2]|0,!f)d=d+1|0;else{d=4;break}}return(d|0)==4?f|0:0}function uo(h,f){h=h|0,f=f|0;var d=0,E=0,S=0,M=0;if(d=~~(+xa(+(+Es(10,+ +(15-(g[h+12>>2]|0)|0))*(+et[f>>3]+ +et[f+8>>3])))%+(g[h+4>>2]|0))>>>0,d=(g[h>>2]|0)+(d<<2)|0,E=g[d>>2]|0,!E)return M=1,M|0;M=f+32|0;do if((E|0)!=(f|0)){if(d=g[E+32>>2]|0,!d)return M=1,M|0;for(S=d;;){if((S|0)==(f|0)){S=8;break}if(d=g[S+32>>2]|0,d)E=S,S=d;else{d=1,S=10;break}}if((S|0)==8){g[E+32>>2]=g[M>>2];break}else if((S|0)==10)return d|0}else g[d>>2]=g[M>>2];while(0);return pn(f),M=h+8|0,g[M>>2]=(g[M>>2]|0)+-1,M=0,M|0}function No(h,f,d){h=h|0,f=f|0,d=d|0;var E=0,S=0,M=0,O=0;M=to(40)|0,M||bi(23390,23360,98,23403),g[M>>2]=g[f>>2],g[M+4>>2]=g[f+4>>2],g[M+8>>2]=g[f+8>>2],g[M+12>>2]=g[f+12>>2],S=M+16|0,g[S>>2]=g[d>>2],g[S+4>>2]=g[d+4>>2],g[S+8>>2]=g[d+8>>2],g[S+12>>2]=g[d+12>>2],g[M+32>>2]=0,S=~~(+xa(+(+Es(10,+ +(15-(g[h+12>>2]|0)|0))*(+et[f>>3]+ +et[f+8>>3])))%+(g[h+4>>2]|0))>>>0,S=(g[h>>2]|0)+(S<<2)|0,E=g[S>>2]|0;do if(!E)g[S>>2]=M;else{for(;!(mf(E,f)|0&&mf(E+16|0,d)|0);)if(S=g[E+32>>2]|0,E=S|0?S:E,!(g[E+32>>2]|0)){O=10;break}if((O|0)==10){g[E+32>>2]=M;break}return pn(M),O=E,O|0}while(0);return O=h+8|0,g[O>>2]=(g[O>>2]|0)+1,O=M,O|0}function qo(h,f,d){h=h|0,f=f|0,d=d|0;var E=0,S=0;if(S=~~(+xa(+(+Es(10,+ +(15-(g[h+12>>2]|0)|0))*(+et[f>>3]+ +et[f+8>>3])))%+(g[h+4>>2]|0))>>>0,S=g[(g[h>>2]|0)+(S<<2)>>2]|0,!S)return d=0,d|0;if(!d){for(h=S;;){if(mf(h,f)|0){E=10;break}if(h=g[h+32>>2]|0,!h){h=0,E=10;break}}if((E|0)==10)return h|0}for(h=S;;){if(mf(h,f)|0&&mf(h+16|0,d)|0){E=10;break}if(h=g[h+32>>2]|0,!h){h=0,E=10;break}}return(E|0)==10?h|0:0}function Ko(h,f){h=h|0,f=f|0;var d=0;if(d=~~(+xa(+(+Es(10,+ +(15-(g[h+12>>2]|0)|0))*(+et[f>>3]+ +et[f+8>>3])))%+(g[h+4>>2]|0))>>>0,h=g[(g[h>>2]|0)+(d<<2)>>2]|0,!h)return d=0,d|0;for(;;){if(mf(h,f)|0){f=5;break}if(h=g[h+32>>2]|0,!h){h=0,f=5;break}}return(f|0)==5?h|0:0}function Ns(){return 23424}function hs(h){return h=+h,+ +Dt(+h)}function ti(h){return h=+h,~~+hs(h)|0}function to(h){h=h|0;var f=0,d=0,E=0,S=0,M=0,O=0,F=0,$=0,pe=0,we=0,$e=0,At=0,Rt=0,_t=0,zt=0,xr=0,mr=0,fr=0,ur=0,er=0,Sn=0;Sn=nt,nt=nt+16|0,At=Sn;do if(h>>>0<245){if(pe=h>>>0<11?16:h+11&-8,h=pe>>>3,$e=g[5857]|0,d=$e>>>h,d&3|0)return f=(d&1^1)+h|0,h=23468+(f<<1<<2)|0,d=h+8|0,E=g[d>>2]|0,S=E+8|0,M=g[S>>2]|0,(M|0)==(h|0)?g[5857]=$e&~(1<<f):(g[M+12>>2]=h,g[d>>2]=M),er=f<<3,g[E+4>>2]=er|3,er=E+er+4|0,g[er>>2]=g[er>>2]|1,er=S,nt=Sn,er|0;if(we=g[5859]|0,pe>>>0>we>>>0){if(d|0)return f=2<<h,f=d<<h&(f|0-f),f=(f&0-f)+-1|0,F=f>>>12&16,f=f>>>F,d=f>>>5&8,f=f>>>d,M=f>>>2&4,f=f>>>M,h=f>>>1&2,f=f>>>h,E=f>>>1&1,E=(d|F|M|h|E)+(f>>>E)|0,f=23468+(E<<1<<2)|0,h=f+8|0,M=g[h>>2]|0,F=M+8|0,d=g[F>>2]|0,(d|0)==(f|0)?(h=$e&~(1<<E),g[5857]=h):(g[d+12>>2]=f,g[h>>2]=d,h=$e),er=E<<3,O=er-pe|0,g[M+4>>2]=pe|3,S=M+pe|0,g[S+4>>2]=O|1,g[M+er>>2]=O,we|0&&(E=g[5862]|0,f=we>>>3,d=23468+(f<<1<<2)|0,f=1<<f,h&f?(h=d+8|0,f=g[h>>2]|0):(g[5857]=h|f,f=d,h=d+8|0),g[h>>2]=E,g[f+12>>2]=E,g[E+8>>2]=f,g[E+12>>2]=d),g[5859]=O,g[5862]=S,er=F,nt=Sn,er|0;if(M=g[5858]|0,M){for(d=(M&0-M)+-1|0,S=d>>>12&16,d=d>>>S,E=d>>>5&8,d=d>>>E,O=d>>>2&4,d=d>>>O,F=d>>>1&2,d=d>>>F,$=d>>>1&1,$=g[23732+((E|S|O|F|$)+(d>>>$)<<2)>>2]|0,d=$,F=$,$=(g[$+4>>2]&-8)-pe|0;h=g[d+16>>2]|0,!(!h&&(h=g[d+20>>2]|0,!h));)O=(g[h+4>>2]&-8)-pe|0,S=O>>>0<$>>>0,d=h,F=S?h:F,$=S?O:$;if(O=F+pe|0,O>>>0>F>>>0){S=g[F+24>>2]|0,f=g[F+12>>2]|0;do if((f|0)==(F|0)){if(h=F+20|0,f=g[h>>2]|0,!f&&(h=F+16|0,f=g[h>>2]|0,!f)){d=0;break}for(;;)if(E=f+20|0,d=g[E>>2]|0,d)f=d,h=E;else if(E=f+16|0,d=g[E>>2]|0,d)f=d,h=E;else break;g[h>>2]=0,d=f}else d=g[F+8>>2]|0,g[d+12>>2]=f,g[f+8>>2]=d,d=f;while(0);do if(S|0){if(f=g[F+28>>2]|0,h=23732+(f<<2)|0,(F|0)==(g[h>>2]|0)){if(g[h>>2]=d,!d){g[5858]=M&~(1<<f);break}}else if(er=S+16|0,g[((g[er>>2]|0)==(F|0)?er:S+20|0)>>2]=d,!d)break;g[d+24>>2]=S,f=g[F+16>>2]|0,f|0&&(g[d+16>>2]=f,g[f+24>>2]=d),f=g[F+20>>2]|0,f|0&&(g[d+20>>2]=f,g[f+24>>2]=d)}while(0);return $>>>0<16?(er=$+pe|0,g[F+4>>2]=er|3,er=F+er+4|0,g[er>>2]=g[er>>2]|1):(g[F+4>>2]=pe|3,g[O+4>>2]=$|1,g[O+$>>2]=$,we|0&&(E=g[5862]|0,f=we>>>3,d=23468+(f<<1<<2)|0,f=1<<f,f&$e?(h=d+8|0,f=g[h>>2]|0):(g[5857]=f|$e,f=d,h=d+8|0),g[h>>2]=E,g[f+12>>2]=E,g[E+8>>2]=f,g[E+12>>2]=d),g[5859]=$,g[5862]=O),er=F+8|0,nt=Sn,er|0}else $e=pe}else $e=pe}else $e=pe}else if(h>>>0<=4294967231)if(h=h+11|0,pe=h&-8,E=g[5858]|0,E){S=0-pe|0,h=h>>>8,h?pe>>>0>16777215?$=31:($e=(h+1048320|0)>>>16&8,zt=h<<$e,F=(zt+520192|0)>>>16&4,zt=zt<<F,$=(zt+245760|0)>>>16&2,$=14-(F|$e|$)+(zt<<$>>>15)|0,$=pe>>>($+7|0)&1|$<<1):$=0,d=g[23732+($<<2)>>2]|0;e:do if(!d)d=0,h=0,zt=61;else for(h=0,F=pe<<(($|0)==31?0:25-($>>>1)|0),M=0;;){if(O=(g[d+4>>2]&-8)-pe|0,O>>>0<S>>>0)if(O)h=d,S=O;else{h=d,S=0,zt=65;break e}if(zt=g[d+20>>2]|0,d=g[d+16+(F>>>31<<2)>>2]|0,M=(zt|0)==0|(zt|0)==(d|0)?M:zt,d)F=F<<1;else{d=M,zt=61;break}}while(0);if((zt|0)==61){if((d|0)==0&(h|0)==0){if(h=2<<$,h=(h|0-h)&E,!h){$e=pe;break}$e=(h&0-h)+-1|0,O=$e>>>12&16,$e=$e>>>O,M=$e>>>5&8,$e=$e>>>M,F=$e>>>2&4,$e=$e>>>F,$=$e>>>1&2,$e=$e>>>$,d=$e>>>1&1,h=0,d=g[23732+((M|O|F|$|d)+($e>>>d)<<2)>>2]|0}d?zt=65:(F=h,O=S)}if((zt|0)==65)for(M=d;;)if($e=(g[M+4>>2]&-8)-pe|0,d=$e>>>0<S>>>0,S=d?$e:S,h=d?M:h,d=g[M+16>>2]|0,d||(d=g[M+20>>2]|0),d)M=d;else{F=h,O=S;break}if(F|0&&O>>>0<((g[5859]|0)-pe|0)>>>0&&(we=F+pe|0,we>>>0>F>>>0)){M=g[F+24>>2]|0,f=g[F+12>>2]|0;do if((f|0)==(F|0)){if(h=F+20|0,f=g[h>>2]|0,!f&&(h=F+16|0,f=g[h>>2]|0,!f)){f=0;break}for(;;)if(S=f+20|0,d=g[S>>2]|0,d)f=d,h=S;else if(S=f+16|0,d=g[S>>2]|0,d)f=d,h=S;else break;g[h>>2]=0}else er=g[F+8>>2]|0,g[er+12>>2]=f,g[f+8>>2]=er;while(0);do if(M){if(h=g[F+28>>2]|0,d=23732+(h<<2)|0,(F|0)==(g[d>>2]|0)){if(g[d>>2]=f,!f){E=E&~(1<<h),g[5858]=E;break}}else if(er=M+16|0,g[((g[er>>2]|0)==(F|0)?er:M+20|0)>>2]=f,!f)break;g[f+24>>2]=M,h=g[F+16>>2]|0,h|0&&(g[f+16>>2]=h,g[h+24>>2]=f),h=g[F+20>>2]|0,h&&(g[f+20>>2]=h,g[h+24>>2]=f)}while(0);e:do if(O>>>0<16)er=O+pe|0,g[F+4>>2]=er|3,er=F+er+4|0,g[er>>2]=g[er>>2]|1;else{if(g[F+4>>2]=pe|3,g[we+4>>2]=O|1,g[we+O>>2]=O,f=O>>>3,O>>>0<256){d=23468+(f<<1<<2)|0,h=g[5857]|0,f=1<<f,h&f?(h=d+8|0,f=g[h>>2]|0):(g[5857]=h|f,f=d,h=d+8|0),g[h>>2]=we,g[f+12>>2]=we,g[we+8>>2]=f,g[we+12>>2]=d;break}if(f=O>>>8,f?O>>>0>16777215?d=31:(ur=(f+1048320|0)>>>16&8,er=f<<ur,fr=(er+520192|0)>>>16&4,er=er<<fr,d=(er+245760|0)>>>16&2,d=14-(fr|ur|d)+(er<<d>>>15)|0,d=O>>>(d+7|0)&1|d<<1):d=0,f=23732+(d<<2)|0,g[we+28>>2]=d,h=we+16|0,g[h+4>>2]=0,g[h>>2]=0,h=1<<d,!(E&h)){g[5858]=E|h,g[f>>2]=we,g[we+24>>2]=f,g[we+12>>2]=we,g[we+8>>2]=we;break}f=g[f>>2]|0;t:do if((g[f+4>>2]&-8|0)!=(O|0)){for(E=O<<((d|0)==31?0:25-(d>>>1)|0);d=f+16+(E>>>31<<2)|0,h=g[d>>2]|0,!!h;)if((g[h+4>>2]&-8|0)==(O|0)){f=h;break t}else E=E<<1,f=h;g[d>>2]=we,g[we+24>>2]=f,g[we+12>>2]=we,g[we+8>>2]=we;break e}while(0);ur=f+8|0,er=g[ur>>2]|0,g[er+12>>2]=we,g[ur>>2]=we,g[we+8>>2]=er,g[we+12>>2]=f,g[we+24>>2]=0}while(0);return er=F+8|0,nt=Sn,er|0}else $e=pe}else $e=pe;else $e=-1;while(0);if(d=g[5859]|0,d>>>0>=$e>>>0)return f=d-$e|0,h=g[5862]|0,f>>>0>15?(er=h+$e|0,g[5862]=er,g[5859]=f,g[er+4>>2]=f|1,g[h+d>>2]=f,g[h+4>>2]=$e|3):(g[5859]=0,g[5862]=0,g[h+4>>2]=d|3,er=h+d+4|0,g[er>>2]=g[er>>2]|1),er=h+8|0,nt=Sn,er|0;if(O=g[5860]|0,O>>>0>$e>>>0)return fr=O-$e|0,g[5860]=fr,er=g[5863]|0,ur=er+$e|0,g[5863]=ur,g[ur+4>>2]=fr|1,g[er+4>>2]=$e|3,er=er+8|0,nt=Sn,er|0;if(g[5975]|0?h=g[5977]|0:(g[5977]=4096,g[5976]=4096,g[5978]=-1,g[5979]=-1,g[5980]=0,g[5968]=0,g[5975]=At&-16^1431655768,h=4096),F=$e+48|0,$=$e+47|0,M=h+$|0,S=0-h|0,pe=M&S,pe>>>0<=$e>>>0||(h=g[5967]|0,h|0&&(we=g[5965]|0,At=we+pe|0,At>>>0<=we>>>0|At>>>0>h>>>0)))return er=0,nt=Sn,er|0;e:do if(g[5968]&4)f=0,zt=143;else{d=g[5863]|0;t:do if(d){for(E=23876;At=g[E>>2]|0,!(At>>>0<=d>>>0&&(At+(g[E+4>>2]|0)|0)>>>0>d>>>0);)if(h=g[E+8>>2]|0,h)E=h;else{zt=128;break t}if(f=M-O&S,f>>>0<2147483647)if(h=ut(f|0)|0,(h|0)==((g[E>>2]|0)+(g[E+4>>2]|0)|0)){if((h|0)!=-1){O=f,M=h,zt=145;break e}}else E=h,zt=136;else f=0}else zt=128;while(0);do if((zt|0)==128)if(d=ut(0)|0,(d|0)!=-1&&(f=d,Rt=g[5976]|0,_t=Rt+-1|0,f=(_t&f|0?(_t+f&0-Rt)-f|0:0)+pe|0,Rt=g[5965]|0,_t=f+Rt|0,f>>>0>$e>>>0&f>>>0<2147483647)){if(At=g[5967]|0,At|0&&_t>>>0<=Rt>>>0|_t>>>0>At>>>0){f=0;break}if(h=ut(f|0)|0,(h|0)==(d|0)){O=f,M=d,zt=145;break e}else E=h,zt=136}else f=0;while(0);do if((zt|0)==136){if(d=0-f|0,!(F>>>0>f>>>0&(f>>>0<2147483647&(E|0)!=-1)))if((E|0)==-1){f=0;break}else{O=f,M=E,zt=145;break e}if(h=g[5977]|0,h=$-f+h&0-h,h>>>0>=2147483647){O=f,M=E,zt=145;break e}if((ut(h|0)|0)==-1){ut(d|0)|0,f=0;break}else{O=h+f|0,M=E,zt=145;break e}}while(0);g[5968]=g[5968]|4,zt=143}while(0);if((zt|0)==143&&pe>>>0<2147483647&&(fr=ut(pe|0)|0,_t=ut(0)|0,xr=_t-fr|0,mr=xr>>>0>($e+40|0)>>>0,!((fr|0)==-1|mr^1|fr>>>0<_t>>>0&((fr|0)!=-1&(_t|0)!=-1)^1))&&(O=mr?xr:f,M=fr,zt=145),(zt|0)==145){f=(g[5965]|0)+O|0,g[5965]=f,f>>>0>(g[5966]|0)>>>0&&(g[5966]=f),$=g[5863]|0;e:do if($){for(f=23876;;){if(h=g[f>>2]|0,d=g[f+4>>2]|0,(M|0)==(h+d|0)){zt=154;break}if(E=g[f+8>>2]|0,E)f=E;else break}if((zt|0)==154&&(ur=f+4|0,(g[f+12>>2]&8|0)==0)&&M>>>0>$>>>0&h>>>0<=$>>>0){g[ur>>2]=d+O,er=(g[5860]|0)+O|0,fr=$+8|0,fr=fr&7|0?0-fr&7:0,ur=$+fr|0,fr=er-fr|0,g[5863]=ur,g[5860]=fr,g[ur+4>>2]=fr|1,g[$+er+4>>2]=40,g[5864]=g[5979];break}for(M>>>0<(g[5861]|0)>>>0&&(g[5861]=M),d=M+O|0,f=23876;;){if((g[f>>2]|0)==(d|0)){zt=162;break}if(h=g[f+8>>2]|0,h)f=h;else break}if((zt|0)==162&&!(g[f+12>>2]&8|0)){g[f>>2]=M,we=f+4|0,g[we>>2]=(g[we>>2]|0)+O,we=M+8|0,we=M+(we&7|0?0-we&7:0)|0,f=d+8|0,f=d+(f&7|0?0-f&7:0)|0,pe=we+$e|0,F=f-we-$e|0,g[we+4>>2]=$e|3;t:do if(($|0)==(f|0))er=(g[5860]|0)+F|0,g[5860]=er,g[5863]=pe,g[pe+4>>2]=er|1;else{if((g[5862]|0)==(f|0)){er=(g[5859]|0)+F|0,g[5859]=er,g[5862]=pe,g[pe+4>>2]=er|1,g[pe+er>>2]=er;break}if(h=g[f+4>>2]|0,(h&3|0)==1){O=h&-8,E=h>>>3;r:do if(h>>>0<256)if(h=g[f+8>>2]|0,d=g[f+12>>2]|0,(d|0)==(h|0)){g[5857]=g[5857]&~(1<<E);break}else{g[h+12>>2]=d,g[d+8>>2]=h;break}else{M=g[f+24>>2]|0,h=g[f+12>>2]|0;do if((h|0)==(f|0)){if(d=f+16|0,E=d+4|0,h=g[E>>2]|0,h)d=E;else if(h=g[d>>2]|0,!h){h=0;break}for(;;)if(S=h+20|0,E=g[S>>2]|0,E)h=E,d=S;else if(S=h+16|0,E=g[S>>2]|0,E)h=E,d=S;else break;g[d>>2]=0}else er=g[f+8>>2]|0,g[er+12>>2]=h,g[h+8>>2]=er;while(0);if(!M)break;d=g[f+28>>2]|0,E=23732+(d<<2)|0;do if((g[E>>2]|0)!=(f|0)){if(er=M+16|0,g[((g[er>>2]|0)==(f|0)?er:M+20|0)>>2]=h,!h)break r}else{if(g[E>>2]=h,h|0)break;g[5858]=g[5858]&~(1<<d);break r}while(0);if(g[h+24>>2]=M,d=f+16|0,E=g[d>>2]|0,E|0&&(g[h+16>>2]=E,g[E+24>>2]=h),d=g[d+4>>2]|0,!d)break;g[h+20>>2]=d,g[d+24>>2]=h}while(0);f=f+O|0,S=O+F|0}else S=F;if(f=f+4|0,g[f>>2]=g[f>>2]&-2,g[pe+4>>2]=S|1,g[pe+S>>2]=S,f=S>>>3,S>>>0<256){d=23468+(f<<1<<2)|0,h=g[5857]|0,f=1<<f,h&f?(h=d+8|0,f=g[h>>2]|0):(g[5857]=h|f,f=d,h=d+8|0),g[h>>2]=pe,g[f+12>>2]=pe,g[pe+8>>2]=f,g[pe+12>>2]=d;break}f=S>>>8;do if(!f)E=0;else{if(S>>>0>16777215){E=31;break}ur=(f+1048320|0)>>>16&8,er=f<<ur,fr=(er+520192|0)>>>16&4,er=er<<fr,E=(er+245760|0)>>>16&2,E=14-(fr|ur|E)+(er<<E>>>15)|0,E=S>>>(E+7|0)&1|E<<1}while(0);if(f=23732+(E<<2)|0,g[pe+28>>2]=E,h=pe+16|0,g[h+4>>2]=0,g[h>>2]=0,h=g[5858]|0,d=1<<E,!(h&d)){g[5858]=h|d,g[f>>2]=pe,g[pe+24>>2]=f,g[pe+12>>2]=pe,g[pe+8>>2]=pe;break}f=g[f>>2]|0;r:do if((g[f+4>>2]&-8|0)!=(S|0)){for(E=S<<((E|0)==31?0:25-(E>>>1)|0);d=f+16+(E>>>31<<2)|0,h=g[d>>2]|0,!!h;)if((g[h+4>>2]&-8|0)==(S|0)){f=h;break r}else E=E<<1,f=h;g[d>>2]=pe,g[pe+24>>2]=f,g[pe+12>>2]=pe,g[pe+8>>2]=pe;break t}while(0);ur=f+8|0,er=g[ur>>2]|0,g[er+12>>2]=pe,g[ur>>2]=pe,g[pe+8>>2]=er,g[pe+12>>2]=f,g[pe+24>>2]=0}while(0);return er=we+8|0,nt=Sn,er|0}for(f=23876;h=g[f>>2]|0,!(h>>>0<=$>>>0&&(er=h+(g[f+4>>2]|0)|0,er>>>0>$>>>0));)f=g[f+8>>2]|0;S=er+-47|0,h=S+8|0,h=S+(h&7|0?0-h&7:0)|0,S=$+16|0,h=h>>>0<S>>>0?$:h,f=h+8|0,d=O+-40|0,fr=M+8|0,fr=fr&7|0?0-fr&7:0,ur=M+fr|0,fr=d-fr|0,g[5863]=ur,g[5860]=fr,g[ur+4>>2]=fr|1,g[M+d+4>>2]=40,g[5864]=g[5979],d=h+4|0,g[d>>2]=27,g[f>>2]=g[5969],g[f+4>>2]=g[5970],g[f+8>>2]=g[5971],g[f+12>>2]=g[5972],g[5969]=M,g[5970]=O,g[5972]=0,g[5971]=f,f=h+24|0;do ur=f,f=f+4|0,g[f>>2]=7;while((ur+8|0)>>>0<er>>>0);if((h|0)!=($|0)){if(M=h-$|0,g[d>>2]=g[d>>2]&-2,g[$+4>>2]=M|1,g[h>>2]=M,f=M>>>3,M>>>0<256){d=23468+(f<<1<<2)|0,h=g[5857]|0,f=1<<f,h&f?(h=d+8|0,f=g[h>>2]|0):(g[5857]=h|f,f=d,h=d+8|0),g[h>>2]=$,g[f+12>>2]=$,g[$+8>>2]=f,g[$+12>>2]=d;break}if(f=M>>>8,f?M>>>0>16777215?E=31:(ur=(f+1048320|0)>>>16&8,er=f<<ur,fr=(er+520192|0)>>>16&4,er=er<<fr,E=(er+245760|0)>>>16&2,E=14-(fr|ur|E)+(er<<E>>>15)|0,E=M>>>(E+7|0)&1|E<<1):E=0,d=23732+(E<<2)|0,g[$+28>>2]=E,g[$+20>>2]=0,g[S>>2]=0,f=g[5858]|0,h=1<<E,!(f&h)){g[5858]=f|h,g[d>>2]=$,g[$+24>>2]=d,g[$+12>>2]=$,g[$+8>>2]=$;break}f=g[d>>2]|0;t:do if((g[f+4>>2]&-8|0)!=(M|0)){for(E=M<<((E|0)==31?0:25-(E>>>1)|0);d=f+16+(E>>>31<<2)|0,h=g[d>>2]|0,!!h;)if((g[h+4>>2]&-8|0)==(M|0)){f=h;break t}else E=E<<1,f=h;g[d>>2]=$,g[$+24>>2]=f,g[$+12>>2]=$,g[$+8>>2]=$;break e}while(0);ur=f+8|0,er=g[ur>>2]|0,g[er+12>>2]=$,g[ur>>2]=$,g[$+8>>2]=er,g[$+12>>2]=f,g[$+24>>2]=0}}else er=g[5861]|0,(er|0)==0|M>>>0<er>>>0&&(g[5861]=M),g[5969]=M,g[5970]=O,g[5972]=0,g[5866]=g[5975],g[5865]=-1,g[5870]=23468,g[5869]=23468,g[5872]=23476,g[5871]=23476,g[5874]=23484,g[5873]=23484,g[5876]=23492,g[5875]=23492,g[5878]=23500,g[5877]=23500,g[5880]=23508,g[5879]=23508,g[5882]=23516,g[5881]=23516,g[5884]=23524,g[5883]=23524,g[5886]=23532,g[5885]=23532,g[5888]=23540,g[5887]=23540,g[5890]=23548,g[5889]=23548,g[5892]=23556,g[5891]=23556,g[5894]=23564,g[5893]=23564,g[5896]=23572,g[5895]=23572,g[5898]=23580,g[5897]=23580,g[5900]=23588,g[5899]=23588,g[5902]=23596,g[5901]=23596,g[5904]=23604,g[5903]=23604,g[5906]=23612,g[5905]=23612,g[5908]=23620,g[5907]=23620,g[5910]=23628,g[5909]=23628,g[5912]=23636,g[5911]=23636,g[5914]=23644,g[5913]=23644,g[5916]=23652,g[5915]=23652,g[5918]=23660,g[5917]=23660,g[5920]=23668,g[5919]=23668,g[5922]=23676,g[5921]=23676,g[5924]=23684,g[5923]=23684,g[5926]=23692,g[5925]=23692,g[5928]=23700,g[5927]=23700,g[5930]=23708,g[5929]=23708,g[5932]=23716,g[5931]=23716,er=O+-40|0,fr=M+8|0,fr=fr&7|0?0-fr&7:0,ur=M+fr|0,fr=er-fr|0,g[5863]=ur,g[5860]=fr,g[ur+4>>2]=fr|1,g[M+er+4>>2]=40,g[5864]=g[5979];while(0);if(f=g[5860]|0,f>>>0>$e>>>0)return fr=f-$e|0,g[5860]=fr,er=g[5863]|0,ur=er+$e|0,g[5863]=ur,g[ur+4>>2]=fr|1,g[er+4>>2]=$e|3,er=er+8|0,nt=Sn,er|0}return er=Ns()|0,g[er>>2]=12,er=0,nt=Sn,er|0}function pn(h){h=h|0;var f=0,d=0,E=0,S=0,M=0,O=0,F=0,$=0;if(h){d=h+-8|0,S=g[5861]|0,h=g[h+-4>>2]|0,f=h&-8,$=d+f|0;do if(h&1)F=d,O=d;else{if(E=g[d>>2]|0,!(h&3)||(O=d+(0-E)|0,M=E+f|0,O>>>0<S>>>0))return;if((g[5862]|0)==(O|0)){if(h=$+4|0,f=g[h>>2]|0,(f&3|0)!=3){F=O,f=M;break}g[5859]=M,g[h>>2]=f&-2,g[O+4>>2]=M|1,g[O+M>>2]=M;return}if(d=E>>>3,E>>>0<256)if(h=g[O+8>>2]|0,f=g[O+12>>2]|0,(f|0)==(h|0)){g[5857]=g[5857]&~(1<<d),F=O,f=M;break}else{g[h+12>>2]=f,g[f+8>>2]=h,F=O,f=M;break}S=g[O+24>>2]|0,h=g[O+12>>2]|0;do if((h|0)==(O|0)){if(f=O+16|0,d=f+4|0,h=g[d>>2]|0,h)f=d;else if(h=g[f>>2]|0,!h){h=0;break}for(;;)if(E=h+20|0,d=g[E>>2]|0,d)h=d,f=E;else if(E=h+16|0,d=g[E>>2]|0,d)h=d,f=E;else break;g[f>>2]=0}else F=g[O+8>>2]|0,g[F+12>>2]=h,g[h+8>>2]=F;while(0);if(S){if(f=g[O+28>>2]|0,d=23732+(f<<2)|0,(g[d>>2]|0)==(O|0)){if(g[d>>2]=h,!h){g[5858]=g[5858]&~(1<<f),F=O,f=M;break}}else if(F=S+16|0,g[((g[F>>2]|0)==(O|0)?F:S+20|0)>>2]=h,!h){F=O,f=M;break}g[h+24>>2]=S,f=O+16|0,d=g[f>>2]|0,d|0&&(g[h+16>>2]=d,g[d+24>>2]=h),f=g[f+4>>2]|0,f?(g[h+20>>2]=f,g[f+24>>2]=h,F=O,f=M):(F=O,f=M)}else F=O,f=M}while(0);if(!(O>>>0>=$>>>0)&&(h=$+4|0,E=g[h>>2]|0,!!(E&1))){if(E&2)g[h>>2]=E&-2,g[F+4>>2]=f|1,g[O+f>>2]=f,S=f;else{if((g[5863]|0)==($|0)){if($=(g[5860]|0)+f|0,g[5860]=$,g[5863]=F,g[F+4>>2]=$|1,(F|0)!=(g[5862]|0))return;g[5862]=0,g[5859]=0;return}if((g[5862]|0)==($|0)){$=(g[5859]|0)+f|0,g[5859]=$,g[5862]=O,g[F+4>>2]=$|1,g[O+$>>2]=$;return}S=(E&-8)+f|0,d=E>>>3;do if(E>>>0<256)if(f=g[$+8>>2]|0,h=g[$+12>>2]|0,(h|0)==(f|0)){g[5857]=g[5857]&~(1<<d);break}else{g[f+12>>2]=h,g[h+8>>2]=f;break}else{M=g[$+24>>2]|0,h=g[$+12>>2]|0;do if((h|0)==($|0)){if(f=$+16|0,d=f+4|0,h=g[d>>2]|0,h)f=d;else if(h=g[f>>2]|0,!h){d=0;break}for(;;)if(E=h+20|0,d=g[E>>2]|0,d)h=d,f=E;else if(E=h+16|0,d=g[E>>2]|0,d)h=d,f=E;else break;g[f>>2]=0,d=h}else d=g[$+8>>2]|0,g[d+12>>2]=h,g[h+8>>2]=d,d=h;while(0);if(M|0){if(h=g[$+28>>2]|0,f=23732+(h<<2)|0,(g[f>>2]|0)==($|0)){if(g[f>>2]=d,!d){g[5858]=g[5858]&~(1<<h);break}}else if(E=M+16|0,g[((g[E>>2]|0)==($|0)?E:M+20|0)>>2]=d,!d)break;g[d+24>>2]=M,h=$+16|0,f=g[h>>2]|0,f|0&&(g[d+16>>2]=f,g[f+24>>2]=d),h=g[h+4>>2]|0,h|0&&(g[d+20>>2]=h,g[h+24>>2]=d)}}while(0);if(g[F+4>>2]=S|1,g[O+S>>2]=S,(F|0)==(g[5862]|0)){g[5859]=S;return}}if(h=S>>>3,S>>>0<256){d=23468+(h<<1<<2)|0,f=g[5857]|0,h=1<<h,f&h?(f=d+8|0,h=g[f>>2]|0):(g[5857]=f|h,h=d,f=d+8|0),g[f>>2]=F,g[h+12>>2]=F,g[F+8>>2]=h,g[F+12>>2]=d;return}h=S>>>8,h?S>>>0>16777215?E=31:(O=(h+1048320|0)>>>16&8,$=h<<O,M=($+520192|0)>>>16&4,$=$<<M,E=($+245760|0)>>>16&2,E=14-(M|O|E)+($<<E>>>15)|0,E=S>>>(E+7|0)&1|E<<1):E=0,h=23732+(E<<2)|0,g[F+28>>2]=E,g[F+20>>2]=0,g[F+16>>2]=0,f=g[5858]|0,d=1<<E;e:do if(!(f&d))g[5858]=f|d,g[h>>2]=F,g[F+24>>2]=h,g[F+12>>2]=F,g[F+8>>2]=F;else{h=g[h>>2]|0;t:do if((g[h+4>>2]&-8|0)!=(S|0)){for(E=S<<((E|0)==31?0:25-(E>>>1)|0);d=h+16+(E>>>31<<2)|0,f=g[d>>2]|0,!!f;)if((g[f+4>>2]&-8|0)==(S|0)){h=f;break t}else E=E<<1,h=f;g[d>>2]=F,g[F+24>>2]=h,g[F+12>>2]=F,g[F+8>>2]=F;break e}while(0);O=h+8|0,$=g[O>>2]|0,g[$+12>>2]=F,g[O>>2]=F,g[F+8>>2]=$,g[F+12>>2]=h,g[F+24>>2]=0}while(0);if($=(g[5865]|0)+-1|0,g[5865]=$,!($|0)){for(h=23884;h=g[h>>2]|0,h;)h=h+8|0;g[5865]=-1}}}}function Mn(h,f){h=h|0,f=f|0;var d=0;return h?(d=Ci(f,h)|0,(f|h)>>>0>65535&&(d=((d>>>0)/(h>>>0)|0|0)==(f|0)?d:-1)):d=0,h=to(d)|0,!h||!(g[h+-4>>2]&3)||Bt(h|0,0,d|0)|0,h|0}function vn(h,f,d,E){return h=h|0,f=f|0,d=d|0,E=E|0,d=h+d>>>0,zi(f+E+(d>>>0<h>>>0|0)>>>0|0),d|0|0}function si(h,f,d,E){return h=h|0,f=f|0,d=d|0,E=E|0,E=f-E-(d>>>0>h>>>0|0)>>>0,zi(E|0),h-d>>>0|0|0}function go(h){return h=h|0,(h?31-(Nl(h^h-1)|0)|0:32)|0}function pl(h,f,d,E,S){h=h|0,f=f|0,d=d|0,E=E|0,S=S|0;var M=0,O=0,F=0,$=0,pe=0,we=0,$e=0,At=0,Rt=0,_t=0;if(we=h,$=f,pe=$,O=d,At=E,F=At,!pe)return M=(S|0)!=0,F?M?(g[S>>2]=h|0,g[S+4>>2]=f&0,At=0,S=0,zi(At|0),S|0):(At=0,S=0,zi(At|0),S|0):(M&&(g[S>>2]=(we>>>0)%(O>>>0),g[S+4>>2]=0),At=0,S=(we>>>0)/(O>>>0)>>>0,zi(At|0),S|0);M=(F|0)==0;do if(O){if(!M){if(M=(Nl(F|0)|0)-(Nl(pe|0)|0)|0,M>>>0<=31){$e=M+1|0,F=31-M|0,f=M-31>>31,O=$e,h=we>>>($e>>>0)&f|pe<<F,f=pe>>>($e>>>0)&f,M=0,F=we<<F;break}return S?(g[S>>2]=h|0,g[S+4>>2]=$|f&0,At=0,S=0,zi(At|0),S|0):(At=0,S=0,zi(At|0),S|0)}if(M=O-1|0,M&O|0){F=(Nl(O|0)|0)+33-(Nl(pe|0)|0)|0,_t=64-F|0,$e=32-F|0,$=$e>>31,Rt=F-32|0,f=Rt>>31,O=F,h=$e-1>>31&pe>>>(Rt>>>0)|(pe<<$e|we>>>(F>>>0))&f,f=f&pe>>>(F>>>0),M=we<<_t&$,F=(pe<<_t|we>>>(Rt>>>0))&$|we<<$e&F-33>>31;break}return S|0&&(g[S>>2]=M&we,g[S+4>>2]=0),(O|0)==1?(Rt=$|f&0,_t=h|0|0,zi(Rt|0),_t|0):(_t=go(O|0)|0,Rt=pe>>>(_t>>>0)|0,_t=pe<<32-_t|we>>>(_t>>>0)|0,zi(Rt|0),_t|0)}else{if(M)return S|0&&(g[S>>2]=(pe>>>0)%(O>>>0),g[S+4>>2]=0),Rt=0,_t=(pe>>>0)/(O>>>0)>>>0,zi(Rt|0),_t|0;if(!we)return S|0&&(g[S>>2]=0,g[S+4>>2]=(pe>>>0)%(F>>>0)),Rt=0,_t=(pe>>>0)/(F>>>0)>>>0,zi(Rt|0),_t|0;if(M=F-1|0,!(M&F))return S|0&&(g[S>>2]=h|0,g[S+4>>2]=M&pe|f&0),Rt=0,_t=pe>>>((go(F|0)|0)>>>0),zi(Rt|0),_t|0;if(M=(Nl(F|0)|0)-(Nl(pe|0)|0)|0,M>>>0<=30){f=M+1|0,F=31-M|0,O=f,h=pe<<F|we>>>(f>>>0),f=pe>>>(f>>>0),M=0,F=we<<F;break}return S?(g[S>>2]=h|0,g[S+4>>2]=$|f&0,Rt=0,_t=0,zi(Rt|0),_t|0):(Rt=0,_t=0,zi(Rt|0),_t|0)}while(0);if(!O)pe=F,$=0,F=0;else{$e=d|0|0,we=At|E&0,pe=vn($e|0,we|0,-1,-1)|0,d=ct()|0,$=F,F=0;do E=$,$=M>>>31|$<<1,M=F|M<<1,E=h<<1|E>>>31|0,At=h>>>31|f<<1|0,si(pe|0,d|0,E|0,At|0)|0,_t=ct()|0,Rt=_t>>31|((_t|0)<0?-1:0)<<1,F=Rt&1,h=si(E|0,At|0,Rt&$e|0,(((_t|0)<0?-1:0)>>31|((_t|0)<0?-1:0)<<1)&we|0)|0,f=ct()|0,O=O-1|0;while(O|0);pe=$,$=0}return O=0,S|0&&(g[S>>2]=h,g[S+4>>2]=f),Rt=(M|0)>>>31|(pe|O)<<1|(O<<1|M>>>31)&0|$,_t=(M<<1|0)&-2|F,zi(Rt|0),_t|0}function ht(h,f,d,E){h=h|0,f=f|0,d=d|0,E=E|0;var S=0,M=0,O=0,F=0,$=0,pe=0;return pe=f>>31|((f|0)<0?-1:0)<<1,$=((f|0)<0?-1:0)>>31|((f|0)<0?-1:0)<<1,M=E>>31|((E|0)<0?-1:0)<<1,S=((E|0)<0?-1:0)>>31|((E|0)<0?-1:0)<<1,F=si(pe^h|0,$^f|0,pe|0,$|0)|0,O=ct()|0,h=M^pe,f=S^$,si((pl(F,O,si(M^d|0,S^E|0,M|0,S|0)|0,ct()|0,0)|0)^h|0,(ct()|0)^f|0,h|0,f|0)|0}function Tt(h,f){h=h|0,f=f|0;var d=0,E=0,S=0,M=0;return M=h&65535,S=f&65535,d=Ci(S,M)|0,E=h>>>16,h=(d>>>16)+(Ci(S,E)|0)|0,S=f>>>16,f=Ci(S,M)|0,zi((h>>>16)+(Ci(S,E)|0)+(((h&65535)+f|0)>>>16)|0),h+f<<16|d&65535|0|0}function Xt(h,f,d,E){h=h|0,f=f|0,d=d|0,E=E|0;var S=0,M=0;return S=h,M=d,d=Tt(S,M)|0,h=ct()|0,zi((Ci(f,M)|0)+(Ci(E,S)|0)+h|h&0|0),d|0|0|0}function xt(h,f,d,E){h=h|0,f=f|0,d=d|0,E=E|0;var S=0,M=0,O=0,F=0,$=0,pe=0;return S=nt,nt=nt+16|0,F=S|0,O=f>>31|((f|0)<0?-1:0)<<1,M=((f|0)<0?-1:0)>>31|((f|0)<0?-1:0)<<1,pe=E>>31|((E|0)<0?-1:0)<<1,$=((E|0)<0?-1:0)>>31|((E|0)<0?-1:0)<<1,h=si(O^h|0,M^f|0,O|0,M|0)|0,f=ct()|0,pl(h,f,si(pe^d|0,$^E|0,pe|0,$|0)|0,ct()|0,F)|0,E=si(g[F>>2]^O|0,g[F+4>>2]^M|0,O|0,M|0)|0,d=ct()|0,nt=S,zi(d|0),E|0}function di(h,f,d,E){h=h|0,f=f|0,d=d|0,E=E|0;var S=0,M=0;return M=nt,nt=nt+16|0,S=M|0,pl(h,f,d,E,S)|0,nt=M,zi(g[S+4>>2]|0),g[S>>2]|0|0}function Da(h,f,d){return h=h|0,f=f|0,d=d|0,(d|0)<32?(zi(f>>d|0),h>>>d|(f&(1<<d)-1)<<32-d):(zi(((f|0)<0?-1:0)|0),f>>d-32|0)}function Oe(h,f,d){return h=h|0,f=f|0,d=d|0,(d|0)<32?(zi(f>>>d|0),h>>>d|(f&(1<<d)-1)<<32-d):(zi(0),f>>>d-32|0)}function Ve(h,f,d){return h=h|0,f=f|0,d=d|0,(d|0)<32?(zi(f<<d|(h&(1<<d)-1<<32-d)>>>32-d|0),h<<d):(zi(h<<d-32|0),0)}function ft(h,f){return h=+h,f=+f,h!=h?+f:f!=f?+h:+je(+h,+f)}function $t(h,f){return h=+h,f=+f,h!=h?+f:f!=f?+h:+gn(+h,+f)}function tr(h){return h=+h,h>=0?+oo(h+.5):+Ki(h-.5)}function wt(h,f,d){h=h|0,f=f|0,d=d|0;var E=0,S=0,M=0;if((d|0)>=8192)return cf(h|0,f|0,d|0)|0,h|0;if(M=h|0,S=h+d|0,(h&3)==(f&3)){for(;h&3;){if(!d)return M|0;br[h>>0]=br[f>>0]|0,h=h+1|0,f=f+1|0,d=d-1|0}for(d=S&-4|0,E=d-64|0;(h|0)<=(E|0);)g[h>>2]=g[f>>2],g[h+4>>2]=g[f+4>>2],g[h+8>>2]=g[f+8>>2],g[h+12>>2]=g[f+12>>2],g[h+16>>2]=g[f+16>>2],g[h+20>>2]=g[f+20>>2],g[h+24>>2]=g[f+24>>2],g[h+28>>2]=g[f+28>>2],g[h+32>>2]=g[f+32>>2],g[h+36>>2]=g[f+36>>2],g[h+40>>2]=g[f+40>>2],g[h+44>>2]=g[f+44>>2],g[h+48>>2]=g[f+48>>2],g[h+52>>2]=g[f+52>>2],g[h+56>>2]=g[f+56>>2],g[h+60>>2]=g[f+60>>2],h=h+64|0,f=f+64|0;for(;(h|0)<(d|0);)g[h>>2]=g[f>>2],h=h+4|0,f=f+4|0}else for(d=S-4|0;(h|0)<(d|0);)br[h>>0]=br[f>>0]|0,br[h+1>>0]=br[f+1>>0]|0,br[h+2>>0]=br[f+2>>0]|0,br[h+3>>0]=br[f+3>>0]|0,h=h+4|0,f=f+4|0;for(;(h|0)<(S|0);)br[h>>0]=br[f>>0]|0,h=h+1|0,f=f+1|0;return M|0}function Bt(h,f,d){h=h|0,f=f|0,d=d|0;var E=0,S=0,M=0,O=0;if(M=h+d|0,f=f&255,(d|0)>=67){for(;h&3;)br[h>>0]=f,h=h+1|0;for(E=M&-4|0,O=f|f<<8|f<<16|f<<24,S=E-64|0;(h|0)<=(S|0);)g[h>>2]=O,g[h+4>>2]=O,g[h+8>>2]=O,g[h+12>>2]=O,g[h+16>>2]=O,g[h+20>>2]=O,g[h+24>>2]=O,g[h+28>>2]=O,g[h+32>>2]=O,g[h+36>>2]=O,g[h+40>>2]=O,g[h+44>>2]=O,g[h+48>>2]=O,g[h+52>>2]=O,g[h+56>>2]=O,g[h+60>>2]=O,h=h+64|0;for(;(h|0)<(E|0);)g[h>>2]=O,h=h+4|0}for(;(h|0)<(M|0);)br[h>>0]=f,h=h+1|0;return M-d|0}function Dt(h){return h=+h,h>=0?+oo(h+.5):+Ki(h-.5)}function ut(h){h=h|0;var f=0,d=0,E=0;return E=Nh()|0,d=g[Eo>>2]|0,f=d+h|0,(h|0)>0&(f|0)<(d|0)|(f|0)<0?(Dh(f|0)|0,lf(12),-1):(f|0)>(E|0)&&!(y0(f|0)|0)?(lf(12),-1):(g[Eo>>2]=f,d|0)}return{___divdi3:ht,___muldi3:Xt,___remdi3:xt,___uremdi3:di,_areNeighborCells:rh,_bitshift64Ashr:Da,_bitshift64Lshr:Oe,_bitshift64Shl:Ve,_calloc:Mn,_cellAreaKm2:xc,_cellAreaM2:Su,_cellAreaRads2:zf,_cellToBoundary:Yc,_cellToCenterChild:Ec,_cellToChildPos:Po,_cellToChildren:yc,_cellToChildrenSize:vf,_cellToLatLng:Sc,_cellToLocalIj:Br,_cellToParent:_c,_cellToVertex:qn,_cellToVertexes:ga,_cellsToDirectedEdge:bA,_cellsToLinkedMultiPolygon:eh,_childPosToCell:Js,_compactCells:i0,_destroyLinkedMultiPolygon:lr,_directedEdgeToBoundary:Vc,_directedEdgeToCells:Gc,_edgeLengthKm:Je,_edgeLengthM:Et,_edgeLengthRads:Te,_emscripten_replace_memory:Lf,_free:pn,_getBaseCellNumber:Wc,_getDirectedEdgeDestination:Gh,_getDirectedEdgeOrigin:Up,_getHexagonAreaAvgKm2:O0,_getHexagonAreaAvgM2:N0,_getHexagonEdgeLengthAvgKm:sh,_getHexagonEdgeLengthAvgM:Ef,_getIcosahedronFaces:I0,_getNumCells:Zf,_getPentagons:Bl,_getRes0Cells:ec,_getResolution:tc,_greatCircleDistanceKm:Al,_greatCircleDistanceM:u0,_greatCircleDistanceRads:_f,_gridDisk:Ff,_gridDiskDistances:q0,_gridDistance:Kr,_gridPathCells:jr,_gridPathCellsSize:Dr,_gridRingUnsafe:Lh,_i64Add:vn,_i64Subtract:si,_isPentagon:wa,_isResClassIII:jc,_isValidCell:df,_isValidDirectedEdge:RA,_isValidVertex:Wo,_latLngToCell:gf,_llvm_maxnum_f64:ft,_llvm_minnum_f64:$t,_llvm_round_f64:tr,_localIjToCell:Vr,_malloc:to,_maxFaceCount:o0,_maxGridDiskSize:Q0,_maxPolygonToCellsSize:x0,_memcpy:wt,_memset:Bt,_originToDirectedEdges:w0,_pentagonCount:Fu,_polygonToCells:Zc,_readInt64AsDoubleFromPointer:an,_res0CellCount:R0,_round:Dt,_sbrk:ut,_sizeOfCellBoundary:sn,_sizeOfCoordIJ:hi,_sizeOfGeoLoop:wr,_sizeOfGeoPolygon:en,_sizeOfH3Index:An,_sizeOfLatLng:Fr,_sizeOfLinkedGeoPolygon:Nn,_uncompactCells:ah,_uncompactCellsSize:Hh,_vertexToLatLng:Oo,establishStackSpace:S0,stackAlloc:E0,stackRestore:$0,stackSave:Y0}}(Nu,yu,wi),fo=Ye.___divdi3=Gr.___divdi3,of=Ye.___muldi3=Gr.___muldi3,hc=Ye.___remdi3=Gr.___remdi3,Zo=Ye.___uremdi3=Gr.___uremdi3,sl=Ye._areNeighborCells=Gr._areNeighborCells,Zu=Ye._bitshift64Ashr=Gr._bitshift64Ashr,$l=Ye._bitshift64Lshr=Gr._bitshift64Lshr,Ps=Ye._bitshift64Shl=Gr._bitshift64Shl,Du=Ye._calloc=Gr._calloc,Il=Ye._cellAreaKm2=Gr._cellAreaKm2,Ac=Ye._cellAreaM2=Gr._cellAreaM2,Oh=Ye._cellAreaRads2=Gr._cellAreaRads2,_0=Ye._cellToBoundary=Gr._cellToBoundary,ul=Ye._cellToCenterChild=Gr._cellToCenterChild,zu=Ye._cellToChildPos=Gr._cellToChildPos,_s=Ye._cellToChildren=Gr._cellToChildren,Ql=Ye._cellToChildrenSize=Gr._cellToChildrenSize,zo=Ye._cellToLatLng=Gr._cellToLatLng,Gu=Ye._cellToLocalIj=Gr._cellToLocalIj,ll=Ye._cellToParent=Gr._cellToParent,sf=Ye._cellToVertex=Gr._cellToVertex,pc=Ye._cellToVertexes=Gr._cellToVertexes,Vu=Ye._cellsToDirectedEdge=Gr._cellsToDirectedEdge,Hu=Ye._cellsToLinkedMultiPolygon=Gr._cellsToLinkedMultiPolygon,wo=Ye._childPosToCell=Gr._childPosToCell,Wu=Ye._compactCells=Gr._compactCells,ss=Ye._destroyLinkedMultiPolygon=Gr._destroyLinkedMultiPolygon,X0=Ye._directedEdgeToBoundary=Gr._directedEdgeToBoundary,Pl=Ye._directedEdgeToCells=Gr._directedEdgeToCells,Uc=Ye._edgeLengthKm=Gr._edgeLengthKm,us=Ye._edgeLengthM=Gr._edgeLengthM,ys=Ye._edgeLengthRads=Gr._edgeLengthRads,qs=Ye._emscripten_replace_memory=Gr._emscripten_replace_memory,Os=Ye._free=Gr._free,Nf=Ye._getBaseCellNumber=Gr._getBaseCellNumber,fu=Ye._getDirectedEdgeDestination=Gr._getDirectedEdgeDestination,ls=Ye._getDirectedEdgeOrigin=Gr._getDirectedEdgeOrigin,Io=Ye._getHexagonAreaAvgKm2=Gr._getHexagonAreaAvgKm2,uf=Ye._getHexagonAreaAvgM2=Gr._getHexagonAreaAvgM2,po=Ye._getHexagonEdgeLengthAvgKm=Gr._getHexagonEdgeLengthAvgKm,hr=Ye._getHexagonEdgeLengthAvgM=Gr._getHexagonEdgeLengthAvgM,St=Ye._getIcosahedronFaces=Gr._getIcosahedronFaces,ve=Ye._getNumCells=Gr._getNumCells,hu=Ye._getPentagons=Gr._getPentagons,it=Ye._getRes0Cells=Gr._getRes0Cells,Eu=Ye._getResolution=Gr._getResolution,Si=Ye._greatCircleDistanceKm=Gr._greatCircleDistanceKm,cl=Ye._greatCircleDistanceM=Gr._greatCircleDistanceM,va=Ye._greatCircleDistanceRads=Gr._greatCircleDistanceRads,pa=Ye._gridDisk=Gr._gridDisk,Bi=Ye._gridDiskDistances=Gr._gridDiskDistances,Go=Ye._gridDistance=Gr._gridDistance,qi=Ye._gridPathCells=Gr._gridPathCells,ni=Ye._gridPathCellsSize=Gr._gridPathCellsSize,Pi=Ye._gridRingUnsafe=Gr._gridRingUnsafe,oa=Ye._i64Add=Gr._i64Add,Ii=Ye._i64Subtract=Gr._i64Subtract,xi=Ye._isPentagon=Gr._isPentagon,Un=Ye._isResClassIII=Gr._isResClassIII,ii=Ye._isValidCell=Gr._isValidCell,ki=Ye._isValidDirectedEdge=Gr._isValidDirectedEdge,fi=Ye._isValidVertex=Gr._isValidVertex,Vi=Ye._latLngToCell=Gr._latLngToCell,ra=Ye._llvm_maxnum_f64=Gr._llvm_maxnum_f64,Dn=Ye._llvm_minnum_f64=Gr._llvm_minnum_f64,Hi=Ye._llvm_round_f64=Gr._llvm_round_f64,yi=Ye._localIjToCell=Gr._localIjToCell,na=Ye._malloc=Gr._malloc,Wi=Ye._maxFaceCount=Gr._maxFaceCount,ua=Ye._maxGridDiskSize=Gr._maxGridDiskSize,la=Ye._maxPolygonToCellsSize=Gr._maxPolygonToCellsSize,Ti=Ye._memcpy=Gr._memcpy,Ui=Ye._memset=Gr._memset,Zi=Ye._originToDirectedEdges=Gr._originToDirectedEdges,ia=Ye._pentagonCount=Gr._pentagonCount,Vn=Ye._polygonToCells=Gr._polygonToCells,ju=Ye._readInt64AsDoubleFromPointer=Gr._readInt64AsDoubleFromPointer,ql=Ye._res0CellCount=Gr._res0CellCount,Us=Ye._round=Gr._round,Lu=Ye._sbrk=Gr._sbrk,Qn=Ye._sizeOfCellBoundary=Gr._sizeOfCellBoundary,cs=Ye._sizeOfCoordIJ=Gr._sizeOfCoordIJ,Ol=Ye._sizeOfGeoLoop=Gr._sizeOfGeoLoop,fl=Ye._sizeOfGeoPolygon=Gr._sizeOfGeoPolygon,Zs=Ye._sizeOfH3Index=Gr._sizeOfH3Index,Kl=Ye._sizeOfLatLng=Gr._sizeOfLatLng,zs=Ye._sizeOfLinkedGeoPolygon=Gr._sizeOfLinkedGeoPolygon,$a=Ye._uncompactCells=Gr._uncompactCells,Jl=Ye._uncompactCellsSize=Gr._uncompactCellsSize,Df=Ye._vertexToLatLng=Gr._vertexToLatLng,o=Ye.establishStackSpace=Gr.establishStackSpace,u=Ye.stackAlloc=Gr.stackAlloc,v=Ye.stackRestore=Gr.stackRestore,y=Ye.stackSave=Gr.stackSave;if(Ye.asm=Gr,Ye.cwrap=Lc,Ye.setValue=Xs,Ye.getValue=If,Yo){Iu(Yo)||(Yo=Ht(Yo));{Qf("memory initializer");var b=function(st){st.byteLength&&(st=new Uint8Array(st)),io.set(st,Ms),Ye.memoryInitializerRequest&&delete Ye.memoryInitializerRequest.response,Ni("memory initializer")},H=function(){vr(Yo,b,function(){throw"could not load memory initializer "+Yo})},ne=ms(Yo);if(ne)b(ne.buffer);else if(Ye.memoryInitializerRequest){var Le=function(){var st=Ye.memoryInitializerRequest,Gt=st.response;if(st.status!==200&&st.status!==0){var ir=ms(Ye.memoryInitializerRequestURL);if(ir)Gt=ir.buffer;else{console.warn("a problem seems to have happened with Module.memoryInitializerRequest, status: "+st.status+", retrying "+Yo),H();return}}b(Gt)};Ye.memoryInitializerRequest.response?setTimeout(Le,0):Ye.memoryInitializerRequest.addEventListener("load",Le)}else H()}}var tt;ao=function st(){tt||Nt(),tt||(ao=st)};function Nt(st){if(st=st||Ue,ma>0||(wl(),ma>0))return;function Gt(){tt||(tt=!0,!uu&&(fc(),is(),Ye.onRuntimeInitialized&&Ye.onRuntimeInitialized(),cu()))}Ye.setStatus?(Ye.setStatus("Running..."),setTimeout(function(){setTimeout(function(){Ye.setStatus("")},1),Gt()},1)):Gt()}Ye.run=Nt;function ar(st){throw Ye.onAbort&&Ye.onAbort(st),st+="",Nr(st),mn(st),uu=!0,"abort("+st+"). Build with -s ASSERTIONS=1 for more info."}if(Ye.abort=ar,Ye.preInit)for(typeof Ye.preInit=="function"&&(Ye.preInit=[Ye.preInit]);Ye.preInit.length>0;)Ye.preInit.pop()();return Nt(),bt}(typeof I=="object"?I:{}),D="number",G=D,U=D,B=D,Z=D,X=D,q=D,ie=[["sizeOfH3Index",D],["sizeOfLatLng",D],["sizeOfCellBoundary",D],["sizeOfGeoLoop",D],["sizeOfGeoPolygon",D],["sizeOfLinkedGeoPolygon",D],["sizeOfCoordIJ",D],["readInt64AsDoubleFromPointer",D],["isValidCell",U,[B,Z]],["latLngToCell",G,[D,D,X,q]],["cellToLatLng",G,[B,Z,q]],["cellToBoundary",G,[B,Z,q]],["maxGridDiskSize",G,[D,q]],["gridDisk",G,[B,Z,D,q]],["gridDiskDistances",G,[B,Z,D,q,q]],["gridRingUnsafe",G,[B,Z,D,q]],["maxPolygonToCellsSize",G,[q,X,D,q]],["polygonToCells",G,[q,X,D,q]],["cellsToLinkedMultiPolygon",G,[q,D,q]],["destroyLinkedMultiPolygon",null,[q]],["compactCells",G,[q,q,D,D]],["uncompactCells",G,[q,D,D,q,D,X]],["uncompactCellsSize",G,[q,D,D,X,q]],["isPentagon",U,[B,Z]],["isResClassIII",U,[B,Z]],["getBaseCellNumber",D,[B,Z]],["getResolution",D,[B,Z]],["maxFaceCount",G,[B,Z,q]],["getIcosahedronFaces",G,[B,Z,q]],["cellToParent",G,[B,Z,X,q]],["cellToChildren",G,[B,Z,X,q]],["cellToCenterChild",G,[B,Z,X,q]],["cellToChildrenSize",G,[B,Z,X,q]],["cellToChildPos",G,[B,Z,X,q]],["childPosToCell",G,[D,D,B,Z,X,q]],["areNeighborCells",G,[B,Z,B,Z,q]],["cellsToDirectedEdge",G,[B,Z,B,Z,q]],["getDirectedEdgeOrigin",G,[B,Z,q]],["getDirectedEdgeDestination",G,[B,Z,q]],["isValidDirectedEdge",U,[B,Z]],["directedEdgeToCells",G,[B,Z,q]],["originToDirectedEdges",G,[B,Z,q]],["directedEdgeToBoundary",G,[B,Z,q]],["gridDistance",G,[B,Z,B,Z,q]],["gridPathCells",G,[B,Z,B,Z,q]],["gridPathCellsSize",G,[B,Z,B,Z,q]],["cellToLocalIj",G,[B,Z,B,Z,D,q]],["localIjToCell",G,[B,Z,q,D,q]],["getHexagonAreaAvgM2",G,[X,q]],["getHexagonAreaAvgKm2",G,[X,q]],["getHexagonEdgeLengthAvgM",G,[X,q]],["getHexagonEdgeLengthAvgKm",G,[X,q]],["greatCircleDistanceM",D,[q,q]],["greatCircleDistanceKm",D,[q,q]],["greatCircleDistanceRads",D,[q,q]],["cellAreaM2",G,[B,Z,q]],["cellAreaKm2",G,[B,Z,q]],["cellAreaRads2",G,[B,Z,q]],["edgeLengthM",G,[B,Z,q]],["edgeLengthKm",G,[B,Z,q]],["edgeLengthRads",G,[B,Z,q]],["getNumCells",G,[X,q]],["getRes0Cells",G,[q]],["res0CellCount",D],["getPentagons",G,[D,q]],["pentagonCount",D],["cellToVertex",G,[B,Z,D,q]],["cellToVertexes",G,[B,Z,q]],["vertexToLatLng",G,[B,Z,q]],["isValidVertex",U,[B,Z]]],he=0,Ce=1,be=2,Ze=3,qe=4,De=5,Ge=6,Re=7,Me=8,ce=9,Be=10,Ee=11,Se=12,oe=13,Y=14,Ne=15,ge={};ge[he]="Success",ge[Ce]="The operation failed but a more specific error is not available",ge[be]="Argument was outside of acceptable range",ge[Ze]="Latitude or longitude arguments were outside of acceptable range",ge[qe]="Resolution argument was outside of acceptable range",ge[De]="Cell argument was not valid",ge[Ge]="Directed edge argument was not valid",ge[Re]="Undirected edge argument was not valid",ge[Me]="Vertex argument was not valid",ge[ce]="Pentagon distortion was encountered",ge[Be]="Duplicate input",ge[Ee]="Cell arguments were not neighbors",ge[Se]="Cell arguments had incompatible resolutions",ge[oe]="Memory allocation failed",ge[Y]="Bounds of provided memory were insufficient",ge[Ne]="Mode or flags argument was not valid";var xe=1e3,ye=1001,Q=1002,Pe={};Pe[xe]="Unknown unit",Pe[ye]="Array length out of bounds",Pe[Q]="Got unexpected null value for H3 index";var Ae="Unknown error";function _e(bt,Ye,qt){var fe=qt&&"value"in qt,Ue=new Error((bt[Ye]||Ae)+" (code: "+Ye+(fe?", value: "+qt.value:"")+")");return Ue.code=Ye,Ue}function ue(bt,Ye){var qt=arguments.length===2?{value:Ye}:{};return _e(ge,bt,qt)}function ke(bt,Ye){var qt=arguments.length===2?{value:Ye}:{};return _e(Pe,bt,qt)}function ze(bt){if(bt!==0)throw ue(bt)}var le={};ie.forEach(function(Ye){le[Ye[0]]=I.cwrap.apply(I,Ye)});var Ut=16,kt=0,pr=4,Wt=4,Xr=8,fn=8,Ir=le.sizeOfH3Index(),Qr=le.sizeOfLatLng(),tn=le.sizeOfCellBoundary(),Mr=le.sizeOfGeoPolygon(),$n=le.sizeOfGeoLoop(),li=le.sizeOfLinkedGeoPolygon(),Kn=le.sizeOfCoordIJ(),$r={m:"m",m2:"m2",km:"km",km2:"km2",rads:"rads",rads2:"rads2"};function ln(bt){if(typeof bt!="number"||bt<0||bt>15||Math.floor(bt)!==bt)throw ue(qe,bt);return bt}function Cn(bt){if(!bt)throw ke(Q);return bt}var $i=Math.pow(2,32)-1;function ci(bt){if(bt>$i)throw ke(ye,bt);return bt}var Ft=/[^0-9a-fA-F]/;function te(bt){if(Array.isArray(bt)&&bt.length===2&&Number.isInteger(bt[0])&&Number.isInteger(bt[1]))return bt;if(typeof bt!="string"||Ft.test(bt))return[0,0];var Ye=parseInt(bt.substring(0,bt.length-8),Ut),qt=parseInt(bt.substring(bt.length-8),Ut);return[qt,Ye]}function We(bt){if(bt>=0)return bt.toString(Ut);bt=bt&2147483647;var Ye=vt(8,bt.toString(Ut)),qt=(parseInt(Ye[0],Ut)+8).toString(Ut);return Ye=qt+Ye.substring(1),Ye}function Qe(bt,Ye){return We(Ye)+vt(8,We(bt))}function vt(bt,Ye){for(var qt=bt-Ye.length,fe="",Ue=0;Ue<qt;Ue++)fe+="0";return fe=fe+Ye,fe}var Lt=Math.pow(2,32);function Pt(bt){return typeof bt!="number"?[0,0]:[bt|0,bt/Lt|0]}function Cr(bt,Ye,qt){for(var fe=bt.length,Ue=I._calloc(fe,Qr),Ke=qt?1:0,Ht=qt?0:1,vr=0;vr<fe*2;vr+=2)I.HEAPF64.set([bt[vr/2][Ke],bt[vr/2][Ht]].map(al),Ue/Xr+vr);return I.HEAPU32.set([fe,Ue],Ye/pr),Ye}function yt(bt,Ye){var qt=bt.length-1,fe=I._calloc(Mr),Ue=0,Ke=Ue+$n,Ht=Ke+pr;Cr(bt[0],fe+Ue,Ye);var vr;if(qt>0){vr=I._calloc(qt,$n);for(var Nr=0;Nr<qt;Nr++)Cr(bt[Nr+1],vr+$n*Nr,Ye)}return I.setValue(fe+Ke,qt,"i32"),I.setValue(fe+Ht,vr,"i32"),fe}function Ot(bt){var Ye=0,qt=Ye+$n,fe=qt+pr,Ue=pr;I._free(I.getValue(bt+Ye+Ue,"i8*"));var Ke=I.getValue(bt+qt,"i32");if(Ke>0){for(var Ht=I.getValue(bt+fe,"i32"),vr=0;vr<Ke;vr++)I._free(I.getValue(Ht+$n*vr+Ue,"i8*"));I._free(Ht)}I._free(bt)}function rr(bt,Ye){Ye===void 0&&(Ye=0);var qt=I.getValue(bt+Ir*Ye,"i32"),fe=I.getValue(bt+Ir*Ye+pr,"i32");return fe?Qe(qt,fe):null}function Sr(bt,Ye){Ye===void 0&&(Ye=0);var qt=I.getValue(bt+pr*Ye,"i32");return!!qt}function Lr(bt,Ye){return Ye===void 0&&(Ye=0),I.getValue(bt+Xr*Ye,"double")}function on(bt){return le.readInt64AsDoubleFromPointer(bt)}function hn(bt,Ye,qt){I.HEAPU32.set(te(bt),Ye/pr+2*qt)}function zr(bt,Ye){for(var qt=[],fe=0;fe<Ye;fe++){var Ue=rr(bt,fe);Ue!==null&&qt.push(Ue)}return qt}function rn(bt,Ye){for(var qt=Ye.length,fe=0;fe<qt;fe++)hn(Ye[fe],bt,fe)}function Wn(bt,Ye){var qt=I._calloc(1,Qr);return I.HEAPF64.set([bt,Ye].map(al),qt/Xr),qt}function jn(bt){return Ka(I.getValue(bt,"double"))}function mi(bt){return[jn(bt),jn(bt+Xr)]}function Ea(bt){return[jn(bt+Xr),jn(bt)]}function ja(bt,Ye,qt){for(var fe=I.getValue(bt,"i32"),Ue=bt+Xr,Ke=[],Ht=Ye?Ea:mi,vr=0;vr<fe*2;vr+=2)Ke.push(Ht(Ue+Xr*vr));return qt&&Ke.push(Ke[0]),Ke}function Wr(bt,Ye){for(var qt=[],fe=Ye?Ea:mi,Ue,Ke,Ht,vr;bt;){for(qt.push(Ue=[]),Ke=I.getValue(bt,"i8*");Ke;){for(Ue.push(Ht=[]),vr=I.getValue(Ke,"i8*");vr;)Ht.push(fe(vr)),vr=I.getValue(vr+Xr*2,"i8*");Ye&&Ht.push(Ht[0]),Ke=I.getValue(Ke+Wt*2,"i8*")}bt=I.getValue(bt+Wt*2,"i8*")}return qt}function no(bt){return{i:I.getValue(bt,"i32"),j:I.getValue(bt+pr,"i32")}}function Xo(bt,Ye){var qt=Ye.i,fe=Ye.j;I.setValue(bt,qt,"i32"),I.setValue(bt+pr,fe,"i32")}function Xn(bt,Ye){for(var qt=[],fe=0;fe<Ye;fe++){var Ue=I.getValue(bt+pr*fe,"i32");Ue>=0&&qt.push(Ue)}return qt}function Hs(bt){var Ye=te(bt),qt=Ye[0],fe=Ye[1];return!!le.isValidCell(qt,fe)}function Bo(bt){var Ye=te(bt),qt=Ye[0],fe=Ye[1];return!!le.isPentagon(qt,fe)}function iu(bt){var Ye=te(bt),qt=Ye[0],fe=Ye[1];return!!le.isResClassIII(qt,fe)}function ts(bt){var Ye=te(bt),qt=Ye[0],fe=Ye[1];return le.getBaseCellNumber(qt,fe)}function Vl(bt){var Ye=te(bt),qt=Ye[0],fe=Ye[1],Ue=I._malloc(pr);try{ze(le.maxFaceCount(qt,fe,Ue));var Ke=I.getValue(Ue,"i32"),Ht=I._malloc(pr*Ke);try{return ze(le.getIcosahedronFaces(qt,fe,Ht)),Xn(Ht,Ke)}finally{I._free(Ht)}}finally{I._free(Ue)}}function ku(bt){var Ye=te(bt),qt=Ye[0],fe=Ye[1];return le.isValidCell(qt,fe)?le.getResolution(qt,fe):-1}function Ds(bt,Ye,qt){var fe=I._malloc(Qr);I.HEAPF64.set([bt,Ye].map(al),fe/Xr);var Ue=I._malloc(Ir);try{return ze(le.latLngToCell(fe,qt,Ue)),Cn(rr(Ue))}finally{I._free(Ue),I._free(fe)}}function bs(bt){var Ye=I._malloc(Qr),qt=te(bt),fe=qt[0],Ue=qt[1];try{return ze(le.cellToLatLng(fe,Ue,Ye)),mi(Ye)}finally{I._free(Ye)}}function Fa(bt,Ye){var qt=I._malloc(tn),fe=te(bt),Ue=fe[0],Ke=fe[1];try{return ze(le.cellToBoundary(Ue,Ke,qt)),ja(qt,Ye,Ye)}finally{I._free(qt)}}function uc(bt,Ye){var qt=te(bt),fe=qt[0],Ue=qt[1],Ke=I._malloc(Ir);try{return ze(le.cellToParent(fe,Ue,Ye,Ke)),Cn(rr(Ke))}finally{I._free(Ke)}}function Uu(bt,Ye){if(!Hs(bt))return[];var qt=te(bt),fe=qt[0],Ue=qt[1],Ke=ci(ta(bt,Ye)),Ht=I._calloc(Ke,Ir);try{return ze(le.cellToChildren(fe,Ue,Ye,Ht)),zr(Ht,Ke)}finally{I._free(Ht)}}function ta(bt,Ye){if(!Hs(bt))throw ue(De);var qt=te(bt),fe=qt[0],Ue=qt[1],Ke=I._malloc(fn);try{return ze(le.cellToChildrenSize(fe,Ue,Ye,Ke)),on(Ke)}finally{I._free(Ke)}}function au(bt,Ye){var qt=te(bt),fe=qt[0],Ue=qt[1],Ke=I._malloc(Ir);try{return ze(le.cellToCenterChild(fe,Ue,Ye,Ke)),Cn(rr(Ke))}finally{I._free(Ke)}}function mo(bt,Ye){var qt=te(bt),fe=qt[0],Ue=qt[1],Ke=I._malloc(fn);try{return ze(le.cellToChildPos(fe,Ue,Ye,Ke)),on(Ke)}finally{I._free(Ke)}}function Rs(bt,Ye,qt){var fe=Pt(bt),Ue=fe[0],Ke=fe[1],Ht=te(Ye),vr=Ht[0],Nr=Ht[1],mn=I._malloc(Ir);try{return ze(le.childPosToCell(Ue,Ke,vr,Nr,qt,mn)),Cn(rr(mn))}finally{I._free(mn)}}function rs(bt,Ye){var qt=te(bt),fe=qt[0],Ue=qt[1],Ke=I._malloc(fn);try{ze(le.maxGridDiskSize(Ye,Ke));var Ht=ci(on(Ke)),vr=I._calloc(Ht,Ir);try{return ze(le.gridDisk(fe,Ue,Ye,vr)),zr(vr,Ht)}finally{I._free(vr)}}finally{I._free(Ke)}}function Qi(bt,Ye){var qt=te(bt),fe=qt[0],Ue=qt[1],Ke=I._malloc(fn);try{ze(le.maxGridDiskSize(Ye,Ke));var Ht=ci(on(Ke)),vr=I._calloc(Ht,Ir),Nr=I._calloc(Ht,pr);try{ze(le.gridDiskDistances(fe,Ue,Ye,vr,Nr));for(var mn=[],zn=0;zn<Ye+1;zn++)mn.push([]);for(var Mi=0;Mi<Ht;Mi++){var Ro=rr(vr,Mi),Ms=I.getValue(Nr+pr*Mi,"i32");Ro!==null&&mn[Ms].push(Ro)}return mn}finally{I._free(vr),I._free(Nr)}}finally{I._free(Ke)}}function _o(bt,Ye){var qt=Ye===0?1:6*Ye,fe=I._calloc(qt,Ir);try{return ze(le.gridRingUnsafe.apply(le,te(bt).concat([Ye],[fe]))),zr(fe,qt)}finally{I._free(fe)}}function Ws(bt,Ye,qt){if(ln(Ye),qt=!!qt,bt.length===0||bt[0].length===0)return[];var fe=typeof bt[0][0]=="number"?[bt]:bt,Ue=yt(fe,qt),Ke=I._malloc(fn);try{ze(le.maxPolygonToCellsSize(Ue,Ye,0,Ke));var Ht=ci(on(Ke)),vr=I._calloc(Ht,Ir);try{return ze(le.polygonToCells(Ue,Ye,0,vr)),zr(vr,Ht)}finally{I._free(vr)}}finally{I._free(Ke),Ot(Ue)}}function ds(bt,Ye){if(!bt||!bt.length)return[];var qt=bt.length,fe=I._calloc(qt,Ir);rn(fe,bt);var Ue=I._calloc(li);try{return ze(le.cellsToLinkedMultiPolygon(fe,qt,Ue)),Wr(Ue,Ye)}finally{le.destroyLinkedMultiPolygon(Ue),I._free(Ue),I._free(fe)}}function il(bt){if(!bt||!bt.length)return[];var Ye=bt.length,qt=I._calloc(Ye,Ir);rn(qt,bt);var fe=I._calloc(Ye,Ir);try{return ze(le.compactCells(qt,fe,Ye,kt)),zr(fe,Ye)}finally{I._free(qt),I._free(fe)}}function Ba(bt,Ye){if(ln(Ye),!bt||!bt.length)return[];var qt=bt.length,fe=I._calloc(qt,Ir);rn(fe,bt);var Ue=I._malloc(fn);try{ze(le.uncompactCellsSize(fe,qt,kt,Ye,Ue));var Ke=ci(on(Ue)),Ht=I._calloc(Ke,Ir);try{return ze(le.uncompactCells(fe,qt,kt,Ht,Ke,kt,Ye)),zr(Ht,Ke)}finally{I._free(fe),I._free(Ht)}}finally{I._free(Ue)}}function Oa(bt,Ye){var qt=te(bt),fe=qt[0],Ue=qt[1],Ke=te(Ye),Ht=Ke[0],vr=Ke[1],Nr=I._malloc(pr);try{return ze(le.areNeighborCells(fe,Ue,Ht,vr,Nr)),Sr(Nr)}finally{I._free(Nr)}}function Cl(bt,Ye){var qt=te(bt),fe=qt[0],Ue=qt[1],Ke=te(Ye),Ht=Ke[0],vr=Ke[1],Nr=I._malloc(Ir);try{return ze(le.cellsToDirectedEdge(fe,Ue,Ht,vr,Nr)),Cn(rr(Nr))}finally{I._free(Nr)}}function Co(bt){var Ye=te(bt),qt=Ye[0],fe=Ye[1],Ue=I._malloc(Ir);try{return ze(le.getDirectedEdgeOrigin(qt,fe,Ue)),Cn(rr(Ue))}finally{I._free(Ue)}}function gu(bt){var Ye=te(bt),qt=Ye[0],fe=Ye[1],Ue=I._malloc(Ir);try{return ze(le.getDirectedEdgeDestination(qt,fe,Ue)),Cn(rr(Ue))}finally{I._free(Ue)}}function ka(bt){var Ye=te(bt),qt=Ye[0],fe=Ye[1];return!!le.isValidDirectedEdge(qt,fe)}function Ru(bt){var Ye=te(bt),qt=Ye[0],fe=Ye[1],Ue=2,Ke=I._calloc(Ue,Ir);try{return ze(le.directedEdgeToCells(qt,fe,Ke)),zr(Ke,Ue)}finally{I._free(Ke)}}function cr(bt){var Ye=te(bt),qt=Ye[0],fe=Ye[1],Ue=6,Ke=I._calloc(Ue,Ir);try{return ze(le.originToDirectedEdges(qt,fe,Ke)),zr(Ke,Ue)}finally{I._free(Ke)}}function yn(bt,Ye){var qt=I._malloc(tn),fe=te(bt),Ue=fe[0],Ke=fe[1];try{return ze(le.directedEdgeToBoundary(Ue,Ke,qt)),ja(qt,Ye)}finally{I._free(qt)}}function bo(bt,Ye){var qt=te(bt),fe=qt[0],Ue=qt[1],Ke=te(Ye),Ht=Ke[0],vr=Ke[1],Nr=I._malloc(fn);try{return ze(le.gridDistance(fe,Ue,Ht,vr,Nr)),on(Nr)}finally{I._free(Nr)}}function mu(bt,Ye){var qt=te(bt),fe=qt[0],Ue=qt[1],Ke=te(Ye),Ht=Ke[0],vr=Ke[1],Nr=I._malloc(fn);try{ze(le.gridPathCellsSize(fe,Ue,Ht,vr,Nr));var mn=ci(on(Nr)),zn=I._calloc(mn,Ir);try{return le.gridPathCells(fe,Ue,Ht,vr,zn),zr(zn,mn)}finally{I._free(zn)}}finally{I._free(Nr)}}var _u=0;function js(bt,Ye){var qt=I._malloc(Kn);try{return ze(le.cellToLocalIj.apply(le,te(bt).concat(te(Ye),[_u],[qt]))),no(qt)}finally{I._free(qt)}}function ou(bt,Ye){if(!Ye||typeof Ye.i!="number"||typeof Ye.j!="number")throw new Error("Coordinates must be provided as an {i, j} object");var qt=I._malloc(Kn),fe=I._malloc(Ir);Xo(qt,Ye);try{return ze(le.localIjToCell.apply(le,te(bt).concat([qt],[_u],[fe]))),Cn(rr(fe))}finally{I._free(qt),I._free(fe)}}function qa(bt,Ye,qt){var fe=Wn(bt[0],bt[1]),Ue=Wn(Ye[0],Ye[1]),Ke;switch(qt){case $r.m:Ke=le.greatCircleDistanceM(fe,Ue);break;case $r.km:Ke=le.greatCircleDistanceKm(fe,Ue);break;case $r.rads:Ke=le.greatCircleDistanceRads(fe,Ue);break;default:Ke=null}if(I._free(fe),I._free(Ue),Ke===null)throw ke(xe,qt);return Ke}function lc(bt,Ye){var qt=te(bt),fe=qt[0],Ue=qt[1],Ke=I._malloc(Xr);try{switch(Ye){case $r.m2:ze(le.cellAreaM2(fe,Ue,Ke));break;case $r.km2:ze(le.cellAreaKm2(fe,Ue,Ke));break;case $r.rads2:ze(le.cellAreaRads2(fe,Ue,Ke));break;default:throw ke(xe,Ye)}return Lr(Ke)}finally{I._free(Ke)}}function Ls(bt,Ye){var qt=te(bt),fe=qt[0],Ue=qt[1],Ke=I._malloc(Xr);try{switch(Ye){case $r.m:ze(le.edgeLengthM(fe,Ue,Ke));break;case $r.km:ze(le.edgeLengthKm(fe,Ue,Ke));break;case $r.rads:ze(le.edgeLengthRads(fe,Ue,Ke));break;default:throw ke(xe,Ye)}return Lr(Ke)}finally{I._free(Ke)}}function su(bt,Ye){ln(bt);var qt=I._malloc(Xr);try{switch(Ye){case $r.m2:ze(le.getHexagonAreaAvgM2(bt,qt));break;case $r.km2:ze(le.getHexagonAreaAvgKm2(bt,qt));break;default:throw ke(xe,Ye)}return Lr(qt)}finally{I._free(qt)}}function Nc(bt,Ye){ln(bt);var qt=I._malloc(Xr);try{switch(Ye){case $r.m:ze(le.getHexagonEdgeLengthAvgM(bt,qt));break;case $r.km:ze(le.getHexagonEdgeLengthAvgKm(bt,qt));break;default:throw ke(xe,Ye)}return Lr(qt)}finally{I._free(qt)}}function Oi(bt,Ye){var qt=te(bt),fe=qt[0],Ue=qt[1],Ke=I._malloc(Ir);try{return ze(le.cellToVertex(fe,Ue,Ye,Ke)),Cn(rr(Ke))}finally{I._free(Ke)}}function bl(bt){var Ye=te(bt),qt=Ye[0],fe=Ye[1],Ue=6,Ke=I._calloc(Ue,Ir);try{return ze(le.cellToVertexes(qt,fe,Ke)),zr(Ke,Ue)}finally{I._free(Ke)}}function Fs(bt){var Ye=I._malloc(Qr),qt=te(bt),fe=qt[0],Ue=qt[1];try{return ze(le.vertexToLatLng(fe,Ue,Ye)),mi(Ye)}finally{I._free(Ye)}}function Hl(bt){var Ye=te(bt),qt=Ye[0],fe=Ye[1];return!!le.isValidVertex(qt,fe)}function Ri(bt){ln(bt);var Ye=I._malloc(fn);try{return ze(le.getNumCells(bt,Ye)),on(Ye)}finally{I._free(Ye)}}function Rl(){var bt=le.res0CellCount(),Ye=I._malloc(Ir*bt);try{return ze(le.getRes0Cells(Ye)),zr(Ye,bt)}finally{I._free(Ye)}}function Yf(bt){ln(bt);var Ye=le.pentagonCount(),qt=I._malloc(Ir*Ye);try{return ze(le.getPentagons(bt,qt)),zr(qt,Ye)}finally{I._free(qt)}}function al(bt){return bt*Math.PI/180}function Ka(bt){return bt*180/Math.PI}},83959:function(ae,j,C){var I;(function(D,G,U,B){"use strict";var Z=["","webkit","Moz","MS","ms","o"],X=G.createElement("div"),q="function",ie=Math.round,he=Math.abs,Ce=Date.now;function be(fe,Ue,Ke){return setTimeout(Be(fe,Ke),Ue)}function Ze(fe,Ue,Ke){return Array.isArray(fe)?(qe(fe,Ke[Ue],Ke),!0):!1}function qe(fe,Ue,Ke){var Ht;if(fe)if(fe.forEach)fe.forEach(Ue,Ke);else if(fe.length!==B)for(Ht=0;Ht<fe.length;)Ue.call(Ke,fe[Ht],Ht,fe),Ht++;else for(Ht in fe)fe.hasOwnProperty(Ht)&&Ue.call(Ke,fe[Ht],Ht,fe)}function De(fe,Ue,Ke){var Ht="DEPRECATED METHOD: "+Ue+`
`+Ke+` AT 
`;return function(){var vr=new Error("get-stack-trace"),Nr=vr&&vr.stack?vr.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",mn=D.console&&(D.console.warn||D.console.log);return mn&&mn.call(D.console,Ht,Nr),fe.apply(this,arguments)}}var Ge;typeof Object.assign!="function"?Ge=function(Ue){if(Ue===B||Ue===null)throw new TypeError("Cannot convert undefined or null to object");for(var Ke=Object(Ue),Ht=1;Ht<arguments.length;Ht++){var vr=arguments[Ht];if(vr!==B&&vr!==null)for(var Nr in vr)vr.hasOwnProperty(Nr)&&(Ke[Nr]=vr[Nr])}return Ke}:Ge=Object.assign;var Re=De(function(Ue,Ke,Ht){for(var vr=Object.keys(Ke),Nr=0;Nr<vr.length;)(!Ht||Ht&&Ue[vr[Nr]]===B)&&(Ue[vr[Nr]]=Ke[vr[Nr]]),Nr++;return Ue},"extend","Use `assign`."),Me=De(function(Ue,Ke){return Re(Ue,Ke,!0)},"merge","Use `assign`.");function ce(fe,Ue,Ke){var Ht=Ue.prototype,vr;vr=fe.prototype=Object.create(Ht),vr.constructor=fe,vr._super=Ht,Ke&&Ge(vr,Ke)}function Be(fe,Ue){return function(){return fe.apply(Ue,arguments)}}function Ee(fe,Ue){return typeof fe==q?fe.apply(Ue&&Ue[0]||B,Ue):fe}function Se(fe,Ue){return fe===B?Ue:fe}function oe(fe,Ue,Ke){qe(xe(Ue),function(Ht){fe.addEventListener(Ht,Ke,!1)})}function Y(fe,Ue,Ke){qe(xe(Ue),function(Ht){fe.removeEventListener(Ht,Ke,!1)})}function Ne(fe,Ue){for(;fe;){if(fe==Ue)return!0;fe=fe.parentNode}return!1}function ge(fe,Ue){return fe.indexOf(Ue)>-1}function xe(fe){return fe.trim().split(/\s+/g)}function ye(fe,Ue,Ke){if(fe.indexOf&&!Ke)return fe.indexOf(Ue);for(var Ht=0;Ht<fe.length;){if(Ke&&fe[Ht][Ke]==Ue||!Ke&&fe[Ht]===Ue)return Ht;Ht++}return-1}function Q(fe){return Array.prototype.slice.call(fe,0)}function Pe(fe,Ue,Ke){for(var Ht=[],vr=[],Nr=0;Nr<fe.length;){var mn=Ue?fe[Nr][Ue]:fe[Nr];ye(vr,mn)<0&&Ht.push(fe[Nr]),vr[Nr]=mn,Nr++}return Ke&&(Ue?Ht=Ht.sort(function(Mi,Ro){return Mi[Ue]>Ro[Ue]}):Ht=Ht.sort()),Ht}function Ae(fe,Ue){for(var Ke,Ht,vr=Ue[0].toUpperCase()+Ue.slice(1),Nr=0;Nr<Z.length;){if(Ke=Z[Nr],Ht=Ke?Ke+vr:Ue,Ht in fe)return Ht;Nr++}return B}var _e=1;function ue(){return _e++}function ke(fe){var Ue=fe.ownerDocument||fe;return Ue.defaultView||Ue.parentWindow||D}var ze=/mobile|tablet|ip(ad|hone|od)|android/i,le="ontouchstart"in D,Ut=Ae(D,"PointerEvent")!==B,kt=le&&ze.test(navigator.userAgent),pr="touch",Wt="pen",Xr="mouse",fn="kinect",Ir=25,Qr=1,tn=2,Mr=4,$n=8,li=1,Kn=2,$r=4,ln=8,Cn=16,$i=Kn|$r,ci=ln|Cn,Ft=$i|ci,te=["x","y"],We=["clientX","clientY"];function Qe(fe,Ue){var Ke=this;this.manager=fe,this.callback=Ue,this.element=fe.element,this.target=fe.options.inputTarget,this.domHandler=function(Ht){Ee(fe.options.enable,[fe])&&Ke.handler(Ht)},this.init()}Qe.prototype={handler:function(){},init:function(){this.evEl&&oe(this.element,this.evEl,this.domHandler),this.evTarget&&oe(this.target,this.evTarget,this.domHandler),this.evWin&&oe(ke(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&Y(this.element,this.evEl,this.domHandler),this.evTarget&&Y(this.target,this.evTarget,this.domHandler),this.evWin&&Y(ke(this.element),this.evWin,this.domHandler)}};function vt(fe){var Ue,Ke=fe.options.inputClass;return Ke?Ue=Ke:Ut?Ue=Xn:kt?Ue=bs:le?Ue=ta:Ue=Ea,new Ue(fe,Lt)}function Lt(fe,Ue,Ke){var Ht=Ke.pointers.length,vr=Ke.changedPointers.length,Nr=Ue&Qr&&Ht-vr===0,mn=Ue&(Mr|$n)&&Ht-vr===0;Ke.isFirst=!!Nr,Ke.isFinal=!!mn,Nr&&(fe.session={}),Ke.eventType=Ue,Pt(fe,Ke),fe.emit("hammer.input",Ke),fe.recognize(Ke),fe.session.prevInput=Ke}function Pt(fe,Ue){var Ke=fe.session,Ht=Ue.pointers,vr=Ht.length;Ke.firstInput||(Ke.firstInput=Ot(Ue)),vr>1&&!Ke.firstMultiple?Ke.firstMultiple=Ot(Ue):vr===1&&(Ke.firstMultiple=!1);var Nr=Ke.firstInput,mn=Ke.firstMultiple,zn=mn?mn.center:Nr.center,Mi=Ue.center=rr(Ht);Ue.timeStamp=Ce(),Ue.deltaTime=Ue.timeStamp-Nr.timeStamp,Ue.angle=hn(zn,Mi),Ue.distance=on(zn,Mi),Cr(Ke,Ue),Ue.offsetDirection=Lr(Ue.deltaX,Ue.deltaY);var Ro=Sr(Ue.deltaTime,Ue.deltaX,Ue.deltaY);Ue.overallVelocityX=Ro.x,Ue.overallVelocityY=Ro.y,Ue.overallVelocity=he(Ro.x)>he(Ro.y)?Ro.x:Ro.y,Ue.scale=mn?rn(mn.pointers,Ht):1,Ue.rotation=mn?zr(mn.pointers,Ht):0,Ue.maxPointers=Ke.prevInput?Ue.pointers.length>Ke.prevInput.maxPointers?Ue.pointers.length:Ke.prevInput.maxPointers:Ue.pointers.length,yt(Ke,Ue);var Ms=fe.element;Ne(Ue.srcEvent.target,Ms)&&(Ms=Ue.srcEvent.target),Ue.target=Ms}function Cr(fe,Ue){var Ke=Ue.center,Ht=fe.offsetDelta||{},vr=fe.prevDelta||{},Nr=fe.prevInput||{};(Ue.eventType===Qr||Nr.eventType===Mr)&&(vr=fe.prevDelta={x:Nr.deltaX||0,y:Nr.deltaY||0},Ht=fe.offsetDelta={x:Ke.x,y:Ke.y}),Ue.deltaX=vr.x+(Ke.x-Ht.x),Ue.deltaY=vr.y+(Ke.y-Ht.y)}function yt(fe,Ue){var Ke=fe.lastInterval||Ue,Ht=Ue.timeStamp-Ke.timeStamp,vr,Nr,mn,zn;if(Ue.eventType!=$n&&(Ht>Ir||Ke.velocity===B)){var Mi=Ue.deltaX-Ke.deltaX,Ro=Ue.deltaY-Ke.deltaY,Ms=Sr(Ht,Mi,Ro);Nr=Ms.x,mn=Ms.y,vr=he(Ms.x)>he(Ms.y)?Ms.x:Ms.y,zn=Lr(Mi,Ro),fe.lastInterval=Ue}else vr=Ke.velocity,Nr=Ke.velocityX,mn=Ke.velocityY,zn=Ke.direction;Ue.velocity=vr,Ue.velocityX=Nr,Ue.velocityY=mn,Ue.direction=zn}function Ot(fe){for(var Ue=[],Ke=0;Ke<fe.pointers.length;)Ue[Ke]={clientX:ie(fe.pointers[Ke].clientX),clientY:ie(fe.pointers[Ke].clientY)},Ke++;return{timeStamp:Ce(),pointers:Ue,center:rr(Ue),deltaX:fe.deltaX,deltaY:fe.deltaY}}function rr(fe){var Ue=fe.length;if(Ue===1)return{x:ie(fe[0].clientX),y:ie(fe[0].clientY)};for(var Ke=0,Ht=0,vr=0;vr<Ue;)Ke+=fe[vr].clientX,Ht+=fe[vr].clientY,vr++;return{x:ie(Ke/Ue),y:ie(Ht/Ue)}}function Sr(fe,Ue,Ke){return{x:Ue/fe||0,y:Ke/fe||0}}function Lr(fe,Ue){return fe===Ue?li:he(fe)>=he(Ue)?fe<0?Kn:$r:Ue<0?ln:Cn}function on(fe,Ue,Ke){Ke||(Ke=te);var Ht=Ue[Ke[0]]-fe[Ke[0]],vr=Ue[Ke[1]]-fe[Ke[1]];return Math.sqrt(Ht*Ht+vr*vr)}function hn(fe,Ue,Ke){Ke||(Ke=te);var Ht=Ue[Ke[0]]-fe[Ke[0]],vr=Ue[Ke[1]]-fe[Ke[1]];return Math.atan2(vr,Ht)*180/Math.PI}function zr(fe,Ue){return hn(Ue[1],Ue[0],We)+hn(fe[1],fe[0],We)}function rn(fe,Ue){return on(Ue[0],Ue[1],We)/on(fe[0],fe[1],We)}var Wn={mousedown:Qr,mousemove:tn,mouseup:Mr},jn="mousedown",mi="mousemove mouseup";function Ea(){this.evEl=jn,this.evWin=mi,this.pressed=!1,Qe.apply(this,arguments)}ce(Ea,Qe,{handler:function(Ue){var Ke=Wn[Ue.type];Ke&Qr&&Ue.button===0&&(this.pressed=!0),Ke&tn&&Ue.which!==1&&(Ke=Mr),this.pressed&&(Ke&Mr&&(this.pressed=!1),this.callback(this.manager,Ke,{pointers:[Ue],changedPointers:[Ue],pointerType:Xr,srcEvent:Ue}))}});var ja={pointerdown:Qr,pointermove:tn,pointerup:Mr,pointercancel:$n,pointerout:$n},Wr={2:pr,3:Wt,4:Xr,5:fn},no="pointerdown",Xo="pointermove pointerup pointercancel";D.MSPointerEvent&&!D.PointerEvent&&(no="MSPointerDown",Xo="MSPointerMove MSPointerUp MSPointerCancel");function Xn(){this.evEl=no,this.evWin=Xo,Qe.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}ce(Xn,Qe,{handler:function(Ue){var Ke=this.store,Ht=!1,vr=Ue.type.toLowerCase().replace("ms",""),Nr=ja[vr],mn=Wr[Ue.pointerType]||Ue.pointerType,zn=mn==pr,Mi=ye(Ke,Ue.pointerId,"pointerId");Nr&Qr&&(Ue.button===0||zn)?Mi<0&&(Ke.push(Ue),Mi=Ke.length-1):Nr&(Mr|$n)&&(Ht=!0),!(Mi<0)&&(Ke[Mi]=Ue,this.callback(this.manager,Nr,{pointers:Ke,changedPointers:[Ue],pointerType:mn,srcEvent:Ue}),Ht&&Ke.splice(Mi,1))}});var Hs={touchstart:Qr,touchmove:tn,touchend:Mr,touchcancel:$n},Bo="touchstart",iu="touchstart touchmove touchend touchcancel";function ts(){this.evTarget=Bo,this.evWin=iu,this.started=!1,Qe.apply(this,arguments)}ce(ts,Qe,{handler:function(Ue){var Ke=Hs[Ue.type];if(Ke===Qr&&(this.started=!0),!!this.started){var Ht=Vl.call(this,Ue,Ke);Ke&(Mr|$n)&&Ht[0].length-Ht[1].length===0&&(this.started=!1),this.callback(this.manager,Ke,{pointers:Ht[0],changedPointers:Ht[1],pointerType:pr,srcEvent:Ue})}}});function Vl(fe,Ue){var Ke=Q(fe.touches),Ht=Q(fe.changedTouches);return Ue&(Mr|$n)&&(Ke=Pe(Ke.concat(Ht),"identifier",!0)),[Ke,Ht]}var ku={touchstart:Qr,touchmove:tn,touchend:Mr,touchcancel:$n},Ds="touchstart touchmove touchend touchcancel";function bs(){this.evTarget=Ds,this.targetIds={},Qe.apply(this,arguments)}ce(bs,Qe,{handler:function(Ue){var Ke=ku[Ue.type],Ht=Fa.call(this,Ue,Ke);Ht&&this.callback(this.manager,Ke,{pointers:Ht[0],changedPointers:Ht[1],pointerType:pr,srcEvent:Ue})}});function Fa(fe,Ue){var Ke=Q(fe.touches),Ht=this.targetIds;if(Ue&(Qr|tn)&&Ke.length===1)return Ht[Ke[0].identifier]=!0,[Ke,Ke];var vr,Nr,mn=Q(fe.changedTouches),zn=[],Mi=this.target;if(Nr=Ke.filter(function(Ro){return Ne(Ro.target,Mi)}),Ue===Qr)for(vr=0;vr<Nr.length;)Ht[Nr[vr].identifier]=!0,vr++;for(vr=0;vr<mn.length;)Ht[mn[vr].identifier]&&zn.push(mn[vr]),Ue&(Mr|$n)&&delete Ht[mn[vr].identifier],vr++;if(zn.length)return[Pe(Nr.concat(zn),"identifier",!0),zn]}var uc=2500,Uu=25;function ta(){Qe.apply(this,arguments);var fe=Be(this.handler,this);this.touch=new bs(this.manager,fe),this.mouse=new Ea(this.manager,fe),this.primaryTouch=null,this.lastTouches=[]}ce(ta,Qe,{handler:function(Ue,Ke,Ht){var vr=Ht.pointerType==pr,Nr=Ht.pointerType==Xr;if(!(Nr&&Ht.sourceCapabilities&&Ht.sourceCapabilities.firesTouchEvents)){if(vr)au.call(this,Ke,Ht);else if(Nr&&Rs.call(this,Ht))return;this.callback(Ue,Ke,Ht)}},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});function au(fe,Ue){fe&Qr?(this.primaryTouch=Ue.changedPointers[0].identifier,mo.call(this,Ue)):fe&(Mr|$n)&&mo.call(this,Ue)}function mo(fe){var Ue=fe.changedPointers[0];if(Ue.identifier===this.primaryTouch){var Ke={x:Ue.clientX,y:Ue.clientY};this.lastTouches.push(Ke);var Ht=this.lastTouches,vr=function(){var Nr=Ht.indexOf(Ke);Nr>-1&&Ht.splice(Nr,1)};setTimeout(vr,uc)}}function Rs(fe){for(var Ue=fe.srcEvent.clientX,Ke=fe.srcEvent.clientY,Ht=0;Ht<this.lastTouches.length;Ht++){var vr=this.lastTouches[Ht],Nr=Math.abs(Ue-vr.x),mn=Math.abs(Ke-vr.y);if(Nr<=Uu&&mn<=Uu)return!0}return!1}var rs=Ae(X.style,"touchAction"),Qi=rs!==B,_o="compute",Ws="auto",ds="manipulation",il="none",Ba="pan-x",Oa="pan-y",Cl=ka();function Co(fe,Ue){this.manager=fe,this.set(Ue)}Co.prototype={set:function(fe){fe==_o&&(fe=this.compute()),Qi&&this.manager.element.style&&Cl[fe]&&(this.manager.element.style[rs]=fe),this.actions=fe.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var fe=[];return qe(this.manager.recognizers,function(Ue){Ee(Ue.options.enable,[Ue])&&(fe=fe.concat(Ue.getTouchAction()))}),gu(fe.join(" "))},preventDefaults:function(fe){var Ue=fe.srcEvent,Ke=fe.offsetDirection;if(this.manager.session.prevented){Ue.preventDefault();return}var Ht=this.actions,vr=ge(Ht,il)&&!Cl[il],Nr=ge(Ht,Oa)&&!Cl[Oa],mn=ge(Ht,Ba)&&!Cl[Ba];if(vr){var zn=fe.pointers.length===1,Mi=fe.distance<2,Ro=fe.deltaTime<250;if(zn&&Mi&&Ro)return}if(!(mn&&Nr)&&(vr||Nr&&Ke&$i||mn&&Ke&ci))return this.preventSrc(Ue)},preventSrc:function(fe){this.manager.session.prevented=!0,fe.preventDefault()}};function gu(fe){if(ge(fe,il))return il;var Ue=ge(fe,Ba),Ke=ge(fe,Oa);return Ue&&Ke?il:Ue||Ke?Ue?Ba:Oa:ge(fe,ds)?ds:Ws}function ka(){if(!Qi)return!1;var fe={},Ue=D.CSS&&D.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach(function(Ke){fe[Ke]=Ue?D.CSS.supports("touch-action",Ke):!0}),fe}var Ru=1,cr=2,yn=4,bo=8,mu=bo,_u=16,js=32;function ou(fe){this.options=Ge({},this.defaults,fe||{}),this.id=ue(),this.manager=null,this.options.enable=Se(this.options.enable,!0),this.state=Ru,this.simultaneous={},this.requireFail=[]}ou.prototype={defaults:{},set:function(fe){return Ge(this.options,fe),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(fe){if(Ze(fe,"recognizeWith",this))return this;var Ue=this.simultaneous;return fe=Ls(fe,this),Ue[fe.id]||(Ue[fe.id]=fe,fe.recognizeWith(this)),this},dropRecognizeWith:function(fe){return Ze(fe,"dropRecognizeWith",this)?this:(fe=Ls(fe,this),delete this.simultaneous[fe.id],this)},requireFailure:function(fe){if(Ze(fe,"requireFailure",this))return this;var Ue=this.requireFail;return fe=Ls(fe,this),ye(Ue,fe)===-1&&(Ue.push(fe),fe.requireFailure(this)),this},dropRequireFailure:function(fe){if(Ze(fe,"dropRequireFailure",this))return this;fe=Ls(fe,this);var Ue=ye(this.requireFail,fe);return Ue>-1&&this.requireFail.splice(Ue,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(fe){return!!this.simultaneous[fe.id]},emit:function(fe){var Ue=this,Ke=this.state;function Ht(vr){Ue.manager.emit(vr,fe)}Ke<bo&&Ht(Ue.options.event+qa(Ke)),Ht(Ue.options.event),fe.additionalEvent&&Ht(fe.additionalEvent),Ke>=bo&&Ht(Ue.options.event+qa(Ke))},tryEmit:function(fe){if(this.canEmit())return this.emit(fe);this.state=js},canEmit:function(){for(var fe=0;fe<this.requireFail.length;){if(!(this.requireFail[fe].state&(js|Ru)))return!1;fe++}return!0},recognize:function(fe){var Ue=Ge({},fe);if(!Ee(this.options.enable,[this,Ue])){this.reset(),this.state=js;return}this.state&(mu|_u|js)&&(this.state=Ru),this.state=this.process(Ue),this.state&(cr|yn|bo|_u)&&this.tryEmit(Ue)},process:function(fe){},getTouchAction:function(){},reset:function(){}};function qa(fe){return fe&_u?"cancel":fe&bo?"end":fe&yn?"move":fe&cr?"start":""}function lc(fe){return fe==Cn?"down":fe==ln?"up":fe==Kn?"left":fe==$r?"right":""}function Ls(fe,Ue){var Ke=Ue.manager;return Ke?Ke.get(fe):fe}function su(){ou.apply(this,arguments)}ce(su,ou,{defaults:{pointers:1},attrTest:function(fe){var Ue=this.options.pointers;return Ue===0||fe.pointers.length===Ue},process:function(fe){var Ue=this.state,Ke=fe.eventType,Ht=Ue&(cr|yn),vr=this.attrTest(fe);return Ht&&(Ke&$n||!vr)?Ue|_u:Ht||vr?Ke&Mr?Ue|bo:Ue&cr?Ue|yn:cr:js}});function Nc(){su.apply(this,arguments),this.pX=null,this.pY=null}ce(Nc,su,{defaults:{event:"pan",threshold:10,pointers:1,direction:Ft},getTouchAction:function(){var fe=this.options.direction,Ue=[];return fe&$i&&Ue.push(Oa),fe&ci&&Ue.push(Ba),Ue},directionTest:function(fe){var Ue=this.options,Ke=!0,Ht=fe.distance,vr=fe.direction,Nr=fe.deltaX,mn=fe.deltaY;return vr&Ue.direction||(Ue.direction&$i?(vr=Nr===0?li:Nr<0?Kn:$r,Ke=Nr!=this.pX,Ht=Math.abs(fe.deltaX)):(vr=mn===0?li:mn<0?ln:Cn,Ke=mn!=this.pY,Ht=Math.abs(fe.deltaY))),fe.direction=vr,Ke&&Ht>Ue.threshold&&vr&Ue.direction},attrTest:function(fe){return su.prototype.attrTest.call(this,fe)&&(this.state&cr||!(this.state&cr)&&this.directionTest(fe))},emit:function(fe){this.pX=fe.deltaX,this.pY=fe.deltaY;var Ue=lc(fe.direction);Ue&&(fe.additionalEvent=this.options.event+Ue),this._super.emit.call(this,fe)}});function Oi(){su.apply(this,arguments)}ce(Oi,su,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[il]},attrTest:function(fe){return this._super.attrTest.call(this,fe)&&(Math.abs(fe.scale-1)>this.options.threshold||this.state&cr)},emit:function(fe){if(fe.scale!==1){var Ue=fe.scale<1?"in":"out";fe.additionalEvent=this.options.event+Ue}this._super.emit.call(this,fe)}});function bl(){ou.apply(this,arguments),this._timer=null,this._input=null}ce(bl,ou,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return[Ws]},process:function(fe){var Ue=this.options,Ke=fe.pointers.length===Ue.pointers,Ht=fe.distance<Ue.threshold,vr=fe.deltaTime>Ue.time;if(this._input=fe,!Ht||!Ke||fe.eventType&(Mr|$n)&&!vr)this.reset();else if(fe.eventType&Qr)this.reset(),this._timer=be(function(){this.state=mu,this.tryEmit()},Ue.time,this);else if(fe.eventType&Mr)return mu;return js},reset:function(){clearTimeout(this._timer)},emit:function(fe){this.state===mu&&(fe&&fe.eventType&Mr?this.manager.emit(this.options.event+"up",fe):(this._input.timeStamp=Ce(),this.manager.emit(this.options.event,this._input)))}});function Fs(){su.apply(this,arguments)}ce(Fs,su,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[il]},attrTest:function(fe){return this._super.attrTest.call(this,fe)&&(Math.abs(fe.rotation)>this.options.threshold||this.state&cr)}});function Hl(){su.apply(this,arguments)}ce(Hl,su,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:$i|ci,pointers:1},getTouchAction:function(){return Nc.prototype.getTouchAction.call(this)},attrTest:function(fe){var Ue=this.options.direction,Ke;return Ue&($i|ci)?Ke=fe.overallVelocity:Ue&$i?Ke=fe.overallVelocityX:Ue&ci&&(Ke=fe.overallVelocityY),this._super.attrTest.call(this,fe)&&Ue&fe.offsetDirection&&fe.distance>this.options.threshold&&fe.maxPointers==this.options.pointers&&he(Ke)>this.options.velocity&&fe.eventType&Mr},emit:function(fe){var Ue=lc(fe.offsetDirection);Ue&&this.manager.emit(this.options.event+Ue,fe),this.manager.emit(this.options.event,fe)}});function Ri(){ou.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}ce(Ri,ou,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return[ds]},process:function(fe){var Ue=this.options,Ke=fe.pointers.length===Ue.pointers,Ht=fe.distance<Ue.threshold,vr=fe.deltaTime<Ue.time;if(this.reset(),fe.eventType&Qr&&this.count===0)return this.failTimeout();if(Ht&&vr&&Ke){if(fe.eventType!=Mr)return this.failTimeout();var Nr=this.pTime?fe.timeStamp-this.pTime<Ue.interval:!0,mn=!this.pCenter||on(this.pCenter,fe.center)<Ue.posThreshold;this.pTime=fe.timeStamp,this.pCenter=fe.center,!mn||!Nr?this.count=1:this.count+=1,this._input=fe;var zn=this.count%Ue.taps;if(zn===0)return this.hasRequireFailures()?(this._timer=be(function(){this.state=mu,this.tryEmit()},Ue.interval,this),cr):mu}return js},failTimeout:function(){return this._timer=be(function(){this.state=js},this.options.interval,this),js},reset:function(){clearTimeout(this._timer)},emit:function(){this.state==mu&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}});function Rl(fe,Ue){return Ue=Ue||{},Ue.recognizers=Se(Ue.recognizers,Rl.defaults.preset),new Ka(fe,Ue)}Rl.VERSION="2.0.7",Rl.defaults={domEvents:!1,touchAction:_o,enable:!0,inputTarget:null,inputClass:null,preset:[[Fs,{enable:!1}],[Oi,{enable:!1},["rotate"]],[Hl,{direction:$i}],[Nc,{direction:$i},["swipe"]],[Ri],[Ri,{event:"doubletap",taps:2},["tap"]],[bl]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}};var Yf=1,al=2;function Ka(fe,Ue){this.options=Ge({},Rl.defaults,Ue||{}),this.options.inputTarget=this.options.inputTarget||fe,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=fe,this.input=vt(this),this.touchAction=new Co(this,this.options.touchAction),bt(this,!0),qe(this.options.recognizers,function(Ke){var Ht=this.add(new Ke[0](Ke[1]));Ke[2]&&Ht.recognizeWith(Ke[2]),Ke[3]&&Ht.requireFailure(Ke[3])},this)}Ka.prototype={set:function(fe){return Ge(this.options,fe),fe.touchAction&&this.touchAction.update(),fe.inputTarget&&(this.input.destroy(),this.input.target=fe.inputTarget,this.input.init()),this},stop:function(fe){this.session.stopped=fe?al:Yf},recognize:function(fe){var Ue=this.session;if(!Ue.stopped){this.touchAction.preventDefaults(fe);var Ke,Ht=this.recognizers,vr=Ue.curRecognizer;(!vr||vr&&vr.state&mu)&&(vr=Ue.curRecognizer=null);for(var Nr=0;Nr<Ht.length;)Ke=Ht[Nr],Ue.stopped!==al&&(!vr||Ke==vr||Ke.canRecognizeWith(vr))?Ke.recognize(fe):Ke.reset(),!vr&&Ke.state&(cr|yn|bo)&&(vr=Ue.curRecognizer=Ke),Nr++}},get:function(fe){if(fe instanceof ou)return fe;for(var Ue=this.recognizers,Ke=0;Ke<Ue.length;Ke++)if(Ue[Ke].options.event==fe)return Ue[Ke];return null},add:function(fe){if(Ze(fe,"add",this))return this;var Ue=this.get(fe.options.event);return Ue&&this.remove(Ue),this.recognizers.push(fe),fe.manager=this,this.touchAction.update(),fe},remove:function(fe){if(Ze(fe,"remove",this))return this;if(fe=this.get(fe),fe){var Ue=this.recognizers,Ke=ye(Ue,fe);Ke!==-1&&(Ue.splice(Ke,1),this.touchAction.update())}return this},on:function(fe,Ue){if(fe!==B&&Ue!==B){var Ke=this.handlers;return qe(xe(fe),function(Ht){Ke[Ht]=Ke[Ht]||[],Ke[Ht].push(Ue)}),this}},off:function(fe,Ue){if(fe!==B){var Ke=this.handlers;return qe(xe(fe),function(Ht){Ue?Ke[Ht]&&Ke[Ht].splice(ye(Ke[Ht],Ue),1):delete Ke[Ht]}),this}},emit:function(fe,Ue){this.options.domEvents&&Ye(fe,Ue);var Ke=this.handlers[fe]&&this.handlers[fe].slice();if(!(!Ke||!Ke.length)){Ue.type=fe,Ue.preventDefault=function(){Ue.srcEvent.preventDefault()};for(var Ht=0;Ht<Ke.length;)Ke[Ht](Ue),Ht++}},destroy:function(){this.element&&bt(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}};function bt(fe,Ue){var Ke=fe.element;if(Ke.style){var Ht;qe(fe.options.cssProps,function(vr,Nr){Ht=Ae(Ke.style,Nr),Ue?(fe.oldCssProps[Ht]=Ke.style[Ht],Ke.style[Ht]=vr):Ke.style[Ht]=fe.oldCssProps[Ht]||""}),Ue||(fe.oldCssProps={})}}function Ye(fe,Ue){var Ke=G.createEvent("Event");Ke.initEvent(fe,!0,!0),Ke.gesture=Ue,Ue.target.dispatchEvent(Ke)}Ge(Rl,{INPUT_START:Qr,INPUT_MOVE:tn,INPUT_END:Mr,INPUT_CANCEL:$n,STATE_POSSIBLE:Ru,STATE_BEGAN:cr,STATE_CHANGED:yn,STATE_ENDED:bo,STATE_RECOGNIZED:mu,STATE_CANCELLED:_u,STATE_FAILED:js,DIRECTION_NONE:li,DIRECTION_LEFT:Kn,DIRECTION_RIGHT:$r,DIRECTION_UP:ln,DIRECTION_DOWN:Cn,DIRECTION_HORIZONTAL:$i,DIRECTION_VERTICAL:ci,DIRECTION_ALL:Ft,Manager:Ka,Input:Qe,TouchAction:Co,TouchInput:bs,MouseInput:Ea,PointerEventInput:Xn,TouchMouseInput:ta,SingleTouchInput:ts,Recognizer:ou,AttrRecognizer:su,Tap:Ri,Pan:Nc,Swipe:Hl,Pinch:Oi,Rotate:Fs,Press:bl,on:oe,off:Y,each:qe,merge:Me,extend:Re,assign:Ge,inherit:ce,bindFn:Be,prefixed:Ae});var qt=typeof D!="undefined"?D:typeof self!="undefined"?self:{};qt.Hammer=Rl,I=function(){return Rl}.call(j,C,j,ae),I!==B&&(ae.exports=I)})(window,document,"Hammer")},38262:function(ae,j,C){"use strict";var I=C(44532),D=I("%Object.defineProperty%",!0),G=function(){if(D)try{return D({},"a",{value:1}),!0}catch(B){return!1}return!1};G.hasArrayLengthDefineBug=function(){if(!G())return null;try{return D([],"length",{value:1}).length!==1}catch(B){return!0}},ae.exports=G},77916:function(ae){"use strict";var j={foo:{}},C=Object;ae.exports=function(){return{__proto__:j}.foo===j.foo&&!({__proto__:null}instanceof C)}},9997:function(ae,j,C){"use strict";var I=typeof Symbol!="undefined"&&Symbol,D=C(83880);ae.exports=function(){return typeof I!="function"||typeof Symbol!="function"||typeof I("foo")!="symbol"||typeof Symbol("bar")!="symbol"?!1:D()}},83880:function(ae){"use strict";ae.exports=function(){if(typeof Symbol!="function"||typeof Object.getOwnPropertySymbols!="function")return!1;if(typeof Symbol.iterator=="symbol")return!0;var C={},I=Symbol("test"),D=Object(I);if(typeof I=="string"||Object.prototype.toString.call(I)!=="[object Symbol]"||Object.prototype.toString.call(D)!=="[object Symbol]")return!1;var G=42;C[I]=G;for(I in C)return!1;if(typeof Object.keys=="function"&&Object.keys(C).length!==0||typeof Object.getOwnPropertyNames=="function"&&Object.getOwnPropertyNames(C).length!==0)return!1;var U=Object.getOwnPropertySymbols(C);if(U.length!==1||U[0]!==I||!Object.prototype.propertyIsEnumerable.call(C,I))return!1;if(typeof Object.getOwnPropertyDescriptor=="function"){var B=Object.getOwnPropertyDescriptor(C,I);if(B.value!==G||B.enumerable!==!0)return!1}return!0}},45119:function(ae,j,C){"use strict";var I=C(83880);ae.exports=function(){return I()&&!!Symbol.toStringTag}},68854:function(ae,j,C){"use strict";var I=Function.prototype.call,D=Object.prototype.hasOwnProperty,G=C(36723);ae.exports=G.call(I,D)},67467:function(ae,j){j.read=function(C,I,D,G,U){var B,Z,X=U*8-G-1,q=(1<<X)-1,ie=q>>1,he=-7,Ce=D?U-1:0,be=D?-1:1,Ze=C[I+Ce];for(Ce+=be,B=Ze&(1<<-he)-1,Ze>>=-he,he+=X;he>0;B=B*256+C[I+Ce],Ce+=be,he-=8);for(Z=B&(1<<-he)-1,B>>=-he,he+=G;he>0;Z=Z*256+C[I+Ce],Ce+=be,he-=8);if(B===0)B=1-ie;else{if(B===q)return Z?NaN:(Ze?-1:1)*(1/0);Z=Z+Math.pow(2,G),B=B-ie}return(Ze?-1:1)*Z*Math.pow(2,B-G)},j.write=function(C,I,D,G,U,B){var Z,X,q,ie=B*8-U-1,he=(1<<ie)-1,Ce=he>>1,be=U===23?Math.pow(2,-24)-Math.pow(2,-77):0,Ze=G?0:B-1,qe=G?1:-1,De=I<0||I===0&&1/I<0?1:0;for(I=Math.abs(I),isNaN(I)||I===1/0?(X=isNaN(I)?1:0,Z=he):(Z=Math.floor(Math.log(I)/Math.LN2),I*(q=Math.pow(2,-Z))<1&&(Z--,q*=2),Z+Ce>=1?I+=be/q:I+=be*Math.pow(2,1-Ce),I*q>=2&&(Z++,q/=2),Z+Ce>=he?(X=0,Z=he):Z+Ce>=1?(X=(I*q-1)*Math.pow(2,U),Z=Z+Ce):(X=I*Math.pow(2,Ce-1)*Math.pow(2,U),Z=0));U>=8;C[D+Ze]=X&255,Ze+=qe,X/=256,U-=8);for(Z=Z<<U|X,ie+=U;ie>0;C[D+Ze]=Z&255,Ze+=qe,Z/=256,ie-=8);C[D+Ze-qe]|=De*128}},3039:function(ae,j){"use strict";Object.defineProperty(j,"__esModule",{value:!0});var C=Symbol.for("INJECTION");function I(Z,X,q,ie){function he(){return ie&&!Reflect.hasMetadata(C,this,X)&&Reflect.defineMetadata(C,q(),this,X),Reflect.hasMetadata(C,this,X)?Reflect.getMetadata(C,this,X):q()}function Ce(be){Reflect.defineMetadata(C,be,this,X)}Object.defineProperty(Z,X,{configurable:!0,enumerable:!0,get:he,set:Ce})}function D(Z,X){return function(q){return function(ie,he){var Ce=function(){return Z.get(q)};I(ie,he,Ce,X)}}}j.makePropertyInjectDecorator=D;function G(Z,X){return function(q,ie){return function(he,Ce){var be=function(){return Z.getNamed(q,ie)};I(he,Ce,be,X)}}}j.makePropertyInjectNamedDecorator=G;function U(Z,X){return function(q,ie,he){return function(Ce,be){var Ze=function(){return Z.getTagged(q,ie,he)};I(Ce,be,Ze,X)}}}j.makePropertyInjectTaggedDecorator=U;function B(Z,X){return function(q){return function(ie,he){var Ce=function(){return Z.getAll(q)};I(ie,he,Ce,X)}}}j.makePropertyMultiInjectDecorator=B},11922:function(ae,j,C){"use strict";var I;I={value:!0};var D=C(3039);function G(U,B){B===void 0&&(B=!0);var Z=D.makePropertyInjectDecorator(U,B),X=D.makePropertyInjectNamedDecorator(U,B),q=D.makePropertyInjectTaggedDecorator(U,B),ie=D.makePropertyMultiInjectDecorator(U,B);return{lazyInject:Z,lazyInjectNamed:X,lazyInjectTagged:q,lazyMultiInject:ie}}j.Z=G},80626:function(ae,j,C){"use strict";Object.defineProperty(j,"__esModule",{value:!0}),j.tagProperty=j.tagParameter=j.decorate=void 0;var I=C(36078),D=C(50295);function G(ie,he,Ce,be){var Ze=D.TAGGED;B(Ze,ie,he,be,Ce)}j.tagParameter=G;function U(ie,he,Ce){var be=D.TAGGED_PROP;B(be,ie.constructor,he,Ce)}j.tagProperty=U;function B(ie,he,Ce,be,Ze){var qe={},De=typeof Ze=="number",Ge=Ze!==void 0&&De?Ze.toString():Ce;if(De&&Ce!==void 0)throw new Error(I.INVALID_DECORATOR_OPERATION);Reflect.hasOwnMetadata(ie,he)&&(qe=Reflect.getMetadata(ie,he));var Re=qe[Ge];if(!Array.isArray(Re))Re=[];else for(var Me=0,ce=Re;Me<ce.length;Me++){var Be=ce[Me];if(Be.key===be.key)throw new Error(I.DUPLICATED_METADATA+" "+Be.key.toString())}Re.push(be),qe[Ge]=Re,Reflect.defineMetadata(ie,qe,he)}function Z(ie,he){Reflect.decorate(ie,he)}function X(ie,he){return function(Ce,be){he(Ce,be,ie)}}function q(ie,he,Ce){typeof Ce=="number"?Z([X(Ce,ie)],he):typeof Ce=="string"?Reflect.decorate([ie],he,Ce):Z([ie],he)}j.decorate=q},76213:function(ae,j,C){"use strict";Object.defineProperty(j,"__esModule",{value:!0}),j.inject=j.LazyServiceIdentifer=void 0;var I=C(36078),D=C(50295),G=C(25092),U=C(80626),B=function(){function X(q){this._cb=q}return X.prototype.unwrap=function(){return this._cb()},X}();j.LazyServiceIdentifer=B;function Z(X){return function(q,ie,he){if(X===void 0)throw new Error(I.UNDEFINED_INJECT_ANNOTATION(q.name));var Ce=new G.Metadata(D.INJECT_TAG,X);typeof he=="number"?U.tagParameter(q,ie,he,Ce):U.tagProperty(q,ie,Ce)}}j.inject=Z},91773:function(ae,j,C){"use strict";Object.defineProperty(j,"__esModule",{value:!0}),j.injectable=void 0;var I=C(36078),D=C(50295);function G(){return function(U){if(Reflect.hasOwnMetadata(D.PARAM_TYPES,U))throw new Error(I.DUPLICATED_INJECTABLE_DECORATOR);var B=Reflect.getMetadata(D.DESIGN_PARAM_TYPES,U)||[];return Reflect.defineMetadata(D.PARAM_TYPES,B,U),U}}j.injectable=G},41528:function(ae,j,C){"use strict";Object.defineProperty(j,"__esModule",{value:!0}),j.multiInject=void 0;var I=C(50295),D=C(25092),G=C(80626);function U(B){return function(Z,X,q){var ie=new D.Metadata(I.MULTI_INJECT_TAG,B);typeof q=="number"?G.tagParameter(Z,X,q,ie):G.tagProperty(Z,X,ie)}}j.multiInject=U},79817:function(ae,j,C){"use strict";Object.defineProperty(j,"__esModule",{value:!0}),j.named=void 0;var I=C(50295),D=C(25092),G=C(80626);function U(B){return function(Z,X,q){var ie=new D.Metadata(I.NAMED_TAG,B);typeof q=="number"?G.tagParameter(Z,X,q,ie):G.tagProperty(Z,X,ie)}}j.named=U},71316:function(ae,j,C){"use strict";Object.defineProperty(j,"__esModule",{value:!0}),j.optional=void 0;var I=C(50295),D=C(25092),G=C(80626);function U(){return function(B,Z,X){var q=new D.Metadata(I.OPTIONAL_TAG,!0);typeof X=="number"?G.tagParameter(B,Z,X,q):G.tagProperty(B,Z,q)}}j.optional=U},71971:function(ae,j,C){"use strict";Object.defineProperty(j,"__esModule",{value:!0}),j.postConstruct=void 0;var I=C(36078),D=C(50295),G=C(25092);function U(){return function(B,Z,X){var q=new G.Metadata(D.POST_CONSTRUCT,Z);if(Reflect.hasOwnMetadata(D.POST_CONSTRUCT,B.constructor))throw new Error(I.MULTIPLE_POST_CONSTRUCT_METHODS);Reflect.defineMetadata(D.POST_CONSTRUCT,q,B.constructor)}}j.postConstruct=U},79189:function(ae,j,C){"use strict";Object.defineProperty(j,"__esModule",{value:!0}),j.tagged=void 0;var I=C(25092),D=C(80626);function G(U,B){return function(Z,X,q){var ie=new I.Metadata(U,B);typeof q=="number"?D.tagParameter(Z,X,q,ie):D.tagProperty(Z,X,ie)}}j.tagged=G},8245:function(ae,j,C){"use strict";Object.defineProperty(j,"__esModule",{value:!0}),j.targetName=void 0;var I=C(50295),D=C(25092),G=C(80626);function U(B){return function(Z,X,q){var ie=new D.Metadata(I.NAME_TAG,B);G.tagParameter(Z,X,q,ie)}}j.targetName=U},19235:function(ae,j,C){"use strict";Object.defineProperty(j,"__esModule",{value:!0}),j.unmanaged=void 0;var I=C(50295),D=C(25092),G=C(80626);function U(){return function(B,Z,X){var q=new D.Metadata(I.UNMANAGED_TAG,!0);G.tagParameter(B,Z,X,q)}}j.unmanaged=U},30683:function(ae,j,C){"use strict";Object.defineProperty(j,"__esModule",{value:!0}),j.Binding=void 0;var I=C(77690),D=C(70023),G=function(){function U(B,Z){this.id=D.id(),this.activated=!1,this.serviceIdentifier=B,this.scope=Z,this.type=I.BindingTypeEnum.Invalid,this.constraint=function(X){return!0},this.implementationType=null,this.cache=null,this.factory=null,this.provider=null,this.onActivation=null,this.dynamicValue=null}return U.prototype.clone=function(){var B=new U(this.serviceIdentifier,this.scope);return B.activated=B.scope===I.BindingScopeEnum.Singleton?this.activated:!1,B.implementationType=this.implementationType,B.dynamicValue=this.dynamicValue,B.scope=this.scope,B.type=this.type,B.factory=this.factory,B.provider=this.provider,B.constraint=this.constraint,B.onActivation=this.onActivation,B.cache=this.cache,B},U}();j.Binding=G},13497:function(ae,j){"use strict";Object.defineProperty(j,"__esModule",{value:!0}),j.BindingCount=void 0;var C={MultipleBindingsAvailable:2,NoBindingsAvailable:0,OnlyOneBindingAvailable:1};j.BindingCount=C},36078:function(ae,j){"use strict";Object.defineProperty(j,"__esModule",{value:!0}),j.STACK_OVERFLOW=j.CIRCULAR_DEPENDENCY_IN_FACTORY=j.POST_CONSTRUCT_ERROR=j.MULTIPLE_POST_CONSTRUCT_METHODS=j.CONTAINER_OPTIONS_INVALID_SKIP_BASE_CHECK=j.CONTAINER_OPTIONS_INVALID_AUTO_BIND_INJECTABLE=j.CONTAINER_OPTIONS_INVALID_DEFAULT_SCOPE=j.CONTAINER_OPTIONS_MUST_BE_AN_OBJECT=j.ARGUMENTS_LENGTH_MISMATCH=j.INVALID_DECORATOR_OPERATION=j.INVALID_TO_SELF_VALUE=j.INVALID_FUNCTION_BINDING=j.INVALID_MIDDLEWARE_RETURN=j.NO_MORE_SNAPSHOTS_AVAILABLE=j.INVALID_BINDING_TYPE=j.NOT_IMPLEMENTED=j.CIRCULAR_DEPENDENCY=j.UNDEFINED_INJECT_ANNOTATION=j.MISSING_INJECT_ANNOTATION=j.MISSING_INJECTABLE_ANNOTATION=j.NOT_REGISTERED=j.CANNOT_UNBIND=j.AMBIGUOUS_MATCH=j.KEY_NOT_FOUND=j.NULL_ARGUMENT=j.DUPLICATED_METADATA=j.DUPLICATED_INJECTABLE_DECORATOR=void 0,j.DUPLICATED_INJECTABLE_DECORATOR="Cannot apply @injectable decorator multiple times.",j.DUPLICATED_METADATA="Metadata key was used more than once in a parameter:",j.NULL_ARGUMENT="NULL argument",j.KEY_NOT_FOUND="Key Not Found",j.AMBIGUOUS_MATCH="Ambiguous match found for serviceIdentifier:",j.CANNOT_UNBIND="Could not unbind serviceIdentifier:",j.NOT_REGISTERED="No matching bindings found for serviceIdentifier:",j.MISSING_INJECTABLE_ANNOTATION="Missing required @injectable annotation in:",j.MISSING_INJECT_ANNOTATION="Missing required @inject or @multiInject annotation in:";var C=function(U){return"@inject called with undefined this could mean that the class "+U+" has a circular dependency problem. You can use a LazyServiceIdentifer to  overcome this limitation."};j.UNDEFINED_INJECT_ANNOTATION=C,j.CIRCULAR_DEPENDENCY="Circular dependency found:",j.NOT_IMPLEMENTED="Sorry, this feature is not fully implemented yet.",j.INVALID_BINDING_TYPE="Invalid binding type:",j.NO_MORE_SNAPSHOTS_AVAILABLE="No snapshot available to restore.",j.INVALID_MIDDLEWARE_RETURN="Invalid return type in middleware. Middleware must return!",j.INVALID_FUNCTION_BINDING="Value provided to function binding must be a function!",j.INVALID_TO_SELF_VALUE="The toSelf function can only be applied when a constructor is used as service identifier",j.INVALID_DECORATOR_OPERATION="The @inject @multiInject @tagged and @named decorators must be applied to the parameters of a class constructor or a class property.";var I=function(){for(var U=[],B=0;B<arguments.length;B++)U[B]=arguments[B];return"The number of constructor arguments in the derived class "+(U[0]+" must be >= than the number of constructor arguments of its base class.")};j.ARGUMENTS_LENGTH_MISMATCH=I,j.CONTAINER_OPTIONS_MUST_BE_AN_OBJECT="Invalid Container constructor argument. Container options must be an object.",j.CONTAINER_OPTIONS_INVALID_DEFAULT_SCOPE="Invalid Container option. Default scope must be a string ('singleton' or 'transient').",j.CONTAINER_OPTIONS_INVALID_AUTO_BIND_INJECTABLE="Invalid Container option. Auto bind injectable must be a boolean",j.CONTAINER_OPTIONS_INVALID_SKIP_BASE_CHECK="Invalid Container option. Skip base check must be a boolean",j.MULTIPLE_POST_CONSTRUCT_METHODS="Cannot apply @postConstruct decorator multiple times in the same class";var D=function(){for(var U=[],B=0;B<arguments.length;B++)U[B]=arguments[B];return"@postConstruct error in class "+U[0]+": "+U[1]};j.POST_CONSTRUCT_ERROR=D;var G=function(){for(var U=[],B=0;B<arguments.length;B++)U[B]=arguments[B];return"It looks like there is a circular dependency "+("in one of the '"+U[0]+"' bindings. Please investigate bindings with")+("service identifier '"+U[1]+"'.")};j.CIRCULAR_DEPENDENCY_IN_FACTORY=G,j.STACK_OVERFLOW="Maximum call stack size exceeded"},77690:function(ae,j){"use strict";Object.defineProperty(j,"__esModule",{value:!0}),j.TargetTypeEnum=j.BindingTypeEnum=j.BindingScopeEnum=void 0;var C={Request:"Request",Singleton:"Singleton",Transient:"Transient"};j.BindingScopeEnum=C;var I={ConstantValue:"ConstantValue",Constructor:"Constructor",DynamicValue:"DynamicValue",Factory:"Factory",Function:"Function",Instance:"Instance",Invalid:"Invalid",Provider:"Provider"};j.BindingTypeEnum=I;var D={ClassProperty:"ClassProperty",ConstructorArgument:"ConstructorArgument",Variable:"Variable"};j.TargetTypeEnum=D},50295:function(ae,j){"use strict";Object.defineProperty(j,"__esModule",{value:!0}),j.NON_CUSTOM_TAG_KEYS=j.POST_CONSTRUCT=j.DESIGN_PARAM_TYPES=j.PARAM_TYPES=j.TAGGED_PROP=j.TAGGED=j.MULTI_INJECT_TAG=j.INJECT_TAG=j.OPTIONAL_TAG=j.UNMANAGED_TAG=j.NAME_TAG=j.NAMED_TAG=void 0,j.NAMED_TAG="named",j.NAME_TAG="name",j.UNMANAGED_TAG="unmanaged",j.OPTIONAL_TAG="optional",j.INJECT_TAG="inject",j.MULTI_INJECT_TAG="multi_inject",j.TAGGED="inversify:tagged",j.TAGGED_PROP="inversify:tagged_props",j.PARAM_TYPES="inversify:paramtypes",j.DESIGN_PARAM_TYPES="design:paramtypes",j.POST_CONSTRUCT="post_construct";function C(){return[j.INJECT_TAG,j.MULTI_INJECT_TAG,j.NAME_TAG,j.UNMANAGED_TAG,j.NAMED_TAG,j.OPTIONAL_TAG]}j.NON_CUSTOM_TAG_KEYS=C()},70596:function(ae,j,C){"use strict";var I=this&&this.__awaiter||function(Re,Me,ce,Be){function Ee(Se){return Se instanceof ce?Se:new ce(function(oe){oe(Se)})}return new(ce||(ce=Promise))(function(Se,oe){function Y(xe){try{ge(Be.next(xe))}catch(ye){oe(ye)}}function Ne(xe){try{ge(Be.throw(xe))}catch(ye){oe(ye)}}function ge(xe){xe.done?Se(xe.value):Ee(xe.value).then(Y,Ne)}ge((Be=Be.apply(Re,Me||[])).next())})},D=this&&this.__generator||function(Re,Me){var ce={label:0,sent:function(){if(Se[0]&1)throw Se[1];return Se[1]},trys:[],ops:[]},Be,Ee,Se,oe;return oe={next:Y(0),throw:Y(1),return:Y(2)},typeof Symbol=="function"&&(oe[Symbol.iterator]=function(){return this}),oe;function Y(ge){return function(xe){return Ne([ge,xe])}}function Ne(ge){if(Be)throw new TypeError("Generator is already executing.");for(;ce;)try{if(Be=1,Ee&&(Se=ge[0]&2?Ee.return:ge[0]?Ee.throw||((Se=Ee.return)&&Se.call(Ee),0):Ee.next)&&!(Se=Se.call(Ee,ge[1])).done)return Se;switch(Ee=0,Se&&(ge=[ge[0]&2,Se.value]),ge[0]){case 0:case 1:Se=ge;break;case 4:return ce.label++,{value:ge[1],done:!1};case 5:ce.label++,Ee=ge[1],ge=[0];continue;case 7:ge=ce.ops.pop(),ce.trys.pop();continue;default:if(Se=ce.trys,!(Se=Se.length>0&&Se[Se.length-1])&&(ge[0]===6||ge[0]===2)){ce=0;continue}if(ge[0]===3&&(!Se||ge[1]>Se[0]&&ge[1]<Se[3])){ce.label=ge[1];break}if(ge[0]===6&&ce.label<Se[1]){ce.label=Se[1],Se=ge;break}if(Se&&ce.label<Se[2]){ce.label=Se[2],ce.ops.push(ge);break}Se[2]&&ce.ops.pop(),ce.trys.pop();continue}ge=Me.call(Re,ce)}catch(xe){ge=[6,xe],Ee=0}finally{Be=Se=0}if(ge[0]&5)throw ge[1];return{value:ge[0]?ge[1]:void 0,done:!0}}},G=this&&this.__spreadArray||function(Re,Me){for(var ce=0,Be=Me.length,Ee=Re.length;ce<Be;ce++,Ee++)Re[Ee]=Me[ce];return Re};Object.defineProperty(j,"__esModule",{value:!0}),j.Container=void 0;var U=C(30683),B=C(36078),Z=C(77690),X=C(50295),q=C(43870),ie=C(54142),he=C(9386),Ce=C(43313),be=C(70023),Ze=C(29552),qe=C(71878),De=C(82543),Ge=function(){function Re(Me){this._appliedMiddleware=[];var ce=Me||{};if(typeof ce!="object")throw new Error(""+B.CONTAINER_OPTIONS_MUST_BE_AN_OBJECT);if(ce.defaultScope===void 0)ce.defaultScope=Z.BindingScopeEnum.Transient;else if(ce.defaultScope!==Z.BindingScopeEnum.Singleton&&ce.defaultScope!==Z.BindingScopeEnum.Transient&&ce.defaultScope!==Z.BindingScopeEnum.Request)throw new Error(""+B.CONTAINER_OPTIONS_INVALID_DEFAULT_SCOPE);if(ce.autoBindInjectable===void 0)ce.autoBindInjectable=!1;else if(typeof ce.autoBindInjectable!="boolean")throw new Error(""+B.CONTAINER_OPTIONS_INVALID_AUTO_BIND_INJECTABLE);if(ce.skipBaseClassChecks===void 0)ce.skipBaseClassChecks=!1;else if(typeof ce.skipBaseClassChecks!="boolean")throw new Error(""+B.CONTAINER_OPTIONS_INVALID_SKIP_BASE_CHECK);this.options={autoBindInjectable:ce.autoBindInjectable,defaultScope:ce.defaultScope,skipBaseClassChecks:ce.skipBaseClassChecks},this.id=be.id(),this._bindingDictionary=new De.Lookup,this._snapshots=[],this._middleware=null,this.parent=null,this._metadataReader=new q.MetadataReader}return Re.merge=function(Me,ce){for(var Be=[],Ee=2;Ee<arguments.length;Ee++)Be[Ee-2]=arguments[Ee];var Se=new Re,oe=G([Me,ce],Be).map(function(ge){return ie.getBindingDictionary(ge)}),Y=ie.getBindingDictionary(Se);function Ne(ge,xe){ge.traverse(function(ye,Q){Q.forEach(function(Pe){xe.add(Pe.serviceIdentifier,Pe.clone())})})}return oe.forEach(function(ge){Ne(ge,Y)}),Se},Re.prototype.load=function(){for(var Me=[],ce=0;ce<arguments.length;ce++)Me[ce]=arguments[ce];for(var Be=this._getContainerModuleHelpersFactory(),Ee=0,Se=Me;Ee<Se.length;Ee++){var oe=Se[Ee],Y=Be(oe.id);oe.registry(Y.bindFunction,Y.unbindFunction,Y.isboundFunction,Y.rebindFunction)}},Re.prototype.loadAsync=function(){for(var Me=[],ce=0;ce<arguments.length;ce++)Me[ce]=arguments[ce];return I(this,void 0,void 0,function(){var Be,Ee,Se,oe,Y;return D(this,function(Ne){switch(Ne.label){case 0:Be=this._getContainerModuleHelpersFactory(),Ee=0,Se=Me,Ne.label=1;case 1:return Ee<Se.length?(oe=Se[Ee],Y=Be(oe.id),[4,oe.registry(Y.bindFunction,Y.unbindFunction,Y.isboundFunction,Y.rebindFunction)]):[3,4];case 2:Ne.sent(),Ne.label=3;case 3:return Ee++,[3,1];case 4:return[2]}})})},Re.prototype.unload=function(){for(var Me=this,ce=[],Be=0;Be<arguments.length;Be++)ce[Be]=arguments[Be];var Ee=function(Se){return function(oe){return oe.moduleId===Se}};ce.forEach(function(Se){var oe=Ee(Se.id);Me._bindingDictionary.removeByCondition(oe)})},Re.prototype.bind=function(Me){var ce=this.options.defaultScope||Z.BindingScopeEnum.Transient,Be=new U.Binding(Me,ce);return this._bindingDictionary.add(Me,Be),new Ce.BindingToSyntax(Be)},Re.prototype.rebind=function(Me){return this.unbind(Me),this.bind(Me)},Re.prototype.unbind=function(Me){try{this._bindingDictionary.remove(Me)}catch(ce){throw new Error(B.CANNOT_UNBIND+" "+Ze.getServiceIdentifierAsString(Me))}},Re.prototype.unbindAll=function(){this._bindingDictionary=new De.Lookup},Re.prototype.isBound=function(Me){var ce=this._bindingDictionary.hasKey(Me);return!ce&&this.parent&&(ce=this.parent.isBound(Me)),ce},Re.prototype.isBoundNamed=function(Me,ce){return this.isBoundTagged(Me,X.NAMED_TAG,ce)},Re.prototype.isBoundTagged=function(Me,ce,Be){var Ee=!1;if(this._bindingDictionary.hasKey(Me)){var Se=this._bindingDictionary.get(Me),oe=ie.createMockRequest(this,Me,ce,Be);Ee=Se.some(function(Y){return Y.constraint(oe)})}return!Ee&&this.parent&&(Ee=this.parent.isBoundTagged(Me,ce,Be)),Ee},Re.prototype.snapshot=function(){this._snapshots.push(qe.ContainerSnapshot.of(this._bindingDictionary.clone(),this._middleware))},Re.prototype.restore=function(){var Me=this._snapshots.pop();if(Me===void 0)throw new Error(B.NO_MORE_SNAPSHOTS_AVAILABLE);this._bindingDictionary=Me.bindings,this._middleware=Me.middleware},Re.prototype.createChild=function(Me){var ce=new Re(Me||this.options);return ce.parent=this,ce},Re.prototype.applyMiddleware=function(){for(var Me=[],ce=0;ce<arguments.length;ce++)Me[ce]=arguments[ce];this._appliedMiddleware=this._appliedMiddleware.concat(Me);var Be=this._middleware?this._middleware:this._planAndResolve();this._middleware=Me.reduce(function(Ee,Se){return Se(Ee)},Be)},Re.prototype.applyCustomMetadataReader=function(Me){this._metadataReader=Me},Re.prototype.get=function(Me){return this._get(!1,!1,Z.TargetTypeEnum.Variable,Me)},Re.prototype.getTagged=function(Me,ce,Be){return this._get(!1,!1,Z.TargetTypeEnum.Variable,Me,ce,Be)},Re.prototype.getNamed=function(Me,ce){return this.getTagged(Me,X.NAMED_TAG,ce)},Re.prototype.getAll=function(Me){return this._get(!0,!0,Z.TargetTypeEnum.Variable,Me)},Re.prototype.getAllTagged=function(Me,ce,Be){return this._get(!1,!0,Z.TargetTypeEnum.Variable,Me,ce,Be)},Re.prototype.getAllNamed=function(Me,ce){return this.getAllTagged(Me,X.NAMED_TAG,ce)},Re.prototype.resolve=function(Me){var ce=this.createChild();return ce.bind(Me).toSelf(),this._appliedMiddleware.forEach(function(Be){ce.applyMiddleware(Be)}),ce.get(Me)},Re.prototype._getContainerModuleHelpersFactory=function(){var Me=this,ce=function(Y,Ne){Y._binding.moduleId=Ne},Be=function(Y){return function(Ne){var ge=Me.bind.bind(Me),xe=ge(Ne);return ce(xe,Y),xe}},Ee=function(Y){return function(Ne){var ge=Me.unbind.bind(Me);ge(Ne)}},Se=function(Y){return function(Ne){var ge=Me.isBound.bind(Me);return ge(Ne)}},oe=function(Y){return function(Ne){var ge=Me.rebind.bind(Me),xe=ge(Ne);return ce(xe,Y),xe}};return function(Y){return{bindFunction:Be(Y),isboundFunction:Se(Y),rebindFunction:oe(Y),unbindFunction:Ee(Y)}}},Re.prototype._get=function(Me,ce,Be,Ee,Se,oe){var Y=null,Ne={avoidConstraints:Me,contextInterceptor:function(ge){return ge},isMultiInject:ce,key:Se,serviceIdentifier:Ee,targetType:Be,value:oe};if(this._middleware){if(Y=this._middleware(Ne),Y==null)throw new Error(B.INVALID_MIDDLEWARE_RETURN)}else Y=this._planAndResolve()(Ne);return Y},Re.prototype._planAndResolve=function(){var Me=this;return function(ce){var Be=ie.plan(Me._metadataReader,Me,ce.isMultiInject,ce.targetType,ce.serviceIdentifier,ce.key,ce.value,ce.avoidConstraints);Be=ce.contextInterceptor(Be);var Ee=he.resolve(Be);return Ee}},Re}();j.Container=Ge},42913:function(ae,j,C){"use strict";Object.defineProperty(j,"__esModule",{value:!0}),j.AsyncContainerModule=j.ContainerModule=void 0;var I=C(70023),D=function(){function U(B){this.id=I.id(),this.registry=B}return U}();j.ContainerModule=D;var G=function(){function U(B){this.id=I.id(),this.registry=B}return U}();j.AsyncContainerModule=G},71878:function(ae,j){"use strict";Object.defineProperty(j,"__esModule",{value:!0}),j.ContainerSnapshot=void 0;var C=function(){function I(){}return I.of=function(D,G){var U=new I;return U.bindings=D,U.middleware=G,U},I}();j.ContainerSnapshot=C},82543:function(ae,j,C){"use strict";Object.defineProperty(j,"__esModule",{value:!0}),j.Lookup=void 0;var I=C(36078),D=function(){function G(){this._map=new Map}return G.prototype.getMap=function(){return this._map},G.prototype.add=function(U,B){if(U==null)throw new Error(I.NULL_ARGUMENT);if(B==null)throw new Error(I.NULL_ARGUMENT);var Z=this._map.get(U);Z!==void 0?(Z.push(B),this._map.set(U,Z)):this._map.set(U,[B])},G.prototype.get=function(U){if(U==null)throw new Error(I.NULL_ARGUMENT);var B=this._map.get(U);if(B!==void 0)return B;throw new Error(I.KEY_NOT_FOUND)},G.prototype.remove=function(U){if(U==null)throw new Error(I.NULL_ARGUMENT);if(!this._map.delete(U))throw new Error(I.KEY_NOT_FOUND)},G.prototype.removeByCondition=function(U){var B=this;this._map.forEach(function(Z,X){var q=Z.filter(function(ie){return!U(ie)});q.length>0?B._map.set(X,q):B._map.delete(X)})},G.prototype.hasKey=function(U){if(U==null)throw new Error(I.NULL_ARGUMENT);return this._map.has(U)},G.prototype.clone=function(){var U=new G;return this._map.forEach(function(B,Z){B.forEach(function(X){return U.add(Z,X.clone())})}),U},G.prototype.traverse=function(U){this._map.forEach(function(B,Z){U(Z,B)})},G}();j.Lookup=D},99311:function(ae,j,C){"use strict";var I;I={value:!0},I=I=I=I=I=I=j.GW=I=I=j.zY=I=I=I=I=I=j.f3=I=I=j.b2=I=I=I=I=I=j.W2=I=void 0;var D=C(50295);I=D;var G=C(70596);Object.defineProperty(j,"W2",{enumerable:!0,get:function(){return G.Container}});var U=C(77690);I={enumerable:!0,get:function(){return U.BindingScopeEnum}},I={enumerable:!0,get:function(){return U.BindingTypeEnum}},I={enumerable:!0,get:function(){return U.TargetTypeEnum}};var B=C(42913);I={enumerable:!0,get:function(){return B.AsyncContainerModule}},I={enumerable:!0,get:function(){return B.ContainerModule}};var Z=C(91773);Object.defineProperty(j,"b2",{enumerable:!0,get:function(){return Z.injectable}});var X=C(79189);I={enumerable:!0,get:function(){return X.tagged}};var q=C(79817);I={enumerable:!0,get:function(){return q.named}};var ie=C(76213);Object.defineProperty(j,"f3",{enumerable:!0,get:function(){return ie.inject}}),I={enumerable:!0,get:function(){return ie.LazyServiceIdentifer}};var he=C(71316);I={enumerable:!0,get:function(){return he.optional}};var Ce=C(19235);I={enumerable:!0,get:function(){return Ce.unmanaged}};var be=C(41528);I={enumerable:!0,get:function(){return be.multiInject}};var Ze=C(8245);I={enumerable:!0,get:function(){return Ze.targetName}};var qe=C(71971);Object.defineProperty(j,"zY",{enumerable:!0,get:function(){return qe.postConstruct}});var De=C(43870);I={enumerable:!0,get:function(){return De.MetadataReader}};var Ge=C(70023);I={enumerable:!0,get:function(){return Ge.id}};var Re=C(80626);Object.defineProperty(j,"GW",{enumerable:!0,get:function(){return Re.decorate}});var Me=C(83140);I={enumerable:!0,get:function(){return Me.traverseAncerstors}},I={enumerable:!0,get:function(){return Me.taggedConstraint}},I={enumerable:!0,get:function(){return Me.namedConstraint}},I={enumerable:!0,get:function(){return Me.typeConstraint}};var ce=C(29552);I={enumerable:!0,get:function(){return ce.getServiceIdentifierAsString}};var Be=C(34384);I={enumerable:!0,get:function(){return Be.multiBindToService}}},91519:function(ae,j,C){"use strict";Object.defineProperty(j,"__esModule",{value:!0}),j.Context=void 0;var I=C(70023),D=function(){function G(U){this.id=I.id(),this.container=U}return G.prototype.addPlan=function(U){this.plan=U},G.prototype.setCurrentRequest=function(U){this.currentRequest=U},G}();j.Context=D},25092:function(ae,j,C){"use strict";Object.defineProperty(j,"__esModule",{value:!0}),j.Metadata=void 0;var I=C(50295),D=function(){function G(U,B){this.key=U,this.value=B}return G.prototype.toString=function(){return this.key===I.NAMED_TAG?"named: "+this.value.toString()+" ":"tagged: { key:"+this.key.toString()+", value: "+this.value+" }"},G}();j.Metadata=D},43870:function(ae,j,C){"use strict";Object.defineProperty(j,"__esModule",{value:!0}),j.MetadataReader=void 0;var I=C(50295),D=function(){function G(){}return G.prototype.getConstructorMetadata=function(U){var B=Reflect.getMetadata(I.PARAM_TYPES,U),Z=Reflect.getMetadata(I.TAGGED,U);return{compilerGeneratedMetadata:B,userGeneratedMetadata:Z||{}}},G.prototype.getPropertiesMetadata=function(U){var B=Reflect.getMetadata(I.TAGGED_PROP,U)||[];return B},G}();j.MetadataReader=D},6335:function(ae,j){"use strict";Object.defineProperty(j,"__esModule",{value:!0}),j.Plan=void 0;var C=function(){function I(D,G){this.parentContext=D,this.rootRequest=G}return I}();j.Plan=C},54142:function(ae,j,C){"use strict";Object.defineProperty(j,"__esModule",{value:!0}),j.getBindingDictionary=j.createMockRequest=j.plan=void 0;var I=C(13497),D=C(36078),G=C(77690),U=C(50295),B=C(92542),Z=C(29552),X=C(91519),q=C(25092),ie=C(6335),he=C(16664),Ce=C(14810),be=C(69660);function Ze(Ee){return Ee._bindingDictionary}j.getBindingDictionary=Ze;function qe(Ee,Se,oe,Y,Ne,ge){var xe=Ee?U.MULTI_INJECT_TAG:U.INJECT_TAG,ye=new q.Metadata(xe,oe),Q=new be.Target(Se,Y,oe,ye);if(Ne!==void 0){var Pe=new q.Metadata(Ne,ge);Q.metadata.push(Pe)}return Q}function De(Ee,Se,oe,Y,Ne){var ge=Me(oe.container,Ne.serviceIdentifier),xe=[];return ge.length===I.BindingCount.NoBindingsAvailable&&oe.container.options.autoBindInjectable&&typeof Ne.serviceIdentifier=="function"&&Ee.getConstructorMetadata(Ne.serviceIdentifier).compilerGeneratedMetadata&&(oe.container.bind(Ne.serviceIdentifier).toSelf(),ge=Me(oe.container,Ne.serviceIdentifier)),Se?xe=ge:xe=ge.filter(function(ye){var Q=new Ce.Request(ye.serviceIdentifier,oe,Y,ye,Ne);return ye.constraint(Q)}),Ge(Ne.serviceIdentifier,xe,Ne,oe.container),xe}function Ge(Ee,Se,oe,Y){switch(Se.length){case I.BindingCount.NoBindingsAvailable:if(oe.isOptional())return Se;var Ne=Z.getServiceIdentifierAsString(Ee),ge=D.NOT_REGISTERED;throw ge+=Z.listMetadataForTarget(Ne,oe),ge+=Z.listRegisteredBindingsForServiceIdentifier(Y,Ne,Me),new Error(ge);case I.BindingCount.OnlyOneBindingAvailable:if(!oe.isArray())return Se;case I.BindingCount.MultipleBindingsAvailable:default:if(oe.isArray())return Se;var Ne=Z.getServiceIdentifierAsString(Ee),ge=D.AMBIGUOUS_MATCH+" "+Ne;throw ge+=Z.listRegisteredBindingsForServiceIdentifier(Y,Ne,Me),new Error(ge)}}function Re(Ee,Se,oe,Y,Ne,ge){var xe,ye;if(Ne===null){xe=De(Ee,Se,Y,null,ge),ye=new Ce.Request(oe,Y,null,xe,ge);var Q=new ie.Plan(Y,ye);Y.addPlan(Q)}else xe=De(Ee,Se,Y,Ne,ge),ye=Ne.addChildRequest(ge.serviceIdentifier,xe,ge);xe.forEach(function(Pe){var Ae=null;if(ge.isArray())Ae=ye.addChildRequest(Pe.serviceIdentifier,Pe,ge);else{if(Pe.cache)return;Ae=ye}if(Pe.type===G.BindingTypeEnum.Instance&&Pe.implementationType!==null){var _e=he.getDependencies(Ee,Pe.implementationType);if(!Y.container.options.skipBaseClassChecks){var ue=he.getBaseClassDependencyCount(Ee,Pe.implementationType);if(_e.length<ue){var ke=D.ARGUMENTS_LENGTH_MISMATCH(he.getFunctionName(Pe.implementationType));throw new Error(ke)}}_e.forEach(function(ze){Re(Ee,!1,ze.serviceIdentifier,Y,Ae,ze)})}})}function Me(Ee,Se){var oe=[],Y=Ze(Ee);return Y.hasKey(Se)?oe=Y.get(Se):Ee.parent!==null&&(oe=Me(Ee.parent,Se)),oe}function ce(Ee,Se,oe,Y,Ne,ge,xe,ye){ye===void 0&&(ye=!1);var Q=new X.Context(Se),Pe=qe(oe,Y,Ne,"",ge,xe);try{return Re(Ee,ye,Ne,Q,null,Pe),Q}catch(Ae){throw B.isStackOverflowExeption(Ae)&&Q.plan&&Z.circularDependencyToException(Q.plan.rootRequest),Ae}}j.plan=ce;function Be(Ee,Se,oe,Y){var Ne=new be.Target(G.TargetTypeEnum.Variable,"",Se,new q.Metadata(oe,Y)),ge=new X.Context(Ee),xe=new Ce.Request(Se,ge,null,[],Ne);return xe}j.createMockRequest=Be},68634:function(ae,j){"use strict";Object.defineProperty(j,"__esModule",{value:!0}),j.QueryableString=void 0;var C=function(){function I(D){this.str=D}return I.prototype.startsWith=function(D){return this.str.indexOf(D)===0},I.prototype.endsWith=function(D){var G="",U=D.split("").reverse().join("");return G=this.str.split("").reverse().join(""),this.startsWith.call({str:G},U)},I.prototype.contains=function(D){return this.str.indexOf(D)!==-1},I.prototype.equals=function(D){return this.str===D},I.prototype.value=function(){return this.str},I}();j.QueryableString=C},16664:function(ae,j,C){"use strict";var I=this&&this.__spreadArray||function(De,Ge){for(var Re=0,Me=Ge.length,ce=De.length;Re<Me;Re++,ce++)De[ce]=Ge[Re];return De};Object.defineProperty(j,"__esModule",{value:!0}),j.getFunctionName=j.getBaseClassDependencyCount=j.getDependencies=void 0;var D=C(76213),G=C(36078),U=C(77690),B=C(50295),Z=C(29552);Object.defineProperty(j,"getFunctionName",{enumerable:!0,get:function(){return Z.getFunctionName}});var X=C(69660);function q(De,Ge){var Re=Z.getFunctionName(Ge),Me=ie(De,Re,Ge,!1);return Me}j.getDependencies=q;function ie(De,Ge,Re,Me){var ce=De.getConstructorMetadata(Re),Be=ce.compilerGeneratedMetadata;if(Be===void 0){var Ee=G.MISSING_INJECTABLE_ANNOTATION+" "+Ge+".";throw new Error(Ee)}var Se=ce.userGeneratedMetadata,oe=Object.keys(Se),Y=Re.length===0&&oe.length>0,Ne=oe.length>Re.length,ge=Y||Ne?oe.length:Re.length,xe=Ce(Me,Ge,Be,Se,ge),ye=be(De,Re),Q=I(I([],xe),ye);return Q}function he(De,Ge,Re,Me,ce){var Be=ce[De.toString()]||[],Ee=qe(Be),Se=Ee.unmanaged!==!0,oe=Me[De],Y=Ee.inject||Ee.multiInject;if(oe=Y||oe,oe instanceof D.LazyServiceIdentifer&&(oe=oe.unwrap()),Se){var Ne=oe===Object,ge=oe===Function,xe=oe===void 0,ye=Ne||ge||xe;if(!Ge&&ye){var Q=G.MISSING_INJECT_ANNOTATION+" argument "+De+" in class "+Re+".";throw new Error(Q)}var Pe=new X.Target(U.TargetTypeEnum.ConstructorArgument,Ee.targetName,oe);return Pe.metadata=Be,Pe}return null}function Ce(De,Ge,Re,Me,ce){for(var Be=[],Ee=0;Ee<ce;Ee++){var Se=Ee,oe=he(Se,De,Ge,Re,Me);oe!==null&&Be.push(oe)}return Be}function be(De,Ge){for(var Re=De.getPropertiesMetadata(Ge),Me=[],ce=Object.keys(Re),Be=0,Ee=ce;Be<Ee.length;Be++){var Se=Ee[Be],oe=Re[Se],Y=qe(Re[Se]),Ne=Y.targetName||Se,ge=Y.inject||Y.multiInject,xe=new X.Target(U.TargetTypeEnum.ClassProperty,Ne,ge);xe.metadata=oe,Me.push(xe)}var ye=Object.getPrototypeOf(Ge.prototype).constructor;if(ye!==Object){var Q=be(De,ye);Me=I(I([],Me),Q)}return Me}function Ze(De,Ge){var Re=Object.getPrototypeOf(Ge.prototype).constructor;if(Re!==Object){var Me=Z.getFunctionName(Re),ce=ie(De,Me,Re,!0),Be=ce.map(function(oe){return oe.metadata.filter(function(Y){return Y.key===B.UNMANAGED_TAG})}),Ee=[].concat.apply([],Be).length,Se=ce.length-Ee;return Se>0?Se:Ze(De,Re)}else return 0}j.getBaseClassDependencyCount=Ze;function qe(De){var Ge={};return De.forEach(function(Re){Ge[Re.key.toString()]=Re.value}),{inject:Ge[B.INJECT_TAG],multiInject:Ge[B.MULTI_INJECT_TAG],targetName:Ge[B.NAME_TAG],unmanaged:Ge[B.UNMANAGED_TAG]}}},14810:function(ae,j,C){"use strict";Object.defineProperty(j,"__esModule",{value:!0}),j.Request=void 0;var I=C(70023),D=function(){function G(U,B,Z,X,q){this.id=I.id(),this.serviceIdentifier=U,this.parentContext=B,this.parentRequest=Z,this.target=q,this.childRequests=[],this.bindings=Array.isArray(X)?X:[X],this.requestScope=Z===null?new Map:null}return G.prototype.addChildRequest=function(U,B,Z){var X=new G(U,this.parentContext,this,B,Z);return this.childRequests.push(X),X},G}();j.Request=D},69660:function(ae,j,C){"use strict";Object.defineProperty(j,"__esModule",{value:!0}),j.Target=void 0;var I=C(50295),D=C(70023),G=C(25092),U=C(68634),B=function(){function Z(X,q,ie,he){this.id=D.id(),this.type=X,this.serviceIdentifier=ie,this.name=new U.QueryableString(q||""),this.metadata=new Array;var Ce=null;typeof he=="string"?Ce=new G.Metadata(I.NAMED_TAG,he):he instanceof G.Metadata&&(Ce=he),Ce!==null&&this.metadata.push(Ce)}return Z.prototype.hasTag=function(X){for(var q=0,ie=this.metadata;q<ie.length;q++){var he=ie[q];if(he.key===X)return!0}return!1},Z.prototype.isArray=function(){return this.hasTag(I.MULTI_INJECT_TAG)},Z.prototype.matchesArray=function(X){return this.matchesTag(I.MULTI_INJECT_TAG)(X)},Z.prototype.isNamed=function(){return this.hasTag(I.NAMED_TAG)},Z.prototype.isTagged=function(){return this.metadata.some(function(X){return I.NON_CUSTOM_TAG_KEYS.every(function(q){return X.key!==q})})},Z.prototype.isOptional=function(){return this.matchesTag(I.OPTIONAL_TAG)(!0)},Z.prototype.getNamedTag=function(){return this.isNamed()?this.metadata.filter(function(X){return X.key===I.NAMED_TAG})[0]:null},Z.prototype.getCustomTags=function(){return this.isTagged()?this.metadata.filter(function(X){return I.NON_CUSTOM_TAG_KEYS.every(function(q){return X.key!==q})}):null},Z.prototype.matchesNamedTag=function(X){return this.matchesTag(I.NAMED_TAG)(X)},Z.prototype.matchesTag=function(X){var q=this;return function(ie){for(var he=0,Ce=q.metadata;he<Ce.length;he++){var be=Ce[he];if(be.key===X&&be.value===ie)return!0}return!1}},Z}();j.Target=B},74962:function(ae,j,C){"use strict";var I=this&&this.__spreadArray||function(ie,he){for(var Ce=0,be=he.length,Ze=ie.length;Ce<be;Ce++,Ze++)ie[Ze]=he[Ce];return ie};Object.defineProperty(j,"__esModule",{value:!0}),j.resolveInstance=void 0;var D=C(36078),G=C(77690),U=C(50295);function B(ie,he,Ce){var be=he.filter(function(qe){return qe.target!==null&&qe.target.type===G.TargetTypeEnum.ClassProperty}),Ze=be.map(Ce);return be.forEach(function(qe,De){var Ge="";Ge=qe.target.name.value();var Re=Ze[De];ie[Ge]=Re}),ie}function Z(ie,he){return new(ie.bind.apply(ie,I([void 0],he)))}function X(ie,he){if(Reflect.hasMetadata(U.POST_CONSTRUCT,ie)){var Ce=Reflect.getMetadata(U.POST_CONSTRUCT,ie);try{he[Ce.value]()}catch(be){throw new Error(D.POST_CONSTRUCT_ERROR(ie.name,be.message))}}}function q(ie,he,Ce){var be=null;if(he.length>0){var Ze=he.filter(function(De){return De.target!==null&&De.target.type===G.TargetTypeEnum.ConstructorArgument}),qe=Ze.map(Ce);be=Z(ie,qe),be=B(be,he,Ce)}else be=new ie;return X(ie,be),be}j.resolveInstance=q},9386:function(ae,j,C){"use strict";Object.defineProperty(j,"__esModule",{value:!0}),j.resolve=void 0;var I=C(36078),D=C(77690),G=C(92542),U=C(29552),B=C(74962),Z=function(ie,he,Ce){try{return Ce()}catch(be){throw G.isStackOverflowExeption(be)?new Error(I.CIRCULAR_DEPENDENCY_IN_FACTORY(ie,he.toString())):be}},X=function(ie){return function(he){he.parentContext.setCurrentRequest(he);var Ce=he.bindings,be=he.childRequests,Ze=he.target&&he.target.isArray(),qe=!he.parentRequest||!he.parentRequest.target||!he.target||!he.parentRequest.target.matchesArray(he.target.serviceIdentifier);if(Ze&&qe)return be.map(function(Be){var Ee=X(ie);return Ee(Be)});var De=null;if(he.target.isOptional()&&Ce.length===0)return;var Ge=Ce[0],Re=Ge.scope===D.BindingScopeEnum.Singleton,Me=Ge.scope===D.BindingScopeEnum.Request;if(Re&&Ge.activated)return Ge.cache;if(Me&&ie!==null&&ie.has(Ge.id))return ie.get(Ge.id);if(Ge.type===D.BindingTypeEnum.ConstantValue)De=Ge.cache,Ge.activated=!0;else if(Ge.type===D.BindingTypeEnum.Function)De=Ge.cache,Ge.activated=!0;else if(Ge.type===D.BindingTypeEnum.Constructor)De=Ge.implementationType;else if(Ge.type===D.BindingTypeEnum.DynamicValue&&Ge.dynamicValue!==null)De=Z("toDynamicValue",Ge.serviceIdentifier,function(){return Ge.dynamicValue(he.parentContext)});else if(Ge.type===D.BindingTypeEnum.Factory&&Ge.factory!==null)De=Z("toFactory",Ge.serviceIdentifier,function(){return Ge.factory(he.parentContext)});else if(Ge.type===D.BindingTypeEnum.Provider&&Ge.provider!==null)De=Z("toProvider",Ge.serviceIdentifier,function(){return Ge.provider(he.parentContext)});else if(Ge.type===D.BindingTypeEnum.Instance&&Ge.implementationType!==null)De=B.resolveInstance(Ge.implementationType,be,X(ie));else{var ce=U.getServiceIdentifierAsString(he.serviceIdentifier);throw new Error(I.INVALID_BINDING_TYPE+" "+ce)}return typeof Ge.onActivation=="function"&&(De=Ge.onActivation(he.parentContext,De)),Re&&(Ge.cache=De,Ge.activated=!0),Me&&ie!==null&&!ie.has(Ge.id)&&ie.set(Ge.id,De),De}};function q(ie){var he=X(ie.plan.rootRequest.requestScope);return he(ie.plan.rootRequest)}j.resolve=q},91640:function(ae,j,C){"use strict";Object.defineProperty(j,"__esModule",{value:!0}),j.BindingInSyntax=void 0;var I=C(77690),D=C(46890),G=function(){function U(B){this._binding=B}return U.prototype.inRequestScope=function(){return this._binding.scope=I.BindingScopeEnum.Request,new D.BindingWhenOnSyntax(this._binding)},U.prototype.inSingletonScope=function(){return this._binding.scope=I.BindingScopeEnum.Singleton,new D.BindingWhenOnSyntax(this._binding)},U.prototype.inTransientScope=function(){return this._binding.scope=I.BindingScopeEnum.Transient,new D.BindingWhenOnSyntax(this._binding)},U}();j.BindingInSyntax=G},82386:function(ae,j,C){"use strict";Object.defineProperty(j,"__esModule",{value:!0}),j.BindingInWhenOnSyntax=void 0;var I=C(91640),D=C(8926),G=C(36890),U=function(){function B(Z){this._binding=Z,this._bindingWhenSyntax=new G.BindingWhenSyntax(this._binding),this._bindingOnSyntax=new D.BindingOnSyntax(this._binding),this._bindingInSyntax=new I.BindingInSyntax(Z)}return B.prototype.inRequestScope=function(){return this._bindingInSyntax.inRequestScope()},B.prototype.inSingletonScope=function(){return this._bindingInSyntax.inSingletonScope()},B.prototype.inTransientScope=function(){return this._bindingInSyntax.inTransientScope()},B.prototype.when=function(Z){return this._bindingWhenSyntax.when(Z)},B.prototype.whenTargetNamed=function(Z){return this._bindingWhenSyntax.whenTargetNamed(Z)},B.prototype.whenTargetIsDefault=function(){return this._bindingWhenSyntax.whenTargetIsDefault()},B.prototype.whenTargetTagged=function(Z,X){return this._bindingWhenSyntax.whenTargetTagged(Z,X)},B.prototype.whenInjectedInto=function(Z){return this._bindingWhenSyntax.whenInjectedInto(Z)},B.prototype.whenParentNamed=function(Z){return this._bindingWhenSyntax.whenParentNamed(Z)},B.prototype.whenParentTagged=function(Z,X){return this._bindingWhenSyntax.whenParentTagged(Z,X)},B.prototype.whenAnyAncestorIs=function(Z){return this._bindingWhenSyntax.whenAnyAncestorIs(Z)},B.prototype.whenNoAncestorIs=function(Z){return this._bindingWhenSyntax.whenNoAncestorIs(Z)},B.prototype.whenAnyAncestorNamed=function(Z){return this._bindingWhenSyntax.whenAnyAncestorNamed(Z)},B.prototype.whenAnyAncestorTagged=function(Z,X){return this._bindingWhenSyntax.whenAnyAncestorTagged(Z,X)},B.prototype.whenNoAncestorNamed=function(Z){return this._bindingWhenSyntax.whenNoAncestorNamed(Z)},B.prototype.whenNoAncestorTagged=function(Z,X){return this._bindingWhenSyntax.whenNoAncestorTagged(Z,X)},B.prototype.whenAnyAncestorMatches=function(Z){return this._bindingWhenSyntax.whenAnyAncestorMatches(Z)},B.prototype.whenNoAncestorMatches=function(Z){return this._bindingWhenSyntax.whenNoAncestorMatches(Z)},B.prototype.onActivation=function(Z){return this._bindingOnSyntax.onActivation(Z)},B}();j.BindingInWhenOnSyntax=U},8926:function(ae,j,C){"use strict";Object.defineProperty(j,"__esModule",{value:!0}),j.BindingOnSyntax=void 0;var I=C(36890),D=function(){function G(U){this._binding=U}return G.prototype.onActivation=function(U){return this._binding.onActivation=U,new I.BindingWhenSyntax(this._binding)},G}();j.BindingOnSyntax=D},43313:function(ae,j,C){"use strict";Object.defineProperty(j,"__esModule",{value:!0}),j.BindingToSyntax=void 0;var I=C(36078),D=C(77690),G=C(82386),U=C(46890),B=function(){function Z(X){this._binding=X}return Z.prototype.to=function(X){return this._binding.type=D.BindingTypeEnum.Instance,this._binding.implementationType=X,new G.BindingInWhenOnSyntax(this._binding)},Z.prototype.toSelf=function(){if(typeof this._binding.serviceIdentifier!="function")throw new Error(""+I.INVALID_TO_SELF_VALUE);var X=this._binding.serviceIdentifier;return this.to(X)},Z.prototype.toConstantValue=function(X){return this._binding.type=D.BindingTypeEnum.ConstantValue,this._binding.cache=X,this._binding.dynamicValue=null,this._binding.implementationType=null,this._binding.scope=D.BindingScopeEnum.Singleton,new U.BindingWhenOnSyntax(this._binding)},Z.prototype.toDynamicValue=function(X){return this._binding.type=D.BindingTypeEnum.DynamicValue,this._binding.cache=null,this._binding.dynamicValue=X,this._binding.implementationType=null,new G.BindingInWhenOnSyntax(this._binding)},Z.prototype.toConstructor=function(X){return this._binding.type=D.BindingTypeEnum.Constructor,this._binding.implementationType=X,this._binding.scope=D.BindingScopeEnum.Singleton,new U.BindingWhenOnSyntax(this._binding)},Z.prototype.toFactory=function(X){return this._binding.type=D.BindingTypeEnum.Factory,this._binding.factory=X,this._binding.scope=D.BindingScopeEnum.Singleton,new U.BindingWhenOnSyntax(this._binding)},Z.prototype.toFunction=function(X){if(typeof X!="function")throw new Error(I.INVALID_FUNCTION_BINDING);var q=this.toConstantValue(X);return this._binding.type=D.BindingTypeEnum.Function,this._binding.scope=D.BindingScopeEnum.Singleton,q},Z.prototype.toAutoFactory=function(X){return this._binding.type=D.BindingTypeEnum.Factory,this._binding.factory=function(q){var ie=function(){return q.container.get(X)};return ie},this._binding.scope=D.BindingScopeEnum.Singleton,new U.BindingWhenOnSyntax(this._binding)},Z.prototype.toProvider=function(X){return this._binding.type=D.BindingTypeEnum.Provider,this._binding.provider=X,this._binding.scope=D.BindingScopeEnum.Singleton,new U.BindingWhenOnSyntax(this._binding)},Z.prototype.toService=function(X){this.toDynamicValue(function(q){return q.container.get(X)})},Z}();j.BindingToSyntax=B},46890:function(ae,j,C){"use strict";Object.defineProperty(j,"__esModule",{value:!0}),j.BindingWhenOnSyntax=void 0;var I=C(8926),D=C(36890),G=function(){function U(B){this._binding=B,this._bindingWhenSyntax=new D.BindingWhenSyntax(this._binding),this._bindingOnSyntax=new I.BindingOnSyntax(this._binding)}return U.prototype.when=function(B){return this._bindingWhenSyntax.when(B)},U.prototype.whenTargetNamed=function(B){return this._bindingWhenSyntax.whenTargetNamed(B)},U.prototype.whenTargetIsDefault=function(){return this._bindingWhenSyntax.whenTargetIsDefault()},U.prototype.whenTargetTagged=function(B,Z){return this._bindingWhenSyntax.whenTargetTagged(B,Z)},U.prototype.whenInjectedInto=function(B){return this._bindingWhenSyntax.whenInjectedInto(B)},U.prototype.whenParentNamed=function(B){return this._bindingWhenSyntax.whenParentNamed(B)},U.prototype.whenParentTagged=function(B,Z){return this._bindingWhenSyntax.whenParentTagged(B,Z)},U.prototype.whenAnyAncestorIs=function(B){return this._bindingWhenSyntax.whenAnyAncestorIs(B)},U.prototype.whenNoAncestorIs=function(B){return this._bindingWhenSyntax.whenNoAncestorIs(B)},U.prototype.whenAnyAncestorNamed=function(B){return this._bindingWhenSyntax.whenAnyAncestorNamed(B)},U.prototype.whenAnyAncestorTagged=function(B,Z){return this._bindingWhenSyntax.whenAnyAncestorTagged(B,Z)},U.prototype.whenNoAncestorNamed=function(B){return this._bindingWhenSyntax.whenNoAncestorNamed(B)},U.prototype.whenNoAncestorTagged=function(B,Z){return this._bindingWhenSyntax.whenNoAncestorTagged(B,Z)},U.prototype.whenAnyAncestorMatches=function(B){return this._bindingWhenSyntax.whenAnyAncestorMatches(B)},U.prototype.whenNoAncestorMatches=function(B){return this._bindingWhenSyntax.whenNoAncestorMatches(B)},U.prototype.onActivation=function(B){return this._bindingOnSyntax.onActivation(B)},U}();j.BindingWhenOnSyntax=G},36890:function(ae,j,C){"use strict";Object.defineProperty(j,"__esModule",{value:!0}),j.BindingWhenSyntax=void 0;var I=C(8926),D=C(83140),G=function(){function U(B){this._binding=B}return U.prototype.when=function(B){return this._binding.constraint=B,new I.BindingOnSyntax(this._binding)},U.prototype.whenTargetNamed=function(B){return this._binding.constraint=D.namedConstraint(B),new I.BindingOnSyntax(this._binding)},U.prototype.whenTargetIsDefault=function(){return this._binding.constraint=function(B){var Z=B.target!==null&&!B.target.isNamed()&&!B.target.isTagged();return Z},new I.BindingOnSyntax(this._binding)},U.prototype.whenTargetTagged=function(B,Z){return this._binding.constraint=D.taggedConstraint(B)(Z),new I.BindingOnSyntax(this._binding)},U.prototype.whenInjectedInto=function(B){return this._binding.constraint=function(Z){return D.typeConstraint(B)(Z.parentRequest)},new I.BindingOnSyntax(this._binding)},U.prototype.whenParentNamed=function(B){return this._binding.constraint=function(Z){return D.namedConstraint(B)(Z.parentRequest)},new I.BindingOnSyntax(this._binding)},U.prototype.whenParentTagged=function(B,Z){return this._binding.constraint=function(X){return D.taggedConstraint(B)(Z)(X.parentRequest)},new I.BindingOnSyntax(this._binding)},U.prototype.whenAnyAncestorIs=function(B){return this._binding.constraint=function(Z){return D.traverseAncerstors(Z,D.typeConstraint(B))},new I.BindingOnSyntax(this._binding)},U.prototype.whenNoAncestorIs=function(B){return this._binding.constraint=function(Z){return!D.traverseAncerstors(Z,D.typeConstraint(B))},new I.BindingOnSyntax(this._binding)},U.prototype.whenAnyAncestorNamed=function(B){return this._binding.constraint=function(Z){return D.traverseAncerstors(Z,D.namedConstraint(B))},new I.BindingOnSyntax(this._binding)},U.prototype.whenNoAncestorNamed=function(B){return this._binding.constraint=function(Z){return!D.traverseAncerstors(Z,D.namedConstraint(B))},new I.BindingOnSyntax(this._binding)},U.prototype.whenAnyAncestorTagged=function(B,Z){return this._binding.constraint=function(X){return D.traverseAncerstors(X,D.taggedConstraint(B)(Z))},new I.BindingOnSyntax(this._binding)},U.prototype.whenNoAncestorTagged=function(B,Z){return this._binding.constraint=function(X){return!D.traverseAncerstors(X,D.taggedConstraint(B)(Z))},new I.BindingOnSyntax(this._binding)},U.prototype.whenAnyAncestorMatches=function(B){return this._binding.constraint=function(Z){return D.traverseAncerstors(Z,B)},new I.BindingOnSyntax(this._binding)},U.prototype.whenNoAncestorMatches=function(B){return this._binding.constraint=function(Z){return!D.traverseAncerstors(Z,B)},new I.BindingOnSyntax(this._binding)},U}();j.BindingWhenSyntax=G},83140:function(ae,j,C){"use strict";Object.defineProperty(j,"__esModule",{value:!0}),j.typeConstraint=j.namedConstraint=j.taggedConstraint=j.traverseAncerstors=void 0;var I=C(50295),D=C(25092),G=function(X,q){var ie=X.parentRequest;return ie!==null?q(ie)?!0:G(ie,q):!1};j.traverseAncerstors=G;var U=function(X){return function(q){var ie=function(he){return he!==null&&he.target!==null&&he.target.matchesTag(X)(q)};return ie.metaData=new D.Metadata(X,q),ie}};j.taggedConstraint=U;var B=U(I.NAMED_TAG);j.namedConstraint=B;var Z=function(X){return function(q){var ie=null;if(q!==null)if(ie=q.bindings[0],typeof X=="string"){var he=ie.serviceIdentifier;return he===X}else{var Ce=q.bindings[0].implementationType;return X===Ce}return!1}};j.typeConstraint=Z},34384:function(ae,j){"use strict";Object.defineProperty(j,"__esModule",{value:!0}),j.multiBindToService=void 0;var C=function(I){return function(D){return function(){for(var G=[],U=0;U<arguments.length;U++)G[U]=arguments[U];return G.forEach(function(B){return I.bind(B).toService(D)})}}};j.multiBindToService=C},92542:function(ae,j,C){"use strict";Object.defineProperty(j,"__esModule",{value:!0}),j.isStackOverflowExeption=void 0;var I=C(36078);function D(G){return G instanceof RangeError||G.message===I.STACK_OVERFLOW}j.isStackOverflowExeption=D},70023:function(ae,j){"use strict";Object.defineProperty(j,"__esModule",{value:!0}),j.id=void 0;var C=0;function I(){return C++}j.id=I},29552:function(ae,j,C){"use strict";Object.defineProperty(j,"__esModule",{value:!0}),j.circularDependencyToException=j.listMetadataForTarget=j.listRegisteredBindingsForServiceIdentifier=j.getServiceIdentifierAsString=j.getFunctionName=void 0;var I=C(36078);function D(ie){if(typeof ie=="function"){var he=ie;return he.name}else{if(typeof ie=="symbol")return ie.toString();var he=ie;return he}}j.getServiceIdentifierAsString=D;function G(ie,he,Ce){var be="",Ze=Ce(ie,he);return Ze.length!==0&&(be=`
Registered bindings:`,Ze.forEach(function(qe){var De="Object";qe.implementationType!==null&&(De=q(qe.implementationType)),be=be+`
 `+De,qe.constraint.metaData&&(be=be+" - "+qe.constraint.metaData)})),be}j.listRegisteredBindingsForServiceIdentifier=G;function U(ie,he){return ie.parentRequest===null?!1:ie.parentRequest.serviceIdentifier===he?!0:U(ie.parentRequest,he)}function B(ie){function he(be,Ze){Ze===void 0&&(Ze=[]);var qe=D(be.serviceIdentifier);return Ze.push(qe),be.parentRequest!==null?he(be.parentRequest,Ze):Ze}var Ce=he(ie);return Ce.reverse().join(" --> ")}function Z(ie){ie.childRequests.forEach(function(he){if(U(he,he.serviceIdentifier)){var Ce=B(he);throw new Error(I.CIRCULAR_DEPENDENCY+" "+Ce)}else Z(he)})}j.circularDependencyToException=Z;function X(ie,he){if(he.isTagged()||he.isNamed()){var Ce="",be=he.getNamedTag(),Ze=he.getCustomTags();return be!==null&&(Ce+=be.toString()+`
`),Ze!==null&&Ze.forEach(function(qe){Ce+=qe.toString()+`
`})," "+ie+`
 `+ie+" - "+Ce}else return" "+ie}j.listMetadataForTarget=X;function q(ie){if(ie.name)return ie.name;var he=ie.toString(),Ce=he.match(/^function\s*([^\s(]+)/);return Ce?Ce[1]:"Anonymous function: "+he}j.getFunctionName=q},76051:function(ae,j,C){"use strict";var I=C(45119)(),D=C(97683),G=D("Object.prototype.toString"),U=function(q){return I&&q&&typeof q=="object"&&Symbol.toStringTag in q?!1:G(q)==="[object Arguments]"},B=function(q){return U(q)?!0:q!==null&&typeof q=="object"&&typeof q.length=="number"&&q.length>=0&&G(q)!=="[object Array]"&&G(q.callee)==="[object Function]"},Z=function(){return U(arguments)}();U.isLegacyArguments=B,ae.exports=Z?U:B},5012:function(ae,j,C){"use strict";var I=Date.prototype.getDay,D=function(X){try{return I.call(X),!0}catch(q){return!1}},G=Object.prototype.toString,U="[object Date]",B=C(45119)();ae.exports=function(X){return typeof X!="object"||X===null?!1:B?D(X):G.call(X)===U}},11644:function(ae,j,C){"use strict";var I=C(97683),D=C(45119)(),G,U,B,Z;if(D){G=I("Object.prototype.hasOwnProperty"),U=I("RegExp.prototype.exec"),B={};var X=function(){throw B};Z={toString:X,valueOf:X},typeof Symbol.toPrimitive=="symbol"&&(Z[Symbol.toPrimitive]=X)}var q=I("Object.prototype.toString"),ie=Object.getOwnPropertyDescriptor,he="[object RegExp]";ae.exports=D?function(be){if(!be||typeof be!="object")return!1;var Ze=ie(be,"lastIndex"),qe=Ze&&G(Ze,"value");if(!qe)return!1;try{U(be,Z)}catch(De){return De===B}}:function(be){return!be||typeof be!="object"&&typeof be!="function"?!1:q(be)===he}},15584:function(ae,j,C){var I=C(73893),D=C(33152),G=I(D,"DataView");ae.exports=G},76414:function(ae,j,C){var I=C(64696),D=C(16824),G=C(23476),U=C(63122),B=C(37279);function Z(X){var q=-1,ie=X==null?0:X.length;for(this.clear();++q<ie;){var he=X[q];this.set(he[0],he[1])}}Z.prototype.clear=I,Z.prototype.delete=D,Z.prototype.get=G,Z.prototype.has=U,Z.prototype.set=B,ae.exports=Z},99746:function(ae,j,C){var I=C(34251),D=C(24968),G=C(28290),U=C(88068),B=C(54238);function Z(X){var q=-1,ie=X==null?0:X.length;for(this.clear();++q<ie;){var he=X[q];this.set(he[0],he[1])}}Z.prototype.clear=I,Z.prototype.delete=D,Z.prototype.get=G,Z.prototype.has=U,Z.prototype.set=B,ae.exports=Z},40164:function(ae,j,C){var I=C(73893),D=C(33152),G=I(D,"Map");ae.exports=G},52166:function(ae,j,C){var I=C(35365),D=C(63765),G=C(12608),U=C(10203),B=C(11298);function Z(X){var q=-1,ie=X==null?0:X.length;for(this.clear();++q<ie;){var he=X[q];this.set(he[0],he[1])}}Z.prototype.clear=I,Z.prototype.delete=D,Z.prototype.get=G,Z.prototype.has=U,Z.prototype.set=B,ae.exports=Z},97288:function(ae,j,C){var I=C(73893),D=C(33152),G=I(D,"Promise");ae.exports=G},23599:function(ae,j,C){var I=C(73893),D=C(33152),G=I(D,"Set");ae.exports=G},98924:function(ae,j,C){var I=C(52166),D=C(34776),G=C(40393);function U(B){var Z=-1,X=B==null?0:B.length;for(this.__data__=new I;++Z<X;)this.add(B[Z])}U.prototype.add=U.prototype.push=D,U.prototype.has=G,ae.exports=U},91866:function(ae,j,C){var I=C(99746),D=C(31119),G=C(64399),U=C(81897),B=C(90558),Z=C(64841);function X(q){var ie=this.__data__=new I(q);this.size=ie.size}X.prototype.clear=D,X.prototype.delete=G,X.prototype.get=U,X.prototype.has=B,X.prototype.set=Z,ae.exports=X},91869:function(ae,j,C){var I=C(33152),D=I.Symbol;ae.exports=D},77945:function(ae,j,C){var I=C(33152),D=I.Uint8Array;ae.exports=D},26873:function(ae,j,C){var I=C(73893),D=C(33152),G=I(D,"WeakMap");ae.exports=G},79628:function(ae){function j(C,I,D){switch(D.length){case 0:return C.call(I);case 1:return C.call(I,D[0]);case 2:return C.call(I,D[0],D[1]);case 3:return C.call(I,D[0],D[1],D[2])}return C.apply(I,D)}ae.exports=j},60661:function(ae){function j(C,I){for(var D=-1,G=C==null?0:C.length;++D<G&&I(C[D],D,C)!==!1;);return C}ae.exports=j},86952:function(ae){function j(C,I){for(var D=-1,G=C==null?0:C.length,U=0,B=[];++D<G;){var Z=C[D];I(Z,D,C)&&(B[U++]=Z)}return B}ae.exports=j},84271:function(ae,j,C){var I=C(17424);function D(G,U){var B=G==null?0:G.length;return!!B&&I(G,U,0)>-1}ae.exports=D},94874:function(ae){function j(C,I,D){for(var G=-1,U=C==null?0:C.length;++G<U;)if(D(I,C[G]))return!0;return!1}ae.exports=j},63333:function(ae,j,C){var I=C(67943),D=C(13053),G=C(80744),U=C(57835),B=C(70213),Z=C(18397),X=Object.prototype,q=X.hasOwnProperty;function ie(he,Ce){var be=G(he),Ze=!be&&D(he),qe=!be&&!Ze&&U(he),De=!be&&!Ze&&!qe&&Z(he),Ge=be||Ze||qe||De,Re=Ge?I(he.length,String):[],Me=Re.length;for(var ce in he)(Ce||q.call(he,ce))&&!(Ge&&(ce=="length"||qe&&(ce=="offset"||ce=="parent")||De&&(ce=="buffer"||ce=="byteLength"||ce=="byteOffset")||B(ce,Me)))&&Re.push(ce);return Re}ae.exports=ie},75010:function(ae){function j(C,I){for(var D=-1,G=C==null?0:C.length,U=Array(G);++D<G;)U[D]=I(C[D],D,C);return U}ae.exports=j},57095:function(ae){function j(C,I){for(var D=-1,G=I.length,U=C.length;++D<G;)C[U+D]=I[D];return C}ae.exports=j},99861:function(ae){function j(C,I,D,G){var U=-1,B=C==null?0:C.length;for(G&&B&&(D=C[++U]);++U<B;)D=I(D,C[U],U,C);return D}ae.exports=j},64045:function(ae){function j(C,I){for(var D=-1,G=C==null?0:C.length;++D<G;)if(I(C[D],D,C))return!0;return!1}ae.exports=j},72828:function(ae){function j(C){return C.split("")}ae.exports=j},34130:function(ae){var j=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g;function C(I){return I.match(j)||[]}ae.exports=C},89135:function(ae,j,C){var I=C(42813),D=C(43607);function G(U,B,Z){(Z!==void 0&&!D(U[B],Z)||Z===void 0&&!(B in U))&&I(U,B,Z)}ae.exports=G},60348:function(ae,j,C){var I=C(42813),D=C(43607),G=Object.prototype,U=G.hasOwnProperty;function B(Z,X,q){var ie=Z[X];(!(U.call(Z,X)&&D(ie,q))||q===void 0&&!(X in Z))&&I(Z,X,q)}ae.exports=B},67971:function(ae,j,C){var I=C(43607);function D(G,U){for(var B=G.length;B--;)if(I(G[B][0],U))return B;return-1}ae.exports=D},91937:function(ae,j,C){var I=C(95378),D=C(55451);function G(U,B){return U&&I(B,D(B),U)}ae.exports=G},26680:function(ae,j,C){var I=C(95378),D=C(56730);function G(U,B){return U&&I(B,D(B),U)}ae.exports=G},42813:function(ae,j,C){var I=C(35234);function D(G,U,B){U=="__proto__"&&I?I(G,U,{configurable:!0,enumerable:!0,value:B,writable:!0}):G[U]=B}ae.exports=D},14318:function(ae){function j(C,I,D){return C===C&&(D!==void 0&&(C=C<=D?C:D),I!==void 0&&(C=C>=I?C:I)),C}ae.exports=j},99045:function(ae,j,C){var I=C(91866),D=C(60661),G=C(60348),U=C(91937),B=C(26680),Z=C(32315),X=C(47760),q=C(15168),ie=C(71678),he=C(12076),Ce=C(22675),be=C(66139),Ze=C(79264),qe=C(97541),De=C(4084),Ge=C(80744),Re=C(57835),Me=C(41626),ce=C(20816),Be=C(65226),Ee=C(55451),Se=C(56730),oe=1,Y=2,Ne=4,ge="[object Arguments]",xe="[object Array]",ye="[object Boolean]",Q="[object Date]",Pe="[object Error]",Ae="[object Function]",_e="[object GeneratorFunction]",ue="[object Map]",ke="[object Number]",ze="[object Object]",le="[object RegExp]",Ut="[object Set]",kt="[object String]",pr="[object Symbol]",Wt="[object WeakMap]",Xr="[object ArrayBuffer]",fn="[object DataView]",Ir="[object Float32Array]",Qr="[object Float64Array]",tn="[object Int8Array]",Mr="[object Int16Array]",$n="[object Int32Array]",li="[object Uint8Array]",Kn="[object Uint8ClampedArray]",$r="[object Uint16Array]",ln="[object Uint32Array]",Cn={};Cn[ge]=Cn[xe]=Cn[Xr]=Cn[fn]=Cn[ye]=Cn[Q]=Cn[Ir]=Cn[Qr]=Cn[tn]=Cn[Mr]=Cn[$n]=Cn[ue]=Cn[ke]=Cn[ze]=Cn[le]=Cn[Ut]=Cn[kt]=Cn[pr]=Cn[li]=Cn[Kn]=Cn[$r]=Cn[ln]=!0,Cn[Pe]=Cn[Ae]=Cn[Wt]=!1;function $i(ci,Ft,te,We,Qe,vt){var Lt,Pt=Ft&oe,Cr=Ft&Y,yt=Ft&Ne;if(te&&(Lt=Qe?te(ci,We,Qe,vt):te(ci)),Lt!==void 0)return Lt;if(!ce(ci))return ci;var Ot=Ge(ci);if(Ot){if(Lt=Ze(ci),!Pt)return X(ci,Lt)}else{var rr=be(ci),Sr=rr==Ae||rr==_e;if(Re(ci))return Z(ci,Pt);if(rr==ze||rr==ge||Sr&&!Qe){if(Lt=Cr||Sr?{}:De(ci),!Pt)return Cr?ie(ci,B(Lt,ci)):q(ci,U(Lt,ci))}else{if(!Cn[rr])return Qe?ci:{};Lt=qe(ci,rr,Pt)}}vt||(vt=new I);var Lr=vt.get(ci);if(Lr)return Lr;vt.set(ci,Lt),Be(ci)?ci.forEach(function(zr){Lt.add($i(zr,Ft,te,zr,ci,vt))}):Me(ci)&&ci.forEach(function(zr,rn){Lt.set(rn,$i(zr,Ft,te,rn,ci,vt))});var on=yt?Cr?Ce:he:Cr?Se:Ee,hn=Ot?void 0:on(ci);return D(hn||ci,function(zr,rn){hn&&(rn=zr,zr=ci[rn]),G(Lt,rn,$i(zr,Ft,te,rn,ci,vt))}),Lt}ae.exports=$i},35024:function(ae,j,C){var I=C(20816),D=Object.create,G=function(){function U(){}return function(B){if(!I(B))return{};if(D)return D(B);U.prototype=B;var Z=new U;return U.prototype=void 0,Z}}();ae.exports=G},51533:function(ae){function j(C,I,D,G){for(var U=C.length,B=D+(G?1:-1);G?B--:++B<U;)if(I(C[B],B,C))return B;return-1}ae.exports=j},14018:function(ae,j,C){var I=C(78010),D=I();ae.exports=D},89147:function(ae,j,C){var I=C(1186),D=C(9171);function G(U,B){B=I(B,U);for(var Z=0,X=B.length;U!=null&&Z<X;)U=U[D(B[Z++])];return Z&&Z==X?U:void 0}ae.exports=G},75635:function(ae,j,C){var I=C(57095),D=C(80744);function G(U,B,Z){var X=B(U);return D(U)?X:I(X,Z(U))}ae.exports=G},86756:function(ae,j,C){var I=C(91869),D=C(72533),G=C(74702),U="[object Null]",B="[object Undefined]",Z=I?I.toStringTag:void 0;function X(q){return q==null?q===void 0?B:U:Z&&Z in Object(q)?D(q):G(q)}ae.exports=X},17424:function(ae,j,C){var I=C(51533),D=C(8373),G=C(49237);function U(B,Z,X){return Z===Z?G(B,Z,X):I(B,D,X)}ae.exports=U},71803:function(ae){function j(C,I,D,G){for(var U=D-1,B=C.length;++U<B;)if(G(C[U],I))return U;return-1}ae.exports=j},4977:function(ae,j,C){var I=C(86756),D=C(93913),G="[object Arguments]";function U(B){return D(B)&&I(B)==G}ae.exports=U},77295:function(ae,j,C){var I=C(84412),D=C(93913);function G(U,B,Z,X,q){return U===B?!0:U==null||B==null||!D(U)&&!D(B)?U!==U&&B!==B:I(U,B,Z,X,G,q)}ae.exports=G},84412:function(ae,j,C){var I=C(91866),D=C(50401),G=C(57710),U=C(4983),B=C(66139),Z=C(80744),X=C(57835),q=C(18397),ie=1,he="[object Arguments]",Ce="[object Array]",be="[object Object]",Ze=Object.prototype,qe=Ze.hasOwnProperty;function De(Ge,Re,Me,ce,Be,Ee){var Se=Z(Ge),oe=Z(Re),Y=Se?Ce:B(Ge),Ne=oe?Ce:B(Re);Y=Y==he?be:Y,Ne=Ne==he?be:Ne;var ge=Y==be,xe=Ne==be,ye=Y==Ne;if(ye&&X(Ge)){if(!X(Re))return!1;Se=!0,ge=!1}if(ye&&!ge)return Ee||(Ee=new I),Se||q(Ge)?D(Ge,Re,Me,ce,Be,Ee):G(Ge,Re,Y,Me,ce,Be,Ee);if(!(Me&ie)){var Q=ge&&qe.call(Ge,"__wrapped__"),Pe=xe&&qe.call(Re,"__wrapped__");if(Q||Pe){var Ae=Q?Ge.value():Ge,_e=Pe?Re.value():Re;return Ee||(Ee=new I),Be(Ae,_e,Me,ce,Ee)}}return ye?(Ee||(Ee=new I),U(Ge,Re,Me,ce,Be,Ee)):!1}ae.exports=De},55005:function(ae,j,C){var I=C(66139),D=C(93913),G="[object Map]";function U(B){return D(B)&&I(B)==G}ae.exports=U},8373:function(ae){function j(C){return C!==C}ae.exports=j},6367:function(ae,j,C){var I=C(9363),D=C(89379),G=C(20816),U=C(63256),B=/[\\^$.*+?()[\]{}|]/g,Z=/^\[object .+?Constructor\]$/,X=Function.prototype,q=Object.prototype,ie=X.toString,he=q.hasOwnProperty,Ce=RegExp("^"+ie.call(he).replace(B,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function be(Ze){if(!G(Ze)||D(Ze))return!1;var qe=I(Ze)?Ce:Z;return qe.test(U(Ze))}ae.exports=be},38652:function(ae,j,C){var I=C(66139),D=C(93913),G="[object Set]";function U(B){return D(B)&&I(B)==G}ae.exports=U},10766:function(ae,j,C){var I=C(86756),D=C(11156),G=C(93913),U="[object Arguments]",B="[object Array]",Z="[object Boolean]",X="[object Date]",q="[object Error]",ie="[object Function]",he="[object Map]",Ce="[object Number]",be="[object Object]",Ze="[object RegExp]",qe="[object Set]",De="[object String]",Ge="[object WeakMap]",Re="[object ArrayBuffer]",Me="[object DataView]",ce="[object Float32Array]",Be="[object Float64Array]",Ee="[object Int8Array]",Se="[object Int16Array]",oe="[object Int32Array]",Y="[object Uint8Array]",Ne="[object Uint8ClampedArray]",ge="[object Uint16Array]",xe="[object Uint32Array]",ye={};ye[ce]=ye[Be]=ye[Ee]=ye[Se]=ye[oe]=ye[Y]=ye[Ne]=ye[ge]=ye[xe]=!0,ye[U]=ye[B]=ye[Re]=ye[Z]=ye[Me]=ye[X]=ye[q]=ye[ie]=ye[he]=ye[Ce]=ye[be]=ye[Ze]=ye[qe]=ye[De]=ye[Ge]=!1;function Q(Pe){return G(Pe)&&D(Pe.length)&&!!ye[I(Pe)]}ae.exports=Q},6019:function(ae,j,C){var I=C(7975),D=C(23730),G=Object.prototype,U=G.hasOwnProperty;function B(Z){if(!I(Z))return D(Z);var X=[];for(var q in Object(Z))U.call(Z,q)&&q!="constructor"&&X.push(q);return X}ae.exports=B},33988:function(ae,j,C){var I=C(20816),D=C(7975),G=C(97817),U=Object.prototype,B=U.hasOwnProperty;function Z(X){if(!I(X))return G(X);var q=D(X),ie=[];for(var he in X)he=="constructor"&&(q||!B.call(X,he))||ie.push(he);return ie}ae.exports=Z},50097:function(ae,j,C){var I=C(91866),D=C(89135),G=C(14018),U=C(23585),B=C(20816),Z=C(56730),X=C(47052);function q(ie,he,Ce,be,Ze){ie!==he&&G(he,function(qe,De){if(Ze||(Ze=new I),B(qe))U(ie,he,De,Ce,q,be,Ze);else{var Ge=be?be(X(ie,De),qe,De+"",ie,he,Ze):void 0;Ge===void 0&&(Ge=qe),D(ie,De,Ge)}},Z)}ae.exports=q},23585:function(ae,j,C){var I=C(89135),D=C(32315),G=C(78358),U=C(47760),B=C(4084),Z=C(13053),X=C(80744),q=C(41590),ie=C(57835),he=C(9363),Ce=C(20816),be=C(19308),Ze=C(18397),qe=C(47052),De=C(20480);function Ge(Re,Me,ce,Be,Ee,Se,oe){var Y=qe(Re,ce),Ne=qe(Me,ce),ge=oe.get(Ne);if(ge){I(Re,ce,ge);return}var xe=Se?Se(Y,Ne,ce+"",Re,Me,oe):void 0,ye=xe===void 0;if(ye){var Q=X(Ne),Pe=!Q&&ie(Ne),Ae=!Q&&!Pe&&Ze(Ne);xe=Ne,Q||Pe||Ae?X(Y)?xe=Y:q(Y)?xe=U(Y):Pe?(ye=!1,xe=D(Ne,!0)):Ae?(ye=!1,xe=G(Ne,!0)):xe=[]:be(Ne)||Z(Ne)?(xe=Y,Z(Y)?xe=De(Y):(!Ce(Y)||he(Y))&&(xe=B(Ne))):ye=!1}ye&&(oe.set(Ne,xe),Ee(xe,Ne,Be,Se,oe),oe.delete(Ne)),I(Re,ce,xe)}ae.exports=Ge},61856:function(ae){function j(C){return function(I){return C==null?void 0:C[I]}}ae.exports=j},23442:function(ae,j,C){var I=C(75010),D=C(17424),G=C(71803),U=C(38342),B=C(47760),Z=Array.prototype,X=Z.splice;function q(ie,he,Ce,be){var Ze=be?G:D,qe=-1,De=he.length,Ge=ie;for(ie===he&&(he=B(he)),Ce&&(Ge=I(ie,U(Ce)));++qe<De;)for(var Re=0,Me=he[qe],ce=Ce?Ce(Me):Me;(Re=Ze(Ge,ce,Re,be))>-1;)Ge!==ie&&X.call(Ge,Re,1),X.call(ie,Re,1);return ie}ae.exports=q},92918:function(ae,j,C){var I=C(46962),D=C(19652),G=C(71152);function U(B,Z){return G(D(B,Z,I),B+"")}ae.exports=U},63989:function(ae,j,C){var I=C(13503),D=C(35234),G=C(46962),U=D?function(B,Z){return D(B,"toString",{configurable:!0,enumerable:!1,value:I(Z),writable:!0})}:G;ae.exports=U},75760:function(ae){function j(C,I,D){var G=-1,U=C.length;I<0&&(I=-I>U?0:U+I),D=D>U?U:D,D<0&&(D+=U),U=I>D?0:D-I>>>0,I>>>=0;for(var B=Array(U);++G<U;)B[G]=C[G+I];return B}ae.exports=j},67943:function(ae){function j(C,I){for(var D=-1,G=Array(C);++D<C;)G[D]=I(D);return G}ae.exports=j},50230:function(ae,j,C){var I=C(91869),D=C(75010),G=C(80744),U=C(45029),B=1/0,Z=I?I.prototype:void 0,X=Z?Z.toString:void 0;function q(ie){if(typeof ie=="string")return ie;if(G(ie))return D(ie,q)+"";if(U(ie))return X?X.call(ie):"";var he=ie+"";return he=="0"&&1/ie==-B?"-0":he}ae.exports=q},13927:function(ae,j,C){var I=C(15333),D=/^\s+/;function G(U){return U&&U.slice(0,I(U)+1).replace(D,"")}ae.exports=G},38342:function(ae){function j(C){return function(I){return C(I)}}ae.exports=j},29098:function(ae,j,C){var I=C(98924),D=C(84271),G=C(94874),U=C(1931),B=C(47506),Z=C(79679),X=200;function q(ie,he,Ce){var be=-1,Ze=D,qe=ie.length,De=!0,Ge=[],Re=Ge;if(Ce)De=!1,Ze=G;else if(qe>=X){var Me=he?null:B(ie);if(Me)return Z(Me);De=!1,Ze=U,Re=new I}else Re=he?[]:Ge;e:for(;++be<qe;){var ce=ie[be],Be=he?he(ce):ce;if(ce=Ce||ce!==0?ce:0,De&&Be===Be){for(var Ee=Re.length;Ee--;)if(Re[Ee]===Be)continue e;he&&Re.push(Be),Ge.push(ce)}else Ze(Re,Be,Ce)||(Re!==Ge&&Re.push(Be),Ge.push(ce))}return Ge}ae.exports=q},1931:function(ae){function j(C,I){return C.has(I)}ae.exports=j},1186:function(ae,j,C){var I=C(80744),D=C(86773),G=C(40493),U=C(44140);function B(Z,X){return I(Z)?Z:D(Z,X)?[Z]:G(U(Z))}ae.exports=B},4324:function(ae,j,C){var I=C(75760);function D(G,U,B){var Z=G.length;return B=B===void 0?Z:B,!U&&B>=Z?G:I(G,U,B)}ae.exports=D},20188:function(ae,j,C){var I=C(77945);function D(G){var U=new G.constructor(G.byteLength);return new I(U).set(new I(G)),U}ae.exports=D},32315:function(ae,j,C){ae=C.nmd(ae);var I=C(33152),D=j&&!j.nodeType&&j,G=D&&!0&&ae&&!ae.nodeType&&ae,U=G&&G.exports===D,B=U?I.Buffer:void 0,Z=B?B.allocUnsafe:void 0;function X(q,ie){if(ie)return q.slice();var he=q.length,Ce=Z?Z(he):new q.constructor(he);return q.copy(Ce),Ce}ae.exports=X},27984:function(ae,j,C){var I=C(20188);function D(G,U){var B=U?I(G.buffer):G.buffer;return new G.constructor(B,G.byteOffset,G.byteLength)}ae.exports=D},78583:function(ae){var j=/\w*$/;function C(I){var D=new I.constructor(I.source,j.exec(I));return D.lastIndex=I.lastIndex,D}ae.exports=C},28757:function(ae,j,C){var I=C(91869),D=I?I.prototype:void 0,G=D?D.valueOf:void 0;function U(B){return G?Object(G.call(B)):{}}ae.exports=U},78358:function(ae,j,C){var I=C(20188);function D(G,U){var B=U?I(G.buffer):G.buffer;return new G.constructor(B,G.byteOffset,G.length)}ae.exports=D},47760:function(ae){function j(C,I){var D=-1,G=C.length;for(I||(I=Array(G));++D<G;)I[D]=C[D];return I}ae.exports=j},95378:function(ae,j,C){var I=C(60348),D=C(42813);function G(U,B,Z,X){var q=!Z;Z||(Z={});for(var ie=-1,he=B.length;++ie<he;){var Ce=B[ie],be=X?X(Z[Ce],U[Ce],Ce,Z,U):void 0;be===void 0&&(be=U[Ce]),q?D(Z,Ce,be):I(Z,Ce,be)}return Z}ae.exports=G},15168:function(ae,j,C){var I=C(95378),D=C(58966);function G(U,B){return I(U,D(U),B)}ae.exports=G},71678:function(ae,j,C){var I=C(95378),D=C(66817);function G(U,B){return I(U,D(U),B)}ae.exports=G},64218:function(ae,j,C){var I=C(33152),D=I["__core-js_shared__"];ae.exports=D},63323:function(ae,j,C){var I=C(92918),D=C(8138);function G(U){return I(function(B,Z){var X=-1,q=Z.length,ie=q>1?Z[q-1]:void 0,he=q>2?Z[2]:void 0;for(ie=U.length>3&&typeof ie=="function"?(q--,ie):void 0,he&&D(Z[0],Z[1],he)&&(ie=q<3?void 0:ie,q=1),B=Object(B);++X<q;){var Ce=Z[X];Ce&&U(B,Ce,X,ie)}return B})}ae.exports=G},78010:function(ae){function j(C){return function(I,D,G){for(var U=-1,B=Object(I),Z=G(I),X=Z.length;X--;){var q=Z[C?X:++U];if(D(B[q],q,B)===!1)break}return I}}ae.exports=j},97815:function(ae,j,C){var I=C(4324),D=C(55015),G=C(80935),U=C(44140);function B(Z){return function(X){X=U(X);var q=D(X)?G(X):void 0,ie=q?q[0]:X.charAt(0),he=q?I(q,1).join(""):X.slice(1);return ie[Z]()+he}}ae.exports=B},74749:function(ae,j,C){var I=C(99861),D=C(31876),G=C(61503),U="['\u2019]",B=RegExp(U,"g");function Z(X){return function(q){return I(G(D(q).replace(B,"")),X,"")}}ae.exports=Z},47506:function(ae,j,C){var I=C(23599),D=C(9958),G=C(79679),U=1/0,B=I&&1/G(new I([,-0]))[1]==U?function(Z){return new I(Z)}:D;ae.exports=B},70668:function(ae,j,C){var I=C(61856),D={\u00C0:"A",\u00C1:"A",\u00C2:"A",\u00C3:"A",\u00C4:"A",\u00C5:"A",\u00E0:"a",\u00E1:"a",\u00E2:"a",\u00E3:"a",\u00E4:"a",\u00E5:"a",\u00C7:"C",\u00E7:"c",\u00D0:"D",\u00F0:"d",\u00C8:"E",\u00C9:"E",\u00CA:"E",\u00CB:"E",\u00E8:"e",\u00E9:"e",\u00EA:"e",\u00EB:"e",\u00CC:"I",\u00CD:"I",\u00CE:"I",\u00CF:"I",\u00EC:"i",\u00ED:"i",\u00EE:"i",\u00EF:"i",\u00D1:"N",\u00F1:"n",\u00D2:"O",\u00D3:"O",\u00D4:"O",\u00D5:"O",\u00D6:"O",\u00D8:"O",\u00F2:"o",\u00F3:"o",\u00F4:"o",\u00F5:"o",\u00F6:"o",\u00F8:"o",\u00D9:"U",\u00DA:"U",\u00DB:"U",\u00DC:"U",\u00F9:"u",\u00FA:"u",\u00FB:"u",\u00FC:"u",\u00DD:"Y",\u00FD:"y",\u00FF:"y",\u00C6:"Ae",\u00E6:"ae",\u00DE:"Th",\u00FE:"th",\u00DF:"ss",\u0100:"A",\u0102:"A",\u0104:"A",\u0101:"a",\u0103:"a",\u0105:"a",\u0106:"C",\u0108:"C",\u010A:"C",\u010C:"C",\u0107:"c",\u0109:"c",\u010B:"c",\u010D:"c",\u010E:"D",\u0110:"D",\u010F:"d",\u0111:"d",\u0112:"E",\u0114:"E",\u0116:"E",\u0118:"E",\u011A:"E",\u0113:"e",\u0115:"e",\u0117:"e",\u0119:"e",\u011B:"e",\u011C:"G",\u011E:"G",\u0120:"G",\u0122:"G",\u011D:"g",\u011F:"g",\u0121:"g",\u0123:"g",\u0124:"H",\u0126:"H",\u0125:"h",\u0127:"h",\u0128:"I",\u012A:"I",\u012C:"I",\u012E:"I",\u0130:"I",\u0129:"i",\u012B:"i",\u012D:"i",\u012F:"i",\u0131:"i",\u0134:"J",\u0135:"j",\u0136:"K",\u0137:"k",\u0138:"k",\u0139:"L",\u013B:"L",\u013D:"L",\u013F:"L",\u0141:"L",\u013A:"l",\u013C:"l",\u013E:"l",\u0140:"l",\u0142:"l",\u0143:"N",\u0145:"N",\u0147:"N",\u014A:"N",\u0144:"n",\u0146:"n",\u0148:"n",\u014B:"n",\u014C:"O",\u014E:"O",\u0150:"O",\u014D:"o",\u014F:"o",\u0151:"o",\u0154:"R",\u0156:"R",\u0158:"R",\u0155:"r",\u0157:"r",\u0159:"r",\u015A:"S",\u015C:"S",\u015E:"S",\u0160:"S",\u015B:"s",\u015D:"s",\u015F:"s",\u0161:"s",\u0162:"T",\u0164:"T",\u0166:"T",\u0163:"t",\u0165:"t",\u0167:"t",\u0168:"U",\u016A:"U",\u016C:"U",\u016E:"U",\u0170:"U",\u0172:"U",\u0169:"u",\u016B:"u",\u016D:"u",\u016F:"u",\u0171:"u",\u0173:"u",\u0174:"W",\u0175:"w",\u0176:"Y",\u0177:"y",\u0178:"Y",\u0179:"Z",\u017B:"Z",\u017D:"Z",\u017A:"z",\u017C:"z",\u017E:"z",\u0132:"IJ",\u0133:"ij",\u0152:"Oe",\u0153:"oe",\u0149:"'n",\u017F:"s"},G=I(D);ae.exports=G},35234:function(ae,j,C){var I=C(73893),D=function(){try{var G=I(Object,"defineProperty");return G({},"",{}),G}catch(U){}}();ae.exports=D},50401:function(ae,j,C){var I=C(98924),D=C(64045),G=C(1931),U=1,B=2;function Z(X,q,ie,he,Ce,be){var Ze=ie&U,qe=X.length,De=q.length;if(qe!=De&&!(Ze&&De>qe))return!1;var Ge=be.get(X),Re=be.get(q);if(Ge&&Re)return Ge==q&&Re==X;var Me=-1,ce=!0,Be=ie&B?new I:void 0;for(be.set(X,q),be.set(q,X);++Me<qe;){var Ee=X[Me],Se=q[Me];if(he)var oe=Ze?he(Se,Ee,Me,q,X,be):he(Ee,Se,Me,X,q,be);if(oe!==void 0){if(oe)continue;ce=!1;break}if(Be){if(!D(q,function(Y,Ne){if(!G(Be,Ne)&&(Ee===Y||Ce(Ee,Y,ie,he,be)))return Be.push(Ne)})){ce=!1;break}}else if(!(Ee===Se||Ce(Ee,Se,ie,he,be))){ce=!1;break}}return be.delete(X),be.delete(q),ce}ae.exports=Z},57710:function(ae,j,C){var I=C(91869),D=C(77945),G=C(43607),U=C(50401),B=C(83383),Z=C(79679),X=1,q=2,ie="[object Boolean]",he="[object Date]",Ce="[object Error]",be="[object Map]",Ze="[object Number]",qe="[object RegExp]",De="[object Set]",Ge="[object String]",Re="[object Symbol]",Me="[object ArrayBuffer]",ce="[object DataView]",Be=I?I.prototype:void 0,Ee=Be?Be.valueOf:void 0;function Se(oe,Y,Ne,ge,xe,ye,Q){switch(Ne){case ce:if(oe.byteLength!=Y.byteLength||oe.byteOffset!=Y.byteOffset)return!1;oe=oe.buffer,Y=Y.buffer;case Me:return!(oe.byteLength!=Y.byteLength||!ye(new D(oe),new D(Y)));case ie:case he:case Ze:return G(+oe,+Y);case Ce:return oe.name==Y.name&&oe.message==Y.message;case qe:case Ge:return oe==Y+"";case be:var Pe=B;case De:var Ae=ge&X;if(Pe||(Pe=Z),oe.size!=Y.size&&!Ae)return!1;var _e=Q.get(oe);if(_e)return _e==Y;ge|=q,Q.set(oe,Y);var ue=U(Pe(oe),Pe(Y),ge,xe,ye,Q);return Q.delete(oe),ue;case Re:if(Ee)return Ee.call(oe)==Ee.call(Y)}return!1}ae.exports=Se},4983:function(ae,j,C){var I=C(12076),D=1,G=Object.prototype,U=G.hasOwnProperty;function B(Z,X,q,ie,he,Ce){var be=q&D,Ze=I(Z),qe=Ze.length,De=I(X),Ge=De.length;if(qe!=Ge&&!be)return!1;for(var Re=qe;Re--;){var Me=Ze[Re];if(!(be?Me in X:U.call(X,Me)))return!1}var ce=Ce.get(Z),Be=Ce.get(X);if(ce&&Be)return ce==X&&Be==Z;var Ee=!0;Ce.set(Z,X),Ce.set(X,Z);for(var Se=be;++Re<qe;){Me=Ze[Re];var oe=Z[Me],Y=X[Me];if(ie)var Ne=be?ie(Y,oe,Me,X,Z,Ce):ie(oe,Y,Me,Z,X,Ce);if(!(Ne===void 0?oe===Y||he(oe,Y,q,ie,Ce):Ne)){Ee=!1;break}Se||(Se=Me=="constructor")}if(Ee&&!Se){var ge=Z.constructor,xe=X.constructor;ge!=xe&&"constructor"in Z&&"constructor"in X&&!(typeof ge=="function"&&ge instanceof ge&&typeof xe=="function"&&xe instanceof xe)&&(Ee=!1)}return Ce.delete(Z),Ce.delete(X),Ee}ae.exports=B},37675:function(ae,j,C){var I=typeof C.g=="object"&&C.g&&C.g.Object===Object&&C.g;ae.exports=I},12076:function(ae,j,C){var I=C(75635),D=C(58966),G=C(55451);function U(B){return I(B,G,D)}ae.exports=U},22675:function(ae,j,C){var I=C(75635),D=C(66817),G=C(56730);function U(B){return I(B,G,D)}ae.exports=U},89819:function(ae,j,C){var I=C(94358);function D(G,U){var B=G.__data__;return I(U)?B[typeof U=="string"?"string":"hash"]:B.map}ae.exports=D},73893:function(ae,j,C){var I=C(6367),D=C(49966);function G(U,B){var Z=D(U,B);return I(Z)?Z:void 0}ae.exports=G},49217:function(ae,j,C){var I=C(31030),D=I(Object.getPrototypeOf,Object);ae.exports=D},72533:function(ae,j,C){var I=C(91869),D=Object.prototype,G=D.hasOwnProperty,U=D.toString,B=I?I.toStringTag:void 0;function Z(X){var q=G.call(X,B),ie=X[B];try{X[B]=void 0;var he=!0}catch(be){}var Ce=U.call(X);return he&&(q?X[B]=ie:delete X[B]),Ce}ae.exports=Z},58966:function(ae,j,C){var I=C(86952),D=C(4134),G=Object.prototype,U=G.propertyIsEnumerable,B=Object.getOwnPropertySymbols,Z=B?function(X){return X==null?[]:(X=Object(X),I(B(X),function(q){return U.call(X,q)}))}:D;ae.exports=Z},66817:function(ae,j,C){var I=C(57095),D=C(49217),G=C(58966),U=C(4134),B=Object.getOwnPropertySymbols,Z=B?function(X){for(var q=[];X;)I(q,G(X)),X=D(X);return q}:U;ae.exports=Z},66139:function(ae,j,C){var I=C(15584),D=C(40164),G=C(97288),U=C(23599),B=C(26873),Z=C(86756),X=C(63256),q="[object Map]",ie="[object Object]",he="[object Promise]",Ce="[object Set]",be="[object WeakMap]",Ze="[object DataView]",qe=X(I),De=X(D),Ge=X(G),Re=X(U),Me=X(B),ce=Z;(I&&ce(new I(new ArrayBuffer(1)))!=Ze||D&&ce(new D)!=q||G&&ce(G.resolve())!=he||U&&ce(new U)!=Ce||B&&ce(new B)!=be)&&(ce=function(Be){var Ee=Z(Be),Se=Ee==ie?Be.constructor:void 0,oe=Se?X(Se):"";if(oe)switch(oe){case qe:return Ze;case De:return q;case Ge:return he;case Re:return Ce;case Me:return be}return Ee}),ae.exports=ce},49966:function(ae){function j(C,I){return C==null?void 0:C[I]}ae.exports=j},55015:function(ae){var j="\\ud800-\\udfff",C="\\u0300-\\u036f",I="\\ufe20-\\ufe2f",D="\\u20d0-\\u20ff",G=C+I+D,U="\\ufe0e\\ufe0f",B="\\u200d",Z=RegExp("["+B+j+G+U+"]");function X(q){return Z.test(q)}ae.exports=X},62840:function(ae){var j=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/;function C(I){return j.test(I)}ae.exports=C},64696:function(ae,j,C){var I=C(65294);function D(){this.__data__=I?I(null):{},this.size=0}ae.exports=D},16824:function(ae){function j(C){var I=this.has(C)&&delete this.__data__[C];return this.size-=I?1:0,I}ae.exports=j},23476:function(ae,j,C){var I=C(65294),D="__lodash_hash_undefined__",G=Object.prototype,U=G.hasOwnProperty;function B(Z){var X=this.__data__;if(I){var q=X[Z];return q===D?void 0:q}return U.call(X,Z)?X[Z]:void 0}ae.exports=B},63122:function(ae,j,C){var I=C(65294),D=Object.prototype,G=D.hasOwnProperty;function U(B){var Z=this.__data__;return I?Z[B]!==void 0:G.call(Z,B)}ae.exports=U},37279:function(ae,j,C){var I=C(65294),D="__lodash_hash_undefined__";function G(U,B){var Z=this.__data__;return this.size+=this.has(U)?0:1,Z[U]=I&&B===void 0?D:B,this}ae.exports=G},79264:function(ae){var j=Object.prototype,C=j.hasOwnProperty;function I(D){var G=D.length,U=new D.constructor(G);return G&&typeof D[0]=="string"&&C.call(D,"index")&&(U.index=D.index,U.input=D.input),U}ae.exports=I},97541:function(ae,j,C){var I=C(20188),D=C(27984),G=C(78583),U=C(28757),B=C(78358),Z="[object Boolean]",X="[object Date]",q="[object Map]",ie="[object Number]",he="[object RegExp]",Ce="[object Set]",be="[object String]",Ze="[object Symbol]",qe="[object ArrayBuffer]",De="[object DataView]",Ge="[object Float32Array]",Re="[object Float64Array]",Me="[object Int8Array]",ce="[object Int16Array]",Be="[object Int32Array]",Ee="[object Uint8Array]",Se="[object Uint8ClampedArray]",oe="[object Uint16Array]",Y="[object Uint32Array]";function Ne(ge,xe,ye){var Q=ge.constructor;switch(xe){case qe:return I(ge);case Z:case X:return new Q(+ge);case De:return D(ge,ye);case Ge:case Re:case Me:case ce:case Be:case Ee:case Se:case oe:case Y:return B(ge,ye);case q:return new Q;case ie:case be:return new Q(ge);case he:return G(ge);case Ce:return new Q;case Ze:return U(ge)}}ae.exports=Ne},4084:function(ae,j,C){var I=C(35024),D=C(49217),G=C(7975);function U(B){return typeof B.constructor=="function"&&!G(B)?I(D(B)):{}}ae.exports=U},70213:function(ae){var j=9007199254740991,C=/^(?:0|[1-9]\d*)$/;function I(D,G){var U=typeof D;return G=G==null?j:G,!!G&&(U=="number"||U!="symbol"&&C.test(D))&&D>-1&&D%1==0&&D<G}ae.exports=I},8138:function(ae,j,C){var I=C(43607),D=C(24665),G=C(70213),U=C(20816);function B(Z,X,q){if(!U(q))return!1;var ie=typeof X;return(ie=="number"?D(q)&&G(X,q.length):ie=="string"&&X in q)?I(q[X],Z):!1}ae.exports=B},86773:function(ae,j,C){var I=C(80744),D=C(45029),G=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,U=/^\w*$/;function B(Z,X){if(I(Z))return!1;var q=typeof Z;return q=="number"||q=="symbol"||q=="boolean"||Z==null||D(Z)?!0:U.test(Z)||!G.test(Z)||X!=null&&Z in Object(X)}ae.exports=B},94358:function(ae){function j(C){var I=typeof C;return I=="string"||I=="number"||I=="symbol"||I=="boolean"?C!=="__proto__":C===null}ae.exports=j},89379:function(ae,j,C){var I=C(64218),D=function(){var U=/[^.]+$/.exec(I&&I.keys&&I.keys.IE_PROTO||"");return U?"Symbol(src)_1."+U:""}();function G(U){return!!D&&D in U}ae.exports=G},7975:function(ae){var j=Object.prototype;function C(I){var D=I&&I.constructor,G=typeof D=="function"&&D.prototype||j;return I===G}ae.exports=C},34251:function(ae){function j(){this.__data__=[],this.size=0}ae.exports=j},24968:function(ae,j,C){var I=C(67971),D=Array.prototype,G=D.splice;function U(B){var Z=this.__data__,X=I(Z,B);if(X<0)return!1;var q=Z.length-1;return X==q?Z.pop():G.call(Z,X,1),--this.size,!0}ae.exports=U},28290:function(ae,j,C){var I=C(67971);function D(G){var U=this.__data__,B=I(U,G);return B<0?void 0:U[B][1]}ae.exports=D},88068:function(ae,j,C){var I=C(67971);function D(G){return I(this.__data__,G)>-1}ae.exports=D},54238:function(ae,j,C){var I=C(67971);function D(G,U){var B=this.__data__,Z=I(B,G);return Z<0?(++this.size,B.push([G,U])):B[Z][1]=U,this}ae.exports=D},35365:function(ae,j,C){var I=C(76414),D=C(99746),G=C(40164);function U(){this.size=0,this.__data__={hash:new I,map:new(G||D),string:new I}}ae.exports=U},63765:function(ae,j,C){var I=C(89819);function D(G){var U=I(this,G).delete(G);return this.size-=U?1:0,U}ae.exports=D},12608:function(ae,j,C){var I=C(89819);function D(G){return I(this,G).get(G)}ae.exports=D},10203:function(ae,j,C){var I=C(89819);function D(G){return I(this,G).has(G)}ae.exports=D},11298:function(ae,j,C){var I=C(89819);function D(G,U){var B=I(this,G),Z=B.size;return B.set(G,U),this.size+=B.size==Z?0:1,this}ae.exports=D},83383:function(ae){function j(C){var I=-1,D=Array(C.size);return C.forEach(function(G,U){D[++I]=[U,G]}),D}ae.exports=j},26332:function(ae,j,C){var I=C(52858),D=500;function G(U){var B=I(U,function(X){return Z.size===D&&Z.clear(),X}),Z=B.cache;return B}ae.exports=G},65294:function(ae,j,C){var I=C(73893),D=I(Object,"create");ae.exports=D},23730:function(ae,j,C){var I=C(31030),D=I(Object.keys,Object);ae.exports=D},97817:function(ae){function j(C){var I=[];if(C!=null)for(var D in Object(C))I.push(D);return I}ae.exports=j},52495:function(ae,j,C){ae=C.nmd(ae);var I=C(37675),D=j&&!j.nodeType&&j,G=D&&!0&&ae&&!ae.nodeType&&ae,U=G&&G.exports===D,B=U&&I.process,Z=function(){try{var X=G&&G.require&&G.require("util").types;return X||B&&B.binding&&B.binding("util")}catch(q){}}();ae.exports=Z},74702:function(ae){var j=Object.prototype,C=j.toString;function I(D){return C.call(D)}ae.exports=I},31030:function(ae){function j(C,I){return function(D){return C(I(D))}}ae.exports=j},19652:function(ae,j,C){var I=C(79628),D=Math.max;function G(U,B,Z){return B=D(B===void 0?U.length-1:B,0),function(){for(var X=arguments,q=-1,ie=D(X.length-B,0),he=Array(ie);++q<ie;)he[q]=X[B+q];q=-1;for(var Ce=Array(B+1);++q<B;)Ce[q]=X[q];return Ce[B]=Z(he),I(U,this,Ce)}}ae.exports=G},33152:function(ae,j,C){var I=C(37675),D=typeof self=="object"&&self&&self.Object===Object&&self,G=I||D||Function("return this")();ae.exports=G},47052:function(ae){function j(C,I){if(!(I==="constructor"&&typeof C[I]=="function")&&I!="__proto__")return C[I]}ae.exports=j},34776:function(ae){var j="__lodash_hash_undefined__";function C(I){return this.__data__.set(I,j),this}ae.exports=C},40393:function(ae){function j(C){return this.__data__.has(C)}ae.exports=j},79679:function(ae){function j(C){var I=-1,D=Array(C.size);return C.forEach(function(G){D[++I]=G}),D}ae.exports=j},71152:function(ae,j,C){var I=C(63989),D=C(78437),G=D(I);ae.exports=G},78437:function(ae){var j=800,C=16,I=Date.now;function D(G){var U=0,B=0;return function(){var Z=I(),X=C-(Z-B);if(B=Z,X>0){if(++U>=j)return arguments[0]}else U=0;return G.apply(void 0,arguments)}}ae.exports=D},31119:function(ae,j,C){var I=C(99746);function D(){this.__data__=new I,this.size=0}ae.exports=D},64399:function(ae){function j(C){var I=this.__data__,D=I.delete(C);return this.size=I.size,D}ae.exports=j},81897:function(ae){function j(C){return this.__data__.get(C)}ae.exports=j},90558:function(ae){function j(C){return this.__data__.has(C)}ae.exports=j},64841:function(ae,j,C){var I=C(99746),D=C(40164),G=C(52166),U=200;function B(Z,X){var q=this.__data__;if(q instanceof I){var ie=q.__data__;if(!D||ie.length<U-1)return ie.push([Z,X]),this.size=++q.size,this;q=this.__data__=new G(ie)}return q.set(Z,X),this.size=q.size,this}ae.exports=B},49237:function(ae){function j(C,I,D){for(var G=D-1,U=C.length;++G<U;)if(C[G]===I)return G;return-1}ae.exports=j},80935:function(ae,j,C){var I=C(72828),D=C(55015),G=C(17826);function U(B){return D(B)?G(B):I(B)}ae.exports=U},40493:function(ae,j,C){var I=C(26332),D=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,G=/\\(\\)?/g,U=I(function(B){var Z=[];return B.charCodeAt(0)===46&&Z.push(""),B.replace(D,function(X,q,ie,he){Z.push(ie?he.replace(G,"$1"):q||X)}),Z});ae.exports=U},9171:function(ae,j,C){var I=C(45029),D=1/0;function G(U){if(typeof U=="string"||I(U))return U;var B=U+"";return B=="0"&&1/U==-D?"-0":B}ae.exports=G},63256:function(ae){var j=Function.prototype,C=j.toString;function I(D){if(D!=null){try{return C.call(D)}catch(G){}try{return D+""}catch(G){}}return""}ae.exports=I},15333:function(ae){var j=/\s/;function C(I){for(var D=I.length;D--&&j.test(I.charAt(D)););return D}ae.exports=C},17826:function(ae){var j="\\ud800-\\udfff",C="\\u0300-\\u036f",I="\\ufe20-\\ufe2f",D="\\u20d0-\\u20ff",G=C+I+D,U="\\ufe0e\\ufe0f",B="["+j+"]",Z="["+G+"]",X="\\ud83c[\\udffb-\\udfff]",q="(?:"+Z+"|"+X+")",ie="[^"+j+"]",he="(?:\\ud83c[\\udde6-\\uddff]){2}",Ce="[\\ud800-\\udbff][\\udc00-\\udfff]",be="\\u200d",Ze=q+"?",qe="["+U+"]?",De="(?:"+be+"(?:"+[ie,he,Ce].join("|")+")"+qe+Ze+")*",Ge=qe+Ze+De,Re="(?:"+[ie+Z+"?",Z,he,Ce,B].join("|")+")",Me=RegExp(X+"(?="+X+")|"+Re+Ge,"g");function ce(Be){return Be.match(Me)||[]}ae.exports=ce},97681:function(ae){var j="\\ud800-\\udfff",C="\\u0300-\\u036f",I="\\ufe20-\\ufe2f",D="\\u20d0-\\u20ff",G=C+I+D,U="\\u2700-\\u27bf",B="a-z\\xdf-\\xf6\\xf8-\\xff",Z="\\xac\\xb1\\xd7\\xf7",X="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",q="\\u2000-\\u206f",ie=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",he="A-Z\\xc0-\\xd6\\xd8-\\xde",Ce="\\ufe0e\\ufe0f",be=Z+X+q+ie,Ze="['\u2019]",qe="["+be+"]",De="["+G+"]",Ge="\\d+",Re="["+U+"]",Me="["+B+"]",ce="[^"+j+be+Ge+U+B+he+"]",Be="\\ud83c[\\udffb-\\udfff]",Ee="(?:"+De+"|"+Be+")",Se="[^"+j+"]",oe="(?:\\ud83c[\\udde6-\\uddff]){2}",Y="[\\ud800-\\udbff][\\udc00-\\udfff]",Ne="["+he+"]",ge="\\u200d",xe="(?:"+Me+"|"+ce+")",ye="(?:"+Ne+"|"+ce+")",Q="(?:"+Ze+"(?:d|ll|m|re|s|t|ve))?",Pe="(?:"+Ze+"(?:D|LL|M|RE|S|T|VE))?",Ae=Ee+"?",_e="["+Ce+"]?",ue="(?:"+ge+"(?:"+[Se,oe,Y].join("|")+")"+_e+Ae+")*",ke="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",ze="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",le=_e+Ae+ue,Ut="(?:"+[Re,oe,Y].join("|")+")"+le,kt=RegExp([Ne+"?"+Me+"+"+Q+"(?="+[qe,Ne,"$"].join("|")+")",ye+"+"+Pe+"(?="+[qe,Ne+xe,"$"].join("|")+")",Ne+"?"+xe+"+"+Q,Ne+"+"+Pe,ze,ke,Ge,Ut].join("|"),"g");function pr(Wt){return Wt.match(kt)||[]}ae.exports=pr},34301:function(ae,j,C){var I=C(30225),D=C(74749),G=D(function(U,B,Z){return B=B.toLowerCase(),U+(Z?I(B):B)});ae.exports=G},30225:function(ae,j,C){var I=C(44140),D=C(53592);function G(U){return D(I(U).toLowerCase())}ae.exports=G},61400:function(ae,j,C){var I=C(14318),D=C(20168);function G(U,B,Z){return Z===void 0&&(Z=B,B=void 0),Z!==void 0&&(Z=D(Z),Z=Z===Z?Z:0),B!==void 0&&(B=D(B),B=B===B?B:0),I(D(U),B,Z)}ae.exports=G},20250:function(ae,j,C){var I=C(99045),D=1,G=4;function U(B){return I(B,D|G)}ae.exports=U},13503:function(ae){function j(C){return function(){return C}}ae.exports=j},41571:function(ae,j,C){var I=C(20816),D=C(5795),G=C(20168),U="Expected a function",B=Math.max,Z=Math.min;function X(q,ie,he){var Ce,be,Ze,qe,De,Ge,Re=0,Me=!1,ce=!1,Be=!0;if(typeof q!="function")throw new TypeError(U);ie=G(ie)||0,I(he)&&(Me=!!he.leading,ce="maxWait"in he,Ze=ce?B(G(he.maxWait)||0,ie):Ze,Be="trailing"in he?!!he.trailing:Be);function Ee(Pe){var Ae=Ce,_e=be;return Ce=be=void 0,Re=Pe,qe=q.apply(_e,Ae),qe}function Se(Pe){return Re=Pe,De=setTimeout(Ne,ie),Me?Ee(Pe):qe}function oe(Pe){var Ae=Pe-Ge,_e=Pe-Re,ue=ie-Ae;return ce?Z(ue,Ze-_e):ue}function Y(Pe){var Ae=Pe-Ge,_e=Pe-Re;return Ge===void 0||Ae>=ie||Ae<0||ce&&_e>=Ze}function Ne(){var Pe=D();if(Y(Pe))return ge(Pe);De=setTimeout(Ne,oe(Pe))}function ge(Pe){return De=void 0,Be&&Ce?Ee(Pe):(Ce=be=void 0,qe)}function xe(){De!==void 0&&clearTimeout(De),Re=0,Ce=Ge=be=De=void 0}function ye(){return De===void 0?qe:ge(D())}function Q(){var Pe=D(),Ae=Y(Pe);if(Ce=arguments,be=this,Ge=Pe,Ae){if(De===void 0)return Se(Ge);if(ce)return clearTimeout(De),De=setTimeout(Ne,ie),Ee(Ge)}return De===void 0&&(De=setTimeout(Ne,ie)),qe}return Q.cancel=xe,Q.flush=ye,Q}ae.exports=X},31876:function(ae,j,C){var I=C(70668),D=C(44140),G=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,U="\\u0300-\\u036f",B="\\ufe20-\\ufe2f",Z="\\u20d0-\\u20ff",X=U+B+Z,q="["+X+"]",ie=RegExp(q,"g");function he(Ce){return Ce=D(Ce),Ce&&Ce.replace(G,I).replace(ie,"")}ae.exports=he},43607:function(ae){function j(C,I){return C===I||C!==C&&I!==I}ae.exports=j},44231:function(ae,j,C){var I=C(89147);function D(G,U,B){var Z=G==null?void 0:I(G,U);return Z===void 0?B:Z}ae.exports=D},46962:function(ae){function j(C){return C}ae.exports=j},13053:function(ae,j,C){var I=C(4977),D=C(93913),G=Object.prototype,U=G.hasOwnProperty,B=G.propertyIsEnumerable,Z=I(function(){return arguments}())?I:function(X){return D(X)&&U.call(X,"callee")&&!B.call(X,"callee")};ae.exports=Z},80744:function(ae){var j=Array.isArray;ae.exports=j},24665:function(ae,j,C){var I=C(9363),D=C(11156);function G(U){return U!=null&&D(U.length)&&!I(U)}ae.exports=G},41590:function(ae,j,C){var I=C(24665),D=C(93913);function G(U){return D(U)&&I(U)}ae.exports=G},26561:function(ae,j,C){var I=C(86756),D=C(93913),G="[object Boolean]";function U(B){return B===!0||B===!1||D(B)&&I(B)==G}ae.exports=U},57835:function(ae,j,C){ae=C.nmd(ae);var I=C(33152),D=C(55950),G=j&&!j.nodeType&&j,U=G&&!0&&ae&&!ae.nodeType&&ae,B=U&&U.exports===G,Z=B?I.Buffer:void 0,X=Z?Z.isBuffer:void 0,q=X||D;ae.exports=q},98621:function(ae,j,C){var I=C(77295);function D(G,U){return I(G,U)}ae.exports=D},9363:function(ae,j,C){var I=C(86756),D=C(20816),G="[object AsyncFunction]",U="[object Function]",B="[object GeneratorFunction]",Z="[object Proxy]";function X(q){if(!D(q))return!1;var ie=I(q);return ie==U||ie==B||ie==G||ie==Z}ae.exports=X},11156:function(ae){var j=9007199254740991;function C(I){return typeof I=="number"&&I>-1&&I%1==0&&I<=j}ae.exports=C},41626:function(ae,j,C){var I=C(55005),D=C(38342),G=C(52495),U=G&&G.isMap,B=U?D(U):I;ae.exports=B},93544:function(ae){function j(C){return C==null}ae.exports=j},68868:function(ae,j,C){var I=C(86756),D=C(93913),G="[object Number]";function U(B){return typeof B=="number"||D(B)&&I(B)==G}ae.exports=U},20816:function(ae){function j(C){var I=typeof C;return C!=null&&(I=="object"||I=="function")}ae.exports=j},93913:function(ae){function j(C){return C!=null&&typeof C=="object"}ae.exports=j},19308:function(ae,j,C){var I=C(86756),D=C(49217),G=C(93913),U="[object Object]",B=Function.prototype,Z=Object.prototype,X=B.toString,q=Z.hasOwnProperty,ie=X.call(Object);function he(Ce){if(!G(Ce)||I(Ce)!=U)return!1;var be=D(Ce);if(be===null)return!0;var Ze=q.call(be,"constructor")&&be.constructor;return typeof Ze=="function"&&Ze instanceof Ze&&X.call(Ze)==ie}ae.exports=he},65226:function(ae,j,C){var I=C(38652),D=C(38342),G=C(52495),U=G&&G.isSet,B=U?D(U):I;ae.exports=B},7941:function(ae,j,C){var I=C(86756),D=C(80744),G=C(93913),U="[object String]";function B(Z){return typeof Z=="string"||!D(Z)&&G(Z)&&I(Z)==U}ae.exports=B},45029:function(ae,j,C){var I=C(86756),D=C(93913),G="[object Symbol]";function U(B){return typeof B=="symbol"||D(B)&&I(B)==G}ae.exports=U},18397:function(ae,j,C){var I=C(10766),D=C(38342),G=C(52495),U=G&&G.isTypedArray,B=U?D(U):I;ae.exports=B},16513:function(ae){function j(C){return C===void 0}ae.exports=j},55451:function(ae,j,C){var I=C(63333),D=C(6019),G=C(24665);function U(B){return G(B)?I(B):D(B)}ae.exports=U},56730:function(ae,j,C){var I=C(63333),D=C(33988),G=C(24665);function U(B){return G(B)?I(B,!0):D(B)}ae.exports=U},52858:function(ae,j,C){var I=C(52166),D="Expected a function";function G(U,B){if(typeof U!="function"||B!=null&&typeof B!="function")throw new TypeError(D);var Z=function(){var X=arguments,q=B?B.apply(this,X):X[0],ie=Z.cache;if(ie.has(q))return ie.get(q);var he=U.apply(this,X);return Z.cache=ie.set(q,he)||ie,he};return Z.cache=new(G.Cache||I),Z}G.Cache=I,ae.exports=G},28440:function(ae,j,C){var I=C(50097),D=C(63323),G=D(function(U,B,Z){I(U,B,Z)});ae.exports=G},24602:function(ae,j,C){var I=C(50097),D=C(63323),G=D(function(U,B,Z,X){I(U,B,Z,X)});ae.exports=G},9958:function(ae){function j(){}ae.exports=j},5795:function(ae,j,C){var I=C(33152),D=function(){return I.Date.now()};ae.exports=D},63536:function(ae,j,C){var I=C(92918),D=C(14989),G=I(D);ae.exports=G},14989:function(ae,j,C){var I=C(23442);function D(G,U){return G&&G.length&&U&&U.length?I(G,U):G}ae.exports=D},4134:function(ae){function j(){return[]}ae.exports=j},55950:function(ae){function j(){return!1}ae.exports=j},46700:function(ae,j,C){var I=C(41571),D=C(20816),G="Expected a function";function U(B,Z,X){var q=!0,ie=!0;if(typeof B!="function")throw new TypeError(G);return D(X)&&(q="leading"in X?!!X.leading:q,ie="trailing"in X?!!X.trailing:ie),I(B,Z,{leading:q,maxWait:Z,trailing:ie})}ae.exports=U},20168:function(ae,j,C){var I=C(13927),D=C(20816),G=C(45029),U=0/0,B=/^[-+]0x[0-9a-f]+$/i,Z=/^0b[01]+$/i,X=/^0o[0-7]+$/i,q=parseInt;function ie(he){if(typeof he=="number")return he;if(G(he))return U;if(D(he)){var Ce=typeof he.valueOf=="function"?he.valueOf():he;he=D(Ce)?Ce+"":Ce}if(typeof he!="string")return he===0?he:+he;he=I(he);var be=Z.test(he);return be||X.test(he)?q(he.slice(2),be?2:8):B.test(he)?U:+he}ae.exports=ie},20480:function(ae,j,C){var I=C(95378),D=C(56730);function G(U){return I(U,D(U))}ae.exports=G},44140:function(ae,j,C){var I=C(50230);function D(G){return G==null?"":I(G)}ae.exports=D},21691:function(ae,j,C){var I=C(29098);function D(G){return G&&G.length?I(G):[]}ae.exports=D},53592:function(ae,j,C){var I=C(97815),D=I("toUpperCase");ae.exports=D},61503:function(ae,j,C){var I=C(34130),D=C(62840),G=C(44140),U=C(97681);function B(Z,X,q){return Z=G(Z),X=q?void 0:X,X===void 0?D(Z)?U(Z):I(Z):Z.match(X)||[]}ae.exports=B},84126:function(ae){"use strict";var j=Object.getOwnPropertySymbols,C=Object.prototype.hasOwnProperty,I=Object.prototype.propertyIsEnumerable;function D(U){if(U==null)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(U)}function G(){try{if(!Object.assign)return!1;var U=new String("abc");if(U[5]="de",Object.getOwnPropertyNames(U)[0]==="5")return!1;for(var B={},Z=0;Z<10;Z++)B["_"+String.fromCharCode(Z)]=Z;var X=Object.getOwnPropertyNames(B).map(function(ie){return B[ie]});if(X.join("")!=="0123456789")return!1;var q={};return"abcdefghijklmnopqrst".split("").forEach(function(ie){q[ie]=ie}),Object.keys(Object.assign({},q)).join("")==="abcdefghijklmnopqrst"}catch(ie){return!1}}ae.exports=G()?Object.assign:function(U,B){for(var Z,X=D(U),q,ie=1;ie<arguments.length;ie++){Z=Object(arguments[ie]);for(var he in Z)C.call(Z,he)&&(X[he]=Z[he]);if(j){q=j(Z);for(var Ce=0;Ce<q.length;Ce++)I.call(Z,q[Ce])&&(X[q[Ce]]=Z[q[Ce]])}}return X}},73868:function(ae){"use strict";var j=function(C){return C!==C};ae.exports=function(I,D){return I===0&&D===0?1/I===1/D:!!(I===D||j(I)&&j(D))}},6392:function(ae,j,C){"use strict";var I=C(8263),D=C(71262),G=C(73868),U=C(33757),B=C(68998),Z=D(U(),Object);I(Z,{getPolyfill:U,implementation:G,shim:B}),ae.exports=Z},33757:function(ae,j,C){"use strict";var I=C(73868);ae.exports=function(){return typeof Object.is=="function"?Object.is:I}},68998:function(ae,j,C){"use strict";var I=C(33757),D=C(8263);ae.exports=function(){var U=I();return D(Object,{is:U},{is:function(){return Object.is!==U}}),U}},2822:function(ae,j,C){"use strict";var I;if(!Object.keys){var D=Object.prototype.hasOwnProperty,G=Object.prototype.toString,U=C(11635),B=Object.prototype.propertyIsEnumerable,Z=!B.call({toString:null},"toString"),X=B.call(function(){},"prototype"),q=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],ie=function(Ze){var qe=Ze.constructor;return qe&&qe.prototype===Ze},he={$applicationCache:!0,$console:!0,$external:!0,$frame:!0,$frameElement:!0,$frames:!0,$innerHeight:!0,$innerWidth:!0,$onmozfullscreenchange:!0,$onmozfullscreenerror:!0,$outerHeight:!0,$outerWidth:!0,$pageXOffset:!0,$pageYOffset:!0,$parent:!0,$scrollLeft:!0,$scrollTop:!0,$scrollX:!0,$scrollY:!0,$self:!0,$webkitIndexedDB:!0,$webkitStorageInfo:!0,$window:!0},Ce=function(){if(typeof window=="undefined")return!1;for(var Ze in window)try{if(!he["$"+Ze]&&D.call(window,Ze)&&window[Ze]!==null&&typeof window[Ze]=="object")try{ie(window[Ze])}catch(qe){return!0}}catch(qe){return!0}return!1}(),be=function(Ze){if(typeof window=="undefined"||!Ce)return ie(Ze);try{return ie(Ze)}catch(qe){return!1}};I=function(qe){var De=qe!==null&&typeof qe=="object",Ge=G.call(qe)==="[object Function]",Re=U(qe),Me=De&&G.call(qe)==="[object String]",ce=[];if(!De&&!Ge&&!Re)throw new TypeError("Object.keys called on a non-object");var Be=X&&Ge;if(Me&&qe.length>0&&!D.call(qe,0))for(var Ee=0;Ee<qe.length;++Ee)ce.push(String(Ee));if(Re&&qe.length>0)for(var Se=0;Se<qe.length;++Se)ce.push(String(Se));else for(var oe in qe)!(Be&&oe==="prototype")&&D.call(qe,oe)&&ce.push(String(oe));if(Z)for(var Y=be(qe),Ne=0;Ne<q.length;++Ne)!(Y&&q[Ne]==="constructor")&&D.call(qe,q[Ne])&&ce.push(q[Ne]);return ce}}ae.exports=I},64253:function(ae,j,C){"use strict";var I=Array.prototype.slice,D=C(11635),G=Object.keys,U=G?function(X){return G(X)}:C(2822),B=Object.keys;U.shim=function(){if(Object.keys){var X=function(){var q=Object.keys(arguments);return q&&q.length===arguments.length}(1,2);X||(Object.keys=function(ie){return D(ie)?B(I.call(ie)):B(ie)})}else Object.keys=U;return Object.keys||U},ae.exports=U},11635:function(ae){"use strict";var j=Object.prototype.toString;ae.exports=function(I){var D=j.call(I),G=D==="[object Arguments]";return G||(G=D!=="[object Array]"&&I!==null&&typeof I=="object"&&typeof I.length=="number"&&I.length>=0&&j.call(I.callee)==="[object Function]"),G}},88959:function(ae,j,C){"use strict";ae.exports=D;var I=C(67467);function D(Q){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(Q)?Q:new Uint8Array(Q||0),this.pos=0,this.type=0,this.length=this.buf.length}D.Varint=0,D.Fixed64=1,D.Bytes=2,D.Fixed32=5;var G=65536*65536,U=1/G,B=12,Z=typeof TextDecoder=="undefined"?null:new TextDecoder("utf8");D.prototype={destroy:function(){this.buf=null},readFields:function(Q,Pe,Ae){for(Ae=Ae||this.length;this.pos<Ae;){var _e=this.readVarint(),ue=_e>>3,ke=this.pos;this.type=_e&7,Q(ue,Pe,this),this.pos===ke&&this.skip(_e)}return Pe},readMessage:function(Q,Pe){return this.readFields(Q,Pe,this.readVarint()+this.pos)},readFixed32:function(){var Q=oe(this.buf,this.pos);return this.pos+=4,Q},readSFixed32:function(){var Q=Ne(this.buf,this.pos);return this.pos+=4,Q},readFixed64:function(){var Q=oe(this.buf,this.pos)+oe(this.buf,this.pos+4)*G;return this.pos+=8,Q},readSFixed64:function(){var Q=oe(this.buf,this.pos)+Ne(this.buf,this.pos+4)*G;return this.pos+=8,Q},readFloat:function(){var Q=I.read(this.buf,this.pos,!0,23,4);return this.pos+=4,Q},readDouble:function(){var Q=I.read(this.buf,this.pos,!0,52,8);return this.pos+=8,Q},readVarint:function(Q){var Pe=this.buf,Ae,_e;return _e=Pe[this.pos++],Ae=_e&127,_e<128||(_e=Pe[this.pos++],Ae|=(_e&127)<<7,_e<128)||(_e=Pe[this.pos++],Ae|=(_e&127)<<14,_e<128)||(_e=Pe[this.pos++],Ae|=(_e&127)<<21,_e<128)?Ae:(_e=Pe[this.pos],Ae|=(_e&15)<<28,X(Ae,Q,this))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var Q=this.readVarint();return Q%2===1?(Q+1)/-2:Q/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var Q=this.readVarint()+this.pos,Pe=this.pos;return this.pos=Q,Q-Pe>=B&&Z?xe(this.buf,Pe,Q):ge(this.buf,Pe,Q)},readBytes:function(){var Q=this.readVarint()+this.pos,Pe=this.buf.subarray(this.pos,Q);return this.pos=Q,Pe},readPackedVarint:function(Q,Pe){if(this.type!==D.Bytes)return Q.push(this.readVarint(Pe));var Ae=q(this);for(Q=Q||[];this.pos<Ae;)Q.push(this.readVarint(Pe));return Q},readPackedSVarint:function(Q){if(this.type!==D.Bytes)return Q.push(this.readSVarint());var Pe=q(this);for(Q=Q||[];this.pos<Pe;)Q.push(this.readSVarint());return Q},readPackedBoolean:function(Q){if(this.type!==D.Bytes)return Q.push(this.readBoolean());var Pe=q(this);for(Q=Q||[];this.pos<Pe;)Q.push(this.readBoolean());return Q},readPackedFloat:function(Q){if(this.type!==D.Bytes)return Q.push(this.readFloat());var Pe=q(this);for(Q=Q||[];this.pos<Pe;)Q.push(this.readFloat());return Q},readPackedDouble:function(Q){if(this.type!==D.Bytes)return Q.push(this.readDouble());var Pe=q(this);for(Q=Q||[];this.pos<Pe;)Q.push(this.readDouble());return Q},readPackedFixed32:function(Q){if(this.type!==D.Bytes)return Q.push(this.readFixed32());var Pe=q(this);for(Q=Q||[];this.pos<Pe;)Q.push(this.readFixed32());return Q},readPackedSFixed32:function(Q){if(this.type!==D.Bytes)return Q.push(this.readSFixed32());var Pe=q(this);for(Q=Q||[];this.pos<Pe;)Q.push(this.readSFixed32());return Q},readPackedFixed64:function(Q){if(this.type!==D.Bytes)return Q.push(this.readFixed64());var Pe=q(this);for(Q=Q||[];this.pos<Pe;)Q.push(this.readFixed64());return Q},readPackedSFixed64:function(Q){if(this.type!==D.Bytes)return Q.push(this.readSFixed64());var Pe=q(this);for(Q=Q||[];this.pos<Pe;)Q.push(this.readSFixed64());return Q},skip:function(Q){var Pe=Q&7;if(Pe===D.Varint)for(;this.buf[this.pos++]>127;);else if(Pe===D.Bytes)this.pos=this.readVarint()+this.pos;else if(Pe===D.Fixed32)this.pos+=4;else if(Pe===D.Fixed64)this.pos+=8;else throw new Error("Unimplemented type: "+Pe)},writeTag:function(Q,Pe){this.writeVarint(Q<<3|Pe)},realloc:function(Q){for(var Pe=this.length||16;Pe<this.pos+Q;)Pe*=2;if(Pe!==this.length){var Ae=new Uint8Array(Pe);Ae.set(this.buf),this.buf=Ae,this.length=Pe}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(Q){this.realloc(4),Y(this.buf,Q,this.pos),this.pos+=4},writeSFixed32:function(Q){this.realloc(4),Y(this.buf,Q,this.pos),this.pos+=4},writeFixed64:function(Q){this.realloc(8),Y(this.buf,Q&-1,this.pos),Y(this.buf,Math.floor(Q*U),this.pos+4),this.pos+=8},writeSFixed64:function(Q){this.realloc(8),Y(this.buf,Q&-1,this.pos),Y(this.buf,Math.floor(Q*U),this.pos+4),this.pos+=8},writeVarint:function(Q){if(Q=+Q||0,Q>268435455||Q<0){he(Q,this);return}this.realloc(4),this.buf[this.pos++]=Q&127|(Q>127?128:0),!(Q<=127)&&(this.buf[this.pos++]=(Q>>>=7)&127|(Q>127?128:0),!(Q<=127)&&(this.buf[this.pos++]=(Q>>>=7)&127|(Q>127?128:0),!(Q<=127)&&(this.buf[this.pos++]=Q>>>7&127)))},writeSVarint:function(Q){this.writeVarint(Q<0?-Q*2-1:Q*2)},writeBoolean:function(Q){this.writeVarint(!!Q)},writeString:function(Q){Q=String(Q),this.realloc(Q.length*4),this.pos++;var Pe=this.pos;this.pos=ye(this.buf,Q,this.pos);var Ae=this.pos-Pe;Ae>=128&&Ze(Pe,Ae,this),this.pos=Pe-1,this.writeVarint(Ae),this.pos+=Ae},writeFloat:function(Q){this.realloc(4),I.write(this.buf,Q,this.pos,!0,23,4),this.pos+=4},writeDouble:function(Q){this.realloc(8),I.write(this.buf,Q,this.pos,!0,52,8),this.pos+=8},writeBytes:function(Q){var Pe=Q.length;this.writeVarint(Pe),this.realloc(Pe);for(var Ae=0;Ae<Pe;Ae++)this.buf[this.pos++]=Q[Ae]},writeRawMessage:function(Q,Pe){this.pos++;var Ae=this.pos;Q(Pe,this);var _e=this.pos-Ae;_e>=128&&Ze(Ae,_e,this),this.pos=Ae-1,this.writeVarint(_e),this.pos+=_e},writeMessage:function(Q,Pe,Ae){this.writeTag(Q,D.Bytes),this.writeRawMessage(Pe,Ae)},writePackedVarint:function(Q,Pe){Pe.length&&this.writeMessage(Q,qe,Pe)},writePackedSVarint:function(Q,Pe){Pe.length&&this.writeMessage(Q,De,Pe)},writePackedBoolean:function(Q,Pe){Pe.length&&this.writeMessage(Q,Me,Pe)},writePackedFloat:function(Q,Pe){Pe.length&&this.writeMessage(Q,Ge,Pe)},writePackedDouble:function(Q,Pe){Pe.length&&this.writeMessage(Q,Re,Pe)},writePackedFixed32:function(Q,Pe){Pe.length&&this.writeMessage(Q,ce,Pe)},writePackedSFixed32:function(Q,Pe){Pe.length&&this.writeMessage(Q,Be,Pe)},writePackedFixed64:function(Q,Pe){Pe.length&&this.writeMessage(Q,Ee,Pe)},writePackedSFixed64:function(Q,Pe){Pe.length&&this.writeMessage(Q,Se,Pe)},writeBytesField:function(Q,Pe){this.writeTag(Q,D.Bytes),this.writeBytes(Pe)},writeFixed32Field:function(Q,Pe){this.writeTag(Q,D.Fixed32),this.writeFixed32(Pe)},writeSFixed32Field:function(Q,Pe){this.writeTag(Q,D.Fixed32),this.writeSFixed32(Pe)},writeFixed64Field:function(Q,Pe){this.writeTag(Q,D.Fixed64),this.writeFixed64(Pe)},writeSFixed64Field:function(Q,Pe){this.writeTag(Q,D.Fixed64),this.writeSFixed64(Pe)},writeVarintField:function(Q,Pe){this.writeTag(Q,D.Varint),this.writeVarint(Pe)},writeSVarintField:function(Q,Pe){this.writeTag(Q,D.Varint),this.writeSVarint(Pe)},writeStringField:function(Q,Pe){this.writeTag(Q,D.Bytes),this.writeString(Pe)},writeFloatField:function(Q,Pe){this.writeTag(Q,D.Fixed32),this.writeFloat(Pe)},writeDoubleField:function(Q,Pe){this.writeTag(Q,D.Fixed64),this.writeDouble(Pe)},writeBooleanField:function(Q,Pe){this.writeVarintField(Q,!!Pe)}};function X(Q,Pe,Ae){var _e=Ae.buf,ue,ke;if(ke=_e[Ae.pos++],ue=(ke&112)>>4,ke<128||(ke=_e[Ae.pos++],ue|=(ke&127)<<3,ke<128)||(ke=_e[Ae.pos++],ue|=(ke&127)<<10,ke<128)||(ke=_e[Ae.pos++],ue|=(ke&127)<<17,ke<128)||(ke=_e[Ae.pos++],ue|=(ke&127)<<24,ke<128)||(ke=_e[Ae.pos++],ue|=(ke&1)<<31,ke<128))return ie(Q,ue,Pe);throw new Error("Expected varint not more than 10 bytes")}function q(Q){return Q.type===D.Bytes?Q.readVarint()+Q.pos:Q.pos+1}function ie(Q,Pe,Ae){return Ae?Pe*4294967296+(Q>>>0):(Pe>>>0)*4294967296+(Q>>>0)}function he(Q,Pe){var Ae,_e;if(Q>=0?(Ae=Q%4294967296|0,_e=Q/4294967296|0):(Ae=~(-Q%4294967296),_e=~(-Q/4294967296),Ae^4294967295?Ae=Ae+1|0:(Ae=0,_e=_e+1|0)),Q>=18446744073709552e3||Q<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");Pe.realloc(10),Ce(Ae,_e,Pe),be(_e,Pe)}function Ce(Q,Pe,Ae){Ae.buf[Ae.pos++]=Q&127|128,Q>>>=7,Ae.buf[Ae.pos++]=Q&127|128,Q>>>=7,Ae.buf[Ae.pos++]=Q&127|128,Q>>>=7,Ae.buf[Ae.pos++]=Q&127|128,Q>>>=7,Ae.buf[Ae.pos]=Q&127}function be(Q,Pe){var Ae=(Q&7)<<4;Pe.buf[Pe.pos++]|=Ae|((Q>>>=3)?128:0),Q&&(Pe.buf[Pe.pos++]=Q&127|((Q>>>=7)?128:0),Q&&(Pe.buf[Pe.pos++]=Q&127|((Q>>>=7)?128:0),Q&&(Pe.buf[Pe.pos++]=Q&127|((Q>>>=7)?128:0),Q&&(Pe.buf[Pe.pos++]=Q&127|((Q>>>=7)?128:0),Q&&(Pe.buf[Pe.pos++]=Q&127)))))}function Ze(Q,Pe,Ae){var _e=Pe<=16383?1:Pe<=2097151?2:Pe<=268435455?3:Math.floor(Math.log(Pe)/(Math.LN2*7));Ae.realloc(_e);for(var ue=Ae.pos-1;ue>=Q;ue--)Ae.buf[ue+_e]=Ae.buf[ue]}function qe(Q,Pe){for(var Ae=0;Ae<Q.length;Ae++)Pe.writeVarint(Q[Ae])}function De(Q,Pe){for(var Ae=0;Ae<Q.length;Ae++)Pe.writeSVarint(Q[Ae])}function Ge(Q,Pe){for(var Ae=0;Ae<Q.length;Ae++)Pe.writeFloat(Q[Ae])}function Re(Q,Pe){for(var Ae=0;Ae<Q.length;Ae++)Pe.writeDouble(Q[Ae])}function Me(Q,Pe){for(var Ae=0;Ae<Q.length;Ae++)Pe.writeBoolean(Q[Ae])}function ce(Q,Pe){for(var Ae=0;Ae<Q.length;Ae++)Pe.writeFixed32(Q[Ae])}function Be(Q,Pe){for(var Ae=0;Ae<Q.length;Ae++)Pe.writeSFixed32(Q[Ae])}function Ee(Q,Pe){for(var Ae=0;Ae<Q.length;Ae++)Pe.writeFixed64(Q[Ae])}function Se(Q,Pe){for(var Ae=0;Ae<Q.length;Ae++)Pe.writeSFixed64(Q[Ae])}function oe(Q,Pe){return(Q[Pe]|Q[Pe+1]<<8|Q[Pe+2]<<16)+Q[Pe+3]*16777216}function Y(Q,Pe,Ae){Q[Ae]=Pe,Q[Ae+1]=Pe>>>8,Q[Ae+2]=Pe>>>16,Q[Ae+3]=Pe>>>24}function Ne(Q,Pe){return(Q[Pe]|Q[Pe+1]<<8|Q[Pe+2]<<16)+(Q[Pe+3]<<24)}function ge(Q,Pe,Ae){for(var _e="",ue=Pe;ue<Ae;){var ke=Q[ue],ze=null,le=ke>239?4:ke>223?3:ke>191?2:1;if(ue+le>Ae)break;var Ut,kt,pr;le===1?ke<128&&(ze=ke):le===2?(Ut=Q[ue+1],(Ut&192)===128&&(ze=(ke&31)<<6|Ut&63,ze<=127&&(ze=null))):le===3?(Ut=Q[ue+1],kt=Q[ue+2],(Ut&192)===128&&(kt&192)===128&&(ze=(ke&15)<<12|(Ut&63)<<6|kt&63,(ze<=2047||ze>=55296&&ze<=57343)&&(ze=null))):le===4&&(Ut=Q[ue+1],kt=Q[ue+2],pr=Q[ue+3],(Ut&192)===128&&(kt&192)===128&&(pr&192)===128&&(ze=(ke&15)<<18|(Ut&63)<<12|(kt&63)<<6|pr&63,(ze<=65535||ze>=1114112)&&(ze=null))),ze===null?(ze=65533,le=1):ze>65535&&(ze-=65536,_e+=String.fromCharCode(ze>>>10&1023|55296),ze=56320|ze&1023),_e+=String.fromCharCode(ze),ue+=le}return _e}function xe(Q,Pe,Ae){return Z.decode(Q.subarray(Pe,Ae))}function ye(Q,Pe,Ae){for(var _e=0,ue,ke;_e<Pe.length;_e++){if(ue=Pe.charCodeAt(_e),ue>55295&&ue<57344)if(ke)if(ue<56320){Q[Ae++]=239,Q[Ae++]=191,Q[Ae++]=189,ke=ue;continue}else ue=ke-55296<<10|ue-56320|65536,ke=null;else{ue>56319||_e+1===Pe.length?(Q[Ae++]=239,Q[Ae++]=191,Q[Ae++]=189):ke=ue;continue}else ke&&(Q[Ae++]=239,Q[Ae++]=191,Q[Ae++]=189,ke=null);ue<128?Q[Ae++]=ue:(ue<2048?Q[Ae++]=ue>>6|192:(ue<65536?Q[Ae++]=ue>>12|224:(Q[Ae++]=ue>>18|240,Q[Ae++]=ue>>12&63|128),Q[Ae++]=ue>>6&63|128),Q[Ae++]=ue&63|128)}return Ae}},35447:function(ae){ae.exports=function(C,I,D,G){var U=C[0],B=C[1],Z=!1;D===void 0&&(D=0),G===void 0&&(G=I.length);for(var X=(G-D)/2,q=0,ie=X-1;q<X;ie=q++){var he=I[D+q*2+0],Ce=I[D+q*2+1],be=I[D+ie*2+0],Ze=I[D+ie*2+1],qe=Ce>B!=Ze>B&&U<(be-he)*(B-Ce)/(Ze-Ce)+he;qe&&(Z=!Z)}return Z}},76469:function(ae,j,C){var I=C(35447),D=C(47176);ae.exports=function(U,B,Z,X){return B.length>0&&Array.isArray(B[0])?D(U,B,Z,X):I(U,B,Z,X)},ae.exports.nested=D,ae.exports.flat=I},47176:function(ae){ae.exports=function(C,I,D,G){var U=C[0],B=C[1],Z=!1;D===void 0&&(D=0),G===void 0&&(G=I.length);for(var X=G-D,q=0,ie=X-1;q<X;ie=q++){var he=I[q+D][0],Ce=I[q+D][1],be=I[ie+D][0],Ze=I[ie+D][1],qe=Ce>B!=Ze>B&&U<(be-he)*(B-Ce)/(Ze-Ce)+he;qe&&(Z=!Z)}return Z}},94486:function(ae,j,C){var I=C(97671);(function(D,G){ae.exports=G()})(this,function(){"use strict";function D(Ft,te){if(!(Ft instanceof te))throw new TypeError("Cannot call a class as a function")}function G(Ft,te){for(var We=0;We<te.length;We++){var Qe=te[We];Qe.enumerable=Qe.enumerable||!1,Qe.configurable=!0,"value"in Qe&&(Qe.writable=!0),Object.defineProperty(Ft,Qe.key,Qe)}}function U(Ft,te,We){return te&&G(Ft.prototype,te),We&&G(Ft,We),Ft}var B=function(){function Ft(te,We){this.next=null,this.key=te,this.data=We,this.left=null,this.right=null}return Ft}();function Z(Ft,te){return Ft>te?1:Ft<te?-1:0}function X(Ft,te,We){for(var Qe=new B(null,null),vt=Qe,Lt=Qe;;){var Pt=We(Ft,te.key);if(Pt<0){if(te.left===null)break;if(We(Ft,te.left.key)<0){var Cr=te.left;if(te.left=Cr.right,Cr.right=te,te=Cr,te.left===null)break}Lt.left=te,Lt=te,te=te.left}else if(Pt>0){if(te.right===null)break;if(We(Ft,te.right.key)>0){var Cr=te.right;if(te.right=Cr.left,Cr.left=te,te=Cr,te.right===null)break}vt.right=te,vt=te,te=te.right}else break}return vt.right=te.left,Lt.left=te.right,te.left=Qe.right,te.right=Qe.left,te}function q(Ft,te,We,Qe){var vt=new B(Ft,te);if(We===null)return vt.left=vt.right=null,vt;We=X(Ft,We,Qe);var Lt=Qe(Ft,We.key);return Lt<0?(vt.left=We.left,vt.right=We,We.left=null):Lt>=0&&(vt.right=We.right,vt.left=We,We.right=null),vt}function ie(Ft,te,We){var Qe=null,vt=null;if(te){te=X(Ft,te,We);var Lt=We(te.key,Ft);Lt===0?(Qe=te.left,vt=te.right):Lt<0?(vt=te.right,te.right=null,Qe=te):(Qe=te.left,te.left=null,vt=te)}return{left:Qe,right:vt}}function he(Ft,te,We){return te===null?Ft:(Ft===null||(te=X(Ft.key,te,We),te.left=Ft),te)}function Ce(Ft,te,We,Qe,vt){if(Ft){Qe(""+te+(We?"\u2514\u2500\u2500 ":"\u251C\u2500\u2500 ")+vt(Ft)+`
`);var Lt=te+(We?"    ":"\u2502   ");Ft.left&&Ce(Ft.left,Lt,!1,Qe,vt),Ft.right&&Ce(Ft.right,Lt,!0,Qe,vt)}}var be=function(){function Ft(te){te===void 0&&(te=Z),this._root=null,this._size=0,this._comparator=te}return Ft.prototype.insert=function(te,We){return this._size++,this._root=q(te,We,this._root,this._comparator)},Ft.prototype.add=function(te,We){var Qe=new B(te,We);this._root===null&&(Qe.left=Qe.right=null,this._size++,this._root=Qe);var vt=this._comparator,Lt=X(te,this._root,vt),Pt=vt(te,Lt.key);return Pt===0?this._root=Lt:(Pt<0?(Qe.left=Lt.left,Qe.right=Lt,Lt.left=null):Pt>0&&(Qe.right=Lt.right,Qe.left=Lt,Lt.right=null),this._size++,this._root=Qe),this._root},Ft.prototype.remove=function(te){this._root=this._remove(te,this._root,this._comparator)},Ft.prototype._remove=function(te,We,Qe){var vt;if(We===null)return null;We=X(te,We,Qe);var Lt=Qe(te,We.key);return Lt===0?(We.left===null?vt=We.right:(vt=X(te,We.left,Qe),vt.right=We.right),this._size--,vt):We},Ft.prototype.pop=function(){var te=this._root;if(te){for(;te.left;)te=te.left;return this._root=X(te.key,this._root,this._comparator),this._root=this._remove(te.key,this._root,this._comparator),{key:te.key,data:te.data}}return null},Ft.prototype.findStatic=function(te){for(var We=this._root,Qe=this._comparator;We;){var vt=Qe(te,We.key);if(vt===0)return We;vt<0?We=We.left:We=We.right}return null},Ft.prototype.find=function(te){return this._root&&(this._root=X(te,this._root,this._comparator),this._comparator(te,this._root.key)!==0)?null:this._root},Ft.prototype.contains=function(te){for(var We=this._root,Qe=this._comparator;We;){var vt=Qe(te,We.key);if(vt===0)return!0;vt<0?We=We.left:We=We.right}return!1},Ft.prototype.forEach=function(te,We){for(var Qe=this._root,vt=[],Lt=!1;!Lt;)Qe!==null?(vt.push(Qe),Qe=Qe.left):vt.length!==0?(Qe=vt.pop(),te.call(We,Qe),Qe=Qe.right):Lt=!0;return this},Ft.prototype.range=function(te,We,Qe,vt){for(var Lt=[],Pt=this._comparator,Cr=this._root,yt;Lt.length!==0||Cr;)if(Cr)Lt.push(Cr),Cr=Cr.left;else{if(Cr=Lt.pop(),yt=Pt(Cr.key,We),yt>0)break;if(Pt(Cr.key,te)>=0&&Qe.call(vt,Cr))return this;Cr=Cr.right}return this},Ft.prototype.keys=function(){var te=[];return this.forEach(function(We){var Qe=We.key;return te.push(Qe)}),te},Ft.prototype.values=function(){var te=[];return this.forEach(function(We){var Qe=We.data;return te.push(Qe)}),te},Ft.prototype.min=function(){return this._root?this.minNode(this._root).key:null},Ft.prototype.max=function(){return this._root?this.maxNode(this._root).key:null},Ft.prototype.minNode=function(te){if(te===void 0&&(te=this._root),te)for(;te.left;)te=te.left;return te},Ft.prototype.maxNode=function(te){if(te===void 0&&(te=this._root),te)for(;te.right;)te=te.right;return te},Ft.prototype.at=function(te){for(var We=this._root,Qe=!1,vt=0,Lt=[];!Qe;)if(We)Lt.push(We),We=We.left;else if(Lt.length>0){if(We=Lt.pop(),vt===te)return We;vt++,We=We.right}else Qe=!0;return null},Ft.prototype.next=function(te){var We=this._root,Qe=null;if(te.right){for(Qe=te.right;Qe.left;)Qe=Qe.left;return Qe}for(var vt=this._comparator;We;){var Lt=vt(te.key,We.key);if(Lt===0)break;Lt<0?(Qe=We,We=We.left):We=We.right}return Qe},Ft.prototype.prev=function(te){var We=this._root,Qe=null;if(te.left!==null){for(Qe=te.left;Qe.right;)Qe=Qe.right;return Qe}for(var vt=this._comparator;We;){var Lt=vt(te.key,We.key);if(Lt===0)break;Lt<0?We=We.left:(Qe=We,We=We.right)}return Qe},Ft.prototype.clear=function(){return this._root=null,this._size=0,this},Ft.prototype.toList=function(){return De(this._root)},Ft.prototype.load=function(te,We,Qe){We===void 0&&(We=[]),Qe===void 0&&(Qe=!1);var vt=te.length,Lt=this._comparator;if(Qe&&Me(te,We,0,vt-1,Lt),this._root===null)this._root=Ze(te,We,0,vt),this._size=vt;else{var Pt=Re(this.toList(),qe(te,We),Lt);vt=this._size+vt,this._root=Ge({head:Pt},0,vt)}return this},Ft.prototype.isEmpty=function(){return this._root===null},Object.defineProperty(Ft.prototype,"size",{get:function(){return this._size},enumerable:!0,configurable:!0}),Object.defineProperty(Ft.prototype,"root",{get:function(){return this._root},enumerable:!0,configurable:!0}),Ft.prototype.toString=function(te){te===void 0&&(te=function(vt){return String(vt.key)});var We=[];return Ce(this._root,"",!0,function(Qe){return We.push(Qe)},te),We.join("")},Ft.prototype.update=function(te,We,Qe){var vt=this._comparator,Lt=ie(te,this._root,vt),Pt=Lt.left,Cr=Lt.right;vt(te,We)<0?Cr=q(We,Qe,Cr,vt):Pt=q(We,Qe,Pt,vt),this._root=he(Pt,Cr,vt)},Ft.prototype.split=function(te){return ie(te,this._root,this._comparator)},Ft}();function Ze(Ft,te,We,Qe){var vt=Qe-We;if(vt>0){var Lt=We+Math.floor(vt/2),Pt=Ft[Lt],Cr=te[Lt],yt=new B(Pt,Cr);return yt.left=Ze(Ft,te,We,Lt),yt.right=Ze(Ft,te,Lt+1,Qe),yt}return null}function qe(Ft,te){for(var We=new B(null,null),Qe=We,vt=0;vt<Ft.length;vt++)Qe=Qe.next=new B(Ft[vt],te[vt]);return Qe.next=null,We.next}function De(Ft){for(var te=Ft,We=[],Qe=!1,vt=new B(null,null),Lt=vt;!Qe;)te?(We.push(te),te=te.left):We.length>0?(te=Lt=Lt.next=We.pop(),te=te.right):Qe=!0;return Lt.next=null,vt.next}function Ge(Ft,te,We){var Qe=We-te;if(Qe>0){var vt=te+Math.floor(Qe/2),Lt=Ge(Ft,te,vt),Pt=Ft.head;return Pt.left=Lt,Ft.head=Ft.head.next,Pt.right=Ge(Ft,vt+1,We),Pt}return null}function Re(Ft,te,We){for(var Qe=new B(null,null),vt=Qe,Lt=Ft,Pt=te;Lt!==null&&Pt!==null;)We(Lt.key,Pt.key)<0?(vt.next=Lt,Lt=Lt.next):(vt.next=Pt,Pt=Pt.next),vt=vt.next;return Lt!==null?vt.next=Lt:Pt!==null&&(vt.next=Pt),Qe.next}function Me(Ft,te,We,Qe,vt){if(!(We>=Qe)){for(var Lt=Ft[We+Qe>>1],Pt=We-1,Cr=Qe+1;;){do Pt++;while(vt(Ft[Pt],Lt)<0);do Cr--;while(vt(Ft[Cr],Lt)>0);if(Pt>=Cr)break;var yt=Ft[Pt];Ft[Pt]=Ft[Cr],Ft[Cr]=yt,yt=te[Pt],te[Pt]=te[Cr],te[Cr]=yt}Me(Ft,te,We,Cr,vt),Me(Ft,te,Cr+1,Qe,vt)}}var ce=function(te,We){return te.ll.x<=We.x&&We.x<=te.ur.x&&te.ll.y<=We.y&&We.y<=te.ur.y},Be=function(te,We){if(We.ur.x<te.ll.x||te.ur.x<We.ll.x||We.ur.y<te.ll.y||te.ur.y<We.ll.y)return null;var Qe=te.ll.x<We.ll.x?We.ll.x:te.ll.x,vt=te.ur.x<We.ur.x?te.ur.x:We.ur.x,Lt=te.ll.y<We.ll.y?We.ll.y:te.ll.y,Pt=te.ur.y<We.ur.y?te.ur.y:We.ur.y;return{ll:{x:Qe,y:Lt},ur:{x:vt,y:Pt}}},Ee=Number.EPSILON;Ee===void 0&&(Ee=Math.pow(2,-52));var Se=Ee*Ee,oe=function(te,We){if(-Ee<te&&te<Ee&&-Ee<We&&We<Ee)return 0;var Qe=te-We;return Qe*Qe<Se*te*We?0:te<We?-1:1},Y=function(){function Ft(){D(this,Ft),this.reset()}return U(Ft,[{key:"reset",value:function(){this.xRounder=new Ne,this.yRounder=new Ne}},{key:"round",value:function(We,Qe){return{x:this.xRounder.round(We),y:this.yRounder.round(Qe)}}}]),Ft}(),Ne=function(){function Ft(){D(this,Ft),this.tree=new be,this.round(0)}return U(Ft,[{key:"round",value:function(We){var Qe=this.tree.add(We),vt=this.tree.prev(Qe);if(vt!==null&&oe(Qe.key,vt.key)===0)return this.tree.remove(We),vt.key;var Lt=this.tree.next(Qe);return Lt!==null&&oe(Qe.key,Lt.key)===0?(this.tree.remove(We),Lt.key):We}}]),Ft}(),ge=new Y,xe=function(te,We){return te.x*We.y-te.y*We.x},ye=function(te,We){return te.x*We.x+te.y*We.y},Q=function(te,We,Qe){var vt={x:We.x-te.x,y:We.y-te.y},Lt={x:Qe.x-te.x,y:Qe.y-te.y},Pt=xe(vt,Lt);return oe(Pt,0)},Pe=function(te){return Math.sqrt(ye(te,te))},Ae=function(te,We,Qe){var vt={x:We.x-te.x,y:We.y-te.y},Lt={x:Qe.x-te.x,y:Qe.y-te.y};return xe(Lt,vt)/Pe(Lt)/Pe(vt)},_e=function(te,We,Qe){var vt={x:We.x-te.x,y:We.y-te.y},Lt={x:Qe.x-te.x,y:Qe.y-te.y};return ye(Lt,vt)/Pe(Lt)/Pe(vt)},ue=function(te,We,Qe){return We.y===0?null:{x:te.x+We.x/We.y*(Qe-te.y),y:Qe}},ke=function(te,We,Qe){return We.x===0?null:{x:Qe,y:te.y+We.y/We.x*(Qe-te.x)}},ze=function(te,We,Qe,vt){if(We.x===0)return ke(Qe,vt,te.x);if(vt.x===0)return ke(te,We,Qe.x);if(We.y===0)return ue(Qe,vt,te.y);if(vt.y===0)return ue(te,We,Qe.y);var Lt=xe(We,vt);if(Lt==0)return null;var Pt={x:Qe.x-te.x,y:Qe.y-te.y},Cr=xe(Pt,We)/Lt,yt=xe(Pt,vt)/Lt,Ot=te.x+yt*We.x,rr=Qe.x+Cr*vt.x,Sr=te.y+yt*We.y,Lr=Qe.y+Cr*vt.y,on=(Ot+rr)/2,hn=(Sr+Lr)/2;return{x:on,y:hn}},le=function(){U(Ft,null,[{key:"compare",value:function(We,Qe){var vt=Ft.comparePoints(We.point,Qe.point);return vt!==0?vt:(We.point!==Qe.point&&We.link(Qe),We.isLeft!==Qe.isLeft?We.isLeft?1:-1:kt.compare(We.segment,Qe.segment))}},{key:"comparePoints",value:function(We,Qe){return We.x<Qe.x?-1:We.x>Qe.x?1:We.y<Qe.y?-1:We.y>Qe.y?1:0}}]);function Ft(te,We){D(this,Ft),te.events===void 0?te.events=[this]:te.events.push(this),this.point=te,this.isLeft=We}return U(Ft,[{key:"link",value:function(We){if(We.point===this.point)throw new Error("Tried to link already linked events");for(var Qe=We.point.events,vt=0,Lt=Qe.length;vt<Lt;vt++){var Pt=Qe[vt];this.point.events.push(Pt),Pt.point=this.point}this.checkForConsuming()}},{key:"checkForConsuming",value:function(){for(var We=this.point.events.length,Qe=0;Qe<We;Qe++){var vt=this.point.events[Qe];if(vt.segment.consumedBy===void 0)for(var Lt=Qe+1;Lt<We;Lt++){var Pt=this.point.events[Lt];Pt.consumedBy===void 0&&vt.otherSE.point.events===Pt.otherSE.point.events&&vt.segment.consume(Pt.segment)}}}},{key:"getAvailableLinkedEvents",value:function(){for(var We=[],Qe=0,vt=this.point.events.length;Qe<vt;Qe++){var Lt=this.point.events[Qe];Lt!==this&&!Lt.segment.ringOut&&Lt.segment.isInResult()&&We.push(Lt)}return We}},{key:"getLeftmostComparator",value:function(We){var Qe=this,vt=new Map,Lt=function(Cr){var yt=Cr.otherSE;vt.set(Cr,{sine:Ae(Qe.point,We.point,yt.point),cosine:_e(Qe.point,We.point,yt.point)})};return function(Pt,Cr){vt.has(Pt)||Lt(Pt),vt.has(Cr)||Lt(Cr);var yt=vt.get(Pt),Ot=yt.sine,rr=yt.cosine,Sr=vt.get(Cr),Lr=Sr.sine,on=Sr.cosine;return Ot>=0&&Lr>=0?rr<on?1:rr>on?-1:0:Ot<0&&Lr<0?rr<on?-1:rr>on?1:0:Lr<Ot?-1:Lr>Ot?1:0}}}]),Ft}(),Ut=0,kt=function(){U(Ft,null,[{key:"compare",value:function(We,Qe){var vt=We.leftSE.point.x,Lt=Qe.leftSE.point.x,Pt=We.rightSE.point.x,Cr=Qe.rightSE.point.x;if(Cr<vt)return 1;if(Pt<Lt)return-1;var yt=We.leftSE.point.y,Ot=Qe.leftSE.point.y,rr=We.rightSE.point.y,Sr=Qe.rightSE.point.y;if(vt<Lt){if(Ot<yt&&Ot<rr)return 1;if(Ot>yt&&Ot>rr)return-1;var Lr=We.comparePoint(Qe.leftSE.point);if(Lr<0)return 1;if(Lr>0)return-1;var on=Qe.comparePoint(We.rightSE.point);return on!==0?on:-1}if(vt>Lt){if(yt<Ot&&yt<Sr)return-1;if(yt>Ot&&yt>Sr)return 1;var hn=Qe.comparePoint(We.leftSE.point);if(hn!==0)return hn;var zr=We.comparePoint(Qe.rightSE.point);return zr<0?1:zr>0?-1:1}if(yt<Ot)return-1;if(yt>Ot)return 1;if(Pt<Cr){var rn=Qe.comparePoint(We.rightSE.point);if(rn!==0)return rn}if(Pt>Cr){var Wn=We.comparePoint(Qe.rightSE.point);if(Wn<0)return 1;if(Wn>0)return-1}if(Pt!==Cr){var jn=rr-yt,mi=Pt-vt,Ea=Sr-Ot,ja=Cr-Lt;if(jn>mi&&Ea<ja)return 1;if(jn<mi&&Ea>ja)return-1}return Pt>Cr?1:Pt<Cr||rr<Sr?-1:rr>Sr?1:We.id<Qe.id?-1:We.id>Qe.id?1:0}}]);function Ft(te,We,Qe,vt){D(this,Ft),this.id=++Ut,this.leftSE=te,te.segment=this,te.otherSE=We,this.rightSE=We,We.segment=this,We.otherSE=te,this.rings=Qe,this.windings=vt}return U(Ft,[{key:"replaceRightSE",value:function(We){this.rightSE=We,this.rightSE.segment=this,this.rightSE.otherSE=this.leftSE,this.leftSE.otherSE=this.rightSE}},{key:"bbox",value:function(){var We=this.leftSE.point.y,Qe=this.rightSE.point.y;return{ll:{x:this.leftSE.point.x,y:We<Qe?We:Qe},ur:{x:this.rightSE.point.x,y:We>Qe?We:Qe}}}},{key:"vector",value:function(){return{x:this.rightSE.point.x-this.leftSE.point.x,y:this.rightSE.point.y-this.leftSE.point.y}}},{key:"isAnEndpoint",value:function(We){return We.x===this.leftSE.point.x&&We.y===this.leftSE.point.y||We.x===this.rightSE.point.x&&We.y===this.rightSE.point.y}},{key:"comparePoint",value:function(We){if(this.isAnEndpoint(We))return 0;var Qe=this.leftSE.point,vt=this.rightSE.point,Lt=this.vector();if(Qe.x===vt.x)return We.x===Qe.x?0:We.x<Qe.x?1:-1;var Pt=(We.y-Qe.y)/Lt.y,Cr=Qe.x+Pt*Lt.x;if(We.x===Cr)return 0;var yt=(We.x-Qe.x)/Lt.x,Ot=Qe.y+yt*Lt.y;return We.y===Ot?0:We.y<Ot?-1:1}},{key:"getIntersection",value:function(We){var Qe=this.bbox(),vt=We.bbox(),Lt=Be(Qe,vt);if(Lt===null)return null;var Pt=this.leftSE.point,Cr=this.rightSE.point,yt=We.leftSE.point,Ot=We.rightSE.point,rr=ce(Qe,yt)&&this.comparePoint(yt)===0,Sr=ce(vt,Pt)&&We.comparePoint(Pt)===0,Lr=ce(Qe,Ot)&&this.comparePoint(Ot)===0,on=ce(vt,Cr)&&We.comparePoint(Cr)===0;if(Sr&&rr)return on&&!Lr?Cr:!on&&Lr?Ot:null;if(Sr)return Lr&&Pt.x===Ot.x&&Pt.y===Ot.y?null:Pt;if(rr)return on&&Cr.x===yt.x&&Cr.y===yt.y?null:yt;if(on&&Lr)return null;if(on)return Cr;if(Lr)return Ot;var hn=ze(Pt,this.vector(),yt,We.vector());return hn===null||!ce(Lt,hn)?null:ge.round(hn.x,hn.y)}},{key:"split",value:function(We){var Qe=[],vt=We.events!==void 0,Lt=new le(We,!0),Pt=new le(We,!1),Cr=this.rightSE;this.replaceRightSE(Pt),Qe.push(Pt),Qe.push(Lt);var yt=new Ft(Lt,Cr,this.rings.slice(),this.windings.slice());return le.comparePoints(yt.leftSE.point,yt.rightSE.point)>0&&yt.swapEvents(),le.comparePoints(this.leftSE.point,this.rightSE.point)>0&&this.swapEvents(),vt&&(Lt.checkForConsuming(),Pt.checkForConsuming()),Qe}},{key:"swapEvents",value:function(){var We=this.rightSE;this.rightSE=this.leftSE,this.leftSE=We,this.leftSE.isLeft=!0,this.rightSE.isLeft=!1;for(var Qe=0,vt=this.windings.length;Qe<vt;Qe++)this.windings[Qe]*=-1}},{key:"consume",value:function(We){for(var Qe=this,vt=We;Qe.consumedBy;)Qe=Qe.consumedBy;for(;vt.consumedBy;)vt=vt.consumedBy;var Lt=Ft.compare(Qe,vt);if(Lt!==0){if(Lt>0){var Pt=Qe;Qe=vt,vt=Pt}if(Qe.prev===vt){var Cr=Qe;Qe=vt,vt=Cr}for(var yt=0,Ot=vt.rings.length;yt<Ot;yt++){var rr=vt.rings[yt],Sr=vt.windings[yt],Lr=Qe.rings.indexOf(rr);Lr===-1?(Qe.rings.push(rr),Qe.windings.push(Sr)):Qe.windings[Lr]+=Sr}vt.rings=null,vt.windings=null,vt.consumedBy=Qe,vt.leftSE.consumedBy=Qe.leftSE,vt.rightSE.consumedBy=Qe.rightSE}}},{key:"prevInResult",value:function(){return this._prevInResult!==void 0?this._prevInResult:(this.prev?this.prev.isInResult()?this._prevInResult=this.prev:this._prevInResult=this.prev.prevInResult():this._prevInResult=null,this._prevInResult)}},{key:"beforeState",value:function(){if(this._beforeState!==void 0)return this._beforeState;if(!this.prev)this._beforeState={rings:[],windings:[],multiPolys:[]};else{var We=this.prev.consumedBy||this.prev;this._beforeState=We.afterState()}return this._beforeState}},{key:"afterState",value:function(){if(this._afterState!==void 0)return this._afterState;var We=this.beforeState();this._afterState={rings:We.rings.slice(0),windings:We.windings.slice(0),multiPolys:[]};for(var Qe=this._afterState.rings,vt=this._afterState.windings,Lt=this._afterState.multiPolys,Pt=0,Cr=this.rings.length;Pt<Cr;Pt++){var yt=this.rings[Pt],Ot=this.windings[Pt],rr=Qe.indexOf(yt);rr===-1?(Qe.push(yt),vt.push(Ot)):vt[rr]+=Ot}for(var Sr=[],Lr=[],on=0,hn=Qe.length;on<hn;on++)if(vt[on]!==0){var zr=Qe[on],rn=zr.poly;if(Lr.indexOf(rn)===-1)if(zr.isExterior)Sr.push(rn);else{Lr.indexOf(rn)===-1&&Lr.push(rn);var Wn=Sr.indexOf(zr.poly);Wn!==-1&&Sr.splice(Wn,1)}}for(var jn=0,mi=Sr.length;jn<mi;jn++){var Ea=Sr[jn].multiPoly;Lt.indexOf(Ea)===-1&&Lt.push(Ea)}return this._afterState}},{key:"isInResult",value:function(){if(this.consumedBy)return!1;if(this._isInResult!==void 0)return this._isInResult;var We=this.beforeState().multiPolys,Qe=this.afterState().multiPolys;switch(Kn.type){case"union":{var vt=We.length===0,Lt=Qe.length===0;this._isInResult=vt!==Lt;break}case"intersection":{var Pt,Cr;We.length<Qe.length?(Pt=We.length,Cr=Qe.length):(Pt=Qe.length,Cr=We.length),this._isInResult=Cr===Kn.numMultiPolys&&Pt<Cr;break}case"xor":{var yt=Math.abs(We.length-Qe.length);this._isInResult=yt%2===1;break}case"difference":{var Ot=function(Sr){return Sr.length===1&&Sr[0].isSubject};this._isInResult=Ot(We)!==Ot(Qe);break}default:throw new Error("Unrecognized operation type found ".concat(Kn.type))}return this._isInResult}}],[{key:"fromRing",value:function(We,Qe,vt){var Lt,Pt,Cr,yt=le.comparePoints(We,Qe);if(yt<0)Lt=We,Pt=Qe,Cr=1;else if(yt>0)Lt=Qe,Pt=We,Cr=-1;else throw new Error("Tried to create degenerate segment at [".concat(We.x,", ").concat(We.y,"]"));var Ot=new le(Lt,!0),rr=new le(Pt,!1);return new Ft(Ot,rr,[vt],[Cr])}}]),Ft}(),pr=function(){function Ft(te,We,Qe){if(D(this,Ft),!Array.isArray(te)||te.length===0)throw new Error("Input geometry is not a valid Polygon or MultiPolygon");if(this.poly=We,this.isExterior=Qe,this.segments=[],typeof te[0][0]!="number"||typeof te[0][1]!="number")throw new Error("Input geometry is not a valid Polygon or MultiPolygon");var vt=ge.round(te[0][0],te[0][1]);this.bbox={ll:{x:vt.x,y:vt.y},ur:{x:vt.x,y:vt.y}};for(var Lt=vt,Pt=1,Cr=te.length;Pt<Cr;Pt++){if(typeof te[Pt][0]!="number"||typeof te[Pt][1]!="number")throw new Error("Input geometry is not a valid Polygon or MultiPolygon");var yt=ge.round(te[Pt][0],te[Pt][1]);yt.x===Lt.x&&yt.y===Lt.y||(this.segments.push(kt.fromRing(Lt,yt,this)),yt.x<this.bbox.ll.x&&(this.bbox.ll.x=yt.x),yt.y<this.bbox.ll.y&&(this.bbox.ll.y=yt.y),yt.x>this.bbox.ur.x&&(this.bbox.ur.x=yt.x),yt.y>this.bbox.ur.y&&(this.bbox.ur.y=yt.y),Lt=yt)}(vt.x!==Lt.x||vt.y!==Lt.y)&&this.segments.push(kt.fromRing(Lt,vt,this))}return U(Ft,[{key:"getSweepEvents",value:function(){for(var We=[],Qe=0,vt=this.segments.length;Qe<vt;Qe++){var Lt=this.segments[Qe];We.push(Lt.leftSE),We.push(Lt.rightSE)}return We}}]),Ft}(),Wt=function(){function Ft(te,We){if(D(this,Ft),!Array.isArray(te))throw new Error("Input geometry is not a valid Polygon or MultiPolygon");this.exteriorRing=new pr(te[0],this,!0),this.bbox={ll:{x:this.exteriorRing.bbox.ll.x,y:this.exteriorRing.bbox.ll.y},ur:{x:this.exteriorRing.bbox.ur.x,y:this.exteriorRing.bbox.ur.y}},this.interiorRings=[];for(var Qe=1,vt=te.length;Qe<vt;Qe++){var Lt=new pr(te[Qe],this,!1);Lt.bbox.ll.x<this.bbox.ll.x&&(this.bbox.ll.x=Lt.bbox.ll.x),Lt.bbox.ll.y<this.bbox.ll.y&&(this.bbox.ll.y=Lt.bbox.ll.y),Lt.bbox.ur.x>this.bbox.ur.x&&(this.bbox.ur.x=Lt.bbox.ur.x),Lt.bbox.ur.y>this.bbox.ur.y&&(this.bbox.ur.y=Lt.bbox.ur.y),this.interiorRings.push(Lt)}this.multiPoly=We}return U(Ft,[{key:"getSweepEvents",value:function(){for(var We=this.exteriorRing.getSweepEvents(),Qe=0,vt=this.interiorRings.length;Qe<vt;Qe++)for(var Lt=this.interiorRings[Qe].getSweepEvents(),Pt=0,Cr=Lt.length;Pt<Cr;Pt++)We.push(Lt[Pt]);return We}}]),Ft}(),Xr=function(){function Ft(te,We){if(D(this,Ft),!Array.isArray(te))throw new Error("Input geometry is not a valid Polygon or MultiPolygon");try{typeof te[0][0][0]=="number"&&(te=[te])}catch(Pt){}this.polys=[],this.bbox={ll:{x:Number.POSITIVE_INFINITY,y:Number.POSITIVE_INFINITY},ur:{x:Number.NEGATIVE_INFINITY,y:Number.NEGATIVE_INFINITY}};for(var Qe=0,vt=te.length;Qe<vt;Qe++){var Lt=new Wt(te[Qe],this);Lt.bbox.ll.x<this.bbox.ll.x&&(this.bbox.ll.x=Lt.bbox.ll.x),Lt.bbox.ll.y<this.bbox.ll.y&&(this.bbox.ll.y=Lt.bbox.ll.y),Lt.bbox.ur.x>this.bbox.ur.x&&(this.bbox.ur.x=Lt.bbox.ur.x),Lt.bbox.ur.y>this.bbox.ur.y&&(this.bbox.ur.y=Lt.bbox.ur.y),this.polys.push(Lt)}this.isSubject=We}return U(Ft,[{key:"getSweepEvents",value:function(){for(var We=[],Qe=0,vt=this.polys.length;Qe<vt;Qe++)for(var Lt=this.polys[Qe].getSweepEvents(),Pt=0,Cr=Lt.length;Pt<Cr;Pt++)We.push(Lt[Pt]);return We}}]),Ft}(),fn=function(){U(Ft,null,[{key:"factory",value:function(We){for(var Qe=[],vt=0,Lt=We.length;vt<Lt;vt++){var Pt=We[vt];if(!(!Pt.isInResult()||Pt.ringOut)){for(var Cr=null,yt=Pt.leftSE,Ot=Pt.rightSE,rr=[yt],Sr=yt.point,Lr=[];Cr=yt,yt=Ot,rr.push(yt),yt.point!==Sr;)for(;;){var on=yt.getAvailableLinkedEvents();if(on.length===0){var hn=rr[0].point,zr=rr[rr.length-1].point;throw new Error("Unable to complete output ring starting at [".concat(hn.x,",")+" ".concat(hn.y,"]. Last matching segment found ends at")+" [".concat(zr.x,", ").concat(zr.y,"]."))}if(on.length===1){Ot=on[0].otherSE;break}for(var rn=null,Wn=0,jn=Lr.length;Wn<jn;Wn++)if(Lr[Wn].point===yt.point){rn=Wn;break}if(rn!==null){var mi=Lr.splice(rn)[0],Ea=rr.splice(mi.index);Ea.unshift(Ea[0].otherSE),Qe.push(new Ft(Ea.reverse()));continue}Lr.push({index:rr.length,point:yt.point});var ja=yt.getLeftmostComparator(Cr);Ot=on.sort(ja)[0].otherSE;break}Qe.push(new Ft(rr))}}return Qe}}]);function Ft(te){D(this,Ft),this.events=te;for(var We=0,Qe=te.length;We<Qe;We++)te[We].segment.ringOut=this;this.poly=null}return U(Ft,[{key:"getGeom",value:function(){for(var We=this.events[0].point,Qe=[We],vt=1,Lt=this.events.length-1;vt<Lt;vt++){var Pt=this.events[vt].point,Cr=this.events[vt+1].point;Q(Pt,We,Cr)!==0&&(Qe.push(Pt),We=Pt)}if(Qe.length===1)return null;var yt=Qe[0],Ot=Qe[1];Q(yt,We,Ot)===0&&Qe.shift(),Qe.push(Qe[0]);for(var rr=this.isExteriorRing()?1:-1,Sr=this.isExteriorRing()?0:Qe.length-1,Lr=this.isExteriorRing()?Qe.length:-1,on=[],hn=Sr;hn!=Lr;hn+=rr)on.push([Qe[hn].x,Qe[hn].y]);return on}},{key:"isExteriorRing",value:function(){if(this._isExteriorRing===void 0){var We=this.enclosingRing();this._isExteriorRing=We?!We.isExteriorRing():!0}return this._isExteriorRing}},{key:"enclosingRing",value:function(){return this._enclosingRing===void 0&&(this._enclosingRing=this._calcEnclosingRing()),this._enclosingRing}},{key:"_calcEnclosingRing",value:function(){for(var We=this.events[0],Qe=1,vt=this.events.length;Qe<vt;Qe++){var Lt=this.events[Qe];le.compare(We,Lt)>0&&(We=Lt)}for(var Pt=We.segment.prevInResult(),Cr=Pt?Pt.prevInResult():null;;){if(!Pt)return null;if(!Cr)return Pt.ringOut;if(Cr.ringOut!==Pt.ringOut)return Cr.ringOut.enclosingRing()!==Pt.ringOut?Pt.ringOut:Pt.ringOut.enclosingRing();Pt=Cr.prevInResult(),Cr=Pt?Pt.prevInResult():null}}}]),Ft}(),Ir=function(){function Ft(te){D(this,Ft),this.exteriorRing=te,te.poly=this,this.interiorRings=[]}return U(Ft,[{key:"addInterior",value:function(We){this.interiorRings.push(We),We.poly=this}},{key:"getGeom",value:function(){var We=[this.exteriorRing.getGeom()];if(We[0]===null)return null;for(var Qe=0,vt=this.interiorRings.length;Qe<vt;Qe++){var Lt=this.interiorRings[Qe].getGeom();Lt!==null&&We.push(Lt)}return We}}]),Ft}(),Qr=function(){function Ft(te){D(this,Ft),this.rings=te,this.polys=this._composePolys(te)}return U(Ft,[{key:"getGeom",value:function(){for(var We=[],Qe=0,vt=this.polys.length;Qe<vt;Qe++){var Lt=this.polys[Qe].getGeom();Lt!==null&&We.push(Lt)}return We}},{key:"_composePolys",value:function(We){for(var Qe=[],vt=0,Lt=We.length;vt<Lt;vt++){var Pt=We[vt];if(!Pt.poly)if(Pt.isExteriorRing())Qe.push(new Ir(Pt));else{var Cr=Pt.enclosingRing();Cr.poly||Qe.push(new Ir(Cr)),Cr.poly.addInterior(Pt)}}return Qe}}]),Ft}(),tn=function(){function Ft(te){var We=arguments.length>1&&arguments[1]!==void 0?arguments[1]:kt.compare;D(this,Ft),this.queue=te,this.tree=new be(We),this.segments=[]}return U(Ft,[{key:"process",value:function(We){var Qe=We.segment,vt=[];if(We.consumedBy)return We.isLeft?this.queue.remove(We.otherSE):this.tree.remove(Qe),vt;var Lt=We.isLeft?this.tree.insert(Qe):this.tree.find(Qe);if(!Lt)throw new Error("Unable to find segment #".concat(Qe.id," ")+"[".concat(Qe.leftSE.point.x,", ").concat(Qe.leftSE.point.y,"] -> ")+"[".concat(Qe.rightSE.point.x,", ").concat(Qe.rightSE.point.y,"] ")+"in SweepLine tree. Please submit a bug report.");for(var Pt=Lt,Cr=Lt,yt=void 0,Ot=void 0;yt===void 0;)Pt=this.tree.prev(Pt),Pt===null?yt=null:Pt.key.consumedBy===void 0&&(yt=Pt.key);for(;Ot===void 0;)Cr=this.tree.next(Cr),Cr===null?Ot=null:Cr.key.consumedBy===void 0&&(Ot=Cr.key);if(We.isLeft){var rr=null;if(yt){var Sr=yt.getIntersection(Qe);if(Sr!==null&&(Qe.isAnEndpoint(Sr)||(rr=Sr),!yt.isAnEndpoint(Sr)))for(var Lr=this._splitSafely(yt,Sr),on=0,hn=Lr.length;on<hn;on++)vt.push(Lr[on])}var zr=null;if(Ot){var rn=Ot.getIntersection(Qe);if(rn!==null&&(Qe.isAnEndpoint(rn)||(zr=rn),!Ot.isAnEndpoint(rn)))for(var Wn=this._splitSafely(Ot,rn),jn=0,mi=Wn.length;jn<mi;jn++)vt.push(Wn[jn])}if(rr!==null||zr!==null){var Ea=null;if(rr===null)Ea=zr;else if(zr===null)Ea=rr;else{var ja=le.comparePoints(rr,zr);Ea=ja<=0?rr:zr}this.queue.remove(Qe.rightSE),vt.push(Qe.rightSE);for(var Wr=Qe.split(Ea),no=0,Xo=Wr.length;no<Xo;no++)vt.push(Wr[no])}vt.length>0?(this.tree.remove(Qe),vt.push(We)):(this.segments.push(Qe),Qe.prev=yt)}else{if(yt&&Ot){var Xn=yt.getIntersection(Ot);if(Xn!==null){if(!yt.isAnEndpoint(Xn))for(var Hs=this._splitSafely(yt,Xn),Bo=0,iu=Hs.length;Bo<iu;Bo++)vt.push(Hs[Bo]);if(!Ot.isAnEndpoint(Xn))for(var ts=this._splitSafely(Ot,Xn),Vl=0,ku=ts.length;Vl<ku;Vl++)vt.push(ts[Vl])}}this.tree.remove(Qe)}return vt}},{key:"_splitSafely",value:function(We,Qe){this.tree.remove(We);var vt=We.rightSE;this.queue.remove(vt);var Lt=We.split(Qe);return Lt.push(vt),We.consumedBy===void 0&&this.tree.insert(We),Lt}}]),Ft}(),Mr=typeof I!="undefined"&&{NODE_ENV:"production",PUBLIC_PATH:"/cruise-car-map/"}.POLYGON_CLIPPING_MAX_QUEUE_SIZE||1e6,$n=typeof I!="undefined"&&{NODE_ENV:"production",PUBLIC_PATH:"/cruise-car-map/"}.POLYGON_CLIPPING_MAX_SWEEPLINE_SEGMENTS||1e6,li=function(){function Ft(){D(this,Ft)}return U(Ft,[{key:"run",value:function(We,Qe,vt){Kn.type=We,ge.reset();for(var Lt=[new Xr(Qe,!0)],Pt=0,Cr=vt.length;Pt<Cr;Pt++)Lt.push(new Xr(vt[Pt],!1));if(Kn.numMultiPolys=Lt.length,Kn.type==="difference")for(var yt=Lt[0],Ot=1;Ot<Lt.length;)Be(Lt[Ot].bbox,yt.bbox)!==null?Ot++:Lt.splice(Ot,1);if(Kn.type==="intersection"){for(var rr=0,Sr=Lt.length;rr<Sr;rr++)for(var Lr=Lt[rr],on=rr+1,hn=Lt.length;on<hn;on++)if(Be(Lr.bbox,Lt[on].bbox)===null)return[]}for(var zr=new be(le.compare),rn=0,Wn=Lt.length;rn<Wn;rn++)for(var jn=Lt[rn].getSweepEvents(),mi=0,Ea=jn.length;mi<Ea;mi++)if(zr.insert(jn[mi]),zr.size>Mr)throw new Error("Infinite loop when putting segment endpoints in a priority queue (queue size too big). Please file a bug report.");for(var ja=new tn(zr),Wr=zr.size,no=zr.pop();no;){var Xo=no.key;if(zr.size===Wr){var Xn=Xo.segment;throw new Error("Unable to pop() ".concat(Xo.isLeft?"left":"right"," SweepEvent ")+"[".concat(Xo.point.x,", ").concat(Xo.point.y,"] from segment #").concat(Xn.id," ")+"[".concat(Xn.leftSE.point.x,", ").concat(Xn.leftSE.point.y,"] -> ")+"[".concat(Xn.rightSE.point.x,", ").concat(Xn.rightSE.point.y,"] from queue. ")+"Please file a bug report.")}if(zr.size>Mr)throw new Error("Infinite loop when passing sweep line over endpoints (queue size too big). Please file a bug report.");if(ja.segments.length>$n)throw new Error("Infinite loop when passing sweep line over endpoints (too many sweep line segments). Please file a bug report.");for(var Hs=ja.process(Xo),Bo=0,iu=Hs.length;Bo<iu;Bo++){var ts=Hs[Bo];ts.consumedBy===void 0&&zr.insert(ts)}Wr=zr.size,no=zr.pop()}ge.reset();var Vl=fn.factory(ja.segments),ku=new Qr(Vl);return ku.getGeom()}}]),Ft}(),Kn=new li,$r=function(te){for(var We=arguments.length,Qe=new Array(We>1?We-1:0),vt=1;vt<We;vt++)Qe[vt-1]=arguments[vt];return Kn.run("union",te,Qe)},ln=function(te){for(var We=arguments.length,Qe=new Array(We>1?We-1:0),vt=1;vt<We;vt++)Qe[vt-1]=arguments[vt];return Kn.run("intersection",te,Qe)},Cn=function(te){for(var We=arguments.length,Qe=new Array(We>1?We-1:0),vt=1;vt<We;vt++)Qe[vt-1]=arguments[vt];return Kn.run("xor",te,Qe)},$i=function(te){for(var We=arguments.length,Qe=new Array(We>1?We-1:0),vt=1;vt<We;vt++)Qe[vt-1]=arguments[vt];return Kn.run("difference",te,Qe)},ci={union:$r,intersection:ln,xor:Cn,difference:$i};return ci})},13664:function(ae){(function(j,C){ae.exports=C()})(this,function(){"use strict";function j(G,U,B,Z,X){C(G,U,B||0,Z||G.length-1,X||D)}function C(G,U,B,Z,X){for(;Z>B;){if(Z-B>600){var q=Z-B+1,ie=U-B+1,he=Math.log(q),Ce=.5*Math.exp(2*he/3),be=.5*Math.sqrt(he*Ce*(q-Ce)/q)*(ie-q/2<0?-1:1),Ze=Math.max(B,Math.floor(U-ie*Ce/q+be)),qe=Math.min(Z,Math.floor(U+(q-ie)*Ce/q+be));C(G,U,Ze,qe,X)}var De=G[U],Ge=B,Re=Z;for(I(G,B,U),X(G[Z],De)>0&&I(G,B,Z);Ge<Re;){for(I(G,Ge,Re),Ge++,Re--;X(G[Ge],De)<0;)Ge++;for(;X(G[Re],De)>0;)Re--}X(G[B],De)===0?I(G,B,Re):(Re++,I(G,Re,Z)),Re<=U&&(B=Re+1),U<=Re&&(Z=Re-1)}}function I(G,U,B){var Z=G[U];G[U]=G[B],G[B]=Z}function D(G,U){return G<U?-1:G>U?1:0}return j})},85475:function(ae,j,C){"use strict";ae.exports=D,ae.exports.default=D;var I=C(13664);function D(Re,Me){if(!(this instanceof D))return new D(Re,Me);this._maxEntries=Math.max(4,Re||9),this._minEntries=Math.max(2,Math.ceil(this._maxEntries*.4)),Me&&this._initFormat(Me),this.clear()}D.prototype={all:function(){return this._all(this.data,[])},search:function(Re){var Me=this.data,ce=[],Be=this.toBBox;if(!qe(Re,Me))return ce;for(var Ee=[],Se,oe,Y,Ne;Me;){for(Se=0,oe=Me.children.length;Se<oe;Se++)Y=Me.children[Se],Ne=Me.leaf?Be(Y):Y,qe(Re,Ne)&&(Me.leaf?ce.push(Y):Ze(Re,Ne)?this._all(Y,ce):Ee.push(Y));Me=Ee.pop()}return ce},collides:function(Re){var Me=this.data,ce=this.toBBox;if(!qe(Re,Me))return!1;for(var Be=[],Ee,Se,oe,Y;Me;){for(Ee=0,Se=Me.children.length;Ee<Se;Ee++)if(oe=Me.children[Ee],Y=Me.leaf?ce(oe):oe,qe(Re,Y)){if(Me.leaf||Ze(Re,Y))return!0;Be.push(oe)}Me=Be.pop()}return!1},load:function(Re){if(!(Re&&Re.length))return this;if(Re.length<this._minEntries){for(var Me=0,ce=Re.length;Me<ce;Me++)this.insert(Re[Me]);return this}var Be=this._build(Re.slice(),0,Re.length-1,0);if(!this.data.children.length)this.data=Be;else if(this.data.height===Be.height)this._splitRoot(this.data,Be);else{if(this.data.height<Be.height){var Ee=this.data;this.data=Be,Be=Ee}this._insert(Be,this.data.height-Be.height-1,!0)}return this},insert:function(Re){return Re&&this._insert(Re,this.data.height-1),this},clear:function(){return this.data=De([]),this},remove:function(Re,Me){if(!Re)return this;for(var ce=this.data,Be=this.toBBox(Re),Ee=[],Se=[],oe,Y,Ne,ge;ce||Ee.length;){if(ce||(ce=Ee.pop(),Y=Ee[Ee.length-1],oe=Se.pop(),ge=!0),ce.leaf&&(Ne=G(Re,ce.children,Me),Ne!==-1))return ce.children.splice(Ne,1),Ee.push(ce),this._condense(Ee),this;!ge&&!ce.leaf&&Ze(ce,Be)?(Ee.push(ce),Se.push(oe),oe=0,Y=ce,ce=ce.children[0]):Y?(oe++,ce=Y.children[oe],ge=!1):ce=null}return this},toBBox:function(Re){return Re},compareMinX:X,compareMinY:q,toJSON:function(){return this.data},fromJSON:function(Re){return this.data=Re,this},_all:function(Re,Me){for(var ce=[];Re;)Re.leaf?Me.push.apply(Me,Re.children):ce.push.apply(ce,Re.children),Re=ce.pop();return Me},_build:function(Re,Me,ce,Be){var Ee=ce-Me+1,Se=this._maxEntries,oe;if(Ee<=Se)return oe=De(Re.slice(Me,ce+1)),U(oe,this.toBBox),oe;Be||(Be=Math.ceil(Math.log(Ee)/Math.log(Se)),Se=Math.ceil(Ee/Math.pow(Se,Be-1))),oe=De([]),oe.leaf=!1,oe.height=Be;var Y=Math.ceil(Ee/Se),Ne=Y*Math.ceil(Math.sqrt(Se)),ge,xe,ye,Q;for(Ge(Re,Me,ce,Ne,this.compareMinX),ge=Me;ge<=ce;ge+=Ne)for(ye=Math.min(ge+Ne-1,ce),Ge(Re,ge,ye,Y,this.compareMinY),xe=ge;xe<=ye;xe+=Y)Q=Math.min(xe+Y-1,ye),oe.children.push(this._build(Re,xe,Q,Be-1));return U(oe,this.toBBox),oe},_chooseSubtree:function(Re,Me,ce,Be){for(var Ee,Se,oe,Y,Ne,ge,xe,ye;Be.push(Me),!(Me.leaf||Be.length-1===ce);){for(xe=ye=1/0,Ee=0,Se=Me.children.length;Ee<Se;Ee++)oe=Me.children[Ee],Ne=ie(oe),ge=Ce(Re,oe)-Ne,ge<ye?(ye=ge,xe=Ne<xe?Ne:xe,Y=oe):ge===ye&&Ne<xe&&(xe=Ne,Y=oe);Me=Y||Me.children[0]}return Me},_insert:function(Re,Me,ce){var Be=this.toBBox,Ee=ce?Re:Be(Re),Se=[],oe=this._chooseSubtree(Ee,this.data,Me,Se);for(oe.children.push(Re),Z(oe,Ee);Me>=0&&Se[Me].children.length>this._maxEntries;)this._split(Se,Me),Me--;this._adjustParentBBoxes(Ee,Se,Me)},_split:function(Re,Me){var ce=Re[Me],Be=ce.children.length,Ee=this._minEntries;this._chooseSplitAxis(ce,Ee,Be);var Se=this._chooseSplitIndex(ce,Ee,Be),oe=De(ce.children.splice(Se,ce.children.length-Se));oe.height=ce.height,oe.leaf=ce.leaf,U(ce,this.toBBox),U(oe,this.toBBox),Me?Re[Me-1].children.push(oe):this._splitRoot(ce,oe)},_splitRoot:function(Re,Me){this.data=De([Re,Me]),this.data.height=Re.height+1,this.data.leaf=!1,U(this.data,this.toBBox)},_chooseSplitIndex:function(Re,Me,ce){var Be,Ee,Se,oe,Y,Ne,ge,xe;for(Ne=ge=1/0,Be=Me;Be<=ce-Me;Be++)Ee=B(Re,0,Be,this.toBBox),Se=B(Re,Be,ce,this.toBBox),oe=be(Ee,Se),Y=ie(Ee)+ie(Se),oe<Ne?(Ne=oe,xe=Be,ge=Y<ge?Y:ge):oe===Ne&&Y<ge&&(ge=Y,xe=Be);return xe},_chooseSplitAxis:function(Re,Me,ce){var Be=Re.leaf?this.compareMinX:X,Ee=Re.leaf?this.compareMinY:q,Se=this._allDistMargin(Re,Me,ce,Be),oe=this._allDistMargin(Re,Me,ce,Ee);Se<oe&&Re.children.sort(Be)},_allDistMargin:function(Re,Me,ce,Be){Re.children.sort(Be);var Ee=this.toBBox,Se=B(Re,0,Me,Ee),oe=B(Re,ce-Me,ce,Ee),Y=he(Se)+he(oe),Ne,ge;for(Ne=Me;Ne<ce-Me;Ne++)ge=Re.children[Ne],Z(Se,Re.leaf?Ee(ge):ge),Y+=he(Se);for(Ne=ce-Me-1;Ne>=Me;Ne--)ge=Re.children[Ne],Z(oe,Re.leaf?Ee(ge):ge),Y+=he(oe);return Y},_adjustParentBBoxes:function(Re,Me,ce){for(var Be=ce;Be>=0;Be--)Z(Me[Be],Re)},_condense:function(Re){for(var Me=Re.length-1,ce;Me>=0;Me--)Re[Me].children.length===0?Me>0?(ce=Re[Me-1].children,ce.splice(ce.indexOf(Re[Me]),1)):this.clear():U(Re[Me],this.toBBox)},_initFormat:function(Re){var Me=["return a"," - b",";"];this.compareMinX=new Function("a","b",Me.join(Re[0])),this.compareMinY=new Function("a","b",Me.join(Re[1])),this.toBBox=new Function("a","return {minX: a"+Re[0]+", minY: a"+Re[1]+", maxX: a"+Re[2]+", maxY: a"+Re[3]+"};")}};function G(Re,Me,ce){if(!ce)return Me.indexOf(Re);for(var Be=0;Be<Me.length;Be++)if(ce(Re,Me[Be]))return Be;return-1}function U(Re,Me){B(Re,0,Re.children.length,Me,Re)}function B(Re,Me,ce,Be,Ee){Ee||(Ee=De(null)),Ee.minX=1/0,Ee.minY=1/0,Ee.maxX=-1/0,Ee.maxY=-1/0;for(var Se=Me,oe;Se<ce;Se++)oe=Re.children[Se],Z(Ee,Re.leaf?Be(oe):oe);return Ee}function Z(Re,Me){return Re.minX=Math.min(Re.minX,Me.minX),Re.minY=Math.min(Re.minY,Me.minY),Re.maxX=Math.max(Re.maxX,Me.maxX),Re.maxY=Math.max(Re.maxY,Me.maxY),Re}function X(Re,Me){return Re.minX-Me.minX}function q(Re,Me){return Re.minY-Me.minY}function ie(Re){return(Re.maxX-Re.minX)*(Re.maxY-Re.minY)}function he(Re){return Re.maxX-Re.minX+(Re.maxY-Re.minY)}function Ce(Re,Me){return(Math.max(Me.maxX,Re.maxX)-Math.min(Me.minX,Re.minX))*(Math.max(Me.maxY,Re.maxY)-Math.min(Me.minY,Re.minY))}function be(Re,Me){var ce=Math.max(Re.minX,Me.minX),Be=Math.max(Re.minY,Me.minY),Ee=Math.min(Re.maxX,Me.maxX),Se=Math.min(Re.maxY,Me.maxY);return Math.max(0,Ee-ce)*Math.max(0,Se-Be)}function Ze(Re,Me){return Re.minX<=Me.minX&&Re.minY<=Me.minY&&Me.maxX<=Re.maxX&&Me.maxY<=Re.maxY}function qe(Re,Me){return Me.minX<=Re.maxX&&Me.minY<=Re.maxY&&Me.maxX>=Re.minX&&Me.maxY>=Re.minY}function De(Re){return{children:Re,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function Ge(Re,Me,ce,Be,Ee){for(var Se=[Me,ce],oe;Se.length;)ce=Se.pop(),Me=Se.pop(),!(ce-Me<=Be)&&(oe=Me+Math.ceil((ce-Me)/Be/2)*Be,I(Re,oe,Me,ce,Ee),Se.push(Me,oe,oe,ce))}},79535:function(ae){(function(j,C){ae.exports=C()})(this,function(){"use strict";function j(De,Ge,Re,Me,ce){(function Be(Ee,Se,oe,Y,Ne){for(;Y>oe;){if(Y-oe>600){var ge=Y-oe+1,xe=Se-oe+1,ye=Math.log(ge),Q=.5*Math.exp(2*ye/3),Pe=.5*Math.sqrt(ye*Q*(ge-Q)/ge)*(xe-ge/2<0?-1:1),Ae=Math.max(oe,Math.floor(Se-xe*Q/ge+Pe)),_e=Math.min(Y,Math.floor(Se+(ge-xe)*Q/ge+Pe));Be(Ee,Se,Ae,_e,Ne)}var ue=Ee[Se],ke=oe,ze=Y;for(C(Ee,oe,Se),Ne(Ee[Y],ue)>0&&C(Ee,oe,Y);ke<ze;){for(C(Ee,ke,ze),ke++,ze--;Ne(Ee[ke],ue)<0;)ke++;for(;Ne(Ee[ze],ue)>0;)ze--}Ne(Ee[oe],ue)===0?C(Ee,oe,ze):C(Ee,++ze,Y),ze<=Se&&(oe=ze+1),Se<=ze&&(Y=ze-1)}})(De,Ge,Re||0,Me||De.length-1,ce||I)}function C(De,Ge,Re){var Me=De[Ge];De[Ge]=De[Re],De[Re]=Me}function I(De,Ge){return De<Ge?-1:De>Ge?1:0}var D=function(De){De===void 0&&(De=9),this._maxEntries=Math.max(4,De),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),this.clear()};function G(De,Ge,Re){if(!Re)return Ge.indexOf(De);for(var Me=0;Me<Ge.length;Me++)if(Re(De,Ge[Me]))return Me;return-1}function U(De,Ge){B(De,0,De.children.length,Ge,De)}function B(De,Ge,Re,Me,ce){ce||(ce=Ze(null)),ce.minX=1/0,ce.minY=1/0,ce.maxX=-1/0,ce.maxY=-1/0;for(var Be=Ge;Be<Re;Be++){var Ee=De.children[Be];Z(ce,De.leaf?Me(Ee):Ee)}return ce}function Z(De,Ge){return De.minX=Math.min(De.minX,Ge.minX),De.minY=Math.min(De.minY,Ge.minY),De.maxX=Math.max(De.maxX,Ge.maxX),De.maxY=Math.max(De.maxY,Ge.maxY),De}function X(De,Ge){return De.minX-Ge.minX}function q(De,Ge){return De.minY-Ge.minY}function ie(De){return(De.maxX-De.minX)*(De.maxY-De.minY)}function he(De){return De.maxX-De.minX+(De.maxY-De.minY)}function Ce(De,Ge){return De.minX<=Ge.minX&&De.minY<=Ge.minY&&Ge.maxX<=De.maxX&&Ge.maxY<=De.maxY}function be(De,Ge){return Ge.minX<=De.maxX&&Ge.minY<=De.maxY&&Ge.maxX>=De.minX&&Ge.maxY>=De.minY}function Ze(De){return{children:De,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function qe(De,Ge,Re,Me,ce){for(var Be=[Ge,Re];Be.length;)if(!((Re=Be.pop())-(Ge=Be.pop())<=Me)){var Ee=Ge+Math.ceil((Re-Ge)/Me/2)*Me;j(De,Ee,Ge,Re,ce),Be.push(Ge,Ee,Ee,Re)}}return D.prototype.all=function(){return this._all(this.data,[])},D.prototype.search=function(De){var Ge=this.data,Re=[];if(!be(De,Ge))return Re;for(var Me=this.toBBox,ce=[];Ge;){for(var Be=0;Be<Ge.children.length;Be++){var Ee=Ge.children[Be],Se=Ge.leaf?Me(Ee):Ee;be(De,Se)&&(Ge.leaf?Re.push(Ee):Ce(De,Se)?this._all(Ee,Re):ce.push(Ee))}Ge=ce.pop()}return Re},D.prototype.collides=function(De){var Ge=this.data;if(!be(De,Ge))return!1;for(var Re=[];Ge;){for(var Me=0;Me<Ge.children.length;Me++){var ce=Ge.children[Me],Be=Ge.leaf?this.toBBox(ce):ce;if(be(De,Be)){if(Ge.leaf||Ce(De,Be))return!0;Re.push(ce)}}Ge=Re.pop()}return!1},D.prototype.load=function(De){if(!De||!De.length)return this;if(De.length<this._minEntries){for(var Ge=0;Ge<De.length;Ge++)this.insert(De[Ge]);return this}var Re=this._build(De.slice(),0,De.length-1,0);if(this.data.children.length)if(this.data.height===Re.height)this._splitRoot(this.data,Re);else{if(this.data.height<Re.height){var Me=this.data;this.data=Re,Re=Me}this._insert(Re,this.data.height-Re.height-1,!0)}else this.data=Re;return this},D.prototype.insert=function(De){return De&&this._insert(De,this.data.height-1),this},D.prototype.clear=function(){return this.data=Ze([]),this},D.prototype.remove=function(De,Ge){if(!De)return this;for(var Re,Me,ce,Be=this.data,Ee=this.toBBox(De),Se=[],oe=[];Be||Se.length;){if(Be||(Be=Se.pop(),Me=Se[Se.length-1],Re=oe.pop(),ce=!0),Be.leaf){var Y=G(De,Be.children,Ge);if(Y!==-1)return Be.children.splice(Y,1),Se.push(Be),this._condense(Se),this}ce||Be.leaf||!Ce(Be,Ee)?Me?(Re++,Be=Me.children[Re],ce=!1):Be=null:(Se.push(Be),oe.push(Re),Re=0,Me=Be,Be=Be.children[0])}return this},D.prototype.toBBox=function(De){return De},D.prototype.compareMinX=function(De,Ge){return De.minX-Ge.minX},D.prototype.compareMinY=function(De,Ge){return De.minY-Ge.minY},D.prototype.toJSON=function(){return this.data},D.prototype.fromJSON=function(De){return this.data=De,this},D.prototype._all=function(De,Ge){for(var Re=[];De;)De.leaf?Ge.push.apply(Ge,De.children):Re.push.apply(Re,De.children),De=Re.pop();return Ge},D.prototype._build=function(De,Ge,Re,Me){var ce,Be=Re-Ge+1,Ee=this._maxEntries;if(Be<=Ee)return U(ce=Ze(De.slice(Ge,Re+1)),this.toBBox),ce;Me||(Me=Math.ceil(Math.log(Be)/Math.log(Ee)),Ee=Math.ceil(Be/Math.pow(Ee,Me-1))),(ce=Ze([])).leaf=!1,ce.height=Me;var Se=Math.ceil(Be/Ee),oe=Se*Math.ceil(Math.sqrt(Ee));qe(De,Ge,Re,oe,this.compareMinX);for(var Y=Ge;Y<=Re;Y+=oe){var Ne=Math.min(Y+oe-1,Re);qe(De,Y,Ne,Se,this.compareMinY);for(var ge=Y;ge<=Ne;ge+=Se){var xe=Math.min(ge+Se-1,Ne);ce.children.push(this._build(De,ge,xe,Me-1))}}return U(ce,this.toBBox),ce},D.prototype._chooseSubtree=function(De,Ge,Re,Me){for(;Me.push(Ge),!Ge.leaf&&Me.length-1!==Re;){for(var ce=1/0,Be=1/0,Ee=void 0,Se=0;Se<Ge.children.length;Se++){var oe=Ge.children[Se],Y=ie(oe),Ne=(ge=De,xe=oe,(Math.max(xe.maxX,ge.maxX)-Math.min(xe.minX,ge.minX))*(Math.max(xe.maxY,ge.maxY)-Math.min(xe.minY,ge.minY))-Y);Ne<Be?(Be=Ne,ce=Y<ce?Y:ce,Ee=oe):Ne===Be&&Y<ce&&(ce=Y,Ee=oe)}Ge=Ee||Ge.children[0]}var ge,xe;return Ge},D.prototype._insert=function(De,Ge,Re){var Me=Re?De:this.toBBox(De),ce=[],Be=this._chooseSubtree(Me,this.data,Ge,ce);for(Be.children.push(De),Z(Be,Me);Ge>=0&&ce[Ge].children.length>this._maxEntries;)this._split(ce,Ge),Ge--;this._adjustParentBBoxes(Me,ce,Ge)},D.prototype._split=function(De,Ge){var Re=De[Ge],Me=Re.children.length,ce=this._minEntries;this._chooseSplitAxis(Re,ce,Me);var Be=this._chooseSplitIndex(Re,ce,Me),Ee=Ze(Re.children.splice(Be,Re.children.length-Be));Ee.height=Re.height,Ee.leaf=Re.leaf,U(Re,this.toBBox),U(Ee,this.toBBox),Ge?De[Ge-1].children.push(Ee):this._splitRoot(Re,Ee)},D.prototype._splitRoot=function(De,Ge){this.data=Ze([De,Ge]),this.data.height=De.height+1,this.data.leaf=!1,U(this.data,this.toBBox)},D.prototype._chooseSplitIndex=function(De,Ge,Re){for(var Me,ce,Be,Ee,Se,oe,Y,Ne=1/0,ge=1/0,xe=Ge;xe<=Re-Ge;xe++){var ye=B(De,0,xe,this.toBBox),Q=B(De,xe,Re,this.toBBox),Pe=(ce=ye,Be=Q,Ee=void 0,Se=void 0,oe=void 0,Y=void 0,Ee=Math.max(ce.minX,Be.minX),Se=Math.max(ce.minY,Be.minY),oe=Math.min(ce.maxX,Be.maxX),Y=Math.min(ce.maxY,Be.maxY),Math.max(0,oe-Ee)*Math.max(0,Y-Se)),Ae=ie(ye)+ie(Q);Pe<Ne?(Ne=Pe,Me=xe,ge=Ae<ge?Ae:ge):Pe===Ne&&Ae<ge&&(ge=Ae,Me=xe)}return Me||Re-Ge},D.prototype._chooseSplitAxis=function(De,Ge,Re){var Me=De.leaf?this.compareMinX:X,ce=De.leaf?this.compareMinY:q;this._allDistMargin(De,Ge,Re,Me)<this._allDistMargin(De,Ge,Re,ce)&&De.children.sort(Me)},D.prototype._allDistMargin=function(De,Ge,Re,Me){De.children.sort(Me);for(var ce=this.toBBox,Be=B(De,0,Ge,ce),Ee=B(De,Re-Ge,Re,ce),Se=he(Be)+he(Ee),oe=Ge;oe<Re-Ge;oe++){var Y=De.children[oe];Z(Be,De.leaf?ce(Y):Y),Se+=he(Be)}for(var Ne=Re-Ge-1;Ne>=Ge;Ne--){var ge=De.children[Ne];Z(Ee,De.leaf?ce(ge):ge),Se+=he(Ee)}return Se},D.prototype._adjustParentBBoxes=function(De,Ge,Re){for(var Me=Re;Me>=0;Me--)Z(Ge[Me],De)},D.prototype._condense=function(De){for(var Ge=De.length-1,Re=void 0;Ge>=0;Ge--)De[Ge].children.length===0?Ge>0?(Re=De[Ge-1].children).splice(Re.indexOf(De[Ge]),1):this.clear():U(De[Ge],this.toBBox)},D})},78892:function(ae,j,C){var I=C(97671);var D;(function(G){(function(U){var B=typeof C.g=="object"?C.g:typeof self=="object"?self:typeof this=="object"?this:Function("return this;")(),Z=X(G);typeof B.Reflect=="undefined"?B.Reflect=G:Z=X(B.Reflect,Z),U(Z);function X(q,ie){return function(he,Ce){typeof q[he]!="function"&&Object.defineProperty(q,he,{configurable:!0,writable:!0,value:Ce}),ie&&ie(he,Ce)}}})(function(U){var B=Object.prototype.hasOwnProperty,Z=typeof Symbol=="function",X=Z&&typeof Symbol.toPrimitive!="undefined"?Symbol.toPrimitive:"@@toPrimitive",q=Z&&typeof Symbol.iterator!="undefined"?Symbol.iterator:"@@iterator",ie=typeof Object.create=="function",he={__proto__:[]}instanceof Array,Ce=!ie&&!he,be={create:ie?function(){return Cr(Object.create(null))}:he?function(){return Cr({__proto__:null})}:function(){return Cr({})},has:Ce?function(yt,Ot){return B.call(yt,Ot)}:function(yt,Ot){return Ot in yt},get:Ce?function(yt,Ot){return B.call(yt,Ot)?yt[Ot]:void 0}:function(yt,Ot){return yt[Ot]}},Ze=Object.getPrototypeOf(Function),qe=typeof I=="object"&&{NODE_ENV:"production",PUBLIC_PATH:"/cruise-car-map/"}&&{NODE_ENV:"production",PUBLIC_PATH:"/cruise-car-map/"}.REFLECT_METADATA_USE_MAP_POLYFILL==="true",De=!qe&&typeof Map=="function"&&typeof Map.prototype.entries=="function"?Map:vt(),Ge=!qe&&typeof Set=="function"&&typeof Set.prototype.entries=="function"?Set:Lt(),Re=!qe&&typeof WeakMap=="function"?WeakMap:Pt(),Me=new Re;function ce(yt,Ot,rr,Sr){if(Wt(rr)){if(!Kn(yt))throw new TypeError;if(!ln(Ot))throw new TypeError;return Q(yt,Ot)}else{if(!Kn(yt))throw new TypeError;if(!Ir(Ot))throw new TypeError;if(!Ir(Sr)&&!Wt(Sr)&&!Xr(Sr))throw new TypeError;return Xr(Sr)&&(Sr=void 0),rr=li(rr),Pe(yt,Ot,rr,Sr)}}U("decorate",ce);function Be(yt,Ot){function rr(Sr,Lr){if(!Ir(Sr))throw new TypeError;if(!Wt(Lr)&&!Cn(Lr))throw new TypeError;le(yt,Ot,Sr,Lr)}return rr}U("metadata",Be);function Ee(yt,Ot,rr,Sr){if(!Ir(rr))throw new TypeError;return Wt(Sr)||(Sr=li(Sr)),le(yt,Ot,rr,Sr)}U("defineMetadata",Ee);function Se(yt,Ot,rr){if(!Ir(Ot))throw new TypeError;return Wt(rr)||(rr=li(rr)),_e(yt,Ot,rr)}U("hasMetadata",Se);function oe(yt,Ot,rr){if(!Ir(Ot))throw new TypeError;return Wt(rr)||(rr=li(rr)),ue(yt,Ot,rr)}U("hasOwnMetadata",oe);function Y(yt,Ot,rr){if(!Ir(Ot))throw new TypeError;return Wt(rr)||(rr=li(rr)),ke(yt,Ot,rr)}U("getMetadata",Y);function Ne(yt,Ot,rr){if(!Ir(Ot))throw new TypeError;return Wt(rr)||(rr=li(rr)),ze(yt,Ot,rr)}U("getOwnMetadata",Ne);function ge(yt,Ot){if(!Ir(yt))throw new TypeError;return Wt(Ot)||(Ot=li(Ot)),Ut(yt,Ot)}U("getMetadataKeys",ge);function xe(yt,Ot){if(!Ir(yt))throw new TypeError;return Wt(Ot)||(Ot=li(Ot)),kt(yt,Ot)}U("getOwnMetadataKeys",xe);function ye(yt,Ot,rr){if(!Ir(Ot))throw new TypeError;Wt(rr)||(rr=li(rr));var Sr=Ae(Ot,rr,!1);if(Wt(Sr)||!Sr.delete(yt))return!1;if(Sr.size>0)return!0;var Lr=Me.get(Ot);return Lr.delete(rr),Lr.size>0||Me.delete(Ot),!0}U("deleteMetadata",ye);function Q(yt,Ot){for(var rr=yt.length-1;rr>=0;--rr){var Sr=yt[rr],Lr=Sr(Ot);if(!Wt(Lr)&&!Xr(Lr)){if(!ln(Lr))throw new TypeError;Ot=Lr}}return Ot}function Pe(yt,Ot,rr,Sr){for(var Lr=yt.length-1;Lr>=0;--Lr){var on=yt[Lr],hn=on(Ot,rr,Sr);if(!Wt(hn)&&!Xr(hn)){if(!Ir(hn))throw new TypeError;Sr=hn}}return Sr}function Ae(yt,Ot,rr){var Sr=Me.get(yt);if(Wt(Sr)){if(!rr)return;Sr=new De,Me.set(yt,Sr)}var Lr=Sr.get(Ot);if(Wt(Lr)){if(!rr)return;Lr=new De,Sr.set(Ot,Lr)}return Lr}function _e(yt,Ot,rr){var Sr=ue(yt,Ot,rr);if(Sr)return!0;var Lr=Qe(Ot);return Xr(Lr)?!1:_e(yt,Lr,rr)}function ue(yt,Ot,rr){var Sr=Ae(Ot,rr,!1);return Wt(Sr)?!1:Mr(Sr.has(yt))}function ke(yt,Ot,rr){var Sr=ue(yt,Ot,rr);if(Sr)return ze(yt,Ot,rr);var Lr=Qe(Ot);if(!Xr(Lr))return ke(yt,Lr,rr)}function ze(yt,Ot,rr){var Sr=Ae(Ot,rr,!1);if(!Wt(Sr))return Sr.get(yt)}function le(yt,Ot,rr,Sr){var Lr=Ae(rr,Sr,!0);Lr.set(yt,Ot)}function Ut(yt,Ot){var rr=kt(yt,Ot),Sr=Qe(yt);if(Sr===null)return rr;var Lr=Ut(Sr,Ot);if(Lr.length<=0)return rr;if(rr.length<=0)return Lr;for(var on=new Ge,hn=[],zr=0,rn=rr;zr<rn.length;zr++){var Wn=rn[zr],jn=on.has(Wn);jn||(on.add(Wn),hn.push(Wn))}for(var mi=0,Ea=Lr;mi<Ea.length;mi++){var Wn=Ea[mi],jn=on.has(Wn);jn||(on.add(Wn),hn.push(Wn))}return hn}function kt(yt,Ot){var rr=[],Sr=Ae(yt,Ot,!1);if(Wt(Sr))return rr;for(var Lr=Sr.keys(),on=ci(Lr),hn=0;;){var zr=te(on);if(!zr)return rr.length=hn,rr;var rn=Ft(zr);try{rr[hn]=rn}catch(Wn){try{We(on)}finally{throw Wn}}hn++}}function pr(yt){if(yt===null)return 1;switch(typeof yt){case"undefined":return 0;case"boolean":return 2;case"string":return 3;case"symbol":return 4;case"number":return 5;case"object":return yt===null?1:6;default:return 6}}function Wt(yt){return yt===void 0}function Xr(yt){return yt===null}function fn(yt){return typeof yt=="symbol"}function Ir(yt){return typeof yt=="object"?yt!==null:typeof yt=="function"}function Qr(yt,Ot){switch(pr(yt)){case 0:return yt;case 1:return yt;case 2:return yt;case 3:return yt;case 4:return yt;case 5:return yt}var rr=Ot===3?"string":Ot===5?"number":"default",Sr=$i(yt,X);if(Sr!==void 0){var Lr=Sr.call(yt,rr);if(Ir(Lr))throw new TypeError;return Lr}return tn(yt,rr==="default"?"number":rr)}function tn(yt,Ot){if(Ot==="string"){var rr=yt.toString;if($r(rr)){var Sr=rr.call(yt);if(!Ir(Sr))return Sr}var Lr=yt.valueOf;if($r(Lr)){var Sr=Lr.call(yt);if(!Ir(Sr))return Sr}}else{var Lr=yt.valueOf;if($r(Lr)){var Sr=Lr.call(yt);if(!Ir(Sr))return Sr}var on=yt.toString;if($r(on)){var Sr=on.call(yt);if(!Ir(Sr))return Sr}}throw new TypeError}function Mr(yt){return!!yt}function $n(yt){return""+yt}function li(yt){var Ot=Qr(yt,3);return fn(Ot)?Ot:$n(Ot)}function Kn(yt){return Array.isArray?Array.isArray(yt):yt instanceof Object?yt instanceof Array:Object.prototype.toString.call(yt)==="[object Array]"}function $r(yt){return typeof yt=="function"}function ln(yt){return typeof yt=="function"}function Cn(yt){switch(pr(yt)){case 3:return!0;case 4:return!0;default:return!1}}function $i(yt,Ot){var rr=yt[Ot];if(rr!=null){if(!$r(rr))throw new TypeError;return rr}}function ci(yt){var Ot=$i(yt,q);if(!$r(Ot))throw new TypeError;var rr=Ot.call(yt);if(!Ir(rr))throw new TypeError;return rr}function Ft(yt){return yt.value}function te(yt){var Ot=yt.next();return Ot.done?!1:Ot}function We(yt){var Ot=yt.return;Ot&&Ot.call(yt)}function Qe(yt){var Ot=Object.getPrototypeOf(yt);if(typeof yt!="function"||yt===Ze||Ot!==Ze)return Ot;var rr=yt.prototype,Sr=rr&&Object.getPrototypeOf(rr);if(Sr==null||Sr===Object.prototype)return Ot;var Lr=Sr.constructor;return typeof Lr!="function"||Lr===yt?Ot:Lr}function vt(){var yt={},Ot=[],rr=function(){function hn(zr,rn,Wn){this._index=0,this._keys=zr,this._values=rn,this._selector=Wn}return hn.prototype["@@iterator"]=function(){return this},hn.prototype[q]=function(){return this},hn.prototype.next=function(){var zr=this._index;if(zr>=0&&zr<this._keys.length){var rn=this._selector(this._keys[zr],this._values[zr]);return zr+1>=this._keys.length?(this._index=-1,this._keys=Ot,this._values=Ot):this._index++,{value:rn,done:!1}}return{value:void 0,done:!0}},hn.prototype.throw=function(zr){throw this._index>=0&&(this._index=-1,this._keys=Ot,this._values=Ot),zr},hn.prototype.return=function(zr){return this._index>=0&&(this._index=-1,this._keys=Ot,this._values=Ot),{value:zr,done:!0}},hn}();return function(){function hn(){this._keys=[],this._values=[],this._cacheKey=yt,this._cacheIndex=-2}return Object.defineProperty(hn.prototype,"size",{get:function(){return this._keys.length},enumerable:!0,configurable:!0}),hn.prototype.has=function(zr){return this._find(zr,!1)>=0},hn.prototype.get=function(zr){var rn=this._find(zr,!1);return rn>=0?this._values[rn]:void 0},hn.prototype.set=function(zr,rn){var Wn=this._find(zr,!0);return this._values[Wn]=rn,this},hn.prototype.delete=function(zr){var rn=this._find(zr,!1);if(rn>=0){for(var Wn=this._keys.length,jn=rn+1;jn<Wn;jn++)this._keys[jn-1]=this._keys[jn],this._values[jn-1]=this._values[jn];return this._keys.length--,this._values.length--,zr===this._cacheKey&&(this._cacheKey=yt,this._cacheIndex=-2),!0}return!1},hn.prototype.clear=function(){this._keys.length=0,this._values.length=0,this._cacheKey=yt,this._cacheIndex=-2},hn.prototype.keys=function(){return new rr(this._keys,this._values,Sr)},hn.prototype.values=function(){return new rr(this._keys,this._values,Lr)},hn.prototype.entries=function(){return new rr(this._keys,this._values,on)},hn.prototype["@@iterator"]=function(){return this.entries()},hn.prototype[q]=function(){return this.entries()},hn.prototype._find=function(zr,rn){return this._cacheKey!==zr&&(this._cacheIndex=this._keys.indexOf(this._cacheKey=zr)),this._cacheIndex<0&&rn&&(this._cacheIndex=this._keys.length,this._keys.push(zr),this._values.push(void 0)),this._cacheIndex},hn}();function Sr(hn,zr){return hn}function Lr(hn,zr){return zr}function on(hn,zr){return[hn,zr]}}function Lt(){return function(){function yt(){this._map=new De}return Object.defineProperty(yt.prototype,"size",{get:function(){return this._map.size},enumerable:!0,configurable:!0}),yt.prototype.has=function(Ot){return this._map.has(Ot)},yt.prototype.add=function(Ot){return this._map.set(Ot,Ot),this},yt.prototype.delete=function(Ot){return this._map.delete(Ot)},yt.prototype.clear=function(){this._map.clear()},yt.prototype.keys=function(){return this._map.keys()},yt.prototype.values=function(){return this._map.values()},yt.prototype.entries=function(){return this._map.entries()},yt.prototype["@@iterator"]=function(){return this.keys()},yt.prototype[q]=function(){return this.keys()},yt}()}function Pt(){var yt=16,Ot=be.create(),rr=Sr();return function(){function rn(){this._key=Sr()}return rn.prototype.has=function(Wn){var jn=Lr(Wn,!1);return jn!==void 0?be.has(jn,this._key):!1},rn.prototype.get=function(Wn){var jn=Lr(Wn,!1);return jn!==void 0?be.get(jn,this._key):void 0},rn.prototype.set=function(Wn,jn){var mi=Lr(Wn,!0);return mi[this._key]=jn,this},rn.prototype.delete=function(Wn){var jn=Lr(Wn,!1);return jn!==void 0?delete jn[this._key]:!1},rn.prototype.clear=function(){this._key=Sr()},rn}();function Sr(){var rn;do rn="@@WeakMap@@"+zr();while(be.has(Ot,rn));return Ot[rn]=!0,rn}function Lr(rn,Wn){if(!B.call(rn,rr)){if(!Wn)return;Object.defineProperty(rn,rr,{value:be.create()})}return rn[rr]}function on(rn,Wn){for(var jn=0;jn<Wn;++jn)rn[jn]=Math.random()*255|0;return rn}function hn(rn){return typeof Uint8Array=="function"?typeof crypto!="undefined"?crypto.getRandomValues(new Uint8Array(rn)):typeof msCrypto!="undefined"?msCrypto.getRandomValues(new Uint8Array(rn)):on(new Uint8Array(rn),rn):on(new Array(rn),rn)}function zr(){var rn=hn(yt);rn[6]=rn[6]&79|64,rn[8]=rn[8]&191|128;for(var Wn="",jn=0;jn<yt;++jn){var mi=rn[jn];(jn===4||jn===6||jn===8)&&(Wn+="-"),mi<16&&(Wn+="0"),Wn+=mi.toString(16).toLowerCase()}return Wn}}function Cr(yt){return yt.__=void 0,delete yt.__,yt}})})(D||(D={}))},53273:function(ae,j,C){"use strict";var I=C(76160),D=Object,G=TypeError;ae.exports=I(function(){if(this!=null&&this!==D(this))throw new G("RegExp.prototype.flags getter called on non-object");var B="";return this.hasIndices&&(B+="d"),this.global&&(B+="g"),this.ignoreCase&&(B+="i"),this.multiline&&(B+="m"),this.dotAll&&(B+="s"),this.unicode&&(B+="u"),this.unicodeSets&&(B+="v"),this.sticky&&(B+="y"),B},"get flags",!0)},61245:function(ae,j,C){"use strict";var I=C(8263),D=C(71262),G=C(53273),U=C(60096),B=C(79621),Z=D(U());I(Z,{getPolyfill:U,implementation:G,shim:B}),ae.exports=Z},60096:function(ae,j,C){"use strict";var I=C(53273),D=C(8263).supportsDescriptors,G=Object.getOwnPropertyDescriptor;ae.exports=function(){if(D&&/a/mig.flags==="gim"){var B=G(RegExp.prototype,"flags");if(B&&typeof B.get=="function"&&typeof RegExp.prototype.dotAll=="boolean"&&typeof RegExp.prototype.hasIndices=="boolean"){var Z="",X={};if(Object.defineProperty(X,"hasIndices",{get:function(){Z+="d"}}),Object.defineProperty(X,"sticky",{get:function(){Z+="y"}}),Z==="dy")return B.get}}return I}},79621:function(ae,j,C){"use strict";var I=C(8263).supportsDescriptors,D=C(60096),G=Object.getOwnPropertyDescriptor,U=Object.defineProperty,B=TypeError,Z=Object.getPrototypeOf,X=/a/;ae.exports=function(){if(!I||!Z)throw new B("RegExp.prototype.flags requires a true ES5 environment that supports property descriptors");var ie=D(),he=Z(X),Ce=G(he,"flags");return(!Ce||Ce.get!==ie)&&U(he,"flags",{configurable:!0,enumerable:!1,get:ie}),ie}},45409:function(ae){(function(j,C){ae.exports=C()})(this,function(){"use strict";var j=function(Te){return Te instanceof Uint8Array||Te instanceof Uint16Array||Te instanceof Uint32Array||Te instanceof Int8Array||Te instanceof Int16Array||Te instanceof Int32Array||Te instanceof Float32Array||Te instanceof Float64Array||Te instanceof Uint8ClampedArray},C=function(Te,Je){for(var Et=Object.keys(Je),sr=0;sr<Et.length;++sr)Te[Et[sr]]=Je[Et[sr]];return Te},I=`
`;function D(Te){return typeof atob!="undefined"?atob(Te):"base64:"+Te}function G(Te){var Je=new Error("(regl) "+Te);throw console.error(Je),Je}function U(Te,Je){Te||G(Je)}function B(Te){return Te?": "+Te:""}function Z(Te,Je,Et){Te in Je||G("unknown parameter ("+Te+")"+B(Et)+". possible values: "+Object.keys(Je).join())}function X(Te,Je){j(Te)||G("invalid parameter type"+B(Je)+". must be a typed array")}function q(Te,Je){switch(Je){case"number":return typeof Te=="number";case"object":return typeof Te=="object";case"string":return typeof Te=="string";case"boolean":return typeof Te=="boolean";case"function":return typeof Te=="function";case"undefined":return typeof Te=="undefined";case"symbol":return typeof Te=="symbol"}}function ie(Te,Je,Et){q(Te,Je)||G("invalid parameter type"+B(Et)+". expected "+Je+", got "+typeof Te)}function he(Te,Je){Te>=0&&(Te|0)===Te||G("invalid parameter type, ("+Te+")"+B(Je)+". must be a nonnegative integer")}function Ce(Te,Je,Et){Je.indexOf(Te)<0&&G("invalid value"+B(Et)+". must be one of: "+Je)}var be=["gl","canvas","container","attributes","pixelRatio","extensions","optionalExtensions","profile","onDone"];function Ze(Te){Object.keys(Te).forEach(function(Je){be.indexOf(Je)<0&&G('invalid regl constructor argument "'+Je+'". must be one of '+be)})}function qe(Te,Je){for(Te=Te+"";Te.length<Je;)Te=" "+Te;return Te}function De(){this.name="unknown",this.lines=[],this.index={},this.hasErrors=!1}function Ge(Te,Je){this.number=Te,this.line=Je,this.errors=[]}function Re(Te,Je,Et){this.file=Te,this.line=Je,this.message=Et}function Me(){var Te=new Error,Je=(Te.stack||Te).toString(),Et=/compileProcedure.*\n\s*at.*\((.*)\)/.exec(Je);if(Et)return Et[1];var sr=/compileProcedure.*\n\s*at\s+(.*)(\n|$)/.exec(Je);return sr?sr[1]:"unknown"}function ce(){var Te=new Error,Je=(Te.stack||Te).toString(),Et=/at REGLCommand.*\n\s+at.*\((.*)\)/.exec(Je);if(Et)return Et[1];var sr=/at REGLCommand.*\n\s+at\s+(.*)\n/.exec(Je);return sr?sr[1]:"unknown"}function Be(Te,Je){var Et=Te.split(`
`),sr=1,Er=0,lr={unknown:new De,0:new De};lr.unknown.name=lr[0].name=Je||Me(),lr.unknown.lines.push(new Ge(0,""));for(var gr=0;gr<Et.length;++gr){var kr=Et[gr],Pr=/^\s*#\s*(\w+)\s+(.+)\s*$/.exec(kr);if(Pr)switch(Pr[1]){case"line":var qr=/(\d+)(\s+\d+)?/.exec(Pr[2]);qr&&(sr=qr[1]|0,qr[2]&&(Er=qr[2]|0,Er in lr||(lr[Er]=new De)));break;case"define":var Br=/SHADER_NAME(_B64)?\s+(.*)$/.exec(Pr[2]);Br&&(lr[Er].name=Br[1]?D(Br[2]):Br[2]);break}lr[Er].lines.push(new Ge(sr++,kr))}return Object.keys(lr).forEach(function(Vr){var Kr=lr[Vr];Kr.lines.forEach(function(Dr){Kr.index[Dr.number]=Dr})}),lr}function Ee(Te){var Je=[];return Te.split(`
`).forEach(function(Et){if(!(Et.length<5)){var sr=/^ERROR:\s+(\d+):(\d+):\s*(.*)$/.exec(Et);sr?Je.push(new Re(sr[1]|0,sr[2]|0,sr[3].trim())):Et.length>0&&Je.push(new Re("unknown",0,Et))}}),Je}function Se(Te,Je){Je.forEach(function(Et){var sr=Te[Et.file];if(sr){var Er=sr.index[Et.line];if(Er){Er.errors.push(Et),sr.hasErrors=!0;return}}Te.unknown.hasErrors=!0,Te.unknown.lines[0].errors.push(Et)})}function oe(Te,Je,Et,sr,Er){if(!Te.getShaderParameter(Je,Te.COMPILE_STATUS)){var lr=Te.getShaderInfoLog(Je),gr=sr===Te.FRAGMENT_SHADER?"fragment":"vertex";Pe(Et,"string",gr+" shader source must be a string",Er);var kr=Be(Et,Er),Pr=Ee(lr);Se(kr,Pr),Object.keys(kr).forEach(function(qr){var Br=kr[qr];if(!Br.hasErrors)return;var Vr=[""],Kr=[""];function Dr(jr,jt){Vr.push(jr),Kr.push(jt||"")}Dr("file number "+qr+": "+Br.name+`
`,"color:red;text-decoration:underline;font-weight:bold"),Br.lines.forEach(function(jr){if(jr.errors.length>0){Dr(qe(jr.number,4)+"|  ","background-color:yellow; font-weight:bold"),Dr(jr.line+I,"color:red; background-color:yellow; font-weight:bold");var jt=0;jr.errors.forEach(function(Ar){var Ur=Ar.message,Jr=/^\s*'(.*)'\s*:\s*(.*)$/.exec(Ur);if(Jr){var Rr=Jr[1];switch(Ur=Jr[2],Rr){case"assign":Rr="=";break}jt=Math.max(jr.line.indexOf(Rr,jt),0)}else jt=0;Dr(qe("| ",6)),Dr(qe("^^^",jt+3)+I,"font-weight:bold"),Dr(qe("| ",6)),Dr(Ur+I,"font-weight:bold")}),Dr(qe("| ",6)+I)}else Dr(qe(jr.number,4)+"|  "),Dr(jr.line+I,"color:red")}),typeof document!="undefined"&&!window.chrome?(Kr[0]=Vr.join("%c"),console.log.apply(console,Kr)):console.log(Vr.join(""))}),U.raise("Error compiling "+gr+" shader, "+kr[0].name)}}function Y(Te,Je,Et,sr,Er){if(!Te.getProgramParameter(Je,Te.LINK_STATUS)){var lr=Te.getProgramInfoLog(Je),gr=Be(Et,Er),kr=Be(sr,Er),Pr='Error linking program with vertex shader, "'+kr[0].name+'", and fragment shader "'+gr[0].name+'"';typeof document!="undefined"?console.log("%c"+Pr+I+"%c"+lr,"color:red;text-decoration:underline;font-weight:bold","color:red"):console.log(Pr+I+lr),U.raise(Pr)}}function Ne(Te){Te._commandRef=Me()}function ge(Te,Je,Et,sr){Ne(Te);function Er(Pr){return Pr?sr.id(Pr):0}Te._fragId=Er(Te.static.frag),Te._vertId=Er(Te.static.vert);function lr(Pr,qr){Object.keys(qr).forEach(function(Br){Pr[sr.id(Br)]=!0})}var gr=Te._uniformSet={};lr(gr,Je.static),lr(gr,Je.dynamic);var kr=Te._attributeSet={};lr(kr,Et.static),lr(kr,Et.dynamic),Te._hasCount="count"in Te.static||"count"in Te.dynamic||"elements"in Te.static||"elements"in Te.dynamic}function xe(Te,Je){var Et=ce();G(Te+" in command "+(Je||Me())+(Et==="unknown"?"":" called from "+Et))}function ye(Te,Je,Et){Te||xe(Je,Et||Me())}function Q(Te,Je,Et,sr){Te in Je||xe("unknown parameter ("+Te+")"+B(Et)+". possible values: "+Object.keys(Je).join(),sr||Me())}function Pe(Te,Je,Et,sr){q(Te,Je)||xe("invalid parameter type"+B(Et)+". expected "+Je+", got "+typeof Te,sr||Me())}function Ae(Te){Te()}function _e(Te,Je,Et){Te.texture?Ce(Te.texture._texture.internalformat,Je,"unsupported texture format for attachment"):Ce(Te.renderbuffer._renderbuffer.format,Et,"unsupported renderbuffer format for attachment")}var ue=33071,ke=9728,ze=9984,le=9985,Ut=9986,kt=9987,pr=5120,Wt=5121,Xr=5122,fn=5123,Ir=5124,Qr=5125,tn=5126,Mr=32819,$n=32820,li=33635,Kn=34042,$r=36193,ln={};ln[pr]=ln[Wt]=1,ln[Xr]=ln[fn]=ln[$r]=ln[li]=ln[Mr]=ln[$n]=2,ln[Ir]=ln[Qr]=ln[tn]=ln[Kn]=4;function Cn(Te,Je){return Te===$n||Te===Mr||Te===li?2:Te===Kn?4:ln[Te]*Je}function $i(Te){return!(Te&Te-1)&&!!Te}function ci(Te,Je,Et){var sr,Er=Je.width,lr=Je.height,gr=Je.channels;U(Er>0&&Er<=Et.maxTextureSize&&lr>0&&lr<=Et.maxTextureSize,"invalid texture shape"),(Te.wrapS!==ue||Te.wrapT!==ue)&&U($i(Er)&&$i(lr),"incompatible wrap mode for texture, both width and height must be power of 2"),Je.mipmask===1?Er!==1&&lr!==1&&U(Te.minFilter!==ze&&Te.minFilter!==Ut&&Te.minFilter!==le&&Te.minFilter!==kt,"min filter requires mipmap"):(U($i(Er)&&$i(lr),"texture must be a square power of 2 to support mipmapping"),U(Je.mipmask===(Er<<1)-1,"missing or incomplete mipmap data")),Je.type===tn&&(Et.extensions.indexOf("oes_texture_float_linear")<0&&U(Te.minFilter===ke&&Te.magFilter===ke,"filter not supported, must enable oes_texture_float_linear"),U(!Te.genMipmaps,"mipmap generation not supported with float textures"));var kr=Je.images;for(sr=0;sr<16;++sr)if(kr[sr]){var Pr=Er>>sr,qr=lr>>sr;U(Je.mipmask&1<<sr,"missing mipmap data");var Br=kr[sr];if(U(Br.width===Pr&&Br.height===qr,"invalid shape for mip images"),U(Br.format===Je.format&&Br.internalformat===Je.internalformat&&Br.type===Je.type,"incompatible type for mip image"),!Br.compressed)if(Br.data){var Vr=Math.ceil(Cn(Br.type,gr)*Pr/Br.unpackAlignment)*Br.unpackAlignment;U(Br.data.byteLength===Vr*qr,"invalid data for image, buffer size is inconsistent with image format")}else Br.element||Br.copy}else Te.genMipmaps||U((Je.mipmask&1<<sr)===0,"extra mipmap data");Je.compressed&&U(!Te.genMipmaps,"mipmap generation for compressed images not supported")}function Ft(Te,Je,Et,sr){var Er=Te.width,lr=Te.height,gr=Te.channels;U(Er>0&&Er<=sr.maxTextureSize&&lr>0&&lr<=sr.maxTextureSize,"invalid texture shape"),U(Er===lr,"cube map must be square"),U(Je.wrapS===ue&&Je.wrapT===ue,"wrap mode not supported by cube map");for(var kr=0;kr<Et.length;++kr){var Pr=Et[kr];U(Pr.width===Er&&Pr.height===lr,"inconsistent cube map face shape"),Je.genMipmaps&&(U(!Pr.compressed,"can not generate mipmap for compressed textures"),U(Pr.mipmask===1,"can not specify mipmaps and generate mipmaps"));for(var qr=Pr.images,Br=0;Br<16;++Br){var Vr=qr[Br];if(Vr){var Kr=Er>>Br,Dr=lr>>Br;U(Pr.mipmask&1<<Br,"missing mipmap data"),U(Vr.width===Kr&&Vr.height===Dr,"invalid shape for mip images"),U(Vr.format===Te.format&&Vr.internalformat===Te.internalformat&&Vr.type===Te.type,"incompatible type for mip image"),Vr.compressed||(Vr.data?U(Vr.data.byteLength===Kr*Dr*Math.max(Cn(Vr.type,gr),Vr.unpackAlignment),"invalid data for image, buffer size is inconsistent with image format"):Vr.element||Vr.copy)}}}}var te=C(U,{optional:Ae,raise:G,commandRaise:xe,command:ye,parameter:Z,commandParameter:Q,constructor:Ze,type:ie,commandType:Pe,isTypedArray:X,nni:he,oneOf:Ce,shaderError:oe,linkError:Y,callSite:ce,saveCommandRef:Ne,saveDrawInfo:ge,framebufferFormat:_e,guessCommand:Me,texture2D:ci,textureCube:Ft}),We=0,Qe=0;function vt(Te,Je){this.id=We++,this.type=Te,this.data=Je}function Lt(Te){return Te.replace(/\\/g,"\\\\").replace(/"/g,'\\"')}function Pt(Te){if(Te.length===0)return[];var Je=Te.charAt(0),Et=Te.charAt(Te.length-1);if(Te.length>1&&Je===Et&&(Je==='"'||Je==="'"))return['"'+Lt(Te.substr(1,Te.length-2))+'"'];var sr=/\[(false|true|null|\d+|'[^']*'|"[^"]*")\]/.exec(Te);if(sr)return Pt(Te.substr(0,sr.index)).concat(Pt(sr[1])).concat(Pt(Te.substr(sr.index+sr[0].length)));var Er=Te.split(".");if(Er.length===1)return['"'+Lt(Te)+'"'];for(var lr=[],gr=0;gr<Er.length;++gr)lr=lr.concat(Pt(Er[gr]));return lr}function Cr(Te){return"["+Pt(Te).join("][")+"]"}function yt(Te,Je){return new vt(Te,Cr(Je+""))}function Ot(Te){return typeof Te=="function"&&!Te._reglType||Te instanceof vt}function rr(Te,Je){return typeof Te=="function"?new vt(Qe,Te):Te}var Sr={DynamicVariable:vt,define:yt,isDynamic:Ot,unbox:rr,accessor:Cr},Lr={next:typeof requestAnimationFrame=="function"?function(Te){return requestAnimationFrame(Te)}:function(Te){return setTimeout(Te,16)},cancel:typeof cancelAnimationFrame=="function"?function(Te){return cancelAnimationFrame(Te)}:clearTimeout},on=typeof performance!="undefined"&&performance.now?function(){return performance.now()}:function(){return+new Date};function hn(){var Te={"":0},Je=[""];return{id:function(Et){var sr=Te[Et];return sr||(sr=Te[Et]=Je.length,Je.push(Et),sr)},str:function(Et){return Je[Et]}}}function zr(Te,Je,Et){var sr=document.createElement("canvas");C(sr.style,{border:0,margin:0,padding:0,top:0,left:0}),Te.appendChild(sr),Te===document.body&&(sr.style.position="absolute",C(Te.style,{margin:0,padding:0}));function Er(){var kr=window.innerWidth,Pr=window.innerHeight;if(Te!==document.body){var qr=Te.getBoundingClientRect();kr=qr.right-qr.left,Pr=qr.bottom-qr.top}sr.width=Et*kr,sr.height=Et*Pr,C(sr.style,{width:kr+"px",height:Pr+"px"})}var lr;Te!==document.body&&typeof ResizeObserver=="function"?(lr=new ResizeObserver(function(){setTimeout(Er)}),lr.observe(Te)):window.addEventListener("resize",Er,!1);function gr(){lr?lr.disconnect():window.removeEventListener("resize",Er),Te.removeChild(sr)}return Er(),{canvas:sr,onDestroy:gr}}function rn(Te,Je){function Et(sr){try{return Te.getContext(sr,Je)}catch(Er){return null}}return Et("webgl")||Et("experimental-webgl")||Et("webgl-experimental")}function Wn(Te){return typeof Te.nodeName=="string"&&typeof Te.appendChild=="function"&&typeof Te.getBoundingClientRect=="function"}function jn(Te){return typeof Te.drawArrays=="function"||typeof Te.drawElements=="function"}function mi(Te){return typeof Te=="string"?Te.split():(te(Array.isArray(Te),"invalid extension array"),Te)}function Ea(Te){return typeof Te=="string"?(te(typeof document!="undefined","not supported outside of DOM"),document.querySelector(Te)):Te}function ja(Te){var Je=Te||{},Et,sr,Er,lr,gr={},kr=[],Pr=[],qr=typeof window=="undefined"?1:window.devicePixelRatio,Br=!1,Vr=function(jr){jr&&te.raise(jr)},Kr=function(){};if(typeof Je=="string"?(te(typeof document!="undefined","selector queries only supported in DOM enviroments"),Et=document.querySelector(Je),te(Et,"invalid query string for element")):typeof Je=="object"?Wn(Je)?Et=Je:jn(Je)?(lr=Je,Er=lr.canvas):(te.constructor(Je),"gl"in Je?lr=Je.gl:"canvas"in Je?Er=Ea(Je.canvas):"container"in Je&&(sr=Ea(Je.container)),"attributes"in Je&&(gr=Je.attributes,te.type(gr,"object","invalid context attributes")),"extensions"in Je&&(kr=mi(Je.extensions)),"optionalExtensions"in Je&&(Pr=mi(Je.optionalExtensions)),"onDone"in Je&&(te.type(Je.onDone,"function","invalid or missing onDone callback"),Vr=Je.onDone),"profile"in Je&&(Br=!!Je.profile),"pixelRatio"in Je&&(qr=+Je.pixelRatio,te(qr>0,"invalid pixel ratio"))):te.raise("invalid arguments to regl"),Et&&(Et.nodeName.toLowerCase()==="canvas"?Er=Et:sr=Et),!lr){if(!Er){te(typeof document!="undefined","must manually specify webgl context outside of DOM environments");var Dr=zr(sr||document.body,Vr,qr);if(!Dr)return null;Er=Dr.canvas,Kr=Dr.onDestroy}gr.premultipliedAlpha===void 0&&(gr.premultipliedAlpha=!0),lr=rn(Er,gr)}return lr?{gl:lr,canvas:Er,container:sr,extensions:kr,optionalExtensions:Pr,pixelRatio:qr,profile:Br,onDone:Vr,onDestroy:Kr}:(Kr(),Vr("webgl not supported, try upgrading your browser or graphics drivers http://get.webgl.org"),null)}function Wr(Te,Je){var Et={};function sr(gr){te.type(gr,"string","extension name must be string");var kr=gr.toLowerCase(),Pr;try{Pr=Et[kr]=Te.getExtension(kr)}catch(qr){}return!!Pr}for(var Er=0;Er<Je.extensions.length;++Er){var lr=Je.extensions[Er];if(!sr(lr))return Je.onDestroy(),Je.onDone('"'+lr+'" extension is not supported by the current WebGL context, try upgrading your system or a different browser'),null}return Je.optionalExtensions.forEach(sr),{extensions:Et,restore:function(){Object.keys(Et).forEach(function(gr){if(Et[gr]&&!sr(gr))throw new Error("(regl): error restoring extension "+gr)})}}}function no(Te,Je){for(var Et=Array(Te),sr=0;sr<Te;++sr)Et[sr]=Je(sr);return Et}var Xo=5120,Xn=5121,Hs=5122,Bo=5123,iu=5124,ts=5125,Vl=5126;function ku(Te){for(var Je=16;Je<=1<<28;Je*=16)if(Te<=Je)return Je;return 0}function Ds(Te){var Je,Et;return Je=(Te>65535)<<4,Te>>>=Je,Et=(Te>255)<<3,Te>>>=Et,Je|=Et,Et=(Te>15)<<2,Te>>>=Et,Je|=Et,Et=(Te>3)<<1,Te>>>=Et,Je|=Et,Je|Te>>1}function bs(){var Te=no(8,function(){return[]});function Je(lr){var gr=ku(lr),kr=Te[Ds(gr)>>2];return kr.length>0?kr.pop():new ArrayBuffer(gr)}function Et(lr){Te[Ds(lr.byteLength)>>2].push(lr)}function sr(lr,gr){var kr=null;switch(lr){case Xo:kr=new Int8Array(Je(gr),0,gr);break;case Xn:kr=new Uint8Array(Je(gr),0,gr);break;case Hs:kr=new Int16Array(Je(2*gr),0,gr);break;case Bo:kr=new Uint16Array(Je(2*gr),0,gr);break;case iu:kr=new Int32Array(Je(4*gr),0,gr);break;case ts:kr=new Uint32Array(Je(4*gr),0,gr);break;case Vl:kr=new Float32Array(Je(4*gr),0,gr);break;default:return null}return kr.length!==gr?kr.subarray(0,gr):kr}function Er(lr){Et(lr.buffer)}return{alloc:Je,free:Et,allocType:sr,freeType:Er}}var Fa=bs();Fa.zero=bs();var uc=3408,Uu=3410,ta=3411,au=3412,mo=3413,Rs=3414,rs=3415,Qi=33901,_o=33902,Ws=3379,ds=3386,il=34921,Ba=36347,Oa=36348,Cl=35661,Co=35660,gu=34930,ka=36349,Ru=34076,cr=34024,yn=7936,bo=7937,mu=7938,_u=35724,js=34047,ou=36063,qa=34852,lc=3553,Ls=34067,su=34069,Nc=33984,Oi=6408,bl=5126,Fs=5121,Hl=36160,Ri=36053,Rl=36064,Yf=16384,al=function(Te,Je){var Et=1;Je.ext_texture_filter_anisotropic&&(Et=Te.getParameter(js));var sr=1,Er=1;Je.webgl_draw_buffers&&(sr=Te.getParameter(qa),Er=Te.getParameter(ou));var lr=!!Je.oes_texture_float;if(lr){var gr=Te.createTexture();Te.bindTexture(lc,gr),Te.texImage2D(lc,0,Oi,1,1,0,Oi,bl,null);var kr=Te.createFramebuffer();if(Te.bindFramebuffer(Hl,kr),Te.framebufferTexture2D(Hl,Rl,lc,gr,0),Te.bindTexture(lc,null),Te.checkFramebufferStatus(Hl)!==Ri)lr=!1;else{Te.viewport(0,0,1,1),Te.clearColor(1,0,0,1),Te.clear(Yf);var Pr=Fa.allocType(bl,4);Te.readPixels(0,0,1,1,Oi,bl,Pr),Te.getError()?lr=!1:(Te.deleteFramebuffer(kr),Te.deleteTexture(gr),lr=Pr[0]===1),Fa.freeType(Pr)}}var qr=typeof navigator!="undefined"&&(/MSIE/.test(navigator.userAgent)||/Trident\//.test(navigator.appVersion)||/Edge/.test(navigator.userAgent)),Br=!0;if(!qr){var Vr=Te.createTexture(),Kr=Fa.allocType(Fs,36);Te.activeTexture(Nc),Te.bindTexture(Ls,Vr),Te.texImage2D(su,0,Oi,3,3,0,Oi,Fs,Kr),Fa.freeType(Kr),Te.bindTexture(Ls,null),Te.deleteTexture(Vr),Br=!Te.getError()}return{colorBits:[Te.getParameter(Uu),Te.getParameter(ta),Te.getParameter(au),Te.getParameter(mo)],depthBits:Te.getParameter(Rs),stencilBits:Te.getParameter(rs),subpixelBits:Te.getParameter(uc),extensions:Object.keys(Je).filter(function(Dr){return!!Je[Dr]}),maxAnisotropic:Et,maxDrawbuffers:sr,maxColorAttachments:Er,pointSizeDims:Te.getParameter(Qi),lineWidthDims:Te.getParameter(_o),maxViewportDims:Te.getParameter(ds),maxCombinedTextureUnits:Te.getParameter(Cl),maxCubeMapSize:Te.getParameter(Ru),maxRenderbufferSize:Te.getParameter(cr),maxTextureUnits:Te.getParameter(gu),maxTextureSize:Te.getParameter(Ws),maxAttributes:Te.getParameter(il),maxVertexUniforms:Te.getParameter(Ba),maxVertexTextureUnits:Te.getParameter(Co),maxVaryingVectors:Te.getParameter(Oa),maxFragmentUniforms:Te.getParameter(ka),glsl:Te.getParameter(_u),renderer:Te.getParameter(bo),vendor:Te.getParameter(yn),version:Te.getParameter(mu),readFloat:lr,npotTextureCube:Br}};function Ka(Te){return!!Te&&typeof Te=="object"&&Array.isArray(Te.shape)&&Array.isArray(Te.stride)&&typeof Te.offset=="number"&&Te.shape.length===Te.stride.length&&(Array.isArray(Te.data)||j(Te.data))}var bt=function(Te){return Object.keys(Te).map(function(Je){return Te[Je]})},Ye={shape:vr,flatten:Ht};function qt(Te,Je,Et){for(var sr=0;sr<Je;++sr)Et[sr]=Te[sr]}function fe(Te,Je,Et,sr){for(var Er=0,lr=0;lr<Je;++lr)for(var gr=Te[lr],kr=0;kr<Et;++kr)sr[Er++]=gr[kr]}function Ue(Te,Je,Et,sr,Er,lr){for(var gr=lr,kr=0;kr<Je;++kr)for(var Pr=Te[kr],qr=0;qr<Et;++qr)for(var Br=Pr[qr],Vr=0;Vr<sr;++Vr)Er[gr++]=Br[Vr]}function Ke(Te,Je,Et,sr,Er){for(var lr=1,gr=Et+1;gr<Je.length;++gr)lr*=Je[gr];var kr=Je[Et];if(Je.length-Et===4){var Pr=Je[Et+1],qr=Je[Et+2],Br=Je[Et+3];for(gr=0;gr<kr;++gr)Ue(Te[gr],Pr,qr,Br,sr,Er),Er+=lr}else for(gr=0;gr<kr;++gr)Ke(Te[gr],Je,Et+1,sr,Er),Er+=lr}function Ht(Te,Je,Et,sr){var Er=1;if(Je.length)for(var lr=0;lr<Je.length;++lr)Er*=Je[lr];else Er=0;var gr=sr||Fa.allocType(Et,Er);switch(Je.length){case 0:break;case 1:qt(Te,Je[0],gr);break;case 2:fe(Te,Je[0],Je[1],gr);break;case 3:Ue(Te,Je[0],Je[1],Je[2],gr,0);break;default:Ke(Te,Je,0,gr,0)}return gr}function vr(Te){for(var Je=[],Et=Te;Et.length;Et=Et[0])Je.push(Et.length);return Je}var Nr={"[object Int8Array]":5120,"[object Int16Array]":5122,"[object Int32Array]":5124,"[object Uint8Array]":5121,"[object Uint8ClampedArray]":5121,"[object Uint16Array]":5123,"[object Uint32Array]":5125,"[object Float32Array]":5126,"[object Float64Array]":5121,"[object ArrayBuffer]":5121},mn=5120,zn=5122,Mi=5124,Ro=5121,Ms=5123,Xs=5125,If=5126,uu=5126,ca={int8:mn,int16:zn,int32:Mi,uint8:Ro,uint16:Ms,uint32:Xs,float:If,float32:uu},Dc=35048,ns=35040,Lc={dynamic:Dc,stream:ns,static:35044},ol=Ye.flatten,Xa=Ye.shape,Fn=35044,Wl=35040,Ys=5121,lu=5126,ws=[];ws[5120]=1,ws[5122]=2,ws[5124]=4,ws[5121]=1,ws[5123]=2,ws[5125]=4,ws[5126]=4;function Mu(Te){return Nr[Object.prototype.toString.call(Te)]|0}function wi(Te,Je){for(var Et=0;Et<Je.length;++Et)Te[Et]=Je[Et]}function Is(Te,Je,Et,sr,Er,lr,gr){for(var kr=0,Pr=0;Pr<Et;++Pr)for(var qr=0;qr<sr;++qr)Te[kr++]=Je[Er*Pr+lr*qr+gr]}function io(Te,Je,Et,sr){var Er=0,lr={};function gr(jt){this.id=Er++,this.buffer=Te.createBuffer(),this.type=jt,this.usage=Fn,this.byteLength=0,this.dimension=1,this.dtype=Ys,this.persistentData=null,Et.profile&&(this.stats={size:0})}gr.prototype.bind=function(){Te.bindBuffer(this.type,this.buffer)},gr.prototype.destroy=function(){Kr(this)};var kr=[];function Pr(jt,Ar){var Ur=kr.pop();return Ur||(Ur=new gr(jt)),Ur.bind(),Vr(Ur,Ar,Wl,0,1,!1),Ur}function qr(jt){kr.push(jt)}function Br(jt,Ar,Ur){jt.byteLength=Ar.byteLength,Te.bufferData(jt.type,Ar,Ur)}function Vr(jt,Ar,Ur,Jr,Rr,An){var Fr;if(jt.usage=Ur,Array.isArray(Ar)){if(jt.dtype=Jr||lu,Ar.length>0){var sn;if(Array.isArray(Ar[0])){Fr=Xa(Ar);for(var wr=1,en=1;en<Fr.length;++en)wr*=Fr[en];jt.dimension=wr,sn=ol(Ar,Fr,jt.dtype),Br(jt,sn,Ur),An?jt.persistentData=sn:Fa.freeType(sn)}else if(typeof Ar[0]=="number"){jt.dimension=Rr;var Nn=Fa.allocType(jt.dtype,Ar.length);wi(Nn,Ar),Br(jt,Nn,Ur),An?jt.persistentData=Nn:Fa.freeType(Nn)}else j(Ar[0])?(jt.dimension=Ar[0].length,jt.dtype=Jr||Mu(Ar[0])||lu,sn=ol(Ar,[Ar.length,Ar[0].length],jt.dtype),Br(jt,sn,Ur),An?jt.persistentData=sn:Fa.freeType(sn)):te.raise("invalid buffer data")}}else if(j(Ar))jt.dtype=Jr||Mu(Ar),jt.dimension=Rr,Br(jt,Ar,Ur),An&&(jt.persistentData=new Uint8Array(new Uint8Array(Ar.buffer)));else if(Ka(Ar)){Fr=Ar.shape;var hi=Ar.stride,an=Ar.offset,Zr=0,Tr=0,ai=0,Yn=0;Fr.length===1?(Zr=Fr[0],Tr=1,ai=hi[0],Yn=0):Fr.length===2?(Zr=Fr[0],Tr=Fr[1],ai=hi[0],Yn=hi[1]):te.raise("invalid shape"),jt.dtype=Jr||Mu(Ar.data)||lu,jt.dimension=Tr;var Pn=Fa.allocType(jt.dtype,Zr*Tr);Is(Pn,Ar.data,Zr,Tr,ai,Yn,an),Br(jt,Pn,Ur),An?jt.persistentData=Pn:Fa.freeType(Pn)}else Ar instanceof ArrayBuffer?(jt.dtype=Ys,jt.dimension=Rr,Br(jt,Ar,Ur),An&&(jt.persistentData=new Uint8Array(new Uint8Array(Ar)))):te.raise("invalid buffer data")}function Kr(jt){Je.bufferCount--,sr(jt);var Ar=jt.buffer;te(Ar,"buffer must not be deleted already"),Te.deleteBuffer(Ar),jt.buffer=null,delete lr[jt.id]}function Dr(jt,Ar,Ur,Jr){Je.bufferCount++;var Rr=new gr(Ar);lr[Rr.id]=Rr;function An(wr){var en=Fn,Nn=null,hi=0,an=0,Zr=1;return Array.isArray(wr)||j(wr)||Ka(wr)||wr instanceof ArrayBuffer?Nn=wr:typeof wr=="number"?hi=wr|0:wr&&(te.type(wr,"object","buffer arguments must be an object, a number or an array"),"data"in wr&&(te(Nn===null||Array.isArray(Nn)||j(Nn)||Ka(Nn),"invalid data for buffer"),Nn=wr.data),"usage"in wr&&(te.parameter(wr.usage,Lc,"invalid buffer usage"),en=Lc[wr.usage]),"type"in wr&&(te.parameter(wr.type,ca,"invalid buffer type"),an=ca[wr.type]),"dimension"in wr&&(te.type(wr.dimension,"number","invalid dimension"),Zr=wr.dimension|0),"length"in wr&&(te.nni(hi,"buffer length must be a nonnegative integer"),hi=wr.length|0)),Rr.bind(),Nn?Vr(Rr,Nn,en,an,Zr,Jr):(hi&&Te.bufferData(Rr.type,hi,en),Rr.dtype=an||Ys,Rr.usage=en,Rr.dimension=Zr,Rr.byteLength=hi),Et.profile&&(Rr.stats.size=Rr.byteLength*ws[Rr.dtype]),An}function Fr(wr,en){te(en+wr.byteLength<=Rr.byteLength,"invalid buffer subdata call, buffer is too small.  Can't write data of size "+wr.byteLength+" starting from offset "+en+" to a buffer of size "+Rr.byteLength),Te.bufferSubData(Rr.type,en,wr)}function sn(wr,en){var Nn=(en||0)|0,hi;if(Rr.bind(),j(wr)||wr instanceof ArrayBuffer)Fr(wr,Nn);else if(Array.isArray(wr)){if(wr.length>0)if(typeof wr[0]=="number"){var an=Fa.allocType(Rr.dtype,wr.length);wi(an,wr),Fr(an,Nn),Fa.freeType(an)}else if(Array.isArray(wr[0])||j(wr[0])){hi=Xa(wr);var Zr=ol(wr,hi,Rr.dtype);Fr(Zr,Nn),Fa.freeType(Zr)}else te.raise("invalid buffer data")}else if(Ka(wr)){hi=wr.shape;var Tr=wr.stride,ai=0,Yn=0,Pn=0,Di=0;hi.length===1?(ai=hi[0],Yn=1,Pn=Tr[0],Di=0):hi.length===2?(ai=hi[0],Yn=hi[1],Pn=Tr[0],Di=Tr[1]):te.raise("invalid shape");var ei=Array.isArray(wr.data)?Rr.dtype:Mu(wr.data),qn=Fa.allocType(ei,ai*Yn);Is(qn,wr.data,ai,Yn,Pn,Di,wr.offset),Fr(qn,Nn),Fa.freeType(qn)}else te.raise("invalid data for buffer subdata");return An}return Ur||An(jt),An._reglType="buffer",An._buffer=Rr,An.subdata=sn,Et.profile&&(An.stats=Rr.stats),An.destroy=function(){Kr(Rr)},An}function jr(){bt(lr).forEach(function(jt){jt.buffer=Te.createBuffer(),Te.bindBuffer(jt.type,jt.buffer),Te.bufferData(jt.type,jt.persistentData||jt.byteLength,jt.usage)})}return Et.profile&&(Je.getTotalBufferSize=function(){var jt=0;return Object.keys(lr).forEach(function(Ar){jt+=lr[Ar].stats.size}),jt}),{create:Dr,createStream:Pr,destroyStream:qr,clear:function(){bt(lr).forEach(Kr),kr.forEach(Kr)},getBuffer:function(jt){return jt&&jt._buffer instanceof gr?jt._buffer:null},restore:jr,_initBuffer:Vr}}var Ya=0,ko=0,wu=1,$f=1,cc=4,Pf=4,jl={points:Ya,point:ko,lines:wu,line:$f,triangles:cc,triangle:Pf,"line loop":2,"line strip":3,"triangle strip":5,"triangle fan":6},vs=0,Ml=1,yo=4,ba=5120,gs=5121,Xl=5122,Ua=5123,On=5124,wl=5125,fc=34963,is=35040,cu=35044;function Yl(Te,Je,Et,sr){var Er={},lr=0,gr={uint8:gs,uint16:Ua};Je.oes_element_index_uint&&(gr.uint32=wl);function kr(jr){this.id=lr++,Er[this.id]=this,this.buffer=jr,this.primType=yo,this.vertCount=0,this.type=0}kr.prototype.bind=function(){this.buffer.bind()};var Pr=[];function qr(jr){var jt=Pr.pop();return jt||(jt=new kr(Et.create(null,fc,!0,!1)._buffer)),Vr(jt,jr,is,-1,-1,0,0),jt}function Br(jr){Pr.push(jr)}function Vr(jr,jt,Ar,Ur,Jr,Rr,An){jr.buffer.bind();var Fr;if(jt){var sn=An;!An&&(!j(jt)||Ka(jt)&&!j(jt.data))&&(sn=Je.oes_element_index_uint?wl:Ua),Et._initBuffer(jr.buffer,jt,Ar,sn,3)}else Te.bufferData(fc,Rr,Ar),jr.buffer.dtype=Fr||gs,jr.buffer.usage=Ar,jr.buffer.dimension=3,jr.buffer.byteLength=Rr;if(Fr=An,!An){switch(jr.buffer.dtype){case gs:case ba:Fr=gs;break;case Ua:case Xl:Fr=Ua;break;case wl:case On:Fr=wl;break;default:te.raise("unsupported type for element array")}jr.buffer.dtype=Fr}jr.type=Fr,te(Fr!==wl||!!Je.oes_element_index_uint,"32 bit element buffers not supported, enable oes_element_index_uint first");var wr=Jr;wr<0&&(wr=jr.buffer.byteLength,Fr===Ua?wr>>=1:Fr===wl&&(wr>>=2)),jr.vertCount=wr;var en=Ur;if(Ur<0){en=yo;var Nn=jr.buffer.dimension;Nn===1&&(en=vs),Nn===2&&(en=Ml),Nn===3&&(en=yo)}jr.primType=en}function Kr(jr){sr.elementsCount--,te(jr.buffer!==null,"must not double destroy elements"),delete Er[jr.id],jr.buffer.destroy(),jr.buffer=null}function Dr(jr,jt){var Ar=Et.create(null,fc,!0),Ur=new kr(Ar._buffer);sr.elementsCount++;function Jr(Rr){if(!Rr)Ar(),Ur.primType=yo,Ur.vertCount=0,Ur.type=gs;else if(typeof Rr=="number")Ar(Rr),Ur.primType=yo,Ur.vertCount=Rr|0,Ur.type=gs;else{var An=null,Fr=cu,sn=-1,wr=-1,en=0,Nn=0;Array.isArray(Rr)||j(Rr)||Ka(Rr)?An=Rr:(te.type(Rr,"object","invalid arguments for elements"),"data"in Rr&&(An=Rr.data,te(Array.isArray(An)||j(An)||Ka(An),"invalid data for element buffer")),"usage"in Rr&&(te.parameter(Rr.usage,Lc,"invalid element buffer usage"),Fr=Lc[Rr.usage]),"primitive"in Rr&&(te.parameter(Rr.primitive,jl,"invalid element buffer primitive"),sn=jl[Rr.primitive]),"count"in Rr&&(te(typeof Rr.count=="number"&&Rr.count>=0,"invalid vertex count for elements"),wr=Rr.count|0),"type"in Rr&&(te.parameter(Rr.type,gr,"invalid buffer type"),Nn=gr[Rr.type]),"length"in Rr?en=Rr.length|0:(en=wr,Nn===Ua||Nn===Xl?en*=2:(Nn===wl||Nn===On)&&(en*=4))),Vr(Ur,An,Fr,sn,wr,en,Nn)}return Jr}return Jr(jr),Jr._reglType="elements",Jr._elements=Ur,Jr.subdata=function(Rr,An){return Ar.subdata(Rr,An),Jr},Jr.destroy=function(){Kr(Ur)},Jr}return{create:Dr,createStream:qr,destroyStream:Br,getElements:function(jr){return typeof jr=="function"&&jr._elements instanceof kr?jr._elements:null},clear:function(){bt(Er).forEach(Kr)}}}var Fc=new Float32Array(1),nf=new Uint32Array(Fc.buffer),m0=5123;function Aa(Te){for(var Je=Fa.allocType(m0,Te.length),Et=0;Et<Te.length;++Et)if(isNaN(Te[Et]))Je[Et]=65535;else if(Te[Et]===1/0)Je[Et]=31744;else if(Te[Et]===-1/0)Je[Et]=64512;else{Fc[0]=Te[Et];var sr=nf[0],Er=sr>>>31<<15,lr=(sr<<1>>>24)-127,gr=sr>>13&1024-1;if(lr<-24)Je[Et]=Er;else if(lr<-14){var kr=-14-lr;Je[Et]=Er+(gr+1024>>kr)}else lr>15?Je[Et]=Er+31744:Je[Et]=Er+(lr+15<<10)+gr}return Je}function Pa(Te){return Array.isArray(Te)||j(Te)}var ma=function(Te){return!(Te&Te-1)&&!!Te},Bc=34467,ao=3553,Qf=34067,Ni=34069,Yo=6408,Sa=6406,Iu=6407,Ra=6409,Bs=6410,af=32854,Pu=32855,Gi=36194,$s=32819,Ou=32820,as=33635,ks=34042,Uo=6402,Of=34041,kc=35904,Na=35906,Mo=36193,Qs=33776,os=33777,ms=33778,Nu=33779,yu=35986,Gr=35987,fo=34798,of=35840,hc=35841,Zo=35842,sl=35843,Zu=36196,$l=5121,Ps=5123,Du=5125,Il=5126,Ac=10242,Oh=10243,_0=10497,ul=33071,zu=33648,_s=10240,Ql=10241,zo=9728,Gu=9729,ll=9984,sf=9985,pc=9986,Vu=9987,Hu=33170,wo=4352,Wu=4353,ss=4354,X0=34046,Pl=3317,Uc=37440,us=37441,ys=37443,qs=37444,Os=33984,Nf=[ll,pc,sf,Vu],fu=[0,Ra,Bs,Iu,Yo],ls={};ls[Ra]=ls[Sa]=ls[Uo]=1,ls[Of]=ls[Bs]=2,ls[Iu]=ls[kc]=3,ls[Yo]=ls[Na]=4;function Io(Te){return"[object "+Te+"]"}var uf=Io("HTMLCanvasElement"),po=Io("OffscreenCanvas"),hr=Io("CanvasRenderingContext2D"),St=Io("ImageBitmap"),ve=Io("HTMLImageElement"),hu=Io("HTMLVideoElement"),it=Object.keys(Nr).concat([uf,po,hr,St,ve,hu]),Eu=[];Eu[$l]=1,Eu[Il]=4,Eu[Mo]=2,Eu[Ps]=2,Eu[Du]=4;var Si=[];Si[af]=2,Si[Pu]=2,Si[Gi]=2,Si[Of]=4,Si[Qs]=.5,Si[os]=.5,Si[ms]=1,Si[Nu]=1,Si[yu]=.5,Si[Gr]=1,Si[fo]=1,Si[of]=.5,Si[hc]=.25,Si[Zo]=.5,Si[sl]=.25,Si[Zu]=.5;function cl(Te){return Array.isArray(Te)&&(Te.length===0||typeof Te[0]=="number")}function va(Te){if(!Array.isArray(Te))return!1;var Je=Te.length;return!(Je===0||!Pa(Te[0]))}function pa(Te){return Object.prototype.toString.call(Te)}function Bi(Te){return pa(Te)===uf}function Go(Te){return pa(Te)===po}function qi(Te){return pa(Te)===hr}function ni(Te){return pa(Te)===St}function Pi(Te){return pa(Te)===ve}function oa(Te){return pa(Te)===hu}function Ii(Te){if(!Te)return!1;var Je=pa(Te);return it.indexOf(Je)>=0?!0:cl(Te)||va(Te)||Ka(Te)}function xi(Te){return Nr[Object.prototype.toString.call(Te)]|0}function Un(Te,Je){var Et=Je.length;switch(Te.type){case $l:case Ps:case Du:case Il:var sr=Fa.allocType(Te.type,Et);sr.set(Je),Te.data=sr;break;case Mo:Te.data=Aa(Je);break;default:te.raise("unsupported texture type, must specify a typed array")}}function ii(Te,Je){return Fa.allocType(Te.type===Mo?Il:Te.type,Je)}function ki(Te,Je){Te.type===Mo?(Te.data=Aa(Je),Fa.freeType(Je)):Te.data=Je}function fi(Te,Je,Et,sr,Er,lr){for(var gr=Te.width,kr=Te.height,Pr=Te.channels,qr=gr*kr*Pr,Br=ii(Te,qr),Vr=0,Kr=0;Kr<kr;++Kr)for(var Dr=0;Dr<gr;++Dr)for(var jr=0;jr<Pr;++jr)Br[Vr++]=Je[Et*Dr+sr*Kr+Er*jr+lr];ki(Te,Br)}function Vi(Te,Je,Et,sr,Er,lr){var gr;if(typeof Si[Te]!="undefined"?gr=Si[Te]:gr=ls[Te]*Eu[Je],lr&&(gr*=6),Er){for(var kr=0,Pr=Et;Pr>=1;)kr+=gr*Pr*Pr,Pr/=2;return kr}else return gr*Et*sr}function ra(Te,Je,Et,sr,Er,lr,gr){var kr={"don't care":wo,"dont care":wo,nice:ss,fast:Wu},Pr={repeat:_0,clamp:ul,mirror:zu},qr={nearest:zo,linear:Gu},Br=C({mipmap:Vu,"nearest mipmap nearest":ll,"linear mipmap nearest":sf,"nearest mipmap linear":pc,"linear mipmap linear":Vu},qr),Vr={none:0,browser:qs},Kr={uint8:$l,rgba4:$s,rgb565:as,"rgb5 a1":Ou},Dr={alpha:Sa,luminance:Ra,"luminance alpha":Bs,rgb:Iu,rgba:Yo,rgba4:af,"rgb5 a1":Pu,rgb565:Gi},jr={};Je.ext_srgb&&(Dr.srgb=kc,Dr.srgba=Na),Je.oes_texture_float&&(Kr.float32=Kr.float=Il),Je.oes_texture_half_float&&(Kr.float16=Kr["half float"]=Mo),Je.webgl_depth_texture&&(C(Dr,{depth:Uo,"depth stencil":Of}),C(Kr,{uint16:Ps,uint32:Du,"depth stencil":ks})),Je.webgl_compressed_texture_s3tc&&C(jr,{"rgb s3tc dxt1":Qs,"rgba s3tc dxt1":os,"rgba s3tc dxt3":ms,"rgba s3tc dxt5":Nu}),Je.webgl_compressed_texture_atc&&C(jr,{"rgb atc":yu,"rgba atc explicit alpha":Gr,"rgba atc interpolated alpha":fo}),Je.webgl_compressed_texture_pvrtc&&C(jr,{"rgb pvrtc 4bppv1":of,"rgb pvrtc 2bppv1":hc,"rgba pvrtc 4bppv1":Zo,"rgba pvrtc 2bppv1":sl}),Je.webgl_compressed_texture_etc1&&(jr["rgb etc1"]=Zu);var jt=Array.prototype.slice.call(Te.getParameter(Bc));Object.keys(jr).forEach(function(ht){var Tt=jr[ht];jt.indexOf(Tt)>=0&&(Dr[ht]=Tt)});var Ar=Object.keys(Dr);Et.textureFormats=Ar;var Ur=[];Object.keys(Dr).forEach(function(ht){var Tt=Dr[ht];Ur[Tt]=ht});var Jr=[];Object.keys(Kr).forEach(function(ht){var Tt=Kr[ht];Jr[Tt]=ht});var Rr=[];Object.keys(qr).forEach(function(ht){var Tt=qr[ht];Rr[Tt]=ht});var An=[];Object.keys(Br).forEach(function(ht){var Tt=Br[ht];An[Tt]=ht});var Fr=[];Object.keys(Pr).forEach(function(ht){var Tt=Pr[ht];Fr[Tt]=ht});var sn=Ar.reduce(function(ht,Tt){var Xt=Dr[Tt];return Xt===Ra||Xt===Sa||Xt===Ra||Xt===Bs||Xt===Uo||Xt===Of||Je.ext_srgb&&(Xt===kc||Xt===Na)?ht[Xt]=Xt:Xt===Pu||Tt.indexOf("rgba")>=0?ht[Xt]=Yo:ht[Xt]=Iu,ht},{});function wr(){this.internalformat=Yo,this.format=Yo,this.type=$l,this.compressed=!1,this.premultiplyAlpha=!1,this.flipY=!1,this.unpackAlignment=1,this.colorSpace=qs,this.width=0,this.height=0,this.channels=0}function en(ht,Tt){ht.internalformat=Tt.internalformat,ht.format=Tt.format,ht.type=Tt.type,ht.compressed=Tt.compressed,ht.premultiplyAlpha=Tt.premultiplyAlpha,ht.flipY=Tt.flipY,ht.unpackAlignment=Tt.unpackAlignment,ht.colorSpace=Tt.colorSpace,ht.width=Tt.width,ht.height=Tt.height,ht.channels=Tt.channels}function Nn(ht,Tt){if(!(typeof Tt!="object"||!Tt)){if("premultiplyAlpha"in Tt&&(te.type(Tt.premultiplyAlpha,"boolean","invalid premultiplyAlpha"),ht.premultiplyAlpha=Tt.premultiplyAlpha),"flipY"in Tt&&(te.type(Tt.flipY,"boolean","invalid texture flip"),ht.flipY=Tt.flipY),"alignment"in Tt&&(te.oneOf(Tt.alignment,[1,2,4,8],"invalid texture unpack alignment"),ht.unpackAlignment=Tt.alignment),"colorSpace"in Tt&&(te.parameter(Tt.colorSpace,Vr,"invalid colorSpace"),ht.colorSpace=Vr[Tt.colorSpace]),"type"in Tt){var Xt=Tt.type;te(Je.oes_texture_float||!(Xt==="float"||Xt==="float32"),"you must enable the OES_texture_float extension in order to use floating point textures."),te(Je.oes_texture_half_float||!(Xt==="half float"||Xt==="float16"),"you must enable the OES_texture_half_float extension in order to use 16-bit floating point textures."),te(Je.webgl_depth_texture||!(Xt==="uint16"||Xt==="uint32"||Xt==="depth stencil"),"you must enable the WEBGL_depth_texture extension in order to use depth/stencil textures."),te.parameter(Xt,Kr,"invalid texture type"),ht.type=Kr[Xt]}var xt=ht.width,di=ht.height,Da=ht.channels,Oe=!1;"shape"in Tt?(te(Array.isArray(Tt.shape)&&Tt.shape.length>=2,"shape must be an array"),xt=Tt.shape[0],di=Tt.shape[1],Tt.shape.length===3&&(Da=Tt.shape[2],te(Da>0&&Da<=4,"invalid number of channels"),Oe=!0),te(xt>=0&&xt<=Et.maxTextureSize,"invalid width"),te(di>=0&&di<=Et.maxTextureSize,"invalid height")):("radius"in Tt&&(xt=di=Tt.radius,te(xt>=0&&xt<=Et.maxTextureSize,"invalid radius")),"width"in Tt&&(xt=Tt.width,te(xt>=0&&xt<=Et.maxTextureSize,"invalid width")),"height"in Tt&&(di=Tt.height,te(di>=0&&di<=Et.maxTextureSize,"invalid height")),"channels"in Tt&&(Da=Tt.channels,te(Da>0&&Da<=4,"invalid number of channels"),Oe=!0)),ht.width=xt|0,ht.height=di|0,ht.channels=Da|0;var Ve=!1;if("format"in Tt){var ft=Tt.format;te(Je.webgl_depth_texture||!(ft==="depth"||ft==="depth stencil"),"you must enable the WEBGL_depth_texture extension in order to use depth/stencil textures."),te.parameter(ft,Dr,"invalid texture format");var $t=ht.internalformat=Dr[ft];ht.format=sn[$t],ft in Kr&&("type"in Tt||(ht.type=Kr[ft])),ft in jr&&(ht.compressed=!0),Ve=!0}!Oe&&Ve?ht.channels=ls[ht.format]:Oe&&!Ve?ht.channels!==fu[ht.format]&&(ht.format=ht.internalformat=fu[ht.channels]):Ve&&Oe&&te(ht.channels===ls[ht.format],"number of channels inconsistent with specified format")}}function hi(ht){Te.pixelStorei(Uc,ht.flipY),Te.pixelStorei(us,ht.premultiplyAlpha),Te.pixelStorei(ys,ht.colorSpace),Te.pixelStorei(Pl,ht.unpackAlignment)}function an(){wr.call(this),this.xOffset=0,this.yOffset=0,this.data=null,this.needsFree=!1,this.element=null,this.needsCopy=!1}function Zr(ht,Tt){var Xt=null;if(Ii(Tt)?Xt=Tt:Tt&&(te.type(Tt,"object","invalid pixel data type"),Nn(ht,Tt),"x"in Tt&&(ht.xOffset=Tt.x|0),"y"in Tt&&(ht.yOffset=Tt.y|0),Ii(Tt.data)&&(Xt=Tt.data)),te(!ht.compressed||Xt instanceof Uint8Array,"compressed texture data must be stored in a uint8array"),Tt.copy){te(!Xt,"can not specify copy and data field for the same texture");var xt=Er.viewportWidth,di=Er.viewportHeight;ht.width=ht.width||xt-ht.xOffset,ht.height=ht.height||di-ht.yOffset,ht.needsCopy=!0,te(ht.xOffset>=0&&ht.xOffset<xt&&ht.yOffset>=0&&ht.yOffset<di&&ht.width>0&&ht.width<=xt&&ht.height>0&&ht.height<=di,"copy texture read out of bounds")}else if(!Xt)ht.width=ht.width||1,ht.height=ht.height||1,ht.channels=ht.channels||4;else if(j(Xt))ht.channels=ht.channels||4,ht.data=Xt,!("type"in Tt)&&ht.type===$l&&(ht.type=xi(Xt));else if(cl(Xt))ht.channels=ht.channels||4,Un(ht,Xt),ht.alignment=1,ht.needsFree=!0;else if(Ka(Xt)){var Da=Xt.data;!Array.isArray(Da)&&ht.type===$l&&(ht.type=xi(Da));var Oe=Xt.shape,Ve=Xt.stride,ft,$t,tr,wt,Bt,Dt;Oe.length===3?(tr=Oe[2],Dt=Ve[2]):(te(Oe.length===2,"invalid ndarray pixel data, must be 2 or 3D"),tr=1,Dt=1),ft=Oe[0],$t=Oe[1],wt=Ve[0],Bt=Ve[1],ht.alignment=1,ht.width=ft,ht.height=$t,ht.channels=tr,ht.format=ht.internalformat=fu[tr],ht.needsFree=!0,fi(ht,Da,wt,Bt,Dt,Xt.offset)}else if(Bi(Xt)||Go(Xt)||qi(Xt))Bi(Xt)||Go(Xt)?ht.element=Xt:ht.element=Xt.canvas,ht.width=ht.element.width,ht.height=ht.element.height,ht.channels=4;else if(ni(Xt))ht.element=Xt,ht.width=Xt.width,ht.height=Xt.height,ht.channels=4;else if(Pi(Xt))ht.element=Xt,ht.width=Xt.naturalWidth,ht.height=Xt.naturalHeight,ht.channels=4;else if(oa(Xt))ht.element=Xt,ht.width=Xt.videoWidth,ht.height=Xt.videoHeight,ht.channels=4;else if(va(Xt)){var ut=ht.width||Xt[0].length,h=ht.height||Xt.length,f=ht.channels;Pa(Xt[0][0])?f=f||Xt[0][0].length:f=f||1;for(var d=Ye.shape(Xt),E=1,S=0;S<d.length;++S)E*=d[S];var M=ii(ht,E);Ye.flatten(Xt,d,"",M),ki(ht,M),ht.alignment=1,ht.width=ut,ht.height=h,ht.channels=f,ht.format=ht.internalformat=fu[f],ht.needsFree=!0}ht.type===Il?te(Et.extensions.indexOf("oes_texture_float")>=0,"oes_texture_float extension not enabled"):ht.type===Mo&&te(Et.extensions.indexOf("oes_texture_half_float")>=0,"oes_texture_half_float extension not enabled")}function Tr(ht,Tt,Xt){var xt=ht.element,di=ht.data,Da=ht.internalformat,Oe=ht.format,Ve=ht.type,ft=ht.width,$t=ht.height;hi(ht),xt?Te.texImage2D(Tt,Xt,Oe,Oe,Ve,xt):ht.compressed?Te.compressedTexImage2D(Tt,Xt,Da,ft,$t,0,di):ht.needsCopy?(sr(),Te.copyTexImage2D(Tt,Xt,Oe,ht.xOffset,ht.yOffset,ft,$t,0)):Te.texImage2D(Tt,Xt,Oe,ft,$t,0,Oe,Ve,di||null)}function ai(ht,Tt,Xt,xt,di){var Da=ht.element,Oe=ht.data,Ve=ht.internalformat,ft=ht.format,$t=ht.type,tr=ht.width,wt=ht.height;hi(ht),Da?Te.texSubImage2D(Tt,di,Xt,xt,ft,$t,Da):ht.compressed?Te.compressedTexSubImage2D(Tt,di,Xt,xt,Ve,tr,wt,Oe):ht.needsCopy?(sr(),Te.copyTexSubImage2D(Tt,di,Xt,xt,ht.xOffset,ht.yOffset,tr,wt)):Te.texSubImage2D(Tt,di,Xt,xt,tr,wt,ft,$t,Oe)}var Yn=[];function Pn(){return Yn.pop()||new an}function Di(ht){ht.needsFree&&Fa.freeType(ht.data),an.call(ht),Yn.push(ht)}function ei(){wr.call(this),this.genMipmaps=!1,this.mipmapHint=wo,this.mipmask=0,this.images=Array(16)}function qn(ht,Tt,Xt){var xt=ht.images[0]=Pn();ht.mipmask=1,xt.width=ht.width=Tt,xt.height=ht.height=Xt,xt.channels=ht.channels=4}function ga(ht,Tt){var Xt=null;if(Ii(Tt))Xt=ht.images[0]=Pn(),en(Xt,ht),Zr(Xt,Tt),ht.mipmask=1;else if(Nn(ht,Tt),Array.isArray(Tt.mipmap))for(var xt=Tt.mipmap,di=0;di<xt.length;++di)Xt=ht.images[di]=Pn(),en(Xt,ht),Xt.width>>=di,Xt.height>>=di,Zr(Xt,xt[di]),ht.mipmask|=1<<di;else Xt=ht.images[0]=Pn(),en(Xt,ht),Zr(Xt,Tt),ht.mipmask=1;en(ht,ht.images[0]),ht.compressed&&(ht.internalformat===Qs||ht.internalformat===os||ht.internalformat===ms||ht.internalformat===Nu)&&te(ht.width%4===0&&ht.height%4===0,"for compressed texture formats, mipmap level 0 must have width and height that are a multiple of 4")}function Oo(ht,Tt){for(var Xt=ht.images,xt=0;xt<Xt.length;++xt){if(!Xt[xt])return;Tr(Xt[xt],Tt,xt)}}var Wo=[];function Xi(){var ht=Wo.pop()||new ei;wr.call(ht),ht.mipmask=0;for(var Tt=0;Tt<16;++Tt)ht.images[Tt]=null;return ht}function Qo(ht){for(var Tt=ht.images,Xt=0;Xt<Tt.length;++Xt)Tt[Xt]&&Di(Tt[Xt]),Tt[Xt]=null;Wo.push(ht)}function eo(){this.minFilter=zo,this.magFilter=zo,this.wrapS=ul,this.wrapT=ul,this.anisotropic=1,this.genMipmaps=!1,this.mipmapHint=wo}function uo(ht,Tt){if("min"in Tt){var Xt=Tt.min;te.parameter(Xt,Br),ht.minFilter=Br[Xt],Nf.indexOf(ht.minFilter)>=0&&!("faces"in Tt)&&(ht.genMipmaps=!0)}if("mag"in Tt){var xt=Tt.mag;te.parameter(xt,qr),ht.magFilter=qr[xt]}var di=ht.wrapS,Da=ht.wrapT;if("wrap"in Tt){var Oe=Tt.wrap;typeof Oe=="string"?(te.parameter(Oe,Pr),di=Da=Pr[Oe]):Array.isArray(Oe)&&(te.parameter(Oe[0],Pr),te.parameter(Oe[1],Pr),di=Pr[Oe[0]],Da=Pr[Oe[1]])}else{if("wrapS"in Tt){var Ve=Tt.wrapS;te.parameter(Ve,Pr),di=Pr[Ve]}if("wrapT"in Tt){var ft=Tt.wrapT;te.parameter(ft,Pr),Da=Pr[ft]}}if(ht.wrapS=di,ht.wrapT=Da,"anisotropic"in Tt){var $t=Tt.anisotropic;te(typeof $t=="number"&&$t>=1&&$t<=Et.maxAnisotropic,"aniso samples must be between 1 and "),ht.anisotropic=Tt.anisotropic}if("mipmap"in Tt){var tr=!1;switch(typeof Tt.mipmap){case"string":te.parameter(Tt.mipmap,kr,"invalid mipmap hint"),ht.mipmapHint=kr[Tt.mipmap],ht.genMipmaps=!0,tr=!0;break;case"boolean":tr=ht.genMipmaps=Tt.mipmap;break;case"object":te(Array.isArray(Tt.mipmap),"invalid mipmap type"),ht.genMipmaps=!1,tr=!0;break;default:te.raise("invalid mipmap type")}tr&&!("min"in Tt)&&(ht.minFilter=ll)}}function No(ht,Tt){Te.texParameteri(Tt,Ql,ht.minFilter),Te.texParameteri(Tt,_s,ht.magFilter),Te.texParameteri(Tt,Ac,ht.wrapS),Te.texParameteri(Tt,Oh,ht.wrapT),Je.ext_texture_filter_anisotropic&&Te.texParameteri(Tt,X0,ht.anisotropic),ht.genMipmaps&&(Te.hint(Hu,ht.mipmapHint),Te.generateMipmap(Tt))}var qo=0,Ko={},Ns=Et.maxTextureUnits,hs=Array(Ns).map(function(){return null});function ti(ht){wr.call(this),this.mipmask=0,this.internalformat=Yo,this.id=qo++,this.refCount=1,this.target=ht,this.texture=Te.createTexture(),this.unit=-1,this.bindCount=0,this.texInfo=new eo,gr.profile&&(this.stats={size:0})}function to(ht){Te.activeTexture(Os),Te.bindTexture(ht.target,ht.texture)}function pn(){var ht=hs[0];ht?Te.bindTexture(ht.target,ht.texture):Te.bindTexture(ao,null)}function Mn(ht){var Tt=ht.texture;te(Tt,"must not double destroy texture");var Xt=ht.unit,xt=ht.target;Xt>=0&&(Te.activeTexture(Os+Xt),Te.bindTexture(xt,null),hs[Xt]=null),Te.deleteTexture(Tt),ht.texture=null,ht.params=null,ht.pixels=null,ht.refCount=0,delete Ko[ht.id],lr.textureCount--}C(ti.prototype,{bind:function(){var ht=this;ht.bindCount+=1;var Tt=ht.unit;if(Tt<0){for(var Xt=0;Xt<Ns;++Xt){var xt=hs[Xt];if(xt){if(xt.bindCount>0)continue;xt.unit=-1}hs[Xt]=ht,Tt=Xt;break}Tt>=Ns&&te.raise("insufficient number of texture units"),gr.profile&&lr.maxTextureUnits<Tt+1&&(lr.maxTextureUnits=Tt+1),ht.unit=Tt,Te.activeTexture(Os+Tt),Te.bindTexture(ht.target,ht.texture)}return Tt},unbind:function(){this.bindCount-=1},decRef:function(){--this.refCount<=0&&Mn(this)}});function vn(ht,Tt){var Xt=new ti(ao);Ko[Xt.id]=Xt,lr.textureCount++;function xt(Oe,Ve){var ft=Xt.texInfo;eo.call(ft);var $t=Xi();return typeof Oe=="number"?typeof Ve=="number"?qn($t,Oe|0,Ve|0):qn($t,Oe|0,Oe|0):Oe?(te.type(Oe,"object","invalid arguments to regl.texture"),uo(ft,Oe),ga($t,Oe)):qn($t,1,1),ft.genMipmaps&&($t.mipmask=($t.width<<1)-1),Xt.mipmask=$t.mipmask,en(Xt,$t),te.texture2D(ft,$t,Et),Xt.internalformat=$t.internalformat,xt.width=$t.width,xt.height=$t.height,to(Xt),Oo($t,ao),No(ft,ao),pn(),Qo($t),gr.profile&&(Xt.stats.size=Vi(Xt.internalformat,Xt.type,$t.width,$t.height,ft.genMipmaps,!1)),xt.format=Ur[Xt.internalformat],xt.type=Jr[Xt.type],xt.mag=Rr[ft.magFilter],xt.min=An[ft.minFilter],xt.wrapS=Fr[ft.wrapS],xt.wrapT=Fr[ft.wrapT],xt}function di(Oe,Ve,ft,$t){te(!!Oe,"must specify image data");var tr=Ve|0,wt=ft|0,Bt=$t|0,Dt=Pn();return en(Dt,Xt),Dt.width=0,Dt.height=0,Zr(Dt,Oe),Dt.width=Dt.width||(Xt.width>>Bt)-tr,Dt.height=Dt.height||(Xt.height>>Bt)-wt,te(Xt.type===Dt.type&&Xt.format===Dt.format&&Xt.internalformat===Dt.internalformat,"incompatible format for texture.subimage"),te(tr>=0&&wt>=0&&tr+Dt.width<=Xt.width&&wt+Dt.height<=Xt.height,"texture.subimage write out of bounds"),te(Xt.mipmask&1<<Bt,"missing mipmap data"),te(Dt.data||Dt.element||Dt.needsCopy,"missing image data"),to(Xt),ai(Dt,ao,tr,wt,Bt),pn(),Di(Dt),xt}function Da(Oe,Ve){var ft=Oe|0,$t=Ve|0||ft;if(ft===Xt.width&&$t===Xt.height)return xt;xt.width=Xt.width=ft,xt.height=Xt.height=$t,to(Xt);for(var tr=0;Xt.mipmask>>tr;++tr){var wt=ft>>tr,Bt=$t>>tr;if(!wt||!Bt)break;Te.texImage2D(ao,tr,Xt.format,wt,Bt,0,Xt.format,Xt.type,null)}return pn(),gr.profile&&(Xt.stats.size=Vi(Xt.internalformat,Xt.type,ft,$t,!1,!1)),xt}return xt(ht,Tt),xt.subimage=di,xt.resize=Da,xt._reglType="texture2d",xt._texture=Xt,gr.profile&&(xt.stats=Xt.stats),xt.destroy=function(){Xt.decRef()},xt}function si(ht,Tt,Xt,xt,di,Da){var Oe=new ti(Qf);Ko[Oe.id]=Oe,lr.cubeCount++;var Ve=new Array(6);function ft(wt,Bt,Dt,ut,h,f){var d,E=Oe.texInfo;for(eo.call(E),d=0;d<6;++d)Ve[d]=Xi();if(typeof wt=="number"||!wt){var S=wt|0||1;for(d=0;d<6;++d)qn(Ve[d],S,S)}else if(typeof wt=="object")if(Bt)ga(Ve[0],wt),ga(Ve[1],Bt),ga(Ve[2],Dt),ga(Ve[3],ut),ga(Ve[4],h),ga(Ve[5],f);else if(uo(E,wt),Nn(Oe,wt),"faces"in wt){var M=wt.faces;for(te(Array.isArray(M)&&M.length===6,"cube faces must be a length 6 array"),d=0;d<6;++d)te(typeof M[d]=="object"&&!!M[d],"invalid input for cube map face"),en(Ve[d],Oe),ga(Ve[d],M[d])}else for(d=0;d<6;++d)ga(Ve[d],wt);else te.raise("invalid arguments to cube map");for(en(Oe,Ve[0]),Et.npotTextureCube||te(ma(Oe.width)&&ma(Oe.height),"your browser does not support non power or two texture dimensions"),E.genMipmaps?Oe.mipmask=(Ve[0].width<<1)-1:Oe.mipmask=Ve[0].mipmask,te.textureCube(Oe,E,Ve,Et),Oe.internalformat=Ve[0].internalformat,ft.width=Ve[0].width,ft.height=Ve[0].height,to(Oe),d=0;d<6;++d)Oo(Ve[d],Ni+d);for(No(E,Qf),pn(),gr.profile&&(Oe.stats.size=Vi(Oe.internalformat,Oe.type,ft.width,ft.height,E.genMipmaps,!0)),ft.format=Ur[Oe.internalformat],ft.type=Jr[Oe.type],ft.mag=Rr[E.magFilter],ft.min=An[E.minFilter],ft.wrapS=Fr[E.wrapS],ft.wrapT=Fr[E.wrapT],d=0;d<6;++d)Qo(Ve[d]);return ft}function $t(wt,Bt,Dt,ut,h){te(!!Bt,"must specify image data"),te(typeof wt=="number"&&wt===(wt|0)&&wt>=0&&wt<6,"invalid face");var f=Dt|0,d=ut|0,E=h|0,S=Pn();return en(S,Oe),S.width=0,S.height=0,Zr(S,Bt),S.width=S.width||(Oe.width>>E)-f,S.height=S.height||(Oe.height>>E)-d,te(Oe.type===S.type&&Oe.format===S.format&&Oe.internalformat===S.internalformat,"incompatible format for texture.subimage"),te(f>=0&&d>=0&&f+S.width<=Oe.width&&d+S.height<=Oe.height,"texture.subimage write out of bounds"),te(Oe.mipmask&1<<E,"missing mipmap data"),te(S.data||S.element||S.needsCopy,"missing image data"),to(Oe),ai(S,Ni+wt,f,d,E),pn(),Di(S),ft}function tr(wt){var Bt=wt|0;if(Bt!==Oe.width){ft.width=Oe.width=Bt,ft.height=Oe.height=Bt,to(Oe);for(var Dt=0;Dt<6;++Dt)for(var ut=0;Oe.mipmask>>ut;++ut)Te.texImage2D(Ni+Dt,ut,Oe.format,Bt>>ut,Bt>>ut,0,Oe.format,Oe.type,null);return pn(),gr.profile&&(Oe.stats.size=Vi(Oe.internalformat,Oe.type,ft.width,ft.height,!1,!0)),ft}}return ft(ht,Tt,Xt,xt,di,Da),ft.subimage=$t,ft.resize=tr,ft._reglType="textureCube",ft._texture=Oe,gr.profile&&(ft.stats=Oe.stats),ft.destroy=function(){Oe.decRef()},ft}function go(){for(var ht=0;ht<Ns;++ht)Te.activeTexture(Os+ht),Te.bindTexture(ao,null),hs[ht]=null;bt(Ko).forEach(Mn),lr.cubeCount=0,lr.textureCount=0}gr.profile&&(lr.getTotalTextureSize=function(){var ht=0;return Object.keys(Ko).forEach(function(Tt){ht+=Ko[Tt].stats.size}),ht});function pl(){for(var ht=0;ht<Ns;++ht){var Tt=hs[ht];Tt&&(Tt.bindCount=0,Tt.unit=-1,hs[ht]=null)}bt(Ko).forEach(function(Xt){Xt.texture=Te.createTexture(),Te.bindTexture(Xt.target,Xt.texture);for(var xt=0;xt<32;++xt)if(Xt.mipmask&1<<xt)if(Xt.target===ao)Te.texImage2D(ao,xt,Xt.internalformat,Xt.width>>xt,Xt.height>>xt,0,Xt.internalformat,Xt.type,null);else for(var di=0;di<6;++di)Te.texImage2D(Ni+di,xt,Xt.internalformat,Xt.width>>xt,Xt.height>>xt,0,Xt.internalformat,Xt.type,null);No(Xt.texInfo,Xt.target)})}return{create2D:vn,createCube:si,clear:go,getTexture:function(ht){return null},restore:pl}}var Dn=36161,Hi=32854,yi=32855,na=36194,Wi=33189,ua=36168,la=34041,Ti=35907,Ui=34836,Zi=34842,ia=34843,Vn=[];Vn[Hi]=2,Vn[yi]=2,Vn[na]=2,Vn[Wi]=2,Vn[ua]=1,Vn[la]=4,Vn[Ti]=4,Vn[Ui]=16,Vn[Zi]=8,Vn[ia]=6;function ju(Te,Je,Et){return Vn[Te]*Je*Et}var ql=function(Te,Je,Et,sr,Er){var lr={rgba4:Hi,rgb565:na,"rgb5 a1":yi,depth:Wi,stencil:ua,"depth stencil":la};Je.ext_srgb&&(lr.srgba=Ti),Je.ext_color_buffer_half_float&&(lr.rgba16f=Zi,lr.rgb16f=ia),Je.webgl_color_buffer_float&&(lr.rgba32f=Ui);var gr=[];Object.keys(lr).forEach(function(Dr){var jr=lr[Dr];gr[jr]=Dr});var kr=0,Pr={};function qr(Dr){this.id=kr++,this.refCount=1,this.renderbuffer=Dr,this.format=Hi,this.width=0,this.height=0,Er.profile&&(this.stats={size:0})}qr.prototype.decRef=function(){--this.refCount<=0&&Br(this)};function Br(Dr){var jr=Dr.renderbuffer;te(jr,"must not double destroy renderbuffer"),Te.bindRenderbuffer(Dn,null),Te.deleteRenderbuffer(jr),Dr.renderbuffer=null,Dr.refCount=0,delete Pr[Dr.id],sr.renderbufferCount--}function Vr(Dr,jr){var jt=new qr(Te.createRenderbuffer());Pr[jt.id]=jt,sr.renderbufferCount++;function Ar(Jr,Rr){var An=0,Fr=0,sn=Hi;if(typeof Jr=="object"&&Jr){var wr=Jr;if("shape"in wr){var en=wr.shape;te(Array.isArray(en)&&en.length>=2,"invalid renderbuffer shape"),An=en[0]|0,Fr=en[1]|0}else"radius"in wr&&(An=Fr=wr.radius|0),"width"in wr&&(An=wr.width|0),"height"in wr&&(Fr=wr.height|0);"format"in wr&&(te.parameter(wr.format,lr,"invalid renderbuffer format"),sn=lr[wr.format])}else typeof Jr=="number"?(An=Jr|0,typeof Rr=="number"?Fr=Rr|0:Fr=An):Jr?te.raise("invalid arguments to renderbuffer constructor"):An=Fr=1;if(te(An>0&&Fr>0&&An<=Et.maxRenderbufferSize&&Fr<=Et.maxRenderbufferSize,"invalid renderbuffer size"),!(An===jt.width&&Fr===jt.height&&sn===jt.format))return Ar.width=jt.width=An,Ar.height=jt.height=Fr,jt.format=sn,Te.bindRenderbuffer(Dn,jt.renderbuffer),Te.renderbufferStorage(Dn,sn,An,Fr),te(Te.getError()===0,"invalid render buffer format"),Er.profile&&(jt.stats.size=ju(jt.format,jt.width,jt.height)),Ar.format=gr[jt.format],Ar}function Ur(Jr,Rr){var An=Jr|0,Fr=Rr|0||An;return An===jt.width&&Fr===jt.height||(te(An>0&&Fr>0&&An<=Et.maxRenderbufferSize&&Fr<=Et.maxRenderbufferSize,"invalid renderbuffer size"),Ar.width=jt.width=An,Ar.height=jt.height=Fr,Te.bindRenderbuffer(Dn,jt.renderbuffer),Te.renderbufferStorage(Dn,jt.format,An,Fr),te(Te.getError()===0,"invalid render buffer format"),Er.profile&&(jt.stats.size=ju(jt.format,jt.width,jt.height))),Ar}return Ar(Dr,jr),Ar.resize=Ur,Ar._reglType="renderbuffer",Ar._renderbuffer=jt,Er.profile&&(Ar.stats=jt.stats),Ar.destroy=function(){jt.decRef()},Ar}Er.profile&&(sr.getTotalRenderbufferSize=function(){var Dr=0;return Object.keys(Pr).forEach(function(jr){Dr+=Pr[jr].stats.size}),Dr});function Kr(){bt(Pr).forEach(function(Dr){Dr.renderbuffer=Te.createRenderbuffer(),Te.bindRenderbuffer(Dn,Dr.renderbuffer),Te.renderbufferStorage(Dn,Dr.format,Dr.width,Dr.height)}),Te.bindRenderbuffer(Dn,null)}return{create:Vr,clear:function(){bt(Pr).forEach(Br)},restore:Kr}},Us=36160,Lu=36161,Qn=3553,cs=34069,Ol=36064,fl=36096,Zs=36128,Kl=33306,zs=36053,$a=36054,Jl=36055,Df=36057,o=36061,u=36193,v=5121,y=5126,b=6407,H=6408,ne=6402,Le=[b,H],tt=[];tt[H]=4,tt[b]=3;var Nt=[];Nt[v]=1,Nt[y]=4,Nt[u]=2;var ar=32854,st=32855,Gt=36194,ir=33189,br=36168,g=34041,Bn=35907,Jn=34836,et=34842,Za=34843,Eo=[ar,st,Gt,Bn,et,Za,Jn],oo={};oo[zs]="complete",oo[$a]="incomplete attachment",oo[Df]="incomplete dimensions",oo[Jl]="incomplete, missing attachment",oo[o]="unsupported";function xa(Te,Je,Et,sr,Er,lr){var gr={cur:null,next:null,dirty:!1,setFBO:null},kr=["rgba"],Pr=["rgba4","rgb565","rgb5 a1"];Je.ext_srgb&&Pr.push("srgba"),Je.ext_color_buffer_half_float&&Pr.push("rgba16f","rgb16f"),Je.webgl_color_buffer_float&&Pr.push("rgba32f");var qr=["uint8"];Je.oes_texture_half_float&&qr.push("half float","float16"),Je.oes_texture_float&&qr.push("float","float32");function Br(an,Zr,Tr){this.target=an,this.texture=Zr,this.renderbuffer=Tr;var ai=0,Yn=0;Zr?(ai=Zr.width,Yn=Zr.height):Tr&&(ai=Tr.width,Yn=Tr.height),this.width=ai,this.height=Yn}function Vr(an){an&&(an.texture&&an.texture._texture.decRef(),an.renderbuffer&&an.renderbuffer._renderbuffer.decRef())}function Kr(an,Zr,Tr){if(an)if(an.texture){var ai=an.texture._texture,Yn=Math.max(1,ai.width),Pn=Math.max(1,ai.height);te(Yn===Zr&&Pn===Tr,"inconsistent width/height for supplied texture"),ai.refCount+=1}else{var Di=an.renderbuffer._renderbuffer;te(Di.width===Zr&&Di.height===Tr,"inconsistent width/height for renderbuffer"),Di.refCount+=1}}function Dr(an,Zr){Zr&&(Zr.texture?Te.framebufferTexture2D(Us,an,Zr.target,Zr.texture._texture.texture,0):Te.framebufferRenderbuffer(Us,an,Lu,Zr.renderbuffer._renderbuffer.renderbuffer))}function jr(an){var Zr=Qn,Tr=null,ai=null,Yn=an;typeof an=="object"&&(Yn=an.data,"target"in an&&(Zr=an.target|0)),te.type(Yn,"function","invalid attachment data");var Pn=Yn._reglType;return Pn==="texture2d"?(Tr=Yn,te(Zr===Qn)):Pn==="textureCube"?(Tr=Yn,te(Zr>=cs&&Zr<cs+6,"invalid cube map target")):Pn==="renderbuffer"?(ai=Yn,Zr=Lu):te.raise("invalid regl object for attachment"),new Br(Zr,Tr,ai)}function jt(an,Zr,Tr,ai,Yn){if(Tr){var Pn=sr.create2D({width:an,height:Zr,format:ai,type:Yn});return Pn._texture.refCount=0,new Br(Qn,Pn,null)}else{var Di=Er.create({width:an,height:Zr,format:ai});return Di._renderbuffer.refCount=0,new Br(Lu,null,Di)}}function Ar(an){return an&&(an.texture||an.renderbuffer)}function Ur(an,Zr,Tr){an&&(an.texture?an.texture.resize(Zr,Tr):an.renderbuffer&&an.renderbuffer.resize(Zr,Tr),an.width=Zr,an.height=Tr)}var Jr=0,Rr={};function An(){this.id=Jr++,Rr[this.id]=this,this.framebuffer=Te.createFramebuffer(),this.width=0,this.height=0,this.colorAttachments=[],this.depthAttachment=null,this.stencilAttachment=null,this.depthStencilAttachment=null}function Fr(an){an.colorAttachments.forEach(Vr),Vr(an.depthAttachment),Vr(an.stencilAttachment),Vr(an.depthStencilAttachment)}function sn(an){var Zr=an.framebuffer;te(Zr,"must not double destroy framebuffer"),Te.deleteFramebuffer(Zr),an.framebuffer=null,lr.framebufferCount--,delete Rr[an.id]}function wr(an){var Zr;Te.bindFramebuffer(Us,an.framebuffer);var Tr=an.colorAttachments;for(Zr=0;Zr<Tr.length;++Zr)Dr(Ol+Zr,Tr[Zr]);for(Zr=Tr.length;Zr<Et.maxColorAttachments;++Zr)Te.framebufferTexture2D(Us,Ol+Zr,Qn,null,0);Te.framebufferTexture2D(Us,Kl,Qn,null,0),Te.framebufferTexture2D(Us,fl,Qn,null,0),Te.framebufferTexture2D(Us,Zs,Qn,null,0),Dr(fl,an.depthAttachment),Dr(Zs,an.stencilAttachment),Dr(Kl,an.depthStencilAttachment);var ai=Te.checkFramebufferStatus(Us);!Te.isContextLost()&&ai!==zs&&te.raise("framebuffer configuration not supported, status = "+oo[ai]),Te.bindFramebuffer(Us,gr.next?gr.next.framebuffer:null),gr.cur=gr.next,Te.getError()}function en(an,Zr){var Tr=new An;lr.framebufferCount++;function ai(Pn,Di){var ei;te(gr.next!==Tr,"can not update framebuffer which is currently in use");var qn=0,ga=0,Oo=!0,Wo=!0,Xi=null,Qo=!0,eo="rgba",uo="uint8",No=1,qo=null,Ko=null,Ns=null,hs=!1;if(typeof Pn=="number")qn=Pn|0,ga=Di|0||qn;else if(!Pn)qn=ga=1;else{te.type(Pn,"object","invalid arguments for framebuffer");var ti=Pn;if("shape"in ti){var to=ti.shape;te(Array.isArray(to)&&to.length>=2,"invalid shape for framebuffer"),qn=to[0],ga=to[1]}else"radius"in ti&&(qn=ga=ti.radius),"width"in ti&&(qn=ti.width),"height"in ti&&(ga=ti.height);("color"in ti||"colors"in ti)&&(Xi=ti.color||ti.colors,Array.isArray(Xi)&&te(Xi.length===1||Je.webgl_draw_buffers,"multiple render targets not supported")),Xi||("colorCount"in ti&&(No=ti.colorCount|0,te(No>0,"invalid color buffer count")),"colorTexture"in ti&&(Qo=!!ti.colorTexture,eo="rgba4"),"colorType"in ti&&(uo=ti.colorType,Qo?(te(Je.oes_texture_float||!(uo==="float"||uo==="float32"),"you must enable OES_texture_float in order to use floating point framebuffer objects"),te(Je.oes_texture_half_float||!(uo==="half float"||uo==="float16"),"you must enable OES_texture_half_float in order to use 16-bit floating point framebuffer objects")):uo==="half float"||uo==="float16"?(te(Je.ext_color_buffer_half_float,"you must enable EXT_color_buffer_half_float to use 16-bit render buffers"),eo="rgba16f"):(uo==="float"||uo==="float32")&&(te(Je.webgl_color_buffer_float,"you must enable WEBGL_color_buffer_float in order to use 32-bit floating point renderbuffers"),eo="rgba32f"),te.oneOf(uo,qr,"invalid color type")),"colorFormat"in ti&&(eo=ti.colorFormat,kr.indexOf(eo)>=0?Qo=!0:Pr.indexOf(eo)>=0?Qo=!1:Qo?te.oneOf(ti.colorFormat,kr,"invalid color format for texture"):te.oneOf(ti.colorFormat,Pr,"invalid color format for renderbuffer"))),("depthTexture"in ti||"depthStencilTexture"in ti)&&(hs=!!(ti.depthTexture||ti.depthStencilTexture),te(!hs||Je.webgl_depth_texture,"webgl_depth_texture extension not supported")),"depth"in ti&&(typeof ti.depth=="boolean"?Oo=ti.depth:(qo=ti.depth,Wo=!1)),"stencil"in ti&&(typeof ti.stencil=="boolean"?Wo=ti.stencil:(Ko=ti.stencil,Oo=!1)),"depthStencil"in ti&&(typeof ti.depthStencil=="boolean"?Oo=Wo=ti.depthStencil:(Ns=ti.depthStencil,Oo=!1,Wo=!1))}var pn=null,Mn=null,vn=null,si=null;if(Array.isArray(Xi))pn=Xi.map(jr);else if(Xi)pn=[jr(Xi)];else for(pn=new Array(No),ei=0;ei<No;++ei)pn[ei]=jt(qn,ga,Qo,eo,uo);te(Je.webgl_draw_buffers||pn.length<=1,"you must enable the WEBGL_draw_buffers extension in order to use multiple color buffers."),te(pn.length<=Et.maxColorAttachments,"too many color attachments, not supported"),qn=qn||pn[0].width,ga=ga||pn[0].height,qo?Mn=jr(qo):Oo&&!Wo&&(Mn=jt(qn,ga,hs,"depth","uint32")),Ko?vn=jr(Ko):Wo&&!Oo&&(vn=jt(qn,ga,!1,"stencil","uint8")),Ns?si=jr(Ns):!qo&&!Ko&&Wo&&Oo&&(si=jt(qn,ga,hs,"depth stencil","depth stencil")),te(!!qo+!!Ko+!!Ns<=1,"invalid framebuffer configuration, can specify exactly one depth/stencil attachment");var go=null;for(ei=0;ei<pn.length;++ei)if(Kr(pn[ei],qn,ga),te(!pn[ei]||pn[ei].texture&&Le.indexOf(pn[ei].texture._texture.format)>=0||pn[ei].renderbuffer&&Eo.indexOf(pn[ei].renderbuffer._renderbuffer.format)>=0,"framebuffer color attachment "+ei+" is invalid"),pn[ei]&&pn[ei].texture){var pl=tt[pn[ei].texture._texture.format]*Nt[pn[ei].texture._texture.type];go===null?go=pl:te(go===pl,"all color attachments much have the same number of bits per pixel.")}return Kr(Mn,qn,ga),te(!Mn||Mn.texture&&Mn.texture._texture.format===ne||Mn.renderbuffer&&Mn.renderbuffer._renderbuffer.format===ir,"invalid depth attachment for framebuffer object"),Kr(vn,qn,ga),te(!vn||vn.renderbuffer&&vn.renderbuffer._renderbuffer.format===br,"invalid stencil attachment for framebuffer object"),Kr(si,qn,ga),te(!si||si.texture&&si.texture._texture.format===g||si.renderbuffer&&si.renderbuffer._renderbuffer.format===g,"invalid depth-stencil attachment for framebuffer object"),Fr(Tr),Tr.width=qn,Tr.height=ga,Tr.colorAttachments=pn,Tr.depthAttachment=Mn,Tr.stencilAttachment=vn,Tr.depthStencilAttachment=si,ai.color=pn.map(Ar),ai.depth=Ar(Mn),ai.stencil=Ar(vn),ai.depthStencil=Ar(si),ai.width=Tr.width,ai.height=Tr.height,wr(Tr),ai}function Yn(Pn,Di){te(gr.next!==Tr,"can not resize a framebuffer which is currently in use");var ei=Math.max(Pn|0,1),qn=Math.max(Di|0||ei,1);if(ei===Tr.width&&qn===Tr.height)return ai;for(var ga=Tr.colorAttachments,Oo=0;Oo<ga.length;++Oo)Ur(ga[Oo],ei,qn);return Ur(Tr.depthAttachment,ei,qn),Ur(Tr.stencilAttachment,ei,qn),Ur(Tr.depthStencilAttachment,ei,qn),Tr.width=ai.width=ei,Tr.height=ai.height=qn,wr(Tr),ai}return ai(an,Zr),C(ai,{resize:Yn,_reglType:"framebuffer",_framebuffer:Tr,destroy:function(){sn(Tr),Fr(Tr)},use:function(Pn){gr.setFBO({framebuffer:ai},Pn)}})}function Nn(an){var Zr=Array(6);function Tr(Yn){var Pn;te(Zr.indexOf(gr.next)<0,"can not update framebuffer which is currently in use");var Di={color:null},ei=0,qn=null,ga="rgba",Oo="uint8",Wo=1;if(typeof Yn=="number")ei=Yn|0;else if(!Yn)ei=1;else{te.type(Yn,"object","invalid arguments for framebuffer");var Xi=Yn;if("shape"in Xi){var Qo=Xi.shape;te(Array.isArray(Qo)&&Qo.length>=2,"invalid shape for framebuffer"),te(Qo[0]===Qo[1],"cube framebuffer must be square"),ei=Qo[0]}else"radius"in Xi&&(ei=Xi.radius|0),"width"in Xi?(ei=Xi.width|0,"height"in Xi&&te(Xi.height===ei,"must be square")):"height"in Xi&&(ei=Xi.height|0);("color"in Xi||"colors"in Xi)&&(qn=Xi.color||Xi.colors,Array.isArray(qn)&&te(qn.length===1||Je.webgl_draw_buffers,"multiple render targets not supported")),qn||("colorCount"in Xi&&(Wo=Xi.colorCount|0,te(Wo>0,"invalid color buffer count")),"colorType"in Xi&&(te.oneOf(Xi.colorType,qr,"invalid color type"),Oo=Xi.colorType),"colorFormat"in Xi&&(ga=Xi.colorFormat,te.oneOf(Xi.colorFormat,kr,"invalid color format for texture"))),"depth"in Xi&&(Di.depth=Xi.depth),"stencil"in Xi&&(Di.stencil=Xi.stencil),"depthStencil"in Xi&&(Di.depthStencil=Xi.depthStencil)}var eo;if(qn)if(Array.isArray(qn))for(eo=[],Pn=0;Pn<qn.length;++Pn)eo[Pn]=qn[Pn];else eo=[qn];else{eo=Array(Wo);var uo={radius:ei,format:ga,type:Oo};for(Pn=0;Pn<Wo;++Pn)eo[Pn]=sr.createCube(uo)}for(Di.color=Array(eo.length),Pn=0;Pn<eo.length;++Pn){var No=eo[Pn];te(typeof No=="function"&&No._reglType==="textureCube","invalid cube map"),ei=ei||No.width,te(No.width===ei&&No.height===ei,"invalid cube map shape"),Di.color[Pn]={target:cs,data:eo[Pn]}}for(Pn=0;Pn<6;++Pn){for(var qo=0;qo<eo.length;++qo)Di.color[qo].target=cs+Pn;Pn>0&&(Di.depth=Zr[0].depth,Di.stencil=Zr[0].stencil,Di.depthStencil=Zr[0].depthStencil),Zr[Pn]?Zr[Pn](Di):Zr[Pn]=en(Di)}return C(Tr,{width:ei,height:ei,color:eo})}function ai(Yn){var Pn,Di=Yn|0;if(te(Di>0&&Di<=Et.maxCubeMapSize,"invalid radius for cube fbo"),Di===Tr.width)return Tr;var ei=Tr.color;for(Pn=0;Pn<ei.length;++Pn)ei[Pn].resize(Di);for(Pn=0;Pn<6;++Pn)Zr[Pn].resize(Di);return Tr.width=Tr.height=Di,Tr}return Tr(an),C(Tr,{faces:Zr,resize:ai,_reglType:"framebufferCube",destroy:function(){Zr.forEach(function(Yn){Yn.destroy()})}})}function hi(){gr.cur=null,gr.next=null,gr.dirty=!0,bt(Rr).forEach(function(an){an.framebuffer=Te.createFramebuffer(),wr(an)})}return C(gr,{getFramebuffer:function(an){if(typeof an=="function"&&an._reglType==="framebuffer"){var Zr=an._framebuffer;if(Zr instanceof An)return Zr}return null},create:en,createCube:Nn,clear:function(){bt(Rr).forEach(sn)},restore:hi})}var vo=5126,Es=34962;function Ma(){this.state=0,this.x=0,this.y=0,this.z=0,this.w=0,this.buffer=null,this.size=0,this.normalized=!1,this.type=vo,this.offset=0,this.stride=0,this.divisor=0}function Yr(Te,Je,Et,sr,Er){for(var lr=Et.maxAttributes,gr=new Array(lr),kr=0;kr<lr;++kr)gr[kr]=new Ma;var Pr=0,qr={},Br={Record:Ma,scope:{},state:gr,currentVAO:null,targetVAO:null,restore:Kr()?Rr:function(){},createVAO:An,getVAO:jr,destroyBuffer:Vr,setVAO:Kr()?jt:Ar,clear:Kr()?Ur:function(){}};function Vr(Fr){for(var sn=0;sn<gr.length;++sn){var wr=gr[sn];wr.buffer===Fr&&(Te.disableVertexAttribArray(sn),wr.buffer=null)}}function Kr(){return Je.oes_vertex_array_object}function Dr(){return Je.angle_instanced_arrays}function jr(Fr){return typeof Fr=="function"&&Fr._vao?Fr._vao:null}function jt(Fr){if(Fr!==Br.currentVAO){var sn=Kr();Fr?sn.bindVertexArrayOES(Fr.vao):sn.bindVertexArrayOES(null),Br.currentVAO=Fr}}function Ar(Fr){if(Fr!==Br.currentVAO){if(Fr)Fr.bindAttrs();else for(var sn=Dr(),wr=0;wr<gr.length;++wr){var en=gr[wr];en.buffer?(Te.enableVertexAttribArray(wr),Te.vertexAttribPointer(wr,en.size,en.type,en.normalized,en.stride,en.offfset),sn&&sn.vertexAttribDivisorANGLE(wr,en.divisor)):(Te.disableVertexAttribArray(wr),Te.vertexAttrib4f(wr,en.x,en.y,en.z,en.w))}Br.currentVAO=Fr}}function Ur(){bt(qr).forEach(function(Fr){Fr.destroy()})}function Jr(){this.id=++Pr,this.attributes=[];var Fr=Kr();Fr?this.vao=Fr.createVertexArrayOES():this.vao=null,qr[this.id]=this,this.buffers=[]}Jr.prototype.bindAttrs=function(){for(var Fr=Dr(),sn=this.attributes,wr=0;wr<sn.length;++wr){var en=sn[wr];en.buffer?(Te.enableVertexAttribArray(wr),Te.bindBuffer(Es,en.buffer.buffer),Te.vertexAttribPointer(wr,en.size,en.type,en.normalized,en.stride,en.offset),Fr&&Fr.vertexAttribDivisorANGLE(wr,en.divisor)):(Te.disableVertexAttribArray(wr),Te.vertexAttrib4f(wr,en.x,en.y,en.z,en.w))}for(var Nn=sn.length;Nn<lr;++Nn)Te.disableVertexAttribArray(Nn)},Jr.prototype.refresh=function(){var Fr=Kr();Fr&&(Fr.bindVertexArrayOES(this.vao),this.bindAttrs(),Br.currentVAO=this)},Jr.prototype.destroy=function(){if(this.vao){var Fr=Kr();this===Br.currentVAO&&(Br.currentVAO=null,Fr.bindVertexArrayOES(null)),Fr.deleteVertexArrayOES(this.vao),this.vao=null}qr[this.id]&&(delete qr[this.id],sr.vaoCount-=1)};function Rr(){var Fr=Kr();Fr&&bt(qr).forEach(function(sn){sn.refresh()})}function An(Fr){var sn=new Jr;sr.vaoCount+=1;function wr(en){te(Array.isArray(en),"arguments to vertex array constructor must be an array"),te(en.length<lr,"too many attributes"),te(en.length>0,"must specify at least one attribute");for(var Nn=0;Nn<sn.buffers.length;++Nn)sn.buffers[Nn].destroy();sn.buffers.length=0;var hi=sn.attributes;hi.length=en.length;for(var an=0;an<en.length;++an){var Zr=en[an],Tr=hi[an]=new Ma;if(Array.isArray(Zr)||j(Zr)||Ka(Zr)){var ai=Er.create(Zr,Es,!1,!0);Tr.buffer=Er.getBuffer(ai),Tr.size=Tr.buffer.dimension|0,Tr.normalized=!1,Tr.type=Tr.buffer.dtype,Tr.offset=0,Tr.stride=0,Tr.divisor=0,Tr.state=1,sn.buffers.push(ai)}else Er.getBuffer(Zr)?(Tr.buffer=Er.getBuffer(Zr),Tr.size=Tr.buffer.dimension|0,Tr.normalized=!1,Tr.type=Tr.buffer.dtype,Tr.offset=0,Tr.stride=0,Tr.divisor=0,Tr.state=1):Er.getBuffer(Zr.buffer)?(Tr.buffer=Er.getBuffer(Zr.buffer),Tr.size=(+Zr.size||Tr.buffer.dimension)|0,Tr.normalized=!!Zr.normalized||!1,"type"in Zr?(te.parameter(Zr.type,ca,"invalid buffer type"),Tr.type=ca[Zr.type]):Tr.type=Tr.buffer.dtype,Tr.offset=(Zr.offset||0)|0,Tr.stride=(Zr.stride||0)|0,Tr.divisor=(Zr.divisor||0)|0,Tr.state=1,te(Tr.size>=1&&Tr.size<=4,"size must be between 1 and 4"),te(Tr.offset>=0,"invalid offset"),te(Tr.stride>=0&&Tr.stride<=255,"stride must be between 0 and 255"),te(Tr.divisor>=0,"divisor must be positive"),te(!Tr.divisor||!!Je.angle_instanced_arrays,"ANGLE_instanced_arrays must be enabled to use divisor")):"x"in Zr?(te(an>0,"first attribute must not be a constant"),Tr.x=+Zr.x||0,Tr.y=+Zr.y||0,Tr.z=+Zr.z||0,Tr.w=+Zr.w||0,Tr.state=2):te(!1,"invalid attribute spec for location "+an)}return sn.refresh(),wr}return wr.destroy=function(){sn.destroy()},wr._vao=sn,wr._reglType="vao",wr(Fr)}return Br}var _n=35632,ri=35633,Hn=35718,oi=35721;function Zn(Te,Je,Et,sr){var Er={},lr={};function gr(jt,Ar,Ur,Jr){this.name=jt,this.id=Ar,this.location=Ur,this.info=Jr}function kr(jt,Ar){for(var Ur=0;Ur<jt.length;++Ur)if(jt[Ur].id===Ar.id){jt[Ur].location=Ar.location;return}jt.push(Ar)}function Pr(jt,Ar,Ur){var Jr=jt===_n?Er:lr,Rr=Jr[Ar];if(!Rr){var An=Je.str(Ar);Rr=Te.createShader(jt),Te.shaderSource(Rr,An),Te.compileShader(Rr),te.shaderError(Te,Rr,An,jt,Ur),Jr[Ar]=Rr}return Rr}var qr={},Br=[],Vr=0;function Kr(jt,Ar){this.id=Vr++,this.fragId=jt,this.vertId=Ar,this.program=null,this.uniforms=[],this.attributes=[],sr.profile&&(this.stats={uniformsCount:0,attributesCount:0})}function Dr(jt,Ar,Ur){var Jr,Rr,An=Pr(_n,jt.fragId),Fr=Pr(ri,jt.vertId),sn=jt.program=Te.createProgram();if(Te.attachShader(sn,An),Te.attachShader(sn,Fr),Ur)for(Jr=0;Jr<Ur.length;++Jr){var wr=Ur[Jr];Te.bindAttribLocation(sn,wr[0],wr[1])}Te.linkProgram(sn),te.linkError(Te,sn,Je.str(jt.fragId),Je.str(jt.vertId),Ar);var en=Te.getProgramParameter(sn,Hn);sr.profile&&(jt.stats.uniformsCount=en);var Nn=jt.uniforms;for(Jr=0;Jr<en;++Jr)if(Rr=Te.getActiveUniform(sn,Jr),Rr)if(Rr.size>1)for(var hi=0;hi<Rr.size;++hi){var an=Rr.name.replace("[0]","["+hi+"]");kr(Nn,new gr(an,Je.id(an),Te.getUniformLocation(sn,an),Rr))}else kr(Nn,new gr(Rr.name,Je.id(Rr.name),Te.getUniformLocation(sn,Rr.name),Rr));var Zr=Te.getProgramParameter(sn,oi);sr.profile&&(jt.stats.attributesCount=Zr);var Tr=jt.attributes;for(Jr=0;Jr<Zr;++Jr)Rr=Te.getActiveAttrib(sn,Jr),Rr&&kr(Tr,new gr(Rr.name,Je.id(Rr.name),Te.getAttribLocation(sn,Rr.name),Rr))}sr.profile&&(Et.getMaxUniformsCount=function(){var jt=0;return Br.forEach(function(Ar){Ar.stats.uniformsCount>jt&&(jt=Ar.stats.uniformsCount)}),jt},Et.getMaxAttributesCount=function(){var jt=0;return Br.forEach(function(Ar){Ar.stats.attributesCount>jt&&(jt=Ar.stats.attributesCount)}),jt});function jr(){Er={},lr={};for(var jt=0;jt<Br.length;++jt)Dr(Br[jt],null,Br[jt].attributes.map(function(Ar){return[Ar.location,Ar.name]}))}return{clear:function(){var jt=Te.deleteShader.bind(Te);bt(Er).forEach(jt),Er={},bt(lr).forEach(jt),lr={},Br.forEach(function(Ar){Te.deleteProgram(Ar.program)}),Br.length=0,qr={},Et.shaderCount=0},program:function(jt,Ar,Ur,Jr){te.command(jt>=0,"missing vertex shader",Ur),te.command(Ar>=0,"missing fragment shader",Ur);var Rr=qr[Ar];Rr||(Rr=qr[Ar]={});var An=Rr[jt];if(An&&!Jr)return An;var Fr=new Kr(Ar,jt);return Et.shaderCount++,Dr(Fr,Ur,Jr),An||(Rr[jt]=Fr),Br.push(Fr),Fr},restore:jr,shader:Pr,frag:-1,vert:-1}}var Ki=6408,Ci=5121,gn=3333,je=5126;function Nl(Te,Je,Et,sr,Er,lr,gr){function kr(Br){var Vr;Je.next===null?(te(Er.preserveDrawingBuffer,'you must create a webgl context with "preserveDrawingBuffer":true in order to read pixels from the drawing buffer'),Vr=Ci):(te(Je.next.colorAttachments[0].texture!==null,"You cannot read from a renderbuffer"),Vr=Je.next.colorAttachments[0].texture._texture.type,lr.oes_texture_float?(te(Vr===Ci||Vr===je,"Reading from a framebuffer is only allowed for the types 'uint8' and 'float'"),Vr===je&&te(gr.readFloat,"Reading 'float' values is not permitted in your browser. For a fallback, please see: https://www.npmjs.com/package/glsl-read-float")):te(Vr===Ci,"Reading from a framebuffer is only allowed for the type 'uint8'"));var Kr=0,Dr=0,jr=sr.framebufferWidth,jt=sr.framebufferHeight,Ar=null;j(Br)?Ar=Br:Br&&(te.type(Br,"object","invalid arguments to regl.read()"),Kr=Br.x|0,Dr=Br.y|0,te(Kr>=0&&Kr<sr.framebufferWidth,"invalid x offset for regl.read"),te(Dr>=0&&Dr<sr.framebufferHeight,"invalid y offset for regl.read"),jr=(Br.width||sr.framebufferWidth-Kr)|0,jt=(Br.height||sr.framebufferHeight-Dr)|0,Ar=Br.data||null),Ar&&(Vr===Ci?te(Ar instanceof Uint8Array,"buffer must be 'Uint8Array' when reading from a framebuffer of type 'uint8'"):Vr===je&&te(Ar instanceof Float32Array,"buffer must be 'Float32Array' when reading from a framebuffer of type 'float'")),te(jr>0&&jr+Kr<=sr.framebufferWidth,"invalid width for read pixels"),te(jt>0&&jt+Dr<=sr.framebufferHeight,"invalid height for read pixels"),Et();var Ur=jr*jt*4;return Ar||(Vr===Ci?Ar=new Uint8Array(Ur):Vr===je&&(Ar=Ar||new Float32Array(Ur))),te.isTypedArray(Ar,"data buffer for regl.read() must be a typedarray"),te(Ar.byteLength>=Ur,"data buffer for regl.read() too small"),Te.pixelStorei(gn,4),Te.readPixels(Kr,Dr,jr,jt,Ki,Vr,Ar),Ar}function Pr(Br){var Vr;return Je.setFBO({framebuffer:Br.framebuffer},function(){Vr=kr(Br)}),Vr}function qr(Br){return!Br||!("framebuffer"in Br)?kr(Br):Pr(Br)}return qr}function zi(Te){return Array.prototype.slice.call(Te)}function ct(Te){return zi(Te).join("")}function bi(){var Te=0,Je=[],Et=[];function sr(Vr){for(var Kr=0;Kr<Et.length;++Kr)if(Et[Kr]===Vr)return Je[Kr];var Dr="g"+Te++;return Je.push(Dr),Et.push(Vr),Dr}function Er(){var Vr=[];function Kr(){Vr.push.apply(Vr,zi(arguments))}var Dr=[];function jr(){var jt="v"+Te++;return Dr.push(jt),arguments.length>0&&(Vr.push(jt,"="),Vr.push.apply(Vr,zi(arguments)),Vr.push(";")),jt}return C(Kr,{def:jr,toString:function(){return ct([Dr.length>0?"var "+Dr.join(",")+";":"",ct(Vr)])}})}function lr(){var Vr=Er(),Kr=Er(),Dr=Vr.toString,jr=Kr.toString;function jt(Ar,Ur){Kr(Ar,Ur,"=",Vr.def(Ar,Ur),";")}return C(function(){Vr.apply(Vr,zi(arguments))},{def:Vr.def,entry:Vr,exit:Kr,save:jt,set:function(Ar,Ur,Jr){jt(Ar,Ur),Vr(Ar,Ur,"=",Jr,";")},toString:function(){return Dr()+jr()}})}function gr(){var Vr=ct(arguments),Kr=lr(),Dr=lr(),jr=Kr.toString,jt=Dr.toString;return C(Kr,{then:function(){return Kr.apply(Kr,zi(arguments)),this},else:function(){return Dr.apply(Dr,zi(arguments)),this},toString:function(){var Ar=jt();return Ar&&(Ar="else{"+Ar+"}"),ct(["if(",Vr,"){",jr(),"}",Ar])}})}var kr=Er(),Pr={};function qr(Vr,Kr){var Dr=[];function jr(){var Rr="a"+Dr.length;return Dr.push(Rr),Rr}Kr=Kr||0;for(var jt=0;jt<Kr;++jt)jr();var Ar=lr(),Ur=Ar.toString,Jr=Pr[Vr]=C(Ar,{arg:jr,toString:function(){return ct(["function(",Dr.join(),"){",Ur(),"}"])}});return Jr}function Br(){var Vr=['"use strict";',kr,"return {"];Object.keys(Pr).forEach(function(jr){Vr.push('"',jr,'":',Pr[jr].toString(),",")}),Vr.push("}");var Kr=ct(Vr).replace(/;/g,`;
`).replace(/}/g,`}
`).replace(/{/g,`{
`),Dr=Function.apply(null,Je.concat(Kr));return Dr.apply(null,Et)}return{global:kr,link:sr,block:Er,proc:qr,scope:lr,cond:gr,compile:Br}}var lf="xyzw".split(""),Nh=5121,cf=1,y0=2,Dh=0,nt=1,Lf=2,E0=3,Y0=4,$0="dither",S0="blend.enable",Q0="blend.color",Ff="blend.equation",q0="blend.func",K0="depth.enable",hl="depth.func",Ss="depth.range",J0="depth.mask",Lh="colorMask",x0="cull.enable",dc="cull.face",Zc="frontFace",Bf="lineWidth",eh="polygonOffset.enable",_a="polygonOffset.offset",Ja="sample.alpha",xs="sample.enable",qf="sample.coverage",xA="stencil.enable",T0="stencil.mask",C0="stencil.func",b0="stencil.opFront",ji="stencil.opBack",R0="scissor.enable",ec="scissor.box",fs="viewport",zc="profile",Qa="framebuffer",Xu="vert",Kf="frag",ff="elements",$o="primitive",Yu="count",Gs="offset",Jf="instances",e0="vao",t0="Width",Fh="Height",kf=Qa+t0,hf=Qa+Fh,Bh=fs+t0,r0=fs+Fh,vc="drawingBuffer",th=vc+t0,$u=vc+Fh,Dl=[q0,Ff,C0,b0,ji,qf,fs,ec,_a],Ll=34962,gc=34963,kh=35632,Uh=35633,M0=3553,TA=34067,CA=2884,Zh=3042,zh=3024,rh=2960,bA=2929,Up=3089,Gh=32823,RA=32926,Gc=32928,w0=5126,Vc=35664,nh=35665,ih=35666,Vh=5124,Af=35667,pf=35668,n0=35669,Vo=35670,Au=35671,mc=35672,Hc=35673,Qu=35674,tc=35675,Wc=35676,df=35678,_c=35680,vf=4,wa=1028,yc=1029,Uf=2304,Ec=2305,i0=32775,ah=32776,Hh=519,jc=7680,Ks=0,Xc=1,Fl=32774,a0=513,qu=36160,oh=36064,Ho={0:0,1:1,zero:0,one:1,"src color":768,"one minus src color":769,"src alpha":770,"one minus src alpha":771,"dst color":774,"one minus dst color":775,"dst alpha":772,"one minus dst alpha":773,"constant color":32769,"one minus constant color":32770,"constant alpha":32771,"one minus constant alpha":32772,"src alpha saturate":776},gf=["constant color, constant alpha","one minus constant color, constant alpha","constant color, one minus constant alpha","one minus constant color, one minus constant alpha","constant alpha, constant color","constant alpha, one minus constant color","one minus constant alpha, constant color","one minus constant alpha, one minus constant color"],Ku={never:512,less:513,"<":513,equal:514,"=":514,"==":514,"===":514,lequal:515,"<=":515,greater:516,">":516,notequal:517,"!=":517,"!==":517,gequal:518,">=":518,always:519},pu={0:0,zero:0,keep:7680,replace:7681,increment:7682,decrement:7683,"increment wrap":34055,"decrement wrap":34056,invert:5386},Sc={frag:kh,vert:Uh},Yc={cw:Uf,ccw:Ec};function o0(Te){return Array.isArray(Te)||j(Te)||Ka(Te)}function I0(Te){return Te.sort(function(Je,Et){return Je===fs?-1:Et===fs?1:Je<Et?-1:1})}function Fu(Te,Je,Et,sr){this.thisDep=Te,this.contextDep=Je,this.propDep=Et,this.append=sr}function Bl(Te){return Te&&!(Te.thisDep||Te.contextDep||Te.propDep)}function Po(Te){return new Fu(!1,!1,!1,Te)}function Js(Te,Je){var Et=Te.type;if(Et===Dh){var sr=Te.data.length;return new Fu(!0,sr>=1,sr>=2,Je)}else if(Et===Y0){var Er=Te.data;return new Fu(Er.thisDep,Er.contextDep,Er.propDep,Je)}else return new Fu(Et===E0,Et===Lf,Et===nt,Je)}var s0=new Fu(!1,!1,!1,function(){});function P0(Te,Je,Et,sr,Er,lr,gr,kr,Pr,qr,Br,Vr,Kr,Dr,jr){var jt=qr.Record,Ar={add:32774,subtract:32778,"reverse subtract":32779};Et.ext_blend_minmax&&(Ar.min=i0,Ar.max=ah);var Ur=Et.angle_instanced_arrays,Jr=Et.webgl_draw_buffers,Rr={dirty:!0,profile:jr.profile},An={},Fr=[],sn={},wr={};function en(Oe){return Oe.replace(".","_")}function Nn(Oe,Ve,ft){var $t=en(Oe);Fr.push(Oe),An[$t]=Rr[$t]=!!ft,sn[$t]=Ve}function hi(Oe,Ve,ft){var $t=en(Oe);Fr.push(Oe),Array.isArray(ft)?(Rr[$t]=ft.slice(),An[$t]=ft.slice()):Rr[$t]=An[$t]=ft,wr[$t]=Ve}Nn($0,zh),Nn(S0,Zh),hi(Q0,"blendColor",[0,0,0,0]),hi(Ff,"blendEquationSeparate",[Fl,Fl]),hi(q0,"blendFuncSeparate",[Xc,Ks,Xc,Ks]),Nn(K0,bA,!0),hi(hl,"depthFunc",a0),hi(Ss,"depthRange",[0,1]),hi(J0,"depthMask",!0),hi(Lh,Lh,[!0,!0,!0,!0]),Nn(x0,CA),hi(dc,"cullFace",yc),hi(Zc,Zc,Ec),hi(Bf,Bf,1),Nn(eh,Gh),hi(_a,"polygonOffset",[0,0]),Nn(Ja,RA),Nn(xs,Gc),hi(qf,"sampleCoverage",[1,!1]),Nn(xA,rh),hi(T0,"stencilMask",-1),hi(C0,"stencilFunc",[Hh,0,-1]),hi(b0,"stencilOpSeparate",[wa,jc,jc,jc]),hi(ji,"stencilOpSeparate",[yc,jc,jc,jc]),Nn(R0,Up),hi(ec,"scissor",[0,0,Te.drawingBufferWidth,Te.drawingBufferHeight]),hi(fs,fs,[0,0,Te.drawingBufferWidth,Te.drawingBufferHeight]);var an={gl:Te,context:Kr,strings:Je,next:An,current:Rr,draw:Vr,elements:lr,buffer:Er,shader:Br,attributes:qr.state,vao:qr,uniforms:Pr,framebuffer:kr,extensions:Et,timer:Dr,isBufferArgs:o0},Zr={primTypes:jl,compareFuncs:Ku,blendFuncs:Ho,blendEquations:Ar,stencilOps:pu,glTypes:ca,orientationType:Yc};te.optional(function(){an.isArrayLike=Pa}),Jr&&(Zr.backBuffer=[yc],Zr.drawBuffer=no(sr.maxDrawbuffers,function(Oe){return Oe===0?[0]:no(Oe,function(Ve){return oh+Ve})}));var Tr=0;function ai(){var Oe=bi(),Ve=Oe.link,ft=Oe.global;Oe.id=Tr++,Oe.batchId="0";var $t=Ve(an),tr=Oe.shared={props:"a0"};Object.keys(an).forEach(function(h){tr[h]=ft.def($t,".",h)}),te.optional(function(){Oe.CHECK=Ve(te),Oe.commandStr=te.guessCommand(),Oe.command=Ve(Oe.commandStr),Oe.assert=function(h,f,d){h("if(!(",f,"))",this.CHECK,".commandRaise(",Ve(d),",",this.command,");")},Zr.invalidBlendCombinations=gf});var wt=Oe.next={},Bt=Oe.current={};Object.keys(wr).forEach(function(h){Array.isArray(Rr[h])&&(wt[h]=ft.def(tr.next,".",h),Bt[h]=ft.def(tr.current,".",h))});var Dt=Oe.constants={};Object.keys(Zr).forEach(function(h){Dt[h]=ft.def(JSON.stringify(Zr[h]))}),Oe.invoke=function(h,f){switch(f.type){case Dh:var d=["this",tr.context,tr.props,Oe.batchId];return h.def(Ve(f.data),".call(",d.slice(0,Math.max(f.data.length+1,4)),")");case nt:return h.def(tr.props,f.data);case Lf:return h.def(tr.context,f.data);case E0:return h.def("this",f.data);case Y0:return f.data.append(Oe,h),f.data.ref}},Oe.attribCache={};var ut={};return Oe.scopeAttrib=function(h){var f=Je.id(h);if(f in ut)return ut[f];var d=qr.scope[f];d||(d=qr.scope[f]=new jt);var E=ut[f]=Ve(d);return E},Oe}function Yn(Oe){var Ve=Oe.static,ft=Oe.dynamic,$t;if(zc in Ve){var tr=!!Ve[zc];$t=Po(function(Bt,Dt){return tr}),$t.enable=tr}else if(zc in ft){var wt=ft[zc];$t=Js(wt,function(Bt,Dt){return Bt.invoke(Dt,wt)})}return $t}function Pn(Oe,Ve){var ft=Oe.static,$t=Oe.dynamic;if(Qa in ft){var tr=ft[Qa];return tr?(tr=kr.getFramebuffer(tr),te.command(tr,"invalid framebuffer object"),Po(function(Bt,Dt){var ut=Bt.link(tr),h=Bt.shared;Dt.set(h.framebuffer,".next",ut);var f=h.context;return Dt.set(f,"."+kf,ut+".width"),Dt.set(f,"."+hf,ut+".height"),ut})):Po(function(Bt,Dt){var ut=Bt.shared;Dt.set(ut.framebuffer,".next","null");var h=ut.context;return Dt.set(h,"."+kf,h+"."+th),Dt.set(h,"."+hf,h+"."+$u),"null"})}else if(Qa in $t){var wt=$t[Qa];return Js(wt,function(Bt,Dt){var ut=Bt.invoke(Dt,wt),h=Bt.shared,f=h.framebuffer,d=Dt.def(f,".getFramebuffer(",ut,")");te.optional(function(){Bt.assert(Dt,"!"+ut+"||"+d,"invalid framebuffer object")}),Dt.set(f,".next",d);var E=h.context;return Dt.set(E,"."+kf,d+"?"+d+".width:"+E+"."+th),Dt.set(E,"."+hf,d+"?"+d+".height:"+E+"."+$u),d})}else return null}function Di(Oe,Ve,ft){var $t=Oe.static,tr=Oe.dynamic;function wt(ut){if(ut in $t){var h=$t[ut];te.commandType(h,"object","invalid "+ut,ft.commandStr);var f=!0,d=h.x|0,E=h.y|0,S,M;return"width"in h?(S=h.width|0,te.command(S>=0,"invalid "+ut,ft.commandStr)):f=!1,"height"in h?(M=h.height|0,te.command(M>=0,"invalid "+ut,ft.commandStr)):f=!1,new Fu(!f&&Ve&&Ve.thisDep,!f&&Ve&&Ve.contextDep,!f&&Ve&&Ve.propDep,function($,pe){var we=$.shared.context,$e=S;"width"in h||($e=pe.def(we,".",kf,"-",d));var At=M;return"height"in h||(At=pe.def(we,".",hf,"-",E)),[d,E,$e,At]})}else if(ut in tr){var O=tr[ut],F=Js(O,function($,pe){var we=$.invoke(pe,O);te.optional(function(){$.assert(pe,we+"&&typeof "+we+'==="object"',"invalid "+ut)});var $e=$.shared.context,At=pe.def(we,".x|0"),Rt=pe.def(we,".y|0"),_t=pe.def('"width" in ',we,"?",we,".width|0:","(",$e,".",kf,"-",At,")"),zt=pe.def('"height" in ',we,"?",we,".height|0:","(",$e,".",hf,"-",Rt,")");return te.optional(function(){$.assert(pe,_t+">=0&&"+zt+">=0","invalid "+ut)}),[At,Rt,_t,zt]});return Ve&&(F.thisDep=F.thisDep||Ve.thisDep,F.contextDep=F.contextDep||Ve.contextDep,F.propDep=F.propDep||Ve.propDep),F}else return Ve?new Fu(Ve.thisDep,Ve.contextDep,Ve.propDep,function($,pe){var we=$.shared.context;return[0,0,pe.def(we,".",kf),pe.def(we,".",hf)]}):null}var Bt=wt(fs);if(Bt){var Dt=Bt;Bt=new Fu(Bt.thisDep,Bt.contextDep,Bt.propDep,function(ut,h){var f=Dt.append(ut,h),d=ut.shared.context;return h.set(d,"."+Bh,f[2]),h.set(d,"."+r0,f[3]),f})}return{viewport:Bt,scissor_box:wt(ec)}}function ei(Oe,Ve){var ft=Oe.static,$t=typeof ft[Kf]=="string"&&typeof ft[Xu]=="string";if($t){if(Object.keys(Ve.dynamic).length>0)return null;var tr=Ve.static,wt=Object.keys(tr);if(wt.length>0&&typeof tr[wt[0]]=="number"){for(var Bt=[],Dt=0;Dt<wt.length;++Dt)te(typeof tr[wt[Dt]]=="number","must specify all vertex attribute locations when using vaos"),Bt.push([tr[wt[Dt]]|0,wt[Dt]]);return Bt}}return null}function qn(Oe,Ve,ft){var $t=Oe.static,tr=Oe.dynamic;function wt(f){if(f in $t){var d=Je.id($t[f]);te.optional(function(){Br.shader(Sc[f],d,te.guessCommand())});var E=Po(function(){return d});return E.id=d,E}else if(f in tr){var S=tr[f];return Js(S,function(M,O){var F=M.invoke(O,S),$=O.def(M.shared.strings,".id(",F,")");return te.optional(function(){O(M.shared.shader,".shader(",Sc[f],",",$,",",M.command,");")}),$})}return null}var Bt=wt(Kf),Dt=wt(Xu),ut=null,h;return Bl(Bt)&&Bl(Dt)?(ut=Br.program(Dt.id,Bt.id,null,ft),h=Po(function(f,d){return f.link(ut)})):h=new Fu(Bt&&Bt.thisDep||Dt&&Dt.thisDep,Bt&&Bt.contextDep||Dt&&Dt.contextDep,Bt&&Bt.propDep||Dt&&Dt.propDep,function(f,d){var E=f.shared.shader,S;Bt?S=Bt.append(f,d):S=d.def(E,".",Kf);var M;Dt?M=Dt.append(f,d):M=d.def(E,".",Xu);var O=E+".program("+M+","+S;return te.optional(function(){O+=","+f.command}),d.def(O+")")}),{frag:Bt,vert:Dt,progVar:h,program:ut}}function ga(Oe,Ve){var ft=Oe.static,$t=Oe.dynamic;function tr(){if(ff in ft){var f=ft[ff];o0(f)?f=lr.getElements(lr.create(f,!0)):f&&(f=lr.getElements(f),te.command(f,"invalid elements",Ve.commandStr));var d=Po(function(S,M){if(f){var O=S.link(f);return S.ELEMENTS=O,O}return S.ELEMENTS=null,null});return d.value=f,d}else if(ff in $t){var E=$t[ff];return Js(E,function(S,M){var O=S.shared,F=O.isBufferArgs,$=O.elements,pe=S.invoke(M,E),we=M.def("null"),$e=M.def(F,"(",pe,")"),At=S.cond($e).then(we,"=",$,".createStream(",pe,");").else(we,"=",$,".getElements(",pe,");");return te.optional(function(){S.assert(At.else,"!"+pe+"||"+we,"invalid elements")}),M.entry(At),M.exit(S.cond($e).then($,".destroyStream(",we,");")),S.ELEMENTS=we,we})}return null}var wt=tr();function Bt(){if($o in ft){var f=ft[$o];return te.commandParameter(f,jl,"invalid primitve",Ve.commandStr),Po(function(E,S){return jl[f]})}else if($o in $t){var d=$t[$o];return Js(d,function(E,S){var M=E.constants.primTypes,O=E.invoke(S,d);return te.optional(function(){E.assert(S,O+" in "+M,"invalid primitive, must be one of "+Object.keys(jl))}),S.def(M,"[",O,"]")})}else if(wt)return Bl(wt)?wt.value?Po(function(E,S){return S.def(E.ELEMENTS,".primType")}):Po(function(){return vf}):new Fu(wt.thisDep,wt.contextDep,wt.propDep,function(E,S){var M=E.ELEMENTS;return S.def(M,"?",M,".primType:",vf)});return null}function Dt(f,d){if(f in ft){var E=ft[f]|0;return te.command(!d||E>=0,"invalid "+f,Ve.commandStr),Po(function(M,O){return d&&(M.OFFSET=E),E})}else if(f in $t){var S=$t[f];return Js(S,function(M,O){var F=M.invoke(O,S);return d&&(M.OFFSET=F,te.optional(function(){M.assert(O,F+">=0","invalid "+f)})),F})}else if(d&&wt)return Po(function(M,O){return M.OFFSET="0",0});return null}var ut=Dt(Gs,!0);function h(){if(Yu in ft){var f=ft[Yu]|0;return te.command(typeof f=="number"&&f>=0,"invalid vertex count",Ve.commandStr),Po(function(){return f})}else if(Yu in $t){var d=$t[Yu];return Js(d,function(M,O){var F=M.invoke(O,d);return te.optional(function(){M.assert(O,"typeof "+F+'==="number"&&'+F+">=0&&"+F+"===("+F+"|0)","invalid vertex count")}),F})}else if(wt)if(Bl(wt)){if(wt)return ut?new Fu(ut.thisDep,ut.contextDep,ut.propDep,function(M,O){var F=O.def(M.ELEMENTS,".vertCount-",M.OFFSET);return te.optional(function(){M.assert(O,F+">=0","invalid vertex offset/element buffer too small")}),F}):Po(function(M,O){return O.def(M.ELEMENTS,".vertCount")});var E=Po(function(){return-1});return te.optional(function(){E.MISSING=!0}),E}else{var S=new Fu(wt.thisDep||ut.thisDep,wt.contextDep||ut.contextDep,wt.propDep||ut.propDep,function(M,O){var F=M.ELEMENTS;return M.OFFSET?O.def(F,"?",F,".vertCount-",M.OFFSET,":-1"):O.def(F,"?",F,".vertCount:-1")});return te.optional(function(){S.DYNAMIC=!0}),S}return null}return{elements:wt,primitive:Bt(),count:h(),instances:Dt(Jf,!1),offset:ut}}function Oo(Oe,Ve){var ft=Oe.static,$t=Oe.dynamic,tr={};return Fr.forEach(function(wt){var Bt=en(wt);function Dt(ut,h){if(wt in ft){var f=ut(ft[wt]);tr[Bt]=Po(function(){return f})}else if(wt in $t){var d=$t[wt];tr[Bt]=Js(d,function(E,S){return h(E,S,E.invoke(S,d))})}}switch(wt){case x0:case S0:case $0:case xA:case K0:case R0:case eh:case Ja:case xs:case J0:return Dt(function(ut){return te.commandType(ut,"boolean",wt,Ve.commandStr),ut},function(ut,h,f){return te.optional(function(){ut.assert(h,"typeof "+f+'==="boolean"',"invalid flag "+wt,ut.commandStr)}),f});case hl:return Dt(function(ut){return te.commandParameter(ut,Ku,"invalid "+wt,Ve.commandStr),Ku[ut]},function(ut,h,f){var d=ut.constants.compareFuncs;return te.optional(function(){ut.assert(h,f+" in "+d,"invalid "+wt+", must be one of "+Object.keys(Ku))}),h.def(d,"[",f,"]")});case Ss:return Dt(function(ut){return te.command(Pa(ut)&&ut.length===2&&typeof ut[0]=="number"&&typeof ut[1]=="number"&&ut[0]<=ut[1],"depth range is 2d array",Ve.commandStr),ut},function(ut,h,f){te.optional(function(){ut.assert(h,ut.shared.isArrayLike+"("+f+")&&"+f+".length===2&&typeof "+f+'[0]==="number"&&typeof '+f+'[1]==="number"&&'+f+"[0]<="+f+"[1]","depth range must be a 2d array")});var d=h.def("+",f,"[0]"),E=h.def("+",f,"[1]");return[d,E]});case q0:return Dt(function(ut){te.commandType(ut,"object","blend.func",Ve.commandStr);var h="srcRGB"in ut?ut.srcRGB:ut.src,f="srcAlpha"in ut?ut.srcAlpha:ut.src,d="dstRGB"in ut?ut.dstRGB:ut.dst,E="dstAlpha"in ut?ut.dstAlpha:ut.dst;return te.commandParameter(h,Ho,Bt+".srcRGB",Ve.commandStr),te.commandParameter(f,Ho,Bt+".srcAlpha",Ve.commandStr),te.commandParameter(d,Ho,Bt+".dstRGB",Ve.commandStr),te.commandParameter(E,Ho,Bt+".dstAlpha",Ve.commandStr),te.command(gf.indexOf(h+", "+d)===-1,"unallowed blending combination (srcRGB, dstRGB) = ("+h+", "+d+")",Ve.commandStr),[Ho[h],Ho[d],Ho[f],Ho[E]]},function(ut,h,f){var d=ut.constants.blendFuncs;te.optional(function(){ut.assert(h,f+"&&typeof "+f+'==="object"',"invalid blend func, must be an object")});function E(we,$e){var At=h.def('"',we,$e,'" in ',f,"?",f,".",we,$e,":",f,".",we);return te.optional(function(){ut.assert(h,At+" in "+d,"invalid "+wt+"."+we+$e+", must be one of "+Object.keys(Ho))}),At}var S=E("src","RGB"),M=E("dst","RGB");te.optional(function(){var we=ut.constants.invalidBlendCombinations;ut.assert(h,we+".indexOf("+S+'+", "+'+M+") === -1 ","unallowed blending combination for (srcRGB, dstRGB)")});var O=h.def(d,"[",S,"]"),F=h.def(d,"[",E("src","Alpha"),"]"),$=h.def(d,"[",M,"]"),pe=h.def(d,"[",E("dst","Alpha"),"]");return[O,$,F,pe]});case Ff:return Dt(function(ut){if(typeof ut=="string")return te.commandParameter(ut,Ar,"invalid "+wt,Ve.commandStr),[Ar[ut],Ar[ut]];if(typeof ut=="object")return te.commandParameter(ut.rgb,Ar,wt+".rgb",Ve.commandStr),te.commandParameter(ut.alpha,Ar,wt+".alpha",Ve.commandStr),[Ar[ut.rgb],Ar[ut.alpha]];te.commandRaise("invalid blend.equation",Ve.commandStr)},function(ut,h,f){var d=ut.constants.blendEquations,E=h.def(),S=h.def(),M=ut.cond("typeof ",f,'==="string"');return te.optional(function(){function O(F,$,pe){ut.assert(F,pe+" in "+d,"invalid "+$+", must be one of "+Object.keys(Ar))}O(M.then,wt,f),ut.assert(M.else,f+"&&typeof "+f+'==="object"',"invalid "+wt),O(M.else,wt+".rgb",f+".rgb"),O(M.else,wt+".alpha",f+".alpha")}),M.then(E,"=",S,"=",d,"[",f,"];"),M.else(E,"=",d,"[",f,".rgb];",S,"=",d,"[",f,".alpha];"),h(M),[E,S]});case Q0:return Dt(function(ut){return te.command(Pa(ut)&&ut.length===4,"blend.color must be a 4d array",Ve.commandStr),no(4,function(h){return+ut[h]})},function(ut,h,f){return te.optional(function(){ut.assert(h,ut.shared.isArrayLike+"("+f+")&&"+f+".length===4","blend.color must be a 4d array")}),no(4,function(d){return h.def("+",f,"[",d,"]")})});case T0:return Dt(function(ut){return te.commandType(ut,"number",Bt,Ve.commandStr),ut|0},function(ut,h,f){return te.optional(function(){ut.assert(h,"typeof "+f+'==="number"',"invalid stencil.mask")}),h.def(f,"|0")});case C0:return Dt(function(ut){te.commandType(ut,"object",Bt,Ve.commandStr);var h=ut.cmp||"keep",f=ut.ref||0,d="mask"in ut?ut.mask:-1;return te.commandParameter(h,Ku,wt+".cmp",Ve.commandStr),te.commandType(f,"number",wt+".ref",Ve.commandStr),te.commandType(d,"number",wt+".mask",Ve.commandStr),[Ku[h],f,d]},function(ut,h,f){var d=ut.constants.compareFuncs;te.optional(function(){function O(){ut.assert(h,Array.prototype.join.call(arguments,""),"invalid stencil.func")}O(f+"&&typeof ",f,'==="object"'),O('!("cmp" in ',f,")||(",f,".cmp in ",d,")")});var E=h.def('"cmp" in ',f,"?",d,"[",f,".cmp]",":",jc),S=h.def(f,".ref|0"),M=h.def('"mask" in ',f,"?",f,".mask|0:-1");return[E,S,M]});case b0:case ji:return Dt(function(ut){te.commandType(ut,"object",Bt,Ve.commandStr);var h=ut.fail||"keep",f=ut.zfail||"keep",d=ut.zpass||"keep";return te.commandParameter(h,pu,wt+".fail",Ve.commandStr),te.commandParameter(f,pu,wt+".zfail",Ve.commandStr),te.commandParameter(d,pu,wt+".zpass",Ve.commandStr),[wt===ji?yc:wa,pu[h],pu[f],pu[d]]},function(ut,h,f){var d=ut.constants.stencilOps;te.optional(function(){ut.assert(h,f+"&&typeof "+f+'==="object"',"invalid "+wt)});function E(S){return te.optional(function(){ut.assert(h,'!("'+S+'" in '+f+")||("+f+"."+S+" in "+d+")","invalid "+wt+"."+S+", must be one of "+Object.keys(pu))}),h.def('"',S,'" in ',f,"?",d,"[",f,".",S,"]:",jc)}return[wt===ji?yc:wa,E("fail"),E("zfail"),E("zpass")]});case _a:return Dt(function(ut){te.commandType(ut,"object",Bt,Ve.commandStr);var h=ut.factor|0,f=ut.units|0;return te.commandType(h,"number",Bt+".factor",Ve.commandStr),te.commandType(f,"number",Bt+".units",Ve.commandStr),[h,f]},function(ut,h,f){te.optional(function(){ut.assert(h,f+"&&typeof "+f+'==="object"',"invalid "+wt)});var d=h.def(f,".factor|0"),E=h.def(f,".units|0");return[d,E]});case dc:return Dt(function(ut){var h=0;return ut==="front"?h=wa:ut==="back"&&(h=yc),te.command(!!h,Bt,Ve.commandStr),h},function(ut,h,f){return te.optional(function(){ut.assert(h,f+'==="front"||'+f+'==="back"',"invalid cull.face")}),h.def(f,'==="front"?',wa,":",yc)});case Bf:return Dt(function(ut){return te.command(typeof ut=="number"&&ut>=sr.lineWidthDims[0]&&ut<=sr.lineWidthDims[1],"invalid line width, must be a positive number between "+sr.lineWidthDims[0]+" and "+sr.lineWidthDims[1],Ve.commandStr),ut},function(ut,h,f){return te.optional(function(){ut.assert(h,"typeof "+f+'==="number"&&'+f+">="+sr.lineWidthDims[0]+"&&"+f+"<="+sr.lineWidthDims[1],"invalid line width")}),f});case Zc:return Dt(function(ut){return te.commandParameter(ut,Yc,Bt,Ve.commandStr),Yc[ut]},function(ut,h,f){return te.optional(function(){ut.assert(h,f+'==="cw"||'+f+'==="ccw"',"invalid frontFace, must be one of cw,ccw")}),h.def(f+'==="cw"?'+Uf+":"+Ec)});case Lh:return Dt(function(ut){return te.command(Pa(ut)&&ut.length===4,"color.mask must be length 4 array",Ve.commandStr),ut.map(function(h){return!!h})},function(ut,h,f){return te.optional(function(){ut.assert(h,ut.shared.isArrayLike+"("+f+")&&"+f+".length===4","invalid color.mask")}),no(4,function(d){return"!!"+f+"["+d+"]"})});case qf:return Dt(function(ut){te.command(typeof ut=="object"&&ut,Bt,Ve.commandStr);var h="value"in ut?ut.value:1,f=!!ut.invert;return te.command(typeof h=="number"&&h>=0&&h<=1,"sample.coverage.value must be a number between 0 and 1",Ve.commandStr),[h,f]},function(ut,h,f){te.optional(function(){ut.assert(h,f+"&&typeof "+f+'==="object"',"invalid sample.coverage")});var d=h.def('"value" in ',f,"?+",f,".value:1"),E=h.def("!!",f,".invert");return[d,E]})}}),tr}function Wo(Oe,Ve){var ft=Oe.static,$t=Oe.dynamic,tr={};return Object.keys(ft).forEach(function(wt){var Bt=ft[wt],Dt;if(typeof Bt=="number"||typeof Bt=="boolean")Dt=Po(function(){return Bt});else if(typeof Bt=="function"){var ut=Bt._reglType;ut==="texture2d"||ut==="textureCube"?Dt=Po(function(h){return h.link(Bt)}):ut==="framebuffer"||ut==="framebufferCube"?(te.command(Bt.color.length>0,'missing color attachment for framebuffer sent to uniform "'+wt+'"',Ve.commandStr),Dt=Po(function(h){return h.link(Bt.color[0])})):te.commandRaise('invalid data for uniform "'+wt+'"',Ve.commandStr)}else Pa(Bt)?Dt=Po(function(h){var f=h.global.def("[",no(Bt.length,function(d){return te.command(typeof Bt[d]=="number"||typeof Bt[d]=="boolean","invalid uniform "+wt,h.commandStr),Bt[d]}),"]");return f}):te.commandRaise('invalid or missing data for uniform "'+wt+'"',Ve.commandStr);Dt.value=Bt,tr[wt]=Dt}),Object.keys($t).forEach(function(wt){var Bt=$t[wt];tr[wt]=Js(Bt,function(Dt,ut){return Dt.invoke(ut,Bt)})}),tr}function Xi(Oe,Ve){var ft=Oe.static,$t=Oe.dynamic,tr={};return Object.keys(ft).forEach(function(wt){var Bt=ft[wt],Dt=Je.id(wt),ut=new jt;if(o0(Bt))ut.state=cf,ut.buffer=Er.getBuffer(Er.create(Bt,Ll,!1,!0)),ut.type=0;else{var h=Er.getBuffer(Bt);if(h)ut.state=cf,ut.buffer=h,ut.type=0;else if(te.command(typeof Bt=="object"&&Bt,"invalid data for attribute "+wt,Ve.commandStr),"constant"in Bt){var f=Bt.constant;ut.buffer="null",ut.state=y0,typeof f=="number"?ut.x=f:(te.command(Pa(f)&&f.length>0&&f.length<=4,"invalid constant for attribute "+wt,Ve.commandStr),lf.forEach(function($,pe){pe<f.length&&(ut[$]=f[pe])}))}else{o0(Bt.buffer)?h=Er.getBuffer(Er.create(Bt.buffer,Ll,!1,!0)):h=Er.getBuffer(Bt.buffer),te.command(!!h,'missing buffer for attribute "'+wt+'"',Ve.commandStr);var d=Bt.offset|0;te.command(d>=0,'invalid offset for attribute "'+wt+'"',Ve.commandStr);var E=Bt.stride|0;te.command(E>=0&&E<256,'invalid stride for attribute "'+wt+'", must be integer betweeen [0, 255]',Ve.commandStr);var S=Bt.size|0;te.command(!("size"in Bt)||S>0&&S<=4,'invalid size for attribute "'+wt+'", must be 1,2,3,4',Ve.commandStr);var M=!!Bt.normalized,O=0;"type"in Bt&&(te.commandParameter(Bt.type,ca,"invalid type for attribute "+wt,Ve.commandStr),O=ca[Bt.type]);var F=Bt.divisor|0;"divisor"in Bt&&(te.command(F===0||Ur,'cannot specify divisor for attribute "'+wt+'", instancing not supported',Ve.commandStr),te.command(F>=0,'invalid divisor for attribute "'+wt+'"',Ve.commandStr)),te.optional(function(){var $=Ve.commandStr,pe=["buffer","offset","divisor","normalized","type","size","stride"];Object.keys(Bt).forEach(function(we){te.command(pe.indexOf(we)>=0,'unknown parameter "'+we+'" for attribute pointer "'+wt+'" (valid parameters are '+pe+")",$)})}),ut.buffer=h,ut.state=cf,ut.size=S,ut.normalized=M,ut.type=O||h.dtype,ut.offset=d,ut.stride=E,ut.divisor=F}}tr[wt]=Po(function($,pe){var we=$.attribCache;if(Dt in we)return we[Dt];var $e={isStream:!1};return Object.keys(ut).forEach(function(At){$e[At]=ut[At]}),ut.buffer&&($e.buffer=$.link(ut.buffer),$e.type=$e.type||$e.buffer+".dtype"),we[Dt]=$e,$e})}),Object.keys($t).forEach(function(wt){var Bt=$t[wt];function Dt(ut,h){var f=ut.invoke(h,Bt),d=ut.shared,E=ut.constants,S=d.isBufferArgs,M=d.buffer;te.optional(function(){ut.assert(h,f+"&&(typeof "+f+'==="object"||typeof '+f+'==="function")&&('+S+"("+f+")||"+M+".getBuffer("+f+")||"+M+".getBuffer("+f+".buffer)||"+S+"("+f+'.buffer)||("constant" in '+f+"&&(typeof "+f+'.constant==="number"||'+d.isArrayLike+"("+f+".constant))))",'invalid dynamic attribute "'+wt+'"')});var O={isStream:h.def(!1)},F=new jt;F.state=cf,Object.keys(F).forEach(function($e){O[$e]=h.def(""+F[$e])});var $=O.buffer,pe=O.type;h("if(",S,"(",f,")){",O.isStream,"=true;",$,"=",M,".createStream(",Ll,",",f,");",pe,"=",$,".dtype;","}else{",$,"=",M,".getBuffer(",f,");","if(",$,"){",pe,"=",$,".dtype;",'}else if("constant" in ',f,"){",O.state,"=",y0,";","if(typeof "+f+'.constant === "number"){',O[lf[0]],"=",f,".constant;",lf.slice(1).map(function($e){return O[$e]}).join("="),"=0;","}else{",lf.map(function($e,At){return O[$e]+"="+f+".constant.length>"+At+"?"+f+".constant["+At+"]:0;"}).join(""),"}}else{","if(",S,"(",f,".buffer)){",$,"=",M,".createStream(",Ll,",",f,".buffer);","}else{",$,"=",M,".getBuffer(",f,".buffer);","}",pe,'="type" in ',f,"?",E.glTypes,"[",f,".type]:",$,".dtype;",O.normalized,"=!!",f,".normalized;");function we($e){h(O[$e],"=",f,".",$e,"|0;")}return we("size"),we("offset"),we("stride"),we("divisor"),h("}}"),h.exit("if(",O.isStream,"){",M,".destroyStream(",$,");","}"),O}tr[wt]=Js(Bt,Dt)}),tr}function Qo(Oe,Ve){var ft=Oe.static,$t=Oe.dynamic;if(e0 in ft){var tr=ft[e0];return tr!==null&&qr.getVAO(tr)===null&&(tr=qr.createVAO(tr)),Po(function(Bt){return Bt.link(qr.getVAO(tr))})}else if(e0 in $t){var wt=$t[e0];return Js(wt,function(Bt,Dt){var ut=Bt.invoke(Dt,wt);return Dt.def(Bt.shared.vao+".getVAO("+ut+")")})}return null}function eo(Oe){var Ve=Oe.static,ft=Oe.dynamic,$t={};return Object.keys(Ve).forEach(function(tr){var wt=Ve[tr];$t[tr]=Po(function(Bt,Dt){return typeof wt=="number"||typeof wt=="boolean"?""+wt:Bt.link(wt)})}),Object.keys(ft).forEach(function(tr){var wt=ft[tr];$t[tr]=Js(wt,function(Bt,Dt){return Bt.invoke(Dt,wt)})}),$t}function uo(Oe,Ve,ft,$t,tr){var wt=Oe.static,Bt=Oe.dynamic;te.optional(function(){var we=[Qa,Xu,Kf,ff,$o,Gs,Yu,Jf,zc,e0].concat(Fr);function $e(At){Object.keys(At).forEach(function(Rt){te.command(we.indexOf(Rt)>=0,'unknown parameter "'+Rt+'"',tr.commandStr)})}$e(wt),$e(Bt)});var Dt=ei(Oe,Ve),ut=Pn(Oe,tr),h=Di(Oe,ut,tr),f=ga(Oe,tr),d=Oo(Oe,tr),E=qn(Oe,tr,Dt);function S(we){var $e=h[we];$e&&(d[we]=$e)}S(fs),S(en(ec));var M=Object.keys(d).length>0,O={framebuffer:ut,draw:f,shader:E,state:d,dirty:M,scopeVAO:null,drawVAO:null,useVAO:!1,attributes:{}};if(O.profile=Yn(Oe,tr),O.uniforms=Wo(ft,tr),O.drawVAO=O.scopeVAO=Qo(Oe,tr),!O.drawVAO&&E.program&&!Dt&&Et.angle_instanced_arrays){var F=!0,$=E.program.attributes.map(function(we){var $e=Ve.static[we];return F=F&&!!$e,$e});if(F&&$.length>0){var pe=qr.getVAO(qr.createVAO($));O.drawVAO=new Fu(null,null,null,function(we,$e){return we.link(pe)}),O.useVAO=!0}}return Dt?O.useVAO=!0:O.attributes=Xi(Ve,tr),O.context=eo($t,tr),O}function No(Oe,Ve,ft){var $t=Oe.shared,tr=$t.context,wt=Oe.scope();Object.keys(ft).forEach(function(Bt){Ve.save(tr,"."+Bt);var Dt=ft[Bt];wt(tr,".",Bt,"=",Dt.append(Oe,Ve),";")}),Ve(wt)}function qo(Oe,Ve,ft,$t){var tr=Oe.shared,wt=tr.gl,Bt=tr.framebuffer,Dt;Jr&&(Dt=Ve.def(tr.extensions,".webgl_draw_buffers"));var ut=Oe.constants,h=ut.drawBuffer,f=ut.backBuffer,d;ft?d=ft.append(Oe,Ve):d=Ve.def(Bt,".next"),$t||Ve("if(",d,"!==",Bt,".cur){"),Ve("if(",d,"){",wt,".bindFramebuffer(",qu,",",d,".framebuffer);"),Jr&&Ve(Dt,".drawBuffersWEBGL(",h,"[",d,".colorAttachments.length]);"),Ve("}else{",wt,".bindFramebuffer(",qu,",null);"),Jr&&Ve(Dt,".drawBuffersWEBGL(",f,");"),Ve("}",Bt,".cur=",d,";"),$t||Ve("}")}function Ko(Oe,Ve,ft){var $t=Oe.shared,tr=$t.gl,wt=Oe.current,Bt=Oe.next,Dt=$t.current,ut=$t.next,h=Oe.cond(Dt,".dirty");Fr.forEach(function(f){var d=en(f);if(!(d in ft.state)){var E,S;if(d in Bt){E=Bt[d],S=wt[d];var M=no(Rr[d].length,function(F){return h.def(E,"[",F,"]")});h(Oe.cond(M.map(function(F,$){return F+"!=="+S+"["+$+"]"}).join("||")).then(tr,".",wr[d],"(",M,");",M.map(function(F,$){return S+"["+$+"]="+F}).join(";"),";"))}else{E=h.def(ut,".",d);var O=Oe.cond(E,"!==",Dt,".",d);h(O),d in sn?O(Oe.cond(E).then(tr,".enable(",sn[d],");").else(tr,".disable(",sn[d],");"),Dt,".",d,"=",E,";"):O(tr,".",wr[d],"(",E,");",Dt,".",d,"=",E,";")}}}),Object.keys(ft.state).length===0&&h(Dt,".dirty=false;"),Ve(h)}function Ns(Oe,Ve,ft,$t){var tr=Oe.shared,wt=Oe.current,Bt=tr.current,Dt=tr.gl;I0(Object.keys(ft)).forEach(function(ut){var h=ft[ut];if(!($t&&!$t(h))){var f=h.append(Oe,Ve);if(sn[ut]){var d=sn[ut];Bl(h)?f?Ve(Dt,".enable(",d,");"):Ve(Dt,".disable(",d,");"):Ve(Oe.cond(f).then(Dt,".enable(",d,");").else(Dt,".disable(",d,");")),Ve(Bt,".",ut,"=",f,";")}else if(Pa(f)){var E=wt[ut];Ve(Dt,".",wr[ut],"(",f,");",f.map(function(S,M){return E+"["+M+"]="+S}).join(";"),";")}else Ve(Dt,".",wr[ut],"(",f,");",Bt,".",ut,"=",f,";")}})}function hs(Oe,Ve){Ur&&(Oe.instancing=Ve.def(Oe.shared.extensions,".angle_instanced_arrays"))}function ti(Oe,Ve,ft,$t,tr){var wt=Oe.shared,Bt=Oe.stats,Dt=wt.current,ut=wt.timer,h=ft.profile;function f(){return typeof performance=="undefined"?"Date.now()":"performance.now()"}var d,E;function S(we){d=Ve.def(),we(d,"=",f(),";"),typeof tr=="string"?we(Bt,".count+=",tr,";"):we(Bt,".count++;"),Dr&&($t?(E=Ve.def(),we(E,"=",ut,".getNumPendingQueries();")):we(ut,".beginQuery(",Bt,");"))}function M(we){we(Bt,".cpuTime+=",f(),"-",d,";"),Dr&&($t?we(ut,".pushScopeStats(",E,",",ut,".getNumPendingQueries(),",Bt,");"):we(ut,".endQuery();"))}function O(we){var $e=Ve.def(Dt,".profile");Ve(Dt,".profile=",we,";"),Ve.exit(Dt,".profile=",$e,";")}var F;if(h){if(Bl(h)){h.enable?(S(Ve),M(Ve.exit),O("true")):O("false");return}F=h.append(Oe,Ve),O(F)}else F=Ve.def(Dt,".profile");var $=Oe.block();S($),Ve("if(",F,"){",$,"}");var pe=Oe.block();M(pe),Ve.exit("if(",F,"){",pe,"}")}function to(Oe,Ve,ft,$t,tr){var wt=Oe.shared;function Bt(ut){switch(ut){case Vc:case Af:case Au:return 2;case nh:case pf:case mc:return 3;case ih:case n0:case Hc:return 4;default:return 1}}function Dt(ut,h,f){var d=wt.gl,E=Ve.def(ut,".location"),S=Ve.def(wt.attributes,"[",E,"]"),M=f.state,O=f.buffer,F=[f.x,f.y,f.z,f.w],$=["buffer","normalized","offset","stride"];function pe(){Ve("if(!",S,".buffer){",d,".enableVertexAttribArray(",E,");}");var $e=f.type,At;if(f.size?At=Ve.def(f.size,"||",h):At=h,Ve("if(",S,".type!==",$e,"||",S,".size!==",At,"||",$.map(function(_t){return S+"."+_t+"!=="+f[_t]}).join("||"),"){",d,".bindBuffer(",Ll,",",O,".buffer);",d,".vertexAttribPointer(",[E,At,$e,f.normalized,f.stride,f.offset],");",S,".type=",$e,";",S,".size=",At,";",$.map(function(_t){return S+"."+_t+"="+f[_t]+";"}).join(""),"}"),Ur){var Rt=f.divisor;Ve("if(",S,".divisor!==",Rt,"){",Oe.instancing,".vertexAttribDivisorANGLE(",[E,Rt],");",S,".divisor=",Rt,";}")}}function we(){Ve("if(",S,".buffer){",d,".disableVertexAttribArray(",E,");",S,".buffer=null;","}if(",lf.map(function($e,At){return S+"."+$e+"!=="+F[At]}).join("||"),"){",d,".vertexAttrib4f(",E,",",F,");",lf.map(function($e,At){return S+"."+$e+"="+F[At]+";"}).join(""),"}")}M===cf?pe():M===y0?we():(Ve("if(",M,"===",cf,"){"),pe(),Ve("}else{"),we(),Ve("}"))}$t.forEach(function(ut){var h=ut.name,f=ft.attributes[h],d;if(f){if(!tr(f))return;d=f.append(Oe,Ve)}else{if(!tr(s0))return;var E=Oe.scopeAttrib(h);te.optional(function(){Oe.assert(Ve,E+".state","missing attribute "+h)}),d={},Object.keys(new jt).forEach(function(S){d[S]=Ve.def(E,".",S)})}Dt(Oe.link(ut),Bt(ut.info.type),d)})}function pn(Oe,Ve,ft,$t,tr){for(var wt=Oe.shared,Bt=wt.gl,Dt,ut=0;ut<$t.length;++ut){var h=$t[ut],f=h.name,d=h.info.type,E=ft.uniforms[f],S=Oe.link(h),M=S+".location",O;if(E){if(!tr(E))continue;if(Bl(E)){var F=E.value;if(te.command(F!==null&&typeof F!="undefined",'missing uniform "'+f+'"',Oe.commandStr),d===df||d===_c){te.command(typeof F=="function"&&(d===df&&(F._reglType==="texture2d"||F._reglType==="framebuffer")||d===_c&&(F._reglType==="textureCube"||F._reglType==="framebufferCube")),"invalid texture for uniform "+f,Oe.commandStr);var $=Oe.link(F._texture||F.color[0]._texture);Ve(Bt,".uniform1i(",M,",",$+".bind());"),Ve.exit($,".unbind();")}else if(d===Qu||d===tc||d===Wc){te.optional(function(){te.command(Pa(F),"invalid matrix for uniform "+f,Oe.commandStr),te.command(d===Qu&&F.length===4||d===tc&&F.length===9||d===Wc&&F.length===16,"invalid length for matrix uniform "+f,Oe.commandStr)});var pe=Oe.global.def("new Float32Array(["+Array.prototype.slice.call(F)+"])"),we=2;d===tc?we=3:d===Wc&&(we=4),Ve(Bt,".uniformMatrix",we,"fv(",M,",false,",pe,");")}else{switch(d){case w0:te.commandType(F,"number","uniform "+f,Oe.commandStr),Dt="1f";break;case Vc:te.command(Pa(F)&&F.length===2,"uniform "+f,Oe.commandStr),Dt="2f";break;case nh:te.command(Pa(F)&&F.length===3,"uniform "+f,Oe.commandStr),Dt="3f";break;case ih:te.command(Pa(F)&&F.length===4,"uniform "+f,Oe.commandStr),Dt="4f";break;case Vo:te.commandType(F,"boolean","uniform "+f,Oe.commandStr),Dt="1i";break;case Vh:te.commandType(F,"number","uniform "+f,Oe.commandStr),Dt="1i";break;case Au:te.command(Pa(F)&&F.length===2,"uniform "+f,Oe.commandStr),Dt="2i";break;case Af:te.command(Pa(F)&&F.length===2,"uniform "+f,Oe.commandStr),Dt="2i";break;case mc:te.command(Pa(F)&&F.length===3,"uniform "+f,Oe.commandStr),Dt="3i";break;case pf:te.command(Pa(F)&&F.length===3,"uniform "+f,Oe.commandStr),Dt="3i";break;case Hc:te.command(Pa(F)&&F.length===4,"uniform "+f,Oe.commandStr),Dt="4i";break;case n0:te.command(Pa(F)&&F.length===4,"uniform "+f,Oe.commandStr),Dt="4i";break}Ve(Bt,".uniform",Dt,"(",M,",",Pa(F)?Array.prototype.slice.call(F):F,");")}continue}else O=E.append(Oe,Ve)}else{if(!tr(s0))continue;O=Ve.def(wt.uniforms,"[",Je.id(f),"]")}d===df?Ve("if(",O,"&&",O,'._reglType==="framebuffer"){',O,"=",O,".color[0];","}"):d===_c&&Ve("if(",O,"&&",O,'._reglType==="framebufferCube"){',O,"=",O,".color[0];","}"),te.optional(function(){function zt(ur,er){Oe.assert(Ve,ur,'bad data or missing for uniform "'+f+'".  '+er)}function xr(ur){zt("typeof "+O+'==="'+ur+'"',"invalid type, expected "+ur)}function mr(ur,er){zt(wt.isArrayLike+"("+O+")&&"+O+".length==="+ur,"invalid vector, should have length "+ur,Oe.commandStr)}function fr(ur){zt("typeof "+O+'==="function"&&'+O+'._reglType==="texture'+(ur===M0?"2d":"Cube")+'"',"invalid texture type",Oe.commandStr)}switch(d){case Vh:xr("number");break;case Af:mr(2,"number");break;case pf:mr(3,"number");break;case n0:mr(4,"number");break;case w0:xr("number");break;case Vc:mr(2,"number");break;case nh:mr(3,"number");break;case ih:mr(4,"number");break;case Vo:xr("boolean");break;case Au:mr(2,"boolean");break;case mc:mr(3,"boolean");break;case Hc:mr(4,"boolean");break;case Qu:mr(4,"number");break;case tc:mr(9,"number");break;case Wc:mr(16,"number");break;case df:fr(M0);break;case _c:fr(TA);break}});var $e=1;switch(d){case df:case _c:var At=Ve.def(O,"._texture");Ve(Bt,".uniform1i(",M,",",At,".bind());"),Ve.exit(At,".unbind();");continue;case Vh:case Vo:Dt="1i";break;case Af:case Au:Dt="2i",$e=2;break;case pf:case mc:Dt="3i",$e=3;break;case n0:case Hc:Dt="4i",$e=4;break;case w0:Dt="1f";break;case Vc:Dt="2f",$e=2;break;case nh:Dt="3f",$e=3;break;case ih:Dt="4f",$e=4;break;case Qu:Dt="Matrix2fv";break;case tc:Dt="Matrix3fv";break;case Wc:Dt="Matrix4fv";break}if(Ve(Bt,".uniform",Dt,"(",M,","),Dt.charAt(0)==="M"){var Rt=Math.pow(d-Qu+2,2),_t=Oe.global.def("new Float32Array(",Rt,")");Ve("false,(Array.isArray(",O,")||",O," instanceof Float32Array)?",O,":(",no(Rt,function(zt){return _t+"["+zt+"]="+O+"["+zt+"]"}),",",_t,")")}else $e>1?Ve(no($e,function(zt){return O+"["+zt+"]"})):Ve(O);Ve(");")}}function Mn(Oe,Ve,ft,$t){var tr=Oe.shared,wt=tr.gl,Bt=tr.draw,Dt=$t.draw;function ut(){var At=Dt.elements,Rt,_t=Ve;return At?((At.contextDep&&$t.contextDynamic||At.propDep)&&(_t=ft),Rt=At.append(Oe,_t)):Rt=_t.def(Bt,".",ff),Rt&&_t("if("+Rt+")"+wt+".bindBuffer("+gc+","+Rt+".buffer.buffer);"),Rt}function h(){var At=Dt.count,Rt,_t=Ve;return At?((At.contextDep&&$t.contextDynamic||At.propDep)&&(_t=ft),Rt=At.append(Oe,_t),te.optional(function(){At.MISSING&&Oe.assert(Ve,"false","missing vertex count"),At.DYNAMIC&&Oe.assert(_t,Rt+">=0","missing vertex count")})):(Rt=_t.def(Bt,".",Yu),te.optional(function(){Oe.assert(_t,Rt+">=0","missing vertex count")})),Rt}var f=ut();function d(At){var Rt=Dt[At];return Rt?Rt.contextDep&&$t.contextDynamic||Rt.propDep?Rt.append(Oe,ft):Rt.append(Oe,Ve):Ve.def(Bt,".",At)}var E=d($o),S=d(Gs),M=h();if(typeof M=="number"){if(M===0)return}else ft("if(",M,"){"),ft.exit("}");var O,F;Ur&&(O=d(Jf),F=Oe.instancing);var $=f+".type",pe=Dt.elements&&Bl(Dt.elements);function we(){function At(){ft(F,".drawElementsInstancedANGLE(",[E,M,$,S+"<<(("+$+"-"+Nh+")>>1)",O],");")}function Rt(){ft(F,".drawArraysInstancedANGLE(",[E,S,M,O],");")}f?pe?At():(ft("if(",f,"){"),At(),ft("}else{"),Rt(),ft("}")):Rt()}function $e(){function At(){ft(wt+".drawElements("+[E,M,$,S+"<<(("+$+"-"+Nh+")>>1)"]+");")}function Rt(){ft(wt+".drawArrays("+[E,S,M]+");")}f?pe?At():(ft("if(",f,"){"),At(),ft("}else{"),Rt(),ft("}")):Rt()}Ur&&(typeof O!="number"||O>=0)?typeof O=="string"?(ft("if(",O,">0){"),we(),ft("}else if(",O,"<0){"),$e(),ft("}")):we():$e()}function vn(Oe,Ve,ft,$t,tr){var wt=ai(),Bt=wt.proc("body",tr);return te.optional(function(){wt.commandStr=Ve.commandStr,wt.command=wt.link(Ve.commandStr)}),Ur&&(wt.instancing=Bt.def(wt.shared.extensions,".angle_instanced_arrays")),Oe(wt,Bt,ft,$t),wt.compile().body}function si(Oe,Ve,ft,$t){hs(Oe,Ve),ft.useVAO?ft.drawVAO?Ve(Oe.shared.vao,".setVAO(",ft.drawVAO.append(Oe,Ve),");"):Ve(Oe.shared.vao,".setVAO(",Oe.shared.vao,".targetVAO);"):(Ve(Oe.shared.vao,".setVAO(null);"),to(Oe,Ve,ft,$t.attributes,function(){return!0})),pn(Oe,Ve,ft,$t.uniforms,function(){return!0}),Mn(Oe,Ve,Ve,ft)}function go(Oe,Ve){var ft=Oe.proc("draw",1);hs(Oe,ft),No(Oe,ft,Ve.context),qo(Oe,ft,Ve.framebuffer),Ko(Oe,ft,Ve),Ns(Oe,ft,Ve.state),ti(Oe,ft,Ve,!1,!0);var $t=Ve.shader.progVar.append(Oe,ft);if(ft(Oe.shared.gl,".useProgram(",$t,".program);"),Ve.shader.program)si(Oe,ft,Ve,Ve.shader.program);else{ft(Oe.shared.vao,".setVAO(null);");var tr=Oe.global.def("{}"),wt=ft.def($t,".id"),Bt=ft.def(tr,"[",wt,"]");ft(Oe.cond(Bt).then(Bt,".call(this,a0);").else(Bt,"=",tr,"[",wt,"]=",Oe.link(function(Dt){return vn(si,Oe,Ve,Dt,1)}),"(",$t,");",Bt,".call(this,a0);"))}Object.keys(Ve.state).length>0&&ft(Oe.shared.current,".dirty=true;")}function pl(Oe,Ve,ft,$t){Oe.batchId="a1",hs(Oe,Ve);function tr(){return!0}to(Oe,Ve,ft,$t.attributes,tr),pn(Oe,Ve,ft,$t.uniforms,tr),Mn(Oe,Ve,Ve,ft)}function ht(Oe,Ve,ft,$t){hs(Oe,Ve);var tr=ft.contextDep,wt=Ve.def(),Bt="a0",Dt="a1",ut=Ve.def();Oe.shared.props=ut,Oe.batchId=wt;var h=Oe.scope(),f=Oe.scope();Ve(h.entry,"for(",wt,"=0;",wt,"<",Dt,";++",wt,"){",ut,"=",Bt,"[",wt,"];",f,"}",h.exit);function d($){return $.contextDep&&tr||$.propDep}function E($){return!d($)}if(ft.needsContext&&No(Oe,f,ft.context),ft.needsFramebuffer&&qo(Oe,f,ft.framebuffer),Ns(Oe,f,ft.state,d),ft.profile&&d(ft.profile)&&ti(Oe,f,ft,!1,!0),$t)ft.useVAO?ft.drawVAO?d(ft.drawVAO)?f(Oe.shared.vao,".setVAO(",ft.drawVAO.append(Oe,f),");"):h(Oe.shared.vao,".setVAO(",ft.drawVAO.append(Oe,h),");"):h(Oe.shared.vao,".setVAO(",Oe.shared.vao,".targetVAO);"):(h(Oe.shared.vao,".setVAO(null);"),to(Oe,h,ft,$t.attributes,E),to(Oe,f,ft,$t.attributes,d)),pn(Oe,h,ft,$t.uniforms,E),pn(Oe,f,ft,$t.uniforms,d),Mn(Oe,h,f,ft);else{var S=Oe.global.def("{}"),M=ft.shader.progVar.append(Oe,f),O=f.def(M,".id"),F=f.def(S,"[",O,"]");f(Oe.shared.gl,".useProgram(",M,".program);","if(!",F,"){",F,"=",S,"[",O,"]=",Oe.link(function($){return vn(pl,Oe,ft,$,2)}),"(",M,");}",F,".call(this,a0[",wt,"],",wt,");")}}function Tt(Oe,Ve){var ft=Oe.proc("batch",2);Oe.batchId="0",hs(Oe,ft);var $t=!1,tr=!0;Object.keys(Ve.context).forEach(function(S){$t=$t||Ve.context[S].propDep}),$t||(No(Oe,ft,Ve.context),tr=!1);var wt=Ve.framebuffer,Bt=!1;wt?(wt.propDep?$t=Bt=!0:wt.contextDep&&$t&&(Bt=!0),Bt||qo(Oe,ft,wt)):qo(Oe,ft,null),Ve.state.viewport&&Ve.state.viewport.propDep&&($t=!0);function Dt(S){return S.contextDep&&$t||S.propDep}Ko(Oe,ft,Ve),Ns(Oe,ft,Ve.state,function(S){return!Dt(S)}),(!Ve.profile||!Dt(Ve.profile))&&ti(Oe,ft,Ve,!1,"a1"),Ve.contextDep=$t,Ve.needsContext=tr,Ve.needsFramebuffer=Bt;var ut=Ve.shader.progVar;if(ut.contextDep&&$t||ut.propDep)ht(Oe,ft,Ve,null);else{var h=ut.append(Oe,ft);if(ft(Oe.shared.gl,".useProgram(",h,".program);"),Ve.shader.program)ht(Oe,ft,Ve,Ve.shader.program);else{ft(Oe.shared.vao,".setVAO(null);");var f=Oe.global.def("{}"),d=ft.def(h,".id"),E=ft.def(f,"[",d,"]");ft(Oe.cond(E).then(E,".call(this,a0,a1);").else(E,"=",f,"[",d,"]=",Oe.link(function(S){return vn(ht,Oe,Ve,S,2)}),"(",h,");",E,".call(this,a0,a1);"))}}Object.keys(Ve.state).length>0&&ft(Oe.shared.current,".dirty=true;")}function Xt(Oe,Ve){var ft=Oe.proc("scope",3);Oe.batchId="a2";var $t=Oe.shared,tr=$t.current;No(Oe,ft,Ve.context),Ve.framebuffer&&Ve.framebuffer.append(Oe,ft),I0(Object.keys(Ve.state)).forEach(function(Bt){var Dt=Ve.state[Bt],ut=Dt.append(Oe,ft);Pa(ut)?ut.forEach(function(h,f){ft.set(Oe.next[Bt],"["+f+"]",h)}):ft.set($t.next,"."+Bt,ut)}),ti(Oe,ft,Ve,!0,!0),[ff,Gs,Yu,Jf,$o].forEach(function(Bt){var Dt=Ve.draw[Bt];Dt&&ft.set($t.draw,"."+Bt,""+Dt.append(Oe,ft))}),Object.keys(Ve.uniforms).forEach(function(Bt){ft.set($t.uniforms,"["+Je.id(Bt)+"]",Ve.uniforms[Bt].append(Oe,ft))}),Object.keys(Ve.attributes).forEach(function(Bt){var Dt=Ve.attributes[Bt].append(Oe,ft),ut=Oe.scopeAttrib(Bt);Object.keys(new jt).forEach(function(h){ft.set(ut,"."+h,Dt[h])})}),Ve.scopeVAO&&ft.set($t.vao,".targetVAO",Ve.scopeVAO.append(Oe,ft));function wt(Bt){var Dt=Ve.shader[Bt];Dt&&ft.set($t.shader,"."+Bt,Dt.append(Oe,ft))}wt(Xu),wt(Kf),Object.keys(Ve.state).length>0&&(ft(tr,".dirty=true;"),ft.exit(tr,".dirty=true;")),ft("a1(",Oe.shared.context,",a0,",Oe.batchId,");")}function xt(Oe){if(!(typeof Oe!="object"||Pa(Oe))){for(var Ve=Object.keys(Oe),ft=0;ft<Ve.length;++ft)if(Sr.isDynamic(Oe[Ve[ft]]))return!0;return!1}}function di(Oe,Ve,ft){var $t=Ve.static[ft];if(!$t||!xt($t))return;var tr=Oe.global,wt=Object.keys($t),Bt=!1,Dt=!1,ut=!1,h=Oe.global.def("{}");wt.forEach(function(d){var E=$t[d];if(Sr.isDynamic(E)){typeof E=="function"&&(E=$t[d]=Sr.unbox(E));var S=Js(E,null);Bt=Bt||S.thisDep,ut=ut||S.propDep,Dt=Dt||S.contextDep}else{switch(tr(h,".",d,"="),typeof E){case"number":tr(E);break;case"string":tr('"',E,'"');break;case"object":Array.isArray(E)&&tr("[",E.join(),"]");break;default:tr(Oe.link(E));break}tr(";")}});function f(d,E){wt.forEach(function(S){var M=$t[S];if(Sr.isDynamic(M)){var O=d.invoke(E,M);E(h,".",S,"=",O,";")}})}Ve.dynamic[ft]=new Sr.DynamicVariable(Y0,{thisDep:Bt,contextDep:Dt,propDep:ut,ref:h,append:f}),delete Ve.static[ft]}function Da(Oe,Ve,ft,$t,tr){var wt=ai();wt.stats=wt.link(tr),Object.keys(Ve.static).forEach(function(Dt){di(wt,Ve,Dt)}),Dl.forEach(function(Dt){di(wt,Oe,Dt)});var Bt=uo(Oe,Ve,ft,$t,wt);return go(wt,Bt),Xt(wt,Bt),Tt(wt,Bt),wt.compile()}return{next:An,current:Rr,procs:function(){var Oe=ai(),Ve=Oe.proc("poll"),ft=Oe.proc("refresh"),$t=Oe.block();Ve($t),ft($t);var tr=Oe.shared,wt=tr.gl,Bt=tr.next,Dt=tr.current;$t(Dt,".dirty=false;"),qo(Oe,Ve),qo(Oe,ft,null,!0);var ut;Ur&&(ut=Oe.link(Ur)),Et.oes_vertex_array_object&&ft(Oe.link(Et.oes_vertex_array_object),".bindVertexArrayOES(null);");for(var h=0;h<sr.maxAttributes;++h){var f=ft.def(tr.attributes,"[",h,"]"),d=Oe.cond(f,".buffer");d.then(wt,".enableVertexAttribArray(",h,");",wt,".bindBuffer(",Ll,",",f,".buffer.buffer);",wt,".vertexAttribPointer(",h,",",f,".size,",f,".type,",f,".normalized,",f,".stride,",f,".offset);").else(wt,".disableVertexAttribArray(",h,");",wt,".vertexAttrib4f(",h,",",f,".x,",f,".y,",f,".z,",f,".w);",f,".buffer=null;"),ft(d),Ur&&ft(ut,".vertexAttribDivisorANGLE(",h,",",f,".divisor);")}return ft(Oe.shared.vao,".currentVAO=null;",Oe.shared.vao,".setVAO(",Oe.shared.vao,".targetVAO);"),Object.keys(sn).forEach(function(E){var S=sn[E],M=$t.def(Bt,".",E),O=Oe.block();O("if(",M,"){",wt,".enable(",S,")}else{",wt,".disable(",S,")}",Dt,".",E,"=",M,";"),ft(O),Ve("if(",M,"!==",Dt,".",E,"){",O,"}")}),Object.keys(wr).forEach(function(E){var S=wr[E],M=Rr[E],O,F,$=Oe.block();if($(wt,".",S,"("),Pa(M)){var pe=M.length;O=Oe.global.def(Bt,".",E),F=Oe.global.def(Dt,".",E),$(no(pe,function(we){return O+"["+we+"]"}),");",no(pe,function(we){return F+"["+we+"]="+O+"["+we+"];"}).join("")),Ve("if(",no(pe,function(we){return O+"["+we+"]!=="+F+"["+we+"]"}).join("||"),"){",$,"}")}else O=$t.def(Bt,".",E),F=$t.def(Dt,".",E),$(O,");",Dt,".",E,"=",O,";"),Ve("if(",O,"!==",F,"){",$,"}");ft($)}),Oe.compile()}(),compile:Da}}function eu(){return{vaoCount:0,bufferCount:0,elementsCount:0,framebufferCount:0,shaderCount:0,textureCount:0,cubeCount:0,renderbufferCount:0,maxTextureUnits:0}}var mf=34918,_f=34919,Al=35007,u0=function(Te,Je){if(!Je.ext_disjoint_timer_query)return null;var Et=[];function sr(){return Et.pop()||Je.ext_disjoint_timer_query.createQueryEXT()}function Er(Ur){Et.push(Ur)}var lr=[];function gr(Ur){var Jr=sr();Je.ext_disjoint_timer_query.beginQueryEXT(Al,Jr),lr.push(Jr),Dr(lr.length-1,lr.length,Ur)}function kr(){Je.ext_disjoint_timer_query.endQueryEXT(Al)}function Pr(){this.startQueryIndex=-1,this.endQueryIndex=-1,this.sum=0,this.stats=null}var qr=[];function Br(){return qr.pop()||new Pr}function Vr(Ur){qr.push(Ur)}var Kr=[];function Dr(Ur,Jr,Rr){var An=Br();An.startQueryIndex=Ur,An.endQueryIndex=Jr,An.sum=0,An.stats=Rr,Kr.push(An)}var jr=[],jt=[];function Ar(){var Ur,Jr,Rr=lr.length;if(Rr!==0){jt.length=Math.max(jt.length,Rr+1),jr.length=Math.max(jr.length,Rr+1),jr[0]=0,jt[0]=0;var An=0;for(Ur=0,Jr=0;Jr<lr.length;++Jr){var Fr=lr[Jr];Je.ext_disjoint_timer_query.getQueryObjectEXT(Fr,_f)?(An+=Je.ext_disjoint_timer_query.getQueryObjectEXT(Fr,mf),Er(Fr)):lr[Ur++]=Fr,jr[Jr+1]=An,jt[Jr+1]=Ur}for(lr.length=Ur,Ur=0,Jr=0;Jr<Kr.length;++Jr){var sn=Kr[Jr],wr=sn.startQueryIndex,en=sn.endQueryIndex;sn.sum+=jr[en]-jr[wr];var Nn=jt[wr],hi=jt[en];hi===Nn?(sn.stats.gpuTime+=sn.sum/1e6,Vr(sn)):(sn.startQueryIndex=Nn,sn.endQueryIndex=hi,Kr[Ur++]=sn)}Kr.length=Ur}}return{beginQuery:gr,endQuery:kr,pushScopeStats:Dr,update:Ar,getNumPendingQueries:function(){return lr.length},clear:function(){Et.push.apply(Et,lr);for(var Ur=0;Ur<Et.length;Ur++)Je.ext_disjoint_timer_query.deleteQueryEXT(Et[Ur]);lr.length=0,Et.length=0},restore:function(){lr.length=0,Et.length=0}}},Wh=16384,yf=256,O0=1024,N0=34962,sh="webglcontextlost",Ef="webglcontextrestored",Zf=1,so=2,zf=3;function xc(Te,Je){for(var Et=0;Et<Te.length;++Et)if(Te[Et]===Je)return Et;return-1}function Su(Te){var Je=ja(Te);if(!Je)return null;var Et=Je.gl,sr=Et.getContextAttributes(),Er=Et.isContextLost(),lr=Wr(Et,Je);if(!lr)return null;var gr=hn(),kr=eu(),Pr=lr.extensions,qr=u0(Et,Pr),Br=on(),Vr=Et.drawingBufferWidth,Kr=Et.drawingBufferHeight,Dr={tick:0,time:0,viewportWidth:Vr,viewportHeight:Kr,framebufferWidth:Vr,framebufferHeight:Kr,drawingBufferWidth:Vr,drawingBufferHeight:Kr,pixelRatio:Je.pixelRatio},jr={},jt={elements:null,primitive:4,count:-1,offset:0,instances:-1},Ar=al(Et,Pr),Ur=io(Et,kr,Je,Rr),Jr=Yr(Et,Pr,Ar,kr,Ur);function Rr(Mn){return Jr.destroyBuffer(Mn)}var An=Yl(Et,Pr,Ur,kr),Fr=Zn(Et,gr,kr,Je),sn=ra(Et,Pr,Ar,function(){Nn.procs.poll()},Dr,kr,Je),wr=ql(Et,Pr,Ar,kr,Je),en=xa(Et,Pr,Ar,sn,wr,kr),Nn=P0(Et,gr,Pr,Ar,Ur,An,sn,en,jr,Jr,Fr,jt,Dr,qr,Je),hi=Nl(Et,en,Nn.procs.poll,Dr,sr,Pr,Ar),an=Nn.next,Zr=Et.canvas,Tr=[],ai=[],Yn=[],Pn=[Je.onDestroy],Di=null;function ei(){if(Tr.length===0){qr&&qr.update(),Di=null;return}Di=Lr.next(ei),Ns();for(var Mn=Tr.length-1;Mn>=0;--Mn){var vn=Tr[Mn];vn&&vn(Dr,null,0)}Et.flush(),qr&&qr.update()}function qn(){!Di&&Tr.length>0&&(Di=Lr.next(ei))}function ga(){Di&&(Lr.cancel(ei),Di=null)}function Oo(Mn){Mn.preventDefault(),Er=!0,ga(),ai.forEach(function(vn){vn()})}function Wo(Mn){Et.getError(),Er=!1,lr.restore(),Fr.restore(),Ur.restore(),sn.restore(),wr.restore(),en.restore(),Jr.restore(),qr&&qr.restore(),Nn.procs.refresh(),qn(),Yn.forEach(function(vn){vn()})}Zr&&(Zr.addEventListener(sh,Oo,!1),Zr.addEventListener(Ef,Wo,!1));function Xi(){Tr.length=0,ga(),Zr&&(Zr.removeEventListener(sh,Oo),Zr.removeEventListener(Ef,Wo)),Fr.clear(),en.clear(),wr.clear(),sn.clear(),An.clear(),Ur.clear(),Jr.clear(),qr&&qr.clear(),Pn.forEach(function(Mn){Mn()})}function Qo(Mn){te(!!Mn,"invalid args to regl({...})"),te.type(Mn,"object","invalid args to regl({...})");function vn(tr){var wt=C({},tr);delete wt.uniforms,delete wt.attributes,delete wt.context,delete wt.vao,"stencil"in wt&&wt.stencil.op&&(wt.stencil.opBack=wt.stencil.opFront=wt.stencil.op,delete wt.stencil.op);function Bt(Dt){if(Dt in wt){var ut=wt[Dt];delete wt[Dt],Object.keys(ut).forEach(function(h){wt[Dt+"."+h]=ut[h]})}}return Bt("blend"),Bt("depth"),Bt("cull"),Bt("stencil"),Bt("polygonOffset"),Bt("scissor"),Bt("sample"),"vao"in tr&&(wt.vao=tr.vao),wt}function si(tr){var wt={},Bt={};return Object.keys(tr).forEach(function(Dt){var ut=tr[Dt];Sr.isDynamic(ut)?Bt[Dt]=Sr.unbox(ut,Dt):wt[Dt]=ut}),{dynamic:Bt,static:wt}}var go=si(Mn.context||{}),pl=si(Mn.uniforms||{}),ht=si(Mn.attributes||{}),Tt=si(vn(Mn)),Xt={gpuTime:0,cpuTime:0,count:0},xt=Nn.compile(Tt,ht,pl,go,Xt),di=xt.draw,Da=xt.batch,Oe=xt.scope,Ve=[];function ft(tr){for(;Ve.length<tr;)Ve.push(null);return Ve}function $t(tr,wt){var Bt;if(Er&&te.raise("context lost"),typeof tr=="function")return Oe.call(this,null,tr,0);if(typeof wt=="function")if(typeof tr=="number")for(Bt=0;Bt<tr;++Bt)Oe.call(this,null,wt,Bt);else if(Array.isArray(tr))for(Bt=0;Bt<tr.length;++Bt)Oe.call(this,tr[Bt],wt,Bt);else return Oe.call(this,tr,wt,0);else if(typeof tr=="number"){if(tr>0)return Da.call(this,ft(tr|0),tr|0)}else if(Array.isArray(tr)){if(tr.length)return Da.call(this,tr,tr.length)}else return di.call(this,tr)}return C($t,{stats:Xt})}var eo=en.setFBO=Qo({framebuffer:Sr.define.call(null,Zf,"framebuffer")});function uo(Mn,vn){var si=0;Nn.procs.poll();var go=vn.color;go&&(Et.clearColor(+go[0]||0,+go[1]||0,+go[2]||0,+go[3]||0),si|=Wh),"depth"in vn&&(Et.clearDepth(+vn.depth),si|=yf),"stencil"in vn&&(Et.clearStencil(vn.stencil|0),si|=O0),te(!!si,"called regl.clear with no buffer specified"),Et.clear(si)}function No(Mn){if(te(typeof Mn=="object"&&Mn,"regl.clear() takes an object as input"),"framebuffer"in Mn)if(Mn.framebuffer&&Mn.framebuffer_reglType==="framebufferCube")for(var vn=0;vn<6;++vn)eo(C({framebuffer:Mn.framebuffer.faces[vn]},Mn),uo);else eo(Mn,uo);else uo(null,Mn)}function qo(Mn){te.type(Mn,"function","regl.frame() callback must be a function"),Tr.push(Mn);function vn(){var si=xc(Tr,Mn);te(si>=0,"cannot cancel a frame twice");function go(){var pl=xc(Tr,go);Tr[pl]=Tr[Tr.length-1],Tr.length-=1,Tr.length<=0&&ga()}Tr[si]=go}return qn(),{cancel:vn}}function Ko(){var Mn=an.viewport,vn=an.scissor_box;Mn[0]=Mn[1]=vn[0]=vn[1]=0,Dr.viewportWidth=Dr.framebufferWidth=Dr.drawingBufferWidth=Mn[2]=vn[2]=Et.drawingBufferWidth,Dr.viewportHeight=Dr.framebufferHeight=Dr.drawingBufferHeight=Mn[3]=vn[3]=Et.drawingBufferHeight}function Ns(){Dr.tick+=1,Dr.time=ti(),Ko(),Nn.procs.poll()}function hs(){Ko(),Nn.procs.refresh(),qr&&qr.update()}function ti(){return(on()-Br)/1e3}hs();function to(Mn,vn){te.type(vn,"function","listener callback must be a function");var si;switch(Mn){case"frame":return qo(vn);case"lost":si=ai;break;case"restore":si=Yn;break;case"destroy":si=Pn;break;default:te.raise("invalid event, must be one of frame,lost,restore,destroy")}return si.push(vn),{cancel:function(){for(var go=0;go<si.length;++go)if(si[go]===vn){si[go]=si[si.length-1],si.pop();return}}}}var pn=C(Qo,{clear:No,prop:Sr.define.bind(null,Zf),context:Sr.define.bind(null,so),this:Sr.define.bind(null,zf),draw:Qo({}),buffer:function(Mn){return Ur.create(Mn,N0,!1,!1)},elements:function(Mn){return An.create(Mn,!1)},texture:sn.create2D,cube:sn.createCube,renderbuffer:wr.create,framebuffer:en.create,framebufferCube:en.createCube,vao:Jr.createVAO,attributes:sr,frame:qo,on:to,limits:Ar,hasExtension:function(Mn){return Ar.extensions.indexOf(Mn.toLowerCase())>=0},read:hi,destroy:Xi,_gl:Et,_refresh:hs,poll:function(){Ns(),qr&&qr.update()},now:ti,stats:kr});return Je.onDone(null,pn),pn}return Su})},45229:function(ae,j){(function(C,I){I(j)})(this,function(C){"use strict";const D=33306690738754706e-32;function G(Ze,qe,De,Ge,Re){let Me,ce,Be,Ee,Se=qe[0],oe=Ge[0],Y=0,Ne=0;oe>Se==oe>-Se?(Me=Se,Se=qe[++Y]):(Me=oe,oe=Ge[++Ne]);let ge=0;if(Y<Ze&&Ne<De)for(oe>Se==oe>-Se?(Be=Me-((ce=Se+Me)-Se),Se=qe[++Y]):(Be=Me-((ce=oe+Me)-oe),oe=Ge[++Ne]),Me=ce,Be!==0&&(Re[ge++]=Be);Y<Ze&&Ne<De;)oe>Se==oe>-Se?(Be=Me-((ce=Me+Se)-(Ee=ce-Me))+(Se-Ee),Se=qe[++Y]):(Be=Me-((ce=Me+oe)-(Ee=ce-Me))+(oe-Ee),oe=Ge[++Ne]),Me=ce,Be!==0&&(Re[ge++]=Be);for(;Y<Ze;)Be=Me-((ce=Me+Se)-(Ee=ce-Me))+(Se-Ee),Se=qe[++Y],Me=ce,Be!==0&&(Re[ge++]=Be);for(;Ne<De;)Be=Me-((ce=Me+oe)-(Ee=ce-Me))+(oe-Ee),oe=Ge[++Ne],Me=ce,Be!==0&&(Re[ge++]=Be);return Me===0&&ge!==0||(Re[ge++]=Me),ge}function U(Ze){return new Float64Array(Ze)}const B=33306690738754716e-32,Z=22204460492503146e-32,X=11093356479670487e-47,q=U(4),ie=U(8),he=U(12),Ce=U(16),be=U(4);C.orient2d=function(Ze,qe,De,Ge,Re,Me){const ce=(qe-Me)*(De-Re),Be=(Ze-Re)*(Ge-Me),Ee=ce-Be;if(ce===0||Be===0||ce>0!=Be>0)return Ee;const Se=Math.abs(ce+Be);return Math.abs(Ee)>=B*Se?Ee:-function(oe,Y,Ne,ge,xe,ye,Q){let Pe,Ae,_e,ue,ke,ze,le,Ut,kt,pr,Wt,Xr,fn,Ir,Qr,tn,Mr,$n;const li=oe-xe,Kn=Ne-xe,$r=Y-ye,ln=ge-ye;ke=(Qr=(Ut=li-(le=(ze=134217729*li)-(ze-li)))*(pr=ln-(kt=(ze=134217729*ln)-(ze-ln)))-((Ir=li*ln)-le*kt-Ut*kt-le*pr))-(Wt=Qr-(Mr=(Ut=$r-(le=(ze=134217729*$r)-(ze-$r)))*(pr=Kn-(kt=(ze=134217729*Kn)-(ze-Kn)))-((tn=$r*Kn)-le*kt-Ut*kt-le*pr))),q[0]=Qr-(Wt+ke)+(ke-Mr),ke=(fn=Ir-((Xr=Ir+Wt)-(ke=Xr-Ir))+(Wt-ke))-(Wt=fn-tn),q[1]=fn-(Wt+ke)+(ke-tn),ke=($n=Xr+Wt)-Xr,q[2]=Xr-($n-ke)+(Wt-ke),q[3]=$n;let Cn=function(We,Qe){let vt=Qe[0];for(let Lt=1;Lt<We;Lt++)vt+=Qe[Lt];return vt}(4,q),$i=Z*Q;if(Cn>=$i||-Cn>=$i||(Pe=oe-(li+(ke=oe-li))+(ke-xe),_e=Ne-(Kn+(ke=Ne-Kn))+(ke-xe),Ae=Y-($r+(ke=Y-$r))+(ke-ye),ue=ge-(ln+(ke=ge-ln))+(ke-ye),Pe===0&&Ae===0&&_e===0&&ue===0)||($i=X*Q+D*Math.abs(Cn),(Cn+=li*ue+ln*Pe-($r*_e+Kn*Ae))>=$i||-Cn>=$i))return Cn;ke=(Qr=(Ut=Pe-(le=(ze=134217729*Pe)-(ze-Pe)))*(pr=ln-(kt=(ze=134217729*ln)-(ze-ln)))-((Ir=Pe*ln)-le*kt-Ut*kt-le*pr))-(Wt=Qr-(Mr=(Ut=Ae-(le=(ze=134217729*Ae)-(ze-Ae)))*(pr=Kn-(kt=(ze=134217729*Kn)-(ze-Kn)))-((tn=Ae*Kn)-le*kt-Ut*kt-le*pr))),be[0]=Qr-(Wt+ke)+(ke-Mr),ke=(fn=Ir-((Xr=Ir+Wt)-(ke=Xr-Ir))+(Wt-ke))-(Wt=fn-tn),be[1]=fn-(Wt+ke)+(ke-tn),ke=($n=Xr+Wt)-Xr,be[2]=Xr-($n-ke)+(Wt-ke),be[3]=$n;const ci=G(4,q,4,be,ie);ke=(Qr=(Ut=li-(le=(ze=134217729*li)-(ze-li)))*(pr=ue-(kt=(ze=134217729*ue)-(ze-ue)))-((Ir=li*ue)-le*kt-Ut*kt-le*pr))-(Wt=Qr-(Mr=(Ut=$r-(le=(ze=134217729*$r)-(ze-$r)))*(pr=_e-(kt=(ze=134217729*_e)-(ze-_e)))-((tn=$r*_e)-le*kt-Ut*kt-le*pr))),be[0]=Qr-(Wt+ke)+(ke-Mr),ke=(fn=Ir-((Xr=Ir+Wt)-(ke=Xr-Ir))+(Wt-ke))-(Wt=fn-tn),be[1]=fn-(Wt+ke)+(ke-tn),ke=($n=Xr+Wt)-Xr,be[2]=Xr-($n-ke)+(Wt-ke),be[3]=$n;const Ft=G(ci,ie,4,be,he);ke=(Qr=(Ut=Pe-(le=(ze=134217729*Pe)-(ze-Pe)))*(pr=ue-(kt=(ze=134217729*ue)-(ze-ue)))-((Ir=Pe*ue)-le*kt-Ut*kt-le*pr))-(Wt=Qr-(Mr=(Ut=Ae-(le=(ze=134217729*Ae)-(ze-Ae)))*(pr=_e-(kt=(ze=134217729*_e)-(ze-_e)))-((tn=Ae*_e)-le*kt-Ut*kt-le*pr))),be[0]=Qr-(Wt+ke)+(ke-Mr),ke=(fn=Ir-((Xr=Ir+Wt)-(ke=Xr-Ir))+(Wt-ke))-(Wt=fn-tn),be[1]=fn-(Wt+ke)+(ke-tn),ke=($n=Xr+Wt)-Xr,be[2]=Xr-($n-ke)+(Wt-ke),be[3]=$n;const te=G(Ft,he,4,be,Ce);return Ce[te-1]}(Ze,qe,De,Ge,Re,Me,Se)},C.orient2dfast=function(Ze,qe,De,Ge,Re,Me){return(qe-Me)*(De-Re)-(Ze-Re)*(Ge-Me)},Object.defineProperty(C,"__esModule",{value:!0})})},59662:function(ae,j,C){"use strict";var I=C(44532),D=C(51494),G=C(38262)(),U=C(67747),B=I("%TypeError%"),Z=I("%Math.floor%");ae.exports=function(q,ie){if(typeof q!="function")throw new B("`fn` is not a function");if(typeof ie!="number"||ie<0||ie>4294967295||Z(ie)!==ie)throw new B("`length` must be a positive 32-bit integer");var he=arguments.length>2&&!!arguments[2],Ce=!0,be=!0;if("length"in q&&U){var Ze=U(q,"length");Ze&&!Ze.configurable&&(Ce=!1),Ze&&!Ze.writable&&(be=!1)}return(Ce||be||!he)&&(G?D(q,"length",ie,!0,!0):D(q,"length",ie)),q}},76160:function(ae,j,C){"use strict";var I=C(51494),D=C(38262)(),G=C(8325).functionsHaveConfigurableNames(),U=TypeError;ae.exports=function(Z,X){if(typeof Z!="function")throw new U("`fn` is not a function");var q=arguments.length>2&&!!arguments[2];return(!q||G)&&(D?I(Z,"name",X,!0,!0):I(Z,"name",X)),Z}},74995:function(ae){"use strict";ae.exports={eudist:function(C,I,D){for(var G=C.length,U=0,B=0;B<G;B++){var Z=(C[B]||0)-(I[B]||0);U+=Z*Z}return D?Math.sqrt(U):U},mandist:function(C,I,D){for(var G=C.length,U=0,B=0;B<G;B++)U+=Math.abs((C[B]||0)-(I[B]||0));return D?Math.sqrt(U):U},dist:function(C,I,D){var G=Math.abs(C-I);return D?G:G*G}}},72488:function(ae,j,C){"use strict";var I=C(74995),D=I.eudist,G=I.dist;ae.exports={kmrand:function(B,Z){for(var X={},q=[],ie=Z<<2,he=B.length,Ce=B[0].length>0;q.length<Z&&ie-- >0;){var be=B[Math.floor(Math.random()*he)],Ze=Ce?be.join("_"):""+be;X[Ze]||(X[Ze]=!0,q.push(be))}if(q.length<Z)throw new Error("Error initializating clusters");return q},kmpp:function(B,Z){var X=B[0].length?D:G,q=[],ie=B.length,he=B[0].length>0,Ce={},be=B[Math.floor(Math.random()*ie)],Ze=he?be.join("_"):""+be;for(q.push(be),Ce[Ze]=!0;q.length<Z;){for(var qe=[],De=q.length,Ge=0,Re=[],Me=0;Me<ie;Me++){for(var ce=1/0,Be=0;Be<De;Be++){var Ee=X(B[Me],q[Be]);Ee<=ce&&(ce=Ee)}qe[Me]=ce}for(var Se=0;Se<ie;Se++)Ge+=qe[Se];for(var oe=0;oe<ie;oe++)Re[oe]={i:oe,v:B[oe],pr:qe[oe]/Ge,cs:0};Re.sort(function(xe,ye){return xe.pr-ye.pr}),Re[0].cs=Re[0].pr;for(var Y=1;Y<ie;Y++)Re[Y].cs=Re[Y-1].cs+Re[Y].pr;for(var Ne=Math.random(),ge=0;ge<ie-1&&Re[ge++].cs<Ne;);q.push(Re[ge-1].v)}return q}}},89345:function(ae,j,C){"use strict";var I=C(74995),D=C(72488),G=I.eudist,U=I.mandist,B=I.dist,Z=D.kmrand,X=D.kmpp,q=1e4;function ie(Ce,be,Ze){Ze=Ze||[];for(var qe=0;qe<Ce;qe++)Ze[qe]=be;return Ze}function he(Ce,be,Ze,qe){var De=[],Ge=[],Re=[],Me=[],ce=!1,Be=qe||q,Ee=Ce.length,Se=Ce[0].length,oe=Se>0,Y=[];if(Ze)Ze=="kmrand"?De=Z(Ce,be):Ze=="kmpp"?De=X(Ce,be):De=Ze;else for(var Ne={};De.length<be;){var ge=Math.floor(Math.random()*Ee);Ne[ge]||(Ne[ge]=!0,De.push(Ce[ge]))}do{ie(be,0,Y);for(var xe=0;xe<Ee;xe++){for(var ye=1/0,Q=0,Pe=0;Pe<be;Pe++){var Me=oe?G(Ce[xe],De[Pe]):Math.abs(Ce[xe]-De[Pe]);Me<=ye&&(ye=Me,Q=Pe)}Re[xe]=Q,Y[Q]++}for(var Ae=[],Ge=[],_e=0,ue=0;ue<be;ue++)Ae[ue]=oe?ie(Se,0,Ae[ue]):0,Ge[ue]=De[ue];if(oe){for(var ke=0;ke<be;ke++)De[ke]=[];for(var ze=0;ze<Ee;ze++)for(var le=Re[ze],Ut=Ae[le],kt=Ce[ze],pr=0;pr<Se;pr++)Ut[pr]+=kt[pr];ce=!0;for(var Wt=0;Wt<be;Wt++){for(var Xr=De[Wt],fn=Ae[Wt],Ir=Ge[Wt],Qr=Y[Wt],tn=0;tn<Se;tn++)Xr[tn]=fn[tn]/Qr||0;if(ce){for(var Mr=0;Mr<Se;Mr++)if(Ir[Mr]!=Xr[Mr]){ce=!1;break}}}}else{for(var $n=0;$n<Ee;$n++){var li=Re[$n];Ae[li]+=Ce[$n]}for(var Kn=0;Kn<be;Kn++)De[Kn]=Ae[Kn]/Y[Kn]||0;ce=!0;for(var $r=0;$r<be;$r++)if(Ge[$r]!=De[$r]){ce=!1;break}}ce=ce||--Be<=0}while(!ce);return{it:q-Be,k:be,idxs:Re,centroids:De}}ae.exports=he},77028:function(ae){(function(j,C){ae.exports=C()})(this,function(){"use strict";function j(oe,Y,Ne,ge,xe,ye){if(!(xe-ge<=Ne)){var Q=ge+xe>>1;C(oe,Y,Q,ge,xe,ye%2),j(oe,Y,Ne,ge,Q-1,ye+1),j(oe,Y,Ne,Q+1,xe,ye+1)}}function C(oe,Y,Ne,ge,xe,ye){for(;xe>ge;){if(xe-ge>600){var Q=xe-ge+1,Pe=Ne-ge+1,Ae=Math.log(Q),_e=.5*Math.exp(2*Ae/3),ue=.5*Math.sqrt(Ae*_e*(Q-_e)/Q)*(Pe-Q/2<0?-1:1),ke=Math.max(ge,Math.floor(Ne-Pe*_e/Q+ue)),ze=Math.min(xe,Math.floor(Ne+(Q-Pe)*_e/Q+ue));C(oe,Y,Ne,ke,ze,ye)}var le=Y[2*Ne+ye],Ut=ge,kt=xe;for(I(oe,Y,ge,Ne),Y[2*xe+ye]>le&&I(oe,Y,ge,xe);Ut<kt;){for(I(oe,Y,Ut,kt),Ut++,kt--;Y[2*Ut+ye]<le;)Ut++;for(;Y[2*kt+ye]>le;)kt--}Y[2*ge+ye]===le?I(oe,Y,ge,kt):(kt++,I(oe,Y,kt,xe)),kt<=Ne&&(ge=kt+1),Ne<=kt&&(xe=kt-1)}}function I(oe,Y,Ne,ge){D(oe,Ne,ge),D(Y,2*Ne,2*ge),D(Y,2*Ne+1,2*ge+1)}function D(oe,Y,Ne){var ge=oe[Y];oe[Y]=oe[Ne],oe[Ne]=ge}function G(oe,Y,Ne,ge,xe,ye,Q){for(var Pe=[0,oe.length-1,0],Ae=[],_e,ue;Pe.length;){var ke=Pe.pop(),ze=Pe.pop(),le=Pe.pop();if(ze-le<=Q){for(var Ut=le;Ut<=ze;Ut++)_e=Y[2*Ut],ue=Y[2*Ut+1],_e>=Ne&&_e<=xe&&ue>=ge&&ue<=ye&&Ae.push(oe[Ut]);continue}var kt=Math.floor((le+ze)/2);_e=Y[2*kt],ue=Y[2*kt+1],_e>=Ne&&_e<=xe&&ue>=ge&&ue<=ye&&Ae.push(oe[kt]);var pr=(ke+1)%2;(ke===0?Ne<=_e:ge<=ue)&&(Pe.push(le),Pe.push(kt-1),Pe.push(pr)),(ke===0?xe>=_e:ye>=ue)&&(Pe.push(kt+1),Pe.push(ze),Pe.push(pr))}return Ae}function U(oe,Y,Ne,ge,xe,ye){for(var Q=[0,oe.length-1,0],Pe=[],Ae=xe*xe;Q.length;){var _e=Q.pop(),ue=Q.pop(),ke=Q.pop();if(ue-ke<=ye){for(var ze=ke;ze<=ue;ze++)B(Y[2*ze],Y[2*ze+1],Ne,ge)<=Ae&&Pe.push(oe[ze]);continue}var le=Math.floor((ke+ue)/2),Ut=Y[2*le],kt=Y[2*le+1];B(Ut,kt,Ne,ge)<=Ae&&Pe.push(oe[le]);var pr=(_e+1)%2;(_e===0?Ne-xe<=Ut:ge-xe<=kt)&&(Q.push(ke),Q.push(le-1),Q.push(pr)),(_e===0?Ne+xe>=Ut:ge+xe>=kt)&&(Q.push(le+1),Q.push(ue),Q.push(pr))}return Pe}function B(oe,Y,Ne,ge){var xe=oe-Ne,ye=Y-ge;return xe*xe+ye*ye}var Z=function(oe){return oe[0]},X=function(oe){return oe[1]},q=function(Y,Ne,ge,xe,ye){Ne===void 0&&(Ne=Z),ge===void 0&&(ge=X),xe===void 0&&(xe=64),ye===void 0&&(ye=Float64Array),this.nodeSize=xe,this.points=Y;for(var Q=Y.length<65536?Uint16Array:Uint32Array,Pe=this.ids=new Q(Y.length),Ae=this.coords=new ye(Y.length*2),_e=0;_e<Y.length;_e++)Pe[_e]=_e,Ae[2*_e]=Ne(Y[_e]),Ae[2*_e+1]=ge(Y[_e]);j(Pe,Ae,xe,0,Pe.length-1,0)};q.prototype.range=function(Y,Ne,ge,xe){return G(this.ids,this.coords,Y,Ne,ge,xe,this.nodeSize)},q.prototype.within=function(Y,Ne,ge){return U(this.ids,this.coords,Y,Ne,ge,this.nodeSize)};var ie={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:function(oe){return oe}},he=Math.fround||function(oe){return function(Y){return oe[0]=+Y,oe[0]}}(new Float32Array(1)),Ce=function(Y){this.options=Be(Object.create(ie),Y),this.trees=new Array(this.options.maxZoom+1)};Ce.prototype.load=function(Y){var Ne=this.options,ge=Ne.log,xe=Ne.minZoom,ye=Ne.maxZoom,Q=Ne.nodeSize;ge&&console.time("total time");var Pe="prepare "+Y.length+" points";ge&&console.time(Pe),this.points=Y;for(var Ae=[],_e=0;_e<Y.length;_e++)Y[_e].geometry&&Ae.push(Ze(Y[_e],_e));this.trees[ye+1]=new q(Ae,Ee,Se,Q,Float32Array),ge&&console.timeEnd(Pe);for(var ue=ye;ue>=xe;ue--){var ke=+Date.now();Ae=this._cluster(Ae,ue),this.trees[ue]=new q(Ae,Ee,Se,Q,Float32Array),ge&&console.log("z%d: %d clusters in %dms",ue,Ae.length,+Date.now()-ke)}return ge&&console.timeEnd("total time"),this},Ce.prototype.getClusters=function(Y,Ne){var ge=((Y[0]+180)%360+360)%360-180,xe=Math.max(-90,Math.min(90,Y[1])),ye=Y[2]===180?180:((Y[2]+180)%360+360)%360-180,Q=Math.max(-90,Math.min(90,Y[3]));if(Y[2]-Y[0]>=360)ge=-180,ye=180;else if(ge>ye){var Pe=this.getClusters([ge,xe,180,Q],Ne),Ae=this.getClusters([-180,xe,ye,Q],Ne);return Pe.concat(Ae)}for(var _e=this.trees[this._limitZoom(Ne)],ue=_e.range(Ge(ge),Re(Q),Ge(ye),Re(xe)),ke=[],ze=0,le=ue;ze<le.length;ze+=1){var Ut=le[ze],kt=_e.points[Ut];ke.push(kt.numPoints?qe(kt):this.points[kt.index])}return ke},Ce.prototype.getChildren=function(Y){var Ne=this._getOriginId(Y),ge=this._getOriginZoom(Y),xe="No cluster with the specified id.",ye=this.trees[ge];if(!ye)throw new Error(xe);var Q=ye.points[Ne];if(!Q)throw new Error(xe);for(var Pe=this.options.radius/(this.options.extent*Math.pow(2,ge-1)),Ae=ye.within(Q.x,Q.y,Pe),_e=[],ue=0,ke=Ae;ue<ke.length;ue+=1){var ze=ke[ue],le=ye.points[ze];le.parentId===Y&&_e.push(le.numPoints?qe(le):this.points[le.index])}if(_e.length===0)throw new Error(xe);return _e},Ce.prototype.getLeaves=function(Y,Ne,ge){Ne=Ne||10,ge=ge||0;var xe=[];return this._appendLeaves(xe,Y,Ne,ge,0),xe},Ce.prototype.getTile=function(Y,Ne,ge){var xe=this.trees[this._limitZoom(Y)],ye=Math.pow(2,Y),Q=this.options,Pe=Q.extent,Ae=Q.radius,_e=Ae/Pe,ue=(ge-_e)/ye,ke=(ge+1+_e)/ye,ze={features:[]};return this._addTileFeatures(xe.range((Ne-_e)/ye,ue,(Ne+1+_e)/ye,ke),xe.points,Ne,ge,ye,ze),Ne===0&&this._addTileFeatures(xe.range(1-_e/ye,ue,1,ke),xe.points,ye,ge,ye,ze),Ne===ye-1&&this._addTileFeatures(xe.range(0,ue,_e/ye,ke),xe.points,-1,ge,ye,ze),ze.features.length?ze:null},Ce.prototype.getClusterExpansionZoom=function(Y){for(var Ne=this._getOriginZoom(Y)-1;Ne<=this.options.maxZoom;){var ge=this.getChildren(Y);if(Ne++,ge.length!==1)break;Y=ge[0].properties.cluster_id}return Ne},Ce.prototype._appendLeaves=function(Y,Ne,ge,xe,ye){for(var Q=this.getChildren(Ne),Pe=0,Ae=Q;Pe<Ae.length;Pe+=1){var _e=Ae[Pe],ue=_e.properties;if(ue&&ue.cluster?ye+ue.point_count<=xe?ye+=ue.point_count:ye=this._appendLeaves(Y,ue.cluster_id,ge,xe,ye):ye<xe?ye++:Y.push(_e),Y.length===ge)break}return ye},Ce.prototype._addTileFeatures=function(Y,Ne,ge,xe,ye,Q){for(var Pe=0,Ae=Y;Pe<Ae.length;Pe+=1){var _e=Ae[Pe],ue=Ne[_e],ke=ue.numPoints,ze=void 0,le=void 0,Ut=void 0;if(ke)ze=De(ue),le=ue.x,Ut=ue.y;else{var kt=this.points[ue.index];ze=kt.properties,le=Ge(kt.geometry.coordinates[0]),Ut=Re(kt.geometry.coordinates[1])}var pr={type:1,geometry:[[Math.round(this.options.extent*(le*ye-ge)),Math.round(this.options.extent*(Ut*ye-xe))]],tags:ze},Wt=void 0;ke?Wt=ue.id:this.options.generateId?Wt=ue.index:this.points[ue.index].id&&(Wt=this.points[ue.index].id),Wt!==void 0&&(pr.id=Wt),Q.features.push(pr)}},Ce.prototype._limitZoom=function(Y){return Math.max(this.options.minZoom,Math.min(Math.floor(+Y),this.options.maxZoom+1))},Ce.prototype._cluster=function(Y,Ne){for(var ge=[],xe=this.options,ye=xe.radius,Q=xe.extent,Pe=xe.reduce,Ae=xe.minPoints,_e=ye/(Q*Math.pow(2,Ne)),ue=0;ue<Y.length;ue++){var ke=Y[ue];if(!(ke.zoom<=Ne)){ke.zoom=Ne;for(var ze=this.trees[Ne+1],le=ze.within(ke.x,ke.y,_e),Ut=ke.numPoints||1,kt=Ut,pr=0,Wt=le;pr<Wt.length;pr+=1){var Xr=Wt[pr],fn=ze.points[Xr];fn.zoom>Ne&&(kt+=fn.numPoints||1)}if(kt>Ut&&kt>=Ae){for(var Ir=ke.x*Ut,Qr=ke.y*Ut,tn=Pe&&Ut>1?this._map(ke,!0):null,Mr=(ue<<5)+(Ne+1)+this.points.length,$n=0,li=le;$n<li.length;$n+=1){var Kn=li[$n],$r=ze.points[Kn];if(!($r.zoom<=Ne)){$r.zoom=Ne;var ln=$r.numPoints||1;Ir+=$r.x*ln,Qr+=$r.y*ln,$r.parentId=Mr,Pe&&(tn||(tn=this._map(ke,!0)),Pe(tn,this._map($r)))}}ke.parentId=Mr,ge.push(be(Ir/kt,Qr/kt,Mr,kt,tn))}else if(ge.push(ke),kt>1)for(var Cn=0,$i=le;Cn<$i.length;Cn+=1){var ci=$i[Cn],Ft=ze.points[ci];Ft.zoom<=Ne||(Ft.zoom=Ne,ge.push(Ft))}}}return ge},Ce.prototype._getOriginId=function(Y){return Y-this.points.length>>5},Ce.prototype._getOriginZoom=function(Y){return(Y-this.points.length)%32},Ce.prototype._map=function(Y,Ne){if(Y.numPoints)return Ne?Be({},Y.properties):Y.properties;var ge=this.points[Y.index].properties,xe=this.options.map(ge);return Ne&&xe===ge?Be({},xe):xe};function be(oe,Y,Ne,ge,xe){return{x:he(oe),y:he(Y),zoom:1/0,id:Ne,parentId:-1,numPoints:ge,properties:xe}}function Ze(oe,Y){var Ne=oe.geometry.coordinates,ge=Ne[0],xe=Ne[1];return{x:he(Ge(ge)),y:he(Re(xe)),zoom:1/0,index:Y,parentId:-1}}function qe(oe){return{type:"Feature",id:oe.id,properties:De(oe),geometry:{type:"Point",coordinates:[Me(oe.x),ce(oe.y)]}}}function De(oe){var Y=oe.numPoints,Ne=Y>=1e4?Math.round(Y/1e3)+"k":Y>=1e3?Math.round(Y/100)/10+"k":Y;return Be(Be({},oe.properties),{cluster:!0,cluster_id:oe.id,point_count:Y,point_count_abbreviated:Ne})}function Ge(oe){return oe/360+.5}function Re(oe){var Y=Math.sin(oe*Math.PI/180),Ne=.5-.25*Math.log((1+Y)/(1-Y))/Math.PI;return Ne<0?0:Ne>1?1:Ne}function Me(oe){return(oe-.5)*360}function ce(oe){var Y=(180-oe*360)*Math.PI/180;return 360*Math.atan(Math.exp(Y))/Math.PI-90}function Be(oe,Y){for(var Ne in Y)oe[Ne]=Y[Ne];return oe}function Ee(oe){return oe.x}function Se(oe){return oe.y}return Ce})},93285:function(ae,j,C){"use strict";C.r(j),C.d(j,{default:function(){return I}});class I{constructor(U=[],B=D){if(this.data=U,this.length=this.data.length,this.compare=B,this.length>0)for(let Z=(this.length>>1)-1;Z>=0;Z--)this._down(Z)}push(U){this.data.push(U),this.length++,this._up(this.length-1)}pop(){if(this.length===0)return;const U=this.data[0],B=this.data.pop();return this.length--,this.length>0&&(this.data[0]=B,this._down(0)),U}peek(){return this.data[0]}_up(U){const{data:B,compare:Z}=this,X=B[U];for(;U>0;){const q=U-1>>1,ie=B[q];if(Z(X,ie)>=0)break;B[U]=ie,U=q}B[U]=X}_down(U){const{data:B,compare:Z}=this,X=this.length>>1,q=B[U];for(;U<X;){let ie=(U<<1)+1,he=B[ie];const Ce=ie+1;if(Ce<this.length&&Z(B[Ce],he)<0&&(ie=Ce,he=B[Ce]),Z(he,q)>=0)break;B[U]=he,U=ie}B[U]=q}}function D(G,U){return G<U?-1:G>U?1:0}},46780:function(ae,j){(function(C,I){I(j)})(this,function(C){"use strict";function I(){}function D(o){this.message=o||""}function G(o){this.message=o||""}function U(o){this.message=o||""}function B(){}function Z(o){return o===null?bs:o.color}function X(o){return o===null?null:o.parent}function q(o,u){o!==null&&(o.color=u)}function ie(o){return o===null?null:o.left}function he(o){return o===null?null:o.right}function Ce(){this.root_=null,this.size_=0}function be(){}function Ze(){this.array_=[],arguments[0]instanceof mi&&this.addAll(arguments[0])}function qe(){}function De(o){this.message=o||""}function Ge(){this.array_=[]}"fill"in Array.prototype||Object.defineProperty(Array.prototype,"fill",{configurable:!0,value:function(o){if(this===void 0||this===null)throw new TypeError(this+" is not an object");var u=Object(this),v=Math.max(Math.min(u.length,9007199254740991),0)||0,y=1 in arguments&&parseInt(Number(arguments[1]),10)||0;y=y<0?Math.max(v+y,0):Math.min(y,v);var b=2 in arguments&&arguments[2]!==void 0?parseInt(Number(arguments[2]),10)||0:v;for(b=b<0?Math.max(v+arguments[2],0):Math.min(b,v);y<b;)u[y]=o,++y;return u},writable:!0}),Number.isFinite=Number.isFinite||function(o){return typeof o=="number"&&isFinite(o)},Number.isInteger=Number.isInteger||function(o){return typeof o=="number"&&isFinite(o)&&Math.floor(o)===o},Number.parseFloat=Number.parseFloat||parseFloat,Number.isNaN=Number.isNaN||function(o){return o!=o},Math.trunc=Math.trunc||function(o){return o<0?Math.ceil(o):Math.floor(o)};var Re=function(){};Re.prototype.interfaces_=function(){return[]},Re.prototype.getClass=function(){return Re},Re.prototype.equalsWithTolerance=function(o,u,v){return Math.abs(o-u)<=v};var Me=function(o){function u(v){o.call(this,v),this.name="IllegalArgumentException",this.message=v,this.stack=new o().stack}return o&&(u.__proto__=o),u.prototype=Object.create(o&&o.prototype),u.prototype.constructor=u,u}(Error),ce=function(){},Be={MAX_VALUE:{configurable:!0}};ce.isNaN=function(o){return Number.isNaN(o)},ce.doubleToLongBits=function(o){return o},ce.longBitsToDouble=function(o){return o},ce.isInfinite=function(o){return!Number.isFinite(o)},Be.MAX_VALUE.get=function(){return Number.MAX_VALUE},Object.defineProperties(ce,Be);var Ee=function(){},Se=function(){},oe=function(){},Y=function o(){if(this.x=null,this.y=null,this.z=null,arguments.length===0)this.x=0,this.y=0,this.z=o.NULL_ORDINATE;else if(arguments.length===1){var u=arguments[0];this.x=u.x,this.y=u.y,this.z=u.z}else arguments.length===2?(this.x=arguments[0],this.y=arguments[1],this.z=o.NULL_ORDINATE):arguments.length===3&&(this.x=arguments[0],this.y=arguments[1],this.z=arguments[2])},Ne={DimensionalComparator:{configurable:!0},serialVersionUID:{configurable:!0},NULL_ORDINATE:{configurable:!0},X:{configurable:!0},Y:{configurable:!0},Z:{configurable:!0}};Y.prototype.setOrdinate=function(o,u){switch(o){case Y.X:this.x=u;break;case Y.Y:this.y=u;break;case Y.Z:this.z=u;break;default:throw new Me("Invalid ordinate index: "+o)}},Y.prototype.equals2D=function(){if(arguments.length===1){var o=arguments[0];return this.x===o.x&&this.y===o.y}if(arguments.length===2){var u=arguments[0],v=arguments[1];return!!Re.equalsWithTolerance(this.x,u.x,v)&&!!Re.equalsWithTolerance(this.y,u.y,v)}},Y.prototype.getOrdinate=function(o){switch(o){case Y.X:return this.x;case Y.Y:return this.y;case Y.Z:return this.z}throw new Me("Invalid ordinate index: "+o)},Y.prototype.equals3D=function(o){return this.x===o.x&&this.y===o.y&&(this.z===o.z||ce.isNaN(this.z))&&ce.isNaN(o.z)},Y.prototype.equals=function(o){return o instanceof Y&&this.equals2D(o)},Y.prototype.equalInZ=function(o,u){return Re.equalsWithTolerance(this.z,o.z,u)},Y.prototype.compareTo=function(o){var u=o;return this.x<u.x?-1:this.x>u.x?1:this.y<u.y?-1:this.y>u.y?1:0},Y.prototype.clone=function(){},Y.prototype.copy=function(){return new Y(this)},Y.prototype.toString=function(){return"("+this.x+", "+this.y+", "+this.z+")"},Y.prototype.distance3D=function(o){var u=this.x-o.x,v=this.y-o.y,y=this.z-o.z;return Math.sqrt(u*u+v*v+y*y)},Y.prototype.distance=function(o){var u=this.x-o.x,v=this.y-o.y;return Math.sqrt(u*u+v*v)},Y.prototype.hashCode=function(){var o=17;return o=37*o+Y.hashCode(this.x),o=37*o+Y.hashCode(this.y)},Y.prototype.setCoordinate=function(o){this.x=o.x,this.y=o.y,this.z=o.z},Y.prototype.interfaces_=function(){return[Ee,Se,I]},Y.prototype.getClass=function(){return Y},Y.hashCode=function(){if(arguments.length===1){var o=arguments[0],u=ce.doubleToLongBits(o);return Math.trunc((u^u)>>>32)}},Ne.DimensionalComparator.get=function(){return ge},Ne.serialVersionUID.get=function(){return 6683108902428367e3},Ne.NULL_ORDINATE.get=function(){return ce.NaN},Ne.X.get=function(){return 0},Ne.Y.get=function(){return 1},Ne.Z.get=function(){return 2},Object.defineProperties(Y,Ne);var ge=function(o){if(this._dimensionsToTest=2,arguments.length!==0){if(arguments.length===1){var u=arguments[0];if(u!==2&&u!==3)throw new Me("only 2 or 3 dimensions may be specified");this._dimensionsToTest=u}}};ge.prototype.compare=function(o,u){var v=o,y=u,b=ge.compare(v.x,y.x);if(b!==0)return b;var H=ge.compare(v.y,y.y);return H!==0?H:this._dimensionsToTest<=2?0:ge.compare(v.z,y.z)},ge.prototype.interfaces_=function(){return[oe]},ge.prototype.getClass=function(){return ge},ge.compare=function(o,u){return o<u?-1:o>u?1:ce.isNaN(o)?ce.isNaN(u)?0:-1:ce.isNaN(u)?1:0};var xe=function(){};xe.prototype.create=function(){},xe.prototype.interfaces_=function(){return[]},xe.prototype.getClass=function(){return xe};var ye=function(){},Q={INTERIOR:{configurable:!0},BOUNDARY:{configurable:!0},EXTERIOR:{configurable:!0},NONE:{configurable:!0}};ye.prototype.interfaces_=function(){return[]},ye.prototype.getClass=function(){return ye},ye.toLocationSymbol=function(o){switch(o){case ye.EXTERIOR:return"e";case ye.BOUNDARY:return"b";case ye.INTERIOR:return"i";case ye.NONE:return"-"}throw new Me("Unknown location value: "+o)},Q.INTERIOR.get=function(){return 0},Q.BOUNDARY.get=function(){return 1},Q.EXTERIOR.get=function(){return 2},Q.NONE.get=function(){return-1},Object.defineProperties(ye,Q);var Pe=function(o,u){return o.interfaces_&&o.interfaces_().indexOf(u)>-1},Ae=function(){},_e={LOG_10:{configurable:!0}};Ae.prototype.interfaces_=function(){return[]},Ae.prototype.getClass=function(){return Ae},Ae.log10=function(o){var u=Math.log(o);return ce.isInfinite(u)||ce.isNaN(u)?u:u/Ae.LOG_10},Ae.min=function(o,u,v,y){var b=o;return u<b&&(b=u),v<b&&(b=v),y<b&&(b=y),b},Ae.clamp=function(){if(typeof arguments[2]=="number"&&typeof arguments[0]=="number"&&typeof arguments[1]=="number"){var o=arguments[0],u=arguments[1],v=arguments[2];return o<u?u:o>v?v:o}if(Number.isInteger(arguments[2])&&Number.isInteger(arguments[0])&&Number.isInteger(arguments[1])){var y=arguments[0],b=arguments[1],H=arguments[2];return y<b?b:y>H?H:y}},Ae.wrap=function(o,u){return o<0?u- -o%u:o%u},Ae.max=function(){if(arguments.length===3){var o=arguments[0],u=arguments[1],v=arguments[2],y=o;return u>y&&(y=u),v>y&&(y=v),y}if(arguments.length===4){var b=arguments[0],H=arguments[1],ne=arguments[2],Le=arguments[3],tt=b;return H>tt&&(tt=H),ne>tt&&(tt=ne),Le>tt&&(tt=Le),tt}},Ae.average=function(o,u){return(o+u)/2},_e.LOG_10.get=function(){return Math.log(10)},Object.defineProperties(Ae,_e);var ue=function(o){this.str=o};ue.prototype.append=function(o){this.str+=o},ue.prototype.setCharAt=function(o,u){this.str=this.str.substr(0,o)+u+this.str.substr(o+1)},ue.prototype.toString=function(o){return this.str};var ke=function(o){this.value=o};ke.prototype.intValue=function(){return this.value},ke.prototype.compareTo=function(o){return this.value<o?-1:this.value>o?1:0},ke.isNaN=function(o){return Number.isNaN(o)};var ze=function(){};ze.isWhitespace=function(o){return o<=32&&o>=0||o===127},ze.toUpperCase=function(o){return o.toUpperCase()};var le=function o(){if(this._hi=0,this._lo=0,arguments.length===0)this.init(0);else if(arguments.length===1){if(typeof arguments[0]=="number"){var u=arguments[0];this.init(u)}else if(arguments[0]instanceof o){var v=arguments[0];this.init(v)}else if(typeof arguments[0]=="string"){var y=arguments[0];o.call(this,o.parse(y))}}else if(arguments.length===2){var b=arguments[0],H=arguments[1];this.init(b,H)}},Ut={PI:{configurable:!0},TWO_PI:{configurable:!0},PI_2:{configurable:!0},E:{configurable:!0},NaN:{configurable:!0},EPS:{configurable:!0},SPLIT:{configurable:!0},MAX_PRINT_DIGITS:{configurable:!0},TEN:{configurable:!0},ONE:{configurable:!0},SCI_NOT_EXPONENT_CHAR:{configurable:!0},SCI_NOT_ZERO:{configurable:!0}};le.prototype.le=function(o){return(this._hi<o._hi||this._hi===o._hi)&&this._lo<=o._lo},le.prototype.extractSignificantDigits=function(o,u){var v=this.abs(),y=le.magnitude(v._hi),b=le.TEN.pow(y);(v=v.divide(b)).gt(le.TEN)?(v=v.divide(le.TEN),y+=1):v.lt(le.ONE)&&(v=v.multiply(le.TEN),y-=1);for(var H=y+1,ne=new ue,Le=le.MAX_PRINT_DIGITS-1,tt=0;tt<=Le;tt++){o&&tt===H&&ne.append(".");var Nt=Math.trunc(v._hi);if(Nt<0)break;var ar=!1,st=0;Nt>9?(ar=!0,st="9"):st="0"+Nt,ne.append(st),v=v.subtract(le.valueOf(Nt)).multiply(le.TEN),ar&&v.selfAdd(le.TEN);var Gt=!0,ir=le.magnitude(v._hi);if(ir<0&&Math.abs(ir)>=Le-tt&&(Gt=!1),!Gt)break}return u[0]=y,ne.toString()},le.prototype.sqr=function(){return this.multiply(this)},le.prototype.doubleValue=function(){return this._hi+this._lo},le.prototype.subtract=function(){if(arguments[0]instanceof le){var o=arguments[0];return this.add(o.negate())}if(typeof arguments[0]=="number"){var u=arguments[0];return this.add(-u)}},le.prototype.equals=function(){if(arguments.length===1){var o=arguments[0];return this._hi===o._hi&&this._lo===o._lo}},le.prototype.isZero=function(){return this._hi===0&&this._lo===0},le.prototype.selfSubtract=function(){if(arguments[0]instanceof le){var o=arguments[0];return this.isNaN()?this:this.selfAdd(-o._hi,-o._lo)}if(typeof arguments[0]=="number"){var u=arguments[0];return this.isNaN()?this:this.selfAdd(-u,0)}},le.prototype.getSpecialNumberString=function(){return this.isZero()?"0.0":this.isNaN()?"NaN ":null},le.prototype.min=function(o){return this.le(o)?this:o},le.prototype.selfDivide=function(){if(arguments.length===1){if(arguments[0]instanceof le){var o=arguments[0];return this.selfDivide(o._hi,o._lo)}if(typeof arguments[0]=="number"){var u=arguments[0];return this.selfDivide(u,0)}}else if(arguments.length===2){var v=arguments[0],y=arguments[1],b=null,H=null,ne=null,Le=null,tt=null,Nt=null,ar=null,st=null;return tt=this._hi/v,Nt=le.SPLIT*tt,b=Nt-tt,st=le.SPLIT*v,b=Nt-b,H=tt-b,ne=st-v,ar=tt*v,ne=st-ne,Le=v-ne,st=b*ne-ar+b*Le+H*ne+H*Le,Nt=(this._hi-ar-st+this._lo-tt*y)/v,st=tt+Nt,this._hi=st,this._lo=tt-st+Nt,this}},le.prototype.dump=function(){return"DD<"+this._hi+", "+this._lo+">"},le.prototype.divide=function(){if(arguments[0]instanceof le){var o=arguments[0],u=null,v=null,y=null,b=null,H=null,ne=null,Le=null,tt=null;return v=(H=this._hi/o._hi)-(u=(ne=le.SPLIT*H)-(u=ne-H)),tt=u*(y=(tt=le.SPLIT*o._hi)-(y=tt-o._hi))-(Le=H*o._hi)+u*(b=o._hi-y)+v*y+v*b,ne=(this._hi-Le-tt+this._lo-H*o._lo)/o._hi,new le(tt=H+ne,H-tt+ne)}if(typeof arguments[0]=="number"){var Nt=arguments[0];return ce.isNaN(Nt)?le.createNaN():le.copy(this).selfDivide(Nt,0)}},le.prototype.ge=function(o){return(this._hi>o._hi||this._hi===o._hi)&&this._lo>=o._lo},le.prototype.pow=function(o){if(o===0)return le.valueOf(1);var u=new le(this),v=le.valueOf(1),y=Math.abs(o);if(y>1)for(;y>0;)y%2==1&&v.selfMultiply(u),(y/=2)>0&&(u=u.sqr());else v=u;return o<0?v.reciprocal():v},le.prototype.ceil=function(){if(this.isNaN())return le.NaN;var o=Math.ceil(this._hi),u=0;return o===this._hi&&(u=Math.ceil(this._lo)),new le(o,u)},le.prototype.compareTo=function(o){var u=o;return this._hi<u._hi?-1:this._hi>u._hi?1:this._lo<u._lo?-1:this._lo>u._lo?1:0},le.prototype.rint=function(){return this.isNaN()?this:this.add(.5).floor()},le.prototype.setValue=function(){if(arguments[0]instanceof le){var o=arguments[0];return this.init(o),this}if(typeof arguments[0]=="number"){var u=arguments[0];return this.init(u),this}},le.prototype.max=function(o){return this.ge(o)?this:o},le.prototype.sqrt=function(){if(this.isZero())return le.valueOf(0);if(this.isNegative())return le.NaN;var o=1/Math.sqrt(this._hi),u=this._hi*o,v=le.valueOf(u),y=this.subtract(v.sqr())._hi*(.5*o);return v.add(y)},le.prototype.selfAdd=function(){if(arguments.length===1){if(arguments[0]instanceof le){var o=arguments[0];return this.selfAdd(o._hi,o._lo)}if(typeof arguments[0]=="number"){var u=arguments[0],v=null,y=null,b=null,H=null,ne=null,Le=null;return b=this._hi+u,ne=b-this._hi,H=b-ne,H=u-ne+(this._hi-H),Le=H+this._lo,v=b+Le,y=Le+(b-v),this._hi=v+y,this._lo=y+(v-this._hi),this}}else if(arguments.length===2){var tt=arguments[0],Nt=arguments[1],ar=null,st=null,Gt=null,ir=null,br=null,g=null,Bn=null;ir=this._hi+tt,st=this._lo+Nt,br=ir-(g=ir-this._hi),Gt=st-(Bn=st-this._lo);var Jn=(ar=ir+(g=(br=tt-g+(this._hi-br))+st))+(g=(Gt=Nt-Bn+(this._lo-Gt))+(g+(ir-ar))),et=g+(ar-Jn);return this._hi=Jn,this._lo=et,this}},le.prototype.selfMultiply=function(){if(arguments.length===1){if(arguments[0]instanceof le){var o=arguments[0];return this.selfMultiply(o._hi,o._lo)}if(typeof arguments[0]=="number"){var u=arguments[0];return this.selfMultiply(u,0)}}else if(arguments.length===2){var v=arguments[0],y=arguments[1],b=null,H=null,ne=null,Le=null,tt=null,Nt=null;b=(tt=le.SPLIT*this._hi)-this._hi,Nt=le.SPLIT*v,b=tt-b,H=this._hi-b,ne=Nt-v;var ar=(tt=this._hi*v)+(Nt=b*(ne=Nt-ne)-tt+b*(Le=v-ne)+H*ne+H*Le+(this._hi*y+this._lo*v)),st=Nt+(b=tt-ar);return this._hi=ar,this._lo=st,this}},le.prototype.selfSqr=function(){return this.selfMultiply(this)},le.prototype.floor=function(){if(this.isNaN())return le.NaN;var o=Math.floor(this._hi),u=0;return o===this._hi&&(u=Math.floor(this._lo)),new le(o,u)},le.prototype.negate=function(){return this.isNaN()?this:new le(-this._hi,-this._lo)},le.prototype.clone=function(){},le.prototype.multiply=function(){if(arguments[0]instanceof le){var o=arguments[0];return o.isNaN()?le.createNaN():le.copy(this).selfMultiply(o)}if(typeof arguments[0]=="number"){var u=arguments[0];return ce.isNaN(u)?le.createNaN():le.copy(this).selfMultiply(u,0)}},le.prototype.isNaN=function(){return ce.isNaN(this._hi)},le.prototype.intValue=function(){return Math.trunc(this._hi)},le.prototype.toString=function(){var o=le.magnitude(this._hi);return o>=-3&&o<=20?this.toStandardNotation():this.toSciNotation()},le.prototype.toStandardNotation=function(){var o=this.getSpecialNumberString();if(o!==null)return o;var u=new Array(1).fill(null),v=this.extractSignificantDigits(!0,u),y=u[0]+1,b=v;if(v.charAt(0)===".")b="0"+v;else if(y<0)b="0."+le.stringOfChar("0",-y)+v;else if(v.indexOf(".")===-1){var H=y-v.length;b=v+le.stringOfChar("0",H)+".0"}return this.isNegative()?"-"+b:b},le.prototype.reciprocal=function(){var o=null,u=null,v=null,y=null,b=null,H=null,ne=null,Le=null;u=(b=1/this._hi)-(o=(H=le.SPLIT*b)-(o=H-b)),v=(Le=le.SPLIT*this._hi)-this._hi;var tt=b+(H=(1-(ne=b*this._hi)-(Le=o*(v=Le-v)-ne+o*(y=this._hi-v)+u*v+u*y)-b*this._lo)/this._hi);return new le(tt,b-tt+H)},le.prototype.toSciNotation=function(){if(this.isZero())return le.SCI_NOT_ZERO;var o=this.getSpecialNumberString();if(o!==null)return o;var u=new Array(1).fill(null),v=this.extractSignificantDigits(!1,u),y=le.SCI_NOT_EXPONENT_CHAR+u[0];if(v.charAt(0)==="0")throw new Error("Found leading zero: "+v);var b="";v.length>1&&(b=v.substring(1));var H=v.charAt(0)+"."+b;return this.isNegative()?"-"+H+y:H+y},le.prototype.abs=function(){return this.isNaN()?le.NaN:this.isNegative()?this.negate():new le(this)},le.prototype.isPositive=function(){return(this._hi>0||this._hi===0)&&this._lo>0},le.prototype.lt=function(o){return(this._hi<o._hi||this._hi===o._hi)&&this._lo<o._lo},le.prototype.add=function(){if(arguments[0]instanceof le){var o=arguments[0];return le.copy(this).selfAdd(o)}if(typeof arguments[0]=="number"){var u=arguments[0];return le.copy(this).selfAdd(u)}},le.prototype.init=function(){if(arguments.length===1){if(typeof arguments[0]=="number"){var o=arguments[0];this._hi=o,this._lo=0}else if(arguments[0]instanceof le){var u=arguments[0];this._hi=u._hi,this._lo=u._lo}}else if(arguments.length===2){var v=arguments[0],y=arguments[1];this._hi=v,this._lo=y}},le.prototype.gt=function(o){return(this._hi>o._hi||this._hi===o._hi)&&this._lo>o._lo},le.prototype.isNegative=function(){return(this._hi<0||this._hi===0)&&this._lo<0},le.prototype.trunc=function(){return this.isNaN()?le.NaN:this.isPositive()?this.floor():this.ceil()},le.prototype.signum=function(){return this._hi>0?1:this._hi<0?-1:this._lo>0?1:this._lo<0?-1:0},le.prototype.interfaces_=function(){return[I,Ee,Se]},le.prototype.getClass=function(){return le},le.sqr=function(o){return le.valueOf(o).selfMultiply(o)},le.valueOf=function(){if(typeof arguments[0]=="string"){var o=arguments[0];return le.parse(o)}if(typeof arguments[0]=="number"){var u=arguments[0];return new le(u)}},le.sqrt=function(o){return le.valueOf(o).sqrt()},le.parse=function(o){for(var u=0,v=o.length;ze.isWhitespace(o.charAt(u));)u++;var y=!1;if(u<v){var b=o.charAt(u);b!=="-"&&b!=="+"||(u++,b==="-"&&(y=!0))}for(var H=new le,ne=0,Le=0,tt=0;!(u>=v);){var Nt=o.charAt(u);if(u++,ze.isDigit(Nt)){var ar=Nt-"0";H.selfMultiply(le.TEN),H.selfAdd(ar),ne++}else{if(Nt!=="."){if(Nt==="e"||Nt==="E"){var st=o.substring(u);try{tt=ke.parseInt(st)}catch(Bn){throw Bn instanceof Error?new Error("Invalid exponent "+st+" in string "+o):Bn}break}throw new Error("Unexpected character '"+Nt+"' at position "+u+" in string "+o)}Le=ne}}var Gt=H,ir=ne-Le-tt;if(ir===0)Gt=H;else if(ir>0){var br=le.TEN.pow(ir);Gt=H.divide(br)}else if(ir<0){var g=le.TEN.pow(-ir);Gt=H.multiply(g)}return y?Gt.negate():Gt},le.createNaN=function(){return new le(ce.NaN,ce.NaN)},le.copy=function(o){return new le(o)},le.magnitude=function(o){var u=Math.abs(o),v=Math.log(u)/Math.log(10),y=Math.trunc(Math.floor(v));return 10*Math.pow(10,y)<=u&&(y+=1),y},le.stringOfChar=function(o,u){for(var v=new ue,y=0;y<u;y++)v.append(o);return v.toString()},Ut.PI.get=function(){return new le(3.141592653589793,12246467991473532e-32)},Ut.TWO_PI.get=function(){return new le(6.283185307179586,24492935982947064e-32)},Ut.PI_2.get=function(){return new le(1.5707963267948966,6123233995736766e-32)},Ut.E.get=function(){return new le(2.718281828459045,14456468917292502e-32)},Ut.NaN.get=function(){return new le(ce.NaN,ce.NaN)},Ut.EPS.get=function(){return 123259516440783e-46},Ut.SPLIT.get=function(){return 134217729},Ut.MAX_PRINT_DIGITS.get=function(){return 32},Ut.TEN.get=function(){return le.valueOf(10)},Ut.ONE.get=function(){return le.valueOf(1)},Ut.SCI_NOT_EXPONENT_CHAR.get=function(){return"E"},Ut.SCI_NOT_ZERO.get=function(){return"0.0E0"},Object.defineProperties(le,Ut);var kt=function(){},pr={DP_SAFE_EPSILON:{configurable:!0}};kt.prototype.interfaces_=function(){return[]},kt.prototype.getClass=function(){return kt},kt.orientationIndex=function(o,u,v){var y=kt.orientationIndexFilter(o,u,v);if(y<=1)return y;var b=le.valueOf(u.x).selfAdd(-o.x),H=le.valueOf(u.y).selfAdd(-o.y),ne=le.valueOf(v.x).selfAdd(-u.x),Le=le.valueOf(v.y).selfAdd(-u.y);return b.selfMultiply(Le).selfSubtract(H.selfMultiply(ne)).signum()},kt.signOfDet2x2=function(o,u,v,y){return o.multiply(y).selfSubtract(u.multiply(v)).signum()},kt.intersection=function(o,u,v,y){var b=le.valueOf(y.y).selfSubtract(v.y).selfMultiply(le.valueOf(u.x).selfSubtract(o.x)),H=le.valueOf(y.x).selfSubtract(v.x).selfMultiply(le.valueOf(u.y).selfSubtract(o.y)),ne=b.subtract(H),Le=le.valueOf(y.x).selfSubtract(v.x).selfMultiply(le.valueOf(o.y).selfSubtract(v.y)),tt=le.valueOf(y.y).selfSubtract(v.y).selfMultiply(le.valueOf(o.x).selfSubtract(v.x)),Nt=Le.subtract(tt).selfDivide(ne).doubleValue(),ar=le.valueOf(o.x).selfAdd(le.valueOf(u.x).selfSubtract(o.x).selfMultiply(Nt)).doubleValue(),st=le.valueOf(u.x).selfSubtract(o.x).selfMultiply(le.valueOf(o.y).selfSubtract(v.y)),Gt=le.valueOf(u.y).selfSubtract(o.y).selfMultiply(le.valueOf(o.x).selfSubtract(v.x)),ir=st.subtract(Gt).selfDivide(ne).doubleValue(),br=le.valueOf(v.y).selfAdd(le.valueOf(y.y).selfSubtract(v.y).selfMultiply(ir)).doubleValue();return new Y(ar,br)},kt.orientationIndexFilter=function(o,u,v){var y=null,b=(o.x-v.x)*(u.y-v.y),H=(o.y-v.y)*(u.x-v.x),ne=b-H;if(b>0){if(H<=0)return kt.signum(ne);y=b+H}else{if(!(b<0)||H>=0)return kt.signum(ne);y=-b-H}var Le=kt.DP_SAFE_EPSILON*y;return ne>=Le||-ne>=Le?kt.signum(ne):2},kt.signum=function(o){return o>0?1:o<0?-1:0},pr.DP_SAFE_EPSILON.get=function(){return 1e-15},Object.defineProperties(kt,pr);var Wt=function(){},Xr={X:{configurable:!0},Y:{configurable:!0},Z:{configurable:!0},M:{configurable:!0}};Xr.X.get=function(){return 0},Xr.Y.get=function(){return 1},Xr.Z.get=function(){return 2},Xr.M.get=function(){return 3},Wt.prototype.setOrdinate=function(o,u,v){},Wt.prototype.size=function(){},Wt.prototype.getOrdinate=function(o,u){},Wt.prototype.getCoordinate=function(){},Wt.prototype.getCoordinateCopy=function(o){},Wt.prototype.getDimension=function(){},Wt.prototype.getX=function(o){},Wt.prototype.clone=function(){},Wt.prototype.expandEnvelope=function(o){},Wt.prototype.copy=function(){},Wt.prototype.getY=function(o){},Wt.prototype.toCoordinateArray=function(){},Wt.prototype.interfaces_=function(){return[Se]},Wt.prototype.getClass=function(){return Wt},Object.defineProperties(Wt,Xr);var fn=function(){},Ir=function(o){function u(){o.call(this,"Projective point not representable on the Cartesian plane.")}return o&&(u.__proto__=o),u.prototype=Object.create(o&&o.prototype),u.prototype.constructor=u,u.prototype.interfaces_=function(){return[]},u.prototype.getClass=function(){return u},u}(fn),Qr=function(){};Qr.arraycopy=function(o,u,v,y,b){for(var H=0,ne=u;ne<u+b;ne++)v[y+H]=o[ne],H++},Qr.getProperty=function(o){return{"line.separator":`
`}[o]};var tn=function o(){if(this.x=null,this.y=null,this.w=null,arguments.length===0)this.x=0,this.y=0,this.w=1;else if(arguments.length===1){var u=arguments[0];this.x=u.x,this.y=u.y,this.w=1}else if(arguments.length===2){if(typeof arguments[0]=="number"&&typeof arguments[1]=="number"){var v=arguments[0],y=arguments[1];this.x=v,this.y=y,this.w=1}else if(arguments[0]instanceof o&&arguments[1]instanceof o){var b=arguments[0],H=arguments[1];this.x=b.y*H.w-H.y*b.w,this.y=H.x*b.w-b.x*H.w,this.w=b.x*H.y-H.x*b.y}else if(arguments[0]instanceof Y&&arguments[1]instanceof Y){var ne=arguments[0],Le=arguments[1];this.x=ne.y-Le.y,this.y=Le.x-ne.x,this.w=ne.x*Le.y-Le.x*ne.y}}else if(arguments.length===3){var tt=arguments[0],Nt=arguments[1],ar=arguments[2];this.x=tt,this.y=Nt,this.w=ar}else if(arguments.length===4){var st=arguments[0],Gt=arguments[1],ir=arguments[2],br=arguments[3],g=st.y-Gt.y,Bn=Gt.x-st.x,Jn=st.x*Gt.y-Gt.x*st.y,et=ir.y-br.y,Za=br.x-ir.x,Eo=ir.x*br.y-br.x*ir.y;this.x=Bn*Eo-Za*Jn,this.y=et*Jn-g*Eo,this.w=g*Za-et*Bn}};tn.prototype.getY=function(){var o=this.y/this.w;if(ce.isNaN(o)||ce.isInfinite(o))throw new Ir;return o},tn.prototype.getX=function(){var o=this.x/this.w;if(ce.isNaN(o)||ce.isInfinite(o))throw new Ir;return o},tn.prototype.getCoordinate=function(){var o=new Y;return o.x=this.getX(),o.y=this.getY(),o},tn.prototype.interfaces_=function(){return[]},tn.prototype.getClass=function(){return tn},tn.intersection=function(o,u,v,y){var b=o.y-u.y,H=u.x-o.x,ne=o.x*u.y-u.x*o.y,Le=v.y-y.y,tt=y.x-v.x,Nt=v.x*y.y-y.x*v.y,ar=b*tt-Le*H,st=(H*Nt-tt*ne)/ar,Gt=(Le*ne-b*Nt)/ar;if(ce.isNaN(st)||ce.isInfinite(st)||ce.isNaN(Gt)||ce.isInfinite(Gt))throw new Ir;return new Y(st,Gt)};var Mr=function o(){if(this._minx=null,this._maxx=null,this._miny=null,this._maxy=null,arguments.length===0)this.init();else if(arguments.length===1){if(arguments[0]instanceof Y){var u=arguments[0];this.init(u.x,u.x,u.y,u.y)}else if(arguments[0]instanceof o){var v=arguments[0];this.init(v)}}else if(arguments.length===2){var y=arguments[0],b=arguments[1];this.init(y.x,b.x,y.y,b.y)}else if(arguments.length===4){var H=arguments[0],ne=arguments[1],Le=arguments[2],tt=arguments[3];this.init(H,ne,Le,tt)}},$n={serialVersionUID:{configurable:!0}};Mr.prototype.getArea=function(){return this.getWidth()*this.getHeight()},Mr.prototype.equals=function(o){if(!(o instanceof Mr))return!1;var u=o;return this.isNull()?u.isNull():this._maxx===u.getMaxX()&&this._maxy===u.getMaxY()&&this._minx===u.getMinX()&&this._miny===u.getMinY()},Mr.prototype.intersection=function(o){if(this.isNull()||o.isNull()||!this.intersects(o))return new Mr;var u=this._minx>o._minx?this._minx:o._minx,v=this._miny>o._miny?this._miny:o._miny,y=this._maxx<o._maxx?this._maxx:o._maxx,b=this._maxy<o._maxy?this._maxy:o._maxy;return new Mr(u,y,v,b)},Mr.prototype.isNull=function(){return this._maxx<this._minx},Mr.prototype.getMaxX=function(){return this._maxx},Mr.prototype.covers=function(){if(arguments.length===1){if(arguments[0]instanceof Y){var o=arguments[0];return this.covers(o.x,o.y)}if(arguments[0]instanceof Mr){var u=arguments[0];return!this.isNull()&&!u.isNull()&&u.getMinX()>=this._minx&&u.getMaxX()<=this._maxx&&u.getMinY()>=this._miny&&u.getMaxY()<=this._maxy}}else if(arguments.length===2){var v=arguments[0],y=arguments[1];return!this.isNull()&&v>=this._minx&&v<=this._maxx&&y>=this._miny&&y<=this._maxy}},Mr.prototype.intersects=function(){if(arguments.length===1){if(arguments[0]instanceof Mr){var o=arguments[0];return!this.isNull()&&!o.isNull()&&!(o._minx>this._maxx||o._maxx<this._minx||o._miny>this._maxy||o._maxy<this._miny)}if(arguments[0]instanceof Y){var u=arguments[0];return this.intersects(u.x,u.y)}}else if(arguments.length===2){var v=arguments[0],y=arguments[1];return!this.isNull()&&!(v>this._maxx||v<this._minx||y>this._maxy||y<this._miny)}},Mr.prototype.getMinY=function(){return this._miny},Mr.prototype.getMinX=function(){return this._minx},Mr.prototype.expandToInclude=function(){if(arguments.length===1){if(arguments[0]instanceof Y){var o=arguments[0];this.expandToInclude(o.x,o.y)}else if(arguments[0]instanceof Mr){var u=arguments[0];if(u.isNull())return null;this.isNull()?(this._minx=u.getMinX(),this._maxx=u.getMaxX(),this._miny=u.getMinY(),this._maxy=u.getMaxY()):(u._minx<this._minx&&(this._minx=u._minx),u._maxx>this._maxx&&(this._maxx=u._maxx),u._miny<this._miny&&(this._miny=u._miny),u._maxy>this._maxy&&(this._maxy=u._maxy))}}else if(arguments.length===2){var v=arguments[0],y=arguments[1];this.isNull()?(this._minx=v,this._maxx=v,this._miny=y,this._maxy=y):(v<this._minx&&(this._minx=v),v>this._maxx&&(this._maxx=v),y<this._miny&&(this._miny=y),y>this._maxy&&(this._maxy=y))}},Mr.prototype.minExtent=function(){if(this.isNull())return 0;var o=this.getWidth(),u=this.getHeight();return o<u?o:u},Mr.prototype.getWidth=function(){return this.isNull()?0:this._maxx-this._minx},Mr.prototype.compareTo=function(o){var u=o;return this.isNull()?u.isNull()?0:-1:u.isNull()?1:this._minx<u._minx?-1:this._minx>u._minx?1:this._miny<u._miny?-1:this._miny>u._miny?1:this._maxx<u._maxx?-1:this._maxx>u._maxx?1:this._maxy<u._maxy?-1:this._maxy>u._maxy?1:0},Mr.prototype.translate=function(o,u){if(this.isNull())return null;this.init(this.getMinX()+o,this.getMaxX()+o,this.getMinY()+u,this.getMaxY()+u)},Mr.prototype.toString=function(){return"Env["+this._minx+" : "+this._maxx+", "+this._miny+" : "+this._maxy+"]"},Mr.prototype.setToNull=function(){this._minx=0,this._maxx=-1,this._miny=0,this._maxy=-1},Mr.prototype.getHeight=function(){return this.isNull()?0:this._maxy-this._miny},Mr.prototype.maxExtent=function(){if(this.isNull())return 0;var o=this.getWidth(),u=this.getHeight();return o>u?o:u},Mr.prototype.expandBy=function(){if(arguments.length===1){var o=arguments[0];this.expandBy(o,o)}else if(arguments.length===2){var u=arguments[0],v=arguments[1];if(this.isNull())return null;this._minx-=u,this._maxx+=u,this._miny-=v,this._maxy+=v,(this._minx>this._maxx||this._miny>this._maxy)&&this.setToNull()}},Mr.prototype.contains=function(){if(arguments.length===1){if(arguments[0]instanceof Mr){var o=arguments[0];return this.covers(o)}if(arguments[0]instanceof Y){var u=arguments[0];return this.covers(u)}}else if(arguments.length===2){var v=arguments[0],y=arguments[1];return this.covers(v,y)}},Mr.prototype.centre=function(){return this.isNull()?null:new Y((this.getMinX()+this.getMaxX())/2,(this.getMinY()+this.getMaxY())/2)},Mr.prototype.init=function(){if(arguments.length===0)this.setToNull();else if(arguments.length===1){if(arguments[0]instanceof Y){var o=arguments[0];this.init(o.x,o.x,o.y,o.y)}else if(arguments[0]instanceof Mr){var u=arguments[0];this._minx=u._minx,this._maxx=u._maxx,this._miny=u._miny,this._maxy=u._maxy}}else if(arguments.length===2){var v=arguments[0],y=arguments[1];this.init(v.x,y.x,v.y,y.y)}else if(arguments.length===4){var b=arguments[0],H=arguments[1],ne=arguments[2],Le=arguments[3];b<H?(this._minx=b,this._maxx=H):(this._minx=H,this._maxx=b),ne<Le?(this._miny=ne,this._maxy=Le):(this._miny=Le,this._maxy=ne)}},Mr.prototype.getMaxY=function(){return this._maxy},Mr.prototype.distance=function(o){if(this.intersects(o))return 0;var u=0;this._maxx<o._minx?u=o._minx-this._maxx:this._minx>o._maxx&&(u=this._minx-o._maxx);var v=0;return this._maxy<o._miny?v=o._miny-this._maxy:this._miny>o._maxy&&(v=this._miny-o._maxy),u===0?v:v===0?u:Math.sqrt(u*u+v*v)},Mr.prototype.hashCode=function(){var o=17;return o=37*o+Y.hashCode(this._minx),o=37*o+Y.hashCode(this._maxx),o=37*o+Y.hashCode(this._miny),o=37*o+Y.hashCode(this._maxy)},Mr.prototype.interfaces_=function(){return[Ee,I]},Mr.prototype.getClass=function(){return Mr},Mr.intersects=function(){if(arguments.length===3){var o=arguments[0],u=arguments[1],v=arguments[2];return v.x>=(o.x<u.x?o.x:u.x)&&v.x<=(o.x>u.x?o.x:u.x)&&v.y>=(o.y<u.y?o.y:u.y)&&v.y<=(o.y>u.y?o.y:u.y)}if(arguments.length===4){var y=arguments[0],b=arguments[1],H=arguments[2],ne=arguments[3],Le=Math.min(H.x,ne.x),tt=Math.max(H.x,ne.x),Nt=Math.min(y.x,b.x),ar=Math.max(y.x,b.x);return!(Nt>tt)&&!(ar<Le)&&(Le=Math.min(H.y,ne.y),tt=Math.max(H.y,ne.y),Nt=Math.min(y.y,b.y),ar=Math.max(y.y,b.y),!(Nt>tt)&&!(ar<Le))}},$n.serialVersionUID.get=function(){return 5873921885273102e3},Object.defineProperties(Mr,$n);var li={typeStr:/^\s*(\w+)\s*\(\s*(.*)\s*\)\s*$/,emptyTypeStr:/^\s*(\w+)\s*EMPTY\s*$/,spaces:/\s+/,parenComma:/\)\s*,\s*\(/,doubleParenComma:/\)\s*\)\s*,\s*\(\s*\(/,trimParens:/^\s*\(?(.*?)\)?\s*$/},Kn=function(o){this.geometryFactory=o||new Ri};Kn.prototype.read=function(o){var u,v,y;o=o.replace(/[\n\r]/g," ");var b=li.typeStr.exec(o);if(o.search("EMPTY")!==-1&&((b=li.emptyTypeStr.exec(o))[2]=void 0),b&&(v=b[1].toLowerCase(),y=b[2],ln[v]&&(u=ln[v].apply(this,[y]))),u===void 0)throw new Error("Could not parse WKT "+o);return u},Kn.prototype.write=function(o){return this.extractGeometry(o)},Kn.prototype.extractGeometry=function(o){var u=o.getGeometryType().toLowerCase();if(!$r[u])return null;var v=u.toUpperCase();return o.isEmpty()?v+" EMPTY":v+"("+$r[u].apply(this,[o])+")"};var $r={coordinate:function(o){return o.x+" "+o.y},point:function(o){return $r.coordinate.call(this,o._coordinates._coordinates[0])},multipoint:function(o){for(var u=[],v=0,y=o._geometries.length;v<y;++v)u.push("("+$r.point.apply(this,[o._geometries[v]])+")");return u.join(",")},linestring:function(o){for(var u=[],v=0,y=o._points._coordinates.length;v<y;++v)u.push($r.coordinate.apply(this,[o._points._coordinates[v]]));return u.join(",")},linearring:function(o){for(var u=[],v=0,y=o._points._coordinates.length;v<y;++v)u.push($r.coordinate.apply(this,[o._points._coordinates[v]]));return u.join(",")},multilinestring:function(o){for(var u=[],v=0,y=o._geometries.length;v<y;++v)u.push("("+$r.linestring.apply(this,[o._geometries[v]])+")");return u.join(",")},polygon:function(o){var u=[];u.push("("+$r.linestring.apply(this,[o._shell])+")");for(var v=0,y=o._holes.length;v<y;++v)u.push("("+$r.linestring.apply(this,[o._holes[v]])+")");return u.join(",")},multipolygon:function(o){for(var u=[],v=0,y=o._geometries.length;v<y;++v)u.push("("+$r.polygon.apply(this,[o._geometries[v]])+")");return u.join(",")},geometrycollection:function(o){for(var u=[],v=0,y=o._geometries.length;v<y;++v)u.push(this.extractGeometry(o._geometries[v]));return u.join(",")}},ln={point:function(o){if(o===void 0)return this.geometryFactory.createPoint();var u=o.trim().split(li.spaces);return this.geometryFactory.createPoint(new Y(Number.parseFloat(u[0]),Number.parseFloat(u[1])))},multipoint:function(o){if(o===void 0)return this.geometryFactory.createMultiPoint();for(var u,v=o.trim().split(","),y=[],b=0,H=v.length;b<H;++b)u=v[b].replace(li.trimParens,"$1"),y.push(ln.point.apply(this,[u]));return this.geometryFactory.createMultiPoint(y)},linestring:function(o){if(o===void 0)return this.geometryFactory.createLineString();for(var u,v=o.trim().split(","),y=[],b=0,H=v.length;b<H;++b)u=v[b].trim().split(li.spaces),y.push(new Y(Number.parseFloat(u[0]),Number.parseFloat(u[1])));return this.geometryFactory.createLineString(y)},linearring:function(o){if(o===void 0)return this.geometryFactory.createLinearRing();for(var u,v=o.trim().split(","),y=[],b=0,H=v.length;b<H;++b)u=v[b].trim().split(li.spaces),y.push(new Y(Number.parseFloat(u[0]),Number.parseFloat(u[1])));return this.geometryFactory.createLinearRing(y)},multilinestring:function(o){if(o===void 0)return this.geometryFactory.createMultiLineString();for(var u,v=o.trim().split(li.parenComma),y=[],b=0,H=v.length;b<H;++b)u=v[b].replace(li.trimParens,"$1"),y.push(ln.linestring.apply(this,[u]));return this.geometryFactory.createMultiLineString(y)},polygon:function(o){if(o===void 0)return this.geometryFactory.createPolygon();for(var u,v,y,b,H=o.trim().split(li.parenComma),ne=[],Le=0,tt=H.length;Le<tt;++Le)u=H[Le].replace(li.trimParens,"$1"),v=ln.linestring.apply(this,[u]),y=this.geometryFactory.createLinearRing(v._points),Le===0?b=y:ne.push(y);return this.geometryFactory.createPolygon(b,ne)},multipolygon:function(o){if(o===void 0)return this.geometryFactory.createMultiPolygon();for(var u,v=o.trim().split(li.doubleParenComma),y=[],b=0,H=v.length;b<H;++b)u=v[b].replace(li.trimParens,"$1"),y.push(ln.polygon.apply(this,[u]));return this.geometryFactory.createMultiPolygon(y)},geometrycollection:function(o){if(o===void 0)return this.geometryFactory.createGeometryCollection();for(var u=(o=o.replace(/,\s*([A-Za-z])/g,"|$1")).trim().split("|"),v=[],y=0,b=u.length;y<b;++y)v.push(this.read(u[y]));return this.geometryFactory.createGeometryCollection(v)}},Cn=function(o){this.parser=new Kn(o)};Cn.prototype.write=function(o){return this.parser.write(o)},Cn.toLineString=function(o,u){if(arguments.length!==2)throw new Error("Not implemented");return"LINESTRING ( "+o.x+" "+o.y+", "+u.x+" "+u.y+" )"};var $i=function(o){function u(v){o.call(this,v),this.name="RuntimeException",this.message=v,this.stack=new o().stack}return o&&(u.__proto__=o),u.prototype=Object.create(o&&o.prototype),u.prototype.constructor=u,u}(Error),ci=function(o){function u(){if(o.call(this),arguments.length===0)o.call(this);else if(arguments.length===1){var v=arguments[0];o.call(this,v)}}return o&&(u.__proto__=o),u.prototype=Object.create(o&&o.prototype),u.prototype.constructor=u,u.prototype.interfaces_=function(){return[]},u.prototype.getClass=function(){return u},u}($i),Ft=function(){};Ft.prototype.interfaces_=function(){return[]},Ft.prototype.getClass=function(){return Ft},Ft.shouldNeverReachHere=function(){if(arguments.length===0)Ft.shouldNeverReachHere(null);else if(arguments.length===1){var o=arguments[0];throw new ci("Should never reach here"+(o!==null?": "+o:""))}},Ft.isTrue=function(){var o,u;if(arguments.length===1)o=arguments[0],Ft.isTrue(o,null);else if(arguments.length===2&&(o=arguments[0],u=arguments[1],!o))throw u===null?new ci:new ci(u)},Ft.equals=function(){var o,u,v;if(arguments.length===2)o=arguments[0],u=arguments[1],Ft.equals(o,u,null);else if(arguments.length===3&&(o=arguments[0],u=arguments[1],v=arguments[2],!u.equals(o)))throw new ci("Expected "+o+" but encountered "+u+(v!==null?": "+v:""))};var te=function(){this._result=null,this._inputLines=Array(2).fill().map(function(){return Array(2)}),this._intPt=new Array(2).fill(null),this._intLineIndex=null,this._isProper=null,this._pa=null,this._pb=null,this._precisionModel=null,this._intPt[0]=new Y,this._intPt[1]=new Y,this._pa=this._intPt[0],this._pb=this._intPt[1],this._result=0},We={DONT_INTERSECT:{configurable:!0},DO_INTERSECT:{configurable:!0},COLLINEAR:{configurable:!0},NO_INTERSECTION:{configurable:!0},POINT_INTERSECTION:{configurable:!0},COLLINEAR_INTERSECTION:{configurable:!0}};te.prototype.getIndexAlongSegment=function(o,u){return this.computeIntLineIndex(),this._intLineIndex[o][u]},te.prototype.getTopologySummary=function(){var o=new ue;return this.isEndPoint()&&o.append(" endpoint"),this._isProper&&o.append(" proper"),this.isCollinear()&&o.append(" collinear"),o.toString()},te.prototype.computeIntersection=function(o,u,v,y){this._inputLines[0][0]=o,this._inputLines[0][1]=u,this._inputLines[1][0]=v,this._inputLines[1][1]=y,this._result=this.computeIntersect(o,u,v,y)},te.prototype.getIntersectionNum=function(){return this._result},te.prototype.computeIntLineIndex=function(){if(arguments.length===0)this._intLineIndex===null&&(this._intLineIndex=Array(2).fill().map(function(){return Array(2)}),this.computeIntLineIndex(0),this.computeIntLineIndex(1));else if(arguments.length===1){var o=arguments[0];this.getEdgeDistance(o,0)>this.getEdgeDistance(o,1)?(this._intLineIndex[o][0]=0,this._intLineIndex[o][1]=1):(this._intLineIndex[o][0]=1,this._intLineIndex[o][1]=0)}},te.prototype.isProper=function(){return this.hasIntersection()&&this._isProper},te.prototype.setPrecisionModel=function(o){this._precisionModel=o},te.prototype.isInteriorIntersection=function(){if(arguments.length===0)return!!this.isInteriorIntersection(0)||!!this.isInteriorIntersection(1);if(arguments.length===1){for(var o=arguments[0],u=0;u<this._result;u++)if(!this._intPt[u].equals2D(this._inputLines[o][0])&&!this._intPt[u].equals2D(this._inputLines[o][1]))return!0;return!1}},te.prototype.getIntersection=function(o){return this._intPt[o]},te.prototype.isEndPoint=function(){return this.hasIntersection()&&!this._isProper},te.prototype.hasIntersection=function(){return this._result!==te.NO_INTERSECTION},te.prototype.getEdgeDistance=function(o,u){return te.computeEdgeDistance(this._intPt[u],this._inputLines[o][0],this._inputLines[o][1])},te.prototype.isCollinear=function(){return this._result===te.COLLINEAR_INTERSECTION},te.prototype.toString=function(){return Cn.toLineString(this._inputLines[0][0],this._inputLines[0][1])+" - "+Cn.toLineString(this._inputLines[1][0],this._inputLines[1][1])+this.getTopologySummary()},te.prototype.getEndpoint=function(o,u){return this._inputLines[o][u]},te.prototype.isIntersection=function(o){for(var u=0;u<this._result;u++)if(this._intPt[u].equals2D(o))return!0;return!1},te.prototype.getIntersectionAlongSegment=function(o,u){return this.computeIntLineIndex(),this._intPt[this._intLineIndex[o][u]]},te.prototype.interfaces_=function(){return[]},te.prototype.getClass=function(){return te},te.computeEdgeDistance=function(o,u,v){var y=Math.abs(v.x-u.x),b=Math.abs(v.y-u.y),H=-1;if(o.equals(u))H=0;else if(o.equals(v))H=y>b?y:b;else{var ne=Math.abs(o.x-u.x),Le=Math.abs(o.y-u.y);(H=y>b?ne:Le)!==0||o.equals(u)||(H=Math.max(ne,Le))}return Ft.isTrue(!(H===0&&!o.equals(u)),"Bad distance calculation"),H},te.nonRobustComputeEdgeDistance=function(o,u,v){var y=o.x-u.x,b=o.y-u.y,H=Math.sqrt(y*y+b*b);return Ft.isTrue(!(H===0&&!o.equals(u)),"Invalid distance calculation"),H},We.DONT_INTERSECT.get=function(){return 0},We.DO_INTERSECT.get=function(){return 1},We.COLLINEAR.get=function(){return 2},We.NO_INTERSECTION.get=function(){return 0},We.POINT_INTERSECTION.get=function(){return 1},We.COLLINEAR_INTERSECTION.get=function(){return 2},Object.defineProperties(te,We);var Qe=function(o){function u(){o.apply(this,arguments)}return o&&(u.__proto__=o),u.prototype=Object.create(o&&o.prototype),u.prototype.constructor=u,u.prototype.isInSegmentEnvelopes=function(v){var y=new Mr(this._inputLines[0][0],this._inputLines[0][1]),b=new Mr(this._inputLines[1][0],this._inputLines[1][1]);return y.contains(v)&&b.contains(v)},u.prototype.computeIntersection=function(){if(arguments.length!==3)return o.prototype.computeIntersection.apply(this,arguments);var v=arguments[0],y=arguments[1],b=arguments[2];if(this._isProper=!1,Mr.intersects(y,b,v)&&Pt.orientationIndex(y,b,v)===0&&Pt.orientationIndex(b,y,v)===0)return this._isProper=!0,(v.equals(y)||v.equals(b))&&(this._isProper=!1),this._result=o.POINT_INTERSECTION,null;this._result=o.NO_INTERSECTION},u.prototype.normalizeToMinimum=function(v,y,b,H,ne){ne.x=this.smallestInAbsValue(v.x,y.x,b.x,H.x),ne.y=this.smallestInAbsValue(v.y,y.y,b.y,H.y),v.x-=ne.x,v.y-=ne.y,y.x-=ne.x,y.y-=ne.y,b.x-=ne.x,b.y-=ne.y,H.x-=ne.x,H.y-=ne.y},u.prototype.safeHCoordinateIntersection=function(v,y,b,H){var ne=null;try{ne=tn.intersection(v,y,b,H)}catch(Le){if(!(Le instanceof Ir))throw Le;ne=u.nearestEndpoint(v,y,b,H)}return ne},u.prototype.intersection=function(v,y,b,H){var ne=this.intersectionWithNormalization(v,y,b,H);return this.isInSegmentEnvelopes(ne)||(ne=new Y(u.nearestEndpoint(v,y,b,H))),this._precisionModel!==null&&this._precisionModel.makePrecise(ne),ne},u.prototype.smallestInAbsValue=function(v,y,b,H){var ne=v,Le=Math.abs(ne);return Math.abs(y)<Le&&(ne=y,Le=Math.abs(y)),Math.abs(b)<Le&&(ne=b,Le=Math.abs(b)),Math.abs(H)<Le&&(ne=H),ne},u.prototype.checkDD=function(v,y,b,H,ne){var Le=kt.intersection(v,y,b,H),tt=this.isInSegmentEnvelopes(Le);Qr.out.println("DD in env = "+tt+"  --------------------- "+Le),ne.distance(Le)>1e-4&&Qr.out.println("Distance = "+ne.distance(Le))},u.prototype.intersectionWithNormalization=function(v,y,b,H){var ne=new Y(v),Le=new Y(y),tt=new Y(b),Nt=new Y(H),ar=new Y;this.normalizeToEnvCentre(ne,Le,tt,Nt,ar);var st=this.safeHCoordinateIntersection(ne,Le,tt,Nt);return st.x+=ar.x,st.y+=ar.y,st},u.prototype.computeCollinearIntersection=function(v,y,b,H){var ne=Mr.intersects(v,y,b),Le=Mr.intersects(v,y,H),tt=Mr.intersects(b,H,v),Nt=Mr.intersects(b,H,y);return ne&&Le?(this._intPt[0]=b,this._intPt[1]=H,o.COLLINEAR_INTERSECTION):tt&&Nt?(this._intPt[0]=v,this._intPt[1]=y,o.COLLINEAR_INTERSECTION):ne&&tt?(this._intPt[0]=b,this._intPt[1]=v,!b.equals(v)||Le||Nt?o.COLLINEAR_INTERSECTION:o.POINT_INTERSECTION):ne&&Nt?(this._intPt[0]=b,this._intPt[1]=y,!b.equals(y)||Le||tt?o.COLLINEAR_INTERSECTION:o.POINT_INTERSECTION):Le&&tt?(this._intPt[0]=H,this._intPt[1]=v,!H.equals(v)||ne||Nt?o.COLLINEAR_INTERSECTION:o.POINT_INTERSECTION):Le&&Nt?(this._intPt[0]=H,this._intPt[1]=y,!H.equals(y)||ne||tt?o.COLLINEAR_INTERSECTION:o.POINT_INTERSECTION):o.NO_INTERSECTION},u.prototype.normalizeToEnvCentre=function(v,y,b,H,ne){var Le=v.x<y.x?v.x:y.x,tt=v.y<y.y?v.y:y.y,Nt=v.x>y.x?v.x:y.x,ar=v.y>y.y?v.y:y.y,st=b.x<H.x?b.x:H.x,Gt=b.y<H.y?b.y:H.y,ir=b.x>H.x?b.x:H.x,br=b.y>H.y?b.y:H.y,g=((Le>st?Le:st)+(Nt<ir?Nt:ir))/2,Bn=((tt>Gt?tt:Gt)+(ar<br?ar:br))/2;ne.x=g,ne.y=Bn,v.x-=ne.x,v.y-=ne.y,y.x-=ne.x,y.y-=ne.y,b.x-=ne.x,b.y-=ne.y,H.x-=ne.x,H.y-=ne.y},u.prototype.computeIntersect=function(v,y,b,H){if(this._isProper=!1,!Mr.intersects(v,y,b,H))return o.NO_INTERSECTION;var ne=Pt.orientationIndex(v,y,b),Le=Pt.orientationIndex(v,y,H);if(ne>0&&Le>0||ne<0&&Le<0)return o.NO_INTERSECTION;var tt=Pt.orientationIndex(b,H,v),Nt=Pt.orientationIndex(b,H,y);return tt>0&&Nt>0||tt<0&&Nt<0?o.NO_INTERSECTION:ne===0&&Le===0&&tt===0&&Nt===0?this.computeCollinearIntersection(v,y,b,H):(ne===0||Le===0||tt===0||Nt===0?(this._isProper=!1,v.equals2D(b)||v.equals2D(H)?this._intPt[0]=v:y.equals2D(b)||y.equals2D(H)?this._intPt[0]=y:ne===0?this._intPt[0]=new Y(b):Le===0?this._intPt[0]=new Y(H):tt===0?this._intPt[0]=new Y(v):Nt===0&&(this._intPt[0]=new Y(y))):(this._isProper=!0,this._intPt[0]=this.intersection(v,y,b,H)),o.POINT_INTERSECTION)},u.prototype.interfaces_=function(){return[]},u.prototype.getClass=function(){return u},u.nearestEndpoint=function(v,y,b,H){var ne=v,Le=Pt.distancePointLine(v,b,H),tt=Pt.distancePointLine(y,b,H);return tt<Le&&(Le=tt,ne=y),(tt=Pt.distancePointLine(b,v,y))<Le&&(Le=tt,ne=b),(tt=Pt.distancePointLine(H,v,y))<Le&&(Le=tt,ne=H),ne},u}(te),vt=function(){};vt.prototype.interfaces_=function(){return[]},vt.prototype.getClass=function(){return vt},vt.orientationIndex=function(o,u,v){var y=u.x-o.x,b=u.y-o.y,H=v.x-u.x,ne=v.y-u.y;return vt.signOfDet2x2(y,b,H,ne)},vt.signOfDet2x2=function(o,u,v,y){var b=null,H=null,ne=null;if(b=1,o===0||y===0)return u===0||v===0?0:u>0?v>0?-b:b:v>0?b:-b;if(u===0||v===0)return y>0?o>0?b:-b:o>0?-b:b;if(u>0?y>0?u<=y||(b=-b,H=o,o=v,v=H,H=u,u=y,y=H):u<=-y?(b=-b,v=-v,y=-y):(H=o,o=-v,v=H,H=u,u=-y,y=H):y>0?-u<=y?(b=-b,o=-o,u=-u):(H=-o,o=v,v=H,H=-u,u=y,y=H):u>=y?(o=-o,u=-u,v=-v,y=-y):(b=-b,H=-o,o=-v,v=H,H=-u,u=-y,y=H),o>0){if(!(v>0)||!(o<=v))return b}else{if(v>0||!(o>=v))return-b;b=-b,o=-o,v=-v}for(;;){if(ne=Math.floor(v/o),v-=ne*o,(y-=ne*u)<0)return-b;if(y>u)return b;if(o>v+v){if(u<y+y)return b}else{if(u>y+y)return-b;v=o-v,y=u-y,b=-b}if(y===0)return v===0?0:-b;if(v===0||(ne=Math.floor(o/v),o-=ne*v,(u-=ne*y)<0))return b;if(u>y)return-b;if(v>o+o){if(y<u+u)return-b}else{if(y>u+u)return b;o=v-o,u=y-u,b=-b}if(u===0)return o===0?0:b;if(o===0)return-b}};var Lt=function(){this._p=null,this._crossingCount=0,this._isPointOnSegment=!1;var o=arguments[0];this._p=o};Lt.prototype.countSegment=function(o,u){if(o.x<this._p.x&&u.x<this._p.x)return null;if(this._p.x===u.x&&this._p.y===u.y)return this._isPointOnSegment=!0,null;if(o.y===this._p.y&&u.y===this._p.y){var v=o.x,y=u.x;return v>y&&(v=u.x,y=o.x),this._p.x>=v&&this._p.x<=y&&(this._isPointOnSegment=!0),null}if(o.y>this._p.y&&u.y<=this._p.y||u.y>this._p.y&&o.y<=this._p.y){var b=o.x-this._p.x,H=o.y-this._p.y,ne=u.x-this._p.x,Le=u.y-this._p.y,tt=vt.signOfDet2x2(b,H,ne,Le);if(tt===0)return this._isPointOnSegment=!0,null;Le<H&&(tt=-tt),tt>0&&this._crossingCount++}},Lt.prototype.isPointInPolygon=function(){return this.getLocation()!==ye.EXTERIOR},Lt.prototype.getLocation=function(){return this._isPointOnSegment?ye.BOUNDARY:this._crossingCount%2==1?ye.INTERIOR:ye.EXTERIOR},Lt.prototype.isOnSegment=function(){return this._isPointOnSegment},Lt.prototype.interfaces_=function(){return[]},Lt.prototype.getClass=function(){return Lt},Lt.locatePointInRing=function(){if(arguments[0]instanceof Y&&Pe(arguments[1],Wt)){for(var o=arguments[0],u=arguments[1],v=new Lt(o),y=new Y,b=new Y,H=1;H<u.size();H++)if(u.getCoordinate(H,y),u.getCoordinate(H-1,b),v.countSegment(y,b),v.isOnSegment())return v.getLocation();return v.getLocation()}if(arguments[0]instanceof Y&&arguments[1]instanceof Array){for(var ne=arguments[0],Le=arguments[1],tt=new Lt(ne),Nt=1;Nt<Le.length;Nt++){var ar=Le[Nt],st=Le[Nt-1];if(tt.countSegment(ar,st),tt.isOnSegment())return tt.getLocation()}return tt.getLocation()}};var Pt=function(){},Cr={CLOCKWISE:{configurable:!0},RIGHT:{configurable:!0},COUNTERCLOCKWISE:{configurable:!0},LEFT:{configurable:!0},COLLINEAR:{configurable:!0},STRAIGHT:{configurable:!0}};Pt.prototype.interfaces_=function(){return[]},Pt.prototype.getClass=function(){return Pt},Pt.orientationIndex=function(o,u,v){return kt.orientationIndex(o,u,v)},Pt.signedArea=function(){if(arguments[0]instanceof Array){var o=arguments[0];if(o.length<3)return 0;for(var u=0,v=o[0].x,y=1;y<o.length-1;y++){var b=o[y].x-v,H=o[y+1].y;u+=b*(o[y-1].y-H)}return u/2}if(Pe(arguments[0],Wt)){var ne=arguments[0],Le=ne.size();if(Le<3)return 0;var tt=new Y,Nt=new Y,ar=new Y;ne.getCoordinate(0,Nt),ne.getCoordinate(1,ar);var st=Nt.x;ar.x-=st;for(var Gt=0,ir=1;ir<Le-1;ir++)tt.y=Nt.y,Nt.x=ar.x,Nt.y=ar.y,ne.getCoordinate(ir+1,ar),ar.x-=st,Gt+=Nt.x*(tt.y-ar.y);return Gt/2}},Pt.distanceLineLine=function(o,u,v,y){if(o.equals(u))return Pt.distancePointLine(o,v,y);if(v.equals(y))return Pt.distancePointLine(y,o,u);var b=!1;if(Mr.intersects(o,u,v,y)){var H=(u.x-o.x)*(y.y-v.y)-(u.y-o.y)*(y.x-v.x);if(H===0)b=!0;else{var ne=(o.y-v.y)*(y.x-v.x)-(o.x-v.x)*(y.y-v.y),Le=((o.y-v.y)*(u.x-o.x)-(o.x-v.x)*(u.y-o.y))/H,tt=ne/H;(tt<0||tt>1||Le<0||Le>1)&&(b=!0)}}else b=!0;return b?Ae.min(Pt.distancePointLine(o,v,y),Pt.distancePointLine(u,v,y),Pt.distancePointLine(v,o,u),Pt.distancePointLine(y,o,u)):0},Pt.isPointInRing=function(o,u){return Pt.locatePointInRing(o,u)!==ye.EXTERIOR},Pt.computeLength=function(o){var u=o.size();if(u<=1)return 0;var v=0,y=new Y;o.getCoordinate(0,y);for(var b=y.x,H=y.y,ne=1;ne<u;ne++){o.getCoordinate(ne,y);var Le=y.x,tt=y.y,Nt=Le-b,ar=tt-H;v+=Math.sqrt(Nt*Nt+ar*ar),b=Le,H=tt}return v},Pt.isCCW=function(o){var u=o.length-1;if(u<3)throw new Me("Ring has fewer than 4 points, so orientation cannot be determined");for(var v=o[0],y=0,b=1;b<=u;b++){var H=o[b];H.y>v.y&&(v=H,y=b)}var ne=y;do(ne-=1)<0&&(ne=u);while(o[ne].equals2D(v)&&ne!==y);var Le=y;do Le=(Le+1)%u;while(o[Le].equals2D(v)&&Le!==y);var tt=o[ne],Nt=o[Le];if(tt.equals2D(v)||Nt.equals2D(v)||tt.equals2D(Nt))return!1;var ar=Pt.computeOrientation(tt,v,Nt),st=!1;return st=ar===0?tt.x>Nt.x:ar>0,st},Pt.locatePointInRing=function(o,u){return Lt.locatePointInRing(o,u)},Pt.distancePointLinePerpendicular=function(o,u,v){var y=(v.x-u.x)*(v.x-u.x)+(v.y-u.y)*(v.y-u.y),b=((u.y-o.y)*(v.x-u.x)-(u.x-o.x)*(v.y-u.y))/y;return Math.abs(b)*Math.sqrt(y)},Pt.computeOrientation=function(o,u,v){return Pt.orientationIndex(o,u,v)},Pt.distancePointLine=function(){if(arguments.length===2){var o=arguments[0],u=arguments[1];if(u.length===0)throw new Me("Line array must contain at least one vertex");for(var v=o.distance(u[0]),y=0;y<u.length-1;y++){var b=Pt.distancePointLine(o,u[y],u[y+1]);b<v&&(v=b)}return v}if(arguments.length===3){var H=arguments[0],ne=arguments[1],Le=arguments[2];if(ne.x===Le.x&&ne.y===Le.y)return H.distance(ne);var tt=(Le.x-ne.x)*(Le.x-ne.x)+(Le.y-ne.y)*(Le.y-ne.y),Nt=((H.x-ne.x)*(Le.x-ne.x)+(H.y-ne.y)*(Le.y-ne.y))/tt;if(Nt<=0)return H.distance(ne);if(Nt>=1)return H.distance(Le);var ar=((ne.y-H.y)*(Le.x-ne.x)-(ne.x-H.x)*(Le.y-ne.y))/tt;return Math.abs(ar)*Math.sqrt(tt)}},Pt.isOnLine=function(o,u){for(var v=new Qe,y=1;y<u.length;y++){var b=u[y-1],H=u[y];if(v.computeIntersection(o,b,H),v.hasIntersection())return!0}return!1},Cr.CLOCKWISE.get=function(){return-1},Cr.RIGHT.get=function(){return Pt.CLOCKWISE},Cr.COUNTERCLOCKWISE.get=function(){return 1},Cr.LEFT.get=function(){return Pt.COUNTERCLOCKWISE},Cr.COLLINEAR.get=function(){return 0},Cr.STRAIGHT.get=function(){return Pt.COLLINEAR},Object.defineProperties(Pt,Cr);var yt=function(){};yt.prototype.filter=function(o){},yt.prototype.interfaces_=function(){return[]},yt.prototype.getClass=function(){return yt};var Ot=function(){var o=arguments[0];this._envelope=null,this._factory=null,this._SRID=null,this._userData=null,this._factory=o,this._SRID=o.getSRID()},rr={serialVersionUID:{configurable:!0},SORTINDEX_POINT:{configurable:!0},SORTINDEX_MULTIPOINT:{configurable:!0},SORTINDEX_LINESTRING:{configurable:!0},SORTINDEX_LINEARRING:{configurable:!0},SORTINDEX_MULTILINESTRING:{configurable:!0},SORTINDEX_POLYGON:{configurable:!0},SORTINDEX_MULTIPOLYGON:{configurable:!0},SORTINDEX_GEOMETRYCOLLECTION:{configurable:!0},geometryChangedFilter:{configurable:!0}};Ot.prototype.isGeometryCollection=function(){return this.getSortIndex()===Ot.SORTINDEX_GEOMETRYCOLLECTION},Ot.prototype.getFactory=function(){return this._factory},Ot.prototype.getGeometryN=function(o){return this},Ot.prototype.getArea=function(){return 0},Ot.prototype.isRectangle=function(){return!1},Ot.prototype.equals=function(){if(arguments[0]instanceof Ot){var o=arguments[0];return o!==null&&this.equalsTopo(o)}if(arguments[0]instanceof Object){var u=arguments[0];if(!(u instanceof Ot))return!1;var v=u;return this.equalsExact(v)}},Ot.prototype.equalsExact=function(o){return this===o||this.equalsExact(o,0)},Ot.prototype.geometryChanged=function(){this.apply(Ot.geometryChangedFilter)},Ot.prototype.geometryChangedAction=function(){this._envelope=null},Ot.prototype.equalsNorm=function(o){return o!==null&&this.norm().equalsExact(o.norm())},Ot.prototype.getLength=function(){return 0},Ot.prototype.getNumGeometries=function(){return 1},Ot.prototype.compareTo=function(){if(arguments.length===1){var o=arguments[0],u=o;return this.getSortIndex()!==u.getSortIndex()?this.getSortIndex()-u.getSortIndex():this.isEmpty()&&u.isEmpty()?0:this.isEmpty()?-1:u.isEmpty()?1:this.compareToSameClass(o)}if(arguments.length===2){var v=arguments[0],y=arguments[1];return this.getSortIndex()!==v.getSortIndex()?this.getSortIndex()-v.getSortIndex():this.isEmpty()&&v.isEmpty()?0:this.isEmpty()?-1:v.isEmpty()?1:this.compareToSameClass(v,y)}},Ot.prototype.getUserData=function(){return this._userData},Ot.prototype.getSRID=function(){return this._SRID},Ot.prototype.getEnvelope=function(){return this.getFactory().toGeometry(this.getEnvelopeInternal())},Ot.prototype.checkNotGeometryCollection=function(o){if(o.getSortIndex()===Ot.SORTINDEX_GEOMETRYCOLLECTION)throw new Me("This method does not support GeometryCollection arguments")},Ot.prototype.equal=function(o,u,v){return v===0?o.equals(u):o.distance(u)<=v},Ot.prototype.norm=function(){var o=this.copy();return o.normalize(),o},Ot.prototype.getPrecisionModel=function(){return this._factory.getPrecisionModel()},Ot.prototype.getEnvelopeInternal=function(){return this._envelope===null&&(this._envelope=this.computeEnvelopeInternal()),new Mr(this._envelope)},Ot.prototype.setSRID=function(o){this._SRID=o},Ot.prototype.setUserData=function(o){this._userData=o},Ot.prototype.compare=function(o,u){for(var v=o.iterator(),y=u.iterator();v.hasNext()&&y.hasNext();){var b=v.next(),H=y.next(),ne=b.compareTo(H);if(ne!==0)return ne}return v.hasNext()?1:y.hasNext()?-1:0},Ot.prototype.hashCode=function(){return this.getEnvelopeInternal().hashCode()},Ot.prototype.isGeometryCollectionOrDerived=function(){return this.getSortIndex()===Ot.SORTINDEX_GEOMETRYCOLLECTION||this.getSortIndex()===Ot.SORTINDEX_MULTIPOINT||this.getSortIndex()===Ot.SORTINDEX_MULTILINESTRING||this.getSortIndex()===Ot.SORTINDEX_MULTIPOLYGON},Ot.prototype.interfaces_=function(){return[Se,Ee,I]},Ot.prototype.getClass=function(){return Ot},Ot.hasNonEmptyElements=function(o){for(var u=0;u<o.length;u++)if(!o[u].isEmpty())return!0;return!1},Ot.hasNullElements=function(o){for(var u=0;u<o.length;u++)if(o[u]===null)return!0;return!1},rr.serialVersionUID.get=function(){return 8763622679187377e3},rr.SORTINDEX_POINT.get=function(){return 0},rr.SORTINDEX_MULTIPOINT.get=function(){return 1},rr.SORTINDEX_LINESTRING.get=function(){return 2},rr.SORTINDEX_LINEARRING.get=function(){return 3},rr.SORTINDEX_MULTILINESTRING.get=function(){return 4},rr.SORTINDEX_POLYGON.get=function(){return 5},rr.SORTINDEX_MULTIPOLYGON.get=function(){return 6},rr.SORTINDEX_GEOMETRYCOLLECTION.get=function(){return 7},rr.geometryChangedFilter.get=function(){return Sr},Object.defineProperties(Ot,rr);var Sr=function(){};Sr.interfaces_=function(){return[yt]},Sr.filter=function(o){o.geometryChangedAction()};var Lr=function(){};Lr.prototype.filter=function(o){},Lr.prototype.interfaces_=function(){return[]},Lr.prototype.getClass=function(){return Lr};var on=function(){},hn={Mod2BoundaryNodeRule:{configurable:!0},EndPointBoundaryNodeRule:{configurable:!0},MultiValentEndPointBoundaryNodeRule:{configurable:!0},MonoValentEndPointBoundaryNodeRule:{configurable:!0},MOD2_BOUNDARY_RULE:{configurable:!0},ENDPOINT_BOUNDARY_RULE:{configurable:!0},MULTIVALENT_ENDPOINT_BOUNDARY_RULE:{configurable:!0},MONOVALENT_ENDPOINT_BOUNDARY_RULE:{configurable:!0},OGC_SFS_BOUNDARY_RULE:{configurable:!0}};on.prototype.isInBoundary=function(o){},on.prototype.interfaces_=function(){return[]},on.prototype.getClass=function(){return on},hn.Mod2BoundaryNodeRule.get=function(){return zr},hn.EndPointBoundaryNodeRule.get=function(){return rn},hn.MultiValentEndPointBoundaryNodeRule.get=function(){return Wn},hn.MonoValentEndPointBoundaryNodeRule.get=function(){return jn},hn.MOD2_BOUNDARY_RULE.get=function(){return new zr},hn.ENDPOINT_BOUNDARY_RULE.get=function(){return new rn},hn.MULTIVALENT_ENDPOINT_BOUNDARY_RULE.get=function(){return new Wn},hn.MONOVALENT_ENDPOINT_BOUNDARY_RULE.get=function(){return new jn},hn.OGC_SFS_BOUNDARY_RULE.get=function(){return on.MOD2_BOUNDARY_RULE},Object.defineProperties(on,hn);var zr=function(){};zr.prototype.isInBoundary=function(o){return o%2==1},zr.prototype.interfaces_=function(){return[on]},zr.prototype.getClass=function(){return zr};var rn=function(){};rn.prototype.isInBoundary=function(o){return o>0},rn.prototype.interfaces_=function(){return[on]},rn.prototype.getClass=function(){return rn};var Wn=function(){};Wn.prototype.isInBoundary=function(o){return o>1},Wn.prototype.interfaces_=function(){return[on]},Wn.prototype.getClass=function(){return Wn};var jn=function(){};jn.prototype.isInBoundary=function(o){return o===1},jn.prototype.interfaces_=function(){return[on]},jn.prototype.getClass=function(){return jn};var mi=function(){};mi.prototype.add=function(){},mi.prototype.addAll=function(){},mi.prototype.isEmpty=function(){},mi.prototype.iterator=function(){},mi.prototype.size=function(){},mi.prototype.toArray=function(){},mi.prototype.remove=function(){},(D.prototype=new Error).name="IndexOutOfBoundsException";var Ea=function(){};Ea.prototype.hasNext=function(){},Ea.prototype.next=function(){},Ea.prototype.remove=function(){};var ja=function(o){function u(){o.apply(this,arguments)}return o&&(u.__proto__=o),u.prototype=Object.create(o&&o.prototype),u.prototype.constructor=u,u.prototype.get=function(){},u.prototype.set=function(){},u.prototype.isEmpty=function(){},u}(mi);(G.prototype=new Error).name="NoSuchElementException";var Wr=function(o){function u(){o.call(this),this.array_=[],arguments[0]instanceof mi&&this.addAll(arguments[0])}return o&&(u.__proto__=o),u.prototype=Object.create(o&&o.prototype),u.prototype.constructor=u,u.prototype.ensureCapacity=function(){},u.prototype.interfaces_=function(){return[o,mi]},u.prototype.add=function(v){return arguments.length===1?this.array_.push(v):this.array_.splice(arguments[0],arguments[1]),!0},u.prototype.clear=function(){this.array_=[]},u.prototype.addAll=function(v){for(var y=v.iterator();y.hasNext();)this.add(y.next());return!0},u.prototype.set=function(v,y){var b=this.array_[v];return this.array_[v]=y,b},u.prototype.iterator=function(){return new no(this)},u.prototype.get=function(v){if(v<0||v>=this.size())throw new D;return this.array_[v]},u.prototype.isEmpty=function(){return this.array_.length===0},u.prototype.size=function(){return this.array_.length},u.prototype.toArray=function(){for(var v=[],y=0,b=this.array_.length;y<b;y++)v.push(this.array_[y]);return v},u.prototype.remove=function(v){for(var y=!1,b=0,H=this.array_.length;b<H;b++)if(this.array_[b]===v){this.array_.splice(b,1),y=!0;break}return y},u}(ja),no=function(o){function u(v){o.call(this),this.arrayList_=v,this.position_=0}return o&&(u.__proto__=o),u.prototype=Object.create(o&&o.prototype),u.prototype.constructor=u,u.prototype.next=function(){if(this.position_===this.arrayList_.size())throw new G;return this.arrayList_.get(this.position_++)},u.prototype.hasNext=function(){return this.position_<this.arrayList_.size()},u.prototype.set=function(v){return this.arrayList_.set(this.position_-1,v)},u.prototype.remove=function(){this.arrayList_.remove(this.arrayList_.get(this.position_))},u}(Ea),Xo=function(o){function u(){if(o.call(this),arguments.length!==0){if(arguments.length===1){var y=arguments[0];this.ensureCapacity(y.length),this.add(y,!0)}else if(arguments.length===2){var b=arguments[0],H=arguments[1];this.ensureCapacity(b.length),this.add(b,H)}}}o&&(u.__proto__=o),(u.prototype=Object.create(o&&o.prototype)).constructor=u;var v={coordArrayType:{configurable:!0}};return v.coordArrayType.get=function(){return new Array(0).fill(null)},u.prototype.getCoordinate=function(y){return this.get(y)},u.prototype.addAll=function(){if(arguments.length===2){for(var y=arguments[0],b=arguments[1],H=!1,ne=y.iterator();ne.hasNext();)this.add(ne.next(),b),H=!0;return H}return o.prototype.addAll.apply(this,arguments)},u.prototype.clone=function(){for(var y=o.prototype.clone.call(this),b=0;b<this.size();b++)y.add(b,this.get(b).copy());return y},u.prototype.toCoordinateArray=function(){return this.toArray(u.coordArrayType)},u.prototype.add=function(){if(arguments.length===1){var y=arguments[0];o.prototype.add.call(this,y)}else if(arguments.length===2){if(arguments[0]instanceof Array&&typeof arguments[1]=="boolean"){var b=arguments[0],H=arguments[1];return this.add(b,H,!0),!0}if(arguments[0]instanceof Y&&typeof arguments[1]=="boolean"){var ne=arguments[0];if(!arguments[1]&&this.size()>=1&&this.get(this.size()-1).equals2D(ne))return null;o.prototype.add.call(this,ne)}else if(arguments[0]instanceof Object&&typeof arguments[1]=="boolean"){var Le=arguments[0],tt=arguments[1];return this.add(Le,tt),!0}}else if(arguments.length===3){if(typeof arguments[2]=="boolean"&&arguments[0]instanceof Array&&typeof arguments[1]=="boolean"){var Nt=arguments[0],ar=arguments[1];if(arguments[2])for(var st=0;st<Nt.length;st++)this.add(Nt[st],ar);else for(var Gt=Nt.length-1;Gt>=0;Gt--)this.add(Nt[Gt],ar);return!0}if(typeof arguments[2]=="boolean"&&Number.isInteger(arguments[0])&&arguments[1]instanceof Y){var ir=arguments[0],br=arguments[1];if(!arguments[2]){var g=this.size();if(g>0&&(ir>0&&this.get(ir-1).equals2D(br)||ir<g&&this.get(ir).equals2D(br)))return null}o.prototype.add.call(this,ir,br)}}else if(arguments.length===4){var Bn=arguments[0],Jn=arguments[1],et=arguments[2],Za=arguments[3],Eo=1;et>Za&&(Eo=-1);for(var oo=et;oo!==Za;oo+=Eo)this.add(Bn[oo],Jn);return!0}},u.prototype.closeRing=function(){this.size()>0&&this.add(new Y(this.get(0)),!1)},u.prototype.interfaces_=function(){return[]},u.prototype.getClass=function(){return u},Object.defineProperties(u,v),u}(Wr),Xn=function(){},Hs={ForwardComparator:{configurable:!0},BidirectionalComparator:{configurable:!0},coordArrayType:{configurable:!0}};Hs.ForwardComparator.get=function(){return Bo},Hs.BidirectionalComparator.get=function(){return iu},Hs.coordArrayType.get=function(){return new Array(0).fill(null)},Xn.prototype.interfaces_=function(){return[]},Xn.prototype.getClass=function(){return Xn},Xn.isRing=function(o){return!(o.length<4)&&!!o[0].equals2D(o[o.length-1])},Xn.ptNotInList=function(o,u){for(var v=0;v<o.length;v++){var y=o[v];if(Xn.indexOf(y,u)<0)return y}return null},Xn.scroll=function(o,u){var v=Xn.indexOf(u,o);if(v<0)return null;var y=new Array(o.length).fill(null);Qr.arraycopy(o,v,y,0,o.length-v),Qr.arraycopy(o,0,y,o.length-v,v),Qr.arraycopy(y,0,o,0,o.length)},Xn.equals=function(){if(arguments.length===2){var o=arguments[0],u=arguments[1];if(o===u)return!0;if(o===null||u===null||o.length!==u.length)return!1;for(var v=0;v<o.length;v++)if(!o[v].equals(u[v]))return!1;return!0}if(arguments.length===3){var y=arguments[0],b=arguments[1],H=arguments[2];if(y===b)return!0;if(y===null||b===null||y.length!==b.length)return!1;for(var ne=0;ne<y.length;ne++)if(H.compare(y[ne],b[ne])!==0)return!1;return!0}},Xn.intersection=function(o,u){for(var v=new Xo,y=0;y<o.length;y++)u.intersects(o[y])&&v.add(o[y],!0);return v.toCoordinateArray()},Xn.hasRepeatedPoints=function(o){for(var u=1;u<o.length;u++)if(o[u-1].equals(o[u]))return!0;return!1},Xn.removeRepeatedPoints=function(o){return Xn.hasRepeatedPoints(o)?new Xo(o,!1).toCoordinateArray():o},Xn.reverse=function(o){for(var u=o.length-1,v=Math.trunc(u/2),y=0;y<=v;y++){var b=o[y];o[y]=o[u-y],o[u-y]=b}},Xn.removeNull=function(o){for(var u=0,v=0;v<o.length;v++)o[v]!==null&&u++;var y=new Array(u).fill(null);if(u===0)return y;for(var b=0,H=0;H<o.length;H++)o[H]!==null&&(y[b++]=o[H]);return y},Xn.copyDeep=function(){if(arguments.length===1){for(var o=arguments[0],u=new Array(o.length).fill(null),v=0;v<o.length;v++)u[v]=new Y(o[v]);return u}if(arguments.length===5)for(var y=arguments[0],b=arguments[1],H=arguments[2],ne=arguments[3],Le=arguments[4],tt=0;tt<Le;tt++)H[ne+tt]=new Y(y[b+tt])},Xn.isEqualReversed=function(o,u){for(var v=0;v<o.length;v++){var y=o[v],b=u[o.length-v-1];if(y.compareTo(b)!==0)return!1}return!0},Xn.envelope=function(o){for(var u=new Mr,v=0;v<o.length;v++)u.expandToInclude(o[v]);return u},Xn.toCoordinateArray=function(o){return o.toArray(Xn.coordArrayType)},Xn.atLeastNCoordinatesOrNothing=function(o,u){return u.length>=o?u:[]},Xn.indexOf=function(o,u){for(var v=0;v<u.length;v++)if(o.equals(u[v]))return v;return-1},Xn.increasingDirection=function(o){for(var u=0;u<Math.trunc(o.length/2);u++){var v=o.length-1-u,y=o[u].compareTo(o[v]);if(y!==0)return y}return 1},Xn.compare=function(o,u){for(var v=0;v<o.length&&v<u.length;){var y=o[v].compareTo(u[v]);if(y!==0)return y;v++}return v<u.length?-1:v<o.length?1:0},Xn.minCoordinate=function(o){for(var u=null,v=0;v<o.length;v++)(u===null||u.compareTo(o[v])>0)&&(u=o[v]);return u},Xn.extract=function(o,u,v){u=Ae.clamp(u,0,o.length);var y=(v=Ae.clamp(v,-1,o.length))-u+1;v<0&&(y=0),u>=o.length&&(y=0),v<u&&(y=0);var b=new Array(y).fill(null);if(y===0)return b;for(var H=0,ne=u;ne<=v;ne++)b[H++]=o[ne];return b},Object.defineProperties(Xn,Hs);var Bo=function(){};Bo.prototype.compare=function(o,u){return Xn.compare(o,u)},Bo.prototype.interfaces_=function(){return[oe]},Bo.prototype.getClass=function(){return Bo};var iu=function(){};iu.prototype.compare=function(o,u){var v=o,y=u;if(v.length<y.length)return-1;if(v.length>y.length)return 1;if(v.length===0)return 0;var b=Xn.compare(v,y);return Xn.isEqualReversed(v,y)?0:b},iu.prototype.OLDcompare=function(o,u){var v=o,y=u;if(v.length<y.length)return-1;if(v.length>y.length)return 1;if(v.length===0)return 0;for(var b=Xn.increasingDirection(v),H=Xn.increasingDirection(y),ne=b>0?0:v.length-1,Le=H>0?0:v.length-1,tt=0;tt<v.length;tt++){var Nt=v[ne].compareTo(y[Le]);if(Nt!==0)return Nt;ne+=b,Le+=H}return 0},iu.prototype.interfaces_=function(){return[oe]},iu.prototype.getClass=function(){return iu};var ts=function(){};ts.prototype.get=function(){},ts.prototype.put=function(){},ts.prototype.size=function(){},ts.prototype.values=function(){},ts.prototype.entrySet=function(){};var Vl=function(o){function u(){o.apply(this,arguments)}return o&&(u.__proto__=o),u.prototype=Object.create(o&&o.prototype),u.prototype.constructor=u,u}(ts);(U.prototype=new Error).name="OperationNotSupported",(B.prototype=new mi).contains=function(){};var ku=function(o){function u(){o.call(this),this.array_=[],arguments[0]instanceof mi&&this.addAll(arguments[0])}return o&&(u.__proto__=o),u.prototype=Object.create(o&&o.prototype),u.prototype.constructor=u,u.prototype.contains=function(v){for(var y=0,b=this.array_.length;y<b;y++)if(this.array_[y]===v)return!0;return!1},u.prototype.add=function(v){return!this.contains(v)&&(this.array_.push(v),!0)},u.prototype.addAll=function(v){for(var y=v.iterator();y.hasNext();)this.add(y.next());return!0},u.prototype.remove=function(v){throw new Error},u.prototype.size=function(){return this.array_.length},u.prototype.isEmpty=function(){return this.array_.length===0},u.prototype.toArray=function(){for(var v=[],y=0,b=this.array_.length;y<b;y++)v.push(this.array_[y]);return v},u.prototype.iterator=function(){return new Ds(this)},u}(B),Ds=function(o){function u(v){o.call(this),this.hashSet_=v,this.position_=0}return o&&(u.__proto__=o),u.prototype=Object.create(o&&o.prototype),u.prototype.constructor=u,u.prototype.next=function(){if(this.position_===this.hashSet_.size())throw new G;return this.hashSet_.array_[this.position_++]},u.prototype.hasNext=function(){return this.position_<this.hashSet_.size()},u.prototype.remove=function(){throw new U},u}(Ea),bs=0;(Ce.prototype=new Vl).get=function(o){for(var u=this.root_;u!==null;){var v=o.compareTo(u.key);if(v<0)u=u.left;else{if(!(v>0))return u.value;u=u.right}}return null},Ce.prototype.put=function(o,u){if(this.root_===null)return this.root_={key:o,value:u,left:null,right:null,parent:null,color:bs,getValue:function(){return this.value},getKey:function(){return this.key}},this.size_=1,null;var v,y,b=this.root_;do if(v=b,(y=o.compareTo(b.key))<0)b=b.left;else{if(!(y>0)){var H=b.value;return b.value=u,H}b=b.right}while(b!==null);var ne={key:o,left:null,right:null,value:u,parent:v,color:bs,getValue:function(){return this.value},getKey:function(){return this.key}};return y<0?v.left=ne:v.right=ne,this.fixAfterInsertion(ne),this.size_++,null},Ce.prototype.fixAfterInsertion=function(o){for(o.color=1;o!=null&&o!==this.root_&&o.parent.color===1;)if(X(o)===ie(X(X(o)))){var u=he(X(X(o)));Z(u)===1?(q(X(o),bs),q(u,bs),q(X(X(o)),1),o=X(X(o))):(o===he(X(o))&&(o=X(o),this.rotateLeft(o)),q(X(o),bs),q(X(X(o)),1),this.rotateRight(X(X(o))))}else{var v=ie(X(X(o)));Z(v)===1?(q(X(o),bs),q(v,bs),q(X(X(o)),1),o=X(X(o))):(o===ie(X(o))&&(o=X(o),this.rotateRight(o)),q(X(o),bs),q(X(X(o)),1),this.rotateLeft(X(X(o))))}this.root_.color=bs},Ce.prototype.values=function(){var o=new Wr,u=this.getFirstEntry();if(u!==null)for(o.add(u.value);(u=Ce.successor(u))!==null;)o.add(u.value);return o},Ce.prototype.entrySet=function(){var o=new ku,u=this.getFirstEntry();if(u!==null)for(o.add(u);(u=Ce.successor(u))!==null;)o.add(u);return o},Ce.prototype.rotateLeft=function(o){if(o!=null){var u=o.right;o.right=u.left,u.left!=null&&(u.left.parent=o),u.parent=o.parent,o.parent===null?this.root_=u:o.parent.left===o?o.parent.left=u:o.parent.right=u,u.left=o,o.parent=u}},Ce.prototype.rotateRight=function(o){if(o!=null){var u=o.left;o.left=u.right,u.right!=null&&(u.right.parent=o),u.parent=o.parent,o.parent===null?this.root_=u:o.parent.right===o?o.parent.right=u:o.parent.left=u,u.right=o,o.parent=u}},Ce.prototype.getFirstEntry=function(){var o=this.root_;if(o!=null)for(;o.left!=null;)o=o.left;return o},Ce.successor=function(o){if(o===null)return null;if(o.right!==null){for(var u=o.right;u.left!==null;)u=u.left;return u}for(var v=o.parent,y=o;v!==null&&y===v.right;)y=v,v=v.parent;return v},Ce.prototype.size=function(){return this.size_};var Fa=function(){};Fa.prototype.interfaces_=function(){return[]},Fa.prototype.getClass=function(){return Fa},be.prototype=new B,(Ze.prototype=new be).contains=function(o){for(var u=0,v=this.array_.length;u<v;u++)if(this.array_[u].compareTo(o)===0)return!0;return!1},Ze.prototype.add=function(o){if(this.contains(o))return!1;for(var u=0,v=this.array_.length;u<v;u++)if(this.array_[u].compareTo(o)===1)return this.array_.splice(u,0,o),!0;return this.array_.push(o),!0},Ze.prototype.addAll=function(o){for(var u=o.iterator();u.hasNext();)this.add(u.next());return!0},Ze.prototype.remove=function(o){throw new U},Ze.prototype.size=function(){return this.array_.length},Ze.prototype.isEmpty=function(){return this.array_.length===0},Ze.prototype.toArray=function(){for(var o=[],u=0,v=this.array_.length;u<v;u++)o.push(this.array_[u]);return o},Ze.prototype.iterator=function(){return new uc(this)};var uc=function(o){this.treeSet_=o,this.position_=0};uc.prototype.next=function(){if(this.position_===this.treeSet_.size())throw new G;return this.treeSet_.array_[this.position_++]},uc.prototype.hasNext=function(){return this.position_<this.treeSet_.size()},uc.prototype.remove=function(){throw new U};var Uu=function(){};Uu.sort=function(){var o,u,v,y,b=arguments[0];if(arguments.length===1)y=function(ne,Le){return ne.compareTo(Le)},b.sort(y);else if(arguments.length===2)v=arguments[1],y=function(ne,Le){return v.compare(ne,Le)},b.sort(y);else if(arguments.length===3){(u=b.slice(arguments[1],arguments[2])).sort();var H=b.slice(0,arguments[1]).concat(u,b.slice(arguments[2],b.length));for(b.splice(0,b.length),o=0;o<H.length;o++)b.push(H[o])}else if(arguments.length===4)for(u=b.slice(arguments[1],arguments[2]),v=arguments[3],y=function(ne,Le){return v.compare(ne,Le)},u.sort(y),H=b.slice(0,arguments[1]).concat(u,b.slice(arguments[2],b.length)),b.splice(0,b.length),o=0;o<H.length;o++)b.push(H[o])},Uu.asList=function(o){for(var u=new Wr,v=0,y=o.length;v<y;v++)u.add(o[v]);return u};var ta=function(){},au={P:{configurable:!0},L:{configurable:!0},A:{configurable:!0},FALSE:{configurable:!0},TRUE:{configurable:!0},DONTCARE:{configurable:!0},SYM_FALSE:{configurable:!0},SYM_TRUE:{configurable:!0},SYM_DONTCARE:{configurable:!0},SYM_P:{configurable:!0},SYM_L:{configurable:!0},SYM_A:{configurable:!0}};au.P.get=function(){return 0},au.L.get=function(){return 1},au.A.get=function(){return 2},au.FALSE.get=function(){return-1},au.TRUE.get=function(){return-2},au.DONTCARE.get=function(){return-3},au.SYM_FALSE.get=function(){return"F"},au.SYM_TRUE.get=function(){return"T"},au.SYM_DONTCARE.get=function(){return"*"},au.SYM_P.get=function(){return"0"},au.SYM_L.get=function(){return"1"},au.SYM_A.get=function(){return"2"},ta.prototype.interfaces_=function(){return[]},ta.prototype.getClass=function(){return ta},ta.toDimensionSymbol=function(o){switch(o){case ta.FALSE:return ta.SYM_FALSE;case ta.TRUE:return ta.SYM_TRUE;case ta.DONTCARE:return ta.SYM_DONTCARE;case ta.P:return ta.SYM_P;case ta.L:return ta.SYM_L;case ta.A:return ta.SYM_A}throw new Me("Unknown dimension value: "+o)},ta.toDimensionValue=function(o){switch(ze.toUpperCase(o)){case ta.SYM_FALSE:return ta.FALSE;case ta.SYM_TRUE:return ta.TRUE;case ta.SYM_DONTCARE:return ta.DONTCARE;case ta.SYM_P:return ta.P;case ta.SYM_L:return ta.L;case ta.SYM_A:return ta.A}throw new Me("Unknown dimension symbol: "+o)},Object.defineProperties(ta,au);var mo=function(){};mo.prototype.filter=function(o){},mo.prototype.interfaces_=function(){return[]},mo.prototype.getClass=function(){return mo};var Rs=function(){};Rs.prototype.filter=function(o,u){},Rs.prototype.isDone=function(){},Rs.prototype.isGeometryChanged=function(){},Rs.prototype.interfaces_=function(){return[]},Rs.prototype.getClass=function(){return Rs};var rs=function(o){function u(y,b){if(o.call(this,b),this._geometries=y||[],o.hasNullElements(this._geometries))throw new Me("geometries must not contain null elements")}o&&(u.__proto__=o),(u.prototype=Object.create(o&&o.prototype)).constructor=u;var v={serialVersionUID:{configurable:!0}};return u.prototype.computeEnvelopeInternal=function(){for(var y=new Mr,b=0;b<this._geometries.length;b++)y.expandToInclude(this._geometries[b].getEnvelopeInternal());return y},u.prototype.getGeometryN=function(y){return this._geometries[y]},u.prototype.getSortIndex=function(){return o.SORTINDEX_GEOMETRYCOLLECTION},u.prototype.getCoordinates=function(){for(var y=new Array(this.getNumPoints()).fill(null),b=-1,H=0;H<this._geometries.length;H++)for(var ne=this._geometries[H].getCoordinates(),Le=0;Le<ne.length;Le++)y[++b]=ne[Le];return y},u.prototype.getArea=function(){for(var y=0,b=0;b<this._geometries.length;b++)y+=this._geometries[b].getArea();return y},u.prototype.equalsExact=function(){if(arguments.length===2){var y=arguments[0],b=arguments[1];if(!this.isEquivalentClass(y))return!1;var H=y;if(this._geometries.length!==H._geometries.length)return!1;for(var ne=0;ne<this._geometries.length;ne++)if(!this._geometries[ne].equalsExact(H._geometries[ne],b))return!1;return!0}return o.prototype.equalsExact.apply(this,arguments)},u.prototype.normalize=function(){for(var y=0;y<this._geometries.length;y++)this._geometries[y].normalize();Uu.sort(this._geometries)},u.prototype.getCoordinate=function(){return this.isEmpty()?null:this._geometries[0].getCoordinate()},u.prototype.getBoundaryDimension=function(){for(var y=ta.FALSE,b=0;b<this._geometries.length;b++)y=Math.max(y,this._geometries[b].getBoundaryDimension());return y},u.prototype.getDimension=function(){for(var y=ta.FALSE,b=0;b<this._geometries.length;b++)y=Math.max(y,this._geometries[b].getDimension());return y},u.prototype.getLength=function(){for(var y=0,b=0;b<this._geometries.length;b++)y+=this._geometries[b].getLength();return y},u.prototype.getNumPoints=function(){for(var y=0,b=0;b<this._geometries.length;b++)y+=this._geometries[b].getNumPoints();return y},u.prototype.getNumGeometries=function(){return this._geometries.length},u.prototype.reverse=function(){for(var y=this._geometries.length,b=new Array(y).fill(null),H=0;H<this._geometries.length;H++)b[H]=this._geometries[H].reverse();return this.getFactory().createGeometryCollection(b)},u.prototype.compareToSameClass=function(){if(arguments.length===1){var y=arguments[0],b=new Ze(Uu.asList(this._geometries)),H=new Ze(Uu.asList(y._geometries));return this.compare(b,H)}if(arguments.length===2){for(var ne=arguments[0],Le=arguments[1],tt=ne,Nt=this.getNumGeometries(),ar=tt.getNumGeometries(),st=0;st<Nt&&st<ar;){var Gt=this.getGeometryN(st),ir=tt.getGeometryN(st),br=Gt.compareToSameClass(ir,Le);if(br!==0)return br;st++}return st<Nt?1:st<ar?-1:0}},u.prototype.apply=function(){if(Pe(arguments[0],Lr))for(var y=arguments[0],b=0;b<this._geometries.length;b++)this._geometries[b].apply(y);else if(Pe(arguments[0],Rs)){var H=arguments[0];if(this._geometries.length===0)return null;for(var ne=0;ne<this._geometries.length&&(this._geometries[ne].apply(H),!H.isDone());ne++);H.isGeometryChanged()&&this.geometryChanged()}else if(Pe(arguments[0],mo)){var Le=arguments[0];Le.filter(this);for(var tt=0;tt<this._geometries.length;tt++)this._geometries[tt].apply(Le)}else if(Pe(arguments[0],yt)){var Nt=arguments[0];Nt.filter(this);for(var ar=0;ar<this._geometries.length;ar++)this._geometries[ar].apply(Nt)}},u.prototype.getBoundary=function(){return this.checkNotGeometryCollection(this),Ft.shouldNeverReachHere(),null},u.prototype.clone=function(){var y=o.prototype.clone.call(this);y._geometries=new Array(this._geometries.length).fill(null);for(var b=0;b<this._geometries.length;b++)y._geometries[b]=this._geometries[b].clone();return y},u.prototype.getGeometryType=function(){return"GeometryCollection"},u.prototype.copy=function(){for(var y=new Array(this._geometries.length).fill(null),b=0;b<y.length;b++)y[b]=this._geometries[b].copy();return new u(y,this._factory)},u.prototype.isEmpty=function(){for(var y=0;y<this._geometries.length;y++)if(!this._geometries[y].isEmpty())return!1;return!0},u.prototype.interfaces_=function(){return[]},u.prototype.getClass=function(){return u},v.serialVersionUID.get=function(){return-5694727726395021e3},Object.defineProperties(u,v),u}(Ot),Qi=function(o){function u(){o.apply(this,arguments)}o&&(u.__proto__=o),(u.prototype=Object.create(o&&o.prototype)).constructor=u;var v={serialVersionUID:{configurable:!0}};return u.prototype.getSortIndex=function(){return Ot.SORTINDEX_MULTILINESTRING},u.prototype.equalsExact=function(){if(arguments.length===2){var y=arguments[0],b=arguments[1];return!!this.isEquivalentClass(y)&&o.prototype.equalsExact.call(this,y,b)}return o.prototype.equalsExact.apply(this,arguments)},u.prototype.getBoundaryDimension=function(){return this.isClosed()?ta.FALSE:0},u.prototype.isClosed=function(){if(this.isEmpty())return!1;for(var y=0;y<this._geometries.length;y++)if(!this._geometries[y].isClosed())return!1;return!0},u.prototype.getDimension=function(){return 1},u.prototype.reverse=function(){for(var y=this._geometries.length,b=new Array(y).fill(null),H=0;H<this._geometries.length;H++)b[y-1-H]=this._geometries[H].reverse();return this.getFactory().createMultiLineString(b)},u.prototype.getBoundary=function(){return new _o(this).getBoundary()},u.prototype.getGeometryType=function(){return"MultiLineString"},u.prototype.copy=function(){for(var y=new Array(this._geometries.length).fill(null),b=0;b<y.length;b++)y[b]=this._geometries[b].copy();return new u(y,this._factory)},u.prototype.interfaces_=function(){return[Fa]},u.prototype.getClass=function(){return u},v.serialVersionUID.get=function(){return 8166665132445434e3},Object.defineProperties(u,v),u}(rs),_o=function(){if(this._geom=null,this._geomFact=null,this._bnRule=null,this._endpointMap=null,arguments.length===1){var o=arguments[0],u=on.MOD2_BOUNDARY_RULE;this._geom=o,this._geomFact=o.getFactory(),this._bnRule=u}else if(arguments.length===2){var v=arguments[0],y=arguments[1];this._geom=v,this._geomFact=v.getFactory(),this._bnRule=y}};_o.prototype.boundaryMultiLineString=function(o){if(this._geom.isEmpty())return this.getEmptyMultiPoint();var u=this.computeBoundaryCoordinates(o);return u.length===1?this._geomFact.createPoint(u[0]):this._geomFact.createMultiPointFromCoords(u)},_o.prototype.getBoundary=function(){return this._geom instanceof Oa?this.boundaryLineString(this._geom):this._geom instanceof Qi?this.boundaryMultiLineString(this._geom):this._geom.getBoundary()},_o.prototype.boundaryLineString=function(o){return this._geom.isEmpty()?this.getEmptyMultiPoint():o.isClosed()?this._bnRule.isInBoundary(2)?o.getStartPoint():this._geomFact.createMultiPoint():this._geomFact.createMultiPoint([o.getStartPoint(),o.getEndPoint()])},_o.prototype.getEmptyMultiPoint=function(){return this._geomFact.createMultiPoint()},_o.prototype.computeBoundaryCoordinates=function(o){var u=new Wr;this._endpointMap=new Ce;for(var v=0;v<o.getNumGeometries();v++){var y=o.getGeometryN(v);y.getNumPoints()!==0&&(this.addEndpoint(y.getCoordinateN(0)),this.addEndpoint(y.getCoordinateN(y.getNumPoints()-1)))}for(var b=this._endpointMap.entrySet().iterator();b.hasNext();){var H=b.next(),ne=H.getValue().count;this._bnRule.isInBoundary(ne)&&u.add(H.getKey())}return Xn.toCoordinateArray(u)},_o.prototype.addEndpoint=function(o){var u=this._endpointMap.get(o);u===null&&(u=new Ws,this._endpointMap.put(o,u)),u.count++},_o.prototype.interfaces_=function(){return[]},_o.prototype.getClass=function(){return _o},_o.getBoundary=function(){if(arguments.length===1){var o=arguments[0];return new _o(o).getBoundary()}if(arguments.length===2){var u=arguments[0],v=arguments[1];return new _o(u,v).getBoundary()}};var Ws=function(){this.count=null};Ws.prototype.interfaces_=function(){return[]},Ws.prototype.getClass=function(){return Ws};var ds=function(){},il={NEWLINE:{configurable:!0},SIMPLE_ORDINATE_FORMAT:{configurable:!0}};ds.prototype.interfaces_=function(){return[]},ds.prototype.getClass=function(){return ds},ds.chars=function(o,u){for(var v=new Array(u).fill(null),y=0;y<u;y++)v[y]=o;return String(v)},ds.getStackTrace=function(){if(arguments.length===1){var o=arguments[0],u=new function(){},v=new function(){}(u);return o.printStackTrace(v),u.toString()}if(arguments.length===2){for(var y=arguments[0],b=arguments[1],H="",ne=new function(){}(new function(){}(ds.getStackTrace(y))),Le=0;Le<b;Le++)try{H+=ne.readLine()+ds.NEWLINE}catch(tt){if(!(tt instanceof qe))throw tt;Ft.shouldNeverReachHere()}return H}},ds.split=function(o,u){for(var v=u.length,y=new Wr,b=""+o,H=b.indexOf(u);H>=0;){var ne=b.substring(0,H);y.add(ne),H=(b=b.substring(H+v)).indexOf(u)}b.length>0&&y.add(b);for(var Le=new Array(y.size()).fill(null),tt=0;tt<Le.length;tt++)Le[tt]=y.get(tt);return Le},ds.toString=function(){if(arguments.length===1){var o=arguments[0];return ds.SIMPLE_ORDINATE_FORMAT.format(o)}},ds.spaces=function(o){return ds.chars(" ",o)},il.NEWLINE.get=function(){return Qr.getProperty("line.separator")},il.SIMPLE_ORDINATE_FORMAT.get=function(){return new function(){}("0.#")},Object.defineProperties(ds,il);var Ba=function(){};Ba.prototype.interfaces_=function(){return[]},Ba.prototype.getClass=function(){return Ba},Ba.copyCoord=function(o,u,v,y){for(var b=Math.min(o.getDimension(),v.getDimension()),H=0;H<b;H++)v.setOrdinate(y,H,o.getOrdinate(u,H))},Ba.isRing=function(o){var u=o.size();return u===0||!(u<=3)&&o.getOrdinate(0,Wt.X)===o.getOrdinate(u-1,Wt.X)&&o.getOrdinate(0,Wt.Y)===o.getOrdinate(u-1,Wt.Y)},Ba.isEqual=function(o,u){var v=o.size();if(v!==u.size())return!1;for(var y=Math.min(o.getDimension(),u.getDimension()),b=0;b<v;b++)for(var H=0;H<y;H++){var ne=o.getOrdinate(b,H),Le=u.getOrdinate(b,H);if(o.getOrdinate(b,H)!==u.getOrdinate(b,H)&&(!ce.isNaN(ne)||!ce.isNaN(Le)))return!1}return!0},Ba.extend=function(o,u,v){var y=o.create(v,u.getDimension()),b=u.size();if(Ba.copy(u,0,y,0,b),b>0)for(var H=b;H<v;H++)Ba.copy(u,b-1,y,H,1);return y},Ba.reverse=function(o){for(var u=o.size()-1,v=Math.trunc(u/2),y=0;y<=v;y++)Ba.swap(o,y,u-y)},Ba.swap=function(o,u,v){if(u===v)return null;for(var y=0;y<o.getDimension();y++){var b=o.getOrdinate(u,y);o.setOrdinate(u,y,o.getOrdinate(v,y)),o.setOrdinate(v,y,b)}},Ba.copy=function(o,u,v,y,b){for(var H=0;H<b;H++)Ba.copyCoord(o,u+H,v,y+H)},Ba.toString=function(){if(arguments.length===1){var o=arguments[0],u=o.size();if(u===0)return"()";var v=o.getDimension(),y=new ue;y.append("(");for(var b=0;b<u;b++){b>0&&y.append(" ");for(var H=0;H<v;H++)H>0&&y.append(","),y.append(ds.toString(o.getOrdinate(b,H)))}return y.append(")"),y.toString()}},Ba.ensureValidRing=function(o,u){var v=u.size();return v===0?u:v<=3?Ba.createClosedRing(o,u,4):u.getOrdinate(0,Wt.X)===u.getOrdinate(v-1,Wt.X)&&u.getOrdinate(0,Wt.Y)===u.getOrdinate(v-1,Wt.Y)?u:Ba.createClosedRing(o,u,v+1)},Ba.createClosedRing=function(o,u,v){var y=o.create(v,u.getDimension()),b=u.size();Ba.copy(u,0,y,0,b);for(var H=b;H<v;H++)Ba.copy(u,0,y,H,1);return y};var Oa=function(o){function u(y,b){o.call(this,b),this._points=null,this.init(y)}o&&(u.__proto__=o),(u.prototype=Object.create(o&&o.prototype)).constructor=u;var v={serialVersionUID:{configurable:!0}};return u.prototype.computeEnvelopeInternal=function(){return this.isEmpty()?new Mr:this._points.expandEnvelope(new Mr)},u.prototype.isRing=function(){return this.isClosed()&&this.isSimple()},u.prototype.getSortIndex=function(){return o.SORTINDEX_LINESTRING},u.prototype.getCoordinates=function(){return this._points.toCoordinateArray()},u.prototype.equalsExact=function(){if(arguments.length===2){var y=arguments[0],b=arguments[1];if(!this.isEquivalentClass(y))return!1;var H=y;if(this._points.size()!==H._points.size())return!1;for(var ne=0;ne<this._points.size();ne++)if(!this.equal(this._points.getCoordinate(ne),H._points.getCoordinate(ne),b))return!1;return!0}return o.prototype.equalsExact.apply(this,arguments)},u.prototype.normalize=function(){for(var y=0;y<Math.trunc(this._points.size()/2);y++){var b=this._points.size()-1-y;if(!this._points.getCoordinate(y).equals(this._points.getCoordinate(b)))return this._points.getCoordinate(y).compareTo(this._points.getCoordinate(b))>0&&Ba.reverse(this._points),null}},u.prototype.getCoordinate=function(){return this.isEmpty()?null:this._points.getCoordinate(0)},u.prototype.getBoundaryDimension=function(){return this.isClosed()?ta.FALSE:0},u.prototype.isClosed=function(){return!this.isEmpty()&&this.getCoordinateN(0).equals2D(this.getCoordinateN(this.getNumPoints()-1))},u.prototype.getEndPoint=function(){return this.isEmpty()?null:this.getPointN(this.getNumPoints()-1)},u.prototype.getDimension=function(){return 1},u.prototype.getLength=function(){return Pt.computeLength(this._points)},u.prototype.getNumPoints=function(){return this._points.size()},u.prototype.reverse=function(){var y=this._points.copy();return Ba.reverse(y),this.getFactory().createLineString(y)},u.prototype.compareToSameClass=function(){if(arguments.length===1){for(var y=arguments[0],b=0,H=0;b<this._points.size()&&H<y._points.size();){var ne=this._points.getCoordinate(b).compareTo(y._points.getCoordinate(H));if(ne!==0)return ne;b++,H++}return b<this._points.size()?1:H<y._points.size()?-1:0}if(arguments.length===2){var Le=arguments[0];return arguments[1].compare(this._points,Le._points)}},u.prototype.apply=function(){if(Pe(arguments[0],Lr))for(var y=arguments[0],b=0;b<this._points.size();b++)y.filter(this._points.getCoordinate(b));else if(Pe(arguments[0],Rs)){var H=arguments[0];if(this._points.size()===0)return null;for(var ne=0;ne<this._points.size()&&(H.filter(this._points,ne),!H.isDone());ne++);H.isGeometryChanged()&&this.geometryChanged()}else Pe(arguments[0],mo)?arguments[0].filter(this):Pe(arguments[0],yt)&&arguments[0].filter(this)},u.prototype.getBoundary=function(){return new _o(this).getBoundary()},u.prototype.isEquivalentClass=function(y){return y instanceof u},u.prototype.clone=function(){var y=o.prototype.clone.call(this);return y._points=this._points.clone(),y},u.prototype.getCoordinateN=function(y){return this._points.getCoordinate(y)},u.prototype.getGeometryType=function(){return"LineString"},u.prototype.copy=function(){return new u(this._points.copy(),this._factory)},u.prototype.getCoordinateSequence=function(){return this._points},u.prototype.isEmpty=function(){return this._points.size()===0},u.prototype.init=function(y){if(y===null&&(y=this.getFactory().getCoordinateSequenceFactory().create([])),y.size()===1)throw new Me("Invalid number of points in LineString (found "+y.size()+" - must be 0 or >= 2)");this._points=y},u.prototype.isCoordinate=function(y){for(var b=0;b<this._points.size();b++)if(this._points.getCoordinate(b).equals(y))return!0;return!1},u.prototype.getStartPoint=function(){return this.isEmpty()?null:this.getPointN(0)},u.prototype.getPointN=function(y){return this.getFactory().createPoint(this._points.getCoordinate(y))},u.prototype.interfaces_=function(){return[Fa]},u.prototype.getClass=function(){return u},v.serialVersionUID.get=function(){return 0x2b2b51ba435c8e00},Object.defineProperties(u,v),u}(Ot),Cl=function(){};Cl.prototype.interfaces_=function(){return[]},Cl.prototype.getClass=function(){return Cl};var Co=function(o){function u(y,b){o.call(this,b),this._coordinates=y||null,this.init(this._coordinates)}o&&(u.__proto__=o),(u.prototype=Object.create(o&&o.prototype)).constructor=u;var v={serialVersionUID:{configurable:!0}};return u.prototype.computeEnvelopeInternal=function(){if(this.isEmpty())return new Mr;var y=new Mr;return y.expandToInclude(this._coordinates.getX(0),this._coordinates.getY(0)),y},u.prototype.getSortIndex=function(){return o.SORTINDEX_POINT},u.prototype.getCoordinates=function(){return this.isEmpty()?[]:[this.getCoordinate()]},u.prototype.equalsExact=function(){if(arguments.length===2){var y=arguments[0],b=arguments[1];return!!this.isEquivalentClass(y)&&(!(!this.isEmpty()||!y.isEmpty())||this.isEmpty()===y.isEmpty()&&this.equal(y.getCoordinate(),this.getCoordinate(),b))}return o.prototype.equalsExact.apply(this,arguments)},u.prototype.normalize=function(){},u.prototype.getCoordinate=function(){return this._coordinates.size()!==0?this._coordinates.getCoordinate(0):null},u.prototype.getBoundaryDimension=function(){return ta.FALSE},u.prototype.getDimension=function(){return 0},u.prototype.getNumPoints=function(){return this.isEmpty()?0:1},u.prototype.reverse=function(){return this.copy()},u.prototype.getX=function(){if(this.getCoordinate()===null)throw new Error("getX called on empty Point");return this.getCoordinate().x},u.prototype.compareToSameClass=function(){if(arguments.length===1){var y=arguments[0];return this.getCoordinate().compareTo(y.getCoordinate())}if(arguments.length===2){var b=arguments[0];return arguments[1].compare(this._coordinates,b._coordinates)}},u.prototype.apply=function(){if(Pe(arguments[0],Lr)){var y=arguments[0];if(this.isEmpty())return null;y.filter(this.getCoordinate())}else if(Pe(arguments[0],Rs)){var b=arguments[0];if(this.isEmpty())return null;b.filter(this._coordinates,0),b.isGeometryChanged()&&this.geometryChanged()}else Pe(arguments[0],mo)?arguments[0].filter(this):Pe(arguments[0],yt)&&arguments[0].filter(this)},u.prototype.getBoundary=function(){return this.getFactory().createGeometryCollection(null)},u.prototype.clone=function(){var y=o.prototype.clone.call(this);return y._coordinates=this._coordinates.clone(),y},u.prototype.getGeometryType=function(){return"Point"},u.prototype.copy=function(){return new u(this._coordinates.copy(),this._factory)},u.prototype.getCoordinateSequence=function(){return this._coordinates},u.prototype.getY=function(){if(this.getCoordinate()===null)throw new Error("getY called on empty Point");return this.getCoordinate().y},u.prototype.isEmpty=function(){return this._coordinates.size()===0},u.prototype.init=function(y){y===null&&(y=this.getFactory().getCoordinateSequenceFactory().create([])),Ft.isTrue(y.size()<=1),this._coordinates=y},u.prototype.isSimple=function(){return!0},u.prototype.interfaces_=function(){return[Cl]},u.prototype.getClass=function(){return u},v.serialVersionUID.get=function(){return 4902022702746615e3},Object.defineProperties(u,v),u}(Ot),gu=function(){};gu.prototype.interfaces_=function(){return[]},gu.prototype.getClass=function(){return gu};var ka=function(o){function u(y,b,H){if(o.call(this,H),this._shell=null,this._holes=null,y===null&&(y=this.getFactory().createLinearRing()),b===null&&(b=[]),o.hasNullElements(b))throw new Me("holes must not contain null elements");if(y.isEmpty()&&o.hasNonEmptyElements(b))throw new Me("shell is empty but holes are not");this._shell=y,this._holes=b}o&&(u.__proto__=o),(u.prototype=Object.create(o&&o.prototype)).constructor=u;var v={serialVersionUID:{configurable:!0}};return u.prototype.computeEnvelopeInternal=function(){return this._shell.getEnvelopeInternal()},u.prototype.getSortIndex=function(){return o.SORTINDEX_POLYGON},u.prototype.getCoordinates=function(){if(this.isEmpty())return[];for(var y=new Array(this.getNumPoints()).fill(null),b=-1,H=this._shell.getCoordinates(),ne=0;ne<H.length;ne++)y[++b]=H[ne];for(var Le=0;Le<this._holes.length;Le++)for(var tt=this._holes[Le].getCoordinates(),Nt=0;Nt<tt.length;Nt++)y[++b]=tt[Nt];return y},u.prototype.getArea=function(){var y=0;y+=Math.abs(Pt.signedArea(this._shell.getCoordinateSequence()));for(var b=0;b<this._holes.length;b++)y-=Math.abs(Pt.signedArea(this._holes[b].getCoordinateSequence()));return y},u.prototype.isRectangle=function(){if(this.getNumInteriorRing()!==0||this._shell===null||this._shell.getNumPoints()!==5)return!1;for(var y=this._shell.getCoordinateSequence(),b=this.getEnvelopeInternal(),H=0;H<5;H++){var ne=y.getX(H);if(ne!==b.getMinX()&&ne!==b.getMaxX())return!1;var Le=y.getY(H);if(Le!==b.getMinY()&&Le!==b.getMaxY())return!1}for(var tt=y.getX(0),Nt=y.getY(0),ar=1;ar<=4;ar++){var st=y.getX(ar),Gt=y.getY(ar);if(st!==tt==(Gt!==Nt))return!1;tt=st,Nt=Gt}return!0},u.prototype.equalsExact=function(){if(arguments.length===2){var y=arguments[0],b=arguments[1];if(!this.isEquivalentClass(y))return!1;var H=y,ne=this._shell,Le=H._shell;if(!ne.equalsExact(Le,b)||this._holes.length!==H._holes.length)return!1;for(var tt=0;tt<this._holes.length;tt++)if(!this._holes[tt].equalsExact(H._holes[tt],b))return!1;return!0}return o.prototype.equalsExact.apply(this,arguments)},u.prototype.normalize=function(){if(arguments.length===0){this.normalize(this._shell,!0);for(var y=0;y<this._holes.length;y++)this.normalize(this._holes[y],!1);Uu.sort(this._holes)}else if(arguments.length===2){var b=arguments[0],H=arguments[1];if(b.isEmpty())return null;var ne=new Array(b.getCoordinates().length-1).fill(null);Qr.arraycopy(b.getCoordinates(),0,ne,0,ne.length);var Le=Xn.minCoordinate(b.getCoordinates());Xn.scroll(ne,Le),Qr.arraycopy(ne,0,b.getCoordinates(),0,ne.length),b.getCoordinates()[ne.length]=ne[0],Pt.isCCW(b.getCoordinates())===H&&Xn.reverse(b.getCoordinates())}},u.prototype.getCoordinate=function(){return this._shell.getCoordinate()},u.prototype.getNumInteriorRing=function(){return this._holes.length},u.prototype.getBoundaryDimension=function(){return 1},u.prototype.getDimension=function(){return 2},u.prototype.getLength=function(){var y=0;y+=this._shell.getLength();for(var b=0;b<this._holes.length;b++)y+=this._holes[b].getLength();return y},u.prototype.getNumPoints=function(){for(var y=this._shell.getNumPoints(),b=0;b<this._holes.length;b++)y+=this._holes[b].getNumPoints();return y},u.prototype.reverse=function(){var y=this.copy();y._shell=this._shell.copy().reverse(),y._holes=new Array(this._holes.length).fill(null);for(var b=0;b<this._holes.length;b++)y._holes[b]=this._holes[b].copy().reverse();return y},u.prototype.convexHull=function(){return this.getExteriorRing().convexHull()},u.prototype.compareToSameClass=function(){if(arguments.length===1){var y=arguments[0],b=this._shell,H=y._shell;return b.compareToSameClass(H)}if(arguments.length===2){var ne=arguments[0],Le=arguments[1],tt=ne,Nt=this._shell,ar=tt._shell,st=Nt.compareToSameClass(ar,Le);if(st!==0)return st;for(var Gt=this.getNumInteriorRing(),ir=tt.getNumInteriorRing(),br=0;br<Gt&&br<ir;){var g=this.getInteriorRingN(br),Bn=tt.getInteriorRingN(br),Jn=g.compareToSameClass(Bn,Le);if(Jn!==0)return Jn;br++}return br<Gt?1:br<ir?-1:0}},u.prototype.apply=function(y){if(Pe(y,Lr)){this._shell.apply(y);for(var b=0;b<this._holes.length;b++)this._holes[b].apply(y)}else if(Pe(y,Rs)){if(this._shell.apply(y),!y.isDone())for(var H=0;H<this._holes.length&&(this._holes[H].apply(y),!y.isDone());H++);y.isGeometryChanged()&&this.geometryChanged()}else if(Pe(y,mo))y.filter(this);else if(Pe(y,yt)){y.filter(this),this._shell.apply(y);for(var ne=0;ne<this._holes.length;ne++)this._holes[ne].apply(y)}},u.prototype.getBoundary=function(){if(this.isEmpty())return this.getFactory().createMultiLineString();var y=new Array(this._holes.length+1).fill(null);y[0]=this._shell;for(var b=0;b<this._holes.length;b++)y[b+1]=this._holes[b];return y.length<=1?this.getFactory().createLinearRing(y[0].getCoordinateSequence()):this.getFactory().createMultiLineString(y)},u.prototype.clone=function(){var y=o.prototype.clone.call(this);y._shell=this._shell.clone(),y._holes=new Array(this._holes.length).fill(null);for(var b=0;b<this._holes.length;b++)y._holes[b]=this._holes[b].clone();return y},u.prototype.getGeometryType=function(){return"Polygon"},u.prototype.copy=function(){for(var y=this._shell.copy(),b=new Array(this._holes.length).fill(null),H=0;H<b.length;H++)b[H]=this._holes[H].copy();return new u(y,b,this._factory)},u.prototype.getExteriorRing=function(){return this._shell},u.prototype.isEmpty=function(){return this._shell.isEmpty()},u.prototype.getInteriorRingN=function(y){return this._holes[y]},u.prototype.interfaces_=function(){return[gu]},u.prototype.getClass=function(){return u},v.serialVersionUID.get=function(){return-0x307ffefd8dc97200},Object.defineProperties(u,v),u}(Ot),Ru=function(o){function u(){o.apply(this,arguments)}o&&(u.__proto__=o),(u.prototype=Object.create(o&&o.prototype)).constructor=u;var v={serialVersionUID:{configurable:!0}};return u.prototype.getSortIndex=function(){return Ot.SORTINDEX_MULTIPOINT},u.prototype.isValid=function(){return!0},u.prototype.equalsExact=function(){if(arguments.length===2){var y=arguments[0],b=arguments[1];return!!this.isEquivalentClass(y)&&o.prototype.equalsExact.call(this,y,b)}return o.prototype.equalsExact.apply(this,arguments)},u.prototype.getCoordinate=function(){if(arguments.length===1){var y=arguments[0];return this._geometries[y].getCoordinate()}return o.prototype.getCoordinate.apply(this,arguments)},u.prototype.getBoundaryDimension=function(){return ta.FALSE},u.prototype.getDimension=function(){return 0},u.prototype.getBoundary=function(){return this.getFactory().createGeometryCollection(null)},u.prototype.getGeometryType=function(){return"MultiPoint"},u.prototype.copy=function(){for(var y=new Array(this._geometries.length).fill(null),b=0;b<y.length;b++)y[b]=this._geometries[b].copy();return new u(y,this._factory)},u.prototype.interfaces_=function(){return[Cl]},u.prototype.getClass=function(){return u},v.serialVersionUID.get=function(){return-8048474874175356e3},Object.defineProperties(u,v),u}(rs),cr=function(o){function u(y,b){y instanceof Y&&b instanceof Ri&&(y=b.getCoordinateSequenceFactory().create(y)),o.call(this,y,b),this.validateConstruction()}o&&(u.__proto__=o),(u.prototype=Object.create(o&&o.prototype)).constructor=u;var v={MINIMUM_VALID_SIZE:{configurable:!0},serialVersionUID:{configurable:!0}};return u.prototype.getSortIndex=function(){return Ot.SORTINDEX_LINEARRING},u.prototype.getBoundaryDimension=function(){return ta.FALSE},u.prototype.isClosed=function(){return!!this.isEmpty()||o.prototype.isClosed.call(this)},u.prototype.reverse=function(){var y=this._points.copy();return Ba.reverse(y),this.getFactory().createLinearRing(y)},u.prototype.validateConstruction=function(){if(!this.isEmpty()&&!o.prototype.isClosed.call(this))throw new Me("Points of LinearRing do not form a closed linestring");if(this.getCoordinateSequence().size()>=1&&this.getCoordinateSequence().size()<u.MINIMUM_VALID_SIZE)throw new Me("Invalid number of points in LinearRing (found "+this.getCoordinateSequence().size()+" - must be 0 or >= 4)")},u.prototype.getGeometryType=function(){return"LinearRing"},u.prototype.copy=function(){return new u(this._points.copy(),this._factory)},u.prototype.interfaces_=function(){return[]},u.prototype.getClass=function(){return u},v.MINIMUM_VALID_SIZE.get=function(){return 4},v.serialVersionUID.get=function(){return-0x3b229e262367a600},Object.defineProperties(u,v),u}(Oa),yn=function(o){function u(){o.apply(this,arguments)}o&&(u.__proto__=o),(u.prototype=Object.create(o&&o.prototype)).constructor=u;var v={serialVersionUID:{configurable:!0}};return u.prototype.getSortIndex=function(){return Ot.SORTINDEX_MULTIPOLYGON},u.prototype.equalsExact=function(){if(arguments.length===2){var y=arguments[0],b=arguments[1];return!!this.isEquivalentClass(y)&&o.prototype.equalsExact.call(this,y,b)}return o.prototype.equalsExact.apply(this,arguments)},u.prototype.getBoundaryDimension=function(){return 1},u.prototype.getDimension=function(){return 2},u.prototype.reverse=function(){for(var y=this._geometries.length,b=new Array(y).fill(null),H=0;H<this._geometries.length;H++)b[H]=this._geometries[H].reverse();return this.getFactory().createMultiPolygon(b)},u.prototype.getBoundary=function(){if(this.isEmpty())return this.getFactory().createMultiLineString();for(var y=new Wr,b=0;b<this._geometries.length;b++)for(var H=this._geometries[b].getBoundary(),ne=0;ne<H.getNumGeometries();ne++)y.add(H.getGeometryN(ne));var Le=new Array(y.size()).fill(null);return this.getFactory().createMultiLineString(y.toArray(Le))},u.prototype.getGeometryType=function(){return"MultiPolygon"},u.prototype.copy=function(){for(var y=new Array(this._geometries.length).fill(null),b=0;b<y.length;b++)y[b]=this._geometries[b].copy();return new u(y,this._factory)},u.prototype.interfaces_=function(){return[gu]},u.prototype.getClass=function(){return u},v.serialVersionUID.get=function(){return-0x7a5aa1369171980},Object.defineProperties(u,v),u}(rs),bo=function(o){this._factory=o||null,this._isUserDataCopied=!1},mu={NoOpGeometryOperation:{configurable:!0},CoordinateOperation:{configurable:!0},CoordinateSequenceOperation:{configurable:!0}};bo.prototype.setCopyUserData=function(o){this._isUserDataCopied=o},bo.prototype.edit=function(o,u){if(o===null)return null;var v=this.editInternal(o,u);return this._isUserDataCopied&&v.setUserData(o.getUserData()),v},bo.prototype.editInternal=function(o,u){return this._factory===null&&(this._factory=o.getFactory()),o instanceof rs?this.editGeometryCollection(o,u):o instanceof ka?this.editPolygon(o,u):o instanceof Co?u.edit(o,this._factory):o instanceof Oa?u.edit(o,this._factory):(Ft.shouldNeverReachHere("Unsupported Geometry class: "+o.getClass().getName()),null)},bo.prototype.editGeometryCollection=function(o,u){for(var v=u.edit(o,this._factory),y=new Wr,b=0;b<v.getNumGeometries();b++){var H=this.edit(v.getGeometryN(b),u);H===null||H.isEmpty()||y.add(H)}return v.getClass()===Ru?this._factory.createMultiPoint(y.toArray([])):v.getClass()===Qi?this._factory.createMultiLineString(y.toArray([])):v.getClass()===yn?this._factory.createMultiPolygon(y.toArray([])):this._factory.createGeometryCollection(y.toArray([]))},bo.prototype.editPolygon=function(o,u){var v=u.edit(o,this._factory);if(v===null&&(v=this._factory.createPolygon(null)),v.isEmpty())return v;var y=this.edit(v.getExteriorRing(),u);if(y===null||y.isEmpty())return this._factory.createPolygon();for(var b=new Wr,H=0;H<v.getNumInteriorRing();H++){var ne=this.edit(v.getInteriorRingN(H),u);ne===null||ne.isEmpty()||b.add(ne)}return this._factory.createPolygon(y,b.toArray([]))},bo.prototype.interfaces_=function(){return[]},bo.prototype.getClass=function(){return bo},bo.GeometryEditorOperation=function(){},mu.NoOpGeometryOperation.get=function(){return _u},mu.CoordinateOperation.get=function(){return js},mu.CoordinateSequenceOperation.get=function(){return ou},Object.defineProperties(bo,mu);var _u=function(){};_u.prototype.edit=function(o,u){return o},_u.prototype.interfaces_=function(){return[bo.GeometryEditorOperation]},_u.prototype.getClass=function(){return _u};var js=function(){};js.prototype.edit=function(o,u){var v=this.editCoordinates(o.getCoordinates(),o);return v===null?o:o instanceof cr?u.createLinearRing(v):o instanceof Oa?u.createLineString(v):o instanceof Co?v.length>0?u.createPoint(v[0]):u.createPoint():o},js.prototype.interfaces_=function(){return[bo.GeometryEditorOperation]},js.prototype.getClass=function(){return js};var ou=function(){};ou.prototype.edit=function(o,u){return o instanceof cr?u.createLinearRing(this.edit(o.getCoordinateSequence(),o)):o instanceof Oa?u.createLineString(this.edit(o.getCoordinateSequence(),o)):o instanceof Co?u.createPoint(this.edit(o.getCoordinateSequence(),o)):o},ou.prototype.interfaces_=function(){return[bo.GeometryEditorOperation]},ou.prototype.getClass=function(){return ou};var qa=function(){if(this._dimension=3,this._coordinates=null,arguments.length===1){if(arguments[0]instanceof Array)this._coordinates=arguments[0],this._dimension=3;else if(Number.isInteger(arguments[0])){var o=arguments[0];this._coordinates=new Array(o).fill(null);for(var u=0;u<o;u++)this._coordinates[u]=new Y}else if(Pe(arguments[0],Wt)){var v=arguments[0];if(v===null)return this._coordinates=new Array(0).fill(null),null;this._dimension=v.getDimension(),this._coordinates=new Array(v.size()).fill(null);for(var y=0;y<this._coordinates.length;y++)this._coordinates[y]=v.getCoordinateCopy(y)}}else if(arguments.length===2){if(arguments[0]instanceof Array&&Number.isInteger(arguments[1])){var b=arguments[0],H=arguments[1];this._coordinates=b,this._dimension=H,b===null&&(this._coordinates=new Array(0).fill(null))}else if(Number.isInteger(arguments[0])&&Number.isInteger(arguments[1])){var ne=arguments[0],Le=arguments[1];this._coordinates=new Array(ne).fill(null),this._dimension=Le;for(var tt=0;tt<ne;tt++)this._coordinates[tt]=new Y}}},lc={serialVersionUID:{configurable:!0}};qa.prototype.setOrdinate=function(o,u,v){switch(u){case Wt.X:this._coordinates[o].x=v;break;case Wt.Y:this._coordinates[o].y=v;break;case Wt.Z:this._coordinates[o].z=v;break;default:throw new Me("invalid ordinateIndex")}},qa.prototype.size=function(){return this._coordinates.length},qa.prototype.getOrdinate=function(o,u){switch(u){case Wt.X:return this._coordinates[o].x;case Wt.Y:return this._coordinates[o].y;case Wt.Z:return this._coordinates[o].z}return ce.NaN},qa.prototype.getCoordinate=function(){if(arguments.length===1){var o=arguments[0];return this._coordinates[o]}if(arguments.length===2){var u=arguments[0],v=arguments[1];v.x=this._coordinates[u].x,v.y=this._coordinates[u].y,v.z=this._coordinates[u].z}},qa.prototype.getCoordinateCopy=function(o){return new Y(this._coordinates[o])},qa.prototype.getDimension=function(){return this._dimension},qa.prototype.getX=function(o){return this._coordinates[o].x},qa.prototype.clone=function(){for(var o=new Array(this.size()).fill(null),u=0;u<this._coordinates.length;u++)o[u]=this._coordinates[u].clone();return new qa(o,this._dimension)},qa.prototype.expandEnvelope=function(o){for(var u=0;u<this._coordinates.length;u++)o.expandToInclude(this._coordinates[u]);return o},qa.prototype.copy=function(){for(var o=new Array(this.size()).fill(null),u=0;u<this._coordinates.length;u++)o[u]=this._coordinates[u].copy();return new qa(o,this._dimension)},qa.prototype.toString=function(){if(this._coordinates.length>0){var o=new ue(17*this._coordinates.length);o.append("("),o.append(this._coordinates[0]);for(var u=1;u<this._coordinates.length;u++)o.append(", "),o.append(this._coordinates[u]);return o.append(")"),o.toString()}return"()"},qa.prototype.getY=function(o){return this._coordinates[o].y},qa.prototype.toCoordinateArray=function(){return this._coordinates},qa.prototype.interfaces_=function(){return[Wt,I]},qa.prototype.getClass=function(){return qa},lc.serialVersionUID.get=function(){return-0xcb44a778db18e00},Object.defineProperties(qa,lc);var Ls=function(){},su={serialVersionUID:{configurable:!0},instanceObject:{configurable:!0}};Ls.prototype.readResolve=function(){return Ls.instance()},Ls.prototype.create=function(){if(arguments.length===1){if(arguments[0]instanceof Array){var o=arguments[0];return new qa(o)}if(Pe(arguments[0],Wt)){var u=arguments[0];return new qa(u)}}else if(arguments.length===2){var v=arguments[0],y=arguments[1];return y>3&&(y=3),y<2?new qa(v):new qa(v,y)}},Ls.prototype.interfaces_=function(){return[xe,I]},Ls.prototype.getClass=function(){return Ls},Ls.instance=function(){return Ls.instanceObject},su.serialVersionUID.get=function(){return-0x38e49fa6cf6f2e00},su.instanceObject.get=function(){return new Ls},Object.defineProperties(Ls,su);var Nc=function(o){function u(){o.call(this),this.map_=new Map}return o&&(u.__proto__=o),u.prototype=Object.create(o&&o.prototype),u.prototype.constructor=u,u.prototype.get=function(v){return this.map_.get(v)||null},u.prototype.put=function(v,y){return this.map_.set(v,y),y},u.prototype.values=function(){for(var v=new Wr,y=this.map_.values(),b=y.next();!b.done;)v.add(b.value),b=y.next();return v},u.prototype.entrySet=function(){var v=new ku;return this.map_.entries().forEach(function(y){return v.add(y)}),v},u.prototype.size=function(){return this.map_.size()},u}(ts),Oi=function o(){if(this._modelType=null,this._scale=null,arguments.length===0)this._modelType=o.FLOATING;else if(arguments.length===1){if(arguments[0]instanceof Fs){var u=arguments[0];this._modelType=u,u===o.FIXED&&this.setScale(1)}else if(typeof arguments[0]=="number"){var v=arguments[0];this._modelType=o.FIXED,this.setScale(v)}else if(arguments[0]instanceof o){var y=arguments[0];this._modelType=y._modelType,this._scale=y._scale}}},bl={serialVersionUID:{configurable:!0},maximumPreciseValue:{configurable:!0}};Oi.prototype.equals=function(o){if(!(o instanceof Oi))return!1;var u=o;return this._modelType===u._modelType&&this._scale===u._scale},Oi.prototype.compareTo=function(o){var u=o,v=this.getMaximumSignificantDigits(),y=u.getMaximumSignificantDigits();return new ke(v).compareTo(new ke(y))},Oi.prototype.getScale=function(){return this._scale},Oi.prototype.isFloating=function(){return this._modelType===Oi.FLOATING||this._modelType===Oi.FLOATING_SINGLE},Oi.prototype.getType=function(){return this._modelType},Oi.prototype.toString=function(){var o="UNKNOWN";return this._modelType===Oi.FLOATING?o="Floating":this._modelType===Oi.FLOATING_SINGLE?o="Floating-Single":this._modelType===Oi.FIXED&&(o="Fixed (Scale="+this.getScale()+")"),o},Oi.prototype.makePrecise=function(){if(typeof arguments[0]=="number"){var o=arguments[0];return ce.isNaN(o)||this._modelType===Oi.FLOATING_SINGLE?o:this._modelType===Oi.FIXED?Math.round(o*this._scale)/this._scale:o}if(arguments[0]instanceof Y){var u=arguments[0];if(this._modelType===Oi.FLOATING)return null;u.x=this.makePrecise(u.x),u.y=this.makePrecise(u.y)}},Oi.prototype.getMaximumSignificantDigits=function(){var o=16;return this._modelType===Oi.FLOATING?o=16:this._modelType===Oi.FLOATING_SINGLE?o=6:this._modelType===Oi.FIXED&&(o=1+Math.trunc(Math.ceil(Math.log(this.getScale())/Math.log(10)))),o},Oi.prototype.setScale=function(o){this._scale=Math.abs(o)},Oi.prototype.interfaces_=function(){return[I,Ee]},Oi.prototype.getClass=function(){return Oi},Oi.mostPrecise=function(o,u){return o.compareTo(u)>=0?o:u},bl.serialVersionUID.get=function(){return 7777263578777804e3},bl.maximumPreciseValue.get=function(){return 9007199254740992},Object.defineProperties(Oi,bl);var Fs=function o(u){this._name=u||null,o.nameToTypeMap.put(u,this)},Hl={serialVersionUID:{configurable:!0},nameToTypeMap:{configurable:!0}};Fs.prototype.readResolve=function(){return Fs.nameToTypeMap.get(this._name)},Fs.prototype.toString=function(){return this._name},Fs.prototype.interfaces_=function(){return[I]},Fs.prototype.getClass=function(){return Fs},Hl.serialVersionUID.get=function(){return-552860263173159e4},Hl.nameToTypeMap.get=function(){return new Nc},Object.defineProperties(Fs,Hl),Oi.Type=Fs,Oi.FIXED=new Fs("FIXED"),Oi.FLOATING=new Fs("FLOATING"),Oi.FLOATING_SINGLE=new Fs("FLOATING SINGLE");var Ri=function o(){this._precisionModel=new Oi,this._SRID=0,this._coordinateSequenceFactory=o.getDefaultCoordinateSequenceFactory(),arguments.length===0||(arguments.length===1?Pe(arguments[0],xe)?this._coordinateSequenceFactory=arguments[0]:arguments[0]instanceof Oi&&(this._precisionModel=arguments[0]):arguments.length===2?(this._precisionModel=arguments[0],this._SRID=arguments[1]):arguments.length===3&&(this._precisionModel=arguments[0],this._SRID=arguments[1],this._coordinateSequenceFactory=arguments[2]))},Rl={serialVersionUID:{configurable:!0}};Ri.prototype.toGeometry=function(o){return o.isNull()?this.createPoint(null):o.getMinX()===o.getMaxX()&&o.getMinY()===o.getMaxY()?this.createPoint(new Y(o.getMinX(),o.getMinY())):o.getMinX()===o.getMaxX()||o.getMinY()===o.getMaxY()?this.createLineString([new Y(o.getMinX(),o.getMinY()),new Y(o.getMaxX(),o.getMaxY())]):this.createPolygon(this.createLinearRing([new Y(o.getMinX(),o.getMinY()),new Y(o.getMinX(),o.getMaxY()),new Y(o.getMaxX(),o.getMaxY()),new Y(o.getMaxX(),o.getMinY()),new Y(o.getMinX(),o.getMinY())]),null)},Ri.prototype.createLineString=function(o){return o?o instanceof Array?new Oa(this.getCoordinateSequenceFactory().create(o),this):Pe(o,Wt)?new Oa(o,this):void 0:new Oa(this.getCoordinateSequenceFactory().create([]),this)},Ri.prototype.createMultiLineString=function(){if(arguments.length===0)return new Qi(null,this);if(arguments.length===1){var o=arguments[0];return new Qi(o,this)}},Ri.prototype.buildGeometry=function(o){for(var u=null,v=!1,y=!1,b=o.iterator();b.hasNext();){var H=b.next(),ne=H.getClass();u===null&&(u=ne),ne!==u&&(v=!0),H.isGeometryCollectionOrDerived()&&(y=!0)}if(u===null)return this.createGeometryCollection();if(v||y)return this.createGeometryCollection(Ri.toGeometryArray(o));var Le=o.iterator().next();if(o.size()>1){if(Le instanceof ka)return this.createMultiPolygon(Ri.toPolygonArray(o));if(Le instanceof Oa)return this.createMultiLineString(Ri.toLineStringArray(o));if(Le instanceof Co)return this.createMultiPoint(Ri.toPointArray(o));Ft.shouldNeverReachHere("Unhandled class: "+Le.getClass().getName())}return Le},Ri.prototype.createMultiPointFromCoords=function(o){return this.createMultiPoint(o!==null?this.getCoordinateSequenceFactory().create(o):null)},Ri.prototype.createPoint=function(){if(arguments.length===0)return this.createPoint(this.getCoordinateSequenceFactory().create([]));if(arguments.length===1){if(arguments[0]instanceof Y){var o=arguments[0];return this.createPoint(o!==null?this.getCoordinateSequenceFactory().create([o]):null)}if(Pe(arguments[0],Wt)){var u=arguments[0];return new Co(u,this)}}},Ri.prototype.getCoordinateSequenceFactory=function(){return this._coordinateSequenceFactory},Ri.prototype.createPolygon=function(){if(arguments.length===0)return new ka(null,null,this);if(arguments.length===1){if(Pe(arguments[0],Wt)){var o=arguments[0];return this.createPolygon(this.createLinearRing(o))}if(arguments[0]instanceof Array){var u=arguments[0];return this.createPolygon(this.createLinearRing(u))}if(arguments[0]instanceof cr){var v=arguments[0];return this.createPolygon(v,null)}}else if(arguments.length===2){var y=arguments[0],b=arguments[1];return new ka(y,b,this)}},Ri.prototype.getSRID=function(){return this._SRID},Ri.prototype.createGeometryCollection=function(){if(arguments.length===0)return new rs(null,this);if(arguments.length===1){var o=arguments[0];return new rs(o,this)}},Ri.prototype.createGeometry=function(o){return new bo(this).edit(o,{edit:function(){if(arguments.length===2){var u=arguments[0];return this._coordinateSequenceFactory.create(u)}}})},Ri.prototype.getPrecisionModel=function(){return this._precisionModel},Ri.prototype.createLinearRing=function(){if(arguments.length===0)return this.createLinearRing(this.getCoordinateSequenceFactory().create([]));if(arguments.length===1){if(arguments[0]instanceof Array){var o=arguments[0];return this.createLinearRing(o!==null?this.getCoordinateSequenceFactory().create(o):null)}if(Pe(arguments[0],Wt)){var u=arguments[0];return new cr(u,this)}}},Ri.prototype.createMultiPolygon=function(){if(arguments.length===0)return new yn(null,this);if(arguments.length===1){var o=arguments[0];return new yn(o,this)}},Ri.prototype.createMultiPoint=function(){if(arguments.length===0)return new Ru(null,this);if(arguments.length===1){if(arguments[0]instanceof Array){var o=arguments[0];return new Ru(o,this)}if(arguments[0]instanceof Array){var u=arguments[0];return this.createMultiPoint(u!==null?this.getCoordinateSequenceFactory().create(u):null)}if(Pe(arguments[0],Wt)){var v=arguments[0];if(v===null)return this.createMultiPoint(new Array(0).fill(null));for(var y=new Array(v.size()).fill(null),b=0;b<v.size();b++){var H=this.getCoordinateSequenceFactory().create(1,v.getDimension());Ba.copy(v,b,H,0,1),y[b]=this.createPoint(H)}return this.createMultiPoint(y)}}},Ri.prototype.interfaces_=function(){return[I]},Ri.prototype.getClass=function(){return Ri},Ri.toMultiPolygonArray=function(o){var u=new Array(o.size()).fill(null);return o.toArray(u)},Ri.toGeometryArray=function(o){if(o===null)return null;var u=new Array(o.size()).fill(null);return o.toArray(u)},Ri.getDefaultCoordinateSequenceFactory=function(){return Ls.instance()},Ri.toMultiLineStringArray=function(o){var u=new Array(o.size()).fill(null);return o.toArray(u)},Ri.toLineStringArray=function(o){var u=new Array(o.size()).fill(null);return o.toArray(u)},Ri.toMultiPointArray=function(o){var u=new Array(o.size()).fill(null);return o.toArray(u)},Ri.toLinearRingArray=function(o){var u=new Array(o.size()).fill(null);return o.toArray(u)},Ri.toPointArray=function(o){var u=new Array(o.size()).fill(null);return o.toArray(u)},Ri.toPolygonArray=function(o){var u=new Array(o.size()).fill(null);return o.toArray(u)},Ri.createPointFromInternalCoord=function(o,u){return u.getPrecisionModel().makePrecise(o),u.getFactory().createPoint(o)},Rl.serialVersionUID.get=function(){return-6820524753094096e3},Object.defineProperties(Ri,Rl);var Yf=["Point","MultiPoint","LineString","MultiLineString","Polygon","MultiPolygon"],al=function(o){this.geometryFactory=o||new Ri};al.prototype.read=function(o){var u,v=(u=typeof o=="string"?JSON.parse(o):o).type;if(!Ka[v])throw new Error("Unknown GeoJSON type: "+u.type);return Yf.indexOf(v)!==-1?Ka[v].apply(this,[u.coordinates]):v==="GeometryCollection"?Ka[v].apply(this,[u.geometries]):Ka[v].apply(this,[u])},al.prototype.write=function(o){var u=o.getGeometryType();if(!bt[u])throw new Error("Geometry is not supported");return bt[u].apply(this,[o])};var Ka={Feature:function(o){var u={};for(var v in o)u[v]=o[v];if(o.geometry){var y=o.geometry.type;if(!Ka[y])throw new Error("Unknown GeoJSON type: "+o.type);u.geometry=this.read(o.geometry)}return o.bbox&&(u.bbox=Ka.bbox.apply(this,[o.bbox])),u},FeatureCollection:function(o){var u={};if(o.features){u.features=[];for(var v=0;v<o.features.length;++v)u.features.push(this.read(o.features[v]))}return o.bbox&&(u.bbox=this.parse.bbox.apply(this,[o.bbox])),u},coordinates:function(o){for(var u=[],v=0;v<o.length;++v){var y=o[v];u.push(new Y(y[0],y[1]))}return u},bbox:function(o){return this.geometryFactory.createLinearRing([new Y(o[0],o[1]),new Y(o[2],o[1]),new Y(o[2],o[3]),new Y(o[0],o[3]),new Y(o[0],o[1])])},Point:function(o){var u=new Y(o[0],o[1]);return this.geometryFactory.createPoint(u)},MultiPoint:function(o){for(var u=[],v=0;v<o.length;++v)u.push(Ka.Point.apply(this,[o[v]]));return this.geometryFactory.createMultiPoint(u)},LineString:function(o){var u=Ka.coordinates.apply(this,[o]);return this.geometryFactory.createLineString(u)},MultiLineString:function(o){for(var u=[],v=0;v<o.length;++v)u.push(Ka.LineString.apply(this,[o[v]]));return this.geometryFactory.createMultiLineString(u)},Polygon:function(o){for(var u=Ka.coordinates.apply(this,[o[0]]),v=this.geometryFactory.createLinearRing(u),y=[],b=1;b<o.length;++b){var H=o[b],ne=Ka.coordinates.apply(this,[H]),Le=this.geometryFactory.createLinearRing(ne);y.push(Le)}return this.geometryFactory.createPolygon(v,y)},MultiPolygon:function(o){for(var u=[],v=0;v<o.length;++v){var y=o[v];u.push(Ka.Polygon.apply(this,[y]))}return this.geometryFactory.createMultiPolygon(u)},GeometryCollection:function(o){for(var u=[],v=0;v<o.length;++v){var y=o[v];u.push(this.read(y))}return this.geometryFactory.createGeometryCollection(u)}},bt={coordinate:function(o){return[o.x,o.y]},Point:function(o){return{type:"Point",coordinates:bt.coordinate.apply(this,[o.getCoordinate()])}},MultiPoint:function(o){for(var u=[],v=0;v<o._geometries.length;++v){var y=o._geometries[v],b=bt.Point.apply(this,[y]);u.push(b.coordinates)}return{type:"MultiPoint",coordinates:u}},LineString:function(o){for(var u=[],v=o.getCoordinates(),y=0;y<v.length;++y){var b=v[y];u.push(bt.coordinate.apply(this,[b]))}return{type:"LineString",coordinates:u}},MultiLineString:function(o){for(var u=[],v=0;v<o._geometries.length;++v){var y=o._geometries[v],b=bt.LineString.apply(this,[y]);u.push(b.coordinates)}return{type:"MultiLineString",coordinates:u}},Polygon:function(o){var u=[],v=bt.LineString.apply(this,[o._shell]);u.push(v.coordinates);for(var y=0;y<o._holes.length;++y){var b=o._holes[y],H=bt.LineString.apply(this,[b]);u.push(H.coordinates)}return{type:"Polygon",coordinates:u}},MultiPolygon:function(o){for(var u=[],v=0;v<o._geometries.length;++v){var y=o._geometries[v],b=bt.Polygon.apply(this,[y]);u.push(b.coordinates)}return{type:"MultiPolygon",coordinates:u}},GeometryCollection:function(o){for(var u=[],v=0;v<o._geometries.length;++v){var y=o._geometries[v],b=y.getGeometryType();u.push(bt[b].apply(this,[y]))}return{type:"GeometryCollection",geometries:u}}},Ye=function(o){this.geometryFactory=o||new Ri,this.precisionModel=this.geometryFactory.getPrecisionModel(),this.parser=new al(this.geometryFactory)};Ye.prototype.read=function(o){var u=this.parser.read(o);return this.precisionModel.getType()===Oi.FIXED&&this.reducePrecision(u),u},Ye.prototype.reducePrecision=function(o){var u,v;if(o.coordinate)this.precisionModel.makePrecise(o.coordinate);else if(o.points)for(u=0,v=o.points.length;u<v;u++)this.precisionModel.makePrecise(o.points[u]);else if(o.geometries)for(u=0,v=o.geometries.length;u<v;u++)this.reducePrecision(o.geometries[u])};var qt=function(){this.parser=new al(this.geometryFactory)};qt.prototype.write=function(o){return this.parser.write(o)};var fe=function(){},Ue={ON:{configurable:!0},LEFT:{configurable:!0},RIGHT:{configurable:!0}};fe.prototype.interfaces_=function(){return[]},fe.prototype.getClass=function(){return fe},fe.opposite=function(o){return o===fe.LEFT?fe.RIGHT:o===fe.RIGHT?fe.LEFT:o},Ue.ON.get=function(){return 0},Ue.LEFT.get=function(){return 1},Ue.RIGHT.get=function(){return 2},Object.defineProperties(fe,Ue),(De.prototype=new Error).name="EmptyStackException",(Ge.prototype=new ja).add=function(o){return this.array_.push(o),!0},Ge.prototype.get=function(o){if(o<0||o>=this.size())throw new Error;return this.array_[o]},Ge.prototype.push=function(o){return this.array_.push(o),o},Ge.prototype.pop=function(o){if(this.array_.length===0)throw new De;return this.array_.pop()},Ge.prototype.peek=function(){if(this.array_.length===0)throw new De;return this.array_[this.array_.length-1]},Ge.prototype.empty=function(){return this.array_.length===0},Ge.prototype.isEmpty=function(){return this.empty()},Ge.prototype.search=function(o){return this.array_.indexOf(o)},Ge.prototype.size=function(){return this.array_.length},Ge.prototype.toArray=function(){for(var o=[],u=0,v=this.array_.length;u<v;u++)o.push(this.array_[u]);return o};var Ke=function(){this._minIndex=-1,this._minCoord=null,this._minDe=null,this._orientedDe=null};Ke.prototype.getCoordinate=function(){return this._minCoord},Ke.prototype.getRightmostSide=function(o,u){var v=this.getRightmostSideOfSegment(o,u);return v<0&&(v=this.getRightmostSideOfSegment(o,u-1)),v<0&&(this._minCoord=null,this.checkForRightmostCoordinate(o)),v},Ke.prototype.findRightmostEdgeAtVertex=function(){var o=this._minDe.getEdge().getCoordinates();Ft.isTrue(this._minIndex>0&&this._minIndex<o.length,"rightmost point expected to be interior vertex of edge");var u=o[this._minIndex-1],v=o[this._minIndex+1],y=Pt.computeOrientation(this._minCoord,v,u),b=!1;(u.y<this._minCoord.y&&v.y<this._minCoord.y&&y===Pt.COUNTERCLOCKWISE||u.y>this._minCoord.y&&v.y>this._minCoord.y&&y===Pt.CLOCKWISE)&&(b=!0),b&&(this._minIndex=this._minIndex-1)},Ke.prototype.getRightmostSideOfSegment=function(o,u){var v=o.getEdge().getCoordinates();if(u<0||u+1>=v.length||v[u].y===v[u+1].y)return-1;var y=fe.LEFT;return v[u].y<v[u+1].y&&(y=fe.RIGHT),y},Ke.prototype.getEdge=function(){return this._orientedDe},Ke.prototype.checkForRightmostCoordinate=function(o){for(var u=o.getEdge().getCoordinates(),v=0;v<u.length-1;v++)(this._minCoord===null||u[v].x>this._minCoord.x)&&(this._minDe=o,this._minIndex=v,this._minCoord=u[v])},Ke.prototype.findRightmostEdgeAtNode=function(){var o=this._minDe.getNode().getEdges();this._minDe=o.getRightmostEdge(),this._minDe.isForward()||(this._minDe=this._minDe.getSym(),this._minIndex=this._minDe.getEdge().getCoordinates().length-1)},Ke.prototype.findEdge=function(o){for(var u=o.iterator();u.hasNext();){var v=u.next();v.isForward()&&this.checkForRightmostCoordinate(v)}Ft.isTrue(this._minIndex!==0||this._minCoord.equals(this._minDe.getCoordinate()),"inconsistency in rightmost processing"),this._minIndex===0?this.findRightmostEdgeAtNode():this.findRightmostEdgeAtVertex(),this._orientedDe=this._minDe,this.getRightmostSide(this._minDe,this._minIndex)===fe.LEFT&&(this._orientedDe=this._minDe.getSym())},Ke.prototype.interfaces_=function(){return[]},Ke.prototype.getClass=function(){return Ke};var Ht=function(o){function u(v,y){o.call(this,u.msgWithCoord(v,y)),this.pt=y?new Y(y):null,this.name="TopologyException"}return o&&(u.__proto__=o),u.prototype=Object.create(o&&o.prototype),u.prototype.constructor=u,u.prototype.getCoordinate=function(){return this.pt},u.prototype.interfaces_=function(){return[]},u.prototype.getClass=function(){return u},u.msgWithCoord=function(v,y){return y?v:v+" [ "+y+" ]"},u}($i),vr=function(){this.array_=[]};vr.prototype.addLast=function(o){this.array_.push(o)},vr.prototype.removeFirst=function(){return this.array_.shift()},vr.prototype.isEmpty=function(){return this.array_.length===0};var Nr=function(){this._finder=null,this._dirEdgeList=new Wr,this._nodes=new Wr,this._rightMostCoord=null,this._env=null,this._finder=new Ke};Nr.prototype.clearVisitedEdges=function(){for(var o=this._dirEdgeList.iterator();o.hasNext();)o.next().setVisited(!1)},Nr.prototype.getRightmostCoordinate=function(){return this._rightMostCoord},Nr.prototype.computeNodeDepth=function(o){for(var u=null,v=o.getEdges().iterator();v.hasNext();){var y=v.next();if(y.isVisited()||y.getSym().isVisited()){u=y;break}}if(u===null)throw new Ht("unable to find edge to compute depths at "+o.getCoordinate());o.getEdges().computeDepths(u);for(var b=o.getEdges().iterator();b.hasNext();){var H=b.next();H.setVisited(!0),this.copySymDepths(H)}},Nr.prototype.computeDepth=function(o){this.clearVisitedEdges();var u=this._finder.getEdge();u.setEdgeDepths(fe.RIGHT,o),this.copySymDepths(u),this.computeDepths(u)},Nr.prototype.create=function(o){this.addReachable(o),this._finder.findEdge(this._dirEdgeList),this._rightMostCoord=this._finder.getCoordinate()},Nr.prototype.findResultEdges=function(){for(var o=this._dirEdgeList.iterator();o.hasNext();){var u=o.next();u.getDepth(fe.RIGHT)>=1&&u.getDepth(fe.LEFT)<=0&&!u.isInteriorAreaEdge()&&u.setInResult(!0)}},Nr.prototype.computeDepths=function(o){var u=new ku,v=new vr,y=o.getNode();for(v.addLast(y),u.add(y),o.setVisited(!0);!v.isEmpty();){var b=v.removeFirst();u.add(b),this.computeNodeDepth(b);for(var H=b.getEdges().iterator();H.hasNext();){var ne=H.next().getSym();if(!ne.isVisited()){var Le=ne.getNode();u.contains(Le)||(v.addLast(Le),u.add(Le))}}}},Nr.prototype.compareTo=function(o){var u=o;return this._rightMostCoord.x<u._rightMostCoord.x?-1:this._rightMostCoord.x>u._rightMostCoord.x?1:0},Nr.prototype.getEnvelope=function(){if(this._env===null){for(var o=new Mr,u=this._dirEdgeList.iterator();u.hasNext();)for(var v=u.next().getEdge().getCoordinates(),y=0;y<v.length-1;y++)o.expandToInclude(v[y]);this._env=o}return this._env},Nr.prototype.addReachable=function(o){var u=new Ge;for(u.add(o);!u.empty();){var v=u.pop();this.add(v,u)}},Nr.prototype.copySymDepths=function(o){var u=o.getSym();u.setDepth(fe.LEFT,o.getDepth(fe.RIGHT)),u.setDepth(fe.RIGHT,o.getDepth(fe.LEFT))},Nr.prototype.add=function(o,u){o.setVisited(!0),this._nodes.add(o);for(var v=o.getEdges().iterator();v.hasNext();){var y=v.next();this._dirEdgeList.add(y);var b=y.getSym().getNode();b.isVisited()||u.push(b)}},Nr.prototype.getNodes=function(){return this._nodes},Nr.prototype.getDirectedEdges=function(){return this._dirEdgeList},Nr.prototype.interfaces_=function(){return[Ee]},Nr.prototype.getClass=function(){return Nr};var mn=function o(){if(this.location=null,arguments.length===1){if(arguments[0]instanceof Array){var u=arguments[0];this.init(u.length)}else if(Number.isInteger(arguments[0])){var v=arguments[0];this.init(1),this.location[fe.ON]=v}else if(arguments[0]instanceof o){var y=arguments[0];if(this.init(y.location.length),y!==null)for(var b=0;b<this.location.length;b++)this.location[b]=y.location[b]}}else if(arguments.length===3){var H=arguments[0],ne=arguments[1],Le=arguments[2];this.init(3),this.location[fe.ON]=H,this.location[fe.LEFT]=ne,this.location[fe.RIGHT]=Le}};mn.prototype.setAllLocations=function(o){for(var u=0;u<this.location.length;u++)this.location[u]=o},mn.prototype.isNull=function(){for(var o=0;o<this.location.length;o++)if(this.location[o]!==ye.NONE)return!1;return!0},mn.prototype.setAllLocationsIfNull=function(o){for(var u=0;u<this.location.length;u++)this.location[u]===ye.NONE&&(this.location[u]=o)},mn.prototype.isLine=function(){return this.location.length===1},mn.prototype.merge=function(o){if(o.location.length>this.location.length){var u=new Array(3).fill(null);u[fe.ON]=this.location[fe.ON],u[fe.LEFT]=ye.NONE,u[fe.RIGHT]=ye.NONE,this.location=u}for(var v=0;v<this.location.length;v++)this.location[v]===ye.NONE&&v<o.location.length&&(this.location[v]=o.location[v])},mn.prototype.getLocations=function(){return this.location},mn.prototype.flip=function(){if(this.location.length<=1)return null;var o=this.location[fe.LEFT];this.location[fe.LEFT]=this.location[fe.RIGHT],this.location[fe.RIGHT]=o},mn.prototype.toString=function(){var o=new ue;return this.location.length>1&&o.append(ye.toLocationSymbol(this.location[fe.LEFT])),o.append(ye.toLocationSymbol(this.location[fe.ON])),this.location.length>1&&o.append(ye.toLocationSymbol(this.location[fe.RIGHT])),o.toString()},mn.prototype.setLocations=function(o,u,v){this.location[fe.ON]=o,this.location[fe.LEFT]=u,this.location[fe.RIGHT]=v},mn.prototype.get=function(o){return o<this.location.length?this.location[o]:ye.NONE},mn.prototype.isArea=function(){return this.location.length>1},mn.prototype.isAnyNull=function(){for(var o=0;o<this.location.length;o++)if(this.location[o]===ye.NONE)return!0;return!1},mn.prototype.setLocation=function(){if(arguments.length===1){var o=arguments[0];this.setLocation(fe.ON,o)}else if(arguments.length===2){var u=arguments[0],v=arguments[1];this.location[u]=v}},mn.prototype.init=function(o){this.location=new Array(o).fill(null),this.setAllLocations(ye.NONE)},mn.prototype.isEqualOnSide=function(o,u){return this.location[u]===o.location[u]},mn.prototype.allPositionsEqual=function(o){for(var u=0;u<this.location.length;u++)if(this.location[u]!==o)return!1;return!0},mn.prototype.interfaces_=function(){return[]},mn.prototype.getClass=function(){return mn};var zn=function o(){if(this.elt=new Array(2).fill(null),arguments.length===1){if(Number.isInteger(arguments[0])){var u=arguments[0];this.elt[0]=new mn(u),this.elt[1]=new mn(u)}else if(arguments[0]instanceof o){var v=arguments[0];this.elt[0]=new mn(v.elt[0]),this.elt[1]=new mn(v.elt[1])}}else if(arguments.length===2){var y=arguments[0],b=arguments[1];this.elt[0]=new mn(ye.NONE),this.elt[1]=new mn(ye.NONE),this.elt[y].setLocation(b)}else if(arguments.length===3){var H=arguments[0],ne=arguments[1],Le=arguments[2];this.elt[0]=new mn(H,ne,Le),this.elt[1]=new mn(H,ne,Le)}else if(arguments.length===4){var tt=arguments[0],Nt=arguments[1],ar=arguments[2],st=arguments[3];this.elt[0]=new mn(ye.NONE,ye.NONE,ye.NONE),this.elt[1]=new mn(ye.NONE,ye.NONE,ye.NONE),this.elt[tt].setLocations(Nt,ar,st)}};zn.prototype.getGeometryCount=function(){var o=0;return this.elt[0].isNull()||o++,this.elt[1].isNull()||o++,o},zn.prototype.setAllLocations=function(o,u){this.elt[o].setAllLocations(u)},zn.prototype.isNull=function(o){return this.elt[o].isNull()},zn.prototype.setAllLocationsIfNull=function(){if(arguments.length===1){var o=arguments[0];this.setAllLocationsIfNull(0,o),this.setAllLocationsIfNull(1,o)}else if(arguments.length===2){var u=arguments[0],v=arguments[1];this.elt[u].setAllLocationsIfNull(v)}},zn.prototype.isLine=function(o){return this.elt[o].isLine()},zn.prototype.merge=function(o){for(var u=0;u<2;u++)this.elt[u]===null&&o.elt[u]!==null?this.elt[u]=new mn(o.elt[u]):this.elt[u].merge(o.elt[u])},zn.prototype.flip=function(){this.elt[0].flip(),this.elt[1].flip()},zn.prototype.getLocation=function(){if(arguments.length===1){var o=arguments[0];return this.elt[o].get(fe.ON)}if(arguments.length===2){var u=arguments[0],v=arguments[1];return this.elt[u].get(v)}},zn.prototype.toString=function(){var o=new ue;return this.elt[0]!==null&&(o.append("A:"),o.append(this.elt[0].toString())),this.elt[1]!==null&&(o.append(" B:"),o.append(this.elt[1].toString())),o.toString()},zn.prototype.isArea=function(){if(arguments.length===0)return this.elt[0].isArea()||this.elt[1].isArea();if(arguments.length===1){var o=arguments[0];return this.elt[o].isArea()}},zn.prototype.isAnyNull=function(o){return this.elt[o].isAnyNull()},zn.prototype.setLocation=function(){if(arguments.length===2){var o=arguments[0],u=arguments[1];this.elt[o].setLocation(fe.ON,u)}else if(arguments.length===3){var v=arguments[0],y=arguments[1],b=arguments[2];this.elt[v].setLocation(y,b)}},zn.prototype.isEqualOnSide=function(o,u){return this.elt[0].isEqualOnSide(o.elt[0],u)&&this.elt[1].isEqualOnSide(o.elt[1],u)},zn.prototype.allPositionsEqual=function(o,u){return this.elt[o].allPositionsEqual(u)},zn.prototype.toLine=function(o){this.elt[o].isArea()&&(this.elt[o]=new mn(this.elt[o].location[0]))},zn.prototype.interfaces_=function(){return[]},zn.prototype.getClass=function(){return zn},zn.toLineLabel=function(o){for(var u=new zn(ye.NONE),v=0;v<2;v++)u.setLocation(v,o.getLocation(v));return u};var Mi=function(){this._startDe=null,this._maxNodeDegree=-1,this._edges=new Wr,this._pts=new Wr,this._label=new zn(ye.NONE),this._ring=null,this._isHole=null,this._shell=null,this._holes=new Wr,this._geometryFactory=null;var o=arguments[0],u=arguments[1];this._geometryFactory=u,this.computePoints(o),this.computeRing()};Mi.prototype.computeRing=function(){if(this._ring!==null)return null;for(var o=new Array(this._pts.size()).fill(null),u=0;u<this._pts.size();u++)o[u]=this._pts.get(u);this._ring=this._geometryFactory.createLinearRing(o),this._isHole=Pt.isCCW(this._ring.getCoordinates())},Mi.prototype.isIsolated=function(){return this._label.getGeometryCount()===1},Mi.prototype.computePoints=function(o){this._startDe=o;var u=o,v=!0;do{if(u===null)throw new Ht("Found null DirectedEdge");if(u.getEdgeRing()===this)throw new Ht("Directed Edge visited twice during ring-building at "+u.getCoordinate());this._edges.add(u);var y=u.getLabel();Ft.isTrue(y.isArea()),this.mergeLabel(y),this.addPoints(u.getEdge(),u.isForward(),v),v=!1,this.setEdgeRing(u,this),u=this.getNext(u)}while(u!==this._startDe)},Mi.prototype.getLinearRing=function(){return this._ring},Mi.prototype.getCoordinate=function(o){return this._pts.get(o)},Mi.prototype.computeMaxNodeDegree=function(){this._maxNodeDegree=0;var o=this._startDe;do{var u=o.getNode().getEdges().getOutgoingDegree(this);u>this._maxNodeDegree&&(this._maxNodeDegree=u),o=this.getNext(o)}while(o!==this._startDe);this._maxNodeDegree*=2},Mi.prototype.addPoints=function(o,u,v){var y=o.getCoordinates();if(u){var b=1;v&&(b=0);for(var H=b;H<y.length;H++)this._pts.add(y[H])}else{var ne=y.length-2;v&&(ne=y.length-1);for(var Le=ne;Le>=0;Le--)this._pts.add(y[Le])}},Mi.prototype.isHole=function(){return this._isHole},Mi.prototype.setInResult=function(){var o=this._startDe;do o.getEdge().setInResult(!0),o=o.getNext();while(o!==this._startDe)},Mi.prototype.containsPoint=function(o){var u=this.getLinearRing();if(!u.getEnvelopeInternal().contains(o)||!Pt.isPointInRing(o,u.getCoordinates()))return!1;for(var v=this._holes.iterator();v.hasNext();)if(v.next().containsPoint(o))return!1;return!0},Mi.prototype.addHole=function(o){this._holes.add(o)},Mi.prototype.isShell=function(){return this._shell===null},Mi.prototype.getLabel=function(){return this._label},Mi.prototype.getEdges=function(){return this._edges},Mi.prototype.getMaxNodeDegree=function(){return this._maxNodeDegree<0&&this.computeMaxNodeDegree(),this._maxNodeDegree},Mi.prototype.getShell=function(){return this._shell},Mi.prototype.mergeLabel=function(){if(arguments.length===1){var o=arguments[0];this.mergeLabel(o,0),this.mergeLabel(o,1)}else if(arguments.length===2){var u=arguments[0],v=arguments[1],y=u.getLocation(v,fe.RIGHT);if(y===ye.NONE)return null;if(this._label.getLocation(v)===ye.NONE)return this._label.setLocation(v,y),null}},Mi.prototype.setShell=function(o){this._shell=o,o!==null&&o.addHole(this)},Mi.prototype.toPolygon=function(o){for(var u=new Array(this._holes.size()).fill(null),v=0;v<this._holes.size();v++)u[v]=this._holes.get(v).getLinearRing();return o.createPolygon(this.getLinearRing(),u)},Mi.prototype.interfaces_=function(){return[]},Mi.prototype.getClass=function(){return Mi};var Ro=function(o){function u(){var v=arguments[0],y=arguments[1];o.call(this,v,y)}return o&&(u.__proto__=o),u.prototype=Object.create(o&&o.prototype),u.prototype.constructor=u,u.prototype.setEdgeRing=function(v,y){v.setMinEdgeRing(y)},u.prototype.getNext=function(v){return v.getNextMin()},u.prototype.interfaces_=function(){return[]},u.prototype.getClass=function(){return u},u}(Mi),Ms=function(o){function u(){var v=arguments[0],y=arguments[1];o.call(this,v,y)}return o&&(u.__proto__=o),u.prototype=Object.create(o&&o.prototype),u.prototype.constructor=u,u.prototype.buildMinimalRings=function(){var v=new Wr,y=this._startDe;do{if(y.getMinEdgeRing()===null){var b=new Ro(y,this._geometryFactory);v.add(b)}y=y.getNext()}while(y!==this._startDe);return v},u.prototype.setEdgeRing=function(v,y){v.setEdgeRing(y)},u.prototype.linkDirectedEdgesForMinimalEdgeRings=function(){var v=this._startDe;do v.getNode().getEdges().linkMinimalDirectedEdges(this),v=v.getNext();while(v!==this._startDe)},u.prototype.getNext=function(v){return v.getNext()},u.prototype.interfaces_=function(){return[]},u.prototype.getClass=function(){return u},u}(Mi),Xs=function(){if(this._label=null,this._isInResult=!1,this._isCovered=!1,this._isCoveredSet=!1,this._isVisited=!1,arguments.length!==0){if(arguments.length===1){var o=arguments[0];this._label=o}}};Xs.prototype.setVisited=function(o){this._isVisited=o},Xs.prototype.setInResult=function(o){this._isInResult=o},Xs.prototype.isCovered=function(){return this._isCovered},Xs.prototype.isCoveredSet=function(){return this._isCoveredSet},Xs.prototype.setLabel=function(o){this._label=o},Xs.prototype.getLabel=function(){return this._label},Xs.prototype.setCovered=function(o){this._isCovered=o,this._isCoveredSet=!0},Xs.prototype.updateIM=function(o){Ft.isTrue(this._label.getGeometryCount()>=2,"found partial label"),this.computeIM(o)},Xs.prototype.isInResult=function(){return this._isInResult},Xs.prototype.isVisited=function(){return this._isVisited},Xs.prototype.interfaces_=function(){return[]},Xs.prototype.getClass=function(){return Xs};var If=function(o){function u(){o.call(this),this._coord=null,this._edges=null;var v=arguments[0],y=arguments[1];this._coord=v,this._edges=y,this._label=new zn(0,ye.NONE)}return o&&(u.__proto__=o),u.prototype=Object.create(o&&o.prototype),u.prototype.constructor=u,u.prototype.isIncidentEdgeInResult=function(){for(var v=this.getEdges().getEdges().iterator();v.hasNext();)if(v.next().getEdge().isInResult())return!0;return!1},u.prototype.isIsolated=function(){return this._label.getGeometryCount()===1},u.prototype.getCoordinate=function(){return this._coord},u.prototype.print=function(v){v.println("node "+this._coord+" lbl: "+this._label)},u.prototype.computeIM=function(v){},u.prototype.computeMergedLocation=function(v,y){var b=ye.NONE;if(b=this._label.getLocation(y),!v.isNull(y)){var H=v.getLocation(y);b!==ye.BOUNDARY&&(b=H)}return b},u.prototype.setLabel=function(){if(arguments.length!==2)return o.prototype.setLabel.apply(this,arguments);var v=arguments[0],y=arguments[1];this._label===null?this._label=new zn(v,y):this._label.setLocation(v,y)},u.prototype.getEdges=function(){return this._edges},u.prototype.mergeLabel=function(){if(arguments[0]instanceof u){var v=arguments[0];this.mergeLabel(v._label)}else if(arguments[0]instanceof zn)for(var y=arguments[0],b=0;b<2;b++){var H=this.computeMergedLocation(y,b);this._label.getLocation(b)===ye.NONE&&this._label.setLocation(b,H)}},u.prototype.add=function(v){this._edges.insert(v),v.setNode(this)},u.prototype.setLabelBoundary=function(v){if(this._label===null)return null;var y=ye.NONE;this._label!==null&&(y=this._label.getLocation(v));var b=null;switch(y){case ye.BOUNDARY:b=ye.INTERIOR;break;case ye.INTERIOR:default:b=ye.BOUNDARY}this._label.setLocation(v,b)},u.prototype.interfaces_=function(){return[]},u.prototype.getClass=function(){return u},u}(Xs),uu=function(){this.nodeMap=new Ce,this.nodeFact=null;var o=arguments[0];this.nodeFact=o};uu.prototype.find=function(o){return this.nodeMap.get(o)},uu.prototype.addNode=function(){if(arguments[0]instanceof Y){var o=arguments[0],u=this.nodeMap.get(o);return u===null&&(u=this.nodeFact.createNode(o),this.nodeMap.put(o,u)),u}if(arguments[0]instanceof If){var v=arguments[0],y=this.nodeMap.get(v.getCoordinate());return y===null?(this.nodeMap.put(v.getCoordinate(),v),v):(y.mergeLabel(v),y)}},uu.prototype.print=function(o){for(var u=this.iterator();u.hasNext();)u.next().print(o)},uu.prototype.iterator=function(){return this.nodeMap.values().iterator()},uu.prototype.values=function(){return this.nodeMap.values()},uu.prototype.getBoundaryNodes=function(o){for(var u=new Wr,v=this.iterator();v.hasNext();){var y=v.next();y.getLabel().getLocation(o)===ye.BOUNDARY&&u.add(y)}return u},uu.prototype.add=function(o){var u=o.getCoordinate();this.addNode(u).add(o)},uu.prototype.interfaces_=function(){return[]},uu.prototype.getClass=function(){return uu};var ca=function(){},Dc={NE:{configurable:!0},NW:{configurable:!0},SW:{configurable:!0},SE:{configurable:!0}};ca.prototype.interfaces_=function(){return[]},ca.prototype.getClass=function(){return ca},ca.isNorthern=function(o){return o===ca.NE||o===ca.NW},ca.isOpposite=function(o,u){return o===u?!1:(o-u+4)%4===2},ca.commonHalfPlane=function(o,u){if(o===u)return o;if((o-u+4)%4===2)return-1;var v=o<u?o:u;return v===0&&(o>u?o:u)===3?3:v},ca.isInHalfPlane=function(o,u){return u===ca.SE?o===ca.SE||o===ca.SW:o===u||o===u+1},ca.quadrant=function(){if(typeof arguments[0]=="number"&&typeof arguments[1]=="number"){var o=arguments[0],u=arguments[1];if(o===0&&u===0)throw new Me("Cannot compute the quadrant for point ( "+o+", "+u+" )");return o>=0?u>=0?ca.NE:ca.SE:u>=0?ca.NW:ca.SW}if(arguments[0]instanceof Y&&arguments[1]instanceof Y){var v=arguments[0],y=arguments[1];if(y.x===v.x&&y.y===v.y)throw new Me("Cannot compute the quadrant for two identical points "+v);return y.x>=v.x?y.y>=v.y?ca.NE:ca.SE:y.y>=v.y?ca.NW:ca.SW}},Dc.NE.get=function(){return 0},Dc.NW.get=function(){return 1},Dc.SW.get=function(){return 2},Dc.SE.get=function(){return 3},Object.defineProperties(ca,Dc);var ns=function(){if(this._edge=null,this._label=null,this._node=null,this._p0=null,this._p1=null,this._dx=null,this._dy=null,this._quadrant=null,arguments.length===1){var o=arguments[0];this._edge=o}else if(arguments.length===3){var u=arguments[0],v=arguments[1],y=arguments[2];this._edge=u,this.init(v,y),this._label=null}else if(arguments.length===4){var b=arguments[0],H=arguments[1],ne=arguments[2],Le=arguments[3];this._edge=b,this.init(H,ne),this._label=Le}};ns.prototype.compareDirection=function(o){return this._dx===o._dx&&this._dy===o._dy?0:this._quadrant>o._quadrant?1:this._quadrant<o._quadrant?-1:Pt.computeOrientation(o._p0,o._p1,this._p1)},ns.prototype.getDy=function(){return this._dy},ns.prototype.getCoordinate=function(){return this._p0},ns.prototype.setNode=function(o){this._node=o},ns.prototype.print=function(o){var u=Math.atan2(this._dy,this._dx),v=this.getClass().getName(),y=v.lastIndexOf("."),b=v.substring(y+1);o.print("  "+b+": "+this._p0+" - "+this._p1+" "+this._quadrant+":"+u+"   "+this._label)},ns.prototype.compareTo=function(o){var u=o;return this.compareDirection(u)},ns.prototype.getDirectedCoordinate=function(){return this._p1},ns.prototype.getDx=function(){return this._dx},ns.prototype.getLabel=function(){return this._label},ns.prototype.getEdge=function(){return this._edge},ns.prototype.getQuadrant=function(){return this._quadrant},ns.prototype.getNode=function(){return this._node},ns.prototype.toString=function(){var o=Math.atan2(this._dy,this._dx),u=this.getClass().getName(),v=u.lastIndexOf(".");return"  "+u.substring(v+1)+": "+this._p0+" - "+this._p1+" "+this._quadrant+":"+o+"   "+this._label},ns.prototype.computeLabel=function(o){},ns.prototype.init=function(o,u){this._p0=o,this._p1=u,this._dx=u.x-o.x,this._dy=u.y-o.y,this._quadrant=ca.quadrant(this._dx,this._dy),Ft.isTrue(!(this._dx===0&&this._dy===0),"EdgeEnd with identical endpoints found")},ns.prototype.interfaces_=function(){return[Ee]},ns.prototype.getClass=function(){return ns};var Lc=function(o){function u(){var v=arguments[0],y=arguments[1];if(o.call(this,v),this._isForward=null,this._isInResult=!1,this._isVisited=!1,this._sym=null,this._next=null,this._nextMin=null,this._edgeRing=null,this._minEdgeRing=null,this._depth=[0,-999,-999],this._isForward=y,y)this.init(v.getCoordinate(0),v.getCoordinate(1));else{var b=v.getNumPoints()-1;this.init(v.getCoordinate(b),v.getCoordinate(b-1))}this.computeDirectedLabel()}return o&&(u.__proto__=o),u.prototype=Object.create(o&&o.prototype),u.prototype.constructor=u,u.prototype.getNextMin=function(){return this._nextMin},u.prototype.getDepth=function(v){return this._depth[v]},u.prototype.setVisited=function(v){this._isVisited=v},u.prototype.computeDirectedLabel=function(){this._label=new zn(this._edge.getLabel()),this._isForward||this._label.flip()},u.prototype.getNext=function(){return this._next},u.prototype.setDepth=function(v,y){if(this._depth[v]!==-999&&this._depth[v]!==y)throw new Ht("assigned depths do not match",this.getCoordinate());this._depth[v]=y},u.prototype.isInteriorAreaEdge=function(){for(var v=!0,y=0;y<2;y++)this._label.isArea(y)&&this._label.getLocation(y,fe.LEFT)===ye.INTERIOR&&this._label.getLocation(y,fe.RIGHT)===ye.INTERIOR||(v=!1);return v},u.prototype.setNextMin=function(v){this._nextMin=v},u.prototype.print=function(v){o.prototype.print.call(this,v),v.print(" "+this._depth[fe.LEFT]+"/"+this._depth[fe.RIGHT]),v.print(" ("+this.getDepthDelta()+")"),this._isInResult&&v.print(" inResult")},u.prototype.setMinEdgeRing=function(v){this._minEdgeRing=v},u.prototype.isLineEdge=function(){var v=this._label.isLine(0)||this._label.isLine(1),y=!this._label.isArea(0)||this._label.allPositionsEqual(0,ye.EXTERIOR),b=!this._label.isArea(1)||this._label.allPositionsEqual(1,ye.EXTERIOR);return v&&y&&b},u.prototype.setEdgeRing=function(v){this._edgeRing=v},u.prototype.getMinEdgeRing=function(){return this._minEdgeRing},u.prototype.getDepthDelta=function(){var v=this._edge.getDepthDelta();return this._isForward||(v=-v),v},u.prototype.setInResult=function(v){this._isInResult=v},u.prototype.getSym=function(){return this._sym},u.prototype.isForward=function(){return this._isForward},u.prototype.getEdge=function(){return this._edge},u.prototype.printEdge=function(v){this.print(v),v.print(" "),this._isForward?this._edge.print(v):this._edge.printReverse(v)},u.prototype.setSym=function(v){this._sym=v},u.prototype.setVisitedEdge=function(v){this.setVisited(v),this._sym.setVisited(v)},u.prototype.setEdgeDepths=function(v,y){var b=this.getEdge().getDepthDelta();this._isForward||(b=-b);var H=1;v===fe.LEFT&&(H=-1);var ne=fe.opposite(v),Le=y+b*H;this.setDepth(v,y),this.setDepth(ne,Le)},u.prototype.getEdgeRing=function(){return this._edgeRing},u.prototype.isInResult=function(){return this._isInResult},u.prototype.setNext=function(v){this._next=v},u.prototype.isVisited=function(){return this._isVisited},u.prototype.interfaces_=function(){return[]},u.prototype.getClass=function(){return u},u.depthFactor=function(v,y){return v===ye.EXTERIOR&&y===ye.INTERIOR?1:v===ye.INTERIOR&&y===ye.EXTERIOR?-1:0},u}(ns),ol=function(){};ol.prototype.createNode=function(o){return new If(o,null)},ol.prototype.interfaces_=function(){return[]},ol.prototype.getClass=function(){return ol};var Xa=function(){if(this._edges=new Wr,this._nodes=null,this._edgeEndList=new Wr,arguments.length===0)this._nodes=new uu(new ol);else if(arguments.length===1){var o=arguments[0];this._nodes=new uu(o)}};Xa.prototype.printEdges=function(o){o.println("Edges:");for(var u=0;u<this._edges.size();u++){o.println("edge "+u+":");var v=this._edges.get(u);v.print(o),v.eiList.print(o)}},Xa.prototype.find=function(o){return this._nodes.find(o)},Xa.prototype.addNode=function(){if(arguments[0]instanceof If){var o=arguments[0];return this._nodes.addNode(o)}if(arguments[0]instanceof Y){var u=arguments[0];return this._nodes.addNode(u)}},Xa.prototype.getNodeIterator=function(){return this._nodes.iterator()},Xa.prototype.linkResultDirectedEdges=function(){for(var o=this._nodes.iterator();o.hasNext();)o.next().getEdges().linkResultDirectedEdges()},Xa.prototype.debugPrintln=function(o){Qr.out.println(o)},Xa.prototype.isBoundaryNode=function(o,u){var v=this._nodes.find(u);if(v===null)return!1;var y=v.getLabel();return y!==null&&y.getLocation(o)===ye.BOUNDARY},Xa.prototype.linkAllDirectedEdges=function(){for(var o=this._nodes.iterator();o.hasNext();)o.next().getEdges().linkAllDirectedEdges()},Xa.prototype.matchInSameDirection=function(o,u,v,y){return!!o.equals(v)&&Pt.computeOrientation(o,u,y)===Pt.COLLINEAR&&ca.quadrant(o,u)===ca.quadrant(v,y)},Xa.prototype.getEdgeEnds=function(){return this._edgeEndList},Xa.prototype.debugPrint=function(o){Qr.out.print(o)},Xa.prototype.getEdgeIterator=function(){return this._edges.iterator()},Xa.prototype.findEdgeInSameDirection=function(o,u){for(var v=0;v<this._edges.size();v++){var y=this._edges.get(v),b=y.getCoordinates();if(this.matchInSameDirection(o,u,b[0],b[1])||this.matchInSameDirection(o,u,b[b.length-1],b[b.length-2]))return y}return null},Xa.prototype.insertEdge=function(o){this._edges.add(o)},Xa.prototype.findEdgeEnd=function(o){for(var u=this.getEdgeEnds().iterator();u.hasNext();){var v=u.next();if(v.getEdge()===o)return v}return null},Xa.prototype.addEdges=function(o){for(var u=o.iterator();u.hasNext();){var v=u.next();this._edges.add(v);var y=new Lc(v,!0),b=new Lc(v,!1);y.setSym(b),b.setSym(y),this.add(y),this.add(b)}},Xa.prototype.add=function(o){this._nodes.add(o),this._edgeEndList.add(o)},Xa.prototype.getNodes=function(){return this._nodes.values()},Xa.prototype.findEdge=function(o,u){for(var v=0;v<this._edges.size();v++){var y=this._edges.get(v),b=y.getCoordinates();if(o.equals(b[0])&&u.equals(b[1]))return y}return null},Xa.prototype.interfaces_=function(){return[]},Xa.prototype.getClass=function(){return Xa},Xa.linkResultDirectedEdges=function(o){for(var u=o.iterator();u.hasNext();)u.next().getEdges().linkResultDirectedEdges()};var Fn=function(){this._geometryFactory=null,this._shellList=new Wr;var o=arguments[0];this._geometryFactory=o};Fn.prototype.sortShellsAndHoles=function(o,u,v){for(var y=o.iterator();y.hasNext();){var b=y.next();b.isHole()?v.add(b):u.add(b)}},Fn.prototype.computePolygons=function(o){for(var u=new Wr,v=o.iterator();v.hasNext();){var y=v.next().toPolygon(this._geometryFactory);u.add(y)}return u},Fn.prototype.placeFreeHoles=function(o,u){for(var v=u.iterator();v.hasNext();){var y=v.next();if(y.getShell()===null){var b=this.findEdgeRingContaining(y,o);if(b===null)throw new Ht("unable to assign hole to a shell",y.getCoordinate(0));y.setShell(b)}}},Fn.prototype.buildMinimalEdgeRings=function(o,u,v){for(var y=new Wr,b=o.iterator();b.hasNext();){var H=b.next();if(H.getMaxNodeDegree()>2){H.linkDirectedEdgesForMinimalEdgeRings();var ne=H.buildMinimalRings(),Le=this.findShell(ne);Le!==null?(this.placePolygonHoles(Le,ne),u.add(Le)):v.addAll(ne)}else y.add(H)}return y},Fn.prototype.containsPoint=function(o){for(var u=this._shellList.iterator();u.hasNext();)if(u.next().containsPoint(o))return!0;return!1},Fn.prototype.buildMaximalEdgeRings=function(o){for(var u=new Wr,v=o.iterator();v.hasNext();){var y=v.next();if(y.isInResult()&&y.getLabel().isArea()&&y.getEdgeRing()===null){var b=new Ms(y,this._geometryFactory);u.add(b),b.setInResult()}}return u},Fn.prototype.placePolygonHoles=function(o,u){for(var v=u.iterator();v.hasNext();){var y=v.next();y.isHole()&&y.setShell(o)}},Fn.prototype.getPolygons=function(){return this.computePolygons(this._shellList)},Fn.prototype.findEdgeRingContaining=function(o,u){for(var v=o.getLinearRing(),y=v.getEnvelopeInternal(),b=v.getCoordinateN(0),H=null,ne=null,Le=u.iterator();Le.hasNext();){var tt=Le.next(),Nt=tt.getLinearRing(),ar=Nt.getEnvelopeInternal();H!==null&&(ne=H.getLinearRing().getEnvelopeInternal());var st=!1;ar.contains(y)&&Pt.isPointInRing(b,Nt.getCoordinates())&&(st=!0),st&&(H===null||ne.contains(ar))&&(H=tt)}return H},Fn.prototype.findShell=function(o){for(var u=0,v=null,y=o.iterator();y.hasNext();){var b=y.next();b.isHole()||(v=b,u++)}return Ft.isTrue(u<=1,"found two shells in MinimalEdgeRing list"),v},Fn.prototype.add=function(){if(arguments.length===1){var o=arguments[0];this.add(o.getEdgeEnds(),o.getNodes())}else if(arguments.length===2){var u=arguments[0],v=arguments[1];Xa.linkResultDirectedEdges(v);var y=this.buildMaximalEdgeRings(u),b=new Wr,H=this.buildMinimalEdgeRings(y,this._shellList,b);this.sortShellsAndHoles(H,this._shellList,b),this.placeFreeHoles(this._shellList,b)}},Fn.prototype.interfaces_=function(){return[]},Fn.prototype.getClass=function(){return Fn};var Wl=function(){};Wl.prototype.getBounds=function(){},Wl.prototype.interfaces_=function(){return[]},Wl.prototype.getClass=function(){return Wl};var Ys=function(){this._bounds=null,this._item=null;var o=arguments[0],u=arguments[1];this._bounds=o,this._item=u};Ys.prototype.getItem=function(){return this._item},Ys.prototype.getBounds=function(){return this._bounds},Ys.prototype.interfaces_=function(){return[Wl,I]},Ys.prototype.getClass=function(){return Ys};var lu=function(){this._size=null,this._items=null,this._size=0,this._items=new Wr,this._items.add(null)};lu.prototype.poll=function(){if(this.isEmpty())return null;var o=this._items.get(1);return this._items.set(1,this._items.get(this._size)),this._size-=1,this.reorder(1),o},lu.prototype.size=function(){return this._size},lu.prototype.reorder=function(o){for(var u=null,v=this._items.get(o);2*o<=this._size&&((u=2*o)!==this._size&&this._items.get(u+1).compareTo(this._items.get(u))<0&&u++,this._items.get(u).compareTo(v)<0);o=u)this._items.set(o,this._items.get(u));this._items.set(o,v)},lu.prototype.clear=function(){this._size=0,this._items.clear()},lu.prototype.isEmpty=function(){return this._size===0},lu.prototype.add=function(o){this._items.add(null),this._size+=1;var u=this._size;for(this._items.set(0,o);o.compareTo(this._items.get(Math.trunc(u/2)))<0;u/=2)this._items.set(u,this._items.get(Math.trunc(u/2)));this._items.set(u,o)},lu.prototype.interfaces_=function(){return[]},lu.prototype.getClass=function(){return lu};var ws=function(){};ws.prototype.visitItem=function(o){},ws.prototype.interfaces_=function(){return[]},ws.prototype.getClass=function(){return ws};var Mu=function(){};Mu.prototype.insert=function(o,u){},Mu.prototype.remove=function(o,u){},Mu.prototype.query=function(){},Mu.prototype.interfaces_=function(){return[]},Mu.prototype.getClass=function(){return Mu};var wi=function(){if(this._childBoundables=new Wr,this._bounds=null,this._level=null,arguments.length!==0){if(arguments.length===1){var o=arguments[0];this._level=o}}},Is={serialVersionUID:{configurable:!0}};wi.prototype.getLevel=function(){return this._level},wi.prototype.size=function(){return this._childBoundables.size()},wi.prototype.getChildBoundables=function(){return this._childBoundables},wi.prototype.addChildBoundable=function(o){Ft.isTrue(this._bounds===null),this._childBoundables.add(o)},wi.prototype.isEmpty=function(){return this._childBoundables.isEmpty()},wi.prototype.getBounds=function(){return this._bounds===null&&(this._bounds=this.computeBounds()),this._bounds},wi.prototype.interfaces_=function(){return[Wl,I]},wi.prototype.getClass=function(){return wi},Is.serialVersionUID.get=function(){return 6493722185909574e3},Object.defineProperties(wi,Is);var io=function(){};io.reverseOrder=function(){return{compare:function(o,u){return u.compareTo(o)}}},io.min=function(o){return io.sort(o),o.get(0)},io.sort=function(o,u){var v=o.toArray();u?Uu.sort(v,u):Uu.sort(v);for(var y=o.iterator(),b=0,H=v.length;b<H;b++)y.next(),y.set(v[b])},io.singletonList=function(o){var u=new Wr;return u.add(o),u};var Ya=function(){this._boundable1=null,this._boundable2=null,this._distance=null,this._itemDistance=null;var o=arguments[0],u=arguments[1],v=arguments[2];this._boundable1=o,this._boundable2=u,this._itemDistance=v,this._distance=this.distance()};Ya.prototype.expandToQueue=function(o,u){var v=Ya.isComposite(this._boundable1),y=Ya.isComposite(this._boundable2);if(v&&y)return Ya.area(this._boundable1)>Ya.area(this._boundable2)?(this.expand(this._boundable1,this._boundable2,o,u),null):(this.expand(this._boundable2,this._boundable1,o,u),null);if(v)return this.expand(this._boundable1,this._boundable2,o,u),null;if(y)return this.expand(this._boundable2,this._boundable1,o,u),null;throw new Me("neither boundable is composite")},Ya.prototype.isLeaves=function(){return!(Ya.isComposite(this._boundable1)||Ya.isComposite(this._boundable2))},Ya.prototype.compareTo=function(o){var u=o;return this._distance<u._distance?-1:this._distance>u._distance?1:0},Ya.prototype.expand=function(o,u,v,y){for(var b=o.getChildBoundables().iterator();b.hasNext();){var H=b.next(),ne=new Ya(H,u,this._itemDistance);ne.getDistance()<y&&v.add(ne)}},Ya.prototype.getBoundable=function(o){return o===0?this._boundable1:this._boundable2},Ya.prototype.getDistance=function(){return this._distance},Ya.prototype.distance=function(){return this.isLeaves()?this._itemDistance.distance(this._boundable1,this._boundable2):this._boundable1.getBounds().distance(this._boundable2.getBounds())},Ya.prototype.interfaces_=function(){return[Ee]},Ya.prototype.getClass=function(){return Ya},Ya.area=function(o){return o.getBounds().getArea()},Ya.isComposite=function(o){return o instanceof wi};var ko=function o(){if(this._root=null,this._built=!1,this._itemBoundables=new Wr,this._nodeCapacity=null,arguments.length===0){var u=o.DEFAULT_NODE_CAPACITY;this._nodeCapacity=u}else if(arguments.length===1){var v=arguments[0];Ft.isTrue(v>1,"Node capacity must be greater than 1"),this._nodeCapacity=v}},wu={IntersectsOp:{configurable:!0},serialVersionUID:{configurable:!0},DEFAULT_NODE_CAPACITY:{configurable:!0}};ko.prototype.getNodeCapacity=function(){return this._nodeCapacity},ko.prototype.lastNode=function(o){return o.get(o.size()-1)},ko.prototype.size=function(){if(arguments.length===0)return this.isEmpty()?0:(this.build(),this.size(this._root));if(arguments.length===1){for(var o=0,u=arguments[0].getChildBoundables().iterator();u.hasNext();){var v=u.next();v instanceof wi?o+=this.size(v):v instanceof Ys&&(o+=1)}return o}},ko.prototype.removeItem=function(o,u){for(var v=null,y=o.getChildBoundables().iterator();y.hasNext();){var b=y.next();b instanceof Ys&&b.getItem()===u&&(v=b)}return v!==null&&(o.getChildBoundables().remove(v),!0)},ko.prototype.itemsTree=function(){if(arguments.length===0){this.build();var o=this.itemsTree(this._root);return o===null?new Wr:o}if(arguments.length===1){for(var u=arguments[0],v=new Wr,y=u.getChildBoundables().iterator();y.hasNext();){var b=y.next();if(b instanceof wi){var H=this.itemsTree(b);H!==null&&v.add(H)}else b instanceof Ys?v.add(b.getItem()):Ft.shouldNeverReachHere()}return v.size()<=0?null:v}},ko.prototype.insert=function(o,u){Ft.isTrue(!this._built,"Cannot insert items into an STR packed R-tree after it has been built."),this._itemBoundables.add(new Ys(o,u))},ko.prototype.boundablesAtLevel=function(){if(arguments.length===1){var o=arguments[0],u=new Wr;return this.boundablesAtLevel(o,this._root,u),u}if(arguments.length===3){var v=arguments[0],y=arguments[1],b=arguments[2];if(Ft.isTrue(v>-2),y.getLevel()===v)return b.add(y),null;for(var H=y.getChildBoundables().iterator();H.hasNext();){var ne=H.next();ne instanceof wi?this.boundablesAtLevel(v,ne,b):(Ft.isTrue(ne instanceof Ys),v===-1&&b.add(ne))}return null}},ko.prototype.query=function(){if(arguments.length===1){var o=arguments[0];this.build();var u=new Wr;return this.isEmpty()||this.getIntersectsOp().intersects(this._root.getBounds(),o)&&this.query(o,this._root,u),u}if(arguments.length===2){var v=arguments[0],y=arguments[1];if(this.build(),this.isEmpty())return null;this.getIntersectsOp().intersects(this._root.getBounds(),v)&&this.query(v,this._root,y)}else if(arguments.length===3){if(Pe(arguments[2],ws)&&arguments[0]instanceof Object&&arguments[1]instanceof wi)for(var b=arguments[0],H=arguments[1],ne=arguments[2],Le=H.getChildBoundables(),tt=0;tt<Le.size();tt++){var Nt=Le.get(tt);this.getIntersectsOp().intersects(Nt.getBounds(),b)&&(Nt instanceof wi?this.query(b,Nt,ne):Nt instanceof Ys?ne.visitItem(Nt.getItem()):Ft.shouldNeverReachHere())}else if(Pe(arguments[2],ja)&&arguments[0]instanceof Object&&arguments[1]instanceof wi)for(var ar=arguments[0],st=arguments[1],Gt=arguments[2],ir=st.getChildBoundables(),br=0;br<ir.size();br++){var g=ir.get(br);this.getIntersectsOp().intersects(g.getBounds(),ar)&&(g instanceof wi?this.query(ar,g,Gt):g instanceof Ys?Gt.add(g.getItem()):Ft.shouldNeverReachHere())}}},ko.prototype.build=function(){if(this._built)return null;this._root=this._itemBoundables.isEmpty()?this.createNode(0):this.createHigherLevels(this._itemBoundables,-1),this._itemBoundables=null,this._built=!0},ko.prototype.getRoot=function(){return this.build(),this._root},ko.prototype.remove=function(){if(arguments.length===2){var o=arguments[0],u=arguments[1];return this.build(),!!this.getIntersectsOp().intersects(this._root.getBounds(),o)&&this.remove(o,this._root,u)}if(arguments.length===3){var v=arguments[0],y=arguments[1],b=arguments[2],H=this.removeItem(y,b);if(H)return!0;for(var ne=null,Le=y.getChildBoundables().iterator();Le.hasNext();){var tt=Le.next();if(this.getIntersectsOp().intersects(tt.getBounds(),v)&&tt instanceof wi&&(H=this.remove(v,tt,b))){ne=tt;break}}return ne!==null&&ne.getChildBoundables().isEmpty()&&y.getChildBoundables().remove(ne),H}},ko.prototype.createHigherLevels=function(o,u){Ft.isTrue(!o.isEmpty());var v=this.createParentBoundables(o,u+1);return v.size()===1?v.get(0):this.createHigherLevels(v,u+1)},ko.prototype.depth=function(){if(arguments.length===0)return this.isEmpty()?0:(this.build(),this.depth(this._root));if(arguments.length===1){for(var o=0,u=arguments[0].getChildBoundables().iterator();u.hasNext();){var v=u.next();if(v instanceof wi){var y=this.depth(v);y>o&&(o=y)}}return o+1}},ko.prototype.createParentBoundables=function(o,u){Ft.isTrue(!o.isEmpty());var v=new Wr;v.add(this.createNode(u));var y=new Wr(o);io.sort(y,this.getComparator());for(var b=y.iterator();b.hasNext();){var H=b.next();this.lastNode(v).getChildBoundables().size()===this.getNodeCapacity()&&v.add(this.createNode(u)),this.lastNode(v).addChildBoundable(H)}return v},ko.prototype.isEmpty=function(){return this._built?this._root.isEmpty():this._itemBoundables.isEmpty()},ko.prototype.interfaces_=function(){return[I]},ko.prototype.getClass=function(){return ko},ko.compareDoubles=function(o,u){return o>u?1:o<u?-1:0},wu.IntersectsOp.get=function(){return $f},wu.serialVersionUID.get=function(){return-3886435814360241e3},wu.DEFAULT_NODE_CAPACITY.get=function(){return 10},Object.defineProperties(ko,wu);var $f=function(){},cc=function(){};cc.prototype.distance=function(o,u){},cc.prototype.interfaces_=function(){return[]},cc.prototype.getClass=function(){return cc};var Pf=function(o){function u(y){y=y||u.DEFAULT_NODE_CAPACITY,o.call(this,y)}o&&(u.__proto__=o),(u.prototype=Object.create(o&&o.prototype)).constructor=u;var v={STRtreeNode:{configurable:!0},serialVersionUID:{configurable:!0},xComparator:{configurable:!0},yComparator:{configurable:!0},intersectsOp:{configurable:!0},DEFAULT_NODE_CAPACITY:{configurable:!0}};return u.prototype.createParentBoundablesFromVerticalSlices=function(y,b){Ft.isTrue(y.length>0);for(var H=new Wr,ne=0;ne<y.length;ne++)H.addAll(this.createParentBoundablesFromVerticalSlice(y[ne],b));return H},u.prototype.createNode=function(y){return new jl(y)},u.prototype.size=function(){return arguments.length===0?o.prototype.size.call(this):o.prototype.size.apply(this,arguments)},u.prototype.insert=function(){if(arguments.length!==2)return o.prototype.insert.apply(this,arguments);var y=arguments[0],b=arguments[1];if(y.isNull())return null;o.prototype.insert.call(this,y,b)},u.prototype.getIntersectsOp=function(){return u.intersectsOp},u.prototype.verticalSlices=function(y,b){for(var H=Math.trunc(Math.ceil(y.size()/b)),ne=new Array(b).fill(null),Le=y.iterator(),tt=0;tt<b;tt++){ne[tt]=new Wr;for(var Nt=0;Le.hasNext()&&Nt<H;){var ar=Le.next();ne[tt].add(ar),Nt++}}return ne},u.prototype.query=function(){if(arguments.length===1){var y=arguments[0];return o.prototype.query.call(this,y)}if(arguments.length===2){var b=arguments[0],H=arguments[1];o.prototype.query.call(this,b,H)}else if(arguments.length===3){if(Pe(arguments[2],ws)&&arguments[0]instanceof Object&&arguments[1]instanceof wi){var ne=arguments[0],Le=arguments[1],tt=arguments[2];o.prototype.query.call(this,ne,Le,tt)}else if(Pe(arguments[2],ja)&&arguments[0]instanceof Object&&arguments[1]instanceof wi){var Nt=arguments[0],ar=arguments[1],st=arguments[2];o.prototype.query.call(this,Nt,ar,st)}}},u.prototype.getComparator=function(){return u.yComparator},u.prototype.createParentBoundablesFromVerticalSlice=function(y,b){return o.prototype.createParentBoundables.call(this,y,b)},u.prototype.remove=function(){if(arguments.length===2){var y=arguments[0],b=arguments[1];return o.prototype.remove.call(this,y,b)}return o.prototype.remove.apply(this,arguments)},u.prototype.depth=function(){return arguments.length===0?o.prototype.depth.call(this):o.prototype.depth.apply(this,arguments)},u.prototype.createParentBoundables=function(y,b){Ft.isTrue(!y.isEmpty());var H=Math.trunc(Math.ceil(y.size()/this.getNodeCapacity())),ne=new Wr(y);io.sort(ne,u.xComparator);var Le=this.verticalSlices(ne,Math.trunc(Math.ceil(Math.sqrt(H))));return this.createParentBoundablesFromVerticalSlices(Le,b)},u.prototype.nearestNeighbour=function(){if(arguments.length===1){if(Pe(arguments[0],cc)){var y=arguments[0],b=new Ya(this.getRoot(),this.getRoot(),y);return this.nearestNeighbour(b)}if(arguments[0]instanceof Ya){var H=arguments[0];return this.nearestNeighbour(H,ce.POSITIVE_INFINITY)}}else if(arguments.length===2){if(arguments[0]instanceof u&&Pe(arguments[1],cc)){var ne=arguments[0],Le=arguments[1],tt=new Ya(this.getRoot(),ne.getRoot(),Le);return this.nearestNeighbour(tt)}if(arguments[0]instanceof Ya&&typeof arguments[1]=="number"){var Nt=arguments[0],ar=arguments[1],st=null,Gt=new lu;for(Gt.add(Nt);!Gt.isEmpty()&&ar>0;){var ir=Gt.poll(),br=ir.getDistance();if(br>=ar)break;ir.isLeaves()?(ar=br,st=ir):ir.expandToQueue(Gt,ar)}return[st.getBoundable(0).getItem(),st.getBoundable(1).getItem()]}}else if(arguments.length===3){var g=arguments[0],Bn=arguments[1],Jn=arguments[2],et=new Ys(g,Bn),Za=new Ya(this.getRoot(),et,Jn);return this.nearestNeighbour(Za)[0]}},u.prototype.interfaces_=function(){return[Mu,I]},u.prototype.getClass=function(){return u},u.centreX=function(y){return u.avg(y.getMinX(),y.getMaxX())},u.avg=function(y,b){return(y+b)/2},u.centreY=function(y){return u.avg(y.getMinY(),y.getMaxY())},v.STRtreeNode.get=function(){return jl},v.serialVersionUID.get=function(){return 0x39920f7d5f261e0},v.xComparator.get=function(){return{interfaces_:function(){return[oe]},compare:function(y,b){return o.compareDoubles(u.centreX(y.getBounds()),u.centreX(b.getBounds()))}}},v.yComparator.get=function(){return{interfaces_:function(){return[oe]},compare:function(y,b){return o.compareDoubles(u.centreY(y.getBounds()),u.centreY(b.getBounds()))}}},v.intersectsOp.get=function(){return{interfaces_:function(){return[o.IntersectsOp]},intersects:function(y,b){return y.intersects(b)}}},v.DEFAULT_NODE_CAPACITY.get=function(){return 10},Object.defineProperties(u,v),u}(ko),jl=function(o){function u(){var v=arguments[0];o.call(this,v)}return o&&(u.__proto__=o),u.prototype=Object.create(o&&o.prototype),u.prototype.constructor=u,u.prototype.computeBounds=function(){for(var v=null,y=this.getChildBoundables().iterator();y.hasNext();){var b=y.next();v===null?v=new Mr(b.getBounds()):v.expandToInclude(b.getBounds())}return v},u.prototype.interfaces_=function(){return[]},u.prototype.getClass=function(){return u},u}(wi),vs=function(){};vs.prototype.interfaces_=function(){return[]},vs.prototype.getClass=function(){return vs},vs.relativeSign=function(o,u){return o<u?-1:o>u?1:0},vs.compare=function(o,u,v){if(u.equals2D(v))return 0;var y=vs.relativeSign(u.x,v.x),b=vs.relativeSign(u.y,v.y);switch(o){case 0:return vs.compareValue(y,b);case 1:return vs.compareValue(b,y);case 2:return vs.compareValue(b,-y);case 3:return vs.compareValue(-y,b);case 4:return vs.compareValue(-y,-b);case 5:return vs.compareValue(-b,-y);case 6:return vs.compareValue(-b,y);case 7:return vs.compareValue(y,-b)}return Ft.shouldNeverReachHere("invalid octant value"),0},vs.compareValue=function(o,u){return o<0?-1:o>0?1:u<0?-1:u>0?1:0};var Ml=function(){this._segString=null,this.coord=null,this.segmentIndex=null,this._segmentOctant=null,this._isInterior=null;var o=arguments[0],u=arguments[1],v=arguments[2],y=arguments[3];this._segString=o,this.coord=new Y(u),this.segmentIndex=v,this._segmentOctant=y,this._isInterior=!u.equals2D(o.getCoordinate(v))};Ml.prototype.getCoordinate=function(){return this.coord},Ml.prototype.print=function(o){o.print(this.coord),o.print(" seg # = "+this.segmentIndex)},Ml.prototype.compareTo=function(o){var u=o;return this.segmentIndex<u.segmentIndex?-1:this.segmentIndex>u.segmentIndex?1:this.coord.equals2D(u.coord)?0:vs.compare(this._segmentOctant,this.coord,u.coord)},Ml.prototype.isEndPoint=function(o){return this.segmentIndex===0&&!this._isInterior||this.segmentIndex===o},Ml.prototype.isInterior=function(){return this._isInterior},Ml.prototype.interfaces_=function(){return[Ee]},Ml.prototype.getClass=function(){return Ml};var yo=function(){this._nodeMap=new Ce,this._edge=null;var o=arguments[0];this._edge=o};yo.prototype.getSplitCoordinates=function(){var o=new Xo;this.addEndpoints();for(var u=this.iterator(),v=u.next();u.hasNext();){var y=u.next();this.addEdgeCoordinates(v,y,o),v=y}return o.toCoordinateArray()},yo.prototype.addCollapsedNodes=function(){var o=new Wr;this.findCollapsesFromInsertedNodes(o),this.findCollapsesFromExistingVertices(o);for(var u=o.iterator();u.hasNext();){var v=u.next().intValue();this.add(this._edge.getCoordinate(v),v)}},yo.prototype.print=function(o){o.println("Intersections:");for(var u=this.iterator();u.hasNext();)u.next().print(o)},yo.prototype.findCollapsesFromExistingVertices=function(o){for(var u=0;u<this._edge.size()-2;u++){var v=this._edge.getCoordinate(u),y=this._edge.getCoordinate(u+2);v.equals2D(y)&&o.add(new ke(u+1))}},yo.prototype.addEdgeCoordinates=function(o,u,v){var y=this._edge.getCoordinate(u.segmentIndex),b=u.isInterior()||!u.coord.equals2D(y);v.add(new Y(o.coord),!1);for(var H=o.segmentIndex+1;H<=u.segmentIndex;H++)v.add(this._edge.getCoordinate(H));b&&v.add(new Y(u.coord))},yo.prototype.iterator=function(){return this._nodeMap.values().iterator()},yo.prototype.addSplitEdges=function(o){this.addEndpoints(),this.addCollapsedNodes();for(var u=this.iterator(),v=u.next();u.hasNext();){var y=u.next(),b=this.createSplitEdge(v,y);o.add(b),v=y}},yo.prototype.findCollapseIndex=function(o,u,v){if(!o.coord.equals2D(u.coord))return!1;var y=u.segmentIndex-o.segmentIndex;return u.isInterior()||y--,y===1&&(v[0]=o.segmentIndex+1,!0)},yo.prototype.findCollapsesFromInsertedNodes=function(o){for(var u=new Array(1).fill(null),v=this.iterator(),y=v.next();v.hasNext();){var b=v.next();this.findCollapseIndex(y,b,u)&&o.add(new ke(u[0])),y=b}},yo.prototype.getEdge=function(){return this._edge},yo.prototype.addEndpoints=function(){var o=this._edge.size()-1;this.add(this._edge.getCoordinate(0),0),this.add(this._edge.getCoordinate(o),o)},yo.prototype.createSplitEdge=function(o,u){var v=u.segmentIndex-o.segmentIndex+2,y=this._edge.getCoordinate(u.segmentIndex),b=u.isInterior()||!u.coord.equals2D(y);b||v--;var H=new Array(v).fill(null),ne=0;H[ne++]=new Y(o.coord);for(var Le=o.segmentIndex+1;Le<=u.segmentIndex;Le++)H[ne++]=this._edge.getCoordinate(Le);return b&&(H[ne]=new Y(u.coord)),new Ua(H,this._edge.getData())},yo.prototype.add=function(o,u){var v=new Ml(this._edge,o,u,this._edge.getSegmentOctant(u)),y=this._nodeMap.get(v);return y!==null?(Ft.isTrue(y.coord.equals2D(o),"Found equal nodes with different coordinates"),y):(this._nodeMap.put(v,v),v)},yo.prototype.checkSplitEdgesCorrectness=function(o){var u=this._edge.getCoordinates(),v=o.get(0).getCoordinate(0);if(!v.equals2D(u[0]))throw new $i("bad split edge start point at "+v);var y=o.get(o.size()-1).getCoordinates(),b=y[y.length-1];if(!b.equals2D(u[u.length-1]))throw new $i("bad split edge end point at "+b)},yo.prototype.interfaces_=function(){return[]},yo.prototype.getClass=function(){return yo};var ba=function(){};ba.prototype.interfaces_=function(){return[]},ba.prototype.getClass=function(){return ba},ba.octant=function(){if(typeof arguments[0]=="number"&&typeof arguments[1]=="number"){var o=arguments[0],u=arguments[1];if(o===0&&u===0)throw new Me("Cannot compute the octant for point ( "+o+", "+u+" )");var v=Math.abs(o),y=Math.abs(u);return o>=0?u>=0?v>=y?0:1:v>=y?7:6:u>=0?v>=y?3:2:v>=y?4:5}if(arguments[0]instanceof Y&&arguments[1]instanceof Y){var b=arguments[0],H=arguments[1],ne=H.x-b.x,Le=H.y-b.y;if(ne===0&&Le===0)throw new Me("Cannot compute the octant for two identical points "+b);return ba.octant(ne,Le)}};var gs=function(){};gs.prototype.getCoordinates=function(){},gs.prototype.size=function(){},gs.prototype.getCoordinate=function(o){},gs.prototype.isClosed=function(){},gs.prototype.setData=function(o){},gs.prototype.getData=function(){},gs.prototype.interfaces_=function(){return[]},gs.prototype.getClass=function(){return gs};var Xl=function(){};Xl.prototype.addIntersection=function(o,u){},Xl.prototype.interfaces_=function(){return[gs]},Xl.prototype.getClass=function(){return Xl};var Ua=function(){this._nodeList=new yo(this),this._pts=null,this._data=null;var o=arguments[0],u=arguments[1];this._pts=o,this._data=u};Ua.prototype.getCoordinates=function(){return this._pts},Ua.prototype.size=function(){return this._pts.length},Ua.prototype.getCoordinate=function(o){return this._pts[o]},Ua.prototype.isClosed=function(){return this._pts[0].equals(this._pts[this._pts.length-1])},Ua.prototype.getSegmentOctant=function(o){return o===this._pts.length-1?-1:this.safeOctant(this.getCoordinate(o),this.getCoordinate(o+1))},Ua.prototype.setData=function(o){this._data=o},Ua.prototype.safeOctant=function(o,u){return o.equals2D(u)?0:ba.octant(o,u)},Ua.prototype.getData=function(){return this._data},Ua.prototype.addIntersection=function(){if(arguments.length===2){var o=arguments[0],u=arguments[1];this.addIntersectionNode(o,u)}else if(arguments.length===4){var v=arguments[0],y=arguments[1],b=arguments[3],H=new Y(v.getIntersection(b));this.addIntersection(H,y)}},Ua.prototype.toString=function(){return Cn.toLineString(new qa(this._pts))},Ua.prototype.getNodeList=function(){return this._nodeList},Ua.prototype.addIntersectionNode=function(o,u){var v=u,y=v+1;if(y<this._pts.length){var b=this._pts[y];o.equals2D(b)&&(v=y)}return this._nodeList.add(o,v)},Ua.prototype.addIntersections=function(o,u,v){for(var y=0;y<o.getIntersectionNum();y++)this.addIntersection(o,u,v,y)},Ua.prototype.interfaces_=function(){return[Xl]},Ua.prototype.getClass=function(){return Ua},Ua.getNodedSubstrings=function(){if(arguments.length===1){var o=arguments[0],u=new Wr;return Ua.getNodedSubstrings(o,u),u}if(arguments.length===2)for(var v=arguments[0],y=arguments[1],b=v.iterator();b.hasNext();)b.next().getNodeList().addSplitEdges(y)};var On=function(){if(this.p0=null,this.p1=null,arguments.length===0)this.p0=new Y,this.p1=new Y;else if(arguments.length===1){var o=arguments[0];this.p0=new Y(o.p0),this.p1=new Y(o.p1)}else if(arguments.length===2)this.p0=arguments[0],this.p1=arguments[1];else if(arguments.length===4){var u=arguments[0],v=arguments[1],y=arguments[2],b=arguments[3];this.p0=new Y(u,v),this.p1=new Y(y,b)}},wl={serialVersionUID:{configurable:!0}};On.prototype.minX=function(){return Math.min(this.p0.x,this.p1.x)},On.prototype.orientationIndex=function(){if(arguments[0]instanceof On){var o=arguments[0],u=Pt.orientationIndex(this.p0,this.p1,o.p0),v=Pt.orientationIndex(this.p0,this.p1,o.p1);return u>=0&&v>=0||u<=0&&v<=0?Math.max(u,v):0}if(arguments[0]instanceof Y){var y=arguments[0];return Pt.orientationIndex(this.p0,this.p1,y)}},On.prototype.toGeometry=function(o){return o.createLineString([this.p0,this.p1])},On.prototype.isVertical=function(){return this.p0.x===this.p1.x},On.prototype.equals=function(o){if(!(o instanceof On))return!1;var u=o;return this.p0.equals(u.p0)&&this.p1.equals(u.p1)},On.prototype.intersection=function(o){var u=new Qe;return u.computeIntersection(this.p0,this.p1,o.p0,o.p1),u.hasIntersection()?u.getIntersection(0):null},On.prototype.project=function(){if(arguments[0]instanceof Y){var o=arguments[0];if(o.equals(this.p0)||o.equals(this.p1))return new Y(o);var u=this.projectionFactor(o),v=new Y;return v.x=this.p0.x+u*(this.p1.x-this.p0.x),v.y=this.p0.y+u*(this.p1.y-this.p0.y),v}if(arguments[0]instanceof On){var y=arguments[0],b=this.projectionFactor(y.p0),H=this.projectionFactor(y.p1);if(b>=1&&H>=1||b<=0&&H<=0)return null;var ne=this.project(y.p0);b<0&&(ne=this.p0),b>1&&(ne=this.p1);var Le=this.project(y.p1);return H<0&&(Le=this.p0),H>1&&(Le=this.p1),new On(ne,Le)}},On.prototype.normalize=function(){this.p1.compareTo(this.p0)<0&&this.reverse()},On.prototype.angle=function(){return Math.atan2(this.p1.y-this.p0.y,this.p1.x-this.p0.x)},On.prototype.getCoordinate=function(o){return o===0?this.p0:this.p1},On.prototype.distancePerpendicular=function(o){return Pt.distancePointLinePerpendicular(o,this.p0,this.p1)},On.prototype.minY=function(){return Math.min(this.p0.y,this.p1.y)},On.prototype.midPoint=function(){return On.midPoint(this.p0,this.p1)},On.prototype.projectionFactor=function(o){if(o.equals(this.p0))return 0;if(o.equals(this.p1))return 1;var u=this.p1.x-this.p0.x,v=this.p1.y-this.p0.y,y=u*u+v*v;return y<=0?ce.NaN:((o.x-this.p0.x)*u+(o.y-this.p0.y)*v)/y},On.prototype.closestPoints=function(o){var u=this.intersection(o);if(u!==null)return[u,u];var v=new Array(2).fill(null),y=ce.MAX_VALUE,b=null,H=this.closestPoint(o.p0);y=H.distance(o.p0),v[0]=H,v[1]=o.p0;var ne=this.closestPoint(o.p1);(b=ne.distance(o.p1))<y&&(y=b,v[0]=ne,v[1]=o.p1);var Le=o.closestPoint(this.p0);(b=Le.distance(this.p0))<y&&(y=b,v[0]=this.p0,v[1]=Le);var tt=o.closestPoint(this.p1);return(b=tt.distance(this.p1))<y&&(y=b,v[0]=this.p1,v[1]=tt),v},On.prototype.closestPoint=function(o){var u=this.projectionFactor(o);return u>0&&u<1?this.project(o):this.p0.distance(o)<this.p1.distance(o)?this.p0:this.p1},On.prototype.maxX=function(){return Math.max(this.p0.x,this.p1.x)},On.prototype.getLength=function(){return this.p0.distance(this.p1)},On.prototype.compareTo=function(o){var u=o,v=this.p0.compareTo(u.p0);return v!==0?v:this.p1.compareTo(u.p1)},On.prototype.reverse=function(){var o=this.p0;this.p0=this.p1,this.p1=o},On.prototype.equalsTopo=function(o){return this.p0.equals(o.p0)&&(this.p1.equals(o.p1)||this.p0.equals(o.p1))&&this.p1.equals(o.p0)},On.prototype.lineIntersection=function(o){try{return tn.intersection(this.p0,this.p1,o.p0,o.p1)}catch(u){if(!(u instanceof Ir))throw u}return null},On.prototype.maxY=function(){return Math.max(this.p0.y,this.p1.y)},On.prototype.pointAlongOffset=function(o,u){var v=this.p0.x+o*(this.p1.x-this.p0.x),y=this.p0.y+o*(this.p1.y-this.p0.y),b=this.p1.x-this.p0.x,H=this.p1.y-this.p0.y,ne=Math.sqrt(b*b+H*H),Le=0,tt=0;if(u!==0){if(ne<=0)throw new Error("Cannot compute offset from zero-length line segment");Le=u*b/ne,tt=u*H/ne}return new Y(v-tt,y+Le)},On.prototype.setCoordinates=function(){if(arguments.length===1){var o=arguments[0];this.setCoordinates(o.p0,o.p1)}else if(arguments.length===2){var u=arguments[0],v=arguments[1];this.p0.x=u.x,this.p0.y=u.y,this.p1.x=v.x,this.p1.y=v.y}},On.prototype.segmentFraction=function(o){var u=this.projectionFactor(o);return u<0?u=0:(u>1||ce.isNaN(u))&&(u=1),u},On.prototype.toString=function(){return"LINESTRING( "+this.p0.x+" "+this.p0.y+", "+this.p1.x+" "+this.p1.y+")"},On.prototype.isHorizontal=function(){return this.p0.y===this.p1.y},On.prototype.distance=function(){if(arguments[0]instanceof On){var o=arguments[0];return Pt.distanceLineLine(this.p0,this.p1,o.p0,o.p1)}if(arguments[0]instanceof Y){var u=arguments[0];return Pt.distancePointLine(u,this.p0,this.p1)}},On.prototype.pointAlong=function(o){var u=new Y;return u.x=this.p0.x+o*(this.p1.x-this.p0.x),u.y=this.p0.y+o*(this.p1.y-this.p0.y),u},On.prototype.hashCode=function(){var o=ce.doubleToLongBits(this.p0.x);o^=31*ce.doubleToLongBits(this.p0.y);var u=Math.trunc(o)^Math.trunc(o>>32),v=ce.doubleToLongBits(this.p1.x);return v^=31*ce.doubleToLongBits(this.p1.y),u^(Math.trunc(v)^Math.trunc(v>>32))},On.prototype.interfaces_=function(){return[Ee,I]},On.prototype.getClass=function(){return On},On.midPoint=function(o,u){return new Y((o.x+u.x)/2,(o.y+u.y)/2)},wl.serialVersionUID.get=function(){return 0x2d2172135f411c00},Object.defineProperties(On,wl);var fc=function(){this.tempEnv1=new Mr,this.tempEnv2=new Mr,this._overlapSeg1=new On,this._overlapSeg2=new On};fc.prototype.overlap=function(){if(arguments.length!==2){if(arguments.length===4){var o=arguments[0],u=arguments[1],v=arguments[2],y=arguments[3];o.getLineSegment(u,this._overlapSeg1),v.getLineSegment(y,this._overlapSeg2),this.overlap(this._overlapSeg1,this._overlapSeg2)}}},fc.prototype.interfaces_=function(){return[]},fc.prototype.getClass=function(){return fc};var is=function(){this._pts=null,this._start=null,this._end=null,this._env=null,this._context=null,this._id=null;var o=arguments[0],u=arguments[1],v=arguments[2],y=arguments[3];this._pts=o,this._start=u,this._end=v,this._context=y};is.prototype.getLineSegment=function(o,u){u.p0=this._pts[o],u.p1=this._pts[o+1]},is.prototype.computeSelect=function(o,u,v,y){var b=this._pts[u],H=this._pts[v];if(y.tempEnv1.init(b,H),v-u==1)return y.select(this,u),null;if(!o.intersects(y.tempEnv1))return null;var ne=Math.trunc((u+v)/2);u<ne&&this.computeSelect(o,u,ne,y),ne<v&&this.computeSelect(o,ne,v,y)},is.prototype.getCoordinates=function(){for(var o=new Array(this._end-this._start+1).fill(null),u=0,v=this._start;v<=this._end;v++)o[u++]=this._pts[v];return o},is.prototype.computeOverlaps=function(o,u){this.computeOverlapsInternal(this._start,this._end,o,o._start,o._end,u)},is.prototype.setId=function(o){this._id=o},is.prototype.select=function(o,u){this.computeSelect(o,this._start,this._end,u)},is.prototype.getEnvelope=function(){if(this._env===null){var o=this._pts[this._start],u=this._pts[this._end];this._env=new Mr(o,u)}return this._env},is.prototype.getEndIndex=function(){return this._end},is.prototype.getStartIndex=function(){return this._start},is.prototype.getContext=function(){return this._context},is.prototype.getId=function(){return this._id},is.prototype.computeOverlapsInternal=function(o,u,v,y,b,H){var ne=this._pts[o],Le=this._pts[u],tt=v._pts[y],Nt=v._pts[b];if(u-o==1&&b-y==1)return H.overlap(this,o,v,y),null;if(H.tempEnv1.init(ne,Le),H.tempEnv2.init(tt,Nt),!H.tempEnv1.intersects(H.tempEnv2))return null;var ar=Math.trunc((o+u)/2),st=Math.trunc((y+b)/2);o<ar&&(y<st&&this.computeOverlapsInternal(o,ar,v,y,st,H),st<b&&this.computeOverlapsInternal(o,ar,v,st,b,H)),ar<u&&(y<st&&this.computeOverlapsInternal(ar,u,v,y,st,H),st<b&&this.computeOverlapsInternal(ar,u,v,st,b,H))},is.prototype.interfaces_=function(){return[]},is.prototype.getClass=function(){return is};var cu=function(){};cu.prototype.interfaces_=function(){return[]},cu.prototype.getClass=function(){return cu},cu.getChainStartIndices=function(o){var u=0,v=new Wr;v.add(new ke(u));do{var y=cu.findChainEnd(o,u);v.add(new ke(y)),u=y}while(u<o.length-1);return cu.toIntArray(v)},cu.findChainEnd=function(o,u){for(var v=u;v<o.length-1&&o[v].equals2D(o[v+1]);)v++;if(v>=o.length-1)return o.length-1;for(var y=ca.quadrant(o[v],o[v+1]),b=u+1;b<o.length&&!(!o[b-1].equals2D(o[b])&&ca.quadrant(o[b-1],o[b])!==y);)b++;return b-1},cu.getChains=function(){if(arguments.length===1){var o=arguments[0];return cu.getChains(o,null)}if(arguments.length===2){for(var u=arguments[0],v=arguments[1],y=new Wr,b=cu.getChainStartIndices(u),H=0;H<b.length-1;H++){var ne=new is(u,b[H],b[H+1],v);y.add(ne)}return y}},cu.toIntArray=function(o){for(var u=new Array(o.size()).fill(null),v=0;v<u.length;v++)u[v]=o.get(v).intValue();return u};var Yl=function(){};Yl.prototype.computeNodes=function(o){},Yl.prototype.getNodedSubstrings=function(){},Yl.prototype.interfaces_=function(){return[]},Yl.prototype.getClass=function(){return Yl};var Fc=function(){if(this._segInt=null,arguments.length!==0){if(arguments.length===1){var o=arguments[0];this.setSegmentIntersector(o)}}};Fc.prototype.setSegmentIntersector=function(o){this._segInt=o},Fc.prototype.interfaces_=function(){return[Yl]},Fc.prototype.getClass=function(){return Fc};var nf=function(o){function u(y){y?o.call(this,y):o.call(this),this._monoChains=new Wr,this._index=new Pf,this._idCounter=0,this._nodedSegStrings=null,this._nOverlaps=0}o&&(u.__proto__=o),(u.prototype=Object.create(o&&o.prototype)).constructor=u;var v={SegmentOverlapAction:{configurable:!0}};return u.prototype.getMonotoneChains=function(){return this._monoChains},u.prototype.getNodedSubstrings=function(){return Ua.getNodedSubstrings(this._nodedSegStrings)},u.prototype.getIndex=function(){return this._index},u.prototype.add=function(y){for(var b=cu.getChains(y.getCoordinates(),y).iterator();b.hasNext();){var H=b.next();H.setId(this._idCounter++),this._index.insert(H.getEnvelope(),H),this._monoChains.add(H)}},u.prototype.computeNodes=function(y){this._nodedSegStrings=y;for(var b=y.iterator();b.hasNext();)this.add(b.next());this.intersectChains()},u.prototype.intersectChains=function(){for(var y=new m0(this._segInt),b=this._monoChains.iterator();b.hasNext();)for(var H=b.next(),ne=this._index.query(H.getEnvelope()).iterator();ne.hasNext();){var Le=ne.next();if(Le.getId()>H.getId()&&(H.computeOverlaps(Le,y),this._nOverlaps++),this._segInt.isDone())return null}},u.prototype.interfaces_=function(){return[]},u.prototype.getClass=function(){return u},v.SegmentOverlapAction.get=function(){return m0},Object.defineProperties(u,v),u}(Fc),m0=function(o){function u(){o.call(this),this._si=null;var v=arguments[0];this._si=v}return o&&(u.__proto__=o),u.prototype=Object.create(o&&o.prototype),u.prototype.constructor=u,u.prototype.overlap=function(){if(arguments.length!==4)return o.prototype.overlap.apply(this,arguments);var v=arguments[0],y=arguments[1],b=arguments[2],H=arguments[3],ne=v.getContext(),Le=b.getContext();this._si.processIntersections(ne,y,Le,H)},u.prototype.interfaces_=function(){return[]},u.prototype.getClass=function(){return u},u}(fc),Aa=function o(){if(this._quadrantSegments=o.DEFAULT_QUADRANT_SEGMENTS,this._endCapStyle=o.CAP_ROUND,this._joinStyle=o.JOIN_ROUND,this._mitreLimit=o.DEFAULT_MITRE_LIMIT,this._isSingleSided=!1,this._simplifyFactor=o.DEFAULT_SIMPLIFY_FACTOR,arguments.length!==0){if(arguments.length===1){var u=arguments[0];this.setQuadrantSegments(u)}else if(arguments.length===2){var v=arguments[0],y=arguments[1];this.setQuadrantSegments(v),this.setEndCapStyle(y)}else if(arguments.length===4){var b=arguments[0],H=arguments[1],ne=arguments[2],Le=arguments[3];this.setQuadrantSegments(b),this.setEndCapStyle(H),this.setJoinStyle(ne),this.setMitreLimit(Le)}}},Pa={CAP_ROUND:{configurable:!0},CAP_FLAT:{configurable:!0},CAP_SQUARE:{configurable:!0},JOIN_ROUND:{configurable:!0},JOIN_MITRE:{configurable:!0},JOIN_BEVEL:{configurable:!0},DEFAULT_QUADRANT_SEGMENTS:{configurable:!0},DEFAULT_MITRE_LIMIT:{configurable:!0},DEFAULT_SIMPLIFY_FACTOR:{configurable:!0}};Aa.prototype.getEndCapStyle=function(){return this._endCapStyle},Aa.prototype.isSingleSided=function(){return this._isSingleSided},Aa.prototype.setQuadrantSegments=function(o){this._quadrantSegments=o,this._quadrantSegments===0&&(this._joinStyle=Aa.JOIN_BEVEL),this._quadrantSegments<0&&(this._joinStyle=Aa.JOIN_MITRE,this._mitreLimit=Math.abs(this._quadrantSegments)),o<=0&&(this._quadrantSegments=1),this._joinStyle!==Aa.JOIN_ROUND&&(this._quadrantSegments=Aa.DEFAULT_QUADRANT_SEGMENTS)},Aa.prototype.getJoinStyle=function(){return this._joinStyle},Aa.prototype.setJoinStyle=function(o){this._joinStyle=o},Aa.prototype.setSimplifyFactor=function(o){this._simplifyFactor=o<0?0:o},Aa.prototype.getSimplifyFactor=function(){return this._simplifyFactor},Aa.prototype.getQuadrantSegments=function(){return this._quadrantSegments},Aa.prototype.setEndCapStyle=function(o){this._endCapStyle=o},Aa.prototype.getMitreLimit=function(){return this._mitreLimit},Aa.prototype.setMitreLimit=function(o){this._mitreLimit=o},Aa.prototype.setSingleSided=function(o){this._isSingleSided=o},Aa.prototype.interfaces_=function(){return[]},Aa.prototype.getClass=function(){return Aa},Aa.bufferDistanceError=function(o){var u=Math.PI/2/o;return 1-Math.cos(u/2)},Pa.CAP_ROUND.get=function(){return 1},Pa.CAP_FLAT.get=function(){return 2},Pa.CAP_SQUARE.get=function(){return 3},Pa.JOIN_ROUND.get=function(){return 1},Pa.JOIN_MITRE.get=function(){return 2},Pa.JOIN_BEVEL.get=function(){return 3},Pa.DEFAULT_QUADRANT_SEGMENTS.get=function(){return 8},Pa.DEFAULT_MITRE_LIMIT.get=function(){return 5},Pa.DEFAULT_SIMPLIFY_FACTOR.get=function(){return .01},Object.defineProperties(Aa,Pa);var ma=function(o){this._distanceTol=null,this._isDeleted=null,this._angleOrientation=Pt.COUNTERCLOCKWISE,this._inputLine=o||null},Bc={INIT:{configurable:!0},DELETE:{configurable:!0},KEEP:{configurable:!0},NUM_PTS_TO_CHECK:{configurable:!0}};ma.prototype.isDeletable=function(o,u,v,y){var b=this._inputLine[o],H=this._inputLine[u],ne=this._inputLine[v];return!!this.isConcave(b,H,ne)&&!!this.isShallow(b,H,ne,y)&&this.isShallowSampled(b,H,o,v,y)},ma.prototype.deleteShallowConcavities=function(){for(var o=1,u=this.findNextNonDeletedIndex(o),v=this.findNextNonDeletedIndex(u),y=!1;v<this._inputLine.length;){var b=!1;this.isDeletable(o,u,v,this._distanceTol)&&(this._isDeleted[u]=ma.DELETE,b=!0,y=!0),o=b?v:u,u=this.findNextNonDeletedIndex(o),v=this.findNextNonDeletedIndex(u)}return y},ma.prototype.isShallowConcavity=function(o,u,v,y){return Pt.computeOrientation(o,u,v)!==this._angleOrientation?!1:Pt.distancePointLine(u,o,v)<y},ma.prototype.isShallowSampled=function(o,u,v,y,b){var H=Math.trunc((y-v)/ma.NUM_PTS_TO_CHECK);H<=0&&(H=1);for(var ne=v;ne<y;ne+=H)if(!this.isShallow(o,u,this._inputLine[ne],b))return!1;return!0},ma.prototype.isConcave=function(o,u,v){var y=Pt.computeOrientation(o,u,v)===this._angleOrientation;return y},ma.prototype.simplify=function(o){this._distanceTol=Math.abs(o),o<0&&(this._angleOrientation=Pt.CLOCKWISE),this._isDeleted=new Array(this._inputLine.length).fill(null);var u=!1;do u=this.deleteShallowConcavities();while(u);return this.collapseLine()},ma.prototype.findNextNonDeletedIndex=function(o){for(var u=o+1;u<this._inputLine.length&&this._isDeleted[u]===ma.DELETE;)u++;return u},ma.prototype.isShallow=function(o,u,v,y){return Pt.distancePointLine(u,o,v)<y},ma.prototype.collapseLine=function(){for(var o=new Xo,u=0;u<this._inputLine.length;u++)this._isDeleted[u]!==ma.DELETE&&o.add(this._inputLine[u]);return o.toCoordinateArray()},ma.prototype.interfaces_=function(){return[]},ma.prototype.getClass=function(){return ma},ma.simplify=function(o,u){return new ma(o).simplify(u)},Bc.INIT.get=function(){return 0},Bc.DELETE.get=function(){return 1},Bc.KEEP.get=function(){return 1},Bc.NUM_PTS_TO_CHECK.get=function(){return 10},Object.defineProperties(ma,Bc);var ao=function(){this._ptList=null,this._precisionModel=null,this._minimimVertexDistance=0,this._ptList=new Wr},Qf={COORDINATE_ARRAY_TYPE:{configurable:!0}};ao.prototype.getCoordinates=function(){return this._ptList.toArray(ao.COORDINATE_ARRAY_TYPE)},ao.prototype.setPrecisionModel=function(o){this._precisionModel=o},ao.prototype.addPt=function(o){var u=new Y(o);if(this._precisionModel.makePrecise(u),this.isRedundant(u))return null;this._ptList.add(u)},ao.prototype.revere=function(){},ao.prototype.addPts=function(o,u){if(u)for(var v=0;v<o.length;v++)this.addPt(o[v]);else for(var y=o.length-1;y>=0;y--)this.addPt(o[y])},ao.prototype.isRedundant=function(o){if(this._ptList.size()<1)return!1;var u=this._ptList.get(this._ptList.size()-1);return o.distance(u)<this._minimimVertexDistance},ao.prototype.toString=function(){return new Ri().createLineString(this.getCoordinates()).toString()},ao.prototype.closeRing=function(){if(this._ptList.size()<1)return null;var o=new Y(this._ptList.get(0)),u=this._ptList.get(this._ptList.size()-1);if(o.equals(u))return null;this._ptList.add(o)},ao.prototype.setMinimumVertexDistance=function(o){this._minimimVertexDistance=o},ao.prototype.interfaces_=function(){return[]},ao.prototype.getClass=function(){return ao},Qf.COORDINATE_ARRAY_TYPE.get=function(){return new Array(0).fill(null)},Object.defineProperties(ao,Qf);var Ni=function(){},Yo={PI_TIMES_2:{configurable:!0},PI_OVER_2:{configurable:!0},PI_OVER_4:{configurable:!0},COUNTERCLOCKWISE:{configurable:!0},CLOCKWISE:{configurable:!0},NONE:{configurable:!0}};Ni.prototype.interfaces_=function(){return[]},Ni.prototype.getClass=function(){return Ni},Ni.toDegrees=function(o){return 180*o/Math.PI},Ni.normalize=function(o){for(;o>Math.PI;)o-=Ni.PI_TIMES_2;for(;o<=-Math.PI;)o+=Ni.PI_TIMES_2;return o},Ni.angle=function(){if(arguments.length===1){var o=arguments[0];return Math.atan2(o.y,o.x)}if(arguments.length===2){var u=arguments[0],v=arguments[1],y=v.x-u.x,b=v.y-u.y;return Math.atan2(b,y)}},Ni.isAcute=function(o,u,v){var y=o.x-u.x,b=o.y-u.y;return y*(v.x-u.x)+b*(v.y-u.y)>0},Ni.isObtuse=function(o,u,v){var y=o.x-u.x,b=o.y-u.y;return y*(v.x-u.x)+b*(v.y-u.y)<0},Ni.interiorAngle=function(o,u,v){var y=Ni.angle(u,o),b=Ni.angle(u,v);return Math.abs(b-y)},Ni.normalizePositive=function(o){if(o<0){for(;o<0;)o+=Ni.PI_TIMES_2;o>=Ni.PI_TIMES_2&&(o=0)}else{for(;o>=Ni.PI_TIMES_2;)o-=Ni.PI_TIMES_2;o<0&&(o=0)}return o},Ni.angleBetween=function(o,u,v){var y=Ni.angle(u,o),b=Ni.angle(u,v);return Ni.diff(y,b)},Ni.diff=function(o,u){var v=null;return(v=o<u?u-o:o-u)>Math.PI&&(v=2*Math.PI-v),v},Ni.toRadians=function(o){return o*Math.PI/180},Ni.getTurn=function(o,u){var v=Math.sin(u-o);return v>0?Ni.COUNTERCLOCKWISE:v<0?Ni.CLOCKWISE:Ni.NONE},Ni.angleBetweenOriented=function(o,u,v){var y=Ni.angle(u,o),b=Ni.angle(u,v)-y;return b<=-Math.PI?b+Ni.PI_TIMES_2:b>Math.PI?b-Ni.PI_TIMES_2:b},Yo.PI_TIMES_2.get=function(){return 2*Math.PI},Yo.PI_OVER_2.get=function(){return Math.PI/2},Yo.PI_OVER_4.get=function(){return Math.PI/4},Yo.COUNTERCLOCKWISE.get=function(){return Pt.COUNTERCLOCKWISE},Yo.CLOCKWISE.get=function(){return Pt.CLOCKWISE},Yo.NONE.get=function(){return Pt.COLLINEAR},Object.defineProperties(Ni,Yo);var Sa=function o(){this._maxCurveSegmentError=0,this._filletAngleQuantum=null,this._closingSegLengthFactor=1,this._segList=null,this._distance=0,this._precisionModel=null,this._bufParams=null,this._li=null,this._s0=null,this._s1=null,this._s2=null,this._seg0=new On,this._seg1=new On,this._offset0=new On,this._offset1=new On,this._side=0,this._hasNarrowConcaveAngle=!1;var u=arguments[0],v=arguments[1],y=arguments[2];this._precisionModel=u,this._bufParams=v,this._li=new Qe,this._filletAngleQuantum=Math.PI/2/v.getQuadrantSegments(),v.getQuadrantSegments()>=8&&v.getJoinStyle()===Aa.JOIN_ROUND&&(this._closingSegLengthFactor=o.MAX_CLOSING_SEG_LEN_FACTOR),this.init(y)},Iu={OFFSET_SEGMENT_SEPARATION_FACTOR:{configurable:!0},INSIDE_TURN_VERTEX_SNAP_DISTANCE_FACTOR:{configurable:!0},CURVE_VERTEX_SNAP_DISTANCE_FACTOR:{configurable:!0},MAX_CLOSING_SEG_LEN_FACTOR:{configurable:!0}};Sa.prototype.addNextSegment=function(o,u){if(this._s0=this._s1,this._s1=this._s2,this._s2=o,this._seg0.setCoordinates(this._s0,this._s1),this.computeOffsetSegment(this._seg0,this._side,this._distance,this._offset0),this._seg1.setCoordinates(this._s1,this._s2),this.computeOffsetSegment(this._seg1,this._side,this._distance,this._offset1),this._s1.equals(this._s2))return null;var v=Pt.computeOrientation(this._s0,this._s1,this._s2),y=v===Pt.CLOCKWISE&&this._side===fe.LEFT||v===Pt.COUNTERCLOCKWISE&&this._side===fe.RIGHT;v===0?this.addCollinear(u):y?this.addOutsideTurn(v,u):this.addInsideTurn(v,u)},Sa.prototype.addLineEndCap=function(o,u){var v=new On(o,u),y=new On;this.computeOffsetSegment(v,fe.LEFT,this._distance,y);var b=new On;this.computeOffsetSegment(v,fe.RIGHT,this._distance,b);var H=u.x-o.x,ne=u.y-o.y,Le=Math.atan2(ne,H);switch(this._bufParams.getEndCapStyle()){case Aa.CAP_ROUND:this._segList.addPt(y.p1),this.addFilletArc(u,Le+Math.PI/2,Le-Math.PI/2,Pt.CLOCKWISE,this._distance),this._segList.addPt(b.p1);break;case Aa.CAP_FLAT:this._segList.addPt(y.p1),this._segList.addPt(b.p1);break;case Aa.CAP_SQUARE:var tt=new Y;tt.x=Math.abs(this._distance)*Math.cos(Le),tt.y=Math.abs(this._distance)*Math.sin(Le);var Nt=new Y(y.p1.x+tt.x,y.p1.y+tt.y),ar=new Y(b.p1.x+tt.x,b.p1.y+tt.y);this._segList.addPt(Nt),this._segList.addPt(ar)}},Sa.prototype.getCoordinates=function(){return this._segList.getCoordinates()},Sa.prototype.addMitreJoin=function(o,u,v,y){var b=!0,H=null;try{H=tn.intersection(u.p0,u.p1,v.p0,v.p1),(y<=0?1:H.distance(o)/Math.abs(y))>this._bufParams.getMitreLimit()&&(b=!1)}catch(ne){if(!(ne instanceof Ir))throw ne;H=new Y(0,0),b=!1}b?this._segList.addPt(H):this.addLimitedMitreJoin(u,v,y,this._bufParams.getMitreLimit())},Sa.prototype.addFilletCorner=function(o,u,v,y,b){var H=u.x-o.x,ne=u.y-o.y,Le=Math.atan2(ne,H),tt=v.x-o.x,Nt=v.y-o.y,ar=Math.atan2(Nt,tt);y===Pt.CLOCKWISE?Le<=ar&&(Le+=2*Math.PI):Le>=ar&&(Le-=2*Math.PI),this._segList.addPt(u),this.addFilletArc(o,Le,ar,y,b),this._segList.addPt(v)},Sa.prototype.addOutsideTurn=function(o,u){if(this._offset0.p1.distance(this._offset1.p0)<this._distance*Sa.OFFSET_SEGMENT_SEPARATION_FACTOR)return this._segList.addPt(this._offset0.p1),null;this._bufParams.getJoinStyle()===Aa.JOIN_MITRE?this.addMitreJoin(this._s1,this._offset0,this._offset1,this._distance):this._bufParams.getJoinStyle()===Aa.JOIN_BEVEL?this.addBevelJoin(this._offset0,this._offset1):(u&&this._segList.addPt(this._offset0.p1),this.addFilletCorner(this._s1,this._offset0.p1,this._offset1.p0,o,this._distance),this._segList.addPt(this._offset1.p0))},Sa.prototype.createSquare=function(o){this._segList.addPt(new Y(o.x+this._distance,o.y+this._distance)),this._segList.addPt(new Y(o.x+this._distance,o.y-this._distance)),this._segList.addPt(new Y(o.x-this._distance,o.y-this._distance)),this._segList.addPt(new Y(o.x-this._distance,o.y+this._distance)),this._segList.closeRing()},Sa.prototype.addSegments=function(o,u){this._segList.addPts(o,u)},Sa.prototype.addFirstSegment=function(){this._segList.addPt(this._offset1.p0)},Sa.prototype.addLastSegment=function(){this._segList.addPt(this._offset1.p1)},Sa.prototype.initSideSegments=function(o,u,v){this._s1=o,this._s2=u,this._side=v,this._seg1.setCoordinates(o,u),this.computeOffsetSegment(this._seg1,v,this._distance,this._offset1)},Sa.prototype.addLimitedMitreJoin=function(o,u,v,y){var b=this._seg0.p1,H=Ni.angle(b,this._seg0.p0),ne=Ni.angleBetweenOriented(this._seg0.p0,b,this._seg1.p1)/2,Le=Ni.normalize(H+ne),tt=Ni.normalize(Le+Math.PI),Nt=y*v,ar=v-Nt*Math.abs(Math.sin(ne)),st=b.x+Nt*Math.cos(tt),Gt=b.y+Nt*Math.sin(tt),ir=new Y(st,Gt),br=new On(b,ir),g=br.pointAlongOffset(1,ar),Bn=br.pointAlongOffset(1,-ar);this._side===fe.LEFT?(this._segList.addPt(g),this._segList.addPt(Bn)):(this._segList.addPt(Bn),this._segList.addPt(g))},Sa.prototype.computeOffsetSegment=function(o,u,v,y){var b=u===fe.LEFT?1:-1,H=o.p1.x-o.p0.x,ne=o.p1.y-o.p0.y,Le=Math.sqrt(H*H+ne*ne),tt=b*v*H/Le,Nt=b*v*ne/Le;y.p0.x=o.p0.x-Nt,y.p0.y=o.p0.y+tt,y.p1.x=o.p1.x-Nt,y.p1.y=o.p1.y+tt},Sa.prototype.addFilletArc=function(o,u,v,y,b){var H=y===Pt.CLOCKWISE?-1:1,ne=Math.abs(u-v),Le=Math.trunc(ne/this._filletAngleQuantum+.5);if(Le<1)return null;for(var tt=ne/Le,Nt=0,ar=new Y;Nt<ne;){var st=u+H*Nt;ar.x=o.x+b*Math.cos(st),ar.y=o.y+b*Math.sin(st),this._segList.addPt(ar),Nt+=tt}},Sa.prototype.addInsideTurn=function(o,u){if(this._li.computeIntersection(this._offset0.p0,this._offset0.p1,this._offset1.p0,this._offset1.p1),this._li.hasIntersection())this._segList.addPt(this._li.getIntersection(0));else if(this._hasNarrowConcaveAngle=!0,this._offset0.p1.distance(this._offset1.p0)<this._distance*Sa.INSIDE_TURN_VERTEX_SNAP_DISTANCE_FACTOR)this._segList.addPt(this._offset0.p1);else{if(this._segList.addPt(this._offset0.p1),this._closingSegLengthFactor>0){var v=new Y((this._closingSegLengthFactor*this._offset0.p1.x+this._s1.x)/(this._closingSegLengthFactor+1),(this._closingSegLengthFactor*this._offset0.p1.y+this._s1.y)/(this._closingSegLengthFactor+1));this._segList.addPt(v);var y=new Y((this._closingSegLengthFactor*this._offset1.p0.x+this._s1.x)/(this._closingSegLengthFactor+1),(this._closingSegLengthFactor*this._offset1.p0.y+this._s1.y)/(this._closingSegLengthFactor+1));this._segList.addPt(y)}else this._segList.addPt(this._s1);this._segList.addPt(this._offset1.p0)}},Sa.prototype.createCircle=function(o){var u=new Y(o.x+this._distance,o.y);this._segList.addPt(u),this.addFilletArc(o,0,2*Math.PI,-1,this._distance),this._segList.closeRing()},Sa.prototype.addBevelJoin=function(o,u){this._segList.addPt(o.p1),this._segList.addPt(u.p0)},Sa.prototype.init=function(o){this._distance=o,this._maxCurveSegmentError=o*(1-Math.cos(this._filletAngleQuantum/2)),this._segList=new ao,this._segList.setPrecisionModel(this._precisionModel),this._segList.setMinimumVertexDistance(o*Sa.CURVE_VERTEX_SNAP_DISTANCE_FACTOR)},Sa.prototype.addCollinear=function(o){this._li.computeIntersection(this._s0,this._s1,this._s1,this._s2),this._li.getIntersectionNum()>=2&&(this._bufParams.getJoinStyle()===Aa.JOIN_BEVEL||this._bufParams.getJoinStyle()===Aa.JOIN_MITRE?(o&&this._segList.addPt(this._offset0.p1),this._segList.addPt(this._offset1.p0)):this.addFilletCorner(this._s1,this._offset0.p1,this._offset1.p0,Pt.CLOCKWISE,this._distance))},Sa.prototype.closeRing=function(){this._segList.closeRing()},Sa.prototype.hasNarrowConcaveAngle=function(){return this._hasNarrowConcaveAngle},Sa.prototype.interfaces_=function(){return[]},Sa.prototype.getClass=function(){return Sa},Iu.OFFSET_SEGMENT_SEPARATION_FACTOR.get=function(){return .001},Iu.INSIDE_TURN_VERTEX_SNAP_DISTANCE_FACTOR.get=function(){return .001},Iu.CURVE_VERTEX_SNAP_DISTANCE_FACTOR.get=function(){return 1e-6},Iu.MAX_CLOSING_SEG_LEN_FACTOR.get=function(){return 80},Object.defineProperties(Sa,Iu);var Ra=function(){this._distance=0,this._precisionModel=null,this._bufParams=null;var o=arguments[0],u=arguments[1];this._precisionModel=o,this._bufParams=u};Ra.prototype.getOffsetCurve=function(o,u){if(this._distance=u,u===0)return null;var v=u<0,y=Math.abs(u),b=this.getSegGen(y);o.length<=1?this.computePointCurve(o[0],b):this.computeOffsetCurve(o,v,b);var H=b.getCoordinates();return v&&Xn.reverse(H),H},Ra.prototype.computeSingleSidedBufferCurve=function(o,u,v){var y=this.simplifyTolerance(this._distance);if(u){v.addSegments(o,!0);var b=ma.simplify(o,-y),H=b.length-1;v.initSideSegments(b[H],b[H-1],fe.LEFT),v.addFirstSegment();for(var ne=H-2;ne>=0;ne--)v.addNextSegment(b[ne],!0)}else{v.addSegments(o,!1);var Le=ma.simplify(o,y),tt=Le.length-1;v.initSideSegments(Le[0],Le[1],fe.LEFT),v.addFirstSegment();for(var Nt=2;Nt<=tt;Nt++)v.addNextSegment(Le[Nt],!0)}v.addLastSegment(),v.closeRing()},Ra.prototype.computeRingBufferCurve=function(o,u,v){var y=this.simplifyTolerance(this._distance);u===fe.RIGHT&&(y=-y);var b=ma.simplify(o,y),H=b.length-1;v.initSideSegments(b[H-1],b[0],u);for(var ne=1;ne<=H;ne++){var Le=ne!==1;v.addNextSegment(b[ne],Le)}v.closeRing()},Ra.prototype.computeLineBufferCurve=function(o,u){var v=this.simplifyTolerance(this._distance),y=ma.simplify(o,v),b=y.length-1;u.initSideSegments(y[0],y[1],fe.LEFT);for(var H=2;H<=b;H++)u.addNextSegment(y[H],!0);u.addLastSegment(),u.addLineEndCap(y[b-1],y[b]);var ne=ma.simplify(o,-v),Le=ne.length-1;u.initSideSegments(ne[Le],ne[Le-1],fe.LEFT);for(var tt=Le-2;tt>=0;tt--)u.addNextSegment(ne[tt],!0);u.addLastSegment(),u.addLineEndCap(ne[1],ne[0]),u.closeRing()},Ra.prototype.computePointCurve=function(o,u){switch(this._bufParams.getEndCapStyle()){case Aa.CAP_ROUND:u.createCircle(o);break;case Aa.CAP_SQUARE:u.createSquare(o)}},Ra.prototype.getLineCurve=function(o,u){if(this._distance=u,u<0&&!this._bufParams.isSingleSided()||u===0)return null;var v=Math.abs(u),y=this.getSegGen(v);if(o.length<=1)this.computePointCurve(o[0],y);else if(this._bufParams.isSingleSided()){var b=u<0;this.computeSingleSidedBufferCurve(o,b,y)}else this.computeLineBufferCurve(o,y);return y.getCoordinates()},Ra.prototype.getBufferParameters=function(){return this._bufParams},Ra.prototype.simplifyTolerance=function(o){return o*this._bufParams.getSimplifyFactor()},Ra.prototype.getRingCurve=function(o,u,v){if(this._distance=v,o.length<=2)return this.getLineCurve(o,v);if(v===0)return Ra.copyCoordinates(o);var y=this.getSegGen(v);return this.computeRingBufferCurve(o,u,y),y.getCoordinates()},Ra.prototype.computeOffsetCurve=function(o,u,v){var y=this.simplifyTolerance(this._distance);if(u){var b=ma.simplify(o,-y),H=b.length-1;v.initSideSegments(b[H],b[H-1],fe.LEFT),v.addFirstSegment();for(var ne=H-2;ne>=0;ne--)v.addNextSegment(b[ne],!0)}else{var Le=ma.simplify(o,y),tt=Le.length-1;v.initSideSegments(Le[0],Le[1],fe.LEFT),v.addFirstSegment();for(var Nt=2;Nt<=tt;Nt++)v.addNextSegment(Le[Nt],!0)}v.addLastSegment()},Ra.prototype.getSegGen=function(o){return new Sa(this._precisionModel,this._bufParams,o)},Ra.prototype.interfaces_=function(){return[]},Ra.prototype.getClass=function(){return Ra},Ra.copyCoordinates=function(o){for(var u=new Array(o.length).fill(null),v=0;v<u.length;v++)u[v]=new Y(o[v]);return u};var Bs=function(){this._subgraphs=null,this._seg=new On,this._cga=new Pt;var o=arguments[0];this._subgraphs=o},af={DepthSegment:{configurable:!0}};Bs.prototype.findStabbedSegments=function(){if(arguments.length===1){for(var o=arguments[0],u=new Wr,v=this._subgraphs.iterator();v.hasNext();){var y=v.next(),b=y.getEnvelope();o.y<b.getMinY()||o.y>b.getMaxY()||this.findStabbedSegments(o,y.getDirectedEdges(),u)}return u}if(arguments.length===3){if(Pe(arguments[2],ja)&&arguments[0]instanceof Y&&arguments[1]instanceof Lc){for(var H=arguments[0],ne=arguments[1],Le=arguments[2],tt=ne.getEdge().getCoordinates(),Nt=0;Nt<tt.length-1;Nt++)if(this._seg.p0=tt[Nt],this._seg.p1=tt[Nt+1],this._seg.p0.y>this._seg.p1.y&&this._seg.reverse(),!(Math.max(this._seg.p0.x,this._seg.p1.x)<H.x)&&!(this._seg.isHorizontal()||H.y<this._seg.p0.y||H.y>this._seg.p1.y||Pt.computeOrientation(this._seg.p0,this._seg.p1,H)===Pt.RIGHT)){var ar=ne.getDepth(fe.LEFT);this._seg.p0.equals(tt[Nt])||(ar=ne.getDepth(fe.RIGHT));var st=new Pu(this._seg,ar);Le.add(st)}}else if(Pe(arguments[2],ja)&&arguments[0]instanceof Y&&Pe(arguments[1],ja))for(var Gt=arguments[0],ir=arguments[1],br=arguments[2],g=ir.iterator();g.hasNext();){var Bn=g.next();Bn.isForward()&&this.findStabbedSegments(Gt,Bn,br)}}},Bs.prototype.getDepth=function(o){var u=this.findStabbedSegments(o);return u.size()===0?0:io.min(u)._leftDepth},Bs.prototype.interfaces_=function(){return[]},Bs.prototype.getClass=function(){return Bs},af.DepthSegment.get=function(){return Pu},Object.defineProperties(Bs,af);var Pu=function(){this._upwardSeg=null,this._leftDepth=null;var o=arguments[0],u=arguments[1];this._upwardSeg=new On(o),this._leftDepth=u};Pu.prototype.compareTo=function(o){var u=o;if(this._upwardSeg.minX()>=u._upwardSeg.maxX())return 1;if(this._upwardSeg.maxX()<=u._upwardSeg.minX())return-1;var v=this._upwardSeg.orientationIndex(u._upwardSeg);return v!==0||(v=-1*u._upwardSeg.orientationIndex(this._upwardSeg))!=0?v:this._upwardSeg.compareTo(u._upwardSeg)},Pu.prototype.compareX=function(o,u){var v=o.p0.compareTo(u.p0);return v!==0?v:o.p1.compareTo(u.p1)},Pu.prototype.toString=function(){return this._upwardSeg.toString()},Pu.prototype.interfaces_=function(){return[Ee]},Pu.prototype.getClass=function(){return Pu};var Gi=function(o,u,v){this.p0=o||null,this.p1=u||null,this.p2=v||null};Gi.prototype.area=function(){return Gi.area(this.p0,this.p1,this.p2)},Gi.prototype.signedArea=function(){return Gi.signedArea(this.p0,this.p1,this.p2)},Gi.prototype.interpolateZ=function(o){if(o===null)throw new Me("Supplied point is null.");return Gi.interpolateZ(o,this.p0,this.p1,this.p2)},Gi.prototype.longestSideLength=function(){return Gi.longestSideLength(this.p0,this.p1,this.p2)},Gi.prototype.isAcute=function(){return Gi.isAcute(this.p0,this.p1,this.p2)},Gi.prototype.circumcentre=function(){return Gi.circumcentre(this.p0,this.p1,this.p2)},Gi.prototype.area3D=function(){return Gi.area3D(this.p0,this.p1,this.p2)},Gi.prototype.centroid=function(){return Gi.centroid(this.p0,this.p1,this.p2)},Gi.prototype.inCentre=function(){return Gi.inCentre(this.p0,this.p1,this.p2)},Gi.prototype.interfaces_=function(){return[]},Gi.prototype.getClass=function(){return Gi},Gi.area=function(o,u,v){return Math.abs(((v.x-o.x)*(u.y-o.y)-(u.x-o.x)*(v.y-o.y))/2)},Gi.signedArea=function(o,u,v){return((v.x-o.x)*(u.y-o.y)-(u.x-o.x)*(v.y-o.y))/2},Gi.det=function(o,u,v,y){return o*y-u*v},Gi.interpolateZ=function(o,u,v,y){var b=u.x,H=u.y,ne=v.x-b,Le=y.x-b,tt=v.y-H,Nt=y.y-H,ar=ne*Nt-Le*tt,st=o.x-b,Gt=o.y-H,ir=(Nt*st-Le*Gt)/ar,br=(-tt*st+ne*Gt)/ar;return u.z+ir*(v.z-u.z)+br*(y.z-u.z)},Gi.longestSideLength=function(o,u,v){var y=o.distance(u),b=u.distance(v),H=v.distance(o),ne=y;return b>ne&&(ne=b),H>ne&&(ne=H),ne},Gi.isAcute=function(o,u,v){return!!Ni.isAcute(o,u,v)&&!!Ni.isAcute(u,v,o)&&!!Ni.isAcute(v,o,u)},Gi.circumcentre=function(o,u,v){var y=v.x,b=v.y,H=o.x-y,ne=o.y-b,Le=u.x-y,tt=u.y-b,Nt=2*Gi.det(H,ne,Le,tt),ar=Gi.det(ne,H*H+ne*ne,tt,Le*Le+tt*tt),st=Gi.det(H,H*H+ne*ne,Le,Le*Le+tt*tt);return new Y(y-ar/Nt,b+st/Nt)},Gi.perpendicularBisector=function(o,u){var v=u.x-o.x,y=u.y-o.y,b=new tn(o.x+v/2,o.y+y/2,1),H=new tn(o.x-y+v/2,o.y+v+y/2,1);return new tn(b,H)},Gi.angleBisector=function(o,u,v){var y=u.distance(o),b=y/(y+u.distance(v)),H=v.x-o.x,ne=v.y-o.y;return new Y(o.x+b*H,o.y+b*ne)},Gi.area3D=function(o,u,v){var y=u.x-o.x,b=u.y-o.y,H=u.z-o.z,ne=v.x-o.x,Le=v.y-o.y,tt=v.z-o.z,Nt=b*tt-H*Le,ar=H*ne-y*tt,st=y*Le-b*ne,Gt=Nt*Nt+ar*ar+st*st,ir=Math.sqrt(Gt)/2;return ir},Gi.centroid=function(o,u,v){var y=(o.x+u.x+v.x)/3,b=(o.y+u.y+v.y)/3;return new Y(y,b)},Gi.inCentre=function(o,u,v){var y=u.distance(v),b=o.distance(v),H=o.distance(u),ne=y+b+H,Le=(y*o.x+b*u.x+H*v.x)/ne,tt=(y*o.y+b*u.y+H*v.y)/ne;return new Y(Le,tt)};var $s=function(){this._inputGeom=null,this._distance=null,this._curveBuilder=null,this._curveList=new Wr;var o=arguments[0],u=arguments[1],v=arguments[2];this._inputGeom=o,this._distance=u,this._curveBuilder=v};$s.prototype.addPoint=function(o){if(this._distance<=0)return null;var u=o.getCoordinates(),v=this._curveBuilder.getLineCurve(u,this._distance);this.addCurve(v,ye.EXTERIOR,ye.INTERIOR)},$s.prototype.addPolygon=function(o){var u=this._distance,v=fe.LEFT;this._distance<0&&(u=-this._distance,v=fe.RIGHT);var y=o.getExteriorRing(),b=Xn.removeRepeatedPoints(y.getCoordinates());if(this._distance<0&&this.isErodedCompletely(y,this._distance)||this._distance<=0&&b.length<3)return null;this.addPolygonRing(b,u,v,ye.EXTERIOR,ye.INTERIOR);for(var H=0;H<o.getNumInteriorRing();H++){var ne=o.getInteriorRingN(H),Le=Xn.removeRepeatedPoints(ne.getCoordinates());this._distance>0&&this.isErodedCompletely(ne,-this._distance)||this.addPolygonRing(Le,u,fe.opposite(v),ye.INTERIOR,ye.EXTERIOR)}},$s.prototype.isTriangleErodedCompletely=function(o,u){var v=new Gi(o[0],o[1],o[2]),y=v.inCentre();return Pt.distancePointLine(y,v.p0,v.p1)<Math.abs(u)},$s.prototype.addLineString=function(o){if(this._distance<=0&&!this._curveBuilder.getBufferParameters().isSingleSided())return null;var u=Xn.removeRepeatedPoints(o.getCoordinates()),v=this._curveBuilder.getLineCurve(u,this._distance);this.addCurve(v,ye.EXTERIOR,ye.INTERIOR)},$s.prototype.addCurve=function(o,u,v){if(o===null||o.length<2)return null;var y=new Ua(o,new zn(0,ye.BOUNDARY,u,v));this._curveList.add(y)},$s.prototype.getCurves=function(){return this.add(this._inputGeom),this._curveList},$s.prototype.addPolygonRing=function(o,u,v,y,b){if(u===0&&o.length<cr.MINIMUM_VALID_SIZE)return null;var H=y,ne=b;o.length>=cr.MINIMUM_VALID_SIZE&&Pt.isCCW(o)&&(H=b,ne=y,v=fe.opposite(v));var Le=this._curveBuilder.getRingCurve(o,v,u);this.addCurve(Le,H,ne)},$s.prototype.add=function(o){if(o.isEmpty())return null;o instanceof ka?this.addPolygon(o):o instanceof Oa?this.addLineString(o):o instanceof Co?this.addPoint(o):o instanceof Ru?this.addCollection(o):o instanceof Qi?this.addCollection(o):o instanceof yn?this.addCollection(o):o instanceof rs&&this.addCollection(o)},$s.prototype.isErodedCompletely=function(o,u){var v=o.getCoordinates();if(v.length<4)return u<0;if(v.length===4)return this.isTriangleErodedCompletely(v,u);var y=o.getEnvelopeInternal(),b=Math.min(y.getHeight(),y.getWidth());return u<0&&2*Math.abs(u)>b},$s.prototype.addCollection=function(o){for(var u=0;u<o.getNumGeometries();u++){var v=o.getGeometryN(u);this.add(v)}},$s.prototype.interfaces_=function(){return[]},$s.prototype.getClass=function(){return $s};var Ou=function(){};Ou.prototype.locate=function(o){},Ou.prototype.interfaces_=function(){return[]},Ou.prototype.getClass=function(){return Ou};var as=function(){this._parent=null,this._atStart=null,this._max=null,this._index=null,this._subcollectionIterator=null;var o=arguments[0];this._parent=o,this._atStart=!0,this._index=0,this._max=o.getNumGeometries()};as.prototype.next=function(){if(this._atStart)return this._atStart=!1,as.isAtomic(this._parent)&&this._index++,this._parent;if(this._subcollectionIterator!==null){if(this._subcollectionIterator.hasNext())return this._subcollectionIterator.next();this._subcollectionIterator=null}if(this._index>=this._max)throw new G;var o=this._parent.getGeometryN(this._index++);return o instanceof rs?(this._subcollectionIterator=new as(o),this._subcollectionIterator.next()):o},as.prototype.remove=function(){throw new Error(this.getClass().getName())},as.prototype.hasNext=function(){if(this._atStart)return!0;if(this._subcollectionIterator!==null){if(this._subcollectionIterator.hasNext())return!0;this._subcollectionIterator=null}return!(this._index>=this._max)},as.prototype.interfaces_=function(){return[Ea]},as.prototype.getClass=function(){return as},as.isAtomic=function(o){return!(o instanceof rs)};var ks=function(){this._geom=null;var o=arguments[0];this._geom=o};ks.prototype.locate=function(o){return ks.locate(o,this._geom)},ks.prototype.interfaces_=function(){return[Ou]},ks.prototype.getClass=function(){return ks},ks.isPointInRing=function(o,u){return!!u.getEnvelopeInternal().intersects(o)&&Pt.isPointInRing(o,u.getCoordinates())},ks.containsPointInPolygon=function(o,u){if(u.isEmpty())return!1;var v=u.getExteriorRing();if(!ks.isPointInRing(o,v))return!1;for(var y=0;y<u.getNumInteriorRing();y++){var b=u.getInteriorRingN(y);if(ks.isPointInRing(o,b))return!1}return!0},ks.containsPoint=function(o,u){if(u instanceof ka)return ks.containsPointInPolygon(o,u);if(u instanceof rs)for(var v=new as(u);v.hasNext();){var y=v.next();if(y!==u&&ks.containsPoint(o,y))return!0}return!1},ks.locate=function(o,u){return u.isEmpty()?ye.EXTERIOR:ks.containsPoint(o,u)?ye.INTERIOR:ye.EXTERIOR};var Uo=function(){this._edgeMap=new Ce,this._edgeList=null,this._ptInAreaLocation=[ye.NONE,ye.NONE]};Uo.prototype.getNextCW=function(o){this.getEdges();var u=this._edgeList.indexOf(o),v=u-1;return u===0&&(v=this._edgeList.size()-1),this._edgeList.get(v)},Uo.prototype.propagateSideLabels=function(o){for(var u=ye.NONE,v=this.iterator();v.hasNext();){var y=v.next().getLabel();y.isArea(o)&&y.getLocation(o,fe.LEFT)!==ye.NONE&&(u=y.getLocation(o,fe.LEFT))}if(u===ye.NONE)return null;for(var b=u,H=this.iterator();H.hasNext();){var ne=H.next(),Le=ne.getLabel();if(Le.getLocation(o,fe.ON)===ye.NONE&&Le.setLocation(o,fe.ON,b),Le.isArea(o)){var tt=Le.getLocation(o,fe.LEFT),Nt=Le.getLocation(o,fe.RIGHT);if(Nt!==ye.NONE){if(Nt!==b)throw new Ht("side location conflict",ne.getCoordinate());tt===ye.NONE&&Ft.shouldNeverReachHere("found single null side (at "+ne.getCoordinate()+")"),b=tt}else Ft.isTrue(Le.getLocation(o,fe.LEFT)===ye.NONE,"found single null side"),Le.setLocation(o,fe.RIGHT,b),Le.setLocation(o,fe.LEFT,b)}}},Uo.prototype.getCoordinate=function(){var o=this.iterator();return o.hasNext()?o.next().getCoordinate():null},Uo.prototype.print=function(o){Qr.out.println("EdgeEndStar:   "+this.getCoordinate());for(var u=this.iterator();u.hasNext();)u.next().print(o)},Uo.prototype.isAreaLabelsConsistent=function(o){return this.computeEdgeEndLabels(o.getBoundaryNodeRule()),this.checkAreaLabelsConsistent(0)},Uo.prototype.checkAreaLabelsConsistent=function(o){var u=this.getEdges();if(u.size()<=0)return!0;var v=u.size()-1,y=u.get(v).getLabel().getLocation(o,fe.LEFT);Ft.isTrue(y!==ye.NONE,"Found unlabelled area edge");for(var b=y,H=this.iterator();H.hasNext();){var ne=H.next().getLabel();Ft.isTrue(ne.isArea(o),"Found non-area edge");var Le=ne.getLocation(o,fe.LEFT),tt=ne.getLocation(o,fe.RIGHT);if(Le===tt||tt!==b)return!1;b=Le}return!0},Uo.prototype.findIndex=function(o){this.iterator();for(var u=0;u<this._edgeList.size();u++)if(this._edgeList.get(u)===o)return u;return-1},Uo.prototype.iterator=function(){return this.getEdges().iterator()},Uo.prototype.getEdges=function(){return this._edgeList===null&&(this._edgeList=new Wr(this._edgeMap.values())),this._edgeList},Uo.prototype.getLocation=function(o,u,v){return this._ptInAreaLocation[o]===ye.NONE&&(this._ptInAreaLocation[o]=ks.locate(u,v[o].getGeometry())),this._ptInAreaLocation[o]},Uo.prototype.toString=function(){var o=new ue;o.append("EdgeEndStar:   "+this.getCoordinate()),o.append(`
`);for(var u=this.iterator();u.hasNext();){var v=u.next();o.append(v),o.append(`
`)}return o.toString()},Uo.prototype.computeEdgeEndLabels=function(o){for(var u=this.iterator();u.hasNext();)u.next().computeLabel(o)},Uo.prototype.computeLabelling=function(o){this.computeEdgeEndLabels(o[0].getBoundaryNodeRule()),this.propagateSideLabels(0),this.propagateSideLabels(1);for(var u=[!1,!1],v=this.iterator();v.hasNext();)for(var y=v.next().getLabel(),b=0;b<2;b++)y.isLine(b)&&y.getLocation(b)===ye.BOUNDARY&&(u[b]=!0);for(var H=this.iterator();H.hasNext();)for(var ne=H.next(),Le=ne.getLabel(),tt=0;tt<2;tt++)if(Le.isAnyNull(tt)){var Nt=ye.NONE;if(u[tt])Nt=ye.EXTERIOR;else{var ar=ne.getCoordinate();Nt=this.getLocation(tt,ar,o)}Le.setAllLocationsIfNull(tt,Nt)}},Uo.prototype.getDegree=function(){return this._edgeMap.size()},Uo.prototype.insertEdgeEnd=function(o,u){this._edgeMap.put(o,u),this._edgeList=null},Uo.prototype.interfaces_=function(){return[]},Uo.prototype.getClass=function(){return Uo};var Of=function(o){function u(){o.call(this),this._resultAreaEdgeList=null,this._label=null,this._SCANNING_FOR_INCOMING=1,this._LINKING_TO_OUTGOING=2}return o&&(u.__proto__=o),u.prototype=Object.create(o&&o.prototype),u.prototype.constructor=u,u.prototype.linkResultDirectedEdges=function(){this.getResultAreaEdges();for(var v=null,y=null,b=this._SCANNING_FOR_INCOMING,H=0;H<this._resultAreaEdgeList.size();H++){var ne=this._resultAreaEdgeList.get(H),Le=ne.getSym();if(ne.getLabel().isArea())switch(v===null&&ne.isInResult()&&(v=ne),b){case this._SCANNING_FOR_INCOMING:if(!Le.isInResult())continue;y=Le,b=this._LINKING_TO_OUTGOING;break;case this._LINKING_TO_OUTGOING:if(!ne.isInResult())continue;y.setNext(ne),b=this._SCANNING_FOR_INCOMING}}if(b===this._LINKING_TO_OUTGOING){if(v===null)throw new Ht("no outgoing dirEdge found",this.getCoordinate());Ft.isTrue(v.isInResult(),"unable to link last incoming dirEdge"),y.setNext(v)}},u.prototype.insert=function(v){var y=v;this.insertEdgeEnd(y,y)},u.prototype.getRightmostEdge=function(){var v=this.getEdges(),y=v.size();if(y<1)return null;var b=v.get(0);if(y===1)return b;var H=v.get(y-1),ne=b.getQuadrant(),Le=H.getQuadrant();return ca.isNorthern(ne)&&ca.isNorthern(Le)?b:ca.isNorthern(ne)||ca.isNorthern(Le)?b.getDy()!==0?b:H.getDy()!==0?H:(Ft.shouldNeverReachHere("found two horizontal edges incident on node"),null):H},u.prototype.print=function(v){Qr.out.println("DirectedEdgeStar: "+this.getCoordinate());for(var y=this.iterator();y.hasNext();){var b=y.next();v.print("out "),b.print(v),v.println(),v.print("in "),b.getSym().print(v),v.println()}},u.prototype.getResultAreaEdges=function(){if(this._resultAreaEdgeList!==null)return this._resultAreaEdgeList;this._resultAreaEdgeList=new Wr;for(var v=this.iterator();v.hasNext();){var y=v.next();(y.isInResult()||y.getSym().isInResult())&&this._resultAreaEdgeList.add(y)}return this._resultAreaEdgeList},u.prototype.updateLabelling=function(v){for(var y=this.iterator();y.hasNext();){var b=y.next().getLabel();b.setAllLocationsIfNull(0,v.getLocation(0)),b.setAllLocationsIfNull(1,v.getLocation(1))}},u.prototype.linkAllDirectedEdges=function(){this.getEdges();for(var v=null,y=null,b=this._edgeList.size()-1;b>=0;b--){var H=this._edgeList.get(b),ne=H.getSym();y===null&&(y=ne),v!==null&&ne.setNext(v),v=H}y.setNext(v)},u.prototype.computeDepths=function(){if(arguments.length===1){var v=arguments[0],y=this.findIndex(v),b=v.getDepth(fe.LEFT),H=v.getDepth(fe.RIGHT),ne=this.computeDepths(y+1,this._edgeList.size(),b);if(this.computeDepths(0,y,ne)!==H)throw new Ht("depth mismatch at "+v.getCoordinate())}else if(arguments.length===3){for(var Le=arguments[0],tt=arguments[1],Nt=arguments[2],ar=Le;ar<tt;ar++){var st=this._edgeList.get(ar);st.setEdgeDepths(fe.RIGHT,Nt),Nt=st.getDepth(fe.LEFT)}return Nt}},u.prototype.mergeSymLabels=function(){for(var v=this.iterator();v.hasNext();){var y=v.next();y.getLabel().merge(y.getSym().getLabel())}},u.prototype.linkMinimalDirectedEdges=function(v){for(var y=null,b=null,H=this._SCANNING_FOR_INCOMING,ne=this._resultAreaEdgeList.size()-1;ne>=0;ne--){var Le=this._resultAreaEdgeList.get(ne),tt=Le.getSym();switch(y===null&&Le.getEdgeRing()===v&&(y=Le),H){case this._SCANNING_FOR_INCOMING:if(tt.getEdgeRing()!==v)continue;b=tt,H=this._LINKING_TO_OUTGOING;break;case this._LINKING_TO_OUTGOING:if(Le.getEdgeRing()!==v)continue;b.setNextMin(Le),H=this._SCANNING_FOR_INCOMING}}H===this._LINKING_TO_OUTGOING&&(Ft.isTrue(y!==null,"found null for first outgoing dirEdge"),Ft.isTrue(y.getEdgeRing()===v,"unable to link last incoming dirEdge"),b.setNextMin(y))},u.prototype.getOutgoingDegree=function(){if(arguments.length===0){for(var v=0,y=this.iterator();y.hasNext();)y.next().isInResult()&&v++;return v}if(arguments.length===1){for(var b=arguments[0],H=0,ne=this.iterator();ne.hasNext();)ne.next().getEdgeRing()===b&&H++;return H}},u.prototype.getLabel=function(){return this._label},u.prototype.findCoveredLineEdges=function(){for(var v=ye.NONE,y=this.iterator();y.hasNext();){var b=y.next(),H=b.getSym();if(!b.isLineEdge()){if(b.isInResult()){v=ye.INTERIOR;break}if(H.isInResult()){v=ye.EXTERIOR;break}}}if(v===ye.NONE)return null;for(var ne=v,Le=this.iterator();Le.hasNext();){var tt=Le.next(),Nt=tt.getSym();tt.isLineEdge()?tt.getEdge().setCovered(ne===ye.INTERIOR):(tt.isInResult()&&(ne=ye.EXTERIOR),Nt.isInResult()&&(ne=ye.INTERIOR))}},u.prototype.computeLabelling=function(v){o.prototype.computeLabelling.call(this,v),this._label=new zn(ye.NONE);for(var y=this.iterator();y.hasNext();)for(var b=y.next().getEdge().getLabel(),H=0;H<2;H++){var ne=b.getLocation(H);ne!==ye.INTERIOR&&ne!==ye.BOUNDARY||this._label.setLocation(H,ye.INTERIOR)}},u.prototype.interfaces_=function(){return[]},u.prototype.getClass=function(){return u},u}(Uo),kc=function(o){function u(){o.apply(this,arguments)}return o&&(u.__proto__=o),u.prototype=Object.create(o&&o.prototype),u.prototype.constructor=u,u.prototype.createNode=function(v){return new If(v,new Of)},u.prototype.interfaces_=function(){return[]},u.prototype.getClass=function(){return u},u}(ol),Na=function o(){this._pts=null,this._orientation=null;var u=arguments[0];this._pts=u,this._orientation=o.orientation(u)};Na.prototype.compareTo=function(o){var u=o;return Na.compareOriented(this._pts,this._orientation,u._pts,u._orientation)},Na.prototype.interfaces_=function(){return[Ee]},Na.prototype.getClass=function(){return Na},Na.orientation=function(o){return Xn.increasingDirection(o)===1},Na.compareOriented=function(o,u,v,y){for(var b=u?1:-1,H=y?1:-1,ne=u?o.length:-1,Le=y?v.length:-1,tt=u?0:o.length-1,Nt=y?0:v.length-1;;){var ar=o[tt].compareTo(v[Nt]);if(ar!==0)return ar;var st=(tt+=b)===ne,Gt=(Nt+=H)===Le;if(st&&!Gt)return-1;if(!st&&Gt)return 1;if(st&&Gt)return 0}};var Mo=function(){this._edges=new Wr,this._ocaMap=new Ce};Mo.prototype.print=function(o){o.print("MULTILINESTRING ( ");for(var u=0;u<this._edges.size();u++){var v=this._edges.get(u);u>0&&o.print(","),o.print("(");for(var y=v.getCoordinates(),b=0;b<y.length;b++)b>0&&o.print(","),o.print(y[b].x+" "+y[b].y);o.println(")")}o.print(")  ")},Mo.prototype.addAll=function(o){for(var u=o.iterator();u.hasNext();)this.add(u.next())},Mo.prototype.findEdgeIndex=function(o){for(var u=0;u<this._edges.size();u++)if(this._edges.get(u).equals(o))return u;return-1},Mo.prototype.iterator=function(){return this._edges.iterator()},Mo.prototype.getEdges=function(){return this._edges},Mo.prototype.get=function(o){return this._edges.get(o)},Mo.prototype.findEqualEdge=function(o){var u=new Na(o.getCoordinates());return this._ocaMap.get(u)},Mo.prototype.add=function(o){this._edges.add(o);var u=new Na(o.getCoordinates());this._ocaMap.put(u,o)},Mo.prototype.interfaces_=function(){return[]},Mo.prototype.getClass=function(){return Mo};var Qs=function(){};Qs.prototype.processIntersections=function(o,u,v,y){},Qs.prototype.isDone=function(){},Qs.prototype.interfaces_=function(){return[]},Qs.prototype.getClass=function(){return Qs};var os=function(){this._hasIntersection=!1,this._hasProper=!1,this._hasProperInterior=!1,this._hasInterior=!1,this._properIntersectionPoint=null,this._li=null,this._isSelfIntersection=null,this.numIntersections=0,this.numInteriorIntersections=0,this.numProperIntersections=0,this.numTests=0;var o=arguments[0];this._li=o};os.prototype.isTrivialIntersection=function(o,u,v,y){if(o===v&&this._li.getIntersectionNum()===1){if(os.isAdjacentSegments(u,y))return!0;if(o.isClosed()){var b=o.size()-1;if(u===0&&y===b||y===0&&u===b)return!0}}return!1},os.prototype.getProperIntersectionPoint=function(){return this._properIntersectionPoint},os.prototype.hasProperInteriorIntersection=function(){return this._hasProperInterior},os.prototype.getLineIntersector=function(){return this._li},os.prototype.hasProperIntersection=function(){return this._hasProper},os.prototype.processIntersections=function(o,u,v,y){if(o===v&&u===y)return null;this.numTests++;var b=o.getCoordinates()[u],H=o.getCoordinates()[u+1],ne=v.getCoordinates()[y],Le=v.getCoordinates()[y+1];this._li.computeIntersection(b,H,ne,Le),this._li.hasIntersection()&&(this.numIntersections++,this._li.isInteriorIntersection()&&(this.numInteriorIntersections++,this._hasInterior=!0),this.isTrivialIntersection(o,u,v,y)||(this._hasIntersection=!0,o.addIntersections(this._li,u,0),v.addIntersections(this._li,y,1),this._li.isProper()&&(this.numProperIntersections++,this._hasProper=!0,this._hasProperInterior=!0)))},os.prototype.hasIntersection=function(){return this._hasIntersection},os.prototype.isDone=function(){return!1},os.prototype.hasInteriorIntersection=function(){return this._hasInterior},os.prototype.interfaces_=function(){return[Qs]},os.prototype.getClass=function(){return os},os.isAdjacentSegments=function(o,u){return Math.abs(o-u)===1};var ms=function(){this.coord=null,this.segmentIndex=null,this.dist=null;var o=arguments[0],u=arguments[1],v=arguments[2];this.coord=new Y(o),this.segmentIndex=u,this.dist=v};ms.prototype.getSegmentIndex=function(){return this.segmentIndex},ms.prototype.getCoordinate=function(){return this.coord},ms.prototype.print=function(o){o.print(this.coord),o.print(" seg # = "+this.segmentIndex),o.println(" dist = "+this.dist)},ms.prototype.compareTo=function(o){var u=o;return this.compare(u.segmentIndex,u.dist)},ms.prototype.isEndPoint=function(o){return this.segmentIndex===0&&this.dist===0||this.segmentIndex===o},ms.prototype.toString=function(){return this.coord+" seg # = "+this.segmentIndex+" dist = "+this.dist},ms.prototype.getDistance=function(){return this.dist},ms.prototype.compare=function(o,u){return this.segmentIndex<o?-1:this.segmentIndex>o?1:this.dist<u?-1:this.dist>u?1:0},ms.prototype.interfaces_=function(){return[Ee]},ms.prototype.getClass=function(){return ms};var Nu=function(){this._nodeMap=new Ce,this.edge=null;var o=arguments[0];this.edge=o};Nu.prototype.print=function(o){o.println("Intersections:");for(var u=this.iterator();u.hasNext();)u.next().print(o)},Nu.prototype.iterator=function(){return this._nodeMap.values().iterator()},Nu.prototype.addSplitEdges=function(o){this.addEndpoints();for(var u=this.iterator(),v=u.next();u.hasNext();){var y=u.next(),b=this.createSplitEdge(v,y);o.add(b),v=y}},Nu.prototype.addEndpoints=function(){var o=this.edge.pts.length-1;this.add(this.edge.pts[0],0,0),this.add(this.edge.pts[o],o,0)},Nu.prototype.createSplitEdge=function(o,u){var v=u.segmentIndex-o.segmentIndex+2,y=this.edge.pts[u.segmentIndex],b=u.dist>0||!u.coord.equals2D(y);b||v--;var H=new Array(v).fill(null),ne=0;H[ne++]=new Y(o.coord);for(var Le=o.segmentIndex+1;Le<=u.segmentIndex;Le++)H[ne++]=this.edge.pts[Le];return b&&(H[ne]=u.coord),new hc(H,new zn(this.edge._label))},Nu.prototype.add=function(o,u,v){var y=new ms(o,u,v),b=this._nodeMap.get(y);return b!==null?b:(this._nodeMap.put(y,y),y)},Nu.prototype.isIntersection=function(o){for(var u=this.iterator();u.hasNext();)if(u.next().coord.equals(o))return!0;return!1},Nu.prototype.interfaces_=function(){return[]},Nu.prototype.getClass=function(){return Nu};var yu=function(){};yu.prototype.getChainStartIndices=function(o){var u=0,v=new Wr;v.add(new ke(u));do{var y=this.findChainEnd(o,u);v.add(new ke(y)),u=y}while(u<o.length-1);return yu.toIntArray(v)},yu.prototype.findChainEnd=function(o,u){for(var v=ca.quadrant(o[u],o[u+1]),y=u+1;y<o.length&&ca.quadrant(o[y-1],o[y])===v;)y++;return y-1},yu.prototype.interfaces_=function(){return[]},yu.prototype.getClass=function(){return yu},yu.toIntArray=function(o){for(var u=new Array(o.size()).fill(null),v=0;v<u.length;v++)u[v]=o.get(v).intValue();return u};var Gr=function(){this.e=null,this.pts=null,this.startIndex=null,this.env1=new Mr,this.env2=new Mr;var o=arguments[0];this.e=o,this.pts=o.getCoordinates();var u=new yu;this.startIndex=u.getChainStartIndices(this.pts)};Gr.prototype.getCoordinates=function(){return this.pts},Gr.prototype.getMaxX=function(o){var u=this.pts[this.startIndex[o]].x,v=this.pts[this.startIndex[o+1]].x;return u>v?u:v},Gr.prototype.getMinX=function(o){var u=this.pts[this.startIndex[o]].x,v=this.pts[this.startIndex[o+1]].x;return u<v?u:v},Gr.prototype.computeIntersectsForChain=function(){if(arguments.length===4){var o=arguments[0],u=arguments[1],v=arguments[2],y=arguments[3];this.computeIntersectsForChain(this.startIndex[o],this.startIndex[o+1],u,u.startIndex[v],u.startIndex[v+1],y)}else if(arguments.length===6){var b=arguments[0],H=arguments[1],ne=arguments[2],Le=arguments[3],tt=arguments[4],Nt=arguments[5],ar=this.pts[b],st=this.pts[H],Gt=ne.pts[Le],ir=ne.pts[tt];if(H-b==1&&tt-Le==1)return Nt.addIntersections(this.e,b,ne.e,Le),null;if(this.env1.init(ar,st),this.env2.init(Gt,ir),!this.env1.intersects(this.env2))return null;var br=Math.trunc((b+H)/2),g=Math.trunc((Le+tt)/2);b<br&&(Le<g&&this.computeIntersectsForChain(b,br,ne,Le,g,Nt),g<tt&&this.computeIntersectsForChain(b,br,ne,g,tt,Nt)),br<H&&(Le<g&&this.computeIntersectsForChain(br,H,ne,Le,g,Nt),g<tt&&this.computeIntersectsForChain(br,H,ne,g,tt,Nt))}},Gr.prototype.getStartIndexes=function(){return this.startIndex},Gr.prototype.computeIntersects=function(o,u){for(var v=0;v<this.startIndex.length-1;v++)for(var y=0;y<o.startIndex.length-1;y++)this.computeIntersectsForChain(v,o,y,u)},Gr.prototype.interfaces_=function(){return[]},Gr.prototype.getClass=function(){return Gr};var fo=function o(){this._depth=Array(2).fill().map(function(){return Array(3)});for(var u=0;u<2;u++)for(var v=0;v<3;v++)this._depth[u][v]=o.NULL_VALUE},of={NULL_VALUE:{configurable:!0}};fo.prototype.getDepth=function(o,u){return this._depth[o][u]},fo.prototype.setDepth=function(o,u,v){this._depth[o][u]=v},fo.prototype.isNull=function(){if(arguments.length===0){for(var o=0;o<2;o++)for(var u=0;u<3;u++)if(this._depth[o][u]!==fo.NULL_VALUE)return!1;return!0}if(arguments.length===1){var v=arguments[0];return this._depth[v][1]===fo.NULL_VALUE}if(arguments.length===2){var y=arguments[0],b=arguments[1];return this._depth[y][b]===fo.NULL_VALUE}},fo.prototype.normalize=function(){for(var o=0;o<2;o++)if(!this.isNull(o)){var u=this._depth[o][1];this._depth[o][2]<u&&(u=this._depth[o][2]),u<0&&(u=0);for(var v=1;v<3;v++){var y=0;this._depth[o][v]>u&&(y=1),this._depth[o][v]=y}}},fo.prototype.getDelta=function(o){return this._depth[o][fe.RIGHT]-this._depth[o][fe.LEFT]},fo.prototype.getLocation=function(o,u){return this._depth[o][u]<=0?ye.EXTERIOR:ye.INTERIOR},fo.prototype.toString=function(){return"A: "+this._depth[0][1]+","+this._depth[0][2]+" B: "+this._depth[1][1]+","+this._depth[1][2]},fo.prototype.add=function(){if(arguments.length===1)for(var o=arguments[0],u=0;u<2;u++)for(var v=1;v<3;v++){var y=o.getLocation(u,v);y!==ye.EXTERIOR&&y!==ye.INTERIOR||(this.isNull(u,v)?this._depth[u][v]=fo.depthAtLocation(y):this._depth[u][v]+=fo.depthAtLocation(y))}else if(arguments.length===3){var b=arguments[0],H=arguments[1];arguments[2]===ye.INTERIOR&&this._depth[b][H]++}},fo.prototype.interfaces_=function(){return[]},fo.prototype.getClass=function(){return fo},fo.depthAtLocation=function(o){return o===ye.EXTERIOR?0:o===ye.INTERIOR?1:fo.NULL_VALUE},of.NULL_VALUE.get=function(){return-1},Object.defineProperties(fo,of);var hc=function(o){function u(){if(o.call(this),this.pts=null,this._env=null,this.eiList=new Nu(this),this._name=null,this._mce=null,this._isIsolated=!0,this._depth=new fo,this._depthDelta=0,arguments.length===1){var v=arguments[0];u.call(this,v,null)}else if(arguments.length===2){var y=arguments[0],b=arguments[1];this.pts=y,this._label=b}}return o&&(u.__proto__=o),u.prototype=Object.create(o&&o.prototype),u.prototype.constructor=u,u.prototype.getDepth=function(){return this._depth},u.prototype.getCollapsedEdge=function(){var v=new Array(2).fill(null);return v[0]=this.pts[0],v[1]=this.pts[1],new u(v,zn.toLineLabel(this._label))},u.prototype.isIsolated=function(){return this._isIsolated},u.prototype.getCoordinates=function(){return this.pts},u.prototype.setIsolated=function(v){this._isIsolated=v},u.prototype.setName=function(v){this._name=v},u.prototype.equals=function(v){if(!(v instanceof u))return!1;var y=v;if(this.pts.length!==y.pts.length)return!1;for(var b=!0,H=!0,ne=this.pts.length,Le=0;Le<this.pts.length;Le++)if(this.pts[Le].equals2D(y.pts[Le])||(b=!1),this.pts[Le].equals2D(y.pts[--ne])||(H=!1),!b&&!H)return!1;return!0},u.prototype.getCoordinate=function(){if(arguments.length===0)return this.pts.length>0?this.pts[0]:null;if(arguments.length===1){var v=arguments[0];return this.pts[v]}},u.prototype.print=function(v){v.print("edge "+this._name+": "),v.print("LINESTRING (");for(var y=0;y<this.pts.length;y++)y>0&&v.print(","),v.print(this.pts[y].x+" "+this.pts[y].y);v.print(")  "+this._label+" "+this._depthDelta)},u.prototype.computeIM=function(v){u.updateIM(this._label,v)},u.prototype.isCollapsed=function(){return!!this._label.isArea()&&this.pts.length===3&&!!this.pts[0].equals(this.pts[2])},u.prototype.isClosed=function(){return this.pts[0].equals(this.pts[this.pts.length-1])},u.prototype.getMaximumSegmentIndex=function(){return this.pts.length-1},u.prototype.getDepthDelta=function(){return this._depthDelta},u.prototype.getNumPoints=function(){return this.pts.length},u.prototype.printReverse=function(v){v.print("edge "+this._name+": ");for(var y=this.pts.length-1;y>=0;y--)v.print(this.pts[y]+" ");v.println("")},u.prototype.getMonotoneChainEdge=function(){return this._mce===null&&(this._mce=new Gr(this)),this._mce},u.prototype.getEnvelope=function(){if(this._env===null){this._env=new Mr;for(var v=0;v<this.pts.length;v++)this._env.expandToInclude(this.pts[v])}return this._env},u.prototype.addIntersection=function(v,y,b,H){var ne=new Y(v.getIntersection(H)),Le=y,tt=v.getEdgeDistance(b,H),Nt=Le+1;if(Nt<this.pts.length){var ar=this.pts[Nt];ne.equals2D(ar)&&(Le=Nt,tt=0)}this.eiList.add(ne,Le,tt)},u.prototype.toString=function(){var v=new ue;v.append("edge "+this._name+": "),v.append("LINESTRING (");for(var y=0;y<this.pts.length;y++)y>0&&v.append(","),v.append(this.pts[y].x+" "+this.pts[y].y);return v.append(")  "+this._label+" "+this._depthDelta),v.toString()},u.prototype.isPointwiseEqual=function(v){if(this.pts.length!==v.pts.length)return!1;for(var y=0;y<this.pts.length;y++)if(!this.pts[y].equals2D(v.pts[y]))return!1;return!0},u.prototype.setDepthDelta=function(v){this._depthDelta=v},u.prototype.getEdgeIntersectionList=function(){return this.eiList},u.prototype.addIntersections=function(v,y,b){for(var H=0;H<v.getIntersectionNum();H++)this.addIntersection(v,y,b,H)},u.prototype.interfaces_=function(){return[]},u.prototype.getClass=function(){return u},u.updateIM=function(){if(arguments.length!==2)return o.prototype.updateIM.apply(this,arguments);var v=arguments[0],y=arguments[1];y.setAtLeastIfValid(v.getLocation(0,fe.ON),v.getLocation(1,fe.ON),1),v.isArea()&&(y.setAtLeastIfValid(v.getLocation(0,fe.LEFT),v.getLocation(1,fe.LEFT),2),y.setAtLeastIfValid(v.getLocation(0,fe.RIGHT),v.getLocation(1,fe.RIGHT),2))},u}(Xs),Zo=function(o){this._workingPrecisionModel=null,this._workingNoder=null,this._geomFact=null,this._graph=null,this._edgeList=new Mo,this._bufParams=o||null};Zo.prototype.setWorkingPrecisionModel=function(o){this._workingPrecisionModel=o},Zo.prototype.insertUniqueEdge=function(o){var u=this._edgeList.findEqualEdge(o);if(u!==null){var v=u.getLabel(),y=o.getLabel();u.isPointwiseEqual(o)||(y=new zn(o.getLabel())).flip(),v.merge(y);var b=Zo.depthDelta(y),H=u.getDepthDelta()+b;u.setDepthDelta(H)}else this._edgeList.add(o),o.setDepthDelta(Zo.depthDelta(o.getLabel()))},Zo.prototype.buildSubgraphs=function(o,u){for(var v=new Wr,y=o.iterator();y.hasNext();){var b=y.next(),H=b.getRightmostCoordinate(),ne=new Bs(v).getDepth(H);b.computeDepth(ne),b.findResultEdges(),v.add(b),u.add(b.getDirectedEdges(),b.getNodes())}},Zo.prototype.createSubgraphs=function(o){for(var u=new Wr,v=o.getNodes().iterator();v.hasNext();){var y=v.next();if(!y.isVisited()){var b=new Nr;b.create(y),u.add(b)}}return io.sort(u,io.reverseOrder()),u},Zo.prototype.createEmptyResultGeometry=function(){return this._geomFact.createPolygon()},Zo.prototype.getNoder=function(o){if(this._workingNoder!==null)return this._workingNoder;var u=new nf,v=new Qe;return v.setPrecisionModel(o),u.setSegmentIntersector(new os(v)),u},Zo.prototype.buffer=function(o,u){var v=this._workingPrecisionModel;v===null&&(v=o.getPrecisionModel()),this._geomFact=o.getFactory();var y=new Ra(v,this._bufParams),b=new $s(o,u,y).getCurves();if(b.size()<=0)return this.createEmptyResultGeometry();this.computeNodedEdges(b,v),this._graph=new Xa(new kc),this._graph.addEdges(this._edgeList.getEdges());var H=this.createSubgraphs(this._graph),ne=new Fn(this._geomFact);this.buildSubgraphs(H,ne);var Le=ne.getPolygons();return Le.size()<=0?this.createEmptyResultGeometry():this._geomFact.buildGeometry(Le)},Zo.prototype.computeNodedEdges=function(o,u){var v=this.getNoder(u);v.computeNodes(o);for(var y=v.getNodedSubstrings().iterator();y.hasNext();){var b=y.next(),H=b.getCoordinates();if(H.length!==2||!H[0].equals2D(H[1])){var ne=b.getData(),Le=new hc(b.getCoordinates(),new zn(ne));this.insertUniqueEdge(Le)}}},Zo.prototype.setNoder=function(o){this._workingNoder=o},Zo.prototype.interfaces_=function(){return[]},Zo.prototype.getClass=function(){return Zo},Zo.depthDelta=function(o){var u=o.getLocation(0,fe.LEFT),v=o.getLocation(0,fe.RIGHT);return u===ye.INTERIOR&&v===ye.EXTERIOR?1:u===ye.EXTERIOR&&v===ye.INTERIOR?-1:0},Zo.convertSegStrings=function(o){for(var u=new Ri,v=new Wr;o.hasNext();){var y=o.next(),b=u.createLineString(y.getCoordinates());v.add(b)}return u.buildGeometry(v)};var sl=function(){if(this._noder=null,this._scaleFactor=null,this._offsetX=null,this._offsetY=null,this._isScaled=!1,arguments.length===2){var o=arguments[0],u=arguments[1];this._noder=o,this._scaleFactor=u,this._offsetX=0,this._offsetY=0,this._isScaled=!this.isIntegerPrecision()}else if(arguments.length===4){var v=arguments[0],y=arguments[1],b=arguments[2],H=arguments[3];this._noder=v,this._scaleFactor=y,this._offsetX=b,this._offsetY=H,this._isScaled=!this.isIntegerPrecision()}};sl.prototype.rescale=function(){if(Pe(arguments[0],mi))for(var o=arguments[0].iterator();o.hasNext();){var u=o.next();this.rescale(u.getCoordinates())}else if(arguments[0]instanceof Array){for(var v=arguments[0],y=0;y<v.length;y++)v[y].x=v[y].x/this._scaleFactor+this._offsetX,v[y].y=v[y].y/this._scaleFactor+this._offsetY;v.length===2&&v[0].equals2D(v[1])&&Qr.out.println(v)}},sl.prototype.scale=function(){if(Pe(arguments[0],mi)){for(var o=arguments[0],u=new Wr,v=o.iterator();v.hasNext();){var y=v.next();u.add(new Ua(this.scale(y.getCoordinates()),y.getData()))}return u}if(arguments[0]instanceof Array){for(var b=arguments[0],H=new Array(b.length).fill(null),ne=0;ne<b.length;ne++)H[ne]=new Y(Math.round((b[ne].x-this._offsetX)*this._scaleFactor),Math.round((b[ne].y-this._offsetY)*this._scaleFactor),b[ne].z);return Xn.removeRepeatedPoints(H)}},sl.prototype.isIntegerPrecision=function(){return this._scaleFactor===1},sl.prototype.getNodedSubstrings=function(){var o=this._noder.getNodedSubstrings();return this._isScaled&&this.rescale(o),o},sl.prototype.computeNodes=function(o){var u=o;this._isScaled&&(u=this.scale(o)),this._noder.computeNodes(u)},sl.prototype.interfaces_=function(){return[Yl]},sl.prototype.getClass=function(){return sl};var Zu=function(){this._li=new Qe,this._segStrings=null;var o=arguments[0];this._segStrings=o},$l={fact:{configurable:!0}};Zu.prototype.checkEndPtVertexIntersections=function(){if(arguments.length===0)for(var o=this._segStrings.iterator();o.hasNext();){var u=o.next().getCoordinates();this.checkEndPtVertexIntersections(u[0],this._segStrings),this.checkEndPtVertexIntersections(u[u.length-1],this._segStrings)}else if(arguments.length===2){for(var v=arguments[0],y=arguments[1].iterator();y.hasNext();)for(var b=y.next().getCoordinates(),H=1;H<b.length-1;H++)if(b[H].equals(v))throw new $i("found endpt/interior pt intersection at index "+H+" :pt "+v)}},Zu.prototype.checkInteriorIntersections=function(){if(arguments.length===0)for(var o=this._segStrings.iterator();o.hasNext();)for(var u=o.next(),v=this._segStrings.iterator();v.hasNext();){var y=v.next();this.checkInteriorIntersections(u,y)}else if(arguments.length===2)for(var b=arguments[0],H=arguments[1],ne=b.getCoordinates(),Le=H.getCoordinates(),tt=0;tt<ne.length-1;tt++)for(var Nt=0;Nt<Le.length-1;Nt++)this.checkInteriorIntersections(b,tt,H,Nt);else if(arguments.length===4){var ar=arguments[0],st=arguments[1],Gt=arguments[2],ir=arguments[3];if(ar===Gt&&st===ir)return null;var br=ar.getCoordinates()[st],g=ar.getCoordinates()[st+1],Bn=Gt.getCoordinates()[ir],Jn=Gt.getCoordinates()[ir+1];if(this._li.computeIntersection(br,g,Bn,Jn),this._li.hasIntersection()&&(this._li.isProper()||this.hasInteriorIntersection(this._li,br,g)||this.hasInteriorIntersection(this._li,Bn,Jn)))throw new $i("found non-noded intersection at "+br+"-"+g+" and "+Bn+"-"+Jn)}},Zu.prototype.checkValid=function(){this.checkEndPtVertexIntersections(),this.checkInteriorIntersections(),this.checkCollapses()},Zu.prototype.checkCollapses=function(){if(arguments.length===0)for(var o=this._segStrings.iterator();o.hasNext();){var u=o.next();this.checkCollapses(u)}else if(arguments.length===1)for(var v=arguments[0].getCoordinates(),y=0;y<v.length-2;y++)this.checkCollapse(v[y],v[y+1],v[y+2])},Zu.prototype.hasInteriorIntersection=function(o,u,v){for(var y=0;y<o.getIntersectionNum();y++){var b=o.getIntersection(y);if(!b.equals(u)&&!b.equals(v))return!0}return!1},Zu.prototype.checkCollapse=function(o,u,v){if(o.equals(v))throw new $i("found non-noded collapse at "+Zu.fact.createLineString([o,u,v]))},Zu.prototype.interfaces_=function(){return[]},Zu.prototype.getClass=function(){return Zu},$l.fact.get=function(){return new Ri},Object.defineProperties(Zu,$l);var Ps=function(){this._li=null,this._pt=null,this._originalPt=null,this._ptScaled=null,this._p0Scaled=null,this._p1Scaled=null,this._scaleFactor=null,this._minx=null,this._maxx=null,this._miny=null,this._maxy=null,this._corner=new Array(4).fill(null),this._safeEnv=null;var o=arguments[0],u=arguments[1],v=arguments[2];if(this._originalPt=o,this._pt=o,this._scaleFactor=u,this._li=v,u<=0)throw new Me("Scale factor must be non-zero");u!==1&&(this._pt=new Y(this.scale(o.x),this.scale(o.y)),this._p0Scaled=new Y,this._p1Scaled=new Y),this.initCorners(this._pt)},Du={SAFE_ENV_EXPANSION_FACTOR:{configurable:!0}};Ps.prototype.intersectsScaled=function(o,u){var v=Math.min(o.x,u.x),y=Math.max(o.x,u.x),b=Math.min(o.y,u.y),H=Math.max(o.y,u.y),ne=this._maxx<v||this._minx>y||this._maxy<b||this._miny>H;if(ne)return!1;var Le=this.intersectsToleranceSquare(o,u);return Ft.isTrue(!(ne&&Le),"Found bad envelope test"),Le},Ps.prototype.initCorners=function(o){this._minx=o.x-.5,this._maxx=o.x+.5,this._miny=o.y-.5,this._maxy=o.y+.5,this._corner[0]=new Y(this._maxx,this._maxy),this._corner[1]=new Y(this._minx,this._maxy),this._corner[2]=new Y(this._minx,this._miny),this._corner[3]=new Y(this._maxx,this._miny)},Ps.prototype.intersects=function(o,u){return this._scaleFactor===1?this.intersectsScaled(o,u):(this.copyScaled(o,this._p0Scaled),this.copyScaled(u,this._p1Scaled),this.intersectsScaled(this._p0Scaled,this._p1Scaled))},Ps.prototype.scale=function(o){return Math.round(o*this._scaleFactor)},Ps.prototype.getCoordinate=function(){return this._originalPt},Ps.prototype.copyScaled=function(o,u){u.x=this.scale(o.x),u.y=this.scale(o.y)},Ps.prototype.getSafeEnvelope=function(){if(this._safeEnv===null){var o=Ps.SAFE_ENV_EXPANSION_FACTOR/this._scaleFactor;this._safeEnv=new Mr(this._originalPt.x-o,this._originalPt.x+o,this._originalPt.y-o,this._originalPt.y+o)}return this._safeEnv},Ps.prototype.intersectsPixelClosure=function(o,u){return this._li.computeIntersection(o,u,this._corner[0],this._corner[1]),!!this._li.hasIntersection()||(this._li.computeIntersection(o,u,this._corner[1],this._corner[2]),!!this._li.hasIntersection()||(this._li.computeIntersection(o,u,this._corner[2],this._corner[3]),!!this._li.hasIntersection()||(this._li.computeIntersection(o,u,this._corner[3],this._corner[0]),!!this._li.hasIntersection())))},Ps.prototype.intersectsToleranceSquare=function(o,u){var v=!1,y=!1;return this._li.computeIntersection(o,u,this._corner[0],this._corner[1]),!!this._li.isProper()||(this._li.computeIntersection(o,u,this._corner[1],this._corner[2]),!!this._li.isProper()||(this._li.hasIntersection()&&(v=!0),this._li.computeIntersection(o,u,this._corner[2],this._corner[3]),!!this._li.isProper()||(this._li.hasIntersection()&&(y=!0),this._li.computeIntersection(o,u,this._corner[3],this._corner[0]),!!this._li.isProper()||!(!v||!y)||!!o.equals(this._pt)||!!u.equals(this._pt))))},Ps.prototype.addSnappedNode=function(o,u){var v=o.getCoordinate(u),y=o.getCoordinate(u+1);return!!this.intersects(v,y)&&(o.addIntersection(this.getCoordinate(),u),!0)},Ps.prototype.interfaces_=function(){return[]},Ps.prototype.getClass=function(){return Ps},Du.SAFE_ENV_EXPANSION_FACTOR.get=function(){return .75},Object.defineProperties(Ps,Du);var Il=function(){this.tempEnv1=new Mr,this.selectedSegment=new On};Il.prototype.select=function(){if(arguments.length!==1){if(arguments.length===2){var o=arguments[0],u=arguments[1];o.getLineSegment(u,this.selectedSegment),this.select(this.selectedSegment)}}},Il.prototype.interfaces_=function(){return[]},Il.prototype.getClass=function(){return Il};var Ac=function(){this._index=null;var o=arguments[0];this._index=o},Oh={HotPixelSnapAction:{configurable:!0}};Ac.prototype.snap=function(){if(arguments.length===1){var o=arguments[0];return this.snap(o,null,-1)}if(arguments.length===3){var u=arguments[0],v=arguments[1],y=arguments[2],b=u.getSafeEnvelope(),H=new _0(u,v,y);return this._index.query(b,{interfaces_:function(){return[ws]},visitItem:function(ne){ne.select(b,H)}}),H.isNodeAdded()}},Ac.prototype.interfaces_=function(){return[]},Ac.prototype.getClass=function(){return Ac},Oh.HotPixelSnapAction.get=function(){return _0},Object.defineProperties(Ac,Oh);var _0=function(o){function u(){o.call(this),this._hotPixel=null,this._parentEdge=null,this._hotPixelVertexIndex=null,this._isNodeAdded=!1;var v=arguments[0],y=arguments[1],b=arguments[2];this._hotPixel=v,this._parentEdge=y,this._hotPixelVertexIndex=b}return o&&(u.__proto__=o),u.prototype=Object.create(o&&o.prototype),u.prototype.constructor=u,u.prototype.isNodeAdded=function(){return this._isNodeAdded},u.prototype.select=function(){if(arguments.length!==2)return o.prototype.select.apply(this,arguments);var v=arguments[0],y=arguments[1],b=v.getContext();if(this._parentEdge!==null&&b===this._parentEdge&&y===this._hotPixelVertexIndex)return null;this._isNodeAdded=this._hotPixel.addSnappedNode(b,y)},u.prototype.interfaces_=function(){return[]},u.prototype.getClass=function(){return u},u}(Il),ul=function(){this._li=null,this._interiorIntersections=null;var o=arguments[0];this._li=o,this._interiorIntersections=new Wr};ul.prototype.processIntersections=function(o,u,v,y){if(o===v&&u===y)return null;var b=o.getCoordinates()[u],H=o.getCoordinates()[u+1],ne=v.getCoordinates()[y],Le=v.getCoordinates()[y+1];if(this._li.computeIntersection(b,H,ne,Le),this._li.hasIntersection()&&this._li.isInteriorIntersection()){for(var tt=0;tt<this._li.getIntersectionNum();tt++)this._interiorIntersections.add(this._li.getIntersection(tt));o.addIntersections(this._li,u,0),v.addIntersections(this._li,y,1)}},ul.prototype.isDone=function(){return!1},ul.prototype.getInteriorIntersections=function(){return this._interiorIntersections},ul.prototype.interfaces_=function(){return[Qs]},ul.prototype.getClass=function(){return ul};var zu=function(){this._pm=null,this._li=null,this._scaleFactor=null,this._noder=null,this._pointSnapper=null,this._nodedSegStrings=null;var o=arguments[0];this._pm=o,this._li=new Qe,this._li.setPrecisionModel(o),this._scaleFactor=o.getScale()};zu.prototype.checkCorrectness=function(o){var u=Ua.getNodedSubstrings(o),v=new Zu(u);try{v.checkValid()}catch(y){if(!(y instanceof fn))throw y;y.printStackTrace()}},zu.prototype.getNodedSubstrings=function(){return Ua.getNodedSubstrings(this._nodedSegStrings)},zu.prototype.snapRound=function(o,u){var v=this.findInteriorIntersections(o,u);this.computeIntersectionSnaps(v),this.computeVertexSnaps(o)},zu.prototype.findInteriorIntersections=function(o,u){var v=new ul(u);return this._noder.setSegmentIntersector(v),this._noder.computeNodes(o),v.getInteriorIntersections()},zu.prototype.computeVertexSnaps=function(){if(Pe(arguments[0],mi))for(var o=arguments[0].iterator();o.hasNext();){var u=o.next();this.computeVertexSnaps(u)}else if(arguments[0]instanceof Ua)for(var v=arguments[0],y=v.getCoordinates(),b=0;b<y.length;b++){var H=new Ps(y[b],this._scaleFactor,this._li);this._pointSnapper.snap(H,v,b)&&v.addIntersection(y[b],b)}},zu.prototype.computeNodes=function(o){this._nodedSegStrings=o,this._noder=new nf,this._pointSnapper=new Ac(this._noder.getIndex()),this.snapRound(o,this._li)},zu.prototype.computeIntersectionSnaps=function(o){for(var u=o.iterator();u.hasNext();){var v=u.next(),y=new Ps(v,this._scaleFactor,this._li);this._pointSnapper.snap(y)}},zu.prototype.interfaces_=function(){return[Yl]},zu.prototype.getClass=function(){return zu};var _s=function(){if(this._argGeom=null,this._distance=null,this._bufParams=new Aa,this._resultGeometry=null,this._saveException=null,arguments.length===1){var o=arguments[0];this._argGeom=o}else if(arguments.length===2){var u=arguments[0],v=arguments[1];this._argGeom=u,this._bufParams=v}},Ql={CAP_ROUND:{configurable:!0},CAP_BUTT:{configurable:!0},CAP_FLAT:{configurable:!0},CAP_SQUARE:{configurable:!0},MAX_PRECISION_DIGITS:{configurable:!0}};_s.prototype.bufferFixedPrecision=function(o){var u=new sl(new zu(new Oi(1)),o.getScale()),v=new Zo(this._bufParams);v.setWorkingPrecisionModel(o),v.setNoder(u),this._resultGeometry=v.buffer(this._argGeom,this._distance)},_s.prototype.bufferReducedPrecision=function(){var o=this;if(arguments.length===0){for(var u=_s.MAX_PRECISION_DIGITS;u>=0;u--){try{o.bufferReducedPrecision(u)}catch(H){if(!(H instanceof Ht))throw H;o._saveException=H}if(o._resultGeometry!==null)return null}throw this._saveException}if(arguments.length===1){var v=arguments[0],y=_s.precisionScaleFactor(this._argGeom,this._distance,v),b=new Oi(y);this.bufferFixedPrecision(b)}},_s.prototype.computeGeometry=function(){if(this.bufferOriginalPrecision(),this._resultGeometry!==null)return null;var o=this._argGeom.getFactory().getPrecisionModel();o.getType()===Oi.FIXED?this.bufferFixedPrecision(o):this.bufferReducedPrecision()},_s.prototype.setQuadrantSegments=function(o){this._bufParams.setQuadrantSegments(o)},_s.prototype.bufferOriginalPrecision=function(){try{var o=new Zo(this._bufParams);this._resultGeometry=o.buffer(this._argGeom,this._distance)}catch(u){if(!(u instanceof $i))throw u;this._saveException=u}},_s.prototype.getResultGeometry=function(o){return this._distance=o,this.computeGeometry(),this._resultGeometry},_s.prototype.setEndCapStyle=function(o){this._bufParams.setEndCapStyle(o)},_s.prototype.interfaces_=function(){return[]},_s.prototype.getClass=function(){return _s},_s.bufferOp=function(){if(arguments.length===2){var o=arguments[0],u=arguments[1];return new _s(o).getResultGeometry(u)}if(arguments.length===3){if(Number.isInteger(arguments[2])&&arguments[0]instanceof Ot&&typeof arguments[1]=="number"){var v=arguments[0],y=arguments[1],b=arguments[2],H=new _s(v);return H.setQuadrantSegments(b),H.getResultGeometry(y)}if(arguments[2]instanceof Aa&&arguments[0]instanceof Ot&&typeof arguments[1]=="number"){var ne=arguments[0],Le=arguments[1],tt=arguments[2];return new _s(ne,tt).getResultGeometry(Le)}}else if(arguments.length===4){var Nt=arguments[0],ar=arguments[1],st=arguments[2],Gt=arguments[3],ir=new _s(Nt);return ir.setQuadrantSegments(st),ir.setEndCapStyle(Gt),ir.getResultGeometry(ar)}},_s.precisionScaleFactor=function(o,u,v){var y=o.getEnvelopeInternal(),b=Ae.max(Math.abs(y.getMaxX()),Math.abs(y.getMaxY()),Math.abs(y.getMinX()),Math.abs(y.getMinY()))+2*(u>0?u:0),H=v-Math.trunc(Math.log(b)/Math.log(10)+1);return Math.pow(10,H)},Ql.CAP_ROUND.get=function(){return Aa.CAP_ROUND},Ql.CAP_BUTT.get=function(){return Aa.CAP_FLAT},Ql.CAP_FLAT.get=function(){return Aa.CAP_FLAT},Ql.CAP_SQUARE.get=function(){return Aa.CAP_SQUARE},Ql.MAX_PRECISION_DIGITS.get=function(){return 12},Object.defineProperties(_s,Ql);var zo=function(){this._pt=[new Y,new Y],this._distance=ce.NaN,this._isNull=!0};zo.prototype.getCoordinates=function(){return this._pt},zo.prototype.getCoordinate=function(o){return this._pt[o]},zo.prototype.setMinimum=function(){if(arguments.length===1){var o=arguments[0];this.setMinimum(o._pt[0],o._pt[1])}else if(arguments.length===2){var u=arguments[0],v=arguments[1];if(this._isNull)return this.initialize(u,v),null;var y=u.distance(v);y<this._distance&&this.initialize(u,v,y)}},zo.prototype.initialize=function(){if(arguments.length===0)this._isNull=!0;else if(arguments.length===2){var o=arguments[0],u=arguments[1];this._pt[0].setCoordinate(o),this._pt[1].setCoordinate(u),this._distance=o.distance(u),this._isNull=!1}else if(arguments.length===3){var v=arguments[0],y=arguments[1],b=arguments[2];this._pt[0].setCoordinate(v),this._pt[1].setCoordinate(y),this._distance=b,this._isNull=!1}},zo.prototype.getDistance=function(){return this._distance},zo.prototype.setMaximum=function(){if(arguments.length===1){var o=arguments[0];this.setMaximum(o._pt[0],o._pt[1])}else if(arguments.length===2){var u=arguments[0],v=arguments[1];if(this._isNull)return this.initialize(u,v),null;var y=u.distance(v);y>this._distance&&this.initialize(u,v,y)}},zo.prototype.interfaces_=function(){return[]},zo.prototype.getClass=function(){return zo};var Gu=function(){};Gu.prototype.interfaces_=function(){return[]},Gu.prototype.getClass=function(){return Gu},Gu.computeDistance=function(){if(arguments[2]instanceof zo&&arguments[0]instanceof Oa&&arguments[1]instanceof Y)for(var o=arguments[0],u=arguments[1],v=arguments[2],y=o.getCoordinates(),b=new On,H=0;H<y.length-1;H++){b.setCoordinates(y[H],y[H+1]);var ne=b.closestPoint(u);v.setMinimum(ne,u)}else if(arguments[2]instanceof zo&&arguments[0]instanceof ka&&arguments[1]instanceof Y){var Le=arguments[0],tt=arguments[1],Nt=arguments[2];Gu.computeDistance(Le.getExteriorRing(),tt,Nt);for(var ar=0;ar<Le.getNumInteriorRing();ar++)Gu.computeDistance(Le.getInteriorRingN(ar),tt,Nt)}else if(arguments[2]instanceof zo&&arguments[0]instanceof Ot&&arguments[1]instanceof Y){var st=arguments[0],Gt=arguments[1],ir=arguments[2];if(st instanceof Oa)Gu.computeDistance(st,Gt,ir);else if(st instanceof ka)Gu.computeDistance(st,Gt,ir);else if(st instanceof rs)for(var br=st,g=0;g<br.getNumGeometries();g++){var Bn=br.getGeometryN(g);Gu.computeDistance(Bn,Gt,ir)}else ir.setMinimum(st.getCoordinate(),Gt)}else if(arguments[2]instanceof zo&&arguments[0]instanceof On&&arguments[1]instanceof Y){var Jn=arguments[0],et=arguments[1],Za=arguments[2],Eo=Jn.closestPoint(et);Za.setMinimum(Eo,et)}};var ll=function(o){this._maxPtDist=new zo,this._inputGeom=o||null},sf={MaxPointDistanceFilter:{configurable:!0},MaxMidpointDistanceFilter:{configurable:!0}};ll.prototype.computeMaxMidpointDistance=function(o){var u=new Vu(this._inputGeom);o.apply(u),this._maxPtDist.setMaximum(u.getMaxPointDistance())},ll.prototype.computeMaxVertexDistance=function(o){var u=new pc(this._inputGeom);o.apply(u),this._maxPtDist.setMaximum(u.getMaxPointDistance())},ll.prototype.findDistance=function(o){return this.computeMaxVertexDistance(o),this.computeMaxMidpointDistance(o),this._maxPtDist.getDistance()},ll.prototype.getDistancePoints=function(){return this._maxPtDist},ll.prototype.interfaces_=function(){return[]},ll.prototype.getClass=function(){return ll},sf.MaxPointDistanceFilter.get=function(){return pc},sf.MaxMidpointDistanceFilter.get=function(){return Vu},Object.defineProperties(ll,sf);var pc=function(o){this._maxPtDist=new zo,this._minPtDist=new zo,this._geom=o||null};pc.prototype.filter=function(o){this._minPtDist.initialize(),Gu.computeDistance(this._geom,o,this._minPtDist),this._maxPtDist.setMaximum(this._minPtDist)},pc.prototype.getMaxPointDistance=function(){return this._maxPtDist},pc.prototype.interfaces_=function(){return[Lr]},pc.prototype.getClass=function(){return pc};var Vu=function(o){this._maxPtDist=new zo,this._minPtDist=new zo,this._geom=o||null};Vu.prototype.filter=function(o,u){if(u===0)return null;var v=o.getCoordinate(u-1),y=o.getCoordinate(u),b=new Y((v.x+y.x)/2,(v.y+y.y)/2);this._minPtDist.initialize(),Gu.computeDistance(this._geom,b,this._minPtDist),this._maxPtDist.setMaximum(this._minPtDist)},Vu.prototype.isDone=function(){return!1},Vu.prototype.isGeometryChanged=function(){return!1},Vu.prototype.getMaxPointDistance=function(){return this._maxPtDist},Vu.prototype.interfaces_=function(){return[Rs]},Vu.prototype.getClass=function(){return Vu};var Hu=function(o){this._comps=o||null};Hu.prototype.filter=function(o){o instanceof ka&&this._comps.add(o)},Hu.prototype.interfaces_=function(){return[mo]},Hu.prototype.getClass=function(){return Hu},Hu.getPolygons=function(){if(arguments.length===1){var o=arguments[0];return Hu.getPolygons(o,new Wr)}if(arguments.length===2){var u=arguments[0],v=arguments[1];return u instanceof ka?v.add(u):u instanceof rs&&u.apply(new Hu(v)),v}};var wo=function(){if(this._lines=null,this._isForcedToLineString=!1,arguments.length===1){var o=arguments[0];this._lines=o}else if(arguments.length===2){var u=arguments[0],v=arguments[1];this._lines=u,this._isForcedToLineString=v}};wo.prototype.filter=function(o){if(this._isForcedToLineString&&o instanceof cr){var u=o.getFactory().createLineString(o.getCoordinateSequence());return this._lines.add(u),null}o instanceof Oa&&this._lines.add(o)},wo.prototype.setForceToLineString=function(o){this._isForcedToLineString=o},wo.prototype.interfaces_=function(){return[yt]},wo.prototype.getClass=function(){return wo},wo.getGeometry=function(){if(arguments.length===1){var o=arguments[0];return o.getFactory().buildGeometry(wo.getLines(o))}if(arguments.length===2){var u=arguments[0],v=arguments[1];return u.getFactory().buildGeometry(wo.getLines(u,v))}},wo.getLines=function(){if(arguments.length===1){var o=arguments[0];return wo.getLines(o,!1)}if(arguments.length===2){if(Pe(arguments[0],mi)&&Pe(arguments[1],mi)){for(var u=arguments[0],v=arguments[1],y=u.iterator();y.hasNext();){var b=y.next();wo.getLines(b,v)}return v}if(arguments[0]instanceof Ot&&typeof arguments[1]=="boolean"){var H=arguments[0],ne=arguments[1],Le=new Wr;return H.apply(new wo(Le,ne)),Le}if(arguments[0]instanceof Ot&&Pe(arguments[1],mi)){var tt=arguments[0],Nt=arguments[1];return tt instanceof Oa?Nt.add(tt):tt.apply(new wo(Nt)),Nt}}else if(arguments.length===3){if(typeof arguments[2]=="boolean"&&Pe(arguments[0],mi)&&Pe(arguments[1],mi)){for(var ar=arguments[0],st=arguments[1],Gt=arguments[2],ir=ar.iterator();ir.hasNext();){var br=ir.next();wo.getLines(br,st,Gt)}return st}if(typeof arguments[2]=="boolean"&&arguments[0]instanceof Ot&&Pe(arguments[1],mi)){var g=arguments[0],Bn=arguments[1],Jn=arguments[2];return g.apply(new wo(Bn,Jn)),Bn}}};var Wu=function(){if(this._boundaryRule=on.OGC_SFS_BOUNDARY_RULE,this._isIn=null,this._numBoundaries=null,arguments.length!==0){if(arguments.length===1){var o=arguments[0];if(o===null)throw new Me("Rule must be non-null");this._boundaryRule=o}}};Wu.prototype.locateInternal=function(){if(arguments[0]instanceof Y&&arguments[1]instanceof ka){var o=arguments[0],u=arguments[1];if(u.isEmpty())return ye.EXTERIOR;var v=u.getExteriorRing(),y=this.locateInPolygonRing(o,v);if(y===ye.EXTERIOR)return ye.EXTERIOR;if(y===ye.BOUNDARY)return ye.BOUNDARY;for(var b=0;b<u.getNumInteriorRing();b++){var H=u.getInteriorRingN(b),ne=this.locateInPolygonRing(o,H);if(ne===ye.INTERIOR)return ye.EXTERIOR;if(ne===ye.BOUNDARY)return ye.BOUNDARY}return ye.INTERIOR}if(arguments[0]instanceof Y&&arguments[1]instanceof Oa){var Le=arguments[0],tt=arguments[1];if(!tt.getEnvelopeInternal().intersects(Le))return ye.EXTERIOR;var Nt=tt.getCoordinates();return tt.isClosed()||!Le.equals(Nt[0])&&!Le.equals(Nt[Nt.length-1])?Pt.isOnLine(Le,Nt)?ye.INTERIOR:ye.EXTERIOR:ye.BOUNDARY}if(arguments[0]instanceof Y&&arguments[1]instanceof Co){var ar=arguments[0];return arguments[1].getCoordinate().equals2D(ar)?ye.INTERIOR:ye.EXTERIOR}},Wu.prototype.locateInPolygonRing=function(o,u){return u.getEnvelopeInternal().intersects(o)?Pt.locatePointInRing(o,u.getCoordinates()):ye.EXTERIOR},Wu.prototype.intersects=function(o,u){return this.locate(o,u)!==ye.EXTERIOR},Wu.prototype.updateLocationInfo=function(o){o===ye.INTERIOR&&(this._isIn=!0),o===ye.BOUNDARY&&this._numBoundaries++},Wu.prototype.computeLocation=function(o,u){if(u instanceof Co&&this.updateLocationInfo(this.locateInternal(o,u)),u instanceof Oa)this.updateLocationInfo(this.locateInternal(o,u));else if(u instanceof ka)this.updateLocationInfo(this.locateInternal(o,u));else if(u instanceof Qi)for(var v=u,y=0;y<v.getNumGeometries();y++){var b=v.getGeometryN(y);this.updateLocationInfo(this.locateInternal(o,b))}else if(u instanceof yn)for(var H=u,ne=0;ne<H.getNumGeometries();ne++){var Le=H.getGeometryN(ne);this.updateLocationInfo(this.locateInternal(o,Le))}else if(u instanceof rs)for(var tt=new as(u);tt.hasNext();){var Nt=tt.next();Nt!==u&&this.computeLocation(o,Nt)}},Wu.prototype.locate=function(o,u){return u.isEmpty()?ye.EXTERIOR:u instanceof Oa?this.locateInternal(o,u):u instanceof ka?this.locateInternal(o,u):(this._isIn=!1,this._numBoundaries=0,this.computeLocation(o,u),this._boundaryRule.isInBoundary(this._numBoundaries)?ye.BOUNDARY:this._numBoundaries>0||this._isIn?ye.INTERIOR:ye.EXTERIOR)},Wu.prototype.interfaces_=function(){return[]},Wu.prototype.getClass=function(){return Wu};var ss=function o(){if(this._component=null,this._segIndex=null,this._pt=null,arguments.length===2){var u=arguments[0],v=arguments[1];o.call(this,u,o.INSIDE_AREA,v)}else if(arguments.length===3){var y=arguments[0],b=arguments[1],H=arguments[2];this._component=y,this._segIndex=b,this._pt=H}},X0={INSIDE_AREA:{configurable:!0}};ss.prototype.isInsideArea=function(){return this._segIndex===ss.INSIDE_AREA},ss.prototype.getCoordinate=function(){return this._pt},ss.prototype.getGeometryComponent=function(){return this._component},ss.prototype.getSegmentIndex=function(){return this._segIndex},ss.prototype.interfaces_=function(){return[]},ss.prototype.getClass=function(){return ss},X0.INSIDE_AREA.get=function(){return-1},Object.defineProperties(ss,X0);var Pl=function(o){this._pts=o||null};Pl.prototype.filter=function(o){o instanceof Co&&this._pts.add(o)},Pl.prototype.interfaces_=function(){return[mo]},Pl.prototype.getClass=function(){return Pl},Pl.getPoints=function(){if(arguments.length===1){var o=arguments[0];return o instanceof Co?io.singletonList(o):Pl.getPoints(o,new Wr)}if(arguments.length===2){var u=arguments[0],v=arguments[1];return u instanceof Co?v.add(u):u instanceof rs&&u.apply(new Pl(v)),v}};var Uc=function(){this._locations=null;var o=arguments[0];this._locations=o};Uc.prototype.filter=function(o){(o instanceof Co||o instanceof Oa||o instanceof ka)&&this._locations.add(new ss(o,0,o.getCoordinate()))},Uc.prototype.interfaces_=function(){return[mo]},Uc.prototype.getClass=function(){return Uc},Uc.getLocations=function(o){var u=new Wr;return o.apply(new Uc(u)),u};var us=function(){if(this._geom=null,this._terminateDistance=0,this._ptLocator=new Wu,this._minDistanceLocation=null,this._minDistance=ce.MAX_VALUE,arguments.length===2){var o=arguments[0],u=arguments[1];this._geom=[o,u],this._terminateDistance=0}else if(arguments.length===3){var v=arguments[0],y=arguments[1],b=arguments[2];this._geom=new Array(2).fill(null),this._geom[0]=v,this._geom[1]=y,this._terminateDistance=b}};us.prototype.computeContainmentDistance=function(){if(arguments.length===0){var o=new Array(2).fill(null);if(this.computeContainmentDistance(0,o),this._minDistance<=this._terminateDistance)return null;this.computeContainmentDistance(1,o)}else if(arguments.length===2){var u=arguments[0],v=arguments[1],y=1-u,b=Hu.getPolygons(this._geom[u]);if(b.size()>0){var H=Uc.getLocations(this._geom[y]);if(this.computeContainmentDistance(H,b,v),this._minDistance<=this._terminateDistance)return this._minDistanceLocation[y]=v[0],this._minDistanceLocation[u]=v[1],null}}else if(arguments.length===3){if(arguments[2]instanceof Array&&Pe(arguments[0],ja)&&Pe(arguments[1],ja)){for(var ne=arguments[0],Le=arguments[1],tt=arguments[2],Nt=0;Nt<ne.size();Nt++)for(var ar=ne.get(Nt),st=0;st<Le.size();st++)if(this.computeContainmentDistance(ar,Le.get(st),tt),this._minDistance<=this._terminateDistance)return null}else if(arguments[2]instanceof Array&&arguments[0]instanceof ss&&arguments[1]instanceof ka){var Gt=arguments[0],ir=arguments[1],br=arguments[2],g=Gt.getCoordinate();if(ye.EXTERIOR!==this._ptLocator.locate(g,ir))return this._minDistance=0,br[0]=Gt,br[1]=new ss(ir,g),null}}},us.prototype.computeMinDistanceLinesPoints=function(o,u,v){for(var y=0;y<o.size();y++)for(var b=o.get(y),H=0;H<u.size();H++){var ne=u.get(H);if(this.computeMinDistance(b,ne,v),this._minDistance<=this._terminateDistance)return null}},us.prototype.computeFacetDistance=function(){var o=new Array(2).fill(null),u=wo.getLines(this._geom[0]),v=wo.getLines(this._geom[1]),y=Pl.getPoints(this._geom[0]),b=Pl.getPoints(this._geom[1]);return this.computeMinDistanceLines(u,v,o),this.updateMinDistance(o,!1),this._minDistance<=this._terminateDistance?null:(o[0]=null,o[1]=null,this.computeMinDistanceLinesPoints(u,b,o),this.updateMinDistance(o,!1),this._minDistance<=this._terminateDistance?null:(o[0]=null,o[1]=null,this.computeMinDistanceLinesPoints(v,y,o),this.updateMinDistance(o,!0),this._minDistance<=this._terminateDistance?null:(o[0]=null,o[1]=null,this.computeMinDistancePoints(y,b,o),void this.updateMinDistance(o,!1))))},us.prototype.nearestLocations=function(){return this.computeMinDistance(),this._minDistanceLocation},us.prototype.updateMinDistance=function(o,u){if(o[0]===null)return null;u?(this._minDistanceLocation[0]=o[1],this._minDistanceLocation[1]=o[0]):(this._minDistanceLocation[0]=o[0],this._minDistanceLocation[1]=o[1])},us.prototype.nearestPoints=function(){return this.computeMinDistance(),[this._minDistanceLocation[0].getCoordinate(),this._minDistanceLocation[1].getCoordinate()]},us.prototype.computeMinDistance=function(){if(arguments.length===0){if(this._minDistanceLocation!==null||(this._minDistanceLocation=new Array(2).fill(null),this.computeContainmentDistance(),this._minDistance<=this._terminateDistance))return null;this.computeFacetDistance()}else if(arguments.length===3){if(arguments[2]instanceof Array&&arguments[0]instanceof Oa&&arguments[1]instanceof Co){var o=arguments[0],u=arguments[1],v=arguments[2];if(o.getEnvelopeInternal().distance(u.getEnvelopeInternal())>this._minDistance)return null;for(var y=o.getCoordinates(),b=u.getCoordinate(),H=0;H<y.length-1;H++){var ne=Pt.distancePointLine(b,y[H],y[H+1]);if(ne<this._minDistance){this._minDistance=ne;var Le=new On(y[H],y[H+1]).closestPoint(b);v[0]=new ss(o,H,Le),v[1]=new ss(u,0,b)}if(this._minDistance<=this._terminateDistance)return null}}else if(arguments[2]instanceof Array&&arguments[0]instanceof Oa&&arguments[1]instanceof Oa){var tt=arguments[0],Nt=arguments[1],ar=arguments[2];if(tt.getEnvelopeInternal().distance(Nt.getEnvelopeInternal())>this._minDistance)return null;for(var st=tt.getCoordinates(),Gt=Nt.getCoordinates(),ir=0;ir<st.length-1;ir++)for(var br=0;br<Gt.length-1;br++){var g=Pt.distanceLineLine(st[ir],st[ir+1],Gt[br],Gt[br+1]);if(g<this._minDistance){this._minDistance=g;var Bn=new On(st[ir],st[ir+1]),Jn=new On(Gt[br],Gt[br+1]),et=Bn.closestPoints(Jn);ar[0]=new ss(tt,ir,et[0]),ar[1]=new ss(Nt,br,et[1])}if(this._minDistance<=this._terminateDistance)return null}}}},us.prototype.computeMinDistancePoints=function(o,u,v){for(var y=0;y<o.size();y++)for(var b=o.get(y),H=0;H<u.size();H++){var ne=u.get(H),Le=b.getCoordinate().distance(ne.getCoordinate());if(Le<this._minDistance&&(this._minDistance=Le,v[0]=new ss(b,0,b.getCoordinate()),v[1]=new ss(ne,0,ne.getCoordinate())),this._minDistance<=this._terminateDistance)return null}},us.prototype.distance=function(){if(this._geom[0]===null||this._geom[1]===null)throw new Me("null geometries are not supported");return this._geom[0].isEmpty()||this._geom[1].isEmpty()?0:(this.computeMinDistance(),this._minDistance)},us.prototype.computeMinDistanceLines=function(o,u,v){for(var y=0;y<o.size();y++)for(var b=o.get(y),H=0;H<u.size();H++){var ne=u.get(H);if(this.computeMinDistance(b,ne,v),this._minDistance<=this._terminateDistance)return null}},us.prototype.interfaces_=function(){return[]},us.prototype.getClass=function(){return us},us.distance=function(o,u){return new us(o,u).distance()},us.isWithinDistance=function(o,u,v){return new us(o,u,v).distance()<=v},us.nearestPoints=function(o,u){return new us(o,u).nearestPoints()};var ys=function(){this._pt=[new Y,new Y],this._distance=ce.NaN,this._isNull=!0};ys.prototype.getCoordinates=function(){return this._pt},ys.prototype.getCoordinate=function(o){return this._pt[o]},ys.prototype.setMinimum=function(){if(arguments.length===1){var o=arguments[0];this.setMinimum(o._pt[0],o._pt[1])}else if(arguments.length===2){var u=arguments[0],v=arguments[1];if(this._isNull)return this.initialize(u,v),null;var y=u.distance(v);y<this._distance&&this.initialize(u,v,y)}},ys.prototype.initialize=function(){if(arguments.length===0)this._isNull=!0;else if(arguments.length===2){var o=arguments[0],u=arguments[1];this._pt[0].setCoordinate(o),this._pt[1].setCoordinate(u),this._distance=o.distance(u),this._isNull=!1}else if(arguments.length===3){var v=arguments[0],y=arguments[1],b=arguments[2];this._pt[0].setCoordinate(v),this._pt[1].setCoordinate(y),this._distance=b,this._isNull=!1}},ys.prototype.toString=function(){return Cn.toLineString(this._pt[0],this._pt[1])},ys.prototype.getDistance=function(){return this._distance},ys.prototype.setMaximum=function(){if(arguments.length===1){var o=arguments[0];this.setMaximum(o._pt[0],o._pt[1])}else if(arguments.length===2){var u=arguments[0],v=arguments[1];if(this._isNull)return this.initialize(u,v),null;var y=u.distance(v);y>this._distance&&this.initialize(u,v,y)}},ys.prototype.interfaces_=function(){return[]},ys.prototype.getClass=function(){return ys};var qs=function(){};qs.prototype.interfaces_=function(){return[]},qs.prototype.getClass=function(){return qs},qs.computeDistance=function(){if(arguments[2]instanceof ys&&arguments[0]instanceof Oa&&arguments[1]instanceof Y)for(var o=arguments[0],u=arguments[1],v=arguments[2],y=new On,b=o.getCoordinates(),H=0;H<b.length-1;H++){y.setCoordinates(b[H],b[H+1]);var ne=y.closestPoint(u);v.setMinimum(ne,u)}else if(arguments[2]instanceof ys&&arguments[0]instanceof ka&&arguments[1]instanceof Y){var Le=arguments[0],tt=arguments[1],Nt=arguments[2];qs.computeDistance(Le.getExteriorRing(),tt,Nt);for(var ar=0;ar<Le.getNumInteriorRing();ar++)qs.computeDistance(Le.getInteriorRingN(ar),tt,Nt)}else if(arguments[2]instanceof ys&&arguments[0]instanceof Ot&&arguments[1]instanceof Y){var st=arguments[0],Gt=arguments[1],ir=arguments[2];if(st instanceof Oa)qs.computeDistance(st,Gt,ir);else if(st instanceof ka)qs.computeDistance(st,Gt,ir);else if(st instanceof rs)for(var br=st,g=0;g<br.getNumGeometries();g++){var Bn=br.getGeometryN(g);qs.computeDistance(Bn,Gt,ir)}else ir.setMinimum(st.getCoordinate(),Gt)}else if(arguments[2]instanceof ys&&arguments[0]instanceof On&&arguments[1]instanceof Y){var Jn=arguments[0],et=arguments[1],Za=arguments[2],Eo=Jn.closestPoint(et);Za.setMinimum(Eo,et)}};var Os=function(){this._g0=null,this._g1=null,this._ptDist=new ys,this._densifyFrac=0;var o=arguments[0],u=arguments[1];this._g0=o,this._g1=u},Nf={MaxPointDistanceFilter:{configurable:!0},MaxDensifiedByFractionDistanceFilter:{configurable:!0}};Os.prototype.getCoordinates=function(){return this._ptDist.getCoordinates()},Os.prototype.setDensifyFraction=function(o){if(o>1||o<=0)throw new Me("Fraction is not in range (0.0 - 1.0]");this._densifyFrac=o},Os.prototype.compute=function(o,u){this.computeOrientedDistance(o,u,this._ptDist),this.computeOrientedDistance(u,o,this._ptDist)},Os.prototype.distance=function(){return this.compute(this._g0,this._g1),this._ptDist.getDistance()},Os.prototype.computeOrientedDistance=function(o,u,v){var y=new fu(u);if(o.apply(y),v.setMaximum(y.getMaxPointDistance()),this._densifyFrac>0){var b=new ls(u,this._densifyFrac);o.apply(b),v.setMaximum(b.getMaxPointDistance())}},Os.prototype.orientedDistance=function(){return this.computeOrientedDistance(this._g0,this._g1,this._ptDist),this._ptDist.getDistance()},Os.prototype.interfaces_=function(){return[]},Os.prototype.getClass=function(){return Os},Os.distance=function(){if(arguments.length===2){var o=arguments[0],u=arguments[1];return new Os(o,u).distance()}if(arguments.length===3){var v=arguments[0],y=arguments[1],b=arguments[2],H=new Os(v,y);return H.setDensifyFraction(b),H.distance()}},Nf.MaxPointDistanceFilter.get=function(){return fu},Nf.MaxDensifiedByFractionDistanceFilter.get=function(){return ls},Object.defineProperties(Os,Nf);var fu=function(){this._maxPtDist=new ys,this._minPtDist=new ys,this._euclideanDist=new qs,this._geom=null;var o=arguments[0];this._geom=o};fu.prototype.filter=function(o){this._minPtDist.initialize(),qs.computeDistance(this._geom,o,this._minPtDist),this._maxPtDist.setMaximum(this._minPtDist)},fu.prototype.getMaxPointDistance=function(){return this._maxPtDist},fu.prototype.interfaces_=function(){return[Lr]},fu.prototype.getClass=function(){return fu};var ls=function(){this._maxPtDist=new ys,this._minPtDist=new ys,this._geom=null,this._numSubSegs=0;var o=arguments[0],u=arguments[1];this._geom=o,this._numSubSegs=Math.trunc(Math.round(1/u))};ls.prototype.filter=function(o,u){if(u===0)return null;for(var v=o.getCoordinate(u-1),y=o.getCoordinate(u),b=(y.x-v.x)/this._numSubSegs,H=(y.y-v.y)/this._numSubSegs,ne=0;ne<this._numSubSegs;ne++){var Le=v.x+ne*b,tt=v.y+ne*H,Nt=new Y(Le,tt);this._minPtDist.initialize(),qs.computeDistance(this._geom,Nt,this._minPtDist),this._maxPtDist.setMaximum(this._minPtDist)}},ls.prototype.isDone=function(){return!1},ls.prototype.isGeometryChanged=function(){return!1},ls.prototype.getMaxPointDistance=function(){return this._maxPtDist},ls.prototype.interfaces_=function(){return[Rs]},ls.prototype.getClass=function(){return ls};var Io=function(o,u,v){this._minValidDistance=null,this._maxValidDistance=null,this._minDistanceFound=null,this._maxDistanceFound=null,this._isValid=!0,this._errMsg=null,this._errorLocation=null,this._errorIndicator=null,this._input=o||null,this._bufDistance=u||null,this._result=v||null},uf={VERBOSE:{configurable:!0},MAX_DISTANCE_DIFF_FRAC:{configurable:!0}};Io.prototype.checkMaximumDistance=function(o,u,v){var y=new Os(u,o);if(y.setDensifyFraction(.25),this._maxDistanceFound=y.orientedDistance(),this._maxDistanceFound>v){this._isValid=!1;var b=y.getCoordinates();this._errorLocation=b[1],this._errorIndicator=o.getFactory().createLineString(b),this._errMsg="Distance between buffer curve and input is too large ("+this._maxDistanceFound+" at "+Cn.toLineString(b[0],b[1])+")"}},Io.prototype.isValid=function(){var o=Math.abs(this._bufDistance),u=Io.MAX_DISTANCE_DIFF_FRAC*o;return this._minValidDistance=o-u,this._maxValidDistance=o+u,!(!this._input.isEmpty()&&!this._result.isEmpty())||(this._bufDistance>0?this.checkPositiveValid():this.checkNegativeValid(),Io.VERBOSE&&Qr.out.println("Min Dist= "+this._minDistanceFound+"  err= "+(1-this._minDistanceFound/this._bufDistance)+"  Max Dist= "+this._maxDistanceFound+"  err= "+(this._maxDistanceFound/this._bufDistance-1)),this._isValid)},Io.prototype.checkNegativeValid=function(){if(!(this._input instanceof ka||this._input instanceof yn||this._input instanceof rs))return null;var o=this.getPolygonLines(this._input);if(this.checkMinimumDistance(o,this._result,this._minValidDistance),!this._isValid)return null;this.checkMaximumDistance(o,this._result,this._maxValidDistance)},Io.prototype.getErrorIndicator=function(){return this._errorIndicator},Io.prototype.checkMinimumDistance=function(o,u,v){var y=new us(o,u,v);if(this._minDistanceFound=y.distance(),this._minDistanceFound<v){this._isValid=!1;var b=y.nearestPoints();this._errorLocation=y.nearestPoints()[1],this._errorIndicator=o.getFactory().createLineString(b),this._errMsg="Distance between buffer curve and input is too small ("+this._minDistanceFound+" at "+Cn.toLineString(b[0],b[1])+" )"}},Io.prototype.checkPositiveValid=function(){var o=this._result.getBoundary();if(this.checkMinimumDistance(this._input,o,this._minValidDistance),!this._isValid)return null;this.checkMaximumDistance(this._input,o,this._maxValidDistance)},Io.prototype.getErrorLocation=function(){return this._errorLocation},Io.prototype.getPolygonLines=function(o){for(var u=new Wr,v=new wo(u),y=Hu.getPolygons(o).iterator();y.hasNext();)y.next().apply(v);return o.getFactory().buildGeometry(u)},Io.prototype.getErrorMessage=function(){return this._errMsg},Io.prototype.interfaces_=function(){return[]},Io.prototype.getClass=function(){return Io},uf.VERBOSE.get=function(){return!1},uf.MAX_DISTANCE_DIFF_FRAC.get=function(){return .012},Object.defineProperties(Io,uf);var po=function(o,u,v){this._isValid=!0,this._errorMsg=null,this._errorLocation=null,this._errorIndicator=null,this._input=o||null,this._distance=u||null,this._result=v||null},hr={VERBOSE:{configurable:!0},MAX_ENV_DIFF_FRAC:{configurable:!0}};po.prototype.isValid=function(){return this.checkPolygonal(),this._isValid?(this.checkExpectedEmpty(),this._isValid?(this.checkEnvelope(),this._isValid?(this.checkArea(),this._isValid?(this.checkDistance(),this._isValid):this._isValid):this._isValid):this._isValid):this._isValid},po.prototype.checkEnvelope=function(){if(this._distance<0)return null;var o=this._distance*po.MAX_ENV_DIFF_FRAC;o===0&&(o=.001);var u=new Mr(this._input.getEnvelopeInternal());u.expandBy(this._distance);var v=new Mr(this._result.getEnvelopeInternal());v.expandBy(o),v.contains(u)||(this._isValid=!1,this._errorMsg="Buffer envelope is incorrect",this._errorIndicator=this._input.getFactory().toGeometry(v)),this.report("Envelope")},po.prototype.checkDistance=function(){var o=new Io(this._input,this._distance,this._result);o.isValid()||(this._isValid=!1,this._errorMsg=o.getErrorMessage(),this._errorLocation=o.getErrorLocation(),this._errorIndicator=o.getErrorIndicator()),this.report("Distance")},po.prototype.checkArea=function(){var o=this._input.getArea(),u=this._result.getArea();this._distance>0&&o>u&&(this._isValid=!1,this._errorMsg="Area of positive buffer is smaller than input",this._errorIndicator=this._result),this._distance<0&&o<u&&(this._isValid=!1,this._errorMsg="Area of negative buffer is larger than input",this._errorIndicator=this._result),this.report("Area")},po.prototype.checkPolygonal=function(){this._result instanceof ka||this._result instanceof yn||(this._isValid=!1),this._errorMsg="Result is not polygonal",this._errorIndicator=this._result,this.report("Polygonal")},po.prototype.getErrorIndicator=function(){return this._errorIndicator},po.prototype.getErrorLocation=function(){return this._errorLocation},po.prototype.checkExpectedEmpty=function(){return this._input.getDimension()>=2||this._distance>0?null:(this._result.isEmpty()||(this._isValid=!1,this._errorMsg="Result is non-empty",this._errorIndicator=this._result),void this.report("ExpectedEmpty"))},po.prototype.report=function(o){if(!po.VERBOSE)return null;Qr.out.println("Check "+o+": "+(this._isValid?"passed":"FAILED"))},po.prototype.getErrorMessage=function(){return this._errorMsg},po.prototype.interfaces_=function(){return[]},po.prototype.getClass=function(){return po},po.isValidMsg=function(o,u,v){var y=new po(o,u,v);return y.isValid()?null:y.getErrorMessage()},po.isValid=function(o,u,v){return!!new po(o,u,v).isValid()},hr.VERBOSE.get=function(){return!1},hr.MAX_ENV_DIFF_FRAC.get=function(){return .012},Object.defineProperties(po,hr);var St=function(){this._pts=null,this._data=null;var o=arguments[0],u=arguments[1];this._pts=o,this._data=u};St.prototype.getCoordinates=function(){return this._pts},St.prototype.size=function(){return this._pts.length},St.prototype.getCoordinate=function(o){return this._pts[o]},St.prototype.isClosed=function(){return this._pts[0].equals(this._pts[this._pts.length-1])},St.prototype.getSegmentOctant=function(o){return o===this._pts.length-1?-1:ba.octant(this.getCoordinate(o),this.getCoordinate(o+1))},St.prototype.setData=function(o){this._data=o},St.prototype.getData=function(){return this._data},St.prototype.toString=function(){return Cn.toLineString(new qa(this._pts))},St.prototype.interfaces_=function(){return[gs]},St.prototype.getClass=function(){return St};var ve=function(){this._findAllIntersections=!1,this._isCheckEndSegmentsOnly=!1,this._li=null,this._interiorIntersection=null,this._intSegments=null,this._intersections=new Wr,this._intersectionCount=0,this._keepIntersections=!0;var o=arguments[0];this._li=o,this._interiorIntersection=null};ve.prototype.getInteriorIntersection=function(){return this._interiorIntersection},ve.prototype.setCheckEndSegmentsOnly=function(o){this._isCheckEndSegmentsOnly=o},ve.prototype.getIntersectionSegments=function(){return this._intSegments},ve.prototype.count=function(){return this._intersectionCount},ve.prototype.getIntersections=function(){return this._intersections},ve.prototype.setFindAllIntersections=function(o){this._findAllIntersections=o},ve.prototype.setKeepIntersections=function(o){this._keepIntersections=o},ve.prototype.processIntersections=function(o,u,v,y){if(!this._findAllIntersections&&this.hasIntersection()||o===v&&u===y||this._isCheckEndSegmentsOnly&&!(this.isEndSegment(o,u)||this.isEndSegment(v,y)))return null;var b=o.getCoordinates()[u],H=o.getCoordinates()[u+1],ne=v.getCoordinates()[y],Le=v.getCoordinates()[y+1];this._li.computeIntersection(b,H,ne,Le),this._li.hasIntersection()&&this._li.isInteriorIntersection()&&(this._intSegments=new Array(4).fill(null),this._intSegments[0]=b,this._intSegments[1]=H,this._intSegments[2]=ne,this._intSegments[3]=Le,this._interiorIntersection=this._li.getIntersection(0),this._keepIntersections&&this._intersections.add(this._interiorIntersection),this._intersectionCount++)},ve.prototype.isEndSegment=function(o,u){return u===0||u>=o.size()-2},ve.prototype.hasIntersection=function(){return this._interiorIntersection!==null},ve.prototype.isDone=function(){return!this._findAllIntersections&&this._interiorIntersection!==null},ve.prototype.interfaces_=function(){return[Qs]},ve.prototype.getClass=function(){return ve},ve.createAllIntersectionsFinder=function(o){var u=new ve(o);return u.setFindAllIntersections(!0),u},ve.createAnyIntersectionFinder=function(o){return new ve(o)},ve.createIntersectionCounter=function(o){var u=new ve(o);return u.setFindAllIntersections(!0),u.setKeepIntersections(!1),u};var hu=function(){this._li=new Qe,this._segStrings=null,this._findAllIntersections=!1,this._segInt=null,this._isValid=!0;var o=arguments[0];this._segStrings=o};hu.prototype.execute=function(){if(this._segInt!==null)return null;this.checkInteriorIntersections()},hu.prototype.getIntersections=function(){return this._segInt.getIntersections()},hu.prototype.isValid=function(){return this.execute(),this._isValid},hu.prototype.setFindAllIntersections=function(o){this._findAllIntersections=o},hu.prototype.checkInteriorIntersections=function(){this._isValid=!0,this._segInt=new ve(this._li),this._segInt.setFindAllIntersections(this._findAllIntersections);var o=new nf;if(o.setSegmentIntersector(this._segInt),o.computeNodes(this._segStrings),this._segInt.hasIntersection())return this._isValid=!1,null},hu.prototype.checkValid=function(){if(this.execute(),!this._isValid)throw new Ht(this.getErrorMessage(),this._segInt.getInteriorIntersection())},hu.prototype.getErrorMessage=function(){if(this._isValid)return"no intersections found";var o=this._segInt.getIntersectionSegments();return"found non-noded intersection between "+Cn.toLineString(o[0],o[1])+" and "+Cn.toLineString(o[2],o[3])},hu.prototype.interfaces_=function(){return[]},hu.prototype.getClass=function(){return hu},hu.computeIntersections=function(o){var u=new hu(o);return u.setFindAllIntersections(!0),u.isValid(),u.getIntersections()};var it=function o(){this._nv=null;var u=arguments[0];this._nv=new hu(o.toSegmentStrings(u))};it.prototype.checkValid=function(){this._nv.checkValid()},it.prototype.interfaces_=function(){return[]},it.prototype.getClass=function(){return it},it.toSegmentStrings=function(o){for(var u=new Wr,v=o.iterator();v.hasNext();){var y=v.next();u.add(new St(y.getCoordinates(),y))}return u},it.checkValid=function(o){new it(o).checkValid()};var Eu=function(o){this._mapOp=o};Eu.prototype.map=function(o){for(var u=new Wr,v=0;v<o.getNumGeometries();v++){var y=this._mapOp.map(o.getGeometryN(v));y.isEmpty()||u.add(y)}return o.getFactory().createGeometryCollection(Ri.toGeometryArray(u))},Eu.prototype.interfaces_=function(){return[]},Eu.prototype.getClass=function(){return Eu},Eu.map=function(o,u){return new Eu(u).map(o)};var Si=function(){this._op=null,this._geometryFactory=null,this._ptLocator=null,this._lineEdgesList=new Wr,this._resultLineList=new Wr;var o=arguments[0],u=arguments[1],v=arguments[2];this._op=o,this._geometryFactory=u,this._ptLocator=v};Si.prototype.collectLines=function(o){for(var u=this._op.getGraph().getEdgeEnds().iterator();u.hasNext();){var v=u.next();this.collectLineEdge(v,o,this._lineEdgesList),this.collectBoundaryTouchEdge(v,o,this._lineEdgesList)}},Si.prototype.labelIsolatedLine=function(o,u){var v=this._ptLocator.locate(o.getCoordinate(),this._op.getArgGeometry(u));o.getLabel().setLocation(u,v)},Si.prototype.build=function(o){return this.findCoveredLineEdges(),this.collectLines(o),this.buildLines(o),this._resultLineList},Si.prototype.collectLineEdge=function(o,u,v){var y=o.getLabel(),b=o.getEdge();o.isLineEdge()&&(o.isVisited()||!Qn.isResultOfOp(y,u)||b.isCovered()||(v.add(b),o.setVisitedEdge(!0)))},Si.prototype.findCoveredLineEdges=function(){for(var o=this._op.getGraph().getNodes().iterator();o.hasNext();)o.next().getEdges().findCoveredLineEdges();for(var u=this._op.getGraph().getEdgeEnds().iterator();u.hasNext();){var v=u.next(),y=v.getEdge();if(v.isLineEdge()&&!y.isCoveredSet()){var b=this._op.isCoveredByA(v.getCoordinate());y.setCovered(b)}}},Si.prototype.labelIsolatedLines=function(o){for(var u=o.iterator();u.hasNext();){var v=u.next(),y=v.getLabel();v.isIsolated()&&(y.isNull(0)?this.labelIsolatedLine(v,0):this.labelIsolatedLine(v,1))}},Si.prototype.buildLines=function(o){for(var u=this._lineEdgesList.iterator();u.hasNext();){var v=u.next(),y=this._geometryFactory.createLineString(v.getCoordinates());this._resultLineList.add(y),v.setInResult(!0)}},Si.prototype.collectBoundaryTouchEdge=function(o,u,v){var y=o.getLabel();return o.isLineEdge()||o.isVisited()||o.isInteriorAreaEdge()||o.getEdge().isInResult()?null:(Ft.isTrue(!(o.isInResult()||o.getSym().isInResult())||!o.getEdge().isInResult()),void(Qn.isResultOfOp(y,u)&&u===Qn.INTERSECTION&&(v.add(o.getEdge()),o.setVisitedEdge(!0))))},Si.prototype.interfaces_=function(){return[]},Si.prototype.getClass=function(){return Si};var cl=function(){this._op=null,this._geometryFactory=null,this._resultPointList=new Wr;var o=arguments[0],u=arguments[1];this._op=o,this._geometryFactory=u};cl.prototype.filterCoveredNodeToPoint=function(o){var u=o.getCoordinate();if(!this._op.isCoveredByLA(u)){var v=this._geometryFactory.createPoint(u);this._resultPointList.add(v)}},cl.prototype.extractNonCoveredResultNodes=function(o){for(var u=this._op.getGraph().getNodes().iterator();u.hasNext();){var v=u.next();if(!v.isInResult()&&!v.isIncidentEdgeInResult()&&(v.getEdges().getDegree()===0||o===Qn.INTERSECTION)){var y=v.getLabel();Qn.isResultOfOp(y,o)&&this.filterCoveredNodeToPoint(v)}}},cl.prototype.build=function(o){return this.extractNonCoveredResultNodes(o),this._resultPointList},cl.prototype.interfaces_=function(){return[]},cl.prototype.getClass=function(){return cl};var va=function(){this._inputGeom=null,this._factory=null,this._pruneEmptyGeometry=!0,this._preserveGeometryCollectionType=!0,this._preserveCollections=!1,this._preserveType=!1};va.prototype.transformPoint=function(o,u){return this._factory.createPoint(this.transformCoordinates(o.getCoordinateSequence(),o))},va.prototype.transformPolygon=function(o,u){var v=!0,y=this.transformLinearRing(o.getExteriorRing(),o);y!==null&&y instanceof cr&&!y.isEmpty()||(v=!1);for(var b=new Wr,H=0;H<o.getNumInteriorRing();H++){var ne=this.transformLinearRing(o.getInteriorRingN(H),o);ne===null||ne.isEmpty()||(ne instanceof cr||(v=!1),b.add(ne))}if(v)return this._factory.createPolygon(y,b.toArray([]));var Le=new Wr;return y!==null&&Le.add(y),Le.addAll(b),this._factory.buildGeometry(Le)},va.prototype.createCoordinateSequence=function(o){return this._factory.getCoordinateSequenceFactory().create(o)},va.prototype.getInputGeometry=function(){return this._inputGeom},va.prototype.transformMultiLineString=function(o,u){for(var v=new Wr,y=0;y<o.getNumGeometries();y++){var b=this.transformLineString(o.getGeometryN(y),o);b!==null&&(b.isEmpty()||v.add(b))}return this._factory.buildGeometry(v)},va.prototype.transformCoordinates=function(o,u){return this.copy(o)},va.prototype.transformLineString=function(o,u){return this._factory.createLineString(this.transformCoordinates(o.getCoordinateSequence(),o))},va.prototype.transformMultiPoint=function(o,u){for(var v=new Wr,y=0;y<o.getNumGeometries();y++){var b=this.transformPoint(o.getGeometryN(y),o);b!==null&&(b.isEmpty()||v.add(b))}return this._factory.buildGeometry(v)},va.prototype.transformMultiPolygon=function(o,u){for(var v=new Wr,y=0;y<o.getNumGeometries();y++){var b=this.transformPolygon(o.getGeometryN(y),o);b!==null&&(b.isEmpty()||v.add(b))}return this._factory.buildGeometry(v)},va.prototype.copy=function(o){return o.copy()},va.prototype.transformGeometryCollection=function(o,u){for(var v=new Wr,y=0;y<o.getNumGeometries();y++){var b=this.transform(o.getGeometryN(y));b!==null&&(this._pruneEmptyGeometry&&b.isEmpty()||v.add(b))}return this._preserveGeometryCollectionType?this._factory.createGeometryCollection(Ri.toGeometryArray(v)):this._factory.buildGeometry(v)},va.prototype.transform=function(o){if(this._inputGeom=o,this._factory=o.getFactory(),o instanceof Co)return this.transformPoint(o,null);if(o instanceof Ru)return this.transformMultiPoint(o,null);if(o instanceof cr)return this.transformLinearRing(o,null);if(o instanceof Oa)return this.transformLineString(o,null);if(o instanceof Qi)return this.transformMultiLineString(o,null);if(o instanceof ka)return this.transformPolygon(o,null);if(o instanceof yn)return this.transformMultiPolygon(o,null);if(o instanceof rs)return this.transformGeometryCollection(o,null);throw new Me("Unknown Geometry subtype: "+o.getClass().getName())},va.prototype.transformLinearRing=function(o,u){var v=this.transformCoordinates(o.getCoordinateSequence(),o);if(v===null)return this._factory.createLinearRing(null);var y=v.size();return y>0&&y<4&&!this._preserveType?this._factory.createLineString(v):this._factory.createLinearRing(v)},va.prototype.interfaces_=function(){return[]},va.prototype.getClass=function(){return va};var pa=function o(){if(this._snapTolerance=0,this._srcPts=null,this._seg=new On,this._allowSnappingToSourceVertices=!1,this._isClosed=!1,arguments[0]instanceof Oa&&typeof arguments[1]=="number"){var u=arguments[0],v=arguments[1];o.call(this,u.getCoordinates(),v)}else if(arguments[0]instanceof Array&&typeof arguments[1]=="number"){var y=arguments[0],b=arguments[1];this._srcPts=y,this._isClosed=o.isClosed(y),this._snapTolerance=b}};pa.prototype.snapVertices=function(o,u){for(var v=this._isClosed?o.size()-1:o.size(),y=0;y<v;y++){var b=o.get(y),H=this.findSnapForVertex(b,u);H!==null&&(o.set(y,new Y(H)),y===0&&this._isClosed&&o.set(o.size()-1,new Y(H)))}},pa.prototype.findSnapForVertex=function(o,u){for(var v=0;v<u.length;v++){if(o.equals2D(u[v]))return null;if(o.distance(u[v])<this._snapTolerance)return u[v]}return null},pa.prototype.snapTo=function(o){var u=new Xo(this._srcPts);return this.snapVertices(u,o),this.snapSegments(u,o),u.toCoordinateArray()},pa.prototype.snapSegments=function(o,u){if(u.length===0)return null;var v=u.length;u[0].equals2D(u[u.length-1])&&(v=u.length-1);for(var y=0;y<v;y++){var b=u[y],H=this.findSegmentIndexToSnap(b,o);H>=0&&o.add(H+1,new Y(b),!1)}},pa.prototype.findSegmentIndexToSnap=function(o,u){for(var v=ce.MAX_VALUE,y=-1,b=0;b<u.size()-1;b++){if(this._seg.p0=u.get(b),this._seg.p1=u.get(b+1),this._seg.p0.equals2D(o)||this._seg.p1.equals2D(o)){if(this._allowSnappingToSourceVertices)continue;return-1}var H=this._seg.distance(o);H<this._snapTolerance&&H<v&&(v=H,y=b)}return y},pa.prototype.setAllowSnappingToSourceVertices=function(o){this._allowSnappingToSourceVertices=o},pa.prototype.interfaces_=function(){return[]},pa.prototype.getClass=function(){return pa},pa.isClosed=function(o){return!(o.length<=1)&&o[0].equals2D(o[o.length-1])};var Bi=function(o){this._srcGeom=o||null},Go={SNAP_PRECISION_FACTOR:{configurable:!0}};Bi.prototype.snapTo=function(o,u){var v=this.extractTargetCoordinates(o);return new qi(u,v).transform(this._srcGeom)},Bi.prototype.snapToSelf=function(o,u){var v=this.extractTargetCoordinates(this._srcGeom),y=new qi(o,v,!0).transform(this._srcGeom),b=y;return u&&Pe(b,gu)&&(b=y.buffer(0)),b},Bi.prototype.computeSnapTolerance=function(o){return this.computeMinimumSegmentLength(o)/10},Bi.prototype.extractTargetCoordinates=function(o){for(var u=new Ze,v=o.getCoordinates(),y=0;y<v.length;y++)u.add(v[y]);return u.toArray(new Array(0).fill(null))},Bi.prototype.computeMinimumSegmentLength=function(o){for(var u=ce.MAX_VALUE,v=0;v<o.length-1;v++){var y=o[v].distance(o[v+1]);y<u&&(u=y)}return u},Bi.prototype.interfaces_=function(){return[]},Bi.prototype.getClass=function(){return Bi},Bi.snap=function(o,u,v){var y=new Array(2).fill(null),b=new Bi(o);y[0]=b.snapTo(u,v);var H=new Bi(u);return y[1]=H.snapTo(y[0],v),y},Bi.computeOverlaySnapTolerance=function(){if(arguments.length===1){var o=arguments[0],u=Bi.computeSizeBasedSnapTolerance(o),v=o.getPrecisionModel();if(v.getType()===Oi.FIXED){var y=1/v.getScale()*2/1.415;y>u&&(u=y)}return u}if(arguments.length===2){var b=arguments[0],H=arguments[1];return Math.min(Bi.computeOverlaySnapTolerance(b),Bi.computeOverlaySnapTolerance(H))}},Bi.computeSizeBasedSnapTolerance=function(o){var u=o.getEnvelopeInternal();return Math.min(u.getHeight(),u.getWidth())*Bi.SNAP_PRECISION_FACTOR},Bi.snapToSelf=function(o,u,v){return new Bi(o).snapToSelf(u,v)},Go.SNAP_PRECISION_FACTOR.get=function(){return 1e-9},Object.defineProperties(Bi,Go);var qi=function(o){function u(v,y,b){o.call(this),this._snapTolerance=v||null,this._snapPts=y||null,this._isSelfSnap=b!==void 0&&b}return o&&(u.__proto__=o),u.prototype=Object.create(o&&o.prototype),u.prototype.constructor=u,u.prototype.snapLine=function(v,y){var b=new pa(v,this._snapTolerance);return b.setAllowSnappingToSourceVertices(this._isSelfSnap),b.snapTo(y)},u.prototype.transformCoordinates=function(v,y){var b=v.toCoordinateArray(),H=this.snapLine(b,this._snapPts);return this._factory.getCoordinateSequenceFactory().create(H)},u.prototype.interfaces_=function(){return[]},u.prototype.getClass=function(){return u},u}(va),ni=function(){this._isFirst=!0,this._commonMantissaBitsCount=53,this._commonBits=0,this._commonSignExp=null};ni.prototype.getCommon=function(){return ce.longBitsToDouble(this._commonBits)},ni.prototype.add=function(o){var u=ce.doubleToLongBits(o);if(this._isFirst)return this._commonBits=u,this._commonSignExp=ni.signExpBits(this._commonBits),this._isFirst=!1,null;if(ni.signExpBits(u)!==this._commonSignExp)return this._commonBits=0,null;this._commonMantissaBitsCount=ni.numCommonMostSigMantissaBits(this._commonBits,u),this._commonBits=ni.zeroLowerBits(this._commonBits,64-(12+this._commonMantissaBitsCount))},ni.prototype.toString=function(){if(arguments.length===1){var o=arguments[0],u=ce.longBitsToDouble(o),v="0000000000000000000000000000000000000000000000000000000000000000"+ce.toBinaryString(o),y=v.substring(v.length-64);return y.substring(0,1)+"  "+y.substring(1,12)+"(exp) "+y.substring(12)+" [ "+u+" ]"}},ni.prototype.interfaces_=function(){return[]},ni.prototype.getClass=function(){return ni},ni.getBit=function(o,u){return o&1<<u?1:0},ni.signExpBits=function(o){return o>>52},ni.zeroLowerBits=function(o,u){return o&~((1<<u)-1)},ni.numCommonMostSigMantissaBits=function(o,u){for(var v=0,y=52;y>=0;y--){if(ni.getBit(o,y)!==ni.getBit(u,y))return v;v++}return 52};var Pi=function(){this._commonCoord=null,this._ccFilter=new Ii},oa={CommonCoordinateFilter:{configurable:!0},Translater:{configurable:!0}};Pi.prototype.addCommonBits=function(o){var u=new xi(this._commonCoord);o.apply(u),o.geometryChanged()},Pi.prototype.removeCommonBits=function(o){if(this._commonCoord.x===0&&this._commonCoord.y===0)return o;var u=new Y(this._commonCoord);u.x=-u.x,u.y=-u.y;var v=new xi(u);return o.apply(v),o.geometryChanged(),o},Pi.prototype.getCommonCoordinate=function(){return this._commonCoord},Pi.prototype.add=function(o){o.apply(this._ccFilter),this._commonCoord=this._ccFilter.getCommonCoordinate()},Pi.prototype.interfaces_=function(){return[]},Pi.prototype.getClass=function(){return Pi},oa.CommonCoordinateFilter.get=function(){return Ii},oa.Translater.get=function(){return xi},Object.defineProperties(Pi,oa);var Ii=function(){this._commonBitsX=new ni,this._commonBitsY=new ni};Ii.prototype.filter=function(o){this._commonBitsX.add(o.x),this._commonBitsY.add(o.y)},Ii.prototype.getCommonCoordinate=function(){return new Y(this._commonBitsX.getCommon(),this._commonBitsY.getCommon())},Ii.prototype.interfaces_=function(){return[Lr]},Ii.prototype.getClass=function(){return Ii};var xi=function(){this.trans=null;var o=arguments[0];this.trans=o};xi.prototype.filter=function(o,u){var v=o.getOrdinate(u,0)+this.trans.x,y=o.getOrdinate(u,1)+this.trans.y;o.setOrdinate(u,0,v),o.setOrdinate(u,1,y)},xi.prototype.isDone=function(){return!1},xi.prototype.isGeometryChanged=function(){return!0},xi.prototype.interfaces_=function(){return[Rs]},xi.prototype.getClass=function(){return xi};var Un=function(o,u){this._geom=new Array(2).fill(null),this._snapTolerance=null,this._cbr=null,this._geom[0]=o,this._geom[1]=u,this.computeSnapTolerance()};Un.prototype.selfSnap=function(o){return new Bi(o).snapTo(o,this._snapTolerance)},Un.prototype.removeCommonBits=function(o){this._cbr=new Pi,this._cbr.add(o[0]),this._cbr.add(o[1]);var u=new Array(2).fill(null);return u[0]=this._cbr.removeCommonBits(o[0].copy()),u[1]=this._cbr.removeCommonBits(o[1].copy()),u},Un.prototype.prepareResult=function(o){return this._cbr.addCommonBits(o),o},Un.prototype.getResultGeometry=function(o){var u=this.snap(this._geom),v=Qn.overlayOp(u[0],u[1],o);return this.prepareResult(v)},Un.prototype.checkValid=function(o){o.isValid()||Qr.out.println("Snapped geometry is invalid")},Un.prototype.computeSnapTolerance=function(){this._snapTolerance=Bi.computeOverlaySnapTolerance(this._geom[0],this._geom[1])},Un.prototype.snap=function(o){var u=this.removeCommonBits(o);return Bi.snap(u[0],u[1],this._snapTolerance)},Un.prototype.interfaces_=function(){return[]},Un.prototype.getClass=function(){return Un},Un.overlayOp=function(o,u,v){return new Un(o,u).getResultGeometry(v)},Un.union=function(o,u){return Un.overlayOp(o,u,Qn.UNION)},Un.intersection=function(o,u){return Un.overlayOp(o,u,Qn.INTERSECTION)},Un.symDifference=function(o,u){return Un.overlayOp(o,u,Qn.SYMDIFFERENCE)},Un.difference=function(o,u){return Un.overlayOp(o,u,Qn.DIFFERENCE)};var ii=function(o,u){this._geom=new Array(2).fill(null),this._geom[0]=o,this._geom[1]=u};ii.prototype.getResultGeometry=function(o){var u=null,v=!1,y=null;try{u=Qn.overlayOp(this._geom[0],this._geom[1],o),v=!0}catch(b){if(!(b instanceof $i))throw b;y=b}if(!v)try{u=Un.overlayOp(this._geom[0],this._geom[1],o)}catch(b){throw b instanceof $i?y:b}return u},ii.prototype.interfaces_=function(){return[]},ii.prototype.getClass=function(){return ii},ii.overlayOp=function(o,u,v){return new ii(o,u).getResultGeometry(v)},ii.union=function(o,u){return ii.overlayOp(o,u,Qn.UNION)},ii.intersection=function(o,u){return ii.overlayOp(o,u,Qn.INTERSECTION)},ii.symDifference=function(o,u){return ii.overlayOp(o,u,Qn.SYMDIFFERENCE)},ii.difference=function(o,u){return ii.overlayOp(o,u,Qn.DIFFERENCE)};var ki=function(){this.mce=null,this.chainIndex=null;var o=arguments[0],u=arguments[1];this.mce=o,this.chainIndex=u};ki.prototype.computeIntersections=function(o,u){this.mce.computeIntersectsForChain(this.chainIndex,o.mce,o.chainIndex,u)},ki.prototype.interfaces_=function(){return[]},ki.prototype.getClass=function(){return ki};var fi=function o(){if(this._label=null,this._xValue=null,this._eventType=null,this._insertEvent=null,this._deleteEventIndex=null,this._obj=null,arguments.length===2){var u=arguments[0],v=arguments[1];this._eventType=o.DELETE,this._xValue=u,this._insertEvent=v}else if(arguments.length===3){var y=arguments[0],b=arguments[1],H=arguments[2];this._eventType=o.INSERT,this._label=y,this._xValue=b,this._obj=H}},Vi={INSERT:{configurable:!0},DELETE:{configurable:!0}};fi.prototype.isDelete=function(){return this._eventType===fi.DELETE},fi.prototype.setDeleteEventIndex=function(o){this._deleteEventIndex=o},fi.prototype.getObject=function(){return this._obj},fi.prototype.compareTo=function(o){var u=o;return this._xValue<u._xValue?-1:this._xValue>u._xValue?1:this._eventType<u._eventType?-1:this._eventType>u._eventType?1:0},fi.prototype.getInsertEvent=function(){return this._insertEvent},fi.prototype.isInsert=function(){return this._eventType===fi.INSERT},fi.prototype.isSameLabel=function(o){return this._label!==null&&this._label===o._label},fi.prototype.getDeleteEventIndex=function(){return this._deleteEventIndex},fi.prototype.interfaces_=function(){return[Ee]},fi.prototype.getClass=function(){return fi},Vi.INSERT.get=function(){return 1},Vi.DELETE.get=function(){return 2},Object.defineProperties(fi,Vi);var ra=function(){};ra.prototype.interfaces_=function(){return[]},ra.prototype.getClass=function(){return ra};var Dn=function(){this._hasIntersection=!1,this._hasProper=!1,this._hasProperInterior=!1,this._properIntersectionPoint=null,this._li=null,this._includeProper=null,this._recordIsolated=null,this._isSelfIntersection=null,this._numIntersections=0,this.numTests=0,this._bdyNodes=null,this._isDone=!1,this._isDoneWhenProperInt=!1;var o=arguments[0],u=arguments[1],v=arguments[2];this._li=o,this._includeProper=u,this._recordIsolated=v};Dn.prototype.isTrivialIntersection=function(o,u,v,y){if(o===v&&this._li.getIntersectionNum()===1){if(Dn.isAdjacentSegments(u,y))return!0;if(o.isClosed()){var b=o.getNumPoints()-1;if(u===0&&y===b||y===0&&u===b)return!0}}return!1},Dn.prototype.getProperIntersectionPoint=function(){return this._properIntersectionPoint},Dn.prototype.setIsDoneIfProperInt=function(o){this._isDoneWhenProperInt=o},Dn.prototype.hasProperInteriorIntersection=function(){return this._hasProperInterior},Dn.prototype.isBoundaryPointInternal=function(o,u){for(var v=u.iterator();v.hasNext();){var y=v.next().getCoordinate();if(o.isIntersection(y))return!0}return!1},Dn.prototype.hasProperIntersection=function(){return this._hasProper},Dn.prototype.hasIntersection=function(){return this._hasIntersection},Dn.prototype.isDone=function(){return this._isDone},Dn.prototype.isBoundaryPoint=function(o,u){return u!==null&&(!!this.isBoundaryPointInternal(o,u[0])||!!this.isBoundaryPointInternal(o,u[1]))},Dn.prototype.setBoundaryNodes=function(o,u){this._bdyNodes=new Array(2).fill(null),this._bdyNodes[0]=o,this._bdyNodes[1]=u},Dn.prototype.addIntersections=function(o,u,v,y){if(o===v&&u===y)return null;this.numTests++;var b=o.getCoordinates()[u],H=o.getCoordinates()[u+1],ne=v.getCoordinates()[y],Le=v.getCoordinates()[y+1];this._li.computeIntersection(b,H,ne,Le),this._li.hasIntersection()&&(this._recordIsolated&&(o.setIsolated(!1),v.setIsolated(!1)),this._numIntersections++,this.isTrivialIntersection(o,u,v,y)||(this._hasIntersection=!0,!this._includeProper&&this._li.isProper()||(o.addIntersections(this._li,u,0),v.addIntersections(this._li,y,1)),this._li.isProper()&&(this._properIntersectionPoint=this._li.getIntersection(0).copy(),this._hasProper=!0,this._isDoneWhenProperInt&&(this._isDone=!0),this.isBoundaryPoint(this._li,this._bdyNodes)||(this._hasProperInterior=!0))))},Dn.prototype.interfaces_=function(){return[]},Dn.prototype.getClass=function(){return Dn},Dn.isAdjacentSegments=function(o,u){return Math.abs(o-u)===1};var Hi=function(o){function u(){o.call(this),this.events=new Wr,this.nOverlaps=null}return o&&(u.__proto__=o),u.prototype=Object.create(o&&o.prototype),u.prototype.constructor=u,u.prototype.prepareEvents=function(){io.sort(this.events);for(var v=0;v<this.events.size();v++){var y=this.events.get(v);y.isDelete()&&y.getInsertEvent().setDeleteEventIndex(v)}},u.prototype.computeIntersections=function(){if(arguments.length===1){var v=arguments[0];this.nOverlaps=0,this.prepareEvents();for(var y=0;y<this.events.size();y++){var b=this.events.get(y);if(b.isInsert()&&this.processOverlaps(y,b.getDeleteEventIndex(),b,v),v.isDone())break}}else if(arguments.length===3){if(arguments[2]instanceof Dn&&Pe(arguments[0],ja)&&Pe(arguments[1],ja)){var H=arguments[0],ne=arguments[1],Le=arguments[2];this.addEdges(H,H),this.addEdges(ne,ne),this.computeIntersections(Le)}else if(typeof arguments[2]=="boolean"&&Pe(arguments[0],ja)&&arguments[1]instanceof Dn){var tt=arguments[0],Nt=arguments[1];arguments[2]?this.addEdges(tt,null):this.addEdges(tt),this.computeIntersections(Nt)}}},u.prototype.addEdge=function(v,y){for(var b=v.getMonotoneChainEdge(),H=b.getStartIndexes(),ne=0;ne<H.length-1;ne++){var Le=new ki(b,ne),tt=new fi(y,b.getMinX(ne),Le);this.events.add(tt),this.events.add(new fi(b.getMaxX(ne),tt))}},u.prototype.processOverlaps=function(v,y,b,H){for(var ne=b.getObject(),Le=v;Le<y;Le++){var tt=this.events.get(Le);if(tt.isInsert()){var Nt=tt.getObject();b.isSameLabel(tt)||(ne.computeIntersections(Nt,H),this.nOverlaps++)}}},u.prototype.addEdges=function(){if(arguments.length===1)for(var v=arguments[0].iterator();v.hasNext();){var y=v.next();this.addEdge(y,y)}else if(arguments.length===2)for(var b=arguments[0],H=arguments[1],ne=b.iterator();ne.hasNext();){var Le=ne.next();this.addEdge(Le,H)}},u.prototype.interfaces_=function(){return[]},u.prototype.getClass=function(){return u},u}(ra),yi=function(){this._min=ce.POSITIVE_INFINITY,this._max=ce.NEGATIVE_INFINITY},na={NodeComparator:{configurable:!0}};yi.prototype.getMin=function(){return this._min},yi.prototype.intersects=function(o,u){return!(this._min>u||this._max<o)},yi.prototype.getMax=function(){return this._max},yi.prototype.toString=function(){return Cn.toLineString(new Y(this._min,0),new Y(this._max,0))},yi.prototype.interfaces_=function(){return[]},yi.prototype.getClass=function(){return yi},na.NodeComparator.get=function(){return Wi},Object.defineProperties(yi,na);var Wi=function(){};Wi.prototype.compare=function(o,u){var v=o,y=u,b=(v._min+v._max)/2,H=(y._min+y._max)/2;return b<H?-1:b>H?1:0},Wi.prototype.interfaces_=function(){return[oe]},Wi.prototype.getClass=function(){return Wi};var ua=function(o){function u(){o.call(this),this._item=null;var v=arguments[0],y=arguments[1],b=arguments[2];this._min=v,this._max=y,this._item=b}return o&&(u.__proto__=o),u.prototype=Object.create(o&&o.prototype),u.prototype.constructor=u,u.prototype.query=function(v,y,b){if(!this.intersects(v,y))return null;b.visitItem(this._item)},u.prototype.interfaces_=function(){return[]},u.prototype.getClass=function(){return u},u}(yi),la=function(o){function u(){o.call(this),this._node1=null,this._node2=null;var v=arguments[0],y=arguments[1];this._node1=v,this._node2=y,this.buildExtent(this._node1,this._node2)}return o&&(u.__proto__=o),u.prototype=Object.create(o&&o.prototype),u.prototype.constructor=u,u.prototype.buildExtent=function(v,y){this._min=Math.min(v._min,y._min),this._max=Math.max(v._max,y._max)},u.prototype.query=function(v,y,b){if(!this.intersects(v,y))return null;this._node1!==null&&this._node1.query(v,y,b),this._node2!==null&&this._node2.query(v,y,b)},u.prototype.interfaces_=function(){return[]},u.prototype.getClass=function(){return u},u}(yi),Ti=function(){this._leaves=new Wr,this._root=null,this._level=0};Ti.prototype.buildTree=function(){io.sort(this._leaves,new yi.NodeComparator);for(var o=this._leaves,u=null,v=new Wr;;){if(this.buildLevel(o,v),v.size()===1)return v.get(0);u=o,o=v,v=u}},Ti.prototype.insert=function(o,u,v){if(this._root!==null)throw new Error("Index cannot be added to once it has been queried");this._leaves.add(new ua(o,u,v))},Ti.prototype.query=function(o,u,v){this.init(),this._root.query(o,u,v)},Ti.prototype.buildRoot=function(){if(this._root!==null)return null;this._root=this.buildTree()},Ti.prototype.printNode=function(o){Qr.out.println(Cn.toLineString(new Y(o._min,this._level),new Y(o._max,this._level)))},Ti.prototype.init=function(){if(this._root!==null)return null;this.buildRoot()},Ti.prototype.buildLevel=function(o,u){this._level++,u.clear();for(var v=0;v<o.size();v+=2){var y=o.get(v);if((v+1<o.size()?o.get(v):null)===null)u.add(y);else{var b=new la(o.get(v),o.get(v+1));u.add(b)}}},Ti.prototype.interfaces_=function(){return[]},Ti.prototype.getClass=function(){return Ti};var Ui=function(){this._items=new Wr};Ui.prototype.visitItem=function(o){this._items.add(o)},Ui.prototype.getItems=function(){return this._items},Ui.prototype.interfaces_=function(){return[ws]},Ui.prototype.getClass=function(){return Ui};var Zi=function(){this._index=null;var o=arguments[0];if(!Pe(o,gu))throw new Me("Argument must be Polygonal");this._index=new ju(o)},ia={SegmentVisitor:{configurable:!0},IntervalIndexedGeometry:{configurable:!0}};Zi.prototype.locate=function(o){var u=new Lt(o),v=new Vn(u);return this._index.query(o.y,o.y,v),u.getLocation()},Zi.prototype.interfaces_=function(){return[Ou]},Zi.prototype.getClass=function(){return Zi},ia.SegmentVisitor.get=function(){return Vn},ia.IntervalIndexedGeometry.get=function(){return ju},Object.defineProperties(Zi,ia);var Vn=function(){this._counter=null;var o=arguments[0];this._counter=o};Vn.prototype.visitItem=function(o){var u=o;this._counter.countSegment(u.getCoordinate(0),u.getCoordinate(1))},Vn.prototype.interfaces_=function(){return[ws]},Vn.prototype.getClass=function(){return Vn};var ju=function(){this._index=new Ti;var o=arguments[0];this.init(o)};ju.prototype.init=function(o){for(var u=wo.getLines(o).iterator();u.hasNext();){var v=u.next().getCoordinates();this.addLine(v)}},ju.prototype.addLine=function(o){for(var u=1;u<o.length;u++){var v=new On(o[u-1],o[u]),y=Math.min(v.p0.y,v.p1.y),b=Math.max(v.p0.y,v.p1.y);this._index.insert(y,b,v)}},ju.prototype.query=function(){if(arguments.length===2){var o=arguments[0],u=arguments[1],v=new Ui;return this._index.query(o,u,v),v.getItems()}if(arguments.length===3){var y=arguments[0],b=arguments[1],H=arguments[2];this._index.query(y,b,H)}},ju.prototype.interfaces_=function(){return[]},ju.prototype.getClass=function(){return ju};var ql=function(o){function u(){if(o.call(this),this._parentGeom=null,this._lineEdgeMap=new Nc,this._boundaryNodeRule=null,this._useBoundaryDeterminationRule=!0,this._argIndex=null,this._boundaryNodes=null,this._hasTooFewPoints=!1,this._invalidPoint=null,this._areaPtLocator=null,this._ptLocator=new Wu,arguments.length===2){var v=arguments[0],y=arguments[1],b=on.OGC_SFS_BOUNDARY_RULE;this._argIndex=v,this._parentGeom=y,this._boundaryNodeRule=b,y!==null&&this.add(y)}else if(arguments.length===3){var H=arguments[0],ne=arguments[1],Le=arguments[2];this._argIndex=H,this._parentGeom=ne,this._boundaryNodeRule=Le,ne!==null&&this.add(ne)}}return o&&(u.__proto__=o),u.prototype=Object.create(o&&o.prototype),u.prototype.constructor=u,u.prototype.insertBoundaryPoint=function(v,y){var b=this._nodes.addNode(y).getLabel(),H=1;ye.NONE,b.getLocation(v,fe.ON)===ye.BOUNDARY&&H++;var ne=u.determineBoundary(this._boundaryNodeRule,H);b.setLocation(v,ne)},u.prototype.computeSelfNodes=function(){if(arguments.length===2){var v=arguments[0],y=arguments[1];return this.computeSelfNodes(v,y,!1)}if(arguments.length===3){var b=arguments[0],H=arguments[1],ne=arguments[2],Le=new Dn(b,!0,!1);Le.setIsDoneIfProperInt(ne);var tt=this.createEdgeSetIntersector(),Nt=this._parentGeom instanceof cr||this._parentGeom instanceof ka||this._parentGeom instanceof yn,ar=H||!Nt;return tt.computeIntersections(this._edges,Le,ar),this.addSelfIntersectionNodes(this._argIndex),Le}},u.prototype.computeSplitEdges=function(v){for(var y=this._edges.iterator();y.hasNext();)y.next().eiList.addSplitEdges(v)},u.prototype.computeEdgeIntersections=function(v,y,b){var H=new Dn(y,b,!0);return H.setBoundaryNodes(this.getBoundaryNodes(),v.getBoundaryNodes()),this.createEdgeSetIntersector().computeIntersections(this._edges,v._edges,H),H},u.prototype.getGeometry=function(){return this._parentGeom},u.prototype.getBoundaryNodeRule=function(){return this._boundaryNodeRule},u.prototype.hasTooFewPoints=function(){return this._hasTooFewPoints},u.prototype.addPoint=function(){if(arguments[0]instanceof Co){var v=arguments[0].getCoordinate();this.insertPoint(this._argIndex,v,ye.INTERIOR)}else if(arguments[0]instanceof Y){var y=arguments[0];this.insertPoint(this._argIndex,y,ye.INTERIOR)}},u.prototype.addPolygon=function(v){this.addPolygonRing(v.getExteriorRing(),ye.EXTERIOR,ye.INTERIOR);for(var y=0;y<v.getNumInteriorRing();y++){var b=v.getInteriorRingN(y);this.addPolygonRing(b,ye.INTERIOR,ye.EXTERIOR)}},u.prototype.addEdge=function(v){this.insertEdge(v);var y=v.getCoordinates();this.insertPoint(this._argIndex,y[0],ye.BOUNDARY),this.insertPoint(this._argIndex,y[y.length-1],ye.BOUNDARY)},u.prototype.addLineString=function(v){var y=Xn.removeRepeatedPoints(v.getCoordinates());if(y.length<2)return this._hasTooFewPoints=!0,this._invalidPoint=y[0],null;var b=new hc(y,new zn(this._argIndex,ye.INTERIOR));this._lineEdgeMap.put(v,b),this.insertEdge(b),Ft.isTrue(y.length>=2,"found LineString with single point"),this.insertBoundaryPoint(this._argIndex,y[0]),this.insertBoundaryPoint(this._argIndex,y[y.length-1])},u.prototype.getInvalidPoint=function(){return this._invalidPoint},u.prototype.getBoundaryPoints=function(){for(var v=this.getBoundaryNodes(),y=new Array(v.size()).fill(null),b=0,H=v.iterator();H.hasNext();){var ne=H.next();y[b++]=ne.getCoordinate().copy()}return y},u.prototype.getBoundaryNodes=function(){return this._boundaryNodes===null&&(this._boundaryNodes=this._nodes.getBoundaryNodes(this._argIndex)),this._boundaryNodes},u.prototype.addSelfIntersectionNode=function(v,y,b){if(this.isBoundaryNode(v,y))return null;b===ye.BOUNDARY&&this._useBoundaryDeterminationRule?this.insertBoundaryPoint(v,y):this.insertPoint(v,y,b)},u.prototype.addPolygonRing=function(v,y,b){if(v.isEmpty())return null;var H=Xn.removeRepeatedPoints(v.getCoordinates());if(H.length<4)return this._hasTooFewPoints=!0,this._invalidPoint=H[0],null;var ne=y,Le=b;Pt.isCCW(H)&&(ne=b,Le=y);var tt=new hc(H,new zn(this._argIndex,ye.BOUNDARY,ne,Le));this._lineEdgeMap.put(v,tt),this.insertEdge(tt),this.insertPoint(this._argIndex,H[0],ye.BOUNDARY)},u.prototype.insertPoint=function(v,y,b){var H=this._nodes.addNode(y),ne=H.getLabel();ne===null?H._label=new zn(v,b):ne.setLocation(v,b)},u.prototype.createEdgeSetIntersector=function(){return new Hi},u.prototype.addSelfIntersectionNodes=function(v){for(var y=this._edges.iterator();y.hasNext();)for(var b=y.next(),H=b.getLabel().getLocation(v),ne=b.eiList.iterator();ne.hasNext();){var Le=ne.next();this.addSelfIntersectionNode(v,Le.coord,H)}},u.prototype.add=function(){if(arguments.length!==1)return o.prototype.add.apply(this,arguments);var v=arguments[0];if(v.isEmpty())return null;if(v instanceof yn&&(this._useBoundaryDeterminationRule=!1),v instanceof ka)this.addPolygon(v);else if(v instanceof Oa)this.addLineString(v);else if(v instanceof Co)this.addPoint(v);else if(v instanceof Ru)this.addCollection(v);else if(v instanceof Qi)this.addCollection(v);else if(v instanceof yn)this.addCollection(v);else{if(!(v instanceof rs))throw new Error(v.getClass().getName());this.addCollection(v)}},u.prototype.addCollection=function(v){for(var y=0;y<v.getNumGeometries();y++){var b=v.getGeometryN(y);this.add(b)}},u.prototype.locate=function(v){return Pe(this._parentGeom,gu)&&this._parentGeom.getNumGeometries()>50?(this._areaPtLocator===null&&(this._areaPtLocator=new Zi(this._parentGeom)),this._areaPtLocator.locate(v)):this._ptLocator.locate(v,this._parentGeom)},u.prototype.findEdge=function(){if(arguments.length===1){var v=arguments[0];return this._lineEdgeMap.get(v)}return o.prototype.findEdge.apply(this,arguments)},u.prototype.interfaces_=function(){return[]},u.prototype.getClass=function(){return u},u.determineBoundary=function(v,y){return v.isInBoundary(y)?ye.BOUNDARY:ye.INTERIOR},u}(Xa),Us=function(){if(this._li=new Qe,this._resultPrecisionModel=null,this._arg=null,arguments.length===1){var o=arguments[0];this.setComputationPrecision(o.getPrecisionModel()),this._arg=new Array(1).fill(null),this._arg[0]=new ql(0,o)}else if(arguments.length===2){var u=arguments[0],v=arguments[1],y=on.OGC_SFS_BOUNDARY_RULE;u.getPrecisionModel().compareTo(v.getPrecisionModel())>=0?this.setComputationPrecision(u.getPrecisionModel()):this.setComputationPrecision(v.getPrecisionModel()),this._arg=new Array(2).fill(null),this._arg[0]=new ql(0,u,y),this._arg[1]=new ql(1,v,y)}else if(arguments.length===3){var b=arguments[0],H=arguments[1],ne=arguments[2];b.getPrecisionModel().compareTo(H.getPrecisionModel())>=0?this.setComputationPrecision(b.getPrecisionModel()):this.setComputationPrecision(H.getPrecisionModel()),this._arg=new Array(2).fill(null),this._arg[0]=new ql(0,b,ne),this._arg[1]=new ql(1,H,ne)}};Us.prototype.getArgGeometry=function(o){return this._arg[o].getGeometry()},Us.prototype.setComputationPrecision=function(o){this._resultPrecisionModel=o,this._li.setPrecisionModel(this._resultPrecisionModel)},Us.prototype.interfaces_=function(){return[]},Us.prototype.getClass=function(){return Us};var Lu=function(){};Lu.prototype.interfaces_=function(){return[]},Lu.prototype.getClass=function(){return Lu},Lu.map=function(){if(arguments[0]instanceof Ot&&Pe(arguments[1],Lu.MapOp)){for(var o=arguments[0],u=arguments[1],v=new Wr,y=0;y<o.getNumGeometries();y++){var b=u.map(o.getGeometryN(y));b!==null&&v.add(b)}return o.getFactory().buildGeometry(v)}if(Pe(arguments[0],mi)&&Pe(arguments[1],Lu.MapOp)){for(var H=arguments[0],ne=arguments[1],Le=new Wr,tt=H.iterator();tt.hasNext();){var Nt=tt.next(),ar=ne.map(Nt);ar!==null&&Le.add(ar)}return Le}},Lu.MapOp=function(){};var Qn=function(o){function u(){var v=arguments[0],y=arguments[1];o.call(this,v,y),this._ptLocator=new Wu,this._geomFact=null,this._resultGeom=null,this._graph=null,this._edgeList=new Mo,this._resultPolyList=new Wr,this._resultLineList=new Wr,this._resultPointList=new Wr,this._graph=new Xa(new kc),this._geomFact=v.getFactory()}return o&&(u.__proto__=o),u.prototype=Object.create(o&&o.prototype),u.prototype.constructor=u,u.prototype.insertUniqueEdge=function(v){var y=this._edgeList.findEqualEdge(v);if(y!==null){var b=y.getLabel(),H=v.getLabel();y.isPointwiseEqual(v)||(H=new zn(v.getLabel())).flip();var ne=y.getDepth();ne.isNull()&&ne.add(b),ne.add(H),b.merge(H)}else this._edgeList.add(v)},u.prototype.getGraph=function(){return this._graph},u.prototype.cancelDuplicateResultEdges=function(){for(var v=this._graph.getEdgeEnds().iterator();v.hasNext();){var y=v.next(),b=y.getSym();y.isInResult()&&b.isInResult()&&(y.setInResult(!1),b.setInResult(!1))}},u.prototype.isCoveredByLA=function(v){return!!this.isCovered(v,this._resultLineList)||!!this.isCovered(v,this._resultPolyList)},u.prototype.computeGeometry=function(v,y,b,H){var ne=new Wr;return ne.addAll(v),ne.addAll(y),ne.addAll(b),ne.isEmpty()?u.createEmptyResult(H,this._arg[0].getGeometry(),this._arg[1].getGeometry(),this._geomFact):this._geomFact.buildGeometry(ne)},u.prototype.mergeSymLabels=function(){for(var v=this._graph.getNodes().iterator();v.hasNext();)v.next().getEdges().mergeSymLabels()},u.prototype.isCovered=function(v,y){for(var b=y.iterator();b.hasNext();){var H=b.next();if(this._ptLocator.locate(v,H)!==ye.EXTERIOR)return!0}return!1},u.prototype.replaceCollapsedEdges=function(){for(var v=new Wr,y=this._edgeList.iterator();y.hasNext();){var b=y.next();b.isCollapsed()&&(y.remove(),v.add(b.getCollapsedEdge()))}this._edgeList.addAll(v)},u.prototype.updateNodeLabelling=function(){for(var v=this._graph.getNodes().iterator();v.hasNext();){var y=v.next(),b=y.getEdges().getLabel();y.getLabel().merge(b)}},u.prototype.getResultGeometry=function(v){return this.computeOverlay(v),this._resultGeom},u.prototype.insertUniqueEdges=function(v){for(var y=v.iterator();y.hasNext();){var b=y.next();this.insertUniqueEdge(b)}},u.prototype.computeOverlay=function(v){this.copyPoints(0),this.copyPoints(1),this._arg[0].computeSelfNodes(this._li,!1),this._arg[1].computeSelfNodes(this._li,!1),this._arg[0].computeEdgeIntersections(this._arg[1],this._li,!0);var y=new Wr;this._arg[0].computeSplitEdges(y),this._arg[1].computeSplitEdges(y),this.insertUniqueEdges(y),this.computeLabelsFromDepths(),this.replaceCollapsedEdges(),it.checkValid(this._edgeList.getEdges()),this._graph.addEdges(this._edgeList.getEdges()),this.computeLabelling(),this.labelIncompleteNodes(),this.findResultAreaEdges(v),this.cancelDuplicateResultEdges();var b=new Fn(this._geomFact);b.add(this._graph),this._resultPolyList=b.getPolygons();var H=new Si(this,this._geomFact,this._ptLocator);this._resultLineList=H.build(v);var ne=new cl(this,this._geomFact,this._ptLocator);this._resultPointList=ne.build(v),this._resultGeom=this.computeGeometry(this._resultPointList,this._resultLineList,this._resultPolyList,v)},u.prototype.labelIncompleteNode=function(v,y){var b=this._ptLocator.locate(v.getCoordinate(),this._arg[y].getGeometry());v.getLabel().setLocation(y,b)},u.prototype.copyPoints=function(v){for(var y=this._arg[v].getNodeIterator();y.hasNext();){var b=y.next();this._graph.addNode(b.getCoordinate()).setLabel(v,b.getLabel().getLocation(v))}},u.prototype.findResultAreaEdges=function(v){for(var y=this._graph.getEdgeEnds().iterator();y.hasNext();){var b=y.next(),H=b.getLabel();H.isArea()&&!b.isInteriorAreaEdge()&&u.isResultOfOp(H.getLocation(0,fe.RIGHT),H.getLocation(1,fe.RIGHT),v)&&b.setInResult(!0)}},u.prototype.computeLabelsFromDepths=function(){for(var v=this._edgeList.iterator();v.hasNext();){var y=v.next(),b=y.getLabel(),H=y.getDepth();if(!H.isNull()){H.normalize();for(var ne=0;ne<2;ne++)b.isNull(ne)||!b.isArea()||H.isNull(ne)||(H.getDelta(ne)===0?b.toLine(ne):(Ft.isTrue(!H.isNull(ne,fe.LEFT),"depth of LEFT side has not been initialized"),b.setLocation(ne,fe.LEFT,H.getLocation(ne,fe.LEFT)),Ft.isTrue(!H.isNull(ne,fe.RIGHT),"depth of RIGHT side has not been initialized"),b.setLocation(ne,fe.RIGHT,H.getLocation(ne,fe.RIGHT))))}}},u.prototype.computeLabelling=function(){for(var v=this._graph.getNodes().iterator();v.hasNext();)v.next().getEdges().computeLabelling(this._arg);this.mergeSymLabels(),this.updateNodeLabelling()},u.prototype.labelIncompleteNodes=function(){for(var v=this._graph.getNodes().iterator();v.hasNext();){var y=v.next(),b=y.getLabel();y.isIsolated()&&(b.isNull(0)?this.labelIncompleteNode(y,0):this.labelIncompleteNode(y,1)),y.getEdges().updateLabelling(b)}},u.prototype.isCoveredByA=function(v){return!!this.isCovered(v,this._resultPolyList)},u.prototype.interfaces_=function(){return[]},u.prototype.getClass=function(){return u},u}(Us);Qn.overlayOp=function(o,u,v){return new Qn(o,u).getResultGeometry(v)},Qn.intersection=function(o,u){if(o.isEmpty()||u.isEmpty())return Qn.createEmptyResult(Qn.INTERSECTION,o,u,o.getFactory());if(o.isGeometryCollection()){var v=u;return Eu.map(o,{interfaces_:function(){return[Lu.MapOp]},map:function(y){return y.intersection(v)}})}return o.checkNotGeometryCollection(o),o.checkNotGeometryCollection(u),ii.overlayOp(o,u,Qn.INTERSECTION)},Qn.symDifference=function(o,u){if(o.isEmpty()||u.isEmpty()){if(o.isEmpty()&&u.isEmpty())return Qn.createEmptyResult(Qn.SYMDIFFERENCE,o,u,o.getFactory());if(o.isEmpty())return u.copy();if(u.isEmpty())return o.copy()}return o.checkNotGeometryCollection(o),o.checkNotGeometryCollection(u),ii.overlayOp(o,u,Qn.SYMDIFFERENCE)},Qn.resultDimension=function(o,u,v){var y=u.getDimension(),b=v.getDimension(),H=-1;switch(o){case Qn.INTERSECTION:H=Math.min(y,b);break;case Qn.UNION:H=Math.max(y,b);break;case Qn.DIFFERENCE:H=y;break;case Qn.SYMDIFFERENCE:H=Math.max(y,b)}return H},Qn.createEmptyResult=function(o,u,v,y){var b=null;switch(Qn.resultDimension(o,u,v)){case-1:b=y.createGeometryCollection(new Array(0).fill(null));break;case 0:b=y.createPoint();break;case 1:b=y.createLineString();break;case 2:b=y.createPolygon()}return b},Qn.difference=function(o,u){return o.isEmpty()?Qn.createEmptyResult(Qn.DIFFERENCE,o,u,o.getFactory()):u.isEmpty()?o.copy():(o.checkNotGeometryCollection(o),o.checkNotGeometryCollection(u),ii.overlayOp(o,u,Qn.DIFFERENCE))},Qn.isResultOfOp=function(){if(arguments.length===2){var o=arguments[0],u=arguments[1],v=o.getLocation(0),y=o.getLocation(1);return Qn.isResultOfOp(v,y,u)}if(arguments.length===3){var b=arguments[0],H=arguments[1],ne=arguments[2];switch(b===ye.BOUNDARY&&(b=ye.INTERIOR),H===ye.BOUNDARY&&(H=ye.INTERIOR),ne){case Qn.INTERSECTION:return b===ye.INTERIOR&&H===ye.INTERIOR;case Qn.UNION:return b===ye.INTERIOR||H===ye.INTERIOR;case Qn.DIFFERENCE:return b===ye.INTERIOR&&H!==ye.INTERIOR;case Qn.SYMDIFFERENCE:return b===ye.INTERIOR&&H!==ye.INTERIOR||b!==ye.INTERIOR&&H===ye.INTERIOR}return!1}},Qn.INTERSECTION=1,Qn.UNION=2,Qn.DIFFERENCE=3,Qn.SYMDIFFERENCE=4;var cs=function(){this._g=null,this._boundaryDistanceTolerance=null,this._linework=null,this._ptLocator=new Wu,this._seg=new On;var o=arguments[0],u=arguments[1];this._g=o,this._boundaryDistanceTolerance=u,this._linework=this.extractLinework(o)};cs.prototype.isWithinToleranceOfBoundary=function(o){for(var u=0;u<this._linework.getNumGeometries();u++)for(var v=this._linework.getGeometryN(u).getCoordinateSequence(),y=0;y<v.size()-1;y++)if(v.getCoordinate(y,this._seg.p0),v.getCoordinate(y+1,this._seg.p1),this._seg.distance(o)<=this._boundaryDistanceTolerance)return!0;return!1},cs.prototype.getLocation=function(o){return this.isWithinToleranceOfBoundary(o)?ye.BOUNDARY:this._ptLocator.locate(o,this._g)},cs.prototype.extractLinework=function(o){var u=new Ol;o.apply(u);var v=u.getLinework(),y=Ri.toLineStringArray(v);return o.getFactory().createMultiLineString(y)},cs.prototype.interfaces_=function(){return[]},cs.prototype.getClass=function(){return cs};var Ol=function(){this._linework=null,this._linework=new Wr};Ol.prototype.getLinework=function(){return this._linework},Ol.prototype.filter=function(o){if(o instanceof ka){var u=o;this._linework.add(u.getExteriorRing());for(var v=0;v<u.getNumInteriorRing();v++)this._linework.add(u.getInteriorRingN(v))}},Ol.prototype.interfaces_=function(){return[mo]},Ol.prototype.getClass=function(){return Ol};var fl=function(){this._g=null,this._doLeft=!0,this._doRight=!0;var o=arguments[0];this._g=o};fl.prototype.extractPoints=function(o,u,v){for(var y=o.getCoordinates(),b=0;b<y.length-1;b++)this.computeOffsetPoints(y[b],y[b+1],u,v)},fl.prototype.setSidesToGenerate=function(o,u){this._doLeft=o,this._doRight=u},fl.prototype.getPoints=function(o){for(var u=new Wr,v=wo.getLines(this._g).iterator();v.hasNext();){var y=v.next();this.extractPoints(y,o,u)}return u},fl.prototype.computeOffsetPoints=function(o,u,v,y){var b=u.x-o.x,H=u.y-o.y,ne=Math.sqrt(b*b+H*H),Le=v*b/ne,tt=v*H/ne,Nt=(u.x+o.x)/2,ar=(u.y+o.y)/2;if(this._doLeft){var st=new Y(Nt-tt,ar+Le);y.add(st)}if(this._doRight){var Gt=new Y(Nt+tt,ar-Le);y.add(Gt)}},fl.prototype.interfaces_=function(){return[]},fl.prototype.getClass=function(){return fl};var Zs=function o(){this._geom=null,this._locFinder=null,this._location=new Array(3).fill(null),this._invalidLocation=null,this._boundaryDistanceTolerance=o.TOLERANCE,this._testCoords=new Wr;var u=arguments[0],v=arguments[1],y=arguments[2];this._boundaryDistanceTolerance=o.computeBoundaryDistanceTolerance(u,v),this._geom=[u,v,y],this._locFinder=[new cs(this._geom[0],this._boundaryDistanceTolerance),new cs(this._geom[1],this._boundaryDistanceTolerance),new cs(this._geom[2],this._boundaryDistanceTolerance)]},Kl={TOLERANCE:{configurable:!0}};Zs.prototype.reportResult=function(o,u,v){Qr.out.println("Overlay result invalid - A:"+ye.toLocationSymbol(u[0])+" B:"+ye.toLocationSymbol(u[1])+" expected:"+(v?"i":"e")+" actual:"+ye.toLocationSymbol(u[2]))},Zs.prototype.isValid=function(o){this.addTestPts(this._geom[0]),this.addTestPts(this._geom[1]);var u=this.checkValid(o);return u},Zs.prototype.checkValid=function(){if(arguments.length===1){for(var o=arguments[0],u=0;u<this._testCoords.size();u++){var v=this._testCoords.get(u);if(!this.checkValid(o,v))return this._invalidLocation=v,!1}return!0}if(arguments.length===2){var y=arguments[0],b=arguments[1];return this._location[0]=this._locFinder[0].getLocation(b),this._location[1]=this._locFinder[1].getLocation(b),this._location[2]=this._locFinder[2].getLocation(b),!!Zs.hasLocation(this._location,ye.BOUNDARY)||this.isValidResult(y,this._location)}},Zs.prototype.addTestPts=function(o){var u=new fl(o);this._testCoords.addAll(u.getPoints(5*this._boundaryDistanceTolerance))},Zs.prototype.isValidResult=function(o,u){var v=Qn.isResultOfOp(u[0],u[1],o),y=!(v^u[2]===ye.INTERIOR);return y||this.reportResult(o,u,v),y},Zs.prototype.getInvalidLocation=function(){return this._invalidLocation},Zs.prototype.interfaces_=function(){return[]},Zs.prototype.getClass=function(){return Zs},Zs.hasLocation=function(o,u){for(var v=0;v<3;v++)if(o[v]===u)return!0;return!1},Zs.computeBoundaryDistanceTolerance=function(o,u){return Math.min(Bi.computeSizeBasedSnapTolerance(o),Bi.computeSizeBasedSnapTolerance(u))},Zs.isValid=function(o,u,v,y){return new Zs(o,u,y).isValid(v)},Kl.TOLERANCE.get=function(){return 1e-6},Object.defineProperties(Zs,Kl);var zs=function o(u){this._geomFactory=null,this._skipEmpty=!1,this._inputGeoms=null,this._geomFactory=o.extractFactory(u),this._inputGeoms=u};zs.prototype.extractElements=function(o,u){if(o===null)return null;for(var v=0;v<o.getNumGeometries();v++){var y=o.getGeometryN(v);this._skipEmpty&&y.isEmpty()||u.add(y)}},zs.prototype.combine=function(){for(var o=new Wr,u=this._inputGeoms.iterator();u.hasNext();){var v=u.next();this.extractElements(v,o)}return o.size()===0?this._geomFactory!==null?this._geomFactory.createGeometryCollection(null):null:this._geomFactory.buildGeometry(o)},zs.prototype.interfaces_=function(){return[]},zs.prototype.getClass=function(){return zs},zs.combine=function(){if(arguments.length===1){var o=arguments[0];return new zs(o).combine()}if(arguments.length===2){var u=arguments[0],v=arguments[1];return new zs(zs.createList(u,v)).combine()}if(arguments.length===3){var y=arguments[0],b=arguments[1],H=arguments[2];return new zs(zs.createList(y,b,H)).combine()}},zs.extractFactory=function(o){return o.isEmpty()?null:o.iterator().next().getFactory()},zs.createList=function(){if(arguments.length===2){var o=arguments[0],u=arguments[1],v=new Wr;return v.add(o),v.add(u),v}if(arguments.length===3){var y=arguments[0],b=arguments[1],H=arguments[2],ne=new Wr;return ne.add(y),ne.add(b),ne.add(H),ne}};var $a=function(){this._inputPolys=null,this._geomFactory=null;var o=arguments[0];this._inputPolys=o,this._inputPolys===null&&(this._inputPolys=new Wr)},Jl={STRTREE_NODE_CAPACITY:{configurable:!0}};$a.prototype.reduceToGeometries=function(o){for(var u=new Wr,v=o.iterator();v.hasNext();){var y=v.next(),b=null;Pe(y,ja)?b=this.unionTree(y):y instanceof Ot&&(b=y),u.add(b)}return u},$a.prototype.extractByEnvelope=function(o,u,v){for(var y=new Wr,b=0;b<u.getNumGeometries();b++){var H=u.getGeometryN(b);H.getEnvelopeInternal().intersects(o)?y.add(H):v.add(H)}return this._geomFactory.buildGeometry(y)},$a.prototype.unionOptimized=function(o,u){var v=o.getEnvelopeInternal(),y=u.getEnvelopeInternal();if(!v.intersects(y))return zs.combine(o,u);if(o.getNumGeometries()<=1&&u.getNumGeometries()<=1)return this.unionActual(o,u);var b=v.intersection(y);return this.unionUsingEnvelopeIntersection(o,u,b)},$a.prototype.union=function(){if(this._inputPolys===null)throw new Error("union() method cannot be called twice");if(this._inputPolys.isEmpty())return null;this._geomFactory=this._inputPolys.iterator().next().getFactory();for(var o=new Pf($a.STRTREE_NODE_CAPACITY),u=this._inputPolys.iterator();u.hasNext();){var v=u.next();o.insert(v.getEnvelopeInternal(),v)}this._inputPolys=null;var y=o.itemsTree();return this.unionTree(y)},$a.prototype.binaryUnion=function(){if(arguments.length===1){var o=arguments[0];return this.binaryUnion(o,0,o.size())}if(arguments.length===3){var u=arguments[0],v=arguments[1],y=arguments[2];if(y-v<=1){var b=$a.getGeometry(u,v);return this.unionSafe(b,null)}if(y-v==2)return this.unionSafe($a.getGeometry(u,v),$a.getGeometry(u,v+1));var H=Math.trunc((y+v)/2),ne=this.binaryUnion(u,v,H),Le=this.binaryUnion(u,H,y);return this.unionSafe(ne,Le)}},$a.prototype.repeatedUnion=function(o){for(var u=null,v=o.iterator();v.hasNext();){var y=v.next();u=u===null?y.copy():u.union(y)}return u},$a.prototype.unionSafe=function(o,u){return o===null&&u===null?null:o===null?u.copy():u===null?o.copy():this.unionOptimized(o,u)},$a.prototype.unionActual=function(o,u){return $a.restrictToPolygons(o.union(u))},$a.prototype.unionTree=function(o){var u=this.reduceToGeometries(o);return this.binaryUnion(u)},$a.prototype.unionUsingEnvelopeIntersection=function(o,u,v){var y=new Wr,b=this.extractByEnvelope(v,o,y),H=this.extractByEnvelope(v,u,y),ne=this.unionActual(b,H);return y.add(ne),zs.combine(y)},$a.prototype.bufferUnion=function(){if(arguments.length===1){var o=arguments[0];return o.get(0).getFactory().buildGeometry(o).buffer(0)}if(arguments.length===2){var u=arguments[0],v=arguments[1];return u.getFactory().createGeometryCollection([u,v]).buffer(0)}},$a.prototype.interfaces_=function(){return[]},$a.prototype.getClass=function(){return $a},$a.restrictToPolygons=function(o){if(Pe(o,gu))return o;var u=Hu.getPolygons(o);return u.size()===1?u.get(0):o.getFactory().createMultiPolygon(Ri.toPolygonArray(u))},$a.getGeometry=function(o,u){return u>=o.size()?null:o.get(u)},$a.union=function(o){return new $a(o).union()},Jl.STRTREE_NODE_CAPACITY.get=function(){return 4},Object.defineProperties($a,Jl);var Df=function(){};Df.prototype.interfaces_=function(){return[]},Df.prototype.getClass=function(){return Df},Df.union=function(o,u){if(o.isEmpty()||u.isEmpty()){if(o.isEmpty()&&u.isEmpty())return Qn.createEmptyResult(Qn.UNION,o,u,o.getFactory());if(o.isEmpty())return u.copy();if(u.isEmpty())return o.copy()}return o.checkNotGeometryCollection(o),o.checkNotGeometryCollection(u),ii.overlayOp(o,u,Qn.UNION)},C.GeoJSONReader=Ye,C.GeoJSONWriter=qt,C.OverlayOp=Qn,C.UnionOp=Df,C.BufferOp=_s,Object.defineProperty(C,"__esModule",{value:!0})})},43174:function(ae,j,C){var I=C(67501);function D(G){if(Array.isArray(G))return I(G)}ae.exports=D,ae.exports.__esModule=!0,ae.exports.default=ae.exports},43474:function(ae){function j(C){if(typeof Symbol!="undefined"&&C[Symbol.iterator]!=null||C["@@iterator"]!=null)return Array.from(C)}ae.exports=j,ae.exports.__esModule=!0,ae.exports.default=ae.exports},42272:function(ae){function j(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}ae.exports=j,ae.exports.__esModule=!0,ae.exports.default=ae.exports},93923:function(ae,j,C){var I=C(43174),D=C(43474),G=C(35962),U=C(42272);function B(Z){return I(Z)||D(Z)||G(Z)||U()}ae.exports=B,ae.exports.__esModule=!0,ae.exports.default=ae.exports},96026:function(ae,j,C){var I=C(10574)();ae.exports=I;try{regeneratorRuntime=I}catch(D){typeof globalThis=="object"?globalThis.regeneratorRuntime=I:Function("r","regeneratorRuntime = r")(I)}},39511:function(ae,j,C){"use strict";C.d(j,{Z:function(){return D}});var I=C(8822);function D(G,U){U===void 0&&(U={});var B=Number(G[0]),Z=Number(G[1]),X=Number(G[2]),q=Number(G[3]);if(G.length===6)throw new Error("@turf/bbox-polygon does not support BBox with 6 positions");var ie=[B,Z],he=[B,q],Ce=[X,q],be=[X,Z];return(0,I.yu)([[ie,be,Ce,he,ie]],U.properties,{bbox:G,id:U.id})}},86461:function(ae,j,C){"use strict";var I=C(94169);function D(G){var U=[1/0,1/0,-1/0,-1/0];return(0,I.pZ)(G,function(B){U[0]>B[0]&&(U[0]=B[0]),U[1]>B[1]&&(U[1]=B[1]),U[2]<B[0]&&(U[2]=B[0]),U[3]<B[1]&&(U[3]=B[1])}),U}D.default=D,j.Z=D},8822:function(ae,j,C){"use strict";C.d(j,{Tu:function(){return Ce},ot:function(){return De},tw:function(){return Ge},uf:function(){return Ze},xm:function(){return X},yu:function(){return ie},zL:function(){return B}});var I=63710088e-1,D={centimeters:I*100,centimetres:I*100,degrees:I/111325,feet:I*3.28084,inches:I*39.37,kilometers:I/1e3,kilometres:I/1e3,meters:I,metres:I,miles:I/1609.344,millimeters:I*1e3,millimetres:I*1e3,nauticalmiles:I/1852,radians:1,yards:I*1.0936},G={centimeters:100,centimetres:100,degrees:1/111325,feet:3.28084,inches:39.37,kilometers:1/1e3,kilometres:1/1e3,meters:1,metres:1,miles:1/1609.344,millimeters:1e3,millimetres:1e3,nauticalmiles:1/1852,radians:1/I,yards:1.0936133},U={acres:247105e-9,centimeters:1e4,centimetres:1e4,feet:10.763910417,hectares:1e-4,inches:1550.003100006,kilometers:1e-6,kilometres:1e-6,meters:1,metres:1,miles:386e-9,millimeters:1e6,millimetres:1e6,yards:1.195990046};function B(Ae,_e,ue){ue===void 0&&(ue={});var ke={type:"Feature"};return(ue.id===0||ue.id)&&(ke.id=ue.id),ue.bbox&&(ke.bbox=ue.bbox),ke.properties=_e||{},ke.geometry=Ae,ke}function Z(Ae,_e,ue){switch(ue===void 0&&(ue={}),Ae){case"Point":return X(_e).geometry;case"LineString":return Ce(_e).geometry;case"Polygon":return ie(_e).geometry;case"MultiPoint":return De(_e).geometry;case"MultiLineString":return qe(_e).geometry;case"MultiPolygon":return Ge(_e).geometry;default:throw new Error(Ae+" is invalid")}}function X(Ae,_e,ue){if(ue===void 0&&(ue={}),!Ae)throw new Error("coordinates is required");if(!Array.isArray(Ae))throw new Error("coordinates must be an Array");if(Ae.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!xe(Ae[0])||!xe(Ae[1]))throw new Error("coordinates must contain numbers");var ke={type:"Point",coordinates:Ae};return B(ke,_e,ue)}function q(Ae,_e,ue){return ue===void 0&&(ue={}),Ze(Ae.map(function(ke){return X(ke,_e)}),ue)}function ie(Ae,_e,ue){ue===void 0&&(ue={});for(var ke=0,ze=Ae;ke<ze.length;ke++){var le=ze[ke];if(le.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var Ut=0;Ut<le[le.length-1].length;Ut++)if(le[le.length-1][Ut]!==le[0][Ut])throw new Error("First and last Position are not equivalent.")}var kt={type:"Polygon",coordinates:Ae};return B(kt,_e,ue)}function he(Ae,_e,ue){return ue===void 0&&(ue={}),Ze(Ae.map(function(ke){return ie(ke,_e)}),ue)}function Ce(Ae,_e,ue){if(ue===void 0&&(ue={}),Ae.length<2)throw new Error("coordinates must be an array of two or more positions");var ke={type:"LineString",coordinates:Ae};return B(ke,_e,ue)}function be(Ae,_e,ue){return ue===void 0&&(ue={}),Ze(Ae.map(function(ke){return Ce(ke,_e)}),ue)}function Ze(Ae,_e){_e===void 0&&(_e={});var ue={type:"FeatureCollection"};return _e.id&&(ue.id=_e.id),_e.bbox&&(ue.bbox=_e.bbox),ue.features=Ae,ue}function qe(Ae,_e,ue){ue===void 0&&(ue={});var ke={type:"MultiLineString",coordinates:Ae};return B(ke,_e,ue)}function De(Ae,_e,ue){ue===void 0&&(ue={});var ke={type:"MultiPoint",coordinates:Ae};return B(ke,_e,ue)}function Ge(Ae,_e,ue){ue===void 0&&(ue={});var ke={type:"MultiPolygon",coordinates:Ae};return B(ke,_e,ue)}function Re(Ae,_e,ue){ue===void 0&&(ue={});var ke={type:"GeometryCollection",geometries:Ae};return B(ke,_e,ue)}function Me(Ae,_e){if(_e===void 0&&(_e=0),_e&&!(_e>=0))throw new Error("precision must be a positive number");var ue=Math.pow(10,_e||0);return Math.round(Ae*ue)/ue}function ce(Ae,_e){_e===void 0&&(_e="kilometers");var ue=D[_e];if(!ue)throw new Error(_e+" units is invalid");return Ae*ue}function Be(Ae,_e){_e===void 0&&(_e="kilometers");var ue=D[_e];if(!ue)throw new Error(_e+" units is invalid");return Ae/ue}function Ee(Ae,_e){return oe(Be(Ae,_e))}function Se(Ae){var _e=Ae%360;return _e<0&&(_e+=360),_e}function oe(Ae){var _e=Ae%(2*Math.PI);return _e*180/Math.PI}function Y(Ae){var _e=Ae%360;return _e*Math.PI/180}function Ne(Ae,_e,ue){if(_e===void 0&&(_e="kilometers"),ue===void 0&&(ue="kilometers"),!(Ae>=0))throw new Error("length must be a positive number");return ce(Be(Ae,_e),ue)}function ge(Ae,_e,ue){if(_e===void 0&&(_e="meters"),ue===void 0&&(ue="kilometers"),!(Ae>=0))throw new Error("area must be a positive number");var ke=U[_e];if(!ke)throw new Error("invalid original units");var ze=U[ue];if(!ze)throw new Error("invalid final units");return Ae/ke*ze}function xe(Ae){return!isNaN(Ae)&&Ae!==null&&!Array.isArray(Ae)}function ye(Ae){return!!Ae&&Ae.constructor===Object}function Q(Ae){if(!Ae)throw new Error("bbox is required");if(!Array.isArray(Ae))throw new Error("bbox must be an Array");if(Ae.length!==4&&Ae.length!==6)throw new Error("bbox must be an Array of 4 or 6 numbers");Ae.forEach(function(_e){if(!xe(_e))throw new Error("bbox must only contain numbers")})}function Pe(Ae){if(!Ae)throw new Error("id is required");if(["string","number"].indexOf(typeof Ae)===-1)throw new Error("id must be a number or a string")}},8014:function(ae,j,C){"use strict";C.d(j,{c9:function(){return D},nK:function(){return Z},r7:function(){return G},wA:function(){return q}});var I=C(8822);function D(he){if(!he)throw new Error("coord is required");if(!Array.isArray(he)){if(he.type==="Feature"&&he.geometry!==null&&he.geometry.type==="Point")return he.geometry.coordinates;if(he.type==="Point")return he.coordinates}if(Array.isArray(he)&&he.length>=2&&!Array.isArray(he[0])&&!Array.isArray(he[1]))return he;throw new Error("coord must be GeoJSON Point or an Array of numbers")}function G(he){if(Array.isArray(he))return he;if(he.type==="Feature"){if(he.geometry!==null)return he.geometry.coordinates}else if(he.coordinates)return he.coordinates;throw new Error("coords must be GeoJSON Feature, Geometry Object or an Array")}function U(he){if(he.length>1&&isNumber(he[0])&&isNumber(he[1]))return!0;if(Array.isArray(he[0])&&he[0].length)return U(he[0]);throw new Error("coordinates must only contain numbers")}function B(he,Ce,be){if(!Ce||!be)throw new Error("type and name required");if(!he||he.type!==Ce)throw new Error("Invalid input to "+be+": must be a "+Ce+", given "+he.type)}function Z(he,Ce,be){if(!he)throw new Error("No feature passed");if(!be)throw new Error(".featureOf() requires a name");if(!he||he.type!=="Feature"||!he.geometry)throw new Error("Invalid input to "+be+", Feature with geometry required");if(!he.geometry||he.geometry.type!==Ce)throw new Error("Invalid input to "+be+": must be a "+Ce+", given "+he.geometry.type)}function X(he,Ce,be){if(!he)throw new Error("No featureCollection passed");if(!be)throw new Error(".collectionOf() requires a name");if(!he||he.type!=="FeatureCollection")throw new Error("Invalid input to "+be+", FeatureCollection required");for(var Ze=0,qe=he.features;Ze<qe.length;Ze++){var De=qe[Ze];if(!De||De.type!=="Feature"||!De.geometry)throw new Error("Invalid input to "+be+", Feature with geometry required");if(!De.geometry||De.geometry.type!==Ce)throw new Error("Invalid input to "+be+": must be a "+Ce+", given "+De.geometry.type)}}function q(he){return he.type==="Feature"?he.geometry:he}function ie(he,Ce){return he.type==="FeatureCollection"?"FeatureCollection":he.type==="GeometryCollection"?"GeometryCollection":he.type==="Feature"&&he.geometry!==null?he.geometry.type:he.type}},94169:function(ae,j,C){"use strict";C.d(j,{Lo:function(){return G},nG:function(){return Ce},pZ:function(){return D}});var I=C(8822);function D(ce,Be,Ee){if(ce!==null)for(var Se,oe,Y,Ne,ge,xe,ye,Q=0,Pe=0,Ae,_e=ce.type,ue=_e==="FeatureCollection",ke=_e==="Feature",ze=ue?ce.features.length:1,le=0;le<ze;le++){ye=ue?ce.features[le].geometry:ke?ce.geometry:ce,Ae=ye?ye.type==="GeometryCollection":!1,ge=Ae?ye.geometries.length:1;for(var Ut=0;Ut<ge;Ut++){var kt=0,pr=0;if(Ne=Ae?ye.geometries[Ut]:ye,Ne!==null){xe=Ne.coordinates;var Wt=Ne.type;switch(Q=Ee&&(Wt==="Polygon"||Wt==="MultiPolygon")?1:0,Wt){case null:break;case"Point":if(Be(xe,Pe,le,kt,pr)===!1)return!1;Pe++,kt++;break;case"LineString":case"MultiPoint":for(Se=0;Se<xe.length;Se++){if(Be(xe[Se],Pe,le,kt,pr)===!1)return!1;Pe++,Wt==="MultiPoint"&&kt++}Wt==="LineString"&&kt++;break;case"Polygon":case"MultiLineString":for(Se=0;Se<xe.length;Se++){for(oe=0;oe<xe[Se].length-Q;oe++){if(Be(xe[Se][oe],Pe,le,kt,pr)===!1)return!1;Pe++}Wt==="MultiLineString"&&kt++,Wt==="Polygon"&&pr++}Wt==="Polygon"&&kt++;break;case"MultiPolygon":for(Se=0;Se<xe.length;Se++){for(pr=0,oe=0;oe<xe[Se].length;oe++){for(Y=0;Y<xe[Se][oe].length-Q;Y++){if(Be(xe[Se][oe][Y],Pe,le,kt,pr)===!1)return!1;Pe++}pr++}kt++}break;case"GeometryCollection":for(Se=0;Se<Ne.geometries.length;Se++)if(D(Ne.geometries[Se],Be,Ee)===!1)return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function G(ce,Be,Ee,Se){var oe=Ee;return D(ce,function(Y,Ne,ge,xe,ye){Ne===0&&Ee===void 0?oe=Y:oe=Be(oe,Y,Ne,ge,xe,ye)},Se),oe}function U(ce,Be){var Ee;switch(ce.type){case"FeatureCollection":for(Ee=0;Ee<ce.features.length&&Be(ce.features[Ee].properties,Ee)!==!1;Ee++);break;case"Feature":Be(ce.properties,0);break}}function B(ce,Be,Ee){var Se=Ee;return U(ce,function(oe,Y){Y===0&&Ee===void 0?Se=oe:Se=Be(Se,oe,Y)}),Se}function Z(ce,Be){if(ce.type==="Feature")Be(ce,0);else if(ce.type==="FeatureCollection")for(var Ee=0;Ee<ce.features.length&&Be(ce.features[Ee],Ee)!==!1;Ee++);}function X(ce,Be,Ee){var Se=Ee;return Z(ce,function(oe,Y){Y===0&&Ee===void 0?Se=oe:Se=Be(Se,oe,Y)}),Se}function q(ce){var Be=[];return D(ce,function(Ee){Be.push(Ee)}),Be}function ie(ce,Be){var Ee,Se,oe,Y,Ne,ge,xe,ye,Q,Pe,Ae=0,_e=ce.type==="FeatureCollection",ue=ce.type==="Feature",ke=_e?ce.features.length:1;for(Ee=0;Ee<ke;Ee++){for(ge=_e?ce.features[Ee].geometry:ue?ce.geometry:ce,ye=_e?ce.features[Ee].properties:ue?ce.properties:{},Q=_e?ce.features[Ee].bbox:ue?ce.bbox:void 0,Pe=_e?ce.features[Ee].id:ue?ce.id:void 0,xe=ge?ge.type==="GeometryCollection":!1,Ne=xe?ge.geometries.length:1,oe=0;oe<Ne;oe++){if(Y=xe?ge.geometries[oe]:ge,Y===null){if(Be(null,Ae,ye,Q,Pe)===!1)return!1;continue}switch(Y.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":{if(Be(Y,Ae,ye,Q,Pe)===!1)return!1;break}case"GeometryCollection":{for(Se=0;Se<Y.geometries.length;Se++)if(Be(Y.geometries[Se],Ae,ye,Q,Pe)===!1)return!1;break}default:throw new Error("Unknown Geometry Type")}}Ae++}}function he(ce,Be,Ee){var Se=Ee;return ie(ce,function(oe,Y,Ne,ge,xe){Y===0&&Ee===void 0?Se=oe:Se=Be(Se,oe,Y,Ne,ge,xe)}),Se}function Ce(ce,Be){ie(ce,function(Ee,Se,oe,Y,Ne){var ge=Ee===null?null:Ee.type;switch(ge){case null:case"Point":case"LineString":case"Polygon":return Be((0,I.zL)(Ee,oe,{bbox:Y,id:Ne}),Se,0)===!1?!1:void 0}var xe;switch(ge){case"MultiPoint":xe="Point";break;case"MultiLineString":xe="LineString";break;case"MultiPolygon":xe="Polygon";break}for(var ye=0;ye<Ee.coordinates.length;ye++){var Q=Ee.coordinates[ye],Pe={type:xe,coordinates:Q};if(Be((0,I.zL)(Pe,oe),Se,ye)===!1)return!1}})}function be(ce,Be,Ee){var Se=Ee;return Ce(ce,function(oe,Y,Ne){Y===0&&Ne===0&&Ee===void 0?Se=oe:Se=Be(Se,oe,Y,Ne)}),Se}function Ze(ce,Be){Ce(ce,function(Ee,Se,oe){var Y=0;if(Ee.geometry){var Ne=Ee.geometry.type;if(!(Ne==="Point"||Ne==="MultiPoint")){var ge,xe=0,ye=0,Q=0;if(D(Ee,function(Pe,Ae,_e,ue,ke){if(ge===void 0||Se>xe||ue>ye||ke>Q){ge=Pe,xe=Se,ye=ue,Q=ke,Y=0;return}var ze=lineString([ge,Pe],Ee.properties);if(Be(ze,Se,oe,ke,Y)===!1)return!1;Y++,ge=Pe})===!1)return!1}}})}function qe(ce,Be,Ee){var Se=Ee,oe=!1;return Ze(ce,function(Y,Ne,ge,xe,ye){oe===!1&&Ee===void 0?Se=Y:Se=Be(Se,Y,Ne,ge,xe,ye),oe=!0}),Se}function De(ce,Be){if(!ce)throw new Error("geojson is required");Ce(ce,function(Ee,Se,oe){if(Ee.geometry!==null){var Y=Ee.geometry.type,Ne=Ee.geometry.coordinates;switch(Y){case"LineString":if(Be(Ee,Se,oe,0,0)===!1)return!1;break;case"Polygon":for(var ge=0;ge<Ne.length;ge++)if(Be(lineString(Ne[ge],Ee.properties),Se,oe,ge)===!1)return!1;break}}})}function Ge(ce,Be,Ee){var Se=Ee;return De(ce,function(oe,Y,Ne,ge){Y===0&&Ee===void 0?Se=oe:Se=Be(Se,oe,Y,Ne,ge)}),Se}function Re(ce,Be){if(Be=Be||{},!isObject(Be))throw new Error("options is invalid");var Ee=Be.featureIndex||0,Se=Be.multiFeatureIndex||0,oe=Be.geometryIndex||0,Y=Be.segmentIndex||0,Ne=Be.properties,ge;switch(ce.type){case"FeatureCollection":Ee<0&&(Ee=ce.features.length+Ee),Ne=Ne||ce.features[Ee].properties,ge=ce.features[Ee].geometry;break;case"Feature":Ne=Ne||ce.properties,ge=ce.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":ge=ce;break;default:throw new Error("geojson is invalid")}if(ge===null)return null;var xe=ge.coordinates;switch(ge.type){case"Point":case"MultiPoint":return null;case"LineString":return Y<0&&(Y=xe.length+Y-1),lineString([xe[Y],xe[Y+1]],Ne,Be);case"Polygon":return oe<0&&(oe=xe.length+oe),Y<0&&(Y=xe[oe].length+Y-1),lineString([xe[oe][Y],xe[oe][Y+1]],Ne,Be);case"MultiLineString":return Se<0&&(Se=xe.length+Se),Y<0&&(Y=xe[Se].length+Y-1),lineString([xe[Se][Y],xe[Se][Y+1]],Ne,Be);case"MultiPolygon":return Se<0&&(Se=xe.length+Se),oe<0&&(oe=xe[Se].length+oe),Y<0&&(Y=xe[Se][oe].length-Y-1),lineString([xe[Se][oe][Y],xe[Se][oe][Y+1]],Ne,Be)}throw new Error("geojson is invalid")}function Me(ce,Be){if(Be=Be||{},!isObject(Be))throw new Error("options is invalid");var Ee=Be.featureIndex||0,Se=Be.multiFeatureIndex||0,oe=Be.geometryIndex||0,Y=Be.coordIndex||0,Ne=Be.properties,ge;switch(ce.type){case"FeatureCollection":Ee<0&&(Ee=ce.features.length+Ee),Ne=Ne||ce.features[Ee].properties,ge=ce.features[Ee].geometry;break;case"Feature":Ne=Ne||ce.properties,ge=ce.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":ge=ce;break;default:throw new Error("geojson is invalid")}if(ge===null)return null;var xe=ge.coordinates;switch(ge.type){case"Point":return point(xe,Ne,Be);case"MultiPoint":return Se<0&&(Se=xe.length+Se),point(xe[Se],Ne,Be);case"LineString":return Y<0&&(Y=xe.length+Y),point(xe[Y],Ne,Be);case"Polygon":return oe<0&&(oe=xe.length+oe),Y<0&&(Y=xe[oe].length+Y),point(xe[oe][Y],Ne,Be);case"MultiLineString":return Se<0&&(Se=xe.length+Se),Y<0&&(Y=xe[Se].length+Y),point(xe[Se][Y],Ne,Be);case"MultiPolygon":return Se<0&&(Se=xe.length+Se),oe<0&&(oe=xe[Se].length+oe),Y<0&&(Y=xe[Se][oe].length-Y),point(xe[Se][oe][Y],Ne,Be)}throw new Error("geojson is invalid")}},80262:function(ae,j,C){"use strict";C.d(j,{uf4:function(){return U.uf},xmu:function(){return U.xm},yue:function(){return U.yu},dtN:function(){return Xi}});var I=C(86461),D=C(94169),G=C(8014),U=C(8822),B=C(84126);var Z={successCallback:null,verbose:!1},X={};function q(c,A,_){_=_||{};for(var x=Object.keys(Z),w=0;w<x.length;w++){var P=x[w],N=_[P];N=typeof N!="undefined"&&N!==null?N:Z[P],X[P]=N}X.verbose&&console.log("MarchingSquaresJS-isoContours: computing isocontour for "+A);var V=De(he(c,A));return typeof X.successCallback=="function"&&X.successCallback(V),V}function ie(c,A,_){return(c-A)/(_-A)}function he(c,A){for(var _=c.length-1,x=c[0].length-1,w={rows:_,cols:x,cells:[]},P=0;P<_;++P){w.cells[P]=[];for(var N=0;N<x;++N){var V=0,W=c[P+1][N],k=c[P+1][N+1],K=c[P][N+1],J=c[P][N];if(!(isNaN(W)||isNaN(k)||isNaN(K)||isNaN(J))){V|=W>=A?8:0,V|=k>=A?4:0,V|=K>=A?2:0,V|=J>=A?1:0;var se=!1;if(V===5||V===10){var de=(W+k+K+J)/4;V===5&&de<A?(V=10,se=!0):V===10&&de<A&&(V=5,se=!0)}if(V!==0&&V!==15){var gt,at,Zt,mt;gt=at=Zt=mt=.5,V===1?(Zt=1-ie(A,W,J),at=1-ie(A,K,J)):V===2?(at=ie(A,J,K),mt=1-ie(A,k,K)):V===3?(Zt=1-ie(A,W,J),mt=1-ie(A,k,K)):V===4?(gt=ie(A,W,k),mt=ie(A,K,k)):V===5?(gt=ie(A,W,k),mt=ie(A,K,k),at=1-ie(A,K,J),Zt=1-ie(A,W,J)):V===6?(at=ie(A,J,K),gt=ie(A,W,k)):V===7?(Zt=1-ie(A,W,J),gt=ie(A,W,k)):V===8?(Zt=ie(A,J,W),gt=1-ie(A,k,W)):V===9?(at=1-ie(A,K,J),gt=1-ie(A,k,W)):V===10?(gt=1-ie(A,k,W),mt=1-ie(A,k,K),at=ie(A,J,K),Zt=ie(A,J,W)):V===11?(gt=1-ie(A,k,W),mt=1-ie(A,k,K)):V===12?(Zt=ie(A,J,W),mt=ie(A,K,k)):V===13?(at=1-ie(A,K,J),mt=ie(A,K,k)):V===14?(Zt=ie(A,J,W),at=ie(A,J,K)):console.log("MarchingSquaresJS-isoContours: Illegal cval detected: "+V),w.cells[P][N]={cval:V,flipped:se,top:gt,right:mt,bottom:at,left:Zt}}}}}return w}function Ce(c){return c.cval===5||c.cval===10}function be(c){return c.cval===0||c.cval===15}function Ze(c){!be(c)&&c.cval!==5&&c.cval!==10&&(c.cval=15)}function qe(c,A){if(A==="top")return[c.top,1];if(A==="bottom")return[c.bottom,0];if(A==="right")return[1,c.right];if(A==="left")return[0,c.left]}function De(c){var A=[],_=0,x=1e-7;return c.cells.forEach(function(w,P){w.forEach(function(N,V){if(typeof N!="undefined"&&!Ce(N)&&!be(N)){var W=Ge(c.cells,P,V),k=!1;if(W.info==="mergeable"){for(var K=W.path[W.path.length-1][0],J=W.path[W.path.length-1][1],se=_-1;se>=0;se--)if(Math.abs(A[se][0][0]-K)<=x&&Math.abs(A[se][0][1]-J)<=x){for(var de=W.path.length-2;de>=0;--de)A[se].unshift(W.path[de]);k=!0;break}}k||(A[_++]=W.path)}})}),A}function Ge(c,A,_){var x=c.length,w=[],P=[0,0,1,1,0,0,0,0,-1,0,1,1,-1,0,-1,0],N=[0,-1,0,0,1,1,1,1,0,-1,0,0,0,-1,0,0],V,W,k=["none","left","bottom","left","right","none","bottom","left","top","top","none","top","right","right","bottom","none"],K=["none","bottom","right","right","top","top","top","top","left","bottom","right","right","left","bottom","left","none"],de,J=c[A][_],se=J.cval,de=k[se],gt=qe(J,de);w.push([_+gt[0],A+gt[1]]),de=K[se],gt=qe(J,de),w.push([_+gt[0],A+gt[1]]),Ze(J);for(var at=_+P[se],Zt=A+N[se],mt=se;at>=0&&Zt>=0&&Zt<x&&(at!=_||Zt!=A)&&(J=c[Zt][at],typeof J!="undefined");){if(se=J.cval,se===0||se===15)return{path:w,info:"mergeable"};de=K[se],V=P[se],W=N[se],(se===5||se===10)&&(se===5?J.flipped?N[mt]===-1?(de="left",V=-1,W=0):(de="right",V=1,W=0):P[mt]===-1&&(de="bottom",V=0,W=-1):se===10&&(J.flipped?P[mt]===-1?(de="top",V=0,W=1):(de="bottom",V=0,W=-1):N[mt]===1&&(de="left",V=-1,W=0))),gt=qe(J,de),w.push([at+gt[0],Zt+gt[1]]),Ze(J),at+=V,Zt+=W,mt=se}return{path:w,info:"closed"}}function Re(c,A){if(A=A||{},!isObject(A))throw new Error("options is invalid");var _=A.zProperty||"elevation",x=A.flip,w=A.flags;collectionOf(c,"Point","input must contain Points");for(var P=Me(c,x),N=[],V=0;V<P.length;V++){for(var W=P[V],k=[],K=0;K<W.length;K++){var J=W[K];J.properties[_]?k.push(J.properties[_]):k.push(0),w===!0&&(J.properties.matrixPosition=[V,K])}N.push(k)}return N}function Me(c,A){var _={};featureEach(c,function(P){var N=getCoords(P)[1];_[N]||(_[N]=[]),_[N].push(P)});var x=Object.keys(_).map(function(P){var N=_[P],V=N.sort(function(W,k){return getCoords(W)[0]-getCoords(k)[0]});return V}),w=x.sort(function(P,N){return A?getCoords(P[0])[1]-getCoords(N[0])[1]:getCoords(N[0])[1]-getCoords(P[0])[1]});return w}function ce(c,A,_){if(_=_||{},!isObject(_))throw new Error("options is invalid");var x=_.zProperty||"elevation",w=_.commonProperties||{},P=_.breaksProperties||[];if(collectionOf(c,"Point","Input must contain Points"),!A)throw new Error("breaks is required");if(!Array.isArray(A))throw new Error("breaks must be an Array");if(!isObject(w))throw new Error("commonProperties must be an Object");if(!Array.isArray(P))throw new Error("breaksProperties must be an Array");var N=Re(c,{zProperty:x,flip:!0}),V=Be(N,A,x,w,P),W=Ee(V,N,c);return featureCollection(W)}function Be(c,A,_,x,w){for(var P=[],N=1;N<A.length;N++){var V=+A[N],W=objectAssign({},x,w[N]);W[_]=V;var k=multiLineString(q(c,V),W);P.push(k)}return P}function Ee(c,A,_){var x=bbox(_),w=x[2]-x[0],P=x[3]-x[1],N=x[0],V=x[1],W=A[0].length-1,k=A.length-1,K=w/W,J=P/k,se=function(de){de[0]=de[0]*K+N,de[1]=de[1]*J+V};return c.forEach(function(de){coordEach(de,se)}),c}var Se=null,oe=C(24538);function Y(c,A){A===void 0&&(A={}),A.concavity=A.concavity||1/0;var _=[];if(coordEach(c,function(w){_.push([w[0],w[1]])}),!_.length)return null;var x=concaveman(_,A.concavity);return x.length>3?polygon([x]):null}function Ne(c,A,_){if(_===void 0&&(_={}),!c)throw new Error("point is required");if(!A)throw new Error("polygon is required");var x=(0,G.c9)(c),w=(0,G.wA)(A),P=w.type,N=A.bbox,V=w.coordinates;if(N&&xe(x,N)===!1)return!1;P==="Polygon"&&(V=[V]);for(var W=!1,k=0;k<V.length&&!W;k++)if(ge(x,V[k][0],_.ignoreBoundary)){for(var K=!1,J=1;J<V[k].length&&!K;)ge(x,V[k][J],!_.ignoreBoundary)&&(K=!0),J++;K||(W=!0)}return W}function ge(c,A,_){var x=!1;A[0][0]===A[A.length-1][0]&&A[0][1]===A[A.length-1][1]&&(A=A.slice(0,A.length-1));for(var w=0,P=A.length-1;w<A.length;P=w++){var N=A[w][0],V=A[w][1],W=A[P][0],k=A[P][1],K=c[1]*(N-W)+V*(W-c[0])+k*(c[0]-N)===0&&(N-c[0])*(W-c[0])<=0&&(V-c[1])*(k-c[1])<=0;if(K)return!_;var J=V>c[1]!=k>c[1]&&c[0]<(W-N)*(c[1]-V)/(k-V)+N;J&&(x=!x)}return x}function xe(c,A){return A[0]<=c[0]&&A[1]<=c[1]&&A[2]>=c[0]&&A[3]>=c[1]}function ye(c,A){var _=[];return featureEach(c,function(x){var w=!1;if(x.geometry.type==="Point")geomEach(A,function(N){pointInPolygon(x,N)&&(w=!0)}),w&&_.push(x);else if(x.geometry.type==="MultiPoint"){var P=[];geomEach(A,function(N){coordEach(x,function(V){pointInPolygon(V,N)&&(w=!0,P.push(V))})}),w&&_.push(multiPoint(P))}else throw new Error("Input geometry must be a Point or MultiPoint")}),featureCollection(_)}var Q=null;function Pe(c,A,_){_===void 0&&(_={});var x=getCoord(c),w=getCoord(A),P=degreesToRadians(w[1]-x[1]),N=degreesToRadians(w[0]-x[0]),V=degreesToRadians(x[1]),W=degreesToRadians(w[1]),k=Math.pow(Math.sin(P/2),2)+Math.pow(Math.sin(N/2),2)*Math.cos(V)*Math.cos(W);return radiansToLength(2*Math.atan2(Math.sqrt(k),Math.sqrt(1-k)),_.units)}var Ae=null;function _e(c,A){var _=!1;return featureCollection(le(c.features.map(function(x){var w={x:x.geometry.coordinates[0],y:x.geometry.coordinates[1]};return A?w.z=x.properties[A]:x.geometry.coordinates.length===3&&(_=!0,w.z=x.geometry.coordinates[2]),w})).map(function(x){var w=[x.a.x,x.a.y],P=[x.b.x,x.b.y],N=[x.c.x,x.c.y],V={};return _?(w.push(x.a.z),P.push(x.b.z),N.push(x.c.z)):V={a:x.a.z,b:x.b.z,c:x.c.z},polygon([[w,P,N,w]],V)}))}var ue=function(){function c(A,_,x){this.a=A,this.b=_,this.c=x;var w=_.x-A.x,P=_.y-A.y,N=x.x-A.x,V=x.y-A.y,W=w*(A.x+_.x)+P*(A.y+_.y),k=N*(A.x+x.x)+V*(A.y+x.y),K=2*(w*(x.y-_.y)-P*(x.x-_.x)),J,se;this.x=(V*W-P*k)/K,this.y=(w*k-N*W)/K,J=this.x-A.x,se=this.y-A.y,this.r=J*J+se*se}return c}();function ke(c,A){return A.x-c.x}function ze(c){var A=c.length,_,x,w,P,N;e:for(;A;)for(x=c[--A],_=c[--A],w=A;w;)if(N=c[--w],P=c[--w],_===P&&x===N||_===N&&x===P){c.splice(A,2),c.splice(w,2),A-=2;continue e}}function le(c){if(c.length<3)return[];c.sort(ke);for(var A=c.length-1,_=c[A].x,x=c[0].x,w=c[A].y,P=w,N=1e-12,V,W,k,K,J,se;A--;)c[A].y<w&&(w=c[A].y),c[A].y>P&&(P=c[A].y);var de=x-_,gt=P-w,at=de>gt?de:gt,Zt=(x+_)*.5,mt=(P+w)*.5,rt=[new ue({__sentinel:!0,x:Zt-20*at,y:mt-at},{__sentinel:!0,x:Zt,y:mt+20*at},{__sentinel:!0,x:Zt+20*at,y:mt-at})],lt=[],Qt=[],Yt;for(A=c.length;A--;){for(Qt.length=0,Yt=rt.length;Yt--;){if(de=c[A].x-rt[Yt].x,de>0&&de*de>rt[Yt].r){lt.push(rt[Yt]),rt.splice(Yt,1);continue}gt=c[A].y-rt[Yt].y,!(de*de+gt*gt>rt[Yt].r)&&(Qt.push(rt[Yt].a,rt[Yt].b,rt[Yt].b,rt[Yt].c,rt[Yt].c,rt[Yt].a),rt.splice(Yt,1))}for(ze(Qt),Yt=Qt.length;Yt;)W=Qt[--Yt],V=Qt[--Yt],k=c[A],K=W.x-V.x,J=W.y-V.y,se=2*(K*(k.y-W.y)-J*(k.x-W.x)),Math.abs(se)>N&&rt.push(new ue(V,W,k))}for(Array.prototype.push.apply(lt,rt),A=lt.length;A--;)(lt[A].a.__sentinel||lt[A].b.__sentinel||lt[A].c.__sentinel)&&lt.splice(A,1);return lt}function Ut(c,A){if(A===void 0&&(A={}),A=A||{},!isObject(A))throw new Error("options is invalid");var _=A.mutate;if(getType(c)!=="FeatureCollection")throw new Error("geojson must be a FeatureCollection");if(!c.features.length)throw new Error("geojson is empty");(_===!1||_===void 0)&&(c=clone(c));var x=[],w=lineReduce(c,function(P,N){var V=pr(P,N);return V||(x.push(P),N)});return w&&x.push(w),x.length?x.length===1?x[0]:multiLineString(x.map(function(P){return P.coordinates})):null}function kt(c){return c[0].toString()+","+c[1].toString()}function pr(c,A){var _=c.geometry.coordinates,x=A.geometry.coordinates,w=kt(_[0]),P=kt(_[_.length-1]),N=kt(x[0]),V=kt(x[x.length-1]),W;if(w===V)W=x.concat(_.slice(1));else if(N===P)W=_.concat(x.slice(1));else if(w===N)W=_.slice(1).reverse().concat(x);else if(P===V)W=_.concat(x.reverse().slice(1));else return null;return lineString(W)}var Wt=null,Xr=Object.prototype.hasOwnProperty;function fn(c){var A=1/0,_=1/0,x=-1/0,w=-1/0;function P(J){J!=null&&hasOwnProperty.call(N,J.type)&&N[J.type](J)}var N={GeometryCollection:function(J){J.geometries.forEach(P)},Point:function(J){V(J.coordinates)},MultiPoint:function(J){J.coordinates.forEach(V)},LineString:function(J){W(J.arcs)},MultiLineString:function(J){J.arcs.forEach(W)},Polygon:function(J){J.arcs.forEach(W)},MultiPolygon:function(J){J.arcs.forEach(k)}};function V(J){var se=J[0],de=J[1];se<A&&(A=se),se>x&&(x=se),de<_&&(_=de),de>w&&(w=de)}function W(J){J.forEach(V)}function k(J){J.forEach(W)}for(var K in c)P(c[K]);return x>=A&&w>=_?[A,_,x,w]:void 0}var Ir=new ArrayBuffer(16),Qr=new Float64Array(Ir),tn=new Uint32Array(Ir);function Mr(c){Qr[0]=c[0],Qr[1]=c[1];var A=tn[0]^tn[1];return A=A<<5^A>>7^tn[2]^tn[3],A&2147483647}function $n(c){var A=c.coordinates,_=c.lines,x=c.rings,w=or(),P=new Int32Array(A.length),N=new Int32Array(A.length),V=new Int32Array(A.length),W=new Int8Array(A.length),k=0,K,J,se,de,gt;for(K=0,J=A.length;K<J;++K)P[K]=N[K]=V[K]=-1;for(K=0,J=_.length;K<J;++K){var at=_[K],Zt=at[0],mt=at[1];for(de=w[Zt],gt=w[++Zt],++k,W[de]=1;++Zt<=mt;)Yt(K,se=de,de=gt,gt=w[Zt]);++k,W[gt]=1}for(K=0,J=A.length;K<J;++K)P[K]=-1;for(K=0,J=x.length;K<J;++K){var rt=x[K],lt=rt[0]+1,Qt=rt[1];for(se=w[Qt-1],de=w[lt-1],gt=w[lt],Yt(K,se,de,gt);++lt<=Qt;)Yt(K,se=de,de=gt,gt=w[lt])}function Yt(In,Fi,aa,un){if(P[aa]!==In){P[aa]=In;var Ai=N[aa];if(Ai>=0){var Gn=V[aa];(Ai!==Fi||Gn!==un)&&(Ai!==un||Gn!==Fi)&&(++k,W[aa]=1)}else N[aa]=Fi,V[aa]=un}}function or(){for(var In=hashmap(A.length*1.4,nr,dr,Int32Array,-1,Int32Array),Fi=new Int32Array(A.length),aa=0,un=A.length;aa<un;++aa)Fi[aa]=In.maybeSet(aa,aa);return Fi}function nr(In){return hashPoint(A[In])}function dr(In,Fi){return equalPoint(A[In],A[Fi])}P=N=V=null;var Mt=hashset(k*1.4,hashPoint,equalPoint),vi;for(K=0,J=A.length;K<J;++K)W[vi=w[K]]&&Mt.add(A[vi]);return Mt}function li(c){var A=join(c),_=c.coordinates,x=c.lines,w=c.rings,P,N,V;for(N=0,V=x.length;N<V;++N)for(var W=x[N],k=W[0],K=W[1];++k<K;)A.has(_[k])&&(P={0:k,1:W[1]},W[1]=k,W=W.next=P);for(N=0,V=w.length;N<V;++N)for(var J=w[N],se=J[0],de=se,gt=J[1],at=A.has(_[se]);++de<gt;)A.has(_[de])&&(at?(P={0:de,1:J[1]},J[1]=de,J=J.next=P):(Kn(_,se,gt,gt-de),_[gt]=_[se],at=!0,de=se));return c}function Kn(c,A,_,x){$r(c,A,_),$r(c,A,A+x),$r(c,A+x,_)}function $r(c,A,_){for(var x=A+(_---A>>1),w;A<x;++A,--_)w=c[A],c[A]=c[_],c[_]=w}function ln(c){var A=c.coordinates,_=c.lines,x,w=c.rings,P,N=_.length+w.length,V,W;for(delete c.lines,delete c.rings,V=0,W=_.length;V<W;++V)for(x=_[V];x=x.next;)++N;for(V=0,W=w.length;V<W;++V)for(P=w[V];P=P.next;)++N;var k=hashmap(N*2*1.4,hashPoint,equalPoint),K=c.arcs=[];for(V=0,W=_.length;V<W;++V){x=_[V];do J(x);while(x=x.next)}for(V=0,W=w.length;V<W;++V)if(P=w[V],P.next)do J(P);while(P=P.next);else se(P);function J(rt){var lt,Qt,Yt,or,nr,dr,Mt,vi;if(Yt=k.get(lt=A[rt[0]])){for(Mt=0,vi=Yt.length;Mt<vi;++Mt)if(or=Yt[Mt],de(or,rt)){rt[0]=or[0],rt[1]=or[1];return}}if(nr=k.get(Qt=A[rt[1]])){for(Mt=0,vi=nr.length;Mt<vi;++Mt)if(dr=nr[Mt],gt(dr,rt)){rt[1]=dr[0],rt[0]=dr[1];return}}Yt?Yt.push(rt):k.set(lt,[rt]),nr?nr.push(rt):k.set(Qt,[rt]),K.push(rt)}function se(rt){var lt,Qt,Yt,or,nr;if(Qt=k.get(lt=A[rt[0]]))for(or=0,nr=Qt.length;or<nr;++or){if(Yt=Qt[or],at(Yt,rt)){rt[0]=Yt[0],rt[1]=Yt[1];return}if(Zt(Yt,rt)){rt[0]=Yt[1],rt[1]=Yt[0];return}}if(Qt=k.get(lt=A[rt[0]+mt(rt)]))for(or=0,nr=Qt.length;or<nr;++or){if(Yt=Qt[or],at(Yt,rt)){rt[0]=Yt[0],rt[1]=Yt[1];return}if(Zt(Yt,rt)){rt[0]=Yt[1],rt[1]=Yt[0];return}}Qt?Qt.push(rt):k.set(lt,[rt]),K.push(rt)}function de(rt,lt){var Qt=rt[0],Yt=lt[0],or=rt[1],nr=lt[1];if(Qt-or!==Yt-nr)return!1;for(;Qt<=or;++Qt,++Yt)if(!equalPoint(A[Qt],A[Yt]))return!1;return!0}function gt(rt,lt){var Qt=rt[0],Yt=lt[0],or=rt[1],nr=lt[1];if(Qt-or!==Yt-nr)return!1;for(;Qt<=or;++Qt,--nr)if(!equalPoint(A[Qt],A[nr]))return!1;return!0}function at(rt,lt){var Qt=rt[0],Yt=lt[0],or=rt[1],nr=lt[1],dr=or-Qt;if(dr!==nr-Yt)return!1;for(var Mt=mt(rt),vi=mt(lt),In=0;In<dr;++In)if(!equalPoint(A[Qt+(In+Mt)%dr],A[Yt+(In+vi)%dr]))return!1;return!0}function Zt(rt,lt){var Qt=rt[0],Yt=lt[0],or=rt[1],nr=lt[1],dr=or-Qt;if(dr!==nr-Yt)return!1;for(var Mt=mt(rt),vi=dr-mt(lt),In=0;In<dr;++In)if(!equalPoint(A[Qt+(In+Mt)%dr],A[nr-(In+vi)%dr]))return!1;return!0}function mt(rt){for(var lt=rt[0],Qt=rt[1],Yt=lt,or=Yt,nr=A[Yt];++Yt<Qt;){var dr=A[Yt];(dr[0]<nr[0]||dr[0]===nr[0]&&dr[1]<nr[1])&&(or=Yt,nr=dr)}return or-lt}return c}function Cn(c){var A=-1,_=[],x=[],w=[];function P(J){J&&hasOwnProperty.call(N,J.type)&&N[J.type](J)}var N={GeometryCollection:function(J){J.geometries.forEach(P)},LineString:function(J){J.arcs=V(J.arcs)},MultiLineString:function(J){J.arcs=J.arcs.map(V)},Polygon:function(J){J.arcs=J.arcs.map(W)},MultiPolygon:function(J){J.arcs=J.arcs.map(k)}};function V(J){for(var se=0,de=J.length;se<de;++se)w[++A]=J[se];var gt={0:A-de+1,1:A};return _.push(gt),gt}function W(J){for(var se=0,de=J.length;se<de;++se)w[++A]=J[se];var gt={0:A-de+1,1:A};return x.push(gt),gt}function k(J){return J.map(W)}for(var K in c)P(c[K]);return{type:"Topology",coordinates:w,lines:_,rings:x,objects:c}}function $i(c,A,_){var x=A[0],w=A[1],P=A[2],N=A[3],V=P-x?(_-1)/(P-x):1,W=N-w?(_-1)/(N-w):1;function k(mt){return[Math.round((mt[0]-x)*V),Math.round((mt[1]-w)*W)]}function K(mt,rt){for(var lt=-1,Qt=0,Yt=mt.length,or=new Array(Yt),nr,dr,Mt,vi,In;++lt<Yt;)nr=mt[lt],vi=Math.round((nr[0]-x)*V),In=Math.round((nr[1]-w)*W),(vi!==dr||In!==Mt)&&(or[Qt++]=[dr=vi,Mt=In]);for(or.length=Qt;Qt<rt;)Qt=or.push([or[0][0],or[0][1]]);return or}function J(mt){return K(mt,2)}function se(mt){return K(mt,4)}function de(mt){return mt.map(se)}function gt(mt){mt!=null&&hasOwnProperty.call(at,mt.type)&&at[mt.type](mt)}var at={GeometryCollection:function(mt){mt.geometries.forEach(gt)},Point:function(mt){mt.coordinates=k(mt.coordinates)},MultiPoint:function(mt){mt.coordinates=mt.coordinates.map(k)},LineString:function(mt){mt.arcs=J(mt.arcs)},MultiLineString:function(mt){mt.arcs=mt.arcs.map(J)},Polygon:function(mt){mt.arcs=de(mt.arcs)},MultiPolygon:function(mt){mt.arcs=mt.arcs.map(de)}};for(var Zt in c)gt(c[Zt]);return{scale:[1/V,1/W],translate:[x,w]}}function ci(c,A){var _=bounds(c=geometry(c)),x=A>0&&_&&prequantize(c,_,A),w=dedup(cut(extract(c))),P=w.coordinates,N=hashmap(w.arcs.length*1.4,Ft,te);c=w.objects,w.bbox=_,w.arcs=w.arcs.map(function(se,de){return N.set(se,de),P.slice(se[0],se[1]+1)}),delete w.coordinates,P=null;function V(se){se&&hasOwnProperty.call(W,se.type)&&W[se.type](se)}var W={GeometryCollection:function(se){se.geometries.forEach(V)},LineString:function(se){se.arcs=k(se.arcs)},MultiLineString:function(se){se.arcs=se.arcs.map(k)},Polygon:function(se){se.arcs=se.arcs.map(k)},MultiPolygon:function(se){se.arcs=se.arcs.map(K)}};function k(se){var de=[];do{var gt=N.get(se);de.push(se[0]<se[1]?gt:~gt)}while(se=se.next);return de}function K(se){return se.map(k)}for(var J in c)V(c[J]);return x&&(w.transform=x,w.arcs=delta(w.arcs)),w}function Ft(c){var A=c[0],_=c[1],x;return _<A&&(x=A,A=_,_=x),A+31*_}function te(c,A){var _=c[0],x=c[1],w=A[0],P=A[1],N;return x<_&&(N=_,_=x,x=N),P<w&&(N=w,w=P,P=N),_===w&&x===P}function We(c,A){if(A===void 0&&(A={}),getType(c)!=="FeatureCollection")throw new Error("geojson must be a FeatureCollection");if(!c.features.length)throw new Error("geojson is empty");(A.mutate===!1||A.mutate===void 0)&&(c=clone(c));var _=[];flattenEach(c,function(P){_.push(P.geometry)});var x=topology({geoms:geometryCollection(_).geometry}),w=merge(x,x.objects.geoms.geometries);return w}function Qe(c,A){if(A===void 0&&(A={}),A=A||{},!isObject(A))throw new Error("options is invalid");var _=A.mutate;if(getType(c)!=="FeatureCollection")throw new Error("geojson must be a FeatureCollection");if(!c.features.length)throw new Error("geojson is empty");(_===!1||_===void 0)&&(c=clone(c));var x=vt(c);if(!x)throw new Error("geojson must be homogenous");var w=c;switch(x){case"LineString":return lineDissolve(w,A);case"Polygon":return polygonDissolve(w,A);default:throw new Error(x+" is not supported")}}function vt(c){var A={};flattenEach(c,function(x){A[x.geometry.type]=!0});var _=Object.keys(A);return _.length===1?_[0]:null}var Lt=null;function Pt(c,A){A===void 0&&(A={});var _=A.maxEdge||1/0,x=Cr(c),w=tin(x);if(w.features=w.features.filter(function(N){var V=N.geometry.coordinates[0][0],W=N.geometry.coordinates[0][1],k=N.geometry.coordinates[0][2],K=distance(V,W,A),J=distance(W,k,A),se=distance(V,k,A);return K<=_&&J<=_&&se<=_}),w.features.length<1)return null;var P=dissolve(w);return P.coordinates.length===1&&(P.coordinates=P.coordinates[0],P.type="Polygon"),feature(P)}function Cr(c){var A=[],_={};return featureEach(c,function(x){if(x.geometry){var w=x.geometry.coordinates.join("-");Object.prototype.hasOwnProperty.call(_,w)||(A.push(x),_[w]=!0)}}),featureCollection(A)}var yt=null,Ot=C(85475);function rr(c,A,_,x){var w=rbush(6),P=A.features.map(function(N){var V;return{minX:N.geometry.coordinates[0],minY:N.geometry.coordinates[1],maxX:N.geometry.coordinates[0],maxY:N.geometry.coordinates[1],property:(V=N.properties)===null||V===void 0?void 0:V[_]}});return w.load(P),c.features.forEach(function(N){N.properties||(N.properties={});var V=turfbbox(N),W=w.search({minX:V[0],minY:V[1],maxX:V[2],maxY:V[3]}),k=[];W.forEach(function(K){booleanPointInPolygon([K.minX,K.minY],N)&&k.push(K.property)}),N.properties[x]=k}),c}var Sr=null;function Lr(c,A){if(A=A||{},!isObject(A))throw new Error("options is invalid");var _=A.mutate;if(!c)throw new Error("geojson is required");return(_===!1||_===void 0)&&(c=clone(c)),coordEach(c,function(x){var w=x[0],P=x[1];x[0]=P,x[1]=w}),c}var on=null;function hn(c,A){A===void 0&&(A={});var _=typeof A=="object"?A.mutate:A;if(!c)throw new Error("geojson is required");var x=getType(c),w=[];switch(x){case"LineString":w=zr(c);break;case"MultiLineString":case"Polygon":getCoords(c).forEach(function(N){w.push(zr(N))});break;case"MultiPolygon":getCoords(c).forEach(function(N){var V=[];N.forEach(function(W){V.push(zr(W))}),w.push(V)});break;case"Point":return c;case"MultiPoint":var P={};getCoords(c).forEach(function(N){var V=N.join("-");Object.prototype.hasOwnProperty.call(P,V)||(w.push(N),P[V]=!0)});break;default:throw new Error(x+" geometry not supported")}return c.coordinates?_===!0?(c.coordinates=w,c):{type:x,coordinates:w}:_===!0?(c.geometry.coordinates=w,c):feature({type:x,coordinates:w},c.properties,{bbox:c.bbox,id:c.id})}function zr(c){var A=getCoords(c);if(A.length===2&&!rn(A[0],A[1]))return A;var _=[],x=A.length-1,w=_.length;_.push(A[0]);for(var P=1;P<x;P++){var N=_[_.length-1];A[P][0]===N[0]&&A[P][1]===N[1]||(_.push(A[P]),w=_.length,w>2&&Wn(_[w-3],_[w-1],_[w-2])&&_.splice(_.length-2,1))}if(_.push(A[A.length-1]),w=_.length,rn(A[0],A[A.length-1])&&w<4)throw new Error("invalid polygon");return Wn(_[w-3],_[w-1],_[w-2])&&_.splice(_.length-2,1),_}function rn(c,A){return c[0]===A[0]&&c[1]===A[1]}function Wn(c,A,_){var x=_[0],w=_[1],P=c[0],N=c[1],V=A[0],W=A[1],k=x-P,K=w-N,J=V-P,se=W-N,de=k*se-K*J;return de!==0?!1:Math.abs(J)>=Math.abs(se)?J>0?P<=x&&x<=V:V<=x&&x<=P:se>0?N<=w&&w<=W:W<=w&&w<=N}var jn=null;function mi(c,A){var _=c.x-A.x,x=c.y-A.y;return _*_+x*x}function Ea(c,A,_){var x=A.x,w=A.y,P=_.x-x,N=_.y-w;if(P!==0||N!==0){var V=((c.x-x)*P+(c.y-w)*N)/(P*P+N*N);V>1?(x=_.x,w=_.y):V>0&&(x+=P*V,w+=N*V)}return P=c.x-x,N=c.y-w,P*P+N*N}function ja(c,A){for(var _=c[0],x=[_],w,P=1,N=c.length;P<N;P++)w=c[P],mi(w,_)>A&&(x.push(w),_=w);return _!==w&&x.push(w),x}function Wr(c,A,_,x,w){for(var P=x,N,V=A+1;V<_;V++){var W=Ea(c[V],c[A],c[_]);W>P&&(N=V,P=W)}P>x&&(N-A>1&&Wr(c,A,N,x,w),w.push(c[N]),_-N>1&&Wr(c,N,_,x,w))}function no(c,A){var _=c.length-1,x=[c[0]];return Wr(c,0,_,A,x),x.push(c[_]),x}function Xo(c,A,_){if(c.length<=2)return c;var x=A!==void 0?A*A:1;return c=_?c:ja(c,x),c=no(c,x),c}function Xn(c,A){if(A=A||{},!isObject(A))throw new Error("options is invalid");var _=A.tolerance!==void 0?A.tolerance:1,x=A.highQuality||!1,w=A.mutate||!1;if(!c)throw new Error("geojson is required");if(_&&_<0)throw new Error("invalid tolerance");return w!==!0&&(c=clone(c)),geomEach(c,function(P){Hs(P,_,x)}),c}function Hs(c,A,_){var x=c.type;if(x==="Point"||x==="MultiPoint")return c;cleanCoords(c,!0);var w=c.coordinates;switch(x){case"LineString":c.coordinates=Bo(w,A,_);break;case"MultiLineString":c.coordinates=w.map(function(P){return Bo(P,A,_)});break;case"Polygon":c.coordinates=iu(w,A,_);break;case"MultiPolygon":c.coordinates=w.map(function(P){return iu(P,A,_)})}return c}function Bo(c,A,_){return Xo(c.map(function(x){return{x:x[0],y:x[1],z:x[2]}}),A,_).map(function(x){return x.z?[x.x,x.y,x.z]:[x.x,x.y]})}function iu(c,A,_){return c.map(function(x){var w=x.map(function(N){return{x:N[0],y:N[1]}});if(w.length<4)throw new Error("invalid polygon");for(var P=Xo(w,A,_).map(function(N){return[N.x,N.y]});!ts(P);)A-=A*.01,P=Xo(w,A,_).map(function(N){return[N.x,N.y]});return(P[P.length-1][0]!==P[0][0]||P[P.length-1][1]!==P[0][1])&&P.push(P[0]),P})}function ts(c){return c.length<3?!1:!(c.length===3&&c[2][0]===c[0][0]&&c[2][1]===c[0][1])}var Vl=null,ku=function(){function c(A){this.points=A.points||[],this.duration=A.duration||1e4,this.sharpness=A.sharpness||.85,this.centers=[],this.controls=[],this.stepLength=A.stepLength||60,this.length=this.points.length,this.delay=0;for(var _=0;_<this.length;_++)this.points[_].z=this.points[_].z||0;for(var _=0;_<this.length-1;_++){var x=this.points[_],w=this.points[_+1];this.centers.push({x:(x.x+w.x)/2,y:(x.y+w.y)/2,z:(x.z+w.z)/2})}this.controls.push([this.points[0],this.points[0]]);for(var _=0;_<this.centers.length-1;_++){var P=this.points[_+1].x-(this.centers[_].x+this.centers[_+1].x)/2,N=this.points[_+1].y-(this.centers[_].y+this.centers[_+1].y)/2,V=this.points[_+1].z-(this.centers[_].y+this.centers[_+1].z)/2;this.controls.push([{x:(1-this.sharpness)*this.points[_+1].x+this.sharpness*(this.centers[_].x+P),y:(1-this.sharpness)*this.points[_+1].y+this.sharpness*(this.centers[_].y+N),z:(1-this.sharpness)*this.points[_+1].z+this.sharpness*(this.centers[_].z+V)},{x:(1-this.sharpness)*this.points[_+1].x+this.sharpness*(this.centers[_+1].x+P),y:(1-this.sharpness)*this.points[_+1].y+this.sharpness*(this.centers[_+1].y+N),z:(1-this.sharpness)*this.points[_+1].z+this.sharpness*(this.centers[_+1].z+V)}])}return this.controls.push([this.points[this.length-1],this.points[this.length-1]]),this.steps=this.cacheSteps(this.stepLength),this}return c.prototype.cacheSteps=function(A){var _=[],x=this.pos(0);_.push(0);for(var w=0;w<this.duration;w+=10){var P=this.pos(w),N=Math.sqrt((P.x-x.x)*(P.x-x.x)+(P.y-x.y)*(P.y-x.y)+(P.z-x.z)*(P.z-x.z));N>A&&(_.push(w),x=P)}return _},c.prototype.vector=function(A){var _=this.pos(A+10),x=this.pos(A-10);return{angle:180*Math.atan2(_.y-x.y,_.x-x.x)/3.14,speed:Math.sqrt((x.x-_.x)*(x.x-_.x)+(x.y-_.y)*(x.y-_.y)+(x.z-_.z)*(x.z-_.z))}},c.prototype.pos=function(A){var _=A-this.delay;_<0&&(_=0),_>this.duration&&(_=this.duration-1);var x=_/this.duration;if(x>=1)return this.points[this.length-1];var w=Math.floor((this.points.length-1)*x),P=(this.length-1)*x-w;return bs(P,this.points[w],this.controls[w][1],this.controls[w+1][0],this.points[w+1])},c}(),Ds=null;function bs(c,A,_,x,w){var P=Fa(c),N={x:w.x*P[0]+x.x*P[1]+_.x*P[2]+A.x*P[3],y:w.y*P[0]+x.y*P[1]+_.y*P[2]+A.y*P[3],z:w.z*P[0]+x.z*P[1]+_.z*P[2]+A.z*P[3]};return N}function Fa(c){var A=c*c,_=A*c;return[_,3*A*(1-c),3*c*(1-c)*(1-c),(1-c)*(1-c)*(1-c)]}function uc(c,A){A===void 0&&(A={});for(var _=A.resolution||1e4,x=A.sharpness||.85,w=[],P=getGeom(c).coordinates.map(function(k){return{x:k[0],y:k[1]}}),N=new Spline({duration:_,points:P,sharpness:x}),V=function(k){var K=N.pos(k);Math.floor(k/100)%2===0&&w.push([K.x,K.y])},W=0;W<N.duration;W+=10)V(W);return V(N.duration),lineString(w,A.properties)}var Uu=null;function ta(c,A,_,x){return c=clone(c),A=clone(A),featureEach(c,function(w){w.properties||(w.properties={}),featureEach(A,function(P){w.properties[x]===void 0&&booleanPointInPolygon(w,P)&&(w.properties[x]=P.properties[_])})}),c}var au=null;function mo(c,A){if(!c)throw new Error("featurecollection is required");if(A==null)throw new Error("num is required");if(typeof A!="number")throw new Error("num must be a number");var _=featureCollection(Rs(c.features,A));return _}function Rs(c,A){for(var _=c.slice(0),x=c.length,w=x-A,P,N;x-- >w;)N=Math.floor((x+1)*Math.random()),P=_[N],_[N]=_[x],_[x]=P;return _.slice(w)}var rs=null,Qi=C(39511);function _o(c){return(0,Qi.Z)((0,I.Z)(c))}var Ws=_o;function ds(c){var A=c[0],_=c[1],x=c[2],w=c[3],P=distance(c.slice(0,2),[x,_]),N=distance(c.slice(0,2),[A,w]);if(P>=N){var V=(_+w)/2;return[A,V-(x-A)/2,x,V+(x-A)/2]}else{var W=(A+x)/2;return[W-(w-_)/2,_,W+(w-_)/2,w]}}var il=null;function Ba(c,A,_,x){x===void 0&&(x={});var w=getCoord(c),P=degreesToRadians(w[0]),N=degreesToRadians(w[1]),V=degreesToRadians(_),W=lengthToRadians(A,x.units),k=Math.asin(Math.sin(N)*Math.cos(W)+Math.cos(N)*Math.sin(W)*Math.cos(V)),K=P+Math.atan2(Math.sin(V)*Math.sin(W)*Math.cos(N),Math.cos(W)-Math.sin(N)*Math.sin(k)),J=radiansToDegrees(K),se=radiansToDegrees(k);return point([J,se],x.properties)}function Oa(c,A,_){_===void 0&&(_={});for(var x=_.steps||64,w=_.properties?_.properties:!Array.isArray(c)&&c.type==="Feature"&&c.properties?c.properties:{},P=[],N=0;N<x;N++)P.push(destination(c,A,N*-360/x,_).geometry.coordinates);return P.push(P[0]),polygon([P],w)}var Cl=null;function Co(c,A,_){if(_===void 0&&(_={}),_.final===!0)return gu(c,A);var x=getCoord(c),w=getCoord(A),P=degreesToRadians(x[0]),N=degreesToRadians(w[0]),V=degreesToRadians(x[1]),W=degreesToRadians(w[1]),k=Math.sin(N-P)*Math.cos(W),K=Math.cos(V)*Math.sin(W)-Math.sin(V)*Math.cos(W)*Math.cos(N-P);return radiansToDegrees(Math.atan2(k,K))}function gu(c,A){var _=Co(A,c);return _=(_+180)%360,_}function ka(c,A){var _=distance(c,A),x=bearing(c,A),w=destination(c,_/2,x);return w}var Ru=null;function cr(c,A){A===void 0&&(A={});var _=bbox(c),x=(_[0]+_[2])/2,w=(_[1]+_[3])/2;return point([x,w],A.properties,A)}var yn=null;function bo(c,A){A===void 0&&(A={});var _=0,x=0,w=0;return coordEach(c,function(P){_+=P[0],x+=P[1],w++},!0),point([_/w,x/w],A.properties)}var mu=null;function _u(c,A){switch(A===void 0&&(A={}),getType(c)){case"Point":return point(getCoord(c),A.properties);case"Polygon":var _=[];coordEach(c,function(Qt){_.push(Qt)});var x=centroid(c,{properties:A.properties}),w=x.geometry.coordinates,P=0,N=0,V=0,W,k,K,J,se,de,gt,at,Zt=_.map(function(Qt){return[Qt[0]-w[0],Qt[1]-w[1]]});for(W=0;W<_.length-1;W++)k=Zt[W],J=k[0],de=k[1],K=Zt[W+1],se=K[0],gt=K[1],at=J*gt-se*de,V+=at,P+=(J+se)*at,N+=(de+gt)*at;if(V===0)return x;var mt=V*.5,rt=1/(6*mt);return point([w[0]+rt*P,w[1]+rt*N],A.properties);default:var lt=convex(c);return lt?_u(lt,{properties:A.properties}):centroid(c,{properties:A.properties})}}var js=null;function ou(c){var A={MultiPoint:{coordinates:[],properties:[]},MultiLineString:{coordinates:[],properties:[]},MultiPolygon:{coordinates:[],properties:[]}};return featureEach(c,function(_){var x,w,P,N;switch((N=_.geometry)===null||N===void 0?void 0:N.type){case"Point":A.MultiPoint.coordinates.push(_.geometry.coordinates),A.MultiPoint.properties.push(_.properties);break;case"MultiPoint":(x=A.MultiPoint.coordinates).push.apply(x,_.geometry.coordinates),A.MultiPoint.properties.push(_.properties);break;case"LineString":A.MultiLineString.coordinates.push(_.geometry.coordinates),A.MultiLineString.properties.push(_.properties);break;case"MultiLineString":(w=A.MultiLineString.coordinates).push.apply(w,_.geometry.coordinates),A.MultiLineString.properties.push(_.properties);break;case"Polygon":A.MultiPolygon.coordinates.push(_.geometry.coordinates),A.MultiPolygon.properties.push(_.properties);break;case"MultiPolygon":(P=A.MultiPolygon.coordinates).push.apply(P,_.geometry.coordinates),A.MultiPolygon.properties.push(_.properties);break;default:break}}),featureCollection(Object.keys(A).filter(function(_){return A[_].coordinates.length}).sort().map(function(_){var x={type:_,coordinates:A[_].coordinates},w={collectedProperties:A[_].properties};return feature(x,w)}))}var qa=null;function lc(c){var A=[];return c.type==="FeatureCollection"?featureEach(c,function(_){coordEach(_,function(x){A.push(point(x,_.properties))})}):coordEach(c,function(_){A.push(point(_,c.properties))}),featureCollection(A)}var Ls=null,su=C(80569);function Nc(c){if(!c.geometry||c.geometry.type!=="Polygon"&&c.geometry.type!=="MultiPolygon")throw new Error("input must be a Polygon or MultiPolygon");var A={type:"FeatureCollection",features:[]};return c.geometry.type==="Polygon"?A.features=Oi(c.geometry.coordinates):c.geometry.coordinates.forEach(function(_){A.features=A.features.concat(Oi(_))}),A}function Oi(c){var A=bl(c),_=2,x=earcut(A.vertices,A.holes,_),w=[],P=[];x.forEach(function(W,k){var K=x[k];P.push([A.vertices[K*_],A.vertices[K*_+1]])});for(var N=0;N<P.length;N+=3){var V=P.slice(N,N+3);V.push(P[N]),w.push(polygon([V]))}return w}function bl(c){for(var A=c[0][0].length,_={vertices:[],holes:[],dimensions:A},x=0,w=0;w<c.length;w++){for(var P=0;P<c[w].length;P++)for(var N=0;N<A;N++)_.vertices.push(c[w][P][N]);w>0&&(x+=c[w-1].length,_.holes.push(x))}return _}var Fs=null;function Hl(c,A){if(!c)throw new Error("targetPoint is required");if(!A)throw new Error("points is required");var _,x=1/0,w=0;return featureEach(A,function(P,N){var V=distance(c,P);V<x&&(w=N,x=V)}),_=clone(A.features[w]),_.properties.featureIndex=w,_.properties.distanceToPoint=x,_}var Ri=null;function Rl(c){if(!c)throw new Error("geojson is required");var A=[];return flattenEach(c,function(_){Yf(_,A)}),featureCollection(A)}function Yf(c,A){var _=[],x=c.geometry;if(x!==null){switch(x.type){case"Polygon":_=getCoords(x);break;case"LineString":_=[getCoords(x)]}_.forEach(function(w){var P=al(w,c.properties);P.forEach(function(N){N.id=A.length,A.push(N)})})}}function al(c,A){var _=[];return c.reduce(function(x,w){var P=lineString([x,w],A);return P.bbox=Ka(x,w),_.push(P),w}),_}function Ka(c,A){var _=c[0],x=c[1],w=A[0],P=A[1],N=_<w?_:w,V=x<P?x:P,W=_>w?_:w,k=x>P?x:P;return[N,V,W,k]}var bt=null,Ye=C(56898);function qt(c,A){var _={},x=[];if(c.type==="LineString"&&(c=feature(c)),A.type==="LineString"&&(A=feature(A)),c.type==="Feature"&&A.type==="Feature"&&c.geometry!==null&&A.geometry!==null&&c.geometry.type==="LineString"&&A.geometry.type==="LineString"&&c.geometry.coordinates.length===2&&A.geometry.coordinates.length===2){var w=fe(c,A);return w&&x.push(w),featureCollection(x)}var P=rbush();return P.load(lineSegment(A)),featureEach(lineSegment(c),function(N){featureEach(P.search(N),function(V){var W=fe(N,V);if(W){var k=getCoords(W).join(",");_[k]||(_[k]=!0,x.push(W))}})}),featureCollection(x)}function fe(c,A){var _=getCoords(c),x=getCoords(A);if(_.length!==2)throw new Error("<intersects> line1 must only contain 2 coordinates");if(x.length!==2)throw new Error("<intersects> line2 must only contain 2 coordinates");var w=_[0][0],P=_[0][1],N=_[1][0],V=_[1][1],W=x[0][0],k=x[0][1],K=x[1][0],J=x[1][1],se=(J-k)*(N-w)-(K-W)*(V-P),de=(K-W)*(P-k)-(J-k)*(w-W),gt=(N-w)*(P-k)-(V-P)*(w-W);if(se===0)return null;var at=de/se,Zt=gt/se;if(at>=0&&at<=1&&Zt>=0&&Zt<=1){var mt=w+at*(N-w),rt=P+at*(V-P);return point([mt,rt])}return null}var Ue=null;function Ke(c,A,_){_===void 0&&(_={});var x=point([1/0,1/0],{dist:1/0}),w=0;return flattenEach(c,function(P){for(var N=getCoords(P),V=0;V<N.length-1;V++){var W=point(N[V]);W.properties.dist=distance(A,W,_);var k=point(N[V+1]);k.properties.dist=distance(A,k,_);var K=distance(W,k,_),J=Math.max(W.properties.dist,k.properties.dist),se=bearing(W,k),de=destination(A,J,se+90,_),gt=destination(A,J,se-90,_),at=lineIntersects(lineString([de.geometry.coordinates,gt.geometry.coordinates]),lineString([W.geometry.coordinates,k.geometry.coordinates])),Zt=null;at.features.length>0&&(Zt=at.features[0],Zt.properties.dist=distance(A,Zt,_),Zt.properties.location=w+distance(W,Zt,_)),W.properties.dist<x.properties.dist&&(x=W,x.properties.index=V,x.properties.location=w),k.properties.dist<x.properties.dist&&(x=k,x.properties.index=V+1,x.properties.location=w+K),Zt&&Zt.properties.dist<x.properties.dist&&(x=Zt,x.properties.index=V),w+=K}}),x}var Ht=null;function vr(c,A,_){_===void 0&&(_={});var x=getCoord(c),w=getCoord(A);w[0]+=w[0]-x[0]>180?-360:x[0]-w[0]>180?360:0;var P=Nr(x,w),N=convertLength(P,"meters",_.units);return N}function Nr(c,A,_){_=_===void 0?earthRadius:Number(_);var x=_,w=c[1]*Math.PI/180,P=A[1]*Math.PI/180,N=P-w,V=Math.abs(A[0]-c[0])*Math.PI/180;V>Math.PI&&(V-=2*Math.PI);var W=Math.log(Math.tan(P/2+Math.PI/4)/Math.tan(w/2+Math.PI/4)),k=Math.abs(W)>1e-11?N/W:Math.cos(w),K=Math.sqrt(N*N+k*k*V*V),J=K*x;return J}var mn=null;function zn(c,A,_){if(_===void 0&&(_={}),_.method||(_.method="geodesic"),_.units||(_.units="kilometers"),!c)throw new Error("pt is required");if(Array.isArray(c)?c=point(c):c.type==="Point"?c=feature(c):featureOf(c,"Point","point"),!A)throw new Error("line is required");Array.isArray(A)?A=lineString(A):A.type==="LineString"?A=feature(A):featureOf(A,"LineString","line");var x=1/0,w=c.geometry.coordinates;return segmentEach(A,function(P){var N=P.geometry.coordinates[0],V=P.geometry.coordinates[1],W=Mi(w,N,V,_);W<x&&(x=W)}),convertLength(x,"degrees",_.units)}function Mi(c,A,_,x){var w=[_[0]-A[0],_[1]-A[1]],P=[c[0]-A[0],c[1]-A[1]],N=Ro(P,w);if(N<=0)return Ms(c,A,{method:x.method,units:"degrees"});var V=Ro(w,w);if(V<=N)return Ms(c,_,{method:x.method,units:"degrees"});var W=N/V,k=[A[0]+W*w[0],A[1]+W*w[1]];return Ms(c,k,{method:x.method,units:"degrees"})}function Ro(c,A){return c[0]*A[0]+c[1]*A[1]}function Ms(c,A,_){return _.method==="planar"?getPlanarDistance(c,A,_):getDistance(c,A,_)}var Xs=null;function If(c,A,_){_===void 0&&(_={});var x=_.units,w=_.properties||{},P=uu(c);if(!P.features.length)throw new Error("points must contain features");if(!A)throw new Error("line is required");if(getType(A)!=="LineString")throw new Error("line must be a LineString");var N=1/0,V=null;return featureEach(P,function(W){var k=pointToLineDistance(W,A,{units:x});k<N&&(N=k,V=W)}),V&&(V.properties=objectAssign({dist:N},V.properties,w)),V}function uu(c){var A=[],_=c.geometry?c.geometry.type:c.type;switch(_){case"GeometryCollection":return geomEach(c,function(x){x.type==="Point"&&A.push({type:"Feature",properties:{},geometry:x})}),{type:"FeatureCollection",features:A};case"FeatureCollection":return c.features=c.features.filter(function(x){return x.geometry.type==="Point"}),c;default:throw new Error("points must be a Point Collection")}}var ca=null;function Dc(c,A){var _=getCoord(c),x=getGeom(A),w=x.coordinates,P=w[0];if(P.length<4)throw new Error("OuterRing of a Polygon must have 4 or more Positions.");var N=A.properties||{},V=N.a,W=N.b,k=N.c,K=_[0],J=_[1],se=P[0][0],de=P[0][1],gt=V!==void 0?V:P[0][2],at=P[1][0],Zt=P[1][1],mt=W!==void 0?W:P[1][2],rt=P[2][0],lt=P[2][1],Qt=k!==void 0?k:P[2][2],Yt=(Qt*(K-se)*(J-Zt)+gt*(K-at)*(J-lt)+mt*(K-rt)*(J-de)-mt*(K-se)*(J-lt)-Qt*(K-at)*(J-de)-gt*(K-rt)*(J-Zt))/((K-se)*(J-Zt)+(K-at)*(J-lt)+(K-rt)*(J-de)-(K-se)*(J-lt)-(K-at)*(J-de)-(K-rt)*(J-Zt));return Yt}var ns=null;function Lc(c){var A,_,x={type:"FeatureCollection",features:[]};if(c.type==="Feature"?_=c.geometry:_=c,_.type==="LineString")A=[_.coordinates];else if(_.type==="MultiLineString")A=_.coordinates;else if(_.type==="MultiPolygon")A=[].concat.apply([],_.coordinates);else if(_.type==="Polygon")A=_.coordinates;else throw new Error("Input must be a LineString, MultiLineString, Polygon, or MultiPolygon Feature or Geometry");return A.forEach(function(w){A.forEach(function(P){for(var N=0;N<w.length-1;N++)for(var V=N;V<P.length-1;V++)if(!(w===P&&(Math.abs(N-V)===1||N===0&&V===w.length-2&&w[N][0]===w[w.length-1][0]&&w[N][1]===w[w.length-1][1]))){var W=ol(w[N][0],w[N][1],w[N+1][0],w[N+1][1],P[V][0],P[V][1],P[V+1][0],P[V+1][1]);W&&x.features.push(point([W[0],W[1]]))}})}),x}function ol(c,A,_,x,w,P,N,V){var W,k,K,J,se,de={x:null,y:null,onLine1:!1,onLine2:!1};return W=(V-P)*(_-c)-(N-w)*(x-A),W===0?de.x!==null&&de.y!==null?de:!1:(k=A-P,K=c-w,J=(N-w)*k-(V-P)*K,se=(_-c)*k-(x-A)*K,k=J/W,K=se/W,de.x=c+k*(_-c),de.y=A+k*(x-A),k>=0&&k<=1&&(de.onLine1=!0),K>=0&&K<=1&&(de.onLine2=!0),de.onLine1&&de.onLine2?[de.x,de.y]:!1)}function Xa(c){for(var A=Fn(c),_=centroid(A),x=!1,w=0;!x&&w<A.features.length;){var P=A.features[w].geometry,N,V,W,k,K,J,se,de=!1;if(P.type==="Point")_.geometry.coordinates[0]===P.coordinates[0]&&_.geometry.coordinates[1]===P.coordinates[1]&&(x=!0);else if(P.type==="MultiPoint"){var gt=!1;for(se=0;!gt&&se<P.coordinates.length;)_.geometry.coordinates[0]===P.coordinates[se][0]&&_.geometry.coordinates[1]===P.coordinates[se][1]&&(x=!0,gt=!0),se++}else if(P.type==="LineString")for(se=0;!de&&se<P.coordinates.length-1;)N=_.geometry.coordinates[0],V=_.geometry.coordinates[1],W=P.coordinates[se][0],k=P.coordinates[se][1],K=P.coordinates[se+1][0],J=P.coordinates[se+1][1],Wl(N,V,W,k,K,J)&&(de=!0,x=!0),se++;else if(P.type==="MultiLineString")for(var at=0;at<P.coordinates.length;){de=!1,se=0;for(var Zt=P.coordinates[at];!de&&se<Zt.length-1;)N=_.geometry.coordinates[0],V=_.geometry.coordinates[1],W=Zt[se][0],k=Zt[se][1],K=Zt[se+1][0],J=Zt[se+1][1],Wl(N,V,W,k,K,J)&&(de=!0,x=!0),se++;at++}else(P.type==="Polygon"||P.type==="MultiPolygon")&&booleanPointInPolygon(_,P)&&(x=!0);w++}if(x)return _;var mt=featureCollection([]);for(w=0;w<A.features.length;w++)mt.features=mt.features.concat(explode(A.features[w]).features);return point(nearestPoint(_,mt).geometry.coordinates)}function Fn(c){return c.type!=="FeatureCollection"?c.type!=="Feature"?featureCollection([feature(c)]):featureCollection([c]):c}function Wl(c,A,_,x,w,P){var N=Math.sqrt((w-_)*(w-_)+(P-x)*(P-x)),V=Math.sqrt((c-_)*(c-_)+(A-x)*(A-x)),W=Math.sqrt((w-c)*(w-c)+(P-A)*(P-A));return N===V+W}var Ys=null,lu=6378137;function ws(c){return geomReduce(c,function(A,_){return A+Mu(_)},0)}function Mu(c){var A=0,_;switch(c.type){case"Polygon":return wi(c.coordinates);case"MultiPolygon":for(_=0;_<c.coordinates.length;_++)A+=wi(c.coordinates[_]);return A;case"Point":case"MultiPoint":case"LineString":case"MultiLineString":return 0}return 0}function wi(c){var A=0;if(c&&c.length>0){A+=Math.abs(Is(c[0]));for(var _=1;_<c.length;_++)A-=Math.abs(Is(c[_]))}return A}function Is(c){var A,_,x,w,P,N,V,W=0,k=c.length;if(k>2){for(V=0;V<k;V++)V===k-2?(w=k-2,P=k-1,N=0):V===k-1?(w=k-1,P=0,N=1):(w=V,P=V+1,N=V+2),A=c[w],_=c[P],x=c[N],W+=(io(x[0])-io(A[0]))*Math.sin(io(_[1]));W=W*lu*lu/2}return W}function io(c){return c*Math.PI/180}function Ya(c,A,_){_===void 0&&(_={});for(var x=getGeom(c),w=x.coordinates,P=0,N=0;N<w.length&&!(A>=P&&N===w.length-1);N++)if(P>=A){var V=A-P;if(V){var W=bearing(w[N],w[N-1])-180,k=destination(w[N],V,W,_);return k}else return point(w[N])}else P+=measureDistance(w[N],w[N+1],_);return point(w[w.length-1])}function ko(c,A){return A===void 0&&(A={}),segmentReduce(c,function(_,x){var w=x.geometry.coordinates;return _+distance(w[0],w[1],A)},0)}function wu(c,A,_){var x=getCoords(_);if(getType(_)!=="LineString")throw new Error("line must be a LineString");var w=nearestPointOnLine(_,c),P=nearestPointOnLine(_,A),N;w.properties.index<=P.properties.index?N=[w,P]:N=[P,w];for(var V=[N[0].geometry.coordinates],W=N[0].properties.index+1;W<N[1].properties.index+1;W++)V.push(x[W]);return V.push(N[1].geometry.coordinates),lineString(V,_.properties)}var $f=null;function cc(c,A,_,x){if(x=x||{},!isObject(x))throw new Error("options is invalid");var w,P=[];if(c.type==="Feature")w=c.geometry.coordinates;else if(c.type==="LineString")w=c.coordinates;else throw new Error("input must be a LineString Feature or Geometry");for(var N=w.length,V=0,W,k,K,J=0;J<w.length&&!(A>=V&&J===w.length-1);J++){if(V>A&&P.length===0){if(W=A-V,!W)return P.push(w[J]),lineString(P);k=bearing(w[J],w[J-1])-180,K=destination(w[J],W,k,x),P.push(K.geometry.coordinates)}if(V>=_)return W=_-V,W?(k=bearing(w[J],w[J-1])-180,K=destination(w[J],W,k,x),P.push(K.geometry.coordinates),lineString(P)):(P.push(w[J]),lineString(P));if(V>=A&&P.push(w[J]),J===w.length-1)return lineString(P);V+=distance(w[J],w[J+1],x)}if(V<A&&w.length===N)throw new Error("Start position is beyond line");var se=w[w.length-1];return lineString([se,se])}var Pf=null;function jl(c,A,_){_===void 0&&(_={});for(var x=getCoord(c),w=getCoords(A),P=0;P<w.length-1;P++){var N=!1;if(_.ignoreEndVertices&&(P===0&&(N="start"),P===w.length-2&&(N="end"),P===0&&P+1===w.length-1&&(N="both")),vs(w[P],w[P+1],x,N,typeof _.epsilon=="undefined"?null:_.epsilon))return!0}return!1}function vs(c,A,_,x,w){var P=_[0],N=_[1],V=c[0],W=c[1],k=A[0],K=A[1],J=_[0]-V,se=_[1]-W,de=k-V,gt=K-W,at=J*gt-se*de;if(w!==null){if(Math.abs(at)>w)return!1}else if(at!==0)return!1;if(x){if(x==="start")return Math.abs(de)>=Math.abs(gt)?de>0?V<P&&P<=k:k<=P&&P<V:gt>0?W<N&&N<=K:K<=N&&N<W;if(x==="end")return Math.abs(de)>=Math.abs(gt)?de>0?V<=P&&P<k:k<P&&P<=V:gt>0?W<=N&&N<K:K<N&&N<=W;if(x==="both")return Math.abs(de)>=Math.abs(gt)?de>0?V<P&&P<k:k<P&&P<V:gt>0?W<N&&N<K:K<N&&N<W}else return Math.abs(de)>=Math.abs(gt)?de>0?V<=P&&P<=k:k<=P&&P<=V:gt>0?W<=N&&N<=K:K<=N&&N<=W;return!1}var Ml=null;function yo(c,A){var _=getGeom(c),x=getGeom(A),w=_.type,P=x.type;switch(w){case"Point":switch(P){case"MultiPoint":return ba(_,x);case"LineString":return booleanPointOnLine(_,x,{ignoreEndVertices:!0});case"Polygon":case"MultiPolygon":return booleanPointInPolygon(_,x,{ignoreBoundary:!0});default:throw new Error("feature2 "+P+" geometry not supported")}case"MultiPoint":switch(P){case"MultiPoint":return gs(_,x);case"LineString":return Xl(_,x);case"Polygon":case"MultiPolygon":return Ua(_,x);default:throw new Error("feature2 "+P+" geometry not supported")}case"LineString":switch(P){case"LineString":return On(_,x);case"Polygon":case"MultiPolygon":return wl(_,x);default:throw new Error("feature2 "+P+" geometry not supported")}case"Polygon":switch(P){case"Polygon":case"MultiPolygon":return fc(_,x);default:throw new Error("feature2 "+P+" geometry not supported")}default:throw new Error("feature1 "+w+" geometry not supported")}}function ba(c,A){var _,x=!1;for(_=0;_<A.coordinates.length;_++)if(cu(A.coordinates[_],c.coordinates)){x=!0;break}return x}function gs(c,A){for(var _=0;_<c.coordinates.length;_++){for(var x=!1,w=0;w<A.coordinates.length;w++)cu(c.coordinates[_],A.coordinates[w])&&(x=!0);if(!x)return!1}return!0}function Xl(c,A){for(var _=!1,x=0;x<c.coordinates.length;x++){if(!booleanPointOnLine(c.coordinates[x],A))return!1;_||(_=booleanPointOnLine(c.coordinates[x],A,{ignoreEndVertices:!0}))}return _}function Ua(c,A){for(var _=!0,x=!1,w=!1,P=0;P<c.coordinates.length;P++){if(w=booleanPointInPolygon(c.coordinates[1],A),!w){_=!1;break}x||(w=booleanPointInPolygon(c.coordinates[1],A,{ignoreBoundary:!0}))}return _&&w}function On(c,A){for(var _=0;_<c.coordinates.length;_++)if(!booleanPointOnLine(c.coordinates[_],A))return!1;return!0}function wl(c,A){var _=calcBbox(A),x=calcBbox(c);if(!is(_,x))return!1;for(var w=!1,P=0;P<c.coordinates.length-1;P++){if(!booleanPointInPolygon(c.coordinates[P],A))return!1;if(w||(w=booleanPointInPolygon(c.coordinates[P],A,{ignoreBoundary:!0})),!w){var N=Yl(c.coordinates[P],c.coordinates[P+1]);w=booleanPointInPolygon(N,A,{ignoreBoundary:!0})}}return w}function fc(c,A){var _=calcBbox(c),x=calcBbox(A);if(!is(x,_))return!1;for(var w=0;w<c.coordinates[0].length;w++)if(!booleanPointInPolygon(c.coordinates[0][w],A))return!1;return!0}function is(c,A){return!(c[0]>A[0]||c[2]<A[2]||c[1]>A[1]||c[3]<A[3])}function cu(c,A){return c[0]===A[0]&&c[1]===A[1]}function Yl(c,A){return[(c[0]+A[0])/2,(c[1]+A[1])/2]}var Fc=null;function nf(c,A,_){_===void 0&&(_={}),_.mask&&!_.units&&(_.units="kilometers");for(var x=[],w=c[0],P=c[1],N=c[2],V=c[3],W=A/distance([w,P],[N,P],_),k=W*(N-w),K=A/distance([w,P],[w,V],_),J=K*(V-P),se=N-w,de=V-P,gt=Math.floor(se/k),at=Math.floor(de/J),Zt=(se-gt*k)/2,mt=(de-at*J)/2,rt=w+Zt;rt<=N;){for(var lt=P+mt;lt<=V;){var Qt=point([rt,lt],_.properties);_.mask?within(Qt,_.mask)&&x.push(Qt):x.push(Qt),lt+=J}rt+=k}return featureCollection(x)}var m0=null;function Aa(c,A){A===void 0&&(A={});var _=A.precision,x=A.coordinates,w=A.mutate;if(_=_==null||isNaN(_)?6:_,x=x==null||isNaN(x)?3:x,!c)throw new Error("<geojson> is required");if(typeof _!="number")throw new Error("<precision> must be a number");if(typeof x!="number")throw new Error("<coordinates> must be a number");(w===!1||w===void 0)&&(c=JSON.parse(JSON.stringify(c)));var P=Math.pow(10,_);return coordEach(c,function(N){Pa(N,P,x)}),c}function Pa(c,A,_){c.length>_&&c.splice(_,c.length);for(var x=0;x<c.length;x++)c[x]=Math.round(c[x]*A)/A;return c}var ma=null;function Bc(c){if(!c)throw new Error("geojson is required");var A=[];return flattenEach(c,function(_){A.push(_)}),featureCollection(A)}var ao=null;function Qf(c,A,_){if(_=_||{},!isObject(_))throw new Error("options is invalid");var x=_.units,w=_.reverse;if(!c)throw new Error("geojson is required");if(A<=0)throw new Error("segmentLength must be greater than 0");var P=[];return flattenEach(c,function(N){w&&(N.geometry.coordinates=N.geometry.coordinates.reverse()),Ni(N,A,x,function(V){P.push(V)})}),featureCollection(P)}function Ni(c,A,_,x){var w=length(c,{units:_});if(w<=A)return x(c);var P=w/A;Number.isInteger(P)||(P=Math.floor(P)+1);for(var N=0;N<P;N++){var V=lineSliceAlong(c,A*N,A*(N+1),{units:_});x(V,N)}}var Yo=null;function Sa(c,A,_){if(c.geometry.type!=="Polygon")throw new Error("The input feature must be a Polygon");_===void 0&&(_=1);var x=c.geometry.coordinates,w=[],P={};if(_){for(var N=[],V=0;V<x.length;V++)for(var W=0;W<x[V].length-1;W++)N.push(Zt(V,W));var k=rbush();k.load(N)}for(var K=0;K<x.length;K++)for(var J=0;J<x[K].length-1;J++)if(_){var se=k.search(Zt(K,J));se.forEach(function(mt){var rt=mt.ring,lt=mt.edge;at(K,J,rt,lt)})}else for(var de=0;de<x.length;de++)for(var gt=0;gt<x[de].length-1;gt++)at(K,J,de,gt);return A||(w={type:"Feature",geometry:{type:"MultiPoint",coordinates:w}}),w;function at(mt,rt,lt,Qt){var Yt=x[mt][rt],or=x[mt][rt+1],nr=x[lt][Qt],dr=x[lt][Qt+1],Mt=Iu(Yt,or,nr,dr);if(Mt!==null){var vi,In;if(or[0]!==Yt[0]?vi=(Mt[0]-Yt[0])/(or[0]-Yt[0]):vi=(Mt[1]-Yt[1])/(or[1]-Yt[1]),dr[0]!==nr[0]?In=(Mt[0]-nr[0])/(dr[0]-nr[0]):In=(Mt[1]-nr[1])/(dr[1]-nr[1]),!(vi>=1||vi<=0||In>=1||In<=0)){var Fi=Mt,aa=!P[Fi];aa&&(P[Fi]=!0),A?w.push(A(Mt,mt,rt,Yt,or,vi,lt,Qt,nr,dr,In,aa)):w.push(Mt)}}}function Zt(mt,rt){var lt=x[mt][rt],Qt=x[mt][rt+1],Yt,or,nr,dr;return lt[0]<Qt[0]?(Yt=lt[0],or=Qt[0]):(Yt=Qt[0],or=lt[0]),lt[1]<Qt[1]?(nr=lt[1],dr=Qt[1]):(nr=Qt[1],dr=lt[1]),{minX:Yt,minY:nr,maxX:or,maxY:dr,ring:mt,edge:rt}}}function Iu(c,A,_,x){if(Ra(c,_)||Ra(c,x)||Ra(A,_)||Ra(x,_))return null;var w=c[0],P=c[1],N=A[0],V=A[1],W=_[0],k=_[1],K=x[0],J=x[1],se=(w-N)*(k-J)-(P-V)*(W-K);if(se===0)return null;var de=((w*V-P*N)*(W-K)-(w-N)*(W*J-k*K))/se,gt=((w*V-P*N)*(k-J)-(P-V)*(W*J-k*K))/se;return[de,gt]}function Ra(c,A){if(!c||!A||c.length!==A.length)return!1;for(var _=0,x=c.length;_<x;_++)if(c[_]instanceof Array&&A[_]instanceof Array){if(!Ra(c[_],A[_]))return!1}else if(c[_]!==A[_])return!1;return!0}function Bs(c){if(c.type!="Feature")throw new Error("The input must a geojson object of type Feature");if(c.geometry===void 0||c.geometry==null)throw new Error("The input must a geojson object with a non-empty geometry");if(c.geometry.type!="Polygon")throw new Error("The input must be a geojson Polygon");for(var A=c.geometry.coordinates.length,_=[],rt=0;rt<A;rt++){var x=c.geometry.coordinates[rt];Ou(x[0],x[x.length-1])||x.push(x[0]),_.push.apply(_,x.slice(0,x.length-1))}if(!ks(_))throw new Error("The input polygon may not have duplicate vertices (except for the first and last vertex of each ring)");var w=_.length,P=Sa(c,function(So,es,bc,Qc,ap,yh,op,uA,Lm,Xv,Yv,Fm){return[So,es,bc,Qc,ap,yh,op,uA,Lm,Xv,Yv,Fm]}),N=P.length;if(N==0){for(var nr=[],rt=0;rt<A;rt++)nr.push(polygon([c.geometry.coordinates[rt]],{parent:-1,winding:$s(c.geometry.coordinates[rt])}));var ha=featureCollection(nr);return el(),tu(),ha}for(var V=[],W=[],rt=0;rt<A;rt++){V.push([]);for(var k=0;k<c.geometry.coordinates[rt].length-1;k++)V[rt].push([new af(c.geometry.coordinates[rt][as(k+1,c.geometry.coordinates[rt].length-1)],1,[rt,k],[rt,as(k+1,c.geometry.coordinates[rt].length-1)],void 0)]),W.push(new Pu(c.geometry.coordinates[rt][k],[rt,as(k-1,c.geometry.coordinates[rt].length-1)],[rt,k],void 0,void 0,!1,!0))}for(var rt=0;rt<N;rt++)V[P[rt][1]][P[rt][2]].push(new af(P[rt][0],P[rt][5],[P[rt][1],P[rt][2]],[P[rt][6],P[rt][7]],void 0)),P[rt][11]&&W.push(new Pu(P[rt][0],[P[rt][1],P[rt][2]],[P[rt][6],P[rt][7]],void 0,void 0,!0,!0));for(var K=W.length,rt=0;rt<V.length;rt++)for(var k=0;k<V[rt].length;k++)V[rt][k].sort(function(es,bc){return es.param<bc.param?-1:1});for(var J=[],rt=0;rt<K;rt++)J.push({minX:W[rt].coord[0],minY:W[rt].coord[1],maxX:W[rt].coord[0],maxY:W[rt].coord[1],index:rt});var se=rbush();se.load(J);for(var rt=0;rt<V.length;rt++)for(var k=0;k<V[rt].length;k++)for(var de=0;de<V[rt][k].length;de++){var gt;de==V[rt][k].length-1?gt=V[rt][as(k+1,c.geometry.coordinates[rt].length-1)][0].coord:gt=V[rt][k][de+1].coord;var at=se.search({minX:gt[0],minY:gt[1],maxX:gt[0],maxY:gt[1]})[0];V[rt][k][de].nxtIsectAlongEdgeIn=at.index}for(var rt=0;rt<V.length;rt++)for(var k=0;k<V[rt].length;k++)for(var de=0;de<V[rt][k].length;de++){var gt=V[rt][k][de].coord,at=se.search({minX:gt[0],minY:gt[1],maxX:gt[0],maxY:gt[1]})[0],Zt=at.index;Zt<w?W[Zt].nxtIsectAlongRingAndEdge2=V[rt][k][de].nxtIsectAlongEdgeIn:Ou(W[Zt].ringAndEdge1,V[rt][k][de].ringAndEdgeIn)?W[Zt].nxtIsectAlongRingAndEdge1=V[rt][k][de].nxtIsectAlongEdgeIn:W[Zt].nxtIsectAlongRingAndEdge2=V[rt][k][de].nxtIsectAlongEdgeIn}for(var mt=[],rt=0,k=0;k<A;k++){for(var lt=rt,de=0;de<c.geometry.coordinates[k].length-1;de++)W[rt].coord[0]<W[lt].coord[0]&&(lt=rt),rt++;for(var Qt=W[lt].nxtIsectAlongRingAndEdge2,de=0;de<W.length;de++)if(W[de].nxtIsectAlongRingAndEdge1==lt||W[de].nxtIsectAlongRingAndEdge2==lt){var Yt=de;break}var or=Gi([W[Yt].coord,W[lt].coord,W[Qt].coord],!0)?1:-1;mt.push({isect:lt,parent:-1,winding:or})}mt.sort(function(co,So){return W[co.isect].coord>W[So.isect].coord?-1:1});for(var nr=[];mt.length>0;){var dr=mt.pop(),Mt=dr.isect,vi=dr.parent,In=dr.winding,Fi=nr.length,aa=[W[Mt].coord],un=Mt;if(W[Mt].ringAndEdge1Walkable)var Ai=W[Mt].ringAndEdge1,Gn=W[Mt].nxtIsectAlongRingAndEdge1;else var Ai=W[Mt].ringAndEdge2,Gn=W[Mt].nxtIsectAlongRingAndEdge2;for(;!Ou(W[Mt].coord,W[Gn].coord);){aa.push(W[Gn].coord);for(var za=void 0,rt=0;rt<mt.length;rt++)if(mt[rt].isect==Gn){za=rt;break}if(za!=null&&mt.splice(za,1),Ou(Ai,W[Gn].ringAndEdge1)){if(Ai=W[Gn].ringAndEdge2,W[Gn].ringAndEdge2Walkable=!1,W[Gn].ringAndEdge1Walkable){var La={isect:Gn};Gi([W[un].coord,W[Gn].coord,W[W[Gn].nxtIsectAlongRingAndEdge2].coord],In==1)?(La.parent=vi,La.winding=-In):(La.parent=Fi,La.winding=In),mt.push(La)}un=Gn,Gn=W[Gn].nxtIsectAlongRingAndEdge2}else{if(Ai=W[Gn].ringAndEdge1,W[Gn].ringAndEdge1Walkable=!1,W[Gn].ringAndEdge2Walkable){var La={isect:Gn};Gi([W[un].coord,W[Gn].coord,W[W[Gn].nxtIsectAlongRingAndEdge1].coord],In==1)?(La.parent=vi,La.winding=-In):(La.parent=Fi,La.winding=In),mt.push(La)}un=Gn,Gn=W[Gn].nxtIsectAlongRingAndEdge1}}aa.push(W[Gn].coord),nr.push(polygon([aa],{index:Fi,parent:vi,winding:In,netWinding:void 0}))}var ha=featureCollection(nr);el(),tu();function el(){for(var co=[],So=0;So<ha.features.length;So++)ha.features[So].properties.parent==-1&&co.push(So);if(co.length>1)for(var So=0;So<co.length;So++){for(var es=-1,bc=1/0,Qc=0;Qc<ha.features.length;Qc++)co[So]!=Qc&&booleanPointInPolygon(ha.features[co[So]].geometry.coordinates[0][0],ha.features[Qc],{ignoreBoundary:!0})&&area(ha.features[Qc])<bc&&(es=Qc);ha.features[co[So]].properties.parent=es}}function tu(){for(var co=0;co<ha.features.length;co++)if(ha.features[co].properties.parent==-1){var So=ha.features[co].properties.winding;ha.features[co].properties.netWinding=So,Tu(co,So)}}function Tu(co,So){for(var es=0;es<ha.features.length;es++)if(ha.features[es].properties.parent==co){var bc=So+ha.features[es].properties.winding;ha.features[es].properties.netWinding=bc,Tu(es,bc)}}return ha}var af=function(c,A,_,x,w){this.coord=c,this.param=A,this.ringAndEdgeIn=_,this.ringAndEdgeOut=x,this.nxtIsectAlongEdgeIn=w},Pu=function(c,A,_,x,w,P,N){this.coord=c,this.ringAndEdge1=A,this.ringAndEdge2=_,this.nxtIsectAlongRingAndEdge1=x,this.nxtIsectAlongRingAndEdge2=w,this.ringAndEdge1Walkable=P,this.ringAndEdge2Walkable=N};function Gi(c,A){if(typeof A=="undefined"&&(A=!0),c.length!=3)throw new Error("This function requires an array of three points [x,y]");var _=(c[1][0]-c[0][0])*(c[2][1]-c[0][1])-(c[1][1]-c[0][1])*(c[2][0]-c[0][0]);return _>=0==A}function $s(c){for(var A=0,_=0;_<c.length-1;_++)c[_][0]<c[A][0]&&(A=_);if(Gi([c[as(A-1,c.length-1)],c[A],c[as(A+1,c.length-1)]],!0))var x=1;else var x=-1;return x}function Ou(c,A){if(!c||!A||c.length!=A.length)return!1;for(var _=0,x=c.length;_<x;_++)if(c[_]instanceof Array&&A[_]instanceof Array){if(!Ou(c[_],A[_]))return!1}else if(c[_]!=A[_])return!1;return!0}function as(c,A){return(c%A+A)%A}function ks(c){for(var A={},_=1,x=0,w=c.length;x<w;++x){if(Object.prototype.hasOwnProperty.call(A,c[x])){_=0;break}A[c[x]]=1}return _}function Uo(c){var A=[];return flattenEach(c,function(_){_.geometry.type==="Polygon"&&featureEach(Bs(_),function(x){A.push(polygon(x.geometry.coordinates,_.properties))})}),featureCollection(A)}var Of=null,kc=Math.PI/180,Na=180/Math.PI,Mo=function(c,A){this.lon=c,this.lat=A,this.x=kc*c,this.y=kc*A};Mo.prototype.view=function(){return String(this.lon).slice(0,4)+","+String(this.lat).slice(0,4)},Mo.prototype.antipode=function(){var c=-1*this.lat,A=this.lon<0?180+this.lon:(180-this.lon)*-1;return new Mo(A,c)};var Qs=function(){this.coords=[],this.length=0};Qs.prototype.move_to=function(c){this.length++,this.coords.push(c)};var os=function(c){this.properties=c||{},this.geometries=[]};os.prototype.json=function(){if(this.geometries.length<=0)return{geometry:{type:"LineString",coordinates:null},type:"Feature",properties:this.properties};if(this.geometries.length===1)return{geometry:{type:"LineString",coordinates:this.geometries[0].coords},type:"Feature",properties:this.properties};for(var c=[],A=0;A<this.geometries.length;A++)c.push(this.geometries[A].coords);return{geometry:{type:"MultiLineString",coordinates:c},type:"Feature",properties:this.properties}},os.prototype.wkt=function(){for(var c="",A="LINESTRING(",_=function(P){A+=P[0]+" "+P[1]+","},x=0;x<this.geometries.length;x++){if(this.geometries[x].coords.length===0)return"LINESTRING(empty)";var w=this.geometries[x].coords;w.forEach(_),c+=A.substring(0,A.length-1)+")"}return c};var ms=function(c,A,_){if(!c||c.x===void 0||c.y===void 0)throw new Error("GreatCircle constructor expects two args: start and end objects with x and y properties");if(!A||A.x===void 0||A.y===void 0)throw new Error("GreatCircle constructor expects two args: start and end objects with x and y properties");this.start=new Mo(c.x,c.y),this.end=new Mo(A.x,A.y),this.properties=_||{};var x=this.start.x-this.end.x,w=this.start.y-this.end.y,P=Math.pow(Math.sin(w/2),2)+Math.cos(this.start.y)*Math.cos(this.end.y)*Math.pow(Math.sin(x/2),2);if(this.g=2*Math.asin(Math.sqrt(P)),this.g===Math.PI)throw new Error("it appears "+c.view()+" and "+A.view()+" are 'antipodal', e.g diametrically opposite, thus there is no single route but rather infinite");if(isNaN(this.g))throw new Error("could not calculate great circle between "+c+" and "+A)};ms.prototype.interpolate=function(c){var A=Math.sin((1-c)*this.g)/Math.sin(this.g),_=Math.sin(c*this.g)/Math.sin(this.g),x=A*Math.cos(this.start.y)*Math.cos(this.start.x)+_*Math.cos(this.end.y)*Math.cos(this.end.x),w=A*Math.cos(this.start.y)*Math.sin(this.start.x)+_*Math.cos(this.end.y)*Math.sin(this.end.x),P=A*Math.sin(this.start.y)+_*Math.sin(this.end.y),N=Na*Math.atan2(P,Math.sqrt(Math.pow(x,2)+Math.pow(w,2))),V=Na*Math.atan2(w,x);return[V,N]},ms.prototype.Arc=function(c,A){var _=[];if(!c||c<=2)_.push([this.start.lon,this.start.lat]),_.push([this.end.lon,this.end.lat]);else for(var x=1/(c-1),w=0;w<c;++w){var P=x*w,N=this.interpolate(P);_.push(N)}for(var V=!1,W=0,k=A&&A.offset?A.offset:10,K=180-k,J=-180+k,se=360-k,de=1;de<_.length;++de){var gt=_[de-1][0],at=_[de][0],Zt=Math.abs(at-gt);Zt>se&&(at>K&&gt<J||gt>K&&at<J)?V=!0:Zt>W&&(W=Zt)}var mt=[];if(V&&W<k){var rt=[];mt.push(rt);for(var lt=0;lt<_.length;++lt){var Qt=parseFloat(_[lt][0]);if(lt>0&&Math.abs(Qt-_[lt-1][0])>se){var Yt=parseFloat(_[lt-1][0]),or=parseFloat(_[lt-1][1]),nr=parseFloat(_[lt][0]),dr=parseFloat(_[lt][1]);if(Yt>-180&&Yt<J&&nr===180&&lt+1<_.length&&_[lt-1][0]>-180&&_[lt-1][0]<J){rt.push([-180,_[lt][1]]),lt++,rt.push([_[lt][0],_[lt][1]]);continue}else if(Yt>K&&Yt<180&&nr===-180&&lt+1<_.length&&_[lt-1][0]>K&&_[lt-1][0]<180){rt.push([180,_[lt][1]]),lt++,rt.push([_[lt][0],_[lt][1]]);continue}if(Yt<J&&nr>K){var Mt=Yt;Yt=nr,nr=Mt;var vi=or;or=dr,dr=vi}if(Yt>K&&nr<J&&(nr+=360),Yt<=180&&nr>=180&&Yt<nr){var In=(180-Yt)/(nr-Yt),Fi=In*dr+(1-In)*or;rt.push([_[lt-1][0]>K?180:-180,Fi]),rt=[],rt.push([_[lt-1][0]>K?-180:180,Fi]),mt.push(rt)}else rt=[],mt.push(rt);rt.push([Qt,_[lt][1]])}else rt.push([_[lt][0],_[lt][1]])}}else{var aa=[];mt.push(aa);for(var un=0;un<_.length;++un)aa.push([_[un][0],_[un][1]])}for(var Ai=new os(this.properties),Gn=0;Gn<mt.length;++Gn){var za=new Qs;Ai.geometries.push(za);for(var La=mt[Gn],ha=0;ha<La.length;++ha)za.move_to(La[ha])}return Ai};function Nu(c,A,_){if(_=_||{},typeof _!="object")throw new Error("options is invalid");var x=_.properties,w=_.npoints,P=_.offset;c=getCoord(c),A=getCoord(A),x=x||{},w=w||100,P=P||10;var N=new ms({x:c[0],y:c[1]},{x:A[0],y:A[1]},x),V=N.Arc(w,{offset:P});return V.json()}var yu=null;function Gr(c,A){if(!c)throw new Error("line is required");if(!A)throw new Error("splitter is required");var _=getType(c),x=getType(A);if(_!=="LineString")throw new Error("line must be LineString");if(x==="FeatureCollection")throw new Error("splitter cannot be a FeatureCollection");if(x==="GeometryCollection")throw new Error("splitter cannot be a GeometryCollection");var w=truncate(A,{precision:7});switch(x){case"Point":return of(c,w);case"MultiPoint":return fo(c,w);case"LineString":case"MultiLineString":case"Polygon":case"MultiPolygon":return fo(c,lineIntersect(c,w))}}function fo(c,A){var _=[],x=rbush();return flattenEach(A,function(w){if(_.forEach(function(V,W){V.id=W}),!_.length)_=of(c,w).features,_.forEach(function(V){V.bbox||(V.bbox=square(bbox(V)))}),x.load(featureCollection(_));else{var P=x.search(w);if(P.features.length){var N=hc(w,P);_=_.filter(function(V){return V.id!==N.id}),x.remove(N),featureEach(of(N,w),function(V){_.push(V),x.insert(V)})}}}),featureCollection(_)}function of(c,A){var _=[],x=getCoords(c)[0],w=getCoords(c)[c.geometry.coordinates.length-1];if(Zo(x,getCoord(A))||Zo(w,getCoord(A)))return featureCollection([c]);var P=rbush(),N=lineSegment(c);P.load(N);var V=P.search(A);if(!V.features.length)return featureCollection([c]);var W=hc(A,V),k=[x],K=featureReduce(N,function(J,se,de){var gt=getCoords(se)[1],at=getCoord(A);return de===W.id?(J.push(at),_.push(lineString(J)),Zo(at,gt)?[at]:[at,gt]):(J.push(gt),J)},k);return K.length>1&&_.push(lineString(K)),featureCollection(_)}function hc(c,A){if(!A.features.length)throw new Error("lines must contain features");if(A.features.length===1)return A.features[0];var _,x=1/0;return featureEach(A,function(w){var P=nearestPointOnLine(w,c),N=P.properties.dist;N<x&&(_=w,x=N)}),_}function Zo(c,A){return c[0]===A[0]&&c[1]===A[1]}var sl=null;function Zu(c,A,_,x,w){w===void 0&&(w={});var P=w.steps||64,N=$l(_),V=$l(x),W=!Array.isArray(c)&&c.type==="Feature"?c.properties:{};if(N===V)return lineString(circle(c,A,w).geometry.coordinates[0],W);for(var k=N,K=N<V?V:V+360,J=k,se=[],de=0;J<K;)se.push(destination(c,A,J,w).geometry.coordinates),de++,J=k+de*360/P;return J>K&&se.push(destination(c,A,K,w).geometry.coordinates),lineString(se,W)}function $l(c){var A=c%360;return A<0&&(A+=360),A}function Ps(c,A){A===void 0&&(A={});var _=getGeom(c);switch(!A.properties&&c.type==="Feature"&&(A.properties=c.properties),_.type){case"Polygon":return Du(_,A);case"MultiPolygon":return Il(_,A);default:throw new Error("invalid poly")}}function Du(c,A){A===void 0&&(A={});var _=getGeom(c),x=_.coordinates,w=A.properties?A.properties:c.type==="Feature"?c.properties:{};return Ac(x,w)}function Il(c,A){A===void 0&&(A={});var _=getGeom(c),x=_.coordinates,w=A.properties?A.properties:c.type==="Feature"?c.properties:{},P=[];return x.forEach(function(N){P.push(Ac(N,w))}),featureCollection(P)}function Ac(c,A){return c.length>1?multiLineString(c,A):lineString(c[0],A)}function Oh(c,A){A===void 0&&(A={});var _,x,w,P=A.properties,N=(_=A.autoComplete)!==null&&_!==void 0?_:!0,V=(x=A.orderCoords)!==null&&x!==void 0?x:!0,W=(w=A.mutate)!==null&&w!==void 0?w:!1;switch(W||(c=clone(c)),c.type){case"FeatureCollection":var k=[];return c.features.forEach(function(K){k.push(getCoords(_0(K,{},N,V)))}),multiPolygon(k,P);default:return _0(c,P,N,V)}}function _0(c,A,_,x){A=A||(c.type==="Feature"?c.properties:{});var w=getGeom(c),P=w.coordinates,N=w.type;if(!P.length)throw new Error("line must contain coordinates");switch(N){case"LineString":return _&&(P=ul(P)),polygon([P],A);case"MultiLineString":var V=[],W=0;return P.forEach(function(k){if(_&&(k=ul(k)),x){var K=zu(turfBBox(lineString(k)));K>W?(V.unshift(k),W=K):V.push(k)}else V.push(k)}),polygon(V,A);default:throw new Error("geometry type "+N+" is not supported")}}function ul(c){var A=c[0],_=A[0],x=A[1],w=c[c.length-1],P=w[0],N=w[1];return(_!==P||x!==N)&&c.push(A),c}function zu(c){var A=c[0],_=c[1],x=c[2],w=c[3];return Math.abs(A-x)*Math.abs(_-w)}var _s=null;function Ql(c,A){var _=getGeom(c),x=_.type,w=c.type==="Feature"?c.properties:{},P=_.coordinates;switch(x){case"LineString":case"MultiLineString":{var N=[];return x==="LineString"&&(P=[P]),P.forEach(function(V){lineclip(V,A,N)}),N.length===1?lineString(N[0],w):multiLineString(N,w)}case"Polygon":return polygon(zo(P,A),w);case"MultiPolygon":return multiPolygon(P.map(function(V){return zo(V,A)}),w);default:throw new Error("geometry "+x+" not supported")}}function zo(c,A){for(var _=[],x=0,w=c;x<w.length;x++){var P=w[x],N=polygonclip(P,A);N.length>0&&((N[0][0]!==N[N.length-1][0]||N[0][1]!==N[N.length-1][1])&&N.push(N[0]),N.length>=4&&_.push(N))}return _}var Gu=C(19545);function ll(c,A,_){if(_===void 0&&(_={}),_=_||{},!isObject(_))throw new Error("options is invalid");var x=_.tolerance||0,w=[],P=rbush(),N=lineSegment(c);P.load(N);var V;return segmentEach(A,function(W){var k=!1;W&&(featureEach(P.search(W),function(K){if(k===!1){var J=getCoords(W).sort(),se=getCoords(K).sort();equal(J,se)||(x===0?booleanPointOnLine(J[0],K)&&booleanPointOnLine(J[1],K):nearestPointOnLine(K,J[0]).properties.dist<=x&&nearestPointOnLine(K,J[1]).properties.dist<=x)?(k=!0,V?V=sf(V,W):V=W):(x===0?booleanPointOnLine(se[0],W)&&booleanPointOnLine(se[1],W):nearestPointOnLine(W,se[0]).properties.dist<=x&&nearestPointOnLine(W,se[1]).properties.dist<=x)&&(V?V=sf(V,K):V=K)}}),k===!1&&V&&(w.push(V),V=void 0))}),V&&w.push(V),featureCollection(w)}function sf(c,A){var _=getCoords(A),x=getCoords(c),w=x[0],P=x[x.length-1],N=c.geometry.coordinates;return equal(_[0],w)?N.unshift(_[1]):equal(_[0],P)?N.push(_[1]):equal(_[1],w)?N.unshift(_[0]):equal(_[1],P)&&N.push(_[0]),c}var pc=null;function Vu(c,A,_,x,w){if(w=w||{},!isObject(w))throw new Error("options is invalid");var P=w.properties;if(!c)throw new Error("center is required");if(_==null)throw new Error("bearing1 is required");if(x==null)throw new Error("bearing2 is required");if(!A)throw new Error("radius is required");if(typeof w!="object")throw new Error("options must be an object");if(Hu(_)===Hu(x))return circle(c,A,w);var N=getCoords(c),V=lineArc(c,A,_,x,w),W=[[N]];return coordEach(V,function(k){W[0].push(k)}),W[0].push(N),polygon(W,P)}function Hu(c){var A=c%360;return A<0&&(A+=360),A}var wo=null;function Wu(c,A,_){_===void 0&&(_={});var x;_.final?x=ss(getCoord(A),getCoord(c)):x=ss(getCoord(c),getCoord(A));var w=x>180?-(360-x):x;return w}function ss(c,A){var _=degreesToRadians(c[1]),x=degreesToRadians(A[1]),w=degreesToRadians(A[0]-c[0]);w>Math.PI&&(w-=2*Math.PI),w<-Math.PI&&(w+=2*Math.PI);var P=Math.log(Math.tan(x/2+Math.PI/4)/Math.tan(_/2+Math.PI/4)),N=Math.atan2(w,P);return(radiansToDegrees(N)+360)%360}var X0=null;function Pl(c,A,_,x){x===void 0&&(x={});var w=A<0,P=convertLength(Math.abs(A),x.units,"meters");w&&(P=-Math.abs(P));var N=getCoord(c),V=Uc(N,P,_);return V[0]+=V[0]-N[0]>180?-360:N[0]-V[0]>180?360:0,point(V,x.properties)}function Uc(c,A,_,x){x=x===void 0?earthRadius:Number(x);var w=A/x,P=c[0]*Math.PI/180,N=degreesToRadians(c[1]),V=degreesToRadians(_),W=w*Math.cos(V),k=N+W;Math.abs(k)>Math.PI/2&&(k=k>0?Math.PI-k:-Math.PI-k);var K=Math.log(Math.tan(k/2+Math.PI/4)/Math.tan(N/2+Math.PI/4)),J=Math.abs(K)>1e-11?W/K:Math.cos(N),se=w*Math.sin(V)/J,de=P+se;return[(de*180/Math.PI+540)%360-180,k*180/Math.PI]}var us=null;function ys(c,A){var _=getCoords(c),x=getCoords(A),w,P,N,V,W=calcBbox(A),k=0,K=null;_[0]>W[0]&&_[0]<W[2]&&_[1]>W[1]&&_[1]<W[3]&&(K=nearestPoint(c,explode(A)),k=K.properties.featureIndex);var J=getType(A);switch(J){case"Polygon":w=x[0][k],P=x[0][0],K!==null&&K.geometry.coordinates[1]<_[1]&&(P=x[0][k]),V=fu(x[0][0],x[0][x[0].length-1],_);var se=qs(x[0],_,V,N,w,P);w=se[0],P=se[1];break;case"MultiPolygon":for(var de=0,gt=0,at=0,Zt=0;Zt<x[0].length;Zt++){de=Zt;for(var mt=!1,rt=0;rt<x[0][Zt].length;rt++){if(gt=rt,at===k){mt=!0;break}at++}if(mt)break}w=x[0][de][gt],P=x[0][de][gt],V=fu(x[0][0][0],x[0][0][x[0][0].length-1],_),x.forEach(function(lt){var Qt=qs(lt[0],_,V,N,w,P);w=Qt[0],P=Qt[1]});break}return featureCollection([point(w),point(P)])}function qs(c,A,_,x,w,P){for(var N=0;N<c.length;N++){var V=c[N],W=c[N+1];N===c.length-1&&(W=c[0]),x=fu(V,W,A),_<=0&&x>0?Nf(A,V,w)||(w=V):_>0&&x<=0&&(Os(A,V,P)||(P=V)),_=x}return[w,P]}function Os(c,A,_){return fu(c,A,_)>0}function Nf(c,A,_){return fu(c,A,_)<0}function fu(c,A,_){return(A[0]-c[0])*(_[1]-c[1])-(_[0]-c[0])*(A[1]-c[1])}var ls=null;function Io(c){for(var A=getCoords(c),_=0,x=1,w,P;x<A.length;)w=P||A[0],P=A[x],_+=(P[0]-w[0])*(P[1]+w[1]),x++;return _>0}function uf(c,A){if(A=A||{},!isObject(A))throw new Error("options is invalid");var _=A.reverse||!1,x=A.mutate||!1;if(!c)throw new Error("<geojson> is required");if(typeof _!="boolean")throw new Error("<reverse> must be a boolean");if(typeof x!="boolean")throw new Error("<mutate> must be a boolean");x===!1&&(c=clone(c));var w=[];switch(c.type){case"GeometryCollection":return geomEach(c,function(P){po(P,_)}),c;case"FeatureCollection":return featureEach(c,function(P){featureEach(po(P,_),function(N){w.push(N)})}),featureCollection(w)}return po(c,_)}function po(c,A){var _=c.type==="Feature"?c.geometry.type:c.type;switch(_){case"GeometryCollection":return geomEach(c,function(x){po(x,A)}),c;case"LineString":return hr(getCoords(c),A),c;case"Polygon":return St(getCoords(c),A),c;case"MultiLineString":return getCoords(c).forEach(function(x){hr(x,A)}),c;case"MultiPolygon":return getCoords(c).forEach(function(x){St(x,A)}),c;case"Point":case"MultiPoint":return c}}function hr(c,A){booleanClockwise(c)===A&&c.reverse()}function St(c,A){booleanClockwise(c[0])!==A&&c[0].reverse();for(var _=1;_<c.length;_++)booleanClockwise(c[_])===A&&c[_].reverse()}var ve=null;function hu(c,A){if(A=A||{},!isObject(A))throw new Error("options is invalid");var _=A.zProperty||"elevation",x=A.flip,w=A.flags;collectionOf(c,"Point","input must contain Points");for(var P=it(c,x),N=[],V=0;V<P.length;V++){for(var W=P[V],k=[],K=0;K<W.length;K++){var J=W[K];J.properties[_]?k.push(J.properties[_]):k.push(0),w===!0&&(J.properties.matrixPosition=[V,K])}N.push(k)}return N}function it(c,A){var _={};featureEach(c,function(P){var N=getCoords(P)[1];_[N]||(_[N]=[]),_[N].push(P)});var x=Object.keys(_).map(function(P){var N=_[P],V=N.sort(function(W,k){return getCoords(W)[0]-getCoords(k)[0]});return V}),w=x.sort(function(P,N){return A?getCoords(P[0])[1]-getCoords(N[0])[1]:getCoords(N[0])[1]-getCoords(P[0])[1]});return w}var Eu={successCallback:null,verbose:!1,polygons:!1},Si={};function cl(c,A,_,x){x=x||{};for(var w=Object.keys(Eu),P=0;P<w.length;P++){var N=w[P],V=x[N];V=typeof V!="undefined"&&V!==null?V:Eu[N],Si[N]=V}Si.verbose&&console.log("MarchingSquaresJS-isoBands: computing isobands for ["+A+":"+(A+_)+"]");var W=zi(c,A,_),k;return Si.polygons?(Si.verbose&&console.log("MarchingSquaresJS-isoBands: returning single polygons for each grid cell"),k=y0(W)):(Si.verbose&&console.log("MarchingSquaresJS-isoBands: returning polygon paths for entire data grid"),k=ct(W)),typeof Si.successCallback=="function"&&Si.successCallback(k),k}var va=64,pa=16,Bi=4,Go=1,qi=[],ni=[],Pi=[],oa=[],Ii=[],xi=[],Un=[],ii=[],ki=[],fi=[],Vi=[],ra=[],Dn=[],Hi=[],yi=[],na=[],Wi=[],ua=[],la=[],Ti=[],Ui=[],Zi=[],ia=[],Vn=[];Un[85]=fi[85]=-1,ii[85]=Vi[85]=0,ki[85]=ra[85]=1,la[85]=Zi[85]=1,Ti[85]=ia[85]=0,Ui[85]=Vn[85]=1,qi[85]=oa[85]=0,ni[85]=Ii[85]=-1,Pi[85]=yi[85]=0,na[85]=Dn[85]=0,Wi[85]=Hi[85]=1,xi[85]=ua[85]=1,Zi[1]=Zi[169]=0,ia[1]=ia[169]=-1,Vn[1]=Vn[169]=0,Dn[1]=Dn[169]=-1,Hi[1]=Hi[169]=0,yi[1]=yi[169]=0,fi[4]=fi[166]=0,Vi[4]=Vi[166]=-1,ra[4]=ra[166]=1,na[4]=na[166]=1,Wi[4]=Wi[166]=0,ua[4]=ua[166]=0,Un[16]=Un[154]=0,ii[16]=ii[154]=1,ki[16]=ki[154]=1,oa[16]=oa[154]=1,Ii[16]=Ii[154]=0,xi[16]=xi[154]=1,la[64]=la[106]=0,Ti[64]=Ti[106]=1,Ui[64]=Ui[106]=0,qi[64]=qi[106]=-1,ni[64]=ni[106]=0,Pi[64]=Pi[106]=1,la[2]=la[168]=0,Ti[2]=Ti[168]=-1,Ui[2]=Ui[168]=1,Zi[2]=Zi[168]=0,ia[2]=ia[168]=-1,Vn[2]=Vn[168]=0,Dn[2]=Dn[168]=-1,Hi[2]=Hi[168]=0,yi[2]=yi[168]=0,na[2]=na[168]=-1,Wi[2]=Wi[168]=0,ua[2]=ua[168]=1,Un[8]=Un[162]=0,ii[8]=ii[162]=-1,ki[8]=ki[162]=0,fi[8]=fi[162]=0,Vi[8]=Vi[162]=-1,ra[8]=ra[162]=1,Dn[8]=Dn[162]=1,Hi[8]=Hi[162]=0,yi[8]=yi[162]=1,na[8]=na[162]=1,Wi[8]=Wi[162]=0,ua[8]=ua[162]=0,Un[32]=Un[138]=0,ii[32]=ii[138]=1,ki[32]=ki[138]=1,fi[32]=fi[138]=0,Vi[32]=Vi[138]=1,ra[32]=ra[138]=0,qi[32]=qi[138]=1,ni[32]=ni[138]=0,Pi[32]=Pi[138]=0,oa[32]=oa[138]=1,Ii[32]=Ii[138]=0,xi[32]=xi[138]=1,Zi[128]=Zi[42]=0,ia[128]=ia[42]=1,Vn[128]=Vn[42]=1,la[128]=la[42]=0,Ti[128]=Ti[42]=1,Ui[128]=Ui[42]=0,qi[128]=qi[42]=-1,ni[128]=ni[42]=0,Pi[128]=Pi[42]=1,oa[128]=oa[42]=-1,Ii[128]=Ii[42]=0,xi[128]=xi[42]=0,fi[5]=fi[165]=-1,Vi[5]=Vi[165]=0,ra[5]=ra[165]=0,Zi[5]=Zi[165]=1,ia[5]=ia[165]=0,Vn[5]=Vn[165]=0,na[20]=na[150]=0,Wi[20]=Wi[150]=1,ua[20]=ua[150]=1,oa[20]=oa[150]=0,Ii[20]=Ii[150]=-1,xi[20]=xi[150]=1,Un[80]=Un[90]=-1,ii[80]=ii[90]=0,ki[80]=ki[90]=1,la[80]=la[90]=1,Ti[80]=Ti[90]=0,Ui[80]=Ui[90]=1,Dn[65]=Dn[105]=0,Hi[65]=Hi[105]=1,yi[65]=yi[105]=0,qi[65]=qi[105]=0,ni[65]=ni[105]=-1,Pi[65]=Pi[105]=0,Un[160]=Un[10]=-1,ii[160]=ii[10]=0,ki[160]=ki[10]=1,fi[160]=fi[10]=-1,Vi[160]=Vi[10]=0,ra[160]=ra[10]=0,Zi[160]=Zi[10]=1,ia[160]=ia[10]=0,Vn[160]=Vn[10]=0,la[160]=la[10]=1,Ti[160]=Ti[10]=0,Ui[160]=Ui[10]=1,na[130]=na[40]=0,Wi[130]=Wi[40]=1,ua[130]=ua[40]=1,Dn[130]=Dn[40]=0,Hi[130]=Hi[40]=1,yi[130]=yi[40]=0,qi[130]=qi[40]=0,ni[130]=ni[40]=-1,Pi[130]=Pi[40]=0,oa[130]=oa[40]=0,Ii[130]=Ii[40]=-1,xi[130]=xi[40]=1,fi[37]=fi[133]=0,Vi[37]=Vi[133]=1,ra[37]=ra[133]=1,Zi[37]=Zi[133]=0,ia[37]=ia[133]=1,Vn[37]=Vn[133]=0,qi[37]=qi[133]=-1,ni[37]=ni[133]=0,Pi[37]=Pi[133]=0,oa[37]=oa[133]=1,Ii[37]=Ii[133]=0,xi[37]=xi[133]=0,na[148]=na[22]=-1,Wi[148]=Wi[22]=0,ua[148]=ua[22]=0,Zi[148]=Zi[22]=0,ia[148]=ia[22]=-1,Vn[148]=Vn[22]=1,la[148]=la[22]=0,Ti[148]=Ti[22]=1,Ui[148]=Ui[22]=1,oa[148]=oa[22]=-1,Ii[148]=Ii[22]=0,xi[148]=xi[22]=1,Un[82]=Un[88]=0,ii[82]=ii[88]=-1,ki[82]=ki[88]=1,na[82]=na[88]=1,Wi[82]=Wi[88]=0,ua[82]=ua[88]=1,Dn[82]=Dn[88]=-1,Hi[82]=Hi[88]=0,yi[82]=yi[88]=1,la[82]=la[88]=0,Ti[82]=Ti[88]=-1,Ui[82]=Ui[88]=0,Un[73]=Un[97]=0,ii[73]=ii[97]=1,ki[73]=ki[97]=0,fi[73]=fi[97]=0,Vi[73]=Vi[97]=-1,ra[73]=ra[97]=0,Dn[73]=Dn[97]=1,Hi[73]=Hi[97]=0,yi[73]=yi[97]=0,qi[73]=qi[97]=1,ni[73]=ni[97]=0,Pi[73]=Pi[97]=1,Un[145]=Un[25]=0,ii[145]=ii[25]=-1,ki[145]=ki[25]=0,Dn[145]=Dn[25]=1,Hi[145]=Hi[25]=0,yi[145]=yi[25]=1,Zi[145]=Zi[25]=0,ia[145]=ia[25]=1,Vn[145]=Vn[25]=1,oa[145]=oa[25]=-1,Ii[145]=Ii[25]=0,xi[145]=xi[25]=0,fi[70]=fi[100]=0,Vi[70]=Vi[100]=1,ra[70]=ra[100]=0,na[70]=na[100]=-1,Wi[70]=Wi[100]=0,ua[70]=ua[100]=1,la[70]=la[100]=0,Ti[70]=Ti[100]=-1,Ui[70]=Ui[100]=1,qi[70]=qi[100]=1,ni[70]=ni[100]=0,Pi[70]=Pi[100]=0,fi[101]=fi[69]=0,Vi[101]=Vi[69]=1,ra[101]=ra[69]=0,qi[101]=qi[69]=1,ni[101]=ni[69]=0,Pi[101]=Pi[69]=0,Zi[149]=Zi[21]=0,ia[149]=ia[21]=1,Vn[149]=Vn[21]=1,oa[149]=oa[21]=-1,Ii[149]=Ii[21]=0,xi[149]=xi[21]=0,na[86]=na[84]=-1,Wi[86]=Wi[84]=0,ua[86]=ua[84]=1,la[86]=la[84]=0,Ti[86]=Ti[84]=-1,Ui[86]=Ui[84]=1,Un[89]=Un[81]=0,ii[89]=ii[81]=-1,ki[89]=ki[81]=0,Dn[89]=Dn[81]=1,Hi[89]=Hi[81]=0,yi[89]=yi[81]=1,Un[96]=Un[74]=0,ii[96]=ii[74]=1,ki[96]=ki[74]=0,fi[96]=fi[74]=-1,Vi[96]=Vi[74]=0,ra[96]=ra[74]=1,la[96]=la[74]=1,Ti[96]=Ti[74]=0,Ui[96]=Ui[74]=0,qi[96]=qi[74]=1,ni[96]=ni[74]=0,Pi[96]=Pi[74]=1,Un[24]=Un[146]=0,ii[24]=ii[146]=-1,ki[24]=ki[146]=1,na[24]=na[146]=1,Wi[24]=Wi[146]=0,ua[24]=ua[146]=1,Dn[24]=Dn[146]=0,Hi[24]=Hi[146]=1,yi[24]=yi[146]=1,oa[24]=oa[146]=0,Ii[24]=Ii[146]=-1,xi[24]=xi[146]=0,fi[6]=fi[164]=-1,Vi[6]=Vi[164]=0,ra[6]=ra[164]=1,na[6]=na[164]=-1,Wi[6]=Wi[164]=0,ua[6]=ua[164]=0,Zi[6]=Zi[164]=0,ia[6]=ia[164]=-1,Vn[6]=Vn[164]=1,la[6]=la[164]=1,Ti[6]=Ti[164]=0,Ui[6]=Ui[164]=0,Dn[129]=Dn[41]=0,Hi[129]=Hi[41]=1,yi[129]=yi[41]=1,Zi[129]=Zi[41]=0,ia[129]=ia[41]=1,Vn[129]=Vn[41]=0,qi[129]=qi[41]=-1,ni[129]=ni[41]=0,Pi[129]=Pi[41]=0,oa[129]=oa[41]=0,Ii[129]=Ii[41]=-1,xi[129]=xi[41]=0,na[66]=na[104]=0,Wi[66]=Wi[104]=1,ua[66]=ua[104]=0,Dn[66]=Dn[104]=-1,Hi[66]=Hi[104]=0,yi[66]=yi[104]=1,la[66]=la[104]=0,Ti[66]=Ti[104]=-1,Ui[66]=Ui[104]=0,qi[66]=qi[104]=0,ni[66]=ni[104]=-1,Pi[66]=Pi[104]=1,Un[144]=Un[26]=-1,ii[144]=ii[26]=0,ki[144]=ki[26]=0,Zi[144]=Zi[26]=1,ia[144]=ia[26]=0,Vn[144]=Vn[26]=1,la[144]=la[26]=0,Ti[144]=Ti[26]=1,Ui[144]=Ui[26]=1,oa[144]=oa[26]=-1,Ii[144]=Ii[26]=0,xi[144]=xi[26]=1,fi[36]=fi[134]=0,Vi[36]=Vi[134]=1,ra[36]=ra[134]=1,na[36]=na[134]=0,Wi[36]=Wi[134]=1,ua[36]=ua[134]=0,qi[36]=qi[134]=0,ni[36]=ni[134]=-1,Pi[36]=Pi[134]=1,oa[36]=oa[134]=1,Ii[36]=Ii[134]=0,xi[36]=xi[134]=0,Un[9]=Un[161]=-1,ii[9]=ii[161]=0,ki[9]=ki[161]=0,fi[9]=fi[161]=0,Vi[9]=Vi[161]=-1,ra[9]=ra[161]=0,Dn[9]=Dn[161]=1,Hi[9]=Hi[161]=0,yi[9]=yi[161]=0,Zi[9]=Zi[161]=1,ia[9]=ia[161]=0,Vn[9]=Vn[161]=1,Un[136]=0,ii[136]=1,ki[136]=1,fi[136]=0,Vi[136]=1,ra[136]=0,na[136]=-1,Wi[136]=0,ua[136]=1,Dn[136]=-1,Hi[136]=0,yi[136]=0,Zi[136]=0,ia[136]=-1,Vn[136]=0,la[136]=0,Ti[136]=-1,Ui[136]=1,qi[136]=1,ni[136]=0,Pi[136]=0,oa[136]=1,Ii[136]=0,xi[136]=1,Un[34]=0,ii[34]=-1,ki[34]=0,fi[34]=0,Vi[34]=-1,ra[34]=1,na[34]=1,Wi[34]=0,ua[34]=0,Dn[34]=1,Hi[34]=0,yi[34]=1,Zi[34]=0,ia[34]=1,Vn[34]=1,la[34]=0,Ti[34]=1,Ui[34]=0,qi[34]=-1,ni[34]=0,Pi[34]=1,oa[34]=-1,Ii[34]=0,xi[34]=0,Un[35]=0,ii[35]=1,ki[35]=1,fi[35]=0,Vi[35]=-1,ra[35]=1,na[35]=1,Wi[35]=0,ua[35]=0,Dn[35]=-1,Hi[35]=0,yi[35]=0,Zi[35]=0,ia[35]=-1,Vn[35]=0,la[35]=0,Ti[35]=1,Ui[35]=0,qi[35]=-1,ni[35]=0,Pi[35]=1,oa[35]=1,Ii[35]=0,xi[35]=1,Un[153]=0,ii[153]=1,ki[153]=1,Dn[153]=-1,Hi[153]=0,yi[153]=0,Zi[153]=0,ia[153]=-1,Vn[153]=0,oa[153]=1,Ii[153]=0,xi[153]=1,fi[102]=0,Vi[102]=-1,ra[102]=1,na[102]=1,Wi[102]=0,ua[102]=0,la[102]=0,Ti[102]=1,Ui[102]=0,qi[102]=-1,ni[102]=0,Pi[102]=1,Un[155]=0,ii[155]=-1,ki[155]=0,Dn[155]=1,Hi[155]=0,yi[155]=1,Zi[155]=0,ia[155]=1,Vn[155]=1,oa[155]=-1,Ii[155]=0,xi[155]=0,fi[103]=0,Vi[103]=1,ra[103]=0,na[103]=-1,Wi[103]=0,ua[103]=1,la[103]=0,Ti[103]=-1,Ui[103]=1,qi[103]=1,ni[103]=0,Pi[103]=0,Un[152]=0,ii[152]=1,ki[152]=1,na[152]=-1,Wi[152]=0,ua[152]=1,Dn[152]=-1,Hi[152]=0,yi[152]=0,Zi[152]=0,ia[152]=-1,Vn[152]=0,la[152]=0,Ti[152]=-1,Ui[152]=1,oa[152]=1,Ii[152]=0,xi[152]=1,Un[156]=0,ii[156]=-1,ki[156]=1,na[156]=1,Wi[156]=0,ua[156]=1,Dn[156]=-1,Hi[156]=0,yi[156]=0,Zi[156]=0,ia[156]=-1,Vn[156]=0,la[156]=0,Ti[156]=1,Ui[156]=1,oa[156]=-1,Ii[156]=0,xi[156]=1,Un[137]=0,ii[137]=1,ki[137]=1,fi[137]=0,Vi[137]=1,ra[137]=0,Dn[137]=-1,Hi[137]=0,yi[137]=0,Zi[137]=0,ia[137]=-1,Vn[137]=0,qi[137]=1,ni[137]=0,Pi[137]=0,oa[137]=1,Ii[137]=0,xi[137]=1,Un[139]=0,ii[139]=1,ki[139]=1,fi[139]=0,Vi[139]=-1,ra[139]=0,Dn[139]=1,Hi[139]=0,yi[139]=0,Zi[139]=0,ia[139]=1,Vn[139]=0,qi[139]=-1,ni[139]=0,Pi[139]=0,oa[139]=1,Ii[139]=0,xi[139]=1,Un[98]=0,ii[98]=-1,ki[98]=0,fi[98]=0,Vi[98]=-1,ra[98]=1,na[98]=1,Wi[98]=0,ua[98]=0,Dn[98]=1,Hi[98]=0,yi[98]=1,la[98]=0,Ti[98]=1,Ui[98]=0,qi[98]=-1,ni[98]=0,Pi[98]=1,Un[99]=0,ii[99]=1,ki[99]=0,fi[99]=0,Vi[99]=-1,ra[99]=1,na[99]=1,Wi[99]=0,ua[99]=0,Dn[99]=-1,Hi[99]=0,yi[99]=1,la[99]=0,Ti[99]=-1,Ui[99]=0,qi[99]=1,ni[99]=0,Pi[99]=1,fi[38]=0,Vi[38]=-1,ra[38]=1,na[38]=1,Wi[38]=0,ua[38]=0,Zi[38]=0,ia[38]=1,Vn[38]=1,la[38]=0,Ti[38]=1,Ui[38]=0,qi[38]=-1,ni[38]=0,Pi[38]=1,oa[38]=-1,Ii[38]=0,xi[38]=0,fi[39]=0,Vi[39]=1,ra[39]=1,na[39]=-1,Wi[39]=0,ua[39]=0,Zi[39]=0,ia[39]=-1,Vn[39]=1,la[39]=0,Ti[39]=1,Ui[39]=0,qi[39]=-1,ni[39]=0,Pi[39]=1,oa[39]=1,Ii[39]=0,xi[39]=0;var ju=function(c){return[[c.bottomleft,0],[0,0],[0,c.leftbottom]]},ql=function(c){return[[1,c.rightbottom],[1,0],[c.bottomright,0]]},Us=function(c){return[[c.topright,1],[1,1],[1,c.righttop]]},Lu=function(c){return[[0,c.lefttop],[0,1],[c.topleft,1]]},Qn=function(c){return[[c.bottomright,0],[c.bottomleft,0],[0,c.leftbottom],[0,c.lefttop]]},cs=function(c){return[[c.bottomright,0],[c.bottomleft,0],[1,c.righttop],[1,c.rightbottom]]},Ol=function(c){return[[1,c.righttop],[1,c.rightbottom],[c.topleft,1],[c.topright,1]]},fl=function(c){return[[0,c.leftbottom],[0,c.lefttop],[c.topleft,1],[c.topright,1]]},Zs=function(c){return[[0,0],[0,c.leftbottom],[1,c.rightbottom],[1,0]]},Kl=function(c){return[[1,0],[c.bottomright,0],[c.topright,1],[1,1]]},zs=function(c){return[[1,1],[1,c.righttop],[0,c.lefttop],[0,1]]},$a=function(c){return[[c.bottomleft,0],[0,0],[0,1],[c.topleft,1]]},Jl=function(c){return[[1,c.righttop],[1,c.rightbottom],[0,c.leftbottom],[0,c.lefttop]]},Df=function(c){return[[c.topleft,1],[c.topright,1],[c.bottomright,0],[c.bottomleft,0]]},o=function(){return[[0,0],[0,1],[1,1],[1,0]]},u=function(c){return[[1,c.rightbottom],[1,0],[0,0],[0,1],[c.topleft,1]]},v=function(c){return[[c.topright,1],[1,1],[1,0],[0,0],[0,c.leftbottom]]},y=function(c){return[[1,0],[c.bottomright,0],[0,c.lefttop],[0,1],[1,1]]},b=function(c){return[[1,1],[1,c.righttop],[c.bottomleft,0],[0,0],[0,1]]},H=function(c){return[[1,c.righttop],[1,c.rightbottom],[0,c.lefttop],[0,1],[c.topleft,1]]},ne=function(c){return[[1,1],[1,c.righttop],[c.bottomright,0],[c.bottomleft,0],[c.topright,1]]},Le=function(c){return[[1,c.rightbottom],[1,0],[c.bottomright,0],[0,c.leftbottom],[0,c.lefttop]]},tt=function(c){return[[c.topright,1],[c.bottomleft,0],[0,0],[0,c.leftbottom],[c.topleft,1]]},Nt=function(c){return[[c.bottomright,0],[c.bottomleft,0],[0,c.lefttop],[0,1],[c.topleft,1]]},ar=function(c){return[[1,1],[1,c.righttop],[0,c.leftbottom],[0,c.lefttop],[c.topright,1]]},st=function(c){return[[1,c.rightbottom],[1,0],[c.bottomright,0],[c.topleft,1],[c.topright,1]]},Gt=function(c){return[[1,c.righttop],[1,c.rightbottom],[c.bottomleft,0],[0,0],[0,c.leftbottom]]},ir=function(c){return[[1,c.rightbottom],[1,0],[0,0],[0,c.leftbottom],[c.topleft,1],[c.topright,1]]},br=function(c){return[[1,1],[1,0],[c.bottomright,0],[0,c.leftbottom],[0,c.lefttop],[c.topright,1]]},g=function(c){return[[1,1],[1,c.righttop],[c.bottomright,0],[c.bottomleft,0],[0,c.lefttop],[0,1]]},Bn=function(c){return[[1,c.righttop],[1,c.rightbottom],[c.bottomleft,0],[0,0],[0,1],[c.topleft,1]]},Jn=function(c){return[[1,1],[1,c.righttop],[c.bottomleft,0],[0,0],[0,c.leftbottom],[c.topright,1]]},et=function(c){return[[1,c.rightbottom],[1,0],[c.bottomright,0],[0,c.lefttop],[0,1],[c.topleft,1]]},Za=function(c){return[[1,c.righttop],[1,c.rightbottom],[c.bottomright,0],[c.bottomleft,0],[0,c.leftbottom],[0,c.lefttop],[c.topleft,1],[c.topright,1]]},Eo=function(c){return[[1,1],[1,c.righttop],[c.bottomleft,0],[0,0],[0,c.leftbottom],[c.topright,1]]},oo=function(c){return[[1,c.rightbottom],[1,0],[c.bottomright,0],[0,c.lefttop],[0,1],[c.topleft,1]]},xa=function(c){return[[1,1],[1,c.righttop],[c.bottomright,0],[c.bottomleft,0],[0,c.leftbottom],[0,c.lefttop],[c.topright,1]]},vo=function(c){return[[1,c.righttop],[1,c.rightbottom],[c.bottomleft,0],[0,0],[0,c.leftbottom],[c.topleft,1],[c.topright,1]]},Es=function(c){return[[1,c.righttop],[1,c.rightbottom],[c.bottomright,0],[c.bottomleft,0],[0,c.lefttop],[0,1],[c.topleft,1]]},Ma=function(c){return[[1,c.rightbottom],[1,0],[c.bottomright,0],[0,c.leftbottom],[0,c.lefttop],[c.topleft,1],[c.topright,1]]},Yr=[],_n=[],ri=[],Hn=[],oi=[],Zn=[],Ki=[],Ci=[];Hn[1]=oi[1]=18,Hn[169]=oi[169]=18,ri[4]=_n[4]=12,ri[166]=_n[166]=12,Yr[16]=Ci[16]=4,Yr[154]=Ci[154]=4,Zn[64]=Ki[64]=22,Zn[106]=Ki[106]=22,ri[2]=Zn[2]=17,Hn[2]=oi[2]=18,ri[168]=Zn[168]=17,Hn[168]=oi[168]=18,Yr[8]=Hn[8]=9,_n[8]=ri[8]=12,Yr[162]=Hn[162]=9,_n[162]=ri[162]=12,Yr[32]=Ci[32]=4,_n[32]=Ki[32]=1,Yr[138]=Ci[138]=4,_n[138]=Ki[138]=1,oi[128]=Ci[128]=21,Zn[128]=Ki[128]=22,oi[42]=Ci[42]=21,Zn[42]=Ki[42]=22,_n[5]=oi[5]=14,_n[165]=oi[165]=14,ri[20]=Ci[20]=6,ri[150]=Ci[150]=6,Yr[80]=Zn[80]=11,Yr[90]=Zn[90]=11,Hn[65]=Ki[65]=3,Hn[105]=Ki[105]=3,Yr[160]=Zn[160]=11,_n[160]=oi[160]=14,Yr[10]=Zn[10]=11,_n[10]=oi[10]=14,ri[130]=Ci[130]=6,Hn[130]=Ki[130]=3,ri[40]=Ci[40]=6,Hn[40]=Ki[40]=3,_n[101]=Ki[101]=1,_n[69]=Ki[69]=1,oi[149]=Ci[149]=21,oi[21]=Ci[21]=21,ri[86]=Zn[86]=17,ri[84]=Zn[84]=17,Yr[89]=Hn[89]=9,Yr[81]=Hn[81]=9,Yr[96]=Ki[96]=0,_n[96]=Zn[96]=15,Yr[74]=Ki[74]=0,_n[74]=Zn[74]=15,Yr[24]=ri[24]=8,Hn[24]=Ci[24]=7,Yr[146]=ri[146]=8,Hn[146]=Ci[146]=7,_n[6]=Zn[6]=15,ri[6]=oi[6]=16,_n[164]=Zn[164]=15,ri[164]=oi[164]=16,Hn[129]=Ci[129]=7,oi[129]=Ki[129]=20,Hn[41]=Ci[41]=7,oi[41]=Ki[41]=20,ri[66]=Ki[66]=2,Hn[66]=Zn[66]=19,ri[104]=Ki[104]=2,Hn[104]=Zn[104]=19,Yr[144]=oi[144]=10,Zn[144]=Ci[144]=23,Yr[26]=oi[26]=10,Zn[26]=Ci[26]=23,_n[36]=Ci[36]=5,ri[36]=Ki[36]=2,_n[134]=Ci[134]=5,ri[134]=Ki[134]=2,Yr[9]=oi[9]=10,_n[9]=Hn[9]=13,Yr[161]=oi[161]=10,_n[161]=Hn[161]=13,_n[37]=Ci[37]=5,oi[37]=Ki[37]=20,_n[133]=Ci[133]=5,oi[133]=Ki[133]=20,ri[148]=oi[148]=16,Zn[148]=Ci[148]=23,ri[22]=oi[22]=16,Zn[22]=Ci[22]=23,Yr[82]=ri[82]=8,Hn[82]=Zn[82]=19,Yr[88]=ri[88]=8,Hn[88]=Zn[88]=19,Yr[73]=Ki[73]=0,_n[73]=Hn[73]=13,Yr[97]=Ki[97]=0,_n[97]=Hn[97]=13,Yr[145]=Hn[145]=9,oi[145]=Ci[145]=21,Yr[25]=Hn[25]=9,oi[25]=Ci[25]=21,_n[70]=Ki[70]=1,ri[70]=Zn[70]=17,_n[100]=Ki[100]=1,ri[100]=Zn[100]=17,Yr[34]=Hn[34]=9,_n[34]=ri[34]=12,oi[34]=Ci[34]=21,Zn[34]=Ki[34]=22,Yr[136]=Ci[136]=4,_n[136]=Ki[136]=1,ri[136]=Zn[136]=17,Hn[136]=oi[136]=18,Yr[35]=Ci[35]=4,_n[35]=ri[35]=12,Hn[35]=oi[35]=18,Zn[35]=Ki[35]=22,Yr[153]=Ci[153]=4,Hn[153]=oi[153]=18,_n[102]=ri[102]=12,Zn[102]=Ki[102]=22,Yr[155]=Hn[155]=9,oi[155]=Ci[155]=23,_n[103]=Ki[103]=1,ri[103]=Zn[103]=17,Yr[152]=Ci[152]=4,ri[152]=Zn[152]=17,Hn[152]=oi[152]=18,Yr[156]=ri[156]=8,Hn[156]=oi[156]=18,Zn[156]=Ci[156]=23,Yr[137]=Ci[137]=4,_n[137]=Ki[137]=1,Hn[137]=oi[137]=18,Yr[139]=Ci[139]=4,_n[139]=Hn[139]=13,oi[139]=Ki[139]=20,Yr[98]=Hn[98]=9,_n[98]=ri[98]=12,Zn[98]=Ki[98]=22,Yr[99]=Ki[99]=0,_n[99]=ri[99]=12,Hn[99]=Zn[99]=19,_n[38]=ri[38]=12,oi[38]=Ci[38]=21,Zn[38]=Ki[38]=22,_n[39]=Ci[39]=5,ri[39]=oi[39]=16,Zn[39]=Ki[39]=22;var gn=[];gn[1]=gn[169]=ju,gn[4]=gn[166]=ql,gn[16]=gn[154]=Us,gn[64]=gn[106]=Lu,gn[168]=gn[2]=Qn,gn[162]=gn[8]=cs,gn[138]=gn[32]=Ol,gn[42]=gn[128]=fl,gn[5]=gn[165]=Zs,gn[20]=gn[150]=Kl,gn[80]=gn[90]=zs,gn[65]=gn[105]=$a,gn[160]=gn[10]=Jl,gn[130]=gn[40]=Df,gn[85]=o,gn[101]=gn[69]=u,gn[149]=gn[21]=v,gn[86]=gn[84]=y,gn[89]=gn[81]=b,gn[96]=gn[74]=H,gn[24]=gn[146]=ne,gn[6]=gn[164]=Le,gn[129]=gn[41]=tt,gn[66]=gn[104]=Nt,gn[144]=gn[26]=ar,gn[36]=gn[134]=st,gn[9]=gn[161]=Gt,gn[37]=gn[133]=ir,gn[148]=gn[22]=br,gn[82]=gn[88]=g,gn[73]=gn[97]=Bn,gn[145]=gn[25]=Jn,gn[70]=gn[100]=et,gn[34]=function(c){return[fl(c),cs(c)]},gn[35]=Za,gn[136]=function(c){return[Ol(c),Qn(c)]},gn[153]=function(c){return[Us(c),ju(c)]},gn[102]=function(c){return[ql(c),Lu(c)]},gn[155]=Eo,gn[103]=oo,gn[152]=function(c){return[Us(c),Qn(c)]},gn[156]=xa,gn[137]=function(c){return[Ol(c),ju(c)]},gn[139]=vo,gn[98]=function(c){return[cs(c),Lu(c)]},gn[99]=Es,gn[38]=function(c){return[ql(c),fl(c)]},gn[39]=Ma;function je(c,A,_){return(c-A)/(_-A)}function Nl(c){return c.constructor.toString().indexOf("Array")>-1}function zi(c,A,_){for(var x=c.length-1,w=c[0].length-1,P={rows:x,cols:w,cells:[]},N=A+Math.abs(_),V=0;V<x;++V){P.cells[V]=[];for(var W=0;W<w;++W){var k=0,K=c[V+1][W],J=c[V+1][W+1],se=c[V][W+1],de=c[V][W];if(!(isNaN(K)||isNaN(J)||isNaN(se)||isNaN(de))){k|=K<A?0:K>N?128:64,k|=J<A?0:J>N?32:16,k|=se<A?0:se>N?8:4,k|=de<A?0:de>N?2:1;var gt=+k,at=0;if(k===17||k===18||k===33||k===34||k===38||k===68||k===72||k===98||k===102||k===132||k===136||k===137||k===152||k===153){var Zt=(K+J+se+de)/4;at=Zt>N?2:Zt<A?0:1,k===34?at===1?k=35:at===0&&(k=136):k===136?at===1?(k=35,at=4):at===0&&(k=34):k===17?at===1?(k=155,at=4):at===0&&(k=153):k===68?at===1?(k=103,at=4):at===0&&(k=102):k===153?at===1&&(k=155):k===102?at===1&&(k=103):k===152?at<2&&(k=156,at=1):k===137?at<2&&(k=139,at=1):k===98?at<2&&(k=99,at=1):k===38?at<2&&(k=39,at=1):k===18?at>0?(k=156,at=4):k=152:k===33?at>0?(k=139,at=4):k=137:k===72?at>0?(k=99,at=4):k=98:k===132&&(at>0?(k=39,at=4):k=38)}if(k!=0&&k!=170){var mt,rt,lt,Qt,Yt,or,nr,dr;mt=rt=lt=Qt=Yt=or=nr=dr=.5;var Mt=[];k===1?(lt=1-je(A,se,de),dr=1-je(A,K,de),Mt.push(Hn[k])):k===169?(lt=je(N,de,se),dr=je(N,de,K),Mt.push(Hn[k])):k===4?(or=1-je(A,J,se),Qt=je(A,de,se),Mt.push(_n[k])):k===166?(or=je(N,se,J),Qt=1-je(N,se,de),Mt.push(_n[k])):k===16?(Yt=je(A,se,J),rt=je(A,K,J),Mt.push(Yr[k])):k===154?(Yt=1-je(N,J,se),rt=1-je(N,J,K),Mt.push(Yr[k])):k===64?(nr=je(A,de,K),mt=1-je(A,J,K),Mt.push(Zn[k])):k===106?(nr=1-je(N,K,de),mt=je(N,K,J),Mt.push(Zn[k])):k===168?(Qt=je(N,de,se),lt=je(A,de,se),dr=je(A,de,K),nr=je(N,de,K),Mt.push(ri[k]),Mt.push(Hn[k])):k===2?(Qt=1-je(A,se,de),lt=1-je(N,se,de),dr=1-je(N,K,de),nr=1-je(A,K,de),Mt.push(ri[k]),Mt.push(Hn[k])):k===162?(Yt=je(N,se,J),or=je(A,se,J),Qt=1-je(A,se,de),lt=1-je(N,se,de),Mt.push(ri[k]),Mt.push(Hn[k])):k===8?(Yt=1-je(A,J,se),or=1-je(N,J,se),Qt=je(N,de,se),lt=je(A,de,se),Mt.push(Yr[k]),Mt.push(_n[k])):k===138?(Yt=1-je(A,J,se),or=1-je(N,J,se),mt=1-je(N,J,K),rt=1-je(A,J,K),Mt.push(Yr[k]),Mt.push(_n[k])):k===32?(Yt=je(N,se,J),or=je(A,se,J),mt=je(A,K,J),rt=je(N,K,J),Mt.push(Yr[k]),Mt.push(_n[k])):k===42?(dr=1-je(N,K,de),nr=1-je(A,K,de),mt=je(A,K,J),rt=je(N,K,J),Mt.push(oi[k]),Mt.push(Zn[k])):k===128&&(dr=je(A,de,K),nr=je(N,de,K),mt=1-je(N,J,K),rt=1-je(A,J,K),Mt.push(oi[k]),Mt.push(Zn[k])),k===5?(or=1-je(A,J,se),dr=1-je(A,K,de),Mt.push(_n[k])):k===165?(or=je(N,se,J),dr=je(N,de,K),Mt.push(_n[k])):k===20?(Qt=je(A,de,se),rt=je(A,K,J),Mt.push(ri[k])):k===150?(Qt=1-je(N,se,de),rt=1-je(N,J,K),Mt.push(ri[k])):k===80?(Yt=je(A,se,J),nr=je(A,de,K),Mt.push(Yr[k])):k===90?(Yt=1-je(N,J,se),nr=1-je(N,K,de),Mt.push(Yr[k])):k===65?(lt=1-je(A,se,de),mt=1-je(A,J,K),Mt.push(Hn[k])):k===105?(lt=je(N,de,se),mt=je(N,K,J),Mt.push(Hn[k])):k===160?(Yt=je(N,se,J),or=je(A,se,J),dr=je(A,de,K),nr=je(N,de,K),Mt.push(Yr[k]),Mt.push(_n[k])):k===10?(Yt=1-je(A,J,se),or=1-je(N,J,se),dr=1-je(N,K,de),nr=1-je(A,K,de),Mt.push(Yr[k]),Mt.push(_n[k])):k===130?(Qt=1-je(A,se,de),lt=1-je(N,se,de),mt=1-je(N,J,K),rt=1-je(A,J,K),Mt.push(ri[k]),Mt.push(Hn[k])):k===40?(Qt=je(N,de,se),lt=je(A,de,se),mt=je(A,K,J),rt=je(N,K,J),Mt.push(ri[k]),Mt.push(Hn[k])):k===101?(or=je(N,se,J),mt=je(N,K,J),Mt.push(_n[k])):k===69?(or=1-je(A,J,se),mt=1-je(A,J,K),Mt.push(_n[k])):k===149?(dr=je(N,de,K),rt=1-je(N,J,K),Mt.push(oi[k])):k===21?(dr=1-je(A,K,de),rt=je(A,K,J),Mt.push(oi[k])):k===86?(Qt=1-je(N,se,de),nr=1-je(N,K,de),Mt.push(ri[k])):k===84?(Qt=je(A,de,se),nr=je(A,de,K),Mt.push(ri[k])):k===89?(Yt=1-je(N,J,se),lt=je(N,de,se),Mt.push(Hn[k])):k===81?(Yt=je(A,se,J),lt=1-je(A,se,de),Mt.push(Hn[k])):k===96?(Yt=je(N,se,J),or=je(A,se,J),nr=je(A,de,K),mt=je(N,K,J),Mt.push(Yr[k]),Mt.push(_n[k])):k===74?(Yt=1-je(A,J,se),or=1-je(N,J,se),nr=1-je(N,K,de),mt=1-je(A,J,K),Mt.push(Yr[k]),Mt.push(_n[k])):k===24?(Yt=1-je(N,J,se),Qt=je(N,de,se),lt=je(A,de,se),rt=je(A,K,J),Mt.push(Yr[k]),Mt.push(Hn[k])):k===146?(Yt=je(A,se,J),Qt=1-je(A,se,de),lt=1-je(N,se,de),rt=1-je(N,J,K),Mt.push(Yr[k]),Mt.push(Hn[k])):k===6?(or=1-je(A,J,se),Qt=1-je(N,se,de),dr=1-je(N,K,de),nr=1-je(A,K,de),Mt.push(_n[k]),Mt.push(ri[k])):k===164?(or=je(N,se,J),Qt=je(A,de,se),dr=je(A,de,K),nr=je(N,de,K),Mt.push(_n[k]),Mt.push(ri[k])):k===129?(lt=1-je(A,se,de),dr=je(N,de,K),mt=1-je(N,J,K),rt=1-je(A,J,K),Mt.push(Hn[k]),Mt.push(oi[k])):k===41?(lt=je(N,de,se),dr=1-je(A,K,de),mt=je(A,K,J),rt=je(N,K,J),Mt.push(Hn[k]),Mt.push(oi[k])):k===66?(Qt=1-je(A,se,de),lt=1-je(N,se,de),nr=1-je(N,K,de),mt=1-je(A,J,K),Mt.push(ri[k]),Mt.push(Hn[k])):k===104?(Qt=je(N,de,se),lt=je(A,de,se),nr=je(A,de,K),mt=je(N,K,J),Mt.push(Hn[k]),Mt.push(Ki[k])):k===144?(Yt=je(A,se,J),dr=je(A,de,K),nr=je(N,de,K),rt=1-je(N,J,K),Mt.push(Yr[k]),Mt.push(Zn[k])):k===26?(Yt=1-je(N,J,se),dr=1-je(N,K,de),nr=1-je(A,K,de),rt=je(A,K,J),Mt.push(Yr[k]),Mt.push(Zn[k])):k===36?(or=je(N,se,J),Qt=je(A,de,se),mt=je(A,K,J),rt=je(N,K,J),Mt.push(_n[k]),Mt.push(ri[k])):k===134?(or=1-je(A,J,se),Qt=1-je(N,se,de),mt=1-je(N,J,K),rt=1-je(A,J,K),Mt.push(_n[k]),Mt.push(ri[k])):k===9?(Yt=1-je(A,J,se),or=1-je(N,J,se),lt=je(N,de,se),dr=1-je(A,K,de),Mt.push(Yr[k]),Mt.push(_n[k])):k===161?(Yt=je(N,se,J),or=je(A,se,J),lt=1-je(A,se,de),dr=je(N,de,K),Mt.push(Yr[k]),Mt.push(_n[k])):k===37?(or=je(N,se,J),dr=1-je(A,K,de),mt=je(A,K,J),rt=je(N,K,J),Mt.push(_n[k]),Mt.push(oi[k])):k===133?(or=1-je(A,J,se),dr=je(N,de,K),mt=1-je(N,J,K),rt=1-je(A,J,K),Mt.push(_n[k]),Mt.push(oi[k])):k===148?(Qt=je(A,de,se),dr=je(A,de,K),nr=je(N,de,K),rt=1-je(N,J,K),Mt.push(ri[k]),Mt.push(Zn[k])):k===22?(Qt=1-je(N,se,de),dr=1-je(N,K,de),nr=1-je(A,K,de),rt=je(A,K,J),Mt.push(ri[k]),Mt.push(Zn[k])):k===82?(Yt=je(A,se,J),Qt=1-je(A,se,de),lt=1-je(N,se,de),nr=1-je(N,K,de),Mt.push(Yr[k]),Mt.push(Hn[k])):k===88?(Yt=1-je(N,J,se),Qt=je(N,de,se),lt=je(A,de,se),nr=je(A,de,K),Mt.push(Yr[k]),Mt.push(Hn[k])):k===73?(Yt=1-je(A,J,se),or=1-je(N,J,se),lt=je(N,de,se),mt=1-je(A,J,K),Mt.push(Yr[k]),Mt.push(_n[k])):k===97?(Yt=je(N,se,J),or=je(A,se,J),lt=1-je(A,se,de),mt=je(N,K,J),Mt.push(Yr[k]),Mt.push(_n[k])):k===145?(Yt=je(A,se,J),lt=1-je(A,se,de),dr=je(N,de,K),rt=1-je(N,J,K),Mt.push(Yr[k]),Mt.push(oi[k])):k===25?(Yt=1-je(N,J,se),lt=je(N,de,se),dr=1-je(A,K,de),rt=je(A,K,J),Mt.push(Yr[k]),Mt.push(oi[k])):k===70?(or=1-je(A,J,se),Qt=1-je(N,se,de),nr=1-je(N,K,de),mt=1-je(A,J,K),Mt.push(_n[k]),Mt.push(ri[k])):k===100?(or=je(N,se,J),Qt=je(A,de,se),nr=je(A,de,K),mt=je(N,K,J),Mt.push(_n[k]),Mt.push(ri[k])):k===34?(at===0?(Yt=1-je(A,J,se),or=1-je(N,J,se),Qt=je(N,de,se),lt=je(A,de,se),dr=je(A,de,K),nr=je(N,de,K),mt=1-je(N,J,K),rt=1-je(A,J,K)):(Yt=je(N,se,J),or=je(A,se,J),Qt=1-je(A,se,de),lt=1-je(N,se,de),dr=1-je(N,K,de),nr=1-je(A,K,de),mt=je(A,K,J),rt=je(N,K,J)),Mt.push(Yr[k]),Mt.push(_n[k]),Mt.push(oi[k]),Mt.push(Zn[k])):k===35?(at===4?(Yt=1-je(A,J,se),or=1-je(N,J,se),Qt=je(N,de,se),lt=je(A,de,se),dr=je(A,de,K),nr=je(N,de,K),mt=1-je(N,J,K),rt=1-je(A,J,K)):(Yt=je(N,se,J),or=je(A,se,J),Qt=1-je(A,se,de),lt=1-je(N,se,de),dr=1-je(N,K,de),nr=1-je(A,K,de),mt=je(A,K,J),rt=je(N,K,J)),Mt.push(Yr[k]),Mt.push(_n[k]),Mt.push(Hn[k]),Mt.push(Zn[k])):k===136?(at===0?(Yt=je(N,se,J),or=je(A,se,J),Qt=1-je(A,se,de),lt=1-je(N,se,de),dr=1-je(N,K,de),nr=1-je(A,K,de),mt=je(A,K,J),rt=je(N,K,J)):(Yt=1-je(A,J,se),or=1-je(N,J,se),Qt=je(N,de,se),lt=je(A,de,se),dr=je(A,de,K),nr=je(N,de,K),mt=1-je(N,J,K),rt=1-je(A,J,K)),Mt.push(Yr[k]),Mt.push(_n[k]),Mt.push(oi[k]),Mt.push(Zn[k])):k===153?(at===0?(Yt=je(A,se,J),lt=1-je(A,se,de),dr=1-je(A,K,de),rt=je(A,K,J)):(Yt=1-je(N,J,se),lt=je(N,de,se),dr=je(N,de,K),rt=1-je(N,J,K)),Mt.push(Yr[k]),Mt.push(Hn[k])):k===102?(at===0?(or=1-je(A,J,se),Qt=je(A,de,se),nr=je(A,de,K),mt=1-je(A,J,K)):(or=je(N,se,J),Qt=1-je(N,se,de),nr=1-je(N,K,de),mt=je(N,K,J)),Mt.push(_n[k]),Mt.push(Zn[k])):k===155?(at===4?(Yt=je(A,se,J),lt=1-je(A,se,de),dr=1-je(A,K,de),rt=je(A,K,J)):(Yt=1-je(N,J,se),lt=je(N,de,se),dr=je(N,de,K),rt=1-je(N,J,K)),Mt.push(Yr[k]),Mt.push(oi[k])):k===103?(at===4?(or=1-je(A,J,se),Qt=je(A,de,se),nr=je(A,de,K),mt=1-je(A,J,K)):(or=je(N,se,J),Qt=1-je(N,se,de),nr=1-je(N,K,de),mt=je(N,K,J)),Mt.push(_n[k]),Mt.push(ri[k])):k===152?(at===0?(Yt=je(A,se,J),Qt=1-je(A,se,de),lt=1-je(N,se,de),dr=1-je(N,K,de),nr=1-je(A,K,de),rt=je(A,K,J)):(Yt=1-je(N,J,se),Qt=je(N,de,se),lt=je(A,de,se),dr=je(A,de,K),nr=je(N,de,K),rt=1-je(N,J,K)),Mt.push(Yr[k]),Mt.push(ri[k]),Mt.push(Hn[k])):k===156?(at===4?(Yt=je(A,se,J),Qt=1-je(A,se,de),lt=1-je(N,se,de),dr=1-je(N,K,de),nr=1-je(A,K,de),rt=je(A,K,J)):(Yt=1-je(N,J,se),Qt=je(N,de,se),lt=je(A,de,se),dr=je(A,de,K),nr=je(N,de,K),rt=1-je(N,J,K)),Mt.push(Yr[k]),Mt.push(Hn[k]),Mt.push(Zn[k])):k===137?(at===0?(Yt=je(N,se,J),or=je(A,se,J),lt=1-je(A,se,de),dr=1-je(A,K,de),mt=je(A,K,J),rt=je(N,K,J)):(Yt=1-je(A,J,se),or=1-je(N,J,se),lt=je(N,de,se),dr=je(N,de,K),mt=1-je(N,J,K),rt=1-je(A,J,K)),Mt.push(Yr[k]),Mt.push(_n[k]),Mt.push(Hn[k])):k===139?(at===4?(Yt=je(N,se,J),or=je(A,se,J),lt=1-je(A,se,de),dr=1-je(A,K,de),mt=je(A,K,J),rt=je(N,K,J)):(Yt=1-je(A,J,se),or=1-je(N,J,se),lt=je(N,de,se),dr=je(N,de,K),mt=1-je(N,J,K),rt=1-je(A,J,K)),Mt.push(Yr[k]),Mt.push(_n[k]),Mt.push(oi[k])):k===98?(at===0?(Yt=1-je(A,J,se),or=1-je(N,J,se),Qt=je(N,de,se),lt=je(A,de,se),nr=je(A,de,K),mt=1-je(A,J,K)):(Yt=je(N,se,J),or=je(A,se,J),Qt=1-je(A,se,de),lt=1-je(N,se,de),nr=1-je(N,K,de),mt=je(N,K,J)),Mt.push(Yr[k]),Mt.push(_n[k]),Mt.push(Zn[k])):k===99?(at===4?(Yt=1-je(A,J,se),or=1-je(N,J,se),Qt=je(N,de,se),lt=je(A,de,se),nr=je(A,de,K),mt=1-je(A,J,K)):(Yt=je(N,se,J),or=je(A,se,J),Qt=1-je(A,se,de),lt=1-je(N,se,de),nr=1-je(N,K,de),mt=je(N,K,J)),Mt.push(Yr[k]),Mt.push(_n[k]),Mt.push(Hn[k])):k===38?(at===0?(or=1-je(A,J,se),Qt=je(A,de,se),dr=je(A,de,K),nr=je(N,de,K),mt=1-je(N,J,K),rt=1-je(A,J,K)):(or=je(N,se,J),Qt=1-je(N,se,de),dr=1-je(N,K,de),nr=1-je(A,K,de),mt=je(A,K,J),rt=je(N,K,J)),Mt.push(_n[k]),Mt.push(oi[k]),Mt.push(Zn[k])):k===39?(at===4?(or=1-je(A,J,se),Qt=je(A,de,se),dr=je(A,de,K),nr=je(N,de,K),mt=1-je(N,J,K),rt=1-je(A,J,K)):(or=je(N,se,J),Qt=1-je(N,se,de),dr=1-je(N,K,de),nr=1-je(A,K,de),mt=je(A,K,J),rt=je(N,K,J)),Mt.push(_n[k]),Mt.push(ri[k]),Mt.push(Zn[k])):k===85&&(Yt=1,or=0,Qt=1,lt=0,dr=0,nr=1,mt=0,rt=1),(mt<0||mt>1||rt<0||rt>1||Yt<0||Yt>1||Qt<0||Qt>1||dr<0||dr>1||nr<0||nr>1)&&console.log("MarchingSquaresJS-isoBands: "+k+" "+gt+" "+K+","+J+","+se+","+de+" "+at+" "+mt+" "+rt+" "+Yt+" "+or+" "+Qt+" "+lt+" "+dr+" "+nr),P.cells[V][W]={cval:k,cval_real:gt,flipped:at,topleft:mt,topright:rt,righttop:Yt,rightbottom:or,bottomright:Qt,bottomleft:lt,leftbottom:dr,lefttop:nr,edges:Mt}}}}}return P}function ct(c){for(var A=[],_=c.rows,x=c.cols,w=[],P=0;P<_;P++)for(var N=0;N<x;N++)if(typeof c.cells[P][N]!="undefined"&&c.cells[P][N].edges.length>0){var V=c.cells[P][N],W=Nh(V),k=null,K=N,J=P;W!==null&&w.push([W.p[0]+K,W.p[1]+J]);do{if(k=cf(c.cells[J][K],W.x,W.y,W.o),k!==null)w.push([k.p[0]+K,k.p[1]+J]),K+=k.x,J+=k.y,W=k;else break;if(J<0||J>=_||K<0||K>=x||typeof c.cells[J][K]=="undefined"){K-=k.x,J-=k.y;var se=bi(c,K,J,k.x,k.y,k.o);if(se!==null)se.path.forEach(function(de){w.push(de)}),K=se.i,J=se.j,W=se;else break}}while(typeof c.cells[J][K]!="undefined"&&c.cells[J][K].edges.length>0);A.push(w),w=[],c.cells[P][N].edges.length>0&&N--}return A}function bi(c,A,_,x,w,P){for(var N=c.cells[_][A],V=N.cval_real,W=A+x,k=_+w,K=[],J=!1;!J;){if(typeof c.cells[k]=="undefined"||typeof c.cells[k][W]=="undefined")if(k-=w,W-=x,N=c.cells[k][W],V=N.cval_real,w===-1)if(P===0)if(V&Go)K.push([W,k]),x=-1,w=0,P=0;else if(V&Bi)K.push([W+1,k]),x=1,w=0,P=0;else{K.push([W+N.bottomright,k]),x=0,w=1,P=1,J=!0;break}else if(V&Go)K.push([W,k]),x=-1,w=0,P=0;else if(V&Bi){K.push([W+N.bottomright,k]),x=0,w=1,P=1,J=!0;break}else{K.push([W+N.bottomleft,k]),x=0,w=1,P=0,J=!0;break}else if(w===1)if(P===0)if(V&pa)K.push([W+1,k+1]),x=1,w=0,P=1;else if(V&va){K.push([W+N.topleft,k+1]),x=0,w=-1,P=0,J=!0;break}else{K.push([W+N.topright,k+1]),x=0,w=-1,P=1,J=!0;break}else V&pa?(K.push([W+1,k+1]),x=1,w=0,P=1):(K.push([W+1,k+1]),x=1,w=0,P=1);else if(x===-1)if(P===0)if(V&va)K.push([W,k+1]),x=0,w=1,P=0;else if(V&Go){K.push([W,k+N.leftbottom]),x=1,w=0,P=0,J=!0;break}else{K.push([W,k+N.lefttop]),x=1,w=0,P=1,J=!0;break}else if(V&va)K.push([W,k+1]),x=0,w=1,P=0;else{console.log("MarchingSquaresJS-isoBands: wtf");break}else if(x===1)if(P===0)if(V&Bi)K.push([W+1,k]),x=0,w=-1,P=1;else{K.push([W+1,k+N.rightbottom]),x=-1,w=0,P=0,J=!0;break}else if(V&Bi)K.push([W+1,k]),x=0,w=-1,P=1;else if(V&pa){K.push([W+1,k+N.righttop]),x=-1,w=0,P=1;break}else{K.push([W+1,k+N.rightbottom]),x=-1,w=0,P=0,J=!0;break}else{console.log("MarchingSquaresJS-isoBands: we came from nowhere!");break}else if(N=c.cells[k][W],V=N.cval_real,x===-1)if(P===0)if(typeof c.cells[k-1]!="undefined"&&typeof c.cells[k-1][W]!="undefined")x=0,w=-1,P=1;else if(V&Go)K.push([W,k]);else{K.push([W+N.bottomright,k]),x=0,w=1,P=1,J=!0;break}else if(V&va)console.log("MarchingSquaresJS-isoBands: proceeding in x-direction!");else{console.log("MarchingSquaresJS-isoBands: found entry from top at "+W+","+k);break}else if(x===1)if(P===0){console.log("MarchingSquaresJS-isoBands: wtf");break}else if(typeof c.cells[k+1]!="undefined"&&typeof c.cells[k+1][W]!="undefined")x=0,w=1,P=0;else if(V&pa)K.push([W+1,k+1]),x=1,w=0,P=1;else{K.push([W+N.topleft,k+1]),x=0,w=-1,P=0,J=!0;break}else if(w===-1)if(P===1)if(typeof c.cells[k][W+1]!="undefined")x=1,w=0,P=1;else if(V&Bi)K.push([W+1,k]),x=0,w=-1,P=1;else{K.push([W+1,k+N.righttop]),x=-1,w=0,P=1,J=!0;break}else{console.log("MarchingSquaresJS-isoBands: wtf");break}else if(w===1)if(P===0)if(typeof c.cells[k][W-1]!="undefined")x=-1,w=0,P=0;else if(V&va)K.push([W,k+1]),x=0,w=1,P=0;else{K.push([W,k+N.leftbottom]),x=1,w=0,P=0,J=!0;break}else{console.log("MarchingSquaresJS-isoBands: wtf");break}else{console.log("MarchingSquaresJS-isoBands: where did we came from???");break}if(W+=x,k+=w,W===A&&k===_)break}return{path:K,i:W,j:k,x,y:w,o:P}}function lf(c,A){delete c.edges[A];for(var _=A+1;_<c.edges.length;_++)c.edges[_-1]=c.edges[_];c.edges.pop()}function Nh(c){if(c.edges.length>0){var A=c.edges[c.edges.length-1],_=c.cval_real;switch(A){case 0:return _&pa?{p:[1,c.righttop],x:-1,y:0,o:1}:{p:[c.topleft,1],x:0,y:-1,o:0};case 1:return _&Bi?{p:[c.topleft,1],x:0,y:-1,o:0}:{p:[1,c.rightbottom],x:-1,y:0,o:0};case 2:return _&Bi?{p:[c.bottomright,0],x:0,y:1,o:1}:{p:[c.topleft,1],x:0,y:-1,o:0};case 3:return _&Go?{p:[c.topleft,1],x:0,y:-1,o:0}:{p:[c.bottomleft,0],x:0,y:1,o:0};case 4:return _&pa?{p:[1,c.righttop],x:-1,y:0,o:1}:{p:[c.topright,1],x:0,y:-1,o:1};case 5:return _&Bi?{p:[c.topright,1],x:0,y:-1,o:1}:{p:[1,c.rightbottom],x:-1,y:0,o:0};case 6:return _&Bi?{p:[c.bottomright,0],x:0,y:1,o:1}:{p:[c.topright,1],x:0,y:-1,o:1};case 7:return _&Go?{p:[c.topright,1],x:0,y:-1,o:1}:{p:[c.bottomleft,0],x:0,y:1,o:0};case 8:return _&Bi?{p:[c.bottomright,0],x:0,y:1,o:1}:{p:[1,c.righttop],x:-1,y:0,o:1};case 9:return _&Go?{p:[1,c.righttop],x:-1,y:0,o:1}:{p:[c.bottomleft,0],x:0,y:1,o:0};case 10:return _&Go?{p:[0,c.leftbottom],x:1,y:0,o:0}:{p:[1,c.righttop],x:-1,y:0,o:1};case 11:return _&va?{p:[1,c.righttop],x:-1,y:0,o:1}:{p:[0,c.lefttop],x:1,y:0,o:1};case 12:return _&Bi?{p:[c.bottomright,0],x:0,y:1,o:1}:{p:[1,c.rightbottom],x:-1,y:0,o:0};case 13:return _&Go?{p:[1,c.rightbottom],x:-1,y:0,o:0}:{p:[c.bottomleft,0],x:0,y:1,o:0};case 14:return _&Go?{p:[0,c.leftbottom],x:1,y:0,o:0}:{p:[1,c.rightbottom],x:-1,y:0,o:0};case 15:return _&va?{p:[1,c.rightbottom],x:-1,y:0,o:0}:{p:[0,c.lefttop],x:1,y:0,o:1};case 16:return _&Bi?{p:[c.bottomright,0],x:0,y:1,o:1}:{p:[0,c.leftbottom],x:1,y:0,o:0};case 17:return _&va?{p:[c.bottomright,0],x:0,y:1,o:1}:{p:[0,c.lefttop],x:1,y:0,o:1};case 18:return _&Go?{p:[0,c.leftbottom],x:1,y:0,o:0}:{p:[c.bottomleft,0],x:0,y:1,o:0};case 19:return _&va?{p:[c.bottomleft,0],x:0,y:1,o:0}:{p:[0,c.lefttop],x:1,y:0,o:1};case 20:return _&va?{p:[c.topleft,1],x:0,y:-1,o:0}:{p:[0,c.leftbottom],x:1,y:0,o:0};case 21:return _&pa?{p:[0,c.leftbottom],x:1,y:0,o:0}:{p:[c.topright,1],x:0,y:-1,o:1};case 22:return _&va?{p:[c.topleft,1],x:0,y:-1,o:0}:{p:[0,c.lefttop],x:1,y:0,o:1};case 23:return _&pa?{p:[0,c.lefttop],x:1,y:0,o:1}:{p:[c.topright,1],x:0,y:-1,o:1};default:console.log("MarchingSquaresJS-isoBands: edge index out of range!"),console.log(c);break}}return null}function cf(c,A,_,x){var w,P,N,V,W=c.cval,k;switch(A){case-1:switch(x){case 0:w=_n[W],N=fi[W],V=Vi[W],k=ra[W];break;default:w=Yr[W],N=Un[W],V=ii[W],k=ki[W];break}break;case 1:switch(x){case 0:w=oi[W],N=Zi[W],V=ia[W],k=Vn[W];break;default:w=Zn[W],N=la[W],V=Ti[W],k=Ui[W];break}break;default:switch(_){case-1:switch(x){case 0:w=Ki[W],N=qi[W],V=ni[W],k=Pi[W];break;default:w=Ci[W],N=oa[W],V=Ii[W],k=xi[W];break}break;case 1:switch(x){case 0:w=Hn[W],N=Dn[W],V=Hi[W],k=yi[W];break;default:w=ri[W],N=na[W],V=Wi[W],k=ua[W];break}break}break}if(P=c.edges.indexOf(w),typeof c.edges[P]!="undefined")lf(c,P);else return null;switch(W=c.cval_real,w){case 0:W&pa?(A=c.topleft,_=1):(A=1,_=c.righttop);break;case 1:W&Bi?(A=1,_=c.rightbottom):(A=c.topleft,_=1);break;case 2:W&Bi?(A=c.topleft,_=1):(A=c.bottomright,_=0);break;case 3:W&Go?(A=c.bottomleft,_=0):(A=c.topleft,_=1);break;case 4:W&pa?(A=c.topright,_=1):(A=1,_=c.righttop);break;case 5:W&Bi?(A=1,_=c.rightbottom):(A=c.topright,_=1);break;case 6:W&Bi?(A=c.topright,_=1):(A=c.bottomright,_=0);break;case 7:W&Go?(A=c.bottomleft,_=0):(A=c.topright,_=1);break;case 8:W&Bi?(A=1,_=c.righttop):(A=c.bottomright,_=0);break;case 9:W&Go?(A=c.bottomleft,_=0):(A=1,_=c.righttop);break;case 10:W&Go?(A=1,_=c.righttop):(A=0,_=c.leftbottom);break;case 11:W&va?(A=0,_=c.lefttop):(A=1,_=c.righttop);break;case 12:W&Bi?(A=1,_=c.rightbottom):(A=c.bottomright,_=0);break;case 13:W&Go?(A=c.bottomleft,_=0):(A=1,_=c.rightbottom);break;case 14:W&Go?(A=1,_=c.rightbottom):(A=0,_=c.leftbottom);break;case 15:W&va?(A=0,_=c.lefttop):(A=1,_=c.rightbottom);break;case 16:W&Bi?(A=0,_=c.leftbottom):(A=c.bottomright,_=0);break;case 17:W&va?(A=0,_=c.lefttop):(A=c.bottomright,_=0);break;case 18:W&Go?(A=c.bottomleft,_=0):(A=0,_=c.leftbottom);break;case 19:W&va?(A=0,_=c.lefttop):(A=c.bottomleft,_=0);break;case 20:W&va?(A=0,_=c.leftbottom):(A=c.topleft,_=1);break;case 21:W&pa?(A=c.topright,_=1):(A=0,_=c.leftbottom);break;case 22:W&va?(A=0,_=c.lefttop):(A=c.topleft,_=1);break;case 23:W&pa?(A=c.topright,_=1):(A=0,_=c.lefttop);break;default:return console.log("MarchingSquaresJS-isoBands: edge index out of range!"),console.log(c),null}return(typeof A=="undefined"||typeof _=="undefined"||typeof N=="undefined"||typeof V=="undefined"||typeof k=="undefined")&&(console.log("MarchingSquaresJS-isoBands: undefined value!"),console.log(c),console.log(A+" "+_+" "+N+" "+V+" "+k)),{p:[A,_],x:N,y:V,o:k}}function y0(c){var A=[],_=0;return c.cells.forEach(function(x,w){x.forEach(function(P,N){if(typeof P!="undefined"){var V=gn[P.cval](P);typeof V=="object"&&Nl(V)?typeof V[0]=="object"&&Nl(V[0])?typeof V[0][0]=="object"&&Nl(V[0][0])?V.forEach(function(W){W.forEach(function(k){k[0]+=N,k[1]+=w}),A[_++]=W}):(V.forEach(function(W){W[0]+=N,W[1]+=w}),A[_++]=V):console.log("MarchingSquaresJS-isoBands: bandcell polygon with malformed coordinates"):console.log("MarchingSquaresJS-isoBands: bandcell polygon with null coordinates")}})}),A}function Dh(c,A,_){if(_=_||{},!isObject(_))throw new Error("options is invalid");var x=_.zProperty||"elevation",w=_.commonProperties||{},P=_.breaksProperties||[];if(collectionOf(c,"Point","Input must contain Points"),!A)throw new Error("breaks is required");if(!Array.isArray(A))throw new Error("breaks is not an Array");if(!isObject(w))throw new Error("commonProperties is not an Object");if(!Array.isArray(P))throw new Error("breaksProperties is not an Array");var N=hu(c,{zProperty:x,flip:!0}),V=nt(N,A,x);V=Lf(V,N,c);var W=V.map(function(k,K){if(P[K]&&!isObject(P[K]))throw new Error("Each mappedProperty is required to be an Object");var J=objectAssign({},w,P[K]);J[x]=k[x];var se=multiPolygon(k.groupedRings,J);return se});return featureCollection(W)}function nt(c,A,_){for(var x=[],w=1;w<A.length;w++){var P=+A[w-1],N=+A[w],V=cl(c,P,N-P),W=E0(V),k=Y0(W),K={};K.groupedRings=k,K[_]=P+"-"+N,x.push(K)}return x}function Lf(c,A,_){var x=bbox(_),w=x[2]-x[0],P=x[3]-x[1],N=x[0],V=x[1],W=A[0].length-1,k=A.length-1,K=w/W,J=P/k,se=function(de){de[0]=de[0]*K+N,de[1]=de[1]*J+V};return c.forEach(function(de){de.groupedRings.forEach(function(gt){gt.forEach(function(at){at.forEach(se)})})}),c}function E0(c){var A=[],_=[];c.forEach(function(w){var P=area(polygon([w]));_.push(P),A.push({ring:w,area:P})}),_.sort(function(w,P){return P-w});var x=[];return _.forEach(function(w){for(var P=0;P<A.length;P++)if(A[P].area===w){x.push(A[P].ring),A.splice(P,1);break}}),x}function Y0(c){for(var A=c.map(function(W){return{lrCoordinates:W,grouped:!1}}),_=[];!S0(A);)for(var x=0;x<A.length;x++)if(!A[x].grouped){var w=[];w.push(A[x].lrCoordinates),A[x].grouped=!0;for(var P=polygon([A[x].lrCoordinates]),N=x+1;N<A.length;N++)if(!A[N].grouped){var V=polygon([A[N].lrCoordinates]);$0(V,P)&&(w.push(A[N].lrCoordinates),A[N].grouped=!0)}_.push(w)}return _}function $0(c,A){for(var _=explode(c),x=0;x<_.features.length;x++)if(!booleanPointInPolygon(_.features[x],A))return!1;return!0}function S0(c){for(var A=0;A<c.length;A++)if(c[A].grouped===!1)return!1;return!0}var Q0=null;function Ff(c,A,_){if(_=_||{},!isObject(_))throw new Error("options is invalid");var x=_.pivot,w=_.mutate;if(!c)throw new Error("geojson is required");if(A==null||isNaN(A))throw new Error("angle is required");return A===0||(x||(x=centroid(c)),(w===!1||w===void 0)&&(c=clone(c)),coordEach(c,function(P){var N=rhumbBearing(x,P),V=N+A,W=rhumbDistance(x,P),k=getCoords(rhumbDestination(x,W,V));P[0]=k[0],P[1]=k[1]})),c}var q0=null;function K0(c,A,_){if(_=_||{},!isObject(_))throw new Error("options is invalid");var x=_.origin,w=_.mutate;if(!c)throw new Error("geojson required");if(typeof A!="number"||A===0)throw new Error("invalid factor");var P=Array.isArray(x)||typeof x=="object";return w!==!0&&(c=clone(c)),c.type==="FeatureCollection"&&!P?(featureEach(c,function(N,V){c.features[V]=hl(N,A,x)}),c):hl(c,A,x)}function hl(c,A,_){var x=getType(c)==="Point";return _=Ss(c,_),A===1||x||coordEach(c,function(w){var P=rhumbDistance(_,w),N=rhumbBearing(_,w),V=P*A,W=getCoords(rhumbDestination(_,V,N));w[0]=W[0],w[1]=W[1],w.length===3&&(w[2]*=A)}),c}function Ss(c,A){if(A==null&&(A="centroid"),Array.isArray(A)||typeof A=="object")return getCoord(A);var _=c.bbox?c.bbox:turfBBox(c),x=_[0],w=_[1],P=_[2],N=_[3];switch(A){case"sw":case"southwest":case"westsouth":case"bottomleft":return point([x,w]);case"se":case"southeast":case"eastsouth":case"bottomright":return point([P,w]);case"nw":case"northwest":case"westnorth":case"topleft":return point([x,N]);case"ne":case"northeast":case"eastnorth":case"topright":return point([P,N]);case"center":return center(c);case void 0:case null:case"centroid":return centroid(c);default:throw new Error("invalid origin")}}var J0=null;function Lh(c,A,_,x){if(x=x||{},!isObject(x))throw new Error("options is invalid");var w=x.units,P=x.zTranslation,N=x.mutate;if(!c)throw new Error("geojson is required");if(A==null||isNaN(A))throw new Error("distance is required");if(P&&typeof P!="number"&&isNaN(P))throw new Error("zTranslation is not a number");if(P=P!==void 0?P:0,A===0&&P===0)return c;if(_==null||isNaN(_))throw new Error("direction is required");return A<0&&(A=-A,_=_+180),(N===!1||N===void 0)&&(c=clone(c)),coordEach(c,function(V){var W=getCoords(rhumbDestination(V,A,_,{units:w}));V[0]=W[0],V[1]=W[1],P&&V.length===3&&(V[2]+=P)}),c}var x0=null;function dc(c){var A=c[0],_=c[1];return[_[0]-A[0],_[1]-A[1]]}function Zc(c,A){return c[0]*A[1]-A[0]*c[1]}function Bf(c,A){return[c[0]+A[0],c[1]+A[1]]}function eh(c,A){return[c[0]-A[0],c[1]-A[1]]}function _a(c,A){return[c*A[0],c*A[1]]}function Ja(c,A){var _=c[0],x=dc(c),w=A[0],P=dc(A),N=Zc(x,P),V=eh(w,_),W=Zc(V,P),k=W/N,K=Bf(_,_a(k,x));return K}function xs(c,A){var _=dc(c),x=dc(A);return Zc(_,x)===0}function qf(c,A){return xs(c,A)?!1:Ja(c,A)}function xA(c,A,_){if(_=_||{},!isObject(_))throw new Error("options is invalid");var x=_.units;if(!c)throw new Error("geojson is required");if(A==null||isNaN(A))throw new Error("distance is required");var w=getType(c),P=c.properties;switch(w){case"LineString":return T0(c,A,x);case"MultiLineString":var N=[];return flattenEach(c,function(V){N.push(T0(V,A,x).geometry.coordinates)}),multiLineString(N,P);default:throw new Error("geometry "+w+" is not supported")}}function T0(c,A,_){var x=[],w=lengthToDegrees(A,_),P=getCoords(c),N=[];return P.forEach(function(V,W){if(W!==P.length-1){var k=C0(V,P[W+1],w);if(x.push(k),W>0){var K=x[W-1],J=qf(k,K);J!==!1&&(K[1]=J,k[0]=J),N.push(K[0]),W===P.length-2&&(N.push(k[0]),N.push(k[1]))}P.length===2&&(N.push(k[0]),N.push(k[1]))}}),lineString(N,c.properties)}function C0(c,A,_){var x=Math.sqrt((c[0]-A[0])*(c[0]-A[0])+(c[1]-A[1])*(c[1]-A[1])),w=c[0]+_*(A[1]-c[1])/x,P=A[0]+_*(A[1]-c[1])/x,N=c[1]+_*(c[0]-A[0])/x,V=A[1]+_*(c[0]-A[0])/x;return[[w,N],[P,V]]}var b0=null;function ji(c){return(c>0)-(c<0)||+c}function R0(c,A,_){var x=A[0]-c[0],w=A[1]-c[1],P=_[0]-A[0],N=_[1]-A[1];return ji(x*N-P*w)}function ec(c,A){var _=c.geometry.coordinates[0].map(function(N){return N[0]}),x=c.geometry.coordinates[0].map(function(N){return N[1]}),w=A.geometry.coordinates[0].map(function(N){return N[0]}),P=A.geometry.coordinates[0].map(function(N){return N[1]});return Math.max.apply(null,_)===Math.max.apply(null,w)&&Math.max.apply(null,x)===Math.max.apply(null,P)&&Math.min.apply(null,_)===Math.min.apply(null,w)&&Math.min.apply(null,x)===Math.min.apply(null,P)}function fs(c,A){return A.geometry.coordinates[0].every(function(_){return Ne((0,U.xm)(_),c)})}function zc(c,A){return c[0]===A[0]&&c[1]===A[1]}var Qa=function(){function c(A){this.id=c.buildId(A),this.coordinates=A,this.innerEdges=[],this.outerEdges=[],this.outerEdgesSorted=!1}return c.buildId=function(A){return A.join(",")},c.prototype.removeInnerEdge=function(A){this.innerEdges=this.innerEdges.filter(function(_){return _.from.id!==A.from.id})},c.prototype.removeOuterEdge=function(A){this.outerEdges=this.outerEdges.filter(function(_){return _.to.id!==A.to.id})},c.prototype.addOuterEdge=function(A){this.outerEdges.push(A),this.outerEdgesSorted=!1},c.prototype.sortOuterEdges=function(){var A=this;this.outerEdgesSorted||(this.outerEdges.sort(function(_,x){var w=_.to,P=x.to;if(w.coordinates[0]-A.coordinates[0]>=0&&P.coordinates[0]-A.coordinates[0]<0)return 1;if(w.coordinates[0]-A.coordinates[0]<0&&P.coordinates[0]-A.coordinates[0]>=0)return-1;if(w.coordinates[0]-A.coordinates[0]===0&&P.coordinates[0]-A.coordinates[0]===0)return w.coordinates[1]-A.coordinates[1]>=0||P.coordinates[1]-A.coordinates[1]>=0?w.coordinates[1]-P.coordinates[1]:P.coordinates[1]-w.coordinates[1];var N=R0(A.coordinates,w.coordinates,P.coordinates);if(N<0)return 1;if(N>0)return-1;var V=Math.pow(w.coordinates[0]-A.coordinates[0],2)+Math.pow(w.coordinates[1]-A.coordinates[1],2),W=Math.pow(P.coordinates[0]-A.coordinates[0],2)+Math.pow(P.coordinates[1]-A.coordinates[1],2);return V-W}),this.outerEdgesSorted=!0)},c.prototype.getOuterEdges=function(){return this.sortOuterEdges(),this.outerEdges},c.prototype.getOuterEdge=function(A){return this.sortOuterEdges(),this.outerEdges[A]},c.prototype.addInnerEdge=function(A){this.innerEdges.push(A)},c}(),Xu=Qa,Kf=function(){function c(A,_){this.from=A,this.to=_,this.next=void 0,this.label=void 0,this.symetric=void 0,this.ring=void 0,this.from.addOuterEdge(this),this.to.addInnerEdge(this)}return c.prototype.getSymetric=function(){return this.symetric||(this.symetric=new c(this.to,this.from),this.symetric.symetric=this),this.symetric},c.prototype.deleteEdge=function(){this.from.removeOuterEdge(this),this.to.removeInnerEdge(this)},c.prototype.isEqual=function(A){return this.from.id===A.from.id&&this.to.id===A.to.id},c.prototype.toString=function(){return"Edge { "+this.from.id+" -> "+this.to.id+" }"},c.prototype.toLineString=function(){return(0,U.Tu)([this.from.coordinates,this.to.coordinates])},c.prototype.compareTo=function(A){return R0(A.from.coordinates,A.to.coordinates,this.to.coordinates)},c}(),ff=Kf,$o=function(){function c(){this.edges=[],this.polygon=void 0,this.envelope=void 0}return c.prototype.push=function(A){this.edges.push(A),this.polygon=this.envelope=void 0},c.prototype.get=function(A){return this.edges[A]},Object.defineProperty(c.prototype,"length",{get:function(){return this.edges.length},enumerable:!0,configurable:!0}),c.prototype.forEach=function(A){this.edges.forEach(A)},c.prototype.map=function(A){return this.edges.map(A)},c.prototype.some=function(A){return this.edges.some(A)},c.prototype.isValid=function(){return!0},c.prototype.isHole=function(){var A=this,_=this.edges.reduce(function(N,V,W){return V.from.coordinates[1]>A.edges[N].from.coordinates[1]&&(N=W),N},0),x=(_===0?this.length:_)-1,w=(_+1)%this.length,P=R0(this.edges[x].from.coordinates,this.edges[_].from.coordinates,this.edges[w].from.coordinates);return P===0?this.edges[x].from.coordinates[0]>this.edges[w].from.coordinates[0]:P>0},c.prototype.toMultiPoint=function(){return(0,U.ot)(this.edges.map(function(A){return A.from.coordinates}))},c.prototype.toPolygon=function(){if(this.polygon)return this.polygon;var A=this.edges.map(function(_){return _.from.coordinates});return A.push(this.edges[0].from.coordinates),this.polygon=(0,U.yu)([A])},c.prototype.getEnvelope=function(){return this.envelope?this.envelope:this.envelope=Ws(this.toPolygon())},c.findEdgeRingContaining=function(A,_){var x=A.getEnvelope(),w,P;return _.forEach(function(N){var V=N.getEnvelope();if(P&&(w=P.getEnvelope()),!ec(V,x)&&fs(V,x)){for(var W=A.map(function(gt){return gt.from.coordinates}),k=void 0,K=function(gt){N.some(function(at){return zc(gt,at.from.coordinates)})||(k=gt)},J=0,se=W;J<se.length;J++){var de=se[J];K(de)}k&&N.inside((0,U.xm)(k))&&(!P||fs(w,V))&&(P=N)}}),P},c.prototype.inside=function(A){return Ne(A,this.toPolygon())},c}(),Yu=$o;function Gs(c){if(!c)throw new Error("No geojson passed");if(c.type!=="FeatureCollection"&&c.type!=="GeometryCollection"&&c.type!=="MultiLineString"&&c.type!=="LineString"&&c.type!=="Feature")throw new Error("Invalid input type '"+c.type+"'. Geojson must be FeatureCollection, GeometryCollection, LineString, MultiLineString or Feature")}var Jf=function(){function c(){this.edges=[],this.nodes={}}return c.fromGeoJson=function(A){Gs(A);var _=new c;return(0,D.nG)(A,function(x){(0,G.nK)(x,"LineString","Graph::fromGeoJson"),(0,D.Lo)(x,function(w,P){if(w){var N=_.getNode(w),V=_.getNode(P);_.addEdge(N,V)}return P})}),_},c.prototype.getNode=function(A){var _=Xu.buildId(A),x=this.nodes[_];return x||(x=this.nodes[_]=new Xu(A)),x},c.prototype.addEdge=function(A,_){var x=new ff(A,_),w=x.getSymetric();this.edges.push(x),this.edges.push(w)},c.prototype.deleteDangles=function(){var A=this;Object.keys(this.nodes).map(function(_){return A.nodes[_]}).forEach(function(_){return A._removeIfDangle(_)})},c.prototype._removeIfDangle=function(A){var _=this;if(A.innerEdges.length<=1){var x=A.getOuterEdges().map(function(w){return w.to});this.removeNode(A),x.forEach(function(w){return _._removeIfDangle(w)})}},c.prototype.deleteCutEdges=function(){var A=this;this._computeNextCWEdges(),this._findLabeledEdgeRings(),this.edges.forEach(function(_){_.label===_.symetric.label&&(A.removeEdge(_.symetric),A.removeEdge(_))})},c.prototype._computeNextCWEdges=function(A){var _=this;typeof A=="undefined"?Object.keys(this.nodes).forEach(function(x){return _._computeNextCWEdges(_.nodes[x])}):A.getOuterEdges().forEach(function(x,w){A.getOuterEdge((w===0?A.getOuterEdges().length:w)-1).symetric.next=x})},c.prototype._computeNextCCWEdges=function(A,_){for(var x=A.getOuterEdges(),w,P,N=x.length-1;N>=0;--N){var V=x[N],W=V.symetric,k=void 0,K=void 0;V.label===_&&(k=V),W.label===_&&(K=W),!(!k||!K)&&(K&&(P=K),k&&(P&&(P.next=k,P=void 0),w||(w=k)))}P&&(P.next=w)},c.prototype._findLabeledEdgeRings=function(){var A=[],_=0;return this.edges.forEach(function(x){if(!(x.label>=0)){A.push(x);var w=x;do w.label=_,w=w.next;while(!x.isEqual(w));_++}}),A},c.prototype.getEdgeRings=function(){var A=this;this._computeNextCWEdges(),this.edges.forEach(function(x){x.label=void 0}),this._findLabeledEdgeRings().forEach(function(x){A._findIntersectionNodes(x).forEach(function(w){A._computeNextCCWEdges(w,x.label)})});var _=[];return this.edges.forEach(function(x){x.ring||_.push(A._findEdgeRing(x))}),_},c.prototype._findIntersectionNodes=function(A){var _=[],x=A,w=function(){var P=0;x.from.getOuterEdges().forEach(function(N){N.label===A.label&&++P}),P>1&&_.push(x.from),x=x.next};do w();while(!A.isEqual(x));return _},c.prototype._findEdgeRing=function(A){var _=A,x=new Yu;do x.push(_),_.ring=x,_=_.next;while(!A.isEqual(_));return x},c.prototype.removeNode=function(A){var _=this;A.getOuterEdges().forEach(function(x){return _.removeEdge(x)}),A.innerEdges.forEach(function(x){return _.removeEdge(x)}),delete this.nodes[A.id]},c.prototype.removeEdge=function(A){this.edges=this.edges.filter(function(_){return!_.isEqual(A)}),A.deleteEdge()},c}(),e0=null;function t0(c){var A=Graph.fromGeoJson(c);A.deleteDangles(),A.deleteCutEdges();var _=[],x=[];return A.getEdgeRings().filter(function(w){return w.isValid()}).forEach(function(w){w.isHole()?_.push(w):x.push(w)}),_.forEach(function(w){EdgeRing.findEdgeRingContaining(w,x)&&x.push(w)}),featureCollection(x.map(function(w){return w.toPolygon()}))}function Fh(c,A){var _=!0;return flattenEach(c,function(x){flattenEach(A,function(w){if(_===!1)return!1;_=kf(x.geometry,w.geometry)})}),_}function kf(c,A){switch(c.type){case"Point":switch(A.type){case"Point":return!$u(c.coordinates,A.coordinates);case"LineString":return!hf(A,c);case"Polygon":return!booleanPointInPolygon(c,A)}break;case"LineString":switch(A.type){case"Point":return!hf(c,A);case"LineString":return!Bh(c,A);case"Polygon":return!r0(A,c)}break;case"Polygon":switch(A.type){case"Point":return!booleanPointInPolygon(A,c);case"LineString":return!r0(c,A);case"Polygon":return!vc(A,c)}}return!1}function hf(c,A){for(var _=0;_<c.coordinates.length-1;_++)if(th(c.coordinates[_],c.coordinates[_+1],A.coordinates))return!0;return!1}function Bh(c,A){var _=lineIntersect(c,A);return _.features.length>0}function r0(c,A){for(var _=0,x=A.coordinates;_<x.length;_++){var w=x[_];if(booleanPointInPolygon(w,c))return!0}var P=lineIntersect(A,polygonToLine(c));return P.features.length>0}function vc(c,A){for(var _=0,x=c.coordinates[0];_<x.length;_++){var w=x[_];if(booleanPointInPolygon(w,A))return!0}for(var P=0,N=A.coordinates[0];P<N.length;P++){var V=N[P];if(booleanPointInPolygon(V,c))return!0}var W=lineIntersect(polygonToLine(c),polygonToLine(A));return W.features.length>0}function th(c,A,_){var x=_[0]-c[0],w=_[1]-c[1],P=A[0]-c[0],N=A[1]-c[1],V=x*N-w*P;return V!==0?!1:Math.abs(P)>=Math.abs(N)?P>0?c[0]<=_[0]&&_[0]<=A[0]:A[0]<=_[0]&&_[0]<=c[0]:N>0?c[1]<=_[1]&&_[1]<=A[1]:A[1]<=_[1]&&_[1]<=c[1]}function $u(c,A){return c[0]===A[0]&&c[1]===A[1]}var Dl=null;function Ll(c,A){var _=getGeom(c),x=getGeom(A),w=_.type,P=x.type,N=_.coordinates,V=x.coordinates;switch(w){case"Point":switch(P){case"Point":return rh(N,V);default:throw new Error("feature2 "+P+" geometry not supported")}case"MultiPoint":switch(P){case"Point":return gc(_,x);case"MultiPoint":return kh(_,x);default:throw new Error("feature2 "+P+" geometry not supported")}case"LineString":switch(P){case"Point":return isPointOnLine(x,_,{ignoreEndVertices:!0});case"LineString":return TA(_,x);case"MultiPoint":return Uh(_,x);default:throw new Error("feature2 "+P+" geometry not supported")}case"Polygon":switch(P){case"Point":return booleanPointInPolygon(x,_,{ignoreBoundary:!0});case"LineString":return CA(_,x);case"Polygon":return Zh(_,x);case"MultiPoint":return M0(_,x);default:throw new Error("feature2 "+P+" geometry not supported")}default:throw new Error("feature1 "+w+" geometry not supported")}}function gc(c,A){var _,x=!1;for(_=0;_<c.coordinates.length;_++)if(rh(c.coordinates[_],A.coordinates)){x=!0;break}return x}function kh(c,A){for(var _=0,x=A.coordinates;_<x.length;_++){for(var w=x[_],P=!1,N=0,V=c.coordinates;N<V.length;N++){var W=V[N];if(rh(w,W)){P=!0;break}}if(!P)return!1}return!0}function Uh(c,A){for(var _=!1,x=0,w=A.coordinates;x<w.length;x++){var P=w[x];if(isPointOnLine(P,c,{ignoreEndVertices:!0})&&(_=!0),!isPointOnLine(P,c))return!1}return!!_}function M0(c,A){for(var _=0,x=A.coordinates;_<x.length;_++){var w=x[_];if(!booleanPointInPolygon(w,c,{ignoreBoundary:!0}))return!1}return!0}function TA(c,A){for(var _=!1,x=0,w=A.coordinates;x<w.length;x++){var P=w[x];if(isPointOnLine({type:"Point",coordinates:P},c,{ignoreEndVertices:!0})&&(_=!0),!isPointOnLine({type:"Point",coordinates:P},c,{ignoreEndVertices:!1}))return!1}return _}function CA(c,A){var _=!1,x=0,w=calcBbox(c),P=calcBbox(A);if(!zh(w,P))return!1;for(x;x<A.coordinates.length-1;x++){var N=bA(A.coordinates[x],A.coordinates[x+1]);if(booleanPointInPolygon({type:"Point",coordinates:N},c,{ignoreBoundary:!0})){_=!0;break}}return _}function Zh(c,A){if(c.type==="Feature"&&c.geometry===null||A.type==="Feature"&&A.geometry===null)return!1;var _=calcBbox(c),x=calcBbox(A);if(!zh(_,x))return!1;for(var w=getGeom(A).coordinates,P=0,N=w;P<N.length;P++)for(var V=N[P],W=0,k=V;W<k.length;W++){var K=k[W];if(!booleanPointInPolygon(K,c))return!1}return!0}function zh(c,A){return!(c[0]>A[0]||c[2]<A[2]||c[1]>A[1]||c[3]<A[3])}function rh(c,A){return c[0]===A[0]&&c[1]===A[1]}function bA(c,A){return[(c[0]+A[0])/2,(c[1]+A[1])/2]}function Up(c,A){var _=getGeom(c),x=getGeom(A),w=_.type,P=x.type;switch(w){case"MultiPoint":switch(P){case"LineString":return Gh(_,x);case"Polygon":return w0(_,x);default:throw new Error("feature2 "+P+" geometry not supported")}case"LineString":switch(P){case"MultiPoint":return Gh(x,_);case"LineString":return RA(_,x);case"Polygon":return Gc(_,x);default:throw new Error("feature2 "+P+" geometry not supported")}case"Polygon":switch(P){case"MultiPoint":return w0(x,_);case"LineString":return Gc(x,_);default:throw new Error("feature2 "+P+" geometry not supported")}default:throw new Error("feature1 "+w+" geometry not supported")}}function Gh(c,A){for(var _=!1,x=!1,w=c.coordinates.length,P=0;P<w&&!_&&!x;){for(var N=0;N<A.coordinates.length-1;N++){var V=!0;(N===0||N===A.coordinates.length-2)&&(V=!1),Vc(A.coordinates[N],A.coordinates[N+1],c.coordinates[P],V)?_=!0:x=!0}P++}return _&&x}function RA(c,A){var _=lineIntersect(c,A);if(_.features.length>0)for(var x=0;x<c.coordinates.length-1;x++)for(var w=0;w<A.coordinates.length-1;w++){var P=!0;if((w===0||w===A.coordinates.length-2)&&(P=!1),Vc(c.coordinates[x],c.coordinates[x+1],A.coordinates[w],P))return!0}return!1}function Gc(c,A){var _=polygonToLine(A),x=lineIntersect(c,_);return x.features.length>0}function w0(c,A){for(var _=!1,x=!1,w=c.coordinates.length,P=0;P<w&&(!_||!x);P++)booleanPointInPolygon(point(c.coordinates[P]),A)?_=!0:x=!0;return x&&_}function Vc(c,A,_,x){var w=_[0]-c[0],P=_[1]-c[1],N=A[0]-c[0],V=A[1]-c[1],W=w*V-P*N;return W!==0?!1:x?Math.abs(N)>=Math.abs(V)?N>0?c[0]<=_[0]&&_[0]<=A[0]:A[0]<=_[0]&&_[0]<=c[0]:V>0?c[1]<=_[1]&&_[1]<=A[1]:A[1]<=_[1]&&_[1]<=c[1]:Math.abs(N)>=Math.abs(V)?N>0?c[0]<_[0]&&_[0]<A[0]:A[0]<_[0]&&_[0]<c[0]:V>0?c[1]<_[1]&&_[1]<A[1]:A[1]<_[1]&&_[1]<c[1]}var nh=null,ih=C(15468);function Vh(c,A){var _=getGeom(c),x=getGeom(A),w=_.type,P=x.type;if(w==="MultiPoint"&&P!=="MultiPoint"||(w==="LineString"||w==="MultiLineString")&&P!=="LineString"&&P!=="MultiLineString"||(w==="Polygon"||w==="MultiPolygon")&&P!=="Polygon"&&P!=="MultiPolygon")throw new Error("features must be of the same type");if(w==="Point")throw new Error("Point geometry not supported");var N=new GeojsonEquality({precision:6});if(N.compare(c,A))return!1;var V=0;switch(w){case"MultiPoint":for(var W=0;W<_.coordinates.length;W++)for(var k=0;k<x.coordinates.length;k++){var K=_.coordinates[W],J=x.coordinates[k];if(K[0]===J[0]&&K[1]===J[1])return!0}return!1;case"LineString":case"MultiLineString":segmentEach(c,function(se){segmentEach(A,function(de){lineOverlap(se,de).features.length&&V++})});break;case"Polygon":case"MultiPolygon":segmentEach(c,function(se){segmentEach(A,function(de){lineIntersect(se,de).features.length&&V++})});break}return V>0}function Af(c,A){var _=getGeom(c).type,x=getGeom(A).type;if(_!==x)return!1;var w=new GeojsonEquality({precision:6});return w.compare(cleanCoords(c),cleanCoords(A))}var pf=null;function n0(c,A){var _=!1;return flattenEach(c,function(x){flattenEach(A,function(w){if(_===!0)return!0;_=!booleanDisjoint(x.geometry,w.geometry)})}),_}var Vo=C(70298);function Au(c,A,_){_===void 0&&(_={}),_.mutate!==!0&&(c=clone(c)),_.minPoints=_.minPoints||3;var x=new clustering.DBSCAN,w=x.run(coordAll(c),convertLength(A,_.units),_.minPoints,distance),P=-1;return w.forEach(function(N){P++,N.forEach(function(V){var W=c.features[V];W.properties||(W.properties={}),W.properties.cluster=P,W.properties.dbscan="core"})}),x.noise.forEach(function(N){var V=c.features[N];V.properties||(V.properties={}),V.properties.cluster?V.properties.dbscan="edge":V.properties.dbscan="noise"}),c}var mc=null,Hc=C(89345);function Qu(c,A){A===void 0&&(A={});var _=c.features.length;A.numberOfClusters=A.numberOfClusters||Math.round(Math.sqrt(_/2)),A.numberOfClusters>_&&(A.numberOfClusters=_),A.mutate!==!0&&(c=clone(c));var x=coordAll(c),w=x.slice(0,A.numberOfClusters),P=skmeans(x,A.numberOfClusters,w),N={};return P.centroids.forEach(function(V,W){N[W]=V}),featureEach(c,function(V,W){var k=P.idxs[W];V.properties.cluster=k,V.properties.centroid=N[k]}),c}var tc=null;function Wc(c,A){if(!c)throw new Error("line1 is required");if(!A)throw new Error("line2 is required");var _=_c(c,"line1");if(_!=="LineString")throw new Error("line1 must be a LineString");var x=_c(A,"line2");if(x!=="LineString")throw new Error("line2 must be a LineString");for(var w=lineSegment(cleanCoords(c)).features,P=lineSegment(cleanCoords(A)).features,N=0;N<w.length;N++){var V=w[N].geometry.coordinates;if(!P[N])break;var W=P[N].geometry.coordinates;if(!df(V,W))return!1}return!0}function df(c,A){var _=bearingToAzimuth(rhumbBearing(c[0],c[1])),x=bearingToAzimuth(rhumbBearing(A[0],A[1]));return _===x}function _c(c,A){if(c.geometry&&c.geometry.type)return c.geometry.type;if(c.type)return c.type;throw new Error("Invalid GeoJSON object for "+A)}var vf=null;function wa(c){for(var A=c,_=[];A.parent;)_.unshift(A),A=A.parent;return _}function yc(){return new ah(function(c){return c.f})}var Uf={search:function(c,A,_,x){c.cleanDirty(),x=x||{};var w=x.heuristic||Uf.heuristics.manhattan,P=x.closest||!1,N=yc(),V=A;for(A.h=w(A,_),N.push(A);N.size()>0;){var W=N.pop();if(W===_)return wa(W);W.closed=!0;for(var k=c.neighbors(W),K=0,J=k.length;K<J;++K){var se=k[K];if(!(se.closed||se.isWall())){var de=W.g+se.getCost(W),gt=se.visited;(!gt||de<se.g)&&(se.visited=!0,se.parent=W,se.h=se.h||w(se,_),se.g=de,se.f=se.g+se.h,c.markDirty(se),P&&(se.h<V.h||se.h===V.h&&se.g<V.g)&&(V=se),gt?N.rescoreElement(se):N.push(se))}}}return P?wa(V):[]},heuristics:{manhattan:function(c,A){var _=Math.abs(A.x-c.x),x=Math.abs(A.y-c.y);return _+x},diagonal:function(c,A){var _=1,x=Math.sqrt(2),w=Math.abs(A.x-c.x),P=Math.abs(A.y-c.y);return _*(w+P)+(x-2*_)*Math.min(w,P)}},cleanNode:function(c){c.f=0,c.g=0,c.h=0,c.visited=!1,c.closed=!1,c.parent=null}};function Ec(c,A){A=A||{},this.nodes=[],this.diagonal=!!A.diagonal,this.grid=[];for(var _=0;_<c.length;_++){this.grid[_]=[];for(var x=0,w=c[_];x<w.length;x++){var P=new i0(_,x,w[x]);this.grid[_][x]=P,this.nodes.push(P)}}this.init()}Ec.prototype.init=function(){this.dirtyNodes=[];for(var c=0;c<this.nodes.length;c++)Uf.cleanNode(this.nodes[c])},Ec.prototype.cleanDirty=function(){for(var c=0;c<this.dirtyNodes.length;c++)Uf.cleanNode(this.dirtyNodes[c]);this.dirtyNodes=[]},Ec.prototype.markDirty=function(c){this.dirtyNodes.push(c)},Ec.prototype.neighbors=function(c){var A=[],_=c.x,x=c.y,w=this.grid;return w[_-1]&&w[_-1][x]&&A.push(w[_-1][x]),w[_+1]&&w[_+1][x]&&A.push(w[_+1][x]),w[_]&&w[_][x-1]&&A.push(w[_][x-1]),w[_]&&w[_][x+1]&&A.push(w[_][x+1]),this.diagonal&&(w[_-1]&&w[_-1][x-1]&&A.push(w[_-1][x-1]),w[_+1]&&w[_+1][x-1]&&A.push(w[_+1][x-1]),w[_-1]&&w[_-1][x+1]&&A.push(w[_-1][x+1]),w[_+1]&&w[_+1][x+1]&&A.push(w[_+1][x+1])),A},Ec.prototype.toString=function(){for(var c=[],A=this.grid,_,x,w,P,N=0,V=A.length;N<V;N++){for(_=[],x=A[N],w=0,P=x.length;w<P;w++)_.push(x[w].weight);c.push(_.join(" "))}return c.join(`
`)};function i0(c,A,_){this.x=c,this.y=A,this.weight=_}i0.prototype.toString=function(){return"["+this.x+" "+this.y+"]"},i0.prototype.getCost=function(c){return c&&c.x!==this.x&&c.y!==this.y?this.weight*1.41421:this.weight},i0.prototype.isWall=function(){return this.weight===0};function ah(c){this.content=[],this.scoreFunction=c}ah.prototype={push:function(c){this.content.push(c),this.sinkDown(this.content.length-1)},pop:function(){var c=this.content[0],A=this.content.pop();return this.content.length>0&&(this.content[0]=A,this.bubbleUp(0)),c},remove:function(c){var A=this.content.indexOf(c),_=this.content.pop();A!==this.content.length-1&&(this.content[A]=_,this.scoreFunction(_)<this.scoreFunction(c)?this.sinkDown(A):this.bubbleUp(A))},size:function(){return this.content.length},rescoreElement:function(c){this.sinkDown(this.content.indexOf(c))},sinkDown:function(c){for(var A=this.content[c];c>0;){var _=(c+1>>1)-1,x=this.content[_];if(this.scoreFunction(A)<this.scoreFunction(x))this.content[_]=A,this.content[c]=x,c=_;else break}},bubbleUp:function(c){for(var A=this.content.length,_=this.content[c],x=this.scoreFunction(_);;){var w=c+1<<1,P=w-1,N=null,V;if(P<A){var W=this.content[P];V=this.scoreFunction(W),V<x&&(N=P)}if(w<A){var k=this.content[w],K=this.scoreFunction(k);K<(N===null?x:V)&&(N=w)}if(N!==null)this.content[c]=this.content[N],this.content[N]=_,c=N;else break}}};function Hh(c,A,_){if(_=_||{},!isObject(_))throw new Error("options is invalid");var x=_.resolution,w=_.minDistance,P=_.obstacles||featureCollection([]);if(!c)throw new Error("start is required");if(!A)throw new Error("end is required");if(x&&!isNumber(x)||x<=0)throw new Error("options.resolution must be a number, greater than 0");if(w)throw new Error("options.minDistance is not yet implemented");var N=getCoord(c),V=getCoord(A);switch(c=point(N),A=point(V),getType(P)){case"FeatureCollection":if(P.features.length===0)return lineString([N,V]);break;case"Polygon":P=featureCollection([feature(getGeom(P))]);break;default:throw new Error("invalid obstacles")}var W=P;W.features.push(c),W.features.push(A);var k=bbox(scale(bboxPolygon(bbox(W)),1.15));if(!x){var K=distance([k[0],k[1]],[k[2],k[1]],_);x=K/100}W.features.pop(),W.features.pop();for(var J=k[0],se=k[1],de=k[2],gt=k[3],at=x/distance([J,se],[de,se],_),Zt=at*(de-J),mt=x/distance([J,se],[J,gt],_),rt=mt*(gt-se),lt=de-J,Qt=gt-se,Yt=Math.floor(lt/Zt),or=Math.floor(Qt/rt),nr=(lt-Yt*Zt)/2,dr=(Qt-or*rt)/2,Mt=[],vi=[],In=[],Fi=[],aa=1/0,un=1/0,Ai=gt-dr,Gn=0;Ai>=se;){for(var za=[],La=[],ha=J+nr,el=0;ha<=de;){var tu=point([ha,Ai]),Tu=jc(tu,P);za.push(Tu?0:1),La.push(ha+"|"+Ai);var co=distance(tu,c);!Tu&&co<aa&&(aa=co,In={x:el,y:Gn});var So=distance(tu,A);!Tu&&So<un&&(un=So,Fi={x:el,y:Gn}),ha+=Zt,el++}vi.push(za),Mt.push(La),Ai-=rt,Gn++}var es=new Ec(vi,{diagonal:!0}),bc=es.grid[In.y][In.x],Qc=es.grid[Fi.y][Fi.x],ap=Uf.search(es,bc,Qc),yh=[N];return ap.forEach(function(op){var uA=Mt[op.x][op.y].split("|");yh.push([+uA[0],+uA[1]])}),yh.push(V),cleanCoords(lineString(yh))}function jc(c,A){for(var _=0;_<A.features.length;_++)if(booleanPointInPolygon(c,A.features[_]))return!0;return!1}var Ks=null;function Xc(){this._=null}function Fl(c){c.U=c.C=c.L=c.R=c.P=c.N=null}Xc.prototype={constructor:Xc,insert:function(c,A){var _,x,w;if(c){if(A.P=c,A.N=c.N,c.N&&(c.N.P=A),c.N=A,c.R){for(c=c.R;c.L;)c=c.L;c.L=A}else c.R=A;_=c}else this._?(c=oh(this._),A.P=null,A.N=c,c.P=c.L=A,_=c):(A.P=A.N=null,this._=A,_=null);for(A.L=A.R=null,A.U=_,A.C=!0,c=A;_&&_.C;)x=_.U,_===x.L?(w=x.R,w&&w.C?(_.C=w.C=!1,x.C=!0,c=x):(c===_.R&&(a0(this,_),c=_,_=c.U),_.C=!1,x.C=!0,qu(this,x))):(w=x.L,w&&w.C?(_.C=w.C=!1,x.C=!0,c=x):(c===_.L&&(qu(this,_),c=_,_=c.U),_.C=!1,x.C=!0,a0(this,x))),_=c.U;this._.C=!1},remove:function(c){c.N&&(c.N.P=c.P),c.P&&(c.P.N=c.N),c.N=c.P=null;var A=c.U,_,x=c.L,w=c.R,P,N;if(x?w?P=oh(w):P=x:P=w,A?A.L===c?A.L=P:A.R=P:this._=P,x&&w?(N=P.C,P.C=c.C,P.L=x,x.U=P,P!==w?(A=P.U,P.U=c.U,c=P.R,A.L=c,P.R=w,w.U=P):(P.U=A,A=P,c=P.R)):(N=c.C,c=P),c&&(c.U=A),!N){if(c&&c.C){c.C=!1;return}do{if(c===this._)break;if(c===A.L){if(_=A.R,_.C&&(_.C=!1,A.C=!0,a0(this,A),_=A.R),_.L&&_.L.C||_.R&&_.R.C){(!_.R||!_.R.C)&&(_.L.C=!1,_.C=!0,qu(this,_),_=A.R),_.C=A.C,A.C=_.R.C=!1,a0(this,A),c=this._;break}}else if(_=A.L,_.C&&(_.C=!1,A.C=!0,qu(this,A),_=A.L),_.L&&_.L.C||_.R&&_.R.C){(!_.L||!_.L.C)&&(_.R.C=!1,_.C=!0,a0(this,_),_=A.L),_.C=A.C,A.C=_.L.C=!1,qu(this,A),c=this._;break}_.C=!0,c=A,A=A.U}while(!c.C);c&&(c.C=!1)}}};function a0(c,A){var _=A,x=A.R,w=_.U;w?w.L===_?w.L=x:w.R=x:c._=x,x.U=w,_.U=x,_.R=x.L,_.R&&(_.R.U=_),x.L=_}function qu(c,A){var _=A,x=A.L,w=_.U;w?w.L===_?w.L=x:w.R=x:c._=x,x.U=w,_.U=x,_.L=x.R,_.L&&(_.L.U=_),x.R=_}function oh(c){for(;c.L;)c=c.L;return c}var Ho=Xc;function gf(c,A,_,x){var w=[null,null],P=Je.push(w)-1;return w.left=c,w.right=A,_&&pu(w,c,A,_),x&&pu(w,A,c,x),Su[c.index].halfedges.push(P),Su[A.index].halfedges.push(P),w}function Ku(c,A,_){var x=[A,_];return x.left=c,x}function pu(c,A,_,x){!c[0]&&!c[1]?(c[0]=x,c.left=A,c.right=_):c.left===_?c[1]=x:c[0]=x}function Sc(c,A,_,x,w){var P=c[0],N=c[1],V=P[0],W=P[1],k=N[0],K=N[1],J=0,se=1,de=k-V,gt=K-W,at;if(at=A-V,!(!de&&at>0)){if(at/=de,de<0){if(at<J)return;at<se&&(se=at)}else if(de>0){if(at>se)return;at>J&&(J=at)}if(at=x-V,!(!de&&at<0)){if(at/=de,de<0){if(at>se)return;at>J&&(J=at)}else if(de>0){if(at<J)return;at<se&&(se=at)}if(at=_-W,!(!gt&&at>0)){if(at/=gt,gt<0){if(at<J)return;at<se&&(se=at)}else if(gt>0){if(at>se)return;at>J&&(J=at)}if(at=w-W,!(!gt&&at<0)){if(at/=gt,gt<0){if(at>se)return;at>J&&(J=at)}else if(gt>0){if(at<J)return;at<se&&(se=at)}return!(J>0)&&!(se<1)||(J>0&&(c[0]=[V+J*de,W+J*gt]),se<1&&(c[1]=[V+se*de,W+se*gt])),!0}}}}}function Yc(c,A,_,x,w){var P=c[1];if(P)return!0;var N=c[0],V=c.left,W=c.right,k=V[0],K=V[1],J=W[0],se=W[1],de=(k+J)/2,gt=(K+se)/2,at,Zt;if(se===K){if(de<A||de>=x)return;if(k>J){if(!N)N=[de,_];else if(N[1]>=w)return;P=[de,w]}else{if(!N)N=[de,w];else if(N[1]<_)return;P=[de,_]}}else if(at=(k-J)/(se-K),Zt=gt-at*de,at<-1||at>1)if(k>J){if(!N)N=[(_-Zt)/at,_];else if(N[1]>=w)return;P=[(w-Zt)/at,w]}else{if(!N)N=[(w-Zt)/at,w];else if(N[1]<_)return;P=[(_-Zt)/at,_]}else if(K<se){if(!N)N=[A,at*A+Zt];else if(N[0]>=x)return;P=[x,at*x+Zt]}else{if(!N)N=[x,at*x+Zt];else if(N[0]<A)return;P=[A,at*A+Zt]}return c[0]=N,c[1]=P,!0}function o0(c,A,_,x){for(var w=Je.length,P;w--;)(!Yc(P=Je[w],c,A,_,x)||!Sc(P,c,A,_,x)||!(Math.abs(P[0][0]-P[1][0])>so||Math.abs(P[0][1]-P[1][1])>so))&&delete Je[w]}function I0(c){return Su[c.index]={site:c,halfedges:[]}}function Fu(c,A){var _=c.site,x=A.left,w=A.right;return _===w&&(w=x,x=_),w?Math.atan2(w[1]-x[1],w[0]-x[0]):(_===x?(x=A[1],w=A[0]):(x=A[0],w=A[1]),Math.atan2(x[0]-w[0],w[1]-x[1]))}function Bl(c,A){return A[+(A.left!==c.site)]}function Po(c,A){return A[+(A.left===c.site)]}function Js(){for(var c=0,A=Su.length,_,x,w,P;c<A;++c)if((_=Su[c])&&(P=(x=_.halfedges).length)){var N=new Array(P),V=new Array(P);for(w=0;w<P;++w)N[w]=w,V[w]=Fu(_,Je[x[w]]);for(N.sort(function(W,k){return V[k]-V[W]}),w=0;w<P;++w)V[w]=x[N[w]];for(w=0;w<P;++w)x[w]=V[w]}}function s0(c,A,_,x){var w=Su.length,P,N,V,W,k,K,J,se,de,gt,at,Zt,mt=!0;for(P=0;P<w;++P)if(N=Su[P]){for(V=N.site,k=N.halfedges,W=k.length;W--;)Je[k[W]]||k.splice(W,1);for(W=0,K=k.length;W<K;)gt=Po(N,Je[k[W]]),at=gt[0],Zt=gt[1],J=Bl(N,Je[k[++W%K]]),se=J[0],de=J[1],(Math.abs(at-se)>so||Math.abs(Zt-de)>so)&&(k.splice(W,0,Je.push(Ku(V,gt,Math.abs(at-c)<so&&x-Zt>so?[c,Math.abs(se-c)<so?de:x]:Math.abs(Zt-x)<so&&_-at>so?[Math.abs(de-x)<so?se:_,x]:Math.abs(at-_)<so&&Zt-A>so?[_,Math.abs(se-_)<so?de:A]:Math.abs(Zt-A)<so&&at-c>so?[Math.abs(de-A)<so?se:c,A]:null))-1),++K);K&&(mt=!1)}if(mt){var rt,lt,Qt,Yt=1/0;for(P=0,mt=null;P<w;++P)(N=Su[P])&&(V=N.site,rt=V[0]-c,lt=V[1]-A,Qt=rt*rt+lt*lt,Qt<Yt&&(Yt=Qt,mt=N));if(mt){var or=[c,A],nr=[c,x],dr=[_,x],Mt=[_,A];mt.halfedges.push(Je.push(Ku(V=mt.site,or,nr))-1,Je.push(Ku(V,nr,dr))-1,Je.push(Ku(V,dr,Mt))-1,Je.push(Ku(V,Mt,or))-1)}}for(P=0;P<w;++P)(N=Su[P])&&(N.halfedges.length||delete Su[P])}var P0=[],eu;function mf(){Fl(this),this.x=this.y=this.arc=this.site=this.cy=null}function _f(c){var A=c.P,_=c.N;if(!(!A||!_)){var x=A.site,w=c.site,P=_.site;if(x!==P){var N=w[0],V=w[1],W=x[0]-N,k=x[1]-V,K=P[0]-N,J=P[1]-V,se=2*(W*J-k*K);if(!(se>=-zf)){var de=W*W+k*k,gt=K*K+J*J,at=(J*de-k*gt)/se,Zt=(W*gt-K*de)/se,mt=P0.pop()||new mf;mt.arc=c,mt.site=w,mt.x=at+N,mt.y=(mt.cy=Zt+V)+Math.sqrt(at*at+Zt*Zt),c.circle=mt;for(var rt=null,lt=Te._;lt;)if(mt.y<lt.y||mt.y===lt.y&&mt.x<=lt.x)if(lt.L)lt=lt.L;else{rt=lt.P;break}else if(lt.R)lt=lt.R;else{rt=lt;break}Te.insert(rt,mt),rt||(eu=mt)}}}}function Al(c){var A=c.circle;A&&(A.P||(eu=A.N),Te.remove(A),P0.push(A),Fl(A),c.circle=null)}var u0=[];function Wh(){Fl(this),this.edge=this.site=this.circle=null}function yf(c){var A=u0.pop()||new Wh;return A.site=c,A}function O0(c){Al(c),xc.remove(c),u0.push(c),Fl(c)}function N0(c){var A=c.circle,_=A.x,x=A.cy,w=[_,x],P=c.P,N=c.N,V=[c];O0(c);for(var W=P;W.circle&&Math.abs(_-W.circle.x)<so&&Math.abs(x-W.circle.cy)<so;)P=W.P,V.unshift(W),O0(W),W=P;V.unshift(W),Al(W);for(var k=N;k.circle&&Math.abs(_-k.circle.x)<so&&Math.abs(x-k.circle.cy)<so;)N=k.N,V.push(k),O0(k),k=N;V.push(k),Al(k);var K=V.length,J;for(J=1;J<K;++J)k=V[J],W=V[J-1],pu(k.edge,W.site,k.site,w);W=V[0],k=V[K-1],k.edge=gf(W.site,k.site,null,w),_f(W),_f(k)}function sh(c){for(var A=c[0],_=c[1],x,w,P,N,V=xc._;V;)if(P=Ef(V,_)-A,P>so)V=V.L;else if(N=A-Zf(V,_),N>so){if(!V.R){x=V;break}V=V.R}else{P>-so?(x=V.P,w=V):N>-so?(x=V,w=V.N):x=w=V;break}I0(c);var W=yf(c);if(xc.insert(x,W),!(!x&&!w)){if(x===w){Al(x),w=yf(x.site),xc.insert(W,w),W.edge=w.edge=gf(x.site,W.site),_f(x),_f(w);return}if(!w){W.edge=gf(x.site,W.site);return}Al(x),Al(w);var k=x.site,K=k[0],J=k[1],se=c[0]-K,de=c[1]-J,gt=w.site,at=gt[0]-K,Zt=gt[1]-J,mt=2*(se*Zt-de*at),rt=se*se+de*de,lt=at*at+Zt*Zt,Qt=[(Zt*rt-de*lt)/mt+K,(se*lt-at*rt)/mt+J];pu(w.edge,k,gt,Qt),W.edge=gf(k,c,null,Qt),w.edge=gf(c,gt,null,Qt),_f(x),_f(w)}}function Ef(c,A){var _=c.site,x=_[0],w=_[1],P=w-A;if(!P)return x;var N=c.P;if(!N)return-1/0;_=N.site;var V=_[0],W=_[1],k=W-A;if(!k)return V;var K=V-x,J=1/P-1/k,se=K/k;return J?(-se+Math.sqrt(se*se-2*J*(K*K/(-2*k)-W+k/2+w-P/2)))/J+x:(x+V)/2}function Zf(c,A){var _=c.N;if(_)return Ef(_,A);var x=c.site;return x[1]===A?x[0]:1/0}var so=1e-6,zf=1e-12,xc,Su,Te,Je;function Et(c,A,_){return(c[0]-_[0])*(A[1]-c[1])-(c[0]-A[0])*(_[1]-c[1])}function sr(c,A){return A[1]-c[1]||A[0]-c[0]}function Er(c,A){var _=c.sort(sr).pop(),x,w,P;for(Je=[],Su=new Array(c.length),xc=new Ho,Te=new Ho;;)if(P=eu,_&&(!P||_[1]<P.y||_[1]===P.y&&_[0]<P.x))(_[0]!==x||_[1]!==w)&&(sh(_),x=_[0],w=_[1]),_=c.pop();else if(P)N0(P.arc);else break;if(Js(),A){var N=+A[0][0],V=+A[0][1],W=+A[1][0],k=+A[1][1];o0(N,V,W,k),s0(N,V,W,k)}this.edges=Je,this.cells=Su,xc=Te=Je=Su=null}Er.prototype={constructor:Er,polygons:function(){var c=this.edges;return this.cells.map(function(A){var _=A.halfedges.map(function(x){return Bl(A,c[x])});return _.data=A.site.data,_})},triangles:function(){var c=[],A=this.edges;return this.cells.forEach(function(_,x){if(V=(P=_.halfedges).length)for(var w=_.site,P,N=-1,V,W,k=A[P[V-1]],K=k.left===w?k.right:k.left;++N<V;)W=K,k=A[P[N]],K=k.left===w?k.right:k.left,W&&K&&x<W.index&&x<K.index&&Et(w,W,K)<0&&c.push([w.data,W.data,K.data])}),c},links:function(){return this.edges.filter(function(c){return c.right}).map(function(c){return{source:c.left.data,target:c.right.data}})},find:function(c,A,_){for(var x=this,w,P=x._found||0,N=x.cells.length,V;!(V=x.cells[P]);)if(++P>=N)return null;var W=c-V.site[0],k=A-V.site[1],K=W*W+k*k;do V=x.cells[w=P],P=null,V.halfedges.forEach(function(J){var se=x.edges[J],de=se.left;if(!((de===V.site||!de)&&!(de=se.right))){var gt=c-de[0],at=A-de[1],Zt=gt*gt+at*at;Zt<K&&(K=Zt,P=de.index)}});while(P!==null);return x._found=w,_==null||K<=_*_?V.site:null}};function lr(){var c=pointX,A=pointY,_=null;function x(w){return new Diagram(w.map(function(P,N){var V=[Math.round(c(P,N,w)/epsilon)*epsilon,Math.round(A(P,N,w)/epsilon)*epsilon];return V.index=N,V.data=P,V}),_)}return x.polygons=function(w){return x(w).polygons()},x.links=function(w){return x(w).links()},x.triangles=function(w){return x(w).triangles()},x.x=function(w){return arguments.length?(c=typeof w=="function"?w:constant(+w),x):c},x.y=function(w){return arguments.length?(A=typeof w=="function"?w:constant(+w),x):A},x.extent=function(w){return arguments.length?(_=w==null?null:[[+w[0][0],+w[0][1]],[+w[1][0],+w[1][1]]],x):_&&[[_[0][0],_[0][1]],[_[1][0],_[1][1]]]},x.size=function(w){return arguments.length?(_=w==null?null:[[0,0],[+w[0],+w[1]]],x):_&&[_[1][0]-_[0][0],_[1][1]-_[0][1]]},x}function gr(c){return c=c.slice(),c.push(c[0]),polygon([c])}function kr(c,A){if(A=A||{},!isObject(A))throw new Error("options is invalid");var _=A.bbox||[-180,-85,180,85];if(!c)throw new Error("points is required");if(!Array.isArray(_))throw new Error("bbox is invalid");return collectionOf(c,"Point","points"),featureCollection(voronoi$1().x(function(x){return x.geometry.coordinates[0]}).y(function(x){return x.geometry.coordinates[1]}).extent([[_[0],_[1]],[_[2],_[3]]]).polygons(c.features).map(gr))}var Pr=null;function qr(c,A,_,x){x=x||{};var w=x.steps||64,P=x.units||"kilometers",N=x.angle||0,V=x.pivot||c,W=x.properties||c.properties||{};if(!c)throw new Error("center is required");if(!A)throw new Error("xSemiAxis is required");if(!_)throw new Error("ySemiAxis is required");if(!isObject(x))throw new Error("options must be an object");if(!isNumber(w))throw new Error("steps must be a number");if(!isNumber(N))throw new Error("angle must be a number");var k=getCoord(c);if(P==="degrees")var K=degreesToRadians(N);else A=rhumbDestination(c,A,90,{units:P}),_=rhumbDestination(c,_,0,{units:P}),A=getCoord(A)[0]-k[0],_=getCoord(_)[1]-k[1];for(var J=[],se=0;se<w;se+=1){var de=se*-360/w,gt=A*_/Math.sqrt(Math.pow(_,2)+Math.pow(A,2)*Math.pow(Br(de),2)),at=A*_/Math.sqrt(Math.pow(A,2)+Math.pow(_,2)/Math.pow(Br(de),2));if(de<-90&&de>=-270&&(gt=-gt),de<-180&&de>=-360&&(at=-at),P==="degrees"){var Zt=gt*Math.cos(K)+at*Math.sin(K),mt=at*Math.cos(K)-gt*Math.sin(K);gt=Zt,at=mt}J.push([gt+k[0],at+k[1]])}return J.push(J[0]),P==="degrees"?polygon([J],W):transformRotate(polygon([J],W),N,{pivot:V})}function Br(c){var A=c*Math.PI/180;return Math.tan(A)}var Vr=null;function Kr(c,A){A===void 0&&(A={});var _=0,x=0,w=0;return geomEach(c,function(P,N,V){var W=A.weight?V==null?void 0:V[A.weight]:void 0;if(W=W==null?1:W,!isNumber(W))throw new Error("weight value must be a number for feature index "+N);W=Number(W),W>0&&coordEach(P,function(k){_+=k[0]*W,x+=k[1]*W,w+=W})}),point([_/w,x/w],A.properties,A)}var Dr=null;function jr(c,A){if(A===void 0&&(A={}),A=A||{},!isObject(A))throw new Error("options is invalid");var _=A.counter||10;if(!isNumber(_))throw new Error("counter must be a number");var x=A.weight,w=centerMean(c,{weight:A.weight}),P=featureCollection([]);featureEach(c,function(V){var W;P.features.push(centroid(V,{properties:{weight:(W=V.properties)===null||W===void 0?void 0:W[x]}}))});var N={tolerance:A.tolerance,medianCandidates:[]};return jt(w.geometry.coordinates,[0,0],P,N,_)}function jt(c,A,_,x,w){var P=x.tolerance||.001,N=0,V=0,W=0,k=0;if(featureEach(_,function(se){var de,gt=(de=se.properties)===null||de===void 0?void 0:de.weight,at=gt==null?1:gt;if(at=Number(at),!isNumber(at))throw new Error("weight value must be a number");if(at>0){k+=1;var Zt=at*distance(se,c);Zt===0&&(Zt=1);var mt=at/Zt;N+=se.geometry.coordinates[0]*mt,V+=se.geometry.coordinates[1]*mt,W+=mt}}),k<1)throw new Error("no features to measure");var K=N/W,J=V/W;return k===1||w===0||Math.abs(K-A[0])<P&&Math.abs(J-A[1])<P?point([K,J],{medianCandidates:x.medianCandidates}):(x.medianCandidates.push([K,J]),jt([K,J],c,_,x,w-1))}var Ar=null;function Ur(c,A){if(A=A||{},!isObject(A))throw new Error("options is invalid");var _=A.steps||64,x=A.weight,w=A.properties||{};if(!isNumber(_))throw new Error("steps must be a number");if(!isObject(w))throw new Error("properties must be a number");var P=coordAll(c).length,N=centerMean(c,{weight:x}),V=0,W=0,k=0;featureEach(c,function(nr){var dr=nr.properties[x]||1,Mt=Jr(getCoords(nr),getCoords(N));V+=Math.pow(Mt.x,2)*dr,W+=Math.pow(Mt.y,2)*dr,k+=Mt.x*Mt.y*dr});var K=V-W,J=Math.sqrt(Math.pow(K,2)+4*Math.pow(k,2)),se=2*k,de=Math.atan((K+J)/se),gt=de*180/Math.PI,at=0,Zt=0,mt=0;featureEach(c,function(nr){var dr=nr.properties[x]||1,Mt=Jr(getCoords(nr),getCoords(N));at+=Math.pow(Mt.x*Math.cos(de)-Mt.y*Math.sin(de),2)*dr,Zt+=Math.pow(Mt.x*Math.sin(de)+Mt.y*Math.cos(de),2)*dr,mt+=dr});var rt=Math.sqrt(2*at/mt),lt=Math.sqrt(2*Zt/mt),Qt=ellipse(N,rt,lt,{units:"degrees",angle:gt,steps:_,properties:w}),Yt=pointsWithinPolygon(c,featureCollection([Qt])),or={meanCenterCoordinates:getCoords(N),semiMajorAxis:rt,semiMinorAxis:lt,numberOfFeatures:P,angle:gt,percentageWithinEllipse:100*coordAll(Yt).length/P};return Qt.properties.standardDeviationalEllipse=or,Qt}function Jr(c,A){return{x:c[0]-A[0],y:c[1]-A[1]}}var Rr=null;function An(c,A,_,x){if(x===void 0&&(x={}),!isObject(x))throw new Error("options is invalid");if(!c)throw new Error("startPoint is required");if(!A)throw new Error("midPoint is required");if(!_)throw new Error("endPoint is required");var w=c,P=A,N=_,V=bearingToAzimuth(x.mercator!==!0?bearing(w,P):rhumbBearing(w,P)),W=bearingToAzimuth(x.mercator!==!0?bearing(N,P):rhumbBearing(N,P)),k=Math.abs(V-W);return x.explementary===!0?360-k:k}var Fr=null;function sn(c,A){var _=[],x=A.iterations||1;if(!c)throw new Error("inputPolys is required");return geomEach(c,function(w,P,N){var V,W,k;switch(w.type){case"Polygon":V=[[]];for(var K=0;K<x;K++)k=[[]],W=w,K>0&&(W=polygon(V).geometry),wr(W,k),V=k.slice(0);_.push(polygon(V,N));break;case"MultiPolygon":V=[[[]]];for(var J=0;J<x;J++)k=[[[]]],W=w,J>0&&(W=multiPolygon(V).geometry),en(W,k),V=k.slice(0);_.push(multiPolygon(V,N));break;default:throw new Error("geometry is invalid, must be Polygon or MultiPolygon")}}),featureCollection(_)}function wr(c,A){var _=0,x=0;coordEach(c,function(w,P,N,V,W){W>_&&(_=W,x=P,A.push([]));var k=P-x,K=c.coordinates[W][k+1],J=w[0],se=w[1],de=K[0],gt=K[1];A[W].push([.75*J+.25*de,.75*se+.25*gt]),A[W].push([.25*J+.75*de,.25*se+.75*gt])},!0),A.forEach(function(w){w.push(w[0])})}function en(c,A){var _=0,x=0,w=0;coordEach(c,function(P,N,V,W,k){W>w&&(w=W,x=N,A.push([[]])),k>_&&(_=k,x=N,A[W].push([]));var K=N-x,J=c.coordinates[W][k][K+1],se=P[0],de=P[1],gt=J[0],at=J[1];A[W][k].push([.75*se+.25*gt,.75*de+.25*at]),A[W][k].push([.25*se+.75*gt,.25*de+.75*at])},!0),A.forEach(function(P){P.forEach(function(N){N.push(N[0])})})}var Nn=null;function hi(c,A,_){_===void 0&&(_=2);var x=getCoord(c),w=getCoord(A),P=x[0]-w[0],N=x[1]-w[1];return _===1?Math.abs(P)+Math.abs(N):Math.pow(Math.pow(P,_)+Math.pow(N,_),1/_)}function an(c,A){A=A||{};var _=A.threshold||1e4,x=A.p||2,w=A.binary||!1,P=A.alpha||-1,N=A.standardization||!1,V=[];featureEach(c,function(de){V.push(centroid(de))});for(var W=[],k=0;k<V.length;k++)W[k]=[];for(var k=0;k<V.length;k++)for(var K=k;K<V.length;K++){k===K&&(W[k][K]=0);var J=hi(V[k],V[K],x);W[k][K]=J,W[K][k]=J}for(var k=0;k<V.length;k++)for(var K=0;K<V.length;K++){var J=W[k][K];J!==0&&(w?J<=_?W[k][K]=1:W[k][K]=0:J<=_?W[k][K]=Math.pow(J,P):W[k][K]=0)}if(N)for(var k=0;k<V.length;k++)for(var se=W[k].reduce(function(gt,at){return gt+at},0),K=0;K<V.length;K++)W[k][K]=W[k][K]/se;return W}function Zr(c,A){var _=A.inputField,x=A.threshold||1e5,w=A.p||2,P=A.binary||!1,N=A.alpha||-1,V=A.standardization||!0,W=spatialWeight(c,{alpha:N,binary:P,p:w,standardization:V,threshold:x}),k=[];featureEach(c,function(In){var Fi=In.properties||{};k.push(Fi[_])});for(var K=Tr(k),J=ai(k),se=0,de=0,gt=0,at=0,Zt=W.length,mt=0;mt<Zt;mt++){for(var rt=0,lt=0;lt<Zt;lt++)se+=W[mt][lt]*(k[mt]-K)*(k[lt]-K),de+=W[mt][lt],gt+=Math.pow(W[mt][lt]+W[lt][mt],2),rt+=W[mt][lt]+W[lt][mt];at+=Math.pow(rt,2)}gt=.5*gt;var Qt=se/de/J,Yt=-1/(Zt-1),or=Zt*Zt*gt-Zt*at+3*(de*de),nr=(Zt-1)*(Zt+1)*(de*de),dr=or/nr-Yt*Yt,Mt=Math.sqrt(dr),vi=(Qt-Yt)/Mt;return{expectedMoranIndex:Yt,moranIndex:Qt,stdNorm:Mt,zNorm:vi}}function Tr(c){for(var A=0,_=0,x=c;_<x.length;_++){var w=x[_];A+=w}return A/c.length}function ai(c){for(var A=Tr(c),_=0,x=0,w=c;x<w.length;x++){var P=w[x];_+=Math.pow(P-A,2)}return _/c.length}function Yn(c,A){return A===void 0&&(A={}),Di(c,"mercator",A)}function Pn(c,A){return A===void 0&&(A={}),Di(c,"wgs84",A)}function Di(c,A,_){_===void 0&&(_={}),_=_||{};var x=_.mutate;if(!c)throw new Error("geojson is required");return Array.isArray(c)&&isNumber(c[0])?c=A==="mercator"?ei(c):qn(c):(x!==!0&&(c=clone(c)),coordEach(c,function(w){var P=A==="mercator"?ei(w):qn(w);w[0]=P[0],w[1]=P[1]})),c}function ei(c){var A=Math.PI/180,_=6378137,x=20037508342789244e-9,w=Math.abs(c[0])<=180?c[0]:c[0]-ga(c[0])*360,P=[_*w*A,_*Math.log(Math.tan(Math.PI*.25+.5*c[1]*A))];return P[0]>x&&(P[0]=x),P[0]<-x&&(P[0]=-x),P[1]>x&&(P[1]=x),P[1]<-x&&(P[1]=-x),P}function qn(c){var A=180/Math.PI,_=6378137;return[c[0]*A/_,(Math.PI*.5-2*Math.atan(Math.exp(-c[1]/_)))*A]}function ga(c){return c<0?-1:c>0?1:0}var Oo=function(){for(var c=0,A=0,_=arguments.length;A<_;A++)c+=arguments[A].length;for(var x=Array(c),w=0,A=0;A<_;A++)for(var P=arguments[A],N=0,V=P.length;N<V;N++,w++)x[w]=P[N];return x};function Wo(c){return Array.isArray(c)?Ns(c):c&&c.bbox?Ns(c.bbox):[qo(),Ko()]}function Xi(c,A){A===void 0&&(A={}),c==null&&(c=1);for(var _=[],x=0;x<c;x++)_.push((0,U.xm)(Wo(A.bbox)));return(0,U.uf)(_)}function Qo(c,A){A===void 0&&(A={}),c==null&&(c=1),(!isNumber(A.num_vertices)||A.num_vertices===void 0)&&(A.num_vertices=10),(!isNumber(A.max_radial_length)||A.max_radial_length===void 0)&&(A.max_radial_length=10);for(var _=[],x=function(P){var N=[],V=Oo(Array(A.num_vertices+1)).map(Math.random);V.forEach(function(W,k,K){K[k]=k>0?W+K[k-1]:W}),V.forEach(function(W){W=W*2*Math.PI/V[V.length-1];var k=Math.random();N.push([k*(A.max_radial_length||10)*Math.sin(W),k*(A.max_radial_length||10)*Math.cos(W)])}),N[N.length-1]=N[0],N=N.map(uo(Wo(A.bbox))),_.push(polygon([N]))},w=0;w<c;w++)x(w);return featureCollection(_)}function eo(c,A){if(A===void 0&&(A={}),A=A||{},!isObject(A))throw new Error("options is invalid");var _=A.bbox,x=A.num_vertices,w=A.max_length,P=A.max_rotation;c==null&&(c=1),(!isNumber(x)||x===void 0||x<2)&&(x=10),(!isNumber(w)||w===void 0)&&(w=1e-4),(!isNumber(P)||P===void 0)&&(P=Math.PI/8);for(var N=[],V=0;V<c;V++){for(var W=Wo(_),k=[W],K=0;K<x-1;K++){var J=K===0?Math.random()*2*Math.PI:Math.tan((k[K][1]-k[K-1][1])/(k[K][0]-k[K-1][0])),se=J+(Math.random()-.5)*P*2,de=Math.random()*w;k.push([k[K][0]+de*Math.cos(se),k[K][1]+de*Math.sin(se)])}N.push(lineString(k))}return featureCollection(N)}function uo(c){return function(A){return[A[0]+c[0],A[1]+c[1]]}}function No(){return Math.random()-.5}function qo(){return No()*360}function Ko(){return No()*180}function Ns(c){return[Math.random()*(c[2]-c[0])+c[0],Math.random()*(c[3]-c[1])+c[1]]}function hs(c,A){if(!c)throw new Error("geojson is required");if(c.type!=="FeatureCollection")throw new Error("geojson must be a FeatureCollection");if(A==null)throw new Error("filter is required");var _=[];return featureEach(c,function(x){Mn(x.properties,A)&&_.push(x)}),featureCollection(_)}function ti(c,A,_){if(!c)throw new Error("geojson is required");if(c.type!=="FeatureCollection")throw new Error("geojson must be a FeatureCollection");if(A==null)throw new Error("property is required");for(var x=pn(c,A),w=Object.keys(x),P=0;P<w.length;P++){for(var N=w[P],V=x[N],W=[],k=0;k<V.length;k++)W.push(c.features[V[k]]);_(featureCollection(W),N,P)}}function to(c,A,_,x){var w=x;return ti(c,A,function(P,N,V){V===0&&x===void 0?w=P:w=_(w,P,N,V)}),w}function pn(c,A){var _={};return featureEach(c,function(x,w){var P=x.properties||{};if(Object.prototype.hasOwnProperty.call(P,String(A))){var N=P[A];Object.prototype.hasOwnProperty.call(_,N)?_[N].push(w):_[N]=[w]}}),_}function Mn(c,A){if(c===void 0)return!1;var _=typeof A;if(_==="number"||_==="string")return Object.prototype.hasOwnProperty.call(c,A);if(Array.isArray(A)){for(var x=0;x<A.length;x++)if(!Mn(c,A[x]))return!1;return!0}else return vn(c,A)}function vn(c,A){for(var _=Object.keys(A),x=0;x<_.length;x++){var w=_[x];if(c[w]!==A[w])return!1}return!0}function si(c,A){if(!A)return{};if(!A.length)return{};for(var _={},x=0;x<A.length;x++){var w=A[x];Object.prototype.hasOwnProperty.call(c,w)&&(_[w]=c[w])}return _}var go=C(94486);function pl(c,A){var _=getGeom(c),x=getGeom(A),w=c.properties||{},P=polygonClipping.difference(_.coordinates,x.coordinates);return P.length===0?null:P.length===1?polygon(P[0],w):multiPolygon(P,w)}var ht=null,Tt=C(46780);function Xt(){return new xt}function xt(){this.reset()}xt.prototype={constructor:xt,reset:function(){this.s=this.t=0},add:function(c){Da(di,c,this.t),Da(this,di.s,this.s),this.s?this.t+=di.t:this.s=di.t},valueOf:function(){return this.s}};var di=new xt;function Da(c,A,_){var x=c.s=A+_,w=x-A,P=x-w;c.t=A-P+(_-w)}var Oe=1e-6,Ve=1e-12,ft=Math.PI,$t=ft/2,tr=ft/4,wt=ft*2,Bt=180/ft,Dt=ft/180,ut=Math.abs,h=Math.atan,f=Math.atan2,d=Math.cos,E=Math.ceil,S=Math.exp,M=Math.floor,O=Math.log,F=Math.pow,$=Math.sin,pe=Math.sign||function(c){return c>0?1:c<0?-1:0},we=Math.sqrt,$e=Math.tan;function At(c){return c>1?0:c<-1?ft:Math.acos(c)}function Rt(c){return c>1?$t:c<-1?-$t:Math.asin(c)}function _t(c){return(c=$(c/2))*c}function zt(){}function xr(c,A){c&&fr.hasOwnProperty(c.type)&&fr[c.type](c,A)}var mr={Feature:function(c,A){xr(c.geometry,A)},FeatureCollection:function(c,A){for(var _=c.features,x=-1,w=_.length;++x<w;)xr(_[x].geometry,A)}},fr={Sphere:function(c,A){A.sphere()},Point:function(c,A){c=c.coordinates,A.point(c[0],c[1],c[2])},MultiPoint:function(c,A){for(var _=c.coordinates,x=-1,w=_.length;++x<w;)c=_[x],A.point(c[0],c[1],c[2])},LineString:function(c,A){ur(c.coordinates,A,0)},MultiLineString:function(c,A){for(var _=c.coordinates,x=-1,w=_.length;++x<w;)ur(_[x],A,0)},Polygon:function(c,A){er(c.coordinates,A)},MultiPolygon:function(c,A){for(var _=c.coordinates,x=-1,w=_.length;++x<w;)er(_[x],A)},GeometryCollection:function(c,A){for(var _=c.geometries,x=-1,w=_.length;++x<w;)xr(_[x],A)}};function ur(c,A,_){var x=-1,w=c.length-_,P;for(A.lineStart();++x<w;)P=c[x],A.point(P[0],P[1],P[2]);A.lineEnd()}function er(c,A){var _=-1,x=c.length;for(A.polygonStart();++_<x;)ur(c[_],A,1);A.polygonEnd()}function Sn(c,A){c&&mr.hasOwnProperty(c.type)?mr[c.type](c,A):xr(c,A)}var wn=Xt(),cn=Xt(),En,Va,Ta,Ca,Li,Ei={point:zt,lineStart:zt,lineEnd:zt,polygonStart:function(){wn.reset(),Ei.lineStart=_i,Ei.lineEnd=ro},polygonEnd:function(){var c=+wn;cn.add(c<0?wt+c:c),this.lineStart=this.lineEnd=this.point=zt},sphere:function(){cn.add(wt)}};function _i(){Ei.point=Yi}function ro(){lo(En,Va)}function Yi(c,A){Ei.point=lo,En=c,Va=A,c*=Dt,A*=Dt,Ta=c,Ca=d(A=A/2+tr),Li=$(A)}function lo(c,A){c*=Dt,A*=Dt,A=A/2+tr;var _=c-Ta,x=_>=0?1:-1,w=x*_,P=d(A),N=$(A),V=Li*N,W=Ca*P+V*d(w),k=V*x*$(w);wn.add(f(k,W)),Ta=c,Ca=P,Li=N}function Ju(c){return cn.reset(),stream(c,Ei),cn*2}function jh(c){return[f(c[1],c[0]),Rt(c[2])]}function Zp(c){var A=c[0],_=c[1],x=d(_);return[x*d(A),x*$(A),$(_)]}function jd(c,A){return c[0]*A[0]+c[1]*A[1]+c[2]*A[2]}function MA(c,A){return[c[1]*A[2]-c[2]*A[1],c[2]*A[0]-c[0]*A[2],c[0]*A[1]-c[1]*A[0]]}function W_(c,A){c[0]+=A[0],c[1]+=A[1],c[2]+=A[2]}function $c(c,A){return[c[0]*A,c[1]*A,c[2]*A]}function Gf(c){var A=we(c[0]*c[0]+c[1]*c[1]+c[2]*c[2]);c[0]/=A,c[1]/=A,c[2]/=A}var Do,rc,Jo,dl,Sf,zp,Xd,uh,Xh=Xt(),l0,Vf,xf={point:Gp,lineStart:Vp,lineEnd:$d,polygonStart:function(){xf.point=Qd,xf.lineStart=$g,xf.lineEnd=Qg,Xh.reset(),Ei.polygonStart()},polygonEnd:function(){Ei.polygonEnd(),xf.point=Gp,xf.lineStart=Vp,xf.lineEnd=$d,wn<0?(Do=-(Jo=180),rc=-(dl=90)):Xh>Oe?dl=90:Xh<-Oe&&(rc=-90),Vf[0]=Do,Vf[1]=Jo}};function Gp(c,A){l0.push(Vf=[Do=c,Jo=c]),A<rc&&(rc=A),A>dl&&(dl=A)}function Yd(c,A){var _=Zp([c*Dt,A*Dt]);if(uh){var x=MA(uh,_),w=[x[1],-x[0],0],P=MA(w,x);Gf(P),P=jh(P);var N=c-Sf,V=N>0?1:-1,W=P[0]*Bt*V,k,K=ut(N)>180;K^(V*Sf<W&&W<V*c)?(k=P[1]*Bt,k>dl&&(dl=k)):(W=(W+360)%360-180,K^(V*Sf<W&&W<V*c)?(k=-P[1]*Bt,k<rc&&(rc=k)):(A<rc&&(rc=A),A>dl&&(dl=A))),K?c<Sf?nc(Do,c)>nc(Do,Jo)&&(Jo=c):nc(c,Jo)>nc(Do,Jo)&&(Do=c):Jo>=Do?(c<Do&&(Do=c),c>Jo&&(Jo=c)):c>Sf?nc(Do,c)>nc(Do,Jo)&&(Jo=c):nc(c,Jo)>nc(Do,Jo)&&(Do=c)}else l0.push(Vf=[Do=c,Jo=c]);A<rc&&(rc=A),A>dl&&(dl=A),uh=_,Sf=c}function Vp(){xf.point=Yd}function $d(){Vf[0]=Do,Vf[1]=Jo,xf.point=Gp,uh=null}function Qd(c,A){if(uh){var _=c-Sf;Xh.add(ut(_)>180?_+(_>0?360:-360):_)}else zp=c,Xd=A;Ei.point(c,A),Yd(c,A)}function $g(){Ei.lineStart()}function Qg(){Qd(zp,Xd),Ei.lineEnd(),ut(Xh)>Oe&&(Do=-(Jo=180)),Vf[0]=Do,Vf[1]=Jo,uh=null}function nc(c,A){return(A-=c)<0?A+360:A}function qd(c,A){return c[0]-A[0]}function wA(c,A){return c[0]<=c[1]?c[0]<=A&&A<=c[1]:A<c[0]||c[1]<A}function j_(c){var A,_,x,w,P,N,V;if(dl=Jo=-(Do=rc=1/0),l0=[],stream(c,xf),_=l0.length){for(l0.sort(qd),A=1,x=l0[0],P=[x];A<_;++A)w=l0[A],wA(x,w[0])||wA(x,w[1])?(nc(x[0],w[1])>nc(x[0],x[1])&&(x[1]=w[1]),nc(w[0],x[1])>nc(x[0],x[1])&&(x[0]=w[0])):P.push(x=w);for(N=-1/0,_=P.length-1,A=0,x=P[_];A<=_;x=w,++A)w=P[A],(V=nc(x[1],w[0]))>N&&(N=V,Do=w[0],Jo=x[1])}return l0=Vf=null,Do===1/0||rc===1/0?[[NaN,NaN],[NaN,NaN]]:[[Do,rc],[Jo,dl]]}var Yh,$h,IA,PA,Qh,OA,NA,DA,Hp,LA,Wp,Kd,Jd,Bu,vl,gl,Tc={sphere:zt,point:FA,lineStart:Kh,lineEnd:rv,polygonStart:function(){Tc.lineStart=qg,Tc.lineEnd=nv},polygonEnd:function(){Tc.lineStart=Kh,Tc.lineEnd=rv}};function FA(c,A){c*=Dt,A*=Dt;var _=d(A);qh(_*d(c),_*$(c),$(A))}function qh(c,A,_){++Yh,IA+=(c-IA)/Yh,PA+=(A-PA)/Yh,Qh+=(_-Qh)/Yh}function Kh(){Tc.point=ev}function ev(c,A){c*=Dt,A*=Dt;var _=d(A);Bu=_*d(c),vl=_*$(c),gl=$(A),Tc.point=tv,qh(Bu,vl,gl)}function tv(c,A){c*=Dt,A*=Dt;var _=d(A),x=_*d(c),w=_*$(c),P=$(A),N=f(we((N=vl*P-gl*w)*N+(N=gl*x-Bu*P)*N+(N=Bu*w-vl*x)*N),Bu*x+vl*w+gl*P);$h+=N,OA+=N*(Bu+(Bu=x)),NA+=N*(vl+(vl=w)),DA+=N*(gl+(gl=P)),qh(Bu,vl,gl)}function rv(){Tc.point=FA}function qg(){Tc.point=Kg}function nv(){iv(Kd,Jd),Tc.point=FA}function Kg(c,A){Kd=c,Jd=A,c*=Dt,A*=Dt,Tc.point=iv;var _=d(A);Bu=_*d(c),vl=_*$(c),gl=$(A),qh(Bu,vl,gl)}function iv(c,A){c*=Dt,A*=Dt;var _=d(A),x=_*d(c),w=_*$(c),P=$(A),N=vl*P-gl*w,V=gl*x-Bu*P,W=Bu*w-vl*x,k=we(N*N+V*V+W*W),K=Rt(k),J=k&&-K/k;Hp+=J*N,LA+=J*V,Wp+=J*W,$h+=K,OA+=K*(Bu+(Bu=x)),NA+=K*(vl+(vl=w)),DA+=K*(gl+(gl=P)),qh(Bu,vl,gl)}function Jg(c){Yh=$h=IA=PA=Qh=OA=NA=DA=Hp=LA=Wp=0,stream(c,Tc);var A=Hp,_=LA,x=Wp,w=A*A+_*_+x*x;return w<epsilon2&&(A=OA,_=NA,x=DA,$h<epsilon&&(A=IA,_=PA,x=Qh),w=A*A+_*_+x*x,w<epsilon2)?[NaN,NaN]:[atan2(_,A)*degrees,asin(x/sqrt(w))*degrees]}function BA(c,A){return[c>ft?c-wt:c<-ft?c+wt:c,A]}BA.invert=BA;function em(c,A,_){return(c%=tau)?A||_?compose(Xp(c),av(A,_)):Xp(c):A||_?av(A,_):BA}function jp(c){return function(A,_){return A+=c,[A>pi?A-tau:A<-pi?A+tau:A,_]}}function Xp(c){var A=jp(c);return A.invert=jp(-c),A}function av(c,A){var _=cos(c),x=sin(c),w=cos(A),P=sin(A);function N(V,W){var k=cos(W),K=cos(V)*k,J=sin(V)*k,se=sin(W),de=se*_+K*x;return[atan2(J*w-de*P,K*_-se*x),asin(de*w+J*P)]}return N.invert=function(V,W){var k=cos(W),K=cos(V)*k,J=sin(V)*k,se=sin(W),de=se*w-J*P;return[atan2(J*w+se*P,K*_+de*x),asin(de*_-K*x)]},N}function D0(c){c=em(c[0]*radians,c[1]*radians,c.length>2?c[2]*radians:0);function A(_){return _=c(_[0]*radians,_[1]*radians),_[0]*=degrees,_[1]*=degrees,_}return A.invert=function(_){return _=c.invert(_[0]*radians,_[1]*radians),_[0]*=degrees,_[1]*=degrees,_},A}function L0(c,A,_,x,w,P){if(_){var N=cos(A),V=sin(A),W=x*_;w==null?(w=A+x*tau,P=A-W/2):(w=Jh(N,w),P=Jh(N,P),(x>0?w<P:w>P)&&(w+=x*tau));for(var k,K=w;x>0?K>P:K<P;K-=W)k=spherical([N,-V*cos(K),-V*sin(K)]),c.point(k[0],k[1])}}function Jh(c,A){A=cartesian(A),A[0]-=c,cartesianNormalizeInPlace(A);var _=acos(-A[1]);return((-A[2]<0?-_:_)+tau-epsilon)%tau}function xu(){var c=constant([0,0]),A=constant(90),_=constant(6),x,w,P={point:N};function N(W,k){x.push(W=w(W,k)),W[0]*=degrees,W[1]*=degrees}function V(){var W=c.apply(this,arguments),k=A.apply(this,arguments)*radians,K=_.apply(this,arguments)*radians;return x=[],w=rotateRadians(-W[0]*radians,-W[1]*radians,0).invert,L0(P,k,K,1),W={type:"Polygon",coordinates:[x]},x=w=null,W}return V.center=function(W){return arguments.length?(c=typeof W=="function"?W:constant([+W[0],+W[1]]),V):c},V.radius=function(W){return arguments.length?(A=typeof W=="function"?W:constant(+W),V):A},V.precision=function(W){return arguments.length?(_=typeof W=="function"?W:constant(+W),V):_},V}function tm(c,A){return ut(c[0]-A[0])<Oe&&ut(c[1]-A[1])<Oe}function kA(c,A,_,x){this.x=c,this.z=A,this.o=_,this.e=x,this.v=!1,this.n=this.p=null}function ov(c,A,_,x,w){var P=[],N=[],V,W;if(c.forEach(function(gt){if(!((at=gt.length-1)<=0)){var at,Zt=gt[0],mt=gt[at],rt;if(tm(Zt,mt)){for(w.lineStart(),V=0;V<at;++V)w.point((Zt=gt[V])[0],Zt[1]);w.lineEnd();return}P.push(rt=new kA(Zt,gt,null,!0)),N.push(rt.o=new kA(Zt,null,rt,!1)),P.push(rt=new kA(mt,gt,null,!1)),N.push(rt.o=new kA(mt,null,rt,!0))}}),!!P.length){for(N.sort(A),Yp(P),Yp(N),V=0,W=N.length;V<W;++V)N[V].e=_=!_;for(var k=P[0],K,J;;){for(var se=k,de=!0;se.v;)if((se=se.n)===k)return;K=se.z,w.lineStart();do{if(se.v=se.o.v=!0,se.e){if(de)for(V=0,W=K.length;V<W;++V)w.point((J=K[V])[0],J[1]);else x(se.x,se.n.x,1,w);se=se.n}else{if(de)for(K=se.p.z,V=K.length-1;V>=0;--V)w.point((J=K[V])[0],J[1]);else x(se.x,se.p.x,-1,w);se=se.p}se=se.o,K=se.z,de=!de}while(!se.v);w.lineEnd()}}}function Yp(c){if(A=c.length){for(var A,_=0,x=c[0],w;++_<A;)x.n=w=c[_],w.p=x,x=w;x.n=w=c[0],w.p=x}}var rm=C(57965),eA=1e9,UA=-eA;function nm(c,A,_,x){function w(k,K){return c<=k&&k<=_&&A<=K&&K<=x}function P(k,K,J,se){var de=0,gt=0;if(k==null||(de=N(k,J))!==(gt=N(K,J))||W(k,K)<0^J>0)do se.point(de===0||de===3?c:_,de>1?x:A);while((de=(de+J+4)%4)!==gt);else se.point(K[0],K[1])}function N(k,K){return abs(k[0]-c)<epsilon?K>0?0:3:abs(k[0]-_)<epsilon?K>0?2:1:abs(k[1]-A)<epsilon?K>0?1:0:K>0?3:2}function V(k,K){return W(k.x,K.x)}function W(k,K){var J=N(k,1),se=N(K,1);return J!==se?J-se:J===0?K[1]-k[1]:J===1?k[0]-K[0]:J===2?k[1]-K[1]:K[0]-k[0]}return function(k){var K=k,J=clipBuffer(),se,de,gt,at,Zt,mt,rt,lt,Qt,Yt,or,nr={point:dr,lineStart:Fi,lineEnd:aa,polygonStart:vi,polygonEnd:In};function dr(Ai,Gn){w(Ai,Gn)&&K.point(Ai,Gn)}function Mt(){for(var Ai=0,Gn=0,za=de.length;Gn<za;++Gn)for(var La=de[Gn],ha=1,el=La.length,tu=La[0],Tu,co,So=tu[0],es=tu[1];ha<el;++ha)Tu=So,co=es,tu=La[ha],So=tu[0],es=tu[1],co<=x?es>x&&(So-Tu)*(x-co)>(es-co)*(c-Tu)&&++Ai:es<=x&&(So-Tu)*(x-co)<(es-co)*(c-Tu)&&--Ai;return Ai}function vi(){K=J,se=[],de=[],or=!0}function In(){var Ai=Mt(),Gn=or&&Ai,za=(se=merge(se)).length;(Gn||za)&&(k.polygonStart(),Gn&&(k.lineStart(),P(null,null,1,k),k.lineEnd()),za&&clipPolygon(se,V,Ai,P,k),k.polygonEnd()),K=k,se=de=gt=null}function Fi(){nr.point=un,de&&de.push(gt=[]),Yt=!0,Qt=!1,rt=lt=NaN}function aa(){se&&(un(at,Zt),mt&&Qt&&J.rejoin(),se.push(J.result())),nr.point=dr,Qt&&K.lineEnd()}function un(Ai,Gn){var za=w(Ai,Gn);if(de&&gt.push([Ai,Gn]),Yt)at=Ai,Zt=Gn,mt=za,Yt=!1,za&&(K.lineStart(),K.point(Ai,Gn));else if(za&&Qt)K.point(Ai,Gn);else{var La=[rt=Math.max(UA,Math.min(eA,rt)),lt=Math.max(UA,Math.min(eA,lt))],ha=[Ai=Math.max(UA,Math.min(eA,Ai)),Gn=Math.max(UA,Math.min(eA,Gn))];clipLine(La,ha,c,A,_,x)?(Qt||(K.lineStart(),K.point(La[0],La[1])),K.point(ha[0],ha[1]),za||K.lineEnd(),or=!1):za&&(K.lineStart(),K.point(Ai,Gn),or=!1)}rt=Ai,lt=Gn,Qt=za}return nr}}function fa(){var c=0,A=0,_=960,x=500,w,P,N;return N={stream:function(V){return w&&P===V?w:w=nm(c,A,_,x)(P=V)},extent:function(V){return arguments.length?(c=+V[0][0],A=+V[0][1],_=+V[1][0],x=+V[1][1],w=P=null,N):[[c,A],[_,x]]}}}var Ji=Xt();function $p(c,A){var _=A[0],x=A[1],w=[$(_),-d(_),0],P=0,N=0;Ji.reset();for(var V=0,W=c.length;V<W;++V)if(K=(k=c[V]).length)for(var k,K,J=k[K-1],se=J[0],de=J[1]/2+tr,gt=$(de),at=d(de),Zt=0;Zt<K;++Zt,se=rt,gt=Qt,at=Yt,J=mt){var mt=k[Zt],rt=mt[0],lt=mt[1]/2+tr,Qt=$(lt),Yt=d(lt),or=rt-se,nr=or>=0?1:-1,dr=nr*or,Mt=dr>ft,vi=gt*Qt;if(Ji.add(f(vi*nr*$(dr),at*Yt+vi*d(dr))),P+=Mt?or+nr*wt:or,Mt^se>=_^rt>=_){var In=MA(Zp(J),Zp(mt));Gf(In);var Fi=MA(w,In);Gf(Fi);var aa=(Mt^or>=0?-1:1)*Rt(Fi[2]);(x>aa||x===aa&&(In[0]||In[1]))&&(N+=Mt^or>=0?1:-1)}}return(P<-Oe||P<Oe&&Ji<-Oe)^N&1}var sv=Xt(),Qp,qp,Kp,tA={sphere:zt,point:zt,lineStart:X_,lineEnd:zt,polygonStart:zt,polygonEnd:zt};function X_(){tA.point=$_,tA.lineEnd=Y_}function Y_(){tA.point=tA.lineEnd=zt}function $_(c,A){c*=Dt,A*=Dt,Qp=c,qp=$(A),Kp=d(A),tA.point=Q_}function Q_(c,A){c*=Dt,A*=Dt;var _=$(A),x=d(A),w=ut(c-Qp),P=d(w),N=$(w),V=x*N,W=Kp*_-qp*x*P,k=qp*_+Kp*x*P;sv.add(f(we(V*V+W*W),k)),Qp=c,qp=_,Kp=x}function q_(c){return sv.reset(),Sn(c,tA),+sv}var uv=[null,null],K_={type:"LineString",coordinates:uv};function Jp(c,A){return uv[0]=c,uv[1]=A,q_(K_)}var lv={Feature:function(c,A){return ed(c.geometry,A)},FeatureCollection:function(c,A){for(var _=c.features,x=-1,w=_.length;++x<w;)if(ed(_[x].geometry,A))return!0;return!1}},im={Sphere:function(){return!0},Point:function(c,A){return am(c.coordinates,A)},MultiPoint:function(c,A){for(var _=c.coordinates,x=-1,w=_.length;++x<w;)if(am(_[x],A))return!0;return!1},LineString:function(c,A){return om(c.coordinates,A)},MultiLineString:function(c,A){for(var _=c.coordinates,x=-1,w=_.length;++x<w;)if(om(_[x],A))return!0;return!1},Polygon:function(c,A){return sm(c.coordinates,A)},MultiPolygon:function(c,A){for(var _=c.coordinates,x=-1,w=_.length;++x<w;)if(sm(_[x],A))return!0;return!1},GeometryCollection:function(c,A){for(var _=c.geometries,x=-1,w=_.length;++x<w;)if(ed(_[x],A))return!0;return!1}};function ed(c,A){return c&&im.hasOwnProperty(c.type)?im[c.type](c,A):!1}function am(c,A){return Jp(c,A)===0}function om(c,A){var _=Jp(c[0],c[1]),x=Jp(c[0],A),w=Jp(A,c[1]);return x+w<=_+Oe}function sm(c,A){return!!$p(c.map(J_),um(A))}function J_(c){return c=c.map(um),c.pop(),c}function um(c){return[c[0]*Dt,c[1]*Dt]}function lT(c,A){return(c&&lv.hasOwnProperty(c.type)?lv[c.type]:ed)(c,A)}function lm(c,A,_){var x=range(c,A-epsilon,_).concat(A);return function(w){return x.map(function(P){return[w,P]})}}function cm(c,A,_){var x=range(c,A-epsilon,_).concat(A);return function(w){return x.map(function(P){return[P,w]})}}function ey(){var c,A,_,x,w,P,N,V,W=10,k=W,K=90,J=360,se,de,gt,at,Zt=2.5;function mt(){return{type:"MultiLineString",coordinates:rt()}}function rt(){return range(ceil(x/K)*K,_,K).map(gt).concat(range(ceil(V/J)*J,N,J).map(at)).concat(range(ceil(A/W)*W,c,W).filter(function(lt){return abs(lt%K)>epsilon}).map(se)).concat(range(ceil(P/k)*k,w,k).filter(function(lt){return abs(lt%J)>epsilon}).map(de))}return mt.lines=function(){return rt().map(function(lt){return{type:"LineString",coordinates:lt}})},mt.outline=function(){return{type:"Polygon",coordinates:[gt(x).concat(at(N).slice(1),gt(_).reverse().slice(1),at(V).reverse().slice(1))]}},mt.extent=function(lt){return arguments.length?mt.extentMajor(lt).extentMinor(lt):mt.extentMinor()},mt.extentMajor=function(lt){return arguments.length?(x=+lt[0][0],_=+lt[1][0],V=+lt[0][1],N=+lt[1][1],x>_&&(lt=x,x=_,_=lt),V>N&&(lt=V,V=N,N=lt),mt.precision(Zt)):[[x,V],[_,N]]},mt.extentMinor=function(lt){return arguments.length?(A=+lt[0][0],c=+lt[1][0],P=+lt[0][1],w=+lt[1][1],A>c&&(lt=A,A=c,c=lt),P>w&&(lt=P,P=w,w=lt),mt.precision(Zt)):[[A,P],[c,w]]},mt.step=function(lt){return arguments.length?mt.stepMajor(lt).stepMinor(lt):mt.stepMinor()},mt.stepMajor=function(lt){return arguments.length?(K=+lt[0],J=+lt[1],mt):[K,J]},mt.stepMinor=function(lt){return arguments.length?(W=+lt[0],k=+lt[1],mt):[W,k]},mt.precision=function(lt){return arguments.length?(Zt=+lt,se=lm(P,w,90),de=cm(A,c,Zt),gt=lm(V,N,90),at=cm(x,_,Zt),mt):Zt},mt.extentMajor([[-180,-90+epsilon],[180,90-epsilon]]).extentMinor([[-180,-80-epsilon],[180,80+epsilon]])}function cT(){return ey()()}function cv(c,A){var _=c[0]*radians,x=c[1]*radians,w=A[0]*radians,P=A[1]*radians,N=cos(x),V=sin(x),W=cos(P),k=sin(P),K=N*cos(_),J=N*sin(_),se=W*cos(w),de=W*sin(w),gt=2*asin(sqrt(haversin(P-x)+N*W*haversin(w-_))),at=sin(gt),Zt=gt?function(mt){var rt=sin(mt*=gt)/at,lt=sin(gt-mt)/at,Qt=lt*K+rt*se,Yt=lt*J+rt*de,or=lt*V+rt*k;return[atan2(Yt,Qt)*degrees,atan2(or,sqrt(Qt*Qt+Yt*Yt))*degrees]}:function(){return[_*degrees,x*degrees]};return Zt.distance=gt,Zt}var fv=Xt(),hv=Xt(),fm,hm,Av,pv,lh={point:zt,lineStart:zt,lineEnd:zt,polygonStart:function(){lh.lineStart=ty,lh.lineEnd=ny},polygonEnd:function(){lh.lineStart=lh.lineEnd=lh.point=zt,fv.add(ut(hv)),hv.reset()},result:function(){var c=fv/2;return fv.reset(),c}};function ty(){lh.point=ry}function ry(c,A){lh.point=Am,fm=Av=c,hm=pv=A}function Am(c,A){hv.add(pv*c-Av*A),Av=c,pv=A}function ny(){Am(fm,hm)}var fT=null,rA=1/0,ch=rA,nA=-rA,iA=nA,pm={point:c0,lineStart:zt,lineEnd:zt,polygonStart:zt,polygonEnd:zt,result:function(){var c=[[rA,ch],[nA,iA]];return nA=iA=-(ch=rA=1/0),c}};function c0(c,A){c<rA&&(rA=c),c>nA&&(nA=c),A<ch&&(ch=A),A>iA&&(iA=A)}var fh=null,ZA=0,zA=0,hh=0,Ah=0,aA=0,ph=0,td=0,GA=0,dh=0,dv,vv,Tf,Cf,kl={point:Vs,lineStart:rd,lineEnd:VA,polygonStart:function(){kl.lineStart=_v,kl.lineEnd=dm},polygonEnd:function(){kl.point=Vs,kl.lineStart=rd,kl.lineEnd=VA},result:function(){var c=dh?[td/dh,GA/dh]:ph?[Ah/ph,aA/ph]:hh?[ZA/hh,zA/hh]:[NaN,NaN];return ZA=zA=hh=Ah=aA=ph=td=GA=dh=0,c}};function Vs(c,A){ZA+=c,zA+=A,++hh}function rd(){kl.point=gv}function gv(c,A){kl.point=mv,Vs(Tf=c,Cf=A)}function mv(c,A){var _=c-Tf,x=A-Cf,w=we(_*_+x*x);Ah+=w*(Tf+c)/2,aA+=w*(Cf+A)/2,ph+=w,Vs(Tf=c,Cf=A)}function VA(){kl.point=Vs}function _v(){kl.point=vm}function dm(){yv(dv,vv)}function vm(c,A){kl.point=yv,Vs(dv=Tf=c,vv=Cf=A)}function yv(c,A){var _=c-Tf,x=A-Cf,w=we(_*_+x*x);Ah+=w*(Tf+c)/2,aA+=w*(Cf+A)/2,ph+=w,w=Cf*c-Tf*A,td+=w*(Tf+c),GA+=w*(Cf+A),dh+=w*3,Vs(Tf=c,Cf=A)}var iy=null;function gm(c){this._context=c}gm.prototype={_radius:4.5,pointRadius:function(c){return this._radius=c,this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){this._line===0&&this._context.closePath(),this._point=NaN},point:function(c,A){switch(this._point){case 0:{this._context.moveTo(c,A),this._point=1;break}case 1:{this._context.lineTo(c,A);break}default:{this._context.moveTo(c+this._radius,A),this._context.arc(c,A,this._radius,0,wt);break}}},result:zt};var nd=Xt(),id,Fe,ad,vh,gh,HA={point:zt,lineStart:function(){HA.point=Ev},lineEnd:function(){id&&od(Fe,ad),HA.point=zt},polygonStart:function(){id=!0},polygonEnd:function(){id=null},result:function(){var c=+nd;return nd.reset(),c}};function Ev(c,A){HA.point=od,Fe=vh=c,ad=gh=A}function od(c,A){vh-=c,gh-=A,nd.add(we(vh*vh+gh*gh)),vh=c,gh=A}var mm=null;function F0(){this._string=[]}F0.prototype={_radius:4.5,_circle:sd(4.5),pointRadius:function(c){return(c=+c)!==this._radius&&(this._radius=c,this._circle=null),this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){this._line===0&&this._string.push("Z"),this._point=NaN},point:function(c,A){switch(this._point){case 0:{this._string.push("M",c,",",A),this._point=1;break}case 1:{this._string.push("L",c,",",A);break}default:{this._circle==null&&(this._circle=sd(this._radius)),this._string.push("M",c,",",A,this._circle);break}}},result:function(){if(this._string.length){var c=this._string.join("");return this._string=[],c}else return null}};function sd(c){return"m0,"+c+"a"+c+","+c+" 0 1,1 0,"+-2*c+"a"+c+","+c+" 0 1,1 0,"+2*c+"z"}function _m(c,A){var _=4.5,x,w;function P(N){return N&&(typeof _=="function"&&w.pointRadius(+_.apply(this,arguments)),stream(N,x(w))),w.result()}return P.area=function(N){return stream(N,x(pathArea)),pathArea.result()},P.measure=function(N){return stream(N,x(pathMeasure)),pathMeasure.result()},P.bounds=function(N){return stream(N,x(pathBounds)),pathBounds.result()},P.centroid=function(N){return stream(N,x(pathCentroid)),pathCentroid.result()},P.projection=function(N){return arguments.length?(x=N==null?(c=null,identity):(c=N).stream,P):c},P.context=function(N){return arguments.length?(w=N==null?(A=null,new PathString):new PathContext(A=N),typeof _!="function"&&w.pointRadius(_),P):A},P.pointRadius=function(N){return arguments.length?(_=typeof N=="function"?N:(w.pointRadius(+N),+N),P):_},P.projection(c).context(A)}function Sv(){var c=[],A;return{point:function(_,x){A.push([_,x])},lineStart:function(){c.push(A=[])},lineEnd:zt,rejoin:function(){c.length>1&&c.push(c.pop().concat(c.shift()))},result:function(){var _=c;return c=[],A=null,_}}}function xv(c,A,_,x){return function(w,P){var N=A(P),V=w.invert(x[0],x[1]),W=Sv(),k=A(W),K=!1,J,se,de,gt={point:at,lineStart:mt,lineEnd:rt,polygonStart:function(){gt.point=lt,gt.lineStart=Qt,gt.lineEnd=Yt,se=[],J=[]},polygonEnd:function(){gt.point=at,gt.lineStart=mt,gt.lineEnd=rt,se=(0,rm.TS)(se);var or=$p(J,V);se.length?(K||(P.polygonStart(),K=!0),ov(se,ym,or,_,P)):or&&(K||(P.polygonStart(),K=!0),P.lineStart(),_(null,null,1,P),P.lineEnd()),K&&(P.polygonEnd(),K=!1),se=J=null},sphere:function(){P.polygonStart(),P.lineStart(),_(null,null,1,P),P.lineEnd(),P.polygonEnd()}};function at(or,nr){var dr=w(or,nr);c(or=dr[0],nr=dr[1])&&P.point(or,nr)}function Zt(or,nr){var dr=w(or,nr);N.point(dr[0],dr[1])}function mt(){gt.point=Zt,N.lineStart()}function rt(){gt.point=at,N.lineEnd()}function lt(or,nr){de.push([or,nr]);var dr=w(or,nr);k.point(dr[0],dr[1])}function Qt(){k.lineStart(),de=[]}function Yt(){lt(de[0][0],de[0][1]),k.lineEnd();var or=k.clean(),nr=W.result(),dr,Mt=nr.length,vi,In,Fi;if(de.pop(),J.push(de),de=null,!!Mt){if(or&1){if(In=nr[0],(vi=In.length-1)>0){for(K||(P.polygonStart(),K=!0),P.lineStart(),dr=0;dr<vi;++dr)P.point((Fi=In[dr])[0],Fi[1]);P.lineEnd()}return}Mt>1&&or&2&&nr.push(nr.pop().concat(nr.shift())),se.push(nr.filter(Tv))}}return gt}}function Tv(c){return c.length>1}function ym(c,A){return((c=c.x)[0]<0?c[1]-$t-Oe:$t-c[1])-((A=A.x)[0]<0?A[1]-$t-Oe:$t-A[1])}var ay=xv(function(){return!0},Cv,Rv,[-ft,-$t]);function Cv(c){var A=NaN,_=NaN,x=NaN,w;return{lineStart:function(){c.lineStart(),w=1},point:function(P,N){var V=P>0?ft:-ft,W=ut(P-A);ut(W-ft)<Oe?(c.point(A,_=(_+N)/2>0?$t:-$t),c.point(x,_),c.lineEnd(),c.lineStart(),c.point(V,_),c.point(P,_),w=0):x!==V&&W>=ft&&(ut(A-x)<Oe&&(A-=x*Oe),ut(P-V)<Oe&&(P-=V*Oe),_=bv(A,_,P,N),c.point(x,_),c.lineEnd(),c.lineStart(),c.point(V,_),w=0),c.point(A=P,_=N),x=V},lineEnd:function(){c.lineEnd(),A=_=NaN},clean:function(){return 2-w}}}function bv(c,A,_,x){var w,P,N=$(c-_);return ut(N)>Oe?h(($(A)*(P=d(x))*$(_)-$(x)*(w=d(A))*$(c))/(w*P*N)):(A+x)/2}function Rv(c,A,_,x){var w;if(c==null)w=_*$t,x.point(-ft,w),x.point(0,w),x.point(ft,w),x.point(ft,0),x.point(ft,-w),x.point(0,-w),x.point(-ft,-w),x.point(-ft,0),x.point(-ft,w);else if(ut(c[0]-A[0])>Oe){var P=c[0]<A[0]?ft:-ft;w=_*P/2,x.point(-P,w),x.point(0,w),x.point(P,w)}else x.point(A[0],A[1])}function Em(c,A){var _=cos(c),x=_>0,w=abs(_)>epsilon;function P(K,J,se,de){circleStream(de,c,A,se,K,J)}function N(K,J){return cos(K)*cos(J)>_}function V(K){var J,se,de,gt,at;return{lineStart:function(){gt=de=!1,at=1},point:function(Zt,mt){var rt=[Zt,mt],lt,Qt=N(Zt,mt),Yt=x?Qt?0:k(Zt,mt):Qt?k(Zt+(Zt<0?pi:-pi),mt):0;if(!J&&(gt=de=Qt)&&K.lineStart(),Qt!==de&&(lt=W(J,rt),(!lt||pointEqual(J,lt)||pointEqual(rt,lt))&&(rt[0]+=epsilon,rt[1]+=epsilon,Qt=N(rt[0],rt[1]))),Qt!==de)at=0,Qt?(K.lineStart(),lt=W(rt,J),K.point(lt[0],lt[1])):(lt=W(J,rt),K.point(lt[0],lt[1]),K.lineEnd()),J=lt;else if(w&&J&&x^Qt){var or;!(Yt&se)&&(or=W(rt,J,!0))&&(at=0,x?(K.lineStart(),K.point(or[0][0],or[0][1]),K.point(or[1][0],or[1][1]),K.lineEnd()):(K.point(or[1][0],or[1][1]),K.lineEnd(),K.lineStart(),K.point(or[0][0],or[0][1])))}Qt&&(!J||!pointEqual(J,rt))&&K.point(rt[0],rt[1]),J=rt,de=Qt,se=Yt},lineEnd:function(){de&&K.lineEnd(),J=null},clean:function(){return at|(gt&&de)<<1}}}function W(K,J,se){var de=cartesian(K),gt=cartesian(J),at=[1,0,0],Zt=cartesianCross(de,gt),mt=cartesianDot(Zt,Zt),rt=Zt[0],lt=mt-rt*rt;if(!lt)return!se&&K;var Qt=_*mt/lt,Yt=-_*rt/lt,or=cartesianCross(at,Zt),nr=cartesianScale(at,Qt),dr=cartesianScale(Zt,Yt);cartesianAddInPlace(nr,dr);var Mt=or,vi=cartesianDot(nr,Mt),In=cartesianDot(Mt,Mt),Fi=vi*vi-In*(cartesianDot(nr,nr)-1);if(!(Fi<0)){var aa=sqrt(Fi),un=cartesianScale(Mt,(-vi-aa)/In);if(cartesianAddInPlace(un,nr),un=spherical(un),!se)return un;var Ai=K[0],Gn=J[0],za=K[1],La=J[1],ha;Gn<Ai&&(ha=Ai,Ai=Gn,Gn=ha);var el=Gn-Ai,tu=abs(el-pi)<epsilon,Tu=tu||el<epsilon;if(!tu&&La<za&&(ha=za,za=La,La=ha),Tu?tu?za+La>0^un[1]<(abs(un[0]-Ai)<epsilon?za:La):za<=un[1]&&un[1]<=La:el>pi^(Ai<=un[0]&&un[0]<=Gn)){var co=cartesianScale(Mt,(-vi+aa)/In);return cartesianAddInPlace(co,nr),[un,spherical(co)]}}}function k(K,J){var se=x?c:pi-c,de=0;return K<-se?de|=1:K>se&&(de|=2),J<-se?de|=4:J>se&&(de|=8),de}return clip(N,V,P,x?[0,-c]:[-pi,c-pi])}function Sm(c){return{stream:mh(c)}}function mh(c){return function(A){var _=new WA;for(var x in c)_[x]=c[x];return _.stream=A,_}}function WA(){}WA.prototype={constructor:WA,point:function(c,A){this.stream.point(c,A)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};function Mv(c,A,_){var x=A[1][0]-A[0][0],w=A[1][1]-A[0][1],P=c.clipExtent&&c.clipExtent();c.scale(150).translate([0,0]),P!=null&&c.clipExtent(null),geoStream(_,c.stream(boundsStream));var N=boundsStream.result(),V=Math.min(x/(N[1][0]-N[0][0]),w/(N[1][1]-N[0][1])),W=+A[0][0]+(x-V*(N[1][0]+N[0][0]))/2,k=+A[0][1]+(w-V*(N[1][1]+N[0][1]))/2;return P!=null&&c.clipExtent(P),c.scale(V*150).translate([W,k])}function xm(c,A,_){return Mv(c,[[0,0],A],_)}var jA=16,Tm=d(30*Dt);function Cm(c,A){return+A?Rm(c,A):bm(c)}function bm(c){return transformer({point:function(A,_){A=c(A,_),this.stream.point(A[0],A[1])}})}function Rm(c,A){function _(x,w,P,N,V,W,k,K,J,se,de,gt,at,Zt){var mt=k-x,rt=K-w,lt=mt*mt+rt*rt;if(lt>4*A&&at--){var Qt=N+se,Yt=V+de,or=W+gt,nr=sqrt(Qt*Qt+Yt*Yt+or*or),dr=asin(or/=nr),Mt=abs(abs(or)-1)<epsilon||abs(P-J)<epsilon?(P+J)/2:atan2(Yt,Qt),vi=c(Mt,dr),In=vi[0],Fi=vi[1],aa=In-x,un=Fi-w,Ai=rt*aa-mt*un;(Ai*Ai/lt>A||abs((mt*aa+rt*un)/lt-.5)>.3||N*se+V*de+W*gt<Tm)&&(_(x,w,P,N,V,W,In,Fi,Mt,Qt/=nr,Yt/=nr,or,at,Zt),Zt.point(In,Fi),_(In,Fi,Mt,Qt,Yt,or,k,K,J,se,de,gt,at,Zt))}}return function(x){var w,P,N,V,W,k,K,J,se,de,gt,at,Zt={point:mt,lineStart:rt,lineEnd:Qt,polygonStart:function(){x.polygonStart(),Zt.lineStart=Yt},polygonEnd:function(){x.polygonEnd(),Zt.lineStart=rt}};function mt(dr,Mt){dr=c(dr,Mt),x.point(dr[0],dr[1])}function rt(){J=NaN,Zt.point=lt,x.lineStart()}function lt(dr,Mt){var vi=cartesian([dr,Mt]),In=c(dr,Mt);_(J,se,K,de,gt,at,J=In[0],se=In[1],K=dr,de=vi[0],gt=vi[1],at=vi[2],jA,x),x.point(J,se)}function Qt(){Zt.point=mt,x.lineEnd()}function Yt(){rt(),Zt.point=or,Zt.lineEnd=nr}function or(dr,Mt){lt(w=dr,Mt),P=J,N=se,V=de,W=gt,k=at,Zt.point=lt}function nr(){_(J,se,K,de,gt,at,P,N,w,V,W,k,jA,x),Zt.lineEnd=Qt,Qt()}return Zt}}var wv=mh({point:function(c,A){this.stream.point(c*Dt,A*Dt)}});function oy(c){return Cc(function(){return c})()}function Cc(c){var A,_=150,x=480,w=250,P,N,V=0,W=0,k=0,K=0,J=0,se,de,gt=null,at=clipAntimeridian,Zt=null,mt,rt,lt,Qt=identity,Yt=.5,or=resample(In,Yt),nr,dr;function Mt(un){return un=de(un[0]*radians,un[1]*radians),[un[0]*_+P,N-un[1]*_]}function vi(un){return un=de.invert((un[0]-P)/_,(N-un[1])/_),un&&[un[0]*degrees,un[1]*degrees]}function In(un,Ai){return un=A(un,Ai),[un[0]*_+P,N-un[1]*_]}Mt.stream=function(un){return nr&&dr===un?nr:nr=wv(at(se,or(Qt(dr=un))))},Mt.clipAngle=function(un){return arguments.length?(at=+un?clipCircle(gt=un*radians,6*radians):(gt=null,clipAntimeridian),aa()):gt*degrees},Mt.clipExtent=function(un){return arguments.length?(Qt=un==null?(Zt=mt=rt=lt=null,identity):clipExtent(Zt=+un[0][0],mt=+un[0][1],rt=+un[1][0],lt=+un[1][1]),aa()):Zt==null?null:[[Zt,mt],[rt,lt]]},Mt.scale=function(un){return arguments.length?(_=+un,Fi()):_},Mt.translate=function(un){return arguments.length?(x=+un[0],w=+un[1],Fi()):[x,w]},Mt.center=function(un){return arguments.length?(V=un[0]%360*radians,W=un[1]%360*radians,Fi()):[V*degrees,W*degrees]},Mt.rotate=function(un){return arguments.length?(k=un[0]%360*radians,K=un[1]%360*radians,J=un.length>2?un[2]%360*radians:0,Fi()):[k*degrees,K*degrees,J*degrees]},Mt.precision=function(un){return arguments.length?(or=resample(In,Yt=un*un),aa()):sqrt(Yt)},Mt.fitExtent=function(un,Ai){return fitExtent(Mt,un,Ai)},Mt.fitSize=function(un,Ai){return fitSize(Mt,un,Ai)};function Fi(){de=compose(se=rotateRadians(k,K,J),A);var un=A(V,W);return P=x-un[0]*_,N=w+un[1]*_,aa()}function aa(){return nr=dr=null,Mt}return function(){return A=c.apply(this,arguments),Mt.invert=A.invert&&vi,Fi()}}function sy(c){var A=0,_=pi/3,x=projectionMutator(c),w=x(A,_);return w.parallels=function(P){return arguments.length?x(A=P[0]*radians,_=P[1]*radians):[A*degrees,_*degrees]},w}function uy(c){var A=cos(c);function _(x,w){return[x*A,sin(w)/A]}return _.invert=function(x,w){return[x/A,asin(w*A)]},_}function Mm(c,A){var _=sin(c),x=(_+sin(A))/2;if(abs(x)<epsilon)return cylindricalEqualAreaRaw(c);var w=1+_*(2*x-_),P=sqrt(w)/x;function N(V,W){var k=sqrt(w-2*x*sin(W))/x;return[k*sin(V*=x),P-k*cos(V)]}return N.invert=function(V,W){var k=P-W;return[atan2(V,abs(k))/x*sign(k),asin((w-(V*V+k*k)*x*x)/(2*x))]},N}function ly(){return conicProjection(Mm).scale(155.424).center([0,33.6442])}function XA(){return conicEqualArea().parallels([29.5,45.5]).scale(1070).translate([480,250]).rotate([96,0]).center([-.6,38.7])}function Iv(c){var A=c.length;return{point:function(_,x){for(var w=-1;++w<A;)c[w].point(_,x)},sphere:function(){for(var _=-1;++_<A;)c[_].sphere()},lineStart:function(){for(var _=-1;++_<A;)c[_].lineStart()},lineEnd:function(){for(var _=-1;++_<A;)c[_].lineEnd()},polygonStart:function(){for(var _=-1;++_<A;)c[_].polygonStart()},polygonEnd:function(){for(var _=-1;++_<A;)c[_].polygonEnd()}}}function wm(){var c,A,_=albers(),x,w=conicEqualArea().rotate([154,0]).center([-2,58.5]).parallels([55,65]),P,N=conicEqualArea().rotate([157,0]).center([-3,19.9]).parallels([8,18]),V,W,k={point:function(se,de){W=[se,de]}};function K(se){var de=se[0],gt=se[1];return W=null,x.point(de,gt),W||(P.point(de,gt),W)||(V.point(de,gt),W)}K.invert=function(se){var de=_.scale(),gt=_.translate(),at=(se[0]-gt[0])/de,Zt=(se[1]-gt[1])/de;return(Zt>=.12&&Zt<.234&&at>=-.425&&at<-.214?w:Zt>=.166&&Zt<.234&&at>=-.214&&at<-.115?N:_).invert(se)},K.stream=function(se){return c&&A===se?c:c=Iv([_.stream(A=se),w.stream(se),N.stream(se)])},K.precision=function(se){return arguments.length?(_.precision(se),w.precision(se),N.precision(se),J()):_.precision()},K.scale=function(se){return arguments.length?(_.scale(se),w.scale(se*.35),N.scale(se),K.translate(_.translate())):_.scale()},K.translate=function(se){if(!arguments.length)return _.translate();var de=_.scale(),gt=+se[0],at=+se[1];return x=_.translate(se).clipExtent([[gt-.455*de,at-.238*de],[gt+.455*de,at+.238*de]]).stream(k),P=w.translate([gt-.307*de,at+.201*de]).clipExtent([[gt-.425*de+epsilon,at+.12*de+epsilon],[gt-.214*de-epsilon,at+.234*de-epsilon]]).stream(k),V=N.translate([gt-.205*de,at+.212*de]).clipExtent([[gt-.214*de+epsilon,at+.166*de+epsilon],[gt-.115*de-epsilon,at+.234*de-epsilon]]).stream(k),J()},K.fitExtent=function(se,de){return fitExtent(K,se,de)},K.fitSize=function(se,de){return fitSize(K,se,de)};function J(){return c=A=null,K}return K.scale(1070)}function ud(c){return function(A,_){var x=d(A),w=d(_),P=c(x*w);return[P*w*$(A),P*$(_)]}}function B0(c){return function(A,_){var x=we(A*A+_*_),w=c(x),P=$(w),N=d(w);return[f(A*P,x*N),Rt(x&&_*P/x)]}}var ld=ud(function(c){return we(2/(1+c))});ld.invert=B0(function(c){return 2*Rt(c/2)});function cy(){return projection(ld).scale(124.75).clipAngle(180-.001)}var Pv=ud(function(c){return(c=At(c))&&c/$(c)});Pv.invert=B0(function(c){return c});function Ov(){return projection(Pv).scale(79.4188).clipAngle(180-.001)}function oA(c,A){return[c,O($e(($t+A)/2))]}oA.invert=function(c,A){return[c,2*h(S(A))-$t]};function Nv(){return YA(oA).scale(961/tau)}function YA(c){var A=projection(c),_=A.center,x=A.scale,w=A.translate,P=A.clipExtent,N=null,V,W,k;A.scale=function(J){return arguments.length?(x(J),K()):x()},A.translate=function(J){return arguments.length?(w(J),K()):w()},A.center=function(J){return arguments.length?(_(J),K()):_()},A.clipExtent=function(J){return arguments.length?(J==null?N=V=W=k=null:(N=+J[0][0],V=+J[0][1],W=+J[1][0],k=+J[1][1]),K()):N==null?null:[[N,V],[W,k]]};function K(){var J=pi*x(),se=A(rotation(A.rotate()).invert([0,0]));return P(N==null?[[se[0]-J,se[1]-J],[se[0]+J,se[1]+J]]:c===oA?[[Math.max(se[0]-J,N),V],[Math.min(se[0]+J,W),k]]:[[N,Math.max(se[1]-J,V)],[W,Math.min(se[1]+J,k)]])}return K()}function k0(c){return tan((halfPi+c)/2)}function cd(c,A){var _=cos(c),x=c===A?sin(c):log(_/cos(A))/log(k0(A)/k0(c)),w=_*pow(k0(c),x)/x;if(!x)return mercatorRaw;function P(N,V){w>0?V<-halfPi+epsilon&&(V=-halfPi+epsilon):V>halfPi-epsilon&&(V=halfPi-epsilon);var W=w/pow(k0(V),x);return[W*sin(x*N),w-W*cos(x*N)]}return P.invert=function(N,V){var W=w-V,k=sign(x)*sqrt(N*N+W*W);return[atan2(N,abs(W))/x*sign(W),2*atan(pow(w/k,1/x))-halfPi]},P}function Dv(){return conicProjection(cd).scale(109.5).parallels([30,30])}function _h(c,A){return[c,A]}_h.invert=_h;function $A(){return projection(_h).scale(152.63)}function Ul(c,A){var _=cos(c),x=c===A?sin(c):(_-cos(A))/(A-c),w=_/x+c;if(abs(x)<epsilon)return equirectangularRaw;function P(N,V){var W=w-V,k=x*N;return[W*sin(k),w-W*cos(k)]}return P.invert=function(N,V){var W=w-V;return[atan2(N,abs(W))/x*sign(W),w-sign(x)*sqrt(N*N+W*W)]},P}function Lv(){return conicProjection(Ul).scale(131.154).center([0,13.9389])}function QA(c,A){var _=d(A),x=d(c)*_;return[_*$(c)/x,$(A)/x]}QA.invert=B0(h);function U0(){return projection(QA).scale(144.049).clipAngle(60)}function qA(c,A,_,x){return c===1&&A===1&&_===0&&x===0?identity:transformer({point:function(w,P){this.stream.point(w*c+_,P*A+x)}})}function fy(){var c=1,A=0,_=0,x=1,w=1,P=identity,N=null,V,W,k,K=identity,J,se,de;function gt(){return J=se=null,de}return de={stream:function(at){return J&&se===at?J:J=P(K(se=at))},clipExtent:function(at){return arguments.length?(K=at==null?(N=V=W=k=null,identity):clipExtent(N=+at[0][0],V=+at[0][1],W=+at[1][0],k=+at[1][1]),gt()):N==null?null:[[N,V],[W,k]]},scale:function(at){return arguments.length?(P=qA((c=+at)*x,c*w,A,_),gt()):c},translate:function(at){return arguments.length?(P=qA(c*x,c*w,A=+at[0],_=+at[1]),gt()):[A,_]},reflectX:function(at){return arguments.length?(P=qA(c*(x=at?-1:1),c*w,A,_),gt()):x<0},reflectY:function(at){return arguments.length?(P=qA(c*x,c*(w=at?-1:1),A,_),gt()):w<0},fitExtent:function(at,Zt){return fitExtent(de,at,Zt)},fitSize:function(at,Zt){return fitSize(de,at,Zt)}}}function Fv(c,A){var _=A*A,x=_*_;return[c*(.8707-.131979*_+x*(-.013791+x*(.003971*_-.001529*x))),A*(1.007226+_*(.015085+x*(-.044475+.028874*_-.005916*x)))]}Fv.invert=function(c,A){var _=A,x=25,w;do{var P=_*_,N=P*P;_-=w=(_*(1.007226+P*(.015085+N*(-.044475+.028874*P-.005916*N)))-A)/(1.007226+P*(.015085*3+N*(-.044475*7+.028874*9*P-.005916*11*N)))}while(ut(w)>Oe&&--x>0);return[c/(.8707+(P=_*_)*(-.131979+P*(-.013791+P*P*P*(.003971-.001529*P)))),_]};function Im(){return projection(Fv).scale(175.295)}function fd(c,A){return[d(A)*$(c),$(A)]}fd.invert=B0(Rt);function KA(){return projection(fd).scale(249.5).clipAngle(90+epsilon)}function Bv(c,A){var _=d(A),x=1+d(c)*_;return[_*$(c)/x,$(A)/x]}Bv.invert=B0(function(c){return 2*h(c)});function hy(){return projection(Bv).scale(250).clipAngle(142)}function kv(c,A){return[O($e(($t+A)/2)),-c]}kv.invert=function(c,A){return[-A,2*h(S(c))-$t]};function Pm(){var c=mercatorProjection(kv),A=c.center,_=c.rotate;return c.center=function(x){return arguments.length?A([-x[1],x[0]]):(x=A(),[x[1],-x[0]])},c.rotate=function(x){return arguments.length?_([x[0],x[1],x.length>2?x[2]+90:90]):(x=_(),[x[0],x[1],x[2]-90])},_([0,0,90]).scale(159.155)}function Ay(c,A,_){_=_||{};var x=_.units||"kilometers",w=_.steps||8;if(!c)throw new Error("geojson is required");if(typeof _!="object")throw new Error("options must be an object");if(typeof w!="number")throw new Error("steps must be an number");if(A===void 0)throw new Error("radius is required");if(w<=0)throw new Error("steps must be greater than 0");var P=[];switch(c.type){case"GeometryCollection":return geomEach(c,function(N){var V=JA(N,A,x,w);V&&P.push(V)}),featureCollection(P);case"FeatureCollection":return featureEach(c,function(N){var V=JA(N,A,x,w);V&&featureEach(V,function(W){W&&P.push(W)})}),featureCollection(P)}return JA(c,A,x,w)}function JA(c,A,_,x){var w=c.properties||{},P=c.type==="Feature"?c.geometry:c;if(P.type==="GeometryCollection"){var N=[];return geomEach(c,function(at){var Zt=JA(at,A,_,x);Zt&&N.push(Zt)}),featureCollection(N)}var V=tp(P),W={type:P.type,coordinates:f0(P.coordinates,V)},k=new GeoJSONReader,K=k.read(W),J=radiansToLength(lengthToRadians(A,_),"meters"),se=BufferOp.bufferOp(K,J,x),de=new GeoJSONWriter;if(se=de.write(se),!Uv(se.coordinates)){var gt={type:se.type,coordinates:ep(se.coordinates,V)};return feature(gt,w)}}function Uv(c){return Array.isArray(c[0])?Uv(c[0]):isNaN(c[0])}function f0(c,A){return typeof c[0]!="object"?A(c):c.map(function(_){return f0(_,A)})}function ep(c,A){return typeof c[0]!="object"?A.invert(c):c.map(function(_){return ep(_,A)})}function tp(c){var A=center(c).geometry.coordinates,_=[-A[0],-A[1]];return geoAzimuthalEquidistant().rotate(_).scale(earthRadius)}var Zv=null,rp=C(35486);function zv(c,A,_){_===void 0&&(_={});var x=getGeom(c),w=getGeom(A),P=polygonClipping.intersection(x.coordinates,w.coordinates);return P.length===0?null:P.length===1?polygon(P[0],_.properties):multiPolygon(P,_.properties)}function Gv(c,A){if(A=A||{},!isObject(A))throw new Error("options is invalid");var _=A.propertyName;collectionOf(c,"Polygon","dissolve");var x=[];if(A.propertyName){var w={};featureEach(c,function(W){Object.prototype.hasOwnProperty.call(w,W.properties[_])||(w[W.properties[_]]=[]),w[W.properties[_]].push(W)});for(var P=Object.keys(w),N=0;N<P.length;N++){var V=multiPolygon(polygonClipping.union.apply(null,w[P[N]].map(function(W){return W.geometry.coordinates})));V.properties[_]=P[N],x.push(V)}}else return flatten(multiPolygon(polygonClipping.union.apply(null,c.features.map(function(W){return W.geometry.coordinates}))));return flatten(featureCollection(x))}var np=null;function Vv(c,A,_){_===void 0&&(_={});var x=JSON.stringify(_.properties||{}),w=c[0],P=c[1],N=c[2],V=c[3],W=(P+V)/2,k=(w+N)/2,K=A*2/distance([w,W],[N,W],_),J=K*(N-w),se=A*2/distance([k,P],[k,V],_),de=se*(V-P),gt=J/2,at=gt*2,Zt=Math.sqrt(3)/2*de,mt=N-w,rt=V-P,lt=3/4*at,Qt=Zt,Yt=(mt-at)/(at-gt/2),or=Math.floor(Yt),nr=(or*lt-gt/2-mt)/2-gt/2+lt/2,dr=Math.floor((rt-Zt)/Zt),Mt=(rt-dr*Zt)/2,vi=dr*Zt-rt>Zt/2;vi&&(Mt-=Zt/4);for(var In=[],Fi=[],aa=0;aa<6;aa++){var un=2*Math.PI/6*aa;In.push(Math.cos(un)),Fi.push(Math.sin(un))}for(var Ai=[],Gn=0;Gn<=or;Gn++)for(var za=0;za<=dr;za++){var La=Gn%2===1;if(!(za===0&&La)&&!(za===0&&vi)){var ha=Gn*lt+w-nr,el=za*Qt+P+Mt;if(La&&(el-=Zt/2),_.triangles===!0)ip([ha,el],J/2,de/2,JSON.parse(x),In,Fi).forEach(function(Tu){_.mask?intersect(_.mask,Tu)&&Ai.push(Tu):Ai.push(Tu)});else{var tu=sA([ha,el],J/2,de/2,JSON.parse(x),In,Fi);_.mask?intersect(_.mask,tu)&&Ai.push(tu):Ai.push(tu)}}}return featureCollection(Ai)}function sA(c,A,_,x,w,P){for(var N=[],V=0;V<6;V++){var W=c[0]+A*w[V],k=c[1]+_*P[V];N.push([W,k])}return N.push(N[0].slice()),polygon([N],x)}function ip(c,A,_,x,w,P){for(var N=[],V=0;V<6;V++){var W=[];W.push(c),W.push([c[0]+A*w[V],c[1]+_*P[V]]),W.push([c[0]+A*w[(V+1)%6],c[1]+_*P[(V+1)%6]]),W.push(c),N.push(polygon([W],x))}return N}var Hf=null;function Hv(c,A){var _=py(A),x=null;return c.type==="FeatureCollection"?x=hd(c):x=Wv(polygonClipping.union(c.geometry.coordinates)),x.geometry.coordinates.forEach(function(w){_.geometry.coordinates.push(w[0])}),_}function hd(c){var A=c.features.length===2?polygonClipping.union(c.features[0].geometry.coordinates,c.features[1].geometry.coordinates):polygonClipping.union.apply(polygonClipping,c.features.map(function(_){return _.geometry.coordinates}));return Wv(A)}function Wv(c){return multiPolygon(c)}function py(c){var A=[[[180,90],[-180,90],[-180,-90],[180,-90],[180,90]]],_=c&&c.geometry.coordinates||A;return polygon(_)}var jv=null;function Om(c,A,_,x){x===void 0&&(x={});for(var w=[],P=c[0],N=c[1],V=c[2],W=c[3],k=A/distance([P,N],[V,N],x),K=k*(V-P),J=_/distance([P,N],[P,W],x),se=J*(W-N),de=V-P,gt=W-N,at=Math.floor(de/K),Zt=Math.floor(gt/se),mt=(de-at*K)/2,rt=(gt-Zt*se)/2,lt=P+mt,Qt=0;Qt<at;Qt++){for(var Yt=N+rt,or=0;or<Zt;or++){var nr=polygon([[[lt,Yt],[lt,Yt+se],[lt+K,Yt+se],[lt+K,Yt],[lt,Yt]]],x.properties);x.mask?intersect(x.mask,nr)&&w.push(nr):w.push(nr),Yt+=se}lt+=K}return featureCollection(w)}var hT=null;function Nm(c,A,_){return _===void 0&&(_={}),rectangleGrid(c,A,A,_)}function dy(c,A,_){_===void 0&&(_={});for(var x=[],w=A/distance([c[0],c[1]],[c[2],c[1]],_),P=w*(c[2]-c[0]),N=A/distance([c[0],c[1]],[c[0],c[3]],_),V=N*(c[3]-c[1]),W=0,k=c[0];k<=c[2];){for(var K=0,J=c[1];J<=c[3];){var se=null,de=null;W%2===0&&K%2===0?(se=polygon([[[k,J],[k,J+V],[k+P,J],[k,J]]],_.properties),de=polygon([[[k,J+V],[k+P,J+V],[k+P,J],[k,J+V]]],_.properties)):W%2===0&&K%2===1?(se=polygon([[[k,J],[k+P,J+V],[k+P,J],[k,J]]],_.properties),de=polygon([[[k,J],[k,J+V],[k+P,J+V],[k,J]]],_.properties)):K%2===0&&W%2===1?(se=polygon([[[k,J],[k,J+V],[k+P,J+V],[k,J]]],_.properties),de=polygon([[[k,J],[k+P,J+V],[k+P,J],[k,J]]],_.properties)):K%2===1&&W%2===1&&(se=polygon([[[k,J],[k,J+V],[k+P,J],[k,J]]],_.properties),de=polygon([[[k,J+V],[k+P,J+V],[k+P,J],[k,J+V]]],_.properties)),_.mask?(intersect(_.mask,se)&&x.push(se),intersect(_.mask,de)&&x.push(de)):(x.push(se),x.push(de)),J+=V,K++}W++,k+=P}return featureCollection(x)}var vy=null;function gy(c,A,_){if(_=_||{},typeof _!="object")throw new Error("options is invalid");var x=_.gridType,w=_.property,P=_.weight;if(!c)throw new Error("points is required");if(collectionOf(c,"Point","input must contain Points"),!A)throw new Error("cellSize is required");if(P!==void 0&&typeof P!="number")throw new Error("weight must be a number");w=w||"elevation",x=x||"square",P=P||1;var N=bbox(c),V;switch(x){case"point":case"points":V=pointGrid(N,A,_);break;case"square":case"squares":V=squareGrid(N,A,_);break;case"hex":case"hexes":V=hexGrid(N,A,_);break;case"triangle":case"triangles":V=triangleGrid(N,A,_);break;default:throw new Error("invalid gridType")}var W=[];return featureEach(V,function(k){var K=0,J=0;featureEach(c,function(de){var gt=x==="point"?k:centroid(k),at=distance(gt,de,_),Zt;if(w!==void 0&&(Zt=de.properties[w]),Zt===void 0&&(Zt=de.geometry.coordinates[2]),Zt===void 0)throw new Error("zValue is missing");at===0&&(K=Zt);var mt=1/Math.pow(at,P);J+=mt,K+=mt*Zt});var se=clone(k);se.properties[w]=K/J,W.push(se)}),featureCollection(W)}var Dm=null},35486:function(ae,j,C){"use strict";var I=C(94486),D=C(8014),G=C(8822);function U(B,Z,X){X===void 0&&(X={});var q=(0,D.wA)(B),ie=(0,D.wA)(Z),he=I.union(q.coordinates,ie.coordinates);return he.length===0?null:he.length===1?(0,G.yu)(he[0],X.properties):(0,G.tw)(he,X.properties)}j.Z=U},97435:function(ae,j,C){"use strict";C.d(j,{Z:function(){return ie}});function I(he,Ce){for(var be,Ze=-1,qe=he.length;++Ze<qe;){var De=Ce(he[Ze]);De!==void 0&&(be=be===void 0?De:be+De)}return be}var D=I,G=0/0;function U(he,Ce){var be=he==null?0:he.length;return be?D(he,Ce)/be:G}var B=U;function Z(he){return he}var X=Z;function q(he){return B(he,X)}var ie=q}}]);
}());